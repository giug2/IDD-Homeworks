<!DOCTYPE html>
<html lang="en">
<head>
<meta content="text/html; charset=utf-8" http-equiv="content-type"/>
<title>InterMind: A Doctor-Patient-Family Interactive Depression Assessment System Empowered by Large Language Models</title>
<!--Generated on Mon Sep 23 10:22:43 2024 by LaTeXML (version 0.8.8) http://dlmf.nist.gov/LaTeXML/.-->
<meta content="width=device-width, initial-scale=1, shrink-to-fit=no" name="viewport"/>
<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet" type="text/css"/>
<link href="/static/browse/0.3.4/css/ar5iv.0.7.9.min.css" rel="stylesheet" type="text/css"/>
<link href="/static/browse/0.3.4/css/ar5iv-fonts.0.7.9.min.css" rel="stylesheet" type="text/css"/>
<link href="/static/browse/0.3.4/css/latexml_styles.css" rel="stylesheet" type="text/css"/>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.3.3/html2canvas.min.js"></script>
<script src="/static/browse/0.3.4/js/addons_new.js"></script>
<script src="/static/browse/0.3.4/js/feedbackOverlay.js"></script>
<meta content="Depression Detection,  Large Language Model,  Mental Health,  Interactive System" lang="en" name="keywords"/>
<base href="/html/2409.14878v1/"/></head>
<body>
<nav class="ltx_page_navbar">
<nav class="ltx_TOC">
<ol class="ltx_toclist">
<li class="ltx_tocentry ltx_tocentry_section"><a class="ltx_ref" href="https://arxiv.org/html/2409.14878v1#S1" title="In InterMind: A Doctor-Patient-Family Interactive Depression Assessment System Empowered by Large Language Models"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">1 </span>Introduction</span></a></li>
<li class="ltx_tocentry ltx_tocentry_section">
<a class="ltx_ref" href="https://arxiv.org/html/2409.14878v1#S2" title="In InterMind: A Doctor-Patient-Family Interactive Depression Assessment System Empowered by Large Language Models"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">2 </span>Related Works</span></a>
<ol class="ltx_toclist ltx_toclist_section">
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2409.14878v1#S2.SS1" title="In 2. Related Works ‣ InterMind: A Doctor-Patient-Family Interactive Depression Assessment System Empowered by Large Language Models"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">2.1 </span>Mental Health Support Applications</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2409.14878v1#S2.SS2" title="In 2. Related Works ‣ InterMind: A Doctor-Patient-Family Interactive Depression Assessment System Empowered by Large Language Models"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">2.2 </span>Automatic Depression Detection (ADD) Methods</span></a></li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_section">
<a class="ltx_ref" href="https://arxiv.org/html/2409.14878v1#S3" title="In InterMind: A Doctor-Patient-Family Interactive Depression Assessment System Empowered by Large Language Models"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3 </span>Methodology</span></a>
<ol class="ltx_toclist ltx_toclist_section">
<li class="ltx_tocentry ltx_tocentry_subsection">
<a class="ltx_ref" href="https://arxiv.org/html/2409.14878v1#S3.SS1" title="In 3. Methodology ‣ InterMind: A Doctor-Patient-Family Interactive Depression Assessment System Empowered by Large Language Models"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3.1 </span>InterMind System</span></a>
<ol class="ltx_toclist ltx_toclist_subsection">
<li class="ltx_tocentry ltx_tocentry_subsubsection"><a class="ltx_ref" href="https://arxiv.org/html/2409.14878v1#S3.SS1.SSS1" title="In 3.1. InterMind System ‣ 3. Methodology ‣ InterMind: A Doctor-Patient-Family Interactive Depression Assessment System Empowered by Large Language Models"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3.1.1 </span>Patient Interface</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsubsection"><a class="ltx_ref" href="https://arxiv.org/html/2409.14878v1#S3.SS1.SSS2" title="In 3.1. InterMind System ‣ 3. Methodology ‣ InterMind: A Doctor-Patient-Family Interactive Depression Assessment System Empowered by Large Language Models"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3.1.2 </span>Family Interface</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsubsection"><a class="ltx_ref" href="https://arxiv.org/html/2409.14878v1#S3.SS1.SSS3" title="In 3.1. InterMind System ‣ 3. Methodology ‣ InterMind: A Doctor-Patient-Family Interactive Depression Assessment System Empowered by Large Language Models"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3.1.3 </span>Doctor Interface</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsubsection"><a class="ltx_ref" href="https://arxiv.org/html/2409.14878v1#S3.SS1.SSS4" title="In 3.1. InterMind System ‣ 3. Methodology ‣ InterMind: A Doctor-Patient-Family Interactive Depression Assessment System Empowered by Large Language Models"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3.1.4 </span>Cyclical Analysis Interface</span></a></li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_subsection">
<a class="ltx_ref" href="https://arxiv.org/html/2409.14878v1#S3.SS2" title="In 3. Methodology ‣ InterMind: A Doctor-Patient-Family Interactive Depression Assessment System Empowered by Large Language Models"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3.2 </span>AI Psychological Chatbot</span></a>
<ol class="ltx_toclist ltx_toclist_subsection">
<li class="ltx_tocentry ltx_tocentry_subsubsection"><a class="ltx_ref" href="https://arxiv.org/html/2409.14878v1#S3.SS2.SSS1" title="In 3.2. AI Psychological Chatbot ‣ 3. Methodology ‣ InterMind: A Doctor-Patient-Family Interactive Depression Assessment System Empowered by Large Language Models"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3.2.1 </span>Psychological Counseling Dialogue Prompt Engineering</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsubsection"><a class="ltx_ref" href="https://arxiv.org/html/2409.14878v1#S3.SS2.SSS2" title="In 3.2. AI Psychological Chatbot ‣ 3. Methodology ‣ InterMind: A Doctor-Patient-Family Interactive Depression Assessment System Empowered by Large Language Models"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3.2.2 </span>Instruction Fine-tuning for AI Psychological Chatbot</span></a></li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_subsection">
<a class="ltx_ref" href="https://arxiv.org/html/2409.14878v1#S3.SS3" title="In 3. Methodology ‣ InterMind: A Doctor-Patient-Family Interactive Depression Assessment System Empowered by Large Language Models"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3.3 </span>AI Psychologist</span></a>
<ol class="ltx_toclist ltx_toclist_subsection">
<li class="ltx_tocentry ltx_tocentry_subsubsection"><a class="ltx_ref" href="https://arxiv.org/html/2409.14878v1#S3.SS3.SSS1" title="In 3.3. AI Psychologist ‣ 3. Methodology ‣ InterMind: A Doctor-Patient-Family Interactive Depression Assessment System Empowered by Large Language Models"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3.3.1 </span>Diagnostic Criteria Knowledge Retrieval</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsubsection"><a class="ltx_ref" href="https://arxiv.org/html/2409.14878v1#S3.SS3.SSS2" title="In 3.3. AI Psychologist ‣ 3. Methodology ‣ InterMind: A Doctor-Patient-Family Interactive Depression Assessment System Empowered by Large Language Models"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3.3.2 </span>Augmented Generation with Chain-of-thoughts</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsubsection"><a class="ltx_ref" href="https://arxiv.org/html/2409.14878v1#S3.SS3.SSS3" title="In 3.3. AI Psychologist ‣ 3. Methodology ‣ InterMind: A Doctor-Patient-Family Interactive Depression Assessment System Empowered by Large Language Models"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3.3.3 </span>Instruction Fine-tuning for AI Psychologist</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsubsection"><a class="ltx_ref" href="https://arxiv.org/html/2409.14878v1#S3.SS3.SSS4" title="In 3.3. AI Psychologist ‣ 3. Methodology ‣ InterMind: A Doctor-Patient-Family Interactive Depression Assessment System Empowered by Large Language Models"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3.3.4 </span>Tailored Advice and Cyclical Analysis Generation</span></a></li>
</ol>
</li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_section">
<a class="ltx_ref" href="https://arxiv.org/html/2409.14878v1#S4" title="In InterMind: A Doctor-Patient-Family Interactive Depression Assessment System Empowered by Large Language Models"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">4 </span>Experimental Results and Analysis</span></a>
<ol class="ltx_toclist ltx_toclist_section">
<li class="ltx_tocentry ltx_tocentry_subsection">
<a class="ltx_ref" href="https://arxiv.org/html/2409.14878v1#S4.SS1" title="In 4. Experimental Results and Analysis ‣ InterMind: A Doctor-Patient-Family Interactive Depression Assessment System Empowered by Large Language Models"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">4.1 </span>Datasets</span></a>
<ol class="ltx_toclist ltx_toclist_subsection">
<li class="ltx_tocentry ltx_tocentry_subsubsection"><a class="ltx_ref" href="https://arxiv.org/html/2409.14878v1#S4.SS1.SSS1" title="In 4.1. Datasets ‣ 4. Experimental Results and Analysis ‣ InterMind: A Doctor-Patient-Family Interactive Depression Assessment System Empowered by Large Language Models"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">4.1.1 </span>MMDA Dataset</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsubsection"><a class="ltx_ref" href="https://arxiv.org/html/2409.14878v1#S4.SS1.SSS2" title="In 4.1. Datasets ‣ 4. Experimental Results and Analysis ‣ InterMind: A Doctor-Patient-Family Interactive Depression Assessment System Empowered by Large Language Models"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">4.1.2 </span>DR dataset</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsubsection"><a class="ltx_ref" href="https://arxiv.org/html/2409.14878v1#S4.SS1.SSS3" title="In 4.1. Datasets ‣ 4. Experimental Results and Analysis ‣ InterMind: A Doctor-Patient-Family Interactive Depression Assessment System Empowered by Large Language Models"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">4.1.3 </span>DepSeverity dataset</span></a></li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_subsection">
<a class="ltx_ref" href="https://arxiv.org/html/2409.14878v1#S4.SS2" title="In 4. Experimental Results and Analysis ‣ InterMind: A Doctor-Patient-Family Interactive Depression Assessment System Empowered by Large Language Models"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">4.2 </span>Experimental Setup and Evaluation Metrics</span></a>
<ol class="ltx_toclist ltx_toclist_subsection">
<li class="ltx_tocentry ltx_tocentry_subsubsection"><a class="ltx_ref" href="https://arxiv.org/html/2409.14878v1#S4.SS2.SSS1" title="In 4.2. Experimental Setup and Evaluation Metrics ‣ 4. Experimental Results and Analysis ‣ InterMind: A Doctor-Patient-Family Interactive Depression Assessment System Empowered by Large Language Models"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">4.2.1 </span>Experimental Setup</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsubsection"><a class="ltx_ref" href="https://arxiv.org/html/2409.14878v1#S4.SS2.SSS2" title="In 4.2. Experimental Setup and Evaluation Metrics ‣ 4. Experimental Results and Analysis ‣ InterMind: A Doctor-Patient-Family Interactive Depression Assessment System Empowered by Large Language Models"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">4.2.2 </span>Evaluation Metrics</span></a></li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2409.14878v1#S4.SS3" title="In 4. Experimental Results and Analysis ‣ InterMind: A Doctor-Patient-Family Interactive Depression Assessment System Empowered by Large Language Models"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">4.3 </span>Comparison of Depression Binary Classification Results</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2409.14878v1#S4.SS4" title="In 4. Experimental Results and Analysis ‣ InterMind: A Doctor-Patient-Family Interactive Depression Assessment System Empowered by Large Language Models"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">4.4 </span>Comparison of Severity Degree Estimation Results</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection">
<a class="ltx_ref" href="https://arxiv.org/html/2409.14878v1#S4.SS5" title="In 4. Experimental Results and Analysis ‣ InterMind: A Doctor-Patient-Family Interactive Depression Assessment System Empowered by Large Language Models"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">4.5 </span>Evaluation of Report Quality</span></a>
<ol class="ltx_toclist ltx_toclist_subsection">
<li class="ltx_tocentry ltx_tocentry_subsubsection"><a class="ltx_ref" href="https://arxiv.org/html/2409.14878v1#S4.SS5.SSS1" title="In 4.5. Evaluation of Report Quality ‣ 4. Experimental Results and Analysis ‣ InterMind: A Doctor-Patient-Family Interactive Depression Assessment System Empowered by Large Language Models"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">4.5.1 </span>Clinical Psychiatrist Evaluation</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsubsection"><a class="ltx_ref" href="https://arxiv.org/html/2409.14878v1#S4.SS5.SSS2" title="In 4.5. Evaluation of Report Quality ‣ 4. Experimental Results and Analysis ‣ InterMind: A Doctor-Patient-Family Interactive Depression Assessment System Empowered by Large Language Models"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">4.5.2 </span>Quantitative Experimental Evaluation</span></a></li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2409.14878v1#S4.SS6" title="In 4. Experimental Results and Analysis ‣ InterMind: A Doctor-Patient-Family Interactive Depression Assessment System Empowered by Large Language Models"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">4.6 </span>Psychological Counseling Competency Evaluation</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2409.14878v1#S4.SS7" title="In 4. Experimental Results and Analysis ‣ InterMind: A Doctor-Patient-Family Interactive Depression Assessment System Empowered by Large Language Models"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">4.7 </span>Ablation Study</span></a></li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_section"><a class="ltx_ref" href="https://arxiv.org/html/2409.14878v1#S5" title="In InterMind: A Doctor-Patient-Family Interactive Depression Assessment System Empowered by Large Language Models"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">5 </span>Conclusion</span></a></li>
<li class="ltx_tocentry ltx_tocentry_appendix"><a class="ltx_ref" href="https://arxiv.org/html/2409.14878v1#A1" title="In InterMind: A Doctor-Patient-Family Interactive Depression Assessment System Empowered by Large Language Models"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">A </span>Appendix</span></a></li>
</ol></nav>
</nav>
<div class="ltx_page_main">
<div class="ltx_page_content">
<article class="ltx_document ltx_authors_1line ltx_leqno">
<h1 class="ltx_title ltx_title_document">InterMind: A Doctor-Patient-Family Interactive Depression Assessment System Empowered by Large Language Models</h1>
<div class="ltx_authors">
<span class="ltx_creator ltx_role_author">
<span class="ltx_personname">Zhiyuan Zhou
</span><span class="ltx_author_notes">
<span class="ltx_contact ltx_role_email"><a href="mailto:zhouzhiyuan.hfut@gmail.com">zhouzhiyuan.hfut@gmail.com</a>
</span>
<span class="ltx_contact ltx_role_affiliation"><span class="ltx_text ltx_affiliation_institution" id="id1.1.id1">Hefei University of Technology</span><span class="ltx_text ltx_affiliation_city" id="id2.2.id2">Hefei</span><span class="ltx_text ltx_affiliation_state" id="id3.3.id3">Anhui Province</span><span class="ltx_text ltx_affiliation_country" id="id4.4.id4">China</span>
</span></span></span>
<span class="ltx_author_before">, </span><span class="ltx_creator ltx_role_author">
<span class="ltx_personname">Jilong Liu
</span><span class="ltx_author_notes">
<span class="ltx_contact ltx_role_email"><a href="mailto:liujilong0116@gmail.com">liujilong0116@gmail.com</a>
</span>
<span class="ltx_contact ltx_role_affiliation"><span class="ltx_text ltx_affiliation_institution" id="id5.1.id1">Hefei University of Technology</span><span class="ltx_text ltx_affiliation_city" id="id6.2.id2">Hefei</span><span class="ltx_text ltx_affiliation_state" id="id7.3.id3">Anhui Province</span><span class="ltx_text ltx_affiliation_country" id="id8.4.id4">China</span>
</span></span></span>
<span class="ltx_author_before">, </span><span class="ltx_creator ltx_role_author">
<span class="ltx_personname">Sanwang Wang
</span><span class="ltx_author_notes">
<span class="ltx_contact ltx_role_email"><a href="mailto:sanwangwang@whu.edu.cn">sanwangwang@whu.edu.cn</a>
</span>
<span class="ltx_contact ltx_role_affiliation"><span class="ltx_text ltx_affiliation_institution" id="id9.1.id1">Renmin Hospital of Wuhan University</span><span class="ltx_text ltx_affiliation_city" id="id10.2.id2">Wuhan</span><span class="ltx_text ltx_affiliation_state" id="id11.3.id3">Hubei Province</span><span class="ltx_text ltx_affiliation_country" id="id12.4.id4">China</span>
</span></span></span>
<span class="ltx_author_before">, </span><span class="ltx_creator ltx_role_author">
<span class="ltx_personname">Shijie Hao
</span><span class="ltx_author_notes">
<span class="ltx_contact ltx_role_email"><a href="mailto:hfut.hsj@gmail.com">hfut.hsj@gmail.com</a>
</span>
<span class="ltx_contact ltx_role_affiliation"><span class="ltx_text ltx_affiliation_institution" id="id13.1.id1">Hefei University of Technology</span><span class="ltx_text ltx_affiliation_city" id="id14.2.id2">Hefei</span><span class="ltx_text ltx_affiliation_state" id="id15.3.id3">Anhui Province</span><span class="ltx_text ltx_affiliation_country" id="id16.4.id4">China</span>
</span></span></span>
<span class="ltx_author_before">, </span><span class="ltx_creator ltx_role_author">
<span class="ltx_personname">Yanrong Guo
</span><span class="ltx_author_notes">
<span class="ltx_contact ltx_role_email"><a href="mailto:yrguo@hfut.edu.cn">yrguo@hfut.edu.cn</a>
</span>
<span class="ltx_contact ltx_role_affiliation"><span class="ltx_text ltx_affiliation_institution" id="id17.1.id1">Hefei University of Technology</span><span class="ltx_text ltx_affiliation_city" id="id18.2.id2">Hefei</span><span class="ltx_text ltx_affiliation_state" id="id19.3.id3">Anhui Province</span><span class="ltx_text ltx_affiliation_country" id="id20.4.id4">China</span>
</span></span></span>
<span class="ltx_author_before"> and </span><span class="ltx_creator ltx_role_author">
<span class="ltx_personname">Richang Hong
</span><span class="ltx_author_notes">
<span class="ltx_contact ltx_role_email"><a href="mailto:hongrc.hfut@gmail.com">hongrc.hfut@gmail.com</a>
</span>
<span class="ltx_contact ltx_role_affiliation"><span class="ltx_text ltx_affiliation_institution" id="id21.1.id1">Hefei University of Technology</span><span class="ltx_text ltx_affiliation_city" id="id22.2.id2">Hefei</span><span class="ltx_text ltx_affiliation_state" id="id23.3.id3">Anhui Province</span><span class="ltx_text ltx_affiliation_country" id="id24.4.id4">China</span>
</span></span></span>
</div>
<div class="ltx_abstract">
<h6 class="ltx_title ltx_title_abstract">Abstract.</h6>
<p class="ltx_p" id="id25.id1">Depression poses significant challenges to patients and healthcare organizations, necessitating efficient assessment methods. Existing paradigms typically focus on a patient-doctor way that overlooks multi-role interactions, such as family involvement in the evaluation and caregiving process. Moreover, current automatic depression detection (ADD) methods usually model depression detection as a classification or regression task, lacking interpretability for the decision-making process. To address these issues, we developed InterMind, a doctor-patient-family interactive depression assessment system empowered by large language models (LLMs). Our system enables patients and families to contribute descriptions, generates assistive diagnostic reports for doctors, and provides actionable insights, improving diagnostic precision and efficiency. To enhance LLMs’ performance in psychological counseling and diagnostic interpretability, we integrate retrieval-augmented generation (RAG) and chain-of-thoughts (CoT) techniques for data augmentation, which mitigates the hallucination issue of LLMs in specific scenarios after instruction fine-tuning. Quantitative experiments and professional assessments by clinicians validate the effectiveness of our system.</p>
</div>
<div class="ltx_keywords">Depression Detection, Large Language Model, Mental Health, Interactive System
</div>
<span class="ltx_note ltx_note_frontmatter ltx_role_copyright" id="id1"><sup class="ltx_note_mark">†</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">†</sup><span class="ltx_note_type">copyright: </span>acmlicensed</span></span></span><span class="ltx_note ltx_note_frontmatter ltx_role_isbn" id="id2"><sup class="ltx_note_mark">†</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">†</sup><span class="ltx_note_type">isbn: </span></span></span></span><span class="ltx_note ltx_note_frontmatter ltx_role_ccs" id="id3"><sup class="ltx_note_mark">†</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">†</sup><span class="ltx_note_type">ccs: </span>Applied computing Health care information systems</span></span></span>
<section class="ltx_section" id="S1">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">1. </span>Introduction</h2>
<div class="ltx_para" id="S1.p1">
<p class="ltx_p" id="S1.p1.1">Depression is a serious mental health disorder that significantly affects physical and psychological well-being and can even lead to suicide. The prevalence of depression is on the rise annually. According to the World Health Organization (WHO), it affects more than 300 million people worldwide <cite class="ltx_cite ltx_citemacro_citep">(Organization et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2409.14878v1#bib.bib27" title="">2017</a>)</cite>. The WHO predicts that by 2030, untreated mental disorders will account for 13% of the total disease burden. In developing countries, more than 75% of individuals with mental disorders do not receive treatment <cite class="ltx_cite ltx_citemacro_citep">(Funk et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2409.14878v1#bib.bib7" title="">2016</a>)</cite>. Depression imposes a substantial economic burden each year due to absenteeism and reduced production efficiency <cite class="ltx_cite ltx_citemacro_citep">(Greenberg et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2409.14878v1#bib.bib9" title="">2015</a>)</cite>.</p>
</div>
<div class="ltx_para" id="S1.p2">
<p class="ltx_p" id="S1.p2.1">One reason many depression patients struggle to receive evaluation is the lack of an efficient assessment system. Current diagnostic methods rely heavily on self-reports and clinical interviews <cite class="ltx_cite ltx_citemacro_citep">(Habtamu et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2409.14878v1#bib.bib10" title="">2023</a>)</cite>, which are subjective and often place additional burdens on patients. Moreover, the shortage of psychiatrists cannot keep up with the increasing number of depression patients <cite class="ltx_cite ltx_citemacro_citep">(Johnson, <a class="ltx_ref" href="https://arxiv.org/html/2409.14878v1#bib.bib16" title="">2022</a>)</cite>, highlighting the need for more efficient assistive diagnostic technologies for doctors.
In recent years, deep learning-based automatic depression detection (ADD) technology <cite class="ltx_cite ltx_citemacro_citep">(Uddin et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2409.14878v1#bib.bib37" title="">2022</a>; Niu et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2409.14878v1#bib.bib26" title="">2021</a>; Sadeghi et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2409.14878v1#bib.bib31" title="">2023</a>; Sood et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2409.14878v1#bib.bib34" title="">2023</a>; Zhou et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2409.14878v1#bib.bib51" title="">2022</a>)</cite> has garnered increasing attention from researchers. This technology models patient-doctor interview data to learn discriminative features, paving the way for assistive depression detection and constructing a depression assessment system.</p>
</div>
<div class="ltx_para" id="S1.p3">
<p class="ltx_p" id="S1.p3.1">However, constructing an efficient depression assessment system still presents several issues.
At the functional level, the current depression assessment paradigm <cite class="ltx_cite ltx_citemacro_citep">(Heaukulani et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2409.14878v1#bib.bib11" title="">2024</a>; Kim et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2409.14878v1#bib.bib17" title="">2024</a>)</cite> typically models patients only or in a patient-doctor way.
For instance, <cite class="ltx_cite ltx_citemacro_citep">(Kim et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2409.14878v1#bib.bib17" title="">2024</a>)</cite> develops a patient journaling app to facilitate log-keeping and clinical care, which helps doctors better understand the patient.
However, patients may inaccurately express or conceal their feelings. Thus, it is crucial to involve the family in the patient’s diagnosis and treatment process and establish effective interaction among multiple roles in a doctor-patient-family way.
Furthermore, most ADD methods <cite class="ltx_cite ltx_citemacro_citep">(Saggu et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2409.14878v1#bib.bib32" title="">2022</a>; Wu et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2409.14878v1#bib.bib41" title="">2022</a>; Zhang et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2409.14878v1#bib.bib47" title="">2021</a>; Nepal et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2409.14878v1#bib.bib25" title="">2024</a>)</cite> lack in-depth analysis to support classification or regression results predicted by various machine learning or deep learning models. For example, <cite class="ltx_cite ltx_citemacro_citep">(Nepal et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2409.14878v1#bib.bib25" title="">2024</a>)</cite> employs machine learning, specifically using the random forest algorithm, to automatically capture images from the smartphone’s front camera for depression classification or regression tasks, yet the interpretability of the results remains a significant challenge.
At the methodology level, we observe an emerging trend that large language models (LLMs) offer promising opportunities for assessing depression by enabling the construction of chatbots or generating interpretive content <cite class="ltx_cite ltx_citemacro_citep">(Xu et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2409.14878v1#bib.bib42" title="">2024</a>; Yang et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2409.14878v1#bib.bib44" title="">2024b</a>; Chen et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2409.14878v1#bib.bib4" title="">2023</a>)</cite>. However, given the existing limitations of LLMs, such as data scarcity in specific scenarios and hallucinations due to the lack of expertise, these models are insufficient for psychological counseling contexts and generating assistive diagnostic reports. For example, <cite class="ltx_cite ltx_citemacro_citep">(Xu et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2409.14878v1#bib.bib42" title="">2024</a>)</cite> utilizes different LLMs for depression detection in social media posts but finds that the generated explanations sometimes contain misunderstandings and incorrect reasoning.</p>
</div>
<div class="ltx_para" id="S1.p4">
<p class="ltx_p" id="S1.p4.1">To address the above issues, we propose a doctor-patient-family interactive depression assessment system empowered by LLMs, InterMind, as shown in Figure <a class="ltx_ref" href="https://arxiv.org/html/2409.14878v1#S1.F1" title="Figure 1 ‣ 1. Introduction ‣ InterMind: A Doctor-Patient-Family Interactive Depression Assessment System Empowered by Large Language Models"><span class="ltx_text ltx_ref_tag">1</span></a>.
This system utilizes the proposed AI Psychological Chatbot and AI Psychologist to bridge interactions among doctors, patients, and families.
First, the AI Psychological Chatbot engages with patients in daily conversations, allowing them to describe their experiences and feelings while providing a degree of psychological support during the interaction. The system also enables the AI Psychological Chatbot to concurrently converse with the patient’s family members, who can describe the patient’s recent condition, such as mood swings or insomnia. By combining dialogues from patients and families, the system helps doctors gain a clearer and more comprehensive understanding of the patient’s actual state, reducing the risk of inaccuracies or intentional omissions in the patient’s self-reporting.
Subsequently, the AI Psychologist is designed to analyze the collected multi-turn dialogues and generate a standardized assistive diagnostic report, which includes the degree of depression, observed symptoms, and relevant diagnostic criteria, rather than simply providing a classification/regression result. Thus, the report offers insights to support the doctor in the diagnostic process and improve diagnostic efficiency.
Additionally, the AI Psychologist provides personalized treatment strategy and care advice for both the patient and their family, aiding in better caregiving and treatment. It can also periodically assess the patient’s depression status based on these reports, ensuring continuous monitoring and support.
What’s more, our system allows doctors to intervene in the LLM-generated content and enables patients and families to provide feedback on treatment effects, ensuring the accuracy of the assessment and helping doctors adjust treatment strategies timely.</p>
</div>
<div class="ltx_para" id="S1.p5">
<p class="ltx_p" id="S1.p5.1">To further improve the capability of LLMs in supporting the roles of AI Psychological Chatbot and AI Psychologist in our system, we propose the following methods to enhance their effectiveness in psychological counseling and assistive diagnostic report generation.
For the construction of an AI Psychological Chatbot, we propose the psychological counseling dialogue prompt engineering that leverages diverse experiences from social media depression data to rewrite dialogues. The dialogue fits the psychological counseling scenarios, providing data for instruction fine-tuning, which enhances LLM’s ability of psychological counseling.
For the construction of AI Psychologist, we propose diagnostic standard-based report generation which involves a chain-of-thought (CoT) analysis of depression-related symptoms within dialogues.
Additionally, the retrieval-augmented generation (RAG) technology is applied to match symptoms with corresponding criteria from the DSM-V diagnostic standard <cite class="ltx_cite ltx_citemacro_citep">(Widiger and Clark, <a class="ltx_ref" href="https://arxiv.org/html/2409.14878v1#bib.bib40" title="">2000</a>)</cite>. The adopted CoT and RAG techniques enable LLM to generate structured and professional assistive diagnostic reports.
Based on the above-generated psychological counseling dialogues and their reports, we can build a specialized AI Psychologist through instruction fine-tuning.</p>
</div>
<div class="ltx_para" id="S1.p6">
<p class="ltx_p" id="S1.p6.1">The contributions of our work are summarized as follows:</p>
<ul class="ltx_itemize" id="S1.I1">
<li class="ltx_item" id="S1.I1.i1" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S1.I1.i1.p1">
<p class="ltx_p" id="S1.I1.i1.p1.1">We construct an LLM-empowered depression assessment system, thereby facilitating a novel doctor-patient-family paradigm.
This system involves the family in the diagnosis and treatment process, providing better caregiving for the patient while improving the efficiency of the doctor’s diagnosis.</p>
</div>
</li>
<li class="ltx_item" id="S1.I1.i2" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S1.I1.i2.p1">
<p class="ltx_p" id="S1.I1.i2.p1.1">We utilize prompt engineering to simulate psychological counseling dialogues for data augmentation, and integrate with chain-of-thought (CoT) and retrieval-augmented generation (RAG) techniques to generate professional diagnostic reports from multisource dialogue data. This approach significantly improves the ability of LLMs in psychological counseling and assistive diagnostic report generation through instruction fine-tuning.</p>
</div>
</li>
<li class="ltx_item" id="S1.I1.i3" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S1.I1.i3.p1">
<p class="ltx_p" id="S1.I1.i3.p1.1">We validate the effectiveness of the proposed AI psychological chatbot and AI Psychologist through quantitative experiments and subjective evaluations, demonstrating the efficacy of our approach in building a depression assessment system.</p>
</div>
</li>
</ul>
</div>
<figure class="ltx_figure" id="S1.F1">
<div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_2"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_figure_panel ltx_img_landscape" height="181" id="S1.F1.g1" src="extracted/5872729/1.png" width="598"/></div>
</div>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 1. </span>The framework of proposed LLM-empowered doctor-patient-family interactive depression assessment system. Patients and family members can chat with the AI Psychological Chatbot to share their experiences and feelings. The AI Psychologist then analyzes the dialogue content to generate an assistive depression diagnosis report, offering tailored treatment and caregiving advice to the patient and the family. Additionally, the AI Psychologist can conduct periodic analyses of the mental state based on reports over several days. The doctor reviews the dialogues and reports provided by the system, revising the reports and advice for the patient and family. Patients and families can provide effective feedback of treatment to the system, aiding doctors in optimizing treatment plans.</figcaption><div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_1"><span class="ltx_ERROR ltx_centering ltx_figure_panel undefined" id="S1.F1.1">\Description</span></div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_1">
<p class="ltx_p ltx_figure_panel ltx_align_center" id="S1.F1.2">This figure presents the framework of the proposed LLM-empowered doctor-patient-family interactive depression assessment system. The system consists of two AI components: AI Psychological Chatbot and AI Psychologist. It facilitates interactions among doctors, patients, and family. For patients, the system offers psychological counseling, mental support, diagnostic reports, treatment strategies, and feedback on treatment effectiveness. For families, the system provides chat, diagnostic reports, care advice, and treatment feedback. For doctors, the system delivers diagnostic reports, revision, and access to dialogues and feedback from patients and families.</p>
</div>
</div>
</figure>
</section>
<section class="ltx_section" id="S2">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">2. </span>Related Works</h2>
<div class="ltx_para" id="S2.p1">
<p class="ltx_p" id="S2.p1.1">We first introduce the existing mental health support applications. Subsequently, we introduce automatic depression detection (ADD) methods.</p>
</div>
<section class="ltx_subsection" id="S2.SS1">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">2.1. </span>Mental Health Support Applications</h3>
<div class="ltx_para" id="S2.SS1.p1">
<p class="ltx_p" id="S2.SS1.p1.1">In recent years, with the development of AI technology, many mental health support applications have emerged, aiding patients in detection and treatment as well as assisting doctors in diagnosis.
For instance, MoodCapture <cite class="ltx_cite ltx_citemacro_citep">(Nepal et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2409.14878v1#bib.bib25" title="">2024</a>)</cite> introduces a method for assessing depression through images captured by smartphone cameras during daily activities, demonstrating the effectiveness of image attributes and face landmarks in predicting depression while addressing privacy concerns related to photo sharing.
<cite class="ltx_cite ltx_citemacro_citep">(Heaukulani et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2409.14878v1#bib.bib11" title="">2024</a>)</cite> discusses the implementation of machine learning and AI in three digital health initiatives in Singapore, focusing on mental health care for patients with serious mental illnesses, a public mental wellness platform, and an online peer-support network, highlighting their impact and the integration of AI to enhance service delivery and support.
<cite class="ltx_cite ltx_citemacro_citep">(Kim et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2409.14878v1#bib.bib17" title="">2024</a>)</cite> proposes an LLM-driven journaling app called MindfulDiary, which supports psychiatric patients in documenting daily experiences and aids clinicians in understanding their patients, as demonstrated by a four-week study involving patients with major depressive disorder and psychiatrists.
<cite class="ltx_cite ltx_citemacro_citep">(Yang et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2409.14878v1#bib.bib46" title="">2024a</a>)</cite> introduces EmoLLM, a model with novel techniques that significantly improve MLLMs’ ability to interpret complex human emotions, advancing artificial emotional intelligence in areas like human-computer interaction and mental health support.
<cite class="ltx_cite ltx_citemacro_citep">(Zhou et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2409.14878v1#bib.bib50" title="">2023</a>)</cite> introduces CharacterGLM, a series of models designed for character-based dialogue generation, enabling AI customization for social interaction.
<cite class="ltx_cite ltx_citemacro_citep">(Hu et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2409.14878v1#bib.bib12" title="">2024</a>)</cite> introduces PsycoLLM, a specialized large language model for mental health applications, demonstrating its superior performance compared to other LLMs in psychological tasks.
Although current mental health support applications improve diagnostic and treatment efficiency, they typically focus on a single role or the doctor-patient relationship, without considering interactions between multiple roles and generating an assistive diagnostic report.</p>
</div>
</section>
<section class="ltx_subsection" id="S2.SS2">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">2.2. </span>Automatic Depression Detection (ADD) Methods</h3>
<div class="ltx_para" id="S2.SS2.p1">
<p class="ltx_p" id="S2.SS2.p1.1">Automatic depression detection (ADD) has been attracting increasing attention from researchers. In recent years, ADD techniques can be broadly categorized into feature engineering-based methods, deep learning-based methods, and large language model (LLM)-based methods.</p>
</div>
<div class="ltx_para" id="S2.SS2.p2">
<p class="ltx_p" id="S2.SS2.p2.1">Feature engineering based ADD methods usually design hand-crafted features, conduct feature selection, and utilize machine learning algorithms like decision tree, random forest, and others to distinguish depressive samples.
For example, <cite class="ltx_cite ltx_citemacro_citep">(Stankevich et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2409.14878v1#bib.bib35" title="">2018</a>)</cite> analyzes various feature sets for early depression detection among Reddit users by processing text messages, utilizing the CLEF/eRisk 2017 dataset, and comparing the results with the official task report.
<cite class="ltx_cite ltx_citemacro_citep">(Yang et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2409.14878v1#bib.bib45" title="">2016</a>)</cite> proposes a gender-specific decision tree combining multimodal predictions and participant characteristics for improved depression classification, achieving promising results on the DAIC-WOZ dataset.
<cite class="ltx_cite ltx_citemacro_citep">(Dai et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2409.14878v1#bib.bib5" title="">2021</a>)</cite> presents a novel two-stage feature selection algorithm for depression prediction using long-term recordings, achieving high accuracy and revealing key topics and features relevant to depression, with implications for improving clinical diagnosis.
Although feature engineering-based methods can achieve favorable results by extracting specific features, they require extensive prior domain knowledge and manual effort, making the process time-consuming.</p>
</div>
<div class="ltx_para" id="S2.SS2.p3">
<p class="ltx_p" id="S2.SS2.p3.1">Deep learning can learn high-dimensional representations from initial features, allowing it to capture more discriminative depression-related features. Therefore, exploring the depression detection capabilities of different network architectures and designing learning strategies have become the mainstream approach in ADD methods in recent years.
For instance, DeCapsNet <cite class="ltx_cite ltx_citemacro_citep">(Liu et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2409.14878v1#bib.bib20" title="">2024</a>)</cite> is a novel capsule network integrated with contrastive learning designed for depression detection from online user posts, offering enhanced interpretability and performance by leveraging symptom capsules and hierarchical reasoning aligned with the PHQ-9 questionnaire.
<cite class="ltx_cite ltx_citemacro_citep">(Zhang et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2409.14878v1#bib.bib47" title="">2021</a>)</cite> introduces DEPA, a self-supervised, pretrained audio embedding method designed for depression detection, demonstrating significant performance improvements on both sparse and large datasets by leveraging response-level audio representations.
A comprehensive study <cite class="ltx_cite ltx_citemacro_citep">(Zou et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2409.14878v1#bib.bib52" title="">2022</a>)</cite> utilizes a transformer-based multimodal fusion approach on the developed Chinese multimodal depression corpus to address the lack of resources for automatic depression screening by analyzing visual, acoustic, and textual features from clinical interviews, showing promising performance.
<cite class="ltx_cite ltx_citemacro_citep">(Zhang et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2409.14878v1#bib.bib48" title="">2022a</a>)</cite> proposes a novel method utilizing psychiatric scales and a hierarchical attentional network with BERT for efficient, accurate, and interpretable early detection in online posts.
Deep-learning architecture-based ADD methods effectively extract underlying depression patterns from initial features by designing specific network structures and learning strategies. However, these methods are often constrained by insufficient data in depression detection scenarios, leading to limited model generalization. Additionally, they typically model depression detection as a classification or regression task, lacking further interpretability of the results.</p>
</div>
<div class="ltx_para" id="S2.SS2.p4">
<p class="ltx_p" id="S2.SS2.p4.1">Recently, large language models (LLMs) excel in processing and understanding vast amounts of text data, enabling them to perform a wide range of language-related tasks with high accuracy and versatility across various applications, such as healthcare <cite class="ltx_cite ltx_citemacro_citep">(Kraljevic et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2409.14878v1#bib.bib18" title="">2021</a>)</cite> and role-playing <cite class="ltx_cite ltx_citemacro_citep">(Shao et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2409.14878v1#bib.bib33" title="">2023</a>)</cite>. LLMs also promote the development of ADD methods.
For example, <cite class="ltx_cite ltx_citemacro_citep">(Xu et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2409.14878v1#bib.bib42" title="">2024</a>)</cite> presents the first comprehensive evaluation of multiple large language models on mental health prediction tasks, demonstrating that instruction fine-tuning significantly improves their performance.
MentaLLaMA <cite class="ltx_cite ltx_citemacro_citep">(Yang et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2409.14878v1#bib.bib44" title="">2024b</a>)</cite> is developed for interpretable mental health analysis on social media using the IMHI dataset, addressing challenges of data quality and model availability, and achieving strong performance and generalizability.
<cite class="ltx_cite ltx_citemacro_citep">(Qin et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2409.14878v1#bib.bib29" title="">2023</a>)</cite> proposes an interpretable depression detection method based on large language models, which diagnoses depression from social media content and provides explanations.
The SMILE approach <cite class="ltx_cite ltx_citemacro_citep">(Qiu et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2409.14878v1#bib.bib30" title="">2023</a>)</cite> uses ChatGPT to expand public single-turn dialogues into multi-turn conversations, creating a large-scale, diverse mental health support corpus that enhances the effectiveness of dialogue systems for emotional support.
<cite class="ltx_cite ltx_citemacro_citep">(Loh and Raamkumar, <a class="ltx_ref" href="https://arxiv.org/html/2409.14878v1#bib.bib21" title="">2023</a>)</cite> evaluates the ability of five LLMs to generate empathetic responses in mental health counseling conversations, finding that LLMs generally produced more empathetic responses than traditional dialogue systems fine-tuned on the same data.
LLMs enrich the paradigm of ADD methods by providing explanatory information for samples, but they still face challenges in depression detection scenarios due to the lack of specialized knowledge and the occurrence of hallucinations.</p>
</div>
<div class="ltx_para" id="S2.SS2.p5">
<p class="ltx_p" id="S2.SS2.p5.1">Unlike existing methods that focus on the patient-only or the patient-doctor view, our approach involves a doctor-patient-family perspective that includes family members in the treatment process.
At the functional level, our system involves family members and provides doctors with more comprehensive information, enhancing diagnostic efficiency.
At the methodology level, our approach introduces professional diagnostic standards to mitigate the issue of hallucinations, and overcomes the limitations of current methods modeling specific tasks. Based on that, our approach can provide a fixed-format report that involves binary classification, severity degree estimation, related experiences, corresponding diagnostic criteria, and fine-grained categorization.</p>
</div>
<figure class="ltx_figure" id="S2.F2">
<div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_2"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_figure_panel ltx_img_square" height="512" id="S2.F2.g1" src="extracted/5872729/2.png" width="419"/></div>
</div>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 2. </span>Patient and family’s user interface, where a,b, and c are patient’s chat, report, and treatment strategy pages, while d,e, and f are family’s chat, report, and care advice pages, respectively. Here we present the English version of the system’s functionality, while other language versions can be found in the Appendix <a class="ltx_ref" href="https://arxiv.org/html/2409.14878v1#A1" title="Appendix A Appendix ‣ InterMind: A Doctor-Patient-Family Interactive Depression Assessment System Empowered by Large Language Models"><span class="ltx_text ltx_ref_tag">A</span></a>.</figcaption><div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_1"><span class="ltx_ERROR ltx_centering ltx_figure_panel undefined" id="S2.F2.1">\Description</span></div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_1">
<p class="ltx_p ltx_figure_panel ltx_align_center" id="S2.F2.2">This figure shows user interfaces including patient’s chat, report treatment strategy pages, and family’s chat, report, and care advice pages.</p>
</div>
</div>
</figure>
<figure class="ltx_figure" id="S2.F3">
<div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_2"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_figure_panel ltx_img_landscape" height="247" id="S2.F3.g1" src="extracted/5872729/3.png" width="479"/></div>
</div>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 3. </span>Doctor’s user interface, which involves patient management menu, timeline, dialogues of patient and family, patient’s treatment strategy, family’s care advice, and diagnostic report. </figcaption><div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_1"><span class="ltx_ERROR ltx_centering ltx_figure_panel undefined" id="S2.F3.1">\Description</span></div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_1">
<p class="ltx_p ltx_figure_panel ltx_align_center" id="S2.F3.2">This figure shows the doctor’s user interface, which contains the patient management menu, timeline, dialogues of patient and family, patient’s treatment strategy, family’s care advice, and diagnostic report.</p>
</div>
</div>
</figure>
<figure class="ltx_figure" id="S2.F4">
<div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_2"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_figure_panel ltx_img_landscape" height="247" id="S2.F4.g1" src="extracted/5872729/4.png" width="479"/></div>
</div>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 4. </span>Cyclical analysis interface, which involves the interaction statistics for a month, such as login frequency, chat turns, the distribution of mental states, average scores, and the LLM’s analysis of mental states for the month.</figcaption><div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_1"><span class="ltx_ERROR ltx_centering ltx_figure_panel undefined" id="S2.F4.1">\Description</span></div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_1">
<p class="ltx_p ltx_figure_panel ltx_align_center" id="S2.F4.2">This figure shows a cyclical analysis interface, which contains the patient’s login frequency, chat turns, distribution of depressed and normal states, a bar chart illustrating how depression severity degree changes over time, average depression score, and cyclical analysis of AI psychologist.</p>
</div>
</div>
</figure>
</section>
</section>
<section class="ltx_section" id="S3">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">3. </span>Methodology</h2>
<div class="ltx_para" id="S3.p1">
<p class="ltx_p" id="S3.p1.1">First, we introduce the design of the InterMind system. Then, we introduce the technical details of building the AI Psychological Chatbot and AI Psychologist within the InterMind system.</p>
</div>
<section class="ltx_subsection" id="S3.SS1">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.1. </span>InterMind System</h3>
<div class="ltx_para" id="S3.SS1.p1">
<p class="ltx_p" id="S3.SS1.p1.1">We designed three distinct user interfaces for doctors, patients, and families to facilitate their interaction with the InterMind system. The interfaces for patients and families (Figure <a class="ltx_ref" href="https://arxiv.org/html/2409.14878v1#S2.F2" title="Figure 2 ‣ 2.2. Automatic Depression Detection (ADD) Methods ‣ 2. Related Works ‣ InterMind: A Doctor-Patient-Family Interactive Depression Assessment System Empowered by Large Language Models"><span class="ltx_text ltx_ref_tag">2</span></a>) are on mobile platforms, allowing them to access the system conveniently at home or other places at any time. In contrast, the interface for doctors (Figure <a class="ltx_ref" href="https://arxiv.org/html/2409.14878v1#S2.F3" title="Figure 3 ‣ 2.2. Automatic Depression Detection (ADD) Methods ‣ 2. Related Works ‣ InterMind: A Doctor-Patient-Family Interactive Depression Assessment System Empowered by Large Language Models"><span class="ltx_text ltx_ref_tag">3</span></a>) is web-based, considering that their daily work primarily takes place in hospitals where desktop computers are more suitable for viewing the comprehensive information provided by the InterMind system. In the following subsection, we will introduce each interface in detail.</p>
</div>
<section class="ltx_subsubsection" id="S3.SS1.SSS1">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">3.1.1. </span>Patient Interface</h4>
<div class="ltx_para" id="S3.SS1.SSS1.p1">
<p class="ltx_p" id="S3.SS1.SSS1.p1.1">As shown in Figure <a class="ltx_ref" href="https://arxiv.org/html/2409.14878v1#S2.F2" title="Figure 2 ‣ 2.2. Automatic Depression Detection (ADD) Methods ‣ 2. Related Works ‣ InterMind: A Doctor-Patient-Family Interactive Depression Assessment System Empowered by Large Language Models"><span class="ltx_text ltx_ref_tag">2</span></a>(a-c), we designed a collapsible menu in the upper left corner of the webpage. Upon logging in, the patient is firstly directed to a chat interface (Figure <a class="ltx_ref" href="https://arxiv.org/html/2409.14878v1#S2.F2" title="Figure 2 ‣ 2.2. Automatic Depression Detection (ADD) Methods ‣ 2. Related Works ‣ InterMind: A Doctor-Patient-Family Interactive Depression Assessment System Empowered by Large Language Models"><span class="ltx_text ltx_ref_tag">2</span></a>(a)) where they can begin interacting with the AI psychological chatbot within the InterMind system. During the conversation, the patient describes his/her recent experiences and feelings, while the AI chatbot provides psychological support. After the chat concludes, the dialogue content is forwarded to the system’s AI psychologist to generate an assistive diagnostic report. Once the doctor reviews and revises the report, the patient can view the diagnostic results (Figure <a class="ltx_ref" href="https://arxiv.org/html/2409.14878v1#S2.F2" title="Figure 2 ‣ 2.2. Automatic Depression Detection (ADD) Methods ‣ 2. Related Works ‣ InterMind: A Doctor-Patient-Family Interactive Depression Assessment System Empowered by Large Language Models"><span class="ltx_text ltx_ref_tag">2</span></a>(b)) by selecting the corresponding option in the menu. Additionally, the AI psychologist suggests a treatment strategy tailored to the patient, which, after being revised by the doctor, appears below the diagnostic report (Figure <a class="ltx_ref" href="https://arxiv.org/html/2409.14878v1#S2.F2" title="Figure 2 ‣ 2.2. Automatic Depression Detection (ADD) Methods ‣ 2. Related Works ‣ InterMind: A Doctor-Patient-Family Interactive Depression Assessment System Empowered by Large Language Models"><span class="ltx_text ltx_ref_tag">2</span></a>(c)). Finally, by selecting the last option in the menu, the patient can view the trends in their mental state over time, along with analysis provided by the AI psychologist (see section <a class="ltx_ref" href="https://arxiv.org/html/2409.14878v1#S3.SS1.SSS4" title="3.1.4. Cyclical Analysis Interface ‣ 3.1. InterMind System ‣ 3. Methodology ‣ InterMind: A Doctor-Patient-Family Interactive Depression Assessment System Empowered by Large Language Models"><span class="ltx_text ltx_ref_tag">3.1.4</span></a>).</p>
</div>
</section>
<section class="ltx_subsubsection" id="S3.SS1.SSS2">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">3.1.2. </span>Family Interface</h4>
<div class="ltx_para" id="S3.SS1.SSS2.p1">
<p class="ltx_p" id="S3.SS1.SSS2.p1.1">As shown in Figure <a class="ltx_ref" href="https://arxiv.org/html/2409.14878v1#S2.F2" title="Figure 2 ‣ 2.2. Automatic Depression Detection (ADD) Methods ‣ 2. Related Works ‣ InterMind: A Doctor-Patient-Family Interactive Depression Assessment System Empowered by Large Language Models"><span class="ltx_text ltx_ref_tag">2</span></a>(d-f), the design of the family interface is consistent with that of the patient interface. Family can engage in a conversation with the AI psychological chatbot to describe the patient’s recent objective conditions and symptoms (Figure <a class="ltx_ref" href="https://arxiv.org/html/2409.14878v1#S2.F2" title="Figure 2 ‣ 2.2. Automatic Depression Detection (ADD) Methods ‣ 2. Related Works ‣ InterMind: A Doctor-Patient-Family Interactive Depression Assessment System Empowered by Large Language Models"><span class="ltx_text ltx_ref_tag">2</span></a>(d)). After the conversation concludes, the content is also forwarded to the AI psychologist. Additionally, the family can view the patient’s diagnostic results in the report section (Figure <a class="ltx_ref" href="https://arxiv.org/html/2409.14878v1#S2.F2" title="Figure 2 ‣ 2.2. Automatic Depression Detection (ADD) Methods ‣ 2. Related Works ‣ InterMind: A Doctor-Patient-Family Interactive Depression Assessment System Empowered by Large Language Models"><span class="ltx_text ltx_ref_tag">2</span></a>(e)) and find care advice (Figure <a class="ltx_ref" href="https://arxiv.org/html/2409.14878v1#S2.F2" title="Figure 2 ‣ 2.2. Automatic Depression Detection (ADD) Methods ‣ 2. Related Works ‣ InterMind: A Doctor-Patient-Family Interactive Depression Assessment System Empowered by Large Language Models"><span class="ltx_text ltx_ref_tag">2</span></a>(f)) generated by the AI psychologist specifically for family, aimed at improving caregiving and supporting treatment. Notably, to protect user privacy, dialogues of family and patient are not shared with each other. Lastly, the family interface also includes periodic monitoring and analysis, where trends in the patient’s mental state over time and corresponding analysis by the AI psychologist are displayed.</p>
</div>
</section>
<section class="ltx_subsubsection" id="S3.SS1.SSS3">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">3.1.3. </span>Doctor Interface</h4>
<div class="ltx_para" id="S3.SS1.SSS3.p1">
<p class="ltx_p" id="S3.SS1.SSS3.p1.1">As shown in Figure <a class="ltx_ref" href="https://arxiv.org/html/2409.14878v1#S2.F3" title="Figure 3 ‣ 2.2. Automatic Depression Detection (ADD) Methods ‣ 2. Related Works ‣ InterMind: A Doctor-Patient-Family Interactive Depression Assessment System Empowered by Large Language Models"><span class="ltx_text ltx_ref_tag">3</span></a>, at the top of the doctor interface, we designed a patient management menu that displays all patients who want to consult the doctor. Each patient’s summary includes their most recent login time and the latest depression status predicted by the AI psychologist. Upon selecting a patient, the doctor interface displays a timeline on the left side, showing different interaction periods for the selected patient. When a specific time point is chosen, the interface presents the patient’s and family’s dialogue history with the AI psychological chatbot, the assistive diagnostic report generated by the AI psychologist, the treatment strategy for the patient, and the care advice for the family. By comparing the dialogue content of the patient and family, and referencing the report and advice, the doctor can make a few revisions before releasing the information to the patient and family, thus improving diagnostic efficiency. Additionally, the doctor can access periodic monitoring and analysis via a button in the lower left corner.</p>
</div>
</section>
<section class="ltx_subsubsection" id="S3.SS1.SSS4">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">3.1.4. </span>Cyclical Analysis Interface</h4>
<div class="ltx_para" id="S3.SS1.SSS4.p1">
<p class="ltx_p" id="S3.SS1.SSS4.p1.1">As shown in Figure <a class="ltx_ref" href="https://arxiv.org/html/2409.14878v1#S2.F4" title="Figure 4 ‣ 2.2. Automatic Depression Detection (ADD) Methods ‣ 2. Related Works ‣ InterMind: A Doctor-Patient-Family Interactive Depression Assessment System Empowered by Large Language Models"><span class="ltx_text ltx_ref_tag">4</span></a>, the doctor, patient, and family all have access to the cyclical analysis interface. This interface provides statistical information from the past month, such as the patient’s login frequency and the number of dialogue turns with the AI psychological chatbot. Additionally, the interface displays distribution in the patient’s depression degree severity over time based on the results of each diagnostic report. Specifically, a bar chart is used to represent these changes: a score of 0 is assigned for no interaction with InterMind, 25 for normal, 50 for mild, 75 for moderate, and 100 for severe depression. An average depression score is then calculated as a reference. Finally, the LLM analyzes the patient’s condition over the past month based on the diagnostic reports.</p>
</div>
</section>
</section>
<section class="ltx_subsection" id="S3.SS2">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.2. </span>AI Psychological Chatbot</h3>
<figure class="ltx_figure" id="S3.F5">
<div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_2"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_figure_panel ltx_img_landscape" height="211" id="S3.F5.g1" src="extracted/5872729/5.png" width="538"/></div>
</div>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 5. </span>The construction process of AI Psychological Chatbot. The proposed psychological counseling dialogue prompt engineering rewrites the rich experiences and feelings in social media posts {<math alttext="p_{i}" class="ltx_Math" display="inline" id="S3.F5.7.m1.1"><semantics id="S3.F5.7.m1.1b"><msub id="S3.F5.7.m1.1.1" xref="S3.F5.7.m1.1.1.cmml"><mi id="S3.F5.7.m1.1.1.2" xref="S3.F5.7.m1.1.1.2.cmml">p</mi><mi id="S3.F5.7.m1.1.1.3" xref="S3.F5.7.m1.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S3.F5.7.m1.1c"><apply id="S3.F5.7.m1.1.1.cmml" xref="S3.F5.7.m1.1.1"><csymbol cd="ambiguous" id="S3.F5.7.m1.1.1.1.cmml" xref="S3.F5.7.m1.1.1">subscript</csymbol><ci id="S3.F5.7.m1.1.1.2.cmml" xref="S3.F5.7.m1.1.1.2">𝑝</ci><ci id="S3.F5.7.m1.1.1.3.cmml" xref="S3.F5.7.m1.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.F5.7.m1.1d">p_{i}</annotation><annotation encoding="application/x-llamapun" id="S3.F5.7.m1.1e">italic_p start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT</annotation></semantics></math>} into psychological counseling dialogues {<math alttext="d_{i}" class="ltx_Math" display="inline" id="S3.F5.8.m2.1"><semantics id="S3.F5.8.m2.1b"><msub id="S3.F5.8.m2.1.1" xref="S3.F5.8.m2.1.1.cmml"><mi id="S3.F5.8.m2.1.1.2" xref="S3.F5.8.m2.1.1.2.cmml">d</mi><mi id="S3.F5.8.m2.1.1.3" xref="S3.F5.8.m2.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S3.F5.8.m2.1c"><apply id="S3.F5.8.m2.1.1.cmml" xref="S3.F5.8.m2.1.1"><csymbol cd="ambiguous" id="S3.F5.8.m2.1.1.1.cmml" xref="S3.F5.8.m2.1.1">subscript</csymbol><ci id="S3.F5.8.m2.1.1.2.cmml" xref="S3.F5.8.m2.1.1.2">𝑑</ci><ci id="S3.F5.8.m2.1.1.3.cmml" xref="S3.F5.8.m2.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.F5.8.m2.1d">d_{i}</annotation><annotation encoding="application/x-llamapun" id="S3.F5.8.m2.1e">italic_d start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT</annotation></semantics></math>}. The generated dialogues <math alttext="\mathcal{D}_{1}" class="ltx_Math" display="inline" id="S3.F5.9.m3.1"><semantics id="S3.F5.9.m3.1b"><msub id="S3.F5.9.m3.1.1" xref="S3.F5.9.m3.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.F5.9.m3.1.1.2" xref="S3.F5.9.m3.1.1.2.cmml">𝒟</mi><mn id="S3.F5.9.m3.1.1.3" xref="S3.F5.9.m3.1.1.3.cmml">1</mn></msub><annotation-xml encoding="MathML-Content" id="S3.F5.9.m3.1c"><apply id="S3.F5.9.m3.1.1.cmml" xref="S3.F5.9.m3.1.1"><csymbol cd="ambiguous" id="S3.F5.9.m3.1.1.1.cmml" xref="S3.F5.9.m3.1.1">subscript</csymbol><ci id="S3.F5.9.m3.1.1.2.cmml" xref="S3.F5.9.m3.1.1.2">𝒟</ci><cn id="S3.F5.9.m3.1.1.3.cmml" type="integer" xref="S3.F5.9.m3.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.F5.9.m3.1d">\mathcal{D}_{1}</annotation><annotation encoding="application/x-llamapun" id="S3.F5.9.m3.1e">caligraphic_D start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT</annotation></semantics></math> combined with clinical interview dialogues <math alttext="\mathcal{D}_{2}" class="ltx_Math" display="inline" id="S3.F5.10.m4.1"><semantics id="S3.F5.10.m4.1b"><msub id="S3.F5.10.m4.1.1" xref="S3.F5.10.m4.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.F5.10.m4.1.1.2" xref="S3.F5.10.m4.1.1.2.cmml">𝒟</mi><mn id="S3.F5.10.m4.1.1.3" xref="S3.F5.10.m4.1.1.3.cmml">2</mn></msub><annotation-xml encoding="MathML-Content" id="S3.F5.10.m4.1c"><apply id="S3.F5.10.m4.1.1.cmml" xref="S3.F5.10.m4.1.1"><csymbol cd="ambiguous" id="S3.F5.10.m4.1.1.1.cmml" xref="S3.F5.10.m4.1.1">subscript</csymbol><ci id="S3.F5.10.m4.1.1.2.cmml" xref="S3.F5.10.m4.1.1.2">𝒟</ci><cn id="S3.F5.10.m4.1.1.3.cmml" type="integer" xref="S3.F5.10.m4.1.1.3">2</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.F5.10.m4.1d">\mathcal{D}_{2}</annotation><annotation encoding="application/x-llamapun" id="S3.F5.10.m4.1e">caligraphic_D start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT</annotation></semantics></math>, form a dataset <math alttext="\mathcal{D}" class="ltx_Math" display="inline" id="S3.F5.11.m5.1"><semantics id="S3.F5.11.m5.1b"><mi class="ltx_font_mathcaligraphic" id="S3.F5.11.m5.1.1" xref="S3.F5.11.m5.1.1.cmml">𝒟</mi><annotation-xml encoding="MathML-Content" id="S3.F5.11.m5.1c"><ci id="S3.F5.11.m5.1.1.cmml" xref="S3.F5.11.m5.1.1">𝒟</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.F5.11.m5.1d">\mathcal{D}</annotation><annotation encoding="application/x-llamapun" id="S3.F5.11.m5.1e">caligraphic_D</annotation></semantics></math> used for instruction fine-tuning LLM, ultimately building an AI Psychological Chatbot (<math alttext="\theta_{1}^{*}" class="ltx_Math" display="inline" id="S3.F5.12.m6.1"><semantics id="S3.F5.12.m6.1b"><msubsup id="S3.F5.12.m6.1.1" xref="S3.F5.12.m6.1.1.cmml"><mi id="S3.F5.12.m6.1.1.2.2" xref="S3.F5.12.m6.1.1.2.2.cmml">θ</mi><mn id="S3.F5.12.m6.1.1.2.3" xref="S3.F5.12.m6.1.1.2.3.cmml">1</mn><mo id="S3.F5.12.m6.1.1.3" xref="S3.F5.12.m6.1.1.3.cmml">∗</mo></msubsup><annotation-xml encoding="MathML-Content" id="S3.F5.12.m6.1c"><apply id="S3.F5.12.m6.1.1.cmml" xref="S3.F5.12.m6.1.1"><csymbol cd="ambiguous" id="S3.F5.12.m6.1.1.1.cmml" xref="S3.F5.12.m6.1.1">superscript</csymbol><apply id="S3.F5.12.m6.1.1.2.cmml" xref="S3.F5.12.m6.1.1"><csymbol cd="ambiguous" id="S3.F5.12.m6.1.1.2.1.cmml" xref="S3.F5.12.m6.1.1">subscript</csymbol><ci id="S3.F5.12.m6.1.1.2.2.cmml" xref="S3.F5.12.m6.1.1.2.2">𝜃</ci><cn id="S3.F5.12.m6.1.1.2.3.cmml" type="integer" xref="S3.F5.12.m6.1.1.2.3">1</cn></apply><times id="S3.F5.12.m6.1.1.3.cmml" xref="S3.F5.12.m6.1.1.3"></times></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.F5.12.m6.1d">\theta_{1}^{*}</annotation><annotation encoding="application/x-llamapun" id="S3.F5.12.m6.1e">italic_θ start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ∗ end_POSTSUPERSCRIPT</annotation></semantics></math>).</figcaption><div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_1"><span class="ltx_ERROR ltx_centering ltx_figure_panel undefined" id="S3.F5.13">\Description</span></div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_1">
<p class="ltx_p ltx_figure_panel ltx_align_center" id="S3.F5.14">This figure shows the construction process of the AI Psychological Chatbot. Social media posts are rewritten into psychological counseling dialogues through the proposed psychological counseling dialogue prompt engineering. The rewritten data is then merged with clinical interview data, enhancing the LLM’s psychological counseling capabilities through instruction fine-tuning.</p>
</div>
</div>
</figure>
<figure class="ltx_figure" id="S3.F6">
<div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_2"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_figure_panel ltx_img_square" height="438" id="S3.F6.g1" src="extracted/5872729/6.png" width="538"/></div>
</div>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 6. </span>Prompt <math alttext="P_{1}" class="ltx_Math" display="inline" id="S3.F6.2.m1.1"><semantics id="S3.F6.2.m1.1b"><msub id="S3.F6.2.m1.1.1" xref="S3.F6.2.m1.1.1.cmml"><mi id="S3.F6.2.m1.1.1.2" xref="S3.F6.2.m1.1.1.2.cmml">P</mi><mn id="S3.F6.2.m1.1.1.3" xref="S3.F6.2.m1.1.1.3.cmml">1</mn></msub><annotation-xml encoding="MathML-Content" id="S3.F6.2.m1.1c"><apply id="S3.F6.2.m1.1.1.cmml" xref="S3.F6.2.m1.1.1"><csymbol cd="ambiguous" id="S3.F6.2.m1.1.1.1.cmml" xref="S3.F6.2.m1.1.1">subscript</csymbol><ci id="S3.F6.2.m1.1.1.2.cmml" xref="S3.F6.2.m1.1.1.2">𝑃</ci><cn id="S3.F6.2.m1.1.1.3.cmml" type="integer" xref="S3.F6.2.m1.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.F6.2.m1.1d">P_{1}</annotation><annotation encoding="application/x-llamapun" id="S3.F6.2.m1.1e">italic_P start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT</annotation></semantics></math> for psychological counseling dialogue generation. </figcaption><div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_1"><span class="ltx_ERROR ltx_centering ltx_figure_panel undefined" id="S3.F6.3">\Description</span></div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_1">
<p class="ltx_p ltx_figure_panel ltx_align_center" id="S3.F6.4">This figure shows the prompt we designed for generating psychological counseling dialogues.</p>
</div>
</div>
</figure>
<div class="ltx_para" id="S3.SS2.p1">
<p class="ltx_p" id="S3.SS2.p1.1">AI Psychological Chatbot aims at providing users with psychological counseling and support through multi-turn conversational interactions, allowing users to share their experiences and feelings.</p>
</div>
<section class="ltx_subsubsection" id="S3.SS2.SSS1">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">3.2.1. </span>Psychological Counseling Dialogue Prompt Engineering</h4>
<div class="ltx_para" id="S3.SS2.SSS1.p1">
<p class="ltx_p" id="S3.SS2.SSS1.p1.1">The current use of LLMs to build AI psychological chatbots faces several challenges. On one hand, existing LLMs often struggle to meet the conversational demands in psychological counseling scenarios, frequently generating responses that are either redundant or irrelevant to the context. On the other hand, although instruction fine-tuning can enhance an LLM’s performance in specific scenarios, psychological counseling data is difficult to obtain, with public datasets typically containing only a few dozen or hundred examples, which are insufficient for effective LLM training.</p>
</div>
<div class="ltx_para" id="S3.SS2.SSS1.p2">
<p class="ltx_p" id="S3.SS2.SSS1.p2.1">In contrast to publicly available interview datasets, depression-related social media datasets are more abundant and offer rich experiences and emotions. Therefore, as shown in Figure <a class="ltx_ref" href="https://arxiv.org/html/2409.14878v1#S3.F5" title="Figure 5 ‣ 3.2. AI Psychological Chatbot ‣ 3. Methodology ‣ InterMind: A Doctor-Patient-Family Interactive Depression Assessment System Empowered by Large Language Models"><span class="ltx_text ltx_ref_tag">5</span></a>, we propose a data augmentation approach based on dialogue rewriting with social media data. We develop psychological counseling dialogue prompt engineering, which utilizes designed prompts that guide GPT-4 <cite class="ltx_cite ltx_citemacro_citep">(Achiam et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2409.14878v1#bib.bib2" title="">2023</a>)</cite> to rewrite social media posts into dialogues appropriate for psychological counseling scenarios.</p>
</div>
<div class="ltx_para" id="S3.SS2.SSS1.p3">
<p class="ltx_p" id="S3.SS2.SSS1.p3.9">Specifically, inspired by <cite class="ltx_cite ltx_citemacro_citep">(Qiu et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2409.14878v1#bib.bib30" title="">2023</a>)</cite> which proposes the prompt that employs ChatGPT to extend public single-turn dialogues into multiturn ones, we refine the prompt to make it more standardized, and incorporate more fine-grained psychological counseling scenario settings.
The proposed prompt guides GPT-4 to gradually analyze experiences and emotions in social media posts according to the rules set in the prompt, and then rewrite the post as a conversation between the user and the AI psychological counselor.
As shown in Figure <a class="ltx_ref" href="https://arxiv.org/html/2409.14878v1#S3.F6" title="Figure 6 ‣ 3.2. AI Psychological Chatbot ‣ 3. Methodology ‣ InterMind: A Doctor-Patient-Family Interactive Depression Assessment System Empowered by Large Language Models"><span class="ltx_text ltx_ref_tag">6</span></a>, our psychological counseling dialogue generation prompt consists of three parts:</p>
<table class="ltx_equation ltx_eqn_table" id="S3.E1">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_left" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_left">(1)</span></td>
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="P_{1}=T+R+Q(p_{i})" class="ltx_Math" display="block" id="S3.E1.m1.1"><semantics id="S3.E1.m1.1a"><mrow id="S3.E1.m1.1.1" xref="S3.E1.m1.1.1.cmml"><msub id="S3.E1.m1.1.1.3" xref="S3.E1.m1.1.1.3.cmml"><mi id="S3.E1.m1.1.1.3.2" xref="S3.E1.m1.1.1.3.2.cmml">P</mi><mn id="S3.E1.m1.1.1.3.3" xref="S3.E1.m1.1.1.3.3.cmml">1</mn></msub><mo id="S3.E1.m1.1.1.2" xref="S3.E1.m1.1.1.2.cmml">=</mo><mrow id="S3.E1.m1.1.1.1" xref="S3.E1.m1.1.1.1.cmml"><mi id="S3.E1.m1.1.1.1.3" xref="S3.E1.m1.1.1.1.3.cmml">T</mi><mo id="S3.E1.m1.1.1.1.2" xref="S3.E1.m1.1.1.1.2.cmml">+</mo><mi id="S3.E1.m1.1.1.1.4" xref="S3.E1.m1.1.1.1.4.cmml">R</mi><mo id="S3.E1.m1.1.1.1.2a" xref="S3.E1.m1.1.1.1.2.cmml">+</mo><mrow id="S3.E1.m1.1.1.1.1" xref="S3.E1.m1.1.1.1.1.cmml"><mi id="S3.E1.m1.1.1.1.1.3" xref="S3.E1.m1.1.1.1.1.3.cmml">Q</mi><mo id="S3.E1.m1.1.1.1.1.2" xref="S3.E1.m1.1.1.1.1.2.cmml">⁢</mo><mrow id="S3.E1.m1.1.1.1.1.1.1" xref="S3.E1.m1.1.1.1.1.1.1.1.cmml"><mo id="S3.E1.m1.1.1.1.1.1.1.2" stretchy="false" xref="S3.E1.m1.1.1.1.1.1.1.1.cmml">(</mo><msub id="S3.E1.m1.1.1.1.1.1.1.1" xref="S3.E1.m1.1.1.1.1.1.1.1.cmml"><mi id="S3.E1.m1.1.1.1.1.1.1.1.2" xref="S3.E1.m1.1.1.1.1.1.1.1.2.cmml">p</mi><mi id="S3.E1.m1.1.1.1.1.1.1.1.3" xref="S3.E1.m1.1.1.1.1.1.1.1.3.cmml">i</mi></msub><mo id="S3.E1.m1.1.1.1.1.1.1.3" stretchy="false" xref="S3.E1.m1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.E1.m1.1b"><apply id="S3.E1.m1.1.1.cmml" xref="S3.E1.m1.1.1"><eq id="S3.E1.m1.1.1.2.cmml" xref="S3.E1.m1.1.1.2"></eq><apply id="S3.E1.m1.1.1.3.cmml" xref="S3.E1.m1.1.1.3"><csymbol cd="ambiguous" id="S3.E1.m1.1.1.3.1.cmml" xref="S3.E1.m1.1.1.3">subscript</csymbol><ci id="S3.E1.m1.1.1.3.2.cmml" xref="S3.E1.m1.1.1.3.2">𝑃</ci><cn id="S3.E1.m1.1.1.3.3.cmml" type="integer" xref="S3.E1.m1.1.1.3.3">1</cn></apply><apply id="S3.E1.m1.1.1.1.cmml" xref="S3.E1.m1.1.1.1"><plus id="S3.E1.m1.1.1.1.2.cmml" xref="S3.E1.m1.1.1.1.2"></plus><ci id="S3.E1.m1.1.1.1.3.cmml" xref="S3.E1.m1.1.1.1.3">𝑇</ci><ci id="S3.E1.m1.1.1.1.4.cmml" xref="S3.E1.m1.1.1.1.4">𝑅</ci><apply id="S3.E1.m1.1.1.1.1.cmml" xref="S3.E1.m1.1.1.1.1"><times id="S3.E1.m1.1.1.1.1.2.cmml" xref="S3.E1.m1.1.1.1.1.2"></times><ci id="S3.E1.m1.1.1.1.1.3.cmml" xref="S3.E1.m1.1.1.1.1.3">𝑄</ci><apply id="S3.E1.m1.1.1.1.1.1.1.1.cmml" xref="S3.E1.m1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E1.m1.1.1.1.1.1.1.1.1.cmml" xref="S3.E1.m1.1.1.1.1.1.1">subscript</csymbol><ci id="S3.E1.m1.1.1.1.1.1.1.1.2.cmml" xref="S3.E1.m1.1.1.1.1.1.1.1.2">𝑝</ci><ci id="S3.E1.m1.1.1.1.1.1.1.1.3.cmml" xref="S3.E1.m1.1.1.1.1.1.1.1.3">𝑖</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E1.m1.1c">P_{1}=T+R+Q(p_{i})</annotation><annotation encoding="application/x-llamapun" id="S3.E1.m1.1d">italic_P start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT = italic_T + italic_R + italic_Q ( italic_p start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT )</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S3.SS2.SSS1.p3.8">where instruction <math alttext="T" class="ltx_Math" display="inline" id="S3.SS2.SSS1.p3.1.m1.1"><semantics id="S3.SS2.SSS1.p3.1.m1.1a"><mi id="S3.SS2.SSS1.p3.1.m1.1.1" xref="S3.SS2.SSS1.p3.1.m1.1.1.cmml">T</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS1.p3.1.m1.1b"><ci id="S3.SS2.SSS1.p3.1.m1.1.1.cmml" xref="S3.SS2.SSS1.p3.1.m1.1.1">𝑇</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS1.p3.1.m1.1c">T</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS1.p3.1.m1.1d">italic_T</annotation></semantics></math> is a description of a specific task, requiring the LLM to follow the rules <math alttext="R" class="ltx_Math" display="inline" id="S3.SS2.SSS1.p3.2.m2.1"><semantics id="S3.SS2.SSS1.p3.2.m2.1a"><mi id="S3.SS2.SSS1.p3.2.m2.1.1" xref="S3.SS2.SSS1.p3.2.m2.1.1.cmml">R</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS1.p3.2.m2.1b"><ci id="S3.SS2.SSS1.p3.2.m2.1.1.cmml" xref="S3.SS2.SSS1.p3.2.m2.1.1">𝑅</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS1.p3.2.m2.1c">R</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS1.p3.2.m2.1d">italic_R</annotation></semantics></math> to rewrite the post <math alttext="p_{i}" class="ltx_Math" display="inline" id="S3.SS2.SSS1.p3.3.m3.1"><semantics id="S3.SS2.SSS1.p3.3.m3.1a"><msub id="S3.SS2.SSS1.p3.3.m3.1.1" xref="S3.SS2.SSS1.p3.3.m3.1.1.cmml"><mi id="S3.SS2.SSS1.p3.3.m3.1.1.2" xref="S3.SS2.SSS1.p3.3.m3.1.1.2.cmml">p</mi><mi id="S3.SS2.SSS1.p3.3.m3.1.1.3" xref="S3.SS2.SSS1.p3.3.m3.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS1.p3.3.m3.1b"><apply id="S3.SS2.SSS1.p3.3.m3.1.1.cmml" xref="S3.SS2.SSS1.p3.3.m3.1.1"><csymbol cd="ambiguous" id="S3.SS2.SSS1.p3.3.m3.1.1.1.cmml" xref="S3.SS2.SSS1.p3.3.m3.1.1">subscript</csymbol><ci id="S3.SS2.SSS1.p3.3.m3.1.1.2.cmml" xref="S3.SS2.SSS1.p3.3.m3.1.1.2">𝑝</ci><ci id="S3.SS2.SSS1.p3.3.m3.1.1.3.cmml" xref="S3.SS2.SSS1.p3.3.m3.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS1.p3.3.m3.1c">p_{i}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS1.p3.3.m3.1d">italic_p start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT</annotation></semantics></math> as a dialog. Among the specified eight rules, rules 1-2 (<math alttext="R1-R2" class="ltx_Math" display="inline" id="S3.SS2.SSS1.p3.4.m4.1"><semantics id="S3.SS2.SSS1.p3.4.m4.1a"><mrow id="S3.SS2.SSS1.p3.4.m4.1.1" xref="S3.SS2.SSS1.p3.4.m4.1.1.cmml"><mrow id="S3.SS2.SSS1.p3.4.m4.1.1.2" xref="S3.SS2.SSS1.p3.4.m4.1.1.2.cmml"><mi id="S3.SS2.SSS1.p3.4.m4.1.1.2.2" xref="S3.SS2.SSS1.p3.4.m4.1.1.2.2.cmml">R</mi><mo id="S3.SS2.SSS1.p3.4.m4.1.1.2.1" xref="S3.SS2.SSS1.p3.4.m4.1.1.2.1.cmml">⁢</mo><mn id="S3.SS2.SSS1.p3.4.m4.1.1.2.3" xref="S3.SS2.SSS1.p3.4.m4.1.1.2.3.cmml">1</mn></mrow><mo id="S3.SS2.SSS1.p3.4.m4.1.1.1" xref="S3.SS2.SSS1.p3.4.m4.1.1.1.cmml">−</mo><mrow id="S3.SS2.SSS1.p3.4.m4.1.1.3" xref="S3.SS2.SSS1.p3.4.m4.1.1.3.cmml"><mi id="S3.SS2.SSS1.p3.4.m4.1.1.3.2" xref="S3.SS2.SSS1.p3.4.m4.1.1.3.2.cmml">R</mi><mo id="S3.SS2.SSS1.p3.4.m4.1.1.3.1" xref="S3.SS2.SSS1.p3.4.m4.1.1.3.1.cmml">⁢</mo><mn id="S3.SS2.SSS1.p3.4.m4.1.1.3.3" xref="S3.SS2.SSS1.p3.4.m4.1.1.3.3.cmml">2</mn></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS1.p3.4.m4.1b"><apply id="S3.SS2.SSS1.p3.4.m4.1.1.cmml" xref="S3.SS2.SSS1.p3.4.m4.1.1"><minus id="S3.SS2.SSS1.p3.4.m4.1.1.1.cmml" xref="S3.SS2.SSS1.p3.4.m4.1.1.1"></minus><apply id="S3.SS2.SSS1.p3.4.m4.1.1.2.cmml" xref="S3.SS2.SSS1.p3.4.m4.1.1.2"><times id="S3.SS2.SSS1.p3.4.m4.1.1.2.1.cmml" xref="S3.SS2.SSS1.p3.4.m4.1.1.2.1"></times><ci id="S3.SS2.SSS1.p3.4.m4.1.1.2.2.cmml" xref="S3.SS2.SSS1.p3.4.m4.1.1.2.2">𝑅</ci><cn id="S3.SS2.SSS1.p3.4.m4.1.1.2.3.cmml" type="integer" xref="S3.SS2.SSS1.p3.4.m4.1.1.2.3">1</cn></apply><apply id="S3.SS2.SSS1.p3.4.m4.1.1.3.cmml" xref="S3.SS2.SSS1.p3.4.m4.1.1.3"><times id="S3.SS2.SSS1.p3.4.m4.1.1.3.1.cmml" xref="S3.SS2.SSS1.p3.4.m4.1.1.3.1"></times><ci id="S3.SS2.SSS1.p3.4.m4.1.1.3.2.cmml" xref="S3.SS2.SSS1.p3.4.m4.1.1.3.2">𝑅</ci><cn id="S3.SS2.SSS1.p3.4.m4.1.1.3.3.cmml" type="integer" xref="S3.SS2.SSS1.p3.4.m4.1.1.3.3">2</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS1.p3.4.m4.1c">R1-R2</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS1.p3.4.m4.1d">italic_R 1 - italic_R 2</annotation></semantics></math>) control the format of the dialogue’s beginning. Rules 3-6 (<math alttext="R3-R6" class="ltx_Math" display="inline" id="S3.SS2.SSS1.p3.5.m5.1"><semantics id="S3.SS2.SSS1.p3.5.m5.1a"><mrow id="S3.SS2.SSS1.p3.5.m5.1.1" xref="S3.SS2.SSS1.p3.5.m5.1.1.cmml"><mrow id="S3.SS2.SSS1.p3.5.m5.1.1.2" xref="S3.SS2.SSS1.p3.5.m5.1.1.2.cmml"><mi id="S3.SS2.SSS1.p3.5.m5.1.1.2.2" xref="S3.SS2.SSS1.p3.5.m5.1.1.2.2.cmml">R</mi><mo id="S3.SS2.SSS1.p3.5.m5.1.1.2.1" xref="S3.SS2.SSS1.p3.5.m5.1.1.2.1.cmml">⁢</mo><mn id="S3.SS2.SSS1.p3.5.m5.1.1.2.3" xref="S3.SS2.SSS1.p3.5.m5.1.1.2.3.cmml">3</mn></mrow><mo id="S3.SS2.SSS1.p3.5.m5.1.1.1" xref="S3.SS2.SSS1.p3.5.m5.1.1.1.cmml">−</mo><mrow id="S3.SS2.SSS1.p3.5.m5.1.1.3" xref="S3.SS2.SSS1.p3.5.m5.1.1.3.cmml"><mi id="S3.SS2.SSS1.p3.5.m5.1.1.3.2" xref="S3.SS2.SSS1.p3.5.m5.1.1.3.2.cmml">R</mi><mo id="S3.SS2.SSS1.p3.5.m5.1.1.3.1" xref="S3.SS2.SSS1.p3.5.m5.1.1.3.1.cmml">⁢</mo><mn id="S3.SS2.SSS1.p3.5.m5.1.1.3.3" xref="S3.SS2.SSS1.p3.5.m5.1.1.3.3.cmml">6</mn></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS1.p3.5.m5.1b"><apply id="S3.SS2.SSS1.p3.5.m5.1.1.cmml" xref="S3.SS2.SSS1.p3.5.m5.1.1"><minus id="S3.SS2.SSS1.p3.5.m5.1.1.1.cmml" xref="S3.SS2.SSS1.p3.5.m5.1.1.1"></minus><apply id="S3.SS2.SSS1.p3.5.m5.1.1.2.cmml" xref="S3.SS2.SSS1.p3.5.m5.1.1.2"><times id="S3.SS2.SSS1.p3.5.m5.1.1.2.1.cmml" xref="S3.SS2.SSS1.p3.5.m5.1.1.2.1"></times><ci id="S3.SS2.SSS1.p3.5.m5.1.1.2.2.cmml" xref="S3.SS2.SSS1.p3.5.m5.1.1.2.2">𝑅</ci><cn id="S3.SS2.SSS1.p3.5.m5.1.1.2.3.cmml" type="integer" xref="S3.SS2.SSS1.p3.5.m5.1.1.2.3">3</cn></apply><apply id="S3.SS2.SSS1.p3.5.m5.1.1.3.cmml" xref="S3.SS2.SSS1.p3.5.m5.1.1.3"><times id="S3.SS2.SSS1.p3.5.m5.1.1.3.1.cmml" xref="S3.SS2.SSS1.p3.5.m5.1.1.3.1"></times><ci id="S3.SS2.SSS1.p3.5.m5.1.1.3.2.cmml" xref="S3.SS2.SSS1.p3.5.m5.1.1.3.2">𝑅</ci><cn id="S3.SS2.SSS1.p3.5.m5.1.1.3.3.cmml" type="integer" xref="S3.SS2.SSS1.p3.5.m5.1.1.3.3">6</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS1.p3.5.m5.1c">R3-R6</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS1.p3.5.m5.1d">italic_R 3 - italic_R 6</annotation></semantics></math>) require different characters to share content according to their roles and define the style of the dialogue’s setting. Rules 7-8 (<math alttext="R7-R8" class="ltx_Math" display="inline" id="S3.SS2.SSS1.p3.6.m6.1"><semantics id="S3.SS2.SSS1.p3.6.m6.1a"><mrow id="S3.SS2.SSS1.p3.6.m6.1.1" xref="S3.SS2.SSS1.p3.6.m6.1.1.cmml"><mrow id="S3.SS2.SSS1.p3.6.m6.1.1.2" xref="S3.SS2.SSS1.p3.6.m6.1.1.2.cmml"><mi id="S3.SS2.SSS1.p3.6.m6.1.1.2.2" xref="S3.SS2.SSS1.p3.6.m6.1.1.2.2.cmml">R</mi><mo id="S3.SS2.SSS1.p3.6.m6.1.1.2.1" xref="S3.SS2.SSS1.p3.6.m6.1.1.2.1.cmml">⁢</mo><mn id="S3.SS2.SSS1.p3.6.m6.1.1.2.3" xref="S3.SS2.SSS1.p3.6.m6.1.1.2.3.cmml">7</mn></mrow><mo id="S3.SS2.SSS1.p3.6.m6.1.1.1" xref="S3.SS2.SSS1.p3.6.m6.1.1.1.cmml">−</mo><mrow id="S3.SS2.SSS1.p3.6.m6.1.1.3" xref="S3.SS2.SSS1.p3.6.m6.1.1.3.cmml"><mi id="S3.SS2.SSS1.p3.6.m6.1.1.3.2" xref="S3.SS2.SSS1.p3.6.m6.1.1.3.2.cmml">R</mi><mo id="S3.SS2.SSS1.p3.6.m6.1.1.3.1" xref="S3.SS2.SSS1.p3.6.m6.1.1.3.1.cmml">⁢</mo><mn id="S3.SS2.SSS1.p3.6.m6.1.1.3.3" xref="S3.SS2.SSS1.p3.6.m6.1.1.3.3.cmml">8</mn></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS1.p3.6.m6.1b"><apply id="S3.SS2.SSS1.p3.6.m6.1.1.cmml" xref="S3.SS2.SSS1.p3.6.m6.1.1"><minus id="S3.SS2.SSS1.p3.6.m6.1.1.1.cmml" xref="S3.SS2.SSS1.p3.6.m6.1.1.1"></minus><apply id="S3.SS2.SSS1.p3.6.m6.1.1.2.cmml" xref="S3.SS2.SSS1.p3.6.m6.1.1.2"><times id="S3.SS2.SSS1.p3.6.m6.1.1.2.1.cmml" xref="S3.SS2.SSS1.p3.6.m6.1.1.2.1"></times><ci id="S3.SS2.SSS1.p3.6.m6.1.1.2.2.cmml" xref="S3.SS2.SSS1.p3.6.m6.1.1.2.2">𝑅</ci><cn id="S3.SS2.SSS1.p3.6.m6.1.1.2.3.cmml" type="integer" xref="S3.SS2.SSS1.p3.6.m6.1.1.2.3">7</cn></apply><apply id="S3.SS2.SSS1.p3.6.m6.1.1.3.cmml" xref="S3.SS2.SSS1.p3.6.m6.1.1.3"><times id="S3.SS2.SSS1.p3.6.m6.1.1.3.1.cmml" xref="S3.SS2.SSS1.p3.6.m6.1.1.3.1"></times><ci id="S3.SS2.SSS1.p3.6.m6.1.1.3.2.cmml" xref="S3.SS2.SSS1.p3.6.m6.1.1.3.2">𝑅</ci><cn id="S3.SS2.SSS1.p3.6.m6.1.1.3.3.cmml" type="integer" xref="S3.SS2.SSS1.p3.6.m6.1.1.3.3">8</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS1.p3.6.m6.1c">R7-R8</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS1.p3.6.m6.1d">italic_R 7 - italic_R 8</annotation></semantics></math>) set limitations on the length of the dialogue and the number of turns. Finally, we provide the post <math alttext="p_{i}" class="ltx_Math" display="inline" id="S3.SS2.SSS1.p3.7.m7.1"><semantics id="S3.SS2.SSS1.p3.7.m7.1a"><msub id="S3.SS2.SSS1.p3.7.m7.1.1" xref="S3.SS2.SSS1.p3.7.m7.1.1.cmml"><mi id="S3.SS2.SSS1.p3.7.m7.1.1.2" xref="S3.SS2.SSS1.p3.7.m7.1.1.2.cmml">p</mi><mi id="S3.SS2.SSS1.p3.7.m7.1.1.3" xref="S3.SS2.SSS1.p3.7.m7.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS1.p3.7.m7.1b"><apply id="S3.SS2.SSS1.p3.7.m7.1.1.cmml" xref="S3.SS2.SSS1.p3.7.m7.1.1"><csymbol cd="ambiguous" id="S3.SS2.SSS1.p3.7.m7.1.1.1.cmml" xref="S3.SS2.SSS1.p3.7.m7.1.1">subscript</csymbol><ci id="S3.SS2.SSS1.p3.7.m7.1.1.2.cmml" xref="S3.SS2.SSS1.p3.7.m7.1.1.2">𝑝</ci><ci id="S3.SS2.SSS1.p3.7.m7.1.1.3.cmml" xref="S3.SS2.SSS1.p3.7.m7.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS1.p3.7.m7.1c">p_{i}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS1.p3.7.m7.1d">italic_p start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT</annotation></semantics></math> in the query, require the LLM to analyze it step by step, and rewrite the content as a dialogue. Based on the designed prompt <math alttext="P_{1}" class="ltx_Math" display="inline" id="S3.SS2.SSS1.p3.8.m8.1"><semantics id="S3.SS2.SSS1.p3.8.m8.1a"><msub id="S3.SS2.SSS1.p3.8.m8.1.1" xref="S3.SS2.SSS1.p3.8.m8.1.1.cmml"><mi id="S3.SS2.SSS1.p3.8.m8.1.1.2" xref="S3.SS2.SSS1.p3.8.m8.1.1.2.cmml">P</mi><mn id="S3.SS2.SSS1.p3.8.m8.1.1.3" xref="S3.SS2.SSS1.p3.8.m8.1.1.3.cmml">1</mn></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS1.p3.8.m8.1b"><apply id="S3.SS2.SSS1.p3.8.m8.1.1.cmml" xref="S3.SS2.SSS1.p3.8.m8.1.1"><csymbol cd="ambiguous" id="S3.SS2.SSS1.p3.8.m8.1.1.1.cmml" xref="S3.SS2.SSS1.p3.8.m8.1.1">subscript</csymbol><ci id="S3.SS2.SSS1.p3.8.m8.1.1.2.cmml" xref="S3.SS2.SSS1.p3.8.m8.1.1.2">𝑃</ci><cn id="S3.SS2.SSS1.p3.8.m8.1.1.3.cmml" type="integer" xref="S3.SS2.SSS1.p3.8.m8.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS1.p3.8.m8.1c">P_{1}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS1.p3.8.m8.1d">italic_P start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT</annotation></semantics></math>, the LLM can generate multi-turn dialogue content between the user and an AI counselor. The content derives from rich and authentic experiences and feelings shared in social media posts, thus avoiding fabrications.</p>
</div>
</section>
<section class="ltx_subsubsection" id="S3.SS2.SSS2">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">3.2.2. </span>Instruction Fine-tuning for AI Psychological Chatbot</h4>
<div class="ltx_para" id="S3.SS2.SSS2.p1">
<p class="ltx_p" id="S3.SS2.SSS2.p1.10">Thus, we can combine dialogue data <math alttext="\mathcal{D}_{1}" class="ltx_Math" display="inline" id="S3.SS2.SSS2.p1.1.m1.1"><semantics id="S3.SS2.SSS2.p1.1.m1.1a"><msub id="S3.SS2.SSS2.p1.1.m1.1.1" xref="S3.SS2.SSS2.p1.1.m1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS2.SSS2.p1.1.m1.1.1.2" xref="S3.SS2.SSS2.p1.1.m1.1.1.2.cmml">𝒟</mi><mn id="S3.SS2.SSS2.p1.1.m1.1.1.3" xref="S3.SS2.SSS2.p1.1.m1.1.1.3.cmml">1</mn></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS2.p1.1.m1.1b"><apply id="S3.SS2.SSS2.p1.1.m1.1.1.cmml" xref="S3.SS2.SSS2.p1.1.m1.1.1"><csymbol cd="ambiguous" id="S3.SS2.SSS2.p1.1.m1.1.1.1.cmml" xref="S3.SS2.SSS2.p1.1.m1.1.1">subscript</csymbol><ci id="S3.SS2.SSS2.p1.1.m1.1.1.2.cmml" xref="S3.SS2.SSS2.p1.1.m1.1.1.2">𝒟</ci><cn id="S3.SS2.SSS2.p1.1.m1.1.1.3.cmml" type="integer" xref="S3.SS2.SSS2.p1.1.m1.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS2.p1.1.m1.1c">\mathcal{D}_{1}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS2.p1.1.m1.1d">caligraphic_D start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT</annotation></semantics></math> generated from social media with existing clinical interview data <math alttext="\mathcal{D}_{2}" class="ltx_Math" display="inline" id="S3.SS2.SSS2.p1.2.m2.1"><semantics id="S3.SS2.SSS2.p1.2.m2.1a"><msub id="S3.SS2.SSS2.p1.2.m2.1.1" xref="S3.SS2.SSS2.p1.2.m2.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS2.SSS2.p1.2.m2.1.1.2" xref="S3.SS2.SSS2.p1.2.m2.1.1.2.cmml">𝒟</mi><mn id="S3.SS2.SSS2.p1.2.m2.1.1.3" xref="S3.SS2.SSS2.p1.2.m2.1.1.3.cmml">2</mn></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS2.p1.2.m2.1b"><apply id="S3.SS2.SSS2.p1.2.m2.1.1.cmml" xref="S3.SS2.SSS2.p1.2.m2.1.1"><csymbol cd="ambiguous" id="S3.SS2.SSS2.p1.2.m2.1.1.1.cmml" xref="S3.SS2.SSS2.p1.2.m2.1.1">subscript</csymbol><ci id="S3.SS2.SSS2.p1.2.m2.1.1.2.cmml" xref="S3.SS2.SSS2.p1.2.m2.1.1.2">𝒟</ci><cn id="S3.SS2.SSS2.p1.2.m2.1.1.3.cmml" type="integer" xref="S3.SS2.SSS2.p1.2.m2.1.1.3">2</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS2.p1.2.m2.1c">\mathcal{D}_{2}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS2.p1.2.m2.1d">caligraphic_D start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT</annotation></semantics></math> to create a comprehensive multi-turn dialogue dataset <math alttext="\mathcal{D}=\{\mathcal{D}_{1},\mathcal{D}_{2}\}" class="ltx_Math" display="inline" id="S3.SS2.SSS2.p1.3.m3.2"><semantics id="S3.SS2.SSS2.p1.3.m3.2a"><mrow id="S3.SS2.SSS2.p1.3.m3.2.2" xref="S3.SS2.SSS2.p1.3.m3.2.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS2.SSS2.p1.3.m3.2.2.4" xref="S3.SS2.SSS2.p1.3.m3.2.2.4.cmml">𝒟</mi><mo id="S3.SS2.SSS2.p1.3.m3.2.2.3" xref="S3.SS2.SSS2.p1.3.m3.2.2.3.cmml">=</mo><mrow id="S3.SS2.SSS2.p1.3.m3.2.2.2.2" xref="S3.SS2.SSS2.p1.3.m3.2.2.2.3.cmml"><mo id="S3.SS2.SSS2.p1.3.m3.2.2.2.2.3" stretchy="false" xref="S3.SS2.SSS2.p1.3.m3.2.2.2.3.cmml">{</mo><msub id="S3.SS2.SSS2.p1.3.m3.1.1.1.1.1" xref="S3.SS2.SSS2.p1.3.m3.1.1.1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS2.SSS2.p1.3.m3.1.1.1.1.1.2" xref="S3.SS2.SSS2.p1.3.m3.1.1.1.1.1.2.cmml">𝒟</mi><mn id="S3.SS2.SSS2.p1.3.m3.1.1.1.1.1.3" xref="S3.SS2.SSS2.p1.3.m3.1.1.1.1.1.3.cmml">1</mn></msub><mo id="S3.SS2.SSS2.p1.3.m3.2.2.2.2.4" xref="S3.SS2.SSS2.p1.3.m3.2.2.2.3.cmml">,</mo><msub id="S3.SS2.SSS2.p1.3.m3.2.2.2.2.2" xref="S3.SS2.SSS2.p1.3.m3.2.2.2.2.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS2.SSS2.p1.3.m3.2.2.2.2.2.2" xref="S3.SS2.SSS2.p1.3.m3.2.2.2.2.2.2.cmml">𝒟</mi><mn id="S3.SS2.SSS2.p1.3.m3.2.2.2.2.2.3" xref="S3.SS2.SSS2.p1.3.m3.2.2.2.2.2.3.cmml">2</mn></msub><mo id="S3.SS2.SSS2.p1.3.m3.2.2.2.2.5" stretchy="false" xref="S3.SS2.SSS2.p1.3.m3.2.2.2.3.cmml">}</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS2.p1.3.m3.2b"><apply id="S3.SS2.SSS2.p1.3.m3.2.2.cmml" xref="S3.SS2.SSS2.p1.3.m3.2.2"><eq id="S3.SS2.SSS2.p1.3.m3.2.2.3.cmml" xref="S3.SS2.SSS2.p1.3.m3.2.2.3"></eq><ci id="S3.SS2.SSS2.p1.3.m3.2.2.4.cmml" xref="S3.SS2.SSS2.p1.3.m3.2.2.4">𝒟</ci><set id="S3.SS2.SSS2.p1.3.m3.2.2.2.3.cmml" xref="S3.SS2.SSS2.p1.3.m3.2.2.2.2"><apply id="S3.SS2.SSS2.p1.3.m3.1.1.1.1.1.cmml" xref="S3.SS2.SSS2.p1.3.m3.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS2.SSS2.p1.3.m3.1.1.1.1.1.1.cmml" xref="S3.SS2.SSS2.p1.3.m3.1.1.1.1.1">subscript</csymbol><ci id="S3.SS2.SSS2.p1.3.m3.1.1.1.1.1.2.cmml" xref="S3.SS2.SSS2.p1.3.m3.1.1.1.1.1.2">𝒟</ci><cn id="S3.SS2.SSS2.p1.3.m3.1.1.1.1.1.3.cmml" type="integer" xref="S3.SS2.SSS2.p1.3.m3.1.1.1.1.1.3">1</cn></apply><apply id="S3.SS2.SSS2.p1.3.m3.2.2.2.2.2.cmml" xref="S3.SS2.SSS2.p1.3.m3.2.2.2.2.2"><csymbol cd="ambiguous" id="S3.SS2.SSS2.p1.3.m3.2.2.2.2.2.1.cmml" xref="S3.SS2.SSS2.p1.3.m3.2.2.2.2.2">subscript</csymbol><ci id="S3.SS2.SSS2.p1.3.m3.2.2.2.2.2.2.cmml" xref="S3.SS2.SSS2.p1.3.m3.2.2.2.2.2.2">𝒟</ci><cn id="S3.SS2.SSS2.p1.3.m3.2.2.2.2.2.3.cmml" type="integer" xref="S3.SS2.SSS2.p1.3.m3.2.2.2.2.2.3">2</cn></apply></set></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS2.p1.3.m3.2c">\mathcal{D}=\{\mathcal{D}_{1},\mathcal{D}_{2}\}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS2.p1.3.m3.2d">caligraphic_D = { caligraphic_D start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT , caligraphic_D start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT }</annotation></semantics></math>. This dataset contains sufficient samples to fine-tune the LLM, enabling the development of an AI Psychological Chatbot. The dataset <math alttext="\mathcal{D}" class="ltx_Math" display="inline" id="S3.SS2.SSS2.p1.4.m4.1"><semantics id="S3.SS2.SSS2.p1.4.m4.1a"><mi class="ltx_font_mathcaligraphic" id="S3.SS2.SSS2.p1.4.m4.1.1" xref="S3.SS2.SSS2.p1.4.m4.1.1.cmml">𝒟</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS2.p1.4.m4.1b"><ci id="S3.SS2.SSS2.p1.4.m4.1.1.cmml" xref="S3.SS2.SSS2.p1.4.m4.1.1">𝒟</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS2.p1.4.m4.1c">\mathcal{D}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS2.p1.4.m4.1d">caligraphic_D</annotation></semantics></math> consists of multiple dialogues, where each dialogue
<math alttext="d_{i}" class="ltx_Math" display="inline" id="S3.SS2.SSS2.p1.5.m5.1"><semantics id="S3.SS2.SSS2.p1.5.m5.1a"><msub id="S3.SS2.SSS2.p1.5.m5.1.1" xref="S3.SS2.SSS2.p1.5.m5.1.1.cmml"><mi id="S3.SS2.SSS2.p1.5.m5.1.1.2" xref="S3.SS2.SSS2.p1.5.m5.1.1.2.cmml">d</mi><mi id="S3.SS2.SSS2.p1.5.m5.1.1.3" xref="S3.SS2.SSS2.p1.5.m5.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS2.p1.5.m5.1b"><apply id="S3.SS2.SSS2.p1.5.m5.1.1.cmml" xref="S3.SS2.SSS2.p1.5.m5.1.1"><csymbol cd="ambiguous" id="S3.SS2.SSS2.p1.5.m5.1.1.1.cmml" xref="S3.SS2.SSS2.p1.5.m5.1.1">subscript</csymbol><ci id="S3.SS2.SSS2.p1.5.m5.1.1.2.cmml" xref="S3.SS2.SSS2.p1.5.m5.1.1.2">𝑑</ci><ci id="S3.SS2.SSS2.p1.5.m5.1.1.3.cmml" xref="S3.SS2.SSS2.p1.5.m5.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS2.p1.5.m5.1c">d_{i}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS2.p1.5.m5.1d">italic_d start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT</annotation></semantics></math> contains several turns of interactions <math alttext="(u_{i}^{j},r_{i}^{j})" class="ltx_Math" display="inline" id="S3.SS2.SSS2.p1.6.m6.2"><semantics id="S3.SS2.SSS2.p1.6.m6.2a"><mrow id="S3.SS2.SSS2.p1.6.m6.2.2.2" xref="S3.SS2.SSS2.p1.6.m6.2.2.3.cmml"><mo id="S3.SS2.SSS2.p1.6.m6.2.2.2.3" stretchy="false" xref="S3.SS2.SSS2.p1.6.m6.2.2.3.cmml">(</mo><msubsup id="S3.SS2.SSS2.p1.6.m6.1.1.1.1" xref="S3.SS2.SSS2.p1.6.m6.1.1.1.1.cmml"><mi id="S3.SS2.SSS2.p1.6.m6.1.1.1.1.2.2" xref="S3.SS2.SSS2.p1.6.m6.1.1.1.1.2.2.cmml">u</mi><mi id="S3.SS2.SSS2.p1.6.m6.1.1.1.1.2.3" xref="S3.SS2.SSS2.p1.6.m6.1.1.1.1.2.3.cmml">i</mi><mi id="S3.SS2.SSS2.p1.6.m6.1.1.1.1.3" xref="S3.SS2.SSS2.p1.6.m6.1.1.1.1.3.cmml">j</mi></msubsup><mo id="S3.SS2.SSS2.p1.6.m6.2.2.2.4" xref="S3.SS2.SSS2.p1.6.m6.2.2.3.cmml">,</mo><msubsup id="S3.SS2.SSS2.p1.6.m6.2.2.2.2" xref="S3.SS2.SSS2.p1.6.m6.2.2.2.2.cmml"><mi id="S3.SS2.SSS2.p1.6.m6.2.2.2.2.2.2" xref="S3.SS2.SSS2.p1.6.m6.2.2.2.2.2.2.cmml">r</mi><mi id="S3.SS2.SSS2.p1.6.m6.2.2.2.2.2.3" xref="S3.SS2.SSS2.p1.6.m6.2.2.2.2.2.3.cmml">i</mi><mi id="S3.SS2.SSS2.p1.6.m6.2.2.2.2.3" xref="S3.SS2.SSS2.p1.6.m6.2.2.2.2.3.cmml">j</mi></msubsup><mo id="S3.SS2.SSS2.p1.6.m6.2.2.2.5" stretchy="false" xref="S3.SS2.SSS2.p1.6.m6.2.2.3.cmml">)</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS2.p1.6.m6.2b"><interval closure="open" id="S3.SS2.SSS2.p1.6.m6.2.2.3.cmml" xref="S3.SS2.SSS2.p1.6.m6.2.2.2"><apply id="S3.SS2.SSS2.p1.6.m6.1.1.1.1.cmml" xref="S3.SS2.SSS2.p1.6.m6.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS2.SSS2.p1.6.m6.1.1.1.1.1.cmml" xref="S3.SS2.SSS2.p1.6.m6.1.1.1.1">superscript</csymbol><apply id="S3.SS2.SSS2.p1.6.m6.1.1.1.1.2.cmml" xref="S3.SS2.SSS2.p1.6.m6.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS2.SSS2.p1.6.m6.1.1.1.1.2.1.cmml" xref="S3.SS2.SSS2.p1.6.m6.1.1.1.1">subscript</csymbol><ci id="S3.SS2.SSS2.p1.6.m6.1.1.1.1.2.2.cmml" xref="S3.SS2.SSS2.p1.6.m6.1.1.1.1.2.2">𝑢</ci><ci id="S3.SS2.SSS2.p1.6.m6.1.1.1.1.2.3.cmml" xref="S3.SS2.SSS2.p1.6.m6.1.1.1.1.2.3">𝑖</ci></apply><ci id="S3.SS2.SSS2.p1.6.m6.1.1.1.1.3.cmml" xref="S3.SS2.SSS2.p1.6.m6.1.1.1.1.3">𝑗</ci></apply><apply id="S3.SS2.SSS2.p1.6.m6.2.2.2.2.cmml" xref="S3.SS2.SSS2.p1.6.m6.2.2.2.2"><csymbol cd="ambiguous" id="S3.SS2.SSS2.p1.6.m6.2.2.2.2.1.cmml" xref="S3.SS2.SSS2.p1.6.m6.2.2.2.2">superscript</csymbol><apply id="S3.SS2.SSS2.p1.6.m6.2.2.2.2.2.cmml" xref="S3.SS2.SSS2.p1.6.m6.2.2.2.2"><csymbol cd="ambiguous" id="S3.SS2.SSS2.p1.6.m6.2.2.2.2.2.1.cmml" xref="S3.SS2.SSS2.p1.6.m6.2.2.2.2">subscript</csymbol><ci id="S3.SS2.SSS2.p1.6.m6.2.2.2.2.2.2.cmml" xref="S3.SS2.SSS2.p1.6.m6.2.2.2.2.2.2">𝑟</ci><ci id="S3.SS2.SSS2.p1.6.m6.2.2.2.2.2.3.cmml" xref="S3.SS2.SSS2.p1.6.m6.2.2.2.2.2.3">𝑖</ci></apply><ci id="S3.SS2.SSS2.p1.6.m6.2.2.2.2.3.cmml" xref="S3.SS2.SSS2.p1.6.m6.2.2.2.2.3">𝑗</ci></apply></interval></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS2.p1.6.m6.2c">(u_{i}^{j},r_{i}^{j})</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS2.p1.6.m6.2d">( italic_u start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_j end_POSTSUPERSCRIPT , italic_r start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_j end_POSTSUPERSCRIPT )</annotation></semantics></math>, where <math alttext="u_{i}^{j}" class="ltx_Math" display="inline" id="S3.SS2.SSS2.p1.7.m7.1"><semantics id="S3.SS2.SSS2.p1.7.m7.1a"><msubsup id="S3.SS2.SSS2.p1.7.m7.1.1" xref="S3.SS2.SSS2.p1.7.m7.1.1.cmml"><mi id="S3.SS2.SSS2.p1.7.m7.1.1.2.2" xref="S3.SS2.SSS2.p1.7.m7.1.1.2.2.cmml">u</mi><mi id="S3.SS2.SSS2.p1.7.m7.1.1.2.3" xref="S3.SS2.SSS2.p1.7.m7.1.1.2.3.cmml">i</mi><mi id="S3.SS2.SSS2.p1.7.m7.1.1.3" xref="S3.SS2.SSS2.p1.7.m7.1.1.3.cmml">j</mi></msubsup><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS2.p1.7.m7.1b"><apply id="S3.SS2.SSS2.p1.7.m7.1.1.cmml" xref="S3.SS2.SSS2.p1.7.m7.1.1"><csymbol cd="ambiguous" id="S3.SS2.SSS2.p1.7.m7.1.1.1.cmml" xref="S3.SS2.SSS2.p1.7.m7.1.1">superscript</csymbol><apply id="S3.SS2.SSS2.p1.7.m7.1.1.2.cmml" xref="S3.SS2.SSS2.p1.7.m7.1.1"><csymbol cd="ambiguous" id="S3.SS2.SSS2.p1.7.m7.1.1.2.1.cmml" xref="S3.SS2.SSS2.p1.7.m7.1.1">subscript</csymbol><ci id="S3.SS2.SSS2.p1.7.m7.1.1.2.2.cmml" xref="S3.SS2.SSS2.p1.7.m7.1.1.2.2">𝑢</ci><ci id="S3.SS2.SSS2.p1.7.m7.1.1.2.3.cmml" xref="S3.SS2.SSS2.p1.7.m7.1.1.2.3">𝑖</ci></apply><ci id="S3.SS2.SSS2.p1.7.m7.1.1.3.cmml" xref="S3.SS2.SSS2.p1.7.m7.1.1.3">𝑗</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS2.p1.7.m7.1c">u_{i}^{j}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS2.p1.7.m7.1d">italic_u start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_j end_POSTSUPERSCRIPT</annotation></semantics></math> represents the user content in the <math alttext="j-th" class="ltx_Math" display="inline" id="S3.SS2.SSS2.p1.8.m8.1"><semantics id="S3.SS2.SSS2.p1.8.m8.1a"><mrow id="S3.SS2.SSS2.p1.8.m8.1.1" xref="S3.SS2.SSS2.p1.8.m8.1.1.cmml"><mi id="S3.SS2.SSS2.p1.8.m8.1.1.2" xref="S3.SS2.SSS2.p1.8.m8.1.1.2.cmml">j</mi><mo id="S3.SS2.SSS2.p1.8.m8.1.1.1" xref="S3.SS2.SSS2.p1.8.m8.1.1.1.cmml">−</mo><mrow id="S3.SS2.SSS2.p1.8.m8.1.1.3" xref="S3.SS2.SSS2.p1.8.m8.1.1.3.cmml"><mi id="S3.SS2.SSS2.p1.8.m8.1.1.3.2" xref="S3.SS2.SSS2.p1.8.m8.1.1.3.2.cmml">t</mi><mo id="S3.SS2.SSS2.p1.8.m8.1.1.3.1" xref="S3.SS2.SSS2.p1.8.m8.1.1.3.1.cmml">⁢</mo><mi id="S3.SS2.SSS2.p1.8.m8.1.1.3.3" xref="S3.SS2.SSS2.p1.8.m8.1.1.3.3.cmml">h</mi></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS2.p1.8.m8.1b"><apply id="S3.SS2.SSS2.p1.8.m8.1.1.cmml" xref="S3.SS2.SSS2.p1.8.m8.1.1"><minus id="S3.SS2.SSS2.p1.8.m8.1.1.1.cmml" xref="S3.SS2.SSS2.p1.8.m8.1.1.1"></minus><ci id="S3.SS2.SSS2.p1.8.m8.1.1.2.cmml" xref="S3.SS2.SSS2.p1.8.m8.1.1.2">𝑗</ci><apply id="S3.SS2.SSS2.p1.8.m8.1.1.3.cmml" xref="S3.SS2.SSS2.p1.8.m8.1.1.3"><times id="S3.SS2.SSS2.p1.8.m8.1.1.3.1.cmml" xref="S3.SS2.SSS2.p1.8.m8.1.1.3.1"></times><ci id="S3.SS2.SSS2.p1.8.m8.1.1.3.2.cmml" xref="S3.SS2.SSS2.p1.8.m8.1.1.3.2">𝑡</ci><ci id="S3.SS2.SSS2.p1.8.m8.1.1.3.3.cmml" xref="S3.SS2.SSS2.p1.8.m8.1.1.3.3">ℎ</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS2.p1.8.m8.1c">j-th</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS2.p1.8.m8.1d">italic_j - italic_t italic_h</annotation></semantics></math> turn of the <math alttext="i-th" class="ltx_Math" display="inline" id="S3.SS2.SSS2.p1.9.m9.1"><semantics id="S3.SS2.SSS2.p1.9.m9.1a"><mrow id="S3.SS2.SSS2.p1.9.m9.1.1" xref="S3.SS2.SSS2.p1.9.m9.1.1.cmml"><mi id="S3.SS2.SSS2.p1.9.m9.1.1.2" xref="S3.SS2.SSS2.p1.9.m9.1.1.2.cmml">i</mi><mo id="S3.SS2.SSS2.p1.9.m9.1.1.1" xref="S3.SS2.SSS2.p1.9.m9.1.1.1.cmml">−</mo><mrow id="S3.SS2.SSS2.p1.9.m9.1.1.3" xref="S3.SS2.SSS2.p1.9.m9.1.1.3.cmml"><mi id="S3.SS2.SSS2.p1.9.m9.1.1.3.2" xref="S3.SS2.SSS2.p1.9.m9.1.1.3.2.cmml">t</mi><mo id="S3.SS2.SSS2.p1.9.m9.1.1.3.1" xref="S3.SS2.SSS2.p1.9.m9.1.1.3.1.cmml">⁢</mo><mi id="S3.SS2.SSS2.p1.9.m9.1.1.3.3" xref="S3.SS2.SSS2.p1.9.m9.1.1.3.3.cmml">h</mi></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS2.p1.9.m9.1b"><apply id="S3.SS2.SSS2.p1.9.m9.1.1.cmml" xref="S3.SS2.SSS2.p1.9.m9.1.1"><minus id="S3.SS2.SSS2.p1.9.m9.1.1.1.cmml" xref="S3.SS2.SSS2.p1.9.m9.1.1.1"></minus><ci id="S3.SS2.SSS2.p1.9.m9.1.1.2.cmml" xref="S3.SS2.SSS2.p1.9.m9.1.1.2">𝑖</ci><apply id="S3.SS2.SSS2.p1.9.m9.1.1.3.cmml" xref="S3.SS2.SSS2.p1.9.m9.1.1.3"><times id="S3.SS2.SSS2.p1.9.m9.1.1.3.1.cmml" xref="S3.SS2.SSS2.p1.9.m9.1.1.3.1"></times><ci id="S3.SS2.SSS2.p1.9.m9.1.1.3.2.cmml" xref="S3.SS2.SSS2.p1.9.m9.1.1.3.2">𝑡</ci><ci id="S3.SS2.SSS2.p1.9.m9.1.1.3.3.cmml" xref="S3.SS2.SSS2.p1.9.m9.1.1.3.3">ℎ</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS2.p1.9.m9.1c">i-th</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS2.p1.9.m9.1d">italic_i - italic_t italic_h</annotation></semantics></math> dialogue, and <math alttext="r_{i}^{j}" class="ltx_Math" display="inline" id="S3.SS2.SSS2.p1.10.m10.1"><semantics id="S3.SS2.SSS2.p1.10.m10.1a"><msubsup id="S3.SS2.SSS2.p1.10.m10.1.1" xref="S3.SS2.SSS2.p1.10.m10.1.1.cmml"><mi id="S3.SS2.SSS2.p1.10.m10.1.1.2.2" xref="S3.SS2.SSS2.p1.10.m10.1.1.2.2.cmml">r</mi><mi id="S3.SS2.SSS2.p1.10.m10.1.1.2.3" xref="S3.SS2.SSS2.p1.10.m10.1.1.2.3.cmml">i</mi><mi id="S3.SS2.SSS2.p1.10.m10.1.1.3" xref="S3.SS2.SSS2.p1.10.m10.1.1.3.cmml">j</mi></msubsup><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS2.p1.10.m10.1b"><apply id="S3.SS2.SSS2.p1.10.m10.1.1.cmml" xref="S3.SS2.SSS2.p1.10.m10.1.1"><csymbol cd="ambiguous" id="S3.SS2.SSS2.p1.10.m10.1.1.1.cmml" xref="S3.SS2.SSS2.p1.10.m10.1.1">superscript</csymbol><apply id="S3.SS2.SSS2.p1.10.m10.1.1.2.cmml" xref="S3.SS2.SSS2.p1.10.m10.1.1"><csymbol cd="ambiguous" id="S3.SS2.SSS2.p1.10.m10.1.1.2.1.cmml" xref="S3.SS2.SSS2.p1.10.m10.1.1">subscript</csymbol><ci id="S3.SS2.SSS2.p1.10.m10.1.1.2.2.cmml" xref="S3.SS2.SSS2.p1.10.m10.1.1.2.2">𝑟</ci><ci id="S3.SS2.SSS2.p1.10.m10.1.1.2.3.cmml" xref="S3.SS2.SSS2.p1.10.m10.1.1.2.3">𝑖</ci></apply><ci id="S3.SS2.SSS2.p1.10.m10.1.1.3.cmml" xref="S3.SS2.SSS2.p1.10.m10.1.1.3">𝑗</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS2.p1.10.m10.1c">r_{i}^{j}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS2.p1.10.m10.1d">italic_r start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_j end_POSTSUPERSCRIPT</annotation></semantics></math> represents the corresponding model response:</p>
<table class="ltx_equation ltx_eqn_table" id="S3.E2">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_left" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_left">(2)</span></td>
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\mathcal{D}=\{d_{1},d_{2},...,d_{I}\},d_{i}=\{(u_{i}^{1},r_{i}^{1}),(u_{i}^{2}%
,r_{i}^{2}),...,(u_{i}^{J},r_{i}^{J})\}" class="ltx_Math" display="block" id="S3.E2.m1.4"><semantics id="S3.E2.m1.4a"><mrow id="S3.E2.m1.4.4.2" xref="S3.E2.m1.4.4.3.cmml"><mrow id="S3.E2.m1.3.3.1.1" xref="S3.E2.m1.3.3.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.E2.m1.3.3.1.1.5" xref="S3.E2.m1.3.3.1.1.5.cmml">𝒟</mi><mo id="S3.E2.m1.3.3.1.1.4" xref="S3.E2.m1.3.3.1.1.4.cmml">=</mo><mrow id="S3.E2.m1.3.3.1.1.3.3" xref="S3.E2.m1.3.3.1.1.3.4.cmml"><mo id="S3.E2.m1.3.3.1.1.3.3.4" stretchy="false" xref="S3.E2.m1.3.3.1.1.3.4.cmml">{</mo><msub id="S3.E2.m1.3.3.1.1.1.1.1" xref="S3.E2.m1.3.3.1.1.1.1.1.cmml"><mi id="S3.E2.m1.3.3.1.1.1.1.1.2" xref="S3.E2.m1.3.3.1.1.1.1.1.2.cmml">d</mi><mn id="S3.E2.m1.3.3.1.1.1.1.1.3" xref="S3.E2.m1.3.3.1.1.1.1.1.3.cmml">1</mn></msub><mo id="S3.E2.m1.3.3.1.1.3.3.5" xref="S3.E2.m1.3.3.1.1.3.4.cmml">,</mo><msub id="S3.E2.m1.3.3.1.1.2.2.2" xref="S3.E2.m1.3.3.1.1.2.2.2.cmml"><mi id="S3.E2.m1.3.3.1.1.2.2.2.2" xref="S3.E2.m1.3.3.1.1.2.2.2.2.cmml">d</mi><mn id="S3.E2.m1.3.3.1.1.2.2.2.3" xref="S3.E2.m1.3.3.1.1.2.2.2.3.cmml">2</mn></msub><mo id="S3.E2.m1.3.3.1.1.3.3.6" xref="S3.E2.m1.3.3.1.1.3.4.cmml">,</mo><mi id="S3.E2.m1.1.1" mathvariant="normal" xref="S3.E2.m1.1.1.cmml">…</mi><mo id="S3.E2.m1.3.3.1.1.3.3.7" xref="S3.E2.m1.3.3.1.1.3.4.cmml">,</mo><msub id="S3.E2.m1.3.3.1.1.3.3.3" xref="S3.E2.m1.3.3.1.1.3.3.3.cmml"><mi id="S3.E2.m1.3.3.1.1.3.3.3.2" xref="S3.E2.m1.3.3.1.1.3.3.3.2.cmml">d</mi><mi id="S3.E2.m1.3.3.1.1.3.3.3.3" xref="S3.E2.m1.3.3.1.1.3.3.3.3.cmml">I</mi></msub><mo id="S3.E2.m1.3.3.1.1.3.3.8" stretchy="false" xref="S3.E2.m1.3.3.1.1.3.4.cmml">}</mo></mrow></mrow><mo id="S3.E2.m1.4.4.2.3" xref="S3.E2.m1.4.4.3a.cmml">,</mo><mrow id="S3.E2.m1.4.4.2.2" xref="S3.E2.m1.4.4.2.2.cmml"><msub id="S3.E2.m1.4.4.2.2.5" xref="S3.E2.m1.4.4.2.2.5.cmml"><mi id="S3.E2.m1.4.4.2.2.5.2" xref="S3.E2.m1.4.4.2.2.5.2.cmml">d</mi><mi id="S3.E2.m1.4.4.2.2.5.3" xref="S3.E2.m1.4.4.2.2.5.3.cmml">i</mi></msub><mo id="S3.E2.m1.4.4.2.2.4" xref="S3.E2.m1.4.4.2.2.4.cmml">=</mo><mrow id="S3.E2.m1.4.4.2.2.3.3" xref="S3.E2.m1.4.4.2.2.3.4.cmml"><mo id="S3.E2.m1.4.4.2.2.3.3.4" stretchy="false" xref="S3.E2.m1.4.4.2.2.3.4.cmml">{</mo><mrow id="S3.E2.m1.4.4.2.2.1.1.1.2" xref="S3.E2.m1.4.4.2.2.1.1.1.3.cmml"><mo id="S3.E2.m1.4.4.2.2.1.1.1.2.3" stretchy="false" xref="S3.E2.m1.4.4.2.2.1.1.1.3.cmml">(</mo><msubsup id="S3.E2.m1.4.4.2.2.1.1.1.1.1" xref="S3.E2.m1.4.4.2.2.1.1.1.1.1.cmml"><mi id="S3.E2.m1.4.4.2.2.1.1.1.1.1.2.2" xref="S3.E2.m1.4.4.2.2.1.1.1.1.1.2.2.cmml">u</mi><mi id="S3.E2.m1.4.4.2.2.1.1.1.1.1.2.3" xref="S3.E2.m1.4.4.2.2.1.1.1.1.1.2.3.cmml">i</mi><mn id="S3.E2.m1.4.4.2.2.1.1.1.1.1.3" xref="S3.E2.m1.4.4.2.2.1.1.1.1.1.3.cmml">1</mn></msubsup><mo id="S3.E2.m1.4.4.2.2.1.1.1.2.4" xref="S3.E2.m1.4.4.2.2.1.1.1.3.cmml">,</mo><msubsup id="S3.E2.m1.4.4.2.2.1.1.1.2.2" xref="S3.E2.m1.4.4.2.2.1.1.1.2.2.cmml"><mi id="S3.E2.m1.4.4.2.2.1.1.1.2.2.2.2" xref="S3.E2.m1.4.4.2.2.1.1.1.2.2.2.2.cmml">r</mi><mi id="S3.E2.m1.4.4.2.2.1.1.1.2.2.2.3" xref="S3.E2.m1.4.4.2.2.1.1.1.2.2.2.3.cmml">i</mi><mn id="S3.E2.m1.4.4.2.2.1.1.1.2.2.3" xref="S3.E2.m1.4.4.2.2.1.1.1.2.2.3.cmml">1</mn></msubsup><mo id="S3.E2.m1.4.4.2.2.1.1.1.2.5" stretchy="false" xref="S3.E2.m1.4.4.2.2.1.1.1.3.cmml">)</mo></mrow><mo id="S3.E2.m1.4.4.2.2.3.3.5" xref="S3.E2.m1.4.4.2.2.3.4.cmml">,</mo><mrow id="S3.E2.m1.4.4.2.2.2.2.2.2" xref="S3.E2.m1.4.4.2.2.2.2.2.3.cmml"><mo id="S3.E2.m1.4.4.2.2.2.2.2.2.3" stretchy="false" xref="S3.E2.m1.4.4.2.2.2.2.2.3.cmml">(</mo><msubsup id="S3.E2.m1.4.4.2.2.2.2.2.1.1" xref="S3.E2.m1.4.4.2.2.2.2.2.1.1.cmml"><mi id="S3.E2.m1.4.4.2.2.2.2.2.1.1.2.2" xref="S3.E2.m1.4.4.2.2.2.2.2.1.1.2.2.cmml">u</mi><mi id="S3.E2.m1.4.4.2.2.2.2.2.1.1.2.3" xref="S3.E2.m1.4.4.2.2.2.2.2.1.1.2.3.cmml">i</mi><mn id="S3.E2.m1.4.4.2.2.2.2.2.1.1.3" xref="S3.E2.m1.4.4.2.2.2.2.2.1.1.3.cmml">2</mn></msubsup><mo id="S3.E2.m1.4.4.2.2.2.2.2.2.4" xref="S3.E2.m1.4.4.2.2.2.2.2.3.cmml">,</mo><msubsup id="S3.E2.m1.4.4.2.2.2.2.2.2.2" xref="S3.E2.m1.4.4.2.2.2.2.2.2.2.cmml"><mi id="S3.E2.m1.4.4.2.2.2.2.2.2.2.2.2" xref="S3.E2.m1.4.4.2.2.2.2.2.2.2.2.2.cmml">r</mi><mi id="S3.E2.m1.4.4.2.2.2.2.2.2.2.2.3" xref="S3.E2.m1.4.4.2.2.2.2.2.2.2.2.3.cmml">i</mi><mn id="S3.E2.m1.4.4.2.2.2.2.2.2.2.3" xref="S3.E2.m1.4.4.2.2.2.2.2.2.2.3.cmml">2</mn></msubsup><mo id="S3.E2.m1.4.4.2.2.2.2.2.2.5" stretchy="false" xref="S3.E2.m1.4.4.2.2.2.2.2.3.cmml">)</mo></mrow><mo id="S3.E2.m1.4.4.2.2.3.3.6" xref="S3.E2.m1.4.4.2.2.3.4.cmml">,</mo><mi id="S3.E2.m1.2.2" mathvariant="normal" xref="S3.E2.m1.2.2.cmml">…</mi><mo id="S3.E2.m1.4.4.2.2.3.3.7" xref="S3.E2.m1.4.4.2.2.3.4.cmml">,</mo><mrow id="S3.E2.m1.4.4.2.2.3.3.3.2" xref="S3.E2.m1.4.4.2.2.3.3.3.3.cmml"><mo id="S3.E2.m1.4.4.2.2.3.3.3.2.3" stretchy="false" xref="S3.E2.m1.4.4.2.2.3.3.3.3.cmml">(</mo><msubsup id="S3.E2.m1.4.4.2.2.3.3.3.1.1" xref="S3.E2.m1.4.4.2.2.3.3.3.1.1.cmml"><mi id="S3.E2.m1.4.4.2.2.3.3.3.1.1.2.2" xref="S3.E2.m1.4.4.2.2.3.3.3.1.1.2.2.cmml">u</mi><mi id="S3.E2.m1.4.4.2.2.3.3.3.1.1.2.3" xref="S3.E2.m1.4.4.2.2.3.3.3.1.1.2.3.cmml">i</mi><mi id="S3.E2.m1.4.4.2.2.3.3.3.1.1.3" xref="S3.E2.m1.4.4.2.2.3.3.3.1.1.3.cmml">J</mi></msubsup><mo id="S3.E2.m1.4.4.2.2.3.3.3.2.4" xref="S3.E2.m1.4.4.2.2.3.3.3.3.cmml">,</mo><msubsup id="S3.E2.m1.4.4.2.2.3.3.3.2.2" xref="S3.E2.m1.4.4.2.2.3.3.3.2.2.cmml"><mi id="S3.E2.m1.4.4.2.2.3.3.3.2.2.2.2" xref="S3.E2.m1.4.4.2.2.3.3.3.2.2.2.2.cmml">r</mi><mi id="S3.E2.m1.4.4.2.2.3.3.3.2.2.2.3" xref="S3.E2.m1.4.4.2.2.3.3.3.2.2.2.3.cmml">i</mi><mi id="S3.E2.m1.4.4.2.2.3.3.3.2.2.3" xref="S3.E2.m1.4.4.2.2.3.3.3.2.2.3.cmml">J</mi></msubsup><mo id="S3.E2.m1.4.4.2.2.3.3.3.2.5" stretchy="false" xref="S3.E2.m1.4.4.2.2.3.3.3.3.cmml">)</mo></mrow><mo id="S3.E2.m1.4.4.2.2.3.3.8" stretchy="false" xref="S3.E2.m1.4.4.2.2.3.4.cmml">}</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.E2.m1.4b"><apply id="S3.E2.m1.4.4.3.cmml" xref="S3.E2.m1.4.4.2"><csymbol cd="ambiguous" id="S3.E2.m1.4.4.3a.cmml" xref="S3.E2.m1.4.4.2.3">formulae-sequence</csymbol><apply id="S3.E2.m1.3.3.1.1.cmml" xref="S3.E2.m1.3.3.1.1"><eq id="S3.E2.m1.3.3.1.1.4.cmml" xref="S3.E2.m1.3.3.1.1.4"></eq><ci id="S3.E2.m1.3.3.1.1.5.cmml" xref="S3.E2.m1.3.3.1.1.5">𝒟</ci><set id="S3.E2.m1.3.3.1.1.3.4.cmml" xref="S3.E2.m1.3.3.1.1.3.3"><apply id="S3.E2.m1.3.3.1.1.1.1.1.cmml" xref="S3.E2.m1.3.3.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E2.m1.3.3.1.1.1.1.1.1.cmml" xref="S3.E2.m1.3.3.1.1.1.1.1">subscript</csymbol><ci id="S3.E2.m1.3.3.1.1.1.1.1.2.cmml" xref="S3.E2.m1.3.3.1.1.1.1.1.2">𝑑</ci><cn id="S3.E2.m1.3.3.1.1.1.1.1.3.cmml" type="integer" xref="S3.E2.m1.3.3.1.1.1.1.1.3">1</cn></apply><apply id="S3.E2.m1.3.3.1.1.2.2.2.cmml" xref="S3.E2.m1.3.3.1.1.2.2.2"><csymbol cd="ambiguous" id="S3.E2.m1.3.3.1.1.2.2.2.1.cmml" xref="S3.E2.m1.3.3.1.1.2.2.2">subscript</csymbol><ci id="S3.E2.m1.3.3.1.1.2.2.2.2.cmml" xref="S3.E2.m1.3.3.1.1.2.2.2.2">𝑑</ci><cn id="S3.E2.m1.3.3.1.1.2.2.2.3.cmml" type="integer" xref="S3.E2.m1.3.3.1.1.2.2.2.3">2</cn></apply><ci id="S3.E2.m1.1.1.cmml" xref="S3.E2.m1.1.1">…</ci><apply id="S3.E2.m1.3.3.1.1.3.3.3.cmml" xref="S3.E2.m1.3.3.1.1.3.3.3"><csymbol cd="ambiguous" id="S3.E2.m1.3.3.1.1.3.3.3.1.cmml" xref="S3.E2.m1.3.3.1.1.3.3.3">subscript</csymbol><ci id="S3.E2.m1.3.3.1.1.3.3.3.2.cmml" xref="S3.E2.m1.3.3.1.1.3.3.3.2">𝑑</ci><ci id="S3.E2.m1.3.3.1.1.3.3.3.3.cmml" xref="S3.E2.m1.3.3.1.1.3.3.3.3">𝐼</ci></apply></set></apply><apply id="S3.E2.m1.4.4.2.2.cmml" xref="S3.E2.m1.4.4.2.2"><eq id="S3.E2.m1.4.4.2.2.4.cmml" xref="S3.E2.m1.4.4.2.2.4"></eq><apply id="S3.E2.m1.4.4.2.2.5.cmml" xref="S3.E2.m1.4.4.2.2.5"><csymbol cd="ambiguous" id="S3.E2.m1.4.4.2.2.5.1.cmml" xref="S3.E2.m1.4.4.2.2.5">subscript</csymbol><ci id="S3.E2.m1.4.4.2.2.5.2.cmml" xref="S3.E2.m1.4.4.2.2.5.2">𝑑</ci><ci id="S3.E2.m1.4.4.2.2.5.3.cmml" xref="S3.E2.m1.4.4.2.2.5.3">𝑖</ci></apply><set id="S3.E2.m1.4.4.2.2.3.4.cmml" xref="S3.E2.m1.4.4.2.2.3.3"><interval closure="open" id="S3.E2.m1.4.4.2.2.1.1.1.3.cmml" xref="S3.E2.m1.4.4.2.2.1.1.1.2"><apply id="S3.E2.m1.4.4.2.2.1.1.1.1.1.cmml" xref="S3.E2.m1.4.4.2.2.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E2.m1.4.4.2.2.1.1.1.1.1.1.cmml" xref="S3.E2.m1.4.4.2.2.1.1.1.1.1">superscript</csymbol><apply id="S3.E2.m1.4.4.2.2.1.1.1.1.1.2.cmml" xref="S3.E2.m1.4.4.2.2.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E2.m1.4.4.2.2.1.1.1.1.1.2.1.cmml" xref="S3.E2.m1.4.4.2.2.1.1.1.1.1">subscript</csymbol><ci id="S3.E2.m1.4.4.2.2.1.1.1.1.1.2.2.cmml" xref="S3.E2.m1.4.4.2.2.1.1.1.1.1.2.2">𝑢</ci><ci id="S3.E2.m1.4.4.2.2.1.1.1.1.1.2.3.cmml" xref="S3.E2.m1.4.4.2.2.1.1.1.1.1.2.3">𝑖</ci></apply><cn id="S3.E2.m1.4.4.2.2.1.1.1.1.1.3.cmml" type="integer" xref="S3.E2.m1.4.4.2.2.1.1.1.1.1.3">1</cn></apply><apply id="S3.E2.m1.4.4.2.2.1.1.1.2.2.cmml" xref="S3.E2.m1.4.4.2.2.1.1.1.2.2"><csymbol cd="ambiguous" id="S3.E2.m1.4.4.2.2.1.1.1.2.2.1.cmml" xref="S3.E2.m1.4.4.2.2.1.1.1.2.2">superscript</csymbol><apply id="S3.E2.m1.4.4.2.2.1.1.1.2.2.2.cmml" xref="S3.E2.m1.4.4.2.2.1.1.1.2.2"><csymbol cd="ambiguous" id="S3.E2.m1.4.4.2.2.1.1.1.2.2.2.1.cmml" xref="S3.E2.m1.4.4.2.2.1.1.1.2.2">subscript</csymbol><ci id="S3.E2.m1.4.4.2.2.1.1.1.2.2.2.2.cmml" xref="S3.E2.m1.4.4.2.2.1.1.1.2.2.2.2">𝑟</ci><ci id="S3.E2.m1.4.4.2.2.1.1.1.2.2.2.3.cmml" xref="S3.E2.m1.4.4.2.2.1.1.1.2.2.2.3">𝑖</ci></apply><cn id="S3.E2.m1.4.4.2.2.1.1.1.2.2.3.cmml" type="integer" xref="S3.E2.m1.4.4.2.2.1.1.1.2.2.3">1</cn></apply></interval><interval closure="open" id="S3.E2.m1.4.4.2.2.2.2.2.3.cmml" xref="S3.E2.m1.4.4.2.2.2.2.2.2"><apply id="S3.E2.m1.4.4.2.2.2.2.2.1.1.cmml" xref="S3.E2.m1.4.4.2.2.2.2.2.1.1"><csymbol cd="ambiguous" id="S3.E2.m1.4.4.2.2.2.2.2.1.1.1.cmml" xref="S3.E2.m1.4.4.2.2.2.2.2.1.1">superscript</csymbol><apply id="S3.E2.m1.4.4.2.2.2.2.2.1.1.2.cmml" xref="S3.E2.m1.4.4.2.2.2.2.2.1.1"><csymbol cd="ambiguous" id="S3.E2.m1.4.4.2.2.2.2.2.1.1.2.1.cmml" xref="S3.E2.m1.4.4.2.2.2.2.2.1.1">subscript</csymbol><ci id="S3.E2.m1.4.4.2.2.2.2.2.1.1.2.2.cmml" xref="S3.E2.m1.4.4.2.2.2.2.2.1.1.2.2">𝑢</ci><ci id="S3.E2.m1.4.4.2.2.2.2.2.1.1.2.3.cmml" xref="S3.E2.m1.4.4.2.2.2.2.2.1.1.2.3">𝑖</ci></apply><cn id="S3.E2.m1.4.4.2.2.2.2.2.1.1.3.cmml" type="integer" xref="S3.E2.m1.4.4.2.2.2.2.2.1.1.3">2</cn></apply><apply id="S3.E2.m1.4.4.2.2.2.2.2.2.2.cmml" xref="S3.E2.m1.4.4.2.2.2.2.2.2.2"><csymbol cd="ambiguous" id="S3.E2.m1.4.4.2.2.2.2.2.2.2.1.cmml" xref="S3.E2.m1.4.4.2.2.2.2.2.2.2">superscript</csymbol><apply id="S3.E2.m1.4.4.2.2.2.2.2.2.2.2.cmml" xref="S3.E2.m1.4.4.2.2.2.2.2.2.2"><csymbol cd="ambiguous" id="S3.E2.m1.4.4.2.2.2.2.2.2.2.2.1.cmml" xref="S3.E2.m1.4.4.2.2.2.2.2.2.2">subscript</csymbol><ci id="S3.E2.m1.4.4.2.2.2.2.2.2.2.2.2.cmml" xref="S3.E2.m1.4.4.2.2.2.2.2.2.2.2.2">𝑟</ci><ci id="S3.E2.m1.4.4.2.2.2.2.2.2.2.2.3.cmml" xref="S3.E2.m1.4.4.2.2.2.2.2.2.2.2.3">𝑖</ci></apply><cn id="S3.E2.m1.4.4.2.2.2.2.2.2.2.3.cmml" type="integer" xref="S3.E2.m1.4.4.2.2.2.2.2.2.2.3">2</cn></apply></interval><ci id="S3.E2.m1.2.2.cmml" xref="S3.E2.m1.2.2">…</ci><interval closure="open" id="S3.E2.m1.4.4.2.2.3.3.3.3.cmml" xref="S3.E2.m1.4.4.2.2.3.3.3.2"><apply id="S3.E2.m1.4.4.2.2.3.3.3.1.1.cmml" xref="S3.E2.m1.4.4.2.2.3.3.3.1.1"><csymbol cd="ambiguous" id="S3.E2.m1.4.4.2.2.3.3.3.1.1.1.cmml" xref="S3.E2.m1.4.4.2.2.3.3.3.1.1">superscript</csymbol><apply id="S3.E2.m1.4.4.2.2.3.3.3.1.1.2.cmml" xref="S3.E2.m1.4.4.2.2.3.3.3.1.1"><csymbol cd="ambiguous" id="S3.E2.m1.4.4.2.2.3.3.3.1.1.2.1.cmml" xref="S3.E2.m1.4.4.2.2.3.3.3.1.1">subscript</csymbol><ci id="S3.E2.m1.4.4.2.2.3.3.3.1.1.2.2.cmml" xref="S3.E2.m1.4.4.2.2.3.3.3.1.1.2.2">𝑢</ci><ci id="S3.E2.m1.4.4.2.2.3.3.3.1.1.2.3.cmml" xref="S3.E2.m1.4.4.2.2.3.3.3.1.1.2.3">𝑖</ci></apply><ci id="S3.E2.m1.4.4.2.2.3.3.3.1.1.3.cmml" xref="S3.E2.m1.4.4.2.2.3.3.3.1.1.3">𝐽</ci></apply><apply id="S3.E2.m1.4.4.2.2.3.3.3.2.2.cmml" xref="S3.E2.m1.4.4.2.2.3.3.3.2.2"><csymbol cd="ambiguous" id="S3.E2.m1.4.4.2.2.3.3.3.2.2.1.cmml" xref="S3.E2.m1.4.4.2.2.3.3.3.2.2">superscript</csymbol><apply id="S3.E2.m1.4.4.2.2.3.3.3.2.2.2.cmml" xref="S3.E2.m1.4.4.2.2.3.3.3.2.2"><csymbol cd="ambiguous" id="S3.E2.m1.4.4.2.2.3.3.3.2.2.2.1.cmml" xref="S3.E2.m1.4.4.2.2.3.3.3.2.2">subscript</csymbol><ci id="S3.E2.m1.4.4.2.2.3.3.3.2.2.2.2.cmml" xref="S3.E2.m1.4.4.2.2.3.3.3.2.2.2.2">𝑟</ci><ci id="S3.E2.m1.4.4.2.2.3.3.3.2.2.2.3.cmml" xref="S3.E2.m1.4.4.2.2.3.3.3.2.2.2.3">𝑖</ci></apply><ci id="S3.E2.m1.4.4.2.2.3.3.3.2.2.3.cmml" xref="S3.E2.m1.4.4.2.2.3.3.3.2.2.3">𝐽</ci></apply></interval></set></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E2.m1.4c">\mathcal{D}=\{d_{1},d_{2},...,d_{I}\},d_{i}=\{(u_{i}^{1},r_{i}^{1}),(u_{i}^{2}%
,r_{i}^{2}),...,(u_{i}^{J},r_{i}^{J})\}</annotation><annotation encoding="application/x-llamapun" id="S3.E2.m1.4d">caligraphic_D = { italic_d start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT , italic_d start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT , … , italic_d start_POSTSUBSCRIPT italic_I end_POSTSUBSCRIPT } , italic_d start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT = { ( italic_u start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT start_POSTSUPERSCRIPT 1 end_POSTSUPERSCRIPT , italic_r start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT start_POSTSUPERSCRIPT 1 end_POSTSUPERSCRIPT ) , ( italic_u start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT , italic_r start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT ) , … , ( italic_u start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_J end_POSTSUPERSCRIPT , italic_r start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_J end_POSTSUPERSCRIPT ) }</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S3.SS2.SSS2.p1.15">Let the target response <math alttext="r_{i}^{j}" class="ltx_Math" display="inline" id="S3.SS2.SSS2.p1.11.m1.1"><semantics id="S3.SS2.SSS2.p1.11.m1.1a"><msubsup id="S3.SS2.SSS2.p1.11.m1.1.1" xref="S3.SS2.SSS2.p1.11.m1.1.1.cmml"><mi id="S3.SS2.SSS2.p1.11.m1.1.1.2.2" xref="S3.SS2.SSS2.p1.11.m1.1.1.2.2.cmml">r</mi><mi id="S3.SS2.SSS2.p1.11.m1.1.1.2.3" xref="S3.SS2.SSS2.p1.11.m1.1.1.2.3.cmml">i</mi><mi id="S3.SS2.SSS2.p1.11.m1.1.1.3" xref="S3.SS2.SSS2.p1.11.m1.1.1.3.cmml">j</mi></msubsup><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS2.p1.11.m1.1b"><apply id="S3.SS2.SSS2.p1.11.m1.1.1.cmml" xref="S3.SS2.SSS2.p1.11.m1.1.1"><csymbol cd="ambiguous" id="S3.SS2.SSS2.p1.11.m1.1.1.1.cmml" xref="S3.SS2.SSS2.p1.11.m1.1.1">superscript</csymbol><apply id="S3.SS2.SSS2.p1.11.m1.1.1.2.cmml" xref="S3.SS2.SSS2.p1.11.m1.1.1"><csymbol cd="ambiguous" id="S3.SS2.SSS2.p1.11.m1.1.1.2.1.cmml" xref="S3.SS2.SSS2.p1.11.m1.1.1">subscript</csymbol><ci id="S3.SS2.SSS2.p1.11.m1.1.1.2.2.cmml" xref="S3.SS2.SSS2.p1.11.m1.1.1.2.2">𝑟</ci><ci id="S3.SS2.SSS2.p1.11.m1.1.1.2.3.cmml" xref="S3.SS2.SSS2.p1.11.m1.1.1.2.3">𝑖</ci></apply><ci id="S3.SS2.SSS2.p1.11.m1.1.1.3.cmml" xref="S3.SS2.SSS2.p1.11.m1.1.1.3">𝑗</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS2.p1.11.m1.1c">r_{i}^{j}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS2.p1.11.m1.1d">italic_r start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_j end_POSTSUPERSCRIPT</annotation></semantics></math> consist of a sequence of tokens <math alttext="\{r_{i}^{j}(1),r_{i}^{j}(2)," class="ltx_math_unparsed" display="inline" id="S3.SS2.SSS2.p1.12.m2.2"><semantics id="S3.SS2.SSS2.p1.12.m2.2a"><mrow id="S3.SS2.SSS2.p1.12.m2.2b"><mo id="S3.SS2.SSS2.p1.12.m2.2.3" stretchy="false">{</mo><msubsup id="S3.SS2.SSS2.p1.12.m2.2.4"><mi id="S3.SS2.SSS2.p1.12.m2.2.4.2.2">r</mi><mi id="S3.SS2.SSS2.p1.12.m2.2.4.2.3">i</mi><mi id="S3.SS2.SSS2.p1.12.m2.2.4.3">j</mi></msubsup><mrow id="S3.SS2.SSS2.p1.12.m2.2.5"><mo id="S3.SS2.SSS2.p1.12.m2.2.5.1" stretchy="false">(</mo><mn id="S3.SS2.SSS2.p1.12.m2.1.1">1</mn><mo id="S3.SS2.SSS2.p1.12.m2.2.5.2" stretchy="false">)</mo></mrow><mo id="S3.SS2.SSS2.p1.12.m2.2.6">,</mo><msubsup id="S3.SS2.SSS2.p1.12.m2.2.7"><mi id="S3.SS2.SSS2.p1.12.m2.2.7.2.2">r</mi><mi id="S3.SS2.SSS2.p1.12.m2.2.7.2.3">i</mi><mi id="S3.SS2.SSS2.p1.12.m2.2.7.3">j</mi></msubsup><mrow id="S3.SS2.SSS2.p1.12.m2.2.8"><mo id="S3.SS2.SSS2.p1.12.m2.2.8.1" stretchy="false">(</mo><mn id="S3.SS2.SSS2.p1.12.m2.2.2">2</mn><mo id="S3.SS2.SSS2.p1.12.m2.2.8.2" stretchy="false">)</mo></mrow><mo id="S3.SS2.SSS2.p1.12.m2.2.9">,</mo></mrow><annotation encoding="application/x-tex" id="S3.SS2.SSS2.p1.12.m2.2c">\{r_{i}^{j}(1),r_{i}^{j}(2),</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS2.p1.12.m2.2d">{ italic_r start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_j end_POSTSUPERSCRIPT ( 1 ) , italic_r start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_j end_POSTSUPERSCRIPT ( 2 ) ,</annotation></semantics></math>
<math alttext="...,r_{i}^{j}(T_{i}^{j})\}" class="ltx_math_unparsed" display="inline" id="S3.SS2.SSS2.p1.13.m3.1"><semantics id="S3.SS2.SSS2.p1.13.m3.1a"><mrow id="S3.SS2.SSS2.p1.13.m3.1b"><mi id="S3.SS2.SSS2.p1.13.m3.1.1" mathvariant="normal">…</mi><mo id="S3.SS2.SSS2.p1.13.m3.1.2">,</mo><msubsup id="S3.SS2.SSS2.p1.13.m3.1.3"><mi id="S3.SS2.SSS2.p1.13.m3.1.3.2.2">r</mi><mi id="S3.SS2.SSS2.p1.13.m3.1.3.2.3">i</mi><mi id="S3.SS2.SSS2.p1.13.m3.1.3.3">j</mi></msubsup><mrow id="S3.SS2.SSS2.p1.13.m3.1.4"><mo id="S3.SS2.SSS2.p1.13.m3.1.4.1" stretchy="false">(</mo><msubsup id="S3.SS2.SSS2.p1.13.m3.1.4.2"><mi id="S3.SS2.SSS2.p1.13.m3.1.4.2.2.2">T</mi><mi id="S3.SS2.SSS2.p1.13.m3.1.4.2.2.3">i</mi><mi id="S3.SS2.SSS2.p1.13.m3.1.4.2.3">j</mi></msubsup><mo id="S3.SS2.SSS2.p1.13.m3.1.4.3" stretchy="false">)</mo></mrow><mo id="S3.SS2.SSS2.p1.13.m3.1.5" stretchy="false">}</mo></mrow><annotation encoding="application/x-tex" id="S3.SS2.SSS2.p1.13.m3.1c">...,r_{i}^{j}(T_{i}^{j})\}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS2.p1.13.m3.1d">… , italic_r start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_j end_POSTSUPERSCRIPT ( italic_T start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_j end_POSTSUPERSCRIPT ) }</annotation></semantics></math>, where <math alttext="T_{i}^{j}" class="ltx_Math" display="inline" id="S3.SS2.SSS2.p1.14.m4.1"><semantics id="S3.SS2.SSS2.p1.14.m4.1a"><msubsup id="S3.SS2.SSS2.p1.14.m4.1.1" xref="S3.SS2.SSS2.p1.14.m4.1.1.cmml"><mi id="S3.SS2.SSS2.p1.14.m4.1.1.2.2" xref="S3.SS2.SSS2.p1.14.m4.1.1.2.2.cmml">T</mi><mi id="S3.SS2.SSS2.p1.14.m4.1.1.2.3" xref="S3.SS2.SSS2.p1.14.m4.1.1.2.3.cmml">i</mi><mi id="S3.SS2.SSS2.p1.14.m4.1.1.3" xref="S3.SS2.SSS2.p1.14.m4.1.1.3.cmml">j</mi></msubsup><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS2.p1.14.m4.1b"><apply id="S3.SS2.SSS2.p1.14.m4.1.1.cmml" xref="S3.SS2.SSS2.p1.14.m4.1.1"><csymbol cd="ambiguous" id="S3.SS2.SSS2.p1.14.m4.1.1.1.cmml" xref="S3.SS2.SSS2.p1.14.m4.1.1">superscript</csymbol><apply id="S3.SS2.SSS2.p1.14.m4.1.1.2.cmml" xref="S3.SS2.SSS2.p1.14.m4.1.1"><csymbol cd="ambiguous" id="S3.SS2.SSS2.p1.14.m4.1.1.2.1.cmml" xref="S3.SS2.SSS2.p1.14.m4.1.1">subscript</csymbol><ci id="S3.SS2.SSS2.p1.14.m4.1.1.2.2.cmml" xref="S3.SS2.SSS2.p1.14.m4.1.1.2.2">𝑇</ci><ci id="S3.SS2.SSS2.p1.14.m4.1.1.2.3.cmml" xref="S3.SS2.SSS2.p1.14.m4.1.1.2.3">𝑖</ci></apply><ci id="S3.SS2.SSS2.p1.14.m4.1.1.3.cmml" xref="S3.SS2.SSS2.p1.14.m4.1.1.3">𝑗</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS2.p1.14.m4.1c">T_{i}^{j}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS2.p1.14.m4.1d">italic_T start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_j end_POSTSUPERSCRIPT</annotation></semantics></math> is the length of the target sequence. The cross-entropy loss <math alttext="\ell_{1}(\theta_{1};u_{i}^{j},r_{i}^{j})" class="ltx_Math" display="inline" id="S3.SS2.SSS2.p1.15.m5.3"><semantics id="S3.SS2.SSS2.p1.15.m5.3a"><mrow id="S3.SS2.SSS2.p1.15.m5.3.3" xref="S3.SS2.SSS2.p1.15.m5.3.3.cmml"><msub id="S3.SS2.SSS2.p1.15.m5.3.3.5" xref="S3.SS2.SSS2.p1.15.m5.3.3.5.cmml"><mi id="S3.SS2.SSS2.p1.15.m5.3.3.5.2" mathvariant="normal" xref="S3.SS2.SSS2.p1.15.m5.3.3.5.2.cmml">ℓ</mi><mn id="S3.SS2.SSS2.p1.15.m5.3.3.5.3" xref="S3.SS2.SSS2.p1.15.m5.3.3.5.3.cmml">1</mn></msub><mo id="S3.SS2.SSS2.p1.15.m5.3.3.4" xref="S3.SS2.SSS2.p1.15.m5.3.3.4.cmml">⁢</mo><mrow id="S3.SS2.SSS2.p1.15.m5.3.3.3.3" xref="S3.SS2.SSS2.p1.15.m5.3.3.3.4.cmml"><mo id="S3.SS2.SSS2.p1.15.m5.3.3.3.3.4" stretchy="false" xref="S3.SS2.SSS2.p1.15.m5.3.3.3.4.cmml">(</mo><msub id="S3.SS2.SSS2.p1.15.m5.1.1.1.1.1" xref="S3.SS2.SSS2.p1.15.m5.1.1.1.1.1.cmml"><mi id="S3.SS2.SSS2.p1.15.m5.1.1.1.1.1.2" xref="S3.SS2.SSS2.p1.15.m5.1.1.1.1.1.2.cmml">θ</mi><mn id="S3.SS2.SSS2.p1.15.m5.1.1.1.1.1.3" xref="S3.SS2.SSS2.p1.15.m5.1.1.1.1.1.3.cmml">1</mn></msub><mo id="S3.SS2.SSS2.p1.15.m5.3.3.3.3.5" xref="S3.SS2.SSS2.p1.15.m5.3.3.3.4.cmml">;</mo><msubsup id="S3.SS2.SSS2.p1.15.m5.2.2.2.2.2" xref="S3.SS2.SSS2.p1.15.m5.2.2.2.2.2.cmml"><mi id="S3.SS2.SSS2.p1.15.m5.2.2.2.2.2.2.2" xref="S3.SS2.SSS2.p1.15.m5.2.2.2.2.2.2.2.cmml">u</mi><mi id="S3.SS2.SSS2.p1.15.m5.2.2.2.2.2.2.3" xref="S3.SS2.SSS2.p1.15.m5.2.2.2.2.2.2.3.cmml">i</mi><mi id="S3.SS2.SSS2.p1.15.m5.2.2.2.2.2.3" xref="S3.SS2.SSS2.p1.15.m5.2.2.2.2.2.3.cmml">j</mi></msubsup><mo id="S3.SS2.SSS2.p1.15.m5.3.3.3.3.6" xref="S3.SS2.SSS2.p1.15.m5.3.3.3.4.cmml">,</mo><msubsup id="S3.SS2.SSS2.p1.15.m5.3.3.3.3.3" xref="S3.SS2.SSS2.p1.15.m5.3.3.3.3.3.cmml"><mi id="S3.SS2.SSS2.p1.15.m5.3.3.3.3.3.2.2" xref="S3.SS2.SSS2.p1.15.m5.3.3.3.3.3.2.2.cmml">r</mi><mi id="S3.SS2.SSS2.p1.15.m5.3.3.3.3.3.2.3" xref="S3.SS2.SSS2.p1.15.m5.3.3.3.3.3.2.3.cmml">i</mi><mi id="S3.SS2.SSS2.p1.15.m5.3.3.3.3.3.3" xref="S3.SS2.SSS2.p1.15.m5.3.3.3.3.3.3.cmml">j</mi></msubsup><mo id="S3.SS2.SSS2.p1.15.m5.3.3.3.3.7" stretchy="false" xref="S3.SS2.SSS2.p1.15.m5.3.3.3.4.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS2.p1.15.m5.3b"><apply id="S3.SS2.SSS2.p1.15.m5.3.3.cmml" xref="S3.SS2.SSS2.p1.15.m5.3.3"><times id="S3.SS2.SSS2.p1.15.m5.3.3.4.cmml" xref="S3.SS2.SSS2.p1.15.m5.3.3.4"></times><apply id="S3.SS2.SSS2.p1.15.m5.3.3.5.cmml" xref="S3.SS2.SSS2.p1.15.m5.3.3.5"><csymbol cd="ambiguous" id="S3.SS2.SSS2.p1.15.m5.3.3.5.1.cmml" xref="S3.SS2.SSS2.p1.15.m5.3.3.5">subscript</csymbol><ci id="S3.SS2.SSS2.p1.15.m5.3.3.5.2.cmml" xref="S3.SS2.SSS2.p1.15.m5.3.3.5.2">ℓ</ci><cn id="S3.SS2.SSS2.p1.15.m5.3.3.5.3.cmml" type="integer" xref="S3.SS2.SSS2.p1.15.m5.3.3.5.3">1</cn></apply><list id="S3.SS2.SSS2.p1.15.m5.3.3.3.4.cmml" xref="S3.SS2.SSS2.p1.15.m5.3.3.3.3"><apply id="S3.SS2.SSS2.p1.15.m5.1.1.1.1.1.cmml" xref="S3.SS2.SSS2.p1.15.m5.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS2.SSS2.p1.15.m5.1.1.1.1.1.1.cmml" xref="S3.SS2.SSS2.p1.15.m5.1.1.1.1.1">subscript</csymbol><ci id="S3.SS2.SSS2.p1.15.m5.1.1.1.1.1.2.cmml" xref="S3.SS2.SSS2.p1.15.m5.1.1.1.1.1.2">𝜃</ci><cn id="S3.SS2.SSS2.p1.15.m5.1.1.1.1.1.3.cmml" type="integer" xref="S3.SS2.SSS2.p1.15.m5.1.1.1.1.1.3">1</cn></apply><apply id="S3.SS2.SSS2.p1.15.m5.2.2.2.2.2.cmml" xref="S3.SS2.SSS2.p1.15.m5.2.2.2.2.2"><csymbol cd="ambiguous" id="S3.SS2.SSS2.p1.15.m5.2.2.2.2.2.1.cmml" xref="S3.SS2.SSS2.p1.15.m5.2.2.2.2.2">superscript</csymbol><apply id="S3.SS2.SSS2.p1.15.m5.2.2.2.2.2.2.cmml" xref="S3.SS2.SSS2.p1.15.m5.2.2.2.2.2"><csymbol cd="ambiguous" id="S3.SS2.SSS2.p1.15.m5.2.2.2.2.2.2.1.cmml" xref="S3.SS2.SSS2.p1.15.m5.2.2.2.2.2">subscript</csymbol><ci id="S3.SS2.SSS2.p1.15.m5.2.2.2.2.2.2.2.cmml" xref="S3.SS2.SSS2.p1.15.m5.2.2.2.2.2.2.2">𝑢</ci><ci id="S3.SS2.SSS2.p1.15.m5.2.2.2.2.2.2.3.cmml" xref="S3.SS2.SSS2.p1.15.m5.2.2.2.2.2.2.3">𝑖</ci></apply><ci id="S3.SS2.SSS2.p1.15.m5.2.2.2.2.2.3.cmml" xref="S3.SS2.SSS2.p1.15.m5.2.2.2.2.2.3">𝑗</ci></apply><apply id="S3.SS2.SSS2.p1.15.m5.3.3.3.3.3.cmml" xref="S3.SS2.SSS2.p1.15.m5.3.3.3.3.3"><csymbol cd="ambiguous" id="S3.SS2.SSS2.p1.15.m5.3.3.3.3.3.1.cmml" xref="S3.SS2.SSS2.p1.15.m5.3.3.3.3.3">superscript</csymbol><apply id="S3.SS2.SSS2.p1.15.m5.3.3.3.3.3.2.cmml" xref="S3.SS2.SSS2.p1.15.m5.3.3.3.3.3"><csymbol cd="ambiguous" id="S3.SS2.SSS2.p1.15.m5.3.3.3.3.3.2.1.cmml" xref="S3.SS2.SSS2.p1.15.m5.3.3.3.3.3">subscript</csymbol><ci id="S3.SS2.SSS2.p1.15.m5.3.3.3.3.3.2.2.cmml" xref="S3.SS2.SSS2.p1.15.m5.3.3.3.3.3.2.2">𝑟</ci><ci id="S3.SS2.SSS2.p1.15.m5.3.3.3.3.3.2.3.cmml" xref="S3.SS2.SSS2.p1.15.m5.3.3.3.3.3.2.3">𝑖</ci></apply><ci id="S3.SS2.SSS2.p1.15.m5.3.3.3.3.3.3.cmml" xref="S3.SS2.SSS2.p1.15.m5.3.3.3.3.3.3">𝑗</ci></apply></list></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS2.p1.15.m5.3c">\ell_{1}(\theta_{1};u_{i}^{j},r_{i}^{j})</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS2.p1.15.m5.3d">roman_ℓ start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT ( italic_θ start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT ; italic_u start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_j end_POSTSUPERSCRIPT , italic_r start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_j end_POSTSUPERSCRIPT )</annotation></semantics></math> can be written as:</p>
<table class="ltx_equation ltx_eqn_table" id="S3.E3">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_left" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_left">(3)</span></td>
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\ell_{1}(\theta_{1};u_{i}^{j},r_{i}^{j})=-\sum_{t=1}^{T_{i}^{j}}log{P(r_{i}^{j%
}(t)|u_{i}^{j},r_{i}^{j}(&lt;t);\theta_{1})}" class="ltx_Math" display="block" id="S3.E3.m1.5"><semantics id="S3.E3.m1.5a"><mrow id="S3.E3.m1.5.5" xref="S3.E3.m1.5.5.cmml"><mrow id="S3.E3.m1.4.4.3" xref="S3.E3.m1.4.4.3.cmml"><msub id="S3.E3.m1.4.4.3.5" xref="S3.E3.m1.4.4.3.5.cmml"><mi id="S3.E3.m1.4.4.3.5.2" mathvariant="normal" xref="S3.E3.m1.4.4.3.5.2.cmml">ℓ</mi><mn id="S3.E3.m1.4.4.3.5.3" xref="S3.E3.m1.4.4.3.5.3.cmml">1</mn></msub><mo id="S3.E3.m1.4.4.3.4" xref="S3.E3.m1.4.4.3.4.cmml">⁢</mo><mrow id="S3.E3.m1.4.4.3.3.3" xref="S3.E3.m1.4.4.3.3.4.cmml"><mo id="S3.E3.m1.4.4.3.3.3.4" stretchy="false" xref="S3.E3.m1.4.4.3.3.4.cmml">(</mo><msub id="S3.E3.m1.2.2.1.1.1.1" xref="S3.E3.m1.2.2.1.1.1.1.cmml"><mi id="S3.E3.m1.2.2.1.1.1.1.2" xref="S3.E3.m1.2.2.1.1.1.1.2.cmml">θ</mi><mn id="S3.E3.m1.2.2.1.1.1.1.3" xref="S3.E3.m1.2.2.1.1.1.1.3.cmml">1</mn></msub><mo id="S3.E3.m1.4.4.3.3.3.5" xref="S3.E3.m1.4.4.3.3.4.cmml">;</mo><msubsup id="S3.E3.m1.3.3.2.2.2.2" xref="S3.E3.m1.3.3.2.2.2.2.cmml"><mi id="S3.E3.m1.3.3.2.2.2.2.2.2" xref="S3.E3.m1.3.3.2.2.2.2.2.2.cmml">u</mi><mi id="S3.E3.m1.3.3.2.2.2.2.2.3" xref="S3.E3.m1.3.3.2.2.2.2.2.3.cmml">i</mi><mi id="S3.E3.m1.3.3.2.2.2.2.3" xref="S3.E3.m1.3.3.2.2.2.2.3.cmml">j</mi></msubsup><mo id="S3.E3.m1.4.4.3.3.3.6" xref="S3.E3.m1.4.4.3.3.4.cmml">,</mo><msubsup id="S3.E3.m1.4.4.3.3.3.3" xref="S3.E3.m1.4.4.3.3.3.3.cmml"><mi id="S3.E3.m1.4.4.3.3.3.3.2.2" xref="S3.E3.m1.4.4.3.3.3.3.2.2.cmml">r</mi><mi id="S3.E3.m1.4.4.3.3.3.3.2.3" xref="S3.E3.m1.4.4.3.3.3.3.2.3.cmml">i</mi><mi id="S3.E3.m1.4.4.3.3.3.3.3" xref="S3.E3.m1.4.4.3.3.3.3.3.cmml">j</mi></msubsup><mo id="S3.E3.m1.4.4.3.3.3.7" stretchy="false" xref="S3.E3.m1.4.4.3.3.4.cmml">)</mo></mrow></mrow><mo id="S3.E3.m1.5.5.5" xref="S3.E3.m1.5.5.5.cmml">=</mo><mrow id="S3.E3.m1.5.5.4" xref="S3.E3.m1.5.5.4.cmml"><mo id="S3.E3.m1.5.5.4a" xref="S3.E3.m1.5.5.4.cmml">−</mo><mrow id="S3.E3.m1.5.5.4.1" xref="S3.E3.m1.5.5.4.1.cmml"><munderover id="S3.E3.m1.5.5.4.1.2" xref="S3.E3.m1.5.5.4.1.2.cmml"><mo id="S3.E3.m1.5.5.4.1.2.2.2" movablelimits="false" xref="S3.E3.m1.5.5.4.1.2.2.2.cmml">∑</mo><mrow id="S3.E3.m1.5.5.4.1.2.2.3" xref="S3.E3.m1.5.5.4.1.2.2.3.cmml"><mi id="S3.E3.m1.5.5.4.1.2.2.3.2" xref="S3.E3.m1.5.5.4.1.2.2.3.2.cmml">t</mi><mo id="S3.E3.m1.5.5.4.1.2.2.3.1" xref="S3.E3.m1.5.5.4.1.2.2.3.1.cmml">=</mo><mn id="S3.E3.m1.5.5.4.1.2.2.3.3" xref="S3.E3.m1.5.5.4.1.2.2.3.3.cmml">1</mn></mrow><msubsup id="S3.E3.m1.5.5.4.1.2.3" xref="S3.E3.m1.5.5.4.1.2.3.cmml"><mi id="S3.E3.m1.5.5.4.1.2.3.2.2" xref="S3.E3.m1.5.5.4.1.2.3.2.2.cmml">T</mi><mi id="S3.E3.m1.5.5.4.1.2.3.2.3" xref="S3.E3.m1.5.5.4.1.2.3.2.3.cmml">i</mi><mi id="S3.E3.m1.5.5.4.1.2.3.3" xref="S3.E3.m1.5.5.4.1.2.3.3.cmml">j</mi></msubsup></munderover><mrow id="S3.E3.m1.5.5.4.1.1" xref="S3.E3.m1.5.5.4.1.1.cmml"><mi id="S3.E3.m1.5.5.4.1.1.3" xref="S3.E3.m1.5.5.4.1.1.3.cmml">l</mi><mo id="S3.E3.m1.5.5.4.1.1.2" xref="S3.E3.m1.5.5.4.1.1.2.cmml">⁢</mo><mi id="S3.E3.m1.5.5.4.1.1.4" xref="S3.E3.m1.5.5.4.1.1.4.cmml">o</mi><mo id="S3.E3.m1.5.5.4.1.1.2a" xref="S3.E3.m1.5.5.4.1.1.2.cmml">⁢</mo><mi id="S3.E3.m1.5.5.4.1.1.5" xref="S3.E3.m1.5.5.4.1.1.5.cmml">g</mi><mo id="S3.E3.m1.5.5.4.1.1.2b" xref="S3.E3.m1.5.5.4.1.1.2.cmml">⁢</mo><mi id="S3.E3.m1.5.5.4.1.1.6" xref="S3.E3.m1.5.5.4.1.1.6.cmml">P</mi><mo id="S3.E3.m1.5.5.4.1.1.2c" xref="S3.E3.m1.5.5.4.1.1.2.cmml">⁢</mo><mrow id="S3.E3.m1.5.5.4.1.1.1.1" xref="S3.E3.m1.5.5.4.1.1.1.1.1.cmml"><mo id="S3.E3.m1.5.5.4.1.1.1.1.2" stretchy="false" xref="S3.E3.m1.5.5.4.1.1.1.1.1.cmml">(</mo><mrow id="S3.E3.m1.5.5.4.1.1.1.1.1" xref="S3.E3.m1.5.5.4.1.1.1.1.1.cmml"><mrow id="S3.E3.m1.5.5.4.1.1.1.1.1.5" xref="S3.E3.m1.5.5.4.1.1.1.1.1.5.cmml"><msubsup id="S3.E3.m1.5.5.4.1.1.1.1.1.5.2" xref="S3.E3.m1.5.5.4.1.1.1.1.1.5.2.cmml"><mi id="S3.E3.m1.5.5.4.1.1.1.1.1.5.2.2.2" xref="S3.E3.m1.5.5.4.1.1.1.1.1.5.2.2.2.cmml">r</mi><mi id="S3.E3.m1.5.5.4.1.1.1.1.1.5.2.2.3" xref="S3.E3.m1.5.5.4.1.1.1.1.1.5.2.2.3.cmml">i</mi><mi id="S3.E3.m1.5.5.4.1.1.1.1.1.5.2.3" xref="S3.E3.m1.5.5.4.1.1.1.1.1.5.2.3.cmml">j</mi></msubsup><mo id="S3.E3.m1.5.5.4.1.1.1.1.1.5.1" xref="S3.E3.m1.5.5.4.1.1.1.1.1.5.1.cmml">⁢</mo><mrow id="S3.E3.m1.5.5.4.1.1.1.1.1.5.3.2" xref="S3.E3.m1.5.5.4.1.1.1.1.1.5.cmml"><mo id="S3.E3.m1.5.5.4.1.1.1.1.1.5.3.2.1" stretchy="false" xref="S3.E3.m1.5.5.4.1.1.1.1.1.5.cmml">(</mo><mi id="S3.E3.m1.1.1" xref="S3.E3.m1.1.1.cmml">t</mi><mo id="S3.E3.m1.5.5.4.1.1.1.1.1.5.3.2.2" stretchy="false" xref="S3.E3.m1.5.5.4.1.1.1.1.1.5.cmml">)</mo></mrow></mrow><mo fence="false" id="S3.E3.m1.5.5.4.1.1.1.1.1.4" xref="S3.E3.m1.5.5.4.1.1.1.1.1.4.cmml">|</mo><mrow id="S3.E3.m1.5.5.4.1.1.1.1.1.3.3" xref="S3.E3.m1.5.5.4.1.1.1.1.1.3.4.cmml"><msubsup id="S3.E3.m1.5.5.4.1.1.1.1.1.1.1.1" xref="S3.E3.m1.5.5.4.1.1.1.1.1.1.1.1.cmml"><mi id="S3.E3.m1.5.5.4.1.1.1.1.1.1.1.1.2.2" xref="S3.E3.m1.5.5.4.1.1.1.1.1.1.1.1.2.2.cmml">u</mi><mi id="S3.E3.m1.5.5.4.1.1.1.1.1.1.1.1.2.3" xref="S3.E3.m1.5.5.4.1.1.1.1.1.1.1.1.2.3.cmml">i</mi><mi id="S3.E3.m1.5.5.4.1.1.1.1.1.1.1.1.3" xref="S3.E3.m1.5.5.4.1.1.1.1.1.1.1.1.3.cmml">j</mi></msubsup><mo id="S3.E3.m1.5.5.4.1.1.1.1.1.3.3.4" xref="S3.E3.m1.5.5.4.1.1.1.1.1.3.4.cmml">,</mo><mrow id="S3.E3.m1.5.5.4.1.1.1.1.1.2.2.2" xref="S3.E3.m1.5.5.4.1.1.1.1.1.2.2.2.cmml"><msubsup id="S3.E3.m1.5.5.4.1.1.1.1.1.2.2.2.3" xref="S3.E3.m1.5.5.4.1.1.1.1.1.2.2.2.3.cmml"><mi id="S3.E3.m1.5.5.4.1.1.1.1.1.2.2.2.3.2.2" xref="S3.E3.m1.5.5.4.1.1.1.1.1.2.2.2.3.2.2.cmml">r</mi><mi id="S3.E3.m1.5.5.4.1.1.1.1.1.2.2.2.3.2.3" xref="S3.E3.m1.5.5.4.1.1.1.1.1.2.2.2.3.2.3.cmml">i</mi><mi id="S3.E3.m1.5.5.4.1.1.1.1.1.2.2.2.3.3" xref="S3.E3.m1.5.5.4.1.1.1.1.1.2.2.2.3.3.cmml">j</mi></msubsup><mspace id="S3.E3.m1.5.5.4.1.1.1.1.1.2.2.2a" width="0.3888888888888889em" xref="S3.E3.m1.5.5.4.1.1.1.1.1.2.2.2.cmml"></mspace><mrow id="S3.E3.m1.5.5.4.1.1.1.1.1.2.2.2.1.1" xref="S3.E3.m1.5.5.4.1.1.1.1.1.2.2.2.1.1.1.cmml"><mo id="S3.E3.m1.5.5.4.1.1.1.1.1.2.2.2.1.1.2" stretchy="false" xref="S3.E3.m1.5.5.4.1.1.1.1.1.2.2.2.1.1.1.cmml">(</mo><mrow id="S3.E3.m1.5.5.4.1.1.1.1.1.2.2.2.1.1.1" xref="S3.E3.m1.5.5.4.1.1.1.1.1.2.2.2.1.1.1.cmml"><mi id="S3.E3.m1.5.5.4.1.1.1.1.1.2.2.2.1.1.1.2" xref="S3.E3.m1.5.5.4.1.1.1.1.1.2.2.2.1.1.1.2.cmml"></mi><mo id="S3.E3.m1.5.5.4.1.1.1.1.1.2.2.2.1.1.1.1" xref="S3.E3.m1.5.5.4.1.1.1.1.1.2.2.2.1.1.1.1.cmml">&lt;</mo><mi id="S3.E3.m1.5.5.4.1.1.1.1.1.2.2.2.1.1.1.3" xref="S3.E3.m1.5.5.4.1.1.1.1.1.2.2.2.1.1.1.3.cmml">t</mi></mrow><mo id="S3.E3.m1.5.5.4.1.1.1.1.1.2.2.2.1.1.3" stretchy="false" xref="S3.E3.m1.5.5.4.1.1.1.1.1.2.2.2.1.1.1.cmml">)</mo></mrow></mrow><mo id="S3.E3.m1.5.5.4.1.1.1.1.1.3.3.5" xref="S3.E3.m1.5.5.4.1.1.1.1.1.3.4.cmml">;</mo><msub id="S3.E3.m1.5.5.4.1.1.1.1.1.3.3.3" xref="S3.E3.m1.5.5.4.1.1.1.1.1.3.3.3.cmml"><mi id="S3.E3.m1.5.5.4.1.1.1.1.1.3.3.3.2" xref="S3.E3.m1.5.5.4.1.1.1.1.1.3.3.3.2.cmml">θ</mi><mn id="S3.E3.m1.5.5.4.1.1.1.1.1.3.3.3.3" xref="S3.E3.m1.5.5.4.1.1.1.1.1.3.3.3.3.cmml">1</mn></msub></mrow></mrow><mo id="S3.E3.m1.5.5.4.1.1.1.1.3" stretchy="false" xref="S3.E3.m1.5.5.4.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.E3.m1.5b"><apply id="S3.E3.m1.5.5.cmml" xref="S3.E3.m1.5.5"><eq id="S3.E3.m1.5.5.5.cmml" xref="S3.E3.m1.5.5.5"></eq><apply id="S3.E3.m1.4.4.3.cmml" xref="S3.E3.m1.4.4.3"><times id="S3.E3.m1.4.4.3.4.cmml" xref="S3.E3.m1.4.4.3.4"></times><apply id="S3.E3.m1.4.4.3.5.cmml" xref="S3.E3.m1.4.4.3.5"><csymbol cd="ambiguous" id="S3.E3.m1.4.4.3.5.1.cmml" xref="S3.E3.m1.4.4.3.5">subscript</csymbol><ci id="S3.E3.m1.4.4.3.5.2.cmml" xref="S3.E3.m1.4.4.3.5.2">ℓ</ci><cn id="S3.E3.m1.4.4.3.5.3.cmml" type="integer" xref="S3.E3.m1.4.4.3.5.3">1</cn></apply><list id="S3.E3.m1.4.4.3.3.4.cmml" xref="S3.E3.m1.4.4.3.3.3"><apply id="S3.E3.m1.2.2.1.1.1.1.cmml" xref="S3.E3.m1.2.2.1.1.1.1"><csymbol cd="ambiguous" id="S3.E3.m1.2.2.1.1.1.1.1.cmml" xref="S3.E3.m1.2.2.1.1.1.1">subscript</csymbol><ci id="S3.E3.m1.2.2.1.1.1.1.2.cmml" xref="S3.E3.m1.2.2.1.1.1.1.2">𝜃</ci><cn id="S3.E3.m1.2.2.1.1.1.1.3.cmml" type="integer" xref="S3.E3.m1.2.2.1.1.1.1.3">1</cn></apply><apply id="S3.E3.m1.3.3.2.2.2.2.cmml" xref="S3.E3.m1.3.3.2.2.2.2"><csymbol cd="ambiguous" id="S3.E3.m1.3.3.2.2.2.2.1.cmml" xref="S3.E3.m1.3.3.2.2.2.2">superscript</csymbol><apply id="S3.E3.m1.3.3.2.2.2.2.2.cmml" xref="S3.E3.m1.3.3.2.2.2.2"><csymbol cd="ambiguous" id="S3.E3.m1.3.3.2.2.2.2.2.1.cmml" xref="S3.E3.m1.3.3.2.2.2.2">subscript</csymbol><ci id="S3.E3.m1.3.3.2.2.2.2.2.2.cmml" xref="S3.E3.m1.3.3.2.2.2.2.2.2">𝑢</ci><ci id="S3.E3.m1.3.3.2.2.2.2.2.3.cmml" xref="S3.E3.m1.3.3.2.2.2.2.2.3">𝑖</ci></apply><ci id="S3.E3.m1.3.3.2.2.2.2.3.cmml" xref="S3.E3.m1.3.3.2.2.2.2.3">𝑗</ci></apply><apply id="S3.E3.m1.4.4.3.3.3.3.cmml" xref="S3.E3.m1.4.4.3.3.3.3"><csymbol cd="ambiguous" id="S3.E3.m1.4.4.3.3.3.3.1.cmml" xref="S3.E3.m1.4.4.3.3.3.3">superscript</csymbol><apply id="S3.E3.m1.4.4.3.3.3.3.2.cmml" xref="S3.E3.m1.4.4.3.3.3.3"><csymbol cd="ambiguous" id="S3.E3.m1.4.4.3.3.3.3.2.1.cmml" xref="S3.E3.m1.4.4.3.3.3.3">subscript</csymbol><ci id="S3.E3.m1.4.4.3.3.3.3.2.2.cmml" xref="S3.E3.m1.4.4.3.3.3.3.2.2">𝑟</ci><ci id="S3.E3.m1.4.4.3.3.3.3.2.3.cmml" xref="S3.E3.m1.4.4.3.3.3.3.2.3">𝑖</ci></apply><ci id="S3.E3.m1.4.4.3.3.3.3.3.cmml" xref="S3.E3.m1.4.4.3.3.3.3.3">𝑗</ci></apply></list></apply><apply id="S3.E3.m1.5.5.4.cmml" xref="S3.E3.m1.5.5.4"><minus id="S3.E3.m1.5.5.4.2.cmml" xref="S3.E3.m1.5.5.4"></minus><apply id="S3.E3.m1.5.5.4.1.cmml" xref="S3.E3.m1.5.5.4.1"><apply id="S3.E3.m1.5.5.4.1.2.cmml" xref="S3.E3.m1.5.5.4.1.2"><csymbol cd="ambiguous" id="S3.E3.m1.5.5.4.1.2.1.cmml" xref="S3.E3.m1.5.5.4.1.2">superscript</csymbol><apply id="S3.E3.m1.5.5.4.1.2.2.cmml" xref="S3.E3.m1.5.5.4.1.2"><csymbol cd="ambiguous" id="S3.E3.m1.5.5.4.1.2.2.1.cmml" xref="S3.E3.m1.5.5.4.1.2">subscript</csymbol><sum id="S3.E3.m1.5.5.4.1.2.2.2.cmml" xref="S3.E3.m1.5.5.4.1.2.2.2"></sum><apply id="S3.E3.m1.5.5.4.1.2.2.3.cmml" xref="S3.E3.m1.5.5.4.1.2.2.3"><eq id="S3.E3.m1.5.5.4.1.2.2.3.1.cmml" xref="S3.E3.m1.5.5.4.1.2.2.3.1"></eq><ci id="S3.E3.m1.5.5.4.1.2.2.3.2.cmml" xref="S3.E3.m1.5.5.4.1.2.2.3.2">𝑡</ci><cn id="S3.E3.m1.5.5.4.1.2.2.3.3.cmml" type="integer" xref="S3.E3.m1.5.5.4.1.2.2.3.3">1</cn></apply></apply><apply id="S3.E3.m1.5.5.4.1.2.3.cmml" xref="S3.E3.m1.5.5.4.1.2.3"><csymbol cd="ambiguous" id="S3.E3.m1.5.5.4.1.2.3.1.cmml" xref="S3.E3.m1.5.5.4.1.2.3">superscript</csymbol><apply id="S3.E3.m1.5.5.4.1.2.3.2.cmml" xref="S3.E3.m1.5.5.4.1.2.3"><csymbol cd="ambiguous" id="S3.E3.m1.5.5.4.1.2.3.2.1.cmml" xref="S3.E3.m1.5.5.4.1.2.3">subscript</csymbol><ci id="S3.E3.m1.5.5.4.1.2.3.2.2.cmml" xref="S3.E3.m1.5.5.4.1.2.3.2.2">𝑇</ci><ci id="S3.E3.m1.5.5.4.1.2.3.2.3.cmml" xref="S3.E3.m1.5.5.4.1.2.3.2.3">𝑖</ci></apply><ci id="S3.E3.m1.5.5.4.1.2.3.3.cmml" xref="S3.E3.m1.5.5.4.1.2.3.3">𝑗</ci></apply></apply><apply id="S3.E3.m1.5.5.4.1.1.cmml" xref="S3.E3.m1.5.5.4.1.1"><times id="S3.E3.m1.5.5.4.1.1.2.cmml" xref="S3.E3.m1.5.5.4.1.1.2"></times><ci id="S3.E3.m1.5.5.4.1.1.3.cmml" xref="S3.E3.m1.5.5.4.1.1.3">𝑙</ci><ci id="S3.E3.m1.5.5.4.1.1.4.cmml" xref="S3.E3.m1.5.5.4.1.1.4">𝑜</ci><ci id="S3.E3.m1.5.5.4.1.1.5.cmml" xref="S3.E3.m1.5.5.4.1.1.5">𝑔</ci><ci id="S3.E3.m1.5.5.4.1.1.6.cmml" xref="S3.E3.m1.5.5.4.1.1.6">𝑃</ci><apply id="S3.E3.m1.5.5.4.1.1.1.1.1.cmml" xref="S3.E3.m1.5.5.4.1.1.1.1"><csymbol cd="latexml" id="S3.E3.m1.5.5.4.1.1.1.1.1.4.cmml" xref="S3.E3.m1.5.5.4.1.1.1.1.1.4">conditional</csymbol><apply id="S3.E3.m1.5.5.4.1.1.1.1.1.5.cmml" xref="S3.E3.m1.5.5.4.1.1.1.1.1.5"><times id="S3.E3.m1.5.5.4.1.1.1.1.1.5.1.cmml" xref="S3.E3.m1.5.5.4.1.1.1.1.1.5.1"></times><apply id="S3.E3.m1.5.5.4.1.1.1.1.1.5.2.cmml" xref="S3.E3.m1.5.5.4.1.1.1.1.1.5.2"><csymbol cd="ambiguous" id="S3.E3.m1.5.5.4.1.1.1.1.1.5.2.1.cmml" xref="S3.E3.m1.5.5.4.1.1.1.1.1.5.2">superscript</csymbol><apply id="S3.E3.m1.5.5.4.1.1.1.1.1.5.2.2.cmml" xref="S3.E3.m1.5.5.4.1.1.1.1.1.5.2"><csymbol cd="ambiguous" id="S3.E3.m1.5.5.4.1.1.1.1.1.5.2.2.1.cmml" xref="S3.E3.m1.5.5.4.1.1.1.1.1.5.2">subscript</csymbol><ci id="S3.E3.m1.5.5.4.1.1.1.1.1.5.2.2.2.cmml" xref="S3.E3.m1.5.5.4.1.1.1.1.1.5.2.2.2">𝑟</ci><ci id="S3.E3.m1.5.5.4.1.1.1.1.1.5.2.2.3.cmml" xref="S3.E3.m1.5.5.4.1.1.1.1.1.5.2.2.3">𝑖</ci></apply><ci id="S3.E3.m1.5.5.4.1.1.1.1.1.5.2.3.cmml" xref="S3.E3.m1.5.5.4.1.1.1.1.1.5.2.3">𝑗</ci></apply><ci id="S3.E3.m1.1.1.cmml" xref="S3.E3.m1.1.1">𝑡</ci></apply><list id="S3.E3.m1.5.5.4.1.1.1.1.1.3.4.cmml" xref="S3.E3.m1.5.5.4.1.1.1.1.1.3.3"><apply id="S3.E3.m1.5.5.4.1.1.1.1.1.1.1.1.cmml" xref="S3.E3.m1.5.5.4.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E3.m1.5.5.4.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E3.m1.5.5.4.1.1.1.1.1.1.1.1">superscript</csymbol><apply id="S3.E3.m1.5.5.4.1.1.1.1.1.1.1.1.2.cmml" xref="S3.E3.m1.5.5.4.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E3.m1.5.5.4.1.1.1.1.1.1.1.1.2.1.cmml" xref="S3.E3.m1.5.5.4.1.1.1.1.1.1.1.1">subscript</csymbol><ci id="S3.E3.m1.5.5.4.1.1.1.1.1.1.1.1.2.2.cmml" xref="S3.E3.m1.5.5.4.1.1.1.1.1.1.1.1.2.2">𝑢</ci><ci id="S3.E3.m1.5.5.4.1.1.1.1.1.1.1.1.2.3.cmml" xref="S3.E3.m1.5.5.4.1.1.1.1.1.1.1.1.2.3">𝑖</ci></apply><ci id="S3.E3.m1.5.5.4.1.1.1.1.1.1.1.1.3.cmml" xref="S3.E3.m1.5.5.4.1.1.1.1.1.1.1.1.3">𝑗</ci></apply><apply id="S3.E3.m1.5.5.4.1.1.1.1.1.2.2.2.cmml" xref="S3.E3.m1.5.5.4.1.1.1.1.1.2.2.2"><csymbol cd="latexml" id="S3.E3.m1.5.5.4.1.1.1.1.1.2.2.2.2.cmml" xref="S3.E3.m1.5.5.4.1.1.1.1.1.2.2.2">annotated</csymbol><apply id="S3.E3.m1.5.5.4.1.1.1.1.1.2.2.2.3.cmml" xref="S3.E3.m1.5.5.4.1.1.1.1.1.2.2.2.3"><csymbol cd="ambiguous" id="S3.E3.m1.5.5.4.1.1.1.1.1.2.2.2.3.1.cmml" xref="S3.E3.m1.5.5.4.1.1.1.1.1.2.2.2.3">superscript</csymbol><apply id="S3.E3.m1.5.5.4.1.1.1.1.1.2.2.2.3.2.cmml" xref="S3.E3.m1.5.5.4.1.1.1.1.1.2.2.2.3"><csymbol cd="ambiguous" id="S3.E3.m1.5.5.4.1.1.1.1.1.2.2.2.3.2.1.cmml" xref="S3.E3.m1.5.5.4.1.1.1.1.1.2.2.2.3">subscript</csymbol><ci id="S3.E3.m1.5.5.4.1.1.1.1.1.2.2.2.3.2.2.cmml" xref="S3.E3.m1.5.5.4.1.1.1.1.1.2.2.2.3.2.2">𝑟</ci><ci id="S3.E3.m1.5.5.4.1.1.1.1.1.2.2.2.3.2.3.cmml" xref="S3.E3.m1.5.5.4.1.1.1.1.1.2.2.2.3.2.3">𝑖</ci></apply><ci id="S3.E3.m1.5.5.4.1.1.1.1.1.2.2.2.3.3.cmml" xref="S3.E3.m1.5.5.4.1.1.1.1.1.2.2.2.3.3">𝑗</ci></apply><apply id="S3.E3.m1.5.5.4.1.1.1.1.1.2.2.2.1.1.1.cmml" xref="S3.E3.m1.5.5.4.1.1.1.1.1.2.2.2.1.1"><lt id="S3.E3.m1.5.5.4.1.1.1.1.1.2.2.2.1.1.1.1.cmml" xref="S3.E3.m1.5.5.4.1.1.1.1.1.2.2.2.1.1.1.1"></lt><csymbol cd="latexml" id="S3.E3.m1.5.5.4.1.1.1.1.1.2.2.2.1.1.1.2.cmml" xref="S3.E3.m1.5.5.4.1.1.1.1.1.2.2.2.1.1.1.2">absent</csymbol><ci id="S3.E3.m1.5.5.4.1.1.1.1.1.2.2.2.1.1.1.3.cmml" xref="S3.E3.m1.5.5.4.1.1.1.1.1.2.2.2.1.1.1.3">𝑡</ci></apply></apply><apply id="S3.E3.m1.5.5.4.1.1.1.1.1.3.3.3.cmml" xref="S3.E3.m1.5.5.4.1.1.1.1.1.3.3.3"><csymbol cd="ambiguous" id="S3.E3.m1.5.5.4.1.1.1.1.1.3.3.3.1.cmml" xref="S3.E3.m1.5.5.4.1.1.1.1.1.3.3.3">subscript</csymbol><ci id="S3.E3.m1.5.5.4.1.1.1.1.1.3.3.3.2.cmml" xref="S3.E3.m1.5.5.4.1.1.1.1.1.3.3.3.2">𝜃</ci><cn id="S3.E3.m1.5.5.4.1.1.1.1.1.3.3.3.3.cmml" type="integer" xref="S3.E3.m1.5.5.4.1.1.1.1.1.3.3.3.3">1</cn></apply></list></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E3.m1.5c">\ell_{1}(\theta_{1};u_{i}^{j},r_{i}^{j})=-\sum_{t=1}^{T_{i}^{j}}log{P(r_{i}^{j%
}(t)|u_{i}^{j},r_{i}^{j}(&lt;t);\theta_{1})}</annotation><annotation encoding="application/x-llamapun" id="S3.E3.m1.5d">roman_ℓ start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT ( italic_θ start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT ; italic_u start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_j end_POSTSUPERSCRIPT , italic_r start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_j end_POSTSUPERSCRIPT ) = - ∑ start_POSTSUBSCRIPT italic_t = 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_T start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_j end_POSTSUPERSCRIPT end_POSTSUPERSCRIPT italic_l italic_o italic_g italic_P ( italic_r start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_j end_POSTSUPERSCRIPT ( italic_t ) | italic_u start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_j end_POSTSUPERSCRIPT , italic_r start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_j end_POSTSUPERSCRIPT ( &lt; italic_t ) ; italic_θ start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT )</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S3.SS2.SSS2.p1.22">where <math alttext="P(r_{i}^{j}(t)|u_{i}^{j},r_{i}^{j}(&lt;t);\theta_{1})" class="ltx_Math" display="inline" id="S3.SS2.SSS2.p1.16.m1.2"><semantics id="S3.SS2.SSS2.p1.16.m1.2a"><mrow id="S3.SS2.SSS2.p1.16.m1.2.2" xref="S3.SS2.SSS2.p1.16.m1.2.2.cmml"><mi id="S3.SS2.SSS2.p1.16.m1.2.2.3" xref="S3.SS2.SSS2.p1.16.m1.2.2.3.cmml">P</mi><mo id="S3.SS2.SSS2.p1.16.m1.2.2.2" xref="S3.SS2.SSS2.p1.16.m1.2.2.2.cmml">⁢</mo><mrow id="S3.SS2.SSS2.p1.16.m1.2.2.1.1" xref="S3.SS2.SSS2.p1.16.m1.2.2.1.1.1.cmml"><mo id="S3.SS2.SSS2.p1.16.m1.2.2.1.1.2" stretchy="false" xref="S3.SS2.SSS2.p1.16.m1.2.2.1.1.1.cmml">(</mo><mrow id="S3.SS2.SSS2.p1.16.m1.2.2.1.1.1" xref="S3.SS2.SSS2.p1.16.m1.2.2.1.1.1.cmml"><mrow id="S3.SS2.SSS2.p1.16.m1.2.2.1.1.1.5" xref="S3.SS2.SSS2.p1.16.m1.2.2.1.1.1.5.cmml"><msubsup id="S3.SS2.SSS2.p1.16.m1.2.2.1.1.1.5.2" xref="S3.SS2.SSS2.p1.16.m1.2.2.1.1.1.5.2.cmml"><mi id="S3.SS2.SSS2.p1.16.m1.2.2.1.1.1.5.2.2.2" xref="S3.SS2.SSS2.p1.16.m1.2.2.1.1.1.5.2.2.2.cmml">r</mi><mi id="S3.SS2.SSS2.p1.16.m1.2.2.1.1.1.5.2.2.3" xref="S3.SS2.SSS2.p1.16.m1.2.2.1.1.1.5.2.2.3.cmml">i</mi><mi id="S3.SS2.SSS2.p1.16.m1.2.2.1.1.1.5.2.3" xref="S3.SS2.SSS2.p1.16.m1.2.2.1.1.1.5.2.3.cmml">j</mi></msubsup><mo id="S3.SS2.SSS2.p1.16.m1.2.2.1.1.1.5.1" xref="S3.SS2.SSS2.p1.16.m1.2.2.1.1.1.5.1.cmml">⁢</mo><mrow id="S3.SS2.SSS2.p1.16.m1.2.2.1.1.1.5.3.2" xref="S3.SS2.SSS2.p1.16.m1.2.2.1.1.1.5.cmml"><mo id="S3.SS2.SSS2.p1.16.m1.2.2.1.1.1.5.3.2.1" stretchy="false" xref="S3.SS2.SSS2.p1.16.m1.2.2.1.1.1.5.cmml">(</mo><mi id="S3.SS2.SSS2.p1.16.m1.1.1" xref="S3.SS2.SSS2.p1.16.m1.1.1.cmml">t</mi><mo id="S3.SS2.SSS2.p1.16.m1.2.2.1.1.1.5.3.2.2" stretchy="false" xref="S3.SS2.SSS2.p1.16.m1.2.2.1.1.1.5.cmml">)</mo></mrow></mrow><mo fence="false" id="S3.SS2.SSS2.p1.16.m1.2.2.1.1.1.4" xref="S3.SS2.SSS2.p1.16.m1.2.2.1.1.1.4.cmml">|</mo><mrow id="S3.SS2.SSS2.p1.16.m1.2.2.1.1.1.3.3" xref="S3.SS2.SSS2.p1.16.m1.2.2.1.1.1.3.4.cmml"><msubsup id="S3.SS2.SSS2.p1.16.m1.2.2.1.1.1.1.1.1" xref="S3.SS2.SSS2.p1.16.m1.2.2.1.1.1.1.1.1.cmml"><mi id="S3.SS2.SSS2.p1.16.m1.2.2.1.1.1.1.1.1.2.2" xref="S3.SS2.SSS2.p1.16.m1.2.2.1.1.1.1.1.1.2.2.cmml">u</mi><mi id="S3.SS2.SSS2.p1.16.m1.2.2.1.1.1.1.1.1.2.3" xref="S3.SS2.SSS2.p1.16.m1.2.2.1.1.1.1.1.1.2.3.cmml">i</mi><mi id="S3.SS2.SSS2.p1.16.m1.2.2.1.1.1.1.1.1.3" xref="S3.SS2.SSS2.p1.16.m1.2.2.1.1.1.1.1.1.3.cmml">j</mi></msubsup><mo id="S3.SS2.SSS2.p1.16.m1.2.2.1.1.1.3.3.4" xref="S3.SS2.SSS2.p1.16.m1.2.2.1.1.1.3.4.cmml">,</mo><mrow id="S3.SS2.SSS2.p1.16.m1.2.2.1.1.1.2.2.2" xref="S3.SS2.SSS2.p1.16.m1.2.2.1.1.1.2.2.2.cmml"><msubsup id="S3.SS2.SSS2.p1.16.m1.2.2.1.1.1.2.2.2.3" xref="S3.SS2.SSS2.p1.16.m1.2.2.1.1.1.2.2.2.3.cmml"><mi id="S3.SS2.SSS2.p1.16.m1.2.2.1.1.1.2.2.2.3.2.2" xref="S3.SS2.SSS2.p1.16.m1.2.2.1.1.1.2.2.2.3.2.2.cmml">r</mi><mi id="S3.SS2.SSS2.p1.16.m1.2.2.1.1.1.2.2.2.3.2.3" xref="S3.SS2.SSS2.p1.16.m1.2.2.1.1.1.2.2.2.3.2.3.cmml">i</mi><mi id="S3.SS2.SSS2.p1.16.m1.2.2.1.1.1.2.2.2.3.3" xref="S3.SS2.SSS2.p1.16.m1.2.2.1.1.1.2.2.2.3.3.cmml">j</mi></msubsup><mspace id="S3.SS2.SSS2.p1.16.m1.2.2.1.1.1.2.2.2a" width="0.3888888888888889em" xref="S3.SS2.SSS2.p1.16.m1.2.2.1.1.1.2.2.2.cmml"></mspace><mrow id="S3.SS2.SSS2.p1.16.m1.2.2.1.1.1.2.2.2.1.1" xref="S3.SS2.SSS2.p1.16.m1.2.2.1.1.1.2.2.2.1.1.1.cmml"><mo id="S3.SS2.SSS2.p1.16.m1.2.2.1.1.1.2.2.2.1.1.2" stretchy="false" xref="S3.SS2.SSS2.p1.16.m1.2.2.1.1.1.2.2.2.1.1.1.cmml">(</mo><mrow id="S3.SS2.SSS2.p1.16.m1.2.2.1.1.1.2.2.2.1.1.1" xref="S3.SS2.SSS2.p1.16.m1.2.2.1.1.1.2.2.2.1.1.1.cmml"><mi id="S3.SS2.SSS2.p1.16.m1.2.2.1.1.1.2.2.2.1.1.1.2" xref="S3.SS2.SSS2.p1.16.m1.2.2.1.1.1.2.2.2.1.1.1.2.cmml"></mi><mo id="S3.SS2.SSS2.p1.16.m1.2.2.1.1.1.2.2.2.1.1.1.1" xref="S3.SS2.SSS2.p1.16.m1.2.2.1.1.1.2.2.2.1.1.1.1.cmml">&lt;</mo><mi id="S3.SS2.SSS2.p1.16.m1.2.2.1.1.1.2.2.2.1.1.1.3" xref="S3.SS2.SSS2.p1.16.m1.2.2.1.1.1.2.2.2.1.1.1.3.cmml">t</mi></mrow><mo id="S3.SS2.SSS2.p1.16.m1.2.2.1.1.1.2.2.2.1.1.3" stretchy="false" xref="S3.SS2.SSS2.p1.16.m1.2.2.1.1.1.2.2.2.1.1.1.cmml">)</mo></mrow></mrow><mo id="S3.SS2.SSS2.p1.16.m1.2.2.1.1.1.3.3.5" xref="S3.SS2.SSS2.p1.16.m1.2.2.1.1.1.3.4.cmml">;</mo><msub id="S3.SS2.SSS2.p1.16.m1.2.2.1.1.1.3.3.3" xref="S3.SS2.SSS2.p1.16.m1.2.2.1.1.1.3.3.3.cmml"><mi id="S3.SS2.SSS2.p1.16.m1.2.2.1.1.1.3.3.3.2" xref="S3.SS2.SSS2.p1.16.m1.2.2.1.1.1.3.3.3.2.cmml">θ</mi><mn id="S3.SS2.SSS2.p1.16.m1.2.2.1.1.1.3.3.3.3" xref="S3.SS2.SSS2.p1.16.m1.2.2.1.1.1.3.3.3.3.cmml">1</mn></msub></mrow></mrow><mo id="S3.SS2.SSS2.p1.16.m1.2.2.1.1.3" stretchy="false" xref="S3.SS2.SSS2.p1.16.m1.2.2.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS2.p1.16.m1.2b"><apply id="S3.SS2.SSS2.p1.16.m1.2.2.cmml" xref="S3.SS2.SSS2.p1.16.m1.2.2"><times id="S3.SS2.SSS2.p1.16.m1.2.2.2.cmml" xref="S3.SS2.SSS2.p1.16.m1.2.2.2"></times><ci id="S3.SS2.SSS2.p1.16.m1.2.2.3.cmml" xref="S3.SS2.SSS2.p1.16.m1.2.2.3">𝑃</ci><apply id="S3.SS2.SSS2.p1.16.m1.2.2.1.1.1.cmml" xref="S3.SS2.SSS2.p1.16.m1.2.2.1.1"><csymbol cd="latexml" id="S3.SS2.SSS2.p1.16.m1.2.2.1.1.1.4.cmml" xref="S3.SS2.SSS2.p1.16.m1.2.2.1.1.1.4">conditional</csymbol><apply id="S3.SS2.SSS2.p1.16.m1.2.2.1.1.1.5.cmml" xref="S3.SS2.SSS2.p1.16.m1.2.2.1.1.1.5"><times id="S3.SS2.SSS2.p1.16.m1.2.2.1.1.1.5.1.cmml" xref="S3.SS2.SSS2.p1.16.m1.2.2.1.1.1.5.1"></times><apply id="S3.SS2.SSS2.p1.16.m1.2.2.1.1.1.5.2.cmml" xref="S3.SS2.SSS2.p1.16.m1.2.2.1.1.1.5.2"><csymbol cd="ambiguous" id="S3.SS2.SSS2.p1.16.m1.2.2.1.1.1.5.2.1.cmml" xref="S3.SS2.SSS2.p1.16.m1.2.2.1.1.1.5.2">superscript</csymbol><apply id="S3.SS2.SSS2.p1.16.m1.2.2.1.1.1.5.2.2.cmml" xref="S3.SS2.SSS2.p1.16.m1.2.2.1.1.1.5.2"><csymbol cd="ambiguous" id="S3.SS2.SSS2.p1.16.m1.2.2.1.1.1.5.2.2.1.cmml" xref="S3.SS2.SSS2.p1.16.m1.2.2.1.1.1.5.2">subscript</csymbol><ci id="S3.SS2.SSS2.p1.16.m1.2.2.1.1.1.5.2.2.2.cmml" xref="S3.SS2.SSS2.p1.16.m1.2.2.1.1.1.5.2.2.2">𝑟</ci><ci id="S3.SS2.SSS2.p1.16.m1.2.2.1.1.1.5.2.2.3.cmml" xref="S3.SS2.SSS2.p1.16.m1.2.2.1.1.1.5.2.2.3">𝑖</ci></apply><ci id="S3.SS2.SSS2.p1.16.m1.2.2.1.1.1.5.2.3.cmml" xref="S3.SS2.SSS2.p1.16.m1.2.2.1.1.1.5.2.3">𝑗</ci></apply><ci id="S3.SS2.SSS2.p1.16.m1.1.1.cmml" xref="S3.SS2.SSS2.p1.16.m1.1.1">𝑡</ci></apply><list id="S3.SS2.SSS2.p1.16.m1.2.2.1.1.1.3.4.cmml" xref="S3.SS2.SSS2.p1.16.m1.2.2.1.1.1.3.3"><apply id="S3.SS2.SSS2.p1.16.m1.2.2.1.1.1.1.1.1.cmml" xref="S3.SS2.SSS2.p1.16.m1.2.2.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS2.SSS2.p1.16.m1.2.2.1.1.1.1.1.1.1.cmml" xref="S3.SS2.SSS2.p1.16.m1.2.2.1.1.1.1.1.1">superscript</csymbol><apply id="S3.SS2.SSS2.p1.16.m1.2.2.1.1.1.1.1.1.2.cmml" xref="S3.SS2.SSS2.p1.16.m1.2.2.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS2.SSS2.p1.16.m1.2.2.1.1.1.1.1.1.2.1.cmml" xref="S3.SS2.SSS2.p1.16.m1.2.2.1.1.1.1.1.1">subscript</csymbol><ci id="S3.SS2.SSS2.p1.16.m1.2.2.1.1.1.1.1.1.2.2.cmml" xref="S3.SS2.SSS2.p1.16.m1.2.2.1.1.1.1.1.1.2.2">𝑢</ci><ci id="S3.SS2.SSS2.p1.16.m1.2.2.1.1.1.1.1.1.2.3.cmml" xref="S3.SS2.SSS2.p1.16.m1.2.2.1.1.1.1.1.1.2.3">𝑖</ci></apply><ci id="S3.SS2.SSS2.p1.16.m1.2.2.1.1.1.1.1.1.3.cmml" xref="S3.SS2.SSS2.p1.16.m1.2.2.1.1.1.1.1.1.3">𝑗</ci></apply><apply id="S3.SS2.SSS2.p1.16.m1.2.2.1.1.1.2.2.2.cmml" xref="S3.SS2.SSS2.p1.16.m1.2.2.1.1.1.2.2.2"><csymbol cd="latexml" id="S3.SS2.SSS2.p1.16.m1.2.2.1.1.1.2.2.2.2.cmml" xref="S3.SS2.SSS2.p1.16.m1.2.2.1.1.1.2.2.2">annotated</csymbol><apply id="S3.SS2.SSS2.p1.16.m1.2.2.1.1.1.2.2.2.3.cmml" xref="S3.SS2.SSS2.p1.16.m1.2.2.1.1.1.2.2.2.3"><csymbol cd="ambiguous" id="S3.SS2.SSS2.p1.16.m1.2.2.1.1.1.2.2.2.3.1.cmml" xref="S3.SS2.SSS2.p1.16.m1.2.2.1.1.1.2.2.2.3">superscript</csymbol><apply id="S3.SS2.SSS2.p1.16.m1.2.2.1.1.1.2.2.2.3.2.cmml" xref="S3.SS2.SSS2.p1.16.m1.2.2.1.1.1.2.2.2.3"><csymbol cd="ambiguous" id="S3.SS2.SSS2.p1.16.m1.2.2.1.1.1.2.2.2.3.2.1.cmml" xref="S3.SS2.SSS2.p1.16.m1.2.2.1.1.1.2.2.2.3">subscript</csymbol><ci id="S3.SS2.SSS2.p1.16.m1.2.2.1.1.1.2.2.2.3.2.2.cmml" xref="S3.SS2.SSS2.p1.16.m1.2.2.1.1.1.2.2.2.3.2.2">𝑟</ci><ci id="S3.SS2.SSS2.p1.16.m1.2.2.1.1.1.2.2.2.3.2.3.cmml" xref="S3.SS2.SSS2.p1.16.m1.2.2.1.1.1.2.2.2.3.2.3">𝑖</ci></apply><ci id="S3.SS2.SSS2.p1.16.m1.2.2.1.1.1.2.2.2.3.3.cmml" xref="S3.SS2.SSS2.p1.16.m1.2.2.1.1.1.2.2.2.3.3">𝑗</ci></apply><apply id="S3.SS2.SSS2.p1.16.m1.2.2.1.1.1.2.2.2.1.1.1.cmml" xref="S3.SS2.SSS2.p1.16.m1.2.2.1.1.1.2.2.2.1.1"><lt id="S3.SS2.SSS2.p1.16.m1.2.2.1.1.1.2.2.2.1.1.1.1.cmml" xref="S3.SS2.SSS2.p1.16.m1.2.2.1.1.1.2.2.2.1.1.1.1"></lt><csymbol cd="latexml" id="S3.SS2.SSS2.p1.16.m1.2.2.1.1.1.2.2.2.1.1.1.2.cmml" xref="S3.SS2.SSS2.p1.16.m1.2.2.1.1.1.2.2.2.1.1.1.2">absent</csymbol><ci id="S3.SS2.SSS2.p1.16.m1.2.2.1.1.1.2.2.2.1.1.1.3.cmml" xref="S3.SS2.SSS2.p1.16.m1.2.2.1.1.1.2.2.2.1.1.1.3">𝑡</ci></apply></apply><apply id="S3.SS2.SSS2.p1.16.m1.2.2.1.1.1.3.3.3.cmml" xref="S3.SS2.SSS2.p1.16.m1.2.2.1.1.1.3.3.3"><csymbol cd="ambiguous" id="S3.SS2.SSS2.p1.16.m1.2.2.1.1.1.3.3.3.1.cmml" xref="S3.SS2.SSS2.p1.16.m1.2.2.1.1.1.3.3.3">subscript</csymbol><ci id="S3.SS2.SSS2.p1.16.m1.2.2.1.1.1.3.3.3.2.cmml" xref="S3.SS2.SSS2.p1.16.m1.2.2.1.1.1.3.3.3.2">𝜃</ci><cn id="S3.SS2.SSS2.p1.16.m1.2.2.1.1.1.3.3.3.3.cmml" type="integer" xref="S3.SS2.SSS2.p1.16.m1.2.2.1.1.1.3.3.3.3">1</cn></apply></list></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS2.p1.16.m1.2c">P(r_{i}^{j}(t)|u_{i}^{j},r_{i}^{j}(&lt;t);\theta_{1})</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS2.p1.16.m1.2d">italic_P ( italic_r start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_j end_POSTSUPERSCRIPT ( italic_t ) | italic_u start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_j end_POSTSUPERSCRIPT , italic_r start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_j end_POSTSUPERSCRIPT ( &lt; italic_t ) ; italic_θ start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT )</annotation></semantics></math> denotes the conditional probability of the target token <math alttext="r_{i}^{j}(t)" class="ltx_Math" display="inline" id="S3.SS2.SSS2.p1.17.m2.1"><semantics id="S3.SS2.SSS2.p1.17.m2.1a"><mrow id="S3.SS2.SSS2.p1.17.m2.1.2" xref="S3.SS2.SSS2.p1.17.m2.1.2.cmml"><msubsup id="S3.SS2.SSS2.p1.17.m2.1.2.2" xref="S3.SS2.SSS2.p1.17.m2.1.2.2.cmml"><mi id="S3.SS2.SSS2.p1.17.m2.1.2.2.2.2" xref="S3.SS2.SSS2.p1.17.m2.1.2.2.2.2.cmml">r</mi><mi id="S3.SS2.SSS2.p1.17.m2.1.2.2.2.3" xref="S3.SS2.SSS2.p1.17.m2.1.2.2.2.3.cmml">i</mi><mi id="S3.SS2.SSS2.p1.17.m2.1.2.2.3" xref="S3.SS2.SSS2.p1.17.m2.1.2.2.3.cmml">j</mi></msubsup><mo id="S3.SS2.SSS2.p1.17.m2.1.2.1" xref="S3.SS2.SSS2.p1.17.m2.1.2.1.cmml">⁢</mo><mrow id="S3.SS2.SSS2.p1.17.m2.1.2.3.2" xref="S3.SS2.SSS2.p1.17.m2.1.2.cmml"><mo id="S3.SS2.SSS2.p1.17.m2.1.2.3.2.1" stretchy="false" xref="S3.SS2.SSS2.p1.17.m2.1.2.cmml">(</mo><mi id="S3.SS2.SSS2.p1.17.m2.1.1" xref="S3.SS2.SSS2.p1.17.m2.1.1.cmml">t</mi><mo id="S3.SS2.SSS2.p1.17.m2.1.2.3.2.2" stretchy="false" xref="S3.SS2.SSS2.p1.17.m2.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS2.p1.17.m2.1b"><apply id="S3.SS2.SSS2.p1.17.m2.1.2.cmml" xref="S3.SS2.SSS2.p1.17.m2.1.2"><times id="S3.SS2.SSS2.p1.17.m2.1.2.1.cmml" xref="S3.SS2.SSS2.p1.17.m2.1.2.1"></times><apply id="S3.SS2.SSS2.p1.17.m2.1.2.2.cmml" xref="S3.SS2.SSS2.p1.17.m2.1.2.2"><csymbol cd="ambiguous" id="S3.SS2.SSS2.p1.17.m2.1.2.2.1.cmml" xref="S3.SS2.SSS2.p1.17.m2.1.2.2">superscript</csymbol><apply id="S3.SS2.SSS2.p1.17.m2.1.2.2.2.cmml" xref="S3.SS2.SSS2.p1.17.m2.1.2.2"><csymbol cd="ambiguous" id="S3.SS2.SSS2.p1.17.m2.1.2.2.2.1.cmml" xref="S3.SS2.SSS2.p1.17.m2.1.2.2">subscript</csymbol><ci id="S3.SS2.SSS2.p1.17.m2.1.2.2.2.2.cmml" xref="S3.SS2.SSS2.p1.17.m2.1.2.2.2.2">𝑟</ci><ci id="S3.SS2.SSS2.p1.17.m2.1.2.2.2.3.cmml" xref="S3.SS2.SSS2.p1.17.m2.1.2.2.2.3">𝑖</ci></apply><ci id="S3.SS2.SSS2.p1.17.m2.1.2.2.3.cmml" xref="S3.SS2.SSS2.p1.17.m2.1.2.2.3">𝑗</ci></apply><ci id="S3.SS2.SSS2.p1.17.m2.1.1.cmml" xref="S3.SS2.SSS2.p1.17.m2.1.1">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS2.p1.17.m2.1c">r_{i}^{j}(t)</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS2.p1.17.m2.1d">italic_r start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_j end_POSTSUPERSCRIPT ( italic_t )</annotation></semantics></math> given the input <math alttext="u_{i}^{j}" class="ltx_Math" display="inline" id="S3.SS2.SSS2.p1.18.m3.1"><semantics id="S3.SS2.SSS2.p1.18.m3.1a"><msubsup id="S3.SS2.SSS2.p1.18.m3.1.1" xref="S3.SS2.SSS2.p1.18.m3.1.1.cmml"><mi id="S3.SS2.SSS2.p1.18.m3.1.1.2.2" xref="S3.SS2.SSS2.p1.18.m3.1.1.2.2.cmml">u</mi><mi id="S3.SS2.SSS2.p1.18.m3.1.1.2.3" xref="S3.SS2.SSS2.p1.18.m3.1.1.2.3.cmml">i</mi><mi id="S3.SS2.SSS2.p1.18.m3.1.1.3" xref="S3.SS2.SSS2.p1.18.m3.1.1.3.cmml">j</mi></msubsup><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS2.p1.18.m3.1b"><apply id="S3.SS2.SSS2.p1.18.m3.1.1.cmml" xref="S3.SS2.SSS2.p1.18.m3.1.1"><csymbol cd="ambiguous" id="S3.SS2.SSS2.p1.18.m3.1.1.1.cmml" xref="S3.SS2.SSS2.p1.18.m3.1.1">superscript</csymbol><apply id="S3.SS2.SSS2.p1.18.m3.1.1.2.cmml" xref="S3.SS2.SSS2.p1.18.m3.1.1"><csymbol cd="ambiguous" id="S3.SS2.SSS2.p1.18.m3.1.1.2.1.cmml" xref="S3.SS2.SSS2.p1.18.m3.1.1">subscript</csymbol><ci id="S3.SS2.SSS2.p1.18.m3.1.1.2.2.cmml" xref="S3.SS2.SSS2.p1.18.m3.1.1.2.2">𝑢</ci><ci id="S3.SS2.SSS2.p1.18.m3.1.1.2.3.cmml" xref="S3.SS2.SSS2.p1.18.m3.1.1.2.3">𝑖</ci></apply><ci id="S3.SS2.SSS2.p1.18.m3.1.1.3.cmml" xref="S3.SS2.SSS2.p1.18.m3.1.1.3">𝑗</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS2.p1.18.m3.1c">u_{i}^{j}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS2.p1.18.m3.1d">italic_u start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_j end_POSTSUPERSCRIPT</annotation></semantics></math> and the preceding tokens <math alttext="r_{i}^{j}(&lt;t)=\{r_{i}^{j}(1),...,r_{i}^{j}(t-1)\}" class="ltx_Math" display="inline" id="S3.SS2.SSS2.p1.19.m4.5"><semantics id="S3.SS2.SSS2.p1.19.m4.5a"><mrow id="S3.SS2.SSS2.p1.19.m4.5.5" xref="S3.SS2.SSS2.p1.19.m4.5.5.cmml"><mrow id="S3.SS2.SSS2.p1.19.m4.3.3.1" xref="S3.SS2.SSS2.p1.19.m4.3.3.1.cmml"><msubsup id="S3.SS2.SSS2.p1.19.m4.3.3.1.3" xref="S3.SS2.SSS2.p1.19.m4.3.3.1.3.cmml"><mi id="S3.SS2.SSS2.p1.19.m4.3.3.1.3.2.2" xref="S3.SS2.SSS2.p1.19.m4.3.3.1.3.2.2.cmml">r</mi><mi id="S3.SS2.SSS2.p1.19.m4.3.3.1.3.2.3" xref="S3.SS2.SSS2.p1.19.m4.3.3.1.3.2.3.cmml">i</mi><mi id="S3.SS2.SSS2.p1.19.m4.3.3.1.3.3" xref="S3.SS2.SSS2.p1.19.m4.3.3.1.3.3.cmml">j</mi></msubsup><mspace id="S3.SS2.SSS2.p1.19.m4.3.3.1a" width="0.3888888888888889em" xref="S3.SS2.SSS2.p1.19.m4.3.3.1.cmml"></mspace><mrow id="S3.SS2.SSS2.p1.19.m4.3.3.1.1.1" xref="S3.SS2.SSS2.p1.19.m4.3.3.1.1.1.1.cmml"><mo id="S3.SS2.SSS2.p1.19.m4.3.3.1.1.1.2" stretchy="false" xref="S3.SS2.SSS2.p1.19.m4.3.3.1.1.1.1.cmml">(</mo><mrow id="S3.SS2.SSS2.p1.19.m4.3.3.1.1.1.1" xref="S3.SS2.SSS2.p1.19.m4.3.3.1.1.1.1.cmml"><mi id="S3.SS2.SSS2.p1.19.m4.3.3.1.1.1.1.2" xref="S3.SS2.SSS2.p1.19.m4.3.3.1.1.1.1.2.cmml"></mi><mo id="S3.SS2.SSS2.p1.19.m4.3.3.1.1.1.1.1" xref="S3.SS2.SSS2.p1.19.m4.3.3.1.1.1.1.1.cmml">&lt;</mo><mi id="S3.SS2.SSS2.p1.19.m4.3.3.1.1.1.1.3" xref="S3.SS2.SSS2.p1.19.m4.3.3.1.1.1.1.3.cmml">t</mi></mrow><mo id="S3.SS2.SSS2.p1.19.m4.3.3.1.1.1.3" stretchy="false" xref="S3.SS2.SSS2.p1.19.m4.3.3.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S3.SS2.SSS2.p1.19.m4.5.5.4" xref="S3.SS2.SSS2.p1.19.m4.5.5.4.cmml">=</mo><mrow id="S3.SS2.SSS2.p1.19.m4.5.5.3.2" xref="S3.SS2.SSS2.p1.19.m4.5.5.3.3.cmml"><mo id="S3.SS2.SSS2.p1.19.m4.5.5.3.2.3" stretchy="false" xref="S3.SS2.SSS2.p1.19.m4.5.5.3.3.cmml">{</mo><mrow id="S3.SS2.SSS2.p1.19.m4.4.4.2.1.1" xref="S3.SS2.SSS2.p1.19.m4.4.4.2.1.1.cmml"><msubsup id="S3.SS2.SSS2.p1.19.m4.4.4.2.1.1.2" xref="S3.SS2.SSS2.p1.19.m4.4.4.2.1.1.2.cmml"><mi id="S3.SS2.SSS2.p1.19.m4.4.4.2.1.1.2.2.2" xref="S3.SS2.SSS2.p1.19.m4.4.4.2.1.1.2.2.2.cmml">r</mi><mi id="S3.SS2.SSS2.p1.19.m4.4.4.2.1.1.2.2.3" xref="S3.SS2.SSS2.p1.19.m4.4.4.2.1.1.2.2.3.cmml">i</mi><mi id="S3.SS2.SSS2.p1.19.m4.4.4.2.1.1.2.3" xref="S3.SS2.SSS2.p1.19.m4.4.4.2.1.1.2.3.cmml">j</mi></msubsup><mo id="S3.SS2.SSS2.p1.19.m4.4.4.2.1.1.1" xref="S3.SS2.SSS2.p1.19.m4.4.4.2.1.1.1.cmml">⁢</mo><mrow id="S3.SS2.SSS2.p1.19.m4.4.4.2.1.1.3.2" xref="S3.SS2.SSS2.p1.19.m4.4.4.2.1.1.cmml"><mo id="S3.SS2.SSS2.p1.19.m4.4.4.2.1.1.3.2.1" stretchy="false" xref="S3.SS2.SSS2.p1.19.m4.4.4.2.1.1.cmml">(</mo><mn id="S3.SS2.SSS2.p1.19.m4.1.1" xref="S3.SS2.SSS2.p1.19.m4.1.1.cmml">1</mn><mo id="S3.SS2.SSS2.p1.19.m4.4.4.2.1.1.3.2.2" stretchy="false" xref="S3.SS2.SSS2.p1.19.m4.4.4.2.1.1.cmml">)</mo></mrow></mrow><mo id="S3.SS2.SSS2.p1.19.m4.5.5.3.2.4" xref="S3.SS2.SSS2.p1.19.m4.5.5.3.3.cmml">,</mo><mi id="S3.SS2.SSS2.p1.19.m4.2.2" mathvariant="normal" xref="S3.SS2.SSS2.p1.19.m4.2.2.cmml">…</mi><mo id="S3.SS2.SSS2.p1.19.m4.5.5.3.2.5" xref="S3.SS2.SSS2.p1.19.m4.5.5.3.3.cmml">,</mo><mrow id="S3.SS2.SSS2.p1.19.m4.5.5.3.2.2" xref="S3.SS2.SSS2.p1.19.m4.5.5.3.2.2.cmml"><msubsup id="S3.SS2.SSS2.p1.19.m4.5.5.3.2.2.3" xref="S3.SS2.SSS2.p1.19.m4.5.5.3.2.2.3.cmml"><mi id="S3.SS2.SSS2.p1.19.m4.5.5.3.2.2.3.2.2" xref="S3.SS2.SSS2.p1.19.m4.5.5.3.2.2.3.2.2.cmml">r</mi><mi id="S3.SS2.SSS2.p1.19.m4.5.5.3.2.2.3.2.3" xref="S3.SS2.SSS2.p1.19.m4.5.5.3.2.2.3.2.3.cmml">i</mi><mi id="S3.SS2.SSS2.p1.19.m4.5.5.3.2.2.3.3" xref="S3.SS2.SSS2.p1.19.m4.5.5.3.2.2.3.3.cmml">j</mi></msubsup><mo id="S3.SS2.SSS2.p1.19.m4.5.5.3.2.2.2" xref="S3.SS2.SSS2.p1.19.m4.5.5.3.2.2.2.cmml">⁢</mo><mrow id="S3.SS2.SSS2.p1.19.m4.5.5.3.2.2.1.1" xref="S3.SS2.SSS2.p1.19.m4.5.5.3.2.2.1.1.1.cmml"><mo id="S3.SS2.SSS2.p1.19.m4.5.5.3.2.2.1.1.2" stretchy="false" xref="S3.SS2.SSS2.p1.19.m4.5.5.3.2.2.1.1.1.cmml">(</mo><mrow id="S3.SS2.SSS2.p1.19.m4.5.5.3.2.2.1.1.1" xref="S3.SS2.SSS2.p1.19.m4.5.5.3.2.2.1.1.1.cmml"><mi id="S3.SS2.SSS2.p1.19.m4.5.5.3.2.2.1.1.1.2" xref="S3.SS2.SSS2.p1.19.m4.5.5.3.2.2.1.1.1.2.cmml">t</mi><mo id="S3.SS2.SSS2.p1.19.m4.5.5.3.2.2.1.1.1.1" xref="S3.SS2.SSS2.p1.19.m4.5.5.3.2.2.1.1.1.1.cmml">−</mo><mn id="S3.SS2.SSS2.p1.19.m4.5.5.3.2.2.1.1.1.3" xref="S3.SS2.SSS2.p1.19.m4.5.5.3.2.2.1.1.1.3.cmml">1</mn></mrow><mo id="S3.SS2.SSS2.p1.19.m4.5.5.3.2.2.1.1.3" stretchy="false" xref="S3.SS2.SSS2.p1.19.m4.5.5.3.2.2.1.1.1.cmml">)</mo></mrow></mrow><mo id="S3.SS2.SSS2.p1.19.m4.5.5.3.2.6" stretchy="false" xref="S3.SS2.SSS2.p1.19.m4.5.5.3.3.cmml">}</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS2.p1.19.m4.5b"><apply id="S3.SS2.SSS2.p1.19.m4.5.5.cmml" xref="S3.SS2.SSS2.p1.19.m4.5.5"><eq id="S3.SS2.SSS2.p1.19.m4.5.5.4.cmml" xref="S3.SS2.SSS2.p1.19.m4.5.5.4"></eq><apply id="S3.SS2.SSS2.p1.19.m4.3.3.1.cmml" xref="S3.SS2.SSS2.p1.19.m4.3.3.1"><csymbol cd="latexml" id="S3.SS2.SSS2.p1.19.m4.3.3.1.2.cmml" xref="S3.SS2.SSS2.p1.19.m4.3.3.1">annotated</csymbol><apply id="S3.SS2.SSS2.p1.19.m4.3.3.1.3.cmml" xref="S3.SS2.SSS2.p1.19.m4.3.3.1.3"><csymbol cd="ambiguous" id="S3.SS2.SSS2.p1.19.m4.3.3.1.3.1.cmml" xref="S3.SS2.SSS2.p1.19.m4.3.3.1.3">superscript</csymbol><apply id="S3.SS2.SSS2.p1.19.m4.3.3.1.3.2.cmml" xref="S3.SS2.SSS2.p1.19.m4.3.3.1.3"><csymbol cd="ambiguous" id="S3.SS2.SSS2.p1.19.m4.3.3.1.3.2.1.cmml" xref="S3.SS2.SSS2.p1.19.m4.3.3.1.3">subscript</csymbol><ci id="S3.SS2.SSS2.p1.19.m4.3.3.1.3.2.2.cmml" xref="S3.SS2.SSS2.p1.19.m4.3.3.1.3.2.2">𝑟</ci><ci id="S3.SS2.SSS2.p1.19.m4.3.3.1.3.2.3.cmml" xref="S3.SS2.SSS2.p1.19.m4.3.3.1.3.2.3">𝑖</ci></apply><ci id="S3.SS2.SSS2.p1.19.m4.3.3.1.3.3.cmml" xref="S3.SS2.SSS2.p1.19.m4.3.3.1.3.3">𝑗</ci></apply><apply id="S3.SS2.SSS2.p1.19.m4.3.3.1.1.1.1.cmml" xref="S3.SS2.SSS2.p1.19.m4.3.3.1.1.1"><lt id="S3.SS2.SSS2.p1.19.m4.3.3.1.1.1.1.1.cmml" xref="S3.SS2.SSS2.p1.19.m4.3.3.1.1.1.1.1"></lt><csymbol cd="latexml" id="S3.SS2.SSS2.p1.19.m4.3.3.1.1.1.1.2.cmml" xref="S3.SS2.SSS2.p1.19.m4.3.3.1.1.1.1.2">absent</csymbol><ci id="S3.SS2.SSS2.p1.19.m4.3.3.1.1.1.1.3.cmml" xref="S3.SS2.SSS2.p1.19.m4.3.3.1.1.1.1.3">𝑡</ci></apply></apply><set id="S3.SS2.SSS2.p1.19.m4.5.5.3.3.cmml" xref="S3.SS2.SSS2.p1.19.m4.5.5.3.2"><apply id="S3.SS2.SSS2.p1.19.m4.4.4.2.1.1.cmml" xref="S3.SS2.SSS2.p1.19.m4.4.4.2.1.1"><times id="S3.SS2.SSS2.p1.19.m4.4.4.2.1.1.1.cmml" xref="S3.SS2.SSS2.p1.19.m4.4.4.2.1.1.1"></times><apply id="S3.SS2.SSS2.p1.19.m4.4.4.2.1.1.2.cmml" xref="S3.SS2.SSS2.p1.19.m4.4.4.2.1.1.2"><csymbol cd="ambiguous" id="S3.SS2.SSS2.p1.19.m4.4.4.2.1.1.2.1.cmml" xref="S3.SS2.SSS2.p1.19.m4.4.4.2.1.1.2">superscript</csymbol><apply id="S3.SS2.SSS2.p1.19.m4.4.4.2.1.1.2.2.cmml" xref="S3.SS2.SSS2.p1.19.m4.4.4.2.1.1.2"><csymbol cd="ambiguous" id="S3.SS2.SSS2.p1.19.m4.4.4.2.1.1.2.2.1.cmml" xref="S3.SS2.SSS2.p1.19.m4.4.4.2.1.1.2">subscript</csymbol><ci id="S3.SS2.SSS2.p1.19.m4.4.4.2.1.1.2.2.2.cmml" xref="S3.SS2.SSS2.p1.19.m4.4.4.2.1.1.2.2.2">𝑟</ci><ci id="S3.SS2.SSS2.p1.19.m4.4.4.2.1.1.2.2.3.cmml" xref="S3.SS2.SSS2.p1.19.m4.4.4.2.1.1.2.2.3">𝑖</ci></apply><ci id="S3.SS2.SSS2.p1.19.m4.4.4.2.1.1.2.3.cmml" xref="S3.SS2.SSS2.p1.19.m4.4.4.2.1.1.2.3">𝑗</ci></apply><cn id="S3.SS2.SSS2.p1.19.m4.1.1.cmml" type="integer" xref="S3.SS2.SSS2.p1.19.m4.1.1">1</cn></apply><ci id="S3.SS2.SSS2.p1.19.m4.2.2.cmml" xref="S3.SS2.SSS2.p1.19.m4.2.2">…</ci><apply id="S3.SS2.SSS2.p1.19.m4.5.5.3.2.2.cmml" xref="S3.SS2.SSS2.p1.19.m4.5.5.3.2.2"><times id="S3.SS2.SSS2.p1.19.m4.5.5.3.2.2.2.cmml" xref="S3.SS2.SSS2.p1.19.m4.5.5.3.2.2.2"></times><apply id="S3.SS2.SSS2.p1.19.m4.5.5.3.2.2.3.cmml" xref="S3.SS2.SSS2.p1.19.m4.5.5.3.2.2.3"><csymbol cd="ambiguous" id="S3.SS2.SSS2.p1.19.m4.5.5.3.2.2.3.1.cmml" xref="S3.SS2.SSS2.p1.19.m4.5.5.3.2.2.3">superscript</csymbol><apply id="S3.SS2.SSS2.p1.19.m4.5.5.3.2.2.3.2.cmml" xref="S3.SS2.SSS2.p1.19.m4.5.5.3.2.2.3"><csymbol cd="ambiguous" id="S3.SS2.SSS2.p1.19.m4.5.5.3.2.2.3.2.1.cmml" xref="S3.SS2.SSS2.p1.19.m4.5.5.3.2.2.3">subscript</csymbol><ci id="S3.SS2.SSS2.p1.19.m4.5.5.3.2.2.3.2.2.cmml" xref="S3.SS2.SSS2.p1.19.m4.5.5.3.2.2.3.2.2">𝑟</ci><ci id="S3.SS2.SSS2.p1.19.m4.5.5.3.2.2.3.2.3.cmml" xref="S3.SS2.SSS2.p1.19.m4.5.5.3.2.2.3.2.3">𝑖</ci></apply><ci id="S3.SS2.SSS2.p1.19.m4.5.5.3.2.2.3.3.cmml" xref="S3.SS2.SSS2.p1.19.m4.5.5.3.2.2.3.3">𝑗</ci></apply><apply id="S3.SS2.SSS2.p1.19.m4.5.5.3.2.2.1.1.1.cmml" xref="S3.SS2.SSS2.p1.19.m4.5.5.3.2.2.1.1"><minus id="S3.SS2.SSS2.p1.19.m4.5.5.3.2.2.1.1.1.1.cmml" xref="S3.SS2.SSS2.p1.19.m4.5.5.3.2.2.1.1.1.1"></minus><ci id="S3.SS2.SSS2.p1.19.m4.5.5.3.2.2.1.1.1.2.cmml" xref="S3.SS2.SSS2.p1.19.m4.5.5.3.2.2.1.1.1.2">𝑡</ci><cn id="S3.SS2.SSS2.p1.19.m4.5.5.3.2.2.1.1.1.3.cmml" type="integer" xref="S3.SS2.SSS2.p1.19.m4.5.5.3.2.2.1.1.1.3">1</cn></apply></apply></set></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS2.p1.19.m4.5c">r_{i}^{j}(&lt;t)=\{r_{i}^{j}(1),...,r_{i}^{j}(t-1)\}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS2.p1.19.m4.5d">italic_r start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_j end_POSTSUPERSCRIPT ( &lt; italic_t ) = { italic_r start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_j end_POSTSUPERSCRIPT ( 1 ) , … , italic_r start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_j end_POSTSUPERSCRIPT ( italic_t - 1 ) }</annotation></semantics></math> in the sequence. <math alttext="\theta_{1}" class="ltx_Math" display="inline" id="S3.SS2.SSS2.p1.20.m5.1"><semantics id="S3.SS2.SSS2.p1.20.m5.1a"><msub id="S3.SS2.SSS2.p1.20.m5.1.1" xref="S3.SS2.SSS2.p1.20.m5.1.1.cmml"><mi id="S3.SS2.SSS2.p1.20.m5.1.1.2" xref="S3.SS2.SSS2.p1.20.m5.1.1.2.cmml">θ</mi><mn id="S3.SS2.SSS2.p1.20.m5.1.1.3" xref="S3.SS2.SSS2.p1.20.m5.1.1.3.cmml">1</mn></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS2.p1.20.m5.1b"><apply id="S3.SS2.SSS2.p1.20.m5.1.1.cmml" xref="S3.SS2.SSS2.p1.20.m5.1.1"><csymbol cd="ambiguous" id="S3.SS2.SSS2.p1.20.m5.1.1.1.cmml" xref="S3.SS2.SSS2.p1.20.m5.1.1">subscript</csymbol><ci id="S3.SS2.SSS2.p1.20.m5.1.1.2.cmml" xref="S3.SS2.SSS2.p1.20.m5.1.1.2">𝜃</ci><cn id="S3.SS2.SSS2.p1.20.m5.1.1.3.cmml" type="integer" xref="S3.SS2.SSS2.p1.20.m5.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS2.p1.20.m5.1c">\theta_{1}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS2.p1.20.m5.1d">italic_θ start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT</annotation></semantics></math> indicates model parameters.
By summing over the entire dataset <math alttext="\mathcal{D}" class="ltx_Math" display="inline" id="S3.SS2.SSS2.p1.21.m6.1"><semantics id="S3.SS2.SSS2.p1.21.m6.1a"><mi class="ltx_font_mathcaligraphic" id="S3.SS2.SSS2.p1.21.m6.1.1" xref="S3.SS2.SSS2.p1.21.m6.1.1.cmml">𝒟</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS2.p1.21.m6.1b"><ci id="S3.SS2.SSS2.p1.21.m6.1.1.cmml" xref="S3.SS2.SSS2.p1.21.m6.1.1">𝒟</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS2.p1.21.m6.1c">\mathcal{D}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS2.p1.21.m6.1d">caligraphic_D</annotation></semantics></math>, the overall loss function <math alttext="\mathcal{L}_{1}(\theta_{1};\mathcal{D})" class="ltx_Math" display="inline" id="S3.SS2.SSS2.p1.22.m7.2"><semantics id="S3.SS2.SSS2.p1.22.m7.2a"><mrow id="S3.SS2.SSS2.p1.22.m7.2.2" xref="S3.SS2.SSS2.p1.22.m7.2.2.cmml"><msub id="S3.SS2.SSS2.p1.22.m7.2.2.3" xref="S3.SS2.SSS2.p1.22.m7.2.2.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS2.SSS2.p1.22.m7.2.2.3.2" xref="S3.SS2.SSS2.p1.22.m7.2.2.3.2.cmml">ℒ</mi><mn id="S3.SS2.SSS2.p1.22.m7.2.2.3.3" xref="S3.SS2.SSS2.p1.22.m7.2.2.3.3.cmml">1</mn></msub><mo id="S3.SS2.SSS2.p1.22.m7.2.2.2" xref="S3.SS2.SSS2.p1.22.m7.2.2.2.cmml">⁢</mo><mrow id="S3.SS2.SSS2.p1.22.m7.2.2.1.1" xref="S3.SS2.SSS2.p1.22.m7.2.2.1.2.cmml"><mo id="S3.SS2.SSS2.p1.22.m7.2.2.1.1.2" stretchy="false" xref="S3.SS2.SSS2.p1.22.m7.2.2.1.2.cmml">(</mo><msub id="S3.SS2.SSS2.p1.22.m7.2.2.1.1.1" xref="S3.SS2.SSS2.p1.22.m7.2.2.1.1.1.cmml"><mi id="S3.SS2.SSS2.p1.22.m7.2.2.1.1.1.2" xref="S3.SS2.SSS2.p1.22.m7.2.2.1.1.1.2.cmml">θ</mi><mn id="S3.SS2.SSS2.p1.22.m7.2.2.1.1.1.3" xref="S3.SS2.SSS2.p1.22.m7.2.2.1.1.1.3.cmml">1</mn></msub><mo id="S3.SS2.SSS2.p1.22.m7.2.2.1.1.3" xref="S3.SS2.SSS2.p1.22.m7.2.2.1.2.cmml">;</mo><mi class="ltx_font_mathcaligraphic" id="S3.SS2.SSS2.p1.22.m7.1.1" xref="S3.SS2.SSS2.p1.22.m7.1.1.cmml">𝒟</mi><mo id="S3.SS2.SSS2.p1.22.m7.2.2.1.1.4" stretchy="false" xref="S3.SS2.SSS2.p1.22.m7.2.2.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS2.p1.22.m7.2b"><apply id="S3.SS2.SSS2.p1.22.m7.2.2.cmml" xref="S3.SS2.SSS2.p1.22.m7.2.2"><times id="S3.SS2.SSS2.p1.22.m7.2.2.2.cmml" xref="S3.SS2.SSS2.p1.22.m7.2.2.2"></times><apply id="S3.SS2.SSS2.p1.22.m7.2.2.3.cmml" xref="S3.SS2.SSS2.p1.22.m7.2.2.3"><csymbol cd="ambiguous" id="S3.SS2.SSS2.p1.22.m7.2.2.3.1.cmml" xref="S3.SS2.SSS2.p1.22.m7.2.2.3">subscript</csymbol><ci id="S3.SS2.SSS2.p1.22.m7.2.2.3.2.cmml" xref="S3.SS2.SSS2.p1.22.m7.2.2.3.2">ℒ</ci><cn id="S3.SS2.SSS2.p1.22.m7.2.2.3.3.cmml" type="integer" xref="S3.SS2.SSS2.p1.22.m7.2.2.3.3">1</cn></apply><list id="S3.SS2.SSS2.p1.22.m7.2.2.1.2.cmml" xref="S3.SS2.SSS2.p1.22.m7.2.2.1.1"><apply id="S3.SS2.SSS2.p1.22.m7.2.2.1.1.1.cmml" xref="S3.SS2.SSS2.p1.22.m7.2.2.1.1.1"><csymbol cd="ambiguous" id="S3.SS2.SSS2.p1.22.m7.2.2.1.1.1.1.cmml" xref="S3.SS2.SSS2.p1.22.m7.2.2.1.1.1">subscript</csymbol><ci id="S3.SS2.SSS2.p1.22.m7.2.2.1.1.1.2.cmml" xref="S3.SS2.SSS2.p1.22.m7.2.2.1.1.1.2">𝜃</ci><cn id="S3.SS2.SSS2.p1.22.m7.2.2.1.1.1.3.cmml" type="integer" xref="S3.SS2.SSS2.p1.22.m7.2.2.1.1.1.3">1</cn></apply><ci id="S3.SS2.SSS2.p1.22.m7.1.1.cmml" xref="S3.SS2.SSS2.p1.22.m7.1.1">𝒟</ci></list></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS2.p1.22.m7.2c">\mathcal{L}_{1}(\theta_{1};\mathcal{D})</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS2.p1.22.m7.2d">caligraphic_L start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT ( italic_θ start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT ; caligraphic_D )</annotation></semantics></math> is given by:</p>
<table class="ltx_equation ltx_eqn_table" id="S3.E4">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_left" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_left">(4)</span></td>
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\mathcal{L}_{1}(\theta_{1};\mathcal{D})=\sum_{i=1}^{I}\sum_{j=1}^{J}\left[-%
\sum_{t=1}^{T_{i}^{j}}\log P\left(r_{i}^{j}(t)\mid u_{i}^{j},r_{i}^{j}(&lt;t);%
\theta_{1}\right)\right]" class="ltx_Math" display="block" id="S3.E4.m1.4"><semantics id="S3.E4.m1.4a"><mrow id="S3.E4.m1.4.4" xref="S3.E4.m1.4.4.cmml"><mrow id="S3.E4.m1.3.3.1" xref="S3.E4.m1.3.3.1.cmml"><msub id="S3.E4.m1.3.3.1.3" xref="S3.E4.m1.3.3.1.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.E4.m1.3.3.1.3.2" xref="S3.E4.m1.3.3.1.3.2.cmml">ℒ</mi><mn id="S3.E4.m1.3.3.1.3.3" xref="S3.E4.m1.3.3.1.3.3.cmml">1</mn></msub><mo id="S3.E4.m1.3.3.1.2" xref="S3.E4.m1.3.3.1.2.cmml">⁢</mo><mrow id="S3.E4.m1.3.3.1.1.1" xref="S3.E4.m1.3.3.1.1.2.cmml"><mo id="S3.E4.m1.3.3.1.1.1.2" stretchy="false" xref="S3.E4.m1.3.3.1.1.2.cmml">(</mo><msub id="S3.E4.m1.3.3.1.1.1.1" xref="S3.E4.m1.3.3.1.1.1.1.cmml"><mi id="S3.E4.m1.3.3.1.1.1.1.2" xref="S3.E4.m1.3.3.1.1.1.1.2.cmml">θ</mi><mn id="S3.E4.m1.3.3.1.1.1.1.3" xref="S3.E4.m1.3.3.1.1.1.1.3.cmml">1</mn></msub><mo id="S3.E4.m1.3.3.1.1.1.3" xref="S3.E4.m1.3.3.1.1.2.cmml">;</mo><mi class="ltx_font_mathcaligraphic" id="S3.E4.m1.1.1" xref="S3.E4.m1.1.1.cmml">𝒟</mi><mo id="S3.E4.m1.3.3.1.1.1.4" stretchy="false" xref="S3.E4.m1.3.3.1.1.2.cmml">)</mo></mrow></mrow><mo id="S3.E4.m1.4.4.3" rspace="0.111em" xref="S3.E4.m1.4.4.3.cmml">=</mo><mrow id="S3.E4.m1.4.4.2" xref="S3.E4.m1.4.4.2.cmml"><munderover id="S3.E4.m1.4.4.2.2" xref="S3.E4.m1.4.4.2.2.cmml"><mo id="S3.E4.m1.4.4.2.2.2.2" movablelimits="false" rspace="0em" xref="S3.E4.m1.4.4.2.2.2.2.cmml">∑</mo><mrow id="S3.E4.m1.4.4.2.2.2.3" xref="S3.E4.m1.4.4.2.2.2.3.cmml"><mi id="S3.E4.m1.4.4.2.2.2.3.2" xref="S3.E4.m1.4.4.2.2.2.3.2.cmml">i</mi><mo id="S3.E4.m1.4.4.2.2.2.3.1" xref="S3.E4.m1.4.4.2.2.2.3.1.cmml">=</mo><mn id="S3.E4.m1.4.4.2.2.2.3.3" xref="S3.E4.m1.4.4.2.2.2.3.3.cmml">1</mn></mrow><mi id="S3.E4.m1.4.4.2.2.3" xref="S3.E4.m1.4.4.2.2.3.cmml">I</mi></munderover><mrow id="S3.E4.m1.4.4.2.1" xref="S3.E4.m1.4.4.2.1.cmml"><munderover id="S3.E4.m1.4.4.2.1.2" xref="S3.E4.m1.4.4.2.1.2.cmml"><mo id="S3.E4.m1.4.4.2.1.2.2.2" movablelimits="false" rspace="0em" xref="S3.E4.m1.4.4.2.1.2.2.2.cmml">∑</mo><mrow id="S3.E4.m1.4.4.2.1.2.2.3" xref="S3.E4.m1.4.4.2.1.2.2.3.cmml"><mi id="S3.E4.m1.4.4.2.1.2.2.3.2" xref="S3.E4.m1.4.4.2.1.2.2.3.2.cmml">j</mi><mo id="S3.E4.m1.4.4.2.1.2.2.3.1" xref="S3.E4.m1.4.4.2.1.2.2.3.1.cmml">=</mo><mn id="S3.E4.m1.4.4.2.1.2.2.3.3" xref="S3.E4.m1.4.4.2.1.2.2.3.3.cmml">1</mn></mrow><mi id="S3.E4.m1.4.4.2.1.2.3" xref="S3.E4.m1.4.4.2.1.2.3.cmml">J</mi></munderover><mrow id="S3.E4.m1.4.4.2.1.1.1" xref="S3.E4.m1.4.4.2.1.1.2.cmml"><mo id="S3.E4.m1.4.4.2.1.1.1.2" xref="S3.E4.m1.4.4.2.1.1.2.1.cmml">[</mo><mrow id="S3.E4.m1.4.4.2.1.1.1.1" xref="S3.E4.m1.4.4.2.1.1.1.1.cmml"><mo id="S3.E4.m1.4.4.2.1.1.1.1a" xref="S3.E4.m1.4.4.2.1.1.1.1.cmml">−</mo><mrow id="S3.E4.m1.4.4.2.1.1.1.1.1" xref="S3.E4.m1.4.4.2.1.1.1.1.1.cmml"><munderover id="S3.E4.m1.4.4.2.1.1.1.1.1.2" xref="S3.E4.m1.4.4.2.1.1.1.1.1.2.cmml"><mo id="S3.E4.m1.4.4.2.1.1.1.1.1.2.2.2" movablelimits="false" xref="S3.E4.m1.4.4.2.1.1.1.1.1.2.2.2.cmml">∑</mo><mrow id="S3.E4.m1.4.4.2.1.1.1.1.1.2.2.3" xref="S3.E4.m1.4.4.2.1.1.1.1.1.2.2.3.cmml"><mi id="S3.E4.m1.4.4.2.1.1.1.1.1.2.2.3.2" xref="S3.E4.m1.4.4.2.1.1.1.1.1.2.2.3.2.cmml">t</mi><mo id="S3.E4.m1.4.4.2.1.1.1.1.1.2.2.3.1" xref="S3.E4.m1.4.4.2.1.1.1.1.1.2.2.3.1.cmml">=</mo><mn id="S3.E4.m1.4.4.2.1.1.1.1.1.2.2.3.3" xref="S3.E4.m1.4.4.2.1.1.1.1.1.2.2.3.3.cmml">1</mn></mrow><msubsup id="S3.E4.m1.4.4.2.1.1.1.1.1.2.3" xref="S3.E4.m1.4.4.2.1.1.1.1.1.2.3.cmml"><mi id="S3.E4.m1.4.4.2.1.1.1.1.1.2.3.2.2" xref="S3.E4.m1.4.4.2.1.1.1.1.1.2.3.2.2.cmml">T</mi><mi id="S3.E4.m1.4.4.2.1.1.1.1.1.2.3.2.3" xref="S3.E4.m1.4.4.2.1.1.1.1.1.2.3.2.3.cmml">i</mi><mi id="S3.E4.m1.4.4.2.1.1.1.1.1.2.3.3" xref="S3.E4.m1.4.4.2.1.1.1.1.1.2.3.3.cmml">j</mi></msubsup></munderover><mrow id="S3.E4.m1.4.4.2.1.1.1.1.1.1" xref="S3.E4.m1.4.4.2.1.1.1.1.1.1.cmml"><mrow id="S3.E4.m1.4.4.2.1.1.1.1.1.1.3" xref="S3.E4.m1.4.4.2.1.1.1.1.1.1.3.cmml"><mi id="S3.E4.m1.4.4.2.1.1.1.1.1.1.3.1" xref="S3.E4.m1.4.4.2.1.1.1.1.1.1.3.1.cmml">log</mi><mo id="S3.E4.m1.4.4.2.1.1.1.1.1.1.3a" lspace="0.167em" xref="S3.E4.m1.4.4.2.1.1.1.1.1.1.3.cmml">⁡</mo><mi id="S3.E4.m1.4.4.2.1.1.1.1.1.1.3.2" xref="S3.E4.m1.4.4.2.1.1.1.1.1.1.3.2.cmml">P</mi></mrow><mo id="S3.E4.m1.4.4.2.1.1.1.1.1.1.2" xref="S3.E4.m1.4.4.2.1.1.1.1.1.1.2.cmml">⁢</mo><mrow id="S3.E4.m1.4.4.2.1.1.1.1.1.1.1.1" xref="S3.E4.m1.4.4.2.1.1.1.1.1.1.1.1.1.cmml"><mo id="S3.E4.m1.4.4.2.1.1.1.1.1.1.1.1.2" xref="S3.E4.m1.4.4.2.1.1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="S3.E4.m1.4.4.2.1.1.1.1.1.1.1.1.1" xref="S3.E4.m1.4.4.2.1.1.1.1.1.1.1.1.1.cmml"><mrow id="S3.E4.m1.4.4.2.1.1.1.1.1.1.1.1.1.5" xref="S3.E4.m1.4.4.2.1.1.1.1.1.1.1.1.1.5.cmml"><msubsup id="S3.E4.m1.4.4.2.1.1.1.1.1.1.1.1.1.5.2" xref="S3.E4.m1.4.4.2.1.1.1.1.1.1.1.1.1.5.2.cmml"><mi id="S3.E4.m1.4.4.2.1.1.1.1.1.1.1.1.1.5.2.2.2" xref="S3.E4.m1.4.4.2.1.1.1.1.1.1.1.1.1.5.2.2.2.cmml">r</mi><mi id="S3.E4.m1.4.4.2.1.1.1.1.1.1.1.1.1.5.2.2.3" xref="S3.E4.m1.4.4.2.1.1.1.1.1.1.1.1.1.5.2.2.3.cmml">i</mi><mi id="S3.E4.m1.4.4.2.1.1.1.1.1.1.1.1.1.5.2.3" xref="S3.E4.m1.4.4.2.1.1.1.1.1.1.1.1.1.5.2.3.cmml">j</mi></msubsup><mo id="S3.E4.m1.4.4.2.1.1.1.1.1.1.1.1.1.5.1" xref="S3.E4.m1.4.4.2.1.1.1.1.1.1.1.1.1.5.1.cmml">⁢</mo><mrow id="S3.E4.m1.4.4.2.1.1.1.1.1.1.1.1.1.5.3.2" xref="S3.E4.m1.4.4.2.1.1.1.1.1.1.1.1.1.5.cmml"><mo id="S3.E4.m1.4.4.2.1.1.1.1.1.1.1.1.1.5.3.2.1" stretchy="false" xref="S3.E4.m1.4.4.2.1.1.1.1.1.1.1.1.1.5.cmml">(</mo><mi id="S3.E4.m1.2.2" xref="S3.E4.m1.2.2.cmml">t</mi><mo id="S3.E4.m1.4.4.2.1.1.1.1.1.1.1.1.1.5.3.2.2" stretchy="false" xref="S3.E4.m1.4.4.2.1.1.1.1.1.1.1.1.1.5.cmml">)</mo></mrow></mrow><mo id="S3.E4.m1.4.4.2.1.1.1.1.1.1.1.1.1.4" xref="S3.E4.m1.4.4.2.1.1.1.1.1.1.1.1.1.4.cmml">∣</mo><mrow id="S3.E4.m1.4.4.2.1.1.1.1.1.1.1.1.1.3.3" xref="S3.E4.m1.4.4.2.1.1.1.1.1.1.1.1.1.3.4.cmml"><msubsup id="S3.E4.m1.4.4.2.1.1.1.1.1.1.1.1.1.1.1.1" xref="S3.E4.m1.4.4.2.1.1.1.1.1.1.1.1.1.1.1.1.cmml"><mi id="S3.E4.m1.4.4.2.1.1.1.1.1.1.1.1.1.1.1.1.2.2" xref="S3.E4.m1.4.4.2.1.1.1.1.1.1.1.1.1.1.1.1.2.2.cmml">u</mi><mi id="S3.E4.m1.4.4.2.1.1.1.1.1.1.1.1.1.1.1.1.2.3" xref="S3.E4.m1.4.4.2.1.1.1.1.1.1.1.1.1.1.1.1.2.3.cmml">i</mi><mi id="S3.E4.m1.4.4.2.1.1.1.1.1.1.1.1.1.1.1.1.3" xref="S3.E4.m1.4.4.2.1.1.1.1.1.1.1.1.1.1.1.1.3.cmml">j</mi></msubsup><mo id="S3.E4.m1.4.4.2.1.1.1.1.1.1.1.1.1.3.3.4" xref="S3.E4.m1.4.4.2.1.1.1.1.1.1.1.1.1.3.4.cmml">,</mo><mrow id="S3.E4.m1.4.4.2.1.1.1.1.1.1.1.1.1.2.2.2" xref="S3.E4.m1.4.4.2.1.1.1.1.1.1.1.1.1.2.2.2.cmml"><msubsup id="S3.E4.m1.4.4.2.1.1.1.1.1.1.1.1.1.2.2.2.3" xref="S3.E4.m1.4.4.2.1.1.1.1.1.1.1.1.1.2.2.2.3.cmml"><mi id="S3.E4.m1.4.4.2.1.1.1.1.1.1.1.1.1.2.2.2.3.2.2" xref="S3.E4.m1.4.4.2.1.1.1.1.1.1.1.1.1.2.2.2.3.2.2.cmml">r</mi><mi id="S3.E4.m1.4.4.2.1.1.1.1.1.1.1.1.1.2.2.2.3.2.3" xref="S3.E4.m1.4.4.2.1.1.1.1.1.1.1.1.1.2.2.2.3.2.3.cmml">i</mi><mi id="S3.E4.m1.4.4.2.1.1.1.1.1.1.1.1.1.2.2.2.3.3" xref="S3.E4.m1.4.4.2.1.1.1.1.1.1.1.1.1.2.2.2.3.3.cmml">j</mi></msubsup><mspace id="S3.E4.m1.4.4.2.1.1.1.1.1.1.1.1.1.2.2.2a" width="0.3888888888888889em" xref="S3.E4.m1.4.4.2.1.1.1.1.1.1.1.1.1.2.2.2.cmml"></mspace><mrow id="S3.E4.m1.4.4.2.1.1.1.1.1.1.1.1.1.2.2.2.1.1" xref="S3.E4.m1.4.4.2.1.1.1.1.1.1.1.1.1.2.2.2.1.1.1.cmml"><mo id="S3.E4.m1.4.4.2.1.1.1.1.1.1.1.1.1.2.2.2.1.1.2" stretchy="false" xref="S3.E4.m1.4.4.2.1.1.1.1.1.1.1.1.1.2.2.2.1.1.1.cmml">(</mo><mrow id="S3.E4.m1.4.4.2.1.1.1.1.1.1.1.1.1.2.2.2.1.1.1" xref="S3.E4.m1.4.4.2.1.1.1.1.1.1.1.1.1.2.2.2.1.1.1.cmml"><mi id="S3.E4.m1.4.4.2.1.1.1.1.1.1.1.1.1.2.2.2.1.1.1.2" xref="S3.E4.m1.4.4.2.1.1.1.1.1.1.1.1.1.2.2.2.1.1.1.2.cmml"></mi><mo id="S3.E4.m1.4.4.2.1.1.1.1.1.1.1.1.1.2.2.2.1.1.1.1" xref="S3.E4.m1.4.4.2.1.1.1.1.1.1.1.1.1.2.2.2.1.1.1.1.cmml">&lt;</mo><mi id="S3.E4.m1.4.4.2.1.1.1.1.1.1.1.1.1.2.2.2.1.1.1.3" xref="S3.E4.m1.4.4.2.1.1.1.1.1.1.1.1.1.2.2.2.1.1.1.3.cmml">t</mi></mrow><mo id="S3.E4.m1.4.4.2.1.1.1.1.1.1.1.1.1.2.2.2.1.1.3" stretchy="false" xref="S3.E4.m1.4.4.2.1.1.1.1.1.1.1.1.1.2.2.2.1.1.1.cmml">)</mo></mrow></mrow><mo id="S3.E4.m1.4.4.2.1.1.1.1.1.1.1.1.1.3.3.5" xref="S3.E4.m1.4.4.2.1.1.1.1.1.1.1.1.1.3.4.cmml">;</mo><msub id="S3.E4.m1.4.4.2.1.1.1.1.1.1.1.1.1.3.3.3" xref="S3.E4.m1.4.4.2.1.1.1.1.1.1.1.1.1.3.3.3.cmml"><mi id="S3.E4.m1.4.4.2.1.1.1.1.1.1.1.1.1.3.3.3.2" xref="S3.E4.m1.4.4.2.1.1.1.1.1.1.1.1.1.3.3.3.2.cmml">θ</mi><mn id="S3.E4.m1.4.4.2.1.1.1.1.1.1.1.1.1.3.3.3.3" xref="S3.E4.m1.4.4.2.1.1.1.1.1.1.1.1.1.3.3.3.3.cmml">1</mn></msub></mrow></mrow><mo id="S3.E4.m1.4.4.2.1.1.1.1.1.1.1.1.3" xref="S3.E4.m1.4.4.2.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow></mrow><mo id="S3.E4.m1.4.4.2.1.1.1.3" xref="S3.E4.m1.4.4.2.1.1.2.1.cmml">]</mo></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.E4.m1.4b"><apply id="S3.E4.m1.4.4.cmml" xref="S3.E4.m1.4.4"><eq id="S3.E4.m1.4.4.3.cmml" xref="S3.E4.m1.4.4.3"></eq><apply id="S3.E4.m1.3.3.1.cmml" xref="S3.E4.m1.3.3.1"><times id="S3.E4.m1.3.3.1.2.cmml" xref="S3.E4.m1.3.3.1.2"></times><apply id="S3.E4.m1.3.3.1.3.cmml" xref="S3.E4.m1.3.3.1.3"><csymbol cd="ambiguous" id="S3.E4.m1.3.3.1.3.1.cmml" xref="S3.E4.m1.3.3.1.3">subscript</csymbol><ci id="S3.E4.m1.3.3.1.3.2.cmml" xref="S3.E4.m1.3.3.1.3.2">ℒ</ci><cn id="S3.E4.m1.3.3.1.3.3.cmml" type="integer" xref="S3.E4.m1.3.3.1.3.3">1</cn></apply><list id="S3.E4.m1.3.3.1.1.2.cmml" xref="S3.E4.m1.3.3.1.1.1"><apply id="S3.E4.m1.3.3.1.1.1.1.cmml" xref="S3.E4.m1.3.3.1.1.1.1"><csymbol cd="ambiguous" id="S3.E4.m1.3.3.1.1.1.1.1.cmml" xref="S3.E4.m1.3.3.1.1.1.1">subscript</csymbol><ci id="S3.E4.m1.3.3.1.1.1.1.2.cmml" xref="S3.E4.m1.3.3.1.1.1.1.2">𝜃</ci><cn id="S3.E4.m1.3.3.1.1.1.1.3.cmml" type="integer" xref="S3.E4.m1.3.3.1.1.1.1.3">1</cn></apply><ci id="S3.E4.m1.1.1.cmml" xref="S3.E4.m1.1.1">𝒟</ci></list></apply><apply id="S3.E4.m1.4.4.2.cmml" xref="S3.E4.m1.4.4.2"><apply id="S3.E4.m1.4.4.2.2.cmml" xref="S3.E4.m1.4.4.2.2"><csymbol cd="ambiguous" id="S3.E4.m1.4.4.2.2.1.cmml" xref="S3.E4.m1.4.4.2.2">superscript</csymbol><apply id="S3.E4.m1.4.4.2.2.2.cmml" xref="S3.E4.m1.4.4.2.2"><csymbol cd="ambiguous" id="S3.E4.m1.4.4.2.2.2.1.cmml" xref="S3.E4.m1.4.4.2.2">subscript</csymbol><sum id="S3.E4.m1.4.4.2.2.2.2.cmml" xref="S3.E4.m1.4.4.2.2.2.2"></sum><apply id="S3.E4.m1.4.4.2.2.2.3.cmml" xref="S3.E4.m1.4.4.2.2.2.3"><eq id="S3.E4.m1.4.4.2.2.2.3.1.cmml" xref="S3.E4.m1.4.4.2.2.2.3.1"></eq><ci id="S3.E4.m1.4.4.2.2.2.3.2.cmml" xref="S3.E4.m1.4.4.2.2.2.3.2">𝑖</ci><cn id="S3.E4.m1.4.4.2.2.2.3.3.cmml" type="integer" xref="S3.E4.m1.4.4.2.2.2.3.3">1</cn></apply></apply><ci id="S3.E4.m1.4.4.2.2.3.cmml" xref="S3.E4.m1.4.4.2.2.3">𝐼</ci></apply><apply id="S3.E4.m1.4.4.2.1.cmml" xref="S3.E4.m1.4.4.2.1"><apply id="S3.E4.m1.4.4.2.1.2.cmml" xref="S3.E4.m1.4.4.2.1.2"><csymbol cd="ambiguous" id="S3.E4.m1.4.4.2.1.2.1.cmml" xref="S3.E4.m1.4.4.2.1.2">superscript</csymbol><apply id="S3.E4.m1.4.4.2.1.2.2.cmml" xref="S3.E4.m1.4.4.2.1.2"><csymbol cd="ambiguous" id="S3.E4.m1.4.4.2.1.2.2.1.cmml" xref="S3.E4.m1.4.4.2.1.2">subscript</csymbol><sum id="S3.E4.m1.4.4.2.1.2.2.2.cmml" xref="S3.E4.m1.4.4.2.1.2.2.2"></sum><apply id="S3.E4.m1.4.4.2.1.2.2.3.cmml" xref="S3.E4.m1.4.4.2.1.2.2.3"><eq id="S3.E4.m1.4.4.2.1.2.2.3.1.cmml" xref="S3.E4.m1.4.4.2.1.2.2.3.1"></eq><ci id="S3.E4.m1.4.4.2.1.2.2.3.2.cmml" xref="S3.E4.m1.4.4.2.1.2.2.3.2">𝑗</ci><cn id="S3.E4.m1.4.4.2.1.2.2.3.3.cmml" type="integer" xref="S3.E4.m1.4.4.2.1.2.2.3.3">1</cn></apply></apply><ci id="S3.E4.m1.4.4.2.1.2.3.cmml" xref="S3.E4.m1.4.4.2.1.2.3">𝐽</ci></apply><apply id="S3.E4.m1.4.4.2.1.1.2.cmml" xref="S3.E4.m1.4.4.2.1.1.1"><csymbol cd="latexml" id="S3.E4.m1.4.4.2.1.1.2.1.cmml" xref="S3.E4.m1.4.4.2.1.1.1.2">delimited-[]</csymbol><apply id="S3.E4.m1.4.4.2.1.1.1.1.cmml" xref="S3.E4.m1.4.4.2.1.1.1.1"><minus id="S3.E4.m1.4.4.2.1.1.1.1.2.cmml" xref="S3.E4.m1.4.4.2.1.1.1.1"></minus><apply id="S3.E4.m1.4.4.2.1.1.1.1.1.cmml" xref="S3.E4.m1.4.4.2.1.1.1.1.1"><apply id="S3.E4.m1.4.4.2.1.1.1.1.1.2.cmml" xref="S3.E4.m1.4.4.2.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.E4.m1.4.4.2.1.1.1.1.1.2.1.cmml" xref="S3.E4.m1.4.4.2.1.1.1.1.1.2">superscript</csymbol><apply id="S3.E4.m1.4.4.2.1.1.1.1.1.2.2.cmml" xref="S3.E4.m1.4.4.2.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.E4.m1.4.4.2.1.1.1.1.1.2.2.1.cmml" xref="S3.E4.m1.4.4.2.1.1.1.1.1.2">subscript</csymbol><sum id="S3.E4.m1.4.4.2.1.1.1.1.1.2.2.2.cmml" xref="S3.E4.m1.4.4.2.1.1.1.1.1.2.2.2"></sum><apply id="S3.E4.m1.4.4.2.1.1.1.1.1.2.2.3.cmml" xref="S3.E4.m1.4.4.2.1.1.1.1.1.2.2.3"><eq id="S3.E4.m1.4.4.2.1.1.1.1.1.2.2.3.1.cmml" xref="S3.E4.m1.4.4.2.1.1.1.1.1.2.2.3.1"></eq><ci id="S3.E4.m1.4.4.2.1.1.1.1.1.2.2.3.2.cmml" xref="S3.E4.m1.4.4.2.1.1.1.1.1.2.2.3.2">𝑡</ci><cn id="S3.E4.m1.4.4.2.1.1.1.1.1.2.2.3.3.cmml" type="integer" xref="S3.E4.m1.4.4.2.1.1.1.1.1.2.2.3.3">1</cn></apply></apply><apply id="S3.E4.m1.4.4.2.1.1.1.1.1.2.3.cmml" xref="S3.E4.m1.4.4.2.1.1.1.1.1.2.3"><csymbol cd="ambiguous" id="S3.E4.m1.4.4.2.1.1.1.1.1.2.3.1.cmml" xref="S3.E4.m1.4.4.2.1.1.1.1.1.2.3">superscript</csymbol><apply id="S3.E4.m1.4.4.2.1.1.1.1.1.2.3.2.cmml" xref="S3.E4.m1.4.4.2.1.1.1.1.1.2.3"><csymbol cd="ambiguous" id="S3.E4.m1.4.4.2.1.1.1.1.1.2.3.2.1.cmml" xref="S3.E4.m1.4.4.2.1.1.1.1.1.2.3">subscript</csymbol><ci id="S3.E4.m1.4.4.2.1.1.1.1.1.2.3.2.2.cmml" xref="S3.E4.m1.4.4.2.1.1.1.1.1.2.3.2.2">𝑇</ci><ci id="S3.E4.m1.4.4.2.1.1.1.1.1.2.3.2.3.cmml" xref="S3.E4.m1.4.4.2.1.1.1.1.1.2.3.2.3">𝑖</ci></apply><ci id="S3.E4.m1.4.4.2.1.1.1.1.1.2.3.3.cmml" xref="S3.E4.m1.4.4.2.1.1.1.1.1.2.3.3">𝑗</ci></apply></apply><apply id="S3.E4.m1.4.4.2.1.1.1.1.1.1.cmml" xref="S3.E4.m1.4.4.2.1.1.1.1.1.1"><times id="S3.E4.m1.4.4.2.1.1.1.1.1.1.2.cmml" xref="S3.E4.m1.4.4.2.1.1.1.1.1.1.2"></times><apply id="S3.E4.m1.4.4.2.1.1.1.1.1.1.3.cmml" xref="S3.E4.m1.4.4.2.1.1.1.1.1.1.3"><log id="S3.E4.m1.4.4.2.1.1.1.1.1.1.3.1.cmml" xref="S3.E4.m1.4.4.2.1.1.1.1.1.1.3.1"></log><ci id="S3.E4.m1.4.4.2.1.1.1.1.1.1.3.2.cmml" xref="S3.E4.m1.4.4.2.1.1.1.1.1.1.3.2">𝑃</ci></apply><apply id="S3.E4.m1.4.4.2.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E4.m1.4.4.2.1.1.1.1.1.1.1.1"><csymbol cd="latexml" id="S3.E4.m1.4.4.2.1.1.1.1.1.1.1.1.1.4.cmml" xref="S3.E4.m1.4.4.2.1.1.1.1.1.1.1.1.1.4">conditional</csymbol><apply id="S3.E4.m1.4.4.2.1.1.1.1.1.1.1.1.1.5.cmml" xref="S3.E4.m1.4.4.2.1.1.1.1.1.1.1.1.1.5"><times id="S3.E4.m1.4.4.2.1.1.1.1.1.1.1.1.1.5.1.cmml" xref="S3.E4.m1.4.4.2.1.1.1.1.1.1.1.1.1.5.1"></times><apply id="S3.E4.m1.4.4.2.1.1.1.1.1.1.1.1.1.5.2.cmml" xref="S3.E4.m1.4.4.2.1.1.1.1.1.1.1.1.1.5.2"><csymbol cd="ambiguous" id="S3.E4.m1.4.4.2.1.1.1.1.1.1.1.1.1.5.2.1.cmml" xref="S3.E4.m1.4.4.2.1.1.1.1.1.1.1.1.1.5.2">superscript</csymbol><apply id="S3.E4.m1.4.4.2.1.1.1.1.1.1.1.1.1.5.2.2.cmml" xref="S3.E4.m1.4.4.2.1.1.1.1.1.1.1.1.1.5.2"><csymbol cd="ambiguous" id="S3.E4.m1.4.4.2.1.1.1.1.1.1.1.1.1.5.2.2.1.cmml" xref="S3.E4.m1.4.4.2.1.1.1.1.1.1.1.1.1.5.2">subscript</csymbol><ci id="S3.E4.m1.4.4.2.1.1.1.1.1.1.1.1.1.5.2.2.2.cmml" xref="S3.E4.m1.4.4.2.1.1.1.1.1.1.1.1.1.5.2.2.2">𝑟</ci><ci id="S3.E4.m1.4.4.2.1.1.1.1.1.1.1.1.1.5.2.2.3.cmml" xref="S3.E4.m1.4.4.2.1.1.1.1.1.1.1.1.1.5.2.2.3">𝑖</ci></apply><ci id="S3.E4.m1.4.4.2.1.1.1.1.1.1.1.1.1.5.2.3.cmml" xref="S3.E4.m1.4.4.2.1.1.1.1.1.1.1.1.1.5.2.3">𝑗</ci></apply><ci id="S3.E4.m1.2.2.cmml" xref="S3.E4.m1.2.2">𝑡</ci></apply><list id="S3.E4.m1.4.4.2.1.1.1.1.1.1.1.1.1.3.4.cmml" xref="S3.E4.m1.4.4.2.1.1.1.1.1.1.1.1.1.3.3"><apply id="S3.E4.m1.4.4.2.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E4.m1.4.4.2.1.1.1.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E4.m1.4.4.2.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E4.m1.4.4.2.1.1.1.1.1.1.1.1.1.1.1.1">superscript</csymbol><apply id="S3.E4.m1.4.4.2.1.1.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S3.E4.m1.4.4.2.1.1.1.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E4.m1.4.4.2.1.1.1.1.1.1.1.1.1.1.1.1.2.1.cmml" xref="S3.E4.m1.4.4.2.1.1.1.1.1.1.1.1.1.1.1.1">subscript</csymbol><ci id="S3.E4.m1.4.4.2.1.1.1.1.1.1.1.1.1.1.1.1.2.2.cmml" xref="S3.E4.m1.4.4.2.1.1.1.1.1.1.1.1.1.1.1.1.2.2">𝑢</ci><ci id="S3.E4.m1.4.4.2.1.1.1.1.1.1.1.1.1.1.1.1.2.3.cmml" xref="S3.E4.m1.4.4.2.1.1.1.1.1.1.1.1.1.1.1.1.2.3">𝑖</ci></apply><ci id="S3.E4.m1.4.4.2.1.1.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="S3.E4.m1.4.4.2.1.1.1.1.1.1.1.1.1.1.1.1.3">𝑗</ci></apply><apply id="S3.E4.m1.4.4.2.1.1.1.1.1.1.1.1.1.2.2.2.cmml" xref="S3.E4.m1.4.4.2.1.1.1.1.1.1.1.1.1.2.2.2"><csymbol cd="latexml" id="S3.E4.m1.4.4.2.1.1.1.1.1.1.1.1.1.2.2.2.2.cmml" xref="S3.E4.m1.4.4.2.1.1.1.1.1.1.1.1.1.2.2.2">annotated</csymbol><apply id="S3.E4.m1.4.4.2.1.1.1.1.1.1.1.1.1.2.2.2.3.cmml" xref="S3.E4.m1.4.4.2.1.1.1.1.1.1.1.1.1.2.2.2.3"><csymbol cd="ambiguous" id="S3.E4.m1.4.4.2.1.1.1.1.1.1.1.1.1.2.2.2.3.1.cmml" xref="S3.E4.m1.4.4.2.1.1.1.1.1.1.1.1.1.2.2.2.3">superscript</csymbol><apply id="S3.E4.m1.4.4.2.1.1.1.1.1.1.1.1.1.2.2.2.3.2.cmml" xref="S3.E4.m1.4.4.2.1.1.1.1.1.1.1.1.1.2.2.2.3"><csymbol cd="ambiguous" id="S3.E4.m1.4.4.2.1.1.1.1.1.1.1.1.1.2.2.2.3.2.1.cmml" xref="S3.E4.m1.4.4.2.1.1.1.1.1.1.1.1.1.2.2.2.3">subscript</csymbol><ci id="S3.E4.m1.4.4.2.1.1.1.1.1.1.1.1.1.2.2.2.3.2.2.cmml" xref="S3.E4.m1.4.4.2.1.1.1.1.1.1.1.1.1.2.2.2.3.2.2">𝑟</ci><ci id="S3.E4.m1.4.4.2.1.1.1.1.1.1.1.1.1.2.2.2.3.2.3.cmml" xref="S3.E4.m1.4.4.2.1.1.1.1.1.1.1.1.1.2.2.2.3.2.3">𝑖</ci></apply><ci id="S3.E4.m1.4.4.2.1.1.1.1.1.1.1.1.1.2.2.2.3.3.cmml" xref="S3.E4.m1.4.4.2.1.1.1.1.1.1.1.1.1.2.2.2.3.3">𝑗</ci></apply><apply id="S3.E4.m1.4.4.2.1.1.1.1.1.1.1.1.1.2.2.2.1.1.1.cmml" xref="S3.E4.m1.4.4.2.1.1.1.1.1.1.1.1.1.2.2.2.1.1"><lt id="S3.E4.m1.4.4.2.1.1.1.1.1.1.1.1.1.2.2.2.1.1.1.1.cmml" xref="S3.E4.m1.4.4.2.1.1.1.1.1.1.1.1.1.2.2.2.1.1.1.1"></lt><csymbol cd="latexml" id="S3.E4.m1.4.4.2.1.1.1.1.1.1.1.1.1.2.2.2.1.1.1.2.cmml" xref="S3.E4.m1.4.4.2.1.1.1.1.1.1.1.1.1.2.2.2.1.1.1.2">absent</csymbol><ci id="S3.E4.m1.4.4.2.1.1.1.1.1.1.1.1.1.2.2.2.1.1.1.3.cmml" xref="S3.E4.m1.4.4.2.1.1.1.1.1.1.1.1.1.2.2.2.1.1.1.3">𝑡</ci></apply></apply><apply id="S3.E4.m1.4.4.2.1.1.1.1.1.1.1.1.1.3.3.3.cmml" xref="S3.E4.m1.4.4.2.1.1.1.1.1.1.1.1.1.3.3.3"><csymbol cd="ambiguous" id="S3.E4.m1.4.4.2.1.1.1.1.1.1.1.1.1.3.3.3.1.cmml" xref="S3.E4.m1.4.4.2.1.1.1.1.1.1.1.1.1.3.3.3">subscript</csymbol><ci id="S3.E4.m1.4.4.2.1.1.1.1.1.1.1.1.1.3.3.3.2.cmml" xref="S3.E4.m1.4.4.2.1.1.1.1.1.1.1.1.1.3.3.3.2">𝜃</ci><cn id="S3.E4.m1.4.4.2.1.1.1.1.1.1.1.1.1.3.3.3.3.cmml" type="integer" xref="S3.E4.m1.4.4.2.1.1.1.1.1.1.1.1.1.3.3.3.3">1</cn></apply></list></apply></apply></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E4.m1.4c">\mathcal{L}_{1}(\theta_{1};\mathcal{D})=\sum_{i=1}^{I}\sum_{j=1}^{J}\left[-%
\sum_{t=1}^{T_{i}^{j}}\log P\left(r_{i}^{j}(t)\mid u_{i}^{j},r_{i}^{j}(&lt;t);%
\theta_{1}\right)\right]</annotation><annotation encoding="application/x-llamapun" id="S3.E4.m1.4d">caligraphic_L start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT ( italic_θ start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT ; caligraphic_D ) = ∑ start_POSTSUBSCRIPT italic_i = 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_I end_POSTSUPERSCRIPT ∑ start_POSTSUBSCRIPT italic_j = 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_J end_POSTSUPERSCRIPT [ - ∑ start_POSTSUBSCRIPT italic_t = 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_T start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_j end_POSTSUPERSCRIPT end_POSTSUPERSCRIPT roman_log italic_P ( italic_r start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_j end_POSTSUPERSCRIPT ( italic_t ) ∣ italic_u start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_j end_POSTSUPERSCRIPT , italic_r start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_j end_POSTSUPERSCRIPT ( &lt; italic_t ) ; italic_θ start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT ) ]</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S3.SS2.SSS2.p1.23">By optimizing the objective <math alttext="\mathcal{L}_{1}(\theta_{1};\mathcal{D})" class="ltx_Math" display="inline" id="S3.SS2.SSS2.p1.23.m1.2"><semantics id="S3.SS2.SSS2.p1.23.m1.2a"><mrow id="S3.SS2.SSS2.p1.23.m1.2.2" xref="S3.SS2.SSS2.p1.23.m1.2.2.cmml"><msub id="S3.SS2.SSS2.p1.23.m1.2.2.3" xref="S3.SS2.SSS2.p1.23.m1.2.2.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS2.SSS2.p1.23.m1.2.2.3.2" xref="S3.SS2.SSS2.p1.23.m1.2.2.3.2.cmml">ℒ</mi><mn id="S3.SS2.SSS2.p1.23.m1.2.2.3.3" xref="S3.SS2.SSS2.p1.23.m1.2.2.3.3.cmml">1</mn></msub><mo id="S3.SS2.SSS2.p1.23.m1.2.2.2" xref="S3.SS2.SSS2.p1.23.m1.2.2.2.cmml">⁢</mo><mrow id="S3.SS2.SSS2.p1.23.m1.2.2.1.1" xref="S3.SS2.SSS2.p1.23.m1.2.2.1.2.cmml"><mo id="S3.SS2.SSS2.p1.23.m1.2.2.1.1.2" stretchy="false" xref="S3.SS2.SSS2.p1.23.m1.2.2.1.2.cmml">(</mo><msub id="S3.SS2.SSS2.p1.23.m1.2.2.1.1.1" xref="S3.SS2.SSS2.p1.23.m1.2.2.1.1.1.cmml"><mi id="S3.SS2.SSS2.p1.23.m1.2.2.1.1.1.2" xref="S3.SS2.SSS2.p1.23.m1.2.2.1.1.1.2.cmml">θ</mi><mn id="S3.SS2.SSS2.p1.23.m1.2.2.1.1.1.3" xref="S3.SS2.SSS2.p1.23.m1.2.2.1.1.1.3.cmml">1</mn></msub><mo id="S3.SS2.SSS2.p1.23.m1.2.2.1.1.3" xref="S3.SS2.SSS2.p1.23.m1.2.2.1.2.cmml">;</mo><mi class="ltx_font_mathcaligraphic" id="S3.SS2.SSS2.p1.23.m1.1.1" xref="S3.SS2.SSS2.p1.23.m1.1.1.cmml">𝒟</mi><mo id="S3.SS2.SSS2.p1.23.m1.2.2.1.1.4" stretchy="false" xref="S3.SS2.SSS2.p1.23.m1.2.2.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS2.p1.23.m1.2b"><apply id="S3.SS2.SSS2.p1.23.m1.2.2.cmml" xref="S3.SS2.SSS2.p1.23.m1.2.2"><times id="S3.SS2.SSS2.p1.23.m1.2.2.2.cmml" xref="S3.SS2.SSS2.p1.23.m1.2.2.2"></times><apply id="S3.SS2.SSS2.p1.23.m1.2.2.3.cmml" xref="S3.SS2.SSS2.p1.23.m1.2.2.3"><csymbol cd="ambiguous" id="S3.SS2.SSS2.p1.23.m1.2.2.3.1.cmml" xref="S3.SS2.SSS2.p1.23.m1.2.2.3">subscript</csymbol><ci id="S3.SS2.SSS2.p1.23.m1.2.2.3.2.cmml" xref="S3.SS2.SSS2.p1.23.m1.2.2.3.2">ℒ</ci><cn id="S3.SS2.SSS2.p1.23.m1.2.2.3.3.cmml" type="integer" xref="S3.SS2.SSS2.p1.23.m1.2.2.3.3">1</cn></apply><list id="S3.SS2.SSS2.p1.23.m1.2.2.1.2.cmml" xref="S3.SS2.SSS2.p1.23.m1.2.2.1.1"><apply id="S3.SS2.SSS2.p1.23.m1.2.2.1.1.1.cmml" xref="S3.SS2.SSS2.p1.23.m1.2.2.1.1.1"><csymbol cd="ambiguous" id="S3.SS2.SSS2.p1.23.m1.2.2.1.1.1.1.cmml" xref="S3.SS2.SSS2.p1.23.m1.2.2.1.1.1">subscript</csymbol><ci id="S3.SS2.SSS2.p1.23.m1.2.2.1.1.1.2.cmml" xref="S3.SS2.SSS2.p1.23.m1.2.2.1.1.1.2">𝜃</ci><cn id="S3.SS2.SSS2.p1.23.m1.2.2.1.1.1.3.cmml" type="integer" xref="S3.SS2.SSS2.p1.23.m1.2.2.1.1.1.3">1</cn></apply><ci id="S3.SS2.SSS2.p1.23.m1.1.1.cmml" xref="S3.SS2.SSS2.p1.23.m1.1.1">𝒟</ci></list></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS2.p1.23.m1.2c">\mathcal{L}_{1}(\theta_{1};\mathcal{D})</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS2.p1.23.m1.2d">caligraphic_L start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT ( italic_θ start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT ; caligraphic_D )</annotation></semantics></math>, the LLM learns the dialogue capability in the context of psychological counseling:</p>
<table class="ltx_equation ltx_eqn_table" id="S3.E5">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_left" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_left">(5)</span></td>
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\theta_{1}^{*}=\arg\min_{\theta_{1}}\mathcal{L}_{1}(\theta_{1};\mathcal{D})" class="ltx_Math" display="block" id="S3.E5.m1.2"><semantics id="S3.E5.m1.2a"><mrow id="S3.E5.m1.2.2" xref="S3.E5.m1.2.2.cmml"><msubsup id="S3.E5.m1.2.2.3" xref="S3.E5.m1.2.2.3.cmml"><mi id="S3.E5.m1.2.2.3.2.2" xref="S3.E5.m1.2.2.3.2.2.cmml">θ</mi><mn id="S3.E5.m1.2.2.3.2.3" xref="S3.E5.m1.2.2.3.2.3.cmml">1</mn><mo id="S3.E5.m1.2.2.3.3" xref="S3.E5.m1.2.2.3.3.cmml">∗</mo></msubsup><mo id="S3.E5.m1.2.2.2" xref="S3.E5.m1.2.2.2.cmml">=</mo><mrow id="S3.E5.m1.2.2.1" xref="S3.E5.m1.2.2.1.cmml"><mrow id="S3.E5.m1.2.2.1.3" xref="S3.E5.m1.2.2.1.3.cmml"><mi id="S3.E5.m1.2.2.1.3.1" xref="S3.E5.m1.2.2.1.3.1.cmml">arg</mi><mo id="S3.E5.m1.2.2.1.3a" lspace="0.167em" xref="S3.E5.m1.2.2.1.3.cmml">⁡</mo><mrow id="S3.E5.m1.2.2.1.3.2" xref="S3.E5.m1.2.2.1.3.2.cmml"><munder id="S3.E5.m1.2.2.1.3.2.1" xref="S3.E5.m1.2.2.1.3.2.1.cmml"><mi id="S3.E5.m1.2.2.1.3.2.1.2" xref="S3.E5.m1.2.2.1.3.2.1.2.cmml">min</mi><msub id="S3.E5.m1.2.2.1.3.2.1.3" xref="S3.E5.m1.2.2.1.3.2.1.3.cmml"><mi id="S3.E5.m1.2.2.1.3.2.1.3.2" xref="S3.E5.m1.2.2.1.3.2.1.3.2.cmml">θ</mi><mn id="S3.E5.m1.2.2.1.3.2.1.3.3" xref="S3.E5.m1.2.2.1.3.2.1.3.3.cmml">1</mn></msub></munder><mo id="S3.E5.m1.2.2.1.3.2a" lspace="0.167em" xref="S3.E5.m1.2.2.1.3.2.cmml">⁡</mo><msub id="S3.E5.m1.2.2.1.3.2.2" xref="S3.E5.m1.2.2.1.3.2.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.E5.m1.2.2.1.3.2.2.2" xref="S3.E5.m1.2.2.1.3.2.2.2.cmml">ℒ</mi><mn id="S3.E5.m1.2.2.1.3.2.2.3" xref="S3.E5.m1.2.2.1.3.2.2.3.cmml">1</mn></msub></mrow></mrow><mo id="S3.E5.m1.2.2.1.2" xref="S3.E5.m1.2.2.1.2.cmml">⁢</mo><mrow id="S3.E5.m1.2.2.1.1.1" xref="S3.E5.m1.2.2.1.1.2.cmml"><mo id="S3.E5.m1.2.2.1.1.1.2" stretchy="false" xref="S3.E5.m1.2.2.1.1.2.cmml">(</mo><msub id="S3.E5.m1.2.2.1.1.1.1" xref="S3.E5.m1.2.2.1.1.1.1.cmml"><mi id="S3.E5.m1.2.2.1.1.1.1.2" xref="S3.E5.m1.2.2.1.1.1.1.2.cmml">θ</mi><mn id="S3.E5.m1.2.2.1.1.1.1.3" xref="S3.E5.m1.2.2.1.1.1.1.3.cmml">1</mn></msub><mo id="S3.E5.m1.2.2.1.1.1.3" xref="S3.E5.m1.2.2.1.1.2.cmml">;</mo><mi class="ltx_font_mathcaligraphic" id="S3.E5.m1.1.1" xref="S3.E5.m1.1.1.cmml">𝒟</mi><mo id="S3.E5.m1.2.2.1.1.1.4" stretchy="false" xref="S3.E5.m1.2.2.1.1.2.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.E5.m1.2b"><apply id="S3.E5.m1.2.2.cmml" xref="S3.E5.m1.2.2"><eq id="S3.E5.m1.2.2.2.cmml" xref="S3.E5.m1.2.2.2"></eq><apply id="S3.E5.m1.2.2.3.cmml" xref="S3.E5.m1.2.2.3"><csymbol cd="ambiguous" id="S3.E5.m1.2.2.3.1.cmml" xref="S3.E5.m1.2.2.3">superscript</csymbol><apply id="S3.E5.m1.2.2.3.2.cmml" xref="S3.E5.m1.2.2.3"><csymbol cd="ambiguous" id="S3.E5.m1.2.2.3.2.1.cmml" xref="S3.E5.m1.2.2.3">subscript</csymbol><ci id="S3.E5.m1.2.2.3.2.2.cmml" xref="S3.E5.m1.2.2.3.2.2">𝜃</ci><cn id="S3.E5.m1.2.2.3.2.3.cmml" type="integer" xref="S3.E5.m1.2.2.3.2.3">1</cn></apply><times id="S3.E5.m1.2.2.3.3.cmml" xref="S3.E5.m1.2.2.3.3"></times></apply><apply id="S3.E5.m1.2.2.1.cmml" xref="S3.E5.m1.2.2.1"><times id="S3.E5.m1.2.2.1.2.cmml" xref="S3.E5.m1.2.2.1.2"></times><apply id="S3.E5.m1.2.2.1.3.cmml" xref="S3.E5.m1.2.2.1.3"><arg id="S3.E5.m1.2.2.1.3.1.cmml" xref="S3.E5.m1.2.2.1.3.1"></arg><apply id="S3.E5.m1.2.2.1.3.2.cmml" xref="S3.E5.m1.2.2.1.3.2"><apply id="S3.E5.m1.2.2.1.3.2.1.cmml" xref="S3.E5.m1.2.2.1.3.2.1"><csymbol cd="ambiguous" id="S3.E5.m1.2.2.1.3.2.1.1.cmml" xref="S3.E5.m1.2.2.1.3.2.1">subscript</csymbol><min id="S3.E5.m1.2.2.1.3.2.1.2.cmml" xref="S3.E5.m1.2.2.1.3.2.1.2"></min><apply id="S3.E5.m1.2.2.1.3.2.1.3.cmml" xref="S3.E5.m1.2.2.1.3.2.1.3"><csymbol cd="ambiguous" id="S3.E5.m1.2.2.1.3.2.1.3.1.cmml" xref="S3.E5.m1.2.2.1.3.2.1.3">subscript</csymbol><ci id="S3.E5.m1.2.2.1.3.2.1.3.2.cmml" xref="S3.E5.m1.2.2.1.3.2.1.3.2">𝜃</ci><cn id="S3.E5.m1.2.2.1.3.2.1.3.3.cmml" type="integer" xref="S3.E5.m1.2.2.1.3.2.1.3.3">1</cn></apply></apply><apply id="S3.E5.m1.2.2.1.3.2.2.cmml" xref="S3.E5.m1.2.2.1.3.2.2"><csymbol cd="ambiguous" id="S3.E5.m1.2.2.1.3.2.2.1.cmml" xref="S3.E5.m1.2.2.1.3.2.2">subscript</csymbol><ci id="S3.E5.m1.2.2.1.3.2.2.2.cmml" xref="S3.E5.m1.2.2.1.3.2.2.2">ℒ</ci><cn id="S3.E5.m1.2.2.1.3.2.2.3.cmml" type="integer" xref="S3.E5.m1.2.2.1.3.2.2.3">1</cn></apply></apply></apply><list id="S3.E5.m1.2.2.1.1.2.cmml" xref="S3.E5.m1.2.2.1.1.1"><apply id="S3.E5.m1.2.2.1.1.1.1.cmml" xref="S3.E5.m1.2.2.1.1.1.1"><csymbol cd="ambiguous" id="S3.E5.m1.2.2.1.1.1.1.1.cmml" xref="S3.E5.m1.2.2.1.1.1.1">subscript</csymbol><ci id="S3.E5.m1.2.2.1.1.1.1.2.cmml" xref="S3.E5.m1.2.2.1.1.1.1.2">𝜃</ci><cn id="S3.E5.m1.2.2.1.1.1.1.3.cmml" type="integer" xref="S3.E5.m1.2.2.1.1.1.1.3">1</cn></apply><ci id="S3.E5.m1.1.1.cmml" xref="S3.E5.m1.1.1">𝒟</ci></list></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E5.m1.2c">\theta_{1}^{*}=\arg\min_{\theta_{1}}\mathcal{L}_{1}(\theta_{1};\mathcal{D})</annotation><annotation encoding="application/x-llamapun" id="S3.E5.m1.2d">italic_θ start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ∗ end_POSTSUPERSCRIPT = roman_arg roman_min start_POSTSUBSCRIPT italic_θ start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT end_POSTSUBSCRIPT caligraphic_L start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT ( italic_θ start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT ; caligraphic_D )</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S3.SS2.SSS2.p1.24">where <math alttext="\theta_{1}^{*}" class="ltx_Math" display="inline" id="S3.SS2.SSS2.p1.24.m1.1"><semantics id="S3.SS2.SSS2.p1.24.m1.1a"><msubsup id="S3.SS2.SSS2.p1.24.m1.1.1" xref="S3.SS2.SSS2.p1.24.m1.1.1.cmml"><mi id="S3.SS2.SSS2.p1.24.m1.1.1.2.2" xref="S3.SS2.SSS2.p1.24.m1.1.1.2.2.cmml">θ</mi><mn id="S3.SS2.SSS2.p1.24.m1.1.1.2.3" xref="S3.SS2.SSS2.p1.24.m1.1.1.2.3.cmml">1</mn><mo id="S3.SS2.SSS2.p1.24.m1.1.1.3" xref="S3.SS2.SSS2.p1.24.m1.1.1.3.cmml">∗</mo></msubsup><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS2.p1.24.m1.1b"><apply id="S3.SS2.SSS2.p1.24.m1.1.1.cmml" xref="S3.SS2.SSS2.p1.24.m1.1.1"><csymbol cd="ambiguous" id="S3.SS2.SSS2.p1.24.m1.1.1.1.cmml" xref="S3.SS2.SSS2.p1.24.m1.1.1">superscript</csymbol><apply id="S3.SS2.SSS2.p1.24.m1.1.1.2.cmml" xref="S3.SS2.SSS2.p1.24.m1.1.1"><csymbol cd="ambiguous" id="S3.SS2.SSS2.p1.24.m1.1.1.2.1.cmml" xref="S3.SS2.SSS2.p1.24.m1.1.1">subscript</csymbol><ci id="S3.SS2.SSS2.p1.24.m1.1.1.2.2.cmml" xref="S3.SS2.SSS2.p1.24.m1.1.1.2.2">𝜃</ci><cn id="S3.SS2.SSS2.p1.24.m1.1.1.2.3.cmml" type="integer" xref="S3.SS2.SSS2.p1.24.m1.1.1.2.3">1</cn></apply><times id="S3.SS2.SSS2.p1.24.m1.1.1.3.cmml" xref="S3.SS2.SSS2.p1.24.m1.1.1.3"></times></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS2.p1.24.m1.1c">\theta_{1}^{*}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS2.p1.24.m1.1d">italic_θ start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ∗ end_POSTSUPERSCRIPT</annotation></semantics></math> is the learned parameters of our AI Psychological Chatbot.</p>
</div>
</section>
</section>
<section class="ltx_subsection" id="S3.SS3">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.3. </span>AI Psychologist</h3>
<figure class="ltx_figure" id="S3.F7">
<div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_2"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_figure_panel ltx_img_landscape" height="196" id="S3.F7.g1" src="extracted/5872729/7.png" width="598"/></div>
</div>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 7. </span>The construction process of AI Psychologist. We use RAG techniques to identify the semantically closest section <math alttext="s_{n^{*}}" class="ltx_Math" display="inline" id="S3.F7.8.m1.1"><semantics id="S3.F7.8.m1.1b"><msub id="S3.F7.8.m1.1.1" xref="S3.F7.8.m1.1.1.cmml"><mi id="S3.F7.8.m1.1.1.2" xref="S3.F7.8.m1.1.1.2.cmml">s</mi><msup id="S3.F7.8.m1.1.1.3" xref="S3.F7.8.m1.1.1.3.cmml"><mi id="S3.F7.8.m1.1.1.3.2" xref="S3.F7.8.m1.1.1.3.2.cmml">n</mi><mo id="S3.F7.8.m1.1.1.3.3" xref="S3.F7.8.m1.1.1.3.3.cmml">∗</mo></msup></msub><annotation-xml encoding="MathML-Content" id="S3.F7.8.m1.1c"><apply id="S3.F7.8.m1.1.1.cmml" xref="S3.F7.8.m1.1.1"><csymbol cd="ambiguous" id="S3.F7.8.m1.1.1.1.cmml" xref="S3.F7.8.m1.1.1">subscript</csymbol><ci id="S3.F7.8.m1.1.1.2.cmml" xref="S3.F7.8.m1.1.1.2">𝑠</ci><apply id="S3.F7.8.m1.1.1.3.cmml" xref="S3.F7.8.m1.1.1.3"><csymbol cd="ambiguous" id="S3.F7.8.m1.1.1.3.1.cmml" xref="S3.F7.8.m1.1.1.3">superscript</csymbol><ci id="S3.F7.8.m1.1.1.3.2.cmml" xref="S3.F7.8.m1.1.1.3.2">𝑛</ci><times id="S3.F7.8.m1.1.1.3.3.cmml" xref="S3.F7.8.m1.1.1.3.3"></times></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.F7.8.m1.1d">s_{n^{*}}</annotation><annotation encoding="application/x-llamapun" id="S3.F7.8.m1.1e">italic_s start_POSTSUBSCRIPT italic_n start_POSTSUPERSCRIPT ∗ end_POSTSUPERSCRIPT end_POSTSUBSCRIPT</annotation></semantics></math> of the DSM-V criteria <math alttext="S" class="ltx_Math" display="inline" id="S3.F7.9.m2.1"><semantics id="S3.F7.9.m2.1b"><mi id="S3.F7.9.m2.1.1" xref="S3.F7.9.m2.1.1.cmml">S</mi><annotation-xml encoding="MathML-Content" id="S3.F7.9.m2.1c"><ci id="S3.F7.9.m2.1.1.cmml" xref="S3.F7.9.m2.1.1">𝑆</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.F7.9.m2.1d">S</annotation><annotation encoding="application/x-llamapun" id="S3.F7.9.m2.1e">italic_S</annotation></semantics></math> to the user’s content <math alttext="u_{i}" class="ltx_Math" display="inline" id="S3.F7.10.m3.1"><semantics id="S3.F7.10.m3.1b"><msub id="S3.F7.10.m3.1.1" xref="S3.F7.10.m3.1.1.cmml"><mi id="S3.F7.10.m3.1.1.2" xref="S3.F7.10.m3.1.1.2.cmml">u</mi><mi id="S3.F7.10.m3.1.1.3" xref="S3.F7.10.m3.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S3.F7.10.m3.1c"><apply id="S3.F7.10.m3.1.1.cmml" xref="S3.F7.10.m3.1.1"><csymbol cd="ambiguous" id="S3.F7.10.m3.1.1.1.cmml" xref="S3.F7.10.m3.1.1">subscript</csymbol><ci id="S3.F7.10.m3.1.1.2.cmml" xref="S3.F7.10.m3.1.1.2">𝑢</ci><ci id="S3.F7.10.m3.1.1.3.cmml" xref="S3.F7.10.m3.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.F7.10.m3.1d">u_{i}</annotation><annotation encoding="application/x-llamapun" id="S3.F7.10.m3.1e">italic_u start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT</annotation></semantics></math>. Then, through our designed assistive diagnostic report prompt engineering, we apply the CoT approach to generate high-quality assistive diagnostic reports <math alttext="\{y_{i}\}" class="ltx_Math" display="inline" id="S3.F7.11.m4.1"><semantics id="S3.F7.11.m4.1b"><mrow id="S3.F7.11.m4.1.1.1" xref="S3.F7.11.m4.1.1.2.cmml"><mo id="S3.F7.11.m4.1.1.1.2" stretchy="false" xref="S3.F7.11.m4.1.1.2.cmml">{</mo><msub id="S3.F7.11.m4.1.1.1.1" xref="S3.F7.11.m4.1.1.1.1.cmml"><mi id="S3.F7.11.m4.1.1.1.1.2" xref="S3.F7.11.m4.1.1.1.1.2.cmml">y</mi><mi id="S3.F7.11.m4.1.1.1.1.3" xref="S3.F7.11.m4.1.1.1.1.3.cmml">i</mi></msub><mo id="S3.F7.11.m4.1.1.1.3" stretchy="false" xref="S3.F7.11.m4.1.1.2.cmml">}</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.F7.11.m4.1c"><set id="S3.F7.11.m4.1.1.2.cmml" xref="S3.F7.11.m4.1.1.1"><apply id="S3.F7.11.m4.1.1.1.1.cmml" xref="S3.F7.11.m4.1.1.1.1"><csymbol cd="ambiguous" id="S3.F7.11.m4.1.1.1.1.1.cmml" xref="S3.F7.11.m4.1.1.1.1">subscript</csymbol><ci id="S3.F7.11.m4.1.1.1.1.2.cmml" xref="S3.F7.11.m4.1.1.1.1.2">𝑦</ci><ci id="S3.F7.11.m4.1.1.1.1.3.cmml" xref="S3.F7.11.m4.1.1.1.1.3">𝑖</ci></apply></set></annotation-xml><annotation encoding="application/x-tex" id="S3.F7.11.m4.1d">\{y_{i}\}</annotation><annotation encoding="application/x-llamapun" id="S3.F7.11.m4.1e">{ italic_y start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT }</annotation></semantics></math> in a fixed format. These reports <math alttext="\{y_{i}\}" class="ltx_Math" display="inline" id="S3.F7.12.m5.1"><semantics id="S3.F7.12.m5.1b"><mrow id="S3.F7.12.m5.1.1.1" xref="S3.F7.12.m5.1.1.2.cmml"><mo id="S3.F7.12.m5.1.1.1.2" stretchy="false" xref="S3.F7.12.m5.1.1.2.cmml">{</mo><msub id="S3.F7.12.m5.1.1.1.1" xref="S3.F7.12.m5.1.1.1.1.cmml"><mi id="S3.F7.12.m5.1.1.1.1.2" xref="S3.F7.12.m5.1.1.1.1.2.cmml">y</mi><mi id="S3.F7.12.m5.1.1.1.1.3" xref="S3.F7.12.m5.1.1.1.1.3.cmml">i</mi></msub><mo id="S3.F7.12.m5.1.1.1.3" stretchy="false" xref="S3.F7.12.m5.1.1.2.cmml">}</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.F7.12.m5.1c"><set id="S3.F7.12.m5.1.1.2.cmml" xref="S3.F7.12.m5.1.1.1"><apply id="S3.F7.12.m5.1.1.1.1.cmml" xref="S3.F7.12.m5.1.1.1.1"><csymbol cd="ambiguous" id="S3.F7.12.m5.1.1.1.1.1.cmml" xref="S3.F7.12.m5.1.1.1.1">subscript</csymbol><ci id="S3.F7.12.m5.1.1.1.1.2.cmml" xref="S3.F7.12.m5.1.1.1.1.2">𝑦</ci><ci id="S3.F7.12.m5.1.1.1.1.3.cmml" xref="S3.F7.12.m5.1.1.1.1.3">𝑖</ci></apply></set></annotation-xml><annotation encoding="application/x-tex" id="S3.F7.12.m5.1d">\{y_{i}\}</annotation><annotation encoding="application/x-llamapun" id="S3.F7.12.m5.1e">{ italic_y start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT }</annotation></semantics></math>, combined with dialogue data <math alttext="\{d_{i}\}" class="ltx_Math" display="inline" id="S3.F7.13.m6.1"><semantics id="S3.F7.13.m6.1b"><mrow id="S3.F7.13.m6.1.1.1" xref="S3.F7.13.m6.1.1.2.cmml"><mo id="S3.F7.13.m6.1.1.1.2" stretchy="false" xref="S3.F7.13.m6.1.1.2.cmml">{</mo><msub id="S3.F7.13.m6.1.1.1.1" xref="S3.F7.13.m6.1.1.1.1.cmml"><mi id="S3.F7.13.m6.1.1.1.1.2" xref="S3.F7.13.m6.1.1.1.1.2.cmml">d</mi><mi id="S3.F7.13.m6.1.1.1.1.3" xref="S3.F7.13.m6.1.1.1.1.3.cmml">i</mi></msub><mo id="S3.F7.13.m6.1.1.1.3" stretchy="false" xref="S3.F7.13.m6.1.1.2.cmml">}</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.F7.13.m6.1c"><set id="S3.F7.13.m6.1.1.2.cmml" xref="S3.F7.13.m6.1.1.1"><apply id="S3.F7.13.m6.1.1.1.1.cmml" xref="S3.F7.13.m6.1.1.1.1"><csymbol cd="ambiguous" id="S3.F7.13.m6.1.1.1.1.1.cmml" xref="S3.F7.13.m6.1.1.1.1">subscript</csymbol><ci id="S3.F7.13.m6.1.1.1.1.2.cmml" xref="S3.F7.13.m6.1.1.1.1.2">𝑑</ci><ci id="S3.F7.13.m6.1.1.1.1.3.cmml" xref="S3.F7.13.m6.1.1.1.1.3">𝑖</ci></apply></set></annotation-xml><annotation encoding="application/x-tex" id="S3.F7.13.m6.1d">\{d_{i}\}</annotation><annotation encoding="application/x-llamapun" id="S3.F7.13.m6.1e">{ italic_d start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT }</annotation></semantics></math>, are then used for instruction fine-tuning to build the AI Psychologist (<math alttext="\theta_{2}^{*}" class="ltx_Math" display="inline" id="S3.F7.14.m7.1"><semantics id="S3.F7.14.m7.1b"><msubsup id="S3.F7.14.m7.1.1" xref="S3.F7.14.m7.1.1.cmml"><mi id="S3.F7.14.m7.1.1.2.2" xref="S3.F7.14.m7.1.1.2.2.cmml">θ</mi><mn id="S3.F7.14.m7.1.1.2.3" xref="S3.F7.14.m7.1.1.2.3.cmml">2</mn><mo id="S3.F7.14.m7.1.1.3" xref="S3.F7.14.m7.1.1.3.cmml">∗</mo></msubsup><annotation-xml encoding="MathML-Content" id="S3.F7.14.m7.1c"><apply id="S3.F7.14.m7.1.1.cmml" xref="S3.F7.14.m7.1.1"><csymbol cd="ambiguous" id="S3.F7.14.m7.1.1.1.cmml" xref="S3.F7.14.m7.1.1">superscript</csymbol><apply id="S3.F7.14.m7.1.1.2.cmml" xref="S3.F7.14.m7.1.1"><csymbol cd="ambiguous" id="S3.F7.14.m7.1.1.2.1.cmml" xref="S3.F7.14.m7.1.1">subscript</csymbol><ci id="S3.F7.14.m7.1.1.2.2.cmml" xref="S3.F7.14.m7.1.1.2.2">𝜃</ci><cn id="S3.F7.14.m7.1.1.2.3.cmml" type="integer" xref="S3.F7.14.m7.1.1.2.3">2</cn></apply><times id="S3.F7.14.m7.1.1.3.cmml" xref="S3.F7.14.m7.1.1.3"></times></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.F7.14.m7.1d">\theta_{2}^{*}</annotation><annotation encoding="application/x-llamapun" id="S3.F7.14.m7.1e">italic_θ start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ∗ end_POSTSUPERSCRIPT</annotation></semantics></math>).</figcaption><div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_1"><span class="ltx_ERROR ltx_centering ltx_figure_panel undefined" id="S3.F7.15">\Description</span></div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_1">
<p class="ltx_p ltx_figure_panel ltx_align_center" id="S3.F7.16">This figure shows the construction process of the AI Psychologist. We use RAG to match the user’s content with the semantically closest part of the diagnostic criteria, and then generate a professional, fixed-format assistive diagnostic report through the proposed assistive diagnostic report prompt engineering.</p>
</div>
</div>
</figure>
<div class="ltx_para" id="S3.SS3.p1">
<p class="ltx_p" id="S3.SS3.p1.1">The key task of our AI Psychologist is to provide assistive diagnostic results, based on the experiences and feelings expressed in dialogues between patients and doctors. However, existing methods often utilize large language models (LLMs) to generate depression classification results and some analytical content from social media posts <cite class="ltx_cite ltx_citemacro_citep">(Xu et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2409.14878v1#bib.bib42" title="">2024</a>; Yang et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2409.14878v1#bib.bib44" title="">2024b</a>)</cite>. These methods lack a standardized, structured representation, making it difficult to form a comprehensive diagnostic report.
Additionally, they often rely on the inherent knowledge of the LLMs model, which can lead to hallucinations in the analysis. Although <cite class="ltx_cite ltx_citemacro_citep">(Yang et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2409.14878v1#bib.bib44" title="">2024b</a>)</cite> introduces an expert manual explanation set, it does not consider a specialized diagnostic standard. As we know, the gold standard for depression diagnosis is the DSM-V manual <cite class="ltx_cite ltx_citemacro_citep">(Widiger and Clark, <a class="ltx_ref" href="https://arxiv.org/html/2409.14878v1#bib.bib40" title="">2000</a>)</cite>, which provides diagnostic criteria for different types of depression. It serves as a crucial knowledge base for generating diagnostic reports. However, LLMs usually have a maximum text length limitation. The full diagnostic manual is too long to be directly provided to LLMs. In the following, we address these challenges by introducing retrieval-augmented generation (RAG) and chain-of-thoughts (CoT), as shown in Figure <a class="ltx_ref" href="https://arxiv.org/html/2409.14878v1#S3.F7" title="Figure 7 ‣ 3.3. AI Psychologist ‣ 3. Methodology ‣ InterMind: A Doctor-Patient-Family Interactive Depression Assessment System Empowered by Large Language Models"><span class="ltx_text ltx_ref_tag">7</span></a>.</p>
</div>
<section class="ltx_subsubsection" id="S3.SS3.SSS1">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">3.3.1. </span>Diagnostic Criteria Knowledge Retrieval</h4>
<div class="ltx_para" id="S3.SS3.SSS1.p1">
<p class="ltx_p" id="S3.SS3.SSS1.p1.1">To leverage the knowledge in the DSM-V for generating professional assistive diagnostic reports, we introduce the retrieval-augmented generation (RAG) technology <cite class="ltx_cite ltx_citemacro_citep">(Lewis et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2409.14878v1#bib.bib19" title="">2020</a>)</cite>. The generated reports with dialogues in the dataset <math alttext="\mathcal{D}" class="ltx_Math" display="inline" id="S3.SS3.SSS1.p1.1.m1.1"><semantics id="S3.SS3.SSS1.p1.1.m1.1a"><mi class="ltx_font_mathcaligraphic" id="S3.SS3.SSS1.p1.1.m1.1.1" xref="S3.SS3.SSS1.p1.1.m1.1.1.cmml">𝒟</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS1.p1.1.m1.1b"><ci id="S3.SS3.SSS1.p1.1.m1.1.1.cmml" xref="S3.SS3.SSS1.p1.1.m1.1.1">𝒟</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS1.p1.1.m1.1c">\mathcal{D}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.SSS1.p1.1.m1.1d">caligraphic_D</annotation></semantics></math> can then serve as high-quality data for instruction fine-tuning to build the AI Psychologist. RAG combines the strengths of retrieval-based and generation-based models, which are widely used in natural language processing (NLP) tasks <cite class="ltx_cite ltx_citemacro_citep">(Asai et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2409.14878v1#bib.bib3" title="">2023</a>; Jeong et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2409.14878v1#bib.bib13" title="">2024</a>; Edge et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2409.14878v1#bib.bib6" title="">2024</a>)</cite>. It retrieves relevant documents from a corpus using a retrieval model and then uses a generative model to generate coherent responses or content based on the retrieved information, improving the accuracy and relevance of the generated output.
We observe that the DSM-V diagnostic criteria are primarily based on patient symptoms. Therefore, we use the RAG technique to match the user’s dialogue content with the diagnostic criteria of each depression subtype in DSM-V in terms of similarity. The most similar semantic diagnostic criteria are provided to GPT-4 to generate the report.</p>
</div>
<div class="ltx_para" id="S3.SS3.SSS1.p2">
<p class="ltx_p" id="S3.SS3.SSS1.p2.5">Specifically, as shown in Figure <a class="ltx_ref" href="https://arxiv.org/html/2409.14878v1#S3.F7" title="Figure 7 ‣ 3.3. AI Psychologist ‣ 3. Methodology ‣ InterMind: A Doctor-Patient-Family Interactive Depression Assessment System Empowered by Large Language Models"><span class="ltx_text ltx_ref_tag">7</span></a>, the depression diagnostic section of DSM-V is divided into different documents according to the depression subtypes. Let <math alttext="S=\{s_{1},s_{2},...,s_{N}\}" class="ltx_Math" display="inline" id="S3.SS3.SSS1.p2.1.m1.4"><semantics id="S3.SS3.SSS1.p2.1.m1.4a"><mrow id="S3.SS3.SSS1.p2.1.m1.4.4" xref="S3.SS3.SSS1.p2.1.m1.4.4.cmml"><mi id="S3.SS3.SSS1.p2.1.m1.4.4.5" xref="S3.SS3.SSS1.p2.1.m1.4.4.5.cmml">S</mi><mo id="S3.SS3.SSS1.p2.1.m1.4.4.4" xref="S3.SS3.SSS1.p2.1.m1.4.4.4.cmml">=</mo><mrow id="S3.SS3.SSS1.p2.1.m1.4.4.3.3" xref="S3.SS3.SSS1.p2.1.m1.4.4.3.4.cmml"><mo id="S3.SS3.SSS1.p2.1.m1.4.4.3.3.4" stretchy="false" xref="S3.SS3.SSS1.p2.1.m1.4.4.3.4.cmml">{</mo><msub id="S3.SS3.SSS1.p2.1.m1.2.2.1.1.1" xref="S3.SS3.SSS1.p2.1.m1.2.2.1.1.1.cmml"><mi id="S3.SS3.SSS1.p2.1.m1.2.2.1.1.1.2" xref="S3.SS3.SSS1.p2.1.m1.2.2.1.1.1.2.cmml">s</mi><mn id="S3.SS3.SSS1.p2.1.m1.2.2.1.1.1.3" xref="S3.SS3.SSS1.p2.1.m1.2.2.1.1.1.3.cmml">1</mn></msub><mo id="S3.SS3.SSS1.p2.1.m1.4.4.3.3.5" xref="S3.SS3.SSS1.p2.1.m1.4.4.3.4.cmml">,</mo><msub id="S3.SS3.SSS1.p2.1.m1.3.3.2.2.2" xref="S3.SS3.SSS1.p2.1.m1.3.3.2.2.2.cmml"><mi id="S3.SS3.SSS1.p2.1.m1.3.3.2.2.2.2" xref="S3.SS3.SSS1.p2.1.m1.3.3.2.2.2.2.cmml">s</mi><mn id="S3.SS3.SSS1.p2.1.m1.3.3.2.2.2.3" xref="S3.SS3.SSS1.p2.1.m1.3.3.2.2.2.3.cmml">2</mn></msub><mo id="S3.SS3.SSS1.p2.1.m1.4.4.3.3.6" xref="S3.SS3.SSS1.p2.1.m1.4.4.3.4.cmml">,</mo><mi id="S3.SS3.SSS1.p2.1.m1.1.1" mathvariant="normal" xref="S3.SS3.SSS1.p2.1.m1.1.1.cmml">…</mi><mo id="S3.SS3.SSS1.p2.1.m1.4.4.3.3.7" xref="S3.SS3.SSS1.p2.1.m1.4.4.3.4.cmml">,</mo><msub id="S3.SS3.SSS1.p2.1.m1.4.4.3.3.3" xref="S3.SS3.SSS1.p2.1.m1.4.4.3.3.3.cmml"><mi id="S3.SS3.SSS1.p2.1.m1.4.4.3.3.3.2" xref="S3.SS3.SSS1.p2.1.m1.4.4.3.3.3.2.cmml">s</mi><mi id="S3.SS3.SSS1.p2.1.m1.4.4.3.3.3.3" xref="S3.SS3.SSS1.p2.1.m1.4.4.3.3.3.3.cmml">N</mi></msub><mo id="S3.SS3.SSS1.p2.1.m1.4.4.3.3.8" stretchy="false" xref="S3.SS3.SSS1.p2.1.m1.4.4.3.4.cmml">}</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS1.p2.1.m1.4b"><apply id="S3.SS3.SSS1.p2.1.m1.4.4.cmml" xref="S3.SS3.SSS1.p2.1.m1.4.4"><eq id="S3.SS3.SSS1.p2.1.m1.4.4.4.cmml" xref="S3.SS3.SSS1.p2.1.m1.4.4.4"></eq><ci id="S3.SS3.SSS1.p2.1.m1.4.4.5.cmml" xref="S3.SS3.SSS1.p2.1.m1.4.4.5">𝑆</ci><set id="S3.SS3.SSS1.p2.1.m1.4.4.3.4.cmml" xref="S3.SS3.SSS1.p2.1.m1.4.4.3.3"><apply id="S3.SS3.SSS1.p2.1.m1.2.2.1.1.1.cmml" xref="S3.SS3.SSS1.p2.1.m1.2.2.1.1.1"><csymbol cd="ambiguous" id="S3.SS3.SSS1.p2.1.m1.2.2.1.1.1.1.cmml" xref="S3.SS3.SSS1.p2.1.m1.2.2.1.1.1">subscript</csymbol><ci id="S3.SS3.SSS1.p2.1.m1.2.2.1.1.1.2.cmml" xref="S3.SS3.SSS1.p2.1.m1.2.2.1.1.1.2">𝑠</ci><cn id="S3.SS3.SSS1.p2.1.m1.2.2.1.1.1.3.cmml" type="integer" xref="S3.SS3.SSS1.p2.1.m1.2.2.1.1.1.3">1</cn></apply><apply id="S3.SS3.SSS1.p2.1.m1.3.3.2.2.2.cmml" xref="S3.SS3.SSS1.p2.1.m1.3.3.2.2.2"><csymbol cd="ambiguous" id="S3.SS3.SSS1.p2.1.m1.3.3.2.2.2.1.cmml" xref="S3.SS3.SSS1.p2.1.m1.3.3.2.2.2">subscript</csymbol><ci id="S3.SS3.SSS1.p2.1.m1.3.3.2.2.2.2.cmml" xref="S3.SS3.SSS1.p2.1.m1.3.3.2.2.2.2">𝑠</ci><cn id="S3.SS3.SSS1.p2.1.m1.3.3.2.2.2.3.cmml" type="integer" xref="S3.SS3.SSS1.p2.1.m1.3.3.2.2.2.3">2</cn></apply><ci id="S3.SS3.SSS1.p2.1.m1.1.1.cmml" xref="S3.SS3.SSS1.p2.1.m1.1.1">…</ci><apply id="S3.SS3.SSS1.p2.1.m1.4.4.3.3.3.cmml" xref="S3.SS3.SSS1.p2.1.m1.4.4.3.3.3"><csymbol cd="ambiguous" id="S3.SS3.SSS1.p2.1.m1.4.4.3.3.3.1.cmml" xref="S3.SS3.SSS1.p2.1.m1.4.4.3.3.3">subscript</csymbol><ci id="S3.SS3.SSS1.p2.1.m1.4.4.3.3.3.2.cmml" xref="S3.SS3.SSS1.p2.1.m1.4.4.3.3.3.2">𝑠</ci><ci id="S3.SS3.SSS1.p2.1.m1.4.4.3.3.3.3.cmml" xref="S3.SS3.SSS1.p2.1.m1.4.4.3.3.3.3">𝑁</ci></apply></set></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS1.p2.1.m1.4c">S=\{s_{1},s_{2},...,s_{N}\}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.SSS1.p2.1.m1.4d">italic_S = { italic_s start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT , italic_s start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT , … , italic_s start_POSTSUBSCRIPT italic_N end_POSTSUBSCRIPT }</annotation></semantics></math> represents the subtype documents set, where each document <math alttext="s_{n}" class="ltx_Math" display="inline" id="S3.SS3.SSS1.p2.2.m2.1"><semantics id="S3.SS3.SSS1.p2.2.m2.1a"><msub id="S3.SS3.SSS1.p2.2.m2.1.1" xref="S3.SS3.SSS1.p2.2.m2.1.1.cmml"><mi id="S3.SS3.SSS1.p2.2.m2.1.1.2" xref="S3.SS3.SSS1.p2.2.m2.1.1.2.cmml">s</mi><mi id="S3.SS3.SSS1.p2.2.m2.1.1.3" xref="S3.SS3.SSS1.p2.2.m2.1.1.3.cmml">n</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS1.p2.2.m2.1b"><apply id="S3.SS3.SSS1.p2.2.m2.1.1.cmml" xref="S3.SS3.SSS1.p2.2.m2.1.1"><csymbol cd="ambiguous" id="S3.SS3.SSS1.p2.2.m2.1.1.1.cmml" xref="S3.SS3.SSS1.p2.2.m2.1.1">subscript</csymbol><ci id="S3.SS3.SSS1.p2.2.m2.1.1.2.cmml" xref="S3.SS3.SSS1.p2.2.m2.1.1.2">𝑠</ci><ci id="S3.SS3.SSS1.p2.2.m2.1.1.3.cmml" xref="S3.SS3.SSS1.p2.2.m2.1.1.3">𝑛</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS1.p2.2.m2.1c">s_{n}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.SSS1.p2.2.m2.1d">italic_s start_POSTSUBSCRIPT italic_n end_POSTSUBSCRIPT</annotation></semantics></math> corresponds to the symptom descriptions of a specific depression subtype.
For a given user input <math alttext="u_{i}" class="ltx_Math" display="inline" id="S3.SS3.SSS1.p2.3.m3.1"><semantics id="S3.SS3.SSS1.p2.3.m3.1a"><msub id="S3.SS3.SSS1.p2.3.m3.1.1" xref="S3.SS3.SSS1.p2.3.m3.1.1.cmml"><mi id="S3.SS3.SSS1.p2.3.m3.1.1.2" xref="S3.SS3.SSS1.p2.3.m3.1.1.2.cmml">u</mi><mi id="S3.SS3.SSS1.p2.3.m3.1.1.3" xref="S3.SS3.SSS1.p2.3.m3.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS1.p2.3.m3.1b"><apply id="S3.SS3.SSS1.p2.3.m3.1.1.cmml" xref="S3.SS3.SSS1.p2.3.m3.1.1"><csymbol cd="ambiguous" id="S3.SS3.SSS1.p2.3.m3.1.1.1.cmml" xref="S3.SS3.SSS1.p2.3.m3.1.1">subscript</csymbol><ci id="S3.SS3.SSS1.p2.3.m3.1.1.2.cmml" xref="S3.SS3.SSS1.p2.3.m3.1.1.2">𝑢</ci><ci id="S3.SS3.SSS1.p2.3.m3.1.1.3.cmml" xref="S3.SS3.SSS1.p2.3.m3.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS1.p2.3.m3.1c">u_{i}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.SSS1.p2.3.m3.1d">italic_u start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT</annotation></semantics></math>, and a document <math alttext="s_{n}" class="ltx_Math" display="inline" id="S3.SS3.SSS1.p2.4.m4.1"><semantics id="S3.SS3.SSS1.p2.4.m4.1a"><msub id="S3.SS3.SSS1.p2.4.m4.1.1" xref="S3.SS3.SSS1.p2.4.m4.1.1.cmml"><mi id="S3.SS3.SSS1.p2.4.m4.1.1.2" xref="S3.SS3.SSS1.p2.4.m4.1.1.2.cmml">s</mi><mi id="S3.SS3.SSS1.p2.4.m4.1.1.3" xref="S3.SS3.SSS1.p2.4.m4.1.1.3.cmml">n</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS1.p2.4.m4.1b"><apply id="S3.SS3.SSS1.p2.4.m4.1.1.cmml" xref="S3.SS3.SSS1.p2.4.m4.1.1"><csymbol cd="ambiguous" id="S3.SS3.SSS1.p2.4.m4.1.1.1.cmml" xref="S3.SS3.SSS1.p2.4.m4.1.1">subscript</csymbol><ci id="S3.SS3.SSS1.p2.4.m4.1.1.2.cmml" xref="S3.SS3.SSS1.p2.4.m4.1.1.2">𝑠</ci><ci id="S3.SS3.SSS1.p2.4.m4.1.1.3.cmml" xref="S3.SS3.SSS1.p2.4.m4.1.1.3">𝑛</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS1.p2.4.m4.1c">s_{n}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.SSS1.p2.4.m4.1d">italic_s start_POSTSUBSCRIPT italic_n end_POSTSUBSCRIPT</annotation></semantics></math>, we encode them into high-dimensional feature vectors using an embedding network <math alttext="f(*)" class="ltx_Math" display="inline" id="S3.SS3.SSS1.p2.5.m5.1"><semantics id="S3.SS3.SSS1.p2.5.m5.1a"><mrow id="S3.SS3.SSS1.p2.5.m5.1.2" xref="S3.SS3.SSS1.p2.5.m5.1.2.cmml"><mi id="S3.SS3.SSS1.p2.5.m5.1.2.2" xref="S3.SS3.SSS1.p2.5.m5.1.2.2.cmml">f</mi><mo id="S3.SS3.SSS1.p2.5.m5.1.2.1" xref="S3.SS3.SSS1.p2.5.m5.1.2.1.cmml">⁢</mo><mrow id="S3.SS3.SSS1.p2.5.m5.1.2.3.2" xref="S3.SS3.SSS1.p2.5.m5.1.2.cmml"><mo id="S3.SS3.SSS1.p2.5.m5.1.2.3.2.1" stretchy="false" xref="S3.SS3.SSS1.p2.5.m5.1.2.cmml">(</mo><mo id="S3.SS3.SSS1.p2.5.m5.1.1" lspace="0em" rspace="0em" xref="S3.SS3.SSS1.p2.5.m5.1.1.cmml">∗</mo><mo id="S3.SS3.SSS1.p2.5.m5.1.2.3.2.2" stretchy="false" xref="S3.SS3.SSS1.p2.5.m5.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS1.p2.5.m5.1b"><apply id="S3.SS3.SSS1.p2.5.m5.1.2.cmml" xref="S3.SS3.SSS1.p2.5.m5.1.2"><times id="S3.SS3.SSS1.p2.5.m5.1.2.1.cmml" xref="S3.SS3.SSS1.p2.5.m5.1.2.1"></times><ci id="S3.SS3.SSS1.p2.5.m5.1.2.2.cmml" xref="S3.SS3.SSS1.p2.5.m5.1.2.2">𝑓</ci><times id="S3.SS3.SSS1.p2.5.m5.1.1.cmml" xref="S3.SS3.SSS1.p2.5.m5.1.1"></times></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS1.p2.5.m5.1c">f(*)</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.SSS1.p2.5.m5.1d">italic_f ( ∗ )</annotation></semantics></math>:</p>
<table class="ltx_equation ltx_eqn_table" id="S3.E6">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_left" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_left">(6)</span></td>
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\mathbf{u}_{i}=f(u_{i}),\quad\mathbf{s}_{n}=f(s_{n})\quad\text{for }i=1,2,%
\dots,I" class="ltx_Math" display="block" id="S3.E6.m1.6"><semantics id="S3.E6.m1.6a"><mrow id="S3.E6.m1.6.6.2" xref="S3.E6.m1.6.6.3.cmml"><mrow id="S3.E6.m1.5.5.1.1" xref="S3.E6.m1.5.5.1.1.cmml"><msub id="S3.E6.m1.5.5.1.1.3" xref="S3.E6.m1.5.5.1.1.3.cmml"><mi id="S3.E6.m1.5.5.1.1.3.2" xref="S3.E6.m1.5.5.1.1.3.2.cmml">𝐮</mi><mi id="S3.E6.m1.5.5.1.1.3.3" xref="S3.E6.m1.5.5.1.1.3.3.cmml">i</mi></msub><mo id="S3.E6.m1.5.5.1.1.2" xref="S3.E6.m1.5.5.1.1.2.cmml">=</mo><mrow id="S3.E6.m1.5.5.1.1.1" xref="S3.E6.m1.5.5.1.1.1.cmml"><mi id="S3.E6.m1.5.5.1.1.1.3" xref="S3.E6.m1.5.5.1.1.1.3.cmml">f</mi><mo id="S3.E6.m1.5.5.1.1.1.2" xref="S3.E6.m1.5.5.1.1.1.2.cmml">⁢</mo><mrow id="S3.E6.m1.5.5.1.1.1.1.1" xref="S3.E6.m1.5.5.1.1.1.1.1.1.cmml"><mo id="S3.E6.m1.5.5.1.1.1.1.1.2" stretchy="false" xref="S3.E6.m1.5.5.1.1.1.1.1.1.cmml">(</mo><msub id="S3.E6.m1.5.5.1.1.1.1.1.1" xref="S3.E6.m1.5.5.1.1.1.1.1.1.cmml"><mi id="S3.E6.m1.5.5.1.1.1.1.1.1.2" xref="S3.E6.m1.5.5.1.1.1.1.1.1.2.cmml">u</mi><mi id="S3.E6.m1.5.5.1.1.1.1.1.1.3" xref="S3.E6.m1.5.5.1.1.1.1.1.1.3.cmml">i</mi></msub><mo id="S3.E6.m1.5.5.1.1.1.1.1.3" stretchy="false" xref="S3.E6.m1.5.5.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><mo id="S3.E6.m1.6.6.2.3" rspace="1.167em" xref="S3.E6.m1.6.6.3a.cmml">,</mo><mrow id="S3.E6.m1.6.6.2.2.2" xref="S3.E6.m1.6.6.2.2.3.cmml"><mrow id="S3.E6.m1.6.6.2.2.1.1" xref="S3.E6.m1.6.6.2.2.1.1.cmml"><msub id="S3.E6.m1.6.6.2.2.1.1.3" xref="S3.E6.m1.6.6.2.2.1.1.3.cmml"><mi id="S3.E6.m1.6.6.2.2.1.1.3.2" xref="S3.E6.m1.6.6.2.2.1.1.3.2.cmml">𝐬</mi><mi id="S3.E6.m1.6.6.2.2.1.1.3.3" xref="S3.E6.m1.6.6.2.2.1.1.3.3.cmml">n</mi></msub><mo id="S3.E6.m1.6.6.2.2.1.1.2" xref="S3.E6.m1.6.6.2.2.1.1.2.cmml">=</mo><mrow id="S3.E6.m1.6.6.2.2.1.1.1" xref="S3.E6.m1.6.6.2.2.1.1.1.cmml"><mi id="S3.E6.m1.6.6.2.2.1.1.1.3" xref="S3.E6.m1.6.6.2.2.1.1.1.3.cmml">f</mi><mo id="S3.E6.m1.6.6.2.2.1.1.1.2" xref="S3.E6.m1.6.6.2.2.1.1.1.2.cmml">⁢</mo><mrow id="S3.E6.m1.6.6.2.2.1.1.1.1.1" xref="S3.E6.m1.6.6.2.2.1.1.1.1.1.1.cmml"><mo id="S3.E6.m1.6.6.2.2.1.1.1.1.1.2" stretchy="false" xref="S3.E6.m1.6.6.2.2.1.1.1.1.1.1.cmml">(</mo><msub id="S3.E6.m1.6.6.2.2.1.1.1.1.1.1" xref="S3.E6.m1.6.6.2.2.1.1.1.1.1.1.cmml"><mi id="S3.E6.m1.6.6.2.2.1.1.1.1.1.1.2" xref="S3.E6.m1.6.6.2.2.1.1.1.1.1.1.2.cmml">s</mi><mi id="S3.E6.m1.6.6.2.2.1.1.1.1.1.1.3" xref="S3.E6.m1.6.6.2.2.1.1.1.1.1.1.3.cmml">n</mi></msub><mo id="S3.E6.m1.6.6.2.2.1.1.1.1.1.3" stretchy="false" xref="S3.E6.m1.6.6.2.2.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><mspace id="S3.E6.m1.6.6.2.2.2.3" width="1em" xref="S3.E6.m1.6.6.2.2.3a.cmml"></mspace><mrow id="S3.E6.m1.6.6.2.2.2.2" xref="S3.E6.m1.6.6.2.2.2.2.cmml"><mrow id="S3.E6.m1.6.6.2.2.2.2.2" xref="S3.E6.m1.6.6.2.2.2.2.2.cmml"><mtext id="S3.E6.m1.6.6.2.2.2.2.2.2" xref="S3.E6.m1.6.6.2.2.2.2.2.2a.cmml">for </mtext><mo id="S3.E6.m1.6.6.2.2.2.2.2.1" xref="S3.E6.m1.6.6.2.2.2.2.2.1.cmml">⁢</mo><mi id="S3.E6.m1.6.6.2.2.2.2.2.3" xref="S3.E6.m1.6.6.2.2.2.2.2.3.cmml">i</mi></mrow><mo id="S3.E6.m1.6.6.2.2.2.2.1" xref="S3.E6.m1.6.6.2.2.2.2.1.cmml">=</mo><mrow id="S3.E6.m1.6.6.2.2.2.2.3.2" xref="S3.E6.m1.6.6.2.2.2.2.3.1.cmml"><mn id="S3.E6.m1.1.1" xref="S3.E6.m1.1.1.cmml">1</mn><mo id="S3.E6.m1.6.6.2.2.2.2.3.2.1" xref="S3.E6.m1.6.6.2.2.2.2.3.1.cmml">,</mo><mn id="S3.E6.m1.2.2" xref="S3.E6.m1.2.2.cmml">2</mn><mo id="S3.E6.m1.6.6.2.2.2.2.3.2.2" xref="S3.E6.m1.6.6.2.2.2.2.3.1.cmml">,</mo><mi id="S3.E6.m1.3.3" mathvariant="normal" xref="S3.E6.m1.3.3.cmml">…</mi><mo id="S3.E6.m1.6.6.2.2.2.2.3.2.3" xref="S3.E6.m1.6.6.2.2.2.2.3.1.cmml">,</mo><mi id="S3.E6.m1.4.4" xref="S3.E6.m1.4.4.cmml">I</mi></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.E6.m1.6b"><apply id="S3.E6.m1.6.6.3.cmml" xref="S3.E6.m1.6.6.2"><csymbol cd="ambiguous" id="S3.E6.m1.6.6.3a.cmml" xref="S3.E6.m1.6.6.2.3">formulae-sequence</csymbol><apply id="S3.E6.m1.5.5.1.1.cmml" xref="S3.E6.m1.5.5.1.1"><eq id="S3.E6.m1.5.5.1.1.2.cmml" xref="S3.E6.m1.5.5.1.1.2"></eq><apply id="S3.E6.m1.5.5.1.1.3.cmml" xref="S3.E6.m1.5.5.1.1.3"><csymbol cd="ambiguous" id="S3.E6.m1.5.5.1.1.3.1.cmml" xref="S3.E6.m1.5.5.1.1.3">subscript</csymbol><ci id="S3.E6.m1.5.5.1.1.3.2.cmml" xref="S3.E6.m1.5.5.1.1.3.2">𝐮</ci><ci id="S3.E6.m1.5.5.1.1.3.3.cmml" xref="S3.E6.m1.5.5.1.1.3.3">𝑖</ci></apply><apply id="S3.E6.m1.5.5.1.1.1.cmml" xref="S3.E6.m1.5.5.1.1.1"><times id="S3.E6.m1.5.5.1.1.1.2.cmml" xref="S3.E6.m1.5.5.1.1.1.2"></times><ci id="S3.E6.m1.5.5.1.1.1.3.cmml" xref="S3.E6.m1.5.5.1.1.1.3">𝑓</ci><apply id="S3.E6.m1.5.5.1.1.1.1.1.1.cmml" xref="S3.E6.m1.5.5.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E6.m1.5.5.1.1.1.1.1.1.1.cmml" xref="S3.E6.m1.5.5.1.1.1.1.1">subscript</csymbol><ci id="S3.E6.m1.5.5.1.1.1.1.1.1.2.cmml" xref="S3.E6.m1.5.5.1.1.1.1.1.1.2">𝑢</ci><ci id="S3.E6.m1.5.5.1.1.1.1.1.1.3.cmml" xref="S3.E6.m1.5.5.1.1.1.1.1.1.3">𝑖</ci></apply></apply></apply><apply id="S3.E6.m1.6.6.2.2.3.cmml" xref="S3.E6.m1.6.6.2.2.2"><csymbol cd="ambiguous" id="S3.E6.m1.6.6.2.2.3a.cmml" xref="S3.E6.m1.6.6.2.2.2.3">formulae-sequence</csymbol><apply id="S3.E6.m1.6.6.2.2.1.1.cmml" xref="S3.E6.m1.6.6.2.2.1.1"><eq id="S3.E6.m1.6.6.2.2.1.1.2.cmml" xref="S3.E6.m1.6.6.2.2.1.1.2"></eq><apply id="S3.E6.m1.6.6.2.2.1.1.3.cmml" xref="S3.E6.m1.6.6.2.2.1.1.3"><csymbol cd="ambiguous" id="S3.E6.m1.6.6.2.2.1.1.3.1.cmml" xref="S3.E6.m1.6.6.2.2.1.1.3">subscript</csymbol><ci id="S3.E6.m1.6.6.2.2.1.1.3.2.cmml" xref="S3.E6.m1.6.6.2.2.1.1.3.2">𝐬</ci><ci id="S3.E6.m1.6.6.2.2.1.1.3.3.cmml" xref="S3.E6.m1.6.6.2.2.1.1.3.3">𝑛</ci></apply><apply id="S3.E6.m1.6.6.2.2.1.1.1.cmml" xref="S3.E6.m1.6.6.2.2.1.1.1"><times id="S3.E6.m1.6.6.2.2.1.1.1.2.cmml" xref="S3.E6.m1.6.6.2.2.1.1.1.2"></times><ci id="S3.E6.m1.6.6.2.2.1.1.1.3.cmml" xref="S3.E6.m1.6.6.2.2.1.1.1.3">𝑓</ci><apply id="S3.E6.m1.6.6.2.2.1.1.1.1.1.1.cmml" xref="S3.E6.m1.6.6.2.2.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E6.m1.6.6.2.2.1.1.1.1.1.1.1.cmml" xref="S3.E6.m1.6.6.2.2.1.1.1.1.1">subscript</csymbol><ci id="S3.E6.m1.6.6.2.2.1.1.1.1.1.1.2.cmml" xref="S3.E6.m1.6.6.2.2.1.1.1.1.1.1.2">𝑠</ci><ci id="S3.E6.m1.6.6.2.2.1.1.1.1.1.1.3.cmml" xref="S3.E6.m1.6.6.2.2.1.1.1.1.1.1.3">𝑛</ci></apply></apply></apply><apply id="S3.E6.m1.6.6.2.2.2.2.cmml" xref="S3.E6.m1.6.6.2.2.2.2"><eq id="S3.E6.m1.6.6.2.2.2.2.1.cmml" xref="S3.E6.m1.6.6.2.2.2.2.1"></eq><apply id="S3.E6.m1.6.6.2.2.2.2.2.cmml" xref="S3.E6.m1.6.6.2.2.2.2.2"><times id="S3.E6.m1.6.6.2.2.2.2.2.1.cmml" xref="S3.E6.m1.6.6.2.2.2.2.2.1"></times><ci id="S3.E6.m1.6.6.2.2.2.2.2.2a.cmml" xref="S3.E6.m1.6.6.2.2.2.2.2.2"><mtext id="S3.E6.m1.6.6.2.2.2.2.2.2.cmml" xref="S3.E6.m1.6.6.2.2.2.2.2.2">for </mtext></ci><ci id="S3.E6.m1.6.6.2.2.2.2.2.3.cmml" xref="S3.E6.m1.6.6.2.2.2.2.2.3">𝑖</ci></apply><list id="S3.E6.m1.6.6.2.2.2.2.3.1.cmml" xref="S3.E6.m1.6.6.2.2.2.2.3.2"><cn id="S3.E6.m1.1.1.cmml" type="integer" xref="S3.E6.m1.1.1">1</cn><cn id="S3.E6.m1.2.2.cmml" type="integer" xref="S3.E6.m1.2.2">2</cn><ci id="S3.E6.m1.3.3.cmml" xref="S3.E6.m1.3.3">…</ci><ci id="S3.E6.m1.4.4.cmml" xref="S3.E6.m1.4.4">𝐼</ci></list></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E6.m1.6c">\mathbf{u}_{i}=f(u_{i}),\quad\mathbf{s}_{n}=f(s_{n})\quad\text{for }i=1,2,%
\dots,I</annotation><annotation encoding="application/x-llamapun" id="S3.E6.m1.6d">bold_u start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT = italic_f ( italic_u start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT ) , bold_s start_POSTSUBSCRIPT italic_n end_POSTSUBSCRIPT = italic_f ( italic_s start_POSTSUBSCRIPT italic_n end_POSTSUBSCRIPT ) for italic_i = 1 , 2 , … , italic_I</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S3.SS3.SSS1.p2.10">where <math alttext="\mathbf{u}_{i}\in\mathbb{R}^{k}" class="ltx_Math" display="inline" id="S3.SS3.SSS1.p2.6.m1.1"><semantics id="S3.SS3.SSS1.p2.6.m1.1a"><mrow id="S3.SS3.SSS1.p2.6.m1.1.1" xref="S3.SS3.SSS1.p2.6.m1.1.1.cmml"><msub id="S3.SS3.SSS1.p2.6.m1.1.1.2" xref="S3.SS3.SSS1.p2.6.m1.1.1.2.cmml"><mi id="S3.SS3.SSS1.p2.6.m1.1.1.2.2" xref="S3.SS3.SSS1.p2.6.m1.1.1.2.2.cmml">𝐮</mi><mi id="S3.SS3.SSS1.p2.6.m1.1.1.2.3" xref="S3.SS3.SSS1.p2.6.m1.1.1.2.3.cmml">i</mi></msub><mo id="S3.SS3.SSS1.p2.6.m1.1.1.1" xref="S3.SS3.SSS1.p2.6.m1.1.1.1.cmml">∈</mo><msup id="S3.SS3.SSS1.p2.6.m1.1.1.3" xref="S3.SS3.SSS1.p2.6.m1.1.1.3.cmml"><mi id="S3.SS3.SSS1.p2.6.m1.1.1.3.2" xref="S3.SS3.SSS1.p2.6.m1.1.1.3.2.cmml">ℝ</mi><mi id="S3.SS3.SSS1.p2.6.m1.1.1.3.3" xref="S3.SS3.SSS1.p2.6.m1.1.1.3.3.cmml">k</mi></msup></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS1.p2.6.m1.1b"><apply id="S3.SS3.SSS1.p2.6.m1.1.1.cmml" xref="S3.SS3.SSS1.p2.6.m1.1.1"><in id="S3.SS3.SSS1.p2.6.m1.1.1.1.cmml" xref="S3.SS3.SSS1.p2.6.m1.1.1.1"></in><apply id="S3.SS3.SSS1.p2.6.m1.1.1.2.cmml" xref="S3.SS3.SSS1.p2.6.m1.1.1.2"><csymbol cd="ambiguous" id="S3.SS3.SSS1.p2.6.m1.1.1.2.1.cmml" xref="S3.SS3.SSS1.p2.6.m1.1.1.2">subscript</csymbol><ci id="S3.SS3.SSS1.p2.6.m1.1.1.2.2.cmml" xref="S3.SS3.SSS1.p2.6.m1.1.1.2.2">𝐮</ci><ci id="S3.SS3.SSS1.p2.6.m1.1.1.2.3.cmml" xref="S3.SS3.SSS1.p2.6.m1.1.1.2.3">𝑖</ci></apply><apply id="S3.SS3.SSS1.p2.6.m1.1.1.3.cmml" xref="S3.SS3.SSS1.p2.6.m1.1.1.3"><csymbol cd="ambiguous" id="S3.SS3.SSS1.p2.6.m1.1.1.3.1.cmml" xref="S3.SS3.SSS1.p2.6.m1.1.1.3">superscript</csymbol><ci id="S3.SS3.SSS1.p2.6.m1.1.1.3.2.cmml" xref="S3.SS3.SSS1.p2.6.m1.1.1.3.2">ℝ</ci><ci id="S3.SS3.SSS1.p2.6.m1.1.1.3.3.cmml" xref="S3.SS3.SSS1.p2.6.m1.1.1.3.3">𝑘</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS1.p2.6.m1.1c">\mathbf{u}_{i}\in\mathbb{R}^{k}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.SSS1.p2.6.m1.1d">bold_u start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT ∈ blackboard_R start_POSTSUPERSCRIPT italic_k end_POSTSUPERSCRIPT</annotation></semantics></math> and <math alttext="\mathbf{s}_{n}\in\mathbb{R}^{k}" class="ltx_Math" display="inline" id="S3.SS3.SSS1.p2.7.m2.1"><semantics id="S3.SS3.SSS1.p2.7.m2.1a"><mrow id="S3.SS3.SSS1.p2.7.m2.1.1" xref="S3.SS3.SSS1.p2.7.m2.1.1.cmml"><msub id="S3.SS3.SSS1.p2.7.m2.1.1.2" xref="S3.SS3.SSS1.p2.7.m2.1.1.2.cmml"><mi id="S3.SS3.SSS1.p2.7.m2.1.1.2.2" xref="S3.SS3.SSS1.p2.7.m2.1.1.2.2.cmml">𝐬</mi><mi id="S3.SS3.SSS1.p2.7.m2.1.1.2.3" xref="S3.SS3.SSS1.p2.7.m2.1.1.2.3.cmml">n</mi></msub><mo id="S3.SS3.SSS1.p2.7.m2.1.1.1" xref="S3.SS3.SSS1.p2.7.m2.1.1.1.cmml">∈</mo><msup id="S3.SS3.SSS1.p2.7.m2.1.1.3" xref="S3.SS3.SSS1.p2.7.m2.1.1.3.cmml"><mi id="S3.SS3.SSS1.p2.7.m2.1.1.3.2" xref="S3.SS3.SSS1.p2.7.m2.1.1.3.2.cmml">ℝ</mi><mi id="S3.SS3.SSS1.p2.7.m2.1.1.3.3" xref="S3.SS3.SSS1.p2.7.m2.1.1.3.3.cmml">k</mi></msup></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS1.p2.7.m2.1b"><apply id="S3.SS3.SSS1.p2.7.m2.1.1.cmml" xref="S3.SS3.SSS1.p2.7.m2.1.1"><in id="S3.SS3.SSS1.p2.7.m2.1.1.1.cmml" xref="S3.SS3.SSS1.p2.7.m2.1.1.1"></in><apply id="S3.SS3.SSS1.p2.7.m2.1.1.2.cmml" xref="S3.SS3.SSS1.p2.7.m2.1.1.2"><csymbol cd="ambiguous" id="S3.SS3.SSS1.p2.7.m2.1.1.2.1.cmml" xref="S3.SS3.SSS1.p2.7.m2.1.1.2">subscript</csymbol><ci id="S3.SS3.SSS1.p2.7.m2.1.1.2.2.cmml" xref="S3.SS3.SSS1.p2.7.m2.1.1.2.2">𝐬</ci><ci id="S3.SS3.SSS1.p2.7.m2.1.1.2.3.cmml" xref="S3.SS3.SSS1.p2.7.m2.1.1.2.3">𝑛</ci></apply><apply id="S3.SS3.SSS1.p2.7.m2.1.1.3.cmml" xref="S3.SS3.SSS1.p2.7.m2.1.1.3"><csymbol cd="ambiguous" id="S3.SS3.SSS1.p2.7.m2.1.1.3.1.cmml" xref="S3.SS3.SSS1.p2.7.m2.1.1.3">superscript</csymbol><ci id="S3.SS3.SSS1.p2.7.m2.1.1.3.2.cmml" xref="S3.SS3.SSS1.p2.7.m2.1.1.3.2">ℝ</ci><ci id="S3.SS3.SSS1.p2.7.m2.1.1.3.3.cmml" xref="S3.SS3.SSS1.p2.7.m2.1.1.3.3">𝑘</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS1.p2.7.m2.1c">\mathbf{s}_{n}\in\mathbb{R}^{k}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.SSS1.p2.7.m2.1d">bold_s start_POSTSUBSCRIPT italic_n end_POSTSUBSCRIPT ∈ blackboard_R start_POSTSUPERSCRIPT italic_k end_POSTSUPERSCRIPT</annotation></semantics></math> are the resulting feature vectors, and <math alttext="k" class="ltx_Math" display="inline" id="S3.SS3.SSS1.p2.8.m3.1"><semantics id="S3.SS3.SSS1.p2.8.m3.1a"><mi id="S3.SS3.SSS1.p2.8.m3.1.1" xref="S3.SS3.SSS1.p2.8.m3.1.1.cmml">k</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS1.p2.8.m3.1b"><ci id="S3.SS3.SSS1.p2.8.m3.1.1.cmml" xref="S3.SS3.SSS1.p2.8.m3.1.1">𝑘</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS1.p2.8.m3.1c">k</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.SSS1.p2.8.m3.1d">italic_k</annotation></semantics></math> is the dimension of the embedding space.
Subsequently, the semantic similarity between the user input
<math alttext="\mathbf{u}_{i}" class="ltx_Math" display="inline" id="S3.SS3.SSS1.p2.9.m4.1"><semantics id="S3.SS3.SSS1.p2.9.m4.1a"><msub id="S3.SS3.SSS1.p2.9.m4.1.1" xref="S3.SS3.SSS1.p2.9.m4.1.1.cmml"><mi id="S3.SS3.SSS1.p2.9.m4.1.1.2" xref="S3.SS3.SSS1.p2.9.m4.1.1.2.cmml">𝐮</mi><mi id="S3.SS3.SSS1.p2.9.m4.1.1.3" xref="S3.SS3.SSS1.p2.9.m4.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS1.p2.9.m4.1b"><apply id="S3.SS3.SSS1.p2.9.m4.1.1.cmml" xref="S3.SS3.SSS1.p2.9.m4.1.1"><csymbol cd="ambiguous" id="S3.SS3.SSS1.p2.9.m4.1.1.1.cmml" xref="S3.SS3.SSS1.p2.9.m4.1.1">subscript</csymbol><ci id="S3.SS3.SSS1.p2.9.m4.1.1.2.cmml" xref="S3.SS3.SSS1.p2.9.m4.1.1.2">𝐮</ci><ci id="S3.SS3.SSS1.p2.9.m4.1.1.3.cmml" xref="S3.SS3.SSS1.p2.9.m4.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS1.p2.9.m4.1c">\mathbf{u}_{i}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.SSS1.p2.9.m4.1d">bold_u start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT</annotation></semantics></math> and each document <math alttext="\mathbf{s}_{n}" class="ltx_Math" display="inline" id="S3.SS3.SSS1.p2.10.m5.1"><semantics id="S3.SS3.SSS1.p2.10.m5.1a"><msub id="S3.SS3.SSS1.p2.10.m5.1.1" xref="S3.SS3.SSS1.p2.10.m5.1.1.cmml"><mi id="S3.SS3.SSS1.p2.10.m5.1.1.2" xref="S3.SS3.SSS1.p2.10.m5.1.1.2.cmml">𝐬</mi><mi id="S3.SS3.SSS1.p2.10.m5.1.1.3" xref="S3.SS3.SSS1.p2.10.m5.1.1.3.cmml">n</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS1.p2.10.m5.1b"><apply id="S3.SS3.SSS1.p2.10.m5.1.1.cmml" xref="S3.SS3.SSS1.p2.10.m5.1.1"><csymbol cd="ambiguous" id="S3.SS3.SSS1.p2.10.m5.1.1.1.cmml" xref="S3.SS3.SSS1.p2.10.m5.1.1">subscript</csymbol><ci id="S3.SS3.SSS1.p2.10.m5.1.1.2.cmml" xref="S3.SS3.SSS1.p2.10.m5.1.1.2">𝐬</ci><ci id="S3.SS3.SSS1.p2.10.m5.1.1.3.cmml" xref="S3.SS3.SSS1.p2.10.m5.1.1.3">𝑛</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS1.p2.10.m5.1c">\mathbf{s}_{n}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.SSS1.p2.10.m5.1d">bold_s start_POSTSUBSCRIPT italic_n end_POSTSUBSCRIPT</annotation></semantics></math> is computed using the cosine similarity:</p>
<table class="ltx_equation ltx_eqn_table" id="S3.E7">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_left" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_left">(7)</span></td>
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\text{sim}(\mathbf{u}_{i},\mathbf{s}_{n})=\frac{\mathbf{u}_{i}\cdot\mathbf{s}_%
{n}}{\|\mathbf{u_{i}}\|\|\mathbf{s}_{n}\|}" class="ltx_Math" display="block" id="S3.E7.m1.4"><semantics id="S3.E7.m1.4a"><mrow id="S3.E7.m1.4.4" xref="S3.E7.m1.4.4.cmml"><mrow id="S3.E7.m1.4.4.2" xref="S3.E7.m1.4.4.2.cmml"><mtext id="S3.E7.m1.4.4.2.4" xref="S3.E7.m1.4.4.2.4a.cmml">sim</mtext><mo id="S3.E7.m1.4.4.2.3" xref="S3.E7.m1.4.4.2.3.cmml">⁢</mo><mrow id="S3.E7.m1.4.4.2.2.2" xref="S3.E7.m1.4.4.2.2.3.cmml"><mo id="S3.E7.m1.4.4.2.2.2.3" stretchy="false" xref="S3.E7.m1.4.4.2.2.3.cmml">(</mo><msub id="S3.E7.m1.3.3.1.1.1.1" xref="S3.E7.m1.3.3.1.1.1.1.cmml"><mi id="S3.E7.m1.3.3.1.1.1.1.2" xref="S3.E7.m1.3.3.1.1.1.1.2.cmml">𝐮</mi><mi id="S3.E7.m1.3.3.1.1.1.1.3" xref="S3.E7.m1.3.3.1.1.1.1.3.cmml">i</mi></msub><mo id="S3.E7.m1.4.4.2.2.2.4" xref="S3.E7.m1.4.4.2.2.3.cmml">,</mo><msub id="S3.E7.m1.4.4.2.2.2.2" xref="S3.E7.m1.4.4.2.2.2.2.cmml"><mi id="S3.E7.m1.4.4.2.2.2.2.2" xref="S3.E7.m1.4.4.2.2.2.2.2.cmml">𝐬</mi><mi id="S3.E7.m1.4.4.2.2.2.2.3" xref="S3.E7.m1.4.4.2.2.2.2.3.cmml">n</mi></msub><mo id="S3.E7.m1.4.4.2.2.2.5" stretchy="false" xref="S3.E7.m1.4.4.2.2.3.cmml">)</mo></mrow></mrow><mo id="S3.E7.m1.4.4.3" xref="S3.E7.m1.4.4.3.cmml">=</mo><mfrac id="S3.E7.m1.2.2" xref="S3.E7.m1.2.2.cmml"><mrow id="S3.E7.m1.2.2.4" xref="S3.E7.m1.2.2.4.cmml"><msub id="S3.E7.m1.2.2.4.2" xref="S3.E7.m1.2.2.4.2.cmml"><mi id="S3.E7.m1.2.2.4.2.2" xref="S3.E7.m1.2.2.4.2.2.cmml">𝐮</mi><mi id="S3.E7.m1.2.2.4.2.3" xref="S3.E7.m1.2.2.4.2.3.cmml">i</mi></msub><mo id="S3.E7.m1.2.2.4.1" lspace="0.222em" rspace="0.222em" xref="S3.E7.m1.2.2.4.1.cmml">⋅</mo><msub id="S3.E7.m1.2.2.4.3" xref="S3.E7.m1.2.2.4.3.cmml"><mi id="S3.E7.m1.2.2.4.3.2" xref="S3.E7.m1.2.2.4.3.2.cmml">𝐬</mi><mi id="S3.E7.m1.2.2.4.3.3" xref="S3.E7.m1.2.2.4.3.3.cmml">n</mi></msub></mrow><mrow id="S3.E7.m1.2.2.2" xref="S3.E7.m1.2.2.2.cmml"><mrow id="S3.E7.m1.1.1.1.1.1" xref="S3.E7.m1.1.1.1.1.2.cmml"><mo id="S3.E7.m1.1.1.1.1.1.2" stretchy="false" xref="S3.E7.m1.1.1.1.1.2.1.cmml">‖</mo><msub id="S3.E7.m1.1.1.1.1.1.1" xref="S3.E7.m1.1.1.1.1.1.1.cmml"><mi id="S3.E7.m1.1.1.1.1.1.1.2" xref="S3.E7.m1.1.1.1.1.1.1.2.cmml">𝐮</mi><mi id="S3.E7.m1.1.1.1.1.1.1.3" xref="S3.E7.m1.1.1.1.1.1.1.3.cmml">𝐢</mi></msub><mo id="S3.E7.m1.1.1.1.1.1.3" stretchy="false" xref="S3.E7.m1.1.1.1.1.2.1.cmml">‖</mo></mrow><mo id="S3.E7.m1.2.2.2.3" xref="S3.E7.m1.2.2.2.3.cmml">⁢</mo><mrow id="S3.E7.m1.2.2.2.2.1" xref="S3.E7.m1.2.2.2.2.2.cmml"><mo id="S3.E7.m1.2.2.2.2.1.2" stretchy="false" xref="S3.E7.m1.2.2.2.2.2.1.cmml">‖</mo><msub id="S3.E7.m1.2.2.2.2.1.1" xref="S3.E7.m1.2.2.2.2.1.1.cmml"><mi id="S3.E7.m1.2.2.2.2.1.1.2" xref="S3.E7.m1.2.2.2.2.1.1.2.cmml">𝐬</mi><mi id="S3.E7.m1.2.2.2.2.1.1.3" xref="S3.E7.m1.2.2.2.2.1.1.3.cmml">n</mi></msub><mo id="S3.E7.m1.2.2.2.2.1.3" stretchy="false" xref="S3.E7.m1.2.2.2.2.2.1.cmml">‖</mo></mrow></mrow></mfrac></mrow><annotation-xml encoding="MathML-Content" id="S3.E7.m1.4b"><apply id="S3.E7.m1.4.4.cmml" xref="S3.E7.m1.4.4"><eq id="S3.E7.m1.4.4.3.cmml" xref="S3.E7.m1.4.4.3"></eq><apply id="S3.E7.m1.4.4.2.cmml" xref="S3.E7.m1.4.4.2"><times id="S3.E7.m1.4.4.2.3.cmml" xref="S3.E7.m1.4.4.2.3"></times><ci id="S3.E7.m1.4.4.2.4a.cmml" xref="S3.E7.m1.4.4.2.4"><mtext id="S3.E7.m1.4.4.2.4.cmml" xref="S3.E7.m1.4.4.2.4">sim</mtext></ci><interval closure="open" id="S3.E7.m1.4.4.2.2.3.cmml" xref="S3.E7.m1.4.4.2.2.2"><apply id="S3.E7.m1.3.3.1.1.1.1.cmml" xref="S3.E7.m1.3.3.1.1.1.1"><csymbol cd="ambiguous" id="S3.E7.m1.3.3.1.1.1.1.1.cmml" xref="S3.E7.m1.3.3.1.1.1.1">subscript</csymbol><ci id="S3.E7.m1.3.3.1.1.1.1.2.cmml" xref="S3.E7.m1.3.3.1.1.1.1.2">𝐮</ci><ci id="S3.E7.m1.3.3.1.1.1.1.3.cmml" xref="S3.E7.m1.3.3.1.1.1.1.3">𝑖</ci></apply><apply id="S3.E7.m1.4.4.2.2.2.2.cmml" xref="S3.E7.m1.4.4.2.2.2.2"><csymbol cd="ambiguous" id="S3.E7.m1.4.4.2.2.2.2.1.cmml" xref="S3.E7.m1.4.4.2.2.2.2">subscript</csymbol><ci id="S3.E7.m1.4.4.2.2.2.2.2.cmml" xref="S3.E7.m1.4.4.2.2.2.2.2">𝐬</ci><ci id="S3.E7.m1.4.4.2.2.2.2.3.cmml" xref="S3.E7.m1.4.4.2.2.2.2.3">𝑛</ci></apply></interval></apply><apply id="S3.E7.m1.2.2.cmml" xref="S3.E7.m1.2.2"><divide id="S3.E7.m1.2.2.3.cmml" xref="S3.E7.m1.2.2"></divide><apply id="S3.E7.m1.2.2.4.cmml" xref="S3.E7.m1.2.2.4"><ci id="S3.E7.m1.2.2.4.1.cmml" xref="S3.E7.m1.2.2.4.1">⋅</ci><apply id="S3.E7.m1.2.2.4.2.cmml" xref="S3.E7.m1.2.2.4.2"><csymbol cd="ambiguous" id="S3.E7.m1.2.2.4.2.1.cmml" xref="S3.E7.m1.2.2.4.2">subscript</csymbol><ci id="S3.E7.m1.2.2.4.2.2.cmml" xref="S3.E7.m1.2.2.4.2.2">𝐮</ci><ci id="S3.E7.m1.2.2.4.2.3.cmml" xref="S3.E7.m1.2.2.4.2.3">𝑖</ci></apply><apply id="S3.E7.m1.2.2.4.3.cmml" xref="S3.E7.m1.2.2.4.3"><csymbol cd="ambiguous" id="S3.E7.m1.2.2.4.3.1.cmml" xref="S3.E7.m1.2.2.4.3">subscript</csymbol><ci id="S3.E7.m1.2.2.4.3.2.cmml" xref="S3.E7.m1.2.2.4.3.2">𝐬</ci><ci id="S3.E7.m1.2.2.4.3.3.cmml" xref="S3.E7.m1.2.2.4.3.3">𝑛</ci></apply></apply><apply id="S3.E7.m1.2.2.2.cmml" xref="S3.E7.m1.2.2.2"><times id="S3.E7.m1.2.2.2.3.cmml" xref="S3.E7.m1.2.2.2.3"></times><apply id="S3.E7.m1.1.1.1.1.2.cmml" xref="S3.E7.m1.1.1.1.1.1"><csymbol cd="latexml" id="S3.E7.m1.1.1.1.1.2.1.cmml" xref="S3.E7.m1.1.1.1.1.1.2">norm</csymbol><apply id="S3.E7.m1.1.1.1.1.1.1.cmml" xref="S3.E7.m1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E7.m1.1.1.1.1.1.1.1.cmml" xref="S3.E7.m1.1.1.1.1.1.1">subscript</csymbol><ci id="S3.E7.m1.1.1.1.1.1.1.2.cmml" xref="S3.E7.m1.1.1.1.1.1.1.2">𝐮</ci><ci id="S3.E7.m1.1.1.1.1.1.1.3.cmml" xref="S3.E7.m1.1.1.1.1.1.1.3">𝐢</ci></apply></apply><apply id="S3.E7.m1.2.2.2.2.2.cmml" xref="S3.E7.m1.2.2.2.2.1"><csymbol cd="latexml" id="S3.E7.m1.2.2.2.2.2.1.cmml" xref="S3.E7.m1.2.2.2.2.1.2">norm</csymbol><apply id="S3.E7.m1.2.2.2.2.1.1.cmml" xref="S3.E7.m1.2.2.2.2.1.1"><csymbol cd="ambiguous" id="S3.E7.m1.2.2.2.2.1.1.1.cmml" xref="S3.E7.m1.2.2.2.2.1.1">subscript</csymbol><ci id="S3.E7.m1.2.2.2.2.1.1.2.cmml" xref="S3.E7.m1.2.2.2.2.1.1.2">𝐬</ci><ci id="S3.E7.m1.2.2.2.2.1.1.3.cmml" xref="S3.E7.m1.2.2.2.2.1.1.3">𝑛</ci></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E7.m1.4c">\text{sim}(\mathbf{u}_{i},\mathbf{s}_{n})=\frac{\mathbf{u}_{i}\cdot\mathbf{s}_%
{n}}{\|\mathbf{u_{i}}\|\|\mathbf{s}_{n}\|}</annotation><annotation encoding="application/x-llamapun" id="S3.E7.m1.4d">sim ( bold_u start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT , bold_s start_POSTSUBSCRIPT italic_n end_POSTSUBSCRIPT ) = divide start_ARG bold_u start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT ⋅ bold_s start_POSTSUBSCRIPT italic_n end_POSTSUBSCRIPT end_ARG start_ARG ∥ bold_u start_POSTSUBSCRIPT bold_i end_POSTSUBSCRIPT ∥ ∥ bold_s start_POSTSUBSCRIPT italic_n end_POSTSUBSCRIPT ∥ end_ARG</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S3.SS3.SSS1.p2.11">Here <math alttext="u_{i}" class="ltx_Math" display="inline" id="S3.SS3.SSS1.p2.11.m1.1"><semantics id="S3.SS3.SSS1.p2.11.m1.1a"><msub id="S3.SS3.SSS1.p2.11.m1.1.1" xref="S3.SS3.SSS1.p2.11.m1.1.1.cmml"><mi id="S3.SS3.SSS1.p2.11.m1.1.1.2" xref="S3.SS3.SSS1.p2.11.m1.1.1.2.cmml">u</mi><mi id="S3.SS3.SSS1.p2.11.m1.1.1.3" xref="S3.SS3.SSS1.p2.11.m1.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS1.p2.11.m1.1b"><apply id="S3.SS3.SSS1.p2.11.m1.1.1.cmml" xref="S3.SS3.SSS1.p2.11.m1.1.1"><csymbol cd="ambiguous" id="S3.SS3.SSS1.p2.11.m1.1.1.1.cmml" xref="S3.SS3.SSS1.p2.11.m1.1.1">subscript</csymbol><ci id="S3.SS3.SSS1.p2.11.m1.1.1.2.cmml" xref="S3.SS3.SSS1.p2.11.m1.1.1.2">𝑢</ci><ci id="S3.SS3.SSS1.p2.11.m1.1.1.3.cmml" xref="S3.SS3.SSS1.p2.11.m1.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS1.p2.11.m1.1c">u_{i}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.SSS1.p2.11.m1.1d">italic_u start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT</annotation></semantics></math> only uses the content from the user to conduct similarity computation.
The index of the document with the highest similarity score is selected as:</p>
<table class="ltx_equation ltx_eqn_table" id="S3.E8">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_left" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_left">(8)</span></td>
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="n^{*}=\arg\max_{n}\text{sim}(\mathbf{u}_{i},\mathbf{s}_{n})" class="ltx_Math" display="block" id="S3.E8.m1.2"><semantics id="S3.E8.m1.2a"><mrow id="S3.E8.m1.2.2" xref="S3.E8.m1.2.2.cmml"><msup id="S3.E8.m1.2.2.4" xref="S3.E8.m1.2.2.4.cmml"><mi id="S3.E8.m1.2.2.4.2" xref="S3.E8.m1.2.2.4.2.cmml">n</mi><mo id="S3.E8.m1.2.2.4.3" xref="S3.E8.m1.2.2.4.3.cmml">∗</mo></msup><mo id="S3.E8.m1.2.2.3" xref="S3.E8.m1.2.2.3.cmml">=</mo><mrow id="S3.E8.m1.2.2.2" xref="S3.E8.m1.2.2.2.cmml"><mrow id="S3.E8.m1.2.2.2.4" xref="S3.E8.m1.2.2.2.4.cmml"><mi id="S3.E8.m1.2.2.2.4.1" xref="S3.E8.m1.2.2.2.4.1.cmml">arg</mi><mo id="S3.E8.m1.2.2.2.4a" lspace="0.167em" xref="S3.E8.m1.2.2.2.4.cmml">⁡</mo><mrow id="S3.E8.m1.2.2.2.4.2" xref="S3.E8.m1.2.2.2.4.2.cmml"><munder id="S3.E8.m1.2.2.2.4.2.1" xref="S3.E8.m1.2.2.2.4.2.1.cmml"><mi id="S3.E8.m1.2.2.2.4.2.1.2" xref="S3.E8.m1.2.2.2.4.2.1.2.cmml">max</mi><mi id="S3.E8.m1.2.2.2.4.2.1.3" xref="S3.E8.m1.2.2.2.4.2.1.3.cmml">n</mi></munder><mo id="S3.E8.m1.2.2.2.4.2a" lspace="0.167em" xref="S3.E8.m1.2.2.2.4.2.cmml">⁡</mo><mtext id="S3.E8.m1.2.2.2.4.2.2" xref="S3.E8.m1.2.2.2.4.2.2a.cmml">sim</mtext></mrow></mrow><mo id="S3.E8.m1.2.2.2.3" xref="S3.E8.m1.2.2.2.3.cmml">⁢</mo><mrow id="S3.E8.m1.2.2.2.2.2" xref="S3.E8.m1.2.2.2.2.3.cmml"><mo id="S3.E8.m1.2.2.2.2.2.3" stretchy="false" xref="S3.E8.m1.2.2.2.2.3.cmml">(</mo><msub id="S3.E8.m1.1.1.1.1.1.1" xref="S3.E8.m1.1.1.1.1.1.1.cmml"><mi id="S3.E8.m1.1.1.1.1.1.1.2" xref="S3.E8.m1.1.1.1.1.1.1.2.cmml">𝐮</mi><mi id="S3.E8.m1.1.1.1.1.1.1.3" xref="S3.E8.m1.1.1.1.1.1.1.3.cmml">i</mi></msub><mo id="S3.E8.m1.2.2.2.2.2.4" xref="S3.E8.m1.2.2.2.2.3.cmml">,</mo><msub id="S3.E8.m1.2.2.2.2.2.2" xref="S3.E8.m1.2.2.2.2.2.2.cmml"><mi id="S3.E8.m1.2.2.2.2.2.2.2" xref="S3.E8.m1.2.2.2.2.2.2.2.cmml">𝐬</mi><mi id="S3.E8.m1.2.2.2.2.2.2.3" xref="S3.E8.m1.2.2.2.2.2.2.3.cmml">n</mi></msub><mo id="S3.E8.m1.2.2.2.2.2.5" stretchy="false" xref="S3.E8.m1.2.2.2.2.3.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.E8.m1.2b"><apply id="S3.E8.m1.2.2.cmml" xref="S3.E8.m1.2.2"><eq id="S3.E8.m1.2.2.3.cmml" xref="S3.E8.m1.2.2.3"></eq><apply id="S3.E8.m1.2.2.4.cmml" xref="S3.E8.m1.2.2.4"><csymbol cd="ambiguous" id="S3.E8.m1.2.2.4.1.cmml" xref="S3.E8.m1.2.2.4">superscript</csymbol><ci id="S3.E8.m1.2.2.4.2.cmml" xref="S3.E8.m1.2.2.4.2">𝑛</ci><times id="S3.E8.m1.2.2.4.3.cmml" xref="S3.E8.m1.2.2.4.3"></times></apply><apply id="S3.E8.m1.2.2.2.cmml" xref="S3.E8.m1.2.2.2"><times id="S3.E8.m1.2.2.2.3.cmml" xref="S3.E8.m1.2.2.2.3"></times><apply id="S3.E8.m1.2.2.2.4.cmml" xref="S3.E8.m1.2.2.2.4"><arg id="S3.E8.m1.2.2.2.4.1.cmml" xref="S3.E8.m1.2.2.2.4.1"></arg><apply id="S3.E8.m1.2.2.2.4.2.cmml" xref="S3.E8.m1.2.2.2.4.2"><apply id="S3.E8.m1.2.2.2.4.2.1.cmml" xref="S3.E8.m1.2.2.2.4.2.1"><csymbol cd="ambiguous" id="S3.E8.m1.2.2.2.4.2.1.1.cmml" xref="S3.E8.m1.2.2.2.4.2.1">subscript</csymbol><max id="S3.E8.m1.2.2.2.4.2.1.2.cmml" xref="S3.E8.m1.2.2.2.4.2.1.2"></max><ci id="S3.E8.m1.2.2.2.4.2.1.3.cmml" xref="S3.E8.m1.2.2.2.4.2.1.3">𝑛</ci></apply><ci id="S3.E8.m1.2.2.2.4.2.2a.cmml" xref="S3.E8.m1.2.2.2.4.2.2"><mtext id="S3.E8.m1.2.2.2.4.2.2.cmml" xref="S3.E8.m1.2.2.2.4.2.2">sim</mtext></ci></apply></apply><interval closure="open" id="S3.E8.m1.2.2.2.2.3.cmml" xref="S3.E8.m1.2.2.2.2.2"><apply id="S3.E8.m1.1.1.1.1.1.1.cmml" xref="S3.E8.m1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E8.m1.1.1.1.1.1.1.1.cmml" xref="S3.E8.m1.1.1.1.1.1.1">subscript</csymbol><ci id="S3.E8.m1.1.1.1.1.1.1.2.cmml" xref="S3.E8.m1.1.1.1.1.1.1.2">𝐮</ci><ci id="S3.E8.m1.1.1.1.1.1.1.3.cmml" xref="S3.E8.m1.1.1.1.1.1.1.3">𝑖</ci></apply><apply id="S3.E8.m1.2.2.2.2.2.2.cmml" xref="S3.E8.m1.2.2.2.2.2.2"><csymbol cd="ambiguous" id="S3.E8.m1.2.2.2.2.2.2.1.cmml" xref="S3.E8.m1.2.2.2.2.2.2">subscript</csymbol><ci id="S3.E8.m1.2.2.2.2.2.2.2.cmml" xref="S3.E8.m1.2.2.2.2.2.2.2">𝐬</ci><ci id="S3.E8.m1.2.2.2.2.2.2.3.cmml" xref="S3.E8.m1.2.2.2.2.2.2.3">𝑛</ci></apply></interval></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E8.m1.2c">n^{*}=\arg\max_{n}\text{sim}(\mathbf{u}_{i},\mathbf{s}_{n})</annotation><annotation encoding="application/x-llamapun" id="S3.E8.m1.2d">italic_n start_POSTSUPERSCRIPT ∗ end_POSTSUPERSCRIPT = roman_arg roman_max start_POSTSUBSCRIPT italic_n end_POSTSUBSCRIPT sim ( bold_u start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT , bold_s start_POSTSUBSCRIPT italic_n end_POSTSUBSCRIPT )</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S3.SS3.SSS1.p2.12">The document <math alttext="s_{n^{*}}" class="ltx_Math" display="inline" id="S3.SS3.SSS1.p2.12.m1.1"><semantics id="S3.SS3.SSS1.p2.12.m1.1a"><msub id="S3.SS3.SSS1.p2.12.m1.1.1" xref="S3.SS3.SSS1.p2.12.m1.1.1.cmml"><mi id="S3.SS3.SSS1.p2.12.m1.1.1.2" xref="S3.SS3.SSS1.p2.12.m1.1.1.2.cmml">s</mi><msup id="S3.SS3.SSS1.p2.12.m1.1.1.3" xref="S3.SS3.SSS1.p2.12.m1.1.1.3.cmml"><mi id="S3.SS3.SSS1.p2.12.m1.1.1.3.2" xref="S3.SS3.SSS1.p2.12.m1.1.1.3.2.cmml">n</mi><mo id="S3.SS3.SSS1.p2.12.m1.1.1.3.3" xref="S3.SS3.SSS1.p2.12.m1.1.1.3.3.cmml">∗</mo></msup></msub><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS1.p2.12.m1.1b"><apply id="S3.SS3.SSS1.p2.12.m1.1.1.cmml" xref="S3.SS3.SSS1.p2.12.m1.1.1"><csymbol cd="ambiguous" id="S3.SS3.SSS1.p2.12.m1.1.1.1.cmml" xref="S3.SS3.SSS1.p2.12.m1.1.1">subscript</csymbol><ci id="S3.SS3.SSS1.p2.12.m1.1.1.2.cmml" xref="S3.SS3.SSS1.p2.12.m1.1.1.2">𝑠</ci><apply id="S3.SS3.SSS1.p2.12.m1.1.1.3.cmml" xref="S3.SS3.SSS1.p2.12.m1.1.1.3"><csymbol cd="ambiguous" id="S3.SS3.SSS1.p2.12.m1.1.1.3.1.cmml" xref="S3.SS3.SSS1.p2.12.m1.1.1.3">superscript</csymbol><ci id="S3.SS3.SSS1.p2.12.m1.1.1.3.2.cmml" xref="S3.SS3.SSS1.p2.12.m1.1.1.3.2">𝑛</ci><times id="S3.SS3.SSS1.p2.12.m1.1.1.3.3.cmml" xref="S3.SS3.SSS1.p2.12.m1.1.1.3.3"></times></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS1.p2.12.m1.1c">s_{n^{*}}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.SSS1.p2.12.m1.1d">italic_s start_POSTSUBSCRIPT italic_n start_POSTSUPERSCRIPT ∗ end_POSTSUPERSCRIPT end_POSTSUBSCRIPT</annotation></semantics></math> is used as the diagnostic knowledge standard for the LLM.</p>
</div>
<figure class="ltx_figure" id="S3.F8">
<div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_2"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_figure_panel ltx_img_landscape" height="419" id="S3.F8.g1" src="extracted/5872729/8.png" width="538"/></div>
</div>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 8. </span>Prompt engineering for assistive diagnosis report generation. The text in red represents prior knowledge variables, where <math alttext="l,d_{i},s_{n^{*}}" class="ltx_Math" display="inline" id="S3.F8.3.m1.3"><semantics id="S3.F8.3.m1.3b"><mrow id="S3.F8.3.m1.3.3.2" xref="S3.F8.3.m1.3.3.3.cmml"><mi id="S3.F8.3.m1.1.1" xref="S3.F8.3.m1.1.1.cmml">l</mi><mo id="S3.F8.3.m1.3.3.2.3" xref="S3.F8.3.m1.3.3.3.cmml">,</mo><msub id="S3.F8.3.m1.2.2.1.1" xref="S3.F8.3.m1.2.2.1.1.cmml"><mi id="S3.F8.3.m1.2.2.1.1.2" xref="S3.F8.3.m1.2.2.1.1.2.cmml">d</mi><mi id="S3.F8.3.m1.2.2.1.1.3" xref="S3.F8.3.m1.2.2.1.1.3.cmml">i</mi></msub><mo id="S3.F8.3.m1.3.3.2.4" xref="S3.F8.3.m1.3.3.3.cmml">,</mo><msub id="S3.F8.3.m1.3.3.2.2" xref="S3.F8.3.m1.3.3.2.2.cmml"><mi id="S3.F8.3.m1.3.3.2.2.2" xref="S3.F8.3.m1.3.3.2.2.2.cmml">s</mi><msup id="S3.F8.3.m1.3.3.2.2.3" xref="S3.F8.3.m1.3.3.2.2.3.cmml"><mi id="S3.F8.3.m1.3.3.2.2.3.2" xref="S3.F8.3.m1.3.3.2.2.3.2.cmml">n</mi><mo id="S3.F8.3.m1.3.3.2.2.3.3" xref="S3.F8.3.m1.3.3.2.2.3.3.cmml">∗</mo></msup></msub></mrow><annotation-xml encoding="MathML-Content" id="S3.F8.3.m1.3c"><list id="S3.F8.3.m1.3.3.3.cmml" xref="S3.F8.3.m1.3.3.2"><ci id="S3.F8.3.m1.1.1.cmml" xref="S3.F8.3.m1.1.1">𝑙</ci><apply id="S3.F8.3.m1.2.2.1.1.cmml" xref="S3.F8.3.m1.2.2.1.1"><csymbol cd="ambiguous" id="S3.F8.3.m1.2.2.1.1.1.cmml" xref="S3.F8.3.m1.2.2.1.1">subscript</csymbol><ci id="S3.F8.3.m1.2.2.1.1.2.cmml" xref="S3.F8.3.m1.2.2.1.1.2">𝑑</ci><ci id="S3.F8.3.m1.2.2.1.1.3.cmml" xref="S3.F8.3.m1.2.2.1.1.3">𝑖</ci></apply><apply id="S3.F8.3.m1.3.3.2.2.cmml" xref="S3.F8.3.m1.3.3.2.2"><csymbol cd="ambiguous" id="S3.F8.3.m1.3.3.2.2.1.cmml" xref="S3.F8.3.m1.3.3.2.2">subscript</csymbol><ci id="S3.F8.3.m1.3.3.2.2.2.cmml" xref="S3.F8.3.m1.3.3.2.2.2">𝑠</ci><apply id="S3.F8.3.m1.3.3.2.2.3.cmml" xref="S3.F8.3.m1.3.3.2.2.3"><csymbol cd="ambiguous" id="S3.F8.3.m1.3.3.2.2.3.1.cmml" xref="S3.F8.3.m1.3.3.2.2.3">superscript</csymbol><ci id="S3.F8.3.m1.3.3.2.2.3.2.cmml" xref="S3.F8.3.m1.3.3.2.2.3.2">𝑛</ci><times id="S3.F8.3.m1.3.3.2.2.3.3.cmml" xref="S3.F8.3.m1.3.3.2.2.3.3"></times></apply></apply></list></annotation-xml><annotation encoding="application/x-tex" id="S3.F8.3.m1.3d">l,d_{i},s_{n^{*}}</annotation><annotation encoding="application/x-llamapun" id="S3.F8.3.m1.3e">italic_l , italic_d start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT , italic_s start_POSTSUBSCRIPT italic_n start_POSTSUPERSCRIPT ∗ end_POSTSUPERSCRIPT end_POSTSUBSCRIPT</annotation></semantics></math> and <math alttext="std" class="ltx_Math" display="inline" id="S3.F8.4.m2.1"><semantics id="S3.F8.4.m2.1b"><mrow id="S3.F8.4.m2.1.1" xref="S3.F8.4.m2.1.1.cmml"><mi id="S3.F8.4.m2.1.1.2" xref="S3.F8.4.m2.1.1.2.cmml">s</mi><mo id="S3.F8.4.m2.1.1.1" xref="S3.F8.4.m2.1.1.1.cmml">⁢</mo><mi id="S3.F8.4.m2.1.1.3" xref="S3.F8.4.m2.1.1.3.cmml">t</mi><mo id="S3.F8.4.m2.1.1.1b" xref="S3.F8.4.m2.1.1.1.cmml">⁢</mo><mi id="S3.F8.4.m2.1.1.4" xref="S3.F8.4.m2.1.1.4.cmml">d</mi></mrow><annotation-xml encoding="MathML-Content" id="S3.F8.4.m2.1c"><apply id="S3.F8.4.m2.1.1.cmml" xref="S3.F8.4.m2.1.1"><times id="S3.F8.4.m2.1.1.1.cmml" xref="S3.F8.4.m2.1.1.1"></times><ci id="S3.F8.4.m2.1.1.2.cmml" xref="S3.F8.4.m2.1.1.2">𝑠</ci><ci id="S3.F8.4.m2.1.1.3.cmml" xref="S3.F8.4.m2.1.1.3">𝑡</ci><ci id="S3.F8.4.m2.1.1.4.cmml" xref="S3.F8.4.m2.1.1.4">𝑑</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.F8.4.m2.1d">std</annotation><annotation encoding="application/x-llamapun" id="S3.F8.4.m2.1e">italic_s italic_t italic_d</annotation></semantics></math> represent label, dialogue, depression subtype diagnostic standard, and severity standard, respectively.</figcaption><div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_1"><span class="ltx_ERROR ltx_centering ltx_figure_panel undefined" id="S3.F8.5">\Description</span></div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_1">
<p class="ltx_p ltx_figure_panel ltx_align_center" id="S3.F8.6">This figure shows the prompt we designed for generating the assistive diagnostic report.</p>
</div>
</div>
</figure>
</section>
<section class="ltx_subsubsection" id="S3.SS3.SSS2">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">3.3.2. </span>Augmented Generation with Chain-of-thoughts</h4>
<div class="ltx_para" id="S3.SS3.SSS2.p1">
<p class="ltx_p" id="S3.SS3.SSS2.p1.1">Moreover, the retrieved document <math alttext="s_{n^{*}}" class="ltx_Math" display="inline" id="S3.SS3.SSS2.p1.1.m1.1"><semantics id="S3.SS3.SSS2.p1.1.m1.1a"><msub id="S3.SS3.SSS2.p1.1.m1.1.1" xref="S3.SS3.SSS2.p1.1.m1.1.1.cmml"><mi id="S3.SS3.SSS2.p1.1.m1.1.1.2" xref="S3.SS3.SSS2.p1.1.m1.1.1.2.cmml">s</mi><msup id="S3.SS3.SSS2.p1.1.m1.1.1.3" xref="S3.SS3.SSS2.p1.1.m1.1.1.3.cmml"><mi id="S3.SS3.SSS2.p1.1.m1.1.1.3.2" xref="S3.SS3.SSS2.p1.1.m1.1.1.3.2.cmml">n</mi><mo id="S3.SS3.SSS2.p1.1.m1.1.1.3.3" xref="S3.SS3.SSS2.p1.1.m1.1.1.3.3.cmml">∗</mo></msup></msub><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS2.p1.1.m1.1b"><apply id="S3.SS3.SSS2.p1.1.m1.1.1.cmml" xref="S3.SS3.SSS2.p1.1.m1.1.1"><csymbol cd="ambiguous" id="S3.SS3.SSS2.p1.1.m1.1.1.1.cmml" xref="S3.SS3.SSS2.p1.1.m1.1.1">subscript</csymbol><ci id="S3.SS3.SSS2.p1.1.m1.1.1.2.cmml" xref="S3.SS3.SSS2.p1.1.m1.1.1.2">𝑠</ci><apply id="S3.SS3.SSS2.p1.1.m1.1.1.3.cmml" xref="S3.SS3.SSS2.p1.1.m1.1.1.3"><csymbol cd="ambiguous" id="S3.SS3.SSS2.p1.1.m1.1.1.3.1.cmml" xref="S3.SS3.SSS2.p1.1.m1.1.1.3">superscript</csymbol><ci id="S3.SS3.SSS2.p1.1.m1.1.1.3.2.cmml" xref="S3.SS3.SSS2.p1.1.m1.1.1.3.2">𝑛</ci><times id="S3.SS3.SSS2.p1.1.m1.1.1.3.3.cmml" xref="S3.SS3.SSS2.p1.1.m1.1.1.3.3"></times></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS2.p1.1.m1.1c">s_{n^{*}}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.SSS2.p1.1.m1.1d">italic_s start_POSTSUBSCRIPT italic_n start_POSTSUPERSCRIPT ∗ end_POSTSUPERSCRIPT end_POSTSUBSCRIPT</annotation></semantics></math>, along with the original dialogue label and severity standard, are provided as prior knowledge to GPT-4. We leverage this prior knowledge combined with prompt engineering to generate professional and accurate reports. Specifically, we design assistive diagnosis report prompt engineering. As shown in Figure <a class="ltx_ref" href="https://arxiv.org/html/2409.14878v1#S3.F8" title="Figure 8 ‣ 3.3.1. Diagnostic Criteria Knowledge Retrieval ‣ 3.3. AI Psychologist ‣ 3. Methodology ‣ InterMind: A Doctor-Patient-Family Interactive Depression Assessment System Empowered by Large Language Models"><span class="ltx_text ltx_ref_tag">8</span></a>, the prompt for generating an assistive diagnosis report consists of three parts:</p>
<table class="ltx_equation ltx_eqn_table" id="S3.E9">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_left" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_left">(9)</span></td>
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="P_{2}=T+C(l,d_{i},s_{n^{*}},std)+Q" class="ltx_Math" display="block" id="S3.E9.m1.4"><semantics id="S3.E9.m1.4a"><mrow id="S3.E9.m1.4.4" xref="S3.E9.m1.4.4.cmml"><msub id="S3.E9.m1.4.4.5" xref="S3.E9.m1.4.4.5.cmml"><mi id="S3.E9.m1.4.4.5.2" xref="S3.E9.m1.4.4.5.2.cmml">P</mi><mn id="S3.E9.m1.4.4.5.3" xref="S3.E9.m1.4.4.5.3.cmml">2</mn></msub><mo id="S3.E9.m1.4.4.4" xref="S3.E9.m1.4.4.4.cmml">=</mo><mrow id="S3.E9.m1.4.4.3" xref="S3.E9.m1.4.4.3.cmml"><mi id="S3.E9.m1.4.4.3.5" xref="S3.E9.m1.4.4.3.5.cmml">T</mi><mo id="S3.E9.m1.4.4.3.4" xref="S3.E9.m1.4.4.3.4.cmml">+</mo><mrow id="S3.E9.m1.4.4.3.3" xref="S3.E9.m1.4.4.3.3.cmml"><mi id="S3.E9.m1.4.4.3.3.5" xref="S3.E9.m1.4.4.3.3.5.cmml">C</mi><mo id="S3.E9.m1.4.4.3.3.4" xref="S3.E9.m1.4.4.3.3.4.cmml">⁢</mo><mrow id="S3.E9.m1.4.4.3.3.3.3" xref="S3.E9.m1.4.4.3.3.3.4.cmml"><mo id="S3.E9.m1.4.4.3.3.3.3.4" stretchy="false" xref="S3.E9.m1.4.4.3.3.3.4.cmml">(</mo><mi id="S3.E9.m1.1.1" xref="S3.E9.m1.1.1.cmml">l</mi><mo id="S3.E9.m1.4.4.3.3.3.3.5" xref="S3.E9.m1.4.4.3.3.3.4.cmml">,</mo><msub id="S3.E9.m1.2.2.1.1.1.1.1" xref="S3.E9.m1.2.2.1.1.1.1.1.cmml"><mi id="S3.E9.m1.2.2.1.1.1.1.1.2" xref="S3.E9.m1.2.2.1.1.1.1.1.2.cmml">d</mi><mi id="S3.E9.m1.2.2.1.1.1.1.1.3" xref="S3.E9.m1.2.2.1.1.1.1.1.3.cmml">i</mi></msub><mo id="S3.E9.m1.4.4.3.3.3.3.6" xref="S3.E9.m1.4.4.3.3.3.4.cmml">,</mo><msub id="S3.E9.m1.3.3.2.2.2.2.2" xref="S3.E9.m1.3.3.2.2.2.2.2.cmml"><mi id="S3.E9.m1.3.3.2.2.2.2.2.2" xref="S3.E9.m1.3.3.2.2.2.2.2.2.cmml">s</mi><msup id="S3.E9.m1.3.3.2.2.2.2.2.3" xref="S3.E9.m1.3.3.2.2.2.2.2.3.cmml"><mi id="S3.E9.m1.3.3.2.2.2.2.2.3.2" xref="S3.E9.m1.3.3.2.2.2.2.2.3.2.cmml">n</mi><mo id="S3.E9.m1.3.3.2.2.2.2.2.3.3" xref="S3.E9.m1.3.3.2.2.2.2.2.3.3.cmml">∗</mo></msup></msub><mo id="S3.E9.m1.4.4.3.3.3.3.7" xref="S3.E9.m1.4.4.3.3.3.4.cmml">,</mo><mrow id="S3.E9.m1.4.4.3.3.3.3.3" xref="S3.E9.m1.4.4.3.3.3.3.3.cmml"><mi id="S3.E9.m1.4.4.3.3.3.3.3.2" xref="S3.E9.m1.4.4.3.3.3.3.3.2.cmml">s</mi><mo id="S3.E9.m1.4.4.3.3.3.3.3.1" xref="S3.E9.m1.4.4.3.3.3.3.3.1.cmml">⁢</mo><mi id="S3.E9.m1.4.4.3.3.3.3.3.3" xref="S3.E9.m1.4.4.3.3.3.3.3.3.cmml">t</mi><mo id="S3.E9.m1.4.4.3.3.3.3.3.1a" xref="S3.E9.m1.4.4.3.3.3.3.3.1.cmml">⁢</mo><mi id="S3.E9.m1.4.4.3.3.3.3.3.4" xref="S3.E9.m1.4.4.3.3.3.3.3.4.cmml">d</mi></mrow><mo id="S3.E9.m1.4.4.3.3.3.3.8" stretchy="false" xref="S3.E9.m1.4.4.3.3.3.4.cmml">)</mo></mrow></mrow><mo id="S3.E9.m1.4.4.3.4a" xref="S3.E9.m1.4.4.3.4.cmml">+</mo><mi id="S3.E9.m1.4.4.3.6" xref="S3.E9.m1.4.4.3.6.cmml">Q</mi></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.E9.m1.4b"><apply id="S3.E9.m1.4.4.cmml" xref="S3.E9.m1.4.4"><eq id="S3.E9.m1.4.4.4.cmml" xref="S3.E9.m1.4.4.4"></eq><apply id="S3.E9.m1.4.4.5.cmml" xref="S3.E9.m1.4.4.5"><csymbol cd="ambiguous" id="S3.E9.m1.4.4.5.1.cmml" xref="S3.E9.m1.4.4.5">subscript</csymbol><ci id="S3.E9.m1.4.4.5.2.cmml" xref="S3.E9.m1.4.4.5.2">𝑃</ci><cn id="S3.E9.m1.4.4.5.3.cmml" type="integer" xref="S3.E9.m1.4.4.5.3">2</cn></apply><apply id="S3.E9.m1.4.4.3.cmml" xref="S3.E9.m1.4.4.3"><plus id="S3.E9.m1.4.4.3.4.cmml" xref="S3.E9.m1.4.4.3.4"></plus><ci id="S3.E9.m1.4.4.3.5.cmml" xref="S3.E9.m1.4.4.3.5">𝑇</ci><apply id="S3.E9.m1.4.4.3.3.cmml" xref="S3.E9.m1.4.4.3.3"><times id="S3.E9.m1.4.4.3.3.4.cmml" xref="S3.E9.m1.4.4.3.3.4"></times><ci id="S3.E9.m1.4.4.3.3.5.cmml" xref="S3.E9.m1.4.4.3.3.5">𝐶</ci><vector id="S3.E9.m1.4.4.3.3.3.4.cmml" xref="S3.E9.m1.4.4.3.3.3.3"><ci id="S3.E9.m1.1.1.cmml" xref="S3.E9.m1.1.1">𝑙</ci><apply id="S3.E9.m1.2.2.1.1.1.1.1.cmml" xref="S3.E9.m1.2.2.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E9.m1.2.2.1.1.1.1.1.1.cmml" xref="S3.E9.m1.2.2.1.1.1.1.1">subscript</csymbol><ci id="S3.E9.m1.2.2.1.1.1.1.1.2.cmml" xref="S3.E9.m1.2.2.1.1.1.1.1.2">𝑑</ci><ci id="S3.E9.m1.2.2.1.1.1.1.1.3.cmml" xref="S3.E9.m1.2.2.1.1.1.1.1.3">𝑖</ci></apply><apply id="S3.E9.m1.3.3.2.2.2.2.2.cmml" xref="S3.E9.m1.3.3.2.2.2.2.2"><csymbol cd="ambiguous" id="S3.E9.m1.3.3.2.2.2.2.2.1.cmml" xref="S3.E9.m1.3.3.2.2.2.2.2">subscript</csymbol><ci id="S3.E9.m1.3.3.2.2.2.2.2.2.cmml" xref="S3.E9.m1.3.3.2.2.2.2.2.2">𝑠</ci><apply id="S3.E9.m1.3.3.2.2.2.2.2.3.cmml" xref="S3.E9.m1.3.3.2.2.2.2.2.3"><csymbol cd="ambiguous" id="S3.E9.m1.3.3.2.2.2.2.2.3.1.cmml" xref="S3.E9.m1.3.3.2.2.2.2.2.3">superscript</csymbol><ci id="S3.E9.m1.3.3.2.2.2.2.2.3.2.cmml" xref="S3.E9.m1.3.3.2.2.2.2.2.3.2">𝑛</ci><times id="S3.E9.m1.3.3.2.2.2.2.2.3.3.cmml" xref="S3.E9.m1.3.3.2.2.2.2.2.3.3"></times></apply></apply><apply id="S3.E9.m1.4.4.3.3.3.3.3.cmml" xref="S3.E9.m1.4.4.3.3.3.3.3"><times id="S3.E9.m1.4.4.3.3.3.3.3.1.cmml" xref="S3.E9.m1.4.4.3.3.3.3.3.1"></times><ci id="S3.E9.m1.4.4.3.3.3.3.3.2.cmml" xref="S3.E9.m1.4.4.3.3.3.3.3.2">𝑠</ci><ci id="S3.E9.m1.4.4.3.3.3.3.3.3.cmml" xref="S3.E9.m1.4.4.3.3.3.3.3.3">𝑡</ci><ci id="S3.E9.m1.4.4.3.3.3.3.3.4.cmml" xref="S3.E9.m1.4.4.3.3.3.3.3.4">𝑑</ci></apply></vector></apply><ci id="S3.E9.m1.4.4.3.6.cmml" xref="S3.E9.m1.4.4.3.6">𝑄</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E9.m1.4c">P_{2}=T+C(l,d_{i},s_{n^{*}},std)+Q</annotation><annotation encoding="application/x-llamapun" id="S3.E9.m1.4d">italic_P start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT = italic_T + italic_C ( italic_l , italic_d start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT , italic_s start_POSTSUBSCRIPT italic_n start_POSTSUPERSCRIPT ∗ end_POSTSUPERSCRIPT end_POSTSUBSCRIPT , italic_s italic_t italic_d ) + italic_Q</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S3.SS3.SSS2.p1.8">where the instruction <math alttext="T" class="ltx_Math" display="inline" id="S3.SS3.SSS2.p1.2.m1.1"><semantics id="S3.SS3.SSS2.p1.2.m1.1a"><mi id="S3.SS3.SSS2.p1.2.m1.1.1" xref="S3.SS3.SSS2.p1.2.m1.1.1.cmml">T</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS2.p1.2.m1.1b"><ci id="S3.SS3.SSS2.p1.2.m1.1.1.cmml" xref="S3.SS3.SSS2.p1.2.m1.1.1">𝑇</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS2.p1.2.m1.1c">T</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.SSS2.p1.2.m1.1d">italic_T</annotation></semantics></math> describes the task and requires generating the report following the steps of the proposed chain-of-thoughts (CoT). CoT <math alttext="C" class="ltx_Math" display="inline" id="S3.SS3.SSS2.p1.3.m2.1"><semantics id="S3.SS3.SSS2.p1.3.m2.1a"><mi id="S3.SS3.SSS2.p1.3.m2.1.1" xref="S3.SS3.SSS2.p1.3.m2.1.1.cmml">C</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS2.p1.3.m2.1b"><ci id="S3.SS3.SSS2.p1.3.m2.1.1.cmml" xref="S3.SS3.SSS2.p1.3.m2.1.1">𝐶</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS2.p1.3.m2.1c">C</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.SSS2.p1.3.m2.1d">italic_C</annotation></semantics></math> guides the LLM to break down complex tasks into smaller, manageable steps, leading to more accurate and coherent outputs<cite class="ltx_cite ltx_citemacro_citep">(Zhang et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2409.14878v1#bib.bib49" title="">2022b</a>; Wei et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2409.14878v1#bib.bib39" title="">2022</a>; Wang et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2409.14878v1#bib.bib38" title="">2023</a>)</cite>. Thus, we leverage the concept of CoT by setting up four steps. Steps 1-2 guide the LLM to gradually analyze the emerging depression symptoms by combining the dialogue <math alttext="d_{i}" class="ltx_Math" display="inline" id="S3.SS3.SSS2.p1.4.m3.1"><semantics id="S3.SS3.SSS2.p1.4.m3.1a"><msub id="S3.SS3.SSS2.p1.4.m3.1.1" xref="S3.SS3.SSS2.p1.4.m3.1.1.cmml"><mi id="S3.SS3.SSS2.p1.4.m3.1.1.2" xref="S3.SS3.SSS2.p1.4.m3.1.1.2.cmml">d</mi><mi id="S3.SS3.SSS2.p1.4.m3.1.1.3" xref="S3.SS3.SSS2.p1.4.m3.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS2.p1.4.m3.1b"><apply id="S3.SS3.SSS2.p1.4.m3.1.1.cmml" xref="S3.SS3.SSS2.p1.4.m3.1.1"><csymbol cd="ambiguous" id="S3.SS3.SSS2.p1.4.m3.1.1.1.cmml" xref="S3.SS3.SSS2.p1.4.m3.1.1">subscript</csymbol><ci id="S3.SS3.SSS2.p1.4.m3.1.1.2.cmml" xref="S3.SS3.SSS2.p1.4.m3.1.1.2">𝑑</ci><ci id="S3.SS3.SSS2.p1.4.m3.1.1.3.cmml" xref="S3.SS3.SSS2.p1.4.m3.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS2.p1.4.m3.1c">d_{i}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.SSS2.p1.4.m3.1d">italic_d start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT</annotation></semantics></math> with the label <math alttext="l" class="ltx_Math" display="inline" id="S3.SS3.SSS2.p1.5.m4.1"><semantics id="S3.SS3.SSS2.p1.5.m4.1a"><mi id="S3.SS3.SSS2.p1.5.m4.1.1" xref="S3.SS3.SSS2.p1.5.m4.1.1.cmml">l</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS2.p1.5.m4.1b"><ci id="S3.SS3.SSS2.p1.5.m4.1.1.cmml" xref="S3.SS3.SSS2.p1.5.m4.1.1">𝑙</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS2.p1.5.m4.1c">l</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.SSS2.p1.5.m4.1d">italic_l</annotation></semantics></math>. Step 3 requires matching the symptoms with the relevant diagnostic criteria from the provided diagnostic standards document <math alttext="s_{n^{*}}" class="ltx_Math" display="inline" id="S3.SS3.SSS2.p1.6.m5.1"><semantics id="S3.SS3.SSS2.p1.6.m5.1a"><msub id="S3.SS3.SSS2.p1.6.m5.1.1" xref="S3.SS3.SSS2.p1.6.m5.1.1.cmml"><mi id="S3.SS3.SSS2.p1.6.m5.1.1.2" xref="S3.SS3.SSS2.p1.6.m5.1.1.2.cmml">s</mi><msup id="S3.SS3.SSS2.p1.6.m5.1.1.3" xref="S3.SS3.SSS2.p1.6.m5.1.1.3.cmml"><mi id="S3.SS3.SSS2.p1.6.m5.1.1.3.2" xref="S3.SS3.SSS2.p1.6.m5.1.1.3.2.cmml">n</mi><mo id="S3.SS3.SSS2.p1.6.m5.1.1.3.3" xref="S3.SS3.SSS2.p1.6.m5.1.1.3.3.cmml">∗</mo></msup></msub><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS2.p1.6.m5.1b"><apply id="S3.SS3.SSS2.p1.6.m5.1.1.cmml" xref="S3.SS3.SSS2.p1.6.m5.1.1"><csymbol cd="ambiguous" id="S3.SS3.SSS2.p1.6.m5.1.1.1.cmml" xref="S3.SS3.SSS2.p1.6.m5.1.1">subscript</csymbol><ci id="S3.SS3.SSS2.p1.6.m5.1.1.2.cmml" xref="S3.SS3.SSS2.p1.6.m5.1.1.2">𝑠</ci><apply id="S3.SS3.SSS2.p1.6.m5.1.1.3.cmml" xref="S3.SS3.SSS2.p1.6.m5.1.1.3"><csymbol cd="ambiguous" id="S3.SS3.SSS2.p1.6.m5.1.1.3.1.cmml" xref="S3.SS3.SSS2.p1.6.m5.1.1.3">superscript</csymbol><ci id="S3.SS3.SSS2.p1.6.m5.1.1.3.2.cmml" xref="S3.SS3.SSS2.p1.6.m5.1.1.3.2">𝑛</ci><times id="S3.SS3.SSS2.p1.6.m5.1.1.3.3.cmml" xref="S3.SS3.SSS2.p1.6.m5.1.1.3.3"></times></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS2.p1.6.m5.1c">s_{n^{*}}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.SSS2.p1.6.m5.1d">italic_s start_POSTSUBSCRIPT italic_n start_POSTSUPERSCRIPT ∗ end_POSTSUPERSCRIPT end_POSTSUBSCRIPT</annotation></semantics></math> and severity standard <math alttext="std" class="ltx_Math" display="inline" id="S3.SS3.SSS2.p1.7.m6.1"><semantics id="S3.SS3.SSS2.p1.7.m6.1a"><mrow id="S3.SS3.SSS2.p1.7.m6.1.1" xref="S3.SS3.SSS2.p1.7.m6.1.1.cmml"><mi id="S3.SS3.SSS2.p1.7.m6.1.1.2" xref="S3.SS3.SSS2.p1.7.m6.1.1.2.cmml">s</mi><mo id="S3.SS3.SSS2.p1.7.m6.1.1.1" xref="S3.SS3.SSS2.p1.7.m6.1.1.1.cmml">⁢</mo><mi id="S3.SS3.SSS2.p1.7.m6.1.1.3" xref="S3.SS3.SSS2.p1.7.m6.1.1.3.cmml">t</mi><mo id="S3.SS3.SSS2.p1.7.m6.1.1.1a" xref="S3.SS3.SSS2.p1.7.m6.1.1.1.cmml">⁢</mo><mi id="S3.SS3.SSS2.p1.7.m6.1.1.4" xref="S3.SS3.SSS2.p1.7.m6.1.1.4.cmml">d</mi></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS2.p1.7.m6.1b"><apply id="S3.SS3.SSS2.p1.7.m6.1.1.cmml" xref="S3.SS3.SSS2.p1.7.m6.1.1"><times id="S3.SS3.SSS2.p1.7.m6.1.1.1.cmml" xref="S3.SS3.SSS2.p1.7.m6.1.1.1"></times><ci id="S3.SS3.SSS2.p1.7.m6.1.1.2.cmml" xref="S3.SS3.SSS2.p1.7.m6.1.1.2">𝑠</ci><ci id="S3.SS3.SSS2.p1.7.m6.1.1.3.cmml" xref="S3.SS3.SSS2.p1.7.m6.1.1.3">𝑡</ci><ci id="S3.SS3.SSS2.p1.7.m6.1.1.4.cmml" xref="S3.SS3.SSS2.p1.7.m6.1.1.4">𝑑</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS2.p1.7.m6.1c">std</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.SSS2.p1.7.m6.1d">italic_s italic_t italic_d</annotation></semantics></math>. Step 4 instructs the LLM to predict the severity of depression based on the preceding information. In the query <math alttext="Q" class="ltx_Math" display="inline" id="S3.SS3.SSS2.p1.8.m7.1"><semantics id="S3.SS3.SSS2.p1.8.m7.1a"><mi id="S3.SS3.SSS2.p1.8.m7.1.1" xref="S3.SS3.SSS2.p1.8.m7.1.1.cmml">Q</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS2.p1.8.m7.1b"><ci id="S3.SS3.SSS2.p1.8.m7.1.1.cmml" xref="S3.SS3.SSS2.p1.8.m7.1.1">𝑄</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS2.p1.8.m7.1c">Q</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.SSS2.p1.8.m7.1d">italic_Q</annotation></semantics></math>, we require the LLM to output the report in a fixed JSON format.</p>
</div>
</section>
<section class="ltx_subsubsection" id="S3.SS3.SSS3">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">3.3.3. </span>Instruction Fine-tuning for AI Psychologist</h4>
<div class="ltx_para" id="S3.SS3.SSS3.p1">
<p class="ltx_p" id="S3.SS3.SSS3.p1.4">The reports generated based on each dialogue can serve as labels for the dialogues, thereby <math alttext="\mathcal{D}^{\prime}=\left\{(P_{2}^{\prime},d_{i},y_{i})\right\}_{i=1}^{I}" class="ltx_Math" display="inline" id="S3.SS3.SSS3.p1.1.m1.1"><semantics id="S3.SS3.SSS3.p1.1.m1.1a"><mrow id="S3.SS3.SSS3.p1.1.m1.1.1" xref="S3.SS3.SSS3.p1.1.m1.1.1.cmml"><msup id="S3.SS3.SSS3.p1.1.m1.1.1.3" xref="S3.SS3.SSS3.p1.1.m1.1.1.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS3.SSS3.p1.1.m1.1.1.3.2" xref="S3.SS3.SSS3.p1.1.m1.1.1.3.2.cmml">𝒟</mi><mo id="S3.SS3.SSS3.p1.1.m1.1.1.3.3" xref="S3.SS3.SSS3.p1.1.m1.1.1.3.3.cmml">′</mo></msup><mo id="S3.SS3.SSS3.p1.1.m1.1.1.2" xref="S3.SS3.SSS3.p1.1.m1.1.1.2.cmml">=</mo><msubsup id="S3.SS3.SSS3.p1.1.m1.1.1.1" xref="S3.SS3.SSS3.p1.1.m1.1.1.1.cmml"><mrow id="S3.SS3.SSS3.p1.1.m1.1.1.1.1.1.1" xref="S3.SS3.SSS3.p1.1.m1.1.1.1.1.1.2.cmml"><mo id="S3.SS3.SSS3.p1.1.m1.1.1.1.1.1.1.2" xref="S3.SS3.SSS3.p1.1.m1.1.1.1.1.1.2.cmml">{</mo><mrow id="S3.SS3.SSS3.p1.1.m1.1.1.1.1.1.1.1.3" xref="S3.SS3.SSS3.p1.1.m1.1.1.1.1.1.1.1.4.cmml"><mo id="S3.SS3.SSS3.p1.1.m1.1.1.1.1.1.1.1.3.4" stretchy="false" xref="S3.SS3.SSS3.p1.1.m1.1.1.1.1.1.1.1.4.cmml">(</mo><msubsup id="S3.SS3.SSS3.p1.1.m1.1.1.1.1.1.1.1.1.1" xref="S3.SS3.SSS3.p1.1.m1.1.1.1.1.1.1.1.1.1.cmml"><mi id="S3.SS3.SSS3.p1.1.m1.1.1.1.1.1.1.1.1.1.2.2" xref="S3.SS3.SSS3.p1.1.m1.1.1.1.1.1.1.1.1.1.2.2.cmml">P</mi><mn id="S3.SS3.SSS3.p1.1.m1.1.1.1.1.1.1.1.1.1.2.3" xref="S3.SS3.SSS3.p1.1.m1.1.1.1.1.1.1.1.1.1.2.3.cmml">2</mn><mo id="S3.SS3.SSS3.p1.1.m1.1.1.1.1.1.1.1.1.1.3" xref="S3.SS3.SSS3.p1.1.m1.1.1.1.1.1.1.1.1.1.3.cmml">′</mo></msubsup><mo id="S3.SS3.SSS3.p1.1.m1.1.1.1.1.1.1.1.3.5" xref="S3.SS3.SSS3.p1.1.m1.1.1.1.1.1.1.1.4.cmml">,</mo><msub id="S3.SS3.SSS3.p1.1.m1.1.1.1.1.1.1.1.2.2" xref="S3.SS3.SSS3.p1.1.m1.1.1.1.1.1.1.1.2.2.cmml"><mi id="S3.SS3.SSS3.p1.1.m1.1.1.1.1.1.1.1.2.2.2" xref="S3.SS3.SSS3.p1.1.m1.1.1.1.1.1.1.1.2.2.2.cmml">d</mi><mi id="S3.SS3.SSS3.p1.1.m1.1.1.1.1.1.1.1.2.2.3" xref="S3.SS3.SSS3.p1.1.m1.1.1.1.1.1.1.1.2.2.3.cmml">i</mi></msub><mo id="S3.SS3.SSS3.p1.1.m1.1.1.1.1.1.1.1.3.6" xref="S3.SS3.SSS3.p1.1.m1.1.1.1.1.1.1.1.4.cmml">,</mo><msub id="S3.SS3.SSS3.p1.1.m1.1.1.1.1.1.1.1.3.3" xref="S3.SS3.SSS3.p1.1.m1.1.1.1.1.1.1.1.3.3.cmml"><mi id="S3.SS3.SSS3.p1.1.m1.1.1.1.1.1.1.1.3.3.2" xref="S3.SS3.SSS3.p1.1.m1.1.1.1.1.1.1.1.3.3.2.cmml">y</mi><mi id="S3.SS3.SSS3.p1.1.m1.1.1.1.1.1.1.1.3.3.3" xref="S3.SS3.SSS3.p1.1.m1.1.1.1.1.1.1.1.3.3.3.cmml">i</mi></msub><mo id="S3.SS3.SSS3.p1.1.m1.1.1.1.1.1.1.1.3.7" stretchy="false" xref="S3.SS3.SSS3.p1.1.m1.1.1.1.1.1.1.1.4.cmml">)</mo></mrow><mo id="S3.SS3.SSS3.p1.1.m1.1.1.1.1.1.1.3" xref="S3.SS3.SSS3.p1.1.m1.1.1.1.1.1.2.cmml">}</mo></mrow><mrow id="S3.SS3.SSS3.p1.1.m1.1.1.1.1.3" xref="S3.SS3.SSS3.p1.1.m1.1.1.1.1.3.cmml"><mi id="S3.SS3.SSS3.p1.1.m1.1.1.1.1.3.2" xref="S3.SS3.SSS3.p1.1.m1.1.1.1.1.3.2.cmml">i</mi><mo id="S3.SS3.SSS3.p1.1.m1.1.1.1.1.3.1" xref="S3.SS3.SSS3.p1.1.m1.1.1.1.1.3.1.cmml">=</mo><mn id="S3.SS3.SSS3.p1.1.m1.1.1.1.1.3.3" xref="S3.SS3.SSS3.p1.1.m1.1.1.1.1.3.3.cmml">1</mn></mrow><mi id="S3.SS3.SSS3.p1.1.m1.1.1.1.3" xref="S3.SS3.SSS3.p1.1.m1.1.1.1.3.cmml">I</mi></msubsup></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS3.p1.1.m1.1b"><apply id="S3.SS3.SSS3.p1.1.m1.1.1.cmml" xref="S3.SS3.SSS3.p1.1.m1.1.1"><eq id="S3.SS3.SSS3.p1.1.m1.1.1.2.cmml" xref="S3.SS3.SSS3.p1.1.m1.1.1.2"></eq><apply id="S3.SS3.SSS3.p1.1.m1.1.1.3.cmml" xref="S3.SS3.SSS3.p1.1.m1.1.1.3"><csymbol cd="ambiguous" id="S3.SS3.SSS3.p1.1.m1.1.1.3.1.cmml" xref="S3.SS3.SSS3.p1.1.m1.1.1.3">superscript</csymbol><ci id="S3.SS3.SSS3.p1.1.m1.1.1.3.2.cmml" xref="S3.SS3.SSS3.p1.1.m1.1.1.3.2">𝒟</ci><ci id="S3.SS3.SSS3.p1.1.m1.1.1.3.3.cmml" xref="S3.SS3.SSS3.p1.1.m1.1.1.3.3">′</ci></apply><apply id="S3.SS3.SSS3.p1.1.m1.1.1.1.cmml" xref="S3.SS3.SSS3.p1.1.m1.1.1.1"><csymbol cd="ambiguous" id="S3.SS3.SSS3.p1.1.m1.1.1.1.2.cmml" xref="S3.SS3.SSS3.p1.1.m1.1.1.1">superscript</csymbol><apply id="S3.SS3.SSS3.p1.1.m1.1.1.1.1.cmml" xref="S3.SS3.SSS3.p1.1.m1.1.1.1"><csymbol cd="ambiguous" id="S3.SS3.SSS3.p1.1.m1.1.1.1.1.2.cmml" xref="S3.SS3.SSS3.p1.1.m1.1.1.1">subscript</csymbol><set id="S3.SS3.SSS3.p1.1.m1.1.1.1.1.1.2.cmml" xref="S3.SS3.SSS3.p1.1.m1.1.1.1.1.1.1"><vector id="S3.SS3.SSS3.p1.1.m1.1.1.1.1.1.1.1.4.cmml" xref="S3.SS3.SSS3.p1.1.m1.1.1.1.1.1.1.1.3"><apply id="S3.SS3.SSS3.p1.1.m1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.SS3.SSS3.p1.1.m1.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS3.SSS3.p1.1.m1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.SS3.SSS3.p1.1.m1.1.1.1.1.1.1.1.1.1">superscript</csymbol><apply id="S3.SS3.SSS3.p1.1.m1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S3.SS3.SSS3.p1.1.m1.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS3.SSS3.p1.1.m1.1.1.1.1.1.1.1.1.1.2.1.cmml" xref="S3.SS3.SSS3.p1.1.m1.1.1.1.1.1.1.1.1.1">subscript</csymbol><ci id="S3.SS3.SSS3.p1.1.m1.1.1.1.1.1.1.1.1.1.2.2.cmml" xref="S3.SS3.SSS3.p1.1.m1.1.1.1.1.1.1.1.1.1.2.2">𝑃</ci><cn id="S3.SS3.SSS3.p1.1.m1.1.1.1.1.1.1.1.1.1.2.3.cmml" type="integer" xref="S3.SS3.SSS3.p1.1.m1.1.1.1.1.1.1.1.1.1.2.3">2</cn></apply><ci id="S3.SS3.SSS3.p1.1.m1.1.1.1.1.1.1.1.1.1.3.cmml" xref="S3.SS3.SSS3.p1.1.m1.1.1.1.1.1.1.1.1.1.3">′</ci></apply><apply id="S3.SS3.SSS3.p1.1.m1.1.1.1.1.1.1.1.2.2.cmml" xref="S3.SS3.SSS3.p1.1.m1.1.1.1.1.1.1.1.2.2"><csymbol cd="ambiguous" id="S3.SS3.SSS3.p1.1.m1.1.1.1.1.1.1.1.2.2.1.cmml" xref="S3.SS3.SSS3.p1.1.m1.1.1.1.1.1.1.1.2.2">subscript</csymbol><ci id="S3.SS3.SSS3.p1.1.m1.1.1.1.1.1.1.1.2.2.2.cmml" xref="S3.SS3.SSS3.p1.1.m1.1.1.1.1.1.1.1.2.2.2">𝑑</ci><ci id="S3.SS3.SSS3.p1.1.m1.1.1.1.1.1.1.1.2.2.3.cmml" xref="S3.SS3.SSS3.p1.1.m1.1.1.1.1.1.1.1.2.2.3">𝑖</ci></apply><apply id="S3.SS3.SSS3.p1.1.m1.1.1.1.1.1.1.1.3.3.cmml" xref="S3.SS3.SSS3.p1.1.m1.1.1.1.1.1.1.1.3.3"><csymbol cd="ambiguous" id="S3.SS3.SSS3.p1.1.m1.1.1.1.1.1.1.1.3.3.1.cmml" xref="S3.SS3.SSS3.p1.1.m1.1.1.1.1.1.1.1.3.3">subscript</csymbol><ci id="S3.SS3.SSS3.p1.1.m1.1.1.1.1.1.1.1.3.3.2.cmml" xref="S3.SS3.SSS3.p1.1.m1.1.1.1.1.1.1.1.3.3.2">𝑦</ci><ci id="S3.SS3.SSS3.p1.1.m1.1.1.1.1.1.1.1.3.3.3.cmml" xref="S3.SS3.SSS3.p1.1.m1.1.1.1.1.1.1.1.3.3.3">𝑖</ci></apply></vector></set><apply id="S3.SS3.SSS3.p1.1.m1.1.1.1.1.3.cmml" xref="S3.SS3.SSS3.p1.1.m1.1.1.1.1.3"><eq id="S3.SS3.SSS3.p1.1.m1.1.1.1.1.3.1.cmml" xref="S3.SS3.SSS3.p1.1.m1.1.1.1.1.3.1"></eq><ci id="S3.SS3.SSS3.p1.1.m1.1.1.1.1.3.2.cmml" xref="S3.SS3.SSS3.p1.1.m1.1.1.1.1.3.2">𝑖</ci><cn id="S3.SS3.SSS3.p1.1.m1.1.1.1.1.3.3.cmml" type="integer" xref="S3.SS3.SSS3.p1.1.m1.1.1.1.1.3.3">1</cn></apply></apply><ci id="S3.SS3.SSS3.p1.1.m1.1.1.1.3.cmml" xref="S3.SS3.SSS3.p1.1.m1.1.1.1.3">𝐼</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS3.p1.1.m1.1c">\mathcal{D}^{\prime}=\left\{(P_{2}^{\prime},d_{i},y_{i})\right\}_{i=1}^{I}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.SSS3.p1.1.m1.1d">caligraphic_D start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT = { ( italic_P start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT , italic_d start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT , italic_y start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT ) } start_POSTSUBSCRIPT italic_i = 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_I end_POSTSUPERSCRIPT</annotation></semantics></math> facilitating the construction of instruction fine-tuning, where <math alttext="y_{i}" class="ltx_Math" display="inline" id="S3.SS3.SSS3.p1.2.m2.1"><semantics id="S3.SS3.SSS3.p1.2.m2.1a"><msub id="S3.SS3.SSS3.p1.2.m2.1.1" xref="S3.SS3.SSS3.p1.2.m2.1.1.cmml"><mi id="S3.SS3.SSS3.p1.2.m2.1.1.2" xref="S3.SS3.SSS3.p1.2.m2.1.1.2.cmml">y</mi><mi id="S3.SS3.SSS3.p1.2.m2.1.1.3" xref="S3.SS3.SSS3.p1.2.m2.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS3.p1.2.m2.1b"><apply id="S3.SS3.SSS3.p1.2.m2.1.1.cmml" xref="S3.SS3.SSS3.p1.2.m2.1.1"><csymbol cd="ambiguous" id="S3.SS3.SSS3.p1.2.m2.1.1.1.cmml" xref="S3.SS3.SSS3.p1.2.m2.1.1">subscript</csymbol><ci id="S3.SS3.SSS3.p1.2.m2.1.1.2.cmml" xref="S3.SS3.SSS3.p1.2.m2.1.1.2">𝑦</ci><ci id="S3.SS3.SSS3.p1.2.m2.1.1.3.cmml" xref="S3.SS3.SSS3.p1.2.m2.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS3.p1.2.m2.1c">y_{i}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.SSS3.p1.2.m2.1d">italic_y start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT</annotation></semantics></math> represents assistive diagnosis report. Here <math alttext="P_{2}^{\prime}" class="ltx_Math" display="inline" id="S3.SS3.SSS3.p1.3.m3.1"><semantics id="S3.SS3.SSS3.p1.3.m3.1a"><msubsup id="S3.SS3.SSS3.p1.3.m3.1.1" xref="S3.SS3.SSS3.p1.3.m3.1.1.cmml"><mi id="S3.SS3.SSS3.p1.3.m3.1.1.2.2" xref="S3.SS3.SSS3.p1.3.m3.1.1.2.2.cmml">P</mi><mn id="S3.SS3.SSS3.p1.3.m3.1.1.2.3" xref="S3.SS3.SSS3.p1.3.m3.1.1.2.3.cmml">2</mn><mo id="S3.SS3.SSS3.p1.3.m3.1.1.3" xref="S3.SS3.SSS3.p1.3.m3.1.1.3.cmml">′</mo></msubsup><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS3.p1.3.m3.1b"><apply id="S3.SS3.SSS3.p1.3.m3.1.1.cmml" xref="S3.SS3.SSS3.p1.3.m3.1.1"><csymbol cd="ambiguous" id="S3.SS3.SSS3.p1.3.m3.1.1.1.cmml" xref="S3.SS3.SSS3.p1.3.m3.1.1">superscript</csymbol><apply id="S3.SS3.SSS3.p1.3.m3.1.1.2.cmml" xref="S3.SS3.SSS3.p1.3.m3.1.1"><csymbol cd="ambiguous" id="S3.SS3.SSS3.p1.3.m3.1.1.2.1.cmml" xref="S3.SS3.SSS3.p1.3.m3.1.1">subscript</csymbol><ci id="S3.SS3.SSS3.p1.3.m3.1.1.2.2.cmml" xref="S3.SS3.SSS3.p1.3.m3.1.1.2.2">𝑃</ci><cn id="S3.SS3.SSS3.p1.3.m3.1.1.2.3.cmml" type="integer" xref="S3.SS3.SSS3.p1.3.m3.1.1.2.3">2</cn></apply><ci id="S3.SS3.SSS3.p1.3.m3.1.1.3.cmml" xref="S3.SS3.SSS3.p1.3.m3.1.1.3">′</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS3.p1.3.m3.1c">P_{2}^{\prime}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.SSS3.p1.3.m3.1d">italic_P start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT</annotation></semantics></math> represents the instruction obtained by removing the prior knowledge such as label and diagnostic standard from <math alttext="P_{2}" class="ltx_Math" display="inline" id="S3.SS3.SSS3.p1.4.m4.1"><semantics id="S3.SS3.SSS3.p1.4.m4.1a"><msub id="S3.SS3.SSS3.p1.4.m4.1.1" xref="S3.SS3.SSS3.p1.4.m4.1.1.cmml"><mi id="S3.SS3.SSS3.p1.4.m4.1.1.2" xref="S3.SS3.SSS3.p1.4.m4.1.1.2.cmml">P</mi><mn id="S3.SS3.SSS3.p1.4.m4.1.1.3" xref="S3.SS3.SSS3.p1.4.m4.1.1.3.cmml">2</mn></msub><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS3.p1.4.m4.1b"><apply id="S3.SS3.SSS3.p1.4.m4.1.1.cmml" xref="S3.SS3.SSS3.p1.4.m4.1.1"><csymbol cd="ambiguous" id="S3.SS3.SSS3.p1.4.m4.1.1.1.cmml" xref="S3.SS3.SSS3.p1.4.m4.1.1">subscript</csymbol><ci id="S3.SS3.SSS3.p1.4.m4.1.1.2.cmml" xref="S3.SS3.SSS3.p1.4.m4.1.1.2">𝑃</ci><cn id="S3.SS3.SSS3.p1.4.m4.1.1.3.cmml" type="integer" xref="S3.SS3.SSS3.p1.4.m4.1.1.3">2</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS3.p1.4.m4.1c">P_{2}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.SSS3.p1.4.m4.1d">italic_P start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT</annotation></semantics></math>:</p>
<table class="ltx_equation ltx_eqn_table" id="S3.E10">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_left" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_left">(10)</span></td>
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="P_{2}^{\prime}=T+C(d_{i})+Q" class="ltx_Math" display="block" id="S3.E10.m1.1"><semantics id="S3.E10.m1.1a"><mrow id="S3.E10.m1.1.1" xref="S3.E10.m1.1.1.cmml"><msubsup id="S3.E10.m1.1.1.3" xref="S3.E10.m1.1.1.3.cmml"><mi id="S3.E10.m1.1.1.3.2.2" xref="S3.E10.m1.1.1.3.2.2.cmml">P</mi><mn id="S3.E10.m1.1.1.3.2.3" xref="S3.E10.m1.1.1.3.2.3.cmml">2</mn><mo id="S3.E10.m1.1.1.3.3" xref="S3.E10.m1.1.1.3.3.cmml">′</mo></msubsup><mo id="S3.E10.m1.1.1.2" xref="S3.E10.m1.1.1.2.cmml">=</mo><mrow id="S3.E10.m1.1.1.1" xref="S3.E10.m1.1.1.1.cmml"><mi id="S3.E10.m1.1.1.1.3" xref="S3.E10.m1.1.1.1.3.cmml">T</mi><mo id="S3.E10.m1.1.1.1.2" xref="S3.E10.m1.1.1.1.2.cmml">+</mo><mrow id="S3.E10.m1.1.1.1.1" xref="S3.E10.m1.1.1.1.1.cmml"><mi id="S3.E10.m1.1.1.1.1.3" xref="S3.E10.m1.1.1.1.1.3.cmml">C</mi><mo id="S3.E10.m1.1.1.1.1.2" xref="S3.E10.m1.1.1.1.1.2.cmml">⁢</mo><mrow id="S3.E10.m1.1.1.1.1.1.1" xref="S3.E10.m1.1.1.1.1.1.1.1.cmml"><mo id="S3.E10.m1.1.1.1.1.1.1.2" stretchy="false" xref="S3.E10.m1.1.1.1.1.1.1.1.cmml">(</mo><msub id="S3.E10.m1.1.1.1.1.1.1.1" xref="S3.E10.m1.1.1.1.1.1.1.1.cmml"><mi id="S3.E10.m1.1.1.1.1.1.1.1.2" xref="S3.E10.m1.1.1.1.1.1.1.1.2.cmml">d</mi><mi id="S3.E10.m1.1.1.1.1.1.1.1.3" xref="S3.E10.m1.1.1.1.1.1.1.1.3.cmml">i</mi></msub><mo id="S3.E10.m1.1.1.1.1.1.1.3" stretchy="false" xref="S3.E10.m1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S3.E10.m1.1.1.1.2a" xref="S3.E10.m1.1.1.1.2.cmml">+</mo><mi id="S3.E10.m1.1.1.1.4" xref="S3.E10.m1.1.1.1.4.cmml">Q</mi></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.E10.m1.1b"><apply id="S3.E10.m1.1.1.cmml" xref="S3.E10.m1.1.1"><eq id="S3.E10.m1.1.1.2.cmml" xref="S3.E10.m1.1.1.2"></eq><apply id="S3.E10.m1.1.1.3.cmml" xref="S3.E10.m1.1.1.3"><csymbol cd="ambiguous" id="S3.E10.m1.1.1.3.1.cmml" xref="S3.E10.m1.1.1.3">superscript</csymbol><apply id="S3.E10.m1.1.1.3.2.cmml" xref="S3.E10.m1.1.1.3"><csymbol cd="ambiguous" id="S3.E10.m1.1.1.3.2.1.cmml" xref="S3.E10.m1.1.1.3">subscript</csymbol><ci id="S3.E10.m1.1.1.3.2.2.cmml" xref="S3.E10.m1.1.1.3.2.2">𝑃</ci><cn id="S3.E10.m1.1.1.3.2.3.cmml" type="integer" xref="S3.E10.m1.1.1.3.2.3">2</cn></apply><ci id="S3.E10.m1.1.1.3.3.cmml" xref="S3.E10.m1.1.1.3.3">′</ci></apply><apply id="S3.E10.m1.1.1.1.cmml" xref="S3.E10.m1.1.1.1"><plus id="S3.E10.m1.1.1.1.2.cmml" xref="S3.E10.m1.1.1.1.2"></plus><ci id="S3.E10.m1.1.1.1.3.cmml" xref="S3.E10.m1.1.1.1.3">𝑇</ci><apply id="S3.E10.m1.1.1.1.1.cmml" xref="S3.E10.m1.1.1.1.1"><times id="S3.E10.m1.1.1.1.1.2.cmml" xref="S3.E10.m1.1.1.1.1.2"></times><ci id="S3.E10.m1.1.1.1.1.3.cmml" xref="S3.E10.m1.1.1.1.1.3">𝐶</ci><apply id="S3.E10.m1.1.1.1.1.1.1.1.cmml" xref="S3.E10.m1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E10.m1.1.1.1.1.1.1.1.1.cmml" xref="S3.E10.m1.1.1.1.1.1.1">subscript</csymbol><ci id="S3.E10.m1.1.1.1.1.1.1.1.2.cmml" xref="S3.E10.m1.1.1.1.1.1.1.1.2">𝑑</ci><ci id="S3.E10.m1.1.1.1.1.1.1.1.3.cmml" xref="S3.E10.m1.1.1.1.1.1.1.1.3">𝑖</ci></apply></apply><ci id="S3.E10.m1.1.1.1.4.cmml" xref="S3.E10.m1.1.1.1.4">𝑄</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E10.m1.1c">P_{2}^{\prime}=T+C(d_{i})+Q</annotation><annotation encoding="application/x-llamapun" id="S3.E10.m1.1d">italic_P start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT = italic_T + italic_C ( italic_d start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT ) + italic_Q</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S3.SS3.SSS3.p1.5">Similar to the cross-entropy loss <math alttext="\ell_{1}" class="ltx_Math" display="inline" id="S3.SS3.SSS3.p1.5.m1.1"><semantics id="S3.SS3.SSS3.p1.5.m1.1a"><msub id="S3.SS3.SSS3.p1.5.m1.1.1" xref="S3.SS3.SSS3.p1.5.m1.1.1.cmml"><mi id="S3.SS3.SSS3.p1.5.m1.1.1.2" mathvariant="normal" xref="S3.SS3.SSS3.p1.5.m1.1.1.2.cmml">ℓ</mi><mn id="S3.SS3.SSS3.p1.5.m1.1.1.3" xref="S3.SS3.SSS3.p1.5.m1.1.1.3.cmml">1</mn></msub><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS3.p1.5.m1.1b"><apply id="S3.SS3.SSS3.p1.5.m1.1.1.cmml" xref="S3.SS3.SSS3.p1.5.m1.1.1"><csymbol cd="ambiguous" id="S3.SS3.SSS3.p1.5.m1.1.1.1.cmml" xref="S3.SS3.SSS3.p1.5.m1.1.1">subscript</csymbol><ci id="S3.SS3.SSS3.p1.5.m1.1.1.2.cmml" xref="S3.SS3.SSS3.p1.5.m1.1.1.2">ℓ</ci><cn id="S3.SS3.SSS3.p1.5.m1.1.1.3.cmml" type="integer" xref="S3.SS3.SSS3.p1.5.m1.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS3.p1.5.m1.1c">\ell_{1}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.SSS3.p1.5.m1.1d">roman_ℓ start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT</annotation></semantics></math> in subsection <a class="ltx_ref" href="https://arxiv.org/html/2409.14878v1#S3.SS2" title="3.2. AI Psychological Chatbot ‣ 3. Methodology ‣ InterMind: A Doctor-Patient-Family Interactive Depression Assessment System Empowered by Large Language Models"><span class="ltx_text ltx_ref_tag">3.2</span></a>, the assistive diagnosis report generation task can be written as:</p>
<table class="ltx_equation ltx_eqn_table" id="S3.E11">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_left" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_left">(11)</span></td>
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\ell_{2}(\theta_{2};d_{i})=-\sum_{t=1}^{{T_{i}}^{\prime}}log{P(y_{i}(t)|P_{2}^%
{\prime},d_{i},y_{i}(&lt;t);\theta_{2})}" class="ltx_Math" display="block" id="S3.E11.m1.4"><semantics id="S3.E11.m1.4a"><mrow id="S3.E11.m1.4.4" xref="S3.E11.m1.4.4.cmml"><mrow id="S3.E11.m1.3.3.2" xref="S3.E11.m1.3.3.2.cmml"><msub id="S3.E11.m1.3.3.2.4" xref="S3.E11.m1.3.3.2.4.cmml"><mi id="S3.E11.m1.3.3.2.4.2" mathvariant="normal" xref="S3.E11.m1.3.3.2.4.2.cmml">ℓ</mi><mn id="S3.E11.m1.3.3.2.4.3" xref="S3.E11.m1.3.3.2.4.3.cmml">2</mn></msub><mo id="S3.E11.m1.3.3.2.3" xref="S3.E11.m1.3.3.2.3.cmml">⁢</mo><mrow id="S3.E11.m1.3.3.2.2.2" xref="S3.E11.m1.3.3.2.2.3.cmml"><mo id="S3.E11.m1.3.3.2.2.2.3" stretchy="false" xref="S3.E11.m1.3.3.2.2.3.cmml">(</mo><msub id="S3.E11.m1.2.2.1.1.1.1" xref="S3.E11.m1.2.2.1.1.1.1.cmml"><mi id="S3.E11.m1.2.2.1.1.1.1.2" xref="S3.E11.m1.2.2.1.1.1.1.2.cmml">θ</mi><mn id="S3.E11.m1.2.2.1.1.1.1.3" xref="S3.E11.m1.2.2.1.1.1.1.3.cmml">2</mn></msub><mo id="S3.E11.m1.3.3.2.2.2.4" xref="S3.E11.m1.3.3.2.2.3.cmml">;</mo><msub id="S3.E11.m1.3.3.2.2.2.2" xref="S3.E11.m1.3.3.2.2.2.2.cmml"><mi id="S3.E11.m1.3.3.2.2.2.2.2" xref="S3.E11.m1.3.3.2.2.2.2.2.cmml">d</mi><mi id="S3.E11.m1.3.3.2.2.2.2.3" xref="S3.E11.m1.3.3.2.2.2.2.3.cmml">i</mi></msub><mo id="S3.E11.m1.3.3.2.2.2.5" stretchy="false" xref="S3.E11.m1.3.3.2.2.3.cmml">)</mo></mrow></mrow><mo id="S3.E11.m1.4.4.4" xref="S3.E11.m1.4.4.4.cmml">=</mo><mrow id="S3.E11.m1.4.4.3" xref="S3.E11.m1.4.4.3.cmml"><mo id="S3.E11.m1.4.4.3a" xref="S3.E11.m1.4.4.3.cmml">−</mo><mrow id="S3.E11.m1.4.4.3.1" xref="S3.E11.m1.4.4.3.1.cmml"><munderover id="S3.E11.m1.4.4.3.1.2" xref="S3.E11.m1.4.4.3.1.2.cmml"><mo id="S3.E11.m1.4.4.3.1.2.2.2" movablelimits="false" xref="S3.E11.m1.4.4.3.1.2.2.2.cmml">∑</mo><mrow id="S3.E11.m1.4.4.3.1.2.2.3" xref="S3.E11.m1.4.4.3.1.2.2.3.cmml"><mi id="S3.E11.m1.4.4.3.1.2.2.3.2" xref="S3.E11.m1.4.4.3.1.2.2.3.2.cmml">t</mi><mo id="S3.E11.m1.4.4.3.1.2.2.3.1" xref="S3.E11.m1.4.4.3.1.2.2.3.1.cmml">=</mo><mn id="S3.E11.m1.4.4.3.1.2.2.3.3" xref="S3.E11.m1.4.4.3.1.2.2.3.3.cmml">1</mn></mrow><mmultiscripts id="S3.E11.m1.4.4.3.1.2.3" xref="S3.E11.m1.4.4.3.1.2.3.cmml"><mi id="S3.E11.m1.4.4.3.1.2.3.2.2" xref="S3.E11.m1.4.4.3.1.2.3.2.2.cmml">T</mi><mi id="S3.E11.m1.4.4.3.1.2.3.2.3" xref="S3.E11.m1.4.4.3.1.2.3.2.3.cmml">i</mi><mrow id="S3.E11.m1.4.4.3.1.2.3a" xref="S3.E11.m1.4.4.3.1.2.3.cmml"></mrow><mrow id="S3.E11.m1.4.4.3.1.2.3b" xref="S3.E11.m1.4.4.3.1.2.3.cmml"></mrow><mo id="S3.E11.m1.4.4.3.1.2.3.3" xref="S3.E11.m1.4.4.3.1.2.3.3.cmml">′</mo></mmultiscripts></munderover><mrow id="S3.E11.m1.4.4.3.1.1" xref="S3.E11.m1.4.4.3.1.1.cmml"><mi id="S3.E11.m1.4.4.3.1.1.3" xref="S3.E11.m1.4.4.3.1.1.3.cmml">l</mi><mo id="S3.E11.m1.4.4.3.1.1.2" xref="S3.E11.m1.4.4.3.1.1.2.cmml">⁢</mo><mi id="S3.E11.m1.4.4.3.1.1.4" xref="S3.E11.m1.4.4.3.1.1.4.cmml">o</mi><mo id="S3.E11.m1.4.4.3.1.1.2a" xref="S3.E11.m1.4.4.3.1.1.2.cmml">⁢</mo><mi id="S3.E11.m1.4.4.3.1.1.5" xref="S3.E11.m1.4.4.3.1.1.5.cmml">g</mi><mo id="S3.E11.m1.4.4.3.1.1.2b" xref="S3.E11.m1.4.4.3.1.1.2.cmml">⁢</mo><mi id="S3.E11.m1.4.4.3.1.1.6" xref="S3.E11.m1.4.4.3.1.1.6.cmml">P</mi><mo id="S3.E11.m1.4.4.3.1.1.2c" xref="S3.E11.m1.4.4.3.1.1.2.cmml">⁢</mo><mrow id="S3.E11.m1.4.4.3.1.1.1.1" xref="S3.E11.m1.4.4.3.1.1.1.1.1.cmml"><mo id="S3.E11.m1.4.4.3.1.1.1.1.2" stretchy="false" xref="S3.E11.m1.4.4.3.1.1.1.1.1.cmml">(</mo><mrow id="S3.E11.m1.4.4.3.1.1.1.1.1" xref="S3.E11.m1.4.4.3.1.1.1.1.1.cmml"><mrow id="S3.E11.m1.4.4.3.1.1.1.1.1.6" xref="S3.E11.m1.4.4.3.1.1.1.1.1.6.cmml"><msub id="S3.E11.m1.4.4.3.1.1.1.1.1.6.2" xref="S3.E11.m1.4.4.3.1.1.1.1.1.6.2.cmml"><mi id="S3.E11.m1.4.4.3.1.1.1.1.1.6.2.2" xref="S3.E11.m1.4.4.3.1.1.1.1.1.6.2.2.cmml">y</mi><mi id="S3.E11.m1.4.4.3.1.1.1.1.1.6.2.3" xref="S3.E11.m1.4.4.3.1.1.1.1.1.6.2.3.cmml">i</mi></msub><mo id="S3.E11.m1.4.4.3.1.1.1.1.1.6.1" xref="S3.E11.m1.4.4.3.1.1.1.1.1.6.1.cmml">⁢</mo><mrow id="S3.E11.m1.4.4.3.1.1.1.1.1.6.3.2" xref="S3.E11.m1.4.4.3.1.1.1.1.1.6.cmml"><mo id="S3.E11.m1.4.4.3.1.1.1.1.1.6.3.2.1" stretchy="false" xref="S3.E11.m1.4.4.3.1.1.1.1.1.6.cmml">(</mo><mi id="S3.E11.m1.1.1" xref="S3.E11.m1.1.1.cmml">t</mi><mo id="S3.E11.m1.4.4.3.1.1.1.1.1.6.3.2.2" stretchy="false" xref="S3.E11.m1.4.4.3.1.1.1.1.1.6.cmml">)</mo></mrow></mrow><mo fence="false" id="S3.E11.m1.4.4.3.1.1.1.1.1.5" xref="S3.E11.m1.4.4.3.1.1.1.1.1.5.cmml">|</mo><mrow id="S3.E11.m1.4.4.3.1.1.1.1.1.4.4" xref="S3.E11.m1.4.4.3.1.1.1.1.1.4.5.cmml"><msubsup id="S3.E11.m1.4.4.3.1.1.1.1.1.1.1.1" xref="S3.E11.m1.4.4.3.1.1.1.1.1.1.1.1.cmml"><mi id="S3.E11.m1.4.4.3.1.1.1.1.1.1.1.1.2.2" xref="S3.E11.m1.4.4.3.1.1.1.1.1.1.1.1.2.2.cmml">P</mi><mn id="S3.E11.m1.4.4.3.1.1.1.1.1.1.1.1.2.3" xref="S3.E11.m1.4.4.3.1.1.1.1.1.1.1.1.2.3.cmml">2</mn><mo id="S3.E11.m1.4.4.3.1.1.1.1.1.1.1.1.3" xref="S3.E11.m1.4.4.3.1.1.1.1.1.1.1.1.3.cmml">′</mo></msubsup><mo id="S3.E11.m1.4.4.3.1.1.1.1.1.4.4.5" xref="S3.E11.m1.4.4.3.1.1.1.1.1.4.5.cmml">,</mo><msub id="S3.E11.m1.4.4.3.1.1.1.1.1.2.2.2" xref="S3.E11.m1.4.4.3.1.1.1.1.1.2.2.2.cmml"><mi id="S3.E11.m1.4.4.3.1.1.1.1.1.2.2.2.2" xref="S3.E11.m1.4.4.3.1.1.1.1.1.2.2.2.2.cmml">d</mi><mi id="S3.E11.m1.4.4.3.1.1.1.1.1.2.2.2.3" xref="S3.E11.m1.4.4.3.1.1.1.1.1.2.2.2.3.cmml">i</mi></msub><mo id="S3.E11.m1.4.4.3.1.1.1.1.1.4.4.6" xref="S3.E11.m1.4.4.3.1.1.1.1.1.4.5.cmml">,</mo><mrow id="S3.E11.m1.4.4.3.1.1.1.1.1.3.3.3" xref="S3.E11.m1.4.4.3.1.1.1.1.1.3.3.3.cmml"><msub id="S3.E11.m1.4.4.3.1.1.1.1.1.3.3.3.3" xref="S3.E11.m1.4.4.3.1.1.1.1.1.3.3.3.3.cmml"><mi id="S3.E11.m1.4.4.3.1.1.1.1.1.3.3.3.3.2" xref="S3.E11.m1.4.4.3.1.1.1.1.1.3.3.3.3.2.cmml">y</mi><mi id="S3.E11.m1.4.4.3.1.1.1.1.1.3.3.3.3.3" xref="S3.E11.m1.4.4.3.1.1.1.1.1.3.3.3.3.3.cmml">i</mi></msub><mspace id="S3.E11.m1.4.4.3.1.1.1.1.1.3.3.3a" width="0.3888888888888889em" xref="S3.E11.m1.4.4.3.1.1.1.1.1.3.3.3.cmml"></mspace><mrow id="S3.E11.m1.4.4.3.1.1.1.1.1.3.3.3.1.1" xref="S3.E11.m1.4.4.3.1.1.1.1.1.3.3.3.1.1.1.cmml"><mo id="S3.E11.m1.4.4.3.1.1.1.1.1.3.3.3.1.1.2" stretchy="false" xref="S3.E11.m1.4.4.3.1.1.1.1.1.3.3.3.1.1.1.cmml">(</mo><mrow id="S3.E11.m1.4.4.3.1.1.1.1.1.3.3.3.1.1.1" xref="S3.E11.m1.4.4.3.1.1.1.1.1.3.3.3.1.1.1.cmml"><mi id="S3.E11.m1.4.4.3.1.1.1.1.1.3.3.3.1.1.1.2" xref="S3.E11.m1.4.4.3.1.1.1.1.1.3.3.3.1.1.1.2.cmml"></mi><mo id="S3.E11.m1.4.4.3.1.1.1.1.1.3.3.3.1.1.1.1" xref="S3.E11.m1.4.4.3.1.1.1.1.1.3.3.3.1.1.1.1.cmml">&lt;</mo><mi id="S3.E11.m1.4.4.3.1.1.1.1.1.3.3.3.1.1.1.3" xref="S3.E11.m1.4.4.3.1.1.1.1.1.3.3.3.1.1.1.3.cmml">t</mi></mrow><mo id="S3.E11.m1.4.4.3.1.1.1.1.1.3.3.3.1.1.3" stretchy="false" xref="S3.E11.m1.4.4.3.1.1.1.1.1.3.3.3.1.1.1.cmml">)</mo></mrow></mrow><mo id="S3.E11.m1.4.4.3.1.1.1.1.1.4.4.7" xref="S3.E11.m1.4.4.3.1.1.1.1.1.4.5.cmml">;</mo><msub id="S3.E11.m1.4.4.3.1.1.1.1.1.4.4.4" xref="S3.E11.m1.4.4.3.1.1.1.1.1.4.4.4.cmml"><mi id="S3.E11.m1.4.4.3.1.1.1.1.1.4.4.4.2" xref="S3.E11.m1.4.4.3.1.1.1.1.1.4.4.4.2.cmml">θ</mi><mn id="S3.E11.m1.4.4.3.1.1.1.1.1.4.4.4.3" xref="S3.E11.m1.4.4.3.1.1.1.1.1.4.4.4.3.cmml">2</mn></msub></mrow></mrow><mo id="S3.E11.m1.4.4.3.1.1.1.1.3" stretchy="false" xref="S3.E11.m1.4.4.3.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.E11.m1.4b"><apply id="S3.E11.m1.4.4.cmml" xref="S3.E11.m1.4.4"><eq id="S3.E11.m1.4.4.4.cmml" xref="S3.E11.m1.4.4.4"></eq><apply id="S3.E11.m1.3.3.2.cmml" xref="S3.E11.m1.3.3.2"><times id="S3.E11.m1.3.3.2.3.cmml" xref="S3.E11.m1.3.3.2.3"></times><apply id="S3.E11.m1.3.3.2.4.cmml" xref="S3.E11.m1.3.3.2.4"><csymbol cd="ambiguous" id="S3.E11.m1.3.3.2.4.1.cmml" xref="S3.E11.m1.3.3.2.4">subscript</csymbol><ci id="S3.E11.m1.3.3.2.4.2.cmml" xref="S3.E11.m1.3.3.2.4.2">ℓ</ci><cn id="S3.E11.m1.3.3.2.4.3.cmml" type="integer" xref="S3.E11.m1.3.3.2.4.3">2</cn></apply><list id="S3.E11.m1.3.3.2.2.3.cmml" xref="S3.E11.m1.3.3.2.2.2"><apply id="S3.E11.m1.2.2.1.1.1.1.cmml" xref="S3.E11.m1.2.2.1.1.1.1"><csymbol cd="ambiguous" id="S3.E11.m1.2.2.1.1.1.1.1.cmml" xref="S3.E11.m1.2.2.1.1.1.1">subscript</csymbol><ci id="S3.E11.m1.2.2.1.1.1.1.2.cmml" xref="S3.E11.m1.2.2.1.1.1.1.2">𝜃</ci><cn id="S3.E11.m1.2.2.1.1.1.1.3.cmml" type="integer" xref="S3.E11.m1.2.2.1.1.1.1.3">2</cn></apply><apply id="S3.E11.m1.3.3.2.2.2.2.cmml" xref="S3.E11.m1.3.3.2.2.2.2"><csymbol cd="ambiguous" id="S3.E11.m1.3.3.2.2.2.2.1.cmml" xref="S3.E11.m1.3.3.2.2.2.2">subscript</csymbol><ci id="S3.E11.m1.3.3.2.2.2.2.2.cmml" xref="S3.E11.m1.3.3.2.2.2.2.2">𝑑</ci><ci id="S3.E11.m1.3.3.2.2.2.2.3.cmml" xref="S3.E11.m1.3.3.2.2.2.2.3">𝑖</ci></apply></list></apply><apply id="S3.E11.m1.4.4.3.cmml" xref="S3.E11.m1.4.4.3"><minus id="S3.E11.m1.4.4.3.2.cmml" xref="S3.E11.m1.4.4.3"></minus><apply id="S3.E11.m1.4.4.3.1.cmml" xref="S3.E11.m1.4.4.3.1"><apply id="S3.E11.m1.4.4.3.1.2.cmml" xref="S3.E11.m1.4.4.3.1.2"><csymbol cd="ambiguous" id="S3.E11.m1.4.4.3.1.2.1.cmml" xref="S3.E11.m1.4.4.3.1.2">superscript</csymbol><apply id="S3.E11.m1.4.4.3.1.2.2.cmml" xref="S3.E11.m1.4.4.3.1.2"><csymbol cd="ambiguous" id="S3.E11.m1.4.4.3.1.2.2.1.cmml" xref="S3.E11.m1.4.4.3.1.2">subscript</csymbol><sum id="S3.E11.m1.4.4.3.1.2.2.2.cmml" xref="S3.E11.m1.4.4.3.1.2.2.2"></sum><apply id="S3.E11.m1.4.4.3.1.2.2.3.cmml" xref="S3.E11.m1.4.4.3.1.2.2.3"><eq id="S3.E11.m1.4.4.3.1.2.2.3.1.cmml" xref="S3.E11.m1.4.4.3.1.2.2.3.1"></eq><ci id="S3.E11.m1.4.4.3.1.2.2.3.2.cmml" xref="S3.E11.m1.4.4.3.1.2.2.3.2">𝑡</ci><cn id="S3.E11.m1.4.4.3.1.2.2.3.3.cmml" type="integer" xref="S3.E11.m1.4.4.3.1.2.2.3.3">1</cn></apply></apply><apply id="S3.E11.m1.4.4.3.1.2.3.cmml" xref="S3.E11.m1.4.4.3.1.2.3"><csymbol cd="ambiguous" id="S3.E11.m1.4.4.3.1.2.3.1.cmml" xref="S3.E11.m1.4.4.3.1.2.3">superscript</csymbol><apply id="S3.E11.m1.4.4.3.1.2.3.2.cmml" xref="S3.E11.m1.4.4.3.1.2.3"><csymbol cd="ambiguous" id="S3.E11.m1.4.4.3.1.2.3.2.1.cmml" xref="S3.E11.m1.4.4.3.1.2.3">subscript</csymbol><ci id="S3.E11.m1.4.4.3.1.2.3.2.2.cmml" xref="S3.E11.m1.4.4.3.1.2.3.2.2">𝑇</ci><ci id="S3.E11.m1.4.4.3.1.2.3.2.3.cmml" xref="S3.E11.m1.4.4.3.1.2.3.2.3">𝑖</ci></apply><ci id="S3.E11.m1.4.4.3.1.2.3.3.cmml" xref="S3.E11.m1.4.4.3.1.2.3.3">′</ci></apply></apply><apply id="S3.E11.m1.4.4.3.1.1.cmml" xref="S3.E11.m1.4.4.3.1.1"><times id="S3.E11.m1.4.4.3.1.1.2.cmml" xref="S3.E11.m1.4.4.3.1.1.2"></times><ci id="S3.E11.m1.4.4.3.1.1.3.cmml" xref="S3.E11.m1.4.4.3.1.1.3">𝑙</ci><ci id="S3.E11.m1.4.4.3.1.1.4.cmml" xref="S3.E11.m1.4.4.3.1.1.4">𝑜</ci><ci id="S3.E11.m1.4.4.3.1.1.5.cmml" xref="S3.E11.m1.4.4.3.1.1.5">𝑔</ci><ci id="S3.E11.m1.4.4.3.1.1.6.cmml" xref="S3.E11.m1.4.4.3.1.1.6">𝑃</ci><apply id="S3.E11.m1.4.4.3.1.1.1.1.1.cmml" xref="S3.E11.m1.4.4.3.1.1.1.1"><csymbol cd="latexml" id="S3.E11.m1.4.4.3.1.1.1.1.1.5.cmml" xref="S3.E11.m1.4.4.3.1.1.1.1.1.5">conditional</csymbol><apply id="S3.E11.m1.4.4.3.1.1.1.1.1.6.cmml" xref="S3.E11.m1.4.4.3.1.1.1.1.1.6"><times id="S3.E11.m1.4.4.3.1.1.1.1.1.6.1.cmml" xref="S3.E11.m1.4.4.3.1.1.1.1.1.6.1"></times><apply id="S3.E11.m1.4.4.3.1.1.1.1.1.6.2.cmml" xref="S3.E11.m1.4.4.3.1.1.1.1.1.6.2"><csymbol cd="ambiguous" id="S3.E11.m1.4.4.3.1.1.1.1.1.6.2.1.cmml" xref="S3.E11.m1.4.4.3.1.1.1.1.1.6.2">subscript</csymbol><ci id="S3.E11.m1.4.4.3.1.1.1.1.1.6.2.2.cmml" xref="S3.E11.m1.4.4.3.1.1.1.1.1.6.2.2">𝑦</ci><ci id="S3.E11.m1.4.4.3.1.1.1.1.1.6.2.3.cmml" xref="S3.E11.m1.4.4.3.1.1.1.1.1.6.2.3">𝑖</ci></apply><ci id="S3.E11.m1.1.1.cmml" xref="S3.E11.m1.1.1">𝑡</ci></apply><list id="S3.E11.m1.4.4.3.1.1.1.1.1.4.5.cmml" xref="S3.E11.m1.4.4.3.1.1.1.1.1.4.4"><apply id="S3.E11.m1.4.4.3.1.1.1.1.1.1.1.1.cmml" xref="S3.E11.m1.4.4.3.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E11.m1.4.4.3.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E11.m1.4.4.3.1.1.1.1.1.1.1.1">superscript</csymbol><apply id="S3.E11.m1.4.4.3.1.1.1.1.1.1.1.1.2.cmml" xref="S3.E11.m1.4.4.3.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E11.m1.4.4.3.1.1.1.1.1.1.1.1.2.1.cmml" xref="S3.E11.m1.4.4.3.1.1.1.1.1.1.1.1">subscript</csymbol><ci id="S3.E11.m1.4.4.3.1.1.1.1.1.1.1.1.2.2.cmml" xref="S3.E11.m1.4.4.3.1.1.1.1.1.1.1.1.2.2">𝑃</ci><cn id="S3.E11.m1.4.4.3.1.1.1.1.1.1.1.1.2.3.cmml" type="integer" xref="S3.E11.m1.4.4.3.1.1.1.1.1.1.1.1.2.3">2</cn></apply><ci id="S3.E11.m1.4.4.3.1.1.1.1.1.1.1.1.3.cmml" xref="S3.E11.m1.4.4.3.1.1.1.1.1.1.1.1.3">′</ci></apply><apply id="S3.E11.m1.4.4.3.1.1.1.1.1.2.2.2.cmml" xref="S3.E11.m1.4.4.3.1.1.1.1.1.2.2.2"><csymbol cd="ambiguous" id="S3.E11.m1.4.4.3.1.1.1.1.1.2.2.2.1.cmml" xref="S3.E11.m1.4.4.3.1.1.1.1.1.2.2.2">subscript</csymbol><ci id="S3.E11.m1.4.4.3.1.1.1.1.1.2.2.2.2.cmml" xref="S3.E11.m1.4.4.3.1.1.1.1.1.2.2.2.2">𝑑</ci><ci id="S3.E11.m1.4.4.3.1.1.1.1.1.2.2.2.3.cmml" xref="S3.E11.m1.4.4.3.1.1.1.1.1.2.2.2.3">𝑖</ci></apply><apply id="S3.E11.m1.4.4.3.1.1.1.1.1.3.3.3.cmml" xref="S3.E11.m1.4.4.3.1.1.1.1.1.3.3.3"><csymbol cd="latexml" id="S3.E11.m1.4.4.3.1.1.1.1.1.3.3.3.2.cmml" xref="S3.E11.m1.4.4.3.1.1.1.1.1.3.3.3">annotated</csymbol><apply id="S3.E11.m1.4.4.3.1.1.1.1.1.3.3.3.3.cmml" xref="S3.E11.m1.4.4.3.1.1.1.1.1.3.3.3.3"><csymbol cd="ambiguous" id="S3.E11.m1.4.4.3.1.1.1.1.1.3.3.3.3.1.cmml" xref="S3.E11.m1.4.4.3.1.1.1.1.1.3.3.3.3">subscript</csymbol><ci id="S3.E11.m1.4.4.3.1.1.1.1.1.3.3.3.3.2.cmml" xref="S3.E11.m1.4.4.3.1.1.1.1.1.3.3.3.3.2">𝑦</ci><ci id="S3.E11.m1.4.4.3.1.1.1.1.1.3.3.3.3.3.cmml" xref="S3.E11.m1.4.4.3.1.1.1.1.1.3.3.3.3.3">𝑖</ci></apply><apply id="S3.E11.m1.4.4.3.1.1.1.1.1.3.3.3.1.1.1.cmml" xref="S3.E11.m1.4.4.3.1.1.1.1.1.3.3.3.1.1"><lt id="S3.E11.m1.4.4.3.1.1.1.1.1.3.3.3.1.1.1.1.cmml" xref="S3.E11.m1.4.4.3.1.1.1.1.1.3.3.3.1.1.1.1"></lt><csymbol cd="latexml" id="S3.E11.m1.4.4.3.1.1.1.1.1.3.3.3.1.1.1.2.cmml" xref="S3.E11.m1.4.4.3.1.1.1.1.1.3.3.3.1.1.1.2">absent</csymbol><ci id="S3.E11.m1.4.4.3.1.1.1.1.1.3.3.3.1.1.1.3.cmml" xref="S3.E11.m1.4.4.3.1.1.1.1.1.3.3.3.1.1.1.3">𝑡</ci></apply></apply><apply id="S3.E11.m1.4.4.3.1.1.1.1.1.4.4.4.cmml" xref="S3.E11.m1.4.4.3.1.1.1.1.1.4.4.4"><csymbol cd="ambiguous" id="S3.E11.m1.4.4.3.1.1.1.1.1.4.4.4.1.cmml" xref="S3.E11.m1.4.4.3.1.1.1.1.1.4.4.4">subscript</csymbol><ci id="S3.E11.m1.4.4.3.1.1.1.1.1.4.4.4.2.cmml" xref="S3.E11.m1.4.4.3.1.1.1.1.1.4.4.4.2">𝜃</ci><cn id="S3.E11.m1.4.4.3.1.1.1.1.1.4.4.4.3.cmml" type="integer" xref="S3.E11.m1.4.4.3.1.1.1.1.1.4.4.4.3">2</cn></apply></list></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E11.m1.4c">\ell_{2}(\theta_{2};d_{i})=-\sum_{t=1}^{{T_{i}}^{\prime}}log{P(y_{i}(t)|P_{2}^%
{\prime},d_{i},y_{i}(&lt;t);\theta_{2})}</annotation><annotation encoding="application/x-llamapun" id="S3.E11.m1.4d">roman_ℓ start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT ( italic_θ start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT ; italic_d start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT ) = - ∑ start_POSTSUBSCRIPT italic_t = 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_T start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT end_POSTSUPERSCRIPT italic_l italic_o italic_g italic_P ( italic_y start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT ( italic_t ) | italic_P start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT , italic_d start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT , italic_y start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT ( &lt; italic_t ) ; italic_θ start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT )</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S3.SS3.SSS3.p1.15">where <math alttext="{T_{i}}^{\prime}" class="ltx_Math" display="inline" id="S3.SS3.SSS3.p1.6.m1.1"><semantics id="S3.SS3.SSS3.p1.6.m1.1a"><mmultiscripts id="S3.SS3.SSS3.p1.6.m1.1.1" xref="S3.SS3.SSS3.p1.6.m1.1.1.cmml"><mi id="S3.SS3.SSS3.p1.6.m1.1.1.2.2" xref="S3.SS3.SSS3.p1.6.m1.1.1.2.2.cmml">T</mi><mi id="S3.SS3.SSS3.p1.6.m1.1.1.2.3" xref="S3.SS3.SSS3.p1.6.m1.1.1.2.3.cmml">i</mi><mrow id="S3.SS3.SSS3.p1.6.m1.1.1a" xref="S3.SS3.SSS3.p1.6.m1.1.1.cmml"></mrow><mrow id="S3.SS3.SSS3.p1.6.m1.1.1b" xref="S3.SS3.SSS3.p1.6.m1.1.1.cmml"></mrow><mo id="S3.SS3.SSS3.p1.6.m1.1.1.3" xref="S3.SS3.SSS3.p1.6.m1.1.1.3.cmml">′</mo></mmultiscripts><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS3.p1.6.m1.1b"><apply id="S3.SS3.SSS3.p1.6.m1.1.1.cmml" xref="S3.SS3.SSS3.p1.6.m1.1.1"><csymbol cd="ambiguous" id="S3.SS3.SSS3.p1.6.m1.1.1.1.cmml" xref="S3.SS3.SSS3.p1.6.m1.1.1">superscript</csymbol><apply id="S3.SS3.SSS3.p1.6.m1.1.1.2.cmml" xref="S3.SS3.SSS3.p1.6.m1.1.1"><csymbol cd="ambiguous" id="S3.SS3.SSS3.p1.6.m1.1.1.2.1.cmml" xref="S3.SS3.SSS3.p1.6.m1.1.1">subscript</csymbol><ci id="S3.SS3.SSS3.p1.6.m1.1.1.2.2.cmml" xref="S3.SS3.SSS3.p1.6.m1.1.1.2.2">𝑇</ci><ci id="S3.SS3.SSS3.p1.6.m1.1.1.2.3.cmml" xref="S3.SS3.SSS3.p1.6.m1.1.1.2.3">𝑖</ci></apply><ci id="S3.SS3.SSS3.p1.6.m1.1.1.3.cmml" xref="S3.SS3.SSS3.p1.6.m1.1.1.3">′</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS3.p1.6.m1.1c">{T_{i}}^{\prime}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.SSS3.p1.6.m1.1d">italic_T start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT</annotation></semantics></math> is the length of <math alttext="y_{i}" class="ltx_Math" display="inline" id="S3.SS3.SSS3.p1.7.m2.1"><semantics id="S3.SS3.SSS3.p1.7.m2.1a"><msub id="S3.SS3.SSS3.p1.7.m2.1.1" xref="S3.SS3.SSS3.p1.7.m2.1.1.cmml"><mi id="S3.SS3.SSS3.p1.7.m2.1.1.2" xref="S3.SS3.SSS3.p1.7.m2.1.1.2.cmml">y</mi><mi id="S3.SS3.SSS3.p1.7.m2.1.1.3" xref="S3.SS3.SSS3.p1.7.m2.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS3.p1.7.m2.1b"><apply id="S3.SS3.SSS3.p1.7.m2.1.1.cmml" xref="S3.SS3.SSS3.p1.7.m2.1.1"><csymbol cd="ambiguous" id="S3.SS3.SSS3.p1.7.m2.1.1.1.cmml" xref="S3.SS3.SSS3.p1.7.m2.1.1">subscript</csymbol><ci id="S3.SS3.SSS3.p1.7.m2.1.1.2.cmml" xref="S3.SS3.SSS3.p1.7.m2.1.1.2">𝑦</ci><ci id="S3.SS3.SSS3.p1.7.m2.1.1.3.cmml" xref="S3.SS3.SSS3.p1.7.m2.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS3.p1.7.m2.1c">y_{i}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.SSS3.p1.7.m2.1d">italic_y start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT</annotation></semantics></math>, and <math alttext="P(y_{i}(t)|P_{2}^{\prime},d_{i},y_{i}(&lt;t);\theta_{2})" class="ltx_Math" display="inline" id="S3.SS3.SSS3.p1.8.m3.2"><semantics id="S3.SS3.SSS3.p1.8.m3.2a"><mrow id="S3.SS3.SSS3.p1.8.m3.2.2" xref="S3.SS3.SSS3.p1.8.m3.2.2.cmml"><mi id="S3.SS3.SSS3.p1.8.m3.2.2.3" xref="S3.SS3.SSS3.p1.8.m3.2.2.3.cmml">P</mi><mo id="S3.SS3.SSS3.p1.8.m3.2.2.2" xref="S3.SS3.SSS3.p1.8.m3.2.2.2.cmml">⁢</mo><mrow id="S3.SS3.SSS3.p1.8.m3.2.2.1.1" xref="S3.SS3.SSS3.p1.8.m3.2.2.1.1.1.cmml"><mo id="S3.SS3.SSS3.p1.8.m3.2.2.1.1.2" stretchy="false" xref="S3.SS3.SSS3.p1.8.m3.2.2.1.1.1.cmml">(</mo><mrow id="S3.SS3.SSS3.p1.8.m3.2.2.1.1.1" xref="S3.SS3.SSS3.p1.8.m3.2.2.1.1.1.cmml"><mrow id="S3.SS3.SSS3.p1.8.m3.2.2.1.1.1.6" xref="S3.SS3.SSS3.p1.8.m3.2.2.1.1.1.6.cmml"><msub id="S3.SS3.SSS3.p1.8.m3.2.2.1.1.1.6.2" xref="S3.SS3.SSS3.p1.8.m3.2.2.1.1.1.6.2.cmml"><mi id="S3.SS3.SSS3.p1.8.m3.2.2.1.1.1.6.2.2" xref="S3.SS3.SSS3.p1.8.m3.2.2.1.1.1.6.2.2.cmml">y</mi><mi id="S3.SS3.SSS3.p1.8.m3.2.2.1.1.1.6.2.3" xref="S3.SS3.SSS3.p1.8.m3.2.2.1.1.1.6.2.3.cmml">i</mi></msub><mo id="S3.SS3.SSS3.p1.8.m3.2.2.1.1.1.6.1" xref="S3.SS3.SSS3.p1.8.m3.2.2.1.1.1.6.1.cmml">⁢</mo><mrow id="S3.SS3.SSS3.p1.8.m3.2.2.1.1.1.6.3.2" xref="S3.SS3.SSS3.p1.8.m3.2.2.1.1.1.6.cmml"><mo id="S3.SS3.SSS3.p1.8.m3.2.2.1.1.1.6.3.2.1" stretchy="false" xref="S3.SS3.SSS3.p1.8.m3.2.2.1.1.1.6.cmml">(</mo><mi id="S3.SS3.SSS3.p1.8.m3.1.1" xref="S3.SS3.SSS3.p1.8.m3.1.1.cmml">t</mi><mo id="S3.SS3.SSS3.p1.8.m3.2.2.1.1.1.6.3.2.2" stretchy="false" xref="S3.SS3.SSS3.p1.8.m3.2.2.1.1.1.6.cmml">)</mo></mrow></mrow><mo fence="false" id="S3.SS3.SSS3.p1.8.m3.2.2.1.1.1.5" xref="S3.SS3.SSS3.p1.8.m3.2.2.1.1.1.5.cmml">|</mo><mrow id="S3.SS3.SSS3.p1.8.m3.2.2.1.1.1.4.4" xref="S3.SS3.SSS3.p1.8.m3.2.2.1.1.1.4.5.cmml"><msubsup id="S3.SS3.SSS3.p1.8.m3.2.2.1.1.1.1.1.1" xref="S3.SS3.SSS3.p1.8.m3.2.2.1.1.1.1.1.1.cmml"><mi id="S3.SS3.SSS3.p1.8.m3.2.2.1.1.1.1.1.1.2.2" xref="S3.SS3.SSS3.p1.8.m3.2.2.1.1.1.1.1.1.2.2.cmml">P</mi><mn id="S3.SS3.SSS3.p1.8.m3.2.2.1.1.1.1.1.1.2.3" xref="S3.SS3.SSS3.p1.8.m3.2.2.1.1.1.1.1.1.2.3.cmml">2</mn><mo id="S3.SS3.SSS3.p1.8.m3.2.2.1.1.1.1.1.1.3" xref="S3.SS3.SSS3.p1.8.m3.2.2.1.1.1.1.1.1.3.cmml">′</mo></msubsup><mo id="S3.SS3.SSS3.p1.8.m3.2.2.1.1.1.4.4.5" xref="S3.SS3.SSS3.p1.8.m3.2.2.1.1.1.4.5.cmml">,</mo><msub id="S3.SS3.SSS3.p1.8.m3.2.2.1.1.1.2.2.2" xref="S3.SS3.SSS3.p1.8.m3.2.2.1.1.1.2.2.2.cmml"><mi id="S3.SS3.SSS3.p1.8.m3.2.2.1.1.1.2.2.2.2" xref="S3.SS3.SSS3.p1.8.m3.2.2.1.1.1.2.2.2.2.cmml">d</mi><mi id="S3.SS3.SSS3.p1.8.m3.2.2.1.1.1.2.2.2.3" xref="S3.SS3.SSS3.p1.8.m3.2.2.1.1.1.2.2.2.3.cmml">i</mi></msub><mo id="S3.SS3.SSS3.p1.8.m3.2.2.1.1.1.4.4.6" xref="S3.SS3.SSS3.p1.8.m3.2.2.1.1.1.4.5.cmml">,</mo><mrow id="S3.SS3.SSS3.p1.8.m3.2.2.1.1.1.3.3.3" xref="S3.SS3.SSS3.p1.8.m3.2.2.1.1.1.3.3.3.cmml"><msub id="S3.SS3.SSS3.p1.8.m3.2.2.1.1.1.3.3.3.3" xref="S3.SS3.SSS3.p1.8.m3.2.2.1.1.1.3.3.3.3.cmml"><mi id="S3.SS3.SSS3.p1.8.m3.2.2.1.1.1.3.3.3.3.2" xref="S3.SS3.SSS3.p1.8.m3.2.2.1.1.1.3.3.3.3.2.cmml">y</mi><mi id="S3.SS3.SSS3.p1.8.m3.2.2.1.1.1.3.3.3.3.3" xref="S3.SS3.SSS3.p1.8.m3.2.2.1.1.1.3.3.3.3.3.cmml">i</mi></msub><mspace id="S3.SS3.SSS3.p1.8.m3.2.2.1.1.1.3.3.3a" width="0.3888888888888889em" xref="S3.SS3.SSS3.p1.8.m3.2.2.1.1.1.3.3.3.cmml"></mspace><mrow id="S3.SS3.SSS3.p1.8.m3.2.2.1.1.1.3.3.3.1.1" xref="S3.SS3.SSS3.p1.8.m3.2.2.1.1.1.3.3.3.1.1.1.cmml"><mo id="S3.SS3.SSS3.p1.8.m3.2.2.1.1.1.3.3.3.1.1.2" stretchy="false" xref="S3.SS3.SSS3.p1.8.m3.2.2.1.1.1.3.3.3.1.1.1.cmml">(</mo><mrow id="S3.SS3.SSS3.p1.8.m3.2.2.1.1.1.3.3.3.1.1.1" xref="S3.SS3.SSS3.p1.8.m3.2.2.1.1.1.3.3.3.1.1.1.cmml"><mi id="S3.SS3.SSS3.p1.8.m3.2.2.1.1.1.3.3.3.1.1.1.2" xref="S3.SS3.SSS3.p1.8.m3.2.2.1.1.1.3.3.3.1.1.1.2.cmml"></mi><mo id="S3.SS3.SSS3.p1.8.m3.2.2.1.1.1.3.3.3.1.1.1.1" xref="S3.SS3.SSS3.p1.8.m3.2.2.1.1.1.3.3.3.1.1.1.1.cmml">&lt;</mo><mi id="S3.SS3.SSS3.p1.8.m3.2.2.1.1.1.3.3.3.1.1.1.3" xref="S3.SS3.SSS3.p1.8.m3.2.2.1.1.1.3.3.3.1.1.1.3.cmml">t</mi></mrow><mo id="S3.SS3.SSS3.p1.8.m3.2.2.1.1.1.3.3.3.1.1.3" stretchy="false" xref="S3.SS3.SSS3.p1.8.m3.2.2.1.1.1.3.3.3.1.1.1.cmml">)</mo></mrow></mrow><mo id="S3.SS3.SSS3.p1.8.m3.2.2.1.1.1.4.4.7" xref="S3.SS3.SSS3.p1.8.m3.2.2.1.1.1.4.5.cmml">;</mo><msub id="S3.SS3.SSS3.p1.8.m3.2.2.1.1.1.4.4.4" xref="S3.SS3.SSS3.p1.8.m3.2.2.1.1.1.4.4.4.cmml"><mi id="S3.SS3.SSS3.p1.8.m3.2.2.1.1.1.4.4.4.2" xref="S3.SS3.SSS3.p1.8.m3.2.2.1.1.1.4.4.4.2.cmml">θ</mi><mn id="S3.SS3.SSS3.p1.8.m3.2.2.1.1.1.4.4.4.3" xref="S3.SS3.SSS3.p1.8.m3.2.2.1.1.1.4.4.4.3.cmml">2</mn></msub></mrow></mrow><mo id="S3.SS3.SSS3.p1.8.m3.2.2.1.1.3" stretchy="false" xref="S3.SS3.SSS3.p1.8.m3.2.2.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS3.p1.8.m3.2b"><apply id="S3.SS3.SSS3.p1.8.m3.2.2.cmml" xref="S3.SS3.SSS3.p1.8.m3.2.2"><times id="S3.SS3.SSS3.p1.8.m3.2.2.2.cmml" xref="S3.SS3.SSS3.p1.8.m3.2.2.2"></times><ci id="S3.SS3.SSS3.p1.8.m3.2.2.3.cmml" xref="S3.SS3.SSS3.p1.8.m3.2.2.3">𝑃</ci><apply id="S3.SS3.SSS3.p1.8.m3.2.2.1.1.1.cmml" xref="S3.SS3.SSS3.p1.8.m3.2.2.1.1"><csymbol cd="latexml" id="S3.SS3.SSS3.p1.8.m3.2.2.1.1.1.5.cmml" xref="S3.SS3.SSS3.p1.8.m3.2.2.1.1.1.5">conditional</csymbol><apply id="S3.SS3.SSS3.p1.8.m3.2.2.1.1.1.6.cmml" xref="S3.SS3.SSS3.p1.8.m3.2.2.1.1.1.6"><times id="S3.SS3.SSS3.p1.8.m3.2.2.1.1.1.6.1.cmml" xref="S3.SS3.SSS3.p1.8.m3.2.2.1.1.1.6.1"></times><apply id="S3.SS3.SSS3.p1.8.m3.2.2.1.1.1.6.2.cmml" xref="S3.SS3.SSS3.p1.8.m3.2.2.1.1.1.6.2"><csymbol cd="ambiguous" id="S3.SS3.SSS3.p1.8.m3.2.2.1.1.1.6.2.1.cmml" xref="S3.SS3.SSS3.p1.8.m3.2.2.1.1.1.6.2">subscript</csymbol><ci id="S3.SS3.SSS3.p1.8.m3.2.2.1.1.1.6.2.2.cmml" xref="S3.SS3.SSS3.p1.8.m3.2.2.1.1.1.6.2.2">𝑦</ci><ci id="S3.SS3.SSS3.p1.8.m3.2.2.1.1.1.6.2.3.cmml" xref="S3.SS3.SSS3.p1.8.m3.2.2.1.1.1.6.2.3">𝑖</ci></apply><ci id="S3.SS3.SSS3.p1.8.m3.1.1.cmml" xref="S3.SS3.SSS3.p1.8.m3.1.1">𝑡</ci></apply><list id="S3.SS3.SSS3.p1.8.m3.2.2.1.1.1.4.5.cmml" xref="S3.SS3.SSS3.p1.8.m3.2.2.1.1.1.4.4"><apply id="S3.SS3.SSS3.p1.8.m3.2.2.1.1.1.1.1.1.cmml" xref="S3.SS3.SSS3.p1.8.m3.2.2.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS3.SSS3.p1.8.m3.2.2.1.1.1.1.1.1.1.cmml" xref="S3.SS3.SSS3.p1.8.m3.2.2.1.1.1.1.1.1">superscript</csymbol><apply id="S3.SS3.SSS3.p1.8.m3.2.2.1.1.1.1.1.1.2.cmml" xref="S3.SS3.SSS3.p1.8.m3.2.2.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS3.SSS3.p1.8.m3.2.2.1.1.1.1.1.1.2.1.cmml" xref="S3.SS3.SSS3.p1.8.m3.2.2.1.1.1.1.1.1">subscript</csymbol><ci id="S3.SS3.SSS3.p1.8.m3.2.2.1.1.1.1.1.1.2.2.cmml" xref="S3.SS3.SSS3.p1.8.m3.2.2.1.1.1.1.1.1.2.2">𝑃</ci><cn id="S3.SS3.SSS3.p1.8.m3.2.2.1.1.1.1.1.1.2.3.cmml" type="integer" xref="S3.SS3.SSS3.p1.8.m3.2.2.1.1.1.1.1.1.2.3">2</cn></apply><ci id="S3.SS3.SSS3.p1.8.m3.2.2.1.1.1.1.1.1.3.cmml" xref="S3.SS3.SSS3.p1.8.m3.2.2.1.1.1.1.1.1.3">′</ci></apply><apply id="S3.SS3.SSS3.p1.8.m3.2.2.1.1.1.2.2.2.cmml" xref="S3.SS3.SSS3.p1.8.m3.2.2.1.1.1.2.2.2"><csymbol cd="ambiguous" id="S3.SS3.SSS3.p1.8.m3.2.2.1.1.1.2.2.2.1.cmml" xref="S3.SS3.SSS3.p1.8.m3.2.2.1.1.1.2.2.2">subscript</csymbol><ci id="S3.SS3.SSS3.p1.8.m3.2.2.1.1.1.2.2.2.2.cmml" xref="S3.SS3.SSS3.p1.8.m3.2.2.1.1.1.2.2.2.2">𝑑</ci><ci id="S3.SS3.SSS3.p1.8.m3.2.2.1.1.1.2.2.2.3.cmml" xref="S3.SS3.SSS3.p1.8.m3.2.2.1.1.1.2.2.2.3">𝑖</ci></apply><apply id="S3.SS3.SSS3.p1.8.m3.2.2.1.1.1.3.3.3.cmml" xref="S3.SS3.SSS3.p1.8.m3.2.2.1.1.1.3.3.3"><csymbol cd="latexml" id="S3.SS3.SSS3.p1.8.m3.2.2.1.1.1.3.3.3.2.cmml" xref="S3.SS3.SSS3.p1.8.m3.2.2.1.1.1.3.3.3">annotated</csymbol><apply id="S3.SS3.SSS3.p1.8.m3.2.2.1.1.1.3.3.3.3.cmml" xref="S3.SS3.SSS3.p1.8.m3.2.2.1.1.1.3.3.3.3"><csymbol cd="ambiguous" id="S3.SS3.SSS3.p1.8.m3.2.2.1.1.1.3.3.3.3.1.cmml" xref="S3.SS3.SSS3.p1.8.m3.2.2.1.1.1.3.3.3.3">subscript</csymbol><ci id="S3.SS3.SSS3.p1.8.m3.2.2.1.1.1.3.3.3.3.2.cmml" xref="S3.SS3.SSS3.p1.8.m3.2.2.1.1.1.3.3.3.3.2">𝑦</ci><ci id="S3.SS3.SSS3.p1.8.m3.2.2.1.1.1.3.3.3.3.3.cmml" xref="S3.SS3.SSS3.p1.8.m3.2.2.1.1.1.3.3.3.3.3">𝑖</ci></apply><apply id="S3.SS3.SSS3.p1.8.m3.2.2.1.1.1.3.3.3.1.1.1.cmml" xref="S3.SS3.SSS3.p1.8.m3.2.2.1.1.1.3.3.3.1.1"><lt id="S3.SS3.SSS3.p1.8.m3.2.2.1.1.1.3.3.3.1.1.1.1.cmml" xref="S3.SS3.SSS3.p1.8.m3.2.2.1.1.1.3.3.3.1.1.1.1"></lt><csymbol cd="latexml" id="S3.SS3.SSS3.p1.8.m3.2.2.1.1.1.3.3.3.1.1.1.2.cmml" xref="S3.SS3.SSS3.p1.8.m3.2.2.1.1.1.3.3.3.1.1.1.2">absent</csymbol><ci id="S3.SS3.SSS3.p1.8.m3.2.2.1.1.1.3.3.3.1.1.1.3.cmml" xref="S3.SS3.SSS3.p1.8.m3.2.2.1.1.1.3.3.3.1.1.1.3">𝑡</ci></apply></apply><apply id="S3.SS3.SSS3.p1.8.m3.2.2.1.1.1.4.4.4.cmml" xref="S3.SS3.SSS3.p1.8.m3.2.2.1.1.1.4.4.4"><csymbol cd="ambiguous" id="S3.SS3.SSS3.p1.8.m3.2.2.1.1.1.4.4.4.1.cmml" xref="S3.SS3.SSS3.p1.8.m3.2.2.1.1.1.4.4.4">subscript</csymbol><ci id="S3.SS3.SSS3.p1.8.m3.2.2.1.1.1.4.4.4.2.cmml" xref="S3.SS3.SSS3.p1.8.m3.2.2.1.1.1.4.4.4.2">𝜃</ci><cn id="S3.SS3.SSS3.p1.8.m3.2.2.1.1.1.4.4.4.3.cmml" type="integer" xref="S3.SS3.SSS3.p1.8.m3.2.2.1.1.1.4.4.4.3">2</cn></apply></list></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS3.p1.8.m3.2c">P(y_{i}(t)|P_{2}^{\prime},d_{i},y_{i}(&lt;t);\theta_{2})</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.SSS3.p1.8.m3.2d">italic_P ( italic_y start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT ( italic_t ) | italic_P start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT , italic_d start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT , italic_y start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT ( &lt; italic_t ) ; italic_θ start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT )</annotation></semantics></math> denotes the conditional probability of the target token <math alttext="y_{i}(t)" class="ltx_Math" display="inline" id="S3.SS3.SSS3.p1.9.m4.1"><semantics id="S3.SS3.SSS3.p1.9.m4.1a"><mrow id="S3.SS3.SSS3.p1.9.m4.1.2" xref="S3.SS3.SSS3.p1.9.m4.1.2.cmml"><msub id="S3.SS3.SSS3.p1.9.m4.1.2.2" xref="S3.SS3.SSS3.p1.9.m4.1.2.2.cmml"><mi id="S3.SS3.SSS3.p1.9.m4.1.2.2.2" xref="S3.SS3.SSS3.p1.9.m4.1.2.2.2.cmml">y</mi><mi id="S3.SS3.SSS3.p1.9.m4.1.2.2.3" xref="S3.SS3.SSS3.p1.9.m4.1.2.2.3.cmml">i</mi></msub><mo id="S3.SS3.SSS3.p1.9.m4.1.2.1" xref="S3.SS3.SSS3.p1.9.m4.1.2.1.cmml">⁢</mo><mrow id="S3.SS3.SSS3.p1.9.m4.1.2.3.2" xref="S3.SS3.SSS3.p1.9.m4.1.2.cmml"><mo id="S3.SS3.SSS3.p1.9.m4.1.2.3.2.1" stretchy="false" xref="S3.SS3.SSS3.p1.9.m4.1.2.cmml">(</mo><mi id="S3.SS3.SSS3.p1.9.m4.1.1" xref="S3.SS3.SSS3.p1.9.m4.1.1.cmml">t</mi><mo id="S3.SS3.SSS3.p1.9.m4.1.2.3.2.2" stretchy="false" xref="S3.SS3.SSS3.p1.9.m4.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS3.p1.9.m4.1b"><apply id="S3.SS3.SSS3.p1.9.m4.1.2.cmml" xref="S3.SS3.SSS3.p1.9.m4.1.2"><times id="S3.SS3.SSS3.p1.9.m4.1.2.1.cmml" xref="S3.SS3.SSS3.p1.9.m4.1.2.1"></times><apply id="S3.SS3.SSS3.p1.9.m4.1.2.2.cmml" xref="S3.SS3.SSS3.p1.9.m4.1.2.2"><csymbol cd="ambiguous" id="S3.SS3.SSS3.p1.9.m4.1.2.2.1.cmml" xref="S3.SS3.SSS3.p1.9.m4.1.2.2">subscript</csymbol><ci id="S3.SS3.SSS3.p1.9.m4.1.2.2.2.cmml" xref="S3.SS3.SSS3.p1.9.m4.1.2.2.2">𝑦</ci><ci id="S3.SS3.SSS3.p1.9.m4.1.2.2.3.cmml" xref="S3.SS3.SSS3.p1.9.m4.1.2.2.3">𝑖</ci></apply><ci id="S3.SS3.SSS3.p1.9.m4.1.1.cmml" xref="S3.SS3.SSS3.p1.9.m4.1.1">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS3.p1.9.m4.1c">y_{i}(t)</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.SSS3.p1.9.m4.1d">italic_y start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT ( italic_t )</annotation></semantics></math> given the instruct prompt <math alttext="P_{2}^{\prime}" class="ltx_Math" display="inline" id="S3.SS3.SSS3.p1.10.m5.1"><semantics id="S3.SS3.SSS3.p1.10.m5.1a"><msubsup id="S3.SS3.SSS3.p1.10.m5.1.1" xref="S3.SS3.SSS3.p1.10.m5.1.1.cmml"><mi id="S3.SS3.SSS3.p1.10.m5.1.1.2.2" xref="S3.SS3.SSS3.p1.10.m5.1.1.2.2.cmml">P</mi><mn id="S3.SS3.SSS3.p1.10.m5.1.1.2.3" xref="S3.SS3.SSS3.p1.10.m5.1.1.2.3.cmml">2</mn><mo id="S3.SS3.SSS3.p1.10.m5.1.1.3" xref="S3.SS3.SSS3.p1.10.m5.1.1.3.cmml">′</mo></msubsup><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS3.p1.10.m5.1b"><apply id="S3.SS3.SSS3.p1.10.m5.1.1.cmml" xref="S3.SS3.SSS3.p1.10.m5.1.1"><csymbol cd="ambiguous" id="S3.SS3.SSS3.p1.10.m5.1.1.1.cmml" xref="S3.SS3.SSS3.p1.10.m5.1.1">superscript</csymbol><apply id="S3.SS3.SSS3.p1.10.m5.1.1.2.cmml" xref="S3.SS3.SSS3.p1.10.m5.1.1"><csymbol cd="ambiguous" id="S3.SS3.SSS3.p1.10.m5.1.1.2.1.cmml" xref="S3.SS3.SSS3.p1.10.m5.1.1">subscript</csymbol><ci id="S3.SS3.SSS3.p1.10.m5.1.1.2.2.cmml" xref="S3.SS3.SSS3.p1.10.m5.1.1.2.2">𝑃</ci><cn id="S3.SS3.SSS3.p1.10.m5.1.1.2.3.cmml" type="integer" xref="S3.SS3.SSS3.p1.10.m5.1.1.2.3">2</cn></apply><ci id="S3.SS3.SSS3.p1.10.m5.1.1.3.cmml" xref="S3.SS3.SSS3.p1.10.m5.1.1.3">′</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS3.p1.10.m5.1c">P_{2}^{\prime}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.SSS3.p1.10.m5.1d">italic_P start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT</annotation></semantics></math>, dialogue <math alttext="d_{i}" class="ltx_Math" display="inline" id="S3.SS3.SSS3.p1.11.m6.1"><semantics id="S3.SS3.SSS3.p1.11.m6.1a"><msub id="S3.SS3.SSS3.p1.11.m6.1.1" xref="S3.SS3.SSS3.p1.11.m6.1.1.cmml"><mi id="S3.SS3.SSS3.p1.11.m6.1.1.2" xref="S3.SS3.SSS3.p1.11.m6.1.1.2.cmml">d</mi><mi id="S3.SS3.SSS3.p1.11.m6.1.1.3" xref="S3.SS3.SSS3.p1.11.m6.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS3.p1.11.m6.1b"><apply id="S3.SS3.SSS3.p1.11.m6.1.1.cmml" xref="S3.SS3.SSS3.p1.11.m6.1.1"><csymbol cd="ambiguous" id="S3.SS3.SSS3.p1.11.m6.1.1.1.cmml" xref="S3.SS3.SSS3.p1.11.m6.1.1">subscript</csymbol><ci id="S3.SS3.SSS3.p1.11.m6.1.1.2.cmml" xref="S3.SS3.SSS3.p1.11.m6.1.1.2">𝑑</ci><ci id="S3.SS3.SSS3.p1.11.m6.1.1.3.cmml" xref="S3.SS3.SSS3.p1.11.m6.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS3.p1.11.m6.1c">d_{i}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.SSS3.p1.11.m6.1d">italic_d start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT</annotation></semantics></math>, and the preceding tokens <math alttext="y_{i}(&lt;t)=\{y_{i}(1),...,y_{i}(t-1)\}" class="ltx_Math" display="inline" id="S3.SS3.SSS3.p1.12.m7.5"><semantics id="S3.SS3.SSS3.p1.12.m7.5a"><mrow id="S3.SS3.SSS3.p1.12.m7.5.5" xref="S3.SS3.SSS3.p1.12.m7.5.5.cmml"><mrow id="S3.SS3.SSS3.p1.12.m7.3.3.1" xref="S3.SS3.SSS3.p1.12.m7.3.3.1.cmml"><msub id="S3.SS3.SSS3.p1.12.m7.3.3.1.3" xref="S3.SS3.SSS3.p1.12.m7.3.3.1.3.cmml"><mi id="S3.SS3.SSS3.p1.12.m7.3.3.1.3.2" xref="S3.SS3.SSS3.p1.12.m7.3.3.1.3.2.cmml">y</mi><mi id="S3.SS3.SSS3.p1.12.m7.3.3.1.3.3" xref="S3.SS3.SSS3.p1.12.m7.3.3.1.3.3.cmml">i</mi></msub><mspace id="S3.SS3.SSS3.p1.12.m7.3.3.1a" width="0.3888888888888889em" xref="S3.SS3.SSS3.p1.12.m7.3.3.1.cmml"></mspace><mrow id="S3.SS3.SSS3.p1.12.m7.3.3.1.1.1" xref="S3.SS3.SSS3.p1.12.m7.3.3.1.1.1.1.cmml"><mo id="S3.SS3.SSS3.p1.12.m7.3.3.1.1.1.2" stretchy="false" xref="S3.SS3.SSS3.p1.12.m7.3.3.1.1.1.1.cmml">(</mo><mrow id="S3.SS3.SSS3.p1.12.m7.3.3.1.1.1.1" xref="S3.SS3.SSS3.p1.12.m7.3.3.1.1.1.1.cmml"><mi id="S3.SS3.SSS3.p1.12.m7.3.3.1.1.1.1.2" xref="S3.SS3.SSS3.p1.12.m7.3.3.1.1.1.1.2.cmml"></mi><mo id="S3.SS3.SSS3.p1.12.m7.3.3.1.1.1.1.1" xref="S3.SS3.SSS3.p1.12.m7.3.3.1.1.1.1.1.cmml">&lt;</mo><mi id="S3.SS3.SSS3.p1.12.m7.3.3.1.1.1.1.3" xref="S3.SS3.SSS3.p1.12.m7.3.3.1.1.1.1.3.cmml">t</mi></mrow><mo id="S3.SS3.SSS3.p1.12.m7.3.3.1.1.1.3" stretchy="false" xref="S3.SS3.SSS3.p1.12.m7.3.3.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S3.SS3.SSS3.p1.12.m7.5.5.4" xref="S3.SS3.SSS3.p1.12.m7.5.5.4.cmml">=</mo><mrow id="S3.SS3.SSS3.p1.12.m7.5.5.3.2" xref="S3.SS3.SSS3.p1.12.m7.5.5.3.3.cmml"><mo id="S3.SS3.SSS3.p1.12.m7.5.5.3.2.3" stretchy="false" xref="S3.SS3.SSS3.p1.12.m7.5.5.3.3.cmml">{</mo><mrow id="S3.SS3.SSS3.p1.12.m7.4.4.2.1.1" xref="S3.SS3.SSS3.p1.12.m7.4.4.2.1.1.cmml"><msub id="S3.SS3.SSS3.p1.12.m7.4.4.2.1.1.2" xref="S3.SS3.SSS3.p1.12.m7.4.4.2.1.1.2.cmml"><mi id="S3.SS3.SSS3.p1.12.m7.4.4.2.1.1.2.2" xref="S3.SS3.SSS3.p1.12.m7.4.4.2.1.1.2.2.cmml">y</mi><mi id="S3.SS3.SSS3.p1.12.m7.4.4.2.1.1.2.3" xref="S3.SS3.SSS3.p1.12.m7.4.4.2.1.1.2.3.cmml">i</mi></msub><mo id="S3.SS3.SSS3.p1.12.m7.4.4.2.1.1.1" xref="S3.SS3.SSS3.p1.12.m7.4.4.2.1.1.1.cmml">⁢</mo><mrow id="S3.SS3.SSS3.p1.12.m7.4.4.2.1.1.3.2" xref="S3.SS3.SSS3.p1.12.m7.4.4.2.1.1.cmml"><mo id="S3.SS3.SSS3.p1.12.m7.4.4.2.1.1.3.2.1" stretchy="false" xref="S3.SS3.SSS3.p1.12.m7.4.4.2.1.1.cmml">(</mo><mn id="S3.SS3.SSS3.p1.12.m7.1.1" xref="S3.SS3.SSS3.p1.12.m7.1.1.cmml">1</mn><mo id="S3.SS3.SSS3.p1.12.m7.4.4.2.1.1.3.2.2" stretchy="false" xref="S3.SS3.SSS3.p1.12.m7.4.4.2.1.1.cmml">)</mo></mrow></mrow><mo id="S3.SS3.SSS3.p1.12.m7.5.5.3.2.4" xref="S3.SS3.SSS3.p1.12.m7.5.5.3.3.cmml">,</mo><mi id="S3.SS3.SSS3.p1.12.m7.2.2" mathvariant="normal" xref="S3.SS3.SSS3.p1.12.m7.2.2.cmml">…</mi><mo id="S3.SS3.SSS3.p1.12.m7.5.5.3.2.5" xref="S3.SS3.SSS3.p1.12.m7.5.5.3.3.cmml">,</mo><mrow id="S3.SS3.SSS3.p1.12.m7.5.5.3.2.2" xref="S3.SS3.SSS3.p1.12.m7.5.5.3.2.2.cmml"><msub id="S3.SS3.SSS3.p1.12.m7.5.5.3.2.2.3" xref="S3.SS3.SSS3.p1.12.m7.5.5.3.2.2.3.cmml"><mi id="S3.SS3.SSS3.p1.12.m7.5.5.3.2.2.3.2" xref="S3.SS3.SSS3.p1.12.m7.5.5.3.2.2.3.2.cmml">y</mi><mi id="S3.SS3.SSS3.p1.12.m7.5.5.3.2.2.3.3" xref="S3.SS3.SSS3.p1.12.m7.5.5.3.2.2.3.3.cmml">i</mi></msub><mo id="S3.SS3.SSS3.p1.12.m7.5.5.3.2.2.2" xref="S3.SS3.SSS3.p1.12.m7.5.5.3.2.2.2.cmml">⁢</mo><mrow id="S3.SS3.SSS3.p1.12.m7.5.5.3.2.2.1.1" xref="S3.SS3.SSS3.p1.12.m7.5.5.3.2.2.1.1.1.cmml"><mo id="S3.SS3.SSS3.p1.12.m7.5.5.3.2.2.1.1.2" stretchy="false" xref="S3.SS3.SSS3.p1.12.m7.5.5.3.2.2.1.1.1.cmml">(</mo><mrow id="S3.SS3.SSS3.p1.12.m7.5.5.3.2.2.1.1.1" xref="S3.SS3.SSS3.p1.12.m7.5.5.3.2.2.1.1.1.cmml"><mi id="S3.SS3.SSS3.p1.12.m7.5.5.3.2.2.1.1.1.2" xref="S3.SS3.SSS3.p1.12.m7.5.5.3.2.2.1.1.1.2.cmml">t</mi><mo id="S3.SS3.SSS3.p1.12.m7.5.5.3.2.2.1.1.1.1" xref="S3.SS3.SSS3.p1.12.m7.5.5.3.2.2.1.1.1.1.cmml">−</mo><mn id="S3.SS3.SSS3.p1.12.m7.5.5.3.2.2.1.1.1.3" xref="S3.SS3.SSS3.p1.12.m7.5.5.3.2.2.1.1.1.3.cmml">1</mn></mrow><mo id="S3.SS3.SSS3.p1.12.m7.5.5.3.2.2.1.1.3" stretchy="false" xref="S3.SS3.SSS3.p1.12.m7.5.5.3.2.2.1.1.1.cmml">)</mo></mrow></mrow><mo id="S3.SS3.SSS3.p1.12.m7.5.5.3.2.6" stretchy="false" xref="S3.SS3.SSS3.p1.12.m7.5.5.3.3.cmml">}</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS3.p1.12.m7.5b"><apply id="S3.SS3.SSS3.p1.12.m7.5.5.cmml" xref="S3.SS3.SSS3.p1.12.m7.5.5"><eq id="S3.SS3.SSS3.p1.12.m7.5.5.4.cmml" xref="S3.SS3.SSS3.p1.12.m7.5.5.4"></eq><apply id="S3.SS3.SSS3.p1.12.m7.3.3.1.cmml" xref="S3.SS3.SSS3.p1.12.m7.3.3.1"><csymbol cd="latexml" id="S3.SS3.SSS3.p1.12.m7.3.3.1.2.cmml" xref="S3.SS3.SSS3.p1.12.m7.3.3.1">annotated</csymbol><apply id="S3.SS3.SSS3.p1.12.m7.3.3.1.3.cmml" xref="S3.SS3.SSS3.p1.12.m7.3.3.1.3"><csymbol cd="ambiguous" id="S3.SS3.SSS3.p1.12.m7.3.3.1.3.1.cmml" xref="S3.SS3.SSS3.p1.12.m7.3.3.1.3">subscript</csymbol><ci id="S3.SS3.SSS3.p1.12.m7.3.3.1.3.2.cmml" xref="S3.SS3.SSS3.p1.12.m7.3.3.1.3.2">𝑦</ci><ci id="S3.SS3.SSS3.p1.12.m7.3.3.1.3.3.cmml" xref="S3.SS3.SSS3.p1.12.m7.3.3.1.3.3">𝑖</ci></apply><apply id="S3.SS3.SSS3.p1.12.m7.3.3.1.1.1.1.cmml" xref="S3.SS3.SSS3.p1.12.m7.3.3.1.1.1"><lt id="S3.SS3.SSS3.p1.12.m7.3.3.1.1.1.1.1.cmml" xref="S3.SS3.SSS3.p1.12.m7.3.3.1.1.1.1.1"></lt><csymbol cd="latexml" id="S3.SS3.SSS3.p1.12.m7.3.3.1.1.1.1.2.cmml" xref="S3.SS3.SSS3.p1.12.m7.3.3.1.1.1.1.2">absent</csymbol><ci id="S3.SS3.SSS3.p1.12.m7.3.3.1.1.1.1.3.cmml" xref="S3.SS3.SSS3.p1.12.m7.3.3.1.1.1.1.3">𝑡</ci></apply></apply><set id="S3.SS3.SSS3.p1.12.m7.5.5.3.3.cmml" xref="S3.SS3.SSS3.p1.12.m7.5.5.3.2"><apply id="S3.SS3.SSS3.p1.12.m7.4.4.2.1.1.cmml" xref="S3.SS3.SSS3.p1.12.m7.4.4.2.1.1"><times id="S3.SS3.SSS3.p1.12.m7.4.4.2.1.1.1.cmml" xref="S3.SS3.SSS3.p1.12.m7.4.4.2.1.1.1"></times><apply id="S3.SS3.SSS3.p1.12.m7.4.4.2.1.1.2.cmml" xref="S3.SS3.SSS3.p1.12.m7.4.4.2.1.1.2"><csymbol cd="ambiguous" id="S3.SS3.SSS3.p1.12.m7.4.4.2.1.1.2.1.cmml" xref="S3.SS3.SSS3.p1.12.m7.4.4.2.1.1.2">subscript</csymbol><ci id="S3.SS3.SSS3.p1.12.m7.4.4.2.1.1.2.2.cmml" xref="S3.SS3.SSS3.p1.12.m7.4.4.2.1.1.2.2">𝑦</ci><ci id="S3.SS3.SSS3.p1.12.m7.4.4.2.1.1.2.3.cmml" xref="S3.SS3.SSS3.p1.12.m7.4.4.2.1.1.2.3">𝑖</ci></apply><cn id="S3.SS3.SSS3.p1.12.m7.1.1.cmml" type="integer" xref="S3.SS3.SSS3.p1.12.m7.1.1">1</cn></apply><ci id="S3.SS3.SSS3.p1.12.m7.2.2.cmml" xref="S3.SS3.SSS3.p1.12.m7.2.2">…</ci><apply id="S3.SS3.SSS3.p1.12.m7.5.5.3.2.2.cmml" xref="S3.SS3.SSS3.p1.12.m7.5.5.3.2.2"><times id="S3.SS3.SSS3.p1.12.m7.5.5.3.2.2.2.cmml" xref="S3.SS3.SSS3.p1.12.m7.5.5.3.2.2.2"></times><apply id="S3.SS3.SSS3.p1.12.m7.5.5.3.2.2.3.cmml" xref="S3.SS3.SSS3.p1.12.m7.5.5.3.2.2.3"><csymbol cd="ambiguous" id="S3.SS3.SSS3.p1.12.m7.5.5.3.2.2.3.1.cmml" xref="S3.SS3.SSS3.p1.12.m7.5.5.3.2.2.3">subscript</csymbol><ci id="S3.SS3.SSS3.p1.12.m7.5.5.3.2.2.3.2.cmml" xref="S3.SS3.SSS3.p1.12.m7.5.5.3.2.2.3.2">𝑦</ci><ci id="S3.SS3.SSS3.p1.12.m7.5.5.3.2.2.3.3.cmml" xref="S3.SS3.SSS3.p1.12.m7.5.5.3.2.2.3.3">𝑖</ci></apply><apply id="S3.SS3.SSS3.p1.12.m7.5.5.3.2.2.1.1.1.cmml" xref="S3.SS3.SSS3.p1.12.m7.5.5.3.2.2.1.1"><minus id="S3.SS3.SSS3.p1.12.m7.5.5.3.2.2.1.1.1.1.cmml" xref="S3.SS3.SSS3.p1.12.m7.5.5.3.2.2.1.1.1.1"></minus><ci id="S3.SS3.SSS3.p1.12.m7.5.5.3.2.2.1.1.1.2.cmml" xref="S3.SS3.SSS3.p1.12.m7.5.5.3.2.2.1.1.1.2">𝑡</ci><cn id="S3.SS3.SSS3.p1.12.m7.5.5.3.2.2.1.1.1.3.cmml" type="integer" xref="S3.SS3.SSS3.p1.12.m7.5.5.3.2.2.1.1.1.3">1</cn></apply></apply></set></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS3.p1.12.m7.5c">y_{i}(&lt;t)=\{y_{i}(1),...,y_{i}(t-1)\}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.SSS3.p1.12.m7.5d">italic_y start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT ( &lt; italic_t ) = { italic_y start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT ( 1 ) , … , italic_y start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT ( italic_t - 1 ) }</annotation></semantics></math> in the sequence. <math alttext="\theta_{2}" class="ltx_Math" display="inline" id="S3.SS3.SSS3.p1.13.m8.1"><semantics id="S3.SS3.SSS3.p1.13.m8.1a"><msub id="S3.SS3.SSS3.p1.13.m8.1.1" xref="S3.SS3.SSS3.p1.13.m8.1.1.cmml"><mi id="S3.SS3.SSS3.p1.13.m8.1.1.2" xref="S3.SS3.SSS3.p1.13.m8.1.1.2.cmml">θ</mi><mn id="S3.SS3.SSS3.p1.13.m8.1.1.3" xref="S3.SS3.SSS3.p1.13.m8.1.1.3.cmml">2</mn></msub><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS3.p1.13.m8.1b"><apply id="S3.SS3.SSS3.p1.13.m8.1.1.cmml" xref="S3.SS3.SSS3.p1.13.m8.1.1"><csymbol cd="ambiguous" id="S3.SS3.SSS3.p1.13.m8.1.1.1.cmml" xref="S3.SS3.SSS3.p1.13.m8.1.1">subscript</csymbol><ci id="S3.SS3.SSS3.p1.13.m8.1.1.2.cmml" xref="S3.SS3.SSS3.p1.13.m8.1.1.2">𝜃</ci><cn id="S3.SS3.SSS3.p1.13.m8.1.1.3.cmml" type="integer" xref="S3.SS3.SSS3.p1.13.m8.1.1.3">2</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS3.p1.13.m8.1c">\theta_{2}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.SSS3.p1.13.m8.1d">italic_θ start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT</annotation></semantics></math> indicates model parameters.
By summing over the entire dataset <math alttext="\mathcal{D}^{\prime}" class="ltx_Math" display="inline" id="S3.SS3.SSS3.p1.14.m9.1"><semantics id="S3.SS3.SSS3.p1.14.m9.1a"><msup id="S3.SS3.SSS3.p1.14.m9.1.1" xref="S3.SS3.SSS3.p1.14.m9.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS3.SSS3.p1.14.m9.1.1.2" xref="S3.SS3.SSS3.p1.14.m9.1.1.2.cmml">𝒟</mi><mo id="S3.SS3.SSS3.p1.14.m9.1.1.3" xref="S3.SS3.SSS3.p1.14.m9.1.1.3.cmml">′</mo></msup><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS3.p1.14.m9.1b"><apply id="S3.SS3.SSS3.p1.14.m9.1.1.cmml" xref="S3.SS3.SSS3.p1.14.m9.1.1"><csymbol cd="ambiguous" id="S3.SS3.SSS3.p1.14.m9.1.1.1.cmml" xref="S3.SS3.SSS3.p1.14.m9.1.1">superscript</csymbol><ci id="S3.SS3.SSS3.p1.14.m9.1.1.2.cmml" xref="S3.SS3.SSS3.p1.14.m9.1.1.2">𝒟</ci><ci id="S3.SS3.SSS3.p1.14.m9.1.1.3.cmml" xref="S3.SS3.SSS3.p1.14.m9.1.1.3">′</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS3.p1.14.m9.1c">\mathcal{D}^{\prime}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.SSS3.p1.14.m9.1d">caligraphic_D start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT</annotation></semantics></math>, the overall loss function <math alttext="\mathcal{L}_{2}(\theta_{2};\mathcal{D}^{\prime})" class="ltx_Math" display="inline" id="S3.SS3.SSS3.p1.15.m10.2"><semantics id="S3.SS3.SSS3.p1.15.m10.2a"><mrow id="S3.SS3.SSS3.p1.15.m10.2.2" xref="S3.SS3.SSS3.p1.15.m10.2.2.cmml"><msub id="S3.SS3.SSS3.p1.15.m10.2.2.4" xref="S3.SS3.SSS3.p1.15.m10.2.2.4.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS3.SSS3.p1.15.m10.2.2.4.2" xref="S3.SS3.SSS3.p1.15.m10.2.2.4.2.cmml">ℒ</mi><mn id="S3.SS3.SSS3.p1.15.m10.2.2.4.3" xref="S3.SS3.SSS3.p1.15.m10.2.2.4.3.cmml">2</mn></msub><mo id="S3.SS3.SSS3.p1.15.m10.2.2.3" xref="S3.SS3.SSS3.p1.15.m10.2.2.3.cmml">⁢</mo><mrow id="S3.SS3.SSS3.p1.15.m10.2.2.2.2" xref="S3.SS3.SSS3.p1.15.m10.2.2.2.3.cmml"><mo id="S3.SS3.SSS3.p1.15.m10.2.2.2.2.3" stretchy="false" xref="S3.SS3.SSS3.p1.15.m10.2.2.2.3.cmml">(</mo><msub id="S3.SS3.SSS3.p1.15.m10.1.1.1.1.1" xref="S3.SS3.SSS3.p1.15.m10.1.1.1.1.1.cmml"><mi id="S3.SS3.SSS3.p1.15.m10.1.1.1.1.1.2" xref="S3.SS3.SSS3.p1.15.m10.1.1.1.1.1.2.cmml">θ</mi><mn id="S3.SS3.SSS3.p1.15.m10.1.1.1.1.1.3" xref="S3.SS3.SSS3.p1.15.m10.1.1.1.1.1.3.cmml">2</mn></msub><mo id="S3.SS3.SSS3.p1.15.m10.2.2.2.2.4" xref="S3.SS3.SSS3.p1.15.m10.2.2.2.3.cmml">;</mo><msup id="S3.SS3.SSS3.p1.15.m10.2.2.2.2.2" xref="S3.SS3.SSS3.p1.15.m10.2.2.2.2.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS3.SSS3.p1.15.m10.2.2.2.2.2.2" xref="S3.SS3.SSS3.p1.15.m10.2.2.2.2.2.2.cmml">𝒟</mi><mo id="S3.SS3.SSS3.p1.15.m10.2.2.2.2.2.3" xref="S3.SS3.SSS3.p1.15.m10.2.2.2.2.2.3.cmml">′</mo></msup><mo id="S3.SS3.SSS3.p1.15.m10.2.2.2.2.5" stretchy="false" xref="S3.SS3.SSS3.p1.15.m10.2.2.2.3.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS3.p1.15.m10.2b"><apply id="S3.SS3.SSS3.p1.15.m10.2.2.cmml" xref="S3.SS3.SSS3.p1.15.m10.2.2"><times id="S3.SS3.SSS3.p1.15.m10.2.2.3.cmml" xref="S3.SS3.SSS3.p1.15.m10.2.2.3"></times><apply id="S3.SS3.SSS3.p1.15.m10.2.2.4.cmml" xref="S3.SS3.SSS3.p1.15.m10.2.2.4"><csymbol cd="ambiguous" id="S3.SS3.SSS3.p1.15.m10.2.2.4.1.cmml" xref="S3.SS3.SSS3.p1.15.m10.2.2.4">subscript</csymbol><ci id="S3.SS3.SSS3.p1.15.m10.2.2.4.2.cmml" xref="S3.SS3.SSS3.p1.15.m10.2.2.4.2">ℒ</ci><cn id="S3.SS3.SSS3.p1.15.m10.2.2.4.3.cmml" type="integer" xref="S3.SS3.SSS3.p1.15.m10.2.2.4.3">2</cn></apply><list id="S3.SS3.SSS3.p1.15.m10.2.2.2.3.cmml" xref="S3.SS3.SSS3.p1.15.m10.2.2.2.2"><apply id="S3.SS3.SSS3.p1.15.m10.1.1.1.1.1.cmml" xref="S3.SS3.SSS3.p1.15.m10.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS3.SSS3.p1.15.m10.1.1.1.1.1.1.cmml" xref="S3.SS3.SSS3.p1.15.m10.1.1.1.1.1">subscript</csymbol><ci id="S3.SS3.SSS3.p1.15.m10.1.1.1.1.1.2.cmml" xref="S3.SS3.SSS3.p1.15.m10.1.1.1.1.1.2">𝜃</ci><cn id="S3.SS3.SSS3.p1.15.m10.1.1.1.1.1.3.cmml" type="integer" xref="S3.SS3.SSS3.p1.15.m10.1.1.1.1.1.3">2</cn></apply><apply id="S3.SS3.SSS3.p1.15.m10.2.2.2.2.2.cmml" xref="S3.SS3.SSS3.p1.15.m10.2.2.2.2.2"><csymbol cd="ambiguous" id="S3.SS3.SSS3.p1.15.m10.2.2.2.2.2.1.cmml" xref="S3.SS3.SSS3.p1.15.m10.2.2.2.2.2">superscript</csymbol><ci id="S3.SS3.SSS3.p1.15.m10.2.2.2.2.2.2.cmml" xref="S3.SS3.SSS3.p1.15.m10.2.2.2.2.2.2">𝒟</ci><ci id="S3.SS3.SSS3.p1.15.m10.2.2.2.2.2.3.cmml" xref="S3.SS3.SSS3.p1.15.m10.2.2.2.2.2.3">′</ci></apply></list></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS3.p1.15.m10.2c">\mathcal{L}_{2}(\theta_{2};\mathcal{D}^{\prime})</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.SSS3.p1.15.m10.2d">caligraphic_L start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT ( italic_θ start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT ; caligraphic_D start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT )</annotation></semantics></math> is given by:</p>
<table class="ltx_equation ltx_eqn_table" id="S3.E12">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_left" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_left">(12)</span></td>
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\mathcal{L}_{2}(\theta_{2};\mathcal{D}^{\prime})=\sum_{i=1}^{I}\left[-\sum_{t=%
1}^{T_{i}^{\prime}}\log P(y_{i}(t)|P_{2}^{\prime},d_{i},y_{i}(&lt;t);\theta_{2})\right]" class="ltx_Math" display="block" id="S3.E12.m1.4"><semantics id="S3.E12.m1.4a"><mrow id="S3.E12.m1.4.4" xref="S3.E12.m1.4.4.cmml"><mrow id="S3.E12.m1.3.3.2" xref="S3.E12.m1.3.3.2.cmml"><msub id="S3.E12.m1.3.3.2.4" xref="S3.E12.m1.3.3.2.4.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.E12.m1.3.3.2.4.2" xref="S3.E12.m1.3.3.2.4.2.cmml">ℒ</mi><mn id="S3.E12.m1.3.3.2.4.3" xref="S3.E12.m1.3.3.2.4.3.cmml">2</mn></msub><mo id="S3.E12.m1.3.3.2.3" xref="S3.E12.m1.3.3.2.3.cmml">⁢</mo><mrow id="S3.E12.m1.3.3.2.2.2" xref="S3.E12.m1.3.3.2.2.3.cmml"><mo id="S3.E12.m1.3.3.2.2.2.3" stretchy="false" xref="S3.E12.m1.3.3.2.2.3.cmml">(</mo><msub id="S3.E12.m1.2.2.1.1.1.1" xref="S3.E12.m1.2.2.1.1.1.1.cmml"><mi id="S3.E12.m1.2.2.1.1.1.1.2" xref="S3.E12.m1.2.2.1.1.1.1.2.cmml">θ</mi><mn id="S3.E12.m1.2.2.1.1.1.1.3" xref="S3.E12.m1.2.2.1.1.1.1.3.cmml">2</mn></msub><mo id="S3.E12.m1.3.3.2.2.2.4" xref="S3.E12.m1.3.3.2.2.3.cmml">;</mo><msup id="S3.E12.m1.3.3.2.2.2.2" xref="S3.E12.m1.3.3.2.2.2.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.E12.m1.3.3.2.2.2.2.2" xref="S3.E12.m1.3.3.2.2.2.2.2.cmml">𝒟</mi><mo id="S3.E12.m1.3.3.2.2.2.2.3" xref="S3.E12.m1.3.3.2.2.2.2.3.cmml">′</mo></msup><mo id="S3.E12.m1.3.3.2.2.2.5" stretchy="false" xref="S3.E12.m1.3.3.2.2.3.cmml">)</mo></mrow></mrow><mo id="S3.E12.m1.4.4.4" rspace="0.111em" xref="S3.E12.m1.4.4.4.cmml">=</mo><mrow id="S3.E12.m1.4.4.3" xref="S3.E12.m1.4.4.3.cmml"><munderover id="S3.E12.m1.4.4.3.2" xref="S3.E12.m1.4.4.3.2.cmml"><mo id="S3.E12.m1.4.4.3.2.2.2" movablelimits="false" rspace="0em" xref="S3.E12.m1.4.4.3.2.2.2.cmml">∑</mo><mrow id="S3.E12.m1.4.4.3.2.2.3" xref="S3.E12.m1.4.4.3.2.2.3.cmml"><mi id="S3.E12.m1.4.4.3.2.2.3.2" xref="S3.E12.m1.4.4.3.2.2.3.2.cmml">i</mi><mo id="S3.E12.m1.4.4.3.2.2.3.1" xref="S3.E12.m1.4.4.3.2.2.3.1.cmml">=</mo><mn id="S3.E12.m1.4.4.3.2.2.3.3" xref="S3.E12.m1.4.4.3.2.2.3.3.cmml">1</mn></mrow><mi id="S3.E12.m1.4.4.3.2.3" xref="S3.E12.m1.4.4.3.2.3.cmml">I</mi></munderover><mrow id="S3.E12.m1.4.4.3.1.1" xref="S3.E12.m1.4.4.3.1.2.cmml"><mo id="S3.E12.m1.4.4.3.1.1.2" xref="S3.E12.m1.4.4.3.1.2.1.cmml">[</mo><mrow id="S3.E12.m1.4.4.3.1.1.1" xref="S3.E12.m1.4.4.3.1.1.1.cmml"><mo id="S3.E12.m1.4.4.3.1.1.1a" xref="S3.E12.m1.4.4.3.1.1.1.cmml">−</mo><mrow id="S3.E12.m1.4.4.3.1.1.1.1" xref="S3.E12.m1.4.4.3.1.1.1.1.cmml"><munderover id="S3.E12.m1.4.4.3.1.1.1.1.2" xref="S3.E12.m1.4.4.3.1.1.1.1.2.cmml"><mo id="S3.E12.m1.4.4.3.1.1.1.1.2.2.2" movablelimits="false" xref="S3.E12.m1.4.4.3.1.1.1.1.2.2.2.cmml">∑</mo><mrow id="S3.E12.m1.4.4.3.1.1.1.1.2.2.3" xref="S3.E12.m1.4.4.3.1.1.1.1.2.2.3.cmml"><mi id="S3.E12.m1.4.4.3.1.1.1.1.2.2.3.2" xref="S3.E12.m1.4.4.3.1.1.1.1.2.2.3.2.cmml">t</mi><mo id="S3.E12.m1.4.4.3.1.1.1.1.2.2.3.1" xref="S3.E12.m1.4.4.3.1.1.1.1.2.2.3.1.cmml">=</mo><mn id="S3.E12.m1.4.4.3.1.1.1.1.2.2.3.3" xref="S3.E12.m1.4.4.3.1.1.1.1.2.2.3.3.cmml">1</mn></mrow><msubsup id="S3.E12.m1.4.4.3.1.1.1.1.2.3" xref="S3.E12.m1.4.4.3.1.1.1.1.2.3.cmml"><mi id="S3.E12.m1.4.4.3.1.1.1.1.2.3.2.2" xref="S3.E12.m1.4.4.3.1.1.1.1.2.3.2.2.cmml">T</mi><mi id="S3.E12.m1.4.4.3.1.1.1.1.2.3.2.3" xref="S3.E12.m1.4.4.3.1.1.1.1.2.3.2.3.cmml">i</mi><mo id="S3.E12.m1.4.4.3.1.1.1.1.2.3.3" xref="S3.E12.m1.4.4.3.1.1.1.1.2.3.3.cmml">′</mo></msubsup></munderover><mrow id="S3.E12.m1.4.4.3.1.1.1.1.1" xref="S3.E12.m1.4.4.3.1.1.1.1.1.cmml"><mrow id="S3.E12.m1.4.4.3.1.1.1.1.1.3" xref="S3.E12.m1.4.4.3.1.1.1.1.1.3.cmml"><mi id="S3.E12.m1.4.4.3.1.1.1.1.1.3.1" xref="S3.E12.m1.4.4.3.1.1.1.1.1.3.1.cmml">log</mi><mo id="S3.E12.m1.4.4.3.1.1.1.1.1.3a" lspace="0.167em" xref="S3.E12.m1.4.4.3.1.1.1.1.1.3.cmml">⁡</mo><mi id="S3.E12.m1.4.4.3.1.1.1.1.1.3.2" xref="S3.E12.m1.4.4.3.1.1.1.1.1.3.2.cmml">P</mi></mrow><mo id="S3.E12.m1.4.4.3.1.1.1.1.1.2" xref="S3.E12.m1.4.4.3.1.1.1.1.1.2.cmml">⁢</mo><mrow id="S3.E12.m1.4.4.3.1.1.1.1.1.1.1" xref="S3.E12.m1.4.4.3.1.1.1.1.1.1.1.1.cmml"><mo id="S3.E12.m1.4.4.3.1.1.1.1.1.1.1.2" stretchy="false" xref="S3.E12.m1.4.4.3.1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="S3.E12.m1.4.4.3.1.1.1.1.1.1.1.1" xref="S3.E12.m1.4.4.3.1.1.1.1.1.1.1.1.cmml"><mrow id="S3.E12.m1.4.4.3.1.1.1.1.1.1.1.1.6" xref="S3.E12.m1.4.4.3.1.1.1.1.1.1.1.1.6.cmml"><msub id="S3.E12.m1.4.4.3.1.1.1.1.1.1.1.1.6.2" xref="S3.E12.m1.4.4.3.1.1.1.1.1.1.1.1.6.2.cmml"><mi id="S3.E12.m1.4.4.3.1.1.1.1.1.1.1.1.6.2.2" xref="S3.E12.m1.4.4.3.1.1.1.1.1.1.1.1.6.2.2.cmml">y</mi><mi id="S3.E12.m1.4.4.3.1.1.1.1.1.1.1.1.6.2.3" xref="S3.E12.m1.4.4.3.1.1.1.1.1.1.1.1.6.2.3.cmml">i</mi></msub><mo id="S3.E12.m1.4.4.3.1.1.1.1.1.1.1.1.6.1" xref="S3.E12.m1.4.4.3.1.1.1.1.1.1.1.1.6.1.cmml">⁢</mo><mrow id="S3.E12.m1.4.4.3.1.1.1.1.1.1.1.1.6.3.2" xref="S3.E12.m1.4.4.3.1.1.1.1.1.1.1.1.6.cmml"><mo id="S3.E12.m1.4.4.3.1.1.1.1.1.1.1.1.6.3.2.1" stretchy="false" xref="S3.E12.m1.4.4.3.1.1.1.1.1.1.1.1.6.cmml">(</mo><mi id="S3.E12.m1.1.1" xref="S3.E12.m1.1.1.cmml">t</mi><mo id="S3.E12.m1.4.4.3.1.1.1.1.1.1.1.1.6.3.2.2" stretchy="false" xref="S3.E12.m1.4.4.3.1.1.1.1.1.1.1.1.6.cmml">)</mo></mrow></mrow><mo fence="false" id="S3.E12.m1.4.4.3.1.1.1.1.1.1.1.1.5" xref="S3.E12.m1.4.4.3.1.1.1.1.1.1.1.1.5.cmml">|</mo><mrow id="S3.E12.m1.4.4.3.1.1.1.1.1.1.1.1.4.4" xref="S3.E12.m1.4.4.3.1.1.1.1.1.1.1.1.4.5.cmml"><msubsup id="S3.E12.m1.4.4.3.1.1.1.1.1.1.1.1.1.1.1" xref="S3.E12.m1.4.4.3.1.1.1.1.1.1.1.1.1.1.1.cmml"><mi id="S3.E12.m1.4.4.3.1.1.1.1.1.1.1.1.1.1.1.2.2" xref="S3.E12.m1.4.4.3.1.1.1.1.1.1.1.1.1.1.1.2.2.cmml">P</mi><mn id="S3.E12.m1.4.4.3.1.1.1.1.1.1.1.1.1.1.1.2.3" xref="S3.E12.m1.4.4.3.1.1.1.1.1.1.1.1.1.1.1.2.3.cmml">2</mn><mo id="S3.E12.m1.4.4.3.1.1.1.1.1.1.1.1.1.1.1.3" xref="S3.E12.m1.4.4.3.1.1.1.1.1.1.1.1.1.1.1.3.cmml">′</mo></msubsup><mo id="S3.E12.m1.4.4.3.1.1.1.1.1.1.1.1.4.4.5" xref="S3.E12.m1.4.4.3.1.1.1.1.1.1.1.1.4.5.cmml">,</mo><msub id="S3.E12.m1.4.4.3.1.1.1.1.1.1.1.1.2.2.2" xref="S3.E12.m1.4.4.3.1.1.1.1.1.1.1.1.2.2.2.cmml"><mi id="S3.E12.m1.4.4.3.1.1.1.1.1.1.1.1.2.2.2.2" xref="S3.E12.m1.4.4.3.1.1.1.1.1.1.1.1.2.2.2.2.cmml">d</mi><mi id="S3.E12.m1.4.4.3.1.1.1.1.1.1.1.1.2.2.2.3" xref="S3.E12.m1.4.4.3.1.1.1.1.1.1.1.1.2.2.2.3.cmml">i</mi></msub><mo id="S3.E12.m1.4.4.3.1.1.1.1.1.1.1.1.4.4.6" xref="S3.E12.m1.4.4.3.1.1.1.1.1.1.1.1.4.5.cmml">,</mo><mrow id="S3.E12.m1.4.4.3.1.1.1.1.1.1.1.1.3.3.3" xref="S3.E12.m1.4.4.3.1.1.1.1.1.1.1.1.3.3.3.cmml"><msub id="S3.E12.m1.4.4.3.1.1.1.1.1.1.1.1.3.3.3.3" xref="S3.E12.m1.4.4.3.1.1.1.1.1.1.1.1.3.3.3.3.cmml"><mi id="S3.E12.m1.4.4.3.1.1.1.1.1.1.1.1.3.3.3.3.2" xref="S3.E12.m1.4.4.3.1.1.1.1.1.1.1.1.3.3.3.3.2.cmml">y</mi><mi id="S3.E12.m1.4.4.3.1.1.1.1.1.1.1.1.3.3.3.3.3" xref="S3.E12.m1.4.4.3.1.1.1.1.1.1.1.1.3.3.3.3.3.cmml">i</mi></msub><mspace id="S3.E12.m1.4.4.3.1.1.1.1.1.1.1.1.3.3.3a" width="0.3888888888888889em" xref="S3.E12.m1.4.4.3.1.1.1.1.1.1.1.1.3.3.3.cmml"></mspace><mrow id="S3.E12.m1.4.4.3.1.1.1.1.1.1.1.1.3.3.3.1.1" xref="S3.E12.m1.4.4.3.1.1.1.1.1.1.1.1.3.3.3.1.1.1.cmml"><mo id="S3.E12.m1.4.4.3.1.1.1.1.1.1.1.1.3.3.3.1.1.2" stretchy="false" xref="S3.E12.m1.4.4.3.1.1.1.1.1.1.1.1.3.3.3.1.1.1.cmml">(</mo><mrow id="S3.E12.m1.4.4.3.1.1.1.1.1.1.1.1.3.3.3.1.1.1" xref="S3.E12.m1.4.4.3.1.1.1.1.1.1.1.1.3.3.3.1.1.1.cmml"><mi id="S3.E12.m1.4.4.3.1.1.1.1.1.1.1.1.3.3.3.1.1.1.2" xref="S3.E12.m1.4.4.3.1.1.1.1.1.1.1.1.3.3.3.1.1.1.2.cmml"></mi><mo id="S3.E12.m1.4.4.3.1.1.1.1.1.1.1.1.3.3.3.1.1.1.1" xref="S3.E12.m1.4.4.3.1.1.1.1.1.1.1.1.3.3.3.1.1.1.1.cmml">&lt;</mo><mi id="S3.E12.m1.4.4.3.1.1.1.1.1.1.1.1.3.3.3.1.1.1.3" xref="S3.E12.m1.4.4.3.1.1.1.1.1.1.1.1.3.3.3.1.1.1.3.cmml">t</mi></mrow><mo id="S3.E12.m1.4.4.3.1.1.1.1.1.1.1.1.3.3.3.1.1.3" stretchy="false" xref="S3.E12.m1.4.4.3.1.1.1.1.1.1.1.1.3.3.3.1.1.1.cmml">)</mo></mrow></mrow><mo id="S3.E12.m1.4.4.3.1.1.1.1.1.1.1.1.4.4.7" xref="S3.E12.m1.4.4.3.1.1.1.1.1.1.1.1.4.5.cmml">;</mo><msub id="S3.E12.m1.4.4.3.1.1.1.1.1.1.1.1.4.4.4" xref="S3.E12.m1.4.4.3.1.1.1.1.1.1.1.1.4.4.4.cmml"><mi id="S3.E12.m1.4.4.3.1.1.1.1.1.1.1.1.4.4.4.2" xref="S3.E12.m1.4.4.3.1.1.1.1.1.1.1.1.4.4.4.2.cmml">θ</mi><mn id="S3.E12.m1.4.4.3.1.1.1.1.1.1.1.1.4.4.4.3" xref="S3.E12.m1.4.4.3.1.1.1.1.1.1.1.1.4.4.4.3.cmml">2</mn></msub></mrow></mrow><mo id="S3.E12.m1.4.4.3.1.1.1.1.1.1.1.3" stretchy="false" xref="S3.E12.m1.4.4.3.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow></mrow><mo id="S3.E12.m1.4.4.3.1.1.3" xref="S3.E12.m1.4.4.3.1.2.1.cmml">]</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.E12.m1.4b"><apply id="S3.E12.m1.4.4.cmml" xref="S3.E12.m1.4.4"><eq id="S3.E12.m1.4.4.4.cmml" xref="S3.E12.m1.4.4.4"></eq><apply id="S3.E12.m1.3.3.2.cmml" xref="S3.E12.m1.3.3.2"><times id="S3.E12.m1.3.3.2.3.cmml" xref="S3.E12.m1.3.3.2.3"></times><apply id="S3.E12.m1.3.3.2.4.cmml" xref="S3.E12.m1.3.3.2.4"><csymbol cd="ambiguous" id="S3.E12.m1.3.3.2.4.1.cmml" xref="S3.E12.m1.3.3.2.4">subscript</csymbol><ci id="S3.E12.m1.3.3.2.4.2.cmml" xref="S3.E12.m1.3.3.2.4.2">ℒ</ci><cn id="S3.E12.m1.3.3.2.4.3.cmml" type="integer" xref="S3.E12.m1.3.3.2.4.3">2</cn></apply><list id="S3.E12.m1.3.3.2.2.3.cmml" xref="S3.E12.m1.3.3.2.2.2"><apply id="S3.E12.m1.2.2.1.1.1.1.cmml" xref="S3.E12.m1.2.2.1.1.1.1"><csymbol cd="ambiguous" id="S3.E12.m1.2.2.1.1.1.1.1.cmml" xref="S3.E12.m1.2.2.1.1.1.1">subscript</csymbol><ci id="S3.E12.m1.2.2.1.1.1.1.2.cmml" xref="S3.E12.m1.2.2.1.1.1.1.2">𝜃</ci><cn id="S3.E12.m1.2.2.1.1.1.1.3.cmml" type="integer" xref="S3.E12.m1.2.2.1.1.1.1.3">2</cn></apply><apply id="S3.E12.m1.3.3.2.2.2.2.cmml" xref="S3.E12.m1.3.3.2.2.2.2"><csymbol cd="ambiguous" id="S3.E12.m1.3.3.2.2.2.2.1.cmml" xref="S3.E12.m1.3.3.2.2.2.2">superscript</csymbol><ci id="S3.E12.m1.3.3.2.2.2.2.2.cmml" xref="S3.E12.m1.3.3.2.2.2.2.2">𝒟</ci><ci id="S3.E12.m1.3.3.2.2.2.2.3.cmml" xref="S3.E12.m1.3.3.2.2.2.2.3">′</ci></apply></list></apply><apply id="S3.E12.m1.4.4.3.cmml" xref="S3.E12.m1.4.4.3"><apply id="S3.E12.m1.4.4.3.2.cmml" xref="S3.E12.m1.4.4.3.2"><csymbol cd="ambiguous" id="S3.E12.m1.4.4.3.2.1.cmml" xref="S3.E12.m1.4.4.3.2">superscript</csymbol><apply id="S3.E12.m1.4.4.3.2.2.cmml" xref="S3.E12.m1.4.4.3.2"><csymbol cd="ambiguous" id="S3.E12.m1.4.4.3.2.2.1.cmml" xref="S3.E12.m1.4.4.3.2">subscript</csymbol><sum id="S3.E12.m1.4.4.3.2.2.2.cmml" xref="S3.E12.m1.4.4.3.2.2.2"></sum><apply id="S3.E12.m1.4.4.3.2.2.3.cmml" xref="S3.E12.m1.4.4.3.2.2.3"><eq id="S3.E12.m1.4.4.3.2.2.3.1.cmml" xref="S3.E12.m1.4.4.3.2.2.3.1"></eq><ci id="S3.E12.m1.4.4.3.2.2.3.2.cmml" xref="S3.E12.m1.4.4.3.2.2.3.2">𝑖</ci><cn id="S3.E12.m1.4.4.3.2.2.3.3.cmml" type="integer" xref="S3.E12.m1.4.4.3.2.2.3.3">1</cn></apply></apply><ci id="S3.E12.m1.4.4.3.2.3.cmml" xref="S3.E12.m1.4.4.3.2.3">𝐼</ci></apply><apply id="S3.E12.m1.4.4.3.1.2.cmml" xref="S3.E12.m1.4.4.3.1.1"><csymbol cd="latexml" id="S3.E12.m1.4.4.3.1.2.1.cmml" xref="S3.E12.m1.4.4.3.1.1.2">delimited-[]</csymbol><apply id="S3.E12.m1.4.4.3.1.1.1.cmml" xref="S3.E12.m1.4.4.3.1.1.1"><minus id="S3.E12.m1.4.4.3.1.1.1.2.cmml" xref="S3.E12.m1.4.4.3.1.1.1"></minus><apply id="S3.E12.m1.4.4.3.1.1.1.1.cmml" xref="S3.E12.m1.4.4.3.1.1.1.1"><apply id="S3.E12.m1.4.4.3.1.1.1.1.2.cmml" xref="S3.E12.m1.4.4.3.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.E12.m1.4.4.3.1.1.1.1.2.1.cmml" xref="S3.E12.m1.4.4.3.1.1.1.1.2">superscript</csymbol><apply id="S3.E12.m1.4.4.3.1.1.1.1.2.2.cmml" xref="S3.E12.m1.4.4.3.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.E12.m1.4.4.3.1.1.1.1.2.2.1.cmml" xref="S3.E12.m1.4.4.3.1.1.1.1.2">subscript</csymbol><sum id="S3.E12.m1.4.4.3.1.1.1.1.2.2.2.cmml" xref="S3.E12.m1.4.4.3.1.1.1.1.2.2.2"></sum><apply id="S3.E12.m1.4.4.3.1.1.1.1.2.2.3.cmml" xref="S3.E12.m1.4.4.3.1.1.1.1.2.2.3"><eq id="S3.E12.m1.4.4.3.1.1.1.1.2.2.3.1.cmml" xref="S3.E12.m1.4.4.3.1.1.1.1.2.2.3.1"></eq><ci id="S3.E12.m1.4.4.3.1.1.1.1.2.2.3.2.cmml" xref="S3.E12.m1.4.4.3.1.1.1.1.2.2.3.2">𝑡</ci><cn id="S3.E12.m1.4.4.3.1.1.1.1.2.2.3.3.cmml" type="integer" xref="S3.E12.m1.4.4.3.1.1.1.1.2.2.3.3">1</cn></apply></apply><apply id="S3.E12.m1.4.4.3.1.1.1.1.2.3.cmml" xref="S3.E12.m1.4.4.3.1.1.1.1.2.3"><csymbol cd="ambiguous" id="S3.E12.m1.4.4.3.1.1.1.1.2.3.1.cmml" xref="S3.E12.m1.4.4.3.1.1.1.1.2.3">superscript</csymbol><apply id="S3.E12.m1.4.4.3.1.1.1.1.2.3.2.cmml" xref="S3.E12.m1.4.4.3.1.1.1.1.2.3"><csymbol cd="ambiguous" id="S3.E12.m1.4.4.3.1.1.1.1.2.3.2.1.cmml" xref="S3.E12.m1.4.4.3.1.1.1.1.2.3">subscript</csymbol><ci id="S3.E12.m1.4.4.3.1.1.1.1.2.3.2.2.cmml" xref="S3.E12.m1.4.4.3.1.1.1.1.2.3.2.2">𝑇</ci><ci id="S3.E12.m1.4.4.3.1.1.1.1.2.3.2.3.cmml" xref="S3.E12.m1.4.4.3.1.1.1.1.2.3.2.3">𝑖</ci></apply><ci id="S3.E12.m1.4.4.3.1.1.1.1.2.3.3.cmml" xref="S3.E12.m1.4.4.3.1.1.1.1.2.3.3">′</ci></apply></apply><apply id="S3.E12.m1.4.4.3.1.1.1.1.1.cmml" xref="S3.E12.m1.4.4.3.1.1.1.1.1"><times id="S3.E12.m1.4.4.3.1.1.1.1.1.2.cmml" xref="S3.E12.m1.4.4.3.1.1.1.1.1.2"></times><apply id="S3.E12.m1.4.4.3.1.1.1.1.1.3.cmml" xref="S3.E12.m1.4.4.3.1.1.1.1.1.3"><log id="S3.E12.m1.4.4.3.1.1.1.1.1.3.1.cmml" xref="S3.E12.m1.4.4.3.1.1.1.1.1.3.1"></log><ci id="S3.E12.m1.4.4.3.1.1.1.1.1.3.2.cmml" xref="S3.E12.m1.4.4.3.1.1.1.1.1.3.2">𝑃</ci></apply><apply id="S3.E12.m1.4.4.3.1.1.1.1.1.1.1.1.cmml" xref="S3.E12.m1.4.4.3.1.1.1.1.1.1.1"><csymbol cd="latexml" id="S3.E12.m1.4.4.3.1.1.1.1.1.1.1.1.5.cmml" xref="S3.E12.m1.4.4.3.1.1.1.1.1.1.1.1.5">conditional</csymbol><apply id="S3.E12.m1.4.4.3.1.1.1.1.1.1.1.1.6.cmml" xref="S3.E12.m1.4.4.3.1.1.1.1.1.1.1.1.6"><times id="S3.E12.m1.4.4.3.1.1.1.1.1.1.1.1.6.1.cmml" xref="S3.E12.m1.4.4.3.1.1.1.1.1.1.1.1.6.1"></times><apply id="S3.E12.m1.4.4.3.1.1.1.1.1.1.1.1.6.2.cmml" xref="S3.E12.m1.4.4.3.1.1.1.1.1.1.1.1.6.2"><csymbol cd="ambiguous" id="S3.E12.m1.4.4.3.1.1.1.1.1.1.1.1.6.2.1.cmml" xref="S3.E12.m1.4.4.3.1.1.1.1.1.1.1.1.6.2">subscript</csymbol><ci id="S3.E12.m1.4.4.3.1.1.1.1.1.1.1.1.6.2.2.cmml" xref="S3.E12.m1.4.4.3.1.1.1.1.1.1.1.1.6.2.2">𝑦</ci><ci id="S3.E12.m1.4.4.3.1.1.1.1.1.1.1.1.6.2.3.cmml" xref="S3.E12.m1.4.4.3.1.1.1.1.1.1.1.1.6.2.3">𝑖</ci></apply><ci id="S3.E12.m1.1.1.cmml" xref="S3.E12.m1.1.1">𝑡</ci></apply><list id="S3.E12.m1.4.4.3.1.1.1.1.1.1.1.1.4.5.cmml" xref="S3.E12.m1.4.4.3.1.1.1.1.1.1.1.1.4.4"><apply id="S3.E12.m1.4.4.3.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E12.m1.4.4.3.1.1.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E12.m1.4.4.3.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E12.m1.4.4.3.1.1.1.1.1.1.1.1.1.1.1">superscript</csymbol><apply id="S3.E12.m1.4.4.3.1.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S3.E12.m1.4.4.3.1.1.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E12.m1.4.4.3.1.1.1.1.1.1.1.1.1.1.1.2.1.cmml" xref="S3.E12.m1.4.4.3.1.1.1.1.1.1.1.1.1.1.1">subscript</csymbol><ci id="S3.E12.m1.4.4.3.1.1.1.1.1.1.1.1.1.1.1.2.2.cmml" xref="S3.E12.m1.4.4.3.1.1.1.1.1.1.1.1.1.1.1.2.2">𝑃</ci><cn id="S3.E12.m1.4.4.3.1.1.1.1.1.1.1.1.1.1.1.2.3.cmml" type="integer" xref="S3.E12.m1.4.4.3.1.1.1.1.1.1.1.1.1.1.1.2.3">2</cn></apply><ci id="S3.E12.m1.4.4.3.1.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="S3.E12.m1.4.4.3.1.1.1.1.1.1.1.1.1.1.1.3">′</ci></apply><apply id="S3.E12.m1.4.4.3.1.1.1.1.1.1.1.1.2.2.2.cmml" xref="S3.E12.m1.4.4.3.1.1.1.1.1.1.1.1.2.2.2"><csymbol cd="ambiguous" id="S3.E12.m1.4.4.3.1.1.1.1.1.1.1.1.2.2.2.1.cmml" xref="S3.E12.m1.4.4.3.1.1.1.1.1.1.1.1.2.2.2">subscript</csymbol><ci id="S3.E12.m1.4.4.3.1.1.1.1.1.1.1.1.2.2.2.2.cmml" xref="S3.E12.m1.4.4.3.1.1.1.1.1.1.1.1.2.2.2.2">𝑑</ci><ci id="S3.E12.m1.4.4.3.1.1.1.1.1.1.1.1.2.2.2.3.cmml" xref="S3.E12.m1.4.4.3.1.1.1.1.1.1.1.1.2.2.2.3">𝑖</ci></apply><apply id="S3.E12.m1.4.4.3.1.1.1.1.1.1.1.1.3.3.3.cmml" xref="S3.E12.m1.4.4.3.1.1.1.1.1.1.1.1.3.3.3"><csymbol cd="latexml" id="S3.E12.m1.4.4.3.1.1.1.1.1.1.1.1.3.3.3.2.cmml" xref="S3.E12.m1.4.4.3.1.1.1.1.1.1.1.1.3.3.3">annotated</csymbol><apply id="S3.E12.m1.4.4.3.1.1.1.1.1.1.1.1.3.3.3.3.cmml" xref="S3.E12.m1.4.4.3.1.1.1.1.1.1.1.1.3.3.3.3"><csymbol cd="ambiguous" id="S3.E12.m1.4.4.3.1.1.1.1.1.1.1.1.3.3.3.3.1.cmml" xref="S3.E12.m1.4.4.3.1.1.1.1.1.1.1.1.3.3.3.3">subscript</csymbol><ci id="S3.E12.m1.4.4.3.1.1.1.1.1.1.1.1.3.3.3.3.2.cmml" xref="S3.E12.m1.4.4.3.1.1.1.1.1.1.1.1.3.3.3.3.2">𝑦</ci><ci id="S3.E12.m1.4.4.3.1.1.1.1.1.1.1.1.3.3.3.3.3.cmml" xref="S3.E12.m1.4.4.3.1.1.1.1.1.1.1.1.3.3.3.3.3">𝑖</ci></apply><apply id="S3.E12.m1.4.4.3.1.1.1.1.1.1.1.1.3.3.3.1.1.1.cmml" xref="S3.E12.m1.4.4.3.1.1.1.1.1.1.1.1.3.3.3.1.1"><lt id="S3.E12.m1.4.4.3.1.1.1.1.1.1.1.1.3.3.3.1.1.1.1.cmml" xref="S3.E12.m1.4.4.3.1.1.1.1.1.1.1.1.3.3.3.1.1.1.1"></lt><csymbol cd="latexml" id="S3.E12.m1.4.4.3.1.1.1.1.1.1.1.1.3.3.3.1.1.1.2.cmml" xref="S3.E12.m1.4.4.3.1.1.1.1.1.1.1.1.3.3.3.1.1.1.2">absent</csymbol><ci id="S3.E12.m1.4.4.3.1.1.1.1.1.1.1.1.3.3.3.1.1.1.3.cmml" xref="S3.E12.m1.4.4.3.1.1.1.1.1.1.1.1.3.3.3.1.1.1.3">𝑡</ci></apply></apply><apply id="S3.E12.m1.4.4.3.1.1.1.1.1.1.1.1.4.4.4.cmml" xref="S3.E12.m1.4.4.3.1.1.1.1.1.1.1.1.4.4.4"><csymbol cd="ambiguous" id="S3.E12.m1.4.4.3.1.1.1.1.1.1.1.1.4.4.4.1.cmml" xref="S3.E12.m1.4.4.3.1.1.1.1.1.1.1.1.4.4.4">subscript</csymbol><ci id="S3.E12.m1.4.4.3.1.1.1.1.1.1.1.1.4.4.4.2.cmml" xref="S3.E12.m1.4.4.3.1.1.1.1.1.1.1.1.4.4.4.2">𝜃</ci><cn id="S3.E12.m1.4.4.3.1.1.1.1.1.1.1.1.4.4.4.3.cmml" type="integer" xref="S3.E12.m1.4.4.3.1.1.1.1.1.1.1.1.4.4.4.3">2</cn></apply></list></apply></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E12.m1.4c">\mathcal{L}_{2}(\theta_{2};\mathcal{D}^{\prime})=\sum_{i=1}^{I}\left[-\sum_{t=%
1}^{T_{i}^{\prime}}\log P(y_{i}(t)|P_{2}^{\prime},d_{i},y_{i}(&lt;t);\theta_{2})\right]</annotation><annotation encoding="application/x-llamapun" id="S3.E12.m1.4d">caligraphic_L start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT ( italic_θ start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT ; caligraphic_D start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT ) = ∑ start_POSTSUBSCRIPT italic_i = 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_I end_POSTSUPERSCRIPT [ - ∑ start_POSTSUBSCRIPT italic_t = 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_T start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT end_POSTSUPERSCRIPT roman_log italic_P ( italic_y start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT ( italic_t ) | italic_P start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT , italic_d start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT , italic_y start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT ( &lt; italic_t ) ; italic_θ start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT ) ]</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S3.SS3.SSS3.p1.16">By optimizing the objective <math alttext="\mathcal{L}(\theta_{2};\mathcal{D}^{\prime})" class="ltx_Math" display="inline" id="S3.SS3.SSS3.p1.16.m1.2"><semantics id="S3.SS3.SSS3.p1.16.m1.2a"><mrow id="S3.SS3.SSS3.p1.16.m1.2.2" xref="S3.SS3.SSS3.p1.16.m1.2.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS3.SSS3.p1.16.m1.2.2.4" xref="S3.SS3.SSS3.p1.16.m1.2.2.4.cmml">ℒ</mi><mo id="S3.SS3.SSS3.p1.16.m1.2.2.3" xref="S3.SS3.SSS3.p1.16.m1.2.2.3.cmml">⁢</mo><mrow id="S3.SS3.SSS3.p1.16.m1.2.2.2.2" xref="S3.SS3.SSS3.p1.16.m1.2.2.2.3.cmml"><mo id="S3.SS3.SSS3.p1.16.m1.2.2.2.2.3" stretchy="false" xref="S3.SS3.SSS3.p1.16.m1.2.2.2.3.cmml">(</mo><msub id="S3.SS3.SSS3.p1.16.m1.1.1.1.1.1" xref="S3.SS3.SSS3.p1.16.m1.1.1.1.1.1.cmml"><mi id="S3.SS3.SSS3.p1.16.m1.1.1.1.1.1.2" xref="S3.SS3.SSS3.p1.16.m1.1.1.1.1.1.2.cmml">θ</mi><mn id="S3.SS3.SSS3.p1.16.m1.1.1.1.1.1.3" xref="S3.SS3.SSS3.p1.16.m1.1.1.1.1.1.3.cmml">2</mn></msub><mo id="S3.SS3.SSS3.p1.16.m1.2.2.2.2.4" xref="S3.SS3.SSS3.p1.16.m1.2.2.2.3.cmml">;</mo><msup id="S3.SS3.SSS3.p1.16.m1.2.2.2.2.2" xref="S3.SS3.SSS3.p1.16.m1.2.2.2.2.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS3.SSS3.p1.16.m1.2.2.2.2.2.2" xref="S3.SS3.SSS3.p1.16.m1.2.2.2.2.2.2.cmml">𝒟</mi><mo id="S3.SS3.SSS3.p1.16.m1.2.2.2.2.2.3" xref="S3.SS3.SSS3.p1.16.m1.2.2.2.2.2.3.cmml">′</mo></msup><mo id="S3.SS3.SSS3.p1.16.m1.2.2.2.2.5" stretchy="false" xref="S3.SS3.SSS3.p1.16.m1.2.2.2.3.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS3.p1.16.m1.2b"><apply id="S3.SS3.SSS3.p1.16.m1.2.2.cmml" xref="S3.SS3.SSS3.p1.16.m1.2.2"><times id="S3.SS3.SSS3.p1.16.m1.2.2.3.cmml" xref="S3.SS3.SSS3.p1.16.m1.2.2.3"></times><ci id="S3.SS3.SSS3.p1.16.m1.2.2.4.cmml" xref="S3.SS3.SSS3.p1.16.m1.2.2.4">ℒ</ci><list id="S3.SS3.SSS3.p1.16.m1.2.2.2.3.cmml" xref="S3.SS3.SSS3.p1.16.m1.2.2.2.2"><apply id="S3.SS3.SSS3.p1.16.m1.1.1.1.1.1.cmml" xref="S3.SS3.SSS3.p1.16.m1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS3.SSS3.p1.16.m1.1.1.1.1.1.1.cmml" xref="S3.SS3.SSS3.p1.16.m1.1.1.1.1.1">subscript</csymbol><ci id="S3.SS3.SSS3.p1.16.m1.1.1.1.1.1.2.cmml" xref="S3.SS3.SSS3.p1.16.m1.1.1.1.1.1.2">𝜃</ci><cn id="S3.SS3.SSS3.p1.16.m1.1.1.1.1.1.3.cmml" type="integer" xref="S3.SS3.SSS3.p1.16.m1.1.1.1.1.1.3">2</cn></apply><apply id="S3.SS3.SSS3.p1.16.m1.2.2.2.2.2.cmml" xref="S3.SS3.SSS3.p1.16.m1.2.2.2.2.2"><csymbol cd="ambiguous" id="S3.SS3.SSS3.p1.16.m1.2.2.2.2.2.1.cmml" xref="S3.SS3.SSS3.p1.16.m1.2.2.2.2.2">superscript</csymbol><ci id="S3.SS3.SSS3.p1.16.m1.2.2.2.2.2.2.cmml" xref="S3.SS3.SSS3.p1.16.m1.2.2.2.2.2.2">𝒟</ci><ci id="S3.SS3.SSS3.p1.16.m1.2.2.2.2.2.3.cmml" xref="S3.SS3.SSS3.p1.16.m1.2.2.2.2.2.3">′</ci></apply></list></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS3.p1.16.m1.2c">\mathcal{L}(\theta_{2};\mathcal{D}^{\prime})</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.SSS3.p1.16.m1.2d">caligraphic_L ( italic_θ start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT ; caligraphic_D start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT )</annotation></semantics></math>, the LLM learns the capability of generating high-quality assistive diagnosis reports in a fixed JSON format.</p>
<table class="ltx_equation ltx_eqn_table" id="S3.E13">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_left" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_left">(13)</span></td>
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\theta_{2}^{*}=\arg\min_{\theta_{2}}\mathcal{L}_{2}(\theta_{2};\mathcal{D}^{%
\prime})" class="ltx_Math" display="block" id="S3.E13.m1.2"><semantics id="S3.E13.m1.2a"><mrow id="S3.E13.m1.2.2" xref="S3.E13.m1.2.2.cmml"><msubsup id="S3.E13.m1.2.2.4" xref="S3.E13.m1.2.2.4.cmml"><mi id="S3.E13.m1.2.2.4.2.2" xref="S3.E13.m1.2.2.4.2.2.cmml">θ</mi><mn id="S3.E13.m1.2.2.4.2.3" xref="S3.E13.m1.2.2.4.2.3.cmml">2</mn><mo id="S3.E13.m1.2.2.4.3" xref="S3.E13.m1.2.2.4.3.cmml">∗</mo></msubsup><mo id="S3.E13.m1.2.2.3" xref="S3.E13.m1.2.2.3.cmml">=</mo><mrow id="S3.E13.m1.2.2.2" xref="S3.E13.m1.2.2.2.cmml"><mrow id="S3.E13.m1.2.2.2.4" xref="S3.E13.m1.2.2.2.4.cmml"><mi id="S3.E13.m1.2.2.2.4.1" xref="S3.E13.m1.2.2.2.4.1.cmml">arg</mi><mo id="S3.E13.m1.2.2.2.4a" lspace="0.167em" xref="S3.E13.m1.2.2.2.4.cmml">⁡</mo><mrow id="S3.E13.m1.2.2.2.4.2" xref="S3.E13.m1.2.2.2.4.2.cmml"><munder id="S3.E13.m1.2.2.2.4.2.1" xref="S3.E13.m1.2.2.2.4.2.1.cmml"><mi id="S3.E13.m1.2.2.2.4.2.1.2" xref="S3.E13.m1.2.2.2.4.2.1.2.cmml">min</mi><msub id="S3.E13.m1.2.2.2.4.2.1.3" xref="S3.E13.m1.2.2.2.4.2.1.3.cmml"><mi id="S3.E13.m1.2.2.2.4.2.1.3.2" xref="S3.E13.m1.2.2.2.4.2.1.3.2.cmml">θ</mi><mn id="S3.E13.m1.2.2.2.4.2.1.3.3" xref="S3.E13.m1.2.2.2.4.2.1.3.3.cmml">2</mn></msub></munder><mo id="S3.E13.m1.2.2.2.4.2a" lspace="0.167em" xref="S3.E13.m1.2.2.2.4.2.cmml">⁡</mo><msub id="S3.E13.m1.2.2.2.4.2.2" xref="S3.E13.m1.2.2.2.4.2.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.E13.m1.2.2.2.4.2.2.2" xref="S3.E13.m1.2.2.2.4.2.2.2.cmml">ℒ</mi><mn id="S3.E13.m1.2.2.2.4.2.2.3" xref="S3.E13.m1.2.2.2.4.2.2.3.cmml">2</mn></msub></mrow></mrow><mo id="S3.E13.m1.2.2.2.3" xref="S3.E13.m1.2.2.2.3.cmml">⁢</mo><mrow id="S3.E13.m1.2.2.2.2.2" xref="S3.E13.m1.2.2.2.2.3.cmml"><mo id="S3.E13.m1.2.2.2.2.2.3" stretchy="false" xref="S3.E13.m1.2.2.2.2.3.cmml">(</mo><msub id="S3.E13.m1.1.1.1.1.1.1" xref="S3.E13.m1.1.1.1.1.1.1.cmml"><mi id="S3.E13.m1.1.1.1.1.1.1.2" xref="S3.E13.m1.1.1.1.1.1.1.2.cmml">θ</mi><mn id="S3.E13.m1.1.1.1.1.1.1.3" xref="S3.E13.m1.1.1.1.1.1.1.3.cmml">2</mn></msub><mo id="S3.E13.m1.2.2.2.2.2.4" xref="S3.E13.m1.2.2.2.2.3.cmml">;</mo><msup id="S3.E13.m1.2.2.2.2.2.2" xref="S3.E13.m1.2.2.2.2.2.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.E13.m1.2.2.2.2.2.2.2" xref="S3.E13.m1.2.2.2.2.2.2.2.cmml">𝒟</mi><mo id="S3.E13.m1.2.2.2.2.2.2.3" xref="S3.E13.m1.2.2.2.2.2.2.3.cmml">′</mo></msup><mo id="S3.E13.m1.2.2.2.2.2.5" stretchy="false" xref="S3.E13.m1.2.2.2.2.3.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.E13.m1.2b"><apply id="S3.E13.m1.2.2.cmml" xref="S3.E13.m1.2.2"><eq id="S3.E13.m1.2.2.3.cmml" xref="S3.E13.m1.2.2.3"></eq><apply id="S3.E13.m1.2.2.4.cmml" xref="S3.E13.m1.2.2.4"><csymbol cd="ambiguous" id="S3.E13.m1.2.2.4.1.cmml" xref="S3.E13.m1.2.2.4">superscript</csymbol><apply id="S3.E13.m1.2.2.4.2.cmml" xref="S3.E13.m1.2.2.4"><csymbol cd="ambiguous" id="S3.E13.m1.2.2.4.2.1.cmml" xref="S3.E13.m1.2.2.4">subscript</csymbol><ci id="S3.E13.m1.2.2.4.2.2.cmml" xref="S3.E13.m1.2.2.4.2.2">𝜃</ci><cn id="S3.E13.m1.2.2.4.2.3.cmml" type="integer" xref="S3.E13.m1.2.2.4.2.3">2</cn></apply><times id="S3.E13.m1.2.2.4.3.cmml" xref="S3.E13.m1.2.2.4.3"></times></apply><apply id="S3.E13.m1.2.2.2.cmml" xref="S3.E13.m1.2.2.2"><times id="S3.E13.m1.2.2.2.3.cmml" xref="S3.E13.m1.2.2.2.3"></times><apply id="S3.E13.m1.2.2.2.4.cmml" xref="S3.E13.m1.2.2.2.4"><arg id="S3.E13.m1.2.2.2.4.1.cmml" xref="S3.E13.m1.2.2.2.4.1"></arg><apply id="S3.E13.m1.2.2.2.4.2.cmml" xref="S3.E13.m1.2.2.2.4.2"><apply id="S3.E13.m1.2.2.2.4.2.1.cmml" xref="S3.E13.m1.2.2.2.4.2.1"><csymbol cd="ambiguous" id="S3.E13.m1.2.2.2.4.2.1.1.cmml" xref="S3.E13.m1.2.2.2.4.2.1">subscript</csymbol><min id="S3.E13.m1.2.2.2.4.2.1.2.cmml" xref="S3.E13.m1.2.2.2.4.2.1.2"></min><apply id="S3.E13.m1.2.2.2.4.2.1.3.cmml" xref="S3.E13.m1.2.2.2.4.2.1.3"><csymbol cd="ambiguous" id="S3.E13.m1.2.2.2.4.2.1.3.1.cmml" xref="S3.E13.m1.2.2.2.4.2.1.3">subscript</csymbol><ci id="S3.E13.m1.2.2.2.4.2.1.3.2.cmml" xref="S3.E13.m1.2.2.2.4.2.1.3.2">𝜃</ci><cn id="S3.E13.m1.2.2.2.4.2.1.3.3.cmml" type="integer" xref="S3.E13.m1.2.2.2.4.2.1.3.3">2</cn></apply></apply><apply id="S3.E13.m1.2.2.2.4.2.2.cmml" xref="S3.E13.m1.2.2.2.4.2.2"><csymbol cd="ambiguous" id="S3.E13.m1.2.2.2.4.2.2.1.cmml" xref="S3.E13.m1.2.2.2.4.2.2">subscript</csymbol><ci id="S3.E13.m1.2.2.2.4.2.2.2.cmml" xref="S3.E13.m1.2.2.2.4.2.2.2">ℒ</ci><cn id="S3.E13.m1.2.2.2.4.2.2.3.cmml" type="integer" xref="S3.E13.m1.2.2.2.4.2.2.3">2</cn></apply></apply></apply><list id="S3.E13.m1.2.2.2.2.3.cmml" xref="S3.E13.m1.2.2.2.2.2"><apply id="S3.E13.m1.1.1.1.1.1.1.cmml" xref="S3.E13.m1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E13.m1.1.1.1.1.1.1.1.cmml" xref="S3.E13.m1.1.1.1.1.1.1">subscript</csymbol><ci id="S3.E13.m1.1.1.1.1.1.1.2.cmml" xref="S3.E13.m1.1.1.1.1.1.1.2">𝜃</ci><cn id="S3.E13.m1.1.1.1.1.1.1.3.cmml" type="integer" xref="S3.E13.m1.1.1.1.1.1.1.3">2</cn></apply><apply id="S3.E13.m1.2.2.2.2.2.2.cmml" xref="S3.E13.m1.2.2.2.2.2.2"><csymbol cd="ambiguous" id="S3.E13.m1.2.2.2.2.2.2.1.cmml" xref="S3.E13.m1.2.2.2.2.2.2">superscript</csymbol><ci id="S3.E13.m1.2.2.2.2.2.2.2.cmml" xref="S3.E13.m1.2.2.2.2.2.2.2">𝒟</ci><ci id="S3.E13.m1.2.2.2.2.2.2.3.cmml" xref="S3.E13.m1.2.2.2.2.2.2.3">′</ci></apply></list></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E13.m1.2c">\theta_{2}^{*}=\arg\min_{\theta_{2}}\mathcal{L}_{2}(\theta_{2};\mathcal{D}^{%
\prime})</annotation><annotation encoding="application/x-llamapun" id="S3.E13.m1.2d">italic_θ start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ∗ end_POSTSUPERSCRIPT = roman_arg roman_min start_POSTSUBSCRIPT italic_θ start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT end_POSTSUBSCRIPT caligraphic_L start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT ( italic_θ start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT ; caligraphic_D start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT )</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S3.SS3.SSS3.p1.17">where <math alttext="\theta_{2}^{*}" class="ltx_Math" display="inline" id="S3.SS3.SSS3.p1.17.m1.1"><semantics id="S3.SS3.SSS3.p1.17.m1.1a"><msubsup id="S3.SS3.SSS3.p1.17.m1.1.1" xref="S3.SS3.SSS3.p1.17.m1.1.1.cmml"><mi id="S3.SS3.SSS3.p1.17.m1.1.1.2.2" xref="S3.SS3.SSS3.p1.17.m1.1.1.2.2.cmml">θ</mi><mn id="S3.SS3.SSS3.p1.17.m1.1.1.2.3" xref="S3.SS3.SSS3.p1.17.m1.1.1.2.3.cmml">2</mn><mo id="S3.SS3.SSS3.p1.17.m1.1.1.3" xref="S3.SS3.SSS3.p1.17.m1.1.1.3.cmml">∗</mo></msubsup><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS3.p1.17.m1.1b"><apply id="S3.SS3.SSS3.p1.17.m1.1.1.cmml" xref="S3.SS3.SSS3.p1.17.m1.1.1"><csymbol cd="ambiguous" id="S3.SS3.SSS3.p1.17.m1.1.1.1.cmml" xref="S3.SS3.SSS3.p1.17.m1.1.1">superscript</csymbol><apply id="S3.SS3.SSS3.p1.17.m1.1.1.2.cmml" xref="S3.SS3.SSS3.p1.17.m1.1.1"><csymbol cd="ambiguous" id="S3.SS3.SSS3.p1.17.m1.1.1.2.1.cmml" xref="S3.SS3.SSS3.p1.17.m1.1.1">subscript</csymbol><ci id="S3.SS3.SSS3.p1.17.m1.1.1.2.2.cmml" xref="S3.SS3.SSS3.p1.17.m1.1.1.2.2">𝜃</ci><cn id="S3.SS3.SSS3.p1.17.m1.1.1.2.3.cmml" type="integer" xref="S3.SS3.SSS3.p1.17.m1.1.1.2.3">2</cn></apply><times id="S3.SS3.SSS3.p1.17.m1.1.1.3.cmml" xref="S3.SS3.SSS3.p1.17.m1.1.1.3"></times></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS3.p1.17.m1.1c">\theta_{2}^{*}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.SSS3.p1.17.m1.1d">italic_θ start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ∗ end_POSTSUPERSCRIPT</annotation></semantics></math> is the learned parameters of AI Psychologist.
Thus, our LLM-based AI Psychologist can generate professional assistive diagnostic reports.
The generated report contains four attributes: binary classification, severity degree estimation, symptom-agree-standard, and subtype category, which overcome the limitations of traditional ADD methods.</p>
</div>
</section>
<section class="ltx_subsubsection" id="S3.SS3.SSS4">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">3.3.4. </span>Tailored Advice and Cyclical Analysis Generation</h4>
<div class="ltx_para" id="S3.SS3.SSS4.p1">
<p class="ltx_p" id="S3.SS3.SSS4.p1.1">For advice generation and cyclical analysis, we rely on the general capabilities of the LLM to provide tailored advice and analysis.
We instruct the AI Psychologist to provide treatment strategy and care advice to patients and families respectively, based on the symptoms described in reports. Moreover, we also instruct the AI Psychologist to provide a cyclical analysis of the mental state based on reports over a period of time.</p>
</div>
</section>
</section>
</section>
<section class="ltx_section" id="S4">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">4. </span>Experimental Results and Analysis</h2>
<div class="ltx_para" id="S4.p1">
<p class="ltx_p" id="S4.p1.1">In this section, we first introduce datasets and evaluation metrics used in our work.
Second, we evaluate the effectiveness of our InterMind system in psychological counseling and assistive diagnostic report generation from the following aspects.
For the effectiveness of AI Psychologist, we performed fine-grained quantitative and subjective experiments on the generated diagnostic report, including the binary classification results, severity degree estimation, the quality of the interpretable content in the report, and psychiatric clinicians’ evaluation.
For psychological counseling, we conducted a subjective evaluation on the performance of the proposed AI Psychological Chatbot.
Additionally, we conducted an ablation study to verify the contributions of RAG and CoT in enhancing the effectiveness of the report generation.</p>
</div>
<section class="ltx_subsection" id="S4.SS1">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.1. </span>Datasets</h3>
<figure class="ltx_table" id="S4.T1">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table">Table 1. </span>The statistics of datasets used in our method.</figcaption><div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_1">
<div class="ltx_inline-block ltx_figure_panel ltx_align_center ltx_transformed_outer" id="S4.T1.1" style="width:433.6pt;height:103pt;vertical-align:-0.0pt;"><span class="ltx_transformed_inner" style="transform:translate(65.3pt,-15.5pt) scale(1.43108700281915,1.43108700281915) ;">
<table class="ltx_tabular ltx_guessed_headers ltx_align_middle" id="S4.T1.1.1">
<thead class="ltx_thead">
<tr class="ltx_tr" id="S4.T1.1.1.1.1">
<th class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_th_row ltx_border_tt" id="S4.T1.1.1.1.1.1">Dataset</th>
<th class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_th_row ltx_border_tt" id="S4.T1.1.1.1.1.2">Sample Num</th>
<th class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_border_tt" id="S4.T1.1.1.1.1.3">Label Type</th>
<th class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_border_tt" id="S4.T1.1.1.1.1.4">Source</th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr class="ltx_tr" id="S4.T1.1.1.2.1">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t" id="S4.T1.1.1.2.1.1">MMDA</th>
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t" id="S4.T1.1.1.2.1.2">524</th>
<td class="ltx_td ltx_align_left ltx_border_t" id="S4.T1.1.1.2.1.3">HAMD score</td>
<td class="ltx_td ltx_align_left ltx_border_t" id="S4.T1.1.1.2.1.4">Clinical Interview</td>
</tr>
<tr class="ltx_tr" id="S4.T1.1.1.3.2">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="S4.T1.1.1.3.2.1">DR</th>
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="S4.T1.1.1.3.2.2">1838</th>
<td class="ltx_td ltx_align_left" id="S4.T1.1.1.3.2.3">Binary results</td>
<td class="ltx_td ltx_align_left" id="S4.T1.1.1.3.2.4">Social media</td>
</tr>
<tr class="ltx_tr" id="S4.T1.1.1.4.3">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_bb" id="S4.T1.1.1.4.3.1">DepSeverity</th>
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_bb" id="S4.T1.1.1.4.3.2">3553</th>
<td class="ltx_td ltx_align_left ltx_border_bb" id="S4.T1.1.1.4.3.3">Severity levels</td>
<td class="ltx_td ltx_align_left ltx_border_bb" id="S4.T1.1.1.4.3.4">Social media</td>
</tr>
</tbody>
</table>
</span></div>
</div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_1"><span class="ltx_ERROR ltx_centering ltx_figure_panel undefined" id="S4.T1.2">\Description</span></div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_1">
<p class="ltx_p ltx_figure_panel ltx_align_center" id="S4.T1.3">This table shows the names of the three datasets we used, the number of samples in each dataset, the label type, and the source information.</p>
</div>
</div>
</figure>
<div class="ltx_para" id="S4.SS1.p1">
<p class="ltx_p" id="S4.SS1.p1.1">In this work, we utilize three datasets to evaluate our method: MMDA dataset <cite class="ltx_cite ltx_citemacro_citep">(Jiang et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2409.14878v1#bib.bib15" title="">2022</a>)</cite>, DR dataset <cite class="ltx_cite ltx_citemacro_citep">(Pirina and Çöltekin, <a class="ltx_ref" href="https://arxiv.org/html/2409.14878v1#bib.bib28" title="">2018</a>)</cite>, and DepSeverity dataset <cite class="ltx_cite ltx_citemacro_citep">(Naseem et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2409.14878v1#bib.bib24" title="">2022</a>)</cite>. The statistics of datasets used in our method are shown in Table <a class="ltx_ref" href="https://arxiv.org/html/2409.14878v1#S4.T1" title="Table 1 ‣ 4.1. Datasets ‣ 4. Experimental Results and Analysis ‣ InterMind: A Doctor-Patient-Family Interactive Depression Assessment System Empowered by Large Language Models"><span class="ltx_text ltx_ref_tag">1</span></a>.</p>
</div>
<section class="ltx_subsubsection" id="S4.SS1.SSS1">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">4.1.1. </span>MMDA Dataset </h4>
<div class="ltx_para" id="S4.SS1.SSS1.p1">
<p class="ltx_p" id="S4.SS1.SSS1.p1.1">The MMDA dataset <cite class="ltx_cite ltx_citemacro_citep">(Jiang et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2409.14878v1#bib.bib15" title="">2022</a>)</cite> comprises 524 real clinical interview subjects. Each subject includes modalities such as audio, text, and video from the interviews. For depression, the Hamilton Depression Rating Scale (HAMD) <cite class="ltx_cite ltx_citemacro_citep">(Ma et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2409.14878v1#bib.bib23" title="">2021</a>)</cite> was used to evaluate the degree of depression. Based on the HAMD score, depression is categorized as follows: less than 7 is considered normal, 7-16 is mild depression, 17-23 is moderate depression, and 24 or above is severe depression. Thus, the threshold score of 7 serves as the boundary between depression and non-depression in the binary classification.</p>
</div>
</section>
<section class="ltx_subsubsection" id="S4.SS1.SSS2">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">4.1.2. </span>DR dataset</h4>
<div class="ltx_para" id="S4.SS1.SSS2.p1">
<p class="ltx_p" id="S4.SS1.SSS2.p1.1">The DR dataset <cite class="ltx_cite ltx_citemacro_citep">(Pirina and Çöltekin, <a class="ltx_ref" href="https://arxiv.org/html/2409.14878v1#bib.bib28" title="">2018</a>)</cite> is a collection of social media posts specifically gathered from Reddit to study depression. The DR dataset consists of 1838 subjects, with 1003 in the training set, 430 in the validation set, and 405 in the test set. This dataset includes posts from various subreddits, particularly those where users discuss their experiences with depression. The dataset comprises posts from depression support subreddits and other related forums, such as those discussing breast cancer, family, and friendship advice. These posts are categorized into positive and negative classes, with the positive class consisting of posts by users who have mentioned being diagnosed with depression. The negative class includes posts from other subreddits, excluding those related to mental health.</p>
</div>
</section>
<section class="ltx_subsubsection" id="S4.SS1.SSS3">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">4.1.3. </span>DepSeverity dataset</h4>
<div class="ltx_para" id="S4.SS1.SSS3.p1">
<p class="ltx_p" id="S4.SS1.SSS3.p1.1">The DepSeverity dataset <cite class="ltx_cite ltx_citemacro_citep">(Naseem et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2409.14878v1#bib.bib24" title="">2022</a>)</cite> is a comprehensive resource for studying depression severity levels based on user-generated content from Reddit. This dataset is constructed to classify posts into four distinct depression severity levels: minimal, mild, moderate, and severe. The dataset comprises 3553 posts, with each post labeled according to the Depressive Disorder Annotation (DDA) scheme and Beck’s Depression Inventory (BDI) criteria. These labels are assigned by annotators based on clinical depression standards, providing a nuanced view of depression severity as reflected in online discussions. The dataset is developed to support the early identification of depression severity in social media content, aiming to offer more granular insights compared to traditional binary classification approaches.</p>
</div>
</section>
</section>
<section class="ltx_subsection" id="S4.SS2">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.2. </span>Experimental Setup and Evaluation Metrics</h3>
<section class="ltx_subsubsection" id="S4.SS2.SSS1">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">4.2.1. </span>Experimental Setup</h4>
<div class="ltx_para" id="S4.SS2.SSS1.p1">
<p class="ltx_p" id="S4.SS2.SSS1.p1.2">Our psychological counseling dialogue prompt engineering and assistive diagnosis report prompt engineering were implemented based on GPT-4 <cite class="ltx_cite ltx_citemacro_citep">(Achiam et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2409.14878v1#bib.bib2" title="">2023</a>)</cite>. For the embedding network <math alttext="f(*)" class="ltx_Math" display="inline" id="S4.SS2.SSS1.p1.1.m1.1"><semantics id="S4.SS2.SSS1.p1.1.m1.1a"><mrow id="S4.SS2.SSS1.p1.1.m1.1.2" xref="S4.SS2.SSS1.p1.1.m1.1.2.cmml"><mi id="S4.SS2.SSS1.p1.1.m1.1.2.2" xref="S4.SS2.SSS1.p1.1.m1.1.2.2.cmml">f</mi><mo id="S4.SS2.SSS1.p1.1.m1.1.2.1" xref="S4.SS2.SSS1.p1.1.m1.1.2.1.cmml">⁢</mo><mrow id="S4.SS2.SSS1.p1.1.m1.1.2.3.2" xref="S4.SS2.SSS1.p1.1.m1.1.2.cmml"><mo id="S4.SS2.SSS1.p1.1.m1.1.2.3.2.1" stretchy="false" xref="S4.SS2.SSS1.p1.1.m1.1.2.cmml">(</mo><mo id="S4.SS2.SSS1.p1.1.m1.1.1" lspace="0em" rspace="0em" xref="S4.SS2.SSS1.p1.1.m1.1.1.cmml">∗</mo><mo id="S4.SS2.SSS1.p1.1.m1.1.2.3.2.2" stretchy="false" xref="S4.SS2.SSS1.p1.1.m1.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.SSS1.p1.1.m1.1b"><apply id="S4.SS2.SSS1.p1.1.m1.1.2.cmml" xref="S4.SS2.SSS1.p1.1.m1.1.2"><times id="S4.SS2.SSS1.p1.1.m1.1.2.1.cmml" xref="S4.SS2.SSS1.p1.1.m1.1.2.1"></times><ci id="S4.SS2.SSS1.p1.1.m1.1.2.2.cmml" xref="S4.SS2.SSS1.p1.1.m1.1.2.2">𝑓</ci><times id="S4.SS2.SSS1.p1.1.m1.1.1.cmml" xref="S4.SS2.SSS1.p1.1.m1.1.1"></times></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.SSS1.p1.1.m1.1c">f(*)</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.SSS1.p1.1.m1.1d">italic_f ( ∗ )</annotation></semantics></math> in the process of assistive diagnosis report generation, we used the OllamaEmbeddings<span class="ltx_note ltx_role_footnote" id="footnote1"><sup class="ltx_note_mark">1</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">1</sup><span class="ltx_tag ltx_tag_note">1</span><a class="ltx_ref ltx_href" href="https://python.langchain.com/v0.2/docs/integrations/text_embedding/ollama/" title="">https://python.langchain.com/v0.2/docs/integrations/text_embedding/ollama</a></span></span></span> which is a tool that creates dense vector representations of text, enabling semantic analysis and various natural language processing tasks.
We chose Baichuan2 <cite class="ltx_cite ltx_citemacro_citep">(Yang et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2409.14878v1#bib.bib43" title="">2023</a>)</cite> as the backbone networks of our AI Psychological Chatbot and AI Psychologist, and employed the AdamW optimizer <cite class="ltx_cite ltx_citemacro_citep">(Loshchilov and Hutter, <a class="ltx_ref" href="https://arxiv.org/html/2409.14878v1#bib.bib22" title="">2017</a>)</cite> to implement the instruction fine-tuning tasks. To ensure consistent data evaluation, we generated dialogues and reports in Chinese, and conducted quantitative and subjective evaluation experiments.
For MMDA and DepSeverity, we conduct a 90%/10% train-test split. For the DR dataset, we use the official training and test set. We applied the proposed psychological counseling dialogue prompt engineering and assistive diagnostic report prompt engineering to the three original datasets, and subsequently combined them to form a dataset <math alttext="\mathcal{D}^{\prime}" class="ltx_Math" display="inline" id="S4.SS2.SSS1.p1.2.m2.1"><semantics id="S4.SS2.SSS1.p1.2.m2.1a"><msup id="S4.SS2.SSS1.p1.2.m2.1.1" xref="S4.SS2.SSS1.p1.2.m2.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.SS2.SSS1.p1.2.m2.1.1.2" xref="S4.SS2.SSS1.p1.2.m2.1.1.2.cmml">𝒟</mi><mo id="S4.SS2.SSS1.p1.2.m2.1.1.3" xref="S4.SS2.SSS1.p1.2.m2.1.1.3.cmml">′</mo></msup><annotation-xml encoding="MathML-Content" id="S4.SS2.SSS1.p1.2.m2.1b"><apply id="S4.SS2.SSS1.p1.2.m2.1.1.cmml" xref="S4.SS2.SSS1.p1.2.m2.1.1"><csymbol cd="ambiguous" id="S4.SS2.SSS1.p1.2.m2.1.1.1.cmml" xref="S4.SS2.SSS1.p1.2.m2.1.1">superscript</csymbol><ci id="S4.SS2.SSS1.p1.2.m2.1.1.2.cmml" xref="S4.SS2.SSS1.p1.2.m2.1.1.2">𝒟</ci><ci id="S4.SS2.SSS1.p1.2.m2.1.1.3.cmml" xref="S4.SS2.SSS1.p1.2.m2.1.1.3">′</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.SSS1.p1.2.m2.1c">\mathcal{D}^{\prime}</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.SSS1.p1.2.m2.1d">caligraphic_D start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT</annotation></semantics></math> for training and model evaluation, which leads to a training set with 4677 subjects and a test set with 809 subjects.
In our experimental evaluation, we report results for each dataset individually.</p>
</div>
</section>
<section class="ltx_subsubsection" id="S4.SS2.SSS2">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">4.2.2. </span>Evaluation Metrics</h4>
<div class="ltx_para" id="S4.SS2.SSS2.p1">
<p class="ltx_p" id="S4.SS2.SSS2.p1.1">In our experiments, we used five metrics to evaluate our method’s performance in different aspects such as binary classification, severity degree estimation, and report quality: accuracy (ACC), precision (PRE), recall (REC), F1 score (F1), and weighted F1.</p>
</div>
<div class="ltx_para" id="S4.SS2.SSS2.p2">
<p class="ltx_p" id="S4.SS2.SSS2.p2.1">ACC measures the proportion of all correct predictions (both true positives and true negatives) out of the total number of cases:</p>
<table class="ltx_equation ltx_eqn_table" id="S4.E14">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_left" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_left">(14)</span></td>
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="ACC={(TP+TN)}/{(TP+TN+FP+FN)}" class="ltx_Math" display="block" id="S4.E14.m1.2"><semantics id="S4.E14.m1.2a"><mrow id="S4.E14.m1.2.2" xref="S4.E14.m1.2.2.cmml"><mrow id="S4.E14.m1.2.2.4" xref="S4.E14.m1.2.2.4.cmml"><mi id="S4.E14.m1.2.2.4.2" xref="S4.E14.m1.2.2.4.2.cmml">A</mi><mo id="S4.E14.m1.2.2.4.1" xref="S4.E14.m1.2.2.4.1.cmml">⁢</mo><mi id="S4.E14.m1.2.2.4.3" xref="S4.E14.m1.2.2.4.3.cmml">C</mi><mo id="S4.E14.m1.2.2.4.1a" xref="S4.E14.m1.2.2.4.1.cmml">⁢</mo><mi id="S4.E14.m1.2.2.4.4" xref="S4.E14.m1.2.2.4.4.cmml">C</mi></mrow><mo id="S4.E14.m1.2.2.3" xref="S4.E14.m1.2.2.3.cmml">=</mo><mrow id="S4.E14.m1.2.2.2" xref="S4.E14.m1.2.2.2.cmml"><mrow id="S4.E14.m1.1.1.1.1.1" xref="S4.E14.m1.1.1.1.1.1.1.cmml"><mo id="S4.E14.m1.1.1.1.1.1.2" stretchy="false" xref="S4.E14.m1.1.1.1.1.1.1.cmml">(</mo><mrow id="S4.E14.m1.1.1.1.1.1.1" xref="S4.E14.m1.1.1.1.1.1.1.cmml"><mrow id="S4.E14.m1.1.1.1.1.1.1.2" xref="S4.E14.m1.1.1.1.1.1.1.2.cmml"><mi id="S4.E14.m1.1.1.1.1.1.1.2.2" xref="S4.E14.m1.1.1.1.1.1.1.2.2.cmml">T</mi><mo id="S4.E14.m1.1.1.1.1.1.1.2.1" xref="S4.E14.m1.1.1.1.1.1.1.2.1.cmml">⁢</mo><mi id="S4.E14.m1.1.1.1.1.1.1.2.3" xref="S4.E14.m1.1.1.1.1.1.1.2.3.cmml">P</mi></mrow><mo id="S4.E14.m1.1.1.1.1.1.1.1" xref="S4.E14.m1.1.1.1.1.1.1.1.cmml">+</mo><mrow id="S4.E14.m1.1.1.1.1.1.1.3" xref="S4.E14.m1.1.1.1.1.1.1.3.cmml"><mi id="S4.E14.m1.1.1.1.1.1.1.3.2" xref="S4.E14.m1.1.1.1.1.1.1.3.2.cmml">T</mi><mo id="S4.E14.m1.1.1.1.1.1.1.3.1" xref="S4.E14.m1.1.1.1.1.1.1.3.1.cmml">⁢</mo><mi id="S4.E14.m1.1.1.1.1.1.1.3.3" xref="S4.E14.m1.1.1.1.1.1.1.3.3.cmml">N</mi></mrow></mrow><mo id="S4.E14.m1.1.1.1.1.1.3" stretchy="false" xref="S4.E14.m1.1.1.1.1.1.1.cmml">)</mo></mrow><mo id="S4.E14.m1.2.2.2.3" xref="S4.E14.m1.2.2.2.3.cmml">/</mo><mrow id="S4.E14.m1.2.2.2.2.1" xref="S4.E14.m1.2.2.2.2.1.1.cmml"><mo id="S4.E14.m1.2.2.2.2.1.2" stretchy="false" xref="S4.E14.m1.2.2.2.2.1.1.cmml">(</mo><mrow id="S4.E14.m1.2.2.2.2.1.1" xref="S4.E14.m1.2.2.2.2.1.1.cmml"><mrow id="S4.E14.m1.2.2.2.2.1.1.2" xref="S4.E14.m1.2.2.2.2.1.1.2.cmml"><mi id="S4.E14.m1.2.2.2.2.1.1.2.2" xref="S4.E14.m1.2.2.2.2.1.1.2.2.cmml">T</mi><mo id="S4.E14.m1.2.2.2.2.1.1.2.1" xref="S4.E14.m1.2.2.2.2.1.1.2.1.cmml">⁢</mo><mi id="S4.E14.m1.2.2.2.2.1.1.2.3" xref="S4.E14.m1.2.2.2.2.1.1.2.3.cmml">P</mi></mrow><mo id="S4.E14.m1.2.2.2.2.1.1.1" xref="S4.E14.m1.2.2.2.2.1.1.1.cmml">+</mo><mrow id="S4.E14.m1.2.2.2.2.1.1.3" xref="S4.E14.m1.2.2.2.2.1.1.3.cmml"><mi id="S4.E14.m1.2.2.2.2.1.1.3.2" xref="S4.E14.m1.2.2.2.2.1.1.3.2.cmml">T</mi><mo id="S4.E14.m1.2.2.2.2.1.1.3.1" xref="S4.E14.m1.2.2.2.2.1.1.3.1.cmml">⁢</mo><mi id="S4.E14.m1.2.2.2.2.1.1.3.3" xref="S4.E14.m1.2.2.2.2.1.1.3.3.cmml">N</mi></mrow><mo id="S4.E14.m1.2.2.2.2.1.1.1a" xref="S4.E14.m1.2.2.2.2.1.1.1.cmml">+</mo><mrow id="S4.E14.m1.2.2.2.2.1.1.4" xref="S4.E14.m1.2.2.2.2.1.1.4.cmml"><mi id="S4.E14.m1.2.2.2.2.1.1.4.2" xref="S4.E14.m1.2.2.2.2.1.1.4.2.cmml">F</mi><mo id="S4.E14.m1.2.2.2.2.1.1.4.1" xref="S4.E14.m1.2.2.2.2.1.1.4.1.cmml">⁢</mo><mi id="S4.E14.m1.2.2.2.2.1.1.4.3" xref="S4.E14.m1.2.2.2.2.1.1.4.3.cmml">P</mi></mrow><mo id="S4.E14.m1.2.2.2.2.1.1.1b" xref="S4.E14.m1.2.2.2.2.1.1.1.cmml">+</mo><mrow id="S4.E14.m1.2.2.2.2.1.1.5" xref="S4.E14.m1.2.2.2.2.1.1.5.cmml"><mi id="S4.E14.m1.2.2.2.2.1.1.5.2" xref="S4.E14.m1.2.2.2.2.1.1.5.2.cmml">F</mi><mo id="S4.E14.m1.2.2.2.2.1.1.5.1" xref="S4.E14.m1.2.2.2.2.1.1.5.1.cmml">⁢</mo><mi id="S4.E14.m1.2.2.2.2.1.1.5.3" xref="S4.E14.m1.2.2.2.2.1.1.5.3.cmml">N</mi></mrow></mrow><mo id="S4.E14.m1.2.2.2.2.1.3" stretchy="false" xref="S4.E14.m1.2.2.2.2.1.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.E14.m1.2b"><apply id="S4.E14.m1.2.2.cmml" xref="S4.E14.m1.2.2"><eq id="S4.E14.m1.2.2.3.cmml" xref="S4.E14.m1.2.2.3"></eq><apply id="S4.E14.m1.2.2.4.cmml" xref="S4.E14.m1.2.2.4"><times id="S4.E14.m1.2.2.4.1.cmml" xref="S4.E14.m1.2.2.4.1"></times><ci id="S4.E14.m1.2.2.4.2.cmml" xref="S4.E14.m1.2.2.4.2">𝐴</ci><ci id="S4.E14.m1.2.2.4.3.cmml" xref="S4.E14.m1.2.2.4.3">𝐶</ci><ci id="S4.E14.m1.2.2.4.4.cmml" xref="S4.E14.m1.2.2.4.4">𝐶</ci></apply><apply id="S4.E14.m1.2.2.2.cmml" xref="S4.E14.m1.2.2.2"><divide id="S4.E14.m1.2.2.2.3.cmml" xref="S4.E14.m1.2.2.2.3"></divide><apply id="S4.E14.m1.1.1.1.1.1.1.cmml" xref="S4.E14.m1.1.1.1.1.1"><plus id="S4.E14.m1.1.1.1.1.1.1.1.cmml" xref="S4.E14.m1.1.1.1.1.1.1.1"></plus><apply id="S4.E14.m1.1.1.1.1.1.1.2.cmml" xref="S4.E14.m1.1.1.1.1.1.1.2"><times id="S4.E14.m1.1.1.1.1.1.1.2.1.cmml" xref="S4.E14.m1.1.1.1.1.1.1.2.1"></times><ci id="S4.E14.m1.1.1.1.1.1.1.2.2.cmml" xref="S4.E14.m1.1.1.1.1.1.1.2.2">𝑇</ci><ci id="S4.E14.m1.1.1.1.1.1.1.2.3.cmml" xref="S4.E14.m1.1.1.1.1.1.1.2.3">𝑃</ci></apply><apply id="S4.E14.m1.1.1.1.1.1.1.3.cmml" xref="S4.E14.m1.1.1.1.1.1.1.3"><times id="S4.E14.m1.1.1.1.1.1.1.3.1.cmml" xref="S4.E14.m1.1.1.1.1.1.1.3.1"></times><ci id="S4.E14.m1.1.1.1.1.1.1.3.2.cmml" xref="S4.E14.m1.1.1.1.1.1.1.3.2">𝑇</ci><ci id="S4.E14.m1.1.1.1.1.1.1.3.3.cmml" xref="S4.E14.m1.1.1.1.1.1.1.3.3">𝑁</ci></apply></apply><apply id="S4.E14.m1.2.2.2.2.1.1.cmml" xref="S4.E14.m1.2.2.2.2.1"><plus id="S4.E14.m1.2.2.2.2.1.1.1.cmml" xref="S4.E14.m1.2.2.2.2.1.1.1"></plus><apply id="S4.E14.m1.2.2.2.2.1.1.2.cmml" xref="S4.E14.m1.2.2.2.2.1.1.2"><times id="S4.E14.m1.2.2.2.2.1.1.2.1.cmml" xref="S4.E14.m1.2.2.2.2.1.1.2.1"></times><ci id="S4.E14.m1.2.2.2.2.1.1.2.2.cmml" xref="S4.E14.m1.2.2.2.2.1.1.2.2">𝑇</ci><ci id="S4.E14.m1.2.2.2.2.1.1.2.3.cmml" xref="S4.E14.m1.2.2.2.2.1.1.2.3">𝑃</ci></apply><apply id="S4.E14.m1.2.2.2.2.1.1.3.cmml" xref="S4.E14.m1.2.2.2.2.1.1.3"><times id="S4.E14.m1.2.2.2.2.1.1.3.1.cmml" xref="S4.E14.m1.2.2.2.2.1.1.3.1"></times><ci id="S4.E14.m1.2.2.2.2.1.1.3.2.cmml" xref="S4.E14.m1.2.2.2.2.1.1.3.2">𝑇</ci><ci id="S4.E14.m1.2.2.2.2.1.1.3.3.cmml" xref="S4.E14.m1.2.2.2.2.1.1.3.3">𝑁</ci></apply><apply id="S4.E14.m1.2.2.2.2.1.1.4.cmml" xref="S4.E14.m1.2.2.2.2.1.1.4"><times id="S4.E14.m1.2.2.2.2.1.1.4.1.cmml" xref="S4.E14.m1.2.2.2.2.1.1.4.1"></times><ci id="S4.E14.m1.2.2.2.2.1.1.4.2.cmml" xref="S4.E14.m1.2.2.2.2.1.1.4.2">𝐹</ci><ci id="S4.E14.m1.2.2.2.2.1.1.4.3.cmml" xref="S4.E14.m1.2.2.2.2.1.1.4.3">𝑃</ci></apply><apply id="S4.E14.m1.2.2.2.2.1.1.5.cmml" xref="S4.E14.m1.2.2.2.2.1.1.5"><times id="S4.E14.m1.2.2.2.2.1.1.5.1.cmml" xref="S4.E14.m1.2.2.2.2.1.1.5.1"></times><ci id="S4.E14.m1.2.2.2.2.1.1.5.2.cmml" xref="S4.E14.m1.2.2.2.2.1.1.5.2">𝐹</ci><ci id="S4.E14.m1.2.2.2.2.1.1.5.3.cmml" xref="S4.E14.m1.2.2.2.2.1.1.5.3">𝑁</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.E14.m1.2c">ACC={(TP+TN)}/{(TP+TN+FP+FN)}</annotation><annotation encoding="application/x-llamapun" id="S4.E14.m1.2d">italic_A italic_C italic_C = ( italic_T italic_P + italic_T italic_N ) / ( italic_T italic_P + italic_T italic_N + italic_F italic_P + italic_F italic_N )</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S4.SS2.SSS2.p2.2">where TP (True Positives) are the correctly predicted positive cases, TN (True Negatives) are the correctly predicted negative cases, FP (False Positives) are the incorrectly predicted positive cases, and FN (False Negatives) are the positive cases that are incorrectly predicted as negative.</p>
</div>
<div class="ltx_para" id="S4.SS2.SSS2.p3">
<p class="ltx_p" id="S4.SS2.SSS2.p3.1">PRE measures the proportion of true positive predictions among all positive predictions made by the model. A higher PRE indicates that the model is better at minimizing false positives:</p>
<table class="ltx_equation ltx_eqn_table" id="S4.E15">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_left" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_left">(15)</span></td>
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="PRE=TP/{(TP+FP)}" class="ltx_Math" display="block" id="S4.E15.m1.1"><semantics id="S4.E15.m1.1a"><mrow id="S4.E15.m1.1.1" xref="S4.E15.m1.1.1.cmml"><mrow id="S4.E15.m1.1.1.3" xref="S4.E15.m1.1.1.3.cmml"><mi id="S4.E15.m1.1.1.3.2" xref="S4.E15.m1.1.1.3.2.cmml">P</mi><mo id="S4.E15.m1.1.1.3.1" xref="S4.E15.m1.1.1.3.1.cmml">⁢</mo><mi id="S4.E15.m1.1.1.3.3" xref="S4.E15.m1.1.1.3.3.cmml">R</mi><mo id="S4.E15.m1.1.1.3.1a" xref="S4.E15.m1.1.1.3.1.cmml">⁢</mo><mi id="S4.E15.m1.1.1.3.4" xref="S4.E15.m1.1.1.3.4.cmml">E</mi></mrow><mo id="S4.E15.m1.1.1.2" xref="S4.E15.m1.1.1.2.cmml">=</mo><mrow id="S4.E15.m1.1.1.1" xref="S4.E15.m1.1.1.1.cmml"><mrow id="S4.E15.m1.1.1.1.3" xref="S4.E15.m1.1.1.1.3.cmml"><mi id="S4.E15.m1.1.1.1.3.2" xref="S4.E15.m1.1.1.1.3.2.cmml">T</mi><mo id="S4.E15.m1.1.1.1.3.1" xref="S4.E15.m1.1.1.1.3.1.cmml">⁢</mo><mi id="S4.E15.m1.1.1.1.3.3" xref="S4.E15.m1.1.1.1.3.3.cmml">P</mi></mrow><mo id="S4.E15.m1.1.1.1.2" xref="S4.E15.m1.1.1.1.2.cmml">/</mo><mrow id="S4.E15.m1.1.1.1.1.1" xref="S4.E15.m1.1.1.1.1.1.1.cmml"><mo id="S4.E15.m1.1.1.1.1.1.2" stretchy="false" xref="S4.E15.m1.1.1.1.1.1.1.cmml">(</mo><mrow id="S4.E15.m1.1.1.1.1.1.1" xref="S4.E15.m1.1.1.1.1.1.1.cmml"><mrow id="S4.E15.m1.1.1.1.1.1.1.2" xref="S4.E15.m1.1.1.1.1.1.1.2.cmml"><mi id="S4.E15.m1.1.1.1.1.1.1.2.2" xref="S4.E15.m1.1.1.1.1.1.1.2.2.cmml">T</mi><mo id="S4.E15.m1.1.1.1.1.1.1.2.1" xref="S4.E15.m1.1.1.1.1.1.1.2.1.cmml">⁢</mo><mi id="S4.E15.m1.1.1.1.1.1.1.2.3" xref="S4.E15.m1.1.1.1.1.1.1.2.3.cmml">P</mi></mrow><mo id="S4.E15.m1.1.1.1.1.1.1.1" xref="S4.E15.m1.1.1.1.1.1.1.1.cmml">+</mo><mrow id="S4.E15.m1.1.1.1.1.1.1.3" xref="S4.E15.m1.1.1.1.1.1.1.3.cmml"><mi id="S4.E15.m1.1.1.1.1.1.1.3.2" xref="S4.E15.m1.1.1.1.1.1.1.3.2.cmml">F</mi><mo id="S4.E15.m1.1.1.1.1.1.1.3.1" xref="S4.E15.m1.1.1.1.1.1.1.3.1.cmml">⁢</mo><mi id="S4.E15.m1.1.1.1.1.1.1.3.3" xref="S4.E15.m1.1.1.1.1.1.1.3.3.cmml">P</mi></mrow></mrow><mo id="S4.E15.m1.1.1.1.1.1.3" stretchy="false" xref="S4.E15.m1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.E15.m1.1b"><apply id="S4.E15.m1.1.1.cmml" xref="S4.E15.m1.1.1"><eq id="S4.E15.m1.1.1.2.cmml" xref="S4.E15.m1.1.1.2"></eq><apply id="S4.E15.m1.1.1.3.cmml" xref="S4.E15.m1.1.1.3"><times id="S4.E15.m1.1.1.3.1.cmml" xref="S4.E15.m1.1.1.3.1"></times><ci id="S4.E15.m1.1.1.3.2.cmml" xref="S4.E15.m1.1.1.3.2">𝑃</ci><ci id="S4.E15.m1.1.1.3.3.cmml" xref="S4.E15.m1.1.1.3.3">𝑅</ci><ci id="S4.E15.m1.1.1.3.4.cmml" xref="S4.E15.m1.1.1.3.4">𝐸</ci></apply><apply id="S4.E15.m1.1.1.1.cmml" xref="S4.E15.m1.1.1.1"><divide id="S4.E15.m1.1.1.1.2.cmml" xref="S4.E15.m1.1.1.1.2"></divide><apply id="S4.E15.m1.1.1.1.3.cmml" xref="S4.E15.m1.1.1.1.3"><times id="S4.E15.m1.1.1.1.3.1.cmml" xref="S4.E15.m1.1.1.1.3.1"></times><ci id="S4.E15.m1.1.1.1.3.2.cmml" xref="S4.E15.m1.1.1.1.3.2">𝑇</ci><ci id="S4.E15.m1.1.1.1.3.3.cmml" xref="S4.E15.m1.1.1.1.3.3">𝑃</ci></apply><apply id="S4.E15.m1.1.1.1.1.1.1.cmml" xref="S4.E15.m1.1.1.1.1.1"><plus id="S4.E15.m1.1.1.1.1.1.1.1.cmml" xref="S4.E15.m1.1.1.1.1.1.1.1"></plus><apply id="S4.E15.m1.1.1.1.1.1.1.2.cmml" xref="S4.E15.m1.1.1.1.1.1.1.2"><times id="S4.E15.m1.1.1.1.1.1.1.2.1.cmml" xref="S4.E15.m1.1.1.1.1.1.1.2.1"></times><ci id="S4.E15.m1.1.1.1.1.1.1.2.2.cmml" xref="S4.E15.m1.1.1.1.1.1.1.2.2">𝑇</ci><ci id="S4.E15.m1.1.1.1.1.1.1.2.3.cmml" xref="S4.E15.m1.1.1.1.1.1.1.2.3">𝑃</ci></apply><apply id="S4.E15.m1.1.1.1.1.1.1.3.cmml" xref="S4.E15.m1.1.1.1.1.1.1.3"><times id="S4.E15.m1.1.1.1.1.1.1.3.1.cmml" xref="S4.E15.m1.1.1.1.1.1.1.3.1"></times><ci id="S4.E15.m1.1.1.1.1.1.1.3.2.cmml" xref="S4.E15.m1.1.1.1.1.1.1.3.2">𝐹</ci><ci id="S4.E15.m1.1.1.1.1.1.1.3.3.cmml" xref="S4.E15.m1.1.1.1.1.1.1.3.3">𝑃</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.E15.m1.1c">PRE=TP/{(TP+FP)}</annotation><annotation encoding="application/x-llamapun" id="S4.E15.m1.1d">italic_P italic_R italic_E = italic_T italic_P / ( italic_T italic_P + italic_F italic_P )</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
</div>
<div class="ltx_para" id="S4.SS2.SSS2.p4">
<p class="ltx_p" id="S4.SS2.SSS2.p4.1">REC measures the proportion of true positive cases that are correctly identified by the model out of all actual positive cases. A higher REC indicates that the model is better at identifying most of the positive cases.</p>
<table class="ltx_equation ltx_eqn_table" id="S4.E16">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_left" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_left">(16)</span></td>
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="REC=TP/{(TP+FN)}" class="ltx_Math" display="block" id="S4.E16.m1.1"><semantics id="S4.E16.m1.1a"><mrow id="S4.E16.m1.1.1" xref="S4.E16.m1.1.1.cmml"><mrow id="S4.E16.m1.1.1.3" xref="S4.E16.m1.1.1.3.cmml"><mi id="S4.E16.m1.1.1.3.2" xref="S4.E16.m1.1.1.3.2.cmml">R</mi><mo id="S4.E16.m1.1.1.3.1" xref="S4.E16.m1.1.1.3.1.cmml">⁢</mo><mi id="S4.E16.m1.1.1.3.3" xref="S4.E16.m1.1.1.3.3.cmml">E</mi><mo id="S4.E16.m1.1.1.3.1a" xref="S4.E16.m1.1.1.3.1.cmml">⁢</mo><mi id="S4.E16.m1.1.1.3.4" xref="S4.E16.m1.1.1.3.4.cmml">C</mi></mrow><mo id="S4.E16.m1.1.1.2" xref="S4.E16.m1.1.1.2.cmml">=</mo><mrow id="S4.E16.m1.1.1.1" xref="S4.E16.m1.1.1.1.cmml"><mrow id="S4.E16.m1.1.1.1.3" xref="S4.E16.m1.1.1.1.3.cmml"><mi id="S4.E16.m1.1.1.1.3.2" xref="S4.E16.m1.1.1.1.3.2.cmml">T</mi><mo id="S4.E16.m1.1.1.1.3.1" xref="S4.E16.m1.1.1.1.3.1.cmml">⁢</mo><mi id="S4.E16.m1.1.1.1.3.3" xref="S4.E16.m1.1.1.1.3.3.cmml">P</mi></mrow><mo id="S4.E16.m1.1.1.1.2" xref="S4.E16.m1.1.1.1.2.cmml">/</mo><mrow id="S4.E16.m1.1.1.1.1.1" xref="S4.E16.m1.1.1.1.1.1.1.cmml"><mo id="S4.E16.m1.1.1.1.1.1.2" stretchy="false" xref="S4.E16.m1.1.1.1.1.1.1.cmml">(</mo><mrow id="S4.E16.m1.1.1.1.1.1.1" xref="S4.E16.m1.1.1.1.1.1.1.cmml"><mrow id="S4.E16.m1.1.1.1.1.1.1.2" xref="S4.E16.m1.1.1.1.1.1.1.2.cmml"><mi id="S4.E16.m1.1.1.1.1.1.1.2.2" xref="S4.E16.m1.1.1.1.1.1.1.2.2.cmml">T</mi><mo id="S4.E16.m1.1.1.1.1.1.1.2.1" xref="S4.E16.m1.1.1.1.1.1.1.2.1.cmml">⁢</mo><mi id="S4.E16.m1.1.1.1.1.1.1.2.3" xref="S4.E16.m1.1.1.1.1.1.1.2.3.cmml">P</mi></mrow><mo id="S4.E16.m1.1.1.1.1.1.1.1" xref="S4.E16.m1.1.1.1.1.1.1.1.cmml">+</mo><mrow id="S4.E16.m1.1.1.1.1.1.1.3" xref="S4.E16.m1.1.1.1.1.1.1.3.cmml"><mi id="S4.E16.m1.1.1.1.1.1.1.3.2" xref="S4.E16.m1.1.1.1.1.1.1.3.2.cmml">F</mi><mo id="S4.E16.m1.1.1.1.1.1.1.3.1" xref="S4.E16.m1.1.1.1.1.1.1.3.1.cmml">⁢</mo><mi id="S4.E16.m1.1.1.1.1.1.1.3.3" xref="S4.E16.m1.1.1.1.1.1.1.3.3.cmml">N</mi></mrow></mrow><mo id="S4.E16.m1.1.1.1.1.1.3" stretchy="false" xref="S4.E16.m1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.E16.m1.1b"><apply id="S4.E16.m1.1.1.cmml" xref="S4.E16.m1.1.1"><eq id="S4.E16.m1.1.1.2.cmml" xref="S4.E16.m1.1.1.2"></eq><apply id="S4.E16.m1.1.1.3.cmml" xref="S4.E16.m1.1.1.3"><times id="S4.E16.m1.1.1.3.1.cmml" xref="S4.E16.m1.1.1.3.1"></times><ci id="S4.E16.m1.1.1.3.2.cmml" xref="S4.E16.m1.1.1.3.2">𝑅</ci><ci id="S4.E16.m1.1.1.3.3.cmml" xref="S4.E16.m1.1.1.3.3">𝐸</ci><ci id="S4.E16.m1.1.1.3.4.cmml" xref="S4.E16.m1.1.1.3.4">𝐶</ci></apply><apply id="S4.E16.m1.1.1.1.cmml" xref="S4.E16.m1.1.1.1"><divide id="S4.E16.m1.1.1.1.2.cmml" xref="S4.E16.m1.1.1.1.2"></divide><apply id="S4.E16.m1.1.1.1.3.cmml" xref="S4.E16.m1.1.1.1.3"><times id="S4.E16.m1.1.1.1.3.1.cmml" xref="S4.E16.m1.1.1.1.3.1"></times><ci id="S4.E16.m1.1.1.1.3.2.cmml" xref="S4.E16.m1.1.1.1.3.2">𝑇</ci><ci id="S4.E16.m1.1.1.1.3.3.cmml" xref="S4.E16.m1.1.1.1.3.3">𝑃</ci></apply><apply id="S4.E16.m1.1.1.1.1.1.1.cmml" xref="S4.E16.m1.1.1.1.1.1"><plus id="S4.E16.m1.1.1.1.1.1.1.1.cmml" xref="S4.E16.m1.1.1.1.1.1.1.1"></plus><apply id="S4.E16.m1.1.1.1.1.1.1.2.cmml" xref="S4.E16.m1.1.1.1.1.1.1.2"><times id="S4.E16.m1.1.1.1.1.1.1.2.1.cmml" xref="S4.E16.m1.1.1.1.1.1.1.2.1"></times><ci id="S4.E16.m1.1.1.1.1.1.1.2.2.cmml" xref="S4.E16.m1.1.1.1.1.1.1.2.2">𝑇</ci><ci id="S4.E16.m1.1.1.1.1.1.1.2.3.cmml" xref="S4.E16.m1.1.1.1.1.1.1.2.3">𝑃</ci></apply><apply id="S4.E16.m1.1.1.1.1.1.1.3.cmml" xref="S4.E16.m1.1.1.1.1.1.1.3"><times id="S4.E16.m1.1.1.1.1.1.1.3.1.cmml" xref="S4.E16.m1.1.1.1.1.1.1.3.1"></times><ci id="S4.E16.m1.1.1.1.1.1.1.3.2.cmml" xref="S4.E16.m1.1.1.1.1.1.1.3.2">𝐹</ci><ci id="S4.E16.m1.1.1.1.1.1.1.3.3.cmml" xref="S4.E16.m1.1.1.1.1.1.1.3.3">𝑁</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.E16.m1.1c">REC=TP/{(TP+FN)}</annotation><annotation encoding="application/x-llamapun" id="S4.E16.m1.1d">italic_R italic_E italic_C = italic_T italic_P / ( italic_T italic_P + italic_F italic_N )</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
</div>
<div class="ltx_para" id="S4.SS2.SSS2.p5">
<p class="ltx_p" id="S4.SS2.SSS2.p5.1">The F1 Score is the harmonic mean of PRE and REC, providing a balance between the two metrics. A higher F1 score indicates that the model performs well in both precision and recall:</p>
<table class="ltx_equation ltx_eqn_table" id="S4.E17">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_left" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_left">(17)</span></td>
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="F1=2*{{(PRE*REC)}/{(PRE+REC)}}" class="ltx_Math" display="block" id="S4.E17.m1.2"><semantics id="S4.E17.m1.2a"><mrow id="S4.E17.m1.2.2" xref="S4.E17.m1.2.2.cmml"><mrow id="S4.E17.m1.2.2.4" xref="S4.E17.m1.2.2.4.cmml"><mi id="S4.E17.m1.2.2.4.2" xref="S4.E17.m1.2.2.4.2.cmml">F</mi><mo id="S4.E17.m1.2.2.4.1" xref="S4.E17.m1.2.2.4.1.cmml">⁢</mo><mn id="S4.E17.m1.2.2.4.3" xref="S4.E17.m1.2.2.4.3.cmml">1</mn></mrow><mo id="S4.E17.m1.2.2.3" xref="S4.E17.m1.2.2.3.cmml">=</mo><mrow id="S4.E17.m1.2.2.2" xref="S4.E17.m1.2.2.2.cmml"><mrow id="S4.E17.m1.1.1.1.1" xref="S4.E17.m1.1.1.1.1.cmml"><mn id="S4.E17.m1.1.1.1.1.3" xref="S4.E17.m1.1.1.1.1.3.cmml">2</mn><mo id="S4.E17.m1.1.1.1.1.2" lspace="0.222em" rspace="0.222em" xref="S4.E17.m1.1.1.1.1.2.cmml">∗</mo><mrow id="S4.E17.m1.1.1.1.1.1.1" xref="S4.E17.m1.1.1.1.1.1.1.1.cmml"><mo id="S4.E17.m1.1.1.1.1.1.1.2" stretchy="false" xref="S4.E17.m1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="S4.E17.m1.1.1.1.1.1.1.1" xref="S4.E17.m1.1.1.1.1.1.1.1.cmml"><mrow id="S4.E17.m1.1.1.1.1.1.1.1.2" xref="S4.E17.m1.1.1.1.1.1.1.1.2.cmml"><mrow id="S4.E17.m1.1.1.1.1.1.1.1.2.2" xref="S4.E17.m1.1.1.1.1.1.1.1.2.2.cmml"><mi id="S4.E17.m1.1.1.1.1.1.1.1.2.2.2" xref="S4.E17.m1.1.1.1.1.1.1.1.2.2.2.cmml">P</mi><mo id="S4.E17.m1.1.1.1.1.1.1.1.2.2.1" xref="S4.E17.m1.1.1.1.1.1.1.1.2.2.1.cmml">⁢</mo><mi id="S4.E17.m1.1.1.1.1.1.1.1.2.2.3" xref="S4.E17.m1.1.1.1.1.1.1.1.2.2.3.cmml">R</mi><mo id="S4.E17.m1.1.1.1.1.1.1.1.2.2.1a" xref="S4.E17.m1.1.1.1.1.1.1.1.2.2.1.cmml">⁢</mo><mi id="S4.E17.m1.1.1.1.1.1.1.1.2.2.4" xref="S4.E17.m1.1.1.1.1.1.1.1.2.2.4.cmml">E</mi></mrow><mo id="S4.E17.m1.1.1.1.1.1.1.1.2.1" lspace="0.222em" rspace="0.222em" xref="S4.E17.m1.1.1.1.1.1.1.1.2.1.cmml">∗</mo><mi id="S4.E17.m1.1.1.1.1.1.1.1.2.3" xref="S4.E17.m1.1.1.1.1.1.1.1.2.3.cmml">R</mi></mrow><mo id="S4.E17.m1.1.1.1.1.1.1.1.1" xref="S4.E17.m1.1.1.1.1.1.1.1.1.cmml">⁢</mo><mi id="S4.E17.m1.1.1.1.1.1.1.1.3" xref="S4.E17.m1.1.1.1.1.1.1.1.3.cmml">E</mi><mo id="S4.E17.m1.1.1.1.1.1.1.1.1a" xref="S4.E17.m1.1.1.1.1.1.1.1.1.cmml">⁢</mo><mi id="S4.E17.m1.1.1.1.1.1.1.1.4" xref="S4.E17.m1.1.1.1.1.1.1.1.4.cmml">C</mi></mrow><mo id="S4.E17.m1.1.1.1.1.1.1.3" stretchy="false" xref="S4.E17.m1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S4.E17.m1.2.2.2.3" xref="S4.E17.m1.2.2.2.3.cmml">/</mo><mrow id="S4.E17.m1.2.2.2.2.1" xref="S4.E17.m1.2.2.2.2.1.1.cmml"><mo id="S4.E17.m1.2.2.2.2.1.2" stretchy="false" xref="S4.E17.m1.2.2.2.2.1.1.cmml">(</mo><mrow id="S4.E17.m1.2.2.2.2.1.1" xref="S4.E17.m1.2.2.2.2.1.1.cmml"><mrow id="S4.E17.m1.2.2.2.2.1.1.2" xref="S4.E17.m1.2.2.2.2.1.1.2.cmml"><mi id="S4.E17.m1.2.2.2.2.1.1.2.2" xref="S4.E17.m1.2.2.2.2.1.1.2.2.cmml">P</mi><mo id="S4.E17.m1.2.2.2.2.1.1.2.1" xref="S4.E17.m1.2.2.2.2.1.1.2.1.cmml">⁢</mo><mi id="S4.E17.m1.2.2.2.2.1.1.2.3" xref="S4.E17.m1.2.2.2.2.1.1.2.3.cmml">R</mi><mo id="S4.E17.m1.2.2.2.2.1.1.2.1a" xref="S4.E17.m1.2.2.2.2.1.1.2.1.cmml">⁢</mo><mi id="S4.E17.m1.2.2.2.2.1.1.2.4" xref="S4.E17.m1.2.2.2.2.1.1.2.4.cmml">E</mi></mrow><mo id="S4.E17.m1.2.2.2.2.1.1.1" xref="S4.E17.m1.2.2.2.2.1.1.1.cmml">+</mo><mrow id="S4.E17.m1.2.2.2.2.1.1.3" xref="S4.E17.m1.2.2.2.2.1.1.3.cmml"><mi id="S4.E17.m1.2.2.2.2.1.1.3.2" xref="S4.E17.m1.2.2.2.2.1.1.3.2.cmml">R</mi><mo id="S4.E17.m1.2.2.2.2.1.1.3.1" xref="S4.E17.m1.2.2.2.2.1.1.3.1.cmml">⁢</mo><mi id="S4.E17.m1.2.2.2.2.1.1.3.3" xref="S4.E17.m1.2.2.2.2.1.1.3.3.cmml">E</mi><mo id="S4.E17.m1.2.2.2.2.1.1.3.1a" xref="S4.E17.m1.2.2.2.2.1.1.3.1.cmml">⁢</mo><mi id="S4.E17.m1.2.2.2.2.1.1.3.4" xref="S4.E17.m1.2.2.2.2.1.1.3.4.cmml">C</mi></mrow></mrow><mo id="S4.E17.m1.2.2.2.2.1.3" stretchy="false" xref="S4.E17.m1.2.2.2.2.1.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.E17.m1.2b"><apply id="S4.E17.m1.2.2.cmml" xref="S4.E17.m1.2.2"><eq id="S4.E17.m1.2.2.3.cmml" xref="S4.E17.m1.2.2.3"></eq><apply id="S4.E17.m1.2.2.4.cmml" xref="S4.E17.m1.2.2.4"><times id="S4.E17.m1.2.2.4.1.cmml" xref="S4.E17.m1.2.2.4.1"></times><ci id="S4.E17.m1.2.2.4.2.cmml" xref="S4.E17.m1.2.2.4.2">𝐹</ci><cn id="S4.E17.m1.2.2.4.3.cmml" type="integer" xref="S4.E17.m1.2.2.4.3">1</cn></apply><apply id="S4.E17.m1.2.2.2.cmml" xref="S4.E17.m1.2.2.2"><divide id="S4.E17.m1.2.2.2.3.cmml" xref="S4.E17.m1.2.2.2.3"></divide><apply id="S4.E17.m1.1.1.1.1.cmml" xref="S4.E17.m1.1.1.1.1"><times id="S4.E17.m1.1.1.1.1.2.cmml" xref="S4.E17.m1.1.1.1.1.2"></times><cn id="S4.E17.m1.1.1.1.1.3.cmml" type="integer" xref="S4.E17.m1.1.1.1.1.3">2</cn><apply id="S4.E17.m1.1.1.1.1.1.1.1.cmml" xref="S4.E17.m1.1.1.1.1.1.1"><times id="S4.E17.m1.1.1.1.1.1.1.1.1.cmml" xref="S4.E17.m1.1.1.1.1.1.1.1.1"></times><apply id="S4.E17.m1.1.1.1.1.1.1.1.2.cmml" xref="S4.E17.m1.1.1.1.1.1.1.1.2"><times id="S4.E17.m1.1.1.1.1.1.1.1.2.1.cmml" xref="S4.E17.m1.1.1.1.1.1.1.1.2.1"></times><apply id="S4.E17.m1.1.1.1.1.1.1.1.2.2.cmml" xref="S4.E17.m1.1.1.1.1.1.1.1.2.2"><times id="S4.E17.m1.1.1.1.1.1.1.1.2.2.1.cmml" xref="S4.E17.m1.1.1.1.1.1.1.1.2.2.1"></times><ci id="S4.E17.m1.1.1.1.1.1.1.1.2.2.2.cmml" xref="S4.E17.m1.1.1.1.1.1.1.1.2.2.2">𝑃</ci><ci id="S4.E17.m1.1.1.1.1.1.1.1.2.2.3.cmml" xref="S4.E17.m1.1.1.1.1.1.1.1.2.2.3">𝑅</ci><ci id="S4.E17.m1.1.1.1.1.1.1.1.2.2.4.cmml" xref="S4.E17.m1.1.1.1.1.1.1.1.2.2.4">𝐸</ci></apply><ci id="S4.E17.m1.1.1.1.1.1.1.1.2.3.cmml" xref="S4.E17.m1.1.1.1.1.1.1.1.2.3">𝑅</ci></apply><ci id="S4.E17.m1.1.1.1.1.1.1.1.3.cmml" xref="S4.E17.m1.1.1.1.1.1.1.1.3">𝐸</ci><ci id="S4.E17.m1.1.1.1.1.1.1.1.4.cmml" xref="S4.E17.m1.1.1.1.1.1.1.1.4">𝐶</ci></apply></apply><apply id="S4.E17.m1.2.2.2.2.1.1.cmml" xref="S4.E17.m1.2.2.2.2.1"><plus id="S4.E17.m1.2.2.2.2.1.1.1.cmml" xref="S4.E17.m1.2.2.2.2.1.1.1"></plus><apply id="S4.E17.m1.2.2.2.2.1.1.2.cmml" xref="S4.E17.m1.2.2.2.2.1.1.2"><times id="S4.E17.m1.2.2.2.2.1.1.2.1.cmml" xref="S4.E17.m1.2.2.2.2.1.1.2.1"></times><ci id="S4.E17.m1.2.2.2.2.1.1.2.2.cmml" xref="S4.E17.m1.2.2.2.2.1.1.2.2">𝑃</ci><ci id="S4.E17.m1.2.2.2.2.1.1.2.3.cmml" xref="S4.E17.m1.2.2.2.2.1.1.2.3">𝑅</ci><ci id="S4.E17.m1.2.2.2.2.1.1.2.4.cmml" xref="S4.E17.m1.2.2.2.2.1.1.2.4">𝐸</ci></apply><apply id="S4.E17.m1.2.2.2.2.1.1.3.cmml" xref="S4.E17.m1.2.2.2.2.1.1.3"><times id="S4.E17.m1.2.2.2.2.1.1.3.1.cmml" xref="S4.E17.m1.2.2.2.2.1.1.3.1"></times><ci id="S4.E17.m1.2.2.2.2.1.1.3.2.cmml" xref="S4.E17.m1.2.2.2.2.1.1.3.2">𝑅</ci><ci id="S4.E17.m1.2.2.2.2.1.1.3.3.cmml" xref="S4.E17.m1.2.2.2.2.1.1.3.3">𝐸</ci><ci id="S4.E17.m1.2.2.2.2.1.1.3.4.cmml" xref="S4.E17.m1.2.2.2.2.1.1.3.4">𝐶</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.E17.m1.2c">F1=2*{{(PRE*REC)}/{(PRE+REC)}}</annotation><annotation encoding="application/x-llamapun" id="S4.E17.m1.2d">italic_F 1 = 2 ∗ ( italic_P italic_R italic_E ∗ italic_R italic_E italic_C ) / ( italic_P italic_R italic_E + italic_R italic_E italic_C )</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
</div>
<div class="ltx_para" id="S4.SS2.SSS2.p6">
<p class="ltx_p" id="S4.SS2.SSS2.p6.7">The Weighted-F1 score accounts for the varying sizes of each class by taking the weighted average of the F1 scores for each class. This metric is particularly useful when dealing with imbalanced datasets:</p>
<table class="ltx_equation ltx_eqn_table" id="S4.E18">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_left" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_left">(18)</span></td>
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="Weighted-F1=\sum_{k=1}^{K}\frac{a_{k}}{I}\times{F1}_{k}" class="ltx_Math" display="block" id="S4.E18.m1.1"><semantics id="S4.E18.m1.1a"><mrow id="S4.E18.m1.1.1" xref="S4.E18.m1.1.1.cmml"><mrow id="S4.E18.m1.1.1.2" xref="S4.E18.m1.1.1.2.cmml"><mrow id="S4.E18.m1.1.1.2.2" xref="S4.E18.m1.1.1.2.2.cmml"><mi id="S4.E18.m1.1.1.2.2.2" xref="S4.E18.m1.1.1.2.2.2.cmml">W</mi><mo id="S4.E18.m1.1.1.2.2.1" xref="S4.E18.m1.1.1.2.2.1.cmml">⁢</mo><mi id="S4.E18.m1.1.1.2.2.3" xref="S4.E18.m1.1.1.2.2.3.cmml">e</mi><mo id="S4.E18.m1.1.1.2.2.1a" xref="S4.E18.m1.1.1.2.2.1.cmml">⁢</mo><mi id="S4.E18.m1.1.1.2.2.4" xref="S4.E18.m1.1.1.2.2.4.cmml">i</mi><mo id="S4.E18.m1.1.1.2.2.1b" xref="S4.E18.m1.1.1.2.2.1.cmml">⁢</mo><mi id="S4.E18.m1.1.1.2.2.5" xref="S4.E18.m1.1.1.2.2.5.cmml">g</mi><mo id="S4.E18.m1.1.1.2.2.1c" xref="S4.E18.m1.1.1.2.2.1.cmml">⁢</mo><mi id="S4.E18.m1.1.1.2.2.6" xref="S4.E18.m1.1.1.2.2.6.cmml">h</mi><mo id="S4.E18.m1.1.1.2.2.1d" xref="S4.E18.m1.1.1.2.2.1.cmml">⁢</mo><mi id="S4.E18.m1.1.1.2.2.7" xref="S4.E18.m1.1.1.2.2.7.cmml">t</mi><mo id="S4.E18.m1.1.1.2.2.1e" xref="S4.E18.m1.1.1.2.2.1.cmml">⁢</mo><mi id="S4.E18.m1.1.1.2.2.8" xref="S4.E18.m1.1.1.2.2.8.cmml">e</mi><mo id="S4.E18.m1.1.1.2.2.1f" xref="S4.E18.m1.1.1.2.2.1.cmml">⁢</mo><mi id="S4.E18.m1.1.1.2.2.9" xref="S4.E18.m1.1.1.2.2.9.cmml">d</mi></mrow><mo id="S4.E18.m1.1.1.2.1" xref="S4.E18.m1.1.1.2.1.cmml">−</mo><mrow id="S4.E18.m1.1.1.2.3" xref="S4.E18.m1.1.1.2.3.cmml"><mi id="S4.E18.m1.1.1.2.3.2" xref="S4.E18.m1.1.1.2.3.2.cmml">F</mi><mo id="S4.E18.m1.1.1.2.3.1" xref="S4.E18.m1.1.1.2.3.1.cmml">⁢</mo><mn id="S4.E18.m1.1.1.2.3.3" xref="S4.E18.m1.1.1.2.3.3.cmml">1</mn></mrow></mrow><mo id="S4.E18.m1.1.1.1" rspace="0.111em" xref="S4.E18.m1.1.1.1.cmml">=</mo><mrow id="S4.E18.m1.1.1.3" xref="S4.E18.m1.1.1.3.cmml"><munderover id="S4.E18.m1.1.1.3.1" xref="S4.E18.m1.1.1.3.1.cmml"><mo id="S4.E18.m1.1.1.3.1.2.2" movablelimits="false" xref="S4.E18.m1.1.1.3.1.2.2.cmml">∑</mo><mrow id="S4.E18.m1.1.1.3.1.2.3" xref="S4.E18.m1.1.1.3.1.2.3.cmml"><mi id="S4.E18.m1.1.1.3.1.2.3.2" xref="S4.E18.m1.1.1.3.1.2.3.2.cmml">k</mi><mo id="S4.E18.m1.1.1.3.1.2.3.1" xref="S4.E18.m1.1.1.3.1.2.3.1.cmml">=</mo><mn id="S4.E18.m1.1.1.3.1.2.3.3" xref="S4.E18.m1.1.1.3.1.2.3.3.cmml">1</mn></mrow><mi id="S4.E18.m1.1.1.3.1.3" xref="S4.E18.m1.1.1.3.1.3.cmml">K</mi></munderover><mrow id="S4.E18.m1.1.1.3.2" xref="S4.E18.m1.1.1.3.2.cmml"><mrow id="S4.E18.m1.1.1.3.2.2" xref="S4.E18.m1.1.1.3.2.2.cmml"><mfrac id="S4.E18.m1.1.1.3.2.2.2" xref="S4.E18.m1.1.1.3.2.2.2.cmml"><msub id="S4.E18.m1.1.1.3.2.2.2.2" xref="S4.E18.m1.1.1.3.2.2.2.2.cmml"><mi id="S4.E18.m1.1.1.3.2.2.2.2.2" xref="S4.E18.m1.1.1.3.2.2.2.2.2.cmml">a</mi><mi id="S4.E18.m1.1.1.3.2.2.2.2.3" xref="S4.E18.m1.1.1.3.2.2.2.2.3.cmml">k</mi></msub><mi id="S4.E18.m1.1.1.3.2.2.2.3" xref="S4.E18.m1.1.1.3.2.2.2.3.cmml">I</mi></mfrac><mo id="S4.E18.m1.1.1.3.2.2.1" lspace="0.222em" rspace="0.222em" xref="S4.E18.m1.1.1.3.2.2.1.cmml">×</mo><mi id="S4.E18.m1.1.1.3.2.2.3" xref="S4.E18.m1.1.1.3.2.2.3.cmml">F</mi></mrow><mo id="S4.E18.m1.1.1.3.2.1" xref="S4.E18.m1.1.1.3.2.1.cmml">⁢</mo><msub id="S4.E18.m1.1.1.3.2.3" xref="S4.E18.m1.1.1.3.2.3.cmml"><mn id="S4.E18.m1.1.1.3.2.3.2" xref="S4.E18.m1.1.1.3.2.3.2.cmml">1</mn><mi id="S4.E18.m1.1.1.3.2.3.3" xref="S4.E18.m1.1.1.3.2.3.3.cmml">k</mi></msub></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.E18.m1.1b"><apply id="S4.E18.m1.1.1.cmml" xref="S4.E18.m1.1.1"><eq id="S4.E18.m1.1.1.1.cmml" xref="S4.E18.m1.1.1.1"></eq><apply id="S4.E18.m1.1.1.2.cmml" xref="S4.E18.m1.1.1.2"><minus id="S4.E18.m1.1.1.2.1.cmml" xref="S4.E18.m1.1.1.2.1"></minus><apply id="S4.E18.m1.1.1.2.2.cmml" xref="S4.E18.m1.1.1.2.2"><times id="S4.E18.m1.1.1.2.2.1.cmml" xref="S4.E18.m1.1.1.2.2.1"></times><ci id="S4.E18.m1.1.1.2.2.2.cmml" xref="S4.E18.m1.1.1.2.2.2">𝑊</ci><ci id="S4.E18.m1.1.1.2.2.3.cmml" xref="S4.E18.m1.1.1.2.2.3">𝑒</ci><ci id="S4.E18.m1.1.1.2.2.4.cmml" xref="S4.E18.m1.1.1.2.2.4">𝑖</ci><ci id="S4.E18.m1.1.1.2.2.5.cmml" xref="S4.E18.m1.1.1.2.2.5">𝑔</ci><ci id="S4.E18.m1.1.1.2.2.6.cmml" xref="S4.E18.m1.1.1.2.2.6">ℎ</ci><ci id="S4.E18.m1.1.1.2.2.7.cmml" xref="S4.E18.m1.1.1.2.2.7">𝑡</ci><ci id="S4.E18.m1.1.1.2.2.8.cmml" xref="S4.E18.m1.1.1.2.2.8">𝑒</ci><ci id="S4.E18.m1.1.1.2.2.9.cmml" xref="S4.E18.m1.1.1.2.2.9">𝑑</ci></apply><apply id="S4.E18.m1.1.1.2.3.cmml" xref="S4.E18.m1.1.1.2.3"><times id="S4.E18.m1.1.1.2.3.1.cmml" xref="S4.E18.m1.1.1.2.3.1"></times><ci id="S4.E18.m1.1.1.2.3.2.cmml" xref="S4.E18.m1.1.1.2.3.2">𝐹</ci><cn id="S4.E18.m1.1.1.2.3.3.cmml" type="integer" xref="S4.E18.m1.1.1.2.3.3">1</cn></apply></apply><apply id="S4.E18.m1.1.1.3.cmml" xref="S4.E18.m1.1.1.3"><apply id="S4.E18.m1.1.1.3.1.cmml" xref="S4.E18.m1.1.1.3.1"><csymbol cd="ambiguous" id="S4.E18.m1.1.1.3.1.1.cmml" xref="S4.E18.m1.1.1.3.1">superscript</csymbol><apply id="S4.E18.m1.1.1.3.1.2.cmml" xref="S4.E18.m1.1.1.3.1"><csymbol cd="ambiguous" id="S4.E18.m1.1.1.3.1.2.1.cmml" xref="S4.E18.m1.1.1.3.1">subscript</csymbol><sum id="S4.E18.m1.1.1.3.1.2.2.cmml" xref="S4.E18.m1.1.1.3.1.2.2"></sum><apply id="S4.E18.m1.1.1.3.1.2.3.cmml" xref="S4.E18.m1.1.1.3.1.2.3"><eq id="S4.E18.m1.1.1.3.1.2.3.1.cmml" xref="S4.E18.m1.1.1.3.1.2.3.1"></eq><ci id="S4.E18.m1.1.1.3.1.2.3.2.cmml" xref="S4.E18.m1.1.1.3.1.2.3.2">𝑘</ci><cn id="S4.E18.m1.1.1.3.1.2.3.3.cmml" type="integer" xref="S4.E18.m1.1.1.3.1.2.3.3">1</cn></apply></apply><ci id="S4.E18.m1.1.1.3.1.3.cmml" xref="S4.E18.m1.1.1.3.1.3">𝐾</ci></apply><apply id="S4.E18.m1.1.1.3.2.cmml" xref="S4.E18.m1.1.1.3.2"><times id="S4.E18.m1.1.1.3.2.1.cmml" xref="S4.E18.m1.1.1.3.2.1"></times><apply id="S4.E18.m1.1.1.3.2.2.cmml" xref="S4.E18.m1.1.1.3.2.2"><times id="S4.E18.m1.1.1.3.2.2.1.cmml" xref="S4.E18.m1.1.1.3.2.2.1"></times><apply id="S4.E18.m1.1.1.3.2.2.2.cmml" xref="S4.E18.m1.1.1.3.2.2.2"><divide id="S4.E18.m1.1.1.3.2.2.2.1.cmml" xref="S4.E18.m1.1.1.3.2.2.2"></divide><apply id="S4.E18.m1.1.1.3.2.2.2.2.cmml" xref="S4.E18.m1.1.1.3.2.2.2.2"><csymbol cd="ambiguous" id="S4.E18.m1.1.1.3.2.2.2.2.1.cmml" xref="S4.E18.m1.1.1.3.2.2.2.2">subscript</csymbol><ci id="S4.E18.m1.1.1.3.2.2.2.2.2.cmml" xref="S4.E18.m1.1.1.3.2.2.2.2.2">𝑎</ci><ci id="S4.E18.m1.1.1.3.2.2.2.2.3.cmml" xref="S4.E18.m1.1.1.3.2.2.2.2.3">𝑘</ci></apply><ci id="S4.E18.m1.1.1.3.2.2.2.3.cmml" xref="S4.E18.m1.1.1.3.2.2.2.3">𝐼</ci></apply><ci id="S4.E18.m1.1.1.3.2.2.3.cmml" xref="S4.E18.m1.1.1.3.2.2.3">𝐹</ci></apply><apply id="S4.E18.m1.1.1.3.2.3.cmml" xref="S4.E18.m1.1.1.3.2.3"><csymbol cd="ambiguous" id="S4.E18.m1.1.1.3.2.3.1.cmml" xref="S4.E18.m1.1.1.3.2.3">subscript</csymbol><cn id="S4.E18.m1.1.1.3.2.3.2.cmml" type="integer" xref="S4.E18.m1.1.1.3.2.3.2">1</cn><ci id="S4.E18.m1.1.1.3.2.3.3.cmml" xref="S4.E18.m1.1.1.3.2.3.3">𝑘</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.E18.m1.1c">Weighted-F1=\sum_{k=1}^{K}\frac{a_{k}}{I}\times{F1}_{k}</annotation><annotation encoding="application/x-llamapun" id="S4.E18.m1.1d">italic_W italic_e italic_i italic_g italic_h italic_t italic_e italic_d - italic_F 1 = ∑ start_POSTSUBSCRIPT italic_k = 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_K end_POSTSUPERSCRIPT divide start_ARG italic_a start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT end_ARG start_ARG italic_I end_ARG × italic_F 1 start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S4.SS2.SSS2.p6.6">where <math alttext="a_{k}" class="ltx_Math" display="inline" id="S4.SS2.SSS2.p6.1.m1.1"><semantics id="S4.SS2.SSS2.p6.1.m1.1a"><msub id="S4.SS2.SSS2.p6.1.m1.1.1" xref="S4.SS2.SSS2.p6.1.m1.1.1.cmml"><mi id="S4.SS2.SSS2.p6.1.m1.1.1.2" xref="S4.SS2.SSS2.p6.1.m1.1.1.2.cmml">a</mi><mi id="S4.SS2.SSS2.p6.1.m1.1.1.3" xref="S4.SS2.SSS2.p6.1.m1.1.1.3.cmml">k</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS2.SSS2.p6.1.m1.1b"><apply id="S4.SS2.SSS2.p6.1.m1.1.1.cmml" xref="S4.SS2.SSS2.p6.1.m1.1.1"><csymbol cd="ambiguous" id="S4.SS2.SSS2.p6.1.m1.1.1.1.cmml" xref="S4.SS2.SSS2.p6.1.m1.1.1">subscript</csymbol><ci id="S4.SS2.SSS2.p6.1.m1.1.1.2.cmml" xref="S4.SS2.SSS2.p6.1.m1.1.1.2">𝑎</ci><ci id="S4.SS2.SSS2.p6.1.m1.1.1.3.cmml" xref="S4.SS2.SSS2.p6.1.m1.1.1.3">𝑘</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.SSS2.p6.1.m1.1c">a_{k}</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.SSS2.p6.1.m1.1d">italic_a start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT</annotation></semantics></math> is the number of samples in class <math alttext="k" class="ltx_Math" display="inline" id="S4.SS2.SSS2.p6.2.m2.1"><semantics id="S4.SS2.SSS2.p6.2.m2.1a"><mi id="S4.SS2.SSS2.p6.2.m2.1.1" xref="S4.SS2.SSS2.p6.2.m2.1.1.cmml">k</mi><annotation-xml encoding="MathML-Content" id="S4.SS2.SSS2.p6.2.m2.1b"><ci id="S4.SS2.SSS2.p6.2.m2.1.1.cmml" xref="S4.SS2.SSS2.p6.2.m2.1.1">𝑘</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.SSS2.p6.2.m2.1c">k</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.SSS2.p6.2.m2.1d">italic_k</annotation></semantics></math>, <math alttext="I" class="ltx_Math" display="inline" id="S4.SS2.SSS2.p6.3.m3.1"><semantics id="S4.SS2.SSS2.p6.3.m3.1a"><mi id="S4.SS2.SSS2.p6.3.m3.1.1" xref="S4.SS2.SSS2.p6.3.m3.1.1.cmml">I</mi><annotation-xml encoding="MathML-Content" id="S4.SS2.SSS2.p6.3.m3.1b"><ci id="S4.SS2.SSS2.p6.3.m3.1.1.cmml" xref="S4.SS2.SSS2.p6.3.m3.1.1">𝐼</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.SSS2.p6.3.m3.1c">I</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.SSS2.p6.3.m3.1d">italic_I</annotation></semantics></math> is the total number of samples, and <math alttext="{F1}_{k}" class="ltx_Math" display="inline" id="S4.SS2.SSS2.p6.4.m4.1"><semantics id="S4.SS2.SSS2.p6.4.m4.1a"><mrow id="S4.SS2.SSS2.p6.4.m4.1.1" xref="S4.SS2.SSS2.p6.4.m4.1.1.cmml"><mi id="S4.SS2.SSS2.p6.4.m4.1.1.2" xref="S4.SS2.SSS2.p6.4.m4.1.1.2.cmml">F</mi><mo id="S4.SS2.SSS2.p6.4.m4.1.1.1" xref="S4.SS2.SSS2.p6.4.m4.1.1.1.cmml">⁢</mo><msub id="S4.SS2.SSS2.p6.4.m4.1.1.3" xref="S4.SS2.SSS2.p6.4.m4.1.1.3.cmml"><mn id="S4.SS2.SSS2.p6.4.m4.1.1.3.2" xref="S4.SS2.SSS2.p6.4.m4.1.1.3.2.cmml">1</mn><mi id="S4.SS2.SSS2.p6.4.m4.1.1.3.3" xref="S4.SS2.SSS2.p6.4.m4.1.1.3.3.cmml">k</mi></msub></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.SSS2.p6.4.m4.1b"><apply id="S4.SS2.SSS2.p6.4.m4.1.1.cmml" xref="S4.SS2.SSS2.p6.4.m4.1.1"><times id="S4.SS2.SSS2.p6.4.m4.1.1.1.cmml" xref="S4.SS2.SSS2.p6.4.m4.1.1.1"></times><ci id="S4.SS2.SSS2.p6.4.m4.1.1.2.cmml" xref="S4.SS2.SSS2.p6.4.m4.1.1.2">𝐹</ci><apply id="S4.SS2.SSS2.p6.4.m4.1.1.3.cmml" xref="S4.SS2.SSS2.p6.4.m4.1.1.3"><csymbol cd="ambiguous" id="S4.SS2.SSS2.p6.4.m4.1.1.3.1.cmml" xref="S4.SS2.SSS2.p6.4.m4.1.1.3">subscript</csymbol><cn id="S4.SS2.SSS2.p6.4.m4.1.1.3.2.cmml" type="integer" xref="S4.SS2.SSS2.p6.4.m4.1.1.3.2">1</cn><ci id="S4.SS2.SSS2.p6.4.m4.1.1.3.3.cmml" xref="S4.SS2.SSS2.p6.4.m4.1.1.3.3">𝑘</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.SSS2.p6.4.m4.1c">{F1}_{k}</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.SSS2.p6.4.m4.1d">italic_F 1 start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT</annotation></semantics></math> is the <math alttext="F1" class="ltx_Math" display="inline" id="S4.SS2.SSS2.p6.5.m5.1"><semantics id="S4.SS2.SSS2.p6.5.m5.1a"><mrow id="S4.SS2.SSS2.p6.5.m5.1.1" xref="S4.SS2.SSS2.p6.5.m5.1.1.cmml"><mi id="S4.SS2.SSS2.p6.5.m5.1.1.2" xref="S4.SS2.SSS2.p6.5.m5.1.1.2.cmml">F</mi><mo id="S4.SS2.SSS2.p6.5.m5.1.1.1" xref="S4.SS2.SSS2.p6.5.m5.1.1.1.cmml">⁢</mo><mn id="S4.SS2.SSS2.p6.5.m5.1.1.3" xref="S4.SS2.SSS2.p6.5.m5.1.1.3.cmml">1</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.SSS2.p6.5.m5.1b"><apply id="S4.SS2.SSS2.p6.5.m5.1.1.cmml" xref="S4.SS2.SSS2.p6.5.m5.1.1"><times id="S4.SS2.SSS2.p6.5.m5.1.1.1.cmml" xref="S4.SS2.SSS2.p6.5.m5.1.1.1"></times><ci id="S4.SS2.SSS2.p6.5.m5.1.1.2.cmml" xref="S4.SS2.SSS2.p6.5.m5.1.1.2">𝐹</ci><cn id="S4.SS2.SSS2.p6.5.m5.1.1.3.cmml" type="integer" xref="S4.SS2.SSS2.p6.5.m5.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.SSS2.p6.5.m5.1c">F1</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.SSS2.p6.5.m5.1d">italic_F 1</annotation></semantics></math> score for class <math alttext="k" class="ltx_Math" display="inline" id="S4.SS2.SSS2.p6.6.m6.1"><semantics id="S4.SS2.SSS2.p6.6.m6.1a"><mi id="S4.SS2.SSS2.p6.6.m6.1.1" xref="S4.SS2.SSS2.p6.6.m6.1.1.cmml">k</mi><annotation-xml encoding="MathML-Content" id="S4.SS2.SSS2.p6.6.m6.1b"><ci id="S4.SS2.SSS2.p6.6.m6.1.1.cmml" xref="S4.SS2.SSS2.p6.6.m6.1.1">𝑘</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.SSS2.p6.6.m6.1c">k</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.SSS2.p6.6.m6.1d">italic_k</annotation></semantics></math>.</p>
</div>
<div class="ltx_para" id="S4.SS2.SSS2.p7">
<p class="ltx_p" id="S4.SS2.SSS2.p7.1">As for subjective evaluation, we will introduce the subjective evaluation settings and metrics specifically in Sections <a class="ltx_ref" href="https://arxiv.org/html/2409.14878v1#S4.SS5.SSS1" title="4.5.1. Clinical Psychiatrist Evaluation ‣ 4.5. Evaluation of Report Quality ‣ 4. Experimental Results and Analysis ‣ InterMind: A Doctor-Patient-Family Interactive Depression Assessment System Empowered by Large Language Models"><span class="ltx_text ltx_ref_tag">4.5.1</span></a> and <a class="ltx_ref" href="https://arxiv.org/html/2409.14878v1#S4.SS6" title="4.6. Psychological Counseling Competency Evaluation ‣ 4. Experimental Results and Analysis ‣ InterMind: A Doctor-Patient-Family Interactive Depression Assessment System Empowered by Large Language Models"><span class="ltx_text ltx_ref_tag">4.6</span></a>.</p>
</div>
<figure class="ltx_table" id="S4.T2">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_table">Table 2. </span>Depression Binary Classification Results</figcaption><div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_1">
<div class="ltx_inline-block ltx_figure_panel ltx_align_center ltx_transformed_outer" id="S4.T2.1" style="width:390.3pt;height:78.1pt;vertical-align:-0.0pt;"><span class="ltx_transformed_inner" style="transform:translate(-164.5pt,32.9pt) scale(0.542522542110513,0.542522542110513) ;">
<table class="ltx_tabular ltx_guessed_headers ltx_align_middle" id="S4.T2.1.1">
<thead class="ltx_thead">
<tr class="ltx_tr" id="S4.T2.1.1.1.1">
<th class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_th_row ltx_border_tt" id="S4.T2.1.1.1.1.1"><span class="ltx_text ltx_font_bold" id="S4.T2.1.1.1.1.1.1">Dataset</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" colspan="4" id="S4.T2.1.1.1.1.2"><span class="ltx_text ltx_font_bold" id="S4.T2.1.1.1.1.2.1">MMDA</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" colspan="4" id="S4.T2.1.1.1.1.3"><span class="ltx_text ltx_font_bold" id="S4.T2.1.1.1.1.3.1">DR</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" colspan="4" id="S4.T2.1.1.1.1.4"><span class="ltx_text ltx_font_bold" id="S4.T2.1.1.1.1.4.1">DepSeverity</span></th>
</tr>
<tr class="ltx_tr" id="S4.T2.1.1.2.2">
<th class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_th_row ltx_border_t" id="S4.T2.1.1.2.2.1">Model</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" id="S4.T2.1.1.2.2.2">ACC</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" id="S4.T2.1.1.2.2.3">PRE</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" id="S4.T2.1.1.2.2.4">REC</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" id="S4.T2.1.1.2.2.5">F1</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" id="S4.T2.1.1.2.2.6">ACC</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" id="S4.T2.1.1.2.2.7">PRE</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" id="S4.T2.1.1.2.2.8">REC</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" id="S4.T2.1.1.2.2.9">F1</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" id="S4.T2.1.1.2.2.10">ACC</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" id="S4.T2.1.1.2.2.11">PRE</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" id="S4.T2.1.1.2.2.12">REC</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" id="S4.T2.1.1.2.2.13">F1</th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr class="ltx_tr" id="S4.T2.1.1.3.1">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t" id="S4.T2.1.1.3.1.1">Chatglm3-6b<cite class="ltx_cite ltx_citemacro_citep">(GLM et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2409.14878v1#bib.bib8" title="">2024</a>)</cite>
</th>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T2.1.1.3.1.2">0.551</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T2.1.1.3.1.3">0.857</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T2.1.1.3.1.4">0.375</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T2.1.1.3.1.5">0.522</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T2.1.1.3.1.6">0.693</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T2.1.1.3.1.7">0.929</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T2.1.1.3.1.8">0.644</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T2.1.1.3.1.9">0.761</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T2.1.1.3.1.10">0.611</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T2.1.1.3.1.11">0.609</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T2.1.1.3.1.12">0.189</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T2.1.1.3.1.13">0.289</td>
</tr>
<tr class="ltx_tr" id="S4.T2.1.1.4.2">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="S4.T2.1.1.4.2.1">Llama2-Chinese-7b<cite class="ltx_cite ltx_citemacro_citep">(Touvron et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2409.14878v1#bib.bib36" title="">2023</a>)</cite>
</th>
<td class="ltx_td ltx_align_center" id="S4.T2.1.1.4.2.2">0.571</td>
<td class="ltx_td ltx_align_center" id="S4.T2.1.1.4.2.3">0.789</td>
<td class="ltx_td ltx_align_center" id="S4.T2.1.1.4.2.4">0.469</td>
<td class="ltx_td ltx_align_center" id="S4.T2.1.1.4.2.5">0.588</td>
<td class="ltx_td ltx_align_center" id="S4.T2.1.1.4.2.6">0.575</td>
<td class="ltx_td ltx_align_center" id="S4.T2.1.1.4.2.7">0.861</td>
<td class="ltx_td ltx_align_center" id="S4.T2.1.1.4.2.8">0.524</td>
<td class="ltx_td ltx_align_center" id="S4.T2.1.1.4.2.9">0.652</td>
<td class="ltx_td ltx_align_center" id="S4.T2.1.1.4.2.10">0.592</td>
<td class="ltx_td ltx_align_center" id="S4.T2.1.1.4.2.11">0.513</td>
<td class="ltx_td ltx_align_center" id="S4.T2.1.1.4.2.12">0.405</td>
<td class="ltx_td ltx_align_center" id="S4.T2.1.1.4.2.13">0.453</td>
</tr>
<tr class="ltx_tr" id="S4.T2.1.1.5.3">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="S4.T2.1.1.5.3.1">Baichuan2-7b<cite class="ltx_cite ltx_citemacro_citep">(Yang et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2409.14878v1#bib.bib43" title="">2023</a>)</cite>
</th>
<td class="ltx_td ltx_align_center" id="S4.T2.1.1.5.3.2">0.551</td>
<td class="ltx_td ltx_align_center" id="S4.T2.1.1.5.3.3">0.625</td>
<td class="ltx_td ltx_align_center" id="S4.T2.1.1.5.3.4"><span class="ltx_text ltx_font_bold" id="S4.T2.1.1.5.3.4.1">0.781</span></td>
<td class="ltx_td ltx_align_center" id="S4.T2.1.1.5.3.5">0.694</td>
<td class="ltx_td ltx_align_center" id="S4.T2.1.1.5.3.6">0.716</td>
<td class="ltx_td ltx_align_center" id="S4.T2.1.1.5.3.7">0.770</td>
<td class="ltx_td ltx_align_center" id="S4.T2.1.1.5.3.8"><span class="ltx_text ltx_framed ltx_framed_underline" id="S4.T2.1.1.5.3.8.1">0.893</span></td>
<td class="ltx_td ltx_align_center" id="S4.T2.1.1.5.3.9">0.827</td>
<td class="ltx_td ltx_align_center" id="S4.T2.1.1.5.3.10">0.425</td>
<td class="ltx_td ltx_align_center" id="S4.T2.1.1.5.3.11">0.415</td>
<td class="ltx_td ltx_align_center" id="S4.T2.1.1.5.3.12"><span class="ltx_text ltx_font_bold" id="S4.T2.1.1.5.3.12.1">0.919</span></td>
<td class="ltx_td ltx_align_center" id="S4.T2.1.1.5.3.13">0.571</td>
</tr>
<tr class="ltx_tr" id="S4.T2.1.1.6.4">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="S4.T2.1.1.6.4.1">ChineseMentalBert<cite class="ltx_cite ltx_citemacro_citep">(Ji et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2409.14878v1#bib.bib14" title="">2022</a>)</cite>
</th>
<td class="ltx_td ltx_align_center" id="S4.T2.1.1.6.4.2"><span class="ltx_text ltx_framed ltx_framed_underline" id="S4.T2.1.1.6.4.2.1">0.698</span></td>
<td class="ltx_td ltx_align_center" id="S4.T2.1.1.6.4.3">0.750</td>
<td class="ltx_td ltx_align_center" id="S4.T2.1.1.6.4.4"><span class="ltx_text ltx_framed ltx_framed_underline" id="S4.T2.1.1.6.4.4.1">0.750</span></td>
<td class="ltx_td ltx_align_center" id="S4.T2.1.1.6.4.5"><span class="ltx_text ltx_framed ltx_framed_underline" id="S4.T2.1.1.6.4.5.1">0.750</span></td>
<td class="ltx_td ltx_align_center" id="S4.T2.1.1.6.4.6"><span class="ltx_text ltx_framed ltx_framed_underline" id="S4.T2.1.1.6.4.6.1">0.814</span></td>
<td class="ltx_td ltx_align_center" id="S4.T2.1.1.6.4.7">0.860</td>
<td class="ltx_td ltx_align_center" id="S4.T2.1.1.6.4.8"><span class="ltx_text ltx_font_bold" id="S4.T2.1.1.6.4.8.1">0.899</span></td>
<td class="ltx_td ltx_align_center" id="S4.T2.1.1.6.4.9"><span class="ltx_text ltx_framed ltx_framed_underline" id="S4.T2.1.1.6.4.9.1">0.879</span></td>
<td class="ltx_td ltx_align_center" id="S4.T2.1.1.6.4.10"><span class="ltx_text ltx_framed ltx_framed_underline" id="S4.T2.1.1.6.4.10.1">0.702</span></td>
<td class="ltx_td ltx_align_center" id="S4.T2.1.1.6.4.11"><span class="ltx_text ltx_framed ltx_framed_underline" id="S4.T2.1.1.6.4.11.1">0.688</span></td>
<td class="ltx_td ltx_align_center" id="S4.T2.1.1.6.4.12"><span class="ltx_text ltx_framed ltx_framed_underline" id="S4.T2.1.1.6.4.12.1">0.507</span></td>
<td class="ltx_td ltx_align_center" id="S4.T2.1.1.6.4.13"><span class="ltx_text ltx_framed ltx_framed_underline" id="S4.T2.1.1.6.4.13.1">0.584</span></td>
</tr>
<tr class="ltx_tr" id="S4.T2.1.1.7.5">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="S4.T2.1.1.7.5.1">GPT-4 <cite class="ltx_cite ltx_citemacro_citep">(Achiam et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2409.14878v1#bib.bib2" title="">2023</a>)</cite>
</th>
<td class="ltx_td ltx_align_center" id="S4.T2.1.1.7.5.2">0.592</td>
<td class="ltx_td ltx_align_center" id="S4.T2.1.1.7.5.3"><span class="ltx_text ltx_framed ltx_framed_underline" id="S4.T2.1.1.7.5.3.1">0.875</span></td>
<td class="ltx_td ltx_align_center" id="S4.T2.1.1.7.5.4">0.438</td>
<td class="ltx_td ltx_align_center" id="S4.T2.1.1.7.5.5">0.583</td>
<td class="ltx_td ltx_align_center" id="S4.T2.1.1.7.5.6">0.773</td>
<td class="ltx_td ltx_align_center" id="S4.T2.1.1.7.5.7"><span class="ltx_text ltx_font_bold" id="S4.T2.1.1.7.5.7.1">0.972</span></td>
<td class="ltx_td ltx_align_center" id="S4.T2.1.1.7.5.8">0.724</td>
<td class="ltx_td ltx_align_center" id="S4.T2.1.1.7.5.9">0.830</td>
<td class="ltx_td ltx_align_center" id="S4.T2.1.1.7.5.10">0.648</td>
<td class="ltx_td ltx_align_center" id="S4.T2.1.1.7.5.11">0.683</td>
<td class="ltx_td ltx_align_center" id="S4.T2.1.1.7.5.12">0.283</td>
<td class="ltx_td ltx_align_center" id="S4.T2.1.1.7.5.13">0.400</td>
</tr>
<tr class="ltx_tr" id="S4.T2.1.1.8.6">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_bb" id="S4.T2.1.1.8.6.1">Ours</th>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S4.T2.1.1.8.6.2"><span class="ltx_text ltx_font_bold" id="S4.T2.1.1.8.6.2.1">0.735</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S4.T2.1.1.8.6.3"><span class="ltx_text ltx_font_bold" id="S4.T2.1.1.8.6.3.1">0.880</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S4.T2.1.1.8.6.4">0.688</td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S4.T2.1.1.8.6.5"><span class="ltx_text ltx_font_bold" id="S4.T2.1.1.8.6.5.1">0.772</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S4.T2.1.1.8.6.6"><span class="ltx_text ltx_font_bold" id="S4.T2.1.1.8.6.6.1">0.840</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S4.T2.1.1.8.6.7"><span class="ltx_text ltx_framed ltx_framed_underline" id="S4.T2.1.1.8.6.7.1">0.929</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S4.T2.1.1.8.6.8">0.853</td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S4.T2.1.1.8.6.9"><span class="ltx_text ltx_font_bold" id="S4.T2.1.1.8.6.9.1">0.890</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S4.T2.1.1.8.6.10"><span class="ltx_text ltx_font_bold" id="S4.T2.1.1.8.6.10.1">0.709</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S4.T2.1.1.8.6.11"><span class="ltx_text ltx_font_bold" id="S4.T2.1.1.8.6.11.1">0.712</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S4.T2.1.1.8.6.12">0.503</td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S4.T2.1.1.8.6.13"><span class="ltx_text ltx_font_bold" id="S4.T2.1.1.8.6.13.1">0.590</span></td>
</tr>
</tbody>
</table>
</span></div>
</div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_1">
<ul class="ltx_itemize ltx_centering ltx_figure_panel" id="S4.I1">
<li class="ltx_item" id="S4.I1.ix1" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">1</span>
<div class="ltx_para" id="S4.I1.ix1.p1">
<p class="ltx_p" id="S4.I1.ix1.p1.1"><span class="ltx_text" id="S4.I1.ix1.p1.1.1" style="font-size:80%;">The bold font and underlined font indicate the best and second-best results, respectively.</span></p>
</div>
</li>
</ul>
</div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_1"><span class="ltx_ERROR ltx_centering ltx_figure_panel undefined" id="S4.T2.2">\Description</span></div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_1">
<p class="ltx_p ltx_figure_panel ltx_align_center" id="S4.T2.3">This table presents a comparison between the binary classification results from the assistive diagnostic report generated by our proposed AI Psychologist and those from five other representative models. Our method achieves the best F1 scores across all three datasets.</p>
</div>
</div>
</figure>
</section>
</section>
<section class="ltx_subsection" id="S4.SS3">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.3. </span>Comparison of Depression Binary Classification Results</h3>
<div class="ltx_para" id="S4.SS3.p1">
<p class="ltx_p" id="S4.SS3.p1.1">As shown in Table <a class="ltx_ref" href="https://arxiv.org/html/2409.14878v1#S4.T2" title="Table 2 ‣ 4.2.2. Evaluation Metrics ‣ 4.2. Experimental Setup and Evaluation Metrics ‣ 4. Experimental Results and Analysis ‣ InterMind: A Doctor-Patient-Family Interactive Depression Assessment System Empowered by Large Language Models"><span class="ltx_text ltx_ref_tag">2</span></a>, we compare the binary classification results of assistive diagnostic reports generated by the proposed AI Psychologist with those of five representative models showing strong ability in Chinese. We implemented the binary classification task on these five models in the three datasets. We instructed ChatGLM3-6B <cite class="ltx_cite ltx_citemacro_citep">(GLM et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2409.14878v1#bib.bib8" title="">2024</a>)</cite>, Llama2-Chinese-7B <span class="ltx_note ltx_role_footnote" id="footnote2"><sup class="ltx_note_mark">2</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">2</sup><span class="ltx_tag ltx_tag_note">2</span><a class="ltx_ref ltx_href" href="https://github.com/LlamaFamily/Llama-Chinese" title="">https://github.com/LlamaFamily/Llama-Chinese</a></span></span></span><cite class="ltx_cite ltx_citemacro_citep">(Touvron et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2409.14878v1#bib.bib36" title="">2023</a>)</cite>, and Baichuan2-7B <cite class="ltx_cite ltx_citemacro_citep">(Yang et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2409.14878v1#bib.bib43" title="">2023</a>)</cite> to provide only the classification result, determining whether the user in the dialogue is depressed. GPT-4 can generate assistive diagnostic reports consistent with our report generation task through a format-controlling function. ChineseMentalBert <span class="ltx_note ltx_role_footnote" id="footnote3"><sup class="ltx_note_mark">3</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">3</sup><span class="ltx_tag ltx_tag_note">3</span><a class="ltx_ref ltx_href" href="https://github.com/zwzzzQAQ/Chinese-MentalBERT" title="">https://github.com/zwzzzQAQ/Chinese-MentalBERT</a></span></span></span><cite class="ltx_cite ltx_citemacro_citep">(Ji et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2409.14878v1#bib.bib14" title="">2022</a>)</cite> is a supervised model known for its strong performance in Chinese mental health tasks, so we fine-tuned and tested it on our dataset to obtain results.</p>
</div>
<div class="ltx_para" id="S4.SS3.p2">
<p class="ltx_p" id="S4.SS3.p2.1">From Table <a class="ltx_ref" href="https://arxiv.org/html/2409.14878v1#S4.T2" title="Table 2 ‣ 4.2.2. Evaluation Metrics ‣ 4.2. Experimental Setup and Evaluation Metrics ‣ 4. Experimental Results and Analysis ‣ InterMind: A Doctor-Patient-Family Interactive Depression Assessment System Empowered by Large Language Models"><span class="ltx_text ltx_ref_tag">2</span></a>, we can see that the depression binary classification performance of our model is improved significantly compared to Baichuan2-7b across three datasets (F1 0.772 vs. 0.694 on the MMDA dataset, F1 0.890 vs. 0.827 on the DR dataset, and F1 0.590 vs. 0.571 on the DepSeverity dataset), resulting in 11.24%, 7.62%, and 3.33% improvements, respectively. This validates that our fine-tuning task can effectively improve the F1-score of the backbone model in depression binary classification within our generated report.
Compared to ChatGLM3-6B and Llama2-Chinese-7B, our method stands out with significantly better performance. GPT-4 does not perform well in the depression binary classification task. The reason is that GPT-4 tends to be conservative in diagnosing depression, avoiding predicting a subject as depressed without strong evidence. This results in relatively high PRE but low REC, ultimately leading to lower F1 scores.
Supervised models like ChineseMentalBert perform notably well in depression binary classification, achieving the second-best results in many cases. However, supervised models are limited by the need to model specific tasks, and their predictions often lack interpretability.
Our method, by generating assistive diagnostic reports, not only achieves the best binary classification results but also provides additional information such as symptoms and diagnostic criteria (see examples of generated assistive diagnostic reports in Appendix <a class="ltx_ref" href="https://arxiv.org/html/2409.14878v1#A1" title="Appendix A Appendix ‣ InterMind: A Doctor-Patient-Family Interactive Depression Assessment System Empowered by Large Language Models"><span class="ltx_text ltx_ref_tag">A</span></a>)
, offering doctors more than just a conclusion for their final diagnosis.</p>
</div>
</section>
<section class="ltx_subsection" id="S4.SS4">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.4. </span>Comparison of Severity Degree Estimation Results</h3>
<figure class="ltx_table" id="S4.T3">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_table">Table 3. </span>Depression Severity Degree Estimation Results on MMDA dataset</figcaption><div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_1">
<div class="ltx_inline-block ltx_figure_panel ltx_align_center ltx_transformed_outer" id="S4.T3.1" style="width:433.6pt;height:100.9pt;vertical-align:-0.0pt;"><span class="ltx_transformed_inner" style="transform:translate(-92.7pt,21.6pt) scale(0.700547089329804,0.700547089329804) ;">
<table class="ltx_tabular ltx_guessed_headers ltx_align_middle" id="S4.T3.1.1">
<thead class="ltx_thead">
<tr class="ltx_tr" id="S4.T3.1.1.1.1">
<th class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_th_row ltx_border_r ltx_border_t" id="S4.T3.1.1.1.1.1"><span class="ltx_text ltx_font_bold" id="S4.T3.1.1.1.1.1.1">Severity Degree</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_r ltx_border_t" colspan="3" id="S4.T3.1.1.1.1.2"><span class="ltx_text ltx_font_bold" id="S4.T3.1.1.1.1.2.1">Normal</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_r ltx_border_t" colspan="3" id="S4.T3.1.1.1.1.3"><span class="ltx_text ltx_font_bold" id="S4.T3.1.1.1.1.3.1">Mild</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_r ltx_border_t" colspan="3" id="S4.T3.1.1.1.1.4"><span class="ltx_text ltx_font_bold" id="S4.T3.1.1.1.1.4.1">Moderate</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_r ltx_border_t" colspan="3" id="S4.T3.1.1.1.1.5"><span class="ltx_text ltx_font_bold" id="S4.T3.1.1.1.1.5.1">Severe</span></th>
<th class="ltx_td ltx_th ltx_th_column ltx_border_t" id="S4.T3.1.1.1.1.6"></th>
<th class="ltx_td ltx_th ltx_th_column ltx_border_t" id="S4.T3.1.1.1.1.7"></th>
</tr>
<tr class="ltx_tr" id="S4.T3.1.1.2.2">
<th class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_th_row ltx_border_r ltx_border_t" id="S4.T3.1.1.2.2.1">Model</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" id="S4.T3.1.1.2.2.2">PRE</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" id="S4.T3.1.1.2.2.3">REC</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_r ltx_border_t" id="S4.T3.1.1.2.2.4">F1</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" id="S4.T3.1.1.2.2.5">PRE</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" id="S4.T3.1.1.2.2.6">REC</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_r ltx_border_t" id="S4.T3.1.1.2.2.7">F1</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" id="S4.T3.1.1.2.2.8">PRE</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" id="S4.T3.1.1.2.2.9">REC</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_r ltx_border_t" id="S4.T3.1.1.2.2.10">F1</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" id="S4.T3.1.1.2.2.11">PRE</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" id="S4.T3.1.1.2.2.12">REC</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_r ltx_border_t" id="S4.T3.1.1.2.2.13">F1</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" id="S4.T3.1.1.2.2.14">ACC</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" id="S4.T3.1.1.2.2.15">Weighted-F1</th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr class="ltx_tr" id="S4.T3.1.1.3.1">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r ltx_border_t" id="S4.T3.1.1.3.1.1">Chatglm3-6b</th>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T3.1.1.3.1.2">0.395</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T3.1.1.3.1.3"><span class="ltx_text ltx_framed ltx_framed_underline" id="S4.T3.1.1.3.1.3.1">0.882</span></td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S4.T3.1.1.3.1.4">0.545</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T3.1.1.3.1.5"><span class="ltx_text ltx_framed ltx_framed_underline" id="S4.T3.1.1.3.1.5.1">0.800</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T3.1.1.3.1.6">0.148</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S4.T3.1.1.3.1.7">0.250</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T3.1.1.3.1.8">0.333</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T3.1.1.3.1.9"><span class="ltx_text ltx_framed ltx_framed_underline" id="S4.T3.1.1.3.1.9.1">0.500</span></td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S4.T3.1.1.3.1.10"><span class="ltx_text ltx_framed ltx_framed_underline" id="S4.T3.1.1.3.1.10.1">0.400</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T3.1.1.3.1.11">0.000</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T3.1.1.3.1.12">0.000</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S4.T3.1.1.3.1.13">0.000</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T3.1.1.3.1.14">0.429</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T3.1.1.3.1.15">0.360</td>
</tr>
<tr class="ltx_tr" id="S4.T3.1.1.4.2">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r" id="S4.T3.1.1.4.2.1">Llama2-Chinese-7b</th>
<td class="ltx_td ltx_align_center" id="S4.T3.1.1.4.2.2">0.354</td>
<td class="ltx_td ltx_align_center" id="S4.T3.1.1.4.2.3"><span class="ltx_text ltx_font_bold" id="S4.T3.1.1.4.2.3.1">1.000</span></td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T3.1.1.4.2.4">0.523</td>
<td class="ltx_td ltx_align_center" id="S4.T3.1.1.4.2.5">0.000</td>
<td class="ltx_td ltx_align_center" id="S4.T3.1.1.4.2.6">0.000</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T3.1.1.4.2.7">0.000</td>
<td class="ltx_td ltx_align_center" id="S4.T3.1.1.4.2.8"><span class="ltx_text ltx_font_bold" id="S4.T3.1.1.4.2.8.1">1.000</span></td>
<td class="ltx_td ltx_align_center" id="S4.T3.1.1.4.2.9">0.250</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T3.1.1.4.2.10"><span class="ltx_text ltx_framed ltx_framed_underline" id="S4.T3.1.1.4.2.10.1">0.400</span></td>
<td class="ltx_td ltx_align_center" id="S4.T3.1.1.4.2.11">0.000</td>
<td class="ltx_td ltx_align_center" id="S4.T3.1.1.4.2.12">0.000</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T3.1.1.4.2.13">0.000</td>
<td class="ltx_td ltx_align_center" id="S4.T3.1.1.4.2.14">0.367</td>
<td class="ltx_td ltx_align_center" id="S4.T3.1.1.4.2.15">0.214</td>
</tr>
<tr class="ltx_tr" id="S4.T3.1.1.5.3">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r" id="S4.T3.1.1.5.3.1">Baichuan2-7b</th>
<td class="ltx_td ltx_align_center" id="S4.T3.1.1.5.3.2">0.400</td>
<td class="ltx_td ltx_align_center" id="S4.T3.1.1.5.3.3">0.824</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T3.1.1.5.3.4">0.538</td>
<td class="ltx_td ltx_align_center" id="S4.T3.1.1.5.3.5"><span class="ltx_text ltx_font_bold" id="S4.T3.1.1.5.3.5.1">1.000</span></td>
<td class="ltx_td ltx_align_center" id="S4.T3.1.1.5.3.6">0.037</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T3.1.1.5.3.7">0.071</td>
<td class="ltx_td ltx_align_center" id="S4.T3.1.1.5.3.8">0.167</td>
<td class="ltx_td ltx_align_center" id="S4.T3.1.1.5.3.9"><span class="ltx_text ltx_framed ltx_framed_underline" id="S4.T3.1.1.5.3.9.1">0.500</span></td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T3.1.1.5.3.10">0.250</td>
<td class="ltx_td ltx_align_center" id="S4.T3.1.1.5.3.11">0.000</td>
<td class="ltx_td ltx_align_center" id="S4.T3.1.1.5.3.12">0.000</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T3.1.1.5.3.13">0.000</td>
<td class="ltx_td ltx_align_center" id="S4.T3.1.1.5.3.14">0.347</td>
<td class="ltx_td ltx_align_center" id="S4.T3.1.1.5.3.15">0.247</td>
</tr>
<tr class="ltx_tr" id="S4.T3.1.1.6.4">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r" id="S4.T3.1.1.6.4.1">ChineseMentalBert</th>
<td class="ltx_td ltx_align_center" id="S4.T3.1.1.6.4.2"><span class="ltx_text ltx_framed ltx_framed_underline" id="S4.T3.1.1.6.4.2.1">0.667</span></td>
<td class="ltx_td ltx_align_center" id="S4.T3.1.1.6.4.3">0.235</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T3.1.1.6.4.4">0.348</td>
<td class="ltx_td ltx_align_center" id="S4.T3.1.1.6.4.5">0.571</td>
<td class="ltx_td ltx_align_center" id="S4.T3.1.1.6.4.6"><span class="ltx_text ltx_font_bold" id="S4.T3.1.1.6.4.6.1">0.889</span></td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T3.1.1.6.4.7"><span class="ltx_text ltx_font_bold" id="S4.T3.1.1.6.4.7.1">0.696</span></td>
<td class="ltx_td ltx_align_center" id="S4.T3.1.1.6.4.8">0.000</td>
<td class="ltx_td ltx_align_center" id="S4.T3.1.1.6.4.9">0.000</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T3.1.1.6.4.10">0.000</td>
<td class="ltx_td ltx_align_center" id="S4.T3.1.1.6.4.11">0.000</td>
<td class="ltx_td ltx_align_center" id="S4.T3.1.1.6.4.12">0.000</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T3.1.1.6.4.13">0.000</td>
<td class="ltx_td ltx_align_center" id="S4.T3.1.1.6.4.14"><span class="ltx_text ltx_framed ltx_framed_underline" id="S4.T3.1.1.6.4.14.1">0.604</span></td>
<td class="ltx_td ltx_align_center" id="S4.T3.1.1.6.4.15">0.504</td>
</tr>
<tr class="ltx_tr" id="S4.T3.1.1.7.5">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r" id="S4.T3.1.1.7.5.1">GPT-4</th>
<td class="ltx_td ltx_align_center" id="S4.T3.1.1.7.5.2"><span class="ltx_text ltx_font_bold" id="S4.T3.1.1.7.5.2.1">0.786</span></td>
<td class="ltx_td ltx_align_center" id="S4.T3.1.1.7.5.3">0.647</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T3.1.1.7.5.4"><span class="ltx_text ltx_font_bold" id="S4.T3.1.1.7.5.4.1">0.710</span></td>
<td class="ltx_td ltx_align_center" id="S4.T3.1.1.7.5.5">0.700</td>
<td class="ltx_td ltx_align_center" id="S4.T3.1.1.7.5.6"><span class="ltx_text ltx_framed ltx_framed_underline" id="S4.T3.1.1.7.5.6.1">0.519</span></td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T3.1.1.7.5.7"><span class="ltx_text ltx_framed ltx_framed_underline" id="S4.T3.1.1.7.5.7.1">0.596</span></td>
<td class="ltx_td ltx_align_center" id="S4.T3.1.1.7.5.8">0.125</td>
<td class="ltx_td ltx_align_center" id="S4.T3.1.1.7.5.9">0.250</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T3.1.1.7.5.10">0.167</td>
<td class="ltx_td ltx_align_center" id="S4.T3.1.1.7.5.11"><span class="ltx_text ltx_framed ltx_framed_underline" id="S4.T3.1.1.7.5.11.1">0.143</span></td>
<td class="ltx_td ltx_align_center" id="S4.T3.1.1.7.5.12"><span class="ltx_text ltx_font_bold" id="S4.T3.1.1.7.5.12.1">1.000</span></td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T3.1.1.7.5.13"><span class="ltx_text ltx_framed ltx_framed_underline" id="S4.T3.1.1.7.5.13.1">0.250</span></td>
<td class="ltx_td ltx_align_center" id="S4.T3.1.1.7.5.14">0.551</td>
<td class="ltx_td ltx_align_center" id="S4.T3.1.1.7.5.15"><span class="ltx_text ltx_framed ltx_framed_underline" id="S4.T3.1.1.7.5.15.1">0.593</span></td>
</tr>
<tr class="ltx_tr" id="S4.T3.1.1.8.6">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_b ltx_border_r" id="S4.T3.1.1.8.6.1">Ours</th>
<td class="ltx_td ltx_align_center ltx_border_b" id="S4.T3.1.1.8.6.2">0.560</td>
<td class="ltx_td ltx_align_center ltx_border_b" id="S4.T3.1.1.8.6.3">0.824</td>
<td class="ltx_td ltx_align_center ltx_border_b ltx_border_r" id="S4.T3.1.1.8.6.4"><span class="ltx_text ltx_framed ltx_framed_underline" id="S4.T3.1.1.8.6.4.1">0.667</span></td>
<td class="ltx_td ltx_align_center ltx_border_b" id="S4.T3.1.1.8.6.5"><span class="ltx_text ltx_framed ltx_framed_underline" id="S4.T3.1.1.8.6.5.1">0.800</span></td>
<td class="ltx_td ltx_align_center ltx_border_b" id="S4.T3.1.1.8.6.6">0.444</td>
<td class="ltx_td ltx_align_center ltx_border_b ltx_border_r" id="S4.T3.1.1.8.6.7">0.571</td>
<td class="ltx_td ltx_align_center ltx_border_b" id="S4.T3.1.1.8.6.8"><span class="ltx_text ltx_framed ltx_framed_underline" id="S4.T3.1.1.8.6.8.1">0.571</span></td>
<td class="ltx_td ltx_align_center ltx_border_b" id="S4.T3.1.1.8.6.9"><span class="ltx_text ltx_font_bold" id="S4.T3.1.1.8.6.9.1">1.000</span></td>
<td class="ltx_td ltx_align_center ltx_border_b ltx_border_r" id="S4.T3.1.1.8.6.10"><span class="ltx_text ltx_font_bold" id="S4.T3.1.1.8.6.10.1">0.727</span></td>
<td class="ltx_td ltx_align_center ltx_border_b" id="S4.T3.1.1.8.6.11"><span class="ltx_text ltx_font_bold" id="S4.T3.1.1.8.6.11.1">0.500</span></td>
<td class="ltx_td ltx_align_center ltx_border_b" id="S4.T3.1.1.8.6.12"><span class="ltx_text ltx_font_bold" id="S4.T3.1.1.8.6.12.1">1.000</span></td>
<td class="ltx_td ltx_align_center ltx_border_b ltx_border_r" id="S4.T3.1.1.8.6.13"><span class="ltx_text ltx_font_bold" id="S4.T3.1.1.8.6.13.1">0.667</span></td>
<td class="ltx_td ltx_align_center ltx_border_b" id="S4.T3.1.1.8.6.14"><span class="ltx_text ltx_font_bold" id="S4.T3.1.1.8.6.14.1">0.633</span></td>
<td class="ltx_td ltx_align_center ltx_border_b" id="S4.T3.1.1.8.6.15"><span class="ltx_text ltx_font_bold" id="S4.T3.1.1.8.6.15.1">0.619</span></td>
</tr>
</tbody>
</table>
</span></div>
</div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_1"><span class="ltx_ERROR ltx_centering ltx_figure_panel undefined" id="S4.T3.2">\Description</span></div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_1">
<p class="ltx_p ltx_figure_panel ltx_align_center" id="S4.T3.3">This table presents a comparison between the depression degree estimation results from the assistive diagnostic report generated by our proposed AI Psychologist and those from five other representative models on the MMDA dataset. Our method achieves the best ACC and Weighted-F1 scores.</p>
</div>
</div>
</figure>
<figure class="ltx_table" id="S4.T4">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_table">Table 4. </span>Depression Severity Degree Estimation Results on DepSeverity dataset</figcaption><div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_1">
<div class="ltx_inline-block ltx_figure_panel ltx_align_center ltx_transformed_outer" id="S4.T4.1" style="width:433.6pt;height:100.9pt;vertical-align:-0.0pt;"><span class="ltx_transformed_inner" style="transform:translate(-92.7pt,21.6pt) scale(0.700547089329804,0.700547089329804) ;">
<table class="ltx_tabular ltx_guessed_headers ltx_align_middle" id="S4.T4.1.1">
<thead class="ltx_thead">
<tr class="ltx_tr" id="S4.T4.1.1.1.1">
<th class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_th_row ltx_border_r ltx_border_t" id="S4.T4.1.1.1.1.1"><span class="ltx_text ltx_font_bold" id="S4.T4.1.1.1.1.1.1">Severity Degree</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_r ltx_border_t" colspan="3" id="S4.T4.1.1.1.1.2"><span class="ltx_text ltx_font_bold" id="S4.T4.1.1.1.1.2.1">Normal</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_r ltx_border_t" colspan="3" id="S4.T4.1.1.1.1.3"><span class="ltx_text ltx_font_bold" id="S4.T4.1.1.1.1.3.1">Mild</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_r ltx_border_t" colspan="3" id="S4.T4.1.1.1.1.4"><span class="ltx_text ltx_font_bold" id="S4.T4.1.1.1.1.4.1">Moderate</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_r ltx_border_t" colspan="3" id="S4.T4.1.1.1.1.5"><span class="ltx_text ltx_font_bold" id="S4.T4.1.1.1.1.5.1">Severe</span></th>
<th class="ltx_td ltx_th ltx_th_column ltx_border_t" id="S4.T4.1.1.1.1.6"></th>
<th class="ltx_td ltx_th ltx_th_column ltx_border_t" id="S4.T4.1.1.1.1.7"></th>
</tr>
<tr class="ltx_tr" id="S4.T4.1.1.2.2">
<th class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_th_row ltx_border_r ltx_border_t" id="S4.T4.1.1.2.2.1">Model</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" id="S4.T4.1.1.2.2.2">PRE</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" id="S4.T4.1.1.2.2.3">REC</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_r ltx_border_t" id="S4.T4.1.1.2.2.4">F1</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" id="S4.T4.1.1.2.2.5">PRE</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" id="S4.T4.1.1.2.2.6">REC</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_r ltx_border_t" id="S4.T4.1.1.2.2.7">F1</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" id="S4.T4.1.1.2.2.8">PRE</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" id="S4.T4.1.1.2.2.9">REC</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_r ltx_border_t" id="S4.T4.1.1.2.2.10">F1</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" id="S4.T4.1.1.2.2.11">PRE</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" id="S4.T4.1.1.2.2.12">REC</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_r ltx_border_t" id="S4.T4.1.1.2.2.13">F1</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" id="S4.T4.1.1.2.2.14">ACC</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" id="S4.T4.1.1.2.2.15">Weighted-F1</th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr class="ltx_tr" id="S4.T4.1.1.3.1">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r ltx_border_t" id="S4.T4.1.1.3.1.1">Chatglm3-6b</th>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T4.1.1.3.1.2">0.611</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T4.1.1.3.1.3">0.850</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S4.T4.1.1.3.1.4">0.711</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T4.1.1.3.1.5">0.195</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T4.1.1.3.1.6">0.131</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S4.T4.1.1.3.1.7">0.157</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T4.1.1.3.1.8">0.167</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T4.1.1.3.1.9">0.098</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S4.T4.1.1.3.1.10">0.123</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T4.1.1.3.1.11">0.000</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T4.1.1.3.1.12">0.000</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S4.T4.1.1.3.1.13">0.000</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T4.1.1.3.1.14">0.530</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T4.1.1.3.1.15">0.456</td>
</tr>
<tr class="ltx_tr" id="S4.T4.1.1.4.2">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r" id="S4.T4.1.1.4.2.1">Llama2-Chinese-7b</th>
<td class="ltx_td ltx_align_center" id="S4.T4.1.1.4.2.2">0.590</td>
<td class="ltx_td ltx_align_center" id="S4.T4.1.1.4.2.3"><span class="ltx_text ltx_font_bold" id="S4.T4.1.1.4.2.3.1">0.981</span></td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T4.1.1.4.2.4">0.737</td>
<td class="ltx_td ltx_align_center" id="S4.T4.1.1.4.2.5">0.273</td>
<td class="ltx_td ltx_align_center" id="S4.T4.1.1.4.2.6">0.049</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T4.1.1.4.2.7">0.083</td>
<td class="ltx_td ltx_align_center" id="S4.T4.1.1.4.2.8">0.000</td>
<td class="ltx_td ltx_align_center" id="S4.T4.1.1.4.2.9">0.000</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T4.1.1.4.2.10">0.000</td>
<td class="ltx_td ltx_align_center" id="S4.T4.1.1.4.2.11">0.000</td>
<td class="ltx_td ltx_align_center" id="S4.T4.1.1.4.2.12">0.000</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T4.1.1.4.2.13">0.000</td>
<td class="ltx_td ltx_align_center" id="S4.T4.1.1.4.2.14">0.580</td>
<td class="ltx_td ltx_align_center" id="S4.T4.1.1.4.2.15">0.444</td>
</tr>
<tr class="ltx_tr" id="S4.T4.1.1.5.3">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r" id="S4.T4.1.1.5.3.1">Baichuan2-7b</th>
<td class="ltx_td ltx_align_center" id="S4.T4.1.1.5.3.2">0.637</td>
<td class="ltx_td ltx_align_center" id="S4.T4.1.1.5.3.3">0.483</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T4.1.1.5.3.4">0.549</td>
<td class="ltx_td ltx_align_center" id="S4.T4.1.1.5.3.5">0.223</td>
<td class="ltx_td ltx_align_center" id="S4.T4.1.1.5.3.6"><span class="ltx_text ltx_font_bold" id="S4.T4.1.1.5.3.6.1">0.574</span></td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T4.1.1.5.3.7"><span class="ltx_text ltx_font_bold" id="S4.T4.1.1.5.3.7.1">0.321</span></td>
<td class="ltx_td ltx_align_center" id="S4.T4.1.1.5.3.8">0.057</td>
<td class="ltx_td ltx_align_center" id="S4.T4.1.1.5.3.9">0.049</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T4.1.1.5.3.10">0.053</td>
<td class="ltx_td ltx_align_center" id="S4.T4.1.1.5.3.11">0.167</td>
<td class="ltx_td ltx_align_center" id="S4.T4.1.1.5.3.12">0.022</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T4.1.1.5.3.13">0.038</td>
<td class="ltx_td ltx_align_center" id="S4.T4.1.1.5.3.14">0.389</td>
<td class="ltx_td ltx_align_center" id="S4.T4.1.1.5.3.15">0.387</td>
</tr>
<tr class="ltx_tr" id="S4.T4.1.1.6.4">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r" id="S4.T4.1.1.6.4.1">ChineseMentalBert</th>
<td class="ltx_td ltx_align_center" id="S4.T4.1.1.6.4.2"><span class="ltx_text ltx_framed ltx_framed_underline" id="S4.T4.1.1.6.4.2.1">0.685</span></td>
<td class="ltx_td ltx_align_center" id="S4.T4.1.1.6.4.3"><span class="ltx_text ltx_framed ltx_framed_underline" id="S4.T4.1.1.6.4.3.1">0.913</span></td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T4.1.1.6.4.4"><span class="ltx_text ltx_font_bold" id="S4.T4.1.1.6.4.4.1">0.783</span></td>
<td class="ltx_td ltx_align_center" id="S4.T4.1.1.6.4.5"><span class="ltx_text ltx_font_bold" id="S4.T4.1.1.6.4.5.1">0.714</span></td>
<td class="ltx_td ltx_align_center" id="S4.T4.1.1.6.4.6">0.082</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T4.1.1.6.4.7">0.147</td>
<td class="ltx_td ltx_align_center" id="S4.T4.1.1.6.4.8"><span class="ltx_text ltx_framed ltx_framed_underline" id="S4.T4.1.1.6.4.8.1">0.320</span></td>
<td class="ltx_td ltx_align_center" id="S4.T4.1.1.6.4.9"><span class="ltx_text ltx_font_bold" id="S4.T4.1.1.6.4.9.1">0.390</span></td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T4.1.1.6.4.10"><span class="ltx_text ltx_font_bold" id="S4.T4.1.1.6.4.10.1">0.352</span></td>
<td class="ltx_td ltx_align_center" id="S4.T4.1.1.6.4.11"><span class="ltx_text ltx_font_bold" id="S4.T4.1.1.6.4.11.1">0.500</span></td>
<td class="ltx_td ltx_align_center" id="S4.T4.1.1.6.4.12"><span class="ltx_text ltx_font_bold" id="S4.T4.1.1.6.4.12.1">0.239</span></td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T4.1.1.6.4.13"><span class="ltx_text ltx_font_bold" id="S4.T4.1.1.6.4.13.1">0.324</span></td>
<td class="ltx_td ltx_align_center" id="S4.T4.1.1.6.4.14"><span class="ltx_text ltx_font_bold" id="S4.T4.1.1.6.4.14.1">0.627</span></td>
<td class="ltx_td ltx_align_center" id="S4.T4.1.1.6.4.15"><span class="ltx_text ltx_font_bold" id="S4.T4.1.1.6.4.15.1">0.564</span></td>
</tr>
<tr class="ltx_tr" id="S4.T4.1.1.7.5">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r" id="S4.T4.1.1.7.5.1">GPT-4</th>
<td class="ltx_td ltx_align_center" id="S4.T4.1.1.7.5.2"><span class="ltx_text ltx_font_bold" id="S4.T4.1.1.7.5.2.1">0.711</span></td>
<td class="ltx_td ltx_align_center" id="S4.T4.1.1.7.5.3">0.760</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T4.1.1.7.5.4">0.734</td>
<td class="ltx_td ltx_align_center" id="S4.T4.1.1.7.5.5">0.239</td>
<td class="ltx_td ltx_align_center" id="S4.T4.1.1.7.5.6"><span class="ltx_text ltx_framed ltx_framed_underline" id="S4.T4.1.1.7.5.6.1">0.283</span></td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T4.1.1.7.5.7">0.260</td>
<td class="ltx_td ltx_align_center" id="S4.T4.1.1.7.5.8">0.219</td>
<td class="ltx_td ltx_align_center" id="S4.T4.1.1.7.5.9"><span class="ltx_text ltx_framed ltx_framed_underline" id="S4.T4.1.1.7.5.9.1">0.171</span></td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T4.1.1.7.5.10">0.192</td>
<td class="ltx_td ltx_align_center" id="S4.T4.1.1.7.5.11">0.214</td>
<td class="ltx_td ltx_align_center" id="S4.T4.1.1.7.5.12">0.136</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S4.T4.1.1.7.5.13">0.167</td>
<td class="ltx_td ltx_align_center" id="S4.T4.1.1.7.5.14">0.530</td>
<td class="ltx_td ltx_align_center" id="S4.T4.1.1.7.5.15">0.518</td>
</tr>
<tr class="ltx_tr" id="S4.T4.1.1.8.6">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_b ltx_border_r" id="S4.T4.1.1.8.6.1">Ours</th>
<td class="ltx_td ltx_align_center ltx_border_b" id="S4.T4.1.1.8.6.2">0.677</td>
<td class="ltx_td ltx_align_center ltx_border_b" id="S4.T4.1.1.8.6.3">0.879</td>
<td class="ltx_td ltx_align_center ltx_border_b ltx_border_r" id="S4.T4.1.1.8.6.4"><span class="ltx_text ltx_framed ltx_framed_underline" id="S4.T4.1.1.8.6.4.1">0.765</span></td>
<td class="ltx_td ltx_align_center ltx_border_b" id="S4.T4.1.1.8.6.5"><span class="ltx_text ltx_framed ltx_framed_underline" id="S4.T4.1.1.8.6.5.1">0.286</span></td>
<td class="ltx_td ltx_align_center ltx_border_b" id="S4.T4.1.1.8.6.6">0.262</td>
<td class="ltx_td ltx_align_center ltx_border_b ltx_border_r" id="S4.T4.1.1.8.6.7"><span class="ltx_text ltx_framed ltx_framed_underline" id="S4.T4.1.1.8.6.7.1">0.274</span></td>
<td class="ltx_td ltx_align_center ltx_border_b" id="S4.T4.1.1.8.6.8"><span class="ltx_text ltx_font_bold" id="S4.T4.1.1.8.6.8.1">0.500</span></td>
<td class="ltx_td ltx_align_center ltx_border_b" id="S4.T4.1.1.8.6.9">0.122</td>
<td class="ltx_td ltx_align_center ltx_border_b ltx_border_r" id="S4.T4.1.1.8.6.10"><span class="ltx_text ltx_framed ltx_framed_underline" id="S4.T4.1.1.8.6.10.1">0.196</span></td>
<td class="ltx_td ltx_align_center ltx_border_b" id="S4.T4.1.1.8.6.11"><span class="ltx_text ltx_framed ltx_framed_underline" id="S4.T4.1.1.8.6.11.1">0.350</span></td>
<td class="ltx_td ltx_align_center ltx_border_b" id="S4.T4.1.1.8.6.12"><span class="ltx_text ltx_framed ltx_framed_underline" id="S4.T4.1.1.8.6.12.1">0.152</span></td>
<td class="ltx_td ltx_align_center ltx_border_b ltx_border_r" id="S4.T4.1.1.8.6.13"><span class="ltx_text ltx_framed ltx_framed_underline" id="S4.T4.1.1.8.6.13.1">0.212</span></td>
<td class="ltx_td ltx_align_center ltx_border_b" id="S4.T4.1.1.8.6.14"><span class="ltx_text ltx_framed ltx_framed_underline" id="S4.T4.1.1.8.6.14.1">0.592</span></td>
<td class="ltx_td ltx_align_center ltx_border_b" id="S4.T4.1.1.8.6.15"><span class="ltx_text ltx_framed ltx_framed_underline" id="S4.T4.1.1.8.6.15.1">0.543</span></td>
</tr>
</tbody>
</table>
</span></div>
</div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_1"><span class="ltx_ERROR ltx_centering ltx_figure_panel undefined" id="S4.T4.2">\Description</span></div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_1">
<p class="ltx_p ltx_figure_panel ltx_align_center" id="S4.T4.3">This table presents a comparison between the depression degree estimation results from the assistive diagnostic report generated by our proposed AI Psychologist and those from five other representative models on the DepSeverity dataset. Our method achieves the best ACC and Weighted-F1 scores among compared LLMs.</p>
</div>
</div>
</figure>
<div class="ltx_para" id="S4.SS4.p1">
<p class="ltx_p" id="S4.SS4.p1.1">For estimation of depression severity degree in our generated reports, we instructed Chatglm3-6b, Llama2-Chinese-7b, and Baichuan2-7b to determine whether the user in the conversation belongs to the categories of normal, mild, moderate, or severe. For ChineseMentalBert, we fine-tuned it in a four-class classification setting and tested it on our datasets. Since the DR dataset does not contain fine-grained labels for different degrees of depression, we report the results of these models on the MMDA dataset and the DepSeverity dataset, as shown in Table <a class="ltx_ref" href="https://arxiv.org/html/2409.14878v1#S4.T3" title="Table 3 ‣ 4.4. Comparison of Severity Degree Estimation Results ‣ 4. Experimental Results and Analysis ‣ InterMind: A Doctor-Patient-Family Interactive Depression Assessment System Empowered by Large Language Models"><span class="ltx_text ltx_ref_tag">3</span></a> and Table <a class="ltx_ref" href="https://arxiv.org/html/2409.14878v1#S4.T4" title="Table 4 ‣ 4.4. Comparison of Severity Degree Estimation Results ‣ 4. Experimental Results and Analysis ‣ InterMind: A Doctor-Patient-Family Interactive Depression Assessment System Empowered by Large Language Models"><span class="ltx_text ltx_ref_tag">4</span></a>.</p>
</div>
<div class="ltx_para" id="S4.SS4.p2">
<p class="ltx_p" id="S4.SS4.p2.1">Compared to binary classification, the task of depression severity degree estimation (which can be seen as a four-class classification) poses a greater challenge to the model. As shown in Table <a class="ltx_ref" href="https://arxiv.org/html/2409.14878v1#S4.T3" title="Table 3 ‣ 4.4. Comparison of Severity Degree Estimation Results ‣ 4. Experimental Results and Analysis ‣ InterMind: A Doctor-Patient-Family Interactive Depression Assessment System Empowered by Large Language Models"><span class="ltx_text ltx_ref_tag">3</span></a>, on the MMDA dataset, our instruction fine-tuning significantly enhances the model’s ability to estimate depression severity degree in the generated assistive diagnostic reports compared to the backbone model Baichuan2-7b, with noticeable improvements in F1 scores across different degrees (normal: 0.667 vs. 0.538, mild: 0.571 vs. 0.071, moderate: 0.727 vs. 0.250, severe: 0.667 vs. 0.000). The accuracy improves from 0.347 to 0.633, and the weighted F1 score improves from 0.247 to 0.619, demonstrating the usefulness of our method in depression severity degree estimation. Notably, in the MMDA dataset where the number of moderate or severe subjects is relatively small, models like ChatGLM3-6B, LLaMA2-Chinese-7B, and Baichuan2-7B (all 6B or 7B models) exhibit poor performance for moderate or severe subjects, or even fail. For example, their F1 scores for severe subjects are 0. This phenomenon also occurs with the supervised model ChineseMentalBert, which tends to identify subjects as normal or mild, while showing weak detection capabilities for moderate or severe subjects (with F1 scores of 0 for both moderate and severe categories). GPT-4 demonstrates superiority over other LLMs in the more challenging task of depression severity degree estimation, as it can detect moderate and severe subjects to some extent. However, the F1 scores are not high (moderate: 0.167, severe: 0.250). Our method demonstrates strong detection capabilities across different severity degrees and achieves the best results in detecting moderate and severe subjects, leading to the highest overall accuracy (ACC: 0.633) and weighted-F1 score (weighted-F1: 0.619).</p>
</div>
<div class="ltx_para" id="S4.SS4.p3">
<p class="ltx_p" id="S4.SS4.p3.1">On the DepSeverity dataset (Table <a class="ltx_ref" href="https://arxiv.org/html/2409.14878v1#S4.T4" title="Table 4 ‣ 4.4. Comparison of Severity Degree Estimation Results ‣ 4. Experimental Results and Analysis ‣ InterMind: A Doctor-Patient-Family Interactive Depression Assessment System Empowered by Large Language Models"><span class="ltx_text ltx_ref_tag">4</span></a>), which has a larger number of samples, our method also significantly improves the performance of Baichuan2-7B through instruction fine-tuning, as reflected in the F1 scores across different severity degrees (normal: 0.549 vs. 0.765, moderate: 0.053 vs. 0.196, severe: 0.038 vs. 0.212). The overall performance is improved by 52.2% in ACC and 40.3% in weighted F1. We can also see that ChatGLM3-6B, LLaMA2-Chinese-7B, and Baichuan2-7B perform poorly in detecting moderate or severe subjects, with low F1 scores. GPT-4 still has some ability to detect moderate or severe subjects, but its F1 scores are not high (moderate: 0.192, severe: 0.167), which is consistent with the observations in Table <a class="ltx_ref" href="https://arxiv.org/html/2409.14878v1#S4.T3" title="Table 3 ‣ 4.4. Comparison of Severity Degree Estimation Results ‣ 4. Experimental Results and Analysis ‣ InterMind: A Doctor-Patient-Family Interactive Depression Assessment System Empowered by Large Language Models"><span class="ltx_text ltx_ref_tag">3</span></a>. Since there are more moderate and severe subjects in the DepSeverity dataset, the advantage of supervised models in specific tasks appears. ChineseMentalBert achieves the best results in identifying both moderate and severe subjects, with an overall ACC of 0.627 and a Weighted-F1 score of 0.564. Our method achieves the best results among LLMs in Table <a class="ltx_ref" href="https://arxiv.org/html/2409.14878v1#S4.T4" title="Table 4 ‣ 4.4. Comparison of Severity Degree Estimation Results ‣ 4. Experimental Results and Analysis ‣ InterMind: A Doctor-Patient-Family Interactive Depression Assessment System Empowered by Large Language Models"><span class="ltx_text ltx_ref_tag">4</span></a>, with F1 scores across all four severity degrees outperforming GPT-4.</p>
</div>
<div class="ltx_para" id="S4.SS4.p4">
<p class="ltx_p" id="S4.SS4.p4.1">In conclusion, depression severity degree estimation as a more fine-grained task, poses a challenge for existing LLMs. By using high-quality dialogues and generated assistive diagnostic report that contains more interpretable content for instruction fine-tuning, we can effectively enhance the model’s capability in this task.</p>
</div>
</section>
<section class="ltx_subsection" id="S4.SS5">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.5. </span>Evaluation of Report Quality</h3>
<div class="ltx_para" id="S4.SS5.p1">
<p class="ltx_p" id="S4.SS5.p1.1">The experiments in the previous section <a class="ltx_ref" href="https://arxiv.org/html/2409.14878v1#S4.SS3" title="4.3. Comparison of Depression Binary Classification Results ‣ 4. Experimental Results and Analysis ‣ InterMind: A Doctor-Patient-Family Interactive Depression Assessment System Empowered by Large Language Models"><span class="ltx_text ltx_ref_tag">4.3</span></a> and <a class="ltx_ref" href="https://arxiv.org/html/2409.14878v1#S4.SS4" title="4.4. Comparison of Severity Degree Estimation Results ‣ 4. Experimental Results and Analysis ‣ InterMind: A Doctor-Patient-Family Interactive Depression Assessment System Empowered by Large Language Models"><span class="ltx_text ltx_ref_tag">4.4</span></a> evaluate the accuracy of the binary classification and depression severity estimation in the generated report, but they do not fully reflect the overall report quality. Therefore, this subsection further validates report quality, particularly the interpretable contents in reports, through subjective evaluations by psychiatrists and quantitative experiments.</p>
</div>
<section class="ltx_subsubsection" id="S4.SS5.SSS1">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">4.5.1. </span>Clinical Psychiatrist Evaluation</h4>
<div class="ltx_para" id="S4.SS5.SSS1.p1">
<p class="ltx_p" id="S4.SS5.SSS1.p1.1">We collaborated with 5 clinical psychiatrists, inviting them to evaluate the reports generated from our test data. The evaluation rule is described in the following. For each subject, GPT-4 and our method generate an assistive diagnostic report respectively. The generated reports are provided to psychiatrists who independently scored each item in the reports from GPT-4 and our method. Scored items include binary depression classification, severity degree, each symptom-standard agreement, and subtype category. Psychiatrists score 1 point for each item that they consider as correct and 0 point when they consider it as incorrect. It is important to note that the psychiatrists are not provided with the dataset’s ground truth. They score the items in the report depending on their knowledge and experience. In addition, the psychiatrists are unaware of the model’s name when they are scoring. The scores are summed and then divided by the number of subjects to obtain the average score. Subsequently, the average scores for different sections are also calculated. The above scores represent psychiatrists’ agreement on the contents of generated reports.</p>
</div>
<figure class="ltx_table" id="S4.T5">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_table">Table 5. </span>Psychiatrist Evaluation Results</figcaption><div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_1">
<table class="ltx_tabular ltx_centering ltx_figure_panel ltx_guessed_headers ltx_align_middle" id="S4.T5.1">
<thead class="ltx_thead">
<tr class="ltx_tr" id="S4.T5.1.1.1">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_tt" colspan="6" id="S4.T5.1.1.1.1"><span class="ltx_text ltx_font_bold" id="S4.T5.1.1.1.1.1">MMDA Dataset</span></th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr class="ltx_tr" id="S4.T5.1.2.1">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t" id="S4.T5.1.2.1.1"><span class="ltx_text ltx_font_bold" id="S4.T5.1.2.1.1.1">Model</span></th>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T5.1.2.1.2"><span class="ltx_text ltx_font_bold" id="S4.T5.1.2.1.2.1">Class</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T5.1.2.1.3"><span class="ltx_text ltx_font_bold" id="S4.T5.1.2.1.3.1">Degree</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T5.1.2.1.4"><span class="ltx_text ltx_font_bold" id="S4.T5.1.2.1.4.1">Symptom_Standard</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T5.1.2.1.5"><span class="ltx_text ltx_font_bold" id="S4.T5.1.2.1.5.1">Category</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T5.1.2.1.6"><span class="ltx_text ltx_font_bold" id="S4.T5.1.2.1.6.1">Average</span></td>
</tr>
<tr class="ltx_tr" id="S4.T5.1.3.2">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t" id="S4.T5.1.3.2.1">GPT-4</th>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T5.1.3.2.2"><span class="ltx_text ltx_font_bold" id="S4.T5.1.3.2.2.1">0.917</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T5.1.3.2.3"><span class="ltx_text ltx_font_bold" id="S4.T5.1.3.2.3.1">0.625</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T5.1.3.2.4">9.875</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T5.1.3.2.5"><span class="ltx_text ltx_font_bold" id="S4.T5.1.3.2.5.1">0.771</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T5.1.3.2.6">12.188</td>
</tr>
<tr class="ltx_tr" id="S4.T5.1.4.3">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="S4.T5.1.4.3.1">Ours</th>
<td class="ltx_td ltx_align_center" id="S4.T5.1.4.3.2">0.771</td>
<td class="ltx_td ltx_align_center" id="S4.T5.1.4.3.3"><span class="ltx_text ltx_font_bold" id="S4.T5.1.4.3.3.1">0.625</span></td>
<td class="ltx_td ltx_align_center" id="S4.T5.1.4.3.4"><span class="ltx_text ltx_font_bold" id="S4.T5.1.4.3.4.1">11.396</span></td>
<td class="ltx_td ltx_align_center" id="S4.T5.1.4.3.5">0.688</td>
<td class="ltx_td ltx_align_center" id="S4.T5.1.4.3.6"><span class="ltx_text ltx_font_bold" id="S4.T5.1.4.3.6.1">13.479</span></td>
</tr>
<tr class="ltx_tr" id="S4.T5.1.5.4">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_t" colspan="6" id="S4.T5.1.5.4.1"><span class="ltx_text ltx_font_bold" id="S4.T5.1.5.4.1.1">DR Dataset</span></th>
</tr>
<tr class="ltx_tr" id="S4.T5.1.6.5">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t" id="S4.T5.1.6.5.1"><span class="ltx_text ltx_font_bold" id="S4.T5.1.6.5.1.1">Model</span></th>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T5.1.6.5.2"><span class="ltx_text ltx_font_bold" id="S4.T5.1.6.5.2.1">Class</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T5.1.6.5.3"><span class="ltx_text ltx_font_bold" id="S4.T5.1.6.5.3.1">Degree</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T5.1.6.5.4"><span class="ltx_text ltx_font_bold" id="S4.T5.1.6.5.4.1">Symptom_Standard</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T5.1.6.5.5"><span class="ltx_text ltx_font_bold" id="S4.T5.1.6.5.5.1">Category</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T5.1.6.5.6"><span class="ltx_text ltx_font_bold" id="S4.T5.1.6.5.6.1">Average</span></td>
</tr>
<tr class="ltx_tr" id="S4.T5.1.7.6">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t" id="S4.T5.1.7.6.1">GPT-4</th>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T5.1.7.6.2"><span class="ltx_text ltx_font_bold" id="S4.T5.1.7.6.2.1">0.973</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T5.1.7.6.3"><span class="ltx_text ltx_font_bold" id="S4.T5.1.7.6.3.1">0.703</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T5.1.7.6.4">6.486</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T5.1.7.6.5"><span class="ltx_text ltx_font_bold" id="S4.T5.1.7.6.5.1">0.865</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T5.1.7.6.6">9.027</td>
</tr>
<tr class="ltx_tr" id="S4.T5.1.8.7">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="S4.T5.1.8.7.1">Ours</th>
<td class="ltx_td ltx_align_center" id="S4.T5.1.8.7.2">0.811</td>
<td class="ltx_td ltx_align_center" id="S4.T5.1.8.7.3"><span class="ltx_text ltx_font_bold" id="S4.T5.1.8.7.3.1">0.703</span></td>
<td class="ltx_td ltx_align_center" id="S4.T5.1.8.7.4"><span class="ltx_text ltx_font_bold" id="S4.T5.1.8.7.4.1">9.432</span></td>
<td class="ltx_td ltx_align_center" id="S4.T5.1.8.7.5">0.784</td>
<td class="ltx_td ltx_align_center" id="S4.T5.1.8.7.6"><span class="ltx_text ltx_font_bold" id="S4.T5.1.8.7.6.1">11.730</span></td>
</tr>
<tr class="ltx_tr" id="S4.T5.1.9.8">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_t" colspan="6" id="S4.T5.1.9.8.1"><span class="ltx_text ltx_font_bold" id="S4.T5.1.9.8.1.1">DepSeverity Dataset</span></th>
</tr>
<tr class="ltx_tr" id="S4.T5.1.10.9">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t" id="S4.T5.1.10.9.1"><span class="ltx_text ltx_font_bold" id="S4.T5.1.10.9.1.1">Model</span></th>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T5.1.10.9.2"><span class="ltx_text ltx_font_bold" id="S4.T5.1.10.9.2.1">Class</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T5.1.10.9.3"><span class="ltx_text ltx_font_bold" id="S4.T5.1.10.9.3.1">Degree</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T5.1.10.9.4"><span class="ltx_text ltx_font_bold" id="S4.T5.1.10.9.4.1">Symptom_Standard</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T5.1.10.9.5"><span class="ltx_text ltx_font_bold" id="S4.T5.1.10.9.5.1">Category</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T5.1.10.9.6"><span class="ltx_text ltx_font_bold" id="S4.T5.1.10.9.6.1">Average</span></td>
</tr>
<tr class="ltx_tr" id="S4.T5.1.11.10">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t" id="S4.T5.1.11.10.1">GPT-4</th>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T5.1.11.10.2"><span class="ltx_text ltx_font_bold" id="S4.T5.1.11.10.2.1">1.000</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T5.1.11.10.3">0.750</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T5.1.11.10.4">5.675</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T5.1.11.10.5"><span class="ltx_text ltx_font_bold" id="S4.T5.1.11.10.5.1">0.975</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T5.1.11.10.6">8.400</td>
</tr>
<tr class="ltx_tr" id="S4.T5.1.12.11">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_bb" id="S4.T5.1.12.11.1">Ours</th>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S4.T5.1.12.11.2">0.825</td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S4.T5.1.12.11.3"><span class="ltx_text ltx_font_bold" id="S4.T5.1.12.11.3.1">0.800</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S4.T5.1.12.11.4"><span class="ltx_text ltx_font_bold" id="S4.T5.1.12.11.4.1">6.850</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S4.T5.1.12.11.5">0.875</td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S4.T5.1.12.11.6"><span class="ltx_text ltx_font_bold" id="S4.T5.1.12.11.6.1">9.350</span></td>
</tr>
</tbody>
</table>
</div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_1">
<ul class="ltx_itemize ltx_centering ltx_figure_panel" id="S4.I2">
<li class="ltx_item" id="S4.I2.ix1" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">1</span>
<div class="ltx_para" id="S4.I2.ix1.p1">
<p class="ltx_p" id="S4.I2.ix1.p1.1"><span class="ltx_text" id="S4.I2.ix1.p1.1.1" style="font-size:80%;">Class, Degree, Symptom_Standard, Category indicate each item in our assistive diagnostic report, representing binary depression classification, severity degree, symptom-standard agreement, and subtype category.</span></p>
</div>
</li>
</ul>
</div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_1"><span class="ltx_ERROR ltx_centering ltx_figure_panel undefined" id="S4.T5.2">\Description</span></div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_1">
<p class="ltx_p ltx_figure_panel ltx_align_center" id="S4.T5.3">This table shows the scoring results from psychiatrists for each item in the assistive diagnostic reports generated by our method compared to those generated by GPT-4. The evaluation items include binary depression classification, severity degree, symptom-standard agreement, and subtype category. Our method achieves better overall quality, particularly in the interpretable content of the generated reports.</p>
</div>
</div>
</figure>
<div class="ltx_para" id="S4.SS5.SSS1.p2">
<p class="ltx_p" id="S4.SS5.SSS1.p2.1">Based on the above rules, the psychiatrists evaluated a total of 129 subjects, including the MMDA’s test set and 80 subjects randomly sampled from the test sets of DR and DepSeverity. The average scores are reported in Table <a class="ltx_ref" href="https://arxiv.org/html/2409.14878v1#S4.T5" title="Table 5 ‣ 4.5.1. Clinical Psychiatrist Evaluation ‣ 4.5. Evaluation of Report Quality ‣ 4. Experimental Results and Analysis ‣ InterMind: A Doctor-Patient-Family Interactive Depression Assessment System Empowered by Large Language Models"><span class="ltx_text ltx_ref_tag">5</span></a>, including binary depression classification, severity degree, symptom-standard agreement, and subtype category. We can see that our method receives higher average scores from psychiatrists across all three datasets compared to GPT-4. Specifically, when it comes to analyzing symptoms related to the dialogue content and providing relevant diagnostic criteria and agreement references, the average score (Symptom_Standard) evaluated by psychiatrists exceeds those of GPT-4. This indicates that psychiatrists agree more with the relevant symptoms and diagnostic criteria presented in our generated reports, evaluating that our method provides psychiatrists with richer and more accurate assistive diagnostic content. Furthermore, our method tends to be more endorsed by psychiatrists in estimating the severity degree of depression, indicating that our approach also performs well in fine-grained tasks.</p>
</div>
<div class="ltx_para" id="S4.SS5.SSS1.p3">
<p class="ltx_p" id="S4.SS5.SSS1.p3.1">However, we also find that in the binary classification of depression, the comparison results between our method and GPT-4 are the opposite of those in Table <a class="ltx_ref" href="https://arxiv.org/html/2409.14878v1#S4.T2" title="Table 2 ‣ 4.2.2. Evaluation Metrics ‣ 4.2. Experimental Setup and Evaluation Metrics ‣ 4. Experimental Results and Analysis ‣ InterMind: A Doctor-Patient-Family Interactive Depression Assessment System Empowered by Large Language Models"><span class="ltx_text ltx_ref_tag">2</span></a>. The phenomenon can be attributed to the coincident tendency of psychiatrists and GPT-4, that is, they are prone to considering subjects as non-depressed, whose ground truth in the datasets is mild. Specifically, for psychiatrists, binary classification is a conclusive judgment about the subject. When a dialogue is a mild depression, especially when the patient’s score on the questionnaire is on the borderline of depression, psychiatrists are usually hesitant to label this subject as depressed. GPT-4 is consistent with this hesitancy, leading to higher scores in binary classification evaluated by psychiatrists, which also affects the scores in category classification, such as determining whether a patient has a specific depression subtype or is normal.
On the contrary, our method’s binary classification results maintain a higher consistency with the dataset’s ground truth, that is, considering HAMD scores of 7 or higher as depression.
This conclusion is also supported by the fact that our method provides a comparable or better estimation of the severity degree.</p>
</div>
<div class="ltx_para" id="S4.SS5.SSS1.p4">
<p class="ltx_p" id="S4.SS5.SSS1.p4.1">In conclusion, this experiment presents a more comprehensive evaluation of the generated reports via drawing support from professionals. The evaluation results based on their expertise indicate that the reports produced by our method are potentially useful to doctors in their depression-oriented works.</p>
</div>
</section>
<section class="ltx_subsubsection" id="S4.SS5.SSS2">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">4.5.2. </span>Quantitative Experimental Evaluation</h4>
<figure class="ltx_table" id="S4.T6">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table">Table 6. </span>The 5-fold cross-validation results of our trained supervised referee model</figcaption><div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_1">
<div class="ltx_block ltx_figure_panel" id="S4.T6.1">
<table class="ltx_tabular ltx_centering ltx_guessed_headers ltx_align_middle" id="S4.T6.1.1">
<thead class="ltx_thead">
<tr class="ltx_tr" id="S4.T6.1.1.1.1">
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_th_row ltx_border_tt" id="S4.T6.1.1.1.1.1">Fold</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="S4.T6.1.1.1.1.2">PRE</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="S4.T6.1.1.1.1.3">REC</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="S4.T6.1.1.1.1.4">F1</th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr class="ltx_tr" id="S4.T6.1.1.2.1">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_t" id="S4.T6.1.1.2.1.1">1</th>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T6.1.1.2.1.2">0.935</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T6.1.1.2.1.3">0.911</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T6.1.1.2.1.4">0.923</td>
</tr>
<tr class="ltx_tr" id="S4.T6.1.1.3.2">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row" id="S4.T6.1.1.3.2.1">2</th>
<td class="ltx_td ltx_align_center" id="S4.T6.1.1.3.2.2">0.955</td>
<td class="ltx_td ltx_align_center" id="S4.T6.1.1.3.2.3">0.933</td>
<td class="ltx_td ltx_align_center" id="S4.T6.1.1.3.2.4">0.944</td>
</tr>
<tr class="ltx_tr" id="S4.T6.1.1.4.3">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row" id="S4.T6.1.1.4.3.1">3</th>
<td class="ltx_td ltx_align_center" id="S4.T6.1.1.4.3.2">0.936</td>
<td class="ltx_td ltx_align_center" id="S4.T6.1.1.4.3.3">0.918</td>
<td class="ltx_td ltx_align_center" id="S4.T6.1.1.4.3.4">0.927</td>
</tr>
<tr class="ltx_tr" id="S4.T6.1.1.5.4">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row" id="S4.T6.1.1.5.4.1">4</th>
<td class="ltx_td ltx_align_center" id="S4.T6.1.1.5.4.2">0.949</td>
<td class="ltx_td ltx_align_center" id="S4.T6.1.1.5.4.3">0.942</td>
<td class="ltx_td ltx_align_center" id="S4.T6.1.1.5.4.4">0.946</td>
</tr>
<tr class="ltx_tr" id="S4.T6.1.1.6.5">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row" id="S4.T6.1.1.6.5.1">5</th>
<td class="ltx_td ltx_align_center" id="S4.T6.1.1.6.5.2">0.975</td>
<td class="ltx_td ltx_align_center" id="S4.T6.1.1.6.5.3">0.911</td>
<td class="ltx_td ltx_align_center" id="S4.T6.1.1.6.5.4">0.942</td>
</tr>
<tr class="ltx_tr" id="S4.T6.1.1.7.6">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_bb ltx_border_t" id="S4.T6.1.1.7.6.1">Overall</th>
<td class="ltx_td ltx_align_center ltx_border_bb ltx_border_t" id="S4.T6.1.1.7.6.2">0.950</td>
<td class="ltx_td ltx_align_center ltx_border_bb ltx_border_t" id="S4.T6.1.1.7.6.3">0.923</td>
<td class="ltx_td ltx_align_center ltx_border_bb ltx_border_t" id="S4.T6.1.1.7.6.4">0.936</td>
</tr>
</tbody>
</table>
<span class="ltx_ERROR ltx_centering undefined" id="S4.T6.1.2">\Description</span>
</div>
</div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_1">
<p class="ltx_p ltx_figure_panel ltx_align_center" id="S4.T6.2">This table shows that our trained referee model achieves high F1 in mapping the report content to the ground truth during 5-fold cross-validation.</p>
</div>
</div>
</figure>
<div class="ltx_para" id="S4.SS5.SSS2.p1">
<p class="ltx_p" id="S4.SS5.SSS2.p1.1">To further validate the higher quality of the interpretable content in the reports generated by our method (Symptom_Standard in Table <a class="ltx_ref" href="https://arxiv.org/html/2409.14878v1#S4.T5" title="Table 5 ‣ 4.5.1. Clinical Psychiatrist Evaluation ‣ 4.5. Evaluation of Report Quality ‣ 4. Experimental Results and Analysis ‣ InterMind: A Doctor-Patient-Family Interactive Depression Assessment System Empowered by Large Language Models"><span class="ltx_text ltx_ref_tag">5</span></a>) compared to GPT-4, we conducted a quantitative experimental evaluation used in <cite class="ltx_cite ltx_citemacro_citep">(Yang et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2409.14878v1#bib.bib44" title="">2024b</a>)</cite>.
Specifically, we trained a referee model using the supervised model ChineseMentalBert, where the referee model maps the symptom and standard section of the reports to their corresponding labels.
As shown in Table <a class="ltx_ref" href="https://arxiv.org/html/2409.14878v1#S4.T6" title="Table 6 ‣ 4.5.2. Quantitative Experimental Evaluation ‣ 4.5. Evaluation of Report Quality ‣ 4. Experimental Results and Analysis ‣ InterMind: A Doctor-Patient-Family Interactive Depression Assessment System Empowered by Large Language Models"><span class="ltx_text ltx_ref_tag">6</span></a>, we validate the referee model’s ability to assess the quality of interpretable content in the report using 5-fold cross-validation. It can be observed that for each fold, the referee model achieves an F1 score of over 0.9 in identifying depression based on the symptom and standard part of the reports, with an overall F1 score of 0.936, indicating a strong capability in evaluating report quality. Therefore, we use this referee model to evaluate the interpretable content generated by GPT-4 and our method, in terms of the accuracy of the binary classification results derived from the interpretable contents.</p>
</div>
<figure class="ltx_figure" id="S4.F9">
<div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_2"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_figure_panel ltx_img_landscape" height="326" id="S4.F9.g1" src="extracted/5872729/9.png" width="598"/></div>
</div>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 9. </span>Comparison of the report quality between GPT-4 and our method</figcaption><div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_1"><span class="ltx_ERROR ltx_centering ltx_figure_panel undefined" id="S4.F9.1">\Description</span></div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_1">
<p class="ltx_p ltx_figure_panel ltx_align_center" id="S4.F9.2">This figure shows the evaluation of the report content quality generated by GPT-4 and our method using our trained referee model. The figure demonstrates that our method outperforms GPT-4 in terms of F1 score across the three datasets, indicating that the interpretable content of the reports generated by our approach is of higher quality.</p>
</div>
</div>
</figure>
<div class="ltx_para" id="S4.SS5.SSS2.p2">
<p class="ltx_p" id="S4.SS5.SSS2.p2.1">Based on the above experimental setting, we evaluated the quality of the reports generated by our method and GPT-4. As shown in Figure <a class="ltx_ref" href="https://arxiv.org/html/2409.14878v1#S4.F9" title="Figure 9 ‣ 4.5.2. Quantitative Experimental Evaluation ‣ 4.5. Evaluation of Report Quality ‣ 4. Experimental Results and Analysis ‣ InterMind: A Doctor-Patient-Family Interactive Depression Assessment System Empowered by Large Language Models"><span class="ltx_text ltx_ref_tag">9</span></a>, we can see that on all three datasets, the report quality of our method surpasses that of GPT-4. Although the recall is lower than GPT-4 on the MMDA and DepSeverity datasets, the F1 scores are consistently higher. Our method consistently outperforms GPT-4 in almost all the evaluation metrics, indicating that the interpretable contents generated by our method are of higher quality. These results again validate the usefulness of our method.</p>
</div>
</section>
</section>
<section class="ltx_subsection" id="S4.SS6">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.6. </span>Psychological Counseling Competency Evaluation</h3>
<figure class="ltx_figure" id="S4.F10">
<div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_2"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_figure_panel ltx_img_landscape" height="360" id="S4.F10.g1" src="extracted/5872729/10.png" width="598"/></div>
</div>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 10. </span>Comparison of the psychological counseling competency between GPT-4 and our method</figcaption><div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_1"><span class="ltx_ERROR ltx_centering ltx_figure_panel undefined" id="S4.F10.1">\Description</span></div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_1">
<p class="ltx_p ltx_figure_panel ltx_align_center" id="S4.F10.2">This figure shows the volunteers’ scoring results for the proposed AI Psychological Chatbot and GPT-4 across four metrics: consistency, ability, engagement, and overall performance. It is evident that our method outperforms GPT-4 on all four metrics, indicating a stronger capability for psychological counseling.</p>
</div>
</div>
</figure>
<div class="ltx_para" id="S4.SS6.p1">
<p class="ltx_p" id="S4.SS6.p1.1">To evaluate the psychological counseling competency of AI Psychological Chatbot in our system, we invited 18 volunteers with a strong background in psychology to provide subjective evaluations of our method and GPT-4. Each volunteer participated in psychological counseling with both our model and GPT-4, and then scored the models based on four metrics: consistency, ability, engagement, and overall performance. Consistency refers to whether the model’s responses align with the context of the conversation, such as using appropriate conversational tones and providing responses of suitable length. Ability evaluates the model’s competence as a psychological counselor, assessing whether it can offer emotional support, inquire deeply about related symptoms, and avoid irrelevant responses. Engagement assesses whether the model’s responses encourage the user to continue sharing their experiences and feelings. Overall represents the general impression of the model’s performance. Each metric ranges from 1 to 5, with higher scores indicating better performance for that specific aspect. To note, volunteers were unaware of
the model’s name when they were scoring.</p>
</div>
<div class="ltx_para" id="S4.SS6.p2">
<p class="ltx_p" id="S4.SS6.p2.1">The average scores from volunteers are shown in Figure <a class="ltx_ref" href="https://arxiv.org/html/2409.14878v1#S4.F10" title="Figure 10 ‣ 4.6. Psychological Counseling Competency Evaluation ‣ 4. Experimental Results and Analysis ‣ InterMind: A Doctor-Patient-Family Interactive Depression Assessment System Empowered by Large Language Models"><span class="ltx_text ltx_ref_tag">10</span></a>, where it can be seen that our approach demonstrates a noticeable advantage in consistency. This is because GPT-4 tends to respond with more formal and extensive content, which is less suitable for casual conversation scenarios compared to our model. In terms of ability, both our method and GPT-4 perform similarly, with scores exceeding 4, indicating that both models can provide psychological support in counseling, encouraging users to share their feelings. For engagement, our model achieves higher scores, suggesting that it fosters a stronger willingness in users to engage in conversation. Finally, our method outperforms GPT-4 in terms of the overall evaluation.</p>
</div>
</section>
<section class="ltx_subsection" id="S4.SS7">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.7. </span>Ablation Study</h3>
<figure class="ltx_table" id="S4.T7">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_table">Table 7. </span>Ablation Study of Retrieval-augmented Generation (RAG) and Chain-of-thoughts (CoT)</figcaption><div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_1">
<div class="ltx_block ltx_figure_panel" id="S4.T7.1">
<div class="ltx_inline-block ltx_align_center ltx_transformed_outer" id="S4.T7.1.1" style="width:390.3pt;height:81pt;vertical-align:-0.0pt;"><span class="ltx_transformed_inner" style="transform:translate(-65.0pt,13.5pt) scale(0.750048916665943,0.750048916665943) ;">
<table class="ltx_tabular ltx_guessed_headers ltx_align_middle" id="S4.T7.1.1.1">
<thead class="ltx_thead">
<tr class="ltx_tr" id="S4.T7.1.1.1.1.1">
<th class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_th_row ltx_border_tt" id="S4.T7.1.1.1.1.1.1"><span class="ltx_text ltx_font_bold" id="S4.T7.1.1.1.1.1.1.1">Dataset</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" colspan="4" id="S4.T7.1.1.1.1.1.2"><span class="ltx_text ltx_font_bold" id="S4.T7.1.1.1.1.1.2.1">MMDA</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" colspan="4" id="S4.T7.1.1.1.1.1.3"><span class="ltx_text ltx_font_bold" id="S4.T7.1.1.1.1.1.3.1">DR</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" colspan="4" id="S4.T7.1.1.1.1.1.4"><span class="ltx_text ltx_font_bold" id="S4.T7.1.1.1.1.1.4.1">DepSeverity</span></th>
</tr>
<tr class="ltx_tr" id="S4.T7.1.1.1.2.2">
<th class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_th_row ltx_border_t" id="S4.T7.1.1.1.2.2.1">Method</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" id="S4.T7.1.1.1.2.2.2">ACC</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" id="S4.T7.1.1.1.2.2.3">PRE</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" id="S4.T7.1.1.1.2.2.4">REC</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" id="S4.T7.1.1.1.2.2.5">F1</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" id="S4.T7.1.1.1.2.2.6">ACC</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" id="S4.T7.1.1.1.2.2.7">PRE</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" id="S4.T7.1.1.1.2.2.8">REC</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" id="S4.T7.1.1.1.2.2.9">F1</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" id="S4.T7.1.1.1.2.2.10">ACC</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" id="S4.T7.1.1.1.2.2.11">PRE</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" id="S4.T7.1.1.1.2.2.12">REC</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" id="S4.T7.1.1.1.2.2.13">F1</th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr class="ltx_tr" id="S4.T7.1.1.1.3.1">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t" id="S4.T7.1.1.1.3.1.1">GPT-4</th>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T7.1.1.1.3.1.2">0.592</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T7.1.1.1.3.1.3">0.875</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T7.1.1.1.3.1.4">0.438</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T7.1.1.1.3.1.5">0.583</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T7.1.1.1.3.1.6">0.773</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T7.1.1.1.3.1.7"><span class="ltx_text ltx_font_bold" id="S4.T7.1.1.1.3.1.7.1">0.972</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T7.1.1.1.3.1.8">0.724</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T7.1.1.1.3.1.9">0.830</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T7.1.1.1.3.1.10">0.648</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T7.1.1.1.3.1.11">0.683</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T7.1.1.1.3.1.12">0.283</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T7.1.1.1.3.1.13">0.400</td>
</tr>
<tr class="ltx_tr" id="S4.T7.1.1.1.4.2">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="S4.T7.1.1.1.4.2.1">GPT-4+RAG</th>
<td class="ltx_td ltx_align_center" id="S4.T7.1.1.1.4.2.2">0.612</td>
<td class="ltx_td ltx_align_center" id="S4.T7.1.1.1.4.2.3"><span class="ltx_text ltx_font_bold" id="S4.T7.1.1.1.4.2.3.1">0.933</span></td>
<td class="ltx_td ltx_align_center" id="S4.T7.1.1.1.4.2.4">0.438</td>
<td class="ltx_td ltx_align_center" id="S4.T7.1.1.1.4.2.5">0.596</td>
<td class="ltx_td ltx_align_center" id="S4.T7.1.1.1.4.2.6">0.820</td>
<td class="ltx_td ltx_align_center" id="S4.T7.1.1.1.4.2.7">0.950</td>
<td class="ltx_td ltx_align_center" id="S4.T7.1.1.1.4.2.8">0.805</td>
<td class="ltx_td ltx_align_center" id="S4.T7.1.1.1.4.2.9">0.871</td>
<td class="ltx_td ltx_align_center" id="S4.T7.1.1.1.4.2.10"><span class="ltx_text ltx_font_bold" id="S4.T7.1.1.1.4.2.10.1">0.746</span></td>
<td class="ltx_td ltx_align_center" id="S4.T7.1.1.1.4.2.11"><span class="ltx_text ltx_font_bold" id="S4.T7.1.1.1.4.2.11.1">0.769</span></td>
<td class="ltx_td ltx_align_center" id="S4.T7.1.1.1.4.2.12">0.561</td>
<td class="ltx_td ltx_align_center" id="S4.T7.1.1.1.4.2.13">0.648</td>
</tr>
<tr class="ltx_tr" id="S4.T7.1.1.1.5.3">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="S4.T7.1.1.1.5.3.1">GPT-4+CoT</th>
<td class="ltx_td ltx_align_center" id="S4.T7.1.1.1.5.3.2">0.796</td>
<td class="ltx_td ltx_align_center" id="S4.T7.1.1.1.5.3.3">0.775</td>
<td class="ltx_td ltx_align_center" id="S4.T7.1.1.1.5.3.4"><span class="ltx_text ltx_font_bold" id="S4.T7.1.1.1.5.3.4.1">0.969</span></td>
<td class="ltx_td ltx_align_center" id="S4.T7.1.1.1.5.3.5">0.861</td>
<td class="ltx_td ltx_align_center" id="S4.T7.1.1.1.5.3.6">0.849</td>
<td class="ltx_td ltx_align_center" id="S4.T7.1.1.1.5.3.7">0.854</td>
<td class="ltx_td ltx_align_center" id="S4.T7.1.1.1.5.3.8"><span class="ltx_text ltx_font_bold" id="S4.T7.1.1.1.5.3.8.1">0.967</span></td>
<td class="ltx_td ltx_align_center" id="S4.T7.1.1.1.5.3.9"><span class="ltx_text ltx_font_bold" id="S4.T7.1.1.1.5.3.9.1">0.910</span></td>
<td class="ltx_td ltx_align_center" id="S4.T7.1.1.1.5.3.10">0.654</td>
<td class="ltx_td ltx_align_center" id="S4.T7.1.1.1.5.3.11">0.564</td>
<td class="ltx_td ltx_align_center" id="S4.T7.1.1.1.5.3.12">0.743</td>
<td class="ltx_td ltx_align_center" id="S4.T7.1.1.1.5.3.13">0.641</td>
</tr>
<tr class="ltx_tr" id="S4.T7.1.1.1.6.4">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_bb" id="S4.T7.1.1.1.6.4.1">GPT-4+RAG+CoT</th>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S4.T7.1.1.1.6.4.2"><span class="ltx_text ltx_font_bold" id="S4.T7.1.1.1.6.4.2.1">0.813</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S4.T7.1.1.1.6.4.3">0.811</td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S4.T7.1.1.1.6.4.4">0.938</td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S4.T7.1.1.1.6.4.5"><span class="ltx_text ltx_font_bold" id="S4.T7.1.1.1.6.4.5.1">0.870</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S4.T7.1.1.1.6.4.6"><span class="ltx_text ltx_font_bold" id="S4.T7.1.1.1.6.4.6.1">0.855</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S4.T7.1.1.1.6.4.7">0.860</td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S4.T7.1.1.1.6.4.8"><span class="ltx_text ltx_font_bold" id="S4.T7.1.1.1.6.4.8.1">0.967</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S4.T7.1.1.1.6.4.9"><span class="ltx_text ltx_font_bold" id="S4.T7.1.1.1.6.4.9.1">0.910</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S4.T7.1.1.1.6.4.10">0.669</td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S4.T7.1.1.1.6.4.11">0.581</td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S4.T7.1.1.1.6.4.12"><span class="ltx_text ltx_font_bold" id="S4.T7.1.1.1.6.4.12.1">0.750</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S4.T7.1.1.1.6.4.13"><span class="ltx_text ltx_font_bold" id="S4.T7.1.1.1.6.4.13.1">0.655</span></td>
</tr>
</tbody>
</table>
</span></div>
<span class="ltx_ERROR ltx_centering undefined" id="S4.T7.1.2">\Description</span>
</div>
</div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_1">
<p class="ltx_p ltx_figure_panel ltx_align_center" id="S4.T7.2">This table presents the ablation study on the use of RAG and CoT techniques when generating the assistive diagnostic report. The results show that the inclusion of RAG and CoT improves the quality of the report.</p>
</div>
</div>
</figure>
<div class="ltx_para" id="S4.SS7.p1">
<p class="ltx_p" id="S4.SS7.p1.1">To validate the effectiveness of retrieval-augmented generation (RAG) and chain-of-thoughts (CoT) in our use of GPT-4 to generate an assistive diagnostic report for instruction fine-tuning, we conduct an ablation study, which presents the binary classification results of GPT-4 on three datasets in different combinations with RAG or CoT, as shown in the Table <a class="ltx_ref" href="https://arxiv.org/html/2409.14878v1#S4.T7" title="Table 7 ‣ 4.7. Ablation Study ‣ 4. Experimental Results and Analysis ‣ InterMind: A Doctor-Patient-Family Interactive Depression Assessment System Empowered by Large Language Models"><span class="ltx_text ltx_ref_tag">7</span></a>.</p>
</div>
<div class="ltx_para" id="S4.SS7.p2">
<p class="ltx_p" id="S4.SS7.p2.1">We can observe that directly instructing GPT-4 to generate reports results in a higher precision (PRE) but lower recall (REC), indicating that GPT-4’s decision-making tends to be conservative. While it correctly identifies many subjects who are truly depressed, it also misses many subjects who should have been recognized as depressed. When we incorporate RAG into GPT-4, providing diagnostic criteria that semantically align most closely with the patient’s content, GPT-4 gains a stronger diagnostic basis. As a result, GPT-4+RAG shows improved report generation performance across all three datasets. On the MMDA dataset, precision (PRE) increases by 6.6% and F1 score by 2.2%. On the DR dataset, recall (REC) improves by 11.2% and F1 score by 4.9%. On the DepSeverity dataset, all metrics improve, with the F1 score increasing by 62%. This effectively addresses GPT-4’s previous inability to identify certain depressed subjects. Additionally, we validate the effectiveness of GPT-4+CoT, and it is evident that CoT significantly enhances GPT-4’s performance. Across all three datasets, CoT substantially increases recall (REC) (0.969 vs. 0.438, 0.967 vs. 0.724, and 0.743 vs. 0.283). Although precision (PRE) slightly decreases, the F1 score improves by 47.7%, 9.6%, and 60.3%, respectively. This indicates that guiding the model to generate reports through a step-by-step thought process allows for better analysis of the dialogue content, enhancing the model’s reasoning and decision-making accuracy. When we incorporate both RAG and CoT into the report generation process, GPT-4+RAG+CoT further improves the F1 scores of depression detection in the reports, achieving F1 scores of 0.870, 0.910, and 0.655 for the three datasets. This demonstrates that RAG and CoT provide essential support for LLM in generating more accurate assistive diagnostic reports.</p>
</div>
</section>
</section>
<section class="ltx_section" id="S5">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">5. </span>Conclusion</h2>
<div class="ltx_para" id="S5.p1">
<p class="ltx_p" id="S5.p1.1">In conclusion, we design InterMind, a doctor-patient-family interactive depression assessment system empowered by large language models (LLMs). At the functional level, we develop the AI Psychological Chatbot and the AI Psychologist within the system. AI Psychological Chatbot offers psychological counseling services to patients and families while providing psychological support to the patient during the conversation. AI Psychologist provides assistive diagnostic reports to doctors, offers treatment strategies and care advice to patients and families, and periodically analyzes mental states over time. In our system, doctors can timely correct and intervene in the generated results to ensure the reliability of the information provided. This system enables the family to participate in the treatment process between doctor and patient, providing the doctor with more objective and comprehensive information and allowing the family to better care for the patient. At the methodology level, we improve the ability of LLM-based AI Psychological Chatbot and AI Psychologist. We design prompt engineering to simulate psychological counseling dialogues, and combine RAG and CoT techniques to generate professional assistive diagnostic reports for dialogues. This data augmentation process facilitates the design of instruction fine-tuning tasks, enhancing the ability of LLMs in psychological counseling and assistive diagnostic report generation. Through quantitative experiments and subjective evaluations, we demonstrate that the proposed system possesses strong capabilities in aiding depression assessment.</p>
</div>
<div class="ltx_para" id="S5.p2">
<p class="ltx_p" id="S5.p2.1">In the future, we aim to explore various mental disorder detection technologies and consider incorporating medical knowledge graphs to provide AI Psychologist with more reliable knowledge of different mental disorders. Through the interactive participation of patients, doctors, and families, we hope that our system can help identify comorbidities and offer doctors more comprehensive information to support their diagnoses of multiple diseases.</p>
</div>
<div class="ltx_acknowledgements">
<h6 class="ltx_title ltx_title_acknowledgements">Acknowledgements.</h6>
We would like to extend our gratitude to the MAC Lab at the School of Computer and Information Engineering, Hefei University of Technology, for their support in providing the data. This work was supported by the National Key Research and Development Program (Grant No. 2023YFC2506803), the National Nature Science Foundation of China under Grant No. 62072152, 62172137, 72188101.

</div>
</section>
<section class="ltx_bibliography" id="bib">
<h2 class="ltx_title ltx_title_bibliography">References</h2>
<ul class="ltx_biblist">
<li class="ltx_bibitem" id="bib.bib1">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">(1)</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib2">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Achiam et al<span class="ltx_text" id="bib.bib2.2.2.1">.</span> (2023)</span>
<span class="ltx_bibblock">
Josh Achiam, Steven Adler, Sandhini Agarwal, Lama Ahmad, Ilge Akkaya, Florencia Leoni Aleman, Diogo Almeida, Janko Altenschmidt, Sam Altman, Shyamal Anadkat, et al<span class="ltx_text" id="bib.bib2.3.1">.</span> 2023.

</span>
<span class="ltx_bibblock">Gpt-4 technical report.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib2.4.1">arXiv preprint arXiv:2303.08774</em> (2023).

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib3">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Asai et al<span class="ltx_text" id="bib.bib3.2.2.1">.</span> (2023)</span>
<span class="ltx_bibblock">
Akari Asai, Zeqiu Wu, Yizhong Wang, Avirup Sil, and Hannaneh Hajishirzi. 2023.

</span>
<span class="ltx_bibblock">Self-rag: Learning to retrieve, generate, and critique through self-reflection.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib3.3.1">arXiv preprint arXiv:2310.11511</em> (2023).

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib4">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Chen et al<span class="ltx_text" id="bib.bib4.2.2.1">.</span> (2023)</span>
<span class="ltx_bibblock">
Siyuan Chen, Mengyue Wu, Kenny Q Zhu, Kunyao Lan, Zhiling Zhang, and Lyuchun Cui. 2023.

</span>
<span class="ltx_bibblock">LLM-empowered chatbots for psychiatrist and patient simulation: application and evaluation.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib4.3.1">arXiv preprint arXiv:2305.13614</em> (2023).

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib5">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Dai et al<span class="ltx_text" id="bib.bib5.2.2.1">.</span> (2021)</span>
<span class="ltx_bibblock">
Zhijun Dai, Heng Zhou, Qingfang Ba, Yang Zhou, Lifeng Wang, and Guochen Li. 2021.

</span>
<span class="ltx_bibblock">Improving depression prediction using a novel feature selection algorithm coupled with context-aware analysis.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib5.3.1">Journal of Affective Disorders</em> 295 (2021), 1040–1048.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib6">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Edge et al<span class="ltx_text" id="bib.bib6.2.2.1">.</span> (2024)</span>
<span class="ltx_bibblock">
Darren Edge, Ha Trinh, Newman Cheng, Joshua Bradley, Alex Chao, Apurva Mody, Steven Truitt, and Jonathan Larson. 2024.

</span>
<span class="ltx_bibblock">From local to global: A graph rag approach to query-focused summarization.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib6.3.1">arXiv preprint arXiv:2404.16130</em> (2024).

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib7">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Funk et al<span class="ltx_text" id="bib.bib7.2.2.1">.</span> (2016)</span>
<span class="ltx_bibblock">
M Funk et al<span class="ltx_text" id="bib.bib7.3.1">.</span> 2016.

</span>
<span class="ltx_bibblock">Global burden of mental disorders and the need for a comprehensive, coordinated response from health and social sectors at the country level.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib7.4.1">Retrieved On</em> 30 (2016).

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib8">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">GLM et al<span class="ltx_text" id="bib.bib8.2.2.1">.</span> (2024)</span>
<span class="ltx_bibblock">
Team GLM, Aohan Zeng, Bin Xu, Bowen Wang, Chenhui Zhang, Da Yin, Diego Rojas, Guanyu Feng, Hanlin Zhao, Hanyu Lai, et al<span class="ltx_text" id="bib.bib8.3.1">.</span> 2024.

</span>
<span class="ltx_bibblock">ChatGLM: A Family of Large Language Models from GLM-130B to GLM-4 All Tools.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib8.4.1">arXiv preprint arXiv:2406.12793</em> (2024).

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib9">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Greenberg et al<span class="ltx_text" id="bib.bib9.2.2.1">.</span> (2015)</span>
<span class="ltx_bibblock">
Paul E Greenberg, Andree-Anne Fournier, Tammy Sisitsky, Crystal T Pike, and Ronald C Kessler. 2015.

</span>
<span class="ltx_bibblock">The economic burden of adults with major depressive disorder in the United States (2005 and 2010).

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib9.3.1">The Journal of Clinical Psychiatry</em> 76, 2 (2015), 5356.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib10">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Habtamu et al<span class="ltx_text" id="bib.bib10.2.2.1">.</span> (2023)</span>
<span class="ltx_bibblock">
Kassahun Habtamu, Rahel Birhane, Mekdes Demissie, and Abebaw Fekadu. 2023.

</span>
<span class="ltx_bibblock">Interventions to improve the detection of depression in primary healthcare: systematic review.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib10.3.1">Systematic Reviews</em> 12, 1 (2023), 25.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib11">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Heaukulani et al<span class="ltx_text" id="bib.bib11.2.2.1">.</span> (2024)</span>
<span class="ltx_bibblock">
Creighton Heaukulani, Ye Sheng Phang, Janice Huiqin Weng, Jimmy Lee, and Robert JT Morris. 2024.

</span>
<span class="ltx_bibblock">Deploying AI Methods for Mental Health in Singapore: From Mental Wellness to Serious Mental Health Conditions.. In <em class="ltx_emph ltx_font_italic" id="bib.bib11.3.1">Proceedings of ML4CMH@ AAAI</em>. 84–93.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib12">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Hu et al<span class="ltx_text" id="bib.bib12.2.2.1">.</span> (2024)</span>
<span class="ltx_bibblock">
Jinpeng Hu, Tengteng Dong, Hui Ma, Peng Zou, Xiao Sun, and Meng Wang. 2024.

</span>
<span class="ltx_bibblock">PsycoLLM: Enhancing LLM for Psychological Understanding and Evaluation.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib12.3.1">arXiv preprint arXiv:2407.05721</em> (2024).

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib13">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Jeong et al<span class="ltx_text" id="bib.bib13.2.2.1">.</span> (2024)</span>
<span class="ltx_bibblock">
Soyeong Jeong, Jinheon Baek, Sukmin Cho, Sung Ju Hwang, and Jong C Park. 2024.

</span>
<span class="ltx_bibblock">Adaptive-rag: Learning to adapt retrieval-augmented large language models through question complexity.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib13.3.1">arXiv preprint arXiv:2403.14403</em> (2024).

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib14">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Ji et al<span class="ltx_text" id="bib.bib14.2.2.1">.</span> (2022)</span>
<span class="ltx_bibblock">
Shaoxiong Ji, Tianlin Zhang, Luna Ansari, Jie Fu, Prayag Tiwari, and Erik Cambria. 2022.

</span>
<span class="ltx_bibblock">MentalBERT: Publicly Available Pretrained Language Models for Mental Healthcare. In <em class="ltx_emph ltx_font_italic" id="bib.bib14.3.1">Proceedings of LREC</em>.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib15">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Jiang et al<span class="ltx_text" id="bib.bib15.2.2.1">.</span> (2022)</span>
<span class="ltx_bibblock">
Yueqi Jiang, Ziyang Zhang, and Xiao Sun. 2022.

</span>
<span class="ltx_bibblock">MMDA: A Multimodal Dataset for Depression and Anxiety Detection. In <em class="ltx_emph ltx_font_italic" id="bib.bib15.3.1">International Conference on Pattern Recognition</em>. Springer, 691–702.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib16">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Johnson (2022)</span>
<span class="ltx_bibblock">
Robin M Johnson. 2022.

</span>
<span class="ltx_bibblock">Addressing shortages in the psychiatry workforce.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib16.1.1">Psychiatric Times</em> (2022).

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib17">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Kim et al<span class="ltx_text" id="bib.bib17.2.2.1">.</span> (2024)</span>
<span class="ltx_bibblock">
Taewan Kim, Seolyeong Bae, Hyun Ah Kim, Su-woo Lee, Hwajung Hong, Chanmo Yang, and Young-Ho Kim. 2024.

</span>
<span class="ltx_bibblock">MindfulDiary: Harnessing Large Language Model to Support Psychiatric Patients’ Journaling. In <em class="ltx_emph ltx_font_italic" id="bib.bib17.3.1">Proceedings of the CHI Conference on Human Factors in Computing Systems</em>. 1–20.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib18">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Kraljevic et al<span class="ltx_text" id="bib.bib18.2.2.1">.</span> (2021)</span>
<span class="ltx_bibblock">
Zeljko Kraljevic, Anthony Shek, Daniel M Bean, Rebecca Bendayan, James T. H. Teo, and Richard J. B. Dobson. 2021.

</span>
<span class="ltx_bibblock">MedGPT: Medical Concept Prediction from Clinical Narratives.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib18.3.1">ArXiv</em> abs/2107.03134 (2021).

</span>
<span class="ltx_bibblock">
<a class="ltx_ref ltx_url ltx_font_typewriter" href="https://api.semanticscholar.org/CorpusID:235755486" title="">https://api.semanticscholar.org/CorpusID:235755486</a>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib19">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Lewis et al<span class="ltx_text" id="bib.bib19.2.2.1">.</span> (2020)</span>
<span class="ltx_bibblock">
Patrick Lewis, Ethan Perez, Aleksandra Piktus, Fabio Petroni, Vladimir Karpukhin, Naman Goyal, Heinrich Küttler, Mike Lewis, Wen-tau Yih, Tim Rocktäschel, et al<span class="ltx_text" id="bib.bib19.3.1">.</span> 2020.

</span>
<span class="ltx_bibblock">Retrieval-augmented generation for knowledge-intensive nlp tasks.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib19.4.1">Advances in Neural Information Processing Systems</em> 33 (2020), 9459–9474.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib20">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Liu et al<span class="ltx_text" id="bib.bib20.2.2.1">.</span> (2024)</span>
<span class="ltx_bibblock">
Han Liu, Changya Li, Xiaotong Zhang, Feng Zhang, Wei Wang, Fenglong Ma, Hongyang Chen, Hong Yu, and Xianchao Zhang. 2024.

</span>
<span class="ltx_bibblock">Depression Detection via Capsule Networks with Contrastive Learning. In <em class="ltx_emph ltx_font_italic" id="bib.bib20.3.1">Proceedings of the AAAI Conference on Artificial Intelligence</em>, Vol. 38. 22231–22239.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib21">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Loh and Raamkumar (2023)</span>
<span class="ltx_bibblock">
Siyuan Brandon Loh and Aravind Sesagiri Raamkumar. 2023.

</span>
<span class="ltx_bibblock">Harnessing Large Language Models’ Empathetic Response Generation Capabilities for Online Mental Health Counselling Support.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib21.1.1">arXiv preprint arXiv:2310.08017</em> (2023).

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib22">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Loshchilov and Hutter (2017)</span>
<span class="ltx_bibblock">
Ilya Loshchilov and Frank Hutter. 2017.

</span>
<span class="ltx_bibblock">Decoupled weight decay regularization.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib22.1.1">arXiv preprint arXiv:1711.05101</em> (2017).

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib23">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Ma et al<span class="ltx_text" id="bib.bib23.2.2.1">.</span> (2021)</span>
<span class="ltx_bibblock">
Simeng Ma, Jun Yang, Bingxiang Yang, Lijun Kang, Peilin Wang, Nan Zhang, Wei Wang, Xiaofen Zong, Ying Wang, Hanping Bai, et al<span class="ltx_text" id="bib.bib23.3.1">.</span> 2021.

</span>
<span class="ltx_bibblock">The Patient Health Questionnaire-9 vs. the Hamilton Rating Scale for depression in assessing major depressive disorder.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib23.4.1">Frontiers in Psychiatry</em> 12 (2021), 747139.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib24">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Naseem et al<span class="ltx_text" id="bib.bib24.2.2.1">.</span> (2022)</span>
<span class="ltx_bibblock">
Usman Naseem, Adam G Dunn, Jinman Kim, and Matloob Khushi. 2022.

</span>
<span class="ltx_bibblock">Early identification of depression severity levels on reddit using ordinal classification. In <em class="ltx_emph ltx_font_italic" id="bib.bib24.3.1">Proceedings of the ACM Web Conference 2022</em>. 2563–2572.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib25">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Nepal et al<span class="ltx_text" id="bib.bib25.2.2.1">.</span> (2024)</span>
<span class="ltx_bibblock">
Subigya Nepal, Arvind Pillai, Weichen Wang, Tess Griffin, Amanda C Collins, Michael Heinz, Damien Lekkas, Shayan Mirjafari, Matthew Nemesure, George Price, et al<span class="ltx_text" id="bib.bib25.3.1">.</span> 2024.

</span>
<span class="ltx_bibblock">MoodCapture: Depression Detection Using In-the-Wild Smartphone Images. In <em class="ltx_emph ltx_font_italic" id="bib.bib25.4.1">Proceedings of the CHI Conference on Human Factors in Computing Systems</em>. 1–18.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib26">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Niu et al<span class="ltx_text" id="bib.bib26.2.2.1">.</span> (2021)</span>
<span class="ltx_bibblock">
Meng Niu, Kai Chen, Qingcai Chen, and Lufeng Yang. 2021.

</span>
<span class="ltx_bibblock">Hcag: A hierarchical context-aware graph attention model for depression detection. In <em class="ltx_emph ltx_font_italic" id="bib.bib26.3.1">Proceedings of 2021 IEEE International Conference on Acoustics, Speech and Signal Processing (ICASSP)</em>. IEEE, 4235–4239.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib27">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Organization et al<span class="ltx_text" id="bib.bib27.2.2.1">.</span> (2017)</span>
<span class="ltx_bibblock">
World Health Organization et al<span class="ltx_text" id="bib.bib27.3.1">.</span> 2017.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib27.4.1">Depression and other common mental disorders: global health estimates</em>.

</span>
<span class="ltx_bibblock">Technical Report. World Health Organization.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib28">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Pirina and Çöltekin (2018)</span>
<span class="ltx_bibblock">
Inna Pirina and Çağrı Çöltekin. 2018.

</span>
<span class="ltx_bibblock">Identifying Depression on Reddit: The Effect of Training Data. In <em class="ltx_emph ltx_font_italic" id="bib.bib28.1.1">Proceedings of the 2018 EMNLP Workshop SMM4H: The 3rd Social Media Mining for Health Applications Workshop &amp; Shared Task</em>, Graciela Gonzalez-Hernandez, Davy Weissenbacher, Abeed Sarker, and Michael Paul (Eds.). Association for Computational Linguistics, Brussels, Belgium, 9–12.

</span>
<span class="ltx_bibblock">
<a class="ltx_ref ltx_url ltx_font_typewriter" href="https://doi.org/10.18653/v1/W18-5903" title="">https://doi.org/10.18653/v1/W18-5903</a>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib29">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Qin et al<span class="ltx_text" id="bib.bib29.2.2.1">.</span> (2023)</span>
<span class="ltx_bibblock">
Wei Qin, Zetong Chen, Lei Wang, Yunshi Lan, Weijieying Ren, and Richang Hong. 2023.

</span>
<span class="ltx_bibblock">Read, diagnose and chat: Towards explainable and interactive LLMs-augmented depression detection in social media.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib29.3.1">arXiv preprint arXiv:2305.05138</em> (2023).

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib30">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Qiu et al<span class="ltx_text" id="bib.bib30.2.2.1">.</span> (2023)</span>
<span class="ltx_bibblock">
Huachuan Qiu, Hongliang He, Shuai Zhang, Anqi Li, and Zhenzhong Lan. 2023.

</span>
<span class="ltx_bibblock">Smile: Single-turn to multi-turn inclusive language expansion via chatgpt for mental health support.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib30.3.1">arXiv preprint arXiv:2305.00450</em> (2023).

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib31">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Sadeghi et al<span class="ltx_text" id="bib.bib31.2.2.1">.</span> (2023)</span>
<span class="ltx_bibblock">
Misha Sadeghi, Bernhard Egger, Reza Agahi, Robert Richer, Klara Capito, Lydia Helene Rupp, Lena Schindler-Gmelch, Matthias Berking, and Bjoern M Eskofier. 2023.

</span>
<span class="ltx_bibblock">Exploring the capabilities of a language model-only approach for depression detection in text data. In <em class="ltx_emph ltx_font_italic" id="bib.bib31.3.1">Proceedings of 2023 IEEE EMBS International Conference on Biomedical and Health Informatics (BHI)</em>. IEEE, 1–5.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib32">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Saggu et al<span class="ltx_text" id="bib.bib32.2.2.1">.</span> (2022)</span>
<span class="ltx_bibblock">
Guramritpal Singh Saggu, Keshav Gupta, KV Arya, and Ciro Rodriguez Rodriguez. 2022.

</span>
<span class="ltx_bibblock">Depressnet: A multimodal hierarchical attention mechanism approach for depression detection.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib32.3.1">Int. J. Eng. Sci</em> 15, 1 (2022), 24–32.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib33">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Shao et al<span class="ltx_text" id="bib.bib33.2.2.1">.</span> (2023)</span>
<span class="ltx_bibblock">
Yunfan Shao, Linyang Li, Junqi Dai, and Xipeng Qiu. 2023.

</span>
<span class="ltx_bibblock">Character-llm: A trainable agent for role-playing.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib33.3.1">arXiv preprint arXiv:2310.10158</em> (2023).

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib34">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Sood et al<span class="ltx_text" id="bib.bib34.2.2.1">.</span> (2023)</span>
<span class="ltx_bibblock">
Palak Sood, Xinming Yang, and Ping Wang. 2023.

</span>
<span class="ltx_bibblock">Enhancing Depression Detection from Narrative Interviews Using Language Models. In <em class="ltx_emph ltx_font_italic" id="bib.bib34.3.1">Proceedings of 2023 IEEE International Conference on Bioinformatics and Biomedicine (BIBM)</em>. IEEE, 3173–3180.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib35">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Stankevich et al<span class="ltx_text" id="bib.bib35.2.2.1">.</span> (2018)</span>
<span class="ltx_bibblock">
Maxim Stankevich, Vadim Isakov, Dmitry Devyatkin, and Ivan V Smirnov. 2018.

</span>
<span class="ltx_bibblock">Feature Engineering for Depression Detection in Social Media. In <em class="ltx_emph ltx_font_italic" id="bib.bib35.3.1">Proceedings of 7th International Conference on Pattern Recognition Applications and Methods (ICPRAM)</em>. 426–431.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib36">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Touvron et al<span class="ltx_text" id="bib.bib36.2.2.1">.</span> (2023)</span>
<span class="ltx_bibblock">
Hugo Touvron, Louis Martin, Kevin Stone, Peter Albert, Amjad Almahairi, Yasmine Babaei, Nikolay Bashlykov, Soumya Batra, Prajjwal Bhargava, Shruti Bhosale, et al<span class="ltx_text" id="bib.bib36.3.1">.</span> 2023.

</span>
<span class="ltx_bibblock">Llama 2: Open foundation and fine-tuned chat models.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib36.4.1">arXiv preprint arXiv:2307.09288</em> (2023).

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib37">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Uddin et al<span class="ltx_text" id="bib.bib37.2.2.1">.</span> (2022)</span>
<span class="ltx_bibblock">
Md Azher Uddin, Joolekha Bibi Joolee, and Kyung-Ah Sohn. 2022.

</span>
<span class="ltx_bibblock">Deep multi-modal network based automated depression severity estimation.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib37.3.1">IEEE Transactions on Affective Computing</em> 14, 3 (2022), 2153–2167.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib38">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Wang et al<span class="ltx_text" id="bib.bib38.2.2.1">.</span> (2023)</span>
<span class="ltx_bibblock">
Lei Wang, Wanyu Xu, Yihuai Lan, Zhiqiang Hu, Yunshi Lan, Roy Ka-Wei Lee, and Ee-Peng Lim. 2023.

</span>
<span class="ltx_bibblock">Plan-and-solve prompting: Improving zero-shot chain-of-thought reasoning by large language models.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib38.3.1">arXiv preprint arXiv:2305.04091</em> (2023).

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib39">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Wei et al<span class="ltx_text" id="bib.bib39.2.2.1">.</span> (2022)</span>
<span class="ltx_bibblock">
Jason Wei, Xuezhi Wang, Dale Schuurmans, Maarten Bosma, Fei Xia, Ed Chi, Quoc V Le, Denny Zhou, et al<span class="ltx_text" id="bib.bib39.3.1">.</span> 2022.

</span>
<span class="ltx_bibblock">Chain-of-thought prompting elicits reasoning in large language models.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib39.4.1">Advances in Neural Information Processing Systems</em> 35 (2022), 24824–24837.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib40">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Widiger and Clark (2000)</span>
<span class="ltx_bibblock">
Thomas A Widiger and Lee Anna Clark. 2000.

</span>
<span class="ltx_bibblock">Toward DSM—V and the classification of psychopathology.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib40.1.1">Psychological Bulletin</em> 126, 6 (2000), 946.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib41">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Wu et al<span class="ltx_text" id="bib.bib41.2.2.1">.</span> (2022)</span>
<span class="ltx_bibblock">
Wen Wu, Mengyue Wu, and Kai Yu. 2022.

</span>
<span class="ltx_bibblock">Climate and weather: Inspecting depression detection via emotion recognition. In <em class="ltx_emph ltx_font_italic" id="bib.bib41.3.1">Proceedings of 2022 IEEE International Conference on Acoustics, Speech and Signal Processing (ICASSP)</em>. IEEE, 6262–6266.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib42">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Xu et al<span class="ltx_text" id="bib.bib42.2.2.1">.</span> (2024)</span>
<span class="ltx_bibblock">
Xuhai Xu, Bingsheng Yao, Yuanzhe Dong, Saadia Gabriel, Hong Yu, James Hendler, Marzyeh Ghassemi, Anind K Dey, and Dakuo Wang. 2024.

</span>
<span class="ltx_bibblock">Mental-llm: Leveraging large language models for mental health prediction via online text data. In <em class="ltx_emph ltx_font_italic" id="bib.bib42.3.1">Proceedings of the ACM on Interactive, Mobile, Wearable and Ubiquitous Technologies</em>. 1–32.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib43">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Yang et al<span class="ltx_text" id="bib.bib43.2.2.1">.</span> (2023)</span>
<span class="ltx_bibblock">
Aiyuan Yang, Bin Xiao, Bingning Wang, Borong Zhang, Ce Bian, Chao Yin, Chenxu Lv, Da Pan, Dian Wang, Dong Yan, et al<span class="ltx_text" id="bib.bib43.3.1">.</span> 2023.

</span>
<span class="ltx_bibblock">Baichuan 2: Open large-scale language models.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib43.4.1">arXiv preprint arXiv:2309.10305</em> (2023).

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib44">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Yang et al<span class="ltx_text" id="bib.bib44.2.2.1">.</span> (2024b)</span>
<span class="ltx_bibblock">
Kailai Yang, Tianlin Zhang, Ziyan Kuang, Qianqian Xie, Jimin Huang, and Sophia Ananiadou. 2024b.

</span>
<span class="ltx_bibblock">MentaLLaMA: interpretable mental health analysis on social media with large language models. In <em class="ltx_emph ltx_font_italic" id="bib.bib44.3.1">Proceedings of the ACM on Web Conference 2024</em>. 4489–4500.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib45">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Yang et al<span class="ltx_text" id="bib.bib45.2.2.1">.</span> (2016)</span>
<span class="ltx_bibblock">
Le Yang, Dongmei Jiang, Lang He, Ercheng Pei, Meshia Cédric Oveneke, and Hichem Sahli. 2016.

</span>
<span class="ltx_bibblock">Decision tree based depression classification from audio video and language information. In <em class="ltx_emph ltx_font_italic" id="bib.bib45.3.1">Proceedings of the 6th International Workshop on Audio/Visual Emotion Challenge</em>. 89–96.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib46">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Yang et al<span class="ltx_text" id="bib.bib46.2.2.1">.</span> (2024a)</span>
<span class="ltx_bibblock">
Qu Yang, Mang Ye, and Bo Du. 2024a.

</span>
<span class="ltx_bibblock">EmoLLM: Multimodal Emotional Understanding Meets Large Language Models.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib46.3.1">arXiv preprint arXiv:2406.16442</em> (2024).

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib47">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Zhang et al<span class="ltx_text" id="bib.bib47.2.2.1">.</span> (2021)</span>
<span class="ltx_bibblock">
Pingyue Zhang, Mengyue Wu, Heinrich Dinkel, and Kai Yu. 2021.

</span>
<span class="ltx_bibblock">Depa: Self-supervised audio embedding for depression detection. In <em class="ltx_emph ltx_font_italic" id="bib.bib47.3.1">Proceedings of the 29th ACM International Conference on Multimedia</em>. 135–143.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib48">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Zhang et al<span class="ltx_text" id="bib.bib48.2.2.1">.</span> (2022a)</span>
<span class="ltx_bibblock">
Zhiling Zhang, Siyuan Chen, Mengyue Wu, and Kenny Q. Zhu. 2022a.

</span>
<span class="ltx_bibblock">Psychiatric Scale Guided Risky Post Screening for Early Detection of Depression. In <em class="ltx_emph ltx_font_italic" id="bib.bib48.3.1">Proceedings of the 31th International Joint Conference on Artificial Intelligence (IJCAI)</em>, Lud De Raedt (Ed.). International Joint Conferences on Artificial Intelligence Organization, 5220–5226.

</span>
<span class="ltx_bibblock">
</span>
<span class="ltx_bibblock">AI for Good.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib49">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Zhang et al<span class="ltx_text" id="bib.bib49.2.2.1">.</span> (2022b)</span>
<span class="ltx_bibblock">
Zhuosheng Zhang, Aston Zhang, Mu Li, and Alex Smola. 2022b.

</span>
<span class="ltx_bibblock">Automatic chain of thought prompting in large language models.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib49.3.1">arXiv preprint arXiv:2210.03493</em> (2022).

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib50">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Zhou et al<span class="ltx_text" id="bib.bib50.2.2.1">.</span> (2023)</span>
<span class="ltx_bibblock">
Jinfeng Zhou, Zhuang Chen, Dazhen Wan, Bosi Wen, Yi Song, Jifan Yu, Yongkang Huang, Libiao Peng, Jiaming Yang, Xiyao Xiao, et al<span class="ltx_text" id="bib.bib50.3.1">.</span> 2023.

</span>
<span class="ltx_bibblock">Characterglm: Customizing Chinese conversational ai characters with large language models.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib50.4.1">arXiv preprint arXiv:2311.16832</em> (2023).

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib51">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Zhou et al<span class="ltx_text" id="bib.bib51.2.2.1">.</span> (2022)</span>
<span class="ltx_bibblock">
Zhiyuan Zhou, Yanrong Guo, Shijie Hao, and Richang Hong. 2022.

</span>
<span class="ltx_bibblock">Hierarchical multifeature fusion via audio-response-level modeling for depression detection.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib51.3.1">IEEE Transactions on Computational Social Systems</em> 10, 5 (2022), 2797–2805.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib52">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Zou et al<span class="ltx_text" id="bib.bib52.2.2.1">.</span> (2022)</span>
<span class="ltx_bibblock">
Bochao Zou, Jiali Han, Yingxue Wang, Rui Liu, Shenghui Zhao, Lei Feng, Xiangwen Lyu, and Huimin Ma. 2022.

</span>
<span class="ltx_bibblock">Semi-structural interview-based Chinese multimodal depression corpus towards automatic preliminary screening of depressive disorders.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib52.3.1">IEEE Transactions on Affective Computing</em> 14, 4 (2022), 2823–2838.

</span>
<span class="ltx_bibblock">
</span>
</li>
</ul>
</section>
<section class="ltx_appendix" id="A1">
<h2 class="ltx_title ltx_title_appendix">
<span class="ltx_tag ltx_tag_appendix">Appendix A </span>Appendix</h2>
<div class="ltx_para" id="A1.p1">
<p class="ltx_p" id="A1.p1.1">Here we present the usage of the InterMind system interface in different language versions (English and Chinese). Figure <a class="ltx_ref" href="https://arxiv.org/html/2409.14878v1#A1.F11" title="Figure 11 ‣ Appendix A Appendix ‣ InterMind: A Doctor-Patient-Family Interactive Depression Assessment System Empowered by Large Language Models"><span class="ltx_text ltx_ref_tag">11</span></a>, <a class="ltx_ref" href="https://arxiv.org/html/2409.14878v1#A1.F12" title="Figure 12 ‣ Appendix A Appendix ‣ InterMind: A Doctor-Patient-Family Interactive Depression Assessment System Empowered by Large Language Models"><span class="ltx_text ltx_ref_tag">12</span></a> and <a class="ltx_ref" href="https://arxiv.org/html/2409.14878v1#A1.F13" title="Figure 13 ‣ Appendix A Appendix ‣ InterMind: A Doctor-Patient-Family Interactive Depression Assessment System Empowered by Large Language Models"><span class="ltx_text ltx_ref_tag">13</span></a> show a comparison of different language versions of the user interfaces for patient, family, and doctor, respectively. Figure <a class="ltx_ref" href="https://arxiv.org/html/2409.14878v1#A1.F14" title="Figure 14 ‣ Appendix A Appendix ‣ InterMind: A Doctor-Patient-Family Interactive Depression Assessment System Empowered by Large Language Models"><span class="ltx_text ltx_ref_tag">14</span></a> shows a comparison of different language versions of the cyclical analysis interface.
Figure <a class="ltx_ref" href="https://arxiv.org/html/2409.14878v1#A1.F15" title="Figure 15 ‣ Appendix A Appendix ‣ InterMind: A Doctor-Patient-Family Interactive Depression Assessment System Empowered by Large Language Models"><span class="ltx_text ltx_ref_tag">15</span></a> and <a class="ltx_ref" href="https://arxiv.org/html/2409.14878v1#A1.F16" title="Figure 16 ‣ Appendix A Appendix ‣ InterMind: A Doctor-Patient-Family Interactive Depression Assessment System Empowered by Large Language Models"><span class="ltx_text ltx_ref_tag">16</span></a> show the entire generated assistive diagnostic report.</p>
</div>
<figure class="ltx_figure" id="A1.F11">
<div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_2"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_figure_panel ltx_img_square" height="570" id="A1.F11.g1" src="extracted/5872729/11.png" width="479"/></div>
</div>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 11. </span>Comparison of different language versions of the user interface for patient</figcaption><div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_1"><span class="ltx_ERROR ltx_centering ltx_figure_panel undefined" id="A1.F11.1">\Description</span></div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_1">
<p class="ltx_p ltx_figure_panel ltx_align_center" id="A1.F11.2">This figure shows a comparison of different language versions of the user interface for patients.</p>
</div>
</div>
</figure>
<figure class="ltx_figure" id="A1.F12">
<div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_2"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_figure_panel ltx_img_portrait" height="595" id="A1.F12.g1" src="extracted/5872729/12.png" width="479"/></div>
</div>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 12. </span>Comparison of different language versions of the user interface for family</figcaption><div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_1"><span class="ltx_ERROR ltx_centering ltx_figure_panel undefined" id="A1.F12.1">\Description</span></div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_1">
<p class="ltx_p ltx_figure_panel ltx_align_center" id="A1.F12.2">This figure shows a comparison of different language versions of the user interface for family.</p>
</div>
</div>
</figure>
<figure class="ltx_figure" id="A1.F13">
<div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_2"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_figure_panel ltx_img_square" height="619" id="A1.F13.g1" src="extracted/5872729/13.png" width="598"/></div>
</div>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 13. </span>Comparison of different language versions of the user interface for doctor</figcaption><div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_1"><span class="ltx_ERROR ltx_centering ltx_figure_panel undefined" id="A1.F13.1">\Description</span></div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_1">
<p class="ltx_p ltx_figure_panel ltx_align_center" id="A1.F13.2">This figure shows a comparison of different language versions of the user interface for doctors.</p>
</div>
</div>
</figure>
<figure class="ltx_figure" id="A1.F14">
<div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_2"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_figure_panel ltx_img_square" height="616" id="A1.F14.g1" src="extracted/5872729/14.png" width="598"/></div>
</div>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 14. </span>Comparison of different language versions of cyclical analysis interface</figcaption><div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_1"><span class="ltx_ERROR ltx_centering ltx_figure_panel undefined" id="A1.F14.1">\Description</span></div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_1">
<p class="ltx_p ltx_figure_panel ltx_align_center" id="A1.F14.2">This figure shows a comparison of different language versions of the cyclical analysis interface.</p>
</div>
</div>
</figure>
<figure class="ltx_figure" id="A1.F15">
<div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_2"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_figure_panel ltx_img_portrait" height="711" id="A1.F15.g1" src="extracted/5872729/15.png" width="479"/></div>
</div>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 15. </span>Generated Assistive Diagnostic Report Case 1</figcaption><div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_1"><span class="ltx_ERROR ltx_centering ltx_figure_panel undefined" id="A1.F15.1">\Description</span></div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_1">
<p class="ltx_p ltx_figure_panel ltx_align_center" id="A1.F15.2">This figure shows an example of generated assistive diagnostic report case 1.</p>
</div>
</div>
</figure>
<figure class="ltx_figure" id="A1.F16">
<div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_2"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_figure_panel ltx_img_portrait" height="699" id="A1.F16.g1" src="extracted/5872729/16.png" width="479"/></div>
</div>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 16. </span>Generated Assistive Diagnostic Report Case 2</figcaption><div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_1"><span class="ltx_ERROR ltx_centering ltx_figure_panel undefined" id="A1.F16.1">\Description</span></div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_1">
<p class="ltx_p ltx_figure_panel ltx_align_center" id="A1.F16.2">This figure shows an example of generated assistive diagnostic report case 2.</p>
</div>
</div>
</figure>
</section>
</article>
</div>
<footer class="ltx_page_footer">
<div class="ltx_page_logo">Generated  on Mon Sep 23 10:22:43 2024 by <a class="ltx_LaTeXML_logo" href="http://dlmf.nist.gov/LaTeXML/"><span style="letter-spacing:-0.2em; margin-right:0.1em;">L<span class="ltx_font_smallcaps" style="position:relative; bottom:2.2pt;">a</span>T<span class="ltx_font_smallcaps" style="font-size:120%;position:relative; bottom:-0.2ex;">e</span></span><span style="font-size:90%; position:relative; bottom:-0.2ex;">XML</span><img alt="Mascot Sammy" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAsAAAAOCAYAAAD5YeaVAAAAAXNSR0IArs4c6QAAAAZiS0dEAP8A/wD/oL2nkwAAAAlwSFlzAAALEwAACxMBAJqcGAAAAAd0SU1FB9wKExQZLWTEaOUAAAAddEVYdENvbW1lbnQAQ3JlYXRlZCB3aXRoIFRoZSBHSU1Q72QlbgAAAdpJREFUKM9tkL+L2nAARz9fPZNCKFapUn8kyI0e4iRHSR1Kb8ng0lJw6FYHFwv2LwhOpcWxTjeUunYqOmqd6hEoRDhtDWdA8ApRYsSUCDHNt5ul13vz4w0vWCgUnnEc975arX6ORqN3VqtVZbfbTQC4uEHANM3jSqXymFI6yWazP2KxWAXAL9zCUa1Wy2tXVxheKA9YNoR8Pt+aTqe4FVVVvz05O6MBhqUIBGk8Hn8HAOVy+T+XLJfLS4ZhTiRJgqIoVBRFIoric47jPnmeB1mW/9rr9ZpSSn3Lsmir1fJZlqWlUonKsvwWwD8ymc/nXwVBeLjf7xEKhdBut9Hr9WgmkyGEkJwsy5eHG5vN5g0AKIoCAEgkEkin0wQAfN9/cXPdheu6P33fBwB4ngcAcByHJpPJl+fn54mD3Gg0NrquXxeLRQAAwzAYj8cwTZPwPH9/sVg8PXweDAauqqr2cDjEer1GJBLBZDJBs9mE4zjwfZ85lAGg2+06hmGgXq+j3+/DsixYlgVN03a9Xu8jgCNCyIegIAgx13Vfd7vdu+FweG8YRkjXdWy329+dTgeSJD3ieZ7RNO0VAXAPwDEAO5VKndi2fWrb9jWl9Esul6PZbDY9Go1OZ7PZ9z/lyuD3OozU2wAAAABJRU5ErkJggg=="/></a>
</div></footer>
</div>
</body>
</html>
