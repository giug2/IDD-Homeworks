<!DOCTYPE html><html lang="en">
<head>
<meta http-equiv="content-type" content="text/html; charset=UTF-8">
<title>[2111.10192] An Expectation-Maximization Perspective on Federated Learning</title><meta property="og:description" content="Federated learning describes the distributed training of models across multiple clients while keeping the data private on-device. In this work, we view the server-orchestrated federated learning process as a hierarchic…">
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="An Expectation-Maximization Perspective on Federated Learning">
<meta name="twitter:image:src" content="https://ar5iv.labs.arxiv.org/assets/ar5iv_card.png">
<meta name="twitter:image:alt" content="ar5iv logo">
<meta property="og:title" content="An Expectation-Maximization Perspective on Federated Learning">
<meta property="og:site_name" content="ar5iv">
<meta property="og:image" content="https://ar5iv.labs.arxiv.org/assets/ar5iv_card.png">
<meta property="og:type" content="article">
<meta property="og:url" content="https://ar5iv.labs.arxiv.org/html/2111.10192">

<!--Generated on Sat Mar  2 05:39:48 2024 by LaTeXML (version 0.8.8) http://dlmf.nist.gov/LaTeXML/.-->
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

<script>
  function detectColorScheme(){
    var theme="light";
    var current_theme = localStorage.getItem("ar5iv_theme");
    if(current_theme){
      if(current_theme == "dark"){
        theme = "dark";
      } }
    else if(!window.matchMedia) { return false; }
    else if(window.matchMedia("(prefers-color-scheme: dark)").matches) {
      theme = "dark"; }
    if (theme=="dark") {
      document.documentElement.setAttribute("data-theme", "dark");
    } else {
      document.documentElement.setAttribute("data-theme", "light"); } }

  detectColorScheme();

  function toggleColorScheme(){
    var current_theme = localStorage.getItem("ar5iv_theme");
    if (current_theme) {
      if (current_theme == "light") {
        localStorage.setItem("ar5iv_theme", "dark"); }
      else {
        localStorage.setItem("ar5iv_theme", "light"); } }
    else {
        localStorage.setItem("ar5iv_theme", "dark"); }
    detectColorScheme(); }
</script>
<link media="all" rel="stylesheet" href="/assets/ar5iv-fonts.0.8.0.min.css"><link media="all" rel="stylesheet" href="/assets/ar5iv.0.8.0.min.css"><link media="all" rel="stylesheet" href="/assets/ar5iv-site.0.2.2.css">
</head>
<body>
<div class="ltx_page_main">
<div class="ltx_page_content">
<article class="ltx_document ltx_authors_1line">
<div id="p1" class="ltx_para">
<span id="p1.1" class="ltx_ERROR undefined">\newcites</span>
<p id="p1.2" class="ltx_p">appendixReferences</p>
</div>
<h1 class="ltx_title ltx_title_document">An Expectation-Maximization Perspective on Federated Learning</h1>
<div class="ltx_authors">
<span class="ltx_creator ltx_role_author">
<span class="ltx_personname">Christos Louizos<sup id="id7.7.id1" class="ltx_sup">‡</sup>, Matthias Reisser<sup id="id8.8.id2" class="ltx_sup">‡</sup>, Joseph Soriaga<sup id="id9.9.id3" class="ltx_sup">‡</sup>, Max Welling<sup id="id10.10.id4" class="ltx_sup">†</sup>
<br class="ltx_break"><sup id="id11.11.id5" class="ltx_sup">‡</sup>Qualcomm AI Research ,  <sup id="id12.12.id6" class="ltx_sup">†</sup>University of Amsterdam
<br class="ltx_break"><span id="id13.13.id7" class="ltx_text ltx_font_typewriter">{clouizos,mreisser,jsoriaga}@qti.qualcomm.com</span>, <span id="id14.14.id8" class="ltx_text ltx_font_typewriter">m.welling@uva.nl</span>
</span><span class="ltx_author_notes">Qualcomm AI Research is an initiative of Qualcomm Technologies, Inc. and/or its subsidiaries.</span></span>
</div>

<div class="ltx_abstract">
<h6 class="ltx_title ltx_title_abstract">Abstract</h6>
<p id="id15.id1" class="ltx_p">Federated learning describes the distributed training of models across multiple clients while keeping the data private on-device. In this work, we view the server-orchestrated federated learning process as a hierarchical latent variable model where the server provides the parameters of a prior distribution over the client-specific model parameters. We show that with simple Gaussian priors and a <em id="id15.id1.1" class="ltx_emph ltx_font_italic">hard</em> version of the well known Expectation-Maximization (EM) algorithm, learning in such a model corresponds to <span id="id15.id1.2" class="ltx_text ltx_font_typewriter">FedAvg</span>, the most popular algorithm for the federated learning setting. This perspective on <span id="id15.id1.3" class="ltx_text ltx_font_typewriter">FedAvg</span> unifies several recent works in the field and opens up the possibility for extensions through different choices for the hierarchical model. Based on this view, we further propose a variant of the hierarchical model that employs prior distributions to promote sparsity. By similarly using the hard-EM algorithm for learning, we obtain <span id="id15.id1.4" class="ltx_text ltx_font_typewriter">FedSparse</span>, a procedure that can learn sparse neural networks in the federated learning setting. <span id="id15.id1.5" class="ltx_text ltx_font_typewriter">FedSparse</span> reduces communication costs from client to server and vice-versa, as well as the computational costs for inference with the sparsified network – both of which are of great practical importance in federated learning.</p>
</div>
<section id="S1" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">1 </span>Introduction</h2>

<div id="S1.p1" class="ltx_para">
<p id="S1.p1.1" class="ltx_p">Smart devices have become ubiquitous in today’s world and are generating large amounts of potentially sensitive data. Traditionally, such data is transmitted and stored in a central location for training machine learning models. Such methods rightly raise privacy concerns, and we seek the means for training powerful models, such as neural networks, without the need to transmit potentially sensitive data. To this end, Federated Learning (FL) <cite class="ltx_cite ltx_citemacro_citep">[<a href="#bib.bib22" title="" class="ltx_ref">22</a>]</cite> has been proposed to train global machine learning models without the need for participating devices to transmit their data to the server. The Federated Averaging (<span id="S1.p1.1.1" class="ltx_text ltx_font_typewriter">FedAvg</span>) <cite class="ltx_cite ltx_citemacro_citep">[<a href="#bib.bib22" title="" class="ltx_ref">22</a>]</cite> algorithm communicates the parameters of the machine learning model instead of the data itself, which is a more private means of communication.</p>
</div>
<div id="S1.p2" class="ltx_para">
<p id="S1.p2.1" class="ltx_p">In this work, we adopt a perspective on server-orchestrated federated learning through the lens of a simple hierarchical latent variable model; the server provides the parameters of a prior distribution over the client-specific neural network parameters, which are subsequently used to “explain” the client-specific dataset. A visualization of this graphical model can be seen in Figure <a href="#S1.F2" title="Figure 2 ‣ 1 Introduction ‣ An Expectation-Maximization Perspective on Federated Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">2</span></a>. We show that when the server provides a Gaussian prior over these parameters, learning with the <em id="S1.p2.1.1" class="ltx_emph ltx_font_italic">hard</em> version of the Expectation-Maximization (EM) algorithm will yield the <span id="S1.p2.1.2" class="ltx_text ltx_font_typewriter">FedAvg</span> procedure. This view of <span id="S1.p2.1.3" class="ltx_text ltx_font_typewriter">FedAvg</span> has several interesting consequences, as it connects several recent works in federated learning and bridges <span id="S1.p2.1.4" class="ltx_text ltx_font_typewriter">FedAvg</span> with meta-learning.</p>
</div>
<div id="S1.p3" class="ltx_para">
<p id="S1.p3.1" class="ltx_p">Furthermore, this view of federated learning provides a good basis for developing several extensions to the vanilla <span id="S1.p3.1.1" class="ltx_text ltx_font_typewriter">FedAvg</span> algorithm by appropriately changing the hierarchical model. Through this perspective, we develop <span id="S1.p3.1.2" class="ltx_text ltx_font_typewriter">FedSparse</span> by extending the graphical model to the one in Figure <a href="#S1.F2" title="Figure 2 ‣ 1 Introduction ‣ An Expectation-Maximization Perspective on Federated Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">2</span></a>. <span id="S1.p3.1.3" class="ltx_text ltx_font_typewriter">FedSparse</span> allows for learning sparse neural network models at the client and server via a careful choice of the priors within the hierarchical model.</p>
</div>
<figure id="S1.F2" class="ltx_figure">
<div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_2">
<figure id="S1.F2.5" class="ltx_figure ltx_figure_panel ltx_minipage ltx_align_center ltx_align_middle" style="width:173.4pt;"><svg id="S1.F2.1.pic1" class="ltx_picture" height="121.31" overflow="visible" version="1.1" width="106.16"><g transform="translate(0,121.31) matrix(1 0 0 -1 0 0) translate(86.88,0) translate(0,34.44)" fill="#000000" stroke="#000000" stroke-width="0.4pt"><g stroke="#000000" fill="#DFDFDF"><path d="M 13.84 0 C 13.84 7.64 7.64 13.84 0 13.84 C -7.64 13.84 -13.84 7.64 -13.84 0 C -13.84 -7.64 -7.64 -13.84 0 -13.84 C 7.64 -13.84 13.84 -7.64 13.84 0 Z M 0 0"></path></g><g transform="matrix(1.0 0.0 0.0 1.0 -7.74 -3.89)" fill="#000000" stroke="#000000"><foreignObject width="15.47" height="11.12" transform="matrix(1 0 0 -1 0 16.6)" overflow="visible"><math id="S1.F2.1.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.m1.1" class="ltx_Math" alttext="D_{s}" display="inline"><semantics id="S1.F2.1.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.m1.1a"><msub id="S1.F2.1.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.m1.1.1" xref="S1.F2.1.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.m1.1.1.cmml"><mi id="S1.F2.1.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.m1.1.1.2" xref="S1.F2.1.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.m1.1.1.2.cmml">D</mi><mi id="S1.F2.1.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.m1.1.1.3" xref="S1.F2.1.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.m1.1.1.3.cmml">s</mi></msub><annotation-xml encoding="MathML-Content" id="S1.F2.1.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.m1.1b"><apply id="S1.F2.1.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.m1.1.1.cmml" xref="S1.F2.1.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.m1.1.1"><csymbol cd="ambiguous" id="S1.F2.1.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.m1.1.1.1.cmml" xref="S1.F2.1.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.m1.1.1">subscript</csymbol><ci id="S1.F2.1.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.m1.1.1.2.cmml" xref="S1.F2.1.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.m1.1.1.2">𝐷</ci><ci id="S1.F2.1.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.m1.1.1.3.cmml" xref="S1.F2.1.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.m1.1.1.3">𝑠</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S1.F2.1.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.m1.1c">D_{s}</annotation></semantics></math></foreignObject></g><g fill="#FFFFFF" stroke="#000000"><path d="M -53.76 0 C -53.76 7.64 -59.96 13.84 -67.6 13.84 C -75.24 13.84 -81.43 7.64 -81.43 0 C -81.43 -7.64 -75.24 -13.84 -67.6 -13.84 C -59.96 -13.84 -53.76 -7.64 -53.76 0 Z M -67.6 0"></path></g><g transform="matrix(1.0 0.0 0.0 1.0 -73.54 -3.46)" fill="#000000" stroke="#000000"><foreignObject width="11.88" height="12.3" transform="matrix(1 0 0 -1 0 16.6)" overflow="visible"><math id="S1.F2.1.pic1.2.2.2.2.2.2.2.2.2.2.2.2.1.1.1.1.1.1.1.1.1.1.1.m1.1" class="ltx_Math" alttext="\bm{\phi}_{s}" display="inline"><semantics id="S1.F2.1.pic1.2.2.2.2.2.2.2.2.2.2.2.2.1.1.1.1.1.1.1.1.1.1.1.m1.1a"><msub id="S1.F2.1.pic1.2.2.2.2.2.2.2.2.2.2.2.2.1.1.1.1.1.1.1.1.1.1.1.m1.1.1" xref="S1.F2.1.pic1.2.2.2.2.2.2.2.2.2.2.2.2.1.1.1.1.1.1.1.1.1.1.1.m1.1.1.cmml"><mi class="ltx_mathvariant_bold-italic" mathvariant="bold-italic" id="S1.F2.1.pic1.2.2.2.2.2.2.2.2.2.2.2.2.1.1.1.1.1.1.1.1.1.1.1.m1.1.1.2" xref="S1.F2.1.pic1.2.2.2.2.2.2.2.2.2.2.2.2.1.1.1.1.1.1.1.1.1.1.1.m1.1.1.2.cmml">ϕ</mi><mi id="S1.F2.1.pic1.2.2.2.2.2.2.2.2.2.2.2.2.1.1.1.1.1.1.1.1.1.1.1.m1.1.1.3" xref="S1.F2.1.pic1.2.2.2.2.2.2.2.2.2.2.2.2.1.1.1.1.1.1.1.1.1.1.1.m1.1.1.3.cmml">s</mi></msub><annotation-xml encoding="MathML-Content" id="S1.F2.1.pic1.2.2.2.2.2.2.2.2.2.2.2.2.1.1.1.1.1.1.1.1.1.1.1.m1.1b"><apply id="S1.F2.1.pic1.2.2.2.2.2.2.2.2.2.2.2.2.1.1.1.1.1.1.1.1.1.1.1.m1.1.1.cmml" xref="S1.F2.1.pic1.2.2.2.2.2.2.2.2.2.2.2.2.1.1.1.1.1.1.1.1.1.1.1.m1.1.1"><csymbol cd="ambiguous" id="S1.F2.1.pic1.2.2.2.2.2.2.2.2.2.2.2.2.1.1.1.1.1.1.1.1.1.1.1.m1.1.1.1.cmml" xref="S1.F2.1.pic1.2.2.2.2.2.2.2.2.2.2.2.2.1.1.1.1.1.1.1.1.1.1.1.m1.1.1">subscript</csymbol><ci id="S1.F2.1.pic1.2.2.2.2.2.2.2.2.2.2.2.2.1.1.1.1.1.1.1.1.1.1.1.m1.1.1.2.cmml" xref="S1.F2.1.pic1.2.2.2.2.2.2.2.2.2.2.2.2.1.1.1.1.1.1.1.1.1.1.1.m1.1.1.2">bold-italic-ϕ</ci><ci id="S1.F2.1.pic1.2.2.2.2.2.2.2.2.2.2.2.2.1.1.1.1.1.1.1.1.1.1.1.m1.1.1.3.cmml" xref="S1.F2.1.pic1.2.2.2.2.2.2.2.2.2.2.2.2.1.1.1.1.1.1.1.1.1.1.1.m1.1.1.3">𝑠</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S1.F2.1.pic1.2.2.2.2.2.2.2.2.2.2.2.2.1.1.1.1.1.1.1.1.1.1.1.m1.1c">\bm{\phi}_{s}</annotation></semantics></math></foreignObject></g><g fill="#FFFFFF" stroke="#000000"><path d="M -53.88 67.6 L -67.6 81.32 L -81.32 67.6 L -67.6 53.88 Z"></path></g><g fill="#FFFFFF" stroke="#000000"><foreignObject width="0" height="0" transform="matrix(1 0 0 -1 0 16.6)" overflow="visible"><span id="S1.F2.1.pic1.5.5.5.2.1" class="ltx_text"></span></foreignObject></g><g transform="matrix(1.0 0.0 0.0 1.0 -135.2 121.47)" fill="#000000" stroke="#000000"><foreignObject width="9.99" height="5.96" transform="matrix(1 0 0 -1 0 16.6)" overflow="visible"><math id="S1.F2.1.pic1.3.3.3.3.3.3.3.3.3.3.3.3.1.1.1.1.1.1.1.1.1.1.1.m1.1" class="ltx_Math" alttext="\mathbf{w}" display="inline"><semantics id="S1.F2.1.pic1.3.3.3.3.3.3.3.3.3.3.3.3.1.1.1.1.1.1.1.1.1.1.1.m1.1a"><mi id="S1.F2.1.pic1.3.3.3.3.3.3.3.3.3.3.3.3.1.1.1.1.1.1.1.1.1.1.1.m1.1.1" xref="S1.F2.1.pic1.3.3.3.3.3.3.3.3.3.3.3.3.1.1.1.1.1.1.1.1.1.1.1.m1.1.1.cmml">𝐰</mi><annotation-xml encoding="MathML-Content" id="S1.F2.1.pic1.3.3.3.3.3.3.3.3.3.3.3.3.1.1.1.1.1.1.1.1.1.1.1.m1.1b"><ci id="S1.F2.1.pic1.3.3.3.3.3.3.3.3.3.3.3.3.1.1.1.1.1.1.1.1.1.1.1.m1.1.1.cmml" xref="S1.F2.1.pic1.3.3.3.3.3.3.3.3.3.3.3.3.1.1.1.1.1.1.1.1.1.1.1.m1.1.1">𝐰</ci></annotation-xml><annotation encoding="application/x-tex" id="S1.F2.1.pic1.3.3.3.3.3.3.3.3.3.3.3.3.1.1.1.1.1.1.1.1.1.1.1.m1.1c">\mathbf{w}</annotation></semantics></math></foreignObject></g><g transform="matrix(1.0 0.0 0.0 1.0 -27.9 -29.27)" fill="#000000" stroke="#000000"><foreignObject width="11.12" height="7.56" transform="matrix(1 0 0 -1 0 16.6)" overflow="visible"><math id="S1.F2.1.pic1.4.4.4.4.4.4.4.4.4.4.4.4.1.1.1.1.1.1.1.1.1.m1.1" class="ltx_Math" alttext="S" display="inline"><semantics id="S1.F2.1.pic1.4.4.4.4.4.4.4.4.4.4.4.4.1.1.1.1.1.1.1.1.1.m1.1a"><mi mathsize="80%" id="S1.F2.1.pic1.4.4.4.4.4.4.4.4.4.4.4.4.1.1.1.1.1.1.1.1.1.m1.1.1" xref="S1.F2.1.pic1.4.4.4.4.4.4.4.4.4.4.4.4.1.1.1.1.1.1.1.1.1.m1.1.1.cmml">S</mi><annotation-xml encoding="MathML-Content" id="S1.F2.1.pic1.4.4.4.4.4.4.4.4.4.4.4.4.1.1.1.1.1.1.1.1.1.m1.1b"><ci id="S1.F2.1.pic1.4.4.4.4.4.4.4.4.4.4.4.4.1.1.1.1.1.1.1.1.1.m1.1.1.cmml" xref="S1.F2.1.pic1.4.4.4.4.4.4.4.4.4.4.4.4.1.1.1.1.1.1.1.1.1.m1.1.1">𝑆</ci></annotation-xml><annotation encoding="application/x-tex" id="S1.F2.1.pic1.4.4.4.4.4.4.4.4.4.4.4.4.1.1.1.1.1.1.1.1.1.m1.1c">S</annotation></semantics></math><span id="S1.F2.1.pic1.6.6.6.2.1" class="ltx_text" style="font-size:80%;"> shards</span></foreignObject></g><path d="M 13.47 19 L -81.07 19 C -84.12 19 -86.6 16.52 -86.6 13.47 L -86.6 -28.63 C -86.6 -31.68 -84.12 -34.16 -81.07 -34.16 L 13.47 -34.16 C 16.52 -34.16 19 -31.68 19 -28.63 L 19 13.47 C 19 16.52 16.52 19 13.47 19 Z M -86.6 -34.16" style="fill:none"></path><g transform="matrix(1.0 0.0 0.0 1.0 -64.55 33.56)" fill="#000000" stroke="#000000"><foreignObject width="28.72" height="4.77" transform="matrix(1 0 0 -1 0 16.6)" overflow="visible"><span id="S1.F2.1.pic1.7.7.7.1.1" class="ltx_text" style="font-size:80%;">server</span></foreignObject></g><path d="M -41.02 86.6 L -81.07 86.6 C -84.12 86.6 -86.6 84.12 -86.6 81.07 L -86.6 34.2 C -86.6 31.15 -84.12 28.67 -81.07 28.67 L -41.02 28.67 C -37.96 28.67 -35.48 31.15 -35.48 34.2 L -35.48 81.07 C -35.48 84.12 -37.96 86.6 -41.02 86.6 Z M -86.6 28.67" style="fill:none"></path><path d="M -53.48 0 L -15.24 0" style="fill:none"></path><g transform="matrix(1.0 0.0 0.0 1.0 -15.24 0)" stroke-dasharray="none" stroke-dashoffset="0.0pt" stroke-linejoin="miter"><path d="M -7.23 3.24 L 0.42 0 L -7.23 -3.24 Z"></path></g><path d="M -67.6 53.48 L -67.6 15.24" style="fill:none"></path><g transform="matrix(0.0 -1.0 1.0 0.0 -67.6 15.24)" stroke-dasharray="none" stroke-dashoffset="0.0pt" stroke-linejoin="miter"><path d="M -7.23 3.24 L 0.42 0 L -7.23 -3.24 Z"></path></g></g></svg>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span id="S1.F2.5.6.3.1" class="ltx_text" style="font-size:90%;">Figure 1</span>: </span><span id="S1.F2.5.4.2" class="ltx_text" style="font-size:90%;">The simple hierarchical model for server-orchestrated federated learning. With a Gaussian prior for the local parameters <math id="S1.F2.4.3.1.m1.1" class="ltx_Math" alttext="\bm{\phi}_{s}" display="inline"><semantics id="S1.F2.4.3.1.m1.1b"><msub id="S1.F2.4.3.1.m1.1.1" xref="S1.F2.4.3.1.m1.1.1.cmml"><mi class="ltx_mathvariant_bold-italic" mathvariant="bold-italic" id="S1.F2.4.3.1.m1.1.1.2" xref="S1.F2.4.3.1.m1.1.1.2.cmml">ϕ</mi><mi id="S1.F2.4.3.1.m1.1.1.3" xref="S1.F2.4.3.1.m1.1.1.3.cmml">s</mi></msub><annotation-xml encoding="MathML-Content" id="S1.F2.4.3.1.m1.1c"><apply id="S1.F2.4.3.1.m1.1.1.cmml" xref="S1.F2.4.3.1.m1.1.1"><csymbol cd="ambiguous" id="S1.F2.4.3.1.m1.1.1.1.cmml" xref="S1.F2.4.3.1.m1.1.1">subscript</csymbol><ci id="S1.F2.4.3.1.m1.1.1.2.cmml" xref="S1.F2.4.3.1.m1.1.1.2">bold-italic-ϕ</ci><ci id="S1.F2.4.3.1.m1.1.1.3.cmml" xref="S1.F2.4.3.1.m1.1.1.3">𝑠</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S1.F2.4.3.1.m1.1d">\bm{\phi}_{s}</annotation></semantics></math> centered at the server parameters <math id="S1.F2.5.4.2.m2.1" class="ltx_Math" alttext="\mathbf{w}" display="inline"><semantics id="S1.F2.5.4.2.m2.1b"><mi id="S1.F2.5.4.2.m2.1.1" xref="S1.F2.5.4.2.m2.1.1.cmml">𝐰</mi><annotation-xml encoding="MathML-Content" id="S1.F2.5.4.2.m2.1c"><ci id="S1.F2.5.4.2.m2.1.1.cmml" xref="S1.F2.5.4.2.m2.1.1">𝐰</ci></annotation-xml><annotation encoding="application/x-tex" id="S1.F2.5.4.2.m2.1d">\mathbf{w}</annotation></semantics></math> and hard-EM for learning we obtain <span id="S1.F2.5.4.2.1" class="ltx_text ltx_font_typewriter">FedAvg</span>.</span></figcaption>
</figure>
</div>
<div class="ltx_flex_cell ltx_flex_size_2">
<figure id="S1.F2.16" class="ltx_figure ltx_figure_panel ltx_minipage ltx_align_center ltx_align_middle" style="width:238.5pt;"><svg id="S1.F2.6.pic1" class="ltx_picture ltx_centering" height="121.31" overflow="visible" version="1.1" width="173.75"><g transform="translate(0,121.31) matrix(1 0 0 -1 0 0) translate(154.47,0) translate(0,34.44)" fill="#000000" stroke="#000000" stroke-width="0.4pt"><g stroke="#000000" fill="#DFDFDF"><path d="M 13.84 0 C 13.84 7.64 7.64 13.84 0 13.84 C -7.64 13.84 -13.84 7.64 -13.84 0 C -13.84 -7.64 -7.64 -13.84 0 -13.84 C 7.64 -13.84 13.84 -7.64 13.84 0 Z M 0 0"></path></g><g transform="matrix(1.0 0.0 0.0 1.0 -7.74 -3.89)" fill="#000000" stroke="#000000"><foreignObject width="15.47" height="11.12" transform="matrix(1 0 0 -1 0 16.6)" overflow="visible"><math id="S1.F2.6.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.m1.1" class="ltx_Math" alttext="D_{s}" display="inline"><semantics id="S1.F2.6.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.m1.1a"><msub id="S1.F2.6.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.m1.1.1" xref="S1.F2.6.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.m1.1.1.cmml"><mi id="S1.F2.6.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.m1.1.1.2" xref="S1.F2.6.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.m1.1.1.2.cmml">D</mi><mi id="S1.F2.6.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.m1.1.1.3" xref="S1.F2.6.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.m1.1.1.3.cmml">s</mi></msub><annotation-xml encoding="MathML-Content" id="S1.F2.6.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.m1.1b"><apply id="S1.F2.6.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.m1.1.1.cmml" xref="S1.F2.6.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.m1.1.1"><csymbol cd="ambiguous" id="S1.F2.6.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.m1.1.1.1.cmml" xref="S1.F2.6.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.m1.1.1">subscript</csymbol><ci id="S1.F2.6.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.m1.1.1.2.cmml" xref="S1.F2.6.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.m1.1.1.2">𝐷</ci><ci id="S1.F2.6.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.m1.1.1.3.cmml" xref="S1.F2.6.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.m1.1.1.3">𝑠</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S1.F2.6.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.m1.1c">D_{s}</annotation></semantics></math></foreignObject></g><g fill="#FFFFFF" stroke="#000000"><path d="M -53.76 0 C -53.76 7.64 -59.96 13.84 -67.6 13.84 C -75.24 13.84 -81.43 7.64 -81.43 0 C -81.43 -7.64 -75.24 -13.84 -67.6 -13.84 C -59.96 -13.84 -53.76 -7.64 -53.76 0 Z M -67.6 0"></path></g><g transform="matrix(1.0 0.0 0.0 1.0 -73.54 -3.46)" fill="#000000" stroke="#000000"><foreignObject width="11.88" height="12.3" transform="matrix(1 0 0 -1 0 16.6)" overflow="visible"><math id="S1.F2.6.pic1.2.2.2.2.2.2.2.2.2.2.2.2.1.1.1.1.1.1.1.1.1.1.1.m1.1" class="ltx_Math" alttext="\bm{\phi}_{s}" display="inline"><semantics id="S1.F2.6.pic1.2.2.2.2.2.2.2.2.2.2.2.2.1.1.1.1.1.1.1.1.1.1.1.m1.1a"><msub id="S1.F2.6.pic1.2.2.2.2.2.2.2.2.2.2.2.2.1.1.1.1.1.1.1.1.1.1.1.m1.1.1" xref="S1.F2.6.pic1.2.2.2.2.2.2.2.2.2.2.2.2.1.1.1.1.1.1.1.1.1.1.1.m1.1.1.cmml"><mi class="ltx_mathvariant_bold-italic" mathvariant="bold-italic" id="S1.F2.6.pic1.2.2.2.2.2.2.2.2.2.2.2.2.1.1.1.1.1.1.1.1.1.1.1.m1.1.1.2" xref="S1.F2.6.pic1.2.2.2.2.2.2.2.2.2.2.2.2.1.1.1.1.1.1.1.1.1.1.1.m1.1.1.2.cmml">ϕ</mi><mi id="S1.F2.6.pic1.2.2.2.2.2.2.2.2.2.2.2.2.1.1.1.1.1.1.1.1.1.1.1.m1.1.1.3" xref="S1.F2.6.pic1.2.2.2.2.2.2.2.2.2.2.2.2.1.1.1.1.1.1.1.1.1.1.1.m1.1.1.3.cmml">s</mi></msub><annotation-xml encoding="MathML-Content" id="S1.F2.6.pic1.2.2.2.2.2.2.2.2.2.2.2.2.1.1.1.1.1.1.1.1.1.1.1.m1.1b"><apply id="S1.F2.6.pic1.2.2.2.2.2.2.2.2.2.2.2.2.1.1.1.1.1.1.1.1.1.1.1.m1.1.1.cmml" xref="S1.F2.6.pic1.2.2.2.2.2.2.2.2.2.2.2.2.1.1.1.1.1.1.1.1.1.1.1.m1.1.1"><csymbol cd="ambiguous" id="S1.F2.6.pic1.2.2.2.2.2.2.2.2.2.2.2.2.1.1.1.1.1.1.1.1.1.1.1.m1.1.1.1.cmml" xref="S1.F2.6.pic1.2.2.2.2.2.2.2.2.2.2.2.2.1.1.1.1.1.1.1.1.1.1.1.m1.1.1">subscript</csymbol><ci id="S1.F2.6.pic1.2.2.2.2.2.2.2.2.2.2.2.2.1.1.1.1.1.1.1.1.1.1.1.m1.1.1.2.cmml" xref="S1.F2.6.pic1.2.2.2.2.2.2.2.2.2.2.2.2.1.1.1.1.1.1.1.1.1.1.1.m1.1.1.2">bold-italic-ϕ</ci><ci id="S1.F2.6.pic1.2.2.2.2.2.2.2.2.2.2.2.2.1.1.1.1.1.1.1.1.1.1.1.m1.1.1.3.cmml" xref="S1.F2.6.pic1.2.2.2.2.2.2.2.2.2.2.2.2.1.1.1.1.1.1.1.1.1.1.1.m1.1.1.3">𝑠</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S1.F2.6.pic1.2.2.2.2.2.2.2.2.2.2.2.2.1.1.1.1.1.1.1.1.1.1.1.m1.1c">\bm{\phi}_{s}</annotation></semantics></math></foreignObject></g><g fill="#FFFFFF" stroke="#000000"><path d="M -53.88 67.6 L -67.6 81.32 L -81.32 67.6 L -67.6 53.88 Z"></path></g><g fill="#FFFFFF" stroke="#000000"><foreignObject width="0" height="0" transform="matrix(1 0 0 -1 0 16.6)" overflow="visible"><span id="S1.F2.6.pic1.7.7.7.2.1" class="ltx_text"></span></foreignObject></g><g transform="matrix(1.0 0.0 0.0 1.0 -135.2 121.47)" fill="#000000" stroke="#000000"><foreignObject width="9.99" height="5.96" transform="matrix(1 0 0 -1 0 16.6)" overflow="visible"><math id="S1.F2.6.pic1.3.3.3.3.3.3.3.3.3.3.3.3.1.1.1.1.1.1.1.1.1.1.1.m1.1" class="ltx_Math" alttext="\mathbf{w}" display="inline"><semantics id="S1.F2.6.pic1.3.3.3.3.3.3.3.3.3.3.3.3.1.1.1.1.1.1.1.1.1.1.1.m1.1a"><mi id="S1.F2.6.pic1.3.3.3.3.3.3.3.3.3.3.3.3.1.1.1.1.1.1.1.1.1.1.1.m1.1.1" xref="S1.F2.6.pic1.3.3.3.3.3.3.3.3.3.3.3.3.1.1.1.1.1.1.1.1.1.1.1.m1.1.1.cmml">𝐰</mi><annotation-xml encoding="MathML-Content" id="S1.F2.6.pic1.3.3.3.3.3.3.3.3.3.3.3.3.1.1.1.1.1.1.1.1.1.1.1.m1.1b"><ci id="S1.F2.6.pic1.3.3.3.3.3.3.3.3.3.3.3.3.1.1.1.1.1.1.1.1.1.1.1.m1.1.1.cmml" xref="S1.F2.6.pic1.3.3.3.3.3.3.3.3.3.3.3.3.1.1.1.1.1.1.1.1.1.1.1.m1.1.1">𝐰</ci></annotation-xml><annotation encoding="application/x-tex" id="S1.F2.6.pic1.3.3.3.3.3.3.3.3.3.3.3.3.1.1.1.1.1.1.1.1.1.1.1.m1.1c">\mathbf{w}</annotation></semantics></math></foreignObject></g><g fill="#FFFFFF" stroke="#000000"><path d="M -121.36 0 C -121.36 7.64 -127.55 13.84 -135.2 13.84 C -142.84 13.84 -149.03 7.64 -149.03 0 C -149.03 -7.64 -142.84 -13.84 -135.2 -13.84 C -127.55 -13.84 -121.36 -7.64 -121.36 0 Z M -135.2 0"></path></g><g transform="matrix(1.0 0.0 0.0 1.0 -140.09 -2.14)" fill="#000000" stroke="#000000"><foreignObject width="9.78" height="7.63" transform="matrix(1 0 0 -1 0 16.6)" overflow="visible"><math id="S1.F2.6.pic1.4.4.4.4.4.4.4.4.4.4.4.4.1.1.1.1.1.1.1.1.1.1.1.m1.1" class="ltx_Math" alttext="\mathbf{z}_{s}" display="inline"><semantics id="S1.F2.6.pic1.4.4.4.4.4.4.4.4.4.4.4.4.1.1.1.1.1.1.1.1.1.1.1.m1.1a"><msub id="S1.F2.6.pic1.4.4.4.4.4.4.4.4.4.4.4.4.1.1.1.1.1.1.1.1.1.1.1.m1.1.1" xref="S1.F2.6.pic1.4.4.4.4.4.4.4.4.4.4.4.4.1.1.1.1.1.1.1.1.1.1.1.m1.1.1.cmml"><mi id="S1.F2.6.pic1.4.4.4.4.4.4.4.4.4.4.4.4.1.1.1.1.1.1.1.1.1.1.1.m1.1.1.2" xref="S1.F2.6.pic1.4.4.4.4.4.4.4.4.4.4.4.4.1.1.1.1.1.1.1.1.1.1.1.m1.1.1.2.cmml">𝐳</mi><mi id="S1.F2.6.pic1.4.4.4.4.4.4.4.4.4.4.4.4.1.1.1.1.1.1.1.1.1.1.1.m1.1.1.3" xref="S1.F2.6.pic1.4.4.4.4.4.4.4.4.4.4.4.4.1.1.1.1.1.1.1.1.1.1.1.m1.1.1.3.cmml">s</mi></msub><annotation-xml encoding="MathML-Content" id="S1.F2.6.pic1.4.4.4.4.4.4.4.4.4.4.4.4.1.1.1.1.1.1.1.1.1.1.1.m1.1b"><apply id="S1.F2.6.pic1.4.4.4.4.4.4.4.4.4.4.4.4.1.1.1.1.1.1.1.1.1.1.1.m1.1.1.cmml" xref="S1.F2.6.pic1.4.4.4.4.4.4.4.4.4.4.4.4.1.1.1.1.1.1.1.1.1.1.1.m1.1.1"><csymbol cd="ambiguous" id="S1.F2.6.pic1.4.4.4.4.4.4.4.4.4.4.4.4.1.1.1.1.1.1.1.1.1.1.1.m1.1.1.1.cmml" xref="S1.F2.6.pic1.4.4.4.4.4.4.4.4.4.4.4.4.1.1.1.1.1.1.1.1.1.1.1.m1.1.1">subscript</csymbol><ci id="S1.F2.6.pic1.4.4.4.4.4.4.4.4.4.4.4.4.1.1.1.1.1.1.1.1.1.1.1.m1.1.1.2.cmml" xref="S1.F2.6.pic1.4.4.4.4.4.4.4.4.4.4.4.4.1.1.1.1.1.1.1.1.1.1.1.m1.1.1.2">𝐳</ci><ci id="S1.F2.6.pic1.4.4.4.4.4.4.4.4.4.4.4.4.1.1.1.1.1.1.1.1.1.1.1.m1.1.1.3.cmml" xref="S1.F2.6.pic1.4.4.4.4.4.4.4.4.4.4.4.4.1.1.1.1.1.1.1.1.1.1.1.m1.1.1.3">𝑠</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S1.F2.6.pic1.4.4.4.4.4.4.4.4.4.4.4.4.1.1.1.1.1.1.1.1.1.1.1.m1.1c">\mathbf{z}_{s}</annotation></semantics></math></foreignObject></g><g fill="#FFFFFF" stroke="#000000"><path d="M -121.47 67.6 L -135.2 81.32 L -148.92 67.6 L -135.2 53.88 Z"></path></g><g fill="#FFFFFF" stroke="#000000"><foreignObject width="0" height="0" transform="matrix(1 0 0 -1 0 16.6)" overflow="visible"><span id="S1.F2.6.pic1.8.8.8.2.1" class="ltx_text"></span></foreignObject></g><g transform="matrix(1.0 0.0 0.0 1.0 -270.39 121.47)" fill="#000000" stroke="#000000"><foreignObject width="6.5" height="9.61" transform="matrix(1 0 0 -1 0 16.6)" overflow="visible"><math id="S1.F2.6.pic1.5.5.5.5.5.5.5.5.5.5.5.5.1.1.1.1.1.1.1.1.1.1.1.m1.1" class="ltx_Math" alttext="\bm{\theta}" display="inline"><semantics id="S1.F2.6.pic1.5.5.5.5.5.5.5.5.5.5.5.5.1.1.1.1.1.1.1.1.1.1.1.m1.1a"><mi id="S1.F2.6.pic1.5.5.5.5.5.5.5.5.5.5.5.5.1.1.1.1.1.1.1.1.1.1.1.m1.1.1" xref="S1.F2.6.pic1.5.5.5.5.5.5.5.5.5.5.5.5.1.1.1.1.1.1.1.1.1.1.1.m1.1.1.cmml">𝜽</mi><annotation-xml encoding="MathML-Content" id="S1.F2.6.pic1.5.5.5.5.5.5.5.5.5.5.5.5.1.1.1.1.1.1.1.1.1.1.1.m1.1b"><ci id="S1.F2.6.pic1.5.5.5.5.5.5.5.5.5.5.5.5.1.1.1.1.1.1.1.1.1.1.1.m1.1.1.cmml" xref="S1.F2.6.pic1.5.5.5.5.5.5.5.5.5.5.5.5.1.1.1.1.1.1.1.1.1.1.1.m1.1.1">𝜽</ci></annotation-xml><annotation encoding="application/x-tex" id="S1.F2.6.pic1.5.5.5.5.5.5.5.5.5.5.5.5.1.1.1.1.1.1.1.1.1.1.1.m1.1c">\bm{\theta}</annotation></semantics></math></foreignObject></g><g transform="matrix(1.0 0.0 0.0 1.0 -27.9 -29.27)" fill="#000000" stroke="#000000"><foreignObject width="11.12" height="7.56" transform="matrix(1 0 0 -1 0 16.6)" overflow="visible"><math id="S1.F2.6.pic1.6.6.6.6.6.6.6.6.6.6.6.6.1.1.1.1.1.1.1.1.1.m1.1" class="ltx_Math" alttext="S" display="inline"><semantics id="S1.F2.6.pic1.6.6.6.6.6.6.6.6.6.6.6.6.1.1.1.1.1.1.1.1.1.m1.1a"><mi mathsize="80%" id="S1.F2.6.pic1.6.6.6.6.6.6.6.6.6.6.6.6.1.1.1.1.1.1.1.1.1.m1.1.1" xref="S1.F2.6.pic1.6.6.6.6.6.6.6.6.6.6.6.6.1.1.1.1.1.1.1.1.1.m1.1.1.cmml">S</mi><annotation-xml encoding="MathML-Content" id="S1.F2.6.pic1.6.6.6.6.6.6.6.6.6.6.6.6.1.1.1.1.1.1.1.1.1.m1.1b"><ci id="S1.F2.6.pic1.6.6.6.6.6.6.6.6.6.6.6.6.1.1.1.1.1.1.1.1.1.m1.1.1.cmml" xref="S1.F2.6.pic1.6.6.6.6.6.6.6.6.6.6.6.6.1.1.1.1.1.1.1.1.1.m1.1.1">𝑆</ci></annotation-xml><annotation encoding="application/x-tex" id="S1.F2.6.pic1.6.6.6.6.6.6.6.6.6.6.6.6.1.1.1.1.1.1.1.1.1.m1.1c">S</annotation></semantics></math><span id="S1.F2.6.pic1.9.9.9.2.1" class="ltx_text" style="font-size:80%;"> shards</span></foreignObject></g><path d="M 13.47 19 L -148.66 19 C -151.72 19 -154.2 16.52 -154.2 13.47 L -154.2 -28.63 C -154.2 -31.68 -151.72 -34.16 -148.66 -34.16 L 13.47 -34.16 C 16.52 -34.16 19 -31.68 19 -28.63 L 19 13.47 C 19 16.52 16.52 19 13.47 19 Z M -154.2 -34.16" style="fill:none"></path><g transform="matrix(1.0 0.0 0.0 1.0 -112.19 33.56)" fill="#000000" stroke="#000000"><foreignObject width="28.72" height="4.77" transform="matrix(1 0 0 -1 0 16.6)" overflow="visible"><span id="S1.F2.6.pic1.10.10.10.1.1" class="ltx_text" style="font-size:80%;">server</span></foreignObject></g><path d="M -54.13 86.6 L -148.66 86.6 C -151.72 86.6 -154.2 84.12 -154.2 81.07 L -154.2 34.2 C -154.2 31.15 -151.72 28.67 -148.66 28.67 L -54.13 28.67 C -51.07 28.67 -48.6 31.15 -48.6 34.2 L -48.6 81.07 C -48.6 84.12 -51.07 86.6 -54.13 86.6 Z M -154.2 28.67" style="fill:none"></path><path d="M -53.48 0 L -15.24 0" style="fill:none"></path><g transform="matrix(1.0 0.0 0.0 1.0 -15.24 0)" stroke-dasharray="none" stroke-dashoffset="0.0pt" stroke-linejoin="miter"><path d="M -7.23 3.24 L 0.42 0 L -7.23 -3.24 Z"></path></g><path d="M -67.6 53.48 L -67.6 15.24" style="fill:none"></path><g transform="matrix(0.0 -1.0 1.0 0.0 -67.6 15.24)" stroke-dasharray="none" stroke-dashoffset="0.0pt" stroke-linejoin="miter"><path d="M -7.23 3.24 L 0.42 0 L -7.23 -3.24 Z"></path></g><path d="M -121.08 0 L -82.83 0" style="fill:none"></path><g transform="matrix(1.0 0.0 0.0 1.0 -82.83 0)" stroke-dasharray="none" stroke-dashoffset="0.0pt" stroke-linejoin="miter"><path d="M -7.23 3.24 L 0.42 0 L -7.23 -3.24 Z"></path></g><path d="M -135.2 53.48 L -135.2 15.24" style="fill:none"></path><g transform="matrix(0.0 -1.0 1.0 0.0 -135.2 15.24)" stroke-dasharray="none" stroke-dashoffset="0.0pt" stroke-linejoin="miter"><path d="M -7.23 3.24 L 0.42 0 L -7.23 -3.24 Z"></path></g></g></svg>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span id="S1.F2.16.12.6.1" class="ltx_text" style="font-size:90%;">Figure 2</span>: </span><span id="S1.F2.16.10.5" class="ltx_text" style="font-size:90%;">Modifying the hierarchical model to allow for sparsity in the local parameters <math id="S1.F2.12.6.1.m1.1" class="ltx_Math" alttext="\bm{\phi}_{s}" display="inline"><semantics id="S1.F2.12.6.1.m1.1b"><msub id="S1.F2.12.6.1.m1.1.1" xref="S1.F2.12.6.1.m1.1.1.cmml"><mi class="ltx_mathvariant_bold-italic" mathvariant="bold-italic" id="S1.F2.12.6.1.m1.1.1.2" xref="S1.F2.12.6.1.m1.1.1.2.cmml">ϕ</mi><mi id="S1.F2.12.6.1.m1.1.1.3" xref="S1.F2.12.6.1.m1.1.1.3.cmml">s</mi></msub><annotation-xml encoding="MathML-Content" id="S1.F2.12.6.1.m1.1c"><apply id="S1.F2.12.6.1.m1.1.1.cmml" xref="S1.F2.12.6.1.m1.1.1"><csymbol cd="ambiguous" id="S1.F2.12.6.1.m1.1.1.1.cmml" xref="S1.F2.12.6.1.m1.1.1">subscript</csymbol><ci id="S1.F2.12.6.1.m1.1.1.2.cmml" xref="S1.F2.12.6.1.m1.1.1.2">bold-italic-ϕ</ci><ci id="S1.F2.12.6.1.m1.1.1.3.cmml" xref="S1.F2.12.6.1.m1.1.1.3">𝑠</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S1.F2.12.6.1.m1.1d">\bm{\phi}_{s}</annotation></semantics></math> with the spike and slab distribution <cite class="ltx_cite ltx_citemacro_citep">[<a href="#bib.bib23" title="" class="ltx_ref">23</a>]</cite>. The server parameter <math id="S1.F2.13.7.2.m2.1" class="ltx_Math" alttext="\bm{\theta}" display="inline"><semantics id="S1.F2.13.7.2.m2.1b"><mi id="S1.F2.13.7.2.m2.1.1" xref="S1.F2.13.7.2.m2.1.1.cmml">𝜽</mi><annotation-xml encoding="MathML-Content" id="S1.F2.13.7.2.m2.1c"><ci id="S1.F2.13.7.2.m2.1.1.cmml" xref="S1.F2.13.7.2.m2.1.1">𝜽</ci></annotation-xml><annotation encoding="application/x-tex" id="S1.F2.13.7.2.m2.1d">\bm{\theta}</annotation></semantics></math> governs a Bernoulli prior distribution over the local variables <math id="S1.F2.14.8.3.m3.1" class="ltx_Math" alttext="\mathbf{z}_{s}" display="inline"><semantics id="S1.F2.14.8.3.m3.1b"><msub id="S1.F2.14.8.3.m3.1.1" xref="S1.F2.14.8.3.m3.1.1.cmml"><mi id="S1.F2.14.8.3.m3.1.1.2" xref="S1.F2.14.8.3.m3.1.1.2.cmml">𝐳</mi><mi id="S1.F2.14.8.3.m3.1.1.3" xref="S1.F2.14.8.3.m3.1.1.3.cmml">s</mi></msub><annotation-xml encoding="MathML-Content" id="S1.F2.14.8.3.m3.1c"><apply id="S1.F2.14.8.3.m3.1.1.cmml" xref="S1.F2.14.8.3.m3.1.1"><csymbol cd="ambiguous" id="S1.F2.14.8.3.m3.1.1.1.cmml" xref="S1.F2.14.8.3.m3.1.1">subscript</csymbol><ci id="S1.F2.14.8.3.m3.1.1.2.cmml" xref="S1.F2.14.8.3.m3.1.1.2">𝐳</ci><ci id="S1.F2.14.8.3.m3.1.1.3.cmml" xref="S1.F2.14.8.3.m3.1.1.3">𝑠</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S1.F2.14.8.3.m3.1d">\mathbf{z}_{s}</annotation></semantics></math>, the value of which determine whether a parameter in <math id="S1.F2.15.9.4.m4.1" class="ltx_Math" alttext="\bm{\phi}_{s}" display="inline"><semantics id="S1.F2.15.9.4.m4.1b"><msub id="S1.F2.15.9.4.m4.1.1" xref="S1.F2.15.9.4.m4.1.1.cmml"><mi class="ltx_mathvariant_bold-italic" mathvariant="bold-italic" id="S1.F2.15.9.4.m4.1.1.2" xref="S1.F2.15.9.4.m4.1.1.2.cmml">ϕ</mi><mi id="S1.F2.15.9.4.m4.1.1.3" xref="S1.F2.15.9.4.m4.1.1.3.cmml">s</mi></msub><annotation-xml encoding="MathML-Content" id="S1.F2.15.9.4.m4.1c"><apply id="S1.F2.15.9.4.m4.1.1.cmml" xref="S1.F2.15.9.4.m4.1.1"><csymbol cd="ambiguous" id="S1.F2.15.9.4.m4.1.1.1.cmml" xref="S1.F2.15.9.4.m4.1.1">subscript</csymbol><ci id="S1.F2.15.9.4.m4.1.1.2.cmml" xref="S1.F2.15.9.4.m4.1.1.2">bold-italic-ϕ</ci><ci id="S1.F2.15.9.4.m4.1.1.3.cmml" xref="S1.F2.15.9.4.m4.1.1.3">𝑠</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S1.F2.15.9.4.m4.1d">\bm{\phi}_{s}</annotation></semantics></math> is active or not. When a parameter is active, the prior is a Gaussian centered at the server parameters <math id="S1.F2.16.10.5.m5.1" class="ltx_Math" alttext="\mathbf{w}" display="inline"><semantics id="S1.F2.16.10.5.m5.1b"><mi id="S1.F2.16.10.5.m5.1.1" xref="S1.F2.16.10.5.m5.1.1.cmml">𝐰</mi><annotation-xml encoding="MathML-Content" id="S1.F2.16.10.5.m5.1c"><ci id="S1.F2.16.10.5.m5.1.1.cmml" xref="S1.F2.16.10.5.m5.1.1">𝐰</ci></annotation-xml><annotation encoding="application/x-tex" id="S1.F2.16.10.5.m5.1d">\mathbf{w}</annotation></semantics></math>. By using hard-EM on this variant of the hierarchical model, we obtain <span id="S1.F2.16.10.5.1" class="ltx_text ltx_font_typewriter">FedSparse</span>.</span></figcaption>
</figure>
</div>
</div>
</figure>
<div id="S1.p4" class="ltx_para">
<p id="S1.p4.1" class="ltx_p">Sparse neural networks are appealing for the FL scenario, especially in the “cross-device” setting <cite class="ltx_cite ltx_citemacro_citep">[<a href="#bib.bib14" title="" class="ltx_ref">14</a>]</cite>, as they can tackle several practical challenges. In particular, communicating model updates over multiple rounds across many devices can incur significant communication costs. Communication via the public internet infrastructure and mobile networks is potentially slow and not for free. Equally important, training (and inference) takes place on-device and is therefore restricted by the edge devices’ hardware constraints on memory, speed and heat dissipation capabilities. Therefore, <span id="S1.p4.1.1" class="ltx_text ltx_font_typewriter">FedSparse</span> provides models that tackle both of the challenges mentioned above since they can simultaneously reduce the overall communication and computation at the client devices. Addressing these challenges is an important step towards building practical FL systems, as also discussed in <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib14" title="" class="ltx_ref">14</a>]</cite>. Empirically, we see that <span id="S1.p4.1.2" class="ltx_text ltx_font_typewriter">FedSparse</span> provides better communication-accuracy trade-offs compared to, <span id="S1.p4.1.3" class="ltx_text ltx_font_typewriter">FedAvg</span>, prior works that similarly target joint reductions of computation and communication costs  <cite class="ltx_cite ltx_citemacro_citep">[<a href="#bib.bib5" title="" class="ltx_ref">5</a>]</cite>, as well as another baseline that uses <math id="S1.p4.1.m1.1" class="ltx_Math" alttext="L_{1}" display="inline"><semantics id="S1.p4.1.m1.1a"><msub id="S1.p4.1.m1.1.1" xref="S1.p4.1.m1.1.1.cmml"><mi id="S1.p4.1.m1.1.1.2" xref="S1.p4.1.m1.1.1.2.cmml">L</mi><mn id="S1.p4.1.m1.1.1.3" xref="S1.p4.1.m1.1.1.3.cmml">1</mn></msub><annotation-xml encoding="MathML-Content" id="S1.p4.1.m1.1b"><apply id="S1.p4.1.m1.1.1.cmml" xref="S1.p4.1.m1.1.1"><csymbol cd="ambiguous" id="S1.p4.1.m1.1.1.1.cmml" xref="S1.p4.1.m1.1.1">subscript</csymbol><ci id="S1.p4.1.m1.1.1.2.cmml" xref="S1.p4.1.m1.1.1.2">𝐿</ci><cn type="integer" id="S1.p4.1.m1.1.1.3.cmml" xref="S1.p4.1.m1.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S1.p4.1.m1.1c">L_{1}</annotation></semantics></math> regularization at the client level (for pruning) and standard parameter averaging at the server level.</p>
</div>
</section>
<section id="S2" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">2 </span>A hierarchical model interpretation of federated learning</h2>

<div id="S2.p1" class="ltx_para">
<p id="S2.p1.3" class="ltx_p">The server-orchestrated variant of federated learning is mainly realized via the <span id="S2.p1.3.1" class="ltx_text ltx_font_typewriter">FedAvg</span> <cite class="ltx_cite ltx_citemacro_citep">[<a href="#bib.bib22" title="" class="ltx_ref">22</a>]</cite> algorithm, which is a simple iterative procedure consisting of four simple steps. At the beginning of each round <math id="S2.p1.1.m1.1" class="ltx_Math" alttext="t" display="inline"><semantics id="S2.p1.1.m1.1a"><mi id="S2.p1.1.m1.1.1" xref="S2.p1.1.m1.1.1.cmml">t</mi><annotation-xml encoding="MathML-Content" id="S2.p1.1.m1.1b"><ci id="S2.p1.1.m1.1.1.cmml" xref="S2.p1.1.m1.1.1">𝑡</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.p1.1.m1.1c">t</annotation></semantics></math>, the server communicates the model parameters, let them be <math id="S2.p1.2.m2.1" class="ltx_Math" alttext="\mathbf{w}" display="inline"><semantics id="S2.p1.2.m2.1a"><mi id="S2.p1.2.m2.1.1" xref="S2.p1.2.m2.1.1.cmml">𝐰</mi><annotation-xml encoding="MathML-Content" id="S2.p1.2.m2.1b"><ci id="S2.p1.2.m2.1.1.cmml" xref="S2.p1.2.m2.1.1">𝐰</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.p1.2.m2.1c">\mathbf{w}</annotation></semantics></math>, to a subset of the devices. The devices then proceed to optimize <math id="S2.p1.3.m3.1" class="ltx_Math" alttext="\mathbf{w}" display="inline"><semantics id="S2.p1.3.m3.1a"><mi id="S2.p1.3.m3.1.1" xref="S2.p1.3.m3.1.1.cmml">𝐰</mi><annotation-xml encoding="MathML-Content" id="S2.p1.3.m3.1b"><ci id="S2.p1.3.m3.1.1.cmml" xref="S2.p1.3.m3.1.1">𝐰</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.p1.3.m3.1c">\mathbf{w}</annotation></semantics></math>, <em id="S2.p1.3.2" class="ltx_emph ltx_font_italic">e.g.</em>, via stochastic gradient descent, on their respective dataset via a given loss function</p>
<table id="A10.EGx1" class="ltx_equationgroup ltx_eqn_align ltx_eqn_table">

<tbody id="S2.E1"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math id="S2.E1.m1.4" class="ltx_Math" alttext="\displaystyle\mathcal{L}_{s}(\mathcal{D}_{s},\mathbf{w}):=\frac{1}{N_{s}}\sum_{i=1}^{N_{s}}L(\mathcal{D}_{si},\mathbf{w})" display="inline"><semantics id="S2.E1.m1.4a"><mrow id="S2.E1.m1.4.4" xref="S2.E1.m1.4.4.cmml"><mrow id="S2.E1.m1.3.3.1" xref="S2.E1.m1.3.3.1.cmml"><msub id="S2.E1.m1.3.3.1.3" xref="S2.E1.m1.3.3.1.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S2.E1.m1.3.3.1.3.2" xref="S2.E1.m1.3.3.1.3.2.cmml">ℒ</mi><mi id="S2.E1.m1.3.3.1.3.3" xref="S2.E1.m1.3.3.1.3.3.cmml">s</mi></msub><mo lspace="0em" rspace="0em" id="S2.E1.m1.3.3.1.2" xref="S2.E1.m1.3.3.1.2.cmml">​</mo><mrow id="S2.E1.m1.3.3.1.1.1" xref="S2.E1.m1.3.3.1.1.2.cmml"><mo stretchy="false" id="S2.E1.m1.3.3.1.1.1.2" xref="S2.E1.m1.3.3.1.1.2.cmml">(</mo><msub id="S2.E1.m1.3.3.1.1.1.1" xref="S2.E1.m1.3.3.1.1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S2.E1.m1.3.3.1.1.1.1.2" xref="S2.E1.m1.3.3.1.1.1.1.2.cmml">𝒟</mi><mi id="S2.E1.m1.3.3.1.1.1.1.3" xref="S2.E1.m1.3.3.1.1.1.1.3.cmml">s</mi></msub><mo id="S2.E1.m1.3.3.1.1.1.3" xref="S2.E1.m1.3.3.1.1.2.cmml">,</mo><mi id="S2.E1.m1.1.1" xref="S2.E1.m1.1.1.cmml">𝐰</mi><mo rspace="0.278em" stretchy="false" id="S2.E1.m1.3.3.1.1.1.4" xref="S2.E1.m1.3.3.1.1.2.cmml">)</mo></mrow></mrow><mo rspace="0.278em" id="S2.E1.m1.4.4.3" xref="S2.E1.m1.4.4.3.cmml">:=</mo><mrow id="S2.E1.m1.4.4.2" xref="S2.E1.m1.4.4.2.cmml"><mstyle displaystyle="true" id="S2.E1.m1.4.4.2.3" xref="S2.E1.m1.4.4.2.3.cmml"><mfrac id="S2.E1.m1.4.4.2.3a" xref="S2.E1.m1.4.4.2.3.cmml"><mn id="S2.E1.m1.4.4.2.3.2" xref="S2.E1.m1.4.4.2.3.2.cmml">1</mn><msub id="S2.E1.m1.4.4.2.3.3" xref="S2.E1.m1.4.4.2.3.3.cmml"><mi id="S2.E1.m1.4.4.2.3.3.2" xref="S2.E1.m1.4.4.2.3.3.2.cmml">N</mi><mi id="S2.E1.m1.4.4.2.3.3.3" xref="S2.E1.m1.4.4.2.3.3.3.cmml">s</mi></msub></mfrac></mstyle><mo lspace="0em" rspace="0em" id="S2.E1.m1.4.4.2.2" xref="S2.E1.m1.4.4.2.2.cmml">​</mo><mrow id="S2.E1.m1.4.4.2.1" xref="S2.E1.m1.4.4.2.1.cmml"><mstyle displaystyle="true" id="S2.E1.m1.4.4.2.1.2" xref="S2.E1.m1.4.4.2.1.2.cmml"><munderover id="S2.E1.m1.4.4.2.1.2a" xref="S2.E1.m1.4.4.2.1.2.cmml"><mo movablelimits="false" id="S2.E1.m1.4.4.2.1.2.2.2" xref="S2.E1.m1.4.4.2.1.2.2.2.cmml">∑</mo><mrow id="S2.E1.m1.4.4.2.1.2.2.3" xref="S2.E1.m1.4.4.2.1.2.2.3.cmml"><mi id="S2.E1.m1.4.4.2.1.2.2.3.2" xref="S2.E1.m1.4.4.2.1.2.2.3.2.cmml">i</mi><mo id="S2.E1.m1.4.4.2.1.2.2.3.1" xref="S2.E1.m1.4.4.2.1.2.2.3.1.cmml">=</mo><mn id="S2.E1.m1.4.4.2.1.2.2.3.3" xref="S2.E1.m1.4.4.2.1.2.2.3.3.cmml">1</mn></mrow><msub id="S2.E1.m1.4.4.2.1.2.3" xref="S2.E1.m1.4.4.2.1.2.3.cmml"><mi id="S2.E1.m1.4.4.2.1.2.3.2" xref="S2.E1.m1.4.4.2.1.2.3.2.cmml">N</mi><mi id="S2.E1.m1.4.4.2.1.2.3.3" xref="S2.E1.m1.4.4.2.1.2.3.3.cmml">s</mi></msub></munderover></mstyle><mrow id="S2.E1.m1.4.4.2.1.1" xref="S2.E1.m1.4.4.2.1.1.cmml"><mi id="S2.E1.m1.4.4.2.1.1.3" xref="S2.E1.m1.4.4.2.1.1.3.cmml">L</mi><mo lspace="0em" rspace="0em" id="S2.E1.m1.4.4.2.1.1.2" xref="S2.E1.m1.4.4.2.1.1.2.cmml">​</mo><mrow id="S2.E1.m1.4.4.2.1.1.1.1" xref="S2.E1.m1.4.4.2.1.1.1.2.cmml"><mo stretchy="false" id="S2.E1.m1.4.4.2.1.1.1.1.2" xref="S2.E1.m1.4.4.2.1.1.1.2.cmml">(</mo><msub id="S2.E1.m1.4.4.2.1.1.1.1.1" xref="S2.E1.m1.4.4.2.1.1.1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S2.E1.m1.4.4.2.1.1.1.1.1.2" xref="S2.E1.m1.4.4.2.1.1.1.1.1.2.cmml">𝒟</mi><mrow id="S2.E1.m1.4.4.2.1.1.1.1.1.3" xref="S2.E1.m1.4.4.2.1.1.1.1.1.3.cmml"><mi id="S2.E1.m1.4.4.2.1.1.1.1.1.3.2" xref="S2.E1.m1.4.4.2.1.1.1.1.1.3.2.cmml">s</mi><mo lspace="0em" rspace="0em" id="S2.E1.m1.4.4.2.1.1.1.1.1.3.1" xref="S2.E1.m1.4.4.2.1.1.1.1.1.3.1.cmml">​</mo><mi id="S2.E1.m1.4.4.2.1.1.1.1.1.3.3" xref="S2.E1.m1.4.4.2.1.1.1.1.1.3.3.cmml">i</mi></mrow></msub><mo id="S2.E1.m1.4.4.2.1.1.1.1.3" xref="S2.E1.m1.4.4.2.1.1.1.2.cmml">,</mo><mi id="S2.E1.m1.2.2" xref="S2.E1.m1.2.2.cmml">𝐰</mi><mo stretchy="false" id="S2.E1.m1.4.4.2.1.1.1.1.4" xref="S2.E1.m1.4.4.2.1.1.1.2.cmml">)</mo></mrow></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.E1.m1.4b"><apply id="S2.E1.m1.4.4.cmml" xref="S2.E1.m1.4.4"><csymbol cd="latexml" id="S2.E1.m1.4.4.3.cmml" xref="S2.E1.m1.4.4.3">assign</csymbol><apply id="S2.E1.m1.3.3.1.cmml" xref="S2.E1.m1.3.3.1"><times id="S2.E1.m1.3.3.1.2.cmml" xref="S2.E1.m1.3.3.1.2"></times><apply id="S2.E1.m1.3.3.1.3.cmml" xref="S2.E1.m1.3.3.1.3"><csymbol cd="ambiguous" id="S2.E1.m1.3.3.1.3.1.cmml" xref="S2.E1.m1.3.3.1.3">subscript</csymbol><ci id="S2.E1.m1.3.3.1.3.2.cmml" xref="S2.E1.m1.3.3.1.3.2">ℒ</ci><ci id="S2.E1.m1.3.3.1.3.3.cmml" xref="S2.E1.m1.3.3.1.3.3">𝑠</ci></apply><interval closure="open" id="S2.E1.m1.3.3.1.1.2.cmml" xref="S2.E1.m1.3.3.1.1.1"><apply id="S2.E1.m1.3.3.1.1.1.1.cmml" xref="S2.E1.m1.3.3.1.1.1.1"><csymbol cd="ambiguous" id="S2.E1.m1.3.3.1.1.1.1.1.cmml" xref="S2.E1.m1.3.3.1.1.1.1">subscript</csymbol><ci id="S2.E1.m1.3.3.1.1.1.1.2.cmml" xref="S2.E1.m1.3.3.1.1.1.1.2">𝒟</ci><ci id="S2.E1.m1.3.3.1.1.1.1.3.cmml" xref="S2.E1.m1.3.3.1.1.1.1.3">𝑠</ci></apply><ci id="S2.E1.m1.1.1.cmml" xref="S2.E1.m1.1.1">𝐰</ci></interval></apply><apply id="S2.E1.m1.4.4.2.cmml" xref="S2.E1.m1.4.4.2"><times id="S2.E1.m1.4.4.2.2.cmml" xref="S2.E1.m1.4.4.2.2"></times><apply id="S2.E1.m1.4.4.2.3.cmml" xref="S2.E1.m1.4.4.2.3"><divide id="S2.E1.m1.4.4.2.3.1.cmml" xref="S2.E1.m1.4.4.2.3"></divide><cn type="integer" id="S2.E1.m1.4.4.2.3.2.cmml" xref="S2.E1.m1.4.4.2.3.2">1</cn><apply id="S2.E1.m1.4.4.2.3.3.cmml" xref="S2.E1.m1.4.4.2.3.3"><csymbol cd="ambiguous" id="S2.E1.m1.4.4.2.3.3.1.cmml" xref="S2.E1.m1.4.4.2.3.3">subscript</csymbol><ci id="S2.E1.m1.4.4.2.3.3.2.cmml" xref="S2.E1.m1.4.4.2.3.3.2">𝑁</ci><ci id="S2.E1.m1.4.4.2.3.3.3.cmml" xref="S2.E1.m1.4.4.2.3.3.3">𝑠</ci></apply></apply><apply id="S2.E1.m1.4.4.2.1.cmml" xref="S2.E1.m1.4.4.2.1"><apply id="S2.E1.m1.4.4.2.1.2.cmml" xref="S2.E1.m1.4.4.2.1.2"><csymbol cd="ambiguous" id="S2.E1.m1.4.4.2.1.2.1.cmml" xref="S2.E1.m1.4.4.2.1.2">superscript</csymbol><apply id="S2.E1.m1.4.4.2.1.2.2.cmml" xref="S2.E1.m1.4.4.2.1.2"><csymbol cd="ambiguous" id="S2.E1.m1.4.4.2.1.2.2.1.cmml" xref="S2.E1.m1.4.4.2.1.2">subscript</csymbol><sum id="S2.E1.m1.4.4.2.1.2.2.2.cmml" xref="S2.E1.m1.4.4.2.1.2.2.2"></sum><apply id="S2.E1.m1.4.4.2.1.2.2.3.cmml" xref="S2.E1.m1.4.4.2.1.2.2.3"><eq id="S2.E1.m1.4.4.2.1.2.2.3.1.cmml" xref="S2.E1.m1.4.4.2.1.2.2.3.1"></eq><ci id="S2.E1.m1.4.4.2.1.2.2.3.2.cmml" xref="S2.E1.m1.4.4.2.1.2.2.3.2">𝑖</ci><cn type="integer" id="S2.E1.m1.4.4.2.1.2.2.3.3.cmml" xref="S2.E1.m1.4.4.2.1.2.2.3.3">1</cn></apply></apply><apply id="S2.E1.m1.4.4.2.1.2.3.cmml" xref="S2.E1.m1.4.4.2.1.2.3"><csymbol cd="ambiguous" id="S2.E1.m1.4.4.2.1.2.3.1.cmml" xref="S2.E1.m1.4.4.2.1.2.3">subscript</csymbol><ci id="S2.E1.m1.4.4.2.1.2.3.2.cmml" xref="S2.E1.m1.4.4.2.1.2.3.2">𝑁</ci><ci id="S2.E1.m1.4.4.2.1.2.3.3.cmml" xref="S2.E1.m1.4.4.2.1.2.3.3">𝑠</ci></apply></apply><apply id="S2.E1.m1.4.4.2.1.1.cmml" xref="S2.E1.m1.4.4.2.1.1"><times id="S2.E1.m1.4.4.2.1.1.2.cmml" xref="S2.E1.m1.4.4.2.1.1.2"></times><ci id="S2.E1.m1.4.4.2.1.1.3.cmml" xref="S2.E1.m1.4.4.2.1.1.3">𝐿</ci><interval closure="open" id="S2.E1.m1.4.4.2.1.1.1.2.cmml" xref="S2.E1.m1.4.4.2.1.1.1.1"><apply id="S2.E1.m1.4.4.2.1.1.1.1.1.cmml" xref="S2.E1.m1.4.4.2.1.1.1.1.1"><csymbol cd="ambiguous" id="S2.E1.m1.4.4.2.1.1.1.1.1.1.cmml" xref="S2.E1.m1.4.4.2.1.1.1.1.1">subscript</csymbol><ci id="S2.E1.m1.4.4.2.1.1.1.1.1.2.cmml" xref="S2.E1.m1.4.4.2.1.1.1.1.1.2">𝒟</ci><apply id="S2.E1.m1.4.4.2.1.1.1.1.1.3.cmml" xref="S2.E1.m1.4.4.2.1.1.1.1.1.3"><times id="S2.E1.m1.4.4.2.1.1.1.1.1.3.1.cmml" xref="S2.E1.m1.4.4.2.1.1.1.1.1.3.1"></times><ci id="S2.E1.m1.4.4.2.1.1.1.1.1.3.2.cmml" xref="S2.E1.m1.4.4.2.1.1.1.1.1.3.2">𝑠</ci><ci id="S2.E1.m1.4.4.2.1.1.1.1.1.3.3.cmml" xref="S2.E1.m1.4.4.2.1.1.1.1.1.3.3">𝑖</ci></apply></apply><ci id="S2.E1.m1.2.2.cmml" xref="S2.E1.m1.2.2">𝐰</ci></interval></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.E1.m1.4c">\displaystyle\mathcal{L}_{s}(\mathcal{D}_{s},\mathbf{w}):=\frac{1}{N_{s}}\sum_{i=1}^{N_{s}}L(\mathcal{D}_{si},\mathbf{w})</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(1)</span></td>
</tr></tbody>
</table>
<p id="S2.p1.11" class="ltx_p">where <math id="S2.p1.4.m1.1" class="ltx_Math" alttext="s" display="inline"><semantics id="S2.p1.4.m1.1a"><mi id="S2.p1.4.m1.1.1" xref="S2.p1.4.m1.1.1.cmml">s</mi><annotation-xml encoding="MathML-Content" id="S2.p1.4.m1.1b"><ci id="S2.p1.4.m1.1.1.cmml" xref="S2.p1.4.m1.1.1">𝑠</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.p1.4.m1.1c">s</annotation></semantics></math> indexes the device, <math id="S2.p1.5.m2.1" class="ltx_Math" alttext="\mathcal{D}_{s}" display="inline"><semantics id="S2.p1.5.m2.1a"><msub id="S2.p1.5.m2.1.1" xref="S2.p1.5.m2.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S2.p1.5.m2.1.1.2" xref="S2.p1.5.m2.1.1.2.cmml">𝒟</mi><mi id="S2.p1.5.m2.1.1.3" xref="S2.p1.5.m2.1.1.3.cmml">s</mi></msub><annotation-xml encoding="MathML-Content" id="S2.p1.5.m2.1b"><apply id="S2.p1.5.m2.1.1.cmml" xref="S2.p1.5.m2.1.1"><csymbol cd="ambiguous" id="S2.p1.5.m2.1.1.1.cmml" xref="S2.p1.5.m2.1.1">subscript</csymbol><ci id="S2.p1.5.m2.1.1.2.cmml" xref="S2.p1.5.m2.1.1.2">𝒟</ci><ci id="S2.p1.5.m2.1.1.3.cmml" xref="S2.p1.5.m2.1.1.3">𝑠</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.p1.5.m2.1c">\mathcal{D}_{s}</annotation></semantics></math> corresponds to the dataset at device <math id="S2.p1.6.m3.1" class="ltx_Math" alttext="s" display="inline"><semantics id="S2.p1.6.m3.1a"><mi id="S2.p1.6.m3.1.1" xref="S2.p1.6.m3.1.1.cmml">s</mi><annotation-xml encoding="MathML-Content" id="S2.p1.6.m3.1b"><ci id="S2.p1.6.m3.1.1.cmml" xref="S2.p1.6.m3.1.1">𝑠</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.p1.6.m3.1c">s</annotation></semantics></math> and <math id="S2.p1.7.m4.1" class="ltx_Math" alttext="N_{s}" display="inline"><semantics id="S2.p1.7.m4.1a"><msub id="S2.p1.7.m4.1.1" xref="S2.p1.7.m4.1.1.cmml"><mi id="S2.p1.7.m4.1.1.2" xref="S2.p1.7.m4.1.1.2.cmml">N</mi><mi id="S2.p1.7.m4.1.1.3" xref="S2.p1.7.m4.1.1.3.cmml">s</mi></msub><annotation-xml encoding="MathML-Content" id="S2.p1.7.m4.1b"><apply id="S2.p1.7.m4.1.1.cmml" xref="S2.p1.7.m4.1.1"><csymbol cd="ambiguous" id="S2.p1.7.m4.1.1.1.cmml" xref="S2.p1.7.m4.1.1">subscript</csymbol><ci id="S2.p1.7.m4.1.1.2.cmml" xref="S2.p1.7.m4.1.1.2">𝑁</ci><ci id="S2.p1.7.m4.1.1.3.cmml" xref="S2.p1.7.m4.1.1.3">𝑠</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.p1.7.m4.1c">N_{s}</annotation></semantics></math> corresponds to its size. After a specific amount of epochs of optimization on <math id="S2.p1.8.m5.1" class="ltx_Math" alttext="\mathcal{L}_{s}" display="inline"><semantics id="S2.p1.8.m5.1a"><msub id="S2.p1.8.m5.1.1" xref="S2.p1.8.m5.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S2.p1.8.m5.1.1.2" xref="S2.p1.8.m5.1.1.2.cmml">ℒ</mi><mi id="S2.p1.8.m5.1.1.3" xref="S2.p1.8.m5.1.1.3.cmml">s</mi></msub><annotation-xml encoding="MathML-Content" id="S2.p1.8.m5.1b"><apply id="S2.p1.8.m5.1.1.cmml" xref="S2.p1.8.m5.1.1"><csymbol cd="ambiguous" id="S2.p1.8.m5.1.1.1.cmml" xref="S2.p1.8.m5.1.1">subscript</csymbol><ci id="S2.p1.8.m5.1.1.2.cmml" xref="S2.p1.8.m5.1.1.2">ℒ</ci><ci id="S2.p1.8.m5.1.1.3.cmml" xref="S2.p1.8.m5.1.1.3">𝑠</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.p1.8.m5.1c">\mathcal{L}_{s}</annotation></semantics></math> is performed, denoted as <math id="S2.p1.9.m6.1" class="ltx_Math" alttext="E" display="inline"><semantics id="S2.p1.9.m6.1a"><mi id="S2.p1.9.m6.1.1" xref="S2.p1.9.m6.1.1.cmml">E</mi><annotation-xml encoding="MathML-Content" id="S2.p1.9.m6.1b"><ci id="S2.p1.9.m6.1.1.cmml" xref="S2.p1.9.m6.1.1">𝐸</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.p1.9.m6.1c">E</annotation></semantics></math>, the devices communicate the current state of their parameters, let it be <math id="S2.p1.10.m7.1" class="ltx_Math" alttext="\bm{\phi}_{s}" display="inline"><semantics id="S2.p1.10.m7.1a"><msub id="S2.p1.10.m7.1.1" xref="S2.p1.10.m7.1.1.cmml"><mi class="ltx_mathvariant_bold-italic" mathvariant="bold-italic" id="S2.p1.10.m7.1.1.2" xref="S2.p1.10.m7.1.1.2.cmml">ϕ</mi><mi id="S2.p1.10.m7.1.1.3" xref="S2.p1.10.m7.1.1.3.cmml">s</mi></msub><annotation-xml encoding="MathML-Content" id="S2.p1.10.m7.1b"><apply id="S2.p1.10.m7.1.1.cmml" xref="S2.p1.10.m7.1.1"><csymbol cd="ambiguous" id="S2.p1.10.m7.1.1.1.cmml" xref="S2.p1.10.m7.1.1">subscript</csymbol><ci id="S2.p1.10.m7.1.1.2.cmml" xref="S2.p1.10.m7.1.1.2">bold-italic-ϕ</ci><ci id="S2.p1.10.m7.1.1.3.cmml" xref="S2.p1.10.m7.1.1.3">𝑠</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.p1.10.m7.1c">\bm{\phi}_{s}</annotation></semantics></math>, to the server. The server then performs an update to its own model by simply averaging the client specific parameters
<math id="S2.p1.11.m8.1" class="ltx_Math" alttext="\mathbf{w}_{t}=\frac{1}{S}\sum_{s}\bm{\phi}_{s}." display="inline"><semantics id="S2.p1.11.m8.1a"><mrow id="S2.p1.11.m8.1.1.1" xref="S2.p1.11.m8.1.1.1.1.cmml"><mrow id="S2.p1.11.m8.1.1.1.1" xref="S2.p1.11.m8.1.1.1.1.cmml"><msub id="S2.p1.11.m8.1.1.1.1.2" xref="S2.p1.11.m8.1.1.1.1.2.cmml"><mi id="S2.p1.11.m8.1.1.1.1.2.2" xref="S2.p1.11.m8.1.1.1.1.2.2.cmml">𝐰</mi><mi id="S2.p1.11.m8.1.1.1.1.2.3" xref="S2.p1.11.m8.1.1.1.1.2.3.cmml">t</mi></msub><mo id="S2.p1.11.m8.1.1.1.1.1" xref="S2.p1.11.m8.1.1.1.1.1.cmml">=</mo><mrow id="S2.p1.11.m8.1.1.1.1.3" xref="S2.p1.11.m8.1.1.1.1.3.cmml"><mfrac id="S2.p1.11.m8.1.1.1.1.3.2" xref="S2.p1.11.m8.1.1.1.1.3.2.cmml"><mn id="S2.p1.11.m8.1.1.1.1.3.2.2" xref="S2.p1.11.m8.1.1.1.1.3.2.2.cmml">1</mn><mi id="S2.p1.11.m8.1.1.1.1.3.2.3" xref="S2.p1.11.m8.1.1.1.1.3.2.3.cmml">S</mi></mfrac><mo lspace="0em" rspace="0em" id="S2.p1.11.m8.1.1.1.1.3.1" xref="S2.p1.11.m8.1.1.1.1.3.1.cmml">​</mo><mrow id="S2.p1.11.m8.1.1.1.1.3.3" xref="S2.p1.11.m8.1.1.1.1.3.3.cmml"><msub id="S2.p1.11.m8.1.1.1.1.3.3.1" xref="S2.p1.11.m8.1.1.1.1.3.3.1.cmml"><mo id="S2.p1.11.m8.1.1.1.1.3.3.1.2" xref="S2.p1.11.m8.1.1.1.1.3.3.1.2.cmml">∑</mo><mi id="S2.p1.11.m8.1.1.1.1.3.3.1.3" xref="S2.p1.11.m8.1.1.1.1.3.3.1.3.cmml">s</mi></msub><msub id="S2.p1.11.m8.1.1.1.1.3.3.2" xref="S2.p1.11.m8.1.1.1.1.3.3.2.cmml"><mi class="ltx_mathvariant_bold-italic" mathvariant="bold-italic" id="S2.p1.11.m8.1.1.1.1.3.3.2.2" xref="S2.p1.11.m8.1.1.1.1.3.3.2.2.cmml">ϕ</mi><mi id="S2.p1.11.m8.1.1.1.1.3.3.2.3" xref="S2.p1.11.m8.1.1.1.1.3.3.2.3.cmml">s</mi></msub></mrow></mrow></mrow><mo lspace="0em" id="S2.p1.11.m8.1.1.1.2" xref="S2.p1.11.m8.1.1.1.1.cmml">.</mo></mrow><annotation-xml encoding="MathML-Content" id="S2.p1.11.m8.1b"><apply id="S2.p1.11.m8.1.1.1.1.cmml" xref="S2.p1.11.m8.1.1.1"><eq id="S2.p1.11.m8.1.1.1.1.1.cmml" xref="S2.p1.11.m8.1.1.1.1.1"></eq><apply id="S2.p1.11.m8.1.1.1.1.2.cmml" xref="S2.p1.11.m8.1.1.1.1.2"><csymbol cd="ambiguous" id="S2.p1.11.m8.1.1.1.1.2.1.cmml" xref="S2.p1.11.m8.1.1.1.1.2">subscript</csymbol><ci id="S2.p1.11.m8.1.1.1.1.2.2.cmml" xref="S2.p1.11.m8.1.1.1.1.2.2">𝐰</ci><ci id="S2.p1.11.m8.1.1.1.1.2.3.cmml" xref="S2.p1.11.m8.1.1.1.1.2.3">𝑡</ci></apply><apply id="S2.p1.11.m8.1.1.1.1.3.cmml" xref="S2.p1.11.m8.1.1.1.1.3"><times id="S2.p1.11.m8.1.1.1.1.3.1.cmml" xref="S2.p1.11.m8.1.1.1.1.3.1"></times><apply id="S2.p1.11.m8.1.1.1.1.3.2.cmml" xref="S2.p1.11.m8.1.1.1.1.3.2"><divide id="S2.p1.11.m8.1.1.1.1.3.2.1.cmml" xref="S2.p1.11.m8.1.1.1.1.3.2"></divide><cn type="integer" id="S2.p1.11.m8.1.1.1.1.3.2.2.cmml" xref="S2.p1.11.m8.1.1.1.1.3.2.2">1</cn><ci id="S2.p1.11.m8.1.1.1.1.3.2.3.cmml" xref="S2.p1.11.m8.1.1.1.1.3.2.3">𝑆</ci></apply><apply id="S2.p1.11.m8.1.1.1.1.3.3.cmml" xref="S2.p1.11.m8.1.1.1.1.3.3"><apply id="S2.p1.11.m8.1.1.1.1.3.3.1.cmml" xref="S2.p1.11.m8.1.1.1.1.3.3.1"><csymbol cd="ambiguous" id="S2.p1.11.m8.1.1.1.1.3.3.1.1.cmml" xref="S2.p1.11.m8.1.1.1.1.3.3.1">subscript</csymbol><sum id="S2.p1.11.m8.1.1.1.1.3.3.1.2.cmml" xref="S2.p1.11.m8.1.1.1.1.3.3.1.2"></sum><ci id="S2.p1.11.m8.1.1.1.1.3.3.1.3.cmml" xref="S2.p1.11.m8.1.1.1.1.3.3.1.3">𝑠</ci></apply><apply id="S2.p1.11.m8.1.1.1.1.3.3.2.cmml" xref="S2.p1.11.m8.1.1.1.1.3.3.2"><csymbol cd="ambiguous" id="S2.p1.11.m8.1.1.1.1.3.3.2.1.cmml" xref="S2.p1.11.m8.1.1.1.1.3.3.2">subscript</csymbol><ci id="S2.p1.11.m8.1.1.1.1.3.3.2.2.cmml" xref="S2.p1.11.m8.1.1.1.1.3.3.2.2">bold-italic-ϕ</ci><ci id="S2.p1.11.m8.1.1.1.1.3.3.2.3.cmml" xref="S2.p1.11.m8.1.1.1.1.3.3.2.3">𝑠</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.p1.11.m8.1c">\mathbf{w}_{t}=\frac{1}{S}\sum_{s}\bm{\phi}_{s}.</annotation></semantics></math></p>
</div>
<section id="S2.SS1" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">2.1 </span><span id="S2.SS1.1.1" class="ltx_text ltx_font_typewriter">FedAvg</span> as learning in a hierarchical model</h3>

<div id="S2.SS1.p1" class="ltx_para">
<p id="S2.SS1.p1.12" class="ltx_p">We now ask the following question; does the <span id="S2.SS1.p1.12.1" class="ltx_text ltx_font_typewriter">FedAvg</span> algorithm correspond to learning on a specific model?
Let us consider the following objective function:</p>
<table id="A10.EGx2" class="ltx_equationgroup ltx_eqn_align ltx_eqn_table">

<tbody id="S2.E2"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math id="S2.E2.m1.1" class="ltx_Math" alttext="\displaystyle\operatorname*{arg\,max}_{\mathbf{w}}\sum_{s=1}^{S}\log p(\mathcal{D}_{s}|\mathbf{w})," display="inline"><semantics id="S2.E2.m1.1a"><mrow id="S2.E2.m1.1.1.1" xref="S2.E2.m1.1.1.1.1.cmml"><mrow id="S2.E2.m1.1.1.1.1" xref="S2.E2.m1.1.1.1.1.cmml"><munder id="S2.E2.m1.1.1.1.1.3" xref="S2.E2.m1.1.1.1.1.3.cmml"><mrow id="S2.E2.m1.1.1.1.1.3.2" xref="S2.E2.m1.1.1.1.1.3.2.cmml"><mi id="S2.E2.m1.1.1.1.1.3.2.2" xref="S2.E2.m1.1.1.1.1.3.2.2.cmml">arg</mi><mo lspace="0.170em" rspace="0em" id="S2.E2.m1.1.1.1.1.3.2.1" xref="S2.E2.m1.1.1.1.1.3.2.1.cmml">​</mo><mi id="S2.E2.m1.1.1.1.1.3.2.3" xref="S2.E2.m1.1.1.1.1.3.2.3.cmml">max</mi></mrow><mi id="S2.E2.m1.1.1.1.1.3.3" xref="S2.E2.m1.1.1.1.1.3.3.cmml">𝐰</mi></munder><mo lspace="0.167em" rspace="0em" id="S2.E2.m1.1.1.1.1.2" xref="S2.E2.m1.1.1.1.1.2.cmml">​</mo><mrow id="S2.E2.m1.1.1.1.1.1" xref="S2.E2.m1.1.1.1.1.1.cmml"><mstyle displaystyle="true" id="S2.E2.m1.1.1.1.1.1.2" xref="S2.E2.m1.1.1.1.1.1.2.cmml"><munderover id="S2.E2.m1.1.1.1.1.1.2a" xref="S2.E2.m1.1.1.1.1.1.2.cmml"><mo movablelimits="false" id="S2.E2.m1.1.1.1.1.1.2.2.2" xref="S2.E2.m1.1.1.1.1.1.2.2.2.cmml">∑</mo><mrow id="S2.E2.m1.1.1.1.1.1.2.2.3" xref="S2.E2.m1.1.1.1.1.1.2.2.3.cmml"><mi id="S2.E2.m1.1.1.1.1.1.2.2.3.2" xref="S2.E2.m1.1.1.1.1.1.2.2.3.2.cmml">s</mi><mo id="S2.E2.m1.1.1.1.1.1.2.2.3.1" xref="S2.E2.m1.1.1.1.1.1.2.2.3.1.cmml">=</mo><mn id="S2.E2.m1.1.1.1.1.1.2.2.3.3" xref="S2.E2.m1.1.1.1.1.1.2.2.3.3.cmml">1</mn></mrow><mi id="S2.E2.m1.1.1.1.1.1.2.3" xref="S2.E2.m1.1.1.1.1.1.2.3.cmml">S</mi></munderover></mstyle><mrow id="S2.E2.m1.1.1.1.1.1.1" xref="S2.E2.m1.1.1.1.1.1.1.cmml"><mrow id="S2.E2.m1.1.1.1.1.1.1.3" xref="S2.E2.m1.1.1.1.1.1.1.3.cmml"><mi id="S2.E2.m1.1.1.1.1.1.1.3.1" xref="S2.E2.m1.1.1.1.1.1.1.3.1.cmml">log</mi><mo lspace="0.167em" id="S2.E2.m1.1.1.1.1.1.1.3a" xref="S2.E2.m1.1.1.1.1.1.1.3.cmml">⁡</mo><mi id="S2.E2.m1.1.1.1.1.1.1.3.2" xref="S2.E2.m1.1.1.1.1.1.1.3.2.cmml">p</mi></mrow><mo lspace="0em" rspace="0em" id="S2.E2.m1.1.1.1.1.1.1.2" xref="S2.E2.m1.1.1.1.1.1.1.2.cmml">​</mo><mrow id="S2.E2.m1.1.1.1.1.1.1.1.1" xref="S2.E2.m1.1.1.1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S2.E2.m1.1.1.1.1.1.1.1.1.2" xref="S2.E2.m1.1.1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="S2.E2.m1.1.1.1.1.1.1.1.1.1" xref="S2.E2.m1.1.1.1.1.1.1.1.1.1.cmml"><msub id="S2.E2.m1.1.1.1.1.1.1.1.1.1.2" xref="S2.E2.m1.1.1.1.1.1.1.1.1.1.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S2.E2.m1.1.1.1.1.1.1.1.1.1.2.2" xref="S2.E2.m1.1.1.1.1.1.1.1.1.1.2.2.cmml">𝒟</mi><mi id="S2.E2.m1.1.1.1.1.1.1.1.1.1.2.3" xref="S2.E2.m1.1.1.1.1.1.1.1.1.1.2.3.cmml">s</mi></msub><mo fence="false" id="S2.E2.m1.1.1.1.1.1.1.1.1.1.1" xref="S2.E2.m1.1.1.1.1.1.1.1.1.1.1.cmml">|</mo><mi id="S2.E2.m1.1.1.1.1.1.1.1.1.1.3" xref="S2.E2.m1.1.1.1.1.1.1.1.1.1.3.cmml">𝐰</mi></mrow><mo stretchy="false" id="S2.E2.m1.1.1.1.1.1.1.1.1.3" xref="S2.E2.m1.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow></mrow><mo id="S2.E2.m1.1.1.1.2" xref="S2.E2.m1.1.1.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S2.E2.m1.1b"><apply id="S2.E2.m1.1.1.1.1.cmml" xref="S2.E2.m1.1.1.1"><times id="S2.E2.m1.1.1.1.1.2.cmml" xref="S2.E2.m1.1.1.1.1.2"></times><apply id="S2.E2.m1.1.1.1.1.3.cmml" xref="S2.E2.m1.1.1.1.1.3"><csymbol cd="ambiguous" id="S2.E2.m1.1.1.1.1.3.1.cmml" xref="S2.E2.m1.1.1.1.1.3">subscript</csymbol><apply id="S2.E2.m1.1.1.1.1.3.2.cmml" xref="S2.E2.m1.1.1.1.1.3.2"><times id="S2.E2.m1.1.1.1.1.3.2.1.cmml" xref="S2.E2.m1.1.1.1.1.3.2.1"></times><ci id="S2.E2.m1.1.1.1.1.3.2.2.cmml" xref="S2.E2.m1.1.1.1.1.3.2.2">arg</ci><ci id="S2.E2.m1.1.1.1.1.3.2.3.cmml" xref="S2.E2.m1.1.1.1.1.3.2.3">max</ci></apply><ci id="S2.E2.m1.1.1.1.1.3.3.cmml" xref="S2.E2.m1.1.1.1.1.3.3">𝐰</ci></apply><apply id="S2.E2.m1.1.1.1.1.1.cmml" xref="S2.E2.m1.1.1.1.1.1"><apply id="S2.E2.m1.1.1.1.1.1.2.cmml" xref="S2.E2.m1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S2.E2.m1.1.1.1.1.1.2.1.cmml" xref="S2.E2.m1.1.1.1.1.1.2">superscript</csymbol><apply id="S2.E2.m1.1.1.1.1.1.2.2.cmml" xref="S2.E2.m1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S2.E2.m1.1.1.1.1.1.2.2.1.cmml" xref="S2.E2.m1.1.1.1.1.1.2">subscript</csymbol><sum id="S2.E2.m1.1.1.1.1.1.2.2.2.cmml" xref="S2.E2.m1.1.1.1.1.1.2.2.2"></sum><apply id="S2.E2.m1.1.1.1.1.1.2.2.3.cmml" xref="S2.E2.m1.1.1.1.1.1.2.2.3"><eq id="S2.E2.m1.1.1.1.1.1.2.2.3.1.cmml" xref="S2.E2.m1.1.1.1.1.1.2.2.3.1"></eq><ci id="S2.E2.m1.1.1.1.1.1.2.2.3.2.cmml" xref="S2.E2.m1.1.1.1.1.1.2.2.3.2">𝑠</ci><cn type="integer" id="S2.E2.m1.1.1.1.1.1.2.2.3.3.cmml" xref="S2.E2.m1.1.1.1.1.1.2.2.3.3">1</cn></apply></apply><ci id="S2.E2.m1.1.1.1.1.1.2.3.cmml" xref="S2.E2.m1.1.1.1.1.1.2.3">𝑆</ci></apply><apply id="S2.E2.m1.1.1.1.1.1.1.cmml" xref="S2.E2.m1.1.1.1.1.1.1"><times id="S2.E2.m1.1.1.1.1.1.1.2.cmml" xref="S2.E2.m1.1.1.1.1.1.1.2"></times><apply id="S2.E2.m1.1.1.1.1.1.1.3.cmml" xref="S2.E2.m1.1.1.1.1.1.1.3"><log id="S2.E2.m1.1.1.1.1.1.1.3.1.cmml" xref="S2.E2.m1.1.1.1.1.1.1.3.1"></log><ci id="S2.E2.m1.1.1.1.1.1.1.3.2.cmml" xref="S2.E2.m1.1.1.1.1.1.1.3.2">𝑝</ci></apply><apply id="S2.E2.m1.1.1.1.1.1.1.1.1.1.cmml" xref="S2.E2.m1.1.1.1.1.1.1.1.1"><csymbol cd="latexml" id="S2.E2.m1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S2.E2.m1.1.1.1.1.1.1.1.1.1.1">conditional</csymbol><apply id="S2.E2.m1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S2.E2.m1.1.1.1.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S2.E2.m1.1.1.1.1.1.1.1.1.1.2.1.cmml" xref="S2.E2.m1.1.1.1.1.1.1.1.1.1.2">subscript</csymbol><ci id="S2.E2.m1.1.1.1.1.1.1.1.1.1.2.2.cmml" xref="S2.E2.m1.1.1.1.1.1.1.1.1.1.2.2">𝒟</ci><ci id="S2.E2.m1.1.1.1.1.1.1.1.1.1.2.3.cmml" xref="S2.E2.m1.1.1.1.1.1.1.1.1.1.2.3">𝑠</ci></apply><ci id="S2.E2.m1.1.1.1.1.1.1.1.1.1.3.cmml" xref="S2.E2.m1.1.1.1.1.1.1.1.1.1.3">𝐰</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.E2.m1.1c">\displaystyle\operatorname*{arg\,max}_{\mathbf{w}}\sum_{s=1}^{S}\log p(\mathcal{D}_{s}|\mathbf{w}),</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(2)</span></td>
</tr></tbody>
</table>
<p id="S2.SS1.p1.5" class="ltx_p">where <math id="S2.SS1.p1.1.m1.1" class="ltx_Math" alttext="\mathcal{D}_{s}" display="inline"><semantics id="S2.SS1.p1.1.m1.1a"><msub id="S2.SS1.p1.1.m1.1.1" xref="S2.SS1.p1.1.m1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S2.SS1.p1.1.m1.1.1.2" xref="S2.SS1.p1.1.m1.1.1.2.cmml">𝒟</mi><mi id="S2.SS1.p1.1.m1.1.1.3" xref="S2.SS1.p1.1.m1.1.1.3.cmml">s</mi></msub><annotation-xml encoding="MathML-Content" id="S2.SS1.p1.1.m1.1b"><apply id="S2.SS1.p1.1.m1.1.1.cmml" xref="S2.SS1.p1.1.m1.1.1"><csymbol cd="ambiguous" id="S2.SS1.p1.1.m1.1.1.1.cmml" xref="S2.SS1.p1.1.m1.1.1">subscript</csymbol><ci id="S2.SS1.p1.1.m1.1.1.2.cmml" xref="S2.SS1.p1.1.m1.1.1.2">𝒟</ci><ci id="S2.SS1.p1.1.m1.1.1.3.cmml" xref="S2.SS1.p1.1.m1.1.1.3">𝑠</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p1.1.m1.1c">\mathcal{D}_{s}</annotation></semantics></math> corresponds to the shard specific dataset that has <math id="S2.SS1.p1.2.m2.1" class="ltx_Math" alttext="N_{s}" display="inline"><semantics id="S2.SS1.p1.2.m2.1a"><msub id="S2.SS1.p1.2.m2.1.1" xref="S2.SS1.p1.2.m2.1.1.cmml"><mi id="S2.SS1.p1.2.m2.1.1.2" xref="S2.SS1.p1.2.m2.1.1.2.cmml">N</mi><mi id="S2.SS1.p1.2.m2.1.1.3" xref="S2.SS1.p1.2.m2.1.1.3.cmml">s</mi></msub><annotation-xml encoding="MathML-Content" id="S2.SS1.p1.2.m2.1b"><apply id="S2.SS1.p1.2.m2.1.1.cmml" xref="S2.SS1.p1.2.m2.1.1"><csymbol cd="ambiguous" id="S2.SS1.p1.2.m2.1.1.1.cmml" xref="S2.SS1.p1.2.m2.1.1">subscript</csymbol><ci id="S2.SS1.p1.2.m2.1.1.2.cmml" xref="S2.SS1.p1.2.m2.1.1.2">𝑁</ci><ci id="S2.SS1.p1.2.m2.1.1.3.cmml" xref="S2.SS1.p1.2.m2.1.1.3">𝑠</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p1.2.m2.1c">N_{s}</annotation></semantics></math> datapoints, <math id="S2.SS1.p1.3.m3.1" class="ltx_Math" alttext="p(\mathcal{D}_{s}|\mathbf{w})" display="inline"><semantics id="S2.SS1.p1.3.m3.1a"><mrow id="S2.SS1.p1.3.m3.1.1" xref="S2.SS1.p1.3.m3.1.1.cmml"><mi id="S2.SS1.p1.3.m3.1.1.3" xref="S2.SS1.p1.3.m3.1.1.3.cmml">p</mi><mo lspace="0em" rspace="0em" id="S2.SS1.p1.3.m3.1.1.2" xref="S2.SS1.p1.3.m3.1.1.2.cmml">​</mo><mrow id="S2.SS1.p1.3.m3.1.1.1.1" xref="S2.SS1.p1.3.m3.1.1.1.1.1.cmml"><mo stretchy="false" id="S2.SS1.p1.3.m3.1.1.1.1.2" xref="S2.SS1.p1.3.m3.1.1.1.1.1.cmml">(</mo><mrow id="S2.SS1.p1.3.m3.1.1.1.1.1" xref="S2.SS1.p1.3.m3.1.1.1.1.1.cmml"><msub id="S2.SS1.p1.3.m3.1.1.1.1.1.2" xref="S2.SS1.p1.3.m3.1.1.1.1.1.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S2.SS1.p1.3.m3.1.1.1.1.1.2.2" xref="S2.SS1.p1.3.m3.1.1.1.1.1.2.2.cmml">𝒟</mi><mi id="S2.SS1.p1.3.m3.1.1.1.1.1.2.3" xref="S2.SS1.p1.3.m3.1.1.1.1.1.2.3.cmml">s</mi></msub><mo fence="false" id="S2.SS1.p1.3.m3.1.1.1.1.1.1" xref="S2.SS1.p1.3.m3.1.1.1.1.1.1.cmml">|</mo><mi id="S2.SS1.p1.3.m3.1.1.1.1.1.3" xref="S2.SS1.p1.3.m3.1.1.1.1.1.3.cmml">𝐰</mi></mrow><mo stretchy="false" id="S2.SS1.p1.3.m3.1.1.1.1.3" xref="S2.SS1.p1.3.m3.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.SS1.p1.3.m3.1b"><apply id="S2.SS1.p1.3.m3.1.1.cmml" xref="S2.SS1.p1.3.m3.1.1"><times id="S2.SS1.p1.3.m3.1.1.2.cmml" xref="S2.SS1.p1.3.m3.1.1.2"></times><ci id="S2.SS1.p1.3.m3.1.1.3.cmml" xref="S2.SS1.p1.3.m3.1.1.3">𝑝</ci><apply id="S2.SS1.p1.3.m3.1.1.1.1.1.cmml" xref="S2.SS1.p1.3.m3.1.1.1.1"><csymbol cd="latexml" id="S2.SS1.p1.3.m3.1.1.1.1.1.1.cmml" xref="S2.SS1.p1.3.m3.1.1.1.1.1.1">conditional</csymbol><apply id="S2.SS1.p1.3.m3.1.1.1.1.1.2.cmml" xref="S2.SS1.p1.3.m3.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S2.SS1.p1.3.m3.1.1.1.1.1.2.1.cmml" xref="S2.SS1.p1.3.m3.1.1.1.1.1.2">subscript</csymbol><ci id="S2.SS1.p1.3.m3.1.1.1.1.1.2.2.cmml" xref="S2.SS1.p1.3.m3.1.1.1.1.1.2.2">𝒟</ci><ci id="S2.SS1.p1.3.m3.1.1.1.1.1.2.3.cmml" xref="S2.SS1.p1.3.m3.1.1.1.1.1.2.3">𝑠</ci></apply><ci id="S2.SS1.p1.3.m3.1.1.1.1.1.3.cmml" xref="S2.SS1.p1.3.m3.1.1.1.1.1.3">𝐰</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p1.3.m3.1c">p(\mathcal{D}_{s}|\mathbf{w})</annotation></semantics></math> corresponds to the likelihood of <math id="S2.SS1.p1.4.m4.1" class="ltx_Math" alttext="\mathcal{D}_{s}" display="inline"><semantics id="S2.SS1.p1.4.m4.1a"><msub id="S2.SS1.p1.4.m4.1.1" xref="S2.SS1.p1.4.m4.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S2.SS1.p1.4.m4.1.1.2" xref="S2.SS1.p1.4.m4.1.1.2.cmml">𝒟</mi><mi id="S2.SS1.p1.4.m4.1.1.3" xref="S2.SS1.p1.4.m4.1.1.3.cmml">s</mi></msub><annotation-xml encoding="MathML-Content" id="S2.SS1.p1.4.m4.1b"><apply id="S2.SS1.p1.4.m4.1.1.cmml" xref="S2.SS1.p1.4.m4.1.1"><csymbol cd="ambiguous" id="S2.SS1.p1.4.m4.1.1.1.cmml" xref="S2.SS1.p1.4.m4.1.1">subscript</csymbol><ci id="S2.SS1.p1.4.m4.1.1.2.cmml" xref="S2.SS1.p1.4.m4.1.1.2">𝒟</ci><ci id="S2.SS1.p1.4.m4.1.1.3.cmml" xref="S2.SS1.p1.4.m4.1.1.3">𝑠</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p1.4.m4.1c">\mathcal{D}_{s}</annotation></semantics></math> under the server parameters <math id="S2.SS1.p1.5.m5.1" class="ltx_Math" alttext="\mathbf{w}" display="inline"><semantics id="S2.SS1.p1.5.m5.1a"><mi id="S2.SS1.p1.5.m5.1.1" xref="S2.SS1.p1.5.m5.1.1.cmml">𝐰</mi><annotation-xml encoding="MathML-Content" id="S2.SS1.p1.5.m5.1b"><ci id="S2.SS1.p1.5.m5.1.1.cmml" xref="S2.SS1.p1.5.m5.1.1">𝐰</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p1.5.m5.1c">\mathbf{w}</annotation></semantics></math>. Now consider decomposing each of the shard specific likelihoods as follows:</p>
<table id="A10.EGx3" class="ltx_equationgroup ltx_eqn_align ltx_eqn_table">

<tbody id="S2.E3"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math id="S2.E3.m1.2" class="ltx_Math" alttext="\displaystyle p(\mathcal{D}_{s}|\mathbf{w})=\int p(\mathcal{D}_{s}|\bm{\phi}_{s})p(\bm{\phi}_{s}|\mathbf{w})\mathrm{d}\bm{\phi}_{s},\quad p(\bm{\phi}_{s}|\mathbf{w})=\frac{1}{Z}\exp\left(-\frac{\lambda}{2}\|\bm{\phi}_{s}-\mathbf{w}\|^{2}\right)," display="inline"><semantics id="S2.E3.m1.2a"><mrow id="S2.E3.m1.2.2.1"><mrow id="S2.E3.m1.2.2.1.1.2" xref="S2.E3.m1.2.2.1.1.3.cmml"><mrow id="S2.E3.m1.2.2.1.1.1.1" xref="S2.E3.m1.2.2.1.1.1.1.cmml"><mrow id="S2.E3.m1.2.2.1.1.1.1.1" xref="S2.E3.m1.2.2.1.1.1.1.1.cmml"><mi id="S2.E3.m1.2.2.1.1.1.1.1.3" xref="S2.E3.m1.2.2.1.1.1.1.1.3.cmml">p</mi><mo lspace="0em" rspace="0em" id="S2.E3.m1.2.2.1.1.1.1.1.2" xref="S2.E3.m1.2.2.1.1.1.1.1.2.cmml">​</mo><mrow id="S2.E3.m1.2.2.1.1.1.1.1.1.1" xref="S2.E3.m1.2.2.1.1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S2.E3.m1.2.2.1.1.1.1.1.1.1.2" xref="S2.E3.m1.2.2.1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="S2.E3.m1.2.2.1.1.1.1.1.1.1.1" xref="S2.E3.m1.2.2.1.1.1.1.1.1.1.1.cmml"><msub id="S2.E3.m1.2.2.1.1.1.1.1.1.1.1.2" xref="S2.E3.m1.2.2.1.1.1.1.1.1.1.1.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S2.E3.m1.2.2.1.1.1.1.1.1.1.1.2.2" xref="S2.E3.m1.2.2.1.1.1.1.1.1.1.1.2.2.cmml">𝒟</mi><mi id="S2.E3.m1.2.2.1.1.1.1.1.1.1.1.2.3" xref="S2.E3.m1.2.2.1.1.1.1.1.1.1.1.2.3.cmml">s</mi></msub><mo fence="false" id="S2.E3.m1.2.2.1.1.1.1.1.1.1.1.1" xref="S2.E3.m1.2.2.1.1.1.1.1.1.1.1.1.cmml">|</mo><mi id="S2.E3.m1.2.2.1.1.1.1.1.1.1.1.3" xref="S2.E3.m1.2.2.1.1.1.1.1.1.1.1.3.cmml">𝐰</mi></mrow><mo stretchy="false" id="S2.E3.m1.2.2.1.1.1.1.1.1.1.3" xref="S2.E3.m1.2.2.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S2.E3.m1.2.2.1.1.1.1.4" xref="S2.E3.m1.2.2.1.1.1.1.4.cmml">=</mo><mstyle displaystyle="true" id="S2.E3.m1.2.2.1.1.1.1.3" xref="S2.E3.m1.2.2.1.1.1.1.3.cmml"><mrow id="S2.E3.m1.2.2.1.1.1.1.3a" xref="S2.E3.m1.2.2.1.1.1.1.3.cmml"><mo id="S2.E3.m1.2.2.1.1.1.1.3.3" xref="S2.E3.m1.2.2.1.1.1.1.3.3.cmml">∫</mo><mrow id="S2.E3.m1.2.2.1.1.1.1.3.2" xref="S2.E3.m1.2.2.1.1.1.1.3.2.cmml"><mi id="S2.E3.m1.2.2.1.1.1.1.3.2.4" xref="S2.E3.m1.2.2.1.1.1.1.3.2.4.cmml">p</mi><mo lspace="0em" rspace="0em" id="S2.E3.m1.2.2.1.1.1.1.3.2.3" xref="S2.E3.m1.2.2.1.1.1.1.3.2.3.cmml">​</mo><mrow id="S2.E3.m1.2.2.1.1.1.1.2.1.1.1" xref="S2.E3.m1.2.2.1.1.1.1.2.1.1.1.1.cmml"><mo stretchy="false" id="S2.E3.m1.2.2.1.1.1.1.2.1.1.1.2" xref="S2.E3.m1.2.2.1.1.1.1.2.1.1.1.1.cmml">(</mo><mrow id="S2.E3.m1.2.2.1.1.1.1.2.1.1.1.1" xref="S2.E3.m1.2.2.1.1.1.1.2.1.1.1.1.cmml"><msub id="S2.E3.m1.2.2.1.1.1.1.2.1.1.1.1.2" xref="S2.E3.m1.2.2.1.1.1.1.2.1.1.1.1.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S2.E3.m1.2.2.1.1.1.1.2.1.1.1.1.2.2" xref="S2.E3.m1.2.2.1.1.1.1.2.1.1.1.1.2.2.cmml">𝒟</mi><mi id="S2.E3.m1.2.2.1.1.1.1.2.1.1.1.1.2.3" xref="S2.E3.m1.2.2.1.1.1.1.2.1.1.1.1.2.3.cmml">s</mi></msub><mo fence="false" id="S2.E3.m1.2.2.1.1.1.1.2.1.1.1.1.1" xref="S2.E3.m1.2.2.1.1.1.1.2.1.1.1.1.1.cmml">|</mo><msub id="S2.E3.m1.2.2.1.1.1.1.2.1.1.1.1.3" xref="S2.E3.m1.2.2.1.1.1.1.2.1.1.1.1.3.cmml"><mi class="ltx_mathvariant_bold-italic" mathvariant="bold-italic" id="S2.E3.m1.2.2.1.1.1.1.2.1.1.1.1.3.2" xref="S2.E3.m1.2.2.1.1.1.1.2.1.1.1.1.3.2.cmml">ϕ</mi><mi id="S2.E3.m1.2.2.1.1.1.1.2.1.1.1.1.3.3" xref="S2.E3.m1.2.2.1.1.1.1.2.1.1.1.1.3.3.cmml">s</mi></msub></mrow><mo stretchy="false" id="S2.E3.m1.2.2.1.1.1.1.2.1.1.1.3" xref="S2.E3.m1.2.2.1.1.1.1.2.1.1.1.1.cmml">)</mo></mrow><mo lspace="0em" rspace="0em" id="S2.E3.m1.2.2.1.1.1.1.3.2.3a" xref="S2.E3.m1.2.2.1.1.1.1.3.2.3.cmml">​</mo><mi id="S2.E3.m1.2.2.1.1.1.1.3.2.5" xref="S2.E3.m1.2.2.1.1.1.1.3.2.5.cmml">p</mi><mo lspace="0em" rspace="0em" id="S2.E3.m1.2.2.1.1.1.1.3.2.3b" xref="S2.E3.m1.2.2.1.1.1.1.3.2.3.cmml">​</mo><mrow id="S2.E3.m1.2.2.1.1.1.1.3.2.2.1" xref="S2.E3.m1.2.2.1.1.1.1.3.2.2.1.1.cmml"><mo stretchy="false" id="S2.E3.m1.2.2.1.1.1.1.3.2.2.1.2" xref="S2.E3.m1.2.2.1.1.1.1.3.2.2.1.1.cmml">(</mo><mrow id="S2.E3.m1.2.2.1.1.1.1.3.2.2.1.1" xref="S2.E3.m1.2.2.1.1.1.1.3.2.2.1.1.cmml"><msub id="S2.E3.m1.2.2.1.1.1.1.3.2.2.1.1.2" xref="S2.E3.m1.2.2.1.1.1.1.3.2.2.1.1.2.cmml"><mi class="ltx_mathvariant_bold-italic" mathvariant="bold-italic" id="S2.E3.m1.2.2.1.1.1.1.3.2.2.1.1.2.2" xref="S2.E3.m1.2.2.1.1.1.1.3.2.2.1.1.2.2.cmml">ϕ</mi><mi id="S2.E3.m1.2.2.1.1.1.1.3.2.2.1.1.2.3" xref="S2.E3.m1.2.2.1.1.1.1.3.2.2.1.1.2.3.cmml">s</mi></msub><mo fence="false" id="S2.E3.m1.2.2.1.1.1.1.3.2.2.1.1.1" xref="S2.E3.m1.2.2.1.1.1.1.3.2.2.1.1.1.cmml">|</mo><mi id="S2.E3.m1.2.2.1.1.1.1.3.2.2.1.1.3" xref="S2.E3.m1.2.2.1.1.1.1.3.2.2.1.1.3.cmml">𝐰</mi></mrow><mo stretchy="false" id="S2.E3.m1.2.2.1.1.1.1.3.2.2.1.3" xref="S2.E3.m1.2.2.1.1.1.1.3.2.2.1.1.cmml">)</mo></mrow><mo lspace="0em" rspace="0em" id="S2.E3.m1.2.2.1.1.1.1.3.2.3c" xref="S2.E3.m1.2.2.1.1.1.1.3.2.3.cmml">​</mo><mrow id="S2.E3.m1.2.2.1.1.1.1.3.2.6" xref="S2.E3.m1.2.2.1.1.1.1.3.2.6.cmml"><mo rspace="0em" id="S2.E3.m1.2.2.1.1.1.1.3.2.6.1" xref="S2.E3.m1.2.2.1.1.1.1.3.2.6.1.cmml">d</mo><msub id="S2.E3.m1.2.2.1.1.1.1.3.2.6.2" xref="S2.E3.m1.2.2.1.1.1.1.3.2.6.2.cmml"><mi class="ltx_mathvariant_bold-italic" mathvariant="bold-italic" id="S2.E3.m1.2.2.1.1.1.1.3.2.6.2.2" xref="S2.E3.m1.2.2.1.1.1.1.3.2.6.2.2.cmml">ϕ</mi><mi id="S2.E3.m1.2.2.1.1.1.1.3.2.6.2.3" xref="S2.E3.m1.2.2.1.1.1.1.3.2.6.2.3.cmml">s</mi></msub></mrow></mrow></mrow></mstyle></mrow><mo rspace="1.167em" id="S2.E3.m1.2.2.1.1.2.3" xref="S2.E3.m1.2.2.1.1.3a.cmml">,</mo><mrow id="S2.E3.m1.2.2.1.1.2.2" xref="S2.E3.m1.2.2.1.1.2.2.cmml"><mrow id="S2.E3.m1.2.2.1.1.2.2.1" xref="S2.E3.m1.2.2.1.1.2.2.1.cmml"><mi id="S2.E3.m1.2.2.1.1.2.2.1.3" xref="S2.E3.m1.2.2.1.1.2.2.1.3.cmml">p</mi><mo lspace="0em" rspace="0em" id="S2.E3.m1.2.2.1.1.2.2.1.2" xref="S2.E3.m1.2.2.1.1.2.2.1.2.cmml">​</mo><mrow id="S2.E3.m1.2.2.1.1.2.2.1.1.1" xref="S2.E3.m1.2.2.1.1.2.2.1.1.1.1.cmml"><mo stretchy="false" id="S2.E3.m1.2.2.1.1.2.2.1.1.1.2" xref="S2.E3.m1.2.2.1.1.2.2.1.1.1.1.cmml">(</mo><mrow id="S2.E3.m1.2.2.1.1.2.2.1.1.1.1" xref="S2.E3.m1.2.2.1.1.2.2.1.1.1.1.cmml"><msub id="S2.E3.m1.2.2.1.1.2.2.1.1.1.1.2" xref="S2.E3.m1.2.2.1.1.2.2.1.1.1.1.2.cmml"><mi class="ltx_mathvariant_bold-italic" mathvariant="bold-italic" id="S2.E3.m1.2.2.1.1.2.2.1.1.1.1.2.2" xref="S2.E3.m1.2.2.1.1.2.2.1.1.1.1.2.2.cmml">ϕ</mi><mi id="S2.E3.m1.2.2.1.1.2.2.1.1.1.1.2.3" xref="S2.E3.m1.2.2.1.1.2.2.1.1.1.1.2.3.cmml">s</mi></msub><mo fence="false" id="S2.E3.m1.2.2.1.1.2.2.1.1.1.1.1" xref="S2.E3.m1.2.2.1.1.2.2.1.1.1.1.1.cmml">|</mo><mi id="S2.E3.m1.2.2.1.1.2.2.1.1.1.1.3" xref="S2.E3.m1.2.2.1.1.2.2.1.1.1.1.3.cmml">𝐰</mi></mrow><mo stretchy="false" id="S2.E3.m1.2.2.1.1.2.2.1.1.1.3" xref="S2.E3.m1.2.2.1.1.2.2.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S2.E3.m1.2.2.1.1.2.2.3" xref="S2.E3.m1.2.2.1.1.2.2.3.cmml">=</mo><mrow id="S2.E3.m1.2.2.1.1.2.2.2" xref="S2.E3.m1.2.2.1.1.2.2.2.cmml"><mstyle displaystyle="true" id="S2.E3.m1.2.2.1.1.2.2.2.3" xref="S2.E3.m1.2.2.1.1.2.2.2.3.cmml"><mfrac id="S2.E3.m1.2.2.1.1.2.2.2.3a" xref="S2.E3.m1.2.2.1.1.2.2.2.3.cmml"><mn id="S2.E3.m1.2.2.1.1.2.2.2.3.2" xref="S2.E3.m1.2.2.1.1.2.2.2.3.2.cmml">1</mn><mi id="S2.E3.m1.2.2.1.1.2.2.2.3.3" xref="S2.E3.m1.2.2.1.1.2.2.2.3.3.cmml">Z</mi></mfrac></mstyle><mo lspace="0.167em" rspace="0em" id="S2.E3.m1.2.2.1.1.2.2.2.2" xref="S2.E3.m1.2.2.1.1.2.2.2.2.cmml">​</mo><mrow id="S2.E3.m1.2.2.1.1.2.2.2.1.1" xref="S2.E3.m1.2.2.1.1.2.2.2.1.2.cmml"><mi id="S2.E3.m1.1.1" xref="S2.E3.m1.1.1.cmml">exp</mi><mo id="S2.E3.m1.2.2.1.1.2.2.2.1.1a" xref="S2.E3.m1.2.2.1.1.2.2.2.1.2.cmml">⁡</mo><mrow id="S2.E3.m1.2.2.1.1.2.2.2.1.1.1" xref="S2.E3.m1.2.2.1.1.2.2.2.1.2.cmml"><mo id="S2.E3.m1.2.2.1.1.2.2.2.1.1.1.2" xref="S2.E3.m1.2.2.1.1.2.2.2.1.2.cmml">(</mo><mrow id="S2.E3.m1.2.2.1.1.2.2.2.1.1.1.1" xref="S2.E3.m1.2.2.1.1.2.2.2.1.1.1.1.cmml"><mo id="S2.E3.m1.2.2.1.1.2.2.2.1.1.1.1a" xref="S2.E3.m1.2.2.1.1.2.2.2.1.1.1.1.cmml">−</mo><mrow id="S2.E3.m1.2.2.1.1.2.2.2.1.1.1.1.1" xref="S2.E3.m1.2.2.1.1.2.2.2.1.1.1.1.1.cmml"><mstyle displaystyle="true" id="S2.E3.m1.2.2.1.1.2.2.2.1.1.1.1.1.3" xref="S2.E3.m1.2.2.1.1.2.2.2.1.1.1.1.1.3.cmml"><mfrac id="S2.E3.m1.2.2.1.1.2.2.2.1.1.1.1.1.3a" xref="S2.E3.m1.2.2.1.1.2.2.2.1.1.1.1.1.3.cmml"><mi id="S2.E3.m1.2.2.1.1.2.2.2.1.1.1.1.1.3.2" xref="S2.E3.m1.2.2.1.1.2.2.2.1.1.1.1.1.3.2.cmml">λ</mi><mn id="S2.E3.m1.2.2.1.1.2.2.2.1.1.1.1.1.3.3" xref="S2.E3.m1.2.2.1.1.2.2.2.1.1.1.1.1.3.3.cmml">2</mn></mfrac></mstyle><mo lspace="0em" rspace="0em" id="S2.E3.m1.2.2.1.1.2.2.2.1.1.1.1.1.2" xref="S2.E3.m1.2.2.1.1.2.2.2.1.1.1.1.1.2.cmml">​</mo><msup id="S2.E3.m1.2.2.1.1.2.2.2.1.1.1.1.1.1" xref="S2.E3.m1.2.2.1.1.2.2.2.1.1.1.1.1.1.cmml"><mrow id="S2.E3.m1.2.2.1.1.2.2.2.1.1.1.1.1.1.1.1" xref="S2.E3.m1.2.2.1.1.2.2.2.1.1.1.1.1.1.1.2.cmml"><mo stretchy="false" id="S2.E3.m1.2.2.1.1.2.2.2.1.1.1.1.1.1.1.1.2" xref="S2.E3.m1.2.2.1.1.2.2.2.1.1.1.1.1.1.1.2.1.cmml">‖</mo><mrow id="S2.E3.m1.2.2.1.1.2.2.2.1.1.1.1.1.1.1.1.1" xref="S2.E3.m1.2.2.1.1.2.2.2.1.1.1.1.1.1.1.1.1.cmml"><msub id="S2.E3.m1.2.2.1.1.2.2.2.1.1.1.1.1.1.1.1.1.2" xref="S2.E3.m1.2.2.1.1.2.2.2.1.1.1.1.1.1.1.1.1.2.cmml"><mi class="ltx_mathvariant_bold-italic" mathvariant="bold-italic" id="S2.E3.m1.2.2.1.1.2.2.2.1.1.1.1.1.1.1.1.1.2.2" xref="S2.E3.m1.2.2.1.1.2.2.2.1.1.1.1.1.1.1.1.1.2.2.cmml">ϕ</mi><mi id="S2.E3.m1.2.2.1.1.2.2.2.1.1.1.1.1.1.1.1.1.2.3" xref="S2.E3.m1.2.2.1.1.2.2.2.1.1.1.1.1.1.1.1.1.2.3.cmml">s</mi></msub><mo id="S2.E3.m1.2.2.1.1.2.2.2.1.1.1.1.1.1.1.1.1.1" xref="S2.E3.m1.2.2.1.1.2.2.2.1.1.1.1.1.1.1.1.1.1.cmml">−</mo><mi id="S2.E3.m1.2.2.1.1.2.2.2.1.1.1.1.1.1.1.1.1.3" xref="S2.E3.m1.2.2.1.1.2.2.2.1.1.1.1.1.1.1.1.1.3.cmml">𝐰</mi></mrow><mo stretchy="false" id="S2.E3.m1.2.2.1.1.2.2.2.1.1.1.1.1.1.1.1.3" xref="S2.E3.m1.2.2.1.1.2.2.2.1.1.1.1.1.1.1.2.1.cmml">‖</mo></mrow><mn id="S2.E3.m1.2.2.1.1.2.2.2.1.1.1.1.1.1.3" xref="S2.E3.m1.2.2.1.1.2.2.2.1.1.1.1.1.1.3.cmml">2</mn></msup></mrow></mrow><mo id="S2.E3.m1.2.2.1.1.2.2.2.1.1.1.3" xref="S2.E3.m1.2.2.1.1.2.2.2.1.2.cmml">)</mo></mrow></mrow></mrow></mrow></mrow><mo id="S2.E3.m1.2.2.1.2">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S2.E3.m1.2b"><apply id="S2.E3.m1.2.2.1.1.3.cmml" xref="S2.E3.m1.2.2.1.1.2"><csymbol cd="ambiguous" id="S2.E3.m1.2.2.1.1.3a.cmml" xref="S2.E3.m1.2.2.1.1.2.3">formulae-sequence</csymbol><apply id="S2.E3.m1.2.2.1.1.1.1.cmml" xref="S2.E3.m1.2.2.1.1.1.1"><eq id="S2.E3.m1.2.2.1.1.1.1.4.cmml" xref="S2.E3.m1.2.2.1.1.1.1.4"></eq><apply id="S2.E3.m1.2.2.1.1.1.1.1.cmml" xref="S2.E3.m1.2.2.1.1.1.1.1"><times id="S2.E3.m1.2.2.1.1.1.1.1.2.cmml" xref="S2.E3.m1.2.2.1.1.1.1.1.2"></times><ci id="S2.E3.m1.2.2.1.1.1.1.1.3.cmml" xref="S2.E3.m1.2.2.1.1.1.1.1.3">𝑝</ci><apply id="S2.E3.m1.2.2.1.1.1.1.1.1.1.1.cmml" xref="S2.E3.m1.2.2.1.1.1.1.1.1.1"><csymbol cd="latexml" id="S2.E3.m1.2.2.1.1.1.1.1.1.1.1.1.cmml" xref="S2.E3.m1.2.2.1.1.1.1.1.1.1.1.1">conditional</csymbol><apply id="S2.E3.m1.2.2.1.1.1.1.1.1.1.1.2.cmml" xref="S2.E3.m1.2.2.1.1.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S2.E3.m1.2.2.1.1.1.1.1.1.1.1.2.1.cmml" xref="S2.E3.m1.2.2.1.1.1.1.1.1.1.1.2">subscript</csymbol><ci id="S2.E3.m1.2.2.1.1.1.1.1.1.1.1.2.2.cmml" xref="S2.E3.m1.2.2.1.1.1.1.1.1.1.1.2.2">𝒟</ci><ci id="S2.E3.m1.2.2.1.1.1.1.1.1.1.1.2.3.cmml" xref="S2.E3.m1.2.2.1.1.1.1.1.1.1.1.2.3">𝑠</ci></apply><ci id="S2.E3.m1.2.2.1.1.1.1.1.1.1.1.3.cmml" xref="S2.E3.m1.2.2.1.1.1.1.1.1.1.1.3">𝐰</ci></apply></apply><apply id="S2.E3.m1.2.2.1.1.1.1.3.cmml" xref="S2.E3.m1.2.2.1.1.1.1.3"><int id="S2.E3.m1.2.2.1.1.1.1.3.3.cmml" xref="S2.E3.m1.2.2.1.1.1.1.3.3"></int><apply id="S2.E3.m1.2.2.1.1.1.1.3.2.cmml" xref="S2.E3.m1.2.2.1.1.1.1.3.2"><times id="S2.E3.m1.2.2.1.1.1.1.3.2.3.cmml" xref="S2.E3.m1.2.2.1.1.1.1.3.2.3"></times><ci id="S2.E3.m1.2.2.1.1.1.1.3.2.4.cmml" xref="S2.E3.m1.2.2.1.1.1.1.3.2.4">𝑝</ci><apply id="S2.E3.m1.2.2.1.1.1.1.2.1.1.1.1.cmml" xref="S2.E3.m1.2.2.1.1.1.1.2.1.1.1"><csymbol cd="latexml" id="S2.E3.m1.2.2.1.1.1.1.2.1.1.1.1.1.cmml" xref="S2.E3.m1.2.2.1.1.1.1.2.1.1.1.1.1">conditional</csymbol><apply id="S2.E3.m1.2.2.1.1.1.1.2.1.1.1.1.2.cmml" xref="S2.E3.m1.2.2.1.1.1.1.2.1.1.1.1.2"><csymbol cd="ambiguous" id="S2.E3.m1.2.2.1.1.1.1.2.1.1.1.1.2.1.cmml" xref="S2.E3.m1.2.2.1.1.1.1.2.1.1.1.1.2">subscript</csymbol><ci id="S2.E3.m1.2.2.1.1.1.1.2.1.1.1.1.2.2.cmml" xref="S2.E3.m1.2.2.1.1.1.1.2.1.1.1.1.2.2">𝒟</ci><ci id="S2.E3.m1.2.2.1.1.1.1.2.1.1.1.1.2.3.cmml" xref="S2.E3.m1.2.2.1.1.1.1.2.1.1.1.1.2.3">𝑠</ci></apply><apply id="S2.E3.m1.2.2.1.1.1.1.2.1.1.1.1.3.cmml" xref="S2.E3.m1.2.2.1.1.1.1.2.1.1.1.1.3"><csymbol cd="ambiguous" id="S2.E3.m1.2.2.1.1.1.1.2.1.1.1.1.3.1.cmml" xref="S2.E3.m1.2.2.1.1.1.1.2.1.1.1.1.3">subscript</csymbol><ci id="S2.E3.m1.2.2.1.1.1.1.2.1.1.1.1.3.2.cmml" xref="S2.E3.m1.2.2.1.1.1.1.2.1.1.1.1.3.2">bold-italic-ϕ</ci><ci id="S2.E3.m1.2.2.1.1.1.1.2.1.1.1.1.3.3.cmml" xref="S2.E3.m1.2.2.1.1.1.1.2.1.1.1.1.3.3">𝑠</ci></apply></apply><ci id="S2.E3.m1.2.2.1.1.1.1.3.2.5.cmml" xref="S2.E3.m1.2.2.1.1.1.1.3.2.5">𝑝</ci><apply id="S2.E3.m1.2.2.1.1.1.1.3.2.2.1.1.cmml" xref="S2.E3.m1.2.2.1.1.1.1.3.2.2.1"><csymbol cd="latexml" id="S2.E3.m1.2.2.1.1.1.1.3.2.2.1.1.1.cmml" xref="S2.E3.m1.2.2.1.1.1.1.3.2.2.1.1.1">conditional</csymbol><apply id="S2.E3.m1.2.2.1.1.1.1.3.2.2.1.1.2.cmml" xref="S2.E3.m1.2.2.1.1.1.1.3.2.2.1.1.2"><csymbol cd="ambiguous" id="S2.E3.m1.2.2.1.1.1.1.3.2.2.1.1.2.1.cmml" xref="S2.E3.m1.2.2.1.1.1.1.3.2.2.1.1.2">subscript</csymbol><ci id="S2.E3.m1.2.2.1.1.1.1.3.2.2.1.1.2.2.cmml" xref="S2.E3.m1.2.2.1.1.1.1.3.2.2.1.1.2.2">bold-italic-ϕ</ci><ci id="S2.E3.m1.2.2.1.1.1.1.3.2.2.1.1.2.3.cmml" xref="S2.E3.m1.2.2.1.1.1.1.3.2.2.1.1.2.3">𝑠</ci></apply><ci id="S2.E3.m1.2.2.1.1.1.1.3.2.2.1.1.3.cmml" xref="S2.E3.m1.2.2.1.1.1.1.3.2.2.1.1.3">𝐰</ci></apply><apply id="S2.E3.m1.2.2.1.1.1.1.3.2.6.cmml" xref="S2.E3.m1.2.2.1.1.1.1.3.2.6"><csymbol cd="latexml" id="S2.E3.m1.2.2.1.1.1.1.3.2.6.1.cmml" xref="S2.E3.m1.2.2.1.1.1.1.3.2.6.1">differential-d</csymbol><apply id="S2.E3.m1.2.2.1.1.1.1.3.2.6.2.cmml" xref="S2.E3.m1.2.2.1.1.1.1.3.2.6.2"><csymbol cd="ambiguous" id="S2.E3.m1.2.2.1.1.1.1.3.2.6.2.1.cmml" xref="S2.E3.m1.2.2.1.1.1.1.3.2.6.2">subscript</csymbol><ci id="S2.E3.m1.2.2.1.1.1.1.3.2.6.2.2.cmml" xref="S2.E3.m1.2.2.1.1.1.1.3.2.6.2.2">bold-italic-ϕ</ci><ci id="S2.E3.m1.2.2.1.1.1.1.3.2.6.2.3.cmml" xref="S2.E3.m1.2.2.1.1.1.1.3.2.6.2.3">𝑠</ci></apply></apply></apply></apply></apply><apply id="S2.E3.m1.2.2.1.1.2.2.cmml" xref="S2.E3.m1.2.2.1.1.2.2"><eq id="S2.E3.m1.2.2.1.1.2.2.3.cmml" xref="S2.E3.m1.2.2.1.1.2.2.3"></eq><apply id="S2.E3.m1.2.2.1.1.2.2.1.cmml" xref="S2.E3.m1.2.2.1.1.2.2.1"><times id="S2.E3.m1.2.2.1.1.2.2.1.2.cmml" xref="S2.E3.m1.2.2.1.1.2.2.1.2"></times><ci id="S2.E3.m1.2.2.1.1.2.2.1.3.cmml" xref="S2.E3.m1.2.2.1.1.2.2.1.3">𝑝</ci><apply id="S2.E3.m1.2.2.1.1.2.2.1.1.1.1.cmml" xref="S2.E3.m1.2.2.1.1.2.2.1.1.1"><csymbol cd="latexml" id="S2.E3.m1.2.2.1.1.2.2.1.1.1.1.1.cmml" xref="S2.E3.m1.2.2.1.1.2.2.1.1.1.1.1">conditional</csymbol><apply id="S2.E3.m1.2.2.1.1.2.2.1.1.1.1.2.cmml" xref="S2.E3.m1.2.2.1.1.2.2.1.1.1.1.2"><csymbol cd="ambiguous" id="S2.E3.m1.2.2.1.1.2.2.1.1.1.1.2.1.cmml" xref="S2.E3.m1.2.2.1.1.2.2.1.1.1.1.2">subscript</csymbol><ci id="S2.E3.m1.2.2.1.1.2.2.1.1.1.1.2.2.cmml" xref="S2.E3.m1.2.2.1.1.2.2.1.1.1.1.2.2">bold-italic-ϕ</ci><ci id="S2.E3.m1.2.2.1.1.2.2.1.1.1.1.2.3.cmml" xref="S2.E3.m1.2.2.1.1.2.2.1.1.1.1.2.3">𝑠</ci></apply><ci id="S2.E3.m1.2.2.1.1.2.2.1.1.1.1.3.cmml" xref="S2.E3.m1.2.2.1.1.2.2.1.1.1.1.3">𝐰</ci></apply></apply><apply id="S2.E3.m1.2.2.1.1.2.2.2.cmml" xref="S2.E3.m1.2.2.1.1.2.2.2"><times id="S2.E3.m1.2.2.1.1.2.2.2.2.cmml" xref="S2.E3.m1.2.2.1.1.2.2.2.2"></times><apply id="S2.E3.m1.2.2.1.1.2.2.2.3.cmml" xref="S2.E3.m1.2.2.1.1.2.2.2.3"><divide id="S2.E3.m1.2.2.1.1.2.2.2.3.1.cmml" xref="S2.E3.m1.2.2.1.1.2.2.2.3"></divide><cn type="integer" id="S2.E3.m1.2.2.1.1.2.2.2.3.2.cmml" xref="S2.E3.m1.2.2.1.1.2.2.2.3.2">1</cn><ci id="S2.E3.m1.2.2.1.1.2.2.2.3.3.cmml" xref="S2.E3.m1.2.2.1.1.2.2.2.3.3">𝑍</ci></apply><apply id="S2.E3.m1.2.2.1.1.2.2.2.1.2.cmml" xref="S2.E3.m1.2.2.1.1.2.2.2.1.1"><exp id="S2.E3.m1.1.1.cmml" xref="S2.E3.m1.1.1"></exp><apply id="S2.E3.m1.2.2.1.1.2.2.2.1.1.1.1.cmml" xref="S2.E3.m1.2.2.1.1.2.2.2.1.1.1.1"><minus id="S2.E3.m1.2.2.1.1.2.2.2.1.1.1.1.2.cmml" xref="S2.E3.m1.2.2.1.1.2.2.2.1.1.1.1"></minus><apply id="S2.E3.m1.2.2.1.1.2.2.2.1.1.1.1.1.cmml" xref="S2.E3.m1.2.2.1.1.2.2.2.1.1.1.1.1"><times id="S2.E3.m1.2.2.1.1.2.2.2.1.1.1.1.1.2.cmml" xref="S2.E3.m1.2.2.1.1.2.2.2.1.1.1.1.1.2"></times><apply id="S2.E3.m1.2.2.1.1.2.2.2.1.1.1.1.1.3.cmml" xref="S2.E3.m1.2.2.1.1.2.2.2.1.1.1.1.1.3"><divide id="S2.E3.m1.2.2.1.1.2.2.2.1.1.1.1.1.3.1.cmml" xref="S2.E3.m1.2.2.1.1.2.2.2.1.1.1.1.1.3"></divide><ci id="S2.E3.m1.2.2.1.1.2.2.2.1.1.1.1.1.3.2.cmml" xref="S2.E3.m1.2.2.1.1.2.2.2.1.1.1.1.1.3.2">𝜆</ci><cn type="integer" id="S2.E3.m1.2.2.1.1.2.2.2.1.1.1.1.1.3.3.cmml" xref="S2.E3.m1.2.2.1.1.2.2.2.1.1.1.1.1.3.3">2</cn></apply><apply id="S2.E3.m1.2.2.1.1.2.2.2.1.1.1.1.1.1.cmml" xref="S2.E3.m1.2.2.1.1.2.2.2.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S2.E3.m1.2.2.1.1.2.2.2.1.1.1.1.1.1.2.cmml" xref="S2.E3.m1.2.2.1.1.2.2.2.1.1.1.1.1.1">superscript</csymbol><apply id="S2.E3.m1.2.2.1.1.2.2.2.1.1.1.1.1.1.1.2.cmml" xref="S2.E3.m1.2.2.1.1.2.2.2.1.1.1.1.1.1.1.1"><csymbol cd="latexml" id="S2.E3.m1.2.2.1.1.2.2.2.1.1.1.1.1.1.1.2.1.cmml" xref="S2.E3.m1.2.2.1.1.2.2.2.1.1.1.1.1.1.1.1.2">norm</csymbol><apply id="S2.E3.m1.2.2.1.1.2.2.2.1.1.1.1.1.1.1.1.1.cmml" xref="S2.E3.m1.2.2.1.1.2.2.2.1.1.1.1.1.1.1.1.1"><minus id="S2.E3.m1.2.2.1.1.2.2.2.1.1.1.1.1.1.1.1.1.1.cmml" xref="S2.E3.m1.2.2.1.1.2.2.2.1.1.1.1.1.1.1.1.1.1"></minus><apply id="S2.E3.m1.2.2.1.1.2.2.2.1.1.1.1.1.1.1.1.1.2.cmml" xref="S2.E3.m1.2.2.1.1.2.2.2.1.1.1.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S2.E3.m1.2.2.1.1.2.2.2.1.1.1.1.1.1.1.1.1.2.1.cmml" xref="S2.E3.m1.2.2.1.1.2.2.2.1.1.1.1.1.1.1.1.1.2">subscript</csymbol><ci id="S2.E3.m1.2.2.1.1.2.2.2.1.1.1.1.1.1.1.1.1.2.2.cmml" xref="S2.E3.m1.2.2.1.1.2.2.2.1.1.1.1.1.1.1.1.1.2.2">bold-italic-ϕ</ci><ci id="S2.E3.m1.2.2.1.1.2.2.2.1.1.1.1.1.1.1.1.1.2.3.cmml" xref="S2.E3.m1.2.2.1.1.2.2.2.1.1.1.1.1.1.1.1.1.2.3">𝑠</ci></apply><ci id="S2.E3.m1.2.2.1.1.2.2.2.1.1.1.1.1.1.1.1.1.3.cmml" xref="S2.E3.m1.2.2.1.1.2.2.2.1.1.1.1.1.1.1.1.1.3">𝐰</ci></apply></apply><cn type="integer" id="S2.E3.m1.2.2.1.1.2.2.2.1.1.1.1.1.1.3.cmml" xref="S2.E3.m1.2.2.1.1.2.2.2.1.1.1.1.1.1.3">2</cn></apply></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.E3.m1.2c">\displaystyle p(\mathcal{D}_{s}|\mathbf{w})=\int p(\mathcal{D}_{s}|\bm{\phi}_{s})p(\bm{\phi}_{s}|\mathbf{w})\mathrm{d}\bm{\phi}_{s},\quad p(\bm{\phi}_{s}|\mathbf{w})=\frac{1}{Z}\exp\left(-\frac{\lambda}{2}\|\bm{\phi}_{s}-\mathbf{w}\|^{2}\right),</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(3)</span></td>
</tr></tbody>
</table>
<p id="S2.SS1.p1.11" class="ltx_p">where we introduced the auxiliary latent variables <math id="S2.SS1.p1.6.m1.1" class="ltx_Math" alttext="\bm{\phi}_{s}" display="inline"><semantics id="S2.SS1.p1.6.m1.1a"><msub id="S2.SS1.p1.6.m1.1.1" xref="S2.SS1.p1.6.m1.1.1.cmml"><mi class="ltx_mathvariant_bold-italic" mathvariant="bold-italic" id="S2.SS1.p1.6.m1.1.1.2" xref="S2.SS1.p1.6.m1.1.1.2.cmml">ϕ</mi><mi id="S2.SS1.p1.6.m1.1.1.3" xref="S2.SS1.p1.6.m1.1.1.3.cmml">s</mi></msub><annotation-xml encoding="MathML-Content" id="S2.SS1.p1.6.m1.1b"><apply id="S2.SS1.p1.6.m1.1.1.cmml" xref="S2.SS1.p1.6.m1.1.1"><csymbol cd="ambiguous" id="S2.SS1.p1.6.m1.1.1.1.cmml" xref="S2.SS1.p1.6.m1.1.1">subscript</csymbol><ci id="S2.SS1.p1.6.m1.1.1.2.cmml" xref="S2.SS1.p1.6.m1.1.1.2">bold-italic-ϕ</ci><ci id="S2.SS1.p1.6.m1.1.1.3.cmml" xref="S2.SS1.p1.6.m1.1.1.3">𝑠</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p1.6.m1.1c">\bm{\phi}_{s}</annotation></semantics></math>, which are the parameters of the local model at shard <math id="S2.SS1.p1.7.m2.1" class="ltx_Math" alttext="s" display="inline"><semantics id="S2.SS1.p1.7.m2.1a"><mi id="S2.SS1.p1.7.m2.1.1" xref="S2.SS1.p1.7.m2.1.1.cmml">s</mi><annotation-xml encoding="MathML-Content" id="S2.SS1.p1.7.m2.1b"><ci id="S2.SS1.p1.7.m2.1.1.cmml" xref="S2.SS1.p1.7.m2.1.1">𝑠</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p1.7.m2.1c">s</annotation></semantics></math>. The server parameters <math id="S2.SS1.p1.8.m3.1" class="ltx_Math" alttext="\mathbf{w}" display="inline"><semantics id="S2.SS1.p1.8.m3.1a"><mi id="S2.SS1.p1.8.m3.1.1" xref="S2.SS1.p1.8.m3.1.1.cmml">𝐰</mi><annotation-xml encoding="MathML-Content" id="S2.SS1.p1.8.m3.1b"><ci id="S2.SS1.p1.8.m3.1.1.cmml" xref="S2.SS1.p1.8.m3.1.1">𝐰</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p1.8.m3.1c">\mathbf{w}</annotation></semantics></math> act as the center for the Gaussian prior at Eq. <a href="#S2.E3" title="In 2.1 FedAvg as learning in a hierarchical model ‣ 2 A hierarchical model interpretation of federated learning ‣ An Expectation-Maximization Perspective on Federated Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">3</span></a> over the shard specific parameters with the precision <math id="S2.SS1.p1.9.m4.1" class="ltx_Math" alttext="\lambda" display="inline"><semantics id="S2.SS1.p1.9.m4.1a"><mi id="S2.SS1.p1.9.m4.1.1" xref="S2.SS1.p1.9.m4.1.1.cmml">λ</mi><annotation-xml encoding="MathML-Content" id="S2.SS1.p1.9.m4.1b"><ci id="S2.SS1.p1.9.m4.1.1.cmml" xref="S2.SS1.p1.9.m4.1.1">𝜆</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p1.9.m4.1c">\lambda</annotation></semantics></math> acting as a regularization strength that prevents <math id="S2.SS1.p1.10.m5.1" class="ltx_Math" alttext="\bm{\phi}_{s}" display="inline"><semantics id="S2.SS1.p1.10.m5.1a"><msub id="S2.SS1.p1.10.m5.1.1" xref="S2.SS1.p1.10.m5.1.1.cmml"><mi class="ltx_mathvariant_bold-italic" mathvariant="bold-italic" id="S2.SS1.p1.10.m5.1.1.2" xref="S2.SS1.p1.10.m5.1.1.2.cmml">ϕ</mi><mi id="S2.SS1.p1.10.m5.1.1.3" xref="S2.SS1.p1.10.m5.1.1.3.cmml">s</mi></msub><annotation-xml encoding="MathML-Content" id="S2.SS1.p1.10.m5.1b"><apply id="S2.SS1.p1.10.m5.1.1.cmml" xref="S2.SS1.p1.10.m5.1.1"><csymbol cd="ambiguous" id="S2.SS1.p1.10.m5.1.1.1.cmml" xref="S2.SS1.p1.10.m5.1.1">subscript</csymbol><ci id="S2.SS1.p1.10.m5.1.1.2.cmml" xref="S2.SS1.p1.10.m5.1.1.2">bold-italic-ϕ</ci><ci id="S2.SS1.p1.10.m5.1.1.3.cmml" xref="S2.SS1.p1.10.m5.1.1.3">𝑠</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p1.10.m5.1c">\bm{\phi}_{s}</annotation></semantics></math> from moving too far from <math id="S2.SS1.p1.11.m6.1" class="ltx_Math" alttext="\mathbf{w}" display="inline"><semantics id="S2.SS1.p1.11.m6.1a"><mi id="S2.SS1.p1.11.m6.1.1" xref="S2.SS1.p1.11.m6.1.1.cmml">𝐰</mi><annotation-xml encoding="MathML-Content" id="S2.SS1.p1.11.m6.1b"><ci id="S2.SS1.p1.11.m6.1.1.cmml" xref="S2.SS1.p1.11.m6.1.1">𝐰</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p1.11.m6.1c">\mathbf{w}</annotation></semantics></math>. By putting everything together, the total objective will be</p>
<table id="A10.EGx4" class="ltx_equationgroup ltx_eqn_align ltx_eqn_table">

<tbody id="S2.E4"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math id="S2.E4.m1.4" class="ltx_Math" alttext="\displaystyle\mathcal{F}(\mathbf{w}):=\sum_{s}\log\int p(\mathcal{D}_{s}|\bm{\phi}_{s})\frac{\exp\left(-\frac{\lambda}{2}\|\bm{\phi}_{s}-\mathbf{w}\|^{2}\right)}{Z}\mathrm{d}\bm{\phi}_{s}," display="inline"><semantics id="S2.E4.m1.4a"><mrow id="S2.E4.m1.4.4.1" xref="S2.E4.m1.4.4.1.1.cmml"><mrow id="S2.E4.m1.4.4.1.1" xref="S2.E4.m1.4.4.1.1.cmml"><mrow id="S2.E4.m1.4.4.1.1.3" xref="S2.E4.m1.4.4.1.1.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S2.E4.m1.4.4.1.1.3.2" xref="S2.E4.m1.4.4.1.1.3.2.cmml">ℱ</mi><mo lspace="0em" rspace="0em" id="S2.E4.m1.4.4.1.1.3.1" xref="S2.E4.m1.4.4.1.1.3.1.cmml">​</mo><mrow id="S2.E4.m1.4.4.1.1.3.3.2" xref="S2.E4.m1.4.4.1.1.3.cmml"><mo stretchy="false" id="S2.E4.m1.4.4.1.1.3.3.2.1" xref="S2.E4.m1.4.4.1.1.3.cmml">(</mo><mi id="S2.E4.m1.3.3" xref="S2.E4.m1.3.3.cmml">𝐰</mi><mo rspace="0.278em" stretchy="false" id="S2.E4.m1.4.4.1.1.3.3.2.2" xref="S2.E4.m1.4.4.1.1.3.cmml">)</mo></mrow></mrow><mo rspace="0.278em" id="S2.E4.m1.4.4.1.1.2" xref="S2.E4.m1.4.4.1.1.2.cmml">:=</mo><mrow id="S2.E4.m1.4.4.1.1.1" xref="S2.E4.m1.4.4.1.1.1.cmml"><mstyle displaystyle="true" id="S2.E4.m1.4.4.1.1.1.2" xref="S2.E4.m1.4.4.1.1.1.2.cmml"><munder id="S2.E4.m1.4.4.1.1.1.2a" xref="S2.E4.m1.4.4.1.1.1.2.cmml"><mo movablelimits="false" id="S2.E4.m1.4.4.1.1.1.2.2" xref="S2.E4.m1.4.4.1.1.1.2.2.cmml">∑</mo><mi id="S2.E4.m1.4.4.1.1.1.2.3" xref="S2.E4.m1.4.4.1.1.1.2.3.cmml">s</mi></munder></mstyle><mrow id="S2.E4.m1.4.4.1.1.1.1" xref="S2.E4.m1.4.4.1.1.1.1.cmml"><mi id="S2.E4.m1.4.4.1.1.1.1.3" xref="S2.E4.m1.4.4.1.1.1.1.3.cmml">log</mi><mo lspace="0.167em" rspace="0em" id="S2.E4.m1.4.4.1.1.1.1.2" xref="S2.E4.m1.4.4.1.1.1.1.2.cmml">​</mo><mstyle displaystyle="true" id="S2.E4.m1.4.4.1.1.1.1.1" xref="S2.E4.m1.4.4.1.1.1.1.1.cmml"><mrow id="S2.E4.m1.4.4.1.1.1.1.1a" xref="S2.E4.m1.4.4.1.1.1.1.1.cmml"><mo id="S2.E4.m1.4.4.1.1.1.1.1.2" xref="S2.E4.m1.4.4.1.1.1.1.1.2.cmml">∫</mo><mrow id="S2.E4.m1.4.4.1.1.1.1.1.1" xref="S2.E4.m1.4.4.1.1.1.1.1.1.cmml"><mi id="S2.E4.m1.4.4.1.1.1.1.1.1.3" xref="S2.E4.m1.4.4.1.1.1.1.1.1.3.cmml">p</mi><mo lspace="0em" rspace="0em" id="S2.E4.m1.4.4.1.1.1.1.1.1.2" xref="S2.E4.m1.4.4.1.1.1.1.1.1.2.cmml">​</mo><mrow id="S2.E4.m1.4.4.1.1.1.1.1.1.1.1" xref="S2.E4.m1.4.4.1.1.1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S2.E4.m1.4.4.1.1.1.1.1.1.1.1.2" xref="S2.E4.m1.4.4.1.1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="S2.E4.m1.4.4.1.1.1.1.1.1.1.1.1" xref="S2.E4.m1.4.4.1.1.1.1.1.1.1.1.1.cmml"><msub id="S2.E4.m1.4.4.1.1.1.1.1.1.1.1.1.2" xref="S2.E4.m1.4.4.1.1.1.1.1.1.1.1.1.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S2.E4.m1.4.4.1.1.1.1.1.1.1.1.1.2.2" xref="S2.E4.m1.4.4.1.1.1.1.1.1.1.1.1.2.2.cmml">𝒟</mi><mi id="S2.E4.m1.4.4.1.1.1.1.1.1.1.1.1.2.3" xref="S2.E4.m1.4.4.1.1.1.1.1.1.1.1.1.2.3.cmml">s</mi></msub><mo fence="false" id="S2.E4.m1.4.4.1.1.1.1.1.1.1.1.1.1" xref="S2.E4.m1.4.4.1.1.1.1.1.1.1.1.1.1.cmml">|</mo><msub id="S2.E4.m1.4.4.1.1.1.1.1.1.1.1.1.3" xref="S2.E4.m1.4.4.1.1.1.1.1.1.1.1.1.3.cmml"><mi class="ltx_mathvariant_bold-italic" mathvariant="bold-italic" id="S2.E4.m1.4.4.1.1.1.1.1.1.1.1.1.3.2" xref="S2.E4.m1.4.4.1.1.1.1.1.1.1.1.1.3.2.cmml">ϕ</mi><mi id="S2.E4.m1.4.4.1.1.1.1.1.1.1.1.1.3.3" xref="S2.E4.m1.4.4.1.1.1.1.1.1.1.1.1.3.3.cmml">s</mi></msub></mrow><mo stretchy="false" id="S2.E4.m1.4.4.1.1.1.1.1.1.1.1.3" xref="S2.E4.m1.4.4.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow><mo lspace="0em" rspace="0em" id="S2.E4.m1.4.4.1.1.1.1.1.1.2a" xref="S2.E4.m1.4.4.1.1.1.1.1.1.2.cmml">​</mo><mfrac id="S2.E4.m1.2.2" xref="S2.E4.m1.2.2.cmml"><mrow id="S2.E4.m1.2.2.2.2" xref="S2.E4.m1.2.2.2.3.cmml"><mi id="S2.E4.m1.1.1.1.1" xref="S2.E4.m1.1.1.1.1.cmml">exp</mi><mo id="S2.E4.m1.2.2.2.2a" xref="S2.E4.m1.2.2.2.3.cmml">⁡</mo><mrow id="S2.E4.m1.2.2.2.2.1" xref="S2.E4.m1.2.2.2.3.cmml"><mo id="S2.E4.m1.2.2.2.2.1.2" xref="S2.E4.m1.2.2.2.3.cmml">(</mo><mrow id="S2.E4.m1.2.2.2.2.1.1" xref="S2.E4.m1.2.2.2.2.1.1.cmml"><mo id="S2.E4.m1.2.2.2.2.1.1a" xref="S2.E4.m1.2.2.2.2.1.1.cmml">−</mo><mrow id="S2.E4.m1.2.2.2.2.1.1.1" xref="S2.E4.m1.2.2.2.2.1.1.1.cmml"><mfrac id="S2.E4.m1.2.2.2.2.1.1.1.3" xref="S2.E4.m1.2.2.2.2.1.1.1.3.cmml"><mi id="S2.E4.m1.2.2.2.2.1.1.1.3.2" xref="S2.E4.m1.2.2.2.2.1.1.1.3.2.cmml">λ</mi><mn id="S2.E4.m1.2.2.2.2.1.1.1.3.3" xref="S2.E4.m1.2.2.2.2.1.1.1.3.3.cmml">2</mn></mfrac><mo lspace="0em" rspace="0em" id="S2.E4.m1.2.2.2.2.1.1.1.2" xref="S2.E4.m1.2.2.2.2.1.1.1.2.cmml">​</mo><msup id="S2.E4.m1.2.2.2.2.1.1.1.1" xref="S2.E4.m1.2.2.2.2.1.1.1.1.cmml"><mrow id="S2.E4.m1.2.2.2.2.1.1.1.1.1.1" xref="S2.E4.m1.2.2.2.2.1.1.1.1.1.2.cmml"><mo stretchy="false" id="S2.E4.m1.2.2.2.2.1.1.1.1.1.1.2" xref="S2.E4.m1.2.2.2.2.1.1.1.1.1.2.1.cmml">‖</mo><mrow id="S2.E4.m1.2.2.2.2.1.1.1.1.1.1.1" xref="S2.E4.m1.2.2.2.2.1.1.1.1.1.1.1.cmml"><msub id="S2.E4.m1.2.2.2.2.1.1.1.1.1.1.1.2" xref="S2.E4.m1.2.2.2.2.1.1.1.1.1.1.1.2.cmml"><mi class="ltx_mathvariant_bold-italic" mathvariant="bold-italic" id="S2.E4.m1.2.2.2.2.1.1.1.1.1.1.1.2.2" xref="S2.E4.m1.2.2.2.2.1.1.1.1.1.1.1.2.2.cmml">ϕ</mi><mi id="S2.E4.m1.2.2.2.2.1.1.1.1.1.1.1.2.3" xref="S2.E4.m1.2.2.2.2.1.1.1.1.1.1.1.2.3.cmml">s</mi></msub><mo id="S2.E4.m1.2.2.2.2.1.1.1.1.1.1.1.1" xref="S2.E4.m1.2.2.2.2.1.1.1.1.1.1.1.1.cmml">−</mo><mi id="S2.E4.m1.2.2.2.2.1.1.1.1.1.1.1.3" xref="S2.E4.m1.2.2.2.2.1.1.1.1.1.1.1.3.cmml">𝐰</mi></mrow><mo stretchy="false" id="S2.E4.m1.2.2.2.2.1.1.1.1.1.1.3" xref="S2.E4.m1.2.2.2.2.1.1.1.1.1.2.1.cmml">‖</mo></mrow><mn id="S2.E4.m1.2.2.2.2.1.1.1.1.3" xref="S2.E4.m1.2.2.2.2.1.1.1.1.3.cmml">2</mn></msup></mrow></mrow><mo id="S2.E4.m1.2.2.2.2.1.3" xref="S2.E4.m1.2.2.2.3.cmml">)</mo></mrow></mrow><mi id="S2.E4.m1.2.2.4" xref="S2.E4.m1.2.2.4.cmml">Z</mi></mfrac><mo lspace="0em" rspace="0em" id="S2.E4.m1.4.4.1.1.1.1.1.1.2b" xref="S2.E4.m1.4.4.1.1.1.1.1.1.2.cmml">​</mo><mrow id="S2.E4.m1.4.4.1.1.1.1.1.1.4" xref="S2.E4.m1.4.4.1.1.1.1.1.1.4.cmml"><mo rspace="0em" id="S2.E4.m1.4.4.1.1.1.1.1.1.4.1" xref="S2.E4.m1.4.4.1.1.1.1.1.1.4.1.cmml">d</mo><msub id="S2.E4.m1.4.4.1.1.1.1.1.1.4.2" xref="S2.E4.m1.4.4.1.1.1.1.1.1.4.2.cmml"><mi class="ltx_mathvariant_bold-italic" mathvariant="bold-italic" id="S2.E4.m1.4.4.1.1.1.1.1.1.4.2.2" xref="S2.E4.m1.4.4.1.1.1.1.1.1.4.2.2.cmml">ϕ</mi><mi id="S2.E4.m1.4.4.1.1.1.1.1.1.4.2.3" xref="S2.E4.m1.4.4.1.1.1.1.1.1.4.2.3.cmml">s</mi></msub></mrow></mrow></mrow></mstyle></mrow></mrow></mrow><mo id="S2.E4.m1.4.4.1.2" xref="S2.E4.m1.4.4.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S2.E4.m1.4b"><apply id="S2.E4.m1.4.4.1.1.cmml" xref="S2.E4.m1.4.4.1"><csymbol cd="latexml" id="S2.E4.m1.4.4.1.1.2.cmml" xref="S2.E4.m1.4.4.1.1.2">assign</csymbol><apply id="S2.E4.m1.4.4.1.1.3.cmml" xref="S2.E4.m1.4.4.1.1.3"><times id="S2.E4.m1.4.4.1.1.3.1.cmml" xref="S2.E4.m1.4.4.1.1.3.1"></times><ci id="S2.E4.m1.4.4.1.1.3.2.cmml" xref="S2.E4.m1.4.4.1.1.3.2">ℱ</ci><ci id="S2.E4.m1.3.3.cmml" xref="S2.E4.m1.3.3">𝐰</ci></apply><apply id="S2.E4.m1.4.4.1.1.1.cmml" xref="S2.E4.m1.4.4.1.1.1"><apply id="S2.E4.m1.4.4.1.1.1.2.cmml" xref="S2.E4.m1.4.4.1.1.1.2"><csymbol cd="ambiguous" id="S2.E4.m1.4.4.1.1.1.2.1.cmml" xref="S2.E4.m1.4.4.1.1.1.2">subscript</csymbol><sum id="S2.E4.m1.4.4.1.1.1.2.2.cmml" xref="S2.E4.m1.4.4.1.1.1.2.2"></sum><ci id="S2.E4.m1.4.4.1.1.1.2.3.cmml" xref="S2.E4.m1.4.4.1.1.1.2.3">𝑠</ci></apply><apply id="S2.E4.m1.4.4.1.1.1.1.cmml" xref="S2.E4.m1.4.4.1.1.1.1"><times id="S2.E4.m1.4.4.1.1.1.1.2.cmml" xref="S2.E4.m1.4.4.1.1.1.1.2"></times><log id="S2.E4.m1.4.4.1.1.1.1.3.cmml" xref="S2.E4.m1.4.4.1.1.1.1.3"></log><apply id="S2.E4.m1.4.4.1.1.1.1.1.cmml" xref="S2.E4.m1.4.4.1.1.1.1.1"><int id="S2.E4.m1.4.4.1.1.1.1.1.2.cmml" xref="S2.E4.m1.4.4.1.1.1.1.1.2"></int><apply id="S2.E4.m1.4.4.1.1.1.1.1.1.cmml" xref="S2.E4.m1.4.4.1.1.1.1.1.1"><times id="S2.E4.m1.4.4.1.1.1.1.1.1.2.cmml" xref="S2.E4.m1.4.4.1.1.1.1.1.1.2"></times><ci id="S2.E4.m1.4.4.1.1.1.1.1.1.3.cmml" xref="S2.E4.m1.4.4.1.1.1.1.1.1.3">𝑝</ci><apply id="S2.E4.m1.4.4.1.1.1.1.1.1.1.1.1.cmml" xref="S2.E4.m1.4.4.1.1.1.1.1.1.1.1"><csymbol cd="latexml" id="S2.E4.m1.4.4.1.1.1.1.1.1.1.1.1.1.cmml" xref="S2.E4.m1.4.4.1.1.1.1.1.1.1.1.1.1">conditional</csymbol><apply id="S2.E4.m1.4.4.1.1.1.1.1.1.1.1.1.2.cmml" xref="S2.E4.m1.4.4.1.1.1.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S2.E4.m1.4.4.1.1.1.1.1.1.1.1.1.2.1.cmml" xref="S2.E4.m1.4.4.1.1.1.1.1.1.1.1.1.2">subscript</csymbol><ci id="S2.E4.m1.4.4.1.1.1.1.1.1.1.1.1.2.2.cmml" xref="S2.E4.m1.4.4.1.1.1.1.1.1.1.1.1.2.2">𝒟</ci><ci id="S2.E4.m1.4.4.1.1.1.1.1.1.1.1.1.2.3.cmml" xref="S2.E4.m1.4.4.1.1.1.1.1.1.1.1.1.2.3">𝑠</ci></apply><apply id="S2.E4.m1.4.4.1.1.1.1.1.1.1.1.1.3.cmml" xref="S2.E4.m1.4.4.1.1.1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S2.E4.m1.4.4.1.1.1.1.1.1.1.1.1.3.1.cmml" xref="S2.E4.m1.4.4.1.1.1.1.1.1.1.1.1.3">subscript</csymbol><ci id="S2.E4.m1.4.4.1.1.1.1.1.1.1.1.1.3.2.cmml" xref="S2.E4.m1.4.4.1.1.1.1.1.1.1.1.1.3.2">bold-italic-ϕ</ci><ci id="S2.E4.m1.4.4.1.1.1.1.1.1.1.1.1.3.3.cmml" xref="S2.E4.m1.4.4.1.1.1.1.1.1.1.1.1.3.3">𝑠</ci></apply></apply><apply id="S2.E4.m1.2.2.cmml" xref="S2.E4.m1.2.2"><divide id="S2.E4.m1.2.2.3.cmml" xref="S2.E4.m1.2.2"></divide><apply id="S2.E4.m1.2.2.2.3.cmml" xref="S2.E4.m1.2.2.2.2"><exp id="S2.E4.m1.1.1.1.1.cmml" xref="S2.E4.m1.1.1.1.1"></exp><apply id="S2.E4.m1.2.2.2.2.1.1.cmml" xref="S2.E4.m1.2.2.2.2.1.1"><minus id="S2.E4.m1.2.2.2.2.1.1.2.cmml" xref="S2.E4.m1.2.2.2.2.1.1"></minus><apply id="S2.E4.m1.2.2.2.2.1.1.1.cmml" xref="S2.E4.m1.2.2.2.2.1.1.1"><times id="S2.E4.m1.2.2.2.2.1.1.1.2.cmml" xref="S2.E4.m1.2.2.2.2.1.1.1.2"></times><apply id="S2.E4.m1.2.2.2.2.1.1.1.3.cmml" xref="S2.E4.m1.2.2.2.2.1.1.1.3"><divide id="S2.E4.m1.2.2.2.2.1.1.1.3.1.cmml" xref="S2.E4.m1.2.2.2.2.1.1.1.3"></divide><ci id="S2.E4.m1.2.2.2.2.1.1.1.3.2.cmml" xref="S2.E4.m1.2.2.2.2.1.1.1.3.2">𝜆</ci><cn type="integer" id="S2.E4.m1.2.2.2.2.1.1.1.3.3.cmml" xref="S2.E4.m1.2.2.2.2.1.1.1.3.3">2</cn></apply><apply id="S2.E4.m1.2.2.2.2.1.1.1.1.cmml" xref="S2.E4.m1.2.2.2.2.1.1.1.1"><csymbol cd="ambiguous" id="S2.E4.m1.2.2.2.2.1.1.1.1.2.cmml" xref="S2.E4.m1.2.2.2.2.1.1.1.1">superscript</csymbol><apply id="S2.E4.m1.2.2.2.2.1.1.1.1.1.2.cmml" xref="S2.E4.m1.2.2.2.2.1.1.1.1.1.1"><csymbol cd="latexml" id="S2.E4.m1.2.2.2.2.1.1.1.1.1.2.1.cmml" xref="S2.E4.m1.2.2.2.2.1.1.1.1.1.1.2">norm</csymbol><apply id="S2.E4.m1.2.2.2.2.1.1.1.1.1.1.1.cmml" xref="S2.E4.m1.2.2.2.2.1.1.1.1.1.1.1"><minus id="S2.E4.m1.2.2.2.2.1.1.1.1.1.1.1.1.cmml" xref="S2.E4.m1.2.2.2.2.1.1.1.1.1.1.1.1"></minus><apply id="S2.E4.m1.2.2.2.2.1.1.1.1.1.1.1.2.cmml" xref="S2.E4.m1.2.2.2.2.1.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S2.E4.m1.2.2.2.2.1.1.1.1.1.1.1.2.1.cmml" xref="S2.E4.m1.2.2.2.2.1.1.1.1.1.1.1.2">subscript</csymbol><ci id="S2.E4.m1.2.2.2.2.1.1.1.1.1.1.1.2.2.cmml" xref="S2.E4.m1.2.2.2.2.1.1.1.1.1.1.1.2.2">bold-italic-ϕ</ci><ci id="S2.E4.m1.2.2.2.2.1.1.1.1.1.1.1.2.3.cmml" xref="S2.E4.m1.2.2.2.2.1.1.1.1.1.1.1.2.3">𝑠</ci></apply><ci id="S2.E4.m1.2.2.2.2.1.1.1.1.1.1.1.3.cmml" xref="S2.E4.m1.2.2.2.2.1.1.1.1.1.1.1.3">𝐰</ci></apply></apply><cn type="integer" id="S2.E4.m1.2.2.2.2.1.1.1.1.3.cmml" xref="S2.E4.m1.2.2.2.2.1.1.1.1.3">2</cn></apply></apply></apply></apply><ci id="S2.E4.m1.2.2.4.cmml" xref="S2.E4.m1.2.2.4">𝑍</ci></apply><apply id="S2.E4.m1.4.4.1.1.1.1.1.1.4.cmml" xref="S2.E4.m1.4.4.1.1.1.1.1.1.4"><csymbol cd="latexml" id="S2.E4.m1.4.4.1.1.1.1.1.1.4.1.cmml" xref="S2.E4.m1.4.4.1.1.1.1.1.1.4.1">differential-d</csymbol><apply id="S2.E4.m1.4.4.1.1.1.1.1.1.4.2.cmml" xref="S2.E4.m1.4.4.1.1.1.1.1.1.4.2"><csymbol cd="ambiguous" id="S2.E4.m1.4.4.1.1.1.1.1.1.4.2.1.cmml" xref="S2.E4.m1.4.4.1.1.1.1.1.1.4.2">subscript</csymbol><ci id="S2.E4.m1.4.4.1.1.1.1.1.1.4.2.2.cmml" xref="S2.E4.m1.4.4.1.1.1.1.1.1.4.2.2">bold-italic-ϕ</ci><ci id="S2.E4.m1.4.4.1.1.1.1.1.1.4.2.3.cmml" xref="S2.E4.m1.4.4.1.1.1.1.1.1.4.2.3">𝑠</ci></apply></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.E4.m1.4c">\displaystyle\mathcal{F}(\mathbf{w}):=\sum_{s}\log\int p(\mathcal{D}_{s}|\bm{\phi}_{s})\frac{\exp\left(-\frac{\lambda}{2}\|\bm{\phi}_{s}-\mathbf{w}\|^{2}\right)}{Z}\mathrm{d}\bm{\phi}_{s},</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(4)</span></td>
</tr></tbody>
</table>
<p id="S2.SS1.p1.13" class="ltx_p">and the graphical model of this process can be seen at Figure <a href="#S1.F2" title="Figure 2 ‣ 1 Introduction ‣ An Expectation-Maximization Perspective on Federated Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">2</span></a>.</p>
</div>
<div id="S2.SS1.p2" class="ltx_para">
<p id="S2.SS1.p2.1" class="ltx_p">How can we then optimize Eq. <a href="#S2.E4" title="In 2.1 FedAvg as learning in a hierarchical model ‣ 2 A hierarchical model interpretation of federated learning ‣ An Expectation-Maximization Perspective on Federated Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">4</span></a> in the presence of these latent variables <math id="S2.SS1.p2.1.m1.1" class="ltx_Math" alttext="\bm{\phi}_{s}" display="inline"><semantics id="S2.SS1.p2.1.m1.1a"><msub id="S2.SS1.p2.1.m1.1.1" xref="S2.SS1.p2.1.m1.1.1.cmml"><mi class="ltx_mathvariant_bold-italic" mathvariant="bold-italic" id="S2.SS1.p2.1.m1.1.1.2" xref="S2.SS1.p2.1.m1.1.1.2.cmml">ϕ</mi><mi id="S2.SS1.p2.1.m1.1.1.3" xref="S2.SS1.p2.1.m1.1.1.3.cmml">s</mi></msub><annotation-xml encoding="MathML-Content" id="S2.SS1.p2.1.m1.1b"><apply id="S2.SS1.p2.1.m1.1.1.cmml" xref="S2.SS1.p2.1.m1.1.1"><csymbol cd="ambiguous" id="S2.SS1.p2.1.m1.1.1.1.cmml" xref="S2.SS1.p2.1.m1.1.1">subscript</csymbol><ci id="S2.SS1.p2.1.m1.1.1.2.cmml" xref="S2.SS1.p2.1.m1.1.1.2">bold-italic-ϕ</ci><ci id="S2.SS1.p2.1.m1.1.1.3.cmml" xref="S2.SS1.p2.1.m1.1.1.3">𝑠</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p2.1.m1.1c">\bm{\phi}_{s}</annotation></semantics></math>? The traditional way to optimize such objectives is through Expectation-Maximization (EM). EM consists of two steps, the E-step where we form the posterior distribution over these latent variables</p>
<table id="A10.EGx5" class="ltx_equationgroup ltx_eqn_align ltx_eqn_table">

<tbody id="S2.E5"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math id="S2.E5.m1.5" class="ltx_Math" alttext="\displaystyle p(\bm{\phi}_{s}|\mathcal{D}_{s},\mathbf{w})=\frac{p(\mathcal{D}_{s}|\bm{\phi}_{s})p(\bm{\phi}_{s}|\mathbf{w})}{p(\mathcal{D}_{s}|\mathbf{w})}," display="inline"><semantics id="S2.E5.m1.5a"><mrow id="S2.E5.m1.5.5.1" xref="S2.E5.m1.5.5.1.1.cmml"><mrow id="S2.E5.m1.5.5.1.1" xref="S2.E5.m1.5.5.1.1.cmml"><mrow id="S2.E5.m1.5.5.1.1.1" xref="S2.E5.m1.5.5.1.1.1.cmml"><mi id="S2.E5.m1.5.5.1.1.1.3" xref="S2.E5.m1.5.5.1.1.1.3.cmml">p</mi><mo lspace="0em" rspace="0em" id="S2.E5.m1.5.5.1.1.1.2" xref="S2.E5.m1.5.5.1.1.1.2.cmml">​</mo><mrow id="S2.E5.m1.5.5.1.1.1.1.1" xref="S2.E5.m1.5.5.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S2.E5.m1.5.5.1.1.1.1.1.2" xref="S2.E5.m1.5.5.1.1.1.1.1.1.cmml">(</mo><mrow id="S2.E5.m1.5.5.1.1.1.1.1.1" xref="S2.E5.m1.5.5.1.1.1.1.1.1.cmml"><msub id="S2.E5.m1.5.5.1.1.1.1.1.1.3" xref="S2.E5.m1.5.5.1.1.1.1.1.1.3.cmml"><mi class="ltx_mathvariant_bold-italic" mathvariant="bold-italic" id="S2.E5.m1.5.5.1.1.1.1.1.1.3.2" xref="S2.E5.m1.5.5.1.1.1.1.1.1.3.2.cmml">ϕ</mi><mi id="S2.E5.m1.5.5.1.1.1.1.1.1.3.3" xref="S2.E5.m1.5.5.1.1.1.1.1.1.3.3.cmml">s</mi></msub><mo fence="false" id="S2.E5.m1.5.5.1.1.1.1.1.1.2" xref="S2.E5.m1.5.5.1.1.1.1.1.1.2.cmml">|</mo><mrow id="S2.E5.m1.5.5.1.1.1.1.1.1.1.1" xref="S2.E5.m1.5.5.1.1.1.1.1.1.1.2.cmml"><msub id="S2.E5.m1.5.5.1.1.1.1.1.1.1.1.1" xref="S2.E5.m1.5.5.1.1.1.1.1.1.1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S2.E5.m1.5.5.1.1.1.1.1.1.1.1.1.2" xref="S2.E5.m1.5.5.1.1.1.1.1.1.1.1.1.2.cmml">𝒟</mi><mi id="S2.E5.m1.5.5.1.1.1.1.1.1.1.1.1.3" xref="S2.E5.m1.5.5.1.1.1.1.1.1.1.1.1.3.cmml">s</mi></msub><mo id="S2.E5.m1.5.5.1.1.1.1.1.1.1.1.2" xref="S2.E5.m1.5.5.1.1.1.1.1.1.1.2.cmml">,</mo><mi id="S2.E5.m1.4.4" xref="S2.E5.m1.4.4.cmml">𝐰</mi></mrow></mrow><mo stretchy="false" id="S2.E5.m1.5.5.1.1.1.1.1.3" xref="S2.E5.m1.5.5.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S2.E5.m1.5.5.1.1.2" xref="S2.E5.m1.5.5.1.1.2.cmml">=</mo><mstyle displaystyle="true" id="S2.E5.m1.3.3" xref="S2.E5.m1.3.3.cmml"><mfrac id="S2.E5.m1.3.3a" xref="S2.E5.m1.3.3.cmml"><mrow id="S2.E5.m1.2.2.2" xref="S2.E5.m1.2.2.2.cmml"><mi id="S2.E5.m1.2.2.2.4" xref="S2.E5.m1.2.2.2.4.cmml">p</mi><mo lspace="0em" rspace="0em" id="S2.E5.m1.2.2.2.3" xref="S2.E5.m1.2.2.2.3.cmml">​</mo><mrow id="S2.E5.m1.1.1.1.1.1" xref="S2.E5.m1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S2.E5.m1.1.1.1.1.1.2" xref="S2.E5.m1.1.1.1.1.1.1.cmml">(</mo><mrow id="S2.E5.m1.1.1.1.1.1.1" xref="S2.E5.m1.1.1.1.1.1.1.cmml"><msub id="S2.E5.m1.1.1.1.1.1.1.2" xref="S2.E5.m1.1.1.1.1.1.1.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S2.E5.m1.1.1.1.1.1.1.2.2" xref="S2.E5.m1.1.1.1.1.1.1.2.2.cmml">𝒟</mi><mi id="S2.E5.m1.1.1.1.1.1.1.2.3" xref="S2.E5.m1.1.1.1.1.1.1.2.3.cmml">s</mi></msub><mo fence="false" id="S2.E5.m1.1.1.1.1.1.1.1" xref="S2.E5.m1.1.1.1.1.1.1.1.cmml">|</mo><msub id="S2.E5.m1.1.1.1.1.1.1.3" xref="S2.E5.m1.1.1.1.1.1.1.3.cmml"><mi class="ltx_mathvariant_bold-italic" mathvariant="bold-italic" id="S2.E5.m1.1.1.1.1.1.1.3.2" xref="S2.E5.m1.1.1.1.1.1.1.3.2.cmml">ϕ</mi><mi id="S2.E5.m1.1.1.1.1.1.1.3.3" xref="S2.E5.m1.1.1.1.1.1.1.3.3.cmml">s</mi></msub></mrow><mo stretchy="false" id="S2.E5.m1.1.1.1.1.1.3" xref="S2.E5.m1.1.1.1.1.1.1.cmml">)</mo></mrow><mo lspace="0em" rspace="0em" id="S2.E5.m1.2.2.2.3a" xref="S2.E5.m1.2.2.2.3.cmml">​</mo><mi id="S2.E5.m1.2.2.2.5" xref="S2.E5.m1.2.2.2.5.cmml">p</mi><mo lspace="0em" rspace="0em" id="S2.E5.m1.2.2.2.3b" xref="S2.E5.m1.2.2.2.3.cmml">​</mo><mrow id="S2.E5.m1.2.2.2.2.1" xref="S2.E5.m1.2.2.2.2.1.1.cmml"><mo stretchy="false" id="S2.E5.m1.2.2.2.2.1.2" xref="S2.E5.m1.2.2.2.2.1.1.cmml">(</mo><mrow id="S2.E5.m1.2.2.2.2.1.1" xref="S2.E5.m1.2.2.2.2.1.1.cmml"><msub id="S2.E5.m1.2.2.2.2.1.1.2" xref="S2.E5.m1.2.2.2.2.1.1.2.cmml"><mi class="ltx_mathvariant_bold-italic" mathvariant="bold-italic" id="S2.E5.m1.2.2.2.2.1.1.2.2" xref="S2.E5.m1.2.2.2.2.1.1.2.2.cmml">ϕ</mi><mi id="S2.E5.m1.2.2.2.2.1.1.2.3" xref="S2.E5.m1.2.2.2.2.1.1.2.3.cmml">s</mi></msub><mo fence="false" id="S2.E5.m1.2.2.2.2.1.1.1" xref="S2.E5.m1.2.2.2.2.1.1.1.cmml">|</mo><mi id="S2.E5.m1.2.2.2.2.1.1.3" xref="S2.E5.m1.2.2.2.2.1.1.3.cmml">𝐰</mi></mrow><mo stretchy="false" id="S2.E5.m1.2.2.2.2.1.3" xref="S2.E5.m1.2.2.2.2.1.1.cmml">)</mo></mrow></mrow><mrow id="S2.E5.m1.3.3.3" xref="S2.E5.m1.3.3.3.cmml"><mi id="S2.E5.m1.3.3.3.3" xref="S2.E5.m1.3.3.3.3.cmml">p</mi><mo lspace="0em" rspace="0em" id="S2.E5.m1.3.3.3.2" xref="S2.E5.m1.3.3.3.2.cmml">​</mo><mrow id="S2.E5.m1.3.3.3.1.1" xref="S2.E5.m1.3.3.3.1.1.1.cmml"><mo stretchy="false" id="S2.E5.m1.3.3.3.1.1.2" xref="S2.E5.m1.3.3.3.1.1.1.cmml">(</mo><mrow id="S2.E5.m1.3.3.3.1.1.1" xref="S2.E5.m1.3.3.3.1.1.1.cmml"><msub id="S2.E5.m1.3.3.3.1.1.1.2" xref="S2.E5.m1.3.3.3.1.1.1.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S2.E5.m1.3.3.3.1.1.1.2.2" xref="S2.E5.m1.3.3.3.1.1.1.2.2.cmml">𝒟</mi><mi id="S2.E5.m1.3.3.3.1.1.1.2.3" xref="S2.E5.m1.3.3.3.1.1.1.2.3.cmml">s</mi></msub><mo fence="false" id="S2.E5.m1.3.3.3.1.1.1.1" xref="S2.E5.m1.3.3.3.1.1.1.1.cmml">|</mo><mi id="S2.E5.m1.3.3.3.1.1.1.3" xref="S2.E5.m1.3.3.3.1.1.1.3.cmml">𝐰</mi></mrow><mo stretchy="false" id="S2.E5.m1.3.3.3.1.1.3" xref="S2.E5.m1.3.3.3.1.1.1.cmml">)</mo></mrow></mrow></mfrac></mstyle></mrow><mo id="S2.E5.m1.5.5.1.2" xref="S2.E5.m1.5.5.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S2.E5.m1.5b"><apply id="S2.E5.m1.5.5.1.1.cmml" xref="S2.E5.m1.5.5.1"><eq id="S2.E5.m1.5.5.1.1.2.cmml" xref="S2.E5.m1.5.5.1.1.2"></eq><apply id="S2.E5.m1.5.5.1.1.1.cmml" xref="S2.E5.m1.5.5.1.1.1"><times id="S2.E5.m1.5.5.1.1.1.2.cmml" xref="S2.E5.m1.5.5.1.1.1.2"></times><ci id="S2.E5.m1.5.5.1.1.1.3.cmml" xref="S2.E5.m1.5.5.1.1.1.3">𝑝</ci><apply id="S2.E5.m1.5.5.1.1.1.1.1.1.cmml" xref="S2.E5.m1.5.5.1.1.1.1.1"><csymbol cd="latexml" id="S2.E5.m1.5.5.1.1.1.1.1.1.2.cmml" xref="S2.E5.m1.5.5.1.1.1.1.1.1.2">conditional</csymbol><apply id="S2.E5.m1.5.5.1.1.1.1.1.1.3.cmml" xref="S2.E5.m1.5.5.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S2.E5.m1.5.5.1.1.1.1.1.1.3.1.cmml" xref="S2.E5.m1.5.5.1.1.1.1.1.1.3">subscript</csymbol><ci id="S2.E5.m1.5.5.1.1.1.1.1.1.3.2.cmml" xref="S2.E5.m1.5.5.1.1.1.1.1.1.3.2">bold-italic-ϕ</ci><ci id="S2.E5.m1.5.5.1.1.1.1.1.1.3.3.cmml" xref="S2.E5.m1.5.5.1.1.1.1.1.1.3.3">𝑠</ci></apply><list id="S2.E5.m1.5.5.1.1.1.1.1.1.1.2.cmml" xref="S2.E5.m1.5.5.1.1.1.1.1.1.1.1"><apply id="S2.E5.m1.5.5.1.1.1.1.1.1.1.1.1.cmml" xref="S2.E5.m1.5.5.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S2.E5.m1.5.5.1.1.1.1.1.1.1.1.1.1.cmml" xref="S2.E5.m1.5.5.1.1.1.1.1.1.1.1.1">subscript</csymbol><ci id="S2.E5.m1.5.5.1.1.1.1.1.1.1.1.1.2.cmml" xref="S2.E5.m1.5.5.1.1.1.1.1.1.1.1.1.2">𝒟</ci><ci id="S2.E5.m1.5.5.1.1.1.1.1.1.1.1.1.3.cmml" xref="S2.E5.m1.5.5.1.1.1.1.1.1.1.1.1.3">𝑠</ci></apply><ci id="S2.E5.m1.4.4.cmml" xref="S2.E5.m1.4.4">𝐰</ci></list></apply></apply><apply id="S2.E5.m1.3.3.cmml" xref="S2.E5.m1.3.3"><divide id="S2.E5.m1.3.3.4.cmml" xref="S2.E5.m1.3.3"></divide><apply id="S2.E5.m1.2.2.2.cmml" xref="S2.E5.m1.2.2.2"><times id="S2.E5.m1.2.2.2.3.cmml" xref="S2.E5.m1.2.2.2.3"></times><ci id="S2.E5.m1.2.2.2.4.cmml" xref="S2.E5.m1.2.2.2.4">𝑝</ci><apply id="S2.E5.m1.1.1.1.1.1.1.cmml" xref="S2.E5.m1.1.1.1.1.1"><csymbol cd="latexml" id="S2.E5.m1.1.1.1.1.1.1.1.cmml" xref="S2.E5.m1.1.1.1.1.1.1.1">conditional</csymbol><apply id="S2.E5.m1.1.1.1.1.1.1.2.cmml" xref="S2.E5.m1.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S2.E5.m1.1.1.1.1.1.1.2.1.cmml" xref="S2.E5.m1.1.1.1.1.1.1.2">subscript</csymbol><ci id="S2.E5.m1.1.1.1.1.1.1.2.2.cmml" xref="S2.E5.m1.1.1.1.1.1.1.2.2">𝒟</ci><ci id="S2.E5.m1.1.1.1.1.1.1.2.3.cmml" xref="S2.E5.m1.1.1.1.1.1.1.2.3">𝑠</ci></apply><apply id="S2.E5.m1.1.1.1.1.1.1.3.cmml" xref="S2.E5.m1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S2.E5.m1.1.1.1.1.1.1.3.1.cmml" xref="S2.E5.m1.1.1.1.1.1.1.3">subscript</csymbol><ci id="S2.E5.m1.1.1.1.1.1.1.3.2.cmml" xref="S2.E5.m1.1.1.1.1.1.1.3.2">bold-italic-ϕ</ci><ci id="S2.E5.m1.1.1.1.1.1.1.3.3.cmml" xref="S2.E5.m1.1.1.1.1.1.1.3.3">𝑠</ci></apply></apply><ci id="S2.E5.m1.2.2.2.5.cmml" xref="S2.E5.m1.2.2.2.5">𝑝</ci><apply id="S2.E5.m1.2.2.2.2.1.1.cmml" xref="S2.E5.m1.2.2.2.2.1"><csymbol cd="latexml" id="S2.E5.m1.2.2.2.2.1.1.1.cmml" xref="S2.E5.m1.2.2.2.2.1.1.1">conditional</csymbol><apply id="S2.E5.m1.2.2.2.2.1.1.2.cmml" xref="S2.E5.m1.2.2.2.2.1.1.2"><csymbol cd="ambiguous" id="S2.E5.m1.2.2.2.2.1.1.2.1.cmml" xref="S2.E5.m1.2.2.2.2.1.1.2">subscript</csymbol><ci id="S2.E5.m1.2.2.2.2.1.1.2.2.cmml" xref="S2.E5.m1.2.2.2.2.1.1.2.2">bold-italic-ϕ</ci><ci id="S2.E5.m1.2.2.2.2.1.1.2.3.cmml" xref="S2.E5.m1.2.2.2.2.1.1.2.3">𝑠</ci></apply><ci id="S2.E5.m1.2.2.2.2.1.1.3.cmml" xref="S2.E5.m1.2.2.2.2.1.1.3">𝐰</ci></apply></apply><apply id="S2.E5.m1.3.3.3.cmml" xref="S2.E5.m1.3.3.3"><times id="S2.E5.m1.3.3.3.2.cmml" xref="S2.E5.m1.3.3.3.2"></times><ci id="S2.E5.m1.3.3.3.3.cmml" xref="S2.E5.m1.3.3.3.3">𝑝</ci><apply id="S2.E5.m1.3.3.3.1.1.1.cmml" xref="S2.E5.m1.3.3.3.1.1"><csymbol cd="latexml" id="S2.E5.m1.3.3.3.1.1.1.1.cmml" xref="S2.E5.m1.3.3.3.1.1.1.1">conditional</csymbol><apply id="S2.E5.m1.3.3.3.1.1.1.2.cmml" xref="S2.E5.m1.3.3.3.1.1.1.2"><csymbol cd="ambiguous" id="S2.E5.m1.3.3.3.1.1.1.2.1.cmml" xref="S2.E5.m1.3.3.3.1.1.1.2">subscript</csymbol><ci id="S2.E5.m1.3.3.3.1.1.1.2.2.cmml" xref="S2.E5.m1.3.3.3.1.1.1.2.2">𝒟</ci><ci id="S2.E5.m1.3.3.3.1.1.1.2.3.cmml" xref="S2.E5.m1.3.3.3.1.1.1.2.3">𝑠</ci></apply><ci id="S2.E5.m1.3.3.3.1.1.1.3.cmml" xref="S2.E5.m1.3.3.3.1.1.1.3">𝐰</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.E5.m1.5c">\displaystyle p(\bm{\phi}_{s}|\mathcal{D}_{s},\mathbf{w})=\frac{p(\mathcal{D}_{s}|\bm{\phi}_{s})p(\bm{\phi}_{s}|\mathbf{w})}{p(\mathcal{D}_{s}|\mathbf{w})},</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(5)</span></td>
</tr></tbody>
</table>
<p id="S2.SS1.p2.3" class="ltx_p">and the M-step where we maximize the probability of <math id="S2.SS1.p2.2.m1.1" class="ltx_Math" alttext="\mathcal{D}_{s}" display="inline"><semantics id="S2.SS1.p2.2.m1.1a"><msub id="S2.SS1.p2.2.m1.1.1" xref="S2.SS1.p2.2.m1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S2.SS1.p2.2.m1.1.1.2" xref="S2.SS1.p2.2.m1.1.1.2.cmml">𝒟</mi><mi id="S2.SS1.p2.2.m1.1.1.3" xref="S2.SS1.p2.2.m1.1.1.3.cmml">s</mi></msub><annotation-xml encoding="MathML-Content" id="S2.SS1.p2.2.m1.1b"><apply id="S2.SS1.p2.2.m1.1.1.cmml" xref="S2.SS1.p2.2.m1.1.1"><csymbol cd="ambiguous" id="S2.SS1.p2.2.m1.1.1.1.cmml" xref="S2.SS1.p2.2.m1.1.1">subscript</csymbol><ci id="S2.SS1.p2.2.m1.1.1.2.cmml" xref="S2.SS1.p2.2.m1.1.1.2">𝒟</ci><ci id="S2.SS1.p2.2.m1.1.1.3.cmml" xref="S2.SS1.p2.2.m1.1.1.3">𝑠</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p2.2.m1.1c">\mathcal{D}_{s}</annotation></semantics></math> w.r.t. the parameters of the model <math id="S2.SS1.p2.3.m2.1" class="ltx_Math" alttext="\mathbf{w}" display="inline"><semantics id="S2.SS1.p2.3.m2.1a"><mi id="S2.SS1.p2.3.m2.1.1" xref="S2.SS1.p2.3.m2.1.1.cmml">𝐰</mi><annotation-xml encoding="MathML-Content" id="S2.SS1.p2.3.m2.1b"><ci id="S2.SS1.p2.3.m2.1.1.cmml" xref="S2.SS1.p2.3.m2.1.1">𝐰</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p2.3.m2.1c">\mathbf{w}</annotation></semantics></math> by marginalizing over this posterior</p>
<table id="A10.EGx6" class="ltx_equationgroup ltx_eqn_align ltx_eqn_table">

<tbody id="S2.E6"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math id="S2.E6.m1.3" class="ltx_Math" alttext="\displaystyle\operatorname*{arg\,max}_{\mathbf{w}}\sum_{s}\mathbb{E}_{p(\bm{\phi}_{s}|\mathcal{D}_{s},\mathbf{w}_{\text{old}})}[\log p(\mathcal{D}_{s},\bm{\phi}_{s}|\mathbf{w})]=\operatorname*{arg\,max}_{\mathbf{w}}\sum_{s}\mathbb{E}_{p(\bm{\phi}_{s}|\mathcal{D}_{s},\mathbf{w}_{\text{old}})}[\log p(\bm{\phi}_{s}|\mathbf{w})]." display="inline"><semantics id="S2.E6.m1.3a"><mrow id="S2.E6.m1.3.3.1" xref="S2.E6.m1.3.3.1.1.cmml"><mrow id="S2.E6.m1.3.3.1.1" xref="S2.E6.m1.3.3.1.1.cmml"><mrow id="S2.E6.m1.3.3.1.1.1" xref="S2.E6.m1.3.3.1.1.1.cmml"><munder id="S2.E6.m1.3.3.1.1.1.3" xref="S2.E6.m1.3.3.1.1.1.3.cmml"><mrow id="S2.E6.m1.3.3.1.1.1.3.2" xref="S2.E6.m1.3.3.1.1.1.3.2.cmml"><mi id="S2.E6.m1.3.3.1.1.1.3.2.2" xref="S2.E6.m1.3.3.1.1.1.3.2.2.cmml">arg</mi><mo lspace="0.170em" rspace="0em" id="S2.E6.m1.3.3.1.1.1.3.2.1" xref="S2.E6.m1.3.3.1.1.1.3.2.1.cmml">​</mo><mi id="S2.E6.m1.3.3.1.1.1.3.2.3" xref="S2.E6.m1.3.3.1.1.1.3.2.3.cmml">max</mi></mrow><mi id="S2.E6.m1.3.3.1.1.1.3.3" xref="S2.E6.m1.3.3.1.1.1.3.3.cmml">𝐰</mi></munder><mo lspace="0.167em" rspace="0em" id="S2.E6.m1.3.3.1.1.1.2" xref="S2.E6.m1.3.3.1.1.1.2.cmml">​</mo><mrow id="S2.E6.m1.3.3.1.1.1.1" xref="S2.E6.m1.3.3.1.1.1.1.cmml"><mstyle displaystyle="true" id="S2.E6.m1.3.3.1.1.1.1.2" xref="S2.E6.m1.3.3.1.1.1.1.2.cmml"><munder id="S2.E6.m1.3.3.1.1.1.1.2a" xref="S2.E6.m1.3.3.1.1.1.1.2.cmml"><mo movablelimits="false" id="S2.E6.m1.3.3.1.1.1.1.2.2" xref="S2.E6.m1.3.3.1.1.1.1.2.2.cmml">∑</mo><mi id="S2.E6.m1.3.3.1.1.1.1.2.3" xref="S2.E6.m1.3.3.1.1.1.1.2.3.cmml">s</mi></munder></mstyle><mrow id="S2.E6.m1.3.3.1.1.1.1.1" xref="S2.E6.m1.3.3.1.1.1.1.1.cmml"><msub id="S2.E6.m1.3.3.1.1.1.1.1.3" xref="S2.E6.m1.3.3.1.1.1.1.1.3.cmml"><mi id="S2.E6.m1.3.3.1.1.1.1.1.3.2" xref="S2.E6.m1.3.3.1.1.1.1.1.3.2.cmml">𝔼</mi><mrow id="S2.E6.m1.1.1.1" xref="S2.E6.m1.1.1.1.cmml"><mi id="S2.E6.m1.1.1.1.3" xref="S2.E6.m1.1.1.1.3.cmml">p</mi><mo lspace="0em" rspace="0em" id="S2.E6.m1.1.1.1.2" xref="S2.E6.m1.1.1.1.2.cmml">​</mo><mrow id="S2.E6.m1.1.1.1.1.1" xref="S2.E6.m1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S2.E6.m1.1.1.1.1.1.2" xref="S2.E6.m1.1.1.1.1.1.1.cmml">(</mo><mrow id="S2.E6.m1.1.1.1.1.1.1" xref="S2.E6.m1.1.1.1.1.1.1.cmml"><msub id="S2.E6.m1.1.1.1.1.1.1.4" xref="S2.E6.m1.1.1.1.1.1.1.4.cmml"><mi class="ltx_mathvariant_bold-italic" mathvariant="bold-italic" id="S2.E6.m1.1.1.1.1.1.1.4.2" xref="S2.E6.m1.1.1.1.1.1.1.4.2.cmml">ϕ</mi><mi id="S2.E6.m1.1.1.1.1.1.1.4.3" xref="S2.E6.m1.1.1.1.1.1.1.4.3.cmml">s</mi></msub><mo fence="false" id="S2.E6.m1.1.1.1.1.1.1.3" xref="S2.E6.m1.1.1.1.1.1.1.3.cmml">|</mo><mrow id="S2.E6.m1.1.1.1.1.1.1.2.2" xref="S2.E6.m1.1.1.1.1.1.1.2.3.cmml"><msub id="S2.E6.m1.1.1.1.1.1.1.1.1.1" xref="S2.E6.m1.1.1.1.1.1.1.1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S2.E6.m1.1.1.1.1.1.1.1.1.1.2" xref="S2.E6.m1.1.1.1.1.1.1.1.1.1.2.cmml">𝒟</mi><mi id="S2.E6.m1.1.1.1.1.1.1.1.1.1.3" xref="S2.E6.m1.1.1.1.1.1.1.1.1.1.3.cmml">s</mi></msub><mo id="S2.E6.m1.1.1.1.1.1.1.2.2.3" xref="S2.E6.m1.1.1.1.1.1.1.2.3.cmml">,</mo><msub id="S2.E6.m1.1.1.1.1.1.1.2.2.2" xref="S2.E6.m1.1.1.1.1.1.1.2.2.2.cmml"><mi id="S2.E6.m1.1.1.1.1.1.1.2.2.2.2" xref="S2.E6.m1.1.1.1.1.1.1.2.2.2.2.cmml">𝐰</mi><mtext id="S2.E6.m1.1.1.1.1.1.1.2.2.2.3" xref="S2.E6.m1.1.1.1.1.1.1.2.2.2.3a.cmml">old</mtext></msub></mrow></mrow><mo stretchy="false" id="S2.E6.m1.1.1.1.1.1.3" xref="S2.E6.m1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></msub><mo lspace="0em" rspace="0em" id="S2.E6.m1.3.3.1.1.1.1.1.2" xref="S2.E6.m1.3.3.1.1.1.1.1.2.cmml">​</mo><mrow id="S2.E6.m1.3.3.1.1.1.1.1.1.1" xref="S2.E6.m1.3.3.1.1.1.1.1.1.2.cmml"><mo stretchy="false" id="S2.E6.m1.3.3.1.1.1.1.1.1.1.2" xref="S2.E6.m1.3.3.1.1.1.1.1.1.2.1.cmml">[</mo><mrow id="S2.E6.m1.3.3.1.1.1.1.1.1.1.1" xref="S2.E6.m1.3.3.1.1.1.1.1.1.1.1.cmml"><mrow id="S2.E6.m1.3.3.1.1.1.1.1.1.1.1.4" xref="S2.E6.m1.3.3.1.1.1.1.1.1.1.1.4.cmml"><mi id="S2.E6.m1.3.3.1.1.1.1.1.1.1.1.4.1" xref="S2.E6.m1.3.3.1.1.1.1.1.1.1.1.4.1.cmml">log</mi><mo lspace="0.167em" id="S2.E6.m1.3.3.1.1.1.1.1.1.1.1.4a" xref="S2.E6.m1.3.3.1.1.1.1.1.1.1.1.4.cmml">⁡</mo><mi id="S2.E6.m1.3.3.1.1.1.1.1.1.1.1.4.2" xref="S2.E6.m1.3.3.1.1.1.1.1.1.1.1.4.2.cmml">p</mi></mrow><mo lspace="0em" rspace="0em" id="S2.E6.m1.3.3.1.1.1.1.1.1.1.1.3" xref="S2.E6.m1.3.3.1.1.1.1.1.1.1.1.3.cmml">​</mo><mrow id="S2.E6.m1.3.3.1.1.1.1.1.1.1.1.2.2" xref="S2.E6.m1.3.3.1.1.1.1.1.1.1.1.2.3.cmml"><mo stretchy="false" id="S2.E6.m1.3.3.1.1.1.1.1.1.1.1.2.2.3" xref="S2.E6.m1.3.3.1.1.1.1.1.1.1.1.2.3.cmml">(</mo><msub id="S2.E6.m1.3.3.1.1.1.1.1.1.1.1.1.1.1" xref="S2.E6.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S2.E6.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.2" xref="S2.E6.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.2.cmml">𝒟</mi><mi id="S2.E6.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.3" xref="S2.E6.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.3.cmml">s</mi></msub><mo id="S2.E6.m1.3.3.1.1.1.1.1.1.1.1.2.2.4" xref="S2.E6.m1.3.3.1.1.1.1.1.1.1.1.2.3.cmml">,</mo><mrow id="S2.E6.m1.3.3.1.1.1.1.1.1.1.1.2.2.2" xref="S2.E6.m1.3.3.1.1.1.1.1.1.1.1.2.2.2.cmml"><msub id="S2.E6.m1.3.3.1.1.1.1.1.1.1.1.2.2.2.2" xref="S2.E6.m1.3.3.1.1.1.1.1.1.1.1.2.2.2.2.cmml"><mi class="ltx_mathvariant_bold-italic" mathvariant="bold-italic" id="S2.E6.m1.3.3.1.1.1.1.1.1.1.1.2.2.2.2.2" xref="S2.E6.m1.3.3.1.1.1.1.1.1.1.1.2.2.2.2.2.cmml">ϕ</mi><mi id="S2.E6.m1.3.3.1.1.1.1.1.1.1.1.2.2.2.2.3" xref="S2.E6.m1.3.3.1.1.1.1.1.1.1.1.2.2.2.2.3.cmml">s</mi></msub><mo fence="false" id="S2.E6.m1.3.3.1.1.1.1.1.1.1.1.2.2.2.1" xref="S2.E6.m1.3.3.1.1.1.1.1.1.1.1.2.2.2.1.cmml">|</mo><mi id="S2.E6.m1.3.3.1.1.1.1.1.1.1.1.2.2.2.3" xref="S2.E6.m1.3.3.1.1.1.1.1.1.1.1.2.2.2.3.cmml">𝐰</mi></mrow><mo stretchy="false" id="S2.E6.m1.3.3.1.1.1.1.1.1.1.1.2.2.5" xref="S2.E6.m1.3.3.1.1.1.1.1.1.1.1.2.3.cmml">)</mo></mrow></mrow><mo stretchy="false" id="S2.E6.m1.3.3.1.1.1.1.1.1.1.3" xref="S2.E6.m1.3.3.1.1.1.1.1.1.2.1.cmml">]</mo></mrow></mrow></mrow></mrow><mo id="S2.E6.m1.3.3.1.1.3" xref="S2.E6.m1.3.3.1.1.3.cmml">=</mo><mrow id="S2.E6.m1.3.3.1.1.2" xref="S2.E6.m1.3.3.1.1.2.cmml"><munder id="S2.E6.m1.3.3.1.1.2.3" xref="S2.E6.m1.3.3.1.1.2.3.cmml"><mrow id="S2.E6.m1.3.3.1.1.2.3.2" xref="S2.E6.m1.3.3.1.1.2.3.2.cmml"><mi id="S2.E6.m1.3.3.1.1.2.3.2.2" xref="S2.E6.m1.3.3.1.1.2.3.2.2.cmml">arg</mi><mo lspace="0.170em" rspace="0em" id="S2.E6.m1.3.3.1.1.2.3.2.1" xref="S2.E6.m1.3.3.1.1.2.3.2.1.cmml">​</mo><mi id="S2.E6.m1.3.3.1.1.2.3.2.3" xref="S2.E6.m1.3.3.1.1.2.3.2.3.cmml">max</mi></mrow><mi id="S2.E6.m1.3.3.1.1.2.3.3" xref="S2.E6.m1.3.3.1.1.2.3.3.cmml">𝐰</mi></munder><mo lspace="0em" rspace="0em" id="S2.E6.m1.3.3.1.1.2.2" xref="S2.E6.m1.3.3.1.1.2.2.cmml">​</mo><mrow id="S2.E6.m1.3.3.1.1.2.1" xref="S2.E6.m1.3.3.1.1.2.1.cmml"><mstyle displaystyle="true" id="S2.E6.m1.3.3.1.1.2.1.2" xref="S2.E6.m1.3.3.1.1.2.1.2.cmml"><munder id="S2.E6.m1.3.3.1.1.2.1.2a" xref="S2.E6.m1.3.3.1.1.2.1.2.cmml"><mo movablelimits="false" id="S2.E6.m1.3.3.1.1.2.1.2.2" xref="S2.E6.m1.3.3.1.1.2.1.2.2.cmml">∑</mo><mi id="S2.E6.m1.3.3.1.1.2.1.2.3" xref="S2.E6.m1.3.3.1.1.2.1.2.3.cmml">s</mi></munder></mstyle><mrow id="S2.E6.m1.3.3.1.1.2.1.1" xref="S2.E6.m1.3.3.1.1.2.1.1.cmml"><msub id="S2.E6.m1.3.3.1.1.2.1.1.3" xref="S2.E6.m1.3.3.1.1.2.1.1.3.cmml"><mi id="S2.E6.m1.3.3.1.1.2.1.1.3.2" xref="S2.E6.m1.3.3.1.1.2.1.1.3.2.cmml">𝔼</mi><mrow id="S2.E6.m1.2.2.1" xref="S2.E6.m1.2.2.1.cmml"><mi id="S2.E6.m1.2.2.1.3" xref="S2.E6.m1.2.2.1.3.cmml">p</mi><mo lspace="0em" rspace="0em" id="S2.E6.m1.2.2.1.2" xref="S2.E6.m1.2.2.1.2.cmml">​</mo><mrow id="S2.E6.m1.2.2.1.1.1" xref="S2.E6.m1.2.2.1.1.1.1.cmml"><mo stretchy="false" id="S2.E6.m1.2.2.1.1.1.2" xref="S2.E6.m1.2.2.1.1.1.1.cmml">(</mo><mrow id="S2.E6.m1.2.2.1.1.1.1" xref="S2.E6.m1.2.2.1.1.1.1.cmml"><msub id="S2.E6.m1.2.2.1.1.1.1.4" xref="S2.E6.m1.2.2.1.1.1.1.4.cmml"><mi class="ltx_mathvariant_bold-italic" mathvariant="bold-italic" id="S2.E6.m1.2.2.1.1.1.1.4.2" xref="S2.E6.m1.2.2.1.1.1.1.4.2.cmml">ϕ</mi><mi id="S2.E6.m1.2.2.1.1.1.1.4.3" xref="S2.E6.m1.2.2.1.1.1.1.4.3.cmml">s</mi></msub><mo fence="false" id="S2.E6.m1.2.2.1.1.1.1.3" xref="S2.E6.m1.2.2.1.1.1.1.3.cmml">|</mo><mrow id="S2.E6.m1.2.2.1.1.1.1.2.2" xref="S2.E6.m1.2.2.1.1.1.1.2.3.cmml"><msub id="S2.E6.m1.2.2.1.1.1.1.1.1.1" xref="S2.E6.m1.2.2.1.1.1.1.1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S2.E6.m1.2.2.1.1.1.1.1.1.1.2" xref="S2.E6.m1.2.2.1.1.1.1.1.1.1.2.cmml">𝒟</mi><mi id="S2.E6.m1.2.2.1.1.1.1.1.1.1.3" xref="S2.E6.m1.2.2.1.1.1.1.1.1.1.3.cmml">s</mi></msub><mo id="S2.E6.m1.2.2.1.1.1.1.2.2.3" xref="S2.E6.m1.2.2.1.1.1.1.2.3.cmml">,</mo><msub id="S2.E6.m1.2.2.1.1.1.1.2.2.2" xref="S2.E6.m1.2.2.1.1.1.1.2.2.2.cmml"><mi id="S2.E6.m1.2.2.1.1.1.1.2.2.2.2" xref="S2.E6.m1.2.2.1.1.1.1.2.2.2.2.cmml">𝐰</mi><mtext id="S2.E6.m1.2.2.1.1.1.1.2.2.2.3" xref="S2.E6.m1.2.2.1.1.1.1.2.2.2.3a.cmml">old</mtext></msub></mrow></mrow><mo stretchy="false" id="S2.E6.m1.2.2.1.1.1.3" xref="S2.E6.m1.2.2.1.1.1.1.cmml">)</mo></mrow></mrow></msub><mo lspace="0em" rspace="0em" id="S2.E6.m1.3.3.1.1.2.1.1.2" xref="S2.E6.m1.3.3.1.1.2.1.1.2.cmml">​</mo><mrow id="S2.E6.m1.3.3.1.1.2.1.1.1.1" xref="S2.E6.m1.3.3.1.1.2.1.1.1.2.cmml"><mo stretchy="false" id="S2.E6.m1.3.3.1.1.2.1.1.1.1.2" xref="S2.E6.m1.3.3.1.1.2.1.1.1.2.1.cmml">[</mo><mrow id="S2.E6.m1.3.3.1.1.2.1.1.1.1.1" xref="S2.E6.m1.3.3.1.1.2.1.1.1.1.1.cmml"><mrow id="S2.E6.m1.3.3.1.1.2.1.1.1.1.1.3" xref="S2.E6.m1.3.3.1.1.2.1.1.1.1.1.3.cmml"><mi id="S2.E6.m1.3.3.1.1.2.1.1.1.1.1.3.1" xref="S2.E6.m1.3.3.1.1.2.1.1.1.1.1.3.1.cmml">log</mi><mo lspace="0.167em" id="S2.E6.m1.3.3.1.1.2.1.1.1.1.1.3a" xref="S2.E6.m1.3.3.1.1.2.1.1.1.1.1.3.cmml">⁡</mo><mi id="S2.E6.m1.3.3.1.1.2.1.1.1.1.1.3.2" xref="S2.E6.m1.3.3.1.1.2.1.1.1.1.1.3.2.cmml">p</mi></mrow><mo lspace="0em" rspace="0em" id="S2.E6.m1.3.3.1.1.2.1.1.1.1.1.2" xref="S2.E6.m1.3.3.1.1.2.1.1.1.1.1.2.cmml">​</mo><mrow id="S2.E6.m1.3.3.1.1.2.1.1.1.1.1.1.1" xref="S2.E6.m1.3.3.1.1.2.1.1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S2.E6.m1.3.3.1.1.2.1.1.1.1.1.1.1.2" xref="S2.E6.m1.3.3.1.1.2.1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="S2.E6.m1.3.3.1.1.2.1.1.1.1.1.1.1.1" xref="S2.E6.m1.3.3.1.1.2.1.1.1.1.1.1.1.1.cmml"><msub id="S2.E6.m1.3.3.1.1.2.1.1.1.1.1.1.1.1.2" xref="S2.E6.m1.3.3.1.1.2.1.1.1.1.1.1.1.1.2.cmml"><mi class="ltx_mathvariant_bold-italic" mathvariant="bold-italic" id="S2.E6.m1.3.3.1.1.2.1.1.1.1.1.1.1.1.2.2" xref="S2.E6.m1.3.3.1.1.2.1.1.1.1.1.1.1.1.2.2.cmml">ϕ</mi><mi id="S2.E6.m1.3.3.1.1.2.1.1.1.1.1.1.1.1.2.3" xref="S2.E6.m1.3.3.1.1.2.1.1.1.1.1.1.1.1.2.3.cmml">s</mi></msub><mo fence="false" id="S2.E6.m1.3.3.1.1.2.1.1.1.1.1.1.1.1.1" xref="S2.E6.m1.3.3.1.1.2.1.1.1.1.1.1.1.1.1.cmml">|</mo><mi id="S2.E6.m1.3.3.1.1.2.1.1.1.1.1.1.1.1.3" xref="S2.E6.m1.3.3.1.1.2.1.1.1.1.1.1.1.1.3.cmml">𝐰</mi></mrow><mo stretchy="false" id="S2.E6.m1.3.3.1.1.2.1.1.1.1.1.1.1.3" xref="S2.E6.m1.3.3.1.1.2.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo stretchy="false" id="S2.E6.m1.3.3.1.1.2.1.1.1.1.3" xref="S2.E6.m1.3.3.1.1.2.1.1.1.2.1.cmml">]</mo></mrow></mrow></mrow></mrow></mrow><mo lspace="0em" id="S2.E6.m1.3.3.1.2" xref="S2.E6.m1.3.3.1.1.cmml">.</mo></mrow><annotation-xml encoding="MathML-Content" id="S2.E6.m1.3b"><apply id="S2.E6.m1.3.3.1.1.cmml" xref="S2.E6.m1.3.3.1"><eq id="S2.E6.m1.3.3.1.1.3.cmml" xref="S2.E6.m1.3.3.1.1.3"></eq><apply id="S2.E6.m1.3.3.1.1.1.cmml" xref="S2.E6.m1.3.3.1.1.1"><times id="S2.E6.m1.3.3.1.1.1.2.cmml" xref="S2.E6.m1.3.3.1.1.1.2"></times><apply id="S2.E6.m1.3.3.1.1.1.3.cmml" xref="S2.E6.m1.3.3.1.1.1.3"><csymbol cd="ambiguous" id="S2.E6.m1.3.3.1.1.1.3.1.cmml" xref="S2.E6.m1.3.3.1.1.1.3">subscript</csymbol><apply id="S2.E6.m1.3.3.1.1.1.3.2.cmml" xref="S2.E6.m1.3.3.1.1.1.3.2"><times id="S2.E6.m1.3.3.1.1.1.3.2.1.cmml" xref="S2.E6.m1.3.3.1.1.1.3.2.1"></times><ci id="S2.E6.m1.3.3.1.1.1.3.2.2.cmml" xref="S2.E6.m1.3.3.1.1.1.3.2.2">arg</ci><ci id="S2.E6.m1.3.3.1.1.1.3.2.3.cmml" xref="S2.E6.m1.3.3.1.1.1.3.2.3">max</ci></apply><ci id="S2.E6.m1.3.3.1.1.1.3.3.cmml" xref="S2.E6.m1.3.3.1.1.1.3.3">𝐰</ci></apply><apply id="S2.E6.m1.3.3.1.1.1.1.cmml" xref="S2.E6.m1.3.3.1.1.1.1"><apply id="S2.E6.m1.3.3.1.1.1.1.2.cmml" xref="S2.E6.m1.3.3.1.1.1.1.2"><csymbol cd="ambiguous" id="S2.E6.m1.3.3.1.1.1.1.2.1.cmml" xref="S2.E6.m1.3.3.1.1.1.1.2">subscript</csymbol><sum id="S2.E6.m1.3.3.1.1.1.1.2.2.cmml" xref="S2.E6.m1.3.3.1.1.1.1.2.2"></sum><ci id="S2.E6.m1.3.3.1.1.1.1.2.3.cmml" xref="S2.E6.m1.3.3.1.1.1.1.2.3">𝑠</ci></apply><apply id="S2.E6.m1.3.3.1.1.1.1.1.cmml" xref="S2.E6.m1.3.3.1.1.1.1.1"><times id="S2.E6.m1.3.3.1.1.1.1.1.2.cmml" xref="S2.E6.m1.3.3.1.1.1.1.1.2"></times><apply id="S2.E6.m1.3.3.1.1.1.1.1.3.cmml" xref="S2.E6.m1.3.3.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S2.E6.m1.3.3.1.1.1.1.1.3.1.cmml" xref="S2.E6.m1.3.3.1.1.1.1.1.3">subscript</csymbol><ci id="S2.E6.m1.3.3.1.1.1.1.1.3.2.cmml" xref="S2.E6.m1.3.3.1.1.1.1.1.3.2">𝔼</ci><apply id="S2.E6.m1.1.1.1.cmml" xref="S2.E6.m1.1.1.1"><times id="S2.E6.m1.1.1.1.2.cmml" xref="S2.E6.m1.1.1.1.2"></times><ci id="S2.E6.m1.1.1.1.3.cmml" xref="S2.E6.m1.1.1.1.3">𝑝</ci><apply id="S2.E6.m1.1.1.1.1.1.1.cmml" xref="S2.E6.m1.1.1.1.1.1"><csymbol cd="latexml" id="S2.E6.m1.1.1.1.1.1.1.3.cmml" xref="S2.E6.m1.1.1.1.1.1.1.3">conditional</csymbol><apply id="S2.E6.m1.1.1.1.1.1.1.4.cmml" xref="S2.E6.m1.1.1.1.1.1.1.4"><csymbol cd="ambiguous" id="S2.E6.m1.1.1.1.1.1.1.4.1.cmml" xref="S2.E6.m1.1.1.1.1.1.1.4">subscript</csymbol><ci id="S2.E6.m1.1.1.1.1.1.1.4.2.cmml" xref="S2.E6.m1.1.1.1.1.1.1.4.2">bold-italic-ϕ</ci><ci id="S2.E6.m1.1.1.1.1.1.1.4.3.cmml" xref="S2.E6.m1.1.1.1.1.1.1.4.3">𝑠</ci></apply><list id="S2.E6.m1.1.1.1.1.1.1.2.3.cmml" xref="S2.E6.m1.1.1.1.1.1.1.2.2"><apply id="S2.E6.m1.1.1.1.1.1.1.1.1.1.cmml" xref="S2.E6.m1.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S2.E6.m1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S2.E6.m1.1.1.1.1.1.1.1.1.1">subscript</csymbol><ci id="S2.E6.m1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S2.E6.m1.1.1.1.1.1.1.1.1.1.2">𝒟</ci><ci id="S2.E6.m1.1.1.1.1.1.1.1.1.1.3.cmml" xref="S2.E6.m1.1.1.1.1.1.1.1.1.1.3">𝑠</ci></apply><apply id="S2.E6.m1.1.1.1.1.1.1.2.2.2.cmml" xref="S2.E6.m1.1.1.1.1.1.1.2.2.2"><csymbol cd="ambiguous" id="S2.E6.m1.1.1.1.1.1.1.2.2.2.1.cmml" xref="S2.E6.m1.1.1.1.1.1.1.2.2.2">subscript</csymbol><ci id="S2.E6.m1.1.1.1.1.1.1.2.2.2.2.cmml" xref="S2.E6.m1.1.1.1.1.1.1.2.2.2.2">𝐰</ci><ci id="S2.E6.m1.1.1.1.1.1.1.2.2.2.3a.cmml" xref="S2.E6.m1.1.1.1.1.1.1.2.2.2.3"><mtext mathsize="50%" id="S2.E6.m1.1.1.1.1.1.1.2.2.2.3.cmml" xref="S2.E6.m1.1.1.1.1.1.1.2.2.2.3">old</mtext></ci></apply></list></apply></apply></apply><apply id="S2.E6.m1.3.3.1.1.1.1.1.1.2.cmml" xref="S2.E6.m1.3.3.1.1.1.1.1.1.1"><csymbol cd="latexml" id="S2.E6.m1.3.3.1.1.1.1.1.1.2.1.cmml" xref="S2.E6.m1.3.3.1.1.1.1.1.1.1.2">delimited-[]</csymbol><apply id="S2.E6.m1.3.3.1.1.1.1.1.1.1.1.cmml" xref="S2.E6.m1.3.3.1.1.1.1.1.1.1.1"><times id="S2.E6.m1.3.3.1.1.1.1.1.1.1.1.3.cmml" xref="S2.E6.m1.3.3.1.1.1.1.1.1.1.1.3"></times><apply id="S2.E6.m1.3.3.1.1.1.1.1.1.1.1.4.cmml" xref="S2.E6.m1.3.3.1.1.1.1.1.1.1.1.4"><log id="S2.E6.m1.3.3.1.1.1.1.1.1.1.1.4.1.cmml" xref="S2.E6.m1.3.3.1.1.1.1.1.1.1.1.4.1"></log><ci id="S2.E6.m1.3.3.1.1.1.1.1.1.1.1.4.2.cmml" xref="S2.E6.m1.3.3.1.1.1.1.1.1.1.1.4.2">𝑝</ci></apply><interval closure="open" id="S2.E6.m1.3.3.1.1.1.1.1.1.1.1.2.3.cmml" xref="S2.E6.m1.3.3.1.1.1.1.1.1.1.1.2.2"><apply id="S2.E6.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S2.E6.m1.3.3.1.1.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S2.E6.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S2.E6.m1.3.3.1.1.1.1.1.1.1.1.1.1.1">subscript</csymbol><ci id="S2.E6.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S2.E6.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.2">𝒟</ci><ci id="S2.E6.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="S2.E6.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.3">𝑠</ci></apply><apply id="S2.E6.m1.3.3.1.1.1.1.1.1.1.1.2.2.2.cmml" xref="S2.E6.m1.3.3.1.1.1.1.1.1.1.1.2.2.2"><csymbol cd="latexml" id="S2.E6.m1.3.3.1.1.1.1.1.1.1.1.2.2.2.1.cmml" xref="S2.E6.m1.3.3.1.1.1.1.1.1.1.1.2.2.2.1">conditional</csymbol><apply id="S2.E6.m1.3.3.1.1.1.1.1.1.1.1.2.2.2.2.cmml" xref="S2.E6.m1.3.3.1.1.1.1.1.1.1.1.2.2.2.2"><csymbol cd="ambiguous" id="S2.E6.m1.3.3.1.1.1.1.1.1.1.1.2.2.2.2.1.cmml" xref="S2.E6.m1.3.3.1.1.1.1.1.1.1.1.2.2.2.2">subscript</csymbol><ci id="S2.E6.m1.3.3.1.1.1.1.1.1.1.1.2.2.2.2.2.cmml" xref="S2.E6.m1.3.3.1.1.1.1.1.1.1.1.2.2.2.2.2">bold-italic-ϕ</ci><ci id="S2.E6.m1.3.3.1.1.1.1.1.1.1.1.2.2.2.2.3.cmml" xref="S2.E6.m1.3.3.1.1.1.1.1.1.1.1.2.2.2.2.3">𝑠</ci></apply><ci id="S2.E6.m1.3.3.1.1.1.1.1.1.1.1.2.2.2.3.cmml" xref="S2.E6.m1.3.3.1.1.1.1.1.1.1.1.2.2.2.3">𝐰</ci></apply></interval></apply></apply></apply></apply></apply><apply id="S2.E6.m1.3.3.1.1.2.cmml" xref="S2.E6.m1.3.3.1.1.2"><times id="S2.E6.m1.3.3.1.1.2.2.cmml" xref="S2.E6.m1.3.3.1.1.2.2"></times><apply id="S2.E6.m1.3.3.1.1.2.3.cmml" xref="S2.E6.m1.3.3.1.1.2.3"><csymbol cd="ambiguous" id="S2.E6.m1.3.3.1.1.2.3.1.cmml" xref="S2.E6.m1.3.3.1.1.2.3">subscript</csymbol><apply id="S2.E6.m1.3.3.1.1.2.3.2.cmml" xref="S2.E6.m1.3.3.1.1.2.3.2"><times id="S2.E6.m1.3.3.1.1.2.3.2.1.cmml" xref="S2.E6.m1.3.3.1.1.2.3.2.1"></times><ci id="S2.E6.m1.3.3.1.1.2.3.2.2.cmml" xref="S2.E6.m1.3.3.1.1.2.3.2.2">arg</ci><ci id="S2.E6.m1.3.3.1.1.2.3.2.3.cmml" xref="S2.E6.m1.3.3.1.1.2.3.2.3">max</ci></apply><ci id="S2.E6.m1.3.3.1.1.2.3.3.cmml" xref="S2.E6.m1.3.3.1.1.2.3.3">𝐰</ci></apply><apply id="S2.E6.m1.3.3.1.1.2.1.cmml" xref="S2.E6.m1.3.3.1.1.2.1"><apply id="S2.E6.m1.3.3.1.1.2.1.2.cmml" xref="S2.E6.m1.3.3.1.1.2.1.2"><csymbol cd="ambiguous" id="S2.E6.m1.3.3.1.1.2.1.2.1.cmml" xref="S2.E6.m1.3.3.1.1.2.1.2">subscript</csymbol><sum id="S2.E6.m1.3.3.1.1.2.1.2.2.cmml" xref="S2.E6.m1.3.3.1.1.2.1.2.2"></sum><ci id="S2.E6.m1.3.3.1.1.2.1.2.3.cmml" xref="S2.E6.m1.3.3.1.1.2.1.2.3">𝑠</ci></apply><apply id="S2.E6.m1.3.3.1.1.2.1.1.cmml" xref="S2.E6.m1.3.3.1.1.2.1.1"><times id="S2.E6.m1.3.3.1.1.2.1.1.2.cmml" xref="S2.E6.m1.3.3.1.1.2.1.1.2"></times><apply id="S2.E6.m1.3.3.1.1.2.1.1.3.cmml" xref="S2.E6.m1.3.3.1.1.2.1.1.3"><csymbol cd="ambiguous" id="S2.E6.m1.3.3.1.1.2.1.1.3.1.cmml" xref="S2.E6.m1.3.3.1.1.2.1.1.3">subscript</csymbol><ci id="S2.E6.m1.3.3.1.1.2.1.1.3.2.cmml" xref="S2.E6.m1.3.3.1.1.2.1.1.3.2">𝔼</ci><apply id="S2.E6.m1.2.2.1.cmml" xref="S2.E6.m1.2.2.1"><times id="S2.E6.m1.2.2.1.2.cmml" xref="S2.E6.m1.2.2.1.2"></times><ci id="S2.E6.m1.2.2.1.3.cmml" xref="S2.E6.m1.2.2.1.3">𝑝</ci><apply id="S2.E6.m1.2.2.1.1.1.1.cmml" xref="S2.E6.m1.2.2.1.1.1"><csymbol cd="latexml" id="S2.E6.m1.2.2.1.1.1.1.3.cmml" xref="S2.E6.m1.2.2.1.1.1.1.3">conditional</csymbol><apply id="S2.E6.m1.2.2.1.1.1.1.4.cmml" xref="S2.E6.m1.2.2.1.1.1.1.4"><csymbol cd="ambiguous" id="S2.E6.m1.2.2.1.1.1.1.4.1.cmml" xref="S2.E6.m1.2.2.1.1.1.1.4">subscript</csymbol><ci id="S2.E6.m1.2.2.1.1.1.1.4.2.cmml" xref="S2.E6.m1.2.2.1.1.1.1.4.2">bold-italic-ϕ</ci><ci id="S2.E6.m1.2.2.1.1.1.1.4.3.cmml" xref="S2.E6.m1.2.2.1.1.1.1.4.3">𝑠</ci></apply><list id="S2.E6.m1.2.2.1.1.1.1.2.3.cmml" xref="S2.E6.m1.2.2.1.1.1.1.2.2"><apply id="S2.E6.m1.2.2.1.1.1.1.1.1.1.cmml" xref="S2.E6.m1.2.2.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S2.E6.m1.2.2.1.1.1.1.1.1.1.1.cmml" xref="S2.E6.m1.2.2.1.1.1.1.1.1.1">subscript</csymbol><ci id="S2.E6.m1.2.2.1.1.1.1.1.1.1.2.cmml" xref="S2.E6.m1.2.2.1.1.1.1.1.1.1.2">𝒟</ci><ci id="S2.E6.m1.2.2.1.1.1.1.1.1.1.3.cmml" xref="S2.E6.m1.2.2.1.1.1.1.1.1.1.3">𝑠</ci></apply><apply id="S2.E6.m1.2.2.1.1.1.1.2.2.2.cmml" xref="S2.E6.m1.2.2.1.1.1.1.2.2.2"><csymbol cd="ambiguous" id="S2.E6.m1.2.2.1.1.1.1.2.2.2.1.cmml" xref="S2.E6.m1.2.2.1.1.1.1.2.2.2">subscript</csymbol><ci id="S2.E6.m1.2.2.1.1.1.1.2.2.2.2.cmml" xref="S2.E6.m1.2.2.1.1.1.1.2.2.2.2">𝐰</ci><ci id="S2.E6.m1.2.2.1.1.1.1.2.2.2.3a.cmml" xref="S2.E6.m1.2.2.1.1.1.1.2.2.2.3"><mtext mathsize="50%" id="S2.E6.m1.2.2.1.1.1.1.2.2.2.3.cmml" xref="S2.E6.m1.2.2.1.1.1.1.2.2.2.3">old</mtext></ci></apply></list></apply></apply></apply><apply id="S2.E6.m1.3.3.1.1.2.1.1.1.2.cmml" xref="S2.E6.m1.3.3.1.1.2.1.1.1.1"><csymbol cd="latexml" id="S2.E6.m1.3.3.1.1.2.1.1.1.2.1.cmml" xref="S2.E6.m1.3.3.1.1.2.1.1.1.1.2">delimited-[]</csymbol><apply id="S2.E6.m1.3.3.1.1.2.1.1.1.1.1.cmml" xref="S2.E6.m1.3.3.1.1.2.1.1.1.1.1"><times id="S2.E6.m1.3.3.1.1.2.1.1.1.1.1.2.cmml" xref="S2.E6.m1.3.3.1.1.2.1.1.1.1.1.2"></times><apply id="S2.E6.m1.3.3.1.1.2.1.1.1.1.1.3.cmml" xref="S2.E6.m1.3.3.1.1.2.1.1.1.1.1.3"><log id="S2.E6.m1.3.3.1.1.2.1.1.1.1.1.3.1.cmml" xref="S2.E6.m1.3.3.1.1.2.1.1.1.1.1.3.1"></log><ci id="S2.E6.m1.3.3.1.1.2.1.1.1.1.1.3.2.cmml" xref="S2.E6.m1.3.3.1.1.2.1.1.1.1.1.3.2">𝑝</ci></apply><apply id="S2.E6.m1.3.3.1.1.2.1.1.1.1.1.1.1.1.cmml" xref="S2.E6.m1.3.3.1.1.2.1.1.1.1.1.1.1"><csymbol cd="latexml" id="S2.E6.m1.3.3.1.1.2.1.1.1.1.1.1.1.1.1.cmml" xref="S2.E6.m1.3.3.1.1.2.1.1.1.1.1.1.1.1.1">conditional</csymbol><apply id="S2.E6.m1.3.3.1.1.2.1.1.1.1.1.1.1.1.2.cmml" xref="S2.E6.m1.3.3.1.1.2.1.1.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S2.E6.m1.3.3.1.1.2.1.1.1.1.1.1.1.1.2.1.cmml" xref="S2.E6.m1.3.3.1.1.2.1.1.1.1.1.1.1.1.2">subscript</csymbol><ci id="S2.E6.m1.3.3.1.1.2.1.1.1.1.1.1.1.1.2.2.cmml" xref="S2.E6.m1.3.3.1.1.2.1.1.1.1.1.1.1.1.2.2">bold-italic-ϕ</ci><ci id="S2.E6.m1.3.3.1.1.2.1.1.1.1.1.1.1.1.2.3.cmml" xref="S2.E6.m1.3.3.1.1.2.1.1.1.1.1.1.1.1.2.3">𝑠</ci></apply><ci id="S2.E6.m1.3.3.1.1.2.1.1.1.1.1.1.1.1.3.cmml" xref="S2.E6.m1.3.3.1.1.2.1.1.1.1.1.1.1.1.3">𝐰</ci></apply></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.E6.m1.3c">\displaystyle\operatorname*{arg\,max}_{\mathbf{w}}\sum_{s}\mathbb{E}_{p(\bm{\phi}_{s}|\mathcal{D}_{s},\mathbf{w}_{\text{old}})}[\log p(\mathcal{D}_{s},\bm{\phi}_{s}|\mathbf{w})]=\operatorname*{arg\,max}_{\mathbf{w}}\sum_{s}\mathbb{E}_{p(\bm{\phi}_{s}|\mathcal{D}_{s},\mathbf{w}_{\text{old}})}[\log p(\bm{\phi}_{s}|\mathbf{w})].</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(6)</span></td>
</tr></tbody>
</table>
<p id="S2.SS1.p2.4" class="ltx_p">If we perform a single gradient step for <math id="S2.SS1.p2.4.m1.1" class="ltx_Math" alttext="\mathbf{w}" display="inline"><semantics id="S2.SS1.p2.4.m1.1a"><mi id="S2.SS1.p2.4.m1.1.1" xref="S2.SS1.p2.4.m1.1.1.cmml">𝐰</mi><annotation-xml encoding="MathML-Content" id="S2.SS1.p2.4.m1.1b"><ci id="S2.SS1.p2.4.m1.1.1.cmml" xref="S2.SS1.p2.4.m1.1.1">𝐰</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p2.4.m1.1c">\mathbf{w}</annotation></semantics></math> in the M-step, this procedure corresponds to doing gradient ascent on the original objective at Eq. <a href="#S2.E4" title="In 2.1 FedAvg as learning in a hierarchical model ‣ 2 A hierarchical model interpretation of federated learning ‣ An Expectation-Maximization Perspective on Federated Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">4</span></a>, a fact we show in Appendix <a href="#A6" title="Appendix F Correspondence between single step EM and gradient ascent ‣ An Expectation-Maximization Perspective on Federated Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">F</span></a>.</p>
</div>
<div id="S2.SS1.p3" class="ltx_para">
<p id="S2.SS1.p3.2" class="ltx_p">When posterior inference is intractable, hard-EM is usually employed as a simpler alternative. In this case we make “hard” assignment for the latent variables <math id="S2.SS1.p3.1.m1.1" class="ltx_Math" alttext="\bm{\phi}_{s}" display="inline"><semantics id="S2.SS1.p3.1.m1.1a"><msub id="S2.SS1.p3.1.m1.1.1" xref="S2.SS1.p3.1.m1.1.1.cmml"><mi class="ltx_mathvariant_bold-italic" mathvariant="bold-italic" id="S2.SS1.p3.1.m1.1.1.2" xref="S2.SS1.p3.1.m1.1.1.2.cmml">ϕ</mi><mi id="S2.SS1.p3.1.m1.1.1.3" xref="S2.SS1.p3.1.m1.1.1.3.cmml">s</mi></msub><annotation-xml encoding="MathML-Content" id="S2.SS1.p3.1.m1.1b"><apply id="S2.SS1.p3.1.m1.1.1.cmml" xref="S2.SS1.p3.1.m1.1.1"><csymbol cd="ambiguous" id="S2.SS1.p3.1.m1.1.1.1.cmml" xref="S2.SS1.p3.1.m1.1.1">subscript</csymbol><ci id="S2.SS1.p3.1.m1.1.1.2.cmml" xref="S2.SS1.p3.1.m1.1.1.2">bold-italic-ϕ</ci><ci id="S2.SS1.p3.1.m1.1.1.3.cmml" xref="S2.SS1.p3.1.m1.1.1.3">𝑠</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p3.1.m1.1c">\bm{\phi}_{s}</annotation></semantics></math> in the E-step by approximating <math id="S2.SS1.p3.2.m2.2" class="ltx_Math" alttext="p(\bm{\phi}_{s}|\mathcal{D}_{s},\mathbf{w})" display="inline"><semantics id="S2.SS1.p3.2.m2.2a"><mrow id="S2.SS1.p3.2.m2.2.2" xref="S2.SS1.p3.2.m2.2.2.cmml"><mi id="S2.SS1.p3.2.m2.2.2.3" xref="S2.SS1.p3.2.m2.2.2.3.cmml">p</mi><mo lspace="0em" rspace="0em" id="S2.SS1.p3.2.m2.2.2.2" xref="S2.SS1.p3.2.m2.2.2.2.cmml">​</mo><mrow id="S2.SS1.p3.2.m2.2.2.1.1" xref="S2.SS1.p3.2.m2.2.2.1.1.1.cmml"><mo stretchy="false" id="S2.SS1.p3.2.m2.2.2.1.1.2" xref="S2.SS1.p3.2.m2.2.2.1.1.1.cmml">(</mo><mrow id="S2.SS1.p3.2.m2.2.2.1.1.1" xref="S2.SS1.p3.2.m2.2.2.1.1.1.cmml"><msub id="S2.SS1.p3.2.m2.2.2.1.1.1.3" xref="S2.SS1.p3.2.m2.2.2.1.1.1.3.cmml"><mi class="ltx_mathvariant_bold-italic" mathvariant="bold-italic" id="S2.SS1.p3.2.m2.2.2.1.1.1.3.2" xref="S2.SS1.p3.2.m2.2.2.1.1.1.3.2.cmml">ϕ</mi><mi id="S2.SS1.p3.2.m2.2.2.1.1.1.3.3" xref="S2.SS1.p3.2.m2.2.2.1.1.1.3.3.cmml">s</mi></msub><mo fence="false" id="S2.SS1.p3.2.m2.2.2.1.1.1.2" xref="S2.SS1.p3.2.m2.2.2.1.1.1.2.cmml">|</mo><mrow id="S2.SS1.p3.2.m2.2.2.1.1.1.1.1" xref="S2.SS1.p3.2.m2.2.2.1.1.1.1.2.cmml"><msub id="S2.SS1.p3.2.m2.2.2.1.1.1.1.1.1" xref="S2.SS1.p3.2.m2.2.2.1.1.1.1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S2.SS1.p3.2.m2.2.2.1.1.1.1.1.1.2" xref="S2.SS1.p3.2.m2.2.2.1.1.1.1.1.1.2.cmml">𝒟</mi><mi id="S2.SS1.p3.2.m2.2.2.1.1.1.1.1.1.3" xref="S2.SS1.p3.2.m2.2.2.1.1.1.1.1.1.3.cmml">s</mi></msub><mo id="S2.SS1.p3.2.m2.2.2.1.1.1.1.1.2" xref="S2.SS1.p3.2.m2.2.2.1.1.1.1.2.cmml">,</mo><mi id="S2.SS1.p3.2.m2.1.1" xref="S2.SS1.p3.2.m2.1.1.cmml">𝐰</mi></mrow></mrow><mo stretchy="false" id="S2.SS1.p3.2.m2.2.2.1.1.3" xref="S2.SS1.p3.2.m2.2.2.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.SS1.p3.2.m2.2b"><apply id="S2.SS1.p3.2.m2.2.2.cmml" xref="S2.SS1.p3.2.m2.2.2"><times id="S2.SS1.p3.2.m2.2.2.2.cmml" xref="S2.SS1.p3.2.m2.2.2.2"></times><ci id="S2.SS1.p3.2.m2.2.2.3.cmml" xref="S2.SS1.p3.2.m2.2.2.3">𝑝</ci><apply id="S2.SS1.p3.2.m2.2.2.1.1.1.cmml" xref="S2.SS1.p3.2.m2.2.2.1.1"><csymbol cd="latexml" id="S2.SS1.p3.2.m2.2.2.1.1.1.2.cmml" xref="S2.SS1.p3.2.m2.2.2.1.1.1.2">conditional</csymbol><apply id="S2.SS1.p3.2.m2.2.2.1.1.1.3.cmml" xref="S2.SS1.p3.2.m2.2.2.1.1.1.3"><csymbol cd="ambiguous" id="S2.SS1.p3.2.m2.2.2.1.1.1.3.1.cmml" xref="S2.SS1.p3.2.m2.2.2.1.1.1.3">subscript</csymbol><ci id="S2.SS1.p3.2.m2.2.2.1.1.1.3.2.cmml" xref="S2.SS1.p3.2.m2.2.2.1.1.1.3.2">bold-italic-ϕ</ci><ci id="S2.SS1.p3.2.m2.2.2.1.1.1.3.3.cmml" xref="S2.SS1.p3.2.m2.2.2.1.1.1.3.3">𝑠</ci></apply><list id="S2.SS1.p3.2.m2.2.2.1.1.1.1.2.cmml" xref="S2.SS1.p3.2.m2.2.2.1.1.1.1.1"><apply id="S2.SS1.p3.2.m2.2.2.1.1.1.1.1.1.cmml" xref="S2.SS1.p3.2.m2.2.2.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S2.SS1.p3.2.m2.2.2.1.1.1.1.1.1.1.cmml" xref="S2.SS1.p3.2.m2.2.2.1.1.1.1.1.1">subscript</csymbol><ci id="S2.SS1.p3.2.m2.2.2.1.1.1.1.1.1.2.cmml" xref="S2.SS1.p3.2.m2.2.2.1.1.1.1.1.1.2">𝒟</ci><ci id="S2.SS1.p3.2.m2.2.2.1.1.1.1.1.1.3.cmml" xref="S2.SS1.p3.2.m2.2.2.1.1.1.1.1.1.3">𝑠</ci></apply><ci id="S2.SS1.p3.2.m2.1.1.cmml" xref="S2.SS1.p3.2.m2.1.1">𝐰</ci></list></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p3.2.m2.2c">p(\bm{\phi}_{s}|\mathcal{D}_{s},\mathbf{w})</annotation></semantics></math> with its most probable point, <em id="S2.SS1.p3.2.1" class="ltx_emph ltx_font_italic">i.e.</em></p>
<table id="A10.EGx7" class="ltx_equationgroup ltx_eqn_align ltx_eqn_table">

<tbody id="S2.E7"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math id="S2.E7.m1.4" class="ltx_Math" alttext="\displaystyle\bm{\phi}^{*}_{s}=\operatorname*{arg\,max}_{\bm{\phi}_{s}}\frac{p(\mathcal{D}_{s}|\bm{\phi}_{s})p(\bm{\phi}_{s}|\mathbf{w})}{p(\mathcal{D}_{s}|\mathbf{w})}=\operatorname*{arg\,max}_{\bm{\phi}_{s}}\log p(\mathcal{D}_{s}|\bm{\phi}_{s})+\log p(\bm{\phi}_{s}|\mathbf{w})." display="inline"><semantics id="S2.E7.m1.4a"><mrow id="S2.E7.m1.4.4.1" xref="S2.E7.m1.4.4.1.1.cmml"><mrow id="S2.E7.m1.4.4.1.1" xref="S2.E7.m1.4.4.1.1.cmml"><msubsup id="S2.E7.m1.4.4.1.1.4" xref="S2.E7.m1.4.4.1.1.4.cmml"><mi class="ltx_mathvariant_bold-italic" mathvariant="bold-italic" id="S2.E7.m1.4.4.1.1.4.2.2" xref="S2.E7.m1.4.4.1.1.4.2.2.cmml">ϕ</mi><mi id="S2.E7.m1.4.4.1.1.4.3" xref="S2.E7.m1.4.4.1.1.4.3.cmml">s</mi><mo id="S2.E7.m1.4.4.1.1.4.2.3" xref="S2.E7.m1.4.4.1.1.4.2.3.cmml">∗</mo></msubsup><mo id="S2.E7.m1.4.4.1.1.5" xref="S2.E7.m1.4.4.1.1.5.cmml">=</mo><mrow id="S2.E7.m1.4.4.1.1.6" xref="S2.E7.m1.4.4.1.1.6.cmml"><munder id="S2.E7.m1.4.4.1.1.6.1" xref="S2.E7.m1.4.4.1.1.6.1.cmml"><mrow id="S2.E7.m1.4.4.1.1.6.1.2" xref="S2.E7.m1.4.4.1.1.6.1.2.cmml"><mi id="S2.E7.m1.4.4.1.1.6.1.2.2" xref="S2.E7.m1.4.4.1.1.6.1.2.2.cmml">arg</mi><mo lspace="0.170em" rspace="0em" id="S2.E7.m1.4.4.1.1.6.1.2.1" xref="S2.E7.m1.4.4.1.1.6.1.2.1.cmml">​</mo><mi id="S2.E7.m1.4.4.1.1.6.1.2.3" xref="S2.E7.m1.4.4.1.1.6.1.2.3.cmml">max</mi></mrow><msub id="S2.E7.m1.4.4.1.1.6.1.3" xref="S2.E7.m1.4.4.1.1.6.1.3.cmml"><mi class="ltx_mathvariant_bold-italic" mathvariant="bold-italic" id="S2.E7.m1.4.4.1.1.6.1.3.2" xref="S2.E7.m1.4.4.1.1.6.1.3.2.cmml">ϕ</mi><mi id="S2.E7.m1.4.4.1.1.6.1.3.3" xref="S2.E7.m1.4.4.1.1.6.1.3.3.cmml">s</mi></msub></munder><mo id="S2.E7.m1.4.4.1.1.6a" xref="S2.E7.m1.4.4.1.1.6.cmml">⁡</mo><mstyle displaystyle="true" id="S2.E7.m1.3.3" xref="S2.E7.m1.3.3.cmml"><mfrac id="S2.E7.m1.3.3a" xref="S2.E7.m1.3.3.cmml"><mrow id="S2.E7.m1.2.2.2" xref="S2.E7.m1.2.2.2.cmml"><mi id="S2.E7.m1.2.2.2.4" xref="S2.E7.m1.2.2.2.4.cmml">p</mi><mo lspace="0em" rspace="0em" id="S2.E7.m1.2.2.2.3" xref="S2.E7.m1.2.2.2.3.cmml">​</mo><mrow id="S2.E7.m1.1.1.1.1.1" xref="S2.E7.m1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S2.E7.m1.1.1.1.1.1.2" xref="S2.E7.m1.1.1.1.1.1.1.cmml">(</mo><mrow id="S2.E7.m1.1.1.1.1.1.1" xref="S2.E7.m1.1.1.1.1.1.1.cmml"><msub id="S2.E7.m1.1.1.1.1.1.1.2" xref="S2.E7.m1.1.1.1.1.1.1.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S2.E7.m1.1.1.1.1.1.1.2.2" xref="S2.E7.m1.1.1.1.1.1.1.2.2.cmml">𝒟</mi><mi id="S2.E7.m1.1.1.1.1.1.1.2.3" xref="S2.E7.m1.1.1.1.1.1.1.2.3.cmml">s</mi></msub><mo fence="false" id="S2.E7.m1.1.1.1.1.1.1.1" xref="S2.E7.m1.1.1.1.1.1.1.1.cmml">|</mo><msub id="S2.E7.m1.1.1.1.1.1.1.3" xref="S2.E7.m1.1.1.1.1.1.1.3.cmml"><mi class="ltx_mathvariant_bold-italic" mathvariant="bold-italic" id="S2.E7.m1.1.1.1.1.1.1.3.2" xref="S2.E7.m1.1.1.1.1.1.1.3.2.cmml">ϕ</mi><mi id="S2.E7.m1.1.1.1.1.1.1.3.3" xref="S2.E7.m1.1.1.1.1.1.1.3.3.cmml">s</mi></msub></mrow><mo stretchy="false" id="S2.E7.m1.1.1.1.1.1.3" xref="S2.E7.m1.1.1.1.1.1.1.cmml">)</mo></mrow><mo lspace="0em" rspace="0em" id="S2.E7.m1.2.2.2.3a" xref="S2.E7.m1.2.2.2.3.cmml">​</mo><mi id="S2.E7.m1.2.2.2.5" xref="S2.E7.m1.2.2.2.5.cmml">p</mi><mo lspace="0em" rspace="0em" id="S2.E7.m1.2.2.2.3b" xref="S2.E7.m1.2.2.2.3.cmml">​</mo><mrow id="S2.E7.m1.2.2.2.2.1" xref="S2.E7.m1.2.2.2.2.1.1.cmml"><mo stretchy="false" id="S2.E7.m1.2.2.2.2.1.2" xref="S2.E7.m1.2.2.2.2.1.1.cmml">(</mo><mrow id="S2.E7.m1.2.2.2.2.1.1" xref="S2.E7.m1.2.2.2.2.1.1.cmml"><msub id="S2.E7.m1.2.2.2.2.1.1.2" xref="S2.E7.m1.2.2.2.2.1.1.2.cmml"><mi class="ltx_mathvariant_bold-italic" mathvariant="bold-italic" id="S2.E7.m1.2.2.2.2.1.1.2.2" xref="S2.E7.m1.2.2.2.2.1.1.2.2.cmml">ϕ</mi><mi id="S2.E7.m1.2.2.2.2.1.1.2.3" xref="S2.E7.m1.2.2.2.2.1.1.2.3.cmml">s</mi></msub><mo fence="false" id="S2.E7.m1.2.2.2.2.1.1.1" xref="S2.E7.m1.2.2.2.2.1.1.1.cmml">|</mo><mi id="S2.E7.m1.2.2.2.2.1.1.3" xref="S2.E7.m1.2.2.2.2.1.1.3.cmml">𝐰</mi></mrow><mo stretchy="false" id="S2.E7.m1.2.2.2.2.1.3" xref="S2.E7.m1.2.2.2.2.1.1.cmml">)</mo></mrow></mrow><mrow id="S2.E7.m1.3.3.3" xref="S2.E7.m1.3.3.3.cmml"><mi id="S2.E7.m1.3.3.3.3" xref="S2.E7.m1.3.3.3.3.cmml">p</mi><mo lspace="0em" rspace="0em" id="S2.E7.m1.3.3.3.2" xref="S2.E7.m1.3.3.3.2.cmml">​</mo><mrow id="S2.E7.m1.3.3.3.1.1" xref="S2.E7.m1.3.3.3.1.1.1.cmml"><mo stretchy="false" id="S2.E7.m1.3.3.3.1.1.2" xref="S2.E7.m1.3.3.3.1.1.1.cmml">(</mo><mrow id="S2.E7.m1.3.3.3.1.1.1" xref="S2.E7.m1.3.3.3.1.1.1.cmml"><msub id="S2.E7.m1.3.3.3.1.1.1.2" xref="S2.E7.m1.3.3.3.1.1.1.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S2.E7.m1.3.3.3.1.1.1.2.2" xref="S2.E7.m1.3.3.3.1.1.1.2.2.cmml">𝒟</mi><mi id="S2.E7.m1.3.3.3.1.1.1.2.3" xref="S2.E7.m1.3.3.3.1.1.1.2.3.cmml">s</mi></msub><mo fence="false" id="S2.E7.m1.3.3.3.1.1.1.1" xref="S2.E7.m1.3.3.3.1.1.1.1.cmml">|</mo><mi id="S2.E7.m1.3.3.3.1.1.1.3" xref="S2.E7.m1.3.3.3.1.1.1.3.cmml">𝐰</mi></mrow><mo stretchy="false" id="S2.E7.m1.3.3.3.1.1.3" xref="S2.E7.m1.3.3.3.1.1.1.cmml">)</mo></mrow></mrow></mfrac></mstyle></mrow><mo id="S2.E7.m1.4.4.1.1.7" xref="S2.E7.m1.4.4.1.1.7.cmml">=</mo><mrow id="S2.E7.m1.4.4.1.1.2" xref="S2.E7.m1.4.4.1.1.2.cmml"><mrow id="S2.E7.m1.4.4.1.1.1.1" xref="S2.E7.m1.4.4.1.1.1.1.cmml"><mrow id="S2.E7.m1.4.4.1.1.1.1.3" xref="S2.E7.m1.4.4.1.1.1.1.3.cmml"><mrow id="S2.E7.m1.4.4.1.1.1.1.3.1" xref="S2.E7.m1.4.4.1.1.1.1.3.1.cmml"><munder id="S2.E7.m1.4.4.1.1.1.1.3.1.1" xref="S2.E7.m1.4.4.1.1.1.1.3.1.1.cmml"><mrow id="S2.E7.m1.4.4.1.1.1.1.3.1.1.2" xref="S2.E7.m1.4.4.1.1.1.1.3.1.1.2.cmml"><mi id="S2.E7.m1.4.4.1.1.1.1.3.1.1.2.2" xref="S2.E7.m1.4.4.1.1.1.1.3.1.1.2.2.cmml">arg</mi><mo lspace="0.170em" rspace="0em" id="S2.E7.m1.4.4.1.1.1.1.3.1.1.2.1" xref="S2.E7.m1.4.4.1.1.1.1.3.1.1.2.1.cmml">​</mo><mi id="S2.E7.m1.4.4.1.1.1.1.3.1.1.2.3" xref="S2.E7.m1.4.4.1.1.1.1.3.1.1.2.3.cmml">max</mi></mrow><msub id="S2.E7.m1.4.4.1.1.1.1.3.1.1.3" xref="S2.E7.m1.4.4.1.1.1.1.3.1.1.3.cmml"><mi class="ltx_mathvariant_bold-italic" mathvariant="bold-italic" id="S2.E7.m1.4.4.1.1.1.1.3.1.1.3.2" xref="S2.E7.m1.4.4.1.1.1.1.3.1.1.3.2.cmml">ϕ</mi><mi id="S2.E7.m1.4.4.1.1.1.1.3.1.1.3.3" xref="S2.E7.m1.4.4.1.1.1.1.3.1.1.3.3.cmml">s</mi></msub></munder><mo lspace="0.167em" id="S2.E7.m1.4.4.1.1.1.1.3.1a" xref="S2.E7.m1.4.4.1.1.1.1.3.1.cmml">⁡</mo><mi id="S2.E7.m1.4.4.1.1.1.1.3.1.2" xref="S2.E7.m1.4.4.1.1.1.1.3.1.2.cmml">log</mi></mrow><mo lspace="0.167em" id="S2.E7.m1.4.4.1.1.1.1.3a" xref="S2.E7.m1.4.4.1.1.1.1.3.cmml">⁡</mo><mi id="S2.E7.m1.4.4.1.1.1.1.3.2" xref="S2.E7.m1.4.4.1.1.1.1.3.2.cmml">p</mi></mrow><mo lspace="0em" rspace="0em" id="S2.E7.m1.4.4.1.1.1.1.2" xref="S2.E7.m1.4.4.1.1.1.1.2.cmml">​</mo><mrow id="S2.E7.m1.4.4.1.1.1.1.1.1" xref="S2.E7.m1.4.4.1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S2.E7.m1.4.4.1.1.1.1.1.1.2" xref="S2.E7.m1.4.4.1.1.1.1.1.1.1.cmml">(</mo><mrow id="S2.E7.m1.4.4.1.1.1.1.1.1.1" xref="S2.E7.m1.4.4.1.1.1.1.1.1.1.cmml"><msub id="S2.E7.m1.4.4.1.1.1.1.1.1.1.2" xref="S2.E7.m1.4.4.1.1.1.1.1.1.1.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S2.E7.m1.4.4.1.1.1.1.1.1.1.2.2" xref="S2.E7.m1.4.4.1.1.1.1.1.1.1.2.2.cmml">𝒟</mi><mi id="S2.E7.m1.4.4.1.1.1.1.1.1.1.2.3" xref="S2.E7.m1.4.4.1.1.1.1.1.1.1.2.3.cmml">s</mi></msub><mo fence="false" id="S2.E7.m1.4.4.1.1.1.1.1.1.1.1" xref="S2.E7.m1.4.4.1.1.1.1.1.1.1.1.cmml">|</mo><msub id="S2.E7.m1.4.4.1.1.1.1.1.1.1.3" xref="S2.E7.m1.4.4.1.1.1.1.1.1.1.3.cmml"><mi class="ltx_mathvariant_bold-italic" mathvariant="bold-italic" id="S2.E7.m1.4.4.1.1.1.1.1.1.1.3.2" xref="S2.E7.m1.4.4.1.1.1.1.1.1.1.3.2.cmml">ϕ</mi><mi id="S2.E7.m1.4.4.1.1.1.1.1.1.1.3.3" xref="S2.E7.m1.4.4.1.1.1.1.1.1.1.3.3.cmml">s</mi></msub></mrow><mo stretchy="false" id="S2.E7.m1.4.4.1.1.1.1.1.1.3" xref="S2.E7.m1.4.4.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S2.E7.m1.4.4.1.1.2.3" xref="S2.E7.m1.4.4.1.1.2.3.cmml">+</mo><mrow id="S2.E7.m1.4.4.1.1.2.2" xref="S2.E7.m1.4.4.1.1.2.2.cmml"><mrow id="S2.E7.m1.4.4.1.1.2.2.3" xref="S2.E7.m1.4.4.1.1.2.2.3.cmml"><mi id="S2.E7.m1.4.4.1.1.2.2.3.1" xref="S2.E7.m1.4.4.1.1.2.2.3.1.cmml">log</mi><mo lspace="0.167em" id="S2.E7.m1.4.4.1.1.2.2.3a" xref="S2.E7.m1.4.4.1.1.2.2.3.cmml">⁡</mo><mi id="S2.E7.m1.4.4.1.1.2.2.3.2" xref="S2.E7.m1.4.4.1.1.2.2.3.2.cmml">p</mi></mrow><mo lspace="0em" rspace="0em" id="S2.E7.m1.4.4.1.1.2.2.2" xref="S2.E7.m1.4.4.1.1.2.2.2.cmml">​</mo><mrow id="S2.E7.m1.4.4.1.1.2.2.1.1" xref="S2.E7.m1.4.4.1.1.2.2.1.1.1.cmml"><mo stretchy="false" id="S2.E7.m1.4.4.1.1.2.2.1.1.2" xref="S2.E7.m1.4.4.1.1.2.2.1.1.1.cmml">(</mo><mrow id="S2.E7.m1.4.4.1.1.2.2.1.1.1" xref="S2.E7.m1.4.4.1.1.2.2.1.1.1.cmml"><msub id="S2.E7.m1.4.4.1.1.2.2.1.1.1.2" xref="S2.E7.m1.4.4.1.1.2.2.1.1.1.2.cmml"><mi class="ltx_mathvariant_bold-italic" mathvariant="bold-italic" id="S2.E7.m1.4.4.1.1.2.2.1.1.1.2.2" xref="S2.E7.m1.4.4.1.1.2.2.1.1.1.2.2.cmml">ϕ</mi><mi id="S2.E7.m1.4.4.1.1.2.2.1.1.1.2.3" xref="S2.E7.m1.4.4.1.1.2.2.1.1.1.2.3.cmml">s</mi></msub><mo fence="false" id="S2.E7.m1.4.4.1.1.2.2.1.1.1.1" xref="S2.E7.m1.4.4.1.1.2.2.1.1.1.1.cmml">|</mo><mi id="S2.E7.m1.4.4.1.1.2.2.1.1.1.3" xref="S2.E7.m1.4.4.1.1.2.2.1.1.1.3.cmml">𝐰</mi></mrow><mo stretchy="false" id="S2.E7.m1.4.4.1.1.2.2.1.1.3" xref="S2.E7.m1.4.4.1.1.2.2.1.1.1.cmml">)</mo></mrow></mrow></mrow></mrow><mo lspace="0em" id="S2.E7.m1.4.4.1.2" xref="S2.E7.m1.4.4.1.1.cmml">.</mo></mrow><annotation-xml encoding="MathML-Content" id="S2.E7.m1.4b"><apply id="S2.E7.m1.4.4.1.1.cmml" xref="S2.E7.m1.4.4.1"><and id="S2.E7.m1.4.4.1.1a.cmml" xref="S2.E7.m1.4.4.1"></and><apply id="S2.E7.m1.4.4.1.1b.cmml" xref="S2.E7.m1.4.4.1"><eq id="S2.E7.m1.4.4.1.1.5.cmml" xref="S2.E7.m1.4.4.1.1.5"></eq><apply id="S2.E7.m1.4.4.1.1.4.cmml" xref="S2.E7.m1.4.4.1.1.4"><csymbol cd="ambiguous" id="S2.E7.m1.4.4.1.1.4.1.cmml" xref="S2.E7.m1.4.4.1.1.4">subscript</csymbol><apply id="S2.E7.m1.4.4.1.1.4.2.cmml" xref="S2.E7.m1.4.4.1.1.4"><csymbol cd="ambiguous" id="S2.E7.m1.4.4.1.1.4.2.1.cmml" xref="S2.E7.m1.4.4.1.1.4">superscript</csymbol><ci id="S2.E7.m1.4.4.1.1.4.2.2.cmml" xref="S2.E7.m1.4.4.1.1.4.2.2">bold-italic-ϕ</ci><times id="S2.E7.m1.4.4.1.1.4.2.3.cmml" xref="S2.E7.m1.4.4.1.1.4.2.3"></times></apply><ci id="S2.E7.m1.4.4.1.1.4.3.cmml" xref="S2.E7.m1.4.4.1.1.4.3">𝑠</ci></apply><apply id="S2.E7.m1.4.4.1.1.6.cmml" xref="S2.E7.m1.4.4.1.1.6"><apply id="S2.E7.m1.4.4.1.1.6.1.cmml" xref="S2.E7.m1.4.4.1.1.6.1"><csymbol cd="ambiguous" id="S2.E7.m1.4.4.1.1.6.1.1.cmml" xref="S2.E7.m1.4.4.1.1.6.1">subscript</csymbol><apply id="S2.E7.m1.4.4.1.1.6.1.2.cmml" xref="S2.E7.m1.4.4.1.1.6.1.2"><times id="S2.E7.m1.4.4.1.1.6.1.2.1.cmml" xref="S2.E7.m1.4.4.1.1.6.1.2.1"></times><ci id="S2.E7.m1.4.4.1.1.6.1.2.2.cmml" xref="S2.E7.m1.4.4.1.1.6.1.2.2">arg</ci><ci id="S2.E7.m1.4.4.1.1.6.1.2.3.cmml" xref="S2.E7.m1.4.4.1.1.6.1.2.3">max</ci></apply><apply id="S2.E7.m1.4.4.1.1.6.1.3.cmml" xref="S2.E7.m1.4.4.1.1.6.1.3"><csymbol cd="ambiguous" id="S2.E7.m1.4.4.1.1.6.1.3.1.cmml" xref="S2.E7.m1.4.4.1.1.6.1.3">subscript</csymbol><ci id="S2.E7.m1.4.4.1.1.6.1.3.2.cmml" xref="S2.E7.m1.4.4.1.1.6.1.3.2">bold-italic-ϕ</ci><ci id="S2.E7.m1.4.4.1.1.6.1.3.3.cmml" xref="S2.E7.m1.4.4.1.1.6.1.3.3">𝑠</ci></apply></apply><apply id="S2.E7.m1.3.3.cmml" xref="S2.E7.m1.3.3"><divide id="S2.E7.m1.3.3.4.cmml" xref="S2.E7.m1.3.3"></divide><apply id="S2.E7.m1.2.2.2.cmml" xref="S2.E7.m1.2.2.2"><times id="S2.E7.m1.2.2.2.3.cmml" xref="S2.E7.m1.2.2.2.3"></times><ci id="S2.E7.m1.2.2.2.4.cmml" xref="S2.E7.m1.2.2.2.4">𝑝</ci><apply id="S2.E7.m1.1.1.1.1.1.1.cmml" xref="S2.E7.m1.1.1.1.1.1"><csymbol cd="latexml" id="S2.E7.m1.1.1.1.1.1.1.1.cmml" xref="S2.E7.m1.1.1.1.1.1.1.1">conditional</csymbol><apply id="S2.E7.m1.1.1.1.1.1.1.2.cmml" xref="S2.E7.m1.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S2.E7.m1.1.1.1.1.1.1.2.1.cmml" xref="S2.E7.m1.1.1.1.1.1.1.2">subscript</csymbol><ci id="S2.E7.m1.1.1.1.1.1.1.2.2.cmml" xref="S2.E7.m1.1.1.1.1.1.1.2.2">𝒟</ci><ci id="S2.E7.m1.1.1.1.1.1.1.2.3.cmml" xref="S2.E7.m1.1.1.1.1.1.1.2.3">𝑠</ci></apply><apply id="S2.E7.m1.1.1.1.1.1.1.3.cmml" xref="S2.E7.m1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S2.E7.m1.1.1.1.1.1.1.3.1.cmml" xref="S2.E7.m1.1.1.1.1.1.1.3">subscript</csymbol><ci id="S2.E7.m1.1.1.1.1.1.1.3.2.cmml" xref="S2.E7.m1.1.1.1.1.1.1.3.2">bold-italic-ϕ</ci><ci id="S2.E7.m1.1.1.1.1.1.1.3.3.cmml" xref="S2.E7.m1.1.1.1.1.1.1.3.3">𝑠</ci></apply></apply><ci id="S2.E7.m1.2.2.2.5.cmml" xref="S2.E7.m1.2.2.2.5">𝑝</ci><apply id="S2.E7.m1.2.2.2.2.1.1.cmml" xref="S2.E7.m1.2.2.2.2.1"><csymbol cd="latexml" id="S2.E7.m1.2.2.2.2.1.1.1.cmml" xref="S2.E7.m1.2.2.2.2.1.1.1">conditional</csymbol><apply id="S2.E7.m1.2.2.2.2.1.1.2.cmml" xref="S2.E7.m1.2.2.2.2.1.1.2"><csymbol cd="ambiguous" id="S2.E7.m1.2.2.2.2.1.1.2.1.cmml" xref="S2.E7.m1.2.2.2.2.1.1.2">subscript</csymbol><ci id="S2.E7.m1.2.2.2.2.1.1.2.2.cmml" xref="S2.E7.m1.2.2.2.2.1.1.2.2">bold-italic-ϕ</ci><ci id="S2.E7.m1.2.2.2.2.1.1.2.3.cmml" xref="S2.E7.m1.2.2.2.2.1.1.2.3">𝑠</ci></apply><ci id="S2.E7.m1.2.2.2.2.1.1.3.cmml" xref="S2.E7.m1.2.2.2.2.1.1.3">𝐰</ci></apply></apply><apply id="S2.E7.m1.3.3.3.cmml" xref="S2.E7.m1.3.3.3"><times id="S2.E7.m1.3.3.3.2.cmml" xref="S2.E7.m1.3.3.3.2"></times><ci id="S2.E7.m1.3.3.3.3.cmml" xref="S2.E7.m1.3.3.3.3">𝑝</ci><apply id="S2.E7.m1.3.3.3.1.1.1.cmml" xref="S2.E7.m1.3.3.3.1.1"><csymbol cd="latexml" id="S2.E7.m1.3.3.3.1.1.1.1.cmml" xref="S2.E7.m1.3.3.3.1.1.1.1">conditional</csymbol><apply id="S2.E7.m1.3.3.3.1.1.1.2.cmml" xref="S2.E7.m1.3.3.3.1.1.1.2"><csymbol cd="ambiguous" id="S2.E7.m1.3.3.3.1.1.1.2.1.cmml" xref="S2.E7.m1.3.3.3.1.1.1.2">subscript</csymbol><ci id="S2.E7.m1.3.3.3.1.1.1.2.2.cmml" xref="S2.E7.m1.3.3.3.1.1.1.2.2">𝒟</ci><ci id="S2.E7.m1.3.3.3.1.1.1.2.3.cmml" xref="S2.E7.m1.3.3.3.1.1.1.2.3">𝑠</ci></apply><ci id="S2.E7.m1.3.3.3.1.1.1.3.cmml" xref="S2.E7.m1.3.3.3.1.1.1.3">𝐰</ci></apply></apply></apply></apply></apply><apply id="S2.E7.m1.4.4.1.1c.cmml" xref="S2.E7.m1.4.4.1"><eq id="S2.E7.m1.4.4.1.1.7.cmml" xref="S2.E7.m1.4.4.1.1.7"></eq><share href="#S2.E7.m1.4.4.1.1.6.cmml" id="S2.E7.m1.4.4.1.1d.cmml" xref="S2.E7.m1.4.4.1"></share><apply id="S2.E7.m1.4.4.1.1.2.cmml" xref="S2.E7.m1.4.4.1.1.2"><plus id="S2.E7.m1.4.4.1.1.2.3.cmml" xref="S2.E7.m1.4.4.1.1.2.3"></plus><apply id="S2.E7.m1.4.4.1.1.1.1.cmml" xref="S2.E7.m1.4.4.1.1.1.1"><times id="S2.E7.m1.4.4.1.1.1.1.2.cmml" xref="S2.E7.m1.4.4.1.1.1.1.2"></times><apply id="S2.E7.m1.4.4.1.1.1.1.3.cmml" xref="S2.E7.m1.4.4.1.1.1.1.3"><apply id="S2.E7.m1.4.4.1.1.1.1.3.1.cmml" xref="S2.E7.m1.4.4.1.1.1.1.3.1"><apply id="S2.E7.m1.4.4.1.1.1.1.3.1.1.cmml" xref="S2.E7.m1.4.4.1.1.1.1.3.1.1"><csymbol cd="ambiguous" id="S2.E7.m1.4.4.1.1.1.1.3.1.1.1.cmml" xref="S2.E7.m1.4.4.1.1.1.1.3.1.1">subscript</csymbol><apply id="S2.E7.m1.4.4.1.1.1.1.3.1.1.2.cmml" xref="S2.E7.m1.4.4.1.1.1.1.3.1.1.2"><times id="S2.E7.m1.4.4.1.1.1.1.3.1.1.2.1.cmml" xref="S2.E7.m1.4.4.1.1.1.1.3.1.1.2.1"></times><ci id="S2.E7.m1.4.4.1.1.1.1.3.1.1.2.2.cmml" xref="S2.E7.m1.4.4.1.1.1.1.3.1.1.2.2">arg</ci><ci id="S2.E7.m1.4.4.1.1.1.1.3.1.1.2.3.cmml" xref="S2.E7.m1.4.4.1.1.1.1.3.1.1.2.3">max</ci></apply><apply id="S2.E7.m1.4.4.1.1.1.1.3.1.1.3.cmml" xref="S2.E7.m1.4.4.1.1.1.1.3.1.1.3"><csymbol cd="ambiguous" id="S2.E7.m1.4.4.1.1.1.1.3.1.1.3.1.cmml" xref="S2.E7.m1.4.4.1.1.1.1.3.1.1.3">subscript</csymbol><ci id="S2.E7.m1.4.4.1.1.1.1.3.1.1.3.2.cmml" xref="S2.E7.m1.4.4.1.1.1.1.3.1.1.3.2">bold-italic-ϕ</ci><ci id="S2.E7.m1.4.4.1.1.1.1.3.1.1.3.3.cmml" xref="S2.E7.m1.4.4.1.1.1.1.3.1.1.3.3">𝑠</ci></apply></apply><log id="S2.E7.m1.4.4.1.1.1.1.3.1.2.cmml" xref="S2.E7.m1.4.4.1.1.1.1.3.1.2"></log></apply><ci id="S2.E7.m1.4.4.1.1.1.1.3.2.cmml" xref="S2.E7.m1.4.4.1.1.1.1.3.2">𝑝</ci></apply><apply id="S2.E7.m1.4.4.1.1.1.1.1.1.1.cmml" xref="S2.E7.m1.4.4.1.1.1.1.1.1"><csymbol cd="latexml" id="S2.E7.m1.4.4.1.1.1.1.1.1.1.1.cmml" xref="S2.E7.m1.4.4.1.1.1.1.1.1.1.1">conditional</csymbol><apply id="S2.E7.m1.4.4.1.1.1.1.1.1.1.2.cmml" xref="S2.E7.m1.4.4.1.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S2.E7.m1.4.4.1.1.1.1.1.1.1.2.1.cmml" xref="S2.E7.m1.4.4.1.1.1.1.1.1.1.2">subscript</csymbol><ci id="S2.E7.m1.4.4.1.1.1.1.1.1.1.2.2.cmml" xref="S2.E7.m1.4.4.1.1.1.1.1.1.1.2.2">𝒟</ci><ci id="S2.E7.m1.4.4.1.1.1.1.1.1.1.2.3.cmml" xref="S2.E7.m1.4.4.1.1.1.1.1.1.1.2.3">𝑠</ci></apply><apply id="S2.E7.m1.4.4.1.1.1.1.1.1.1.3.cmml" xref="S2.E7.m1.4.4.1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S2.E7.m1.4.4.1.1.1.1.1.1.1.3.1.cmml" xref="S2.E7.m1.4.4.1.1.1.1.1.1.1.3">subscript</csymbol><ci id="S2.E7.m1.4.4.1.1.1.1.1.1.1.3.2.cmml" xref="S2.E7.m1.4.4.1.1.1.1.1.1.1.3.2">bold-italic-ϕ</ci><ci id="S2.E7.m1.4.4.1.1.1.1.1.1.1.3.3.cmml" xref="S2.E7.m1.4.4.1.1.1.1.1.1.1.3.3">𝑠</ci></apply></apply></apply><apply id="S2.E7.m1.4.4.1.1.2.2.cmml" xref="S2.E7.m1.4.4.1.1.2.2"><times id="S2.E7.m1.4.4.1.1.2.2.2.cmml" xref="S2.E7.m1.4.4.1.1.2.2.2"></times><apply id="S2.E7.m1.4.4.1.1.2.2.3.cmml" xref="S2.E7.m1.4.4.1.1.2.2.3"><log id="S2.E7.m1.4.4.1.1.2.2.3.1.cmml" xref="S2.E7.m1.4.4.1.1.2.2.3.1"></log><ci id="S2.E7.m1.4.4.1.1.2.2.3.2.cmml" xref="S2.E7.m1.4.4.1.1.2.2.3.2">𝑝</ci></apply><apply id="S2.E7.m1.4.4.1.1.2.2.1.1.1.cmml" xref="S2.E7.m1.4.4.1.1.2.2.1.1"><csymbol cd="latexml" id="S2.E7.m1.4.4.1.1.2.2.1.1.1.1.cmml" xref="S2.E7.m1.4.4.1.1.2.2.1.1.1.1">conditional</csymbol><apply id="S2.E7.m1.4.4.1.1.2.2.1.1.1.2.cmml" xref="S2.E7.m1.4.4.1.1.2.2.1.1.1.2"><csymbol cd="ambiguous" id="S2.E7.m1.4.4.1.1.2.2.1.1.1.2.1.cmml" xref="S2.E7.m1.4.4.1.1.2.2.1.1.1.2">subscript</csymbol><ci id="S2.E7.m1.4.4.1.1.2.2.1.1.1.2.2.cmml" xref="S2.E7.m1.4.4.1.1.2.2.1.1.1.2.2">bold-italic-ϕ</ci><ci id="S2.E7.m1.4.4.1.1.2.2.1.1.1.2.3.cmml" xref="S2.E7.m1.4.4.1.1.2.2.1.1.1.2.3">𝑠</ci></apply><ci id="S2.E7.m1.4.4.1.1.2.2.1.1.1.3.cmml" xref="S2.E7.m1.4.4.1.1.2.2.1.1.1.3">𝐰</ci></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.E7.m1.4c">\displaystyle\bm{\phi}^{*}_{s}=\operatorname*{arg\,max}_{\bm{\phi}_{s}}\frac{p(\mathcal{D}_{s}|\bm{\phi}_{s})p(\bm{\phi}_{s}|\mathbf{w})}{p(\mathcal{D}_{s}|\mathbf{w})}=\operatorname*{arg\,max}_{\bm{\phi}_{s}}\log p(\mathcal{D}_{s}|\bm{\phi}_{s})+\log p(\bm{\phi}_{s}|\mathbf{w}).</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(7)</span></td>
</tr></tbody>
</table>
<p id="S2.SS1.p3.5" class="ltx_p">This is usually easier to do as we can use techniques such as stochastic gradient ascent. Given these hard assignments, the M-step then corresponds to another simple maximization</p>
<table id="A10.EGx8" class="ltx_equationgroup ltx_eqn_align ltx_eqn_table">

<tbody id="S2.E8"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math id="S2.E8.m1.1" class="ltx_Math" alttext="\displaystyle\operatorname*{arg\,max}_{\mathbf{w}}\frac{1}{S}\sum_{s}\log p(\bm{\phi}^{*}_{s}|\mathbf{w})." display="inline"><semantics id="S2.E8.m1.1a"><mrow id="S2.E8.m1.1.1.1" xref="S2.E8.m1.1.1.1.1.cmml"><mrow id="S2.E8.m1.1.1.1.1" xref="S2.E8.m1.1.1.1.1.cmml"><mrow id="S2.E8.m1.1.1.1.1.3" xref="S2.E8.m1.1.1.1.1.3.cmml"><munder id="S2.E8.m1.1.1.1.1.3.1" xref="S2.E8.m1.1.1.1.1.3.1.cmml"><mrow id="S2.E8.m1.1.1.1.1.3.1.2" xref="S2.E8.m1.1.1.1.1.3.1.2.cmml"><mi id="S2.E8.m1.1.1.1.1.3.1.2.2" xref="S2.E8.m1.1.1.1.1.3.1.2.2.cmml">arg</mi><mo lspace="0.170em" rspace="0em" id="S2.E8.m1.1.1.1.1.3.1.2.1" xref="S2.E8.m1.1.1.1.1.3.1.2.1.cmml">​</mo><mi id="S2.E8.m1.1.1.1.1.3.1.2.3" xref="S2.E8.m1.1.1.1.1.3.1.2.3.cmml">max</mi></mrow><mi id="S2.E8.m1.1.1.1.1.3.1.3" xref="S2.E8.m1.1.1.1.1.3.1.3.cmml">𝐰</mi></munder><mo lspace="0.167em" id="S2.E8.m1.1.1.1.1.3a" xref="S2.E8.m1.1.1.1.1.3.cmml">⁡</mo><mstyle displaystyle="true" id="S2.E8.m1.1.1.1.1.3.2" xref="S2.E8.m1.1.1.1.1.3.2.cmml"><mfrac id="S2.E8.m1.1.1.1.1.3.2a" xref="S2.E8.m1.1.1.1.1.3.2.cmml"><mn id="S2.E8.m1.1.1.1.1.3.2.2" xref="S2.E8.m1.1.1.1.1.3.2.2.cmml">1</mn><mi id="S2.E8.m1.1.1.1.1.3.2.3" xref="S2.E8.m1.1.1.1.1.3.2.3.cmml">S</mi></mfrac></mstyle></mrow><mo lspace="0em" rspace="0em" id="S2.E8.m1.1.1.1.1.2" xref="S2.E8.m1.1.1.1.1.2.cmml">​</mo><mrow id="S2.E8.m1.1.1.1.1.1" xref="S2.E8.m1.1.1.1.1.1.cmml"><mstyle displaystyle="true" id="S2.E8.m1.1.1.1.1.1.2" xref="S2.E8.m1.1.1.1.1.1.2.cmml"><munder id="S2.E8.m1.1.1.1.1.1.2a" xref="S2.E8.m1.1.1.1.1.1.2.cmml"><mo movablelimits="false" id="S2.E8.m1.1.1.1.1.1.2.2" xref="S2.E8.m1.1.1.1.1.1.2.2.cmml">∑</mo><mi id="S2.E8.m1.1.1.1.1.1.2.3" xref="S2.E8.m1.1.1.1.1.1.2.3.cmml">s</mi></munder></mstyle><mrow id="S2.E8.m1.1.1.1.1.1.1" xref="S2.E8.m1.1.1.1.1.1.1.cmml"><mrow id="S2.E8.m1.1.1.1.1.1.1.3" xref="S2.E8.m1.1.1.1.1.1.1.3.cmml"><mi id="S2.E8.m1.1.1.1.1.1.1.3.1" xref="S2.E8.m1.1.1.1.1.1.1.3.1.cmml">log</mi><mo lspace="0.167em" id="S2.E8.m1.1.1.1.1.1.1.3a" xref="S2.E8.m1.1.1.1.1.1.1.3.cmml">⁡</mo><mi id="S2.E8.m1.1.1.1.1.1.1.3.2" xref="S2.E8.m1.1.1.1.1.1.1.3.2.cmml">p</mi></mrow><mo lspace="0em" rspace="0em" id="S2.E8.m1.1.1.1.1.1.1.2" xref="S2.E8.m1.1.1.1.1.1.1.2.cmml">​</mo><mrow id="S2.E8.m1.1.1.1.1.1.1.1.1" xref="S2.E8.m1.1.1.1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S2.E8.m1.1.1.1.1.1.1.1.1.2" xref="S2.E8.m1.1.1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="S2.E8.m1.1.1.1.1.1.1.1.1.1" xref="S2.E8.m1.1.1.1.1.1.1.1.1.1.cmml"><msubsup id="S2.E8.m1.1.1.1.1.1.1.1.1.1.2" xref="S2.E8.m1.1.1.1.1.1.1.1.1.1.2.cmml"><mi class="ltx_mathvariant_bold-italic" mathvariant="bold-italic" id="S2.E8.m1.1.1.1.1.1.1.1.1.1.2.2.2" xref="S2.E8.m1.1.1.1.1.1.1.1.1.1.2.2.2.cmml">ϕ</mi><mi id="S2.E8.m1.1.1.1.1.1.1.1.1.1.2.3" xref="S2.E8.m1.1.1.1.1.1.1.1.1.1.2.3.cmml">s</mi><mo id="S2.E8.m1.1.1.1.1.1.1.1.1.1.2.2.3" xref="S2.E8.m1.1.1.1.1.1.1.1.1.1.2.2.3.cmml">∗</mo></msubsup><mo fence="false" id="S2.E8.m1.1.1.1.1.1.1.1.1.1.1" xref="S2.E8.m1.1.1.1.1.1.1.1.1.1.1.cmml">|</mo><mi id="S2.E8.m1.1.1.1.1.1.1.1.1.1.3" xref="S2.E8.m1.1.1.1.1.1.1.1.1.1.3.cmml">𝐰</mi></mrow><mo stretchy="false" id="S2.E8.m1.1.1.1.1.1.1.1.1.3" xref="S2.E8.m1.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow></mrow><mo lspace="0em" id="S2.E8.m1.1.1.1.2" xref="S2.E8.m1.1.1.1.1.cmml">.</mo></mrow><annotation-xml encoding="MathML-Content" id="S2.E8.m1.1b"><apply id="S2.E8.m1.1.1.1.1.cmml" xref="S2.E8.m1.1.1.1"><times id="S2.E8.m1.1.1.1.1.2.cmml" xref="S2.E8.m1.1.1.1.1.2"></times><apply id="S2.E8.m1.1.1.1.1.3.cmml" xref="S2.E8.m1.1.1.1.1.3"><apply id="S2.E8.m1.1.1.1.1.3.1.cmml" xref="S2.E8.m1.1.1.1.1.3.1"><csymbol cd="ambiguous" id="S2.E8.m1.1.1.1.1.3.1.1.cmml" xref="S2.E8.m1.1.1.1.1.3.1">subscript</csymbol><apply id="S2.E8.m1.1.1.1.1.3.1.2.cmml" xref="S2.E8.m1.1.1.1.1.3.1.2"><times id="S2.E8.m1.1.1.1.1.3.1.2.1.cmml" xref="S2.E8.m1.1.1.1.1.3.1.2.1"></times><ci id="S2.E8.m1.1.1.1.1.3.1.2.2.cmml" xref="S2.E8.m1.1.1.1.1.3.1.2.2">arg</ci><ci id="S2.E8.m1.1.1.1.1.3.1.2.3.cmml" xref="S2.E8.m1.1.1.1.1.3.1.2.3">max</ci></apply><ci id="S2.E8.m1.1.1.1.1.3.1.3.cmml" xref="S2.E8.m1.1.1.1.1.3.1.3">𝐰</ci></apply><apply id="S2.E8.m1.1.1.1.1.3.2.cmml" xref="S2.E8.m1.1.1.1.1.3.2"><divide id="S2.E8.m1.1.1.1.1.3.2.1.cmml" xref="S2.E8.m1.1.1.1.1.3.2"></divide><cn type="integer" id="S2.E8.m1.1.1.1.1.3.2.2.cmml" xref="S2.E8.m1.1.1.1.1.3.2.2">1</cn><ci id="S2.E8.m1.1.1.1.1.3.2.3.cmml" xref="S2.E8.m1.1.1.1.1.3.2.3">𝑆</ci></apply></apply><apply id="S2.E8.m1.1.1.1.1.1.cmml" xref="S2.E8.m1.1.1.1.1.1"><apply id="S2.E8.m1.1.1.1.1.1.2.cmml" xref="S2.E8.m1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S2.E8.m1.1.1.1.1.1.2.1.cmml" xref="S2.E8.m1.1.1.1.1.1.2">subscript</csymbol><sum id="S2.E8.m1.1.1.1.1.1.2.2.cmml" xref="S2.E8.m1.1.1.1.1.1.2.2"></sum><ci id="S2.E8.m1.1.1.1.1.1.2.3.cmml" xref="S2.E8.m1.1.1.1.1.1.2.3">𝑠</ci></apply><apply id="S2.E8.m1.1.1.1.1.1.1.cmml" xref="S2.E8.m1.1.1.1.1.1.1"><times id="S2.E8.m1.1.1.1.1.1.1.2.cmml" xref="S2.E8.m1.1.1.1.1.1.1.2"></times><apply id="S2.E8.m1.1.1.1.1.1.1.3.cmml" xref="S2.E8.m1.1.1.1.1.1.1.3"><log id="S2.E8.m1.1.1.1.1.1.1.3.1.cmml" xref="S2.E8.m1.1.1.1.1.1.1.3.1"></log><ci id="S2.E8.m1.1.1.1.1.1.1.3.2.cmml" xref="S2.E8.m1.1.1.1.1.1.1.3.2">𝑝</ci></apply><apply id="S2.E8.m1.1.1.1.1.1.1.1.1.1.cmml" xref="S2.E8.m1.1.1.1.1.1.1.1.1"><csymbol cd="latexml" id="S2.E8.m1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S2.E8.m1.1.1.1.1.1.1.1.1.1.1">conditional</csymbol><apply id="S2.E8.m1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S2.E8.m1.1.1.1.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S2.E8.m1.1.1.1.1.1.1.1.1.1.2.1.cmml" xref="S2.E8.m1.1.1.1.1.1.1.1.1.1.2">subscript</csymbol><apply id="S2.E8.m1.1.1.1.1.1.1.1.1.1.2.2.cmml" xref="S2.E8.m1.1.1.1.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S2.E8.m1.1.1.1.1.1.1.1.1.1.2.2.1.cmml" xref="S2.E8.m1.1.1.1.1.1.1.1.1.1.2">superscript</csymbol><ci id="S2.E8.m1.1.1.1.1.1.1.1.1.1.2.2.2.cmml" xref="S2.E8.m1.1.1.1.1.1.1.1.1.1.2.2.2">bold-italic-ϕ</ci><times id="S2.E8.m1.1.1.1.1.1.1.1.1.1.2.2.3.cmml" xref="S2.E8.m1.1.1.1.1.1.1.1.1.1.2.2.3"></times></apply><ci id="S2.E8.m1.1.1.1.1.1.1.1.1.1.2.3.cmml" xref="S2.E8.m1.1.1.1.1.1.1.1.1.1.2.3">𝑠</ci></apply><ci id="S2.E8.m1.1.1.1.1.1.1.1.1.1.3.cmml" xref="S2.E8.m1.1.1.1.1.1.1.1.1.1.3">𝐰</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.E8.m1.1c">\displaystyle\operatorname*{arg\,max}_{\mathbf{w}}\frac{1}{S}\sum_{s}\log p(\bm{\phi}^{*}_{s}|\mathbf{w}).</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(8)</span></td>
</tr></tbody>
</table>
<p id="S2.SS1.p3.6" class="ltx_p">As a result, performing hard-EM on the objective of Eq. <a href="#S2.E4" title="In 2.1 FedAvg as learning in a hierarchical model ‣ 2 A hierarchical model interpretation of federated learning ‣ An Expectation-Maximization Perspective on Federated Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">4</span></a> corresponds to a block coordinate ascent type of algorithm on the following objective function</p>
<table id="A10.EGx9" class="ltx_equationgroup ltx_eqn_align ltx_eqn_table">

<tbody id="S2.E9"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math id="S2.E9.m1.3" class="ltx_Math" alttext="\displaystyle\operatorname*{arg\,max}_{\bm{\phi}_{1:S},\mathbf{w}}\sum_{s}(\log p(\mathcal{D}_{s}|\bm{\phi}_{s})+\log p(\bm{\phi}_{s}|\mathbf{w}))," display="inline"><semantics id="S2.E9.m1.3a"><mrow id="S2.E9.m1.3.3.1" xref="S2.E9.m1.3.3.1.1.cmml"><mrow id="S2.E9.m1.3.3.1.1" xref="S2.E9.m1.3.3.1.1.cmml"><munder id="S2.E9.m1.3.3.1.1.3" xref="S2.E9.m1.3.3.1.1.3.cmml"><mrow id="S2.E9.m1.3.3.1.1.3.2" xref="S2.E9.m1.3.3.1.1.3.2.cmml"><mi id="S2.E9.m1.3.3.1.1.3.2.2" xref="S2.E9.m1.3.3.1.1.3.2.2.cmml">arg</mi><mo lspace="0.170em" rspace="0em" id="S2.E9.m1.3.3.1.1.3.2.1" xref="S2.E9.m1.3.3.1.1.3.2.1.cmml">​</mo><mi id="S2.E9.m1.3.3.1.1.3.2.3" xref="S2.E9.m1.3.3.1.1.3.2.3.cmml">max</mi></mrow><mrow id="S2.E9.m1.2.2.2.2" xref="S2.E9.m1.2.2.2.3.cmml"><msub id="S2.E9.m1.2.2.2.2.1" xref="S2.E9.m1.2.2.2.2.1.cmml"><mi class="ltx_mathvariant_bold-italic" mathvariant="bold-italic" id="S2.E9.m1.2.2.2.2.1.2" xref="S2.E9.m1.2.2.2.2.1.2.cmml">ϕ</mi><mrow id="S2.E9.m1.2.2.2.2.1.3" xref="S2.E9.m1.2.2.2.2.1.3.cmml"><mn id="S2.E9.m1.2.2.2.2.1.3.2" xref="S2.E9.m1.2.2.2.2.1.3.2.cmml">1</mn><mo lspace="0.278em" rspace="0.278em" id="S2.E9.m1.2.2.2.2.1.3.1" xref="S2.E9.m1.2.2.2.2.1.3.1.cmml">:</mo><mi id="S2.E9.m1.2.2.2.2.1.3.3" xref="S2.E9.m1.2.2.2.2.1.3.3.cmml">S</mi></mrow></msub><mo id="S2.E9.m1.2.2.2.2.2" xref="S2.E9.m1.2.2.2.3.cmml">,</mo><mi id="S2.E9.m1.1.1.1.1" xref="S2.E9.m1.1.1.1.1.cmml">𝐰</mi></mrow></munder><mo lspace="0.167em" rspace="0em" id="S2.E9.m1.3.3.1.1.2" xref="S2.E9.m1.3.3.1.1.2.cmml">​</mo><mrow id="S2.E9.m1.3.3.1.1.1" xref="S2.E9.m1.3.3.1.1.1.cmml"><mstyle displaystyle="true" id="S2.E9.m1.3.3.1.1.1.2" xref="S2.E9.m1.3.3.1.1.1.2.cmml"><munder id="S2.E9.m1.3.3.1.1.1.2a" xref="S2.E9.m1.3.3.1.1.1.2.cmml"><mo movablelimits="false" id="S2.E9.m1.3.3.1.1.1.2.2" xref="S2.E9.m1.3.3.1.1.1.2.2.cmml">∑</mo><mi id="S2.E9.m1.3.3.1.1.1.2.3" xref="S2.E9.m1.3.3.1.1.1.2.3.cmml">s</mi></munder></mstyle><mrow id="S2.E9.m1.3.3.1.1.1.1.1" xref="S2.E9.m1.3.3.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S2.E9.m1.3.3.1.1.1.1.1.2" xref="S2.E9.m1.3.3.1.1.1.1.1.1.cmml">(</mo><mrow id="S2.E9.m1.3.3.1.1.1.1.1.1" xref="S2.E9.m1.3.3.1.1.1.1.1.1.cmml"><mrow id="S2.E9.m1.3.3.1.1.1.1.1.1.1" xref="S2.E9.m1.3.3.1.1.1.1.1.1.1.cmml"><mrow id="S2.E9.m1.3.3.1.1.1.1.1.1.1.3" xref="S2.E9.m1.3.3.1.1.1.1.1.1.1.3.cmml"><mi id="S2.E9.m1.3.3.1.1.1.1.1.1.1.3.1" xref="S2.E9.m1.3.3.1.1.1.1.1.1.1.3.1.cmml">log</mi><mo lspace="0.167em" id="S2.E9.m1.3.3.1.1.1.1.1.1.1.3a" xref="S2.E9.m1.3.3.1.1.1.1.1.1.1.3.cmml">⁡</mo><mi id="S2.E9.m1.3.3.1.1.1.1.1.1.1.3.2" xref="S2.E9.m1.3.3.1.1.1.1.1.1.1.3.2.cmml">p</mi></mrow><mo lspace="0em" rspace="0em" id="S2.E9.m1.3.3.1.1.1.1.1.1.1.2" xref="S2.E9.m1.3.3.1.1.1.1.1.1.1.2.cmml">​</mo><mrow id="S2.E9.m1.3.3.1.1.1.1.1.1.1.1.1" xref="S2.E9.m1.3.3.1.1.1.1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S2.E9.m1.3.3.1.1.1.1.1.1.1.1.1.2" xref="S2.E9.m1.3.3.1.1.1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="S2.E9.m1.3.3.1.1.1.1.1.1.1.1.1.1" xref="S2.E9.m1.3.3.1.1.1.1.1.1.1.1.1.1.cmml"><msub id="S2.E9.m1.3.3.1.1.1.1.1.1.1.1.1.1.2" xref="S2.E9.m1.3.3.1.1.1.1.1.1.1.1.1.1.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S2.E9.m1.3.3.1.1.1.1.1.1.1.1.1.1.2.2" xref="S2.E9.m1.3.3.1.1.1.1.1.1.1.1.1.1.2.2.cmml">𝒟</mi><mi id="S2.E9.m1.3.3.1.1.1.1.1.1.1.1.1.1.2.3" xref="S2.E9.m1.3.3.1.1.1.1.1.1.1.1.1.1.2.3.cmml">s</mi></msub><mo fence="false" id="S2.E9.m1.3.3.1.1.1.1.1.1.1.1.1.1.1" xref="S2.E9.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.cmml">|</mo><msub id="S2.E9.m1.3.3.1.1.1.1.1.1.1.1.1.1.3" xref="S2.E9.m1.3.3.1.1.1.1.1.1.1.1.1.1.3.cmml"><mi class="ltx_mathvariant_bold-italic" mathvariant="bold-italic" id="S2.E9.m1.3.3.1.1.1.1.1.1.1.1.1.1.3.2" xref="S2.E9.m1.3.3.1.1.1.1.1.1.1.1.1.1.3.2.cmml">ϕ</mi><mi id="S2.E9.m1.3.3.1.1.1.1.1.1.1.1.1.1.3.3" xref="S2.E9.m1.3.3.1.1.1.1.1.1.1.1.1.1.3.3.cmml">s</mi></msub></mrow><mo stretchy="false" id="S2.E9.m1.3.3.1.1.1.1.1.1.1.1.1.3" xref="S2.E9.m1.3.3.1.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S2.E9.m1.3.3.1.1.1.1.1.1.3" xref="S2.E9.m1.3.3.1.1.1.1.1.1.3.cmml">+</mo><mrow id="S2.E9.m1.3.3.1.1.1.1.1.1.2" xref="S2.E9.m1.3.3.1.1.1.1.1.1.2.cmml"><mrow id="S2.E9.m1.3.3.1.1.1.1.1.1.2.3" xref="S2.E9.m1.3.3.1.1.1.1.1.1.2.3.cmml"><mi id="S2.E9.m1.3.3.1.1.1.1.1.1.2.3.1" xref="S2.E9.m1.3.3.1.1.1.1.1.1.2.3.1.cmml">log</mi><mo lspace="0.167em" id="S2.E9.m1.3.3.1.1.1.1.1.1.2.3a" xref="S2.E9.m1.3.3.1.1.1.1.1.1.2.3.cmml">⁡</mo><mi id="S2.E9.m1.3.3.1.1.1.1.1.1.2.3.2" xref="S2.E9.m1.3.3.1.1.1.1.1.1.2.3.2.cmml">p</mi></mrow><mo lspace="0em" rspace="0em" id="S2.E9.m1.3.3.1.1.1.1.1.1.2.2" xref="S2.E9.m1.3.3.1.1.1.1.1.1.2.2.cmml">​</mo><mrow id="S2.E9.m1.3.3.1.1.1.1.1.1.2.1.1" xref="S2.E9.m1.3.3.1.1.1.1.1.1.2.1.1.1.cmml"><mo stretchy="false" id="S2.E9.m1.3.3.1.1.1.1.1.1.2.1.1.2" xref="S2.E9.m1.3.3.1.1.1.1.1.1.2.1.1.1.cmml">(</mo><mrow id="S2.E9.m1.3.3.1.1.1.1.1.1.2.1.1.1" xref="S2.E9.m1.3.3.1.1.1.1.1.1.2.1.1.1.cmml"><msub id="S2.E9.m1.3.3.1.1.1.1.1.1.2.1.1.1.2" xref="S2.E9.m1.3.3.1.1.1.1.1.1.2.1.1.1.2.cmml"><mi class="ltx_mathvariant_bold-italic" mathvariant="bold-italic" id="S2.E9.m1.3.3.1.1.1.1.1.1.2.1.1.1.2.2" xref="S2.E9.m1.3.3.1.1.1.1.1.1.2.1.1.1.2.2.cmml">ϕ</mi><mi id="S2.E9.m1.3.3.1.1.1.1.1.1.2.1.1.1.2.3" xref="S2.E9.m1.3.3.1.1.1.1.1.1.2.1.1.1.2.3.cmml">s</mi></msub><mo fence="false" id="S2.E9.m1.3.3.1.1.1.1.1.1.2.1.1.1.1" xref="S2.E9.m1.3.3.1.1.1.1.1.1.2.1.1.1.1.cmml">|</mo><mi id="S2.E9.m1.3.3.1.1.1.1.1.1.2.1.1.1.3" xref="S2.E9.m1.3.3.1.1.1.1.1.1.2.1.1.1.3.cmml">𝐰</mi></mrow><mo stretchy="false" id="S2.E9.m1.3.3.1.1.1.1.1.1.2.1.1.3" xref="S2.E9.m1.3.3.1.1.1.1.1.1.2.1.1.1.cmml">)</mo></mrow></mrow></mrow><mo stretchy="false" id="S2.E9.m1.3.3.1.1.1.1.1.3" xref="S2.E9.m1.3.3.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><mo id="S2.E9.m1.3.3.1.2" xref="S2.E9.m1.3.3.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S2.E9.m1.3b"><apply id="S2.E9.m1.3.3.1.1.cmml" xref="S2.E9.m1.3.3.1"><times id="S2.E9.m1.3.3.1.1.2.cmml" xref="S2.E9.m1.3.3.1.1.2"></times><apply id="S2.E9.m1.3.3.1.1.3.cmml" xref="S2.E9.m1.3.3.1.1.3"><csymbol cd="ambiguous" id="S2.E9.m1.3.3.1.1.3.1.cmml" xref="S2.E9.m1.3.3.1.1.3">subscript</csymbol><apply id="S2.E9.m1.3.3.1.1.3.2.cmml" xref="S2.E9.m1.3.3.1.1.3.2"><times id="S2.E9.m1.3.3.1.1.3.2.1.cmml" xref="S2.E9.m1.3.3.1.1.3.2.1"></times><ci id="S2.E9.m1.3.3.1.1.3.2.2.cmml" xref="S2.E9.m1.3.3.1.1.3.2.2">arg</ci><ci id="S2.E9.m1.3.3.1.1.3.2.3.cmml" xref="S2.E9.m1.3.3.1.1.3.2.3">max</ci></apply><list id="S2.E9.m1.2.2.2.3.cmml" xref="S2.E9.m1.2.2.2.2"><apply id="S2.E9.m1.2.2.2.2.1.cmml" xref="S2.E9.m1.2.2.2.2.1"><csymbol cd="ambiguous" id="S2.E9.m1.2.2.2.2.1.1.cmml" xref="S2.E9.m1.2.2.2.2.1">subscript</csymbol><ci id="S2.E9.m1.2.2.2.2.1.2.cmml" xref="S2.E9.m1.2.2.2.2.1.2">bold-italic-ϕ</ci><apply id="S2.E9.m1.2.2.2.2.1.3.cmml" xref="S2.E9.m1.2.2.2.2.1.3"><ci id="S2.E9.m1.2.2.2.2.1.3.1.cmml" xref="S2.E9.m1.2.2.2.2.1.3.1">:</ci><cn type="integer" id="S2.E9.m1.2.2.2.2.1.3.2.cmml" xref="S2.E9.m1.2.2.2.2.1.3.2">1</cn><ci id="S2.E9.m1.2.2.2.2.1.3.3.cmml" xref="S2.E9.m1.2.2.2.2.1.3.3">𝑆</ci></apply></apply><ci id="S2.E9.m1.1.1.1.1.cmml" xref="S2.E9.m1.1.1.1.1">𝐰</ci></list></apply><apply id="S2.E9.m1.3.3.1.1.1.cmml" xref="S2.E9.m1.3.3.1.1.1"><apply id="S2.E9.m1.3.3.1.1.1.2.cmml" xref="S2.E9.m1.3.3.1.1.1.2"><csymbol cd="ambiguous" id="S2.E9.m1.3.3.1.1.1.2.1.cmml" xref="S2.E9.m1.3.3.1.1.1.2">subscript</csymbol><sum id="S2.E9.m1.3.3.1.1.1.2.2.cmml" xref="S2.E9.m1.3.3.1.1.1.2.2"></sum><ci id="S2.E9.m1.3.3.1.1.1.2.3.cmml" xref="S2.E9.m1.3.3.1.1.1.2.3">𝑠</ci></apply><apply id="S2.E9.m1.3.3.1.1.1.1.1.1.cmml" xref="S2.E9.m1.3.3.1.1.1.1.1"><plus id="S2.E9.m1.3.3.1.1.1.1.1.1.3.cmml" xref="S2.E9.m1.3.3.1.1.1.1.1.1.3"></plus><apply id="S2.E9.m1.3.3.1.1.1.1.1.1.1.cmml" xref="S2.E9.m1.3.3.1.1.1.1.1.1.1"><times id="S2.E9.m1.3.3.1.1.1.1.1.1.1.2.cmml" xref="S2.E9.m1.3.3.1.1.1.1.1.1.1.2"></times><apply id="S2.E9.m1.3.3.1.1.1.1.1.1.1.3.cmml" xref="S2.E9.m1.3.3.1.1.1.1.1.1.1.3"><log id="S2.E9.m1.3.3.1.1.1.1.1.1.1.3.1.cmml" xref="S2.E9.m1.3.3.1.1.1.1.1.1.1.3.1"></log><ci id="S2.E9.m1.3.3.1.1.1.1.1.1.1.3.2.cmml" xref="S2.E9.m1.3.3.1.1.1.1.1.1.1.3.2">𝑝</ci></apply><apply id="S2.E9.m1.3.3.1.1.1.1.1.1.1.1.1.1.cmml" xref="S2.E9.m1.3.3.1.1.1.1.1.1.1.1.1"><csymbol cd="latexml" id="S2.E9.m1.3.3.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S2.E9.m1.3.3.1.1.1.1.1.1.1.1.1.1.1">conditional</csymbol><apply id="S2.E9.m1.3.3.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S2.E9.m1.3.3.1.1.1.1.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S2.E9.m1.3.3.1.1.1.1.1.1.1.1.1.1.2.1.cmml" xref="S2.E9.m1.3.3.1.1.1.1.1.1.1.1.1.1.2">subscript</csymbol><ci id="S2.E9.m1.3.3.1.1.1.1.1.1.1.1.1.1.2.2.cmml" xref="S2.E9.m1.3.3.1.1.1.1.1.1.1.1.1.1.2.2">𝒟</ci><ci id="S2.E9.m1.3.3.1.1.1.1.1.1.1.1.1.1.2.3.cmml" xref="S2.E9.m1.3.3.1.1.1.1.1.1.1.1.1.1.2.3">𝑠</ci></apply><apply id="S2.E9.m1.3.3.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="S2.E9.m1.3.3.1.1.1.1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S2.E9.m1.3.3.1.1.1.1.1.1.1.1.1.1.3.1.cmml" xref="S2.E9.m1.3.3.1.1.1.1.1.1.1.1.1.1.3">subscript</csymbol><ci id="S2.E9.m1.3.3.1.1.1.1.1.1.1.1.1.1.3.2.cmml" xref="S2.E9.m1.3.3.1.1.1.1.1.1.1.1.1.1.3.2">bold-italic-ϕ</ci><ci id="S2.E9.m1.3.3.1.1.1.1.1.1.1.1.1.1.3.3.cmml" xref="S2.E9.m1.3.3.1.1.1.1.1.1.1.1.1.1.3.3">𝑠</ci></apply></apply></apply><apply id="S2.E9.m1.3.3.1.1.1.1.1.1.2.cmml" xref="S2.E9.m1.3.3.1.1.1.1.1.1.2"><times id="S2.E9.m1.3.3.1.1.1.1.1.1.2.2.cmml" xref="S2.E9.m1.3.3.1.1.1.1.1.1.2.2"></times><apply id="S2.E9.m1.3.3.1.1.1.1.1.1.2.3.cmml" xref="S2.E9.m1.3.3.1.1.1.1.1.1.2.3"><log id="S2.E9.m1.3.3.1.1.1.1.1.1.2.3.1.cmml" xref="S2.E9.m1.3.3.1.1.1.1.1.1.2.3.1"></log><ci id="S2.E9.m1.3.3.1.1.1.1.1.1.2.3.2.cmml" xref="S2.E9.m1.3.3.1.1.1.1.1.1.2.3.2">𝑝</ci></apply><apply id="S2.E9.m1.3.3.1.1.1.1.1.1.2.1.1.1.cmml" xref="S2.E9.m1.3.3.1.1.1.1.1.1.2.1.1"><csymbol cd="latexml" id="S2.E9.m1.3.3.1.1.1.1.1.1.2.1.1.1.1.cmml" xref="S2.E9.m1.3.3.1.1.1.1.1.1.2.1.1.1.1">conditional</csymbol><apply id="S2.E9.m1.3.3.1.1.1.1.1.1.2.1.1.1.2.cmml" xref="S2.E9.m1.3.3.1.1.1.1.1.1.2.1.1.1.2"><csymbol cd="ambiguous" id="S2.E9.m1.3.3.1.1.1.1.1.1.2.1.1.1.2.1.cmml" xref="S2.E9.m1.3.3.1.1.1.1.1.1.2.1.1.1.2">subscript</csymbol><ci id="S2.E9.m1.3.3.1.1.1.1.1.1.2.1.1.1.2.2.cmml" xref="S2.E9.m1.3.3.1.1.1.1.1.1.2.1.1.1.2.2">bold-italic-ϕ</ci><ci id="S2.E9.m1.3.3.1.1.1.1.1.1.2.1.1.1.2.3.cmml" xref="S2.E9.m1.3.3.1.1.1.1.1.1.2.1.1.1.2.3">𝑠</ci></apply><ci id="S2.E9.m1.3.3.1.1.1.1.1.1.2.1.1.1.3.cmml" xref="S2.E9.m1.3.3.1.1.1.1.1.1.2.1.1.1.3">𝐰</ci></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.E9.m1.3c">\displaystyle\operatorname*{arg\,max}_{\bm{\phi}_{1:S},\mathbf{w}}\sum_{s}(\log p(\mathcal{D}_{s}|\bm{\phi}_{s})+\log p(\bm{\phi}_{s}|\mathbf{w})),</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(9)</span></td>
</tr></tbody>
</table>
<p id="S2.SS1.p3.4" class="ltx_p">where we alternate between optimizing <math id="S2.SS1.p3.3.m1.1" class="ltx_Math" alttext="\bm{\phi}_{1:S}" display="inline"><semantics id="S2.SS1.p3.3.m1.1a"><msub id="S2.SS1.p3.3.m1.1.1" xref="S2.SS1.p3.3.m1.1.1.cmml"><mi class="ltx_mathvariant_bold-italic" mathvariant="bold-italic" id="S2.SS1.p3.3.m1.1.1.2" xref="S2.SS1.p3.3.m1.1.1.2.cmml">ϕ</mi><mrow id="S2.SS1.p3.3.m1.1.1.3" xref="S2.SS1.p3.3.m1.1.1.3.cmml"><mn id="S2.SS1.p3.3.m1.1.1.3.2" xref="S2.SS1.p3.3.m1.1.1.3.2.cmml">1</mn><mo lspace="0.278em" rspace="0.278em" id="S2.SS1.p3.3.m1.1.1.3.1" xref="S2.SS1.p3.3.m1.1.1.3.1.cmml">:</mo><mi id="S2.SS1.p3.3.m1.1.1.3.3" xref="S2.SS1.p3.3.m1.1.1.3.3.cmml">S</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S2.SS1.p3.3.m1.1b"><apply id="S2.SS1.p3.3.m1.1.1.cmml" xref="S2.SS1.p3.3.m1.1.1"><csymbol cd="ambiguous" id="S2.SS1.p3.3.m1.1.1.1.cmml" xref="S2.SS1.p3.3.m1.1.1">subscript</csymbol><ci id="S2.SS1.p3.3.m1.1.1.2.cmml" xref="S2.SS1.p3.3.m1.1.1.2">bold-italic-ϕ</ci><apply id="S2.SS1.p3.3.m1.1.1.3.cmml" xref="S2.SS1.p3.3.m1.1.1.3"><ci id="S2.SS1.p3.3.m1.1.1.3.1.cmml" xref="S2.SS1.p3.3.m1.1.1.3.1">:</ci><cn type="integer" id="S2.SS1.p3.3.m1.1.1.3.2.cmml" xref="S2.SS1.p3.3.m1.1.1.3.2">1</cn><ci id="S2.SS1.p3.3.m1.1.1.3.3.cmml" xref="S2.SS1.p3.3.m1.1.1.3.3">𝑆</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p3.3.m1.1c">\bm{\phi}_{1:S}</annotation></semantics></math> and <math id="S2.SS1.p3.4.m2.1" class="ltx_Math" alttext="\mathbf{w}" display="inline"><semantics id="S2.SS1.p3.4.m2.1a"><mi id="S2.SS1.p3.4.m2.1.1" xref="S2.SS1.p3.4.m2.1.1.cmml">𝐰</mi><annotation-xml encoding="MathML-Content" id="S2.SS1.p3.4.m2.1b"><ci id="S2.SS1.p3.4.m2.1.1.cmml" xref="S2.SS1.p3.4.m2.1.1">𝐰</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p3.4.m2.1c">\mathbf{w}</annotation></semantics></math> while keeping the other fixed.</p>
</div>
<div id="S2.SS1.p4" class="ltx_para">
<p id="S2.SS1.p4.2" class="ltx_p">How does this learning procedure correspond to <span id="S2.SS1.p4.2.1" class="ltx_text ltx_font_typewriter">FedAvg</span>? By letting <math id="S2.SS1.p4.1.m1.1" class="ltx_Math" alttext="\lambda\rightarrow 0" display="inline"><semantics id="S2.SS1.p4.1.m1.1a"><mrow id="S2.SS1.p4.1.m1.1.1" xref="S2.SS1.p4.1.m1.1.1.cmml"><mi id="S2.SS1.p4.1.m1.1.1.2" xref="S2.SS1.p4.1.m1.1.1.2.cmml">λ</mi><mo stretchy="false" id="S2.SS1.p4.1.m1.1.1.1" xref="S2.SS1.p4.1.m1.1.1.1.cmml">→</mo><mn id="S2.SS1.p4.1.m1.1.1.3" xref="S2.SS1.p4.1.m1.1.1.3.cmml">0</mn></mrow><annotation-xml encoding="MathML-Content" id="S2.SS1.p4.1.m1.1b"><apply id="S2.SS1.p4.1.m1.1.1.cmml" xref="S2.SS1.p4.1.m1.1.1"><ci id="S2.SS1.p4.1.m1.1.1.1.cmml" xref="S2.SS1.p4.1.m1.1.1.1">→</ci><ci id="S2.SS1.p4.1.m1.1.1.2.cmml" xref="S2.SS1.p4.1.m1.1.1.2">𝜆</ci><cn type="integer" id="S2.SS1.p4.1.m1.1.1.3.cmml" xref="S2.SS1.p4.1.m1.1.1.3">0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p4.1.m1.1c">\lambda\rightarrow 0</annotation></semantics></math> in Eq. <a href="#S2.E3" title="In 2.1 FedAvg as learning in a hierarchical model ‣ 2 A hierarchical model interpretation of federated learning ‣ An Expectation-Maximization Perspective on Federated Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">3</span></a> it is clear that the hard assignments in the E-step mimic the process of optimizing a local model on the data of each shard. In fact, even by optimizing the model locally with stochastic gradient ascent for a fixed number of iterations with a given learning rate, we implicitly assume a specific prior over the parameters; for linear regression, this prior is a Gaussian centered at the initial value of the parameters <cite class="ltx_cite ltx_citemacro_citep">[<a href="#bib.bib29" title="" class="ltx_ref">29</a>]</cite> whereas for non-linear models it bounds the distance from the initial point.
After obtaining <math id="S2.SS1.p4.2.m2.1" class="ltx_Math" alttext="\bm{\phi}^{*}_{s}" display="inline"><semantics id="S2.SS1.p4.2.m2.1a"><msubsup id="S2.SS1.p4.2.m2.1.1" xref="S2.SS1.p4.2.m2.1.1.cmml"><mi class="ltx_mathvariant_bold-italic" mathvariant="bold-italic" id="S2.SS1.p4.2.m2.1.1.2.2" xref="S2.SS1.p4.2.m2.1.1.2.2.cmml">ϕ</mi><mi id="S2.SS1.p4.2.m2.1.1.3" xref="S2.SS1.p4.2.m2.1.1.3.cmml">s</mi><mo id="S2.SS1.p4.2.m2.1.1.2.3" xref="S2.SS1.p4.2.m2.1.1.2.3.cmml">∗</mo></msubsup><annotation-xml encoding="MathML-Content" id="S2.SS1.p4.2.m2.1b"><apply id="S2.SS1.p4.2.m2.1.1.cmml" xref="S2.SS1.p4.2.m2.1.1"><csymbol cd="ambiguous" id="S2.SS1.p4.2.m2.1.1.1.cmml" xref="S2.SS1.p4.2.m2.1.1">subscript</csymbol><apply id="S2.SS1.p4.2.m2.1.1.2.cmml" xref="S2.SS1.p4.2.m2.1.1"><csymbol cd="ambiguous" id="S2.SS1.p4.2.m2.1.1.2.1.cmml" xref="S2.SS1.p4.2.m2.1.1">superscript</csymbol><ci id="S2.SS1.p4.2.m2.1.1.2.2.cmml" xref="S2.SS1.p4.2.m2.1.1.2.2">bold-italic-ϕ</ci><times id="S2.SS1.p4.2.m2.1.1.2.3.cmml" xref="S2.SS1.p4.2.m2.1.1.2.3"></times></apply><ci id="S2.SS1.p4.2.m2.1.1.3.cmml" xref="S2.SS1.p4.2.m2.1.1.3">𝑠</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p4.2.m2.1c">\bm{\phi}^{*}_{s}</annotation></semantics></math> the M-step then corresponds to</p>
<table id="A10.EGx10" class="ltx_equationgroup ltx_eqn_align ltx_eqn_table">

<tbody id="S2.E10"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math id="S2.E10.m1.1" class="ltx_Math" alttext="\displaystyle\operatorname*{arg\,max}_{\mathbf{w}}\mathcal{L}_{r}:=\sum_{s}-\frac{\lambda}{2}\|\bm{\phi}^{*}_{s}-\mathbf{w}\|^{2}+C," display="inline"><semantics id="S2.E10.m1.1a"><mrow id="S2.E10.m1.1.1.1" xref="S2.E10.m1.1.1.1.1.cmml"><mrow id="S2.E10.m1.1.1.1.1" xref="S2.E10.m1.1.1.1.1.cmml"><mrow id="S2.E10.m1.1.1.1.1.3" xref="S2.E10.m1.1.1.1.1.3.cmml"><munder id="S2.E10.m1.1.1.1.1.3.1" xref="S2.E10.m1.1.1.1.1.3.1.cmml"><mrow id="S2.E10.m1.1.1.1.1.3.1.2" xref="S2.E10.m1.1.1.1.1.3.1.2.cmml"><mi id="S2.E10.m1.1.1.1.1.3.1.2.2" xref="S2.E10.m1.1.1.1.1.3.1.2.2.cmml">arg</mi><mo lspace="0.170em" rspace="0em" id="S2.E10.m1.1.1.1.1.3.1.2.1" xref="S2.E10.m1.1.1.1.1.3.1.2.1.cmml">​</mo><mi id="S2.E10.m1.1.1.1.1.3.1.2.3" xref="S2.E10.m1.1.1.1.1.3.1.2.3.cmml">max</mi></mrow><mi id="S2.E10.m1.1.1.1.1.3.1.3" xref="S2.E10.m1.1.1.1.1.3.1.3.cmml">𝐰</mi></munder><mo lspace="0.167em" id="S2.E10.m1.1.1.1.1.3a" xref="S2.E10.m1.1.1.1.1.3.cmml">⁡</mo><msub id="S2.E10.m1.1.1.1.1.3.2" xref="S2.E10.m1.1.1.1.1.3.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S2.E10.m1.1.1.1.1.3.2.2" xref="S2.E10.m1.1.1.1.1.3.2.2.cmml">ℒ</mi><mi id="S2.E10.m1.1.1.1.1.3.2.3" xref="S2.E10.m1.1.1.1.1.3.2.3.cmml">r</mi></msub></mrow><mo lspace="0.278em" rspace="0.278em" id="S2.E10.m1.1.1.1.1.2" xref="S2.E10.m1.1.1.1.1.2.cmml">:=</mo><mrow id="S2.E10.m1.1.1.1.1.1" xref="S2.E10.m1.1.1.1.1.1.cmml"><mrow id="S2.E10.m1.1.1.1.1.1.1" xref="S2.E10.m1.1.1.1.1.1.1.cmml"><mstyle displaystyle="true" id="S2.E10.m1.1.1.1.1.1.1.3" xref="S2.E10.m1.1.1.1.1.1.1.3.cmml"><munder id="S2.E10.m1.1.1.1.1.1.1.3a" xref="S2.E10.m1.1.1.1.1.1.1.3.cmml"><mo movablelimits="false" id="S2.E10.m1.1.1.1.1.1.1.3.2" xref="S2.E10.m1.1.1.1.1.1.1.3.2.cmml">∑</mo><mi id="S2.E10.m1.1.1.1.1.1.1.3.3" xref="S2.E10.m1.1.1.1.1.1.1.3.3.cmml">s</mi></munder></mstyle><mo id="S2.E10.m1.1.1.1.1.1.1.2" xref="S2.E10.m1.1.1.1.1.1.1.2.cmml">−</mo><mrow id="S2.E10.m1.1.1.1.1.1.1.1" xref="S2.E10.m1.1.1.1.1.1.1.1.cmml"><mstyle displaystyle="true" id="S2.E10.m1.1.1.1.1.1.1.1.3" xref="S2.E10.m1.1.1.1.1.1.1.1.3.cmml"><mfrac id="S2.E10.m1.1.1.1.1.1.1.1.3a" xref="S2.E10.m1.1.1.1.1.1.1.1.3.cmml"><mi id="S2.E10.m1.1.1.1.1.1.1.1.3.2" xref="S2.E10.m1.1.1.1.1.1.1.1.3.2.cmml">λ</mi><mn id="S2.E10.m1.1.1.1.1.1.1.1.3.3" xref="S2.E10.m1.1.1.1.1.1.1.1.3.3.cmml">2</mn></mfrac></mstyle><mo lspace="0em" rspace="0em" id="S2.E10.m1.1.1.1.1.1.1.1.2" xref="S2.E10.m1.1.1.1.1.1.1.1.2.cmml">​</mo><msup id="S2.E10.m1.1.1.1.1.1.1.1.1" xref="S2.E10.m1.1.1.1.1.1.1.1.1.cmml"><mrow id="S2.E10.m1.1.1.1.1.1.1.1.1.1.1" xref="S2.E10.m1.1.1.1.1.1.1.1.1.1.2.cmml"><mo stretchy="false" id="S2.E10.m1.1.1.1.1.1.1.1.1.1.1.2" xref="S2.E10.m1.1.1.1.1.1.1.1.1.1.2.1.cmml">‖</mo><mrow id="S2.E10.m1.1.1.1.1.1.1.1.1.1.1.1" xref="S2.E10.m1.1.1.1.1.1.1.1.1.1.1.1.cmml"><msubsup id="S2.E10.m1.1.1.1.1.1.1.1.1.1.1.1.2" xref="S2.E10.m1.1.1.1.1.1.1.1.1.1.1.1.2.cmml"><mi class="ltx_mathvariant_bold-italic" mathvariant="bold-italic" id="S2.E10.m1.1.1.1.1.1.1.1.1.1.1.1.2.2.2" xref="S2.E10.m1.1.1.1.1.1.1.1.1.1.1.1.2.2.2.cmml">ϕ</mi><mi id="S2.E10.m1.1.1.1.1.1.1.1.1.1.1.1.2.3" xref="S2.E10.m1.1.1.1.1.1.1.1.1.1.1.1.2.3.cmml">s</mi><mo id="S2.E10.m1.1.1.1.1.1.1.1.1.1.1.1.2.2.3" xref="S2.E10.m1.1.1.1.1.1.1.1.1.1.1.1.2.2.3.cmml">∗</mo></msubsup><mo id="S2.E10.m1.1.1.1.1.1.1.1.1.1.1.1.1" xref="S2.E10.m1.1.1.1.1.1.1.1.1.1.1.1.1.cmml">−</mo><mi id="S2.E10.m1.1.1.1.1.1.1.1.1.1.1.1.3" xref="S2.E10.m1.1.1.1.1.1.1.1.1.1.1.1.3.cmml">𝐰</mi></mrow><mo stretchy="false" id="S2.E10.m1.1.1.1.1.1.1.1.1.1.1.3" xref="S2.E10.m1.1.1.1.1.1.1.1.1.1.2.1.cmml">‖</mo></mrow><mn id="S2.E10.m1.1.1.1.1.1.1.1.1.3" xref="S2.E10.m1.1.1.1.1.1.1.1.1.3.cmml">2</mn></msup></mrow></mrow><mo id="S2.E10.m1.1.1.1.1.1.2" xref="S2.E10.m1.1.1.1.1.1.2.cmml">+</mo><mi id="S2.E10.m1.1.1.1.1.1.3" xref="S2.E10.m1.1.1.1.1.1.3.cmml">C</mi></mrow></mrow><mo id="S2.E10.m1.1.1.1.2" xref="S2.E10.m1.1.1.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S2.E10.m1.1b"><apply id="S2.E10.m1.1.1.1.1.cmml" xref="S2.E10.m1.1.1.1"><csymbol cd="latexml" id="S2.E10.m1.1.1.1.1.2.cmml" xref="S2.E10.m1.1.1.1.1.2">assign</csymbol><apply id="S2.E10.m1.1.1.1.1.3.cmml" xref="S2.E10.m1.1.1.1.1.3"><apply id="S2.E10.m1.1.1.1.1.3.1.cmml" xref="S2.E10.m1.1.1.1.1.3.1"><csymbol cd="ambiguous" id="S2.E10.m1.1.1.1.1.3.1.1.cmml" xref="S2.E10.m1.1.1.1.1.3.1">subscript</csymbol><apply id="S2.E10.m1.1.1.1.1.3.1.2.cmml" xref="S2.E10.m1.1.1.1.1.3.1.2"><times id="S2.E10.m1.1.1.1.1.3.1.2.1.cmml" xref="S2.E10.m1.1.1.1.1.3.1.2.1"></times><ci id="S2.E10.m1.1.1.1.1.3.1.2.2.cmml" xref="S2.E10.m1.1.1.1.1.3.1.2.2">arg</ci><ci id="S2.E10.m1.1.1.1.1.3.1.2.3.cmml" xref="S2.E10.m1.1.1.1.1.3.1.2.3">max</ci></apply><ci id="S2.E10.m1.1.1.1.1.3.1.3.cmml" xref="S2.E10.m1.1.1.1.1.3.1.3">𝐰</ci></apply><apply id="S2.E10.m1.1.1.1.1.3.2.cmml" xref="S2.E10.m1.1.1.1.1.3.2"><csymbol cd="ambiguous" id="S2.E10.m1.1.1.1.1.3.2.1.cmml" xref="S2.E10.m1.1.1.1.1.3.2">subscript</csymbol><ci id="S2.E10.m1.1.1.1.1.3.2.2.cmml" xref="S2.E10.m1.1.1.1.1.3.2.2">ℒ</ci><ci id="S2.E10.m1.1.1.1.1.3.2.3.cmml" xref="S2.E10.m1.1.1.1.1.3.2.3">𝑟</ci></apply></apply><apply id="S2.E10.m1.1.1.1.1.1.cmml" xref="S2.E10.m1.1.1.1.1.1"><plus id="S2.E10.m1.1.1.1.1.1.2.cmml" xref="S2.E10.m1.1.1.1.1.1.2"></plus><apply id="S2.E10.m1.1.1.1.1.1.1.cmml" xref="S2.E10.m1.1.1.1.1.1.1"><minus id="S2.E10.m1.1.1.1.1.1.1.2.cmml" xref="S2.E10.m1.1.1.1.1.1.1.2"></minus><apply id="S2.E10.m1.1.1.1.1.1.1.3.cmml" xref="S2.E10.m1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S2.E10.m1.1.1.1.1.1.1.3.1.cmml" xref="S2.E10.m1.1.1.1.1.1.1.3">subscript</csymbol><sum id="S2.E10.m1.1.1.1.1.1.1.3.2.cmml" xref="S2.E10.m1.1.1.1.1.1.1.3.2"></sum><ci id="S2.E10.m1.1.1.1.1.1.1.3.3.cmml" xref="S2.E10.m1.1.1.1.1.1.1.3.3">𝑠</ci></apply><apply id="S2.E10.m1.1.1.1.1.1.1.1.cmml" xref="S2.E10.m1.1.1.1.1.1.1.1"><times id="S2.E10.m1.1.1.1.1.1.1.1.2.cmml" xref="S2.E10.m1.1.1.1.1.1.1.1.2"></times><apply id="S2.E10.m1.1.1.1.1.1.1.1.3.cmml" xref="S2.E10.m1.1.1.1.1.1.1.1.3"><divide id="S2.E10.m1.1.1.1.1.1.1.1.3.1.cmml" xref="S2.E10.m1.1.1.1.1.1.1.1.3"></divide><ci id="S2.E10.m1.1.1.1.1.1.1.1.3.2.cmml" xref="S2.E10.m1.1.1.1.1.1.1.1.3.2">𝜆</ci><cn type="integer" id="S2.E10.m1.1.1.1.1.1.1.1.3.3.cmml" xref="S2.E10.m1.1.1.1.1.1.1.1.3.3">2</cn></apply><apply id="S2.E10.m1.1.1.1.1.1.1.1.1.cmml" xref="S2.E10.m1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S2.E10.m1.1.1.1.1.1.1.1.1.2.cmml" xref="S2.E10.m1.1.1.1.1.1.1.1.1">superscript</csymbol><apply id="S2.E10.m1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S2.E10.m1.1.1.1.1.1.1.1.1.1.1"><csymbol cd="latexml" id="S2.E10.m1.1.1.1.1.1.1.1.1.1.2.1.cmml" xref="S2.E10.m1.1.1.1.1.1.1.1.1.1.1.2">norm</csymbol><apply id="S2.E10.m1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S2.E10.m1.1.1.1.1.1.1.1.1.1.1.1"><minus id="S2.E10.m1.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S2.E10.m1.1.1.1.1.1.1.1.1.1.1.1.1"></minus><apply id="S2.E10.m1.1.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S2.E10.m1.1.1.1.1.1.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S2.E10.m1.1.1.1.1.1.1.1.1.1.1.1.2.1.cmml" xref="S2.E10.m1.1.1.1.1.1.1.1.1.1.1.1.2">subscript</csymbol><apply id="S2.E10.m1.1.1.1.1.1.1.1.1.1.1.1.2.2.cmml" xref="S2.E10.m1.1.1.1.1.1.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S2.E10.m1.1.1.1.1.1.1.1.1.1.1.1.2.2.1.cmml" xref="S2.E10.m1.1.1.1.1.1.1.1.1.1.1.1.2">superscript</csymbol><ci id="S2.E10.m1.1.1.1.1.1.1.1.1.1.1.1.2.2.2.cmml" xref="S2.E10.m1.1.1.1.1.1.1.1.1.1.1.1.2.2.2">bold-italic-ϕ</ci><times id="S2.E10.m1.1.1.1.1.1.1.1.1.1.1.1.2.2.3.cmml" xref="S2.E10.m1.1.1.1.1.1.1.1.1.1.1.1.2.2.3"></times></apply><ci id="S2.E10.m1.1.1.1.1.1.1.1.1.1.1.1.2.3.cmml" xref="S2.E10.m1.1.1.1.1.1.1.1.1.1.1.1.2.3">𝑠</ci></apply><ci id="S2.E10.m1.1.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="S2.E10.m1.1.1.1.1.1.1.1.1.1.1.1.3">𝐰</ci></apply></apply><cn type="integer" id="S2.E10.m1.1.1.1.1.1.1.1.1.3.cmml" xref="S2.E10.m1.1.1.1.1.1.1.1.1.3">2</cn></apply></apply></apply><ci id="S2.E10.m1.1.1.1.1.1.3.cmml" xref="S2.E10.m1.1.1.1.1.1.3">𝐶</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.E10.m1.1c">\displaystyle\operatorname*{arg\,max}_{\mathbf{w}}\mathcal{L}_{r}:=\sum_{s}-\frac{\lambda}{2}\|\bm{\phi}^{*}_{s}-\mathbf{w}\|^{2}+C,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(10)</span></td>
</tr></tbody>
</table>
<p id="S2.SS1.p4.4" class="ltx_p">and we can easily find a closed form solution by setting the derivative of the objective w.r.t. <math id="S2.SS1.p4.3.m1.1" class="ltx_Math" alttext="\mathbf{w}" display="inline"><semantics id="S2.SS1.p4.3.m1.1a"><mi id="S2.SS1.p4.3.m1.1.1" xref="S2.SS1.p4.3.m1.1.1.cmml">𝐰</mi><annotation-xml encoding="MathML-Content" id="S2.SS1.p4.3.m1.1b"><ci id="S2.SS1.p4.3.m1.1.1.cmml" xref="S2.SS1.p4.3.m1.1.1">𝐰</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p4.3.m1.1c">\mathbf{w}</annotation></semantics></math> to zero and solving for <math id="S2.SS1.p4.4.m2.1" class="ltx_Math" alttext="\mathbf{w}" display="inline"><semantics id="S2.SS1.p4.4.m2.1a"><mi id="S2.SS1.p4.4.m2.1.1" xref="S2.SS1.p4.4.m2.1.1.cmml">𝐰</mi><annotation-xml encoding="MathML-Content" id="S2.SS1.p4.4.m2.1b"><ci id="S2.SS1.p4.4.m2.1.1.cmml" xref="S2.SS1.p4.4.m2.1.1">𝐰</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p4.4.m2.1c">\mathbf{w}</annotation></semantics></math>:</p>
<table id="A10.EGx11" class="ltx_equationgroup ltx_eqn_align ltx_eqn_table">

<tbody id="S2.E11"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math id="S2.E11.m1.1" class="ltx_Math" alttext="\displaystyle\frac{\partial\mathcal{L}_{r}}{\partial\mathbf{w}}" display="inline"><semantics id="S2.E11.m1.1a"><mstyle displaystyle="true" id="S2.E11.m1.1.1" xref="S2.E11.m1.1.1.cmml"><mfrac id="S2.E11.m1.1.1a" xref="S2.E11.m1.1.1.cmml"><mrow id="S2.E11.m1.1.1.2" xref="S2.E11.m1.1.1.2.cmml"><mo rspace="0em" id="S2.E11.m1.1.1.2.1" xref="S2.E11.m1.1.1.2.1.cmml">∂</mo><msub id="S2.E11.m1.1.1.2.2" xref="S2.E11.m1.1.1.2.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S2.E11.m1.1.1.2.2.2" xref="S2.E11.m1.1.1.2.2.2.cmml">ℒ</mi><mi id="S2.E11.m1.1.1.2.2.3" xref="S2.E11.m1.1.1.2.2.3.cmml">r</mi></msub></mrow><mrow id="S2.E11.m1.1.1.3" xref="S2.E11.m1.1.1.3.cmml"><mo rspace="0em" id="S2.E11.m1.1.1.3.1" xref="S2.E11.m1.1.1.3.1.cmml">∂</mo><mi id="S2.E11.m1.1.1.3.2" xref="S2.E11.m1.1.1.3.2.cmml">𝐰</mi></mrow></mfrac></mstyle><annotation-xml encoding="MathML-Content" id="S2.E11.m1.1b"><apply id="S2.E11.m1.1.1.cmml" xref="S2.E11.m1.1.1"><divide id="S2.E11.m1.1.1.1.cmml" xref="S2.E11.m1.1.1"></divide><apply id="S2.E11.m1.1.1.2.cmml" xref="S2.E11.m1.1.1.2"><partialdiff id="S2.E11.m1.1.1.2.1.cmml" xref="S2.E11.m1.1.1.2.1"></partialdiff><apply id="S2.E11.m1.1.1.2.2.cmml" xref="S2.E11.m1.1.1.2.2"><csymbol cd="ambiguous" id="S2.E11.m1.1.1.2.2.1.cmml" xref="S2.E11.m1.1.1.2.2">subscript</csymbol><ci id="S2.E11.m1.1.1.2.2.2.cmml" xref="S2.E11.m1.1.1.2.2.2">ℒ</ci><ci id="S2.E11.m1.1.1.2.2.3.cmml" xref="S2.E11.m1.1.1.2.2.3">𝑟</ci></apply></apply><apply id="S2.E11.m1.1.1.3.cmml" xref="S2.E11.m1.1.1.3"><partialdiff id="S2.E11.m1.1.1.3.1.cmml" xref="S2.E11.m1.1.1.3.1"></partialdiff><ci id="S2.E11.m1.1.1.3.2.cmml" xref="S2.E11.m1.1.1.3.2">𝐰</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.E11.m1.1c">\displaystyle\frac{\partial\mathcal{L}_{r}}{\partial\mathbf{w}}</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math id="S2.E11.m2.1" class="ltx_Math" alttext="\displaystyle=0\Rightarrow\lambda\sum_{s}\left(\bm{\phi}^{*}_{s}-\mathbf{w}\right)=0\Rightarrow\mathbf{w}=\frac{1}{S}\sum_{s}\bm{\phi}^{*}_{s}." display="inline"><semantics id="S2.E11.m2.1a"><mrow id="S2.E11.m2.1.1.1" xref="S2.E11.m2.1.1.1.1.cmml"><mrow id="S2.E11.m2.1.1.1.1" xref="S2.E11.m2.1.1.1.1.cmml"><mi id="S2.E11.m2.1.1.1.1.3" xref="S2.E11.m2.1.1.1.1.3.cmml"></mi><mo id="S2.E11.m2.1.1.1.1.4" xref="S2.E11.m2.1.1.1.1.4.cmml">=</mo><mn id="S2.E11.m2.1.1.1.1.5" xref="S2.E11.m2.1.1.1.1.5.cmml">0</mn><mo stretchy="false" id="S2.E11.m2.1.1.1.1.6" xref="S2.E11.m2.1.1.1.1.6.cmml">⇒</mo><mrow id="S2.E11.m2.1.1.1.1.1" xref="S2.E11.m2.1.1.1.1.1.cmml"><mi id="S2.E11.m2.1.1.1.1.1.3" xref="S2.E11.m2.1.1.1.1.1.3.cmml">λ</mi><mo lspace="0em" rspace="0em" id="S2.E11.m2.1.1.1.1.1.2" xref="S2.E11.m2.1.1.1.1.1.2.cmml">​</mo><mrow id="S2.E11.m2.1.1.1.1.1.1" xref="S2.E11.m2.1.1.1.1.1.1.cmml"><mstyle displaystyle="true" id="S2.E11.m2.1.1.1.1.1.1.2" xref="S2.E11.m2.1.1.1.1.1.1.2.cmml"><munder id="S2.E11.m2.1.1.1.1.1.1.2a" xref="S2.E11.m2.1.1.1.1.1.1.2.cmml"><mo movablelimits="false" id="S2.E11.m2.1.1.1.1.1.1.2.2" xref="S2.E11.m2.1.1.1.1.1.1.2.2.cmml">∑</mo><mi id="S2.E11.m2.1.1.1.1.1.1.2.3" xref="S2.E11.m2.1.1.1.1.1.1.2.3.cmml">s</mi></munder></mstyle><mrow id="S2.E11.m2.1.1.1.1.1.1.1.1" xref="S2.E11.m2.1.1.1.1.1.1.1.1.1.cmml"><mo id="S2.E11.m2.1.1.1.1.1.1.1.1.2" xref="S2.E11.m2.1.1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="S2.E11.m2.1.1.1.1.1.1.1.1.1" xref="S2.E11.m2.1.1.1.1.1.1.1.1.1.cmml"><msubsup id="S2.E11.m2.1.1.1.1.1.1.1.1.1.2" xref="S2.E11.m2.1.1.1.1.1.1.1.1.1.2.cmml"><mi class="ltx_mathvariant_bold-italic" mathvariant="bold-italic" id="S2.E11.m2.1.1.1.1.1.1.1.1.1.2.2.2" xref="S2.E11.m2.1.1.1.1.1.1.1.1.1.2.2.2.cmml">ϕ</mi><mi id="S2.E11.m2.1.1.1.1.1.1.1.1.1.2.3" xref="S2.E11.m2.1.1.1.1.1.1.1.1.1.2.3.cmml">s</mi><mo id="S2.E11.m2.1.1.1.1.1.1.1.1.1.2.2.3" xref="S2.E11.m2.1.1.1.1.1.1.1.1.1.2.2.3.cmml">∗</mo></msubsup><mo id="S2.E11.m2.1.1.1.1.1.1.1.1.1.1" xref="S2.E11.m2.1.1.1.1.1.1.1.1.1.1.cmml">−</mo><mi id="S2.E11.m2.1.1.1.1.1.1.1.1.1.3" xref="S2.E11.m2.1.1.1.1.1.1.1.1.1.3.cmml">𝐰</mi></mrow><mo id="S2.E11.m2.1.1.1.1.1.1.1.1.3" xref="S2.E11.m2.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><mo id="S2.E11.m2.1.1.1.1.7" xref="S2.E11.m2.1.1.1.1.7.cmml">=</mo><mn id="S2.E11.m2.1.1.1.1.8" xref="S2.E11.m2.1.1.1.1.8.cmml">0</mn><mo stretchy="false" id="S2.E11.m2.1.1.1.1.9" xref="S2.E11.m2.1.1.1.1.9.cmml">⇒</mo><mi id="S2.E11.m2.1.1.1.1.10" xref="S2.E11.m2.1.1.1.1.10.cmml">𝐰</mi><mo id="S2.E11.m2.1.1.1.1.11" xref="S2.E11.m2.1.1.1.1.11.cmml">=</mo><mrow id="S2.E11.m2.1.1.1.1.12" xref="S2.E11.m2.1.1.1.1.12.cmml"><mstyle displaystyle="true" id="S2.E11.m2.1.1.1.1.12.2" xref="S2.E11.m2.1.1.1.1.12.2.cmml"><mfrac id="S2.E11.m2.1.1.1.1.12.2a" xref="S2.E11.m2.1.1.1.1.12.2.cmml"><mn id="S2.E11.m2.1.1.1.1.12.2.2" xref="S2.E11.m2.1.1.1.1.12.2.2.cmml">1</mn><mi id="S2.E11.m2.1.1.1.1.12.2.3" xref="S2.E11.m2.1.1.1.1.12.2.3.cmml">S</mi></mfrac></mstyle><mo lspace="0em" rspace="0em" id="S2.E11.m2.1.1.1.1.12.1" xref="S2.E11.m2.1.1.1.1.12.1.cmml">​</mo><mrow id="S2.E11.m2.1.1.1.1.12.3" xref="S2.E11.m2.1.1.1.1.12.3.cmml"><mstyle displaystyle="true" id="S2.E11.m2.1.1.1.1.12.3.1" xref="S2.E11.m2.1.1.1.1.12.3.1.cmml"><munder id="S2.E11.m2.1.1.1.1.12.3.1a" xref="S2.E11.m2.1.1.1.1.12.3.1.cmml"><mo movablelimits="false" id="S2.E11.m2.1.1.1.1.12.3.1.2" xref="S2.E11.m2.1.1.1.1.12.3.1.2.cmml">∑</mo><mi id="S2.E11.m2.1.1.1.1.12.3.1.3" xref="S2.E11.m2.1.1.1.1.12.3.1.3.cmml">s</mi></munder></mstyle><msubsup id="S2.E11.m2.1.1.1.1.12.3.2" xref="S2.E11.m2.1.1.1.1.12.3.2.cmml"><mi class="ltx_mathvariant_bold-italic" mathvariant="bold-italic" id="S2.E11.m2.1.1.1.1.12.3.2.2.2" xref="S2.E11.m2.1.1.1.1.12.3.2.2.2.cmml">ϕ</mi><mi id="S2.E11.m2.1.1.1.1.12.3.2.3" xref="S2.E11.m2.1.1.1.1.12.3.2.3.cmml">s</mi><mo id="S2.E11.m2.1.1.1.1.12.3.2.2.3" xref="S2.E11.m2.1.1.1.1.12.3.2.2.3.cmml">∗</mo></msubsup></mrow></mrow></mrow><mo lspace="0em" id="S2.E11.m2.1.1.1.2" xref="S2.E11.m2.1.1.1.1.cmml">.</mo></mrow><annotation-xml encoding="MathML-Content" id="S2.E11.m2.1b"><apply id="S2.E11.m2.1.1.1.1.cmml" xref="S2.E11.m2.1.1.1"><and id="S2.E11.m2.1.1.1.1a.cmml" xref="S2.E11.m2.1.1.1"></and><apply id="S2.E11.m2.1.1.1.1b.cmml" xref="S2.E11.m2.1.1.1"><eq id="S2.E11.m2.1.1.1.1.4.cmml" xref="S2.E11.m2.1.1.1.1.4"></eq><csymbol cd="latexml" id="S2.E11.m2.1.1.1.1.3.cmml" xref="S2.E11.m2.1.1.1.1.3">absent</csymbol><cn type="integer" id="S2.E11.m2.1.1.1.1.5.cmml" xref="S2.E11.m2.1.1.1.1.5">0</cn></apply><apply id="S2.E11.m2.1.1.1.1c.cmml" xref="S2.E11.m2.1.1.1"><ci id="S2.E11.m2.1.1.1.1.6.cmml" xref="S2.E11.m2.1.1.1.1.6">⇒</ci><share href="#S2.E11.m2.1.1.1.1.5.cmml" id="S2.E11.m2.1.1.1.1d.cmml" xref="S2.E11.m2.1.1.1"></share><apply id="S2.E11.m2.1.1.1.1.1.cmml" xref="S2.E11.m2.1.1.1.1.1"><times id="S2.E11.m2.1.1.1.1.1.2.cmml" xref="S2.E11.m2.1.1.1.1.1.2"></times><ci id="S2.E11.m2.1.1.1.1.1.3.cmml" xref="S2.E11.m2.1.1.1.1.1.3">𝜆</ci><apply id="S2.E11.m2.1.1.1.1.1.1.cmml" xref="S2.E11.m2.1.1.1.1.1.1"><apply id="S2.E11.m2.1.1.1.1.1.1.2.cmml" xref="S2.E11.m2.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S2.E11.m2.1.1.1.1.1.1.2.1.cmml" xref="S2.E11.m2.1.1.1.1.1.1.2">subscript</csymbol><sum id="S2.E11.m2.1.1.1.1.1.1.2.2.cmml" xref="S2.E11.m2.1.1.1.1.1.1.2.2"></sum><ci id="S2.E11.m2.1.1.1.1.1.1.2.3.cmml" xref="S2.E11.m2.1.1.1.1.1.1.2.3">𝑠</ci></apply><apply id="S2.E11.m2.1.1.1.1.1.1.1.1.1.cmml" xref="S2.E11.m2.1.1.1.1.1.1.1.1"><minus id="S2.E11.m2.1.1.1.1.1.1.1.1.1.1.cmml" xref="S2.E11.m2.1.1.1.1.1.1.1.1.1.1"></minus><apply id="S2.E11.m2.1.1.1.1.1.1.1.1.1.2.cmml" xref="S2.E11.m2.1.1.1.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S2.E11.m2.1.1.1.1.1.1.1.1.1.2.1.cmml" xref="S2.E11.m2.1.1.1.1.1.1.1.1.1.2">subscript</csymbol><apply id="S2.E11.m2.1.1.1.1.1.1.1.1.1.2.2.cmml" xref="S2.E11.m2.1.1.1.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S2.E11.m2.1.1.1.1.1.1.1.1.1.2.2.1.cmml" xref="S2.E11.m2.1.1.1.1.1.1.1.1.1.2">superscript</csymbol><ci id="S2.E11.m2.1.1.1.1.1.1.1.1.1.2.2.2.cmml" xref="S2.E11.m2.1.1.1.1.1.1.1.1.1.2.2.2">bold-italic-ϕ</ci><times id="S2.E11.m2.1.1.1.1.1.1.1.1.1.2.2.3.cmml" xref="S2.E11.m2.1.1.1.1.1.1.1.1.1.2.2.3"></times></apply><ci id="S2.E11.m2.1.1.1.1.1.1.1.1.1.2.3.cmml" xref="S2.E11.m2.1.1.1.1.1.1.1.1.1.2.3">𝑠</ci></apply><ci id="S2.E11.m2.1.1.1.1.1.1.1.1.1.3.cmml" xref="S2.E11.m2.1.1.1.1.1.1.1.1.1.3">𝐰</ci></apply></apply></apply></apply><apply id="S2.E11.m2.1.1.1.1e.cmml" xref="S2.E11.m2.1.1.1"><eq id="S2.E11.m2.1.1.1.1.7.cmml" xref="S2.E11.m2.1.1.1.1.7"></eq><share href="#S2.E11.m2.1.1.1.1.1.cmml" id="S2.E11.m2.1.1.1.1f.cmml" xref="S2.E11.m2.1.1.1"></share><cn type="integer" id="S2.E11.m2.1.1.1.1.8.cmml" xref="S2.E11.m2.1.1.1.1.8">0</cn></apply><apply id="S2.E11.m2.1.1.1.1g.cmml" xref="S2.E11.m2.1.1.1"><ci id="S2.E11.m2.1.1.1.1.9.cmml" xref="S2.E11.m2.1.1.1.1.9">⇒</ci><share href="#S2.E11.m2.1.1.1.1.8.cmml" id="S2.E11.m2.1.1.1.1h.cmml" xref="S2.E11.m2.1.1.1"></share><ci id="S2.E11.m2.1.1.1.1.10.cmml" xref="S2.E11.m2.1.1.1.1.10">𝐰</ci></apply><apply id="S2.E11.m2.1.1.1.1i.cmml" xref="S2.E11.m2.1.1.1"><eq id="S2.E11.m2.1.1.1.1.11.cmml" xref="S2.E11.m2.1.1.1.1.11"></eq><share href="#S2.E11.m2.1.1.1.1.10.cmml" id="S2.E11.m2.1.1.1.1j.cmml" xref="S2.E11.m2.1.1.1"></share><apply id="S2.E11.m2.1.1.1.1.12.cmml" xref="S2.E11.m2.1.1.1.1.12"><times id="S2.E11.m2.1.1.1.1.12.1.cmml" xref="S2.E11.m2.1.1.1.1.12.1"></times><apply id="S2.E11.m2.1.1.1.1.12.2.cmml" xref="S2.E11.m2.1.1.1.1.12.2"><divide id="S2.E11.m2.1.1.1.1.12.2.1.cmml" xref="S2.E11.m2.1.1.1.1.12.2"></divide><cn type="integer" id="S2.E11.m2.1.1.1.1.12.2.2.cmml" xref="S2.E11.m2.1.1.1.1.12.2.2">1</cn><ci id="S2.E11.m2.1.1.1.1.12.2.3.cmml" xref="S2.E11.m2.1.1.1.1.12.2.3">𝑆</ci></apply><apply id="S2.E11.m2.1.1.1.1.12.3.cmml" xref="S2.E11.m2.1.1.1.1.12.3"><apply id="S2.E11.m2.1.1.1.1.12.3.1.cmml" xref="S2.E11.m2.1.1.1.1.12.3.1"><csymbol cd="ambiguous" id="S2.E11.m2.1.1.1.1.12.3.1.1.cmml" xref="S2.E11.m2.1.1.1.1.12.3.1">subscript</csymbol><sum id="S2.E11.m2.1.1.1.1.12.3.1.2.cmml" xref="S2.E11.m2.1.1.1.1.12.3.1.2"></sum><ci id="S2.E11.m2.1.1.1.1.12.3.1.3.cmml" xref="S2.E11.m2.1.1.1.1.12.3.1.3">𝑠</ci></apply><apply id="S2.E11.m2.1.1.1.1.12.3.2.cmml" xref="S2.E11.m2.1.1.1.1.12.3.2"><csymbol cd="ambiguous" id="S2.E11.m2.1.1.1.1.12.3.2.1.cmml" xref="S2.E11.m2.1.1.1.1.12.3.2">subscript</csymbol><apply id="S2.E11.m2.1.1.1.1.12.3.2.2.cmml" xref="S2.E11.m2.1.1.1.1.12.3.2"><csymbol cd="ambiguous" id="S2.E11.m2.1.1.1.1.12.3.2.2.1.cmml" xref="S2.E11.m2.1.1.1.1.12.3.2">superscript</csymbol><ci id="S2.E11.m2.1.1.1.1.12.3.2.2.2.cmml" xref="S2.E11.m2.1.1.1.1.12.3.2.2.2">bold-italic-ϕ</ci><times id="S2.E11.m2.1.1.1.1.12.3.2.2.3.cmml" xref="S2.E11.m2.1.1.1.1.12.3.2.2.3"></times></apply><ci id="S2.E11.m2.1.1.1.1.12.3.2.3.cmml" xref="S2.E11.m2.1.1.1.1.12.3.2.3">𝑠</ci></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.E11.m2.1c">\displaystyle=0\Rightarrow\lambda\sum_{s}\left(\bm{\phi}^{*}_{s}-\mathbf{w}\right)=0\Rightarrow\mathbf{w}=\frac{1}{S}\sum_{s}\bm{\phi}^{*}_{s}.</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(11)</span></td>
</tr></tbody>
</table>
<p id="S2.SS1.p4.10" class="ltx_p">It is easy to see that the optimal solution for <math id="S2.SS1.p4.5.m1.1" class="ltx_Math" alttext="\mathbf{w}" display="inline"><semantics id="S2.SS1.p4.5.m1.1a"><mi id="S2.SS1.p4.5.m1.1.1" xref="S2.SS1.p4.5.m1.1.1.cmml">𝐰</mi><annotation-xml encoding="MathML-Content" id="S2.SS1.p4.5.m1.1b"><ci id="S2.SS1.p4.5.m1.1.1.cmml" xref="S2.SS1.p4.5.m1.1.1">𝐰</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p4.5.m1.1c">\mathbf{w}</annotation></semantics></math> given <math id="S2.SS1.p4.6.m2.1" class="ltx_Math" alttext="\bm{\phi}^{*}_{1:S}" display="inline"><semantics id="S2.SS1.p4.6.m2.1a"><msubsup id="S2.SS1.p4.6.m2.1.1" xref="S2.SS1.p4.6.m2.1.1.cmml"><mi class="ltx_mathvariant_bold-italic" mathvariant="bold-italic" id="S2.SS1.p4.6.m2.1.1.2.2" xref="S2.SS1.p4.6.m2.1.1.2.2.cmml">ϕ</mi><mrow id="S2.SS1.p4.6.m2.1.1.3" xref="S2.SS1.p4.6.m2.1.1.3.cmml"><mn id="S2.SS1.p4.6.m2.1.1.3.2" xref="S2.SS1.p4.6.m2.1.1.3.2.cmml">1</mn><mo lspace="0.278em" rspace="0.278em" id="S2.SS1.p4.6.m2.1.1.3.1" xref="S2.SS1.p4.6.m2.1.1.3.1.cmml">:</mo><mi id="S2.SS1.p4.6.m2.1.1.3.3" xref="S2.SS1.p4.6.m2.1.1.3.3.cmml">S</mi></mrow><mo id="S2.SS1.p4.6.m2.1.1.2.3" xref="S2.SS1.p4.6.m2.1.1.2.3.cmml">∗</mo></msubsup><annotation-xml encoding="MathML-Content" id="S2.SS1.p4.6.m2.1b"><apply id="S2.SS1.p4.6.m2.1.1.cmml" xref="S2.SS1.p4.6.m2.1.1"><csymbol cd="ambiguous" id="S2.SS1.p4.6.m2.1.1.1.cmml" xref="S2.SS1.p4.6.m2.1.1">subscript</csymbol><apply id="S2.SS1.p4.6.m2.1.1.2.cmml" xref="S2.SS1.p4.6.m2.1.1"><csymbol cd="ambiguous" id="S2.SS1.p4.6.m2.1.1.2.1.cmml" xref="S2.SS1.p4.6.m2.1.1">superscript</csymbol><ci id="S2.SS1.p4.6.m2.1.1.2.2.cmml" xref="S2.SS1.p4.6.m2.1.1.2.2">bold-italic-ϕ</ci><times id="S2.SS1.p4.6.m2.1.1.2.3.cmml" xref="S2.SS1.p4.6.m2.1.1.2.3"></times></apply><apply id="S2.SS1.p4.6.m2.1.1.3.cmml" xref="S2.SS1.p4.6.m2.1.1.3"><ci id="S2.SS1.p4.6.m2.1.1.3.1.cmml" xref="S2.SS1.p4.6.m2.1.1.3.1">:</ci><cn type="integer" id="S2.SS1.p4.6.m2.1.1.3.2.cmml" xref="S2.SS1.p4.6.m2.1.1.3.2">1</cn><ci id="S2.SS1.p4.6.m2.1.1.3.3.cmml" xref="S2.SS1.p4.6.m2.1.1.3.3">𝑆</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p4.6.m2.1c">\bm{\phi}^{*}_{1:S}</annotation></semantics></math> is the same as the one from <span id="S2.SS1.p4.10.1" class="ltx_text ltx_font_typewriter">FedAvg</span>. Notice that for the “cross-device” settings of FL, the sum over all of the shards in the objective can be expensive. Nevertheless, it can easily be approximated by selecting a subset of the shards <math id="S2.SS1.p4.7.m3.1" class="ltx_Math" alttext="B" display="inline"><semantics id="S2.SS1.p4.7.m3.1a"><mi id="S2.SS1.p4.7.m3.1.1" xref="S2.SS1.p4.7.m3.1.1.cmml">B</mi><annotation-xml encoding="MathML-Content" id="S2.SS1.p4.7.m3.1b"><ci id="S2.SS1.p4.7.m3.1.1.cmml" xref="S2.SS1.p4.7.m3.1.1">𝐵</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p4.7.m3.1c">B</annotation></semantics></math>, i.e., <math id="S2.SS1.p4.8.m4.1" class="ltx_Math" alttext="\mathcal{L}_{r}\approx\frac{S}{B}\sum_{s\in B}-\frac{\lambda}{2}\|\bm{\phi}^{*}_{s}-\mathbf{w}\|^{2}+C" display="inline"><semantics id="S2.SS1.p4.8.m4.1a"><mrow id="S2.SS1.p4.8.m4.1.1" xref="S2.SS1.p4.8.m4.1.1.cmml"><msub id="S2.SS1.p4.8.m4.1.1.3" xref="S2.SS1.p4.8.m4.1.1.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S2.SS1.p4.8.m4.1.1.3.2" xref="S2.SS1.p4.8.m4.1.1.3.2.cmml">ℒ</mi><mi id="S2.SS1.p4.8.m4.1.1.3.3" xref="S2.SS1.p4.8.m4.1.1.3.3.cmml">r</mi></msub><mo id="S2.SS1.p4.8.m4.1.1.2" xref="S2.SS1.p4.8.m4.1.1.2.cmml">≈</mo><mrow id="S2.SS1.p4.8.m4.1.1.1" xref="S2.SS1.p4.8.m4.1.1.1.cmml"><mrow id="S2.SS1.p4.8.m4.1.1.1.1" xref="S2.SS1.p4.8.m4.1.1.1.1.cmml"><mrow id="S2.SS1.p4.8.m4.1.1.1.1.3" xref="S2.SS1.p4.8.m4.1.1.1.1.3.cmml"><mfrac id="S2.SS1.p4.8.m4.1.1.1.1.3.2" xref="S2.SS1.p4.8.m4.1.1.1.1.3.2.cmml"><mi id="S2.SS1.p4.8.m4.1.1.1.1.3.2.2" xref="S2.SS1.p4.8.m4.1.1.1.1.3.2.2.cmml">S</mi><mi id="S2.SS1.p4.8.m4.1.1.1.1.3.2.3" xref="S2.SS1.p4.8.m4.1.1.1.1.3.2.3.cmml">B</mi></mfrac><mo lspace="0em" rspace="0em" id="S2.SS1.p4.8.m4.1.1.1.1.3.1" xref="S2.SS1.p4.8.m4.1.1.1.1.3.1.cmml">​</mo><msub id="S2.SS1.p4.8.m4.1.1.1.1.3.3" xref="S2.SS1.p4.8.m4.1.1.1.1.3.3.cmml"><mo rspace="0em" id="S2.SS1.p4.8.m4.1.1.1.1.3.3.2" xref="S2.SS1.p4.8.m4.1.1.1.1.3.3.2.cmml">∑</mo><mrow id="S2.SS1.p4.8.m4.1.1.1.1.3.3.3" xref="S2.SS1.p4.8.m4.1.1.1.1.3.3.3.cmml"><mi id="S2.SS1.p4.8.m4.1.1.1.1.3.3.3.2" xref="S2.SS1.p4.8.m4.1.1.1.1.3.3.3.2.cmml">s</mi><mo id="S2.SS1.p4.8.m4.1.1.1.1.3.3.3.1" xref="S2.SS1.p4.8.m4.1.1.1.1.3.3.3.1.cmml">∈</mo><mi id="S2.SS1.p4.8.m4.1.1.1.1.3.3.3.3" xref="S2.SS1.p4.8.m4.1.1.1.1.3.3.3.3.cmml">B</mi></mrow></msub></mrow><mo lspace="0em" id="S2.SS1.p4.8.m4.1.1.1.1.2" xref="S2.SS1.p4.8.m4.1.1.1.1.2.cmml">−</mo><mrow id="S2.SS1.p4.8.m4.1.1.1.1.1" xref="S2.SS1.p4.8.m4.1.1.1.1.1.cmml"><mfrac id="S2.SS1.p4.8.m4.1.1.1.1.1.3" xref="S2.SS1.p4.8.m4.1.1.1.1.1.3.cmml"><mi id="S2.SS1.p4.8.m4.1.1.1.1.1.3.2" xref="S2.SS1.p4.8.m4.1.1.1.1.1.3.2.cmml">λ</mi><mn id="S2.SS1.p4.8.m4.1.1.1.1.1.3.3" xref="S2.SS1.p4.8.m4.1.1.1.1.1.3.3.cmml">2</mn></mfrac><mo lspace="0em" rspace="0em" id="S2.SS1.p4.8.m4.1.1.1.1.1.2" xref="S2.SS1.p4.8.m4.1.1.1.1.1.2.cmml">​</mo><msup id="S2.SS1.p4.8.m4.1.1.1.1.1.1" xref="S2.SS1.p4.8.m4.1.1.1.1.1.1.cmml"><mrow id="S2.SS1.p4.8.m4.1.1.1.1.1.1.1.1" xref="S2.SS1.p4.8.m4.1.1.1.1.1.1.1.2.cmml"><mo stretchy="false" id="S2.SS1.p4.8.m4.1.1.1.1.1.1.1.1.2" xref="S2.SS1.p4.8.m4.1.1.1.1.1.1.1.2.1.cmml">‖</mo><mrow id="S2.SS1.p4.8.m4.1.1.1.1.1.1.1.1.1" xref="S2.SS1.p4.8.m4.1.1.1.1.1.1.1.1.1.cmml"><msubsup id="S2.SS1.p4.8.m4.1.1.1.1.1.1.1.1.1.2" xref="S2.SS1.p4.8.m4.1.1.1.1.1.1.1.1.1.2.cmml"><mi class="ltx_mathvariant_bold-italic" mathvariant="bold-italic" id="S2.SS1.p4.8.m4.1.1.1.1.1.1.1.1.1.2.2.2" xref="S2.SS1.p4.8.m4.1.1.1.1.1.1.1.1.1.2.2.2.cmml">ϕ</mi><mi id="S2.SS1.p4.8.m4.1.1.1.1.1.1.1.1.1.2.3" xref="S2.SS1.p4.8.m4.1.1.1.1.1.1.1.1.1.2.3.cmml">s</mi><mo id="S2.SS1.p4.8.m4.1.1.1.1.1.1.1.1.1.2.2.3" xref="S2.SS1.p4.8.m4.1.1.1.1.1.1.1.1.1.2.2.3.cmml">∗</mo></msubsup><mo id="S2.SS1.p4.8.m4.1.1.1.1.1.1.1.1.1.1" xref="S2.SS1.p4.8.m4.1.1.1.1.1.1.1.1.1.1.cmml">−</mo><mi id="S2.SS1.p4.8.m4.1.1.1.1.1.1.1.1.1.3" xref="S2.SS1.p4.8.m4.1.1.1.1.1.1.1.1.1.3.cmml">𝐰</mi></mrow><mo stretchy="false" id="S2.SS1.p4.8.m4.1.1.1.1.1.1.1.1.3" xref="S2.SS1.p4.8.m4.1.1.1.1.1.1.1.2.1.cmml">‖</mo></mrow><mn id="S2.SS1.p4.8.m4.1.1.1.1.1.1.3" xref="S2.SS1.p4.8.m4.1.1.1.1.1.1.3.cmml">2</mn></msup></mrow></mrow><mo id="S2.SS1.p4.8.m4.1.1.1.2" xref="S2.SS1.p4.8.m4.1.1.1.2.cmml">+</mo><mi id="S2.SS1.p4.8.m4.1.1.1.3" xref="S2.SS1.p4.8.m4.1.1.1.3.cmml">C</mi></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.SS1.p4.8.m4.1b"><apply id="S2.SS1.p4.8.m4.1.1.cmml" xref="S2.SS1.p4.8.m4.1.1"><approx id="S2.SS1.p4.8.m4.1.1.2.cmml" xref="S2.SS1.p4.8.m4.1.1.2"></approx><apply id="S2.SS1.p4.8.m4.1.1.3.cmml" xref="S2.SS1.p4.8.m4.1.1.3"><csymbol cd="ambiguous" id="S2.SS1.p4.8.m4.1.1.3.1.cmml" xref="S2.SS1.p4.8.m4.1.1.3">subscript</csymbol><ci id="S2.SS1.p4.8.m4.1.1.3.2.cmml" xref="S2.SS1.p4.8.m4.1.1.3.2">ℒ</ci><ci id="S2.SS1.p4.8.m4.1.1.3.3.cmml" xref="S2.SS1.p4.8.m4.1.1.3.3">𝑟</ci></apply><apply id="S2.SS1.p4.8.m4.1.1.1.cmml" xref="S2.SS1.p4.8.m4.1.1.1"><plus id="S2.SS1.p4.8.m4.1.1.1.2.cmml" xref="S2.SS1.p4.8.m4.1.1.1.2"></plus><apply id="S2.SS1.p4.8.m4.1.1.1.1.cmml" xref="S2.SS1.p4.8.m4.1.1.1.1"><minus id="S2.SS1.p4.8.m4.1.1.1.1.2.cmml" xref="S2.SS1.p4.8.m4.1.1.1.1.2"></minus><apply id="S2.SS1.p4.8.m4.1.1.1.1.3.cmml" xref="S2.SS1.p4.8.m4.1.1.1.1.3"><times id="S2.SS1.p4.8.m4.1.1.1.1.3.1.cmml" xref="S2.SS1.p4.8.m4.1.1.1.1.3.1"></times><apply id="S2.SS1.p4.8.m4.1.1.1.1.3.2.cmml" xref="S2.SS1.p4.8.m4.1.1.1.1.3.2"><divide id="S2.SS1.p4.8.m4.1.1.1.1.3.2.1.cmml" xref="S2.SS1.p4.8.m4.1.1.1.1.3.2"></divide><ci id="S2.SS1.p4.8.m4.1.1.1.1.3.2.2.cmml" xref="S2.SS1.p4.8.m4.1.1.1.1.3.2.2">𝑆</ci><ci id="S2.SS1.p4.8.m4.1.1.1.1.3.2.3.cmml" xref="S2.SS1.p4.8.m4.1.1.1.1.3.2.3">𝐵</ci></apply><apply id="S2.SS1.p4.8.m4.1.1.1.1.3.3.cmml" xref="S2.SS1.p4.8.m4.1.1.1.1.3.3"><csymbol cd="ambiguous" id="S2.SS1.p4.8.m4.1.1.1.1.3.3.1.cmml" xref="S2.SS1.p4.8.m4.1.1.1.1.3.3">subscript</csymbol><sum id="S2.SS1.p4.8.m4.1.1.1.1.3.3.2.cmml" xref="S2.SS1.p4.8.m4.1.1.1.1.3.3.2"></sum><apply id="S2.SS1.p4.8.m4.1.1.1.1.3.3.3.cmml" xref="S2.SS1.p4.8.m4.1.1.1.1.3.3.3"><in id="S2.SS1.p4.8.m4.1.1.1.1.3.3.3.1.cmml" xref="S2.SS1.p4.8.m4.1.1.1.1.3.3.3.1"></in><ci id="S2.SS1.p4.8.m4.1.1.1.1.3.3.3.2.cmml" xref="S2.SS1.p4.8.m4.1.1.1.1.3.3.3.2">𝑠</ci><ci id="S2.SS1.p4.8.m4.1.1.1.1.3.3.3.3.cmml" xref="S2.SS1.p4.8.m4.1.1.1.1.3.3.3.3">𝐵</ci></apply></apply></apply><apply id="S2.SS1.p4.8.m4.1.1.1.1.1.cmml" xref="S2.SS1.p4.8.m4.1.1.1.1.1"><times id="S2.SS1.p4.8.m4.1.1.1.1.1.2.cmml" xref="S2.SS1.p4.8.m4.1.1.1.1.1.2"></times><apply id="S2.SS1.p4.8.m4.1.1.1.1.1.3.cmml" xref="S2.SS1.p4.8.m4.1.1.1.1.1.3"><divide id="S2.SS1.p4.8.m4.1.1.1.1.1.3.1.cmml" xref="S2.SS1.p4.8.m4.1.1.1.1.1.3"></divide><ci id="S2.SS1.p4.8.m4.1.1.1.1.1.3.2.cmml" xref="S2.SS1.p4.8.m4.1.1.1.1.1.3.2">𝜆</ci><cn type="integer" id="S2.SS1.p4.8.m4.1.1.1.1.1.3.3.cmml" xref="S2.SS1.p4.8.m4.1.1.1.1.1.3.3">2</cn></apply><apply id="S2.SS1.p4.8.m4.1.1.1.1.1.1.cmml" xref="S2.SS1.p4.8.m4.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S2.SS1.p4.8.m4.1.1.1.1.1.1.2.cmml" xref="S2.SS1.p4.8.m4.1.1.1.1.1.1">superscript</csymbol><apply id="S2.SS1.p4.8.m4.1.1.1.1.1.1.1.2.cmml" xref="S2.SS1.p4.8.m4.1.1.1.1.1.1.1.1"><csymbol cd="latexml" id="S2.SS1.p4.8.m4.1.1.1.1.1.1.1.2.1.cmml" xref="S2.SS1.p4.8.m4.1.1.1.1.1.1.1.1.2">norm</csymbol><apply id="S2.SS1.p4.8.m4.1.1.1.1.1.1.1.1.1.cmml" xref="S2.SS1.p4.8.m4.1.1.1.1.1.1.1.1.1"><minus id="S2.SS1.p4.8.m4.1.1.1.1.1.1.1.1.1.1.cmml" xref="S2.SS1.p4.8.m4.1.1.1.1.1.1.1.1.1.1"></minus><apply id="S2.SS1.p4.8.m4.1.1.1.1.1.1.1.1.1.2.cmml" xref="S2.SS1.p4.8.m4.1.1.1.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S2.SS1.p4.8.m4.1.1.1.1.1.1.1.1.1.2.1.cmml" xref="S2.SS1.p4.8.m4.1.1.1.1.1.1.1.1.1.2">subscript</csymbol><apply id="S2.SS1.p4.8.m4.1.1.1.1.1.1.1.1.1.2.2.cmml" xref="S2.SS1.p4.8.m4.1.1.1.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S2.SS1.p4.8.m4.1.1.1.1.1.1.1.1.1.2.2.1.cmml" xref="S2.SS1.p4.8.m4.1.1.1.1.1.1.1.1.1.2">superscript</csymbol><ci id="S2.SS1.p4.8.m4.1.1.1.1.1.1.1.1.1.2.2.2.cmml" xref="S2.SS1.p4.8.m4.1.1.1.1.1.1.1.1.1.2.2.2">bold-italic-ϕ</ci><times id="S2.SS1.p4.8.m4.1.1.1.1.1.1.1.1.1.2.2.3.cmml" xref="S2.SS1.p4.8.m4.1.1.1.1.1.1.1.1.1.2.2.3"></times></apply><ci id="S2.SS1.p4.8.m4.1.1.1.1.1.1.1.1.1.2.3.cmml" xref="S2.SS1.p4.8.m4.1.1.1.1.1.1.1.1.1.2.3">𝑠</ci></apply><ci id="S2.SS1.p4.8.m4.1.1.1.1.1.1.1.1.1.3.cmml" xref="S2.SS1.p4.8.m4.1.1.1.1.1.1.1.1.1.3">𝐰</ci></apply></apply><cn type="integer" id="S2.SS1.p4.8.m4.1.1.1.1.1.1.3.cmml" xref="S2.SS1.p4.8.m4.1.1.1.1.1.1.3">2</cn></apply></apply></apply><ci id="S2.SS1.p4.8.m4.1.1.1.3.cmml" xref="S2.SS1.p4.8.m4.1.1.1.3">𝐶</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p4.8.m4.1c">\mathcal{L}_{r}\approx\frac{S}{B}\sum_{s\in B}-\frac{\lambda}{2}\|\bm{\phi}^{*}_{s}-\mathbf{w}\|^{2}+C</annotation></semantics></math>. In this way, we only have to estimate <math id="S2.SS1.p4.9.m5.1" class="ltx_Math" alttext="\bm{\phi}^{*}_{s}" display="inline"><semantics id="S2.SS1.p4.9.m5.1a"><msubsup id="S2.SS1.p4.9.m5.1.1" xref="S2.SS1.p4.9.m5.1.1.cmml"><mi class="ltx_mathvariant_bold-italic" mathvariant="bold-italic" id="S2.SS1.p4.9.m5.1.1.2.2" xref="S2.SS1.p4.9.m5.1.1.2.2.cmml">ϕ</mi><mi id="S2.SS1.p4.9.m5.1.1.3" xref="S2.SS1.p4.9.m5.1.1.3.cmml">s</mi><mo id="S2.SS1.p4.9.m5.1.1.2.3" xref="S2.SS1.p4.9.m5.1.1.2.3.cmml">∗</mo></msubsup><annotation-xml encoding="MathML-Content" id="S2.SS1.p4.9.m5.1b"><apply id="S2.SS1.p4.9.m5.1.1.cmml" xref="S2.SS1.p4.9.m5.1.1"><csymbol cd="ambiguous" id="S2.SS1.p4.9.m5.1.1.1.cmml" xref="S2.SS1.p4.9.m5.1.1">subscript</csymbol><apply id="S2.SS1.p4.9.m5.1.1.2.cmml" xref="S2.SS1.p4.9.m5.1.1"><csymbol cd="ambiguous" id="S2.SS1.p4.9.m5.1.1.2.1.cmml" xref="S2.SS1.p4.9.m5.1.1">superscript</csymbol><ci id="S2.SS1.p4.9.m5.1.1.2.2.cmml" xref="S2.SS1.p4.9.m5.1.1.2.2">bold-italic-ϕ</ci><times id="S2.SS1.p4.9.m5.1.1.2.3.cmml" xref="S2.SS1.p4.9.m5.1.1.2.3"></times></apply><ci id="S2.SS1.p4.9.m5.1.1.3.cmml" xref="S2.SS1.p4.9.m5.1.1.3">𝑠</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p4.9.m5.1c">\bm{\phi}^{*}_{s}</annotation></semantics></math> for the selected shards since the averaging for <math id="S2.SS1.p4.10.m6.1" class="ltx_Math" alttext="\mathbf{w}" display="inline"><semantics id="S2.SS1.p4.10.m6.1a"><mi id="S2.SS1.p4.10.m6.1.1" xref="S2.SS1.p4.10.m6.1.1.cmml">𝐰</mi><annotation-xml encoding="MathML-Content" id="S2.SS1.p4.10.m6.1b"><ci id="S2.SS1.p4.10.m6.1.1.cmml" xref="S2.SS1.p4.10.m6.1.1">𝐰</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p4.10.m6.1c">\mathbf{w}</annotation></semantics></math> involves only the selected shards.</p>
</div>
<div id="S2.SS1.p5" class="ltx_para">
<p id="S2.SS1.p5.1" class="ltx_p">Of course, <span id="S2.SS1.p5.1.1" class="ltx_text ltx_font_typewriter">FedAvg</span> does not optimize the local parameters <math id="S2.SS1.p5.1.m1.1" class="ltx_Math" alttext="\bm{\phi}_{s}" display="inline"><semantics id="S2.SS1.p5.1.m1.1a"><msub id="S2.SS1.p5.1.m1.1.1" xref="S2.SS1.p5.1.m1.1.1.cmml"><mi class="ltx_mathvariant_bold-italic" mathvariant="bold-italic" id="S2.SS1.p5.1.m1.1.1.2" xref="S2.SS1.p5.1.m1.1.1.2.cmml">ϕ</mi><mi id="S2.SS1.p5.1.m1.1.1.3" xref="S2.SS1.p5.1.m1.1.1.3.cmml">s</mi></msub><annotation-xml encoding="MathML-Content" id="S2.SS1.p5.1.m1.1b"><apply id="S2.SS1.p5.1.m1.1.1.cmml" xref="S2.SS1.p5.1.m1.1.1"><csymbol cd="ambiguous" id="S2.SS1.p5.1.m1.1.1.1.cmml" xref="S2.SS1.p5.1.m1.1.1">subscript</csymbol><ci id="S2.SS1.p5.1.m1.1.1.2.cmml" xref="S2.SS1.p5.1.m1.1.1.2">bold-italic-ϕ</ci><ci id="S2.SS1.p5.1.m1.1.1.3.cmml" xref="S2.SS1.p5.1.m1.1.1.3">𝑠</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p5.1.m1.1c">\bm{\phi}_{s}</annotation></semantics></math> to convergence at each round, so one might wonder whether this correspondence is still valid. It turns out that the alternating procedure of EM corresponds to block coordinate ascent on a single objective function, the variational lower bound of the marginal log-likelihood <cite class="ltx_cite ltx_citemacro_citep">[<a href="#bib.bib24" title="" class="ltx_ref">24</a>]</cite> of a given model. More specifically for our setting, we can see that the EM iterations perform block coordinate ascent on:</p>
<table id="A10.EGx12" class="ltx_equationgroup ltx_eqn_align ltx_eqn_table">

<tbody id="S2.E12"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math id="S2.E12.m1.1" class="ltx_Math" alttext="\displaystyle\sum_{s}\mathbb{E}_{q_{\mathbf{w}_{s}}(\bm{\phi}_{s})}" display="inline"><semantics id="S2.E12.m1.1a"><mrow id="S2.E12.m1.1.2" xref="S2.E12.m1.1.2.cmml"><mstyle displaystyle="true" id="S2.E12.m1.1.2.1" xref="S2.E12.m1.1.2.1.cmml"><munder id="S2.E12.m1.1.2.1a" xref="S2.E12.m1.1.2.1.cmml"><mo movablelimits="false" id="S2.E12.m1.1.2.1.2" xref="S2.E12.m1.1.2.1.2.cmml">∑</mo><mi id="S2.E12.m1.1.2.1.3" xref="S2.E12.m1.1.2.1.3.cmml">s</mi></munder></mstyle><msub id="S2.E12.m1.1.2.2" xref="S2.E12.m1.1.2.2.cmml"><mi id="S2.E12.m1.1.2.2.2" xref="S2.E12.m1.1.2.2.2.cmml">𝔼</mi><mrow id="S2.E12.m1.1.1.1" xref="S2.E12.m1.1.1.1.cmml"><msub id="S2.E12.m1.1.1.1.3" xref="S2.E12.m1.1.1.1.3.cmml"><mi id="S2.E12.m1.1.1.1.3.2" xref="S2.E12.m1.1.1.1.3.2.cmml">q</mi><msub id="S2.E12.m1.1.1.1.3.3" xref="S2.E12.m1.1.1.1.3.3.cmml"><mi id="S2.E12.m1.1.1.1.3.3.2" xref="S2.E12.m1.1.1.1.3.3.2.cmml">𝐰</mi><mi id="S2.E12.m1.1.1.1.3.3.3" xref="S2.E12.m1.1.1.1.3.3.3.cmml">s</mi></msub></msub><mo lspace="0em" rspace="0em" id="S2.E12.m1.1.1.1.2" xref="S2.E12.m1.1.1.1.2.cmml">​</mo><mrow id="S2.E12.m1.1.1.1.1.1" xref="S2.E12.m1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S2.E12.m1.1.1.1.1.1.2" xref="S2.E12.m1.1.1.1.1.1.1.cmml">(</mo><msub id="S2.E12.m1.1.1.1.1.1.1" xref="S2.E12.m1.1.1.1.1.1.1.cmml"><mi class="ltx_mathvariant_bold-italic" mathvariant="bold-italic" id="S2.E12.m1.1.1.1.1.1.1.2" xref="S2.E12.m1.1.1.1.1.1.1.2.cmml">ϕ</mi><mi id="S2.E12.m1.1.1.1.1.1.1.3" xref="S2.E12.m1.1.1.1.1.1.1.3.cmml">s</mi></msub><mo stretchy="false" id="S2.E12.m1.1.1.1.1.1.3" xref="S2.E12.m1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></msub></mrow><annotation-xml encoding="MathML-Content" id="S2.E12.m1.1b"><apply id="S2.E12.m1.1.2.cmml" xref="S2.E12.m1.1.2"><apply id="S2.E12.m1.1.2.1.cmml" xref="S2.E12.m1.1.2.1"><csymbol cd="ambiguous" id="S2.E12.m1.1.2.1.1.cmml" xref="S2.E12.m1.1.2.1">subscript</csymbol><sum id="S2.E12.m1.1.2.1.2.cmml" xref="S2.E12.m1.1.2.1.2"></sum><ci id="S2.E12.m1.1.2.1.3.cmml" xref="S2.E12.m1.1.2.1.3">𝑠</ci></apply><apply id="S2.E12.m1.1.2.2.cmml" xref="S2.E12.m1.1.2.2"><csymbol cd="ambiguous" id="S2.E12.m1.1.2.2.1.cmml" xref="S2.E12.m1.1.2.2">subscript</csymbol><ci id="S2.E12.m1.1.2.2.2.cmml" xref="S2.E12.m1.1.2.2.2">𝔼</ci><apply id="S2.E12.m1.1.1.1.cmml" xref="S2.E12.m1.1.1.1"><times id="S2.E12.m1.1.1.1.2.cmml" xref="S2.E12.m1.1.1.1.2"></times><apply id="S2.E12.m1.1.1.1.3.cmml" xref="S2.E12.m1.1.1.1.3"><csymbol cd="ambiguous" id="S2.E12.m1.1.1.1.3.1.cmml" xref="S2.E12.m1.1.1.1.3">subscript</csymbol><ci id="S2.E12.m1.1.1.1.3.2.cmml" xref="S2.E12.m1.1.1.1.3.2">𝑞</ci><apply id="S2.E12.m1.1.1.1.3.3.cmml" xref="S2.E12.m1.1.1.1.3.3"><csymbol cd="ambiguous" id="S2.E12.m1.1.1.1.3.3.1.cmml" xref="S2.E12.m1.1.1.1.3.3">subscript</csymbol><ci id="S2.E12.m1.1.1.1.3.3.2.cmml" xref="S2.E12.m1.1.1.1.3.3.2">𝐰</ci><ci id="S2.E12.m1.1.1.1.3.3.3.cmml" xref="S2.E12.m1.1.1.1.3.3.3">𝑠</ci></apply></apply><apply id="S2.E12.m1.1.1.1.1.1.1.cmml" xref="S2.E12.m1.1.1.1.1.1"><csymbol cd="ambiguous" id="S2.E12.m1.1.1.1.1.1.1.1.cmml" xref="S2.E12.m1.1.1.1.1.1">subscript</csymbol><ci id="S2.E12.m1.1.1.1.1.1.1.2.cmml" xref="S2.E12.m1.1.1.1.1.1.1.2">bold-italic-ϕ</ci><ci id="S2.E12.m1.1.1.1.1.1.1.3.cmml" xref="S2.E12.m1.1.1.1.1.1.1.3">𝑠</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.E12.m1.1c">\displaystyle\sum_{s}\mathbb{E}_{q_{\mathbf{w}_{s}}(\bm{\phi}_{s})}</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math id="S2.E12.m2.2" class="ltx_Math" alttext="\displaystyle\big{[}\log p(\mathcal{D}_{s}|\bm{\phi}_{s})+\log p(\bm{\phi}_{s}|\mathbf{w})]+H[q_{\mathbf{w}_{s}}(\bm{\phi}_{s})]" display="inline"><semantics id="S2.E12.m2.2a"><mrow id="S2.E12.m2.2.2" xref="S2.E12.m2.2.2.cmml"><mrow id="S2.E12.m2.1.1.1.1" xref="S2.E12.m2.1.1.1.2.cmml"><mo maxsize="120%" minsize="120%" id="S2.E12.m2.1.1.1.1.2" xref="S2.E12.m2.1.1.1.2.1.cmml">[</mo><mrow id="S2.E12.m2.1.1.1.1.1" xref="S2.E12.m2.1.1.1.1.1.cmml"><mrow id="S2.E12.m2.1.1.1.1.1.1" xref="S2.E12.m2.1.1.1.1.1.1.cmml"><mrow id="S2.E12.m2.1.1.1.1.1.1.3" xref="S2.E12.m2.1.1.1.1.1.1.3.cmml"><mi id="S2.E12.m2.1.1.1.1.1.1.3.1" xref="S2.E12.m2.1.1.1.1.1.1.3.1.cmml">log</mi><mo lspace="0.167em" id="S2.E12.m2.1.1.1.1.1.1.3a" xref="S2.E12.m2.1.1.1.1.1.1.3.cmml">⁡</mo><mi id="S2.E12.m2.1.1.1.1.1.1.3.2" xref="S2.E12.m2.1.1.1.1.1.1.3.2.cmml">p</mi></mrow><mo lspace="0em" rspace="0em" id="S2.E12.m2.1.1.1.1.1.1.2" xref="S2.E12.m2.1.1.1.1.1.1.2.cmml">​</mo><mrow id="S2.E12.m2.1.1.1.1.1.1.1.1" xref="S2.E12.m2.1.1.1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S2.E12.m2.1.1.1.1.1.1.1.1.2" xref="S2.E12.m2.1.1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="S2.E12.m2.1.1.1.1.1.1.1.1.1" xref="S2.E12.m2.1.1.1.1.1.1.1.1.1.cmml"><msub id="S2.E12.m2.1.1.1.1.1.1.1.1.1.2" xref="S2.E12.m2.1.1.1.1.1.1.1.1.1.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S2.E12.m2.1.1.1.1.1.1.1.1.1.2.2" xref="S2.E12.m2.1.1.1.1.1.1.1.1.1.2.2.cmml">𝒟</mi><mi id="S2.E12.m2.1.1.1.1.1.1.1.1.1.2.3" xref="S2.E12.m2.1.1.1.1.1.1.1.1.1.2.3.cmml">s</mi></msub><mo fence="false" id="S2.E12.m2.1.1.1.1.1.1.1.1.1.1" xref="S2.E12.m2.1.1.1.1.1.1.1.1.1.1.cmml">|</mo><msub id="S2.E12.m2.1.1.1.1.1.1.1.1.1.3" xref="S2.E12.m2.1.1.1.1.1.1.1.1.1.3.cmml"><mi class="ltx_mathvariant_bold-italic" mathvariant="bold-italic" id="S2.E12.m2.1.1.1.1.1.1.1.1.1.3.2" xref="S2.E12.m2.1.1.1.1.1.1.1.1.1.3.2.cmml">ϕ</mi><mi id="S2.E12.m2.1.1.1.1.1.1.1.1.1.3.3" xref="S2.E12.m2.1.1.1.1.1.1.1.1.1.3.3.cmml">s</mi></msub></mrow><mo stretchy="false" id="S2.E12.m2.1.1.1.1.1.1.1.1.3" xref="S2.E12.m2.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S2.E12.m2.1.1.1.1.1.3" xref="S2.E12.m2.1.1.1.1.1.3.cmml">+</mo><mrow id="S2.E12.m2.1.1.1.1.1.2" xref="S2.E12.m2.1.1.1.1.1.2.cmml"><mrow id="S2.E12.m2.1.1.1.1.1.2.3" xref="S2.E12.m2.1.1.1.1.1.2.3.cmml"><mi id="S2.E12.m2.1.1.1.1.1.2.3.1" xref="S2.E12.m2.1.1.1.1.1.2.3.1.cmml">log</mi><mo lspace="0.167em" id="S2.E12.m2.1.1.1.1.1.2.3a" xref="S2.E12.m2.1.1.1.1.1.2.3.cmml">⁡</mo><mi id="S2.E12.m2.1.1.1.1.1.2.3.2" xref="S2.E12.m2.1.1.1.1.1.2.3.2.cmml">p</mi></mrow><mo lspace="0em" rspace="0em" id="S2.E12.m2.1.1.1.1.1.2.2" xref="S2.E12.m2.1.1.1.1.1.2.2.cmml">​</mo><mrow id="S2.E12.m2.1.1.1.1.1.2.1.1" xref="S2.E12.m2.1.1.1.1.1.2.1.1.1.cmml"><mo stretchy="false" id="S2.E12.m2.1.1.1.1.1.2.1.1.2" xref="S2.E12.m2.1.1.1.1.1.2.1.1.1.cmml">(</mo><mrow id="S2.E12.m2.1.1.1.1.1.2.1.1.1" xref="S2.E12.m2.1.1.1.1.1.2.1.1.1.cmml"><msub id="S2.E12.m2.1.1.1.1.1.2.1.1.1.2" xref="S2.E12.m2.1.1.1.1.1.2.1.1.1.2.cmml"><mi class="ltx_mathvariant_bold-italic" mathvariant="bold-italic" id="S2.E12.m2.1.1.1.1.1.2.1.1.1.2.2" xref="S2.E12.m2.1.1.1.1.1.2.1.1.1.2.2.cmml">ϕ</mi><mi id="S2.E12.m2.1.1.1.1.1.2.1.1.1.2.3" xref="S2.E12.m2.1.1.1.1.1.2.1.1.1.2.3.cmml">s</mi></msub><mo fence="false" id="S2.E12.m2.1.1.1.1.1.2.1.1.1.1" xref="S2.E12.m2.1.1.1.1.1.2.1.1.1.1.cmml">|</mo><mi id="S2.E12.m2.1.1.1.1.1.2.1.1.1.3" xref="S2.E12.m2.1.1.1.1.1.2.1.1.1.3.cmml">𝐰</mi></mrow><mo stretchy="false" id="S2.E12.m2.1.1.1.1.1.2.1.1.3" xref="S2.E12.m2.1.1.1.1.1.2.1.1.1.cmml">)</mo></mrow></mrow></mrow><mo stretchy="false" id="S2.E12.m2.1.1.1.1.3" xref="S2.E12.m2.1.1.1.2.1.cmml">]</mo></mrow><mo id="S2.E12.m2.2.2.3" xref="S2.E12.m2.2.2.3.cmml">+</mo><mrow id="S2.E12.m2.2.2.2" xref="S2.E12.m2.2.2.2.cmml"><mi id="S2.E12.m2.2.2.2.3" xref="S2.E12.m2.2.2.2.3.cmml">H</mi><mo lspace="0em" rspace="0em" id="S2.E12.m2.2.2.2.2" xref="S2.E12.m2.2.2.2.2.cmml">​</mo><mrow id="S2.E12.m2.2.2.2.1.1" xref="S2.E12.m2.2.2.2.1.2.cmml"><mo stretchy="false" id="S2.E12.m2.2.2.2.1.1.2" xref="S2.E12.m2.2.2.2.1.2.1.cmml">[</mo><mrow id="S2.E12.m2.2.2.2.1.1.1" xref="S2.E12.m2.2.2.2.1.1.1.cmml"><msub id="S2.E12.m2.2.2.2.1.1.1.3" xref="S2.E12.m2.2.2.2.1.1.1.3.cmml"><mi id="S2.E12.m2.2.2.2.1.1.1.3.2" xref="S2.E12.m2.2.2.2.1.1.1.3.2.cmml">q</mi><msub id="S2.E12.m2.2.2.2.1.1.1.3.3" xref="S2.E12.m2.2.2.2.1.1.1.3.3.cmml"><mi id="S2.E12.m2.2.2.2.1.1.1.3.3.2" xref="S2.E12.m2.2.2.2.1.1.1.3.3.2.cmml">𝐰</mi><mi id="S2.E12.m2.2.2.2.1.1.1.3.3.3" xref="S2.E12.m2.2.2.2.1.1.1.3.3.3.cmml">s</mi></msub></msub><mo lspace="0em" rspace="0em" id="S2.E12.m2.2.2.2.1.1.1.2" xref="S2.E12.m2.2.2.2.1.1.1.2.cmml">​</mo><mrow id="S2.E12.m2.2.2.2.1.1.1.1.1" xref="S2.E12.m2.2.2.2.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S2.E12.m2.2.2.2.1.1.1.1.1.2" xref="S2.E12.m2.2.2.2.1.1.1.1.1.1.cmml">(</mo><msub id="S2.E12.m2.2.2.2.1.1.1.1.1.1" xref="S2.E12.m2.2.2.2.1.1.1.1.1.1.cmml"><mi class="ltx_mathvariant_bold-italic" mathvariant="bold-italic" id="S2.E12.m2.2.2.2.1.1.1.1.1.1.2" xref="S2.E12.m2.2.2.2.1.1.1.1.1.1.2.cmml">ϕ</mi><mi id="S2.E12.m2.2.2.2.1.1.1.1.1.1.3" xref="S2.E12.m2.2.2.2.1.1.1.1.1.1.3.cmml">s</mi></msub><mo stretchy="false" id="S2.E12.m2.2.2.2.1.1.1.1.1.3" xref="S2.E12.m2.2.2.2.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo stretchy="false" id="S2.E12.m2.2.2.2.1.1.3" xref="S2.E12.m2.2.2.2.1.2.1.cmml">]</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.E12.m2.2b"><apply id="S2.E12.m2.2.2.cmml" xref="S2.E12.m2.2.2"><plus id="S2.E12.m2.2.2.3.cmml" xref="S2.E12.m2.2.2.3"></plus><apply id="S2.E12.m2.1.1.1.2.cmml" xref="S2.E12.m2.1.1.1.1"><csymbol cd="latexml" id="S2.E12.m2.1.1.1.2.1.cmml" xref="S2.E12.m2.1.1.1.1.2">delimited-[]</csymbol><apply id="S2.E12.m2.1.1.1.1.1.cmml" xref="S2.E12.m2.1.1.1.1.1"><plus id="S2.E12.m2.1.1.1.1.1.3.cmml" xref="S2.E12.m2.1.1.1.1.1.3"></plus><apply id="S2.E12.m2.1.1.1.1.1.1.cmml" xref="S2.E12.m2.1.1.1.1.1.1"><times id="S2.E12.m2.1.1.1.1.1.1.2.cmml" xref="S2.E12.m2.1.1.1.1.1.1.2"></times><apply id="S2.E12.m2.1.1.1.1.1.1.3.cmml" xref="S2.E12.m2.1.1.1.1.1.1.3"><log id="S2.E12.m2.1.1.1.1.1.1.3.1.cmml" xref="S2.E12.m2.1.1.1.1.1.1.3.1"></log><ci id="S2.E12.m2.1.1.1.1.1.1.3.2.cmml" xref="S2.E12.m2.1.1.1.1.1.1.3.2">𝑝</ci></apply><apply id="S2.E12.m2.1.1.1.1.1.1.1.1.1.cmml" xref="S2.E12.m2.1.1.1.1.1.1.1.1"><csymbol cd="latexml" id="S2.E12.m2.1.1.1.1.1.1.1.1.1.1.cmml" xref="S2.E12.m2.1.1.1.1.1.1.1.1.1.1">conditional</csymbol><apply id="S2.E12.m2.1.1.1.1.1.1.1.1.1.2.cmml" xref="S2.E12.m2.1.1.1.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S2.E12.m2.1.1.1.1.1.1.1.1.1.2.1.cmml" xref="S2.E12.m2.1.1.1.1.1.1.1.1.1.2">subscript</csymbol><ci id="S2.E12.m2.1.1.1.1.1.1.1.1.1.2.2.cmml" xref="S2.E12.m2.1.1.1.1.1.1.1.1.1.2.2">𝒟</ci><ci id="S2.E12.m2.1.1.1.1.1.1.1.1.1.2.3.cmml" xref="S2.E12.m2.1.1.1.1.1.1.1.1.1.2.3">𝑠</ci></apply><apply id="S2.E12.m2.1.1.1.1.1.1.1.1.1.3.cmml" xref="S2.E12.m2.1.1.1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S2.E12.m2.1.1.1.1.1.1.1.1.1.3.1.cmml" xref="S2.E12.m2.1.1.1.1.1.1.1.1.1.3">subscript</csymbol><ci id="S2.E12.m2.1.1.1.1.1.1.1.1.1.3.2.cmml" xref="S2.E12.m2.1.1.1.1.1.1.1.1.1.3.2">bold-italic-ϕ</ci><ci id="S2.E12.m2.1.1.1.1.1.1.1.1.1.3.3.cmml" xref="S2.E12.m2.1.1.1.1.1.1.1.1.1.3.3">𝑠</ci></apply></apply></apply><apply id="S2.E12.m2.1.1.1.1.1.2.cmml" xref="S2.E12.m2.1.1.1.1.1.2"><times id="S2.E12.m2.1.1.1.1.1.2.2.cmml" xref="S2.E12.m2.1.1.1.1.1.2.2"></times><apply id="S2.E12.m2.1.1.1.1.1.2.3.cmml" xref="S2.E12.m2.1.1.1.1.1.2.3"><log id="S2.E12.m2.1.1.1.1.1.2.3.1.cmml" xref="S2.E12.m2.1.1.1.1.1.2.3.1"></log><ci id="S2.E12.m2.1.1.1.1.1.2.3.2.cmml" xref="S2.E12.m2.1.1.1.1.1.2.3.2">𝑝</ci></apply><apply id="S2.E12.m2.1.1.1.1.1.2.1.1.1.cmml" xref="S2.E12.m2.1.1.1.1.1.2.1.1"><csymbol cd="latexml" id="S2.E12.m2.1.1.1.1.1.2.1.1.1.1.cmml" xref="S2.E12.m2.1.1.1.1.1.2.1.1.1.1">conditional</csymbol><apply id="S2.E12.m2.1.1.1.1.1.2.1.1.1.2.cmml" xref="S2.E12.m2.1.1.1.1.1.2.1.1.1.2"><csymbol cd="ambiguous" id="S2.E12.m2.1.1.1.1.1.2.1.1.1.2.1.cmml" xref="S2.E12.m2.1.1.1.1.1.2.1.1.1.2">subscript</csymbol><ci id="S2.E12.m2.1.1.1.1.1.2.1.1.1.2.2.cmml" xref="S2.E12.m2.1.1.1.1.1.2.1.1.1.2.2">bold-italic-ϕ</ci><ci id="S2.E12.m2.1.1.1.1.1.2.1.1.1.2.3.cmml" xref="S2.E12.m2.1.1.1.1.1.2.1.1.1.2.3">𝑠</ci></apply><ci id="S2.E12.m2.1.1.1.1.1.2.1.1.1.3.cmml" xref="S2.E12.m2.1.1.1.1.1.2.1.1.1.3">𝐰</ci></apply></apply></apply></apply><apply id="S2.E12.m2.2.2.2.cmml" xref="S2.E12.m2.2.2.2"><times id="S2.E12.m2.2.2.2.2.cmml" xref="S2.E12.m2.2.2.2.2"></times><ci id="S2.E12.m2.2.2.2.3.cmml" xref="S2.E12.m2.2.2.2.3">𝐻</ci><apply id="S2.E12.m2.2.2.2.1.2.cmml" xref="S2.E12.m2.2.2.2.1.1"><csymbol cd="latexml" id="S2.E12.m2.2.2.2.1.2.1.cmml" xref="S2.E12.m2.2.2.2.1.1.2">delimited-[]</csymbol><apply id="S2.E12.m2.2.2.2.1.1.1.cmml" xref="S2.E12.m2.2.2.2.1.1.1"><times id="S2.E12.m2.2.2.2.1.1.1.2.cmml" xref="S2.E12.m2.2.2.2.1.1.1.2"></times><apply id="S2.E12.m2.2.2.2.1.1.1.3.cmml" xref="S2.E12.m2.2.2.2.1.1.1.3"><csymbol cd="ambiguous" id="S2.E12.m2.2.2.2.1.1.1.3.1.cmml" xref="S2.E12.m2.2.2.2.1.1.1.3">subscript</csymbol><ci id="S2.E12.m2.2.2.2.1.1.1.3.2.cmml" xref="S2.E12.m2.2.2.2.1.1.1.3.2">𝑞</ci><apply id="S2.E12.m2.2.2.2.1.1.1.3.3.cmml" xref="S2.E12.m2.2.2.2.1.1.1.3.3"><csymbol cd="ambiguous" id="S2.E12.m2.2.2.2.1.1.1.3.3.1.cmml" xref="S2.E12.m2.2.2.2.1.1.1.3.3">subscript</csymbol><ci id="S2.E12.m2.2.2.2.1.1.1.3.3.2.cmml" xref="S2.E12.m2.2.2.2.1.1.1.3.3.2">𝐰</ci><ci id="S2.E12.m2.2.2.2.1.1.1.3.3.3.cmml" xref="S2.E12.m2.2.2.2.1.1.1.3.3.3">𝑠</ci></apply></apply><apply id="S2.E12.m2.2.2.2.1.1.1.1.1.1.cmml" xref="S2.E12.m2.2.2.2.1.1.1.1.1"><csymbol cd="ambiguous" id="S2.E12.m2.2.2.2.1.1.1.1.1.1.1.cmml" xref="S2.E12.m2.2.2.2.1.1.1.1.1">subscript</csymbol><ci id="S2.E12.m2.2.2.2.1.1.1.1.1.1.2.cmml" xref="S2.E12.m2.2.2.2.1.1.1.1.1.1.2">bold-italic-ϕ</ci><ci id="S2.E12.m2.2.2.2.1.1.1.1.1.1.3.cmml" xref="S2.E12.m2.2.2.2.1.1.1.1.1.1.3">𝑠</ci></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.E12.m2.2c">\displaystyle\big{[}\log p(\mathcal{D}_{s}|\bm{\phi}_{s})+\log p(\bm{\phi}_{s}|\mathbf{w})]+H[q_{\mathbf{w}_{s}}(\bm{\phi}_{s})]</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(12)</span></td>
</tr></tbody>
</table>
<p id="S2.SS1.p5.12" class="ltx_p">to optimize <math id="S2.SS1.p5.2.m1.1" class="ltx_Math" alttext="\mathbf{w}_{1:S}" display="inline"><semantics id="S2.SS1.p5.2.m1.1a"><msub id="S2.SS1.p5.2.m1.1.1" xref="S2.SS1.p5.2.m1.1.1.cmml"><mi id="S2.SS1.p5.2.m1.1.1.2" xref="S2.SS1.p5.2.m1.1.1.2.cmml">𝐰</mi><mrow id="S2.SS1.p5.2.m1.1.1.3" xref="S2.SS1.p5.2.m1.1.1.3.cmml"><mn id="S2.SS1.p5.2.m1.1.1.3.2" xref="S2.SS1.p5.2.m1.1.1.3.2.cmml">1</mn><mo lspace="0.278em" rspace="0.278em" id="S2.SS1.p5.2.m1.1.1.3.1" xref="S2.SS1.p5.2.m1.1.1.3.1.cmml">:</mo><mi id="S2.SS1.p5.2.m1.1.1.3.3" xref="S2.SS1.p5.2.m1.1.1.3.3.cmml">S</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S2.SS1.p5.2.m1.1b"><apply id="S2.SS1.p5.2.m1.1.1.cmml" xref="S2.SS1.p5.2.m1.1.1"><csymbol cd="ambiguous" id="S2.SS1.p5.2.m1.1.1.1.cmml" xref="S2.SS1.p5.2.m1.1.1">subscript</csymbol><ci id="S2.SS1.p5.2.m1.1.1.2.cmml" xref="S2.SS1.p5.2.m1.1.1.2">𝐰</ci><apply id="S2.SS1.p5.2.m1.1.1.3.cmml" xref="S2.SS1.p5.2.m1.1.1.3"><ci id="S2.SS1.p5.2.m1.1.1.3.1.cmml" xref="S2.SS1.p5.2.m1.1.1.3.1">:</ci><cn type="integer" id="S2.SS1.p5.2.m1.1.1.3.2.cmml" xref="S2.SS1.p5.2.m1.1.1.3.2">1</cn><ci id="S2.SS1.p5.2.m1.1.1.3.3.cmml" xref="S2.SS1.p5.2.m1.1.1.3.3">𝑆</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p5.2.m1.1c">\mathbf{w}_{1:S}</annotation></semantics></math> and <math id="S2.SS1.p5.3.m2.1" class="ltx_Math" alttext="\mathbf{w}" display="inline"><semantics id="S2.SS1.p5.3.m2.1a"><mi id="S2.SS1.p5.3.m2.1.1" xref="S2.SS1.p5.3.m2.1.1.cmml">𝐰</mi><annotation-xml encoding="MathML-Content" id="S2.SS1.p5.3.m2.1b"><ci id="S2.SS1.p5.3.m2.1.1.cmml" xref="S2.SS1.p5.3.m2.1.1">𝐰</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p5.3.m2.1c">\mathbf{w}</annotation></semantics></math>, where <math id="S2.SS1.p5.4.m3.1" class="ltx_Math" alttext="\mathbf{w}_{s}" display="inline"><semantics id="S2.SS1.p5.4.m3.1a"><msub id="S2.SS1.p5.4.m3.1.1" xref="S2.SS1.p5.4.m3.1.1.cmml"><mi id="S2.SS1.p5.4.m3.1.1.2" xref="S2.SS1.p5.4.m3.1.1.2.cmml">𝐰</mi><mi id="S2.SS1.p5.4.m3.1.1.3" xref="S2.SS1.p5.4.m3.1.1.3.cmml">s</mi></msub><annotation-xml encoding="MathML-Content" id="S2.SS1.p5.4.m3.1b"><apply id="S2.SS1.p5.4.m3.1.1.cmml" xref="S2.SS1.p5.4.m3.1.1"><csymbol cd="ambiguous" id="S2.SS1.p5.4.m3.1.1.1.cmml" xref="S2.SS1.p5.4.m3.1.1">subscript</csymbol><ci id="S2.SS1.p5.4.m3.1.1.2.cmml" xref="S2.SS1.p5.4.m3.1.1.2">𝐰</ci><ci id="S2.SS1.p5.4.m3.1.1.3.cmml" xref="S2.SS1.p5.4.m3.1.1.3">𝑠</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p5.4.m3.1c">\mathbf{w}_{s}</annotation></semantics></math> are the parameters of the variational approximation to the posterior distribution <math id="S2.SS1.p5.5.m4.2" class="ltx_Math" alttext="p(\bm{\phi}_{s}|\mathcal{D}_{s},\mathbf{w})" display="inline"><semantics id="S2.SS1.p5.5.m4.2a"><mrow id="S2.SS1.p5.5.m4.2.2" xref="S2.SS1.p5.5.m4.2.2.cmml"><mi id="S2.SS1.p5.5.m4.2.2.3" xref="S2.SS1.p5.5.m4.2.2.3.cmml">p</mi><mo lspace="0em" rspace="0em" id="S2.SS1.p5.5.m4.2.2.2" xref="S2.SS1.p5.5.m4.2.2.2.cmml">​</mo><mrow id="S2.SS1.p5.5.m4.2.2.1.1" xref="S2.SS1.p5.5.m4.2.2.1.1.1.cmml"><mo stretchy="false" id="S2.SS1.p5.5.m4.2.2.1.1.2" xref="S2.SS1.p5.5.m4.2.2.1.1.1.cmml">(</mo><mrow id="S2.SS1.p5.5.m4.2.2.1.1.1" xref="S2.SS1.p5.5.m4.2.2.1.1.1.cmml"><msub id="S2.SS1.p5.5.m4.2.2.1.1.1.3" xref="S2.SS1.p5.5.m4.2.2.1.1.1.3.cmml"><mi class="ltx_mathvariant_bold-italic" mathvariant="bold-italic" id="S2.SS1.p5.5.m4.2.2.1.1.1.3.2" xref="S2.SS1.p5.5.m4.2.2.1.1.1.3.2.cmml">ϕ</mi><mi id="S2.SS1.p5.5.m4.2.2.1.1.1.3.3" xref="S2.SS1.p5.5.m4.2.2.1.1.1.3.3.cmml">s</mi></msub><mo fence="false" id="S2.SS1.p5.5.m4.2.2.1.1.1.2" xref="S2.SS1.p5.5.m4.2.2.1.1.1.2.cmml">|</mo><mrow id="S2.SS1.p5.5.m4.2.2.1.1.1.1.1" xref="S2.SS1.p5.5.m4.2.2.1.1.1.1.2.cmml"><msub id="S2.SS1.p5.5.m4.2.2.1.1.1.1.1.1" xref="S2.SS1.p5.5.m4.2.2.1.1.1.1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S2.SS1.p5.5.m4.2.2.1.1.1.1.1.1.2" xref="S2.SS1.p5.5.m4.2.2.1.1.1.1.1.1.2.cmml">𝒟</mi><mi id="S2.SS1.p5.5.m4.2.2.1.1.1.1.1.1.3" xref="S2.SS1.p5.5.m4.2.2.1.1.1.1.1.1.3.cmml">s</mi></msub><mo id="S2.SS1.p5.5.m4.2.2.1.1.1.1.1.2" xref="S2.SS1.p5.5.m4.2.2.1.1.1.1.2.cmml">,</mo><mi id="S2.SS1.p5.5.m4.1.1" xref="S2.SS1.p5.5.m4.1.1.cmml">𝐰</mi></mrow></mrow><mo stretchy="false" id="S2.SS1.p5.5.m4.2.2.1.1.3" xref="S2.SS1.p5.5.m4.2.2.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.SS1.p5.5.m4.2b"><apply id="S2.SS1.p5.5.m4.2.2.cmml" xref="S2.SS1.p5.5.m4.2.2"><times id="S2.SS1.p5.5.m4.2.2.2.cmml" xref="S2.SS1.p5.5.m4.2.2.2"></times><ci id="S2.SS1.p5.5.m4.2.2.3.cmml" xref="S2.SS1.p5.5.m4.2.2.3">𝑝</ci><apply id="S2.SS1.p5.5.m4.2.2.1.1.1.cmml" xref="S2.SS1.p5.5.m4.2.2.1.1"><csymbol cd="latexml" id="S2.SS1.p5.5.m4.2.2.1.1.1.2.cmml" xref="S2.SS1.p5.5.m4.2.2.1.1.1.2">conditional</csymbol><apply id="S2.SS1.p5.5.m4.2.2.1.1.1.3.cmml" xref="S2.SS1.p5.5.m4.2.2.1.1.1.3"><csymbol cd="ambiguous" id="S2.SS1.p5.5.m4.2.2.1.1.1.3.1.cmml" xref="S2.SS1.p5.5.m4.2.2.1.1.1.3">subscript</csymbol><ci id="S2.SS1.p5.5.m4.2.2.1.1.1.3.2.cmml" xref="S2.SS1.p5.5.m4.2.2.1.1.1.3.2">bold-italic-ϕ</ci><ci id="S2.SS1.p5.5.m4.2.2.1.1.1.3.3.cmml" xref="S2.SS1.p5.5.m4.2.2.1.1.1.3.3">𝑠</ci></apply><list id="S2.SS1.p5.5.m4.2.2.1.1.1.1.2.cmml" xref="S2.SS1.p5.5.m4.2.2.1.1.1.1.1"><apply id="S2.SS1.p5.5.m4.2.2.1.1.1.1.1.1.cmml" xref="S2.SS1.p5.5.m4.2.2.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S2.SS1.p5.5.m4.2.2.1.1.1.1.1.1.1.cmml" xref="S2.SS1.p5.5.m4.2.2.1.1.1.1.1.1">subscript</csymbol><ci id="S2.SS1.p5.5.m4.2.2.1.1.1.1.1.1.2.cmml" xref="S2.SS1.p5.5.m4.2.2.1.1.1.1.1.1.2">𝒟</ci><ci id="S2.SS1.p5.5.m4.2.2.1.1.1.1.1.1.3.cmml" xref="S2.SS1.p5.5.m4.2.2.1.1.1.1.1.1.3">𝑠</ci></apply><ci id="S2.SS1.p5.5.m4.1.1.cmml" xref="S2.SS1.p5.5.m4.1.1">𝐰</ci></list></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p5.5.m4.2c">p(\bm{\phi}_{s}|\mathcal{D}_{s},\mathbf{w})</annotation></semantics></math> and <math id="S2.SS1.p5.6.m5.1" class="ltx_Math" alttext="H[q]" display="inline"><semantics id="S2.SS1.p5.6.m5.1a"><mrow id="S2.SS1.p5.6.m5.1.2" xref="S2.SS1.p5.6.m5.1.2.cmml"><mi id="S2.SS1.p5.6.m5.1.2.2" xref="S2.SS1.p5.6.m5.1.2.2.cmml">H</mi><mo lspace="0em" rspace="0em" id="S2.SS1.p5.6.m5.1.2.1" xref="S2.SS1.p5.6.m5.1.2.1.cmml">​</mo><mrow id="S2.SS1.p5.6.m5.1.2.3.2" xref="S2.SS1.p5.6.m5.1.2.3.1.cmml"><mo stretchy="false" id="S2.SS1.p5.6.m5.1.2.3.2.1" xref="S2.SS1.p5.6.m5.1.2.3.1.1.cmml">[</mo><mi id="S2.SS1.p5.6.m5.1.1" xref="S2.SS1.p5.6.m5.1.1.cmml">q</mi><mo stretchy="false" id="S2.SS1.p5.6.m5.1.2.3.2.2" xref="S2.SS1.p5.6.m5.1.2.3.1.1.cmml">]</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.SS1.p5.6.m5.1b"><apply id="S2.SS1.p5.6.m5.1.2.cmml" xref="S2.SS1.p5.6.m5.1.2"><times id="S2.SS1.p5.6.m5.1.2.1.cmml" xref="S2.SS1.p5.6.m5.1.2.1"></times><ci id="S2.SS1.p5.6.m5.1.2.2.cmml" xref="S2.SS1.p5.6.m5.1.2.2">𝐻</ci><apply id="S2.SS1.p5.6.m5.1.2.3.1.cmml" xref="S2.SS1.p5.6.m5.1.2.3.2"><csymbol cd="latexml" id="S2.SS1.p5.6.m5.1.2.3.1.1.cmml" xref="S2.SS1.p5.6.m5.1.2.3.2.1">delimited-[]</csymbol><ci id="S2.SS1.p5.6.m5.1.1.cmml" xref="S2.SS1.p5.6.m5.1.1">𝑞</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p5.6.m5.1c">H[q]</annotation></semantics></math> corresponds to the entropy of the <math id="S2.SS1.p5.7.m6.1" class="ltx_Math" alttext="q" display="inline"><semantics id="S2.SS1.p5.7.m6.1a"><mi id="S2.SS1.p5.7.m6.1.1" xref="S2.SS1.p5.7.m6.1.1.cmml">q</mi><annotation-xml encoding="MathML-Content" id="S2.SS1.p5.7.m6.1b"><ci id="S2.SS1.p5.7.m6.1.1.cmml" xref="S2.SS1.p5.7.m6.1.1">𝑞</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p5.7.m6.1c">q</annotation></semantics></math> distribution. To obtain the hard-EM procedure, and thus <span id="S2.SS1.p5.12.1" class="ltx_text ltx_font_typewriter">FedAvg</span>, we can use a (numerically) deterministic distribution for <math id="S2.SS1.p5.8.m7.1" class="ltx_Math" alttext="\bm{\phi}_{s}" display="inline"><semantics id="S2.SS1.p5.8.m7.1a"><msub id="S2.SS1.p5.8.m7.1.1" xref="S2.SS1.p5.8.m7.1.1.cmml"><mi class="ltx_mathvariant_bold-italic" mathvariant="bold-italic" id="S2.SS1.p5.8.m7.1.1.2" xref="S2.SS1.p5.8.m7.1.1.2.cmml">ϕ</mi><mi id="S2.SS1.p5.8.m7.1.1.3" xref="S2.SS1.p5.8.m7.1.1.3.cmml">s</mi></msub><annotation-xml encoding="MathML-Content" id="S2.SS1.p5.8.m7.1b"><apply id="S2.SS1.p5.8.m7.1.1.cmml" xref="S2.SS1.p5.8.m7.1.1"><csymbol cd="ambiguous" id="S2.SS1.p5.8.m7.1.1.1.cmml" xref="S2.SS1.p5.8.m7.1.1">subscript</csymbol><ci id="S2.SS1.p5.8.m7.1.1.2.cmml" xref="S2.SS1.p5.8.m7.1.1.2">bold-italic-ϕ</ci><ci id="S2.SS1.p5.8.m7.1.1.3.cmml" xref="S2.SS1.p5.8.m7.1.1.3">𝑠</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p5.8.m7.1c">\bm{\phi}_{s}</annotation></semantics></math>, <math id="S2.SS1.p5.9.m8.3" class="ltx_Math" alttext="q_{\mathbf{w}_{s}}(\bm{\phi}_{s}):=\mathcal{N}(\mathbf{w}_{s},\epsilon\mathbf{I})" display="inline"><semantics id="S2.SS1.p5.9.m8.3a"><mrow id="S2.SS1.p5.9.m8.3.3" xref="S2.SS1.p5.9.m8.3.3.cmml"><mrow id="S2.SS1.p5.9.m8.1.1.1" xref="S2.SS1.p5.9.m8.1.1.1.cmml"><msub id="S2.SS1.p5.9.m8.1.1.1.3" xref="S2.SS1.p5.9.m8.1.1.1.3.cmml"><mi id="S2.SS1.p5.9.m8.1.1.1.3.2" xref="S2.SS1.p5.9.m8.1.1.1.3.2.cmml">q</mi><msub id="S2.SS1.p5.9.m8.1.1.1.3.3" xref="S2.SS1.p5.9.m8.1.1.1.3.3.cmml"><mi id="S2.SS1.p5.9.m8.1.1.1.3.3.2" xref="S2.SS1.p5.9.m8.1.1.1.3.3.2.cmml">𝐰</mi><mi id="S2.SS1.p5.9.m8.1.1.1.3.3.3" xref="S2.SS1.p5.9.m8.1.1.1.3.3.3.cmml">s</mi></msub></msub><mo lspace="0em" rspace="0em" id="S2.SS1.p5.9.m8.1.1.1.2" xref="S2.SS1.p5.9.m8.1.1.1.2.cmml">​</mo><mrow id="S2.SS1.p5.9.m8.1.1.1.1.1" xref="S2.SS1.p5.9.m8.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S2.SS1.p5.9.m8.1.1.1.1.1.2" xref="S2.SS1.p5.9.m8.1.1.1.1.1.1.cmml">(</mo><msub id="S2.SS1.p5.9.m8.1.1.1.1.1.1" xref="S2.SS1.p5.9.m8.1.1.1.1.1.1.cmml"><mi class="ltx_mathvariant_bold-italic" mathvariant="bold-italic" id="S2.SS1.p5.9.m8.1.1.1.1.1.1.2" xref="S2.SS1.p5.9.m8.1.1.1.1.1.1.2.cmml">ϕ</mi><mi id="S2.SS1.p5.9.m8.1.1.1.1.1.1.3" xref="S2.SS1.p5.9.m8.1.1.1.1.1.1.3.cmml">s</mi></msub><mo rspace="0.278em" stretchy="false" id="S2.SS1.p5.9.m8.1.1.1.1.1.3" xref="S2.SS1.p5.9.m8.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo rspace="0.278em" id="S2.SS1.p5.9.m8.3.3.4" xref="S2.SS1.p5.9.m8.3.3.4.cmml">:=</mo><mrow id="S2.SS1.p5.9.m8.3.3.3" xref="S2.SS1.p5.9.m8.3.3.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S2.SS1.p5.9.m8.3.3.3.4" xref="S2.SS1.p5.9.m8.3.3.3.4.cmml">𝒩</mi><mo lspace="0em" rspace="0em" id="S2.SS1.p5.9.m8.3.3.3.3" xref="S2.SS1.p5.9.m8.3.3.3.3.cmml">​</mo><mrow id="S2.SS1.p5.9.m8.3.3.3.2.2" xref="S2.SS1.p5.9.m8.3.3.3.2.3.cmml"><mo stretchy="false" id="S2.SS1.p5.9.m8.3.3.3.2.2.3" xref="S2.SS1.p5.9.m8.3.3.3.2.3.cmml">(</mo><msub id="S2.SS1.p5.9.m8.2.2.2.1.1.1" xref="S2.SS1.p5.9.m8.2.2.2.1.1.1.cmml"><mi id="S2.SS1.p5.9.m8.2.2.2.1.1.1.2" xref="S2.SS1.p5.9.m8.2.2.2.1.1.1.2.cmml">𝐰</mi><mi id="S2.SS1.p5.9.m8.2.2.2.1.1.1.3" xref="S2.SS1.p5.9.m8.2.2.2.1.1.1.3.cmml">s</mi></msub><mo id="S2.SS1.p5.9.m8.3.3.3.2.2.4" xref="S2.SS1.p5.9.m8.3.3.3.2.3.cmml">,</mo><mrow id="S2.SS1.p5.9.m8.3.3.3.2.2.2" xref="S2.SS1.p5.9.m8.3.3.3.2.2.2.cmml"><mi id="S2.SS1.p5.9.m8.3.3.3.2.2.2.2" xref="S2.SS1.p5.9.m8.3.3.3.2.2.2.2.cmml">ϵ</mi><mo lspace="0em" rspace="0em" id="S2.SS1.p5.9.m8.3.3.3.2.2.2.1" xref="S2.SS1.p5.9.m8.3.3.3.2.2.2.1.cmml">​</mo><mi id="S2.SS1.p5.9.m8.3.3.3.2.2.2.3" xref="S2.SS1.p5.9.m8.3.3.3.2.2.2.3.cmml">𝐈</mi></mrow><mo stretchy="false" id="S2.SS1.p5.9.m8.3.3.3.2.2.5" xref="S2.SS1.p5.9.m8.3.3.3.2.3.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.SS1.p5.9.m8.3b"><apply id="S2.SS1.p5.9.m8.3.3.cmml" xref="S2.SS1.p5.9.m8.3.3"><csymbol cd="latexml" id="S2.SS1.p5.9.m8.3.3.4.cmml" xref="S2.SS1.p5.9.m8.3.3.4">assign</csymbol><apply id="S2.SS1.p5.9.m8.1.1.1.cmml" xref="S2.SS1.p5.9.m8.1.1.1"><times id="S2.SS1.p5.9.m8.1.1.1.2.cmml" xref="S2.SS1.p5.9.m8.1.1.1.2"></times><apply id="S2.SS1.p5.9.m8.1.1.1.3.cmml" xref="S2.SS1.p5.9.m8.1.1.1.3"><csymbol cd="ambiguous" id="S2.SS1.p5.9.m8.1.1.1.3.1.cmml" xref="S2.SS1.p5.9.m8.1.1.1.3">subscript</csymbol><ci id="S2.SS1.p5.9.m8.1.1.1.3.2.cmml" xref="S2.SS1.p5.9.m8.1.1.1.3.2">𝑞</ci><apply id="S2.SS1.p5.9.m8.1.1.1.3.3.cmml" xref="S2.SS1.p5.9.m8.1.1.1.3.3"><csymbol cd="ambiguous" id="S2.SS1.p5.9.m8.1.1.1.3.3.1.cmml" xref="S2.SS1.p5.9.m8.1.1.1.3.3">subscript</csymbol><ci id="S2.SS1.p5.9.m8.1.1.1.3.3.2.cmml" xref="S2.SS1.p5.9.m8.1.1.1.3.3.2">𝐰</ci><ci id="S2.SS1.p5.9.m8.1.1.1.3.3.3.cmml" xref="S2.SS1.p5.9.m8.1.1.1.3.3.3">𝑠</ci></apply></apply><apply id="S2.SS1.p5.9.m8.1.1.1.1.1.1.cmml" xref="S2.SS1.p5.9.m8.1.1.1.1.1"><csymbol cd="ambiguous" id="S2.SS1.p5.9.m8.1.1.1.1.1.1.1.cmml" xref="S2.SS1.p5.9.m8.1.1.1.1.1">subscript</csymbol><ci id="S2.SS1.p5.9.m8.1.1.1.1.1.1.2.cmml" xref="S2.SS1.p5.9.m8.1.1.1.1.1.1.2">bold-italic-ϕ</ci><ci id="S2.SS1.p5.9.m8.1.1.1.1.1.1.3.cmml" xref="S2.SS1.p5.9.m8.1.1.1.1.1.1.3">𝑠</ci></apply></apply><apply id="S2.SS1.p5.9.m8.3.3.3.cmml" xref="S2.SS1.p5.9.m8.3.3.3"><times id="S2.SS1.p5.9.m8.3.3.3.3.cmml" xref="S2.SS1.p5.9.m8.3.3.3.3"></times><ci id="S2.SS1.p5.9.m8.3.3.3.4.cmml" xref="S2.SS1.p5.9.m8.3.3.3.4">𝒩</ci><interval closure="open" id="S2.SS1.p5.9.m8.3.3.3.2.3.cmml" xref="S2.SS1.p5.9.m8.3.3.3.2.2"><apply id="S2.SS1.p5.9.m8.2.2.2.1.1.1.cmml" xref="S2.SS1.p5.9.m8.2.2.2.1.1.1"><csymbol cd="ambiguous" id="S2.SS1.p5.9.m8.2.2.2.1.1.1.1.cmml" xref="S2.SS1.p5.9.m8.2.2.2.1.1.1">subscript</csymbol><ci id="S2.SS1.p5.9.m8.2.2.2.1.1.1.2.cmml" xref="S2.SS1.p5.9.m8.2.2.2.1.1.1.2">𝐰</ci><ci id="S2.SS1.p5.9.m8.2.2.2.1.1.1.3.cmml" xref="S2.SS1.p5.9.m8.2.2.2.1.1.1.3">𝑠</ci></apply><apply id="S2.SS1.p5.9.m8.3.3.3.2.2.2.cmml" xref="S2.SS1.p5.9.m8.3.3.3.2.2.2"><times id="S2.SS1.p5.9.m8.3.3.3.2.2.2.1.cmml" xref="S2.SS1.p5.9.m8.3.3.3.2.2.2.1"></times><ci id="S2.SS1.p5.9.m8.3.3.3.2.2.2.2.cmml" xref="S2.SS1.p5.9.m8.3.3.3.2.2.2.2">italic-ϵ</ci><ci id="S2.SS1.p5.9.m8.3.3.3.2.2.2.3.cmml" xref="S2.SS1.p5.9.m8.3.3.3.2.2.2.3">𝐈</ci></apply></interval></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p5.9.m8.3c">q_{\mathbf{w}_{s}}(\bm{\phi}_{s}):=\mathcal{N}(\mathbf{w}_{s},\epsilon\mathbf{I})</annotation></semantics></math>. This leads us to the same objective as in Eq. <a href="#S2.E9" title="In 2.1 FedAvg as learning in a hierarchical model ‣ 2 A hierarchical model interpretation of federated learning ‣ An Expectation-Maximization Perspective on Federated Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">9</span></a>, since the expectation concentrates on a single term and the entropy of <math id="S2.SS1.p5.10.m9.1" class="ltx_Math" alttext="q_{\mathbf{w}_{s}}(\bm{\phi}_{s})" display="inline"><semantics id="S2.SS1.p5.10.m9.1a"><mrow id="S2.SS1.p5.10.m9.1.1" xref="S2.SS1.p5.10.m9.1.1.cmml"><msub id="S2.SS1.p5.10.m9.1.1.3" xref="S2.SS1.p5.10.m9.1.1.3.cmml"><mi id="S2.SS1.p5.10.m9.1.1.3.2" xref="S2.SS1.p5.10.m9.1.1.3.2.cmml">q</mi><msub id="S2.SS1.p5.10.m9.1.1.3.3" xref="S2.SS1.p5.10.m9.1.1.3.3.cmml"><mi id="S2.SS1.p5.10.m9.1.1.3.3.2" xref="S2.SS1.p5.10.m9.1.1.3.3.2.cmml">𝐰</mi><mi id="S2.SS1.p5.10.m9.1.1.3.3.3" xref="S2.SS1.p5.10.m9.1.1.3.3.3.cmml">s</mi></msub></msub><mo lspace="0em" rspace="0em" id="S2.SS1.p5.10.m9.1.1.2" xref="S2.SS1.p5.10.m9.1.1.2.cmml">​</mo><mrow id="S2.SS1.p5.10.m9.1.1.1.1" xref="S2.SS1.p5.10.m9.1.1.1.1.1.cmml"><mo stretchy="false" id="S2.SS1.p5.10.m9.1.1.1.1.2" xref="S2.SS1.p5.10.m9.1.1.1.1.1.cmml">(</mo><msub id="S2.SS1.p5.10.m9.1.1.1.1.1" xref="S2.SS1.p5.10.m9.1.1.1.1.1.cmml"><mi class="ltx_mathvariant_bold-italic" mathvariant="bold-italic" id="S2.SS1.p5.10.m9.1.1.1.1.1.2" xref="S2.SS1.p5.10.m9.1.1.1.1.1.2.cmml">ϕ</mi><mi id="S2.SS1.p5.10.m9.1.1.1.1.1.3" xref="S2.SS1.p5.10.m9.1.1.1.1.1.3.cmml">s</mi></msub><mo stretchy="false" id="S2.SS1.p5.10.m9.1.1.1.1.3" xref="S2.SS1.p5.10.m9.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.SS1.p5.10.m9.1b"><apply id="S2.SS1.p5.10.m9.1.1.cmml" xref="S2.SS1.p5.10.m9.1.1"><times id="S2.SS1.p5.10.m9.1.1.2.cmml" xref="S2.SS1.p5.10.m9.1.1.2"></times><apply id="S2.SS1.p5.10.m9.1.1.3.cmml" xref="S2.SS1.p5.10.m9.1.1.3"><csymbol cd="ambiguous" id="S2.SS1.p5.10.m9.1.1.3.1.cmml" xref="S2.SS1.p5.10.m9.1.1.3">subscript</csymbol><ci id="S2.SS1.p5.10.m9.1.1.3.2.cmml" xref="S2.SS1.p5.10.m9.1.1.3.2">𝑞</ci><apply id="S2.SS1.p5.10.m9.1.1.3.3.cmml" xref="S2.SS1.p5.10.m9.1.1.3.3"><csymbol cd="ambiguous" id="S2.SS1.p5.10.m9.1.1.3.3.1.cmml" xref="S2.SS1.p5.10.m9.1.1.3.3">subscript</csymbol><ci id="S2.SS1.p5.10.m9.1.1.3.3.2.cmml" xref="S2.SS1.p5.10.m9.1.1.3.3.2">𝐰</ci><ci id="S2.SS1.p5.10.m9.1.1.3.3.3.cmml" xref="S2.SS1.p5.10.m9.1.1.3.3.3">𝑠</ci></apply></apply><apply id="S2.SS1.p5.10.m9.1.1.1.1.1.cmml" xref="S2.SS1.p5.10.m9.1.1.1.1"><csymbol cd="ambiguous" id="S2.SS1.p5.10.m9.1.1.1.1.1.1.cmml" xref="S2.SS1.p5.10.m9.1.1.1.1">subscript</csymbol><ci id="S2.SS1.p5.10.m9.1.1.1.1.1.2.cmml" xref="S2.SS1.p5.10.m9.1.1.1.1.1.2">bold-italic-ϕ</ci><ci id="S2.SS1.p5.10.m9.1.1.1.1.1.3.cmml" xref="S2.SS1.p5.10.m9.1.1.1.1.1.3">𝑠</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p5.10.m9.1c">q_{\mathbf{w}_{s}}(\bm{\phi}_{s})</annotation></semantics></math> becomes a constant independent of the optimization. In this case, the optimized value for <math id="S2.SS1.p5.11.m10.1" class="ltx_Math" alttext="\bm{\phi}_{s}" display="inline"><semantics id="S2.SS1.p5.11.m10.1a"><msub id="S2.SS1.p5.11.m10.1.1" xref="S2.SS1.p5.11.m10.1.1.cmml"><mi class="ltx_mathvariant_bold-italic" mathvariant="bold-italic" id="S2.SS1.p5.11.m10.1.1.2" xref="S2.SS1.p5.11.m10.1.1.2.cmml">ϕ</mi><mi id="S2.SS1.p5.11.m10.1.1.3" xref="S2.SS1.p5.11.m10.1.1.3.cmml">s</mi></msub><annotation-xml encoding="MathML-Content" id="S2.SS1.p5.11.m10.1b"><apply id="S2.SS1.p5.11.m10.1.1.cmml" xref="S2.SS1.p5.11.m10.1.1"><csymbol cd="ambiguous" id="S2.SS1.p5.11.m10.1.1.1.cmml" xref="S2.SS1.p5.11.m10.1.1">subscript</csymbol><ci id="S2.SS1.p5.11.m10.1.1.2.cmml" xref="S2.SS1.p5.11.m10.1.1.2">bold-italic-ϕ</ci><ci id="S2.SS1.p5.11.m10.1.1.3.cmml" xref="S2.SS1.p5.11.m10.1.1.3">𝑠</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p5.11.m10.1c">\bm{\phi}_{s}</annotation></semantics></math> after a fixed number of steps corresponds to the <math id="S2.SS1.p5.12.m11.1" class="ltx_Math" alttext="\mathbf{w}_{s}" display="inline"><semantics id="S2.SS1.p5.12.m11.1a"><msub id="S2.SS1.p5.12.m11.1.1" xref="S2.SS1.p5.12.m11.1.1.cmml"><mi id="S2.SS1.p5.12.m11.1.1.2" xref="S2.SS1.p5.12.m11.1.1.2.cmml">𝐰</mi><mi id="S2.SS1.p5.12.m11.1.1.3" xref="S2.SS1.p5.12.m11.1.1.3.cmml">s</mi></msub><annotation-xml encoding="MathML-Content" id="S2.SS1.p5.12.m11.1b"><apply id="S2.SS1.p5.12.m11.1.1.cmml" xref="S2.SS1.p5.12.m11.1.1"><csymbol cd="ambiguous" id="S2.SS1.p5.12.m11.1.1.1.cmml" xref="S2.SS1.p5.12.m11.1.1">subscript</csymbol><ci id="S2.SS1.p5.12.m11.1.1.2.cmml" xref="S2.SS1.p5.12.m11.1.1.2">𝐰</ci><ci id="S2.SS1.p5.12.m11.1.1.3.cmml" xref="S2.SS1.p5.12.m11.1.1.3">𝑠</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p5.12.m11.1c">\mathbf{w}_{s}</annotation></semantics></math> of the variational approximation.</p>
</div>
<div id="S2.SS1.p6" class="ltx_para">
<p id="S2.SS1.p6.2" class="ltx_p">It is interesting to contrast recent literature under the lens of this procedure. Optimizing the same model with hard-EM but with a non-trivial <math id="S2.SS1.p6.1.m1.1" class="ltx_Math" alttext="\lambda" display="inline"><semantics id="S2.SS1.p6.1.m1.1a"><mi id="S2.SS1.p6.1.m1.1.1" xref="S2.SS1.p6.1.m1.1.1.cmml">λ</mi><annotation-xml encoding="MathML-Content" id="S2.SS1.p6.1.m1.1b"><ci id="S2.SS1.p6.1.m1.1.1.cmml" xref="S2.SS1.p6.1.m1.1.1">𝜆</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p6.1.m1.1c">\lambda</annotation></semantics></math> results in the same procedure that was proposed by <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib18" title="" class="ltx_ref">18</a>]</cite>. Furthermore, using the difference of the local parameters to the global parameters as a “gradient” <cite class="ltx_cite ltx_citemacro_citep">[<a href="#bib.bib28" title="" class="ltx_ref">28</a>]</cite> is equivalent to hard-EM on the same model, where in the M-step, instead of a closed-form update, we take a single gradient step and absorb the scaling <math id="S2.SS1.p6.2.m2.1" class="ltx_Math" alttext="\lambda" display="inline"><semantics id="S2.SS1.p6.2.m2.1a"><mi id="S2.SS1.p6.2.m2.1.1" xref="S2.SS1.p6.2.m2.1.1.cmml">λ</mi><annotation-xml encoding="MathML-Content" id="S2.SS1.p6.2.m2.1b"><ci id="S2.SS1.p6.2.m2.1.1.cmml" xref="S2.SS1.p6.2.m2.1.1">𝜆</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p6.2.m2.1c">\lambda</annotation></semantics></math> in the learning rate. In addition, this view makes precise the idea that <span id="S2.SS1.p6.2.1" class="ltx_text ltx_font_typewriter">FedAvg</span> is a meta-learning algorithm <cite class="ltx_cite ltx_citemacro_citep">[<a href="#bib.bib13" title="" class="ltx_ref">13</a>]</cite>; the underlying hierarchical model it optimizes is similar to the ones used in meta-learning <cite class="ltx_cite ltx_citemacro_citep">[<a href="#bib.bib10" title="" class="ltx_ref">10</a>, <a href="#bib.bib6" title="" class="ltx_ref">6</a>]</cite>.</p>
</div>
<div id="S2.SS1.p7" class="ltx_para">
<p id="S2.SS1.p7.2" class="ltx_p">Besides connecting recent work in FL, this view also serves as a good basis for new algorithms for federated learning.
The most straightforward way is to use an alternative prior in the hierarchical model, resulting in different local training and server-side updating behaviors. For example, one could use a Laplace prior, <math id="S2.SS1.p7.1.m1.3" class="ltx_Math" alttext="p(\bm{\phi}_{s}|\mathbf{w})=\text{Lap}(\mathbf{w},\frac{1}{\lambda})" display="inline"><semantics id="S2.SS1.p7.1.m1.3a"><mrow id="S2.SS1.p7.1.m1.3.3" xref="S2.SS1.p7.1.m1.3.3.cmml"><mrow id="S2.SS1.p7.1.m1.3.3.1" xref="S2.SS1.p7.1.m1.3.3.1.cmml"><mi id="S2.SS1.p7.1.m1.3.3.1.3" xref="S2.SS1.p7.1.m1.3.3.1.3.cmml">p</mi><mo lspace="0em" rspace="0em" id="S2.SS1.p7.1.m1.3.3.1.2" xref="S2.SS1.p7.1.m1.3.3.1.2.cmml">​</mo><mrow id="S2.SS1.p7.1.m1.3.3.1.1.1" xref="S2.SS1.p7.1.m1.3.3.1.1.1.1.cmml"><mo stretchy="false" id="S2.SS1.p7.1.m1.3.3.1.1.1.2" xref="S2.SS1.p7.1.m1.3.3.1.1.1.1.cmml">(</mo><mrow id="S2.SS1.p7.1.m1.3.3.1.1.1.1" xref="S2.SS1.p7.1.m1.3.3.1.1.1.1.cmml"><msub id="S2.SS1.p7.1.m1.3.3.1.1.1.1.2" xref="S2.SS1.p7.1.m1.3.3.1.1.1.1.2.cmml"><mi class="ltx_mathvariant_bold-italic" mathvariant="bold-italic" id="S2.SS1.p7.1.m1.3.3.1.1.1.1.2.2" xref="S2.SS1.p7.1.m1.3.3.1.1.1.1.2.2.cmml">ϕ</mi><mi id="S2.SS1.p7.1.m1.3.3.1.1.1.1.2.3" xref="S2.SS1.p7.1.m1.3.3.1.1.1.1.2.3.cmml">s</mi></msub><mo fence="false" id="S2.SS1.p7.1.m1.3.3.1.1.1.1.1" xref="S2.SS1.p7.1.m1.3.3.1.1.1.1.1.cmml">|</mo><mi id="S2.SS1.p7.1.m1.3.3.1.1.1.1.3" xref="S2.SS1.p7.1.m1.3.3.1.1.1.1.3.cmml">𝐰</mi></mrow><mo stretchy="false" id="S2.SS1.p7.1.m1.3.3.1.1.1.3" xref="S2.SS1.p7.1.m1.3.3.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S2.SS1.p7.1.m1.3.3.2" xref="S2.SS1.p7.1.m1.3.3.2.cmml">=</mo><mrow id="S2.SS1.p7.1.m1.3.3.3" xref="S2.SS1.p7.1.m1.3.3.3.cmml"><mtext id="S2.SS1.p7.1.m1.3.3.3.2" xref="S2.SS1.p7.1.m1.3.3.3.2a.cmml">Lap</mtext><mo lspace="0em" rspace="0em" id="S2.SS1.p7.1.m1.3.3.3.1" xref="S2.SS1.p7.1.m1.3.3.3.1.cmml">​</mo><mrow id="S2.SS1.p7.1.m1.3.3.3.3.2" xref="S2.SS1.p7.1.m1.3.3.3.3.1.cmml"><mo stretchy="false" id="S2.SS1.p7.1.m1.3.3.3.3.2.1" xref="S2.SS1.p7.1.m1.3.3.3.3.1.cmml">(</mo><mi id="S2.SS1.p7.1.m1.1.1" xref="S2.SS1.p7.1.m1.1.1.cmml">𝐰</mi><mo id="S2.SS1.p7.1.m1.3.3.3.3.2.2" xref="S2.SS1.p7.1.m1.3.3.3.3.1.cmml">,</mo><mfrac id="S2.SS1.p7.1.m1.2.2" xref="S2.SS1.p7.1.m1.2.2.cmml"><mn id="S2.SS1.p7.1.m1.2.2.2" xref="S2.SS1.p7.1.m1.2.2.2.cmml">1</mn><mi id="S2.SS1.p7.1.m1.2.2.3" xref="S2.SS1.p7.1.m1.2.2.3.cmml">λ</mi></mfrac><mo stretchy="false" id="S2.SS1.p7.1.m1.3.3.3.3.2.3" xref="S2.SS1.p7.1.m1.3.3.3.3.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.SS1.p7.1.m1.3b"><apply id="S2.SS1.p7.1.m1.3.3.cmml" xref="S2.SS1.p7.1.m1.3.3"><eq id="S2.SS1.p7.1.m1.3.3.2.cmml" xref="S2.SS1.p7.1.m1.3.3.2"></eq><apply id="S2.SS1.p7.1.m1.3.3.1.cmml" xref="S2.SS1.p7.1.m1.3.3.1"><times id="S2.SS1.p7.1.m1.3.3.1.2.cmml" xref="S2.SS1.p7.1.m1.3.3.1.2"></times><ci id="S2.SS1.p7.1.m1.3.3.1.3.cmml" xref="S2.SS1.p7.1.m1.3.3.1.3">𝑝</ci><apply id="S2.SS1.p7.1.m1.3.3.1.1.1.1.cmml" xref="S2.SS1.p7.1.m1.3.3.1.1.1"><csymbol cd="latexml" id="S2.SS1.p7.1.m1.3.3.1.1.1.1.1.cmml" xref="S2.SS1.p7.1.m1.3.3.1.1.1.1.1">conditional</csymbol><apply id="S2.SS1.p7.1.m1.3.3.1.1.1.1.2.cmml" xref="S2.SS1.p7.1.m1.3.3.1.1.1.1.2"><csymbol cd="ambiguous" id="S2.SS1.p7.1.m1.3.3.1.1.1.1.2.1.cmml" xref="S2.SS1.p7.1.m1.3.3.1.1.1.1.2">subscript</csymbol><ci id="S2.SS1.p7.1.m1.3.3.1.1.1.1.2.2.cmml" xref="S2.SS1.p7.1.m1.3.3.1.1.1.1.2.2">bold-italic-ϕ</ci><ci id="S2.SS1.p7.1.m1.3.3.1.1.1.1.2.3.cmml" xref="S2.SS1.p7.1.m1.3.3.1.1.1.1.2.3">𝑠</ci></apply><ci id="S2.SS1.p7.1.m1.3.3.1.1.1.1.3.cmml" xref="S2.SS1.p7.1.m1.3.3.1.1.1.1.3">𝐰</ci></apply></apply><apply id="S2.SS1.p7.1.m1.3.3.3.cmml" xref="S2.SS1.p7.1.m1.3.3.3"><times id="S2.SS1.p7.1.m1.3.3.3.1.cmml" xref="S2.SS1.p7.1.m1.3.3.3.1"></times><ci id="S2.SS1.p7.1.m1.3.3.3.2a.cmml" xref="S2.SS1.p7.1.m1.3.3.3.2"><mtext id="S2.SS1.p7.1.m1.3.3.3.2.cmml" xref="S2.SS1.p7.1.m1.3.3.3.2">Lap</mtext></ci><interval closure="open" id="S2.SS1.p7.1.m1.3.3.3.3.1.cmml" xref="S2.SS1.p7.1.m1.3.3.3.3.2"><ci id="S2.SS1.p7.1.m1.1.1.cmml" xref="S2.SS1.p7.1.m1.1.1">𝐰</ci><apply id="S2.SS1.p7.1.m1.2.2.cmml" xref="S2.SS1.p7.1.m1.2.2"><divide id="S2.SS1.p7.1.m1.2.2.1.cmml" xref="S2.SS1.p7.1.m1.2.2"></divide><cn type="integer" id="S2.SS1.p7.1.m1.2.2.2.cmml" xref="S2.SS1.p7.1.m1.2.2.2">1</cn><ci id="S2.SS1.p7.1.m1.2.2.3.cmml" xref="S2.SS1.p7.1.m1.2.2.3">𝜆</ci></apply></interval></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p7.1.m1.3c">p(\bm{\phi}_{s}|\mathbf{w})=\text{Lap}(\mathbf{w},\frac{1}{\lambda})</annotation></semantics></math>, which would result into the server selecting the median instead of averaging, or a mixture of Gaussians prior, <math id="S2.SS1.p7.2.m2.4" class="ltx_Math" alttext="p(\bm{\phi}_{s}|\mathbf{w}_{1:K},\frac{1}{\lambda})=\frac{1}{K}\sum_{k}N(\mathbf{w}_{k},\frac{1}{\lambda})" display="inline"><semantics id="S2.SS1.p7.2.m2.4a"><mrow id="S2.SS1.p7.2.m2.4.4" xref="S2.SS1.p7.2.m2.4.4.cmml"><mrow id="S2.SS1.p7.2.m2.3.3.1" xref="S2.SS1.p7.2.m2.3.3.1.cmml"><mi id="S2.SS1.p7.2.m2.3.3.1.3" xref="S2.SS1.p7.2.m2.3.3.1.3.cmml">p</mi><mo lspace="0em" rspace="0em" id="S2.SS1.p7.2.m2.3.3.1.2" xref="S2.SS1.p7.2.m2.3.3.1.2.cmml">​</mo><mrow id="S2.SS1.p7.2.m2.3.3.1.1.1" xref="S2.SS1.p7.2.m2.3.3.1.1.1.1.cmml"><mo stretchy="false" id="S2.SS1.p7.2.m2.3.3.1.1.1.2" xref="S2.SS1.p7.2.m2.3.3.1.1.1.1.cmml">(</mo><mrow id="S2.SS1.p7.2.m2.3.3.1.1.1.1" xref="S2.SS1.p7.2.m2.3.3.1.1.1.1.cmml"><msub id="S2.SS1.p7.2.m2.3.3.1.1.1.1.3" xref="S2.SS1.p7.2.m2.3.3.1.1.1.1.3.cmml"><mi class="ltx_mathvariant_bold-italic" mathvariant="bold-italic" id="S2.SS1.p7.2.m2.3.3.1.1.1.1.3.2" xref="S2.SS1.p7.2.m2.3.3.1.1.1.1.3.2.cmml">ϕ</mi><mi id="S2.SS1.p7.2.m2.3.3.1.1.1.1.3.3" xref="S2.SS1.p7.2.m2.3.3.1.1.1.1.3.3.cmml">s</mi></msub><mo fence="false" id="S2.SS1.p7.2.m2.3.3.1.1.1.1.2" xref="S2.SS1.p7.2.m2.3.3.1.1.1.1.2.cmml">|</mo><mrow id="S2.SS1.p7.2.m2.3.3.1.1.1.1.1.1" xref="S2.SS1.p7.2.m2.3.3.1.1.1.1.1.2.cmml"><msub id="S2.SS1.p7.2.m2.3.3.1.1.1.1.1.1.1" xref="S2.SS1.p7.2.m2.3.3.1.1.1.1.1.1.1.cmml"><mi id="S2.SS1.p7.2.m2.3.3.1.1.1.1.1.1.1.2" xref="S2.SS1.p7.2.m2.3.3.1.1.1.1.1.1.1.2.cmml">𝐰</mi><mrow id="S2.SS1.p7.2.m2.3.3.1.1.1.1.1.1.1.3" xref="S2.SS1.p7.2.m2.3.3.1.1.1.1.1.1.1.3.cmml"><mn id="S2.SS1.p7.2.m2.3.3.1.1.1.1.1.1.1.3.2" xref="S2.SS1.p7.2.m2.3.3.1.1.1.1.1.1.1.3.2.cmml">1</mn><mo lspace="0.278em" rspace="0.278em" id="S2.SS1.p7.2.m2.3.3.1.1.1.1.1.1.1.3.1" xref="S2.SS1.p7.2.m2.3.3.1.1.1.1.1.1.1.3.1.cmml">:</mo><mi id="S2.SS1.p7.2.m2.3.3.1.1.1.1.1.1.1.3.3" xref="S2.SS1.p7.2.m2.3.3.1.1.1.1.1.1.1.3.3.cmml">K</mi></mrow></msub><mo id="S2.SS1.p7.2.m2.3.3.1.1.1.1.1.1.2" xref="S2.SS1.p7.2.m2.3.3.1.1.1.1.1.2.cmml">,</mo><mfrac id="S2.SS1.p7.2.m2.1.1" xref="S2.SS1.p7.2.m2.1.1.cmml"><mn id="S2.SS1.p7.2.m2.1.1.2" xref="S2.SS1.p7.2.m2.1.1.2.cmml">1</mn><mi id="S2.SS1.p7.2.m2.1.1.3" xref="S2.SS1.p7.2.m2.1.1.3.cmml">λ</mi></mfrac></mrow></mrow><mo stretchy="false" id="S2.SS1.p7.2.m2.3.3.1.1.1.3" xref="S2.SS1.p7.2.m2.3.3.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S2.SS1.p7.2.m2.4.4.3" xref="S2.SS1.p7.2.m2.4.4.3.cmml">=</mo><mrow id="S2.SS1.p7.2.m2.4.4.2" xref="S2.SS1.p7.2.m2.4.4.2.cmml"><mfrac id="S2.SS1.p7.2.m2.4.4.2.3" xref="S2.SS1.p7.2.m2.4.4.2.3.cmml"><mn id="S2.SS1.p7.2.m2.4.4.2.3.2" xref="S2.SS1.p7.2.m2.4.4.2.3.2.cmml">1</mn><mi id="S2.SS1.p7.2.m2.4.4.2.3.3" xref="S2.SS1.p7.2.m2.4.4.2.3.3.cmml">K</mi></mfrac><mo lspace="0em" rspace="0em" id="S2.SS1.p7.2.m2.4.4.2.2" xref="S2.SS1.p7.2.m2.4.4.2.2.cmml">​</mo><mrow id="S2.SS1.p7.2.m2.4.4.2.1" xref="S2.SS1.p7.2.m2.4.4.2.1.cmml"><msub id="S2.SS1.p7.2.m2.4.4.2.1.2" xref="S2.SS1.p7.2.m2.4.4.2.1.2.cmml"><mo id="S2.SS1.p7.2.m2.4.4.2.1.2.2" xref="S2.SS1.p7.2.m2.4.4.2.1.2.2.cmml">∑</mo><mi id="S2.SS1.p7.2.m2.4.4.2.1.2.3" xref="S2.SS1.p7.2.m2.4.4.2.1.2.3.cmml">k</mi></msub><mrow id="S2.SS1.p7.2.m2.4.4.2.1.1" xref="S2.SS1.p7.2.m2.4.4.2.1.1.cmml"><mi id="S2.SS1.p7.2.m2.4.4.2.1.1.3" xref="S2.SS1.p7.2.m2.4.4.2.1.1.3.cmml">N</mi><mo lspace="0em" rspace="0em" id="S2.SS1.p7.2.m2.4.4.2.1.1.2" xref="S2.SS1.p7.2.m2.4.4.2.1.1.2.cmml">​</mo><mrow id="S2.SS1.p7.2.m2.4.4.2.1.1.1.1" xref="S2.SS1.p7.2.m2.4.4.2.1.1.1.2.cmml"><mo stretchy="false" id="S2.SS1.p7.2.m2.4.4.2.1.1.1.1.2" xref="S2.SS1.p7.2.m2.4.4.2.1.1.1.2.cmml">(</mo><msub id="S2.SS1.p7.2.m2.4.4.2.1.1.1.1.1" xref="S2.SS1.p7.2.m2.4.4.2.1.1.1.1.1.cmml"><mi id="S2.SS1.p7.2.m2.4.4.2.1.1.1.1.1.2" xref="S2.SS1.p7.2.m2.4.4.2.1.1.1.1.1.2.cmml">𝐰</mi><mi id="S2.SS1.p7.2.m2.4.4.2.1.1.1.1.1.3" xref="S2.SS1.p7.2.m2.4.4.2.1.1.1.1.1.3.cmml">k</mi></msub><mo id="S2.SS1.p7.2.m2.4.4.2.1.1.1.1.3" xref="S2.SS1.p7.2.m2.4.4.2.1.1.1.2.cmml">,</mo><mfrac id="S2.SS1.p7.2.m2.2.2" xref="S2.SS1.p7.2.m2.2.2.cmml"><mn id="S2.SS1.p7.2.m2.2.2.2" xref="S2.SS1.p7.2.m2.2.2.2.cmml">1</mn><mi id="S2.SS1.p7.2.m2.2.2.3" xref="S2.SS1.p7.2.m2.2.2.3.cmml">λ</mi></mfrac><mo stretchy="false" id="S2.SS1.p7.2.m2.4.4.2.1.1.1.1.4" xref="S2.SS1.p7.2.m2.4.4.2.1.1.1.2.cmml">)</mo></mrow></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.SS1.p7.2.m2.4b"><apply id="S2.SS1.p7.2.m2.4.4.cmml" xref="S2.SS1.p7.2.m2.4.4"><eq id="S2.SS1.p7.2.m2.4.4.3.cmml" xref="S2.SS1.p7.2.m2.4.4.3"></eq><apply id="S2.SS1.p7.2.m2.3.3.1.cmml" xref="S2.SS1.p7.2.m2.3.3.1"><times id="S2.SS1.p7.2.m2.3.3.1.2.cmml" xref="S2.SS1.p7.2.m2.3.3.1.2"></times><ci id="S2.SS1.p7.2.m2.3.3.1.3.cmml" xref="S2.SS1.p7.2.m2.3.3.1.3">𝑝</ci><apply id="S2.SS1.p7.2.m2.3.3.1.1.1.1.cmml" xref="S2.SS1.p7.2.m2.3.3.1.1.1"><csymbol cd="latexml" id="S2.SS1.p7.2.m2.3.3.1.1.1.1.2.cmml" xref="S2.SS1.p7.2.m2.3.3.1.1.1.1.2">conditional</csymbol><apply id="S2.SS1.p7.2.m2.3.3.1.1.1.1.3.cmml" xref="S2.SS1.p7.2.m2.3.3.1.1.1.1.3"><csymbol cd="ambiguous" id="S2.SS1.p7.2.m2.3.3.1.1.1.1.3.1.cmml" xref="S2.SS1.p7.2.m2.3.3.1.1.1.1.3">subscript</csymbol><ci id="S2.SS1.p7.2.m2.3.3.1.1.1.1.3.2.cmml" xref="S2.SS1.p7.2.m2.3.3.1.1.1.1.3.2">bold-italic-ϕ</ci><ci id="S2.SS1.p7.2.m2.3.3.1.1.1.1.3.3.cmml" xref="S2.SS1.p7.2.m2.3.3.1.1.1.1.3.3">𝑠</ci></apply><list id="S2.SS1.p7.2.m2.3.3.1.1.1.1.1.2.cmml" xref="S2.SS1.p7.2.m2.3.3.1.1.1.1.1.1"><apply id="S2.SS1.p7.2.m2.3.3.1.1.1.1.1.1.1.cmml" xref="S2.SS1.p7.2.m2.3.3.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S2.SS1.p7.2.m2.3.3.1.1.1.1.1.1.1.1.cmml" xref="S2.SS1.p7.2.m2.3.3.1.1.1.1.1.1.1">subscript</csymbol><ci id="S2.SS1.p7.2.m2.3.3.1.1.1.1.1.1.1.2.cmml" xref="S2.SS1.p7.2.m2.3.3.1.1.1.1.1.1.1.2">𝐰</ci><apply id="S2.SS1.p7.2.m2.3.3.1.1.1.1.1.1.1.3.cmml" xref="S2.SS1.p7.2.m2.3.3.1.1.1.1.1.1.1.3"><ci id="S2.SS1.p7.2.m2.3.3.1.1.1.1.1.1.1.3.1.cmml" xref="S2.SS1.p7.2.m2.3.3.1.1.1.1.1.1.1.3.1">:</ci><cn type="integer" id="S2.SS1.p7.2.m2.3.3.1.1.1.1.1.1.1.3.2.cmml" xref="S2.SS1.p7.2.m2.3.3.1.1.1.1.1.1.1.3.2">1</cn><ci id="S2.SS1.p7.2.m2.3.3.1.1.1.1.1.1.1.3.3.cmml" xref="S2.SS1.p7.2.m2.3.3.1.1.1.1.1.1.1.3.3">𝐾</ci></apply></apply><apply id="S2.SS1.p7.2.m2.1.1.cmml" xref="S2.SS1.p7.2.m2.1.1"><divide id="S2.SS1.p7.2.m2.1.1.1.cmml" xref="S2.SS1.p7.2.m2.1.1"></divide><cn type="integer" id="S2.SS1.p7.2.m2.1.1.2.cmml" xref="S2.SS1.p7.2.m2.1.1.2">1</cn><ci id="S2.SS1.p7.2.m2.1.1.3.cmml" xref="S2.SS1.p7.2.m2.1.1.3">𝜆</ci></apply></list></apply></apply><apply id="S2.SS1.p7.2.m2.4.4.2.cmml" xref="S2.SS1.p7.2.m2.4.4.2"><times id="S2.SS1.p7.2.m2.4.4.2.2.cmml" xref="S2.SS1.p7.2.m2.4.4.2.2"></times><apply id="S2.SS1.p7.2.m2.4.4.2.3.cmml" xref="S2.SS1.p7.2.m2.4.4.2.3"><divide id="S2.SS1.p7.2.m2.4.4.2.3.1.cmml" xref="S2.SS1.p7.2.m2.4.4.2.3"></divide><cn type="integer" id="S2.SS1.p7.2.m2.4.4.2.3.2.cmml" xref="S2.SS1.p7.2.m2.4.4.2.3.2">1</cn><ci id="S2.SS1.p7.2.m2.4.4.2.3.3.cmml" xref="S2.SS1.p7.2.m2.4.4.2.3.3">𝐾</ci></apply><apply id="S2.SS1.p7.2.m2.4.4.2.1.cmml" xref="S2.SS1.p7.2.m2.4.4.2.1"><apply id="S2.SS1.p7.2.m2.4.4.2.1.2.cmml" xref="S2.SS1.p7.2.m2.4.4.2.1.2"><csymbol cd="ambiguous" id="S2.SS1.p7.2.m2.4.4.2.1.2.1.cmml" xref="S2.SS1.p7.2.m2.4.4.2.1.2">subscript</csymbol><sum id="S2.SS1.p7.2.m2.4.4.2.1.2.2.cmml" xref="S2.SS1.p7.2.m2.4.4.2.1.2.2"></sum><ci id="S2.SS1.p7.2.m2.4.4.2.1.2.3.cmml" xref="S2.SS1.p7.2.m2.4.4.2.1.2.3">𝑘</ci></apply><apply id="S2.SS1.p7.2.m2.4.4.2.1.1.cmml" xref="S2.SS1.p7.2.m2.4.4.2.1.1"><times id="S2.SS1.p7.2.m2.4.4.2.1.1.2.cmml" xref="S2.SS1.p7.2.m2.4.4.2.1.1.2"></times><ci id="S2.SS1.p7.2.m2.4.4.2.1.1.3.cmml" xref="S2.SS1.p7.2.m2.4.4.2.1.1.3">𝑁</ci><interval closure="open" id="S2.SS1.p7.2.m2.4.4.2.1.1.1.2.cmml" xref="S2.SS1.p7.2.m2.4.4.2.1.1.1.1"><apply id="S2.SS1.p7.2.m2.4.4.2.1.1.1.1.1.cmml" xref="S2.SS1.p7.2.m2.4.4.2.1.1.1.1.1"><csymbol cd="ambiguous" id="S2.SS1.p7.2.m2.4.4.2.1.1.1.1.1.1.cmml" xref="S2.SS1.p7.2.m2.4.4.2.1.1.1.1.1">subscript</csymbol><ci id="S2.SS1.p7.2.m2.4.4.2.1.1.1.1.1.2.cmml" xref="S2.SS1.p7.2.m2.4.4.2.1.1.1.1.1.2">𝐰</ci><ci id="S2.SS1.p7.2.m2.4.4.2.1.1.1.1.1.3.cmml" xref="S2.SS1.p7.2.m2.4.4.2.1.1.1.1.1.3">𝑘</ci></apply><apply id="S2.SS1.p7.2.m2.2.2.cmml" xref="S2.SS1.p7.2.m2.2.2"><divide id="S2.SS1.p7.2.m2.2.2.1.cmml" xref="S2.SS1.p7.2.m2.2.2"></divide><cn type="integer" id="S2.SS1.p7.2.m2.2.2.2.cmml" xref="S2.SS1.p7.2.m2.2.2.2">1</cn><ci id="S2.SS1.p7.2.m2.2.2.3.cmml" xref="S2.SS1.p7.2.m2.2.2.3">𝜆</ci></apply></interval></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p7.2.m2.4c">p(\bm{\phi}_{s}|\mathbf{w}_{1:K},\frac{1}{\lambda})=\frac{1}{K}\sum_{k}N(\mathbf{w}_{k},\frac{1}{\lambda})</annotation></semantics></math>, which would result into training an ensemble of models at the server. We provide the details in Appendix <a href="#A10" title="Appendix J Alternative priors for the hierarchical model ‣ An Expectation-Maximization Perspective on Federated Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">J</span></a>. In this work, we focus on tackling the communication and computational costs of FL, which is important and highly beneficial for practical applications of “cross-device” FL <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib14" title="" class="ltx_ref">14</a>]</cite>. For this reason, we replace the Gaussian prior with a sparsity inducing prior, namely the spike and slab prior <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib23" title="" class="ltx_ref">23</a>]</cite>. We describe the resulting algorithm, <span id="S2.SS1.p7.2.1" class="ltx_text ltx_font_typewriter">FedSparse</span>, in the next section.</p>
</div>
</section>
</section>
<section id="S3" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">3 </span>The <span id="S3.1.1" class="ltx_text ltx_font_typewriter">FedSparse</span> algorithm: sparsity in federated learning</h2>

<div id="S3.p1" class="ltx_para">
<p id="S3.p1.2" class="ltx_p">Encouraging sparsity in FL has two main advantages; the model becomes smaller, thus less resource-intensive to evaluate, and it cuts down on communication costs as the pruned parameters do not need to be communicated. The golden standard for sparsity in probabilistic models is the spike and slab <cite class="ltx_cite ltx_citemacro_citep">[<a href="#bib.bib23" title="" class="ltx_ref">23</a>]</cite> prior. It is a mixture of two components, a delta spike at zero, <math id="S3.p1.1.m1.1" class="ltx_Math" alttext="\delta(0)" display="inline"><semantics id="S3.p1.1.m1.1a"><mrow id="S3.p1.1.m1.1.2" xref="S3.p1.1.m1.1.2.cmml"><mi id="S3.p1.1.m1.1.2.2" xref="S3.p1.1.m1.1.2.2.cmml">δ</mi><mo lspace="0em" rspace="0em" id="S3.p1.1.m1.1.2.1" xref="S3.p1.1.m1.1.2.1.cmml">​</mo><mrow id="S3.p1.1.m1.1.2.3.2" xref="S3.p1.1.m1.1.2.cmml"><mo stretchy="false" id="S3.p1.1.m1.1.2.3.2.1" xref="S3.p1.1.m1.1.2.cmml">(</mo><mn id="S3.p1.1.m1.1.1" xref="S3.p1.1.m1.1.1.cmml">0</mn><mo stretchy="false" id="S3.p1.1.m1.1.2.3.2.2" xref="S3.p1.1.m1.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.p1.1.m1.1b"><apply id="S3.p1.1.m1.1.2.cmml" xref="S3.p1.1.m1.1.2"><times id="S3.p1.1.m1.1.2.1.cmml" xref="S3.p1.1.m1.1.2.1"></times><ci id="S3.p1.1.m1.1.2.2.cmml" xref="S3.p1.1.m1.1.2.2">𝛿</ci><cn type="integer" id="S3.p1.1.m1.1.1.cmml" xref="S3.p1.1.m1.1.1">0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p1.1.m1.1c">\delta(0)</annotation></semantics></math>, and a continuous distribution over the real line, <em id="S3.p1.2.1" class="ltx_emph ltx_font_italic">i.e.</em> the slab. More specifically, by adopting a Gaussian slab for each local parameter <math id="S3.p1.2.m2.1" class="ltx_Math" alttext="\bm{\phi}_{si}" display="inline"><semantics id="S3.p1.2.m2.1a"><msub id="S3.p1.2.m2.1.1" xref="S3.p1.2.m2.1.1.cmml"><mi class="ltx_mathvariant_bold-italic" mathvariant="bold-italic" id="S3.p1.2.m2.1.1.2" xref="S3.p1.2.m2.1.1.2.cmml">ϕ</mi><mrow id="S3.p1.2.m2.1.1.3" xref="S3.p1.2.m2.1.1.3.cmml"><mi id="S3.p1.2.m2.1.1.3.2" xref="S3.p1.2.m2.1.1.3.2.cmml">s</mi><mo lspace="0em" rspace="0em" id="S3.p1.2.m2.1.1.3.1" xref="S3.p1.2.m2.1.1.3.1.cmml">​</mo><mi id="S3.p1.2.m2.1.1.3.3" xref="S3.p1.2.m2.1.1.3.3.cmml">i</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S3.p1.2.m2.1b"><apply id="S3.p1.2.m2.1.1.cmml" xref="S3.p1.2.m2.1.1"><csymbol cd="ambiguous" id="S3.p1.2.m2.1.1.1.cmml" xref="S3.p1.2.m2.1.1">subscript</csymbol><ci id="S3.p1.2.m2.1.1.2.cmml" xref="S3.p1.2.m2.1.1.2">bold-italic-ϕ</ci><apply id="S3.p1.2.m2.1.1.3.cmml" xref="S3.p1.2.m2.1.1.3"><times id="S3.p1.2.m2.1.1.3.1.cmml" xref="S3.p1.2.m2.1.1.3.1"></times><ci id="S3.p1.2.m2.1.1.3.2.cmml" xref="S3.p1.2.m2.1.1.3.2">𝑠</ci><ci id="S3.p1.2.m2.1.1.3.3.cmml" xref="S3.p1.2.m2.1.1.3.3">𝑖</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p1.2.m2.1c">\bm{\phi}_{si}</annotation></semantics></math> we have that</p>
<table id="A10.EGx13" class="ltx_equationgroup ltx_eqn_align ltx_eqn_table">

<tbody id="S3.E13"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math id="S3.E13.m1.2" class="ltx_Math" alttext="\displaystyle p(\bm{\phi}_{si}|\bm{\theta}_{i},\mathbf{w}_{i})=(1-\bm{\theta}_{i})\delta(0)+\bm{\theta}_{i}\mathcal{N}(\bm{\phi}_{si}|\mathbf{w}_{i},1/\lambda)," display="inline"><semantics id="S3.E13.m1.2a"><mrow id="S3.E13.m1.2.2.1" xref="S3.E13.m1.2.2.1.1.cmml"><mrow id="S3.E13.m1.2.2.1.1" xref="S3.E13.m1.2.2.1.1.cmml"><mrow id="S3.E13.m1.2.2.1.1.1" xref="S3.E13.m1.2.2.1.1.1.cmml"><mi id="S3.E13.m1.2.2.1.1.1.3" xref="S3.E13.m1.2.2.1.1.1.3.cmml">p</mi><mo lspace="0em" rspace="0em" id="S3.E13.m1.2.2.1.1.1.2" xref="S3.E13.m1.2.2.1.1.1.2.cmml">​</mo><mrow id="S3.E13.m1.2.2.1.1.1.1.1" xref="S3.E13.m1.2.2.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S3.E13.m1.2.2.1.1.1.1.1.2" xref="S3.E13.m1.2.2.1.1.1.1.1.1.cmml">(</mo><mrow id="S3.E13.m1.2.2.1.1.1.1.1.1" xref="S3.E13.m1.2.2.1.1.1.1.1.1.cmml"><msub id="S3.E13.m1.2.2.1.1.1.1.1.1.4" xref="S3.E13.m1.2.2.1.1.1.1.1.1.4.cmml"><mi class="ltx_mathvariant_bold-italic" mathvariant="bold-italic" id="S3.E13.m1.2.2.1.1.1.1.1.1.4.2" xref="S3.E13.m1.2.2.1.1.1.1.1.1.4.2.cmml">ϕ</mi><mrow id="S3.E13.m1.2.2.1.1.1.1.1.1.4.3" xref="S3.E13.m1.2.2.1.1.1.1.1.1.4.3.cmml"><mi id="S3.E13.m1.2.2.1.1.1.1.1.1.4.3.2" xref="S3.E13.m1.2.2.1.1.1.1.1.1.4.3.2.cmml">s</mi><mo lspace="0em" rspace="0em" id="S3.E13.m1.2.2.1.1.1.1.1.1.4.3.1" xref="S3.E13.m1.2.2.1.1.1.1.1.1.4.3.1.cmml">​</mo><mi id="S3.E13.m1.2.2.1.1.1.1.1.1.4.3.3" xref="S3.E13.m1.2.2.1.1.1.1.1.1.4.3.3.cmml">i</mi></mrow></msub><mo fence="false" id="S3.E13.m1.2.2.1.1.1.1.1.1.3" xref="S3.E13.m1.2.2.1.1.1.1.1.1.3.cmml">|</mo><mrow id="S3.E13.m1.2.2.1.1.1.1.1.1.2.2" xref="S3.E13.m1.2.2.1.1.1.1.1.1.2.3.cmml"><msub id="S3.E13.m1.2.2.1.1.1.1.1.1.1.1.1" xref="S3.E13.m1.2.2.1.1.1.1.1.1.1.1.1.cmml"><mi id="S3.E13.m1.2.2.1.1.1.1.1.1.1.1.1.2" xref="S3.E13.m1.2.2.1.1.1.1.1.1.1.1.1.2.cmml">𝜽</mi><mi id="S3.E13.m1.2.2.1.1.1.1.1.1.1.1.1.3" xref="S3.E13.m1.2.2.1.1.1.1.1.1.1.1.1.3.cmml">i</mi></msub><mo id="S3.E13.m1.2.2.1.1.1.1.1.1.2.2.3" xref="S3.E13.m1.2.2.1.1.1.1.1.1.2.3.cmml">,</mo><msub id="S3.E13.m1.2.2.1.1.1.1.1.1.2.2.2" xref="S3.E13.m1.2.2.1.1.1.1.1.1.2.2.2.cmml"><mi id="S3.E13.m1.2.2.1.1.1.1.1.1.2.2.2.2" xref="S3.E13.m1.2.2.1.1.1.1.1.1.2.2.2.2.cmml">𝐰</mi><mi id="S3.E13.m1.2.2.1.1.1.1.1.1.2.2.2.3" xref="S3.E13.m1.2.2.1.1.1.1.1.1.2.2.2.3.cmml">i</mi></msub></mrow></mrow><mo stretchy="false" id="S3.E13.m1.2.2.1.1.1.1.1.3" xref="S3.E13.m1.2.2.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S3.E13.m1.2.2.1.1.4" xref="S3.E13.m1.2.2.1.1.4.cmml">=</mo><mrow id="S3.E13.m1.2.2.1.1.3" xref="S3.E13.m1.2.2.1.1.3.cmml"><mrow id="S3.E13.m1.2.2.1.1.2.1" xref="S3.E13.m1.2.2.1.1.2.1.cmml"><mrow id="S3.E13.m1.2.2.1.1.2.1.1.1" xref="S3.E13.m1.2.2.1.1.2.1.1.1.1.cmml"><mo stretchy="false" id="S3.E13.m1.2.2.1.1.2.1.1.1.2" xref="S3.E13.m1.2.2.1.1.2.1.1.1.1.cmml">(</mo><mrow id="S3.E13.m1.2.2.1.1.2.1.1.1.1" xref="S3.E13.m1.2.2.1.1.2.1.1.1.1.cmml"><mn id="S3.E13.m1.2.2.1.1.2.1.1.1.1.2" xref="S3.E13.m1.2.2.1.1.2.1.1.1.1.2.cmml">1</mn><mo id="S3.E13.m1.2.2.1.1.2.1.1.1.1.1" xref="S3.E13.m1.2.2.1.1.2.1.1.1.1.1.cmml">−</mo><msub id="S3.E13.m1.2.2.1.1.2.1.1.1.1.3" xref="S3.E13.m1.2.2.1.1.2.1.1.1.1.3.cmml"><mi id="S3.E13.m1.2.2.1.1.2.1.1.1.1.3.2" xref="S3.E13.m1.2.2.1.1.2.1.1.1.1.3.2.cmml">𝜽</mi><mi id="S3.E13.m1.2.2.1.1.2.1.1.1.1.3.3" xref="S3.E13.m1.2.2.1.1.2.1.1.1.1.3.3.cmml">i</mi></msub></mrow><mo stretchy="false" id="S3.E13.m1.2.2.1.1.2.1.1.1.3" xref="S3.E13.m1.2.2.1.1.2.1.1.1.1.cmml">)</mo></mrow><mo lspace="0em" rspace="0em" id="S3.E13.m1.2.2.1.1.2.1.2" xref="S3.E13.m1.2.2.1.1.2.1.2.cmml">​</mo><mi id="S3.E13.m1.2.2.1.1.2.1.3" xref="S3.E13.m1.2.2.1.1.2.1.3.cmml">δ</mi><mo lspace="0em" rspace="0em" id="S3.E13.m1.2.2.1.1.2.1.2a" xref="S3.E13.m1.2.2.1.1.2.1.2.cmml">​</mo><mrow id="S3.E13.m1.2.2.1.1.2.1.4.2" xref="S3.E13.m1.2.2.1.1.2.1.cmml"><mo stretchy="false" id="S3.E13.m1.2.2.1.1.2.1.4.2.1" xref="S3.E13.m1.2.2.1.1.2.1.cmml">(</mo><mn id="S3.E13.m1.1.1" xref="S3.E13.m1.1.1.cmml">0</mn><mo stretchy="false" id="S3.E13.m1.2.2.1.1.2.1.4.2.2" xref="S3.E13.m1.2.2.1.1.2.1.cmml">)</mo></mrow></mrow><mo id="S3.E13.m1.2.2.1.1.3.3" xref="S3.E13.m1.2.2.1.1.3.3.cmml">+</mo><mrow id="S3.E13.m1.2.2.1.1.3.2" xref="S3.E13.m1.2.2.1.1.3.2.cmml"><msub id="S3.E13.m1.2.2.1.1.3.2.3" xref="S3.E13.m1.2.2.1.1.3.2.3.cmml"><mi id="S3.E13.m1.2.2.1.1.3.2.3.2" xref="S3.E13.m1.2.2.1.1.3.2.3.2.cmml">𝜽</mi><mi id="S3.E13.m1.2.2.1.1.3.2.3.3" xref="S3.E13.m1.2.2.1.1.3.2.3.3.cmml">i</mi></msub><mo lspace="0em" rspace="0em" id="S3.E13.m1.2.2.1.1.3.2.2" xref="S3.E13.m1.2.2.1.1.3.2.2.cmml">​</mo><mi class="ltx_font_mathcaligraphic" id="S3.E13.m1.2.2.1.1.3.2.4" xref="S3.E13.m1.2.2.1.1.3.2.4.cmml">𝒩</mi><mo lspace="0em" rspace="0em" id="S3.E13.m1.2.2.1.1.3.2.2a" xref="S3.E13.m1.2.2.1.1.3.2.2.cmml">​</mo><mrow id="S3.E13.m1.2.2.1.1.3.2.1.1" xref="S3.E13.m1.2.2.1.1.3.2.1.1.1.cmml"><mo stretchy="false" id="S3.E13.m1.2.2.1.1.3.2.1.1.2" xref="S3.E13.m1.2.2.1.1.3.2.1.1.1.cmml">(</mo><mrow id="S3.E13.m1.2.2.1.1.3.2.1.1.1" xref="S3.E13.m1.2.2.1.1.3.2.1.1.1.cmml"><msub id="S3.E13.m1.2.2.1.1.3.2.1.1.1.4" xref="S3.E13.m1.2.2.1.1.3.2.1.1.1.4.cmml"><mi class="ltx_mathvariant_bold-italic" mathvariant="bold-italic" id="S3.E13.m1.2.2.1.1.3.2.1.1.1.4.2" xref="S3.E13.m1.2.2.1.1.3.2.1.1.1.4.2.cmml">ϕ</mi><mrow id="S3.E13.m1.2.2.1.1.3.2.1.1.1.4.3" xref="S3.E13.m1.2.2.1.1.3.2.1.1.1.4.3.cmml"><mi id="S3.E13.m1.2.2.1.1.3.2.1.1.1.4.3.2" xref="S3.E13.m1.2.2.1.1.3.2.1.1.1.4.3.2.cmml">s</mi><mo lspace="0em" rspace="0em" id="S3.E13.m1.2.2.1.1.3.2.1.1.1.4.3.1" xref="S3.E13.m1.2.2.1.1.3.2.1.1.1.4.3.1.cmml">​</mo><mi id="S3.E13.m1.2.2.1.1.3.2.1.1.1.4.3.3" xref="S3.E13.m1.2.2.1.1.3.2.1.1.1.4.3.3.cmml">i</mi></mrow></msub><mo fence="false" id="S3.E13.m1.2.2.1.1.3.2.1.1.1.3" xref="S3.E13.m1.2.2.1.1.3.2.1.1.1.3.cmml">|</mo><mrow id="S3.E13.m1.2.2.1.1.3.2.1.1.1.2.2" xref="S3.E13.m1.2.2.1.1.3.2.1.1.1.2.3.cmml"><msub id="S3.E13.m1.2.2.1.1.3.2.1.1.1.1.1.1" xref="S3.E13.m1.2.2.1.1.3.2.1.1.1.1.1.1.cmml"><mi id="S3.E13.m1.2.2.1.1.3.2.1.1.1.1.1.1.2" xref="S3.E13.m1.2.2.1.1.3.2.1.1.1.1.1.1.2.cmml">𝐰</mi><mi id="S3.E13.m1.2.2.1.1.3.2.1.1.1.1.1.1.3" xref="S3.E13.m1.2.2.1.1.3.2.1.1.1.1.1.1.3.cmml">i</mi></msub><mo id="S3.E13.m1.2.2.1.1.3.2.1.1.1.2.2.3" xref="S3.E13.m1.2.2.1.1.3.2.1.1.1.2.3.cmml">,</mo><mrow id="S3.E13.m1.2.2.1.1.3.2.1.1.1.2.2.2" xref="S3.E13.m1.2.2.1.1.3.2.1.1.1.2.2.2.cmml"><mn id="S3.E13.m1.2.2.1.1.3.2.1.1.1.2.2.2.2" xref="S3.E13.m1.2.2.1.1.3.2.1.1.1.2.2.2.2.cmml">1</mn><mo id="S3.E13.m1.2.2.1.1.3.2.1.1.1.2.2.2.1" xref="S3.E13.m1.2.2.1.1.3.2.1.1.1.2.2.2.1.cmml">/</mo><mi id="S3.E13.m1.2.2.1.1.3.2.1.1.1.2.2.2.3" xref="S3.E13.m1.2.2.1.1.3.2.1.1.1.2.2.2.3.cmml">λ</mi></mrow></mrow></mrow><mo stretchy="false" id="S3.E13.m1.2.2.1.1.3.2.1.1.3" xref="S3.E13.m1.2.2.1.1.3.2.1.1.1.cmml">)</mo></mrow></mrow></mrow></mrow><mo id="S3.E13.m1.2.2.1.2" xref="S3.E13.m1.2.2.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E13.m1.2b"><apply id="S3.E13.m1.2.2.1.1.cmml" xref="S3.E13.m1.2.2.1"><eq id="S3.E13.m1.2.2.1.1.4.cmml" xref="S3.E13.m1.2.2.1.1.4"></eq><apply id="S3.E13.m1.2.2.1.1.1.cmml" xref="S3.E13.m1.2.2.1.1.1"><times id="S3.E13.m1.2.2.1.1.1.2.cmml" xref="S3.E13.m1.2.2.1.1.1.2"></times><ci id="S3.E13.m1.2.2.1.1.1.3.cmml" xref="S3.E13.m1.2.2.1.1.1.3">𝑝</ci><apply id="S3.E13.m1.2.2.1.1.1.1.1.1.cmml" xref="S3.E13.m1.2.2.1.1.1.1.1"><csymbol cd="latexml" id="S3.E13.m1.2.2.1.1.1.1.1.1.3.cmml" xref="S3.E13.m1.2.2.1.1.1.1.1.1.3">conditional</csymbol><apply id="S3.E13.m1.2.2.1.1.1.1.1.1.4.cmml" xref="S3.E13.m1.2.2.1.1.1.1.1.1.4"><csymbol cd="ambiguous" id="S3.E13.m1.2.2.1.1.1.1.1.1.4.1.cmml" xref="S3.E13.m1.2.2.1.1.1.1.1.1.4">subscript</csymbol><ci id="S3.E13.m1.2.2.1.1.1.1.1.1.4.2.cmml" xref="S3.E13.m1.2.2.1.1.1.1.1.1.4.2">bold-italic-ϕ</ci><apply id="S3.E13.m1.2.2.1.1.1.1.1.1.4.3.cmml" xref="S3.E13.m1.2.2.1.1.1.1.1.1.4.3"><times id="S3.E13.m1.2.2.1.1.1.1.1.1.4.3.1.cmml" xref="S3.E13.m1.2.2.1.1.1.1.1.1.4.3.1"></times><ci id="S3.E13.m1.2.2.1.1.1.1.1.1.4.3.2.cmml" xref="S3.E13.m1.2.2.1.1.1.1.1.1.4.3.2">𝑠</ci><ci id="S3.E13.m1.2.2.1.1.1.1.1.1.4.3.3.cmml" xref="S3.E13.m1.2.2.1.1.1.1.1.1.4.3.3">𝑖</ci></apply></apply><list id="S3.E13.m1.2.2.1.1.1.1.1.1.2.3.cmml" xref="S3.E13.m1.2.2.1.1.1.1.1.1.2.2"><apply id="S3.E13.m1.2.2.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E13.m1.2.2.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E13.m1.2.2.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E13.m1.2.2.1.1.1.1.1.1.1.1.1">subscript</csymbol><ci id="S3.E13.m1.2.2.1.1.1.1.1.1.1.1.1.2.cmml" xref="S3.E13.m1.2.2.1.1.1.1.1.1.1.1.1.2">𝜽</ci><ci id="S3.E13.m1.2.2.1.1.1.1.1.1.1.1.1.3.cmml" xref="S3.E13.m1.2.2.1.1.1.1.1.1.1.1.1.3">𝑖</ci></apply><apply id="S3.E13.m1.2.2.1.1.1.1.1.1.2.2.2.cmml" xref="S3.E13.m1.2.2.1.1.1.1.1.1.2.2.2"><csymbol cd="ambiguous" id="S3.E13.m1.2.2.1.1.1.1.1.1.2.2.2.1.cmml" xref="S3.E13.m1.2.2.1.1.1.1.1.1.2.2.2">subscript</csymbol><ci id="S3.E13.m1.2.2.1.1.1.1.1.1.2.2.2.2.cmml" xref="S3.E13.m1.2.2.1.1.1.1.1.1.2.2.2.2">𝐰</ci><ci id="S3.E13.m1.2.2.1.1.1.1.1.1.2.2.2.3.cmml" xref="S3.E13.m1.2.2.1.1.1.1.1.1.2.2.2.3">𝑖</ci></apply></list></apply></apply><apply id="S3.E13.m1.2.2.1.1.3.cmml" xref="S3.E13.m1.2.2.1.1.3"><plus id="S3.E13.m1.2.2.1.1.3.3.cmml" xref="S3.E13.m1.2.2.1.1.3.3"></plus><apply id="S3.E13.m1.2.2.1.1.2.1.cmml" xref="S3.E13.m1.2.2.1.1.2.1"><times id="S3.E13.m1.2.2.1.1.2.1.2.cmml" xref="S3.E13.m1.2.2.1.1.2.1.2"></times><apply id="S3.E13.m1.2.2.1.1.2.1.1.1.1.cmml" xref="S3.E13.m1.2.2.1.1.2.1.1.1"><minus id="S3.E13.m1.2.2.1.1.2.1.1.1.1.1.cmml" xref="S3.E13.m1.2.2.1.1.2.1.1.1.1.1"></minus><cn type="integer" id="S3.E13.m1.2.2.1.1.2.1.1.1.1.2.cmml" xref="S3.E13.m1.2.2.1.1.2.1.1.1.1.2">1</cn><apply id="S3.E13.m1.2.2.1.1.2.1.1.1.1.3.cmml" xref="S3.E13.m1.2.2.1.1.2.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.E13.m1.2.2.1.1.2.1.1.1.1.3.1.cmml" xref="S3.E13.m1.2.2.1.1.2.1.1.1.1.3">subscript</csymbol><ci id="S3.E13.m1.2.2.1.1.2.1.1.1.1.3.2.cmml" xref="S3.E13.m1.2.2.1.1.2.1.1.1.1.3.2">𝜽</ci><ci id="S3.E13.m1.2.2.1.1.2.1.1.1.1.3.3.cmml" xref="S3.E13.m1.2.2.1.1.2.1.1.1.1.3.3">𝑖</ci></apply></apply><ci id="S3.E13.m1.2.2.1.1.2.1.3.cmml" xref="S3.E13.m1.2.2.1.1.2.1.3">𝛿</ci><cn type="integer" id="S3.E13.m1.1.1.cmml" xref="S3.E13.m1.1.1">0</cn></apply><apply id="S3.E13.m1.2.2.1.1.3.2.cmml" xref="S3.E13.m1.2.2.1.1.3.2"><times id="S3.E13.m1.2.2.1.1.3.2.2.cmml" xref="S3.E13.m1.2.2.1.1.3.2.2"></times><apply id="S3.E13.m1.2.2.1.1.3.2.3.cmml" xref="S3.E13.m1.2.2.1.1.3.2.3"><csymbol cd="ambiguous" id="S3.E13.m1.2.2.1.1.3.2.3.1.cmml" xref="S3.E13.m1.2.2.1.1.3.2.3">subscript</csymbol><ci id="S3.E13.m1.2.2.1.1.3.2.3.2.cmml" xref="S3.E13.m1.2.2.1.1.3.2.3.2">𝜽</ci><ci id="S3.E13.m1.2.2.1.1.3.2.3.3.cmml" xref="S3.E13.m1.2.2.1.1.3.2.3.3">𝑖</ci></apply><ci id="S3.E13.m1.2.2.1.1.3.2.4.cmml" xref="S3.E13.m1.2.2.1.1.3.2.4">𝒩</ci><apply id="S3.E13.m1.2.2.1.1.3.2.1.1.1.cmml" xref="S3.E13.m1.2.2.1.1.3.2.1.1"><csymbol cd="latexml" id="S3.E13.m1.2.2.1.1.3.2.1.1.1.3.cmml" xref="S3.E13.m1.2.2.1.1.3.2.1.1.1.3">conditional</csymbol><apply id="S3.E13.m1.2.2.1.1.3.2.1.1.1.4.cmml" xref="S3.E13.m1.2.2.1.1.3.2.1.1.1.4"><csymbol cd="ambiguous" id="S3.E13.m1.2.2.1.1.3.2.1.1.1.4.1.cmml" xref="S3.E13.m1.2.2.1.1.3.2.1.1.1.4">subscript</csymbol><ci id="S3.E13.m1.2.2.1.1.3.2.1.1.1.4.2.cmml" xref="S3.E13.m1.2.2.1.1.3.2.1.1.1.4.2">bold-italic-ϕ</ci><apply id="S3.E13.m1.2.2.1.1.3.2.1.1.1.4.3.cmml" xref="S3.E13.m1.2.2.1.1.3.2.1.1.1.4.3"><times id="S3.E13.m1.2.2.1.1.3.2.1.1.1.4.3.1.cmml" xref="S3.E13.m1.2.2.1.1.3.2.1.1.1.4.3.1"></times><ci id="S3.E13.m1.2.2.1.1.3.2.1.1.1.4.3.2.cmml" xref="S3.E13.m1.2.2.1.1.3.2.1.1.1.4.3.2">𝑠</ci><ci id="S3.E13.m1.2.2.1.1.3.2.1.1.1.4.3.3.cmml" xref="S3.E13.m1.2.2.1.1.3.2.1.1.1.4.3.3">𝑖</ci></apply></apply><list id="S3.E13.m1.2.2.1.1.3.2.1.1.1.2.3.cmml" xref="S3.E13.m1.2.2.1.1.3.2.1.1.1.2.2"><apply id="S3.E13.m1.2.2.1.1.3.2.1.1.1.1.1.1.cmml" xref="S3.E13.m1.2.2.1.1.3.2.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E13.m1.2.2.1.1.3.2.1.1.1.1.1.1.1.cmml" xref="S3.E13.m1.2.2.1.1.3.2.1.1.1.1.1.1">subscript</csymbol><ci id="S3.E13.m1.2.2.1.1.3.2.1.1.1.1.1.1.2.cmml" xref="S3.E13.m1.2.2.1.1.3.2.1.1.1.1.1.1.2">𝐰</ci><ci id="S3.E13.m1.2.2.1.1.3.2.1.1.1.1.1.1.3.cmml" xref="S3.E13.m1.2.2.1.1.3.2.1.1.1.1.1.1.3">𝑖</ci></apply><apply id="S3.E13.m1.2.2.1.1.3.2.1.1.1.2.2.2.cmml" xref="S3.E13.m1.2.2.1.1.3.2.1.1.1.2.2.2"><divide id="S3.E13.m1.2.2.1.1.3.2.1.1.1.2.2.2.1.cmml" xref="S3.E13.m1.2.2.1.1.3.2.1.1.1.2.2.2.1"></divide><cn type="integer" id="S3.E13.m1.2.2.1.1.3.2.1.1.1.2.2.2.2.cmml" xref="S3.E13.m1.2.2.1.1.3.2.1.1.1.2.2.2.2">1</cn><ci id="S3.E13.m1.2.2.1.1.3.2.1.1.1.2.2.2.3.cmml" xref="S3.E13.m1.2.2.1.1.3.2.1.1.1.2.2.2.3">𝜆</ci></apply></list></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E13.m1.2c">\displaystyle p(\bm{\phi}_{si}|\bm{\theta}_{i},\mathbf{w}_{i})=(1-\bm{\theta}_{i})\delta(0)+\bm{\theta}_{i}\mathcal{N}(\bm{\phi}_{si}|\mathbf{w}_{i},1/\lambda),</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(13)</span></td>
</tr></tbody>
</table>
<p id="S3.p1.7" class="ltx_p">or equivalently as a hierarchical model</p>
<table id="A10.EGx14" class="ltx_equationgroup ltx_eqn_align ltx_eqn_table">

<tbody id="S3.E14"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math id="S3.E14.m1.1" class="ltx_Math" alttext="\displaystyle p(\mathbf{z}_{si})=\text{Bern}(\bm{\theta}_{i}),\enskip" display="inline"><semantics id="S3.E14.m1.1a"><mrow id="S3.E14.m1.1.1.1" xref="S3.E14.m1.1.1.1.1.cmml"><mrow id="S3.E14.m1.1.1.1.1" xref="S3.E14.m1.1.1.1.1.cmml"><mrow id="S3.E14.m1.1.1.1.1.1" xref="S3.E14.m1.1.1.1.1.1.cmml"><mi id="S3.E14.m1.1.1.1.1.1.3" xref="S3.E14.m1.1.1.1.1.1.3.cmml">p</mi><mo lspace="0em" rspace="0em" id="S3.E14.m1.1.1.1.1.1.2" xref="S3.E14.m1.1.1.1.1.1.2.cmml">​</mo><mrow id="S3.E14.m1.1.1.1.1.1.1.1" xref="S3.E14.m1.1.1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S3.E14.m1.1.1.1.1.1.1.1.2" xref="S3.E14.m1.1.1.1.1.1.1.1.1.cmml">(</mo><msub id="S3.E14.m1.1.1.1.1.1.1.1.1" xref="S3.E14.m1.1.1.1.1.1.1.1.1.cmml"><mi id="S3.E14.m1.1.1.1.1.1.1.1.1.2" xref="S3.E14.m1.1.1.1.1.1.1.1.1.2.cmml">𝐳</mi><mrow id="S3.E14.m1.1.1.1.1.1.1.1.1.3" xref="S3.E14.m1.1.1.1.1.1.1.1.1.3.cmml"><mi id="S3.E14.m1.1.1.1.1.1.1.1.1.3.2" xref="S3.E14.m1.1.1.1.1.1.1.1.1.3.2.cmml">s</mi><mo lspace="0em" rspace="0em" id="S3.E14.m1.1.1.1.1.1.1.1.1.3.1" xref="S3.E14.m1.1.1.1.1.1.1.1.1.3.1.cmml">​</mo><mi id="S3.E14.m1.1.1.1.1.1.1.1.1.3.3" xref="S3.E14.m1.1.1.1.1.1.1.1.1.3.3.cmml">i</mi></mrow></msub><mo stretchy="false" id="S3.E14.m1.1.1.1.1.1.1.1.3" xref="S3.E14.m1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S3.E14.m1.1.1.1.1.3" xref="S3.E14.m1.1.1.1.1.3.cmml">=</mo><mrow id="S3.E14.m1.1.1.1.1.2" xref="S3.E14.m1.1.1.1.1.2.cmml"><mtext id="S3.E14.m1.1.1.1.1.2.3" xref="S3.E14.m1.1.1.1.1.2.3a.cmml">Bern</mtext><mo lspace="0em" rspace="0em" id="S3.E14.m1.1.1.1.1.2.2" xref="S3.E14.m1.1.1.1.1.2.2.cmml">​</mo><mrow id="S3.E14.m1.1.1.1.1.2.1.1" xref="S3.E14.m1.1.1.1.1.2.1.1.1.cmml"><mo stretchy="false" id="S3.E14.m1.1.1.1.1.2.1.1.2" xref="S3.E14.m1.1.1.1.1.2.1.1.1.cmml">(</mo><msub id="S3.E14.m1.1.1.1.1.2.1.1.1" xref="S3.E14.m1.1.1.1.1.2.1.1.1.cmml"><mi id="S3.E14.m1.1.1.1.1.2.1.1.1.2" xref="S3.E14.m1.1.1.1.1.2.1.1.1.2.cmml">𝜽</mi><mi id="S3.E14.m1.1.1.1.1.2.1.1.1.3" xref="S3.E14.m1.1.1.1.1.2.1.1.1.3.cmml">i</mi></msub><mo stretchy="false" id="S3.E14.m1.1.1.1.1.2.1.1.3" xref="S3.E14.m1.1.1.1.1.2.1.1.1.cmml">)</mo></mrow></mrow></mrow><mo id="S3.E14.m1.1.1.1.2" xref="S3.E14.m1.1.1.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E14.m1.1b"><apply id="S3.E14.m1.1.1.1.1.cmml" xref="S3.E14.m1.1.1.1"><eq id="S3.E14.m1.1.1.1.1.3.cmml" xref="S3.E14.m1.1.1.1.1.3"></eq><apply id="S3.E14.m1.1.1.1.1.1.cmml" xref="S3.E14.m1.1.1.1.1.1"><times id="S3.E14.m1.1.1.1.1.1.2.cmml" xref="S3.E14.m1.1.1.1.1.1.2"></times><ci id="S3.E14.m1.1.1.1.1.1.3.cmml" xref="S3.E14.m1.1.1.1.1.1.3">𝑝</ci><apply id="S3.E14.m1.1.1.1.1.1.1.1.1.cmml" xref="S3.E14.m1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E14.m1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E14.m1.1.1.1.1.1.1.1">subscript</csymbol><ci id="S3.E14.m1.1.1.1.1.1.1.1.1.2.cmml" xref="S3.E14.m1.1.1.1.1.1.1.1.1.2">𝐳</ci><apply id="S3.E14.m1.1.1.1.1.1.1.1.1.3.cmml" xref="S3.E14.m1.1.1.1.1.1.1.1.1.3"><times id="S3.E14.m1.1.1.1.1.1.1.1.1.3.1.cmml" xref="S3.E14.m1.1.1.1.1.1.1.1.1.3.1"></times><ci id="S3.E14.m1.1.1.1.1.1.1.1.1.3.2.cmml" xref="S3.E14.m1.1.1.1.1.1.1.1.1.3.2">𝑠</ci><ci id="S3.E14.m1.1.1.1.1.1.1.1.1.3.3.cmml" xref="S3.E14.m1.1.1.1.1.1.1.1.1.3.3">𝑖</ci></apply></apply></apply><apply id="S3.E14.m1.1.1.1.1.2.cmml" xref="S3.E14.m1.1.1.1.1.2"><times id="S3.E14.m1.1.1.1.1.2.2.cmml" xref="S3.E14.m1.1.1.1.1.2.2"></times><ci id="S3.E14.m1.1.1.1.1.2.3a.cmml" xref="S3.E14.m1.1.1.1.1.2.3"><mtext id="S3.E14.m1.1.1.1.1.2.3.cmml" xref="S3.E14.m1.1.1.1.1.2.3">Bern</mtext></ci><apply id="S3.E14.m1.1.1.1.1.2.1.1.1.cmml" xref="S3.E14.m1.1.1.1.1.2.1.1"><csymbol cd="ambiguous" id="S3.E14.m1.1.1.1.1.2.1.1.1.1.cmml" xref="S3.E14.m1.1.1.1.1.2.1.1">subscript</csymbol><ci id="S3.E14.m1.1.1.1.1.2.1.1.1.2.cmml" xref="S3.E14.m1.1.1.1.1.2.1.1.1.2">𝜽</ci><ci id="S3.E14.m1.1.1.1.1.2.1.1.1.3.cmml" xref="S3.E14.m1.1.1.1.1.2.1.1.1.3">𝑖</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E14.m1.1c">\displaystyle p(\mathbf{z}_{si})=\text{Bern}(\bm{\theta}_{i}),\enskip</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math id="S3.E14.m2.4" class="ltx_Math" alttext="\displaystyle p(\bm{\phi}_{si}|\mathbf{z}_{si}=1,\mathbf{w}_{i})=\mathcal{N}(\bm{\phi}_{si}|\mathbf{w}_{i},1/\lambda),\enskip p(\bm{\phi}_{si}|\mathbf{z}_{si}=0)=\delta(0)" display="inline"><semantics id="S3.E14.m2.4a"><mrow id="S3.E14.m2.4.4.2" xref="S3.E14.m2.4.4.3.cmml"><mrow id="S3.E14.m2.3.3.1.1" xref="S3.E14.m2.3.3.1.1.cmml"><mrow id="S3.E14.m2.3.3.1.1.1" xref="S3.E14.m2.3.3.1.1.1.cmml"><mi id="S3.E14.m2.3.3.1.1.1.3" xref="S3.E14.m2.3.3.1.1.1.3.cmml">p</mi><mo lspace="0em" rspace="0em" id="S3.E14.m2.3.3.1.1.1.2" xref="S3.E14.m2.3.3.1.1.1.2.cmml">​</mo><mrow id="S3.E14.m2.3.3.1.1.1.1.1" xref="S3.E14.m2.3.3.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S3.E14.m2.3.3.1.1.1.1.1.2" xref="S3.E14.m2.3.3.1.1.1.1.1.1.cmml">(</mo><mrow id="S3.E14.m2.3.3.1.1.1.1.1.1" xref="S3.E14.m2.3.3.1.1.1.1.1.1.cmml"><mrow id="S3.E14.m2.3.3.1.1.1.1.1.1.3" xref="S3.E14.m2.3.3.1.1.1.1.1.1.3.cmml"><msub id="S3.E14.m2.3.3.1.1.1.1.1.1.3.2" xref="S3.E14.m2.3.3.1.1.1.1.1.1.3.2.cmml"><mi class="ltx_mathvariant_bold-italic" mathvariant="bold-italic" id="S3.E14.m2.3.3.1.1.1.1.1.1.3.2.2" xref="S3.E14.m2.3.3.1.1.1.1.1.1.3.2.2.cmml">ϕ</mi><mrow id="S3.E14.m2.3.3.1.1.1.1.1.1.3.2.3" xref="S3.E14.m2.3.3.1.1.1.1.1.1.3.2.3.cmml"><mi id="S3.E14.m2.3.3.1.1.1.1.1.1.3.2.3.2" xref="S3.E14.m2.3.3.1.1.1.1.1.1.3.2.3.2.cmml">s</mi><mo lspace="0em" rspace="0em" id="S3.E14.m2.3.3.1.1.1.1.1.1.3.2.3.1" xref="S3.E14.m2.3.3.1.1.1.1.1.1.3.2.3.1.cmml">​</mo><mi id="S3.E14.m2.3.3.1.1.1.1.1.1.3.2.3.3" xref="S3.E14.m2.3.3.1.1.1.1.1.1.3.2.3.3.cmml">i</mi></mrow></msub><mo fence="false" id="S3.E14.m2.3.3.1.1.1.1.1.1.3.1" xref="S3.E14.m2.3.3.1.1.1.1.1.1.3.1.cmml">|</mo><msub id="S3.E14.m2.3.3.1.1.1.1.1.1.3.3" xref="S3.E14.m2.3.3.1.1.1.1.1.1.3.3.cmml"><mi id="S3.E14.m2.3.3.1.1.1.1.1.1.3.3.2" xref="S3.E14.m2.3.3.1.1.1.1.1.1.3.3.2.cmml">𝐳</mi><mrow id="S3.E14.m2.3.3.1.1.1.1.1.1.3.3.3" xref="S3.E14.m2.3.3.1.1.1.1.1.1.3.3.3.cmml"><mi id="S3.E14.m2.3.3.1.1.1.1.1.1.3.3.3.2" xref="S3.E14.m2.3.3.1.1.1.1.1.1.3.3.3.2.cmml">s</mi><mo lspace="0em" rspace="0em" id="S3.E14.m2.3.3.1.1.1.1.1.1.3.3.3.1" xref="S3.E14.m2.3.3.1.1.1.1.1.1.3.3.3.1.cmml">​</mo><mi id="S3.E14.m2.3.3.1.1.1.1.1.1.3.3.3.3" xref="S3.E14.m2.3.3.1.1.1.1.1.1.3.3.3.3.cmml">i</mi></mrow></msub></mrow><mo id="S3.E14.m2.3.3.1.1.1.1.1.1.2" xref="S3.E14.m2.3.3.1.1.1.1.1.1.2.cmml">=</mo><mrow id="S3.E14.m2.3.3.1.1.1.1.1.1.1.1" xref="S3.E14.m2.3.3.1.1.1.1.1.1.1.2.cmml"><mn id="S3.E14.m2.1.1" xref="S3.E14.m2.1.1.cmml">1</mn><mo id="S3.E14.m2.3.3.1.1.1.1.1.1.1.1.2" xref="S3.E14.m2.3.3.1.1.1.1.1.1.1.2.cmml">,</mo><msub id="S3.E14.m2.3.3.1.1.1.1.1.1.1.1.1" xref="S3.E14.m2.3.3.1.1.1.1.1.1.1.1.1.cmml"><mi id="S3.E14.m2.3.3.1.1.1.1.1.1.1.1.1.2" xref="S3.E14.m2.3.3.1.1.1.1.1.1.1.1.1.2.cmml">𝐰</mi><mi id="S3.E14.m2.3.3.1.1.1.1.1.1.1.1.1.3" xref="S3.E14.m2.3.3.1.1.1.1.1.1.1.1.1.3.cmml">i</mi></msub></mrow></mrow><mo stretchy="false" id="S3.E14.m2.3.3.1.1.1.1.1.3" xref="S3.E14.m2.3.3.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S3.E14.m2.3.3.1.1.3" xref="S3.E14.m2.3.3.1.1.3.cmml">=</mo><mrow id="S3.E14.m2.3.3.1.1.2" xref="S3.E14.m2.3.3.1.1.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.E14.m2.3.3.1.1.2.3" xref="S3.E14.m2.3.3.1.1.2.3.cmml">𝒩</mi><mo lspace="0em" rspace="0em" id="S3.E14.m2.3.3.1.1.2.2" xref="S3.E14.m2.3.3.1.1.2.2.cmml">​</mo><mrow id="S3.E14.m2.3.3.1.1.2.1.1" xref="S3.E14.m2.3.3.1.1.2.1.1.1.cmml"><mo stretchy="false" id="S3.E14.m2.3.3.1.1.2.1.1.2" xref="S3.E14.m2.3.3.1.1.2.1.1.1.cmml">(</mo><mrow id="S3.E14.m2.3.3.1.1.2.1.1.1" xref="S3.E14.m2.3.3.1.1.2.1.1.1.cmml"><msub id="S3.E14.m2.3.3.1.1.2.1.1.1.4" xref="S3.E14.m2.3.3.1.1.2.1.1.1.4.cmml"><mi class="ltx_mathvariant_bold-italic" mathvariant="bold-italic" id="S3.E14.m2.3.3.1.1.2.1.1.1.4.2" xref="S3.E14.m2.3.3.1.1.2.1.1.1.4.2.cmml">ϕ</mi><mrow id="S3.E14.m2.3.3.1.1.2.1.1.1.4.3" xref="S3.E14.m2.3.3.1.1.2.1.1.1.4.3.cmml"><mi id="S3.E14.m2.3.3.1.1.2.1.1.1.4.3.2" xref="S3.E14.m2.3.3.1.1.2.1.1.1.4.3.2.cmml">s</mi><mo lspace="0em" rspace="0em" id="S3.E14.m2.3.3.1.1.2.1.1.1.4.3.1" xref="S3.E14.m2.3.3.1.1.2.1.1.1.4.3.1.cmml">​</mo><mi id="S3.E14.m2.3.3.1.1.2.1.1.1.4.3.3" xref="S3.E14.m2.3.3.1.1.2.1.1.1.4.3.3.cmml">i</mi></mrow></msub><mo fence="false" id="S3.E14.m2.3.3.1.1.2.1.1.1.3" xref="S3.E14.m2.3.3.1.1.2.1.1.1.3.cmml">|</mo><mrow id="S3.E14.m2.3.3.1.1.2.1.1.1.2.2" xref="S3.E14.m2.3.3.1.1.2.1.1.1.2.3.cmml"><msub id="S3.E14.m2.3.3.1.1.2.1.1.1.1.1.1" xref="S3.E14.m2.3.3.1.1.2.1.1.1.1.1.1.cmml"><mi id="S3.E14.m2.3.3.1.1.2.1.1.1.1.1.1.2" xref="S3.E14.m2.3.3.1.1.2.1.1.1.1.1.1.2.cmml">𝐰</mi><mi id="S3.E14.m2.3.3.1.1.2.1.1.1.1.1.1.3" xref="S3.E14.m2.3.3.1.1.2.1.1.1.1.1.1.3.cmml">i</mi></msub><mo id="S3.E14.m2.3.3.1.1.2.1.1.1.2.2.3" xref="S3.E14.m2.3.3.1.1.2.1.1.1.2.3.cmml">,</mo><mrow id="S3.E14.m2.3.3.1.1.2.1.1.1.2.2.2" xref="S3.E14.m2.3.3.1.1.2.1.1.1.2.2.2.cmml"><mn id="S3.E14.m2.3.3.1.1.2.1.1.1.2.2.2.2" xref="S3.E14.m2.3.3.1.1.2.1.1.1.2.2.2.2.cmml">1</mn><mo id="S3.E14.m2.3.3.1.1.2.1.1.1.2.2.2.1" xref="S3.E14.m2.3.3.1.1.2.1.1.1.2.2.2.1.cmml">/</mo><mi id="S3.E14.m2.3.3.1.1.2.1.1.1.2.2.2.3" xref="S3.E14.m2.3.3.1.1.2.1.1.1.2.2.2.3.cmml">λ</mi></mrow></mrow></mrow><mo stretchy="false" id="S3.E14.m2.3.3.1.1.2.1.1.3" xref="S3.E14.m2.3.3.1.1.2.1.1.1.cmml">)</mo></mrow></mrow></mrow><mo rspace="0.667em" id="S3.E14.m2.4.4.2.3" xref="S3.E14.m2.4.4.3a.cmml">,</mo><mrow id="S3.E14.m2.4.4.2.2" xref="S3.E14.m2.4.4.2.2.cmml"><mrow id="S3.E14.m2.4.4.2.2.1" xref="S3.E14.m2.4.4.2.2.1.cmml"><mi id="S3.E14.m2.4.4.2.2.1.3" xref="S3.E14.m2.4.4.2.2.1.3.cmml">p</mi><mo lspace="0em" rspace="0em" id="S3.E14.m2.4.4.2.2.1.2" xref="S3.E14.m2.4.4.2.2.1.2.cmml">​</mo><mrow id="S3.E14.m2.4.4.2.2.1.1.1" xref="S3.E14.m2.4.4.2.2.1.1.1.1.cmml"><mo stretchy="false" id="S3.E14.m2.4.4.2.2.1.1.1.2" xref="S3.E14.m2.4.4.2.2.1.1.1.1.cmml">(</mo><mrow id="S3.E14.m2.4.4.2.2.1.1.1.1" xref="S3.E14.m2.4.4.2.2.1.1.1.1.cmml"><mrow id="S3.E14.m2.4.4.2.2.1.1.1.1.2" xref="S3.E14.m2.4.4.2.2.1.1.1.1.2.cmml"><msub id="S3.E14.m2.4.4.2.2.1.1.1.1.2.2" xref="S3.E14.m2.4.4.2.2.1.1.1.1.2.2.cmml"><mi class="ltx_mathvariant_bold-italic" mathvariant="bold-italic" id="S3.E14.m2.4.4.2.2.1.1.1.1.2.2.2" xref="S3.E14.m2.4.4.2.2.1.1.1.1.2.2.2.cmml">ϕ</mi><mrow id="S3.E14.m2.4.4.2.2.1.1.1.1.2.2.3" xref="S3.E14.m2.4.4.2.2.1.1.1.1.2.2.3.cmml"><mi id="S3.E14.m2.4.4.2.2.1.1.1.1.2.2.3.2" xref="S3.E14.m2.4.4.2.2.1.1.1.1.2.2.3.2.cmml">s</mi><mo lspace="0em" rspace="0em" id="S3.E14.m2.4.4.2.2.1.1.1.1.2.2.3.1" xref="S3.E14.m2.4.4.2.2.1.1.1.1.2.2.3.1.cmml">​</mo><mi id="S3.E14.m2.4.4.2.2.1.1.1.1.2.2.3.3" xref="S3.E14.m2.4.4.2.2.1.1.1.1.2.2.3.3.cmml">i</mi></mrow></msub><mo fence="false" id="S3.E14.m2.4.4.2.2.1.1.1.1.2.1" xref="S3.E14.m2.4.4.2.2.1.1.1.1.2.1.cmml">|</mo><msub id="S3.E14.m2.4.4.2.2.1.1.1.1.2.3" xref="S3.E14.m2.4.4.2.2.1.1.1.1.2.3.cmml"><mi id="S3.E14.m2.4.4.2.2.1.1.1.1.2.3.2" xref="S3.E14.m2.4.4.2.2.1.1.1.1.2.3.2.cmml">𝐳</mi><mrow id="S3.E14.m2.4.4.2.2.1.1.1.1.2.3.3" xref="S3.E14.m2.4.4.2.2.1.1.1.1.2.3.3.cmml"><mi id="S3.E14.m2.4.4.2.2.1.1.1.1.2.3.3.2" xref="S3.E14.m2.4.4.2.2.1.1.1.1.2.3.3.2.cmml">s</mi><mo lspace="0em" rspace="0em" id="S3.E14.m2.4.4.2.2.1.1.1.1.2.3.3.1" xref="S3.E14.m2.4.4.2.2.1.1.1.1.2.3.3.1.cmml">​</mo><mi id="S3.E14.m2.4.4.2.2.1.1.1.1.2.3.3.3" xref="S3.E14.m2.4.4.2.2.1.1.1.1.2.3.3.3.cmml">i</mi></mrow></msub></mrow><mo id="S3.E14.m2.4.4.2.2.1.1.1.1.1" xref="S3.E14.m2.4.4.2.2.1.1.1.1.1.cmml">=</mo><mn id="S3.E14.m2.4.4.2.2.1.1.1.1.3" xref="S3.E14.m2.4.4.2.2.1.1.1.1.3.cmml">0</mn></mrow><mo stretchy="false" id="S3.E14.m2.4.4.2.2.1.1.1.3" xref="S3.E14.m2.4.4.2.2.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S3.E14.m2.4.4.2.2.2" xref="S3.E14.m2.4.4.2.2.2.cmml">=</mo><mrow id="S3.E14.m2.4.4.2.2.3" xref="S3.E14.m2.4.4.2.2.3.cmml"><mi id="S3.E14.m2.4.4.2.2.3.2" xref="S3.E14.m2.4.4.2.2.3.2.cmml">δ</mi><mo lspace="0em" rspace="0em" id="S3.E14.m2.4.4.2.2.3.1" xref="S3.E14.m2.4.4.2.2.3.1.cmml">​</mo><mrow id="S3.E14.m2.4.4.2.2.3.3.2" xref="S3.E14.m2.4.4.2.2.3.cmml"><mo stretchy="false" id="S3.E14.m2.4.4.2.2.3.3.2.1" xref="S3.E14.m2.4.4.2.2.3.cmml">(</mo><mn id="S3.E14.m2.2.2" xref="S3.E14.m2.2.2.cmml">0</mn><mo stretchy="false" id="S3.E14.m2.4.4.2.2.3.3.2.2" xref="S3.E14.m2.4.4.2.2.3.cmml">)</mo></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.E14.m2.4b"><apply id="S3.E14.m2.4.4.3.cmml" xref="S3.E14.m2.4.4.2"><csymbol cd="ambiguous" id="S3.E14.m2.4.4.3a.cmml" xref="S3.E14.m2.4.4.2.3">formulae-sequence</csymbol><apply id="S3.E14.m2.3.3.1.1.cmml" xref="S3.E14.m2.3.3.1.1"><eq id="S3.E14.m2.3.3.1.1.3.cmml" xref="S3.E14.m2.3.3.1.1.3"></eq><apply id="S3.E14.m2.3.3.1.1.1.cmml" xref="S3.E14.m2.3.3.1.1.1"><times id="S3.E14.m2.3.3.1.1.1.2.cmml" xref="S3.E14.m2.3.3.1.1.1.2"></times><ci id="S3.E14.m2.3.3.1.1.1.3.cmml" xref="S3.E14.m2.3.3.1.1.1.3">𝑝</ci><apply id="S3.E14.m2.3.3.1.1.1.1.1.1.cmml" xref="S3.E14.m2.3.3.1.1.1.1.1"><eq id="S3.E14.m2.3.3.1.1.1.1.1.1.2.cmml" xref="S3.E14.m2.3.3.1.1.1.1.1.1.2"></eq><apply id="S3.E14.m2.3.3.1.1.1.1.1.1.3.cmml" xref="S3.E14.m2.3.3.1.1.1.1.1.1.3"><csymbol cd="latexml" id="S3.E14.m2.3.3.1.1.1.1.1.1.3.1.cmml" xref="S3.E14.m2.3.3.1.1.1.1.1.1.3.1">conditional</csymbol><apply id="S3.E14.m2.3.3.1.1.1.1.1.1.3.2.cmml" xref="S3.E14.m2.3.3.1.1.1.1.1.1.3.2"><csymbol cd="ambiguous" id="S3.E14.m2.3.3.1.1.1.1.1.1.3.2.1.cmml" xref="S3.E14.m2.3.3.1.1.1.1.1.1.3.2">subscript</csymbol><ci id="S3.E14.m2.3.3.1.1.1.1.1.1.3.2.2.cmml" xref="S3.E14.m2.3.3.1.1.1.1.1.1.3.2.2">bold-italic-ϕ</ci><apply id="S3.E14.m2.3.3.1.1.1.1.1.1.3.2.3.cmml" xref="S3.E14.m2.3.3.1.1.1.1.1.1.3.2.3"><times id="S3.E14.m2.3.3.1.1.1.1.1.1.3.2.3.1.cmml" xref="S3.E14.m2.3.3.1.1.1.1.1.1.3.2.3.1"></times><ci id="S3.E14.m2.3.3.1.1.1.1.1.1.3.2.3.2.cmml" xref="S3.E14.m2.3.3.1.1.1.1.1.1.3.2.3.2">𝑠</ci><ci id="S3.E14.m2.3.3.1.1.1.1.1.1.3.2.3.3.cmml" xref="S3.E14.m2.3.3.1.1.1.1.1.1.3.2.3.3">𝑖</ci></apply></apply><apply id="S3.E14.m2.3.3.1.1.1.1.1.1.3.3.cmml" xref="S3.E14.m2.3.3.1.1.1.1.1.1.3.3"><csymbol cd="ambiguous" id="S3.E14.m2.3.3.1.1.1.1.1.1.3.3.1.cmml" xref="S3.E14.m2.3.3.1.1.1.1.1.1.3.3">subscript</csymbol><ci id="S3.E14.m2.3.3.1.1.1.1.1.1.3.3.2.cmml" xref="S3.E14.m2.3.3.1.1.1.1.1.1.3.3.2">𝐳</ci><apply id="S3.E14.m2.3.3.1.1.1.1.1.1.3.3.3.cmml" xref="S3.E14.m2.3.3.1.1.1.1.1.1.3.3.3"><times id="S3.E14.m2.3.3.1.1.1.1.1.1.3.3.3.1.cmml" xref="S3.E14.m2.3.3.1.1.1.1.1.1.3.3.3.1"></times><ci id="S3.E14.m2.3.3.1.1.1.1.1.1.3.3.3.2.cmml" xref="S3.E14.m2.3.3.1.1.1.1.1.1.3.3.3.2">𝑠</ci><ci id="S3.E14.m2.3.3.1.1.1.1.1.1.3.3.3.3.cmml" xref="S3.E14.m2.3.3.1.1.1.1.1.1.3.3.3.3">𝑖</ci></apply></apply></apply><list id="S3.E14.m2.3.3.1.1.1.1.1.1.1.2.cmml" xref="S3.E14.m2.3.3.1.1.1.1.1.1.1.1"><cn type="integer" id="S3.E14.m2.1.1.cmml" xref="S3.E14.m2.1.1">1</cn><apply id="S3.E14.m2.3.3.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E14.m2.3.3.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E14.m2.3.3.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E14.m2.3.3.1.1.1.1.1.1.1.1.1">subscript</csymbol><ci id="S3.E14.m2.3.3.1.1.1.1.1.1.1.1.1.2.cmml" xref="S3.E14.m2.3.3.1.1.1.1.1.1.1.1.1.2">𝐰</ci><ci id="S3.E14.m2.3.3.1.1.1.1.1.1.1.1.1.3.cmml" xref="S3.E14.m2.3.3.1.1.1.1.1.1.1.1.1.3">𝑖</ci></apply></list></apply></apply><apply id="S3.E14.m2.3.3.1.1.2.cmml" xref="S3.E14.m2.3.3.1.1.2"><times id="S3.E14.m2.3.3.1.1.2.2.cmml" xref="S3.E14.m2.3.3.1.1.2.2"></times><ci id="S3.E14.m2.3.3.1.1.2.3.cmml" xref="S3.E14.m2.3.3.1.1.2.3">𝒩</ci><apply id="S3.E14.m2.3.3.1.1.2.1.1.1.cmml" xref="S3.E14.m2.3.3.1.1.2.1.1"><csymbol cd="latexml" id="S3.E14.m2.3.3.1.1.2.1.1.1.3.cmml" xref="S3.E14.m2.3.3.1.1.2.1.1.1.3">conditional</csymbol><apply id="S3.E14.m2.3.3.1.1.2.1.1.1.4.cmml" xref="S3.E14.m2.3.3.1.1.2.1.1.1.4"><csymbol cd="ambiguous" id="S3.E14.m2.3.3.1.1.2.1.1.1.4.1.cmml" xref="S3.E14.m2.3.3.1.1.2.1.1.1.4">subscript</csymbol><ci id="S3.E14.m2.3.3.1.1.2.1.1.1.4.2.cmml" xref="S3.E14.m2.3.3.1.1.2.1.1.1.4.2">bold-italic-ϕ</ci><apply id="S3.E14.m2.3.3.1.1.2.1.1.1.4.3.cmml" xref="S3.E14.m2.3.3.1.1.2.1.1.1.4.3"><times id="S3.E14.m2.3.3.1.1.2.1.1.1.4.3.1.cmml" xref="S3.E14.m2.3.3.1.1.2.1.1.1.4.3.1"></times><ci id="S3.E14.m2.3.3.1.1.2.1.1.1.4.3.2.cmml" xref="S3.E14.m2.3.3.1.1.2.1.1.1.4.3.2">𝑠</ci><ci id="S3.E14.m2.3.3.1.1.2.1.1.1.4.3.3.cmml" xref="S3.E14.m2.3.3.1.1.2.1.1.1.4.3.3">𝑖</ci></apply></apply><list id="S3.E14.m2.3.3.1.1.2.1.1.1.2.3.cmml" xref="S3.E14.m2.3.3.1.1.2.1.1.1.2.2"><apply id="S3.E14.m2.3.3.1.1.2.1.1.1.1.1.1.cmml" xref="S3.E14.m2.3.3.1.1.2.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E14.m2.3.3.1.1.2.1.1.1.1.1.1.1.cmml" xref="S3.E14.m2.3.3.1.1.2.1.1.1.1.1.1">subscript</csymbol><ci id="S3.E14.m2.3.3.1.1.2.1.1.1.1.1.1.2.cmml" xref="S3.E14.m2.3.3.1.1.2.1.1.1.1.1.1.2">𝐰</ci><ci id="S3.E14.m2.3.3.1.1.2.1.1.1.1.1.1.3.cmml" xref="S3.E14.m2.3.3.1.1.2.1.1.1.1.1.1.3">𝑖</ci></apply><apply id="S3.E14.m2.3.3.1.1.2.1.1.1.2.2.2.cmml" xref="S3.E14.m2.3.3.1.1.2.1.1.1.2.2.2"><divide id="S3.E14.m2.3.3.1.1.2.1.1.1.2.2.2.1.cmml" xref="S3.E14.m2.3.3.1.1.2.1.1.1.2.2.2.1"></divide><cn type="integer" id="S3.E14.m2.3.3.1.1.2.1.1.1.2.2.2.2.cmml" xref="S3.E14.m2.3.3.1.1.2.1.1.1.2.2.2.2">1</cn><ci id="S3.E14.m2.3.3.1.1.2.1.1.1.2.2.2.3.cmml" xref="S3.E14.m2.3.3.1.1.2.1.1.1.2.2.2.3">𝜆</ci></apply></list></apply></apply></apply><apply id="S3.E14.m2.4.4.2.2.cmml" xref="S3.E14.m2.4.4.2.2"><eq id="S3.E14.m2.4.4.2.2.2.cmml" xref="S3.E14.m2.4.4.2.2.2"></eq><apply id="S3.E14.m2.4.4.2.2.1.cmml" xref="S3.E14.m2.4.4.2.2.1"><times id="S3.E14.m2.4.4.2.2.1.2.cmml" xref="S3.E14.m2.4.4.2.2.1.2"></times><ci id="S3.E14.m2.4.4.2.2.1.3.cmml" xref="S3.E14.m2.4.4.2.2.1.3">𝑝</ci><apply id="S3.E14.m2.4.4.2.2.1.1.1.1.cmml" xref="S3.E14.m2.4.4.2.2.1.1.1"><eq id="S3.E14.m2.4.4.2.2.1.1.1.1.1.cmml" xref="S3.E14.m2.4.4.2.2.1.1.1.1.1"></eq><apply id="S3.E14.m2.4.4.2.2.1.1.1.1.2.cmml" xref="S3.E14.m2.4.4.2.2.1.1.1.1.2"><csymbol cd="latexml" id="S3.E14.m2.4.4.2.2.1.1.1.1.2.1.cmml" xref="S3.E14.m2.4.4.2.2.1.1.1.1.2.1">conditional</csymbol><apply id="S3.E14.m2.4.4.2.2.1.1.1.1.2.2.cmml" xref="S3.E14.m2.4.4.2.2.1.1.1.1.2.2"><csymbol cd="ambiguous" id="S3.E14.m2.4.4.2.2.1.1.1.1.2.2.1.cmml" xref="S3.E14.m2.4.4.2.2.1.1.1.1.2.2">subscript</csymbol><ci id="S3.E14.m2.4.4.2.2.1.1.1.1.2.2.2.cmml" xref="S3.E14.m2.4.4.2.2.1.1.1.1.2.2.2">bold-italic-ϕ</ci><apply id="S3.E14.m2.4.4.2.2.1.1.1.1.2.2.3.cmml" xref="S3.E14.m2.4.4.2.2.1.1.1.1.2.2.3"><times id="S3.E14.m2.4.4.2.2.1.1.1.1.2.2.3.1.cmml" xref="S3.E14.m2.4.4.2.2.1.1.1.1.2.2.3.1"></times><ci id="S3.E14.m2.4.4.2.2.1.1.1.1.2.2.3.2.cmml" xref="S3.E14.m2.4.4.2.2.1.1.1.1.2.2.3.2">𝑠</ci><ci id="S3.E14.m2.4.4.2.2.1.1.1.1.2.2.3.3.cmml" xref="S3.E14.m2.4.4.2.2.1.1.1.1.2.2.3.3">𝑖</ci></apply></apply><apply id="S3.E14.m2.4.4.2.2.1.1.1.1.2.3.cmml" xref="S3.E14.m2.4.4.2.2.1.1.1.1.2.3"><csymbol cd="ambiguous" id="S3.E14.m2.4.4.2.2.1.1.1.1.2.3.1.cmml" xref="S3.E14.m2.4.4.2.2.1.1.1.1.2.3">subscript</csymbol><ci id="S3.E14.m2.4.4.2.2.1.1.1.1.2.3.2.cmml" xref="S3.E14.m2.4.4.2.2.1.1.1.1.2.3.2">𝐳</ci><apply id="S3.E14.m2.4.4.2.2.1.1.1.1.2.3.3.cmml" xref="S3.E14.m2.4.4.2.2.1.1.1.1.2.3.3"><times id="S3.E14.m2.4.4.2.2.1.1.1.1.2.3.3.1.cmml" xref="S3.E14.m2.4.4.2.2.1.1.1.1.2.3.3.1"></times><ci id="S3.E14.m2.4.4.2.2.1.1.1.1.2.3.3.2.cmml" xref="S3.E14.m2.4.4.2.2.1.1.1.1.2.3.3.2">𝑠</ci><ci id="S3.E14.m2.4.4.2.2.1.1.1.1.2.3.3.3.cmml" xref="S3.E14.m2.4.4.2.2.1.1.1.1.2.3.3.3">𝑖</ci></apply></apply></apply><cn type="integer" id="S3.E14.m2.4.4.2.2.1.1.1.1.3.cmml" xref="S3.E14.m2.4.4.2.2.1.1.1.1.3">0</cn></apply></apply><apply id="S3.E14.m2.4.4.2.2.3.cmml" xref="S3.E14.m2.4.4.2.2.3"><times id="S3.E14.m2.4.4.2.2.3.1.cmml" xref="S3.E14.m2.4.4.2.2.3.1"></times><ci id="S3.E14.m2.4.4.2.2.3.2.cmml" xref="S3.E14.m2.4.4.2.2.3.2">𝛿</ci><cn type="integer" id="S3.E14.m2.2.2.cmml" xref="S3.E14.m2.2.2">0</cn></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E14.m2.4c">\displaystyle p(\bm{\phi}_{si}|\mathbf{z}_{si}=1,\mathbf{w}_{i})=\mathcal{N}(\bm{\phi}_{si}|\mathbf{w}_{i},1/\lambda),\enskip p(\bm{\phi}_{si}|\mathbf{z}_{si}=0)=\delta(0)</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(14)</span></td>
</tr></tbody>
<tbody id="S3.E15"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_eqn_cell"></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math id="S3.E15.m1.1" class="ltx_Math" alttext="\displaystyle p(\bm{\phi}_{si}|\bm{\theta}_{i},\mathbf{w}_{i})=\sum_{\mathbf{z}_{si}}p(\mathbf{z}_{si}|\bm{\theta}_{i})p(\bm{\phi}_{si}|\mathbf{z}_{si},\mathbf{w}_{i})," display="inline"><semantics id="S3.E15.m1.1a"><mrow id="S3.E15.m1.1.1.1" xref="S3.E15.m1.1.1.1.1.cmml"><mrow id="S3.E15.m1.1.1.1.1" xref="S3.E15.m1.1.1.1.1.cmml"><mrow id="S3.E15.m1.1.1.1.1.1" xref="S3.E15.m1.1.1.1.1.1.cmml"><mi id="S3.E15.m1.1.1.1.1.1.3" xref="S3.E15.m1.1.1.1.1.1.3.cmml">p</mi><mo lspace="0em" rspace="0em" id="S3.E15.m1.1.1.1.1.1.2" xref="S3.E15.m1.1.1.1.1.1.2.cmml">​</mo><mrow id="S3.E15.m1.1.1.1.1.1.1.1" xref="S3.E15.m1.1.1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S3.E15.m1.1.1.1.1.1.1.1.2" xref="S3.E15.m1.1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="S3.E15.m1.1.1.1.1.1.1.1.1" xref="S3.E15.m1.1.1.1.1.1.1.1.1.cmml"><msub id="S3.E15.m1.1.1.1.1.1.1.1.1.4" xref="S3.E15.m1.1.1.1.1.1.1.1.1.4.cmml"><mi class="ltx_mathvariant_bold-italic" mathvariant="bold-italic" id="S3.E15.m1.1.1.1.1.1.1.1.1.4.2" xref="S3.E15.m1.1.1.1.1.1.1.1.1.4.2.cmml">ϕ</mi><mrow id="S3.E15.m1.1.1.1.1.1.1.1.1.4.3" xref="S3.E15.m1.1.1.1.1.1.1.1.1.4.3.cmml"><mi id="S3.E15.m1.1.1.1.1.1.1.1.1.4.3.2" xref="S3.E15.m1.1.1.1.1.1.1.1.1.4.3.2.cmml">s</mi><mo lspace="0em" rspace="0em" id="S3.E15.m1.1.1.1.1.1.1.1.1.4.3.1" xref="S3.E15.m1.1.1.1.1.1.1.1.1.4.3.1.cmml">​</mo><mi id="S3.E15.m1.1.1.1.1.1.1.1.1.4.3.3" xref="S3.E15.m1.1.1.1.1.1.1.1.1.4.3.3.cmml">i</mi></mrow></msub><mo fence="false" id="S3.E15.m1.1.1.1.1.1.1.1.1.3" xref="S3.E15.m1.1.1.1.1.1.1.1.1.3.cmml">|</mo><mrow id="S3.E15.m1.1.1.1.1.1.1.1.1.2.2" xref="S3.E15.m1.1.1.1.1.1.1.1.1.2.3.cmml"><msub id="S3.E15.m1.1.1.1.1.1.1.1.1.1.1.1" xref="S3.E15.m1.1.1.1.1.1.1.1.1.1.1.1.cmml"><mi id="S3.E15.m1.1.1.1.1.1.1.1.1.1.1.1.2" xref="S3.E15.m1.1.1.1.1.1.1.1.1.1.1.1.2.cmml">𝜽</mi><mi id="S3.E15.m1.1.1.1.1.1.1.1.1.1.1.1.3" xref="S3.E15.m1.1.1.1.1.1.1.1.1.1.1.1.3.cmml">i</mi></msub><mo id="S3.E15.m1.1.1.1.1.1.1.1.1.2.2.3" xref="S3.E15.m1.1.1.1.1.1.1.1.1.2.3.cmml">,</mo><msub id="S3.E15.m1.1.1.1.1.1.1.1.1.2.2.2" xref="S3.E15.m1.1.1.1.1.1.1.1.1.2.2.2.cmml"><mi id="S3.E15.m1.1.1.1.1.1.1.1.1.2.2.2.2" xref="S3.E15.m1.1.1.1.1.1.1.1.1.2.2.2.2.cmml">𝐰</mi><mi id="S3.E15.m1.1.1.1.1.1.1.1.1.2.2.2.3" xref="S3.E15.m1.1.1.1.1.1.1.1.1.2.2.2.3.cmml">i</mi></msub></mrow></mrow><mo stretchy="false" id="S3.E15.m1.1.1.1.1.1.1.1.3" xref="S3.E15.m1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S3.E15.m1.1.1.1.1.4" xref="S3.E15.m1.1.1.1.1.4.cmml">=</mo><mrow id="S3.E15.m1.1.1.1.1.3" xref="S3.E15.m1.1.1.1.1.3.cmml"><mstyle displaystyle="true" id="S3.E15.m1.1.1.1.1.3.3" xref="S3.E15.m1.1.1.1.1.3.3.cmml"><munder id="S3.E15.m1.1.1.1.1.3.3a" xref="S3.E15.m1.1.1.1.1.3.3.cmml"><mo movablelimits="false" id="S3.E15.m1.1.1.1.1.3.3.2" xref="S3.E15.m1.1.1.1.1.3.3.2.cmml">∑</mo><msub id="S3.E15.m1.1.1.1.1.3.3.3" xref="S3.E15.m1.1.1.1.1.3.3.3.cmml"><mi id="S3.E15.m1.1.1.1.1.3.3.3.2" xref="S3.E15.m1.1.1.1.1.3.3.3.2.cmml">𝐳</mi><mrow id="S3.E15.m1.1.1.1.1.3.3.3.3" xref="S3.E15.m1.1.1.1.1.3.3.3.3.cmml"><mi id="S3.E15.m1.1.1.1.1.3.3.3.3.2" xref="S3.E15.m1.1.1.1.1.3.3.3.3.2.cmml">s</mi><mo lspace="0em" rspace="0em" id="S3.E15.m1.1.1.1.1.3.3.3.3.1" xref="S3.E15.m1.1.1.1.1.3.3.3.3.1.cmml">​</mo><mi id="S3.E15.m1.1.1.1.1.3.3.3.3.3" xref="S3.E15.m1.1.1.1.1.3.3.3.3.3.cmml">i</mi></mrow></msub></munder></mstyle><mrow id="S3.E15.m1.1.1.1.1.3.2" xref="S3.E15.m1.1.1.1.1.3.2.cmml"><mi id="S3.E15.m1.1.1.1.1.3.2.4" xref="S3.E15.m1.1.1.1.1.3.2.4.cmml">p</mi><mo lspace="0em" rspace="0em" id="S3.E15.m1.1.1.1.1.3.2.3" xref="S3.E15.m1.1.1.1.1.3.2.3.cmml">​</mo><mrow id="S3.E15.m1.1.1.1.1.2.1.1.1" xref="S3.E15.m1.1.1.1.1.2.1.1.1.1.cmml"><mo stretchy="false" id="S3.E15.m1.1.1.1.1.2.1.1.1.2" xref="S3.E15.m1.1.1.1.1.2.1.1.1.1.cmml">(</mo><mrow id="S3.E15.m1.1.1.1.1.2.1.1.1.1" xref="S3.E15.m1.1.1.1.1.2.1.1.1.1.cmml"><msub id="S3.E15.m1.1.1.1.1.2.1.1.1.1.2" xref="S3.E15.m1.1.1.1.1.2.1.1.1.1.2.cmml"><mi id="S3.E15.m1.1.1.1.1.2.1.1.1.1.2.2" xref="S3.E15.m1.1.1.1.1.2.1.1.1.1.2.2.cmml">𝐳</mi><mrow id="S3.E15.m1.1.1.1.1.2.1.1.1.1.2.3" xref="S3.E15.m1.1.1.1.1.2.1.1.1.1.2.3.cmml"><mi id="S3.E15.m1.1.1.1.1.2.1.1.1.1.2.3.2" xref="S3.E15.m1.1.1.1.1.2.1.1.1.1.2.3.2.cmml">s</mi><mo lspace="0em" rspace="0em" id="S3.E15.m1.1.1.1.1.2.1.1.1.1.2.3.1" xref="S3.E15.m1.1.1.1.1.2.1.1.1.1.2.3.1.cmml">​</mo><mi id="S3.E15.m1.1.1.1.1.2.1.1.1.1.2.3.3" xref="S3.E15.m1.1.1.1.1.2.1.1.1.1.2.3.3.cmml">i</mi></mrow></msub><mo fence="false" id="S3.E15.m1.1.1.1.1.2.1.1.1.1.1" xref="S3.E15.m1.1.1.1.1.2.1.1.1.1.1.cmml">|</mo><msub id="S3.E15.m1.1.1.1.1.2.1.1.1.1.3" xref="S3.E15.m1.1.1.1.1.2.1.1.1.1.3.cmml"><mi id="S3.E15.m1.1.1.1.1.2.1.1.1.1.3.2" xref="S3.E15.m1.1.1.1.1.2.1.1.1.1.3.2.cmml">𝜽</mi><mi id="S3.E15.m1.1.1.1.1.2.1.1.1.1.3.3" xref="S3.E15.m1.1.1.1.1.2.1.1.1.1.3.3.cmml">i</mi></msub></mrow><mo stretchy="false" id="S3.E15.m1.1.1.1.1.2.1.1.1.3" xref="S3.E15.m1.1.1.1.1.2.1.1.1.1.cmml">)</mo></mrow><mo lspace="0em" rspace="0em" id="S3.E15.m1.1.1.1.1.3.2.3a" xref="S3.E15.m1.1.1.1.1.3.2.3.cmml">​</mo><mi id="S3.E15.m1.1.1.1.1.3.2.5" xref="S3.E15.m1.1.1.1.1.3.2.5.cmml">p</mi><mo lspace="0em" rspace="0em" id="S3.E15.m1.1.1.1.1.3.2.3b" xref="S3.E15.m1.1.1.1.1.3.2.3.cmml">​</mo><mrow id="S3.E15.m1.1.1.1.1.3.2.2.1" xref="S3.E15.m1.1.1.1.1.3.2.2.1.1.cmml"><mo stretchy="false" id="S3.E15.m1.1.1.1.1.3.2.2.1.2" xref="S3.E15.m1.1.1.1.1.3.2.2.1.1.cmml">(</mo><mrow id="S3.E15.m1.1.1.1.1.3.2.2.1.1" xref="S3.E15.m1.1.1.1.1.3.2.2.1.1.cmml"><msub id="S3.E15.m1.1.1.1.1.3.2.2.1.1.4" xref="S3.E15.m1.1.1.1.1.3.2.2.1.1.4.cmml"><mi class="ltx_mathvariant_bold-italic" mathvariant="bold-italic" id="S3.E15.m1.1.1.1.1.3.2.2.1.1.4.2" xref="S3.E15.m1.1.1.1.1.3.2.2.1.1.4.2.cmml">ϕ</mi><mrow id="S3.E15.m1.1.1.1.1.3.2.2.1.1.4.3" xref="S3.E15.m1.1.1.1.1.3.2.2.1.1.4.3.cmml"><mi id="S3.E15.m1.1.1.1.1.3.2.2.1.1.4.3.2" xref="S3.E15.m1.1.1.1.1.3.2.2.1.1.4.3.2.cmml">s</mi><mo lspace="0em" rspace="0em" id="S3.E15.m1.1.1.1.1.3.2.2.1.1.4.3.1" xref="S3.E15.m1.1.1.1.1.3.2.2.1.1.4.3.1.cmml">​</mo><mi id="S3.E15.m1.1.1.1.1.3.2.2.1.1.4.3.3" xref="S3.E15.m1.1.1.1.1.3.2.2.1.1.4.3.3.cmml">i</mi></mrow></msub><mo fence="false" id="S3.E15.m1.1.1.1.1.3.2.2.1.1.3" xref="S3.E15.m1.1.1.1.1.3.2.2.1.1.3.cmml">|</mo><mrow id="S3.E15.m1.1.1.1.1.3.2.2.1.1.2.2" xref="S3.E15.m1.1.1.1.1.3.2.2.1.1.2.3.cmml"><msub id="S3.E15.m1.1.1.1.1.3.2.2.1.1.1.1.1" xref="S3.E15.m1.1.1.1.1.3.2.2.1.1.1.1.1.cmml"><mi id="S3.E15.m1.1.1.1.1.3.2.2.1.1.1.1.1.2" xref="S3.E15.m1.1.1.1.1.3.2.2.1.1.1.1.1.2.cmml">𝐳</mi><mrow id="S3.E15.m1.1.1.1.1.3.2.2.1.1.1.1.1.3" xref="S3.E15.m1.1.1.1.1.3.2.2.1.1.1.1.1.3.cmml"><mi id="S3.E15.m1.1.1.1.1.3.2.2.1.1.1.1.1.3.2" xref="S3.E15.m1.1.1.1.1.3.2.2.1.1.1.1.1.3.2.cmml">s</mi><mo lspace="0em" rspace="0em" id="S3.E15.m1.1.1.1.1.3.2.2.1.1.1.1.1.3.1" xref="S3.E15.m1.1.1.1.1.3.2.2.1.1.1.1.1.3.1.cmml">​</mo><mi id="S3.E15.m1.1.1.1.1.3.2.2.1.1.1.1.1.3.3" xref="S3.E15.m1.1.1.1.1.3.2.2.1.1.1.1.1.3.3.cmml">i</mi></mrow></msub><mo id="S3.E15.m1.1.1.1.1.3.2.2.1.1.2.2.3" xref="S3.E15.m1.1.1.1.1.3.2.2.1.1.2.3.cmml">,</mo><msub id="S3.E15.m1.1.1.1.1.3.2.2.1.1.2.2.2" xref="S3.E15.m1.1.1.1.1.3.2.2.1.1.2.2.2.cmml"><mi id="S3.E15.m1.1.1.1.1.3.2.2.1.1.2.2.2.2" xref="S3.E15.m1.1.1.1.1.3.2.2.1.1.2.2.2.2.cmml">𝐰</mi><mi id="S3.E15.m1.1.1.1.1.3.2.2.1.1.2.2.2.3" xref="S3.E15.m1.1.1.1.1.3.2.2.1.1.2.2.2.3.cmml">i</mi></msub></mrow></mrow><mo stretchy="false" id="S3.E15.m1.1.1.1.1.3.2.2.1.3" xref="S3.E15.m1.1.1.1.1.3.2.2.1.1.cmml">)</mo></mrow></mrow></mrow></mrow><mo id="S3.E15.m1.1.1.1.2" xref="S3.E15.m1.1.1.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E15.m1.1b"><apply id="S3.E15.m1.1.1.1.1.cmml" xref="S3.E15.m1.1.1.1"><eq id="S3.E15.m1.1.1.1.1.4.cmml" xref="S3.E15.m1.1.1.1.1.4"></eq><apply id="S3.E15.m1.1.1.1.1.1.cmml" xref="S3.E15.m1.1.1.1.1.1"><times id="S3.E15.m1.1.1.1.1.1.2.cmml" xref="S3.E15.m1.1.1.1.1.1.2"></times><ci id="S3.E15.m1.1.1.1.1.1.3.cmml" xref="S3.E15.m1.1.1.1.1.1.3">𝑝</ci><apply id="S3.E15.m1.1.1.1.1.1.1.1.1.cmml" xref="S3.E15.m1.1.1.1.1.1.1.1"><csymbol cd="latexml" id="S3.E15.m1.1.1.1.1.1.1.1.1.3.cmml" xref="S3.E15.m1.1.1.1.1.1.1.1.1.3">conditional</csymbol><apply id="S3.E15.m1.1.1.1.1.1.1.1.1.4.cmml" xref="S3.E15.m1.1.1.1.1.1.1.1.1.4"><csymbol cd="ambiguous" id="S3.E15.m1.1.1.1.1.1.1.1.1.4.1.cmml" xref="S3.E15.m1.1.1.1.1.1.1.1.1.4">subscript</csymbol><ci id="S3.E15.m1.1.1.1.1.1.1.1.1.4.2.cmml" xref="S3.E15.m1.1.1.1.1.1.1.1.1.4.2">bold-italic-ϕ</ci><apply id="S3.E15.m1.1.1.1.1.1.1.1.1.4.3.cmml" xref="S3.E15.m1.1.1.1.1.1.1.1.1.4.3"><times id="S3.E15.m1.1.1.1.1.1.1.1.1.4.3.1.cmml" xref="S3.E15.m1.1.1.1.1.1.1.1.1.4.3.1"></times><ci id="S3.E15.m1.1.1.1.1.1.1.1.1.4.3.2.cmml" xref="S3.E15.m1.1.1.1.1.1.1.1.1.4.3.2">𝑠</ci><ci id="S3.E15.m1.1.1.1.1.1.1.1.1.4.3.3.cmml" xref="S3.E15.m1.1.1.1.1.1.1.1.1.4.3.3">𝑖</ci></apply></apply><list id="S3.E15.m1.1.1.1.1.1.1.1.1.2.3.cmml" xref="S3.E15.m1.1.1.1.1.1.1.1.1.2.2"><apply id="S3.E15.m1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E15.m1.1.1.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E15.m1.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E15.m1.1.1.1.1.1.1.1.1.1.1.1">subscript</csymbol><ci id="S3.E15.m1.1.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S3.E15.m1.1.1.1.1.1.1.1.1.1.1.1.2">𝜽</ci><ci id="S3.E15.m1.1.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="S3.E15.m1.1.1.1.1.1.1.1.1.1.1.1.3">𝑖</ci></apply><apply id="S3.E15.m1.1.1.1.1.1.1.1.1.2.2.2.cmml" xref="S3.E15.m1.1.1.1.1.1.1.1.1.2.2.2"><csymbol cd="ambiguous" id="S3.E15.m1.1.1.1.1.1.1.1.1.2.2.2.1.cmml" xref="S3.E15.m1.1.1.1.1.1.1.1.1.2.2.2">subscript</csymbol><ci id="S3.E15.m1.1.1.1.1.1.1.1.1.2.2.2.2.cmml" xref="S3.E15.m1.1.1.1.1.1.1.1.1.2.2.2.2">𝐰</ci><ci id="S3.E15.m1.1.1.1.1.1.1.1.1.2.2.2.3.cmml" xref="S3.E15.m1.1.1.1.1.1.1.1.1.2.2.2.3">𝑖</ci></apply></list></apply></apply><apply id="S3.E15.m1.1.1.1.1.3.cmml" xref="S3.E15.m1.1.1.1.1.3"><apply id="S3.E15.m1.1.1.1.1.3.3.cmml" xref="S3.E15.m1.1.1.1.1.3.3"><csymbol cd="ambiguous" id="S3.E15.m1.1.1.1.1.3.3.1.cmml" xref="S3.E15.m1.1.1.1.1.3.3">subscript</csymbol><sum id="S3.E15.m1.1.1.1.1.3.3.2.cmml" xref="S3.E15.m1.1.1.1.1.3.3.2"></sum><apply id="S3.E15.m1.1.1.1.1.3.3.3.cmml" xref="S3.E15.m1.1.1.1.1.3.3.3"><csymbol cd="ambiguous" id="S3.E15.m1.1.1.1.1.3.3.3.1.cmml" xref="S3.E15.m1.1.1.1.1.3.3.3">subscript</csymbol><ci id="S3.E15.m1.1.1.1.1.3.3.3.2.cmml" xref="S3.E15.m1.1.1.1.1.3.3.3.2">𝐳</ci><apply id="S3.E15.m1.1.1.1.1.3.3.3.3.cmml" xref="S3.E15.m1.1.1.1.1.3.3.3.3"><times id="S3.E15.m1.1.1.1.1.3.3.3.3.1.cmml" xref="S3.E15.m1.1.1.1.1.3.3.3.3.1"></times><ci id="S3.E15.m1.1.1.1.1.3.3.3.3.2.cmml" xref="S3.E15.m1.1.1.1.1.3.3.3.3.2">𝑠</ci><ci id="S3.E15.m1.1.1.1.1.3.3.3.3.3.cmml" xref="S3.E15.m1.1.1.1.1.3.3.3.3.3">𝑖</ci></apply></apply></apply><apply id="S3.E15.m1.1.1.1.1.3.2.cmml" xref="S3.E15.m1.1.1.1.1.3.2"><times id="S3.E15.m1.1.1.1.1.3.2.3.cmml" xref="S3.E15.m1.1.1.1.1.3.2.3"></times><ci id="S3.E15.m1.1.1.1.1.3.2.4.cmml" xref="S3.E15.m1.1.1.1.1.3.2.4">𝑝</ci><apply id="S3.E15.m1.1.1.1.1.2.1.1.1.1.cmml" xref="S3.E15.m1.1.1.1.1.2.1.1.1"><csymbol cd="latexml" id="S3.E15.m1.1.1.1.1.2.1.1.1.1.1.cmml" xref="S3.E15.m1.1.1.1.1.2.1.1.1.1.1">conditional</csymbol><apply id="S3.E15.m1.1.1.1.1.2.1.1.1.1.2.cmml" xref="S3.E15.m1.1.1.1.1.2.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.E15.m1.1.1.1.1.2.1.1.1.1.2.1.cmml" xref="S3.E15.m1.1.1.1.1.2.1.1.1.1.2">subscript</csymbol><ci id="S3.E15.m1.1.1.1.1.2.1.1.1.1.2.2.cmml" xref="S3.E15.m1.1.1.1.1.2.1.1.1.1.2.2">𝐳</ci><apply id="S3.E15.m1.1.1.1.1.2.1.1.1.1.2.3.cmml" xref="S3.E15.m1.1.1.1.1.2.1.1.1.1.2.3"><times id="S3.E15.m1.1.1.1.1.2.1.1.1.1.2.3.1.cmml" xref="S3.E15.m1.1.1.1.1.2.1.1.1.1.2.3.1"></times><ci id="S3.E15.m1.1.1.1.1.2.1.1.1.1.2.3.2.cmml" xref="S3.E15.m1.1.1.1.1.2.1.1.1.1.2.3.2">𝑠</ci><ci id="S3.E15.m1.1.1.1.1.2.1.1.1.1.2.3.3.cmml" xref="S3.E15.m1.1.1.1.1.2.1.1.1.1.2.3.3">𝑖</ci></apply></apply><apply id="S3.E15.m1.1.1.1.1.2.1.1.1.1.3.cmml" xref="S3.E15.m1.1.1.1.1.2.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.E15.m1.1.1.1.1.2.1.1.1.1.3.1.cmml" xref="S3.E15.m1.1.1.1.1.2.1.1.1.1.3">subscript</csymbol><ci id="S3.E15.m1.1.1.1.1.2.1.1.1.1.3.2.cmml" xref="S3.E15.m1.1.1.1.1.2.1.1.1.1.3.2">𝜽</ci><ci id="S3.E15.m1.1.1.1.1.2.1.1.1.1.3.3.cmml" xref="S3.E15.m1.1.1.1.1.2.1.1.1.1.3.3">𝑖</ci></apply></apply><ci id="S3.E15.m1.1.1.1.1.3.2.5.cmml" xref="S3.E15.m1.1.1.1.1.3.2.5">𝑝</ci><apply id="S3.E15.m1.1.1.1.1.3.2.2.1.1.cmml" xref="S3.E15.m1.1.1.1.1.3.2.2.1"><csymbol cd="latexml" id="S3.E15.m1.1.1.1.1.3.2.2.1.1.3.cmml" xref="S3.E15.m1.1.1.1.1.3.2.2.1.1.3">conditional</csymbol><apply id="S3.E15.m1.1.1.1.1.3.2.2.1.1.4.cmml" xref="S3.E15.m1.1.1.1.1.3.2.2.1.1.4"><csymbol cd="ambiguous" id="S3.E15.m1.1.1.1.1.3.2.2.1.1.4.1.cmml" xref="S3.E15.m1.1.1.1.1.3.2.2.1.1.4">subscript</csymbol><ci id="S3.E15.m1.1.1.1.1.3.2.2.1.1.4.2.cmml" xref="S3.E15.m1.1.1.1.1.3.2.2.1.1.4.2">bold-italic-ϕ</ci><apply id="S3.E15.m1.1.1.1.1.3.2.2.1.1.4.3.cmml" xref="S3.E15.m1.1.1.1.1.3.2.2.1.1.4.3"><times id="S3.E15.m1.1.1.1.1.3.2.2.1.1.4.3.1.cmml" xref="S3.E15.m1.1.1.1.1.3.2.2.1.1.4.3.1"></times><ci id="S3.E15.m1.1.1.1.1.3.2.2.1.1.4.3.2.cmml" xref="S3.E15.m1.1.1.1.1.3.2.2.1.1.4.3.2">𝑠</ci><ci id="S3.E15.m1.1.1.1.1.3.2.2.1.1.4.3.3.cmml" xref="S3.E15.m1.1.1.1.1.3.2.2.1.1.4.3.3">𝑖</ci></apply></apply><list id="S3.E15.m1.1.1.1.1.3.2.2.1.1.2.3.cmml" xref="S3.E15.m1.1.1.1.1.3.2.2.1.1.2.2"><apply id="S3.E15.m1.1.1.1.1.3.2.2.1.1.1.1.1.cmml" xref="S3.E15.m1.1.1.1.1.3.2.2.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E15.m1.1.1.1.1.3.2.2.1.1.1.1.1.1.cmml" xref="S3.E15.m1.1.1.1.1.3.2.2.1.1.1.1.1">subscript</csymbol><ci id="S3.E15.m1.1.1.1.1.3.2.2.1.1.1.1.1.2.cmml" xref="S3.E15.m1.1.1.1.1.3.2.2.1.1.1.1.1.2">𝐳</ci><apply id="S3.E15.m1.1.1.1.1.3.2.2.1.1.1.1.1.3.cmml" xref="S3.E15.m1.1.1.1.1.3.2.2.1.1.1.1.1.3"><times id="S3.E15.m1.1.1.1.1.3.2.2.1.1.1.1.1.3.1.cmml" xref="S3.E15.m1.1.1.1.1.3.2.2.1.1.1.1.1.3.1"></times><ci id="S3.E15.m1.1.1.1.1.3.2.2.1.1.1.1.1.3.2.cmml" xref="S3.E15.m1.1.1.1.1.3.2.2.1.1.1.1.1.3.2">𝑠</ci><ci id="S3.E15.m1.1.1.1.1.3.2.2.1.1.1.1.1.3.3.cmml" xref="S3.E15.m1.1.1.1.1.3.2.2.1.1.1.1.1.3.3">𝑖</ci></apply></apply><apply id="S3.E15.m1.1.1.1.1.3.2.2.1.1.2.2.2.cmml" xref="S3.E15.m1.1.1.1.1.3.2.2.1.1.2.2.2"><csymbol cd="ambiguous" id="S3.E15.m1.1.1.1.1.3.2.2.1.1.2.2.2.1.cmml" xref="S3.E15.m1.1.1.1.1.3.2.2.1.1.2.2.2">subscript</csymbol><ci id="S3.E15.m1.1.1.1.1.3.2.2.1.1.2.2.2.2.cmml" xref="S3.E15.m1.1.1.1.1.3.2.2.1.1.2.2.2.2">𝐰</ci><ci id="S3.E15.m1.1.1.1.1.3.2.2.1.1.2.2.2.3.cmml" xref="S3.E15.m1.1.1.1.1.3.2.2.1.1.2.2.2.3">𝑖</ci></apply></list></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E15.m1.1c">\displaystyle p(\bm{\phi}_{si}|\bm{\theta}_{i},\mathbf{w}_{i})=\sum_{\mathbf{z}_{si}}p(\mathbf{z}_{si}|\bm{\theta}_{i})p(\bm{\phi}_{si}|\mathbf{z}_{si},\mathbf{w}_{i}),</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(15)</span></td>
</tr></tbody>
</table>
<p id="S3.p1.6" class="ltx_p">where <math id="S3.p1.3.m1.1" class="ltx_Math" alttext="\mathbf{z}_{si}" display="inline"><semantics id="S3.p1.3.m1.1a"><msub id="S3.p1.3.m1.1.1" xref="S3.p1.3.m1.1.1.cmml"><mi id="S3.p1.3.m1.1.1.2" xref="S3.p1.3.m1.1.1.2.cmml">𝐳</mi><mrow id="S3.p1.3.m1.1.1.3" xref="S3.p1.3.m1.1.1.3.cmml"><mi id="S3.p1.3.m1.1.1.3.2" xref="S3.p1.3.m1.1.1.3.2.cmml">s</mi><mo lspace="0em" rspace="0em" id="S3.p1.3.m1.1.1.3.1" xref="S3.p1.3.m1.1.1.3.1.cmml">​</mo><mi id="S3.p1.3.m1.1.1.3.3" xref="S3.p1.3.m1.1.1.3.3.cmml">i</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S3.p1.3.m1.1b"><apply id="S3.p1.3.m1.1.1.cmml" xref="S3.p1.3.m1.1.1"><csymbol cd="ambiguous" id="S3.p1.3.m1.1.1.1.cmml" xref="S3.p1.3.m1.1.1">subscript</csymbol><ci id="S3.p1.3.m1.1.1.2.cmml" xref="S3.p1.3.m1.1.1.2">𝐳</ci><apply id="S3.p1.3.m1.1.1.3.cmml" xref="S3.p1.3.m1.1.1.3"><times id="S3.p1.3.m1.1.1.3.1.cmml" xref="S3.p1.3.m1.1.1.3.1"></times><ci id="S3.p1.3.m1.1.1.3.2.cmml" xref="S3.p1.3.m1.1.1.3.2">𝑠</ci><ci id="S3.p1.3.m1.1.1.3.3.cmml" xref="S3.p1.3.m1.1.1.3.3">𝑖</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p1.3.m1.1c">\mathbf{z}_{si}</annotation></semantics></math> plays the role of a “gating” variable that switches on or off the parameter <math id="S3.p1.4.m2.1" class="ltx_Math" alttext="\bm{\phi}_{si}" display="inline"><semantics id="S3.p1.4.m2.1a"><msub id="S3.p1.4.m2.1.1" xref="S3.p1.4.m2.1.1.cmml"><mi class="ltx_mathvariant_bold-italic" mathvariant="bold-italic" id="S3.p1.4.m2.1.1.2" xref="S3.p1.4.m2.1.1.2.cmml">ϕ</mi><mrow id="S3.p1.4.m2.1.1.3" xref="S3.p1.4.m2.1.1.3.cmml"><mi id="S3.p1.4.m2.1.1.3.2" xref="S3.p1.4.m2.1.1.3.2.cmml">s</mi><mo lspace="0em" rspace="0em" id="S3.p1.4.m2.1.1.3.1" xref="S3.p1.4.m2.1.1.3.1.cmml">​</mo><mi id="S3.p1.4.m2.1.1.3.3" xref="S3.p1.4.m2.1.1.3.3.cmml">i</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S3.p1.4.m2.1b"><apply id="S3.p1.4.m2.1.1.cmml" xref="S3.p1.4.m2.1.1"><csymbol cd="ambiguous" id="S3.p1.4.m2.1.1.1.cmml" xref="S3.p1.4.m2.1.1">subscript</csymbol><ci id="S3.p1.4.m2.1.1.2.cmml" xref="S3.p1.4.m2.1.1.2">bold-italic-ϕ</ci><apply id="S3.p1.4.m2.1.1.3.cmml" xref="S3.p1.4.m2.1.1.3"><times id="S3.p1.4.m2.1.1.3.1.cmml" xref="S3.p1.4.m2.1.1.3.1"></times><ci id="S3.p1.4.m2.1.1.3.2.cmml" xref="S3.p1.4.m2.1.1.3.2">𝑠</ci><ci id="S3.p1.4.m2.1.1.3.3.cmml" xref="S3.p1.4.m2.1.1.3.3">𝑖</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p1.4.m2.1c">\bm{\phi}_{si}</annotation></semantics></math>.
We thus modify the hierarchical model at Figure <a href="#S1.F2" title="Figure 2 ‣ 1 Introduction ‣ An Expectation-Maximization Perspective on Federated Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">2</span></a> to use this new prior. The resulting hierarchical model can be seen in Figure <a href="#S1.F2" title="Figure 2 ‣ 1 Introduction ‣ An Expectation-Maximization Perspective on Federated Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">2</span></a>, where <math id="S3.p1.5.m3.1" class="ltx_Math" alttext="\mathbf{w}" display="inline"><semantics id="S3.p1.5.m3.1a"><mi id="S3.p1.5.m3.1.1" xref="S3.p1.5.m3.1.1.cmml">𝐰</mi><annotation-xml encoding="MathML-Content" id="S3.p1.5.m3.1b"><ci id="S3.p1.5.m3.1.1.cmml" xref="S3.p1.5.m3.1.1">𝐰</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.p1.5.m3.1c">\mathbf{w}</annotation></semantics></math>, <math id="S3.p1.6.m4.1" class="ltx_Math" alttext="\bm{\theta}" display="inline"><semantics id="S3.p1.6.m4.1a"><mi id="S3.p1.6.m4.1.1" xref="S3.p1.6.m4.1.1.cmml">𝜽</mi><annotation-xml encoding="MathML-Content" id="S3.p1.6.m4.1b"><ci id="S3.p1.6.m4.1.1.cmml" xref="S3.p1.6.m4.1.1">𝜽</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.p1.6.m4.1c">\bm{\theta}</annotation></semantics></math> will be the server-side model weights and probabilities of the binary gates.</p>
</div>
<div id="S3.p2" class="ltx_para">
<p id="S3.p2.3" class="ltx_p">Following the <span id="S3.p2.3.1" class="ltx_text ltx_font_typewriter">FedAvg</span> paradigm of simple point estimation, we will use hard-EM in order to optimize <math id="S3.p2.1.m1.2" class="ltx_Math" alttext="\mathbf{w},\bm{\theta}" display="inline"><semantics id="S3.p2.1.m1.2a"><mrow id="S3.p2.1.m1.2.3.2" xref="S3.p2.1.m1.2.3.1.cmml"><mi id="S3.p2.1.m1.1.1" xref="S3.p2.1.m1.1.1.cmml">𝐰</mi><mo id="S3.p2.1.m1.2.3.2.1" xref="S3.p2.1.m1.2.3.1.cmml">,</mo><mi id="S3.p2.1.m1.2.2" xref="S3.p2.1.m1.2.2.cmml">𝜽</mi></mrow><annotation-xml encoding="MathML-Content" id="S3.p2.1.m1.2b"><list id="S3.p2.1.m1.2.3.1.cmml" xref="S3.p2.1.m1.2.3.2"><ci id="S3.p2.1.m1.1.1.cmml" xref="S3.p2.1.m1.1.1">𝐰</ci><ci id="S3.p2.1.m1.2.2.cmml" xref="S3.p2.1.m1.2.2">𝜽</ci></list></annotation-xml><annotation encoding="application/x-tex" id="S3.p2.1.m1.2c">\mathbf{w},\bm{\theta}</annotation></semantics></math>.
By using approximate distributions <math id="S3.p2.2.m2.1" class="ltx_Math" alttext="q_{\mathbf{w}_{s}}(\bm{\phi}_{s}|\mathbf{z}_{s})" display="inline"><semantics id="S3.p2.2.m2.1a"><mrow id="S3.p2.2.m2.1.1" xref="S3.p2.2.m2.1.1.cmml"><msub id="S3.p2.2.m2.1.1.3" xref="S3.p2.2.m2.1.1.3.cmml"><mi id="S3.p2.2.m2.1.1.3.2" xref="S3.p2.2.m2.1.1.3.2.cmml">q</mi><msub id="S3.p2.2.m2.1.1.3.3" xref="S3.p2.2.m2.1.1.3.3.cmml"><mi id="S3.p2.2.m2.1.1.3.3.2" xref="S3.p2.2.m2.1.1.3.3.2.cmml">𝐰</mi><mi id="S3.p2.2.m2.1.1.3.3.3" xref="S3.p2.2.m2.1.1.3.3.3.cmml">s</mi></msub></msub><mo lspace="0em" rspace="0em" id="S3.p2.2.m2.1.1.2" xref="S3.p2.2.m2.1.1.2.cmml">​</mo><mrow id="S3.p2.2.m2.1.1.1.1" xref="S3.p2.2.m2.1.1.1.1.1.cmml"><mo stretchy="false" id="S3.p2.2.m2.1.1.1.1.2" xref="S3.p2.2.m2.1.1.1.1.1.cmml">(</mo><mrow id="S3.p2.2.m2.1.1.1.1.1" xref="S3.p2.2.m2.1.1.1.1.1.cmml"><msub id="S3.p2.2.m2.1.1.1.1.1.2" xref="S3.p2.2.m2.1.1.1.1.1.2.cmml"><mi class="ltx_mathvariant_bold-italic" mathvariant="bold-italic" id="S3.p2.2.m2.1.1.1.1.1.2.2" xref="S3.p2.2.m2.1.1.1.1.1.2.2.cmml">ϕ</mi><mi id="S3.p2.2.m2.1.1.1.1.1.2.3" xref="S3.p2.2.m2.1.1.1.1.1.2.3.cmml">s</mi></msub><mo fence="false" id="S3.p2.2.m2.1.1.1.1.1.1" xref="S3.p2.2.m2.1.1.1.1.1.1.cmml">|</mo><msub id="S3.p2.2.m2.1.1.1.1.1.3" xref="S3.p2.2.m2.1.1.1.1.1.3.cmml"><mi id="S3.p2.2.m2.1.1.1.1.1.3.2" xref="S3.p2.2.m2.1.1.1.1.1.3.2.cmml">𝐳</mi><mi id="S3.p2.2.m2.1.1.1.1.1.3.3" xref="S3.p2.2.m2.1.1.1.1.1.3.3.cmml">s</mi></msub></mrow><mo stretchy="false" id="S3.p2.2.m2.1.1.1.1.3" xref="S3.p2.2.m2.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.p2.2.m2.1b"><apply id="S3.p2.2.m2.1.1.cmml" xref="S3.p2.2.m2.1.1"><times id="S3.p2.2.m2.1.1.2.cmml" xref="S3.p2.2.m2.1.1.2"></times><apply id="S3.p2.2.m2.1.1.3.cmml" xref="S3.p2.2.m2.1.1.3"><csymbol cd="ambiguous" id="S3.p2.2.m2.1.1.3.1.cmml" xref="S3.p2.2.m2.1.1.3">subscript</csymbol><ci id="S3.p2.2.m2.1.1.3.2.cmml" xref="S3.p2.2.m2.1.1.3.2">𝑞</ci><apply id="S3.p2.2.m2.1.1.3.3.cmml" xref="S3.p2.2.m2.1.1.3.3"><csymbol cd="ambiguous" id="S3.p2.2.m2.1.1.3.3.1.cmml" xref="S3.p2.2.m2.1.1.3.3">subscript</csymbol><ci id="S3.p2.2.m2.1.1.3.3.2.cmml" xref="S3.p2.2.m2.1.1.3.3.2">𝐰</ci><ci id="S3.p2.2.m2.1.1.3.3.3.cmml" xref="S3.p2.2.m2.1.1.3.3.3">𝑠</ci></apply></apply><apply id="S3.p2.2.m2.1.1.1.1.1.cmml" xref="S3.p2.2.m2.1.1.1.1"><csymbol cd="latexml" id="S3.p2.2.m2.1.1.1.1.1.1.cmml" xref="S3.p2.2.m2.1.1.1.1.1.1">conditional</csymbol><apply id="S3.p2.2.m2.1.1.1.1.1.2.cmml" xref="S3.p2.2.m2.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.p2.2.m2.1.1.1.1.1.2.1.cmml" xref="S3.p2.2.m2.1.1.1.1.1.2">subscript</csymbol><ci id="S3.p2.2.m2.1.1.1.1.1.2.2.cmml" xref="S3.p2.2.m2.1.1.1.1.1.2.2">bold-italic-ϕ</ci><ci id="S3.p2.2.m2.1.1.1.1.1.2.3.cmml" xref="S3.p2.2.m2.1.1.1.1.1.2.3">𝑠</ci></apply><apply id="S3.p2.2.m2.1.1.1.1.1.3.cmml" xref="S3.p2.2.m2.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.p2.2.m2.1.1.1.1.1.3.1.cmml" xref="S3.p2.2.m2.1.1.1.1.1.3">subscript</csymbol><ci id="S3.p2.2.m2.1.1.1.1.1.3.2.cmml" xref="S3.p2.2.m2.1.1.1.1.1.3.2">𝐳</ci><ci id="S3.p2.2.m2.1.1.1.1.1.3.3.cmml" xref="S3.p2.2.m2.1.1.1.1.1.3.3">𝑠</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p2.2.m2.1c">q_{\mathbf{w}_{s}}(\bm{\phi}_{s}|\mathbf{z}_{s})</annotation></semantics></math>, <math id="S3.p2.3.m3.1" class="ltx_Math" alttext="q_{\bm{\pi}_{s}}(\mathbf{z}_{s})" display="inline"><semantics id="S3.p2.3.m3.1a"><mrow id="S3.p2.3.m3.1.1" xref="S3.p2.3.m3.1.1.cmml"><msub id="S3.p2.3.m3.1.1.3" xref="S3.p2.3.m3.1.1.3.cmml"><mi id="S3.p2.3.m3.1.1.3.2" xref="S3.p2.3.m3.1.1.3.2.cmml">q</mi><msub id="S3.p2.3.m3.1.1.3.3" xref="S3.p2.3.m3.1.1.3.3.cmml"><mi id="S3.p2.3.m3.1.1.3.3.2" xref="S3.p2.3.m3.1.1.3.3.2.cmml">𝝅</mi><mi id="S3.p2.3.m3.1.1.3.3.3" xref="S3.p2.3.m3.1.1.3.3.3.cmml">s</mi></msub></msub><mo lspace="0em" rspace="0em" id="S3.p2.3.m3.1.1.2" xref="S3.p2.3.m3.1.1.2.cmml">​</mo><mrow id="S3.p2.3.m3.1.1.1.1" xref="S3.p2.3.m3.1.1.1.1.1.cmml"><mo stretchy="false" id="S3.p2.3.m3.1.1.1.1.2" xref="S3.p2.3.m3.1.1.1.1.1.cmml">(</mo><msub id="S3.p2.3.m3.1.1.1.1.1" xref="S3.p2.3.m3.1.1.1.1.1.cmml"><mi id="S3.p2.3.m3.1.1.1.1.1.2" xref="S3.p2.3.m3.1.1.1.1.1.2.cmml">𝐳</mi><mi id="S3.p2.3.m3.1.1.1.1.1.3" xref="S3.p2.3.m3.1.1.1.1.1.3.cmml">s</mi></msub><mo stretchy="false" id="S3.p2.3.m3.1.1.1.1.3" xref="S3.p2.3.m3.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.p2.3.m3.1b"><apply id="S3.p2.3.m3.1.1.cmml" xref="S3.p2.3.m3.1.1"><times id="S3.p2.3.m3.1.1.2.cmml" xref="S3.p2.3.m3.1.1.2"></times><apply id="S3.p2.3.m3.1.1.3.cmml" xref="S3.p2.3.m3.1.1.3"><csymbol cd="ambiguous" id="S3.p2.3.m3.1.1.3.1.cmml" xref="S3.p2.3.m3.1.1.3">subscript</csymbol><ci id="S3.p2.3.m3.1.1.3.2.cmml" xref="S3.p2.3.m3.1.1.3.2">𝑞</ci><apply id="S3.p2.3.m3.1.1.3.3.cmml" xref="S3.p2.3.m3.1.1.3.3"><csymbol cd="ambiguous" id="S3.p2.3.m3.1.1.3.3.1.cmml" xref="S3.p2.3.m3.1.1.3.3">subscript</csymbol><ci id="S3.p2.3.m3.1.1.3.3.2.cmml" xref="S3.p2.3.m3.1.1.3.3.2">𝝅</ci><ci id="S3.p2.3.m3.1.1.3.3.3.cmml" xref="S3.p2.3.m3.1.1.3.3.3">𝑠</ci></apply></apply><apply id="S3.p2.3.m3.1.1.1.1.1.cmml" xref="S3.p2.3.m3.1.1.1.1"><csymbol cd="ambiguous" id="S3.p2.3.m3.1.1.1.1.1.1.cmml" xref="S3.p2.3.m3.1.1.1.1">subscript</csymbol><ci id="S3.p2.3.m3.1.1.1.1.1.2.cmml" xref="S3.p2.3.m3.1.1.1.1.1.2">𝐳</ci><ci id="S3.p2.3.m3.1.1.1.1.1.3.cmml" xref="S3.p2.3.m3.1.1.1.1.1.3">𝑠</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p2.3.m3.1c">q_{\bm{\pi}_{s}}(\mathbf{z}_{s})</annotation></semantics></math>, the variational lower bound for this model becomes</p>
<table id="A10.EGx15" class="ltx_equationgroup ltx_eqn_align ltx_eqn_table">

<tbody id="S3.E16"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math id="S3.E16.m1.1" class="ltx_Math" alttext="\displaystyle\sum_{s}" display="inline"><semantics id="S3.E16.m1.1a"><mstyle displaystyle="true" id="S3.E16.m1.1.1" xref="S3.E16.m1.1.1.cmml"><munder id="S3.E16.m1.1.1a" xref="S3.E16.m1.1.1.cmml"><mo movablelimits="false" id="S3.E16.m1.1.1.2" xref="S3.E16.m1.1.1.2.cmml">∑</mo><mi id="S3.E16.m1.1.1.3" xref="S3.E16.m1.1.1.3.cmml">s</mi></munder></mstyle><annotation-xml encoding="MathML-Content" id="S3.E16.m1.1b"><apply id="S3.E16.m1.1.1.cmml" xref="S3.E16.m1.1.1"><csymbol cd="ambiguous" id="S3.E16.m1.1.1.1.cmml" xref="S3.E16.m1.1.1">subscript</csymbol><sum id="S3.E16.m1.1.1.2.cmml" xref="S3.E16.m1.1.1.2"></sum><ci id="S3.E16.m1.1.1.3.cmml" xref="S3.E16.m1.1.1.3">𝑠</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E16.m1.1c">\displaystyle\sum_{s}</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math id="S3.E16.m2.7" class="ltx_Math" alttext="\displaystyle\mathbb{E}_{q_{\bm{\pi}_{s},\mathbf{w}_{s}}(\mathbf{z}_{s},\bm{\phi}_{s})}\big{[}\log p(\mathcal{D}_{s}|\bm{\phi}_{s})+\log p(\bm{\phi}_{s},\mathbf{z}_{s}|\mathbf{w},\bm{\theta})-\log q_{\mathbf{w}_{s}}(\bm{\phi}_{s}|\mathbf{z}_{s})\big{]}+H[q_{\bm{\pi}_{s}}(\mathbf{z}_{s})]," display="inline"><semantics id="S3.E16.m2.7a"><mrow id="S3.E16.m2.7.7.1" xref="S3.E16.m2.7.7.1.1.cmml"><mrow id="S3.E16.m2.7.7.1.1" xref="S3.E16.m2.7.7.1.1.cmml"><mrow id="S3.E16.m2.7.7.1.1.1" xref="S3.E16.m2.7.7.1.1.1.cmml"><msub id="S3.E16.m2.7.7.1.1.1.3" xref="S3.E16.m2.7.7.1.1.1.3.cmml"><mi id="S3.E16.m2.7.7.1.1.1.3.2" xref="S3.E16.m2.7.7.1.1.1.3.2.cmml">𝔼</mi><mrow id="S3.E16.m2.4.4.4" xref="S3.E16.m2.4.4.4.cmml"><msub id="S3.E16.m2.4.4.4.6" xref="S3.E16.m2.4.4.4.6.cmml"><mi id="S3.E16.m2.4.4.4.6.2" xref="S3.E16.m2.4.4.4.6.2.cmml">q</mi><mrow id="S3.E16.m2.2.2.2.2.2.2" xref="S3.E16.m2.2.2.2.2.2.3.cmml"><msub id="S3.E16.m2.1.1.1.1.1.1.1" xref="S3.E16.m2.1.1.1.1.1.1.1.cmml"><mi id="S3.E16.m2.1.1.1.1.1.1.1.2" xref="S3.E16.m2.1.1.1.1.1.1.1.2.cmml">𝝅</mi><mi id="S3.E16.m2.1.1.1.1.1.1.1.3" xref="S3.E16.m2.1.1.1.1.1.1.1.3.cmml">s</mi></msub><mo id="S3.E16.m2.2.2.2.2.2.2.3" xref="S3.E16.m2.2.2.2.2.2.3.cmml">,</mo><msub id="S3.E16.m2.2.2.2.2.2.2.2" xref="S3.E16.m2.2.2.2.2.2.2.2.cmml"><mi id="S3.E16.m2.2.2.2.2.2.2.2.2" xref="S3.E16.m2.2.2.2.2.2.2.2.2.cmml">𝐰</mi><mi id="S3.E16.m2.2.2.2.2.2.2.2.3" xref="S3.E16.m2.2.2.2.2.2.2.2.3.cmml">s</mi></msub></mrow></msub><mo lspace="0em" rspace="0em" id="S3.E16.m2.4.4.4.5" xref="S3.E16.m2.4.4.4.5.cmml">​</mo><mrow id="S3.E16.m2.4.4.4.4.2" xref="S3.E16.m2.4.4.4.4.3.cmml"><mo stretchy="false" id="S3.E16.m2.4.4.4.4.2.3" xref="S3.E16.m2.4.4.4.4.3.cmml">(</mo><msub id="S3.E16.m2.3.3.3.3.1.1" xref="S3.E16.m2.3.3.3.3.1.1.cmml"><mi id="S3.E16.m2.3.3.3.3.1.1.2" xref="S3.E16.m2.3.3.3.3.1.1.2.cmml">𝐳</mi><mi id="S3.E16.m2.3.3.3.3.1.1.3" xref="S3.E16.m2.3.3.3.3.1.1.3.cmml">s</mi></msub><mo id="S3.E16.m2.4.4.4.4.2.4" xref="S3.E16.m2.4.4.4.4.3.cmml">,</mo><msub id="S3.E16.m2.4.4.4.4.2.2" xref="S3.E16.m2.4.4.4.4.2.2.cmml"><mi class="ltx_mathvariant_bold-italic" mathvariant="bold-italic" id="S3.E16.m2.4.4.4.4.2.2.2" xref="S3.E16.m2.4.4.4.4.2.2.2.cmml">ϕ</mi><mi id="S3.E16.m2.4.4.4.4.2.2.3" xref="S3.E16.m2.4.4.4.4.2.2.3.cmml">s</mi></msub><mo stretchy="false" id="S3.E16.m2.4.4.4.4.2.5" xref="S3.E16.m2.4.4.4.4.3.cmml">)</mo></mrow></mrow></msub><mo lspace="0em" rspace="0em" id="S3.E16.m2.7.7.1.1.1.2" xref="S3.E16.m2.7.7.1.1.1.2.cmml">​</mo><mrow id="S3.E16.m2.7.7.1.1.1.1.1" xref="S3.E16.m2.7.7.1.1.1.1.2.cmml"><mo maxsize="120%" minsize="120%" id="S3.E16.m2.7.7.1.1.1.1.1.2" xref="S3.E16.m2.7.7.1.1.1.1.2.1.cmml">[</mo><mrow id="S3.E16.m2.7.7.1.1.1.1.1.1" xref="S3.E16.m2.7.7.1.1.1.1.1.1.cmml"><mrow id="S3.E16.m2.7.7.1.1.1.1.1.1.3" xref="S3.E16.m2.7.7.1.1.1.1.1.1.3.cmml"><mrow id="S3.E16.m2.7.7.1.1.1.1.1.1.1.1" xref="S3.E16.m2.7.7.1.1.1.1.1.1.1.1.cmml"><mrow id="S3.E16.m2.7.7.1.1.1.1.1.1.1.1.3" xref="S3.E16.m2.7.7.1.1.1.1.1.1.1.1.3.cmml"><mi id="S3.E16.m2.7.7.1.1.1.1.1.1.1.1.3.1" xref="S3.E16.m2.7.7.1.1.1.1.1.1.1.1.3.1.cmml">log</mi><mo lspace="0.167em" id="S3.E16.m2.7.7.1.1.1.1.1.1.1.1.3a" xref="S3.E16.m2.7.7.1.1.1.1.1.1.1.1.3.cmml">⁡</mo><mi id="S3.E16.m2.7.7.1.1.1.1.1.1.1.1.3.2" xref="S3.E16.m2.7.7.1.1.1.1.1.1.1.1.3.2.cmml">p</mi></mrow><mo lspace="0em" rspace="0em" id="S3.E16.m2.7.7.1.1.1.1.1.1.1.1.2" xref="S3.E16.m2.7.7.1.1.1.1.1.1.1.1.2.cmml">​</mo><mrow id="S3.E16.m2.7.7.1.1.1.1.1.1.1.1.1.1" xref="S3.E16.m2.7.7.1.1.1.1.1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S3.E16.m2.7.7.1.1.1.1.1.1.1.1.1.1.2" xref="S3.E16.m2.7.7.1.1.1.1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="S3.E16.m2.7.7.1.1.1.1.1.1.1.1.1.1.1" xref="S3.E16.m2.7.7.1.1.1.1.1.1.1.1.1.1.1.cmml"><msub id="S3.E16.m2.7.7.1.1.1.1.1.1.1.1.1.1.1.2" xref="S3.E16.m2.7.7.1.1.1.1.1.1.1.1.1.1.1.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.E16.m2.7.7.1.1.1.1.1.1.1.1.1.1.1.2.2" xref="S3.E16.m2.7.7.1.1.1.1.1.1.1.1.1.1.1.2.2.cmml">𝒟</mi><mi id="S3.E16.m2.7.7.1.1.1.1.1.1.1.1.1.1.1.2.3" xref="S3.E16.m2.7.7.1.1.1.1.1.1.1.1.1.1.1.2.3.cmml">s</mi></msub><mo fence="false" id="S3.E16.m2.7.7.1.1.1.1.1.1.1.1.1.1.1.1" xref="S3.E16.m2.7.7.1.1.1.1.1.1.1.1.1.1.1.1.cmml">|</mo><msub id="S3.E16.m2.7.7.1.1.1.1.1.1.1.1.1.1.1.3" xref="S3.E16.m2.7.7.1.1.1.1.1.1.1.1.1.1.1.3.cmml"><mi class="ltx_mathvariant_bold-italic" mathvariant="bold-italic" id="S3.E16.m2.7.7.1.1.1.1.1.1.1.1.1.1.1.3.2" xref="S3.E16.m2.7.7.1.1.1.1.1.1.1.1.1.1.1.3.2.cmml">ϕ</mi><mi id="S3.E16.m2.7.7.1.1.1.1.1.1.1.1.1.1.1.3.3" xref="S3.E16.m2.7.7.1.1.1.1.1.1.1.1.1.1.1.3.3.cmml">s</mi></msub></mrow><mo stretchy="false" id="S3.E16.m2.7.7.1.1.1.1.1.1.1.1.1.1.3" xref="S3.E16.m2.7.7.1.1.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S3.E16.m2.7.7.1.1.1.1.1.1.3.4" xref="S3.E16.m2.7.7.1.1.1.1.1.1.3.4.cmml">+</mo><mrow id="S3.E16.m2.7.7.1.1.1.1.1.1.3.3" xref="S3.E16.m2.7.7.1.1.1.1.1.1.3.3.cmml"><mrow id="S3.E16.m2.7.7.1.1.1.1.1.1.3.3.4" xref="S3.E16.m2.7.7.1.1.1.1.1.1.3.3.4.cmml"><mi id="S3.E16.m2.7.7.1.1.1.1.1.1.3.3.4.1" xref="S3.E16.m2.7.7.1.1.1.1.1.1.3.3.4.1.cmml">log</mi><mo lspace="0.167em" id="S3.E16.m2.7.7.1.1.1.1.1.1.3.3.4a" xref="S3.E16.m2.7.7.1.1.1.1.1.1.3.3.4.cmml">⁡</mo><mi id="S3.E16.m2.7.7.1.1.1.1.1.1.3.3.4.2" xref="S3.E16.m2.7.7.1.1.1.1.1.1.3.3.4.2.cmml">p</mi></mrow><mo lspace="0em" rspace="0em" id="S3.E16.m2.7.7.1.1.1.1.1.1.3.3.3" xref="S3.E16.m2.7.7.1.1.1.1.1.1.3.3.3.cmml">​</mo><mrow id="S3.E16.m2.7.7.1.1.1.1.1.1.3.3.2.2" xref="S3.E16.m2.7.7.1.1.1.1.1.1.3.3.2.3.cmml"><mo stretchy="false" id="S3.E16.m2.7.7.1.1.1.1.1.1.3.3.2.2.3" xref="S3.E16.m2.7.7.1.1.1.1.1.1.3.3.2.3.cmml">(</mo><msub id="S3.E16.m2.7.7.1.1.1.1.1.1.2.2.1.1.1" xref="S3.E16.m2.7.7.1.1.1.1.1.1.2.2.1.1.1.cmml"><mi class="ltx_mathvariant_bold-italic" mathvariant="bold-italic" id="S3.E16.m2.7.7.1.1.1.1.1.1.2.2.1.1.1.2" xref="S3.E16.m2.7.7.1.1.1.1.1.1.2.2.1.1.1.2.cmml">ϕ</mi><mi id="S3.E16.m2.7.7.1.1.1.1.1.1.2.2.1.1.1.3" xref="S3.E16.m2.7.7.1.1.1.1.1.1.2.2.1.1.1.3.cmml">s</mi></msub><mo id="S3.E16.m2.7.7.1.1.1.1.1.1.3.3.2.2.4" xref="S3.E16.m2.7.7.1.1.1.1.1.1.3.3.2.3.cmml">,</mo><mrow id="S3.E16.m2.7.7.1.1.1.1.1.1.3.3.2.2.2" xref="S3.E16.m2.7.7.1.1.1.1.1.1.3.3.2.2.2.cmml"><msub id="S3.E16.m2.7.7.1.1.1.1.1.1.3.3.2.2.2.2" xref="S3.E16.m2.7.7.1.1.1.1.1.1.3.3.2.2.2.2.cmml"><mi id="S3.E16.m2.7.7.1.1.1.1.1.1.3.3.2.2.2.2.2" xref="S3.E16.m2.7.7.1.1.1.1.1.1.3.3.2.2.2.2.2.cmml">𝐳</mi><mi id="S3.E16.m2.7.7.1.1.1.1.1.1.3.3.2.2.2.2.3" xref="S3.E16.m2.7.7.1.1.1.1.1.1.3.3.2.2.2.2.3.cmml">s</mi></msub><mo fence="false" id="S3.E16.m2.7.7.1.1.1.1.1.1.3.3.2.2.2.1" xref="S3.E16.m2.7.7.1.1.1.1.1.1.3.3.2.2.2.1.cmml">|</mo><mrow id="S3.E16.m2.7.7.1.1.1.1.1.1.3.3.2.2.2.3.2" xref="S3.E16.m2.7.7.1.1.1.1.1.1.3.3.2.2.2.3.1.cmml"><mi id="S3.E16.m2.5.5" xref="S3.E16.m2.5.5.cmml">𝐰</mi><mo id="S3.E16.m2.7.7.1.1.1.1.1.1.3.3.2.2.2.3.2.1" xref="S3.E16.m2.7.7.1.1.1.1.1.1.3.3.2.2.2.3.1.cmml">,</mo><mi id="S3.E16.m2.6.6" xref="S3.E16.m2.6.6.cmml">𝜽</mi></mrow></mrow><mo stretchy="false" id="S3.E16.m2.7.7.1.1.1.1.1.1.3.3.2.2.5" xref="S3.E16.m2.7.7.1.1.1.1.1.1.3.3.2.3.cmml">)</mo></mrow></mrow></mrow><mo id="S3.E16.m2.7.7.1.1.1.1.1.1.5" xref="S3.E16.m2.7.7.1.1.1.1.1.1.5.cmml">−</mo><mrow id="S3.E16.m2.7.7.1.1.1.1.1.1.4" xref="S3.E16.m2.7.7.1.1.1.1.1.1.4.cmml"><mrow id="S3.E16.m2.7.7.1.1.1.1.1.1.4.3" xref="S3.E16.m2.7.7.1.1.1.1.1.1.4.3.cmml"><mi id="S3.E16.m2.7.7.1.1.1.1.1.1.4.3.1" xref="S3.E16.m2.7.7.1.1.1.1.1.1.4.3.1.cmml">log</mi><mo lspace="0.167em" id="S3.E16.m2.7.7.1.1.1.1.1.1.4.3a" xref="S3.E16.m2.7.7.1.1.1.1.1.1.4.3.cmml">⁡</mo><msub id="S3.E16.m2.7.7.1.1.1.1.1.1.4.3.2" xref="S3.E16.m2.7.7.1.1.1.1.1.1.4.3.2.cmml"><mi id="S3.E16.m2.7.7.1.1.1.1.1.1.4.3.2.2" xref="S3.E16.m2.7.7.1.1.1.1.1.1.4.3.2.2.cmml">q</mi><msub id="S3.E16.m2.7.7.1.1.1.1.1.1.4.3.2.3" xref="S3.E16.m2.7.7.1.1.1.1.1.1.4.3.2.3.cmml"><mi id="S3.E16.m2.7.7.1.1.1.1.1.1.4.3.2.3.2" xref="S3.E16.m2.7.7.1.1.1.1.1.1.4.3.2.3.2.cmml">𝐰</mi><mi id="S3.E16.m2.7.7.1.1.1.1.1.1.4.3.2.3.3" xref="S3.E16.m2.7.7.1.1.1.1.1.1.4.3.2.3.3.cmml">s</mi></msub></msub></mrow><mo lspace="0em" rspace="0em" id="S3.E16.m2.7.7.1.1.1.1.1.1.4.2" xref="S3.E16.m2.7.7.1.1.1.1.1.1.4.2.cmml">​</mo><mrow id="S3.E16.m2.7.7.1.1.1.1.1.1.4.1.1" xref="S3.E16.m2.7.7.1.1.1.1.1.1.4.1.1.1.cmml"><mo stretchy="false" id="S3.E16.m2.7.7.1.1.1.1.1.1.4.1.1.2" xref="S3.E16.m2.7.7.1.1.1.1.1.1.4.1.1.1.cmml">(</mo><mrow id="S3.E16.m2.7.7.1.1.1.1.1.1.4.1.1.1" xref="S3.E16.m2.7.7.1.1.1.1.1.1.4.1.1.1.cmml"><msub id="S3.E16.m2.7.7.1.1.1.1.1.1.4.1.1.1.2" xref="S3.E16.m2.7.7.1.1.1.1.1.1.4.1.1.1.2.cmml"><mi class="ltx_mathvariant_bold-italic" mathvariant="bold-italic" id="S3.E16.m2.7.7.1.1.1.1.1.1.4.1.1.1.2.2" xref="S3.E16.m2.7.7.1.1.1.1.1.1.4.1.1.1.2.2.cmml">ϕ</mi><mi id="S3.E16.m2.7.7.1.1.1.1.1.1.4.1.1.1.2.3" xref="S3.E16.m2.7.7.1.1.1.1.1.1.4.1.1.1.2.3.cmml">s</mi></msub><mo fence="false" id="S3.E16.m2.7.7.1.1.1.1.1.1.4.1.1.1.1" xref="S3.E16.m2.7.7.1.1.1.1.1.1.4.1.1.1.1.cmml">|</mo><msub id="S3.E16.m2.7.7.1.1.1.1.1.1.4.1.1.1.3" xref="S3.E16.m2.7.7.1.1.1.1.1.1.4.1.1.1.3.cmml"><mi id="S3.E16.m2.7.7.1.1.1.1.1.1.4.1.1.1.3.2" xref="S3.E16.m2.7.7.1.1.1.1.1.1.4.1.1.1.3.2.cmml">𝐳</mi><mi id="S3.E16.m2.7.7.1.1.1.1.1.1.4.1.1.1.3.3" xref="S3.E16.m2.7.7.1.1.1.1.1.1.4.1.1.1.3.3.cmml">s</mi></msub></mrow><mo stretchy="false" id="S3.E16.m2.7.7.1.1.1.1.1.1.4.1.1.3" xref="S3.E16.m2.7.7.1.1.1.1.1.1.4.1.1.1.cmml">)</mo></mrow></mrow></mrow><mo maxsize="120%" minsize="120%" id="S3.E16.m2.7.7.1.1.1.1.1.3" xref="S3.E16.m2.7.7.1.1.1.1.2.1.cmml">]</mo></mrow></mrow><mo id="S3.E16.m2.7.7.1.1.3" xref="S3.E16.m2.7.7.1.1.3.cmml">+</mo><mrow id="S3.E16.m2.7.7.1.1.2" xref="S3.E16.m2.7.7.1.1.2.cmml"><mi id="S3.E16.m2.7.7.1.1.2.3" xref="S3.E16.m2.7.7.1.1.2.3.cmml">H</mi><mo lspace="0em" rspace="0em" id="S3.E16.m2.7.7.1.1.2.2" xref="S3.E16.m2.7.7.1.1.2.2.cmml">​</mo><mrow id="S3.E16.m2.7.7.1.1.2.1.1" xref="S3.E16.m2.7.7.1.1.2.1.2.cmml"><mo stretchy="false" id="S3.E16.m2.7.7.1.1.2.1.1.2" xref="S3.E16.m2.7.7.1.1.2.1.2.1.cmml">[</mo><mrow id="S3.E16.m2.7.7.1.1.2.1.1.1" xref="S3.E16.m2.7.7.1.1.2.1.1.1.cmml"><msub id="S3.E16.m2.7.7.1.1.2.1.1.1.3" xref="S3.E16.m2.7.7.1.1.2.1.1.1.3.cmml"><mi id="S3.E16.m2.7.7.1.1.2.1.1.1.3.2" xref="S3.E16.m2.7.7.1.1.2.1.1.1.3.2.cmml">q</mi><msub id="S3.E16.m2.7.7.1.1.2.1.1.1.3.3" xref="S3.E16.m2.7.7.1.1.2.1.1.1.3.3.cmml"><mi id="S3.E16.m2.7.7.1.1.2.1.1.1.3.3.2" xref="S3.E16.m2.7.7.1.1.2.1.1.1.3.3.2.cmml">𝝅</mi><mi id="S3.E16.m2.7.7.1.1.2.1.1.1.3.3.3" xref="S3.E16.m2.7.7.1.1.2.1.1.1.3.3.3.cmml">s</mi></msub></msub><mo lspace="0em" rspace="0em" id="S3.E16.m2.7.7.1.1.2.1.1.1.2" xref="S3.E16.m2.7.7.1.1.2.1.1.1.2.cmml">​</mo><mrow id="S3.E16.m2.7.7.1.1.2.1.1.1.1.1" xref="S3.E16.m2.7.7.1.1.2.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S3.E16.m2.7.7.1.1.2.1.1.1.1.1.2" xref="S3.E16.m2.7.7.1.1.2.1.1.1.1.1.1.cmml">(</mo><msub id="S3.E16.m2.7.7.1.1.2.1.1.1.1.1.1" xref="S3.E16.m2.7.7.1.1.2.1.1.1.1.1.1.cmml"><mi id="S3.E16.m2.7.7.1.1.2.1.1.1.1.1.1.2" xref="S3.E16.m2.7.7.1.1.2.1.1.1.1.1.1.2.cmml">𝐳</mi><mi id="S3.E16.m2.7.7.1.1.2.1.1.1.1.1.1.3" xref="S3.E16.m2.7.7.1.1.2.1.1.1.1.1.1.3.cmml">s</mi></msub><mo stretchy="false" id="S3.E16.m2.7.7.1.1.2.1.1.1.1.1.3" xref="S3.E16.m2.7.7.1.1.2.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo stretchy="false" id="S3.E16.m2.7.7.1.1.2.1.1.3" xref="S3.E16.m2.7.7.1.1.2.1.2.1.cmml">]</mo></mrow></mrow></mrow><mo id="S3.E16.m2.7.7.1.2" xref="S3.E16.m2.7.7.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E16.m2.7b"><apply id="S3.E16.m2.7.7.1.1.cmml" xref="S3.E16.m2.7.7.1"><plus id="S3.E16.m2.7.7.1.1.3.cmml" xref="S3.E16.m2.7.7.1.1.3"></plus><apply id="S3.E16.m2.7.7.1.1.1.cmml" xref="S3.E16.m2.7.7.1.1.1"><times id="S3.E16.m2.7.7.1.1.1.2.cmml" xref="S3.E16.m2.7.7.1.1.1.2"></times><apply id="S3.E16.m2.7.7.1.1.1.3.cmml" xref="S3.E16.m2.7.7.1.1.1.3"><csymbol cd="ambiguous" id="S3.E16.m2.7.7.1.1.1.3.1.cmml" xref="S3.E16.m2.7.7.1.1.1.3">subscript</csymbol><ci id="S3.E16.m2.7.7.1.1.1.3.2.cmml" xref="S3.E16.m2.7.7.1.1.1.3.2">𝔼</ci><apply id="S3.E16.m2.4.4.4.cmml" xref="S3.E16.m2.4.4.4"><times id="S3.E16.m2.4.4.4.5.cmml" xref="S3.E16.m2.4.4.4.5"></times><apply id="S3.E16.m2.4.4.4.6.cmml" xref="S3.E16.m2.4.4.4.6"><csymbol cd="ambiguous" id="S3.E16.m2.4.4.4.6.1.cmml" xref="S3.E16.m2.4.4.4.6">subscript</csymbol><ci id="S3.E16.m2.4.4.4.6.2.cmml" xref="S3.E16.m2.4.4.4.6.2">𝑞</ci><list id="S3.E16.m2.2.2.2.2.2.3.cmml" xref="S3.E16.m2.2.2.2.2.2.2"><apply id="S3.E16.m2.1.1.1.1.1.1.1.cmml" xref="S3.E16.m2.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E16.m2.1.1.1.1.1.1.1.1.cmml" xref="S3.E16.m2.1.1.1.1.1.1.1">subscript</csymbol><ci id="S3.E16.m2.1.1.1.1.1.1.1.2.cmml" xref="S3.E16.m2.1.1.1.1.1.1.1.2">𝝅</ci><ci id="S3.E16.m2.1.1.1.1.1.1.1.3.cmml" xref="S3.E16.m2.1.1.1.1.1.1.1.3">𝑠</ci></apply><apply id="S3.E16.m2.2.2.2.2.2.2.2.cmml" xref="S3.E16.m2.2.2.2.2.2.2.2"><csymbol cd="ambiguous" id="S3.E16.m2.2.2.2.2.2.2.2.1.cmml" xref="S3.E16.m2.2.2.2.2.2.2.2">subscript</csymbol><ci id="S3.E16.m2.2.2.2.2.2.2.2.2.cmml" xref="S3.E16.m2.2.2.2.2.2.2.2.2">𝐰</ci><ci id="S3.E16.m2.2.2.2.2.2.2.2.3.cmml" xref="S3.E16.m2.2.2.2.2.2.2.2.3">𝑠</ci></apply></list></apply><interval closure="open" id="S3.E16.m2.4.4.4.4.3.cmml" xref="S3.E16.m2.4.4.4.4.2"><apply id="S3.E16.m2.3.3.3.3.1.1.cmml" xref="S3.E16.m2.3.3.3.3.1.1"><csymbol cd="ambiguous" id="S3.E16.m2.3.3.3.3.1.1.1.cmml" xref="S3.E16.m2.3.3.3.3.1.1">subscript</csymbol><ci id="S3.E16.m2.3.3.3.3.1.1.2.cmml" xref="S3.E16.m2.3.3.3.3.1.1.2">𝐳</ci><ci id="S3.E16.m2.3.3.3.3.1.1.3.cmml" xref="S3.E16.m2.3.3.3.3.1.1.3">𝑠</ci></apply><apply id="S3.E16.m2.4.4.4.4.2.2.cmml" xref="S3.E16.m2.4.4.4.4.2.2"><csymbol cd="ambiguous" id="S3.E16.m2.4.4.4.4.2.2.1.cmml" xref="S3.E16.m2.4.4.4.4.2.2">subscript</csymbol><ci id="S3.E16.m2.4.4.4.4.2.2.2.cmml" xref="S3.E16.m2.4.4.4.4.2.2.2">bold-italic-ϕ</ci><ci id="S3.E16.m2.4.4.4.4.2.2.3.cmml" xref="S3.E16.m2.4.4.4.4.2.2.3">𝑠</ci></apply></interval></apply></apply><apply id="S3.E16.m2.7.7.1.1.1.1.2.cmml" xref="S3.E16.m2.7.7.1.1.1.1.1"><csymbol cd="latexml" id="S3.E16.m2.7.7.1.1.1.1.2.1.cmml" xref="S3.E16.m2.7.7.1.1.1.1.1.2">delimited-[]</csymbol><apply id="S3.E16.m2.7.7.1.1.1.1.1.1.cmml" xref="S3.E16.m2.7.7.1.1.1.1.1.1"><minus id="S3.E16.m2.7.7.1.1.1.1.1.1.5.cmml" xref="S3.E16.m2.7.7.1.1.1.1.1.1.5"></minus><apply id="S3.E16.m2.7.7.1.1.1.1.1.1.3.cmml" xref="S3.E16.m2.7.7.1.1.1.1.1.1.3"><plus id="S3.E16.m2.7.7.1.1.1.1.1.1.3.4.cmml" xref="S3.E16.m2.7.7.1.1.1.1.1.1.3.4"></plus><apply id="S3.E16.m2.7.7.1.1.1.1.1.1.1.1.cmml" xref="S3.E16.m2.7.7.1.1.1.1.1.1.1.1"><times id="S3.E16.m2.7.7.1.1.1.1.1.1.1.1.2.cmml" xref="S3.E16.m2.7.7.1.1.1.1.1.1.1.1.2"></times><apply id="S3.E16.m2.7.7.1.1.1.1.1.1.1.1.3.cmml" xref="S3.E16.m2.7.7.1.1.1.1.1.1.1.1.3"><log id="S3.E16.m2.7.7.1.1.1.1.1.1.1.1.3.1.cmml" xref="S3.E16.m2.7.7.1.1.1.1.1.1.1.1.3.1"></log><ci id="S3.E16.m2.7.7.1.1.1.1.1.1.1.1.3.2.cmml" xref="S3.E16.m2.7.7.1.1.1.1.1.1.1.1.3.2">𝑝</ci></apply><apply id="S3.E16.m2.7.7.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E16.m2.7.7.1.1.1.1.1.1.1.1.1.1"><csymbol cd="latexml" id="S3.E16.m2.7.7.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E16.m2.7.7.1.1.1.1.1.1.1.1.1.1.1.1">conditional</csymbol><apply id="S3.E16.m2.7.7.1.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S3.E16.m2.7.7.1.1.1.1.1.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.E16.m2.7.7.1.1.1.1.1.1.1.1.1.1.1.2.1.cmml" xref="S3.E16.m2.7.7.1.1.1.1.1.1.1.1.1.1.1.2">subscript</csymbol><ci id="S3.E16.m2.7.7.1.1.1.1.1.1.1.1.1.1.1.2.2.cmml" xref="S3.E16.m2.7.7.1.1.1.1.1.1.1.1.1.1.1.2.2">𝒟</ci><ci id="S3.E16.m2.7.7.1.1.1.1.1.1.1.1.1.1.1.2.3.cmml" xref="S3.E16.m2.7.7.1.1.1.1.1.1.1.1.1.1.1.2.3">𝑠</ci></apply><apply id="S3.E16.m2.7.7.1.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="S3.E16.m2.7.7.1.1.1.1.1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.E16.m2.7.7.1.1.1.1.1.1.1.1.1.1.1.3.1.cmml" xref="S3.E16.m2.7.7.1.1.1.1.1.1.1.1.1.1.1.3">subscript</csymbol><ci id="S3.E16.m2.7.7.1.1.1.1.1.1.1.1.1.1.1.3.2.cmml" xref="S3.E16.m2.7.7.1.1.1.1.1.1.1.1.1.1.1.3.2">bold-italic-ϕ</ci><ci id="S3.E16.m2.7.7.1.1.1.1.1.1.1.1.1.1.1.3.3.cmml" xref="S3.E16.m2.7.7.1.1.1.1.1.1.1.1.1.1.1.3.3">𝑠</ci></apply></apply></apply><apply id="S3.E16.m2.7.7.1.1.1.1.1.1.3.3.cmml" xref="S3.E16.m2.7.7.1.1.1.1.1.1.3.3"><times id="S3.E16.m2.7.7.1.1.1.1.1.1.3.3.3.cmml" xref="S3.E16.m2.7.7.1.1.1.1.1.1.3.3.3"></times><apply id="S3.E16.m2.7.7.1.1.1.1.1.1.3.3.4.cmml" xref="S3.E16.m2.7.7.1.1.1.1.1.1.3.3.4"><log id="S3.E16.m2.7.7.1.1.1.1.1.1.3.3.4.1.cmml" xref="S3.E16.m2.7.7.1.1.1.1.1.1.3.3.4.1"></log><ci id="S3.E16.m2.7.7.1.1.1.1.1.1.3.3.4.2.cmml" xref="S3.E16.m2.7.7.1.1.1.1.1.1.3.3.4.2">𝑝</ci></apply><interval closure="open" id="S3.E16.m2.7.7.1.1.1.1.1.1.3.3.2.3.cmml" xref="S3.E16.m2.7.7.1.1.1.1.1.1.3.3.2.2"><apply id="S3.E16.m2.7.7.1.1.1.1.1.1.2.2.1.1.1.cmml" xref="S3.E16.m2.7.7.1.1.1.1.1.1.2.2.1.1.1"><csymbol cd="ambiguous" id="S3.E16.m2.7.7.1.1.1.1.1.1.2.2.1.1.1.1.cmml" xref="S3.E16.m2.7.7.1.1.1.1.1.1.2.2.1.1.1">subscript</csymbol><ci id="S3.E16.m2.7.7.1.1.1.1.1.1.2.2.1.1.1.2.cmml" xref="S3.E16.m2.7.7.1.1.1.1.1.1.2.2.1.1.1.2">bold-italic-ϕ</ci><ci id="S3.E16.m2.7.7.1.1.1.1.1.1.2.2.1.1.1.3.cmml" xref="S3.E16.m2.7.7.1.1.1.1.1.1.2.2.1.1.1.3">𝑠</ci></apply><apply id="S3.E16.m2.7.7.1.1.1.1.1.1.3.3.2.2.2.cmml" xref="S3.E16.m2.7.7.1.1.1.1.1.1.3.3.2.2.2"><csymbol cd="latexml" id="S3.E16.m2.7.7.1.1.1.1.1.1.3.3.2.2.2.1.cmml" xref="S3.E16.m2.7.7.1.1.1.1.1.1.3.3.2.2.2.1">conditional</csymbol><apply id="S3.E16.m2.7.7.1.1.1.1.1.1.3.3.2.2.2.2.cmml" xref="S3.E16.m2.7.7.1.1.1.1.1.1.3.3.2.2.2.2"><csymbol cd="ambiguous" id="S3.E16.m2.7.7.1.1.1.1.1.1.3.3.2.2.2.2.1.cmml" xref="S3.E16.m2.7.7.1.1.1.1.1.1.3.3.2.2.2.2">subscript</csymbol><ci id="S3.E16.m2.7.7.1.1.1.1.1.1.3.3.2.2.2.2.2.cmml" xref="S3.E16.m2.7.7.1.1.1.1.1.1.3.3.2.2.2.2.2">𝐳</ci><ci id="S3.E16.m2.7.7.1.1.1.1.1.1.3.3.2.2.2.2.3.cmml" xref="S3.E16.m2.7.7.1.1.1.1.1.1.3.3.2.2.2.2.3">𝑠</ci></apply><list id="S3.E16.m2.7.7.1.1.1.1.1.1.3.3.2.2.2.3.1.cmml" xref="S3.E16.m2.7.7.1.1.1.1.1.1.3.3.2.2.2.3.2"><ci id="S3.E16.m2.5.5.cmml" xref="S3.E16.m2.5.5">𝐰</ci><ci id="S3.E16.m2.6.6.cmml" xref="S3.E16.m2.6.6">𝜽</ci></list></apply></interval></apply></apply><apply id="S3.E16.m2.7.7.1.1.1.1.1.1.4.cmml" xref="S3.E16.m2.7.7.1.1.1.1.1.1.4"><times id="S3.E16.m2.7.7.1.1.1.1.1.1.4.2.cmml" xref="S3.E16.m2.7.7.1.1.1.1.1.1.4.2"></times><apply id="S3.E16.m2.7.7.1.1.1.1.1.1.4.3.cmml" xref="S3.E16.m2.7.7.1.1.1.1.1.1.4.3"><log id="S3.E16.m2.7.7.1.1.1.1.1.1.4.3.1.cmml" xref="S3.E16.m2.7.7.1.1.1.1.1.1.4.3.1"></log><apply id="S3.E16.m2.7.7.1.1.1.1.1.1.4.3.2.cmml" xref="S3.E16.m2.7.7.1.1.1.1.1.1.4.3.2"><csymbol cd="ambiguous" id="S3.E16.m2.7.7.1.1.1.1.1.1.4.3.2.1.cmml" xref="S3.E16.m2.7.7.1.1.1.1.1.1.4.3.2">subscript</csymbol><ci id="S3.E16.m2.7.7.1.1.1.1.1.1.4.3.2.2.cmml" xref="S3.E16.m2.7.7.1.1.1.1.1.1.4.3.2.2">𝑞</ci><apply id="S3.E16.m2.7.7.1.1.1.1.1.1.4.3.2.3.cmml" xref="S3.E16.m2.7.7.1.1.1.1.1.1.4.3.2.3"><csymbol cd="ambiguous" id="S3.E16.m2.7.7.1.1.1.1.1.1.4.3.2.3.1.cmml" xref="S3.E16.m2.7.7.1.1.1.1.1.1.4.3.2.3">subscript</csymbol><ci id="S3.E16.m2.7.7.1.1.1.1.1.1.4.3.2.3.2.cmml" xref="S3.E16.m2.7.7.1.1.1.1.1.1.4.3.2.3.2">𝐰</ci><ci id="S3.E16.m2.7.7.1.1.1.1.1.1.4.3.2.3.3.cmml" xref="S3.E16.m2.7.7.1.1.1.1.1.1.4.3.2.3.3">𝑠</ci></apply></apply></apply><apply id="S3.E16.m2.7.7.1.1.1.1.1.1.4.1.1.1.cmml" xref="S3.E16.m2.7.7.1.1.1.1.1.1.4.1.1"><csymbol cd="latexml" id="S3.E16.m2.7.7.1.1.1.1.1.1.4.1.1.1.1.cmml" xref="S3.E16.m2.7.7.1.1.1.1.1.1.4.1.1.1.1">conditional</csymbol><apply id="S3.E16.m2.7.7.1.1.1.1.1.1.4.1.1.1.2.cmml" xref="S3.E16.m2.7.7.1.1.1.1.1.1.4.1.1.1.2"><csymbol cd="ambiguous" id="S3.E16.m2.7.7.1.1.1.1.1.1.4.1.1.1.2.1.cmml" xref="S3.E16.m2.7.7.1.1.1.1.1.1.4.1.1.1.2">subscript</csymbol><ci id="S3.E16.m2.7.7.1.1.1.1.1.1.4.1.1.1.2.2.cmml" xref="S3.E16.m2.7.7.1.1.1.1.1.1.4.1.1.1.2.2">bold-italic-ϕ</ci><ci id="S3.E16.m2.7.7.1.1.1.1.1.1.4.1.1.1.2.3.cmml" xref="S3.E16.m2.7.7.1.1.1.1.1.1.4.1.1.1.2.3">𝑠</ci></apply><apply id="S3.E16.m2.7.7.1.1.1.1.1.1.4.1.1.1.3.cmml" xref="S3.E16.m2.7.7.1.1.1.1.1.1.4.1.1.1.3"><csymbol cd="ambiguous" id="S3.E16.m2.7.7.1.1.1.1.1.1.4.1.1.1.3.1.cmml" xref="S3.E16.m2.7.7.1.1.1.1.1.1.4.1.1.1.3">subscript</csymbol><ci id="S3.E16.m2.7.7.1.1.1.1.1.1.4.1.1.1.3.2.cmml" xref="S3.E16.m2.7.7.1.1.1.1.1.1.4.1.1.1.3.2">𝐳</ci><ci id="S3.E16.m2.7.7.1.1.1.1.1.1.4.1.1.1.3.3.cmml" xref="S3.E16.m2.7.7.1.1.1.1.1.1.4.1.1.1.3.3">𝑠</ci></apply></apply></apply></apply></apply></apply><apply id="S3.E16.m2.7.7.1.1.2.cmml" xref="S3.E16.m2.7.7.1.1.2"><times id="S3.E16.m2.7.7.1.1.2.2.cmml" xref="S3.E16.m2.7.7.1.1.2.2"></times><ci id="S3.E16.m2.7.7.1.1.2.3.cmml" xref="S3.E16.m2.7.7.1.1.2.3">𝐻</ci><apply id="S3.E16.m2.7.7.1.1.2.1.2.cmml" xref="S3.E16.m2.7.7.1.1.2.1.1"><csymbol cd="latexml" id="S3.E16.m2.7.7.1.1.2.1.2.1.cmml" xref="S3.E16.m2.7.7.1.1.2.1.1.2">delimited-[]</csymbol><apply id="S3.E16.m2.7.7.1.1.2.1.1.1.cmml" xref="S3.E16.m2.7.7.1.1.2.1.1.1"><times id="S3.E16.m2.7.7.1.1.2.1.1.1.2.cmml" xref="S3.E16.m2.7.7.1.1.2.1.1.1.2"></times><apply id="S3.E16.m2.7.7.1.1.2.1.1.1.3.cmml" xref="S3.E16.m2.7.7.1.1.2.1.1.1.3"><csymbol cd="ambiguous" id="S3.E16.m2.7.7.1.1.2.1.1.1.3.1.cmml" xref="S3.E16.m2.7.7.1.1.2.1.1.1.3">subscript</csymbol><ci id="S3.E16.m2.7.7.1.1.2.1.1.1.3.2.cmml" xref="S3.E16.m2.7.7.1.1.2.1.1.1.3.2">𝑞</ci><apply id="S3.E16.m2.7.7.1.1.2.1.1.1.3.3.cmml" xref="S3.E16.m2.7.7.1.1.2.1.1.1.3.3"><csymbol cd="ambiguous" id="S3.E16.m2.7.7.1.1.2.1.1.1.3.3.1.cmml" xref="S3.E16.m2.7.7.1.1.2.1.1.1.3.3">subscript</csymbol><ci id="S3.E16.m2.7.7.1.1.2.1.1.1.3.3.2.cmml" xref="S3.E16.m2.7.7.1.1.2.1.1.1.3.3.2">𝝅</ci><ci id="S3.E16.m2.7.7.1.1.2.1.1.1.3.3.3.cmml" xref="S3.E16.m2.7.7.1.1.2.1.1.1.3.3.3">𝑠</ci></apply></apply><apply id="S3.E16.m2.7.7.1.1.2.1.1.1.1.1.1.cmml" xref="S3.E16.m2.7.7.1.1.2.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E16.m2.7.7.1.1.2.1.1.1.1.1.1.1.cmml" xref="S3.E16.m2.7.7.1.1.2.1.1.1.1.1">subscript</csymbol><ci id="S3.E16.m2.7.7.1.1.2.1.1.1.1.1.1.2.cmml" xref="S3.E16.m2.7.7.1.1.2.1.1.1.1.1.1.2">𝐳</ci><ci id="S3.E16.m2.7.7.1.1.2.1.1.1.1.1.1.3.cmml" xref="S3.E16.m2.7.7.1.1.2.1.1.1.1.1.1.3">𝑠</ci></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E16.m2.7c">\displaystyle\mathbb{E}_{q_{\bm{\pi}_{s},\mathbf{w}_{s}}(\mathbf{z}_{s},\bm{\phi}_{s})}\big{[}\log p(\mathcal{D}_{s}|\bm{\phi}_{s})+\log p(\bm{\phi}_{s},\mathbf{z}_{s}|\mathbf{w},\bm{\theta})-\log q_{\mathbf{w}_{s}}(\bm{\phi}_{s}|\mathbf{z}_{s})\big{]}+H[q_{\bm{\pi}_{s}}(\mathbf{z}_{s})],</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(16)</span></td>
</tr></tbody>
</table>
<p id="S3.p2.13" class="ltx_p">which is to be optimized with respect to <math id="S3.p2.4.m1.4" class="ltx_Math" alttext="\mathbf{w}_{1:S},\mathbf{w},\bm{\pi}_{1:S},\bm{\theta}" display="inline"><semantics id="S3.p2.4.m1.4a"><mrow id="S3.p2.4.m1.4.4.2" xref="S3.p2.4.m1.4.4.3.cmml"><msub id="S3.p2.4.m1.3.3.1.1" xref="S3.p2.4.m1.3.3.1.1.cmml"><mi id="S3.p2.4.m1.3.3.1.1.2" xref="S3.p2.4.m1.3.3.1.1.2.cmml">𝐰</mi><mrow id="S3.p2.4.m1.3.3.1.1.3" xref="S3.p2.4.m1.3.3.1.1.3.cmml"><mn id="S3.p2.4.m1.3.3.1.1.3.2" xref="S3.p2.4.m1.3.3.1.1.3.2.cmml">1</mn><mo lspace="0.278em" rspace="0.278em" id="S3.p2.4.m1.3.3.1.1.3.1" xref="S3.p2.4.m1.3.3.1.1.3.1.cmml">:</mo><mi id="S3.p2.4.m1.3.3.1.1.3.3" xref="S3.p2.4.m1.3.3.1.1.3.3.cmml">S</mi></mrow></msub><mo id="S3.p2.4.m1.4.4.2.3" xref="S3.p2.4.m1.4.4.3.cmml">,</mo><mi id="S3.p2.4.m1.1.1" xref="S3.p2.4.m1.1.1.cmml">𝐰</mi><mo id="S3.p2.4.m1.4.4.2.4" xref="S3.p2.4.m1.4.4.3.cmml">,</mo><msub id="S3.p2.4.m1.4.4.2.2" xref="S3.p2.4.m1.4.4.2.2.cmml"><mi id="S3.p2.4.m1.4.4.2.2.2" xref="S3.p2.4.m1.4.4.2.2.2.cmml">𝝅</mi><mrow id="S3.p2.4.m1.4.4.2.2.3" xref="S3.p2.4.m1.4.4.2.2.3.cmml"><mn id="S3.p2.4.m1.4.4.2.2.3.2" xref="S3.p2.4.m1.4.4.2.2.3.2.cmml">1</mn><mo lspace="0.278em" rspace="0.278em" id="S3.p2.4.m1.4.4.2.2.3.1" xref="S3.p2.4.m1.4.4.2.2.3.1.cmml">:</mo><mi id="S3.p2.4.m1.4.4.2.2.3.3" xref="S3.p2.4.m1.4.4.2.2.3.3.cmml">S</mi></mrow></msub><mo id="S3.p2.4.m1.4.4.2.5" xref="S3.p2.4.m1.4.4.3.cmml">,</mo><mi id="S3.p2.4.m1.2.2" xref="S3.p2.4.m1.2.2.cmml">𝜽</mi></mrow><annotation-xml encoding="MathML-Content" id="S3.p2.4.m1.4b"><list id="S3.p2.4.m1.4.4.3.cmml" xref="S3.p2.4.m1.4.4.2"><apply id="S3.p2.4.m1.3.3.1.1.cmml" xref="S3.p2.4.m1.3.3.1.1"><csymbol cd="ambiguous" id="S3.p2.4.m1.3.3.1.1.1.cmml" xref="S3.p2.4.m1.3.3.1.1">subscript</csymbol><ci id="S3.p2.4.m1.3.3.1.1.2.cmml" xref="S3.p2.4.m1.3.3.1.1.2">𝐰</ci><apply id="S3.p2.4.m1.3.3.1.1.3.cmml" xref="S3.p2.4.m1.3.3.1.1.3"><ci id="S3.p2.4.m1.3.3.1.1.3.1.cmml" xref="S3.p2.4.m1.3.3.1.1.3.1">:</ci><cn type="integer" id="S3.p2.4.m1.3.3.1.1.3.2.cmml" xref="S3.p2.4.m1.3.3.1.1.3.2">1</cn><ci id="S3.p2.4.m1.3.3.1.1.3.3.cmml" xref="S3.p2.4.m1.3.3.1.1.3.3">𝑆</ci></apply></apply><ci id="S3.p2.4.m1.1.1.cmml" xref="S3.p2.4.m1.1.1">𝐰</ci><apply id="S3.p2.4.m1.4.4.2.2.cmml" xref="S3.p2.4.m1.4.4.2.2"><csymbol cd="ambiguous" id="S3.p2.4.m1.4.4.2.2.1.cmml" xref="S3.p2.4.m1.4.4.2.2">subscript</csymbol><ci id="S3.p2.4.m1.4.4.2.2.2.cmml" xref="S3.p2.4.m1.4.4.2.2.2">𝝅</ci><apply id="S3.p2.4.m1.4.4.2.2.3.cmml" xref="S3.p2.4.m1.4.4.2.2.3"><ci id="S3.p2.4.m1.4.4.2.2.3.1.cmml" xref="S3.p2.4.m1.4.4.2.2.3.1">:</ci><cn type="integer" id="S3.p2.4.m1.4.4.2.2.3.2.cmml" xref="S3.p2.4.m1.4.4.2.2.3.2">1</cn><ci id="S3.p2.4.m1.4.4.2.2.3.3.cmml" xref="S3.p2.4.m1.4.4.2.2.3.3">𝑆</ci></apply></apply><ci id="S3.p2.4.m1.2.2.cmml" xref="S3.p2.4.m1.2.2">𝜽</ci></list></annotation-xml><annotation encoding="application/x-tex" id="S3.p2.4.m1.4c">\mathbf{w}_{1:S},\mathbf{w},\bm{\pi}_{1:S},\bm{\theta}</annotation></semantics></math>.
For the shard specific weight distributions, as they are continuous, we will use <math id="S3.p2.5.m2.5" class="ltx_Math" alttext="q_{\mathbf{w}_{s}}(\bm{\phi}_{si}|\mathbf{z}_{si}=1):=\mathcal{N}(\mathbf{w}_{si},\epsilon),q(\bm{\phi}_{si}|\mathbf{z}_{si}=1):=\mathcal{N}(0,\epsilon)" display="inline"><semantics id="S3.p2.5.m2.5a"><mrow id="S3.p2.5.m2.5.5.2" xref="S3.p2.5.m2.5.5.3.cmml"><mrow id="S3.p2.5.m2.4.4.1.1" xref="S3.p2.5.m2.4.4.1.1.cmml"><mrow id="S3.p2.5.m2.4.4.1.1.1" xref="S3.p2.5.m2.4.4.1.1.1.cmml"><msub id="S3.p2.5.m2.4.4.1.1.1.3" xref="S3.p2.5.m2.4.4.1.1.1.3.cmml"><mi id="S3.p2.5.m2.4.4.1.1.1.3.2" xref="S3.p2.5.m2.4.4.1.1.1.3.2.cmml">q</mi><msub id="S3.p2.5.m2.4.4.1.1.1.3.3" xref="S3.p2.5.m2.4.4.1.1.1.3.3.cmml"><mi id="S3.p2.5.m2.4.4.1.1.1.3.3.2" xref="S3.p2.5.m2.4.4.1.1.1.3.3.2.cmml">𝐰</mi><mi id="S3.p2.5.m2.4.4.1.1.1.3.3.3" xref="S3.p2.5.m2.4.4.1.1.1.3.3.3.cmml">s</mi></msub></msub><mo lspace="0em" rspace="0em" id="S3.p2.5.m2.4.4.1.1.1.2" xref="S3.p2.5.m2.4.4.1.1.1.2.cmml">​</mo><mrow id="S3.p2.5.m2.4.4.1.1.1.1.1" xref="S3.p2.5.m2.4.4.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S3.p2.5.m2.4.4.1.1.1.1.1.2" xref="S3.p2.5.m2.4.4.1.1.1.1.1.1.cmml">(</mo><mrow id="S3.p2.5.m2.4.4.1.1.1.1.1.1" xref="S3.p2.5.m2.4.4.1.1.1.1.1.1.cmml"><mrow id="S3.p2.5.m2.4.4.1.1.1.1.1.1.2" xref="S3.p2.5.m2.4.4.1.1.1.1.1.1.2.cmml"><msub id="S3.p2.5.m2.4.4.1.1.1.1.1.1.2.2" xref="S3.p2.5.m2.4.4.1.1.1.1.1.1.2.2.cmml"><mi class="ltx_mathvariant_bold-italic" mathvariant="bold-italic" id="S3.p2.5.m2.4.4.1.1.1.1.1.1.2.2.2" xref="S3.p2.5.m2.4.4.1.1.1.1.1.1.2.2.2.cmml">ϕ</mi><mrow id="S3.p2.5.m2.4.4.1.1.1.1.1.1.2.2.3" xref="S3.p2.5.m2.4.4.1.1.1.1.1.1.2.2.3.cmml"><mi id="S3.p2.5.m2.4.4.1.1.1.1.1.1.2.2.3.2" xref="S3.p2.5.m2.4.4.1.1.1.1.1.1.2.2.3.2.cmml">s</mi><mo lspace="0em" rspace="0em" id="S3.p2.5.m2.4.4.1.1.1.1.1.1.2.2.3.1" xref="S3.p2.5.m2.4.4.1.1.1.1.1.1.2.2.3.1.cmml">​</mo><mi id="S3.p2.5.m2.4.4.1.1.1.1.1.1.2.2.3.3" xref="S3.p2.5.m2.4.4.1.1.1.1.1.1.2.2.3.3.cmml">i</mi></mrow></msub><mo fence="false" id="S3.p2.5.m2.4.4.1.1.1.1.1.1.2.1" xref="S3.p2.5.m2.4.4.1.1.1.1.1.1.2.1.cmml">|</mo><msub id="S3.p2.5.m2.4.4.1.1.1.1.1.1.2.3" xref="S3.p2.5.m2.4.4.1.1.1.1.1.1.2.3.cmml"><mi id="S3.p2.5.m2.4.4.1.1.1.1.1.1.2.3.2" xref="S3.p2.5.m2.4.4.1.1.1.1.1.1.2.3.2.cmml">𝐳</mi><mrow id="S3.p2.5.m2.4.4.1.1.1.1.1.1.2.3.3" xref="S3.p2.5.m2.4.4.1.1.1.1.1.1.2.3.3.cmml"><mi id="S3.p2.5.m2.4.4.1.1.1.1.1.1.2.3.3.2" xref="S3.p2.5.m2.4.4.1.1.1.1.1.1.2.3.3.2.cmml">s</mi><mo lspace="0em" rspace="0em" id="S3.p2.5.m2.4.4.1.1.1.1.1.1.2.3.3.1" xref="S3.p2.5.m2.4.4.1.1.1.1.1.1.2.3.3.1.cmml">​</mo><mi id="S3.p2.5.m2.4.4.1.1.1.1.1.1.2.3.3.3" xref="S3.p2.5.m2.4.4.1.1.1.1.1.1.2.3.3.3.cmml">i</mi></mrow></msub></mrow><mo id="S3.p2.5.m2.4.4.1.1.1.1.1.1.1" xref="S3.p2.5.m2.4.4.1.1.1.1.1.1.1.cmml">=</mo><mn id="S3.p2.5.m2.4.4.1.1.1.1.1.1.3" xref="S3.p2.5.m2.4.4.1.1.1.1.1.1.3.cmml">1</mn></mrow><mo rspace="0.278em" stretchy="false" id="S3.p2.5.m2.4.4.1.1.1.1.1.3" xref="S3.p2.5.m2.4.4.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo rspace="0.278em" id="S3.p2.5.m2.4.4.1.1.3" xref="S3.p2.5.m2.4.4.1.1.3.cmml">:=</mo><mrow id="S3.p2.5.m2.4.4.1.1.2" xref="S3.p2.5.m2.4.4.1.1.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.p2.5.m2.4.4.1.1.2.3" xref="S3.p2.5.m2.4.4.1.1.2.3.cmml">𝒩</mi><mo lspace="0em" rspace="0em" id="S3.p2.5.m2.4.4.1.1.2.2" xref="S3.p2.5.m2.4.4.1.1.2.2.cmml">​</mo><mrow id="S3.p2.5.m2.4.4.1.1.2.1.1" xref="S3.p2.5.m2.4.4.1.1.2.1.2.cmml"><mo stretchy="false" id="S3.p2.5.m2.4.4.1.1.2.1.1.2" xref="S3.p2.5.m2.4.4.1.1.2.1.2.cmml">(</mo><msub id="S3.p2.5.m2.4.4.1.1.2.1.1.1" xref="S3.p2.5.m2.4.4.1.1.2.1.1.1.cmml"><mi id="S3.p2.5.m2.4.4.1.1.2.1.1.1.2" xref="S3.p2.5.m2.4.4.1.1.2.1.1.1.2.cmml">𝐰</mi><mrow id="S3.p2.5.m2.4.4.1.1.2.1.1.1.3" xref="S3.p2.5.m2.4.4.1.1.2.1.1.1.3.cmml"><mi id="S3.p2.5.m2.4.4.1.1.2.1.1.1.3.2" xref="S3.p2.5.m2.4.4.1.1.2.1.1.1.3.2.cmml">s</mi><mo lspace="0em" rspace="0em" id="S3.p2.5.m2.4.4.1.1.2.1.1.1.3.1" xref="S3.p2.5.m2.4.4.1.1.2.1.1.1.3.1.cmml">​</mo><mi id="S3.p2.5.m2.4.4.1.1.2.1.1.1.3.3" xref="S3.p2.5.m2.4.4.1.1.2.1.1.1.3.3.cmml">i</mi></mrow></msub><mo id="S3.p2.5.m2.4.4.1.1.2.1.1.3" xref="S3.p2.5.m2.4.4.1.1.2.1.2.cmml">,</mo><mi id="S3.p2.5.m2.1.1" xref="S3.p2.5.m2.1.1.cmml">ϵ</mi><mo stretchy="false" id="S3.p2.5.m2.4.4.1.1.2.1.1.4" xref="S3.p2.5.m2.4.4.1.1.2.1.2.cmml">)</mo></mrow></mrow></mrow><mo id="S3.p2.5.m2.5.5.2.3" xref="S3.p2.5.m2.5.5.3a.cmml">,</mo><mrow id="S3.p2.5.m2.5.5.2.2" xref="S3.p2.5.m2.5.5.2.2.cmml"><mrow id="S3.p2.5.m2.5.5.2.2.1" xref="S3.p2.5.m2.5.5.2.2.1.cmml"><mi id="S3.p2.5.m2.5.5.2.2.1.3" xref="S3.p2.5.m2.5.5.2.2.1.3.cmml">q</mi><mo lspace="0em" rspace="0em" id="S3.p2.5.m2.5.5.2.2.1.2" xref="S3.p2.5.m2.5.5.2.2.1.2.cmml">​</mo><mrow id="S3.p2.5.m2.5.5.2.2.1.1.1" xref="S3.p2.5.m2.5.5.2.2.1.1.1.1.cmml"><mo stretchy="false" id="S3.p2.5.m2.5.5.2.2.1.1.1.2" xref="S3.p2.5.m2.5.5.2.2.1.1.1.1.cmml">(</mo><mrow id="S3.p2.5.m2.5.5.2.2.1.1.1.1" xref="S3.p2.5.m2.5.5.2.2.1.1.1.1.cmml"><mrow id="S3.p2.5.m2.5.5.2.2.1.1.1.1.2" xref="S3.p2.5.m2.5.5.2.2.1.1.1.1.2.cmml"><msub id="S3.p2.5.m2.5.5.2.2.1.1.1.1.2.2" xref="S3.p2.5.m2.5.5.2.2.1.1.1.1.2.2.cmml"><mi class="ltx_mathvariant_bold-italic" mathvariant="bold-italic" id="S3.p2.5.m2.5.5.2.2.1.1.1.1.2.2.2" xref="S3.p2.5.m2.5.5.2.2.1.1.1.1.2.2.2.cmml">ϕ</mi><mrow id="S3.p2.5.m2.5.5.2.2.1.1.1.1.2.2.3" xref="S3.p2.5.m2.5.5.2.2.1.1.1.1.2.2.3.cmml"><mi id="S3.p2.5.m2.5.5.2.2.1.1.1.1.2.2.3.2" xref="S3.p2.5.m2.5.5.2.2.1.1.1.1.2.2.3.2.cmml">s</mi><mo lspace="0em" rspace="0em" id="S3.p2.5.m2.5.5.2.2.1.1.1.1.2.2.3.1" xref="S3.p2.5.m2.5.5.2.2.1.1.1.1.2.2.3.1.cmml">​</mo><mi id="S3.p2.5.m2.5.5.2.2.1.1.1.1.2.2.3.3" xref="S3.p2.5.m2.5.5.2.2.1.1.1.1.2.2.3.3.cmml">i</mi></mrow></msub><mo fence="false" id="S3.p2.5.m2.5.5.2.2.1.1.1.1.2.1" xref="S3.p2.5.m2.5.5.2.2.1.1.1.1.2.1.cmml">|</mo><msub id="S3.p2.5.m2.5.5.2.2.1.1.1.1.2.3" xref="S3.p2.5.m2.5.5.2.2.1.1.1.1.2.3.cmml"><mi id="S3.p2.5.m2.5.5.2.2.1.1.1.1.2.3.2" xref="S3.p2.5.m2.5.5.2.2.1.1.1.1.2.3.2.cmml">𝐳</mi><mrow id="S3.p2.5.m2.5.5.2.2.1.1.1.1.2.3.3" xref="S3.p2.5.m2.5.5.2.2.1.1.1.1.2.3.3.cmml"><mi id="S3.p2.5.m2.5.5.2.2.1.1.1.1.2.3.3.2" xref="S3.p2.5.m2.5.5.2.2.1.1.1.1.2.3.3.2.cmml">s</mi><mo lspace="0em" rspace="0em" id="S3.p2.5.m2.5.5.2.2.1.1.1.1.2.3.3.1" xref="S3.p2.5.m2.5.5.2.2.1.1.1.1.2.3.3.1.cmml">​</mo><mi id="S3.p2.5.m2.5.5.2.2.1.1.1.1.2.3.3.3" xref="S3.p2.5.m2.5.5.2.2.1.1.1.1.2.3.3.3.cmml">i</mi></mrow></msub></mrow><mo id="S3.p2.5.m2.5.5.2.2.1.1.1.1.1" xref="S3.p2.5.m2.5.5.2.2.1.1.1.1.1.cmml">=</mo><mn id="S3.p2.5.m2.5.5.2.2.1.1.1.1.3" xref="S3.p2.5.m2.5.5.2.2.1.1.1.1.3.cmml">1</mn></mrow><mo rspace="0.278em" stretchy="false" id="S3.p2.5.m2.5.5.2.2.1.1.1.3" xref="S3.p2.5.m2.5.5.2.2.1.1.1.1.cmml">)</mo></mrow></mrow><mo rspace="0.278em" id="S3.p2.5.m2.5.5.2.2.2" xref="S3.p2.5.m2.5.5.2.2.2.cmml">:=</mo><mrow id="S3.p2.5.m2.5.5.2.2.3" xref="S3.p2.5.m2.5.5.2.2.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.p2.5.m2.5.5.2.2.3.2" xref="S3.p2.5.m2.5.5.2.2.3.2.cmml">𝒩</mi><mo lspace="0em" rspace="0em" id="S3.p2.5.m2.5.5.2.2.3.1" xref="S3.p2.5.m2.5.5.2.2.3.1.cmml">​</mo><mrow id="S3.p2.5.m2.5.5.2.2.3.3.2" xref="S3.p2.5.m2.5.5.2.2.3.3.1.cmml"><mo stretchy="false" id="S3.p2.5.m2.5.5.2.2.3.3.2.1" xref="S3.p2.5.m2.5.5.2.2.3.3.1.cmml">(</mo><mn id="S3.p2.5.m2.2.2" xref="S3.p2.5.m2.2.2.cmml">0</mn><mo id="S3.p2.5.m2.5.5.2.2.3.3.2.2" xref="S3.p2.5.m2.5.5.2.2.3.3.1.cmml">,</mo><mi id="S3.p2.5.m2.3.3" xref="S3.p2.5.m2.3.3.cmml">ϵ</mi><mo stretchy="false" id="S3.p2.5.m2.5.5.2.2.3.3.2.3" xref="S3.p2.5.m2.5.5.2.2.3.3.1.cmml">)</mo></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.p2.5.m2.5b"><apply id="S3.p2.5.m2.5.5.3.cmml" xref="S3.p2.5.m2.5.5.2"><csymbol cd="ambiguous" id="S3.p2.5.m2.5.5.3a.cmml" xref="S3.p2.5.m2.5.5.2.3">formulae-sequence</csymbol><apply id="S3.p2.5.m2.4.4.1.1.cmml" xref="S3.p2.5.m2.4.4.1.1"><csymbol cd="latexml" id="S3.p2.5.m2.4.4.1.1.3.cmml" xref="S3.p2.5.m2.4.4.1.1.3">assign</csymbol><apply id="S3.p2.5.m2.4.4.1.1.1.cmml" xref="S3.p2.5.m2.4.4.1.1.1"><times id="S3.p2.5.m2.4.4.1.1.1.2.cmml" xref="S3.p2.5.m2.4.4.1.1.1.2"></times><apply id="S3.p2.5.m2.4.4.1.1.1.3.cmml" xref="S3.p2.5.m2.4.4.1.1.1.3"><csymbol cd="ambiguous" id="S3.p2.5.m2.4.4.1.1.1.3.1.cmml" xref="S3.p2.5.m2.4.4.1.1.1.3">subscript</csymbol><ci id="S3.p2.5.m2.4.4.1.1.1.3.2.cmml" xref="S3.p2.5.m2.4.4.1.1.1.3.2">𝑞</ci><apply id="S3.p2.5.m2.4.4.1.1.1.3.3.cmml" xref="S3.p2.5.m2.4.4.1.1.1.3.3"><csymbol cd="ambiguous" id="S3.p2.5.m2.4.4.1.1.1.3.3.1.cmml" xref="S3.p2.5.m2.4.4.1.1.1.3.3">subscript</csymbol><ci id="S3.p2.5.m2.4.4.1.1.1.3.3.2.cmml" xref="S3.p2.5.m2.4.4.1.1.1.3.3.2">𝐰</ci><ci id="S3.p2.5.m2.4.4.1.1.1.3.3.3.cmml" xref="S3.p2.5.m2.4.4.1.1.1.3.3.3">𝑠</ci></apply></apply><apply id="S3.p2.5.m2.4.4.1.1.1.1.1.1.cmml" xref="S3.p2.5.m2.4.4.1.1.1.1.1"><eq id="S3.p2.5.m2.4.4.1.1.1.1.1.1.1.cmml" xref="S3.p2.5.m2.4.4.1.1.1.1.1.1.1"></eq><apply id="S3.p2.5.m2.4.4.1.1.1.1.1.1.2.cmml" xref="S3.p2.5.m2.4.4.1.1.1.1.1.1.2"><csymbol cd="latexml" id="S3.p2.5.m2.4.4.1.1.1.1.1.1.2.1.cmml" xref="S3.p2.5.m2.4.4.1.1.1.1.1.1.2.1">conditional</csymbol><apply id="S3.p2.5.m2.4.4.1.1.1.1.1.1.2.2.cmml" xref="S3.p2.5.m2.4.4.1.1.1.1.1.1.2.2"><csymbol cd="ambiguous" id="S3.p2.5.m2.4.4.1.1.1.1.1.1.2.2.1.cmml" xref="S3.p2.5.m2.4.4.1.1.1.1.1.1.2.2">subscript</csymbol><ci id="S3.p2.5.m2.4.4.1.1.1.1.1.1.2.2.2.cmml" xref="S3.p2.5.m2.4.4.1.1.1.1.1.1.2.2.2">bold-italic-ϕ</ci><apply id="S3.p2.5.m2.4.4.1.1.1.1.1.1.2.2.3.cmml" xref="S3.p2.5.m2.4.4.1.1.1.1.1.1.2.2.3"><times id="S3.p2.5.m2.4.4.1.1.1.1.1.1.2.2.3.1.cmml" xref="S3.p2.5.m2.4.4.1.1.1.1.1.1.2.2.3.1"></times><ci id="S3.p2.5.m2.4.4.1.1.1.1.1.1.2.2.3.2.cmml" xref="S3.p2.5.m2.4.4.1.1.1.1.1.1.2.2.3.2">𝑠</ci><ci id="S3.p2.5.m2.4.4.1.1.1.1.1.1.2.2.3.3.cmml" xref="S3.p2.5.m2.4.4.1.1.1.1.1.1.2.2.3.3">𝑖</ci></apply></apply><apply id="S3.p2.5.m2.4.4.1.1.1.1.1.1.2.3.cmml" xref="S3.p2.5.m2.4.4.1.1.1.1.1.1.2.3"><csymbol cd="ambiguous" id="S3.p2.5.m2.4.4.1.1.1.1.1.1.2.3.1.cmml" xref="S3.p2.5.m2.4.4.1.1.1.1.1.1.2.3">subscript</csymbol><ci id="S3.p2.5.m2.4.4.1.1.1.1.1.1.2.3.2.cmml" xref="S3.p2.5.m2.4.4.1.1.1.1.1.1.2.3.2">𝐳</ci><apply id="S3.p2.5.m2.4.4.1.1.1.1.1.1.2.3.3.cmml" xref="S3.p2.5.m2.4.4.1.1.1.1.1.1.2.3.3"><times id="S3.p2.5.m2.4.4.1.1.1.1.1.1.2.3.3.1.cmml" xref="S3.p2.5.m2.4.4.1.1.1.1.1.1.2.3.3.1"></times><ci id="S3.p2.5.m2.4.4.1.1.1.1.1.1.2.3.3.2.cmml" xref="S3.p2.5.m2.4.4.1.1.1.1.1.1.2.3.3.2">𝑠</ci><ci id="S3.p2.5.m2.4.4.1.1.1.1.1.1.2.3.3.3.cmml" xref="S3.p2.5.m2.4.4.1.1.1.1.1.1.2.3.3.3">𝑖</ci></apply></apply></apply><cn type="integer" id="S3.p2.5.m2.4.4.1.1.1.1.1.1.3.cmml" xref="S3.p2.5.m2.4.4.1.1.1.1.1.1.3">1</cn></apply></apply><apply id="S3.p2.5.m2.4.4.1.1.2.cmml" xref="S3.p2.5.m2.4.4.1.1.2"><times id="S3.p2.5.m2.4.4.1.1.2.2.cmml" xref="S3.p2.5.m2.4.4.1.1.2.2"></times><ci id="S3.p2.5.m2.4.4.1.1.2.3.cmml" xref="S3.p2.5.m2.4.4.1.1.2.3">𝒩</ci><interval closure="open" id="S3.p2.5.m2.4.4.1.1.2.1.2.cmml" xref="S3.p2.5.m2.4.4.1.1.2.1.1"><apply id="S3.p2.5.m2.4.4.1.1.2.1.1.1.cmml" xref="S3.p2.5.m2.4.4.1.1.2.1.1.1"><csymbol cd="ambiguous" id="S3.p2.5.m2.4.4.1.1.2.1.1.1.1.cmml" xref="S3.p2.5.m2.4.4.1.1.2.1.1.1">subscript</csymbol><ci id="S3.p2.5.m2.4.4.1.1.2.1.1.1.2.cmml" xref="S3.p2.5.m2.4.4.1.1.2.1.1.1.2">𝐰</ci><apply id="S3.p2.5.m2.4.4.1.1.2.1.1.1.3.cmml" xref="S3.p2.5.m2.4.4.1.1.2.1.1.1.3"><times id="S3.p2.5.m2.4.4.1.1.2.1.1.1.3.1.cmml" xref="S3.p2.5.m2.4.4.1.1.2.1.1.1.3.1"></times><ci id="S3.p2.5.m2.4.4.1.1.2.1.1.1.3.2.cmml" xref="S3.p2.5.m2.4.4.1.1.2.1.1.1.3.2">𝑠</ci><ci id="S3.p2.5.m2.4.4.1.1.2.1.1.1.3.3.cmml" xref="S3.p2.5.m2.4.4.1.1.2.1.1.1.3.3">𝑖</ci></apply></apply><ci id="S3.p2.5.m2.1.1.cmml" xref="S3.p2.5.m2.1.1">italic-ϵ</ci></interval></apply></apply><apply id="S3.p2.5.m2.5.5.2.2.cmml" xref="S3.p2.5.m2.5.5.2.2"><csymbol cd="latexml" id="S3.p2.5.m2.5.5.2.2.2.cmml" xref="S3.p2.5.m2.5.5.2.2.2">assign</csymbol><apply id="S3.p2.5.m2.5.5.2.2.1.cmml" xref="S3.p2.5.m2.5.5.2.2.1"><times id="S3.p2.5.m2.5.5.2.2.1.2.cmml" xref="S3.p2.5.m2.5.5.2.2.1.2"></times><ci id="S3.p2.5.m2.5.5.2.2.1.3.cmml" xref="S3.p2.5.m2.5.5.2.2.1.3">𝑞</ci><apply id="S3.p2.5.m2.5.5.2.2.1.1.1.1.cmml" xref="S3.p2.5.m2.5.5.2.2.1.1.1"><eq id="S3.p2.5.m2.5.5.2.2.1.1.1.1.1.cmml" xref="S3.p2.5.m2.5.5.2.2.1.1.1.1.1"></eq><apply id="S3.p2.5.m2.5.5.2.2.1.1.1.1.2.cmml" xref="S3.p2.5.m2.5.5.2.2.1.1.1.1.2"><csymbol cd="latexml" id="S3.p2.5.m2.5.5.2.2.1.1.1.1.2.1.cmml" xref="S3.p2.5.m2.5.5.2.2.1.1.1.1.2.1">conditional</csymbol><apply id="S3.p2.5.m2.5.5.2.2.1.1.1.1.2.2.cmml" xref="S3.p2.5.m2.5.5.2.2.1.1.1.1.2.2"><csymbol cd="ambiguous" id="S3.p2.5.m2.5.5.2.2.1.1.1.1.2.2.1.cmml" xref="S3.p2.5.m2.5.5.2.2.1.1.1.1.2.2">subscript</csymbol><ci id="S3.p2.5.m2.5.5.2.2.1.1.1.1.2.2.2.cmml" xref="S3.p2.5.m2.5.5.2.2.1.1.1.1.2.2.2">bold-italic-ϕ</ci><apply id="S3.p2.5.m2.5.5.2.2.1.1.1.1.2.2.3.cmml" xref="S3.p2.5.m2.5.5.2.2.1.1.1.1.2.2.3"><times id="S3.p2.5.m2.5.5.2.2.1.1.1.1.2.2.3.1.cmml" xref="S3.p2.5.m2.5.5.2.2.1.1.1.1.2.2.3.1"></times><ci id="S3.p2.5.m2.5.5.2.2.1.1.1.1.2.2.3.2.cmml" xref="S3.p2.5.m2.5.5.2.2.1.1.1.1.2.2.3.2">𝑠</ci><ci id="S3.p2.5.m2.5.5.2.2.1.1.1.1.2.2.3.3.cmml" xref="S3.p2.5.m2.5.5.2.2.1.1.1.1.2.2.3.3">𝑖</ci></apply></apply><apply id="S3.p2.5.m2.5.5.2.2.1.1.1.1.2.3.cmml" xref="S3.p2.5.m2.5.5.2.2.1.1.1.1.2.3"><csymbol cd="ambiguous" id="S3.p2.5.m2.5.5.2.2.1.1.1.1.2.3.1.cmml" xref="S3.p2.5.m2.5.5.2.2.1.1.1.1.2.3">subscript</csymbol><ci id="S3.p2.5.m2.5.5.2.2.1.1.1.1.2.3.2.cmml" xref="S3.p2.5.m2.5.5.2.2.1.1.1.1.2.3.2">𝐳</ci><apply id="S3.p2.5.m2.5.5.2.2.1.1.1.1.2.3.3.cmml" xref="S3.p2.5.m2.5.5.2.2.1.1.1.1.2.3.3"><times id="S3.p2.5.m2.5.5.2.2.1.1.1.1.2.3.3.1.cmml" xref="S3.p2.5.m2.5.5.2.2.1.1.1.1.2.3.3.1"></times><ci id="S3.p2.5.m2.5.5.2.2.1.1.1.1.2.3.3.2.cmml" xref="S3.p2.5.m2.5.5.2.2.1.1.1.1.2.3.3.2">𝑠</ci><ci id="S3.p2.5.m2.5.5.2.2.1.1.1.1.2.3.3.3.cmml" xref="S3.p2.5.m2.5.5.2.2.1.1.1.1.2.3.3.3">𝑖</ci></apply></apply></apply><cn type="integer" id="S3.p2.5.m2.5.5.2.2.1.1.1.1.3.cmml" xref="S3.p2.5.m2.5.5.2.2.1.1.1.1.3">1</cn></apply></apply><apply id="S3.p2.5.m2.5.5.2.2.3.cmml" xref="S3.p2.5.m2.5.5.2.2.3"><times id="S3.p2.5.m2.5.5.2.2.3.1.cmml" xref="S3.p2.5.m2.5.5.2.2.3.1"></times><ci id="S3.p2.5.m2.5.5.2.2.3.2.cmml" xref="S3.p2.5.m2.5.5.2.2.3.2">𝒩</ci><interval closure="open" id="S3.p2.5.m2.5.5.2.2.3.3.1.cmml" xref="S3.p2.5.m2.5.5.2.2.3.3.2"><cn type="integer" id="S3.p2.5.m2.2.2.cmml" xref="S3.p2.5.m2.2.2">0</cn><ci id="S3.p2.5.m2.3.3.cmml" xref="S3.p2.5.m2.3.3">italic-ϵ</ci></interval></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p2.5.m2.5c">q_{\mathbf{w}_{s}}(\bm{\phi}_{si}|\mathbf{z}_{si}=1):=\mathcal{N}(\mathbf{w}_{si},\epsilon),q(\bm{\phi}_{si}|\mathbf{z}_{si}=1):=\mathcal{N}(0,\epsilon)</annotation></semantics></math> with <math id="S3.p2.6.m3.1" class="ltx_Math" alttext="\epsilon\approx 0" display="inline"><semantics id="S3.p2.6.m3.1a"><mrow id="S3.p2.6.m3.1.1" xref="S3.p2.6.m3.1.1.cmml"><mi id="S3.p2.6.m3.1.1.2" xref="S3.p2.6.m3.1.1.2.cmml">ϵ</mi><mo id="S3.p2.6.m3.1.1.1" xref="S3.p2.6.m3.1.1.1.cmml">≈</mo><mn id="S3.p2.6.m3.1.1.3" xref="S3.p2.6.m3.1.1.3.cmml">0</mn></mrow><annotation-xml encoding="MathML-Content" id="S3.p2.6.m3.1b"><apply id="S3.p2.6.m3.1.1.cmml" xref="S3.p2.6.m3.1.1"><approx id="S3.p2.6.m3.1.1.1.cmml" xref="S3.p2.6.m3.1.1.1"></approx><ci id="S3.p2.6.m3.1.1.2.cmml" xref="S3.p2.6.m3.1.1.2">italic-ϵ</ci><cn type="integer" id="S3.p2.6.m3.1.1.3.cmml" xref="S3.p2.6.m3.1.1.3">0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p2.6.m3.1c">\epsilon\approx 0</annotation></semantics></math> which will be, numerically speaking, deterministic. For the gating variables, as they are binary, we will use <math id="S3.p2.7.m4.2" class="ltx_Math" alttext="q_{\bm{\pi}_{si}}(\mathbf{z}_{si}):=\text{Bern}(\bm{\pi}_{si})" display="inline"><semantics id="S3.p2.7.m4.2a"><mrow id="S3.p2.7.m4.2.2" xref="S3.p2.7.m4.2.2.cmml"><mrow id="S3.p2.7.m4.1.1.1" xref="S3.p2.7.m4.1.1.1.cmml"><msub id="S3.p2.7.m4.1.1.1.3" xref="S3.p2.7.m4.1.1.1.3.cmml"><mi id="S3.p2.7.m4.1.1.1.3.2" xref="S3.p2.7.m4.1.1.1.3.2.cmml">q</mi><msub id="S3.p2.7.m4.1.1.1.3.3" xref="S3.p2.7.m4.1.1.1.3.3.cmml"><mi id="S3.p2.7.m4.1.1.1.3.3.2" xref="S3.p2.7.m4.1.1.1.3.3.2.cmml">𝝅</mi><mrow id="S3.p2.7.m4.1.1.1.3.3.3" xref="S3.p2.7.m4.1.1.1.3.3.3.cmml"><mi id="S3.p2.7.m4.1.1.1.3.3.3.2" xref="S3.p2.7.m4.1.1.1.3.3.3.2.cmml">s</mi><mo lspace="0em" rspace="0em" id="S3.p2.7.m4.1.1.1.3.3.3.1" xref="S3.p2.7.m4.1.1.1.3.3.3.1.cmml">​</mo><mi id="S3.p2.7.m4.1.1.1.3.3.3.3" xref="S3.p2.7.m4.1.1.1.3.3.3.3.cmml">i</mi></mrow></msub></msub><mo lspace="0em" rspace="0em" id="S3.p2.7.m4.1.1.1.2" xref="S3.p2.7.m4.1.1.1.2.cmml">​</mo><mrow id="S3.p2.7.m4.1.1.1.1.1" xref="S3.p2.7.m4.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S3.p2.7.m4.1.1.1.1.1.2" xref="S3.p2.7.m4.1.1.1.1.1.1.cmml">(</mo><msub id="S3.p2.7.m4.1.1.1.1.1.1" xref="S3.p2.7.m4.1.1.1.1.1.1.cmml"><mi id="S3.p2.7.m4.1.1.1.1.1.1.2" xref="S3.p2.7.m4.1.1.1.1.1.1.2.cmml">𝐳</mi><mrow id="S3.p2.7.m4.1.1.1.1.1.1.3" xref="S3.p2.7.m4.1.1.1.1.1.1.3.cmml"><mi id="S3.p2.7.m4.1.1.1.1.1.1.3.2" xref="S3.p2.7.m4.1.1.1.1.1.1.3.2.cmml">s</mi><mo lspace="0em" rspace="0em" id="S3.p2.7.m4.1.1.1.1.1.1.3.1" xref="S3.p2.7.m4.1.1.1.1.1.1.3.1.cmml">​</mo><mi id="S3.p2.7.m4.1.1.1.1.1.1.3.3" xref="S3.p2.7.m4.1.1.1.1.1.1.3.3.cmml">i</mi></mrow></msub><mo rspace="0.278em" stretchy="false" id="S3.p2.7.m4.1.1.1.1.1.3" xref="S3.p2.7.m4.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo rspace="0.278em" id="S3.p2.7.m4.2.2.3" xref="S3.p2.7.m4.2.2.3.cmml">:=</mo><mrow id="S3.p2.7.m4.2.2.2" xref="S3.p2.7.m4.2.2.2.cmml"><mtext id="S3.p2.7.m4.2.2.2.3" xref="S3.p2.7.m4.2.2.2.3a.cmml">Bern</mtext><mo lspace="0em" rspace="0em" id="S3.p2.7.m4.2.2.2.2" xref="S3.p2.7.m4.2.2.2.2.cmml">​</mo><mrow id="S3.p2.7.m4.2.2.2.1.1" xref="S3.p2.7.m4.2.2.2.1.1.1.cmml"><mo stretchy="false" id="S3.p2.7.m4.2.2.2.1.1.2" xref="S3.p2.7.m4.2.2.2.1.1.1.cmml">(</mo><msub id="S3.p2.7.m4.2.2.2.1.1.1" xref="S3.p2.7.m4.2.2.2.1.1.1.cmml"><mi id="S3.p2.7.m4.2.2.2.1.1.1.2" xref="S3.p2.7.m4.2.2.2.1.1.1.2.cmml">𝝅</mi><mrow id="S3.p2.7.m4.2.2.2.1.1.1.3" xref="S3.p2.7.m4.2.2.2.1.1.1.3.cmml"><mi id="S3.p2.7.m4.2.2.2.1.1.1.3.2" xref="S3.p2.7.m4.2.2.2.1.1.1.3.2.cmml">s</mi><mo lspace="0em" rspace="0em" id="S3.p2.7.m4.2.2.2.1.1.1.3.1" xref="S3.p2.7.m4.2.2.2.1.1.1.3.1.cmml">​</mo><mi id="S3.p2.7.m4.2.2.2.1.1.1.3.3" xref="S3.p2.7.m4.2.2.2.1.1.1.3.3.cmml">i</mi></mrow></msub><mo stretchy="false" id="S3.p2.7.m4.2.2.2.1.1.3" xref="S3.p2.7.m4.2.2.2.1.1.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.p2.7.m4.2b"><apply id="S3.p2.7.m4.2.2.cmml" xref="S3.p2.7.m4.2.2"><csymbol cd="latexml" id="S3.p2.7.m4.2.2.3.cmml" xref="S3.p2.7.m4.2.2.3">assign</csymbol><apply id="S3.p2.7.m4.1.1.1.cmml" xref="S3.p2.7.m4.1.1.1"><times id="S3.p2.7.m4.1.1.1.2.cmml" xref="S3.p2.7.m4.1.1.1.2"></times><apply id="S3.p2.7.m4.1.1.1.3.cmml" xref="S3.p2.7.m4.1.1.1.3"><csymbol cd="ambiguous" id="S3.p2.7.m4.1.1.1.3.1.cmml" xref="S3.p2.7.m4.1.1.1.3">subscript</csymbol><ci id="S3.p2.7.m4.1.1.1.3.2.cmml" xref="S3.p2.7.m4.1.1.1.3.2">𝑞</ci><apply id="S3.p2.7.m4.1.1.1.3.3.cmml" xref="S3.p2.7.m4.1.1.1.3.3"><csymbol cd="ambiguous" id="S3.p2.7.m4.1.1.1.3.3.1.cmml" xref="S3.p2.7.m4.1.1.1.3.3">subscript</csymbol><ci id="S3.p2.7.m4.1.1.1.3.3.2.cmml" xref="S3.p2.7.m4.1.1.1.3.3.2">𝝅</ci><apply id="S3.p2.7.m4.1.1.1.3.3.3.cmml" xref="S3.p2.7.m4.1.1.1.3.3.3"><times id="S3.p2.7.m4.1.1.1.3.3.3.1.cmml" xref="S3.p2.7.m4.1.1.1.3.3.3.1"></times><ci id="S3.p2.7.m4.1.1.1.3.3.3.2.cmml" xref="S3.p2.7.m4.1.1.1.3.3.3.2">𝑠</ci><ci id="S3.p2.7.m4.1.1.1.3.3.3.3.cmml" xref="S3.p2.7.m4.1.1.1.3.3.3.3">𝑖</ci></apply></apply></apply><apply id="S3.p2.7.m4.1.1.1.1.1.1.cmml" xref="S3.p2.7.m4.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.p2.7.m4.1.1.1.1.1.1.1.cmml" xref="S3.p2.7.m4.1.1.1.1.1">subscript</csymbol><ci id="S3.p2.7.m4.1.1.1.1.1.1.2.cmml" xref="S3.p2.7.m4.1.1.1.1.1.1.2">𝐳</ci><apply id="S3.p2.7.m4.1.1.1.1.1.1.3.cmml" xref="S3.p2.7.m4.1.1.1.1.1.1.3"><times id="S3.p2.7.m4.1.1.1.1.1.1.3.1.cmml" xref="S3.p2.7.m4.1.1.1.1.1.1.3.1"></times><ci id="S3.p2.7.m4.1.1.1.1.1.1.3.2.cmml" xref="S3.p2.7.m4.1.1.1.1.1.1.3.2">𝑠</ci><ci id="S3.p2.7.m4.1.1.1.1.1.1.3.3.cmml" xref="S3.p2.7.m4.1.1.1.1.1.1.3.3">𝑖</ci></apply></apply></apply><apply id="S3.p2.7.m4.2.2.2.cmml" xref="S3.p2.7.m4.2.2.2"><times id="S3.p2.7.m4.2.2.2.2.cmml" xref="S3.p2.7.m4.2.2.2.2"></times><ci id="S3.p2.7.m4.2.2.2.3a.cmml" xref="S3.p2.7.m4.2.2.2.3"><mtext id="S3.p2.7.m4.2.2.2.3.cmml" xref="S3.p2.7.m4.2.2.2.3">Bern</mtext></ci><apply id="S3.p2.7.m4.2.2.2.1.1.1.cmml" xref="S3.p2.7.m4.2.2.2.1.1"><csymbol cd="ambiguous" id="S3.p2.7.m4.2.2.2.1.1.1.1.cmml" xref="S3.p2.7.m4.2.2.2.1.1">subscript</csymbol><ci id="S3.p2.7.m4.2.2.2.1.1.1.2.cmml" xref="S3.p2.7.m4.2.2.2.1.1.1.2">𝝅</ci><apply id="S3.p2.7.m4.2.2.2.1.1.1.3.cmml" xref="S3.p2.7.m4.2.2.2.1.1.1.3"><times id="S3.p2.7.m4.2.2.2.1.1.1.3.1.cmml" xref="S3.p2.7.m4.2.2.2.1.1.1.3.1"></times><ci id="S3.p2.7.m4.2.2.2.1.1.1.3.2.cmml" xref="S3.p2.7.m4.2.2.2.1.1.1.3.2">𝑠</ci><ci id="S3.p2.7.m4.2.2.2.1.1.1.3.3.cmml" xref="S3.p2.7.m4.2.2.2.1.1.1.3.3">𝑖</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p2.7.m4.2c">q_{\bm{\pi}_{si}}(\mathbf{z}_{si}):=\text{Bern}(\bm{\pi}_{si})</annotation></semantics></math> with <math id="S3.p2.8.m5.1" class="ltx_Math" alttext="\bm{\pi}_{si}" display="inline"><semantics id="S3.p2.8.m5.1a"><msub id="S3.p2.8.m5.1.1" xref="S3.p2.8.m5.1.1.cmml"><mi id="S3.p2.8.m5.1.1.2" xref="S3.p2.8.m5.1.1.2.cmml">𝝅</mi><mrow id="S3.p2.8.m5.1.1.3" xref="S3.p2.8.m5.1.1.3.cmml"><mi id="S3.p2.8.m5.1.1.3.2" xref="S3.p2.8.m5.1.1.3.2.cmml">s</mi><mo lspace="0em" rspace="0em" id="S3.p2.8.m5.1.1.3.1" xref="S3.p2.8.m5.1.1.3.1.cmml">​</mo><mi id="S3.p2.8.m5.1.1.3.3" xref="S3.p2.8.m5.1.1.3.3.cmml">i</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S3.p2.8.m5.1b"><apply id="S3.p2.8.m5.1.1.cmml" xref="S3.p2.8.m5.1.1"><csymbol cd="ambiguous" id="S3.p2.8.m5.1.1.1.cmml" xref="S3.p2.8.m5.1.1">subscript</csymbol><ci id="S3.p2.8.m5.1.1.2.cmml" xref="S3.p2.8.m5.1.1.2">𝝅</ci><apply id="S3.p2.8.m5.1.1.3.cmml" xref="S3.p2.8.m5.1.1.3"><times id="S3.p2.8.m5.1.1.3.1.cmml" xref="S3.p2.8.m5.1.1.3.1"></times><ci id="S3.p2.8.m5.1.1.3.2.cmml" xref="S3.p2.8.m5.1.1.3.2">𝑠</ci><ci id="S3.p2.8.m5.1.1.3.3.cmml" xref="S3.p2.8.m5.1.1.3.3">𝑖</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p2.8.m5.1c">\bm{\pi}_{si}</annotation></semantics></math> being the probability of activating local gate <math id="S3.p2.9.m6.1" class="ltx_Math" alttext="\mathbf{z}_{si}" display="inline"><semantics id="S3.p2.9.m6.1a"><msub id="S3.p2.9.m6.1.1" xref="S3.p2.9.m6.1.1.cmml"><mi id="S3.p2.9.m6.1.1.2" xref="S3.p2.9.m6.1.1.2.cmml">𝐳</mi><mrow id="S3.p2.9.m6.1.1.3" xref="S3.p2.9.m6.1.1.3.cmml"><mi id="S3.p2.9.m6.1.1.3.2" xref="S3.p2.9.m6.1.1.3.2.cmml">s</mi><mo lspace="0em" rspace="0em" id="S3.p2.9.m6.1.1.3.1" xref="S3.p2.9.m6.1.1.3.1.cmml">​</mo><mi id="S3.p2.9.m6.1.1.3.3" xref="S3.p2.9.m6.1.1.3.3.cmml">i</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S3.p2.9.m6.1b"><apply id="S3.p2.9.m6.1.1.cmml" xref="S3.p2.9.m6.1.1"><csymbol cd="ambiguous" id="S3.p2.9.m6.1.1.1.cmml" xref="S3.p2.9.m6.1.1">subscript</csymbol><ci id="S3.p2.9.m6.1.1.2.cmml" xref="S3.p2.9.m6.1.1.2">𝐳</ci><apply id="S3.p2.9.m6.1.1.3.cmml" xref="S3.p2.9.m6.1.1.3"><times id="S3.p2.9.m6.1.1.3.1.cmml" xref="S3.p2.9.m6.1.1.3.1"></times><ci id="S3.p2.9.m6.1.1.3.2.cmml" xref="S3.p2.9.m6.1.1.3.2">𝑠</ci><ci id="S3.p2.9.m6.1.1.3.3.cmml" xref="S3.p2.9.m6.1.1.3.3">𝑖</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p2.9.m6.1c">\mathbf{z}_{si}</annotation></semantics></math>. In order to do hard-EM for the binary variables, we will remove the entropy term for the <math id="S3.p2.10.m7.1" class="ltx_Math" alttext="q_{\bm{\pi}_{s}}(\mathbf{z}_{s})" display="inline"><semantics id="S3.p2.10.m7.1a"><mrow id="S3.p2.10.m7.1.1" xref="S3.p2.10.m7.1.1.cmml"><msub id="S3.p2.10.m7.1.1.3" xref="S3.p2.10.m7.1.1.3.cmml"><mi id="S3.p2.10.m7.1.1.3.2" xref="S3.p2.10.m7.1.1.3.2.cmml">q</mi><msub id="S3.p2.10.m7.1.1.3.3" xref="S3.p2.10.m7.1.1.3.3.cmml"><mi id="S3.p2.10.m7.1.1.3.3.2" xref="S3.p2.10.m7.1.1.3.3.2.cmml">𝝅</mi><mi id="S3.p2.10.m7.1.1.3.3.3" xref="S3.p2.10.m7.1.1.3.3.3.cmml">s</mi></msub></msub><mo lspace="0em" rspace="0em" id="S3.p2.10.m7.1.1.2" xref="S3.p2.10.m7.1.1.2.cmml">​</mo><mrow id="S3.p2.10.m7.1.1.1.1" xref="S3.p2.10.m7.1.1.1.1.1.cmml"><mo stretchy="false" id="S3.p2.10.m7.1.1.1.1.2" xref="S3.p2.10.m7.1.1.1.1.1.cmml">(</mo><msub id="S3.p2.10.m7.1.1.1.1.1" xref="S3.p2.10.m7.1.1.1.1.1.cmml"><mi id="S3.p2.10.m7.1.1.1.1.1.2" xref="S3.p2.10.m7.1.1.1.1.1.2.cmml">𝐳</mi><mi id="S3.p2.10.m7.1.1.1.1.1.3" xref="S3.p2.10.m7.1.1.1.1.1.3.cmml">s</mi></msub><mo stretchy="false" id="S3.p2.10.m7.1.1.1.1.3" xref="S3.p2.10.m7.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.p2.10.m7.1b"><apply id="S3.p2.10.m7.1.1.cmml" xref="S3.p2.10.m7.1.1"><times id="S3.p2.10.m7.1.1.2.cmml" xref="S3.p2.10.m7.1.1.2"></times><apply id="S3.p2.10.m7.1.1.3.cmml" xref="S3.p2.10.m7.1.1.3"><csymbol cd="ambiguous" id="S3.p2.10.m7.1.1.3.1.cmml" xref="S3.p2.10.m7.1.1.3">subscript</csymbol><ci id="S3.p2.10.m7.1.1.3.2.cmml" xref="S3.p2.10.m7.1.1.3.2">𝑞</ci><apply id="S3.p2.10.m7.1.1.3.3.cmml" xref="S3.p2.10.m7.1.1.3.3"><csymbol cd="ambiguous" id="S3.p2.10.m7.1.1.3.3.1.cmml" xref="S3.p2.10.m7.1.1.3.3">subscript</csymbol><ci id="S3.p2.10.m7.1.1.3.3.2.cmml" xref="S3.p2.10.m7.1.1.3.3.2">𝝅</ci><ci id="S3.p2.10.m7.1.1.3.3.3.cmml" xref="S3.p2.10.m7.1.1.3.3.3">𝑠</ci></apply></apply><apply id="S3.p2.10.m7.1.1.1.1.1.cmml" xref="S3.p2.10.m7.1.1.1.1"><csymbol cd="ambiguous" id="S3.p2.10.m7.1.1.1.1.1.1.cmml" xref="S3.p2.10.m7.1.1.1.1">subscript</csymbol><ci id="S3.p2.10.m7.1.1.1.1.1.2.cmml" xref="S3.p2.10.m7.1.1.1.1.1.2">𝐳</ci><ci id="S3.p2.10.m7.1.1.1.1.1.3.cmml" xref="S3.p2.10.m7.1.1.1.1.1.3">𝑠</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p2.10.m7.1c">q_{\bm{\pi}_{s}}(\mathbf{z}_{s})</annotation></semantics></math> from the aforementioned bound as this will encourage the approximate distribution to move towards the most probable value for <math id="S3.p2.11.m8.1" class="ltx_Math" alttext="\mathbf{z}_{s}" display="inline"><semantics id="S3.p2.11.m8.1a"><msub id="S3.p2.11.m8.1.1" xref="S3.p2.11.m8.1.1.cmml"><mi id="S3.p2.11.m8.1.1.2" xref="S3.p2.11.m8.1.1.2.cmml">𝐳</mi><mi id="S3.p2.11.m8.1.1.3" xref="S3.p2.11.m8.1.1.3.cmml">s</mi></msub><annotation-xml encoding="MathML-Content" id="S3.p2.11.m8.1b"><apply id="S3.p2.11.m8.1.1.cmml" xref="S3.p2.11.m8.1.1"><csymbol cd="ambiguous" id="S3.p2.11.m8.1.1.1.cmml" xref="S3.p2.11.m8.1.1">subscript</csymbol><ci id="S3.p2.11.m8.1.1.2.cmml" xref="S3.p2.11.m8.1.1.2">𝐳</ci><ci id="S3.p2.11.m8.1.1.3.cmml" xref="S3.p2.11.m8.1.1.3">𝑠</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p2.11.m8.1c">\mathbf{z}_{s}</annotation></semantics></math>. Furthermore, by relaxing the spike at zero to a Gaussian with precision <math id="S3.p2.12.m9.1" class="ltx_Math" alttext="\lambda_{2}" display="inline"><semantics id="S3.p2.12.m9.1a"><msub id="S3.p2.12.m9.1.1" xref="S3.p2.12.m9.1.1.cmml"><mi id="S3.p2.12.m9.1.1.2" xref="S3.p2.12.m9.1.1.2.cmml">λ</mi><mn id="S3.p2.12.m9.1.1.3" xref="S3.p2.12.m9.1.1.3.cmml">2</mn></msub><annotation-xml encoding="MathML-Content" id="S3.p2.12.m9.1b"><apply id="S3.p2.12.m9.1.1.cmml" xref="S3.p2.12.m9.1.1"><csymbol cd="ambiguous" id="S3.p2.12.m9.1.1.1.cmml" xref="S3.p2.12.m9.1.1">subscript</csymbol><ci id="S3.p2.12.m9.1.1.2.cmml" xref="S3.p2.12.m9.1.1.2">𝜆</ci><cn type="integer" id="S3.p2.12.m9.1.1.3.cmml" xref="S3.p2.12.m9.1.1.3">2</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p2.12.m9.1c">\lambda_{2}</annotation></semantics></math>, <em id="S3.p2.13.1" class="ltx_emph ltx_font_italic">i.e.</em>, <math id="S3.p2.13.m10.3" class="ltx_Math" alttext="p(\bm{\phi}_{si}|\mathbf{z}_{si}=0)=\mathcal{N}(0,1/\lambda_{2})" display="inline"><semantics id="S3.p2.13.m10.3a"><mrow id="S3.p2.13.m10.3.3" xref="S3.p2.13.m10.3.3.cmml"><mrow id="S3.p2.13.m10.2.2.1" xref="S3.p2.13.m10.2.2.1.cmml"><mi id="S3.p2.13.m10.2.2.1.3" xref="S3.p2.13.m10.2.2.1.3.cmml">p</mi><mo lspace="0em" rspace="0em" id="S3.p2.13.m10.2.2.1.2" xref="S3.p2.13.m10.2.2.1.2.cmml">​</mo><mrow id="S3.p2.13.m10.2.2.1.1.1" xref="S3.p2.13.m10.2.2.1.1.1.1.cmml"><mo stretchy="false" id="S3.p2.13.m10.2.2.1.1.1.2" xref="S3.p2.13.m10.2.2.1.1.1.1.cmml">(</mo><mrow id="S3.p2.13.m10.2.2.1.1.1.1" xref="S3.p2.13.m10.2.2.1.1.1.1.cmml"><mrow id="S3.p2.13.m10.2.2.1.1.1.1.2" xref="S3.p2.13.m10.2.2.1.1.1.1.2.cmml"><msub id="S3.p2.13.m10.2.2.1.1.1.1.2.2" xref="S3.p2.13.m10.2.2.1.1.1.1.2.2.cmml"><mi class="ltx_mathvariant_bold-italic" mathvariant="bold-italic" id="S3.p2.13.m10.2.2.1.1.1.1.2.2.2" xref="S3.p2.13.m10.2.2.1.1.1.1.2.2.2.cmml">ϕ</mi><mrow id="S3.p2.13.m10.2.2.1.1.1.1.2.2.3" xref="S3.p2.13.m10.2.2.1.1.1.1.2.2.3.cmml"><mi id="S3.p2.13.m10.2.2.1.1.1.1.2.2.3.2" xref="S3.p2.13.m10.2.2.1.1.1.1.2.2.3.2.cmml">s</mi><mo lspace="0em" rspace="0em" id="S3.p2.13.m10.2.2.1.1.1.1.2.2.3.1" xref="S3.p2.13.m10.2.2.1.1.1.1.2.2.3.1.cmml">​</mo><mi id="S3.p2.13.m10.2.2.1.1.1.1.2.2.3.3" xref="S3.p2.13.m10.2.2.1.1.1.1.2.2.3.3.cmml">i</mi></mrow></msub><mo fence="false" id="S3.p2.13.m10.2.2.1.1.1.1.2.1" xref="S3.p2.13.m10.2.2.1.1.1.1.2.1.cmml">|</mo><msub id="S3.p2.13.m10.2.2.1.1.1.1.2.3" xref="S3.p2.13.m10.2.2.1.1.1.1.2.3.cmml"><mi id="S3.p2.13.m10.2.2.1.1.1.1.2.3.2" xref="S3.p2.13.m10.2.2.1.1.1.1.2.3.2.cmml">𝐳</mi><mrow id="S3.p2.13.m10.2.2.1.1.1.1.2.3.3" xref="S3.p2.13.m10.2.2.1.1.1.1.2.3.3.cmml"><mi id="S3.p2.13.m10.2.2.1.1.1.1.2.3.3.2" xref="S3.p2.13.m10.2.2.1.1.1.1.2.3.3.2.cmml">s</mi><mo lspace="0em" rspace="0em" id="S3.p2.13.m10.2.2.1.1.1.1.2.3.3.1" xref="S3.p2.13.m10.2.2.1.1.1.1.2.3.3.1.cmml">​</mo><mi id="S3.p2.13.m10.2.2.1.1.1.1.2.3.3.3" xref="S3.p2.13.m10.2.2.1.1.1.1.2.3.3.3.cmml">i</mi></mrow></msub></mrow><mo id="S3.p2.13.m10.2.2.1.1.1.1.1" xref="S3.p2.13.m10.2.2.1.1.1.1.1.cmml">=</mo><mn id="S3.p2.13.m10.2.2.1.1.1.1.3" xref="S3.p2.13.m10.2.2.1.1.1.1.3.cmml">0</mn></mrow><mo stretchy="false" id="S3.p2.13.m10.2.2.1.1.1.3" xref="S3.p2.13.m10.2.2.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S3.p2.13.m10.3.3.3" xref="S3.p2.13.m10.3.3.3.cmml">=</mo><mrow id="S3.p2.13.m10.3.3.2" xref="S3.p2.13.m10.3.3.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.p2.13.m10.3.3.2.3" xref="S3.p2.13.m10.3.3.2.3.cmml">𝒩</mi><mo lspace="0em" rspace="0em" id="S3.p2.13.m10.3.3.2.2" xref="S3.p2.13.m10.3.3.2.2.cmml">​</mo><mrow id="S3.p2.13.m10.3.3.2.1.1" xref="S3.p2.13.m10.3.3.2.1.2.cmml"><mo stretchy="false" id="S3.p2.13.m10.3.3.2.1.1.2" xref="S3.p2.13.m10.3.3.2.1.2.cmml">(</mo><mn id="S3.p2.13.m10.1.1" xref="S3.p2.13.m10.1.1.cmml">0</mn><mo id="S3.p2.13.m10.3.3.2.1.1.3" xref="S3.p2.13.m10.3.3.2.1.2.cmml">,</mo><mrow id="S3.p2.13.m10.3.3.2.1.1.1" xref="S3.p2.13.m10.3.3.2.1.1.1.cmml"><mn id="S3.p2.13.m10.3.3.2.1.1.1.2" xref="S3.p2.13.m10.3.3.2.1.1.1.2.cmml">1</mn><mo id="S3.p2.13.m10.3.3.2.1.1.1.1" xref="S3.p2.13.m10.3.3.2.1.1.1.1.cmml">/</mo><msub id="S3.p2.13.m10.3.3.2.1.1.1.3" xref="S3.p2.13.m10.3.3.2.1.1.1.3.cmml"><mi id="S3.p2.13.m10.3.3.2.1.1.1.3.2" xref="S3.p2.13.m10.3.3.2.1.1.1.3.2.cmml">λ</mi><mn id="S3.p2.13.m10.3.3.2.1.1.1.3.3" xref="S3.p2.13.m10.3.3.2.1.1.1.3.3.cmml">2</mn></msub></mrow><mo stretchy="false" id="S3.p2.13.m10.3.3.2.1.1.4" xref="S3.p2.13.m10.3.3.2.1.2.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.p2.13.m10.3b"><apply id="S3.p2.13.m10.3.3.cmml" xref="S3.p2.13.m10.3.3"><eq id="S3.p2.13.m10.3.3.3.cmml" xref="S3.p2.13.m10.3.3.3"></eq><apply id="S3.p2.13.m10.2.2.1.cmml" xref="S3.p2.13.m10.2.2.1"><times id="S3.p2.13.m10.2.2.1.2.cmml" xref="S3.p2.13.m10.2.2.1.2"></times><ci id="S3.p2.13.m10.2.2.1.3.cmml" xref="S3.p2.13.m10.2.2.1.3">𝑝</ci><apply id="S3.p2.13.m10.2.2.1.1.1.1.cmml" xref="S3.p2.13.m10.2.2.1.1.1"><eq id="S3.p2.13.m10.2.2.1.1.1.1.1.cmml" xref="S3.p2.13.m10.2.2.1.1.1.1.1"></eq><apply id="S3.p2.13.m10.2.2.1.1.1.1.2.cmml" xref="S3.p2.13.m10.2.2.1.1.1.1.2"><csymbol cd="latexml" id="S3.p2.13.m10.2.2.1.1.1.1.2.1.cmml" xref="S3.p2.13.m10.2.2.1.1.1.1.2.1">conditional</csymbol><apply id="S3.p2.13.m10.2.2.1.1.1.1.2.2.cmml" xref="S3.p2.13.m10.2.2.1.1.1.1.2.2"><csymbol cd="ambiguous" id="S3.p2.13.m10.2.2.1.1.1.1.2.2.1.cmml" xref="S3.p2.13.m10.2.2.1.1.1.1.2.2">subscript</csymbol><ci id="S3.p2.13.m10.2.2.1.1.1.1.2.2.2.cmml" xref="S3.p2.13.m10.2.2.1.1.1.1.2.2.2">bold-italic-ϕ</ci><apply id="S3.p2.13.m10.2.2.1.1.1.1.2.2.3.cmml" xref="S3.p2.13.m10.2.2.1.1.1.1.2.2.3"><times id="S3.p2.13.m10.2.2.1.1.1.1.2.2.3.1.cmml" xref="S3.p2.13.m10.2.2.1.1.1.1.2.2.3.1"></times><ci id="S3.p2.13.m10.2.2.1.1.1.1.2.2.3.2.cmml" xref="S3.p2.13.m10.2.2.1.1.1.1.2.2.3.2">𝑠</ci><ci id="S3.p2.13.m10.2.2.1.1.1.1.2.2.3.3.cmml" xref="S3.p2.13.m10.2.2.1.1.1.1.2.2.3.3">𝑖</ci></apply></apply><apply id="S3.p2.13.m10.2.2.1.1.1.1.2.3.cmml" xref="S3.p2.13.m10.2.2.1.1.1.1.2.3"><csymbol cd="ambiguous" id="S3.p2.13.m10.2.2.1.1.1.1.2.3.1.cmml" xref="S3.p2.13.m10.2.2.1.1.1.1.2.3">subscript</csymbol><ci id="S3.p2.13.m10.2.2.1.1.1.1.2.3.2.cmml" xref="S3.p2.13.m10.2.2.1.1.1.1.2.3.2">𝐳</ci><apply id="S3.p2.13.m10.2.2.1.1.1.1.2.3.3.cmml" xref="S3.p2.13.m10.2.2.1.1.1.1.2.3.3"><times id="S3.p2.13.m10.2.2.1.1.1.1.2.3.3.1.cmml" xref="S3.p2.13.m10.2.2.1.1.1.1.2.3.3.1"></times><ci id="S3.p2.13.m10.2.2.1.1.1.1.2.3.3.2.cmml" xref="S3.p2.13.m10.2.2.1.1.1.1.2.3.3.2">𝑠</ci><ci id="S3.p2.13.m10.2.2.1.1.1.1.2.3.3.3.cmml" xref="S3.p2.13.m10.2.2.1.1.1.1.2.3.3.3">𝑖</ci></apply></apply></apply><cn type="integer" id="S3.p2.13.m10.2.2.1.1.1.1.3.cmml" xref="S3.p2.13.m10.2.2.1.1.1.1.3">0</cn></apply></apply><apply id="S3.p2.13.m10.3.3.2.cmml" xref="S3.p2.13.m10.3.3.2"><times id="S3.p2.13.m10.3.3.2.2.cmml" xref="S3.p2.13.m10.3.3.2.2"></times><ci id="S3.p2.13.m10.3.3.2.3.cmml" xref="S3.p2.13.m10.3.3.2.3">𝒩</ci><interval closure="open" id="S3.p2.13.m10.3.3.2.1.2.cmml" xref="S3.p2.13.m10.3.3.2.1.1"><cn type="integer" id="S3.p2.13.m10.1.1.cmml" xref="S3.p2.13.m10.1.1">0</cn><apply id="S3.p2.13.m10.3.3.2.1.1.1.cmml" xref="S3.p2.13.m10.3.3.2.1.1.1"><divide id="S3.p2.13.m10.3.3.2.1.1.1.1.cmml" xref="S3.p2.13.m10.3.3.2.1.1.1.1"></divide><cn type="integer" id="S3.p2.13.m10.3.3.2.1.1.1.2.cmml" xref="S3.p2.13.m10.3.3.2.1.1.1.2">1</cn><apply id="S3.p2.13.m10.3.3.2.1.1.1.3.cmml" xref="S3.p2.13.m10.3.3.2.1.1.1.3"><csymbol cd="ambiguous" id="S3.p2.13.m10.3.3.2.1.1.1.3.1.cmml" xref="S3.p2.13.m10.3.3.2.1.1.1.3">subscript</csymbol><ci id="S3.p2.13.m10.3.3.2.1.1.1.3.2.cmml" xref="S3.p2.13.m10.3.3.2.1.1.1.3.2">𝜆</ci><cn type="integer" id="S3.p2.13.m10.3.3.2.1.1.1.3.3.cmml" xref="S3.p2.13.m10.3.3.2.1.1.1.3.3">2</cn></apply></apply></interval></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p2.13.m10.3c">p(\bm{\phi}_{si}|\mathbf{z}_{si}=0)=\mathcal{N}(0,1/\lambda_{2})</annotation></semantics></math>, and by plugging in the appropriate expressions into Eq. <a href="#S3.E16" title="In 3 The FedSparse algorithm: sparsity in federated learning ‣ An Expectation-Maximization Perspective on Federated Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">16</span></a> we can show that the local and global objectives will be</p>
<table id="A10.EGx16" class="ltx_equationgroup ltx_eqn_align ltx_eqn_table">

<tbody id="S3.Ex1"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math id="S3.Ex1.m1.5" class="ltx_Math" alttext="\displaystyle\mathcal{L}_{s}(\mathcal{D}_{s},\mathbf{w},\bm{\theta},\mathbf{w}_{s},\bm{\pi}_{s})" display="inline"><semantics id="S3.Ex1.m1.5a"><mrow id="S3.Ex1.m1.5.5" xref="S3.Ex1.m1.5.5.cmml"><msub id="S3.Ex1.m1.5.5.5" xref="S3.Ex1.m1.5.5.5.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.Ex1.m1.5.5.5.2" xref="S3.Ex1.m1.5.5.5.2.cmml">ℒ</mi><mi id="S3.Ex1.m1.5.5.5.3" xref="S3.Ex1.m1.5.5.5.3.cmml">s</mi></msub><mo lspace="0em" rspace="0em" id="S3.Ex1.m1.5.5.4" xref="S3.Ex1.m1.5.5.4.cmml">​</mo><mrow id="S3.Ex1.m1.5.5.3.3" xref="S3.Ex1.m1.5.5.3.4.cmml"><mo stretchy="false" id="S3.Ex1.m1.5.5.3.3.4" xref="S3.Ex1.m1.5.5.3.4.cmml">(</mo><msub id="S3.Ex1.m1.3.3.1.1.1" xref="S3.Ex1.m1.3.3.1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.Ex1.m1.3.3.1.1.1.2" xref="S3.Ex1.m1.3.3.1.1.1.2.cmml">𝒟</mi><mi id="S3.Ex1.m1.3.3.1.1.1.3" xref="S3.Ex1.m1.3.3.1.1.1.3.cmml">s</mi></msub><mo id="S3.Ex1.m1.5.5.3.3.5" xref="S3.Ex1.m1.5.5.3.4.cmml">,</mo><mi id="S3.Ex1.m1.1.1" xref="S3.Ex1.m1.1.1.cmml">𝐰</mi><mo id="S3.Ex1.m1.5.5.3.3.6" xref="S3.Ex1.m1.5.5.3.4.cmml">,</mo><mi id="S3.Ex1.m1.2.2" xref="S3.Ex1.m1.2.2.cmml">𝜽</mi><mo id="S3.Ex1.m1.5.5.3.3.7" xref="S3.Ex1.m1.5.5.3.4.cmml">,</mo><msub id="S3.Ex1.m1.4.4.2.2.2" xref="S3.Ex1.m1.4.4.2.2.2.cmml"><mi id="S3.Ex1.m1.4.4.2.2.2.2" xref="S3.Ex1.m1.4.4.2.2.2.2.cmml">𝐰</mi><mi id="S3.Ex1.m1.4.4.2.2.2.3" xref="S3.Ex1.m1.4.4.2.2.2.3.cmml">s</mi></msub><mo id="S3.Ex1.m1.5.5.3.3.8" xref="S3.Ex1.m1.5.5.3.4.cmml">,</mo><msub id="S3.Ex1.m1.5.5.3.3.3" xref="S3.Ex1.m1.5.5.3.3.3.cmml"><mi id="S3.Ex1.m1.5.5.3.3.3.2" xref="S3.Ex1.m1.5.5.3.3.3.2.cmml">𝝅</mi><mi id="S3.Ex1.m1.5.5.3.3.3.3" xref="S3.Ex1.m1.5.5.3.3.3.3.cmml">s</mi></msub><mo stretchy="false" id="S3.Ex1.m1.5.5.3.3.9" xref="S3.Ex1.m1.5.5.3.4.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.Ex1.m1.5b"><apply id="S3.Ex1.m1.5.5.cmml" xref="S3.Ex1.m1.5.5"><times id="S3.Ex1.m1.5.5.4.cmml" xref="S3.Ex1.m1.5.5.4"></times><apply id="S3.Ex1.m1.5.5.5.cmml" xref="S3.Ex1.m1.5.5.5"><csymbol cd="ambiguous" id="S3.Ex1.m1.5.5.5.1.cmml" xref="S3.Ex1.m1.5.5.5">subscript</csymbol><ci id="S3.Ex1.m1.5.5.5.2.cmml" xref="S3.Ex1.m1.5.5.5.2">ℒ</ci><ci id="S3.Ex1.m1.5.5.5.3.cmml" xref="S3.Ex1.m1.5.5.5.3">𝑠</ci></apply><vector id="S3.Ex1.m1.5.5.3.4.cmml" xref="S3.Ex1.m1.5.5.3.3"><apply id="S3.Ex1.m1.3.3.1.1.1.cmml" xref="S3.Ex1.m1.3.3.1.1.1"><csymbol cd="ambiguous" id="S3.Ex1.m1.3.3.1.1.1.1.cmml" xref="S3.Ex1.m1.3.3.1.1.1">subscript</csymbol><ci id="S3.Ex1.m1.3.3.1.1.1.2.cmml" xref="S3.Ex1.m1.3.3.1.1.1.2">𝒟</ci><ci id="S3.Ex1.m1.3.3.1.1.1.3.cmml" xref="S3.Ex1.m1.3.3.1.1.1.3">𝑠</ci></apply><ci id="S3.Ex1.m1.1.1.cmml" xref="S3.Ex1.m1.1.1">𝐰</ci><ci id="S3.Ex1.m1.2.2.cmml" xref="S3.Ex1.m1.2.2">𝜽</ci><apply id="S3.Ex1.m1.4.4.2.2.2.cmml" xref="S3.Ex1.m1.4.4.2.2.2"><csymbol cd="ambiguous" id="S3.Ex1.m1.4.4.2.2.2.1.cmml" xref="S3.Ex1.m1.4.4.2.2.2">subscript</csymbol><ci id="S3.Ex1.m1.4.4.2.2.2.2.cmml" xref="S3.Ex1.m1.4.4.2.2.2.2">𝐰</ci><ci id="S3.Ex1.m1.4.4.2.2.2.3.cmml" xref="S3.Ex1.m1.4.4.2.2.2.3">𝑠</ci></apply><apply id="S3.Ex1.m1.5.5.3.3.3.cmml" xref="S3.Ex1.m1.5.5.3.3.3"><csymbol cd="ambiguous" id="S3.Ex1.m1.5.5.3.3.3.1.cmml" xref="S3.Ex1.m1.5.5.3.3.3">subscript</csymbol><ci id="S3.Ex1.m1.5.5.3.3.3.2.cmml" xref="S3.Ex1.m1.5.5.3.3.3.2">𝝅</ci><ci id="S3.Ex1.m1.5.5.3.3.3.3.cmml" xref="S3.Ex1.m1.5.5.3.3.3.3">𝑠</ci></apply></vector></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.Ex1.m1.5c">\displaystyle\mathcal{L}_{s}(\mathcal{D}_{s},\mathbf{w},\bm{\theta},\mathbf{w}_{s},\bm{\pi}_{s})</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math id="S3.Ex1.m2.3" class="ltx_Math" alttext="\displaystyle:=C+\mathbb{E}_{q_{\bm{\pi}_{s}}(\mathbf{z}_{s})}\left[\sum_{i}^{N_{s}}L(\mathcal{D}_{si},\mathbf{w}_{s}\odot\mathbf{z}_{s})\right]-\frac{\lambda}{2}\sum_{j}\bm{\pi}_{sj}(\mathbf{w}_{sj}-\mathbf{w}_{j})^{2}" display="inline"><semantics id="S3.Ex1.m2.3a"><mrow id="S3.Ex1.m2.3.3" xref="S3.Ex1.m2.3.3.cmml"><mi id="S3.Ex1.m2.3.3.4" xref="S3.Ex1.m2.3.3.4.cmml"></mi><mo lspace="0.278em" rspace="0.278em" id="S3.Ex1.m2.3.3.3" xref="S3.Ex1.m2.3.3.3.cmml">:=</mo><mrow id="S3.Ex1.m2.3.3.2" xref="S3.Ex1.m2.3.3.2.cmml"><mrow id="S3.Ex1.m2.2.2.1.1" xref="S3.Ex1.m2.2.2.1.1.cmml"><mi id="S3.Ex1.m2.2.2.1.1.3" xref="S3.Ex1.m2.2.2.1.1.3.cmml">C</mi><mo id="S3.Ex1.m2.2.2.1.1.2" xref="S3.Ex1.m2.2.2.1.1.2.cmml">+</mo><mrow id="S3.Ex1.m2.2.2.1.1.1" xref="S3.Ex1.m2.2.2.1.1.1.cmml"><msub id="S3.Ex1.m2.2.2.1.1.1.3" xref="S3.Ex1.m2.2.2.1.1.1.3.cmml"><mi id="S3.Ex1.m2.2.2.1.1.1.3.2" xref="S3.Ex1.m2.2.2.1.1.1.3.2.cmml">𝔼</mi><mrow id="S3.Ex1.m2.1.1.1" xref="S3.Ex1.m2.1.1.1.cmml"><msub id="S3.Ex1.m2.1.1.1.3" xref="S3.Ex1.m2.1.1.1.3.cmml"><mi id="S3.Ex1.m2.1.1.1.3.2" xref="S3.Ex1.m2.1.1.1.3.2.cmml">q</mi><msub id="S3.Ex1.m2.1.1.1.3.3" xref="S3.Ex1.m2.1.1.1.3.3.cmml"><mi id="S3.Ex1.m2.1.1.1.3.3.2" xref="S3.Ex1.m2.1.1.1.3.3.2.cmml">𝝅</mi><mi id="S3.Ex1.m2.1.1.1.3.3.3" xref="S3.Ex1.m2.1.1.1.3.3.3.cmml">s</mi></msub></msub><mo lspace="0em" rspace="0em" id="S3.Ex1.m2.1.1.1.2" xref="S3.Ex1.m2.1.1.1.2.cmml">​</mo><mrow id="S3.Ex1.m2.1.1.1.1.1" xref="S3.Ex1.m2.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S3.Ex1.m2.1.1.1.1.1.2" xref="S3.Ex1.m2.1.1.1.1.1.1.cmml">(</mo><msub id="S3.Ex1.m2.1.1.1.1.1.1" xref="S3.Ex1.m2.1.1.1.1.1.1.cmml"><mi id="S3.Ex1.m2.1.1.1.1.1.1.2" xref="S3.Ex1.m2.1.1.1.1.1.1.2.cmml">𝐳</mi><mi id="S3.Ex1.m2.1.1.1.1.1.1.3" xref="S3.Ex1.m2.1.1.1.1.1.1.3.cmml">s</mi></msub><mo stretchy="false" id="S3.Ex1.m2.1.1.1.1.1.3" xref="S3.Ex1.m2.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></msub><mo lspace="0em" rspace="0em" id="S3.Ex1.m2.2.2.1.1.1.2" xref="S3.Ex1.m2.2.2.1.1.1.2.cmml">​</mo><mrow id="S3.Ex1.m2.2.2.1.1.1.1.1" xref="S3.Ex1.m2.2.2.1.1.1.1.2.cmml"><mo id="S3.Ex1.m2.2.2.1.1.1.1.1.2" xref="S3.Ex1.m2.2.2.1.1.1.1.2.1.cmml">[</mo><mrow id="S3.Ex1.m2.2.2.1.1.1.1.1.1" xref="S3.Ex1.m2.2.2.1.1.1.1.1.1.cmml"><mstyle displaystyle="true" id="S3.Ex1.m2.2.2.1.1.1.1.1.1.3" xref="S3.Ex1.m2.2.2.1.1.1.1.1.1.3.cmml"><munderover id="S3.Ex1.m2.2.2.1.1.1.1.1.1.3a" xref="S3.Ex1.m2.2.2.1.1.1.1.1.1.3.cmml"><mo movablelimits="false" id="S3.Ex1.m2.2.2.1.1.1.1.1.1.3.2.2" xref="S3.Ex1.m2.2.2.1.1.1.1.1.1.3.2.2.cmml">∑</mo><mi id="S3.Ex1.m2.2.2.1.1.1.1.1.1.3.2.3" xref="S3.Ex1.m2.2.2.1.1.1.1.1.1.3.2.3.cmml">i</mi><msub id="S3.Ex1.m2.2.2.1.1.1.1.1.1.3.3" xref="S3.Ex1.m2.2.2.1.1.1.1.1.1.3.3.cmml"><mi id="S3.Ex1.m2.2.2.1.1.1.1.1.1.3.3.2" xref="S3.Ex1.m2.2.2.1.1.1.1.1.1.3.3.2.cmml">N</mi><mi id="S3.Ex1.m2.2.2.1.1.1.1.1.1.3.3.3" xref="S3.Ex1.m2.2.2.1.1.1.1.1.1.3.3.3.cmml">s</mi></msub></munderover></mstyle><mrow id="S3.Ex1.m2.2.2.1.1.1.1.1.1.2" xref="S3.Ex1.m2.2.2.1.1.1.1.1.1.2.cmml"><mi id="S3.Ex1.m2.2.2.1.1.1.1.1.1.2.4" xref="S3.Ex1.m2.2.2.1.1.1.1.1.1.2.4.cmml">L</mi><mo lspace="0em" rspace="0em" id="S3.Ex1.m2.2.2.1.1.1.1.1.1.2.3" xref="S3.Ex1.m2.2.2.1.1.1.1.1.1.2.3.cmml">​</mo><mrow id="S3.Ex1.m2.2.2.1.1.1.1.1.1.2.2.2" xref="S3.Ex1.m2.2.2.1.1.1.1.1.1.2.2.3.cmml"><mo stretchy="false" id="S3.Ex1.m2.2.2.1.1.1.1.1.1.2.2.2.3" xref="S3.Ex1.m2.2.2.1.1.1.1.1.1.2.2.3.cmml">(</mo><msub id="S3.Ex1.m2.2.2.1.1.1.1.1.1.1.1.1.1" xref="S3.Ex1.m2.2.2.1.1.1.1.1.1.1.1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.Ex1.m2.2.2.1.1.1.1.1.1.1.1.1.1.2" xref="S3.Ex1.m2.2.2.1.1.1.1.1.1.1.1.1.1.2.cmml">𝒟</mi><mrow id="S3.Ex1.m2.2.2.1.1.1.1.1.1.1.1.1.1.3" xref="S3.Ex1.m2.2.2.1.1.1.1.1.1.1.1.1.1.3.cmml"><mi id="S3.Ex1.m2.2.2.1.1.1.1.1.1.1.1.1.1.3.2" xref="S3.Ex1.m2.2.2.1.1.1.1.1.1.1.1.1.1.3.2.cmml">s</mi><mo lspace="0em" rspace="0em" id="S3.Ex1.m2.2.2.1.1.1.1.1.1.1.1.1.1.3.1" xref="S3.Ex1.m2.2.2.1.1.1.1.1.1.1.1.1.1.3.1.cmml">​</mo><mi id="S3.Ex1.m2.2.2.1.1.1.1.1.1.1.1.1.1.3.3" xref="S3.Ex1.m2.2.2.1.1.1.1.1.1.1.1.1.1.3.3.cmml">i</mi></mrow></msub><mo id="S3.Ex1.m2.2.2.1.1.1.1.1.1.2.2.2.4" xref="S3.Ex1.m2.2.2.1.1.1.1.1.1.2.2.3.cmml">,</mo><mrow id="S3.Ex1.m2.2.2.1.1.1.1.1.1.2.2.2.2" xref="S3.Ex1.m2.2.2.1.1.1.1.1.1.2.2.2.2.cmml"><msub id="S3.Ex1.m2.2.2.1.1.1.1.1.1.2.2.2.2.2" xref="S3.Ex1.m2.2.2.1.1.1.1.1.1.2.2.2.2.2.cmml"><mi id="S3.Ex1.m2.2.2.1.1.1.1.1.1.2.2.2.2.2.2" xref="S3.Ex1.m2.2.2.1.1.1.1.1.1.2.2.2.2.2.2.cmml">𝐰</mi><mi id="S3.Ex1.m2.2.2.1.1.1.1.1.1.2.2.2.2.2.3" xref="S3.Ex1.m2.2.2.1.1.1.1.1.1.2.2.2.2.2.3.cmml">s</mi></msub><mo lspace="0.222em" rspace="0.222em" id="S3.Ex1.m2.2.2.1.1.1.1.1.1.2.2.2.2.1" xref="S3.Ex1.m2.2.2.1.1.1.1.1.1.2.2.2.2.1.cmml">⊙</mo><msub id="S3.Ex1.m2.2.2.1.1.1.1.1.1.2.2.2.2.3" xref="S3.Ex1.m2.2.2.1.1.1.1.1.1.2.2.2.2.3.cmml"><mi id="S3.Ex1.m2.2.2.1.1.1.1.1.1.2.2.2.2.3.2" xref="S3.Ex1.m2.2.2.1.1.1.1.1.1.2.2.2.2.3.2.cmml">𝐳</mi><mi id="S3.Ex1.m2.2.2.1.1.1.1.1.1.2.2.2.2.3.3" xref="S3.Ex1.m2.2.2.1.1.1.1.1.1.2.2.2.2.3.3.cmml">s</mi></msub></mrow><mo stretchy="false" id="S3.Ex1.m2.2.2.1.1.1.1.1.1.2.2.2.5" xref="S3.Ex1.m2.2.2.1.1.1.1.1.1.2.2.3.cmml">)</mo></mrow></mrow></mrow><mo id="S3.Ex1.m2.2.2.1.1.1.1.1.3" xref="S3.Ex1.m2.2.2.1.1.1.1.2.1.cmml">]</mo></mrow></mrow></mrow><mo id="S3.Ex1.m2.3.3.2.3" xref="S3.Ex1.m2.3.3.2.3.cmml">−</mo><mrow id="S3.Ex1.m2.3.3.2.2" xref="S3.Ex1.m2.3.3.2.2.cmml"><mstyle displaystyle="true" id="S3.Ex1.m2.3.3.2.2.3" xref="S3.Ex1.m2.3.3.2.2.3.cmml"><mfrac id="S3.Ex1.m2.3.3.2.2.3a" xref="S3.Ex1.m2.3.3.2.2.3.cmml"><mi id="S3.Ex1.m2.3.3.2.2.3.2" xref="S3.Ex1.m2.3.3.2.2.3.2.cmml">λ</mi><mn id="S3.Ex1.m2.3.3.2.2.3.3" xref="S3.Ex1.m2.3.3.2.2.3.3.cmml">2</mn></mfrac></mstyle><mo lspace="0em" rspace="0em" id="S3.Ex1.m2.3.3.2.2.2" xref="S3.Ex1.m2.3.3.2.2.2.cmml">​</mo><mrow id="S3.Ex1.m2.3.3.2.2.1" xref="S3.Ex1.m2.3.3.2.2.1.cmml"><mstyle displaystyle="true" id="S3.Ex1.m2.3.3.2.2.1.2" xref="S3.Ex1.m2.3.3.2.2.1.2.cmml"><munder id="S3.Ex1.m2.3.3.2.2.1.2a" xref="S3.Ex1.m2.3.3.2.2.1.2.cmml"><mo movablelimits="false" id="S3.Ex1.m2.3.3.2.2.1.2.2" xref="S3.Ex1.m2.3.3.2.2.1.2.2.cmml">∑</mo><mi id="S3.Ex1.m2.3.3.2.2.1.2.3" xref="S3.Ex1.m2.3.3.2.2.1.2.3.cmml">j</mi></munder></mstyle><mrow id="S3.Ex1.m2.3.3.2.2.1.1" xref="S3.Ex1.m2.3.3.2.2.1.1.cmml"><msub id="S3.Ex1.m2.3.3.2.2.1.1.3" xref="S3.Ex1.m2.3.3.2.2.1.1.3.cmml"><mi id="S3.Ex1.m2.3.3.2.2.1.1.3.2" xref="S3.Ex1.m2.3.3.2.2.1.1.3.2.cmml">𝝅</mi><mrow id="S3.Ex1.m2.3.3.2.2.1.1.3.3" xref="S3.Ex1.m2.3.3.2.2.1.1.3.3.cmml"><mi id="S3.Ex1.m2.3.3.2.2.1.1.3.3.2" xref="S3.Ex1.m2.3.3.2.2.1.1.3.3.2.cmml">s</mi><mo lspace="0em" rspace="0em" id="S3.Ex1.m2.3.3.2.2.1.1.3.3.1" xref="S3.Ex1.m2.3.3.2.2.1.1.3.3.1.cmml">​</mo><mi id="S3.Ex1.m2.3.3.2.2.1.1.3.3.3" xref="S3.Ex1.m2.3.3.2.2.1.1.3.3.3.cmml">j</mi></mrow></msub><mo lspace="0em" rspace="0em" id="S3.Ex1.m2.3.3.2.2.1.1.2" xref="S3.Ex1.m2.3.3.2.2.1.1.2.cmml">​</mo><msup id="S3.Ex1.m2.3.3.2.2.1.1.1" xref="S3.Ex1.m2.3.3.2.2.1.1.1.cmml"><mrow id="S3.Ex1.m2.3.3.2.2.1.1.1.1.1" xref="S3.Ex1.m2.3.3.2.2.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S3.Ex1.m2.3.3.2.2.1.1.1.1.1.2" xref="S3.Ex1.m2.3.3.2.2.1.1.1.1.1.1.cmml">(</mo><mrow id="S3.Ex1.m2.3.3.2.2.1.1.1.1.1.1" xref="S3.Ex1.m2.3.3.2.2.1.1.1.1.1.1.cmml"><msub id="S3.Ex1.m2.3.3.2.2.1.1.1.1.1.1.2" xref="S3.Ex1.m2.3.3.2.2.1.1.1.1.1.1.2.cmml"><mi id="S3.Ex1.m2.3.3.2.2.1.1.1.1.1.1.2.2" xref="S3.Ex1.m2.3.3.2.2.1.1.1.1.1.1.2.2.cmml">𝐰</mi><mrow id="S3.Ex1.m2.3.3.2.2.1.1.1.1.1.1.2.3" xref="S3.Ex1.m2.3.3.2.2.1.1.1.1.1.1.2.3.cmml"><mi id="S3.Ex1.m2.3.3.2.2.1.1.1.1.1.1.2.3.2" xref="S3.Ex1.m2.3.3.2.2.1.1.1.1.1.1.2.3.2.cmml">s</mi><mo lspace="0em" rspace="0em" id="S3.Ex1.m2.3.3.2.2.1.1.1.1.1.1.2.3.1" xref="S3.Ex1.m2.3.3.2.2.1.1.1.1.1.1.2.3.1.cmml">​</mo><mi id="S3.Ex1.m2.3.3.2.2.1.1.1.1.1.1.2.3.3" xref="S3.Ex1.m2.3.3.2.2.1.1.1.1.1.1.2.3.3.cmml">j</mi></mrow></msub><mo id="S3.Ex1.m2.3.3.2.2.1.1.1.1.1.1.1" xref="S3.Ex1.m2.3.3.2.2.1.1.1.1.1.1.1.cmml">−</mo><msub id="S3.Ex1.m2.3.3.2.2.1.1.1.1.1.1.3" xref="S3.Ex1.m2.3.3.2.2.1.1.1.1.1.1.3.cmml"><mi id="S3.Ex1.m2.3.3.2.2.1.1.1.1.1.1.3.2" xref="S3.Ex1.m2.3.3.2.2.1.1.1.1.1.1.3.2.cmml">𝐰</mi><mi id="S3.Ex1.m2.3.3.2.2.1.1.1.1.1.1.3.3" xref="S3.Ex1.m2.3.3.2.2.1.1.1.1.1.1.3.3.cmml">j</mi></msub></mrow><mo stretchy="false" id="S3.Ex1.m2.3.3.2.2.1.1.1.1.1.3" xref="S3.Ex1.m2.3.3.2.2.1.1.1.1.1.1.cmml">)</mo></mrow><mn id="S3.Ex1.m2.3.3.2.2.1.1.1.3" xref="S3.Ex1.m2.3.3.2.2.1.1.1.3.cmml">2</mn></msup></mrow></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.Ex1.m2.3b"><apply id="S3.Ex1.m2.3.3.cmml" xref="S3.Ex1.m2.3.3"><csymbol cd="latexml" id="S3.Ex1.m2.3.3.3.cmml" xref="S3.Ex1.m2.3.3.3">assign</csymbol><csymbol cd="latexml" id="S3.Ex1.m2.3.3.4.cmml" xref="S3.Ex1.m2.3.3.4">absent</csymbol><apply id="S3.Ex1.m2.3.3.2.cmml" xref="S3.Ex1.m2.3.3.2"><minus id="S3.Ex1.m2.3.3.2.3.cmml" xref="S3.Ex1.m2.3.3.2.3"></minus><apply id="S3.Ex1.m2.2.2.1.1.cmml" xref="S3.Ex1.m2.2.2.1.1"><plus id="S3.Ex1.m2.2.2.1.1.2.cmml" xref="S3.Ex1.m2.2.2.1.1.2"></plus><ci id="S3.Ex1.m2.2.2.1.1.3.cmml" xref="S3.Ex1.m2.2.2.1.1.3">𝐶</ci><apply id="S3.Ex1.m2.2.2.1.1.1.cmml" xref="S3.Ex1.m2.2.2.1.1.1"><times id="S3.Ex1.m2.2.2.1.1.1.2.cmml" xref="S3.Ex1.m2.2.2.1.1.1.2"></times><apply id="S3.Ex1.m2.2.2.1.1.1.3.cmml" xref="S3.Ex1.m2.2.2.1.1.1.3"><csymbol cd="ambiguous" id="S3.Ex1.m2.2.2.1.1.1.3.1.cmml" xref="S3.Ex1.m2.2.2.1.1.1.3">subscript</csymbol><ci id="S3.Ex1.m2.2.2.1.1.1.3.2.cmml" xref="S3.Ex1.m2.2.2.1.1.1.3.2">𝔼</ci><apply id="S3.Ex1.m2.1.1.1.cmml" xref="S3.Ex1.m2.1.1.1"><times id="S3.Ex1.m2.1.1.1.2.cmml" xref="S3.Ex1.m2.1.1.1.2"></times><apply id="S3.Ex1.m2.1.1.1.3.cmml" xref="S3.Ex1.m2.1.1.1.3"><csymbol cd="ambiguous" id="S3.Ex1.m2.1.1.1.3.1.cmml" xref="S3.Ex1.m2.1.1.1.3">subscript</csymbol><ci id="S3.Ex1.m2.1.1.1.3.2.cmml" xref="S3.Ex1.m2.1.1.1.3.2">𝑞</ci><apply id="S3.Ex1.m2.1.1.1.3.3.cmml" xref="S3.Ex1.m2.1.1.1.3.3"><csymbol cd="ambiguous" id="S3.Ex1.m2.1.1.1.3.3.1.cmml" xref="S3.Ex1.m2.1.1.1.3.3">subscript</csymbol><ci id="S3.Ex1.m2.1.1.1.3.3.2.cmml" xref="S3.Ex1.m2.1.1.1.3.3.2">𝝅</ci><ci id="S3.Ex1.m2.1.1.1.3.3.3.cmml" xref="S3.Ex1.m2.1.1.1.3.3.3">𝑠</ci></apply></apply><apply id="S3.Ex1.m2.1.1.1.1.1.1.cmml" xref="S3.Ex1.m2.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.Ex1.m2.1.1.1.1.1.1.1.cmml" xref="S3.Ex1.m2.1.1.1.1.1">subscript</csymbol><ci id="S3.Ex1.m2.1.1.1.1.1.1.2.cmml" xref="S3.Ex1.m2.1.1.1.1.1.1.2">𝐳</ci><ci id="S3.Ex1.m2.1.1.1.1.1.1.3.cmml" xref="S3.Ex1.m2.1.1.1.1.1.1.3">𝑠</ci></apply></apply></apply><apply id="S3.Ex1.m2.2.2.1.1.1.1.2.cmml" xref="S3.Ex1.m2.2.2.1.1.1.1.1"><csymbol cd="latexml" id="S3.Ex1.m2.2.2.1.1.1.1.2.1.cmml" xref="S3.Ex1.m2.2.2.1.1.1.1.1.2">delimited-[]</csymbol><apply id="S3.Ex1.m2.2.2.1.1.1.1.1.1.cmml" xref="S3.Ex1.m2.2.2.1.1.1.1.1.1"><apply id="S3.Ex1.m2.2.2.1.1.1.1.1.1.3.cmml" xref="S3.Ex1.m2.2.2.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.Ex1.m2.2.2.1.1.1.1.1.1.3.1.cmml" xref="S3.Ex1.m2.2.2.1.1.1.1.1.1.3">superscript</csymbol><apply id="S3.Ex1.m2.2.2.1.1.1.1.1.1.3.2.cmml" xref="S3.Ex1.m2.2.2.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.Ex1.m2.2.2.1.1.1.1.1.1.3.2.1.cmml" xref="S3.Ex1.m2.2.2.1.1.1.1.1.1.3">subscript</csymbol><sum id="S3.Ex1.m2.2.2.1.1.1.1.1.1.3.2.2.cmml" xref="S3.Ex1.m2.2.2.1.1.1.1.1.1.3.2.2"></sum><ci id="S3.Ex1.m2.2.2.1.1.1.1.1.1.3.2.3.cmml" xref="S3.Ex1.m2.2.2.1.1.1.1.1.1.3.2.3">𝑖</ci></apply><apply id="S3.Ex1.m2.2.2.1.1.1.1.1.1.3.3.cmml" xref="S3.Ex1.m2.2.2.1.1.1.1.1.1.3.3"><csymbol cd="ambiguous" id="S3.Ex1.m2.2.2.1.1.1.1.1.1.3.3.1.cmml" xref="S3.Ex1.m2.2.2.1.1.1.1.1.1.3.3">subscript</csymbol><ci id="S3.Ex1.m2.2.2.1.1.1.1.1.1.3.3.2.cmml" xref="S3.Ex1.m2.2.2.1.1.1.1.1.1.3.3.2">𝑁</ci><ci id="S3.Ex1.m2.2.2.1.1.1.1.1.1.3.3.3.cmml" xref="S3.Ex1.m2.2.2.1.1.1.1.1.1.3.3.3">𝑠</ci></apply></apply><apply id="S3.Ex1.m2.2.2.1.1.1.1.1.1.2.cmml" xref="S3.Ex1.m2.2.2.1.1.1.1.1.1.2"><times id="S3.Ex1.m2.2.2.1.1.1.1.1.1.2.3.cmml" xref="S3.Ex1.m2.2.2.1.1.1.1.1.1.2.3"></times><ci id="S3.Ex1.m2.2.2.1.1.1.1.1.1.2.4.cmml" xref="S3.Ex1.m2.2.2.1.1.1.1.1.1.2.4">𝐿</ci><interval closure="open" id="S3.Ex1.m2.2.2.1.1.1.1.1.1.2.2.3.cmml" xref="S3.Ex1.m2.2.2.1.1.1.1.1.1.2.2.2"><apply id="S3.Ex1.m2.2.2.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.Ex1.m2.2.2.1.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.Ex1.m2.2.2.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.Ex1.m2.2.2.1.1.1.1.1.1.1.1.1.1">subscript</csymbol><ci id="S3.Ex1.m2.2.2.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S3.Ex1.m2.2.2.1.1.1.1.1.1.1.1.1.1.2">𝒟</ci><apply id="S3.Ex1.m2.2.2.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="S3.Ex1.m2.2.2.1.1.1.1.1.1.1.1.1.1.3"><times id="S3.Ex1.m2.2.2.1.1.1.1.1.1.1.1.1.1.3.1.cmml" xref="S3.Ex1.m2.2.2.1.1.1.1.1.1.1.1.1.1.3.1"></times><ci id="S3.Ex1.m2.2.2.1.1.1.1.1.1.1.1.1.1.3.2.cmml" xref="S3.Ex1.m2.2.2.1.1.1.1.1.1.1.1.1.1.3.2">𝑠</ci><ci id="S3.Ex1.m2.2.2.1.1.1.1.1.1.1.1.1.1.3.3.cmml" xref="S3.Ex1.m2.2.2.1.1.1.1.1.1.1.1.1.1.3.3">𝑖</ci></apply></apply><apply id="S3.Ex1.m2.2.2.1.1.1.1.1.1.2.2.2.2.cmml" xref="S3.Ex1.m2.2.2.1.1.1.1.1.1.2.2.2.2"><csymbol cd="latexml" id="S3.Ex1.m2.2.2.1.1.1.1.1.1.2.2.2.2.1.cmml" xref="S3.Ex1.m2.2.2.1.1.1.1.1.1.2.2.2.2.1">direct-product</csymbol><apply id="S3.Ex1.m2.2.2.1.1.1.1.1.1.2.2.2.2.2.cmml" xref="S3.Ex1.m2.2.2.1.1.1.1.1.1.2.2.2.2.2"><csymbol cd="ambiguous" id="S3.Ex1.m2.2.2.1.1.1.1.1.1.2.2.2.2.2.1.cmml" xref="S3.Ex1.m2.2.2.1.1.1.1.1.1.2.2.2.2.2">subscript</csymbol><ci id="S3.Ex1.m2.2.2.1.1.1.1.1.1.2.2.2.2.2.2.cmml" xref="S3.Ex1.m2.2.2.1.1.1.1.1.1.2.2.2.2.2.2">𝐰</ci><ci id="S3.Ex1.m2.2.2.1.1.1.1.1.1.2.2.2.2.2.3.cmml" xref="S3.Ex1.m2.2.2.1.1.1.1.1.1.2.2.2.2.2.3">𝑠</ci></apply><apply id="S3.Ex1.m2.2.2.1.1.1.1.1.1.2.2.2.2.3.cmml" xref="S3.Ex1.m2.2.2.1.1.1.1.1.1.2.2.2.2.3"><csymbol cd="ambiguous" id="S3.Ex1.m2.2.2.1.1.1.1.1.1.2.2.2.2.3.1.cmml" xref="S3.Ex1.m2.2.2.1.1.1.1.1.1.2.2.2.2.3">subscript</csymbol><ci id="S3.Ex1.m2.2.2.1.1.1.1.1.1.2.2.2.2.3.2.cmml" xref="S3.Ex1.m2.2.2.1.1.1.1.1.1.2.2.2.2.3.2">𝐳</ci><ci id="S3.Ex1.m2.2.2.1.1.1.1.1.1.2.2.2.2.3.3.cmml" xref="S3.Ex1.m2.2.2.1.1.1.1.1.1.2.2.2.2.3.3">𝑠</ci></apply></apply></interval></apply></apply></apply></apply></apply><apply id="S3.Ex1.m2.3.3.2.2.cmml" xref="S3.Ex1.m2.3.3.2.2"><times id="S3.Ex1.m2.3.3.2.2.2.cmml" xref="S3.Ex1.m2.3.3.2.2.2"></times><apply id="S3.Ex1.m2.3.3.2.2.3.cmml" xref="S3.Ex1.m2.3.3.2.2.3"><divide id="S3.Ex1.m2.3.3.2.2.3.1.cmml" xref="S3.Ex1.m2.3.3.2.2.3"></divide><ci id="S3.Ex1.m2.3.3.2.2.3.2.cmml" xref="S3.Ex1.m2.3.3.2.2.3.2">𝜆</ci><cn type="integer" id="S3.Ex1.m2.3.3.2.2.3.3.cmml" xref="S3.Ex1.m2.3.3.2.2.3.3">2</cn></apply><apply id="S3.Ex1.m2.3.3.2.2.1.cmml" xref="S3.Ex1.m2.3.3.2.2.1"><apply id="S3.Ex1.m2.3.3.2.2.1.2.cmml" xref="S3.Ex1.m2.3.3.2.2.1.2"><csymbol cd="ambiguous" id="S3.Ex1.m2.3.3.2.2.1.2.1.cmml" xref="S3.Ex1.m2.3.3.2.2.1.2">subscript</csymbol><sum id="S3.Ex1.m2.3.3.2.2.1.2.2.cmml" xref="S3.Ex1.m2.3.3.2.2.1.2.2"></sum><ci id="S3.Ex1.m2.3.3.2.2.1.2.3.cmml" xref="S3.Ex1.m2.3.3.2.2.1.2.3">𝑗</ci></apply><apply id="S3.Ex1.m2.3.3.2.2.1.1.cmml" xref="S3.Ex1.m2.3.3.2.2.1.1"><times id="S3.Ex1.m2.3.3.2.2.1.1.2.cmml" xref="S3.Ex1.m2.3.3.2.2.1.1.2"></times><apply id="S3.Ex1.m2.3.3.2.2.1.1.3.cmml" xref="S3.Ex1.m2.3.3.2.2.1.1.3"><csymbol cd="ambiguous" id="S3.Ex1.m2.3.3.2.2.1.1.3.1.cmml" xref="S3.Ex1.m2.3.3.2.2.1.1.3">subscript</csymbol><ci id="S3.Ex1.m2.3.3.2.2.1.1.3.2.cmml" xref="S3.Ex1.m2.3.3.2.2.1.1.3.2">𝝅</ci><apply id="S3.Ex1.m2.3.3.2.2.1.1.3.3.cmml" xref="S3.Ex1.m2.3.3.2.2.1.1.3.3"><times id="S3.Ex1.m2.3.3.2.2.1.1.3.3.1.cmml" xref="S3.Ex1.m2.3.3.2.2.1.1.3.3.1"></times><ci id="S3.Ex1.m2.3.3.2.2.1.1.3.3.2.cmml" xref="S3.Ex1.m2.3.3.2.2.1.1.3.3.2">𝑠</ci><ci id="S3.Ex1.m2.3.3.2.2.1.1.3.3.3.cmml" xref="S3.Ex1.m2.3.3.2.2.1.1.3.3.3">𝑗</ci></apply></apply><apply id="S3.Ex1.m2.3.3.2.2.1.1.1.cmml" xref="S3.Ex1.m2.3.3.2.2.1.1.1"><csymbol cd="ambiguous" id="S3.Ex1.m2.3.3.2.2.1.1.1.2.cmml" xref="S3.Ex1.m2.3.3.2.2.1.1.1">superscript</csymbol><apply id="S3.Ex1.m2.3.3.2.2.1.1.1.1.1.1.cmml" xref="S3.Ex1.m2.3.3.2.2.1.1.1.1.1"><minus id="S3.Ex1.m2.3.3.2.2.1.1.1.1.1.1.1.cmml" xref="S3.Ex1.m2.3.3.2.2.1.1.1.1.1.1.1"></minus><apply id="S3.Ex1.m2.3.3.2.2.1.1.1.1.1.1.2.cmml" xref="S3.Ex1.m2.3.3.2.2.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.Ex1.m2.3.3.2.2.1.1.1.1.1.1.2.1.cmml" xref="S3.Ex1.m2.3.3.2.2.1.1.1.1.1.1.2">subscript</csymbol><ci id="S3.Ex1.m2.3.3.2.2.1.1.1.1.1.1.2.2.cmml" xref="S3.Ex1.m2.3.3.2.2.1.1.1.1.1.1.2.2">𝐰</ci><apply id="S3.Ex1.m2.3.3.2.2.1.1.1.1.1.1.2.3.cmml" xref="S3.Ex1.m2.3.3.2.2.1.1.1.1.1.1.2.3"><times id="S3.Ex1.m2.3.3.2.2.1.1.1.1.1.1.2.3.1.cmml" xref="S3.Ex1.m2.3.3.2.2.1.1.1.1.1.1.2.3.1"></times><ci id="S3.Ex1.m2.3.3.2.2.1.1.1.1.1.1.2.3.2.cmml" xref="S3.Ex1.m2.3.3.2.2.1.1.1.1.1.1.2.3.2">𝑠</ci><ci id="S3.Ex1.m2.3.3.2.2.1.1.1.1.1.1.2.3.3.cmml" xref="S3.Ex1.m2.3.3.2.2.1.1.1.1.1.1.2.3.3">𝑗</ci></apply></apply><apply id="S3.Ex1.m2.3.3.2.2.1.1.1.1.1.1.3.cmml" xref="S3.Ex1.m2.3.3.2.2.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.Ex1.m2.3.3.2.2.1.1.1.1.1.1.3.1.cmml" xref="S3.Ex1.m2.3.3.2.2.1.1.1.1.1.1.3">subscript</csymbol><ci id="S3.Ex1.m2.3.3.2.2.1.1.1.1.1.1.3.2.cmml" xref="S3.Ex1.m2.3.3.2.2.1.1.1.1.1.1.3.2">𝐰</ci><ci id="S3.Ex1.m2.3.3.2.2.1.1.1.1.1.1.3.3.cmml" xref="S3.Ex1.m2.3.3.2.2.1.1.1.1.1.1.3.3">𝑗</ci></apply></apply><cn type="integer" id="S3.Ex1.m2.3.3.2.2.1.1.1.3.cmml" xref="S3.Ex1.m2.3.3.2.2.1.1.1.3">2</cn></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.Ex1.m2.3c">\displaystyle:=C+\mathbb{E}_{q_{\bm{\pi}_{s}}(\mathbf{z}_{s})}\left[\sum_{i}^{N_{s}}L(\mathcal{D}_{si},\mathbf{w}_{s}\odot\mathbf{z}_{s})\right]-\frac{\lambda}{2}\sum_{j}\bm{\pi}_{sj}(\mathbf{w}_{sj}-\mathbf{w}_{j})^{2}</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
<tbody id="S3.E17"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_eqn_cell"></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math id="S3.E17.m1.2" class="ltx_Math" alttext="\displaystyle\quad-\lambda_{0}\sum_{j}\bm{\pi}_{sj}+\sum_{j}\left(\bm{\pi}_{sj}\log\bm{\theta}_{j}+(1-\bm{\pi}_{sj})\log(1-\bm{\theta}_{j})\right)," display="inline"><semantics id="S3.E17.m1.2a"><mrow id="S3.E17.m1.2.2.1" xref="S3.E17.m1.2.2.1.1.cmml"><mrow id="S3.E17.m1.2.2.1.1" xref="S3.E17.m1.2.2.1.1.cmml"><mrow id="S3.E17.m1.2.2.1.1.3" xref="S3.E17.m1.2.2.1.1.3.cmml"><mo id="S3.E17.m1.2.2.1.1.3a" xref="S3.E17.m1.2.2.1.1.3.cmml">−</mo><mrow id="S3.E17.m1.2.2.1.1.3.2" xref="S3.E17.m1.2.2.1.1.3.2.cmml"><msub id="S3.E17.m1.2.2.1.1.3.2.2" xref="S3.E17.m1.2.2.1.1.3.2.2.cmml"><mi id="S3.E17.m1.2.2.1.1.3.2.2.2" xref="S3.E17.m1.2.2.1.1.3.2.2.2.cmml">λ</mi><mn id="S3.E17.m1.2.2.1.1.3.2.2.3" xref="S3.E17.m1.2.2.1.1.3.2.2.3.cmml">0</mn></msub><mo lspace="0em" rspace="0em" id="S3.E17.m1.2.2.1.1.3.2.1" xref="S3.E17.m1.2.2.1.1.3.2.1.cmml">​</mo><mrow id="S3.E17.m1.2.2.1.1.3.2.3" xref="S3.E17.m1.2.2.1.1.3.2.3.cmml"><mstyle displaystyle="true" id="S3.E17.m1.2.2.1.1.3.2.3.1" xref="S3.E17.m1.2.2.1.1.3.2.3.1.cmml"><munder id="S3.E17.m1.2.2.1.1.3.2.3.1a" xref="S3.E17.m1.2.2.1.1.3.2.3.1.cmml"><mo movablelimits="false" id="S3.E17.m1.2.2.1.1.3.2.3.1.2" xref="S3.E17.m1.2.2.1.1.3.2.3.1.2.cmml">∑</mo><mi id="S3.E17.m1.2.2.1.1.3.2.3.1.3" xref="S3.E17.m1.2.2.1.1.3.2.3.1.3.cmml">j</mi></munder></mstyle><msub id="S3.E17.m1.2.2.1.1.3.2.3.2" xref="S3.E17.m1.2.2.1.1.3.2.3.2.cmml"><mi id="S3.E17.m1.2.2.1.1.3.2.3.2.2" xref="S3.E17.m1.2.2.1.1.3.2.3.2.2.cmml">𝝅</mi><mrow id="S3.E17.m1.2.2.1.1.3.2.3.2.3" xref="S3.E17.m1.2.2.1.1.3.2.3.2.3.cmml"><mi id="S3.E17.m1.2.2.1.1.3.2.3.2.3.2" xref="S3.E17.m1.2.2.1.1.3.2.3.2.3.2.cmml">s</mi><mo lspace="0em" rspace="0em" id="S3.E17.m1.2.2.1.1.3.2.3.2.3.1" xref="S3.E17.m1.2.2.1.1.3.2.3.2.3.1.cmml">​</mo><mi id="S3.E17.m1.2.2.1.1.3.2.3.2.3.3" xref="S3.E17.m1.2.2.1.1.3.2.3.2.3.3.cmml">j</mi></mrow></msub></mrow></mrow></mrow><mo id="S3.E17.m1.2.2.1.1.2" xref="S3.E17.m1.2.2.1.1.2.cmml">+</mo><mrow id="S3.E17.m1.2.2.1.1.1" xref="S3.E17.m1.2.2.1.1.1.cmml"><mstyle displaystyle="true" id="S3.E17.m1.2.2.1.1.1.2" xref="S3.E17.m1.2.2.1.1.1.2.cmml"><munder id="S3.E17.m1.2.2.1.1.1.2a" xref="S3.E17.m1.2.2.1.1.1.2.cmml"><mo movablelimits="false" id="S3.E17.m1.2.2.1.1.1.2.2" xref="S3.E17.m1.2.2.1.1.1.2.2.cmml">∑</mo><mi id="S3.E17.m1.2.2.1.1.1.2.3" xref="S3.E17.m1.2.2.1.1.1.2.3.cmml">j</mi></munder></mstyle><mrow id="S3.E17.m1.2.2.1.1.1.1.1" xref="S3.E17.m1.2.2.1.1.1.1.1.1.cmml"><mo id="S3.E17.m1.2.2.1.1.1.1.1.2" xref="S3.E17.m1.2.2.1.1.1.1.1.1.cmml">(</mo><mrow id="S3.E17.m1.2.2.1.1.1.1.1.1" xref="S3.E17.m1.2.2.1.1.1.1.1.1.cmml"><mrow id="S3.E17.m1.2.2.1.1.1.1.1.1.4" xref="S3.E17.m1.2.2.1.1.1.1.1.1.4.cmml"><msub id="S3.E17.m1.2.2.1.1.1.1.1.1.4.2" xref="S3.E17.m1.2.2.1.1.1.1.1.1.4.2.cmml"><mi id="S3.E17.m1.2.2.1.1.1.1.1.1.4.2.2" xref="S3.E17.m1.2.2.1.1.1.1.1.1.4.2.2.cmml">𝝅</mi><mrow id="S3.E17.m1.2.2.1.1.1.1.1.1.4.2.3" xref="S3.E17.m1.2.2.1.1.1.1.1.1.4.2.3.cmml"><mi id="S3.E17.m1.2.2.1.1.1.1.1.1.4.2.3.2" xref="S3.E17.m1.2.2.1.1.1.1.1.1.4.2.3.2.cmml">s</mi><mo lspace="0em" rspace="0em" id="S3.E17.m1.2.2.1.1.1.1.1.1.4.2.3.1" xref="S3.E17.m1.2.2.1.1.1.1.1.1.4.2.3.1.cmml">​</mo><mi id="S3.E17.m1.2.2.1.1.1.1.1.1.4.2.3.3" xref="S3.E17.m1.2.2.1.1.1.1.1.1.4.2.3.3.cmml">j</mi></mrow></msub><mo lspace="0.167em" rspace="0em" id="S3.E17.m1.2.2.1.1.1.1.1.1.4.1" xref="S3.E17.m1.2.2.1.1.1.1.1.1.4.1.cmml">​</mo><mrow id="S3.E17.m1.2.2.1.1.1.1.1.1.4.3" xref="S3.E17.m1.2.2.1.1.1.1.1.1.4.3.cmml"><mi id="S3.E17.m1.2.2.1.1.1.1.1.1.4.3.1" xref="S3.E17.m1.2.2.1.1.1.1.1.1.4.3.1.cmml">log</mi><mo lspace="0.167em" id="S3.E17.m1.2.2.1.1.1.1.1.1.4.3a" xref="S3.E17.m1.2.2.1.1.1.1.1.1.4.3.cmml">⁡</mo><msub id="S3.E17.m1.2.2.1.1.1.1.1.1.4.3.2" xref="S3.E17.m1.2.2.1.1.1.1.1.1.4.3.2.cmml"><mi id="S3.E17.m1.2.2.1.1.1.1.1.1.4.3.2.2" xref="S3.E17.m1.2.2.1.1.1.1.1.1.4.3.2.2.cmml">𝜽</mi><mi id="S3.E17.m1.2.2.1.1.1.1.1.1.4.3.2.3" xref="S3.E17.m1.2.2.1.1.1.1.1.1.4.3.2.3.cmml">j</mi></msub></mrow></mrow><mo id="S3.E17.m1.2.2.1.1.1.1.1.1.3" xref="S3.E17.m1.2.2.1.1.1.1.1.1.3.cmml">+</mo><mrow id="S3.E17.m1.2.2.1.1.1.1.1.1.2" xref="S3.E17.m1.2.2.1.1.1.1.1.1.2.cmml"><mrow id="S3.E17.m1.2.2.1.1.1.1.1.1.1.1.1" xref="S3.E17.m1.2.2.1.1.1.1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S3.E17.m1.2.2.1.1.1.1.1.1.1.1.1.2" xref="S3.E17.m1.2.2.1.1.1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="S3.E17.m1.2.2.1.1.1.1.1.1.1.1.1.1" xref="S3.E17.m1.2.2.1.1.1.1.1.1.1.1.1.1.cmml"><mn id="S3.E17.m1.2.2.1.1.1.1.1.1.1.1.1.1.2" xref="S3.E17.m1.2.2.1.1.1.1.1.1.1.1.1.1.2.cmml">1</mn><mo id="S3.E17.m1.2.2.1.1.1.1.1.1.1.1.1.1.1" xref="S3.E17.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.cmml">−</mo><msub id="S3.E17.m1.2.2.1.1.1.1.1.1.1.1.1.1.3" xref="S3.E17.m1.2.2.1.1.1.1.1.1.1.1.1.1.3.cmml"><mi id="S3.E17.m1.2.2.1.1.1.1.1.1.1.1.1.1.3.2" xref="S3.E17.m1.2.2.1.1.1.1.1.1.1.1.1.1.3.2.cmml">𝝅</mi><mrow id="S3.E17.m1.2.2.1.1.1.1.1.1.1.1.1.1.3.3" xref="S3.E17.m1.2.2.1.1.1.1.1.1.1.1.1.1.3.3.cmml"><mi id="S3.E17.m1.2.2.1.1.1.1.1.1.1.1.1.1.3.3.2" xref="S3.E17.m1.2.2.1.1.1.1.1.1.1.1.1.1.3.3.2.cmml">s</mi><mo lspace="0em" rspace="0em" id="S3.E17.m1.2.2.1.1.1.1.1.1.1.1.1.1.3.3.1" xref="S3.E17.m1.2.2.1.1.1.1.1.1.1.1.1.1.3.3.1.cmml">​</mo><mi id="S3.E17.m1.2.2.1.1.1.1.1.1.1.1.1.1.3.3.3" xref="S3.E17.m1.2.2.1.1.1.1.1.1.1.1.1.1.3.3.3.cmml">j</mi></mrow></msub></mrow><mo stretchy="false" id="S3.E17.m1.2.2.1.1.1.1.1.1.1.1.1.3" xref="S3.E17.m1.2.2.1.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow><mo lspace="0.167em" rspace="0em" id="S3.E17.m1.2.2.1.1.1.1.1.1.2.3" xref="S3.E17.m1.2.2.1.1.1.1.1.1.2.3.cmml">​</mo><mrow id="S3.E17.m1.2.2.1.1.1.1.1.1.2.2.1" xref="S3.E17.m1.2.2.1.1.1.1.1.1.2.2.2.cmml"><mi id="S3.E17.m1.1.1" xref="S3.E17.m1.1.1.cmml">log</mi><mo id="S3.E17.m1.2.2.1.1.1.1.1.1.2.2.1a" xref="S3.E17.m1.2.2.1.1.1.1.1.1.2.2.2.cmml">⁡</mo><mrow id="S3.E17.m1.2.2.1.1.1.1.1.1.2.2.1.1" xref="S3.E17.m1.2.2.1.1.1.1.1.1.2.2.2.cmml"><mo stretchy="false" id="S3.E17.m1.2.2.1.1.1.1.1.1.2.2.1.1.2" xref="S3.E17.m1.2.2.1.1.1.1.1.1.2.2.2.cmml">(</mo><mrow id="S3.E17.m1.2.2.1.1.1.1.1.1.2.2.1.1.1" xref="S3.E17.m1.2.2.1.1.1.1.1.1.2.2.1.1.1.cmml"><mn id="S3.E17.m1.2.2.1.1.1.1.1.1.2.2.1.1.1.2" xref="S3.E17.m1.2.2.1.1.1.1.1.1.2.2.1.1.1.2.cmml">1</mn><mo id="S3.E17.m1.2.2.1.1.1.1.1.1.2.2.1.1.1.1" xref="S3.E17.m1.2.2.1.1.1.1.1.1.2.2.1.1.1.1.cmml">−</mo><msub id="S3.E17.m1.2.2.1.1.1.1.1.1.2.2.1.1.1.3" xref="S3.E17.m1.2.2.1.1.1.1.1.1.2.2.1.1.1.3.cmml"><mi id="S3.E17.m1.2.2.1.1.1.1.1.1.2.2.1.1.1.3.2" xref="S3.E17.m1.2.2.1.1.1.1.1.1.2.2.1.1.1.3.2.cmml">𝜽</mi><mi id="S3.E17.m1.2.2.1.1.1.1.1.1.2.2.1.1.1.3.3" xref="S3.E17.m1.2.2.1.1.1.1.1.1.2.2.1.1.1.3.3.cmml">j</mi></msub></mrow><mo stretchy="false" id="S3.E17.m1.2.2.1.1.1.1.1.1.2.2.1.1.3" xref="S3.E17.m1.2.2.1.1.1.1.1.1.2.2.2.cmml">)</mo></mrow></mrow></mrow></mrow><mo id="S3.E17.m1.2.2.1.1.1.1.1.3" xref="S3.E17.m1.2.2.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><mo id="S3.E17.m1.2.2.1.2" xref="S3.E17.m1.2.2.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E17.m1.2b"><apply id="S3.E17.m1.2.2.1.1.cmml" xref="S3.E17.m1.2.2.1"><plus id="S3.E17.m1.2.2.1.1.2.cmml" xref="S3.E17.m1.2.2.1.1.2"></plus><apply id="S3.E17.m1.2.2.1.1.3.cmml" xref="S3.E17.m1.2.2.1.1.3"><minus id="S3.E17.m1.2.2.1.1.3.1.cmml" xref="S3.E17.m1.2.2.1.1.3"></minus><apply id="S3.E17.m1.2.2.1.1.3.2.cmml" xref="S3.E17.m1.2.2.1.1.3.2"><times id="S3.E17.m1.2.2.1.1.3.2.1.cmml" xref="S3.E17.m1.2.2.1.1.3.2.1"></times><apply id="S3.E17.m1.2.2.1.1.3.2.2.cmml" xref="S3.E17.m1.2.2.1.1.3.2.2"><csymbol cd="ambiguous" id="S3.E17.m1.2.2.1.1.3.2.2.1.cmml" xref="S3.E17.m1.2.2.1.1.3.2.2">subscript</csymbol><ci id="S3.E17.m1.2.2.1.1.3.2.2.2.cmml" xref="S3.E17.m1.2.2.1.1.3.2.2.2">𝜆</ci><cn type="integer" id="S3.E17.m1.2.2.1.1.3.2.2.3.cmml" xref="S3.E17.m1.2.2.1.1.3.2.2.3">0</cn></apply><apply id="S3.E17.m1.2.2.1.1.3.2.3.cmml" xref="S3.E17.m1.2.2.1.1.3.2.3"><apply id="S3.E17.m1.2.2.1.1.3.2.3.1.cmml" xref="S3.E17.m1.2.2.1.1.3.2.3.1"><csymbol cd="ambiguous" id="S3.E17.m1.2.2.1.1.3.2.3.1.1.cmml" xref="S3.E17.m1.2.2.1.1.3.2.3.1">subscript</csymbol><sum id="S3.E17.m1.2.2.1.1.3.2.3.1.2.cmml" xref="S3.E17.m1.2.2.1.1.3.2.3.1.2"></sum><ci id="S3.E17.m1.2.2.1.1.3.2.3.1.3.cmml" xref="S3.E17.m1.2.2.1.1.3.2.3.1.3">𝑗</ci></apply><apply id="S3.E17.m1.2.2.1.1.3.2.3.2.cmml" xref="S3.E17.m1.2.2.1.1.3.2.3.2"><csymbol cd="ambiguous" id="S3.E17.m1.2.2.1.1.3.2.3.2.1.cmml" xref="S3.E17.m1.2.2.1.1.3.2.3.2">subscript</csymbol><ci id="S3.E17.m1.2.2.1.1.3.2.3.2.2.cmml" xref="S3.E17.m1.2.2.1.1.3.2.3.2.2">𝝅</ci><apply id="S3.E17.m1.2.2.1.1.3.2.3.2.3.cmml" xref="S3.E17.m1.2.2.1.1.3.2.3.2.3"><times id="S3.E17.m1.2.2.1.1.3.2.3.2.3.1.cmml" xref="S3.E17.m1.2.2.1.1.3.2.3.2.3.1"></times><ci id="S3.E17.m1.2.2.1.1.3.2.3.2.3.2.cmml" xref="S3.E17.m1.2.2.1.1.3.2.3.2.3.2">𝑠</ci><ci id="S3.E17.m1.2.2.1.1.3.2.3.2.3.3.cmml" xref="S3.E17.m1.2.2.1.1.3.2.3.2.3.3">𝑗</ci></apply></apply></apply></apply></apply><apply id="S3.E17.m1.2.2.1.1.1.cmml" xref="S3.E17.m1.2.2.1.1.1"><apply id="S3.E17.m1.2.2.1.1.1.2.cmml" xref="S3.E17.m1.2.2.1.1.1.2"><csymbol cd="ambiguous" id="S3.E17.m1.2.2.1.1.1.2.1.cmml" xref="S3.E17.m1.2.2.1.1.1.2">subscript</csymbol><sum id="S3.E17.m1.2.2.1.1.1.2.2.cmml" xref="S3.E17.m1.2.2.1.1.1.2.2"></sum><ci id="S3.E17.m1.2.2.1.1.1.2.3.cmml" xref="S3.E17.m1.2.2.1.1.1.2.3">𝑗</ci></apply><apply id="S3.E17.m1.2.2.1.1.1.1.1.1.cmml" xref="S3.E17.m1.2.2.1.1.1.1.1"><plus id="S3.E17.m1.2.2.1.1.1.1.1.1.3.cmml" xref="S3.E17.m1.2.2.1.1.1.1.1.1.3"></plus><apply id="S3.E17.m1.2.2.1.1.1.1.1.1.4.cmml" xref="S3.E17.m1.2.2.1.1.1.1.1.1.4"><times id="S3.E17.m1.2.2.1.1.1.1.1.1.4.1.cmml" xref="S3.E17.m1.2.2.1.1.1.1.1.1.4.1"></times><apply id="S3.E17.m1.2.2.1.1.1.1.1.1.4.2.cmml" xref="S3.E17.m1.2.2.1.1.1.1.1.1.4.2"><csymbol cd="ambiguous" id="S3.E17.m1.2.2.1.1.1.1.1.1.4.2.1.cmml" xref="S3.E17.m1.2.2.1.1.1.1.1.1.4.2">subscript</csymbol><ci id="S3.E17.m1.2.2.1.1.1.1.1.1.4.2.2.cmml" xref="S3.E17.m1.2.2.1.1.1.1.1.1.4.2.2">𝝅</ci><apply id="S3.E17.m1.2.2.1.1.1.1.1.1.4.2.3.cmml" xref="S3.E17.m1.2.2.1.1.1.1.1.1.4.2.3"><times id="S3.E17.m1.2.2.1.1.1.1.1.1.4.2.3.1.cmml" xref="S3.E17.m1.2.2.1.1.1.1.1.1.4.2.3.1"></times><ci id="S3.E17.m1.2.2.1.1.1.1.1.1.4.2.3.2.cmml" xref="S3.E17.m1.2.2.1.1.1.1.1.1.4.2.3.2">𝑠</ci><ci id="S3.E17.m1.2.2.1.1.1.1.1.1.4.2.3.3.cmml" xref="S3.E17.m1.2.2.1.1.1.1.1.1.4.2.3.3">𝑗</ci></apply></apply><apply id="S3.E17.m1.2.2.1.1.1.1.1.1.4.3.cmml" xref="S3.E17.m1.2.2.1.1.1.1.1.1.4.3"><log id="S3.E17.m1.2.2.1.1.1.1.1.1.4.3.1.cmml" xref="S3.E17.m1.2.2.1.1.1.1.1.1.4.3.1"></log><apply id="S3.E17.m1.2.2.1.1.1.1.1.1.4.3.2.cmml" xref="S3.E17.m1.2.2.1.1.1.1.1.1.4.3.2"><csymbol cd="ambiguous" id="S3.E17.m1.2.2.1.1.1.1.1.1.4.3.2.1.cmml" xref="S3.E17.m1.2.2.1.1.1.1.1.1.4.3.2">subscript</csymbol><ci id="S3.E17.m1.2.2.1.1.1.1.1.1.4.3.2.2.cmml" xref="S3.E17.m1.2.2.1.1.1.1.1.1.4.3.2.2">𝜽</ci><ci id="S3.E17.m1.2.2.1.1.1.1.1.1.4.3.2.3.cmml" xref="S3.E17.m1.2.2.1.1.1.1.1.1.4.3.2.3">𝑗</ci></apply></apply></apply><apply id="S3.E17.m1.2.2.1.1.1.1.1.1.2.cmml" xref="S3.E17.m1.2.2.1.1.1.1.1.1.2"><times id="S3.E17.m1.2.2.1.1.1.1.1.1.2.3.cmml" xref="S3.E17.m1.2.2.1.1.1.1.1.1.2.3"></times><apply id="S3.E17.m1.2.2.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E17.m1.2.2.1.1.1.1.1.1.1.1.1"><minus id="S3.E17.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E17.m1.2.2.1.1.1.1.1.1.1.1.1.1.1"></minus><cn type="integer" id="S3.E17.m1.2.2.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S3.E17.m1.2.2.1.1.1.1.1.1.1.1.1.1.2">1</cn><apply id="S3.E17.m1.2.2.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="S3.E17.m1.2.2.1.1.1.1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.E17.m1.2.2.1.1.1.1.1.1.1.1.1.1.3.1.cmml" xref="S3.E17.m1.2.2.1.1.1.1.1.1.1.1.1.1.3">subscript</csymbol><ci id="S3.E17.m1.2.2.1.1.1.1.1.1.1.1.1.1.3.2.cmml" xref="S3.E17.m1.2.2.1.1.1.1.1.1.1.1.1.1.3.2">𝝅</ci><apply id="S3.E17.m1.2.2.1.1.1.1.1.1.1.1.1.1.3.3.cmml" xref="S3.E17.m1.2.2.1.1.1.1.1.1.1.1.1.1.3.3"><times id="S3.E17.m1.2.2.1.1.1.1.1.1.1.1.1.1.3.3.1.cmml" xref="S3.E17.m1.2.2.1.1.1.1.1.1.1.1.1.1.3.3.1"></times><ci id="S3.E17.m1.2.2.1.1.1.1.1.1.1.1.1.1.3.3.2.cmml" xref="S3.E17.m1.2.2.1.1.1.1.1.1.1.1.1.1.3.3.2">𝑠</ci><ci id="S3.E17.m1.2.2.1.1.1.1.1.1.1.1.1.1.3.3.3.cmml" xref="S3.E17.m1.2.2.1.1.1.1.1.1.1.1.1.1.3.3.3">𝑗</ci></apply></apply></apply><apply id="S3.E17.m1.2.2.1.1.1.1.1.1.2.2.2.cmml" xref="S3.E17.m1.2.2.1.1.1.1.1.1.2.2.1"><log id="S3.E17.m1.1.1.cmml" xref="S3.E17.m1.1.1"></log><apply id="S3.E17.m1.2.2.1.1.1.1.1.1.2.2.1.1.1.cmml" xref="S3.E17.m1.2.2.1.1.1.1.1.1.2.2.1.1.1"><minus id="S3.E17.m1.2.2.1.1.1.1.1.1.2.2.1.1.1.1.cmml" xref="S3.E17.m1.2.2.1.1.1.1.1.1.2.2.1.1.1.1"></minus><cn type="integer" id="S3.E17.m1.2.2.1.1.1.1.1.1.2.2.1.1.1.2.cmml" xref="S3.E17.m1.2.2.1.1.1.1.1.1.2.2.1.1.1.2">1</cn><apply id="S3.E17.m1.2.2.1.1.1.1.1.1.2.2.1.1.1.3.cmml" xref="S3.E17.m1.2.2.1.1.1.1.1.1.2.2.1.1.1.3"><csymbol cd="ambiguous" id="S3.E17.m1.2.2.1.1.1.1.1.1.2.2.1.1.1.3.1.cmml" xref="S3.E17.m1.2.2.1.1.1.1.1.1.2.2.1.1.1.3">subscript</csymbol><ci id="S3.E17.m1.2.2.1.1.1.1.1.1.2.2.1.1.1.3.2.cmml" xref="S3.E17.m1.2.2.1.1.1.1.1.1.2.2.1.1.1.3.2">𝜽</ci><ci id="S3.E17.m1.2.2.1.1.1.1.1.1.2.2.1.1.1.3.3.cmml" xref="S3.E17.m1.2.2.1.1.1.1.1.1.2.2.1.1.1.3.3">𝑗</ci></apply></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E17.m1.2c">\displaystyle\quad-\lambda_{0}\sum_{j}\bm{\pi}_{sj}+\sum_{j}\left(\bm{\pi}_{sj}\log\bm{\theta}_{j}+(1-\bm{\pi}_{sj})\log(1-\bm{\theta}_{j})\right),</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(17)</span></td>
</tr></tbody>
<tbody id="S3.E18"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math id="S3.E18.m1.1" class="ltx_Math" alttext="\displaystyle\mathcal{L}" display="inline"><semantics id="S3.E18.m1.1a"><mi class="ltx_font_mathcaligraphic" id="S3.E18.m1.1.1" xref="S3.E18.m1.1.1.cmml">ℒ</mi><annotation-xml encoding="MathML-Content" id="S3.E18.m1.1b"><ci id="S3.E18.m1.1.1.cmml" xref="S3.E18.m1.1.1">ℒ</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.E18.m1.1c">\displaystyle\mathcal{L}</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math id="S3.E18.m2.5" class="ltx_Math" alttext="\displaystyle:=\sum_{s=1}^{S}\mathcal{L}_{s}(\mathcal{D}_{s},\mathbf{w},\bm{\theta},\mathbf{w}_{s},\bm{\pi}_{s})" display="inline"><semantics id="S3.E18.m2.5a"><mrow id="S3.E18.m2.5.5" xref="S3.E18.m2.5.5.cmml"><mi id="S3.E18.m2.5.5.5" xref="S3.E18.m2.5.5.5.cmml"></mi><mo lspace="0.278em" rspace="0.278em" id="S3.E18.m2.5.5.4" xref="S3.E18.m2.5.5.4.cmml">:=</mo><mrow id="S3.E18.m2.5.5.3" xref="S3.E18.m2.5.5.3.cmml"><mstyle displaystyle="true" id="S3.E18.m2.5.5.3.4" xref="S3.E18.m2.5.5.3.4.cmml"><munderover id="S3.E18.m2.5.5.3.4a" xref="S3.E18.m2.5.5.3.4.cmml"><mo movablelimits="false" id="S3.E18.m2.5.5.3.4.2.2" xref="S3.E18.m2.5.5.3.4.2.2.cmml">∑</mo><mrow id="S3.E18.m2.5.5.3.4.2.3" xref="S3.E18.m2.5.5.3.4.2.3.cmml"><mi id="S3.E18.m2.5.5.3.4.2.3.2" xref="S3.E18.m2.5.5.3.4.2.3.2.cmml">s</mi><mo id="S3.E18.m2.5.5.3.4.2.3.1" xref="S3.E18.m2.5.5.3.4.2.3.1.cmml">=</mo><mn id="S3.E18.m2.5.5.3.4.2.3.3" xref="S3.E18.m2.5.5.3.4.2.3.3.cmml">1</mn></mrow><mi id="S3.E18.m2.5.5.3.4.3" xref="S3.E18.m2.5.5.3.4.3.cmml">S</mi></munderover></mstyle><mrow id="S3.E18.m2.5.5.3.3" xref="S3.E18.m2.5.5.3.3.cmml"><msub id="S3.E18.m2.5.5.3.3.5" xref="S3.E18.m2.5.5.3.3.5.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.E18.m2.5.5.3.3.5.2" xref="S3.E18.m2.5.5.3.3.5.2.cmml">ℒ</mi><mi id="S3.E18.m2.5.5.3.3.5.3" xref="S3.E18.m2.5.5.3.3.5.3.cmml">s</mi></msub><mo lspace="0em" rspace="0em" id="S3.E18.m2.5.5.3.3.4" xref="S3.E18.m2.5.5.3.3.4.cmml">​</mo><mrow id="S3.E18.m2.5.5.3.3.3.3" xref="S3.E18.m2.5.5.3.3.3.4.cmml"><mo stretchy="false" id="S3.E18.m2.5.5.3.3.3.3.4" xref="S3.E18.m2.5.5.3.3.3.4.cmml">(</mo><msub id="S3.E18.m2.3.3.1.1.1.1.1" xref="S3.E18.m2.3.3.1.1.1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.E18.m2.3.3.1.1.1.1.1.2" xref="S3.E18.m2.3.3.1.1.1.1.1.2.cmml">𝒟</mi><mi id="S3.E18.m2.3.3.1.1.1.1.1.3" xref="S3.E18.m2.3.3.1.1.1.1.1.3.cmml">s</mi></msub><mo id="S3.E18.m2.5.5.3.3.3.3.5" xref="S3.E18.m2.5.5.3.3.3.4.cmml">,</mo><mi id="S3.E18.m2.1.1" xref="S3.E18.m2.1.1.cmml">𝐰</mi><mo id="S3.E18.m2.5.5.3.3.3.3.6" xref="S3.E18.m2.5.5.3.3.3.4.cmml">,</mo><mi id="S3.E18.m2.2.2" xref="S3.E18.m2.2.2.cmml">𝜽</mi><mo id="S3.E18.m2.5.5.3.3.3.3.7" xref="S3.E18.m2.5.5.3.3.3.4.cmml">,</mo><msub id="S3.E18.m2.4.4.2.2.2.2.2" xref="S3.E18.m2.4.4.2.2.2.2.2.cmml"><mi id="S3.E18.m2.4.4.2.2.2.2.2.2" xref="S3.E18.m2.4.4.2.2.2.2.2.2.cmml">𝐰</mi><mi id="S3.E18.m2.4.4.2.2.2.2.2.3" xref="S3.E18.m2.4.4.2.2.2.2.2.3.cmml">s</mi></msub><mo id="S3.E18.m2.5.5.3.3.3.3.8" xref="S3.E18.m2.5.5.3.3.3.4.cmml">,</mo><msub id="S3.E18.m2.5.5.3.3.3.3.3" xref="S3.E18.m2.5.5.3.3.3.3.3.cmml"><mi id="S3.E18.m2.5.5.3.3.3.3.3.2" xref="S3.E18.m2.5.5.3.3.3.3.3.2.cmml">𝝅</mi><mi id="S3.E18.m2.5.5.3.3.3.3.3.3" xref="S3.E18.m2.5.5.3.3.3.3.3.3.cmml">s</mi></msub><mo stretchy="false" id="S3.E18.m2.5.5.3.3.3.3.9" xref="S3.E18.m2.5.5.3.3.3.4.cmml">)</mo></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.E18.m2.5b"><apply id="S3.E18.m2.5.5.cmml" xref="S3.E18.m2.5.5"><csymbol cd="latexml" id="S3.E18.m2.5.5.4.cmml" xref="S3.E18.m2.5.5.4">assign</csymbol><csymbol cd="latexml" id="S3.E18.m2.5.5.5.cmml" xref="S3.E18.m2.5.5.5">absent</csymbol><apply id="S3.E18.m2.5.5.3.cmml" xref="S3.E18.m2.5.5.3"><apply id="S3.E18.m2.5.5.3.4.cmml" xref="S3.E18.m2.5.5.3.4"><csymbol cd="ambiguous" id="S3.E18.m2.5.5.3.4.1.cmml" xref="S3.E18.m2.5.5.3.4">superscript</csymbol><apply id="S3.E18.m2.5.5.3.4.2.cmml" xref="S3.E18.m2.5.5.3.4"><csymbol cd="ambiguous" id="S3.E18.m2.5.5.3.4.2.1.cmml" xref="S3.E18.m2.5.5.3.4">subscript</csymbol><sum id="S3.E18.m2.5.5.3.4.2.2.cmml" xref="S3.E18.m2.5.5.3.4.2.2"></sum><apply id="S3.E18.m2.5.5.3.4.2.3.cmml" xref="S3.E18.m2.5.5.3.4.2.3"><eq id="S3.E18.m2.5.5.3.4.2.3.1.cmml" xref="S3.E18.m2.5.5.3.4.2.3.1"></eq><ci id="S3.E18.m2.5.5.3.4.2.3.2.cmml" xref="S3.E18.m2.5.5.3.4.2.3.2">𝑠</ci><cn type="integer" id="S3.E18.m2.5.5.3.4.2.3.3.cmml" xref="S3.E18.m2.5.5.3.4.2.3.3">1</cn></apply></apply><ci id="S3.E18.m2.5.5.3.4.3.cmml" xref="S3.E18.m2.5.5.3.4.3">𝑆</ci></apply><apply id="S3.E18.m2.5.5.3.3.cmml" xref="S3.E18.m2.5.5.3.3"><times id="S3.E18.m2.5.5.3.3.4.cmml" xref="S3.E18.m2.5.5.3.3.4"></times><apply id="S3.E18.m2.5.5.3.3.5.cmml" xref="S3.E18.m2.5.5.3.3.5"><csymbol cd="ambiguous" id="S3.E18.m2.5.5.3.3.5.1.cmml" xref="S3.E18.m2.5.5.3.3.5">subscript</csymbol><ci id="S3.E18.m2.5.5.3.3.5.2.cmml" xref="S3.E18.m2.5.5.3.3.5.2">ℒ</ci><ci id="S3.E18.m2.5.5.3.3.5.3.cmml" xref="S3.E18.m2.5.5.3.3.5.3">𝑠</ci></apply><vector id="S3.E18.m2.5.5.3.3.3.4.cmml" xref="S3.E18.m2.5.5.3.3.3.3"><apply id="S3.E18.m2.3.3.1.1.1.1.1.cmml" xref="S3.E18.m2.3.3.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E18.m2.3.3.1.1.1.1.1.1.cmml" xref="S3.E18.m2.3.3.1.1.1.1.1">subscript</csymbol><ci id="S3.E18.m2.3.3.1.1.1.1.1.2.cmml" xref="S3.E18.m2.3.3.1.1.1.1.1.2">𝒟</ci><ci id="S3.E18.m2.3.3.1.1.1.1.1.3.cmml" xref="S3.E18.m2.3.3.1.1.1.1.1.3">𝑠</ci></apply><ci id="S3.E18.m2.1.1.cmml" xref="S3.E18.m2.1.1">𝐰</ci><ci id="S3.E18.m2.2.2.cmml" xref="S3.E18.m2.2.2">𝜽</ci><apply id="S3.E18.m2.4.4.2.2.2.2.2.cmml" xref="S3.E18.m2.4.4.2.2.2.2.2"><csymbol cd="ambiguous" id="S3.E18.m2.4.4.2.2.2.2.2.1.cmml" xref="S3.E18.m2.4.4.2.2.2.2.2">subscript</csymbol><ci id="S3.E18.m2.4.4.2.2.2.2.2.2.cmml" xref="S3.E18.m2.4.4.2.2.2.2.2.2">𝐰</ci><ci id="S3.E18.m2.4.4.2.2.2.2.2.3.cmml" xref="S3.E18.m2.4.4.2.2.2.2.2.3">𝑠</ci></apply><apply id="S3.E18.m2.5.5.3.3.3.3.3.cmml" xref="S3.E18.m2.5.5.3.3.3.3.3"><csymbol cd="ambiguous" id="S3.E18.m2.5.5.3.3.3.3.3.1.cmml" xref="S3.E18.m2.5.5.3.3.3.3.3">subscript</csymbol><ci id="S3.E18.m2.5.5.3.3.3.3.3.2.cmml" xref="S3.E18.m2.5.5.3.3.3.3.3.2">𝝅</ci><ci id="S3.E18.m2.5.5.3.3.3.3.3.3.cmml" xref="S3.E18.m2.5.5.3.3.3.3.3.3">𝑠</ci></apply></vector></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E18.m2.5c">\displaystyle:=\sum_{s=1}^{S}\mathcal{L}_{s}(\mathcal{D}_{s},\mathbf{w},\bm{\theta},\mathbf{w}_{s},\bm{\pi}_{s})</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(18)</span></td>
</tr></tbody>
</table>
<p id="S3.p2.19" class="ltx_p">respectively, where <math id="S3.p2.14.m1.1" class="ltx_Math" alttext="\lambda_{0}=\frac{1}{2}\log\frac{\lambda_{2}}{\lambda}" display="inline"><semantics id="S3.p2.14.m1.1a"><mrow id="S3.p2.14.m1.1.1" xref="S3.p2.14.m1.1.1.cmml"><msub id="S3.p2.14.m1.1.1.2" xref="S3.p2.14.m1.1.1.2.cmml"><mi id="S3.p2.14.m1.1.1.2.2" xref="S3.p2.14.m1.1.1.2.2.cmml">λ</mi><mn id="S3.p2.14.m1.1.1.2.3" xref="S3.p2.14.m1.1.1.2.3.cmml">0</mn></msub><mo id="S3.p2.14.m1.1.1.1" xref="S3.p2.14.m1.1.1.1.cmml">=</mo><mrow id="S3.p2.14.m1.1.1.3" xref="S3.p2.14.m1.1.1.3.cmml"><mfrac id="S3.p2.14.m1.1.1.3.2" xref="S3.p2.14.m1.1.1.3.2.cmml"><mn id="S3.p2.14.m1.1.1.3.2.2" xref="S3.p2.14.m1.1.1.3.2.2.cmml">1</mn><mn id="S3.p2.14.m1.1.1.3.2.3" xref="S3.p2.14.m1.1.1.3.2.3.cmml">2</mn></mfrac><mo lspace="0.167em" rspace="0em" id="S3.p2.14.m1.1.1.3.1" xref="S3.p2.14.m1.1.1.3.1.cmml">​</mo><mrow id="S3.p2.14.m1.1.1.3.3" xref="S3.p2.14.m1.1.1.3.3.cmml"><mi id="S3.p2.14.m1.1.1.3.3.1" xref="S3.p2.14.m1.1.1.3.3.1.cmml">log</mi><mo lspace="0.167em" id="S3.p2.14.m1.1.1.3.3a" xref="S3.p2.14.m1.1.1.3.3.cmml">⁡</mo><mfrac id="S3.p2.14.m1.1.1.3.3.2" xref="S3.p2.14.m1.1.1.3.3.2.cmml"><msub id="S3.p2.14.m1.1.1.3.3.2.2" xref="S3.p2.14.m1.1.1.3.3.2.2.cmml"><mi id="S3.p2.14.m1.1.1.3.3.2.2.2" xref="S3.p2.14.m1.1.1.3.3.2.2.2.cmml">λ</mi><mn id="S3.p2.14.m1.1.1.3.3.2.2.3" xref="S3.p2.14.m1.1.1.3.3.2.2.3.cmml">2</mn></msub><mi id="S3.p2.14.m1.1.1.3.3.2.3" xref="S3.p2.14.m1.1.1.3.3.2.3.cmml">λ</mi></mfrac></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.p2.14.m1.1b"><apply id="S3.p2.14.m1.1.1.cmml" xref="S3.p2.14.m1.1.1"><eq id="S3.p2.14.m1.1.1.1.cmml" xref="S3.p2.14.m1.1.1.1"></eq><apply id="S3.p2.14.m1.1.1.2.cmml" xref="S3.p2.14.m1.1.1.2"><csymbol cd="ambiguous" id="S3.p2.14.m1.1.1.2.1.cmml" xref="S3.p2.14.m1.1.1.2">subscript</csymbol><ci id="S3.p2.14.m1.1.1.2.2.cmml" xref="S3.p2.14.m1.1.1.2.2">𝜆</ci><cn type="integer" id="S3.p2.14.m1.1.1.2.3.cmml" xref="S3.p2.14.m1.1.1.2.3">0</cn></apply><apply id="S3.p2.14.m1.1.1.3.cmml" xref="S3.p2.14.m1.1.1.3"><times id="S3.p2.14.m1.1.1.3.1.cmml" xref="S3.p2.14.m1.1.1.3.1"></times><apply id="S3.p2.14.m1.1.1.3.2.cmml" xref="S3.p2.14.m1.1.1.3.2"><divide id="S3.p2.14.m1.1.1.3.2.1.cmml" xref="S3.p2.14.m1.1.1.3.2"></divide><cn type="integer" id="S3.p2.14.m1.1.1.3.2.2.cmml" xref="S3.p2.14.m1.1.1.3.2.2">1</cn><cn type="integer" id="S3.p2.14.m1.1.1.3.2.3.cmml" xref="S3.p2.14.m1.1.1.3.2.3">2</cn></apply><apply id="S3.p2.14.m1.1.1.3.3.cmml" xref="S3.p2.14.m1.1.1.3.3"><log id="S3.p2.14.m1.1.1.3.3.1.cmml" xref="S3.p2.14.m1.1.1.3.3.1"></log><apply id="S3.p2.14.m1.1.1.3.3.2.cmml" xref="S3.p2.14.m1.1.1.3.3.2"><divide id="S3.p2.14.m1.1.1.3.3.2.1.cmml" xref="S3.p2.14.m1.1.1.3.3.2"></divide><apply id="S3.p2.14.m1.1.1.3.3.2.2.cmml" xref="S3.p2.14.m1.1.1.3.3.2.2"><csymbol cd="ambiguous" id="S3.p2.14.m1.1.1.3.3.2.2.1.cmml" xref="S3.p2.14.m1.1.1.3.3.2.2">subscript</csymbol><ci id="S3.p2.14.m1.1.1.3.3.2.2.2.cmml" xref="S3.p2.14.m1.1.1.3.3.2.2.2">𝜆</ci><cn type="integer" id="S3.p2.14.m1.1.1.3.3.2.2.3.cmml" xref="S3.p2.14.m1.1.1.3.3.2.2.3">2</cn></apply><ci id="S3.p2.14.m1.1.1.3.3.2.3.cmml" xref="S3.p2.14.m1.1.1.3.3.2.3">𝜆</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p2.14.m1.1c">\lambda_{0}=\frac{1}{2}\log\frac{\lambda_{2}}{\lambda}</annotation></semantics></math> and <math id="S3.p2.15.m2.1" class="ltx_Math" alttext="C" display="inline"><semantics id="S3.p2.15.m2.1a"><mi id="S3.p2.15.m2.1.1" xref="S3.p2.15.m2.1.1.cmml">C</mi><annotation-xml encoding="MathML-Content" id="S3.p2.15.m2.1b"><ci id="S3.p2.15.m2.1.1.cmml" xref="S3.p2.15.m2.1.1">𝐶</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.p2.15.m2.1c">C</annotation></semantics></math> is a constant independent of the variables to be optimized. The derivation can be found in Appendix <a href="#A7" title="Appendix G Derivation of the local loss for FedSparse ‣ An Expectation-Maximization Perspective on Federated Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">G</span></a>. It is interesting to see that the final objective at each shard intuitively tries to find a trade-off between four things: 1) explaining the local dataset <math id="S3.p2.16.m3.1" class="ltx_Math" alttext="\mathcal{D}_{s}" display="inline"><semantics id="S3.p2.16.m3.1a"><msub id="S3.p2.16.m3.1.1" xref="S3.p2.16.m3.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.p2.16.m3.1.1.2" xref="S3.p2.16.m3.1.1.2.cmml">𝒟</mi><mi id="S3.p2.16.m3.1.1.3" xref="S3.p2.16.m3.1.1.3.cmml">s</mi></msub><annotation-xml encoding="MathML-Content" id="S3.p2.16.m3.1b"><apply id="S3.p2.16.m3.1.1.cmml" xref="S3.p2.16.m3.1.1"><csymbol cd="ambiguous" id="S3.p2.16.m3.1.1.1.cmml" xref="S3.p2.16.m3.1.1">subscript</csymbol><ci id="S3.p2.16.m3.1.1.2.cmml" xref="S3.p2.16.m3.1.1.2">𝒟</ci><ci id="S3.p2.16.m3.1.1.3.cmml" xref="S3.p2.16.m3.1.1.3">𝑠</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p2.16.m3.1c">\mathcal{D}_{s}</annotation></semantics></math>, 2) having the local weights close to the server weights (regulated by <math id="S3.p2.17.m4.1" class="ltx_Math" alttext="\lambda" display="inline"><semantics id="S3.p2.17.m4.1a"><mi id="S3.p2.17.m4.1.1" xref="S3.p2.17.m4.1.1.cmml">λ</mi><annotation-xml encoding="MathML-Content" id="S3.p2.17.m4.1b"><ci id="S3.p2.17.m4.1.1.cmml" xref="S3.p2.17.m4.1.1">𝜆</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.p2.17.m4.1c">\lambda</annotation></semantics></math>), 3) having the local gate probabilities close to the server probabilities and 4) reducing the local gate activation probabilities to prune away a parameter (regulated by <math id="S3.p2.18.m5.1" class="ltx_Math" alttext="\lambda_{0}" display="inline"><semantics id="S3.p2.18.m5.1a"><msub id="S3.p2.18.m5.1.1" xref="S3.p2.18.m5.1.1.cmml"><mi id="S3.p2.18.m5.1.1.2" xref="S3.p2.18.m5.1.1.2.cmml">λ</mi><mn id="S3.p2.18.m5.1.1.3" xref="S3.p2.18.m5.1.1.3.cmml">0</mn></msub><annotation-xml encoding="MathML-Content" id="S3.p2.18.m5.1b"><apply id="S3.p2.18.m5.1.1.cmml" xref="S3.p2.18.m5.1.1"><csymbol cd="ambiguous" id="S3.p2.18.m5.1.1.1.cmml" xref="S3.p2.18.m5.1.1">subscript</csymbol><ci id="S3.p2.18.m5.1.1.2.cmml" xref="S3.p2.18.m5.1.1.2">𝜆</ci><cn type="integer" id="S3.p2.18.m5.1.1.3.cmml" xref="S3.p2.18.m5.1.1.3">0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p2.18.m5.1c">\lambda_{0}</annotation></semantics></math>). The latter is an <math id="S3.p2.19.m6.1" class="ltx_Math" alttext="L_{0}" display="inline"><semantics id="S3.p2.19.m6.1a"><msub id="S3.p2.19.m6.1.1" xref="S3.p2.19.m6.1.1.cmml"><mi id="S3.p2.19.m6.1.1.2" xref="S3.p2.19.m6.1.1.2.cmml">L</mi><mn id="S3.p2.19.m6.1.1.3" xref="S3.p2.19.m6.1.1.3.cmml">0</mn></msub><annotation-xml encoding="MathML-Content" id="S3.p2.19.m6.1b"><apply id="S3.p2.19.m6.1.1.cmml" xref="S3.p2.19.m6.1.1"><csymbol cd="ambiguous" id="S3.p2.19.m6.1.1.1.cmml" xref="S3.p2.19.m6.1.1">subscript</csymbol><ci id="S3.p2.19.m6.1.1.2.cmml" xref="S3.p2.19.m6.1.1.2">𝐿</ci><cn type="integer" id="S3.p2.19.m6.1.1.3.cmml" xref="S3.p2.19.m6.1.1.3">0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p2.19.m6.1c">L_{0}</annotation></semantics></math> regularization term, akin to the one proposed by <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib21" title="" class="ltx_ref">21</a>]</cite>.</p>
</div>
<div id="S3.p3" class="ltx_para">
<p id="S3.p3.3" class="ltx_p">Now let us consider what happens at the server after the local shard, through some procedure, optimized <math id="S3.p3.1.m1.1" class="ltx_Math" alttext="\mathbf{w}_{s}" display="inline"><semantics id="S3.p3.1.m1.1a"><msub id="S3.p3.1.m1.1.1" xref="S3.p3.1.m1.1.1.cmml"><mi id="S3.p3.1.m1.1.1.2" xref="S3.p3.1.m1.1.1.2.cmml">𝐰</mi><mi id="S3.p3.1.m1.1.1.3" xref="S3.p3.1.m1.1.1.3.cmml">s</mi></msub><annotation-xml encoding="MathML-Content" id="S3.p3.1.m1.1b"><apply id="S3.p3.1.m1.1.1.cmml" xref="S3.p3.1.m1.1.1"><csymbol cd="ambiguous" id="S3.p3.1.m1.1.1.1.cmml" xref="S3.p3.1.m1.1.1">subscript</csymbol><ci id="S3.p3.1.m1.1.1.2.cmml" xref="S3.p3.1.m1.1.1.2">𝐰</ci><ci id="S3.p3.1.m1.1.1.3.cmml" xref="S3.p3.1.m1.1.1.3">𝑠</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p3.1.m1.1c">\mathbf{w}_{s}</annotation></semantics></math> and <math id="S3.p3.2.m2.1" class="ltx_Math" alttext="\bm{\pi}_{s}" display="inline"><semantics id="S3.p3.2.m2.1a"><msub id="S3.p3.2.m2.1.1" xref="S3.p3.2.m2.1.1.cmml"><mi id="S3.p3.2.m2.1.1.2" xref="S3.p3.2.m2.1.1.2.cmml">𝝅</mi><mi id="S3.p3.2.m2.1.1.3" xref="S3.p3.2.m2.1.1.3.cmml">s</mi></msub><annotation-xml encoding="MathML-Content" id="S3.p3.2.m2.1b"><apply id="S3.p3.2.m2.1.1.cmml" xref="S3.p3.2.m2.1.1"><csymbol cd="ambiguous" id="S3.p3.2.m2.1.1.1.cmml" xref="S3.p3.2.m2.1.1">subscript</csymbol><ci id="S3.p3.2.m2.1.1.2.cmml" xref="S3.p3.2.m2.1.1.2">𝝅</ci><ci id="S3.p3.2.m2.1.1.3.cmml" xref="S3.p3.2.m2.1.1.3">𝑠</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p3.2.m2.1c">\bm{\pi}_{s}</annotation></semantics></math>. Since the server loss for <math id="S3.p3.3.m3.2" class="ltx_Math" alttext="\mathbf{w},\bm{\theta}" display="inline"><semantics id="S3.p3.3.m3.2a"><mrow id="S3.p3.3.m3.2.3.2" xref="S3.p3.3.m3.2.3.1.cmml"><mi id="S3.p3.3.m3.1.1" xref="S3.p3.3.m3.1.1.cmml">𝐰</mi><mo id="S3.p3.3.m3.2.3.2.1" xref="S3.p3.3.m3.2.3.1.cmml">,</mo><mi id="S3.p3.3.m3.2.2" xref="S3.p3.3.m3.2.2.cmml">𝜽</mi></mrow><annotation-xml encoding="MathML-Content" id="S3.p3.3.m3.2b"><list id="S3.p3.3.m3.2.3.1.cmml" xref="S3.p3.3.m3.2.3.2"><ci id="S3.p3.3.m3.1.1.cmml" xref="S3.p3.3.m3.1.1">𝐰</ci><ci id="S3.p3.3.m3.2.2.cmml" xref="S3.p3.3.m3.2.2">𝜽</ci></list></annotation-xml><annotation encoding="application/x-tex" id="S3.p3.3.m3.2c">\mathbf{w},\bm{\theta}</annotation></semantics></math> is the sum of all local losses, the gradient for each of the parameters will be</p>
<table id="A10.EGx17" class="ltx_equationgroup ltx_eqn_align ltx_eqn_table">

<tbody id="S3.E19"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math id="S3.E19.m1.1" class="ltx_Math" alttext="\displaystyle\frac{\partial\mathcal{L}}{\partial\mathbf{w}}=\sum_{s}\lambda\bm{\pi}_{s}(\mathbf{w}_{s}-\mathbf{w}),\enskip\frac{\partial\mathcal{L}}{\partial\bm{\theta}}=\sum_{s}\left(\frac{\bm{\pi}_{s}}{\bm{\theta}}-\frac{1-\bm{\pi}_{s}}{1-\bm{\theta}}\right)." display="inline"><semantics id="S3.E19.m1.1a"><mrow id="S3.E19.m1.1.1.1"><mrow id="S3.E19.m1.1.1.1.1.2" xref="S3.E19.m1.1.1.1.1.3.cmml"><mrow id="S3.E19.m1.1.1.1.1.1.1" xref="S3.E19.m1.1.1.1.1.1.1.cmml"><mstyle displaystyle="true" id="S3.E19.m1.1.1.1.1.1.1.3" xref="S3.E19.m1.1.1.1.1.1.1.3.cmml"><mfrac id="S3.E19.m1.1.1.1.1.1.1.3a" xref="S3.E19.m1.1.1.1.1.1.1.3.cmml"><mrow id="S3.E19.m1.1.1.1.1.1.1.3.2" xref="S3.E19.m1.1.1.1.1.1.1.3.2.cmml"><mo rspace="0em" id="S3.E19.m1.1.1.1.1.1.1.3.2.1" xref="S3.E19.m1.1.1.1.1.1.1.3.2.1.cmml">∂</mo><mi class="ltx_font_mathcaligraphic" id="S3.E19.m1.1.1.1.1.1.1.3.2.2" xref="S3.E19.m1.1.1.1.1.1.1.3.2.2.cmml">ℒ</mi></mrow><mrow id="S3.E19.m1.1.1.1.1.1.1.3.3" xref="S3.E19.m1.1.1.1.1.1.1.3.3.cmml"><mo rspace="0em" id="S3.E19.m1.1.1.1.1.1.1.3.3.1" xref="S3.E19.m1.1.1.1.1.1.1.3.3.1.cmml">∂</mo><mi id="S3.E19.m1.1.1.1.1.1.1.3.3.2" xref="S3.E19.m1.1.1.1.1.1.1.3.3.2.cmml">𝐰</mi></mrow></mfrac></mstyle><mo id="S3.E19.m1.1.1.1.1.1.1.2" xref="S3.E19.m1.1.1.1.1.1.1.2.cmml">=</mo><mrow id="S3.E19.m1.1.1.1.1.1.1.1" xref="S3.E19.m1.1.1.1.1.1.1.1.cmml"><mstyle displaystyle="true" id="S3.E19.m1.1.1.1.1.1.1.1.2" xref="S3.E19.m1.1.1.1.1.1.1.1.2.cmml"><munder id="S3.E19.m1.1.1.1.1.1.1.1.2a" xref="S3.E19.m1.1.1.1.1.1.1.1.2.cmml"><mo movablelimits="false" id="S3.E19.m1.1.1.1.1.1.1.1.2.2" xref="S3.E19.m1.1.1.1.1.1.1.1.2.2.cmml">∑</mo><mi id="S3.E19.m1.1.1.1.1.1.1.1.2.3" xref="S3.E19.m1.1.1.1.1.1.1.1.2.3.cmml">s</mi></munder></mstyle><mrow id="S3.E19.m1.1.1.1.1.1.1.1.1" xref="S3.E19.m1.1.1.1.1.1.1.1.1.cmml"><mi id="S3.E19.m1.1.1.1.1.1.1.1.1.3" xref="S3.E19.m1.1.1.1.1.1.1.1.1.3.cmml">λ</mi><mo lspace="0em" rspace="0em" id="S3.E19.m1.1.1.1.1.1.1.1.1.2" xref="S3.E19.m1.1.1.1.1.1.1.1.1.2.cmml">​</mo><msub id="S3.E19.m1.1.1.1.1.1.1.1.1.4" xref="S3.E19.m1.1.1.1.1.1.1.1.1.4.cmml"><mi id="S3.E19.m1.1.1.1.1.1.1.1.1.4.2" xref="S3.E19.m1.1.1.1.1.1.1.1.1.4.2.cmml">𝝅</mi><mi id="S3.E19.m1.1.1.1.1.1.1.1.1.4.3" xref="S3.E19.m1.1.1.1.1.1.1.1.1.4.3.cmml">s</mi></msub><mo lspace="0em" rspace="0em" id="S3.E19.m1.1.1.1.1.1.1.1.1.2a" xref="S3.E19.m1.1.1.1.1.1.1.1.1.2.cmml">​</mo><mrow id="S3.E19.m1.1.1.1.1.1.1.1.1.1.1" xref="S3.E19.m1.1.1.1.1.1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S3.E19.m1.1.1.1.1.1.1.1.1.1.1.2" xref="S3.E19.m1.1.1.1.1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="S3.E19.m1.1.1.1.1.1.1.1.1.1.1.1" xref="S3.E19.m1.1.1.1.1.1.1.1.1.1.1.1.cmml"><msub id="S3.E19.m1.1.1.1.1.1.1.1.1.1.1.1.2" xref="S3.E19.m1.1.1.1.1.1.1.1.1.1.1.1.2.cmml"><mi id="S3.E19.m1.1.1.1.1.1.1.1.1.1.1.1.2.2" xref="S3.E19.m1.1.1.1.1.1.1.1.1.1.1.1.2.2.cmml">𝐰</mi><mi id="S3.E19.m1.1.1.1.1.1.1.1.1.1.1.1.2.3" xref="S3.E19.m1.1.1.1.1.1.1.1.1.1.1.1.2.3.cmml">s</mi></msub><mo id="S3.E19.m1.1.1.1.1.1.1.1.1.1.1.1.1" xref="S3.E19.m1.1.1.1.1.1.1.1.1.1.1.1.1.cmml">−</mo><mi id="S3.E19.m1.1.1.1.1.1.1.1.1.1.1.1.3" xref="S3.E19.m1.1.1.1.1.1.1.1.1.1.1.1.3.cmml">𝐰</mi></mrow><mo stretchy="false" id="S3.E19.m1.1.1.1.1.1.1.1.1.1.1.3" xref="S3.E19.m1.1.1.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow></mrow><mo rspace="0.667em" id="S3.E19.m1.1.1.1.1.2.3" xref="S3.E19.m1.1.1.1.1.3a.cmml">,</mo><mrow id="S3.E19.m1.1.1.1.1.2.2" xref="S3.E19.m1.1.1.1.1.2.2.cmml"><mstyle displaystyle="true" id="S3.E19.m1.1.1.1.1.2.2.3" xref="S3.E19.m1.1.1.1.1.2.2.3.cmml"><mfrac id="S3.E19.m1.1.1.1.1.2.2.3a" xref="S3.E19.m1.1.1.1.1.2.2.3.cmml"><mrow id="S3.E19.m1.1.1.1.1.2.2.3.2" xref="S3.E19.m1.1.1.1.1.2.2.3.2.cmml"><mo rspace="0em" id="S3.E19.m1.1.1.1.1.2.2.3.2.1" xref="S3.E19.m1.1.1.1.1.2.2.3.2.1.cmml">∂</mo><mi class="ltx_font_mathcaligraphic" id="S3.E19.m1.1.1.1.1.2.2.3.2.2" xref="S3.E19.m1.1.1.1.1.2.2.3.2.2.cmml">ℒ</mi></mrow><mrow id="S3.E19.m1.1.1.1.1.2.2.3.3" xref="S3.E19.m1.1.1.1.1.2.2.3.3.cmml"><mo rspace="0em" id="S3.E19.m1.1.1.1.1.2.2.3.3.1" xref="S3.E19.m1.1.1.1.1.2.2.3.3.1.cmml">∂</mo><mi id="S3.E19.m1.1.1.1.1.2.2.3.3.2" xref="S3.E19.m1.1.1.1.1.2.2.3.3.2.cmml">𝜽</mi></mrow></mfrac></mstyle><mo id="S3.E19.m1.1.1.1.1.2.2.2" xref="S3.E19.m1.1.1.1.1.2.2.2.cmml">=</mo><mrow id="S3.E19.m1.1.1.1.1.2.2.1" xref="S3.E19.m1.1.1.1.1.2.2.1.cmml"><mstyle displaystyle="true" id="S3.E19.m1.1.1.1.1.2.2.1.2" xref="S3.E19.m1.1.1.1.1.2.2.1.2.cmml"><munder id="S3.E19.m1.1.1.1.1.2.2.1.2a" xref="S3.E19.m1.1.1.1.1.2.2.1.2.cmml"><mo movablelimits="false" id="S3.E19.m1.1.1.1.1.2.2.1.2.2" xref="S3.E19.m1.1.1.1.1.2.2.1.2.2.cmml">∑</mo><mi id="S3.E19.m1.1.1.1.1.2.2.1.2.3" xref="S3.E19.m1.1.1.1.1.2.2.1.2.3.cmml">s</mi></munder></mstyle><mrow id="S3.E19.m1.1.1.1.1.2.2.1.1.1" xref="S3.E19.m1.1.1.1.1.2.2.1.1.1.1.cmml"><mo id="S3.E19.m1.1.1.1.1.2.2.1.1.1.2" xref="S3.E19.m1.1.1.1.1.2.2.1.1.1.1.cmml">(</mo><mrow id="S3.E19.m1.1.1.1.1.2.2.1.1.1.1" xref="S3.E19.m1.1.1.1.1.2.2.1.1.1.1.cmml"><mstyle displaystyle="true" id="S3.E19.m1.1.1.1.1.2.2.1.1.1.1.2" xref="S3.E19.m1.1.1.1.1.2.2.1.1.1.1.2.cmml"><mfrac id="S3.E19.m1.1.1.1.1.2.2.1.1.1.1.2a" xref="S3.E19.m1.1.1.1.1.2.2.1.1.1.1.2.cmml"><msub id="S3.E19.m1.1.1.1.1.2.2.1.1.1.1.2.2" xref="S3.E19.m1.1.1.1.1.2.2.1.1.1.1.2.2.cmml"><mi id="S3.E19.m1.1.1.1.1.2.2.1.1.1.1.2.2.2" xref="S3.E19.m1.1.1.1.1.2.2.1.1.1.1.2.2.2.cmml">𝝅</mi><mi id="S3.E19.m1.1.1.1.1.2.2.1.1.1.1.2.2.3" xref="S3.E19.m1.1.1.1.1.2.2.1.1.1.1.2.2.3.cmml">s</mi></msub><mi id="S3.E19.m1.1.1.1.1.2.2.1.1.1.1.2.3" xref="S3.E19.m1.1.1.1.1.2.2.1.1.1.1.2.3.cmml">𝜽</mi></mfrac></mstyle><mo id="S3.E19.m1.1.1.1.1.2.2.1.1.1.1.1" xref="S3.E19.m1.1.1.1.1.2.2.1.1.1.1.1.cmml">−</mo><mstyle displaystyle="true" id="S3.E19.m1.1.1.1.1.2.2.1.1.1.1.3" xref="S3.E19.m1.1.1.1.1.2.2.1.1.1.1.3.cmml"><mfrac id="S3.E19.m1.1.1.1.1.2.2.1.1.1.1.3a" xref="S3.E19.m1.1.1.1.1.2.2.1.1.1.1.3.cmml"><mrow id="S3.E19.m1.1.1.1.1.2.2.1.1.1.1.3.2" xref="S3.E19.m1.1.1.1.1.2.2.1.1.1.1.3.2.cmml"><mn id="S3.E19.m1.1.1.1.1.2.2.1.1.1.1.3.2.2" xref="S3.E19.m1.1.1.1.1.2.2.1.1.1.1.3.2.2.cmml">1</mn><mo id="S3.E19.m1.1.1.1.1.2.2.1.1.1.1.3.2.1" xref="S3.E19.m1.1.1.1.1.2.2.1.1.1.1.3.2.1.cmml">−</mo><msub id="S3.E19.m1.1.1.1.1.2.2.1.1.1.1.3.2.3" xref="S3.E19.m1.1.1.1.1.2.2.1.1.1.1.3.2.3.cmml"><mi id="S3.E19.m1.1.1.1.1.2.2.1.1.1.1.3.2.3.2" xref="S3.E19.m1.1.1.1.1.2.2.1.1.1.1.3.2.3.2.cmml">𝝅</mi><mi id="S3.E19.m1.1.1.1.1.2.2.1.1.1.1.3.2.3.3" xref="S3.E19.m1.1.1.1.1.2.2.1.1.1.1.3.2.3.3.cmml">s</mi></msub></mrow><mrow id="S3.E19.m1.1.1.1.1.2.2.1.1.1.1.3.3" xref="S3.E19.m1.1.1.1.1.2.2.1.1.1.1.3.3.cmml"><mn id="S3.E19.m1.1.1.1.1.2.2.1.1.1.1.3.3.2" xref="S3.E19.m1.1.1.1.1.2.2.1.1.1.1.3.3.2.cmml">1</mn><mo id="S3.E19.m1.1.1.1.1.2.2.1.1.1.1.3.3.1" xref="S3.E19.m1.1.1.1.1.2.2.1.1.1.1.3.3.1.cmml">−</mo><mi id="S3.E19.m1.1.1.1.1.2.2.1.1.1.1.3.3.3" xref="S3.E19.m1.1.1.1.1.2.2.1.1.1.1.3.3.3.cmml">𝜽</mi></mrow></mfrac></mstyle></mrow><mo id="S3.E19.m1.1.1.1.1.2.2.1.1.1.3" xref="S3.E19.m1.1.1.1.1.2.2.1.1.1.1.cmml">)</mo></mrow></mrow></mrow></mrow><mo lspace="0em" id="S3.E19.m1.1.1.1.2">.</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E19.m1.1b"><apply id="S3.E19.m1.1.1.1.1.3.cmml" xref="S3.E19.m1.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.E19.m1.1.1.1.1.3a.cmml" xref="S3.E19.m1.1.1.1.1.2.3">formulae-sequence</csymbol><apply id="S3.E19.m1.1.1.1.1.1.1.cmml" xref="S3.E19.m1.1.1.1.1.1.1"><eq id="S3.E19.m1.1.1.1.1.1.1.2.cmml" xref="S3.E19.m1.1.1.1.1.1.1.2"></eq><apply id="S3.E19.m1.1.1.1.1.1.1.3.cmml" xref="S3.E19.m1.1.1.1.1.1.1.3"><divide id="S3.E19.m1.1.1.1.1.1.1.3.1.cmml" xref="S3.E19.m1.1.1.1.1.1.1.3"></divide><apply id="S3.E19.m1.1.1.1.1.1.1.3.2.cmml" xref="S3.E19.m1.1.1.1.1.1.1.3.2"><partialdiff id="S3.E19.m1.1.1.1.1.1.1.3.2.1.cmml" xref="S3.E19.m1.1.1.1.1.1.1.3.2.1"></partialdiff><ci id="S3.E19.m1.1.1.1.1.1.1.3.2.2.cmml" xref="S3.E19.m1.1.1.1.1.1.1.3.2.2">ℒ</ci></apply><apply id="S3.E19.m1.1.1.1.1.1.1.3.3.cmml" xref="S3.E19.m1.1.1.1.1.1.1.3.3"><partialdiff id="S3.E19.m1.1.1.1.1.1.1.3.3.1.cmml" xref="S3.E19.m1.1.1.1.1.1.1.3.3.1"></partialdiff><ci id="S3.E19.m1.1.1.1.1.1.1.3.3.2.cmml" xref="S3.E19.m1.1.1.1.1.1.1.3.3.2">𝐰</ci></apply></apply><apply id="S3.E19.m1.1.1.1.1.1.1.1.cmml" xref="S3.E19.m1.1.1.1.1.1.1.1"><apply id="S3.E19.m1.1.1.1.1.1.1.1.2.cmml" xref="S3.E19.m1.1.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.E19.m1.1.1.1.1.1.1.1.2.1.cmml" xref="S3.E19.m1.1.1.1.1.1.1.1.2">subscript</csymbol><sum id="S3.E19.m1.1.1.1.1.1.1.1.2.2.cmml" xref="S3.E19.m1.1.1.1.1.1.1.1.2.2"></sum><ci id="S3.E19.m1.1.1.1.1.1.1.1.2.3.cmml" xref="S3.E19.m1.1.1.1.1.1.1.1.2.3">𝑠</ci></apply><apply id="S3.E19.m1.1.1.1.1.1.1.1.1.cmml" xref="S3.E19.m1.1.1.1.1.1.1.1.1"><times id="S3.E19.m1.1.1.1.1.1.1.1.1.2.cmml" xref="S3.E19.m1.1.1.1.1.1.1.1.1.2"></times><ci id="S3.E19.m1.1.1.1.1.1.1.1.1.3.cmml" xref="S3.E19.m1.1.1.1.1.1.1.1.1.3">𝜆</ci><apply id="S3.E19.m1.1.1.1.1.1.1.1.1.4.cmml" xref="S3.E19.m1.1.1.1.1.1.1.1.1.4"><csymbol cd="ambiguous" id="S3.E19.m1.1.1.1.1.1.1.1.1.4.1.cmml" xref="S3.E19.m1.1.1.1.1.1.1.1.1.4">subscript</csymbol><ci id="S3.E19.m1.1.1.1.1.1.1.1.1.4.2.cmml" xref="S3.E19.m1.1.1.1.1.1.1.1.1.4.2">𝝅</ci><ci id="S3.E19.m1.1.1.1.1.1.1.1.1.4.3.cmml" xref="S3.E19.m1.1.1.1.1.1.1.1.1.4.3">𝑠</ci></apply><apply id="S3.E19.m1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E19.m1.1.1.1.1.1.1.1.1.1.1"><minus id="S3.E19.m1.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E19.m1.1.1.1.1.1.1.1.1.1.1.1.1"></minus><apply id="S3.E19.m1.1.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S3.E19.m1.1.1.1.1.1.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.E19.m1.1.1.1.1.1.1.1.1.1.1.1.2.1.cmml" xref="S3.E19.m1.1.1.1.1.1.1.1.1.1.1.1.2">subscript</csymbol><ci id="S3.E19.m1.1.1.1.1.1.1.1.1.1.1.1.2.2.cmml" xref="S3.E19.m1.1.1.1.1.1.1.1.1.1.1.1.2.2">𝐰</ci><ci id="S3.E19.m1.1.1.1.1.1.1.1.1.1.1.1.2.3.cmml" xref="S3.E19.m1.1.1.1.1.1.1.1.1.1.1.1.2.3">𝑠</ci></apply><ci id="S3.E19.m1.1.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="S3.E19.m1.1.1.1.1.1.1.1.1.1.1.1.3">𝐰</ci></apply></apply></apply></apply><apply id="S3.E19.m1.1.1.1.1.2.2.cmml" xref="S3.E19.m1.1.1.1.1.2.2"><eq id="S3.E19.m1.1.1.1.1.2.2.2.cmml" xref="S3.E19.m1.1.1.1.1.2.2.2"></eq><apply id="S3.E19.m1.1.1.1.1.2.2.3.cmml" xref="S3.E19.m1.1.1.1.1.2.2.3"><divide id="S3.E19.m1.1.1.1.1.2.2.3.1.cmml" xref="S3.E19.m1.1.1.1.1.2.2.3"></divide><apply id="S3.E19.m1.1.1.1.1.2.2.3.2.cmml" xref="S3.E19.m1.1.1.1.1.2.2.3.2"><partialdiff id="S3.E19.m1.1.1.1.1.2.2.3.2.1.cmml" xref="S3.E19.m1.1.1.1.1.2.2.3.2.1"></partialdiff><ci id="S3.E19.m1.1.1.1.1.2.2.3.2.2.cmml" xref="S3.E19.m1.1.1.1.1.2.2.3.2.2">ℒ</ci></apply><apply id="S3.E19.m1.1.1.1.1.2.2.3.3.cmml" xref="S3.E19.m1.1.1.1.1.2.2.3.3"><partialdiff id="S3.E19.m1.1.1.1.1.2.2.3.3.1.cmml" xref="S3.E19.m1.1.1.1.1.2.2.3.3.1"></partialdiff><ci id="S3.E19.m1.1.1.1.1.2.2.3.3.2.cmml" xref="S3.E19.m1.1.1.1.1.2.2.3.3.2">𝜽</ci></apply></apply><apply id="S3.E19.m1.1.1.1.1.2.2.1.cmml" xref="S3.E19.m1.1.1.1.1.2.2.1"><apply id="S3.E19.m1.1.1.1.1.2.2.1.2.cmml" xref="S3.E19.m1.1.1.1.1.2.2.1.2"><csymbol cd="ambiguous" id="S3.E19.m1.1.1.1.1.2.2.1.2.1.cmml" xref="S3.E19.m1.1.1.1.1.2.2.1.2">subscript</csymbol><sum id="S3.E19.m1.1.1.1.1.2.2.1.2.2.cmml" xref="S3.E19.m1.1.1.1.1.2.2.1.2.2"></sum><ci id="S3.E19.m1.1.1.1.1.2.2.1.2.3.cmml" xref="S3.E19.m1.1.1.1.1.2.2.1.2.3">𝑠</ci></apply><apply id="S3.E19.m1.1.1.1.1.2.2.1.1.1.1.cmml" xref="S3.E19.m1.1.1.1.1.2.2.1.1.1"><minus id="S3.E19.m1.1.1.1.1.2.2.1.1.1.1.1.cmml" xref="S3.E19.m1.1.1.1.1.2.2.1.1.1.1.1"></minus><apply id="S3.E19.m1.1.1.1.1.2.2.1.1.1.1.2.cmml" xref="S3.E19.m1.1.1.1.1.2.2.1.1.1.1.2"><divide id="S3.E19.m1.1.1.1.1.2.2.1.1.1.1.2.1.cmml" xref="S3.E19.m1.1.1.1.1.2.2.1.1.1.1.2"></divide><apply id="S3.E19.m1.1.1.1.1.2.2.1.1.1.1.2.2.cmml" xref="S3.E19.m1.1.1.1.1.2.2.1.1.1.1.2.2"><csymbol cd="ambiguous" id="S3.E19.m1.1.1.1.1.2.2.1.1.1.1.2.2.1.cmml" xref="S3.E19.m1.1.1.1.1.2.2.1.1.1.1.2.2">subscript</csymbol><ci id="S3.E19.m1.1.1.1.1.2.2.1.1.1.1.2.2.2.cmml" xref="S3.E19.m1.1.1.1.1.2.2.1.1.1.1.2.2.2">𝝅</ci><ci id="S3.E19.m1.1.1.1.1.2.2.1.1.1.1.2.2.3.cmml" xref="S3.E19.m1.1.1.1.1.2.2.1.1.1.1.2.2.3">𝑠</ci></apply><ci id="S3.E19.m1.1.1.1.1.2.2.1.1.1.1.2.3.cmml" xref="S3.E19.m1.1.1.1.1.2.2.1.1.1.1.2.3">𝜽</ci></apply><apply id="S3.E19.m1.1.1.1.1.2.2.1.1.1.1.3.cmml" xref="S3.E19.m1.1.1.1.1.2.2.1.1.1.1.3"><divide id="S3.E19.m1.1.1.1.1.2.2.1.1.1.1.3.1.cmml" xref="S3.E19.m1.1.1.1.1.2.2.1.1.1.1.3"></divide><apply id="S3.E19.m1.1.1.1.1.2.2.1.1.1.1.3.2.cmml" xref="S3.E19.m1.1.1.1.1.2.2.1.1.1.1.3.2"><minus id="S3.E19.m1.1.1.1.1.2.2.1.1.1.1.3.2.1.cmml" xref="S3.E19.m1.1.1.1.1.2.2.1.1.1.1.3.2.1"></minus><cn type="integer" id="S3.E19.m1.1.1.1.1.2.2.1.1.1.1.3.2.2.cmml" xref="S3.E19.m1.1.1.1.1.2.2.1.1.1.1.3.2.2">1</cn><apply id="S3.E19.m1.1.1.1.1.2.2.1.1.1.1.3.2.3.cmml" xref="S3.E19.m1.1.1.1.1.2.2.1.1.1.1.3.2.3"><csymbol cd="ambiguous" id="S3.E19.m1.1.1.1.1.2.2.1.1.1.1.3.2.3.1.cmml" xref="S3.E19.m1.1.1.1.1.2.2.1.1.1.1.3.2.3">subscript</csymbol><ci id="S3.E19.m1.1.1.1.1.2.2.1.1.1.1.3.2.3.2.cmml" xref="S3.E19.m1.1.1.1.1.2.2.1.1.1.1.3.2.3.2">𝝅</ci><ci id="S3.E19.m1.1.1.1.1.2.2.1.1.1.1.3.2.3.3.cmml" xref="S3.E19.m1.1.1.1.1.2.2.1.1.1.1.3.2.3.3">𝑠</ci></apply></apply><apply id="S3.E19.m1.1.1.1.1.2.2.1.1.1.1.3.3.cmml" xref="S3.E19.m1.1.1.1.1.2.2.1.1.1.1.3.3"><minus id="S3.E19.m1.1.1.1.1.2.2.1.1.1.1.3.3.1.cmml" xref="S3.E19.m1.1.1.1.1.2.2.1.1.1.1.3.3.1"></minus><cn type="integer" id="S3.E19.m1.1.1.1.1.2.2.1.1.1.1.3.3.2.cmml" xref="S3.E19.m1.1.1.1.1.2.2.1.1.1.1.3.3.2">1</cn><ci id="S3.E19.m1.1.1.1.1.2.2.1.1.1.1.3.3.3.cmml" xref="S3.E19.m1.1.1.1.1.2.2.1.1.1.1.3.3.3">𝜽</ci></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E19.m1.1c">\displaystyle\frac{\partial\mathcal{L}}{\partial\mathbf{w}}=\sum_{s}\lambda\bm{\pi}_{s}(\mathbf{w}_{s}-\mathbf{w}),\enskip\frac{\partial\mathcal{L}}{\partial\bm{\theta}}=\sum_{s}\left(\frac{\bm{\pi}_{s}}{\bm{\theta}}-\frac{1-\bm{\pi}_{s}}{1-\bm{\theta}}\right).</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(19)</span></td>
</tr></tbody>
</table>
<p id="S3.p3.11" class="ltx_p">Setting these derivatives to zero, we see that the stationary points are</p>
<table id="A10.EGx18" class="ltx_equationgroup ltx_eqn_align ltx_eqn_table">

<tbody id="S3.E20"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math id="S3.E20.m1.2" class="ltx_Math" alttext="\displaystyle\mathbf{w}=\frac{1}{\sum_{j}\bm{\pi}_{j}}\sum_{s}\bm{\pi}_{s}\mathbf{w}_{s},\qquad\bm{\theta}=\frac{1}{S}\sum_{s}\bm{\pi}_{s}" display="inline"><semantics id="S3.E20.m1.2a"><mrow id="S3.E20.m1.2.2.2" xref="S3.E20.m1.2.2.3.cmml"><mrow id="S3.E20.m1.1.1.1.1" xref="S3.E20.m1.1.1.1.1.cmml"><mi id="S3.E20.m1.1.1.1.1.2" xref="S3.E20.m1.1.1.1.1.2.cmml">𝐰</mi><mo id="S3.E20.m1.1.1.1.1.1" xref="S3.E20.m1.1.1.1.1.1.cmml">=</mo><mrow id="S3.E20.m1.1.1.1.1.3" xref="S3.E20.m1.1.1.1.1.3.cmml"><mstyle displaystyle="true" id="S3.E20.m1.1.1.1.1.3.2" xref="S3.E20.m1.1.1.1.1.3.2.cmml"><mfrac id="S3.E20.m1.1.1.1.1.3.2a" xref="S3.E20.m1.1.1.1.1.3.2.cmml"><mn id="S3.E20.m1.1.1.1.1.3.2.2" xref="S3.E20.m1.1.1.1.1.3.2.2.cmml">1</mn><mrow id="S3.E20.m1.1.1.1.1.3.2.3" xref="S3.E20.m1.1.1.1.1.3.2.3.cmml"><msub id="S3.E20.m1.1.1.1.1.3.2.3.1" xref="S3.E20.m1.1.1.1.1.3.2.3.1.cmml"><mo id="S3.E20.m1.1.1.1.1.3.2.3.1.2" xref="S3.E20.m1.1.1.1.1.3.2.3.1.2.cmml">∑</mo><mi id="S3.E20.m1.1.1.1.1.3.2.3.1.3" xref="S3.E20.m1.1.1.1.1.3.2.3.1.3.cmml">j</mi></msub><msub id="S3.E20.m1.1.1.1.1.3.2.3.2" xref="S3.E20.m1.1.1.1.1.3.2.3.2.cmml"><mi id="S3.E20.m1.1.1.1.1.3.2.3.2.2" xref="S3.E20.m1.1.1.1.1.3.2.3.2.2.cmml">𝝅</mi><mi id="S3.E20.m1.1.1.1.1.3.2.3.2.3" xref="S3.E20.m1.1.1.1.1.3.2.3.2.3.cmml">j</mi></msub></mrow></mfrac></mstyle><mo lspace="0em" rspace="0em" id="S3.E20.m1.1.1.1.1.3.1" xref="S3.E20.m1.1.1.1.1.3.1.cmml">​</mo><mrow id="S3.E20.m1.1.1.1.1.3.3" xref="S3.E20.m1.1.1.1.1.3.3.cmml"><mstyle displaystyle="true" id="S3.E20.m1.1.1.1.1.3.3.1" xref="S3.E20.m1.1.1.1.1.3.3.1.cmml"><munder id="S3.E20.m1.1.1.1.1.3.3.1a" xref="S3.E20.m1.1.1.1.1.3.3.1.cmml"><mo movablelimits="false" id="S3.E20.m1.1.1.1.1.3.3.1.2" xref="S3.E20.m1.1.1.1.1.3.3.1.2.cmml">∑</mo><mi id="S3.E20.m1.1.1.1.1.3.3.1.3" xref="S3.E20.m1.1.1.1.1.3.3.1.3.cmml">s</mi></munder></mstyle><mrow id="S3.E20.m1.1.1.1.1.3.3.2" xref="S3.E20.m1.1.1.1.1.3.3.2.cmml"><msub id="S3.E20.m1.1.1.1.1.3.3.2.2" xref="S3.E20.m1.1.1.1.1.3.3.2.2.cmml"><mi id="S3.E20.m1.1.1.1.1.3.3.2.2.2" xref="S3.E20.m1.1.1.1.1.3.3.2.2.2.cmml">𝝅</mi><mi id="S3.E20.m1.1.1.1.1.3.3.2.2.3" xref="S3.E20.m1.1.1.1.1.3.3.2.2.3.cmml">s</mi></msub><mo lspace="0em" rspace="0em" id="S3.E20.m1.1.1.1.1.3.3.2.1" xref="S3.E20.m1.1.1.1.1.3.3.2.1.cmml">​</mo><msub id="S3.E20.m1.1.1.1.1.3.3.2.3" xref="S3.E20.m1.1.1.1.1.3.3.2.3.cmml"><mi id="S3.E20.m1.1.1.1.1.3.3.2.3.2" xref="S3.E20.m1.1.1.1.1.3.3.2.3.2.cmml">𝐰</mi><mi id="S3.E20.m1.1.1.1.1.3.3.2.3.3" xref="S3.E20.m1.1.1.1.1.3.3.2.3.3.cmml">s</mi></msub></mrow></mrow></mrow></mrow><mo rspace="2.167em" id="S3.E20.m1.2.2.2.3" xref="S3.E20.m1.2.2.3a.cmml">,</mo><mrow id="S3.E20.m1.2.2.2.2" xref="S3.E20.m1.2.2.2.2.cmml"><mi id="S3.E20.m1.2.2.2.2.2" xref="S3.E20.m1.2.2.2.2.2.cmml">𝜽</mi><mo id="S3.E20.m1.2.2.2.2.1" xref="S3.E20.m1.2.2.2.2.1.cmml">=</mo><mrow id="S3.E20.m1.2.2.2.2.3" xref="S3.E20.m1.2.2.2.2.3.cmml"><mstyle displaystyle="true" id="S3.E20.m1.2.2.2.2.3.2" xref="S3.E20.m1.2.2.2.2.3.2.cmml"><mfrac id="S3.E20.m1.2.2.2.2.3.2a" xref="S3.E20.m1.2.2.2.2.3.2.cmml"><mn id="S3.E20.m1.2.2.2.2.3.2.2" xref="S3.E20.m1.2.2.2.2.3.2.2.cmml">1</mn><mi id="S3.E20.m1.2.2.2.2.3.2.3" xref="S3.E20.m1.2.2.2.2.3.2.3.cmml">S</mi></mfrac></mstyle><mo lspace="0em" rspace="0em" id="S3.E20.m1.2.2.2.2.3.1" xref="S3.E20.m1.2.2.2.2.3.1.cmml">​</mo><mrow id="S3.E20.m1.2.2.2.2.3.3" xref="S3.E20.m1.2.2.2.2.3.3.cmml"><mstyle displaystyle="true" id="S3.E20.m1.2.2.2.2.3.3.1" xref="S3.E20.m1.2.2.2.2.3.3.1.cmml"><munder id="S3.E20.m1.2.2.2.2.3.3.1a" xref="S3.E20.m1.2.2.2.2.3.3.1.cmml"><mo movablelimits="false" id="S3.E20.m1.2.2.2.2.3.3.1.2" xref="S3.E20.m1.2.2.2.2.3.3.1.2.cmml">∑</mo><mi id="S3.E20.m1.2.2.2.2.3.3.1.3" xref="S3.E20.m1.2.2.2.2.3.3.1.3.cmml">s</mi></munder></mstyle><msub id="S3.E20.m1.2.2.2.2.3.3.2" xref="S3.E20.m1.2.2.2.2.3.3.2.cmml"><mi id="S3.E20.m1.2.2.2.2.3.3.2.2" xref="S3.E20.m1.2.2.2.2.3.3.2.2.cmml">𝝅</mi><mi id="S3.E20.m1.2.2.2.2.3.3.2.3" xref="S3.E20.m1.2.2.2.2.3.3.2.3.cmml">s</mi></msub></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.E20.m1.2b"><apply id="S3.E20.m1.2.2.3.cmml" xref="S3.E20.m1.2.2.2"><csymbol cd="ambiguous" id="S3.E20.m1.2.2.3a.cmml" xref="S3.E20.m1.2.2.2.3">formulae-sequence</csymbol><apply id="S3.E20.m1.1.1.1.1.cmml" xref="S3.E20.m1.1.1.1.1"><eq id="S3.E20.m1.1.1.1.1.1.cmml" xref="S3.E20.m1.1.1.1.1.1"></eq><ci id="S3.E20.m1.1.1.1.1.2.cmml" xref="S3.E20.m1.1.1.1.1.2">𝐰</ci><apply id="S3.E20.m1.1.1.1.1.3.cmml" xref="S3.E20.m1.1.1.1.1.3"><times id="S3.E20.m1.1.1.1.1.3.1.cmml" xref="S3.E20.m1.1.1.1.1.3.1"></times><apply id="S3.E20.m1.1.1.1.1.3.2.cmml" xref="S3.E20.m1.1.1.1.1.3.2"><divide id="S3.E20.m1.1.1.1.1.3.2.1.cmml" xref="S3.E20.m1.1.1.1.1.3.2"></divide><cn type="integer" id="S3.E20.m1.1.1.1.1.3.2.2.cmml" xref="S3.E20.m1.1.1.1.1.3.2.2">1</cn><apply id="S3.E20.m1.1.1.1.1.3.2.3.cmml" xref="S3.E20.m1.1.1.1.1.3.2.3"><apply id="S3.E20.m1.1.1.1.1.3.2.3.1.cmml" xref="S3.E20.m1.1.1.1.1.3.2.3.1"><csymbol cd="ambiguous" id="S3.E20.m1.1.1.1.1.3.2.3.1.1.cmml" xref="S3.E20.m1.1.1.1.1.3.2.3.1">subscript</csymbol><sum id="S3.E20.m1.1.1.1.1.3.2.3.1.2.cmml" xref="S3.E20.m1.1.1.1.1.3.2.3.1.2"></sum><ci id="S3.E20.m1.1.1.1.1.3.2.3.1.3.cmml" xref="S3.E20.m1.1.1.1.1.3.2.3.1.3">𝑗</ci></apply><apply id="S3.E20.m1.1.1.1.1.3.2.3.2.cmml" xref="S3.E20.m1.1.1.1.1.3.2.3.2"><csymbol cd="ambiguous" id="S3.E20.m1.1.1.1.1.3.2.3.2.1.cmml" xref="S3.E20.m1.1.1.1.1.3.2.3.2">subscript</csymbol><ci id="S3.E20.m1.1.1.1.1.3.2.3.2.2.cmml" xref="S3.E20.m1.1.1.1.1.3.2.3.2.2">𝝅</ci><ci id="S3.E20.m1.1.1.1.1.3.2.3.2.3.cmml" xref="S3.E20.m1.1.1.1.1.3.2.3.2.3">𝑗</ci></apply></apply></apply><apply id="S3.E20.m1.1.1.1.1.3.3.cmml" xref="S3.E20.m1.1.1.1.1.3.3"><apply id="S3.E20.m1.1.1.1.1.3.3.1.cmml" xref="S3.E20.m1.1.1.1.1.3.3.1"><csymbol cd="ambiguous" id="S3.E20.m1.1.1.1.1.3.3.1.1.cmml" xref="S3.E20.m1.1.1.1.1.3.3.1">subscript</csymbol><sum id="S3.E20.m1.1.1.1.1.3.3.1.2.cmml" xref="S3.E20.m1.1.1.1.1.3.3.1.2"></sum><ci id="S3.E20.m1.1.1.1.1.3.3.1.3.cmml" xref="S3.E20.m1.1.1.1.1.3.3.1.3">𝑠</ci></apply><apply id="S3.E20.m1.1.1.1.1.3.3.2.cmml" xref="S3.E20.m1.1.1.1.1.3.3.2"><times id="S3.E20.m1.1.1.1.1.3.3.2.1.cmml" xref="S3.E20.m1.1.1.1.1.3.3.2.1"></times><apply id="S3.E20.m1.1.1.1.1.3.3.2.2.cmml" xref="S3.E20.m1.1.1.1.1.3.3.2.2"><csymbol cd="ambiguous" id="S3.E20.m1.1.1.1.1.3.3.2.2.1.cmml" xref="S3.E20.m1.1.1.1.1.3.3.2.2">subscript</csymbol><ci id="S3.E20.m1.1.1.1.1.3.3.2.2.2.cmml" xref="S3.E20.m1.1.1.1.1.3.3.2.2.2">𝝅</ci><ci id="S3.E20.m1.1.1.1.1.3.3.2.2.3.cmml" xref="S3.E20.m1.1.1.1.1.3.3.2.2.3">𝑠</ci></apply><apply id="S3.E20.m1.1.1.1.1.3.3.2.3.cmml" xref="S3.E20.m1.1.1.1.1.3.3.2.3"><csymbol cd="ambiguous" id="S3.E20.m1.1.1.1.1.3.3.2.3.1.cmml" xref="S3.E20.m1.1.1.1.1.3.3.2.3">subscript</csymbol><ci id="S3.E20.m1.1.1.1.1.3.3.2.3.2.cmml" xref="S3.E20.m1.1.1.1.1.3.3.2.3.2">𝐰</ci><ci id="S3.E20.m1.1.1.1.1.3.3.2.3.3.cmml" xref="S3.E20.m1.1.1.1.1.3.3.2.3.3">𝑠</ci></apply></apply></apply></apply></apply><apply id="S3.E20.m1.2.2.2.2.cmml" xref="S3.E20.m1.2.2.2.2"><eq id="S3.E20.m1.2.2.2.2.1.cmml" xref="S3.E20.m1.2.2.2.2.1"></eq><ci id="S3.E20.m1.2.2.2.2.2.cmml" xref="S3.E20.m1.2.2.2.2.2">𝜽</ci><apply id="S3.E20.m1.2.2.2.2.3.cmml" xref="S3.E20.m1.2.2.2.2.3"><times id="S3.E20.m1.2.2.2.2.3.1.cmml" xref="S3.E20.m1.2.2.2.2.3.1"></times><apply id="S3.E20.m1.2.2.2.2.3.2.cmml" xref="S3.E20.m1.2.2.2.2.3.2"><divide id="S3.E20.m1.2.2.2.2.3.2.1.cmml" xref="S3.E20.m1.2.2.2.2.3.2"></divide><cn type="integer" id="S3.E20.m1.2.2.2.2.3.2.2.cmml" xref="S3.E20.m1.2.2.2.2.3.2.2">1</cn><ci id="S3.E20.m1.2.2.2.2.3.2.3.cmml" xref="S3.E20.m1.2.2.2.2.3.2.3">𝑆</ci></apply><apply id="S3.E20.m1.2.2.2.2.3.3.cmml" xref="S3.E20.m1.2.2.2.2.3.3"><apply id="S3.E20.m1.2.2.2.2.3.3.1.cmml" xref="S3.E20.m1.2.2.2.2.3.3.1"><csymbol cd="ambiguous" id="S3.E20.m1.2.2.2.2.3.3.1.1.cmml" xref="S3.E20.m1.2.2.2.2.3.3.1">subscript</csymbol><sum id="S3.E20.m1.2.2.2.2.3.3.1.2.cmml" xref="S3.E20.m1.2.2.2.2.3.3.1.2"></sum><ci id="S3.E20.m1.2.2.2.2.3.3.1.3.cmml" xref="S3.E20.m1.2.2.2.2.3.3.1.3">𝑠</ci></apply><apply id="S3.E20.m1.2.2.2.2.3.3.2.cmml" xref="S3.E20.m1.2.2.2.2.3.3.2"><csymbol cd="ambiguous" id="S3.E20.m1.2.2.2.2.3.3.2.1.cmml" xref="S3.E20.m1.2.2.2.2.3.3.2">subscript</csymbol><ci id="S3.E20.m1.2.2.2.2.3.3.2.2.cmml" xref="S3.E20.m1.2.2.2.2.3.3.2.2">𝝅</ci><ci id="S3.E20.m1.2.2.2.2.3.3.2.3.cmml" xref="S3.E20.m1.2.2.2.2.3.3.2.3">𝑠</ci></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E20.m1.2c">\displaystyle\mathbf{w}=\frac{1}{\sum_{j}\bm{\pi}_{j}}\sum_{s}\bm{\pi}_{s}\mathbf{w}_{s},\qquad\bm{\theta}=\frac{1}{S}\sum_{s}\bm{\pi}_{s}</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(20)</span></td>
</tr></tbody>
</table>
<p id="S3.p3.10" class="ltx_p"><em id="S3.p3.10.1" class="ltx_emph ltx_font_italic">i.e.</em>, a weighted average of the local weights and an average of the local probabilities of keeping these weights. Therefore, since the <math id="S3.p3.4.m1.1" class="ltx_Math" alttext="\bm{\pi}_{s}" display="inline"><semantics id="S3.p3.4.m1.1a"><msub id="S3.p3.4.m1.1.1" xref="S3.p3.4.m1.1.1.cmml"><mi id="S3.p3.4.m1.1.1.2" xref="S3.p3.4.m1.1.1.2.cmml">𝝅</mi><mi id="S3.p3.4.m1.1.1.3" xref="S3.p3.4.m1.1.1.3.cmml">s</mi></msub><annotation-xml encoding="MathML-Content" id="S3.p3.4.m1.1b"><apply id="S3.p3.4.m1.1.1.cmml" xref="S3.p3.4.m1.1.1"><csymbol cd="ambiguous" id="S3.p3.4.m1.1.1.1.cmml" xref="S3.p3.4.m1.1.1">subscript</csymbol><ci id="S3.p3.4.m1.1.1.2.cmml" xref="S3.p3.4.m1.1.1.2">𝝅</ci><ci id="S3.p3.4.m1.1.1.3.cmml" xref="S3.p3.4.m1.1.1.3">𝑠</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p3.4.m1.1c">\bm{\pi}_{s}</annotation></semantics></math> are being optimized to be sparse through the <math id="S3.p3.5.m2.1" class="ltx_Math" alttext="L_{0}" display="inline"><semantics id="S3.p3.5.m2.1a"><msub id="S3.p3.5.m2.1.1" xref="S3.p3.5.m2.1.1.cmml"><mi id="S3.p3.5.m2.1.1.2" xref="S3.p3.5.m2.1.1.2.cmml">L</mi><mn id="S3.p3.5.m2.1.1.3" xref="S3.p3.5.m2.1.1.3.cmml">0</mn></msub><annotation-xml encoding="MathML-Content" id="S3.p3.5.m2.1b"><apply id="S3.p3.5.m2.1.1.cmml" xref="S3.p3.5.m2.1.1"><csymbol cd="ambiguous" id="S3.p3.5.m2.1.1.1.cmml" xref="S3.p3.5.m2.1.1">subscript</csymbol><ci id="S3.p3.5.m2.1.1.2.cmml" xref="S3.p3.5.m2.1.1.2">𝐿</ci><cn type="integer" id="S3.p3.5.m2.1.1.3.cmml" xref="S3.p3.5.m2.1.1.3">0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p3.5.m2.1c">L_{0}</annotation></semantics></math> penalty, the server probabilities <math id="S3.p3.6.m3.1" class="ltx_Math" alttext="\bm{\theta}" display="inline"><semantics id="S3.p3.6.m3.1a"><mi id="S3.p3.6.m3.1.1" xref="S3.p3.6.m3.1.1.cmml">𝜽</mi><annotation-xml encoding="MathML-Content" id="S3.p3.6.m3.1b"><ci id="S3.p3.6.m3.1.1.cmml" xref="S3.p3.6.m3.1.1">𝜽</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.p3.6.m3.1c">\bm{\theta}</annotation></semantics></math> will also become small for the weights that are used by only a small fraction of the shards.
As a result, to obtain the final sparse architecture, we can prune the weights whose corresponding, learned, server inclusion probabilities <math id="S3.p3.7.m4.1" class="ltx_Math" alttext="\bm{\theta}" display="inline"><semantics id="S3.p3.7.m4.1a"><mi id="S3.p3.7.m4.1.1" xref="S3.p3.7.m4.1.1.cmml">𝜽</mi><annotation-xml encoding="MathML-Content" id="S3.p3.7.m4.1b"><ci id="S3.p3.7.m4.1.1.cmml" xref="S3.p3.7.m4.1.1">𝜽</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.p3.7.m4.1c">\bm{\theta}</annotation></semantics></math> are less than a threshold, <em id="S3.p3.10.2" class="ltx_emph ltx_font_italic">e.g.</em>, <math id="S3.p3.8.m5.1" class="ltx_Math" alttext="0.1" display="inline"><semantics id="S3.p3.8.m5.1a"><mn id="S3.p3.8.m5.1.1" xref="S3.p3.8.m5.1.1.cmml">0.1</mn><annotation-xml encoding="MathML-Content" id="S3.p3.8.m5.1b"><cn type="float" id="S3.p3.8.m5.1.1.cmml" xref="S3.p3.8.m5.1.1">0.1</cn></annotation-xml><annotation encoding="application/x-tex" id="S3.p3.8.m5.1c">0.1</annotation></semantics></math>. It should again be noted that the sums and averages of Eq. <a href="#S3.E19" title="In 3 The FedSparse algorithm: sparsity in federated learning ‣ An Expectation-Maximization Perspective on Federated Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">19</span></a>, <a href="#S3.E20" title="In 3 The FedSparse algorithm: sparsity in federated learning ‣ An Expectation-Maximization Perspective on Federated Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">20</span></a> respectively can be easily approximated by subsampling a small set of clients <math id="S3.p3.9.m6.1" class="ltx_Math" alttext="S^{\prime}" display="inline"><semantics id="S3.p3.9.m6.1a"><msup id="S3.p3.9.m6.1.1" xref="S3.p3.9.m6.1.1.cmml"><mi id="S3.p3.9.m6.1.1.2" xref="S3.p3.9.m6.1.1.2.cmml">S</mi><mo id="S3.p3.9.m6.1.1.3" xref="S3.p3.9.m6.1.1.3.cmml">′</mo></msup><annotation-xml encoding="MathML-Content" id="S3.p3.9.m6.1b"><apply id="S3.p3.9.m6.1.1.cmml" xref="S3.p3.9.m6.1.1"><csymbol cd="ambiguous" id="S3.p3.9.m6.1.1.1.cmml" xref="S3.p3.9.m6.1.1">superscript</csymbol><ci id="S3.p3.9.m6.1.1.2.cmml" xref="S3.p3.9.m6.1.1.2">𝑆</ci><ci id="S3.p3.9.m6.1.1.3.cmml" xref="S3.p3.9.m6.1.1.3">′</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p3.9.m6.1c">S^{\prime}</annotation></semantics></math> from <math id="S3.p3.10.m7.1" class="ltx_Math" alttext="S" display="inline"><semantics id="S3.p3.10.m7.1a"><mi id="S3.p3.10.m7.1.1" xref="S3.p3.10.m7.1.1.cmml">S</mi><annotation-xml encoding="MathML-Content" id="S3.p3.10.m7.1b"><ci id="S3.p3.10.m7.1.1.cmml" xref="S3.p3.10.m7.1.1">𝑆</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.p3.10.m7.1c">S</annotation></semantics></math>. Therefore we do not have to consider all of the clients at each round, which would be prohibitive for “cross-device” FL.</p>
</div>
<section id="S3.SS1" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.1 </span>Reducing the communication cost</h3>

<div id="S3.SS1.p1" class="ltx_para">
<p id="S3.SS1.p1.1" class="ltx_p">The framework described so far allows us to learn a more efficient model. We now discuss how we can use it in order to cut down both download and upload communication costs during training.</p>
</div>
<section id="S3.SS1.SSS0.Px1" class="ltx_paragraph">
<h4 class="ltx_title ltx_title_paragraph">Reducing client to server communication cost</h4>

<div id="S3.SS1.SSS0.Px1.p1" class="ltx_para">
<p id="S3.SS1.SSS0.Px1.p1.5" class="ltx_p">In order to reduce the client to server cost, we will communicate sparse samples from the local distributions instead of the distributions themselves; in this way, we do not have to communicate the zero values of the parameter vector, which leads to large savings. More specifically, we can express the gradients and stationary points for the server weights and probabilities as follows</p>
<table id="A10.EGx19" class="ltx_equationgroup ltx_eqn_align ltx_eqn_table">

<tbody id="S3.E21"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math id="S3.E21.m1.1" class="ltx_Math" alttext="\displaystyle\frac{\partial\mathcal{L}}{\partial\mathbf{w}}" display="inline"><semantics id="S3.E21.m1.1a"><mstyle displaystyle="true" id="S3.E21.m1.1.1" xref="S3.E21.m1.1.1.cmml"><mfrac id="S3.E21.m1.1.1a" xref="S3.E21.m1.1.1.cmml"><mrow id="S3.E21.m1.1.1.2" xref="S3.E21.m1.1.1.2.cmml"><mo rspace="0em" id="S3.E21.m1.1.1.2.1" xref="S3.E21.m1.1.1.2.1.cmml">∂</mo><mi class="ltx_font_mathcaligraphic" id="S3.E21.m1.1.1.2.2" xref="S3.E21.m1.1.1.2.2.cmml">ℒ</mi></mrow><mrow id="S3.E21.m1.1.1.3" xref="S3.E21.m1.1.1.3.cmml"><mo rspace="0em" id="S3.E21.m1.1.1.3.1" xref="S3.E21.m1.1.1.3.1.cmml">∂</mo><mi id="S3.E21.m1.1.1.3.2" xref="S3.E21.m1.1.1.3.2.cmml">𝐰</mi></mrow></mfrac></mstyle><annotation-xml encoding="MathML-Content" id="S3.E21.m1.1b"><apply id="S3.E21.m1.1.1.cmml" xref="S3.E21.m1.1.1"><divide id="S3.E21.m1.1.1.1.cmml" xref="S3.E21.m1.1.1"></divide><apply id="S3.E21.m1.1.1.2.cmml" xref="S3.E21.m1.1.1.2"><partialdiff id="S3.E21.m1.1.1.2.1.cmml" xref="S3.E21.m1.1.1.2.1"></partialdiff><ci id="S3.E21.m1.1.1.2.2.cmml" xref="S3.E21.m1.1.1.2.2">ℒ</ci></apply><apply id="S3.E21.m1.1.1.3.cmml" xref="S3.E21.m1.1.1.3"><partialdiff id="S3.E21.m1.1.1.3.1.cmml" xref="S3.E21.m1.1.1.3.1"></partialdiff><ci id="S3.E21.m1.1.1.3.2.cmml" xref="S3.E21.m1.1.1.3.2">𝐰</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E21.m1.1c">\displaystyle\frac{\partial\mathcal{L}}{\partial\mathbf{w}}</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math id="S3.E21.m2.3" class="ltx_Math" alttext="\displaystyle=\sum_{s}\lambda\mathbb{E}_{q_{\bm{\pi}_{s}}(\mathbf{z}_{s})}\left[\mathbf{z}_{s}(\mathbf{w}_{s}-\mathbf{w})\right],\quad\mathbf{w}=\mathbb{E}_{q_{\bm{\pi}_{1:S}}(\mathbf{z}_{1:S})}\left[\frac{1}{\sum_{j}\mathbf{z}_{j}}\sum_{s}\mathbf{z}_{s}\mathbf{w}_{s}\right]," display="inline"><semantics id="S3.E21.m2.3a"><mrow id="S3.E21.m2.3.3.1"><mrow id="S3.E21.m2.3.3.1.1.2" xref="S3.E21.m2.3.3.1.1.3.cmml"><mrow id="S3.E21.m2.3.3.1.1.1.1" xref="S3.E21.m2.3.3.1.1.1.1.cmml"><mi id="S3.E21.m2.3.3.1.1.1.1.3" xref="S3.E21.m2.3.3.1.1.1.1.3.cmml"></mi><mo id="S3.E21.m2.3.3.1.1.1.1.2" xref="S3.E21.m2.3.3.1.1.1.1.2.cmml">=</mo><mrow id="S3.E21.m2.3.3.1.1.1.1.1" xref="S3.E21.m2.3.3.1.1.1.1.1.cmml"><mstyle displaystyle="true" id="S3.E21.m2.3.3.1.1.1.1.1.2" xref="S3.E21.m2.3.3.1.1.1.1.1.2.cmml"><munder id="S3.E21.m2.3.3.1.1.1.1.1.2a" xref="S3.E21.m2.3.3.1.1.1.1.1.2.cmml"><mo movablelimits="false" id="S3.E21.m2.3.3.1.1.1.1.1.2.2" xref="S3.E21.m2.3.3.1.1.1.1.1.2.2.cmml">∑</mo><mi id="S3.E21.m2.3.3.1.1.1.1.1.2.3" xref="S3.E21.m2.3.3.1.1.1.1.1.2.3.cmml">s</mi></munder></mstyle><mrow id="S3.E21.m2.3.3.1.1.1.1.1.1" xref="S3.E21.m2.3.3.1.1.1.1.1.1.cmml"><mi id="S3.E21.m2.3.3.1.1.1.1.1.1.3" xref="S3.E21.m2.3.3.1.1.1.1.1.1.3.cmml">λ</mi><mo lspace="0em" rspace="0em" id="S3.E21.m2.3.3.1.1.1.1.1.1.2" xref="S3.E21.m2.3.3.1.1.1.1.1.1.2.cmml">​</mo><msub id="S3.E21.m2.3.3.1.1.1.1.1.1.4" xref="S3.E21.m2.3.3.1.1.1.1.1.1.4.cmml"><mi id="S3.E21.m2.3.3.1.1.1.1.1.1.4.2" xref="S3.E21.m2.3.3.1.1.1.1.1.1.4.2.cmml">𝔼</mi><mrow id="S3.E21.m2.1.1.1" xref="S3.E21.m2.1.1.1.cmml"><msub id="S3.E21.m2.1.1.1.3" xref="S3.E21.m2.1.1.1.3.cmml"><mi id="S3.E21.m2.1.1.1.3.2" xref="S3.E21.m2.1.1.1.3.2.cmml">q</mi><msub id="S3.E21.m2.1.1.1.3.3" xref="S3.E21.m2.1.1.1.3.3.cmml"><mi id="S3.E21.m2.1.1.1.3.3.2" xref="S3.E21.m2.1.1.1.3.3.2.cmml">𝝅</mi><mi id="S3.E21.m2.1.1.1.3.3.3" xref="S3.E21.m2.1.1.1.3.3.3.cmml">s</mi></msub></msub><mo lspace="0em" rspace="0em" id="S3.E21.m2.1.1.1.2" xref="S3.E21.m2.1.1.1.2.cmml">​</mo><mrow id="S3.E21.m2.1.1.1.1.1" xref="S3.E21.m2.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S3.E21.m2.1.1.1.1.1.2" xref="S3.E21.m2.1.1.1.1.1.1.cmml">(</mo><msub id="S3.E21.m2.1.1.1.1.1.1" xref="S3.E21.m2.1.1.1.1.1.1.cmml"><mi id="S3.E21.m2.1.1.1.1.1.1.2" xref="S3.E21.m2.1.1.1.1.1.1.2.cmml">𝐳</mi><mi id="S3.E21.m2.1.1.1.1.1.1.3" xref="S3.E21.m2.1.1.1.1.1.1.3.cmml">s</mi></msub><mo stretchy="false" id="S3.E21.m2.1.1.1.1.1.3" xref="S3.E21.m2.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></msub><mo lspace="0em" rspace="0em" id="S3.E21.m2.3.3.1.1.1.1.1.1.2a" xref="S3.E21.m2.3.3.1.1.1.1.1.1.2.cmml">​</mo><mrow id="S3.E21.m2.3.3.1.1.1.1.1.1.1.1" xref="S3.E21.m2.3.3.1.1.1.1.1.1.1.2.cmml"><mo id="S3.E21.m2.3.3.1.1.1.1.1.1.1.1.2" xref="S3.E21.m2.3.3.1.1.1.1.1.1.1.2.1.cmml">[</mo><mrow id="S3.E21.m2.3.3.1.1.1.1.1.1.1.1.1" xref="S3.E21.m2.3.3.1.1.1.1.1.1.1.1.1.cmml"><msub id="S3.E21.m2.3.3.1.1.1.1.1.1.1.1.1.3" xref="S3.E21.m2.3.3.1.1.1.1.1.1.1.1.1.3.cmml"><mi id="S3.E21.m2.3.3.1.1.1.1.1.1.1.1.1.3.2" xref="S3.E21.m2.3.3.1.1.1.1.1.1.1.1.1.3.2.cmml">𝐳</mi><mi id="S3.E21.m2.3.3.1.1.1.1.1.1.1.1.1.3.3" xref="S3.E21.m2.3.3.1.1.1.1.1.1.1.1.1.3.3.cmml">s</mi></msub><mo lspace="0em" rspace="0em" id="S3.E21.m2.3.3.1.1.1.1.1.1.1.1.1.2" xref="S3.E21.m2.3.3.1.1.1.1.1.1.1.1.1.2.cmml">​</mo><mrow id="S3.E21.m2.3.3.1.1.1.1.1.1.1.1.1.1.1" xref="S3.E21.m2.3.3.1.1.1.1.1.1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S3.E21.m2.3.3.1.1.1.1.1.1.1.1.1.1.1.2" xref="S3.E21.m2.3.3.1.1.1.1.1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="S3.E21.m2.3.3.1.1.1.1.1.1.1.1.1.1.1.1" xref="S3.E21.m2.3.3.1.1.1.1.1.1.1.1.1.1.1.1.cmml"><msub id="S3.E21.m2.3.3.1.1.1.1.1.1.1.1.1.1.1.1.2" xref="S3.E21.m2.3.3.1.1.1.1.1.1.1.1.1.1.1.1.2.cmml"><mi id="S3.E21.m2.3.3.1.1.1.1.1.1.1.1.1.1.1.1.2.2" xref="S3.E21.m2.3.3.1.1.1.1.1.1.1.1.1.1.1.1.2.2.cmml">𝐰</mi><mi id="S3.E21.m2.3.3.1.1.1.1.1.1.1.1.1.1.1.1.2.3" xref="S3.E21.m2.3.3.1.1.1.1.1.1.1.1.1.1.1.1.2.3.cmml">s</mi></msub><mo id="S3.E21.m2.3.3.1.1.1.1.1.1.1.1.1.1.1.1.1" xref="S3.E21.m2.3.3.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml">−</mo><mi id="S3.E21.m2.3.3.1.1.1.1.1.1.1.1.1.1.1.1.3" xref="S3.E21.m2.3.3.1.1.1.1.1.1.1.1.1.1.1.1.3.cmml">𝐰</mi></mrow><mo stretchy="false" id="S3.E21.m2.3.3.1.1.1.1.1.1.1.1.1.1.1.3" xref="S3.E21.m2.3.3.1.1.1.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S3.E21.m2.3.3.1.1.1.1.1.1.1.1.3" xref="S3.E21.m2.3.3.1.1.1.1.1.1.1.2.1.cmml">]</mo></mrow></mrow></mrow></mrow><mo rspace="1.167em" id="S3.E21.m2.3.3.1.1.2.3" xref="S3.E21.m2.3.3.1.1.3a.cmml">,</mo><mrow id="S3.E21.m2.3.3.1.1.2.2" xref="S3.E21.m2.3.3.1.1.2.2.cmml"><mi id="S3.E21.m2.3.3.1.1.2.2.3" xref="S3.E21.m2.3.3.1.1.2.2.3.cmml">𝐰</mi><mo id="S3.E21.m2.3.3.1.1.2.2.2" xref="S3.E21.m2.3.3.1.1.2.2.2.cmml">=</mo><mrow id="S3.E21.m2.3.3.1.1.2.2.1" xref="S3.E21.m2.3.3.1.1.2.2.1.cmml"><msub id="S3.E21.m2.3.3.1.1.2.2.1.3" xref="S3.E21.m2.3.3.1.1.2.2.1.3.cmml"><mi id="S3.E21.m2.3.3.1.1.2.2.1.3.2" xref="S3.E21.m2.3.3.1.1.2.2.1.3.2.cmml">𝔼</mi><mrow id="S3.E21.m2.2.2.1" xref="S3.E21.m2.2.2.1.cmml"><msub id="S3.E21.m2.2.2.1.3" xref="S3.E21.m2.2.2.1.3.cmml"><mi id="S3.E21.m2.2.2.1.3.2" xref="S3.E21.m2.2.2.1.3.2.cmml">q</mi><msub id="S3.E21.m2.2.2.1.3.3" xref="S3.E21.m2.2.2.1.3.3.cmml"><mi id="S3.E21.m2.2.2.1.3.3.2" xref="S3.E21.m2.2.2.1.3.3.2.cmml">𝝅</mi><mrow id="S3.E21.m2.2.2.1.3.3.3" xref="S3.E21.m2.2.2.1.3.3.3.cmml"><mn id="S3.E21.m2.2.2.1.3.3.3.2" xref="S3.E21.m2.2.2.1.3.3.3.2.cmml">1</mn><mo lspace="0.278em" rspace="0.278em" id="S3.E21.m2.2.2.1.3.3.3.1" xref="S3.E21.m2.2.2.1.3.3.3.1.cmml">:</mo><mi id="S3.E21.m2.2.2.1.3.3.3.3" xref="S3.E21.m2.2.2.1.3.3.3.3.cmml">S</mi></mrow></msub></msub><mo lspace="0em" rspace="0em" id="S3.E21.m2.2.2.1.2" xref="S3.E21.m2.2.2.1.2.cmml">​</mo><mrow id="S3.E21.m2.2.2.1.1.1" xref="S3.E21.m2.2.2.1.1.1.1.cmml"><mo stretchy="false" id="S3.E21.m2.2.2.1.1.1.2" xref="S3.E21.m2.2.2.1.1.1.1.cmml">(</mo><msub id="S3.E21.m2.2.2.1.1.1.1" xref="S3.E21.m2.2.2.1.1.1.1.cmml"><mi id="S3.E21.m2.2.2.1.1.1.1.2" xref="S3.E21.m2.2.2.1.1.1.1.2.cmml">𝐳</mi><mrow id="S3.E21.m2.2.2.1.1.1.1.3" xref="S3.E21.m2.2.2.1.1.1.1.3.cmml"><mn id="S3.E21.m2.2.2.1.1.1.1.3.2" xref="S3.E21.m2.2.2.1.1.1.1.3.2.cmml">1</mn><mo lspace="0.278em" rspace="0.278em" id="S3.E21.m2.2.2.1.1.1.1.3.1" xref="S3.E21.m2.2.2.1.1.1.1.3.1.cmml">:</mo><mi id="S3.E21.m2.2.2.1.1.1.1.3.3" xref="S3.E21.m2.2.2.1.1.1.1.3.3.cmml">S</mi></mrow></msub><mo stretchy="false" id="S3.E21.m2.2.2.1.1.1.3" xref="S3.E21.m2.2.2.1.1.1.1.cmml">)</mo></mrow></mrow></msub><mo lspace="0em" rspace="0em" id="S3.E21.m2.3.3.1.1.2.2.1.2" xref="S3.E21.m2.3.3.1.1.2.2.1.2.cmml">​</mo><mrow id="S3.E21.m2.3.3.1.1.2.2.1.1.1" xref="S3.E21.m2.3.3.1.1.2.2.1.1.2.cmml"><mo id="S3.E21.m2.3.3.1.1.2.2.1.1.1.2" xref="S3.E21.m2.3.3.1.1.2.2.1.1.2.1.cmml">[</mo><mrow id="S3.E21.m2.3.3.1.1.2.2.1.1.1.1" xref="S3.E21.m2.3.3.1.1.2.2.1.1.1.1.cmml"><mstyle displaystyle="true" id="S3.E21.m2.3.3.1.1.2.2.1.1.1.1.2" xref="S3.E21.m2.3.3.1.1.2.2.1.1.1.1.2.cmml"><mfrac id="S3.E21.m2.3.3.1.1.2.2.1.1.1.1.2a" xref="S3.E21.m2.3.3.1.1.2.2.1.1.1.1.2.cmml"><mn id="S3.E21.m2.3.3.1.1.2.2.1.1.1.1.2.2" xref="S3.E21.m2.3.3.1.1.2.2.1.1.1.1.2.2.cmml">1</mn><mrow id="S3.E21.m2.3.3.1.1.2.2.1.1.1.1.2.3" xref="S3.E21.m2.3.3.1.1.2.2.1.1.1.1.2.3.cmml"><msub id="S3.E21.m2.3.3.1.1.2.2.1.1.1.1.2.3.1" xref="S3.E21.m2.3.3.1.1.2.2.1.1.1.1.2.3.1.cmml"><mo id="S3.E21.m2.3.3.1.1.2.2.1.1.1.1.2.3.1.2" xref="S3.E21.m2.3.3.1.1.2.2.1.1.1.1.2.3.1.2.cmml">∑</mo><mi id="S3.E21.m2.3.3.1.1.2.2.1.1.1.1.2.3.1.3" xref="S3.E21.m2.3.3.1.1.2.2.1.1.1.1.2.3.1.3.cmml">j</mi></msub><msub id="S3.E21.m2.3.3.1.1.2.2.1.1.1.1.2.3.2" xref="S3.E21.m2.3.3.1.1.2.2.1.1.1.1.2.3.2.cmml"><mi id="S3.E21.m2.3.3.1.1.2.2.1.1.1.1.2.3.2.2" xref="S3.E21.m2.3.3.1.1.2.2.1.1.1.1.2.3.2.2.cmml">𝐳</mi><mi id="S3.E21.m2.3.3.1.1.2.2.1.1.1.1.2.3.2.3" xref="S3.E21.m2.3.3.1.1.2.2.1.1.1.1.2.3.2.3.cmml">j</mi></msub></mrow></mfrac></mstyle><mo lspace="0em" rspace="0em" id="S3.E21.m2.3.3.1.1.2.2.1.1.1.1.1" xref="S3.E21.m2.3.3.1.1.2.2.1.1.1.1.1.cmml">​</mo><mrow id="S3.E21.m2.3.3.1.1.2.2.1.1.1.1.3" xref="S3.E21.m2.3.3.1.1.2.2.1.1.1.1.3.cmml"><mstyle displaystyle="true" id="S3.E21.m2.3.3.1.1.2.2.1.1.1.1.3.1" xref="S3.E21.m2.3.3.1.1.2.2.1.1.1.1.3.1.cmml"><munder id="S3.E21.m2.3.3.1.1.2.2.1.1.1.1.3.1a" xref="S3.E21.m2.3.3.1.1.2.2.1.1.1.1.3.1.cmml"><mo movablelimits="false" id="S3.E21.m2.3.3.1.1.2.2.1.1.1.1.3.1.2" xref="S3.E21.m2.3.3.1.1.2.2.1.1.1.1.3.1.2.cmml">∑</mo><mi id="S3.E21.m2.3.3.1.1.2.2.1.1.1.1.3.1.3" xref="S3.E21.m2.3.3.1.1.2.2.1.1.1.1.3.1.3.cmml">s</mi></munder></mstyle><mrow id="S3.E21.m2.3.3.1.1.2.2.1.1.1.1.3.2" xref="S3.E21.m2.3.3.1.1.2.2.1.1.1.1.3.2.cmml"><msub id="S3.E21.m2.3.3.1.1.2.2.1.1.1.1.3.2.2" xref="S3.E21.m2.3.3.1.1.2.2.1.1.1.1.3.2.2.cmml"><mi id="S3.E21.m2.3.3.1.1.2.2.1.1.1.1.3.2.2.2" xref="S3.E21.m2.3.3.1.1.2.2.1.1.1.1.3.2.2.2.cmml">𝐳</mi><mi id="S3.E21.m2.3.3.1.1.2.2.1.1.1.1.3.2.2.3" xref="S3.E21.m2.3.3.1.1.2.2.1.1.1.1.3.2.2.3.cmml">s</mi></msub><mo lspace="0em" rspace="0em" id="S3.E21.m2.3.3.1.1.2.2.1.1.1.1.3.2.1" xref="S3.E21.m2.3.3.1.1.2.2.1.1.1.1.3.2.1.cmml">​</mo><msub id="S3.E21.m2.3.3.1.1.2.2.1.1.1.1.3.2.3" xref="S3.E21.m2.3.3.1.1.2.2.1.1.1.1.3.2.3.cmml"><mi id="S3.E21.m2.3.3.1.1.2.2.1.1.1.1.3.2.3.2" xref="S3.E21.m2.3.3.1.1.2.2.1.1.1.1.3.2.3.2.cmml">𝐰</mi><mi id="S3.E21.m2.3.3.1.1.2.2.1.1.1.1.3.2.3.3" xref="S3.E21.m2.3.3.1.1.2.2.1.1.1.1.3.2.3.3.cmml">s</mi></msub></mrow></mrow></mrow><mo id="S3.E21.m2.3.3.1.1.2.2.1.1.1.3" xref="S3.E21.m2.3.3.1.1.2.2.1.1.2.1.cmml">]</mo></mrow></mrow></mrow></mrow><mo id="S3.E21.m2.3.3.1.2">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E21.m2.3b"><apply id="S3.E21.m2.3.3.1.1.3.cmml" xref="S3.E21.m2.3.3.1.1.2"><csymbol cd="ambiguous" id="S3.E21.m2.3.3.1.1.3a.cmml" xref="S3.E21.m2.3.3.1.1.2.3">formulae-sequence</csymbol><apply id="S3.E21.m2.3.3.1.1.1.1.cmml" xref="S3.E21.m2.3.3.1.1.1.1"><eq id="S3.E21.m2.3.3.1.1.1.1.2.cmml" xref="S3.E21.m2.3.3.1.1.1.1.2"></eq><csymbol cd="latexml" id="S3.E21.m2.3.3.1.1.1.1.3.cmml" xref="S3.E21.m2.3.3.1.1.1.1.3">absent</csymbol><apply id="S3.E21.m2.3.3.1.1.1.1.1.cmml" xref="S3.E21.m2.3.3.1.1.1.1.1"><apply id="S3.E21.m2.3.3.1.1.1.1.1.2.cmml" xref="S3.E21.m2.3.3.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.E21.m2.3.3.1.1.1.1.1.2.1.cmml" xref="S3.E21.m2.3.3.1.1.1.1.1.2">subscript</csymbol><sum id="S3.E21.m2.3.3.1.1.1.1.1.2.2.cmml" xref="S3.E21.m2.3.3.1.1.1.1.1.2.2"></sum><ci id="S3.E21.m2.3.3.1.1.1.1.1.2.3.cmml" xref="S3.E21.m2.3.3.1.1.1.1.1.2.3">𝑠</ci></apply><apply id="S3.E21.m2.3.3.1.1.1.1.1.1.cmml" xref="S3.E21.m2.3.3.1.1.1.1.1.1"><times id="S3.E21.m2.3.3.1.1.1.1.1.1.2.cmml" xref="S3.E21.m2.3.3.1.1.1.1.1.1.2"></times><ci id="S3.E21.m2.3.3.1.1.1.1.1.1.3.cmml" xref="S3.E21.m2.3.3.1.1.1.1.1.1.3">𝜆</ci><apply id="S3.E21.m2.3.3.1.1.1.1.1.1.4.cmml" xref="S3.E21.m2.3.3.1.1.1.1.1.1.4"><csymbol cd="ambiguous" id="S3.E21.m2.3.3.1.1.1.1.1.1.4.1.cmml" xref="S3.E21.m2.3.3.1.1.1.1.1.1.4">subscript</csymbol><ci id="S3.E21.m2.3.3.1.1.1.1.1.1.4.2.cmml" xref="S3.E21.m2.3.3.1.1.1.1.1.1.4.2">𝔼</ci><apply id="S3.E21.m2.1.1.1.cmml" xref="S3.E21.m2.1.1.1"><times id="S3.E21.m2.1.1.1.2.cmml" xref="S3.E21.m2.1.1.1.2"></times><apply id="S3.E21.m2.1.1.1.3.cmml" xref="S3.E21.m2.1.1.1.3"><csymbol cd="ambiguous" id="S3.E21.m2.1.1.1.3.1.cmml" xref="S3.E21.m2.1.1.1.3">subscript</csymbol><ci id="S3.E21.m2.1.1.1.3.2.cmml" xref="S3.E21.m2.1.1.1.3.2">𝑞</ci><apply id="S3.E21.m2.1.1.1.3.3.cmml" xref="S3.E21.m2.1.1.1.3.3"><csymbol cd="ambiguous" id="S3.E21.m2.1.1.1.3.3.1.cmml" xref="S3.E21.m2.1.1.1.3.3">subscript</csymbol><ci id="S3.E21.m2.1.1.1.3.3.2.cmml" xref="S3.E21.m2.1.1.1.3.3.2">𝝅</ci><ci id="S3.E21.m2.1.1.1.3.3.3.cmml" xref="S3.E21.m2.1.1.1.3.3.3">𝑠</ci></apply></apply><apply id="S3.E21.m2.1.1.1.1.1.1.cmml" xref="S3.E21.m2.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E21.m2.1.1.1.1.1.1.1.cmml" xref="S3.E21.m2.1.1.1.1.1">subscript</csymbol><ci id="S3.E21.m2.1.1.1.1.1.1.2.cmml" xref="S3.E21.m2.1.1.1.1.1.1.2">𝐳</ci><ci id="S3.E21.m2.1.1.1.1.1.1.3.cmml" xref="S3.E21.m2.1.1.1.1.1.1.3">𝑠</ci></apply></apply></apply><apply id="S3.E21.m2.3.3.1.1.1.1.1.1.1.2.cmml" xref="S3.E21.m2.3.3.1.1.1.1.1.1.1.1"><csymbol cd="latexml" id="S3.E21.m2.3.3.1.1.1.1.1.1.1.2.1.cmml" xref="S3.E21.m2.3.3.1.1.1.1.1.1.1.1.2">delimited-[]</csymbol><apply id="S3.E21.m2.3.3.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E21.m2.3.3.1.1.1.1.1.1.1.1.1"><times id="S3.E21.m2.3.3.1.1.1.1.1.1.1.1.1.2.cmml" xref="S3.E21.m2.3.3.1.1.1.1.1.1.1.1.1.2"></times><apply id="S3.E21.m2.3.3.1.1.1.1.1.1.1.1.1.3.cmml" xref="S3.E21.m2.3.3.1.1.1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.E21.m2.3.3.1.1.1.1.1.1.1.1.1.3.1.cmml" xref="S3.E21.m2.3.3.1.1.1.1.1.1.1.1.1.3">subscript</csymbol><ci id="S3.E21.m2.3.3.1.1.1.1.1.1.1.1.1.3.2.cmml" xref="S3.E21.m2.3.3.1.1.1.1.1.1.1.1.1.3.2">𝐳</ci><ci id="S3.E21.m2.3.3.1.1.1.1.1.1.1.1.1.3.3.cmml" xref="S3.E21.m2.3.3.1.1.1.1.1.1.1.1.1.3.3">𝑠</ci></apply><apply id="S3.E21.m2.3.3.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E21.m2.3.3.1.1.1.1.1.1.1.1.1.1.1"><minus id="S3.E21.m2.3.3.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E21.m2.3.3.1.1.1.1.1.1.1.1.1.1.1.1.1"></minus><apply id="S3.E21.m2.3.3.1.1.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S3.E21.m2.3.3.1.1.1.1.1.1.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.E21.m2.3.3.1.1.1.1.1.1.1.1.1.1.1.1.2.1.cmml" xref="S3.E21.m2.3.3.1.1.1.1.1.1.1.1.1.1.1.1.2">subscript</csymbol><ci id="S3.E21.m2.3.3.1.1.1.1.1.1.1.1.1.1.1.1.2.2.cmml" xref="S3.E21.m2.3.3.1.1.1.1.1.1.1.1.1.1.1.1.2.2">𝐰</ci><ci id="S3.E21.m2.3.3.1.1.1.1.1.1.1.1.1.1.1.1.2.3.cmml" xref="S3.E21.m2.3.3.1.1.1.1.1.1.1.1.1.1.1.1.2.3">𝑠</ci></apply><ci id="S3.E21.m2.3.3.1.1.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="S3.E21.m2.3.3.1.1.1.1.1.1.1.1.1.1.1.1.3">𝐰</ci></apply></apply></apply></apply></apply></apply><apply id="S3.E21.m2.3.3.1.1.2.2.cmml" xref="S3.E21.m2.3.3.1.1.2.2"><eq id="S3.E21.m2.3.3.1.1.2.2.2.cmml" xref="S3.E21.m2.3.3.1.1.2.2.2"></eq><ci id="S3.E21.m2.3.3.1.1.2.2.3.cmml" xref="S3.E21.m2.3.3.1.1.2.2.3">𝐰</ci><apply id="S3.E21.m2.3.3.1.1.2.2.1.cmml" xref="S3.E21.m2.3.3.1.1.2.2.1"><times id="S3.E21.m2.3.3.1.1.2.2.1.2.cmml" xref="S3.E21.m2.3.3.1.1.2.2.1.2"></times><apply id="S3.E21.m2.3.3.1.1.2.2.1.3.cmml" xref="S3.E21.m2.3.3.1.1.2.2.1.3"><csymbol cd="ambiguous" id="S3.E21.m2.3.3.1.1.2.2.1.3.1.cmml" xref="S3.E21.m2.3.3.1.1.2.2.1.3">subscript</csymbol><ci id="S3.E21.m2.3.3.1.1.2.2.1.3.2.cmml" xref="S3.E21.m2.3.3.1.1.2.2.1.3.2">𝔼</ci><apply id="S3.E21.m2.2.2.1.cmml" xref="S3.E21.m2.2.2.1"><times id="S3.E21.m2.2.2.1.2.cmml" xref="S3.E21.m2.2.2.1.2"></times><apply id="S3.E21.m2.2.2.1.3.cmml" xref="S3.E21.m2.2.2.1.3"><csymbol cd="ambiguous" id="S3.E21.m2.2.2.1.3.1.cmml" xref="S3.E21.m2.2.2.1.3">subscript</csymbol><ci id="S3.E21.m2.2.2.1.3.2.cmml" xref="S3.E21.m2.2.2.1.3.2">𝑞</ci><apply id="S3.E21.m2.2.2.1.3.3.cmml" xref="S3.E21.m2.2.2.1.3.3"><csymbol cd="ambiguous" id="S3.E21.m2.2.2.1.3.3.1.cmml" xref="S3.E21.m2.2.2.1.3.3">subscript</csymbol><ci id="S3.E21.m2.2.2.1.3.3.2.cmml" xref="S3.E21.m2.2.2.1.3.3.2">𝝅</ci><apply id="S3.E21.m2.2.2.1.3.3.3.cmml" xref="S3.E21.m2.2.2.1.3.3.3"><ci id="S3.E21.m2.2.2.1.3.3.3.1.cmml" xref="S3.E21.m2.2.2.1.3.3.3.1">:</ci><cn type="integer" id="S3.E21.m2.2.2.1.3.3.3.2.cmml" xref="S3.E21.m2.2.2.1.3.3.3.2">1</cn><ci id="S3.E21.m2.2.2.1.3.3.3.3.cmml" xref="S3.E21.m2.2.2.1.3.3.3.3">𝑆</ci></apply></apply></apply><apply id="S3.E21.m2.2.2.1.1.1.1.cmml" xref="S3.E21.m2.2.2.1.1.1"><csymbol cd="ambiguous" id="S3.E21.m2.2.2.1.1.1.1.1.cmml" xref="S3.E21.m2.2.2.1.1.1">subscript</csymbol><ci id="S3.E21.m2.2.2.1.1.1.1.2.cmml" xref="S3.E21.m2.2.2.1.1.1.1.2">𝐳</ci><apply id="S3.E21.m2.2.2.1.1.1.1.3.cmml" xref="S3.E21.m2.2.2.1.1.1.1.3"><ci id="S3.E21.m2.2.2.1.1.1.1.3.1.cmml" xref="S3.E21.m2.2.2.1.1.1.1.3.1">:</ci><cn type="integer" id="S3.E21.m2.2.2.1.1.1.1.3.2.cmml" xref="S3.E21.m2.2.2.1.1.1.1.3.2">1</cn><ci id="S3.E21.m2.2.2.1.1.1.1.3.3.cmml" xref="S3.E21.m2.2.2.1.1.1.1.3.3">𝑆</ci></apply></apply></apply></apply><apply id="S3.E21.m2.3.3.1.1.2.2.1.1.2.cmml" xref="S3.E21.m2.3.3.1.1.2.2.1.1.1"><csymbol cd="latexml" id="S3.E21.m2.3.3.1.1.2.2.1.1.2.1.cmml" xref="S3.E21.m2.3.3.1.1.2.2.1.1.1.2">delimited-[]</csymbol><apply id="S3.E21.m2.3.3.1.1.2.2.1.1.1.1.cmml" xref="S3.E21.m2.3.3.1.1.2.2.1.1.1.1"><times id="S3.E21.m2.3.3.1.1.2.2.1.1.1.1.1.cmml" xref="S3.E21.m2.3.3.1.1.2.2.1.1.1.1.1"></times><apply id="S3.E21.m2.3.3.1.1.2.2.1.1.1.1.2.cmml" xref="S3.E21.m2.3.3.1.1.2.2.1.1.1.1.2"><divide id="S3.E21.m2.3.3.1.1.2.2.1.1.1.1.2.1.cmml" xref="S3.E21.m2.3.3.1.1.2.2.1.1.1.1.2"></divide><cn type="integer" id="S3.E21.m2.3.3.1.1.2.2.1.1.1.1.2.2.cmml" xref="S3.E21.m2.3.3.1.1.2.2.1.1.1.1.2.2">1</cn><apply id="S3.E21.m2.3.3.1.1.2.2.1.1.1.1.2.3.cmml" xref="S3.E21.m2.3.3.1.1.2.2.1.1.1.1.2.3"><apply id="S3.E21.m2.3.3.1.1.2.2.1.1.1.1.2.3.1.cmml" xref="S3.E21.m2.3.3.1.1.2.2.1.1.1.1.2.3.1"><csymbol cd="ambiguous" id="S3.E21.m2.3.3.1.1.2.2.1.1.1.1.2.3.1.1.cmml" xref="S3.E21.m2.3.3.1.1.2.2.1.1.1.1.2.3.1">subscript</csymbol><sum id="S3.E21.m2.3.3.1.1.2.2.1.1.1.1.2.3.1.2.cmml" xref="S3.E21.m2.3.3.1.1.2.2.1.1.1.1.2.3.1.2"></sum><ci id="S3.E21.m2.3.3.1.1.2.2.1.1.1.1.2.3.1.3.cmml" xref="S3.E21.m2.3.3.1.1.2.2.1.1.1.1.2.3.1.3">𝑗</ci></apply><apply id="S3.E21.m2.3.3.1.1.2.2.1.1.1.1.2.3.2.cmml" xref="S3.E21.m2.3.3.1.1.2.2.1.1.1.1.2.3.2"><csymbol cd="ambiguous" id="S3.E21.m2.3.3.1.1.2.2.1.1.1.1.2.3.2.1.cmml" xref="S3.E21.m2.3.3.1.1.2.2.1.1.1.1.2.3.2">subscript</csymbol><ci id="S3.E21.m2.3.3.1.1.2.2.1.1.1.1.2.3.2.2.cmml" xref="S3.E21.m2.3.3.1.1.2.2.1.1.1.1.2.3.2.2">𝐳</ci><ci id="S3.E21.m2.3.3.1.1.2.2.1.1.1.1.2.3.2.3.cmml" xref="S3.E21.m2.3.3.1.1.2.2.1.1.1.1.2.3.2.3">𝑗</ci></apply></apply></apply><apply id="S3.E21.m2.3.3.1.1.2.2.1.1.1.1.3.cmml" xref="S3.E21.m2.3.3.1.1.2.2.1.1.1.1.3"><apply id="S3.E21.m2.3.3.1.1.2.2.1.1.1.1.3.1.cmml" xref="S3.E21.m2.3.3.1.1.2.2.1.1.1.1.3.1"><csymbol cd="ambiguous" id="S3.E21.m2.3.3.1.1.2.2.1.1.1.1.3.1.1.cmml" xref="S3.E21.m2.3.3.1.1.2.2.1.1.1.1.3.1">subscript</csymbol><sum id="S3.E21.m2.3.3.1.1.2.2.1.1.1.1.3.1.2.cmml" xref="S3.E21.m2.3.3.1.1.2.2.1.1.1.1.3.1.2"></sum><ci id="S3.E21.m2.3.3.1.1.2.2.1.1.1.1.3.1.3.cmml" xref="S3.E21.m2.3.3.1.1.2.2.1.1.1.1.3.1.3">𝑠</ci></apply><apply id="S3.E21.m2.3.3.1.1.2.2.1.1.1.1.3.2.cmml" xref="S3.E21.m2.3.3.1.1.2.2.1.1.1.1.3.2"><times id="S3.E21.m2.3.3.1.1.2.2.1.1.1.1.3.2.1.cmml" xref="S3.E21.m2.3.3.1.1.2.2.1.1.1.1.3.2.1"></times><apply id="S3.E21.m2.3.3.1.1.2.2.1.1.1.1.3.2.2.cmml" xref="S3.E21.m2.3.3.1.1.2.2.1.1.1.1.3.2.2"><csymbol cd="ambiguous" id="S3.E21.m2.3.3.1.1.2.2.1.1.1.1.3.2.2.1.cmml" xref="S3.E21.m2.3.3.1.1.2.2.1.1.1.1.3.2.2">subscript</csymbol><ci id="S3.E21.m2.3.3.1.1.2.2.1.1.1.1.3.2.2.2.cmml" xref="S3.E21.m2.3.3.1.1.2.2.1.1.1.1.3.2.2.2">𝐳</ci><ci id="S3.E21.m2.3.3.1.1.2.2.1.1.1.1.3.2.2.3.cmml" xref="S3.E21.m2.3.3.1.1.2.2.1.1.1.1.3.2.2.3">𝑠</ci></apply><apply id="S3.E21.m2.3.3.1.1.2.2.1.1.1.1.3.2.3.cmml" xref="S3.E21.m2.3.3.1.1.2.2.1.1.1.1.3.2.3"><csymbol cd="ambiguous" id="S3.E21.m2.3.3.1.1.2.2.1.1.1.1.3.2.3.1.cmml" xref="S3.E21.m2.3.3.1.1.2.2.1.1.1.1.3.2.3">subscript</csymbol><ci id="S3.E21.m2.3.3.1.1.2.2.1.1.1.1.3.2.3.2.cmml" xref="S3.E21.m2.3.3.1.1.2.2.1.1.1.1.3.2.3.2">𝐰</ci><ci id="S3.E21.m2.3.3.1.1.2.2.1.1.1.1.3.2.3.3.cmml" xref="S3.E21.m2.3.3.1.1.2.2.1.1.1.1.3.2.3.3">𝑠</ci></apply></apply></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E21.m2.3c">\displaystyle=\sum_{s}\lambda\mathbb{E}_{q_{\bm{\pi}_{s}}(\mathbf{z}_{s})}\left[\mathbf{z}_{s}(\mathbf{w}_{s}-\mathbf{w})\right],\quad\mathbf{w}=\mathbb{E}_{q_{\bm{\pi}_{1:S}}(\mathbf{z}_{1:S})}\left[\frac{1}{\sum_{j}\mathbf{z}_{j}}\sum_{s}\mathbf{z}_{s}\mathbf{w}_{s}\right],</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(21)</span></td>
</tr></tbody>
<tbody id="S3.E22"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math id="S3.E22.m1.1" class="ltx_Math" alttext="\displaystyle\frac{\partial\mathcal{L}}{\partial\bm{\theta}}" display="inline"><semantics id="S3.E22.m1.1a"><mstyle displaystyle="true" id="S3.E22.m1.1.1" xref="S3.E22.m1.1.1.cmml"><mfrac id="S3.E22.m1.1.1a" xref="S3.E22.m1.1.1.cmml"><mrow id="S3.E22.m1.1.1.2" xref="S3.E22.m1.1.1.2.cmml"><mo rspace="0em" id="S3.E22.m1.1.1.2.1" xref="S3.E22.m1.1.1.2.1.cmml">∂</mo><mi class="ltx_font_mathcaligraphic" id="S3.E22.m1.1.1.2.2" xref="S3.E22.m1.1.1.2.2.cmml">ℒ</mi></mrow><mrow id="S3.E22.m1.1.1.3" xref="S3.E22.m1.1.1.3.cmml"><mo rspace="0em" id="S3.E22.m1.1.1.3.1" xref="S3.E22.m1.1.1.3.1.cmml">∂</mo><mi id="S3.E22.m1.1.1.3.2" xref="S3.E22.m1.1.1.3.2.cmml">𝜽</mi></mrow></mfrac></mstyle><annotation-xml encoding="MathML-Content" id="S3.E22.m1.1b"><apply id="S3.E22.m1.1.1.cmml" xref="S3.E22.m1.1.1"><divide id="S3.E22.m1.1.1.1.cmml" xref="S3.E22.m1.1.1"></divide><apply id="S3.E22.m1.1.1.2.cmml" xref="S3.E22.m1.1.1.2"><partialdiff id="S3.E22.m1.1.1.2.1.cmml" xref="S3.E22.m1.1.1.2.1"></partialdiff><ci id="S3.E22.m1.1.1.2.2.cmml" xref="S3.E22.m1.1.1.2.2">ℒ</ci></apply><apply id="S3.E22.m1.1.1.3.cmml" xref="S3.E22.m1.1.1.3"><partialdiff id="S3.E22.m1.1.1.3.1.cmml" xref="S3.E22.m1.1.1.3.1"></partialdiff><ci id="S3.E22.m1.1.1.3.2.cmml" xref="S3.E22.m1.1.1.3.2">𝜽</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E22.m1.1c">\displaystyle\frac{\partial\mathcal{L}}{\partial\bm{\theta}}</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math id="S3.E22.m2.3" class="ltx_Math" alttext="\displaystyle=\sum_{s}\mathbb{E}_{q_{\bm{\pi}_{s}}(\mathbf{z}_{s})}\left[\frac{\mathbf{z}_{s}}{\bm{\theta}}-\frac{1-\mathbf{z}_{s}}{1-\bm{\theta}}\right],\quad\bm{\theta}=\frac{1}{S}\sum_{s}\mathbb{E}_{q_{\bm{\pi}_{s}}(\mathbf{z}_{s})}\left[\mathbf{z}_{s}\right]." display="inline"><semantics id="S3.E22.m2.3a"><mrow id="S3.E22.m2.3.3.1"><mrow id="S3.E22.m2.3.3.1.1.2" xref="S3.E22.m2.3.3.1.1.3.cmml"><mrow id="S3.E22.m2.3.3.1.1.1.1" xref="S3.E22.m2.3.3.1.1.1.1.cmml"><mi id="S3.E22.m2.3.3.1.1.1.1.3" xref="S3.E22.m2.3.3.1.1.1.1.3.cmml"></mi><mo id="S3.E22.m2.3.3.1.1.1.1.2" xref="S3.E22.m2.3.3.1.1.1.1.2.cmml">=</mo><mrow id="S3.E22.m2.3.3.1.1.1.1.1" xref="S3.E22.m2.3.3.1.1.1.1.1.cmml"><mstyle displaystyle="true" id="S3.E22.m2.3.3.1.1.1.1.1.2" xref="S3.E22.m2.3.3.1.1.1.1.1.2.cmml"><munder id="S3.E22.m2.3.3.1.1.1.1.1.2a" xref="S3.E22.m2.3.3.1.1.1.1.1.2.cmml"><mo movablelimits="false" id="S3.E22.m2.3.3.1.1.1.1.1.2.2" xref="S3.E22.m2.3.3.1.1.1.1.1.2.2.cmml">∑</mo><mi id="S3.E22.m2.3.3.1.1.1.1.1.2.3" xref="S3.E22.m2.3.3.1.1.1.1.1.2.3.cmml">s</mi></munder></mstyle><mrow id="S3.E22.m2.3.3.1.1.1.1.1.1" xref="S3.E22.m2.3.3.1.1.1.1.1.1.cmml"><msub id="S3.E22.m2.3.3.1.1.1.1.1.1.3" xref="S3.E22.m2.3.3.1.1.1.1.1.1.3.cmml"><mi id="S3.E22.m2.3.3.1.1.1.1.1.1.3.2" xref="S3.E22.m2.3.3.1.1.1.1.1.1.3.2.cmml">𝔼</mi><mrow id="S3.E22.m2.1.1.1" xref="S3.E22.m2.1.1.1.cmml"><msub id="S3.E22.m2.1.1.1.3" xref="S3.E22.m2.1.1.1.3.cmml"><mi id="S3.E22.m2.1.1.1.3.2" xref="S3.E22.m2.1.1.1.3.2.cmml">q</mi><msub id="S3.E22.m2.1.1.1.3.3" xref="S3.E22.m2.1.1.1.3.3.cmml"><mi id="S3.E22.m2.1.1.1.3.3.2" xref="S3.E22.m2.1.1.1.3.3.2.cmml">𝝅</mi><mi id="S3.E22.m2.1.1.1.3.3.3" xref="S3.E22.m2.1.1.1.3.3.3.cmml">s</mi></msub></msub><mo lspace="0em" rspace="0em" id="S3.E22.m2.1.1.1.2" xref="S3.E22.m2.1.1.1.2.cmml">​</mo><mrow id="S3.E22.m2.1.1.1.1.1" xref="S3.E22.m2.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S3.E22.m2.1.1.1.1.1.2" xref="S3.E22.m2.1.1.1.1.1.1.cmml">(</mo><msub id="S3.E22.m2.1.1.1.1.1.1" xref="S3.E22.m2.1.1.1.1.1.1.cmml"><mi id="S3.E22.m2.1.1.1.1.1.1.2" xref="S3.E22.m2.1.1.1.1.1.1.2.cmml">𝐳</mi><mi id="S3.E22.m2.1.1.1.1.1.1.3" xref="S3.E22.m2.1.1.1.1.1.1.3.cmml">s</mi></msub><mo stretchy="false" id="S3.E22.m2.1.1.1.1.1.3" xref="S3.E22.m2.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></msub><mo lspace="0em" rspace="0em" id="S3.E22.m2.3.3.1.1.1.1.1.1.2" xref="S3.E22.m2.3.3.1.1.1.1.1.1.2.cmml">​</mo><mrow id="S3.E22.m2.3.3.1.1.1.1.1.1.1.1" xref="S3.E22.m2.3.3.1.1.1.1.1.1.1.2.cmml"><mo id="S3.E22.m2.3.3.1.1.1.1.1.1.1.1.2" xref="S3.E22.m2.3.3.1.1.1.1.1.1.1.2.1.cmml">[</mo><mrow id="S3.E22.m2.3.3.1.1.1.1.1.1.1.1.1" xref="S3.E22.m2.3.3.1.1.1.1.1.1.1.1.1.cmml"><mstyle displaystyle="true" id="S3.E22.m2.3.3.1.1.1.1.1.1.1.1.1.2" xref="S3.E22.m2.3.3.1.1.1.1.1.1.1.1.1.2.cmml"><mfrac id="S3.E22.m2.3.3.1.1.1.1.1.1.1.1.1.2a" xref="S3.E22.m2.3.3.1.1.1.1.1.1.1.1.1.2.cmml"><msub id="S3.E22.m2.3.3.1.1.1.1.1.1.1.1.1.2.2" xref="S3.E22.m2.3.3.1.1.1.1.1.1.1.1.1.2.2.cmml"><mi id="S3.E22.m2.3.3.1.1.1.1.1.1.1.1.1.2.2.2" xref="S3.E22.m2.3.3.1.1.1.1.1.1.1.1.1.2.2.2.cmml">𝐳</mi><mi id="S3.E22.m2.3.3.1.1.1.1.1.1.1.1.1.2.2.3" xref="S3.E22.m2.3.3.1.1.1.1.1.1.1.1.1.2.2.3.cmml">s</mi></msub><mi id="S3.E22.m2.3.3.1.1.1.1.1.1.1.1.1.2.3" xref="S3.E22.m2.3.3.1.1.1.1.1.1.1.1.1.2.3.cmml">𝜽</mi></mfrac></mstyle><mo id="S3.E22.m2.3.3.1.1.1.1.1.1.1.1.1.1" xref="S3.E22.m2.3.3.1.1.1.1.1.1.1.1.1.1.cmml">−</mo><mstyle displaystyle="true" id="S3.E22.m2.3.3.1.1.1.1.1.1.1.1.1.3" xref="S3.E22.m2.3.3.1.1.1.1.1.1.1.1.1.3.cmml"><mfrac id="S3.E22.m2.3.3.1.1.1.1.1.1.1.1.1.3a" xref="S3.E22.m2.3.3.1.1.1.1.1.1.1.1.1.3.cmml"><mrow id="S3.E22.m2.3.3.1.1.1.1.1.1.1.1.1.3.2" xref="S3.E22.m2.3.3.1.1.1.1.1.1.1.1.1.3.2.cmml"><mn id="S3.E22.m2.3.3.1.1.1.1.1.1.1.1.1.3.2.2" xref="S3.E22.m2.3.3.1.1.1.1.1.1.1.1.1.3.2.2.cmml">1</mn><mo id="S3.E22.m2.3.3.1.1.1.1.1.1.1.1.1.3.2.1" xref="S3.E22.m2.3.3.1.1.1.1.1.1.1.1.1.3.2.1.cmml">−</mo><msub id="S3.E22.m2.3.3.1.1.1.1.1.1.1.1.1.3.2.3" xref="S3.E22.m2.3.3.1.1.1.1.1.1.1.1.1.3.2.3.cmml"><mi id="S3.E22.m2.3.3.1.1.1.1.1.1.1.1.1.3.2.3.2" xref="S3.E22.m2.3.3.1.1.1.1.1.1.1.1.1.3.2.3.2.cmml">𝐳</mi><mi id="S3.E22.m2.3.3.1.1.1.1.1.1.1.1.1.3.2.3.3" xref="S3.E22.m2.3.3.1.1.1.1.1.1.1.1.1.3.2.3.3.cmml">s</mi></msub></mrow><mrow id="S3.E22.m2.3.3.1.1.1.1.1.1.1.1.1.3.3" xref="S3.E22.m2.3.3.1.1.1.1.1.1.1.1.1.3.3.cmml"><mn id="S3.E22.m2.3.3.1.1.1.1.1.1.1.1.1.3.3.2" xref="S3.E22.m2.3.3.1.1.1.1.1.1.1.1.1.3.3.2.cmml">1</mn><mo id="S3.E22.m2.3.3.1.1.1.1.1.1.1.1.1.3.3.1" xref="S3.E22.m2.3.3.1.1.1.1.1.1.1.1.1.3.3.1.cmml">−</mo><mi id="S3.E22.m2.3.3.1.1.1.1.1.1.1.1.1.3.3.3" xref="S3.E22.m2.3.3.1.1.1.1.1.1.1.1.1.3.3.3.cmml">𝜽</mi></mrow></mfrac></mstyle></mrow><mo id="S3.E22.m2.3.3.1.1.1.1.1.1.1.1.3" xref="S3.E22.m2.3.3.1.1.1.1.1.1.1.2.1.cmml">]</mo></mrow></mrow></mrow></mrow><mo rspace="1.167em" id="S3.E22.m2.3.3.1.1.2.3" xref="S3.E22.m2.3.3.1.1.3a.cmml">,</mo><mrow id="S3.E22.m2.3.3.1.1.2.2" xref="S3.E22.m2.3.3.1.1.2.2.cmml"><mi id="S3.E22.m2.3.3.1.1.2.2.3" xref="S3.E22.m2.3.3.1.1.2.2.3.cmml">𝜽</mi><mo id="S3.E22.m2.3.3.1.1.2.2.2" xref="S3.E22.m2.3.3.1.1.2.2.2.cmml">=</mo><mrow id="S3.E22.m2.3.3.1.1.2.2.1" xref="S3.E22.m2.3.3.1.1.2.2.1.cmml"><mstyle displaystyle="true" id="S3.E22.m2.3.3.1.1.2.2.1.3" xref="S3.E22.m2.3.3.1.1.2.2.1.3.cmml"><mfrac id="S3.E22.m2.3.3.1.1.2.2.1.3a" xref="S3.E22.m2.3.3.1.1.2.2.1.3.cmml"><mn id="S3.E22.m2.3.3.1.1.2.2.1.3.2" xref="S3.E22.m2.3.3.1.1.2.2.1.3.2.cmml">1</mn><mi id="S3.E22.m2.3.3.1.1.2.2.1.3.3" xref="S3.E22.m2.3.3.1.1.2.2.1.3.3.cmml">S</mi></mfrac></mstyle><mo lspace="0em" rspace="0em" id="S3.E22.m2.3.3.1.1.2.2.1.2" xref="S3.E22.m2.3.3.1.1.2.2.1.2.cmml">​</mo><mrow id="S3.E22.m2.3.3.1.1.2.2.1.1" xref="S3.E22.m2.3.3.1.1.2.2.1.1.cmml"><mstyle displaystyle="true" id="S3.E22.m2.3.3.1.1.2.2.1.1.2" xref="S3.E22.m2.3.3.1.1.2.2.1.1.2.cmml"><munder id="S3.E22.m2.3.3.1.1.2.2.1.1.2a" xref="S3.E22.m2.3.3.1.1.2.2.1.1.2.cmml"><mo movablelimits="false" id="S3.E22.m2.3.3.1.1.2.2.1.1.2.2" xref="S3.E22.m2.3.3.1.1.2.2.1.1.2.2.cmml">∑</mo><mi id="S3.E22.m2.3.3.1.1.2.2.1.1.2.3" xref="S3.E22.m2.3.3.1.1.2.2.1.1.2.3.cmml">s</mi></munder></mstyle><mrow id="S3.E22.m2.3.3.1.1.2.2.1.1.1" xref="S3.E22.m2.3.3.1.1.2.2.1.1.1.cmml"><msub id="S3.E22.m2.3.3.1.1.2.2.1.1.1.3" xref="S3.E22.m2.3.3.1.1.2.2.1.1.1.3.cmml"><mi id="S3.E22.m2.3.3.1.1.2.2.1.1.1.3.2" xref="S3.E22.m2.3.3.1.1.2.2.1.1.1.3.2.cmml">𝔼</mi><mrow id="S3.E22.m2.2.2.1" xref="S3.E22.m2.2.2.1.cmml"><msub id="S3.E22.m2.2.2.1.3" xref="S3.E22.m2.2.2.1.3.cmml"><mi id="S3.E22.m2.2.2.1.3.2" xref="S3.E22.m2.2.2.1.3.2.cmml">q</mi><msub id="S3.E22.m2.2.2.1.3.3" xref="S3.E22.m2.2.2.1.3.3.cmml"><mi id="S3.E22.m2.2.2.1.3.3.2" xref="S3.E22.m2.2.2.1.3.3.2.cmml">𝝅</mi><mi id="S3.E22.m2.2.2.1.3.3.3" xref="S3.E22.m2.2.2.1.3.3.3.cmml">s</mi></msub></msub><mo lspace="0em" rspace="0em" id="S3.E22.m2.2.2.1.2" xref="S3.E22.m2.2.2.1.2.cmml">​</mo><mrow id="S3.E22.m2.2.2.1.1.1" xref="S3.E22.m2.2.2.1.1.1.1.cmml"><mo stretchy="false" id="S3.E22.m2.2.2.1.1.1.2" xref="S3.E22.m2.2.2.1.1.1.1.cmml">(</mo><msub id="S3.E22.m2.2.2.1.1.1.1" xref="S3.E22.m2.2.2.1.1.1.1.cmml"><mi id="S3.E22.m2.2.2.1.1.1.1.2" xref="S3.E22.m2.2.2.1.1.1.1.2.cmml">𝐳</mi><mi id="S3.E22.m2.2.2.1.1.1.1.3" xref="S3.E22.m2.2.2.1.1.1.1.3.cmml">s</mi></msub><mo stretchy="false" id="S3.E22.m2.2.2.1.1.1.3" xref="S3.E22.m2.2.2.1.1.1.1.cmml">)</mo></mrow></mrow></msub><mo lspace="0em" rspace="0em" id="S3.E22.m2.3.3.1.1.2.2.1.1.1.2" xref="S3.E22.m2.3.3.1.1.2.2.1.1.1.2.cmml">​</mo><mrow id="S3.E22.m2.3.3.1.1.2.2.1.1.1.1.1" xref="S3.E22.m2.3.3.1.1.2.2.1.1.1.1.2.cmml"><mo id="S3.E22.m2.3.3.1.1.2.2.1.1.1.1.1.2" xref="S3.E22.m2.3.3.1.1.2.2.1.1.1.1.2.1.cmml">[</mo><msub id="S3.E22.m2.3.3.1.1.2.2.1.1.1.1.1.1" xref="S3.E22.m2.3.3.1.1.2.2.1.1.1.1.1.1.cmml"><mi id="S3.E22.m2.3.3.1.1.2.2.1.1.1.1.1.1.2" xref="S3.E22.m2.3.3.1.1.2.2.1.1.1.1.1.1.2.cmml">𝐳</mi><mi id="S3.E22.m2.3.3.1.1.2.2.1.1.1.1.1.1.3" xref="S3.E22.m2.3.3.1.1.2.2.1.1.1.1.1.1.3.cmml">s</mi></msub><mo id="S3.E22.m2.3.3.1.1.2.2.1.1.1.1.1.3" xref="S3.E22.m2.3.3.1.1.2.2.1.1.1.1.2.1.cmml">]</mo></mrow></mrow></mrow></mrow></mrow></mrow><mo lspace="0em" id="S3.E22.m2.3.3.1.2">.</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E22.m2.3b"><apply id="S3.E22.m2.3.3.1.1.3.cmml" xref="S3.E22.m2.3.3.1.1.2"><csymbol cd="ambiguous" id="S3.E22.m2.3.3.1.1.3a.cmml" xref="S3.E22.m2.3.3.1.1.2.3">formulae-sequence</csymbol><apply id="S3.E22.m2.3.3.1.1.1.1.cmml" xref="S3.E22.m2.3.3.1.1.1.1"><eq id="S3.E22.m2.3.3.1.1.1.1.2.cmml" xref="S3.E22.m2.3.3.1.1.1.1.2"></eq><csymbol cd="latexml" id="S3.E22.m2.3.3.1.1.1.1.3.cmml" xref="S3.E22.m2.3.3.1.1.1.1.3">absent</csymbol><apply id="S3.E22.m2.3.3.1.1.1.1.1.cmml" xref="S3.E22.m2.3.3.1.1.1.1.1"><apply id="S3.E22.m2.3.3.1.1.1.1.1.2.cmml" xref="S3.E22.m2.3.3.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.E22.m2.3.3.1.1.1.1.1.2.1.cmml" xref="S3.E22.m2.3.3.1.1.1.1.1.2">subscript</csymbol><sum id="S3.E22.m2.3.3.1.1.1.1.1.2.2.cmml" xref="S3.E22.m2.3.3.1.1.1.1.1.2.2"></sum><ci id="S3.E22.m2.3.3.1.1.1.1.1.2.3.cmml" xref="S3.E22.m2.3.3.1.1.1.1.1.2.3">𝑠</ci></apply><apply id="S3.E22.m2.3.3.1.1.1.1.1.1.cmml" xref="S3.E22.m2.3.3.1.1.1.1.1.1"><times id="S3.E22.m2.3.3.1.1.1.1.1.1.2.cmml" xref="S3.E22.m2.3.3.1.1.1.1.1.1.2"></times><apply id="S3.E22.m2.3.3.1.1.1.1.1.1.3.cmml" xref="S3.E22.m2.3.3.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.E22.m2.3.3.1.1.1.1.1.1.3.1.cmml" xref="S3.E22.m2.3.3.1.1.1.1.1.1.3">subscript</csymbol><ci id="S3.E22.m2.3.3.1.1.1.1.1.1.3.2.cmml" xref="S3.E22.m2.3.3.1.1.1.1.1.1.3.2">𝔼</ci><apply id="S3.E22.m2.1.1.1.cmml" xref="S3.E22.m2.1.1.1"><times id="S3.E22.m2.1.1.1.2.cmml" xref="S3.E22.m2.1.1.1.2"></times><apply id="S3.E22.m2.1.1.1.3.cmml" xref="S3.E22.m2.1.1.1.3"><csymbol cd="ambiguous" id="S3.E22.m2.1.1.1.3.1.cmml" xref="S3.E22.m2.1.1.1.3">subscript</csymbol><ci id="S3.E22.m2.1.1.1.3.2.cmml" xref="S3.E22.m2.1.1.1.3.2">𝑞</ci><apply id="S3.E22.m2.1.1.1.3.3.cmml" xref="S3.E22.m2.1.1.1.3.3"><csymbol cd="ambiguous" id="S3.E22.m2.1.1.1.3.3.1.cmml" xref="S3.E22.m2.1.1.1.3.3">subscript</csymbol><ci id="S3.E22.m2.1.1.1.3.3.2.cmml" xref="S3.E22.m2.1.1.1.3.3.2">𝝅</ci><ci id="S3.E22.m2.1.1.1.3.3.3.cmml" xref="S3.E22.m2.1.1.1.3.3.3">𝑠</ci></apply></apply><apply id="S3.E22.m2.1.1.1.1.1.1.cmml" xref="S3.E22.m2.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E22.m2.1.1.1.1.1.1.1.cmml" xref="S3.E22.m2.1.1.1.1.1">subscript</csymbol><ci id="S3.E22.m2.1.1.1.1.1.1.2.cmml" xref="S3.E22.m2.1.1.1.1.1.1.2">𝐳</ci><ci id="S3.E22.m2.1.1.1.1.1.1.3.cmml" xref="S3.E22.m2.1.1.1.1.1.1.3">𝑠</ci></apply></apply></apply><apply id="S3.E22.m2.3.3.1.1.1.1.1.1.1.2.cmml" xref="S3.E22.m2.3.3.1.1.1.1.1.1.1.1"><csymbol cd="latexml" id="S3.E22.m2.3.3.1.1.1.1.1.1.1.2.1.cmml" xref="S3.E22.m2.3.3.1.1.1.1.1.1.1.1.2">delimited-[]</csymbol><apply id="S3.E22.m2.3.3.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E22.m2.3.3.1.1.1.1.1.1.1.1.1"><minus id="S3.E22.m2.3.3.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E22.m2.3.3.1.1.1.1.1.1.1.1.1.1"></minus><apply id="S3.E22.m2.3.3.1.1.1.1.1.1.1.1.1.2.cmml" xref="S3.E22.m2.3.3.1.1.1.1.1.1.1.1.1.2"><divide id="S3.E22.m2.3.3.1.1.1.1.1.1.1.1.1.2.1.cmml" xref="S3.E22.m2.3.3.1.1.1.1.1.1.1.1.1.2"></divide><apply id="S3.E22.m2.3.3.1.1.1.1.1.1.1.1.1.2.2.cmml" xref="S3.E22.m2.3.3.1.1.1.1.1.1.1.1.1.2.2"><csymbol cd="ambiguous" id="S3.E22.m2.3.3.1.1.1.1.1.1.1.1.1.2.2.1.cmml" xref="S3.E22.m2.3.3.1.1.1.1.1.1.1.1.1.2.2">subscript</csymbol><ci id="S3.E22.m2.3.3.1.1.1.1.1.1.1.1.1.2.2.2.cmml" xref="S3.E22.m2.3.3.1.1.1.1.1.1.1.1.1.2.2.2">𝐳</ci><ci id="S3.E22.m2.3.3.1.1.1.1.1.1.1.1.1.2.2.3.cmml" xref="S3.E22.m2.3.3.1.1.1.1.1.1.1.1.1.2.2.3">𝑠</ci></apply><ci id="S3.E22.m2.3.3.1.1.1.1.1.1.1.1.1.2.3.cmml" xref="S3.E22.m2.3.3.1.1.1.1.1.1.1.1.1.2.3">𝜽</ci></apply><apply id="S3.E22.m2.3.3.1.1.1.1.1.1.1.1.1.3.cmml" xref="S3.E22.m2.3.3.1.1.1.1.1.1.1.1.1.3"><divide id="S3.E22.m2.3.3.1.1.1.1.1.1.1.1.1.3.1.cmml" xref="S3.E22.m2.3.3.1.1.1.1.1.1.1.1.1.3"></divide><apply id="S3.E22.m2.3.3.1.1.1.1.1.1.1.1.1.3.2.cmml" xref="S3.E22.m2.3.3.1.1.1.1.1.1.1.1.1.3.2"><minus id="S3.E22.m2.3.3.1.1.1.1.1.1.1.1.1.3.2.1.cmml" xref="S3.E22.m2.3.3.1.1.1.1.1.1.1.1.1.3.2.1"></minus><cn type="integer" id="S3.E22.m2.3.3.1.1.1.1.1.1.1.1.1.3.2.2.cmml" xref="S3.E22.m2.3.3.1.1.1.1.1.1.1.1.1.3.2.2">1</cn><apply id="S3.E22.m2.3.3.1.1.1.1.1.1.1.1.1.3.2.3.cmml" xref="S3.E22.m2.3.3.1.1.1.1.1.1.1.1.1.3.2.3"><csymbol cd="ambiguous" id="S3.E22.m2.3.3.1.1.1.1.1.1.1.1.1.3.2.3.1.cmml" xref="S3.E22.m2.3.3.1.1.1.1.1.1.1.1.1.3.2.3">subscript</csymbol><ci id="S3.E22.m2.3.3.1.1.1.1.1.1.1.1.1.3.2.3.2.cmml" xref="S3.E22.m2.3.3.1.1.1.1.1.1.1.1.1.3.2.3.2">𝐳</ci><ci id="S3.E22.m2.3.3.1.1.1.1.1.1.1.1.1.3.2.3.3.cmml" xref="S3.E22.m2.3.3.1.1.1.1.1.1.1.1.1.3.2.3.3">𝑠</ci></apply></apply><apply id="S3.E22.m2.3.3.1.1.1.1.1.1.1.1.1.3.3.cmml" xref="S3.E22.m2.3.3.1.1.1.1.1.1.1.1.1.3.3"><minus id="S3.E22.m2.3.3.1.1.1.1.1.1.1.1.1.3.3.1.cmml" xref="S3.E22.m2.3.3.1.1.1.1.1.1.1.1.1.3.3.1"></minus><cn type="integer" id="S3.E22.m2.3.3.1.1.1.1.1.1.1.1.1.3.3.2.cmml" xref="S3.E22.m2.3.3.1.1.1.1.1.1.1.1.1.3.3.2">1</cn><ci id="S3.E22.m2.3.3.1.1.1.1.1.1.1.1.1.3.3.3.cmml" xref="S3.E22.m2.3.3.1.1.1.1.1.1.1.1.1.3.3.3">𝜽</ci></apply></apply></apply></apply></apply></apply></apply><apply id="S3.E22.m2.3.3.1.1.2.2.cmml" xref="S3.E22.m2.3.3.1.1.2.2"><eq id="S3.E22.m2.3.3.1.1.2.2.2.cmml" xref="S3.E22.m2.3.3.1.1.2.2.2"></eq><ci id="S3.E22.m2.3.3.1.1.2.2.3.cmml" xref="S3.E22.m2.3.3.1.1.2.2.3">𝜽</ci><apply id="S3.E22.m2.3.3.1.1.2.2.1.cmml" xref="S3.E22.m2.3.3.1.1.2.2.1"><times id="S3.E22.m2.3.3.1.1.2.2.1.2.cmml" xref="S3.E22.m2.3.3.1.1.2.2.1.2"></times><apply id="S3.E22.m2.3.3.1.1.2.2.1.3.cmml" xref="S3.E22.m2.3.3.1.1.2.2.1.3"><divide id="S3.E22.m2.3.3.1.1.2.2.1.3.1.cmml" xref="S3.E22.m2.3.3.1.1.2.2.1.3"></divide><cn type="integer" id="S3.E22.m2.3.3.1.1.2.2.1.3.2.cmml" xref="S3.E22.m2.3.3.1.1.2.2.1.3.2">1</cn><ci id="S3.E22.m2.3.3.1.1.2.2.1.3.3.cmml" xref="S3.E22.m2.3.3.1.1.2.2.1.3.3">𝑆</ci></apply><apply id="S3.E22.m2.3.3.1.1.2.2.1.1.cmml" xref="S3.E22.m2.3.3.1.1.2.2.1.1"><apply id="S3.E22.m2.3.3.1.1.2.2.1.1.2.cmml" xref="S3.E22.m2.3.3.1.1.2.2.1.1.2"><csymbol cd="ambiguous" id="S3.E22.m2.3.3.1.1.2.2.1.1.2.1.cmml" xref="S3.E22.m2.3.3.1.1.2.2.1.1.2">subscript</csymbol><sum id="S3.E22.m2.3.3.1.1.2.2.1.1.2.2.cmml" xref="S3.E22.m2.3.3.1.1.2.2.1.1.2.2"></sum><ci id="S3.E22.m2.3.3.1.1.2.2.1.1.2.3.cmml" xref="S3.E22.m2.3.3.1.1.2.2.1.1.2.3">𝑠</ci></apply><apply id="S3.E22.m2.3.3.1.1.2.2.1.1.1.cmml" xref="S3.E22.m2.3.3.1.1.2.2.1.1.1"><times id="S3.E22.m2.3.3.1.1.2.2.1.1.1.2.cmml" xref="S3.E22.m2.3.3.1.1.2.2.1.1.1.2"></times><apply id="S3.E22.m2.3.3.1.1.2.2.1.1.1.3.cmml" xref="S3.E22.m2.3.3.1.1.2.2.1.1.1.3"><csymbol cd="ambiguous" id="S3.E22.m2.3.3.1.1.2.2.1.1.1.3.1.cmml" xref="S3.E22.m2.3.3.1.1.2.2.1.1.1.3">subscript</csymbol><ci id="S3.E22.m2.3.3.1.1.2.2.1.1.1.3.2.cmml" xref="S3.E22.m2.3.3.1.1.2.2.1.1.1.3.2">𝔼</ci><apply id="S3.E22.m2.2.2.1.cmml" xref="S3.E22.m2.2.2.1"><times id="S3.E22.m2.2.2.1.2.cmml" xref="S3.E22.m2.2.2.1.2"></times><apply id="S3.E22.m2.2.2.1.3.cmml" xref="S3.E22.m2.2.2.1.3"><csymbol cd="ambiguous" id="S3.E22.m2.2.2.1.3.1.cmml" xref="S3.E22.m2.2.2.1.3">subscript</csymbol><ci id="S3.E22.m2.2.2.1.3.2.cmml" xref="S3.E22.m2.2.2.1.3.2">𝑞</ci><apply id="S3.E22.m2.2.2.1.3.3.cmml" xref="S3.E22.m2.2.2.1.3.3"><csymbol cd="ambiguous" id="S3.E22.m2.2.2.1.3.3.1.cmml" xref="S3.E22.m2.2.2.1.3.3">subscript</csymbol><ci id="S3.E22.m2.2.2.1.3.3.2.cmml" xref="S3.E22.m2.2.2.1.3.3.2">𝝅</ci><ci id="S3.E22.m2.2.2.1.3.3.3.cmml" xref="S3.E22.m2.2.2.1.3.3.3">𝑠</ci></apply></apply><apply id="S3.E22.m2.2.2.1.1.1.1.cmml" xref="S3.E22.m2.2.2.1.1.1"><csymbol cd="ambiguous" id="S3.E22.m2.2.2.1.1.1.1.1.cmml" xref="S3.E22.m2.2.2.1.1.1">subscript</csymbol><ci id="S3.E22.m2.2.2.1.1.1.1.2.cmml" xref="S3.E22.m2.2.2.1.1.1.1.2">𝐳</ci><ci id="S3.E22.m2.2.2.1.1.1.1.3.cmml" xref="S3.E22.m2.2.2.1.1.1.1.3">𝑠</ci></apply></apply></apply><apply id="S3.E22.m2.3.3.1.1.2.2.1.1.1.1.2.cmml" xref="S3.E22.m2.3.3.1.1.2.2.1.1.1.1.1"><csymbol cd="latexml" id="S3.E22.m2.3.3.1.1.2.2.1.1.1.1.2.1.cmml" xref="S3.E22.m2.3.3.1.1.2.2.1.1.1.1.1.2">delimited-[]</csymbol><apply id="S3.E22.m2.3.3.1.1.2.2.1.1.1.1.1.1.cmml" xref="S3.E22.m2.3.3.1.1.2.2.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E22.m2.3.3.1.1.2.2.1.1.1.1.1.1.1.cmml" xref="S3.E22.m2.3.3.1.1.2.2.1.1.1.1.1.1">subscript</csymbol><ci id="S3.E22.m2.3.3.1.1.2.2.1.1.1.1.1.1.2.cmml" xref="S3.E22.m2.3.3.1.1.2.2.1.1.1.1.1.1.2">𝐳</ci><ci id="S3.E22.m2.3.3.1.1.2.2.1.1.1.1.1.1.3.cmml" xref="S3.E22.m2.3.3.1.1.2.2.1.1.1.1.1.1.3">𝑠</ci></apply></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E22.m2.3c">\displaystyle=\sum_{s}\mathbb{E}_{q_{\bm{\pi}_{s}}(\mathbf{z}_{s})}\left[\frac{\mathbf{z}_{s}}{\bm{\theta}}-\frac{1-\mathbf{z}_{s}}{1-\bm{\theta}}\right],\quad\bm{\theta}=\frac{1}{S}\sum_{s}\mathbb{E}_{q_{\bm{\pi}_{s}}(\mathbf{z}_{s})}\left[\mathbf{z}_{s}\right].</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(22)</span></td>
</tr></tbody>
</table>
<p id="S3.SS1.SSS0.Px1.p1.4" class="ltx_p">As a result, we can then communicate from the client only the subset of the local weights <math id="S3.SS1.SSS0.Px1.p1.1.m1.1" class="ltx_Math" alttext="\hat{\mathbf{w}}_{s}" display="inline"><semantics id="S3.SS1.SSS0.Px1.p1.1.m1.1a"><msub id="S3.SS1.SSS0.Px1.p1.1.m1.1.1" xref="S3.SS1.SSS0.Px1.p1.1.m1.1.1.cmml"><mover accent="true" id="S3.SS1.SSS0.Px1.p1.1.m1.1.1.2" xref="S3.SS1.SSS0.Px1.p1.1.m1.1.1.2.cmml"><mi id="S3.SS1.SSS0.Px1.p1.1.m1.1.1.2.2" xref="S3.SS1.SSS0.Px1.p1.1.m1.1.1.2.2.cmml">𝐰</mi><mo id="S3.SS1.SSS0.Px1.p1.1.m1.1.1.2.1" xref="S3.SS1.SSS0.Px1.p1.1.m1.1.1.2.1.cmml">^</mo></mover><mi id="S3.SS1.SSS0.Px1.p1.1.m1.1.1.3" xref="S3.SS1.SSS0.Px1.p1.1.m1.1.1.3.cmml">s</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS0.Px1.p1.1.m1.1b"><apply id="S3.SS1.SSS0.Px1.p1.1.m1.1.1.cmml" xref="S3.SS1.SSS0.Px1.p1.1.m1.1.1"><csymbol cd="ambiguous" id="S3.SS1.SSS0.Px1.p1.1.m1.1.1.1.cmml" xref="S3.SS1.SSS0.Px1.p1.1.m1.1.1">subscript</csymbol><apply id="S3.SS1.SSS0.Px1.p1.1.m1.1.1.2.cmml" xref="S3.SS1.SSS0.Px1.p1.1.m1.1.1.2"><ci id="S3.SS1.SSS0.Px1.p1.1.m1.1.1.2.1.cmml" xref="S3.SS1.SSS0.Px1.p1.1.m1.1.1.2.1">^</ci><ci id="S3.SS1.SSS0.Px1.p1.1.m1.1.1.2.2.cmml" xref="S3.SS1.SSS0.Px1.p1.1.m1.1.1.2.2">𝐰</ci></apply><ci id="S3.SS1.SSS0.Px1.p1.1.m1.1.1.3.cmml" xref="S3.SS1.SSS0.Px1.p1.1.m1.1.1.3">𝑠</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS0.Px1.p1.1.m1.1c">\hat{\mathbf{w}}_{s}</annotation></semantics></math> that are non-zero in <math id="S3.SS1.SSS0.Px1.p1.2.m2.2" class="ltx_Math" alttext="\mathbf{z}_{s}\sim q_{\bm{\pi}_{s}}(\mathbf{z}_{s}),\quad\hat{\mathbf{w}}_{s}=\mathbf{w}_{s}\odot\mathbf{z}_{s}" display="inline"><semantics id="S3.SS1.SSS0.Px1.p1.2.m2.2a"><mrow id="S3.SS1.SSS0.Px1.p1.2.m2.2.2.2" xref="S3.SS1.SSS0.Px1.p1.2.m2.2.2.3.cmml"><mrow id="S3.SS1.SSS0.Px1.p1.2.m2.1.1.1.1" xref="S3.SS1.SSS0.Px1.p1.2.m2.1.1.1.1.cmml"><msub id="S3.SS1.SSS0.Px1.p1.2.m2.1.1.1.1.3" xref="S3.SS1.SSS0.Px1.p1.2.m2.1.1.1.1.3.cmml"><mi id="S3.SS1.SSS0.Px1.p1.2.m2.1.1.1.1.3.2" xref="S3.SS1.SSS0.Px1.p1.2.m2.1.1.1.1.3.2.cmml">𝐳</mi><mi id="S3.SS1.SSS0.Px1.p1.2.m2.1.1.1.1.3.3" xref="S3.SS1.SSS0.Px1.p1.2.m2.1.1.1.1.3.3.cmml">s</mi></msub><mo id="S3.SS1.SSS0.Px1.p1.2.m2.1.1.1.1.2" xref="S3.SS1.SSS0.Px1.p1.2.m2.1.1.1.1.2.cmml">∼</mo><mrow id="S3.SS1.SSS0.Px1.p1.2.m2.1.1.1.1.1" xref="S3.SS1.SSS0.Px1.p1.2.m2.1.1.1.1.1.cmml"><msub id="S3.SS1.SSS0.Px1.p1.2.m2.1.1.1.1.1.3" xref="S3.SS1.SSS0.Px1.p1.2.m2.1.1.1.1.1.3.cmml"><mi id="S3.SS1.SSS0.Px1.p1.2.m2.1.1.1.1.1.3.2" xref="S3.SS1.SSS0.Px1.p1.2.m2.1.1.1.1.1.3.2.cmml">q</mi><msub id="S3.SS1.SSS0.Px1.p1.2.m2.1.1.1.1.1.3.3" xref="S3.SS1.SSS0.Px1.p1.2.m2.1.1.1.1.1.3.3.cmml"><mi id="S3.SS1.SSS0.Px1.p1.2.m2.1.1.1.1.1.3.3.2" xref="S3.SS1.SSS0.Px1.p1.2.m2.1.1.1.1.1.3.3.2.cmml">𝝅</mi><mi id="S3.SS1.SSS0.Px1.p1.2.m2.1.1.1.1.1.3.3.3" xref="S3.SS1.SSS0.Px1.p1.2.m2.1.1.1.1.1.3.3.3.cmml">s</mi></msub></msub><mo lspace="0em" rspace="0em" id="S3.SS1.SSS0.Px1.p1.2.m2.1.1.1.1.1.2" xref="S3.SS1.SSS0.Px1.p1.2.m2.1.1.1.1.1.2.cmml">​</mo><mrow id="S3.SS1.SSS0.Px1.p1.2.m2.1.1.1.1.1.1.1" xref="S3.SS1.SSS0.Px1.p1.2.m2.1.1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S3.SS1.SSS0.Px1.p1.2.m2.1.1.1.1.1.1.1.2" xref="S3.SS1.SSS0.Px1.p1.2.m2.1.1.1.1.1.1.1.1.cmml">(</mo><msub id="S3.SS1.SSS0.Px1.p1.2.m2.1.1.1.1.1.1.1.1" xref="S3.SS1.SSS0.Px1.p1.2.m2.1.1.1.1.1.1.1.1.cmml"><mi id="S3.SS1.SSS0.Px1.p1.2.m2.1.1.1.1.1.1.1.1.2" xref="S3.SS1.SSS0.Px1.p1.2.m2.1.1.1.1.1.1.1.1.2.cmml">𝐳</mi><mi id="S3.SS1.SSS0.Px1.p1.2.m2.1.1.1.1.1.1.1.1.3" xref="S3.SS1.SSS0.Px1.p1.2.m2.1.1.1.1.1.1.1.1.3.cmml">s</mi></msub><mo stretchy="false" id="S3.SS1.SSS0.Px1.p1.2.m2.1.1.1.1.1.1.1.3" xref="S3.SS1.SSS0.Px1.p1.2.m2.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><mo rspace="1.167em" id="S3.SS1.SSS0.Px1.p1.2.m2.2.2.2.3" xref="S3.SS1.SSS0.Px1.p1.2.m2.2.2.3a.cmml">,</mo><mrow id="S3.SS1.SSS0.Px1.p1.2.m2.2.2.2.2" xref="S3.SS1.SSS0.Px1.p1.2.m2.2.2.2.2.cmml"><msub id="S3.SS1.SSS0.Px1.p1.2.m2.2.2.2.2.2" xref="S3.SS1.SSS0.Px1.p1.2.m2.2.2.2.2.2.cmml"><mover accent="true" id="S3.SS1.SSS0.Px1.p1.2.m2.2.2.2.2.2.2" xref="S3.SS1.SSS0.Px1.p1.2.m2.2.2.2.2.2.2.cmml"><mi id="S3.SS1.SSS0.Px1.p1.2.m2.2.2.2.2.2.2.2" xref="S3.SS1.SSS0.Px1.p1.2.m2.2.2.2.2.2.2.2.cmml">𝐰</mi><mo id="S3.SS1.SSS0.Px1.p1.2.m2.2.2.2.2.2.2.1" xref="S3.SS1.SSS0.Px1.p1.2.m2.2.2.2.2.2.2.1.cmml">^</mo></mover><mi id="S3.SS1.SSS0.Px1.p1.2.m2.2.2.2.2.2.3" xref="S3.SS1.SSS0.Px1.p1.2.m2.2.2.2.2.2.3.cmml">s</mi></msub><mo id="S3.SS1.SSS0.Px1.p1.2.m2.2.2.2.2.1" xref="S3.SS1.SSS0.Px1.p1.2.m2.2.2.2.2.1.cmml">=</mo><mrow id="S3.SS1.SSS0.Px1.p1.2.m2.2.2.2.2.3" xref="S3.SS1.SSS0.Px1.p1.2.m2.2.2.2.2.3.cmml"><msub id="S3.SS1.SSS0.Px1.p1.2.m2.2.2.2.2.3.2" xref="S3.SS1.SSS0.Px1.p1.2.m2.2.2.2.2.3.2.cmml"><mi id="S3.SS1.SSS0.Px1.p1.2.m2.2.2.2.2.3.2.2" xref="S3.SS1.SSS0.Px1.p1.2.m2.2.2.2.2.3.2.2.cmml">𝐰</mi><mi id="S3.SS1.SSS0.Px1.p1.2.m2.2.2.2.2.3.2.3" xref="S3.SS1.SSS0.Px1.p1.2.m2.2.2.2.2.3.2.3.cmml">s</mi></msub><mo lspace="0.222em" rspace="0.222em" id="S3.SS1.SSS0.Px1.p1.2.m2.2.2.2.2.3.1" xref="S3.SS1.SSS0.Px1.p1.2.m2.2.2.2.2.3.1.cmml">⊙</mo><msub id="S3.SS1.SSS0.Px1.p1.2.m2.2.2.2.2.3.3" xref="S3.SS1.SSS0.Px1.p1.2.m2.2.2.2.2.3.3.cmml"><mi id="S3.SS1.SSS0.Px1.p1.2.m2.2.2.2.2.3.3.2" xref="S3.SS1.SSS0.Px1.p1.2.m2.2.2.2.2.3.3.2.cmml">𝐳</mi><mi id="S3.SS1.SSS0.Px1.p1.2.m2.2.2.2.2.3.3.3" xref="S3.SS1.SSS0.Px1.p1.2.m2.2.2.2.2.3.3.3.cmml">s</mi></msub></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS0.Px1.p1.2.m2.2b"><apply id="S3.SS1.SSS0.Px1.p1.2.m2.2.2.3.cmml" xref="S3.SS1.SSS0.Px1.p1.2.m2.2.2.2"><csymbol cd="ambiguous" id="S3.SS1.SSS0.Px1.p1.2.m2.2.2.3a.cmml" xref="S3.SS1.SSS0.Px1.p1.2.m2.2.2.2.3">formulae-sequence</csymbol><apply id="S3.SS1.SSS0.Px1.p1.2.m2.1.1.1.1.cmml" xref="S3.SS1.SSS0.Px1.p1.2.m2.1.1.1.1"><csymbol cd="latexml" id="S3.SS1.SSS0.Px1.p1.2.m2.1.1.1.1.2.cmml" xref="S3.SS1.SSS0.Px1.p1.2.m2.1.1.1.1.2">similar-to</csymbol><apply id="S3.SS1.SSS0.Px1.p1.2.m2.1.1.1.1.3.cmml" xref="S3.SS1.SSS0.Px1.p1.2.m2.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.SS1.SSS0.Px1.p1.2.m2.1.1.1.1.3.1.cmml" xref="S3.SS1.SSS0.Px1.p1.2.m2.1.1.1.1.3">subscript</csymbol><ci id="S3.SS1.SSS0.Px1.p1.2.m2.1.1.1.1.3.2.cmml" xref="S3.SS1.SSS0.Px1.p1.2.m2.1.1.1.1.3.2">𝐳</ci><ci id="S3.SS1.SSS0.Px1.p1.2.m2.1.1.1.1.3.3.cmml" xref="S3.SS1.SSS0.Px1.p1.2.m2.1.1.1.1.3.3">𝑠</ci></apply><apply id="S3.SS1.SSS0.Px1.p1.2.m2.1.1.1.1.1.cmml" xref="S3.SS1.SSS0.Px1.p1.2.m2.1.1.1.1.1"><times id="S3.SS1.SSS0.Px1.p1.2.m2.1.1.1.1.1.2.cmml" xref="S3.SS1.SSS0.Px1.p1.2.m2.1.1.1.1.1.2"></times><apply id="S3.SS1.SSS0.Px1.p1.2.m2.1.1.1.1.1.3.cmml" xref="S3.SS1.SSS0.Px1.p1.2.m2.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.SS1.SSS0.Px1.p1.2.m2.1.1.1.1.1.3.1.cmml" xref="S3.SS1.SSS0.Px1.p1.2.m2.1.1.1.1.1.3">subscript</csymbol><ci id="S3.SS1.SSS0.Px1.p1.2.m2.1.1.1.1.1.3.2.cmml" xref="S3.SS1.SSS0.Px1.p1.2.m2.1.1.1.1.1.3.2">𝑞</ci><apply id="S3.SS1.SSS0.Px1.p1.2.m2.1.1.1.1.1.3.3.cmml" xref="S3.SS1.SSS0.Px1.p1.2.m2.1.1.1.1.1.3.3"><csymbol cd="ambiguous" id="S3.SS1.SSS0.Px1.p1.2.m2.1.1.1.1.1.3.3.1.cmml" xref="S3.SS1.SSS0.Px1.p1.2.m2.1.1.1.1.1.3.3">subscript</csymbol><ci id="S3.SS1.SSS0.Px1.p1.2.m2.1.1.1.1.1.3.3.2.cmml" xref="S3.SS1.SSS0.Px1.p1.2.m2.1.1.1.1.1.3.3.2">𝝅</ci><ci id="S3.SS1.SSS0.Px1.p1.2.m2.1.1.1.1.1.3.3.3.cmml" xref="S3.SS1.SSS0.Px1.p1.2.m2.1.1.1.1.1.3.3.3">𝑠</ci></apply></apply><apply id="S3.SS1.SSS0.Px1.p1.2.m2.1.1.1.1.1.1.1.1.cmml" xref="S3.SS1.SSS0.Px1.p1.2.m2.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS1.SSS0.Px1.p1.2.m2.1.1.1.1.1.1.1.1.1.cmml" xref="S3.SS1.SSS0.Px1.p1.2.m2.1.1.1.1.1.1.1">subscript</csymbol><ci id="S3.SS1.SSS0.Px1.p1.2.m2.1.1.1.1.1.1.1.1.2.cmml" xref="S3.SS1.SSS0.Px1.p1.2.m2.1.1.1.1.1.1.1.1.2">𝐳</ci><ci id="S3.SS1.SSS0.Px1.p1.2.m2.1.1.1.1.1.1.1.1.3.cmml" xref="S3.SS1.SSS0.Px1.p1.2.m2.1.1.1.1.1.1.1.1.3">𝑠</ci></apply></apply></apply><apply id="S3.SS1.SSS0.Px1.p1.2.m2.2.2.2.2.cmml" xref="S3.SS1.SSS0.Px1.p1.2.m2.2.2.2.2"><eq id="S3.SS1.SSS0.Px1.p1.2.m2.2.2.2.2.1.cmml" xref="S3.SS1.SSS0.Px1.p1.2.m2.2.2.2.2.1"></eq><apply id="S3.SS1.SSS0.Px1.p1.2.m2.2.2.2.2.2.cmml" xref="S3.SS1.SSS0.Px1.p1.2.m2.2.2.2.2.2"><csymbol cd="ambiguous" id="S3.SS1.SSS0.Px1.p1.2.m2.2.2.2.2.2.1.cmml" xref="S3.SS1.SSS0.Px1.p1.2.m2.2.2.2.2.2">subscript</csymbol><apply id="S3.SS1.SSS0.Px1.p1.2.m2.2.2.2.2.2.2.cmml" xref="S3.SS1.SSS0.Px1.p1.2.m2.2.2.2.2.2.2"><ci id="S3.SS1.SSS0.Px1.p1.2.m2.2.2.2.2.2.2.1.cmml" xref="S3.SS1.SSS0.Px1.p1.2.m2.2.2.2.2.2.2.1">^</ci><ci id="S3.SS1.SSS0.Px1.p1.2.m2.2.2.2.2.2.2.2.cmml" xref="S3.SS1.SSS0.Px1.p1.2.m2.2.2.2.2.2.2.2">𝐰</ci></apply><ci id="S3.SS1.SSS0.Px1.p1.2.m2.2.2.2.2.2.3.cmml" xref="S3.SS1.SSS0.Px1.p1.2.m2.2.2.2.2.2.3">𝑠</ci></apply><apply id="S3.SS1.SSS0.Px1.p1.2.m2.2.2.2.2.3.cmml" xref="S3.SS1.SSS0.Px1.p1.2.m2.2.2.2.2.3"><csymbol cd="latexml" id="S3.SS1.SSS0.Px1.p1.2.m2.2.2.2.2.3.1.cmml" xref="S3.SS1.SSS0.Px1.p1.2.m2.2.2.2.2.3.1">direct-product</csymbol><apply id="S3.SS1.SSS0.Px1.p1.2.m2.2.2.2.2.3.2.cmml" xref="S3.SS1.SSS0.Px1.p1.2.m2.2.2.2.2.3.2"><csymbol cd="ambiguous" id="S3.SS1.SSS0.Px1.p1.2.m2.2.2.2.2.3.2.1.cmml" xref="S3.SS1.SSS0.Px1.p1.2.m2.2.2.2.2.3.2">subscript</csymbol><ci id="S3.SS1.SSS0.Px1.p1.2.m2.2.2.2.2.3.2.2.cmml" xref="S3.SS1.SSS0.Px1.p1.2.m2.2.2.2.2.3.2.2">𝐰</ci><ci id="S3.SS1.SSS0.Px1.p1.2.m2.2.2.2.2.3.2.3.cmml" xref="S3.SS1.SSS0.Px1.p1.2.m2.2.2.2.2.3.2.3">𝑠</ci></apply><apply id="S3.SS1.SSS0.Px1.p1.2.m2.2.2.2.2.3.3.cmml" xref="S3.SS1.SSS0.Px1.p1.2.m2.2.2.2.2.3.3"><csymbol cd="ambiguous" id="S3.SS1.SSS0.Px1.p1.2.m2.2.2.2.2.3.3.1.cmml" xref="S3.SS1.SSS0.Px1.p1.2.m2.2.2.2.2.3.3">subscript</csymbol><ci id="S3.SS1.SSS0.Px1.p1.2.m2.2.2.2.2.3.3.2.cmml" xref="S3.SS1.SSS0.Px1.p1.2.m2.2.2.2.2.3.3.2">𝐳</ci><ci id="S3.SS1.SSS0.Px1.p1.2.m2.2.2.2.2.3.3.3.cmml" xref="S3.SS1.SSS0.Px1.p1.2.m2.2.2.2.2.3.3.3">𝑠</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS0.Px1.p1.2.m2.2c">\mathbf{z}_{s}\sim q_{\bm{\pi}_{s}}(\mathbf{z}_{s}),\quad\hat{\mathbf{w}}_{s}=\mathbf{w}_{s}\odot\mathbf{z}_{s}</annotation></semantics></math>, along with the <math id="S3.SS1.SSS0.Px1.p1.3.m3.1" class="ltx_Math" alttext="\mathbf{z}_{s}" display="inline"><semantics id="S3.SS1.SSS0.Px1.p1.3.m3.1a"><msub id="S3.SS1.SSS0.Px1.p1.3.m3.1.1" xref="S3.SS1.SSS0.Px1.p1.3.m3.1.1.cmml"><mi id="S3.SS1.SSS0.Px1.p1.3.m3.1.1.2" xref="S3.SS1.SSS0.Px1.p1.3.m3.1.1.2.cmml">𝐳</mi><mi id="S3.SS1.SSS0.Px1.p1.3.m3.1.1.3" xref="S3.SS1.SSS0.Px1.p1.3.m3.1.1.3.cmml">s</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS0.Px1.p1.3.m3.1b"><apply id="S3.SS1.SSS0.Px1.p1.3.m3.1.1.cmml" xref="S3.SS1.SSS0.Px1.p1.3.m3.1.1"><csymbol cd="ambiguous" id="S3.SS1.SSS0.Px1.p1.3.m3.1.1.1.cmml" xref="S3.SS1.SSS0.Px1.p1.3.m3.1.1">subscript</csymbol><ci id="S3.SS1.SSS0.Px1.p1.3.m3.1.1.2.cmml" xref="S3.SS1.SSS0.Px1.p1.3.m3.1.1.2">𝐳</ci><ci id="S3.SS1.SSS0.Px1.p1.3.m3.1.1.3.cmml" xref="S3.SS1.SSS0.Px1.p1.3.m3.1.1.3">𝑠</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS0.Px1.p1.3.m3.1c">\mathbf{z}_{s}</annotation></semantics></math>.
Having access to those samples, the server can then form 1-sample stochastic estimates of either the gradients or the stationary points for <math id="S3.SS1.SSS0.Px1.p1.4.m4.2" class="ltx_Math" alttext="\mathbf{w},\bm{\theta}" display="inline"><semantics id="S3.SS1.SSS0.Px1.p1.4.m4.2a"><mrow id="S3.SS1.SSS0.Px1.p1.4.m4.2.3.2" xref="S3.SS1.SSS0.Px1.p1.4.m4.2.3.1.cmml"><mi id="S3.SS1.SSS0.Px1.p1.4.m4.1.1" xref="S3.SS1.SSS0.Px1.p1.4.m4.1.1.cmml">𝐰</mi><mo id="S3.SS1.SSS0.Px1.p1.4.m4.2.3.2.1" xref="S3.SS1.SSS0.Px1.p1.4.m4.2.3.1.cmml">,</mo><mi id="S3.SS1.SSS0.Px1.p1.4.m4.2.2" xref="S3.SS1.SSS0.Px1.p1.4.m4.2.2.cmml">𝜽</mi></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS0.Px1.p1.4.m4.2b"><list id="S3.SS1.SSS0.Px1.p1.4.m4.2.3.1.cmml" xref="S3.SS1.SSS0.Px1.p1.4.m4.2.3.2"><ci id="S3.SS1.SSS0.Px1.p1.4.m4.1.1.cmml" xref="S3.SS1.SSS0.Px1.p1.4.m4.1.1">𝐰</ci><ci id="S3.SS1.SSS0.Px1.p1.4.m4.2.2.cmml" xref="S3.SS1.SSS0.Px1.p1.4.m4.2.2">𝜽</ci></list></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS0.Px1.p1.4.m4.2c">\mathbf{w},\bm{\theta}</annotation></semantics></math>. Notice that this is a way to reduce communication without adding bias in the gradients of the original objective.
In case that we are willing to incur extra bias, future work can consider techniques such as quantization <cite class="ltx_cite ltx_citemacro_citep">[<a href="#bib.bib2" title="" class="ltx_ref">2</a>]</cite> and top-k gradient selection <cite class="ltx_cite ltx_citemacro_citep">[<a href="#bib.bib20" title="" class="ltx_ref">20</a>]</cite> to reduce communication even further.</p>
</div>
</section>
<section id="S3.SS1.SSS0.Px2" class="ltx_paragraph">
<h4 class="ltx_title ltx_title_paragraph">Reducing the server to client communication cost</h4>

<div id="S3.SS1.SSS0.Px2.p1" class="ltx_para">
<p id="S3.SS1.SSS0.Px2.p1.5" class="ltx_p">The server needs to communicate to the clients the updated distributions at each round. Unfortunately, for simple unstructured pruning, this doubles the communication cost as for each weight <math id="S3.SS1.SSS0.Px2.p1.1.m1.1" class="ltx_Math" alttext="\mathbf{w}_{i}" display="inline"><semantics id="S3.SS1.SSS0.Px2.p1.1.m1.1a"><msub id="S3.SS1.SSS0.Px2.p1.1.m1.1.1" xref="S3.SS1.SSS0.Px2.p1.1.m1.1.1.cmml"><mi id="S3.SS1.SSS0.Px2.p1.1.m1.1.1.2" xref="S3.SS1.SSS0.Px2.p1.1.m1.1.1.2.cmml">𝐰</mi><mi id="S3.SS1.SSS0.Px2.p1.1.m1.1.1.3" xref="S3.SS1.SSS0.Px2.p1.1.m1.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS0.Px2.p1.1.m1.1b"><apply id="S3.SS1.SSS0.Px2.p1.1.m1.1.1.cmml" xref="S3.SS1.SSS0.Px2.p1.1.m1.1.1"><csymbol cd="ambiguous" id="S3.SS1.SSS0.Px2.p1.1.m1.1.1.1.cmml" xref="S3.SS1.SSS0.Px2.p1.1.m1.1.1">subscript</csymbol><ci id="S3.SS1.SSS0.Px2.p1.1.m1.1.1.2.cmml" xref="S3.SS1.SSS0.Px2.p1.1.m1.1.1.2">𝐰</ci><ci id="S3.SS1.SSS0.Px2.p1.1.m1.1.1.3.cmml" xref="S3.SS1.SSS0.Px2.p1.1.m1.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS0.Px2.p1.1.m1.1c">\mathbf{w}_{i}</annotation></semantics></math> there is an associated <math id="S3.SS1.SSS0.Px2.p1.2.m2.1" class="ltx_Math" alttext="\bm{\theta}_{i}" display="inline"><semantics id="S3.SS1.SSS0.Px2.p1.2.m2.1a"><msub id="S3.SS1.SSS0.Px2.p1.2.m2.1.1" xref="S3.SS1.SSS0.Px2.p1.2.m2.1.1.cmml"><mi id="S3.SS1.SSS0.Px2.p1.2.m2.1.1.2" xref="S3.SS1.SSS0.Px2.p1.2.m2.1.1.2.cmml">𝜽</mi><mi id="S3.SS1.SSS0.Px2.p1.2.m2.1.1.3" xref="S3.SS1.SSS0.Px2.p1.2.m2.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS0.Px2.p1.2.m2.1b"><apply id="S3.SS1.SSS0.Px2.p1.2.m2.1.1.cmml" xref="S3.SS1.SSS0.Px2.p1.2.m2.1.1"><csymbol cd="ambiguous" id="S3.SS1.SSS0.Px2.p1.2.m2.1.1.1.cmml" xref="S3.SS1.SSS0.Px2.p1.2.m2.1.1">subscript</csymbol><ci id="S3.SS1.SSS0.Px2.p1.2.m2.1.1.2.cmml" xref="S3.SS1.SSS0.Px2.p1.2.m2.1.1.2">𝜽</ci><ci id="S3.SS1.SSS0.Px2.p1.2.m2.1.1.3.cmml" xref="S3.SS1.SSS0.Px2.p1.2.m2.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS0.Px2.p1.2.m2.1c">\bm{\theta}_{i}</annotation></semantics></math> that needs to be sent to the client. To mitigate this effect, we will employ structured pruning, which introduces a single additional parameter for each group of weights. For groups of moderate sizes, <em id="S3.SS1.SSS0.Px2.p1.5.1" class="ltx_emph ltx_font_italic">e.g.</em>, the set of weights of a given convolutional filter, the extra overhead is small.
We can also take the communication cost reductions one step further if we allow for some bias in the optimization procedure; we can prune the global model during training after every round and thus send to each of the clients only the subset of the model that has survived. Notice that this is easy to do and does not require any data at the server. The inclusion probabilities <math id="S3.SS1.SSS0.Px2.p1.3.m3.1" class="ltx_Math" alttext="\bm{\theta}" display="inline"><semantics id="S3.SS1.SSS0.Px2.p1.3.m3.1a"><mi id="S3.SS1.SSS0.Px2.p1.3.m3.1.1" xref="S3.SS1.SSS0.Px2.p1.3.m3.1.1.cmml">𝜽</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS0.Px2.p1.3.m3.1b"><ci id="S3.SS1.SSS0.Px2.p1.3.m3.1.1.cmml" xref="S3.SS1.SSS0.Px2.p1.3.m3.1.1">𝜽</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS0.Px2.p1.3.m3.1c">\bm{\theta}</annotation></semantics></math> are available at the server, so we can remove the parameters that have <math id="S3.SS1.SSS0.Px2.p1.4.m4.1" class="ltx_Math" alttext="\bm{\theta}" display="inline"><semantics id="S3.SS1.SSS0.Px2.p1.4.m4.1a"><mi id="S3.SS1.SSS0.Px2.p1.4.m4.1.1" xref="S3.SS1.SSS0.Px2.p1.4.m4.1.1.cmml">𝜽</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS0.Px2.p1.4.m4.1b"><ci id="S3.SS1.SSS0.Px2.p1.4.m4.1.1.cmml" xref="S3.SS1.SSS0.Px2.p1.4.m4.1.1">𝜽</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS0.Px2.p1.4.m4.1c">\bm{\theta}</annotation></semantics></math> less than a threshold, <em id="S3.SS1.SSS0.Px2.p1.5.2" class="ltx_emph ltx_font_italic">e.g.</em> <math id="S3.SS1.SSS0.Px2.p1.5.m5.1" class="ltx_Math" alttext="0.1" display="inline"><semantics id="S3.SS1.SSS0.Px2.p1.5.m5.1a"><mn id="S3.SS1.SSS0.Px2.p1.5.m5.1.1" xref="S3.SS1.SSS0.Px2.p1.5.m5.1.1.cmml">0.1</mn><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS0.Px2.p1.5.m5.1b"><cn type="float" id="S3.SS1.SSS0.Px2.p1.5.m5.1.1.cmml" xref="S3.SS1.SSS0.Px2.p1.5.m5.1.1">0.1</cn></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS0.Px2.p1.5.m5.1c">0.1</annotation></semantics></math>. This can lead to large reductions in communication costs, especially once the model becomes sufficiently sparse.</p>
</div>
</section>
</section>
<section id="S3.SS2" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.2 </span><span id="S3.SS2.1.1" class="ltx_text ltx_font_typewriter">FedSparse</span> in practice</h3>

<section id="S3.SS2.SSS0.Px1" class="ltx_paragraph">
<h4 class="ltx_title ltx_title_paragraph">Local optimization</h4>

<div id="S3.SS2.SSS0.Px1.p1" class="ltx_para">
<p id="S3.SS2.SSS0.Px1.p1.4" class="ltx_p">While optimizing for <math id="S3.SS2.SSS0.Px1.p1.1.m1.1" class="ltx_Math" alttext="\mathbf{w}_{s}" display="inline"><semantics id="S3.SS2.SSS0.Px1.p1.1.m1.1a"><msub id="S3.SS2.SSS0.Px1.p1.1.m1.1.1" xref="S3.SS2.SSS0.Px1.p1.1.m1.1.1.cmml"><mi id="S3.SS2.SSS0.Px1.p1.1.m1.1.1.2" xref="S3.SS2.SSS0.Px1.p1.1.m1.1.1.2.cmml">𝐰</mi><mi id="S3.SS2.SSS0.Px1.p1.1.m1.1.1.3" xref="S3.SS2.SSS0.Px1.p1.1.m1.1.1.3.cmml">s</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS0.Px1.p1.1.m1.1b"><apply id="S3.SS2.SSS0.Px1.p1.1.m1.1.1.cmml" xref="S3.SS2.SSS0.Px1.p1.1.m1.1.1"><csymbol cd="ambiguous" id="S3.SS2.SSS0.Px1.p1.1.m1.1.1.1.cmml" xref="S3.SS2.SSS0.Px1.p1.1.m1.1.1">subscript</csymbol><ci id="S3.SS2.SSS0.Px1.p1.1.m1.1.1.2.cmml" xref="S3.SS2.SSS0.Px1.p1.1.m1.1.1.2">𝐰</ci><ci id="S3.SS2.SSS0.Px1.p1.1.m1.1.1.3.cmml" xref="S3.SS2.SSS0.Px1.p1.1.m1.1.1.3">𝑠</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS0.Px1.p1.1.m1.1c">\mathbf{w}_{s}</annotation></semantics></math> locally is straightforward to do with gradient-based optimizers, <math id="S3.SS2.SSS0.Px1.p1.2.m2.1" class="ltx_Math" alttext="\bm{\pi}_{s}" display="inline"><semantics id="S3.SS2.SSS0.Px1.p1.2.m2.1a"><msub id="S3.SS2.SSS0.Px1.p1.2.m2.1.1" xref="S3.SS2.SSS0.Px1.p1.2.m2.1.1.cmml"><mi id="S3.SS2.SSS0.Px1.p1.2.m2.1.1.2" xref="S3.SS2.SSS0.Px1.p1.2.m2.1.1.2.cmml">𝝅</mi><mi id="S3.SS2.SSS0.Px1.p1.2.m2.1.1.3" xref="S3.SS2.SSS0.Px1.p1.2.m2.1.1.3.cmml">s</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS0.Px1.p1.2.m2.1b"><apply id="S3.SS2.SSS0.Px1.p1.2.m2.1.1.cmml" xref="S3.SS2.SSS0.Px1.p1.2.m2.1.1"><csymbol cd="ambiguous" id="S3.SS2.SSS0.Px1.p1.2.m2.1.1.1.cmml" xref="S3.SS2.SSS0.Px1.p1.2.m2.1.1">subscript</csymbol><ci id="S3.SS2.SSS0.Px1.p1.2.m2.1.1.2.cmml" xref="S3.SS2.SSS0.Px1.p1.2.m2.1.1.2">𝝅</ci><ci id="S3.SS2.SSS0.Px1.p1.2.m2.1.1.3.cmml" xref="S3.SS2.SSS0.Px1.p1.2.m2.1.1.3">𝑠</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS0.Px1.p1.2.m2.1c">\bm{\pi}_{s}</annotation></semantics></math> is more tricky, as the expectation over the binary variables <math id="S3.SS2.SSS0.Px1.p1.3.m3.1" class="ltx_Math" alttext="\mathbf{z}_{s}" display="inline"><semantics id="S3.SS2.SSS0.Px1.p1.3.m3.1a"><msub id="S3.SS2.SSS0.Px1.p1.3.m3.1.1" xref="S3.SS2.SSS0.Px1.p1.3.m3.1.1.cmml"><mi id="S3.SS2.SSS0.Px1.p1.3.m3.1.1.2" xref="S3.SS2.SSS0.Px1.p1.3.m3.1.1.2.cmml">𝐳</mi><mi id="S3.SS2.SSS0.Px1.p1.3.m3.1.1.3" xref="S3.SS2.SSS0.Px1.p1.3.m3.1.1.3.cmml">s</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS0.Px1.p1.3.m3.1b"><apply id="S3.SS2.SSS0.Px1.p1.3.m3.1.1.cmml" xref="S3.SS2.SSS0.Px1.p1.3.m3.1.1"><csymbol cd="ambiguous" id="S3.SS2.SSS0.Px1.p1.3.m3.1.1.1.cmml" xref="S3.SS2.SSS0.Px1.p1.3.m3.1.1">subscript</csymbol><ci id="S3.SS2.SSS0.Px1.p1.3.m3.1.1.2.cmml" xref="S3.SS2.SSS0.Px1.p1.3.m3.1.1.2">𝐳</ci><ci id="S3.SS2.SSS0.Px1.p1.3.m3.1.1.3.cmml" xref="S3.SS2.SSS0.Px1.p1.3.m3.1.1.3">𝑠</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS0.Px1.p1.3.m3.1c">\mathbf{z}_{s}</annotation></semantics></math> in Eq. <a href="#S3.E17" title="In 3 The FedSparse algorithm: sparsity in federated learning ‣ An Expectation-Maximization Perspective on Federated Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">17</span></a> is intractable to compute in closed form and using Monte-Carlo integration does not yield reparametrizable samples. To circumvent these issues, we rewrite the objective in an equivalent form and use the hard-concrete relaxation from <cite class="ltx_cite ltx_citemacro_citep">[<a href="#bib.bib21" title="" class="ltx_ref">21</a>]</cite>, which can allow for the straightforward application of gradient ascent. We provide the details in Appendix <a href="#A8" title="Appendix H Local optimization of the binary gates ‣ An Expectation-Maximization Perspective on Federated Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">H</span></a>. When the client has to communicate to the server, we propose to form <math id="S3.SS2.SSS0.Px1.p1.4.m4.1" class="ltx_Math" alttext="\hat{\mathbf{w}}_{s}" display="inline"><semantics id="S3.SS2.SSS0.Px1.p1.4.m4.1a"><msub id="S3.SS2.SSS0.Px1.p1.4.m4.1.1" xref="S3.SS2.SSS0.Px1.p1.4.m4.1.1.cmml"><mover accent="true" id="S3.SS2.SSS0.Px1.p1.4.m4.1.1.2" xref="S3.SS2.SSS0.Px1.p1.4.m4.1.1.2.cmml"><mi id="S3.SS2.SSS0.Px1.p1.4.m4.1.1.2.2" xref="S3.SS2.SSS0.Px1.p1.4.m4.1.1.2.2.cmml">𝐰</mi><mo id="S3.SS2.SSS0.Px1.p1.4.m4.1.1.2.1" xref="S3.SS2.SSS0.Px1.p1.4.m4.1.1.2.1.cmml">^</mo></mover><mi id="S3.SS2.SSS0.Px1.p1.4.m4.1.1.3" xref="S3.SS2.SSS0.Px1.p1.4.m4.1.1.3.cmml">s</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS0.Px1.p1.4.m4.1b"><apply id="S3.SS2.SSS0.Px1.p1.4.m4.1.1.cmml" xref="S3.SS2.SSS0.Px1.p1.4.m4.1.1"><csymbol cd="ambiguous" id="S3.SS2.SSS0.Px1.p1.4.m4.1.1.1.cmml" xref="S3.SS2.SSS0.Px1.p1.4.m4.1.1">subscript</csymbol><apply id="S3.SS2.SSS0.Px1.p1.4.m4.1.1.2.cmml" xref="S3.SS2.SSS0.Px1.p1.4.m4.1.1.2"><ci id="S3.SS2.SSS0.Px1.p1.4.m4.1.1.2.1.cmml" xref="S3.SS2.SSS0.Px1.p1.4.m4.1.1.2.1">^</ci><ci id="S3.SS2.SSS0.Px1.p1.4.m4.1.1.2.2.cmml" xref="S3.SS2.SSS0.Px1.p1.4.m4.1.1.2.2">𝐰</ci></apply><ci id="S3.SS2.SSS0.Px1.p1.4.m4.1.1.3.cmml" xref="S3.SS2.SSS0.Px1.p1.4.m4.1.1.3">𝑠</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS0.Px1.p1.4.m4.1c">\hat{\mathbf{w}}_{s}</annotation></semantics></math> by sampling from the zero-temperature relaxation, which yields exact binary samples. Furthermore, at the beginning of each round, following the practice of <span id="S3.SS2.SSS0.Px1.p1.4.1" class="ltx_text ltx_font_typewriter">FedAvg</span>, the participating clients initialize their approximate posteriors to be equal to the priors that were communicated from the server. Empirically, we found that this resulted in better global model accuracy.</p>
</div>
</section>
<section id="S3.SS2.SSS0.Px2" class="ltx_paragraph">
<h4 class="ltx_title ltx_title_paragraph">Parameterization of the probabilities</h4>

<div id="S3.SS2.SSS0.Px2.p1" class="ltx_para">
<p id="S3.SS2.SSS0.Px2.p1.1" class="ltx_p">There is evidence that such optimization-based pruning can be inferior to simple magnitude-based pruning <cite class="ltx_cite ltx_citemacro_citep">[<a href="#bib.bib9" title="" class="ltx_ref">9</a>]</cite>. We, therefore, take an approach that combines the two and reminisces the recent work of <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib3" title="" class="ltx_ref">3</a>]</cite>. We parameterize the probabilities <math id="S3.SS2.SSS0.Px2.p1.1.m1.2" class="ltx_Math" alttext="\bm{\theta},\bm{\pi}_{s}" display="inline"><semantics id="S3.SS2.SSS0.Px2.p1.1.m1.2a"><mrow id="S3.SS2.SSS0.Px2.p1.1.m1.2.2.1" xref="S3.SS2.SSS0.Px2.p1.1.m1.2.2.2.cmml"><mi id="S3.SS2.SSS0.Px2.p1.1.m1.1.1" xref="S3.SS2.SSS0.Px2.p1.1.m1.1.1.cmml">𝜽</mi><mo id="S3.SS2.SSS0.Px2.p1.1.m1.2.2.1.2" xref="S3.SS2.SSS0.Px2.p1.1.m1.2.2.2.cmml">,</mo><msub id="S3.SS2.SSS0.Px2.p1.1.m1.2.2.1.1" xref="S3.SS2.SSS0.Px2.p1.1.m1.2.2.1.1.cmml"><mi id="S3.SS2.SSS0.Px2.p1.1.m1.2.2.1.1.2" xref="S3.SS2.SSS0.Px2.p1.1.m1.2.2.1.1.2.cmml">𝝅</mi><mi id="S3.SS2.SSS0.Px2.p1.1.m1.2.2.1.1.3" xref="S3.SS2.SSS0.Px2.p1.1.m1.2.2.1.1.3.cmml">s</mi></msub></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS0.Px2.p1.1.m1.2b"><list id="S3.SS2.SSS0.Px2.p1.1.m1.2.2.2.cmml" xref="S3.SS2.SSS0.Px2.p1.1.m1.2.2.1"><ci id="S3.SS2.SSS0.Px2.p1.1.m1.1.1.cmml" xref="S3.SS2.SSS0.Px2.p1.1.m1.1.1">𝜽</ci><apply id="S3.SS2.SSS0.Px2.p1.1.m1.2.2.1.1.cmml" xref="S3.SS2.SSS0.Px2.p1.1.m1.2.2.1.1"><csymbol cd="ambiguous" id="S3.SS2.SSS0.Px2.p1.1.m1.2.2.1.1.1.cmml" xref="S3.SS2.SSS0.Px2.p1.1.m1.2.2.1.1">subscript</csymbol><ci id="S3.SS2.SSS0.Px2.p1.1.m1.2.2.1.1.2.cmml" xref="S3.SS2.SSS0.Px2.p1.1.m1.2.2.1.1.2">𝝅</ci><ci id="S3.SS2.SSS0.Px2.p1.1.m1.2.2.1.1.3.cmml" xref="S3.SS2.SSS0.Px2.p1.1.m1.2.2.1.1.3">𝑠</ci></apply></list></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS0.Px2.p1.1.m1.2c">\bm{\theta},\bm{\pi}_{s}</annotation></semantics></math> as a function of the model weights and magnitude-based thresholds that regulate how active a parameter can be:</p>
<table id="A10.EGx20" class="ltx_equationgroup ltx_eqn_align ltx_eqn_table">

<tbody id="S3.E23"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math id="S3.E23.m1.3" class="ltx_Math" alttext="\displaystyle\theta_{g}:=\sigma\left(\frac{\|\mathbf{w}_{g}\|_{2}-\tau_{g}}{T}\right),\enskip\pi_{sg}:=\sigma\left(\frac{\|\mathbf{w}_{sg}\|_{2}-\tau_{sg}}{T}\right)," display="inline"><semantics id="S3.E23.m1.3a"><mrow id="S3.E23.m1.3.3.1"><mrow id="S3.E23.m1.3.3.1.1.2" xref="S3.E23.m1.3.3.1.1.3.cmml"><mrow id="S3.E23.m1.3.3.1.1.1.1" xref="S3.E23.m1.3.3.1.1.1.1.cmml"><msub id="S3.E23.m1.3.3.1.1.1.1.2" xref="S3.E23.m1.3.3.1.1.1.1.2.cmml"><mi id="S3.E23.m1.3.3.1.1.1.1.2.2" xref="S3.E23.m1.3.3.1.1.1.1.2.2.cmml">θ</mi><mi id="S3.E23.m1.3.3.1.1.1.1.2.3" xref="S3.E23.m1.3.3.1.1.1.1.2.3.cmml">g</mi></msub><mo lspace="0.278em" rspace="0.278em" id="S3.E23.m1.3.3.1.1.1.1.1" xref="S3.E23.m1.3.3.1.1.1.1.1.cmml">:=</mo><mrow id="S3.E23.m1.3.3.1.1.1.1.3" xref="S3.E23.m1.3.3.1.1.1.1.3.cmml"><mi id="S3.E23.m1.3.3.1.1.1.1.3.2" xref="S3.E23.m1.3.3.1.1.1.1.3.2.cmml">σ</mi><mo lspace="0em" rspace="0em" id="S3.E23.m1.3.3.1.1.1.1.3.1" xref="S3.E23.m1.3.3.1.1.1.1.3.1.cmml">​</mo><mrow id="S3.E23.m1.3.3.1.1.1.1.3.3.2" xref="S3.E23.m1.1.1.cmml"><mo id="S3.E23.m1.3.3.1.1.1.1.3.3.2.1" xref="S3.E23.m1.1.1.cmml">(</mo><mstyle displaystyle="true" id="S3.E23.m1.1.1" xref="S3.E23.m1.1.1.cmml"><mfrac id="S3.E23.m1.1.1a" xref="S3.E23.m1.1.1.cmml"><mrow id="S3.E23.m1.1.1.1" xref="S3.E23.m1.1.1.1.cmml"><msub id="S3.E23.m1.1.1.1.1" xref="S3.E23.m1.1.1.1.1.cmml"><mrow id="S3.E23.m1.1.1.1.1.1.1" xref="S3.E23.m1.1.1.1.1.1.2.cmml"><mo stretchy="false" id="S3.E23.m1.1.1.1.1.1.1.2" xref="S3.E23.m1.1.1.1.1.1.2.1.cmml">‖</mo><msub id="S3.E23.m1.1.1.1.1.1.1.1" xref="S3.E23.m1.1.1.1.1.1.1.1.cmml"><mi id="S3.E23.m1.1.1.1.1.1.1.1.2" xref="S3.E23.m1.1.1.1.1.1.1.1.2.cmml">𝐰</mi><mi id="S3.E23.m1.1.1.1.1.1.1.1.3" xref="S3.E23.m1.1.1.1.1.1.1.1.3.cmml">g</mi></msub><mo stretchy="false" id="S3.E23.m1.1.1.1.1.1.1.3" xref="S3.E23.m1.1.1.1.1.1.2.1.cmml">‖</mo></mrow><mn id="S3.E23.m1.1.1.1.1.3" xref="S3.E23.m1.1.1.1.1.3.cmml">2</mn></msub><mo id="S3.E23.m1.1.1.1.2" xref="S3.E23.m1.1.1.1.2.cmml">−</mo><msub id="S3.E23.m1.1.1.1.3" xref="S3.E23.m1.1.1.1.3.cmml"><mi id="S3.E23.m1.1.1.1.3.2" xref="S3.E23.m1.1.1.1.3.2.cmml">τ</mi><mi id="S3.E23.m1.1.1.1.3.3" xref="S3.E23.m1.1.1.1.3.3.cmml">g</mi></msub></mrow><mi id="S3.E23.m1.1.1.3" xref="S3.E23.m1.1.1.3.cmml">T</mi></mfrac></mstyle><mo id="S3.E23.m1.3.3.1.1.1.1.3.3.2.2" xref="S3.E23.m1.1.1.cmml">)</mo></mrow></mrow></mrow><mo rspace="0.667em" id="S3.E23.m1.3.3.1.1.2.3" xref="S3.E23.m1.3.3.1.1.3a.cmml">,</mo><mrow id="S3.E23.m1.3.3.1.1.2.2" xref="S3.E23.m1.3.3.1.1.2.2.cmml"><msub id="S3.E23.m1.3.3.1.1.2.2.2" xref="S3.E23.m1.3.3.1.1.2.2.2.cmml"><mi id="S3.E23.m1.3.3.1.1.2.2.2.2" xref="S3.E23.m1.3.3.1.1.2.2.2.2.cmml">π</mi><mrow id="S3.E23.m1.3.3.1.1.2.2.2.3" xref="S3.E23.m1.3.3.1.1.2.2.2.3.cmml"><mi id="S3.E23.m1.3.3.1.1.2.2.2.3.2" xref="S3.E23.m1.3.3.1.1.2.2.2.3.2.cmml">s</mi><mo lspace="0em" rspace="0em" id="S3.E23.m1.3.3.1.1.2.2.2.3.1" xref="S3.E23.m1.3.3.1.1.2.2.2.3.1.cmml">​</mo><mi id="S3.E23.m1.3.3.1.1.2.2.2.3.3" xref="S3.E23.m1.3.3.1.1.2.2.2.3.3.cmml">g</mi></mrow></msub><mo lspace="0.278em" rspace="0.278em" id="S3.E23.m1.3.3.1.1.2.2.1" xref="S3.E23.m1.3.3.1.1.2.2.1.cmml">:=</mo><mrow id="S3.E23.m1.3.3.1.1.2.2.3" xref="S3.E23.m1.3.3.1.1.2.2.3.cmml"><mi id="S3.E23.m1.3.3.1.1.2.2.3.2" xref="S3.E23.m1.3.3.1.1.2.2.3.2.cmml">σ</mi><mo lspace="0em" rspace="0em" id="S3.E23.m1.3.3.1.1.2.2.3.1" xref="S3.E23.m1.3.3.1.1.2.2.3.1.cmml">​</mo><mrow id="S3.E23.m1.3.3.1.1.2.2.3.3.2" xref="S3.E23.m1.2.2.cmml"><mo id="S3.E23.m1.3.3.1.1.2.2.3.3.2.1" xref="S3.E23.m1.2.2.cmml">(</mo><mstyle displaystyle="true" id="S3.E23.m1.2.2" xref="S3.E23.m1.2.2.cmml"><mfrac id="S3.E23.m1.2.2a" xref="S3.E23.m1.2.2.cmml"><mrow id="S3.E23.m1.2.2.1" xref="S3.E23.m1.2.2.1.cmml"><msub id="S3.E23.m1.2.2.1.1" xref="S3.E23.m1.2.2.1.1.cmml"><mrow id="S3.E23.m1.2.2.1.1.1.1" xref="S3.E23.m1.2.2.1.1.1.2.cmml"><mo stretchy="false" id="S3.E23.m1.2.2.1.1.1.1.2" xref="S3.E23.m1.2.2.1.1.1.2.1.cmml">‖</mo><msub id="S3.E23.m1.2.2.1.1.1.1.1" xref="S3.E23.m1.2.2.1.1.1.1.1.cmml"><mi id="S3.E23.m1.2.2.1.1.1.1.1.2" xref="S3.E23.m1.2.2.1.1.1.1.1.2.cmml">𝐰</mi><mrow id="S3.E23.m1.2.2.1.1.1.1.1.3" xref="S3.E23.m1.2.2.1.1.1.1.1.3.cmml"><mi id="S3.E23.m1.2.2.1.1.1.1.1.3.2" xref="S3.E23.m1.2.2.1.1.1.1.1.3.2.cmml">s</mi><mo lspace="0em" rspace="0em" id="S3.E23.m1.2.2.1.1.1.1.1.3.1" xref="S3.E23.m1.2.2.1.1.1.1.1.3.1.cmml">​</mo><mi id="S3.E23.m1.2.2.1.1.1.1.1.3.3" xref="S3.E23.m1.2.2.1.1.1.1.1.3.3.cmml">g</mi></mrow></msub><mo stretchy="false" id="S3.E23.m1.2.2.1.1.1.1.3" xref="S3.E23.m1.2.2.1.1.1.2.1.cmml">‖</mo></mrow><mn id="S3.E23.m1.2.2.1.1.3" xref="S3.E23.m1.2.2.1.1.3.cmml">2</mn></msub><mo id="S3.E23.m1.2.2.1.2" xref="S3.E23.m1.2.2.1.2.cmml">−</mo><msub id="S3.E23.m1.2.2.1.3" xref="S3.E23.m1.2.2.1.3.cmml"><mi id="S3.E23.m1.2.2.1.3.2" xref="S3.E23.m1.2.2.1.3.2.cmml">τ</mi><mrow id="S3.E23.m1.2.2.1.3.3" xref="S3.E23.m1.2.2.1.3.3.cmml"><mi id="S3.E23.m1.2.2.1.3.3.2" xref="S3.E23.m1.2.2.1.3.3.2.cmml">s</mi><mo lspace="0em" rspace="0em" id="S3.E23.m1.2.2.1.3.3.1" xref="S3.E23.m1.2.2.1.3.3.1.cmml">​</mo><mi id="S3.E23.m1.2.2.1.3.3.3" xref="S3.E23.m1.2.2.1.3.3.3.cmml">g</mi></mrow></msub></mrow><mi id="S3.E23.m1.2.2.3" xref="S3.E23.m1.2.2.3.cmml">T</mi></mfrac></mstyle><mo id="S3.E23.m1.3.3.1.1.2.2.3.3.2.2" xref="S3.E23.m1.2.2.cmml">)</mo></mrow></mrow></mrow></mrow><mo id="S3.E23.m1.3.3.1.2">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E23.m1.3b"><apply id="S3.E23.m1.3.3.1.1.3.cmml" xref="S3.E23.m1.3.3.1.1.2"><csymbol cd="ambiguous" id="S3.E23.m1.3.3.1.1.3a.cmml" xref="S3.E23.m1.3.3.1.1.2.3">formulae-sequence</csymbol><apply id="S3.E23.m1.3.3.1.1.1.1.cmml" xref="S3.E23.m1.3.3.1.1.1.1"><csymbol cd="latexml" id="S3.E23.m1.3.3.1.1.1.1.1.cmml" xref="S3.E23.m1.3.3.1.1.1.1.1">assign</csymbol><apply id="S3.E23.m1.3.3.1.1.1.1.2.cmml" xref="S3.E23.m1.3.3.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.E23.m1.3.3.1.1.1.1.2.1.cmml" xref="S3.E23.m1.3.3.1.1.1.1.2">subscript</csymbol><ci id="S3.E23.m1.3.3.1.1.1.1.2.2.cmml" xref="S3.E23.m1.3.3.1.1.1.1.2.2">𝜃</ci><ci id="S3.E23.m1.3.3.1.1.1.1.2.3.cmml" xref="S3.E23.m1.3.3.1.1.1.1.2.3">𝑔</ci></apply><apply id="S3.E23.m1.3.3.1.1.1.1.3.cmml" xref="S3.E23.m1.3.3.1.1.1.1.3"><times id="S3.E23.m1.3.3.1.1.1.1.3.1.cmml" xref="S3.E23.m1.3.3.1.1.1.1.3.1"></times><ci id="S3.E23.m1.3.3.1.1.1.1.3.2.cmml" xref="S3.E23.m1.3.3.1.1.1.1.3.2">𝜎</ci><apply id="S3.E23.m1.1.1.cmml" xref="S3.E23.m1.3.3.1.1.1.1.3.3.2"><divide id="S3.E23.m1.1.1.2.cmml" xref="S3.E23.m1.3.3.1.1.1.1.3.3.2"></divide><apply id="S3.E23.m1.1.1.1.cmml" xref="S3.E23.m1.1.1.1"><minus id="S3.E23.m1.1.1.1.2.cmml" xref="S3.E23.m1.1.1.1.2"></minus><apply id="S3.E23.m1.1.1.1.1.cmml" xref="S3.E23.m1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E23.m1.1.1.1.1.2.cmml" xref="S3.E23.m1.1.1.1.1">subscript</csymbol><apply id="S3.E23.m1.1.1.1.1.1.2.cmml" xref="S3.E23.m1.1.1.1.1.1.1"><csymbol cd="latexml" id="S3.E23.m1.1.1.1.1.1.2.1.cmml" xref="S3.E23.m1.1.1.1.1.1.1.2">norm</csymbol><apply id="S3.E23.m1.1.1.1.1.1.1.1.cmml" xref="S3.E23.m1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E23.m1.1.1.1.1.1.1.1.1.cmml" xref="S3.E23.m1.1.1.1.1.1.1.1">subscript</csymbol><ci id="S3.E23.m1.1.1.1.1.1.1.1.2.cmml" xref="S3.E23.m1.1.1.1.1.1.1.1.2">𝐰</ci><ci id="S3.E23.m1.1.1.1.1.1.1.1.3.cmml" xref="S3.E23.m1.1.1.1.1.1.1.1.3">𝑔</ci></apply></apply><cn type="integer" id="S3.E23.m1.1.1.1.1.3.cmml" xref="S3.E23.m1.1.1.1.1.3">2</cn></apply><apply id="S3.E23.m1.1.1.1.3.cmml" xref="S3.E23.m1.1.1.1.3"><csymbol cd="ambiguous" id="S3.E23.m1.1.1.1.3.1.cmml" xref="S3.E23.m1.1.1.1.3">subscript</csymbol><ci id="S3.E23.m1.1.1.1.3.2.cmml" xref="S3.E23.m1.1.1.1.3.2">𝜏</ci><ci id="S3.E23.m1.1.1.1.3.3.cmml" xref="S3.E23.m1.1.1.1.3.3">𝑔</ci></apply></apply><ci id="S3.E23.m1.1.1.3.cmml" xref="S3.E23.m1.1.1.3">𝑇</ci></apply></apply></apply><apply id="S3.E23.m1.3.3.1.1.2.2.cmml" xref="S3.E23.m1.3.3.1.1.2.2"><csymbol cd="latexml" id="S3.E23.m1.3.3.1.1.2.2.1.cmml" xref="S3.E23.m1.3.3.1.1.2.2.1">assign</csymbol><apply id="S3.E23.m1.3.3.1.1.2.2.2.cmml" xref="S3.E23.m1.3.3.1.1.2.2.2"><csymbol cd="ambiguous" id="S3.E23.m1.3.3.1.1.2.2.2.1.cmml" xref="S3.E23.m1.3.3.1.1.2.2.2">subscript</csymbol><ci id="S3.E23.m1.3.3.1.1.2.2.2.2.cmml" xref="S3.E23.m1.3.3.1.1.2.2.2.2">𝜋</ci><apply id="S3.E23.m1.3.3.1.1.2.2.2.3.cmml" xref="S3.E23.m1.3.3.1.1.2.2.2.3"><times id="S3.E23.m1.3.3.1.1.2.2.2.3.1.cmml" xref="S3.E23.m1.3.3.1.1.2.2.2.3.1"></times><ci id="S3.E23.m1.3.3.1.1.2.2.2.3.2.cmml" xref="S3.E23.m1.3.3.1.1.2.2.2.3.2">𝑠</ci><ci id="S3.E23.m1.3.3.1.1.2.2.2.3.3.cmml" xref="S3.E23.m1.3.3.1.1.2.2.2.3.3">𝑔</ci></apply></apply><apply id="S3.E23.m1.3.3.1.1.2.2.3.cmml" xref="S3.E23.m1.3.3.1.1.2.2.3"><times id="S3.E23.m1.3.3.1.1.2.2.3.1.cmml" xref="S3.E23.m1.3.3.1.1.2.2.3.1"></times><ci id="S3.E23.m1.3.3.1.1.2.2.3.2.cmml" xref="S3.E23.m1.3.3.1.1.2.2.3.2">𝜎</ci><apply id="S3.E23.m1.2.2.cmml" xref="S3.E23.m1.3.3.1.1.2.2.3.3.2"><divide id="S3.E23.m1.2.2.2.cmml" xref="S3.E23.m1.3.3.1.1.2.2.3.3.2"></divide><apply id="S3.E23.m1.2.2.1.cmml" xref="S3.E23.m1.2.2.1"><minus id="S3.E23.m1.2.2.1.2.cmml" xref="S3.E23.m1.2.2.1.2"></minus><apply id="S3.E23.m1.2.2.1.1.cmml" xref="S3.E23.m1.2.2.1.1"><csymbol cd="ambiguous" id="S3.E23.m1.2.2.1.1.2.cmml" xref="S3.E23.m1.2.2.1.1">subscript</csymbol><apply id="S3.E23.m1.2.2.1.1.1.2.cmml" xref="S3.E23.m1.2.2.1.1.1.1"><csymbol cd="latexml" id="S3.E23.m1.2.2.1.1.1.2.1.cmml" xref="S3.E23.m1.2.2.1.1.1.1.2">norm</csymbol><apply id="S3.E23.m1.2.2.1.1.1.1.1.cmml" xref="S3.E23.m1.2.2.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E23.m1.2.2.1.1.1.1.1.1.cmml" xref="S3.E23.m1.2.2.1.1.1.1.1">subscript</csymbol><ci id="S3.E23.m1.2.2.1.1.1.1.1.2.cmml" xref="S3.E23.m1.2.2.1.1.1.1.1.2">𝐰</ci><apply id="S3.E23.m1.2.2.1.1.1.1.1.3.cmml" xref="S3.E23.m1.2.2.1.1.1.1.1.3"><times id="S3.E23.m1.2.2.1.1.1.1.1.3.1.cmml" xref="S3.E23.m1.2.2.1.1.1.1.1.3.1"></times><ci id="S3.E23.m1.2.2.1.1.1.1.1.3.2.cmml" xref="S3.E23.m1.2.2.1.1.1.1.1.3.2">𝑠</ci><ci id="S3.E23.m1.2.2.1.1.1.1.1.3.3.cmml" xref="S3.E23.m1.2.2.1.1.1.1.1.3.3">𝑔</ci></apply></apply></apply><cn type="integer" id="S3.E23.m1.2.2.1.1.3.cmml" xref="S3.E23.m1.2.2.1.1.3">2</cn></apply><apply id="S3.E23.m1.2.2.1.3.cmml" xref="S3.E23.m1.2.2.1.3"><csymbol cd="ambiguous" id="S3.E23.m1.2.2.1.3.1.cmml" xref="S3.E23.m1.2.2.1.3">subscript</csymbol><ci id="S3.E23.m1.2.2.1.3.2.cmml" xref="S3.E23.m1.2.2.1.3.2">𝜏</ci><apply id="S3.E23.m1.2.2.1.3.3.cmml" xref="S3.E23.m1.2.2.1.3.3"><times id="S3.E23.m1.2.2.1.3.3.1.cmml" xref="S3.E23.m1.2.2.1.3.3.1"></times><ci id="S3.E23.m1.2.2.1.3.3.2.cmml" xref="S3.E23.m1.2.2.1.3.3.2">𝑠</ci><ci id="S3.E23.m1.2.2.1.3.3.3.cmml" xref="S3.E23.m1.2.2.1.3.3.3">𝑔</ci></apply></apply></apply><ci id="S3.E23.m1.2.2.3.cmml" xref="S3.E23.m1.2.2.3">𝑇</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E23.m1.3c">\displaystyle\theta_{g}:=\sigma\left(\frac{\|\mathbf{w}_{g}\|_{2}-\tau_{g}}{T}\right),\enskip\pi_{sg}:=\sigma\left(\frac{\|\mathbf{w}_{sg}\|_{2}-\tau_{sg}}{T}\right),</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(23)</span></td>
</tr></tbody>
</table>
<p id="S3.SS2.SSS0.Px2.p1.9" class="ltx_p">where the subscript <math id="S3.SS2.SSS0.Px2.p1.2.m1.1" class="ltx_Math" alttext="g" display="inline"><semantics id="S3.SS2.SSS0.Px2.p1.2.m1.1a"><mi id="S3.SS2.SSS0.Px2.p1.2.m1.1.1" xref="S3.SS2.SSS0.Px2.p1.2.m1.1.1.cmml">g</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS0.Px2.p1.2.m1.1b"><ci id="S3.SS2.SSS0.Px2.p1.2.m1.1.1.cmml" xref="S3.SS2.SSS0.Px2.p1.2.m1.1.1">𝑔</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS0.Px2.p1.2.m1.1c">g</annotation></semantics></math> denotes the group, <math id="S3.SS2.SSS0.Px2.p1.3.m2.1" class="ltx_Math" alttext="\sigma(\cdot)" display="inline"><semantics id="S3.SS2.SSS0.Px2.p1.3.m2.1a"><mrow id="S3.SS2.SSS0.Px2.p1.3.m2.1.2" xref="S3.SS2.SSS0.Px2.p1.3.m2.1.2.cmml"><mi id="S3.SS2.SSS0.Px2.p1.3.m2.1.2.2" xref="S3.SS2.SSS0.Px2.p1.3.m2.1.2.2.cmml">σ</mi><mo lspace="0em" rspace="0em" id="S3.SS2.SSS0.Px2.p1.3.m2.1.2.1" xref="S3.SS2.SSS0.Px2.p1.3.m2.1.2.1.cmml">​</mo><mrow id="S3.SS2.SSS0.Px2.p1.3.m2.1.2.3.2" xref="S3.SS2.SSS0.Px2.p1.3.m2.1.2.cmml"><mo stretchy="false" id="S3.SS2.SSS0.Px2.p1.3.m2.1.2.3.2.1" xref="S3.SS2.SSS0.Px2.p1.3.m2.1.2.cmml">(</mo><mo lspace="0em" rspace="0em" id="S3.SS2.SSS0.Px2.p1.3.m2.1.1" xref="S3.SS2.SSS0.Px2.p1.3.m2.1.1.cmml">⋅</mo><mo stretchy="false" id="S3.SS2.SSS0.Px2.p1.3.m2.1.2.3.2.2" xref="S3.SS2.SSS0.Px2.p1.3.m2.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS0.Px2.p1.3.m2.1b"><apply id="S3.SS2.SSS0.Px2.p1.3.m2.1.2.cmml" xref="S3.SS2.SSS0.Px2.p1.3.m2.1.2"><times id="S3.SS2.SSS0.Px2.p1.3.m2.1.2.1.cmml" xref="S3.SS2.SSS0.Px2.p1.3.m2.1.2.1"></times><ci id="S3.SS2.SSS0.Px2.p1.3.m2.1.2.2.cmml" xref="S3.SS2.SSS0.Px2.p1.3.m2.1.2.2">𝜎</ci><ci id="S3.SS2.SSS0.Px2.p1.3.m2.1.1.cmml" xref="S3.SS2.SSS0.Px2.p1.3.m2.1.1">⋅</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS0.Px2.p1.3.m2.1c">\sigma(\cdot)</annotation></semantics></math> is the sigmoid function, <math id="S3.SS2.SSS0.Px2.p1.4.m3.2" class="ltx_Math" alttext="\tau_{g},\tau_{sg}" display="inline"><semantics id="S3.SS2.SSS0.Px2.p1.4.m3.2a"><mrow id="S3.SS2.SSS0.Px2.p1.4.m3.2.2.2" xref="S3.SS2.SSS0.Px2.p1.4.m3.2.2.3.cmml"><msub id="S3.SS2.SSS0.Px2.p1.4.m3.1.1.1.1" xref="S3.SS2.SSS0.Px2.p1.4.m3.1.1.1.1.cmml"><mi id="S3.SS2.SSS0.Px2.p1.4.m3.1.1.1.1.2" xref="S3.SS2.SSS0.Px2.p1.4.m3.1.1.1.1.2.cmml">τ</mi><mi id="S3.SS2.SSS0.Px2.p1.4.m3.1.1.1.1.3" xref="S3.SS2.SSS0.Px2.p1.4.m3.1.1.1.1.3.cmml">g</mi></msub><mo id="S3.SS2.SSS0.Px2.p1.4.m3.2.2.2.3" xref="S3.SS2.SSS0.Px2.p1.4.m3.2.2.3.cmml">,</mo><msub id="S3.SS2.SSS0.Px2.p1.4.m3.2.2.2.2" xref="S3.SS2.SSS0.Px2.p1.4.m3.2.2.2.2.cmml"><mi id="S3.SS2.SSS0.Px2.p1.4.m3.2.2.2.2.2" xref="S3.SS2.SSS0.Px2.p1.4.m3.2.2.2.2.2.cmml">τ</mi><mrow id="S3.SS2.SSS0.Px2.p1.4.m3.2.2.2.2.3" xref="S3.SS2.SSS0.Px2.p1.4.m3.2.2.2.2.3.cmml"><mi id="S3.SS2.SSS0.Px2.p1.4.m3.2.2.2.2.3.2" xref="S3.SS2.SSS0.Px2.p1.4.m3.2.2.2.2.3.2.cmml">s</mi><mo lspace="0em" rspace="0em" id="S3.SS2.SSS0.Px2.p1.4.m3.2.2.2.2.3.1" xref="S3.SS2.SSS0.Px2.p1.4.m3.2.2.2.2.3.1.cmml">​</mo><mi id="S3.SS2.SSS0.Px2.p1.4.m3.2.2.2.2.3.3" xref="S3.SS2.SSS0.Px2.p1.4.m3.2.2.2.2.3.3.cmml">g</mi></mrow></msub></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS0.Px2.p1.4.m3.2b"><list id="S3.SS2.SSS0.Px2.p1.4.m3.2.2.3.cmml" xref="S3.SS2.SSS0.Px2.p1.4.m3.2.2.2"><apply id="S3.SS2.SSS0.Px2.p1.4.m3.1.1.1.1.cmml" xref="S3.SS2.SSS0.Px2.p1.4.m3.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS2.SSS0.Px2.p1.4.m3.1.1.1.1.1.cmml" xref="S3.SS2.SSS0.Px2.p1.4.m3.1.1.1.1">subscript</csymbol><ci id="S3.SS2.SSS0.Px2.p1.4.m3.1.1.1.1.2.cmml" xref="S3.SS2.SSS0.Px2.p1.4.m3.1.1.1.1.2">𝜏</ci><ci id="S3.SS2.SSS0.Px2.p1.4.m3.1.1.1.1.3.cmml" xref="S3.SS2.SSS0.Px2.p1.4.m3.1.1.1.1.3">𝑔</ci></apply><apply id="S3.SS2.SSS0.Px2.p1.4.m3.2.2.2.2.cmml" xref="S3.SS2.SSS0.Px2.p1.4.m3.2.2.2.2"><csymbol cd="ambiguous" id="S3.SS2.SSS0.Px2.p1.4.m3.2.2.2.2.1.cmml" xref="S3.SS2.SSS0.Px2.p1.4.m3.2.2.2.2">subscript</csymbol><ci id="S3.SS2.SSS0.Px2.p1.4.m3.2.2.2.2.2.cmml" xref="S3.SS2.SSS0.Px2.p1.4.m3.2.2.2.2.2">𝜏</ci><apply id="S3.SS2.SSS0.Px2.p1.4.m3.2.2.2.2.3.cmml" xref="S3.SS2.SSS0.Px2.p1.4.m3.2.2.2.2.3"><times id="S3.SS2.SSS0.Px2.p1.4.m3.2.2.2.2.3.1.cmml" xref="S3.SS2.SSS0.Px2.p1.4.m3.2.2.2.2.3.1"></times><ci id="S3.SS2.SSS0.Px2.p1.4.m3.2.2.2.2.3.2.cmml" xref="S3.SS2.SSS0.Px2.p1.4.m3.2.2.2.2.3.2">𝑠</ci><ci id="S3.SS2.SSS0.Px2.p1.4.m3.2.2.2.2.3.3.cmml" xref="S3.SS2.SSS0.Px2.p1.4.m3.2.2.2.2.3.3">𝑔</ci></apply></apply></list></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS0.Px2.p1.4.m3.2c">\tau_{g},\tau_{sg}</annotation></semantics></math> are the global and client specific thresholds for a given group <math id="S3.SS2.SSS0.Px2.p1.5.m4.1" class="ltx_Math" alttext="g" display="inline"><semantics id="S3.SS2.SSS0.Px2.p1.5.m4.1a"><mi id="S3.SS2.SSS0.Px2.p1.5.m4.1.1" xref="S3.SS2.SSS0.Px2.p1.5.m4.1.1.cmml">g</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS0.Px2.p1.5.m4.1b"><ci id="S3.SS2.SSS0.Px2.p1.5.m4.1.1.cmml" xref="S3.SS2.SSS0.Px2.p1.5.m4.1.1">𝑔</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS0.Px2.p1.5.m4.1c">g</annotation></semantics></math> and <math id="S3.SS2.SSS0.Px2.p1.6.m5.1" class="ltx_Math" alttext="T" display="inline"><semantics id="S3.SS2.SSS0.Px2.p1.6.m5.1a"><mi id="S3.SS2.SSS0.Px2.p1.6.m5.1.1" xref="S3.SS2.SSS0.Px2.p1.6.m5.1.1.cmml">T</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS0.Px2.p1.6.m5.1b"><ci id="S3.SS2.SSS0.Px2.p1.6.m5.1.1.cmml" xref="S3.SS2.SSS0.Px2.p1.6.m5.1.1">𝑇</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS0.Px2.p1.6.m5.1c">T</annotation></semantics></math> is a temperature hyperparameter. Following <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib3" title="" class="ltx_ref">3</a>]</cite> we also “detach” the gradient of the weights through <math id="S3.SS2.SSS0.Px2.p1.7.m6.2" class="ltx_Math" alttext="\bm{\theta},\bm{\pi}_{s}" display="inline"><semantics id="S3.SS2.SSS0.Px2.p1.7.m6.2a"><mrow id="S3.SS2.SSS0.Px2.p1.7.m6.2.2.1" xref="S3.SS2.SSS0.Px2.p1.7.m6.2.2.2.cmml"><mi id="S3.SS2.SSS0.Px2.p1.7.m6.1.1" xref="S3.SS2.SSS0.Px2.p1.7.m6.1.1.cmml">𝜽</mi><mo id="S3.SS2.SSS0.Px2.p1.7.m6.2.2.1.2" xref="S3.SS2.SSS0.Px2.p1.7.m6.2.2.2.cmml">,</mo><msub id="S3.SS2.SSS0.Px2.p1.7.m6.2.2.1.1" xref="S3.SS2.SSS0.Px2.p1.7.m6.2.2.1.1.cmml"><mi id="S3.SS2.SSS0.Px2.p1.7.m6.2.2.1.1.2" xref="S3.SS2.SSS0.Px2.p1.7.m6.2.2.1.1.2.cmml">𝝅</mi><mi id="S3.SS2.SSS0.Px2.p1.7.m6.2.2.1.1.3" xref="S3.SS2.SSS0.Px2.p1.7.m6.2.2.1.1.3.cmml">s</mi></msub></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS0.Px2.p1.7.m6.2b"><list id="S3.SS2.SSS0.Px2.p1.7.m6.2.2.2.cmml" xref="S3.SS2.SSS0.Px2.p1.7.m6.2.2.1"><ci id="S3.SS2.SSS0.Px2.p1.7.m6.1.1.cmml" xref="S3.SS2.SSS0.Px2.p1.7.m6.1.1">𝜽</ci><apply id="S3.SS2.SSS0.Px2.p1.7.m6.2.2.1.1.cmml" xref="S3.SS2.SSS0.Px2.p1.7.m6.2.2.1.1"><csymbol cd="ambiguous" id="S3.SS2.SSS0.Px2.p1.7.m6.2.2.1.1.1.cmml" xref="S3.SS2.SSS0.Px2.p1.7.m6.2.2.1.1">subscript</csymbol><ci id="S3.SS2.SSS0.Px2.p1.7.m6.2.2.1.1.2.cmml" xref="S3.SS2.SSS0.Px2.p1.7.m6.2.2.1.1.2">𝝅</ci><ci id="S3.SS2.SSS0.Px2.p1.7.m6.2.2.1.1.3.cmml" xref="S3.SS2.SSS0.Px2.p1.7.m6.2.2.1.1.3">𝑠</ci></apply></list></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS0.Px2.p1.7.m6.2c">\bm{\theta},\bm{\pi}_{s}</annotation></semantics></math>, to avoid decreasing the probabilities by just shrinking the weights. With this parametrization we lose the ability to get a closed form solution for the server thresholds, but nonetheless we can still perform gradient based optimization at the server by using the chain rule. For a positive threshold, we use a parametrization in terms of a softplus function, <em id="S3.SS2.SSS0.Px2.p1.9.1" class="ltx_emph ltx_font_italic">i.e.</em>, <math id="S3.SS2.SSS0.Px2.p1.8.m7.4" class="ltx_Math" alttext="\bm{\tau}=\log(1+\exp(\mathbf{v}))" display="inline"><semantics id="S3.SS2.SSS0.Px2.p1.8.m7.4a"><mrow id="S3.SS2.SSS0.Px2.p1.8.m7.4.4" xref="S3.SS2.SSS0.Px2.p1.8.m7.4.4.cmml"><mi id="S3.SS2.SSS0.Px2.p1.8.m7.4.4.3" xref="S3.SS2.SSS0.Px2.p1.8.m7.4.4.3.cmml">𝝉</mi><mo id="S3.SS2.SSS0.Px2.p1.8.m7.4.4.2" xref="S3.SS2.SSS0.Px2.p1.8.m7.4.4.2.cmml">=</mo><mrow id="S3.SS2.SSS0.Px2.p1.8.m7.4.4.1.1" xref="S3.SS2.SSS0.Px2.p1.8.m7.4.4.1.2.cmml"><mi id="S3.SS2.SSS0.Px2.p1.8.m7.3.3" xref="S3.SS2.SSS0.Px2.p1.8.m7.3.3.cmml">log</mi><mo id="S3.SS2.SSS0.Px2.p1.8.m7.4.4.1.1a" xref="S3.SS2.SSS0.Px2.p1.8.m7.4.4.1.2.cmml">⁡</mo><mrow id="S3.SS2.SSS0.Px2.p1.8.m7.4.4.1.1.1" xref="S3.SS2.SSS0.Px2.p1.8.m7.4.4.1.2.cmml"><mo stretchy="false" id="S3.SS2.SSS0.Px2.p1.8.m7.4.4.1.1.1.2" xref="S3.SS2.SSS0.Px2.p1.8.m7.4.4.1.2.cmml">(</mo><mrow id="S3.SS2.SSS0.Px2.p1.8.m7.4.4.1.1.1.1" xref="S3.SS2.SSS0.Px2.p1.8.m7.4.4.1.1.1.1.cmml"><mn id="S3.SS2.SSS0.Px2.p1.8.m7.4.4.1.1.1.1.2" xref="S3.SS2.SSS0.Px2.p1.8.m7.4.4.1.1.1.1.2.cmml">1</mn><mo id="S3.SS2.SSS0.Px2.p1.8.m7.4.4.1.1.1.1.1" xref="S3.SS2.SSS0.Px2.p1.8.m7.4.4.1.1.1.1.1.cmml">+</mo><mrow id="S3.SS2.SSS0.Px2.p1.8.m7.4.4.1.1.1.1.3.2" xref="S3.SS2.SSS0.Px2.p1.8.m7.4.4.1.1.1.1.3.1.cmml"><mi id="S3.SS2.SSS0.Px2.p1.8.m7.1.1" xref="S3.SS2.SSS0.Px2.p1.8.m7.1.1.cmml">exp</mi><mo id="S3.SS2.SSS0.Px2.p1.8.m7.4.4.1.1.1.1.3.2a" xref="S3.SS2.SSS0.Px2.p1.8.m7.4.4.1.1.1.1.3.1.cmml">⁡</mo><mrow id="S3.SS2.SSS0.Px2.p1.8.m7.4.4.1.1.1.1.3.2.1" xref="S3.SS2.SSS0.Px2.p1.8.m7.4.4.1.1.1.1.3.1.cmml"><mo stretchy="false" id="S3.SS2.SSS0.Px2.p1.8.m7.4.4.1.1.1.1.3.2.1.1" xref="S3.SS2.SSS0.Px2.p1.8.m7.4.4.1.1.1.1.3.1.cmml">(</mo><mi id="S3.SS2.SSS0.Px2.p1.8.m7.2.2" xref="S3.SS2.SSS0.Px2.p1.8.m7.2.2.cmml">𝐯</mi><mo stretchy="false" id="S3.SS2.SSS0.Px2.p1.8.m7.4.4.1.1.1.1.3.2.1.2" xref="S3.SS2.SSS0.Px2.p1.8.m7.4.4.1.1.1.1.3.1.cmml">)</mo></mrow></mrow></mrow><mo stretchy="false" id="S3.SS2.SSS0.Px2.p1.8.m7.4.4.1.1.1.3" xref="S3.SS2.SSS0.Px2.p1.8.m7.4.4.1.2.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS0.Px2.p1.8.m7.4b"><apply id="S3.SS2.SSS0.Px2.p1.8.m7.4.4.cmml" xref="S3.SS2.SSS0.Px2.p1.8.m7.4.4"><eq id="S3.SS2.SSS0.Px2.p1.8.m7.4.4.2.cmml" xref="S3.SS2.SSS0.Px2.p1.8.m7.4.4.2"></eq><ci id="S3.SS2.SSS0.Px2.p1.8.m7.4.4.3.cmml" xref="S3.SS2.SSS0.Px2.p1.8.m7.4.4.3">𝝉</ci><apply id="S3.SS2.SSS0.Px2.p1.8.m7.4.4.1.2.cmml" xref="S3.SS2.SSS0.Px2.p1.8.m7.4.4.1.1"><log id="S3.SS2.SSS0.Px2.p1.8.m7.3.3.cmml" xref="S3.SS2.SSS0.Px2.p1.8.m7.3.3"></log><apply id="S3.SS2.SSS0.Px2.p1.8.m7.4.4.1.1.1.1.cmml" xref="S3.SS2.SSS0.Px2.p1.8.m7.4.4.1.1.1.1"><plus id="S3.SS2.SSS0.Px2.p1.8.m7.4.4.1.1.1.1.1.cmml" xref="S3.SS2.SSS0.Px2.p1.8.m7.4.4.1.1.1.1.1"></plus><cn type="integer" id="S3.SS2.SSS0.Px2.p1.8.m7.4.4.1.1.1.1.2.cmml" xref="S3.SS2.SSS0.Px2.p1.8.m7.4.4.1.1.1.1.2">1</cn><apply id="S3.SS2.SSS0.Px2.p1.8.m7.4.4.1.1.1.1.3.1.cmml" xref="S3.SS2.SSS0.Px2.p1.8.m7.4.4.1.1.1.1.3.2"><exp id="S3.SS2.SSS0.Px2.p1.8.m7.1.1.cmml" xref="S3.SS2.SSS0.Px2.p1.8.m7.1.1"></exp><ci id="S3.SS2.SSS0.Px2.p1.8.m7.2.2.cmml" xref="S3.SS2.SSS0.Px2.p1.8.m7.2.2">𝐯</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS0.Px2.p1.8.m7.4c">\bm{\tau}=\log(1+\exp(\mathbf{v}))</annotation></semantics></math> where <math id="S3.SS2.SSS0.Px2.p1.9.m8.1" class="ltx_Math" alttext="\mathbf{v}" display="inline"><semantics id="S3.SS2.SSS0.Px2.p1.9.m8.1a"><mi id="S3.SS2.SSS0.Px2.p1.9.m8.1.1" xref="S3.SS2.SSS0.Px2.p1.9.m8.1.1.cmml">𝐯</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS0.Px2.p1.9.m8.1b"><ci id="S3.SS2.SSS0.Px2.p1.9.m8.1.1.cmml" xref="S3.SS2.SSS0.Px2.p1.9.m8.1.1">𝐯</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS0.Px2.p1.9.m8.1c">\mathbf{v}</annotation></semantics></math> is the learnable parameter. The <span id="S3.SS2.SSS0.Px2.p1.9.2" class="ltx_text ltx_font_typewriter">FedSparse</span> algorithm is described in Alg. <a href="#alg1" title="Algorithm 1 ‣ Appendix I FedSparse algorithm ‣ An Expectation-Maximization Perspective on Federated Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">1</span></a>, <a href="#alg2" title="Algorithm 2 ‣ Appendix I FedSparse algorithm ‣ An Expectation-Maximization Perspective on Federated Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">2</span></a> in the Appendix.</p>
</div>
</section>
</section>
</section>
<section id="S4" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">4 </span>Related work</h2>

<div id="S4.p1" class="ltx_para">
<p id="S4.p1.1" class="ltx_p"><span id="S4.p1.1.1" class="ltx_text ltx_font_typewriter">FedProx</span> <cite class="ltx_cite ltx_citemacro_citep">[<a href="#bib.bib18" title="" class="ltx_ref">18</a>]</cite> adds a proximal term to the local objective at each shard, so that it prevents the local models from drifting too far from the global model, while still averaging the parameters at the server. In Section <a href="#S2" title="2 A hierarchical model interpretation of federated learning ‣ An Expectation-Maximization Perspective on Federated Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">2</span></a> we showed how such a procedure arises if we use a non-trivial precision for the Gaussian prior over the local parameters of the hierarchical model and apply hard-EM. Furthermore, <span id="S4.p1.1.2" class="ltx_text ltx_font_typewriter">FedAvg</span> has been advocated to be a meta-learning algorithm in <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib13" title="" class="ltx_ref">13</a>]</cite>; with our perspective, this claim is precise and shows that the underlying hierarchical model that <span id="S4.p1.1.3" class="ltx_text ltx_font_typewriter">FedAvg</span> optimizes is the same as the models used in several meta-learning works <cite class="ltx_cite ltx_citemacro_citep">[<a href="#bib.bib10" title="" class="ltx_ref">10</a>, <a href="#bib.bib6" title="" class="ltx_ref">6</a>]</cite>. Furthermore, by performing a single gradient step for the M-step in the context of hard-EM applied at the model of Section <a href="#S2" title="2 A hierarchical model interpretation of federated learning ‣ An Expectation-Maximization Perspective on Federated Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">2</span></a>, we see that we arrive at a procedure that has been previously explored both in a meta-learning context with the Reptile algorithm <cite class="ltx_cite ltx_citemacro_citep">[<a href="#bib.bib25" title="" class="ltx_ref">25</a>]</cite>, as well as the federated learning context with the “generalized” <span id="S4.p1.1.4" class="ltx_text ltx_font_typewriter">FedAvg</span> <cite class="ltx_cite ltx_citemacro_citep">[<a href="#bib.bib28" title="" class="ltx_ref">28</a>]</cite>. One important difference between meta-learning and <span id="S4.p1.1.5" class="ltx_text ltx_font_typewriter">FedAvg</span> is that the latter maximizes the sum, across shards, marginal-likelihood in order to update the globa; parameters, whereas meta-learning methods usually optimize the global parameters such that the finetuned model performs well on the local validation sets. Exploring such parameter estimation methods, as, <em id="S4.p1.1.6" class="ltx_emph ltx_font_italic">e.g.</em>, in <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib6" title="" class="ltx_ref">6</a>]</cite>, in the federated scenario and how these relate to existing approaches that merge meta-learning with federated learning, <em id="S4.p1.1.7" class="ltx_emph ltx_font_italic">e.g.</em> <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib8" title="" class="ltx_ref">8</a>]</cite>, is an interesting avenue for future work. Finally, our EM perspective also applies to optimization works that improve model performance via model replicas <cite class="ltx_cite ltx_citemacro_citep">[<a href="#bib.bib36" title="" class="ltx_ref">36</a>, <a href="#bib.bib27" title="" class="ltx_ref">27</a>]</cite>.</p>
</div>
<div id="S4.p2" class="ltx_para">
<p id="S4.p2.1" class="ltx_p">Adopting a hierachical model perspective for federated learning is not new and has been explored previously in, <em id="S4.p2.1.1" class="ltx_emph ltx_font_italic">e.g.</em>, <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib34" title="" class="ltx_ref">34</a>, <a href="#bib.bib35" title="" class="ltx_ref">35</a>, <a href="#bib.bib7" title="" class="ltx_ref">7</a>, <a href="#bib.bib1" title="" class="ltx_ref">1</a>]</cite>. <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib34" title="" class="ltx_ref">34</a>, <a href="#bib.bib35" title="" class="ltx_ref">35</a>]</cite> consider the local parameters as “given” and then fit a prior model to uncover latent structure. This is only a part of our story; from our EM perspective, the <em id="S4.p2.1.2" class="ltx_emph ltx_font_italic">prior affects the local optimization itself</em>, thus it allow us to, <em id="S4.p2.1.3" class="ltx_emph ltx_font_italic">e.g.</em>, sparsify a neural network locally with <span id="S4.p2.1.4" class="ltx_text ltx_font_typewriter">FedSparse</span>.
<cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib7" title="" class="ltx_ref">7</a>, <a href="#bib.bib1" title="" class="ltx_ref">1</a>]</cite> are more similar to our work; they are both <span id="S4.p2.1.5" class="ltx_text ltx_font_typewriter">FedAvg</span>-like procedures that can be viewed as a way to <em id="S4.p2.1.6" class="ltx_emph ltx_font_italic">aggregate inferences</em> across clients in order to get a “global” posterior approximation (albeit with different procedures) to the parameters of the server model. This is different to our view of <span id="S4.p2.1.7" class="ltx_text ltx_font_typewriter">FedAvg</span> as learning the parameters of a <em id="S4.p2.1.8" class="ltx_emph ltx_font_italic">shared prior</em>, where the server provides the parameters for this prior, across clients. We believe that these views are complimentary to ours and combining the two is an interesting direction that we leave for future work.</p>
</div>
<div id="S4.p3" class="ltx_para">
<p id="S4.p3.3" class="ltx_p">Reducing communication costs is a well-known and explored topic in federated learning. <span id="S4.p3.3.1" class="ltx_text ltx_font_typewriter">FedSparse</span> has close connections to federated dropout <cite class="ltx_cite ltx_citemacro_citep">[<a href="#bib.bib5" title="" class="ltx_ref">5</a>]</cite>, as the latter can be understood via a similar hierarchical model, where gates <math id="S4.p3.1.m1.1" class="ltx_Math" alttext="\mathbf{z}" display="inline"><semantics id="S4.p3.1.m1.1a"><mi id="S4.p3.1.m1.1.1" xref="S4.p3.1.m1.1.1.cmml">𝐳</mi><annotation-xml encoding="MathML-Content" id="S4.p3.1.m1.1b"><ci id="S4.p3.1.m1.1.1.cmml" xref="S4.p3.1.m1.1.1">𝐳</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.p3.1.m1.1c">\mathbf{z}</annotation></semantics></math> are global and have a fixed probability <math id="S4.p3.2.m2.1" class="ltx_Math" alttext="\bm{\theta}" display="inline"><semantics id="S4.p3.2.m2.1a"><mi id="S4.p3.2.m2.1.1" xref="S4.p3.2.m2.1.1.cmml">𝜽</mi><annotation-xml encoding="MathML-Content" id="S4.p3.2.m2.1b"><ci id="S4.p3.2.m2.1.1.cmml" xref="S4.p3.2.m2.1.1">𝜽</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.p3.2.m2.1c">\bm{\theta}</annotation></semantics></math> for both the prior and the approximate posterior.
Compared to federated dropout, <span id="S4.p3.3.2" class="ltx_text ltx_font_typewriter">FedSparse</span> allow us to optimize the dropout rates to the data, such that they satisfy a given accuracy / sparsity trade-off, dictated by the hyperparameter <math id="S4.p3.3.m3.1" class="ltx_Math" alttext="\lambda_{0}" display="inline"><semantics id="S4.p3.3.m3.1a"><msub id="S4.p3.3.m3.1.1" xref="S4.p3.3.m3.1.1.cmml"><mi id="S4.p3.3.m3.1.1.2" xref="S4.p3.3.m3.1.1.2.cmml">λ</mi><mn id="S4.p3.3.m3.1.1.3" xref="S4.p3.3.m3.1.1.3.cmml">0</mn></msub><annotation-xml encoding="MathML-Content" id="S4.p3.3.m3.1b"><apply id="S4.p3.3.m3.1.1.cmml" xref="S4.p3.3.m3.1.1"><csymbol cd="ambiguous" id="S4.p3.3.m3.1.1.1.cmml" xref="S4.p3.3.m3.1.1">subscript</csymbol><ci id="S4.p3.3.m3.1.1.2.cmml" xref="S4.p3.3.m3.1.1.2">𝜆</ci><cn type="integer" id="S4.p3.3.m3.1.1.3.cmml" xref="S4.p3.3.m3.1.1.3">0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.p3.3.m3.1c">\lambda_{0}</annotation></semantics></math>. Another benefit of our EM perspective is that it clarifies that the server can perform gradient-based optimization. As a result, we can harvest the large literature on efficient distributed optimization <cite class="ltx_cite ltx_citemacro_citep">[<a href="#bib.bib20" title="" class="ltx_ref">20</a>, <a href="#bib.bib4" title="" class="ltx_ref">4</a>, <a href="#bib.bib31" title="" class="ltx_ref">31</a>, <a href="#bib.bib33" title="" class="ltx_ref">33</a>]</cite>, which involves gradient quantization, sparsification, and more general compression. On this front, there have also been other works that aim to reduce the communication cost in FL via such approaches <cite class="ltx_cite ltx_citemacro_citep">[<a href="#bib.bib30" title="" class="ltx_ref">30</a>, <a href="#bib.bib11" title="" class="ltx_ref">11</a>]</cite>. In general, such approaches can be orthogonal to <span id="S4.p3.3.3" class="ltx_text ltx_font_typewriter">FedSparse</span> and exploring how they can be incorporated is a promising avenue for future research. Besides parameter / gradient compression, there are also works that reduce communication costs via other means. <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib15" title="" class="ltx_ref">15</a>]</cite> reduces the number of training rounds necessary via a better optimization procedure and <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib19" title="" class="ltx_ref">19</a>]</cite> reduces the amount of gradient queries by reusing gradients from previous iterations. Both of these are orthogonal to <span id="S4.p3.3.4" class="ltx_text ltx_font_typewriter">FedSparse</span>, which decreases communication costs by reducing the number of parameters to transmit. Therefore, they could be combined for even more savings. As an example, we provide an experiment in Appendix <a href="#A5" title="Appendix E Combining SCAFFOLD with FedSparse ‣ An Expectation-Maximization Perspective on Federated Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">E</span></a> where we show the benefits of combining <span id="S4.p3.3.5" class="ltx_text ltx_font_typewriter">FedSparse</span> with <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib15" title="" class="ltx_ref">15</a>]</cite>.</p>
</div>
</section>
<section id="S5" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">5 </span>Experiments</h2>

<div id="S5.p1" class="ltx_para">
<p id="S5.p1.1" class="ltx_p">We verify in three tasks whether <span id="S5.p1.1.1" class="ltx_text ltx_font_typewriter">FedSparse</span> leads to similar or better global models compared to <span id="S5.p1.1.2" class="ltx_text ltx_font_typewriter">FedAvg</span> while providing reductions in communication costs and efficient models. We include two baselines that also reduce communication costs by sparsifying the model; for the first, we consider the federated dropout procedure from <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib5" title="" class="ltx_ref">5</a>]</cite>, which we refer to as <span id="S5.p1.1.3" class="ltx_text ltx_font_typewriter">FedDrop</span>, and for the second, we implement a variant of <span id="S5.p1.1.4" class="ltx_text ltx_font_typewriter">FedAvg</span> where the clients locally perform group <math id="S5.p1.1.m1.1" class="ltx_Math" alttext="L_{1}" display="inline"><semantics id="S5.p1.1.m1.1a"><msub id="S5.p1.1.m1.1.1" xref="S5.p1.1.m1.1.1.cmml"><mi id="S5.p1.1.m1.1.1.2" xref="S5.p1.1.m1.1.1.2.cmml">L</mi><mn id="S5.p1.1.m1.1.1.3" xref="S5.p1.1.m1.1.1.3.cmml">1</mn></msub><annotation-xml encoding="MathML-Content" id="S5.p1.1.m1.1b"><apply id="S5.p1.1.m1.1.1.cmml" xref="S5.p1.1.m1.1.1"><csymbol cd="ambiguous" id="S5.p1.1.m1.1.1.1.cmml" xref="S5.p1.1.m1.1.1">subscript</csymbol><ci id="S5.p1.1.m1.1.1.2.cmml" xref="S5.p1.1.m1.1.1.2">𝐿</ci><cn type="integer" id="S5.p1.1.m1.1.1.3.cmml" xref="S5.p1.1.m1.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.p1.1.m1.1c">L_{1}</annotation></semantics></math> regularization <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib32" title="" class="ltx_ref">32</a>]</cite> in order to sparsify their copy of the model.
The latter, which we refer to as <span id="S5.p1.1.5" class="ltx_text ltx_font_typewriter">FedL1</span>, is closer to what we do in <span id="S5.p1.1.6" class="ltx_text ltx_font_typewriter">FedSparse</span> and can similarly reduce the communication costs by employing a soft thresholding step on the model before communicating. For each task, we present the results for <span id="S5.p1.1.7" class="ltx_text ltx_font_typewriter">FedSparse</span> with regularization strengths that target three sparsity levels: low, mid, and high. For the <span id="S5.p1.1.8" class="ltx_text ltx_font_typewriter">FedDrop</span> baseline, we experiment with multiple combinations of dropout probabilities for the convolutional and fully connected layers. For <span id="S5.p1.1.9" class="ltx_text ltx_font_typewriter">FedL1</span>, we considered a variety of regularization strengths. For each of these, we report the setting that performs best in terms of accuracy / communication trade-off.</p>
</div>
<div id="S5.p2" class="ltx_para">
<p id="S5.p2.1" class="ltx_p">The first task we consider is a federated version of CIFAR10 classification where we partition the data among 100 shards in a non-i.i.d. way following <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib12" title="" class="ltx_ref">12</a>]</cite> and train a LeNet-5 convolutional architecture <cite class="ltx_cite ltx_citemacro_citep">[<a href="#bib.bib17" title="" class="ltx_ref">17</a>]</cite> for 1k rounds. For the second task, we consider the 500 shard federated version of CIFAR100 classification from <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib28" title="" class="ltx_ref">28</a>]</cite>, with a ResNet20 which we optimize for 6k rounds. For the final task, we considered the non-i.i.d. Femnist classification and we use the same configuration as CIFAR10, but we optimize the model for 6k rounds. More details can be found in Appendix <a href="#A1" title="Appendix A Experimental details ‣ An Expectation-Maximization Perspective on Federated Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">A</span></a>.</p>
</div>
<div id="S5.p3" class="ltx_para">
<p id="S5.p3.1" class="ltx_p">We evaluate <span id="S5.p3.1.1" class="ltx_text ltx_font_typewriter">FedSparse</span> and the baselines on two metrics that highlight the tradeoffs between accuracy and communication costs. On both metrics, the x-axis represents the total communication cost incurred up until that point, and the y-axis represents two distinct model accuracies. The first one corresponds to the accuracy of the global model on the union of the shard test sets, whereas the second one corresponds to the average accuracy of the shard-specific “local models” on the shard-specific test sets. The “local model” on each shard is the model configuration that the shard last communicated to the server and serves as a proxy for the personalized model performance on each shard. The latter metric is motivated from the meta-learning <cite class="ltx_cite ltx_citemacro_citep">[<a href="#bib.bib13" title="" class="ltx_ref">13</a>]</cite> and hierarchical model view of federated learning and corresponds to using the local posteriors for prediction on the local test set instead of the server-side priors. All experiments were implemented using PyTorch <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib26" title="" class="ltx_ref">26</a>]</cite>.</p>
</div>
<section id="S5.SS1" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">5.1 </span>Experimental results</h3>

<div id="S5.SS1.p1" class="ltx_para">
<p id="S5.SS1.p1.1" class="ltx_p">The results from our experiments can be found in the following table and figures, where we report the average metrics and standard errors of each from 3 different random seeds. Overall, we observed that the <span id="S5.SS1.p1.1.1" class="ltx_text ltx_font_typewriter">FedSparse</span> models achieve their final sparsity ratios early in training, <em id="S5.SS1.p1.1.2" class="ltx_emph ltx_font_italic">i.e.</em>, after 30-50 rounds, which quickly reduces the communication costs for each round (Appendix <a href="#A2" title="Appendix B Evolution of sparsity ‣ An Expectation-Maximization Perspective on Federated Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">B</span></a>).</p>
</div>
<figure id="S5.T2" class="ltx_table">
<div class="ltx_flex_figure ltx_flex_table">
<div class="ltx_flex_cell ltx_flex_size_2">
<figure id="S5.T2.22" class="ltx_figure ltx_figure_panel ltx_minipage ltx_align_center ltx_align_bottom" style="width:216.8pt;">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span id="S5.T2.22.23.1.1" class="ltx_text" style="font-size:90%;">Table 1</span>: </span><span id="S5.T2.22.24.2" class="ltx_text" style="font-size:90%;">Cifar10</span></figcaption>
<div id="S5.T2.22.22" class="ltx_inline-block ltx_align_center ltx_transformed_outer" style="width:433.6pt;height:271pt;vertical-align:-0.0pt;"><span class="ltx_transformed_inner" style="transform:translate(97.3pt,-60.8pt) scale(1.81420118947602,1.81420118947602) ;">
<table id="S5.T2.22.22.22" class="ltx_tabular ltx_align_middle">
<tr id="S5.T2.22.22.22.23" class="ltx_tr">
<td id="S5.T2.22.22.22.23.1" class="ltx_td ltx_align_left ltx_border_tt" style="padding-left:2.0pt;padding-right:2.0pt;">Method</td>
<td id="S5.T2.22.22.22.23.2" class="ltx_td ltx_align_center ltx_border_tt" style="padding-left:2.0pt;padding-right:2.0pt;">
<span id="S5.T2.22.22.22.23.2.1" class="ltx_text"></span> <span id="S5.T2.22.22.22.23.2.2" class="ltx_text">
<span id="S5.T2.22.22.22.23.2.2.1" class="ltx_tabular ltx_align_middle">
<span id="S5.T2.22.22.22.23.2.2.1.1" class="ltx_tr">
<span id="S5.T2.22.22.22.23.2.2.1.1.1" class="ltx_td ltx_nopad_r ltx_align_center" style="padding-left:2.0pt;padding-right:2.0pt;">Global</span></span>
<span id="S5.T2.22.22.22.23.2.2.1.2" class="ltx_tr">
<span id="S5.T2.22.22.22.23.2.2.1.2.1" class="ltx_td ltx_nopad_r ltx_align_center" style="padding-left:2.0pt;padding-right:2.0pt;">acc.</span></span>
</span></span><span id="S5.T2.22.22.22.23.2.3" class="ltx_text"></span></td>
<td id="S5.T2.22.22.22.23.3" class="ltx_td ltx_align_center ltx_border_tt" style="padding-left:2.0pt;padding-right:2.0pt;">
<span id="S5.T2.22.22.22.23.3.1" class="ltx_text"></span> <span id="S5.T2.22.22.22.23.3.2" class="ltx_text">
<span id="S5.T2.22.22.22.23.3.2.1" class="ltx_tabular ltx_align_middle">
<span id="S5.T2.22.22.22.23.3.2.1.1" class="ltx_tr">
<span id="S5.T2.22.22.22.23.3.2.1.1.1" class="ltx_td ltx_nopad_r ltx_align_center" style="padding-left:2.0pt;padding-right:2.0pt;">Local</span></span>
<span id="S5.T2.22.22.22.23.3.2.1.2" class="ltx_tr">
<span id="S5.T2.22.22.22.23.3.2.1.2.1" class="ltx_td ltx_nopad_r ltx_align_center" style="padding-left:2.0pt;padding-right:2.0pt;">acc.</span></span>
</span></span><span id="S5.T2.22.22.22.23.3.3" class="ltx_text"></span></td>
<td id="S5.T2.22.22.22.23.4" class="ltx_td ltx_align_center ltx_border_tt" style="padding-left:2.0pt;padding-right:2.0pt;">
<span id="S5.T2.22.22.22.23.4.1" class="ltx_text"></span> <span id="S5.T2.22.22.22.23.4.2" class="ltx_text">
<span id="S5.T2.22.22.22.23.4.2.1" class="ltx_tabular ltx_align_middle">
<span id="S5.T2.22.22.22.23.4.2.1.1" class="ltx_tr">
<span id="S5.T2.22.22.22.23.4.2.1.1.1" class="ltx_td ltx_nopad_r ltx_align_center" style="padding-left:2.0pt;padding-right:2.0pt;">GB</span></span>
<span id="S5.T2.22.22.22.23.4.2.1.2" class="ltx_tr">
<span id="S5.T2.22.22.22.23.4.2.1.2.1" class="ltx_td ltx_nopad_r ltx_align_center" style="padding-left:2.0pt;padding-right:2.0pt;">comm.</span></span>
</span></span><span id="S5.T2.22.22.22.23.4.3" class="ltx_text"></span></td>
<td id="S5.T2.22.22.22.23.5" class="ltx_td ltx_align_center ltx_border_tt" style="padding-left:2.0pt;padding-right:2.0pt;">Sparsity</td>
</tr>
<tr id="S5.T2.3.3.3.3" class="ltx_tr">
<td id="S5.T2.3.3.3.3.4" class="ltx_td ltx_align_left ltx_border_t" style="padding-left:2.0pt;padding-right:2.0pt;"><span id="S5.T2.3.3.3.3.4.1" class="ltx_text ltx_font_typewriter">FedAvg</span></td>
<td id="S5.T2.1.1.1.1.1" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:2.0pt;padding-right:2.0pt;"><math id="S5.T2.1.1.1.1.1.m1.1" class="ltx_Math" alttext="69.7_{\pm 0.3}" display="inline"><semantics id="S5.T2.1.1.1.1.1.m1.1a"><msub id="S5.T2.1.1.1.1.1.m1.1.1" xref="S5.T2.1.1.1.1.1.m1.1.1.cmml"><mn id="S5.T2.1.1.1.1.1.m1.1.1.2" xref="S5.T2.1.1.1.1.1.m1.1.1.2.cmml">69.7</mn><mrow id="S5.T2.1.1.1.1.1.m1.1.1.3" xref="S5.T2.1.1.1.1.1.m1.1.1.3.cmml"><mo id="S5.T2.1.1.1.1.1.m1.1.1.3a" xref="S5.T2.1.1.1.1.1.m1.1.1.3.cmml">±</mo><mn id="S5.T2.1.1.1.1.1.m1.1.1.3.2" xref="S5.T2.1.1.1.1.1.m1.1.1.3.2.cmml">0.3</mn></mrow></msub><annotation-xml encoding="MathML-Content" id="S5.T2.1.1.1.1.1.m1.1b"><apply id="S5.T2.1.1.1.1.1.m1.1.1.cmml" xref="S5.T2.1.1.1.1.1.m1.1.1"><csymbol cd="ambiguous" id="S5.T2.1.1.1.1.1.m1.1.1.1.cmml" xref="S5.T2.1.1.1.1.1.m1.1.1">subscript</csymbol><cn type="float" id="S5.T2.1.1.1.1.1.m1.1.1.2.cmml" xref="S5.T2.1.1.1.1.1.m1.1.1.2">69.7</cn><apply id="S5.T2.1.1.1.1.1.m1.1.1.3.cmml" xref="S5.T2.1.1.1.1.1.m1.1.1.3"><csymbol cd="latexml" id="S5.T2.1.1.1.1.1.m1.1.1.3.1.cmml" xref="S5.T2.1.1.1.1.1.m1.1.1.3">plus-or-minus</csymbol><cn type="float" id="S5.T2.1.1.1.1.1.m1.1.1.3.2.cmml" xref="S5.T2.1.1.1.1.1.m1.1.1.3.2">0.3</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.T2.1.1.1.1.1.m1.1c">69.7_{\pm 0.3}</annotation></semantics></math></td>
<td id="S5.T2.2.2.2.2.2" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:2.0pt;padding-right:2.0pt;"><math id="S5.T2.2.2.2.2.2.m1.1" class="ltx_Math" alttext="86.2_{\pm 0.2}" display="inline"><semantics id="S5.T2.2.2.2.2.2.m1.1a"><msub id="S5.T2.2.2.2.2.2.m1.1.1" xref="S5.T2.2.2.2.2.2.m1.1.1.cmml"><mn id="S5.T2.2.2.2.2.2.m1.1.1.2" xref="S5.T2.2.2.2.2.2.m1.1.1.2.cmml">86.2</mn><mrow id="S5.T2.2.2.2.2.2.m1.1.1.3" xref="S5.T2.2.2.2.2.2.m1.1.1.3.cmml"><mo id="S5.T2.2.2.2.2.2.m1.1.1.3a" xref="S5.T2.2.2.2.2.2.m1.1.1.3.cmml">±</mo><mn id="S5.T2.2.2.2.2.2.m1.1.1.3.2" xref="S5.T2.2.2.2.2.2.m1.1.1.3.2.cmml">0.2</mn></mrow></msub><annotation-xml encoding="MathML-Content" id="S5.T2.2.2.2.2.2.m1.1b"><apply id="S5.T2.2.2.2.2.2.m1.1.1.cmml" xref="S5.T2.2.2.2.2.2.m1.1.1"><csymbol cd="ambiguous" id="S5.T2.2.2.2.2.2.m1.1.1.1.cmml" xref="S5.T2.2.2.2.2.2.m1.1.1">subscript</csymbol><cn type="float" id="S5.T2.2.2.2.2.2.m1.1.1.2.cmml" xref="S5.T2.2.2.2.2.2.m1.1.1.2">86.2</cn><apply id="S5.T2.2.2.2.2.2.m1.1.1.3.cmml" xref="S5.T2.2.2.2.2.2.m1.1.1.3"><csymbol cd="latexml" id="S5.T2.2.2.2.2.2.m1.1.1.3.1.cmml" xref="S5.T2.2.2.2.2.2.m1.1.1.3">plus-or-minus</csymbol><cn type="float" id="S5.T2.2.2.2.2.2.m1.1.1.3.2.cmml" xref="S5.T2.2.2.2.2.2.m1.1.1.3.2">0.2</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.T2.2.2.2.2.2.m1.1c">86.2_{\pm 0.2}</annotation></semantics></math></td>
<td id="S5.T2.3.3.3.3.3" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:2.0pt;padding-right:2.0pt;"><math id="S5.T2.3.3.3.3.3.m1.1" class="ltx_Math" alttext="65_{\pm 0}" display="inline"><semantics id="S5.T2.3.3.3.3.3.m1.1a"><msub id="S5.T2.3.3.3.3.3.m1.1.1" xref="S5.T2.3.3.3.3.3.m1.1.1.cmml"><mn id="S5.T2.3.3.3.3.3.m1.1.1.2" xref="S5.T2.3.3.3.3.3.m1.1.1.2.cmml">65</mn><mrow id="S5.T2.3.3.3.3.3.m1.1.1.3" xref="S5.T2.3.3.3.3.3.m1.1.1.3.cmml"><mo id="S5.T2.3.3.3.3.3.m1.1.1.3a" xref="S5.T2.3.3.3.3.3.m1.1.1.3.cmml">±</mo><mn id="S5.T2.3.3.3.3.3.m1.1.1.3.2" xref="S5.T2.3.3.3.3.3.m1.1.1.3.2.cmml">0</mn></mrow></msub><annotation-xml encoding="MathML-Content" id="S5.T2.3.3.3.3.3.m1.1b"><apply id="S5.T2.3.3.3.3.3.m1.1.1.cmml" xref="S5.T2.3.3.3.3.3.m1.1.1"><csymbol cd="ambiguous" id="S5.T2.3.3.3.3.3.m1.1.1.1.cmml" xref="S5.T2.3.3.3.3.3.m1.1.1">subscript</csymbol><cn type="integer" id="S5.T2.3.3.3.3.3.m1.1.1.2.cmml" xref="S5.T2.3.3.3.3.3.m1.1.1.2">65</cn><apply id="S5.T2.3.3.3.3.3.m1.1.1.3.cmml" xref="S5.T2.3.3.3.3.3.m1.1.1.3"><csymbol cd="latexml" id="S5.T2.3.3.3.3.3.m1.1.1.3.1.cmml" xref="S5.T2.3.3.3.3.3.m1.1.1.3">plus-or-minus</csymbol><cn type="integer" id="S5.T2.3.3.3.3.3.m1.1.1.3.2.cmml" xref="S5.T2.3.3.3.3.3.m1.1.1.3.2">0</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.T2.3.3.3.3.3.m1.1c">65_{\pm 0}</annotation></semantics></math></td>
<td id="S5.T2.3.3.3.3.5" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:2.0pt;padding-right:2.0pt;">-</td>
</tr>
<tr id="S5.T2.6.6.6.6" class="ltx_tr">
<td id="S5.T2.6.6.6.6.4" class="ltx_td ltx_align_left" style="padding-left:2.0pt;padding-right:2.0pt;"><span id="S5.T2.6.6.6.6.4.1" class="ltx_text ltx_font_typewriter">FedDrop</span></td>
<td id="S5.T2.4.4.4.4.1" class="ltx_td ltx_align_center" style="padding-left:2.0pt;padding-right:2.0pt;"><math id="S5.T2.4.4.4.4.1.m1.1" class="ltx_Math" alttext="69.9_{\pm 0.7}" display="inline"><semantics id="S5.T2.4.4.4.4.1.m1.1a"><msub id="S5.T2.4.4.4.4.1.m1.1.1" xref="S5.T2.4.4.4.4.1.m1.1.1.cmml"><mn id="S5.T2.4.4.4.4.1.m1.1.1.2" xref="S5.T2.4.4.4.4.1.m1.1.1.2.cmml">69.9</mn><mrow id="S5.T2.4.4.4.4.1.m1.1.1.3" xref="S5.T2.4.4.4.4.1.m1.1.1.3.cmml"><mo id="S5.T2.4.4.4.4.1.m1.1.1.3a" xref="S5.T2.4.4.4.4.1.m1.1.1.3.cmml">±</mo><mn id="S5.T2.4.4.4.4.1.m1.1.1.3.2" xref="S5.T2.4.4.4.4.1.m1.1.1.3.2.cmml">0.7</mn></mrow></msub><annotation-xml encoding="MathML-Content" id="S5.T2.4.4.4.4.1.m1.1b"><apply id="S5.T2.4.4.4.4.1.m1.1.1.cmml" xref="S5.T2.4.4.4.4.1.m1.1.1"><csymbol cd="ambiguous" id="S5.T2.4.4.4.4.1.m1.1.1.1.cmml" xref="S5.T2.4.4.4.4.1.m1.1.1">subscript</csymbol><cn type="float" id="S5.T2.4.4.4.4.1.m1.1.1.2.cmml" xref="S5.T2.4.4.4.4.1.m1.1.1.2">69.9</cn><apply id="S5.T2.4.4.4.4.1.m1.1.1.3.cmml" xref="S5.T2.4.4.4.4.1.m1.1.1.3"><csymbol cd="latexml" id="S5.T2.4.4.4.4.1.m1.1.1.3.1.cmml" xref="S5.T2.4.4.4.4.1.m1.1.1.3">plus-or-minus</csymbol><cn type="float" id="S5.T2.4.4.4.4.1.m1.1.1.3.2.cmml" xref="S5.T2.4.4.4.4.1.m1.1.1.3.2">0.7</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.T2.4.4.4.4.1.m1.1c">69.9_{\pm 0.7}</annotation></semantics></math></td>
<td id="S5.T2.5.5.5.5.2" class="ltx_td ltx_align_center" style="padding-left:2.0pt;padding-right:2.0pt;"><math id="S5.T2.5.5.5.5.2.m1.1" class="ltx_Math" alttext="84.9_{\pm 0.2}" display="inline"><semantics id="S5.T2.5.5.5.5.2.m1.1a"><msub id="S5.T2.5.5.5.5.2.m1.1.1" xref="S5.T2.5.5.5.5.2.m1.1.1.cmml"><mn id="S5.T2.5.5.5.5.2.m1.1.1.2" xref="S5.T2.5.5.5.5.2.m1.1.1.2.cmml">84.9</mn><mrow id="S5.T2.5.5.5.5.2.m1.1.1.3" xref="S5.T2.5.5.5.5.2.m1.1.1.3.cmml"><mo id="S5.T2.5.5.5.5.2.m1.1.1.3a" xref="S5.T2.5.5.5.5.2.m1.1.1.3.cmml">±</mo><mn id="S5.T2.5.5.5.5.2.m1.1.1.3.2" xref="S5.T2.5.5.5.5.2.m1.1.1.3.2.cmml">0.2</mn></mrow></msub><annotation-xml encoding="MathML-Content" id="S5.T2.5.5.5.5.2.m1.1b"><apply id="S5.T2.5.5.5.5.2.m1.1.1.cmml" xref="S5.T2.5.5.5.5.2.m1.1.1"><csymbol cd="ambiguous" id="S5.T2.5.5.5.5.2.m1.1.1.1.cmml" xref="S5.T2.5.5.5.5.2.m1.1.1">subscript</csymbol><cn type="float" id="S5.T2.5.5.5.5.2.m1.1.1.2.cmml" xref="S5.T2.5.5.5.5.2.m1.1.1.2">84.9</cn><apply id="S5.T2.5.5.5.5.2.m1.1.1.3.cmml" xref="S5.T2.5.5.5.5.2.m1.1.1.3"><csymbol cd="latexml" id="S5.T2.5.5.5.5.2.m1.1.1.3.1.cmml" xref="S5.T2.5.5.5.5.2.m1.1.1.3">plus-or-minus</csymbol><cn type="float" id="S5.T2.5.5.5.5.2.m1.1.1.3.2.cmml" xref="S5.T2.5.5.5.5.2.m1.1.1.3.2">0.2</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.T2.5.5.5.5.2.m1.1c">84.9_{\pm 0.2}</annotation></semantics></math></td>
<td id="S5.T2.6.6.6.6.3" class="ltx_td ltx_align_center" style="padding-left:2.0pt;padding-right:2.0pt;"><math id="S5.T2.6.6.6.6.3.m1.1" class="ltx_Math" alttext="34_{\pm 0}" display="inline"><semantics id="S5.T2.6.6.6.6.3.m1.1a"><msub id="S5.T2.6.6.6.6.3.m1.1.1" xref="S5.T2.6.6.6.6.3.m1.1.1.cmml"><mn id="S5.T2.6.6.6.6.3.m1.1.1.2" xref="S5.T2.6.6.6.6.3.m1.1.1.2.cmml">34</mn><mrow id="S5.T2.6.6.6.6.3.m1.1.1.3" xref="S5.T2.6.6.6.6.3.m1.1.1.3.cmml"><mo id="S5.T2.6.6.6.6.3.m1.1.1.3a" xref="S5.T2.6.6.6.6.3.m1.1.1.3.cmml">±</mo><mn id="S5.T2.6.6.6.6.3.m1.1.1.3.2" xref="S5.T2.6.6.6.6.3.m1.1.1.3.2.cmml">0</mn></mrow></msub><annotation-xml encoding="MathML-Content" id="S5.T2.6.6.6.6.3.m1.1b"><apply id="S5.T2.6.6.6.6.3.m1.1.1.cmml" xref="S5.T2.6.6.6.6.3.m1.1.1"><csymbol cd="ambiguous" id="S5.T2.6.6.6.6.3.m1.1.1.1.cmml" xref="S5.T2.6.6.6.6.3.m1.1.1">subscript</csymbol><cn type="integer" id="S5.T2.6.6.6.6.3.m1.1.1.2.cmml" xref="S5.T2.6.6.6.6.3.m1.1.1.2">34</cn><apply id="S5.T2.6.6.6.6.3.m1.1.1.3.cmml" xref="S5.T2.6.6.6.6.3.m1.1.1.3"><csymbol cd="latexml" id="S5.T2.6.6.6.6.3.m1.1.1.3.1.cmml" xref="S5.T2.6.6.6.6.3.m1.1.1.3">plus-or-minus</csymbol><cn type="integer" id="S5.T2.6.6.6.6.3.m1.1.1.3.2.cmml" xref="S5.T2.6.6.6.6.3.m1.1.1.3.2">0</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.T2.6.6.6.6.3.m1.1c">34_{\pm 0}</annotation></semantics></math></td>
<td id="S5.T2.6.6.6.6.5" class="ltx_td ltx_align_center" style="padding-left:2.0pt;padding-right:2.0pt;">-</td>
</tr>
<tr id="S5.T2.10.10.10.10" class="ltx_tr">
<td id="S5.T2.10.10.10.10.5" class="ltx_td ltx_align_left" style="padding-left:2.0pt;padding-right:2.0pt;"><span id="S5.T2.10.10.10.10.5.1" class="ltx_text ltx_font_typewriter">FedL1</span></td>
<td id="S5.T2.7.7.7.7.1" class="ltx_td ltx_align_center" style="padding-left:2.0pt;padding-right:2.0pt;"><math id="S5.T2.7.7.7.7.1.m1.1" class="ltx_Math" alttext="62.1_{\pm 0.8}" display="inline"><semantics id="S5.T2.7.7.7.7.1.m1.1a"><msub id="S5.T2.7.7.7.7.1.m1.1.1" xref="S5.T2.7.7.7.7.1.m1.1.1.cmml"><mn id="S5.T2.7.7.7.7.1.m1.1.1.2" xref="S5.T2.7.7.7.7.1.m1.1.1.2.cmml">62.1</mn><mrow id="S5.T2.7.7.7.7.1.m1.1.1.3" xref="S5.T2.7.7.7.7.1.m1.1.1.3.cmml"><mo id="S5.T2.7.7.7.7.1.m1.1.1.3a" xref="S5.T2.7.7.7.7.1.m1.1.1.3.cmml">±</mo><mn id="S5.T2.7.7.7.7.1.m1.1.1.3.2" xref="S5.T2.7.7.7.7.1.m1.1.1.3.2.cmml">0.8</mn></mrow></msub><annotation-xml encoding="MathML-Content" id="S5.T2.7.7.7.7.1.m1.1b"><apply id="S5.T2.7.7.7.7.1.m1.1.1.cmml" xref="S5.T2.7.7.7.7.1.m1.1.1"><csymbol cd="ambiguous" id="S5.T2.7.7.7.7.1.m1.1.1.1.cmml" xref="S5.T2.7.7.7.7.1.m1.1.1">subscript</csymbol><cn type="float" id="S5.T2.7.7.7.7.1.m1.1.1.2.cmml" xref="S5.T2.7.7.7.7.1.m1.1.1.2">62.1</cn><apply id="S5.T2.7.7.7.7.1.m1.1.1.3.cmml" xref="S5.T2.7.7.7.7.1.m1.1.1.3"><csymbol cd="latexml" id="S5.T2.7.7.7.7.1.m1.1.1.3.1.cmml" xref="S5.T2.7.7.7.7.1.m1.1.1.3">plus-or-minus</csymbol><cn type="float" id="S5.T2.7.7.7.7.1.m1.1.1.3.2.cmml" xref="S5.T2.7.7.7.7.1.m1.1.1.3.2">0.8</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.T2.7.7.7.7.1.m1.1c">62.1_{\pm 0.8}</annotation></semantics></math></td>
<td id="S5.T2.8.8.8.8.2" class="ltx_td ltx_align_center" style="padding-left:2.0pt;padding-right:2.0pt;"><math id="S5.T2.8.8.8.8.2.m1.1" class="ltx_Math" alttext="82.5_{\pm 0.3}" display="inline"><semantics id="S5.T2.8.8.8.8.2.m1.1a"><msub id="S5.T2.8.8.8.8.2.m1.1.1" xref="S5.T2.8.8.8.8.2.m1.1.1.cmml"><mn id="S5.T2.8.8.8.8.2.m1.1.1.2" xref="S5.T2.8.8.8.8.2.m1.1.1.2.cmml">82.5</mn><mrow id="S5.T2.8.8.8.8.2.m1.1.1.3" xref="S5.T2.8.8.8.8.2.m1.1.1.3.cmml"><mo id="S5.T2.8.8.8.8.2.m1.1.1.3a" xref="S5.T2.8.8.8.8.2.m1.1.1.3.cmml">±</mo><mn id="S5.T2.8.8.8.8.2.m1.1.1.3.2" xref="S5.T2.8.8.8.8.2.m1.1.1.3.2.cmml">0.3</mn></mrow></msub><annotation-xml encoding="MathML-Content" id="S5.T2.8.8.8.8.2.m1.1b"><apply id="S5.T2.8.8.8.8.2.m1.1.1.cmml" xref="S5.T2.8.8.8.8.2.m1.1.1"><csymbol cd="ambiguous" id="S5.T2.8.8.8.8.2.m1.1.1.1.cmml" xref="S5.T2.8.8.8.8.2.m1.1.1">subscript</csymbol><cn type="float" id="S5.T2.8.8.8.8.2.m1.1.1.2.cmml" xref="S5.T2.8.8.8.8.2.m1.1.1.2">82.5</cn><apply id="S5.T2.8.8.8.8.2.m1.1.1.3.cmml" xref="S5.T2.8.8.8.8.2.m1.1.1.3"><csymbol cd="latexml" id="S5.T2.8.8.8.8.2.m1.1.1.3.1.cmml" xref="S5.T2.8.8.8.8.2.m1.1.1.3">plus-or-minus</csymbol><cn type="float" id="S5.T2.8.8.8.8.2.m1.1.1.3.2.cmml" xref="S5.T2.8.8.8.8.2.m1.1.1.3.2">0.3</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.T2.8.8.8.8.2.m1.1c">82.5_{\pm 0.3}</annotation></semantics></math></td>
<td id="S5.T2.9.9.9.9.3" class="ltx_td ltx_align_center" style="padding-left:2.0pt;padding-right:2.0pt;"><math id="S5.T2.9.9.9.9.3.m1.1" class="ltx_Math" alttext="36_{\pm 1}" display="inline"><semantics id="S5.T2.9.9.9.9.3.m1.1a"><msub id="S5.T2.9.9.9.9.3.m1.1.1" xref="S5.T2.9.9.9.9.3.m1.1.1.cmml"><mn id="S5.T2.9.9.9.9.3.m1.1.1.2" xref="S5.T2.9.9.9.9.3.m1.1.1.2.cmml">36</mn><mrow id="S5.T2.9.9.9.9.3.m1.1.1.3" xref="S5.T2.9.9.9.9.3.m1.1.1.3.cmml"><mo id="S5.T2.9.9.9.9.3.m1.1.1.3a" xref="S5.T2.9.9.9.9.3.m1.1.1.3.cmml">±</mo><mn id="S5.T2.9.9.9.9.3.m1.1.1.3.2" xref="S5.T2.9.9.9.9.3.m1.1.1.3.2.cmml">1</mn></mrow></msub><annotation-xml encoding="MathML-Content" id="S5.T2.9.9.9.9.3.m1.1b"><apply id="S5.T2.9.9.9.9.3.m1.1.1.cmml" xref="S5.T2.9.9.9.9.3.m1.1.1"><csymbol cd="ambiguous" id="S5.T2.9.9.9.9.3.m1.1.1.1.cmml" xref="S5.T2.9.9.9.9.3.m1.1.1">subscript</csymbol><cn type="integer" id="S5.T2.9.9.9.9.3.m1.1.1.2.cmml" xref="S5.T2.9.9.9.9.3.m1.1.1.2">36</cn><apply id="S5.T2.9.9.9.9.3.m1.1.1.3.cmml" xref="S5.T2.9.9.9.9.3.m1.1.1.3"><csymbol cd="latexml" id="S5.T2.9.9.9.9.3.m1.1.1.3.1.cmml" xref="S5.T2.9.9.9.9.3.m1.1.1.3">plus-or-minus</csymbol><cn type="integer" id="S5.T2.9.9.9.9.3.m1.1.1.3.2.cmml" xref="S5.T2.9.9.9.9.3.m1.1.1.3.2">1</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.T2.9.9.9.9.3.m1.1c">36_{\pm 1}</annotation></semantics></math></td>
<td id="S5.T2.10.10.10.10.4" class="ltx_td ltx_align_center" style="padding-left:2.0pt;padding-right:2.0pt;"><math id="S5.T2.10.10.10.10.4.m1.1" class="ltx_Math" alttext="61.8_{\pm 1.8}" display="inline"><semantics id="S5.T2.10.10.10.10.4.m1.1a"><msub id="S5.T2.10.10.10.10.4.m1.1.1" xref="S5.T2.10.10.10.10.4.m1.1.1.cmml"><mn id="S5.T2.10.10.10.10.4.m1.1.1.2" xref="S5.T2.10.10.10.10.4.m1.1.1.2.cmml">61.8</mn><mrow id="S5.T2.10.10.10.10.4.m1.1.1.3" xref="S5.T2.10.10.10.10.4.m1.1.1.3.cmml"><mo id="S5.T2.10.10.10.10.4.m1.1.1.3a" xref="S5.T2.10.10.10.10.4.m1.1.1.3.cmml">±</mo><mn id="S5.T2.10.10.10.10.4.m1.1.1.3.2" xref="S5.T2.10.10.10.10.4.m1.1.1.3.2.cmml">1.8</mn></mrow></msub><annotation-xml encoding="MathML-Content" id="S5.T2.10.10.10.10.4.m1.1b"><apply id="S5.T2.10.10.10.10.4.m1.1.1.cmml" xref="S5.T2.10.10.10.10.4.m1.1.1"><csymbol cd="ambiguous" id="S5.T2.10.10.10.10.4.m1.1.1.1.cmml" xref="S5.T2.10.10.10.10.4.m1.1.1">subscript</csymbol><cn type="float" id="S5.T2.10.10.10.10.4.m1.1.1.2.cmml" xref="S5.T2.10.10.10.10.4.m1.1.1.2">61.8</cn><apply id="S5.T2.10.10.10.10.4.m1.1.1.3.cmml" xref="S5.T2.10.10.10.10.4.m1.1.1.3"><csymbol cd="latexml" id="S5.T2.10.10.10.10.4.m1.1.1.3.1.cmml" xref="S5.T2.10.10.10.10.4.m1.1.1.3">plus-or-minus</csymbol><cn type="float" id="S5.T2.10.10.10.10.4.m1.1.1.3.2.cmml" xref="S5.T2.10.10.10.10.4.m1.1.1.3.2">1.8</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.T2.10.10.10.10.4.m1.1c">61.8_{\pm 1.8}</annotation></semantics></math></td>
</tr>
<tr id="S5.T2.14.14.14.14" class="ltx_tr">
<td id="S5.T2.14.14.14.14.5" class="ltx_td ltx_align_left ltx_border_t" style="padding-left:2.0pt;padding-right:2.0pt;">
<span id="S5.T2.14.14.14.14.5.1" class="ltx_text ltx_font_typewriter">FedSparse</span>, low</td>
<td id="S5.T2.11.11.11.11.1" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:2.0pt;padding-right:2.0pt;"><math id="S5.T2.11.11.11.11.1.m1.1" class="ltx_Math" alttext="68.9_{\pm 0.5}" display="inline"><semantics id="S5.T2.11.11.11.11.1.m1.1a"><msub id="S5.T2.11.11.11.11.1.m1.1.1" xref="S5.T2.11.11.11.11.1.m1.1.1.cmml"><mn id="S5.T2.11.11.11.11.1.m1.1.1.2" xref="S5.T2.11.11.11.11.1.m1.1.1.2.cmml">68.9</mn><mrow id="S5.T2.11.11.11.11.1.m1.1.1.3" xref="S5.T2.11.11.11.11.1.m1.1.1.3.cmml"><mo id="S5.T2.11.11.11.11.1.m1.1.1.3a" xref="S5.T2.11.11.11.11.1.m1.1.1.3.cmml">±</mo><mn id="S5.T2.11.11.11.11.1.m1.1.1.3.2" xref="S5.T2.11.11.11.11.1.m1.1.1.3.2.cmml">0.5</mn></mrow></msub><annotation-xml encoding="MathML-Content" id="S5.T2.11.11.11.11.1.m1.1b"><apply id="S5.T2.11.11.11.11.1.m1.1.1.cmml" xref="S5.T2.11.11.11.11.1.m1.1.1"><csymbol cd="ambiguous" id="S5.T2.11.11.11.11.1.m1.1.1.1.cmml" xref="S5.T2.11.11.11.11.1.m1.1.1">subscript</csymbol><cn type="float" id="S5.T2.11.11.11.11.1.m1.1.1.2.cmml" xref="S5.T2.11.11.11.11.1.m1.1.1.2">68.9</cn><apply id="S5.T2.11.11.11.11.1.m1.1.1.3.cmml" xref="S5.T2.11.11.11.11.1.m1.1.1.3"><csymbol cd="latexml" id="S5.T2.11.11.11.11.1.m1.1.1.3.1.cmml" xref="S5.T2.11.11.11.11.1.m1.1.1.3">plus-or-minus</csymbol><cn type="float" id="S5.T2.11.11.11.11.1.m1.1.1.3.2.cmml" xref="S5.T2.11.11.11.11.1.m1.1.1.3.2">0.5</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.T2.11.11.11.11.1.m1.1c">68.9_{\pm 0.5}</annotation></semantics></math></td>
<td id="S5.T2.12.12.12.12.2" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:2.0pt;padding-right:2.0pt;"><math id="S5.T2.12.12.12.12.2.m1.1" class="ltx_Math" alttext="86.9_{\pm 0.4}" display="inline"><semantics id="S5.T2.12.12.12.12.2.m1.1a"><msub id="S5.T2.12.12.12.12.2.m1.1.1" xref="S5.T2.12.12.12.12.2.m1.1.1.cmml"><mn id="S5.T2.12.12.12.12.2.m1.1.1.2" xref="S5.T2.12.12.12.12.2.m1.1.1.2.cmml">86.9</mn><mrow id="S5.T2.12.12.12.12.2.m1.1.1.3" xref="S5.T2.12.12.12.12.2.m1.1.1.3.cmml"><mo id="S5.T2.12.12.12.12.2.m1.1.1.3a" xref="S5.T2.12.12.12.12.2.m1.1.1.3.cmml">±</mo><mn id="S5.T2.12.12.12.12.2.m1.1.1.3.2" xref="S5.T2.12.12.12.12.2.m1.1.1.3.2.cmml">0.4</mn></mrow></msub><annotation-xml encoding="MathML-Content" id="S5.T2.12.12.12.12.2.m1.1b"><apply id="S5.T2.12.12.12.12.2.m1.1.1.cmml" xref="S5.T2.12.12.12.12.2.m1.1.1"><csymbol cd="ambiguous" id="S5.T2.12.12.12.12.2.m1.1.1.1.cmml" xref="S5.T2.12.12.12.12.2.m1.1.1">subscript</csymbol><cn type="float" id="S5.T2.12.12.12.12.2.m1.1.1.2.cmml" xref="S5.T2.12.12.12.12.2.m1.1.1.2">86.9</cn><apply id="S5.T2.12.12.12.12.2.m1.1.1.3.cmml" xref="S5.T2.12.12.12.12.2.m1.1.1.3"><csymbol cd="latexml" id="S5.T2.12.12.12.12.2.m1.1.1.3.1.cmml" xref="S5.T2.12.12.12.12.2.m1.1.1.3">plus-or-minus</csymbol><cn type="float" id="S5.T2.12.12.12.12.2.m1.1.1.3.2.cmml" xref="S5.T2.12.12.12.12.2.m1.1.1.3.2">0.4</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.T2.12.12.12.12.2.m1.1c">86.9_{\pm 0.4}</annotation></semantics></math></td>
<td id="S5.T2.13.13.13.13.3" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:2.0pt;padding-right:2.0pt;"><math id="S5.T2.13.13.13.13.3.m1.1" class="ltx_Math" alttext="52_{\pm 0}" display="inline"><semantics id="S5.T2.13.13.13.13.3.m1.1a"><msub id="S5.T2.13.13.13.13.3.m1.1.1" xref="S5.T2.13.13.13.13.3.m1.1.1.cmml"><mn id="S5.T2.13.13.13.13.3.m1.1.1.2" xref="S5.T2.13.13.13.13.3.m1.1.1.2.cmml">52</mn><mrow id="S5.T2.13.13.13.13.3.m1.1.1.3" xref="S5.T2.13.13.13.13.3.m1.1.1.3.cmml"><mo id="S5.T2.13.13.13.13.3.m1.1.1.3a" xref="S5.T2.13.13.13.13.3.m1.1.1.3.cmml">±</mo><mn id="S5.T2.13.13.13.13.3.m1.1.1.3.2" xref="S5.T2.13.13.13.13.3.m1.1.1.3.2.cmml">0</mn></mrow></msub><annotation-xml encoding="MathML-Content" id="S5.T2.13.13.13.13.3.m1.1b"><apply id="S5.T2.13.13.13.13.3.m1.1.1.cmml" xref="S5.T2.13.13.13.13.3.m1.1.1"><csymbol cd="ambiguous" id="S5.T2.13.13.13.13.3.m1.1.1.1.cmml" xref="S5.T2.13.13.13.13.3.m1.1.1">subscript</csymbol><cn type="integer" id="S5.T2.13.13.13.13.3.m1.1.1.2.cmml" xref="S5.T2.13.13.13.13.3.m1.1.1.2">52</cn><apply id="S5.T2.13.13.13.13.3.m1.1.1.3.cmml" xref="S5.T2.13.13.13.13.3.m1.1.1.3"><csymbol cd="latexml" id="S5.T2.13.13.13.13.3.m1.1.1.3.1.cmml" xref="S5.T2.13.13.13.13.3.m1.1.1.3">plus-or-minus</csymbol><cn type="integer" id="S5.T2.13.13.13.13.3.m1.1.1.3.2.cmml" xref="S5.T2.13.13.13.13.3.m1.1.1.3.2">0</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.T2.13.13.13.13.3.m1.1c">52_{\pm 0}</annotation></semantics></math></td>
<td id="S5.T2.14.14.14.14.4" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:2.0pt;padding-right:2.0pt;"><math id="S5.T2.14.14.14.14.4.m1.1" class="ltx_Math" alttext="21.4_{\pm 0.4}" display="inline"><semantics id="S5.T2.14.14.14.14.4.m1.1a"><msub id="S5.T2.14.14.14.14.4.m1.1.1" xref="S5.T2.14.14.14.14.4.m1.1.1.cmml"><mn id="S5.T2.14.14.14.14.4.m1.1.1.2" xref="S5.T2.14.14.14.14.4.m1.1.1.2.cmml">21.4</mn><mrow id="S5.T2.14.14.14.14.4.m1.1.1.3" xref="S5.T2.14.14.14.14.4.m1.1.1.3.cmml"><mo id="S5.T2.14.14.14.14.4.m1.1.1.3a" xref="S5.T2.14.14.14.14.4.m1.1.1.3.cmml">±</mo><mn id="S5.T2.14.14.14.14.4.m1.1.1.3.2" xref="S5.T2.14.14.14.14.4.m1.1.1.3.2.cmml">0.4</mn></mrow></msub><annotation-xml encoding="MathML-Content" id="S5.T2.14.14.14.14.4.m1.1b"><apply id="S5.T2.14.14.14.14.4.m1.1.1.cmml" xref="S5.T2.14.14.14.14.4.m1.1.1"><csymbol cd="ambiguous" id="S5.T2.14.14.14.14.4.m1.1.1.1.cmml" xref="S5.T2.14.14.14.14.4.m1.1.1">subscript</csymbol><cn type="float" id="S5.T2.14.14.14.14.4.m1.1.1.2.cmml" xref="S5.T2.14.14.14.14.4.m1.1.1.2">21.4</cn><apply id="S5.T2.14.14.14.14.4.m1.1.1.3.cmml" xref="S5.T2.14.14.14.14.4.m1.1.1.3"><csymbol cd="latexml" id="S5.T2.14.14.14.14.4.m1.1.1.3.1.cmml" xref="S5.T2.14.14.14.14.4.m1.1.1.3">plus-or-minus</csymbol><cn type="float" id="S5.T2.14.14.14.14.4.m1.1.1.3.2.cmml" xref="S5.T2.14.14.14.14.4.m1.1.1.3.2">0.4</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.T2.14.14.14.14.4.m1.1c">21.4_{\pm 0.4}</annotation></semantics></math></td>
</tr>
<tr id="S5.T2.18.18.18.18" class="ltx_tr">
<td id="S5.T2.18.18.18.18.5" class="ltx_td ltx_align_left" style="padding-left:2.0pt;padding-right:2.0pt;">
<span id="S5.T2.18.18.18.18.5.1" class="ltx_text ltx_font_typewriter">FedSparse</span>, mid</td>
<td id="S5.T2.15.15.15.15.1" class="ltx_td ltx_align_center" style="padding-left:2.0pt;padding-right:2.0pt;"><math id="S5.T2.15.15.15.15.1.m1.1" class="ltx_Math" alttext="68.9_{\pm 0.4}" display="inline"><semantics id="S5.T2.15.15.15.15.1.m1.1a"><msub id="S5.T2.15.15.15.15.1.m1.1.1" xref="S5.T2.15.15.15.15.1.m1.1.1.cmml"><mn id="S5.T2.15.15.15.15.1.m1.1.1.2" xref="S5.T2.15.15.15.15.1.m1.1.1.2.cmml">68.9</mn><mrow id="S5.T2.15.15.15.15.1.m1.1.1.3" xref="S5.T2.15.15.15.15.1.m1.1.1.3.cmml"><mo id="S5.T2.15.15.15.15.1.m1.1.1.3a" xref="S5.T2.15.15.15.15.1.m1.1.1.3.cmml">±</mo><mn id="S5.T2.15.15.15.15.1.m1.1.1.3.2" xref="S5.T2.15.15.15.15.1.m1.1.1.3.2.cmml">0.4</mn></mrow></msub><annotation-xml encoding="MathML-Content" id="S5.T2.15.15.15.15.1.m1.1b"><apply id="S5.T2.15.15.15.15.1.m1.1.1.cmml" xref="S5.T2.15.15.15.15.1.m1.1.1"><csymbol cd="ambiguous" id="S5.T2.15.15.15.15.1.m1.1.1.1.cmml" xref="S5.T2.15.15.15.15.1.m1.1.1">subscript</csymbol><cn type="float" id="S5.T2.15.15.15.15.1.m1.1.1.2.cmml" xref="S5.T2.15.15.15.15.1.m1.1.1.2">68.9</cn><apply id="S5.T2.15.15.15.15.1.m1.1.1.3.cmml" xref="S5.T2.15.15.15.15.1.m1.1.1.3"><csymbol cd="latexml" id="S5.T2.15.15.15.15.1.m1.1.1.3.1.cmml" xref="S5.T2.15.15.15.15.1.m1.1.1.3">plus-or-minus</csymbol><cn type="float" id="S5.T2.15.15.15.15.1.m1.1.1.3.2.cmml" xref="S5.T2.15.15.15.15.1.m1.1.1.3.2">0.4</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.T2.15.15.15.15.1.m1.1c">68.9_{\pm 0.4}</annotation></semantics></math></td>
<td id="S5.T2.16.16.16.16.2" class="ltx_td ltx_align_center" style="padding-left:2.0pt;padding-right:2.0pt;"><math id="S5.T2.16.16.16.16.2.m1.1" class="ltx_Math" alttext="87.6_{\pm 0.1}" display="inline"><semantics id="S5.T2.16.16.16.16.2.m1.1a"><msub id="S5.T2.16.16.16.16.2.m1.1.1" xref="S5.T2.16.16.16.16.2.m1.1.1.cmml"><mn id="S5.T2.16.16.16.16.2.m1.1.1.2" xref="S5.T2.16.16.16.16.2.m1.1.1.2.cmml">87.6</mn><mrow id="S5.T2.16.16.16.16.2.m1.1.1.3" xref="S5.T2.16.16.16.16.2.m1.1.1.3.cmml"><mo id="S5.T2.16.16.16.16.2.m1.1.1.3a" xref="S5.T2.16.16.16.16.2.m1.1.1.3.cmml">±</mo><mn id="S5.T2.16.16.16.16.2.m1.1.1.3.2" xref="S5.T2.16.16.16.16.2.m1.1.1.3.2.cmml">0.1</mn></mrow></msub><annotation-xml encoding="MathML-Content" id="S5.T2.16.16.16.16.2.m1.1b"><apply id="S5.T2.16.16.16.16.2.m1.1.1.cmml" xref="S5.T2.16.16.16.16.2.m1.1.1"><csymbol cd="ambiguous" id="S5.T2.16.16.16.16.2.m1.1.1.1.cmml" xref="S5.T2.16.16.16.16.2.m1.1.1">subscript</csymbol><cn type="float" id="S5.T2.16.16.16.16.2.m1.1.1.2.cmml" xref="S5.T2.16.16.16.16.2.m1.1.1.2">87.6</cn><apply id="S5.T2.16.16.16.16.2.m1.1.1.3.cmml" xref="S5.T2.16.16.16.16.2.m1.1.1.3"><csymbol cd="latexml" id="S5.T2.16.16.16.16.2.m1.1.1.3.1.cmml" xref="S5.T2.16.16.16.16.2.m1.1.1.3">plus-or-minus</csymbol><cn type="float" id="S5.T2.16.16.16.16.2.m1.1.1.3.2.cmml" xref="S5.T2.16.16.16.16.2.m1.1.1.3.2">0.1</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.T2.16.16.16.16.2.m1.1c">87.6_{\pm 0.1}</annotation></semantics></math></td>
<td id="S5.T2.17.17.17.17.3" class="ltx_td ltx_align_center" style="padding-left:2.0pt;padding-right:2.0pt;"><math id="S5.T2.17.17.17.17.3.m1.1" class="ltx_Math" alttext="35_{\pm 0}" display="inline"><semantics id="S5.T2.17.17.17.17.3.m1.1a"><msub id="S5.T2.17.17.17.17.3.m1.1.1" xref="S5.T2.17.17.17.17.3.m1.1.1.cmml"><mn id="S5.T2.17.17.17.17.3.m1.1.1.2" xref="S5.T2.17.17.17.17.3.m1.1.1.2.cmml">35</mn><mrow id="S5.T2.17.17.17.17.3.m1.1.1.3" xref="S5.T2.17.17.17.17.3.m1.1.1.3.cmml"><mo id="S5.T2.17.17.17.17.3.m1.1.1.3a" xref="S5.T2.17.17.17.17.3.m1.1.1.3.cmml">±</mo><mn id="S5.T2.17.17.17.17.3.m1.1.1.3.2" xref="S5.T2.17.17.17.17.3.m1.1.1.3.2.cmml">0</mn></mrow></msub><annotation-xml encoding="MathML-Content" id="S5.T2.17.17.17.17.3.m1.1b"><apply id="S5.T2.17.17.17.17.3.m1.1.1.cmml" xref="S5.T2.17.17.17.17.3.m1.1.1"><csymbol cd="ambiguous" id="S5.T2.17.17.17.17.3.m1.1.1.1.cmml" xref="S5.T2.17.17.17.17.3.m1.1.1">subscript</csymbol><cn type="integer" id="S5.T2.17.17.17.17.3.m1.1.1.2.cmml" xref="S5.T2.17.17.17.17.3.m1.1.1.2">35</cn><apply id="S5.T2.17.17.17.17.3.m1.1.1.3.cmml" xref="S5.T2.17.17.17.17.3.m1.1.1.3"><csymbol cd="latexml" id="S5.T2.17.17.17.17.3.m1.1.1.3.1.cmml" xref="S5.T2.17.17.17.17.3.m1.1.1.3">plus-or-minus</csymbol><cn type="integer" id="S5.T2.17.17.17.17.3.m1.1.1.3.2.cmml" xref="S5.T2.17.17.17.17.3.m1.1.1.3.2">0</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.T2.17.17.17.17.3.m1.1c">35_{\pm 0}</annotation></semantics></math></td>
<td id="S5.T2.18.18.18.18.4" class="ltx_td ltx_align_center" style="padding-left:2.0pt;padding-right:2.0pt;"><math id="S5.T2.18.18.18.18.4.m1.1" class="ltx_Math" alttext="46.8_{\pm 0.4}" display="inline"><semantics id="S5.T2.18.18.18.18.4.m1.1a"><msub id="S5.T2.18.18.18.18.4.m1.1.1" xref="S5.T2.18.18.18.18.4.m1.1.1.cmml"><mn id="S5.T2.18.18.18.18.4.m1.1.1.2" xref="S5.T2.18.18.18.18.4.m1.1.1.2.cmml">46.8</mn><mrow id="S5.T2.18.18.18.18.4.m1.1.1.3" xref="S5.T2.18.18.18.18.4.m1.1.1.3.cmml"><mo id="S5.T2.18.18.18.18.4.m1.1.1.3a" xref="S5.T2.18.18.18.18.4.m1.1.1.3.cmml">±</mo><mn id="S5.T2.18.18.18.18.4.m1.1.1.3.2" xref="S5.T2.18.18.18.18.4.m1.1.1.3.2.cmml">0.4</mn></mrow></msub><annotation-xml encoding="MathML-Content" id="S5.T2.18.18.18.18.4.m1.1b"><apply id="S5.T2.18.18.18.18.4.m1.1.1.cmml" xref="S5.T2.18.18.18.18.4.m1.1.1"><csymbol cd="ambiguous" id="S5.T2.18.18.18.18.4.m1.1.1.1.cmml" xref="S5.T2.18.18.18.18.4.m1.1.1">subscript</csymbol><cn type="float" id="S5.T2.18.18.18.18.4.m1.1.1.2.cmml" xref="S5.T2.18.18.18.18.4.m1.1.1.2">46.8</cn><apply id="S5.T2.18.18.18.18.4.m1.1.1.3.cmml" xref="S5.T2.18.18.18.18.4.m1.1.1.3"><csymbol cd="latexml" id="S5.T2.18.18.18.18.4.m1.1.1.3.1.cmml" xref="S5.T2.18.18.18.18.4.m1.1.1.3">plus-or-minus</csymbol><cn type="float" id="S5.T2.18.18.18.18.4.m1.1.1.3.2.cmml" xref="S5.T2.18.18.18.18.4.m1.1.1.3.2">0.4</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.T2.18.18.18.18.4.m1.1c">46.8_{\pm 0.4}</annotation></semantics></math></td>
</tr>
<tr id="S5.T2.22.22.22.22" class="ltx_tr">
<td id="S5.T2.22.22.22.22.5" class="ltx_td ltx_align_left ltx_border_bb ltx_border_b" style="padding-left:2.0pt;padding-right:2.0pt;">
<span id="S5.T2.22.22.22.22.5.1" class="ltx_text ltx_font_typewriter">FedSparse</span>, high</td>
<td id="S5.T2.19.19.19.19.1" class="ltx_td ltx_align_center ltx_border_bb ltx_border_b" style="padding-left:2.0pt;padding-right:2.0pt;"><math id="S5.T2.19.19.19.19.1.m1.1" class="ltx_Math" alttext="68.4_{\pm 0.5}" display="inline"><semantics id="S5.T2.19.19.19.19.1.m1.1a"><msub id="S5.T2.19.19.19.19.1.m1.1.1" xref="S5.T2.19.19.19.19.1.m1.1.1.cmml"><mn id="S5.T2.19.19.19.19.1.m1.1.1.2" xref="S5.T2.19.19.19.19.1.m1.1.1.2.cmml">68.4</mn><mrow id="S5.T2.19.19.19.19.1.m1.1.1.3" xref="S5.T2.19.19.19.19.1.m1.1.1.3.cmml"><mo id="S5.T2.19.19.19.19.1.m1.1.1.3a" xref="S5.T2.19.19.19.19.1.m1.1.1.3.cmml">±</mo><mn id="S5.T2.19.19.19.19.1.m1.1.1.3.2" xref="S5.T2.19.19.19.19.1.m1.1.1.3.2.cmml">0.5</mn></mrow></msub><annotation-xml encoding="MathML-Content" id="S5.T2.19.19.19.19.1.m1.1b"><apply id="S5.T2.19.19.19.19.1.m1.1.1.cmml" xref="S5.T2.19.19.19.19.1.m1.1.1"><csymbol cd="ambiguous" id="S5.T2.19.19.19.19.1.m1.1.1.1.cmml" xref="S5.T2.19.19.19.19.1.m1.1.1">subscript</csymbol><cn type="float" id="S5.T2.19.19.19.19.1.m1.1.1.2.cmml" xref="S5.T2.19.19.19.19.1.m1.1.1.2">68.4</cn><apply id="S5.T2.19.19.19.19.1.m1.1.1.3.cmml" xref="S5.T2.19.19.19.19.1.m1.1.1.3"><csymbol cd="latexml" id="S5.T2.19.19.19.19.1.m1.1.1.3.1.cmml" xref="S5.T2.19.19.19.19.1.m1.1.1.3">plus-or-minus</csymbol><cn type="float" id="S5.T2.19.19.19.19.1.m1.1.1.3.2.cmml" xref="S5.T2.19.19.19.19.1.m1.1.1.3.2">0.5</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.T2.19.19.19.19.1.m1.1c">68.4_{\pm 0.5}</annotation></semantics></math></td>
<td id="S5.T2.20.20.20.20.2" class="ltx_td ltx_align_center ltx_border_bb ltx_border_b" style="padding-left:2.0pt;padding-right:2.0pt;"><math id="S5.T2.20.20.20.20.2.m1.1" class="ltx_Math" alttext="86.9_{\pm 0.2}" display="inline"><semantics id="S5.T2.20.20.20.20.2.m1.1a"><msub id="S5.T2.20.20.20.20.2.m1.1.1" xref="S5.T2.20.20.20.20.2.m1.1.1.cmml"><mn id="S5.T2.20.20.20.20.2.m1.1.1.2" xref="S5.T2.20.20.20.20.2.m1.1.1.2.cmml">86.9</mn><mrow id="S5.T2.20.20.20.20.2.m1.1.1.3" xref="S5.T2.20.20.20.20.2.m1.1.1.3.cmml"><mo id="S5.T2.20.20.20.20.2.m1.1.1.3a" xref="S5.T2.20.20.20.20.2.m1.1.1.3.cmml">±</mo><mn id="S5.T2.20.20.20.20.2.m1.1.1.3.2" xref="S5.T2.20.20.20.20.2.m1.1.1.3.2.cmml">0.2</mn></mrow></msub><annotation-xml encoding="MathML-Content" id="S5.T2.20.20.20.20.2.m1.1b"><apply id="S5.T2.20.20.20.20.2.m1.1.1.cmml" xref="S5.T2.20.20.20.20.2.m1.1.1"><csymbol cd="ambiguous" id="S5.T2.20.20.20.20.2.m1.1.1.1.cmml" xref="S5.T2.20.20.20.20.2.m1.1.1">subscript</csymbol><cn type="float" id="S5.T2.20.20.20.20.2.m1.1.1.2.cmml" xref="S5.T2.20.20.20.20.2.m1.1.1.2">86.9</cn><apply id="S5.T2.20.20.20.20.2.m1.1.1.3.cmml" xref="S5.T2.20.20.20.20.2.m1.1.1.3"><csymbol cd="latexml" id="S5.T2.20.20.20.20.2.m1.1.1.3.1.cmml" xref="S5.T2.20.20.20.20.2.m1.1.1.3">plus-or-minus</csymbol><cn type="float" id="S5.T2.20.20.20.20.2.m1.1.1.3.2.cmml" xref="S5.T2.20.20.20.20.2.m1.1.1.3.2">0.2</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.T2.20.20.20.20.2.m1.1c">86.9_{\pm 0.2}</annotation></semantics></math></td>
<td id="S5.T2.21.21.21.21.3" class="ltx_td ltx_align_center ltx_border_bb ltx_border_b" style="padding-left:2.0pt;padding-right:2.0pt;"><math id="S5.T2.21.21.21.21.3.m1.1" class="ltx_Math" alttext="23_{\pm 1}" display="inline"><semantics id="S5.T2.21.21.21.21.3.m1.1a"><msub id="S5.T2.21.21.21.21.3.m1.1.1" xref="S5.T2.21.21.21.21.3.m1.1.1.cmml"><mn id="S5.T2.21.21.21.21.3.m1.1.1.2" xref="S5.T2.21.21.21.21.3.m1.1.1.2.cmml">23</mn><mrow id="S5.T2.21.21.21.21.3.m1.1.1.3" xref="S5.T2.21.21.21.21.3.m1.1.1.3.cmml"><mo id="S5.T2.21.21.21.21.3.m1.1.1.3a" xref="S5.T2.21.21.21.21.3.m1.1.1.3.cmml">±</mo><mn id="S5.T2.21.21.21.21.3.m1.1.1.3.2" xref="S5.T2.21.21.21.21.3.m1.1.1.3.2.cmml">1</mn></mrow></msub><annotation-xml encoding="MathML-Content" id="S5.T2.21.21.21.21.3.m1.1b"><apply id="S5.T2.21.21.21.21.3.m1.1.1.cmml" xref="S5.T2.21.21.21.21.3.m1.1.1"><csymbol cd="ambiguous" id="S5.T2.21.21.21.21.3.m1.1.1.1.cmml" xref="S5.T2.21.21.21.21.3.m1.1.1">subscript</csymbol><cn type="integer" id="S5.T2.21.21.21.21.3.m1.1.1.2.cmml" xref="S5.T2.21.21.21.21.3.m1.1.1.2">23</cn><apply id="S5.T2.21.21.21.21.3.m1.1.1.3.cmml" xref="S5.T2.21.21.21.21.3.m1.1.1.3"><csymbol cd="latexml" id="S5.T2.21.21.21.21.3.m1.1.1.3.1.cmml" xref="S5.T2.21.21.21.21.3.m1.1.1.3">plus-or-minus</csymbol><cn type="integer" id="S5.T2.21.21.21.21.3.m1.1.1.3.2.cmml" xref="S5.T2.21.21.21.21.3.m1.1.1.3.2">1</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.T2.21.21.21.21.3.m1.1c">23_{\pm 1}</annotation></semantics></math></td>
<td id="S5.T2.22.22.22.22.4" class="ltx_td ltx_align_center ltx_border_bb ltx_border_b" style="padding-left:2.0pt;padding-right:2.0pt;"><math id="S5.T2.22.22.22.22.4.m1.1" class="ltx_Math" alttext="66.5_{\pm 0.8}" display="inline"><semantics id="S5.T2.22.22.22.22.4.m1.1a"><msub id="S5.T2.22.22.22.22.4.m1.1.1" xref="S5.T2.22.22.22.22.4.m1.1.1.cmml"><mn id="S5.T2.22.22.22.22.4.m1.1.1.2" xref="S5.T2.22.22.22.22.4.m1.1.1.2.cmml">66.5</mn><mrow id="S5.T2.22.22.22.22.4.m1.1.1.3" xref="S5.T2.22.22.22.22.4.m1.1.1.3.cmml"><mo id="S5.T2.22.22.22.22.4.m1.1.1.3a" xref="S5.T2.22.22.22.22.4.m1.1.1.3.cmml">±</mo><mn id="S5.T2.22.22.22.22.4.m1.1.1.3.2" xref="S5.T2.22.22.22.22.4.m1.1.1.3.2.cmml">0.8</mn></mrow></msub><annotation-xml encoding="MathML-Content" id="S5.T2.22.22.22.22.4.m1.1b"><apply id="S5.T2.22.22.22.22.4.m1.1.1.cmml" xref="S5.T2.22.22.22.22.4.m1.1.1"><csymbol cd="ambiguous" id="S5.T2.22.22.22.22.4.m1.1.1.1.cmml" xref="S5.T2.22.22.22.22.4.m1.1.1">subscript</csymbol><cn type="float" id="S5.T2.22.22.22.22.4.m1.1.1.2.cmml" xref="S5.T2.22.22.22.22.4.m1.1.1.2">66.5</cn><apply id="S5.T2.22.22.22.22.4.m1.1.1.3.cmml" xref="S5.T2.22.22.22.22.4.m1.1.1.3"><csymbol cd="latexml" id="S5.T2.22.22.22.22.4.m1.1.1.3.1.cmml" xref="S5.T2.22.22.22.22.4.m1.1.1.3">plus-or-minus</csymbol><cn type="float" id="S5.T2.22.22.22.22.4.m1.1.1.3.2.cmml" xref="S5.T2.22.22.22.22.4.m1.1.1.3.2">0.8</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.T2.22.22.22.22.4.m1.1c">66.5_{\pm 0.8}</annotation></semantics></math></td>
</tr>
</table>
</span></div>
</figure>
</div>
<div class="ltx_flex_cell ltx_flex_size_2">
<figure id="S5.T2.44" class="ltx_figure ltx_figure_panel ltx_minipage ltx_align_center ltx_align_bottom" style="width:216.8pt;">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span id="S5.T2.44.23.1.1" class="ltx_text" style="font-size:90%;">Table 2</span>: </span><span id="S5.T2.44.24.2" class="ltx_text" style="font-size:90%;">Cifar100</span></figcaption>
<div id="S5.T2.44.22" class="ltx_inline-block ltx_align_center ltx_transformed_outer" style="width:433.6pt;height:271pt;vertical-align:-0.0pt;"><span class="ltx_transformed_inner" style="transform:translate(97.3pt,-60.8pt) scale(1.81420118947602,1.81420118947602) ;">
<table id="S5.T2.44.22.22" class="ltx_tabular ltx_align_middle">
<tr id="S5.T2.44.22.22.23" class="ltx_tr">
<td id="S5.T2.44.22.22.23.1" class="ltx_td ltx_align_left ltx_border_tt" style="padding-left:2.0pt;padding-right:2.0pt;">Method</td>
<td id="S5.T2.44.22.22.23.2" class="ltx_td ltx_align_center ltx_border_tt" style="padding-left:2.0pt;padding-right:2.0pt;">
<span id="S5.T2.44.22.22.23.2.1" class="ltx_text"></span> <span id="S5.T2.44.22.22.23.2.2" class="ltx_text">
<span id="S5.T2.44.22.22.23.2.2.1" class="ltx_tabular ltx_align_middle">
<span id="S5.T2.44.22.22.23.2.2.1.1" class="ltx_tr">
<span id="S5.T2.44.22.22.23.2.2.1.1.1" class="ltx_td ltx_nopad_r ltx_align_center" style="padding-left:2.0pt;padding-right:2.0pt;">Global</span></span>
<span id="S5.T2.44.22.22.23.2.2.1.2" class="ltx_tr">
<span id="S5.T2.44.22.22.23.2.2.1.2.1" class="ltx_td ltx_nopad_r ltx_align_center" style="padding-left:2.0pt;padding-right:2.0pt;">acc.</span></span>
</span></span><span id="S5.T2.44.22.22.23.2.3" class="ltx_text"></span></td>
<td id="S5.T2.44.22.22.23.3" class="ltx_td ltx_align_center ltx_border_tt" style="padding-left:2.0pt;padding-right:2.0pt;">
<span id="S5.T2.44.22.22.23.3.1" class="ltx_text"></span> <span id="S5.T2.44.22.22.23.3.2" class="ltx_text">
<span id="S5.T2.44.22.22.23.3.2.1" class="ltx_tabular ltx_align_middle">
<span id="S5.T2.44.22.22.23.3.2.1.1" class="ltx_tr">
<span id="S5.T2.44.22.22.23.3.2.1.1.1" class="ltx_td ltx_nopad_r ltx_align_center" style="padding-left:2.0pt;padding-right:2.0pt;">Local</span></span>
<span id="S5.T2.44.22.22.23.3.2.1.2" class="ltx_tr">
<span id="S5.T2.44.22.22.23.3.2.1.2.1" class="ltx_td ltx_nopad_r ltx_align_center" style="padding-left:2.0pt;padding-right:2.0pt;">acc.</span></span>
</span></span><span id="S5.T2.44.22.22.23.3.3" class="ltx_text"></span></td>
<td id="S5.T2.44.22.22.23.4" class="ltx_td ltx_align_center ltx_border_tt" style="padding-left:2.0pt;padding-right:2.0pt;">
<span id="S5.T2.44.22.22.23.4.1" class="ltx_text"></span> <span id="S5.T2.44.22.22.23.4.2" class="ltx_text">
<span id="S5.T2.44.22.22.23.4.2.1" class="ltx_tabular ltx_align_middle">
<span id="S5.T2.44.22.22.23.4.2.1.1" class="ltx_tr">
<span id="S5.T2.44.22.22.23.4.2.1.1.1" class="ltx_td ltx_nopad_r ltx_align_center" style="padding-left:2.0pt;padding-right:2.0pt;">GB</span></span>
<span id="S5.T2.44.22.22.23.4.2.1.2" class="ltx_tr">
<span id="S5.T2.44.22.22.23.4.2.1.2.1" class="ltx_td ltx_nopad_r ltx_align_center" style="padding-left:2.0pt;padding-right:2.0pt;">comm.</span></span>
</span></span><span id="S5.T2.44.22.22.23.4.3" class="ltx_text"></span></td>
<td id="S5.T2.44.22.22.23.5" class="ltx_td ltx_align_center ltx_border_tt" style="padding-left:2.0pt;padding-right:2.0pt;">Sparsity</td>
</tr>
<tr id="S5.T2.25.3.3.3" class="ltx_tr">
<td id="S5.T2.25.3.3.3.4" class="ltx_td ltx_align_left ltx_border_t" style="padding-left:2.0pt;padding-right:2.0pt;"><span id="S5.T2.25.3.3.3.4.1" class="ltx_text ltx_font_typewriter">FedAvg</span></td>
<td id="S5.T2.23.1.1.1.1" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:2.0pt;padding-right:2.0pt;"><math id="S5.T2.23.1.1.1.1.m1.1" class="ltx_Math" alttext="40.6_{\pm 1.0}" display="inline"><semantics id="S5.T2.23.1.1.1.1.m1.1a"><msub id="S5.T2.23.1.1.1.1.m1.1.1" xref="S5.T2.23.1.1.1.1.m1.1.1.cmml"><mn id="S5.T2.23.1.1.1.1.m1.1.1.2" xref="S5.T2.23.1.1.1.1.m1.1.1.2.cmml">40.6</mn><mrow id="S5.T2.23.1.1.1.1.m1.1.1.3" xref="S5.T2.23.1.1.1.1.m1.1.1.3.cmml"><mo id="S5.T2.23.1.1.1.1.m1.1.1.3a" xref="S5.T2.23.1.1.1.1.m1.1.1.3.cmml">±</mo><mn id="S5.T2.23.1.1.1.1.m1.1.1.3.2" xref="S5.T2.23.1.1.1.1.m1.1.1.3.2.cmml">1.0</mn></mrow></msub><annotation-xml encoding="MathML-Content" id="S5.T2.23.1.1.1.1.m1.1b"><apply id="S5.T2.23.1.1.1.1.m1.1.1.cmml" xref="S5.T2.23.1.1.1.1.m1.1.1"><csymbol cd="ambiguous" id="S5.T2.23.1.1.1.1.m1.1.1.1.cmml" xref="S5.T2.23.1.1.1.1.m1.1.1">subscript</csymbol><cn type="float" id="S5.T2.23.1.1.1.1.m1.1.1.2.cmml" xref="S5.T2.23.1.1.1.1.m1.1.1.2">40.6</cn><apply id="S5.T2.23.1.1.1.1.m1.1.1.3.cmml" xref="S5.T2.23.1.1.1.1.m1.1.1.3"><csymbol cd="latexml" id="S5.T2.23.1.1.1.1.m1.1.1.3.1.cmml" xref="S5.T2.23.1.1.1.1.m1.1.1.3">plus-or-minus</csymbol><cn type="float" id="S5.T2.23.1.1.1.1.m1.1.1.3.2.cmml" xref="S5.T2.23.1.1.1.1.m1.1.1.3.2">1.0</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.T2.23.1.1.1.1.m1.1c">40.6_{\pm 1.0}</annotation></semantics></math></td>
<td id="S5.T2.24.2.2.2.2" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:2.0pt;padding-right:2.0pt;"><math id="S5.T2.24.2.2.2.2.m1.1" class="ltx_Math" alttext="61.5_{\pm 0.6}" display="inline"><semantics id="S5.T2.24.2.2.2.2.m1.1a"><msub id="S5.T2.24.2.2.2.2.m1.1.1" xref="S5.T2.24.2.2.2.2.m1.1.1.cmml"><mn id="S5.T2.24.2.2.2.2.m1.1.1.2" xref="S5.T2.24.2.2.2.2.m1.1.1.2.cmml">61.5</mn><mrow id="S5.T2.24.2.2.2.2.m1.1.1.3" xref="S5.T2.24.2.2.2.2.m1.1.1.3.cmml"><mo id="S5.T2.24.2.2.2.2.m1.1.1.3a" xref="S5.T2.24.2.2.2.2.m1.1.1.3.cmml">±</mo><mn id="S5.T2.24.2.2.2.2.m1.1.1.3.2" xref="S5.T2.24.2.2.2.2.m1.1.1.3.2.cmml">0.6</mn></mrow></msub><annotation-xml encoding="MathML-Content" id="S5.T2.24.2.2.2.2.m1.1b"><apply id="S5.T2.24.2.2.2.2.m1.1.1.cmml" xref="S5.T2.24.2.2.2.2.m1.1.1"><csymbol cd="ambiguous" id="S5.T2.24.2.2.2.2.m1.1.1.1.cmml" xref="S5.T2.24.2.2.2.2.m1.1.1">subscript</csymbol><cn type="float" id="S5.T2.24.2.2.2.2.m1.1.1.2.cmml" xref="S5.T2.24.2.2.2.2.m1.1.1.2">61.5</cn><apply id="S5.T2.24.2.2.2.2.m1.1.1.3.cmml" xref="S5.T2.24.2.2.2.2.m1.1.1.3"><csymbol cd="latexml" id="S5.T2.24.2.2.2.2.m1.1.1.3.1.cmml" xref="S5.T2.24.2.2.2.2.m1.1.1.3">plus-or-minus</csymbol><cn type="float" id="S5.T2.24.2.2.2.2.m1.1.1.3.2.cmml" xref="S5.T2.24.2.2.2.2.m1.1.1.3.2">0.6</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.T2.24.2.2.2.2.m1.1c">61.5_{\pm 0.6}</annotation></semantics></math></td>
<td id="S5.T2.25.3.3.3.3" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:2.0pt;padding-right:2.0pt;"><math id="S5.T2.25.3.3.3.3.m1.1" class="ltx_Math" alttext="124_{\pm 0}" display="inline"><semantics id="S5.T2.25.3.3.3.3.m1.1a"><msub id="S5.T2.25.3.3.3.3.m1.1.1" xref="S5.T2.25.3.3.3.3.m1.1.1.cmml"><mn id="S5.T2.25.3.3.3.3.m1.1.1.2" xref="S5.T2.25.3.3.3.3.m1.1.1.2.cmml">124</mn><mrow id="S5.T2.25.3.3.3.3.m1.1.1.3" xref="S5.T2.25.3.3.3.3.m1.1.1.3.cmml"><mo id="S5.T2.25.3.3.3.3.m1.1.1.3a" xref="S5.T2.25.3.3.3.3.m1.1.1.3.cmml">±</mo><mn id="S5.T2.25.3.3.3.3.m1.1.1.3.2" xref="S5.T2.25.3.3.3.3.m1.1.1.3.2.cmml">0</mn></mrow></msub><annotation-xml encoding="MathML-Content" id="S5.T2.25.3.3.3.3.m1.1b"><apply id="S5.T2.25.3.3.3.3.m1.1.1.cmml" xref="S5.T2.25.3.3.3.3.m1.1.1"><csymbol cd="ambiguous" id="S5.T2.25.3.3.3.3.m1.1.1.1.cmml" xref="S5.T2.25.3.3.3.3.m1.1.1">subscript</csymbol><cn type="integer" id="S5.T2.25.3.3.3.3.m1.1.1.2.cmml" xref="S5.T2.25.3.3.3.3.m1.1.1.2">124</cn><apply id="S5.T2.25.3.3.3.3.m1.1.1.3.cmml" xref="S5.T2.25.3.3.3.3.m1.1.1.3"><csymbol cd="latexml" id="S5.T2.25.3.3.3.3.m1.1.1.3.1.cmml" xref="S5.T2.25.3.3.3.3.m1.1.1.3">plus-or-minus</csymbol><cn type="integer" id="S5.T2.25.3.3.3.3.m1.1.1.3.2.cmml" xref="S5.T2.25.3.3.3.3.m1.1.1.3.2">0</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.T2.25.3.3.3.3.m1.1c">124_{\pm 0}</annotation></semantics></math></td>
<td id="S5.T2.25.3.3.3.5" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:2.0pt;padding-right:2.0pt;">-</td>
</tr>
<tr id="S5.T2.28.6.6.6" class="ltx_tr">
<td id="S5.T2.28.6.6.6.4" class="ltx_td ltx_align_left" style="padding-left:2.0pt;padding-right:2.0pt;"><span id="S5.T2.28.6.6.6.4.1" class="ltx_text ltx_font_typewriter">FedDrop</span></td>
<td id="S5.T2.26.4.4.4.1" class="ltx_td ltx_align_center" style="padding-left:2.0pt;padding-right:2.0pt;"><math id="S5.T2.26.4.4.4.1.m1.1" class="ltx_Math" alttext="36.1_{\pm 0.5}" display="inline"><semantics id="S5.T2.26.4.4.4.1.m1.1a"><msub id="S5.T2.26.4.4.4.1.m1.1.1" xref="S5.T2.26.4.4.4.1.m1.1.1.cmml"><mn id="S5.T2.26.4.4.4.1.m1.1.1.2" xref="S5.T2.26.4.4.4.1.m1.1.1.2.cmml">36.1</mn><mrow id="S5.T2.26.4.4.4.1.m1.1.1.3" xref="S5.T2.26.4.4.4.1.m1.1.1.3.cmml"><mo id="S5.T2.26.4.4.4.1.m1.1.1.3a" xref="S5.T2.26.4.4.4.1.m1.1.1.3.cmml">±</mo><mn id="S5.T2.26.4.4.4.1.m1.1.1.3.2" xref="S5.T2.26.4.4.4.1.m1.1.1.3.2.cmml">0.5</mn></mrow></msub><annotation-xml encoding="MathML-Content" id="S5.T2.26.4.4.4.1.m1.1b"><apply id="S5.T2.26.4.4.4.1.m1.1.1.cmml" xref="S5.T2.26.4.4.4.1.m1.1.1"><csymbol cd="ambiguous" id="S5.T2.26.4.4.4.1.m1.1.1.1.cmml" xref="S5.T2.26.4.4.4.1.m1.1.1">subscript</csymbol><cn type="float" id="S5.T2.26.4.4.4.1.m1.1.1.2.cmml" xref="S5.T2.26.4.4.4.1.m1.1.1.2">36.1</cn><apply id="S5.T2.26.4.4.4.1.m1.1.1.3.cmml" xref="S5.T2.26.4.4.4.1.m1.1.1.3"><csymbol cd="latexml" id="S5.T2.26.4.4.4.1.m1.1.1.3.1.cmml" xref="S5.T2.26.4.4.4.1.m1.1.1.3">plus-or-minus</csymbol><cn type="float" id="S5.T2.26.4.4.4.1.m1.1.1.3.2.cmml" xref="S5.T2.26.4.4.4.1.m1.1.1.3.2">0.5</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.T2.26.4.4.4.1.m1.1c">36.1_{\pm 0.5}</annotation></semantics></math></td>
<td id="S5.T2.27.5.5.5.2" class="ltx_td ltx_align_center" style="padding-left:2.0pt;padding-right:2.0pt;"><math id="S5.T2.27.5.5.5.2.m1.1" class="ltx_Math" alttext="57.8_{\pm 0.3}" display="inline"><semantics id="S5.T2.27.5.5.5.2.m1.1a"><msub id="S5.T2.27.5.5.5.2.m1.1.1" xref="S5.T2.27.5.5.5.2.m1.1.1.cmml"><mn id="S5.T2.27.5.5.5.2.m1.1.1.2" xref="S5.T2.27.5.5.5.2.m1.1.1.2.cmml">57.8</mn><mrow id="S5.T2.27.5.5.5.2.m1.1.1.3" xref="S5.T2.27.5.5.5.2.m1.1.1.3.cmml"><mo id="S5.T2.27.5.5.5.2.m1.1.1.3a" xref="S5.T2.27.5.5.5.2.m1.1.1.3.cmml">±</mo><mn id="S5.T2.27.5.5.5.2.m1.1.1.3.2" xref="S5.T2.27.5.5.5.2.m1.1.1.3.2.cmml">0.3</mn></mrow></msub><annotation-xml encoding="MathML-Content" id="S5.T2.27.5.5.5.2.m1.1b"><apply id="S5.T2.27.5.5.5.2.m1.1.1.cmml" xref="S5.T2.27.5.5.5.2.m1.1.1"><csymbol cd="ambiguous" id="S5.T2.27.5.5.5.2.m1.1.1.1.cmml" xref="S5.T2.27.5.5.5.2.m1.1.1">subscript</csymbol><cn type="float" id="S5.T2.27.5.5.5.2.m1.1.1.2.cmml" xref="S5.T2.27.5.5.5.2.m1.1.1.2">57.8</cn><apply id="S5.T2.27.5.5.5.2.m1.1.1.3.cmml" xref="S5.T2.27.5.5.5.2.m1.1.1.3"><csymbol cd="latexml" id="S5.T2.27.5.5.5.2.m1.1.1.3.1.cmml" xref="S5.T2.27.5.5.5.2.m1.1.1.3">plus-or-minus</csymbol><cn type="float" id="S5.T2.27.5.5.5.2.m1.1.1.3.2.cmml" xref="S5.T2.27.5.5.5.2.m1.1.1.3.2">0.3</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.T2.27.5.5.5.2.m1.1c">57.8_{\pm 0.3}</annotation></semantics></math></td>
<td id="S5.T2.28.6.6.6.3" class="ltx_td ltx_align_center" style="padding-left:2.0pt;padding-right:2.0pt;"><math id="S5.T2.28.6.6.6.3.m1.1" class="ltx_Math" alttext="112_{\pm 0}" display="inline"><semantics id="S5.T2.28.6.6.6.3.m1.1a"><msub id="S5.T2.28.6.6.6.3.m1.1.1" xref="S5.T2.28.6.6.6.3.m1.1.1.cmml"><mn id="S5.T2.28.6.6.6.3.m1.1.1.2" xref="S5.T2.28.6.6.6.3.m1.1.1.2.cmml">112</mn><mrow id="S5.T2.28.6.6.6.3.m1.1.1.3" xref="S5.T2.28.6.6.6.3.m1.1.1.3.cmml"><mo id="S5.T2.28.6.6.6.3.m1.1.1.3a" xref="S5.T2.28.6.6.6.3.m1.1.1.3.cmml">±</mo><mn id="S5.T2.28.6.6.6.3.m1.1.1.3.2" xref="S5.T2.28.6.6.6.3.m1.1.1.3.2.cmml">0</mn></mrow></msub><annotation-xml encoding="MathML-Content" id="S5.T2.28.6.6.6.3.m1.1b"><apply id="S5.T2.28.6.6.6.3.m1.1.1.cmml" xref="S5.T2.28.6.6.6.3.m1.1.1"><csymbol cd="ambiguous" id="S5.T2.28.6.6.6.3.m1.1.1.1.cmml" xref="S5.T2.28.6.6.6.3.m1.1.1">subscript</csymbol><cn type="integer" id="S5.T2.28.6.6.6.3.m1.1.1.2.cmml" xref="S5.T2.28.6.6.6.3.m1.1.1.2">112</cn><apply id="S5.T2.28.6.6.6.3.m1.1.1.3.cmml" xref="S5.T2.28.6.6.6.3.m1.1.1.3"><csymbol cd="latexml" id="S5.T2.28.6.6.6.3.m1.1.1.3.1.cmml" xref="S5.T2.28.6.6.6.3.m1.1.1.3">plus-or-minus</csymbol><cn type="integer" id="S5.T2.28.6.6.6.3.m1.1.1.3.2.cmml" xref="S5.T2.28.6.6.6.3.m1.1.1.3.2">0</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.T2.28.6.6.6.3.m1.1c">112_{\pm 0}</annotation></semantics></math></td>
<td id="S5.T2.28.6.6.6.5" class="ltx_td ltx_align_center" style="padding-left:2.0pt;padding-right:2.0pt;">-</td>
</tr>
<tr id="S5.T2.32.10.10.10" class="ltx_tr">
<td id="S5.T2.32.10.10.10.5" class="ltx_td ltx_align_left" style="padding-left:2.0pt;padding-right:2.0pt;"><span id="S5.T2.32.10.10.10.5.1" class="ltx_text ltx_font_typewriter">FedL1</span></td>
<td id="S5.T2.29.7.7.7.1" class="ltx_td ltx_align_center" style="padding-left:2.0pt;padding-right:2.0pt;"><math id="S5.T2.29.7.7.7.1.m1.1" class="ltx_Math" alttext="23.6_{\pm 0.7}" display="inline"><semantics id="S5.T2.29.7.7.7.1.m1.1a"><msub id="S5.T2.29.7.7.7.1.m1.1.1" xref="S5.T2.29.7.7.7.1.m1.1.1.cmml"><mn id="S5.T2.29.7.7.7.1.m1.1.1.2" xref="S5.T2.29.7.7.7.1.m1.1.1.2.cmml">23.6</mn><mrow id="S5.T2.29.7.7.7.1.m1.1.1.3" xref="S5.T2.29.7.7.7.1.m1.1.1.3.cmml"><mo id="S5.T2.29.7.7.7.1.m1.1.1.3a" xref="S5.T2.29.7.7.7.1.m1.1.1.3.cmml">±</mo><mn id="S5.T2.29.7.7.7.1.m1.1.1.3.2" xref="S5.T2.29.7.7.7.1.m1.1.1.3.2.cmml">0.7</mn></mrow></msub><annotation-xml encoding="MathML-Content" id="S5.T2.29.7.7.7.1.m1.1b"><apply id="S5.T2.29.7.7.7.1.m1.1.1.cmml" xref="S5.T2.29.7.7.7.1.m1.1.1"><csymbol cd="ambiguous" id="S5.T2.29.7.7.7.1.m1.1.1.1.cmml" xref="S5.T2.29.7.7.7.1.m1.1.1">subscript</csymbol><cn type="float" id="S5.T2.29.7.7.7.1.m1.1.1.2.cmml" xref="S5.T2.29.7.7.7.1.m1.1.1.2">23.6</cn><apply id="S5.T2.29.7.7.7.1.m1.1.1.3.cmml" xref="S5.T2.29.7.7.7.1.m1.1.1.3"><csymbol cd="latexml" id="S5.T2.29.7.7.7.1.m1.1.1.3.1.cmml" xref="S5.T2.29.7.7.7.1.m1.1.1.3">plus-or-minus</csymbol><cn type="float" id="S5.T2.29.7.7.7.1.m1.1.1.3.2.cmml" xref="S5.T2.29.7.7.7.1.m1.1.1.3.2">0.7</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.T2.29.7.7.7.1.m1.1c">23.6_{\pm 0.7}</annotation></semantics></math></td>
<td id="S5.T2.30.8.8.8.2" class="ltx_td ltx_align_center" style="padding-left:2.0pt;padding-right:2.0pt;"><math id="S5.T2.30.8.8.8.2.m1.1" class="ltx_Math" alttext="45.8_{\pm 0.3}" display="inline"><semantics id="S5.T2.30.8.8.8.2.m1.1a"><msub id="S5.T2.30.8.8.8.2.m1.1.1" xref="S5.T2.30.8.8.8.2.m1.1.1.cmml"><mn id="S5.T2.30.8.8.8.2.m1.1.1.2" xref="S5.T2.30.8.8.8.2.m1.1.1.2.cmml">45.8</mn><mrow id="S5.T2.30.8.8.8.2.m1.1.1.3" xref="S5.T2.30.8.8.8.2.m1.1.1.3.cmml"><mo id="S5.T2.30.8.8.8.2.m1.1.1.3a" xref="S5.T2.30.8.8.8.2.m1.1.1.3.cmml">±</mo><mn id="S5.T2.30.8.8.8.2.m1.1.1.3.2" xref="S5.T2.30.8.8.8.2.m1.1.1.3.2.cmml">0.3</mn></mrow></msub><annotation-xml encoding="MathML-Content" id="S5.T2.30.8.8.8.2.m1.1b"><apply id="S5.T2.30.8.8.8.2.m1.1.1.cmml" xref="S5.T2.30.8.8.8.2.m1.1.1"><csymbol cd="ambiguous" id="S5.T2.30.8.8.8.2.m1.1.1.1.cmml" xref="S5.T2.30.8.8.8.2.m1.1.1">subscript</csymbol><cn type="float" id="S5.T2.30.8.8.8.2.m1.1.1.2.cmml" xref="S5.T2.30.8.8.8.2.m1.1.1.2">45.8</cn><apply id="S5.T2.30.8.8.8.2.m1.1.1.3.cmml" xref="S5.T2.30.8.8.8.2.m1.1.1.3"><csymbol cd="latexml" id="S5.T2.30.8.8.8.2.m1.1.1.3.1.cmml" xref="S5.T2.30.8.8.8.2.m1.1.1.3">plus-or-minus</csymbol><cn type="float" id="S5.T2.30.8.8.8.2.m1.1.1.3.2.cmml" xref="S5.T2.30.8.8.8.2.m1.1.1.3.2">0.3</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.T2.30.8.8.8.2.m1.1c">45.8_{\pm 0.3}</annotation></semantics></math></td>
<td id="S5.T2.31.9.9.9.3" class="ltx_td ltx_align_center" style="padding-left:2.0pt;padding-right:2.0pt;"><math id="S5.T2.31.9.9.9.3.m1.1" class="ltx_Math" alttext="118_{\pm 1}" display="inline"><semantics id="S5.T2.31.9.9.9.3.m1.1a"><msub id="S5.T2.31.9.9.9.3.m1.1.1" xref="S5.T2.31.9.9.9.3.m1.1.1.cmml"><mn id="S5.T2.31.9.9.9.3.m1.1.1.2" xref="S5.T2.31.9.9.9.3.m1.1.1.2.cmml">118</mn><mrow id="S5.T2.31.9.9.9.3.m1.1.1.3" xref="S5.T2.31.9.9.9.3.m1.1.1.3.cmml"><mo id="S5.T2.31.9.9.9.3.m1.1.1.3a" xref="S5.T2.31.9.9.9.3.m1.1.1.3.cmml">±</mo><mn id="S5.T2.31.9.9.9.3.m1.1.1.3.2" xref="S5.T2.31.9.9.9.3.m1.1.1.3.2.cmml">1</mn></mrow></msub><annotation-xml encoding="MathML-Content" id="S5.T2.31.9.9.9.3.m1.1b"><apply id="S5.T2.31.9.9.9.3.m1.1.1.cmml" xref="S5.T2.31.9.9.9.3.m1.1.1"><csymbol cd="ambiguous" id="S5.T2.31.9.9.9.3.m1.1.1.1.cmml" xref="S5.T2.31.9.9.9.3.m1.1.1">subscript</csymbol><cn type="integer" id="S5.T2.31.9.9.9.3.m1.1.1.2.cmml" xref="S5.T2.31.9.9.9.3.m1.1.1.2">118</cn><apply id="S5.T2.31.9.9.9.3.m1.1.1.3.cmml" xref="S5.T2.31.9.9.9.3.m1.1.1.3"><csymbol cd="latexml" id="S5.T2.31.9.9.9.3.m1.1.1.3.1.cmml" xref="S5.T2.31.9.9.9.3.m1.1.1.3">plus-or-minus</csymbol><cn type="integer" id="S5.T2.31.9.9.9.3.m1.1.1.3.2.cmml" xref="S5.T2.31.9.9.9.3.m1.1.1.3.2">1</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.T2.31.9.9.9.3.m1.1c">118_{\pm 1}</annotation></semantics></math></td>
<td id="S5.T2.32.10.10.10.4" class="ltx_td ltx_align_center" style="padding-left:2.0pt;padding-right:2.0pt;"><math id="S5.T2.32.10.10.10.4.m1.1" class="ltx_Math" alttext="8.0_{\pm 1.0}" display="inline"><semantics id="S5.T2.32.10.10.10.4.m1.1a"><msub id="S5.T2.32.10.10.10.4.m1.1.1" xref="S5.T2.32.10.10.10.4.m1.1.1.cmml"><mn id="S5.T2.32.10.10.10.4.m1.1.1.2" xref="S5.T2.32.10.10.10.4.m1.1.1.2.cmml">8.0</mn><mrow id="S5.T2.32.10.10.10.4.m1.1.1.3" xref="S5.T2.32.10.10.10.4.m1.1.1.3.cmml"><mo id="S5.T2.32.10.10.10.4.m1.1.1.3a" xref="S5.T2.32.10.10.10.4.m1.1.1.3.cmml">±</mo><mn id="S5.T2.32.10.10.10.4.m1.1.1.3.2" xref="S5.T2.32.10.10.10.4.m1.1.1.3.2.cmml">1.0</mn></mrow></msub><annotation-xml encoding="MathML-Content" id="S5.T2.32.10.10.10.4.m1.1b"><apply id="S5.T2.32.10.10.10.4.m1.1.1.cmml" xref="S5.T2.32.10.10.10.4.m1.1.1"><csymbol cd="ambiguous" id="S5.T2.32.10.10.10.4.m1.1.1.1.cmml" xref="S5.T2.32.10.10.10.4.m1.1.1">subscript</csymbol><cn type="float" id="S5.T2.32.10.10.10.4.m1.1.1.2.cmml" xref="S5.T2.32.10.10.10.4.m1.1.1.2">8.0</cn><apply id="S5.T2.32.10.10.10.4.m1.1.1.3.cmml" xref="S5.T2.32.10.10.10.4.m1.1.1.3"><csymbol cd="latexml" id="S5.T2.32.10.10.10.4.m1.1.1.3.1.cmml" xref="S5.T2.32.10.10.10.4.m1.1.1.3">plus-or-minus</csymbol><cn type="float" id="S5.T2.32.10.10.10.4.m1.1.1.3.2.cmml" xref="S5.T2.32.10.10.10.4.m1.1.1.3.2">1.0</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.T2.32.10.10.10.4.m1.1c">8.0_{\pm 1.0}</annotation></semantics></math></td>
</tr>
<tr id="S5.T2.36.14.14.14" class="ltx_tr">
<td id="S5.T2.36.14.14.14.5" class="ltx_td ltx_align_left ltx_border_t" style="padding-left:2.0pt;padding-right:2.0pt;">
<span id="S5.T2.36.14.14.14.5.1" class="ltx_text ltx_font_typewriter">FedSparse</span>, low</td>
<td id="S5.T2.33.11.11.11.1" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:2.0pt;padding-right:2.0pt;"><math id="S5.T2.33.11.11.11.1.m1.1" class="ltx_Math" alttext="40.5_{\pm 0.7}" display="inline"><semantics id="S5.T2.33.11.11.11.1.m1.1a"><msub id="S5.T2.33.11.11.11.1.m1.1.1" xref="S5.T2.33.11.11.11.1.m1.1.1.cmml"><mn id="S5.T2.33.11.11.11.1.m1.1.1.2" xref="S5.T2.33.11.11.11.1.m1.1.1.2.cmml">40.5</mn><mrow id="S5.T2.33.11.11.11.1.m1.1.1.3" xref="S5.T2.33.11.11.11.1.m1.1.1.3.cmml"><mo id="S5.T2.33.11.11.11.1.m1.1.1.3a" xref="S5.T2.33.11.11.11.1.m1.1.1.3.cmml">±</mo><mn id="S5.T2.33.11.11.11.1.m1.1.1.3.2" xref="S5.T2.33.11.11.11.1.m1.1.1.3.2.cmml">0.7</mn></mrow></msub><annotation-xml encoding="MathML-Content" id="S5.T2.33.11.11.11.1.m1.1b"><apply id="S5.T2.33.11.11.11.1.m1.1.1.cmml" xref="S5.T2.33.11.11.11.1.m1.1.1"><csymbol cd="ambiguous" id="S5.T2.33.11.11.11.1.m1.1.1.1.cmml" xref="S5.T2.33.11.11.11.1.m1.1.1">subscript</csymbol><cn type="float" id="S5.T2.33.11.11.11.1.m1.1.1.2.cmml" xref="S5.T2.33.11.11.11.1.m1.1.1.2">40.5</cn><apply id="S5.T2.33.11.11.11.1.m1.1.1.3.cmml" xref="S5.T2.33.11.11.11.1.m1.1.1.3"><csymbol cd="latexml" id="S5.T2.33.11.11.11.1.m1.1.1.3.1.cmml" xref="S5.T2.33.11.11.11.1.m1.1.1.3">plus-or-minus</csymbol><cn type="float" id="S5.T2.33.11.11.11.1.m1.1.1.3.2.cmml" xref="S5.T2.33.11.11.11.1.m1.1.1.3.2">0.7</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.T2.33.11.11.11.1.m1.1c">40.5_{\pm 0.7}</annotation></semantics></math></td>
<td id="S5.T2.34.12.12.12.2" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:2.0pt;padding-right:2.0pt;"><math id="S5.T2.34.12.12.12.2.m1.1" class="ltx_Math" alttext="61.8_{\pm 0.4}" display="inline"><semantics id="S5.T2.34.12.12.12.2.m1.1a"><msub id="S5.T2.34.12.12.12.2.m1.1.1" xref="S5.T2.34.12.12.12.2.m1.1.1.cmml"><mn id="S5.T2.34.12.12.12.2.m1.1.1.2" xref="S5.T2.34.12.12.12.2.m1.1.1.2.cmml">61.8</mn><mrow id="S5.T2.34.12.12.12.2.m1.1.1.3" xref="S5.T2.34.12.12.12.2.m1.1.1.3.cmml"><mo id="S5.T2.34.12.12.12.2.m1.1.1.3a" xref="S5.T2.34.12.12.12.2.m1.1.1.3.cmml">±</mo><mn id="S5.T2.34.12.12.12.2.m1.1.1.3.2" xref="S5.T2.34.12.12.12.2.m1.1.1.3.2.cmml">0.4</mn></mrow></msub><annotation-xml encoding="MathML-Content" id="S5.T2.34.12.12.12.2.m1.1b"><apply id="S5.T2.34.12.12.12.2.m1.1.1.cmml" xref="S5.T2.34.12.12.12.2.m1.1.1"><csymbol cd="ambiguous" id="S5.T2.34.12.12.12.2.m1.1.1.1.cmml" xref="S5.T2.34.12.12.12.2.m1.1.1">subscript</csymbol><cn type="float" id="S5.T2.34.12.12.12.2.m1.1.1.2.cmml" xref="S5.T2.34.12.12.12.2.m1.1.1.2">61.8</cn><apply id="S5.T2.34.12.12.12.2.m1.1.1.3.cmml" xref="S5.T2.34.12.12.12.2.m1.1.1.3"><csymbol cd="latexml" id="S5.T2.34.12.12.12.2.m1.1.1.3.1.cmml" xref="S5.T2.34.12.12.12.2.m1.1.1.3">plus-or-minus</csymbol><cn type="float" id="S5.T2.34.12.12.12.2.m1.1.1.3.2.cmml" xref="S5.T2.34.12.12.12.2.m1.1.1.3.2">0.4</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.T2.34.12.12.12.2.m1.1c">61.8_{\pm 0.4}</annotation></semantics></math></td>
<td id="S5.T2.35.13.13.13.3" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:2.0pt;padding-right:2.0pt;"><math id="S5.T2.35.13.13.13.3.m1.1" class="ltx_Math" alttext="121_{\pm 0}" display="inline"><semantics id="S5.T2.35.13.13.13.3.m1.1a"><msub id="S5.T2.35.13.13.13.3.m1.1.1" xref="S5.T2.35.13.13.13.3.m1.1.1.cmml"><mn id="S5.T2.35.13.13.13.3.m1.1.1.2" xref="S5.T2.35.13.13.13.3.m1.1.1.2.cmml">121</mn><mrow id="S5.T2.35.13.13.13.3.m1.1.1.3" xref="S5.T2.35.13.13.13.3.m1.1.1.3.cmml"><mo id="S5.T2.35.13.13.13.3.m1.1.1.3a" xref="S5.T2.35.13.13.13.3.m1.1.1.3.cmml">±</mo><mn id="S5.T2.35.13.13.13.3.m1.1.1.3.2" xref="S5.T2.35.13.13.13.3.m1.1.1.3.2.cmml">0</mn></mrow></msub><annotation-xml encoding="MathML-Content" id="S5.T2.35.13.13.13.3.m1.1b"><apply id="S5.T2.35.13.13.13.3.m1.1.1.cmml" xref="S5.T2.35.13.13.13.3.m1.1.1"><csymbol cd="ambiguous" id="S5.T2.35.13.13.13.3.m1.1.1.1.cmml" xref="S5.T2.35.13.13.13.3.m1.1.1">subscript</csymbol><cn type="integer" id="S5.T2.35.13.13.13.3.m1.1.1.2.cmml" xref="S5.T2.35.13.13.13.3.m1.1.1.2">121</cn><apply id="S5.T2.35.13.13.13.3.m1.1.1.3.cmml" xref="S5.T2.35.13.13.13.3.m1.1.1.3"><csymbol cd="latexml" id="S5.T2.35.13.13.13.3.m1.1.1.3.1.cmml" xref="S5.T2.35.13.13.13.3.m1.1.1.3">plus-or-minus</csymbol><cn type="integer" id="S5.T2.35.13.13.13.3.m1.1.1.3.2.cmml" xref="S5.T2.35.13.13.13.3.m1.1.1.3.2">0</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.T2.35.13.13.13.3.m1.1c">121_{\pm 0}</annotation></semantics></math></td>
<td id="S5.T2.36.14.14.14.4" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:2.0pt;padding-right:2.0pt;"><math id="S5.T2.36.14.14.14.4.m1.1" class="ltx_Math" alttext="1.6_{\pm 0.1}" display="inline"><semantics id="S5.T2.36.14.14.14.4.m1.1a"><msub id="S5.T2.36.14.14.14.4.m1.1.1" xref="S5.T2.36.14.14.14.4.m1.1.1.cmml"><mn id="S5.T2.36.14.14.14.4.m1.1.1.2" xref="S5.T2.36.14.14.14.4.m1.1.1.2.cmml">1.6</mn><mrow id="S5.T2.36.14.14.14.4.m1.1.1.3" xref="S5.T2.36.14.14.14.4.m1.1.1.3.cmml"><mo id="S5.T2.36.14.14.14.4.m1.1.1.3a" xref="S5.T2.36.14.14.14.4.m1.1.1.3.cmml">±</mo><mn id="S5.T2.36.14.14.14.4.m1.1.1.3.2" xref="S5.T2.36.14.14.14.4.m1.1.1.3.2.cmml">0.1</mn></mrow></msub><annotation-xml encoding="MathML-Content" id="S5.T2.36.14.14.14.4.m1.1b"><apply id="S5.T2.36.14.14.14.4.m1.1.1.cmml" xref="S5.T2.36.14.14.14.4.m1.1.1"><csymbol cd="ambiguous" id="S5.T2.36.14.14.14.4.m1.1.1.1.cmml" xref="S5.T2.36.14.14.14.4.m1.1.1">subscript</csymbol><cn type="float" id="S5.T2.36.14.14.14.4.m1.1.1.2.cmml" xref="S5.T2.36.14.14.14.4.m1.1.1.2">1.6</cn><apply id="S5.T2.36.14.14.14.4.m1.1.1.3.cmml" xref="S5.T2.36.14.14.14.4.m1.1.1.3"><csymbol cd="latexml" id="S5.T2.36.14.14.14.4.m1.1.1.3.1.cmml" xref="S5.T2.36.14.14.14.4.m1.1.1.3">plus-or-minus</csymbol><cn type="float" id="S5.T2.36.14.14.14.4.m1.1.1.3.2.cmml" xref="S5.T2.36.14.14.14.4.m1.1.1.3.2">0.1</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.T2.36.14.14.14.4.m1.1c">1.6_{\pm 0.1}</annotation></semantics></math></td>
</tr>
<tr id="S5.T2.40.18.18.18" class="ltx_tr">
<td id="S5.T2.40.18.18.18.5" class="ltx_td ltx_align_left" style="padding-left:2.0pt;padding-right:2.0pt;">
<span id="S5.T2.40.18.18.18.5.1" class="ltx_text ltx_font_typewriter">FedSparse</span>, mid</td>
<td id="S5.T2.37.15.15.15.1" class="ltx_td ltx_align_center" style="padding-left:2.0pt;padding-right:2.0pt;"><math id="S5.T2.37.15.15.15.1.m1.1" class="ltx_Math" alttext="31.7_{\pm 1.0}" display="inline"><semantics id="S5.T2.37.15.15.15.1.m1.1a"><msub id="S5.T2.37.15.15.15.1.m1.1.1" xref="S5.T2.37.15.15.15.1.m1.1.1.cmml"><mn id="S5.T2.37.15.15.15.1.m1.1.1.2" xref="S5.T2.37.15.15.15.1.m1.1.1.2.cmml">31.7</mn><mrow id="S5.T2.37.15.15.15.1.m1.1.1.3" xref="S5.T2.37.15.15.15.1.m1.1.1.3.cmml"><mo id="S5.T2.37.15.15.15.1.m1.1.1.3a" xref="S5.T2.37.15.15.15.1.m1.1.1.3.cmml">±</mo><mn id="S5.T2.37.15.15.15.1.m1.1.1.3.2" xref="S5.T2.37.15.15.15.1.m1.1.1.3.2.cmml">1.0</mn></mrow></msub><annotation-xml encoding="MathML-Content" id="S5.T2.37.15.15.15.1.m1.1b"><apply id="S5.T2.37.15.15.15.1.m1.1.1.cmml" xref="S5.T2.37.15.15.15.1.m1.1.1"><csymbol cd="ambiguous" id="S5.T2.37.15.15.15.1.m1.1.1.1.cmml" xref="S5.T2.37.15.15.15.1.m1.1.1">subscript</csymbol><cn type="float" id="S5.T2.37.15.15.15.1.m1.1.1.2.cmml" xref="S5.T2.37.15.15.15.1.m1.1.1.2">31.7</cn><apply id="S5.T2.37.15.15.15.1.m1.1.1.3.cmml" xref="S5.T2.37.15.15.15.1.m1.1.1.3"><csymbol cd="latexml" id="S5.T2.37.15.15.15.1.m1.1.1.3.1.cmml" xref="S5.T2.37.15.15.15.1.m1.1.1.3">plus-or-minus</csymbol><cn type="float" id="S5.T2.37.15.15.15.1.m1.1.1.3.2.cmml" xref="S5.T2.37.15.15.15.1.m1.1.1.3.2">1.0</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.T2.37.15.15.15.1.m1.1c">31.7_{\pm 1.0}</annotation></semantics></math></td>
<td id="S5.T2.38.16.16.16.2" class="ltx_td ltx_align_center" style="padding-left:2.0pt;padding-right:2.0pt;"><math id="S5.T2.38.16.16.16.2.m1.1" class="ltx_Math" alttext="54.8_{\pm 0.6}" display="inline"><semantics id="S5.T2.38.16.16.16.2.m1.1a"><msub id="S5.T2.38.16.16.16.2.m1.1.1" xref="S5.T2.38.16.16.16.2.m1.1.1.cmml"><mn id="S5.T2.38.16.16.16.2.m1.1.1.2" xref="S5.T2.38.16.16.16.2.m1.1.1.2.cmml">54.8</mn><mrow id="S5.T2.38.16.16.16.2.m1.1.1.3" xref="S5.T2.38.16.16.16.2.m1.1.1.3.cmml"><mo id="S5.T2.38.16.16.16.2.m1.1.1.3a" xref="S5.T2.38.16.16.16.2.m1.1.1.3.cmml">±</mo><mn id="S5.T2.38.16.16.16.2.m1.1.1.3.2" xref="S5.T2.38.16.16.16.2.m1.1.1.3.2.cmml">0.6</mn></mrow></msub><annotation-xml encoding="MathML-Content" id="S5.T2.38.16.16.16.2.m1.1b"><apply id="S5.T2.38.16.16.16.2.m1.1.1.cmml" xref="S5.T2.38.16.16.16.2.m1.1.1"><csymbol cd="ambiguous" id="S5.T2.38.16.16.16.2.m1.1.1.1.cmml" xref="S5.T2.38.16.16.16.2.m1.1.1">subscript</csymbol><cn type="float" id="S5.T2.38.16.16.16.2.m1.1.1.2.cmml" xref="S5.T2.38.16.16.16.2.m1.1.1.2">54.8</cn><apply id="S5.T2.38.16.16.16.2.m1.1.1.3.cmml" xref="S5.T2.38.16.16.16.2.m1.1.1.3"><csymbol cd="latexml" id="S5.T2.38.16.16.16.2.m1.1.1.3.1.cmml" xref="S5.T2.38.16.16.16.2.m1.1.1.3">plus-or-minus</csymbol><cn type="float" id="S5.T2.38.16.16.16.2.m1.1.1.3.2.cmml" xref="S5.T2.38.16.16.16.2.m1.1.1.3.2">0.6</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.T2.38.16.16.16.2.m1.1c">54.8_{\pm 0.6}</annotation></semantics></math></td>
<td id="S5.T2.39.17.17.17.3" class="ltx_td ltx_align_center" style="padding-left:2.0pt;padding-right:2.0pt;"><math id="S5.T2.39.17.17.17.3.m1.1" class="ltx_Math" alttext="58_{\pm 1}" display="inline"><semantics id="S5.T2.39.17.17.17.3.m1.1a"><msub id="S5.T2.39.17.17.17.3.m1.1.1" xref="S5.T2.39.17.17.17.3.m1.1.1.cmml"><mn id="S5.T2.39.17.17.17.3.m1.1.1.2" xref="S5.T2.39.17.17.17.3.m1.1.1.2.cmml">58</mn><mrow id="S5.T2.39.17.17.17.3.m1.1.1.3" xref="S5.T2.39.17.17.17.3.m1.1.1.3.cmml"><mo id="S5.T2.39.17.17.17.3.m1.1.1.3a" xref="S5.T2.39.17.17.17.3.m1.1.1.3.cmml">±</mo><mn id="S5.T2.39.17.17.17.3.m1.1.1.3.2" xref="S5.T2.39.17.17.17.3.m1.1.1.3.2.cmml">1</mn></mrow></msub><annotation-xml encoding="MathML-Content" id="S5.T2.39.17.17.17.3.m1.1b"><apply id="S5.T2.39.17.17.17.3.m1.1.1.cmml" xref="S5.T2.39.17.17.17.3.m1.1.1"><csymbol cd="ambiguous" id="S5.T2.39.17.17.17.3.m1.1.1.1.cmml" xref="S5.T2.39.17.17.17.3.m1.1.1">subscript</csymbol><cn type="integer" id="S5.T2.39.17.17.17.3.m1.1.1.2.cmml" xref="S5.T2.39.17.17.17.3.m1.1.1.2">58</cn><apply id="S5.T2.39.17.17.17.3.m1.1.1.3.cmml" xref="S5.T2.39.17.17.17.3.m1.1.1.3"><csymbol cd="latexml" id="S5.T2.39.17.17.17.3.m1.1.1.3.1.cmml" xref="S5.T2.39.17.17.17.3.m1.1.1.3">plus-or-minus</csymbol><cn type="integer" id="S5.T2.39.17.17.17.3.m1.1.1.3.2.cmml" xref="S5.T2.39.17.17.17.3.m1.1.1.3.2">1</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.T2.39.17.17.17.3.m1.1c">58_{\pm 1}</annotation></semantics></math></td>
<td id="S5.T2.40.18.18.18.4" class="ltx_td ltx_align_center" style="padding-left:2.0pt;padding-right:2.0pt;"><math id="S5.T2.40.18.18.18.4.m1.1" class="ltx_Math" alttext="53.8_{\pm 0.6}" display="inline"><semantics id="S5.T2.40.18.18.18.4.m1.1a"><msub id="S5.T2.40.18.18.18.4.m1.1.1" xref="S5.T2.40.18.18.18.4.m1.1.1.cmml"><mn id="S5.T2.40.18.18.18.4.m1.1.1.2" xref="S5.T2.40.18.18.18.4.m1.1.1.2.cmml">53.8</mn><mrow id="S5.T2.40.18.18.18.4.m1.1.1.3" xref="S5.T2.40.18.18.18.4.m1.1.1.3.cmml"><mo id="S5.T2.40.18.18.18.4.m1.1.1.3a" xref="S5.T2.40.18.18.18.4.m1.1.1.3.cmml">±</mo><mn id="S5.T2.40.18.18.18.4.m1.1.1.3.2" xref="S5.T2.40.18.18.18.4.m1.1.1.3.2.cmml">0.6</mn></mrow></msub><annotation-xml encoding="MathML-Content" id="S5.T2.40.18.18.18.4.m1.1b"><apply id="S5.T2.40.18.18.18.4.m1.1.1.cmml" xref="S5.T2.40.18.18.18.4.m1.1.1"><csymbol cd="ambiguous" id="S5.T2.40.18.18.18.4.m1.1.1.1.cmml" xref="S5.T2.40.18.18.18.4.m1.1.1">subscript</csymbol><cn type="float" id="S5.T2.40.18.18.18.4.m1.1.1.2.cmml" xref="S5.T2.40.18.18.18.4.m1.1.1.2">53.8</cn><apply id="S5.T2.40.18.18.18.4.m1.1.1.3.cmml" xref="S5.T2.40.18.18.18.4.m1.1.1.3"><csymbol cd="latexml" id="S5.T2.40.18.18.18.4.m1.1.1.3.1.cmml" xref="S5.T2.40.18.18.18.4.m1.1.1.3">plus-or-minus</csymbol><cn type="float" id="S5.T2.40.18.18.18.4.m1.1.1.3.2.cmml" xref="S5.T2.40.18.18.18.4.m1.1.1.3.2">0.6</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.T2.40.18.18.18.4.m1.1c">53.8_{\pm 0.6}</annotation></semantics></math></td>
</tr>
<tr id="S5.T2.44.22.22.22" class="ltx_tr">
<td id="S5.T2.44.22.22.22.5" class="ltx_td ltx_align_left ltx_border_bb ltx_border_b" style="padding-left:2.0pt;padding-right:2.0pt;">
<span id="S5.T2.44.22.22.22.5.1" class="ltx_text ltx_font_typewriter">FedSparse</span>, high</td>
<td id="S5.T2.41.19.19.19.1" class="ltx_td ltx_align_center ltx_border_bb ltx_border_b" style="padding-left:2.0pt;padding-right:2.0pt;"><math id="S5.T2.41.19.19.19.1.m1.1" class="ltx_Math" alttext="23.8_{\pm 2.0}" display="inline"><semantics id="S5.T2.41.19.19.19.1.m1.1a"><msub id="S5.T2.41.19.19.19.1.m1.1.1" xref="S5.T2.41.19.19.19.1.m1.1.1.cmml"><mn id="S5.T2.41.19.19.19.1.m1.1.1.2" xref="S5.T2.41.19.19.19.1.m1.1.1.2.cmml">23.8</mn><mrow id="S5.T2.41.19.19.19.1.m1.1.1.3" xref="S5.T2.41.19.19.19.1.m1.1.1.3.cmml"><mo id="S5.T2.41.19.19.19.1.m1.1.1.3a" xref="S5.T2.41.19.19.19.1.m1.1.1.3.cmml">±</mo><mn id="S5.T2.41.19.19.19.1.m1.1.1.3.2" xref="S5.T2.41.19.19.19.1.m1.1.1.3.2.cmml">2.0</mn></mrow></msub><annotation-xml encoding="MathML-Content" id="S5.T2.41.19.19.19.1.m1.1b"><apply id="S5.T2.41.19.19.19.1.m1.1.1.cmml" xref="S5.T2.41.19.19.19.1.m1.1.1"><csymbol cd="ambiguous" id="S5.T2.41.19.19.19.1.m1.1.1.1.cmml" xref="S5.T2.41.19.19.19.1.m1.1.1">subscript</csymbol><cn type="float" id="S5.T2.41.19.19.19.1.m1.1.1.2.cmml" xref="S5.T2.41.19.19.19.1.m1.1.1.2">23.8</cn><apply id="S5.T2.41.19.19.19.1.m1.1.1.3.cmml" xref="S5.T2.41.19.19.19.1.m1.1.1.3"><csymbol cd="latexml" id="S5.T2.41.19.19.19.1.m1.1.1.3.1.cmml" xref="S5.T2.41.19.19.19.1.m1.1.1.3">plus-or-minus</csymbol><cn type="float" id="S5.T2.41.19.19.19.1.m1.1.1.3.2.cmml" xref="S5.T2.41.19.19.19.1.m1.1.1.3.2">2.0</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.T2.41.19.19.19.1.m1.1c">23.8_{\pm 2.0}</annotation></semantics></math></td>
<td id="S5.T2.42.20.20.20.2" class="ltx_td ltx_align_center ltx_border_bb ltx_border_b" style="padding-left:2.0pt;padding-right:2.0pt;"><math id="S5.T2.42.20.20.20.2.m1.1" class="ltx_Math" alttext="48.5_{\pm 1.5}" display="inline"><semantics id="S5.T2.42.20.20.20.2.m1.1a"><msub id="S5.T2.42.20.20.20.2.m1.1.1" xref="S5.T2.42.20.20.20.2.m1.1.1.cmml"><mn id="S5.T2.42.20.20.20.2.m1.1.1.2" xref="S5.T2.42.20.20.20.2.m1.1.1.2.cmml">48.5</mn><mrow id="S5.T2.42.20.20.20.2.m1.1.1.3" xref="S5.T2.42.20.20.20.2.m1.1.1.3.cmml"><mo id="S5.T2.42.20.20.20.2.m1.1.1.3a" xref="S5.T2.42.20.20.20.2.m1.1.1.3.cmml">±</mo><mn id="S5.T2.42.20.20.20.2.m1.1.1.3.2" xref="S5.T2.42.20.20.20.2.m1.1.1.3.2.cmml">1.5</mn></mrow></msub><annotation-xml encoding="MathML-Content" id="S5.T2.42.20.20.20.2.m1.1b"><apply id="S5.T2.42.20.20.20.2.m1.1.1.cmml" xref="S5.T2.42.20.20.20.2.m1.1.1"><csymbol cd="ambiguous" id="S5.T2.42.20.20.20.2.m1.1.1.1.cmml" xref="S5.T2.42.20.20.20.2.m1.1.1">subscript</csymbol><cn type="float" id="S5.T2.42.20.20.20.2.m1.1.1.2.cmml" xref="S5.T2.42.20.20.20.2.m1.1.1.2">48.5</cn><apply id="S5.T2.42.20.20.20.2.m1.1.1.3.cmml" xref="S5.T2.42.20.20.20.2.m1.1.1.3"><csymbol cd="latexml" id="S5.T2.42.20.20.20.2.m1.1.1.3.1.cmml" xref="S5.T2.42.20.20.20.2.m1.1.1.3">plus-or-minus</csymbol><cn type="float" id="S5.T2.42.20.20.20.2.m1.1.1.3.2.cmml" xref="S5.T2.42.20.20.20.2.m1.1.1.3.2">1.5</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.T2.42.20.20.20.2.m1.1c">48.5_{\pm 1.5}</annotation></semantics></math></td>
<td id="S5.T2.43.21.21.21.3" class="ltx_td ltx_align_center ltx_border_bb ltx_border_b" style="padding-left:2.0pt;padding-right:2.0pt;"><math id="S5.T2.43.21.21.21.3.m1.1" class="ltx_Math" alttext="43_{\pm 2}" display="inline"><semantics id="S5.T2.43.21.21.21.3.m1.1a"><msub id="S5.T2.43.21.21.21.3.m1.1.1" xref="S5.T2.43.21.21.21.3.m1.1.1.cmml"><mn id="S5.T2.43.21.21.21.3.m1.1.1.2" xref="S5.T2.43.21.21.21.3.m1.1.1.2.cmml">43</mn><mrow id="S5.T2.43.21.21.21.3.m1.1.1.3" xref="S5.T2.43.21.21.21.3.m1.1.1.3.cmml"><mo id="S5.T2.43.21.21.21.3.m1.1.1.3a" xref="S5.T2.43.21.21.21.3.m1.1.1.3.cmml">±</mo><mn id="S5.T2.43.21.21.21.3.m1.1.1.3.2" xref="S5.T2.43.21.21.21.3.m1.1.1.3.2.cmml">2</mn></mrow></msub><annotation-xml encoding="MathML-Content" id="S5.T2.43.21.21.21.3.m1.1b"><apply id="S5.T2.43.21.21.21.3.m1.1.1.cmml" xref="S5.T2.43.21.21.21.3.m1.1.1"><csymbol cd="ambiguous" id="S5.T2.43.21.21.21.3.m1.1.1.1.cmml" xref="S5.T2.43.21.21.21.3.m1.1.1">subscript</csymbol><cn type="integer" id="S5.T2.43.21.21.21.3.m1.1.1.2.cmml" xref="S5.T2.43.21.21.21.3.m1.1.1.2">43</cn><apply id="S5.T2.43.21.21.21.3.m1.1.1.3.cmml" xref="S5.T2.43.21.21.21.3.m1.1.1.3"><csymbol cd="latexml" id="S5.T2.43.21.21.21.3.m1.1.1.3.1.cmml" xref="S5.T2.43.21.21.21.3.m1.1.1.3">plus-or-minus</csymbol><cn type="integer" id="S5.T2.43.21.21.21.3.m1.1.1.3.2.cmml" xref="S5.T2.43.21.21.21.3.m1.1.1.3.2">2</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.T2.43.21.21.21.3.m1.1c">43_{\pm 2}</annotation></semantics></math></td>
<td id="S5.T2.44.22.22.22.4" class="ltx_td ltx_align_center ltx_border_bb ltx_border_b" style="padding-left:2.0pt;padding-right:2.0pt;"><math id="S5.T2.44.22.22.22.4.m1.1" class="ltx_Math" alttext="66.9_{\pm 1.3}" display="inline"><semantics id="S5.T2.44.22.22.22.4.m1.1a"><msub id="S5.T2.44.22.22.22.4.m1.1.1" xref="S5.T2.44.22.22.22.4.m1.1.1.cmml"><mn id="S5.T2.44.22.22.22.4.m1.1.1.2" xref="S5.T2.44.22.22.22.4.m1.1.1.2.cmml">66.9</mn><mrow id="S5.T2.44.22.22.22.4.m1.1.1.3" xref="S5.T2.44.22.22.22.4.m1.1.1.3.cmml"><mo id="S5.T2.44.22.22.22.4.m1.1.1.3a" xref="S5.T2.44.22.22.22.4.m1.1.1.3.cmml">±</mo><mn id="S5.T2.44.22.22.22.4.m1.1.1.3.2" xref="S5.T2.44.22.22.22.4.m1.1.1.3.2.cmml">1.3</mn></mrow></msub><annotation-xml encoding="MathML-Content" id="S5.T2.44.22.22.22.4.m1.1b"><apply id="S5.T2.44.22.22.22.4.m1.1.1.cmml" xref="S5.T2.44.22.22.22.4.m1.1.1"><csymbol cd="ambiguous" id="S5.T2.44.22.22.22.4.m1.1.1.1.cmml" xref="S5.T2.44.22.22.22.4.m1.1.1">subscript</csymbol><cn type="float" id="S5.T2.44.22.22.22.4.m1.1.1.2.cmml" xref="S5.T2.44.22.22.22.4.m1.1.1.2">66.9</cn><apply id="S5.T2.44.22.22.22.4.m1.1.1.3.cmml" xref="S5.T2.44.22.22.22.4.m1.1.1.3"><csymbol cd="latexml" id="S5.T2.44.22.22.22.4.m1.1.1.3.1.cmml" xref="S5.T2.44.22.22.22.4.m1.1.1.3">plus-or-minus</csymbol><cn type="float" id="S5.T2.44.22.22.22.4.m1.1.1.3.2.cmml" xref="S5.T2.44.22.22.22.4.m1.1.1.3.2">1.3</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.T2.44.22.22.22.4.m1.1c">66.9_{\pm 1.3}</annotation></semantics></math></td>
</tr>
</table>
</span></div>
</figure>
</div>
</div>
</figure>
<figure id="S5.T3" class="ltx_table ltx_align_floatleft">
<figcaption class="ltx_caption ltx_centering" style="font-size:90%;"><span class="ltx_tag ltx_tag_table">Table 3: </span>Femnist</figcaption>
<table id="S5.T3.22" class="ltx_tabular ltx_centering ltx_align_middle">
<tr id="S5.T3.22.23" class="ltx_tr">
<td id="S5.T3.22.23.1" class="ltx_td ltx_align_left ltx_border_tt" style="padding-left:2.0pt;padding-right:2.0pt;"><span id="S5.T3.22.23.1.1" class="ltx_text" style="font-size:90%;">Method</span></td>
<td id="S5.T3.22.23.2" class="ltx_td ltx_align_center ltx_border_tt" style="padding-left:2.0pt;padding-right:2.0pt;">
<span id="S5.T3.22.23.2.1" class="ltx_text"></span><span id="S5.T3.22.23.2.2" class="ltx_text" style="font-size:90%;"> </span><span id="S5.T3.22.23.2.3" class="ltx_text" style="font-size:90%;">
<span id="S5.T3.22.23.2.3.1" class="ltx_tabular ltx_align_middle">
<span id="S5.T3.22.23.2.3.1.1" class="ltx_tr">
<span id="S5.T3.22.23.2.3.1.1.1" class="ltx_td ltx_nopad_r ltx_align_center" style="padding-left:2.0pt;padding-right:2.0pt;">Global</span></span>
<span id="S5.T3.22.23.2.3.1.2" class="ltx_tr">
<span id="S5.T3.22.23.2.3.1.2.1" class="ltx_td ltx_nopad_r ltx_align_center" style="padding-left:2.0pt;padding-right:2.0pt;">acc.</span></span>
</span></span><span id="S5.T3.22.23.2.4" class="ltx_text"></span><span id="S5.T3.22.23.2.5" class="ltx_text" style="font-size:90%;"></span>
</td>
<td id="S5.T3.22.23.3" class="ltx_td ltx_align_center ltx_border_tt" style="padding-left:2.0pt;padding-right:2.0pt;">
<span id="S5.T3.22.23.3.1" class="ltx_text"></span><span id="S5.T3.22.23.3.2" class="ltx_text" style="font-size:90%;"> </span><span id="S5.T3.22.23.3.3" class="ltx_text" style="font-size:90%;">
<span id="S5.T3.22.23.3.3.1" class="ltx_tabular ltx_align_middle">
<span id="S5.T3.22.23.3.3.1.1" class="ltx_tr">
<span id="S5.T3.22.23.3.3.1.1.1" class="ltx_td ltx_nopad_r ltx_align_center" style="padding-left:2.0pt;padding-right:2.0pt;">Local</span></span>
<span id="S5.T3.22.23.3.3.1.2" class="ltx_tr">
<span id="S5.T3.22.23.3.3.1.2.1" class="ltx_td ltx_nopad_r ltx_align_center" style="padding-left:2.0pt;padding-right:2.0pt;">acc.</span></span>
</span></span><span id="S5.T3.22.23.3.4" class="ltx_text"></span><span id="S5.T3.22.23.3.5" class="ltx_text" style="font-size:90%;"></span>
</td>
<td id="S5.T3.22.23.4" class="ltx_td ltx_align_center ltx_border_tt" style="padding-left:2.0pt;padding-right:2.0pt;">
<span id="S5.T3.22.23.4.1" class="ltx_text"></span><span id="S5.T3.22.23.4.2" class="ltx_text" style="font-size:90%;"> </span><span id="S5.T3.22.23.4.3" class="ltx_text" style="font-size:90%;">
<span id="S5.T3.22.23.4.3.1" class="ltx_tabular ltx_align_middle">
<span id="S5.T3.22.23.4.3.1.1" class="ltx_tr">
<span id="S5.T3.22.23.4.3.1.1.1" class="ltx_td ltx_nopad_r ltx_align_center" style="padding-left:2.0pt;padding-right:2.0pt;">GB</span></span>
<span id="S5.T3.22.23.4.3.1.2" class="ltx_tr">
<span id="S5.T3.22.23.4.3.1.2.1" class="ltx_td ltx_nopad_r ltx_align_center" style="padding-left:2.0pt;padding-right:2.0pt;">comm.</span></span>
</span></span><span id="S5.T3.22.23.4.4" class="ltx_text"></span><span id="S5.T3.22.23.4.5" class="ltx_text" style="font-size:90%;"></span>
</td>
<td id="S5.T3.22.23.5" class="ltx_td ltx_align_center ltx_border_tt" style="padding-left:2.0pt;padding-right:2.0pt;"><span id="S5.T3.22.23.5.1" class="ltx_text" style="font-size:90%;">Sparsity</span></td>
</tr>
<tr id="S5.T3.3.3" class="ltx_tr">
<td id="S5.T3.3.3.4" class="ltx_td ltx_align_left ltx_border_t" style="padding-left:2.0pt;padding-right:2.0pt;"><span id="S5.T3.3.3.4.1" class="ltx_text ltx_font_typewriter" style="font-size:90%;">FedAvg</span></td>
<td id="S5.T3.1.1.1" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:2.0pt;padding-right:2.0pt;"><math id="S5.T3.1.1.1.m1.1" class="ltx_Math" alttext="85.8_{\pm 0.2}" display="inline"><semantics id="S5.T3.1.1.1.m1.1a"><msub id="S5.T3.1.1.1.m1.1.1" xref="S5.T3.1.1.1.m1.1.1.cmml"><mn mathsize="90%" id="S5.T3.1.1.1.m1.1.1.2" xref="S5.T3.1.1.1.m1.1.1.2.cmml">85.8</mn><mrow id="S5.T3.1.1.1.m1.1.1.3" xref="S5.T3.1.1.1.m1.1.1.3.cmml"><mo mathsize="90%" id="S5.T3.1.1.1.m1.1.1.3a" xref="S5.T3.1.1.1.m1.1.1.3.cmml">±</mo><mn mathsize="90%" id="S5.T3.1.1.1.m1.1.1.3.2" xref="S5.T3.1.1.1.m1.1.1.3.2.cmml">0.2</mn></mrow></msub><annotation-xml encoding="MathML-Content" id="S5.T3.1.1.1.m1.1b"><apply id="S5.T3.1.1.1.m1.1.1.cmml" xref="S5.T3.1.1.1.m1.1.1"><csymbol cd="ambiguous" id="S5.T3.1.1.1.m1.1.1.1.cmml" xref="S5.T3.1.1.1.m1.1.1">subscript</csymbol><cn type="float" id="S5.T3.1.1.1.m1.1.1.2.cmml" xref="S5.T3.1.1.1.m1.1.1.2">85.8</cn><apply id="S5.T3.1.1.1.m1.1.1.3.cmml" xref="S5.T3.1.1.1.m1.1.1.3"><csymbol cd="latexml" id="S5.T3.1.1.1.m1.1.1.3.1.cmml" xref="S5.T3.1.1.1.m1.1.1.3">plus-or-minus</csymbol><cn type="float" id="S5.T3.1.1.1.m1.1.1.3.2.cmml" xref="S5.T3.1.1.1.m1.1.1.3.2">0.2</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.T3.1.1.1.m1.1c">85.8_{\pm 0.2}</annotation></semantics></math></td>
<td id="S5.T3.2.2.2" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:2.0pt;padding-right:2.0pt;"><math id="S5.T3.2.2.2.m1.1" class="ltx_Math" alttext="90.8_{\pm 0.0}" display="inline"><semantics id="S5.T3.2.2.2.m1.1a"><msub id="S5.T3.2.2.2.m1.1.1" xref="S5.T3.2.2.2.m1.1.1.cmml"><mn mathsize="90%" id="S5.T3.2.2.2.m1.1.1.2" xref="S5.T3.2.2.2.m1.1.1.2.cmml">90.8</mn><mrow id="S5.T3.2.2.2.m1.1.1.3" xref="S5.T3.2.2.2.m1.1.1.3.cmml"><mo mathsize="90%" id="S5.T3.2.2.2.m1.1.1.3a" xref="S5.T3.2.2.2.m1.1.1.3.cmml">±</mo><mn mathsize="90%" id="S5.T3.2.2.2.m1.1.1.3.2" xref="S5.T3.2.2.2.m1.1.1.3.2.cmml">0.0</mn></mrow></msub><annotation-xml encoding="MathML-Content" id="S5.T3.2.2.2.m1.1b"><apply id="S5.T3.2.2.2.m1.1.1.cmml" xref="S5.T3.2.2.2.m1.1.1"><csymbol cd="ambiguous" id="S5.T3.2.2.2.m1.1.1.1.cmml" xref="S5.T3.2.2.2.m1.1.1">subscript</csymbol><cn type="float" id="S5.T3.2.2.2.m1.1.1.2.cmml" xref="S5.T3.2.2.2.m1.1.1.2">90.8</cn><apply id="S5.T3.2.2.2.m1.1.1.3.cmml" xref="S5.T3.2.2.2.m1.1.1.3"><csymbol cd="latexml" id="S5.T3.2.2.2.m1.1.1.3.1.cmml" xref="S5.T3.2.2.2.m1.1.1.3">plus-or-minus</csymbol><cn type="float" id="S5.T3.2.2.2.m1.1.1.3.2.cmml" xref="S5.T3.2.2.2.m1.1.1.3.2">0.0</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.T3.2.2.2.m1.1c">90.8_{\pm 0.0}</annotation></semantics></math></td>
<td id="S5.T3.3.3.3" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:2.0pt;padding-right:2.0pt;"><math id="S5.T3.3.3.3.m1.1" class="ltx_Math" alttext="272_{\pm 0}" display="inline"><semantics id="S5.T3.3.3.3.m1.1a"><msub id="S5.T3.3.3.3.m1.1.1" xref="S5.T3.3.3.3.m1.1.1.cmml"><mn mathsize="90%" id="S5.T3.3.3.3.m1.1.1.2" xref="S5.T3.3.3.3.m1.1.1.2.cmml">272</mn><mrow id="S5.T3.3.3.3.m1.1.1.3" xref="S5.T3.3.3.3.m1.1.1.3.cmml"><mo mathsize="90%" id="S5.T3.3.3.3.m1.1.1.3a" xref="S5.T3.3.3.3.m1.1.1.3.cmml">±</mo><mn mathsize="90%" id="S5.T3.3.3.3.m1.1.1.3.2" xref="S5.T3.3.3.3.m1.1.1.3.2.cmml">0</mn></mrow></msub><annotation-xml encoding="MathML-Content" id="S5.T3.3.3.3.m1.1b"><apply id="S5.T3.3.3.3.m1.1.1.cmml" xref="S5.T3.3.3.3.m1.1.1"><csymbol cd="ambiguous" id="S5.T3.3.3.3.m1.1.1.1.cmml" xref="S5.T3.3.3.3.m1.1.1">subscript</csymbol><cn type="integer" id="S5.T3.3.3.3.m1.1.1.2.cmml" xref="S5.T3.3.3.3.m1.1.1.2">272</cn><apply id="S5.T3.3.3.3.m1.1.1.3.cmml" xref="S5.T3.3.3.3.m1.1.1.3"><csymbol cd="latexml" id="S5.T3.3.3.3.m1.1.1.3.1.cmml" xref="S5.T3.3.3.3.m1.1.1.3">plus-or-minus</csymbol><cn type="integer" id="S5.T3.3.3.3.m1.1.1.3.2.cmml" xref="S5.T3.3.3.3.m1.1.1.3.2">0</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.T3.3.3.3.m1.1c">272_{\pm 0}</annotation></semantics></math></td>
<td id="S5.T3.3.3.5" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:2.0pt;padding-right:2.0pt;"><span id="S5.T3.3.3.5.1" class="ltx_text" style="font-size:90%;">-</span></td>
</tr>
<tr id="S5.T3.6.6" class="ltx_tr">
<td id="S5.T3.6.6.4" class="ltx_td ltx_align_left" style="padding-left:2.0pt;padding-right:2.0pt;"><span id="S5.T3.6.6.4.1" class="ltx_text ltx_font_typewriter" style="font-size:90%;">FedDrop</span></td>
<td id="S5.T3.4.4.1" class="ltx_td ltx_align_center" style="padding-left:2.0pt;padding-right:2.0pt;"><math id="S5.T3.4.4.1.m1.1" class="ltx_Math" alttext="84.7_{\pm 0.2}" display="inline"><semantics id="S5.T3.4.4.1.m1.1a"><msub id="S5.T3.4.4.1.m1.1.1" xref="S5.T3.4.4.1.m1.1.1.cmml"><mn mathsize="90%" id="S5.T3.4.4.1.m1.1.1.2" xref="S5.T3.4.4.1.m1.1.1.2.cmml">84.7</mn><mrow id="S5.T3.4.4.1.m1.1.1.3" xref="S5.T3.4.4.1.m1.1.1.3.cmml"><mo mathsize="90%" id="S5.T3.4.4.1.m1.1.1.3a" xref="S5.T3.4.4.1.m1.1.1.3.cmml">±</mo><mn mathsize="90%" id="S5.T3.4.4.1.m1.1.1.3.2" xref="S5.T3.4.4.1.m1.1.1.3.2.cmml">0.2</mn></mrow></msub><annotation-xml encoding="MathML-Content" id="S5.T3.4.4.1.m1.1b"><apply id="S5.T3.4.4.1.m1.1.1.cmml" xref="S5.T3.4.4.1.m1.1.1"><csymbol cd="ambiguous" id="S5.T3.4.4.1.m1.1.1.1.cmml" xref="S5.T3.4.4.1.m1.1.1">subscript</csymbol><cn type="float" id="S5.T3.4.4.1.m1.1.1.2.cmml" xref="S5.T3.4.4.1.m1.1.1.2">84.7</cn><apply id="S5.T3.4.4.1.m1.1.1.3.cmml" xref="S5.T3.4.4.1.m1.1.1.3"><csymbol cd="latexml" id="S5.T3.4.4.1.m1.1.1.3.1.cmml" xref="S5.T3.4.4.1.m1.1.1.3">plus-or-minus</csymbol><cn type="float" id="S5.T3.4.4.1.m1.1.1.3.2.cmml" xref="S5.T3.4.4.1.m1.1.1.3.2">0.2</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.T3.4.4.1.m1.1c">84.7_{\pm 0.2}</annotation></semantics></math></td>
<td id="S5.T3.5.5.2" class="ltx_td ltx_align_center" style="padding-left:2.0pt;padding-right:2.0pt;"><math id="S5.T3.5.5.2.m1.1" class="ltx_Math" alttext="87.6_{\pm 0.0}" display="inline"><semantics id="S5.T3.5.5.2.m1.1a"><msub id="S5.T3.5.5.2.m1.1.1" xref="S5.T3.5.5.2.m1.1.1.cmml"><mn mathsize="90%" id="S5.T3.5.5.2.m1.1.1.2" xref="S5.T3.5.5.2.m1.1.1.2.cmml">87.6</mn><mrow id="S5.T3.5.5.2.m1.1.1.3" xref="S5.T3.5.5.2.m1.1.1.3.cmml"><mo mathsize="90%" id="S5.T3.5.5.2.m1.1.1.3a" xref="S5.T3.5.5.2.m1.1.1.3.cmml">±</mo><mn mathsize="90%" id="S5.T3.5.5.2.m1.1.1.3.2" xref="S5.T3.5.5.2.m1.1.1.3.2.cmml">0.0</mn></mrow></msub><annotation-xml encoding="MathML-Content" id="S5.T3.5.5.2.m1.1b"><apply id="S5.T3.5.5.2.m1.1.1.cmml" xref="S5.T3.5.5.2.m1.1.1"><csymbol cd="ambiguous" id="S5.T3.5.5.2.m1.1.1.1.cmml" xref="S5.T3.5.5.2.m1.1.1">subscript</csymbol><cn type="float" id="S5.T3.5.5.2.m1.1.1.2.cmml" xref="S5.T3.5.5.2.m1.1.1.2">87.6</cn><apply id="S5.T3.5.5.2.m1.1.1.3.cmml" xref="S5.T3.5.5.2.m1.1.1.3"><csymbol cd="latexml" id="S5.T3.5.5.2.m1.1.1.3.1.cmml" xref="S5.T3.5.5.2.m1.1.1.3">plus-or-minus</csymbol><cn type="float" id="S5.T3.5.5.2.m1.1.1.3.2.cmml" xref="S5.T3.5.5.2.m1.1.1.3.2">0.0</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.T3.5.5.2.m1.1c">87.6_{\pm 0.0}</annotation></semantics></math></td>
<td id="S5.T3.6.6.3" class="ltx_td ltx_align_center" style="padding-left:2.0pt;padding-right:2.0pt;"><math id="S5.T3.6.6.3.m1.1" class="ltx_Math" alttext="168_{\pm 0}" display="inline"><semantics id="S5.T3.6.6.3.m1.1a"><msub id="S5.T3.6.6.3.m1.1.1" xref="S5.T3.6.6.3.m1.1.1.cmml"><mn mathsize="90%" id="S5.T3.6.6.3.m1.1.1.2" xref="S5.T3.6.6.3.m1.1.1.2.cmml">168</mn><mrow id="S5.T3.6.6.3.m1.1.1.3" xref="S5.T3.6.6.3.m1.1.1.3.cmml"><mo mathsize="90%" id="S5.T3.6.6.3.m1.1.1.3a" xref="S5.T3.6.6.3.m1.1.1.3.cmml">±</mo><mn mathsize="90%" id="S5.T3.6.6.3.m1.1.1.3.2" xref="S5.T3.6.6.3.m1.1.1.3.2.cmml">0</mn></mrow></msub><annotation-xml encoding="MathML-Content" id="S5.T3.6.6.3.m1.1b"><apply id="S5.T3.6.6.3.m1.1.1.cmml" xref="S5.T3.6.6.3.m1.1.1"><csymbol cd="ambiguous" id="S5.T3.6.6.3.m1.1.1.1.cmml" xref="S5.T3.6.6.3.m1.1.1">subscript</csymbol><cn type="integer" id="S5.T3.6.6.3.m1.1.1.2.cmml" xref="S5.T3.6.6.3.m1.1.1.2">168</cn><apply id="S5.T3.6.6.3.m1.1.1.3.cmml" xref="S5.T3.6.6.3.m1.1.1.3"><csymbol cd="latexml" id="S5.T3.6.6.3.m1.1.1.3.1.cmml" xref="S5.T3.6.6.3.m1.1.1.3">plus-or-minus</csymbol><cn type="integer" id="S5.T3.6.6.3.m1.1.1.3.2.cmml" xref="S5.T3.6.6.3.m1.1.1.3.2">0</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.T3.6.6.3.m1.1c">168_{\pm 0}</annotation></semantics></math></td>
<td id="S5.T3.6.6.5" class="ltx_td ltx_align_center" style="padding-left:2.0pt;padding-right:2.0pt;"><span id="S5.T3.6.6.5.1" class="ltx_text" style="font-size:90%;">-</span></td>
</tr>
<tr id="S5.T3.10.10" class="ltx_tr">
<td id="S5.T3.10.10.5" class="ltx_td ltx_align_left" style="padding-left:2.0pt;padding-right:2.0pt;"><span id="S5.T3.10.10.5.1" class="ltx_text ltx_font_typewriter" style="font-size:90%;">FedL1</span></td>
<td id="S5.T3.7.7.1" class="ltx_td ltx_align_center" style="padding-left:2.0pt;padding-right:2.0pt;"><math id="S5.T3.7.7.1.m1.1" class="ltx_Math" alttext="82.0_{\pm 0.3}" display="inline"><semantics id="S5.T3.7.7.1.m1.1a"><msub id="S5.T3.7.7.1.m1.1.1" xref="S5.T3.7.7.1.m1.1.1.cmml"><mn mathsize="90%" id="S5.T3.7.7.1.m1.1.1.2" xref="S5.T3.7.7.1.m1.1.1.2.cmml">82.0</mn><mrow id="S5.T3.7.7.1.m1.1.1.3" xref="S5.T3.7.7.1.m1.1.1.3.cmml"><mo mathsize="90%" id="S5.T3.7.7.1.m1.1.1.3a" xref="S5.T3.7.7.1.m1.1.1.3.cmml">±</mo><mn mathsize="90%" id="S5.T3.7.7.1.m1.1.1.3.2" xref="S5.T3.7.7.1.m1.1.1.3.2.cmml">0.3</mn></mrow></msub><annotation-xml encoding="MathML-Content" id="S5.T3.7.7.1.m1.1b"><apply id="S5.T3.7.7.1.m1.1.1.cmml" xref="S5.T3.7.7.1.m1.1.1"><csymbol cd="ambiguous" id="S5.T3.7.7.1.m1.1.1.1.cmml" xref="S5.T3.7.7.1.m1.1.1">subscript</csymbol><cn type="float" id="S5.T3.7.7.1.m1.1.1.2.cmml" xref="S5.T3.7.7.1.m1.1.1.2">82.0</cn><apply id="S5.T3.7.7.1.m1.1.1.3.cmml" xref="S5.T3.7.7.1.m1.1.1.3"><csymbol cd="latexml" id="S5.T3.7.7.1.m1.1.1.3.1.cmml" xref="S5.T3.7.7.1.m1.1.1.3">plus-or-minus</csymbol><cn type="float" id="S5.T3.7.7.1.m1.1.1.3.2.cmml" xref="S5.T3.7.7.1.m1.1.1.3.2">0.3</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.T3.7.7.1.m1.1c">82.0_{\pm 0.3}</annotation></semantics></math></td>
<td id="S5.T3.8.8.2" class="ltx_td ltx_align_center" style="padding-left:2.0pt;padding-right:2.0pt;"><math id="S5.T3.8.8.2.m1.1" class="ltx_Math" alttext="85.9_{\pm 0.0}" display="inline"><semantics id="S5.T3.8.8.2.m1.1a"><msub id="S5.T3.8.8.2.m1.1.1" xref="S5.T3.8.8.2.m1.1.1.cmml"><mn mathsize="90%" id="S5.T3.8.8.2.m1.1.1.2" xref="S5.T3.8.8.2.m1.1.1.2.cmml">85.9</mn><mrow id="S5.T3.8.8.2.m1.1.1.3" xref="S5.T3.8.8.2.m1.1.1.3.cmml"><mo mathsize="90%" id="S5.T3.8.8.2.m1.1.1.3a" xref="S5.T3.8.8.2.m1.1.1.3.cmml">±</mo><mn mathsize="90%" id="S5.T3.8.8.2.m1.1.1.3.2" xref="S5.T3.8.8.2.m1.1.1.3.2.cmml">0.0</mn></mrow></msub><annotation-xml encoding="MathML-Content" id="S5.T3.8.8.2.m1.1b"><apply id="S5.T3.8.8.2.m1.1.1.cmml" xref="S5.T3.8.8.2.m1.1.1"><csymbol cd="ambiguous" id="S5.T3.8.8.2.m1.1.1.1.cmml" xref="S5.T3.8.8.2.m1.1.1">subscript</csymbol><cn type="float" id="S5.T3.8.8.2.m1.1.1.2.cmml" xref="S5.T3.8.8.2.m1.1.1.2">85.9</cn><apply id="S5.T3.8.8.2.m1.1.1.3.cmml" xref="S5.T3.8.8.2.m1.1.1.3"><csymbol cd="latexml" id="S5.T3.8.8.2.m1.1.1.3.1.cmml" xref="S5.T3.8.8.2.m1.1.1.3">plus-or-minus</csymbol><cn type="float" id="S5.T3.8.8.2.m1.1.1.3.2.cmml" xref="S5.T3.8.8.2.m1.1.1.3.2">0.0</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.T3.8.8.2.m1.1c">85.9_{\pm 0.0}</annotation></semantics></math></td>
<td id="S5.T3.9.9.3" class="ltx_td ltx_align_center" style="padding-left:2.0pt;padding-right:2.0pt;"><math id="S5.T3.9.9.3.m1.1" class="ltx_Math" alttext="187_{\pm 2}" display="inline"><semantics id="S5.T3.9.9.3.m1.1a"><msub id="S5.T3.9.9.3.m1.1.1" xref="S5.T3.9.9.3.m1.1.1.cmml"><mn mathsize="90%" id="S5.T3.9.9.3.m1.1.1.2" xref="S5.T3.9.9.3.m1.1.1.2.cmml">187</mn><mrow id="S5.T3.9.9.3.m1.1.1.3" xref="S5.T3.9.9.3.m1.1.1.3.cmml"><mo mathsize="90%" id="S5.T3.9.9.3.m1.1.1.3a" xref="S5.T3.9.9.3.m1.1.1.3.cmml">±</mo><mn mathsize="90%" id="S5.T3.9.9.3.m1.1.1.3.2" xref="S5.T3.9.9.3.m1.1.1.3.2.cmml">2</mn></mrow></msub><annotation-xml encoding="MathML-Content" id="S5.T3.9.9.3.m1.1b"><apply id="S5.T3.9.9.3.m1.1.1.cmml" xref="S5.T3.9.9.3.m1.1.1"><csymbol cd="ambiguous" id="S5.T3.9.9.3.m1.1.1.1.cmml" xref="S5.T3.9.9.3.m1.1.1">subscript</csymbol><cn type="integer" id="S5.T3.9.9.3.m1.1.1.2.cmml" xref="S5.T3.9.9.3.m1.1.1.2">187</cn><apply id="S5.T3.9.9.3.m1.1.1.3.cmml" xref="S5.T3.9.9.3.m1.1.1.3"><csymbol cd="latexml" id="S5.T3.9.9.3.m1.1.1.3.1.cmml" xref="S5.T3.9.9.3.m1.1.1.3">plus-or-minus</csymbol><cn type="integer" id="S5.T3.9.9.3.m1.1.1.3.2.cmml" xref="S5.T3.9.9.3.m1.1.1.3.2">2</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.T3.9.9.3.m1.1c">187_{\pm 2}</annotation></semantics></math></td>
<td id="S5.T3.10.10.4" class="ltx_td ltx_align_center" style="padding-left:2.0pt;padding-right:2.0pt;"><math id="S5.T3.10.10.4.m1.1" class="ltx_Math" alttext="45.5_{\pm 1.2}" display="inline"><semantics id="S5.T3.10.10.4.m1.1a"><msub id="S5.T3.10.10.4.m1.1.1" xref="S5.T3.10.10.4.m1.1.1.cmml"><mn mathsize="90%" id="S5.T3.10.10.4.m1.1.1.2" xref="S5.T3.10.10.4.m1.1.1.2.cmml">45.5</mn><mrow id="S5.T3.10.10.4.m1.1.1.3" xref="S5.T3.10.10.4.m1.1.1.3.cmml"><mo mathsize="90%" id="S5.T3.10.10.4.m1.1.1.3a" xref="S5.T3.10.10.4.m1.1.1.3.cmml">±</mo><mn mathsize="90%" id="S5.T3.10.10.4.m1.1.1.3.2" xref="S5.T3.10.10.4.m1.1.1.3.2.cmml">1.2</mn></mrow></msub><annotation-xml encoding="MathML-Content" id="S5.T3.10.10.4.m1.1b"><apply id="S5.T3.10.10.4.m1.1.1.cmml" xref="S5.T3.10.10.4.m1.1.1"><csymbol cd="ambiguous" id="S5.T3.10.10.4.m1.1.1.1.cmml" xref="S5.T3.10.10.4.m1.1.1">subscript</csymbol><cn type="float" id="S5.T3.10.10.4.m1.1.1.2.cmml" xref="S5.T3.10.10.4.m1.1.1.2">45.5</cn><apply id="S5.T3.10.10.4.m1.1.1.3.cmml" xref="S5.T3.10.10.4.m1.1.1.3"><csymbol cd="latexml" id="S5.T3.10.10.4.m1.1.1.3.1.cmml" xref="S5.T3.10.10.4.m1.1.1.3">plus-or-minus</csymbol><cn type="float" id="S5.T3.10.10.4.m1.1.1.3.2.cmml" xref="S5.T3.10.10.4.m1.1.1.3.2">1.2</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.T3.10.10.4.m1.1c">45.5_{\pm 1.2}</annotation></semantics></math></td>
</tr>
<tr id="S5.T3.14.14" class="ltx_tr">
<td id="S5.T3.14.14.5" class="ltx_td ltx_align_left ltx_border_t" style="padding-left:2.0pt;padding-right:2.0pt;">
<span id="S5.T3.14.14.5.1" class="ltx_text ltx_font_typewriter" style="font-size:90%;">FedSparse</span><span id="S5.T3.14.14.5.2" class="ltx_text" style="font-size:90%;">, low</span>
</td>
<td id="S5.T3.11.11.1" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:2.0pt;padding-right:2.0pt;"><math id="S5.T3.11.11.1.m1.1" class="ltx_Math" alttext="85.4_{\pm 0.2}" display="inline"><semantics id="S5.T3.11.11.1.m1.1a"><msub id="S5.T3.11.11.1.m1.1.1" xref="S5.T3.11.11.1.m1.1.1.cmml"><mn mathsize="90%" id="S5.T3.11.11.1.m1.1.1.2" xref="S5.T3.11.11.1.m1.1.1.2.cmml">85.4</mn><mrow id="S5.T3.11.11.1.m1.1.1.3" xref="S5.T3.11.11.1.m1.1.1.3.cmml"><mo mathsize="90%" id="S5.T3.11.11.1.m1.1.1.3a" xref="S5.T3.11.11.1.m1.1.1.3.cmml">±</mo><mn mathsize="90%" id="S5.T3.11.11.1.m1.1.1.3.2" xref="S5.T3.11.11.1.m1.1.1.3.2.cmml">0.2</mn></mrow></msub><annotation-xml encoding="MathML-Content" id="S5.T3.11.11.1.m1.1b"><apply id="S5.T3.11.11.1.m1.1.1.cmml" xref="S5.T3.11.11.1.m1.1.1"><csymbol cd="ambiguous" id="S5.T3.11.11.1.m1.1.1.1.cmml" xref="S5.T3.11.11.1.m1.1.1">subscript</csymbol><cn type="float" id="S5.T3.11.11.1.m1.1.1.2.cmml" xref="S5.T3.11.11.1.m1.1.1.2">85.4</cn><apply id="S5.T3.11.11.1.m1.1.1.3.cmml" xref="S5.T3.11.11.1.m1.1.1.3"><csymbol cd="latexml" id="S5.T3.11.11.1.m1.1.1.3.1.cmml" xref="S5.T3.11.11.1.m1.1.1.3">plus-or-minus</csymbol><cn type="float" id="S5.T3.11.11.1.m1.1.1.3.2.cmml" xref="S5.T3.11.11.1.m1.1.1.3.2">0.2</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.T3.11.11.1.m1.1c">85.4_{\pm 0.2}</annotation></semantics></math></td>
<td id="S5.T3.12.12.2" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:2.0pt;padding-right:2.0pt;"><math id="S5.T3.12.12.2.m1.1" class="ltx_Math" alttext="90.8_{\pm 0.0}" display="inline"><semantics id="S5.T3.12.12.2.m1.1a"><msub id="S5.T3.12.12.2.m1.1.1" xref="S5.T3.12.12.2.m1.1.1.cmml"><mn mathsize="90%" id="S5.T3.12.12.2.m1.1.1.2" xref="S5.T3.12.12.2.m1.1.1.2.cmml">90.8</mn><mrow id="S5.T3.12.12.2.m1.1.1.3" xref="S5.T3.12.12.2.m1.1.1.3.cmml"><mo mathsize="90%" id="S5.T3.12.12.2.m1.1.1.3a" xref="S5.T3.12.12.2.m1.1.1.3.cmml">±</mo><mn mathsize="90%" id="S5.T3.12.12.2.m1.1.1.3.2" xref="S5.T3.12.12.2.m1.1.1.3.2.cmml">0.0</mn></mrow></msub><annotation-xml encoding="MathML-Content" id="S5.T3.12.12.2.m1.1b"><apply id="S5.T3.12.12.2.m1.1.1.cmml" xref="S5.T3.12.12.2.m1.1.1"><csymbol cd="ambiguous" id="S5.T3.12.12.2.m1.1.1.1.cmml" xref="S5.T3.12.12.2.m1.1.1">subscript</csymbol><cn type="float" id="S5.T3.12.12.2.m1.1.1.2.cmml" xref="S5.T3.12.12.2.m1.1.1.2">90.8</cn><apply id="S5.T3.12.12.2.m1.1.1.3.cmml" xref="S5.T3.12.12.2.m1.1.1.3"><csymbol cd="latexml" id="S5.T3.12.12.2.m1.1.1.3.1.cmml" xref="S5.T3.12.12.2.m1.1.1.3">plus-or-minus</csymbol><cn type="float" id="S5.T3.12.12.2.m1.1.1.3.2.cmml" xref="S5.T3.12.12.2.m1.1.1.3.2">0.0</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.T3.12.12.2.m1.1c">90.8_{\pm 0.0}</annotation></semantics></math></td>
<td id="S5.T3.13.13.3" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:2.0pt;padding-right:2.0pt;"><math id="S5.T3.13.13.3.m1.1" class="ltx_Math" alttext="270_{\pm 0}" display="inline"><semantics id="S5.T3.13.13.3.m1.1a"><msub id="S5.T3.13.13.3.m1.1.1" xref="S5.T3.13.13.3.m1.1.1.cmml"><mn mathsize="90%" id="S5.T3.13.13.3.m1.1.1.2" xref="S5.T3.13.13.3.m1.1.1.2.cmml">270</mn><mrow id="S5.T3.13.13.3.m1.1.1.3" xref="S5.T3.13.13.3.m1.1.1.3.cmml"><mo mathsize="90%" id="S5.T3.13.13.3.m1.1.1.3a" xref="S5.T3.13.13.3.m1.1.1.3.cmml">±</mo><mn mathsize="90%" id="S5.T3.13.13.3.m1.1.1.3.2" xref="S5.T3.13.13.3.m1.1.1.3.2.cmml">0</mn></mrow></msub><annotation-xml encoding="MathML-Content" id="S5.T3.13.13.3.m1.1b"><apply id="S5.T3.13.13.3.m1.1.1.cmml" xref="S5.T3.13.13.3.m1.1.1"><csymbol cd="ambiguous" id="S5.T3.13.13.3.m1.1.1.1.cmml" xref="S5.T3.13.13.3.m1.1.1">subscript</csymbol><cn type="integer" id="S5.T3.13.13.3.m1.1.1.2.cmml" xref="S5.T3.13.13.3.m1.1.1.2">270</cn><apply id="S5.T3.13.13.3.m1.1.1.3.cmml" xref="S5.T3.13.13.3.m1.1.1.3"><csymbol cd="latexml" id="S5.T3.13.13.3.m1.1.1.3.1.cmml" xref="S5.T3.13.13.3.m1.1.1.3">plus-or-minus</csymbol><cn type="integer" id="S5.T3.13.13.3.m1.1.1.3.2.cmml" xref="S5.T3.13.13.3.m1.1.1.3.2">0</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.T3.13.13.3.m1.1c">270_{\pm 0}</annotation></semantics></math></td>
<td id="S5.T3.14.14.4" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:2.0pt;padding-right:2.0pt;"><math id="S5.T3.14.14.4.m1.1" class="ltx_Math" alttext="1.0_{\pm 0.2}" display="inline"><semantics id="S5.T3.14.14.4.m1.1a"><msub id="S5.T3.14.14.4.m1.1.1" xref="S5.T3.14.14.4.m1.1.1.cmml"><mn mathsize="90%" id="S5.T3.14.14.4.m1.1.1.2" xref="S5.T3.14.14.4.m1.1.1.2.cmml">1.0</mn><mrow id="S5.T3.14.14.4.m1.1.1.3" xref="S5.T3.14.14.4.m1.1.1.3.cmml"><mo mathsize="90%" id="S5.T3.14.14.4.m1.1.1.3a" xref="S5.T3.14.14.4.m1.1.1.3.cmml">±</mo><mn mathsize="90%" id="S5.T3.14.14.4.m1.1.1.3.2" xref="S5.T3.14.14.4.m1.1.1.3.2.cmml">0.2</mn></mrow></msub><annotation-xml encoding="MathML-Content" id="S5.T3.14.14.4.m1.1b"><apply id="S5.T3.14.14.4.m1.1.1.cmml" xref="S5.T3.14.14.4.m1.1.1"><csymbol cd="ambiguous" id="S5.T3.14.14.4.m1.1.1.1.cmml" xref="S5.T3.14.14.4.m1.1.1">subscript</csymbol><cn type="float" id="S5.T3.14.14.4.m1.1.1.2.cmml" xref="S5.T3.14.14.4.m1.1.1.2">1.0</cn><apply id="S5.T3.14.14.4.m1.1.1.3.cmml" xref="S5.T3.14.14.4.m1.1.1.3"><csymbol cd="latexml" id="S5.T3.14.14.4.m1.1.1.3.1.cmml" xref="S5.T3.14.14.4.m1.1.1.3">plus-or-minus</csymbol><cn type="float" id="S5.T3.14.14.4.m1.1.1.3.2.cmml" xref="S5.T3.14.14.4.m1.1.1.3.2">0.2</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.T3.14.14.4.m1.1c">1.0_{\pm 0.2}</annotation></semantics></math></td>
</tr>
<tr id="S5.T3.18.18" class="ltx_tr">
<td id="S5.T3.18.18.5" class="ltx_td ltx_align_left" style="padding-left:2.0pt;padding-right:2.0pt;">
<span id="S5.T3.18.18.5.1" class="ltx_text ltx_font_typewriter" style="font-size:90%;">FedSparse</span><span id="S5.T3.18.18.5.2" class="ltx_text" style="font-size:90%;">, mid</span>
</td>
<td id="S5.T3.15.15.1" class="ltx_td ltx_align_center" style="padding-left:2.0pt;padding-right:2.0pt;"><math id="S5.T3.15.15.1.m1.1" class="ltx_Math" alttext="85.1_{\pm 0.3}" display="inline"><semantics id="S5.T3.15.15.1.m1.1a"><msub id="S5.T3.15.15.1.m1.1.1" xref="S5.T3.15.15.1.m1.1.1.cmml"><mn mathsize="90%" id="S5.T3.15.15.1.m1.1.1.2" xref="S5.T3.15.15.1.m1.1.1.2.cmml">85.1</mn><mrow id="S5.T3.15.15.1.m1.1.1.3" xref="S5.T3.15.15.1.m1.1.1.3.cmml"><mo mathsize="90%" id="S5.T3.15.15.1.m1.1.1.3a" xref="S5.T3.15.15.1.m1.1.1.3.cmml">±</mo><mn mathsize="90%" id="S5.T3.15.15.1.m1.1.1.3.2" xref="S5.T3.15.15.1.m1.1.1.3.2.cmml">0.3</mn></mrow></msub><annotation-xml encoding="MathML-Content" id="S5.T3.15.15.1.m1.1b"><apply id="S5.T3.15.15.1.m1.1.1.cmml" xref="S5.T3.15.15.1.m1.1.1"><csymbol cd="ambiguous" id="S5.T3.15.15.1.m1.1.1.1.cmml" xref="S5.T3.15.15.1.m1.1.1">subscript</csymbol><cn type="float" id="S5.T3.15.15.1.m1.1.1.2.cmml" xref="S5.T3.15.15.1.m1.1.1.2">85.1</cn><apply id="S5.T3.15.15.1.m1.1.1.3.cmml" xref="S5.T3.15.15.1.m1.1.1.3"><csymbol cd="latexml" id="S5.T3.15.15.1.m1.1.1.3.1.cmml" xref="S5.T3.15.15.1.m1.1.1.3">plus-or-minus</csymbol><cn type="float" id="S5.T3.15.15.1.m1.1.1.3.2.cmml" xref="S5.T3.15.15.1.m1.1.1.3.2">0.3</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.T3.15.15.1.m1.1c">85.1_{\pm 0.3}</annotation></semantics></math></td>
<td id="S5.T3.16.16.2" class="ltx_td ltx_align_center" style="padding-left:2.0pt;padding-right:2.0pt;"><math id="S5.T3.16.16.2.m1.1" class="ltx_Math" alttext="90.6_{\pm 0.0}" display="inline"><semantics id="S5.T3.16.16.2.m1.1a"><msub id="S5.T3.16.16.2.m1.1.1" xref="S5.T3.16.16.2.m1.1.1.cmml"><mn mathsize="90%" id="S5.T3.16.16.2.m1.1.1.2" xref="S5.T3.16.16.2.m1.1.1.2.cmml">90.6</mn><mrow id="S5.T3.16.16.2.m1.1.1.3" xref="S5.T3.16.16.2.m1.1.1.3.cmml"><mo mathsize="90%" id="S5.T3.16.16.2.m1.1.1.3a" xref="S5.T3.16.16.2.m1.1.1.3.cmml">±</mo><mn mathsize="90%" id="S5.T3.16.16.2.m1.1.1.3.2" xref="S5.T3.16.16.2.m1.1.1.3.2.cmml">0.0</mn></mrow></msub><annotation-xml encoding="MathML-Content" id="S5.T3.16.16.2.m1.1b"><apply id="S5.T3.16.16.2.m1.1.1.cmml" xref="S5.T3.16.16.2.m1.1.1"><csymbol cd="ambiguous" id="S5.T3.16.16.2.m1.1.1.1.cmml" xref="S5.T3.16.16.2.m1.1.1">subscript</csymbol><cn type="float" id="S5.T3.16.16.2.m1.1.1.2.cmml" xref="S5.T3.16.16.2.m1.1.1.2">90.6</cn><apply id="S5.T3.16.16.2.m1.1.1.3.cmml" xref="S5.T3.16.16.2.m1.1.1.3"><csymbol cd="latexml" id="S5.T3.16.16.2.m1.1.1.3.1.cmml" xref="S5.T3.16.16.2.m1.1.1.3">plus-or-minus</csymbol><cn type="float" id="S5.T3.16.16.2.m1.1.1.3.2.cmml" xref="S5.T3.16.16.2.m1.1.1.3.2">0.0</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.T3.16.16.2.m1.1c">90.6_{\pm 0.0}</annotation></semantics></math></td>
<td id="S5.T3.17.17.3" class="ltx_td ltx_align_center" style="padding-left:2.0pt;padding-right:2.0pt;"><math id="S5.T3.17.17.3.m1.1" class="ltx_Math" alttext="148_{\pm 2}" display="inline"><semantics id="S5.T3.17.17.3.m1.1a"><msub id="S5.T3.17.17.3.m1.1.1" xref="S5.T3.17.17.3.m1.1.1.cmml"><mn mathsize="90%" id="S5.T3.17.17.3.m1.1.1.2" xref="S5.T3.17.17.3.m1.1.1.2.cmml">148</mn><mrow id="S5.T3.17.17.3.m1.1.1.3" xref="S5.T3.17.17.3.m1.1.1.3.cmml"><mo mathsize="90%" id="S5.T3.17.17.3.m1.1.1.3a" xref="S5.T3.17.17.3.m1.1.1.3.cmml">±</mo><mn mathsize="90%" id="S5.T3.17.17.3.m1.1.1.3.2" xref="S5.T3.17.17.3.m1.1.1.3.2.cmml">2</mn></mrow></msub><annotation-xml encoding="MathML-Content" id="S5.T3.17.17.3.m1.1b"><apply id="S5.T3.17.17.3.m1.1.1.cmml" xref="S5.T3.17.17.3.m1.1.1"><csymbol cd="ambiguous" id="S5.T3.17.17.3.m1.1.1.1.cmml" xref="S5.T3.17.17.3.m1.1.1">subscript</csymbol><cn type="integer" id="S5.T3.17.17.3.m1.1.1.2.cmml" xref="S5.T3.17.17.3.m1.1.1.2">148</cn><apply id="S5.T3.17.17.3.m1.1.1.3.cmml" xref="S5.T3.17.17.3.m1.1.1.3"><csymbol cd="latexml" id="S5.T3.17.17.3.m1.1.1.3.1.cmml" xref="S5.T3.17.17.3.m1.1.1.3">plus-or-minus</csymbol><cn type="integer" id="S5.T3.17.17.3.m1.1.1.3.2.cmml" xref="S5.T3.17.17.3.m1.1.1.3.2">2</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.T3.17.17.3.m1.1c">148_{\pm 2}</annotation></semantics></math></td>
<td id="S5.T3.18.18.4" class="ltx_td ltx_align_center" style="padding-left:2.0pt;padding-right:2.0pt;"><math id="S5.T3.18.18.4.m1.1" class="ltx_Math" alttext="45.6_{\pm 0.7}" display="inline"><semantics id="S5.T3.18.18.4.m1.1a"><msub id="S5.T3.18.18.4.m1.1.1" xref="S5.T3.18.18.4.m1.1.1.cmml"><mn mathsize="90%" id="S5.T3.18.18.4.m1.1.1.2" xref="S5.T3.18.18.4.m1.1.1.2.cmml">45.6</mn><mrow id="S5.T3.18.18.4.m1.1.1.3" xref="S5.T3.18.18.4.m1.1.1.3.cmml"><mo mathsize="90%" id="S5.T3.18.18.4.m1.1.1.3a" xref="S5.T3.18.18.4.m1.1.1.3.cmml">±</mo><mn mathsize="90%" id="S5.T3.18.18.4.m1.1.1.3.2" xref="S5.T3.18.18.4.m1.1.1.3.2.cmml">0.7</mn></mrow></msub><annotation-xml encoding="MathML-Content" id="S5.T3.18.18.4.m1.1b"><apply id="S5.T3.18.18.4.m1.1.1.cmml" xref="S5.T3.18.18.4.m1.1.1"><csymbol cd="ambiguous" id="S5.T3.18.18.4.m1.1.1.1.cmml" xref="S5.T3.18.18.4.m1.1.1">subscript</csymbol><cn type="float" id="S5.T3.18.18.4.m1.1.1.2.cmml" xref="S5.T3.18.18.4.m1.1.1.2">45.6</cn><apply id="S5.T3.18.18.4.m1.1.1.3.cmml" xref="S5.T3.18.18.4.m1.1.1.3"><csymbol cd="latexml" id="S5.T3.18.18.4.m1.1.1.3.1.cmml" xref="S5.T3.18.18.4.m1.1.1.3">plus-or-minus</csymbol><cn type="float" id="S5.T3.18.18.4.m1.1.1.3.2.cmml" xref="S5.T3.18.18.4.m1.1.1.3.2">0.7</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.T3.18.18.4.m1.1c">45.6_{\pm 0.7}</annotation></semantics></math></td>
</tr>
<tr id="S5.T3.22.22" class="ltx_tr">
<td id="S5.T3.22.22.5" class="ltx_td ltx_align_left ltx_border_bb ltx_border_b" style="padding-left:2.0pt;padding-right:2.0pt;">
<span id="S5.T3.22.22.5.1" class="ltx_text ltx_font_typewriter" style="font-size:90%;">FedSparse</span><span id="S5.T3.22.22.5.2" class="ltx_text" style="font-size:90%;">, high</span>
</td>
<td id="S5.T3.19.19.1" class="ltx_td ltx_align_center ltx_border_bb ltx_border_b" style="padding-left:2.0pt;padding-right:2.0pt;"><math id="S5.T3.19.19.1.m1.1" class="ltx_Math" alttext="84.1_{\pm 0.4}" display="inline"><semantics id="S5.T3.19.19.1.m1.1a"><msub id="S5.T3.19.19.1.m1.1.1" xref="S5.T3.19.19.1.m1.1.1.cmml"><mn mathsize="90%" id="S5.T3.19.19.1.m1.1.1.2" xref="S5.T3.19.19.1.m1.1.1.2.cmml">84.1</mn><mrow id="S5.T3.19.19.1.m1.1.1.3" xref="S5.T3.19.19.1.m1.1.1.3.cmml"><mo mathsize="90%" id="S5.T3.19.19.1.m1.1.1.3a" xref="S5.T3.19.19.1.m1.1.1.3.cmml">±</mo><mn mathsize="90%" id="S5.T3.19.19.1.m1.1.1.3.2" xref="S5.T3.19.19.1.m1.1.1.3.2.cmml">0.4</mn></mrow></msub><annotation-xml encoding="MathML-Content" id="S5.T3.19.19.1.m1.1b"><apply id="S5.T3.19.19.1.m1.1.1.cmml" xref="S5.T3.19.19.1.m1.1.1"><csymbol cd="ambiguous" id="S5.T3.19.19.1.m1.1.1.1.cmml" xref="S5.T3.19.19.1.m1.1.1">subscript</csymbol><cn type="float" id="S5.T3.19.19.1.m1.1.1.2.cmml" xref="S5.T3.19.19.1.m1.1.1.2">84.1</cn><apply id="S5.T3.19.19.1.m1.1.1.3.cmml" xref="S5.T3.19.19.1.m1.1.1.3"><csymbol cd="latexml" id="S5.T3.19.19.1.m1.1.1.3.1.cmml" xref="S5.T3.19.19.1.m1.1.1.3">plus-or-minus</csymbol><cn type="float" id="S5.T3.19.19.1.m1.1.1.3.2.cmml" xref="S5.T3.19.19.1.m1.1.1.3.2">0.4</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.T3.19.19.1.m1.1c">84.1_{\pm 0.4}</annotation></semantics></math></td>
<td id="S5.T3.20.20.2" class="ltx_td ltx_align_center ltx_border_bb ltx_border_b" style="padding-left:2.0pt;padding-right:2.0pt;"><math id="S5.T3.20.20.2.m1.1" class="ltx_Math" alttext="89.6_{\pm 0.1}" display="inline"><semantics id="S5.T3.20.20.2.m1.1a"><msub id="S5.T3.20.20.2.m1.1.1" xref="S5.T3.20.20.2.m1.1.1.cmml"><mn mathsize="90%" id="S5.T3.20.20.2.m1.1.1.2" xref="S5.T3.20.20.2.m1.1.1.2.cmml">89.6</mn><mrow id="S5.T3.20.20.2.m1.1.1.3" xref="S5.T3.20.20.2.m1.1.1.3.cmml"><mo mathsize="90%" id="S5.T3.20.20.2.m1.1.1.3a" xref="S5.T3.20.20.2.m1.1.1.3.cmml">±</mo><mn mathsize="90%" id="S5.T3.20.20.2.m1.1.1.3.2" xref="S5.T3.20.20.2.m1.1.1.3.2.cmml">0.1</mn></mrow></msub><annotation-xml encoding="MathML-Content" id="S5.T3.20.20.2.m1.1b"><apply id="S5.T3.20.20.2.m1.1.1.cmml" xref="S5.T3.20.20.2.m1.1.1"><csymbol cd="ambiguous" id="S5.T3.20.20.2.m1.1.1.1.cmml" xref="S5.T3.20.20.2.m1.1.1">subscript</csymbol><cn type="float" id="S5.T3.20.20.2.m1.1.1.2.cmml" xref="S5.T3.20.20.2.m1.1.1.2">89.6</cn><apply id="S5.T3.20.20.2.m1.1.1.3.cmml" xref="S5.T3.20.20.2.m1.1.1.3"><csymbol cd="latexml" id="S5.T3.20.20.2.m1.1.1.3.1.cmml" xref="S5.T3.20.20.2.m1.1.1.3">plus-or-minus</csymbol><cn type="float" id="S5.T3.20.20.2.m1.1.1.3.2.cmml" xref="S5.T3.20.20.2.m1.1.1.3.2">0.1</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.T3.20.20.2.m1.1c">89.6_{\pm 0.1}</annotation></semantics></math></td>
<td id="S5.T3.21.21.3" class="ltx_td ltx_align_center ltx_border_bb ltx_border_b" style="padding-left:2.0pt;padding-right:2.0pt;"><math id="S5.T3.21.21.3.m1.1" class="ltx_Math" alttext="102_{\pm 3}" display="inline"><semantics id="S5.T3.21.21.3.m1.1a"><msub id="S5.T3.21.21.3.m1.1.1" xref="S5.T3.21.21.3.m1.1.1.cmml"><mn mathsize="90%" id="S5.T3.21.21.3.m1.1.1.2" xref="S5.T3.21.21.3.m1.1.1.2.cmml">102</mn><mrow id="S5.T3.21.21.3.m1.1.1.3" xref="S5.T3.21.21.3.m1.1.1.3.cmml"><mo mathsize="90%" id="S5.T3.21.21.3.m1.1.1.3a" xref="S5.T3.21.21.3.m1.1.1.3.cmml">±</mo><mn mathsize="90%" id="S5.T3.21.21.3.m1.1.1.3.2" xref="S5.T3.21.21.3.m1.1.1.3.2.cmml">3</mn></mrow></msub><annotation-xml encoding="MathML-Content" id="S5.T3.21.21.3.m1.1b"><apply id="S5.T3.21.21.3.m1.1.1.cmml" xref="S5.T3.21.21.3.m1.1.1"><csymbol cd="ambiguous" id="S5.T3.21.21.3.m1.1.1.1.cmml" xref="S5.T3.21.21.3.m1.1.1">subscript</csymbol><cn type="integer" id="S5.T3.21.21.3.m1.1.1.2.cmml" xref="S5.T3.21.21.3.m1.1.1.2">102</cn><apply id="S5.T3.21.21.3.m1.1.1.3.cmml" xref="S5.T3.21.21.3.m1.1.1.3"><csymbol cd="latexml" id="S5.T3.21.21.3.m1.1.1.3.1.cmml" xref="S5.T3.21.21.3.m1.1.1.3">plus-or-minus</csymbol><cn type="integer" id="S5.T3.21.21.3.m1.1.1.3.2.cmml" xref="S5.T3.21.21.3.m1.1.1.3.2">3</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.T3.21.21.3.m1.1c">102_{\pm 3}</annotation></semantics></math></td>
<td id="S5.T3.22.22.4" class="ltx_td ltx_align_center ltx_border_bb ltx_border_b" style="padding-left:2.0pt;padding-right:2.0pt;"><math id="S5.T3.22.22.4.m1.1" class="ltx_Math" alttext="62.8_{\pm 1.1}" display="inline"><semantics id="S5.T3.22.22.4.m1.1a"><msub id="S5.T3.22.22.4.m1.1.1" xref="S5.T3.22.22.4.m1.1.1.cmml"><mn mathsize="90%" id="S5.T3.22.22.4.m1.1.1.2" xref="S5.T3.22.22.4.m1.1.1.2.cmml">62.8</mn><mrow id="S5.T3.22.22.4.m1.1.1.3" xref="S5.T3.22.22.4.m1.1.1.3.cmml"><mo mathsize="90%" id="S5.T3.22.22.4.m1.1.1.3a" xref="S5.T3.22.22.4.m1.1.1.3.cmml">±</mo><mn mathsize="90%" id="S5.T3.22.22.4.m1.1.1.3.2" xref="S5.T3.22.22.4.m1.1.1.3.2.cmml">1.1</mn></mrow></msub><annotation-xml encoding="MathML-Content" id="S5.T3.22.22.4.m1.1b"><apply id="S5.T3.22.22.4.m1.1.1.cmml" xref="S5.T3.22.22.4.m1.1.1"><csymbol cd="ambiguous" id="S5.T3.22.22.4.m1.1.1.1.cmml" xref="S5.T3.22.22.4.m1.1.1">subscript</csymbol><cn type="float" id="S5.T3.22.22.4.m1.1.1.2.cmml" xref="S5.T3.22.22.4.m1.1.1.2">62.8</cn><apply id="S5.T3.22.22.4.m1.1.1.3.cmml" xref="S5.T3.22.22.4.m1.1.1.3"><csymbol cd="latexml" id="S5.T3.22.22.4.m1.1.1.3.1.cmml" xref="S5.T3.22.22.4.m1.1.1.3">plus-or-minus</csymbol><cn type="float" id="S5.T3.22.22.4.m1.1.1.3.2.cmml" xref="S5.T3.22.22.4.m1.1.1.3.2">1.1</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.T3.22.22.4.m1.1c">62.8_{\pm 1.1}</annotation></semantics></math></td>
</tr>
</table>
</figure>
<figure id="S5.F3" class="ltx_figure">
<div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_3">
<figure id="S5.F3.sf1" class="ltx_figure ltx_figure_panel"><img src="/html/2111.10192/assets/figures/cifar10_global_gb.png" id="S5.F3.sf1.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="598" height="416" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span id="S5.F3.sf1.2.1.1" class="ltx_text" style="font-size:90%;">(a)</span> </span><span id="S5.F3.sf1.3.2" class="ltx_text" style="font-size:90%;">Cifar10</span></figcaption>
</figure>
</div>
<div class="ltx_flex_cell ltx_flex_size_3">
<figure id="S5.F3.sf2" class="ltx_figure ltx_figure_panel"><img src="/html/2111.10192/assets/figures/cifar100_global_gb.png" id="S5.F3.sf2.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="598" height="424" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span id="S5.F3.sf2.2.1.1" class="ltx_text" style="font-size:90%;">(b)</span> </span><span id="S5.F3.sf2.3.2" class="ltx_text" style="font-size:90%;">Cifar100</span></figcaption>
</figure>
</div>
<div class="ltx_flex_cell ltx_flex_size_3">
<figure id="S5.F3.sf3" class="ltx_figure ltx_figure_panel"><img src="/html/2111.10192/assets/figures/femnist_global_gb.png" id="S5.F3.sf3.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="598" height="424" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span id="S5.F3.sf3.2.1.1" class="ltx_text" style="font-size:90%;">(c)</span> </span><span id="S5.F3.sf3.3.2" class="ltx_text" style="font-size:90%;">Femnist</span></figcaption>
</figure>
</div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_3">
<figure id="S5.F3.sf4" class="ltx_figure ltx_figure_panel ltx_align_center"><img src="/html/2111.10192/assets/figures/cifar10_local_gb.png" id="S5.F3.sf4.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="598" height="416" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span id="S5.F3.sf4.2.1.1" class="ltx_text" style="font-size:90%;">(d)</span> </span><span id="S5.F3.sf4.3.2" class="ltx_text" style="font-size:90%;">Cifar10</span></figcaption>
</figure>
</div>
<div class="ltx_flex_cell ltx_flex_size_3">
<figure id="S5.F3.sf5" class="ltx_figure ltx_figure_panel ltx_align_center"><img src="/html/2111.10192/assets/figures/cifar100_local_gb.png" id="S5.F3.sf5.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="598" height="424" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span id="S5.F3.sf5.2.1.1" class="ltx_text" style="font-size:90%;">(e)</span> </span><span id="S5.F3.sf5.3.2" class="ltx_text" style="font-size:90%;">Cifar100</span></figcaption>
</figure>
</div>
<div class="ltx_flex_cell ltx_flex_size_3">
<figure id="S5.F3.sf6" class="ltx_figure ltx_figure_panel ltx_align_center"><img src="/html/2111.10192/assets/figures/femnist_local_gb.png" id="S5.F3.sf6.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="598" height="424" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span id="S5.F3.sf6.2.1.1" class="ltx_text" style="font-size:90%;">(f)</span> </span><span id="S5.F3.sf6.3.2" class="ltx_text" style="font-size:90%;">Femnist</span></figcaption>
</figure>
</div>
</div>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span id="S5.F3.2.1.1" class="ltx_text" style="font-size:90%;">Figure 3</span>: </span><span id="S5.F3.3.2" class="ltx_text" style="font-size:90%;">Global model accuracy (top row) and average local model accuracy (bottom row) across all clients (y-axis) as a function of the amount of GB communicated (top row). Best viewed in color.</span></figcaption>
</figure>
<div id="S5.SS1.p2" class="ltx_para">
<p id="S5.SS1.p2.4" class="ltx_p">We can see that for CIFAR 10, the <span id="S5.SS1.p2.4.1" class="ltx_text ltx_font_typewriter">FedSparse</span> models with medium (<math id="S5.SS1.p2.1.m1.1" class="ltx_Math" alttext="\sim" display="inline"><semantics id="S5.SS1.p2.1.m1.1a"><mo id="S5.SS1.p2.1.m1.1.1" xref="S5.SS1.p2.1.m1.1.1.cmml">∼</mo><annotation-xml encoding="MathML-Content" id="S5.SS1.p2.1.m1.1b"><csymbol cd="latexml" id="S5.SS1.p2.1.m1.1.1.cmml" xref="S5.SS1.p2.1.m1.1.1">similar-to</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S5.SS1.p2.1.m1.1c">\sim</annotation></semantics></math>47%) and high (<math id="S5.SS1.p2.2.m2.1" class="ltx_Math" alttext="\sim" display="inline"><semantics id="S5.SS1.p2.2.m2.1a"><mo id="S5.SS1.p2.2.m2.1.1" xref="S5.SS1.p2.2.m2.1.1.cmml">∼</mo><annotation-xml encoding="MathML-Content" id="S5.SS1.p2.2.m2.1b"><csymbol cd="latexml" id="S5.SS1.p2.2.m2.1.1.cmml" xref="S5.SS1.p2.2.m2.1.1">similar-to</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S5.SS1.p2.2.m2.1c">\sim</annotation></semantics></math>66%) sparsity outperform all other methods for small communications budgets on the global accuracy front but are eventually surpassed by <span id="S5.SS1.p2.4.2" class="ltx_text ltx_font_typewriter">FedDrop</span> on higher budgets. However, on the local accuracy front, we see that the <span id="S5.SS1.p2.4.3" class="ltx_text ltx_font_typewriter">FedSparse</span> models perform better than both baselines, achieving, <em id="S5.SS1.p2.4.4" class="ltx_emph ltx_font_italic">e.g.</em>, <math id="S5.SS1.p2.3.m3.1" class="ltx_Math" alttext="\sim" display="inline"><semantics id="S5.SS1.p2.3.m3.1a"><mo id="S5.SS1.p2.3.m3.1.1" xref="S5.SS1.p2.3.m3.1.1.cmml">∼</mo><annotation-xml encoding="MathML-Content" id="S5.SS1.p2.3.m3.1b"><csymbol cd="latexml" id="S5.SS1.p2.3.m3.1.1.cmml" xref="S5.SS1.p2.3.m3.1.1">similar-to</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S5.SS1.p2.3.m3.1c">\sim</annotation></semantics></math> 87% local accuracy with <math id="S5.SS1.p2.4.m4.1" class="ltx_Math" alttext="\sim" display="inline"><semantics id="S5.SS1.p2.4.m4.1a"><mo id="S5.SS1.p2.4.m4.1.1" xref="S5.SS1.p2.4.m4.1.1.cmml">∼</mo><annotation-xml encoding="MathML-Content" id="S5.SS1.p2.4.m4.1b"><csymbol cd="latexml" id="S5.SS1.p2.4.m4.1.1.cmml" xref="S5.SS1.p2.4.m4.1.1">similar-to</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S5.SS1.p2.4.m4.1c">\sim</annotation></semantics></math>34% less communication compared to <span id="S5.SS1.p2.4.5" class="ltx_text ltx_font_typewriter">FedAvg</span>. Overall, judging the final performance only, we see that <span id="S5.SS1.p2.4.6" class="ltx_text ltx_font_typewriter">FedDrop</span> reaches the best accuracy on the global model, but <span id="S5.SS1.p2.4.7" class="ltx_text ltx_font_typewriter">FedSparse</span> reaches the best accuracy in the local models. <span id="S5.SS1.p2.4.8" class="ltx_text ltx_font_typewriter">FedL1</span> was able to learn a sparse model that was comparable in size to the <span id="S5.SS1.p2.4.9" class="ltx_text ltx_font_typewriter">FedSparse</span> ‘high’ setting, however, the final accuracies, both the global and the local, were worse than all of the other methods.</p>
</div>
<div id="S5.SS1.p3" class="ltx_para">
<p id="S5.SS1.p3.2" class="ltx_p">On CIFAR 100, the differences are less pronounced, as the models did not fully converge for the maximum number of rounds we use. Nevertheless, we still observe similar patterns; for small communication budgets, the sparser models are better for both the global and local accuracy as, <em id="S5.SS1.p3.2.1" class="ltx_emph ltx_font_italic">e.g.</em>, they can reach <math id="S5.SS1.p3.1.m1.1" class="ltx_Math" alttext="\sim" display="inline"><semantics id="S5.SS1.p3.1.m1.1a"><mo id="S5.SS1.p3.1.m1.1.1" xref="S5.SS1.p3.1.m1.1.1.cmml">∼</mo><annotation-xml encoding="MathML-Content" id="S5.SS1.p3.1.m1.1b"><csymbol cd="latexml" id="S5.SS1.p3.1.m1.1.1.cmml" xref="S5.SS1.p3.1.m1.1.1">similar-to</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S5.SS1.p3.1.m1.1c">\sim</annotation></semantics></math>32% global accuracy while requiring <math id="S5.SS1.p3.2.m2.1" class="ltx_Math" alttext="\sim" display="inline"><semantics id="S5.SS1.p3.2.m2.1a"><mo id="S5.SS1.p3.2.m2.1.1" xref="S5.SS1.p3.2.m2.1.1.cmml">∼</mo><annotation-xml encoding="MathML-Content" id="S5.SS1.p3.2.m2.1b"><csymbol cd="latexml" id="S5.SS1.p3.2.m2.1.1.cmml" xref="S5.SS1.p3.2.m2.1.1">similar-to</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S5.SS1.p3.2.m2.1c">\sim</annotation></semantics></math>15% less communication than <span id="S5.SS1.p3.2.2" class="ltx_text ltx_font_typewriter">FedAvg</span>.</p>
</div>
<div id="S5.SS1.p4" class="ltx_para">
<p id="S5.SS1.p4.5" class="ltx_p">Finally, for the Femnist task, which is also the more communication-intensive due to having <math id="S5.SS1.p4.1.m1.1" class="ltx_Math" alttext="\sim" display="inline"><semantics id="S5.SS1.p4.1.m1.1a"><mo id="S5.SS1.p4.1.m1.1.1" xref="S5.SS1.p4.1.m1.1.1.cmml">∼</mo><annotation-xml encoding="MathML-Content" id="S5.SS1.p4.1.m1.1b"><csymbol cd="latexml" id="S5.SS1.p4.1.m1.1.1.cmml" xref="S5.SS1.p4.1.m1.1.1">similar-to</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S5.SS1.p4.1.m1.1c">\sim</annotation></semantics></math>3.5k shards, we see that the <span id="S5.SS1.p4.5.1" class="ltx_text ltx_font_typewriter">FedSparse</span> algorithm improves upon both <span id="S5.SS1.p4.5.2" class="ltx_text ltx_font_typewriter">FedDrop</span> and <span id="S5.SS1.p4.5.3" class="ltx_text ltx_font_typewriter">FedAvg</span>. More specifically, in the medium sparsification setting, it can reach <math id="S5.SS1.p4.2.m2.1" class="ltx_Math" alttext="\sim" display="inline"><semantics id="S5.SS1.p4.2.m2.1a"><mo id="S5.SS1.p4.2.m2.1.1" xref="S5.SS1.p4.2.m2.1.1.cmml">∼</mo><annotation-xml encoding="MathML-Content" id="S5.SS1.p4.2.m2.1b"><csymbol cd="latexml" id="S5.SS1.p4.2.m2.1.1.cmml" xref="S5.SS1.p4.2.m2.1.1">similar-to</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S5.SS1.p4.2.m2.1c">\sim</annotation></semantics></math>85% global accuracy and <math id="S5.SS1.p4.3.m3.1" class="ltx_Math" alttext="\sim" display="inline"><semantics id="S5.SS1.p4.3.m3.1a"><mo id="S5.SS1.p4.3.m3.1.1" xref="S5.SS1.p4.3.m3.1.1.cmml">∼</mo><annotation-xml encoding="MathML-Content" id="S5.SS1.p4.3.m3.1b"><csymbol cd="latexml" id="S5.SS1.p4.3.m3.1.1.cmml" xref="S5.SS1.p4.3.m3.1.1">similar-to</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S5.SS1.p4.3.m3.1c">\sim</annotation></semantics></math>90% local accuracy while requiring <math id="S5.SS1.p4.4.m4.1" class="ltx_Math" alttext="\sim" display="inline"><semantics id="S5.SS1.p4.4.m4.1a"><mo id="S5.SS1.p4.4.m4.1.1" xref="S5.SS1.p4.4.m4.1.1.cmml">∼</mo><annotation-xml encoding="MathML-Content" id="S5.SS1.p4.4.m4.1b"><csymbol cd="latexml" id="S5.SS1.p4.4.m4.1.1.cmml" xref="S5.SS1.p4.4.m4.1.1">similar-to</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S5.SS1.p4.4.m4.1c">\sim</annotation></semantics></math>32% and <math id="S5.SS1.p4.5.m5.1" class="ltx_Math" alttext="\sim" display="inline"><semantics id="S5.SS1.p4.5.m5.1a"><mo id="S5.SS1.p4.5.m5.1.1" xref="S5.SS1.p4.5.m5.1.1.cmml">∼</mo><annotation-xml encoding="MathML-Content" id="S5.SS1.p4.5.m5.1b"><csymbol cd="latexml" id="S5.SS1.p4.5.m5.1.1.cmml" xref="S5.SS1.p4.5.m5.1.1">similar-to</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S5.SS1.p4.5.m5.1c">\sim</annotation></semantics></math>38% less communication compared to <span id="S5.SS1.p4.5.4" class="ltx_text ltx_font_typewriter">FedAvg</span> respectively. Judging by the final accuracy, both <span id="S5.SS1.p4.5.5" class="ltx_text ltx_font_typewriter">FedAvg</span> and <span id="S5.SS1.p4.5.6" class="ltx_text ltx_font_typewriter">FedSparse</span> with the low setting reached similar global and local model performance. This is expected, given that that particular <span id="S5.SS1.p4.5.7" class="ltx_text ltx_font_typewriter">FedSparse</span> setting leads to only 1% sparsity. <span id="S5.SS1.p4.5.8" class="ltx_text ltx_font_typewriter">FedL1</span> did not outperform any of the other methods in terms of the final accuracies.</p>
</div>
</section>
</section>
<section id="S6" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">6 </span>Conclusion</h2>

<div id="S6.p1" class="ltx_para">
<p id="S6.p1.1" class="ltx_p">In this work, we adopted an interpretation of server-orchestrated federated learning as a hierarchical model where the server provides the parameters of a prior distribution over the parameters of client-specific models. We then showed how the <span id="S6.p1.1.1" class="ltx_text ltx_font_typewriter">FedAvg</span> algorithm, the standard in federated learning, corresponds to applying the hard-EM algorithm to a hierarchical model that uses Gaussian priors. Through this perspective, we bridged several recent works on federated learning as well as connect <span id="S6.p1.1.2" class="ltx_text ltx_font_typewriter">FedAvg</span> to meta-learning.
As a straightforward extension stemming from this view, we proposed a hierarchical model with sparsity-inducing priors. By applying hard-EM on this new model, we obtained <span id="S6.p1.1.3" class="ltx_text ltx_font_typewriter">FedSparse</span>, a generalization of <span id="S6.p1.1.4" class="ltx_text ltx_font_typewriter">FedAvg</span> that can learn sparse neural networks in the federated learning setting. Empirically, we showed that <span id="S6.p1.1.5" class="ltx_text ltx_font_typewriter">FedSparse</span> can learn sparse neural networks, which, besides being more efficient, can also significantly reduce the communication costs without decreasing performance - both of which are of great practical importance in “cross-device” federated learning. Of equal practical importance is hyperparameter resilience. In training models with <span id="S6.p1.1.6" class="ltx_text ltx_font_typewriter">FedSparse</span> we observed a high sensitivity to hyperparameters related to initial sparsity thresholds and the necessity to downscale cross-entropy terms as discussed in Appendix <a href="#A1" title="Appendix A Experimental details ‣ An Expectation-Maximization Perspective on Federated Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">A</span></a>. A successful application of <span id="S6.p1.1.7" class="ltx_text ltx_font_typewriter">FedSparse</span> therefore relies on careful tuning and provides ample opportunity for improvement in future work.</p>
</div>
</section>
<section id="bib" class="ltx_bibliography">
<h2 class="ltx_title ltx_title_bibliography">References</h2>

<ul class="ltx_biblist">
<li id="bib.bib1" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[1]</span>
<span class="ltx_bibblock">
Maruan Al-Shedivat, Jennifer Gillenwater, Eric Xing, and Afshin Rostamizadeh.

</span>
<span class="ltx_bibblock">Federated learning via posterior averaging: A new perspective and
practical algorithms.

</span>
<span class="ltx_bibblock"><span id="bib.bib1.1.1" class="ltx_text ltx_font_italic">arXiv preprint arXiv:2010.05273</span>, 2020.

</span>
</li>
<li id="bib.bib2" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[2]</span>
<span class="ltx_bibblock">
Mohammad Mohammadi Amiri, Deniz Gunduz, Sanjeev R Kulkarni, and H Vincent Poor.

</span>
<span class="ltx_bibblock">Federated learning with quantized global model updates.

</span>
<span class="ltx_bibblock"><span id="bib.bib2.1.1" class="ltx_text ltx_font_italic">arXiv preprint arXiv:2006.10672</span>, 2020.

</span>
</li>
<li id="bib.bib3" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[3]</span>
<span class="ltx_bibblock">
Kambiz Azarian, Yash Bhalgat, Jinwon Lee, and Tijmen Blankevoort.

</span>
<span class="ltx_bibblock">Learned threshold pruning.

</span>
<span class="ltx_bibblock"><span id="bib.bib3.1.1" class="ltx_text ltx_font_italic">arXiv preprint arXiv:2003.00075</span>, 2020.

</span>
</li>
<li id="bib.bib4" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[4]</span>
<span class="ltx_bibblock">
Jeremy Bernstein, Yu-Xiang Wang, Kamyar Azizzadenesheli, and Anima Anandkumar.

</span>
<span class="ltx_bibblock">signsgd: Compressed optimisation for non-convex problems.

</span>
<span class="ltx_bibblock"><span id="bib.bib4.1.1" class="ltx_text ltx_font_italic">arXiv preprint arXiv:1802.04434</span>, 2018.

</span>
</li>
<li id="bib.bib5" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[5]</span>
<span class="ltx_bibblock">
Sebastian Caldas, Jakub Konečny, H Brendan McMahan, and Ameet Talwalkar.

</span>
<span class="ltx_bibblock">Expanding the reach of federated learning by reducing client resource
requirements.

</span>
<span class="ltx_bibblock"><span id="bib.bib5.1.1" class="ltx_text ltx_font_italic">arXiv preprint arXiv:1812.07210</span>, 2018.

</span>
</li>
<li id="bib.bib6" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[6]</span>
<span class="ltx_bibblock">
Yutian Chen, Abram L Friesen, Feryal Behbahani, David Budden, Matthew W
Hoffman, Arnaud Doucet, and Nando de Freitas.

</span>
<span class="ltx_bibblock">Modular meta-learning with shrinkage.

</span>
<span class="ltx_bibblock"><span id="bib.bib6.1.1" class="ltx_text ltx_font_italic">arXiv preprint arXiv:1909.05557</span>, 2019.

</span>
</li>
<li id="bib.bib7" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[7]</span>
<span class="ltx_bibblock">
Luca Corinzia, Ami Beuret, and Joachim M Buhmann.

</span>
<span class="ltx_bibblock">Variational federated multi-task learning.

</span>
<span class="ltx_bibblock"><span id="bib.bib7.1.1" class="ltx_text ltx_font_italic">arXiv preprint arXiv:1906.06268</span>, 2019.

</span>
</li>
<li id="bib.bib8" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[8]</span>
<span class="ltx_bibblock">
Alireza Fallah, Aryan Mokhtari, and Asuman Ozdaglar.

</span>
<span class="ltx_bibblock">Personalized federated learning: A meta-learning approach.

</span>
<span class="ltx_bibblock"><span id="bib.bib8.1.1" class="ltx_text ltx_font_italic">arXiv preprint arXiv:2002.07948</span>, 2020.

</span>
</li>
<li id="bib.bib9" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[9]</span>
<span class="ltx_bibblock">
Trevor Gale, Erich Elsen, and Sara Hooker.

</span>
<span class="ltx_bibblock">The state of sparsity in deep neural networks.

</span>
<span class="ltx_bibblock"><span id="bib.bib9.1.1" class="ltx_text ltx_font_italic">arXiv preprint arXiv:1902.09574</span>, 2019.

</span>
</li>
<li id="bib.bib10" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[10]</span>
<span class="ltx_bibblock">
Erin Grant, Chelsea Finn, Sergey Levine, Trevor Darrell, and Thomas Griffiths.

</span>
<span class="ltx_bibblock">Recasting gradient-based meta-learning as hierarchical bayes.

</span>
<span class="ltx_bibblock"><span id="bib.bib10.1.1" class="ltx_text ltx_font_italic">arXiv preprint arXiv:1801.08930</span>, 2018.

</span>
</li>
<li id="bib.bib11" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[11]</span>
<span class="ltx_bibblock">
Pengchao Han, Shiqiang Wang, and Kin K Leung.

</span>
<span class="ltx_bibblock">Adaptive gradient sparsification for efficient federated learning: An
online learning approach.

</span>
<span class="ltx_bibblock"><span id="bib.bib11.1.1" class="ltx_text ltx_font_italic">arXiv preprint arXiv:2001.04756</span>, 2020.

</span>
</li>
<li id="bib.bib12" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[12]</span>
<span class="ltx_bibblock">
Tzu-Ming Harry Hsu, Hang Qi, and Matthew Brown.

</span>
<span class="ltx_bibblock">Measuring the effects of non-identical data distribution for
federated visual classification.

</span>
<span class="ltx_bibblock"><span id="bib.bib12.1.1" class="ltx_text ltx_font_italic">arXiv preprint arXiv:1909.06335</span>, 2019.

</span>
</li>
<li id="bib.bib13" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[13]</span>
<span class="ltx_bibblock">
Yihan Jiang, Jakub Konečnỳ, Keith Rush, and Sreeram Kannan.

</span>
<span class="ltx_bibblock">Improving federated learning personalization via model agnostic meta
learning.

</span>
<span class="ltx_bibblock"><span id="bib.bib13.1.1" class="ltx_text ltx_font_italic">arXiv preprint arXiv:1909.12488</span>, 2019.

</span>
</li>
<li id="bib.bib14" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[14]</span>
<span class="ltx_bibblock">
Peter Kairouz, H Brendan McMahan, Brendan Avent, Aurélien Bellet, Mehdi
Bennis, Arjun Nitin Bhagoji, Keith Bonawitz, Zachary Charles, Graham Cormode,
Rachel Cummings, et al.

</span>
<span class="ltx_bibblock">Advances and open problems in federated learning.

</span>
<span class="ltx_bibblock"><span id="bib.bib14.1.1" class="ltx_text ltx_font_italic">arXiv preprint arXiv:1912.04977</span>, 2019.

</span>
</li>
<li id="bib.bib15" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[15]</span>
<span class="ltx_bibblock">
Sai Praneeth Karimireddy, Satyen Kale, Mehryar Mohri, Sashank Reddi, Sebastian
Stich, and Ananda Theertha Suresh.

</span>
<span class="ltx_bibblock">Scaffold: Stochastic controlled averaging for federated learning.

</span>
<span class="ltx_bibblock">In <span id="bib.bib15.1.1" class="ltx_text ltx_font_italic">International Conference on Machine Learning</span>, pages
5132–5143. PMLR, 2020.

</span>
</li>
<li id="bib.bib16" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[16]</span>
<span class="ltx_bibblock">
Diederik P Kingma and Jimmy Ba.

</span>
<span class="ltx_bibblock">Adam: A method for stochastic optimization.

</span>
<span class="ltx_bibblock"><span id="bib.bib16.1.1" class="ltx_text ltx_font_italic">arXiv preprint arXiv:1412.6980</span>, 2014.

</span>
</li>
<li id="bib.bib17" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[17]</span>
<span class="ltx_bibblock">
Yann LeCun, Léon Bottou, Yoshua Bengio, and Patrick Haffner.

</span>
<span class="ltx_bibblock">Gradient-based learning applied to document recognition.

</span>
<span class="ltx_bibblock"><span id="bib.bib17.1.1" class="ltx_text ltx_font_italic">Proceedings of the IEEE</span>, 86(11):2278–2324, 1998.

</span>
</li>
<li id="bib.bib18" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[18]</span>
<span class="ltx_bibblock">
Tian Li, Anit Kumar Sahu, Manzil Zaheer, Maziar Sanjabi, Ameet Talwalkar, and
Virginia Smith.

</span>
<span class="ltx_bibblock">Federated optimization in heterogeneous networks.

</span>
<span class="ltx_bibblock"><span id="bib.bib18.1.1" class="ltx_text ltx_font_italic">arXiv preprint arXiv:1812.06127</span>, 2018.

</span>
</li>
<li id="bib.bib19" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[19]</span>
<span class="ltx_bibblock">
Zhize Li, Hongyan Bao, Xiangliang Zhang, and Peter Richtárik.

</span>
<span class="ltx_bibblock">Page: A simple and optimal probabilistic gradient estimator for
nonconvex optimization.

</span>
<span class="ltx_bibblock"><span id="bib.bib19.1.1" class="ltx_text ltx_font_italic">arXiv preprint arXiv:2008.10898</span>, 2020.

</span>
</li>
<li id="bib.bib20" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[20]</span>
<span class="ltx_bibblock">
Yujun Lin, Song Han, Huizi Mao, Yu Wang, and William J Dally.

</span>
<span class="ltx_bibblock">Deep gradient compression: Reducing the communication bandwidth for
distributed training.

</span>
<span class="ltx_bibblock"><span id="bib.bib20.1.1" class="ltx_text ltx_font_italic">arXiv preprint arXiv:1712.01887</span>, 2017.

</span>
</li>
<li id="bib.bib21" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[21]</span>
<span class="ltx_bibblock">
Christos Louizos, Max Welling, and Diederik P Kingma.

</span>
<span class="ltx_bibblock">Learning sparse neural networks through <math id="bib.bib21.1.m1.1" class="ltx_Math" alttext="l\_0" display="inline"><semantics id="bib.bib21.1.m1.1a"><mrow id="bib.bib21.1.m1.1.1" xref="bib.bib21.1.m1.1.1.cmml"><mi id="bib.bib21.1.m1.1.1.2" xref="bib.bib21.1.m1.1.1.2.cmml">l</mi><mo lspace="0em" rspace="0em" id="bib.bib21.1.m1.1.1.1" xref="bib.bib21.1.m1.1.1.1.cmml">​</mo><mi mathvariant="normal" id="bib.bib21.1.m1.1.1.3" xref="bib.bib21.1.m1.1.1.3.cmml">_</mi><mo lspace="0em" rspace="0em" id="bib.bib21.1.m1.1.1.1a" xref="bib.bib21.1.m1.1.1.1.cmml">​</mo><mn id="bib.bib21.1.m1.1.1.4" xref="bib.bib21.1.m1.1.1.4.cmml">0</mn></mrow><annotation-xml encoding="MathML-Content" id="bib.bib21.1.m1.1b"><apply id="bib.bib21.1.m1.1.1.cmml" xref="bib.bib21.1.m1.1.1"><times id="bib.bib21.1.m1.1.1.1.cmml" xref="bib.bib21.1.m1.1.1.1"></times><ci id="bib.bib21.1.m1.1.1.2.cmml" xref="bib.bib21.1.m1.1.1.2">𝑙</ci><ci id="bib.bib21.1.m1.1.1.3.cmml" xref="bib.bib21.1.m1.1.1.3">_</ci><cn type="integer" id="bib.bib21.1.m1.1.1.4.cmml" xref="bib.bib21.1.m1.1.1.4">0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="bib.bib21.1.m1.1c">l\_0</annotation></semantics></math> regularization.

</span>
<span class="ltx_bibblock"><span id="bib.bib21.2.1" class="ltx_text ltx_font_italic">arXiv preprint arXiv:1712.01312</span>, 2017.

</span>
</li>
<li id="bib.bib22" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[22]</span>
<span class="ltx_bibblock">
H Brendan McMahan, Eider Moore, Daniel Ramage, Seth Hampson, et al.

</span>
<span class="ltx_bibblock">Communication-efficient learning of deep networks from decentralized
data.

</span>
<span class="ltx_bibblock"><span id="bib.bib22.1.1" class="ltx_text ltx_font_italic">arXiv preprint arXiv:1602.05629</span>, 2016.

</span>
</li>
<li id="bib.bib23" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[23]</span>
<span class="ltx_bibblock">
Toby J Mitchell and John J Beauchamp.

</span>
<span class="ltx_bibblock">Bayesian variable selection in linear regression.

</span>
<span class="ltx_bibblock"><span id="bib.bib23.1.1" class="ltx_text ltx_font_italic">Journal of the american statistical association</span>,
83(404):1023–1032, 1988.

</span>
</li>
<li id="bib.bib24" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[24]</span>
<span class="ltx_bibblock">
Radford M Neal and Geoffrey E Hinton.

</span>
<span class="ltx_bibblock">A view of the em algorithm that justifies incremental, sparse, and
other variants.

</span>
<span class="ltx_bibblock">In <span id="bib.bib24.1.1" class="ltx_text ltx_font_italic">Learning in graphical models</span>, pages 355–368. Springer,
1998.

</span>
</li>
<li id="bib.bib25" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[25]</span>
<span class="ltx_bibblock">
Alex Nichol, Joshua Achiam, and John Schulman.

</span>
<span class="ltx_bibblock">On first-order meta-learning algorithms.

</span>
<span class="ltx_bibblock"><span id="bib.bib25.1.1" class="ltx_text ltx_font_italic">arXiv preprint arXiv:1803.02999</span>, 2018.

</span>
</li>
<li id="bib.bib26" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[26]</span>
<span class="ltx_bibblock">
Adam Paszke, Sam Gross, Francisco Massa, Adam Lerer, James Bradbury, Gregory
Chanan, Trevor Killeen, Zeming Lin, Natalia Gimelshein, Luca Antiga, Alban
Desmaison, Andreas Kopf, Edward Yang, Zachary DeVito, Martin Raison, Alykhan
Tejani, Sasank Chilamkurthy, Benoit Steiner, Lu Fang, Junjie Bai, and Soumith
Chintala.

</span>
<span class="ltx_bibblock">Pytorch: An imperative style, high-performance deep learning library.

</span>
<span class="ltx_bibblock">In H. Wallach, H. Larochelle, A. Beygelzimer, F. d'Alché-Buc, E. Fox, and R. Garnett, editors, <span id="bib.bib26.1.1" class="ltx_text ltx_font_italic">Advances in Neural
Information Processing Systems 32</span>, pages 8024–8035. Curran Associates,
Inc., 2019.

</span>
</li>
<li id="bib.bib27" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[27]</span>
<span class="ltx_bibblock">
Fabrizio Pittorino, Carlo Lucibello, Christoph Feinauer, Enrico M Malatesta,
Gabriele Perugini, Carlo Baldassi, Matteo Negri, Elizaveta Demyanenko, and
Riccardo Zecchina.

</span>
<span class="ltx_bibblock">Entropic gradient descent algorithms and wide flat minima.

</span>
<span class="ltx_bibblock"><span id="bib.bib27.1.1" class="ltx_text ltx_font_italic">arXiv preprint arXiv:2006.07897</span>, 2020.

</span>
</li>
<li id="bib.bib28" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[28]</span>
<span class="ltx_bibblock">
Sashank Reddi, Zachary Charles, Manzil Zaheer, Zachary Garrett, Keith Rush,
Jakub Konečnỳ, Sanjiv Kumar, and H Brendan McMahan.

</span>
<span class="ltx_bibblock">Adaptive federated optimization.

</span>
<span class="ltx_bibblock"><span id="bib.bib28.1.1" class="ltx_text ltx_font_italic">arXiv preprint arXiv:2003.00295</span>, 2020.

</span>
</li>
<li id="bib.bib29" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[29]</span>
<span class="ltx_bibblock">
Reginaldo J Santos.

</span>
<span class="ltx_bibblock">Equivalence of regularization and truncated iteration for general
ill-posed problems.

</span>
<span class="ltx_bibblock"><span id="bib.bib29.1.1" class="ltx_text ltx_font_italic">Linear algebra and its applications</span>, 236:25–33, 1996.

</span>
</li>
<li id="bib.bib30" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[30]</span>
<span class="ltx_bibblock">
Felix Sattler, Simon Wiedemann, Klaus-Robert Müller, and Wojciech Samek.

</span>
<span class="ltx_bibblock">Robust and communication-efficient federated learning from non-iid
data.

</span>
<span class="ltx_bibblock"><span id="bib.bib30.1.1" class="ltx_text ltx_font_italic">IEEE transactions on neural networks and learning systems</span>,
2019.

</span>
</li>
<li id="bib.bib31" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[31]</span>
<span class="ltx_bibblock">
Jianqiao Wangni, Jialei Wang, Ji Liu, and Tong Zhang.

</span>
<span class="ltx_bibblock">Gradient sparsification for communication-efficient distributed
optimization.

</span>
<span class="ltx_bibblock">In <span id="bib.bib31.1.1" class="ltx_text ltx_font_italic">Advances in Neural Information Processing Systems</span>, pages
1299–1309, 2018.

</span>
</li>
<li id="bib.bib32" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[32]</span>
<span class="ltx_bibblock">
Wei Wen, Chunpeng Wu, Yandan Wang, Yiran Chen, and Hai Li.

</span>
<span class="ltx_bibblock">Learning structured sparsity in deep neural networks.

</span>
<span class="ltx_bibblock"><span id="bib.bib32.1.1" class="ltx_text ltx_font_italic">arXiv preprint arXiv:1608.03665</span>, 2016.

</span>
</li>
<li id="bib.bib33" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[33]</span>
<span class="ltx_bibblock">
Yue Yu, Jiaxiang Wu, and Longbo Huang.

</span>
<span class="ltx_bibblock">Double quantization for communication-efficient distributed
optimization.

</span>
<span class="ltx_bibblock">In <span id="bib.bib33.1.1" class="ltx_text ltx_font_italic">Advances in Neural Information Processing Systems</span>, pages
4438–4449, 2019.

</span>
</li>
<li id="bib.bib34" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[34]</span>
<span class="ltx_bibblock">
Mikhail Yurochkin, Mayank Agarwal, Soumya Ghosh, Kristjan Greenewald, Nghia
Hoang, and Yasaman Khazaeni.

</span>
<span class="ltx_bibblock">Bayesian nonparametric federated learning of neural networks.

</span>
<span class="ltx_bibblock">In <span id="bib.bib34.1.1" class="ltx_text ltx_font_italic">International Conference on Machine Learning</span>, pages
7252–7261. PMLR, 2019.

</span>
</li>
<li id="bib.bib35" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[35]</span>
<span class="ltx_bibblock">
Mikhail Yurochkin, Mayank Agarwal, Soumya Ghosh, Kristjan Greenewald, and
Trong Nghia Hoang.

</span>
<span class="ltx_bibblock">Statistical model aggregation via parameter matching.

</span>
<span class="ltx_bibblock"><span id="bib.bib35.1.1" class="ltx_text ltx_font_italic">arXiv preprint arXiv:1911.00218</span>, 2019.

</span>
</li>
<li id="bib.bib36" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[36]</span>
<span class="ltx_bibblock">
Michael Zhang, James Lucas, Jimmy Ba, and Geoffrey E Hinton.

</span>
<span class="ltx_bibblock">Lookahead optimizer: k steps forward, 1 step back.

</span>
<span class="ltx_bibblock">In <span id="bib.bib36.1.1" class="ltx_text ltx_font_italic">Advances in Neural Information Processing Systems</span>, pages
9597–9608, 2019.

</span>
</li>
</ul>
</section>
<section id="A1" class="ltx_appendix">
<h2 class="ltx_title ltx_title_appendix">
<span class="ltx_tag ltx_tag_appendix">Appendix A </span>Experimental details</h2>

<div id="A1.p1" class="ltx_para">
<p id="A1.p1.3" class="ltx_p">For all of the three tasks we randomly select 10 clients without replacement in a given round but with replacement across rounds. For the local optimizer of the weights we use stochastic gradient descent with a learning rate of 0.05, whereas for the global optimizer we use Adam <span id="A1.p1.3.1" class="ltx_ERROR undefined">\citepappendix</span>kingma2014adam with the default hyperparameters provided in <span id="A1.p1.3.2" class="ltx_ERROR undefined">\citepappendix</span>kingma2014adam. For the pruning thresholds in <span id="A1.p1.3.3" class="ltx_text ltx_font_typewriter">FedSparse</span> we used the Adamax <span id="A1.p1.3.4" class="ltx_ERROR undefined">\citepappendix</span>kingma2014adam optimizer with <math id="A1.p1.1.m1.1" class="ltx_Math" alttext="1e-3" display="inline"><semantics id="A1.p1.1.m1.1a"><mrow id="A1.p1.1.m1.1.1" xref="A1.p1.1.m1.1.1.cmml"><mrow id="A1.p1.1.m1.1.1.2" xref="A1.p1.1.m1.1.1.2.cmml"><mn id="A1.p1.1.m1.1.1.2.2" xref="A1.p1.1.m1.1.1.2.2.cmml">1</mn><mo lspace="0em" rspace="0em" id="A1.p1.1.m1.1.1.2.1" xref="A1.p1.1.m1.1.1.2.1.cmml">​</mo><mi id="A1.p1.1.m1.1.1.2.3" xref="A1.p1.1.m1.1.1.2.3.cmml">e</mi></mrow><mo id="A1.p1.1.m1.1.1.1" xref="A1.p1.1.m1.1.1.1.cmml">−</mo><mn id="A1.p1.1.m1.1.1.3" xref="A1.p1.1.m1.1.1.3.cmml">3</mn></mrow><annotation-xml encoding="MathML-Content" id="A1.p1.1.m1.1b"><apply id="A1.p1.1.m1.1.1.cmml" xref="A1.p1.1.m1.1.1"><minus id="A1.p1.1.m1.1.1.1.cmml" xref="A1.p1.1.m1.1.1.1"></minus><apply id="A1.p1.1.m1.1.1.2.cmml" xref="A1.p1.1.m1.1.1.2"><times id="A1.p1.1.m1.1.1.2.1.cmml" xref="A1.p1.1.m1.1.1.2.1"></times><cn type="integer" id="A1.p1.1.m1.1.1.2.2.cmml" xref="A1.p1.1.m1.1.1.2.2">1</cn><ci id="A1.p1.1.m1.1.1.2.3.cmml" xref="A1.p1.1.m1.1.1.2.3">𝑒</ci></apply><cn type="integer" id="A1.p1.1.m1.1.1.3.cmml" xref="A1.p1.1.m1.1.1.3">3</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.p1.1.m1.1c">1e-3</annotation></semantics></math> learning rate at the shard level and the Adamax optimizer with <math id="A1.p1.2.m2.1" class="ltx_Math" alttext="1e-2" display="inline"><semantics id="A1.p1.2.m2.1a"><mrow id="A1.p1.2.m2.1.1" xref="A1.p1.2.m2.1.1.cmml"><mrow id="A1.p1.2.m2.1.1.2" xref="A1.p1.2.m2.1.1.2.cmml"><mn id="A1.p1.2.m2.1.1.2.2" xref="A1.p1.2.m2.1.1.2.2.cmml">1</mn><mo lspace="0em" rspace="0em" id="A1.p1.2.m2.1.1.2.1" xref="A1.p1.2.m2.1.1.2.1.cmml">​</mo><mi id="A1.p1.2.m2.1.1.2.3" xref="A1.p1.2.m2.1.1.2.3.cmml">e</mi></mrow><mo id="A1.p1.2.m2.1.1.1" xref="A1.p1.2.m2.1.1.1.cmml">−</mo><mn id="A1.p1.2.m2.1.1.3" xref="A1.p1.2.m2.1.1.3.cmml">2</mn></mrow><annotation-xml encoding="MathML-Content" id="A1.p1.2.m2.1b"><apply id="A1.p1.2.m2.1.1.cmml" xref="A1.p1.2.m2.1.1"><minus id="A1.p1.2.m2.1.1.1.cmml" xref="A1.p1.2.m2.1.1.1"></minus><apply id="A1.p1.2.m2.1.1.2.cmml" xref="A1.p1.2.m2.1.1.2"><times id="A1.p1.2.m2.1.1.2.1.cmml" xref="A1.p1.2.m2.1.1.2.1"></times><cn type="integer" id="A1.p1.2.m2.1.1.2.2.cmml" xref="A1.p1.2.m2.1.1.2.2">1</cn><ci id="A1.p1.2.m2.1.1.2.3.cmml" xref="A1.p1.2.m2.1.1.2.3">𝑒</ci></apply><cn type="integer" id="A1.p1.2.m2.1.1.3.cmml" xref="A1.p1.2.m2.1.1.3">2</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.p1.2.m2.1c">1e-2</annotation></semantics></math> learning rate at the server. For all three of the tasks we used <math id="A1.p1.3.m3.1" class="ltx_Math" alttext="E=1" display="inline"><semantics id="A1.p1.3.m3.1a"><mrow id="A1.p1.3.m3.1.1" xref="A1.p1.3.m3.1.1.cmml"><mi id="A1.p1.3.m3.1.1.2" xref="A1.p1.3.m3.1.1.2.cmml">E</mi><mo id="A1.p1.3.m3.1.1.1" xref="A1.p1.3.m3.1.1.1.cmml">=</mo><mn id="A1.p1.3.m3.1.1.3" xref="A1.p1.3.m3.1.1.3.cmml">1</mn></mrow><annotation-xml encoding="MathML-Content" id="A1.p1.3.m3.1b"><apply id="A1.p1.3.m3.1.1.cmml" xref="A1.p1.3.m3.1.1"><eq id="A1.p1.3.m3.1.1.1.cmml" xref="A1.p1.3.m3.1.1.1"></eq><ci id="A1.p1.3.m3.1.1.2.cmml" xref="A1.p1.3.m3.1.1.2">𝐸</ci><cn type="integer" id="A1.p1.3.m3.1.1.3.cmml" xref="A1.p1.3.m3.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.p1.3.m3.1c">E=1</annotation></semantics></math> with a batch size of 64 for CIFAR10 and 20 for CIFAR100 and Femnist. It should be noted that for all the methods we performed gradient based optimization using the difference gradient for the weights <span id="A1.p1.3.5" class="ltx_ERROR undefined">\citepappendix</span>reddi2020adaptive instead of averaging.</p>
</div>
<div id="A1.p2" class="ltx_para">
<p id="A1.p2.2" class="ltx_p">For the <span id="A1.p2.2.1" class="ltx_text ltx_font_typewriter">FedDrop</span> baseline, we used a very small dropout rate of 0.01 for the input and output layer and tuned the dropout rates for convolutional and fully connected layers separately in order to optimize the accuracy / communication tradeoff. For convolutional layers we considered rates in <math id="A1.p2.1.m1.3" class="ltx_Math" alttext="\{0.1,0.2,0.3\}" display="inline"><semantics id="A1.p2.1.m1.3a"><mrow id="A1.p2.1.m1.3.4.2" xref="A1.p2.1.m1.3.4.1.cmml"><mo stretchy="false" id="A1.p2.1.m1.3.4.2.1" xref="A1.p2.1.m1.3.4.1.cmml">{</mo><mn id="A1.p2.1.m1.1.1" xref="A1.p2.1.m1.1.1.cmml">0.1</mn><mo id="A1.p2.1.m1.3.4.2.2" xref="A1.p2.1.m1.3.4.1.cmml">,</mo><mn id="A1.p2.1.m1.2.2" xref="A1.p2.1.m1.2.2.cmml">0.2</mn><mo id="A1.p2.1.m1.3.4.2.3" xref="A1.p2.1.m1.3.4.1.cmml">,</mo><mn id="A1.p2.1.m1.3.3" xref="A1.p2.1.m1.3.3.cmml">0.3</mn><mo stretchy="false" id="A1.p2.1.m1.3.4.2.4" xref="A1.p2.1.m1.3.4.1.cmml">}</mo></mrow><annotation-xml encoding="MathML-Content" id="A1.p2.1.m1.3b"><set id="A1.p2.1.m1.3.4.1.cmml" xref="A1.p2.1.m1.3.4.2"><cn type="float" id="A1.p2.1.m1.1.1.cmml" xref="A1.p2.1.m1.1.1">0.1</cn><cn type="float" id="A1.p2.1.m1.2.2.cmml" xref="A1.p2.1.m1.2.2">0.2</cn><cn type="float" id="A1.p2.1.m1.3.3.cmml" xref="A1.p2.1.m1.3.3">0.3</cn></set></annotation-xml><annotation encoding="application/x-tex" id="A1.p2.1.m1.3c">\{0.1,0.2,0.3\}</annotation></semantics></math> whereas for the fully connected layers we considered rates in <math id="A1.p2.2.m2.5" class="ltx_Math" alttext="\{0.1,0.2,0.3,0.4,0.5\}" display="inline"><semantics id="A1.p2.2.m2.5a"><mrow id="A1.p2.2.m2.5.6.2" xref="A1.p2.2.m2.5.6.1.cmml"><mo stretchy="false" id="A1.p2.2.m2.5.6.2.1" xref="A1.p2.2.m2.5.6.1.cmml">{</mo><mn id="A1.p2.2.m2.1.1" xref="A1.p2.2.m2.1.1.cmml">0.1</mn><mo id="A1.p2.2.m2.5.6.2.2" xref="A1.p2.2.m2.5.6.1.cmml">,</mo><mn id="A1.p2.2.m2.2.2" xref="A1.p2.2.m2.2.2.cmml">0.2</mn><mo id="A1.p2.2.m2.5.6.2.3" xref="A1.p2.2.m2.5.6.1.cmml">,</mo><mn id="A1.p2.2.m2.3.3" xref="A1.p2.2.m2.3.3.cmml">0.3</mn><mo id="A1.p2.2.m2.5.6.2.4" xref="A1.p2.2.m2.5.6.1.cmml">,</mo><mn id="A1.p2.2.m2.4.4" xref="A1.p2.2.m2.4.4.cmml">0.4</mn><mo id="A1.p2.2.m2.5.6.2.5" xref="A1.p2.2.m2.5.6.1.cmml">,</mo><mn id="A1.p2.2.m2.5.5" xref="A1.p2.2.m2.5.5.cmml">0.5</mn><mo stretchy="false" id="A1.p2.2.m2.5.6.2.6" xref="A1.p2.2.m2.5.6.1.cmml">}</mo></mrow><annotation-xml encoding="MathML-Content" id="A1.p2.2.m2.5b"><set id="A1.p2.2.m2.5.6.1.cmml" xref="A1.p2.2.m2.5.6.2"><cn type="float" id="A1.p2.2.m2.1.1.cmml" xref="A1.p2.2.m2.1.1">0.1</cn><cn type="float" id="A1.p2.2.m2.2.2.cmml" xref="A1.p2.2.m2.2.2">0.2</cn><cn type="float" id="A1.p2.2.m2.3.3.cmml" xref="A1.p2.2.m2.3.3">0.3</cn><cn type="float" id="A1.p2.2.m2.4.4.cmml" xref="A1.p2.2.m2.4.4">0.4</cn><cn type="float" id="A1.p2.2.m2.5.5.cmml" xref="A1.p2.2.m2.5.5">0.5</cn></set></annotation-xml><annotation encoding="application/x-tex" id="A1.p2.2.m2.5c">\{0.1,0.2,0.3,0.4,0.5\}</annotation></semantics></math>. For CIFAR10 we did not employ the additional dropout noise at the shard level, since we found that it was detrimental for the <span id="A1.p2.2.2" class="ltx_text ltx_font_typewriter">FedDrop</span> performance. Furthermore, for Resnet20 on CIFAR100 we did not apply federated dropout at the output layer. For CIFAR10 the best performing dropout rates were 0.1 for the convolutional and 0.5 for the fully connected, whereas for CIFAR100 it was 0.1 for the convolutional. For Femnist, we saw that a rate of 0.2 for the convolutional and a rate of 0.4 for the fully connected performed better.</p>
</div>
<div id="A1.p3" class="ltx_para">
<p id="A1.p3.16" class="ltx_p">For <span id="A1.p3.16.1" class="ltx_text ltx_font_typewriter">FedSparse</span>, we initialized <math id="A1.p3.1.m1.1" class="ltx_Math" alttext="\mathbf{v}" display="inline"><semantics id="A1.p3.1.m1.1a"><mi id="A1.p3.1.m1.1.1" xref="A1.p3.1.m1.1.1.cmml">𝐯</mi><annotation-xml encoding="MathML-Content" id="A1.p3.1.m1.1b"><ci id="A1.p3.1.m1.1.1.cmml" xref="A1.p3.1.m1.1.1">𝐯</ci></annotation-xml><annotation encoding="application/x-tex" id="A1.p3.1.m1.1c">\mathbf{v}</annotation></semantics></math> such that the thresholds <math id="A1.p3.2.m2.1" class="ltx_Math" alttext="\bm{\tau}" display="inline"><semantics id="A1.p3.2.m2.1a"><mi id="A1.p3.2.m2.1.1" xref="A1.p3.2.m2.1.1.cmml">𝝉</mi><annotation-xml encoding="MathML-Content" id="A1.p3.2.m2.1b"><ci id="A1.p3.2.m2.1.1.cmml" xref="A1.p3.2.m2.1.1">𝝉</ci></annotation-xml><annotation encoding="application/x-tex" id="A1.p3.2.m2.1c">\bm{\tau}</annotation></semantics></math> lead to <math id="A1.p3.3.m3.1" class="ltx_Math" alttext="\bm{\theta}=0.99" display="inline"><semantics id="A1.p3.3.m3.1a"><mrow id="A1.p3.3.m3.1.1" xref="A1.p3.3.m3.1.1.cmml"><mi id="A1.p3.3.m3.1.1.2" xref="A1.p3.3.m3.1.1.2.cmml">𝜽</mi><mo id="A1.p3.3.m3.1.1.1" xref="A1.p3.3.m3.1.1.1.cmml">=</mo><mn id="A1.p3.3.m3.1.1.3" xref="A1.p3.3.m3.1.1.3.cmml">0.99</mn></mrow><annotation-xml encoding="MathML-Content" id="A1.p3.3.m3.1b"><apply id="A1.p3.3.m3.1.1.cmml" xref="A1.p3.3.m3.1.1"><eq id="A1.p3.3.m3.1.1.1.cmml" xref="A1.p3.3.m3.1.1.1"></eq><ci id="A1.p3.3.m3.1.1.2.cmml" xref="A1.p3.3.m3.1.1.2">𝜽</ci><cn type="float" id="A1.p3.3.m3.1.1.3.cmml" xref="A1.p3.3.m3.1.1.3">0.99</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.p3.3.m3.1c">\bm{\theta}=0.99</annotation></semantics></math> initially, <em id="A1.p3.16.2" class="ltx_emph ltx_font_italic">i.e.</em> we started from a dense model. The temperature for the sigmoid in the parameterization of the probabilities was set to <math id="A1.p3.4.m4.1" class="ltx_Math" alttext="T=0.001" display="inline"><semantics id="A1.p3.4.m4.1a"><mrow id="A1.p3.4.m4.1.1" xref="A1.p3.4.m4.1.1.cmml"><mi id="A1.p3.4.m4.1.1.2" xref="A1.p3.4.m4.1.1.2.cmml">T</mi><mo id="A1.p3.4.m4.1.1.1" xref="A1.p3.4.m4.1.1.1.cmml">=</mo><mn id="A1.p3.4.m4.1.1.3" xref="A1.p3.4.m4.1.1.3.cmml">0.001</mn></mrow><annotation-xml encoding="MathML-Content" id="A1.p3.4.m4.1b"><apply id="A1.p3.4.m4.1.1.cmml" xref="A1.p3.4.m4.1.1"><eq id="A1.p3.4.m4.1.1.1.cmml" xref="A1.p3.4.m4.1.1.1"></eq><ci id="A1.p3.4.m4.1.1.2.cmml" xref="A1.p3.4.m4.1.1.2">𝑇</ci><cn type="float" id="A1.p3.4.m4.1.1.3.cmml" xref="A1.p3.4.m4.1.1.3">0.001</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.p3.4.m4.1c">T=0.001</annotation></semantics></math>. Furthermore, we downscaled the cross-entropy term between the client side probabilities, <math id="A1.p3.5.m5.1" class="ltx_Math" alttext="\bm{\pi}_{s}" display="inline"><semantics id="A1.p3.5.m5.1a"><msub id="A1.p3.5.m5.1.1" xref="A1.p3.5.m5.1.1.cmml"><mi id="A1.p3.5.m5.1.1.2" xref="A1.p3.5.m5.1.1.2.cmml">𝝅</mi><mi id="A1.p3.5.m5.1.1.3" xref="A1.p3.5.m5.1.1.3.cmml">s</mi></msub><annotation-xml encoding="MathML-Content" id="A1.p3.5.m5.1b"><apply id="A1.p3.5.m5.1.1.cmml" xref="A1.p3.5.m5.1.1"><csymbol cd="ambiguous" id="A1.p3.5.m5.1.1.1.cmml" xref="A1.p3.5.m5.1.1">subscript</csymbol><ci id="A1.p3.5.m5.1.1.2.cmml" xref="A1.p3.5.m5.1.1.2">𝝅</ci><ci id="A1.p3.5.m5.1.1.3.cmml" xref="A1.p3.5.m5.1.1.3">𝑠</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.p3.5.m5.1c">\bm{\pi}_{s}</annotation></semantics></math>, and the server side probabilities, <math id="A1.p3.6.m6.1" class="ltx_Math" alttext="\bm{\theta}" display="inline"><semantics id="A1.p3.6.m6.1a"><mi id="A1.p3.6.m6.1.1" xref="A1.p3.6.m6.1.1.cmml">𝜽</mi><annotation-xml encoding="MathML-Content" id="A1.p3.6.m6.1b"><ci id="A1.p3.6.m6.1.1.cmml" xref="A1.p3.6.m6.1.1">𝜽</ci></annotation-xml><annotation encoding="application/x-tex" id="A1.p3.6.m6.1c">\bm{\theta}</annotation></semantics></math> by mutltiplying it with <math id="A1.p3.7.m7.1" class="ltx_Math" alttext="1e-4" display="inline"><semantics id="A1.p3.7.m7.1a"><mrow id="A1.p3.7.m7.1.1" xref="A1.p3.7.m7.1.1.cmml"><mrow id="A1.p3.7.m7.1.1.2" xref="A1.p3.7.m7.1.1.2.cmml"><mn id="A1.p3.7.m7.1.1.2.2" xref="A1.p3.7.m7.1.1.2.2.cmml">1</mn><mo lspace="0em" rspace="0em" id="A1.p3.7.m7.1.1.2.1" xref="A1.p3.7.m7.1.1.2.1.cmml">​</mo><mi id="A1.p3.7.m7.1.1.2.3" xref="A1.p3.7.m7.1.1.2.3.cmml">e</mi></mrow><mo id="A1.p3.7.m7.1.1.1" xref="A1.p3.7.m7.1.1.1.cmml">−</mo><mn id="A1.p3.7.m7.1.1.3" xref="A1.p3.7.m7.1.1.3.cmml">4</mn></mrow><annotation-xml encoding="MathML-Content" id="A1.p3.7.m7.1b"><apply id="A1.p3.7.m7.1.1.cmml" xref="A1.p3.7.m7.1.1"><minus id="A1.p3.7.m7.1.1.1.cmml" xref="A1.p3.7.m7.1.1.1"></minus><apply id="A1.p3.7.m7.1.1.2.cmml" xref="A1.p3.7.m7.1.1.2"><times id="A1.p3.7.m7.1.1.2.1.cmml" xref="A1.p3.7.m7.1.1.2.1"></times><cn type="integer" id="A1.p3.7.m7.1.1.2.2.cmml" xref="A1.p3.7.m7.1.1.2.2">1</cn><ci id="A1.p3.7.m7.1.1.2.3.cmml" xref="A1.p3.7.m7.1.1.2.3">𝑒</ci></apply><cn type="integer" id="A1.p3.7.m7.1.1.3.cmml" xref="A1.p3.7.m7.1.1.3">4</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.p3.7.m7.1c">1e-4</annotation></semantics></math>. Since at the beginning of each round we were always initializing <math id="A1.p3.8.m8.1" class="ltx_Math" alttext="\bm{\pi}_{S}=\bm{\theta}" display="inline"><semantics id="A1.p3.8.m8.1a"><mrow id="A1.p3.8.m8.1.1" xref="A1.p3.8.m8.1.1.cmml"><msub id="A1.p3.8.m8.1.1.2" xref="A1.p3.8.m8.1.1.2.cmml"><mi id="A1.p3.8.m8.1.1.2.2" xref="A1.p3.8.m8.1.1.2.2.cmml">𝝅</mi><mi id="A1.p3.8.m8.1.1.2.3" xref="A1.p3.8.m8.1.1.2.3.cmml">S</mi></msub><mo id="A1.p3.8.m8.1.1.1" xref="A1.p3.8.m8.1.1.1.cmml">=</mo><mi id="A1.p3.8.m8.1.1.3" xref="A1.p3.8.m8.1.1.3.cmml">𝜽</mi></mrow><annotation-xml encoding="MathML-Content" id="A1.p3.8.m8.1b"><apply id="A1.p3.8.m8.1.1.cmml" xref="A1.p3.8.m8.1.1"><eq id="A1.p3.8.m8.1.1.1.cmml" xref="A1.p3.8.m8.1.1.1"></eq><apply id="A1.p3.8.m8.1.1.2.cmml" xref="A1.p3.8.m8.1.1.2"><csymbol cd="ambiguous" id="A1.p3.8.m8.1.1.2.1.cmml" xref="A1.p3.8.m8.1.1.2">subscript</csymbol><ci id="A1.p3.8.m8.1.1.2.2.cmml" xref="A1.p3.8.m8.1.1.2.2">𝝅</ci><ci id="A1.p3.8.m8.1.1.2.3.cmml" xref="A1.p3.8.m8.1.1.2.3">𝑆</ci></apply><ci id="A1.p3.8.m8.1.1.3.cmml" xref="A1.p3.8.m8.1.1.3">𝜽</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.p3.8.m8.1c">\bm{\pi}_{S}=\bm{\theta}</annotation></semantics></math> and we were only optimizing for a small number of steps before synchronizing, we found that the full strength of the cross-entropy was not necessary. Furthermore, for similar reasons, <em id="A1.p3.16.3" class="ltx_emph ltx_font_italic">i.e.</em> we set <math id="A1.p3.9.m9.1" class="ltx_Math" alttext="\mathbf{w}_{s}=\mathbf{w}" display="inline"><semantics id="A1.p3.9.m9.1a"><mrow id="A1.p3.9.m9.1.1" xref="A1.p3.9.m9.1.1.cmml"><msub id="A1.p3.9.m9.1.1.2" xref="A1.p3.9.m9.1.1.2.cmml"><mi id="A1.p3.9.m9.1.1.2.2" xref="A1.p3.9.m9.1.1.2.2.cmml">𝐰</mi><mi id="A1.p3.9.m9.1.1.2.3" xref="A1.p3.9.m9.1.1.2.3.cmml">s</mi></msub><mo id="A1.p3.9.m9.1.1.1" xref="A1.p3.9.m9.1.1.1.cmml">=</mo><mi id="A1.p3.9.m9.1.1.3" xref="A1.p3.9.m9.1.1.3.cmml">𝐰</mi></mrow><annotation-xml encoding="MathML-Content" id="A1.p3.9.m9.1b"><apply id="A1.p3.9.m9.1.1.cmml" xref="A1.p3.9.m9.1.1"><eq id="A1.p3.9.m9.1.1.1.cmml" xref="A1.p3.9.m9.1.1.1"></eq><apply id="A1.p3.9.m9.1.1.2.cmml" xref="A1.p3.9.m9.1.1.2"><csymbol cd="ambiguous" id="A1.p3.9.m9.1.1.2.1.cmml" xref="A1.p3.9.m9.1.1.2">subscript</csymbol><ci id="A1.p3.9.m9.1.1.2.2.cmml" xref="A1.p3.9.m9.1.1.2.2">𝐰</ci><ci id="A1.p3.9.m9.1.1.2.3.cmml" xref="A1.p3.9.m9.1.1.2.3">𝑠</ci></apply><ci id="A1.p3.9.m9.1.1.3.cmml" xref="A1.p3.9.m9.1.1.3">𝐰</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.p3.9.m9.1c">\mathbf{w}_{s}=\mathbf{w}</annotation></semantics></math> at the beginning of each round, we also used <math id="A1.p3.10.m10.1" class="ltx_Math" alttext="\lambda=0" display="inline"><semantics id="A1.p3.10.m10.1a"><mrow id="A1.p3.10.m10.1.1" xref="A1.p3.10.m10.1.1.cmml"><mi id="A1.p3.10.m10.1.1.2" xref="A1.p3.10.m10.1.1.2.cmml">λ</mi><mo id="A1.p3.10.m10.1.1.1" xref="A1.p3.10.m10.1.1.1.cmml">=</mo><mn id="A1.p3.10.m10.1.1.3" xref="A1.p3.10.m10.1.1.3.cmml">0</mn></mrow><annotation-xml encoding="MathML-Content" id="A1.p3.10.m10.1b"><apply id="A1.p3.10.m10.1.1.cmml" xref="A1.p3.10.m10.1.1"><eq id="A1.p3.10.m10.1.1.1.cmml" xref="A1.p3.10.m10.1.1.1"></eq><ci id="A1.p3.10.m10.1.1.2.cmml" xref="A1.p3.10.m10.1.1.2">𝜆</ci><cn type="integer" id="A1.p3.10.m10.1.1.3.cmml" xref="A1.p3.10.m10.1.1.3">0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.p3.10.m10.1c">\lambda=0</annotation></semantics></math> for the drift term <math id="A1.p3.11.m11.1" class="ltx_Math" alttext="\frac{\lambda}{2}\bm{\pi}_{sj}(\mathbf{w}_{s}-\mathbf{w})^{2}" display="inline"><semantics id="A1.p3.11.m11.1a"><mrow id="A1.p3.11.m11.1.1" xref="A1.p3.11.m11.1.1.cmml"><mfrac id="A1.p3.11.m11.1.1.3" xref="A1.p3.11.m11.1.1.3.cmml"><mi id="A1.p3.11.m11.1.1.3.2" xref="A1.p3.11.m11.1.1.3.2.cmml">λ</mi><mn id="A1.p3.11.m11.1.1.3.3" xref="A1.p3.11.m11.1.1.3.3.cmml">2</mn></mfrac><mo lspace="0em" rspace="0em" id="A1.p3.11.m11.1.1.2" xref="A1.p3.11.m11.1.1.2.cmml">​</mo><msub id="A1.p3.11.m11.1.1.4" xref="A1.p3.11.m11.1.1.4.cmml"><mi id="A1.p3.11.m11.1.1.4.2" xref="A1.p3.11.m11.1.1.4.2.cmml">𝝅</mi><mrow id="A1.p3.11.m11.1.1.4.3" xref="A1.p3.11.m11.1.1.4.3.cmml"><mi id="A1.p3.11.m11.1.1.4.3.2" xref="A1.p3.11.m11.1.1.4.3.2.cmml">s</mi><mo lspace="0em" rspace="0em" id="A1.p3.11.m11.1.1.4.3.1" xref="A1.p3.11.m11.1.1.4.3.1.cmml">​</mo><mi id="A1.p3.11.m11.1.1.4.3.3" xref="A1.p3.11.m11.1.1.4.3.3.cmml">j</mi></mrow></msub><mo lspace="0em" rspace="0em" id="A1.p3.11.m11.1.1.2a" xref="A1.p3.11.m11.1.1.2.cmml">​</mo><msup id="A1.p3.11.m11.1.1.1" xref="A1.p3.11.m11.1.1.1.cmml"><mrow id="A1.p3.11.m11.1.1.1.1.1" xref="A1.p3.11.m11.1.1.1.1.1.1.cmml"><mo stretchy="false" id="A1.p3.11.m11.1.1.1.1.1.2" xref="A1.p3.11.m11.1.1.1.1.1.1.cmml">(</mo><mrow id="A1.p3.11.m11.1.1.1.1.1.1" xref="A1.p3.11.m11.1.1.1.1.1.1.cmml"><msub id="A1.p3.11.m11.1.1.1.1.1.1.2" xref="A1.p3.11.m11.1.1.1.1.1.1.2.cmml"><mi id="A1.p3.11.m11.1.1.1.1.1.1.2.2" xref="A1.p3.11.m11.1.1.1.1.1.1.2.2.cmml">𝐰</mi><mi id="A1.p3.11.m11.1.1.1.1.1.1.2.3" xref="A1.p3.11.m11.1.1.1.1.1.1.2.3.cmml">s</mi></msub><mo id="A1.p3.11.m11.1.1.1.1.1.1.1" xref="A1.p3.11.m11.1.1.1.1.1.1.1.cmml">−</mo><mi id="A1.p3.11.m11.1.1.1.1.1.1.3" xref="A1.p3.11.m11.1.1.1.1.1.1.3.cmml">𝐰</mi></mrow><mo stretchy="false" id="A1.p3.11.m11.1.1.1.1.1.3" xref="A1.p3.11.m11.1.1.1.1.1.1.cmml">)</mo></mrow><mn id="A1.p3.11.m11.1.1.1.3" xref="A1.p3.11.m11.1.1.1.3.cmml">2</mn></msup></mrow><annotation-xml encoding="MathML-Content" id="A1.p3.11.m11.1b"><apply id="A1.p3.11.m11.1.1.cmml" xref="A1.p3.11.m11.1.1"><times id="A1.p3.11.m11.1.1.2.cmml" xref="A1.p3.11.m11.1.1.2"></times><apply id="A1.p3.11.m11.1.1.3.cmml" xref="A1.p3.11.m11.1.1.3"><divide id="A1.p3.11.m11.1.1.3.1.cmml" xref="A1.p3.11.m11.1.1.3"></divide><ci id="A1.p3.11.m11.1.1.3.2.cmml" xref="A1.p3.11.m11.1.1.3.2">𝜆</ci><cn type="integer" id="A1.p3.11.m11.1.1.3.3.cmml" xref="A1.p3.11.m11.1.1.3.3">2</cn></apply><apply id="A1.p3.11.m11.1.1.4.cmml" xref="A1.p3.11.m11.1.1.4"><csymbol cd="ambiguous" id="A1.p3.11.m11.1.1.4.1.cmml" xref="A1.p3.11.m11.1.1.4">subscript</csymbol><ci id="A1.p3.11.m11.1.1.4.2.cmml" xref="A1.p3.11.m11.1.1.4.2">𝝅</ci><apply id="A1.p3.11.m11.1.1.4.3.cmml" xref="A1.p3.11.m11.1.1.4.3"><times id="A1.p3.11.m11.1.1.4.3.1.cmml" xref="A1.p3.11.m11.1.1.4.3.1"></times><ci id="A1.p3.11.m11.1.1.4.3.2.cmml" xref="A1.p3.11.m11.1.1.4.3.2">𝑠</ci><ci id="A1.p3.11.m11.1.1.4.3.3.cmml" xref="A1.p3.11.m11.1.1.4.3.3">𝑗</ci></apply></apply><apply id="A1.p3.11.m11.1.1.1.cmml" xref="A1.p3.11.m11.1.1.1"><csymbol cd="ambiguous" id="A1.p3.11.m11.1.1.1.2.cmml" xref="A1.p3.11.m11.1.1.1">superscript</csymbol><apply id="A1.p3.11.m11.1.1.1.1.1.1.cmml" xref="A1.p3.11.m11.1.1.1.1.1"><minus id="A1.p3.11.m11.1.1.1.1.1.1.1.cmml" xref="A1.p3.11.m11.1.1.1.1.1.1.1"></minus><apply id="A1.p3.11.m11.1.1.1.1.1.1.2.cmml" xref="A1.p3.11.m11.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="A1.p3.11.m11.1.1.1.1.1.1.2.1.cmml" xref="A1.p3.11.m11.1.1.1.1.1.1.2">subscript</csymbol><ci id="A1.p3.11.m11.1.1.1.1.1.1.2.2.cmml" xref="A1.p3.11.m11.1.1.1.1.1.1.2.2">𝐰</ci><ci id="A1.p3.11.m11.1.1.1.1.1.1.2.3.cmml" xref="A1.p3.11.m11.1.1.1.1.1.1.2.3">𝑠</ci></apply><ci id="A1.p3.11.m11.1.1.1.1.1.1.3.cmml" xref="A1.p3.11.m11.1.1.1.1.1.1.3">𝐰</ci></apply><cn type="integer" id="A1.p3.11.m11.1.1.1.3.cmml" xref="A1.p3.11.m11.1.1.1.3">2</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.p3.11.m11.1c">\frac{\lambda}{2}\bm{\pi}_{sj}(\mathbf{w}_{s}-\mathbf{w})^{2}</annotation></semantics></math>. The remaining hyperparameter <math id="A1.p3.12.m12.1" class="ltx_Math" alttext="\lambda_{0}" display="inline"><semantics id="A1.p3.12.m12.1a"><msub id="A1.p3.12.m12.1.1" xref="A1.p3.12.m12.1.1.cmml"><mi id="A1.p3.12.m12.1.1.2" xref="A1.p3.12.m12.1.1.2.cmml">λ</mi><mn id="A1.p3.12.m12.1.1.3" xref="A1.p3.12.m12.1.1.3.cmml">0</mn></msub><annotation-xml encoding="MathML-Content" id="A1.p3.12.m12.1b"><apply id="A1.p3.12.m12.1.1.cmml" xref="A1.p3.12.m12.1.1"><csymbol cd="ambiguous" id="A1.p3.12.m12.1.1.1.cmml" xref="A1.p3.12.m12.1.1">subscript</csymbol><ci id="A1.p3.12.m12.1.1.2.cmml" xref="A1.p3.12.m12.1.1.2">𝜆</ci><cn type="integer" id="A1.p3.12.m12.1.1.3.cmml" xref="A1.p3.12.m12.1.1.3">0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.p3.12.m12.1c">\lambda_{0}</annotation></semantics></math> dictates how sparse the final model will be. For the LeNet-5 model the <math id="A1.p3.13.m13.1" class="ltx_Math" alttext="\lambda_{0}" display="inline"><semantics id="A1.p3.13.m13.1a"><msub id="A1.p3.13.m13.1.1" xref="A1.p3.13.m13.1.1.cmml"><mi id="A1.p3.13.m13.1.1.2" xref="A1.p3.13.m13.1.1.2.cmml">λ</mi><mn id="A1.p3.13.m13.1.1.3" xref="A1.p3.13.m13.1.1.3.cmml">0</mn></msub><annotation-xml encoding="MathML-Content" id="A1.p3.13.m13.1b"><apply id="A1.p3.13.m13.1.1.cmml" xref="A1.p3.13.m13.1.1"><csymbol cd="ambiguous" id="A1.p3.13.m13.1.1.1.cmml" xref="A1.p3.13.m13.1.1">subscript</csymbol><ci id="A1.p3.13.m13.1.1.2.cmml" xref="A1.p3.13.m13.1.1.2">𝜆</ci><cn type="integer" id="A1.p3.13.m13.1.1.3.cmml" xref="A1.p3.13.m13.1.1.3">0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.p3.13.m13.1c">\lambda_{0}</annotation></semantics></math>’s we report are <math id="A1.p3.14.m14.3" class="ltx_Math" alttext="\{5e-7,5e-6,5e-5\}" display="inline"><semantics id="A1.p3.14.m14.3a"><mrow id="A1.p3.14.m14.3.3.3" xref="A1.p3.14.m14.3.3.4.cmml"><mo stretchy="false" id="A1.p3.14.m14.3.3.3.4" xref="A1.p3.14.m14.3.3.4.cmml">{</mo><mrow id="A1.p3.14.m14.1.1.1.1" xref="A1.p3.14.m14.1.1.1.1.cmml"><mrow id="A1.p3.14.m14.1.1.1.1.2" xref="A1.p3.14.m14.1.1.1.1.2.cmml"><mn id="A1.p3.14.m14.1.1.1.1.2.2" xref="A1.p3.14.m14.1.1.1.1.2.2.cmml">5</mn><mo lspace="0em" rspace="0em" id="A1.p3.14.m14.1.1.1.1.2.1" xref="A1.p3.14.m14.1.1.1.1.2.1.cmml">​</mo><mi id="A1.p3.14.m14.1.1.1.1.2.3" xref="A1.p3.14.m14.1.1.1.1.2.3.cmml">e</mi></mrow><mo id="A1.p3.14.m14.1.1.1.1.1" xref="A1.p3.14.m14.1.1.1.1.1.cmml">−</mo><mn id="A1.p3.14.m14.1.1.1.1.3" xref="A1.p3.14.m14.1.1.1.1.3.cmml">7</mn></mrow><mo id="A1.p3.14.m14.3.3.3.5" xref="A1.p3.14.m14.3.3.4.cmml">,</mo><mrow id="A1.p3.14.m14.2.2.2.2" xref="A1.p3.14.m14.2.2.2.2.cmml"><mrow id="A1.p3.14.m14.2.2.2.2.2" xref="A1.p3.14.m14.2.2.2.2.2.cmml"><mn id="A1.p3.14.m14.2.2.2.2.2.2" xref="A1.p3.14.m14.2.2.2.2.2.2.cmml">5</mn><mo lspace="0em" rspace="0em" id="A1.p3.14.m14.2.2.2.2.2.1" xref="A1.p3.14.m14.2.2.2.2.2.1.cmml">​</mo><mi id="A1.p3.14.m14.2.2.2.2.2.3" xref="A1.p3.14.m14.2.2.2.2.2.3.cmml">e</mi></mrow><mo id="A1.p3.14.m14.2.2.2.2.1" xref="A1.p3.14.m14.2.2.2.2.1.cmml">−</mo><mn id="A1.p3.14.m14.2.2.2.2.3" xref="A1.p3.14.m14.2.2.2.2.3.cmml">6</mn></mrow><mo id="A1.p3.14.m14.3.3.3.6" xref="A1.p3.14.m14.3.3.4.cmml">,</mo><mrow id="A1.p3.14.m14.3.3.3.3" xref="A1.p3.14.m14.3.3.3.3.cmml"><mrow id="A1.p3.14.m14.3.3.3.3.2" xref="A1.p3.14.m14.3.3.3.3.2.cmml"><mn id="A1.p3.14.m14.3.3.3.3.2.2" xref="A1.p3.14.m14.3.3.3.3.2.2.cmml">5</mn><mo lspace="0em" rspace="0em" id="A1.p3.14.m14.3.3.3.3.2.1" xref="A1.p3.14.m14.3.3.3.3.2.1.cmml">​</mo><mi id="A1.p3.14.m14.3.3.3.3.2.3" xref="A1.p3.14.m14.3.3.3.3.2.3.cmml">e</mi></mrow><mo id="A1.p3.14.m14.3.3.3.3.1" xref="A1.p3.14.m14.3.3.3.3.1.cmml">−</mo><mn id="A1.p3.14.m14.3.3.3.3.3" xref="A1.p3.14.m14.3.3.3.3.3.cmml">5</mn></mrow><mo stretchy="false" id="A1.p3.14.m14.3.3.3.7" xref="A1.p3.14.m14.3.3.4.cmml">}</mo></mrow><annotation-xml encoding="MathML-Content" id="A1.p3.14.m14.3b"><set id="A1.p3.14.m14.3.3.4.cmml" xref="A1.p3.14.m14.3.3.3"><apply id="A1.p3.14.m14.1.1.1.1.cmml" xref="A1.p3.14.m14.1.1.1.1"><minus id="A1.p3.14.m14.1.1.1.1.1.cmml" xref="A1.p3.14.m14.1.1.1.1.1"></minus><apply id="A1.p3.14.m14.1.1.1.1.2.cmml" xref="A1.p3.14.m14.1.1.1.1.2"><times id="A1.p3.14.m14.1.1.1.1.2.1.cmml" xref="A1.p3.14.m14.1.1.1.1.2.1"></times><cn type="integer" id="A1.p3.14.m14.1.1.1.1.2.2.cmml" xref="A1.p3.14.m14.1.1.1.1.2.2">5</cn><ci id="A1.p3.14.m14.1.1.1.1.2.3.cmml" xref="A1.p3.14.m14.1.1.1.1.2.3">𝑒</ci></apply><cn type="integer" id="A1.p3.14.m14.1.1.1.1.3.cmml" xref="A1.p3.14.m14.1.1.1.1.3">7</cn></apply><apply id="A1.p3.14.m14.2.2.2.2.cmml" xref="A1.p3.14.m14.2.2.2.2"><minus id="A1.p3.14.m14.2.2.2.2.1.cmml" xref="A1.p3.14.m14.2.2.2.2.1"></minus><apply id="A1.p3.14.m14.2.2.2.2.2.cmml" xref="A1.p3.14.m14.2.2.2.2.2"><times id="A1.p3.14.m14.2.2.2.2.2.1.cmml" xref="A1.p3.14.m14.2.2.2.2.2.1"></times><cn type="integer" id="A1.p3.14.m14.2.2.2.2.2.2.cmml" xref="A1.p3.14.m14.2.2.2.2.2.2">5</cn><ci id="A1.p3.14.m14.2.2.2.2.2.3.cmml" xref="A1.p3.14.m14.2.2.2.2.2.3">𝑒</ci></apply><cn type="integer" id="A1.p3.14.m14.2.2.2.2.3.cmml" xref="A1.p3.14.m14.2.2.2.2.3">6</cn></apply><apply id="A1.p3.14.m14.3.3.3.3.cmml" xref="A1.p3.14.m14.3.3.3.3"><minus id="A1.p3.14.m14.3.3.3.3.1.cmml" xref="A1.p3.14.m14.3.3.3.3.1"></minus><apply id="A1.p3.14.m14.3.3.3.3.2.cmml" xref="A1.p3.14.m14.3.3.3.3.2"><times id="A1.p3.14.m14.3.3.3.3.2.1.cmml" xref="A1.p3.14.m14.3.3.3.3.2.1"></times><cn type="integer" id="A1.p3.14.m14.3.3.3.3.2.2.cmml" xref="A1.p3.14.m14.3.3.3.3.2.2">5</cn><ci id="A1.p3.14.m14.3.3.3.3.2.3.cmml" xref="A1.p3.14.m14.3.3.3.3.2.3">𝑒</ci></apply><cn type="integer" id="A1.p3.14.m14.3.3.3.3.3.cmml" xref="A1.p3.14.m14.3.3.3.3.3">5</cn></apply></set></annotation-xml><annotation encoding="application/x-tex" id="A1.p3.14.m14.3c">\{5e-7,5e-6,5e-5\}</annotation></semantics></math> for the “low”, “mid” and “high” settings respectively, which were optimized for CIFAR10 and used as-is for Femnist. For CIFAR100 and Resnet20, we did not perform any pruning for the output layer and the <math id="A1.p3.15.m15.1" class="ltx_Math" alttext="\lambda_{0}" display="inline"><semantics id="A1.p3.15.m15.1a"><msub id="A1.p3.15.m15.1.1" xref="A1.p3.15.m15.1.1.cmml"><mi id="A1.p3.15.m15.1.1.2" xref="A1.p3.15.m15.1.1.2.cmml">λ</mi><mn id="A1.p3.15.m15.1.1.3" xref="A1.p3.15.m15.1.1.3.cmml">0</mn></msub><annotation-xml encoding="MathML-Content" id="A1.p3.15.m15.1b"><apply id="A1.p3.15.m15.1.1.cmml" xref="A1.p3.15.m15.1.1"><csymbol cd="ambiguous" id="A1.p3.15.m15.1.1.1.cmml" xref="A1.p3.15.m15.1.1">subscript</csymbol><ci id="A1.p3.15.m15.1.1.2.cmml" xref="A1.p3.15.m15.1.1.2">𝜆</ci><cn type="integer" id="A1.p3.15.m15.1.1.3.cmml" xref="A1.p3.15.m15.1.1.3">0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.p3.15.m15.1c">\lambda_{0}</annotation></semantics></math>’s for the “low”, “mid” and “high” settings were <math id="A1.p3.16.m16.3" class="ltx_Math" alttext="\{5e-7,5e-6,5e-5\}" display="inline"><semantics id="A1.p3.16.m16.3a"><mrow id="A1.p3.16.m16.3.3.3" xref="A1.p3.16.m16.3.3.4.cmml"><mo stretchy="false" id="A1.p3.16.m16.3.3.3.4" xref="A1.p3.16.m16.3.3.4.cmml">{</mo><mrow id="A1.p3.16.m16.1.1.1.1" xref="A1.p3.16.m16.1.1.1.1.cmml"><mrow id="A1.p3.16.m16.1.1.1.1.2" xref="A1.p3.16.m16.1.1.1.1.2.cmml"><mn id="A1.p3.16.m16.1.1.1.1.2.2" xref="A1.p3.16.m16.1.1.1.1.2.2.cmml">5</mn><mo lspace="0em" rspace="0em" id="A1.p3.16.m16.1.1.1.1.2.1" xref="A1.p3.16.m16.1.1.1.1.2.1.cmml">​</mo><mi id="A1.p3.16.m16.1.1.1.1.2.3" xref="A1.p3.16.m16.1.1.1.1.2.3.cmml">e</mi></mrow><mo id="A1.p3.16.m16.1.1.1.1.1" xref="A1.p3.16.m16.1.1.1.1.1.cmml">−</mo><mn id="A1.p3.16.m16.1.1.1.1.3" xref="A1.p3.16.m16.1.1.1.1.3.cmml">7</mn></mrow><mo id="A1.p3.16.m16.3.3.3.5" xref="A1.p3.16.m16.3.3.4.cmml">,</mo><mrow id="A1.p3.16.m16.2.2.2.2" xref="A1.p3.16.m16.2.2.2.2.cmml"><mrow id="A1.p3.16.m16.2.2.2.2.2" xref="A1.p3.16.m16.2.2.2.2.2.cmml"><mn id="A1.p3.16.m16.2.2.2.2.2.2" xref="A1.p3.16.m16.2.2.2.2.2.2.cmml">5</mn><mo lspace="0em" rspace="0em" id="A1.p3.16.m16.2.2.2.2.2.1" xref="A1.p3.16.m16.2.2.2.2.2.1.cmml">​</mo><mi id="A1.p3.16.m16.2.2.2.2.2.3" xref="A1.p3.16.m16.2.2.2.2.2.3.cmml">e</mi></mrow><mo id="A1.p3.16.m16.2.2.2.2.1" xref="A1.p3.16.m16.2.2.2.2.1.cmml">−</mo><mn id="A1.p3.16.m16.2.2.2.2.3" xref="A1.p3.16.m16.2.2.2.2.3.cmml">6</mn></mrow><mo id="A1.p3.16.m16.3.3.3.6" xref="A1.p3.16.m16.3.3.4.cmml">,</mo><mrow id="A1.p3.16.m16.3.3.3.3" xref="A1.p3.16.m16.3.3.3.3.cmml"><mrow id="A1.p3.16.m16.3.3.3.3.2" xref="A1.p3.16.m16.3.3.3.3.2.cmml"><mn id="A1.p3.16.m16.3.3.3.3.2.2" xref="A1.p3.16.m16.3.3.3.3.2.2.cmml">5</mn><mo lspace="0em" rspace="0em" id="A1.p3.16.m16.3.3.3.3.2.1" xref="A1.p3.16.m16.3.3.3.3.2.1.cmml">​</mo><mi id="A1.p3.16.m16.3.3.3.3.2.3" xref="A1.p3.16.m16.3.3.3.3.2.3.cmml">e</mi></mrow><mo id="A1.p3.16.m16.3.3.3.3.1" xref="A1.p3.16.m16.3.3.3.3.1.cmml">−</mo><mn id="A1.p3.16.m16.3.3.3.3.3" xref="A1.p3.16.m16.3.3.3.3.3.cmml">5</mn></mrow><mo stretchy="false" id="A1.p3.16.m16.3.3.3.7" xref="A1.p3.16.m16.3.3.4.cmml">}</mo></mrow><annotation-xml encoding="MathML-Content" id="A1.p3.16.m16.3b"><set id="A1.p3.16.m16.3.3.4.cmml" xref="A1.p3.16.m16.3.3.3"><apply id="A1.p3.16.m16.1.1.1.1.cmml" xref="A1.p3.16.m16.1.1.1.1"><minus id="A1.p3.16.m16.1.1.1.1.1.cmml" xref="A1.p3.16.m16.1.1.1.1.1"></minus><apply id="A1.p3.16.m16.1.1.1.1.2.cmml" xref="A1.p3.16.m16.1.1.1.1.2"><times id="A1.p3.16.m16.1.1.1.1.2.1.cmml" xref="A1.p3.16.m16.1.1.1.1.2.1"></times><cn type="integer" id="A1.p3.16.m16.1.1.1.1.2.2.cmml" xref="A1.p3.16.m16.1.1.1.1.2.2">5</cn><ci id="A1.p3.16.m16.1.1.1.1.2.3.cmml" xref="A1.p3.16.m16.1.1.1.1.2.3">𝑒</ci></apply><cn type="integer" id="A1.p3.16.m16.1.1.1.1.3.cmml" xref="A1.p3.16.m16.1.1.1.1.3">7</cn></apply><apply id="A1.p3.16.m16.2.2.2.2.cmml" xref="A1.p3.16.m16.2.2.2.2"><minus id="A1.p3.16.m16.2.2.2.2.1.cmml" xref="A1.p3.16.m16.2.2.2.2.1"></minus><apply id="A1.p3.16.m16.2.2.2.2.2.cmml" xref="A1.p3.16.m16.2.2.2.2.2"><times id="A1.p3.16.m16.2.2.2.2.2.1.cmml" xref="A1.p3.16.m16.2.2.2.2.2.1"></times><cn type="integer" id="A1.p3.16.m16.2.2.2.2.2.2.cmml" xref="A1.p3.16.m16.2.2.2.2.2.2">5</cn><ci id="A1.p3.16.m16.2.2.2.2.2.3.cmml" xref="A1.p3.16.m16.2.2.2.2.2.3">𝑒</ci></apply><cn type="integer" id="A1.p3.16.m16.2.2.2.2.3.cmml" xref="A1.p3.16.m16.2.2.2.2.3">6</cn></apply><apply id="A1.p3.16.m16.3.3.3.3.cmml" xref="A1.p3.16.m16.3.3.3.3"><minus id="A1.p3.16.m16.3.3.3.3.1.cmml" xref="A1.p3.16.m16.3.3.3.3.1"></minus><apply id="A1.p3.16.m16.3.3.3.3.2.cmml" xref="A1.p3.16.m16.3.3.3.3.2"><times id="A1.p3.16.m16.3.3.3.3.2.1.cmml" xref="A1.p3.16.m16.3.3.3.3.2.1"></times><cn type="integer" id="A1.p3.16.m16.3.3.3.3.2.2.cmml" xref="A1.p3.16.m16.3.3.3.3.2.2">5</cn><ci id="A1.p3.16.m16.3.3.3.3.2.3.cmml" xref="A1.p3.16.m16.3.3.3.3.2.3">𝑒</ci></apply><cn type="integer" id="A1.p3.16.m16.3.3.3.3.3.cmml" xref="A1.p3.16.m16.3.3.3.3.3">5</cn></apply></set></annotation-xml><annotation encoding="application/x-tex" id="A1.p3.16.m16.3c">\{5e-7,5e-6,5e-5\}</annotation></semantics></math> respectively. These were chosen so that we obtain models with comparable sparsity ratios as the one on CIFAR10.</p>
</div>
<div id="A1.p4" class="ltx_para">
<p id="A1.p4.1" class="ltx_p">The <span id="A1.p4.1.1" class="ltx_text ltx_font_typewriter">FedL1</span> baseline was implemented by using a group <math id="A1.p4.1.m1.1" class="ltx_Math" alttext="L_{1}" display="inline"><semantics id="A1.p4.1.m1.1a"><msub id="A1.p4.1.m1.1.1" xref="A1.p4.1.m1.1.1.cmml"><mi id="A1.p4.1.m1.1.1.2" xref="A1.p4.1.m1.1.1.2.cmml">L</mi><mn id="A1.p4.1.m1.1.1.3" xref="A1.p4.1.m1.1.1.3.cmml">1</mn></msub><annotation-xml encoding="MathML-Content" id="A1.p4.1.m1.1b"><apply id="A1.p4.1.m1.1.1.cmml" xref="A1.p4.1.m1.1.1"><csymbol cd="ambiguous" id="A1.p4.1.m1.1.1.1.cmml" xref="A1.p4.1.m1.1.1">subscript</csymbol><ci id="A1.p4.1.m1.1.1.2.cmml" xref="A1.p4.1.m1.1.1.2">𝐿</ci><cn type="integer" id="A1.p4.1.m1.1.1.3.cmml" xref="A1.p4.1.m1.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.p4.1.m1.1c">L_{1}</annotation></semantics></math> regularizer <span id="A1.p4.1.2" class="ltx_ERROR undefined">\citeappendix</span>wen2016learning at the client level, <em id="A1.p4.1.3" class="ltx_emph ltx_font_italic">i.e.</em>, the local loss was:</p>
<table id="A10.EGx21" class="ltx_equationgroup ltx_eqn_align ltx_eqn_table">

<tbody id="A1.E24"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math id="A1.E24.m1.4" class="ltx_Math" alttext="\displaystyle\mathcal{L}_{s}(\mathcal{D}_{s},\mathbf{w}):=\frac{1}{N_{s}}\sum_{i=1}^{N_{s}}L(\mathcal{D}_{si},\mathbf{w})+\lambda\sum_{g}\sqrt{\|\mathbf{w}_{g}\|_{2}^{2}}," display="inline"><semantics id="A1.E24.m1.4a"><mrow id="A1.E24.m1.4.4.1" xref="A1.E24.m1.4.4.1.1.cmml"><mrow id="A1.E24.m1.4.4.1.1" xref="A1.E24.m1.4.4.1.1.cmml"><mrow id="A1.E24.m1.4.4.1.1.1" xref="A1.E24.m1.4.4.1.1.1.cmml"><msub id="A1.E24.m1.4.4.1.1.1.3" xref="A1.E24.m1.4.4.1.1.1.3.cmml"><mi class="ltx_font_mathcaligraphic" id="A1.E24.m1.4.4.1.1.1.3.2" xref="A1.E24.m1.4.4.1.1.1.3.2.cmml">ℒ</mi><mi id="A1.E24.m1.4.4.1.1.1.3.3" xref="A1.E24.m1.4.4.1.1.1.3.3.cmml">s</mi></msub><mo lspace="0em" rspace="0em" id="A1.E24.m1.4.4.1.1.1.2" xref="A1.E24.m1.4.4.1.1.1.2.cmml">​</mo><mrow id="A1.E24.m1.4.4.1.1.1.1.1" xref="A1.E24.m1.4.4.1.1.1.1.2.cmml"><mo stretchy="false" id="A1.E24.m1.4.4.1.1.1.1.1.2" xref="A1.E24.m1.4.4.1.1.1.1.2.cmml">(</mo><msub id="A1.E24.m1.4.4.1.1.1.1.1.1" xref="A1.E24.m1.4.4.1.1.1.1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="A1.E24.m1.4.4.1.1.1.1.1.1.2" xref="A1.E24.m1.4.4.1.1.1.1.1.1.2.cmml">𝒟</mi><mi id="A1.E24.m1.4.4.1.1.1.1.1.1.3" xref="A1.E24.m1.4.4.1.1.1.1.1.1.3.cmml">s</mi></msub><mo id="A1.E24.m1.4.4.1.1.1.1.1.3" xref="A1.E24.m1.4.4.1.1.1.1.2.cmml">,</mo><mi id="A1.E24.m1.2.2" xref="A1.E24.m1.2.2.cmml">𝐰</mi><mo rspace="0.278em" stretchy="false" id="A1.E24.m1.4.4.1.1.1.1.1.4" xref="A1.E24.m1.4.4.1.1.1.1.2.cmml">)</mo></mrow></mrow><mo rspace="0.278em" id="A1.E24.m1.4.4.1.1.3" xref="A1.E24.m1.4.4.1.1.3.cmml">:=</mo><mrow id="A1.E24.m1.4.4.1.1.2" xref="A1.E24.m1.4.4.1.1.2.cmml"><mrow id="A1.E24.m1.4.4.1.1.2.1" xref="A1.E24.m1.4.4.1.1.2.1.cmml"><mstyle displaystyle="true" id="A1.E24.m1.4.4.1.1.2.1.3" xref="A1.E24.m1.4.4.1.1.2.1.3.cmml"><mfrac id="A1.E24.m1.4.4.1.1.2.1.3a" xref="A1.E24.m1.4.4.1.1.2.1.3.cmml"><mn id="A1.E24.m1.4.4.1.1.2.1.3.2" xref="A1.E24.m1.4.4.1.1.2.1.3.2.cmml">1</mn><msub id="A1.E24.m1.4.4.1.1.2.1.3.3" xref="A1.E24.m1.4.4.1.1.2.1.3.3.cmml"><mi id="A1.E24.m1.4.4.1.1.2.1.3.3.2" xref="A1.E24.m1.4.4.1.1.2.1.3.3.2.cmml">N</mi><mi id="A1.E24.m1.4.4.1.1.2.1.3.3.3" xref="A1.E24.m1.4.4.1.1.2.1.3.3.3.cmml">s</mi></msub></mfrac></mstyle><mo lspace="0em" rspace="0em" id="A1.E24.m1.4.4.1.1.2.1.2" xref="A1.E24.m1.4.4.1.1.2.1.2.cmml">​</mo><mrow id="A1.E24.m1.4.4.1.1.2.1.1" xref="A1.E24.m1.4.4.1.1.2.1.1.cmml"><mstyle displaystyle="true" id="A1.E24.m1.4.4.1.1.2.1.1.2" xref="A1.E24.m1.4.4.1.1.2.1.1.2.cmml"><munderover id="A1.E24.m1.4.4.1.1.2.1.1.2a" xref="A1.E24.m1.4.4.1.1.2.1.1.2.cmml"><mo movablelimits="false" id="A1.E24.m1.4.4.1.1.2.1.1.2.2.2" xref="A1.E24.m1.4.4.1.1.2.1.1.2.2.2.cmml">∑</mo><mrow id="A1.E24.m1.4.4.1.1.2.1.1.2.2.3" xref="A1.E24.m1.4.4.1.1.2.1.1.2.2.3.cmml"><mi id="A1.E24.m1.4.4.1.1.2.1.1.2.2.3.2" xref="A1.E24.m1.4.4.1.1.2.1.1.2.2.3.2.cmml">i</mi><mo id="A1.E24.m1.4.4.1.1.2.1.1.2.2.3.1" xref="A1.E24.m1.4.4.1.1.2.1.1.2.2.3.1.cmml">=</mo><mn id="A1.E24.m1.4.4.1.1.2.1.1.2.2.3.3" xref="A1.E24.m1.4.4.1.1.2.1.1.2.2.3.3.cmml">1</mn></mrow><msub id="A1.E24.m1.4.4.1.1.2.1.1.2.3" xref="A1.E24.m1.4.4.1.1.2.1.1.2.3.cmml"><mi id="A1.E24.m1.4.4.1.1.2.1.1.2.3.2" xref="A1.E24.m1.4.4.1.1.2.1.1.2.3.2.cmml">N</mi><mi id="A1.E24.m1.4.4.1.1.2.1.1.2.3.3" xref="A1.E24.m1.4.4.1.1.2.1.1.2.3.3.cmml">s</mi></msub></munderover></mstyle><mrow id="A1.E24.m1.4.4.1.1.2.1.1.1" xref="A1.E24.m1.4.4.1.1.2.1.1.1.cmml"><mi id="A1.E24.m1.4.4.1.1.2.1.1.1.3" xref="A1.E24.m1.4.4.1.1.2.1.1.1.3.cmml">L</mi><mo lspace="0em" rspace="0em" id="A1.E24.m1.4.4.1.1.2.1.1.1.2" xref="A1.E24.m1.4.4.1.1.2.1.1.1.2.cmml">​</mo><mrow id="A1.E24.m1.4.4.1.1.2.1.1.1.1.1" xref="A1.E24.m1.4.4.1.1.2.1.1.1.1.2.cmml"><mo stretchy="false" id="A1.E24.m1.4.4.1.1.2.1.1.1.1.1.2" xref="A1.E24.m1.4.4.1.1.2.1.1.1.1.2.cmml">(</mo><msub id="A1.E24.m1.4.4.1.1.2.1.1.1.1.1.1" xref="A1.E24.m1.4.4.1.1.2.1.1.1.1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="A1.E24.m1.4.4.1.1.2.1.1.1.1.1.1.2" xref="A1.E24.m1.4.4.1.1.2.1.1.1.1.1.1.2.cmml">𝒟</mi><mrow id="A1.E24.m1.4.4.1.1.2.1.1.1.1.1.1.3" xref="A1.E24.m1.4.4.1.1.2.1.1.1.1.1.1.3.cmml"><mi id="A1.E24.m1.4.4.1.1.2.1.1.1.1.1.1.3.2" xref="A1.E24.m1.4.4.1.1.2.1.1.1.1.1.1.3.2.cmml">s</mi><mo lspace="0em" rspace="0em" id="A1.E24.m1.4.4.1.1.2.1.1.1.1.1.1.3.1" xref="A1.E24.m1.4.4.1.1.2.1.1.1.1.1.1.3.1.cmml">​</mo><mi id="A1.E24.m1.4.4.1.1.2.1.1.1.1.1.1.3.3" xref="A1.E24.m1.4.4.1.1.2.1.1.1.1.1.1.3.3.cmml">i</mi></mrow></msub><mo id="A1.E24.m1.4.4.1.1.2.1.1.1.1.1.3" xref="A1.E24.m1.4.4.1.1.2.1.1.1.1.2.cmml">,</mo><mi id="A1.E24.m1.3.3" xref="A1.E24.m1.3.3.cmml">𝐰</mi><mo stretchy="false" id="A1.E24.m1.4.4.1.1.2.1.1.1.1.1.4" xref="A1.E24.m1.4.4.1.1.2.1.1.1.1.2.cmml">)</mo></mrow></mrow></mrow></mrow><mo id="A1.E24.m1.4.4.1.1.2.2" xref="A1.E24.m1.4.4.1.1.2.2.cmml">+</mo><mrow id="A1.E24.m1.4.4.1.1.2.3" xref="A1.E24.m1.4.4.1.1.2.3.cmml"><mi id="A1.E24.m1.4.4.1.1.2.3.2" xref="A1.E24.m1.4.4.1.1.2.3.2.cmml">λ</mi><mo lspace="0em" rspace="0em" id="A1.E24.m1.4.4.1.1.2.3.1" xref="A1.E24.m1.4.4.1.1.2.3.1.cmml">​</mo><mrow id="A1.E24.m1.4.4.1.1.2.3.3" xref="A1.E24.m1.4.4.1.1.2.3.3.cmml"><mstyle displaystyle="true" id="A1.E24.m1.4.4.1.1.2.3.3.1" xref="A1.E24.m1.4.4.1.1.2.3.3.1.cmml"><munder id="A1.E24.m1.4.4.1.1.2.3.3.1a" xref="A1.E24.m1.4.4.1.1.2.3.3.1.cmml"><mo movablelimits="false" id="A1.E24.m1.4.4.1.1.2.3.3.1.2" xref="A1.E24.m1.4.4.1.1.2.3.3.1.2.cmml">∑</mo><mi id="A1.E24.m1.4.4.1.1.2.3.3.1.3" xref="A1.E24.m1.4.4.1.1.2.3.3.1.3.cmml">g</mi></munder></mstyle><msqrt id="A1.E24.m1.1.1" xref="A1.E24.m1.1.1.cmml"><msubsup id="A1.E24.m1.1.1.1" xref="A1.E24.m1.1.1.1.cmml"><mrow id="A1.E24.m1.1.1.1.1.1.1" xref="A1.E24.m1.1.1.1.1.1.2.cmml"><mo stretchy="false" id="A1.E24.m1.1.1.1.1.1.1.2" xref="A1.E24.m1.1.1.1.1.1.2.1.cmml">‖</mo><msub id="A1.E24.m1.1.1.1.1.1.1.1" xref="A1.E24.m1.1.1.1.1.1.1.1.cmml"><mi id="A1.E24.m1.1.1.1.1.1.1.1.2" xref="A1.E24.m1.1.1.1.1.1.1.1.2.cmml">𝐰</mi><mi id="A1.E24.m1.1.1.1.1.1.1.1.3" xref="A1.E24.m1.1.1.1.1.1.1.1.3.cmml">g</mi></msub><mo stretchy="false" id="A1.E24.m1.1.1.1.1.1.1.3" xref="A1.E24.m1.1.1.1.1.1.2.1.cmml">‖</mo></mrow><mn id="A1.E24.m1.1.1.1.1.3" xref="A1.E24.m1.1.1.1.1.3.cmml">2</mn><mn id="A1.E24.m1.1.1.1.3" xref="A1.E24.m1.1.1.1.3.cmml">2</mn></msubsup></msqrt></mrow></mrow></mrow></mrow><mo id="A1.E24.m1.4.4.1.2" xref="A1.E24.m1.4.4.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="A1.E24.m1.4b"><apply id="A1.E24.m1.4.4.1.1.cmml" xref="A1.E24.m1.4.4.1"><csymbol cd="latexml" id="A1.E24.m1.4.4.1.1.3.cmml" xref="A1.E24.m1.4.4.1.1.3">assign</csymbol><apply id="A1.E24.m1.4.4.1.1.1.cmml" xref="A1.E24.m1.4.4.1.1.1"><times id="A1.E24.m1.4.4.1.1.1.2.cmml" xref="A1.E24.m1.4.4.1.1.1.2"></times><apply id="A1.E24.m1.4.4.1.1.1.3.cmml" xref="A1.E24.m1.4.4.1.1.1.3"><csymbol cd="ambiguous" id="A1.E24.m1.4.4.1.1.1.3.1.cmml" xref="A1.E24.m1.4.4.1.1.1.3">subscript</csymbol><ci id="A1.E24.m1.4.4.1.1.1.3.2.cmml" xref="A1.E24.m1.4.4.1.1.1.3.2">ℒ</ci><ci id="A1.E24.m1.4.4.1.1.1.3.3.cmml" xref="A1.E24.m1.4.4.1.1.1.3.3">𝑠</ci></apply><interval closure="open" id="A1.E24.m1.4.4.1.1.1.1.2.cmml" xref="A1.E24.m1.4.4.1.1.1.1.1"><apply id="A1.E24.m1.4.4.1.1.1.1.1.1.cmml" xref="A1.E24.m1.4.4.1.1.1.1.1.1"><csymbol cd="ambiguous" id="A1.E24.m1.4.4.1.1.1.1.1.1.1.cmml" xref="A1.E24.m1.4.4.1.1.1.1.1.1">subscript</csymbol><ci id="A1.E24.m1.4.4.1.1.1.1.1.1.2.cmml" xref="A1.E24.m1.4.4.1.1.1.1.1.1.2">𝒟</ci><ci id="A1.E24.m1.4.4.1.1.1.1.1.1.3.cmml" xref="A1.E24.m1.4.4.1.1.1.1.1.1.3">𝑠</ci></apply><ci id="A1.E24.m1.2.2.cmml" xref="A1.E24.m1.2.2">𝐰</ci></interval></apply><apply id="A1.E24.m1.4.4.1.1.2.cmml" xref="A1.E24.m1.4.4.1.1.2"><plus id="A1.E24.m1.4.4.1.1.2.2.cmml" xref="A1.E24.m1.4.4.1.1.2.2"></plus><apply id="A1.E24.m1.4.4.1.1.2.1.cmml" xref="A1.E24.m1.4.4.1.1.2.1"><times id="A1.E24.m1.4.4.1.1.2.1.2.cmml" xref="A1.E24.m1.4.4.1.1.2.1.2"></times><apply id="A1.E24.m1.4.4.1.1.2.1.3.cmml" xref="A1.E24.m1.4.4.1.1.2.1.3"><divide id="A1.E24.m1.4.4.1.1.2.1.3.1.cmml" xref="A1.E24.m1.4.4.1.1.2.1.3"></divide><cn type="integer" id="A1.E24.m1.4.4.1.1.2.1.3.2.cmml" xref="A1.E24.m1.4.4.1.1.2.1.3.2">1</cn><apply id="A1.E24.m1.4.4.1.1.2.1.3.3.cmml" xref="A1.E24.m1.4.4.1.1.2.1.3.3"><csymbol cd="ambiguous" id="A1.E24.m1.4.4.1.1.2.1.3.3.1.cmml" xref="A1.E24.m1.4.4.1.1.2.1.3.3">subscript</csymbol><ci id="A1.E24.m1.4.4.1.1.2.1.3.3.2.cmml" xref="A1.E24.m1.4.4.1.1.2.1.3.3.2">𝑁</ci><ci id="A1.E24.m1.4.4.1.1.2.1.3.3.3.cmml" xref="A1.E24.m1.4.4.1.1.2.1.3.3.3">𝑠</ci></apply></apply><apply id="A1.E24.m1.4.4.1.1.2.1.1.cmml" xref="A1.E24.m1.4.4.1.1.2.1.1"><apply id="A1.E24.m1.4.4.1.1.2.1.1.2.cmml" xref="A1.E24.m1.4.4.1.1.2.1.1.2"><csymbol cd="ambiguous" id="A1.E24.m1.4.4.1.1.2.1.1.2.1.cmml" xref="A1.E24.m1.4.4.1.1.2.1.1.2">superscript</csymbol><apply id="A1.E24.m1.4.4.1.1.2.1.1.2.2.cmml" xref="A1.E24.m1.4.4.1.1.2.1.1.2"><csymbol cd="ambiguous" id="A1.E24.m1.4.4.1.1.2.1.1.2.2.1.cmml" xref="A1.E24.m1.4.4.1.1.2.1.1.2">subscript</csymbol><sum id="A1.E24.m1.4.4.1.1.2.1.1.2.2.2.cmml" xref="A1.E24.m1.4.4.1.1.2.1.1.2.2.2"></sum><apply id="A1.E24.m1.4.4.1.1.2.1.1.2.2.3.cmml" xref="A1.E24.m1.4.4.1.1.2.1.1.2.2.3"><eq id="A1.E24.m1.4.4.1.1.2.1.1.2.2.3.1.cmml" xref="A1.E24.m1.4.4.1.1.2.1.1.2.2.3.1"></eq><ci id="A1.E24.m1.4.4.1.1.2.1.1.2.2.3.2.cmml" xref="A1.E24.m1.4.4.1.1.2.1.1.2.2.3.2">𝑖</ci><cn type="integer" id="A1.E24.m1.4.4.1.1.2.1.1.2.2.3.3.cmml" xref="A1.E24.m1.4.4.1.1.2.1.1.2.2.3.3">1</cn></apply></apply><apply id="A1.E24.m1.4.4.1.1.2.1.1.2.3.cmml" xref="A1.E24.m1.4.4.1.1.2.1.1.2.3"><csymbol cd="ambiguous" id="A1.E24.m1.4.4.1.1.2.1.1.2.3.1.cmml" xref="A1.E24.m1.4.4.1.1.2.1.1.2.3">subscript</csymbol><ci id="A1.E24.m1.4.4.1.1.2.1.1.2.3.2.cmml" xref="A1.E24.m1.4.4.1.1.2.1.1.2.3.2">𝑁</ci><ci id="A1.E24.m1.4.4.1.1.2.1.1.2.3.3.cmml" xref="A1.E24.m1.4.4.1.1.2.1.1.2.3.3">𝑠</ci></apply></apply><apply id="A1.E24.m1.4.4.1.1.2.1.1.1.cmml" xref="A1.E24.m1.4.4.1.1.2.1.1.1"><times id="A1.E24.m1.4.4.1.1.2.1.1.1.2.cmml" xref="A1.E24.m1.4.4.1.1.2.1.1.1.2"></times><ci id="A1.E24.m1.4.4.1.1.2.1.1.1.3.cmml" xref="A1.E24.m1.4.4.1.1.2.1.1.1.3">𝐿</ci><interval closure="open" id="A1.E24.m1.4.4.1.1.2.1.1.1.1.2.cmml" xref="A1.E24.m1.4.4.1.1.2.1.1.1.1.1"><apply id="A1.E24.m1.4.4.1.1.2.1.1.1.1.1.1.cmml" xref="A1.E24.m1.4.4.1.1.2.1.1.1.1.1.1"><csymbol cd="ambiguous" id="A1.E24.m1.4.4.1.1.2.1.1.1.1.1.1.1.cmml" xref="A1.E24.m1.4.4.1.1.2.1.1.1.1.1.1">subscript</csymbol><ci id="A1.E24.m1.4.4.1.1.2.1.1.1.1.1.1.2.cmml" xref="A1.E24.m1.4.4.1.1.2.1.1.1.1.1.1.2">𝒟</ci><apply id="A1.E24.m1.4.4.1.1.2.1.1.1.1.1.1.3.cmml" xref="A1.E24.m1.4.4.1.1.2.1.1.1.1.1.1.3"><times id="A1.E24.m1.4.4.1.1.2.1.1.1.1.1.1.3.1.cmml" xref="A1.E24.m1.4.4.1.1.2.1.1.1.1.1.1.3.1"></times><ci id="A1.E24.m1.4.4.1.1.2.1.1.1.1.1.1.3.2.cmml" xref="A1.E24.m1.4.4.1.1.2.1.1.1.1.1.1.3.2">𝑠</ci><ci id="A1.E24.m1.4.4.1.1.2.1.1.1.1.1.1.3.3.cmml" xref="A1.E24.m1.4.4.1.1.2.1.1.1.1.1.1.3.3">𝑖</ci></apply></apply><ci id="A1.E24.m1.3.3.cmml" xref="A1.E24.m1.3.3">𝐰</ci></interval></apply></apply></apply><apply id="A1.E24.m1.4.4.1.1.2.3.cmml" xref="A1.E24.m1.4.4.1.1.2.3"><times id="A1.E24.m1.4.4.1.1.2.3.1.cmml" xref="A1.E24.m1.4.4.1.1.2.3.1"></times><ci id="A1.E24.m1.4.4.1.1.2.3.2.cmml" xref="A1.E24.m1.4.4.1.1.2.3.2">𝜆</ci><apply id="A1.E24.m1.4.4.1.1.2.3.3.cmml" xref="A1.E24.m1.4.4.1.1.2.3.3"><apply id="A1.E24.m1.4.4.1.1.2.3.3.1.cmml" xref="A1.E24.m1.4.4.1.1.2.3.3.1"><csymbol cd="ambiguous" id="A1.E24.m1.4.4.1.1.2.3.3.1.1.cmml" xref="A1.E24.m1.4.4.1.1.2.3.3.1">subscript</csymbol><sum id="A1.E24.m1.4.4.1.1.2.3.3.1.2.cmml" xref="A1.E24.m1.4.4.1.1.2.3.3.1.2"></sum><ci id="A1.E24.m1.4.4.1.1.2.3.3.1.3.cmml" xref="A1.E24.m1.4.4.1.1.2.3.3.1.3">𝑔</ci></apply><apply id="A1.E24.m1.1.1.cmml" xref="A1.E24.m1.1.1"><root id="A1.E24.m1.1.1a.cmml" xref="A1.E24.m1.1.1"></root><apply id="A1.E24.m1.1.1.1.cmml" xref="A1.E24.m1.1.1.1"><csymbol cd="ambiguous" id="A1.E24.m1.1.1.1.2.cmml" xref="A1.E24.m1.1.1.1">superscript</csymbol><apply id="A1.E24.m1.1.1.1.1.cmml" xref="A1.E24.m1.1.1.1"><csymbol cd="ambiguous" id="A1.E24.m1.1.1.1.1.2.cmml" xref="A1.E24.m1.1.1.1">subscript</csymbol><apply id="A1.E24.m1.1.1.1.1.1.2.cmml" xref="A1.E24.m1.1.1.1.1.1.1"><csymbol cd="latexml" id="A1.E24.m1.1.1.1.1.1.2.1.cmml" xref="A1.E24.m1.1.1.1.1.1.1.2">norm</csymbol><apply id="A1.E24.m1.1.1.1.1.1.1.1.cmml" xref="A1.E24.m1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="A1.E24.m1.1.1.1.1.1.1.1.1.cmml" xref="A1.E24.m1.1.1.1.1.1.1.1">subscript</csymbol><ci id="A1.E24.m1.1.1.1.1.1.1.1.2.cmml" xref="A1.E24.m1.1.1.1.1.1.1.1.2">𝐰</ci><ci id="A1.E24.m1.1.1.1.1.1.1.1.3.cmml" xref="A1.E24.m1.1.1.1.1.1.1.1.3">𝑔</ci></apply></apply><cn type="integer" id="A1.E24.m1.1.1.1.1.3.cmml" xref="A1.E24.m1.1.1.1.1.3">2</cn></apply><cn type="integer" id="A1.E24.m1.1.1.1.3.cmml" xref="A1.E24.m1.1.1.1.3">2</cn></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.E24.m1.4c">\displaystyle\mathcal{L}_{s}(\mathcal{D}_{s},\mathbf{w}):=\frac{1}{N_{s}}\sum_{i=1}^{N_{s}}L(\mathcal{D}_{si},\mathbf{w})+\lambda\sum_{g}\sqrt{\|\mathbf{w}_{g}\|_{2}^{2}},</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(24)</span></td>
</tr></tbody>
</table>
<p id="A1.p4.3" class="ltx_p">where <math id="A1.p4.2.m1.1" class="ltx_Math" alttext="\mathbf{w}_{g}" display="inline"><semantics id="A1.p4.2.m1.1a"><msub id="A1.p4.2.m1.1.1" xref="A1.p4.2.m1.1.1.cmml"><mi id="A1.p4.2.m1.1.1.2" xref="A1.p4.2.m1.1.1.2.cmml">𝐰</mi><mi id="A1.p4.2.m1.1.1.3" xref="A1.p4.2.m1.1.1.3.cmml">g</mi></msub><annotation-xml encoding="MathML-Content" id="A1.p4.2.m1.1b"><apply id="A1.p4.2.m1.1.1.cmml" xref="A1.p4.2.m1.1.1"><csymbol cd="ambiguous" id="A1.p4.2.m1.1.1.1.cmml" xref="A1.p4.2.m1.1.1">subscript</csymbol><ci id="A1.p4.2.m1.1.1.2.cmml" xref="A1.p4.2.m1.1.1.2">𝐰</ci><ci id="A1.p4.2.m1.1.1.3.cmml" xref="A1.p4.2.m1.1.1.3">𝑔</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.p4.2.m1.1c">\mathbf{w}_{g}</annotation></semantics></math> was the vector of parameters associated with group <math id="A1.p4.3.m2.1" class="ltx_Math" alttext="g" display="inline"><semantics id="A1.p4.3.m2.1a"><mi id="A1.p4.3.m2.1.1" xref="A1.p4.3.m2.1.1.cmml">g</mi><annotation-xml encoding="MathML-Content" id="A1.p4.3.m2.1b"><ci id="A1.p4.3.m2.1.1.cmml" xref="A1.p4.3.m2.1.1">𝑔</ci></annotation-xml><annotation encoding="application/x-tex" id="A1.p4.3.m2.1c">g</annotation></semantics></math>. To have similar sparsity patterns to <span id="A1.p4.3.1" class="ltx_text ltx_font_typewriter">FedSparse</span>, each of the groups of parameters were chosen to be the weights associated with a specific neuron (in case of a fully connected layer) or a specific feature map (in case of a convolutional layer). In order to realize the sparse communication, we employed a thresholding operator before each client and the server communicated their parameters:</p>
<table id="A10.EGx22" class="ltx_equationgroup ltx_eqn_align ltx_eqn_table">

<tbody id="A1.E25"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math id="A1.E25.m1.4" class="ltx_Math" alttext="\displaystyle\hat{\mathbf{w}}_{g}=\mathbf{w}_{g}z_{g},\qquad z_{g}=\begin{cases}0,\enskip\text{if }\sqrt{\|\mathbf{w}_{g}\|_{2}^{2}}\leq\lambda\\
1,\enskip\text{otherwise}\end{cases}" display="inline"><semantics id="A1.E25.m1.4a"><mrow id="A1.E25.m1.4.4.2" xref="A1.E25.m1.4.4.3.cmml"><mrow id="A1.E25.m1.3.3.1.1" xref="A1.E25.m1.3.3.1.1.cmml"><msub id="A1.E25.m1.3.3.1.1.2" xref="A1.E25.m1.3.3.1.1.2.cmml"><mover accent="true" id="A1.E25.m1.3.3.1.1.2.2" xref="A1.E25.m1.3.3.1.1.2.2.cmml"><mi id="A1.E25.m1.3.3.1.1.2.2.2" xref="A1.E25.m1.3.3.1.1.2.2.2.cmml">𝐰</mi><mo id="A1.E25.m1.3.3.1.1.2.2.1" xref="A1.E25.m1.3.3.1.1.2.2.1.cmml">^</mo></mover><mi id="A1.E25.m1.3.3.1.1.2.3" xref="A1.E25.m1.3.3.1.1.2.3.cmml">g</mi></msub><mo id="A1.E25.m1.3.3.1.1.1" xref="A1.E25.m1.3.3.1.1.1.cmml">=</mo><mrow id="A1.E25.m1.3.3.1.1.3" xref="A1.E25.m1.3.3.1.1.3.cmml"><msub id="A1.E25.m1.3.3.1.1.3.2" xref="A1.E25.m1.3.3.1.1.3.2.cmml"><mi id="A1.E25.m1.3.3.1.1.3.2.2" xref="A1.E25.m1.3.3.1.1.3.2.2.cmml">𝐰</mi><mi id="A1.E25.m1.3.3.1.1.3.2.3" xref="A1.E25.m1.3.3.1.1.3.2.3.cmml">g</mi></msub><mo lspace="0em" rspace="0em" id="A1.E25.m1.3.3.1.1.3.1" xref="A1.E25.m1.3.3.1.1.3.1.cmml">​</mo><msub id="A1.E25.m1.3.3.1.1.3.3" xref="A1.E25.m1.3.3.1.1.3.3.cmml"><mi id="A1.E25.m1.3.3.1.1.3.3.2" xref="A1.E25.m1.3.3.1.1.3.3.2.cmml">z</mi><mi id="A1.E25.m1.3.3.1.1.3.3.3" xref="A1.E25.m1.3.3.1.1.3.3.3.cmml">g</mi></msub></mrow></mrow><mo rspace="2.167em" id="A1.E25.m1.4.4.2.3" xref="A1.E25.m1.4.4.3a.cmml">,</mo><mrow id="A1.E25.m1.4.4.2.2" xref="A1.E25.m1.4.4.2.2.cmml"><msub id="A1.E25.m1.4.4.2.2.2" xref="A1.E25.m1.4.4.2.2.2.cmml"><mi id="A1.E25.m1.4.4.2.2.2.2" xref="A1.E25.m1.4.4.2.2.2.2.cmml">z</mi><mi id="A1.E25.m1.4.4.2.2.2.3" xref="A1.E25.m1.4.4.2.2.2.3.cmml">g</mi></msub><mo id="A1.E25.m1.4.4.2.2.1" xref="A1.E25.m1.4.4.2.2.1.cmml">=</mo><mrow id="A1.E25.m1.2.2a" xref="A1.E25.m1.4.4.2.2.3.1.cmml"><mo id="A1.E25.m1.2.2a.3" xref="A1.E25.m1.4.4.2.2.3.1.1.cmml">{</mo><mtable columnspacing="5pt" rowspacing="0pt" id="A1.E25.m1.2.2.2a" xref="A1.E25.m1.4.4.2.2.3.1.cmml"><mtr id="A1.E25.m1.2.2.2aa" xref="A1.E25.m1.4.4.2.2.3.1.cmml"><mtd class="ltx_align_left" columnalign="left" id="A1.E25.m1.2.2.2ab" xref="A1.E25.m1.4.4.2.2.3.1.cmml"><mrow id="A1.E25.m1.1.1.1.1.1.1" xref="A1.E25.m1.1.1.1.1.1.1.cmml"><mrow id="A1.E25.m1.1.1.1.1.1.1.3.1" xref="A1.E25.m1.1.1.1.1.1.1.3.2.cmml"><mn id="A1.E25.m1.1.1.1.1.1.1.2" xref="A1.E25.m1.1.1.1.1.1.1.2.cmml">0</mn><mo rspace="0.667em" id="A1.E25.m1.1.1.1.1.1.1.3.1.2" xref="A1.E25.m1.1.1.1.1.1.1.3.2.cmml">,</mo><mrow id="A1.E25.m1.1.1.1.1.1.1.3.1.1" xref="A1.E25.m1.1.1.1.1.1.1.3.1.1.cmml"><mtext id="A1.E25.m1.1.1.1.1.1.1.3.1.1.2" xref="A1.E25.m1.1.1.1.1.1.1.3.1.1.2a.cmml">if </mtext><mo lspace="0em" rspace="0em" id="A1.E25.m1.1.1.1.1.1.1.3.1.1.1" xref="A1.E25.m1.1.1.1.1.1.1.3.1.1.1.cmml">​</mo><msqrt id="A1.E25.m1.1.1.1.1.1.1.1" xref="A1.E25.m1.1.1.1.1.1.1.1.cmml"><msubsup id="A1.E25.m1.1.1.1.1.1.1.1.1" xref="A1.E25.m1.1.1.1.1.1.1.1.1.cmml"><mrow id="A1.E25.m1.1.1.1.1.1.1.1.1.1.1.1" xref="A1.E25.m1.1.1.1.1.1.1.1.1.1.1.2.cmml"><mo stretchy="false" id="A1.E25.m1.1.1.1.1.1.1.1.1.1.1.1.2" xref="A1.E25.m1.1.1.1.1.1.1.1.1.1.1.2.1.cmml">‖</mo><msub id="A1.E25.m1.1.1.1.1.1.1.1.1.1.1.1.1" xref="A1.E25.m1.1.1.1.1.1.1.1.1.1.1.1.1.cmml"><mi id="A1.E25.m1.1.1.1.1.1.1.1.1.1.1.1.1.2" xref="A1.E25.m1.1.1.1.1.1.1.1.1.1.1.1.1.2.cmml">𝐰</mi><mi id="A1.E25.m1.1.1.1.1.1.1.1.1.1.1.1.1.3" xref="A1.E25.m1.1.1.1.1.1.1.1.1.1.1.1.1.3.cmml">g</mi></msub><mo stretchy="false" id="A1.E25.m1.1.1.1.1.1.1.1.1.1.1.1.3" xref="A1.E25.m1.1.1.1.1.1.1.1.1.1.1.2.1.cmml">‖</mo></mrow><mn id="A1.E25.m1.1.1.1.1.1.1.1.1.1.3" xref="A1.E25.m1.1.1.1.1.1.1.1.1.1.3.cmml">2</mn><mn id="A1.E25.m1.1.1.1.1.1.1.1.1.3" xref="A1.E25.m1.1.1.1.1.1.1.1.1.3.cmml">2</mn></msubsup></msqrt></mrow></mrow><mo id="A1.E25.m1.1.1.1.1.1.1.4" xref="A1.E25.m1.1.1.1.1.1.1.4.cmml">≤</mo><mi id="A1.E25.m1.1.1.1.1.1.1.5" xref="A1.E25.m1.1.1.1.1.1.1.5.cmml">λ</mi></mrow></mtd><mtd id="A1.E25.m1.2.2.2ac" xref="A1.E25.m1.4.4.2.2.3.1.1.cmml"></mtd></mtr><mtr id="A1.E25.m1.2.2.2ad" xref="A1.E25.m1.4.4.2.2.3.1.cmml"><mtd class="ltx_align_left" columnalign="left" id="A1.E25.m1.2.2.2ae" xref="A1.E25.m1.4.4.2.2.3.1.cmml"><mrow id="A1.E25.m1.2.2.2.2.1.1.4" xref="A1.E25.m1.2.2.2.2.1.1.3.cmml"><mn id="A1.E25.m1.2.2.2.2.1.1.1" xref="A1.E25.m1.2.2.2.2.1.1.1.cmml">1</mn><mo rspace="0.667em" id="A1.E25.m1.2.2.2.2.1.1.4.1" xref="A1.E25.m1.2.2.2.2.1.1.3.cmml">,</mo><mtext id="A1.E25.m1.2.2.2.2.1.1.2" xref="A1.E25.m1.2.2.2.2.1.1.2a.cmml">otherwise</mtext></mrow></mtd><mtd id="A1.E25.m1.2.2.2af" xref="A1.E25.m1.4.4.2.2.3.1.1.cmml"></mtd></mtr></mtable></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="A1.E25.m1.4b"><apply id="A1.E25.m1.4.4.3.cmml" xref="A1.E25.m1.4.4.2"><csymbol cd="ambiguous" id="A1.E25.m1.4.4.3a.cmml" xref="A1.E25.m1.4.4.2.3">formulae-sequence</csymbol><apply id="A1.E25.m1.3.3.1.1.cmml" xref="A1.E25.m1.3.3.1.1"><eq id="A1.E25.m1.3.3.1.1.1.cmml" xref="A1.E25.m1.3.3.1.1.1"></eq><apply id="A1.E25.m1.3.3.1.1.2.cmml" xref="A1.E25.m1.3.3.1.1.2"><csymbol cd="ambiguous" id="A1.E25.m1.3.3.1.1.2.1.cmml" xref="A1.E25.m1.3.3.1.1.2">subscript</csymbol><apply id="A1.E25.m1.3.3.1.1.2.2.cmml" xref="A1.E25.m1.3.3.1.1.2.2"><ci id="A1.E25.m1.3.3.1.1.2.2.1.cmml" xref="A1.E25.m1.3.3.1.1.2.2.1">^</ci><ci id="A1.E25.m1.3.3.1.1.2.2.2.cmml" xref="A1.E25.m1.3.3.1.1.2.2.2">𝐰</ci></apply><ci id="A1.E25.m1.3.3.1.1.2.3.cmml" xref="A1.E25.m1.3.3.1.1.2.3">𝑔</ci></apply><apply id="A1.E25.m1.3.3.1.1.3.cmml" xref="A1.E25.m1.3.3.1.1.3"><times id="A1.E25.m1.3.3.1.1.3.1.cmml" xref="A1.E25.m1.3.3.1.1.3.1"></times><apply id="A1.E25.m1.3.3.1.1.3.2.cmml" xref="A1.E25.m1.3.3.1.1.3.2"><csymbol cd="ambiguous" id="A1.E25.m1.3.3.1.1.3.2.1.cmml" xref="A1.E25.m1.3.3.1.1.3.2">subscript</csymbol><ci id="A1.E25.m1.3.3.1.1.3.2.2.cmml" xref="A1.E25.m1.3.3.1.1.3.2.2">𝐰</ci><ci id="A1.E25.m1.3.3.1.1.3.2.3.cmml" xref="A1.E25.m1.3.3.1.1.3.2.3">𝑔</ci></apply><apply id="A1.E25.m1.3.3.1.1.3.3.cmml" xref="A1.E25.m1.3.3.1.1.3.3"><csymbol cd="ambiguous" id="A1.E25.m1.3.3.1.1.3.3.1.cmml" xref="A1.E25.m1.3.3.1.1.3.3">subscript</csymbol><ci id="A1.E25.m1.3.3.1.1.3.3.2.cmml" xref="A1.E25.m1.3.3.1.1.3.3.2">𝑧</ci><ci id="A1.E25.m1.3.3.1.1.3.3.3.cmml" xref="A1.E25.m1.3.3.1.1.3.3.3">𝑔</ci></apply></apply></apply><apply id="A1.E25.m1.4.4.2.2.cmml" xref="A1.E25.m1.4.4.2.2"><eq id="A1.E25.m1.4.4.2.2.1.cmml" xref="A1.E25.m1.4.4.2.2.1"></eq><apply id="A1.E25.m1.4.4.2.2.2.cmml" xref="A1.E25.m1.4.4.2.2.2"><csymbol cd="ambiguous" id="A1.E25.m1.4.4.2.2.2.1.cmml" xref="A1.E25.m1.4.4.2.2.2">subscript</csymbol><ci id="A1.E25.m1.4.4.2.2.2.2.cmml" xref="A1.E25.m1.4.4.2.2.2.2">𝑧</ci><ci id="A1.E25.m1.4.4.2.2.2.3.cmml" xref="A1.E25.m1.4.4.2.2.2.3">𝑔</ci></apply><apply id="A1.E25.m1.4.4.2.2.3.1.cmml" xref="A1.E25.m1.2.2a"><csymbol cd="latexml" id="A1.E25.m1.4.4.2.2.3.1.1.cmml" xref="A1.E25.m1.2.2a.3">cases</csymbol><apply id="A1.E25.m1.1.1.1.1.1.1.cmml" xref="A1.E25.m1.1.1.1.1.1.1"><leq id="A1.E25.m1.1.1.1.1.1.1.4.cmml" xref="A1.E25.m1.1.1.1.1.1.1.4"></leq><list id="A1.E25.m1.1.1.1.1.1.1.3.2.cmml" xref="A1.E25.m1.1.1.1.1.1.1.3.1"><cn type="integer" id="A1.E25.m1.1.1.1.1.1.1.2.cmml" xref="A1.E25.m1.1.1.1.1.1.1.2">0</cn><apply id="A1.E25.m1.1.1.1.1.1.1.3.1.1.cmml" xref="A1.E25.m1.1.1.1.1.1.1.3.1.1"><times id="A1.E25.m1.1.1.1.1.1.1.3.1.1.1.cmml" xref="A1.E25.m1.1.1.1.1.1.1.3.1.1.1"></times><ci id="A1.E25.m1.1.1.1.1.1.1.3.1.1.2a.cmml" xref="A1.E25.m1.1.1.1.1.1.1.3.1.1.2"><mtext id="A1.E25.m1.1.1.1.1.1.1.3.1.1.2.cmml" xref="A1.E25.m1.1.1.1.1.1.1.3.1.1.2">if </mtext></ci><apply id="A1.E25.m1.1.1.1.1.1.1.1.cmml" xref="A1.E25.m1.1.1.1.1.1.1.1"><root id="A1.E25.m1.1.1.1.1.1.1.1a.cmml" xref="A1.E25.m1.1.1.1.1.1.1.1"></root><apply id="A1.E25.m1.1.1.1.1.1.1.1.1.cmml" xref="A1.E25.m1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="A1.E25.m1.1.1.1.1.1.1.1.1.2.cmml" xref="A1.E25.m1.1.1.1.1.1.1.1.1">superscript</csymbol><apply id="A1.E25.m1.1.1.1.1.1.1.1.1.1.cmml" xref="A1.E25.m1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="A1.E25.m1.1.1.1.1.1.1.1.1.1.2.cmml" xref="A1.E25.m1.1.1.1.1.1.1.1.1">subscript</csymbol><apply id="A1.E25.m1.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="A1.E25.m1.1.1.1.1.1.1.1.1.1.1.1"><csymbol cd="latexml" id="A1.E25.m1.1.1.1.1.1.1.1.1.1.1.2.1.cmml" xref="A1.E25.m1.1.1.1.1.1.1.1.1.1.1.1.2">norm</csymbol><apply id="A1.E25.m1.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="A1.E25.m1.1.1.1.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="A1.E25.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="A1.E25.m1.1.1.1.1.1.1.1.1.1.1.1.1">subscript</csymbol><ci id="A1.E25.m1.1.1.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="A1.E25.m1.1.1.1.1.1.1.1.1.1.1.1.1.2">𝐰</ci><ci id="A1.E25.m1.1.1.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="A1.E25.m1.1.1.1.1.1.1.1.1.1.1.1.1.3">𝑔</ci></apply></apply><cn type="integer" id="A1.E25.m1.1.1.1.1.1.1.1.1.1.3.cmml" xref="A1.E25.m1.1.1.1.1.1.1.1.1.1.3">2</cn></apply><cn type="integer" id="A1.E25.m1.1.1.1.1.1.1.1.1.3.cmml" xref="A1.E25.m1.1.1.1.1.1.1.1.1.3">2</cn></apply></apply></apply></list><ci id="A1.E25.m1.1.1.1.1.1.1.5.cmml" xref="A1.E25.m1.1.1.1.1.1.1.5">𝜆</ci></apply><ci id="A1.E25.m1.4.4.2.2.3.1.3a.cmml" xref="A1.E25.m1.2.2a"><mtext class="ltx_mathvariant_italic" id="A1.E25.m1.4.4.2.2.3.1.3.cmml" xref="A1.E25.m1.2.2a.3">otherwise</mtext></ci><list id="A1.E25.m1.2.2.2.2.1.1.3.cmml" xref="A1.E25.m1.2.2.2.2.1.1.4"><cn type="integer" id="A1.E25.m1.2.2.2.2.1.1.1.cmml" xref="A1.E25.m1.2.2.2.2.1.1.1">1</cn><ci id="A1.E25.m1.2.2.2.2.1.1.2a.cmml" xref="A1.E25.m1.2.2.2.2.1.1.2"><mtext id="A1.E25.m1.2.2.2.2.1.1.2.cmml" xref="A1.E25.m1.2.2.2.2.1.1.2">otherwise</mtext></ci></list><ci id="A1.E25.m1.4.4.2.2.3.1.5a.cmml" xref="A1.E25.m1.2.2a"><mtext class="ltx_mathvariant_italic" id="A1.E25.m1.4.4.2.2.3.1.5.cmml" xref="A1.E25.m1.2.2a.3">otherwise</mtext></ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.E25.m1.4c">\displaystyle\hat{\mathbf{w}}_{g}=\mathbf{w}_{g}z_{g},\qquad z_{g}=\begin{cases}0,\enskip\text{if }\sqrt{\|\mathbf{w}_{g}\|_{2}^{2}}\leq\lambda\\
1,\enskip\text{otherwise}\end{cases}</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(25)</span></td>
</tr></tbody>
</table>
<p id="A1.p4.5" class="ltx_p">We empirically found that this operator resulted into better overall model performance, compared to the more traditional soft-thresholding one, which also “shrinks” the non-pruned parameters. The server used the traditional parameter difference between the communicated, sparse, local model and the current server model for gradient based optimization. To obtain the results in the main text, we used <math id="A1.p4.4.m1.1" class="ltx_Math" alttext="\lambda=2e-3" display="inline"><semantics id="A1.p4.4.m1.1a"><mrow id="A1.p4.4.m1.1.1" xref="A1.p4.4.m1.1.1.cmml"><mi id="A1.p4.4.m1.1.1.2" xref="A1.p4.4.m1.1.1.2.cmml">λ</mi><mo id="A1.p4.4.m1.1.1.1" xref="A1.p4.4.m1.1.1.1.cmml">=</mo><mrow id="A1.p4.4.m1.1.1.3" xref="A1.p4.4.m1.1.1.3.cmml"><mrow id="A1.p4.4.m1.1.1.3.2" xref="A1.p4.4.m1.1.1.3.2.cmml"><mn id="A1.p4.4.m1.1.1.3.2.2" xref="A1.p4.4.m1.1.1.3.2.2.cmml">2</mn><mo lspace="0em" rspace="0em" id="A1.p4.4.m1.1.1.3.2.1" xref="A1.p4.4.m1.1.1.3.2.1.cmml">​</mo><mi id="A1.p4.4.m1.1.1.3.2.3" xref="A1.p4.4.m1.1.1.3.2.3.cmml">e</mi></mrow><mo id="A1.p4.4.m1.1.1.3.1" xref="A1.p4.4.m1.1.1.3.1.cmml">−</mo><mn id="A1.p4.4.m1.1.1.3.3" xref="A1.p4.4.m1.1.1.3.3.cmml">3</mn></mrow></mrow><annotation-xml encoding="MathML-Content" id="A1.p4.4.m1.1b"><apply id="A1.p4.4.m1.1.1.cmml" xref="A1.p4.4.m1.1.1"><eq id="A1.p4.4.m1.1.1.1.cmml" xref="A1.p4.4.m1.1.1.1"></eq><ci id="A1.p4.4.m1.1.1.2.cmml" xref="A1.p4.4.m1.1.1.2">𝜆</ci><apply id="A1.p4.4.m1.1.1.3.cmml" xref="A1.p4.4.m1.1.1.3"><minus id="A1.p4.4.m1.1.1.3.1.cmml" xref="A1.p4.4.m1.1.1.3.1"></minus><apply id="A1.p4.4.m1.1.1.3.2.cmml" xref="A1.p4.4.m1.1.1.3.2"><times id="A1.p4.4.m1.1.1.3.2.1.cmml" xref="A1.p4.4.m1.1.1.3.2.1"></times><cn type="integer" id="A1.p4.4.m1.1.1.3.2.2.cmml" xref="A1.p4.4.m1.1.1.3.2.2">2</cn><ci id="A1.p4.4.m1.1.1.3.2.3.cmml" xref="A1.p4.4.m1.1.1.3.2.3">𝑒</ci></apply><cn type="integer" id="A1.p4.4.m1.1.1.3.3.cmml" xref="A1.p4.4.m1.1.1.3.3">3</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.p4.4.m1.1c">\lambda=2e-3</annotation></semantics></math> for CIFAR10 and CIFAR100, whereas for Femnist we used <math id="A1.p4.5.m2.1" class="ltx_Math" alttext="\lambda=1e-3" display="inline"><semantics id="A1.p4.5.m2.1a"><mrow id="A1.p4.5.m2.1.1" xref="A1.p4.5.m2.1.1.cmml"><mi id="A1.p4.5.m2.1.1.2" xref="A1.p4.5.m2.1.1.2.cmml">λ</mi><mo id="A1.p4.5.m2.1.1.1" xref="A1.p4.5.m2.1.1.1.cmml">=</mo><mrow id="A1.p4.5.m2.1.1.3" xref="A1.p4.5.m2.1.1.3.cmml"><mrow id="A1.p4.5.m2.1.1.3.2" xref="A1.p4.5.m2.1.1.3.2.cmml"><mn id="A1.p4.5.m2.1.1.3.2.2" xref="A1.p4.5.m2.1.1.3.2.2.cmml">1</mn><mo lspace="0em" rspace="0em" id="A1.p4.5.m2.1.1.3.2.1" xref="A1.p4.5.m2.1.1.3.2.1.cmml">​</mo><mi id="A1.p4.5.m2.1.1.3.2.3" xref="A1.p4.5.m2.1.1.3.2.3.cmml">e</mi></mrow><mo id="A1.p4.5.m2.1.1.3.1" xref="A1.p4.5.m2.1.1.3.1.cmml">−</mo><mn id="A1.p4.5.m2.1.1.3.3" xref="A1.p4.5.m2.1.1.3.3.cmml">3</mn></mrow></mrow><annotation-xml encoding="MathML-Content" id="A1.p4.5.m2.1b"><apply id="A1.p4.5.m2.1.1.cmml" xref="A1.p4.5.m2.1.1"><eq id="A1.p4.5.m2.1.1.1.cmml" xref="A1.p4.5.m2.1.1.1"></eq><ci id="A1.p4.5.m2.1.1.2.cmml" xref="A1.p4.5.m2.1.1.2">𝜆</ci><apply id="A1.p4.5.m2.1.1.3.cmml" xref="A1.p4.5.m2.1.1.3"><minus id="A1.p4.5.m2.1.1.3.1.cmml" xref="A1.p4.5.m2.1.1.3.1"></minus><apply id="A1.p4.5.m2.1.1.3.2.cmml" xref="A1.p4.5.m2.1.1.3.2"><times id="A1.p4.5.m2.1.1.3.2.1.cmml" xref="A1.p4.5.m2.1.1.3.2.1"></times><cn type="integer" id="A1.p4.5.m2.1.1.3.2.2.cmml" xref="A1.p4.5.m2.1.1.3.2.2">1</cn><ci id="A1.p4.5.m2.1.1.3.2.3.cmml" xref="A1.p4.5.m2.1.1.3.2.3">𝑒</ci></apply><cn type="integer" id="A1.p4.5.m2.1.1.3.3.cmml" xref="A1.p4.5.m2.1.1.3.3">3</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.p4.5.m2.1c">\lambda=1e-3</annotation></semantics></math>. These values were chosen so that we obtain comparable sparsities to the ones from <span id="A1.p4.5.1" class="ltx_text ltx_font_typewriter">FedSparse</span>.</p>
</div>
<div id="A1.p5" class="ltx_para">
<p id="A1.p5.1" class="ltx_p">Most of the experiments were run on an Nvidia RTX 2080Ti GPU, and the hyperparameter optimization was performed with several Nvidia V100 GPU’s on an internal cluster over the span of a month.</p>
</div>
</section>
<section id="A2" class="ltx_appendix">
<h2 class="ltx_title ltx_title_appendix">
<span class="ltx_tag ltx_tag_appendix">Appendix B </span>Evolution of sparsity</h2>

<div id="A2.p1" class="ltx_para">
<p id="A2.p1.1" class="ltx_p">We show the evolution of the sparsity ratios for all tasks and configurations in the following plot. We can see that in all settings the model attains its final sparsity quite early in training (i.e., before <math id="A2.p1.1.m1.1" class="ltx_Math" alttext="100" display="inline"><semantics id="A2.p1.1.m1.1a"><mn id="A2.p1.1.m1.1.1" xref="A2.p1.1.m1.1.1.cmml">100</mn><annotation-xml encoding="MathML-Content" id="A2.p1.1.m1.1b"><cn type="integer" id="A2.p1.1.m1.1.1.cmml" xref="A2.p1.1.m1.1.1">100</cn></annotation-xml><annotation encoding="application/x-tex" id="A2.p1.1.m1.1c">100</annotation></semantics></math> rounds) in the case of <span id="A2.p1.1.1" class="ltx_text ltx_font_typewriter">FedSparse</span> whereas with <span id="A2.p1.1.2" class="ltx_text ltx_font_typewriter">FedL1</span> the sparsity is achieved much later in training. As a result, the communication savings (of the overall training procedure) with <span id="A2.p1.1.3" class="ltx_text ltx_font_typewriter">FedL1</span> are not as much as the ones from <span id="A2.p1.1.4" class="ltx_text ltx_font_typewriter">FedSparse</span>.</p>
</div>
<figure id="A2.fig1" class="ltx_figure">
<div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_3">
<figure id="A2.F4.sf1" class="ltx_figure ltx_figure_panel"><img src="/html/2111.10192/assets/figures/sparsity_c10.png" id="A2.F4.sf1.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="598" height="424" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span id="A2.F4.sf1.2.1.1" class="ltx_text" style="font-size:90%;">(a)</span> </span><span id="A2.F4.sf1.3.2" class="ltx_text" style="font-size:90%;">CIFAR10 sparsity</span></figcaption>
</figure>
</div>
<div class="ltx_flex_cell ltx_flex_size_3">
<figure id="A2.F4.sf2" class="ltx_figure ltx_figure_panel"><img src="/html/2111.10192/assets/figures/sparsity_c100.png" id="A2.F4.sf2.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="598" height="424" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span id="A2.F4.sf2.2.1.1" class="ltx_text" style="font-size:90%;">(b)</span> </span><span id="A2.F4.sf2.3.2" class="ltx_text" style="font-size:90%;">CIFAR100 sparsity</span></figcaption>
</figure>
</div>
<div class="ltx_flex_cell ltx_flex_size_3">
<figure id="A2.F4.sf3" class="ltx_figure ltx_figure_panel"><img src="/html/2111.10192/assets/figures/sparsity_femnist.png" id="A2.F4.sf3.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="598" height="424" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span id="A2.F4.sf3.2.1.1" class="ltx_text" style="font-size:90%;">(c)</span> </span><span id="A2.F4.sf3.3.2" class="ltx_text" style="font-size:90%;">Femnist sparsity</span></figcaption>
</figure>
</div>
</div>
</figure>
</section>
<section id="A3" class="ltx_appendix">
<h2 class="ltx_title ltx_title_appendix">
<span class="ltx_tag ltx_tag_appendix">Appendix C </span>Sparsity alignment between clients and server</h2>

<div id="A3.p1" class="ltx_para">
<p id="A3.p1.1" class="ltx_p">A reasonable question to ask is whether the local sparsity patterns between clients “align”; if the clients do not agree on which parameters to prune, the server model will not be sparse and therefore we won’t get as much communication cost benefit. To test where such an issue happens in practice with <span id="A3.p1.1.1" class="ltx_text ltx_font_typewriter">FedSparse</span> we implemented two metrics that track the average and maximum total variation distance between the gating distributions (<em id="A3.p1.1.2" class="ltx_emph ltx_font_italic">i.e.</em>, those that control the sparsity patterns) of the clients and the server. The total variation distance corresponds to the absolute difference between the client and server probabilities for the binary gates, <em id="A3.p1.1.3" class="ltx_emph ltx_font_italic">i.e.</em>,</p>
<table id="A10.EGx23" class="ltx_equationgroup ltx_eqn_align ltx_eqn_table">

<tbody id="A3.E26"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math id="A3.E26.m1.4" class="ltx_Math" alttext="\displaystyle\text{TV}\left(q_{\pi_{s}}(z_{s}),p_{\theta}(z_{s})\right)=\left|q_{\pi_{s}}(z_{s}=1)-p_{\theta}(z_{s}=1)\right|=\left|\pi_{s}-\theta\right|" display="inline"><semantics id="A3.E26.m1.4a"><mrow id="A3.E26.m1.4.4" xref="A3.E26.m1.4.4.cmml"><mrow id="A3.E26.m1.2.2.2" xref="A3.E26.m1.2.2.2.cmml"><mtext id="A3.E26.m1.2.2.2.4" xref="A3.E26.m1.2.2.2.4a.cmml">TV</mtext><mo lspace="0em" rspace="0em" id="A3.E26.m1.2.2.2.3" xref="A3.E26.m1.2.2.2.3.cmml">​</mo><mrow id="A3.E26.m1.2.2.2.2.2" xref="A3.E26.m1.2.2.2.2.3.cmml"><mo id="A3.E26.m1.2.2.2.2.2.3" xref="A3.E26.m1.2.2.2.2.3.cmml">(</mo><mrow id="A3.E26.m1.1.1.1.1.1.1" xref="A3.E26.m1.1.1.1.1.1.1.cmml"><msub id="A3.E26.m1.1.1.1.1.1.1.3" xref="A3.E26.m1.1.1.1.1.1.1.3.cmml"><mi id="A3.E26.m1.1.1.1.1.1.1.3.2" xref="A3.E26.m1.1.1.1.1.1.1.3.2.cmml">q</mi><msub id="A3.E26.m1.1.1.1.1.1.1.3.3" xref="A3.E26.m1.1.1.1.1.1.1.3.3.cmml"><mi id="A3.E26.m1.1.1.1.1.1.1.3.3.2" xref="A3.E26.m1.1.1.1.1.1.1.3.3.2.cmml">π</mi><mi id="A3.E26.m1.1.1.1.1.1.1.3.3.3" xref="A3.E26.m1.1.1.1.1.1.1.3.3.3.cmml">s</mi></msub></msub><mo lspace="0em" rspace="0em" id="A3.E26.m1.1.1.1.1.1.1.2" xref="A3.E26.m1.1.1.1.1.1.1.2.cmml">​</mo><mrow id="A3.E26.m1.1.1.1.1.1.1.1.1" xref="A3.E26.m1.1.1.1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="A3.E26.m1.1.1.1.1.1.1.1.1.2" xref="A3.E26.m1.1.1.1.1.1.1.1.1.1.cmml">(</mo><msub id="A3.E26.m1.1.1.1.1.1.1.1.1.1" xref="A3.E26.m1.1.1.1.1.1.1.1.1.1.cmml"><mi id="A3.E26.m1.1.1.1.1.1.1.1.1.1.2" xref="A3.E26.m1.1.1.1.1.1.1.1.1.1.2.cmml">z</mi><mi id="A3.E26.m1.1.1.1.1.1.1.1.1.1.3" xref="A3.E26.m1.1.1.1.1.1.1.1.1.1.3.cmml">s</mi></msub><mo stretchy="false" id="A3.E26.m1.1.1.1.1.1.1.1.1.3" xref="A3.E26.m1.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="A3.E26.m1.2.2.2.2.2.4" xref="A3.E26.m1.2.2.2.2.3.cmml">,</mo><mrow id="A3.E26.m1.2.2.2.2.2.2" xref="A3.E26.m1.2.2.2.2.2.2.cmml"><msub id="A3.E26.m1.2.2.2.2.2.2.3" xref="A3.E26.m1.2.2.2.2.2.2.3.cmml"><mi id="A3.E26.m1.2.2.2.2.2.2.3.2" xref="A3.E26.m1.2.2.2.2.2.2.3.2.cmml">p</mi><mi id="A3.E26.m1.2.2.2.2.2.2.3.3" xref="A3.E26.m1.2.2.2.2.2.2.3.3.cmml">θ</mi></msub><mo lspace="0em" rspace="0em" id="A3.E26.m1.2.2.2.2.2.2.2" xref="A3.E26.m1.2.2.2.2.2.2.2.cmml">​</mo><mrow id="A3.E26.m1.2.2.2.2.2.2.1.1" xref="A3.E26.m1.2.2.2.2.2.2.1.1.1.cmml"><mo stretchy="false" id="A3.E26.m1.2.2.2.2.2.2.1.1.2" xref="A3.E26.m1.2.2.2.2.2.2.1.1.1.cmml">(</mo><msub id="A3.E26.m1.2.2.2.2.2.2.1.1.1" xref="A3.E26.m1.2.2.2.2.2.2.1.1.1.cmml"><mi id="A3.E26.m1.2.2.2.2.2.2.1.1.1.2" xref="A3.E26.m1.2.2.2.2.2.2.1.1.1.2.cmml">z</mi><mi id="A3.E26.m1.2.2.2.2.2.2.1.1.1.3" xref="A3.E26.m1.2.2.2.2.2.2.1.1.1.3.cmml">s</mi></msub><mo stretchy="false" id="A3.E26.m1.2.2.2.2.2.2.1.1.3" xref="A3.E26.m1.2.2.2.2.2.2.1.1.1.cmml">)</mo></mrow></mrow><mo id="A3.E26.m1.2.2.2.2.2.5" xref="A3.E26.m1.2.2.2.2.3.cmml">)</mo></mrow></mrow><mo id="A3.E26.m1.4.4.6" xref="A3.E26.m1.4.4.6.cmml">=</mo><mrow id="A3.E26.m1.3.3.3.1" xref="A3.E26.m1.3.3.3.2.cmml"><mo id="A3.E26.m1.3.3.3.1.2" xref="A3.E26.m1.3.3.3.2.1.cmml">|</mo><mrow id="A3.E26.m1.3.3.3.1.1" xref="A3.E26.m1.3.3.3.1.1.cmml"><mrow id="A3.E26.m1.3.3.3.1.1.1" xref="A3.E26.m1.3.3.3.1.1.1.cmml"><msub id="A3.E26.m1.3.3.3.1.1.1.3" xref="A3.E26.m1.3.3.3.1.1.1.3.cmml"><mi id="A3.E26.m1.3.3.3.1.1.1.3.2" xref="A3.E26.m1.3.3.3.1.1.1.3.2.cmml">q</mi><msub id="A3.E26.m1.3.3.3.1.1.1.3.3" xref="A3.E26.m1.3.3.3.1.1.1.3.3.cmml"><mi id="A3.E26.m1.3.3.3.1.1.1.3.3.2" xref="A3.E26.m1.3.3.3.1.1.1.3.3.2.cmml">π</mi><mi id="A3.E26.m1.3.3.3.1.1.1.3.3.3" xref="A3.E26.m1.3.3.3.1.1.1.3.3.3.cmml">s</mi></msub></msub><mo lspace="0em" rspace="0em" id="A3.E26.m1.3.3.3.1.1.1.2" xref="A3.E26.m1.3.3.3.1.1.1.2.cmml">​</mo><mrow id="A3.E26.m1.3.3.3.1.1.1.1.1" xref="A3.E26.m1.3.3.3.1.1.1.1.1.1.cmml"><mo stretchy="false" id="A3.E26.m1.3.3.3.1.1.1.1.1.2" xref="A3.E26.m1.3.3.3.1.1.1.1.1.1.cmml">(</mo><mrow id="A3.E26.m1.3.3.3.1.1.1.1.1.1" xref="A3.E26.m1.3.3.3.1.1.1.1.1.1.cmml"><msub id="A3.E26.m1.3.3.3.1.1.1.1.1.1.2" xref="A3.E26.m1.3.3.3.1.1.1.1.1.1.2.cmml"><mi id="A3.E26.m1.3.3.3.1.1.1.1.1.1.2.2" xref="A3.E26.m1.3.3.3.1.1.1.1.1.1.2.2.cmml">z</mi><mi id="A3.E26.m1.3.3.3.1.1.1.1.1.1.2.3" xref="A3.E26.m1.3.3.3.1.1.1.1.1.1.2.3.cmml">s</mi></msub><mo id="A3.E26.m1.3.3.3.1.1.1.1.1.1.1" xref="A3.E26.m1.3.3.3.1.1.1.1.1.1.1.cmml">=</mo><mn id="A3.E26.m1.3.3.3.1.1.1.1.1.1.3" xref="A3.E26.m1.3.3.3.1.1.1.1.1.1.3.cmml">1</mn></mrow><mo stretchy="false" id="A3.E26.m1.3.3.3.1.1.1.1.1.3" xref="A3.E26.m1.3.3.3.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="A3.E26.m1.3.3.3.1.1.3" xref="A3.E26.m1.3.3.3.1.1.3.cmml">−</mo><mrow id="A3.E26.m1.3.3.3.1.1.2" xref="A3.E26.m1.3.3.3.1.1.2.cmml"><msub id="A3.E26.m1.3.3.3.1.1.2.3" xref="A3.E26.m1.3.3.3.1.1.2.3.cmml"><mi id="A3.E26.m1.3.3.3.1.1.2.3.2" xref="A3.E26.m1.3.3.3.1.1.2.3.2.cmml">p</mi><mi id="A3.E26.m1.3.3.3.1.1.2.3.3" xref="A3.E26.m1.3.3.3.1.1.2.3.3.cmml">θ</mi></msub><mo lspace="0em" rspace="0em" id="A3.E26.m1.3.3.3.1.1.2.2" xref="A3.E26.m1.3.3.3.1.1.2.2.cmml">​</mo><mrow id="A3.E26.m1.3.3.3.1.1.2.1.1" xref="A3.E26.m1.3.3.3.1.1.2.1.1.1.cmml"><mo stretchy="false" id="A3.E26.m1.3.3.3.1.1.2.1.1.2" xref="A3.E26.m1.3.3.3.1.1.2.1.1.1.cmml">(</mo><mrow id="A3.E26.m1.3.3.3.1.1.2.1.1.1" xref="A3.E26.m1.3.3.3.1.1.2.1.1.1.cmml"><msub id="A3.E26.m1.3.3.3.1.1.2.1.1.1.2" xref="A3.E26.m1.3.3.3.1.1.2.1.1.1.2.cmml"><mi id="A3.E26.m1.3.3.3.1.1.2.1.1.1.2.2" xref="A3.E26.m1.3.3.3.1.1.2.1.1.1.2.2.cmml">z</mi><mi id="A3.E26.m1.3.3.3.1.1.2.1.1.1.2.3" xref="A3.E26.m1.3.3.3.1.1.2.1.1.1.2.3.cmml">s</mi></msub><mo id="A3.E26.m1.3.3.3.1.1.2.1.1.1.1" xref="A3.E26.m1.3.3.3.1.1.2.1.1.1.1.cmml">=</mo><mn id="A3.E26.m1.3.3.3.1.1.2.1.1.1.3" xref="A3.E26.m1.3.3.3.1.1.2.1.1.1.3.cmml">1</mn></mrow><mo stretchy="false" id="A3.E26.m1.3.3.3.1.1.2.1.1.3" xref="A3.E26.m1.3.3.3.1.1.2.1.1.1.cmml">)</mo></mrow></mrow></mrow><mo id="A3.E26.m1.3.3.3.1.3" xref="A3.E26.m1.3.3.3.2.1.cmml">|</mo></mrow><mo id="A3.E26.m1.4.4.7" xref="A3.E26.m1.4.4.7.cmml">=</mo><mrow id="A3.E26.m1.4.4.4.1" xref="A3.E26.m1.4.4.4.2.cmml"><mo id="A3.E26.m1.4.4.4.1.2" xref="A3.E26.m1.4.4.4.2.1.cmml">|</mo><mrow id="A3.E26.m1.4.4.4.1.1" xref="A3.E26.m1.4.4.4.1.1.cmml"><msub id="A3.E26.m1.4.4.4.1.1.2" xref="A3.E26.m1.4.4.4.1.1.2.cmml"><mi id="A3.E26.m1.4.4.4.1.1.2.2" xref="A3.E26.m1.4.4.4.1.1.2.2.cmml">π</mi><mi id="A3.E26.m1.4.4.4.1.1.2.3" xref="A3.E26.m1.4.4.4.1.1.2.3.cmml">s</mi></msub><mo id="A3.E26.m1.4.4.4.1.1.1" xref="A3.E26.m1.4.4.4.1.1.1.cmml">−</mo><mi id="A3.E26.m1.4.4.4.1.1.3" xref="A3.E26.m1.4.4.4.1.1.3.cmml">θ</mi></mrow><mo id="A3.E26.m1.4.4.4.1.3" xref="A3.E26.m1.4.4.4.2.1.cmml">|</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="A3.E26.m1.4b"><apply id="A3.E26.m1.4.4.cmml" xref="A3.E26.m1.4.4"><and id="A3.E26.m1.4.4a.cmml" xref="A3.E26.m1.4.4"></and><apply id="A3.E26.m1.4.4b.cmml" xref="A3.E26.m1.4.4"><eq id="A3.E26.m1.4.4.6.cmml" xref="A3.E26.m1.4.4.6"></eq><apply id="A3.E26.m1.2.2.2.cmml" xref="A3.E26.m1.2.2.2"><times id="A3.E26.m1.2.2.2.3.cmml" xref="A3.E26.m1.2.2.2.3"></times><ci id="A3.E26.m1.2.2.2.4a.cmml" xref="A3.E26.m1.2.2.2.4"><mtext id="A3.E26.m1.2.2.2.4.cmml" xref="A3.E26.m1.2.2.2.4">TV</mtext></ci><interval closure="open" id="A3.E26.m1.2.2.2.2.3.cmml" xref="A3.E26.m1.2.2.2.2.2"><apply id="A3.E26.m1.1.1.1.1.1.1.cmml" xref="A3.E26.m1.1.1.1.1.1.1"><times id="A3.E26.m1.1.1.1.1.1.1.2.cmml" xref="A3.E26.m1.1.1.1.1.1.1.2"></times><apply id="A3.E26.m1.1.1.1.1.1.1.3.cmml" xref="A3.E26.m1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="A3.E26.m1.1.1.1.1.1.1.3.1.cmml" xref="A3.E26.m1.1.1.1.1.1.1.3">subscript</csymbol><ci id="A3.E26.m1.1.1.1.1.1.1.3.2.cmml" xref="A3.E26.m1.1.1.1.1.1.1.3.2">𝑞</ci><apply id="A3.E26.m1.1.1.1.1.1.1.3.3.cmml" xref="A3.E26.m1.1.1.1.1.1.1.3.3"><csymbol cd="ambiguous" id="A3.E26.m1.1.1.1.1.1.1.3.3.1.cmml" xref="A3.E26.m1.1.1.1.1.1.1.3.3">subscript</csymbol><ci id="A3.E26.m1.1.1.1.1.1.1.3.3.2.cmml" xref="A3.E26.m1.1.1.1.1.1.1.3.3.2">𝜋</ci><ci id="A3.E26.m1.1.1.1.1.1.1.3.3.3.cmml" xref="A3.E26.m1.1.1.1.1.1.1.3.3.3">𝑠</ci></apply></apply><apply id="A3.E26.m1.1.1.1.1.1.1.1.1.1.cmml" xref="A3.E26.m1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="A3.E26.m1.1.1.1.1.1.1.1.1.1.1.cmml" xref="A3.E26.m1.1.1.1.1.1.1.1.1">subscript</csymbol><ci id="A3.E26.m1.1.1.1.1.1.1.1.1.1.2.cmml" xref="A3.E26.m1.1.1.1.1.1.1.1.1.1.2">𝑧</ci><ci id="A3.E26.m1.1.1.1.1.1.1.1.1.1.3.cmml" xref="A3.E26.m1.1.1.1.1.1.1.1.1.1.3">𝑠</ci></apply></apply><apply id="A3.E26.m1.2.2.2.2.2.2.cmml" xref="A3.E26.m1.2.2.2.2.2.2"><times id="A3.E26.m1.2.2.2.2.2.2.2.cmml" xref="A3.E26.m1.2.2.2.2.2.2.2"></times><apply id="A3.E26.m1.2.2.2.2.2.2.3.cmml" xref="A3.E26.m1.2.2.2.2.2.2.3"><csymbol cd="ambiguous" id="A3.E26.m1.2.2.2.2.2.2.3.1.cmml" xref="A3.E26.m1.2.2.2.2.2.2.3">subscript</csymbol><ci id="A3.E26.m1.2.2.2.2.2.2.3.2.cmml" xref="A3.E26.m1.2.2.2.2.2.2.3.2">𝑝</ci><ci id="A3.E26.m1.2.2.2.2.2.2.3.3.cmml" xref="A3.E26.m1.2.2.2.2.2.2.3.3">𝜃</ci></apply><apply id="A3.E26.m1.2.2.2.2.2.2.1.1.1.cmml" xref="A3.E26.m1.2.2.2.2.2.2.1.1"><csymbol cd="ambiguous" id="A3.E26.m1.2.2.2.2.2.2.1.1.1.1.cmml" xref="A3.E26.m1.2.2.2.2.2.2.1.1">subscript</csymbol><ci id="A3.E26.m1.2.2.2.2.2.2.1.1.1.2.cmml" xref="A3.E26.m1.2.2.2.2.2.2.1.1.1.2">𝑧</ci><ci id="A3.E26.m1.2.2.2.2.2.2.1.1.1.3.cmml" xref="A3.E26.m1.2.2.2.2.2.2.1.1.1.3">𝑠</ci></apply></apply></interval></apply><apply id="A3.E26.m1.3.3.3.2.cmml" xref="A3.E26.m1.3.3.3.1"><abs id="A3.E26.m1.3.3.3.2.1.cmml" xref="A3.E26.m1.3.3.3.1.2"></abs><apply id="A3.E26.m1.3.3.3.1.1.cmml" xref="A3.E26.m1.3.3.3.1.1"><minus id="A3.E26.m1.3.3.3.1.1.3.cmml" xref="A3.E26.m1.3.3.3.1.1.3"></minus><apply id="A3.E26.m1.3.3.3.1.1.1.cmml" xref="A3.E26.m1.3.3.3.1.1.1"><times id="A3.E26.m1.3.3.3.1.1.1.2.cmml" xref="A3.E26.m1.3.3.3.1.1.1.2"></times><apply id="A3.E26.m1.3.3.3.1.1.1.3.cmml" xref="A3.E26.m1.3.3.3.1.1.1.3"><csymbol cd="ambiguous" id="A3.E26.m1.3.3.3.1.1.1.3.1.cmml" xref="A3.E26.m1.3.3.3.1.1.1.3">subscript</csymbol><ci id="A3.E26.m1.3.3.3.1.1.1.3.2.cmml" xref="A3.E26.m1.3.3.3.1.1.1.3.2">𝑞</ci><apply id="A3.E26.m1.3.3.3.1.1.1.3.3.cmml" xref="A3.E26.m1.3.3.3.1.1.1.3.3"><csymbol cd="ambiguous" id="A3.E26.m1.3.3.3.1.1.1.3.3.1.cmml" xref="A3.E26.m1.3.3.3.1.1.1.3.3">subscript</csymbol><ci id="A3.E26.m1.3.3.3.1.1.1.3.3.2.cmml" xref="A3.E26.m1.3.3.3.1.1.1.3.3.2">𝜋</ci><ci id="A3.E26.m1.3.3.3.1.1.1.3.3.3.cmml" xref="A3.E26.m1.3.3.3.1.1.1.3.3.3">𝑠</ci></apply></apply><apply id="A3.E26.m1.3.3.3.1.1.1.1.1.1.cmml" xref="A3.E26.m1.3.3.3.1.1.1.1.1"><eq id="A3.E26.m1.3.3.3.1.1.1.1.1.1.1.cmml" xref="A3.E26.m1.3.3.3.1.1.1.1.1.1.1"></eq><apply id="A3.E26.m1.3.3.3.1.1.1.1.1.1.2.cmml" xref="A3.E26.m1.3.3.3.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="A3.E26.m1.3.3.3.1.1.1.1.1.1.2.1.cmml" xref="A3.E26.m1.3.3.3.1.1.1.1.1.1.2">subscript</csymbol><ci id="A3.E26.m1.3.3.3.1.1.1.1.1.1.2.2.cmml" xref="A3.E26.m1.3.3.3.1.1.1.1.1.1.2.2">𝑧</ci><ci id="A3.E26.m1.3.3.3.1.1.1.1.1.1.2.3.cmml" xref="A3.E26.m1.3.3.3.1.1.1.1.1.1.2.3">𝑠</ci></apply><cn type="integer" id="A3.E26.m1.3.3.3.1.1.1.1.1.1.3.cmml" xref="A3.E26.m1.3.3.3.1.1.1.1.1.1.3">1</cn></apply></apply><apply id="A3.E26.m1.3.3.3.1.1.2.cmml" xref="A3.E26.m1.3.3.3.1.1.2"><times id="A3.E26.m1.3.3.3.1.1.2.2.cmml" xref="A3.E26.m1.3.3.3.1.1.2.2"></times><apply id="A3.E26.m1.3.3.3.1.1.2.3.cmml" xref="A3.E26.m1.3.3.3.1.1.2.3"><csymbol cd="ambiguous" id="A3.E26.m1.3.3.3.1.1.2.3.1.cmml" xref="A3.E26.m1.3.3.3.1.1.2.3">subscript</csymbol><ci id="A3.E26.m1.3.3.3.1.1.2.3.2.cmml" xref="A3.E26.m1.3.3.3.1.1.2.3.2">𝑝</ci><ci id="A3.E26.m1.3.3.3.1.1.2.3.3.cmml" xref="A3.E26.m1.3.3.3.1.1.2.3.3">𝜃</ci></apply><apply id="A3.E26.m1.3.3.3.1.1.2.1.1.1.cmml" xref="A3.E26.m1.3.3.3.1.1.2.1.1"><eq id="A3.E26.m1.3.3.3.1.1.2.1.1.1.1.cmml" xref="A3.E26.m1.3.3.3.1.1.2.1.1.1.1"></eq><apply id="A3.E26.m1.3.3.3.1.1.2.1.1.1.2.cmml" xref="A3.E26.m1.3.3.3.1.1.2.1.1.1.2"><csymbol cd="ambiguous" id="A3.E26.m1.3.3.3.1.1.2.1.1.1.2.1.cmml" xref="A3.E26.m1.3.3.3.1.1.2.1.1.1.2">subscript</csymbol><ci id="A3.E26.m1.3.3.3.1.1.2.1.1.1.2.2.cmml" xref="A3.E26.m1.3.3.3.1.1.2.1.1.1.2.2">𝑧</ci><ci id="A3.E26.m1.3.3.3.1.1.2.1.1.1.2.3.cmml" xref="A3.E26.m1.3.3.3.1.1.2.1.1.1.2.3">𝑠</ci></apply><cn type="integer" id="A3.E26.m1.3.3.3.1.1.2.1.1.1.3.cmml" xref="A3.E26.m1.3.3.3.1.1.2.1.1.1.3">1</cn></apply></apply></apply></apply></apply><apply id="A3.E26.m1.4.4c.cmml" xref="A3.E26.m1.4.4"><eq id="A3.E26.m1.4.4.7.cmml" xref="A3.E26.m1.4.4.7"></eq><share href="#A3.E26.m1.3.3.3.cmml" id="A3.E26.m1.4.4d.cmml" xref="A3.E26.m1.4.4"></share><apply id="A3.E26.m1.4.4.4.2.cmml" xref="A3.E26.m1.4.4.4.1"><abs id="A3.E26.m1.4.4.4.2.1.cmml" xref="A3.E26.m1.4.4.4.1.2"></abs><apply id="A3.E26.m1.4.4.4.1.1.cmml" xref="A3.E26.m1.4.4.4.1.1"><minus id="A3.E26.m1.4.4.4.1.1.1.cmml" xref="A3.E26.m1.4.4.4.1.1.1"></minus><apply id="A3.E26.m1.4.4.4.1.1.2.cmml" xref="A3.E26.m1.4.4.4.1.1.2"><csymbol cd="ambiguous" id="A3.E26.m1.4.4.4.1.1.2.1.cmml" xref="A3.E26.m1.4.4.4.1.1.2">subscript</csymbol><ci id="A3.E26.m1.4.4.4.1.1.2.2.cmml" xref="A3.E26.m1.4.4.4.1.1.2.2">𝜋</ci><ci id="A3.E26.m1.4.4.4.1.1.2.3.cmml" xref="A3.E26.m1.4.4.4.1.1.2.3">𝑠</ci></apply><ci id="A3.E26.m1.4.4.4.1.1.3.cmml" xref="A3.E26.m1.4.4.4.1.1.3">𝜃</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A3.E26.m1.4c">\displaystyle\text{TV}\left(q_{\pi_{s}}(z_{s}),p_{\theta}(z_{s})\right)=\left|q_{\pi_{s}}(z_{s}=1)-p_{\theta}(z_{s}=1)\right|=\left|\pi_{s}-\theta\right|</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(26)</span></td>
</tr></tbody>
</table>
<p id="A3.p1.2" class="ltx_p">The resulting plots over the course of training for all tasks and <span id="A3.p1.2.1" class="ltx_text ltx_font_typewriter">FedSparse</span> settings can be found in Fig. <a href="#A3.F5" title="Figure 5 ‣ Appendix C Sparsity alignment between clients and server ‣ An Expectation-Maximization Perspective on Federated Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">5</span></a>.</p>
</div>
<figure id="A3.F5" class="ltx_figure">
<div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_3">
<figure id="A3.F5.sf1" class="ltx_figure ltx_figure_panel"><img src="/html/2111.10192/assets/figures/atv_c10.png" id="A3.F5.sf1.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="598" height="416" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span id="A3.F5.sf1.2.1.1" class="ltx_text" style="font-size:90%;">(a)</span> </span><span id="A3.F5.sf1.3.2" class="ltx_text" style="font-size:90%;">Cifar10</span></figcaption>
</figure>
</div>
<div class="ltx_flex_cell ltx_flex_size_3">
<figure id="A3.F5.sf2" class="ltx_figure ltx_figure_panel"><img src="/html/2111.10192/assets/figures/atv_c100.png" id="A3.F5.sf2.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="598" height="416" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span id="A3.F5.sf2.2.1.1" class="ltx_text" style="font-size:90%;">(b)</span> </span><span id="A3.F5.sf2.3.2" class="ltx_text" style="font-size:90%;">Cifar100</span></figcaption>
</figure>
</div>
<div class="ltx_flex_cell ltx_flex_size_3">
<figure id="A3.F5.sf3" class="ltx_figure ltx_figure_panel"><img src="/html/2111.10192/assets/figures/atv_fm.png" id="A3.F5.sf3.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="598" height="416" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span id="A3.F5.sf3.2.1.1" class="ltx_text" style="font-size:90%;">(c)</span> </span><span id="A3.F5.sf3.3.2" class="ltx_text" style="font-size:90%;">Femnist</span></figcaption>
</figure>
</div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_3">
<figure id="A3.F5.sf4" class="ltx_figure ltx_figure_panel ltx_align_center"><img src="/html/2111.10192/assets/figures/mtv_c10.png" id="A3.F5.sf4.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="598" height="422" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span id="A3.F5.sf4.2.1.1" class="ltx_text" style="font-size:90%;">(d)</span> </span><span id="A3.F5.sf4.3.2" class="ltx_text" style="font-size:90%;">Cifar10</span></figcaption>
</figure>
</div>
<div class="ltx_flex_cell ltx_flex_size_3">
<figure id="A3.F5.sf5" class="ltx_figure ltx_figure_panel ltx_align_center"><img src="/html/2111.10192/assets/figures/mtv_c100.png" id="A3.F5.sf5.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="598" height="422" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span id="A3.F5.sf5.2.1.1" class="ltx_text" style="font-size:90%;">(e)</span> </span><span id="A3.F5.sf5.3.2" class="ltx_text" style="font-size:90%;">Cifar100</span></figcaption>
</figure>
</div>
<div class="ltx_flex_cell ltx_flex_size_3">
<figure id="A3.F5.sf6" class="ltx_figure ltx_figure_panel ltx_align_center"><img src="/html/2111.10192/assets/figures/mtv_fm.png" id="A3.F5.sf6.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="598" height="422" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span id="A3.F5.sf6.2.1.1" class="ltx_text" style="font-size:90%;">(f)</span> </span><span id="A3.F5.sf6.3.2" class="ltx_text" style="font-size:90%;">Femnist</span></figcaption>
</figure>
</div>
</div>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span id="A3.F5.3.1.1" class="ltx_text" style="font-size:90%;">Figure 5</span>: </span><span id="A3.F5.4.2" class="ltx_text" style="font-size:90%;">Average (top row) and maximum (bottom row) total variation distance for all tasks and <span id="A3.F5.4.2.1" class="ltx_text ltx_font_typewriter">FedSparse</span> settings.</span></figcaption>
</figure>
<div id="A3.p2" class="ltx_para">
<p id="A3.p2.3" class="ltx_p">We can clearly see that the clients and the server quickly agree on the general sparsity pattern as the average total variation distance becomes almost zero on all settings. We can attribute this to the “resetting” of the local <math id="A3.p2.1.m1.1" class="ltx_Math" alttext="q_{\pi_{s}}(z_{s})" display="inline"><semantics id="A3.p2.1.m1.1a"><mrow id="A3.p2.1.m1.1.1" xref="A3.p2.1.m1.1.1.cmml"><msub id="A3.p2.1.m1.1.1.3" xref="A3.p2.1.m1.1.1.3.cmml"><mi id="A3.p2.1.m1.1.1.3.2" xref="A3.p2.1.m1.1.1.3.2.cmml">q</mi><msub id="A3.p2.1.m1.1.1.3.3" xref="A3.p2.1.m1.1.1.3.3.cmml"><mi id="A3.p2.1.m1.1.1.3.3.2" xref="A3.p2.1.m1.1.1.3.3.2.cmml">π</mi><mi id="A3.p2.1.m1.1.1.3.3.3" xref="A3.p2.1.m1.1.1.3.3.3.cmml">s</mi></msub></msub><mo lspace="0em" rspace="0em" id="A3.p2.1.m1.1.1.2" xref="A3.p2.1.m1.1.1.2.cmml">​</mo><mrow id="A3.p2.1.m1.1.1.1.1" xref="A3.p2.1.m1.1.1.1.1.1.cmml"><mo stretchy="false" id="A3.p2.1.m1.1.1.1.1.2" xref="A3.p2.1.m1.1.1.1.1.1.cmml">(</mo><msub id="A3.p2.1.m1.1.1.1.1.1" xref="A3.p2.1.m1.1.1.1.1.1.cmml"><mi id="A3.p2.1.m1.1.1.1.1.1.2" xref="A3.p2.1.m1.1.1.1.1.1.2.cmml">z</mi><mi id="A3.p2.1.m1.1.1.1.1.1.3" xref="A3.p2.1.m1.1.1.1.1.1.3.cmml">s</mi></msub><mo stretchy="false" id="A3.p2.1.m1.1.1.1.1.3" xref="A3.p2.1.m1.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="A3.p2.1.m1.1b"><apply id="A3.p2.1.m1.1.1.cmml" xref="A3.p2.1.m1.1.1"><times id="A3.p2.1.m1.1.1.2.cmml" xref="A3.p2.1.m1.1.1.2"></times><apply id="A3.p2.1.m1.1.1.3.cmml" xref="A3.p2.1.m1.1.1.3"><csymbol cd="ambiguous" id="A3.p2.1.m1.1.1.3.1.cmml" xref="A3.p2.1.m1.1.1.3">subscript</csymbol><ci id="A3.p2.1.m1.1.1.3.2.cmml" xref="A3.p2.1.m1.1.1.3.2">𝑞</ci><apply id="A3.p2.1.m1.1.1.3.3.cmml" xref="A3.p2.1.m1.1.1.3.3"><csymbol cd="ambiguous" id="A3.p2.1.m1.1.1.3.3.1.cmml" xref="A3.p2.1.m1.1.1.3.3">subscript</csymbol><ci id="A3.p2.1.m1.1.1.3.3.2.cmml" xref="A3.p2.1.m1.1.1.3.3.2">𝜋</ci><ci id="A3.p2.1.m1.1.1.3.3.3.cmml" xref="A3.p2.1.m1.1.1.3.3.3">𝑠</ci></apply></apply><apply id="A3.p2.1.m1.1.1.1.1.1.cmml" xref="A3.p2.1.m1.1.1.1.1"><csymbol cd="ambiguous" id="A3.p2.1.m1.1.1.1.1.1.1.cmml" xref="A3.p2.1.m1.1.1.1.1">subscript</csymbol><ci id="A3.p2.1.m1.1.1.1.1.1.2.cmml" xref="A3.p2.1.m1.1.1.1.1.1.2">𝑧</ci><ci id="A3.p2.1.m1.1.1.1.1.1.3.cmml" xref="A3.p2.1.m1.1.1.1.1.1.3">𝑠</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A3.p2.1.m1.1c">q_{\pi_{s}}(z_{s})</annotation></semantics></math> to <math id="A3.p2.2.m2.1" class="ltx_Math" alttext="p_{\theta}(z_{s})" display="inline"><semantics id="A3.p2.2.m2.1a"><mrow id="A3.p2.2.m2.1.1" xref="A3.p2.2.m2.1.1.cmml"><msub id="A3.p2.2.m2.1.1.3" xref="A3.p2.2.m2.1.1.3.cmml"><mi id="A3.p2.2.m2.1.1.3.2" xref="A3.p2.2.m2.1.1.3.2.cmml">p</mi><mi id="A3.p2.2.m2.1.1.3.3" xref="A3.p2.2.m2.1.1.3.3.cmml">θ</mi></msub><mo lspace="0em" rspace="0em" id="A3.p2.2.m2.1.1.2" xref="A3.p2.2.m2.1.1.2.cmml">​</mo><mrow id="A3.p2.2.m2.1.1.1.1" xref="A3.p2.2.m2.1.1.1.1.1.cmml"><mo stretchy="false" id="A3.p2.2.m2.1.1.1.1.2" xref="A3.p2.2.m2.1.1.1.1.1.cmml">(</mo><msub id="A3.p2.2.m2.1.1.1.1.1" xref="A3.p2.2.m2.1.1.1.1.1.cmml"><mi id="A3.p2.2.m2.1.1.1.1.1.2" xref="A3.p2.2.m2.1.1.1.1.1.2.cmml">z</mi><mi id="A3.p2.2.m2.1.1.1.1.1.3" xref="A3.p2.2.m2.1.1.1.1.1.3.cmml">s</mi></msub><mo stretchy="false" id="A3.p2.2.m2.1.1.1.1.3" xref="A3.p2.2.m2.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="A3.p2.2.m2.1b"><apply id="A3.p2.2.m2.1.1.cmml" xref="A3.p2.2.m2.1.1"><times id="A3.p2.2.m2.1.1.2.cmml" xref="A3.p2.2.m2.1.1.2"></times><apply id="A3.p2.2.m2.1.1.3.cmml" xref="A3.p2.2.m2.1.1.3"><csymbol cd="ambiguous" id="A3.p2.2.m2.1.1.3.1.cmml" xref="A3.p2.2.m2.1.1.3">subscript</csymbol><ci id="A3.p2.2.m2.1.1.3.2.cmml" xref="A3.p2.2.m2.1.1.3.2">𝑝</ci><ci id="A3.p2.2.m2.1.1.3.3.cmml" xref="A3.p2.2.m2.1.1.3.3">𝜃</ci></apply><apply id="A3.p2.2.m2.1.1.1.1.1.cmml" xref="A3.p2.2.m2.1.1.1.1"><csymbol cd="ambiguous" id="A3.p2.2.m2.1.1.1.1.1.1.cmml" xref="A3.p2.2.m2.1.1.1.1">subscript</csymbol><ci id="A3.p2.2.m2.1.1.1.1.1.2.cmml" xref="A3.p2.2.m2.1.1.1.1.1.2">𝑧</ci><ci id="A3.p2.2.m2.1.1.1.1.1.3.cmml" xref="A3.p2.2.m2.1.1.1.1.1.3">𝑠</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A3.p2.2.m2.1c">p_{\theta}(z_{s})</annotation></semantics></math> configuration that happens at the beginning of each round along with the extra cross-entropy loss between <math id="A3.p2.3.m3.2" class="ltx_Math" alttext="q_{\pi_{s}}(z_{s}),p_{\theta}(z_{s})" display="inline"><semantics id="A3.p2.3.m3.2a"><mrow id="A3.p2.3.m3.2.2.2" xref="A3.p2.3.m3.2.2.3.cmml"><mrow id="A3.p2.3.m3.1.1.1.1" xref="A3.p2.3.m3.1.1.1.1.cmml"><msub id="A3.p2.3.m3.1.1.1.1.3" xref="A3.p2.3.m3.1.1.1.1.3.cmml"><mi id="A3.p2.3.m3.1.1.1.1.3.2" xref="A3.p2.3.m3.1.1.1.1.3.2.cmml">q</mi><msub id="A3.p2.3.m3.1.1.1.1.3.3" xref="A3.p2.3.m3.1.1.1.1.3.3.cmml"><mi id="A3.p2.3.m3.1.1.1.1.3.3.2" xref="A3.p2.3.m3.1.1.1.1.3.3.2.cmml">π</mi><mi id="A3.p2.3.m3.1.1.1.1.3.3.3" xref="A3.p2.3.m3.1.1.1.1.3.3.3.cmml">s</mi></msub></msub><mo lspace="0em" rspace="0em" id="A3.p2.3.m3.1.1.1.1.2" xref="A3.p2.3.m3.1.1.1.1.2.cmml">​</mo><mrow id="A3.p2.3.m3.1.1.1.1.1.1" xref="A3.p2.3.m3.1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="A3.p2.3.m3.1.1.1.1.1.1.2" xref="A3.p2.3.m3.1.1.1.1.1.1.1.cmml">(</mo><msub id="A3.p2.3.m3.1.1.1.1.1.1.1" xref="A3.p2.3.m3.1.1.1.1.1.1.1.cmml"><mi id="A3.p2.3.m3.1.1.1.1.1.1.1.2" xref="A3.p2.3.m3.1.1.1.1.1.1.1.2.cmml">z</mi><mi id="A3.p2.3.m3.1.1.1.1.1.1.1.3" xref="A3.p2.3.m3.1.1.1.1.1.1.1.3.cmml">s</mi></msub><mo stretchy="false" id="A3.p2.3.m3.1.1.1.1.1.1.3" xref="A3.p2.3.m3.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="A3.p2.3.m3.2.2.2.3" xref="A3.p2.3.m3.2.2.3.cmml">,</mo><mrow id="A3.p2.3.m3.2.2.2.2" xref="A3.p2.3.m3.2.2.2.2.cmml"><msub id="A3.p2.3.m3.2.2.2.2.3" xref="A3.p2.3.m3.2.2.2.2.3.cmml"><mi id="A3.p2.3.m3.2.2.2.2.3.2" xref="A3.p2.3.m3.2.2.2.2.3.2.cmml">p</mi><mi id="A3.p2.3.m3.2.2.2.2.3.3" xref="A3.p2.3.m3.2.2.2.2.3.3.cmml">θ</mi></msub><mo lspace="0em" rspace="0em" id="A3.p2.3.m3.2.2.2.2.2" xref="A3.p2.3.m3.2.2.2.2.2.cmml">​</mo><mrow id="A3.p2.3.m3.2.2.2.2.1.1" xref="A3.p2.3.m3.2.2.2.2.1.1.1.cmml"><mo stretchy="false" id="A3.p2.3.m3.2.2.2.2.1.1.2" xref="A3.p2.3.m3.2.2.2.2.1.1.1.cmml">(</mo><msub id="A3.p2.3.m3.2.2.2.2.1.1.1" xref="A3.p2.3.m3.2.2.2.2.1.1.1.cmml"><mi id="A3.p2.3.m3.2.2.2.2.1.1.1.2" xref="A3.p2.3.m3.2.2.2.2.1.1.1.2.cmml">z</mi><mi id="A3.p2.3.m3.2.2.2.2.1.1.1.3" xref="A3.p2.3.m3.2.2.2.2.1.1.1.3.cmml">s</mi></msub><mo stretchy="false" id="A3.p2.3.m3.2.2.2.2.1.1.3" xref="A3.p2.3.m3.2.2.2.2.1.1.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="A3.p2.3.m3.2b"><list id="A3.p2.3.m3.2.2.3.cmml" xref="A3.p2.3.m3.2.2.2"><apply id="A3.p2.3.m3.1.1.1.1.cmml" xref="A3.p2.3.m3.1.1.1.1"><times id="A3.p2.3.m3.1.1.1.1.2.cmml" xref="A3.p2.3.m3.1.1.1.1.2"></times><apply id="A3.p2.3.m3.1.1.1.1.3.cmml" xref="A3.p2.3.m3.1.1.1.1.3"><csymbol cd="ambiguous" id="A3.p2.3.m3.1.1.1.1.3.1.cmml" xref="A3.p2.3.m3.1.1.1.1.3">subscript</csymbol><ci id="A3.p2.3.m3.1.1.1.1.3.2.cmml" xref="A3.p2.3.m3.1.1.1.1.3.2">𝑞</ci><apply id="A3.p2.3.m3.1.1.1.1.3.3.cmml" xref="A3.p2.3.m3.1.1.1.1.3.3"><csymbol cd="ambiguous" id="A3.p2.3.m3.1.1.1.1.3.3.1.cmml" xref="A3.p2.3.m3.1.1.1.1.3.3">subscript</csymbol><ci id="A3.p2.3.m3.1.1.1.1.3.3.2.cmml" xref="A3.p2.3.m3.1.1.1.1.3.3.2">𝜋</ci><ci id="A3.p2.3.m3.1.1.1.1.3.3.3.cmml" xref="A3.p2.3.m3.1.1.1.1.3.3.3">𝑠</ci></apply></apply><apply id="A3.p2.3.m3.1.1.1.1.1.1.1.cmml" xref="A3.p2.3.m3.1.1.1.1.1.1"><csymbol cd="ambiguous" id="A3.p2.3.m3.1.1.1.1.1.1.1.1.cmml" xref="A3.p2.3.m3.1.1.1.1.1.1">subscript</csymbol><ci id="A3.p2.3.m3.1.1.1.1.1.1.1.2.cmml" xref="A3.p2.3.m3.1.1.1.1.1.1.1.2">𝑧</ci><ci id="A3.p2.3.m3.1.1.1.1.1.1.1.3.cmml" xref="A3.p2.3.m3.1.1.1.1.1.1.1.3">𝑠</ci></apply></apply><apply id="A3.p2.3.m3.2.2.2.2.cmml" xref="A3.p2.3.m3.2.2.2.2"><times id="A3.p2.3.m3.2.2.2.2.2.cmml" xref="A3.p2.3.m3.2.2.2.2.2"></times><apply id="A3.p2.3.m3.2.2.2.2.3.cmml" xref="A3.p2.3.m3.2.2.2.2.3"><csymbol cd="ambiguous" id="A3.p2.3.m3.2.2.2.2.3.1.cmml" xref="A3.p2.3.m3.2.2.2.2.3">subscript</csymbol><ci id="A3.p2.3.m3.2.2.2.2.3.2.cmml" xref="A3.p2.3.m3.2.2.2.2.3.2">𝑝</ci><ci id="A3.p2.3.m3.2.2.2.2.3.3.cmml" xref="A3.p2.3.m3.2.2.2.2.3.3">𝜃</ci></apply><apply id="A3.p2.3.m3.2.2.2.2.1.1.1.cmml" xref="A3.p2.3.m3.2.2.2.2.1.1"><csymbol cd="ambiguous" id="A3.p2.3.m3.2.2.2.2.1.1.1.1.cmml" xref="A3.p2.3.m3.2.2.2.2.1.1">subscript</csymbol><ci id="A3.p2.3.m3.2.2.2.2.1.1.1.2.cmml" xref="A3.p2.3.m3.2.2.2.2.1.1.1.2">𝑧</ci><ci id="A3.p2.3.m3.2.2.2.2.1.1.1.3.cmml" xref="A3.p2.3.m3.2.2.2.2.1.1.1.3">𝑠</ci></apply></apply></list></annotation-xml><annotation encoding="application/x-tex" id="A3.p2.3.m3.2c">q_{\pi_{s}}(z_{s}),p_{\theta}(z_{s})</annotation></semantics></math> that <span id="A3.p2.3.1" class="ltx_text ltx_font_typewriter">FedSparse</span> has. We can also see that the maximum total variation distance takes much longer to drop, meaning that there are a few parameter groups where the probability of keeping them at the clients’ sides is different than the one at the server. We attribute this to the model ”specializing” the sparsity pattern to the characteristics of the client dataset. We can also see however, that the maximum total variation distance does drop as training progresses, showing that the sparsity pattern specialization does decrease (although it never becomes zero).</p>
</div>
</section>
<section id="A4" class="ltx_appendix">
<h2 class="ltx_title ltx_title_appendix">
<span class="ltx_tag ltx_tag_appendix">Appendix D </span>Additional results</h2>

<section id="A4.SS0.SSS0.Px1" class="ltx_paragraph">
<h4 class="ltx_title ltx_title_paragraph">Convergence plots in terms of communication rounds.</h4>

<div id="A4.SS0.SSS0.Px1.p1" class="ltx_para">
<p id="A4.SS0.SSS0.Px1.p1.1" class="ltx_p">In order to understand whether the extra noise is detrimental to the convergence speed of <span id="A4.SS0.SSS0.Px1.p1.1.1" class="ltx_text ltx_font_typewriter">FedSparse</span>, we plot the validation accuracy in terms of communication rounds for all tasks and baselines. As it can be seen, there is no inherent difference before <span id="A4.SS0.SSS0.Px1.p1.1.2" class="ltx_text ltx_font_typewriter">FedSparse</span> starts pruning. This happens quite early in training for CIFAR 100 thus it is there where we observe the most differences. <span id="A4.SS0.SSS0.Px1.p1.1.3" class="ltx_text ltx_font_typewriter">FedL1</span> is overall worse than the other methods as the inclusion of the <math id="A4.SS0.SSS0.Px1.p1.1.m1.1" class="ltx_Math" alttext="L_{1}" display="inline"><semantics id="A4.SS0.SSS0.Px1.p1.1.m1.1a"><msub id="A4.SS0.SSS0.Px1.p1.1.m1.1.1" xref="A4.SS0.SSS0.Px1.p1.1.m1.1.1.cmml"><mi id="A4.SS0.SSS0.Px1.p1.1.m1.1.1.2" xref="A4.SS0.SSS0.Px1.p1.1.m1.1.1.2.cmml">L</mi><mn id="A4.SS0.SSS0.Px1.p1.1.m1.1.1.3" xref="A4.SS0.SSS0.Px1.p1.1.m1.1.1.3.cmml">1</mn></msub><annotation-xml encoding="MathML-Content" id="A4.SS0.SSS0.Px1.p1.1.m1.1b"><apply id="A4.SS0.SSS0.Px1.p1.1.m1.1.1.cmml" xref="A4.SS0.SSS0.Px1.p1.1.m1.1.1"><csymbol cd="ambiguous" id="A4.SS0.SSS0.Px1.p1.1.m1.1.1.1.cmml" xref="A4.SS0.SSS0.Px1.p1.1.m1.1.1">subscript</csymbol><ci id="A4.SS0.SSS0.Px1.p1.1.m1.1.1.2.cmml" xref="A4.SS0.SSS0.Px1.p1.1.m1.1.1.2">𝐿</ci><cn type="integer" id="A4.SS0.SSS0.Px1.p1.1.m1.1.1.3.cmml" xref="A4.SS0.SSS0.Px1.p1.1.m1.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A4.SS0.SSS0.Px1.p1.1.m1.1c">L_{1}</annotation></semantics></math> penalty hurts model performance.</p>
</div>
<figure id="A4.F6" class="ltx_figure">
<div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_3">
<figure id="A4.F6.sf1" class="ltx_figure ltx_figure_panel"><img src="/html/2111.10192/assets/figures/rounds_c10.png" id="A4.F6.sf1.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="598" height="416" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span id="A4.F6.sf1.2.1.1" class="ltx_text" style="font-size:90%;">(a)</span> </span><span id="A4.F6.sf1.3.2" class="ltx_text" style="font-size:90%;">CIFAR10</span></figcaption>
</figure>
</div>
<div class="ltx_flex_cell ltx_flex_size_3">
<figure id="A4.F6.sf2" class="ltx_figure ltx_figure_panel"><img src="/html/2111.10192/assets/figures/rounds_c100.png" id="A4.F6.sf2.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="598" height="424" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span id="A4.F6.sf2.2.1.1" class="ltx_text" style="font-size:90%;">(b)</span> </span><span id="A4.F6.sf2.3.2" class="ltx_text" style="font-size:90%;">CIFAR100</span></figcaption>
</figure>
</div>
<div class="ltx_flex_cell ltx_flex_size_3">
<figure id="A4.F6.sf3" class="ltx_figure ltx_figure_panel"><img src="/html/2111.10192/assets/figures/rounds_femnist.png" id="A4.F6.sf3.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="598" height="424" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span id="A4.F6.sf3.2.1.1" class="ltx_text" style="font-size:90%;">(c)</span> </span><span id="A4.F6.sf3.3.2" class="ltx_text" style="font-size:90%;">Femnist</span></figcaption>
</figure>
</div>
</div>
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure"><span id="A4.F6.2.1.1" class="ltx_text" style="font-size:90%;">Figure 6</span>: </span><span id="A4.F6.3.2" class="ltx_text" style="font-size:90%;">Evolution of the validation accuracy in terms of communication rounds.</span></figcaption>
</figure>
</section>
<section id="A4.SS0.SSS0.Px2" class="ltx_paragraph">
<h4 class="ltx_title ltx_title_paragraph">Impact of server side pruning.</h4>

<div id="A4.SS0.SSS0.Px2.p1" class="ltx_para">
<p id="A4.SS0.SSS0.Px2.p1.1" class="ltx_p">In order to understand whether server side pruning is harmful for convergence, we plot both the global and average local validation accuracy on CIFAR 10 for the “mid” setting of <span id="A4.SS0.SSS0.Px2.p1.1.1" class="ltx_text ltx_font_typewriter">FedSparse</span> with and without server side pruning enabled. As we can see, there are no noticeable differences and in fact, pruning results into a slightly better overall performance.</p>
</div>
<figure id="A4.F7" class="ltx_figure">
<div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_2">
<figure id="A4.F7.sf1" class="ltx_figure ltx_figure_panel"><img src="/html/2111.10192/assets/figures/cifar10_noprune_global_rounds.png" id="A4.F7.sf1.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="598" height="418" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span id="A4.F7.sf1.2.1.1" class="ltx_text" style="font-size:90%;">(a)</span> </span><span id="A4.F7.sf1.3.2" class="ltx_text" style="font-size:90%;">CIFAR10 global val. acc.</span></figcaption>
</figure>
</div>
<div class="ltx_flex_cell ltx_flex_size_2">
<figure id="A4.F7.sf2" class="ltx_figure ltx_figure_panel"><img src="/html/2111.10192/assets/figures/cifar10_noprune_local_rounds.png" id="A4.F7.sf2.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="598" height="406" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span id="A4.F7.sf2.2.1.1" class="ltx_text" style="font-size:90%;">(b)</span> </span><span id="A4.F7.sf2.3.2" class="ltx_text" style="font-size:90%;">CIFAR100 local val. acc.</span></figcaption>
</figure>
</div>
</div>
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure"><span id="A4.F7.2.1.1" class="ltx_text" style="font-size:90%;">Figure 7</span>: </span><span id="A4.F7.3.2" class="ltx_text" style="font-size:90%;">Evolution of the validation accuracy in terms of communication rounds with and without server side pruning.</span></figcaption>
</figure>
</section>
</section>
<section id="A5" class="ltx_appendix">
<h2 class="ltx_title ltx_title_appendix">
<span class="ltx_tag ltx_tag_appendix">Appendix E </span>Combining SCAFFOLD with <span id="A5.1.1" class="ltx_text ltx_font_typewriter">FedSparse</span>
</h2>

<div id="A5.p1" class="ltx_para">
<p id="A5.p1.1" class="ltx_p">In order to show that techniques such as <span id="A5.p1.1.1" class="ltx_ERROR undefined">\citeappendix</span>karimireddy2020scaffold,li2020page are orthogonal to <span id="A5.p1.1.2" class="ltx_text ltx_font_typewriter">FedSparse</span>, we implement <span id="A5.p1.1.3" class="ltx_text ltx_font_typewriter">SCAFFOLD</span> <span id="A5.p1.1.4" class="ltx_ERROR undefined">\citeappendix</span>karimireddy2020scaffold on a simple convex problem (following their theory); logistic regression on a (extreme) non-iiid split of the MNIST dataset into 100 users (each user had data from a single class) trained for 400 rounds. For the combination of <span id="A5.p1.1.5" class="ltx_text ltx_font_typewriter">FedSparse</span> and <span id="A5.p1.1.6" class="ltx_text ltx_font_typewriter">SCAFFOLD</span>, we used the <span id="A5.p1.1.7" class="ltx_text ltx_font_typewriter">SCAFFOLD</span> procedure for the weights. The results can be seen in Figure <a href="#A5.F8" title="Figure 8 ‣ Appendix E Combining SCAFFOLD with FedSparse ‣ An Expectation-Maximization Perspective on Federated Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">8</span></a>.</p>
</div>
<div id="A5.p2" class="ltx_para">
<p id="A5.p2.1" class="ltx_p">When measuring the global model accuracy, we observe the benefits of <span id="A5.p2.1.1" class="ltx_text ltx_font_typewriter">SCAFFOLD</span> compared to <span id="A5.p2.1.2" class="ltx_text ltx_font_typewriter">FedAvg</span>. Nevertheless, the “local model“ accuracy (as defined in the main text) was worse, probably due to the control variates leading to a model that is less fine-tuned on the local data-sets.
By comparing these results to the ones with <span id="A5.p2.1.3" class="ltx_text ltx_font_typewriter">FedSparse</span>, we can see that indeed <span id="A5.p2.1.4" class="ltx_text ltx_font_typewriter">FedSparse</span> is orthogonal to <span id="A5.p2.1.5" class="ltx_text ltx_font_typewriter">SCAFFOLD</span>, so one can combine both methods to get the best of both worlds. The model sparsity for <span id="A5.p2.1.6" class="ltx_text ltx_font_typewriter">FedSparse</span> was around 35% when including <span id="A5.p2.1.7" class="ltx_text ltx_font_typewriter">SCAFFOLD</span> and 47% without. It should be noted that <span id="A5.p2.1.8" class="ltx_text ltx_font_typewriter">SCAFFOLD</span> doubles the communication cost per round (compared to <span id="A5.p2.1.9" class="ltx_text ltx_font_typewriter">FedAvg</span>) due to transmitting the control variates.</p>
</div>
<figure id="A5.F8" class="ltx_figure">
<div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_2">
<figure id="A5.F8.sf1" class="ltx_figure ltx_figure_panel"><img src="/html/2111.10192/assets/figures/global_vs_gb_1.png" id="A5.F8.sf1.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="598" height="429" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span id="A5.F8.sf1.2.1.1" class="ltx_text" style="font-size:90%;">(a)</span> </span><span id="A5.F8.sf1.3.2" class="ltx_text" style="font-size:90%;">MNIST global val. acc.</span></figcaption>
</figure>
</div>
<div class="ltx_flex_cell ltx_flex_size_2">
<figure id="A5.F8.sf2" class="ltx_figure ltx_figure_panel"><img src="/html/2111.10192/assets/figures/local_vs_gb_1.png" id="A5.F8.sf2.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="598" height="407" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span id="A5.F8.sf2.2.1.1" class="ltx_text" style="font-size:90%;">(b)</span> </span><span id="A5.F8.sf2.3.2" class="ltx_text" style="font-size:90%;">MNIST local val. acc.</span></figcaption>
</figure>
</div>
</div>
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure"><span id="A5.F8.7.1.1" class="ltx_text" style="font-size:90%;">Figure 8</span>: </span><span id="A5.F8.8.2" class="ltx_text" style="font-size:90%;">Evolution of the validation accuracy in terms of the GB communicated for <span id="A5.F8.8.2.1" class="ltx_text ltx_font_typewriter">FedAvg</span>, <span id="A5.F8.8.2.2" class="ltx_text ltx_font_typewriter">SCAFFOLD</span>, <span id="A5.F8.8.2.3" class="ltx_text ltx_font_typewriter">FedSparse</span> and <span id="A5.F8.8.2.4" class="ltx_text ltx_font_typewriter">FedSparse</span> with <span id="A5.F8.8.2.5" class="ltx_text ltx_font_typewriter">SCAFFOLD</span>.</span></figcaption>
</figure>
<div id="A5.p3" class="ltx_para">
<p id="A5.p3.1" class="ltx_p">On the neural network architectures of the main text, the picture was not as clear since <span id="A5.p3.1.1" class="ltx_text ltx_font_typewriter">SCAFFOLD</span> lead to unstable optimization, which only stabilised after we ”dampened” the contribution from the control variates to the local training procedure (thus not providing benefits). Since in <span id="A5.p3.1.2" class="ltx_ERROR undefined">\citeappendix</span>karimireddy2020scaffold it is mentioned that on non-convex problems ”much more extensive experiments (beyond current scope) are needed before drawing conclusions”, we did not pursue this further.</p>
</div>
</section>
<section id="A6" class="ltx_appendix">
<h2 class="ltx_title ltx_title_appendix">
<span class="ltx_tag ltx_tag_appendix">Appendix F </span>Correspondence between single step EM and gradient ascent</h2>

<div id="A6.p1" class="ltx_para">
<p id="A6.p1.1" class="ltx_p">With the addition of the auxiliary variables <math id="A6.p1.1.m1.1" class="ltx_Math" alttext="\bm{\phi}_{s}" display="inline"><semantics id="A6.p1.1.m1.1a"><msub id="A6.p1.1.m1.1.1" xref="A6.p1.1.m1.1.1.cmml"><mi class="ltx_mathvariant_bold-italic" mathvariant="bold-italic" id="A6.p1.1.m1.1.1.2" xref="A6.p1.1.m1.1.1.2.cmml">ϕ</mi><mi id="A6.p1.1.m1.1.1.3" xref="A6.p1.1.m1.1.1.3.cmml">s</mi></msub><annotation-xml encoding="MathML-Content" id="A6.p1.1.m1.1b"><apply id="A6.p1.1.m1.1.1.cmml" xref="A6.p1.1.m1.1.1"><csymbol cd="ambiguous" id="A6.p1.1.m1.1.1.1.cmml" xref="A6.p1.1.m1.1.1">subscript</csymbol><ci id="A6.p1.1.m1.1.1.2.cmml" xref="A6.p1.1.m1.1.1.2">bold-italic-ϕ</ci><ci id="A6.p1.1.m1.1.1.3.cmml" xref="A6.p1.1.m1.1.1.3">𝑠</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A6.p1.1.m1.1c">\bm{\phi}_{s}</annotation></semantics></math> we have that the overall objective for the server becomes</p>
<table id="A10.EGx24" class="ltx_equationgroup ltx_eqn_align ltx_eqn_table">

<tbody id="A6.E27"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math id="A6.E27.m1.1" class="ltx_Math" alttext="\displaystyle\operatorname*{arg\,max}_{\mathbf{w}}\frac{1}{S}\sum_{s=1}^{S}\log\int p(\mathcal{D}_{s}|\bm{\phi}_{s})p(\bm{\phi}_{s}|\mathbf{w})\mathrm{d}\bm{\phi}_{s}." display="inline"><semantics id="A6.E27.m1.1a"><mrow id="A6.E27.m1.1.1.1" xref="A6.E27.m1.1.1.1.1.cmml"><mrow id="A6.E27.m1.1.1.1.1" xref="A6.E27.m1.1.1.1.1.cmml"><mrow id="A6.E27.m1.1.1.1.1.4" xref="A6.E27.m1.1.1.1.1.4.cmml"><munder id="A6.E27.m1.1.1.1.1.4.1" xref="A6.E27.m1.1.1.1.1.4.1.cmml"><mrow id="A6.E27.m1.1.1.1.1.4.1.2" xref="A6.E27.m1.1.1.1.1.4.1.2.cmml"><mi id="A6.E27.m1.1.1.1.1.4.1.2.2" xref="A6.E27.m1.1.1.1.1.4.1.2.2.cmml">arg</mi><mo lspace="0.170em" rspace="0em" id="A6.E27.m1.1.1.1.1.4.1.2.1" xref="A6.E27.m1.1.1.1.1.4.1.2.1.cmml">​</mo><mi id="A6.E27.m1.1.1.1.1.4.1.2.3" xref="A6.E27.m1.1.1.1.1.4.1.2.3.cmml">max</mi></mrow><mi id="A6.E27.m1.1.1.1.1.4.1.3" xref="A6.E27.m1.1.1.1.1.4.1.3.cmml">𝐰</mi></munder><mo lspace="0.167em" id="A6.E27.m1.1.1.1.1.4a" xref="A6.E27.m1.1.1.1.1.4.cmml">⁡</mo><mstyle displaystyle="true" id="A6.E27.m1.1.1.1.1.4.2" xref="A6.E27.m1.1.1.1.1.4.2.cmml"><mfrac id="A6.E27.m1.1.1.1.1.4.2a" xref="A6.E27.m1.1.1.1.1.4.2.cmml"><mn id="A6.E27.m1.1.1.1.1.4.2.2" xref="A6.E27.m1.1.1.1.1.4.2.2.cmml">1</mn><mi id="A6.E27.m1.1.1.1.1.4.2.3" xref="A6.E27.m1.1.1.1.1.4.2.3.cmml">S</mi></mfrac></mstyle></mrow><mo lspace="0em" rspace="0em" id="A6.E27.m1.1.1.1.1.3" xref="A6.E27.m1.1.1.1.1.3.cmml">​</mo><mrow id="A6.E27.m1.1.1.1.1.2" xref="A6.E27.m1.1.1.1.1.2.cmml"><mstyle displaystyle="true" id="A6.E27.m1.1.1.1.1.2.3" xref="A6.E27.m1.1.1.1.1.2.3.cmml"><munderover id="A6.E27.m1.1.1.1.1.2.3a" xref="A6.E27.m1.1.1.1.1.2.3.cmml"><mo movablelimits="false" id="A6.E27.m1.1.1.1.1.2.3.2.2" xref="A6.E27.m1.1.1.1.1.2.3.2.2.cmml">∑</mo><mrow id="A6.E27.m1.1.1.1.1.2.3.2.3" xref="A6.E27.m1.1.1.1.1.2.3.2.3.cmml"><mi id="A6.E27.m1.1.1.1.1.2.3.2.3.2" xref="A6.E27.m1.1.1.1.1.2.3.2.3.2.cmml">s</mi><mo id="A6.E27.m1.1.1.1.1.2.3.2.3.1" xref="A6.E27.m1.1.1.1.1.2.3.2.3.1.cmml">=</mo><mn id="A6.E27.m1.1.1.1.1.2.3.2.3.3" xref="A6.E27.m1.1.1.1.1.2.3.2.3.3.cmml">1</mn></mrow><mi id="A6.E27.m1.1.1.1.1.2.3.3" xref="A6.E27.m1.1.1.1.1.2.3.3.cmml">S</mi></munderover></mstyle><mrow id="A6.E27.m1.1.1.1.1.2.2" xref="A6.E27.m1.1.1.1.1.2.2.cmml"><mi id="A6.E27.m1.1.1.1.1.2.2.4" xref="A6.E27.m1.1.1.1.1.2.2.4.cmml">log</mi><mo lspace="0.167em" rspace="0em" id="A6.E27.m1.1.1.1.1.2.2.3" xref="A6.E27.m1.1.1.1.1.2.2.3.cmml">​</mo><mstyle displaystyle="true" id="A6.E27.m1.1.1.1.1.2.2.2" xref="A6.E27.m1.1.1.1.1.2.2.2.cmml"><mrow id="A6.E27.m1.1.1.1.1.2.2.2a" xref="A6.E27.m1.1.1.1.1.2.2.2.cmml"><mo id="A6.E27.m1.1.1.1.1.2.2.2.3" xref="A6.E27.m1.1.1.1.1.2.2.2.3.cmml">∫</mo><mrow id="A6.E27.m1.1.1.1.1.2.2.2.2" xref="A6.E27.m1.1.1.1.1.2.2.2.2.cmml"><mi id="A6.E27.m1.1.1.1.1.2.2.2.2.4" xref="A6.E27.m1.1.1.1.1.2.2.2.2.4.cmml">p</mi><mo lspace="0em" rspace="0em" id="A6.E27.m1.1.1.1.1.2.2.2.2.3" xref="A6.E27.m1.1.1.1.1.2.2.2.2.3.cmml">​</mo><mrow id="A6.E27.m1.1.1.1.1.1.1.1.1.1.1" xref="A6.E27.m1.1.1.1.1.1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="A6.E27.m1.1.1.1.1.1.1.1.1.1.1.2" xref="A6.E27.m1.1.1.1.1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="A6.E27.m1.1.1.1.1.1.1.1.1.1.1.1" xref="A6.E27.m1.1.1.1.1.1.1.1.1.1.1.1.cmml"><msub id="A6.E27.m1.1.1.1.1.1.1.1.1.1.1.1.2" xref="A6.E27.m1.1.1.1.1.1.1.1.1.1.1.1.2.cmml"><mi class="ltx_font_mathcaligraphic" id="A6.E27.m1.1.1.1.1.1.1.1.1.1.1.1.2.2" xref="A6.E27.m1.1.1.1.1.1.1.1.1.1.1.1.2.2.cmml">𝒟</mi><mi id="A6.E27.m1.1.1.1.1.1.1.1.1.1.1.1.2.3" xref="A6.E27.m1.1.1.1.1.1.1.1.1.1.1.1.2.3.cmml">s</mi></msub><mo fence="false" id="A6.E27.m1.1.1.1.1.1.1.1.1.1.1.1.1" xref="A6.E27.m1.1.1.1.1.1.1.1.1.1.1.1.1.cmml">|</mo><msub id="A6.E27.m1.1.1.1.1.1.1.1.1.1.1.1.3" xref="A6.E27.m1.1.1.1.1.1.1.1.1.1.1.1.3.cmml"><mi class="ltx_mathvariant_bold-italic" mathvariant="bold-italic" id="A6.E27.m1.1.1.1.1.1.1.1.1.1.1.1.3.2" xref="A6.E27.m1.1.1.1.1.1.1.1.1.1.1.1.3.2.cmml">ϕ</mi><mi id="A6.E27.m1.1.1.1.1.1.1.1.1.1.1.1.3.3" xref="A6.E27.m1.1.1.1.1.1.1.1.1.1.1.1.3.3.cmml">s</mi></msub></mrow><mo stretchy="false" id="A6.E27.m1.1.1.1.1.1.1.1.1.1.1.3" xref="A6.E27.m1.1.1.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow><mo lspace="0em" rspace="0em" id="A6.E27.m1.1.1.1.1.2.2.2.2.3a" xref="A6.E27.m1.1.1.1.1.2.2.2.2.3.cmml">​</mo><mi id="A6.E27.m1.1.1.1.1.2.2.2.2.5" xref="A6.E27.m1.1.1.1.1.2.2.2.2.5.cmml">p</mi><mo lspace="0em" rspace="0em" id="A6.E27.m1.1.1.1.1.2.2.2.2.3b" xref="A6.E27.m1.1.1.1.1.2.2.2.2.3.cmml">​</mo><mrow id="A6.E27.m1.1.1.1.1.2.2.2.2.2.1" xref="A6.E27.m1.1.1.1.1.2.2.2.2.2.1.1.cmml"><mo stretchy="false" id="A6.E27.m1.1.1.1.1.2.2.2.2.2.1.2" xref="A6.E27.m1.1.1.1.1.2.2.2.2.2.1.1.cmml">(</mo><mrow id="A6.E27.m1.1.1.1.1.2.2.2.2.2.1.1" xref="A6.E27.m1.1.1.1.1.2.2.2.2.2.1.1.cmml"><msub id="A6.E27.m1.1.1.1.1.2.2.2.2.2.1.1.2" xref="A6.E27.m1.1.1.1.1.2.2.2.2.2.1.1.2.cmml"><mi class="ltx_mathvariant_bold-italic" mathvariant="bold-italic" id="A6.E27.m1.1.1.1.1.2.2.2.2.2.1.1.2.2" xref="A6.E27.m1.1.1.1.1.2.2.2.2.2.1.1.2.2.cmml">ϕ</mi><mi id="A6.E27.m1.1.1.1.1.2.2.2.2.2.1.1.2.3" xref="A6.E27.m1.1.1.1.1.2.2.2.2.2.1.1.2.3.cmml">s</mi></msub><mo fence="false" id="A6.E27.m1.1.1.1.1.2.2.2.2.2.1.1.1" xref="A6.E27.m1.1.1.1.1.2.2.2.2.2.1.1.1.cmml">|</mo><mi id="A6.E27.m1.1.1.1.1.2.2.2.2.2.1.1.3" xref="A6.E27.m1.1.1.1.1.2.2.2.2.2.1.1.3.cmml">𝐰</mi></mrow><mo stretchy="false" id="A6.E27.m1.1.1.1.1.2.2.2.2.2.1.3" xref="A6.E27.m1.1.1.1.1.2.2.2.2.2.1.1.cmml">)</mo></mrow><mo lspace="0em" rspace="0em" id="A6.E27.m1.1.1.1.1.2.2.2.2.3c" xref="A6.E27.m1.1.1.1.1.2.2.2.2.3.cmml">​</mo><mrow id="A6.E27.m1.1.1.1.1.2.2.2.2.6" xref="A6.E27.m1.1.1.1.1.2.2.2.2.6.cmml"><mo rspace="0em" id="A6.E27.m1.1.1.1.1.2.2.2.2.6.1" xref="A6.E27.m1.1.1.1.1.2.2.2.2.6.1.cmml">d</mo><msub id="A6.E27.m1.1.1.1.1.2.2.2.2.6.2" xref="A6.E27.m1.1.1.1.1.2.2.2.2.6.2.cmml"><mi class="ltx_mathvariant_bold-italic" mathvariant="bold-italic" id="A6.E27.m1.1.1.1.1.2.2.2.2.6.2.2" xref="A6.E27.m1.1.1.1.1.2.2.2.2.6.2.2.cmml">ϕ</mi><mi id="A6.E27.m1.1.1.1.1.2.2.2.2.6.2.3" xref="A6.E27.m1.1.1.1.1.2.2.2.2.6.2.3.cmml">s</mi></msub></mrow></mrow></mrow></mstyle></mrow></mrow></mrow><mo lspace="0em" id="A6.E27.m1.1.1.1.2" xref="A6.E27.m1.1.1.1.1.cmml">.</mo></mrow><annotation-xml encoding="MathML-Content" id="A6.E27.m1.1b"><apply id="A6.E27.m1.1.1.1.1.cmml" xref="A6.E27.m1.1.1.1"><times id="A6.E27.m1.1.1.1.1.3.cmml" xref="A6.E27.m1.1.1.1.1.3"></times><apply id="A6.E27.m1.1.1.1.1.4.cmml" xref="A6.E27.m1.1.1.1.1.4"><apply id="A6.E27.m1.1.1.1.1.4.1.cmml" xref="A6.E27.m1.1.1.1.1.4.1"><csymbol cd="ambiguous" id="A6.E27.m1.1.1.1.1.4.1.1.cmml" xref="A6.E27.m1.1.1.1.1.4.1">subscript</csymbol><apply id="A6.E27.m1.1.1.1.1.4.1.2.cmml" xref="A6.E27.m1.1.1.1.1.4.1.2"><times id="A6.E27.m1.1.1.1.1.4.1.2.1.cmml" xref="A6.E27.m1.1.1.1.1.4.1.2.1"></times><ci id="A6.E27.m1.1.1.1.1.4.1.2.2.cmml" xref="A6.E27.m1.1.1.1.1.4.1.2.2">arg</ci><ci id="A6.E27.m1.1.1.1.1.4.1.2.3.cmml" xref="A6.E27.m1.1.1.1.1.4.1.2.3">max</ci></apply><ci id="A6.E27.m1.1.1.1.1.4.1.3.cmml" xref="A6.E27.m1.1.1.1.1.4.1.3">𝐰</ci></apply><apply id="A6.E27.m1.1.1.1.1.4.2.cmml" xref="A6.E27.m1.1.1.1.1.4.2"><divide id="A6.E27.m1.1.1.1.1.4.2.1.cmml" xref="A6.E27.m1.1.1.1.1.4.2"></divide><cn type="integer" id="A6.E27.m1.1.1.1.1.4.2.2.cmml" xref="A6.E27.m1.1.1.1.1.4.2.2">1</cn><ci id="A6.E27.m1.1.1.1.1.4.2.3.cmml" xref="A6.E27.m1.1.1.1.1.4.2.3">𝑆</ci></apply></apply><apply id="A6.E27.m1.1.1.1.1.2.cmml" xref="A6.E27.m1.1.1.1.1.2"><apply id="A6.E27.m1.1.1.1.1.2.3.cmml" xref="A6.E27.m1.1.1.1.1.2.3"><csymbol cd="ambiguous" id="A6.E27.m1.1.1.1.1.2.3.1.cmml" xref="A6.E27.m1.1.1.1.1.2.3">superscript</csymbol><apply id="A6.E27.m1.1.1.1.1.2.3.2.cmml" xref="A6.E27.m1.1.1.1.1.2.3"><csymbol cd="ambiguous" id="A6.E27.m1.1.1.1.1.2.3.2.1.cmml" xref="A6.E27.m1.1.1.1.1.2.3">subscript</csymbol><sum id="A6.E27.m1.1.1.1.1.2.3.2.2.cmml" xref="A6.E27.m1.1.1.1.1.2.3.2.2"></sum><apply id="A6.E27.m1.1.1.1.1.2.3.2.3.cmml" xref="A6.E27.m1.1.1.1.1.2.3.2.3"><eq id="A6.E27.m1.1.1.1.1.2.3.2.3.1.cmml" xref="A6.E27.m1.1.1.1.1.2.3.2.3.1"></eq><ci id="A6.E27.m1.1.1.1.1.2.3.2.3.2.cmml" xref="A6.E27.m1.1.1.1.1.2.3.2.3.2">𝑠</ci><cn type="integer" id="A6.E27.m1.1.1.1.1.2.3.2.3.3.cmml" xref="A6.E27.m1.1.1.1.1.2.3.2.3.3">1</cn></apply></apply><ci id="A6.E27.m1.1.1.1.1.2.3.3.cmml" xref="A6.E27.m1.1.1.1.1.2.3.3">𝑆</ci></apply><apply id="A6.E27.m1.1.1.1.1.2.2.cmml" xref="A6.E27.m1.1.1.1.1.2.2"><times id="A6.E27.m1.1.1.1.1.2.2.3.cmml" xref="A6.E27.m1.1.1.1.1.2.2.3"></times><log id="A6.E27.m1.1.1.1.1.2.2.4.cmml" xref="A6.E27.m1.1.1.1.1.2.2.4"></log><apply id="A6.E27.m1.1.1.1.1.2.2.2.cmml" xref="A6.E27.m1.1.1.1.1.2.2.2"><int id="A6.E27.m1.1.1.1.1.2.2.2.3.cmml" xref="A6.E27.m1.1.1.1.1.2.2.2.3"></int><apply id="A6.E27.m1.1.1.1.1.2.2.2.2.cmml" xref="A6.E27.m1.1.1.1.1.2.2.2.2"><times id="A6.E27.m1.1.1.1.1.2.2.2.2.3.cmml" xref="A6.E27.m1.1.1.1.1.2.2.2.2.3"></times><ci id="A6.E27.m1.1.1.1.1.2.2.2.2.4.cmml" xref="A6.E27.m1.1.1.1.1.2.2.2.2.4">𝑝</ci><apply id="A6.E27.m1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="A6.E27.m1.1.1.1.1.1.1.1.1.1.1"><csymbol cd="latexml" id="A6.E27.m1.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="A6.E27.m1.1.1.1.1.1.1.1.1.1.1.1.1">conditional</csymbol><apply id="A6.E27.m1.1.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="A6.E27.m1.1.1.1.1.1.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="A6.E27.m1.1.1.1.1.1.1.1.1.1.1.1.2.1.cmml" xref="A6.E27.m1.1.1.1.1.1.1.1.1.1.1.1.2">subscript</csymbol><ci id="A6.E27.m1.1.1.1.1.1.1.1.1.1.1.1.2.2.cmml" xref="A6.E27.m1.1.1.1.1.1.1.1.1.1.1.1.2.2">𝒟</ci><ci id="A6.E27.m1.1.1.1.1.1.1.1.1.1.1.1.2.3.cmml" xref="A6.E27.m1.1.1.1.1.1.1.1.1.1.1.1.2.3">𝑠</ci></apply><apply id="A6.E27.m1.1.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="A6.E27.m1.1.1.1.1.1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="A6.E27.m1.1.1.1.1.1.1.1.1.1.1.1.3.1.cmml" xref="A6.E27.m1.1.1.1.1.1.1.1.1.1.1.1.3">subscript</csymbol><ci id="A6.E27.m1.1.1.1.1.1.1.1.1.1.1.1.3.2.cmml" xref="A6.E27.m1.1.1.1.1.1.1.1.1.1.1.1.3.2">bold-italic-ϕ</ci><ci id="A6.E27.m1.1.1.1.1.1.1.1.1.1.1.1.3.3.cmml" xref="A6.E27.m1.1.1.1.1.1.1.1.1.1.1.1.3.3">𝑠</ci></apply></apply><ci id="A6.E27.m1.1.1.1.1.2.2.2.2.5.cmml" xref="A6.E27.m1.1.1.1.1.2.2.2.2.5">𝑝</ci><apply id="A6.E27.m1.1.1.1.1.2.2.2.2.2.1.1.cmml" xref="A6.E27.m1.1.1.1.1.2.2.2.2.2.1"><csymbol cd="latexml" id="A6.E27.m1.1.1.1.1.2.2.2.2.2.1.1.1.cmml" xref="A6.E27.m1.1.1.1.1.2.2.2.2.2.1.1.1">conditional</csymbol><apply id="A6.E27.m1.1.1.1.1.2.2.2.2.2.1.1.2.cmml" xref="A6.E27.m1.1.1.1.1.2.2.2.2.2.1.1.2"><csymbol cd="ambiguous" id="A6.E27.m1.1.1.1.1.2.2.2.2.2.1.1.2.1.cmml" xref="A6.E27.m1.1.1.1.1.2.2.2.2.2.1.1.2">subscript</csymbol><ci id="A6.E27.m1.1.1.1.1.2.2.2.2.2.1.1.2.2.cmml" xref="A6.E27.m1.1.1.1.1.2.2.2.2.2.1.1.2.2">bold-italic-ϕ</ci><ci id="A6.E27.m1.1.1.1.1.2.2.2.2.2.1.1.2.3.cmml" xref="A6.E27.m1.1.1.1.1.2.2.2.2.2.1.1.2.3">𝑠</ci></apply><ci id="A6.E27.m1.1.1.1.1.2.2.2.2.2.1.1.3.cmml" xref="A6.E27.m1.1.1.1.1.2.2.2.2.2.1.1.3">𝐰</ci></apply><apply id="A6.E27.m1.1.1.1.1.2.2.2.2.6.cmml" xref="A6.E27.m1.1.1.1.1.2.2.2.2.6"><csymbol cd="latexml" id="A6.E27.m1.1.1.1.1.2.2.2.2.6.1.cmml" xref="A6.E27.m1.1.1.1.1.2.2.2.2.6.1">differential-d</csymbol><apply id="A6.E27.m1.1.1.1.1.2.2.2.2.6.2.cmml" xref="A6.E27.m1.1.1.1.1.2.2.2.2.6.2"><csymbol cd="ambiguous" id="A6.E27.m1.1.1.1.1.2.2.2.2.6.2.1.cmml" xref="A6.E27.m1.1.1.1.1.2.2.2.2.6.2">subscript</csymbol><ci id="A6.E27.m1.1.1.1.1.2.2.2.2.6.2.2.cmml" xref="A6.E27.m1.1.1.1.1.2.2.2.2.6.2.2">bold-italic-ϕ</ci><ci id="A6.E27.m1.1.1.1.1.2.2.2.2.6.2.3.cmml" xref="A6.E27.m1.1.1.1.1.2.2.2.2.6.2.3">𝑠</ci></apply></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A6.E27.m1.1c">\displaystyle\operatorname*{arg\,max}_{\mathbf{w}}\frac{1}{S}\sum_{s=1}^{S}\log\int p(\mathcal{D}_{s}|\bm{\phi}_{s})p(\bm{\phi}_{s}|\mathbf{w})\mathrm{d}\bm{\phi}_{s}.</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(27)</span></td>
</tr></tbody>
</table>
<p id="A6.p1.4" class="ltx_p">By performing EM with a single gradient step for <math id="A6.p1.2.m1.1" class="ltx_Math" alttext="\mathbf{w}" display="inline"><semantics id="A6.p1.2.m1.1a"><mi id="A6.p1.2.m1.1.1" xref="A6.p1.2.m1.1.1.cmml">𝐰</mi><annotation-xml encoding="MathML-Content" id="A6.p1.2.m1.1b"><ci id="A6.p1.2.m1.1.1.cmml" xref="A6.p1.2.m1.1.1">𝐰</ci></annotation-xml><annotation encoding="application/x-tex" id="A6.p1.2.m1.1c">\mathbf{w}</annotation></semantics></math> in the M-step (instead of full maximization), we are essentially doing gradient ascent on the original objective at <a href="#A6.E27" title="In Appendix F Correspondence between single step EM and gradient ascent ‣ An Expectation-Maximization Perspective on Federated Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">27</span></a>. To see this, we can take the gradient of Eq. <a href="#A6.E27" title="In Appendix F Correspondence between single step EM and gradient ascent ‣ An Expectation-Maximization Perspective on Federated Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">27</span></a> w.r.t. <math id="A6.p1.3.m2.1" class="ltx_Math" alttext="\mathbf{w}" display="inline"><semantics id="A6.p1.3.m2.1a"><mi id="A6.p1.3.m2.1.1" xref="A6.p1.3.m2.1.1.cmml">𝐰</mi><annotation-xml encoding="MathML-Content" id="A6.p1.3.m2.1b"><ci id="A6.p1.3.m2.1.1.cmml" xref="A6.p1.3.m2.1.1">𝐰</ci></annotation-xml><annotation encoding="application/x-tex" id="A6.p1.3.m2.1c">\mathbf{w}</annotation></semantics></math> where <math id="A6.p1.4.m3.2" class="ltx_Math" alttext="Z_{s}=\int p(\mathcal{D}_{s}|\bm{\phi}_{s})p(\bm{\phi}_{s}|\mathbf{w})\mathrm{d}\bm{\phi}_{s}" display="inline"><semantics id="A6.p1.4.m3.2a"><mrow id="A6.p1.4.m3.2.2" xref="A6.p1.4.m3.2.2.cmml"><msub id="A6.p1.4.m3.2.2.4" xref="A6.p1.4.m3.2.2.4.cmml"><mi id="A6.p1.4.m3.2.2.4.2" xref="A6.p1.4.m3.2.2.4.2.cmml">Z</mi><mi id="A6.p1.4.m3.2.2.4.3" xref="A6.p1.4.m3.2.2.4.3.cmml">s</mi></msub><mo rspace="0.111em" id="A6.p1.4.m3.2.2.3" xref="A6.p1.4.m3.2.2.3.cmml">=</mo><mrow id="A6.p1.4.m3.2.2.2" xref="A6.p1.4.m3.2.2.2.cmml"><mo id="A6.p1.4.m3.2.2.2.3" xref="A6.p1.4.m3.2.2.2.3.cmml">∫</mo><mrow id="A6.p1.4.m3.2.2.2.2" xref="A6.p1.4.m3.2.2.2.2.cmml"><mi id="A6.p1.4.m3.2.2.2.2.4" xref="A6.p1.4.m3.2.2.2.2.4.cmml">p</mi><mo lspace="0em" rspace="0em" id="A6.p1.4.m3.2.2.2.2.3" xref="A6.p1.4.m3.2.2.2.2.3.cmml">​</mo><mrow id="A6.p1.4.m3.1.1.1.1.1.1" xref="A6.p1.4.m3.1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="A6.p1.4.m3.1.1.1.1.1.1.2" xref="A6.p1.4.m3.1.1.1.1.1.1.1.cmml">(</mo><mrow id="A6.p1.4.m3.1.1.1.1.1.1.1" xref="A6.p1.4.m3.1.1.1.1.1.1.1.cmml"><msub id="A6.p1.4.m3.1.1.1.1.1.1.1.2" xref="A6.p1.4.m3.1.1.1.1.1.1.1.2.cmml"><mi class="ltx_font_mathcaligraphic" id="A6.p1.4.m3.1.1.1.1.1.1.1.2.2" xref="A6.p1.4.m3.1.1.1.1.1.1.1.2.2.cmml">𝒟</mi><mi id="A6.p1.4.m3.1.1.1.1.1.1.1.2.3" xref="A6.p1.4.m3.1.1.1.1.1.1.1.2.3.cmml">s</mi></msub><mo fence="false" id="A6.p1.4.m3.1.1.1.1.1.1.1.1" xref="A6.p1.4.m3.1.1.1.1.1.1.1.1.cmml">|</mo><msub id="A6.p1.4.m3.1.1.1.1.1.1.1.3" xref="A6.p1.4.m3.1.1.1.1.1.1.1.3.cmml"><mi class="ltx_mathvariant_bold-italic" mathvariant="bold-italic" id="A6.p1.4.m3.1.1.1.1.1.1.1.3.2" xref="A6.p1.4.m3.1.1.1.1.1.1.1.3.2.cmml">ϕ</mi><mi id="A6.p1.4.m3.1.1.1.1.1.1.1.3.3" xref="A6.p1.4.m3.1.1.1.1.1.1.1.3.3.cmml">s</mi></msub></mrow><mo stretchy="false" id="A6.p1.4.m3.1.1.1.1.1.1.3" xref="A6.p1.4.m3.1.1.1.1.1.1.1.cmml">)</mo></mrow><mo lspace="0em" rspace="0em" id="A6.p1.4.m3.2.2.2.2.3a" xref="A6.p1.4.m3.2.2.2.2.3.cmml">​</mo><mi id="A6.p1.4.m3.2.2.2.2.5" xref="A6.p1.4.m3.2.2.2.2.5.cmml">p</mi><mo lspace="0em" rspace="0em" id="A6.p1.4.m3.2.2.2.2.3b" xref="A6.p1.4.m3.2.2.2.2.3.cmml">​</mo><mrow id="A6.p1.4.m3.2.2.2.2.2.1" xref="A6.p1.4.m3.2.2.2.2.2.1.1.cmml"><mo stretchy="false" id="A6.p1.4.m3.2.2.2.2.2.1.2" xref="A6.p1.4.m3.2.2.2.2.2.1.1.cmml">(</mo><mrow id="A6.p1.4.m3.2.2.2.2.2.1.1" xref="A6.p1.4.m3.2.2.2.2.2.1.1.cmml"><msub id="A6.p1.4.m3.2.2.2.2.2.1.1.2" xref="A6.p1.4.m3.2.2.2.2.2.1.1.2.cmml"><mi class="ltx_mathvariant_bold-italic" mathvariant="bold-italic" id="A6.p1.4.m3.2.2.2.2.2.1.1.2.2" xref="A6.p1.4.m3.2.2.2.2.2.1.1.2.2.cmml">ϕ</mi><mi id="A6.p1.4.m3.2.2.2.2.2.1.1.2.3" xref="A6.p1.4.m3.2.2.2.2.2.1.1.2.3.cmml">s</mi></msub><mo fence="false" id="A6.p1.4.m3.2.2.2.2.2.1.1.1" xref="A6.p1.4.m3.2.2.2.2.2.1.1.1.cmml">|</mo><mi id="A6.p1.4.m3.2.2.2.2.2.1.1.3" xref="A6.p1.4.m3.2.2.2.2.2.1.1.3.cmml">𝐰</mi></mrow><mo stretchy="false" id="A6.p1.4.m3.2.2.2.2.2.1.3" xref="A6.p1.4.m3.2.2.2.2.2.1.1.cmml">)</mo></mrow><mo lspace="0em" rspace="0em" id="A6.p1.4.m3.2.2.2.2.3c" xref="A6.p1.4.m3.2.2.2.2.3.cmml">​</mo><mrow id="A6.p1.4.m3.2.2.2.2.6" xref="A6.p1.4.m3.2.2.2.2.6.cmml"><mo rspace="0em" id="A6.p1.4.m3.2.2.2.2.6.1" xref="A6.p1.4.m3.2.2.2.2.6.1.cmml">d</mo><msub id="A6.p1.4.m3.2.2.2.2.6.2" xref="A6.p1.4.m3.2.2.2.2.6.2.cmml"><mi class="ltx_mathvariant_bold-italic" mathvariant="bold-italic" id="A6.p1.4.m3.2.2.2.2.6.2.2" xref="A6.p1.4.m3.2.2.2.2.6.2.2.cmml">ϕ</mi><mi id="A6.p1.4.m3.2.2.2.2.6.2.3" xref="A6.p1.4.m3.2.2.2.2.6.2.3.cmml">s</mi></msub></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="A6.p1.4.m3.2b"><apply id="A6.p1.4.m3.2.2.cmml" xref="A6.p1.4.m3.2.2"><eq id="A6.p1.4.m3.2.2.3.cmml" xref="A6.p1.4.m3.2.2.3"></eq><apply id="A6.p1.4.m3.2.2.4.cmml" xref="A6.p1.4.m3.2.2.4"><csymbol cd="ambiguous" id="A6.p1.4.m3.2.2.4.1.cmml" xref="A6.p1.4.m3.2.2.4">subscript</csymbol><ci id="A6.p1.4.m3.2.2.4.2.cmml" xref="A6.p1.4.m3.2.2.4.2">𝑍</ci><ci id="A6.p1.4.m3.2.2.4.3.cmml" xref="A6.p1.4.m3.2.2.4.3">𝑠</ci></apply><apply id="A6.p1.4.m3.2.2.2.cmml" xref="A6.p1.4.m3.2.2.2"><int id="A6.p1.4.m3.2.2.2.3.cmml" xref="A6.p1.4.m3.2.2.2.3"></int><apply id="A6.p1.4.m3.2.2.2.2.cmml" xref="A6.p1.4.m3.2.2.2.2"><times id="A6.p1.4.m3.2.2.2.2.3.cmml" xref="A6.p1.4.m3.2.2.2.2.3"></times><ci id="A6.p1.4.m3.2.2.2.2.4.cmml" xref="A6.p1.4.m3.2.2.2.2.4">𝑝</ci><apply id="A6.p1.4.m3.1.1.1.1.1.1.1.cmml" xref="A6.p1.4.m3.1.1.1.1.1.1"><csymbol cd="latexml" id="A6.p1.4.m3.1.1.1.1.1.1.1.1.cmml" xref="A6.p1.4.m3.1.1.1.1.1.1.1.1">conditional</csymbol><apply id="A6.p1.4.m3.1.1.1.1.1.1.1.2.cmml" xref="A6.p1.4.m3.1.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="A6.p1.4.m3.1.1.1.1.1.1.1.2.1.cmml" xref="A6.p1.4.m3.1.1.1.1.1.1.1.2">subscript</csymbol><ci id="A6.p1.4.m3.1.1.1.1.1.1.1.2.2.cmml" xref="A6.p1.4.m3.1.1.1.1.1.1.1.2.2">𝒟</ci><ci id="A6.p1.4.m3.1.1.1.1.1.1.1.2.3.cmml" xref="A6.p1.4.m3.1.1.1.1.1.1.1.2.3">𝑠</ci></apply><apply id="A6.p1.4.m3.1.1.1.1.1.1.1.3.cmml" xref="A6.p1.4.m3.1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="A6.p1.4.m3.1.1.1.1.1.1.1.3.1.cmml" xref="A6.p1.4.m3.1.1.1.1.1.1.1.3">subscript</csymbol><ci id="A6.p1.4.m3.1.1.1.1.1.1.1.3.2.cmml" xref="A6.p1.4.m3.1.1.1.1.1.1.1.3.2">bold-italic-ϕ</ci><ci id="A6.p1.4.m3.1.1.1.1.1.1.1.3.3.cmml" xref="A6.p1.4.m3.1.1.1.1.1.1.1.3.3">𝑠</ci></apply></apply><ci id="A6.p1.4.m3.2.2.2.2.5.cmml" xref="A6.p1.4.m3.2.2.2.2.5">𝑝</ci><apply id="A6.p1.4.m3.2.2.2.2.2.1.1.cmml" xref="A6.p1.4.m3.2.2.2.2.2.1"><csymbol cd="latexml" id="A6.p1.4.m3.2.2.2.2.2.1.1.1.cmml" xref="A6.p1.4.m3.2.2.2.2.2.1.1.1">conditional</csymbol><apply id="A6.p1.4.m3.2.2.2.2.2.1.1.2.cmml" xref="A6.p1.4.m3.2.2.2.2.2.1.1.2"><csymbol cd="ambiguous" id="A6.p1.4.m3.2.2.2.2.2.1.1.2.1.cmml" xref="A6.p1.4.m3.2.2.2.2.2.1.1.2">subscript</csymbol><ci id="A6.p1.4.m3.2.2.2.2.2.1.1.2.2.cmml" xref="A6.p1.4.m3.2.2.2.2.2.1.1.2.2">bold-italic-ϕ</ci><ci id="A6.p1.4.m3.2.2.2.2.2.1.1.2.3.cmml" xref="A6.p1.4.m3.2.2.2.2.2.1.1.2.3">𝑠</ci></apply><ci id="A6.p1.4.m3.2.2.2.2.2.1.1.3.cmml" xref="A6.p1.4.m3.2.2.2.2.2.1.1.3">𝐰</ci></apply><apply id="A6.p1.4.m3.2.2.2.2.6.cmml" xref="A6.p1.4.m3.2.2.2.2.6"><csymbol cd="latexml" id="A6.p1.4.m3.2.2.2.2.6.1.cmml" xref="A6.p1.4.m3.2.2.2.2.6.1">differential-d</csymbol><apply id="A6.p1.4.m3.2.2.2.2.6.2.cmml" xref="A6.p1.4.m3.2.2.2.2.6.2"><csymbol cd="ambiguous" id="A6.p1.4.m3.2.2.2.2.6.2.1.cmml" xref="A6.p1.4.m3.2.2.2.2.6.2">subscript</csymbol><ci id="A6.p1.4.m3.2.2.2.2.6.2.2.cmml" xref="A6.p1.4.m3.2.2.2.2.6.2.2">bold-italic-ϕ</ci><ci id="A6.p1.4.m3.2.2.2.2.6.2.3.cmml" xref="A6.p1.4.m3.2.2.2.2.6.2.3">𝑠</ci></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A6.p1.4.m3.2c">Z_{s}=\int p(\mathcal{D}_{s}|\bm{\phi}_{s})p(\bm{\phi}_{s}|\mathbf{w})\mathrm{d}\bm{\phi}_{s}</annotation></semantics></math></p>
<table id="A10.EGx25" class="ltx_equationgroup ltx_eqn_align ltx_eqn_table">

<tbody id="A6.E28"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math id="A6.E28.m1.2" class="ltx_Math" alttext="\displaystyle\frac{1}{S}\sum_{s}\frac{1}{Z_{s}}\int p(\mathcal{D}_{s}|\bm{\phi}_{s})\frac{\partial p(\bm{\phi}_{s}|\mathbf{w})}{\partial\mathbf{w}}\mathrm{d}\bm{\phi}_{s}=" display="inline"><semantics id="A6.E28.m1.2a"><mrow id="A6.E28.m1.2.2" xref="A6.E28.m1.2.2.cmml"><mrow id="A6.E28.m1.2.2.1" xref="A6.E28.m1.2.2.1.cmml"><mstyle displaystyle="true" id="A6.E28.m1.2.2.1.3" xref="A6.E28.m1.2.2.1.3.cmml"><mfrac id="A6.E28.m1.2.2.1.3a" xref="A6.E28.m1.2.2.1.3.cmml"><mn id="A6.E28.m1.2.2.1.3.2" xref="A6.E28.m1.2.2.1.3.2.cmml">1</mn><mi id="A6.E28.m1.2.2.1.3.3" xref="A6.E28.m1.2.2.1.3.3.cmml">S</mi></mfrac></mstyle><mo lspace="0em" rspace="0em" id="A6.E28.m1.2.2.1.2" xref="A6.E28.m1.2.2.1.2.cmml">​</mo><mrow id="A6.E28.m1.2.2.1.1" xref="A6.E28.m1.2.2.1.1.cmml"><mstyle displaystyle="true" id="A6.E28.m1.2.2.1.1.2" xref="A6.E28.m1.2.2.1.1.2.cmml"><munder id="A6.E28.m1.2.2.1.1.2a" xref="A6.E28.m1.2.2.1.1.2.cmml"><mo movablelimits="false" id="A6.E28.m1.2.2.1.1.2.2" xref="A6.E28.m1.2.2.1.1.2.2.cmml">∑</mo><mi id="A6.E28.m1.2.2.1.1.2.3" xref="A6.E28.m1.2.2.1.1.2.3.cmml">s</mi></munder></mstyle><mrow id="A6.E28.m1.2.2.1.1.1" xref="A6.E28.m1.2.2.1.1.1.cmml"><mstyle displaystyle="true" id="A6.E28.m1.2.2.1.1.1.3" xref="A6.E28.m1.2.2.1.1.1.3.cmml"><mfrac id="A6.E28.m1.2.2.1.1.1.3a" xref="A6.E28.m1.2.2.1.1.1.3.cmml"><mn id="A6.E28.m1.2.2.1.1.1.3.2" xref="A6.E28.m1.2.2.1.1.1.3.2.cmml">1</mn><msub id="A6.E28.m1.2.2.1.1.1.3.3" xref="A6.E28.m1.2.2.1.1.1.3.3.cmml"><mi id="A6.E28.m1.2.2.1.1.1.3.3.2" xref="A6.E28.m1.2.2.1.1.1.3.3.2.cmml">Z</mi><mi id="A6.E28.m1.2.2.1.1.1.3.3.3" xref="A6.E28.m1.2.2.1.1.1.3.3.3.cmml">s</mi></msub></mfrac></mstyle><mo lspace="0em" rspace="0em" id="A6.E28.m1.2.2.1.1.1.2" xref="A6.E28.m1.2.2.1.1.1.2.cmml">​</mo><mstyle displaystyle="true" id="A6.E28.m1.2.2.1.1.1.1" xref="A6.E28.m1.2.2.1.1.1.1.cmml"><mrow id="A6.E28.m1.2.2.1.1.1.1a" xref="A6.E28.m1.2.2.1.1.1.1.cmml"><mo id="A6.E28.m1.2.2.1.1.1.1.2" xref="A6.E28.m1.2.2.1.1.1.1.2.cmml">∫</mo><mrow id="A6.E28.m1.2.2.1.1.1.1.1" xref="A6.E28.m1.2.2.1.1.1.1.1.cmml"><mi id="A6.E28.m1.2.2.1.1.1.1.1.3" xref="A6.E28.m1.2.2.1.1.1.1.1.3.cmml">p</mi><mo lspace="0em" rspace="0em" id="A6.E28.m1.2.2.1.1.1.1.1.2" xref="A6.E28.m1.2.2.1.1.1.1.1.2.cmml">​</mo><mrow id="A6.E28.m1.2.2.1.1.1.1.1.1.1" xref="A6.E28.m1.2.2.1.1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="A6.E28.m1.2.2.1.1.1.1.1.1.1.2" xref="A6.E28.m1.2.2.1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="A6.E28.m1.2.2.1.1.1.1.1.1.1.1" xref="A6.E28.m1.2.2.1.1.1.1.1.1.1.1.cmml"><msub id="A6.E28.m1.2.2.1.1.1.1.1.1.1.1.2" xref="A6.E28.m1.2.2.1.1.1.1.1.1.1.1.2.cmml"><mi class="ltx_font_mathcaligraphic" id="A6.E28.m1.2.2.1.1.1.1.1.1.1.1.2.2" xref="A6.E28.m1.2.2.1.1.1.1.1.1.1.1.2.2.cmml">𝒟</mi><mi id="A6.E28.m1.2.2.1.1.1.1.1.1.1.1.2.3" xref="A6.E28.m1.2.2.1.1.1.1.1.1.1.1.2.3.cmml">s</mi></msub><mo fence="false" id="A6.E28.m1.2.2.1.1.1.1.1.1.1.1.1" xref="A6.E28.m1.2.2.1.1.1.1.1.1.1.1.1.cmml">|</mo><msub id="A6.E28.m1.2.2.1.1.1.1.1.1.1.1.3" xref="A6.E28.m1.2.2.1.1.1.1.1.1.1.1.3.cmml"><mi class="ltx_mathvariant_bold-italic" mathvariant="bold-italic" id="A6.E28.m1.2.2.1.1.1.1.1.1.1.1.3.2" xref="A6.E28.m1.2.2.1.1.1.1.1.1.1.1.3.2.cmml">ϕ</mi><mi id="A6.E28.m1.2.2.1.1.1.1.1.1.1.1.3.3" xref="A6.E28.m1.2.2.1.1.1.1.1.1.1.1.3.3.cmml">s</mi></msub></mrow><mo stretchy="false" id="A6.E28.m1.2.2.1.1.1.1.1.1.1.3" xref="A6.E28.m1.2.2.1.1.1.1.1.1.1.1.cmml">)</mo></mrow><mo lspace="0em" rspace="0em" id="A6.E28.m1.2.2.1.1.1.1.1.2a" xref="A6.E28.m1.2.2.1.1.1.1.1.2.cmml">​</mo><mfrac id="A6.E28.m1.1.1" xref="A6.E28.m1.1.1.cmml"><mrow id="A6.E28.m1.1.1.1" xref="A6.E28.m1.1.1.1.cmml"><mo rspace="0em" id="A6.E28.m1.1.1.1.2" xref="A6.E28.m1.1.1.1.2.cmml">∂</mo><mrow id="A6.E28.m1.1.1.1.1" xref="A6.E28.m1.1.1.1.1.cmml"><mi id="A6.E28.m1.1.1.1.1.3" xref="A6.E28.m1.1.1.1.1.3.cmml">p</mi><mo lspace="0em" rspace="0em" id="A6.E28.m1.1.1.1.1.2" xref="A6.E28.m1.1.1.1.1.2.cmml">​</mo><mrow id="A6.E28.m1.1.1.1.1.1.1" xref="A6.E28.m1.1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="A6.E28.m1.1.1.1.1.1.1.2" xref="A6.E28.m1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="A6.E28.m1.1.1.1.1.1.1.1" xref="A6.E28.m1.1.1.1.1.1.1.1.cmml"><msub id="A6.E28.m1.1.1.1.1.1.1.1.2" xref="A6.E28.m1.1.1.1.1.1.1.1.2.cmml"><mi class="ltx_mathvariant_bold-italic" mathvariant="bold-italic" id="A6.E28.m1.1.1.1.1.1.1.1.2.2" xref="A6.E28.m1.1.1.1.1.1.1.1.2.2.cmml">ϕ</mi><mi id="A6.E28.m1.1.1.1.1.1.1.1.2.3" xref="A6.E28.m1.1.1.1.1.1.1.1.2.3.cmml">s</mi></msub><mo fence="false" id="A6.E28.m1.1.1.1.1.1.1.1.1" xref="A6.E28.m1.1.1.1.1.1.1.1.1.cmml">|</mo><mi id="A6.E28.m1.1.1.1.1.1.1.1.3" xref="A6.E28.m1.1.1.1.1.1.1.1.3.cmml">𝐰</mi></mrow><mo stretchy="false" id="A6.E28.m1.1.1.1.1.1.1.3" xref="A6.E28.m1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><mrow id="A6.E28.m1.1.1.3" xref="A6.E28.m1.1.1.3.cmml"><mo rspace="0em" id="A6.E28.m1.1.1.3.1" xref="A6.E28.m1.1.1.3.1.cmml">∂</mo><mi id="A6.E28.m1.1.1.3.2" xref="A6.E28.m1.1.1.3.2.cmml">𝐰</mi></mrow></mfrac><mo lspace="0em" rspace="0em" id="A6.E28.m1.2.2.1.1.1.1.1.2b" xref="A6.E28.m1.2.2.1.1.1.1.1.2.cmml">​</mo><mrow id="A6.E28.m1.2.2.1.1.1.1.1.4" xref="A6.E28.m1.2.2.1.1.1.1.1.4.cmml"><mo rspace="0em" id="A6.E28.m1.2.2.1.1.1.1.1.4.1" xref="A6.E28.m1.2.2.1.1.1.1.1.4.1.cmml">d</mo><msub id="A6.E28.m1.2.2.1.1.1.1.1.4.2" xref="A6.E28.m1.2.2.1.1.1.1.1.4.2.cmml"><mi class="ltx_mathvariant_bold-italic" mathvariant="bold-italic" id="A6.E28.m1.2.2.1.1.1.1.1.4.2.2" xref="A6.E28.m1.2.2.1.1.1.1.1.4.2.2.cmml">ϕ</mi><mi id="A6.E28.m1.2.2.1.1.1.1.1.4.2.3" xref="A6.E28.m1.2.2.1.1.1.1.1.4.2.3.cmml">s</mi></msub></mrow></mrow></mrow></mstyle></mrow></mrow></mrow><mo id="A6.E28.m1.2.2.2" xref="A6.E28.m1.2.2.2.cmml">=</mo><mi id="A6.E28.m1.2.2.3" xref="A6.E28.m1.2.2.3.cmml"></mi></mrow><annotation-xml encoding="MathML-Content" id="A6.E28.m1.2b"><apply id="A6.E28.m1.2.2.cmml" xref="A6.E28.m1.2.2"><eq id="A6.E28.m1.2.2.2.cmml" xref="A6.E28.m1.2.2.2"></eq><apply id="A6.E28.m1.2.2.1.cmml" xref="A6.E28.m1.2.2.1"><times id="A6.E28.m1.2.2.1.2.cmml" xref="A6.E28.m1.2.2.1.2"></times><apply id="A6.E28.m1.2.2.1.3.cmml" xref="A6.E28.m1.2.2.1.3"><divide id="A6.E28.m1.2.2.1.3.1.cmml" xref="A6.E28.m1.2.2.1.3"></divide><cn type="integer" id="A6.E28.m1.2.2.1.3.2.cmml" xref="A6.E28.m1.2.2.1.3.2">1</cn><ci id="A6.E28.m1.2.2.1.3.3.cmml" xref="A6.E28.m1.2.2.1.3.3">𝑆</ci></apply><apply id="A6.E28.m1.2.2.1.1.cmml" xref="A6.E28.m1.2.2.1.1"><apply id="A6.E28.m1.2.2.1.1.2.cmml" xref="A6.E28.m1.2.2.1.1.2"><csymbol cd="ambiguous" id="A6.E28.m1.2.2.1.1.2.1.cmml" xref="A6.E28.m1.2.2.1.1.2">subscript</csymbol><sum id="A6.E28.m1.2.2.1.1.2.2.cmml" xref="A6.E28.m1.2.2.1.1.2.2"></sum><ci id="A6.E28.m1.2.2.1.1.2.3.cmml" xref="A6.E28.m1.2.2.1.1.2.3">𝑠</ci></apply><apply id="A6.E28.m1.2.2.1.1.1.cmml" xref="A6.E28.m1.2.2.1.1.1"><times id="A6.E28.m1.2.2.1.1.1.2.cmml" xref="A6.E28.m1.2.2.1.1.1.2"></times><apply id="A6.E28.m1.2.2.1.1.1.3.cmml" xref="A6.E28.m1.2.2.1.1.1.3"><divide id="A6.E28.m1.2.2.1.1.1.3.1.cmml" xref="A6.E28.m1.2.2.1.1.1.3"></divide><cn type="integer" id="A6.E28.m1.2.2.1.1.1.3.2.cmml" xref="A6.E28.m1.2.2.1.1.1.3.2">1</cn><apply id="A6.E28.m1.2.2.1.1.1.3.3.cmml" xref="A6.E28.m1.2.2.1.1.1.3.3"><csymbol cd="ambiguous" id="A6.E28.m1.2.2.1.1.1.3.3.1.cmml" xref="A6.E28.m1.2.2.1.1.1.3.3">subscript</csymbol><ci id="A6.E28.m1.2.2.1.1.1.3.3.2.cmml" xref="A6.E28.m1.2.2.1.1.1.3.3.2">𝑍</ci><ci id="A6.E28.m1.2.2.1.1.1.3.3.3.cmml" xref="A6.E28.m1.2.2.1.1.1.3.3.3">𝑠</ci></apply></apply><apply id="A6.E28.m1.2.2.1.1.1.1.cmml" xref="A6.E28.m1.2.2.1.1.1.1"><int id="A6.E28.m1.2.2.1.1.1.1.2.cmml" xref="A6.E28.m1.2.2.1.1.1.1.2"></int><apply id="A6.E28.m1.2.2.1.1.1.1.1.cmml" xref="A6.E28.m1.2.2.1.1.1.1.1"><times id="A6.E28.m1.2.2.1.1.1.1.1.2.cmml" xref="A6.E28.m1.2.2.1.1.1.1.1.2"></times><ci id="A6.E28.m1.2.2.1.1.1.1.1.3.cmml" xref="A6.E28.m1.2.2.1.1.1.1.1.3">𝑝</ci><apply id="A6.E28.m1.2.2.1.1.1.1.1.1.1.1.cmml" xref="A6.E28.m1.2.2.1.1.1.1.1.1.1"><csymbol cd="latexml" id="A6.E28.m1.2.2.1.1.1.1.1.1.1.1.1.cmml" xref="A6.E28.m1.2.2.1.1.1.1.1.1.1.1.1">conditional</csymbol><apply id="A6.E28.m1.2.2.1.1.1.1.1.1.1.1.2.cmml" xref="A6.E28.m1.2.2.1.1.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="A6.E28.m1.2.2.1.1.1.1.1.1.1.1.2.1.cmml" xref="A6.E28.m1.2.2.1.1.1.1.1.1.1.1.2">subscript</csymbol><ci id="A6.E28.m1.2.2.1.1.1.1.1.1.1.1.2.2.cmml" xref="A6.E28.m1.2.2.1.1.1.1.1.1.1.1.2.2">𝒟</ci><ci id="A6.E28.m1.2.2.1.1.1.1.1.1.1.1.2.3.cmml" xref="A6.E28.m1.2.2.1.1.1.1.1.1.1.1.2.3">𝑠</ci></apply><apply id="A6.E28.m1.2.2.1.1.1.1.1.1.1.1.3.cmml" xref="A6.E28.m1.2.2.1.1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="A6.E28.m1.2.2.1.1.1.1.1.1.1.1.3.1.cmml" xref="A6.E28.m1.2.2.1.1.1.1.1.1.1.1.3">subscript</csymbol><ci id="A6.E28.m1.2.2.1.1.1.1.1.1.1.1.3.2.cmml" xref="A6.E28.m1.2.2.1.1.1.1.1.1.1.1.3.2">bold-italic-ϕ</ci><ci id="A6.E28.m1.2.2.1.1.1.1.1.1.1.1.3.3.cmml" xref="A6.E28.m1.2.2.1.1.1.1.1.1.1.1.3.3">𝑠</ci></apply></apply><apply id="A6.E28.m1.1.1.cmml" xref="A6.E28.m1.1.1"><divide id="A6.E28.m1.1.1.2.cmml" xref="A6.E28.m1.1.1"></divide><apply id="A6.E28.m1.1.1.1.cmml" xref="A6.E28.m1.1.1.1"><partialdiff id="A6.E28.m1.1.1.1.2.cmml" xref="A6.E28.m1.1.1.1.2"></partialdiff><apply id="A6.E28.m1.1.1.1.1.cmml" xref="A6.E28.m1.1.1.1.1"><times id="A6.E28.m1.1.1.1.1.2.cmml" xref="A6.E28.m1.1.1.1.1.2"></times><ci id="A6.E28.m1.1.1.1.1.3.cmml" xref="A6.E28.m1.1.1.1.1.3">𝑝</ci><apply id="A6.E28.m1.1.1.1.1.1.1.1.cmml" xref="A6.E28.m1.1.1.1.1.1.1"><csymbol cd="latexml" id="A6.E28.m1.1.1.1.1.1.1.1.1.cmml" xref="A6.E28.m1.1.1.1.1.1.1.1.1">conditional</csymbol><apply id="A6.E28.m1.1.1.1.1.1.1.1.2.cmml" xref="A6.E28.m1.1.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="A6.E28.m1.1.1.1.1.1.1.1.2.1.cmml" xref="A6.E28.m1.1.1.1.1.1.1.1.2">subscript</csymbol><ci id="A6.E28.m1.1.1.1.1.1.1.1.2.2.cmml" xref="A6.E28.m1.1.1.1.1.1.1.1.2.2">bold-italic-ϕ</ci><ci id="A6.E28.m1.1.1.1.1.1.1.1.2.3.cmml" xref="A6.E28.m1.1.1.1.1.1.1.1.2.3">𝑠</ci></apply><ci id="A6.E28.m1.1.1.1.1.1.1.1.3.cmml" xref="A6.E28.m1.1.1.1.1.1.1.1.3">𝐰</ci></apply></apply></apply><apply id="A6.E28.m1.1.1.3.cmml" xref="A6.E28.m1.1.1.3"><partialdiff id="A6.E28.m1.1.1.3.1.cmml" xref="A6.E28.m1.1.1.3.1"></partialdiff><ci id="A6.E28.m1.1.1.3.2.cmml" xref="A6.E28.m1.1.1.3.2">𝐰</ci></apply></apply><apply id="A6.E28.m1.2.2.1.1.1.1.1.4.cmml" xref="A6.E28.m1.2.2.1.1.1.1.1.4"><csymbol cd="latexml" id="A6.E28.m1.2.2.1.1.1.1.1.4.1.cmml" xref="A6.E28.m1.2.2.1.1.1.1.1.4.1">differential-d</csymbol><apply id="A6.E28.m1.2.2.1.1.1.1.1.4.2.cmml" xref="A6.E28.m1.2.2.1.1.1.1.1.4.2"><csymbol cd="ambiguous" id="A6.E28.m1.2.2.1.1.1.1.1.4.2.1.cmml" xref="A6.E28.m1.2.2.1.1.1.1.1.4.2">subscript</csymbol><ci id="A6.E28.m1.2.2.1.1.1.1.1.4.2.2.cmml" xref="A6.E28.m1.2.2.1.1.1.1.1.4.2.2">bold-italic-ϕ</ci><ci id="A6.E28.m1.2.2.1.1.1.1.1.4.2.3.cmml" xref="A6.E28.m1.2.2.1.1.1.1.1.4.2.3">𝑠</ci></apply></apply></apply></apply></apply></apply></apply><csymbol cd="latexml" id="A6.E28.m1.2.2.3.cmml" xref="A6.E28.m1.2.2.3">absent</csymbol></apply></annotation-xml><annotation encoding="application/x-tex" id="A6.E28.m1.2c">\displaystyle\frac{1}{S}\sum_{s}\frac{1}{Z_{s}}\int p(\mathcal{D}_{s}|\bm{\phi}_{s})\frac{\partial p(\bm{\phi}_{s}|\mathbf{w})}{\partial\mathbf{w}}\mathrm{d}\bm{\phi}_{s}=</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(28)</span></td>
</tr></tbody>
<tbody id="A6.E29"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math id="A6.E29.m1.3" class="ltx_Math" alttext="\displaystyle\frac{1}{S}\sum_{s}\int\frac{p(\mathcal{D}_{s}|\bm{\phi}_{s})p(\bm{\phi}_{s}|\mathbf{w})}{Z_{s}}\frac{\partial\log p(\bm{\phi}_{s}|\mathbf{w})}{\partial\mathbf{w}}\mathrm{d}\bm{\phi}_{s}=" display="inline"><semantics id="A6.E29.m1.3a"><mrow id="A6.E29.m1.3.4" xref="A6.E29.m1.3.4.cmml"><mrow id="A6.E29.m1.3.4.2" xref="A6.E29.m1.3.4.2.cmml"><mstyle displaystyle="true" id="A6.E29.m1.3.4.2.2" xref="A6.E29.m1.3.4.2.2.cmml"><mfrac id="A6.E29.m1.3.4.2.2a" xref="A6.E29.m1.3.4.2.2.cmml"><mn id="A6.E29.m1.3.4.2.2.2" xref="A6.E29.m1.3.4.2.2.2.cmml">1</mn><mi id="A6.E29.m1.3.4.2.2.3" xref="A6.E29.m1.3.4.2.2.3.cmml">S</mi></mfrac></mstyle><mo lspace="0em" rspace="0em" id="A6.E29.m1.3.4.2.1" xref="A6.E29.m1.3.4.2.1.cmml">​</mo><mrow id="A6.E29.m1.3.4.2.3" xref="A6.E29.m1.3.4.2.3.cmml"><mstyle displaystyle="true" id="A6.E29.m1.3.4.2.3.1" xref="A6.E29.m1.3.4.2.3.1.cmml"><munder id="A6.E29.m1.3.4.2.3.1a" xref="A6.E29.m1.3.4.2.3.1.cmml"><mo movablelimits="false" id="A6.E29.m1.3.4.2.3.1.2" xref="A6.E29.m1.3.4.2.3.1.2.cmml">∑</mo><mi id="A6.E29.m1.3.4.2.3.1.3" xref="A6.E29.m1.3.4.2.3.1.3.cmml">s</mi></munder></mstyle><mstyle displaystyle="true" id="A6.E29.m1.3.4.2.3.2" xref="A6.E29.m1.3.4.2.3.2.cmml"><mrow id="A6.E29.m1.3.4.2.3.2a" xref="A6.E29.m1.3.4.2.3.2.cmml"><mo id="A6.E29.m1.3.4.2.3.2.1" xref="A6.E29.m1.3.4.2.3.2.1.cmml">∫</mo><mrow id="A6.E29.m1.3.4.2.3.2.2" xref="A6.E29.m1.3.4.2.3.2.2.cmml"><mfrac id="A6.E29.m1.2.2" xref="A6.E29.m1.2.2.cmml"><mrow id="A6.E29.m1.2.2.2" xref="A6.E29.m1.2.2.2.cmml"><mi id="A6.E29.m1.2.2.2.4" xref="A6.E29.m1.2.2.2.4.cmml">p</mi><mo lspace="0em" rspace="0em" id="A6.E29.m1.2.2.2.3" xref="A6.E29.m1.2.2.2.3.cmml">​</mo><mrow id="A6.E29.m1.1.1.1.1.1" xref="A6.E29.m1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="A6.E29.m1.1.1.1.1.1.2" xref="A6.E29.m1.1.1.1.1.1.1.cmml">(</mo><mrow id="A6.E29.m1.1.1.1.1.1.1" xref="A6.E29.m1.1.1.1.1.1.1.cmml"><msub id="A6.E29.m1.1.1.1.1.1.1.2" xref="A6.E29.m1.1.1.1.1.1.1.2.cmml"><mi class="ltx_font_mathcaligraphic" id="A6.E29.m1.1.1.1.1.1.1.2.2" xref="A6.E29.m1.1.1.1.1.1.1.2.2.cmml">𝒟</mi><mi id="A6.E29.m1.1.1.1.1.1.1.2.3" xref="A6.E29.m1.1.1.1.1.1.1.2.3.cmml">s</mi></msub><mo fence="false" id="A6.E29.m1.1.1.1.1.1.1.1" xref="A6.E29.m1.1.1.1.1.1.1.1.cmml">|</mo><msub id="A6.E29.m1.1.1.1.1.1.1.3" xref="A6.E29.m1.1.1.1.1.1.1.3.cmml"><mi class="ltx_mathvariant_bold-italic" mathvariant="bold-italic" id="A6.E29.m1.1.1.1.1.1.1.3.2" xref="A6.E29.m1.1.1.1.1.1.1.3.2.cmml">ϕ</mi><mi id="A6.E29.m1.1.1.1.1.1.1.3.3" xref="A6.E29.m1.1.1.1.1.1.1.3.3.cmml">s</mi></msub></mrow><mo stretchy="false" id="A6.E29.m1.1.1.1.1.1.3" xref="A6.E29.m1.1.1.1.1.1.1.cmml">)</mo></mrow><mo lspace="0em" rspace="0em" id="A6.E29.m1.2.2.2.3a" xref="A6.E29.m1.2.2.2.3.cmml">​</mo><mi id="A6.E29.m1.2.2.2.5" xref="A6.E29.m1.2.2.2.5.cmml">p</mi><mo lspace="0em" rspace="0em" id="A6.E29.m1.2.2.2.3b" xref="A6.E29.m1.2.2.2.3.cmml">​</mo><mrow id="A6.E29.m1.2.2.2.2.1" xref="A6.E29.m1.2.2.2.2.1.1.cmml"><mo stretchy="false" id="A6.E29.m1.2.2.2.2.1.2" xref="A6.E29.m1.2.2.2.2.1.1.cmml">(</mo><mrow id="A6.E29.m1.2.2.2.2.1.1" xref="A6.E29.m1.2.2.2.2.1.1.cmml"><msub id="A6.E29.m1.2.2.2.2.1.1.2" xref="A6.E29.m1.2.2.2.2.1.1.2.cmml"><mi class="ltx_mathvariant_bold-italic" mathvariant="bold-italic" id="A6.E29.m1.2.2.2.2.1.1.2.2" xref="A6.E29.m1.2.2.2.2.1.1.2.2.cmml">ϕ</mi><mi id="A6.E29.m1.2.2.2.2.1.1.2.3" xref="A6.E29.m1.2.2.2.2.1.1.2.3.cmml">s</mi></msub><mo fence="false" id="A6.E29.m1.2.2.2.2.1.1.1" xref="A6.E29.m1.2.2.2.2.1.1.1.cmml">|</mo><mi id="A6.E29.m1.2.2.2.2.1.1.3" xref="A6.E29.m1.2.2.2.2.1.1.3.cmml">𝐰</mi></mrow><mo stretchy="false" id="A6.E29.m1.2.2.2.2.1.3" xref="A6.E29.m1.2.2.2.2.1.1.cmml">)</mo></mrow></mrow><msub id="A6.E29.m1.2.2.4" xref="A6.E29.m1.2.2.4.cmml"><mi id="A6.E29.m1.2.2.4.2" xref="A6.E29.m1.2.2.4.2.cmml">Z</mi><mi id="A6.E29.m1.2.2.4.3" xref="A6.E29.m1.2.2.4.3.cmml">s</mi></msub></mfrac><mo lspace="0em" rspace="0em" id="A6.E29.m1.3.4.2.3.2.2.1" xref="A6.E29.m1.3.4.2.3.2.2.1.cmml">​</mo><mfrac id="A6.E29.m1.3.3" xref="A6.E29.m1.3.3.cmml"><mrow id="A6.E29.m1.3.3.1" xref="A6.E29.m1.3.3.1.cmml"><mo rspace="0.167em" id="A6.E29.m1.3.3.1.2" xref="A6.E29.m1.3.3.1.2.cmml">∂</mo><mrow id="A6.E29.m1.3.3.1.1" xref="A6.E29.m1.3.3.1.1.cmml"><mrow id="A6.E29.m1.3.3.1.1.3" xref="A6.E29.m1.3.3.1.1.3.cmml"><mi id="A6.E29.m1.3.3.1.1.3.1" xref="A6.E29.m1.3.3.1.1.3.1.cmml">log</mi><mo lspace="0.167em" id="A6.E29.m1.3.3.1.1.3a" xref="A6.E29.m1.3.3.1.1.3.cmml">⁡</mo><mi id="A6.E29.m1.3.3.1.1.3.2" xref="A6.E29.m1.3.3.1.1.3.2.cmml">p</mi></mrow><mo lspace="0em" rspace="0em" id="A6.E29.m1.3.3.1.1.2" xref="A6.E29.m1.3.3.1.1.2.cmml">​</mo><mrow id="A6.E29.m1.3.3.1.1.1.1" xref="A6.E29.m1.3.3.1.1.1.1.1.cmml"><mo stretchy="false" id="A6.E29.m1.3.3.1.1.1.1.2" xref="A6.E29.m1.3.3.1.1.1.1.1.cmml">(</mo><mrow id="A6.E29.m1.3.3.1.1.1.1.1" xref="A6.E29.m1.3.3.1.1.1.1.1.cmml"><msub id="A6.E29.m1.3.3.1.1.1.1.1.2" xref="A6.E29.m1.3.3.1.1.1.1.1.2.cmml"><mi class="ltx_mathvariant_bold-italic" mathvariant="bold-italic" id="A6.E29.m1.3.3.1.1.1.1.1.2.2" xref="A6.E29.m1.3.3.1.1.1.1.1.2.2.cmml">ϕ</mi><mi id="A6.E29.m1.3.3.1.1.1.1.1.2.3" xref="A6.E29.m1.3.3.1.1.1.1.1.2.3.cmml">s</mi></msub><mo fence="false" id="A6.E29.m1.3.3.1.1.1.1.1.1" xref="A6.E29.m1.3.3.1.1.1.1.1.1.cmml">|</mo><mi id="A6.E29.m1.3.3.1.1.1.1.1.3" xref="A6.E29.m1.3.3.1.1.1.1.1.3.cmml">𝐰</mi></mrow><mo stretchy="false" id="A6.E29.m1.3.3.1.1.1.1.3" xref="A6.E29.m1.3.3.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><mrow id="A6.E29.m1.3.3.3" xref="A6.E29.m1.3.3.3.cmml"><mo rspace="0em" id="A6.E29.m1.3.3.3.1" xref="A6.E29.m1.3.3.3.1.cmml">∂</mo><mi id="A6.E29.m1.3.3.3.2" xref="A6.E29.m1.3.3.3.2.cmml">𝐰</mi></mrow></mfrac><mo lspace="0em" rspace="0em" id="A6.E29.m1.3.4.2.3.2.2.1a" xref="A6.E29.m1.3.4.2.3.2.2.1.cmml">​</mo><mrow id="A6.E29.m1.3.4.2.3.2.2.2" xref="A6.E29.m1.3.4.2.3.2.2.2.cmml"><mo rspace="0em" id="A6.E29.m1.3.4.2.3.2.2.2.1" xref="A6.E29.m1.3.4.2.3.2.2.2.1.cmml">d</mo><msub id="A6.E29.m1.3.4.2.3.2.2.2.2" xref="A6.E29.m1.3.4.2.3.2.2.2.2.cmml"><mi class="ltx_mathvariant_bold-italic" mathvariant="bold-italic" id="A6.E29.m1.3.4.2.3.2.2.2.2.2" xref="A6.E29.m1.3.4.2.3.2.2.2.2.2.cmml">ϕ</mi><mi id="A6.E29.m1.3.4.2.3.2.2.2.2.3" xref="A6.E29.m1.3.4.2.3.2.2.2.2.3.cmml">s</mi></msub></mrow></mrow></mrow></mstyle></mrow></mrow><mo id="A6.E29.m1.3.4.1" xref="A6.E29.m1.3.4.1.cmml">=</mo><mi id="A6.E29.m1.3.4.3" xref="A6.E29.m1.3.4.3.cmml"></mi></mrow><annotation-xml encoding="MathML-Content" id="A6.E29.m1.3b"><apply id="A6.E29.m1.3.4.cmml" xref="A6.E29.m1.3.4"><eq id="A6.E29.m1.3.4.1.cmml" xref="A6.E29.m1.3.4.1"></eq><apply id="A6.E29.m1.3.4.2.cmml" xref="A6.E29.m1.3.4.2"><times id="A6.E29.m1.3.4.2.1.cmml" xref="A6.E29.m1.3.4.2.1"></times><apply id="A6.E29.m1.3.4.2.2.cmml" xref="A6.E29.m1.3.4.2.2"><divide id="A6.E29.m1.3.4.2.2.1.cmml" xref="A6.E29.m1.3.4.2.2"></divide><cn type="integer" id="A6.E29.m1.3.4.2.2.2.cmml" xref="A6.E29.m1.3.4.2.2.2">1</cn><ci id="A6.E29.m1.3.4.2.2.3.cmml" xref="A6.E29.m1.3.4.2.2.3">𝑆</ci></apply><apply id="A6.E29.m1.3.4.2.3.cmml" xref="A6.E29.m1.3.4.2.3"><apply id="A6.E29.m1.3.4.2.3.1.cmml" xref="A6.E29.m1.3.4.2.3.1"><csymbol cd="ambiguous" id="A6.E29.m1.3.4.2.3.1.1.cmml" xref="A6.E29.m1.3.4.2.3.1">subscript</csymbol><sum id="A6.E29.m1.3.4.2.3.1.2.cmml" xref="A6.E29.m1.3.4.2.3.1.2"></sum><ci id="A6.E29.m1.3.4.2.3.1.3.cmml" xref="A6.E29.m1.3.4.2.3.1.3">𝑠</ci></apply><apply id="A6.E29.m1.3.4.2.3.2.cmml" xref="A6.E29.m1.3.4.2.3.2"><int id="A6.E29.m1.3.4.2.3.2.1.cmml" xref="A6.E29.m1.3.4.2.3.2.1"></int><apply id="A6.E29.m1.3.4.2.3.2.2.cmml" xref="A6.E29.m1.3.4.2.3.2.2"><times id="A6.E29.m1.3.4.2.3.2.2.1.cmml" xref="A6.E29.m1.3.4.2.3.2.2.1"></times><apply id="A6.E29.m1.2.2.cmml" xref="A6.E29.m1.2.2"><divide id="A6.E29.m1.2.2.3.cmml" xref="A6.E29.m1.2.2"></divide><apply id="A6.E29.m1.2.2.2.cmml" xref="A6.E29.m1.2.2.2"><times id="A6.E29.m1.2.2.2.3.cmml" xref="A6.E29.m1.2.2.2.3"></times><ci id="A6.E29.m1.2.2.2.4.cmml" xref="A6.E29.m1.2.2.2.4">𝑝</ci><apply id="A6.E29.m1.1.1.1.1.1.1.cmml" xref="A6.E29.m1.1.1.1.1.1"><csymbol cd="latexml" id="A6.E29.m1.1.1.1.1.1.1.1.cmml" xref="A6.E29.m1.1.1.1.1.1.1.1">conditional</csymbol><apply id="A6.E29.m1.1.1.1.1.1.1.2.cmml" xref="A6.E29.m1.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="A6.E29.m1.1.1.1.1.1.1.2.1.cmml" xref="A6.E29.m1.1.1.1.1.1.1.2">subscript</csymbol><ci id="A6.E29.m1.1.1.1.1.1.1.2.2.cmml" xref="A6.E29.m1.1.1.1.1.1.1.2.2">𝒟</ci><ci id="A6.E29.m1.1.1.1.1.1.1.2.3.cmml" xref="A6.E29.m1.1.1.1.1.1.1.2.3">𝑠</ci></apply><apply id="A6.E29.m1.1.1.1.1.1.1.3.cmml" xref="A6.E29.m1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="A6.E29.m1.1.1.1.1.1.1.3.1.cmml" xref="A6.E29.m1.1.1.1.1.1.1.3">subscript</csymbol><ci id="A6.E29.m1.1.1.1.1.1.1.3.2.cmml" xref="A6.E29.m1.1.1.1.1.1.1.3.2">bold-italic-ϕ</ci><ci id="A6.E29.m1.1.1.1.1.1.1.3.3.cmml" xref="A6.E29.m1.1.1.1.1.1.1.3.3">𝑠</ci></apply></apply><ci id="A6.E29.m1.2.2.2.5.cmml" xref="A6.E29.m1.2.2.2.5">𝑝</ci><apply id="A6.E29.m1.2.2.2.2.1.1.cmml" xref="A6.E29.m1.2.2.2.2.1"><csymbol cd="latexml" id="A6.E29.m1.2.2.2.2.1.1.1.cmml" xref="A6.E29.m1.2.2.2.2.1.1.1">conditional</csymbol><apply id="A6.E29.m1.2.2.2.2.1.1.2.cmml" xref="A6.E29.m1.2.2.2.2.1.1.2"><csymbol cd="ambiguous" id="A6.E29.m1.2.2.2.2.1.1.2.1.cmml" xref="A6.E29.m1.2.2.2.2.1.1.2">subscript</csymbol><ci id="A6.E29.m1.2.2.2.2.1.1.2.2.cmml" xref="A6.E29.m1.2.2.2.2.1.1.2.2">bold-italic-ϕ</ci><ci id="A6.E29.m1.2.2.2.2.1.1.2.3.cmml" xref="A6.E29.m1.2.2.2.2.1.1.2.3">𝑠</ci></apply><ci id="A6.E29.m1.2.2.2.2.1.1.3.cmml" xref="A6.E29.m1.2.2.2.2.1.1.3">𝐰</ci></apply></apply><apply id="A6.E29.m1.2.2.4.cmml" xref="A6.E29.m1.2.2.4"><csymbol cd="ambiguous" id="A6.E29.m1.2.2.4.1.cmml" xref="A6.E29.m1.2.2.4">subscript</csymbol><ci id="A6.E29.m1.2.2.4.2.cmml" xref="A6.E29.m1.2.2.4.2">𝑍</ci><ci id="A6.E29.m1.2.2.4.3.cmml" xref="A6.E29.m1.2.2.4.3">𝑠</ci></apply></apply><apply id="A6.E29.m1.3.3.cmml" xref="A6.E29.m1.3.3"><divide id="A6.E29.m1.3.3.2.cmml" xref="A6.E29.m1.3.3"></divide><apply id="A6.E29.m1.3.3.1.cmml" xref="A6.E29.m1.3.3.1"><partialdiff id="A6.E29.m1.3.3.1.2.cmml" xref="A6.E29.m1.3.3.1.2"></partialdiff><apply id="A6.E29.m1.3.3.1.1.cmml" xref="A6.E29.m1.3.3.1.1"><times id="A6.E29.m1.3.3.1.1.2.cmml" xref="A6.E29.m1.3.3.1.1.2"></times><apply id="A6.E29.m1.3.3.1.1.3.cmml" xref="A6.E29.m1.3.3.1.1.3"><log id="A6.E29.m1.3.3.1.1.3.1.cmml" xref="A6.E29.m1.3.3.1.1.3.1"></log><ci id="A6.E29.m1.3.3.1.1.3.2.cmml" xref="A6.E29.m1.3.3.1.1.3.2">𝑝</ci></apply><apply id="A6.E29.m1.3.3.1.1.1.1.1.cmml" xref="A6.E29.m1.3.3.1.1.1.1"><csymbol cd="latexml" id="A6.E29.m1.3.3.1.1.1.1.1.1.cmml" xref="A6.E29.m1.3.3.1.1.1.1.1.1">conditional</csymbol><apply id="A6.E29.m1.3.3.1.1.1.1.1.2.cmml" xref="A6.E29.m1.3.3.1.1.1.1.1.2"><csymbol cd="ambiguous" id="A6.E29.m1.3.3.1.1.1.1.1.2.1.cmml" xref="A6.E29.m1.3.3.1.1.1.1.1.2">subscript</csymbol><ci id="A6.E29.m1.3.3.1.1.1.1.1.2.2.cmml" xref="A6.E29.m1.3.3.1.1.1.1.1.2.2">bold-italic-ϕ</ci><ci id="A6.E29.m1.3.3.1.1.1.1.1.2.3.cmml" xref="A6.E29.m1.3.3.1.1.1.1.1.2.3">𝑠</ci></apply><ci id="A6.E29.m1.3.3.1.1.1.1.1.3.cmml" xref="A6.E29.m1.3.3.1.1.1.1.1.3">𝐰</ci></apply></apply></apply><apply id="A6.E29.m1.3.3.3.cmml" xref="A6.E29.m1.3.3.3"><partialdiff id="A6.E29.m1.3.3.3.1.cmml" xref="A6.E29.m1.3.3.3.1"></partialdiff><ci id="A6.E29.m1.3.3.3.2.cmml" xref="A6.E29.m1.3.3.3.2">𝐰</ci></apply></apply><apply id="A6.E29.m1.3.4.2.3.2.2.2.cmml" xref="A6.E29.m1.3.4.2.3.2.2.2"><csymbol cd="latexml" id="A6.E29.m1.3.4.2.3.2.2.2.1.cmml" xref="A6.E29.m1.3.4.2.3.2.2.2.1">differential-d</csymbol><apply id="A6.E29.m1.3.4.2.3.2.2.2.2.cmml" xref="A6.E29.m1.3.4.2.3.2.2.2.2"><csymbol cd="ambiguous" id="A6.E29.m1.3.4.2.3.2.2.2.2.1.cmml" xref="A6.E29.m1.3.4.2.3.2.2.2.2">subscript</csymbol><ci id="A6.E29.m1.3.4.2.3.2.2.2.2.2.cmml" xref="A6.E29.m1.3.4.2.3.2.2.2.2.2">bold-italic-ϕ</ci><ci id="A6.E29.m1.3.4.2.3.2.2.2.2.3.cmml" xref="A6.E29.m1.3.4.2.3.2.2.2.2.3">𝑠</ci></apply></apply></apply></apply></apply></apply><csymbol cd="latexml" id="A6.E29.m1.3.4.3.cmml" xref="A6.E29.m1.3.4.3">absent</csymbol></apply></annotation-xml><annotation encoding="application/x-tex" id="A6.E29.m1.3c">\displaystyle\frac{1}{S}\sum_{s}\int\frac{p(\mathcal{D}_{s}|\bm{\phi}_{s})p(\bm{\phi}_{s}|\mathbf{w})}{Z_{s}}\frac{\partial\log p(\bm{\phi}_{s}|\mathbf{w})}{\partial\mathbf{w}}\mathrm{d}\bm{\phi}_{s}=</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(29)</span></td>
</tr></tbody>
<tbody id="A6.E30"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math id="A6.E30.m1.3" class="ltx_Math" alttext="\displaystyle\frac{1}{S}\sum_{s}\int p(\bm{\phi}_{s}|\mathcal{D}_{s},\mathbf{w})\frac{\partial\log p(\bm{\phi}_{s}|\mathbf{w})}{\partial\mathbf{w}}\mathrm{d}\bm{\phi}_{s}" display="inline"><semantics id="A6.E30.m1.3a"><mrow id="A6.E30.m1.3.3" xref="A6.E30.m1.3.3.cmml"><mstyle displaystyle="true" id="A6.E30.m1.3.3.3" xref="A6.E30.m1.3.3.3.cmml"><mfrac id="A6.E30.m1.3.3.3a" xref="A6.E30.m1.3.3.3.cmml"><mn id="A6.E30.m1.3.3.3.2" xref="A6.E30.m1.3.3.3.2.cmml">1</mn><mi id="A6.E30.m1.3.3.3.3" xref="A6.E30.m1.3.3.3.3.cmml">S</mi></mfrac></mstyle><mo lspace="0em" rspace="0em" id="A6.E30.m1.3.3.2" xref="A6.E30.m1.3.3.2.cmml">​</mo><mrow id="A6.E30.m1.3.3.1" xref="A6.E30.m1.3.3.1.cmml"><mstyle displaystyle="true" id="A6.E30.m1.3.3.1.2" xref="A6.E30.m1.3.3.1.2.cmml"><munder id="A6.E30.m1.3.3.1.2a" xref="A6.E30.m1.3.3.1.2.cmml"><mo movablelimits="false" id="A6.E30.m1.3.3.1.2.2" xref="A6.E30.m1.3.3.1.2.2.cmml">∑</mo><mi id="A6.E30.m1.3.3.1.2.3" xref="A6.E30.m1.3.3.1.2.3.cmml">s</mi></munder></mstyle><mstyle displaystyle="true" id="A6.E30.m1.3.3.1.1" xref="A6.E30.m1.3.3.1.1.cmml"><mrow id="A6.E30.m1.3.3.1.1a" xref="A6.E30.m1.3.3.1.1.cmml"><mo id="A6.E30.m1.3.3.1.1.2" xref="A6.E30.m1.3.3.1.1.2.cmml">∫</mo><mrow id="A6.E30.m1.3.3.1.1.1" xref="A6.E30.m1.3.3.1.1.1.cmml"><mi id="A6.E30.m1.3.3.1.1.1.3" xref="A6.E30.m1.3.3.1.1.1.3.cmml">p</mi><mo lspace="0em" rspace="0em" id="A6.E30.m1.3.3.1.1.1.2" xref="A6.E30.m1.3.3.1.1.1.2.cmml">​</mo><mrow id="A6.E30.m1.3.3.1.1.1.1.1" xref="A6.E30.m1.3.3.1.1.1.1.1.1.cmml"><mo stretchy="false" id="A6.E30.m1.3.3.1.1.1.1.1.2" xref="A6.E30.m1.3.3.1.1.1.1.1.1.cmml">(</mo><mrow id="A6.E30.m1.3.3.1.1.1.1.1.1" xref="A6.E30.m1.3.3.1.1.1.1.1.1.cmml"><msub id="A6.E30.m1.3.3.1.1.1.1.1.1.3" xref="A6.E30.m1.3.3.1.1.1.1.1.1.3.cmml"><mi class="ltx_mathvariant_bold-italic" mathvariant="bold-italic" id="A6.E30.m1.3.3.1.1.1.1.1.1.3.2" xref="A6.E30.m1.3.3.1.1.1.1.1.1.3.2.cmml">ϕ</mi><mi id="A6.E30.m1.3.3.1.1.1.1.1.1.3.3" xref="A6.E30.m1.3.3.1.1.1.1.1.1.3.3.cmml">s</mi></msub><mo fence="false" id="A6.E30.m1.3.3.1.1.1.1.1.1.2" xref="A6.E30.m1.3.3.1.1.1.1.1.1.2.cmml">|</mo><mrow id="A6.E30.m1.3.3.1.1.1.1.1.1.1.1" xref="A6.E30.m1.3.3.1.1.1.1.1.1.1.2.cmml"><msub id="A6.E30.m1.3.3.1.1.1.1.1.1.1.1.1" xref="A6.E30.m1.3.3.1.1.1.1.1.1.1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="A6.E30.m1.3.3.1.1.1.1.1.1.1.1.1.2" xref="A6.E30.m1.3.3.1.1.1.1.1.1.1.1.1.2.cmml">𝒟</mi><mi id="A6.E30.m1.3.3.1.1.1.1.1.1.1.1.1.3" xref="A6.E30.m1.3.3.1.1.1.1.1.1.1.1.1.3.cmml">s</mi></msub><mo id="A6.E30.m1.3.3.1.1.1.1.1.1.1.1.2" xref="A6.E30.m1.3.3.1.1.1.1.1.1.1.2.cmml">,</mo><mi id="A6.E30.m1.2.2" xref="A6.E30.m1.2.2.cmml">𝐰</mi></mrow></mrow><mo stretchy="false" id="A6.E30.m1.3.3.1.1.1.1.1.3" xref="A6.E30.m1.3.3.1.1.1.1.1.1.cmml">)</mo></mrow><mo lspace="0em" rspace="0em" id="A6.E30.m1.3.3.1.1.1.2a" xref="A6.E30.m1.3.3.1.1.1.2.cmml">​</mo><mfrac id="A6.E30.m1.1.1" xref="A6.E30.m1.1.1.cmml"><mrow id="A6.E30.m1.1.1.1" xref="A6.E30.m1.1.1.1.cmml"><mo rspace="0.167em" id="A6.E30.m1.1.1.1.2" xref="A6.E30.m1.1.1.1.2.cmml">∂</mo><mrow id="A6.E30.m1.1.1.1.1" xref="A6.E30.m1.1.1.1.1.cmml"><mrow id="A6.E30.m1.1.1.1.1.3" xref="A6.E30.m1.1.1.1.1.3.cmml"><mi id="A6.E30.m1.1.1.1.1.3.1" xref="A6.E30.m1.1.1.1.1.3.1.cmml">log</mi><mo lspace="0.167em" id="A6.E30.m1.1.1.1.1.3a" xref="A6.E30.m1.1.1.1.1.3.cmml">⁡</mo><mi id="A6.E30.m1.1.1.1.1.3.2" xref="A6.E30.m1.1.1.1.1.3.2.cmml">p</mi></mrow><mo lspace="0em" rspace="0em" id="A6.E30.m1.1.1.1.1.2" xref="A6.E30.m1.1.1.1.1.2.cmml">​</mo><mrow id="A6.E30.m1.1.1.1.1.1.1" xref="A6.E30.m1.1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="A6.E30.m1.1.1.1.1.1.1.2" xref="A6.E30.m1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="A6.E30.m1.1.1.1.1.1.1.1" xref="A6.E30.m1.1.1.1.1.1.1.1.cmml"><msub id="A6.E30.m1.1.1.1.1.1.1.1.2" xref="A6.E30.m1.1.1.1.1.1.1.1.2.cmml"><mi class="ltx_mathvariant_bold-italic" mathvariant="bold-italic" id="A6.E30.m1.1.1.1.1.1.1.1.2.2" xref="A6.E30.m1.1.1.1.1.1.1.1.2.2.cmml">ϕ</mi><mi id="A6.E30.m1.1.1.1.1.1.1.1.2.3" xref="A6.E30.m1.1.1.1.1.1.1.1.2.3.cmml">s</mi></msub><mo fence="false" id="A6.E30.m1.1.1.1.1.1.1.1.1" xref="A6.E30.m1.1.1.1.1.1.1.1.1.cmml">|</mo><mi id="A6.E30.m1.1.1.1.1.1.1.1.3" xref="A6.E30.m1.1.1.1.1.1.1.1.3.cmml">𝐰</mi></mrow><mo stretchy="false" id="A6.E30.m1.1.1.1.1.1.1.3" xref="A6.E30.m1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><mrow id="A6.E30.m1.1.1.3" xref="A6.E30.m1.1.1.3.cmml"><mo rspace="0em" id="A6.E30.m1.1.1.3.1" xref="A6.E30.m1.1.1.3.1.cmml">∂</mo><mi id="A6.E30.m1.1.1.3.2" xref="A6.E30.m1.1.1.3.2.cmml">𝐰</mi></mrow></mfrac><mo lspace="0em" rspace="0em" id="A6.E30.m1.3.3.1.1.1.2b" xref="A6.E30.m1.3.3.1.1.1.2.cmml">​</mo><mrow id="A6.E30.m1.3.3.1.1.1.4" xref="A6.E30.m1.3.3.1.1.1.4.cmml"><mo rspace="0em" id="A6.E30.m1.3.3.1.1.1.4.1" xref="A6.E30.m1.3.3.1.1.1.4.1.cmml">d</mo><msub id="A6.E30.m1.3.3.1.1.1.4.2" xref="A6.E30.m1.3.3.1.1.1.4.2.cmml"><mi class="ltx_mathvariant_bold-italic" mathvariant="bold-italic" id="A6.E30.m1.3.3.1.1.1.4.2.2" xref="A6.E30.m1.3.3.1.1.1.4.2.2.cmml">ϕ</mi><mi id="A6.E30.m1.3.3.1.1.1.4.2.3" xref="A6.E30.m1.3.3.1.1.1.4.2.3.cmml">s</mi></msub></mrow></mrow></mrow></mstyle></mrow></mrow><annotation-xml encoding="MathML-Content" id="A6.E30.m1.3b"><apply id="A6.E30.m1.3.3.cmml" xref="A6.E30.m1.3.3"><times id="A6.E30.m1.3.3.2.cmml" xref="A6.E30.m1.3.3.2"></times><apply id="A6.E30.m1.3.3.3.cmml" xref="A6.E30.m1.3.3.3"><divide id="A6.E30.m1.3.3.3.1.cmml" xref="A6.E30.m1.3.3.3"></divide><cn type="integer" id="A6.E30.m1.3.3.3.2.cmml" xref="A6.E30.m1.3.3.3.2">1</cn><ci id="A6.E30.m1.3.3.3.3.cmml" xref="A6.E30.m1.3.3.3.3">𝑆</ci></apply><apply id="A6.E30.m1.3.3.1.cmml" xref="A6.E30.m1.3.3.1"><apply id="A6.E30.m1.3.3.1.2.cmml" xref="A6.E30.m1.3.3.1.2"><csymbol cd="ambiguous" id="A6.E30.m1.3.3.1.2.1.cmml" xref="A6.E30.m1.3.3.1.2">subscript</csymbol><sum id="A6.E30.m1.3.3.1.2.2.cmml" xref="A6.E30.m1.3.3.1.2.2"></sum><ci id="A6.E30.m1.3.3.1.2.3.cmml" xref="A6.E30.m1.3.3.1.2.3">𝑠</ci></apply><apply id="A6.E30.m1.3.3.1.1.cmml" xref="A6.E30.m1.3.3.1.1"><int id="A6.E30.m1.3.3.1.1.2.cmml" xref="A6.E30.m1.3.3.1.1.2"></int><apply id="A6.E30.m1.3.3.1.1.1.cmml" xref="A6.E30.m1.3.3.1.1.1"><times id="A6.E30.m1.3.3.1.1.1.2.cmml" xref="A6.E30.m1.3.3.1.1.1.2"></times><ci id="A6.E30.m1.3.3.1.1.1.3.cmml" xref="A6.E30.m1.3.3.1.1.1.3">𝑝</ci><apply id="A6.E30.m1.3.3.1.1.1.1.1.1.cmml" xref="A6.E30.m1.3.3.1.1.1.1.1"><csymbol cd="latexml" id="A6.E30.m1.3.3.1.1.1.1.1.1.2.cmml" xref="A6.E30.m1.3.3.1.1.1.1.1.1.2">conditional</csymbol><apply id="A6.E30.m1.3.3.1.1.1.1.1.1.3.cmml" xref="A6.E30.m1.3.3.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="A6.E30.m1.3.3.1.1.1.1.1.1.3.1.cmml" xref="A6.E30.m1.3.3.1.1.1.1.1.1.3">subscript</csymbol><ci id="A6.E30.m1.3.3.1.1.1.1.1.1.3.2.cmml" xref="A6.E30.m1.3.3.1.1.1.1.1.1.3.2">bold-italic-ϕ</ci><ci id="A6.E30.m1.3.3.1.1.1.1.1.1.3.3.cmml" xref="A6.E30.m1.3.3.1.1.1.1.1.1.3.3">𝑠</ci></apply><list id="A6.E30.m1.3.3.1.1.1.1.1.1.1.2.cmml" xref="A6.E30.m1.3.3.1.1.1.1.1.1.1.1"><apply id="A6.E30.m1.3.3.1.1.1.1.1.1.1.1.1.cmml" xref="A6.E30.m1.3.3.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="A6.E30.m1.3.3.1.1.1.1.1.1.1.1.1.1.cmml" xref="A6.E30.m1.3.3.1.1.1.1.1.1.1.1.1">subscript</csymbol><ci id="A6.E30.m1.3.3.1.1.1.1.1.1.1.1.1.2.cmml" xref="A6.E30.m1.3.3.1.1.1.1.1.1.1.1.1.2">𝒟</ci><ci id="A6.E30.m1.3.3.1.1.1.1.1.1.1.1.1.3.cmml" xref="A6.E30.m1.3.3.1.1.1.1.1.1.1.1.1.3">𝑠</ci></apply><ci id="A6.E30.m1.2.2.cmml" xref="A6.E30.m1.2.2">𝐰</ci></list></apply><apply id="A6.E30.m1.1.1.cmml" xref="A6.E30.m1.1.1"><divide id="A6.E30.m1.1.1.2.cmml" xref="A6.E30.m1.1.1"></divide><apply id="A6.E30.m1.1.1.1.cmml" xref="A6.E30.m1.1.1.1"><partialdiff id="A6.E30.m1.1.1.1.2.cmml" xref="A6.E30.m1.1.1.1.2"></partialdiff><apply id="A6.E30.m1.1.1.1.1.cmml" xref="A6.E30.m1.1.1.1.1"><times id="A6.E30.m1.1.1.1.1.2.cmml" xref="A6.E30.m1.1.1.1.1.2"></times><apply id="A6.E30.m1.1.1.1.1.3.cmml" xref="A6.E30.m1.1.1.1.1.3"><log id="A6.E30.m1.1.1.1.1.3.1.cmml" xref="A6.E30.m1.1.1.1.1.3.1"></log><ci id="A6.E30.m1.1.1.1.1.3.2.cmml" xref="A6.E30.m1.1.1.1.1.3.2">𝑝</ci></apply><apply id="A6.E30.m1.1.1.1.1.1.1.1.cmml" xref="A6.E30.m1.1.1.1.1.1.1"><csymbol cd="latexml" id="A6.E30.m1.1.1.1.1.1.1.1.1.cmml" xref="A6.E30.m1.1.1.1.1.1.1.1.1">conditional</csymbol><apply id="A6.E30.m1.1.1.1.1.1.1.1.2.cmml" xref="A6.E30.m1.1.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="A6.E30.m1.1.1.1.1.1.1.1.2.1.cmml" xref="A6.E30.m1.1.1.1.1.1.1.1.2">subscript</csymbol><ci id="A6.E30.m1.1.1.1.1.1.1.1.2.2.cmml" xref="A6.E30.m1.1.1.1.1.1.1.1.2.2">bold-italic-ϕ</ci><ci id="A6.E30.m1.1.1.1.1.1.1.1.2.3.cmml" xref="A6.E30.m1.1.1.1.1.1.1.1.2.3">𝑠</ci></apply><ci id="A6.E30.m1.1.1.1.1.1.1.1.3.cmml" xref="A6.E30.m1.1.1.1.1.1.1.1.3">𝐰</ci></apply></apply></apply><apply id="A6.E30.m1.1.1.3.cmml" xref="A6.E30.m1.1.1.3"><partialdiff id="A6.E30.m1.1.1.3.1.cmml" xref="A6.E30.m1.1.1.3.1"></partialdiff><ci id="A6.E30.m1.1.1.3.2.cmml" xref="A6.E30.m1.1.1.3.2">𝐰</ci></apply></apply><apply id="A6.E30.m1.3.3.1.1.1.4.cmml" xref="A6.E30.m1.3.3.1.1.1.4"><csymbol cd="latexml" id="A6.E30.m1.3.3.1.1.1.4.1.cmml" xref="A6.E30.m1.3.3.1.1.1.4.1">differential-d</csymbol><apply id="A6.E30.m1.3.3.1.1.1.4.2.cmml" xref="A6.E30.m1.3.3.1.1.1.4.2"><csymbol cd="ambiguous" id="A6.E30.m1.3.3.1.1.1.4.2.1.cmml" xref="A6.E30.m1.3.3.1.1.1.4.2">subscript</csymbol><ci id="A6.E30.m1.3.3.1.1.1.4.2.2.cmml" xref="A6.E30.m1.3.3.1.1.1.4.2.2">bold-italic-ϕ</ci><ci id="A6.E30.m1.3.3.1.1.1.4.2.3.cmml" xref="A6.E30.m1.3.3.1.1.1.4.2.3">𝑠</ci></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A6.E30.m1.3c">\displaystyle\frac{1}{S}\sum_{s}\int p(\bm{\phi}_{s}|\mathcal{D}_{s},\mathbf{w})\frac{\partial\log p(\bm{\phi}_{s}|\mathbf{w})}{\partial\mathbf{w}}\mathrm{d}\bm{\phi}_{s}</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(30)</span></td>
</tr></tbody>
</table>
<p id="A6.p1.6" class="ltx_p">where to compute Eq. <a href="#A6.E30" title="In Appendix F Correspondence between single step EM and gradient ascent ‣ An Expectation-Maximization Perspective on Federated Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">30</span></a> we see that we first have to obtain the posterior distribution of the local variables <math id="A6.p1.5.m1.1" class="ltx_Math" alttext="\bm{\phi}_{s}" display="inline"><semantics id="A6.p1.5.m1.1a"><msub id="A6.p1.5.m1.1.1" xref="A6.p1.5.m1.1.1.cmml"><mi class="ltx_mathvariant_bold-italic" mathvariant="bold-italic" id="A6.p1.5.m1.1.1.2" xref="A6.p1.5.m1.1.1.2.cmml">ϕ</mi><mi id="A6.p1.5.m1.1.1.3" xref="A6.p1.5.m1.1.1.3.cmml">s</mi></msub><annotation-xml encoding="MathML-Content" id="A6.p1.5.m1.1b"><apply id="A6.p1.5.m1.1.1.cmml" xref="A6.p1.5.m1.1.1"><csymbol cd="ambiguous" id="A6.p1.5.m1.1.1.1.cmml" xref="A6.p1.5.m1.1.1">subscript</csymbol><ci id="A6.p1.5.m1.1.1.2.cmml" xref="A6.p1.5.m1.1.1.2">bold-italic-ϕ</ci><ci id="A6.p1.5.m1.1.1.3.cmml" xref="A6.p1.5.m1.1.1.3">𝑠</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A6.p1.5.m1.1c">\bm{\phi}_{s}</annotation></semantics></math> and then estimate the gradient for <math id="A6.p1.6.m2.1" class="ltx_Math" alttext="\mathbf{w}" display="inline"><semantics id="A6.p1.6.m2.1a"><mi id="A6.p1.6.m2.1.1" xref="A6.p1.6.m2.1.1.cmml">𝐰</mi><annotation-xml encoding="MathML-Content" id="A6.p1.6.m2.1b"><ci id="A6.p1.6.m2.1.1.cmml" xref="A6.p1.6.m2.1.1">𝐰</ci></annotation-xml><annotation encoding="application/x-tex" id="A6.p1.6.m2.1c">\mathbf{w}</annotation></semantics></math> by marginalizing over this posterior.</p>
</div>
</section>
<section id="A7" class="ltx_appendix">
<h2 class="ltx_title ltx_title_appendix">
<span class="ltx_tag ltx_tag_appendix">Appendix G </span>Derivation of the local loss for <span id="A7.1.1" class="ltx_text ltx_font_typewriter">FedSparse</span>
</h2>

<div id="A7.p1" class="ltx_para">
<p id="A7.p1.3" class="ltx_p">Let <math id="A7.p1.1.m1.3" class="ltx_Math" alttext="p(\bm{\phi}_{si}|\mathbf{w}_{i},\mathbf{z}_{si}=1)=\mathcal{N}(\mathbf{w}_{i},1/\lambda),p(\bm{\phi}_{si}|\mathbf{w}_{i},\mathbf{z}_{si}=0)=\mathcal{N}(0,1/\lambda_{2})" display="inline"><semantics id="A7.p1.1.m1.3a"><mrow id="A7.p1.1.m1.3.3.2" xref="A7.p1.1.m1.3.3.3.cmml"><mrow id="A7.p1.1.m1.2.2.1.1" xref="A7.p1.1.m1.2.2.1.1.cmml"><mrow id="A7.p1.1.m1.2.2.1.1.1" xref="A7.p1.1.m1.2.2.1.1.1.cmml"><mi id="A7.p1.1.m1.2.2.1.1.1.3" xref="A7.p1.1.m1.2.2.1.1.1.3.cmml">p</mi><mo lspace="0em" rspace="0em" id="A7.p1.1.m1.2.2.1.1.1.2" xref="A7.p1.1.m1.2.2.1.1.1.2.cmml">​</mo><mrow id="A7.p1.1.m1.2.2.1.1.1.1.1" xref="A7.p1.1.m1.2.2.1.1.1.1.1.1.cmml"><mo stretchy="false" id="A7.p1.1.m1.2.2.1.1.1.1.1.2" xref="A7.p1.1.m1.2.2.1.1.1.1.1.1.cmml">(</mo><mrow id="A7.p1.1.m1.2.2.1.1.1.1.1.1" xref="A7.p1.1.m1.2.2.1.1.1.1.1.1.cmml"><mrow id="A7.p1.1.m1.2.2.1.1.1.1.1.1.2" xref="A7.p1.1.m1.2.2.1.1.1.1.1.1.2.cmml"><msub id="A7.p1.1.m1.2.2.1.1.1.1.1.1.2.4" xref="A7.p1.1.m1.2.2.1.1.1.1.1.1.2.4.cmml"><mi class="ltx_mathvariant_bold-italic" mathvariant="bold-italic" id="A7.p1.1.m1.2.2.1.1.1.1.1.1.2.4.2" xref="A7.p1.1.m1.2.2.1.1.1.1.1.1.2.4.2.cmml">ϕ</mi><mrow id="A7.p1.1.m1.2.2.1.1.1.1.1.1.2.4.3" xref="A7.p1.1.m1.2.2.1.1.1.1.1.1.2.4.3.cmml"><mi id="A7.p1.1.m1.2.2.1.1.1.1.1.1.2.4.3.2" xref="A7.p1.1.m1.2.2.1.1.1.1.1.1.2.4.3.2.cmml">s</mi><mo lspace="0em" rspace="0em" id="A7.p1.1.m1.2.2.1.1.1.1.1.1.2.4.3.1" xref="A7.p1.1.m1.2.2.1.1.1.1.1.1.2.4.3.1.cmml">​</mo><mi id="A7.p1.1.m1.2.2.1.1.1.1.1.1.2.4.3.3" xref="A7.p1.1.m1.2.2.1.1.1.1.1.1.2.4.3.3.cmml">i</mi></mrow></msub><mo fence="false" id="A7.p1.1.m1.2.2.1.1.1.1.1.1.2.3" xref="A7.p1.1.m1.2.2.1.1.1.1.1.1.2.3.cmml">|</mo><mrow id="A7.p1.1.m1.2.2.1.1.1.1.1.1.2.2.2" xref="A7.p1.1.m1.2.2.1.1.1.1.1.1.2.2.3.cmml"><msub id="A7.p1.1.m1.2.2.1.1.1.1.1.1.1.1.1.1" xref="A7.p1.1.m1.2.2.1.1.1.1.1.1.1.1.1.1.cmml"><mi id="A7.p1.1.m1.2.2.1.1.1.1.1.1.1.1.1.1.2" xref="A7.p1.1.m1.2.2.1.1.1.1.1.1.1.1.1.1.2.cmml">𝐰</mi><mi id="A7.p1.1.m1.2.2.1.1.1.1.1.1.1.1.1.1.3" xref="A7.p1.1.m1.2.2.1.1.1.1.1.1.1.1.1.1.3.cmml">i</mi></msub><mo id="A7.p1.1.m1.2.2.1.1.1.1.1.1.2.2.2.3" xref="A7.p1.1.m1.2.2.1.1.1.1.1.1.2.2.3.cmml">,</mo><msub id="A7.p1.1.m1.2.2.1.1.1.1.1.1.2.2.2.2" xref="A7.p1.1.m1.2.2.1.1.1.1.1.1.2.2.2.2.cmml"><mi id="A7.p1.1.m1.2.2.1.1.1.1.1.1.2.2.2.2.2" xref="A7.p1.1.m1.2.2.1.1.1.1.1.1.2.2.2.2.2.cmml">𝐳</mi><mrow id="A7.p1.1.m1.2.2.1.1.1.1.1.1.2.2.2.2.3" xref="A7.p1.1.m1.2.2.1.1.1.1.1.1.2.2.2.2.3.cmml"><mi id="A7.p1.1.m1.2.2.1.1.1.1.1.1.2.2.2.2.3.2" xref="A7.p1.1.m1.2.2.1.1.1.1.1.1.2.2.2.2.3.2.cmml">s</mi><mo lspace="0em" rspace="0em" id="A7.p1.1.m1.2.2.1.1.1.1.1.1.2.2.2.2.3.1" xref="A7.p1.1.m1.2.2.1.1.1.1.1.1.2.2.2.2.3.1.cmml">​</mo><mi id="A7.p1.1.m1.2.2.1.1.1.1.1.1.2.2.2.2.3.3" xref="A7.p1.1.m1.2.2.1.1.1.1.1.1.2.2.2.2.3.3.cmml">i</mi></mrow></msub></mrow></mrow><mo id="A7.p1.1.m1.2.2.1.1.1.1.1.1.3" xref="A7.p1.1.m1.2.2.1.1.1.1.1.1.3.cmml">=</mo><mn id="A7.p1.1.m1.2.2.1.1.1.1.1.1.4" xref="A7.p1.1.m1.2.2.1.1.1.1.1.1.4.cmml">1</mn></mrow><mo stretchy="false" id="A7.p1.1.m1.2.2.1.1.1.1.1.3" xref="A7.p1.1.m1.2.2.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="A7.p1.1.m1.2.2.1.1.4" xref="A7.p1.1.m1.2.2.1.1.4.cmml">=</mo><mrow id="A7.p1.1.m1.2.2.1.1.3" xref="A7.p1.1.m1.2.2.1.1.3.cmml"><mi class="ltx_font_mathcaligraphic" id="A7.p1.1.m1.2.2.1.1.3.4" xref="A7.p1.1.m1.2.2.1.1.3.4.cmml">𝒩</mi><mo lspace="0em" rspace="0em" id="A7.p1.1.m1.2.2.1.1.3.3" xref="A7.p1.1.m1.2.2.1.1.3.3.cmml">​</mo><mrow id="A7.p1.1.m1.2.2.1.1.3.2.2" xref="A7.p1.1.m1.2.2.1.1.3.2.3.cmml"><mo stretchy="false" id="A7.p1.1.m1.2.2.1.1.3.2.2.3" xref="A7.p1.1.m1.2.2.1.1.3.2.3.cmml">(</mo><msub id="A7.p1.1.m1.2.2.1.1.2.1.1.1" xref="A7.p1.1.m1.2.2.1.1.2.1.1.1.cmml"><mi id="A7.p1.1.m1.2.2.1.1.2.1.1.1.2" xref="A7.p1.1.m1.2.2.1.1.2.1.1.1.2.cmml">𝐰</mi><mi id="A7.p1.1.m1.2.2.1.1.2.1.1.1.3" xref="A7.p1.1.m1.2.2.1.1.2.1.1.1.3.cmml">i</mi></msub><mo id="A7.p1.1.m1.2.2.1.1.3.2.2.4" xref="A7.p1.1.m1.2.2.1.1.3.2.3.cmml">,</mo><mrow id="A7.p1.1.m1.2.2.1.1.3.2.2.2" xref="A7.p1.1.m1.2.2.1.1.3.2.2.2.cmml"><mn id="A7.p1.1.m1.2.2.1.1.3.2.2.2.2" xref="A7.p1.1.m1.2.2.1.1.3.2.2.2.2.cmml">1</mn><mo id="A7.p1.1.m1.2.2.1.1.3.2.2.2.1" xref="A7.p1.1.m1.2.2.1.1.3.2.2.2.1.cmml">/</mo><mi id="A7.p1.1.m1.2.2.1.1.3.2.2.2.3" xref="A7.p1.1.m1.2.2.1.1.3.2.2.2.3.cmml">λ</mi></mrow><mo stretchy="false" id="A7.p1.1.m1.2.2.1.1.3.2.2.5" xref="A7.p1.1.m1.2.2.1.1.3.2.3.cmml">)</mo></mrow></mrow></mrow><mo id="A7.p1.1.m1.3.3.2.3" xref="A7.p1.1.m1.3.3.3a.cmml">,</mo><mrow id="A7.p1.1.m1.3.3.2.2" xref="A7.p1.1.m1.3.3.2.2.cmml"><mrow id="A7.p1.1.m1.3.3.2.2.1" xref="A7.p1.1.m1.3.3.2.2.1.cmml"><mi id="A7.p1.1.m1.3.3.2.2.1.3" xref="A7.p1.1.m1.3.3.2.2.1.3.cmml">p</mi><mo lspace="0em" rspace="0em" id="A7.p1.1.m1.3.3.2.2.1.2" xref="A7.p1.1.m1.3.3.2.2.1.2.cmml">​</mo><mrow id="A7.p1.1.m1.3.3.2.2.1.1.1" xref="A7.p1.1.m1.3.3.2.2.1.1.1.1.cmml"><mo stretchy="false" id="A7.p1.1.m1.3.3.2.2.1.1.1.2" xref="A7.p1.1.m1.3.3.2.2.1.1.1.1.cmml">(</mo><mrow id="A7.p1.1.m1.3.3.2.2.1.1.1.1" xref="A7.p1.1.m1.3.3.2.2.1.1.1.1.cmml"><mrow id="A7.p1.1.m1.3.3.2.2.1.1.1.1.2" xref="A7.p1.1.m1.3.3.2.2.1.1.1.1.2.cmml"><msub id="A7.p1.1.m1.3.3.2.2.1.1.1.1.2.4" xref="A7.p1.1.m1.3.3.2.2.1.1.1.1.2.4.cmml"><mi class="ltx_mathvariant_bold-italic" mathvariant="bold-italic" id="A7.p1.1.m1.3.3.2.2.1.1.1.1.2.4.2" xref="A7.p1.1.m1.3.3.2.2.1.1.1.1.2.4.2.cmml">ϕ</mi><mrow id="A7.p1.1.m1.3.3.2.2.1.1.1.1.2.4.3" xref="A7.p1.1.m1.3.3.2.2.1.1.1.1.2.4.3.cmml"><mi id="A7.p1.1.m1.3.3.2.2.1.1.1.1.2.4.3.2" xref="A7.p1.1.m1.3.3.2.2.1.1.1.1.2.4.3.2.cmml">s</mi><mo lspace="0em" rspace="0em" id="A7.p1.1.m1.3.3.2.2.1.1.1.1.2.4.3.1" xref="A7.p1.1.m1.3.3.2.2.1.1.1.1.2.4.3.1.cmml">​</mo><mi id="A7.p1.1.m1.3.3.2.2.1.1.1.1.2.4.3.3" xref="A7.p1.1.m1.3.3.2.2.1.1.1.1.2.4.3.3.cmml">i</mi></mrow></msub><mo fence="false" id="A7.p1.1.m1.3.3.2.2.1.1.1.1.2.3" xref="A7.p1.1.m1.3.3.2.2.1.1.1.1.2.3.cmml">|</mo><mrow id="A7.p1.1.m1.3.3.2.2.1.1.1.1.2.2.2" xref="A7.p1.1.m1.3.3.2.2.1.1.1.1.2.2.3.cmml"><msub id="A7.p1.1.m1.3.3.2.2.1.1.1.1.1.1.1.1" xref="A7.p1.1.m1.3.3.2.2.1.1.1.1.1.1.1.1.cmml"><mi id="A7.p1.1.m1.3.3.2.2.1.1.1.1.1.1.1.1.2" xref="A7.p1.1.m1.3.3.2.2.1.1.1.1.1.1.1.1.2.cmml">𝐰</mi><mi id="A7.p1.1.m1.3.3.2.2.1.1.1.1.1.1.1.1.3" xref="A7.p1.1.m1.3.3.2.2.1.1.1.1.1.1.1.1.3.cmml">i</mi></msub><mo id="A7.p1.1.m1.3.3.2.2.1.1.1.1.2.2.2.3" xref="A7.p1.1.m1.3.3.2.2.1.1.1.1.2.2.3.cmml">,</mo><msub id="A7.p1.1.m1.3.3.2.2.1.1.1.1.2.2.2.2" xref="A7.p1.1.m1.3.3.2.2.1.1.1.1.2.2.2.2.cmml"><mi id="A7.p1.1.m1.3.3.2.2.1.1.1.1.2.2.2.2.2" xref="A7.p1.1.m1.3.3.2.2.1.1.1.1.2.2.2.2.2.cmml">𝐳</mi><mrow id="A7.p1.1.m1.3.3.2.2.1.1.1.1.2.2.2.2.3" xref="A7.p1.1.m1.3.3.2.2.1.1.1.1.2.2.2.2.3.cmml"><mi id="A7.p1.1.m1.3.3.2.2.1.1.1.1.2.2.2.2.3.2" xref="A7.p1.1.m1.3.3.2.2.1.1.1.1.2.2.2.2.3.2.cmml">s</mi><mo lspace="0em" rspace="0em" id="A7.p1.1.m1.3.3.2.2.1.1.1.1.2.2.2.2.3.1" xref="A7.p1.1.m1.3.3.2.2.1.1.1.1.2.2.2.2.3.1.cmml">​</mo><mi id="A7.p1.1.m1.3.3.2.2.1.1.1.1.2.2.2.2.3.3" xref="A7.p1.1.m1.3.3.2.2.1.1.1.1.2.2.2.2.3.3.cmml">i</mi></mrow></msub></mrow></mrow><mo id="A7.p1.1.m1.3.3.2.2.1.1.1.1.3" xref="A7.p1.1.m1.3.3.2.2.1.1.1.1.3.cmml">=</mo><mn id="A7.p1.1.m1.3.3.2.2.1.1.1.1.4" xref="A7.p1.1.m1.3.3.2.2.1.1.1.1.4.cmml">0</mn></mrow><mo stretchy="false" id="A7.p1.1.m1.3.3.2.2.1.1.1.3" xref="A7.p1.1.m1.3.3.2.2.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="A7.p1.1.m1.3.3.2.2.3" xref="A7.p1.1.m1.3.3.2.2.3.cmml">=</mo><mrow id="A7.p1.1.m1.3.3.2.2.2" xref="A7.p1.1.m1.3.3.2.2.2.cmml"><mi class="ltx_font_mathcaligraphic" id="A7.p1.1.m1.3.3.2.2.2.3" xref="A7.p1.1.m1.3.3.2.2.2.3.cmml">𝒩</mi><mo lspace="0em" rspace="0em" id="A7.p1.1.m1.3.3.2.2.2.2" xref="A7.p1.1.m1.3.3.2.2.2.2.cmml">​</mo><mrow id="A7.p1.1.m1.3.3.2.2.2.1.1" xref="A7.p1.1.m1.3.3.2.2.2.1.2.cmml"><mo stretchy="false" id="A7.p1.1.m1.3.3.2.2.2.1.1.2" xref="A7.p1.1.m1.3.3.2.2.2.1.2.cmml">(</mo><mn id="A7.p1.1.m1.1.1" xref="A7.p1.1.m1.1.1.cmml">0</mn><mo id="A7.p1.1.m1.3.3.2.2.2.1.1.3" xref="A7.p1.1.m1.3.3.2.2.2.1.2.cmml">,</mo><mrow id="A7.p1.1.m1.3.3.2.2.2.1.1.1" xref="A7.p1.1.m1.3.3.2.2.2.1.1.1.cmml"><mn id="A7.p1.1.m1.3.3.2.2.2.1.1.1.2" xref="A7.p1.1.m1.3.3.2.2.2.1.1.1.2.cmml">1</mn><mo id="A7.p1.1.m1.3.3.2.2.2.1.1.1.1" xref="A7.p1.1.m1.3.3.2.2.2.1.1.1.1.cmml">/</mo><msub id="A7.p1.1.m1.3.3.2.2.2.1.1.1.3" xref="A7.p1.1.m1.3.3.2.2.2.1.1.1.3.cmml"><mi id="A7.p1.1.m1.3.3.2.2.2.1.1.1.3.2" xref="A7.p1.1.m1.3.3.2.2.2.1.1.1.3.2.cmml">λ</mi><mn id="A7.p1.1.m1.3.3.2.2.2.1.1.1.3.3" xref="A7.p1.1.m1.3.3.2.2.2.1.1.1.3.3.cmml">2</mn></msub></mrow><mo stretchy="false" id="A7.p1.1.m1.3.3.2.2.2.1.1.4" xref="A7.p1.1.m1.3.3.2.2.2.1.2.cmml">)</mo></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="A7.p1.1.m1.3b"><apply id="A7.p1.1.m1.3.3.3.cmml" xref="A7.p1.1.m1.3.3.2"><csymbol cd="ambiguous" id="A7.p1.1.m1.3.3.3a.cmml" xref="A7.p1.1.m1.3.3.2.3">formulae-sequence</csymbol><apply id="A7.p1.1.m1.2.2.1.1.cmml" xref="A7.p1.1.m1.2.2.1.1"><eq id="A7.p1.1.m1.2.2.1.1.4.cmml" xref="A7.p1.1.m1.2.2.1.1.4"></eq><apply id="A7.p1.1.m1.2.2.1.1.1.cmml" xref="A7.p1.1.m1.2.2.1.1.1"><times id="A7.p1.1.m1.2.2.1.1.1.2.cmml" xref="A7.p1.1.m1.2.2.1.1.1.2"></times><ci id="A7.p1.1.m1.2.2.1.1.1.3.cmml" xref="A7.p1.1.m1.2.2.1.1.1.3">𝑝</ci><apply id="A7.p1.1.m1.2.2.1.1.1.1.1.1.cmml" xref="A7.p1.1.m1.2.2.1.1.1.1.1"><eq id="A7.p1.1.m1.2.2.1.1.1.1.1.1.3.cmml" xref="A7.p1.1.m1.2.2.1.1.1.1.1.1.3"></eq><apply id="A7.p1.1.m1.2.2.1.1.1.1.1.1.2.cmml" xref="A7.p1.1.m1.2.2.1.1.1.1.1.1.2"><csymbol cd="latexml" id="A7.p1.1.m1.2.2.1.1.1.1.1.1.2.3.cmml" xref="A7.p1.1.m1.2.2.1.1.1.1.1.1.2.3">conditional</csymbol><apply id="A7.p1.1.m1.2.2.1.1.1.1.1.1.2.4.cmml" xref="A7.p1.1.m1.2.2.1.1.1.1.1.1.2.4"><csymbol cd="ambiguous" id="A7.p1.1.m1.2.2.1.1.1.1.1.1.2.4.1.cmml" xref="A7.p1.1.m1.2.2.1.1.1.1.1.1.2.4">subscript</csymbol><ci id="A7.p1.1.m1.2.2.1.1.1.1.1.1.2.4.2.cmml" xref="A7.p1.1.m1.2.2.1.1.1.1.1.1.2.4.2">bold-italic-ϕ</ci><apply id="A7.p1.1.m1.2.2.1.1.1.1.1.1.2.4.3.cmml" xref="A7.p1.1.m1.2.2.1.1.1.1.1.1.2.4.3"><times id="A7.p1.1.m1.2.2.1.1.1.1.1.1.2.4.3.1.cmml" xref="A7.p1.1.m1.2.2.1.1.1.1.1.1.2.4.3.1"></times><ci id="A7.p1.1.m1.2.2.1.1.1.1.1.1.2.4.3.2.cmml" xref="A7.p1.1.m1.2.2.1.1.1.1.1.1.2.4.3.2">𝑠</ci><ci id="A7.p1.1.m1.2.2.1.1.1.1.1.1.2.4.3.3.cmml" xref="A7.p1.1.m1.2.2.1.1.1.1.1.1.2.4.3.3">𝑖</ci></apply></apply><list id="A7.p1.1.m1.2.2.1.1.1.1.1.1.2.2.3.cmml" xref="A7.p1.1.m1.2.2.1.1.1.1.1.1.2.2.2"><apply id="A7.p1.1.m1.2.2.1.1.1.1.1.1.1.1.1.1.cmml" xref="A7.p1.1.m1.2.2.1.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="A7.p1.1.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="A7.p1.1.m1.2.2.1.1.1.1.1.1.1.1.1.1">subscript</csymbol><ci id="A7.p1.1.m1.2.2.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="A7.p1.1.m1.2.2.1.1.1.1.1.1.1.1.1.1.2">𝐰</ci><ci id="A7.p1.1.m1.2.2.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="A7.p1.1.m1.2.2.1.1.1.1.1.1.1.1.1.1.3">𝑖</ci></apply><apply id="A7.p1.1.m1.2.2.1.1.1.1.1.1.2.2.2.2.cmml" xref="A7.p1.1.m1.2.2.1.1.1.1.1.1.2.2.2.2"><csymbol cd="ambiguous" id="A7.p1.1.m1.2.2.1.1.1.1.1.1.2.2.2.2.1.cmml" xref="A7.p1.1.m1.2.2.1.1.1.1.1.1.2.2.2.2">subscript</csymbol><ci id="A7.p1.1.m1.2.2.1.1.1.1.1.1.2.2.2.2.2.cmml" xref="A7.p1.1.m1.2.2.1.1.1.1.1.1.2.2.2.2.2">𝐳</ci><apply id="A7.p1.1.m1.2.2.1.1.1.1.1.1.2.2.2.2.3.cmml" xref="A7.p1.1.m1.2.2.1.1.1.1.1.1.2.2.2.2.3"><times id="A7.p1.1.m1.2.2.1.1.1.1.1.1.2.2.2.2.3.1.cmml" xref="A7.p1.1.m1.2.2.1.1.1.1.1.1.2.2.2.2.3.1"></times><ci id="A7.p1.1.m1.2.2.1.1.1.1.1.1.2.2.2.2.3.2.cmml" xref="A7.p1.1.m1.2.2.1.1.1.1.1.1.2.2.2.2.3.2">𝑠</ci><ci id="A7.p1.1.m1.2.2.1.1.1.1.1.1.2.2.2.2.3.3.cmml" xref="A7.p1.1.m1.2.2.1.1.1.1.1.1.2.2.2.2.3.3">𝑖</ci></apply></apply></list></apply><cn type="integer" id="A7.p1.1.m1.2.2.1.1.1.1.1.1.4.cmml" xref="A7.p1.1.m1.2.2.1.1.1.1.1.1.4">1</cn></apply></apply><apply id="A7.p1.1.m1.2.2.1.1.3.cmml" xref="A7.p1.1.m1.2.2.1.1.3"><times id="A7.p1.1.m1.2.2.1.1.3.3.cmml" xref="A7.p1.1.m1.2.2.1.1.3.3"></times><ci id="A7.p1.1.m1.2.2.1.1.3.4.cmml" xref="A7.p1.1.m1.2.2.1.1.3.4">𝒩</ci><interval closure="open" id="A7.p1.1.m1.2.2.1.1.3.2.3.cmml" xref="A7.p1.1.m1.2.2.1.1.3.2.2"><apply id="A7.p1.1.m1.2.2.1.1.2.1.1.1.cmml" xref="A7.p1.1.m1.2.2.1.1.2.1.1.1"><csymbol cd="ambiguous" id="A7.p1.1.m1.2.2.1.1.2.1.1.1.1.cmml" xref="A7.p1.1.m1.2.2.1.1.2.1.1.1">subscript</csymbol><ci id="A7.p1.1.m1.2.2.1.1.2.1.1.1.2.cmml" xref="A7.p1.1.m1.2.2.1.1.2.1.1.1.2">𝐰</ci><ci id="A7.p1.1.m1.2.2.1.1.2.1.1.1.3.cmml" xref="A7.p1.1.m1.2.2.1.1.2.1.1.1.3">𝑖</ci></apply><apply id="A7.p1.1.m1.2.2.1.1.3.2.2.2.cmml" xref="A7.p1.1.m1.2.2.1.1.3.2.2.2"><divide id="A7.p1.1.m1.2.2.1.1.3.2.2.2.1.cmml" xref="A7.p1.1.m1.2.2.1.1.3.2.2.2.1"></divide><cn type="integer" id="A7.p1.1.m1.2.2.1.1.3.2.2.2.2.cmml" xref="A7.p1.1.m1.2.2.1.1.3.2.2.2.2">1</cn><ci id="A7.p1.1.m1.2.2.1.1.3.2.2.2.3.cmml" xref="A7.p1.1.m1.2.2.1.1.3.2.2.2.3">𝜆</ci></apply></interval></apply></apply><apply id="A7.p1.1.m1.3.3.2.2.cmml" xref="A7.p1.1.m1.3.3.2.2"><eq id="A7.p1.1.m1.3.3.2.2.3.cmml" xref="A7.p1.1.m1.3.3.2.2.3"></eq><apply id="A7.p1.1.m1.3.3.2.2.1.cmml" xref="A7.p1.1.m1.3.3.2.2.1"><times id="A7.p1.1.m1.3.3.2.2.1.2.cmml" xref="A7.p1.1.m1.3.3.2.2.1.2"></times><ci id="A7.p1.1.m1.3.3.2.2.1.3.cmml" xref="A7.p1.1.m1.3.3.2.2.1.3">𝑝</ci><apply id="A7.p1.1.m1.3.3.2.2.1.1.1.1.cmml" xref="A7.p1.1.m1.3.3.2.2.1.1.1"><eq id="A7.p1.1.m1.3.3.2.2.1.1.1.1.3.cmml" xref="A7.p1.1.m1.3.3.2.2.1.1.1.1.3"></eq><apply id="A7.p1.1.m1.3.3.2.2.1.1.1.1.2.cmml" xref="A7.p1.1.m1.3.3.2.2.1.1.1.1.2"><csymbol cd="latexml" id="A7.p1.1.m1.3.3.2.2.1.1.1.1.2.3.cmml" xref="A7.p1.1.m1.3.3.2.2.1.1.1.1.2.3">conditional</csymbol><apply id="A7.p1.1.m1.3.3.2.2.1.1.1.1.2.4.cmml" xref="A7.p1.1.m1.3.3.2.2.1.1.1.1.2.4"><csymbol cd="ambiguous" id="A7.p1.1.m1.3.3.2.2.1.1.1.1.2.4.1.cmml" xref="A7.p1.1.m1.3.3.2.2.1.1.1.1.2.4">subscript</csymbol><ci id="A7.p1.1.m1.3.3.2.2.1.1.1.1.2.4.2.cmml" xref="A7.p1.1.m1.3.3.2.2.1.1.1.1.2.4.2">bold-italic-ϕ</ci><apply id="A7.p1.1.m1.3.3.2.2.1.1.1.1.2.4.3.cmml" xref="A7.p1.1.m1.3.3.2.2.1.1.1.1.2.4.3"><times id="A7.p1.1.m1.3.3.2.2.1.1.1.1.2.4.3.1.cmml" xref="A7.p1.1.m1.3.3.2.2.1.1.1.1.2.4.3.1"></times><ci id="A7.p1.1.m1.3.3.2.2.1.1.1.1.2.4.3.2.cmml" xref="A7.p1.1.m1.3.3.2.2.1.1.1.1.2.4.3.2">𝑠</ci><ci id="A7.p1.1.m1.3.3.2.2.1.1.1.1.2.4.3.3.cmml" xref="A7.p1.1.m1.3.3.2.2.1.1.1.1.2.4.3.3">𝑖</ci></apply></apply><list id="A7.p1.1.m1.3.3.2.2.1.1.1.1.2.2.3.cmml" xref="A7.p1.1.m1.3.3.2.2.1.1.1.1.2.2.2"><apply id="A7.p1.1.m1.3.3.2.2.1.1.1.1.1.1.1.1.cmml" xref="A7.p1.1.m1.3.3.2.2.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="A7.p1.1.m1.3.3.2.2.1.1.1.1.1.1.1.1.1.cmml" xref="A7.p1.1.m1.3.3.2.2.1.1.1.1.1.1.1.1">subscript</csymbol><ci id="A7.p1.1.m1.3.3.2.2.1.1.1.1.1.1.1.1.2.cmml" xref="A7.p1.1.m1.3.3.2.2.1.1.1.1.1.1.1.1.2">𝐰</ci><ci id="A7.p1.1.m1.3.3.2.2.1.1.1.1.1.1.1.1.3.cmml" xref="A7.p1.1.m1.3.3.2.2.1.1.1.1.1.1.1.1.3">𝑖</ci></apply><apply id="A7.p1.1.m1.3.3.2.2.1.1.1.1.2.2.2.2.cmml" xref="A7.p1.1.m1.3.3.2.2.1.1.1.1.2.2.2.2"><csymbol cd="ambiguous" id="A7.p1.1.m1.3.3.2.2.1.1.1.1.2.2.2.2.1.cmml" xref="A7.p1.1.m1.3.3.2.2.1.1.1.1.2.2.2.2">subscript</csymbol><ci id="A7.p1.1.m1.3.3.2.2.1.1.1.1.2.2.2.2.2.cmml" xref="A7.p1.1.m1.3.3.2.2.1.1.1.1.2.2.2.2.2">𝐳</ci><apply id="A7.p1.1.m1.3.3.2.2.1.1.1.1.2.2.2.2.3.cmml" xref="A7.p1.1.m1.3.3.2.2.1.1.1.1.2.2.2.2.3"><times id="A7.p1.1.m1.3.3.2.2.1.1.1.1.2.2.2.2.3.1.cmml" xref="A7.p1.1.m1.3.3.2.2.1.1.1.1.2.2.2.2.3.1"></times><ci id="A7.p1.1.m1.3.3.2.2.1.1.1.1.2.2.2.2.3.2.cmml" xref="A7.p1.1.m1.3.3.2.2.1.1.1.1.2.2.2.2.3.2">𝑠</ci><ci id="A7.p1.1.m1.3.3.2.2.1.1.1.1.2.2.2.2.3.3.cmml" xref="A7.p1.1.m1.3.3.2.2.1.1.1.1.2.2.2.2.3.3">𝑖</ci></apply></apply></list></apply><cn type="integer" id="A7.p1.1.m1.3.3.2.2.1.1.1.1.4.cmml" xref="A7.p1.1.m1.3.3.2.2.1.1.1.1.4">0</cn></apply></apply><apply id="A7.p1.1.m1.3.3.2.2.2.cmml" xref="A7.p1.1.m1.3.3.2.2.2"><times id="A7.p1.1.m1.3.3.2.2.2.2.cmml" xref="A7.p1.1.m1.3.3.2.2.2.2"></times><ci id="A7.p1.1.m1.3.3.2.2.2.3.cmml" xref="A7.p1.1.m1.3.3.2.2.2.3">𝒩</ci><interval closure="open" id="A7.p1.1.m1.3.3.2.2.2.1.2.cmml" xref="A7.p1.1.m1.3.3.2.2.2.1.1"><cn type="integer" id="A7.p1.1.m1.1.1.cmml" xref="A7.p1.1.m1.1.1">0</cn><apply id="A7.p1.1.m1.3.3.2.2.2.1.1.1.cmml" xref="A7.p1.1.m1.3.3.2.2.2.1.1.1"><divide id="A7.p1.1.m1.3.3.2.2.2.1.1.1.1.cmml" xref="A7.p1.1.m1.3.3.2.2.2.1.1.1.1"></divide><cn type="integer" id="A7.p1.1.m1.3.3.2.2.2.1.1.1.2.cmml" xref="A7.p1.1.m1.3.3.2.2.2.1.1.1.2">1</cn><apply id="A7.p1.1.m1.3.3.2.2.2.1.1.1.3.cmml" xref="A7.p1.1.m1.3.3.2.2.2.1.1.1.3"><csymbol cd="ambiguous" id="A7.p1.1.m1.3.3.2.2.2.1.1.1.3.1.cmml" xref="A7.p1.1.m1.3.3.2.2.2.1.1.1.3">subscript</csymbol><ci id="A7.p1.1.m1.3.3.2.2.2.1.1.1.3.2.cmml" xref="A7.p1.1.m1.3.3.2.2.2.1.1.1.3.2">𝜆</ci><cn type="integer" id="A7.p1.1.m1.3.3.2.2.2.1.1.1.3.3.cmml" xref="A7.p1.1.m1.3.3.2.2.2.1.1.1.3.3">2</cn></apply></apply></interval></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A7.p1.1.m1.3c">p(\bm{\phi}_{si}|\mathbf{w}_{i},\mathbf{z}_{si}=1)=\mathcal{N}(\mathbf{w}_{i},1/\lambda),p(\bm{\phi}_{si}|\mathbf{w}_{i},\mathbf{z}_{si}=0)=\mathcal{N}(0,1/\lambda_{2})</annotation></semantics></math> and <math id="A7.p1.2.m2.3" class="ltx_Math" alttext="q(\bm{\phi}_{si}|\mathbf{z}_{si}=1)=\mathcal{N}(\mathbf{w}_{si},\epsilon^{2}),q(\bm{\phi}_{si}|\mathbf{z}_{si}=0)=\mathcal{N}(0,\epsilon^{2})" display="inline"><semantics id="A7.p1.2.m2.3a"><mrow id="A7.p1.2.m2.3.3.2" xref="A7.p1.2.m2.3.3.3.cmml"><mrow id="A7.p1.2.m2.2.2.1.1" xref="A7.p1.2.m2.2.2.1.1.cmml"><mrow id="A7.p1.2.m2.2.2.1.1.1" xref="A7.p1.2.m2.2.2.1.1.1.cmml"><mi id="A7.p1.2.m2.2.2.1.1.1.3" xref="A7.p1.2.m2.2.2.1.1.1.3.cmml">q</mi><mo lspace="0em" rspace="0em" id="A7.p1.2.m2.2.2.1.1.1.2" xref="A7.p1.2.m2.2.2.1.1.1.2.cmml">​</mo><mrow id="A7.p1.2.m2.2.2.1.1.1.1.1" xref="A7.p1.2.m2.2.2.1.1.1.1.1.1.cmml"><mo stretchy="false" id="A7.p1.2.m2.2.2.1.1.1.1.1.2" xref="A7.p1.2.m2.2.2.1.1.1.1.1.1.cmml">(</mo><mrow id="A7.p1.2.m2.2.2.1.1.1.1.1.1" xref="A7.p1.2.m2.2.2.1.1.1.1.1.1.cmml"><mrow id="A7.p1.2.m2.2.2.1.1.1.1.1.1.2" xref="A7.p1.2.m2.2.2.1.1.1.1.1.1.2.cmml"><msub id="A7.p1.2.m2.2.2.1.1.1.1.1.1.2.2" xref="A7.p1.2.m2.2.2.1.1.1.1.1.1.2.2.cmml"><mi class="ltx_mathvariant_bold-italic" mathvariant="bold-italic" id="A7.p1.2.m2.2.2.1.1.1.1.1.1.2.2.2" xref="A7.p1.2.m2.2.2.1.1.1.1.1.1.2.2.2.cmml">ϕ</mi><mrow id="A7.p1.2.m2.2.2.1.1.1.1.1.1.2.2.3" xref="A7.p1.2.m2.2.2.1.1.1.1.1.1.2.2.3.cmml"><mi id="A7.p1.2.m2.2.2.1.1.1.1.1.1.2.2.3.2" xref="A7.p1.2.m2.2.2.1.1.1.1.1.1.2.2.3.2.cmml">s</mi><mo lspace="0em" rspace="0em" id="A7.p1.2.m2.2.2.1.1.1.1.1.1.2.2.3.1" xref="A7.p1.2.m2.2.2.1.1.1.1.1.1.2.2.3.1.cmml">​</mo><mi id="A7.p1.2.m2.2.2.1.1.1.1.1.1.2.2.3.3" xref="A7.p1.2.m2.2.2.1.1.1.1.1.1.2.2.3.3.cmml">i</mi></mrow></msub><mo fence="false" id="A7.p1.2.m2.2.2.1.1.1.1.1.1.2.1" xref="A7.p1.2.m2.2.2.1.1.1.1.1.1.2.1.cmml">|</mo><msub id="A7.p1.2.m2.2.2.1.1.1.1.1.1.2.3" xref="A7.p1.2.m2.2.2.1.1.1.1.1.1.2.3.cmml"><mi id="A7.p1.2.m2.2.2.1.1.1.1.1.1.2.3.2" xref="A7.p1.2.m2.2.2.1.1.1.1.1.1.2.3.2.cmml">𝐳</mi><mrow id="A7.p1.2.m2.2.2.1.1.1.1.1.1.2.3.3" xref="A7.p1.2.m2.2.2.1.1.1.1.1.1.2.3.3.cmml"><mi id="A7.p1.2.m2.2.2.1.1.1.1.1.1.2.3.3.2" xref="A7.p1.2.m2.2.2.1.1.1.1.1.1.2.3.3.2.cmml">s</mi><mo lspace="0em" rspace="0em" id="A7.p1.2.m2.2.2.1.1.1.1.1.1.2.3.3.1" xref="A7.p1.2.m2.2.2.1.1.1.1.1.1.2.3.3.1.cmml">​</mo><mi id="A7.p1.2.m2.2.2.1.1.1.1.1.1.2.3.3.3" xref="A7.p1.2.m2.2.2.1.1.1.1.1.1.2.3.3.3.cmml">i</mi></mrow></msub></mrow><mo id="A7.p1.2.m2.2.2.1.1.1.1.1.1.1" xref="A7.p1.2.m2.2.2.1.1.1.1.1.1.1.cmml">=</mo><mn id="A7.p1.2.m2.2.2.1.1.1.1.1.1.3" xref="A7.p1.2.m2.2.2.1.1.1.1.1.1.3.cmml">1</mn></mrow><mo stretchy="false" id="A7.p1.2.m2.2.2.1.1.1.1.1.3" xref="A7.p1.2.m2.2.2.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="A7.p1.2.m2.2.2.1.1.4" xref="A7.p1.2.m2.2.2.1.1.4.cmml">=</mo><mrow id="A7.p1.2.m2.2.2.1.1.3" xref="A7.p1.2.m2.2.2.1.1.3.cmml"><mi class="ltx_font_mathcaligraphic" id="A7.p1.2.m2.2.2.1.1.3.4" xref="A7.p1.2.m2.2.2.1.1.3.4.cmml">𝒩</mi><mo lspace="0em" rspace="0em" id="A7.p1.2.m2.2.2.1.1.3.3" xref="A7.p1.2.m2.2.2.1.1.3.3.cmml">​</mo><mrow id="A7.p1.2.m2.2.2.1.1.3.2.2" xref="A7.p1.2.m2.2.2.1.1.3.2.3.cmml"><mo stretchy="false" id="A7.p1.2.m2.2.2.1.1.3.2.2.3" xref="A7.p1.2.m2.2.2.1.1.3.2.3.cmml">(</mo><msub id="A7.p1.2.m2.2.2.1.1.2.1.1.1" xref="A7.p1.2.m2.2.2.1.1.2.1.1.1.cmml"><mi id="A7.p1.2.m2.2.2.1.1.2.1.1.1.2" xref="A7.p1.2.m2.2.2.1.1.2.1.1.1.2.cmml">𝐰</mi><mrow id="A7.p1.2.m2.2.2.1.1.2.1.1.1.3" xref="A7.p1.2.m2.2.2.1.1.2.1.1.1.3.cmml"><mi id="A7.p1.2.m2.2.2.1.1.2.1.1.1.3.2" xref="A7.p1.2.m2.2.2.1.1.2.1.1.1.3.2.cmml">s</mi><mo lspace="0em" rspace="0em" id="A7.p1.2.m2.2.2.1.1.2.1.1.1.3.1" xref="A7.p1.2.m2.2.2.1.1.2.1.1.1.3.1.cmml">​</mo><mi id="A7.p1.2.m2.2.2.1.1.2.1.1.1.3.3" xref="A7.p1.2.m2.2.2.1.1.2.1.1.1.3.3.cmml">i</mi></mrow></msub><mo id="A7.p1.2.m2.2.2.1.1.3.2.2.4" xref="A7.p1.2.m2.2.2.1.1.3.2.3.cmml">,</mo><msup id="A7.p1.2.m2.2.2.1.1.3.2.2.2" xref="A7.p1.2.m2.2.2.1.1.3.2.2.2.cmml"><mi id="A7.p1.2.m2.2.2.1.1.3.2.2.2.2" xref="A7.p1.2.m2.2.2.1.1.3.2.2.2.2.cmml">ϵ</mi><mn id="A7.p1.2.m2.2.2.1.1.3.2.2.2.3" xref="A7.p1.2.m2.2.2.1.1.3.2.2.2.3.cmml">2</mn></msup><mo stretchy="false" id="A7.p1.2.m2.2.2.1.1.3.2.2.5" xref="A7.p1.2.m2.2.2.1.1.3.2.3.cmml">)</mo></mrow></mrow></mrow><mo id="A7.p1.2.m2.3.3.2.3" xref="A7.p1.2.m2.3.3.3a.cmml">,</mo><mrow id="A7.p1.2.m2.3.3.2.2" xref="A7.p1.2.m2.3.3.2.2.cmml"><mrow id="A7.p1.2.m2.3.3.2.2.1" xref="A7.p1.2.m2.3.3.2.2.1.cmml"><mi id="A7.p1.2.m2.3.3.2.2.1.3" xref="A7.p1.2.m2.3.3.2.2.1.3.cmml">q</mi><mo lspace="0em" rspace="0em" id="A7.p1.2.m2.3.3.2.2.1.2" xref="A7.p1.2.m2.3.3.2.2.1.2.cmml">​</mo><mrow id="A7.p1.2.m2.3.3.2.2.1.1.1" xref="A7.p1.2.m2.3.3.2.2.1.1.1.1.cmml"><mo stretchy="false" id="A7.p1.2.m2.3.3.2.2.1.1.1.2" xref="A7.p1.2.m2.3.3.2.2.1.1.1.1.cmml">(</mo><mrow id="A7.p1.2.m2.3.3.2.2.1.1.1.1" xref="A7.p1.2.m2.3.3.2.2.1.1.1.1.cmml"><mrow id="A7.p1.2.m2.3.3.2.2.1.1.1.1.2" xref="A7.p1.2.m2.3.3.2.2.1.1.1.1.2.cmml"><msub id="A7.p1.2.m2.3.3.2.2.1.1.1.1.2.2" xref="A7.p1.2.m2.3.3.2.2.1.1.1.1.2.2.cmml"><mi class="ltx_mathvariant_bold-italic" mathvariant="bold-italic" id="A7.p1.2.m2.3.3.2.2.1.1.1.1.2.2.2" xref="A7.p1.2.m2.3.3.2.2.1.1.1.1.2.2.2.cmml">ϕ</mi><mrow id="A7.p1.2.m2.3.3.2.2.1.1.1.1.2.2.3" xref="A7.p1.2.m2.3.3.2.2.1.1.1.1.2.2.3.cmml"><mi id="A7.p1.2.m2.3.3.2.2.1.1.1.1.2.2.3.2" xref="A7.p1.2.m2.3.3.2.2.1.1.1.1.2.2.3.2.cmml">s</mi><mo lspace="0em" rspace="0em" id="A7.p1.2.m2.3.3.2.2.1.1.1.1.2.2.3.1" xref="A7.p1.2.m2.3.3.2.2.1.1.1.1.2.2.3.1.cmml">​</mo><mi id="A7.p1.2.m2.3.3.2.2.1.1.1.1.2.2.3.3" xref="A7.p1.2.m2.3.3.2.2.1.1.1.1.2.2.3.3.cmml">i</mi></mrow></msub><mo fence="false" id="A7.p1.2.m2.3.3.2.2.1.1.1.1.2.1" xref="A7.p1.2.m2.3.3.2.2.1.1.1.1.2.1.cmml">|</mo><msub id="A7.p1.2.m2.3.3.2.2.1.1.1.1.2.3" xref="A7.p1.2.m2.3.3.2.2.1.1.1.1.2.3.cmml"><mi id="A7.p1.2.m2.3.3.2.2.1.1.1.1.2.3.2" xref="A7.p1.2.m2.3.3.2.2.1.1.1.1.2.3.2.cmml">𝐳</mi><mrow id="A7.p1.2.m2.3.3.2.2.1.1.1.1.2.3.3" xref="A7.p1.2.m2.3.3.2.2.1.1.1.1.2.3.3.cmml"><mi id="A7.p1.2.m2.3.3.2.2.1.1.1.1.2.3.3.2" xref="A7.p1.2.m2.3.3.2.2.1.1.1.1.2.3.3.2.cmml">s</mi><mo lspace="0em" rspace="0em" id="A7.p1.2.m2.3.3.2.2.1.1.1.1.2.3.3.1" xref="A7.p1.2.m2.3.3.2.2.1.1.1.1.2.3.3.1.cmml">​</mo><mi id="A7.p1.2.m2.3.3.2.2.1.1.1.1.2.3.3.3" xref="A7.p1.2.m2.3.3.2.2.1.1.1.1.2.3.3.3.cmml">i</mi></mrow></msub></mrow><mo id="A7.p1.2.m2.3.3.2.2.1.1.1.1.1" xref="A7.p1.2.m2.3.3.2.2.1.1.1.1.1.cmml">=</mo><mn id="A7.p1.2.m2.3.3.2.2.1.1.1.1.3" xref="A7.p1.2.m2.3.3.2.2.1.1.1.1.3.cmml">0</mn></mrow><mo stretchy="false" id="A7.p1.2.m2.3.3.2.2.1.1.1.3" xref="A7.p1.2.m2.3.3.2.2.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="A7.p1.2.m2.3.3.2.2.3" xref="A7.p1.2.m2.3.3.2.2.3.cmml">=</mo><mrow id="A7.p1.2.m2.3.3.2.2.2" xref="A7.p1.2.m2.3.3.2.2.2.cmml"><mi class="ltx_font_mathcaligraphic" id="A7.p1.2.m2.3.3.2.2.2.3" xref="A7.p1.2.m2.3.3.2.2.2.3.cmml">𝒩</mi><mo lspace="0em" rspace="0em" id="A7.p1.2.m2.3.3.2.2.2.2" xref="A7.p1.2.m2.3.3.2.2.2.2.cmml">​</mo><mrow id="A7.p1.2.m2.3.3.2.2.2.1.1" xref="A7.p1.2.m2.3.3.2.2.2.1.2.cmml"><mo stretchy="false" id="A7.p1.2.m2.3.3.2.2.2.1.1.2" xref="A7.p1.2.m2.3.3.2.2.2.1.2.cmml">(</mo><mn id="A7.p1.2.m2.1.1" xref="A7.p1.2.m2.1.1.cmml">0</mn><mo id="A7.p1.2.m2.3.3.2.2.2.1.1.3" xref="A7.p1.2.m2.3.3.2.2.2.1.2.cmml">,</mo><msup id="A7.p1.2.m2.3.3.2.2.2.1.1.1" xref="A7.p1.2.m2.3.3.2.2.2.1.1.1.cmml"><mi id="A7.p1.2.m2.3.3.2.2.2.1.1.1.2" xref="A7.p1.2.m2.3.3.2.2.2.1.1.1.2.cmml">ϵ</mi><mn id="A7.p1.2.m2.3.3.2.2.2.1.1.1.3" xref="A7.p1.2.m2.3.3.2.2.2.1.1.1.3.cmml">2</mn></msup><mo stretchy="false" id="A7.p1.2.m2.3.3.2.2.2.1.1.4" xref="A7.p1.2.m2.3.3.2.2.2.1.2.cmml">)</mo></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="A7.p1.2.m2.3b"><apply id="A7.p1.2.m2.3.3.3.cmml" xref="A7.p1.2.m2.3.3.2"><csymbol cd="ambiguous" id="A7.p1.2.m2.3.3.3a.cmml" xref="A7.p1.2.m2.3.3.2.3">formulae-sequence</csymbol><apply id="A7.p1.2.m2.2.2.1.1.cmml" xref="A7.p1.2.m2.2.2.1.1"><eq id="A7.p1.2.m2.2.2.1.1.4.cmml" xref="A7.p1.2.m2.2.2.1.1.4"></eq><apply id="A7.p1.2.m2.2.2.1.1.1.cmml" xref="A7.p1.2.m2.2.2.1.1.1"><times id="A7.p1.2.m2.2.2.1.1.1.2.cmml" xref="A7.p1.2.m2.2.2.1.1.1.2"></times><ci id="A7.p1.2.m2.2.2.1.1.1.3.cmml" xref="A7.p1.2.m2.2.2.1.1.1.3">𝑞</ci><apply id="A7.p1.2.m2.2.2.1.1.1.1.1.1.cmml" xref="A7.p1.2.m2.2.2.1.1.1.1.1"><eq id="A7.p1.2.m2.2.2.1.1.1.1.1.1.1.cmml" xref="A7.p1.2.m2.2.2.1.1.1.1.1.1.1"></eq><apply id="A7.p1.2.m2.2.2.1.1.1.1.1.1.2.cmml" xref="A7.p1.2.m2.2.2.1.1.1.1.1.1.2"><csymbol cd="latexml" id="A7.p1.2.m2.2.2.1.1.1.1.1.1.2.1.cmml" xref="A7.p1.2.m2.2.2.1.1.1.1.1.1.2.1">conditional</csymbol><apply id="A7.p1.2.m2.2.2.1.1.1.1.1.1.2.2.cmml" xref="A7.p1.2.m2.2.2.1.1.1.1.1.1.2.2"><csymbol cd="ambiguous" id="A7.p1.2.m2.2.2.1.1.1.1.1.1.2.2.1.cmml" xref="A7.p1.2.m2.2.2.1.1.1.1.1.1.2.2">subscript</csymbol><ci id="A7.p1.2.m2.2.2.1.1.1.1.1.1.2.2.2.cmml" xref="A7.p1.2.m2.2.2.1.1.1.1.1.1.2.2.2">bold-italic-ϕ</ci><apply id="A7.p1.2.m2.2.2.1.1.1.1.1.1.2.2.3.cmml" xref="A7.p1.2.m2.2.2.1.1.1.1.1.1.2.2.3"><times id="A7.p1.2.m2.2.2.1.1.1.1.1.1.2.2.3.1.cmml" xref="A7.p1.2.m2.2.2.1.1.1.1.1.1.2.2.3.1"></times><ci id="A7.p1.2.m2.2.2.1.1.1.1.1.1.2.2.3.2.cmml" xref="A7.p1.2.m2.2.2.1.1.1.1.1.1.2.2.3.2">𝑠</ci><ci id="A7.p1.2.m2.2.2.1.1.1.1.1.1.2.2.3.3.cmml" xref="A7.p1.2.m2.2.2.1.1.1.1.1.1.2.2.3.3">𝑖</ci></apply></apply><apply id="A7.p1.2.m2.2.2.1.1.1.1.1.1.2.3.cmml" xref="A7.p1.2.m2.2.2.1.1.1.1.1.1.2.3"><csymbol cd="ambiguous" id="A7.p1.2.m2.2.2.1.1.1.1.1.1.2.3.1.cmml" xref="A7.p1.2.m2.2.2.1.1.1.1.1.1.2.3">subscript</csymbol><ci id="A7.p1.2.m2.2.2.1.1.1.1.1.1.2.3.2.cmml" xref="A7.p1.2.m2.2.2.1.1.1.1.1.1.2.3.2">𝐳</ci><apply id="A7.p1.2.m2.2.2.1.1.1.1.1.1.2.3.3.cmml" xref="A7.p1.2.m2.2.2.1.1.1.1.1.1.2.3.3"><times id="A7.p1.2.m2.2.2.1.1.1.1.1.1.2.3.3.1.cmml" xref="A7.p1.2.m2.2.2.1.1.1.1.1.1.2.3.3.1"></times><ci id="A7.p1.2.m2.2.2.1.1.1.1.1.1.2.3.3.2.cmml" xref="A7.p1.2.m2.2.2.1.1.1.1.1.1.2.3.3.2">𝑠</ci><ci id="A7.p1.2.m2.2.2.1.1.1.1.1.1.2.3.3.3.cmml" xref="A7.p1.2.m2.2.2.1.1.1.1.1.1.2.3.3.3">𝑖</ci></apply></apply></apply><cn type="integer" id="A7.p1.2.m2.2.2.1.1.1.1.1.1.3.cmml" xref="A7.p1.2.m2.2.2.1.1.1.1.1.1.3">1</cn></apply></apply><apply id="A7.p1.2.m2.2.2.1.1.3.cmml" xref="A7.p1.2.m2.2.2.1.1.3"><times id="A7.p1.2.m2.2.2.1.1.3.3.cmml" xref="A7.p1.2.m2.2.2.1.1.3.3"></times><ci id="A7.p1.2.m2.2.2.1.1.3.4.cmml" xref="A7.p1.2.m2.2.2.1.1.3.4">𝒩</ci><interval closure="open" id="A7.p1.2.m2.2.2.1.1.3.2.3.cmml" xref="A7.p1.2.m2.2.2.1.1.3.2.2"><apply id="A7.p1.2.m2.2.2.1.1.2.1.1.1.cmml" xref="A7.p1.2.m2.2.2.1.1.2.1.1.1"><csymbol cd="ambiguous" id="A7.p1.2.m2.2.2.1.1.2.1.1.1.1.cmml" xref="A7.p1.2.m2.2.2.1.1.2.1.1.1">subscript</csymbol><ci id="A7.p1.2.m2.2.2.1.1.2.1.1.1.2.cmml" xref="A7.p1.2.m2.2.2.1.1.2.1.1.1.2">𝐰</ci><apply id="A7.p1.2.m2.2.2.1.1.2.1.1.1.3.cmml" xref="A7.p1.2.m2.2.2.1.1.2.1.1.1.3"><times id="A7.p1.2.m2.2.2.1.1.2.1.1.1.3.1.cmml" xref="A7.p1.2.m2.2.2.1.1.2.1.1.1.3.1"></times><ci id="A7.p1.2.m2.2.2.1.1.2.1.1.1.3.2.cmml" xref="A7.p1.2.m2.2.2.1.1.2.1.1.1.3.2">𝑠</ci><ci id="A7.p1.2.m2.2.2.1.1.2.1.1.1.3.3.cmml" xref="A7.p1.2.m2.2.2.1.1.2.1.1.1.3.3">𝑖</ci></apply></apply><apply id="A7.p1.2.m2.2.2.1.1.3.2.2.2.cmml" xref="A7.p1.2.m2.2.2.1.1.3.2.2.2"><csymbol cd="ambiguous" id="A7.p1.2.m2.2.2.1.1.3.2.2.2.1.cmml" xref="A7.p1.2.m2.2.2.1.1.3.2.2.2">superscript</csymbol><ci id="A7.p1.2.m2.2.2.1.1.3.2.2.2.2.cmml" xref="A7.p1.2.m2.2.2.1.1.3.2.2.2.2">italic-ϵ</ci><cn type="integer" id="A7.p1.2.m2.2.2.1.1.3.2.2.2.3.cmml" xref="A7.p1.2.m2.2.2.1.1.3.2.2.2.3">2</cn></apply></interval></apply></apply><apply id="A7.p1.2.m2.3.3.2.2.cmml" xref="A7.p1.2.m2.3.3.2.2"><eq id="A7.p1.2.m2.3.3.2.2.3.cmml" xref="A7.p1.2.m2.3.3.2.2.3"></eq><apply id="A7.p1.2.m2.3.3.2.2.1.cmml" xref="A7.p1.2.m2.3.3.2.2.1"><times id="A7.p1.2.m2.3.3.2.2.1.2.cmml" xref="A7.p1.2.m2.3.3.2.2.1.2"></times><ci id="A7.p1.2.m2.3.3.2.2.1.3.cmml" xref="A7.p1.2.m2.3.3.2.2.1.3">𝑞</ci><apply id="A7.p1.2.m2.3.3.2.2.1.1.1.1.cmml" xref="A7.p1.2.m2.3.3.2.2.1.1.1"><eq id="A7.p1.2.m2.3.3.2.2.1.1.1.1.1.cmml" xref="A7.p1.2.m2.3.3.2.2.1.1.1.1.1"></eq><apply id="A7.p1.2.m2.3.3.2.2.1.1.1.1.2.cmml" xref="A7.p1.2.m2.3.3.2.2.1.1.1.1.2"><csymbol cd="latexml" id="A7.p1.2.m2.3.3.2.2.1.1.1.1.2.1.cmml" xref="A7.p1.2.m2.3.3.2.2.1.1.1.1.2.1">conditional</csymbol><apply id="A7.p1.2.m2.3.3.2.2.1.1.1.1.2.2.cmml" xref="A7.p1.2.m2.3.3.2.2.1.1.1.1.2.2"><csymbol cd="ambiguous" id="A7.p1.2.m2.3.3.2.2.1.1.1.1.2.2.1.cmml" xref="A7.p1.2.m2.3.3.2.2.1.1.1.1.2.2">subscript</csymbol><ci id="A7.p1.2.m2.3.3.2.2.1.1.1.1.2.2.2.cmml" xref="A7.p1.2.m2.3.3.2.2.1.1.1.1.2.2.2">bold-italic-ϕ</ci><apply id="A7.p1.2.m2.3.3.2.2.1.1.1.1.2.2.3.cmml" xref="A7.p1.2.m2.3.3.2.2.1.1.1.1.2.2.3"><times id="A7.p1.2.m2.3.3.2.2.1.1.1.1.2.2.3.1.cmml" xref="A7.p1.2.m2.3.3.2.2.1.1.1.1.2.2.3.1"></times><ci id="A7.p1.2.m2.3.3.2.2.1.1.1.1.2.2.3.2.cmml" xref="A7.p1.2.m2.3.3.2.2.1.1.1.1.2.2.3.2">𝑠</ci><ci id="A7.p1.2.m2.3.3.2.2.1.1.1.1.2.2.3.3.cmml" xref="A7.p1.2.m2.3.3.2.2.1.1.1.1.2.2.3.3">𝑖</ci></apply></apply><apply id="A7.p1.2.m2.3.3.2.2.1.1.1.1.2.3.cmml" xref="A7.p1.2.m2.3.3.2.2.1.1.1.1.2.3"><csymbol cd="ambiguous" id="A7.p1.2.m2.3.3.2.2.1.1.1.1.2.3.1.cmml" xref="A7.p1.2.m2.3.3.2.2.1.1.1.1.2.3">subscript</csymbol><ci id="A7.p1.2.m2.3.3.2.2.1.1.1.1.2.3.2.cmml" xref="A7.p1.2.m2.3.3.2.2.1.1.1.1.2.3.2">𝐳</ci><apply id="A7.p1.2.m2.3.3.2.2.1.1.1.1.2.3.3.cmml" xref="A7.p1.2.m2.3.3.2.2.1.1.1.1.2.3.3"><times id="A7.p1.2.m2.3.3.2.2.1.1.1.1.2.3.3.1.cmml" xref="A7.p1.2.m2.3.3.2.2.1.1.1.1.2.3.3.1"></times><ci id="A7.p1.2.m2.3.3.2.2.1.1.1.1.2.3.3.2.cmml" xref="A7.p1.2.m2.3.3.2.2.1.1.1.1.2.3.3.2">𝑠</ci><ci id="A7.p1.2.m2.3.3.2.2.1.1.1.1.2.3.3.3.cmml" xref="A7.p1.2.m2.3.3.2.2.1.1.1.1.2.3.3.3">𝑖</ci></apply></apply></apply><cn type="integer" id="A7.p1.2.m2.3.3.2.2.1.1.1.1.3.cmml" xref="A7.p1.2.m2.3.3.2.2.1.1.1.1.3">0</cn></apply></apply><apply id="A7.p1.2.m2.3.3.2.2.2.cmml" xref="A7.p1.2.m2.3.3.2.2.2"><times id="A7.p1.2.m2.3.3.2.2.2.2.cmml" xref="A7.p1.2.m2.3.3.2.2.2.2"></times><ci id="A7.p1.2.m2.3.3.2.2.2.3.cmml" xref="A7.p1.2.m2.3.3.2.2.2.3">𝒩</ci><interval closure="open" id="A7.p1.2.m2.3.3.2.2.2.1.2.cmml" xref="A7.p1.2.m2.3.3.2.2.2.1.1"><cn type="integer" id="A7.p1.2.m2.1.1.cmml" xref="A7.p1.2.m2.1.1">0</cn><apply id="A7.p1.2.m2.3.3.2.2.2.1.1.1.cmml" xref="A7.p1.2.m2.3.3.2.2.2.1.1.1"><csymbol cd="ambiguous" id="A7.p1.2.m2.3.3.2.2.2.1.1.1.1.cmml" xref="A7.p1.2.m2.3.3.2.2.2.1.1.1">superscript</csymbol><ci id="A7.p1.2.m2.3.3.2.2.2.1.1.1.2.cmml" xref="A7.p1.2.m2.3.3.2.2.2.1.1.1.2">italic-ϵ</ci><cn type="integer" id="A7.p1.2.m2.3.3.2.2.2.1.1.1.3.cmml" xref="A7.p1.2.m2.3.3.2.2.2.1.1.1.3">2</cn></apply></interval></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A7.p1.2.m2.3c">q(\bm{\phi}_{si}|\mathbf{z}_{si}=1)=\mathcal{N}(\mathbf{w}_{si},\epsilon^{2}),q(\bm{\phi}_{si}|\mathbf{z}_{si}=0)=\mathcal{N}(0,\epsilon^{2})</annotation></semantics></math>. Furthermore, let <math id="A7.p1.3.m3.2" class="ltx_Math" alttext="q(\mathbf{z}_{si})=\text{Bern}(\bm{\pi}_{si})" display="inline"><semantics id="A7.p1.3.m3.2a"><mrow id="A7.p1.3.m3.2.2" xref="A7.p1.3.m3.2.2.cmml"><mrow id="A7.p1.3.m3.1.1.1" xref="A7.p1.3.m3.1.1.1.cmml"><mi id="A7.p1.3.m3.1.1.1.3" xref="A7.p1.3.m3.1.1.1.3.cmml">q</mi><mo lspace="0em" rspace="0em" id="A7.p1.3.m3.1.1.1.2" xref="A7.p1.3.m3.1.1.1.2.cmml">​</mo><mrow id="A7.p1.3.m3.1.1.1.1.1" xref="A7.p1.3.m3.1.1.1.1.1.1.cmml"><mo stretchy="false" id="A7.p1.3.m3.1.1.1.1.1.2" xref="A7.p1.3.m3.1.1.1.1.1.1.cmml">(</mo><msub id="A7.p1.3.m3.1.1.1.1.1.1" xref="A7.p1.3.m3.1.1.1.1.1.1.cmml"><mi id="A7.p1.3.m3.1.1.1.1.1.1.2" xref="A7.p1.3.m3.1.1.1.1.1.1.2.cmml">𝐳</mi><mrow id="A7.p1.3.m3.1.1.1.1.1.1.3" xref="A7.p1.3.m3.1.1.1.1.1.1.3.cmml"><mi id="A7.p1.3.m3.1.1.1.1.1.1.3.2" xref="A7.p1.3.m3.1.1.1.1.1.1.3.2.cmml">s</mi><mo lspace="0em" rspace="0em" id="A7.p1.3.m3.1.1.1.1.1.1.3.1" xref="A7.p1.3.m3.1.1.1.1.1.1.3.1.cmml">​</mo><mi id="A7.p1.3.m3.1.1.1.1.1.1.3.3" xref="A7.p1.3.m3.1.1.1.1.1.1.3.3.cmml">i</mi></mrow></msub><mo stretchy="false" id="A7.p1.3.m3.1.1.1.1.1.3" xref="A7.p1.3.m3.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="A7.p1.3.m3.2.2.3" xref="A7.p1.3.m3.2.2.3.cmml">=</mo><mrow id="A7.p1.3.m3.2.2.2" xref="A7.p1.3.m3.2.2.2.cmml"><mtext id="A7.p1.3.m3.2.2.2.3" xref="A7.p1.3.m3.2.2.2.3a.cmml">Bern</mtext><mo lspace="0em" rspace="0em" id="A7.p1.3.m3.2.2.2.2" xref="A7.p1.3.m3.2.2.2.2.cmml">​</mo><mrow id="A7.p1.3.m3.2.2.2.1.1" xref="A7.p1.3.m3.2.2.2.1.1.1.cmml"><mo stretchy="false" id="A7.p1.3.m3.2.2.2.1.1.2" xref="A7.p1.3.m3.2.2.2.1.1.1.cmml">(</mo><msub id="A7.p1.3.m3.2.2.2.1.1.1" xref="A7.p1.3.m3.2.2.2.1.1.1.cmml"><mi id="A7.p1.3.m3.2.2.2.1.1.1.2" xref="A7.p1.3.m3.2.2.2.1.1.1.2.cmml">𝝅</mi><mrow id="A7.p1.3.m3.2.2.2.1.1.1.3" xref="A7.p1.3.m3.2.2.2.1.1.1.3.cmml"><mi id="A7.p1.3.m3.2.2.2.1.1.1.3.2" xref="A7.p1.3.m3.2.2.2.1.1.1.3.2.cmml">s</mi><mo lspace="0em" rspace="0em" id="A7.p1.3.m3.2.2.2.1.1.1.3.1" xref="A7.p1.3.m3.2.2.2.1.1.1.3.1.cmml">​</mo><mi id="A7.p1.3.m3.2.2.2.1.1.1.3.3" xref="A7.p1.3.m3.2.2.2.1.1.1.3.3.cmml">i</mi></mrow></msub><mo stretchy="false" id="A7.p1.3.m3.2.2.2.1.1.3" xref="A7.p1.3.m3.2.2.2.1.1.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="A7.p1.3.m3.2b"><apply id="A7.p1.3.m3.2.2.cmml" xref="A7.p1.3.m3.2.2"><eq id="A7.p1.3.m3.2.2.3.cmml" xref="A7.p1.3.m3.2.2.3"></eq><apply id="A7.p1.3.m3.1.1.1.cmml" xref="A7.p1.3.m3.1.1.1"><times id="A7.p1.3.m3.1.1.1.2.cmml" xref="A7.p1.3.m3.1.1.1.2"></times><ci id="A7.p1.3.m3.1.1.1.3.cmml" xref="A7.p1.3.m3.1.1.1.3">𝑞</ci><apply id="A7.p1.3.m3.1.1.1.1.1.1.cmml" xref="A7.p1.3.m3.1.1.1.1.1"><csymbol cd="ambiguous" id="A7.p1.3.m3.1.1.1.1.1.1.1.cmml" xref="A7.p1.3.m3.1.1.1.1.1">subscript</csymbol><ci id="A7.p1.3.m3.1.1.1.1.1.1.2.cmml" xref="A7.p1.3.m3.1.1.1.1.1.1.2">𝐳</ci><apply id="A7.p1.3.m3.1.1.1.1.1.1.3.cmml" xref="A7.p1.3.m3.1.1.1.1.1.1.3"><times id="A7.p1.3.m3.1.1.1.1.1.1.3.1.cmml" xref="A7.p1.3.m3.1.1.1.1.1.1.3.1"></times><ci id="A7.p1.3.m3.1.1.1.1.1.1.3.2.cmml" xref="A7.p1.3.m3.1.1.1.1.1.1.3.2">𝑠</ci><ci id="A7.p1.3.m3.1.1.1.1.1.1.3.3.cmml" xref="A7.p1.3.m3.1.1.1.1.1.1.3.3">𝑖</ci></apply></apply></apply><apply id="A7.p1.3.m3.2.2.2.cmml" xref="A7.p1.3.m3.2.2.2"><times id="A7.p1.3.m3.2.2.2.2.cmml" xref="A7.p1.3.m3.2.2.2.2"></times><ci id="A7.p1.3.m3.2.2.2.3a.cmml" xref="A7.p1.3.m3.2.2.2.3"><mtext id="A7.p1.3.m3.2.2.2.3.cmml" xref="A7.p1.3.m3.2.2.2.3">Bern</mtext></ci><apply id="A7.p1.3.m3.2.2.2.1.1.1.cmml" xref="A7.p1.3.m3.2.2.2.1.1"><csymbol cd="ambiguous" id="A7.p1.3.m3.2.2.2.1.1.1.1.cmml" xref="A7.p1.3.m3.2.2.2.1.1">subscript</csymbol><ci id="A7.p1.3.m3.2.2.2.1.1.1.2.cmml" xref="A7.p1.3.m3.2.2.2.1.1.1.2">𝝅</ci><apply id="A7.p1.3.m3.2.2.2.1.1.1.3.cmml" xref="A7.p1.3.m3.2.2.2.1.1.1.3"><times id="A7.p1.3.m3.2.2.2.1.1.1.3.1.cmml" xref="A7.p1.3.m3.2.2.2.1.1.1.3.1"></times><ci id="A7.p1.3.m3.2.2.2.1.1.1.3.2.cmml" xref="A7.p1.3.m3.2.2.2.1.1.1.3.2">𝑠</ci><ci id="A7.p1.3.m3.2.2.2.1.1.1.3.3.cmml" xref="A7.p1.3.m3.2.2.2.1.1.1.3.3">𝑖</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A7.p1.3.m3.2c">q(\mathbf{z}_{si})=\text{Bern}(\bm{\pi}_{si})</annotation></semantics></math>. The local objective that stems from <a href="#S3.E16" title="In 3 The FedSparse algorithm: sparsity in federated learning ‣ An Expectation-Maximization Perspective on Federated Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">16</span></a> can be rewritten as:</p>
<table id="A10.EGx26" class="ltx_equationgroup ltx_eqn_align ltx_eqn_table">

<tbody id="A7.Ex2"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math id="A7.Ex2.m1.4" class="ltx_math_unparsed" alttext="\displaystyle\operatorname*{arg\,max}_{\mathbf{w}_{1:S},\bm{\pi}_{1:S}}\mathbb{E}_{q_{\bm{\pi}_{s}}(\mathbf{z}_{s})q_{\mathbf{w}_{s}}(\bm{\phi}_{s}|\mathbf{z}_{s})}\big{[}" display="inline"><semantics id="A7.Ex2.m1.4a"><mrow id="A7.Ex2.m1.4b"><munder id="A7.Ex2.m1.4.5"><mrow id="A7.Ex2.m1.4.5.2"><mi id="A7.Ex2.m1.4.5.2.2">arg</mi><mo lspace="0.170em" rspace="0em" id="A7.Ex2.m1.4.5.2.1">​</mo><mi id="A7.Ex2.m1.4.5.2.3">max</mi></mrow><mrow id="A7.Ex2.m1.2.2.2.2"><msub id="A7.Ex2.m1.1.1.1.1.1"><mi id="A7.Ex2.m1.1.1.1.1.1.2">𝐰</mi><mrow id="A7.Ex2.m1.1.1.1.1.1.3"><mn id="A7.Ex2.m1.1.1.1.1.1.3.2">1</mn><mo lspace="0.278em" rspace="0.278em" id="A7.Ex2.m1.1.1.1.1.1.3.1">:</mo><mi id="A7.Ex2.m1.1.1.1.1.1.3.3">S</mi></mrow></msub><mo id="A7.Ex2.m1.2.2.2.2.3">,</mo><msub id="A7.Ex2.m1.2.2.2.2.2"><mi id="A7.Ex2.m1.2.2.2.2.2.2">𝝅</mi><mrow id="A7.Ex2.m1.2.2.2.2.2.3"><mn id="A7.Ex2.m1.2.2.2.2.2.3.2">1</mn><mo lspace="0.278em" rspace="0.278em" id="A7.Ex2.m1.2.2.2.2.2.3.1">:</mo><mi id="A7.Ex2.m1.2.2.2.2.2.3.3">S</mi></mrow></msub></mrow></munder><msub id="A7.Ex2.m1.4.6"><mi id="A7.Ex2.m1.4.6.2">𝔼</mi><mrow id="A7.Ex2.m1.4.4.2"><msub id="A7.Ex2.m1.4.4.2.4"><mi id="A7.Ex2.m1.4.4.2.4.2">q</mi><msub id="A7.Ex2.m1.4.4.2.4.3"><mi id="A7.Ex2.m1.4.4.2.4.3.2">𝝅</mi><mi id="A7.Ex2.m1.4.4.2.4.3.3">s</mi></msub></msub><mo lspace="0em" rspace="0em" id="A7.Ex2.m1.4.4.2.3">​</mo><mrow id="A7.Ex2.m1.3.3.1.1.1"><mo stretchy="false" id="A7.Ex2.m1.3.3.1.1.1.2">(</mo><msub id="A7.Ex2.m1.3.3.1.1.1.1"><mi id="A7.Ex2.m1.3.3.1.1.1.1.2">𝐳</mi><mi id="A7.Ex2.m1.3.3.1.1.1.1.3">s</mi></msub><mo stretchy="false" id="A7.Ex2.m1.3.3.1.1.1.3">)</mo></mrow><mo lspace="0em" rspace="0em" id="A7.Ex2.m1.4.4.2.3a">​</mo><msub id="A7.Ex2.m1.4.4.2.5"><mi id="A7.Ex2.m1.4.4.2.5.2">q</mi><msub id="A7.Ex2.m1.4.4.2.5.3"><mi id="A7.Ex2.m1.4.4.2.5.3.2">𝐰</mi><mi id="A7.Ex2.m1.4.4.2.5.3.3">s</mi></msub></msub><mo lspace="0em" rspace="0em" id="A7.Ex2.m1.4.4.2.3b">​</mo><mrow id="A7.Ex2.m1.4.4.2.2.1"><mo stretchy="false" id="A7.Ex2.m1.4.4.2.2.1.2">(</mo><mrow id="A7.Ex2.m1.4.4.2.2.1.1"><msub id="A7.Ex2.m1.4.4.2.2.1.1.2"><mi class="ltx_mathvariant_bold-italic" mathvariant="bold-italic" id="A7.Ex2.m1.4.4.2.2.1.1.2.2">ϕ</mi><mi id="A7.Ex2.m1.4.4.2.2.1.1.2.3">s</mi></msub><mo fence="false" id="A7.Ex2.m1.4.4.2.2.1.1.1">|</mo><msub id="A7.Ex2.m1.4.4.2.2.1.1.3"><mi id="A7.Ex2.m1.4.4.2.2.1.1.3.2">𝐳</mi><mi id="A7.Ex2.m1.4.4.2.2.1.1.3.3">s</mi></msub></mrow><mo stretchy="false" id="A7.Ex2.m1.4.4.2.2.1.3">)</mo></mrow></mrow></msub><mo maxsize="120%" minsize="120%" id="A7.Ex2.m1.4.7">[</mo></mrow><annotation encoding="application/x-tex" id="A7.Ex2.m1.4c">\displaystyle\operatorname*{arg\,max}_{\mathbf{w}_{1:S},\bm{\pi}_{1:S}}\mathbb{E}_{q_{\bm{\pi}_{s}}(\mathbf{z}_{s})q_{\mathbf{w}_{s}}(\bm{\phi}_{s}|\mathbf{z}_{s})}\big{[}</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math id="A7.Ex2.m2.1" class="ltx_math_unparsed" alttext="\displaystyle\log p(\mathcal{D}_{s}|\bm{\phi}_{s})\big{]}-\mathbb{E}_{q_{\bm{\pi}_{s}}(\mathbf{z}_{s})}\big{[}KL(q_{\mathbf{w}_{s}}(\bm{\phi}_{s}|\mathbf{z}_{s})||p(\bm{\phi}_{s}|\mathbf{w},\mathbf{z}_{s}))\big{]}" display="inline"><semantics id="A7.Ex2.m2.1a"><mrow id="A7.Ex2.m2.1b"><mi id="A7.Ex2.m2.1.2">log</mi><mi id="A7.Ex2.m2.1.3">p</mi><mrow id="A7.Ex2.m2.1.4"><mo stretchy="false" id="A7.Ex2.m2.1.4.1">(</mo><msub id="A7.Ex2.m2.1.4.2"><mi class="ltx_font_mathcaligraphic" id="A7.Ex2.m2.1.4.2.2">𝒟</mi><mi id="A7.Ex2.m2.1.4.2.3">s</mi></msub><mo fence="false" rspace="0.167em" stretchy="false" id="A7.Ex2.m2.1.4.3">|</mo><msub id="A7.Ex2.m2.1.4.4"><mi class="ltx_mathvariant_bold-italic" mathvariant="bold-italic" id="A7.Ex2.m2.1.4.4.2">ϕ</mi><mi id="A7.Ex2.m2.1.4.4.3">s</mi></msub><mo stretchy="false" id="A7.Ex2.m2.1.4.5">)</mo></mrow><mo maxsize="120%" minsize="120%" id="A7.Ex2.m2.1.5">]</mo><mo id="A7.Ex2.m2.1.6">−</mo><mi id="A7.Ex2.m2.1.7">𝔼</mi><msub id="A7.Ex2.m2.1.1"><mi id="A7.Ex2.m2.1.1a"></mi><mrow id="A7.Ex2.m2.1.1.1"><msub id="A7.Ex2.m2.1.1.1.3"><mi id="A7.Ex2.m2.1.1.1.3.2">q</mi><msub id="A7.Ex2.m2.1.1.1.3.3"><mi id="A7.Ex2.m2.1.1.1.3.3.2">𝝅</mi><mi id="A7.Ex2.m2.1.1.1.3.3.3">s</mi></msub></msub><mo lspace="0em" rspace="0em" id="A7.Ex2.m2.1.1.1.2">​</mo><mrow id="A7.Ex2.m2.1.1.1.1.1"><mo stretchy="false" id="A7.Ex2.m2.1.1.1.1.1.2">(</mo><msub id="A7.Ex2.m2.1.1.1.1.1.1"><mi id="A7.Ex2.m2.1.1.1.1.1.1.2">𝐳</mi><mi id="A7.Ex2.m2.1.1.1.1.1.1.3">s</mi></msub><mo stretchy="false" id="A7.Ex2.m2.1.1.1.1.1.3">)</mo></mrow></mrow></msub><mo maxsize="120%" minsize="120%" id="A7.Ex2.m2.1.8">[</mo><mi id="A7.Ex2.m2.1.9">K</mi><mi id="A7.Ex2.m2.1.10">L</mi><mrow id="A7.Ex2.m2.1.11"><mo stretchy="false" id="A7.Ex2.m2.1.11.1">(</mo><msub id="A7.Ex2.m2.1.11.2"><mi id="A7.Ex2.m2.1.11.2.2">q</mi><msub id="A7.Ex2.m2.1.11.2.3"><mi id="A7.Ex2.m2.1.11.2.3.2">𝐰</mi><mi id="A7.Ex2.m2.1.11.2.3.3">s</mi></msub></msub><mrow id="A7.Ex2.m2.1.11.3"><mo stretchy="false" id="A7.Ex2.m2.1.11.3.1">(</mo><msub id="A7.Ex2.m2.1.11.3.2"><mi class="ltx_mathvariant_bold-italic" mathvariant="bold-italic" id="A7.Ex2.m2.1.11.3.2.2">ϕ</mi><mi id="A7.Ex2.m2.1.11.3.2.3">s</mi></msub><mo fence="false" rspace="0.167em" stretchy="false" id="A7.Ex2.m2.1.11.3.3">|</mo><msub id="A7.Ex2.m2.1.11.3.4"><mi id="A7.Ex2.m2.1.11.3.4.2">𝐳</mi><mi id="A7.Ex2.m2.1.11.3.4.3">s</mi></msub><mo stretchy="false" id="A7.Ex2.m2.1.11.3.5">)</mo></mrow><mo fence="false" rspace="0.167em" stretchy="false" id="A7.Ex2.m2.1.11.4">|</mo><mo fence="false" rspace="0.167em" stretchy="false" id="A7.Ex2.m2.1.11.5">|</mo><mi id="A7.Ex2.m2.1.11.6">p</mi><mrow id="A7.Ex2.m2.1.11.7"><mo stretchy="false" id="A7.Ex2.m2.1.11.7.1">(</mo><msub id="A7.Ex2.m2.1.11.7.2"><mi class="ltx_mathvariant_bold-italic" mathvariant="bold-italic" id="A7.Ex2.m2.1.11.7.2.2">ϕ</mi><mi id="A7.Ex2.m2.1.11.7.2.3">s</mi></msub><mo fence="false" rspace="0.167em" stretchy="false" id="A7.Ex2.m2.1.11.7.3">|</mo><mi id="A7.Ex2.m2.1.11.7.4">𝐰</mi><mo id="A7.Ex2.m2.1.11.7.5">,</mo><msub id="A7.Ex2.m2.1.11.7.6"><mi id="A7.Ex2.m2.1.11.7.6.2">𝐳</mi><mi id="A7.Ex2.m2.1.11.7.6.3">s</mi></msub><mo stretchy="false" id="A7.Ex2.m2.1.11.7.7">)</mo></mrow><mo stretchy="false" id="A7.Ex2.m2.1.11.8">)</mo></mrow><mo maxsize="120%" minsize="120%" id="A7.Ex2.m2.1.12">]</mo></mrow><annotation encoding="application/x-tex" id="A7.Ex2.m2.1c">\displaystyle\log p(\mathcal{D}_{s}|\bm{\phi}_{s})\big{]}-\mathbb{E}_{q_{\bm{\pi}_{s}}(\mathbf{z}_{s})}\big{[}KL(q_{\mathbf{w}_{s}}(\bm{\phi}_{s}|\mathbf{z}_{s})||p(\bm{\phi}_{s}|\mathbf{w},\mathbf{z}_{s}))\big{]}</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
<tbody id="A7.E31"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_eqn_cell"></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math id="A7.E31.m1.2" class="ltx_Math" alttext="\displaystyle\quad+\mathbb{E}_{q_{\bm{\pi}_{s}}(\mathbf{z}_{s})}[\log p(\mathbf{z}_{s}|\bm{\theta})]," display="inline"><semantics id="A7.E31.m1.2a"><mrow id="A7.E31.m1.2.2.1" xref="A7.E31.m1.2.2.1.1.cmml"><mrow id="A7.E31.m1.2.2.1.1" xref="A7.E31.m1.2.2.1.1.cmml"><mo id="A7.E31.m1.2.2.1.1a" xref="A7.E31.m1.2.2.1.1.cmml">+</mo><mrow id="A7.E31.m1.2.2.1.1.1" xref="A7.E31.m1.2.2.1.1.1.cmml"><msub id="A7.E31.m1.2.2.1.1.1.3" xref="A7.E31.m1.2.2.1.1.1.3.cmml"><mi id="A7.E31.m1.2.2.1.1.1.3.2" xref="A7.E31.m1.2.2.1.1.1.3.2.cmml">𝔼</mi><mrow id="A7.E31.m1.1.1.1" xref="A7.E31.m1.1.1.1.cmml"><msub id="A7.E31.m1.1.1.1.3" xref="A7.E31.m1.1.1.1.3.cmml"><mi id="A7.E31.m1.1.1.1.3.2" xref="A7.E31.m1.1.1.1.3.2.cmml">q</mi><msub id="A7.E31.m1.1.1.1.3.3" xref="A7.E31.m1.1.1.1.3.3.cmml"><mi id="A7.E31.m1.1.1.1.3.3.2" xref="A7.E31.m1.1.1.1.3.3.2.cmml">𝝅</mi><mi id="A7.E31.m1.1.1.1.3.3.3" xref="A7.E31.m1.1.1.1.3.3.3.cmml">s</mi></msub></msub><mo lspace="0em" rspace="0em" id="A7.E31.m1.1.1.1.2" xref="A7.E31.m1.1.1.1.2.cmml">​</mo><mrow id="A7.E31.m1.1.1.1.1.1" xref="A7.E31.m1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="A7.E31.m1.1.1.1.1.1.2" xref="A7.E31.m1.1.1.1.1.1.1.cmml">(</mo><msub id="A7.E31.m1.1.1.1.1.1.1" xref="A7.E31.m1.1.1.1.1.1.1.cmml"><mi id="A7.E31.m1.1.1.1.1.1.1.2" xref="A7.E31.m1.1.1.1.1.1.1.2.cmml">𝐳</mi><mi id="A7.E31.m1.1.1.1.1.1.1.3" xref="A7.E31.m1.1.1.1.1.1.1.3.cmml">s</mi></msub><mo stretchy="false" id="A7.E31.m1.1.1.1.1.1.3" xref="A7.E31.m1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></msub><mo lspace="0em" rspace="0em" id="A7.E31.m1.2.2.1.1.1.2" xref="A7.E31.m1.2.2.1.1.1.2.cmml">​</mo><mrow id="A7.E31.m1.2.2.1.1.1.1.1" xref="A7.E31.m1.2.2.1.1.1.1.2.cmml"><mo stretchy="false" id="A7.E31.m1.2.2.1.1.1.1.1.2" xref="A7.E31.m1.2.2.1.1.1.1.2.1.cmml">[</mo><mrow id="A7.E31.m1.2.2.1.1.1.1.1.1" xref="A7.E31.m1.2.2.1.1.1.1.1.1.cmml"><mrow id="A7.E31.m1.2.2.1.1.1.1.1.1.3" xref="A7.E31.m1.2.2.1.1.1.1.1.1.3.cmml"><mi id="A7.E31.m1.2.2.1.1.1.1.1.1.3.1" xref="A7.E31.m1.2.2.1.1.1.1.1.1.3.1.cmml">log</mi><mo lspace="0.167em" id="A7.E31.m1.2.2.1.1.1.1.1.1.3a" xref="A7.E31.m1.2.2.1.1.1.1.1.1.3.cmml">⁡</mo><mi id="A7.E31.m1.2.2.1.1.1.1.1.1.3.2" xref="A7.E31.m1.2.2.1.1.1.1.1.1.3.2.cmml">p</mi></mrow><mo lspace="0em" rspace="0em" id="A7.E31.m1.2.2.1.1.1.1.1.1.2" xref="A7.E31.m1.2.2.1.1.1.1.1.1.2.cmml">​</mo><mrow id="A7.E31.m1.2.2.1.1.1.1.1.1.1.1" xref="A7.E31.m1.2.2.1.1.1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="A7.E31.m1.2.2.1.1.1.1.1.1.1.1.2" xref="A7.E31.m1.2.2.1.1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="A7.E31.m1.2.2.1.1.1.1.1.1.1.1.1" xref="A7.E31.m1.2.2.1.1.1.1.1.1.1.1.1.cmml"><msub id="A7.E31.m1.2.2.1.1.1.1.1.1.1.1.1.2" xref="A7.E31.m1.2.2.1.1.1.1.1.1.1.1.1.2.cmml"><mi id="A7.E31.m1.2.2.1.1.1.1.1.1.1.1.1.2.2" xref="A7.E31.m1.2.2.1.1.1.1.1.1.1.1.1.2.2.cmml">𝐳</mi><mi id="A7.E31.m1.2.2.1.1.1.1.1.1.1.1.1.2.3" xref="A7.E31.m1.2.2.1.1.1.1.1.1.1.1.1.2.3.cmml">s</mi></msub><mo fence="false" id="A7.E31.m1.2.2.1.1.1.1.1.1.1.1.1.1" xref="A7.E31.m1.2.2.1.1.1.1.1.1.1.1.1.1.cmml">|</mo><mi id="A7.E31.m1.2.2.1.1.1.1.1.1.1.1.1.3" xref="A7.E31.m1.2.2.1.1.1.1.1.1.1.1.1.3.cmml">𝜽</mi></mrow><mo stretchy="false" id="A7.E31.m1.2.2.1.1.1.1.1.1.1.1.3" xref="A7.E31.m1.2.2.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo stretchy="false" id="A7.E31.m1.2.2.1.1.1.1.1.3" xref="A7.E31.m1.2.2.1.1.1.1.2.1.cmml">]</mo></mrow></mrow></mrow><mo id="A7.E31.m1.2.2.1.2" xref="A7.E31.m1.2.2.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="A7.E31.m1.2b"><apply id="A7.E31.m1.2.2.1.1.cmml" xref="A7.E31.m1.2.2.1"><plus id="A7.E31.m1.2.2.1.1.2.cmml" xref="A7.E31.m1.2.2.1"></plus><apply id="A7.E31.m1.2.2.1.1.1.cmml" xref="A7.E31.m1.2.2.1.1.1"><times id="A7.E31.m1.2.2.1.1.1.2.cmml" xref="A7.E31.m1.2.2.1.1.1.2"></times><apply id="A7.E31.m1.2.2.1.1.1.3.cmml" xref="A7.E31.m1.2.2.1.1.1.3"><csymbol cd="ambiguous" id="A7.E31.m1.2.2.1.1.1.3.1.cmml" xref="A7.E31.m1.2.2.1.1.1.3">subscript</csymbol><ci id="A7.E31.m1.2.2.1.1.1.3.2.cmml" xref="A7.E31.m1.2.2.1.1.1.3.2">𝔼</ci><apply id="A7.E31.m1.1.1.1.cmml" xref="A7.E31.m1.1.1.1"><times id="A7.E31.m1.1.1.1.2.cmml" xref="A7.E31.m1.1.1.1.2"></times><apply id="A7.E31.m1.1.1.1.3.cmml" xref="A7.E31.m1.1.1.1.3"><csymbol cd="ambiguous" id="A7.E31.m1.1.1.1.3.1.cmml" xref="A7.E31.m1.1.1.1.3">subscript</csymbol><ci id="A7.E31.m1.1.1.1.3.2.cmml" xref="A7.E31.m1.1.1.1.3.2">𝑞</ci><apply id="A7.E31.m1.1.1.1.3.3.cmml" xref="A7.E31.m1.1.1.1.3.3"><csymbol cd="ambiguous" id="A7.E31.m1.1.1.1.3.3.1.cmml" xref="A7.E31.m1.1.1.1.3.3">subscript</csymbol><ci id="A7.E31.m1.1.1.1.3.3.2.cmml" xref="A7.E31.m1.1.1.1.3.3.2">𝝅</ci><ci id="A7.E31.m1.1.1.1.3.3.3.cmml" xref="A7.E31.m1.1.1.1.3.3.3">𝑠</ci></apply></apply><apply id="A7.E31.m1.1.1.1.1.1.1.cmml" xref="A7.E31.m1.1.1.1.1.1"><csymbol cd="ambiguous" id="A7.E31.m1.1.1.1.1.1.1.1.cmml" xref="A7.E31.m1.1.1.1.1.1">subscript</csymbol><ci id="A7.E31.m1.1.1.1.1.1.1.2.cmml" xref="A7.E31.m1.1.1.1.1.1.1.2">𝐳</ci><ci id="A7.E31.m1.1.1.1.1.1.1.3.cmml" xref="A7.E31.m1.1.1.1.1.1.1.3">𝑠</ci></apply></apply></apply><apply id="A7.E31.m1.2.2.1.1.1.1.2.cmml" xref="A7.E31.m1.2.2.1.1.1.1.1"><csymbol cd="latexml" id="A7.E31.m1.2.2.1.1.1.1.2.1.cmml" xref="A7.E31.m1.2.2.1.1.1.1.1.2">delimited-[]</csymbol><apply id="A7.E31.m1.2.2.1.1.1.1.1.1.cmml" xref="A7.E31.m1.2.2.1.1.1.1.1.1"><times id="A7.E31.m1.2.2.1.1.1.1.1.1.2.cmml" xref="A7.E31.m1.2.2.1.1.1.1.1.1.2"></times><apply id="A7.E31.m1.2.2.1.1.1.1.1.1.3.cmml" xref="A7.E31.m1.2.2.1.1.1.1.1.1.3"><log id="A7.E31.m1.2.2.1.1.1.1.1.1.3.1.cmml" xref="A7.E31.m1.2.2.1.1.1.1.1.1.3.1"></log><ci id="A7.E31.m1.2.2.1.1.1.1.1.1.3.2.cmml" xref="A7.E31.m1.2.2.1.1.1.1.1.1.3.2">𝑝</ci></apply><apply id="A7.E31.m1.2.2.1.1.1.1.1.1.1.1.1.cmml" xref="A7.E31.m1.2.2.1.1.1.1.1.1.1.1"><csymbol cd="latexml" id="A7.E31.m1.2.2.1.1.1.1.1.1.1.1.1.1.cmml" xref="A7.E31.m1.2.2.1.1.1.1.1.1.1.1.1.1">conditional</csymbol><apply id="A7.E31.m1.2.2.1.1.1.1.1.1.1.1.1.2.cmml" xref="A7.E31.m1.2.2.1.1.1.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="A7.E31.m1.2.2.1.1.1.1.1.1.1.1.1.2.1.cmml" xref="A7.E31.m1.2.2.1.1.1.1.1.1.1.1.1.2">subscript</csymbol><ci id="A7.E31.m1.2.2.1.1.1.1.1.1.1.1.1.2.2.cmml" xref="A7.E31.m1.2.2.1.1.1.1.1.1.1.1.1.2.2">𝐳</ci><ci id="A7.E31.m1.2.2.1.1.1.1.1.1.1.1.1.2.3.cmml" xref="A7.E31.m1.2.2.1.1.1.1.1.1.1.1.1.2.3">𝑠</ci></apply><ci id="A7.E31.m1.2.2.1.1.1.1.1.1.1.1.1.3.cmml" xref="A7.E31.m1.2.2.1.1.1.1.1.1.1.1.1.3">𝜽</ci></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A7.E31.m1.2c">\displaystyle\quad+\mathbb{E}_{q_{\bm{\pi}_{s}}(\mathbf{z}_{s})}[\log p(\mathbf{z}_{s}|\bm{\theta})],</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(31)</span></td>
</tr></tbody>
</table>
<p id="A7.p1.4" class="ltx_p">where we omitted from the objective the entropy of the distribution over the local gates.</p>
</div>
<div id="A7.p2" class="ltx_para">
<p id="A7.p2.13" class="ltx_p">One of the quantities that we are after is</p>
<table id="A10.EGx27" class="ltx_equationgroup ltx_eqn_align ltx_eqn_table">

<tbody id="A7.Ex3"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math id="A7.Ex3.m1.1" class="ltx_math_unparsed" alttext="\displaystyle\mathbb{E}_{q(\mathbf{z}_{si})}[" display="inline"><semantics id="A7.Ex3.m1.1a"><mrow id="A7.Ex3.m1.1b"><msub id="A7.Ex3.m1.1.2"><mi id="A7.Ex3.m1.1.2.2">𝔼</mi><mrow id="A7.Ex3.m1.1.1.1"><mi id="A7.Ex3.m1.1.1.1.3">q</mi><mo lspace="0em" rspace="0em" id="A7.Ex3.m1.1.1.1.2">​</mo><mrow id="A7.Ex3.m1.1.1.1.1.1"><mo stretchy="false" id="A7.Ex3.m1.1.1.1.1.1.2">(</mo><msub id="A7.Ex3.m1.1.1.1.1.1.1"><mi id="A7.Ex3.m1.1.1.1.1.1.1.2">𝐳</mi><mrow id="A7.Ex3.m1.1.1.1.1.1.1.3"><mi id="A7.Ex3.m1.1.1.1.1.1.1.3.2">s</mi><mo lspace="0em" rspace="0em" id="A7.Ex3.m1.1.1.1.1.1.1.3.1">​</mo><mi id="A7.Ex3.m1.1.1.1.1.1.1.3.3">i</mi></mrow></msub><mo stretchy="false" id="A7.Ex3.m1.1.1.1.1.1.3">)</mo></mrow></mrow></msub><mo stretchy="false" id="A7.Ex3.m1.1.3">[</mo></mrow><annotation encoding="application/x-tex" id="A7.Ex3.m1.1c">\displaystyle\mathbb{E}_{q(\mathbf{z}_{si})}[</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math id="A7.Ex3.m2.1" class="ltx_math_unparsed" alttext="\displaystyle KL(q(\bm{\phi}_{si}|\mathbf{z}_{si})||p(\bm{\phi}_{si}|\mathbf{z}_{si}))]=" display="inline"><semantics id="A7.Ex3.m2.1a"><mrow id="A7.Ex3.m2.1b"><mi id="A7.Ex3.m2.1.1">K</mi><mi id="A7.Ex3.m2.1.2">L</mi><mrow id="A7.Ex3.m2.1.3"><mo stretchy="false" id="A7.Ex3.m2.1.3.1">(</mo><mi id="A7.Ex3.m2.1.3.2">q</mi><mrow id="A7.Ex3.m2.1.3.3"><mo stretchy="false" id="A7.Ex3.m2.1.3.3.1">(</mo><msub id="A7.Ex3.m2.1.3.3.2"><mi class="ltx_mathvariant_bold-italic" mathvariant="bold-italic" id="A7.Ex3.m2.1.3.3.2.2">ϕ</mi><mrow id="A7.Ex3.m2.1.3.3.2.3"><mi id="A7.Ex3.m2.1.3.3.2.3.2">s</mi><mo lspace="0em" rspace="0em" id="A7.Ex3.m2.1.3.3.2.3.1">​</mo><mi id="A7.Ex3.m2.1.3.3.2.3.3">i</mi></mrow></msub><mo fence="false" rspace="0.167em" stretchy="false" id="A7.Ex3.m2.1.3.3.3">|</mo><msub id="A7.Ex3.m2.1.3.3.4"><mi id="A7.Ex3.m2.1.3.3.4.2">𝐳</mi><mrow id="A7.Ex3.m2.1.3.3.4.3"><mi id="A7.Ex3.m2.1.3.3.4.3.2">s</mi><mo lspace="0em" rspace="0em" id="A7.Ex3.m2.1.3.3.4.3.1">​</mo><mi id="A7.Ex3.m2.1.3.3.4.3.3">i</mi></mrow></msub><mo stretchy="false" id="A7.Ex3.m2.1.3.3.5">)</mo></mrow><mo fence="false" rspace="0.167em" stretchy="false" id="A7.Ex3.m2.1.3.4">|</mo><mo fence="false" rspace="0.167em" stretchy="false" id="A7.Ex3.m2.1.3.5">|</mo><mi id="A7.Ex3.m2.1.3.6">p</mi><mrow id="A7.Ex3.m2.1.3.7"><mo stretchy="false" id="A7.Ex3.m2.1.3.7.1">(</mo><msub id="A7.Ex3.m2.1.3.7.2"><mi class="ltx_mathvariant_bold-italic" mathvariant="bold-italic" id="A7.Ex3.m2.1.3.7.2.2">ϕ</mi><mrow id="A7.Ex3.m2.1.3.7.2.3"><mi id="A7.Ex3.m2.1.3.7.2.3.2">s</mi><mo lspace="0em" rspace="0em" id="A7.Ex3.m2.1.3.7.2.3.1">​</mo><mi id="A7.Ex3.m2.1.3.7.2.3.3">i</mi></mrow></msub><mo fence="false" rspace="0.167em" stretchy="false" id="A7.Ex3.m2.1.3.7.3">|</mo><msub id="A7.Ex3.m2.1.3.7.4"><mi id="A7.Ex3.m2.1.3.7.4.2">𝐳</mi><mrow id="A7.Ex3.m2.1.3.7.4.3"><mi id="A7.Ex3.m2.1.3.7.4.3.2">s</mi><mo lspace="0em" rspace="0em" id="A7.Ex3.m2.1.3.7.4.3.1">​</mo><mi id="A7.Ex3.m2.1.3.7.4.3.3">i</mi></mrow></msub><mo stretchy="false" id="A7.Ex3.m2.1.3.7.5">)</mo></mrow><mo stretchy="false" id="A7.Ex3.m2.1.3.8">)</mo></mrow><mo stretchy="false" id="A7.Ex3.m2.1.4">]</mo><mo id="A7.Ex3.m2.1.5">=</mo></mrow><annotation encoding="application/x-tex" id="A7.Ex3.m2.1c">\displaystyle KL(q(\bm{\phi}_{si}|\mathbf{z}_{si})||p(\bm{\phi}_{si}|\mathbf{z}_{si}))]=</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
<tbody id="A7.E32"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_eqn_cell"></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math id="A7.E32.m1.1" class="ltx_math_unparsed" alttext="\displaystyle\bm{\pi}_{si}KL(\mathcal{N}(\mathbf{w}_{si},\epsilon^{2})||\mathcal{N}(\mathbf{w}_{i},1/\lambda))+(1-\bm{\pi}_{si})KL(\mathcal{N}(0,\epsilon^{2})||\mathcal{N}(0,1/\lambda_{2}))." display="inline"><semantics id="A7.E32.m1.1a"><mrow id="A7.E32.m1.1b"><msub id="A7.E32.m1.1.1"><mi id="A7.E32.m1.1.1.2">𝝅</mi><mrow id="A7.E32.m1.1.1.3"><mi id="A7.E32.m1.1.1.3.2">s</mi><mo lspace="0em" rspace="0em" id="A7.E32.m1.1.1.3.1">​</mo><mi id="A7.E32.m1.1.1.3.3">i</mi></mrow></msub><mi id="A7.E32.m1.1.2">K</mi><mi id="A7.E32.m1.1.3">L</mi><mrow id="A7.E32.m1.1.4"><mo stretchy="false" id="A7.E32.m1.1.4.1">(</mo><mi class="ltx_font_mathcaligraphic" id="A7.E32.m1.1.4.2">𝒩</mi><mrow id="A7.E32.m1.1.4.3"><mo stretchy="false" id="A7.E32.m1.1.4.3.1">(</mo><msub id="A7.E32.m1.1.4.3.2"><mi id="A7.E32.m1.1.4.3.2.2">𝐰</mi><mrow id="A7.E32.m1.1.4.3.2.3"><mi id="A7.E32.m1.1.4.3.2.3.2">s</mi><mo lspace="0em" rspace="0em" id="A7.E32.m1.1.4.3.2.3.1">​</mo><mi id="A7.E32.m1.1.4.3.2.3.3">i</mi></mrow></msub><mo id="A7.E32.m1.1.4.3.3">,</mo><msup id="A7.E32.m1.1.4.3.4"><mi id="A7.E32.m1.1.4.3.4.2">ϵ</mi><mn id="A7.E32.m1.1.4.3.4.3">2</mn></msup><mo stretchy="false" id="A7.E32.m1.1.4.3.5">)</mo></mrow><mo fence="false" rspace="0.167em" stretchy="false" id="A7.E32.m1.1.4.4">|</mo><mo fence="false" rspace="0.167em" stretchy="false" id="A7.E32.m1.1.4.5">|</mo><mi class="ltx_font_mathcaligraphic" id="A7.E32.m1.1.4.6">𝒩</mi><mrow id="A7.E32.m1.1.4.7"><mo stretchy="false" id="A7.E32.m1.1.4.7.1">(</mo><msub id="A7.E32.m1.1.4.7.2"><mi id="A7.E32.m1.1.4.7.2.2">𝐰</mi><mi id="A7.E32.m1.1.4.7.2.3">i</mi></msub><mo id="A7.E32.m1.1.4.7.3">,</mo><mn id="A7.E32.m1.1.4.7.4">1</mn><mo id="A7.E32.m1.1.4.7.5">/</mo><mi id="A7.E32.m1.1.4.7.6">λ</mi><mo stretchy="false" id="A7.E32.m1.1.4.7.7">)</mo></mrow><mo stretchy="false" id="A7.E32.m1.1.4.8">)</mo></mrow><mo id="A7.E32.m1.1.5">+</mo><mrow id="A7.E32.m1.1.6"><mo stretchy="false" id="A7.E32.m1.1.6.1">(</mo><mn id="A7.E32.m1.1.6.2">1</mn><mo id="A7.E32.m1.1.6.3">−</mo><msub id="A7.E32.m1.1.6.4"><mi id="A7.E32.m1.1.6.4.2">𝝅</mi><mrow id="A7.E32.m1.1.6.4.3"><mi id="A7.E32.m1.1.6.4.3.2">s</mi><mo lspace="0em" rspace="0em" id="A7.E32.m1.1.6.4.3.1">​</mo><mi id="A7.E32.m1.1.6.4.3.3">i</mi></mrow></msub><mo stretchy="false" id="A7.E32.m1.1.6.5">)</mo></mrow><mi id="A7.E32.m1.1.7">K</mi><mi id="A7.E32.m1.1.8">L</mi><mrow id="A7.E32.m1.1.9"><mo stretchy="false" id="A7.E32.m1.1.9.1">(</mo><mi class="ltx_font_mathcaligraphic" id="A7.E32.m1.1.9.2">𝒩</mi><mrow id="A7.E32.m1.1.9.3"><mo stretchy="false" id="A7.E32.m1.1.9.3.1">(</mo><mn id="A7.E32.m1.1.9.3.2">0</mn><mo id="A7.E32.m1.1.9.3.3">,</mo><msup id="A7.E32.m1.1.9.3.4"><mi id="A7.E32.m1.1.9.3.4.2">ϵ</mi><mn id="A7.E32.m1.1.9.3.4.3">2</mn></msup><mo stretchy="false" id="A7.E32.m1.1.9.3.5">)</mo></mrow><mo fence="false" rspace="0.167em" stretchy="false" id="A7.E32.m1.1.9.4">|</mo><mo fence="false" rspace="0.167em" stretchy="false" id="A7.E32.m1.1.9.5">|</mo><mi class="ltx_font_mathcaligraphic" id="A7.E32.m1.1.9.6">𝒩</mi><mrow id="A7.E32.m1.1.9.7"><mo stretchy="false" id="A7.E32.m1.1.9.7.1">(</mo><mn id="A7.E32.m1.1.9.7.2">0</mn><mo id="A7.E32.m1.1.9.7.3">,</mo><mn id="A7.E32.m1.1.9.7.4">1</mn><mo id="A7.E32.m1.1.9.7.5">/</mo><msub id="A7.E32.m1.1.9.7.6"><mi id="A7.E32.m1.1.9.7.6.2">λ</mi><mn id="A7.E32.m1.1.9.7.6.3">2</mn></msub><mo stretchy="false" id="A7.E32.m1.1.9.7.7">)</mo></mrow><mo stretchy="false" id="A7.E32.m1.1.9.8">)</mo></mrow><mo lspace="0em" id="A7.E32.m1.1.10">.</mo></mrow><annotation encoding="application/x-tex" id="A7.E32.m1.1c">\displaystyle\bm{\pi}_{si}KL(\mathcal{N}(\mathbf{w}_{si},\epsilon^{2})||\mathcal{N}(\mathbf{w}_{i},1/\lambda))+(1-\bm{\pi}_{si})KL(\mathcal{N}(0,\epsilon^{2})||\mathcal{N}(0,1/\lambda_{2})).</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(32)</span></td>
</tr></tbody>
</table>
<p id="A7.p2.1" class="ltx_p">The KL term for when <math id="A7.p2.1.m1.1" class="ltx_Math" alttext="\mathbf{z}_{si}=1" display="inline"><semantics id="A7.p2.1.m1.1a"><mrow id="A7.p2.1.m1.1.1" xref="A7.p2.1.m1.1.1.cmml"><msub id="A7.p2.1.m1.1.1.2" xref="A7.p2.1.m1.1.1.2.cmml"><mi id="A7.p2.1.m1.1.1.2.2" xref="A7.p2.1.m1.1.1.2.2.cmml">𝐳</mi><mrow id="A7.p2.1.m1.1.1.2.3" xref="A7.p2.1.m1.1.1.2.3.cmml"><mi id="A7.p2.1.m1.1.1.2.3.2" xref="A7.p2.1.m1.1.1.2.3.2.cmml">s</mi><mo lspace="0em" rspace="0em" id="A7.p2.1.m1.1.1.2.3.1" xref="A7.p2.1.m1.1.1.2.3.1.cmml">​</mo><mi id="A7.p2.1.m1.1.1.2.3.3" xref="A7.p2.1.m1.1.1.2.3.3.cmml">i</mi></mrow></msub><mo id="A7.p2.1.m1.1.1.1" xref="A7.p2.1.m1.1.1.1.cmml">=</mo><mn id="A7.p2.1.m1.1.1.3" xref="A7.p2.1.m1.1.1.3.cmml">1</mn></mrow><annotation-xml encoding="MathML-Content" id="A7.p2.1.m1.1b"><apply id="A7.p2.1.m1.1.1.cmml" xref="A7.p2.1.m1.1.1"><eq id="A7.p2.1.m1.1.1.1.cmml" xref="A7.p2.1.m1.1.1.1"></eq><apply id="A7.p2.1.m1.1.1.2.cmml" xref="A7.p2.1.m1.1.1.2"><csymbol cd="ambiguous" id="A7.p2.1.m1.1.1.2.1.cmml" xref="A7.p2.1.m1.1.1.2">subscript</csymbol><ci id="A7.p2.1.m1.1.1.2.2.cmml" xref="A7.p2.1.m1.1.1.2.2">𝐳</ci><apply id="A7.p2.1.m1.1.1.2.3.cmml" xref="A7.p2.1.m1.1.1.2.3"><times id="A7.p2.1.m1.1.1.2.3.1.cmml" xref="A7.p2.1.m1.1.1.2.3.1"></times><ci id="A7.p2.1.m1.1.1.2.3.2.cmml" xref="A7.p2.1.m1.1.1.2.3.2">𝑠</ci><ci id="A7.p2.1.m1.1.1.2.3.3.cmml" xref="A7.p2.1.m1.1.1.2.3.3">𝑖</ci></apply></apply><cn type="integer" id="A7.p2.1.m1.1.1.3.cmml" xref="A7.p2.1.m1.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A7.p2.1.m1.1c">\mathbf{z}_{si}=1</annotation></semantics></math> can be written as</p>
<table id="A10.EGx28" class="ltx_equationgroup ltx_eqn_align ltx_eqn_table">

<tbody id="A7.E33"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math id="A7.E33.m1.1" class="ltx_math_unparsed" alttext="\displaystyle KL(\mathcal{N}(\mathbf{w}_{si},\epsilon^{2})||\mathcal{N}(\mathbf{w}_{i},1/\lambda))=-\frac{1}{2}\log\lambda-\log\epsilon+\frac{\lambda\epsilon^{2}}{2}-\frac{1}{2}+\frac{\lambda}{2}(\mathbf{w}_{si}-\mathbf{w}_{i})^{2}." display="inline"><semantics id="A7.E33.m1.1a"><mrow id="A7.E33.m1.1b"><mi id="A7.E33.m1.1.1">K</mi><mi id="A7.E33.m1.1.2">L</mi><mrow id="A7.E33.m1.1.3"><mo stretchy="false" id="A7.E33.m1.1.3.1">(</mo><mi class="ltx_font_mathcaligraphic" id="A7.E33.m1.1.3.2">𝒩</mi><mrow id="A7.E33.m1.1.3.3"><mo stretchy="false" id="A7.E33.m1.1.3.3.1">(</mo><msub id="A7.E33.m1.1.3.3.2"><mi id="A7.E33.m1.1.3.3.2.2">𝐰</mi><mrow id="A7.E33.m1.1.3.3.2.3"><mi id="A7.E33.m1.1.3.3.2.3.2">s</mi><mo lspace="0em" rspace="0em" id="A7.E33.m1.1.3.3.2.3.1">​</mo><mi id="A7.E33.m1.1.3.3.2.3.3">i</mi></mrow></msub><mo id="A7.E33.m1.1.3.3.3">,</mo><msup id="A7.E33.m1.1.3.3.4"><mi id="A7.E33.m1.1.3.3.4.2">ϵ</mi><mn id="A7.E33.m1.1.3.3.4.3">2</mn></msup><mo stretchy="false" id="A7.E33.m1.1.3.3.5">)</mo></mrow><mo fence="false" rspace="0.167em" stretchy="false" id="A7.E33.m1.1.3.4">|</mo><mo fence="false" rspace="0.167em" stretchy="false" id="A7.E33.m1.1.3.5">|</mo><mi class="ltx_font_mathcaligraphic" id="A7.E33.m1.1.3.6">𝒩</mi><mrow id="A7.E33.m1.1.3.7"><mo stretchy="false" id="A7.E33.m1.1.3.7.1">(</mo><msub id="A7.E33.m1.1.3.7.2"><mi id="A7.E33.m1.1.3.7.2.2">𝐰</mi><mi id="A7.E33.m1.1.3.7.2.3">i</mi></msub><mo id="A7.E33.m1.1.3.7.3">,</mo><mn id="A7.E33.m1.1.3.7.4">1</mn><mo id="A7.E33.m1.1.3.7.5">/</mo><mi id="A7.E33.m1.1.3.7.6">λ</mi><mo stretchy="false" id="A7.E33.m1.1.3.7.7">)</mo></mrow><mo stretchy="false" id="A7.E33.m1.1.3.8">)</mo></mrow><mo rspace="0em" id="A7.E33.m1.1.4">=</mo><mo lspace="0em" id="A7.E33.m1.1.5">−</mo><mstyle displaystyle="true" id="A7.E33.m1.1.6"><mfrac id="A7.E33.m1.1.6a"><mn id="A7.E33.m1.1.6.2">1</mn><mn id="A7.E33.m1.1.6.3">2</mn></mfrac></mstyle><mi id="A7.E33.m1.1.7">log</mi><mi id="A7.E33.m1.1.8">λ</mi><mo id="A7.E33.m1.1.9">−</mo><mi id="A7.E33.m1.1.10">log</mi><mi id="A7.E33.m1.1.11">ϵ</mi><mo id="A7.E33.m1.1.12">+</mo><mstyle displaystyle="true" id="A7.E33.m1.1.13"><mfrac id="A7.E33.m1.1.13a"><mrow id="A7.E33.m1.1.13.2"><mi id="A7.E33.m1.1.13.2.2">λ</mi><mo lspace="0em" rspace="0em" id="A7.E33.m1.1.13.2.1">​</mo><msup id="A7.E33.m1.1.13.2.3"><mi id="A7.E33.m1.1.13.2.3.2">ϵ</mi><mn id="A7.E33.m1.1.13.2.3.3">2</mn></msup></mrow><mn id="A7.E33.m1.1.13.3">2</mn></mfrac></mstyle><mo id="A7.E33.m1.1.14">−</mo><mstyle displaystyle="true" id="A7.E33.m1.1.15"><mfrac id="A7.E33.m1.1.15a"><mn id="A7.E33.m1.1.15.2">1</mn><mn id="A7.E33.m1.1.15.3">2</mn></mfrac></mstyle><mo id="A7.E33.m1.1.16">+</mo><mstyle displaystyle="true" id="A7.E33.m1.1.17"><mfrac id="A7.E33.m1.1.17a"><mi id="A7.E33.m1.1.17.2">λ</mi><mn id="A7.E33.m1.1.17.3">2</mn></mfrac></mstyle><msup id="A7.E33.m1.1.18"><mrow id="A7.E33.m1.1.18.2"><mo stretchy="false" id="A7.E33.m1.1.18.2.1">(</mo><msub id="A7.E33.m1.1.18.2.2"><mi id="A7.E33.m1.1.18.2.2.2">𝐰</mi><mrow id="A7.E33.m1.1.18.2.2.3"><mi id="A7.E33.m1.1.18.2.2.3.2">s</mi><mo lspace="0em" rspace="0em" id="A7.E33.m1.1.18.2.2.3.1">​</mo><mi id="A7.E33.m1.1.18.2.2.3.3">i</mi></mrow></msub><mo id="A7.E33.m1.1.18.2.3">−</mo><msub id="A7.E33.m1.1.18.2.4"><mi id="A7.E33.m1.1.18.2.4.2">𝐰</mi><mi id="A7.E33.m1.1.18.2.4.3">i</mi></msub><mo stretchy="false" id="A7.E33.m1.1.18.2.5">)</mo></mrow><mn id="A7.E33.m1.1.18.3">2</mn></msup><mo lspace="0em" id="A7.E33.m1.1.19">.</mo></mrow><annotation encoding="application/x-tex" id="A7.E33.m1.1c">\displaystyle KL(\mathcal{N}(\mathbf{w}_{si},\epsilon^{2})||\mathcal{N}(\mathbf{w}_{i},1/\lambda))=-\frac{1}{2}\log\lambda-\log\epsilon+\frac{\lambda\epsilon^{2}}{2}-\frac{1}{2}+\frac{\lambda}{2}(\mathbf{w}_{si}-\mathbf{w}_{i})^{2}.</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(33)</span></td>
</tr></tbody>
</table>
<p id="A7.p2.2" class="ltx_p">The KL term for when <math id="A7.p2.2.m1.1" class="ltx_Math" alttext="\mathbf{z}_{si}=0" display="inline"><semantics id="A7.p2.2.m1.1a"><mrow id="A7.p2.2.m1.1.1" xref="A7.p2.2.m1.1.1.cmml"><msub id="A7.p2.2.m1.1.1.2" xref="A7.p2.2.m1.1.1.2.cmml"><mi id="A7.p2.2.m1.1.1.2.2" xref="A7.p2.2.m1.1.1.2.2.cmml">𝐳</mi><mrow id="A7.p2.2.m1.1.1.2.3" xref="A7.p2.2.m1.1.1.2.3.cmml"><mi id="A7.p2.2.m1.1.1.2.3.2" xref="A7.p2.2.m1.1.1.2.3.2.cmml">s</mi><mo lspace="0em" rspace="0em" id="A7.p2.2.m1.1.1.2.3.1" xref="A7.p2.2.m1.1.1.2.3.1.cmml">​</mo><mi id="A7.p2.2.m1.1.1.2.3.3" xref="A7.p2.2.m1.1.1.2.3.3.cmml">i</mi></mrow></msub><mo id="A7.p2.2.m1.1.1.1" xref="A7.p2.2.m1.1.1.1.cmml">=</mo><mn id="A7.p2.2.m1.1.1.3" xref="A7.p2.2.m1.1.1.3.cmml">0</mn></mrow><annotation-xml encoding="MathML-Content" id="A7.p2.2.m1.1b"><apply id="A7.p2.2.m1.1.1.cmml" xref="A7.p2.2.m1.1.1"><eq id="A7.p2.2.m1.1.1.1.cmml" xref="A7.p2.2.m1.1.1.1"></eq><apply id="A7.p2.2.m1.1.1.2.cmml" xref="A7.p2.2.m1.1.1.2"><csymbol cd="ambiguous" id="A7.p2.2.m1.1.1.2.1.cmml" xref="A7.p2.2.m1.1.1.2">subscript</csymbol><ci id="A7.p2.2.m1.1.1.2.2.cmml" xref="A7.p2.2.m1.1.1.2.2">𝐳</ci><apply id="A7.p2.2.m1.1.1.2.3.cmml" xref="A7.p2.2.m1.1.1.2.3"><times id="A7.p2.2.m1.1.1.2.3.1.cmml" xref="A7.p2.2.m1.1.1.2.3.1"></times><ci id="A7.p2.2.m1.1.1.2.3.2.cmml" xref="A7.p2.2.m1.1.1.2.3.2">𝑠</ci><ci id="A7.p2.2.m1.1.1.2.3.3.cmml" xref="A7.p2.2.m1.1.1.2.3.3">𝑖</ci></apply></apply><cn type="integer" id="A7.p2.2.m1.1.1.3.cmml" xref="A7.p2.2.m1.1.1.3">0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A7.p2.2.m1.1c">\mathbf{z}_{si}=0</annotation></semantics></math> can be written as</p>
<table id="A10.EGx29" class="ltx_equationgroup ltx_eqn_align ltx_eqn_table">

<tbody id="A7.E34"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math id="A7.E34.m1.2" class="ltx_math_unparsed" alttext="\displaystyle KL(\mathcal{N}(0,\epsilon^{2})||\mathcal{N}(0,1/\lambda_{2}))=-\frac{1}{2}\log\lambda_{2}-\log\epsilon+\frac{\lambda_{2}\epsilon^{2}}{2}-\frac{1}{2}." display="inline"><semantics id="A7.E34.m1.2a"><mrow id="A7.E34.m1.2b"><mi id="A7.E34.m1.2.3">K</mi><mi id="A7.E34.m1.2.4">L</mi><mrow id="A7.E34.m1.2.5"><mo stretchy="false" id="A7.E34.m1.2.5.1">(</mo><mi class="ltx_font_mathcaligraphic" id="A7.E34.m1.2.5.2">𝒩</mi><mrow id="A7.E34.m1.2.5.3"><mo stretchy="false" id="A7.E34.m1.2.5.3.1">(</mo><mn id="A7.E34.m1.1.1">0</mn><mo id="A7.E34.m1.2.5.3.2">,</mo><msup id="A7.E34.m1.2.5.3.3"><mi id="A7.E34.m1.2.5.3.3.2">ϵ</mi><mn id="A7.E34.m1.2.5.3.3.3">2</mn></msup><mo stretchy="false" id="A7.E34.m1.2.5.3.4">)</mo></mrow><mo fence="false" rspace="0.167em" stretchy="false" id="A7.E34.m1.2.5.4">|</mo><mo fence="false" rspace="0.167em" stretchy="false" id="A7.E34.m1.2.5.5">|</mo><mi class="ltx_font_mathcaligraphic" id="A7.E34.m1.2.5.6">𝒩</mi><mrow id="A7.E34.m1.2.5.7"><mo stretchy="false" id="A7.E34.m1.2.5.7.1">(</mo><mn id="A7.E34.m1.2.2">0</mn><mo id="A7.E34.m1.2.5.7.2">,</mo><mn id="A7.E34.m1.2.5.7.3">1</mn><mo id="A7.E34.m1.2.5.7.4">/</mo><msub id="A7.E34.m1.2.5.7.5"><mi id="A7.E34.m1.2.5.7.5.2">λ</mi><mn id="A7.E34.m1.2.5.7.5.3">2</mn></msub><mo stretchy="false" id="A7.E34.m1.2.5.7.6">)</mo></mrow><mo stretchy="false" id="A7.E34.m1.2.5.8">)</mo></mrow><mo rspace="0em" id="A7.E34.m1.2.6">=</mo><mo lspace="0em" id="A7.E34.m1.2.7">−</mo><mstyle displaystyle="true" id="A7.E34.m1.2.8"><mfrac id="A7.E34.m1.2.8a"><mn id="A7.E34.m1.2.8.2">1</mn><mn id="A7.E34.m1.2.8.3">2</mn></mfrac></mstyle><mi id="A7.E34.m1.2.9">log</mi><msub id="A7.E34.m1.2.10"><mi id="A7.E34.m1.2.10.2">λ</mi><mn id="A7.E34.m1.2.10.3">2</mn></msub><mo id="A7.E34.m1.2.11">−</mo><mi id="A7.E34.m1.2.12">log</mi><mi id="A7.E34.m1.2.13">ϵ</mi><mo id="A7.E34.m1.2.14">+</mo><mstyle displaystyle="true" id="A7.E34.m1.2.15"><mfrac id="A7.E34.m1.2.15a"><mrow id="A7.E34.m1.2.15.2"><msub id="A7.E34.m1.2.15.2.2"><mi id="A7.E34.m1.2.15.2.2.2">λ</mi><mn id="A7.E34.m1.2.15.2.2.3">2</mn></msub><mo lspace="0em" rspace="0em" id="A7.E34.m1.2.15.2.1">​</mo><msup id="A7.E34.m1.2.15.2.3"><mi id="A7.E34.m1.2.15.2.3.2">ϵ</mi><mn id="A7.E34.m1.2.15.2.3.3">2</mn></msup></mrow><mn id="A7.E34.m1.2.15.3">2</mn></mfrac></mstyle><mo id="A7.E34.m1.2.16">−</mo><mstyle displaystyle="true" id="A7.E34.m1.2.17"><mfrac id="A7.E34.m1.2.17a"><mn id="A7.E34.m1.2.17.2">1</mn><mn id="A7.E34.m1.2.17.3">2</mn></mfrac></mstyle><mo lspace="0em" id="A7.E34.m1.2.18">.</mo></mrow><annotation encoding="application/x-tex" id="A7.E34.m1.2c">\displaystyle KL(\mathcal{N}(0,\epsilon^{2})||\mathcal{N}(0,1/\lambda_{2}))=-\frac{1}{2}\log\lambda_{2}-\log\epsilon+\frac{\lambda_{2}\epsilon^{2}}{2}-\frac{1}{2}.</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(34)</span></td>
</tr></tbody>
</table>
<p id="A7.p2.14" class="ltx_p">Taking everything together we thus have</p>
<table id="A10.EGx30" class="ltx_equationgroup ltx_eqn_align ltx_eqn_table">

<tbody id="A7.Ex4"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math id="A7.Ex4.m1.1" class="ltx_math_unparsed" alttext="\displaystyle\mathbb{E}_{q(\mathbf{z}_{si})}[KL(q(\bm{\phi}_{si}|\mathbf{z}_{si})||p(\bm{\phi}_{si}|\mathbf{z}_{si}))]" display="inline"><semantics id="A7.Ex4.m1.1a"><mrow id="A7.Ex4.m1.1b"><msub id="A7.Ex4.m1.1.2"><mi id="A7.Ex4.m1.1.2.2">𝔼</mi><mrow id="A7.Ex4.m1.1.1.1"><mi id="A7.Ex4.m1.1.1.1.3">q</mi><mo lspace="0em" rspace="0em" id="A7.Ex4.m1.1.1.1.2">​</mo><mrow id="A7.Ex4.m1.1.1.1.1.1"><mo stretchy="false" id="A7.Ex4.m1.1.1.1.1.1.2">(</mo><msub id="A7.Ex4.m1.1.1.1.1.1.1"><mi id="A7.Ex4.m1.1.1.1.1.1.1.2">𝐳</mi><mrow id="A7.Ex4.m1.1.1.1.1.1.1.3"><mi id="A7.Ex4.m1.1.1.1.1.1.1.3.2">s</mi><mo lspace="0em" rspace="0em" id="A7.Ex4.m1.1.1.1.1.1.1.3.1">​</mo><mi id="A7.Ex4.m1.1.1.1.1.1.1.3.3">i</mi></mrow></msub><mo stretchy="false" id="A7.Ex4.m1.1.1.1.1.1.3">)</mo></mrow></mrow></msub><mrow id="A7.Ex4.m1.1.3"><mo stretchy="false" id="A7.Ex4.m1.1.3.1">[</mo><mi id="A7.Ex4.m1.1.3.2">K</mi><mi id="A7.Ex4.m1.1.3.3">L</mi><mrow id="A7.Ex4.m1.1.3.4"><mo stretchy="false" id="A7.Ex4.m1.1.3.4.1">(</mo><mi id="A7.Ex4.m1.1.3.4.2">q</mi><mrow id="A7.Ex4.m1.1.3.4.3"><mo stretchy="false" id="A7.Ex4.m1.1.3.4.3.1">(</mo><msub id="A7.Ex4.m1.1.3.4.3.2"><mi class="ltx_mathvariant_bold-italic" mathvariant="bold-italic" id="A7.Ex4.m1.1.3.4.3.2.2">ϕ</mi><mrow id="A7.Ex4.m1.1.3.4.3.2.3"><mi id="A7.Ex4.m1.1.3.4.3.2.3.2">s</mi><mo lspace="0em" rspace="0em" id="A7.Ex4.m1.1.3.4.3.2.3.1">​</mo><mi id="A7.Ex4.m1.1.3.4.3.2.3.3">i</mi></mrow></msub><mo fence="false" rspace="0.167em" stretchy="false" id="A7.Ex4.m1.1.3.4.3.3">|</mo><msub id="A7.Ex4.m1.1.3.4.3.4"><mi id="A7.Ex4.m1.1.3.4.3.4.2">𝐳</mi><mrow id="A7.Ex4.m1.1.3.4.3.4.3"><mi id="A7.Ex4.m1.1.3.4.3.4.3.2">s</mi><mo lspace="0em" rspace="0em" id="A7.Ex4.m1.1.3.4.3.4.3.1">​</mo><mi id="A7.Ex4.m1.1.3.4.3.4.3.3">i</mi></mrow></msub><mo stretchy="false" id="A7.Ex4.m1.1.3.4.3.5">)</mo></mrow><mo fence="false" rspace="0.167em" stretchy="false" id="A7.Ex4.m1.1.3.4.4">|</mo><mo fence="false" rspace="0.167em" stretchy="false" id="A7.Ex4.m1.1.3.4.5">|</mo><mi id="A7.Ex4.m1.1.3.4.6">p</mi><mrow id="A7.Ex4.m1.1.3.4.7"><mo stretchy="false" id="A7.Ex4.m1.1.3.4.7.1">(</mo><msub id="A7.Ex4.m1.1.3.4.7.2"><mi class="ltx_mathvariant_bold-italic" mathvariant="bold-italic" id="A7.Ex4.m1.1.3.4.7.2.2">ϕ</mi><mrow id="A7.Ex4.m1.1.3.4.7.2.3"><mi id="A7.Ex4.m1.1.3.4.7.2.3.2">s</mi><mo lspace="0em" rspace="0em" id="A7.Ex4.m1.1.3.4.7.2.3.1">​</mo><mi id="A7.Ex4.m1.1.3.4.7.2.3.3">i</mi></mrow></msub><mo fence="false" rspace="0.167em" stretchy="false" id="A7.Ex4.m1.1.3.4.7.3">|</mo><msub id="A7.Ex4.m1.1.3.4.7.4"><mi id="A7.Ex4.m1.1.3.4.7.4.2">𝐳</mi><mrow id="A7.Ex4.m1.1.3.4.7.4.3"><mi id="A7.Ex4.m1.1.3.4.7.4.3.2">s</mi><mo lspace="0em" rspace="0em" id="A7.Ex4.m1.1.3.4.7.4.3.1">​</mo><mi id="A7.Ex4.m1.1.3.4.7.4.3.3">i</mi></mrow></msub><mo stretchy="false" id="A7.Ex4.m1.1.3.4.7.5">)</mo></mrow><mo stretchy="false" id="A7.Ex4.m1.1.3.4.8">)</mo></mrow><mo stretchy="false" id="A7.Ex4.m1.1.3.5">]</mo></mrow></mrow><annotation encoding="application/x-tex" id="A7.Ex4.m1.1c">\displaystyle\mathbb{E}_{q(\mathbf{z}_{si})}[KL(q(\bm{\phi}_{si}|\mathbf{z}_{si})||p(\bm{\phi}_{si}|\mathbf{z}_{si}))]</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math id="A7.Ex4.m2.2" class="ltx_Math" alttext="\displaystyle=\frac{\lambda\bm{\pi}_{si}}{2}(\mathbf{w}_{si}-\mathbf{w}_{i})^{2}+\bm{\pi}_{si}(-\frac{1}{2}\log\lambda-\log\epsilon+\frac{\lambda\epsilon^{2}}{2}-\frac{1}{2})+" display="inline"><semantics id="A7.Ex4.m2.2a"><mrow id="A7.Ex4.m2.2.2" xref="A7.Ex4.m2.2.2.cmml"><mi id="A7.Ex4.m2.2.2.4" xref="A7.Ex4.m2.2.2.4.cmml"></mi><mo id="A7.Ex4.m2.2.2.3" xref="A7.Ex4.m2.2.2.3.cmml">=</mo><mrow id="A7.Ex4.m2.2.2.2" xref="A7.Ex4.m2.2.2.2.cmml"><mrow id="A7.Ex4.m2.1.1.1.1" xref="A7.Ex4.m2.1.1.1.1.cmml"><mstyle displaystyle="true" id="A7.Ex4.m2.1.1.1.1.3" xref="A7.Ex4.m2.1.1.1.1.3.cmml"><mfrac id="A7.Ex4.m2.1.1.1.1.3a" xref="A7.Ex4.m2.1.1.1.1.3.cmml"><mrow id="A7.Ex4.m2.1.1.1.1.3.2" xref="A7.Ex4.m2.1.1.1.1.3.2.cmml"><mi id="A7.Ex4.m2.1.1.1.1.3.2.2" xref="A7.Ex4.m2.1.1.1.1.3.2.2.cmml">λ</mi><mo lspace="0em" rspace="0em" id="A7.Ex4.m2.1.1.1.1.3.2.1" xref="A7.Ex4.m2.1.1.1.1.3.2.1.cmml">​</mo><msub id="A7.Ex4.m2.1.1.1.1.3.2.3" xref="A7.Ex4.m2.1.1.1.1.3.2.3.cmml"><mi id="A7.Ex4.m2.1.1.1.1.3.2.3.2" xref="A7.Ex4.m2.1.1.1.1.3.2.3.2.cmml">𝝅</mi><mrow id="A7.Ex4.m2.1.1.1.1.3.2.3.3" xref="A7.Ex4.m2.1.1.1.1.3.2.3.3.cmml"><mi id="A7.Ex4.m2.1.1.1.1.3.2.3.3.2" xref="A7.Ex4.m2.1.1.1.1.3.2.3.3.2.cmml">s</mi><mo lspace="0em" rspace="0em" id="A7.Ex4.m2.1.1.1.1.3.2.3.3.1" xref="A7.Ex4.m2.1.1.1.1.3.2.3.3.1.cmml">​</mo><mi id="A7.Ex4.m2.1.1.1.1.3.2.3.3.3" xref="A7.Ex4.m2.1.1.1.1.3.2.3.3.3.cmml">i</mi></mrow></msub></mrow><mn id="A7.Ex4.m2.1.1.1.1.3.3" xref="A7.Ex4.m2.1.1.1.1.3.3.cmml">2</mn></mfrac></mstyle><mo lspace="0em" rspace="0em" id="A7.Ex4.m2.1.1.1.1.2" xref="A7.Ex4.m2.1.1.1.1.2.cmml">​</mo><msup id="A7.Ex4.m2.1.1.1.1.1" xref="A7.Ex4.m2.1.1.1.1.1.cmml"><mrow id="A7.Ex4.m2.1.1.1.1.1.1.1" xref="A7.Ex4.m2.1.1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="A7.Ex4.m2.1.1.1.1.1.1.1.2" xref="A7.Ex4.m2.1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="A7.Ex4.m2.1.1.1.1.1.1.1.1" xref="A7.Ex4.m2.1.1.1.1.1.1.1.1.cmml"><msub id="A7.Ex4.m2.1.1.1.1.1.1.1.1.2" xref="A7.Ex4.m2.1.1.1.1.1.1.1.1.2.cmml"><mi id="A7.Ex4.m2.1.1.1.1.1.1.1.1.2.2" xref="A7.Ex4.m2.1.1.1.1.1.1.1.1.2.2.cmml">𝐰</mi><mrow id="A7.Ex4.m2.1.1.1.1.1.1.1.1.2.3" xref="A7.Ex4.m2.1.1.1.1.1.1.1.1.2.3.cmml"><mi id="A7.Ex4.m2.1.1.1.1.1.1.1.1.2.3.2" xref="A7.Ex4.m2.1.1.1.1.1.1.1.1.2.3.2.cmml">s</mi><mo lspace="0em" rspace="0em" id="A7.Ex4.m2.1.1.1.1.1.1.1.1.2.3.1" xref="A7.Ex4.m2.1.1.1.1.1.1.1.1.2.3.1.cmml">​</mo><mi id="A7.Ex4.m2.1.1.1.1.1.1.1.1.2.3.3" xref="A7.Ex4.m2.1.1.1.1.1.1.1.1.2.3.3.cmml">i</mi></mrow></msub><mo id="A7.Ex4.m2.1.1.1.1.1.1.1.1.1" xref="A7.Ex4.m2.1.1.1.1.1.1.1.1.1.cmml">−</mo><msub id="A7.Ex4.m2.1.1.1.1.1.1.1.1.3" xref="A7.Ex4.m2.1.1.1.1.1.1.1.1.3.cmml"><mi id="A7.Ex4.m2.1.1.1.1.1.1.1.1.3.2" xref="A7.Ex4.m2.1.1.1.1.1.1.1.1.3.2.cmml">𝐰</mi><mi id="A7.Ex4.m2.1.1.1.1.1.1.1.1.3.3" xref="A7.Ex4.m2.1.1.1.1.1.1.1.1.3.3.cmml">i</mi></msub></mrow><mo stretchy="false" id="A7.Ex4.m2.1.1.1.1.1.1.1.3" xref="A7.Ex4.m2.1.1.1.1.1.1.1.1.cmml">)</mo></mrow><mn id="A7.Ex4.m2.1.1.1.1.1.3" xref="A7.Ex4.m2.1.1.1.1.1.3.cmml">2</mn></msup></mrow><mo id="A7.Ex4.m2.2.2.2.3" xref="A7.Ex4.m2.2.2.2.3.cmml">+</mo><mrow id="A7.Ex4.m2.2.2.2.2" xref="A7.Ex4.m2.2.2.2.2.cmml"><mrow id="A7.Ex4.m2.2.2.2.2.1" xref="A7.Ex4.m2.2.2.2.2.1.cmml"><msub id="A7.Ex4.m2.2.2.2.2.1.3" xref="A7.Ex4.m2.2.2.2.2.1.3.cmml"><mi id="A7.Ex4.m2.2.2.2.2.1.3.2" xref="A7.Ex4.m2.2.2.2.2.1.3.2.cmml">𝝅</mi><mrow id="A7.Ex4.m2.2.2.2.2.1.3.3" xref="A7.Ex4.m2.2.2.2.2.1.3.3.cmml"><mi id="A7.Ex4.m2.2.2.2.2.1.3.3.2" xref="A7.Ex4.m2.2.2.2.2.1.3.3.2.cmml">s</mi><mo lspace="0em" rspace="0em" id="A7.Ex4.m2.2.2.2.2.1.3.3.1" xref="A7.Ex4.m2.2.2.2.2.1.3.3.1.cmml">​</mo><mi id="A7.Ex4.m2.2.2.2.2.1.3.3.3" xref="A7.Ex4.m2.2.2.2.2.1.3.3.3.cmml">i</mi></mrow></msub><mo lspace="0em" rspace="0em" id="A7.Ex4.m2.2.2.2.2.1.2" xref="A7.Ex4.m2.2.2.2.2.1.2.cmml">​</mo><mrow id="A7.Ex4.m2.2.2.2.2.1.1.1" xref="A7.Ex4.m2.2.2.2.2.1.1.1.1.cmml"><mo stretchy="false" id="A7.Ex4.m2.2.2.2.2.1.1.1.2" xref="A7.Ex4.m2.2.2.2.2.1.1.1.1.cmml">(</mo><mrow id="A7.Ex4.m2.2.2.2.2.1.1.1.1" xref="A7.Ex4.m2.2.2.2.2.1.1.1.1.cmml"><mrow id="A7.Ex4.m2.2.2.2.2.1.1.1.1.2" xref="A7.Ex4.m2.2.2.2.2.1.1.1.1.2.cmml"><mrow id="A7.Ex4.m2.2.2.2.2.1.1.1.1.2.2" xref="A7.Ex4.m2.2.2.2.2.1.1.1.1.2.2.cmml"><mrow id="A7.Ex4.m2.2.2.2.2.1.1.1.1.2.2.2" xref="A7.Ex4.m2.2.2.2.2.1.1.1.1.2.2.2.cmml"><mo id="A7.Ex4.m2.2.2.2.2.1.1.1.1.2.2.2a" xref="A7.Ex4.m2.2.2.2.2.1.1.1.1.2.2.2.cmml">−</mo><mrow id="A7.Ex4.m2.2.2.2.2.1.1.1.1.2.2.2.2" xref="A7.Ex4.m2.2.2.2.2.1.1.1.1.2.2.2.2.cmml"><mstyle displaystyle="true" id="A7.Ex4.m2.2.2.2.2.1.1.1.1.2.2.2.2.2" xref="A7.Ex4.m2.2.2.2.2.1.1.1.1.2.2.2.2.2.cmml"><mfrac id="A7.Ex4.m2.2.2.2.2.1.1.1.1.2.2.2.2.2a" xref="A7.Ex4.m2.2.2.2.2.1.1.1.1.2.2.2.2.2.cmml"><mn id="A7.Ex4.m2.2.2.2.2.1.1.1.1.2.2.2.2.2.2" xref="A7.Ex4.m2.2.2.2.2.1.1.1.1.2.2.2.2.2.2.cmml">1</mn><mn id="A7.Ex4.m2.2.2.2.2.1.1.1.1.2.2.2.2.2.3" xref="A7.Ex4.m2.2.2.2.2.1.1.1.1.2.2.2.2.2.3.cmml">2</mn></mfrac></mstyle><mo lspace="0.167em" rspace="0em" id="A7.Ex4.m2.2.2.2.2.1.1.1.1.2.2.2.2.1" xref="A7.Ex4.m2.2.2.2.2.1.1.1.1.2.2.2.2.1.cmml">​</mo><mrow id="A7.Ex4.m2.2.2.2.2.1.1.1.1.2.2.2.2.3" xref="A7.Ex4.m2.2.2.2.2.1.1.1.1.2.2.2.2.3.cmml"><mi id="A7.Ex4.m2.2.2.2.2.1.1.1.1.2.2.2.2.3.1" xref="A7.Ex4.m2.2.2.2.2.1.1.1.1.2.2.2.2.3.1.cmml">log</mi><mo lspace="0.167em" id="A7.Ex4.m2.2.2.2.2.1.1.1.1.2.2.2.2.3a" xref="A7.Ex4.m2.2.2.2.2.1.1.1.1.2.2.2.2.3.cmml">⁡</mo><mi id="A7.Ex4.m2.2.2.2.2.1.1.1.1.2.2.2.2.3.2" xref="A7.Ex4.m2.2.2.2.2.1.1.1.1.2.2.2.2.3.2.cmml">λ</mi></mrow></mrow></mrow><mo id="A7.Ex4.m2.2.2.2.2.1.1.1.1.2.2.1" xref="A7.Ex4.m2.2.2.2.2.1.1.1.1.2.2.1.cmml">−</mo><mrow id="A7.Ex4.m2.2.2.2.2.1.1.1.1.2.2.3" xref="A7.Ex4.m2.2.2.2.2.1.1.1.1.2.2.3.cmml"><mi id="A7.Ex4.m2.2.2.2.2.1.1.1.1.2.2.3.1" xref="A7.Ex4.m2.2.2.2.2.1.1.1.1.2.2.3.1.cmml">log</mi><mo lspace="0.167em" id="A7.Ex4.m2.2.2.2.2.1.1.1.1.2.2.3a" xref="A7.Ex4.m2.2.2.2.2.1.1.1.1.2.2.3.cmml">⁡</mo><mi id="A7.Ex4.m2.2.2.2.2.1.1.1.1.2.2.3.2" xref="A7.Ex4.m2.2.2.2.2.1.1.1.1.2.2.3.2.cmml">ϵ</mi></mrow></mrow><mo id="A7.Ex4.m2.2.2.2.2.1.1.1.1.2.1" xref="A7.Ex4.m2.2.2.2.2.1.1.1.1.2.1.cmml">+</mo><mstyle displaystyle="true" id="A7.Ex4.m2.2.2.2.2.1.1.1.1.2.3" xref="A7.Ex4.m2.2.2.2.2.1.1.1.1.2.3.cmml"><mfrac id="A7.Ex4.m2.2.2.2.2.1.1.1.1.2.3a" xref="A7.Ex4.m2.2.2.2.2.1.1.1.1.2.3.cmml"><mrow id="A7.Ex4.m2.2.2.2.2.1.1.1.1.2.3.2" xref="A7.Ex4.m2.2.2.2.2.1.1.1.1.2.3.2.cmml"><mi id="A7.Ex4.m2.2.2.2.2.1.1.1.1.2.3.2.2" xref="A7.Ex4.m2.2.2.2.2.1.1.1.1.2.3.2.2.cmml">λ</mi><mo lspace="0em" rspace="0em" id="A7.Ex4.m2.2.2.2.2.1.1.1.1.2.3.2.1" xref="A7.Ex4.m2.2.2.2.2.1.1.1.1.2.3.2.1.cmml">​</mo><msup id="A7.Ex4.m2.2.2.2.2.1.1.1.1.2.3.2.3" xref="A7.Ex4.m2.2.2.2.2.1.1.1.1.2.3.2.3.cmml"><mi id="A7.Ex4.m2.2.2.2.2.1.1.1.1.2.3.2.3.2" xref="A7.Ex4.m2.2.2.2.2.1.1.1.1.2.3.2.3.2.cmml">ϵ</mi><mn id="A7.Ex4.m2.2.2.2.2.1.1.1.1.2.3.2.3.3" xref="A7.Ex4.m2.2.2.2.2.1.1.1.1.2.3.2.3.3.cmml">2</mn></msup></mrow><mn id="A7.Ex4.m2.2.2.2.2.1.1.1.1.2.3.3" xref="A7.Ex4.m2.2.2.2.2.1.1.1.1.2.3.3.cmml">2</mn></mfrac></mstyle></mrow><mo id="A7.Ex4.m2.2.2.2.2.1.1.1.1.1" xref="A7.Ex4.m2.2.2.2.2.1.1.1.1.1.cmml">−</mo><mstyle displaystyle="true" id="A7.Ex4.m2.2.2.2.2.1.1.1.1.3" xref="A7.Ex4.m2.2.2.2.2.1.1.1.1.3.cmml"><mfrac id="A7.Ex4.m2.2.2.2.2.1.1.1.1.3a" xref="A7.Ex4.m2.2.2.2.2.1.1.1.1.3.cmml"><mn id="A7.Ex4.m2.2.2.2.2.1.1.1.1.3.2" xref="A7.Ex4.m2.2.2.2.2.1.1.1.1.3.2.cmml">1</mn><mn id="A7.Ex4.m2.2.2.2.2.1.1.1.1.3.3" xref="A7.Ex4.m2.2.2.2.2.1.1.1.1.3.3.cmml">2</mn></mfrac></mstyle></mrow><mo stretchy="false" id="A7.Ex4.m2.2.2.2.2.1.1.1.3" xref="A7.Ex4.m2.2.2.2.2.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="A7.Ex4.m2.2.2.2.2.3" xref="A7.Ex4.m2.2.2.2.2.3.cmml">+</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="A7.Ex4.m2.2b"><apply id="A7.Ex4.m2.2.2.cmml" xref="A7.Ex4.m2.2.2"><eq id="A7.Ex4.m2.2.2.3.cmml" xref="A7.Ex4.m2.2.2.3"></eq><csymbol cd="latexml" id="A7.Ex4.m2.2.2.4.cmml" xref="A7.Ex4.m2.2.2.4">absent</csymbol><apply id="A7.Ex4.m2.2.2.2.cmml" xref="A7.Ex4.m2.2.2.2"><plus id="A7.Ex4.m2.2.2.2.3.cmml" xref="A7.Ex4.m2.2.2.2.3"></plus><apply id="A7.Ex4.m2.1.1.1.1.cmml" xref="A7.Ex4.m2.1.1.1.1"><times id="A7.Ex4.m2.1.1.1.1.2.cmml" xref="A7.Ex4.m2.1.1.1.1.2"></times><apply id="A7.Ex4.m2.1.1.1.1.3.cmml" xref="A7.Ex4.m2.1.1.1.1.3"><divide id="A7.Ex4.m2.1.1.1.1.3.1.cmml" xref="A7.Ex4.m2.1.1.1.1.3"></divide><apply id="A7.Ex4.m2.1.1.1.1.3.2.cmml" xref="A7.Ex4.m2.1.1.1.1.3.2"><times id="A7.Ex4.m2.1.1.1.1.3.2.1.cmml" xref="A7.Ex4.m2.1.1.1.1.3.2.1"></times><ci id="A7.Ex4.m2.1.1.1.1.3.2.2.cmml" xref="A7.Ex4.m2.1.1.1.1.3.2.2">𝜆</ci><apply id="A7.Ex4.m2.1.1.1.1.3.2.3.cmml" xref="A7.Ex4.m2.1.1.1.1.3.2.3"><csymbol cd="ambiguous" id="A7.Ex4.m2.1.1.1.1.3.2.3.1.cmml" xref="A7.Ex4.m2.1.1.1.1.3.2.3">subscript</csymbol><ci id="A7.Ex4.m2.1.1.1.1.3.2.3.2.cmml" xref="A7.Ex4.m2.1.1.1.1.3.2.3.2">𝝅</ci><apply id="A7.Ex4.m2.1.1.1.1.3.2.3.3.cmml" xref="A7.Ex4.m2.1.1.1.1.3.2.3.3"><times id="A7.Ex4.m2.1.1.1.1.3.2.3.3.1.cmml" xref="A7.Ex4.m2.1.1.1.1.3.2.3.3.1"></times><ci id="A7.Ex4.m2.1.1.1.1.3.2.3.3.2.cmml" xref="A7.Ex4.m2.1.1.1.1.3.2.3.3.2">𝑠</ci><ci id="A7.Ex4.m2.1.1.1.1.3.2.3.3.3.cmml" xref="A7.Ex4.m2.1.1.1.1.3.2.3.3.3">𝑖</ci></apply></apply></apply><cn type="integer" id="A7.Ex4.m2.1.1.1.1.3.3.cmml" xref="A7.Ex4.m2.1.1.1.1.3.3">2</cn></apply><apply id="A7.Ex4.m2.1.1.1.1.1.cmml" xref="A7.Ex4.m2.1.1.1.1.1"><csymbol cd="ambiguous" id="A7.Ex4.m2.1.1.1.1.1.2.cmml" xref="A7.Ex4.m2.1.1.1.1.1">superscript</csymbol><apply id="A7.Ex4.m2.1.1.1.1.1.1.1.1.cmml" xref="A7.Ex4.m2.1.1.1.1.1.1.1"><minus id="A7.Ex4.m2.1.1.1.1.1.1.1.1.1.cmml" xref="A7.Ex4.m2.1.1.1.1.1.1.1.1.1"></minus><apply id="A7.Ex4.m2.1.1.1.1.1.1.1.1.2.cmml" xref="A7.Ex4.m2.1.1.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="A7.Ex4.m2.1.1.1.1.1.1.1.1.2.1.cmml" xref="A7.Ex4.m2.1.1.1.1.1.1.1.1.2">subscript</csymbol><ci id="A7.Ex4.m2.1.1.1.1.1.1.1.1.2.2.cmml" xref="A7.Ex4.m2.1.1.1.1.1.1.1.1.2.2">𝐰</ci><apply id="A7.Ex4.m2.1.1.1.1.1.1.1.1.2.3.cmml" xref="A7.Ex4.m2.1.1.1.1.1.1.1.1.2.3"><times id="A7.Ex4.m2.1.1.1.1.1.1.1.1.2.3.1.cmml" xref="A7.Ex4.m2.1.1.1.1.1.1.1.1.2.3.1"></times><ci id="A7.Ex4.m2.1.1.1.1.1.1.1.1.2.3.2.cmml" xref="A7.Ex4.m2.1.1.1.1.1.1.1.1.2.3.2">𝑠</ci><ci id="A7.Ex4.m2.1.1.1.1.1.1.1.1.2.3.3.cmml" xref="A7.Ex4.m2.1.1.1.1.1.1.1.1.2.3.3">𝑖</ci></apply></apply><apply id="A7.Ex4.m2.1.1.1.1.1.1.1.1.3.cmml" xref="A7.Ex4.m2.1.1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="A7.Ex4.m2.1.1.1.1.1.1.1.1.3.1.cmml" xref="A7.Ex4.m2.1.1.1.1.1.1.1.1.3">subscript</csymbol><ci id="A7.Ex4.m2.1.1.1.1.1.1.1.1.3.2.cmml" xref="A7.Ex4.m2.1.1.1.1.1.1.1.1.3.2">𝐰</ci><ci id="A7.Ex4.m2.1.1.1.1.1.1.1.1.3.3.cmml" xref="A7.Ex4.m2.1.1.1.1.1.1.1.1.3.3">𝑖</ci></apply></apply><cn type="integer" id="A7.Ex4.m2.1.1.1.1.1.3.cmml" xref="A7.Ex4.m2.1.1.1.1.1.3">2</cn></apply></apply><apply id="A7.Ex4.m2.2.2.2.2.cmml" xref="A7.Ex4.m2.2.2.2.2"><csymbol cd="latexml" id="A7.Ex4.m2.2.2.2.2.2.cmml" xref="A7.Ex4.m2.2.2.2.2">limit-from</csymbol><apply id="A7.Ex4.m2.2.2.2.2.1.cmml" xref="A7.Ex4.m2.2.2.2.2.1"><times id="A7.Ex4.m2.2.2.2.2.1.2.cmml" xref="A7.Ex4.m2.2.2.2.2.1.2"></times><apply id="A7.Ex4.m2.2.2.2.2.1.3.cmml" xref="A7.Ex4.m2.2.2.2.2.1.3"><csymbol cd="ambiguous" id="A7.Ex4.m2.2.2.2.2.1.3.1.cmml" xref="A7.Ex4.m2.2.2.2.2.1.3">subscript</csymbol><ci id="A7.Ex4.m2.2.2.2.2.1.3.2.cmml" xref="A7.Ex4.m2.2.2.2.2.1.3.2">𝝅</ci><apply id="A7.Ex4.m2.2.2.2.2.1.3.3.cmml" xref="A7.Ex4.m2.2.2.2.2.1.3.3"><times id="A7.Ex4.m2.2.2.2.2.1.3.3.1.cmml" xref="A7.Ex4.m2.2.2.2.2.1.3.3.1"></times><ci id="A7.Ex4.m2.2.2.2.2.1.3.3.2.cmml" xref="A7.Ex4.m2.2.2.2.2.1.3.3.2">𝑠</ci><ci id="A7.Ex4.m2.2.2.2.2.1.3.3.3.cmml" xref="A7.Ex4.m2.2.2.2.2.1.3.3.3">𝑖</ci></apply></apply><apply id="A7.Ex4.m2.2.2.2.2.1.1.1.1.cmml" xref="A7.Ex4.m2.2.2.2.2.1.1.1"><minus id="A7.Ex4.m2.2.2.2.2.1.1.1.1.1.cmml" xref="A7.Ex4.m2.2.2.2.2.1.1.1.1.1"></minus><apply id="A7.Ex4.m2.2.2.2.2.1.1.1.1.2.cmml" xref="A7.Ex4.m2.2.2.2.2.1.1.1.1.2"><plus id="A7.Ex4.m2.2.2.2.2.1.1.1.1.2.1.cmml" xref="A7.Ex4.m2.2.2.2.2.1.1.1.1.2.1"></plus><apply id="A7.Ex4.m2.2.2.2.2.1.1.1.1.2.2.cmml" xref="A7.Ex4.m2.2.2.2.2.1.1.1.1.2.2"><minus id="A7.Ex4.m2.2.2.2.2.1.1.1.1.2.2.1.cmml" xref="A7.Ex4.m2.2.2.2.2.1.1.1.1.2.2.1"></minus><apply id="A7.Ex4.m2.2.2.2.2.1.1.1.1.2.2.2.cmml" xref="A7.Ex4.m2.2.2.2.2.1.1.1.1.2.2.2"><minus id="A7.Ex4.m2.2.2.2.2.1.1.1.1.2.2.2.1.cmml" xref="A7.Ex4.m2.2.2.2.2.1.1.1.1.2.2.2"></minus><apply id="A7.Ex4.m2.2.2.2.2.1.1.1.1.2.2.2.2.cmml" xref="A7.Ex4.m2.2.2.2.2.1.1.1.1.2.2.2.2"><times id="A7.Ex4.m2.2.2.2.2.1.1.1.1.2.2.2.2.1.cmml" xref="A7.Ex4.m2.2.2.2.2.1.1.1.1.2.2.2.2.1"></times><apply id="A7.Ex4.m2.2.2.2.2.1.1.1.1.2.2.2.2.2.cmml" xref="A7.Ex4.m2.2.2.2.2.1.1.1.1.2.2.2.2.2"><divide id="A7.Ex4.m2.2.2.2.2.1.1.1.1.2.2.2.2.2.1.cmml" xref="A7.Ex4.m2.2.2.2.2.1.1.1.1.2.2.2.2.2"></divide><cn type="integer" id="A7.Ex4.m2.2.2.2.2.1.1.1.1.2.2.2.2.2.2.cmml" xref="A7.Ex4.m2.2.2.2.2.1.1.1.1.2.2.2.2.2.2">1</cn><cn type="integer" id="A7.Ex4.m2.2.2.2.2.1.1.1.1.2.2.2.2.2.3.cmml" xref="A7.Ex4.m2.2.2.2.2.1.1.1.1.2.2.2.2.2.3">2</cn></apply><apply id="A7.Ex4.m2.2.2.2.2.1.1.1.1.2.2.2.2.3.cmml" xref="A7.Ex4.m2.2.2.2.2.1.1.1.1.2.2.2.2.3"><log id="A7.Ex4.m2.2.2.2.2.1.1.1.1.2.2.2.2.3.1.cmml" xref="A7.Ex4.m2.2.2.2.2.1.1.1.1.2.2.2.2.3.1"></log><ci id="A7.Ex4.m2.2.2.2.2.1.1.1.1.2.2.2.2.3.2.cmml" xref="A7.Ex4.m2.2.2.2.2.1.1.1.1.2.2.2.2.3.2">𝜆</ci></apply></apply></apply><apply id="A7.Ex4.m2.2.2.2.2.1.1.1.1.2.2.3.cmml" xref="A7.Ex4.m2.2.2.2.2.1.1.1.1.2.2.3"><log id="A7.Ex4.m2.2.2.2.2.1.1.1.1.2.2.3.1.cmml" xref="A7.Ex4.m2.2.2.2.2.1.1.1.1.2.2.3.1"></log><ci id="A7.Ex4.m2.2.2.2.2.1.1.1.1.2.2.3.2.cmml" xref="A7.Ex4.m2.2.2.2.2.1.1.1.1.2.2.3.2">italic-ϵ</ci></apply></apply><apply id="A7.Ex4.m2.2.2.2.2.1.1.1.1.2.3.cmml" xref="A7.Ex4.m2.2.2.2.2.1.1.1.1.2.3"><divide id="A7.Ex4.m2.2.2.2.2.1.1.1.1.2.3.1.cmml" xref="A7.Ex4.m2.2.2.2.2.1.1.1.1.2.3"></divide><apply id="A7.Ex4.m2.2.2.2.2.1.1.1.1.2.3.2.cmml" xref="A7.Ex4.m2.2.2.2.2.1.1.1.1.2.3.2"><times id="A7.Ex4.m2.2.2.2.2.1.1.1.1.2.3.2.1.cmml" xref="A7.Ex4.m2.2.2.2.2.1.1.1.1.2.3.2.1"></times><ci id="A7.Ex4.m2.2.2.2.2.1.1.1.1.2.3.2.2.cmml" xref="A7.Ex4.m2.2.2.2.2.1.1.1.1.2.3.2.2">𝜆</ci><apply id="A7.Ex4.m2.2.2.2.2.1.1.1.1.2.3.2.3.cmml" xref="A7.Ex4.m2.2.2.2.2.1.1.1.1.2.3.2.3"><csymbol cd="ambiguous" id="A7.Ex4.m2.2.2.2.2.1.1.1.1.2.3.2.3.1.cmml" xref="A7.Ex4.m2.2.2.2.2.1.1.1.1.2.3.2.3">superscript</csymbol><ci id="A7.Ex4.m2.2.2.2.2.1.1.1.1.2.3.2.3.2.cmml" xref="A7.Ex4.m2.2.2.2.2.1.1.1.1.2.3.2.3.2">italic-ϵ</ci><cn type="integer" id="A7.Ex4.m2.2.2.2.2.1.1.1.1.2.3.2.3.3.cmml" xref="A7.Ex4.m2.2.2.2.2.1.1.1.1.2.3.2.3.3">2</cn></apply></apply><cn type="integer" id="A7.Ex4.m2.2.2.2.2.1.1.1.1.2.3.3.cmml" xref="A7.Ex4.m2.2.2.2.2.1.1.1.1.2.3.3">2</cn></apply></apply><apply id="A7.Ex4.m2.2.2.2.2.1.1.1.1.3.cmml" xref="A7.Ex4.m2.2.2.2.2.1.1.1.1.3"><divide id="A7.Ex4.m2.2.2.2.2.1.1.1.1.3.1.cmml" xref="A7.Ex4.m2.2.2.2.2.1.1.1.1.3"></divide><cn type="integer" id="A7.Ex4.m2.2.2.2.2.1.1.1.1.3.2.cmml" xref="A7.Ex4.m2.2.2.2.2.1.1.1.1.3.2">1</cn><cn type="integer" id="A7.Ex4.m2.2.2.2.2.1.1.1.1.3.3.cmml" xref="A7.Ex4.m2.2.2.2.2.1.1.1.1.3.3">2</cn></apply></apply></apply><plus id="A7.Ex4.m2.2.2.2.2.3.cmml" xref="A7.Ex4.m2.2.2.2.2.3"></plus></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A7.Ex4.m2.2c">\displaystyle=\frac{\lambda\bm{\pi}_{si}}{2}(\mathbf{w}_{si}-\mathbf{w}_{i})^{2}+\bm{\pi}_{si}(-\frac{1}{2}\log\lambda-\log\epsilon+\frac{\lambda\epsilon^{2}}{2}-\frac{1}{2})+</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
<tbody id="A7.E35"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_eqn_cell"></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math id="A7.E35.m1.2" class="ltx_Math" alttext="\displaystyle\qquad(1-\bm{\pi}_{si})(-\frac{1}{2}\log\lambda_{2}-\log\epsilon+\frac{\lambda_{2}\epsilon^{2}}{2}-\frac{1}{2})" display="inline"><semantics id="A7.E35.m1.2a"><mrow id="A7.E35.m1.2.2" xref="A7.E35.m1.2.2.cmml"><mrow id="A7.E35.m1.1.1.1.1" xref="A7.E35.m1.1.1.1.1.1.cmml"><mo stretchy="false" id="A7.E35.m1.1.1.1.1.2" xref="A7.E35.m1.1.1.1.1.1.cmml">(</mo><mrow id="A7.E35.m1.1.1.1.1.1" xref="A7.E35.m1.1.1.1.1.1.cmml"><mn id="A7.E35.m1.1.1.1.1.1.2" xref="A7.E35.m1.1.1.1.1.1.2.cmml">1</mn><mo id="A7.E35.m1.1.1.1.1.1.1" xref="A7.E35.m1.1.1.1.1.1.1.cmml">−</mo><msub id="A7.E35.m1.1.1.1.1.1.3" xref="A7.E35.m1.1.1.1.1.1.3.cmml"><mi id="A7.E35.m1.1.1.1.1.1.3.2" xref="A7.E35.m1.1.1.1.1.1.3.2.cmml">𝝅</mi><mrow id="A7.E35.m1.1.1.1.1.1.3.3" xref="A7.E35.m1.1.1.1.1.1.3.3.cmml"><mi id="A7.E35.m1.1.1.1.1.1.3.3.2" xref="A7.E35.m1.1.1.1.1.1.3.3.2.cmml">s</mi><mo lspace="0em" rspace="0em" id="A7.E35.m1.1.1.1.1.1.3.3.1" xref="A7.E35.m1.1.1.1.1.1.3.3.1.cmml">​</mo><mi id="A7.E35.m1.1.1.1.1.1.3.3.3" xref="A7.E35.m1.1.1.1.1.1.3.3.3.cmml">i</mi></mrow></msub></mrow><mo stretchy="false" id="A7.E35.m1.1.1.1.1.3" xref="A7.E35.m1.1.1.1.1.1.cmml">)</mo></mrow><mo lspace="0em" rspace="0em" id="A7.E35.m1.2.2.3" xref="A7.E35.m1.2.2.3.cmml">​</mo><mrow id="A7.E35.m1.2.2.2.1" xref="A7.E35.m1.2.2.2.1.1.cmml"><mo stretchy="false" id="A7.E35.m1.2.2.2.1.2" xref="A7.E35.m1.2.2.2.1.1.cmml">(</mo><mrow id="A7.E35.m1.2.2.2.1.1" xref="A7.E35.m1.2.2.2.1.1.cmml"><mrow id="A7.E35.m1.2.2.2.1.1.2" xref="A7.E35.m1.2.2.2.1.1.2.cmml"><mrow id="A7.E35.m1.2.2.2.1.1.2.2" xref="A7.E35.m1.2.2.2.1.1.2.2.cmml"><mrow id="A7.E35.m1.2.2.2.1.1.2.2.2" xref="A7.E35.m1.2.2.2.1.1.2.2.2.cmml"><mo id="A7.E35.m1.2.2.2.1.1.2.2.2a" xref="A7.E35.m1.2.2.2.1.1.2.2.2.cmml">−</mo><mrow id="A7.E35.m1.2.2.2.1.1.2.2.2.2" xref="A7.E35.m1.2.2.2.1.1.2.2.2.2.cmml"><mstyle displaystyle="true" id="A7.E35.m1.2.2.2.1.1.2.2.2.2.2" xref="A7.E35.m1.2.2.2.1.1.2.2.2.2.2.cmml"><mfrac id="A7.E35.m1.2.2.2.1.1.2.2.2.2.2a" xref="A7.E35.m1.2.2.2.1.1.2.2.2.2.2.cmml"><mn id="A7.E35.m1.2.2.2.1.1.2.2.2.2.2.2" xref="A7.E35.m1.2.2.2.1.1.2.2.2.2.2.2.cmml">1</mn><mn id="A7.E35.m1.2.2.2.1.1.2.2.2.2.2.3" xref="A7.E35.m1.2.2.2.1.1.2.2.2.2.2.3.cmml">2</mn></mfrac></mstyle><mo lspace="0.167em" rspace="0em" id="A7.E35.m1.2.2.2.1.1.2.2.2.2.1" xref="A7.E35.m1.2.2.2.1.1.2.2.2.2.1.cmml">​</mo><mrow id="A7.E35.m1.2.2.2.1.1.2.2.2.2.3" xref="A7.E35.m1.2.2.2.1.1.2.2.2.2.3.cmml"><mi id="A7.E35.m1.2.2.2.1.1.2.2.2.2.3.1" xref="A7.E35.m1.2.2.2.1.1.2.2.2.2.3.1.cmml">log</mi><mo lspace="0.167em" id="A7.E35.m1.2.2.2.1.1.2.2.2.2.3a" xref="A7.E35.m1.2.2.2.1.1.2.2.2.2.3.cmml">⁡</mo><msub id="A7.E35.m1.2.2.2.1.1.2.2.2.2.3.2" xref="A7.E35.m1.2.2.2.1.1.2.2.2.2.3.2.cmml"><mi id="A7.E35.m1.2.2.2.1.1.2.2.2.2.3.2.2" xref="A7.E35.m1.2.2.2.1.1.2.2.2.2.3.2.2.cmml">λ</mi><mn id="A7.E35.m1.2.2.2.1.1.2.2.2.2.3.2.3" xref="A7.E35.m1.2.2.2.1.1.2.2.2.2.3.2.3.cmml">2</mn></msub></mrow></mrow></mrow><mo id="A7.E35.m1.2.2.2.1.1.2.2.1" xref="A7.E35.m1.2.2.2.1.1.2.2.1.cmml">−</mo><mrow id="A7.E35.m1.2.2.2.1.1.2.2.3" xref="A7.E35.m1.2.2.2.1.1.2.2.3.cmml"><mi id="A7.E35.m1.2.2.2.1.1.2.2.3.1" xref="A7.E35.m1.2.2.2.1.1.2.2.3.1.cmml">log</mi><mo lspace="0.167em" id="A7.E35.m1.2.2.2.1.1.2.2.3a" xref="A7.E35.m1.2.2.2.1.1.2.2.3.cmml">⁡</mo><mi id="A7.E35.m1.2.2.2.1.1.2.2.3.2" xref="A7.E35.m1.2.2.2.1.1.2.2.3.2.cmml">ϵ</mi></mrow></mrow><mo id="A7.E35.m1.2.2.2.1.1.2.1" xref="A7.E35.m1.2.2.2.1.1.2.1.cmml">+</mo><mstyle displaystyle="true" id="A7.E35.m1.2.2.2.1.1.2.3" xref="A7.E35.m1.2.2.2.1.1.2.3.cmml"><mfrac id="A7.E35.m1.2.2.2.1.1.2.3a" xref="A7.E35.m1.2.2.2.1.1.2.3.cmml"><mrow id="A7.E35.m1.2.2.2.1.1.2.3.2" xref="A7.E35.m1.2.2.2.1.1.2.3.2.cmml"><msub id="A7.E35.m1.2.2.2.1.1.2.3.2.2" xref="A7.E35.m1.2.2.2.1.1.2.3.2.2.cmml"><mi id="A7.E35.m1.2.2.2.1.1.2.3.2.2.2" xref="A7.E35.m1.2.2.2.1.1.2.3.2.2.2.cmml">λ</mi><mn id="A7.E35.m1.2.2.2.1.1.2.3.2.2.3" xref="A7.E35.m1.2.2.2.1.1.2.3.2.2.3.cmml">2</mn></msub><mo lspace="0em" rspace="0em" id="A7.E35.m1.2.2.2.1.1.2.3.2.1" xref="A7.E35.m1.2.2.2.1.1.2.3.2.1.cmml">​</mo><msup id="A7.E35.m1.2.2.2.1.1.2.3.2.3" xref="A7.E35.m1.2.2.2.1.1.2.3.2.3.cmml"><mi id="A7.E35.m1.2.2.2.1.1.2.3.2.3.2" xref="A7.E35.m1.2.2.2.1.1.2.3.2.3.2.cmml">ϵ</mi><mn id="A7.E35.m1.2.2.2.1.1.2.3.2.3.3" xref="A7.E35.m1.2.2.2.1.1.2.3.2.3.3.cmml">2</mn></msup></mrow><mn id="A7.E35.m1.2.2.2.1.1.2.3.3" xref="A7.E35.m1.2.2.2.1.1.2.3.3.cmml">2</mn></mfrac></mstyle></mrow><mo id="A7.E35.m1.2.2.2.1.1.1" xref="A7.E35.m1.2.2.2.1.1.1.cmml">−</mo><mstyle displaystyle="true" id="A7.E35.m1.2.2.2.1.1.3" xref="A7.E35.m1.2.2.2.1.1.3.cmml"><mfrac id="A7.E35.m1.2.2.2.1.1.3a" xref="A7.E35.m1.2.2.2.1.1.3.cmml"><mn id="A7.E35.m1.2.2.2.1.1.3.2" xref="A7.E35.m1.2.2.2.1.1.3.2.cmml">1</mn><mn id="A7.E35.m1.2.2.2.1.1.3.3" xref="A7.E35.m1.2.2.2.1.1.3.3.cmml">2</mn></mfrac></mstyle></mrow><mo stretchy="false" id="A7.E35.m1.2.2.2.1.3" xref="A7.E35.m1.2.2.2.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="A7.E35.m1.2b"><apply id="A7.E35.m1.2.2.cmml" xref="A7.E35.m1.2.2"><times id="A7.E35.m1.2.2.3.cmml" xref="A7.E35.m1.2.2.3"></times><apply id="A7.E35.m1.1.1.1.1.1.cmml" xref="A7.E35.m1.1.1.1.1"><minus id="A7.E35.m1.1.1.1.1.1.1.cmml" xref="A7.E35.m1.1.1.1.1.1.1"></minus><cn type="integer" id="A7.E35.m1.1.1.1.1.1.2.cmml" xref="A7.E35.m1.1.1.1.1.1.2">1</cn><apply id="A7.E35.m1.1.1.1.1.1.3.cmml" xref="A7.E35.m1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="A7.E35.m1.1.1.1.1.1.3.1.cmml" xref="A7.E35.m1.1.1.1.1.1.3">subscript</csymbol><ci id="A7.E35.m1.1.1.1.1.1.3.2.cmml" xref="A7.E35.m1.1.1.1.1.1.3.2">𝝅</ci><apply id="A7.E35.m1.1.1.1.1.1.3.3.cmml" xref="A7.E35.m1.1.1.1.1.1.3.3"><times id="A7.E35.m1.1.1.1.1.1.3.3.1.cmml" xref="A7.E35.m1.1.1.1.1.1.3.3.1"></times><ci id="A7.E35.m1.1.1.1.1.1.3.3.2.cmml" xref="A7.E35.m1.1.1.1.1.1.3.3.2">𝑠</ci><ci id="A7.E35.m1.1.1.1.1.1.3.3.3.cmml" xref="A7.E35.m1.1.1.1.1.1.3.3.3">𝑖</ci></apply></apply></apply><apply id="A7.E35.m1.2.2.2.1.1.cmml" xref="A7.E35.m1.2.2.2.1"><minus id="A7.E35.m1.2.2.2.1.1.1.cmml" xref="A7.E35.m1.2.2.2.1.1.1"></minus><apply id="A7.E35.m1.2.2.2.1.1.2.cmml" xref="A7.E35.m1.2.2.2.1.1.2"><plus id="A7.E35.m1.2.2.2.1.1.2.1.cmml" xref="A7.E35.m1.2.2.2.1.1.2.1"></plus><apply id="A7.E35.m1.2.2.2.1.1.2.2.cmml" xref="A7.E35.m1.2.2.2.1.1.2.2"><minus id="A7.E35.m1.2.2.2.1.1.2.2.1.cmml" xref="A7.E35.m1.2.2.2.1.1.2.2.1"></minus><apply id="A7.E35.m1.2.2.2.1.1.2.2.2.cmml" xref="A7.E35.m1.2.2.2.1.1.2.2.2"><minus id="A7.E35.m1.2.2.2.1.1.2.2.2.1.cmml" xref="A7.E35.m1.2.2.2.1.1.2.2.2"></minus><apply id="A7.E35.m1.2.2.2.1.1.2.2.2.2.cmml" xref="A7.E35.m1.2.2.2.1.1.2.2.2.2"><times id="A7.E35.m1.2.2.2.1.1.2.2.2.2.1.cmml" xref="A7.E35.m1.2.2.2.1.1.2.2.2.2.1"></times><apply id="A7.E35.m1.2.2.2.1.1.2.2.2.2.2.cmml" xref="A7.E35.m1.2.2.2.1.1.2.2.2.2.2"><divide id="A7.E35.m1.2.2.2.1.1.2.2.2.2.2.1.cmml" xref="A7.E35.m1.2.2.2.1.1.2.2.2.2.2"></divide><cn type="integer" id="A7.E35.m1.2.2.2.1.1.2.2.2.2.2.2.cmml" xref="A7.E35.m1.2.2.2.1.1.2.2.2.2.2.2">1</cn><cn type="integer" id="A7.E35.m1.2.2.2.1.1.2.2.2.2.2.3.cmml" xref="A7.E35.m1.2.2.2.1.1.2.2.2.2.2.3">2</cn></apply><apply id="A7.E35.m1.2.2.2.1.1.2.2.2.2.3.cmml" xref="A7.E35.m1.2.2.2.1.1.2.2.2.2.3"><log id="A7.E35.m1.2.2.2.1.1.2.2.2.2.3.1.cmml" xref="A7.E35.m1.2.2.2.1.1.2.2.2.2.3.1"></log><apply id="A7.E35.m1.2.2.2.1.1.2.2.2.2.3.2.cmml" xref="A7.E35.m1.2.2.2.1.1.2.2.2.2.3.2"><csymbol cd="ambiguous" id="A7.E35.m1.2.2.2.1.1.2.2.2.2.3.2.1.cmml" xref="A7.E35.m1.2.2.2.1.1.2.2.2.2.3.2">subscript</csymbol><ci id="A7.E35.m1.2.2.2.1.1.2.2.2.2.3.2.2.cmml" xref="A7.E35.m1.2.2.2.1.1.2.2.2.2.3.2.2">𝜆</ci><cn type="integer" id="A7.E35.m1.2.2.2.1.1.2.2.2.2.3.2.3.cmml" xref="A7.E35.m1.2.2.2.1.1.2.2.2.2.3.2.3">2</cn></apply></apply></apply></apply><apply id="A7.E35.m1.2.2.2.1.1.2.2.3.cmml" xref="A7.E35.m1.2.2.2.1.1.2.2.3"><log id="A7.E35.m1.2.2.2.1.1.2.2.3.1.cmml" xref="A7.E35.m1.2.2.2.1.1.2.2.3.1"></log><ci id="A7.E35.m1.2.2.2.1.1.2.2.3.2.cmml" xref="A7.E35.m1.2.2.2.1.1.2.2.3.2">italic-ϵ</ci></apply></apply><apply id="A7.E35.m1.2.2.2.1.1.2.3.cmml" xref="A7.E35.m1.2.2.2.1.1.2.3"><divide id="A7.E35.m1.2.2.2.1.1.2.3.1.cmml" xref="A7.E35.m1.2.2.2.1.1.2.3"></divide><apply id="A7.E35.m1.2.2.2.1.1.2.3.2.cmml" xref="A7.E35.m1.2.2.2.1.1.2.3.2"><times id="A7.E35.m1.2.2.2.1.1.2.3.2.1.cmml" xref="A7.E35.m1.2.2.2.1.1.2.3.2.1"></times><apply id="A7.E35.m1.2.2.2.1.1.2.3.2.2.cmml" xref="A7.E35.m1.2.2.2.1.1.2.3.2.2"><csymbol cd="ambiguous" id="A7.E35.m1.2.2.2.1.1.2.3.2.2.1.cmml" xref="A7.E35.m1.2.2.2.1.1.2.3.2.2">subscript</csymbol><ci id="A7.E35.m1.2.2.2.1.1.2.3.2.2.2.cmml" xref="A7.E35.m1.2.2.2.1.1.2.3.2.2.2">𝜆</ci><cn type="integer" id="A7.E35.m1.2.2.2.1.1.2.3.2.2.3.cmml" xref="A7.E35.m1.2.2.2.1.1.2.3.2.2.3">2</cn></apply><apply id="A7.E35.m1.2.2.2.1.1.2.3.2.3.cmml" xref="A7.E35.m1.2.2.2.1.1.2.3.2.3"><csymbol cd="ambiguous" id="A7.E35.m1.2.2.2.1.1.2.3.2.3.1.cmml" xref="A7.E35.m1.2.2.2.1.1.2.3.2.3">superscript</csymbol><ci id="A7.E35.m1.2.2.2.1.1.2.3.2.3.2.cmml" xref="A7.E35.m1.2.2.2.1.1.2.3.2.3.2">italic-ϵ</ci><cn type="integer" id="A7.E35.m1.2.2.2.1.1.2.3.2.3.3.cmml" xref="A7.E35.m1.2.2.2.1.1.2.3.2.3.3">2</cn></apply></apply><cn type="integer" id="A7.E35.m1.2.2.2.1.1.2.3.3.cmml" xref="A7.E35.m1.2.2.2.1.1.2.3.3">2</cn></apply></apply><apply id="A7.E35.m1.2.2.2.1.1.3.cmml" xref="A7.E35.m1.2.2.2.1.1.3"><divide id="A7.E35.m1.2.2.2.1.1.3.1.cmml" xref="A7.E35.m1.2.2.2.1.1.3"></divide><cn type="integer" id="A7.E35.m1.2.2.2.1.1.3.2.cmml" xref="A7.E35.m1.2.2.2.1.1.3.2">1</cn><cn type="integer" id="A7.E35.m1.2.2.2.1.1.3.3.cmml" xref="A7.E35.m1.2.2.2.1.1.3.3">2</cn></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A7.E35.m1.2c">\displaystyle\qquad(1-\bm{\pi}_{si})(-\frac{1}{2}\log\lambda_{2}-\log\epsilon+\frac{\lambda_{2}\epsilon^{2}}{2}-\frac{1}{2})</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(35)</span></td>
</tr></tbody>
<tbody id="A7.E36"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_eqn_cell"></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math id="A7.E36.m1.2" class="ltx_Math" alttext="\displaystyle=\frac{\lambda\bm{\pi}_{si}}{2}(\mathbf{w}_{si}-\mathbf{w}_{i})^{2}+\bm{\pi}_{si}\left(\frac{1}{2}\log\frac{\lambda_{2}}{\lambda}+\frac{\epsilon^{2}}{2}(\lambda-\lambda_{2})\right)+C" display="inline"><semantics id="A7.E36.m1.2a"><mrow id="A7.E36.m1.2.2" xref="A7.E36.m1.2.2.cmml"><mi id="A7.E36.m1.2.2.4" xref="A7.E36.m1.2.2.4.cmml"></mi><mo id="A7.E36.m1.2.2.3" xref="A7.E36.m1.2.2.3.cmml">=</mo><mrow id="A7.E36.m1.2.2.2" xref="A7.E36.m1.2.2.2.cmml"><mrow id="A7.E36.m1.1.1.1.1" xref="A7.E36.m1.1.1.1.1.cmml"><mstyle displaystyle="true" id="A7.E36.m1.1.1.1.1.3" xref="A7.E36.m1.1.1.1.1.3.cmml"><mfrac id="A7.E36.m1.1.1.1.1.3a" xref="A7.E36.m1.1.1.1.1.3.cmml"><mrow id="A7.E36.m1.1.1.1.1.3.2" xref="A7.E36.m1.1.1.1.1.3.2.cmml"><mi id="A7.E36.m1.1.1.1.1.3.2.2" xref="A7.E36.m1.1.1.1.1.3.2.2.cmml">λ</mi><mo lspace="0em" rspace="0em" id="A7.E36.m1.1.1.1.1.3.2.1" xref="A7.E36.m1.1.1.1.1.3.2.1.cmml">​</mo><msub id="A7.E36.m1.1.1.1.1.3.2.3" xref="A7.E36.m1.1.1.1.1.3.2.3.cmml"><mi id="A7.E36.m1.1.1.1.1.3.2.3.2" xref="A7.E36.m1.1.1.1.1.3.2.3.2.cmml">𝝅</mi><mrow id="A7.E36.m1.1.1.1.1.3.2.3.3" xref="A7.E36.m1.1.1.1.1.3.2.3.3.cmml"><mi id="A7.E36.m1.1.1.1.1.3.2.3.3.2" xref="A7.E36.m1.1.1.1.1.3.2.3.3.2.cmml">s</mi><mo lspace="0em" rspace="0em" id="A7.E36.m1.1.1.1.1.3.2.3.3.1" xref="A7.E36.m1.1.1.1.1.3.2.3.3.1.cmml">​</mo><mi id="A7.E36.m1.1.1.1.1.3.2.3.3.3" xref="A7.E36.m1.1.1.1.1.3.2.3.3.3.cmml">i</mi></mrow></msub></mrow><mn id="A7.E36.m1.1.1.1.1.3.3" xref="A7.E36.m1.1.1.1.1.3.3.cmml">2</mn></mfrac></mstyle><mo lspace="0em" rspace="0em" id="A7.E36.m1.1.1.1.1.2" xref="A7.E36.m1.1.1.1.1.2.cmml">​</mo><msup id="A7.E36.m1.1.1.1.1.1" xref="A7.E36.m1.1.1.1.1.1.cmml"><mrow id="A7.E36.m1.1.1.1.1.1.1.1" xref="A7.E36.m1.1.1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="A7.E36.m1.1.1.1.1.1.1.1.2" xref="A7.E36.m1.1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="A7.E36.m1.1.1.1.1.1.1.1.1" xref="A7.E36.m1.1.1.1.1.1.1.1.1.cmml"><msub id="A7.E36.m1.1.1.1.1.1.1.1.1.2" xref="A7.E36.m1.1.1.1.1.1.1.1.1.2.cmml"><mi id="A7.E36.m1.1.1.1.1.1.1.1.1.2.2" xref="A7.E36.m1.1.1.1.1.1.1.1.1.2.2.cmml">𝐰</mi><mrow id="A7.E36.m1.1.1.1.1.1.1.1.1.2.3" xref="A7.E36.m1.1.1.1.1.1.1.1.1.2.3.cmml"><mi id="A7.E36.m1.1.1.1.1.1.1.1.1.2.3.2" xref="A7.E36.m1.1.1.1.1.1.1.1.1.2.3.2.cmml">s</mi><mo lspace="0em" rspace="0em" id="A7.E36.m1.1.1.1.1.1.1.1.1.2.3.1" xref="A7.E36.m1.1.1.1.1.1.1.1.1.2.3.1.cmml">​</mo><mi id="A7.E36.m1.1.1.1.1.1.1.1.1.2.3.3" xref="A7.E36.m1.1.1.1.1.1.1.1.1.2.3.3.cmml">i</mi></mrow></msub><mo id="A7.E36.m1.1.1.1.1.1.1.1.1.1" xref="A7.E36.m1.1.1.1.1.1.1.1.1.1.cmml">−</mo><msub id="A7.E36.m1.1.1.1.1.1.1.1.1.3" xref="A7.E36.m1.1.1.1.1.1.1.1.1.3.cmml"><mi id="A7.E36.m1.1.1.1.1.1.1.1.1.3.2" xref="A7.E36.m1.1.1.1.1.1.1.1.1.3.2.cmml">𝐰</mi><mi id="A7.E36.m1.1.1.1.1.1.1.1.1.3.3" xref="A7.E36.m1.1.1.1.1.1.1.1.1.3.3.cmml">i</mi></msub></mrow><mo stretchy="false" id="A7.E36.m1.1.1.1.1.1.1.1.3" xref="A7.E36.m1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow><mn id="A7.E36.m1.1.1.1.1.1.3" xref="A7.E36.m1.1.1.1.1.1.3.cmml">2</mn></msup></mrow><mo id="A7.E36.m1.2.2.2.3" xref="A7.E36.m1.2.2.2.3.cmml">+</mo><mrow id="A7.E36.m1.2.2.2.2" xref="A7.E36.m1.2.2.2.2.cmml"><msub id="A7.E36.m1.2.2.2.2.3" xref="A7.E36.m1.2.2.2.2.3.cmml"><mi id="A7.E36.m1.2.2.2.2.3.2" xref="A7.E36.m1.2.2.2.2.3.2.cmml">𝝅</mi><mrow id="A7.E36.m1.2.2.2.2.3.3" xref="A7.E36.m1.2.2.2.2.3.3.cmml"><mi id="A7.E36.m1.2.2.2.2.3.3.2" xref="A7.E36.m1.2.2.2.2.3.3.2.cmml">s</mi><mo lspace="0em" rspace="0em" id="A7.E36.m1.2.2.2.2.3.3.1" xref="A7.E36.m1.2.2.2.2.3.3.1.cmml">​</mo><mi id="A7.E36.m1.2.2.2.2.3.3.3" xref="A7.E36.m1.2.2.2.2.3.3.3.cmml">i</mi></mrow></msub><mo lspace="0em" rspace="0em" id="A7.E36.m1.2.2.2.2.2" xref="A7.E36.m1.2.2.2.2.2.cmml">​</mo><mrow id="A7.E36.m1.2.2.2.2.1.1" xref="A7.E36.m1.2.2.2.2.1.1.1.cmml"><mo id="A7.E36.m1.2.2.2.2.1.1.2" xref="A7.E36.m1.2.2.2.2.1.1.1.cmml">(</mo><mrow id="A7.E36.m1.2.2.2.2.1.1.1" xref="A7.E36.m1.2.2.2.2.1.1.1.cmml"><mrow id="A7.E36.m1.2.2.2.2.1.1.1.3" xref="A7.E36.m1.2.2.2.2.1.1.1.3.cmml"><mstyle displaystyle="true" id="A7.E36.m1.2.2.2.2.1.1.1.3.2" xref="A7.E36.m1.2.2.2.2.1.1.1.3.2.cmml"><mfrac id="A7.E36.m1.2.2.2.2.1.1.1.3.2a" xref="A7.E36.m1.2.2.2.2.1.1.1.3.2.cmml"><mn id="A7.E36.m1.2.2.2.2.1.1.1.3.2.2" xref="A7.E36.m1.2.2.2.2.1.1.1.3.2.2.cmml">1</mn><mn id="A7.E36.m1.2.2.2.2.1.1.1.3.2.3" xref="A7.E36.m1.2.2.2.2.1.1.1.3.2.3.cmml">2</mn></mfrac></mstyle><mo lspace="0.167em" rspace="0em" id="A7.E36.m1.2.2.2.2.1.1.1.3.1" xref="A7.E36.m1.2.2.2.2.1.1.1.3.1.cmml">​</mo><mrow id="A7.E36.m1.2.2.2.2.1.1.1.3.3" xref="A7.E36.m1.2.2.2.2.1.1.1.3.3.cmml"><mi id="A7.E36.m1.2.2.2.2.1.1.1.3.3.1" xref="A7.E36.m1.2.2.2.2.1.1.1.3.3.1.cmml">log</mi><mo lspace="0.167em" id="A7.E36.m1.2.2.2.2.1.1.1.3.3a" xref="A7.E36.m1.2.2.2.2.1.1.1.3.3.cmml">⁡</mo><mstyle displaystyle="true" id="A7.E36.m1.2.2.2.2.1.1.1.3.3.2" xref="A7.E36.m1.2.2.2.2.1.1.1.3.3.2.cmml"><mfrac id="A7.E36.m1.2.2.2.2.1.1.1.3.3.2a" xref="A7.E36.m1.2.2.2.2.1.1.1.3.3.2.cmml"><msub id="A7.E36.m1.2.2.2.2.1.1.1.3.3.2.2" xref="A7.E36.m1.2.2.2.2.1.1.1.3.3.2.2.cmml"><mi id="A7.E36.m1.2.2.2.2.1.1.1.3.3.2.2.2" xref="A7.E36.m1.2.2.2.2.1.1.1.3.3.2.2.2.cmml">λ</mi><mn id="A7.E36.m1.2.2.2.2.1.1.1.3.3.2.2.3" xref="A7.E36.m1.2.2.2.2.1.1.1.3.3.2.2.3.cmml">2</mn></msub><mi id="A7.E36.m1.2.2.2.2.1.1.1.3.3.2.3" xref="A7.E36.m1.2.2.2.2.1.1.1.3.3.2.3.cmml">λ</mi></mfrac></mstyle></mrow></mrow><mo id="A7.E36.m1.2.2.2.2.1.1.1.2" xref="A7.E36.m1.2.2.2.2.1.1.1.2.cmml">+</mo><mrow id="A7.E36.m1.2.2.2.2.1.1.1.1" xref="A7.E36.m1.2.2.2.2.1.1.1.1.cmml"><mstyle displaystyle="true" id="A7.E36.m1.2.2.2.2.1.1.1.1.3" xref="A7.E36.m1.2.2.2.2.1.1.1.1.3.cmml"><mfrac id="A7.E36.m1.2.2.2.2.1.1.1.1.3a" xref="A7.E36.m1.2.2.2.2.1.1.1.1.3.cmml"><msup id="A7.E36.m1.2.2.2.2.1.1.1.1.3.2" xref="A7.E36.m1.2.2.2.2.1.1.1.1.3.2.cmml"><mi id="A7.E36.m1.2.2.2.2.1.1.1.1.3.2.2" xref="A7.E36.m1.2.2.2.2.1.1.1.1.3.2.2.cmml">ϵ</mi><mn id="A7.E36.m1.2.2.2.2.1.1.1.1.3.2.3" xref="A7.E36.m1.2.2.2.2.1.1.1.1.3.2.3.cmml">2</mn></msup><mn id="A7.E36.m1.2.2.2.2.1.1.1.1.3.3" xref="A7.E36.m1.2.2.2.2.1.1.1.1.3.3.cmml">2</mn></mfrac></mstyle><mo lspace="0em" rspace="0em" id="A7.E36.m1.2.2.2.2.1.1.1.1.2" xref="A7.E36.m1.2.2.2.2.1.1.1.1.2.cmml">​</mo><mrow id="A7.E36.m1.2.2.2.2.1.1.1.1.1.1" xref="A7.E36.m1.2.2.2.2.1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="A7.E36.m1.2.2.2.2.1.1.1.1.1.1.2" xref="A7.E36.m1.2.2.2.2.1.1.1.1.1.1.1.cmml">(</mo><mrow id="A7.E36.m1.2.2.2.2.1.1.1.1.1.1.1" xref="A7.E36.m1.2.2.2.2.1.1.1.1.1.1.1.cmml"><mi id="A7.E36.m1.2.2.2.2.1.1.1.1.1.1.1.2" xref="A7.E36.m1.2.2.2.2.1.1.1.1.1.1.1.2.cmml">λ</mi><mo id="A7.E36.m1.2.2.2.2.1.1.1.1.1.1.1.1" xref="A7.E36.m1.2.2.2.2.1.1.1.1.1.1.1.1.cmml">−</mo><msub id="A7.E36.m1.2.2.2.2.1.1.1.1.1.1.1.3" xref="A7.E36.m1.2.2.2.2.1.1.1.1.1.1.1.3.cmml"><mi id="A7.E36.m1.2.2.2.2.1.1.1.1.1.1.1.3.2" xref="A7.E36.m1.2.2.2.2.1.1.1.1.1.1.1.3.2.cmml">λ</mi><mn id="A7.E36.m1.2.2.2.2.1.1.1.1.1.1.1.3.3" xref="A7.E36.m1.2.2.2.2.1.1.1.1.1.1.1.3.3.cmml">2</mn></msub></mrow><mo stretchy="false" id="A7.E36.m1.2.2.2.2.1.1.1.1.1.1.3" xref="A7.E36.m1.2.2.2.2.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><mo id="A7.E36.m1.2.2.2.2.1.1.3" xref="A7.E36.m1.2.2.2.2.1.1.1.cmml">)</mo></mrow></mrow><mo id="A7.E36.m1.2.2.2.3a" xref="A7.E36.m1.2.2.2.3.cmml">+</mo><mi id="A7.E36.m1.2.2.2.4" xref="A7.E36.m1.2.2.2.4.cmml">C</mi></mrow></mrow><annotation-xml encoding="MathML-Content" id="A7.E36.m1.2b"><apply id="A7.E36.m1.2.2.cmml" xref="A7.E36.m1.2.2"><eq id="A7.E36.m1.2.2.3.cmml" xref="A7.E36.m1.2.2.3"></eq><csymbol cd="latexml" id="A7.E36.m1.2.2.4.cmml" xref="A7.E36.m1.2.2.4">absent</csymbol><apply id="A7.E36.m1.2.2.2.cmml" xref="A7.E36.m1.2.2.2"><plus id="A7.E36.m1.2.2.2.3.cmml" xref="A7.E36.m1.2.2.2.3"></plus><apply id="A7.E36.m1.1.1.1.1.cmml" xref="A7.E36.m1.1.1.1.1"><times id="A7.E36.m1.1.1.1.1.2.cmml" xref="A7.E36.m1.1.1.1.1.2"></times><apply id="A7.E36.m1.1.1.1.1.3.cmml" xref="A7.E36.m1.1.1.1.1.3"><divide id="A7.E36.m1.1.1.1.1.3.1.cmml" xref="A7.E36.m1.1.1.1.1.3"></divide><apply id="A7.E36.m1.1.1.1.1.3.2.cmml" xref="A7.E36.m1.1.1.1.1.3.2"><times id="A7.E36.m1.1.1.1.1.3.2.1.cmml" xref="A7.E36.m1.1.1.1.1.3.2.1"></times><ci id="A7.E36.m1.1.1.1.1.3.2.2.cmml" xref="A7.E36.m1.1.1.1.1.3.2.2">𝜆</ci><apply id="A7.E36.m1.1.1.1.1.3.2.3.cmml" xref="A7.E36.m1.1.1.1.1.3.2.3"><csymbol cd="ambiguous" id="A7.E36.m1.1.1.1.1.3.2.3.1.cmml" xref="A7.E36.m1.1.1.1.1.3.2.3">subscript</csymbol><ci id="A7.E36.m1.1.1.1.1.3.2.3.2.cmml" xref="A7.E36.m1.1.1.1.1.3.2.3.2">𝝅</ci><apply id="A7.E36.m1.1.1.1.1.3.2.3.3.cmml" xref="A7.E36.m1.1.1.1.1.3.2.3.3"><times id="A7.E36.m1.1.1.1.1.3.2.3.3.1.cmml" xref="A7.E36.m1.1.1.1.1.3.2.3.3.1"></times><ci id="A7.E36.m1.1.1.1.1.3.2.3.3.2.cmml" xref="A7.E36.m1.1.1.1.1.3.2.3.3.2">𝑠</ci><ci id="A7.E36.m1.1.1.1.1.3.2.3.3.3.cmml" xref="A7.E36.m1.1.1.1.1.3.2.3.3.3">𝑖</ci></apply></apply></apply><cn type="integer" id="A7.E36.m1.1.1.1.1.3.3.cmml" xref="A7.E36.m1.1.1.1.1.3.3">2</cn></apply><apply id="A7.E36.m1.1.1.1.1.1.cmml" xref="A7.E36.m1.1.1.1.1.1"><csymbol cd="ambiguous" id="A7.E36.m1.1.1.1.1.1.2.cmml" xref="A7.E36.m1.1.1.1.1.1">superscript</csymbol><apply id="A7.E36.m1.1.1.1.1.1.1.1.1.cmml" xref="A7.E36.m1.1.1.1.1.1.1.1"><minus id="A7.E36.m1.1.1.1.1.1.1.1.1.1.cmml" xref="A7.E36.m1.1.1.1.1.1.1.1.1.1"></minus><apply id="A7.E36.m1.1.1.1.1.1.1.1.1.2.cmml" xref="A7.E36.m1.1.1.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="A7.E36.m1.1.1.1.1.1.1.1.1.2.1.cmml" xref="A7.E36.m1.1.1.1.1.1.1.1.1.2">subscript</csymbol><ci id="A7.E36.m1.1.1.1.1.1.1.1.1.2.2.cmml" xref="A7.E36.m1.1.1.1.1.1.1.1.1.2.2">𝐰</ci><apply id="A7.E36.m1.1.1.1.1.1.1.1.1.2.3.cmml" xref="A7.E36.m1.1.1.1.1.1.1.1.1.2.3"><times id="A7.E36.m1.1.1.1.1.1.1.1.1.2.3.1.cmml" xref="A7.E36.m1.1.1.1.1.1.1.1.1.2.3.1"></times><ci id="A7.E36.m1.1.1.1.1.1.1.1.1.2.3.2.cmml" xref="A7.E36.m1.1.1.1.1.1.1.1.1.2.3.2">𝑠</ci><ci id="A7.E36.m1.1.1.1.1.1.1.1.1.2.3.3.cmml" xref="A7.E36.m1.1.1.1.1.1.1.1.1.2.3.3">𝑖</ci></apply></apply><apply id="A7.E36.m1.1.1.1.1.1.1.1.1.3.cmml" xref="A7.E36.m1.1.1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="A7.E36.m1.1.1.1.1.1.1.1.1.3.1.cmml" xref="A7.E36.m1.1.1.1.1.1.1.1.1.3">subscript</csymbol><ci id="A7.E36.m1.1.1.1.1.1.1.1.1.3.2.cmml" xref="A7.E36.m1.1.1.1.1.1.1.1.1.3.2">𝐰</ci><ci id="A7.E36.m1.1.1.1.1.1.1.1.1.3.3.cmml" xref="A7.E36.m1.1.1.1.1.1.1.1.1.3.3">𝑖</ci></apply></apply><cn type="integer" id="A7.E36.m1.1.1.1.1.1.3.cmml" xref="A7.E36.m1.1.1.1.1.1.3">2</cn></apply></apply><apply id="A7.E36.m1.2.2.2.2.cmml" xref="A7.E36.m1.2.2.2.2"><times id="A7.E36.m1.2.2.2.2.2.cmml" xref="A7.E36.m1.2.2.2.2.2"></times><apply id="A7.E36.m1.2.2.2.2.3.cmml" xref="A7.E36.m1.2.2.2.2.3"><csymbol cd="ambiguous" id="A7.E36.m1.2.2.2.2.3.1.cmml" xref="A7.E36.m1.2.2.2.2.3">subscript</csymbol><ci id="A7.E36.m1.2.2.2.2.3.2.cmml" xref="A7.E36.m1.2.2.2.2.3.2">𝝅</ci><apply id="A7.E36.m1.2.2.2.2.3.3.cmml" xref="A7.E36.m1.2.2.2.2.3.3"><times id="A7.E36.m1.2.2.2.2.3.3.1.cmml" xref="A7.E36.m1.2.2.2.2.3.3.1"></times><ci id="A7.E36.m1.2.2.2.2.3.3.2.cmml" xref="A7.E36.m1.2.2.2.2.3.3.2">𝑠</ci><ci id="A7.E36.m1.2.2.2.2.3.3.3.cmml" xref="A7.E36.m1.2.2.2.2.3.3.3">𝑖</ci></apply></apply><apply id="A7.E36.m1.2.2.2.2.1.1.1.cmml" xref="A7.E36.m1.2.2.2.2.1.1"><plus id="A7.E36.m1.2.2.2.2.1.1.1.2.cmml" xref="A7.E36.m1.2.2.2.2.1.1.1.2"></plus><apply id="A7.E36.m1.2.2.2.2.1.1.1.3.cmml" xref="A7.E36.m1.2.2.2.2.1.1.1.3"><times id="A7.E36.m1.2.2.2.2.1.1.1.3.1.cmml" xref="A7.E36.m1.2.2.2.2.1.1.1.3.1"></times><apply id="A7.E36.m1.2.2.2.2.1.1.1.3.2.cmml" xref="A7.E36.m1.2.2.2.2.1.1.1.3.2"><divide id="A7.E36.m1.2.2.2.2.1.1.1.3.2.1.cmml" xref="A7.E36.m1.2.2.2.2.1.1.1.3.2"></divide><cn type="integer" id="A7.E36.m1.2.2.2.2.1.1.1.3.2.2.cmml" xref="A7.E36.m1.2.2.2.2.1.1.1.3.2.2">1</cn><cn type="integer" id="A7.E36.m1.2.2.2.2.1.1.1.3.2.3.cmml" xref="A7.E36.m1.2.2.2.2.1.1.1.3.2.3">2</cn></apply><apply id="A7.E36.m1.2.2.2.2.1.1.1.3.3.cmml" xref="A7.E36.m1.2.2.2.2.1.1.1.3.3"><log id="A7.E36.m1.2.2.2.2.1.1.1.3.3.1.cmml" xref="A7.E36.m1.2.2.2.2.1.1.1.3.3.1"></log><apply id="A7.E36.m1.2.2.2.2.1.1.1.3.3.2.cmml" xref="A7.E36.m1.2.2.2.2.1.1.1.3.3.2"><divide id="A7.E36.m1.2.2.2.2.1.1.1.3.3.2.1.cmml" xref="A7.E36.m1.2.2.2.2.1.1.1.3.3.2"></divide><apply id="A7.E36.m1.2.2.2.2.1.1.1.3.3.2.2.cmml" xref="A7.E36.m1.2.2.2.2.1.1.1.3.3.2.2"><csymbol cd="ambiguous" id="A7.E36.m1.2.2.2.2.1.1.1.3.3.2.2.1.cmml" xref="A7.E36.m1.2.2.2.2.1.1.1.3.3.2.2">subscript</csymbol><ci id="A7.E36.m1.2.2.2.2.1.1.1.3.3.2.2.2.cmml" xref="A7.E36.m1.2.2.2.2.1.1.1.3.3.2.2.2">𝜆</ci><cn type="integer" id="A7.E36.m1.2.2.2.2.1.1.1.3.3.2.2.3.cmml" xref="A7.E36.m1.2.2.2.2.1.1.1.3.3.2.2.3">2</cn></apply><ci id="A7.E36.m1.2.2.2.2.1.1.1.3.3.2.3.cmml" xref="A7.E36.m1.2.2.2.2.1.1.1.3.3.2.3">𝜆</ci></apply></apply></apply><apply id="A7.E36.m1.2.2.2.2.1.1.1.1.cmml" xref="A7.E36.m1.2.2.2.2.1.1.1.1"><times id="A7.E36.m1.2.2.2.2.1.1.1.1.2.cmml" xref="A7.E36.m1.2.2.2.2.1.1.1.1.2"></times><apply id="A7.E36.m1.2.2.2.2.1.1.1.1.3.cmml" xref="A7.E36.m1.2.2.2.2.1.1.1.1.3"><divide id="A7.E36.m1.2.2.2.2.1.1.1.1.3.1.cmml" xref="A7.E36.m1.2.2.2.2.1.1.1.1.3"></divide><apply id="A7.E36.m1.2.2.2.2.1.1.1.1.3.2.cmml" xref="A7.E36.m1.2.2.2.2.1.1.1.1.3.2"><csymbol cd="ambiguous" id="A7.E36.m1.2.2.2.2.1.1.1.1.3.2.1.cmml" xref="A7.E36.m1.2.2.2.2.1.1.1.1.3.2">superscript</csymbol><ci id="A7.E36.m1.2.2.2.2.1.1.1.1.3.2.2.cmml" xref="A7.E36.m1.2.2.2.2.1.1.1.1.3.2.2">italic-ϵ</ci><cn type="integer" id="A7.E36.m1.2.2.2.2.1.1.1.1.3.2.3.cmml" xref="A7.E36.m1.2.2.2.2.1.1.1.1.3.2.3">2</cn></apply><cn type="integer" id="A7.E36.m1.2.2.2.2.1.1.1.1.3.3.cmml" xref="A7.E36.m1.2.2.2.2.1.1.1.1.3.3">2</cn></apply><apply id="A7.E36.m1.2.2.2.2.1.1.1.1.1.1.1.cmml" xref="A7.E36.m1.2.2.2.2.1.1.1.1.1.1"><minus id="A7.E36.m1.2.2.2.2.1.1.1.1.1.1.1.1.cmml" xref="A7.E36.m1.2.2.2.2.1.1.1.1.1.1.1.1"></minus><ci id="A7.E36.m1.2.2.2.2.1.1.1.1.1.1.1.2.cmml" xref="A7.E36.m1.2.2.2.2.1.1.1.1.1.1.1.2">𝜆</ci><apply id="A7.E36.m1.2.2.2.2.1.1.1.1.1.1.1.3.cmml" xref="A7.E36.m1.2.2.2.2.1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="A7.E36.m1.2.2.2.2.1.1.1.1.1.1.1.3.1.cmml" xref="A7.E36.m1.2.2.2.2.1.1.1.1.1.1.1.3">subscript</csymbol><ci id="A7.E36.m1.2.2.2.2.1.1.1.1.1.1.1.3.2.cmml" xref="A7.E36.m1.2.2.2.2.1.1.1.1.1.1.1.3.2">𝜆</ci><cn type="integer" id="A7.E36.m1.2.2.2.2.1.1.1.1.1.1.1.3.3.cmml" xref="A7.E36.m1.2.2.2.2.1.1.1.1.1.1.1.3.3">2</cn></apply></apply></apply></apply></apply><ci id="A7.E36.m1.2.2.2.4.cmml" xref="A7.E36.m1.2.2.2.4">𝐶</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A7.E36.m1.2c">\displaystyle=\frac{\lambda\bm{\pi}_{si}}{2}(\mathbf{w}_{si}-\mathbf{w}_{i})^{2}+\bm{\pi}_{si}\left(\frac{1}{2}\log\frac{\lambda_{2}}{\lambda}+\frac{\epsilon^{2}}{2}(\lambda-\lambda_{2})\right)+C</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(36)</span></td>
</tr></tbody>
<tbody id="A7.E37"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_eqn_cell"></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math id="A7.E37.m1.1" class="ltx_Math" alttext="\displaystyle\approx\frac{\lambda\bm{\pi}_{si}}{2}(\mathbf{w}_{si}-\mathbf{w}_{i})^{2}+\lambda_{0}\bm{\pi}_{si}+C," display="inline"><semantics id="A7.E37.m1.1a"><mrow id="A7.E37.m1.1.1.1" xref="A7.E37.m1.1.1.1.1.cmml"><mrow id="A7.E37.m1.1.1.1.1" xref="A7.E37.m1.1.1.1.1.cmml"><mi id="A7.E37.m1.1.1.1.1.3" xref="A7.E37.m1.1.1.1.1.3.cmml"></mi><mo id="A7.E37.m1.1.1.1.1.2" xref="A7.E37.m1.1.1.1.1.2.cmml">≈</mo><mrow id="A7.E37.m1.1.1.1.1.1" xref="A7.E37.m1.1.1.1.1.1.cmml"><mrow id="A7.E37.m1.1.1.1.1.1.1" xref="A7.E37.m1.1.1.1.1.1.1.cmml"><mstyle displaystyle="true" id="A7.E37.m1.1.1.1.1.1.1.3" xref="A7.E37.m1.1.1.1.1.1.1.3.cmml"><mfrac id="A7.E37.m1.1.1.1.1.1.1.3a" xref="A7.E37.m1.1.1.1.1.1.1.3.cmml"><mrow id="A7.E37.m1.1.1.1.1.1.1.3.2" xref="A7.E37.m1.1.1.1.1.1.1.3.2.cmml"><mi id="A7.E37.m1.1.1.1.1.1.1.3.2.2" xref="A7.E37.m1.1.1.1.1.1.1.3.2.2.cmml">λ</mi><mo lspace="0em" rspace="0em" id="A7.E37.m1.1.1.1.1.1.1.3.2.1" xref="A7.E37.m1.1.1.1.1.1.1.3.2.1.cmml">​</mo><msub id="A7.E37.m1.1.1.1.1.1.1.3.2.3" xref="A7.E37.m1.1.1.1.1.1.1.3.2.3.cmml"><mi id="A7.E37.m1.1.1.1.1.1.1.3.2.3.2" xref="A7.E37.m1.1.1.1.1.1.1.3.2.3.2.cmml">𝝅</mi><mrow id="A7.E37.m1.1.1.1.1.1.1.3.2.3.3" xref="A7.E37.m1.1.1.1.1.1.1.3.2.3.3.cmml"><mi id="A7.E37.m1.1.1.1.1.1.1.3.2.3.3.2" xref="A7.E37.m1.1.1.1.1.1.1.3.2.3.3.2.cmml">s</mi><mo lspace="0em" rspace="0em" id="A7.E37.m1.1.1.1.1.1.1.3.2.3.3.1" xref="A7.E37.m1.1.1.1.1.1.1.3.2.3.3.1.cmml">​</mo><mi id="A7.E37.m1.1.1.1.1.1.1.3.2.3.3.3" xref="A7.E37.m1.1.1.1.1.1.1.3.2.3.3.3.cmml">i</mi></mrow></msub></mrow><mn id="A7.E37.m1.1.1.1.1.1.1.3.3" xref="A7.E37.m1.1.1.1.1.1.1.3.3.cmml">2</mn></mfrac></mstyle><mo lspace="0em" rspace="0em" id="A7.E37.m1.1.1.1.1.1.1.2" xref="A7.E37.m1.1.1.1.1.1.1.2.cmml">​</mo><msup id="A7.E37.m1.1.1.1.1.1.1.1" xref="A7.E37.m1.1.1.1.1.1.1.1.cmml"><mrow id="A7.E37.m1.1.1.1.1.1.1.1.1.1" xref="A7.E37.m1.1.1.1.1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="A7.E37.m1.1.1.1.1.1.1.1.1.1.2" xref="A7.E37.m1.1.1.1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="A7.E37.m1.1.1.1.1.1.1.1.1.1.1" xref="A7.E37.m1.1.1.1.1.1.1.1.1.1.1.cmml"><msub id="A7.E37.m1.1.1.1.1.1.1.1.1.1.1.2" xref="A7.E37.m1.1.1.1.1.1.1.1.1.1.1.2.cmml"><mi id="A7.E37.m1.1.1.1.1.1.1.1.1.1.1.2.2" xref="A7.E37.m1.1.1.1.1.1.1.1.1.1.1.2.2.cmml">𝐰</mi><mrow id="A7.E37.m1.1.1.1.1.1.1.1.1.1.1.2.3" xref="A7.E37.m1.1.1.1.1.1.1.1.1.1.1.2.3.cmml"><mi id="A7.E37.m1.1.1.1.1.1.1.1.1.1.1.2.3.2" xref="A7.E37.m1.1.1.1.1.1.1.1.1.1.1.2.3.2.cmml">s</mi><mo lspace="0em" rspace="0em" id="A7.E37.m1.1.1.1.1.1.1.1.1.1.1.2.3.1" xref="A7.E37.m1.1.1.1.1.1.1.1.1.1.1.2.3.1.cmml">​</mo><mi id="A7.E37.m1.1.1.1.1.1.1.1.1.1.1.2.3.3" xref="A7.E37.m1.1.1.1.1.1.1.1.1.1.1.2.3.3.cmml">i</mi></mrow></msub><mo id="A7.E37.m1.1.1.1.1.1.1.1.1.1.1.1" xref="A7.E37.m1.1.1.1.1.1.1.1.1.1.1.1.cmml">−</mo><msub id="A7.E37.m1.1.1.1.1.1.1.1.1.1.1.3" xref="A7.E37.m1.1.1.1.1.1.1.1.1.1.1.3.cmml"><mi id="A7.E37.m1.1.1.1.1.1.1.1.1.1.1.3.2" xref="A7.E37.m1.1.1.1.1.1.1.1.1.1.1.3.2.cmml">𝐰</mi><mi id="A7.E37.m1.1.1.1.1.1.1.1.1.1.1.3.3" xref="A7.E37.m1.1.1.1.1.1.1.1.1.1.1.3.3.cmml">i</mi></msub></mrow><mo stretchy="false" id="A7.E37.m1.1.1.1.1.1.1.1.1.1.3" xref="A7.E37.m1.1.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow><mn id="A7.E37.m1.1.1.1.1.1.1.1.3" xref="A7.E37.m1.1.1.1.1.1.1.1.3.cmml">2</mn></msup></mrow><mo id="A7.E37.m1.1.1.1.1.1.2" xref="A7.E37.m1.1.1.1.1.1.2.cmml">+</mo><mrow id="A7.E37.m1.1.1.1.1.1.3" xref="A7.E37.m1.1.1.1.1.1.3.cmml"><msub id="A7.E37.m1.1.1.1.1.1.3.2" xref="A7.E37.m1.1.1.1.1.1.3.2.cmml"><mi id="A7.E37.m1.1.1.1.1.1.3.2.2" xref="A7.E37.m1.1.1.1.1.1.3.2.2.cmml">λ</mi><mn id="A7.E37.m1.1.1.1.1.1.3.2.3" xref="A7.E37.m1.1.1.1.1.1.3.2.3.cmml">0</mn></msub><mo lspace="0em" rspace="0em" id="A7.E37.m1.1.1.1.1.1.3.1" xref="A7.E37.m1.1.1.1.1.1.3.1.cmml">​</mo><msub id="A7.E37.m1.1.1.1.1.1.3.3" xref="A7.E37.m1.1.1.1.1.1.3.3.cmml"><mi id="A7.E37.m1.1.1.1.1.1.3.3.2" xref="A7.E37.m1.1.1.1.1.1.3.3.2.cmml">𝝅</mi><mrow id="A7.E37.m1.1.1.1.1.1.3.3.3" xref="A7.E37.m1.1.1.1.1.1.3.3.3.cmml"><mi id="A7.E37.m1.1.1.1.1.1.3.3.3.2" xref="A7.E37.m1.1.1.1.1.1.3.3.3.2.cmml">s</mi><mo lspace="0em" rspace="0em" id="A7.E37.m1.1.1.1.1.1.3.3.3.1" xref="A7.E37.m1.1.1.1.1.1.3.3.3.1.cmml">​</mo><mi id="A7.E37.m1.1.1.1.1.1.3.3.3.3" xref="A7.E37.m1.1.1.1.1.1.3.3.3.3.cmml">i</mi></mrow></msub></mrow><mo id="A7.E37.m1.1.1.1.1.1.2a" xref="A7.E37.m1.1.1.1.1.1.2.cmml">+</mo><mi id="A7.E37.m1.1.1.1.1.1.4" xref="A7.E37.m1.1.1.1.1.1.4.cmml">C</mi></mrow></mrow><mo id="A7.E37.m1.1.1.1.2" xref="A7.E37.m1.1.1.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="A7.E37.m1.1b"><apply id="A7.E37.m1.1.1.1.1.cmml" xref="A7.E37.m1.1.1.1"><approx id="A7.E37.m1.1.1.1.1.2.cmml" xref="A7.E37.m1.1.1.1.1.2"></approx><csymbol cd="latexml" id="A7.E37.m1.1.1.1.1.3.cmml" xref="A7.E37.m1.1.1.1.1.3">absent</csymbol><apply id="A7.E37.m1.1.1.1.1.1.cmml" xref="A7.E37.m1.1.1.1.1.1"><plus id="A7.E37.m1.1.1.1.1.1.2.cmml" xref="A7.E37.m1.1.1.1.1.1.2"></plus><apply id="A7.E37.m1.1.1.1.1.1.1.cmml" xref="A7.E37.m1.1.1.1.1.1.1"><times id="A7.E37.m1.1.1.1.1.1.1.2.cmml" xref="A7.E37.m1.1.1.1.1.1.1.2"></times><apply id="A7.E37.m1.1.1.1.1.1.1.3.cmml" xref="A7.E37.m1.1.1.1.1.1.1.3"><divide id="A7.E37.m1.1.1.1.1.1.1.3.1.cmml" xref="A7.E37.m1.1.1.1.1.1.1.3"></divide><apply id="A7.E37.m1.1.1.1.1.1.1.3.2.cmml" xref="A7.E37.m1.1.1.1.1.1.1.3.2"><times id="A7.E37.m1.1.1.1.1.1.1.3.2.1.cmml" xref="A7.E37.m1.1.1.1.1.1.1.3.2.1"></times><ci id="A7.E37.m1.1.1.1.1.1.1.3.2.2.cmml" xref="A7.E37.m1.1.1.1.1.1.1.3.2.2">𝜆</ci><apply id="A7.E37.m1.1.1.1.1.1.1.3.2.3.cmml" xref="A7.E37.m1.1.1.1.1.1.1.3.2.3"><csymbol cd="ambiguous" id="A7.E37.m1.1.1.1.1.1.1.3.2.3.1.cmml" xref="A7.E37.m1.1.1.1.1.1.1.3.2.3">subscript</csymbol><ci id="A7.E37.m1.1.1.1.1.1.1.3.2.3.2.cmml" xref="A7.E37.m1.1.1.1.1.1.1.3.2.3.2">𝝅</ci><apply id="A7.E37.m1.1.1.1.1.1.1.3.2.3.3.cmml" xref="A7.E37.m1.1.1.1.1.1.1.3.2.3.3"><times id="A7.E37.m1.1.1.1.1.1.1.3.2.3.3.1.cmml" xref="A7.E37.m1.1.1.1.1.1.1.3.2.3.3.1"></times><ci id="A7.E37.m1.1.1.1.1.1.1.3.2.3.3.2.cmml" xref="A7.E37.m1.1.1.1.1.1.1.3.2.3.3.2">𝑠</ci><ci id="A7.E37.m1.1.1.1.1.1.1.3.2.3.3.3.cmml" xref="A7.E37.m1.1.1.1.1.1.1.3.2.3.3.3">𝑖</ci></apply></apply></apply><cn type="integer" id="A7.E37.m1.1.1.1.1.1.1.3.3.cmml" xref="A7.E37.m1.1.1.1.1.1.1.3.3">2</cn></apply><apply id="A7.E37.m1.1.1.1.1.1.1.1.cmml" xref="A7.E37.m1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="A7.E37.m1.1.1.1.1.1.1.1.2.cmml" xref="A7.E37.m1.1.1.1.1.1.1.1">superscript</csymbol><apply id="A7.E37.m1.1.1.1.1.1.1.1.1.1.1.cmml" xref="A7.E37.m1.1.1.1.1.1.1.1.1.1"><minus id="A7.E37.m1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="A7.E37.m1.1.1.1.1.1.1.1.1.1.1.1"></minus><apply id="A7.E37.m1.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="A7.E37.m1.1.1.1.1.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="A7.E37.m1.1.1.1.1.1.1.1.1.1.1.2.1.cmml" xref="A7.E37.m1.1.1.1.1.1.1.1.1.1.1.2">subscript</csymbol><ci id="A7.E37.m1.1.1.1.1.1.1.1.1.1.1.2.2.cmml" xref="A7.E37.m1.1.1.1.1.1.1.1.1.1.1.2.2">𝐰</ci><apply id="A7.E37.m1.1.1.1.1.1.1.1.1.1.1.2.3.cmml" xref="A7.E37.m1.1.1.1.1.1.1.1.1.1.1.2.3"><times id="A7.E37.m1.1.1.1.1.1.1.1.1.1.1.2.3.1.cmml" xref="A7.E37.m1.1.1.1.1.1.1.1.1.1.1.2.3.1"></times><ci id="A7.E37.m1.1.1.1.1.1.1.1.1.1.1.2.3.2.cmml" xref="A7.E37.m1.1.1.1.1.1.1.1.1.1.1.2.3.2">𝑠</ci><ci id="A7.E37.m1.1.1.1.1.1.1.1.1.1.1.2.3.3.cmml" xref="A7.E37.m1.1.1.1.1.1.1.1.1.1.1.2.3.3">𝑖</ci></apply></apply><apply id="A7.E37.m1.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="A7.E37.m1.1.1.1.1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="A7.E37.m1.1.1.1.1.1.1.1.1.1.1.3.1.cmml" xref="A7.E37.m1.1.1.1.1.1.1.1.1.1.1.3">subscript</csymbol><ci id="A7.E37.m1.1.1.1.1.1.1.1.1.1.1.3.2.cmml" xref="A7.E37.m1.1.1.1.1.1.1.1.1.1.1.3.2">𝐰</ci><ci id="A7.E37.m1.1.1.1.1.1.1.1.1.1.1.3.3.cmml" xref="A7.E37.m1.1.1.1.1.1.1.1.1.1.1.3.3">𝑖</ci></apply></apply><cn type="integer" id="A7.E37.m1.1.1.1.1.1.1.1.3.cmml" xref="A7.E37.m1.1.1.1.1.1.1.1.3">2</cn></apply></apply><apply id="A7.E37.m1.1.1.1.1.1.3.cmml" xref="A7.E37.m1.1.1.1.1.1.3"><times id="A7.E37.m1.1.1.1.1.1.3.1.cmml" xref="A7.E37.m1.1.1.1.1.1.3.1"></times><apply id="A7.E37.m1.1.1.1.1.1.3.2.cmml" xref="A7.E37.m1.1.1.1.1.1.3.2"><csymbol cd="ambiguous" id="A7.E37.m1.1.1.1.1.1.3.2.1.cmml" xref="A7.E37.m1.1.1.1.1.1.3.2">subscript</csymbol><ci id="A7.E37.m1.1.1.1.1.1.3.2.2.cmml" xref="A7.E37.m1.1.1.1.1.1.3.2.2">𝜆</ci><cn type="integer" id="A7.E37.m1.1.1.1.1.1.3.2.3.cmml" xref="A7.E37.m1.1.1.1.1.1.3.2.3">0</cn></apply><apply id="A7.E37.m1.1.1.1.1.1.3.3.cmml" xref="A7.E37.m1.1.1.1.1.1.3.3"><csymbol cd="ambiguous" id="A7.E37.m1.1.1.1.1.1.3.3.1.cmml" xref="A7.E37.m1.1.1.1.1.1.3.3">subscript</csymbol><ci id="A7.E37.m1.1.1.1.1.1.3.3.2.cmml" xref="A7.E37.m1.1.1.1.1.1.3.3.2">𝝅</ci><apply id="A7.E37.m1.1.1.1.1.1.3.3.3.cmml" xref="A7.E37.m1.1.1.1.1.1.3.3.3"><times id="A7.E37.m1.1.1.1.1.1.3.3.3.1.cmml" xref="A7.E37.m1.1.1.1.1.1.3.3.3.1"></times><ci id="A7.E37.m1.1.1.1.1.1.3.3.3.2.cmml" xref="A7.E37.m1.1.1.1.1.1.3.3.3.2">𝑠</ci><ci id="A7.E37.m1.1.1.1.1.1.3.3.3.3.cmml" xref="A7.E37.m1.1.1.1.1.1.3.3.3.3">𝑖</ci></apply></apply></apply><ci id="A7.E37.m1.1.1.1.1.1.4.cmml" xref="A7.E37.m1.1.1.1.1.1.4">𝐶</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A7.E37.m1.1c">\displaystyle\approx\frac{\lambda\bm{\pi}_{si}}{2}(\mathbf{w}_{si}-\mathbf{w}_{i})^{2}+\lambda_{0}\bm{\pi}_{si}+C,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(37)</span></td>
</tr></tbody>
</table>
<p id="A7.p2.12" class="ltx_p">where <math id="A7.p2.3.m1.1" class="ltx_Math" alttext="\lambda_{0}=\frac{1}{2}\log\frac{\lambda_{2}}{\lambda}" display="inline"><semantics id="A7.p2.3.m1.1a"><mrow id="A7.p2.3.m1.1.1" xref="A7.p2.3.m1.1.1.cmml"><msub id="A7.p2.3.m1.1.1.2" xref="A7.p2.3.m1.1.1.2.cmml"><mi id="A7.p2.3.m1.1.1.2.2" xref="A7.p2.3.m1.1.1.2.2.cmml">λ</mi><mn id="A7.p2.3.m1.1.1.2.3" xref="A7.p2.3.m1.1.1.2.3.cmml">0</mn></msub><mo id="A7.p2.3.m1.1.1.1" xref="A7.p2.3.m1.1.1.1.cmml">=</mo><mrow id="A7.p2.3.m1.1.1.3" xref="A7.p2.3.m1.1.1.3.cmml"><mfrac id="A7.p2.3.m1.1.1.3.2" xref="A7.p2.3.m1.1.1.3.2.cmml"><mn id="A7.p2.3.m1.1.1.3.2.2" xref="A7.p2.3.m1.1.1.3.2.2.cmml">1</mn><mn id="A7.p2.3.m1.1.1.3.2.3" xref="A7.p2.3.m1.1.1.3.2.3.cmml">2</mn></mfrac><mo lspace="0.167em" rspace="0em" id="A7.p2.3.m1.1.1.3.1" xref="A7.p2.3.m1.1.1.3.1.cmml">​</mo><mrow id="A7.p2.3.m1.1.1.3.3" xref="A7.p2.3.m1.1.1.3.3.cmml"><mi id="A7.p2.3.m1.1.1.3.3.1" xref="A7.p2.3.m1.1.1.3.3.1.cmml">log</mi><mo lspace="0.167em" id="A7.p2.3.m1.1.1.3.3a" xref="A7.p2.3.m1.1.1.3.3.cmml">⁡</mo><mfrac id="A7.p2.3.m1.1.1.3.3.2" xref="A7.p2.3.m1.1.1.3.3.2.cmml"><msub id="A7.p2.3.m1.1.1.3.3.2.2" xref="A7.p2.3.m1.1.1.3.3.2.2.cmml"><mi id="A7.p2.3.m1.1.1.3.3.2.2.2" xref="A7.p2.3.m1.1.1.3.3.2.2.2.cmml">λ</mi><mn id="A7.p2.3.m1.1.1.3.3.2.2.3" xref="A7.p2.3.m1.1.1.3.3.2.2.3.cmml">2</mn></msub><mi id="A7.p2.3.m1.1.1.3.3.2.3" xref="A7.p2.3.m1.1.1.3.3.2.3.cmml">λ</mi></mfrac></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="A7.p2.3.m1.1b"><apply id="A7.p2.3.m1.1.1.cmml" xref="A7.p2.3.m1.1.1"><eq id="A7.p2.3.m1.1.1.1.cmml" xref="A7.p2.3.m1.1.1.1"></eq><apply id="A7.p2.3.m1.1.1.2.cmml" xref="A7.p2.3.m1.1.1.2"><csymbol cd="ambiguous" id="A7.p2.3.m1.1.1.2.1.cmml" xref="A7.p2.3.m1.1.1.2">subscript</csymbol><ci id="A7.p2.3.m1.1.1.2.2.cmml" xref="A7.p2.3.m1.1.1.2.2">𝜆</ci><cn type="integer" id="A7.p2.3.m1.1.1.2.3.cmml" xref="A7.p2.3.m1.1.1.2.3">0</cn></apply><apply id="A7.p2.3.m1.1.1.3.cmml" xref="A7.p2.3.m1.1.1.3"><times id="A7.p2.3.m1.1.1.3.1.cmml" xref="A7.p2.3.m1.1.1.3.1"></times><apply id="A7.p2.3.m1.1.1.3.2.cmml" xref="A7.p2.3.m1.1.1.3.2"><divide id="A7.p2.3.m1.1.1.3.2.1.cmml" xref="A7.p2.3.m1.1.1.3.2"></divide><cn type="integer" id="A7.p2.3.m1.1.1.3.2.2.cmml" xref="A7.p2.3.m1.1.1.3.2.2">1</cn><cn type="integer" id="A7.p2.3.m1.1.1.3.2.3.cmml" xref="A7.p2.3.m1.1.1.3.2.3">2</cn></apply><apply id="A7.p2.3.m1.1.1.3.3.cmml" xref="A7.p2.3.m1.1.1.3.3"><log id="A7.p2.3.m1.1.1.3.3.1.cmml" xref="A7.p2.3.m1.1.1.3.3.1"></log><apply id="A7.p2.3.m1.1.1.3.3.2.cmml" xref="A7.p2.3.m1.1.1.3.3.2"><divide id="A7.p2.3.m1.1.1.3.3.2.1.cmml" xref="A7.p2.3.m1.1.1.3.3.2"></divide><apply id="A7.p2.3.m1.1.1.3.3.2.2.cmml" xref="A7.p2.3.m1.1.1.3.3.2.2"><csymbol cd="ambiguous" id="A7.p2.3.m1.1.1.3.3.2.2.1.cmml" xref="A7.p2.3.m1.1.1.3.3.2.2">subscript</csymbol><ci id="A7.p2.3.m1.1.1.3.3.2.2.2.cmml" xref="A7.p2.3.m1.1.1.3.3.2.2.2">𝜆</ci><cn type="integer" id="A7.p2.3.m1.1.1.3.3.2.2.3.cmml" xref="A7.p2.3.m1.1.1.3.3.2.2.3">2</cn></apply><ci id="A7.p2.3.m1.1.1.3.3.2.3.cmml" xref="A7.p2.3.m1.1.1.3.3.2.3">𝜆</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A7.p2.3.m1.1c">\lambda_{0}=\frac{1}{2}\log\frac{\lambda_{2}}{\lambda}</annotation></semantics></math> and <math id="A7.p2.4.m2.1" class="ltx_Math" alttext="\frac{\epsilon^{2}}{2}(\lambda-\lambda_{2})" display="inline"><semantics id="A7.p2.4.m2.1a"><mrow id="A7.p2.4.m2.1.1" xref="A7.p2.4.m2.1.1.cmml"><mfrac id="A7.p2.4.m2.1.1.3" xref="A7.p2.4.m2.1.1.3.cmml"><msup id="A7.p2.4.m2.1.1.3.2" xref="A7.p2.4.m2.1.1.3.2.cmml"><mi id="A7.p2.4.m2.1.1.3.2.2" xref="A7.p2.4.m2.1.1.3.2.2.cmml">ϵ</mi><mn id="A7.p2.4.m2.1.1.3.2.3" xref="A7.p2.4.m2.1.1.3.2.3.cmml">2</mn></msup><mn id="A7.p2.4.m2.1.1.3.3" xref="A7.p2.4.m2.1.1.3.3.cmml">2</mn></mfrac><mo lspace="0em" rspace="0em" id="A7.p2.4.m2.1.1.2" xref="A7.p2.4.m2.1.1.2.cmml">​</mo><mrow id="A7.p2.4.m2.1.1.1.1" xref="A7.p2.4.m2.1.1.1.1.1.cmml"><mo stretchy="false" id="A7.p2.4.m2.1.1.1.1.2" xref="A7.p2.4.m2.1.1.1.1.1.cmml">(</mo><mrow id="A7.p2.4.m2.1.1.1.1.1" xref="A7.p2.4.m2.1.1.1.1.1.cmml"><mi id="A7.p2.4.m2.1.1.1.1.1.2" xref="A7.p2.4.m2.1.1.1.1.1.2.cmml">λ</mi><mo id="A7.p2.4.m2.1.1.1.1.1.1" xref="A7.p2.4.m2.1.1.1.1.1.1.cmml">−</mo><msub id="A7.p2.4.m2.1.1.1.1.1.3" xref="A7.p2.4.m2.1.1.1.1.1.3.cmml"><mi id="A7.p2.4.m2.1.1.1.1.1.3.2" xref="A7.p2.4.m2.1.1.1.1.1.3.2.cmml">λ</mi><mn id="A7.p2.4.m2.1.1.1.1.1.3.3" xref="A7.p2.4.m2.1.1.1.1.1.3.3.cmml">2</mn></msub></mrow><mo stretchy="false" id="A7.p2.4.m2.1.1.1.1.3" xref="A7.p2.4.m2.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="A7.p2.4.m2.1b"><apply id="A7.p2.4.m2.1.1.cmml" xref="A7.p2.4.m2.1.1"><times id="A7.p2.4.m2.1.1.2.cmml" xref="A7.p2.4.m2.1.1.2"></times><apply id="A7.p2.4.m2.1.1.3.cmml" xref="A7.p2.4.m2.1.1.3"><divide id="A7.p2.4.m2.1.1.3.1.cmml" xref="A7.p2.4.m2.1.1.3"></divide><apply id="A7.p2.4.m2.1.1.3.2.cmml" xref="A7.p2.4.m2.1.1.3.2"><csymbol cd="ambiguous" id="A7.p2.4.m2.1.1.3.2.1.cmml" xref="A7.p2.4.m2.1.1.3.2">superscript</csymbol><ci id="A7.p2.4.m2.1.1.3.2.2.cmml" xref="A7.p2.4.m2.1.1.3.2.2">italic-ϵ</ci><cn type="integer" id="A7.p2.4.m2.1.1.3.2.3.cmml" xref="A7.p2.4.m2.1.1.3.2.3">2</cn></apply><cn type="integer" id="A7.p2.4.m2.1.1.3.3.cmml" xref="A7.p2.4.m2.1.1.3.3">2</cn></apply><apply id="A7.p2.4.m2.1.1.1.1.1.cmml" xref="A7.p2.4.m2.1.1.1.1"><minus id="A7.p2.4.m2.1.1.1.1.1.1.cmml" xref="A7.p2.4.m2.1.1.1.1.1.1"></minus><ci id="A7.p2.4.m2.1.1.1.1.1.2.cmml" xref="A7.p2.4.m2.1.1.1.1.1.2">𝜆</ci><apply id="A7.p2.4.m2.1.1.1.1.1.3.cmml" xref="A7.p2.4.m2.1.1.1.1.1.3"><csymbol cd="ambiguous" id="A7.p2.4.m2.1.1.1.1.1.3.1.cmml" xref="A7.p2.4.m2.1.1.1.1.1.3">subscript</csymbol><ci id="A7.p2.4.m2.1.1.1.1.1.3.2.cmml" xref="A7.p2.4.m2.1.1.1.1.1.3.2">𝜆</ci><cn type="integer" id="A7.p2.4.m2.1.1.1.1.1.3.3.cmml" xref="A7.p2.4.m2.1.1.1.1.1.3.3">2</cn></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A7.p2.4.m2.1c">\frac{\epsilon^{2}}{2}(\lambda-\lambda_{2})</annotation></semantics></math> was omitted due to <math id="A7.p2.5.m3.1" class="ltx_Math" alttext="\epsilon^{2}\approx 0" display="inline"><semantics id="A7.p2.5.m3.1a"><mrow id="A7.p2.5.m3.1.1" xref="A7.p2.5.m3.1.1.cmml"><msup id="A7.p2.5.m3.1.1.2" xref="A7.p2.5.m3.1.1.2.cmml"><mi id="A7.p2.5.m3.1.1.2.2" xref="A7.p2.5.m3.1.1.2.2.cmml">ϵ</mi><mn id="A7.p2.5.m3.1.1.2.3" xref="A7.p2.5.m3.1.1.2.3.cmml">2</mn></msup><mo id="A7.p2.5.m3.1.1.1" xref="A7.p2.5.m3.1.1.1.cmml">≈</mo><mn id="A7.p2.5.m3.1.1.3" xref="A7.p2.5.m3.1.1.3.cmml">0</mn></mrow><annotation-xml encoding="MathML-Content" id="A7.p2.5.m3.1b"><apply id="A7.p2.5.m3.1.1.cmml" xref="A7.p2.5.m3.1.1"><approx id="A7.p2.5.m3.1.1.1.cmml" xref="A7.p2.5.m3.1.1.1"></approx><apply id="A7.p2.5.m3.1.1.2.cmml" xref="A7.p2.5.m3.1.1.2"><csymbol cd="ambiguous" id="A7.p2.5.m3.1.1.2.1.cmml" xref="A7.p2.5.m3.1.1.2">superscript</csymbol><ci id="A7.p2.5.m3.1.1.2.2.cmml" xref="A7.p2.5.m3.1.1.2.2">italic-ϵ</ci><cn type="integer" id="A7.p2.5.m3.1.1.2.3.cmml" xref="A7.p2.5.m3.1.1.2.3">2</cn></apply><cn type="integer" id="A7.p2.5.m3.1.1.3.cmml" xref="A7.p2.5.m3.1.1.3">0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A7.p2.5.m3.1c">\epsilon^{2}\approx 0</annotation></semantics></math>. In the appendix of <span id="A7.p2.12.1" class="ltx_ERROR undefined">\citeappendix</span>louizos2017learning, the authors argue about a hypothetical prior that results into needing <math id="A7.p2.6.m4.1" class="ltx_Math" alttext="\lambda" display="inline"><semantics id="A7.p2.6.m4.1a"><mi id="A7.p2.6.m4.1.1" xref="A7.p2.6.m4.1.1.cmml">λ</mi><annotation-xml encoding="MathML-Content" id="A7.p2.6.m4.1b"><ci id="A7.p2.6.m4.1.1.cmml" xref="A7.p2.6.m4.1.1">𝜆</ci></annotation-xml><annotation encoding="application/x-tex" id="A7.p2.6.m4.1c">\lambda</annotation></semantics></math> nats to transform that prior to the approximate posterior. Here we make this claim more precise and show that this prior is approximately equivalent to a mixture of Gaussians prior where the precision of the non-zero prior component <math id="A7.p2.7.m5.1" class="ltx_Math" alttext="\lambda\rightarrow\epsilon" display="inline"><semantics id="A7.p2.7.m5.1a"><mrow id="A7.p2.7.m5.1.1" xref="A7.p2.7.m5.1.1.cmml"><mi id="A7.p2.7.m5.1.1.2" xref="A7.p2.7.m5.1.1.2.cmml">λ</mi><mo stretchy="false" id="A7.p2.7.m5.1.1.1" xref="A7.p2.7.m5.1.1.1.cmml">→</mo><mi id="A7.p2.7.m5.1.1.3" xref="A7.p2.7.m5.1.1.3.cmml">ϵ</mi></mrow><annotation-xml encoding="MathML-Content" id="A7.p2.7.m5.1b"><apply id="A7.p2.7.m5.1.1.cmml" xref="A7.p2.7.m5.1.1"><ci id="A7.p2.7.m5.1.1.1.cmml" xref="A7.p2.7.m5.1.1.1">→</ci><ci id="A7.p2.7.m5.1.1.2.cmml" xref="A7.p2.7.m5.1.1.2">𝜆</ci><ci id="A7.p2.7.m5.1.1.3.cmml" xref="A7.p2.7.m5.1.1.3">italic-ϵ</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A7.p2.7.m5.1c">\lambda\rightarrow\epsilon</annotation></semantics></math> (in order to avoid the <math id="A7.p2.8.m6.1" class="ltx_Math" alttext="L_{2}" display="inline"><semantics id="A7.p2.8.m6.1a"><msub id="A7.p2.8.m6.1.1" xref="A7.p2.8.m6.1.1.cmml"><mi id="A7.p2.8.m6.1.1.2" xref="A7.p2.8.m6.1.1.2.cmml">L</mi><mn id="A7.p2.8.m6.1.1.3" xref="A7.p2.8.m6.1.1.3.cmml">2</mn></msub><annotation-xml encoding="MathML-Content" id="A7.p2.8.m6.1b"><apply id="A7.p2.8.m6.1.1.cmml" xref="A7.p2.8.m6.1.1"><csymbol cd="ambiguous" id="A7.p2.8.m6.1.1.1.cmml" xref="A7.p2.8.m6.1.1">subscript</csymbol><ci id="A7.p2.8.m6.1.1.2.cmml" xref="A7.p2.8.m6.1.1.2">𝐿</ci><cn type="integer" id="A7.p2.8.m6.1.1.3.cmml" xref="A7.p2.8.m6.1.1.3">2</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A7.p2.8.m6.1c">L_{2}</annotation></semantics></math> regularization term) and the precision of the zeroth component <math id="A7.p2.9.m7.1" class="ltx_Math" alttext="\lambda_{2}" display="inline"><semantics id="A7.p2.9.m7.1a"><msub id="A7.p2.9.m7.1.1" xref="A7.p2.9.m7.1.1.cmml"><mi id="A7.p2.9.m7.1.1.2" xref="A7.p2.9.m7.1.1.2.cmml">λ</mi><mn id="A7.p2.9.m7.1.1.3" xref="A7.p2.9.m7.1.1.3.cmml">2</mn></msub><annotation-xml encoding="MathML-Content" id="A7.p2.9.m7.1b"><apply id="A7.p2.9.m7.1.1.cmml" xref="A7.p2.9.m7.1.1"><csymbol cd="ambiguous" id="A7.p2.9.m7.1.1.1.cmml" xref="A7.p2.9.m7.1.1">subscript</csymbol><ci id="A7.p2.9.m7.1.1.2.cmml" xref="A7.p2.9.m7.1.1.2">𝜆</ci><cn type="integer" id="A7.p2.9.m7.1.1.3.cmml" xref="A7.p2.9.m7.1.1.3">2</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A7.p2.9.m7.1c">\lambda_{2}</annotation></semantics></math> is equivalent to <math id="A7.p2.10.m8.2" class="ltx_Math" alttext="\lambda\exp(2\lambda_{0})" display="inline"><semantics id="A7.p2.10.m8.2a"><mrow id="A7.p2.10.m8.2.2" xref="A7.p2.10.m8.2.2.cmml"><mi id="A7.p2.10.m8.2.2.3" xref="A7.p2.10.m8.2.2.3.cmml">λ</mi><mo lspace="0.167em" rspace="0em" id="A7.p2.10.m8.2.2.2" xref="A7.p2.10.m8.2.2.2.cmml">​</mo><mrow id="A7.p2.10.m8.2.2.1.1" xref="A7.p2.10.m8.2.2.1.2.cmml"><mi id="A7.p2.10.m8.1.1" xref="A7.p2.10.m8.1.1.cmml">exp</mi><mo id="A7.p2.10.m8.2.2.1.1a" xref="A7.p2.10.m8.2.2.1.2.cmml">⁡</mo><mrow id="A7.p2.10.m8.2.2.1.1.1" xref="A7.p2.10.m8.2.2.1.2.cmml"><mo stretchy="false" id="A7.p2.10.m8.2.2.1.1.1.2" xref="A7.p2.10.m8.2.2.1.2.cmml">(</mo><mrow id="A7.p2.10.m8.2.2.1.1.1.1" xref="A7.p2.10.m8.2.2.1.1.1.1.cmml"><mn id="A7.p2.10.m8.2.2.1.1.1.1.2" xref="A7.p2.10.m8.2.2.1.1.1.1.2.cmml">2</mn><mo lspace="0em" rspace="0em" id="A7.p2.10.m8.2.2.1.1.1.1.1" xref="A7.p2.10.m8.2.2.1.1.1.1.1.cmml">​</mo><msub id="A7.p2.10.m8.2.2.1.1.1.1.3" xref="A7.p2.10.m8.2.2.1.1.1.1.3.cmml"><mi id="A7.p2.10.m8.2.2.1.1.1.1.3.2" xref="A7.p2.10.m8.2.2.1.1.1.1.3.2.cmml">λ</mi><mn id="A7.p2.10.m8.2.2.1.1.1.1.3.3" xref="A7.p2.10.m8.2.2.1.1.1.1.3.3.cmml">0</mn></msub></mrow><mo stretchy="false" id="A7.p2.10.m8.2.2.1.1.1.3" xref="A7.p2.10.m8.2.2.1.2.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="A7.p2.10.m8.2b"><apply id="A7.p2.10.m8.2.2.cmml" xref="A7.p2.10.m8.2.2"><times id="A7.p2.10.m8.2.2.2.cmml" xref="A7.p2.10.m8.2.2.2"></times><ci id="A7.p2.10.m8.2.2.3.cmml" xref="A7.p2.10.m8.2.2.3">𝜆</ci><apply id="A7.p2.10.m8.2.2.1.2.cmml" xref="A7.p2.10.m8.2.2.1.1"><exp id="A7.p2.10.m8.1.1.cmml" xref="A7.p2.10.m8.1.1"></exp><apply id="A7.p2.10.m8.2.2.1.1.1.1.cmml" xref="A7.p2.10.m8.2.2.1.1.1.1"><times id="A7.p2.10.m8.2.2.1.1.1.1.1.cmml" xref="A7.p2.10.m8.2.2.1.1.1.1.1"></times><cn type="integer" id="A7.p2.10.m8.2.2.1.1.1.1.2.cmml" xref="A7.p2.10.m8.2.2.1.1.1.1.2">2</cn><apply id="A7.p2.10.m8.2.2.1.1.1.1.3.cmml" xref="A7.p2.10.m8.2.2.1.1.1.1.3"><csymbol cd="ambiguous" id="A7.p2.10.m8.2.2.1.1.1.1.3.1.cmml" xref="A7.p2.10.m8.2.2.1.1.1.1.3">subscript</csymbol><ci id="A7.p2.10.m8.2.2.1.1.1.1.3.2.cmml" xref="A7.p2.10.m8.2.2.1.1.1.1.3.2">𝜆</ci><cn type="integer" id="A7.p2.10.m8.2.2.1.1.1.1.3.3.cmml" xref="A7.p2.10.m8.2.2.1.1.1.1.3.3">0</cn></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A7.p2.10.m8.2c">\lambda\exp(2\lambda_{0})</annotation></semantics></math>, where <math id="A7.p2.11.m9.1" class="ltx_Math" alttext="\lambda_{0}" display="inline"><semantics id="A7.p2.11.m9.1a"><msub id="A7.p2.11.m9.1.1" xref="A7.p2.11.m9.1.1.cmml"><mi id="A7.p2.11.m9.1.1.2" xref="A7.p2.11.m9.1.1.2.cmml">λ</mi><mn id="A7.p2.11.m9.1.1.3" xref="A7.p2.11.m9.1.1.3.cmml">0</mn></msub><annotation-xml encoding="MathML-Content" id="A7.p2.11.m9.1b"><apply id="A7.p2.11.m9.1.1.cmml" xref="A7.p2.11.m9.1.1"><csymbol cd="ambiguous" id="A7.p2.11.m9.1.1.1.cmml" xref="A7.p2.11.m9.1.1">subscript</csymbol><ci id="A7.p2.11.m9.1.1.2.cmml" xref="A7.p2.11.m9.1.1.2">𝜆</ci><cn type="integer" id="A7.p2.11.m9.1.1.3.cmml" xref="A7.p2.11.m9.1.1.3">0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A7.p2.11.m9.1c">\lambda_{0}</annotation></semantics></math> is the desired <math id="A7.p2.12.m10.1" class="ltx_Math" alttext="L_{0}" display="inline"><semantics id="A7.p2.12.m10.1a"><msub id="A7.p2.12.m10.1.1" xref="A7.p2.12.m10.1.1.cmml"><mi id="A7.p2.12.m10.1.1.2" xref="A7.p2.12.m10.1.1.2.cmml">L</mi><mn id="A7.p2.12.m10.1.1.3" xref="A7.p2.12.m10.1.1.3.cmml">0</mn></msub><annotation-xml encoding="MathML-Content" id="A7.p2.12.m10.1b"><apply id="A7.p2.12.m10.1.1.cmml" xref="A7.p2.12.m10.1.1"><csymbol cd="ambiguous" id="A7.p2.12.m10.1.1.1.cmml" xref="A7.p2.12.m10.1.1">subscript</csymbol><ci id="A7.p2.12.m10.1.1.2.cmml" xref="A7.p2.12.m10.1.1.2">𝐿</ci><cn type="integer" id="A7.p2.12.m10.1.1.3.cmml" xref="A7.p2.12.m10.1.1.3">0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A7.p2.12.m10.1c">L_{0}</annotation></semantics></math> regularization strength.</p>
</div>
<div id="A7.p3" class="ltx_para">
<p id="A7.p3.2" class="ltx_p">Furthermore, the cross-entropy from <math id="A7.p3.1.m1.1" class="ltx_Math" alttext="q_{\bm{\pi}_{s}}(\mathbf{z}_{s})" display="inline"><semantics id="A7.p3.1.m1.1a"><mrow id="A7.p3.1.m1.1.1" xref="A7.p3.1.m1.1.1.cmml"><msub id="A7.p3.1.m1.1.1.3" xref="A7.p3.1.m1.1.1.3.cmml"><mi id="A7.p3.1.m1.1.1.3.2" xref="A7.p3.1.m1.1.1.3.2.cmml">q</mi><msub id="A7.p3.1.m1.1.1.3.3" xref="A7.p3.1.m1.1.1.3.3.cmml"><mi id="A7.p3.1.m1.1.1.3.3.2" xref="A7.p3.1.m1.1.1.3.3.2.cmml">𝝅</mi><mi id="A7.p3.1.m1.1.1.3.3.3" xref="A7.p3.1.m1.1.1.3.3.3.cmml">s</mi></msub></msub><mo lspace="0em" rspace="0em" id="A7.p3.1.m1.1.1.2" xref="A7.p3.1.m1.1.1.2.cmml">​</mo><mrow id="A7.p3.1.m1.1.1.1.1" xref="A7.p3.1.m1.1.1.1.1.1.cmml"><mo stretchy="false" id="A7.p3.1.m1.1.1.1.1.2" xref="A7.p3.1.m1.1.1.1.1.1.cmml">(</mo><msub id="A7.p3.1.m1.1.1.1.1.1" xref="A7.p3.1.m1.1.1.1.1.1.cmml"><mi id="A7.p3.1.m1.1.1.1.1.1.2" xref="A7.p3.1.m1.1.1.1.1.1.2.cmml">𝐳</mi><mi id="A7.p3.1.m1.1.1.1.1.1.3" xref="A7.p3.1.m1.1.1.1.1.1.3.cmml">s</mi></msub><mo stretchy="false" id="A7.p3.1.m1.1.1.1.1.3" xref="A7.p3.1.m1.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="A7.p3.1.m1.1b"><apply id="A7.p3.1.m1.1.1.cmml" xref="A7.p3.1.m1.1.1"><times id="A7.p3.1.m1.1.1.2.cmml" xref="A7.p3.1.m1.1.1.2"></times><apply id="A7.p3.1.m1.1.1.3.cmml" xref="A7.p3.1.m1.1.1.3"><csymbol cd="ambiguous" id="A7.p3.1.m1.1.1.3.1.cmml" xref="A7.p3.1.m1.1.1.3">subscript</csymbol><ci id="A7.p3.1.m1.1.1.3.2.cmml" xref="A7.p3.1.m1.1.1.3.2">𝑞</ci><apply id="A7.p3.1.m1.1.1.3.3.cmml" xref="A7.p3.1.m1.1.1.3.3"><csymbol cd="ambiguous" id="A7.p3.1.m1.1.1.3.3.1.cmml" xref="A7.p3.1.m1.1.1.3.3">subscript</csymbol><ci id="A7.p3.1.m1.1.1.3.3.2.cmml" xref="A7.p3.1.m1.1.1.3.3.2">𝝅</ci><ci id="A7.p3.1.m1.1.1.3.3.3.cmml" xref="A7.p3.1.m1.1.1.3.3.3">𝑠</ci></apply></apply><apply id="A7.p3.1.m1.1.1.1.1.1.cmml" xref="A7.p3.1.m1.1.1.1.1"><csymbol cd="ambiguous" id="A7.p3.1.m1.1.1.1.1.1.1.cmml" xref="A7.p3.1.m1.1.1.1.1">subscript</csymbol><ci id="A7.p3.1.m1.1.1.1.1.1.2.cmml" xref="A7.p3.1.m1.1.1.1.1.1.2">𝐳</ci><ci id="A7.p3.1.m1.1.1.1.1.1.3.cmml" xref="A7.p3.1.m1.1.1.1.1.1.3">𝑠</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A7.p3.1.m1.1c">q_{\bm{\pi}_{s}}(\mathbf{z}_{s})</annotation></semantics></math> to <math id="A7.p3.2.m2.1" class="ltx_Math" alttext="p(\mathbf{z}_{s}|\bm{\theta})" display="inline"><semantics id="A7.p3.2.m2.1a"><mrow id="A7.p3.2.m2.1.1" xref="A7.p3.2.m2.1.1.cmml"><mi id="A7.p3.2.m2.1.1.3" xref="A7.p3.2.m2.1.1.3.cmml">p</mi><mo lspace="0em" rspace="0em" id="A7.p3.2.m2.1.1.2" xref="A7.p3.2.m2.1.1.2.cmml">​</mo><mrow id="A7.p3.2.m2.1.1.1.1" xref="A7.p3.2.m2.1.1.1.1.1.cmml"><mo stretchy="false" id="A7.p3.2.m2.1.1.1.1.2" xref="A7.p3.2.m2.1.1.1.1.1.cmml">(</mo><mrow id="A7.p3.2.m2.1.1.1.1.1" xref="A7.p3.2.m2.1.1.1.1.1.cmml"><msub id="A7.p3.2.m2.1.1.1.1.1.2" xref="A7.p3.2.m2.1.1.1.1.1.2.cmml"><mi id="A7.p3.2.m2.1.1.1.1.1.2.2" xref="A7.p3.2.m2.1.1.1.1.1.2.2.cmml">𝐳</mi><mi id="A7.p3.2.m2.1.1.1.1.1.2.3" xref="A7.p3.2.m2.1.1.1.1.1.2.3.cmml">s</mi></msub><mo fence="false" id="A7.p3.2.m2.1.1.1.1.1.1" xref="A7.p3.2.m2.1.1.1.1.1.1.cmml">|</mo><mi id="A7.p3.2.m2.1.1.1.1.1.3" xref="A7.p3.2.m2.1.1.1.1.1.3.cmml">𝜽</mi></mrow><mo stretchy="false" id="A7.p3.2.m2.1.1.1.1.3" xref="A7.p3.2.m2.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="A7.p3.2.m2.1b"><apply id="A7.p3.2.m2.1.1.cmml" xref="A7.p3.2.m2.1.1"><times id="A7.p3.2.m2.1.1.2.cmml" xref="A7.p3.2.m2.1.1.2"></times><ci id="A7.p3.2.m2.1.1.3.cmml" xref="A7.p3.2.m2.1.1.3">𝑝</ci><apply id="A7.p3.2.m2.1.1.1.1.1.cmml" xref="A7.p3.2.m2.1.1.1.1"><csymbol cd="latexml" id="A7.p3.2.m2.1.1.1.1.1.1.cmml" xref="A7.p3.2.m2.1.1.1.1.1.1">conditional</csymbol><apply id="A7.p3.2.m2.1.1.1.1.1.2.cmml" xref="A7.p3.2.m2.1.1.1.1.1.2"><csymbol cd="ambiguous" id="A7.p3.2.m2.1.1.1.1.1.2.1.cmml" xref="A7.p3.2.m2.1.1.1.1.1.2">subscript</csymbol><ci id="A7.p3.2.m2.1.1.1.1.1.2.2.cmml" xref="A7.p3.2.m2.1.1.1.1.1.2.2">𝐳</ci><ci id="A7.p3.2.m2.1.1.1.1.1.2.3.cmml" xref="A7.p3.2.m2.1.1.1.1.1.2.3">𝑠</ci></apply><ci id="A7.p3.2.m2.1.1.1.1.1.3.cmml" xref="A7.p3.2.m2.1.1.1.1.1.3">𝜽</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A7.p3.2.m2.1c">p(\mathbf{z}_{s}|\bm{\theta})</annotation></semantics></math> is straightforward to compute as</p>
<table id="A10.EGx31" class="ltx_equationgroup ltx_eqn_align ltx_eqn_table">

<tbody id="A7.E38"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math id="A7.E38.m1.3" class="ltx_Math" alttext="\displaystyle\mathbb{E}_{q_{\bm{\pi}_{s}}(\mathbf{z}_{s})}[\log p(\mathbf{z}_{s}|\bm{\theta})]=\sum_{j}\left(\bm{\pi}_{sj}\log\bm{\theta}_{j}+(1-\bm{\pi}_{sj})\log(1-\bm{\theta}_{j})\right)." display="inline"><semantics id="A7.E38.m1.3a"><mrow id="A7.E38.m1.3.3.1" xref="A7.E38.m1.3.3.1.1.cmml"><mrow id="A7.E38.m1.3.3.1.1" xref="A7.E38.m1.3.3.1.1.cmml"><mrow id="A7.E38.m1.3.3.1.1.1" xref="A7.E38.m1.3.3.1.1.1.cmml"><msub id="A7.E38.m1.3.3.1.1.1.3" xref="A7.E38.m1.3.3.1.1.1.3.cmml"><mi id="A7.E38.m1.3.3.1.1.1.3.2" xref="A7.E38.m1.3.3.1.1.1.3.2.cmml">𝔼</mi><mrow id="A7.E38.m1.1.1.1" xref="A7.E38.m1.1.1.1.cmml"><msub id="A7.E38.m1.1.1.1.3" xref="A7.E38.m1.1.1.1.3.cmml"><mi id="A7.E38.m1.1.1.1.3.2" xref="A7.E38.m1.1.1.1.3.2.cmml">q</mi><msub id="A7.E38.m1.1.1.1.3.3" xref="A7.E38.m1.1.1.1.3.3.cmml"><mi id="A7.E38.m1.1.1.1.3.3.2" xref="A7.E38.m1.1.1.1.3.3.2.cmml">𝝅</mi><mi id="A7.E38.m1.1.1.1.3.3.3" xref="A7.E38.m1.1.1.1.3.3.3.cmml">s</mi></msub></msub><mo lspace="0em" rspace="0em" id="A7.E38.m1.1.1.1.2" xref="A7.E38.m1.1.1.1.2.cmml">​</mo><mrow id="A7.E38.m1.1.1.1.1.1" xref="A7.E38.m1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="A7.E38.m1.1.1.1.1.1.2" xref="A7.E38.m1.1.1.1.1.1.1.cmml">(</mo><msub id="A7.E38.m1.1.1.1.1.1.1" xref="A7.E38.m1.1.1.1.1.1.1.cmml"><mi id="A7.E38.m1.1.1.1.1.1.1.2" xref="A7.E38.m1.1.1.1.1.1.1.2.cmml">𝐳</mi><mi id="A7.E38.m1.1.1.1.1.1.1.3" xref="A7.E38.m1.1.1.1.1.1.1.3.cmml">s</mi></msub><mo stretchy="false" id="A7.E38.m1.1.1.1.1.1.3" xref="A7.E38.m1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></msub><mo lspace="0em" rspace="0em" id="A7.E38.m1.3.3.1.1.1.2" xref="A7.E38.m1.3.3.1.1.1.2.cmml">​</mo><mrow id="A7.E38.m1.3.3.1.1.1.1.1" xref="A7.E38.m1.3.3.1.1.1.1.2.cmml"><mo stretchy="false" id="A7.E38.m1.3.3.1.1.1.1.1.2" xref="A7.E38.m1.3.3.1.1.1.1.2.1.cmml">[</mo><mrow id="A7.E38.m1.3.3.1.1.1.1.1.1" xref="A7.E38.m1.3.3.1.1.1.1.1.1.cmml"><mrow id="A7.E38.m1.3.3.1.1.1.1.1.1.3" xref="A7.E38.m1.3.3.1.1.1.1.1.1.3.cmml"><mi id="A7.E38.m1.3.3.1.1.1.1.1.1.3.1" xref="A7.E38.m1.3.3.1.1.1.1.1.1.3.1.cmml">log</mi><mo lspace="0.167em" id="A7.E38.m1.3.3.1.1.1.1.1.1.3a" xref="A7.E38.m1.3.3.1.1.1.1.1.1.3.cmml">⁡</mo><mi id="A7.E38.m1.3.3.1.1.1.1.1.1.3.2" xref="A7.E38.m1.3.3.1.1.1.1.1.1.3.2.cmml">p</mi></mrow><mo lspace="0em" rspace="0em" id="A7.E38.m1.3.3.1.1.1.1.1.1.2" xref="A7.E38.m1.3.3.1.1.1.1.1.1.2.cmml">​</mo><mrow id="A7.E38.m1.3.3.1.1.1.1.1.1.1.1" xref="A7.E38.m1.3.3.1.1.1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="A7.E38.m1.3.3.1.1.1.1.1.1.1.1.2" xref="A7.E38.m1.3.3.1.1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="A7.E38.m1.3.3.1.1.1.1.1.1.1.1.1" xref="A7.E38.m1.3.3.1.1.1.1.1.1.1.1.1.cmml"><msub id="A7.E38.m1.3.3.1.1.1.1.1.1.1.1.1.2" xref="A7.E38.m1.3.3.1.1.1.1.1.1.1.1.1.2.cmml"><mi id="A7.E38.m1.3.3.1.1.1.1.1.1.1.1.1.2.2" xref="A7.E38.m1.3.3.1.1.1.1.1.1.1.1.1.2.2.cmml">𝐳</mi><mi id="A7.E38.m1.3.3.1.1.1.1.1.1.1.1.1.2.3" xref="A7.E38.m1.3.3.1.1.1.1.1.1.1.1.1.2.3.cmml">s</mi></msub><mo fence="false" id="A7.E38.m1.3.3.1.1.1.1.1.1.1.1.1.1" xref="A7.E38.m1.3.3.1.1.1.1.1.1.1.1.1.1.cmml">|</mo><mi id="A7.E38.m1.3.3.1.1.1.1.1.1.1.1.1.3" xref="A7.E38.m1.3.3.1.1.1.1.1.1.1.1.1.3.cmml">𝜽</mi></mrow><mo stretchy="false" id="A7.E38.m1.3.3.1.1.1.1.1.1.1.1.3" xref="A7.E38.m1.3.3.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo stretchy="false" id="A7.E38.m1.3.3.1.1.1.1.1.3" xref="A7.E38.m1.3.3.1.1.1.1.2.1.cmml">]</mo></mrow></mrow><mo id="A7.E38.m1.3.3.1.1.3" xref="A7.E38.m1.3.3.1.1.3.cmml">=</mo><mrow id="A7.E38.m1.3.3.1.1.2" xref="A7.E38.m1.3.3.1.1.2.cmml"><mstyle displaystyle="true" id="A7.E38.m1.3.3.1.1.2.2" xref="A7.E38.m1.3.3.1.1.2.2.cmml"><munder id="A7.E38.m1.3.3.1.1.2.2a" xref="A7.E38.m1.3.3.1.1.2.2.cmml"><mo movablelimits="false" id="A7.E38.m1.3.3.1.1.2.2.2" xref="A7.E38.m1.3.3.1.1.2.2.2.cmml">∑</mo><mi id="A7.E38.m1.3.3.1.1.2.2.3" xref="A7.E38.m1.3.3.1.1.2.2.3.cmml">j</mi></munder></mstyle><mrow id="A7.E38.m1.3.3.1.1.2.1.1" xref="A7.E38.m1.3.3.1.1.2.1.1.1.cmml"><mo id="A7.E38.m1.3.3.1.1.2.1.1.2" xref="A7.E38.m1.3.3.1.1.2.1.1.1.cmml">(</mo><mrow id="A7.E38.m1.3.3.1.1.2.1.1.1" xref="A7.E38.m1.3.3.1.1.2.1.1.1.cmml"><mrow id="A7.E38.m1.3.3.1.1.2.1.1.1.4" xref="A7.E38.m1.3.3.1.1.2.1.1.1.4.cmml"><msub id="A7.E38.m1.3.3.1.1.2.1.1.1.4.2" xref="A7.E38.m1.3.3.1.1.2.1.1.1.4.2.cmml"><mi id="A7.E38.m1.3.3.1.1.2.1.1.1.4.2.2" xref="A7.E38.m1.3.3.1.1.2.1.1.1.4.2.2.cmml">𝝅</mi><mrow id="A7.E38.m1.3.3.1.1.2.1.1.1.4.2.3" xref="A7.E38.m1.3.3.1.1.2.1.1.1.4.2.3.cmml"><mi id="A7.E38.m1.3.3.1.1.2.1.1.1.4.2.3.2" xref="A7.E38.m1.3.3.1.1.2.1.1.1.4.2.3.2.cmml">s</mi><mo lspace="0em" rspace="0em" id="A7.E38.m1.3.3.1.1.2.1.1.1.4.2.3.1" xref="A7.E38.m1.3.3.1.1.2.1.1.1.4.2.3.1.cmml">​</mo><mi id="A7.E38.m1.3.3.1.1.2.1.1.1.4.2.3.3" xref="A7.E38.m1.3.3.1.1.2.1.1.1.4.2.3.3.cmml">j</mi></mrow></msub><mo lspace="0.167em" rspace="0em" id="A7.E38.m1.3.3.1.1.2.1.1.1.4.1" xref="A7.E38.m1.3.3.1.1.2.1.1.1.4.1.cmml">​</mo><mrow id="A7.E38.m1.3.3.1.1.2.1.1.1.4.3" xref="A7.E38.m1.3.3.1.1.2.1.1.1.4.3.cmml"><mi id="A7.E38.m1.3.3.1.1.2.1.1.1.4.3.1" xref="A7.E38.m1.3.3.1.1.2.1.1.1.4.3.1.cmml">log</mi><mo lspace="0.167em" id="A7.E38.m1.3.3.1.1.2.1.1.1.4.3a" xref="A7.E38.m1.3.3.1.1.2.1.1.1.4.3.cmml">⁡</mo><msub id="A7.E38.m1.3.3.1.1.2.1.1.1.4.3.2" xref="A7.E38.m1.3.3.1.1.2.1.1.1.4.3.2.cmml"><mi id="A7.E38.m1.3.3.1.1.2.1.1.1.4.3.2.2" xref="A7.E38.m1.3.3.1.1.2.1.1.1.4.3.2.2.cmml">𝜽</mi><mi id="A7.E38.m1.3.3.1.1.2.1.1.1.4.3.2.3" xref="A7.E38.m1.3.3.1.1.2.1.1.1.4.3.2.3.cmml">j</mi></msub></mrow></mrow><mo id="A7.E38.m1.3.3.1.1.2.1.1.1.3" xref="A7.E38.m1.3.3.1.1.2.1.1.1.3.cmml">+</mo><mrow id="A7.E38.m1.3.3.1.1.2.1.1.1.2" xref="A7.E38.m1.3.3.1.1.2.1.1.1.2.cmml"><mrow id="A7.E38.m1.3.3.1.1.2.1.1.1.1.1.1" xref="A7.E38.m1.3.3.1.1.2.1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="A7.E38.m1.3.3.1.1.2.1.1.1.1.1.1.2" xref="A7.E38.m1.3.3.1.1.2.1.1.1.1.1.1.1.cmml">(</mo><mrow id="A7.E38.m1.3.3.1.1.2.1.1.1.1.1.1.1" xref="A7.E38.m1.3.3.1.1.2.1.1.1.1.1.1.1.cmml"><mn id="A7.E38.m1.3.3.1.1.2.1.1.1.1.1.1.1.2" xref="A7.E38.m1.3.3.1.1.2.1.1.1.1.1.1.1.2.cmml">1</mn><mo id="A7.E38.m1.3.3.1.1.2.1.1.1.1.1.1.1.1" xref="A7.E38.m1.3.3.1.1.2.1.1.1.1.1.1.1.1.cmml">−</mo><msub id="A7.E38.m1.3.3.1.1.2.1.1.1.1.1.1.1.3" xref="A7.E38.m1.3.3.1.1.2.1.1.1.1.1.1.1.3.cmml"><mi id="A7.E38.m1.3.3.1.1.2.1.1.1.1.1.1.1.3.2" xref="A7.E38.m1.3.3.1.1.2.1.1.1.1.1.1.1.3.2.cmml">𝝅</mi><mrow id="A7.E38.m1.3.3.1.1.2.1.1.1.1.1.1.1.3.3" xref="A7.E38.m1.3.3.1.1.2.1.1.1.1.1.1.1.3.3.cmml"><mi id="A7.E38.m1.3.3.1.1.2.1.1.1.1.1.1.1.3.3.2" xref="A7.E38.m1.3.3.1.1.2.1.1.1.1.1.1.1.3.3.2.cmml">s</mi><mo lspace="0em" rspace="0em" id="A7.E38.m1.3.3.1.1.2.1.1.1.1.1.1.1.3.3.1" xref="A7.E38.m1.3.3.1.1.2.1.1.1.1.1.1.1.3.3.1.cmml">​</mo><mi id="A7.E38.m1.3.3.1.1.2.1.1.1.1.1.1.1.3.3.3" xref="A7.E38.m1.3.3.1.1.2.1.1.1.1.1.1.1.3.3.3.cmml">j</mi></mrow></msub></mrow><mo stretchy="false" id="A7.E38.m1.3.3.1.1.2.1.1.1.1.1.1.3" xref="A7.E38.m1.3.3.1.1.2.1.1.1.1.1.1.1.cmml">)</mo></mrow><mo lspace="0.167em" rspace="0em" id="A7.E38.m1.3.3.1.1.2.1.1.1.2.3" xref="A7.E38.m1.3.3.1.1.2.1.1.1.2.3.cmml">​</mo><mrow id="A7.E38.m1.3.3.1.1.2.1.1.1.2.2.1" xref="A7.E38.m1.3.3.1.1.2.1.1.1.2.2.2.cmml"><mi id="A7.E38.m1.2.2" xref="A7.E38.m1.2.2.cmml">log</mi><mo id="A7.E38.m1.3.3.1.1.2.1.1.1.2.2.1a" xref="A7.E38.m1.3.3.1.1.2.1.1.1.2.2.2.cmml">⁡</mo><mrow id="A7.E38.m1.3.3.1.1.2.1.1.1.2.2.1.1" xref="A7.E38.m1.3.3.1.1.2.1.1.1.2.2.2.cmml"><mo stretchy="false" id="A7.E38.m1.3.3.1.1.2.1.1.1.2.2.1.1.2" xref="A7.E38.m1.3.3.1.1.2.1.1.1.2.2.2.cmml">(</mo><mrow id="A7.E38.m1.3.3.1.1.2.1.1.1.2.2.1.1.1" xref="A7.E38.m1.3.3.1.1.2.1.1.1.2.2.1.1.1.cmml"><mn id="A7.E38.m1.3.3.1.1.2.1.1.1.2.2.1.1.1.2" xref="A7.E38.m1.3.3.1.1.2.1.1.1.2.2.1.1.1.2.cmml">1</mn><mo id="A7.E38.m1.3.3.1.1.2.1.1.1.2.2.1.1.1.1" xref="A7.E38.m1.3.3.1.1.2.1.1.1.2.2.1.1.1.1.cmml">−</mo><msub id="A7.E38.m1.3.3.1.1.2.1.1.1.2.2.1.1.1.3" xref="A7.E38.m1.3.3.1.1.2.1.1.1.2.2.1.1.1.3.cmml"><mi id="A7.E38.m1.3.3.1.1.2.1.1.1.2.2.1.1.1.3.2" xref="A7.E38.m1.3.3.1.1.2.1.1.1.2.2.1.1.1.3.2.cmml">𝜽</mi><mi id="A7.E38.m1.3.3.1.1.2.1.1.1.2.2.1.1.1.3.3" xref="A7.E38.m1.3.3.1.1.2.1.1.1.2.2.1.1.1.3.3.cmml">j</mi></msub></mrow><mo stretchy="false" id="A7.E38.m1.3.3.1.1.2.1.1.1.2.2.1.1.3" xref="A7.E38.m1.3.3.1.1.2.1.1.1.2.2.2.cmml">)</mo></mrow></mrow></mrow></mrow><mo id="A7.E38.m1.3.3.1.1.2.1.1.3" xref="A7.E38.m1.3.3.1.1.2.1.1.1.cmml">)</mo></mrow></mrow></mrow><mo lspace="0em" id="A7.E38.m1.3.3.1.2" xref="A7.E38.m1.3.3.1.1.cmml">.</mo></mrow><annotation-xml encoding="MathML-Content" id="A7.E38.m1.3b"><apply id="A7.E38.m1.3.3.1.1.cmml" xref="A7.E38.m1.3.3.1"><eq id="A7.E38.m1.3.3.1.1.3.cmml" xref="A7.E38.m1.3.3.1.1.3"></eq><apply id="A7.E38.m1.3.3.1.1.1.cmml" xref="A7.E38.m1.3.3.1.1.1"><times id="A7.E38.m1.3.3.1.1.1.2.cmml" xref="A7.E38.m1.3.3.1.1.1.2"></times><apply id="A7.E38.m1.3.3.1.1.1.3.cmml" xref="A7.E38.m1.3.3.1.1.1.3"><csymbol cd="ambiguous" id="A7.E38.m1.3.3.1.1.1.3.1.cmml" xref="A7.E38.m1.3.3.1.1.1.3">subscript</csymbol><ci id="A7.E38.m1.3.3.1.1.1.3.2.cmml" xref="A7.E38.m1.3.3.1.1.1.3.2">𝔼</ci><apply id="A7.E38.m1.1.1.1.cmml" xref="A7.E38.m1.1.1.1"><times id="A7.E38.m1.1.1.1.2.cmml" xref="A7.E38.m1.1.1.1.2"></times><apply id="A7.E38.m1.1.1.1.3.cmml" xref="A7.E38.m1.1.1.1.3"><csymbol cd="ambiguous" id="A7.E38.m1.1.1.1.3.1.cmml" xref="A7.E38.m1.1.1.1.3">subscript</csymbol><ci id="A7.E38.m1.1.1.1.3.2.cmml" xref="A7.E38.m1.1.1.1.3.2">𝑞</ci><apply id="A7.E38.m1.1.1.1.3.3.cmml" xref="A7.E38.m1.1.1.1.3.3"><csymbol cd="ambiguous" id="A7.E38.m1.1.1.1.3.3.1.cmml" xref="A7.E38.m1.1.1.1.3.3">subscript</csymbol><ci id="A7.E38.m1.1.1.1.3.3.2.cmml" xref="A7.E38.m1.1.1.1.3.3.2">𝝅</ci><ci id="A7.E38.m1.1.1.1.3.3.3.cmml" xref="A7.E38.m1.1.1.1.3.3.3">𝑠</ci></apply></apply><apply id="A7.E38.m1.1.1.1.1.1.1.cmml" xref="A7.E38.m1.1.1.1.1.1"><csymbol cd="ambiguous" id="A7.E38.m1.1.1.1.1.1.1.1.cmml" xref="A7.E38.m1.1.1.1.1.1">subscript</csymbol><ci id="A7.E38.m1.1.1.1.1.1.1.2.cmml" xref="A7.E38.m1.1.1.1.1.1.1.2">𝐳</ci><ci id="A7.E38.m1.1.1.1.1.1.1.3.cmml" xref="A7.E38.m1.1.1.1.1.1.1.3">𝑠</ci></apply></apply></apply><apply id="A7.E38.m1.3.3.1.1.1.1.2.cmml" xref="A7.E38.m1.3.3.1.1.1.1.1"><csymbol cd="latexml" id="A7.E38.m1.3.3.1.1.1.1.2.1.cmml" xref="A7.E38.m1.3.3.1.1.1.1.1.2">delimited-[]</csymbol><apply id="A7.E38.m1.3.3.1.1.1.1.1.1.cmml" xref="A7.E38.m1.3.3.1.1.1.1.1.1"><times id="A7.E38.m1.3.3.1.1.1.1.1.1.2.cmml" xref="A7.E38.m1.3.3.1.1.1.1.1.1.2"></times><apply id="A7.E38.m1.3.3.1.1.1.1.1.1.3.cmml" xref="A7.E38.m1.3.3.1.1.1.1.1.1.3"><log id="A7.E38.m1.3.3.1.1.1.1.1.1.3.1.cmml" xref="A7.E38.m1.3.3.1.1.1.1.1.1.3.1"></log><ci id="A7.E38.m1.3.3.1.1.1.1.1.1.3.2.cmml" xref="A7.E38.m1.3.3.1.1.1.1.1.1.3.2">𝑝</ci></apply><apply id="A7.E38.m1.3.3.1.1.1.1.1.1.1.1.1.cmml" xref="A7.E38.m1.3.3.1.1.1.1.1.1.1.1"><csymbol cd="latexml" id="A7.E38.m1.3.3.1.1.1.1.1.1.1.1.1.1.cmml" xref="A7.E38.m1.3.3.1.1.1.1.1.1.1.1.1.1">conditional</csymbol><apply id="A7.E38.m1.3.3.1.1.1.1.1.1.1.1.1.2.cmml" xref="A7.E38.m1.3.3.1.1.1.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="A7.E38.m1.3.3.1.1.1.1.1.1.1.1.1.2.1.cmml" xref="A7.E38.m1.3.3.1.1.1.1.1.1.1.1.1.2">subscript</csymbol><ci id="A7.E38.m1.3.3.1.1.1.1.1.1.1.1.1.2.2.cmml" xref="A7.E38.m1.3.3.1.1.1.1.1.1.1.1.1.2.2">𝐳</ci><ci id="A7.E38.m1.3.3.1.1.1.1.1.1.1.1.1.2.3.cmml" xref="A7.E38.m1.3.3.1.1.1.1.1.1.1.1.1.2.3">𝑠</ci></apply><ci id="A7.E38.m1.3.3.1.1.1.1.1.1.1.1.1.3.cmml" xref="A7.E38.m1.3.3.1.1.1.1.1.1.1.1.1.3">𝜽</ci></apply></apply></apply></apply><apply id="A7.E38.m1.3.3.1.1.2.cmml" xref="A7.E38.m1.3.3.1.1.2"><apply id="A7.E38.m1.3.3.1.1.2.2.cmml" xref="A7.E38.m1.3.3.1.1.2.2"><csymbol cd="ambiguous" id="A7.E38.m1.3.3.1.1.2.2.1.cmml" xref="A7.E38.m1.3.3.1.1.2.2">subscript</csymbol><sum id="A7.E38.m1.3.3.1.1.2.2.2.cmml" xref="A7.E38.m1.3.3.1.1.2.2.2"></sum><ci id="A7.E38.m1.3.3.1.1.2.2.3.cmml" xref="A7.E38.m1.3.3.1.1.2.2.3">𝑗</ci></apply><apply id="A7.E38.m1.3.3.1.1.2.1.1.1.cmml" xref="A7.E38.m1.3.3.1.1.2.1.1"><plus id="A7.E38.m1.3.3.1.1.2.1.1.1.3.cmml" xref="A7.E38.m1.3.3.1.1.2.1.1.1.3"></plus><apply id="A7.E38.m1.3.3.1.1.2.1.1.1.4.cmml" xref="A7.E38.m1.3.3.1.1.2.1.1.1.4"><times id="A7.E38.m1.3.3.1.1.2.1.1.1.4.1.cmml" xref="A7.E38.m1.3.3.1.1.2.1.1.1.4.1"></times><apply id="A7.E38.m1.3.3.1.1.2.1.1.1.4.2.cmml" xref="A7.E38.m1.3.3.1.1.2.1.1.1.4.2"><csymbol cd="ambiguous" id="A7.E38.m1.3.3.1.1.2.1.1.1.4.2.1.cmml" xref="A7.E38.m1.3.3.1.1.2.1.1.1.4.2">subscript</csymbol><ci id="A7.E38.m1.3.3.1.1.2.1.1.1.4.2.2.cmml" xref="A7.E38.m1.3.3.1.1.2.1.1.1.4.2.2">𝝅</ci><apply id="A7.E38.m1.3.3.1.1.2.1.1.1.4.2.3.cmml" xref="A7.E38.m1.3.3.1.1.2.1.1.1.4.2.3"><times id="A7.E38.m1.3.3.1.1.2.1.1.1.4.2.3.1.cmml" xref="A7.E38.m1.3.3.1.1.2.1.1.1.4.2.3.1"></times><ci id="A7.E38.m1.3.3.1.1.2.1.1.1.4.2.3.2.cmml" xref="A7.E38.m1.3.3.1.1.2.1.1.1.4.2.3.2">𝑠</ci><ci id="A7.E38.m1.3.3.1.1.2.1.1.1.4.2.3.3.cmml" xref="A7.E38.m1.3.3.1.1.2.1.1.1.4.2.3.3">𝑗</ci></apply></apply><apply id="A7.E38.m1.3.3.1.1.2.1.1.1.4.3.cmml" xref="A7.E38.m1.3.3.1.1.2.1.1.1.4.3"><log id="A7.E38.m1.3.3.1.1.2.1.1.1.4.3.1.cmml" xref="A7.E38.m1.3.3.1.1.2.1.1.1.4.3.1"></log><apply id="A7.E38.m1.3.3.1.1.2.1.1.1.4.3.2.cmml" xref="A7.E38.m1.3.3.1.1.2.1.1.1.4.3.2"><csymbol cd="ambiguous" id="A7.E38.m1.3.3.1.1.2.1.1.1.4.3.2.1.cmml" xref="A7.E38.m1.3.3.1.1.2.1.1.1.4.3.2">subscript</csymbol><ci id="A7.E38.m1.3.3.1.1.2.1.1.1.4.3.2.2.cmml" xref="A7.E38.m1.3.3.1.1.2.1.1.1.4.3.2.2">𝜽</ci><ci id="A7.E38.m1.3.3.1.1.2.1.1.1.4.3.2.3.cmml" xref="A7.E38.m1.3.3.1.1.2.1.1.1.4.3.2.3">𝑗</ci></apply></apply></apply><apply id="A7.E38.m1.3.3.1.1.2.1.1.1.2.cmml" xref="A7.E38.m1.3.3.1.1.2.1.1.1.2"><times id="A7.E38.m1.3.3.1.1.2.1.1.1.2.3.cmml" xref="A7.E38.m1.3.3.1.1.2.1.1.1.2.3"></times><apply id="A7.E38.m1.3.3.1.1.2.1.1.1.1.1.1.1.cmml" xref="A7.E38.m1.3.3.1.1.2.1.1.1.1.1.1"><minus id="A7.E38.m1.3.3.1.1.2.1.1.1.1.1.1.1.1.cmml" xref="A7.E38.m1.3.3.1.1.2.1.1.1.1.1.1.1.1"></minus><cn type="integer" id="A7.E38.m1.3.3.1.1.2.1.1.1.1.1.1.1.2.cmml" xref="A7.E38.m1.3.3.1.1.2.1.1.1.1.1.1.1.2">1</cn><apply id="A7.E38.m1.3.3.1.1.2.1.1.1.1.1.1.1.3.cmml" xref="A7.E38.m1.3.3.1.1.2.1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="A7.E38.m1.3.3.1.1.2.1.1.1.1.1.1.1.3.1.cmml" xref="A7.E38.m1.3.3.1.1.2.1.1.1.1.1.1.1.3">subscript</csymbol><ci id="A7.E38.m1.3.3.1.1.2.1.1.1.1.1.1.1.3.2.cmml" xref="A7.E38.m1.3.3.1.1.2.1.1.1.1.1.1.1.3.2">𝝅</ci><apply id="A7.E38.m1.3.3.1.1.2.1.1.1.1.1.1.1.3.3.cmml" xref="A7.E38.m1.3.3.1.1.2.1.1.1.1.1.1.1.3.3"><times id="A7.E38.m1.3.3.1.1.2.1.1.1.1.1.1.1.3.3.1.cmml" xref="A7.E38.m1.3.3.1.1.2.1.1.1.1.1.1.1.3.3.1"></times><ci id="A7.E38.m1.3.3.1.1.2.1.1.1.1.1.1.1.3.3.2.cmml" xref="A7.E38.m1.3.3.1.1.2.1.1.1.1.1.1.1.3.3.2">𝑠</ci><ci id="A7.E38.m1.3.3.1.1.2.1.1.1.1.1.1.1.3.3.3.cmml" xref="A7.E38.m1.3.3.1.1.2.1.1.1.1.1.1.1.3.3.3">𝑗</ci></apply></apply></apply><apply id="A7.E38.m1.3.3.1.1.2.1.1.1.2.2.2.cmml" xref="A7.E38.m1.3.3.1.1.2.1.1.1.2.2.1"><log id="A7.E38.m1.2.2.cmml" xref="A7.E38.m1.2.2"></log><apply id="A7.E38.m1.3.3.1.1.2.1.1.1.2.2.1.1.1.cmml" xref="A7.E38.m1.3.3.1.1.2.1.1.1.2.2.1.1.1"><minus id="A7.E38.m1.3.3.1.1.2.1.1.1.2.2.1.1.1.1.cmml" xref="A7.E38.m1.3.3.1.1.2.1.1.1.2.2.1.1.1.1"></minus><cn type="integer" id="A7.E38.m1.3.3.1.1.2.1.1.1.2.2.1.1.1.2.cmml" xref="A7.E38.m1.3.3.1.1.2.1.1.1.2.2.1.1.1.2">1</cn><apply id="A7.E38.m1.3.3.1.1.2.1.1.1.2.2.1.1.1.3.cmml" xref="A7.E38.m1.3.3.1.1.2.1.1.1.2.2.1.1.1.3"><csymbol cd="ambiguous" id="A7.E38.m1.3.3.1.1.2.1.1.1.2.2.1.1.1.3.1.cmml" xref="A7.E38.m1.3.3.1.1.2.1.1.1.2.2.1.1.1.3">subscript</csymbol><ci id="A7.E38.m1.3.3.1.1.2.1.1.1.2.2.1.1.1.3.2.cmml" xref="A7.E38.m1.3.3.1.1.2.1.1.1.2.2.1.1.1.3.2">𝜽</ci><ci id="A7.E38.m1.3.3.1.1.2.1.1.1.2.2.1.1.1.3.3.cmml" xref="A7.E38.m1.3.3.1.1.2.1.1.1.2.2.1.1.1.3.3">𝑗</ci></apply></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A7.E38.m1.3c">\displaystyle\mathbb{E}_{q_{\bm{\pi}_{s}}(\mathbf{z}_{s})}[\log p(\mathbf{z}_{s}|\bm{\theta})]=\sum_{j}\left(\bm{\pi}_{sj}\log\bm{\theta}_{j}+(1-\bm{\pi}_{sj})\log(1-\bm{\theta}_{j})\right).</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(38)</span></td>
</tr></tbody>
</table>
<p id="A7.p3.3" class="ltx_p">By putting everything together we have that the local objective becomes</p>
<table id="A10.EGx32" class="ltx_equationgroup ltx_eqn_align ltx_eqn_table">

<tbody id="A7.Ex5"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math id="A7.Ex5.m1.4" class="ltx_Math" alttext="\displaystyle\operatorname*{arg\,max}_{\mathbf{w}_{s},\bm{\pi}_{s}}\mathbb{E}_{q_{\bm{\pi}_{s}}(\mathbf{z}_{s})}\left[\sum_{i}^{N_{s}}L(\mathcal{D}_{si},\mathbf{w}_{s}\odot\mathbf{z}_{s})\right]" display="inline"><semantics id="A7.Ex5.m1.4a"><mrow id="A7.Ex5.m1.4.4" xref="A7.Ex5.m1.4.4.cmml"><mrow id="A7.Ex5.m1.4.4.3" xref="A7.Ex5.m1.4.4.3.cmml"><munder id="A7.Ex5.m1.4.4.3.1" xref="A7.Ex5.m1.4.4.3.1.cmml"><mrow id="A7.Ex5.m1.4.4.3.1.2" xref="A7.Ex5.m1.4.4.3.1.2.cmml"><mi id="A7.Ex5.m1.4.4.3.1.2.2" xref="A7.Ex5.m1.4.4.3.1.2.2.cmml">arg</mi><mo lspace="0.170em" rspace="0em" id="A7.Ex5.m1.4.4.3.1.2.1" xref="A7.Ex5.m1.4.4.3.1.2.1.cmml">​</mo><mi id="A7.Ex5.m1.4.4.3.1.2.3" xref="A7.Ex5.m1.4.4.3.1.2.3.cmml">max</mi></mrow><mrow id="A7.Ex5.m1.2.2.2.2" xref="A7.Ex5.m1.2.2.2.3.cmml"><msub id="A7.Ex5.m1.1.1.1.1.1" xref="A7.Ex5.m1.1.1.1.1.1.cmml"><mi id="A7.Ex5.m1.1.1.1.1.1.2" xref="A7.Ex5.m1.1.1.1.1.1.2.cmml">𝐰</mi><mi id="A7.Ex5.m1.1.1.1.1.1.3" xref="A7.Ex5.m1.1.1.1.1.1.3.cmml">s</mi></msub><mo id="A7.Ex5.m1.2.2.2.2.3" xref="A7.Ex5.m1.2.2.2.3.cmml">,</mo><msub id="A7.Ex5.m1.2.2.2.2.2" xref="A7.Ex5.m1.2.2.2.2.2.cmml"><mi id="A7.Ex5.m1.2.2.2.2.2.2" xref="A7.Ex5.m1.2.2.2.2.2.2.cmml">𝝅</mi><mi id="A7.Ex5.m1.2.2.2.2.2.3" xref="A7.Ex5.m1.2.2.2.2.2.3.cmml">s</mi></msub></mrow></munder><mo lspace="0.167em" id="A7.Ex5.m1.4.4.3a" xref="A7.Ex5.m1.4.4.3.cmml">⁡</mo><msub id="A7.Ex5.m1.4.4.3.2" xref="A7.Ex5.m1.4.4.3.2.cmml"><mi id="A7.Ex5.m1.4.4.3.2.2" xref="A7.Ex5.m1.4.4.3.2.2.cmml">𝔼</mi><mrow id="A7.Ex5.m1.3.3.1" xref="A7.Ex5.m1.3.3.1.cmml"><msub id="A7.Ex5.m1.3.3.1.3" xref="A7.Ex5.m1.3.3.1.3.cmml"><mi id="A7.Ex5.m1.3.3.1.3.2" xref="A7.Ex5.m1.3.3.1.3.2.cmml">q</mi><msub id="A7.Ex5.m1.3.3.1.3.3" xref="A7.Ex5.m1.3.3.1.3.3.cmml"><mi id="A7.Ex5.m1.3.3.1.3.3.2" xref="A7.Ex5.m1.3.3.1.3.3.2.cmml">𝝅</mi><mi id="A7.Ex5.m1.3.3.1.3.3.3" xref="A7.Ex5.m1.3.3.1.3.3.3.cmml">s</mi></msub></msub><mo lspace="0em" rspace="0em" id="A7.Ex5.m1.3.3.1.2" xref="A7.Ex5.m1.3.3.1.2.cmml">​</mo><mrow id="A7.Ex5.m1.3.3.1.1.1" xref="A7.Ex5.m1.3.3.1.1.1.1.cmml"><mo stretchy="false" id="A7.Ex5.m1.3.3.1.1.1.2" xref="A7.Ex5.m1.3.3.1.1.1.1.cmml">(</mo><msub id="A7.Ex5.m1.3.3.1.1.1.1" xref="A7.Ex5.m1.3.3.1.1.1.1.cmml"><mi id="A7.Ex5.m1.3.3.1.1.1.1.2" xref="A7.Ex5.m1.3.3.1.1.1.1.2.cmml">𝐳</mi><mi id="A7.Ex5.m1.3.3.1.1.1.1.3" xref="A7.Ex5.m1.3.3.1.1.1.1.3.cmml">s</mi></msub><mo stretchy="false" id="A7.Ex5.m1.3.3.1.1.1.3" xref="A7.Ex5.m1.3.3.1.1.1.1.cmml">)</mo></mrow></mrow></msub></mrow><mo lspace="0em" rspace="0em" id="A7.Ex5.m1.4.4.2" xref="A7.Ex5.m1.4.4.2.cmml">​</mo><mrow id="A7.Ex5.m1.4.4.1.1" xref="A7.Ex5.m1.4.4.1.2.cmml"><mo id="A7.Ex5.m1.4.4.1.1.2" xref="A7.Ex5.m1.4.4.1.2.1.cmml">[</mo><mrow id="A7.Ex5.m1.4.4.1.1.1" xref="A7.Ex5.m1.4.4.1.1.1.cmml"><mstyle displaystyle="true" id="A7.Ex5.m1.4.4.1.1.1.3" xref="A7.Ex5.m1.4.4.1.1.1.3.cmml"><munderover id="A7.Ex5.m1.4.4.1.1.1.3a" xref="A7.Ex5.m1.4.4.1.1.1.3.cmml"><mo movablelimits="false" id="A7.Ex5.m1.4.4.1.1.1.3.2.2" xref="A7.Ex5.m1.4.4.1.1.1.3.2.2.cmml">∑</mo><mi id="A7.Ex5.m1.4.4.1.1.1.3.2.3" xref="A7.Ex5.m1.4.4.1.1.1.3.2.3.cmml">i</mi><msub id="A7.Ex5.m1.4.4.1.1.1.3.3" xref="A7.Ex5.m1.4.4.1.1.1.3.3.cmml"><mi id="A7.Ex5.m1.4.4.1.1.1.3.3.2" xref="A7.Ex5.m1.4.4.1.1.1.3.3.2.cmml">N</mi><mi id="A7.Ex5.m1.4.4.1.1.1.3.3.3" xref="A7.Ex5.m1.4.4.1.1.1.3.3.3.cmml">s</mi></msub></munderover></mstyle><mrow id="A7.Ex5.m1.4.4.1.1.1.2" xref="A7.Ex5.m1.4.4.1.1.1.2.cmml"><mi id="A7.Ex5.m1.4.4.1.1.1.2.4" xref="A7.Ex5.m1.4.4.1.1.1.2.4.cmml">L</mi><mo lspace="0em" rspace="0em" id="A7.Ex5.m1.4.4.1.1.1.2.3" xref="A7.Ex5.m1.4.4.1.1.1.2.3.cmml">​</mo><mrow id="A7.Ex5.m1.4.4.1.1.1.2.2.2" xref="A7.Ex5.m1.4.4.1.1.1.2.2.3.cmml"><mo stretchy="false" id="A7.Ex5.m1.4.4.1.1.1.2.2.2.3" xref="A7.Ex5.m1.4.4.1.1.1.2.2.3.cmml">(</mo><msub id="A7.Ex5.m1.4.4.1.1.1.1.1.1.1" xref="A7.Ex5.m1.4.4.1.1.1.1.1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="A7.Ex5.m1.4.4.1.1.1.1.1.1.1.2" xref="A7.Ex5.m1.4.4.1.1.1.1.1.1.1.2.cmml">𝒟</mi><mrow id="A7.Ex5.m1.4.4.1.1.1.1.1.1.1.3" xref="A7.Ex5.m1.4.4.1.1.1.1.1.1.1.3.cmml"><mi id="A7.Ex5.m1.4.4.1.1.1.1.1.1.1.3.2" xref="A7.Ex5.m1.4.4.1.1.1.1.1.1.1.3.2.cmml">s</mi><mo lspace="0em" rspace="0em" id="A7.Ex5.m1.4.4.1.1.1.1.1.1.1.3.1" xref="A7.Ex5.m1.4.4.1.1.1.1.1.1.1.3.1.cmml">​</mo><mi id="A7.Ex5.m1.4.4.1.1.1.1.1.1.1.3.3" xref="A7.Ex5.m1.4.4.1.1.1.1.1.1.1.3.3.cmml">i</mi></mrow></msub><mo id="A7.Ex5.m1.4.4.1.1.1.2.2.2.4" xref="A7.Ex5.m1.4.4.1.1.1.2.2.3.cmml">,</mo><mrow id="A7.Ex5.m1.4.4.1.1.1.2.2.2.2" xref="A7.Ex5.m1.4.4.1.1.1.2.2.2.2.cmml"><msub id="A7.Ex5.m1.4.4.1.1.1.2.2.2.2.2" xref="A7.Ex5.m1.4.4.1.1.1.2.2.2.2.2.cmml"><mi id="A7.Ex5.m1.4.4.1.1.1.2.2.2.2.2.2" xref="A7.Ex5.m1.4.4.1.1.1.2.2.2.2.2.2.cmml">𝐰</mi><mi id="A7.Ex5.m1.4.4.1.1.1.2.2.2.2.2.3" xref="A7.Ex5.m1.4.4.1.1.1.2.2.2.2.2.3.cmml">s</mi></msub><mo lspace="0.222em" rspace="0.222em" id="A7.Ex5.m1.4.4.1.1.1.2.2.2.2.1" xref="A7.Ex5.m1.4.4.1.1.1.2.2.2.2.1.cmml">⊙</mo><msub id="A7.Ex5.m1.4.4.1.1.1.2.2.2.2.3" xref="A7.Ex5.m1.4.4.1.1.1.2.2.2.2.3.cmml"><mi id="A7.Ex5.m1.4.4.1.1.1.2.2.2.2.3.2" xref="A7.Ex5.m1.4.4.1.1.1.2.2.2.2.3.2.cmml">𝐳</mi><mi id="A7.Ex5.m1.4.4.1.1.1.2.2.2.2.3.3" xref="A7.Ex5.m1.4.4.1.1.1.2.2.2.2.3.3.cmml">s</mi></msub></mrow><mo stretchy="false" id="A7.Ex5.m1.4.4.1.1.1.2.2.2.5" xref="A7.Ex5.m1.4.4.1.1.1.2.2.3.cmml">)</mo></mrow></mrow></mrow><mo id="A7.Ex5.m1.4.4.1.1.3" xref="A7.Ex5.m1.4.4.1.2.1.cmml">]</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="A7.Ex5.m1.4b"><apply id="A7.Ex5.m1.4.4.cmml" xref="A7.Ex5.m1.4.4"><times id="A7.Ex5.m1.4.4.2.cmml" xref="A7.Ex5.m1.4.4.2"></times><apply id="A7.Ex5.m1.4.4.3.cmml" xref="A7.Ex5.m1.4.4.3"><apply id="A7.Ex5.m1.4.4.3.1.cmml" xref="A7.Ex5.m1.4.4.3.1"><csymbol cd="ambiguous" id="A7.Ex5.m1.4.4.3.1.1.cmml" xref="A7.Ex5.m1.4.4.3.1">subscript</csymbol><apply id="A7.Ex5.m1.4.4.3.1.2.cmml" xref="A7.Ex5.m1.4.4.3.1.2"><times id="A7.Ex5.m1.4.4.3.1.2.1.cmml" xref="A7.Ex5.m1.4.4.3.1.2.1"></times><ci id="A7.Ex5.m1.4.4.3.1.2.2.cmml" xref="A7.Ex5.m1.4.4.3.1.2.2">arg</ci><ci id="A7.Ex5.m1.4.4.3.1.2.3.cmml" xref="A7.Ex5.m1.4.4.3.1.2.3">max</ci></apply><list id="A7.Ex5.m1.2.2.2.3.cmml" xref="A7.Ex5.m1.2.2.2.2"><apply id="A7.Ex5.m1.1.1.1.1.1.cmml" xref="A7.Ex5.m1.1.1.1.1.1"><csymbol cd="ambiguous" id="A7.Ex5.m1.1.1.1.1.1.1.cmml" xref="A7.Ex5.m1.1.1.1.1.1">subscript</csymbol><ci id="A7.Ex5.m1.1.1.1.1.1.2.cmml" xref="A7.Ex5.m1.1.1.1.1.1.2">𝐰</ci><ci id="A7.Ex5.m1.1.1.1.1.1.3.cmml" xref="A7.Ex5.m1.1.1.1.1.1.3">𝑠</ci></apply><apply id="A7.Ex5.m1.2.2.2.2.2.cmml" xref="A7.Ex5.m1.2.2.2.2.2"><csymbol cd="ambiguous" id="A7.Ex5.m1.2.2.2.2.2.1.cmml" xref="A7.Ex5.m1.2.2.2.2.2">subscript</csymbol><ci id="A7.Ex5.m1.2.2.2.2.2.2.cmml" xref="A7.Ex5.m1.2.2.2.2.2.2">𝝅</ci><ci id="A7.Ex5.m1.2.2.2.2.2.3.cmml" xref="A7.Ex5.m1.2.2.2.2.2.3">𝑠</ci></apply></list></apply><apply id="A7.Ex5.m1.4.4.3.2.cmml" xref="A7.Ex5.m1.4.4.3.2"><csymbol cd="ambiguous" id="A7.Ex5.m1.4.4.3.2.1.cmml" xref="A7.Ex5.m1.4.4.3.2">subscript</csymbol><ci id="A7.Ex5.m1.4.4.3.2.2.cmml" xref="A7.Ex5.m1.4.4.3.2.2">𝔼</ci><apply id="A7.Ex5.m1.3.3.1.cmml" xref="A7.Ex5.m1.3.3.1"><times id="A7.Ex5.m1.3.3.1.2.cmml" xref="A7.Ex5.m1.3.3.1.2"></times><apply id="A7.Ex5.m1.3.3.1.3.cmml" xref="A7.Ex5.m1.3.3.1.3"><csymbol cd="ambiguous" id="A7.Ex5.m1.3.3.1.3.1.cmml" xref="A7.Ex5.m1.3.3.1.3">subscript</csymbol><ci id="A7.Ex5.m1.3.3.1.3.2.cmml" xref="A7.Ex5.m1.3.3.1.3.2">𝑞</ci><apply id="A7.Ex5.m1.3.3.1.3.3.cmml" xref="A7.Ex5.m1.3.3.1.3.3"><csymbol cd="ambiguous" id="A7.Ex5.m1.3.3.1.3.3.1.cmml" xref="A7.Ex5.m1.3.3.1.3.3">subscript</csymbol><ci id="A7.Ex5.m1.3.3.1.3.3.2.cmml" xref="A7.Ex5.m1.3.3.1.3.3.2">𝝅</ci><ci id="A7.Ex5.m1.3.3.1.3.3.3.cmml" xref="A7.Ex5.m1.3.3.1.3.3.3">𝑠</ci></apply></apply><apply id="A7.Ex5.m1.3.3.1.1.1.1.cmml" xref="A7.Ex5.m1.3.3.1.1.1"><csymbol cd="ambiguous" id="A7.Ex5.m1.3.3.1.1.1.1.1.cmml" xref="A7.Ex5.m1.3.3.1.1.1">subscript</csymbol><ci id="A7.Ex5.m1.3.3.1.1.1.1.2.cmml" xref="A7.Ex5.m1.3.3.1.1.1.1.2">𝐳</ci><ci id="A7.Ex5.m1.3.3.1.1.1.1.3.cmml" xref="A7.Ex5.m1.3.3.1.1.1.1.3">𝑠</ci></apply></apply></apply></apply><apply id="A7.Ex5.m1.4.4.1.2.cmml" xref="A7.Ex5.m1.4.4.1.1"><csymbol cd="latexml" id="A7.Ex5.m1.4.4.1.2.1.cmml" xref="A7.Ex5.m1.4.4.1.1.2">delimited-[]</csymbol><apply id="A7.Ex5.m1.4.4.1.1.1.cmml" xref="A7.Ex5.m1.4.4.1.1.1"><apply id="A7.Ex5.m1.4.4.1.1.1.3.cmml" xref="A7.Ex5.m1.4.4.1.1.1.3"><csymbol cd="ambiguous" id="A7.Ex5.m1.4.4.1.1.1.3.1.cmml" xref="A7.Ex5.m1.4.4.1.1.1.3">superscript</csymbol><apply id="A7.Ex5.m1.4.4.1.1.1.3.2.cmml" xref="A7.Ex5.m1.4.4.1.1.1.3"><csymbol cd="ambiguous" id="A7.Ex5.m1.4.4.1.1.1.3.2.1.cmml" xref="A7.Ex5.m1.4.4.1.1.1.3">subscript</csymbol><sum id="A7.Ex5.m1.4.4.1.1.1.3.2.2.cmml" xref="A7.Ex5.m1.4.4.1.1.1.3.2.2"></sum><ci id="A7.Ex5.m1.4.4.1.1.1.3.2.3.cmml" xref="A7.Ex5.m1.4.4.1.1.1.3.2.3">𝑖</ci></apply><apply id="A7.Ex5.m1.4.4.1.1.1.3.3.cmml" xref="A7.Ex5.m1.4.4.1.1.1.3.3"><csymbol cd="ambiguous" id="A7.Ex5.m1.4.4.1.1.1.3.3.1.cmml" xref="A7.Ex5.m1.4.4.1.1.1.3.3">subscript</csymbol><ci id="A7.Ex5.m1.4.4.1.1.1.3.3.2.cmml" xref="A7.Ex5.m1.4.4.1.1.1.3.3.2">𝑁</ci><ci id="A7.Ex5.m1.4.4.1.1.1.3.3.3.cmml" xref="A7.Ex5.m1.4.4.1.1.1.3.3.3">𝑠</ci></apply></apply><apply id="A7.Ex5.m1.4.4.1.1.1.2.cmml" xref="A7.Ex5.m1.4.4.1.1.1.2"><times id="A7.Ex5.m1.4.4.1.1.1.2.3.cmml" xref="A7.Ex5.m1.4.4.1.1.1.2.3"></times><ci id="A7.Ex5.m1.4.4.1.1.1.2.4.cmml" xref="A7.Ex5.m1.4.4.1.1.1.2.4">𝐿</ci><interval closure="open" id="A7.Ex5.m1.4.4.1.1.1.2.2.3.cmml" xref="A7.Ex5.m1.4.4.1.1.1.2.2.2"><apply id="A7.Ex5.m1.4.4.1.1.1.1.1.1.1.cmml" xref="A7.Ex5.m1.4.4.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="A7.Ex5.m1.4.4.1.1.1.1.1.1.1.1.cmml" xref="A7.Ex5.m1.4.4.1.1.1.1.1.1.1">subscript</csymbol><ci id="A7.Ex5.m1.4.4.1.1.1.1.1.1.1.2.cmml" xref="A7.Ex5.m1.4.4.1.1.1.1.1.1.1.2">𝒟</ci><apply id="A7.Ex5.m1.4.4.1.1.1.1.1.1.1.3.cmml" xref="A7.Ex5.m1.4.4.1.1.1.1.1.1.1.3"><times id="A7.Ex5.m1.4.4.1.1.1.1.1.1.1.3.1.cmml" xref="A7.Ex5.m1.4.4.1.1.1.1.1.1.1.3.1"></times><ci id="A7.Ex5.m1.4.4.1.1.1.1.1.1.1.3.2.cmml" xref="A7.Ex5.m1.4.4.1.1.1.1.1.1.1.3.2">𝑠</ci><ci id="A7.Ex5.m1.4.4.1.1.1.1.1.1.1.3.3.cmml" xref="A7.Ex5.m1.4.4.1.1.1.1.1.1.1.3.3">𝑖</ci></apply></apply><apply id="A7.Ex5.m1.4.4.1.1.1.2.2.2.2.cmml" xref="A7.Ex5.m1.4.4.1.1.1.2.2.2.2"><csymbol cd="latexml" id="A7.Ex5.m1.4.4.1.1.1.2.2.2.2.1.cmml" xref="A7.Ex5.m1.4.4.1.1.1.2.2.2.2.1">direct-product</csymbol><apply id="A7.Ex5.m1.4.4.1.1.1.2.2.2.2.2.cmml" xref="A7.Ex5.m1.4.4.1.1.1.2.2.2.2.2"><csymbol cd="ambiguous" id="A7.Ex5.m1.4.4.1.1.1.2.2.2.2.2.1.cmml" xref="A7.Ex5.m1.4.4.1.1.1.2.2.2.2.2">subscript</csymbol><ci id="A7.Ex5.m1.4.4.1.1.1.2.2.2.2.2.2.cmml" xref="A7.Ex5.m1.4.4.1.1.1.2.2.2.2.2.2">𝐰</ci><ci id="A7.Ex5.m1.4.4.1.1.1.2.2.2.2.2.3.cmml" xref="A7.Ex5.m1.4.4.1.1.1.2.2.2.2.2.3">𝑠</ci></apply><apply id="A7.Ex5.m1.4.4.1.1.1.2.2.2.2.3.cmml" xref="A7.Ex5.m1.4.4.1.1.1.2.2.2.2.3"><csymbol cd="ambiguous" id="A7.Ex5.m1.4.4.1.1.1.2.2.2.2.3.1.cmml" xref="A7.Ex5.m1.4.4.1.1.1.2.2.2.2.3">subscript</csymbol><ci id="A7.Ex5.m1.4.4.1.1.1.2.2.2.2.3.2.cmml" xref="A7.Ex5.m1.4.4.1.1.1.2.2.2.2.3.2">𝐳</ci><ci id="A7.Ex5.m1.4.4.1.1.1.2.2.2.2.3.3.cmml" xref="A7.Ex5.m1.4.4.1.1.1.2.2.2.2.3.3">𝑠</ci></apply></apply></interval></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A7.Ex5.m1.4c">\displaystyle\operatorname*{arg\,max}_{\mathbf{w}_{s},\bm{\pi}_{s}}\mathbb{E}_{q_{\bm{\pi}_{s}}(\mathbf{z}_{s})}\left[\sum_{i}^{N_{s}}L(\mathcal{D}_{si},\mathbf{w}_{s}\odot\mathbf{z}_{s})\right]</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math id="A7.Ex5.m2.1" class="ltx_Math" alttext="\displaystyle-\frac{\lambda}{2}\sum_{j}\bm{\pi}_{sj}(\mathbf{w}_{sj}-\mathbf{w}_{j})^{2}-\lambda_{0}\sum_{j}\bm{\pi}_{sj}" display="inline"><semantics id="A7.Ex5.m2.1a"><mrow id="A7.Ex5.m2.1.1" xref="A7.Ex5.m2.1.1.cmml"><mrow id="A7.Ex5.m2.1.1.1" xref="A7.Ex5.m2.1.1.1.cmml"><mo id="A7.Ex5.m2.1.1.1a" xref="A7.Ex5.m2.1.1.1.cmml">−</mo><mrow id="A7.Ex5.m2.1.1.1.1" xref="A7.Ex5.m2.1.1.1.1.cmml"><mstyle displaystyle="true" id="A7.Ex5.m2.1.1.1.1.3" xref="A7.Ex5.m2.1.1.1.1.3.cmml"><mfrac id="A7.Ex5.m2.1.1.1.1.3a" xref="A7.Ex5.m2.1.1.1.1.3.cmml"><mi id="A7.Ex5.m2.1.1.1.1.3.2" xref="A7.Ex5.m2.1.1.1.1.3.2.cmml">λ</mi><mn id="A7.Ex5.m2.1.1.1.1.3.3" xref="A7.Ex5.m2.1.1.1.1.3.3.cmml">2</mn></mfrac></mstyle><mo lspace="0em" rspace="0em" id="A7.Ex5.m2.1.1.1.1.2" xref="A7.Ex5.m2.1.1.1.1.2.cmml">​</mo><mrow id="A7.Ex5.m2.1.1.1.1.1" xref="A7.Ex5.m2.1.1.1.1.1.cmml"><mstyle displaystyle="true" id="A7.Ex5.m2.1.1.1.1.1.2" xref="A7.Ex5.m2.1.1.1.1.1.2.cmml"><munder id="A7.Ex5.m2.1.1.1.1.1.2a" xref="A7.Ex5.m2.1.1.1.1.1.2.cmml"><mo movablelimits="false" id="A7.Ex5.m2.1.1.1.1.1.2.2" xref="A7.Ex5.m2.1.1.1.1.1.2.2.cmml">∑</mo><mi id="A7.Ex5.m2.1.1.1.1.1.2.3" xref="A7.Ex5.m2.1.1.1.1.1.2.3.cmml">j</mi></munder></mstyle><mrow id="A7.Ex5.m2.1.1.1.1.1.1" xref="A7.Ex5.m2.1.1.1.1.1.1.cmml"><msub id="A7.Ex5.m2.1.1.1.1.1.1.3" xref="A7.Ex5.m2.1.1.1.1.1.1.3.cmml"><mi id="A7.Ex5.m2.1.1.1.1.1.1.3.2" xref="A7.Ex5.m2.1.1.1.1.1.1.3.2.cmml">𝝅</mi><mrow id="A7.Ex5.m2.1.1.1.1.1.1.3.3" xref="A7.Ex5.m2.1.1.1.1.1.1.3.3.cmml"><mi id="A7.Ex5.m2.1.1.1.1.1.1.3.3.2" xref="A7.Ex5.m2.1.1.1.1.1.1.3.3.2.cmml">s</mi><mo lspace="0em" rspace="0em" id="A7.Ex5.m2.1.1.1.1.1.1.3.3.1" xref="A7.Ex5.m2.1.1.1.1.1.1.3.3.1.cmml">​</mo><mi id="A7.Ex5.m2.1.1.1.1.1.1.3.3.3" xref="A7.Ex5.m2.1.1.1.1.1.1.3.3.3.cmml">j</mi></mrow></msub><mo lspace="0em" rspace="0em" id="A7.Ex5.m2.1.1.1.1.1.1.2" xref="A7.Ex5.m2.1.1.1.1.1.1.2.cmml">​</mo><msup id="A7.Ex5.m2.1.1.1.1.1.1.1" xref="A7.Ex5.m2.1.1.1.1.1.1.1.cmml"><mrow id="A7.Ex5.m2.1.1.1.1.1.1.1.1.1" xref="A7.Ex5.m2.1.1.1.1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="A7.Ex5.m2.1.1.1.1.1.1.1.1.1.2" xref="A7.Ex5.m2.1.1.1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="A7.Ex5.m2.1.1.1.1.1.1.1.1.1.1" xref="A7.Ex5.m2.1.1.1.1.1.1.1.1.1.1.cmml"><msub id="A7.Ex5.m2.1.1.1.1.1.1.1.1.1.1.2" xref="A7.Ex5.m2.1.1.1.1.1.1.1.1.1.1.2.cmml"><mi id="A7.Ex5.m2.1.1.1.1.1.1.1.1.1.1.2.2" xref="A7.Ex5.m2.1.1.1.1.1.1.1.1.1.1.2.2.cmml">𝐰</mi><mrow id="A7.Ex5.m2.1.1.1.1.1.1.1.1.1.1.2.3" xref="A7.Ex5.m2.1.1.1.1.1.1.1.1.1.1.2.3.cmml"><mi id="A7.Ex5.m2.1.1.1.1.1.1.1.1.1.1.2.3.2" xref="A7.Ex5.m2.1.1.1.1.1.1.1.1.1.1.2.3.2.cmml">s</mi><mo lspace="0em" rspace="0em" id="A7.Ex5.m2.1.1.1.1.1.1.1.1.1.1.2.3.1" xref="A7.Ex5.m2.1.1.1.1.1.1.1.1.1.1.2.3.1.cmml">​</mo><mi id="A7.Ex5.m2.1.1.1.1.1.1.1.1.1.1.2.3.3" xref="A7.Ex5.m2.1.1.1.1.1.1.1.1.1.1.2.3.3.cmml">j</mi></mrow></msub><mo id="A7.Ex5.m2.1.1.1.1.1.1.1.1.1.1.1" xref="A7.Ex5.m2.1.1.1.1.1.1.1.1.1.1.1.cmml">−</mo><msub id="A7.Ex5.m2.1.1.1.1.1.1.1.1.1.1.3" xref="A7.Ex5.m2.1.1.1.1.1.1.1.1.1.1.3.cmml"><mi id="A7.Ex5.m2.1.1.1.1.1.1.1.1.1.1.3.2" xref="A7.Ex5.m2.1.1.1.1.1.1.1.1.1.1.3.2.cmml">𝐰</mi><mi id="A7.Ex5.m2.1.1.1.1.1.1.1.1.1.1.3.3" xref="A7.Ex5.m2.1.1.1.1.1.1.1.1.1.1.3.3.cmml">j</mi></msub></mrow><mo stretchy="false" id="A7.Ex5.m2.1.1.1.1.1.1.1.1.1.3" xref="A7.Ex5.m2.1.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow><mn id="A7.Ex5.m2.1.1.1.1.1.1.1.3" xref="A7.Ex5.m2.1.1.1.1.1.1.1.3.cmml">2</mn></msup></mrow></mrow></mrow></mrow><mo id="A7.Ex5.m2.1.1.2" xref="A7.Ex5.m2.1.1.2.cmml">−</mo><mrow id="A7.Ex5.m2.1.1.3" xref="A7.Ex5.m2.1.1.3.cmml"><msub id="A7.Ex5.m2.1.1.3.2" xref="A7.Ex5.m2.1.1.3.2.cmml"><mi id="A7.Ex5.m2.1.1.3.2.2" xref="A7.Ex5.m2.1.1.3.2.2.cmml">λ</mi><mn id="A7.Ex5.m2.1.1.3.2.3" xref="A7.Ex5.m2.1.1.3.2.3.cmml">0</mn></msub><mo lspace="0em" rspace="0em" id="A7.Ex5.m2.1.1.3.1" xref="A7.Ex5.m2.1.1.3.1.cmml">​</mo><mrow id="A7.Ex5.m2.1.1.3.3" xref="A7.Ex5.m2.1.1.3.3.cmml"><mstyle displaystyle="true" id="A7.Ex5.m2.1.1.3.3.1" xref="A7.Ex5.m2.1.1.3.3.1.cmml"><munder id="A7.Ex5.m2.1.1.3.3.1a" xref="A7.Ex5.m2.1.1.3.3.1.cmml"><mo movablelimits="false" id="A7.Ex5.m2.1.1.3.3.1.2" xref="A7.Ex5.m2.1.1.3.3.1.2.cmml">∑</mo><mi id="A7.Ex5.m2.1.1.3.3.1.3" xref="A7.Ex5.m2.1.1.3.3.1.3.cmml">j</mi></munder></mstyle><msub id="A7.Ex5.m2.1.1.3.3.2" xref="A7.Ex5.m2.1.1.3.3.2.cmml"><mi id="A7.Ex5.m2.1.1.3.3.2.2" xref="A7.Ex5.m2.1.1.3.3.2.2.cmml">𝝅</mi><mrow id="A7.Ex5.m2.1.1.3.3.2.3" xref="A7.Ex5.m2.1.1.3.3.2.3.cmml"><mi id="A7.Ex5.m2.1.1.3.3.2.3.2" xref="A7.Ex5.m2.1.1.3.3.2.3.2.cmml">s</mi><mo lspace="0em" rspace="0em" id="A7.Ex5.m2.1.1.3.3.2.3.1" xref="A7.Ex5.m2.1.1.3.3.2.3.1.cmml">​</mo><mi id="A7.Ex5.m2.1.1.3.3.2.3.3" xref="A7.Ex5.m2.1.1.3.3.2.3.3.cmml">j</mi></mrow></msub></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="A7.Ex5.m2.1b"><apply id="A7.Ex5.m2.1.1.cmml" xref="A7.Ex5.m2.1.1"><minus id="A7.Ex5.m2.1.1.2.cmml" xref="A7.Ex5.m2.1.1.2"></minus><apply id="A7.Ex5.m2.1.1.1.cmml" xref="A7.Ex5.m2.1.1.1"><minus id="A7.Ex5.m2.1.1.1.2.cmml" xref="A7.Ex5.m2.1.1.1"></minus><apply id="A7.Ex5.m2.1.1.1.1.cmml" xref="A7.Ex5.m2.1.1.1.1"><times id="A7.Ex5.m2.1.1.1.1.2.cmml" xref="A7.Ex5.m2.1.1.1.1.2"></times><apply id="A7.Ex5.m2.1.1.1.1.3.cmml" xref="A7.Ex5.m2.1.1.1.1.3"><divide id="A7.Ex5.m2.1.1.1.1.3.1.cmml" xref="A7.Ex5.m2.1.1.1.1.3"></divide><ci id="A7.Ex5.m2.1.1.1.1.3.2.cmml" xref="A7.Ex5.m2.1.1.1.1.3.2">𝜆</ci><cn type="integer" id="A7.Ex5.m2.1.1.1.1.3.3.cmml" xref="A7.Ex5.m2.1.1.1.1.3.3">2</cn></apply><apply id="A7.Ex5.m2.1.1.1.1.1.cmml" xref="A7.Ex5.m2.1.1.1.1.1"><apply id="A7.Ex5.m2.1.1.1.1.1.2.cmml" xref="A7.Ex5.m2.1.1.1.1.1.2"><csymbol cd="ambiguous" id="A7.Ex5.m2.1.1.1.1.1.2.1.cmml" xref="A7.Ex5.m2.1.1.1.1.1.2">subscript</csymbol><sum id="A7.Ex5.m2.1.1.1.1.1.2.2.cmml" xref="A7.Ex5.m2.1.1.1.1.1.2.2"></sum><ci id="A7.Ex5.m2.1.1.1.1.1.2.3.cmml" xref="A7.Ex5.m2.1.1.1.1.1.2.3">𝑗</ci></apply><apply id="A7.Ex5.m2.1.1.1.1.1.1.cmml" xref="A7.Ex5.m2.1.1.1.1.1.1"><times id="A7.Ex5.m2.1.1.1.1.1.1.2.cmml" xref="A7.Ex5.m2.1.1.1.1.1.1.2"></times><apply id="A7.Ex5.m2.1.1.1.1.1.1.3.cmml" xref="A7.Ex5.m2.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="A7.Ex5.m2.1.1.1.1.1.1.3.1.cmml" xref="A7.Ex5.m2.1.1.1.1.1.1.3">subscript</csymbol><ci id="A7.Ex5.m2.1.1.1.1.1.1.3.2.cmml" xref="A7.Ex5.m2.1.1.1.1.1.1.3.2">𝝅</ci><apply id="A7.Ex5.m2.1.1.1.1.1.1.3.3.cmml" xref="A7.Ex5.m2.1.1.1.1.1.1.3.3"><times id="A7.Ex5.m2.1.1.1.1.1.1.3.3.1.cmml" xref="A7.Ex5.m2.1.1.1.1.1.1.3.3.1"></times><ci id="A7.Ex5.m2.1.1.1.1.1.1.3.3.2.cmml" xref="A7.Ex5.m2.1.1.1.1.1.1.3.3.2">𝑠</ci><ci id="A7.Ex5.m2.1.1.1.1.1.1.3.3.3.cmml" xref="A7.Ex5.m2.1.1.1.1.1.1.3.3.3">𝑗</ci></apply></apply><apply id="A7.Ex5.m2.1.1.1.1.1.1.1.cmml" xref="A7.Ex5.m2.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="A7.Ex5.m2.1.1.1.1.1.1.1.2.cmml" xref="A7.Ex5.m2.1.1.1.1.1.1.1">superscript</csymbol><apply id="A7.Ex5.m2.1.1.1.1.1.1.1.1.1.1.cmml" xref="A7.Ex5.m2.1.1.1.1.1.1.1.1.1"><minus id="A7.Ex5.m2.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="A7.Ex5.m2.1.1.1.1.1.1.1.1.1.1.1"></minus><apply id="A7.Ex5.m2.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="A7.Ex5.m2.1.1.1.1.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="A7.Ex5.m2.1.1.1.1.1.1.1.1.1.1.2.1.cmml" xref="A7.Ex5.m2.1.1.1.1.1.1.1.1.1.1.2">subscript</csymbol><ci id="A7.Ex5.m2.1.1.1.1.1.1.1.1.1.1.2.2.cmml" xref="A7.Ex5.m2.1.1.1.1.1.1.1.1.1.1.2.2">𝐰</ci><apply id="A7.Ex5.m2.1.1.1.1.1.1.1.1.1.1.2.3.cmml" xref="A7.Ex5.m2.1.1.1.1.1.1.1.1.1.1.2.3"><times id="A7.Ex5.m2.1.1.1.1.1.1.1.1.1.1.2.3.1.cmml" xref="A7.Ex5.m2.1.1.1.1.1.1.1.1.1.1.2.3.1"></times><ci id="A7.Ex5.m2.1.1.1.1.1.1.1.1.1.1.2.3.2.cmml" xref="A7.Ex5.m2.1.1.1.1.1.1.1.1.1.1.2.3.2">𝑠</ci><ci id="A7.Ex5.m2.1.1.1.1.1.1.1.1.1.1.2.3.3.cmml" xref="A7.Ex5.m2.1.1.1.1.1.1.1.1.1.1.2.3.3">𝑗</ci></apply></apply><apply id="A7.Ex5.m2.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="A7.Ex5.m2.1.1.1.1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="A7.Ex5.m2.1.1.1.1.1.1.1.1.1.1.3.1.cmml" xref="A7.Ex5.m2.1.1.1.1.1.1.1.1.1.1.3">subscript</csymbol><ci id="A7.Ex5.m2.1.1.1.1.1.1.1.1.1.1.3.2.cmml" xref="A7.Ex5.m2.1.1.1.1.1.1.1.1.1.1.3.2">𝐰</ci><ci id="A7.Ex5.m2.1.1.1.1.1.1.1.1.1.1.3.3.cmml" xref="A7.Ex5.m2.1.1.1.1.1.1.1.1.1.1.3.3">𝑗</ci></apply></apply><cn type="integer" id="A7.Ex5.m2.1.1.1.1.1.1.1.3.cmml" xref="A7.Ex5.m2.1.1.1.1.1.1.1.3">2</cn></apply></apply></apply></apply></apply><apply id="A7.Ex5.m2.1.1.3.cmml" xref="A7.Ex5.m2.1.1.3"><times id="A7.Ex5.m2.1.1.3.1.cmml" xref="A7.Ex5.m2.1.1.3.1"></times><apply id="A7.Ex5.m2.1.1.3.2.cmml" xref="A7.Ex5.m2.1.1.3.2"><csymbol cd="ambiguous" id="A7.Ex5.m2.1.1.3.2.1.cmml" xref="A7.Ex5.m2.1.1.3.2">subscript</csymbol><ci id="A7.Ex5.m2.1.1.3.2.2.cmml" xref="A7.Ex5.m2.1.1.3.2.2">𝜆</ci><cn type="integer" id="A7.Ex5.m2.1.1.3.2.3.cmml" xref="A7.Ex5.m2.1.1.3.2.3">0</cn></apply><apply id="A7.Ex5.m2.1.1.3.3.cmml" xref="A7.Ex5.m2.1.1.3.3"><apply id="A7.Ex5.m2.1.1.3.3.1.cmml" xref="A7.Ex5.m2.1.1.3.3.1"><csymbol cd="ambiguous" id="A7.Ex5.m2.1.1.3.3.1.1.cmml" xref="A7.Ex5.m2.1.1.3.3.1">subscript</csymbol><sum id="A7.Ex5.m2.1.1.3.3.1.2.cmml" xref="A7.Ex5.m2.1.1.3.3.1.2"></sum><ci id="A7.Ex5.m2.1.1.3.3.1.3.cmml" xref="A7.Ex5.m2.1.1.3.3.1.3">𝑗</ci></apply><apply id="A7.Ex5.m2.1.1.3.3.2.cmml" xref="A7.Ex5.m2.1.1.3.3.2"><csymbol cd="ambiguous" id="A7.Ex5.m2.1.1.3.3.2.1.cmml" xref="A7.Ex5.m2.1.1.3.3.2">subscript</csymbol><ci id="A7.Ex5.m2.1.1.3.3.2.2.cmml" xref="A7.Ex5.m2.1.1.3.3.2.2">𝝅</ci><apply id="A7.Ex5.m2.1.1.3.3.2.3.cmml" xref="A7.Ex5.m2.1.1.3.3.2.3"><times id="A7.Ex5.m2.1.1.3.3.2.3.1.cmml" xref="A7.Ex5.m2.1.1.3.3.2.3.1"></times><ci id="A7.Ex5.m2.1.1.3.3.2.3.2.cmml" xref="A7.Ex5.m2.1.1.3.3.2.3.2">𝑠</ci><ci id="A7.Ex5.m2.1.1.3.3.2.3.3.cmml" xref="A7.Ex5.m2.1.1.3.3.2.3.3">𝑗</ci></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A7.Ex5.m2.1c">\displaystyle-\frac{\lambda}{2}\sum_{j}\bm{\pi}_{sj}(\mathbf{w}_{sj}-\mathbf{w}_{j})^{2}-\lambda_{0}\sum_{j}\bm{\pi}_{sj}</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
<tbody id="A7.E39"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_eqn_cell"></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math id="A7.E39.m1.2" class="ltx_Math" alttext="\displaystyle+\sum_{j}\left(\bm{\pi}_{sj}\log\bm{\theta}_{j}+(1-\bm{\pi}_{sj})\log(1-\bm{\theta}_{j})\right)+C." display="inline"><semantics id="A7.E39.m1.2a"><mrow id="A7.E39.m1.2.2.1" xref="A7.E39.m1.2.2.1.1.cmml"><mrow id="A7.E39.m1.2.2.1.1" xref="A7.E39.m1.2.2.1.1.cmml"><mrow id="A7.E39.m1.2.2.1.1.1" xref="A7.E39.m1.2.2.1.1.1.cmml"><mo id="A7.E39.m1.2.2.1.1.1a" xref="A7.E39.m1.2.2.1.1.1.cmml">+</mo><mrow id="A7.E39.m1.2.2.1.1.1.1" xref="A7.E39.m1.2.2.1.1.1.1.cmml"><mstyle displaystyle="true" id="A7.E39.m1.2.2.1.1.1.1.2" xref="A7.E39.m1.2.2.1.1.1.1.2.cmml"><munder id="A7.E39.m1.2.2.1.1.1.1.2a" xref="A7.E39.m1.2.2.1.1.1.1.2.cmml"><mo movablelimits="false" id="A7.E39.m1.2.2.1.1.1.1.2.2" xref="A7.E39.m1.2.2.1.1.1.1.2.2.cmml">∑</mo><mi id="A7.E39.m1.2.2.1.1.1.1.2.3" xref="A7.E39.m1.2.2.1.1.1.1.2.3.cmml">j</mi></munder></mstyle><mrow id="A7.E39.m1.2.2.1.1.1.1.1.1" xref="A7.E39.m1.2.2.1.1.1.1.1.1.1.cmml"><mo id="A7.E39.m1.2.2.1.1.1.1.1.1.2" xref="A7.E39.m1.2.2.1.1.1.1.1.1.1.cmml">(</mo><mrow id="A7.E39.m1.2.2.1.1.1.1.1.1.1" xref="A7.E39.m1.2.2.1.1.1.1.1.1.1.cmml"><mrow id="A7.E39.m1.2.2.1.1.1.1.1.1.1.4" xref="A7.E39.m1.2.2.1.1.1.1.1.1.1.4.cmml"><msub id="A7.E39.m1.2.2.1.1.1.1.1.1.1.4.2" xref="A7.E39.m1.2.2.1.1.1.1.1.1.1.4.2.cmml"><mi id="A7.E39.m1.2.2.1.1.1.1.1.1.1.4.2.2" xref="A7.E39.m1.2.2.1.1.1.1.1.1.1.4.2.2.cmml">𝝅</mi><mrow id="A7.E39.m1.2.2.1.1.1.1.1.1.1.4.2.3" xref="A7.E39.m1.2.2.1.1.1.1.1.1.1.4.2.3.cmml"><mi id="A7.E39.m1.2.2.1.1.1.1.1.1.1.4.2.3.2" xref="A7.E39.m1.2.2.1.1.1.1.1.1.1.4.2.3.2.cmml">s</mi><mo lspace="0em" rspace="0em" id="A7.E39.m1.2.2.1.1.1.1.1.1.1.4.2.3.1" xref="A7.E39.m1.2.2.1.1.1.1.1.1.1.4.2.3.1.cmml">​</mo><mi id="A7.E39.m1.2.2.1.1.1.1.1.1.1.4.2.3.3" xref="A7.E39.m1.2.2.1.1.1.1.1.1.1.4.2.3.3.cmml">j</mi></mrow></msub><mo lspace="0.167em" rspace="0em" id="A7.E39.m1.2.2.1.1.1.1.1.1.1.4.1" xref="A7.E39.m1.2.2.1.1.1.1.1.1.1.4.1.cmml">​</mo><mrow id="A7.E39.m1.2.2.1.1.1.1.1.1.1.4.3" xref="A7.E39.m1.2.2.1.1.1.1.1.1.1.4.3.cmml"><mi id="A7.E39.m1.2.2.1.1.1.1.1.1.1.4.3.1" xref="A7.E39.m1.2.2.1.1.1.1.1.1.1.4.3.1.cmml">log</mi><mo lspace="0.167em" id="A7.E39.m1.2.2.1.1.1.1.1.1.1.4.3a" xref="A7.E39.m1.2.2.1.1.1.1.1.1.1.4.3.cmml">⁡</mo><msub id="A7.E39.m1.2.2.1.1.1.1.1.1.1.4.3.2" xref="A7.E39.m1.2.2.1.1.1.1.1.1.1.4.3.2.cmml"><mi id="A7.E39.m1.2.2.1.1.1.1.1.1.1.4.3.2.2" xref="A7.E39.m1.2.2.1.1.1.1.1.1.1.4.3.2.2.cmml">𝜽</mi><mi id="A7.E39.m1.2.2.1.1.1.1.1.1.1.4.3.2.3" xref="A7.E39.m1.2.2.1.1.1.1.1.1.1.4.3.2.3.cmml">j</mi></msub></mrow></mrow><mo id="A7.E39.m1.2.2.1.1.1.1.1.1.1.3" xref="A7.E39.m1.2.2.1.1.1.1.1.1.1.3.cmml">+</mo><mrow id="A7.E39.m1.2.2.1.1.1.1.1.1.1.2" xref="A7.E39.m1.2.2.1.1.1.1.1.1.1.2.cmml"><mrow id="A7.E39.m1.2.2.1.1.1.1.1.1.1.1.1.1" xref="A7.E39.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="A7.E39.m1.2.2.1.1.1.1.1.1.1.1.1.1.2" xref="A7.E39.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="A7.E39.m1.2.2.1.1.1.1.1.1.1.1.1.1.1" xref="A7.E39.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.cmml"><mn id="A7.E39.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.2" xref="A7.E39.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.2.cmml">1</mn><mo id="A7.E39.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.1" xref="A7.E39.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.1.cmml">−</mo><msub id="A7.E39.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.3" xref="A7.E39.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.3.cmml"><mi id="A7.E39.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.3.2" xref="A7.E39.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.3.2.cmml">𝝅</mi><mrow id="A7.E39.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.3.3" xref="A7.E39.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.3.3.cmml"><mi id="A7.E39.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.3.3.2" xref="A7.E39.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.3.3.2.cmml">s</mi><mo lspace="0em" rspace="0em" id="A7.E39.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.3.3.1" xref="A7.E39.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.3.3.1.cmml">​</mo><mi id="A7.E39.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.3.3.3" xref="A7.E39.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.3.3.3.cmml">j</mi></mrow></msub></mrow><mo stretchy="false" id="A7.E39.m1.2.2.1.1.1.1.1.1.1.1.1.1.3" xref="A7.E39.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow><mo lspace="0.167em" rspace="0em" id="A7.E39.m1.2.2.1.1.1.1.1.1.1.2.3" xref="A7.E39.m1.2.2.1.1.1.1.1.1.1.2.3.cmml">​</mo><mrow id="A7.E39.m1.2.2.1.1.1.1.1.1.1.2.2.1" xref="A7.E39.m1.2.2.1.1.1.1.1.1.1.2.2.2.cmml"><mi id="A7.E39.m1.1.1" xref="A7.E39.m1.1.1.cmml">log</mi><mo id="A7.E39.m1.2.2.1.1.1.1.1.1.1.2.2.1a" xref="A7.E39.m1.2.2.1.1.1.1.1.1.1.2.2.2.cmml">⁡</mo><mrow id="A7.E39.m1.2.2.1.1.1.1.1.1.1.2.2.1.1" xref="A7.E39.m1.2.2.1.1.1.1.1.1.1.2.2.2.cmml"><mo stretchy="false" id="A7.E39.m1.2.2.1.1.1.1.1.1.1.2.2.1.1.2" xref="A7.E39.m1.2.2.1.1.1.1.1.1.1.2.2.2.cmml">(</mo><mrow id="A7.E39.m1.2.2.1.1.1.1.1.1.1.2.2.1.1.1" xref="A7.E39.m1.2.2.1.1.1.1.1.1.1.2.2.1.1.1.cmml"><mn id="A7.E39.m1.2.2.1.1.1.1.1.1.1.2.2.1.1.1.2" xref="A7.E39.m1.2.2.1.1.1.1.1.1.1.2.2.1.1.1.2.cmml">1</mn><mo id="A7.E39.m1.2.2.1.1.1.1.1.1.1.2.2.1.1.1.1" xref="A7.E39.m1.2.2.1.1.1.1.1.1.1.2.2.1.1.1.1.cmml">−</mo><msub id="A7.E39.m1.2.2.1.1.1.1.1.1.1.2.2.1.1.1.3" xref="A7.E39.m1.2.2.1.1.1.1.1.1.1.2.2.1.1.1.3.cmml"><mi id="A7.E39.m1.2.2.1.1.1.1.1.1.1.2.2.1.1.1.3.2" xref="A7.E39.m1.2.2.1.1.1.1.1.1.1.2.2.1.1.1.3.2.cmml">𝜽</mi><mi id="A7.E39.m1.2.2.1.1.1.1.1.1.1.2.2.1.1.1.3.3" xref="A7.E39.m1.2.2.1.1.1.1.1.1.1.2.2.1.1.1.3.3.cmml">j</mi></msub></mrow><mo stretchy="false" id="A7.E39.m1.2.2.1.1.1.1.1.1.1.2.2.1.1.3" xref="A7.E39.m1.2.2.1.1.1.1.1.1.1.2.2.2.cmml">)</mo></mrow></mrow></mrow></mrow><mo id="A7.E39.m1.2.2.1.1.1.1.1.1.3" xref="A7.E39.m1.2.2.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><mo id="A7.E39.m1.2.2.1.1.2" xref="A7.E39.m1.2.2.1.1.2.cmml">+</mo><mi id="A7.E39.m1.2.2.1.1.3" xref="A7.E39.m1.2.2.1.1.3.cmml">C</mi></mrow><mo lspace="0em" id="A7.E39.m1.2.2.1.2" xref="A7.E39.m1.2.2.1.1.cmml">.</mo></mrow><annotation-xml encoding="MathML-Content" id="A7.E39.m1.2b"><apply id="A7.E39.m1.2.2.1.1.cmml" xref="A7.E39.m1.2.2.1"><plus id="A7.E39.m1.2.2.1.1.2.cmml" xref="A7.E39.m1.2.2.1.1.2"></plus><apply id="A7.E39.m1.2.2.1.1.1.cmml" xref="A7.E39.m1.2.2.1.1.1"><plus id="A7.E39.m1.2.2.1.1.1.2.cmml" xref="A7.E39.m1.2.2.1.1.1"></plus><apply id="A7.E39.m1.2.2.1.1.1.1.cmml" xref="A7.E39.m1.2.2.1.1.1.1"><apply id="A7.E39.m1.2.2.1.1.1.1.2.cmml" xref="A7.E39.m1.2.2.1.1.1.1.2"><csymbol cd="ambiguous" id="A7.E39.m1.2.2.1.1.1.1.2.1.cmml" xref="A7.E39.m1.2.2.1.1.1.1.2">subscript</csymbol><sum id="A7.E39.m1.2.2.1.1.1.1.2.2.cmml" xref="A7.E39.m1.2.2.1.1.1.1.2.2"></sum><ci id="A7.E39.m1.2.2.1.1.1.1.2.3.cmml" xref="A7.E39.m1.2.2.1.1.1.1.2.3">𝑗</ci></apply><apply id="A7.E39.m1.2.2.1.1.1.1.1.1.1.cmml" xref="A7.E39.m1.2.2.1.1.1.1.1.1"><plus id="A7.E39.m1.2.2.1.1.1.1.1.1.1.3.cmml" xref="A7.E39.m1.2.2.1.1.1.1.1.1.1.3"></plus><apply id="A7.E39.m1.2.2.1.1.1.1.1.1.1.4.cmml" xref="A7.E39.m1.2.2.1.1.1.1.1.1.1.4"><times id="A7.E39.m1.2.2.1.1.1.1.1.1.1.4.1.cmml" xref="A7.E39.m1.2.2.1.1.1.1.1.1.1.4.1"></times><apply id="A7.E39.m1.2.2.1.1.1.1.1.1.1.4.2.cmml" xref="A7.E39.m1.2.2.1.1.1.1.1.1.1.4.2"><csymbol cd="ambiguous" id="A7.E39.m1.2.2.1.1.1.1.1.1.1.4.2.1.cmml" xref="A7.E39.m1.2.2.1.1.1.1.1.1.1.4.2">subscript</csymbol><ci id="A7.E39.m1.2.2.1.1.1.1.1.1.1.4.2.2.cmml" xref="A7.E39.m1.2.2.1.1.1.1.1.1.1.4.2.2">𝝅</ci><apply id="A7.E39.m1.2.2.1.1.1.1.1.1.1.4.2.3.cmml" xref="A7.E39.m1.2.2.1.1.1.1.1.1.1.4.2.3"><times id="A7.E39.m1.2.2.1.1.1.1.1.1.1.4.2.3.1.cmml" xref="A7.E39.m1.2.2.1.1.1.1.1.1.1.4.2.3.1"></times><ci id="A7.E39.m1.2.2.1.1.1.1.1.1.1.4.2.3.2.cmml" xref="A7.E39.m1.2.2.1.1.1.1.1.1.1.4.2.3.2">𝑠</ci><ci id="A7.E39.m1.2.2.1.1.1.1.1.1.1.4.2.3.3.cmml" xref="A7.E39.m1.2.2.1.1.1.1.1.1.1.4.2.3.3">𝑗</ci></apply></apply><apply id="A7.E39.m1.2.2.1.1.1.1.1.1.1.4.3.cmml" xref="A7.E39.m1.2.2.1.1.1.1.1.1.1.4.3"><log id="A7.E39.m1.2.2.1.1.1.1.1.1.1.4.3.1.cmml" xref="A7.E39.m1.2.2.1.1.1.1.1.1.1.4.3.1"></log><apply id="A7.E39.m1.2.2.1.1.1.1.1.1.1.4.3.2.cmml" xref="A7.E39.m1.2.2.1.1.1.1.1.1.1.4.3.2"><csymbol cd="ambiguous" id="A7.E39.m1.2.2.1.1.1.1.1.1.1.4.3.2.1.cmml" xref="A7.E39.m1.2.2.1.1.1.1.1.1.1.4.3.2">subscript</csymbol><ci id="A7.E39.m1.2.2.1.1.1.1.1.1.1.4.3.2.2.cmml" xref="A7.E39.m1.2.2.1.1.1.1.1.1.1.4.3.2.2">𝜽</ci><ci id="A7.E39.m1.2.2.1.1.1.1.1.1.1.4.3.2.3.cmml" xref="A7.E39.m1.2.2.1.1.1.1.1.1.1.4.3.2.3">𝑗</ci></apply></apply></apply><apply id="A7.E39.m1.2.2.1.1.1.1.1.1.1.2.cmml" xref="A7.E39.m1.2.2.1.1.1.1.1.1.1.2"><times id="A7.E39.m1.2.2.1.1.1.1.1.1.1.2.3.cmml" xref="A7.E39.m1.2.2.1.1.1.1.1.1.1.2.3"></times><apply id="A7.E39.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="A7.E39.m1.2.2.1.1.1.1.1.1.1.1.1.1"><minus id="A7.E39.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="A7.E39.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.1"></minus><cn type="integer" id="A7.E39.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="A7.E39.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.2">1</cn><apply id="A7.E39.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="A7.E39.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="A7.E39.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.3.1.cmml" xref="A7.E39.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.3">subscript</csymbol><ci id="A7.E39.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.3.2.cmml" xref="A7.E39.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.3.2">𝝅</ci><apply id="A7.E39.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.3.3.cmml" xref="A7.E39.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.3.3"><times id="A7.E39.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.3.3.1.cmml" xref="A7.E39.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.3.3.1"></times><ci id="A7.E39.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.3.3.2.cmml" xref="A7.E39.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.3.3.2">𝑠</ci><ci id="A7.E39.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.3.3.3.cmml" xref="A7.E39.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.3.3.3">𝑗</ci></apply></apply></apply><apply id="A7.E39.m1.2.2.1.1.1.1.1.1.1.2.2.2.cmml" xref="A7.E39.m1.2.2.1.1.1.1.1.1.1.2.2.1"><log id="A7.E39.m1.1.1.cmml" xref="A7.E39.m1.1.1"></log><apply id="A7.E39.m1.2.2.1.1.1.1.1.1.1.2.2.1.1.1.cmml" xref="A7.E39.m1.2.2.1.1.1.1.1.1.1.2.2.1.1.1"><minus id="A7.E39.m1.2.2.1.1.1.1.1.1.1.2.2.1.1.1.1.cmml" xref="A7.E39.m1.2.2.1.1.1.1.1.1.1.2.2.1.1.1.1"></minus><cn type="integer" id="A7.E39.m1.2.2.1.1.1.1.1.1.1.2.2.1.1.1.2.cmml" xref="A7.E39.m1.2.2.1.1.1.1.1.1.1.2.2.1.1.1.2">1</cn><apply id="A7.E39.m1.2.2.1.1.1.1.1.1.1.2.2.1.1.1.3.cmml" xref="A7.E39.m1.2.2.1.1.1.1.1.1.1.2.2.1.1.1.3"><csymbol cd="ambiguous" id="A7.E39.m1.2.2.1.1.1.1.1.1.1.2.2.1.1.1.3.1.cmml" xref="A7.E39.m1.2.2.1.1.1.1.1.1.1.2.2.1.1.1.3">subscript</csymbol><ci id="A7.E39.m1.2.2.1.1.1.1.1.1.1.2.2.1.1.1.3.2.cmml" xref="A7.E39.m1.2.2.1.1.1.1.1.1.1.2.2.1.1.1.3.2">𝜽</ci><ci id="A7.E39.m1.2.2.1.1.1.1.1.1.1.2.2.1.1.1.3.3.cmml" xref="A7.E39.m1.2.2.1.1.1.1.1.1.1.2.2.1.1.1.3.3">𝑗</ci></apply></apply></apply></apply></apply></apply></apply><ci id="A7.E39.m1.2.2.1.1.3.cmml" xref="A7.E39.m1.2.2.1.1.3">𝐶</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A7.E39.m1.2c">\displaystyle+\sum_{j}\left(\bm{\pi}_{sj}\log\bm{\theta}_{j}+(1-\bm{\pi}_{sj})\log(1-\bm{\theta}_{j})\right)+C.</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(39)</span></td>
</tr></tbody>
</table>
</div>
</section>
<section id="A8" class="ltx_appendix">
<h2 class="ltx_title ltx_title_appendix">
<span class="ltx_tag ltx_tag_appendix">Appendix H </span>Local optimization of the binary gates</h2>

<div id="A8.p1" class="ltx_para">
<p id="A8.p1.6" class="ltx_p">We propose to rewrite the local loss in Eq. <a href="#S3.E16" title="In 3 The FedSparse algorithm: sparsity in federated learning ‣ An Expectation-Maximization Perspective on Federated Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">16</span></a> to</p>
<table id="A10.EGx33" class="ltx_equationgroup ltx_eqn_align ltx_eqn_table">

<tbody id="A8.Ex6"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math id="A8.Ex6.m1.2" class="ltx_math_unparsed" alttext="\displaystyle\mathcal{L}_{s}(\mathcal{D}_{s},\mathbf{w},\bm{\theta},\bm{\phi}_{s}," display="inline"><semantics id="A8.Ex6.m1.2a"><mrow id="A8.Ex6.m1.2b"><msub id="A8.Ex6.m1.2.3"><mi class="ltx_font_mathcaligraphic" id="A8.Ex6.m1.2.3.2">ℒ</mi><mi id="A8.Ex6.m1.2.3.3">s</mi></msub><mrow id="A8.Ex6.m1.2.4"><mo stretchy="false" id="A8.Ex6.m1.2.4.1">(</mo><msub id="A8.Ex6.m1.2.4.2"><mi class="ltx_font_mathcaligraphic" id="A8.Ex6.m1.2.4.2.2">𝒟</mi><mi id="A8.Ex6.m1.2.4.2.3">s</mi></msub><mo id="A8.Ex6.m1.2.4.3">,</mo><mi id="A8.Ex6.m1.1.1">𝐰</mi><mo id="A8.Ex6.m1.2.4.4">,</mo><mi id="A8.Ex6.m1.2.2">𝜽</mi><mo id="A8.Ex6.m1.2.4.5">,</mo><msub id="A8.Ex6.m1.2.4.6"><mi class="ltx_mathvariant_bold-italic" mathvariant="bold-italic" id="A8.Ex6.m1.2.4.6.2">ϕ</mi><mi id="A8.Ex6.m1.2.4.6.3">s</mi></msub><mo id="A8.Ex6.m1.2.4.7">,</mo></mrow></mrow><annotation encoding="application/x-tex" id="A8.Ex6.m1.2c">\displaystyle\mathcal{L}_{s}(\mathcal{D}_{s},\mathbf{w},\bm{\theta},\bm{\phi}_{s},</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math id="A8.Ex6.m2.1" class="ltx_math_unparsed" alttext="\displaystyle\bm{\pi}_{s}):=\mathbb{E}_{q_{\bm{\pi}_{s}}(\mathbf{z}_{s})}\bigg{[}\sum_{i}^{N_{s}}L(\mathcal{D}_{si},\mathbf{w}_{s}\odot\mathbf{z}_{s})-\lambda\sum_{j}\mathbb{I}[\mathbf{z}_{sj}\neq 0](\mathbf{w}_{sj}-\mathbf{w})^{2}" display="inline"><semantics id="A8.Ex6.m2.1a"><mrow id="A8.Ex6.m2.1b"><msub id="A8.Ex6.m2.1.2"><mi id="A8.Ex6.m2.1.2.2">𝝅</mi><mi id="A8.Ex6.m2.1.2.3">s</mi></msub><mo rspace="0.278em" stretchy="false" id="A8.Ex6.m2.1.3">)</mo><mo rspace="0.278em" id="A8.Ex6.m2.1.4">:=</mo><mi id="A8.Ex6.m2.1.5">𝔼</mi><msub id="A8.Ex6.m2.1.1"><mi id="A8.Ex6.m2.1.1a"></mi><mrow id="A8.Ex6.m2.1.1.1"><msub id="A8.Ex6.m2.1.1.1.3"><mi id="A8.Ex6.m2.1.1.1.3.2">q</mi><msub id="A8.Ex6.m2.1.1.1.3.3"><mi id="A8.Ex6.m2.1.1.1.3.3.2">𝝅</mi><mi id="A8.Ex6.m2.1.1.1.3.3.3">s</mi></msub></msub><mo lspace="0em" rspace="0em" id="A8.Ex6.m2.1.1.1.2">​</mo><mrow id="A8.Ex6.m2.1.1.1.1.1"><mo stretchy="false" id="A8.Ex6.m2.1.1.1.1.1.2">(</mo><msub id="A8.Ex6.m2.1.1.1.1.1.1"><mi id="A8.Ex6.m2.1.1.1.1.1.1.2">𝐳</mi><mi id="A8.Ex6.m2.1.1.1.1.1.1.3">s</mi></msub><mo stretchy="false" id="A8.Ex6.m2.1.1.1.1.1.3">)</mo></mrow></mrow></msub><mo maxsize="210%" minsize="210%" id="A8.Ex6.m2.1.6">[</mo><mstyle displaystyle="true" id="A8.Ex6.m2.1.7"><munderover id="A8.Ex6.m2.1.7a"><mo movablelimits="false" id="A8.Ex6.m2.1.7.2.2">∑</mo><mi id="A8.Ex6.m2.1.7.2.3">i</mi><msub id="A8.Ex6.m2.1.7.3"><mi id="A8.Ex6.m2.1.7.3.2">N</mi><mi id="A8.Ex6.m2.1.7.3.3">s</mi></msub></munderover></mstyle><mi id="A8.Ex6.m2.1.8">L</mi><mrow id="A8.Ex6.m2.1.9"><mo stretchy="false" id="A8.Ex6.m2.1.9.1">(</mo><msub id="A8.Ex6.m2.1.9.2"><mi class="ltx_font_mathcaligraphic" id="A8.Ex6.m2.1.9.2.2">𝒟</mi><mrow id="A8.Ex6.m2.1.9.2.3"><mi id="A8.Ex6.m2.1.9.2.3.2">s</mi><mo lspace="0em" rspace="0em" id="A8.Ex6.m2.1.9.2.3.1">​</mo><mi id="A8.Ex6.m2.1.9.2.3.3">i</mi></mrow></msub><mo id="A8.Ex6.m2.1.9.3">,</mo><msub id="A8.Ex6.m2.1.9.4"><mi id="A8.Ex6.m2.1.9.4.2">𝐰</mi><mi id="A8.Ex6.m2.1.9.4.3">s</mi></msub><mo lspace="0.222em" rspace="0.222em" id="A8.Ex6.m2.1.9.5">⊙</mo><msub id="A8.Ex6.m2.1.9.6"><mi id="A8.Ex6.m2.1.9.6.2">𝐳</mi><mi id="A8.Ex6.m2.1.9.6.3">s</mi></msub><mo stretchy="false" id="A8.Ex6.m2.1.9.7">)</mo></mrow><mo id="A8.Ex6.m2.1.10">−</mo><mi id="A8.Ex6.m2.1.11">λ</mi><mstyle displaystyle="true" id="A8.Ex6.m2.1.12"><munder id="A8.Ex6.m2.1.12a"><mo movablelimits="false" id="A8.Ex6.m2.1.12.2">∑</mo><mi id="A8.Ex6.m2.1.12.3">j</mi></munder></mstyle><mi id="A8.Ex6.m2.1.13">𝕀</mi><mrow id="A8.Ex6.m2.1.14"><mo stretchy="false" id="A8.Ex6.m2.1.14.1">[</mo><msub id="A8.Ex6.m2.1.14.2"><mi id="A8.Ex6.m2.1.14.2.2">𝐳</mi><mrow id="A8.Ex6.m2.1.14.2.3"><mi id="A8.Ex6.m2.1.14.2.3.2">s</mi><mo lspace="0em" rspace="0em" id="A8.Ex6.m2.1.14.2.3.1">​</mo><mi id="A8.Ex6.m2.1.14.2.3.3">j</mi></mrow></msub><mo id="A8.Ex6.m2.1.14.3">≠</mo><mn id="A8.Ex6.m2.1.14.4">0</mn><mo stretchy="false" id="A8.Ex6.m2.1.14.5">]</mo></mrow><msup id="A8.Ex6.m2.1.15"><mrow id="A8.Ex6.m2.1.15.2"><mo stretchy="false" id="A8.Ex6.m2.1.15.2.1">(</mo><msub id="A8.Ex6.m2.1.15.2.2"><mi id="A8.Ex6.m2.1.15.2.2.2">𝐰</mi><mrow id="A8.Ex6.m2.1.15.2.2.3"><mi id="A8.Ex6.m2.1.15.2.2.3.2">s</mi><mo lspace="0em" rspace="0em" id="A8.Ex6.m2.1.15.2.2.3.1">​</mo><mi id="A8.Ex6.m2.1.15.2.2.3.3">j</mi></mrow></msub><mo id="A8.Ex6.m2.1.15.2.3">−</mo><mi id="A8.Ex6.m2.1.15.2.4">𝐰</mi><mo stretchy="false" id="A8.Ex6.m2.1.15.2.5">)</mo></mrow><mn id="A8.Ex6.m2.1.15.3">2</mn></msup></mrow><annotation encoding="application/x-tex" id="A8.Ex6.m2.1c">\displaystyle\bm{\pi}_{s}):=\mathbb{E}_{q_{\bm{\pi}_{s}}(\mathbf{z}_{s})}\bigg{[}\sum_{i}^{N_{s}}L(\mathcal{D}_{si},\mathbf{w}_{s}\odot\mathbf{z}_{s})-\lambda\sum_{j}\mathbb{I}[\mathbf{z}_{sj}\neq 0](\mathbf{w}_{sj}-\mathbf{w})^{2}</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
<tbody id="A8.E40"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_eqn_cell"></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math id="A8.E40.m1.1" class="ltx_math_unparsed" alttext="\displaystyle\qquad-\lambda_{0}\sum_{j}\mathbb{I}[\mathbf{z}_{sj}\neq 0]+\sum_{j}\left(\mathbb{I}[\mathbf{z}_{sj}\neq 0]\log\frac{\bm{\theta}_{j}}{1-\bm{\theta}_{j}}+\log(1-\bm{\theta}_{j})\right)\bigg{]}," display="inline"><semantics id="A8.E40.m1.1a"><mrow id="A8.E40.m1.1b"><mo id="A8.E40.m1.1.2">−</mo><msub id="A8.E40.m1.1.3"><mi id="A8.E40.m1.1.3.2">λ</mi><mn id="A8.E40.m1.1.3.3">0</mn></msub><mstyle displaystyle="true" id="A8.E40.m1.1.4"><munder id="A8.E40.m1.1.4a"><mo movablelimits="false" id="A8.E40.m1.1.4.2">∑</mo><mi id="A8.E40.m1.1.4.3">j</mi></munder></mstyle><mi id="A8.E40.m1.1.5">𝕀</mi><mrow id="A8.E40.m1.1.6"><mo stretchy="false" id="A8.E40.m1.1.6.1">[</mo><msub id="A8.E40.m1.1.6.2"><mi id="A8.E40.m1.1.6.2.2">𝐳</mi><mrow id="A8.E40.m1.1.6.2.3"><mi id="A8.E40.m1.1.6.2.3.2">s</mi><mo lspace="0em" rspace="0em" id="A8.E40.m1.1.6.2.3.1">​</mo><mi id="A8.E40.m1.1.6.2.3.3">j</mi></mrow></msub><mo id="A8.E40.m1.1.6.3">≠</mo><mn id="A8.E40.m1.1.6.4">0</mn><mo stretchy="false" id="A8.E40.m1.1.6.5">]</mo></mrow><mo id="A8.E40.m1.1.7">+</mo><mstyle displaystyle="true" id="A8.E40.m1.1.8"><munder id="A8.E40.m1.1.8a"><mo movablelimits="false" id="A8.E40.m1.1.8.2">∑</mo><mi id="A8.E40.m1.1.8.3">j</mi></munder></mstyle><mrow id="A8.E40.m1.1.9"><mo id="A8.E40.m1.1.9.1">(</mo><mi id="A8.E40.m1.1.9.2">𝕀</mi><mrow id="A8.E40.m1.1.9.3"><mo stretchy="false" id="A8.E40.m1.1.9.3.1">[</mo><msub id="A8.E40.m1.1.9.3.2"><mi id="A8.E40.m1.1.9.3.2.2">𝐳</mi><mrow id="A8.E40.m1.1.9.3.2.3"><mi id="A8.E40.m1.1.9.3.2.3.2">s</mi><mo lspace="0em" rspace="0em" id="A8.E40.m1.1.9.3.2.3.1">​</mo><mi id="A8.E40.m1.1.9.3.2.3.3">j</mi></mrow></msub><mo id="A8.E40.m1.1.9.3.3">≠</mo><mn id="A8.E40.m1.1.9.3.4">0</mn><mo rspace="0.167em" stretchy="false" id="A8.E40.m1.1.9.3.5">]</mo></mrow><mi id="A8.E40.m1.1.9.4">log</mi><mstyle displaystyle="true" id="A8.E40.m1.1.9.5"><mfrac id="A8.E40.m1.1.9.5a"><msub id="A8.E40.m1.1.9.5.2"><mi id="A8.E40.m1.1.9.5.2.2">𝜽</mi><mi id="A8.E40.m1.1.9.5.2.3">j</mi></msub><mrow id="A8.E40.m1.1.9.5.3"><mn id="A8.E40.m1.1.9.5.3.2">1</mn><mo id="A8.E40.m1.1.9.5.3.1">−</mo><msub id="A8.E40.m1.1.9.5.3.3"><mi id="A8.E40.m1.1.9.5.3.3.2">𝜽</mi><mi id="A8.E40.m1.1.9.5.3.3.3">j</mi></msub></mrow></mfrac></mstyle><mo id="A8.E40.m1.1.9.6">+</mo><mi id="A8.E40.m1.1.1">log</mi><mrow id="A8.E40.m1.1.9.7"><mo stretchy="false" id="A8.E40.m1.1.9.7.1">(</mo><mn id="A8.E40.m1.1.9.7.2">1</mn><mo id="A8.E40.m1.1.9.7.3">−</mo><msub id="A8.E40.m1.1.9.7.4"><mi id="A8.E40.m1.1.9.7.4.2">𝜽</mi><mi id="A8.E40.m1.1.9.7.4.3">j</mi></msub><mo stretchy="false" id="A8.E40.m1.1.9.7.5">)</mo></mrow><mo id="A8.E40.m1.1.9.8">)</mo></mrow><mo maxsize="210%" minsize="210%" id="A8.E40.m1.1.10">]</mo><mo id="A8.E40.m1.1.11">,</mo></mrow><annotation encoding="application/x-tex" id="A8.E40.m1.1c">\displaystyle\qquad-\lambda_{0}\sum_{j}\mathbb{I}[\mathbf{z}_{sj}\neq 0]+\sum_{j}\left(\mathbb{I}[\mathbf{z}_{sj}\neq 0]\log\frac{\bm{\theta}_{j}}{1-\bm{\theta}_{j}}+\log(1-\bm{\theta}_{j})\right)\bigg{]},</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(40)</span></td>
</tr></tbody>
</table>
<p id="A8.p1.3" class="ltx_p">and then replace the Bernoulli distribution <math id="A8.p1.1.m1.1" class="ltx_Math" alttext="q_{\bm{\pi}_{s}}(\mathbf{z}_{s})" display="inline"><semantics id="A8.p1.1.m1.1a"><mrow id="A8.p1.1.m1.1.1" xref="A8.p1.1.m1.1.1.cmml"><msub id="A8.p1.1.m1.1.1.3" xref="A8.p1.1.m1.1.1.3.cmml"><mi id="A8.p1.1.m1.1.1.3.2" xref="A8.p1.1.m1.1.1.3.2.cmml">q</mi><msub id="A8.p1.1.m1.1.1.3.3" xref="A8.p1.1.m1.1.1.3.3.cmml"><mi id="A8.p1.1.m1.1.1.3.3.2" xref="A8.p1.1.m1.1.1.3.3.2.cmml">𝝅</mi><mi id="A8.p1.1.m1.1.1.3.3.3" xref="A8.p1.1.m1.1.1.3.3.3.cmml">s</mi></msub></msub><mo lspace="0em" rspace="0em" id="A8.p1.1.m1.1.1.2" xref="A8.p1.1.m1.1.1.2.cmml">​</mo><mrow id="A8.p1.1.m1.1.1.1.1" xref="A8.p1.1.m1.1.1.1.1.1.cmml"><mo stretchy="false" id="A8.p1.1.m1.1.1.1.1.2" xref="A8.p1.1.m1.1.1.1.1.1.cmml">(</mo><msub id="A8.p1.1.m1.1.1.1.1.1" xref="A8.p1.1.m1.1.1.1.1.1.cmml"><mi id="A8.p1.1.m1.1.1.1.1.1.2" xref="A8.p1.1.m1.1.1.1.1.1.2.cmml">𝐳</mi><mi id="A8.p1.1.m1.1.1.1.1.1.3" xref="A8.p1.1.m1.1.1.1.1.1.3.cmml">s</mi></msub><mo stretchy="false" id="A8.p1.1.m1.1.1.1.1.3" xref="A8.p1.1.m1.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="A8.p1.1.m1.1b"><apply id="A8.p1.1.m1.1.1.cmml" xref="A8.p1.1.m1.1.1"><times id="A8.p1.1.m1.1.1.2.cmml" xref="A8.p1.1.m1.1.1.2"></times><apply id="A8.p1.1.m1.1.1.3.cmml" xref="A8.p1.1.m1.1.1.3"><csymbol cd="ambiguous" id="A8.p1.1.m1.1.1.3.1.cmml" xref="A8.p1.1.m1.1.1.3">subscript</csymbol><ci id="A8.p1.1.m1.1.1.3.2.cmml" xref="A8.p1.1.m1.1.1.3.2">𝑞</ci><apply id="A8.p1.1.m1.1.1.3.3.cmml" xref="A8.p1.1.m1.1.1.3.3"><csymbol cd="ambiguous" id="A8.p1.1.m1.1.1.3.3.1.cmml" xref="A8.p1.1.m1.1.1.3.3">subscript</csymbol><ci id="A8.p1.1.m1.1.1.3.3.2.cmml" xref="A8.p1.1.m1.1.1.3.3.2">𝝅</ci><ci id="A8.p1.1.m1.1.1.3.3.3.cmml" xref="A8.p1.1.m1.1.1.3.3.3">𝑠</ci></apply></apply><apply id="A8.p1.1.m1.1.1.1.1.1.cmml" xref="A8.p1.1.m1.1.1.1.1"><csymbol cd="ambiguous" id="A8.p1.1.m1.1.1.1.1.1.1.cmml" xref="A8.p1.1.m1.1.1.1.1">subscript</csymbol><ci id="A8.p1.1.m1.1.1.1.1.1.2.cmml" xref="A8.p1.1.m1.1.1.1.1.1.2">𝐳</ci><ci id="A8.p1.1.m1.1.1.1.1.1.3.cmml" xref="A8.p1.1.m1.1.1.1.1.1.3">𝑠</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A8.p1.1.m1.1c">q_{\bm{\pi}_{s}}(\mathbf{z}_{s})</annotation></semantics></math> with a continuous relaxation, the hard-concrete distribution <span id="A8.p1.3.1" class="ltx_ERROR undefined">\citepappendix</span>louizos2017learning. Let the continuous relaxation be <math id="A8.p1.2.m2.1" class="ltx_Math" alttext="r_{\mathbf{u}_{s}}(\mathbf{z}_{s})" display="inline"><semantics id="A8.p1.2.m2.1a"><mrow id="A8.p1.2.m2.1.1" xref="A8.p1.2.m2.1.1.cmml"><msub id="A8.p1.2.m2.1.1.3" xref="A8.p1.2.m2.1.1.3.cmml"><mi id="A8.p1.2.m2.1.1.3.2" xref="A8.p1.2.m2.1.1.3.2.cmml">r</mi><msub id="A8.p1.2.m2.1.1.3.3" xref="A8.p1.2.m2.1.1.3.3.cmml"><mi id="A8.p1.2.m2.1.1.3.3.2" xref="A8.p1.2.m2.1.1.3.3.2.cmml">𝐮</mi><mi id="A8.p1.2.m2.1.1.3.3.3" xref="A8.p1.2.m2.1.1.3.3.3.cmml">s</mi></msub></msub><mo lspace="0em" rspace="0em" id="A8.p1.2.m2.1.1.2" xref="A8.p1.2.m2.1.1.2.cmml">​</mo><mrow id="A8.p1.2.m2.1.1.1.1" xref="A8.p1.2.m2.1.1.1.1.1.cmml"><mo stretchy="false" id="A8.p1.2.m2.1.1.1.1.2" xref="A8.p1.2.m2.1.1.1.1.1.cmml">(</mo><msub id="A8.p1.2.m2.1.1.1.1.1" xref="A8.p1.2.m2.1.1.1.1.1.cmml"><mi id="A8.p1.2.m2.1.1.1.1.1.2" xref="A8.p1.2.m2.1.1.1.1.1.2.cmml">𝐳</mi><mi id="A8.p1.2.m2.1.1.1.1.1.3" xref="A8.p1.2.m2.1.1.1.1.1.3.cmml">s</mi></msub><mo stretchy="false" id="A8.p1.2.m2.1.1.1.1.3" xref="A8.p1.2.m2.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="A8.p1.2.m2.1b"><apply id="A8.p1.2.m2.1.1.cmml" xref="A8.p1.2.m2.1.1"><times id="A8.p1.2.m2.1.1.2.cmml" xref="A8.p1.2.m2.1.1.2"></times><apply id="A8.p1.2.m2.1.1.3.cmml" xref="A8.p1.2.m2.1.1.3"><csymbol cd="ambiguous" id="A8.p1.2.m2.1.1.3.1.cmml" xref="A8.p1.2.m2.1.1.3">subscript</csymbol><ci id="A8.p1.2.m2.1.1.3.2.cmml" xref="A8.p1.2.m2.1.1.3.2">𝑟</ci><apply id="A8.p1.2.m2.1.1.3.3.cmml" xref="A8.p1.2.m2.1.1.3.3"><csymbol cd="ambiguous" id="A8.p1.2.m2.1.1.3.3.1.cmml" xref="A8.p1.2.m2.1.1.3.3">subscript</csymbol><ci id="A8.p1.2.m2.1.1.3.3.2.cmml" xref="A8.p1.2.m2.1.1.3.3.2">𝐮</ci><ci id="A8.p1.2.m2.1.1.3.3.3.cmml" xref="A8.p1.2.m2.1.1.3.3.3">𝑠</ci></apply></apply><apply id="A8.p1.2.m2.1.1.1.1.1.cmml" xref="A8.p1.2.m2.1.1.1.1"><csymbol cd="ambiguous" id="A8.p1.2.m2.1.1.1.1.1.1.cmml" xref="A8.p1.2.m2.1.1.1.1">subscript</csymbol><ci id="A8.p1.2.m2.1.1.1.1.1.2.cmml" xref="A8.p1.2.m2.1.1.1.1.1.2">𝐳</ci><ci id="A8.p1.2.m2.1.1.1.1.1.3.cmml" xref="A8.p1.2.m2.1.1.1.1.1.3">𝑠</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A8.p1.2.m2.1c">r_{\mathbf{u}_{s}}(\mathbf{z}_{s})</annotation></semantics></math>, where <math id="A8.p1.3.m3.1" class="ltx_Math" alttext="\mathbf{u}_{s}" display="inline"><semantics id="A8.p1.3.m3.1a"><msub id="A8.p1.3.m3.1.1" xref="A8.p1.3.m3.1.1.cmml"><mi id="A8.p1.3.m3.1.1.2" xref="A8.p1.3.m3.1.1.2.cmml">𝐮</mi><mi id="A8.p1.3.m3.1.1.3" xref="A8.p1.3.m3.1.1.3.cmml">s</mi></msub><annotation-xml encoding="MathML-Content" id="A8.p1.3.m3.1b"><apply id="A8.p1.3.m3.1.1.cmml" xref="A8.p1.3.m3.1.1"><csymbol cd="ambiguous" id="A8.p1.3.m3.1.1.1.cmml" xref="A8.p1.3.m3.1.1">subscript</csymbol><ci id="A8.p1.3.m3.1.1.2.cmml" xref="A8.p1.3.m3.1.1.2">𝐮</ci><ci id="A8.p1.3.m3.1.1.3.cmml" xref="A8.p1.3.m3.1.1.3">𝑠</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A8.p1.3.m3.1c">\mathbf{u}_{s}</annotation></semantics></math> are the parameters of the surrogate distribution. In this case the local objective becomes</p>
<table id="A10.EGx34" class="ltx_equationgroup ltx_eqn_align ltx_eqn_table">

<tbody id="A8.Ex7"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math id="A8.Ex7.m1.2" class="ltx_math_unparsed" alttext="\displaystyle\mathcal{L}_{s}(\mathcal{D}_{s},\mathbf{w},\bm{\theta}," display="inline"><semantics id="A8.Ex7.m1.2a"><mrow id="A8.Ex7.m1.2b"><msub id="A8.Ex7.m1.2.3"><mi class="ltx_font_mathcaligraphic" id="A8.Ex7.m1.2.3.2">ℒ</mi><mi id="A8.Ex7.m1.2.3.3">s</mi></msub><mrow id="A8.Ex7.m1.2.4"><mo stretchy="false" id="A8.Ex7.m1.2.4.1">(</mo><msub id="A8.Ex7.m1.2.4.2"><mi class="ltx_font_mathcaligraphic" id="A8.Ex7.m1.2.4.2.2">𝒟</mi><mi id="A8.Ex7.m1.2.4.2.3">s</mi></msub><mo id="A8.Ex7.m1.2.4.3">,</mo><mi id="A8.Ex7.m1.1.1">𝐰</mi><mo id="A8.Ex7.m1.2.4.4">,</mo><mi id="A8.Ex7.m1.2.2">𝜽</mi><mo id="A8.Ex7.m1.2.4.5">,</mo></mrow></mrow><annotation encoding="application/x-tex" id="A8.Ex7.m1.2c">\displaystyle\mathcal{L}_{s}(\mathcal{D}_{s},\mathbf{w},\bm{\theta},</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math id="A8.Ex7.m2.1" class="ltx_math_unparsed" alttext="\displaystyle\bm{\phi}_{s},\mathbf{u}_{s}):=\mathbb{E}_{r_{\mathbf{u}_{s}}(\mathbf{z}_{s})}\bigg{[}\sum_{i}^{N_{s}}L(\mathcal{D}_{si},\mathbf{w}_{s}\odot\mathbf{z}_{s})\bigg{]}-\lambda\sum_{j}R_{\mathbf{u}_{sj}}(\mathbf{z}_{sj}&gt;0)(\mathbf{w}_{sj}-\mathbf{w})^{2}" display="inline"><semantics id="A8.Ex7.m2.1a"><mrow id="A8.Ex7.m2.1b"><msub id="A8.Ex7.m2.1.2"><mi class="ltx_mathvariant_bold-italic" mathvariant="bold-italic" id="A8.Ex7.m2.1.2.2">ϕ</mi><mi id="A8.Ex7.m2.1.2.3">s</mi></msub><mo id="A8.Ex7.m2.1.3">,</mo><msub id="A8.Ex7.m2.1.4"><mi id="A8.Ex7.m2.1.4.2">𝐮</mi><mi id="A8.Ex7.m2.1.4.3">s</mi></msub><mo rspace="0.278em" stretchy="false" id="A8.Ex7.m2.1.5">)</mo><mo rspace="0.278em" id="A8.Ex7.m2.1.6">:=</mo><mi id="A8.Ex7.m2.1.7">𝔼</mi><msub id="A8.Ex7.m2.1.1"><mi id="A8.Ex7.m2.1.1a"></mi><mrow id="A8.Ex7.m2.1.1.1"><msub id="A8.Ex7.m2.1.1.1.3"><mi id="A8.Ex7.m2.1.1.1.3.2">r</mi><msub id="A8.Ex7.m2.1.1.1.3.3"><mi id="A8.Ex7.m2.1.1.1.3.3.2">𝐮</mi><mi id="A8.Ex7.m2.1.1.1.3.3.3">s</mi></msub></msub><mo lspace="0em" rspace="0em" id="A8.Ex7.m2.1.1.1.2">​</mo><mrow id="A8.Ex7.m2.1.1.1.1.1"><mo stretchy="false" id="A8.Ex7.m2.1.1.1.1.1.2">(</mo><msub id="A8.Ex7.m2.1.1.1.1.1.1"><mi id="A8.Ex7.m2.1.1.1.1.1.1.2">𝐳</mi><mi id="A8.Ex7.m2.1.1.1.1.1.1.3">s</mi></msub><mo stretchy="false" id="A8.Ex7.m2.1.1.1.1.1.3">)</mo></mrow></mrow></msub><mo maxsize="210%" minsize="210%" id="A8.Ex7.m2.1.8">[</mo><mstyle displaystyle="true" id="A8.Ex7.m2.1.9"><munderover id="A8.Ex7.m2.1.9a"><mo movablelimits="false" id="A8.Ex7.m2.1.9.2.2">∑</mo><mi id="A8.Ex7.m2.1.9.2.3">i</mi><msub id="A8.Ex7.m2.1.9.3"><mi id="A8.Ex7.m2.1.9.3.2">N</mi><mi id="A8.Ex7.m2.1.9.3.3">s</mi></msub></munderover></mstyle><mi id="A8.Ex7.m2.1.10">L</mi><mrow id="A8.Ex7.m2.1.11"><mo stretchy="false" id="A8.Ex7.m2.1.11.1">(</mo><msub id="A8.Ex7.m2.1.11.2"><mi class="ltx_font_mathcaligraphic" id="A8.Ex7.m2.1.11.2.2">𝒟</mi><mrow id="A8.Ex7.m2.1.11.2.3"><mi id="A8.Ex7.m2.1.11.2.3.2">s</mi><mo lspace="0em" rspace="0em" id="A8.Ex7.m2.1.11.2.3.1">​</mo><mi id="A8.Ex7.m2.1.11.2.3.3">i</mi></mrow></msub><mo id="A8.Ex7.m2.1.11.3">,</mo><msub id="A8.Ex7.m2.1.11.4"><mi id="A8.Ex7.m2.1.11.4.2">𝐰</mi><mi id="A8.Ex7.m2.1.11.4.3">s</mi></msub><mo lspace="0.222em" rspace="0.222em" id="A8.Ex7.m2.1.11.5">⊙</mo><msub id="A8.Ex7.m2.1.11.6"><mi id="A8.Ex7.m2.1.11.6.2">𝐳</mi><mi id="A8.Ex7.m2.1.11.6.3">s</mi></msub><mo stretchy="false" id="A8.Ex7.m2.1.11.7">)</mo></mrow><mo maxsize="210%" minsize="210%" id="A8.Ex7.m2.1.12">]</mo><mo id="A8.Ex7.m2.1.13">−</mo><mi id="A8.Ex7.m2.1.14">λ</mi><mstyle displaystyle="true" id="A8.Ex7.m2.1.15"><mo movablelimits="false" id="A8.Ex7.m2.1.15a">∑</mo></mstyle><msub id="A8.Ex7.m2.1.16"><mi id="A8.Ex7.m2.1.16a"></mi><mi id="A8.Ex7.m2.1.16.1">j</mi></msub><mi id="A8.Ex7.m2.1.17">R</mi><msub id="A8.Ex7.m2.1.18"><mi id="A8.Ex7.m2.1.18a"></mi><msub id="A8.Ex7.m2.1.18.1"><mi id="A8.Ex7.m2.1.18.1.2">𝐮</mi><mrow id="A8.Ex7.m2.1.18.1.3"><mi id="A8.Ex7.m2.1.18.1.3.2">s</mi><mo lspace="0em" rspace="0em" id="A8.Ex7.m2.1.18.1.3.1">​</mo><mi id="A8.Ex7.m2.1.18.1.3.3">j</mi></mrow></msub></msub><mo stretchy="false" id="A8.Ex7.m2.1.19">(</mo><msub id="A8.Ex7.m2.1.20"><mi id="A8.Ex7.m2.1.20.2">𝐳</mi><mrow id="A8.Ex7.m2.1.20.3"><mi id="A8.Ex7.m2.1.20.3.2">s</mi><mo lspace="0em" rspace="0em" id="A8.Ex7.m2.1.20.3.1">​</mo><mi id="A8.Ex7.m2.1.20.3.3">j</mi></mrow></msub><mo id="A8.Ex7.m2.1.21">&gt;</mo><mn id="A8.Ex7.m2.1.22">0</mn><mo stretchy="false" id="A8.Ex7.m2.1.23">)</mo><mo stretchy="false" id="A8.Ex7.m2.1.24">(</mo><msub id="A8.Ex7.m2.1.25"><mi id="A8.Ex7.m2.1.25.2">𝐰</mi><mrow id="A8.Ex7.m2.1.25.3"><mi id="A8.Ex7.m2.1.25.3.2">s</mi><mo lspace="0em" rspace="0em" id="A8.Ex7.m2.1.25.3.1">​</mo><mi id="A8.Ex7.m2.1.25.3.3">j</mi></mrow></msub><mo id="A8.Ex7.m2.1.26">−</mo><mi id="A8.Ex7.m2.1.27">𝐰</mi><mo stretchy="false" id="A8.Ex7.m2.1.28">)</mo><msup id="A8.Ex7.m2.1.29"><mi id="A8.Ex7.m2.1.29a"></mi><mn id="A8.Ex7.m2.1.29.1">2</mn></msup></mrow><annotation encoding="application/x-tex" id="A8.Ex7.m2.1c">\displaystyle\bm{\phi}_{s},\mathbf{u}_{s}):=\mathbb{E}_{r_{\mathbf{u}_{s}}(\mathbf{z}_{s})}\bigg{[}\sum_{i}^{N_{s}}L(\mathcal{D}_{si},\mathbf{w}_{s}\odot\mathbf{z}_{s})\bigg{]}-\lambda\sum_{j}R_{\mathbf{u}_{sj}}(\mathbf{z}_{sj}&gt;0)(\mathbf{w}_{sj}-\mathbf{w})^{2}</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
<tbody id="A8.E41"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_eqn_cell"></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math id="A8.E41.m1.2" class="ltx_Math" alttext="\displaystyle-\lambda_{0}\sum_{j}R_{\mathbf{u}_{sj}}(\mathbf{z}_{sj}&gt;0)+\sum_{j}\left(R_{\mathbf{u}_{sj}}(\mathbf{z}_{sj}&gt;0)\log\frac{\bm{\theta}_{j}}{1-\bm{\theta}_{j}}+\log(1-\bm{\theta}_{j})\right)," display="inline"><semantics id="A8.E41.m1.2a"><mrow id="A8.E41.m1.2.2.1" xref="A8.E41.m1.2.2.1.1.cmml"><mrow id="A8.E41.m1.2.2.1.1" xref="A8.E41.m1.2.2.1.1.cmml"><mrow id="A8.E41.m1.2.2.1.1.1" xref="A8.E41.m1.2.2.1.1.1.cmml"><mo id="A8.E41.m1.2.2.1.1.1a" xref="A8.E41.m1.2.2.1.1.1.cmml">−</mo><mrow id="A8.E41.m1.2.2.1.1.1.1" xref="A8.E41.m1.2.2.1.1.1.1.cmml"><msub id="A8.E41.m1.2.2.1.1.1.1.3" xref="A8.E41.m1.2.2.1.1.1.1.3.cmml"><mi id="A8.E41.m1.2.2.1.1.1.1.3.2" xref="A8.E41.m1.2.2.1.1.1.1.3.2.cmml">λ</mi><mn id="A8.E41.m1.2.2.1.1.1.1.3.3" xref="A8.E41.m1.2.2.1.1.1.1.3.3.cmml">0</mn></msub><mo lspace="0em" rspace="0em" id="A8.E41.m1.2.2.1.1.1.1.2" xref="A8.E41.m1.2.2.1.1.1.1.2.cmml">​</mo><mrow id="A8.E41.m1.2.2.1.1.1.1.1" xref="A8.E41.m1.2.2.1.1.1.1.1.cmml"><mstyle displaystyle="true" id="A8.E41.m1.2.2.1.1.1.1.1.2" xref="A8.E41.m1.2.2.1.1.1.1.1.2.cmml"><munder id="A8.E41.m1.2.2.1.1.1.1.1.2a" xref="A8.E41.m1.2.2.1.1.1.1.1.2.cmml"><mo movablelimits="false" id="A8.E41.m1.2.2.1.1.1.1.1.2.2" xref="A8.E41.m1.2.2.1.1.1.1.1.2.2.cmml">∑</mo><mi id="A8.E41.m1.2.2.1.1.1.1.1.2.3" xref="A8.E41.m1.2.2.1.1.1.1.1.2.3.cmml">j</mi></munder></mstyle><mrow id="A8.E41.m1.2.2.1.1.1.1.1.1" xref="A8.E41.m1.2.2.1.1.1.1.1.1.cmml"><msub id="A8.E41.m1.2.2.1.1.1.1.1.1.3" xref="A8.E41.m1.2.2.1.1.1.1.1.1.3.cmml"><mi id="A8.E41.m1.2.2.1.1.1.1.1.1.3.2" xref="A8.E41.m1.2.2.1.1.1.1.1.1.3.2.cmml">R</mi><msub id="A8.E41.m1.2.2.1.1.1.1.1.1.3.3" xref="A8.E41.m1.2.2.1.1.1.1.1.1.3.3.cmml"><mi id="A8.E41.m1.2.2.1.1.1.1.1.1.3.3.2" xref="A8.E41.m1.2.2.1.1.1.1.1.1.3.3.2.cmml">𝐮</mi><mrow id="A8.E41.m1.2.2.1.1.1.1.1.1.3.3.3" xref="A8.E41.m1.2.2.1.1.1.1.1.1.3.3.3.cmml"><mi id="A8.E41.m1.2.2.1.1.1.1.1.1.3.3.3.2" xref="A8.E41.m1.2.2.1.1.1.1.1.1.3.3.3.2.cmml">s</mi><mo lspace="0em" rspace="0em" id="A8.E41.m1.2.2.1.1.1.1.1.1.3.3.3.1" xref="A8.E41.m1.2.2.1.1.1.1.1.1.3.3.3.1.cmml">​</mo><mi id="A8.E41.m1.2.2.1.1.1.1.1.1.3.3.3.3" xref="A8.E41.m1.2.2.1.1.1.1.1.1.3.3.3.3.cmml">j</mi></mrow></msub></msub><mo lspace="0em" rspace="0em" id="A8.E41.m1.2.2.1.1.1.1.1.1.2" xref="A8.E41.m1.2.2.1.1.1.1.1.1.2.cmml">​</mo><mrow id="A8.E41.m1.2.2.1.1.1.1.1.1.1.1" xref="A8.E41.m1.2.2.1.1.1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="A8.E41.m1.2.2.1.1.1.1.1.1.1.1.2" xref="A8.E41.m1.2.2.1.1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="A8.E41.m1.2.2.1.1.1.1.1.1.1.1.1" xref="A8.E41.m1.2.2.1.1.1.1.1.1.1.1.1.cmml"><msub id="A8.E41.m1.2.2.1.1.1.1.1.1.1.1.1.2" xref="A8.E41.m1.2.2.1.1.1.1.1.1.1.1.1.2.cmml"><mi id="A8.E41.m1.2.2.1.1.1.1.1.1.1.1.1.2.2" xref="A8.E41.m1.2.2.1.1.1.1.1.1.1.1.1.2.2.cmml">𝐳</mi><mrow id="A8.E41.m1.2.2.1.1.1.1.1.1.1.1.1.2.3" xref="A8.E41.m1.2.2.1.1.1.1.1.1.1.1.1.2.3.cmml"><mi id="A8.E41.m1.2.2.1.1.1.1.1.1.1.1.1.2.3.2" xref="A8.E41.m1.2.2.1.1.1.1.1.1.1.1.1.2.3.2.cmml">s</mi><mo lspace="0em" rspace="0em" id="A8.E41.m1.2.2.1.1.1.1.1.1.1.1.1.2.3.1" xref="A8.E41.m1.2.2.1.1.1.1.1.1.1.1.1.2.3.1.cmml">​</mo><mi id="A8.E41.m1.2.2.1.1.1.1.1.1.1.1.1.2.3.3" xref="A8.E41.m1.2.2.1.1.1.1.1.1.1.1.1.2.3.3.cmml">j</mi></mrow></msub><mo id="A8.E41.m1.2.2.1.1.1.1.1.1.1.1.1.1" xref="A8.E41.m1.2.2.1.1.1.1.1.1.1.1.1.1.cmml">&gt;</mo><mn id="A8.E41.m1.2.2.1.1.1.1.1.1.1.1.1.3" xref="A8.E41.m1.2.2.1.1.1.1.1.1.1.1.1.3.cmml">0</mn></mrow><mo stretchy="false" id="A8.E41.m1.2.2.1.1.1.1.1.1.1.1.3" xref="A8.E41.m1.2.2.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow></mrow></mrow><mo id="A8.E41.m1.2.2.1.1.3" xref="A8.E41.m1.2.2.1.1.3.cmml">+</mo><mrow id="A8.E41.m1.2.2.1.1.2" xref="A8.E41.m1.2.2.1.1.2.cmml"><mstyle displaystyle="true" id="A8.E41.m1.2.2.1.1.2.2" xref="A8.E41.m1.2.2.1.1.2.2.cmml"><munder id="A8.E41.m1.2.2.1.1.2.2a" xref="A8.E41.m1.2.2.1.1.2.2.cmml"><mo movablelimits="false" id="A8.E41.m1.2.2.1.1.2.2.2" xref="A8.E41.m1.2.2.1.1.2.2.2.cmml">∑</mo><mi id="A8.E41.m1.2.2.1.1.2.2.3" xref="A8.E41.m1.2.2.1.1.2.2.3.cmml">j</mi></munder></mstyle><mrow id="A8.E41.m1.2.2.1.1.2.1.1" xref="A8.E41.m1.2.2.1.1.2.1.1.1.cmml"><mo id="A8.E41.m1.2.2.1.1.2.1.1.2" xref="A8.E41.m1.2.2.1.1.2.1.1.1.cmml">(</mo><mrow id="A8.E41.m1.2.2.1.1.2.1.1.1" xref="A8.E41.m1.2.2.1.1.2.1.1.1.cmml"><mrow id="A8.E41.m1.2.2.1.1.2.1.1.1.1" xref="A8.E41.m1.2.2.1.1.2.1.1.1.1.cmml"><msub id="A8.E41.m1.2.2.1.1.2.1.1.1.1.3" xref="A8.E41.m1.2.2.1.1.2.1.1.1.1.3.cmml"><mi id="A8.E41.m1.2.2.1.1.2.1.1.1.1.3.2" xref="A8.E41.m1.2.2.1.1.2.1.1.1.1.3.2.cmml">R</mi><msub id="A8.E41.m1.2.2.1.1.2.1.1.1.1.3.3" xref="A8.E41.m1.2.2.1.1.2.1.1.1.1.3.3.cmml"><mi id="A8.E41.m1.2.2.1.1.2.1.1.1.1.3.3.2" xref="A8.E41.m1.2.2.1.1.2.1.1.1.1.3.3.2.cmml">𝐮</mi><mrow id="A8.E41.m1.2.2.1.1.2.1.1.1.1.3.3.3" xref="A8.E41.m1.2.2.1.1.2.1.1.1.1.3.3.3.cmml"><mi id="A8.E41.m1.2.2.1.1.2.1.1.1.1.3.3.3.2" xref="A8.E41.m1.2.2.1.1.2.1.1.1.1.3.3.3.2.cmml">s</mi><mo lspace="0em" rspace="0em" id="A8.E41.m1.2.2.1.1.2.1.1.1.1.3.3.3.1" xref="A8.E41.m1.2.2.1.1.2.1.1.1.1.3.3.3.1.cmml">​</mo><mi id="A8.E41.m1.2.2.1.1.2.1.1.1.1.3.3.3.3" xref="A8.E41.m1.2.2.1.1.2.1.1.1.1.3.3.3.3.cmml">j</mi></mrow></msub></msub><mo lspace="0em" rspace="0em" id="A8.E41.m1.2.2.1.1.2.1.1.1.1.2" xref="A8.E41.m1.2.2.1.1.2.1.1.1.1.2.cmml">​</mo><mrow id="A8.E41.m1.2.2.1.1.2.1.1.1.1.1.1" xref="A8.E41.m1.2.2.1.1.2.1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="A8.E41.m1.2.2.1.1.2.1.1.1.1.1.1.2" xref="A8.E41.m1.2.2.1.1.2.1.1.1.1.1.1.1.cmml">(</mo><mrow id="A8.E41.m1.2.2.1.1.2.1.1.1.1.1.1.1" xref="A8.E41.m1.2.2.1.1.2.1.1.1.1.1.1.1.cmml"><msub id="A8.E41.m1.2.2.1.1.2.1.1.1.1.1.1.1.2" xref="A8.E41.m1.2.2.1.1.2.1.1.1.1.1.1.1.2.cmml"><mi id="A8.E41.m1.2.2.1.1.2.1.1.1.1.1.1.1.2.2" xref="A8.E41.m1.2.2.1.1.2.1.1.1.1.1.1.1.2.2.cmml">𝐳</mi><mrow id="A8.E41.m1.2.2.1.1.2.1.1.1.1.1.1.1.2.3" xref="A8.E41.m1.2.2.1.1.2.1.1.1.1.1.1.1.2.3.cmml"><mi id="A8.E41.m1.2.2.1.1.2.1.1.1.1.1.1.1.2.3.2" xref="A8.E41.m1.2.2.1.1.2.1.1.1.1.1.1.1.2.3.2.cmml">s</mi><mo lspace="0em" rspace="0em" id="A8.E41.m1.2.2.1.1.2.1.1.1.1.1.1.1.2.3.1" xref="A8.E41.m1.2.2.1.1.2.1.1.1.1.1.1.1.2.3.1.cmml">​</mo><mi id="A8.E41.m1.2.2.1.1.2.1.1.1.1.1.1.1.2.3.3" xref="A8.E41.m1.2.2.1.1.2.1.1.1.1.1.1.1.2.3.3.cmml">j</mi></mrow></msub><mo id="A8.E41.m1.2.2.1.1.2.1.1.1.1.1.1.1.1" xref="A8.E41.m1.2.2.1.1.2.1.1.1.1.1.1.1.1.cmml">&gt;</mo><mn id="A8.E41.m1.2.2.1.1.2.1.1.1.1.1.1.1.3" xref="A8.E41.m1.2.2.1.1.2.1.1.1.1.1.1.1.3.cmml">0</mn></mrow><mo stretchy="false" id="A8.E41.m1.2.2.1.1.2.1.1.1.1.1.1.3" xref="A8.E41.m1.2.2.1.1.2.1.1.1.1.1.1.1.cmml">)</mo></mrow><mo lspace="0.167em" rspace="0em" id="A8.E41.m1.2.2.1.1.2.1.1.1.1.2a" xref="A8.E41.m1.2.2.1.1.2.1.1.1.1.2.cmml">​</mo><mrow id="A8.E41.m1.2.2.1.1.2.1.1.1.1.4" xref="A8.E41.m1.2.2.1.1.2.1.1.1.1.4.cmml"><mi id="A8.E41.m1.2.2.1.1.2.1.1.1.1.4.1" xref="A8.E41.m1.2.2.1.1.2.1.1.1.1.4.1.cmml">log</mi><mo lspace="0.167em" id="A8.E41.m1.2.2.1.1.2.1.1.1.1.4a" xref="A8.E41.m1.2.2.1.1.2.1.1.1.1.4.cmml">⁡</mo><mstyle displaystyle="true" id="A8.E41.m1.2.2.1.1.2.1.1.1.1.4.2" xref="A8.E41.m1.2.2.1.1.2.1.1.1.1.4.2.cmml"><mfrac id="A8.E41.m1.2.2.1.1.2.1.1.1.1.4.2a" xref="A8.E41.m1.2.2.1.1.2.1.1.1.1.4.2.cmml"><msub id="A8.E41.m1.2.2.1.1.2.1.1.1.1.4.2.2" xref="A8.E41.m1.2.2.1.1.2.1.1.1.1.4.2.2.cmml"><mi id="A8.E41.m1.2.2.1.1.2.1.1.1.1.4.2.2.2" xref="A8.E41.m1.2.2.1.1.2.1.1.1.1.4.2.2.2.cmml">𝜽</mi><mi id="A8.E41.m1.2.2.1.1.2.1.1.1.1.4.2.2.3" xref="A8.E41.m1.2.2.1.1.2.1.1.1.1.4.2.2.3.cmml">j</mi></msub><mrow id="A8.E41.m1.2.2.1.1.2.1.1.1.1.4.2.3" xref="A8.E41.m1.2.2.1.1.2.1.1.1.1.4.2.3.cmml"><mn id="A8.E41.m1.2.2.1.1.2.1.1.1.1.4.2.3.2" xref="A8.E41.m1.2.2.1.1.2.1.1.1.1.4.2.3.2.cmml">1</mn><mo id="A8.E41.m1.2.2.1.1.2.1.1.1.1.4.2.3.1" xref="A8.E41.m1.2.2.1.1.2.1.1.1.1.4.2.3.1.cmml">−</mo><msub id="A8.E41.m1.2.2.1.1.2.1.1.1.1.4.2.3.3" xref="A8.E41.m1.2.2.1.1.2.1.1.1.1.4.2.3.3.cmml"><mi id="A8.E41.m1.2.2.1.1.2.1.1.1.1.4.2.3.3.2" xref="A8.E41.m1.2.2.1.1.2.1.1.1.1.4.2.3.3.2.cmml">𝜽</mi><mi id="A8.E41.m1.2.2.1.1.2.1.1.1.1.4.2.3.3.3" xref="A8.E41.m1.2.2.1.1.2.1.1.1.1.4.2.3.3.3.cmml">j</mi></msub></mrow></mfrac></mstyle></mrow></mrow><mo id="A8.E41.m1.2.2.1.1.2.1.1.1.3" xref="A8.E41.m1.2.2.1.1.2.1.1.1.3.cmml">+</mo><mrow id="A8.E41.m1.2.2.1.1.2.1.1.1.2.1" xref="A8.E41.m1.2.2.1.1.2.1.1.1.2.2.cmml"><mi id="A8.E41.m1.1.1" xref="A8.E41.m1.1.1.cmml">log</mi><mo id="A8.E41.m1.2.2.1.1.2.1.1.1.2.1a" xref="A8.E41.m1.2.2.1.1.2.1.1.1.2.2.cmml">⁡</mo><mrow id="A8.E41.m1.2.2.1.1.2.1.1.1.2.1.1" xref="A8.E41.m1.2.2.1.1.2.1.1.1.2.2.cmml"><mo stretchy="false" id="A8.E41.m1.2.2.1.1.2.1.1.1.2.1.1.2" xref="A8.E41.m1.2.2.1.1.2.1.1.1.2.2.cmml">(</mo><mrow id="A8.E41.m1.2.2.1.1.2.1.1.1.2.1.1.1" xref="A8.E41.m1.2.2.1.1.2.1.1.1.2.1.1.1.cmml"><mn id="A8.E41.m1.2.2.1.1.2.1.1.1.2.1.1.1.2" xref="A8.E41.m1.2.2.1.1.2.1.1.1.2.1.1.1.2.cmml">1</mn><mo id="A8.E41.m1.2.2.1.1.2.1.1.1.2.1.1.1.1" xref="A8.E41.m1.2.2.1.1.2.1.1.1.2.1.1.1.1.cmml">−</mo><msub id="A8.E41.m1.2.2.1.1.2.1.1.1.2.1.1.1.3" xref="A8.E41.m1.2.2.1.1.2.1.1.1.2.1.1.1.3.cmml"><mi id="A8.E41.m1.2.2.1.1.2.1.1.1.2.1.1.1.3.2" xref="A8.E41.m1.2.2.1.1.2.1.1.1.2.1.1.1.3.2.cmml">𝜽</mi><mi id="A8.E41.m1.2.2.1.1.2.1.1.1.2.1.1.1.3.3" xref="A8.E41.m1.2.2.1.1.2.1.1.1.2.1.1.1.3.3.cmml">j</mi></msub></mrow><mo stretchy="false" id="A8.E41.m1.2.2.1.1.2.1.1.1.2.1.1.3" xref="A8.E41.m1.2.2.1.1.2.1.1.1.2.2.cmml">)</mo></mrow></mrow></mrow><mo id="A8.E41.m1.2.2.1.1.2.1.1.3" xref="A8.E41.m1.2.2.1.1.2.1.1.1.cmml">)</mo></mrow></mrow></mrow><mo id="A8.E41.m1.2.2.1.2" xref="A8.E41.m1.2.2.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="A8.E41.m1.2b"><apply id="A8.E41.m1.2.2.1.1.cmml" xref="A8.E41.m1.2.2.1"><plus id="A8.E41.m1.2.2.1.1.3.cmml" xref="A8.E41.m1.2.2.1.1.3"></plus><apply id="A8.E41.m1.2.2.1.1.1.cmml" xref="A8.E41.m1.2.2.1.1.1"><minus id="A8.E41.m1.2.2.1.1.1.2.cmml" xref="A8.E41.m1.2.2.1.1.1"></minus><apply id="A8.E41.m1.2.2.1.1.1.1.cmml" xref="A8.E41.m1.2.2.1.1.1.1"><times id="A8.E41.m1.2.2.1.1.1.1.2.cmml" xref="A8.E41.m1.2.2.1.1.1.1.2"></times><apply id="A8.E41.m1.2.2.1.1.1.1.3.cmml" xref="A8.E41.m1.2.2.1.1.1.1.3"><csymbol cd="ambiguous" id="A8.E41.m1.2.2.1.1.1.1.3.1.cmml" xref="A8.E41.m1.2.2.1.1.1.1.3">subscript</csymbol><ci id="A8.E41.m1.2.2.1.1.1.1.3.2.cmml" xref="A8.E41.m1.2.2.1.1.1.1.3.2">𝜆</ci><cn type="integer" id="A8.E41.m1.2.2.1.1.1.1.3.3.cmml" xref="A8.E41.m1.2.2.1.1.1.1.3.3">0</cn></apply><apply id="A8.E41.m1.2.2.1.1.1.1.1.cmml" xref="A8.E41.m1.2.2.1.1.1.1.1"><apply id="A8.E41.m1.2.2.1.1.1.1.1.2.cmml" xref="A8.E41.m1.2.2.1.1.1.1.1.2"><csymbol cd="ambiguous" id="A8.E41.m1.2.2.1.1.1.1.1.2.1.cmml" xref="A8.E41.m1.2.2.1.1.1.1.1.2">subscript</csymbol><sum id="A8.E41.m1.2.2.1.1.1.1.1.2.2.cmml" xref="A8.E41.m1.2.2.1.1.1.1.1.2.2"></sum><ci id="A8.E41.m1.2.2.1.1.1.1.1.2.3.cmml" xref="A8.E41.m1.2.2.1.1.1.1.1.2.3">𝑗</ci></apply><apply id="A8.E41.m1.2.2.1.1.1.1.1.1.cmml" xref="A8.E41.m1.2.2.1.1.1.1.1.1"><times id="A8.E41.m1.2.2.1.1.1.1.1.1.2.cmml" xref="A8.E41.m1.2.2.1.1.1.1.1.1.2"></times><apply id="A8.E41.m1.2.2.1.1.1.1.1.1.3.cmml" xref="A8.E41.m1.2.2.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="A8.E41.m1.2.2.1.1.1.1.1.1.3.1.cmml" xref="A8.E41.m1.2.2.1.1.1.1.1.1.3">subscript</csymbol><ci id="A8.E41.m1.2.2.1.1.1.1.1.1.3.2.cmml" xref="A8.E41.m1.2.2.1.1.1.1.1.1.3.2">𝑅</ci><apply id="A8.E41.m1.2.2.1.1.1.1.1.1.3.3.cmml" xref="A8.E41.m1.2.2.1.1.1.1.1.1.3.3"><csymbol cd="ambiguous" id="A8.E41.m1.2.2.1.1.1.1.1.1.3.3.1.cmml" xref="A8.E41.m1.2.2.1.1.1.1.1.1.3.3">subscript</csymbol><ci id="A8.E41.m1.2.2.1.1.1.1.1.1.3.3.2.cmml" xref="A8.E41.m1.2.2.1.1.1.1.1.1.3.3.2">𝐮</ci><apply id="A8.E41.m1.2.2.1.1.1.1.1.1.3.3.3.cmml" xref="A8.E41.m1.2.2.1.1.1.1.1.1.3.3.3"><times id="A8.E41.m1.2.2.1.1.1.1.1.1.3.3.3.1.cmml" xref="A8.E41.m1.2.2.1.1.1.1.1.1.3.3.3.1"></times><ci id="A8.E41.m1.2.2.1.1.1.1.1.1.3.3.3.2.cmml" xref="A8.E41.m1.2.2.1.1.1.1.1.1.3.3.3.2">𝑠</ci><ci id="A8.E41.m1.2.2.1.1.1.1.1.1.3.3.3.3.cmml" xref="A8.E41.m1.2.2.1.1.1.1.1.1.3.3.3.3">𝑗</ci></apply></apply></apply><apply id="A8.E41.m1.2.2.1.1.1.1.1.1.1.1.1.cmml" xref="A8.E41.m1.2.2.1.1.1.1.1.1.1.1"><gt id="A8.E41.m1.2.2.1.1.1.1.1.1.1.1.1.1.cmml" xref="A8.E41.m1.2.2.1.1.1.1.1.1.1.1.1.1"></gt><apply id="A8.E41.m1.2.2.1.1.1.1.1.1.1.1.1.2.cmml" xref="A8.E41.m1.2.2.1.1.1.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="A8.E41.m1.2.2.1.1.1.1.1.1.1.1.1.2.1.cmml" xref="A8.E41.m1.2.2.1.1.1.1.1.1.1.1.1.2">subscript</csymbol><ci id="A8.E41.m1.2.2.1.1.1.1.1.1.1.1.1.2.2.cmml" xref="A8.E41.m1.2.2.1.1.1.1.1.1.1.1.1.2.2">𝐳</ci><apply id="A8.E41.m1.2.2.1.1.1.1.1.1.1.1.1.2.3.cmml" xref="A8.E41.m1.2.2.1.1.1.1.1.1.1.1.1.2.3"><times id="A8.E41.m1.2.2.1.1.1.1.1.1.1.1.1.2.3.1.cmml" xref="A8.E41.m1.2.2.1.1.1.1.1.1.1.1.1.2.3.1"></times><ci id="A8.E41.m1.2.2.1.1.1.1.1.1.1.1.1.2.3.2.cmml" xref="A8.E41.m1.2.2.1.1.1.1.1.1.1.1.1.2.3.2">𝑠</ci><ci id="A8.E41.m1.2.2.1.1.1.1.1.1.1.1.1.2.3.3.cmml" xref="A8.E41.m1.2.2.1.1.1.1.1.1.1.1.1.2.3.3">𝑗</ci></apply></apply><cn type="integer" id="A8.E41.m1.2.2.1.1.1.1.1.1.1.1.1.3.cmml" xref="A8.E41.m1.2.2.1.1.1.1.1.1.1.1.1.3">0</cn></apply></apply></apply></apply></apply><apply id="A8.E41.m1.2.2.1.1.2.cmml" xref="A8.E41.m1.2.2.1.1.2"><apply id="A8.E41.m1.2.2.1.1.2.2.cmml" xref="A8.E41.m1.2.2.1.1.2.2"><csymbol cd="ambiguous" id="A8.E41.m1.2.2.1.1.2.2.1.cmml" xref="A8.E41.m1.2.2.1.1.2.2">subscript</csymbol><sum id="A8.E41.m1.2.2.1.1.2.2.2.cmml" xref="A8.E41.m1.2.2.1.1.2.2.2"></sum><ci id="A8.E41.m1.2.2.1.1.2.2.3.cmml" xref="A8.E41.m1.2.2.1.1.2.2.3">𝑗</ci></apply><apply id="A8.E41.m1.2.2.1.1.2.1.1.1.cmml" xref="A8.E41.m1.2.2.1.1.2.1.1"><plus id="A8.E41.m1.2.2.1.1.2.1.1.1.3.cmml" xref="A8.E41.m1.2.2.1.1.2.1.1.1.3"></plus><apply id="A8.E41.m1.2.2.1.1.2.1.1.1.1.cmml" xref="A8.E41.m1.2.2.1.1.2.1.1.1.1"><times id="A8.E41.m1.2.2.1.1.2.1.1.1.1.2.cmml" xref="A8.E41.m1.2.2.1.1.2.1.1.1.1.2"></times><apply id="A8.E41.m1.2.2.1.1.2.1.1.1.1.3.cmml" xref="A8.E41.m1.2.2.1.1.2.1.1.1.1.3"><csymbol cd="ambiguous" id="A8.E41.m1.2.2.1.1.2.1.1.1.1.3.1.cmml" xref="A8.E41.m1.2.2.1.1.2.1.1.1.1.3">subscript</csymbol><ci id="A8.E41.m1.2.2.1.1.2.1.1.1.1.3.2.cmml" xref="A8.E41.m1.2.2.1.1.2.1.1.1.1.3.2">𝑅</ci><apply id="A8.E41.m1.2.2.1.1.2.1.1.1.1.3.3.cmml" xref="A8.E41.m1.2.2.1.1.2.1.1.1.1.3.3"><csymbol cd="ambiguous" id="A8.E41.m1.2.2.1.1.2.1.1.1.1.3.3.1.cmml" xref="A8.E41.m1.2.2.1.1.2.1.1.1.1.3.3">subscript</csymbol><ci id="A8.E41.m1.2.2.1.1.2.1.1.1.1.3.3.2.cmml" xref="A8.E41.m1.2.2.1.1.2.1.1.1.1.3.3.2">𝐮</ci><apply id="A8.E41.m1.2.2.1.1.2.1.1.1.1.3.3.3.cmml" xref="A8.E41.m1.2.2.1.1.2.1.1.1.1.3.3.3"><times id="A8.E41.m1.2.2.1.1.2.1.1.1.1.3.3.3.1.cmml" xref="A8.E41.m1.2.2.1.1.2.1.1.1.1.3.3.3.1"></times><ci id="A8.E41.m1.2.2.1.1.2.1.1.1.1.3.3.3.2.cmml" xref="A8.E41.m1.2.2.1.1.2.1.1.1.1.3.3.3.2">𝑠</ci><ci id="A8.E41.m1.2.2.1.1.2.1.1.1.1.3.3.3.3.cmml" xref="A8.E41.m1.2.2.1.1.2.1.1.1.1.3.3.3.3">𝑗</ci></apply></apply></apply><apply id="A8.E41.m1.2.2.1.1.2.1.1.1.1.1.1.1.cmml" xref="A8.E41.m1.2.2.1.1.2.1.1.1.1.1.1"><gt id="A8.E41.m1.2.2.1.1.2.1.1.1.1.1.1.1.1.cmml" xref="A8.E41.m1.2.2.1.1.2.1.1.1.1.1.1.1.1"></gt><apply id="A8.E41.m1.2.2.1.1.2.1.1.1.1.1.1.1.2.cmml" xref="A8.E41.m1.2.2.1.1.2.1.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="A8.E41.m1.2.2.1.1.2.1.1.1.1.1.1.1.2.1.cmml" xref="A8.E41.m1.2.2.1.1.2.1.1.1.1.1.1.1.2">subscript</csymbol><ci id="A8.E41.m1.2.2.1.1.2.1.1.1.1.1.1.1.2.2.cmml" xref="A8.E41.m1.2.2.1.1.2.1.1.1.1.1.1.1.2.2">𝐳</ci><apply id="A8.E41.m1.2.2.1.1.2.1.1.1.1.1.1.1.2.3.cmml" xref="A8.E41.m1.2.2.1.1.2.1.1.1.1.1.1.1.2.3"><times id="A8.E41.m1.2.2.1.1.2.1.1.1.1.1.1.1.2.3.1.cmml" xref="A8.E41.m1.2.2.1.1.2.1.1.1.1.1.1.1.2.3.1"></times><ci id="A8.E41.m1.2.2.1.1.2.1.1.1.1.1.1.1.2.3.2.cmml" xref="A8.E41.m1.2.2.1.1.2.1.1.1.1.1.1.1.2.3.2">𝑠</ci><ci id="A8.E41.m1.2.2.1.1.2.1.1.1.1.1.1.1.2.3.3.cmml" xref="A8.E41.m1.2.2.1.1.2.1.1.1.1.1.1.1.2.3.3">𝑗</ci></apply></apply><cn type="integer" id="A8.E41.m1.2.2.1.1.2.1.1.1.1.1.1.1.3.cmml" xref="A8.E41.m1.2.2.1.1.2.1.1.1.1.1.1.1.3">0</cn></apply><apply id="A8.E41.m1.2.2.1.1.2.1.1.1.1.4.cmml" xref="A8.E41.m1.2.2.1.1.2.1.1.1.1.4"><log id="A8.E41.m1.2.2.1.1.2.1.1.1.1.4.1.cmml" xref="A8.E41.m1.2.2.1.1.2.1.1.1.1.4.1"></log><apply id="A8.E41.m1.2.2.1.1.2.1.1.1.1.4.2.cmml" xref="A8.E41.m1.2.2.1.1.2.1.1.1.1.4.2"><divide id="A8.E41.m1.2.2.1.1.2.1.1.1.1.4.2.1.cmml" xref="A8.E41.m1.2.2.1.1.2.1.1.1.1.4.2"></divide><apply id="A8.E41.m1.2.2.1.1.2.1.1.1.1.4.2.2.cmml" xref="A8.E41.m1.2.2.1.1.2.1.1.1.1.4.2.2"><csymbol cd="ambiguous" id="A8.E41.m1.2.2.1.1.2.1.1.1.1.4.2.2.1.cmml" xref="A8.E41.m1.2.2.1.1.2.1.1.1.1.4.2.2">subscript</csymbol><ci id="A8.E41.m1.2.2.1.1.2.1.1.1.1.4.2.2.2.cmml" xref="A8.E41.m1.2.2.1.1.2.1.1.1.1.4.2.2.2">𝜽</ci><ci id="A8.E41.m1.2.2.1.1.2.1.1.1.1.4.2.2.3.cmml" xref="A8.E41.m1.2.2.1.1.2.1.1.1.1.4.2.2.3">𝑗</ci></apply><apply id="A8.E41.m1.2.2.1.1.2.1.1.1.1.4.2.3.cmml" xref="A8.E41.m1.2.2.1.1.2.1.1.1.1.4.2.3"><minus id="A8.E41.m1.2.2.1.1.2.1.1.1.1.4.2.3.1.cmml" xref="A8.E41.m1.2.2.1.1.2.1.1.1.1.4.2.3.1"></minus><cn type="integer" id="A8.E41.m1.2.2.1.1.2.1.1.1.1.4.2.3.2.cmml" xref="A8.E41.m1.2.2.1.1.2.1.1.1.1.4.2.3.2">1</cn><apply id="A8.E41.m1.2.2.1.1.2.1.1.1.1.4.2.3.3.cmml" xref="A8.E41.m1.2.2.1.1.2.1.1.1.1.4.2.3.3"><csymbol cd="ambiguous" id="A8.E41.m1.2.2.1.1.2.1.1.1.1.4.2.3.3.1.cmml" xref="A8.E41.m1.2.2.1.1.2.1.1.1.1.4.2.3.3">subscript</csymbol><ci id="A8.E41.m1.2.2.1.1.2.1.1.1.1.4.2.3.3.2.cmml" xref="A8.E41.m1.2.2.1.1.2.1.1.1.1.4.2.3.3.2">𝜽</ci><ci id="A8.E41.m1.2.2.1.1.2.1.1.1.1.4.2.3.3.3.cmml" xref="A8.E41.m1.2.2.1.1.2.1.1.1.1.4.2.3.3.3">𝑗</ci></apply></apply></apply></apply></apply><apply id="A8.E41.m1.2.2.1.1.2.1.1.1.2.2.cmml" xref="A8.E41.m1.2.2.1.1.2.1.1.1.2.1"><log id="A8.E41.m1.1.1.cmml" xref="A8.E41.m1.1.1"></log><apply id="A8.E41.m1.2.2.1.1.2.1.1.1.2.1.1.1.cmml" xref="A8.E41.m1.2.2.1.1.2.1.1.1.2.1.1.1"><minus id="A8.E41.m1.2.2.1.1.2.1.1.1.2.1.1.1.1.cmml" xref="A8.E41.m1.2.2.1.1.2.1.1.1.2.1.1.1.1"></minus><cn type="integer" id="A8.E41.m1.2.2.1.1.2.1.1.1.2.1.1.1.2.cmml" xref="A8.E41.m1.2.2.1.1.2.1.1.1.2.1.1.1.2">1</cn><apply id="A8.E41.m1.2.2.1.1.2.1.1.1.2.1.1.1.3.cmml" xref="A8.E41.m1.2.2.1.1.2.1.1.1.2.1.1.1.3"><csymbol cd="ambiguous" id="A8.E41.m1.2.2.1.1.2.1.1.1.2.1.1.1.3.1.cmml" xref="A8.E41.m1.2.2.1.1.2.1.1.1.2.1.1.1.3">subscript</csymbol><ci id="A8.E41.m1.2.2.1.1.2.1.1.1.2.1.1.1.3.2.cmml" xref="A8.E41.m1.2.2.1.1.2.1.1.1.2.1.1.1.3.2">𝜽</ci><ci id="A8.E41.m1.2.2.1.1.2.1.1.1.2.1.1.1.3.3.cmml" xref="A8.E41.m1.2.2.1.1.2.1.1.1.2.1.1.1.3.3">𝑗</ci></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A8.E41.m1.2c">\displaystyle-\lambda_{0}\sum_{j}R_{\mathbf{u}_{sj}}(\mathbf{z}_{sj}&gt;0)+\sum_{j}\left(R_{\mathbf{u}_{sj}}(\mathbf{z}_{sj}&gt;0)\log\frac{\bm{\theta}_{j}}{1-\bm{\theta}_{j}}+\log(1-\bm{\theta}_{j})\right),</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(41)</span></td>
</tr></tbody>
</table>
<p id="A8.p1.5" class="ltx_p">where <math id="A8.p1.4.m1.1" class="ltx_Math" alttext="R_{\mathbf{u}_{s}}(\cdot)" display="inline"><semantics id="A8.p1.4.m1.1a"><mrow id="A8.p1.4.m1.1.2" xref="A8.p1.4.m1.1.2.cmml"><msub id="A8.p1.4.m1.1.2.2" xref="A8.p1.4.m1.1.2.2.cmml"><mi id="A8.p1.4.m1.1.2.2.2" xref="A8.p1.4.m1.1.2.2.2.cmml">R</mi><msub id="A8.p1.4.m1.1.2.2.3" xref="A8.p1.4.m1.1.2.2.3.cmml"><mi id="A8.p1.4.m1.1.2.2.3.2" xref="A8.p1.4.m1.1.2.2.3.2.cmml">𝐮</mi><mi id="A8.p1.4.m1.1.2.2.3.3" xref="A8.p1.4.m1.1.2.2.3.3.cmml">s</mi></msub></msub><mo lspace="0em" rspace="0em" id="A8.p1.4.m1.1.2.1" xref="A8.p1.4.m1.1.2.1.cmml">​</mo><mrow id="A8.p1.4.m1.1.2.3.2" xref="A8.p1.4.m1.1.2.cmml"><mo stretchy="false" id="A8.p1.4.m1.1.2.3.2.1" xref="A8.p1.4.m1.1.2.cmml">(</mo><mo lspace="0em" rspace="0em" id="A8.p1.4.m1.1.1" xref="A8.p1.4.m1.1.1.cmml">⋅</mo><mo stretchy="false" id="A8.p1.4.m1.1.2.3.2.2" xref="A8.p1.4.m1.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="A8.p1.4.m1.1b"><apply id="A8.p1.4.m1.1.2.cmml" xref="A8.p1.4.m1.1.2"><times id="A8.p1.4.m1.1.2.1.cmml" xref="A8.p1.4.m1.1.2.1"></times><apply id="A8.p1.4.m1.1.2.2.cmml" xref="A8.p1.4.m1.1.2.2"><csymbol cd="ambiguous" id="A8.p1.4.m1.1.2.2.1.cmml" xref="A8.p1.4.m1.1.2.2">subscript</csymbol><ci id="A8.p1.4.m1.1.2.2.2.cmml" xref="A8.p1.4.m1.1.2.2.2">𝑅</ci><apply id="A8.p1.4.m1.1.2.2.3.cmml" xref="A8.p1.4.m1.1.2.2.3"><csymbol cd="ambiguous" id="A8.p1.4.m1.1.2.2.3.1.cmml" xref="A8.p1.4.m1.1.2.2.3">subscript</csymbol><ci id="A8.p1.4.m1.1.2.2.3.2.cmml" xref="A8.p1.4.m1.1.2.2.3.2">𝐮</ci><ci id="A8.p1.4.m1.1.2.2.3.3.cmml" xref="A8.p1.4.m1.1.2.2.3.3">𝑠</ci></apply></apply><ci id="A8.p1.4.m1.1.1.cmml" xref="A8.p1.4.m1.1.1">⋅</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A8.p1.4.m1.1c">R_{\mathbf{u}_{s}}(\cdot)</annotation></semantics></math> is the cumulative distribution function (CDF) of the continuous relaxation <math id="A8.p1.5.m2.1" class="ltx_Math" alttext="r_{\mathbf{u}_{s}}(\cdot)" display="inline"><semantics id="A8.p1.5.m2.1a"><mrow id="A8.p1.5.m2.1.2" xref="A8.p1.5.m2.1.2.cmml"><msub id="A8.p1.5.m2.1.2.2" xref="A8.p1.5.m2.1.2.2.cmml"><mi id="A8.p1.5.m2.1.2.2.2" xref="A8.p1.5.m2.1.2.2.2.cmml">r</mi><msub id="A8.p1.5.m2.1.2.2.3" xref="A8.p1.5.m2.1.2.2.3.cmml"><mi id="A8.p1.5.m2.1.2.2.3.2" xref="A8.p1.5.m2.1.2.2.3.2.cmml">𝐮</mi><mi id="A8.p1.5.m2.1.2.2.3.3" xref="A8.p1.5.m2.1.2.2.3.3.cmml">s</mi></msub></msub><mo lspace="0em" rspace="0em" id="A8.p1.5.m2.1.2.1" xref="A8.p1.5.m2.1.2.1.cmml">​</mo><mrow id="A8.p1.5.m2.1.2.3.2" xref="A8.p1.5.m2.1.2.cmml"><mo stretchy="false" id="A8.p1.5.m2.1.2.3.2.1" xref="A8.p1.5.m2.1.2.cmml">(</mo><mo lspace="0em" rspace="0em" id="A8.p1.5.m2.1.1" xref="A8.p1.5.m2.1.1.cmml">⋅</mo><mo stretchy="false" id="A8.p1.5.m2.1.2.3.2.2" xref="A8.p1.5.m2.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="A8.p1.5.m2.1b"><apply id="A8.p1.5.m2.1.2.cmml" xref="A8.p1.5.m2.1.2"><times id="A8.p1.5.m2.1.2.1.cmml" xref="A8.p1.5.m2.1.2.1"></times><apply id="A8.p1.5.m2.1.2.2.cmml" xref="A8.p1.5.m2.1.2.2"><csymbol cd="ambiguous" id="A8.p1.5.m2.1.2.2.1.cmml" xref="A8.p1.5.m2.1.2.2">subscript</csymbol><ci id="A8.p1.5.m2.1.2.2.2.cmml" xref="A8.p1.5.m2.1.2.2.2">𝑟</ci><apply id="A8.p1.5.m2.1.2.2.3.cmml" xref="A8.p1.5.m2.1.2.2.3"><csymbol cd="ambiguous" id="A8.p1.5.m2.1.2.2.3.1.cmml" xref="A8.p1.5.m2.1.2.2.3">subscript</csymbol><ci id="A8.p1.5.m2.1.2.2.3.2.cmml" xref="A8.p1.5.m2.1.2.2.3.2">𝐮</ci><ci id="A8.p1.5.m2.1.2.2.3.3.cmml" xref="A8.p1.5.m2.1.2.2.3.3">𝑠</ci></apply></apply><ci id="A8.p1.5.m2.1.1.cmml" xref="A8.p1.5.m2.1.1">⋅</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A8.p1.5.m2.1c">r_{\mathbf{u}_{s}}(\cdot)</annotation></semantics></math>. We can now straightforwardly optimize the surrogate objective with gradient ascent.</p>
</div>
<div class="ltx_pagination ltx_role_newpage"></div>
</section>
<section id="A9" class="ltx_appendix">
<h2 class="ltx_title ltx_title_appendix">
<span class="ltx_tag ltx_tag_appendix">Appendix I </span><span id="A9.1.1" class="ltx_text ltx_font_typewriter">FedSparse</span> algorithm</h2>

<figure id="alg1" class="ltx_float ltx_float_algorithm ltx_framed ltx_framed_top">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_float"><span id="alg1.7.1.1" class="ltx_text ltx_font_bold">Algorithm 1</span> </span> The server side algorithm for <span id="alg1.8.2" class="ltx_text ltx_font_typewriter">FedSparse</span> (assuming weight sparsity for simplicity). <math id="alg1.3.m1.1" class="ltx_Math" alttext="\sigma(\cdot)" display="inline"><semantics id="alg1.3.m1.1b"><mrow id="alg1.3.m1.1.2" xref="alg1.3.m1.1.2.cmml"><mi id="alg1.3.m1.1.2.2" xref="alg1.3.m1.1.2.2.cmml">σ</mi><mo lspace="0em" rspace="0em" id="alg1.3.m1.1.2.1" xref="alg1.3.m1.1.2.1.cmml">​</mo><mrow id="alg1.3.m1.1.2.3.2" xref="alg1.3.m1.1.2.cmml"><mo stretchy="false" id="alg1.3.m1.1.2.3.2.1" xref="alg1.3.m1.1.2.cmml">(</mo><mo lspace="0em" rspace="0em" id="alg1.3.m1.1.1" xref="alg1.3.m1.1.1.cmml">⋅</mo><mo stretchy="false" id="alg1.3.m1.1.2.3.2.2" xref="alg1.3.m1.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.3.m1.1c"><apply id="alg1.3.m1.1.2.cmml" xref="alg1.3.m1.1.2"><times id="alg1.3.m1.1.2.1.cmml" xref="alg1.3.m1.1.2.1"></times><ci id="alg1.3.m1.1.2.2.cmml" xref="alg1.3.m1.1.2.2">𝜎</ci><ci id="alg1.3.m1.1.1.cmml" xref="alg1.3.m1.1.1">⋅</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.3.m1.1d">\sigma(\cdot)</annotation></semantics></math> is the sigmoid function, <math id="alg1.4.m2.1" class="ltx_Math" alttext="\epsilon" display="inline"><semantics id="alg1.4.m2.1b"><mi id="alg1.4.m2.1.1" xref="alg1.4.m2.1.1.cmml">ϵ</mi><annotation-xml encoding="MathML-Content" id="alg1.4.m2.1c"><ci id="alg1.4.m2.1.1.cmml" xref="alg1.4.m2.1.1">italic-ϵ</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.4.m2.1d">\epsilon</annotation></semantics></math> is the threshold for pruning.</figcaption>
<div id="alg1.9" class="ltx_listing ltx_listing">
<div id="alg1.l1" class="ltx_listingline">Initialize <math id="alg1.l1.m1.1" class="ltx_Math" alttext="\mathbf{v}" display="inline"><semantics id="alg1.l1.m1.1a"><mi id="alg1.l1.m1.1.1" xref="alg1.l1.m1.1.1.cmml">𝐯</mi><annotation-xml encoding="MathML-Content" id="alg1.l1.m1.1b"><ci id="alg1.l1.m1.1.1.cmml" xref="alg1.l1.m1.1.1">𝐯</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.l1.m1.1c">\mathbf{v}</annotation></semantics></math> and <math id="alg1.l1.m2.1" class="ltx_Math" alttext="\mathbf{w}" display="inline"><semantics id="alg1.l1.m2.1a"><mi id="alg1.l1.m2.1.1" xref="alg1.l1.m2.1.1.cmml">𝐰</mi><annotation-xml encoding="MathML-Content" id="alg1.l1.m2.1b"><ci id="alg1.l1.m2.1.1.cmml" xref="alg1.l1.m2.1.1">𝐰</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.l1.m2.1c">\mathbf{w}</annotation></semantics></math>

</div>
<div id="alg1.l2" class="ltx_listingline">
<span id="alg1.l2.1" class="ltx_text ltx_font_bold">for</span> round <math id="alg1.l2.m1.1" class="ltx_Math" alttext="t" display="inline"><semantics id="alg1.l2.m1.1a"><mi id="alg1.l2.m1.1.1" xref="alg1.l2.m1.1.1.cmml">t</mi><annotation-xml encoding="MathML-Content" id="alg1.l2.m1.1b"><ci id="alg1.l2.m1.1.1.cmml" xref="alg1.l2.m1.1.1">𝑡</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.l2.m1.1c">t</annotation></semantics></math> in <math id="alg1.l2.m2.2" class="ltx_Math" alttext="1,\dots T" display="inline"><semantics id="alg1.l2.m2.2a"><mrow id="alg1.l2.m2.2.2.1" xref="alg1.l2.m2.2.2.2.cmml"><mn id="alg1.l2.m2.1.1" xref="alg1.l2.m2.1.1.cmml">1</mn><mo id="alg1.l2.m2.2.2.1.2" xref="alg1.l2.m2.2.2.2.cmml">,</mo><mrow id="alg1.l2.m2.2.2.1.1" xref="alg1.l2.m2.2.2.1.1.cmml"><mi mathvariant="normal" id="alg1.l2.m2.2.2.1.1.2" xref="alg1.l2.m2.2.2.1.1.2.cmml">…</mi><mo lspace="0em" rspace="0em" id="alg1.l2.m2.2.2.1.1.1" xref="alg1.l2.m2.2.2.1.1.1.cmml">​</mo><mi id="alg1.l2.m2.2.2.1.1.3" xref="alg1.l2.m2.2.2.1.1.3.cmml">T</mi></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l2.m2.2b"><list id="alg1.l2.m2.2.2.2.cmml" xref="alg1.l2.m2.2.2.1"><cn type="integer" id="alg1.l2.m2.1.1.cmml" xref="alg1.l2.m2.1.1">1</cn><apply id="alg1.l2.m2.2.2.1.1.cmml" xref="alg1.l2.m2.2.2.1.1"><times id="alg1.l2.m2.2.2.1.1.1.cmml" xref="alg1.l2.m2.2.2.1.1.1"></times><ci id="alg1.l2.m2.2.2.1.1.2.cmml" xref="alg1.l2.m2.2.2.1.1.2">…</ci><ci id="alg1.l2.m2.2.2.1.1.3.cmml" xref="alg1.l2.m2.2.2.1.1.3">𝑇</ci></apply></list></annotation-xml><annotation encoding="application/x-tex" id="alg1.l2.m2.2c">1,\dots T</annotation></semantics></math> <span id="alg1.l2.2" class="ltx_text ltx_font_bold">do</span>

</div>
<div id="alg1.l3" class="ltx_listingline">     <math id="alg1.l3.m1.4" class="ltx_Math" alttext="\bm{\tau}\leftarrow\log(1+\exp(\mathbf{v}))" display="inline"><semantics id="alg1.l3.m1.4a"><mrow id="alg1.l3.m1.4.4" xref="alg1.l3.m1.4.4.cmml"><mi id="alg1.l3.m1.4.4.3" xref="alg1.l3.m1.4.4.3.cmml">𝝉</mi><mo stretchy="false" id="alg1.l3.m1.4.4.2" xref="alg1.l3.m1.4.4.2.cmml">←</mo><mrow id="alg1.l3.m1.4.4.1.1" xref="alg1.l3.m1.4.4.1.2.cmml"><mi id="alg1.l3.m1.3.3" xref="alg1.l3.m1.3.3.cmml">log</mi><mo id="alg1.l3.m1.4.4.1.1a" xref="alg1.l3.m1.4.4.1.2.cmml">⁡</mo><mrow id="alg1.l3.m1.4.4.1.1.1" xref="alg1.l3.m1.4.4.1.2.cmml"><mo stretchy="false" id="alg1.l3.m1.4.4.1.1.1.2" xref="alg1.l3.m1.4.4.1.2.cmml">(</mo><mrow id="alg1.l3.m1.4.4.1.1.1.1" xref="alg1.l3.m1.4.4.1.1.1.1.cmml"><mn id="alg1.l3.m1.4.4.1.1.1.1.2" xref="alg1.l3.m1.4.4.1.1.1.1.2.cmml">1</mn><mo id="alg1.l3.m1.4.4.1.1.1.1.1" xref="alg1.l3.m1.4.4.1.1.1.1.1.cmml">+</mo><mrow id="alg1.l3.m1.4.4.1.1.1.1.3.2" xref="alg1.l3.m1.4.4.1.1.1.1.3.1.cmml"><mi id="alg1.l3.m1.1.1" xref="alg1.l3.m1.1.1.cmml">exp</mi><mo id="alg1.l3.m1.4.4.1.1.1.1.3.2a" xref="alg1.l3.m1.4.4.1.1.1.1.3.1.cmml">⁡</mo><mrow id="alg1.l3.m1.4.4.1.1.1.1.3.2.1" xref="alg1.l3.m1.4.4.1.1.1.1.3.1.cmml"><mo stretchy="false" id="alg1.l3.m1.4.4.1.1.1.1.3.2.1.1" xref="alg1.l3.m1.4.4.1.1.1.1.3.1.cmml">(</mo><mi id="alg1.l3.m1.2.2" xref="alg1.l3.m1.2.2.cmml">𝐯</mi><mo stretchy="false" id="alg1.l3.m1.4.4.1.1.1.1.3.2.1.2" xref="alg1.l3.m1.4.4.1.1.1.1.3.1.cmml">)</mo></mrow></mrow></mrow><mo stretchy="false" id="alg1.l3.m1.4.4.1.1.1.3" xref="alg1.l3.m1.4.4.1.2.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l3.m1.4b"><apply id="alg1.l3.m1.4.4.cmml" xref="alg1.l3.m1.4.4"><ci id="alg1.l3.m1.4.4.2.cmml" xref="alg1.l3.m1.4.4.2">←</ci><ci id="alg1.l3.m1.4.4.3.cmml" xref="alg1.l3.m1.4.4.3">𝝉</ci><apply id="alg1.l3.m1.4.4.1.2.cmml" xref="alg1.l3.m1.4.4.1.1"><log id="alg1.l3.m1.3.3.cmml" xref="alg1.l3.m1.3.3"></log><apply id="alg1.l3.m1.4.4.1.1.1.1.cmml" xref="alg1.l3.m1.4.4.1.1.1.1"><plus id="alg1.l3.m1.4.4.1.1.1.1.1.cmml" xref="alg1.l3.m1.4.4.1.1.1.1.1"></plus><cn type="integer" id="alg1.l3.m1.4.4.1.1.1.1.2.cmml" xref="alg1.l3.m1.4.4.1.1.1.1.2">1</cn><apply id="alg1.l3.m1.4.4.1.1.1.1.3.1.cmml" xref="alg1.l3.m1.4.4.1.1.1.1.3.2"><exp id="alg1.l3.m1.1.1.cmml" xref="alg1.l3.m1.1.1"></exp><ci id="alg1.l3.m1.2.2.cmml" xref="alg1.l3.m1.2.2">𝐯</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l3.m1.4c">\bm{\tau}\leftarrow\log(1+\exp(\mathbf{v}))</annotation></semantics></math>

</div>
<div id="alg1.l4" class="ltx_listingline">     <math id="alg1.l4.m1.2" class="ltx_Math" alttext="\bm{\theta}\leftarrow\sigma\left((|\mathbf{w}|-\bm{\tau})/T\right)" display="inline"><semantics id="alg1.l4.m1.2a"><mrow id="alg1.l4.m1.2.2" xref="alg1.l4.m1.2.2.cmml"><mi id="alg1.l4.m1.2.2.3" xref="alg1.l4.m1.2.2.3.cmml">𝜽</mi><mo stretchy="false" id="alg1.l4.m1.2.2.2" xref="alg1.l4.m1.2.2.2.cmml">←</mo><mrow id="alg1.l4.m1.2.2.1" xref="alg1.l4.m1.2.2.1.cmml"><mi id="alg1.l4.m1.2.2.1.3" xref="alg1.l4.m1.2.2.1.3.cmml">σ</mi><mo lspace="0em" rspace="0em" id="alg1.l4.m1.2.2.1.2" xref="alg1.l4.m1.2.2.1.2.cmml">​</mo><mrow id="alg1.l4.m1.2.2.1.1.1" xref="alg1.l4.m1.2.2.1.1.1.1.cmml"><mo id="alg1.l4.m1.2.2.1.1.1.2" xref="alg1.l4.m1.2.2.1.1.1.1.cmml">(</mo><mrow id="alg1.l4.m1.2.2.1.1.1.1" xref="alg1.l4.m1.2.2.1.1.1.1.cmml"><mrow id="alg1.l4.m1.2.2.1.1.1.1.1.1" xref="alg1.l4.m1.2.2.1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="alg1.l4.m1.2.2.1.1.1.1.1.1.2" xref="alg1.l4.m1.2.2.1.1.1.1.1.1.1.cmml">(</mo><mrow id="alg1.l4.m1.2.2.1.1.1.1.1.1.1" xref="alg1.l4.m1.2.2.1.1.1.1.1.1.1.cmml"><mrow id="alg1.l4.m1.2.2.1.1.1.1.1.1.1.2.2" xref="alg1.l4.m1.2.2.1.1.1.1.1.1.1.2.1.cmml"><mo stretchy="false" id="alg1.l4.m1.2.2.1.1.1.1.1.1.1.2.2.1" xref="alg1.l4.m1.2.2.1.1.1.1.1.1.1.2.1.1.cmml">|</mo><mi id="alg1.l4.m1.1.1" xref="alg1.l4.m1.1.1.cmml">𝐰</mi><mo stretchy="false" id="alg1.l4.m1.2.2.1.1.1.1.1.1.1.2.2.2" xref="alg1.l4.m1.2.2.1.1.1.1.1.1.1.2.1.1.cmml">|</mo></mrow><mo id="alg1.l4.m1.2.2.1.1.1.1.1.1.1.1" xref="alg1.l4.m1.2.2.1.1.1.1.1.1.1.1.cmml">−</mo><mi id="alg1.l4.m1.2.2.1.1.1.1.1.1.1.3" xref="alg1.l4.m1.2.2.1.1.1.1.1.1.1.3.cmml">𝝉</mi></mrow><mo stretchy="false" id="alg1.l4.m1.2.2.1.1.1.1.1.1.3" xref="alg1.l4.m1.2.2.1.1.1.1.1.1.1.cmml">)</mo></mrow><mo id="alg1.l4.m1.2.2.1.1.1.1.2" xref="alg1.l4.m1.2.2.1.1.1.1.2.cmml">/</mo><mi id="alg1.l4.m1.2.2.1.1.1.1.3" xref="alg1.l4.m1.2.2.1.1.1.1.3.cmml">T</mi></mrow><mo id="alg1.l4.m1.2.2.1.1.1.3" xref="alg1.l4.m1.2.2.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l4.m1.2b"><apply id="alg1.l4.m1.2.2.cmml" xref="alg1.l4.m1.2.2"><ci id="alg1.l4.m1.2.2.2.cmml" xref="alg1.l4.m1.2.2.2">←</ci><ci id="alg1.l4.m1.2.2.3.cmml" xref="alg1.l4.m1.2.2.3">𝜽</ci><apply id="alg1.l4.m1.2.2.1.cmml" xref="alg1.l4.m1.2.2.1"><times id="alg1.l4.m1.2.2.1.2.cmml" xref="alg1.l4.m1.2.2.1.2"></times><ci id="alg1.l4.m1.2.2.1.3.cmml" xref="alg1.l4.m1.2.2.1.3">𝜎</ci><apply id="alg1.l4.m1.2.2.1.1.1.1.cmml" xref="alg1.l4.m1.2.2.1.1.1"><divide id="alg1.l4.m1.2.2.1.1.1.1.2.cmml" xref="alg1.l4.m1.2.2.1.1.1.1.2"></divide><apply id="alg1.l4.m1.2.2.1.1.1.1.1.1.1.cmml" xref="alg1.l4.m1.2.2.1.1.1.1.1.1"><minus id="alg1.l4.m1.2.2.1.1.1.1.1.1.1.1.cmml" xref="alg1.l4.m1.2.2.1.1.1.1.1.1.1.1"></minus><apply id="alg1.l4.m1.2.2.1.1.1.1.1.1.1.2.1.cmml" xref="alg1.l4.m1.2.2.1.1.1.1.1.1.1.2.2"><abs id="alg1.l4.m1.2.2.1.1.1.1.1.1.1.2.1.1.cmml" xref="alg1.l4.m1.2.2.1.1.1.1.1.1.1.2.2.1"></abs><ci id="alg1.l4.m1.1.1.cmml" xref="alg1.l4.m1.1.1">𝐰</ci></apply><ci id="alg1.l4.m1.2.2.1.1.1.1.1.1.1.3.cmml" xref="alg1.l4.m1.2.2.1.1.1.1.1.1.1.3">𝝉</ci></apply><ci id="alg1.l4.m1.2.2.1.1.1.1.3.cmml" xref="alg1.l4.m1.2.2.1.1.1.1.3">𝑇</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l4.m1.2c">\bm{\theta}\leftarrow\sigma\left((|\mathbf{w}|-\bm{\tau})/T\right)</annotation></semantics></math>

</div>
<div id="alg1.l5" class="ltx_listingline">     <math id="alg1.l5.m1.1" class="ltx_Math" alttext="\mathbf{w}\leftarrow\mathbb{I}[\bm{\theta}&gt;\epsilon]\mathbf{w}" display="inline"><semantics id="alg1.l5.m1.1a"><mrow id="alg1.l5.m1.1.1" xref="alg1.l5.m1.1.1.cmml"><mi id="alg1.l5.m1.1.1.3" xref="alg1.l5.m1.1.1.3.cmml">𝐰</mi><mo stretchy="false" id="alg1.l5.m1.1.1.2" xref="alg1.l5.m1.1.1.2.cmml">←</mo><mrow id="alg1.l5.m1.1.1.1" xref="alg1.l5.m1.1.1.1.cmml"><mi id="alg1.l5.m1.1.1.1.3" xref="alg1.l5.m1.1.1.1.3.cmml">𝕀</mi><mo lspace="0em" rspace="0em" id="alg1.l5.m1.1.1.1.2" xref="alg1.l5.m1.1.1.1.2.cmml">​</mo><mrow id="alg1.l5.m1.1.1.1.1.1" xref="alg1.l5.m1.1.1.1.1.2.cmml"><mo stretchy="false" id="alg1.l5.m1.1.1.1.1.1.2" xref="alg1.l5.m1.1.1.1.1.2.1.cmml">[</mo><mrow id="alg1.l5.m1.1.1.1.1.1.1" xref="alg1.l5.m1.1.1.1.1.1.1.cmml"><mi id="alg1.l5.m1.1.1.1.1.1.1.2" xref="alg1.l5.m1.1.1.1.1.1.1.2.cmml">𝜽</mi><mo id="alg1.l5.m1.1.1.1.1.1.1.1" xref="alg1.l5.m1.1.1.1.1.1.1.1.cmml">&gt;</mo><mi id="alg1.l5.m1.1.1.1.1.1.1.3" xref="alg1.l5.m1.1.1.1.1.1.1.3.cmml">ϵ</mi></mrow><mo stretchy="false" id="alg1.l5.m1.1.1.1.1.1.3" xref="alg1.l5.m1.1.1.1.1.2.1.cmml">]</mo></mrow><mo lspace="0em" rspace="0em" id="alg1.l5.m1.1.1.1.2a" xref="alg1.l5.m1.1.1.1.2.cmml">​</mo><mi id="alg1.l5.m1.1.1.1.4" xref="alg1.l5.m1.1.1.1.4.cmml">𝐰</mi></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l5.m1.1b"><apply id="alg1.l5.m1.1.1.cmml" xref="alg1.l5.m1.1.1"><ci id="alg1.l5.m1.1.1.2.cmml" xref="alg1.l5.m1.1.1.2">←</ci><ci id="alg1.l5.m1.1.1.3.cmml" xref="alg1.l5.m1.1.1.3">𝐰</ci><apply id="alg1.l5.m1.1.1.1.cmml" xref="alg1.l5.m1.1.1.1"><times id="alg1.l5.m1.1.1.1.2.cmml" xref="alg1.l5.m1.1.1.1.2"></times><ci id="alg1.l5.m1.1.1.1.3.cmml" xref="alg1.l5.m1.1.1.1.3">𝕀</ci><apply id="alg1.l5.m1.1.1.1.1.2.cmml" xref="alg1.l5.m1.1.1.1.1.1"><csymbol cd="latexml" id="alg1.l5.m1.1.1.1.1.2.1.cmml" xref="alg1.l5.m1.1.1.1.1.1.2">delimited-[]</csymbol><apply id="alg1.l5.m1.1.1.1.1.1.1.cmml" xref="alg1.l5.m1.1.1.1.1.1.1"><gt id="alg1.l5.m1.1.1.1.1.1.1.1.cmml" xref="alg1.l5.m1.1.1.1.1.1.1.1"></gt><ci id="alg1.l5.m1.1.1.1.1.1.1.2.cmml" xref="alg1.l5.m1.1.1.1.1.1.1.2">𝜽</ci><ci id="alg1.l5.m1.1.1.1.1.1.1.3.cmml" xref="alg1.l5.m1.1.1.1.1.1.1.3">italic-ϵ</ci></apply></apply><ci id="alg1.l5.m1.1.1.1.4.cmml" xref="alg1.l5.m1.1.1.1.4">𝐰</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l5.m1.1c">\mathbf{w}\leftarrow\mathbb{I}[\bm{\theta}&gt;\epsilon]\mathbf{w}</annotation></semantics></math> <span id="alg1.l5.1" class="ltx_text" style="float:right;"><math id="alg1.l5.1.m1.1" class="ltx_Math" alttext="\triangleright" display="inline"><semantics id="alg1.l5.1.m1.1a"><mo id="alg1.l5.1.m1.1.1" xref="alg1.l5.1.m1.1.1.cmml">▷</mo><annotation-xml encoding="MathML-Content" id="alg1.l5.1.m1.1b"><ci id="alg1.l5.1.m1.1.1.cmml" xref="alg1.l5.1.m1.1.1">▷</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.l5.1.m1.1c">\triangleright</annotation></semantics></math> prune global model
</span>
</div>
<div id="alg1.l6" class="ltx_listingline">     Initialize <math id="alg1.l6.m1.2" class="ltx_Math" alttext="\nabla_{\mathbf{w}}^{t}=\mathbf{0},\nabla_{\mathbf{v}}^{t}=\mathbf{0}" display="inline"><semantics id="alg1.l6.m1.2a"><mrow id="alg1.l6.m1.2.2.2" xref="alg1.l6.m1.2.2.3.cmml"><mrow id="alg1.l6.m1.1.1.1.1" xref="alg1.l6.m1.1.1.1.1.cmml"><msubsup id="alg1.l6.m1.1.1.1.1.2" xref="alg1.l6.m1.1.1.1.1.2.cmml"><mo id="alg1.l6.m1.1.1.1.1.2.2.2" xref="alg1.l6.m1.1.1.1.1.2.2.2.cmml">∇</mo><mi id="alg1.l6.m1.1.1.1.1.2.2.3" xref="alg1.l6.m1.1.1.1.1.2.2.3.cmml">𝐰</mi><mi id="alg1.l6.m1.1.1.1.1.2.3" xref="alg1.l6.m1.1.1.1.1.2.3.cmml">t</mi></msubsup><mo id="alg1.l6.m1.1.1.1.1.1" xref="alg1.l6.m1.1.1.1.1.1.cmml">=</mo><mn id="alg1.l6.m1.1.1.1.1.3" xref="alg1.l6.m1.1.1.1.1.3.cmml">𝟎</mn></mrow><mo id="alg1.l6.m1.2.2.2.3" xref="alg1.l6.m1.2.2.3a.cmml">,</mo><mrow id="alg1.l6.m1.2.2.2.2" xref="alg1.l6.m1.2.2.2.2.cmml"><msubsup id="alg1.l6.m1.2.2.2.2.2" xref="alg1.l6.m1.2.2.2.2.2.cmml"><mo id="alg1.l6.m1.2.2.2.2.2.2.2" xref="alg1.l6.m1.2.2.2.2.2.2.2.cmml">∇</mo><mi id="alg1.l6.m1.2.2.2.2.2.2.3" xref="alg1.l6.m1.2.2.2.2.2.2.3.cmml">𝐯</mi><mi id="alg1.l6.m1.2.2.2.2.2.3" xref="alg1.l6.m1.2.2.2.2.2.3.cmml">t</mi></msubsup><mo id="alg1.l6.m1.2.2.2.2.1" xref="alg1.l6.m1.2.2.2.2.1.cmml">=</mo><mn id="alg1.l6.m1.2.2.2.2.3" xref="alg1.l6.m1.2.2.2.2.3.cmml">𝟎</mn></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l6.m1.2b"><apply id="alg1.l6.m1.2.2.3.cmml" xref="alg1.l6.m1.2.2.2"><csymbol cd="ambiguous" id="alg1.l6.m1.2.2.3a.cmml" xref="alg1.l6.m1.2.2.2.3">formulae-sequence</csymbol><apply id="alg1.l6.m1.1.1.1.1.cmml" xref="alg1.l6.m1.1.1.1.1"><eq id="alg1.l6.m1.1.1.1.1.1.cmml" xref="alg1.l6.m1.1.1.1.1.1"></eq><apply id="alg1.l6.m1.1.1.1.1.2.cmml" xref="alg1.l6.m1.1.1.1.1.2"><csymbol cd="ambiguous" id="alg1.l6.m1.1.1.1.1.2.1.cmml" xref="alg1.l6.m1.1.1.1.1.2">superscript</csymbol><apply id="alg1.l6.m1.1.1.1.1.2.2.cmml" xref="alg1.l6.m1.1.1.1.1.2"><csymbol cd="ambiguous" id="alg1.l6.m1.1.1.1.1.2.2.1.cmml" xref="alg1.l6.m1.1.1.1.1.2">subscript</csymbol><ci id="alg1.l6.m1.1.1.1.1.2.2.2.cmml" xref="alg1.l6.m1.1.1.1.1.2.2.2">∇</ci><ci id="alg1.l6.m1.1.1.1.1.2.2.3.cmml" xref="alg1.l6.m1.1.1.1.1.2.2.3">𝐰</ci></apply><ci id="alg1.l6.m1.1.1.1.1.2.3.cmml" xref="alg1.l6.m1.1.1.1.1.2.3">𝑡</ci></apply><cn type="integer" id="alg1.l6.m1.1.1.1.1.3.cmml" xref="alg1.l6.m1.1.1.1.1.3">0</cn></apply><apply id="alg1.l6.m1.2.2.2.2.cmml" xref="alg1.l6.m1.2.2.2.2"><eq id="alg1.l6.m1.2.2.2.2.1.cmml" xref="alg1.l6.m1.2.2.2.2.1"></eq><apply id="alg1.l6.m1.2.2.2.2.2.cmml" xref="alg1.l6.m1.2.2.2.2.2"><csymbol cd="ambiguous" id="alg1.l6.m1.2.2.2.2.2.1.cmml" xref="alg1.l6.m1.2.2.2.2.2">superscript</csymbol><apply id="alg1.l6.m1.2.2.2.2.2.2.cmml" xref="alg1.l6.m1.2.2.2.2.2"><csymbol cd="ambiguous" id="alg1.l6.m1.2.2.2.2.2.2.1.cmml" xref="alg1.l6.m1.2.2.2.2.2">subscript</csymbol><ci id="alg1.l6.m1.2.2.2.2.2.2.2.cmml" xref="alg1.l6.m1.2.2.2.2.2.2.2">∇</ci><ci id="alg1.l6.m1.2.2.2.2.2.2.3.cmml" xref="alg1.l6.m1.2.2.2.2.2.2.3">𝐯</ci></apply><ci id="alg1.l6.m1.2.2.2.2.2.3.cmml" xref="alg1.l6.m1.2.2.2.2.2.3">𝑡</ci></apply><cn type="integer" id="alg1.l6.m1.2.2.2.2.3.cmml" xref="alg1.l6.m1.2.2.2.2.3">0</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l6.m1.2c">\nabla_{\mathbf{w}}^{t}=\mathbf{0},\nabla_{\mathbf{v}}^{t}=\mathbf{0}</annotation></semantics></math>

</div>
<div id="alg1.l7" class="ltx_listingline">     <span id="alg1.l7.1" class="ltx_text ltx_font_bold">for</span> <math id="alg1.l7.m1.1" class="ltx_Math" alttext="s" display="inline"><semantics id="alg1.l7.m1.1a"><mi id="alg1.l7.m1.1.1" xref="alg1.l7.m1.1.1.cmml">s</mi><annotation-xml encoding="MathML-Content" id="alg1.l7.m1.1b"><ci id="alg1.l7.m1.1.1.cmml" xref="alg1.l7.m1.1.1">𝑠</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.l7.m1.1c">s</annotation></semantics></math> in random subset of the clients <span id="alg1.l7.2" class="ltx_text ltx_font_bold">do</span>

</div>
<div id="alg1.l8" class="ltx_listingline">         <math id="alg1.l8.m1.2" class="ltx_Math" alttext="\mathbf{z}_{s},\hat{\mathbf{w}}^{t}_{s}\leftarrow" display="inline"><semantics id="alg1.l8.m1.2a"><mrow id="alg1.l8.m1.2.2" xref="alg1.l8.m1.2.2.cmml"><mrow id="alg1.l8.m1.2.2.2.2" xref="alg1.l8.m1.2.2.2.3.cmml"><msub id="alg1.l8.m1.1.1.1.1.1" xref="alg1.l8.m1.1.1.1.1.1.cmml"><mi id="alg1.l8.m1.1.1.1.1.1.2" xref="alg1.l8.m1.1.1.1.1.1.2.cmml">𝐳</mi><mi id="alg1.l8.m1.1.1.1.1.1.3" xref="alg1.l8.m1.1.1.1.1.1.3.cmml">s</mi></msub><mo id="alg1.l8.m1.2.2.2.2.3" xref="alg1.l8.m1.2.2.2.3.cmml">,</mo><msubsup id="alg1.l8.m1.2.2.2.2.2" xref="alg1.l8.m1.2.2.2.2.2.cmml"><mover accent="true" id="alg1.l8.m1.2.2.2.2.2.2.2" xref="alg1.l8.m1.2.2.2.2.2.2.2.cmml"><mi id="alg1.l8.m1.2.2.2.2.2.2.2.2" xref="alg1.l8.m1.2.2.2.2.2.2.2.2.cmml">𝐰</mi><mo id="alg1.l8.m1.2.2.2.2.2.2.2.1" xref="alg1.l8.m1.2.2.2.2.2.2.2.1.cmml">^</mo></mover><mi id="alg1.l8.m1.2.2.2.2.2.3" xref="alg1.l8.m1.2.2.2.2.2.3.cmml">s</mi><mi id="alg1.l8.m1.2.2.2.2.2.2.3" xref="alg1.l8.m1.2.2.2.2.2.2.3.cmml">t</mi></msubsup></mrow><mo stretchy="false" id="alg1.l8.m1.2.2.3" xref="alg1.l8.m1.2.2.3.cmml">←</mo><mi id="alg1.l8.m1.2.2.4" xref="alg1.l8.m1.2.2.4.cmml"></mi></mrow><annotation-xml encoding="MathML-Content" id="alg1.l8.m1.2b"><apply id="alg1.l8.m1.2.2.cmml" xref="alg1.l8.m1.2.2"><ci id="alg1.l8.m1.2.2.3.cmml" xref="alg1.l8.m1.2.2.3">←</ci><list id="alg1.l8.m1.2.2.2.3.cmml" xref="alg1.l8.m1.2.2.2.2"><apply id="alg1.l8.m1.1.1.1.1.1.cmml" xref="alg1.l8.m1.1.1.1.1.1"><csymbol cd="ambiguous" id="alg1.l8.m1.1.1.1.1.1.1.cmml" xref="alg1.l8.m1.1.1.1.1.1">subscript</csymbol><ci id="alg1.l8.m1.1.1.1.1.1.2.cmml" xref="alg1.l8.m1.1.1.1.1.1.2">𝐳</ci><ci id="alg1.l8.m1.1.1.1.1.1.3.cmml" xref="alg1.l8.m1.1.1.1.1.1.3">𝑠</ci></apply><apply id="alg1.l8.m1.2.2.2.2.2.cmml" xref="alg1.l8.m1.2.2.2.2.2"><csymbol cd="ambiguous" id="alg1.l8.m1.2.2.2.2.2.1.cmml" xref="alg1.l8.m1.2.2.2.2.2">subscript</csymbol><apply id="alg1.l8.m1.2.2.2.2.2.2.cmml" xref="alg1.l8.m1.2.2.2.2.2"><csymbol cd="ambiguous" id="alg1.l8.m1.2.2.2.2.2.2.1.cmml" xref="alg1.l8.m1.2.2.2.2.2">superscript</csymbol><apply id="alg1.l8.m1.2.2.2.2.2.2.2.cmml" xref="alg1.l8.m1.2.2.2.2.2.2.2"><ci id="alg1.l8.m1.2.2.2.2.2.2.2.1.cmml" xref="alg1.l8.m1.2.2.2.2.2.2.2.1">^</ci><ci id="alg1.l8.m1.2.2.2.2.2.2.2.2.cmml" xref="alg1.l8.m1.2.2.2.2.2.2.2.2">𝐰</ci></apply><ci id="alg1.l8.m1.2.2.2.2.2.2.3.cmml" xref="alg1.l8.m1.2.2.2.2.2.2.3">𝑡</ci></apply><ci id="alg1.l8.m1.2.2.2.2.2.3.cmml" xref="alg1.l8.m1.2.2.2.2.2.3">𝑠</ci></apply></list><csymbol cd="latexml" id="alg1.l8.m1.2.2.4.cmml" xref="alg1.l8.m1.2.2.4">absent</csymbol></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l8.m1.2c">\mathbf{z}_{s},\hat{\mathbf{w}}^{t}_{s}\leftarrow</annotation></semantics></math> <span id="alg1.l8.1" class="ltx_text ltx_font_smallcaps">Client</span>(<math id="alg1.l8.m2.3" class="ltx_Math" alttext="s,\mathbf{w},\mathbf{v}" display="inline"><semantics id="alg1.l8.m2.3a"><mrow id="alg1.l8.m2.3.4.2" xref="alg1.l8.m2.3.4.1.cmml"><mi id="alg1.l8.m2.1.1" xref="alg1.l8.m2.1.1.cmml">s</mi><mo id="alg1.l8.m2.3.4.2.1" xref="alg1.l8.m2.3.4.1.cmml">,</mo><mi id="alg1.l8.m2.2.2" xref="alg1.l8.m2.2.2.cmml">𝐰</mi><mo id="alg1.l8.m2.3.4.2.2" xref="alg1.l8.m2.3.4.1.cmml">,</mo><mi id="alg1.l8.m2.3.3" xref="alg1.l8.m2.3.3.cmml">𝐯</mi></mrow><annotation-xml encoding="MathML-Content" id="alg1.l8.m2.3b"><list id="alg1.l8.m2.3.4.1.cmml" xref="alg1.l8.m2.3.4.2"><ci id="alg1.l8.m2.1.1.cmml" xref="alg1.l8.m2.1.1">𝑠</ci><ci id="alg1.l8.m2.2.2.cmml" xref="alg1.l8.m2.2.2">𝐰</ci><ci id="alg1.l8.m2.3.3.cmml" xref="alg1.l8.m2.3.3">𝐯</ci></list></annotation-xml><annotation encoding="application/x-tex" id="alg1.l8.m2.3c">s,\mathbf{w},\mathbf{v}</annotation></semantics></math>)

</div>
<div id="alg1.l9" class="ltx_listingline">         <math id="alg1.l9.m1.1" class="ltx_Math" alttext="\nabla_{\mathbf{w}}^{t}+=\mathbf{z}_{s}(\hat{\mathbf{w}}^{t}_{s}-\mathbf{w})" display="inline"><semantics id="alg1.l9.m1.1a"><mrow id="alg1.l9.m1.1.1" xref="alg1.l9.m1.1.1.cmml"><mrow id="alg1.l9.m1.1.1.3" xref="alg1.l9.m1.1.1.3.cmml"><msubsup id="alg1.l9.m1.1.1.3.2" xref="alg1.l9.m1.1.1.3.2.cmml"><mo id="alg1.l9.m1.1.1.3.2.2.2" xref="alg1.l9.m1.1.1.3.2.2.2.cmml">∇</mo><mi id="alg1.l9.m1.1.1.3.2.2.3" xref="alg1.l9.m1.1.1.3.2.2.3.cmml">𝐰</mi><mi id="alg1.l9.m1.1.1.3.2.3" xref="alg1.l9.m1.1.1.3.2.3.cmml">t</mi></msubsup><mo lspace="0em" rspace="0em" id="alg1.l9.m1.1.1.3.3" xref="alg1.l9.m1.1.1.3.3.cmml">+</mo></mrow><mo lspace="0em" id="alg1.l9.m1.1.1.2" xref="alg1.l9.m1.1.1.2.cmml">=</mo><mrow id="alg1.l9.m1.1.1.1" xref="alg1.l9.m1.1.1.1.cmml"><msub id="alg1.l9.m1.1.1.1.3" xref="alg1.l9.m1.1.1.1.3.cmml"><mi id="alg1.l9.m1.1.1.1.3.2" xref="alg1.l9.m1.1.1.1.3.2.cmml">𝐳</mi><mi id="alg1.l9.m1.1.1.1.3.3" xref="alg1.l9.m1.1.1.1.3.3.cmml">s</mi></msub><mo lspace="0em" rspace="0em" id="alg1.l9.m1.1.1.1.2" xref="alg1.l9.m1.1.1.1.2.cmml">​</mo><mrow id="alg1.l9.m1.1.1.1.1.1" xref="alg1.l9.m1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="alg1.l9.m1.1.1.1.1.1.2" xref="alg1.l9.m1.1.1.1.1.1.1.cmml">(</mo><mrow id="alg1.l9.m1.1.1.1.1.1.1" xref="alg1.l9.m1.1.1.1.1.1.1.cmml"><msubsup id="alg1.l9.m1.1.1.1.1.1.1.2" xref="alg1.l9.m1.1.1.1.1.1.1.2.cmml"><mover accent="true" id="alg1.l9.m1.1.1.1.1.1.1.2.2.2" xref="alg1.l9.m1.1.1.1.1.1.1.2.2.2.cmml"><mi id="alg1.l9.m1.1.1.1.1.1.1.2.2.2.2" xref="alg1.l9.m1.1.1.1.1.1.1.2.2.2.2.cmml">𝐰</mi><mo id="alg1.l9.m1.1.1.1.1.1.1.2.2.2.1" xref="alg1.l9.m1.1.1.1.1.1.1.2.2.2.1.cmml">^</mo></mover><mi id="alg1.l9.m1.1.1.1.1.1.1.2.3" xref="alg1.l9.m1.1.1.1.1.1.1.2.3.cmml">s</mi><mi id="alg1.l9.m1.1.1.1.1.1.1.2.2.3" xref="alg1.l9.m1.1.1.1.1.1.1.2.2.3.cmml">t</mi></msubsup><mo id="alg1.l9.m1.1.1.1.1.1.1.1" xref="alg1.l9.m1.1.1.1.1.1.1.1.cmml">−</mo><mi id="alg1.l9.m1.1.1.1.1.1.1.3" xref="alg1.l9.m1.1.1.1.1.1.1.3.cmml">𝐰</mi></mrow><mo stretchy="false" id="alg1.l9.m1.1.1.1.1.1.3" xref="alg1.l9.m1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l9.m1.1b"><apply id="alg1.l9.m1.1.1.cmml" xref="alg1.l9.m1.1.1"><eq id="alg1.l9.m1.1.1.2.cmml" xref="alg1.l9.m1.1.1.2"></eq><apply id="alg1.l9.m1.1.1.3.cmml" xref="alg1.l9.m1.1.1.3"><csymbol cd="latexml" id="alg1.l9.m1.1.1.3.1.cmml" xref="alg1.l9.m1.1.1.3">limit-from</csymbol><apply id="alg1.l9.m1.1.1.3.2.cmml" xref="alg1.l9.m1.1.1.3.2"><csymbol cd="ambiguous" id="alg1.l9.m1.1.1.3.2.1.cmml" xref="alg1.l9.m1.1.1.3.2">superscript</csymbol><apply id="alg1.l9.m1.1.1.3.2.2.cmml" xref="alg1.l9.m1.1.1.3.2"><csymbol cd="ambiguous" id="alg1.l9.m1.1.1.3.2.2.1.cmml" xref="alg1.l9.m1.1.1.3.2">subscript</csymbol><ci id="alg1.l9.m1.1.1.3.2.2.2.cmml" xref="alg1.l9.m1.1.1.3.2.2.2">∇</ci><ci id="alg1.l9.m1.1.1.3.2.2.3.cmml" xref="alg1.l9.m1.1.1.3.2.2.3">𝐰</ci></apply><ci id="alg1.l9.m1.1.1.3.2.3.cmml" xref="alg1.l9.m1.1.1.3.2.3">𝑡</ci></apply><plus id="alg1.l9.m1.1.1.3.3.cmml" xref="alg1.l9.m1.1.1.3.3"></plus></apply><apply id="alg1.l9.m1.1.1.1.cmml" xref="alg1.l9.m1.1.1.1"><times id="alg1.l9.m1.1.1.1.2.cmml" xref="alg1.l9.m1.1.1.1.2"></times><apply id="alg1.l9.m1.1.1.1.3.cmml" xref="alg1.l9.m1.1.1.1.3"><csymbol cd="ambiguous" id="alg1.l9.m1.1.1.1.3.1.cmml" xref="alg1.l9.m1.1.1.1.3">subscript</csymbol><ci id="alg1.l9.m1.1.1.1.3.2.cmml" xref="alg1.l9.m1.1.1.1.3.2">𝐳</ci><ci id="alg1.l9.m1.1.1.1.3.3.cmml" xref="alg1.l9.m1.1.1.1.3.3">𝑠</ci></apply><apply id="alg1.l9.m1.1.1.1.1.1.1.cmml" xref="alg1.l9.m1.1.1.1.1.1"><minus id="alg1.l9.m1.1.1.1.1.1.1.1.cmml" xref="alg1.l9.m1.1.1.1.1.1.1.1"></minus><apply id="alg1.l9.m1.1.1.1.1.1.1.2.cmml" xref="alg1.l9.m1.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="alg1.l9.m1.1.1.1.1.1.1.2.1.cmml" xref="alg1.l9.m1.1.1.1.1.1.1.2">subscript</csymbol><apply id="alg1.l9.m1.1.1.1.1.1.1.2.2.cmml" xref="alg1.l9.m1.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="alg1.l9.m1.1.1.1.1.1.1.2.2.1.cmml" xref="alg1.l9.m1.1.1.1.1.1.1.2">superscript</csymbol><apply id="alg1.l9.m1.1.1.1.1.1.1.2.2.2.cmml" xref="alg1.l9.m1.1.1.1.1.1.1.2.2.2"><ci id="alg1.l9.m1.1.1.1.1.1.1.2.2.2.1.cmml" xref="alg1.l9.m1.1.1.1.1.1.1.2.2.2.1">^</ci><ci id="alg1.l9.m1.1.1.1.1.1.1.2.2.2.2.cmml" xref="alg1.l9.m1.1.1.1.1.1.1.2.2.2.2">𝐰</ci></apply><ci id="alg1.l9.m1.1.1.1.1.1.1.2.2.3.cmml" xref="alg1.l9.m1.1.1.1.1.1.1.2.2.3">𝑡</ci></apply><ci id="alg1.l9.m1.1.1.1.1.1.1.2.3.cmml" xref="alg1.l9.m1.1.1.1.1.1.1.2.3">𝑠</ci></apply><ci id="alg1.l9.m1.1.1.1.1.1.1.3.cmml" xref="alg1.l9.m1.1.1.1.1.1.1.3">𝐰</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l9.m1.1c">\nabla_{\mathbf{w}}^{t}+=\mathbf{z}_{s}(\hat{\mathbf{w}}^{t}_{s}-\mathbf{w})</annotation></semantics></math>

</div>
<div id="alg1.l10" class="ltx_listingline">         <math id="alg1.l10.m1.2" class="ltx_Math" alttext="\nabla_{\mathbf{v}}^{t}+=-\left(\mathbf{z}_{s}(1-\bm{\theta})-(1-\mathbf{z}_{s})\bm{\theta}\right)\sigma(\mathbf{v})/T" display="inline"><semantics id="alg1.l10.m1.2a"><mrow id="alg1.l10.m1.2.2" xref="alg1.l10.m1.2.2.cmml"><mrow id="alg1.l10.m1.2.2.3" xref="alg1.l10.m1.2.2.3.cmml"><msubsup id="alg1.l10.m1.2.2.3.2" xref="alg1.l10.m1.2.2.3.2.cmml"><mo id="alg1.l10.m1.2.2.3.2.2.2" xref="alg1.l10.m1.2.2.3.2.2.2.cmml">∇</mo><mi id="alg1.l10.m1.2.2.3.2.2.3" xref="alg1.l10.m1.2.2.3.2.2.3.cmml">𝐯</mi><mi id="alg1.l10.m1.2.2.3.2.3" xref="alg1.l10.m1.2.2.3.2.3.cmml">t</mi></msubsup><mo lspace="0em" rspace="0em" id="alg1.l10.m1.2.2.3.3" xref="alg1.l10.m1.2.2.3.3.cmml">+</mo></mrow><mo lspace="0em" id="alg1.l10.m1.2.2.2" xref="alg1.l10.m1.2.2.2.cmml">=</mo><mrow id="alg1.l10.m1.2.2.1" xref="alg1.l10.m1.2.2.1.cmml"><mo id="alg1.l10.m1.2.2.1a" xref="alg1.l10.m1.2.2.1.cmml">−</mo><mrow id="alg1.l10.m1.2.2.1.1" xref="alg1.l10.m1.2.2.1.1.cmml"><mrow id="alg1.l10.m1.2.2.1.1.1" xref="alg1.l10.m1.2.2.1.1.1.cmml"><mrow id="alg1.l10.m1.2.2.1.1.1.1.1" xref="alg1.l10.m1.2.2.1.1.1.1.1.1.cmml"><mo id="alg1.l10.m1.2.2.1.1.1.1.1.2" xref="alg1.l10.m1.2.2.1.1.1.1.1.1.cmml">(</mo><mrow id="alg1.l10.m1.2.2.1.1.1.1.1.1" xref="alg1.l10.m1.2.2.1.1.1.1.1.1.cmml"><mrow id="alg1.l10.m1.2.2.1.1.1.1.1.1.1" xref="alg1.l10.m1.2.2.1.1.1.1.1.1.1.cmml"><msub id="alg1.l10.m1.2.2.1.1.1.1.1.1.1.3" xref="alg1.l10.m1.2.2.1.1.1.1.1.1.1.3.cmml"><mi id="alg1.l10.m1.2.2.1.1.1.1.1.1.1.3.2" xref="alg1.l10.m1.2.2.1.1.1.1.1.1.1.3.2.cmml">𝐳</mi><mi id="alg1.l10.m1.2.2.1.1.1.1.1.1.1.3.3" xref="alg1.l10.m1.2.2.1.1.1.1.1.1.1.3.3.cmml">s</mi></msub><mo lspace="0em" rspace="0em" id="alg1.l10.m1.2.2.1.1.1.1.1.1.1.2" xref="alg1.l10.m1.2.2.1.1.1.1.1.1.1.2.cmml">​</mo><mrow id="alg1.l10.m1.2.2.1.1.1.1.1.1.1.1.1" xref="alg1.l10.m1.2.2.1.1.1.1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="alg1.l10.m1.2.2.1.1.1.1.1.1.1.1.1.2" xref="alg1.l10.m1.2.2.1.1.1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="alg1.l10.m1.2.2.1.1.1.1.1.1.1.1.1.1" xref="alg1.l10.m1.2.2.1.1.1.1.1.1.1.1.1.1.cmml"><mn id="alg1.l10.m1.2.2.1.1.1.1.1.1.1.1.1.1.2" xref="alg1.l10.m1.2.2.1.1.1.1.1.1.1.1.1.1.2.cmml">1</mn><mo id="alg1.l10.m1.2.2.1.1.1.1.1.1.1.1.1.1.1" xref="alg1.l10.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.cmml">−</mo><mi id="alg1.l10.m1.2.2.1.1.1.1.1.1.1.1.1.1.3" xref="alg1.l10.m1.2.2.1.1.1.1.1.1.1.1.1.1.3.cmml">𝜽</mi></mrow><mo stretchy="false" id="alg1.l10.m1.2.2.1.1.1.1.1.1.1.1.1.3" xref="alg1.l10.m1.2.2.1.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="alg1.l10.m1.2.2.1.1.1.1.1.1.3" xref="alg1.l10.m1.2.2.1.1.1.1.1.1.3.cmml">−</mo><mrow id="alg1.l10.m1.2.2.1.1.1.1.1.1.2" xref="alg1.l10.m1.2.2.1.1.1.1.1.1.2.cmml"><mrow id="alg1.l10.m1.2.2.1.1.1.1.1.1.2.1.1" xref="alg1.l10.m1.2.2.1.1.1.1.1.1.2.1.1.1.cmml"><mo stretchy="false" id="alg1.l10.m1.2.2.1.1.1.1.1.1.2.1.1.2" xref="alg1.l10.m1.2.2.1.1.1.1.1.1.2.1.1.1.cmml">(</mo><mrow id="alg1.l10.m1.2.2.1.1.1.1.1.1.2.1.1.1" xref="alg1.l10.m1.2.2.1.1.1.1.1.1.2.1.1.1.cmml"><mn id="alg1.l10.m1.2.2.1.1.1.1.1.1.2.1.1.1.2" xref="alg1.l10.m1.2.2.1.1.1.1.1.1.2.1.1.1.2.cmml">1</mn><mo id="alg1.l10.m1.2.2.1.1.1.1.1.1.2.1.1.1.1" xref="alg1.l10.m1.2.2.1.1.1.1.1.1.2.1.1.1.1.cmml">−</mo><msub id="alg1.l10.m1.2.2.1.1.1.1.1.1.2.1.1.1.3" xref="alg1.l10.m1.2.2.1.1.1.1.1.1.2.1.1.1.3.cmml"><mi id="alg1.l10.m1.2.2.1.1.1.1.1.1.2.1.1.1.3.2" xref="alg1.l10.m1.2.2.1.1.1.1.1.1.2.1.1.1.3.2.cmml">𝐳</mi><mi id="alg1.l10.m1.2.2.1.1.1.1.1.1.2.1.1.1.3.3" xref="alg1.l10.m1.2.2.1.1.1.1.1.1.2.1.1.1.3.3.cmml">s</mi></msub></mrow><mo stretchy="false" id="alg1.l10.m1.2.2.1.1.1.1.1.1.2.1.1.3" xref="alg1.l10.m1.2.2.1.1.1.1.1.1.2.1.1.1.cmml">)</mo></mrow><mo lspace="0em" rspace="0em" id="alg1.l10.m1.2.2.1.1.1.1.1.1.2.2" xref="alg1.l10.m1.2.2.1.1.1.1.1.1.2.2.cmml">​</mo><mi id="alg1.l10.m1.2.2.1.1.1.1.1.1.2.3" xref="alg1.l10.m1.2.2.1.1.1.1.1.1.2.3.cmml">𝜽</mi></mrow></mrow><mo id="alg1.l10.m1.2.2.1.1.1.1.1.3" xref="alg1.l10.m1.2.2.1.1.1.1.1.1.cmml">)</mo></mrow><mo lspace="0em" rspace="0em" id="alg1.l10.m1.2.2.1.1.1.2" xref="alg1.l10.m1.2.2.1.1.1.2.cmml">​</mo><mi id="alg1.l10.m1.2.2.1.1.1.3" xref="alg1.l10.m1.2.2.1.1.1.3.cmml">σ</mi><mo lspace="0em" rspace="0em" id="alg1.l10.m1.2.2.1.1.1.2a" xref="alg1.l10.m1.2.2.1.1.1.2.cmml">​</mo><mrow id="alg1.l10.m1.2.2.1.1.1.4.2" xref="alg1.l10.m1.2.2.1.1.1.cmml"><mo stretchy="false" id="alg1.l10.m1.2.2.1.1.1.4.2.1" xref="alg1.l10.m1.2.2.1.1.1.cmml">(</mo><mi id="alg1.l10.m1.1.1" xref="alg1.l10.m1.1.1.cmml">𝐯</mi><mo stretchy="false" id="alg1.l10.m1.2.2.1.1.1.4.2.2" xref="alg1.l10.m1.2.2.1.1.1.cmml">)</mo></mrow></mrow><mo id="alg1.l10.m1.2.2.1.1.2" xref="alg1.l10.m1.2.2.1.1.2.cmml">/</mo><mi id="alg1.l10.m1.2.2.1.1.3" xref="alg1.l10.m1.2.2.1.1.3.cmml">T</mi></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l10.m1.2b"><apply id="alg1.l10.m1.2.2.cmml" xref="alg1.l10.m1.2.2"><eq id="alg1.l10.m1.2.2.2.cmml" xref="alg1.l10.m1.2.2.2"></eq><apply id="alg1.l10.m1.2.2.3.cmml" xref="alg1.l10.m1.2.2.3"><csymbol cd="latexml" id="alg1.l10.m1.2.2.3.1.cmml" xref="alg1.l10.m1.2.2.3">limit-from</csymbol><apply id="alg1.l10.m1.2.2.3.2.cmml" xref="alg1.l10.m1.2.2.3.2"><csymbol cd="ambiguous" id="alg1.l10.m1.2.2.3.2.1.cmml" xref="alg1.l10.m1.2.2.3.2">superscript</csymbol><apply id="alg1.l10.m1.2.2.3.2.2.cmml" xref="alg1.l10.m1.2.2.3.2"><csymbol cd="ambiguous" id="alg1.l10.m1.2.2.3.2.2.1.cmml" xref="alg1.l10.m1.2.2.3.2">subscript</csymbol><ci id="alg1.l10.m1.2.2.3.2.2.2.cmml" xref="alg1.l10.m1.2.2.3.2.2.2">∇</ci><ci id="alg1.l10.m1.2.2.3.2.2.3.cmml" xref="alg1.l10.m1.2.2.3.2.2.3">𝐯</ci></apply><ci id="alg1.l10.m1.2.2.3.2.3.cmml" xref="alg1.l10.m1.2.2.3.2.3">𝑡</ci></apply><plus id="alg1.l10.m1.2.2.3.3.cmml" xref="alg1.l10.m1.2.2.3.3"></plus></apply><apply id="alg1.l10.m1.2.2.1.cmml" xref="alg1.l10.m1.2.2.1"><minus id="alg1.l10.m1.2.2.1.2.cmml" xref="alg1.l10.m1.2.2.1"></minus><apply id="alg1.l10.m1.2.2.1.1.cmml" xref="alg1.l10.m1.2.2.1.1"><divide id="alg1.l10.m1.2.2.1.1.2.cmml" xref="alg1.l10.m1.2.2.1.1.2"></divide><apply id="alg1.l10.m1.2.2.1.1.1.cmml" xref="alg1.l10.m1.2.2.1.1.1"><times id="alg1.l10.m1.2.2.1.1.1.2.cmml" xref="alg1.l10.m1.2.2.1.1.1.2"></times><apply id="alg1.l10.m1.2.2.1.1.1.1.1.1.cmml" xref="alg1.l10.m1.2.2.1.1.1.1.1"><minus id="alg1.l10.m1.2.2.1.1.1.1.1.1.3.cmml" xref="alg1.l10.m1.2.2.1.1.1.1.1.1.3"></minus><apply id="alg1.l10.m1.2.2.1.1.1.1.1.1.1.cmml" xref="alg1.l10.m1.2.2.1.1.1.1.1.1.1"><times id="alg1.l10.m1.2.2.1.1.1.1.1.1.1.2.cmml" xref="alg1.l10.m1.2.2.1.1.1.1.1.1.1.2"></times><apply id="alg1.l10.m1.2.2.1.1.1.1.1.1.1.3.cmml" xref="alg1.l10.m1.2.2.1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="alg1.l10.m1.2.2.1.1.1.1.1.1.1.3.1.cmml" xref="alg1.l10.m1.2.2.1.1.1.1.1.1.1.3">subscript</csymbol><ci id="alg1.l10.m1.2.2.1.1.1.1.1.1.1.3.2.cmml" xref="alg1.l10.m1.2.2.1.1.1.1.1.1.1.3.2">𝐳</ci><ci id="alg1.l10.m1.2.2.1.1.1.1.1.1.1.3.3.cmml" xref="alg1.l10.m1.2.2.1.1.1.1.1.1.1.3.3">𝑠</ci></apply><apply id="alg1.l10.m1.2.2.1.1.1.1.1.1.1.1.1.1.cmml" xref="alg1.l10.m1.2.2.1.1.1.1.1.1.1.1.1"><minus id="alg1.l10.m1.2.2.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="alg1.l10.m1.2.2.1.1.1.1.1.1.1.1.1.1.1"></minus><cn type="integer" id="alg1.l10.m1.2.2.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="alg1.l10.m1.2.2.1.1.1.1.1.1.1.1.1.1.2">1</cn><ci id="alg1.l10.m1.2.2.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="alg1.l10.m1.2.2.1.1.1.1.1.1.1.1.1.1.3">𝜽</ci></apply></apply><apply id="alg1.l10.m1.2.2.1.1.1.1.1.1.2.cmml" xref="alg1.l10.m1.2.2.1.1.1.1.1.1.2"><times id="alg1.l10.m1.2.2.1.1.1.1.1.1.2.2.cmml" xref="alg1.l10.m1.2.2.1.1.1.1.1.1.2.2"></times><apply id="alg1.l10.m1.2.2.1.1.1.1.1.1.2.1.1.1.cmml" xref="alg1.l10.m1.2.2.1.1.1.1.1.1.2.1.1"><minus id="alg1.l10.m1.2.2.1.1.1.1.1.1.2.1.1.1.1.cmml" xref="alg1.l10.m1.2.2.1.1.1.1.1.1.2.1.1.1.1"></minus><cn type="integer" id="alg1.l10.m1.2.2.1.1.1.1.1.1.2.1.1.1.2.cmml" xref="alg1.l10.m1.2.2.1.1.1.1.1.1.2.1.1.1.2">1</cn><apply id="alg1.l10.m1.2.2.1.1.1.1.1.1.2.1.1.1.3.cmml" xref="alg1.l10.m1.2.2.1.1.1.1.1.1.2.1.1.1.3"><csymbol cd="ambiguous" id="alg1.l10.m1.2.2.1.1.1.1.1.1.2.1.1.1.3.1.cmml" xref="alg1.l10.m1.2.2.1.1.1.1.1.1.2.1.1.1.3">subscript</csymbol><ci id="alg1.l10.m1.2.2.1.1.1.1.1.1.2.1.1.1.3.2.cmml" xref="alg1.l10.m1.2.2.1.1.1.1.1.1.2.1.1.1.3.2">𝐳</ci><ci id="alg1.l10.m1.2.2.1.1.1.1.1.1.2.1.1.1.3.3.cmml" xref="alg1.l10.m1.2.2.1.1.1.1.1.1.2.1.1.1.3.3">𝑠</ci></apply></apply><ci id="alg1.l10.m1.2.2.1.1.1.1.1.1.2.3.cmml" xref="alg1.l10.m1.2.2.1.1.1.1.1.1.2.3">𝜽</ci></apply></apply><ci id="alg1.l10.m1.2.2.1.1.1.3.cmml" xref="alg1.l10.m1.2.2.1.1.1.3">𝜎</ci><ci id="alg1.l10.m1.1.1.cmml" xref="alg1.l10.m1.1.1">𝐯</ci></apply><ci id="alg1.l10.m1.2.2.1.1.3.cmml" xref="alg1.l10.m1.2.2.1.1.3">𝑇</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l10.m1.2c">\nabla_{\mathbf{v}}^{t}+=-\left(\mathbf{z}_{s}(1-\bm{\theta})-(1-\mathbf{z}_{s})\bm{\theta}\right)\sigma(\mathbf{v})/T</annotation></semantics></math>

</div>
<div id="alg1.l11" class="ltx_listingline">     <span id="alg1.l11.1" class="ltx_text ltx_font_bold">end</span> <span id="alg1.l11.2" class="ltx_text ltx_font_bold">for</span>
</div>
<div id="alg1.l12" class="ltx_listingline">     <math id="alg1.l12.m1.2" class="ltx_Math" alttext="\mathbf{w}^{t+1},\mathbf{v}^{t+1}\leftarrow" display="inline"><semantics id="alg1.l12.m1.2a"><mrow id="alg1.l12.m1.2.2" xref="alg1.l12.m1.2.2.cmml"><mrow id="alg1.l12.m1.2.2.2.2" xref="alg1.l12.m1.2.2.2.3.cmml"><msup id="alg1.l12.m1.1.1.1.1.1" xref="alg1.l12.m1.1.1.1.1.1.cmml"><mi id="alg1.l12.m1.1.1.1.1.1.2" xref="alg1.l12.m1.1.1.1.1.1.2.cmml">𝐰</mi><mrow id="alg1.l12.m1.1.1.1.1.1.3" xref="alg1.l12.m1.1.1.1.1.1.3.cmml"><mi id="alg1.l12.m1.1.1.1.1.1.3.2" xref="alg1.l12.m1.1.1.1.1.1.3.2.cmml">t</mi><mo id="alg1.l12.m1.1.1.1.1.1.3.1" xref="alg1.l12.m1.1.1.1.1.1.3.1.cmml">+</mo><mn id="alg1.l12.m1.1.1.1.1.1.3.3" xref="alg1.l12.m1.1.1.1.1.1.3.3.cmml">1</mn></mrow></msup><mo id="alg1.l12.m1.2.2.2.2.3" xref="alg1.l12.m1.2.2.2.3.cmml">,</mo><msup id="alg1.l12.m1.2.2.2.2.2" xref="alg1.l12.m1.2.2.2.2.2.cmml"><mi id="alg1.l12.m1.2.2.2.2.2.2" xref="alg1.l12.m1.2.2.2.2.2.2.cmml">𝐯</mi><mrow id="alg1.l12.m1.2.2.2.2.2.3" xref="alg1.l12.m1.2.2.2.2.2.3.cmml"><mi id="alg1.l12.m1.2.2.2.2.2.3.2" xref="alg1.l12.m1.2.2.2.2.2.3.2.cmml">t</mi><mo id="alg1.l12.m1.2.2.2.2.2.3.1" xref="alg1.l12.m1.2.2.2.2.2.3.1.cmml">+</mo><mn id="alg1.l12.m1.2.2.2.2.2.3.3" xref="alg1.l12.m1.2.2.2.2.2.3.3.cmml">1</mn></mrow></msup></mrow><mo stretchy="false" id="alg1.l12.m1.2.2.3" xref="alg1.l12.m1.2.2.3.cmml">←</mo><mi id="alg1.l12.m1.2.2.4" xref="alg1.l12.m1.2.2.4.cmml"></mi></mrow><annotation-xml encoding="MathML-Content" id="alg1.l12.m1.2b"><apply id="alg1.l12.m1.2.2.cmml" xref="alg1.l12.m1.2.2"><ci id="alg1.l12.m1.2.2.3.cmml" xref="alg1.l12.m1.2.2.3">←</ci><list id="alg1.l12.m1.2.2.2.3.cmml" xref="alg1.l12.m1.2.2.2.2"><apply id="alg1.l12.m1.1.1.1.1.1.cmml" xref="alg1.l12.m1.1.1.1.1.1"><csymbol cd="ambiguous" id="alg1.l12.m1.1.1.1.1.1.1.cmml" xref="alg1.l12.m1.1.1.1.1.1">superscript</csymbol><ci id="alg1.l12.m1.1.1.1.1.1.2.cmml" xref="alg1.l12.m1.1.1.1.1.1.2">𝐰</ci><apply id="alg1.l12.m1.1.1.1.1.1.3.cmml" xref="alg1.l12.m1.1.1.1.1.1.3"><plus id="alg1.l12.m1.1.1.1.1.1.3.1.cmml" xref="alg1.l12.m1.1.1.1.1.1.3.1"></plus><ci id="alg1.l12.m1.1.1.1.1.1.3.2.cmml" xref="alg1.l12.m1.1.1.1.1.1.3.2">𝑡</ci><cn type="integer" id="alg1.l12.m1.1.1.1.1.1.3.3.cmml" xref="alg1.l12.m1.1.1.1.1.1.3.3">1</cn></apply></apply><apply id="alg1.l12.m1.2.2.2.2.2.cmml" xref="alg1.l12.m1.2.2.2.2.2"><csymbol cd="ambiguous" id="alg1.l12.m1.2.2.2.2.2.1.cmml" xref="alg1.l12.m1.2.2.2.2.2">superscript</csymbol><ci id="alg1.l12.m1.2.2.2.2.2.2.cmml" xref="alg1.l12.m1.2.2.2.2.2.2">𝐯</ci><apply id="alg1.l12.m1.2.2.2.2.2.3.cmml" xref="alg1.l12.m1.2.2.2.2.2.3"><plus id="alg1.l12.m1.2.2.2.2.2.3.1.cmml" xref="alg1.l12.m1.2.2.2.2.2.3.1"></plus><ci id="alg1.l12.m1.2.2.2.2.2.3.2.cmml" xref="alg1.l12.m1.2.2.2.2.2.3.2">𝑡</ci><cn type="integer" id="alg1.l12.m1.2.2.2.2.2.3.3.cmml" xref="alg1.l12.m1.2.2.2.2.2.3.3">1</cn></apply></apply></list><csymbol cd="latexml" id="alg1.l12.m1.2.2.4.cmml" xref="alg1.l12.m1.2.2.4">absent</csymbol></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l12.m1.2c">\mathbf{w}^{t+1},\mathbf{v}^{t+1}\leftarrow</annotation></semantics></math> <span id="alg1.l12.1" class="ltx_text ltx_font_smallcaps">Adam</span>(<math id="alg1.l12.m2.1" class="ltx_Math" alttext="\nabla_{\mathbf{w}}^{t}" display="inline"><semantics id="alg1.l12.m2.1a"><msubsup id="alg1.l12.m2.1.1" xref="alg1.l12.m2.1.1.cmml"><mo id="alg1.l12.m2.1.1.2.2" xref="alg1.l12.m2.1.1.2.2.cmml">∇</mo><mi id="alg1.l12.m2.1.1.2.3" xref="alg1.l12.m2.1.1.2.3.cmml">𝐰</mi><mi id="alg1.l12.m2.1.1.3" xref="alg1.l12.m2.1.1.3.cmml">t</mi></msubsup><annotation-xml encoding="MathML-Content" id="alg1.l12.m2.1b"><apply id="alg1.l12.m2.1.1.cmml" xref="alg1.l12.m2.1.1"><csymbol cd="ambiguous" id="alg1.l12.m2.1.1.1.cmml" xref="alg1.l12.m2.1.1">superscript</csymbol><apply id="alg1.l12.m2.1.1.2.cmml" xref="alg1.l12.m2.1.1"><csymbol cd="ambiguous" id="alg1.l12.m2.1.1.2.1.cmml" xref="alg1.l12.m2.1.1">subscript</csymbol><ci id="alg1.l12.m2.1.1.2.2.cmml" xref="alg1.l12.m2.1.1.2.2">∇</ci><ci id="alg1.l12.m2.1.1.2.3.cmml" xref="alg1.l12.m2.1.1.2.3">𝐰</ci></apply><ci id="alg1.l12.m2.1.1.3.cmml" xref="alg1.l12.m2.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l12.m2.1c">\nabla_{\mathbf{w}}^{t}</annotation></semantics></math>), <span id="alg1.l12.2" class="ltx_text ltx_font_smallcaps">Adamax</span>(<math id="alg1.l12.m3.1" class="ltx_Math" alttext="\nabla_{\mathbf{v}}^{t}" display="inline"><semantics id="alg1.l12.m3.1a"><msubsup id="alg1.l12.m3.1.1" xref="alg1.l12.m3.1.1.cmml"><mo id="alg1.l12.m3.1.1.2.2" xref="alg1.l12.m3.1.1.2.2.cmml">∇</mo><mi id="alg1.l12.m3.1.1.2.3" xref="alg1.l12.m3.1.1.2.3.cmml">𝐯</mi><mi id="alg1.l12.m3.1.1.3" xref="alg1.l12.m3.1.1.3.cmml">t</mi></msubsup><annotation-xml encoding="MathML-Content" id="alg1.l12.m3.1b"><apply id="alg1.l12.m3.1.1.cmml" xref="alg1.l12.m3.1.1"><csymbol cd="ambiguous" id="alg1.l12.m3.1.1.1.cmml" xref="alg1.l12.m3.1.1">superscript</csymbol><apply id="alg1.l12.m3.1.1.2.cmml" xref="alg1.l12.m3.1.1"><csymbol cd="ambiguous" id="alg1.l12.m3.1.1.2.1.cmml" xref="alg1.l12.m3.1.1">subscript</csymbol><ci id="alg1.l12.m3.1.1.2.2.cmml" xref="alg1.l12.m3.1.1.2.2">∇</ci><ci id="alg1.l12.m3.1.1.2.3.cmml" xref="alg1.l12.m3.1.1.2.3">𝐯</ci></apply><ci id="alg1.l12.m3.1.1.3.cmml" xref="alg1.l12.m3.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l12.m3.1c">\nabla_{\mathbf{v}}^{t}</annotation></semantics></math>)

</div>
<div id="alg1.l13" class="ltx_listingline">
<span id="alg1.l13.1" class="ltx_text ltx_font_bold">end</span> <span id="alg1.l13.2" class="ltx_text ltx_font_bold">for</span>
</div>
</div>
</figure>
<figure id="alg2" class="ltx_float ltx_float_algorithm ltx_framed ltx_framed_top">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_float"><span id="alg2.3.1.1" class="ltx_text ltx_font_bold">Algorithm 2</span> </span> The client side algorithm for <span id="alg2.4.2" class="ltx_text ltx_font_typewriter">FedSparse</span>.</figcaption>
<div id="alg2.5" class="ltx_listing ltx_listing">
<div id="alg2.l1" class="ltx_listingline">Get <math id="alg2.l1.m1.2" class="ltx_Math" alttext="\mathbf{w},\mathbf{v}" display="inline"><semantics id="alg2.l1.m1.2a"><mrow id="alg2.l1.m1.2.3.2" xref="alg2.l1.m1.2.3.1.cmml"><mi id="alg2.l1.m1.1.1" xref="alg2.l1.m1.1.1.cmml">𝐰</mi><mo id="alg2.l1.m1.2.3.2.1" xref="alg2.l1.m1.2.3.1.cmml">,</mo><mi id="alg2.l1.m1.2.2" xref="alg2.l1.m1.2.2.cmml">𝐯</mi></mrow><annotation-xml encoding="MathML-Content" id="alg2.l1.m1.2b"><list id="alg2.l1.m1.2.3.1.cmml" xref="alg2.l1.m1.2.3.2"><ci id="alg2.l1.m1.1.1.cmml" xref="alg2.l1.m1.1.1">𝐰</ci><ci id="alg2.l1.m1.2.2.cmml" xref="alg2.l1.m1.2.2">𝐯</ci></list></annotation-xml><annotation encoding="application/x-tex" id="alg2.l1.m1.2c">\mathbf{w},\mathbf{v}</annotation></semantics></math> from the server

</div>
<div id="alg2.l2" class="ltx_listingline">
<math id="alg2.l2.m1.2" class="ltx_Math" alttext="\bm{\theta}\leftarrow\sigma\left((|\mathbf{w}|-\bm{\tau})/T\right)" display="inline"><semantics id="alg2.l2.m1.2a"><mrow id="alg2.l2.m1.2.2" xref="alg2.l2.m1.2.2.cmml"><mi id="alg2.l2.m1.2.2.3" xref="alg2.l2.m1.2.2.3.cmml">𝜽</mi><mo stretchy="false" id="alg2.l2.m1.2.2.2" xref="alg2.l2.m1.2.2.2.cmml">←</mo><mrow id="alg2.l2.m1.2.2.1" xref="alg2.l2.m1.2.2.1.cmml"><mi id="alg2.l2.m1.2.2.1.3" xref="alg2.l2.m1.2.2.1.3.cmml">σ</mi><mo lspace="0em" rspace="0em" id="alg2.l2.m1.2.2.1.2" xref="alg2.l2.m1.2.2.1.2.cmml">​</mo><mrow id="alg2.l2.m1.2.2.1.1.1" xref="alg2.l2.m1.2.2.1.1.1.1.cmml"><mo id="alg2.l2.m1.2.2.1.1.1.2" xref="alg2.l2.m1.2.2.1.1.1.1.cmml">(</mo><mrow id="alg2.l2.m1.2.2.1.1.1.1" xref="alg2.l2.m1.2.2.1.1.1.1.cmml"><mrow id="alg2.l2.m1.2.2.1.1.1.1.1.1" xref="alg2.l2.m1.2.2.1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="alg2.l2.m1.2.2.1.1.1.1.1.1.2" xref="alg2.l2.m1.2.2.1.1.1.1.1.1.1.cmml">(</mo><mrow id="alg2.l2.m1.2.2.1.1.1.1.1.1.1" xref="alg2.l2.m1.2.2.1.1.1.1.1.1.1.cmml"><mrow id="alg2.l2.m1.2.2.1.1.1.1.1.1.1.2.2" xref="alg2.l2.m1.2.2.1.1.1.1.1.1.1.2.1.cmml"><mo stretchy="false" id="alg2.l2.m1.2.2.1.1.1.1.1.1.1.2.2.1" xref="alg2.l2.m1.2.2.1.1.1.1.1.1.1.2.1.1.cmml">|</mo><mi id="alg2.l2.m1.1.1" xref="alg2.l2.m1.1.1.cmml">𝐰</mi><mo stretchy="false" id="alg2.l2.m1.2.2.1.1.1.1.1.1.1.2.2.2" xref="alg2.l2.m1.2.2.1.1.1.1.1.1.1.2.1.1.cmml">|</mo></mrow><mo id="alg2.l2.m1.2.2.1.1.1.1.1.1.1.1" xref="alg2.l2.m1.2.2.1.1.1.1.1.1.1.1.cmml">−</mo><mi id="alg2.l2.m1.2.2.1.1.1.1.1.1.1.3" xref="alg2.l2.m1.2.2.1.1.1.1.1.1.1.3.cmml">𝝉</mi></mrow><mo stretchy="false" id="alg2.l2.m1.2.2.1.1.1.1.1.1.3" xref="alg2.l2.m1.2.2.1.1.1.1.1.1.1.cmml">)</mo></mrow><mo id="alg2.l2.m1.2.2.1.1.1.1.2" xref="alg2.l2.m1.2.2.1.1.1.1.2.cmml">/</mo><mi id="alg2.l2.m1.2.2.1.1.1.1.3" xref="alg2.l2.m1.2.2.1.1.1.1.3.cmml">T</mi></mrow><mo id="alg2.l2.m1.2.2.1.1.1.3" xref="alg2.l2.m1.2.2.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg2.l2.m1.2b"><apply id="alg2.l2.m1.2.2.cmml" xref="alg2.l2.m1.2.2"><ci id="alg2.l2.m1.2.2.2.cmml" xref="alg2.l2.m1.2.2.2">←</ci><ci id="alg2.l2.m1.2.2.3.cmml" xref="alg2.l2.m1.2.2.3">𝜽</ci><apply id="alg2.l2.m1.2.2.1.cmml" xref="alg2.l2.m1.2.2.1"><times id="alg2.l2.m1.2.2.1.2.cmml" xref="alg2.l2.m1.2.2.1.2"></times><ci id="alg2.l2.m1.2.2.1.3.cmml" xref="alg2.l2.m1.2.2.1.3">𝜎</ci><apply id="alg2.l2.m1.2.2.1.1.1.1.cmml" xref="alg2.l2.m1.2.2.1.1.1"><divide id="alg2.l2.m1.2.2.1.1.1.1.2.cmml" xref="alg2.l2.m1.2.2.1.1.1.1.2"></divide><apply id="alg2.l2.m1.2.2.1.1.1.1.1.1.1.cmml" xref="alg2.l2.m1.2.2.1.1.1.1.1.1"><minus id="alg2.l2.m1.2.2.1.1.1.1.1.1.1.1.cmml" xref="alg2.l2.m1.2.2.1.1.1.1.1.1.1.1"></minus><apply id="alg2.l2.m1.2.2.1.1.1.1.1.1.1.2.1.cmml" xref="alg2.l2.m1.2.2.1.1.1.1.1.1.1.2.2"><abs id="alg2.l2.m1.2.2.1.1.1.1.1.1.1.2.1.1.cmml" xref="alg2.l2.m1.2.2.1.1.1.1.1.1.1.2.2.1"></abs><ci id="alg2.l2.m1.1.1.cmml" xref="alg2.l2.m1.1.1">𝐰</ci></apply><ci id="alg2.l2.m1.2.2.1.1.1.1.1.1.1.3.cmml" xref="alg2.l2.m1.2.2.1.1.1.1.1.1.1.3">𝝉</ci></apply><ci id="alg2.l2.m1.2.2.1.1.1.1.3.cmml" xref="alg2.l2.m1.2.2.1.1.1.1.3">𝑇</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.l2.m1.2c">\bm{\theta}\leftarrow\sigma\left((|\mathbf{w}|-\bm{\tau})/T\right)</annotation></semantics></math>

</div>
<div id="alg2.l3" class="ltx_listingline">
<math id="alg2.l3.m1.2" class="ltx_Math" alttext="\mathbf{w}_{s},\mathbf{v}_{s}\leftarrow\mathbf{w},\mathbf{v}" display="inline"><semantics id="alg2.l3.m1.2a"><mrow id="alg2.l3.m1.2.2.1" xref="alg2.l3.m1.2.2.2.cmml"><mrow id="alg2.l3.m1.2.2.1.1" xref="alg2.l3.m1.2.2.1.1.cmml"><mrow id="alg2.l3.m1.2.2.1.1.2.2" xref="alg2.l3.m1.2.2.1.1.2.3.cmml"><msub id="alg2.l3.m1.2.2.1.1.1.1.1" xref="alg2.l3.m1.2.2.1.1.1.1.1.cmml"><mi id="alg2.l3.m1.2.2.1.1.1.1.1.2" xref="alg2.l3.m1.2.2.1.1.1.1.1.2.cmml">𝐰</mi><mi id="alg2.l3.m1.2.2.1.1.1.1.1.3" xref="alg2.l3.m1.2.2.1.1.1.1.1.3.cmml">s</mi></msub><mo id="alg2.l3.m1.2.2.1.1.2.2.3" xref="alg2.l3.m1.2.2.1.1.2.3.cmml">,</mo><msub id="alg2.l3.m1.2.2.1.1.2.2.2" xref="alg2.l3.m1.2.2.1.1.2.2.2.cmml"><mi id="alg2.l3.m1.2.2.1.1.2.2.2.2" xref="alg2.l3.m1.2.2.1.1.2.2.2.2.cmml">𝐯</mi><mi id="alg2.l3.m1.2.2.1.1.2.2.2.3" xref="alg2.l3.m1.2.2.1.1.2.2.2.3.cmml">s</mi></msub></mrow><mo stretchy="false" id="alg2.l3.m1.2.2.1.1.3" xref="alg2.l3.m1.2.2.1.1.3.cmml">←</mo><mi id="alg2.l3.m1.2.2.1.1.4" xref="alg2.l3.m1.2.2.1.1.4.cmml">𝐰</mi></mrow><mo id="alg2.l3.m1.2.2.1.2" xref="alg2.l3.m1.2.2.2a.cmml">,</mo><mi id="alg2.l3.m1.1.1" xref="alg2.l3.m1.1.1.cmml">𝐯</mi></mrow><annotation-xml encoding="MathML-Content" id="alg2.l3.m1.2b"><apply id="alg2.l3.m1.2.2.2.cmml" xref="alg2.l3.m1.2.2.1"><csymbol cd="ambiguous" id="alg2.l3.m1.2.2.2a.cmml" xref="alg2.l3.m1.2.2.1.2">formulae-sequence</csymbol><apply id="alg2.l3.m1.2.2.1.1.cmml" xref="alg2.l3.m1.2.2.1.1"><ci id="alg2.l3.m1.2.2.1.1.3.cmml" xref="alg2.l3.m1.2.2.1.1.3">←</ci><list id="alg2.l3.m1.2.2.1.1.2.3.cmml" xref="alg2.l3.m1.2.2.1.1.2.2"><apply id="alg2.l3.m1.2.2.1.1.1.1.1.cmml" xref="alg2.l3.m1.2.2.1.1.1.1.1"><csymbol cd="ambiguous" id="alg2.l3.m1.2.2.1.1.1.1.1.1.cmml" xref="alg2.l3.m1.2.2.1.1.1.1.1">subscript</csymbol><ci id="alg2.l3.m1.2.2.1.1.1.1.1.2.cmml" xref="alg2.l3.m1.2.2.1.1.1.1.1.2">𝐰</ci><ci id="alg2.l3.m1.2.2.1.1.1.1.1.3.cmml" xref="alg2.l3.m1.2.2.1.1.1.1.1.3">𝑠</ci></apply><apply id="alg2.l3.m1.2.2.1.1.2.2.2.cmml" xref="alg2.l3.m1.2.2.1.1.2.2.2"><csymbol cd="ambiguous" id="alg2.l3.m1.2.2.1.1.2.2.2.1.cmml" xref="alg2.l3.m1.2.2.1.1.2.2.2">subscript</csymbol><ci id="alg2.l3.m1.2.2.1.1.2.2.2.2.cmml" xref="alg2.l3.m1.2.2.1.1.2.2.2.2">𝐯</ci><ci id="alg2.l3.m1.2.2.1.1.2.2.2.3.cmml" xref="alg2.l3.m1.2.2.1.1.2.2.2.3">𝑠</ci></apply></list><ci id="alg2.l3.m1.2.2.1.1.4.cmml" xref="alg2.l3.m1.2.2.1.1.4">𝐰</ci></apply><ci id="alg2.l3.m1.1.1.cmml" xref="alg2.l3.m1.1.1">𝐯</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.l3.m1.2c">\mathbf{w}_{s},\mathbf{v}_{s}\leftarrow\mathbf{w},\mathbf{v}</annotation></semantics></math>

</div>
<div id="alg2.l4" class="ltx_listingline">
<span id="alg2.l4.1" class="ltx_text ltx_font_bold">for</span> epoch <math id="alg2.l4.m1.1" class="ltx_Math" alttext="e" display="inline"><semantics id="alg2.l4.m1.1a"><mi id="alg2.l4.m1.1.1" xref="alg2.l4.m1.1.1.cmml">e</mi><annotation-xml encoding="MathML-Content" id="alg2.l4.m1.1b"><ci id="alg2.l4.m1.1.1.cmml" xref="alg2.l4.m1.1.1">𝑒</ci></annotation-xml><annotation encoding="application/x-tex" id="alg2.l4.m1.1c">e</annotation></semantics></math> in <math id="alg2.l4.m2.3" class="ltx_Math" alttext="1,\dots,E" display="inline"><semantics id="alg2.l4.m2.3a"><mrow id="alg2.l4.m2.3.4.2" xref="alg2.l4.m2.3.4.1.cmml"><mn id="alg2.l4.m2.1.1" xref="alg2.l4.m2.1.1.cmml">1</mn><mo id="alg2.l4.m2.3.4.2.1" xref="alg2.l4.m2.3.4.1.cmml">,</mo><mi mathvariant="normal" id="alg2.l4.m2.2.2" xref="alg2.l4.m2.2.2.cmml">…</mi><mo id="alg2.l4.m2.3.4.2.2" xref="alg2.l4.m2.3.4.1.cmml">,</mo><mi id="alg2.l4.m2.3.3" xref="alg2.l4.m2.3.3.cmml">E</mi></mrow><annotation-xml encoding="MathML-Content" id="alg2.l4.m2.3b"><list id="alg2.l4.m2.3.4.1.cmml" xref="alg2.l4.m2.3.4.2"><cn type="integer" id="alg2.l4.m2.1.1.cmml" xref="alg2.l4.m2.1.1">1</cn><ci id="alg2.l4.m2.2.2.cmml" xref="alg2.l4.m2.2.2">…</ci><ci id="alg2.l4.m2.3.3.cmml" xref="alg2.l4.m2.3.3">𝐸</ci></list></annotation-xml><annotation encoding="application/x-tex" id="alg2.l4.m2.3c">1,\dots,E</annotation></semantics></math> <span id="alg2.l4.2" class="ltx_text ltx_font_bold">do</span>

</div>
<div id="alg2.l5" class="ltx_listingline">     <span id="alg2.l5.1" class="ltx_text ltx_font_bold">for</span> batch <math id="alg2.l5.m1.1" class="ltx_Math" alttext="b\in B" display="inline"><semantics id="alg2.l5.m1.1a"><mrow id="alg2.l5.m1.1.1" xref="alg2.l5.m1.1.1.cmml"><mi id="alg2.l5.m1.1.1.2" xref="alg2.l5.m1.1.1.2.cmml">b</mi><mo id="alg2.l5.m1.1.1.1" xref="alg2.l5.m1.1.1.1.cmml">∈</mo><mi id="alg2.l5.m1.1.1.3" xref="alg2.l5.m1.1.1.3.cmml">B</mi></mrow><annotation-xml encoding="MathML-Content" id="alg2.l5.m1.1b"><apply id="alg2.l5.m1.1.1.cmml" xref="alg2.l5.m1.1.1"><in id="alg2.l5.m1.1.1.1.cmml" xref="alg2.l5.m1.1.1.1"></in><ci id="alg2.l5.m1.1.1.2.cmml" xref="alg2.l5.m1.1.1.2">𝑏</ci><ci id="alg2.l5.m1.1.1.3.cmml" xref="alg2.l5.m1.1.1.3">𝐵</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.l5.m1.1c">b\in B</annotation></semantics></math> <span id="alg2.l5.2" class="ltx_text ltx_font_bold">do</span>

</div>
<div id="alg2.l6" class="ltx_listingline">         <math id="alg2.l6.m1.3" class="ltx_Math" alttext="\bm{\tau}_{s}\leftarrow\log(1+\exp(\mathbf{v}_{s}))" display="inline"><semantics id="alg2.l6.m1.3a"><mrow id="alg2.l6.m1.3.3" xref="alg2.l6.m1.3.3.cmml"><msub id="alg2.l6.m1.3.3.3" xref="alg2.l6.m1.3.3.3.cmml"><mi id="alg2.l6.m1.3.3.3.2" xref="alg2.l6.m1.3.3.3.2.cmml">𝝉</mi><mi id="alg2.l6.m1.3.3.3.3" xref="alg2.l6.m1.3.3.3.3.cmml">s</mi></msub><mo stretchy="false" id="alg2.l6.m1.3.3.2" xref="alg2.l6.m1.3.3.2.cmml">←</mo><mrow id="alg2.l6.m1.3.3.1.1" xref="alg2.l6.m1.3.3.1.2.cmml"><mi id="alg2.l6.m1.2.2" xref="alg2.l6.m1.2.2.cmml">log</mi><mo id="alg2.l6.m1.3.3.1.1a" xref="alg2.l6.m1.3.3.1.2.cmml">⁡</mo><mrow id="alg2.l6.m1.3.3.1.1.1" xref="alg2.l6.m1.3.3.1.2.cmml"><mo stretchy="false" id="alg2.l6.m1.3.3.1.1.1.2" xref="alg2.l6.m1.3.3.1.2.cmml">(</mo><mrow id="alg2.l6.m1.3.3.1.1.1.1" xref="alg2.l6.m1.3.3.1.1.1.1.cmml"><mn id="alg2.l6.m1.3.3.1.1.1.1.3" xref="alg2.l6.m1.3.3.1.1.1.1.3.cmml">1</mn><mo id="alg2.l6.m1.3.3.1.1.1.1.2" xref="alg2.l6.m1.3.3.1.1.1.1.2.cmml">+</mo><mrow id="alg2.l6.m1.3.3.1.1.1.1.1.1" xref="alg2.l6.m1.3.3.1.1.1.1.1.2.cmml"><mi id="alg2.l6.m1.1.1" xref="alg2.l6.m1.1.1.cmml">exp</mi><mo id="alg2.l6.m1.3.3.1.1.1.1.1.1a" xref="alg2.l6.m1.3.3.1.1.1.1.1.2.cmml">⁡</mo><mrow id="alg2.l6.m1.3.3.1.1.1.1.1.1.1" xref="alg2.l6.m1.3.3.1.1.1.1.1.2.cmml"><mo stretchy="false" id="alg2.l6.m1.3.3.1.1.1.1.1.1.1.2" xref="alg2.l6.m1.3.3.1.1.1.1.1.2.cmml">(</mo><msub id="alg2.l6.m1.3.3.1.1.1.1.1.1.1.1" xref="alg2.l6.m1.3.3.1.1.1.1.1.1.1.1.cmml"><mi id="alg2.l6.m1.3.3.1.1.1.1.1.1.1.1.2" xref="alg2.l6.m1.3.3.1.1.1.1.1.1.1.1.2.cmml">𝐯</mi><mi id="alg2.l6.m1.3.3.1.1.1.1.1.1.1.1.3" xref="alg2.l6.m1.3.3.1.1.1.1.1.1.1.1.3.cmml">s</mi></msub><mo stretchy="false" id="alg2.l6.m1.3.3.1.1.1.1.1.1.1.3" xref="alg2.l6.m1.3.3.1.1.1.1.1.2.cmml">)</mo></mrow></mrow></mrow><mo stretchy="false" id="alg2.l6.m1.3.3.1.1.1.3" xref="alg2.l6.m1.3.3.1.2.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg2.l6.m1.3b"><apply id="alg2.l6.m1.3.3.cmml" xref="alg2.l6.m1.3.3"><ci id="alg2.l6.m1.3.3.2.cmml" xref="alg2.l6.m1.3.3.2">←</ci><apply id="alg2.l6.m1.3.3.3.cmml" xref="alg2.l6.m1.3.3.3"><csymbol cd="ambiguous" id="alg2.l6.m1.3.3.3.1.cmml" xref="alg2.l6.m1.3.3.3">subscript</csymbol><ci id="alg2.l6.m1.3.3.3.2.cmml" xref="alg2.l6.m1.3.3.3.2">𝝉</ci><ci id="alg2.l6.m1.3.3.3.3.cmml" xref="alg2.l6.m1.3.3.3.3">𝑠</ci></apply><apply id="alg2.l6.m1.3.3.1.2.cmml" xref="alg2.l6.m1.3.3.1.1"><log id="alg2.l6.m1.2.2.cmml" xref="alg2.l6.m1.2.2"></log><apply id="alg2.l6.m1.3.3.1.1.1.1.cmml" xref="alg2.l6.m1.3.3.1.1.1.1"><plus id="alg2.l6.m1.3.3.1.1.1.1.2.cmml" xref="alg2.l6.m1.3.3.1.1.1.1.2"></plus><cn type="integer" id="alg2.l6.m1.3.3.1.1.1.1.3.cmml" xref="alg2.l6.m1.3.3.1.1.1.1.3">1</cn><apply id="alg2.l6.m1.3.3.1.1.1.1.1.2.cmml" xref="alg2.l6.m1.3.3.1.1.1.1.1.1"><exp id="alg2.l6.m1.1.1.cmml" xref="alg2.l6.m1.1.1"></exp><apply id="alg2.l6.m1.3.3.1.1.1.1.1.1.1.1.cmml" xref="alg2.l6.m1.3.3.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="alg2.l6.m1.3.3.1.1.1.1.1.1.1.1.1.cmml" xref="alg2.l6.m1.3.3.1.1.1.1.1.1.1.1">subscript</csymbol><ci id="alg2.l6.m1.3.3.1.1.1.1.1.1.1.1.2.cmml" xref="alg2.l6.m1.3.3.1.1.1.1.1.1.1.1.2">𝐯</ci><ci id="alg2.l6.m1.3.3.1.1.1.1.1.1.1.1.3.cmml" xref="alg2.l6.m1.3.3.1.1.1.1.1.1.1.1.3">𝑠</ci></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.l6.m1.3c">\bm{\tau}_{s}\leftarrow\log(1+\exp(\mathbf{v}_{s}))</annotation></semantics></math>

</div>
<div id="alg2.l7" class="ltx_listingline">         <math id="alg2.l7.m1.1" class="ltx_Math" alttext="\bm{\pi}_{s}\leftarrow\sigma\left((|\mathbf{w}_{s}|-\bm{\tau}_{s})/T\right)" display="inline"><semantics id="alg2.l7.m1.1a"><mrow id="alg2.l7.m1.1.1" xref="alg2.l7.m1.1.1.cmml"><msub id="alg2.l7.m1.1.1.3" xref="alg2.l7.m1.1.1.3.cmml"><mi id="alg2.l7.m1.1.1.3.2" xref="alg2.l7.m1.1.1.3.2.cmml">𝝅</mi><mi id="alg2.l7.m1.1.1.3.3" xref="alg2.l7.m1.1.1.3.3.cmml">s</mi></msub><mo stretchy="false" id="alg2.l7.m1.1.1.2" xref="alg2.l7.m1.1.1.2.cmml">←</mo><mrow id="alg2.l7.m1.1.1.1" xref="alg2.l7.m1.1.1.1.cmml"><mi id="alg2.l7.m1.1.1.1.3" xref="alg2.l7.m1.1.1.1.3.cmml">σ</mi><mo lspace="0em" rspace="0em" id="alg2.l7.m1.1.1.1.2" xref="alg2.l7.m1.1.1.1.2.cmml">​</mo><mrow id="alg2.l7.m1.1.1.1.1.1" xref="alg2.l7.m1.1.1.1.1.1.1.cmml"><mo id="alg2.l7.m1.1.1.1.1.1.2" xref="alg2.l7.m1.1.1.1.1.1.1.cmml">(</mo><mrow id="alg2.l7.m1.1.1.1.1.1.1" xref="alg2.l7.m1.1.1.1.1.1.1.cmml"><mrow id="alg2.l7.m1.1.1.1.1.1.1.1.1" xref="alg2.l7.m1.1.1.1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="alg2.l7.m1.1.1.1.1.1.1.1.1.2" xref="alg2.l7.m1.1.1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="alg2.l7.m1.1.1.1.1.1.1.1.1.1" xref="alg2.l7.m1.1.1.1.1.1.1.1.1.1.cmml"><mrow id="alg2.l7.m1.1.1.1.1.1.1.1.1.1.1.1" xref="alg2.l7.m1.1.1.1.1.1.1.1.1.1.1.2.cmml"><mo stretchy="false" id="alg2.l7.m1.1.1.1.1.1.1.1.1.1.1.1.2" xref="alg2.l7.m1.1.1.1.1.1.1.1.1.1.1.2.1.cmml">|</mo><msub id="alg2.l7.m1.1.1.1.1.1.1.1.1.1.1.1.1" xref="alg2.l7.m1.1.1.1.1.1.1.1.1.1.1.1.1.cmml"><mi id="alg2.l7.m1.1.1.1.1.1.1.1.1.1.1.1.1.2" xref="alg2.l7.m1.1.1.1.1.1.1.1.1.1.1.1.1.2.cmml">𝐰</mi><mi id="alg2.l7.m1.1.1.1.1.1.1.1.1.1.1.1.1.3" xref="alg2.l7.m1.1.1.1.1.1.1.1.1.1.1.1.1.3.cmml">s</mi></msub><mo stretchy="false" id="alg2.l7.m1.1.1.1.1.1.1.1.1.1.1.1.3" xref="alg2.l7.m1.1.1.1.1.1.1.1.1.1.1.2.1.cmml">|</mo></mrow><mo id="alg2.l7.m1.1.1.1.1.1.1.1.1.1.2" xref="alg2.l7.m1.1.1.1.1.1.1.1.1.1.2.cmml">−</mo><msub id="alg2.l7.m1.1.1.1.1.1.1.1.1.1.3" xref="alg2.l7.m1.1.1.1.1.1.1.1.1.1.3.cmml"><mi id="alg2.l7.m1.1.1.1.1.1.1.1.1.1.3.2" xref="alg2.l7.m1.1.1.1.1.1.1.1.1.1.3.2.cmml">𝝉</mi><mi id="alg2.l7.m1.1.1.1.1.1.1.1.1.1.3.3" xref="alg2.l7.m1.1.1.1.1.1.1.1.1.1.3.3.cmml">s</mi></msub></mrow><mo stretchy="false" id="alg2.l7.m1.1.1.1.1.1.1.1.1.3" xref="alg2.l7.m1.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow><mo id="alg2.l7.m1.1.1.1.1.1.1.2" xref="alg2.l7.m1.1.1.1.1.1.1.2.cmml">/</mo><mi id="alg2.l7.m1.1.1.1.1.1.1.3" xref="alg2.l7.m1.1.1.1.1.1.1.3.cmml">T</mi></mrow><mo id="alg2.l7.m1.1.1.1.1.1.3" xref="alg2.l7.m1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg2.l7.m1.1b"><apply id="alg2.l7.m1.1.1.cmml" xref="alg2.l7.m1.1.1"><ci id="alg2.l7.m1.1.1.2.cmml" xref="alg2.l7.m1.1.1.2">←</ci><apply id="alg2.l7.m1.1.1.3.cmml" xref="alg2.l7.m1.1.1.3"><csymbol cd="ambiguous" id="alg2.l7.m1.1.1.3.1.cmml" xref="alg2.l7.m1.1.1.3">subscript</csymbol><ci id="alg2.l7.m1.1.1.3.2.cmml" xref="alg2.l7.m1.1.1.3.2">𝝅</ci><ci id="alg2.l7.m1.1.1.3.3.cmml" xref="alg2.l7.m1.1.1.3.3">𝑠</ci></apply><apply id="alg2.l7.m1.1.1.1.cmml" xref="alg2.l7.m1.1.1.1"><times id="alg2.l7.m1.1.1.1.2.cmml" xref="alg2.l7.m1.1.1.1.2"></times><ci id="alg2.l7.m1.1.1.1.3.cmml" xref="alg2.l7.m1.1.1.1.3">𝜎</ci><apply id="alg2.l7.m1.1.1.1.1.1.1.cmml" xref="alg2.l7.m1.1.1.1.1.1"><divide id="alg2.l7.m1.1.1.1.1.1.1.2.cmml" xref="alg2.l7.m1.1.1.1.1.1.1.2"></divide><apply id="alg2.l7.m1.1.1.1.1.1.1.1.1.1.cmml" xref="alg2.l7.m1.1.1.1.1.1.1.1.1"><minus id="alg2.l7.m1.1.1.1.1.1.1.1.1.1.2.cmml" xref="alg2.l7.m1.1.1.1.1.1.1.1.1.1.2"></minus><apply id="alg2.l7.m1.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="alg2.l7.m1.1.1.1.1.1.1.1.1.1.1.1"><abs id="alg2.l7.m1.1.1.1.1.1.1.1.1.1.1.2.1.cmml" xref="alg2.l7.m1.1.1.1.1.1.1.1.1.1.1.1.2"></abs><apply id="alg2.l7.m1.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="alg2.l7.m1.1.1.1.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="alg2.l7.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="alg2.l7.m1.1.1.1.1.1.1.1.1.1.1.1.1">subscript</csymbol><ci id="alg2.l7.m1.1.1.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="alg2.l7.m1.1.1.1.1.1.1.1.1.1.1.1.1.2">𝐰</ci><ci id="alg2.l7.m1.1.1.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="alg2.l7.m1.1.1.1.1.1.1.1.1.1.1.1.1.3">𝑠</ci></apply></apply><apply id="alg2.l7.m1.1.1.1.1.1.1.1.1.1.3.cmml" xref="alg2.l7.m1.1.1.1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="alg2.l7.m1.1.1.1.1.1.1.1.1.1.3.1.cmml" xref="alg2.l7.m1.1.1.1.1.1.1.1.1.1.3">subscript</csymbol><ci id="alg2.l7.m1.1.1.1.1.1.1.1.1.1.3.2.cmml" xref="alg2.l7.m1.1.1.1.1.1.1.1.1.1.3.2">𝝉</ci><ci id="alg2.l7.m1.1.1.1.1.1.1.1.1.1.3.3.cmml" xref="alg2.l7.m1.1.1.1.1.1.1.1.1.1.3.3">𝑠</ci></apply></apply><ci id="alg2.l7.m1.1.1.1.1.1.1.3.cmml" xref="alg2.l7.m1.1.1.1.1.1.1.3">𝑇</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.l7.m1.1c">\bm{\pi}_{s}\leftarrow\sigma\left((|\mathbf{w}_{s}|-\bm{\tau}_{s})/T\right)</annotation></semantics></math>

</div>
<div id="alg2.l8" class="ltx_listingline">         <math id="alg2.l8.m1.5" class="ltx_Math" alttext="L_{s}\leftarrow\mathcal{L}_{s}(b,\mathbf{w},\bm{\theta},\mathbf{w}_{s},\bm{\pi}_{s})" display="inline"><semantics id="alg2.l8.m1.5a"><mrow id="alg2.l8.m1.5.5" xref="alg2.l8.m1.5.5.cmml"><msub id="alg2.l8.m1.5.5.4" xref="alg2.l8.m1.5.5.4.cmml"><mi id="alg2.l8.m1.5.5.4.2" xref="alg2.l8.m1.5.5.4.2.cmml">L</mi><mi id="alg2.l8.m1.5.5.4.3" xref="alg2.l8.m1.5.5.4.3.cmml">s</mi></msub><mo stretchy="false" id="alg2.l8.m1.5.5.3" xref="alg2.l8.m1.5.5.3.cmml">←</mo><mrow id="alg2.l8.m1.5.5.2" xref="alg2.l8.m1.5.5.2.cmml"><msub id="alg2.l8.m1.5.5.2.4" xref="alg2.l8.m1.5.5.2.4.cmml"><mi class="ltx_font_mathcaligraphic" id="alg2.l8.m1.5.5.2.4.2" xref="alg2.l8.m1.5.5.2.4.2.cmml">ℒ</mi><mi id="alg2.l8.m1.5.5.2.4.3" xref="alg2.l8.m1.5.5.2.4.3.cmml">s</mi></msub><mo lspace="0em" rspace="0em" id="alg2.l8.m1.5.5.2.3" xref="alg2.l8.m1.5.5.2.3.cmml">​</mo><mrow id="alg2.l8.m1.5.5.2.2.2" xref="alg2.l8.m1.5.5.2.2.3.cmml"><mo stretchy="false" id="alg2.l8.m1.5.5.2.2.2.3" xref="alg2.l8.m1.5.5.2.2.3.cmml">(</mo><mi id="alg2.l8.m1.1.1" xref="alg2.l8.m1.1.1.cmml">b</mi><mo id="alg2.l8.m1.5.5.2.2.2.4" xref="alg2.l8.m1.5.5.2.2.3.cmml">,</mo><mi id="alg2.l8.m1.2.2" xref="alg2.l8.m1.2.2.cmml">𝐰</mi><mo id="alg2.l8.m1.5.5.2.2.2.5" xref="alg2.l8.m1.5.5.2.2.3.cmml">,</mo><mi id="alg2.l8.m1.3.3" xref="alg2.l8.m1.3.3.cmml">𝜽</mi><mo id="alg2.l8.m1.5.5.2.2.2.6" xref="alg2.l8.m1.5.5.2.2.3.cmml">,</mo><msub id="alg2.l8.m1.4.4.1.1.1.1" xref="alg2.l8.m1.4.4.1.1.1.1.cmml"><mi id="alg2.l8.m1.4.4.1.1.1.1.2" xref="alg2.l8.m1.4.4.1.1.1.1.2.cmml">𝐰</mi><mi id="alg2.l8.m1.4.4.1.1.1.1.3" xref="alg2.l8.m1.4.4.1.1.1.1.3.cmml">s</mi></msub><mo id="alg2.l8.m1.5.5.2.2.2.7" xref="alg2.l8.m1.5.5.2.2.3.cmml">,</mo><msub id="alg2.l8.m1.5.5.2.2.2.2" xref="alg2.l8.m1.5.5.2.2.2.2.cmml"><mi id="alg2.l8.m1.5.5.2.2.2.2.2" xref="alg2.l8.m1.5.5.2.2.2.2.2.cmml">𝝅</mi><mi id="alg2.l8.m1.5.5.2.2.2.2.3" xref="alg2.l8.m1.5.5.2.2.2.2.3.cmml">s</mi></msub><mo stretchy="false" id="alg2.l8.m1.5.5.2.2.2.8" xref="alg2.l8.m1.5.5.2.2.3.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg2.l8.m1.5b"><apply id="alg2.l8.m1.5.5.cmml" xref="alg2.l8.m1.5.5"><ci id="alg2.l8.m1.5.5.3.cmml" xref="alg2.l8.m1.5.5.3">←</ci><apply id="alg2.l8.m1.5.5.4.cmml" xref="alg2.l8.m1.5.5.4"><csymbol cd="ambiguous" id="alg2.l8.m1.5.5.4.1.cmml" xref="alg2.l8.m1.5.5.4">subscript</csymbol><ci id="alg2.l8.m1.5.5.4.2.cmml" xref="alg2.l8.m1.5.5.4.2">𝐿</ci><ci id="alg2.l8.m1.5.5.4.3.cmml" xref="alg2.l8.m1.5.5.4.3">𝑠</ci></apply><apply id="alg2.l8.m1.5.5.2.cmml" xref="alg2.l8.m1.5.5.2"><times id="alg2.l8.m1.5.5.2.3.cmml" xref="alg2.l8.m1.5.5.2.3"></times><apply id="alg2.l8.m1.5.5.2.4.cmml" xref="alg2.l8.m1.5.5.2.4"><csymbol cd="ambiguous" id="alg2.l8.m1.5.5.2.4.1.cmml" xref="alg2.l8.m1.5.5.2.4">subscript</csymbol><ci id="alg2.l8.m1.5.5.2.4.2.cmml" xref="alg2.l8.m1.5.5.2.4.2">ℒ</ci><ci id="alg2.l8.m1.5.5.2.4.3.cmml" xref="alg2.l8.m1.5.5.2.4.3">𝑠</ci></apply><vector id="alg2.l8.m1.5.5.2.2.3.cmml" xref="alg2.l8.m1.5.5.2.2.2"><ci id="alg2.l8.m1.1.1.cmml" xref="alg2.l8.m1.1.1">𝑏</ci><ci id="alg2.l8.m1.2.2.cmml" xref="alg2.l8.m1.2.2">𝐰</ci><ci id="alg2.l8.m1.3.3.cmml" xref="alg2.l8.m1.3.3">𝜽</ci><apply id="alg2.l8.m1.4.4.1.1.1.1.cmml" xref="alg2.l8.m1.4.4.1.1.1.1"><csymbol cd="ambiguous" id="alg2.l8.m1.4.4.1.1.1.1.1.cmml" xref="alg2.l8.m1.4.4.1.1.1.1">subscript</csymbol><ci id="alg2.l8.m1.4.4.1.1.1.1.2.cmml" xref="alg2.l8.m1.4.4.1.1.1.1.2">𝐰</ci><ci id="alg2.l8.m1.4.4.1.1.1.1.3.cmml" xref="alg2.l8.m1.4.4.1.1.1.1.3">𝑠</ci></apply><apply id="alg2.l8.m1.5.5.2.2.2.2.cmml" xref="alg2.l8.m1.5.5.2.2.2.2"><csymbol cd="ambiguous" id="alg2.l8.m1.5.5.2.2.2.2.1.cmml" xref="alg2.l8.m1.5.5.2.2.2.2">subscript</csymbol><ci id="alg2.l8.m1.5.5.2.2.2.2.2.cmml" xref="alg2.l8.m1.5.5.2.2.2.2.2">𝝅</ci><ci id="alg2.l8.m1.5.5.2.2.2.2.3.cmml" xref="alg2.l8.m1.5.5.2.2.2.2.3">𝑠</ci></apply></vector></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.l8.m1.5c">L_{s}\leftarrow\mathcal{L}_{s}(b,\mathbf{w},\bm{\theta},\mathbf{w}_{s},\bm{\pi}_{s})</annotation></semantics></math>

</div>
<div id="alg2.l9" class="ltx_listingline">         <math id="alg2.l9.m1.1" class="ltx_Math" alttext="\mathbf{w}_{s}\leftarrow" display="inline"><semantics id="alg2.l9.m1.1a"><mrow id="alg2.l9.m1.1.1" xref="alg2.l9.m1.1.1.cmml"><msub id="alg2.l9.m1.1.1.2" xref="alg2.l9.m1.1.1.2.cmml"><mi id="alg2.l9.m1.1.1.2.2" xref="alg2.l9.m1.1.1.2.2.cmml">𝐰</mi><mi id="alg2.l9.m1.1.1.2.3" xref="alg2.l9.m1.1.1.2.3.cmml">s</mi></msub><mo stretchy="false" id="alg2.l9.m1.1.1.1" xref="alg2.l9.m1.1.1.1.cmml">←</mo><mi id="alg2.l9.m1.1.1.3" xref="alg2.l9.m1.1.1.3.cmml"></mi></mrow><annotation-xml encoding="MathML-Content" id="alg2.l9.m1.1b"><apply id="alg2.l9.m1.1.1.cmml" xref="alg2.l9.m1.1.1"><ci id="alg2.l9.m1.1.1.1.cmml" xref="alg2.l9.m1.1.1.1">←</ci><apply id="alg2.l9.m1.1.1.2.cmml" xref="alg2.l9.m1.1.1.2"><csymbol cd="ambiguous" id="alg2.l9.m1.1.1.2.1.cmml" xref="alg2.l9.m1.1.1.2">subscript</csymbol><ci id="alg2.l9.m1.1.1.2.2.cmml" xref="alg2.l9.m1.1.1.2.2">𝐰</ci><ci id="alg2.l9.m1.1.1.2.3.cmml" xref="alg2.l9.m1.1.1.2.3">𝑠</ci></apply><csymbol cd="latexml" id="alg2.l9.m1.1.1.3.cmml" xref="alg2.l9.m1.1.1.3">absent</csymbol></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.l9.m1.1c">\mathbf{w}_{s}\leftarrow</annotation></semantics></math> <span id="alg2.l9.1" class="ltx_text ltx_font_smallcaps">SGD</span>(<math id="alg2.l9.m2.1" class="ltx_Math" alttext="\nabla_{\mathbf{w}_{s}}L_{s}" display="inline"><semantics id="alg2.l9.m2.1a"><mrow id="alg2.l9.m2.1.1" xref="alg2.l9.m2.1.1.cmml"><msub id="alg2.l9.m2.1.1.1" xref="alg2.l9.m2.1.1.1.cmml"><mo id="alg2.l9.m2.1.1.1.2" xref="alg2.l9.m2.1.1.1.2.cmml">∇</mo><msub id="alg2.l9.m2.1.1.1.3" xref="alg2.l9.m2.1.1.1.3.cmml"><mi id="alg2.l9.m2.1.1.1.3.2" xref="alg2.l9.m2.1.1.1.3.2.cmml">𝐰</mi><mi id="alg2.l9.m2.1.1.1.3.3" xref="alg2.l9.m2.1.1.1.3.3.cmml">s</mi></msub></msub><msub id="alg2.l9.m2.1.1.2" xref="alg2.l9.m2.1.1.2.cmml"><mi id="alg2.l9.m2.1.1.2.2" xref="alg2.l9.m2.1.1.2.2.cmml">L</mi><mi id="alg2.l9.m2.1.1.2.3" xref="alg2.l9.m2.1.1.2.3.cmml">s</mi></msub></mrow><annotation-xml encoding="MathML-Content" id="alg2.l9.m2.1b"><apply id="alg2.l9.m2.1.1.cmml" xref="alg2.l9.m2.1.1"><apply id="alg2.l9.m2.1.1.1.cmml" xref="alg2.l9.m2.1.1.1"><csymbol cd="ambiguous" id="alg2.l9.m2.1.1.1.1.cmml" xref="alg2.l9.m2.1.1.1">subscript</csymbol><ci id="alg2.l9.m2.1.1.1.2.cmml" xref="alg2.l9.m2.1.1.1.2">∇</ci><apply id="alg2.l9.m2.1.1.1.3.cmml" xref="alg2.l9.m2.1.1.1.3"><csymbol cd="ambiguous" id="alg2.l9.m2.1.1.1.3.1.cmml" xref="alg2.l9.m2.1.1.1.3">subscript</csymbol><ci id="alg2.l9.m2.1.1.1.3.2.cmml" xref="alg2.l9.m2.1.1.1.3.2">𝐰</ci><ci id="alg2.l9.m2.1.1.1.3.3.cmml" xref="alg2.l9.m2.1.1.1.3.3">𝑠</ci></apply></apply><apply id="alg2.l9.m2.1.1.2.cmml" xref="alg2.l9.m2.1.1.2"><csymbol cd="ambiguous" id="alg2.l9.m2.1.1.2.1.cmml" xref="alg2.l9.m2.1.1.2">subscript</csymbol><ci id="alg2.l9.m2.1.1.2.2.cmml" xref="alg2.l9.m2.1.1.2.2">𝐿</ci><ci id="alg2.l9.m2.1.1.2.3.cmml" xref="alg2.l9.m2.1.1.2.3">𝑠</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.l9.m2.1c">\nabla_{\mathbf{w}_{s}}L_{s}</annotation></semantics></math>)

</div>
<div id="alg2.l10" class="ltx_listingline">         <math id="alg2.l10.m1.1" class="ltx_Math" alttext="\mathbf{v}_{s}\leftarrow" display="inline"><semantics id="alg2.l10.m1.1a"><mrow id="alg2.l10.m1.1.1" xref="alg2.l10.m1.1.1.cmml"><msub id="alg2.l10.m1.1.1.2" xref="alg2.l10.m1.1.1.2.cmml"><mi id="alg2.l10.m1.1.1.2.2" xref="alg2.l10.m1.1.1.2.2.cmml">𝐯</mi><mi id="alg2.l10.m1.1.1.2.3" xref="alg2.l10.m1.1.1.2.3.cmml">s</mi></msub><mo stretchy="false" id="alg2.l10.m1.1.1.1" xref="alg2.l10.m1.1.1.1.cmml">←</mo><mi id="alg2.l10.m1.1.1.3" xref="alg2.l10.m1.1.1.3.cmml"></mi></mrow><annotation-xml encoding="MathML-Content" id="alg2.l10.m1.1b"><apply id="alg2.l10.m1.1.1.cmml" xref="alg2.l10.m1.1.1"><ci id="alg2.l10.m1.1.1.1.cmml" xref="alg2.l10.m1.1.1.1">←</ci><apply id="alg2.l10.m1.1.1.2.cmml" xref="alg2.l10.m1.1.1.2"><csymbol cd="ambiguous" id="alg2.l10.m1.1.1.2.1.cmml" xref="alg2.l10.m1.1.1.2">subscript</csymbol><ci id="alg2.l10.m1.1.1.2.2.cmml" xref="alg2.l10.m1.1.1.2.2">𝐯</ci><ci id="alg2.l10.m1.1.1.2.3.cmml" xref="alg2.l10.m1.1.1.2.3">𝑠</ci></apply><csymbol cd="latexml" id="alg2.l10.m1.1.1.3.cmml" xref="alg2.l10.m1.1.1.3">absent</csymbol></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.l10.m1.1c">\mathbf{v}_{s}\leftarrow</annotation></semantics></math> <span id="alg2.l10.1" class="ltx_text ltx_font_smallcaps">Adamax</span>(<math id="alg2.l10.m2.1" class="ltx_Math" alttext="\nabla_{\mathbf{v}_{s}}L_{s}" display="inline"><semantics id="alg2.l10.m2.1a"><mrow id="alg2.l10.m2.1.1" xref="alg2.l10.m2.1.1.cmml"><msub id="alg2.l10.m2.1.1.1" xref="alg2.l10.m2.1.1.1.cmml"><mo id="alg2.l10.m2.1.1.1.2" xref="alg2.l10.m2.1.1.1.2.cmml">∇</mo><msub id="alg2.l10.m2.1.1.1.3" xref="alg2.l10.m2.1.1.1.3.cmml"><mi id="alg2.l10.m2.1.1.1.3.2" xref="alg2.l10.m2.1.1.1.3.2.cmml">𝐯</mi><mi id="alg2.l10.m2.1.1.1.3.3" xref="alg2.l10.m2.1.1.1.3.3.cmml">s</mi></msub></msub><msub id="alg2.l10.m2.1.1.2" xref="alg2.l10.m2.1.1.2.cmml"><mi id="alg2.l10.m2.1.1.2.2" xref="alg2.l10.m2.1.1.2.2.cmml">L</mi><mi id="alg2.l10.m2.1.1.2.3" xref="alg2.l10.m2.1.1.2.3.cmml">s</mi></msub></mrow><annotation-xml encoding="MathML-Content" id="alg2.l10.m2.1b"><apply id="alg2.l10.m2.1.1.cmml" xref="alg2.l10.m2.1.1"><apply id="alg2.l10.m2.1.1.1.cmml" xref="alg2.l10.m2.1.1.1"><csymbol cd="ambiguous" id="alg2.l10.m2.1.1.1.1.cmml" xref="alg2.l10.m2.1.1.1">subscript</csymbol><ci id="alg2.l10.m2.1.1.1.2.cmml" xref="alg2.l10.m2.1.1.1.2">∇</ci><apply id="alg2.l10.m2.1.1.1.3.cmml" xref="alg2.l10.m2.1.1.1.3"><csymbol cd="ambiguous" id="alg2.l10.m2.1.1.1.3.1.cmml" xref="alg2.l10.m2.1.1.1.3">subscript</csymbol><ci id="alg2.l10.m2.1.1.1.3.2.cmml" xref="alg2.l10.m2.1.1.1.3.2">𝐯</ci><ci id="alg2.l10.m2.1.1.1.3.3.cmml" xref="alg2.l10.m2.1.1.1.3.3">𝑠</ci></apply></apply><apply id="alg2.l10.m2.1.1.2.cmml" xref="alg2.l10.m2.1.1.2"><csymbol cd="ambiguous" id="alg2.l10.m2.1.1.2.1.cmml" xref="alg2.l10.m2.1.1.2">subscript</csymbol><ci id="alg2.l10.m2.1.1.2.2.cmml" xref="alg2.l10.m2.1.1.2.2">𝐿</ci><ci id="alg2.l10.m2.1.1.2.3.cmml" xref="alg2.l10.m2.1.1.2.3">𝑠</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.l10.m2.1c">\nabla_{\mathbf{v}_{s}}L_{s}</annotation></semantics></math>)

</div>
<div id="alg2.l11" class="ltx_listingline">     <span id="alg2.l11.1" class="ltx_text ltx_font_bold">end</span> <span id="alg2.l11.2" class="ltx_text ltx_font_bold">for</span>
</div>
<div id="alg2.l12" class="ltx_listingline">
<span id="alg2.l12.1" class="ltx_text ltx_font_bold">end</span> <span id="alg2.l12.2" class="ltx_text ltx_font_bold">for</span>
</div>
<div id="alg2.l13" class="ltx_listingline">
<math id="alg2.l13.m1.1" class="ltx_Math" alttext="\bm{\pi}_{s}\leftarrow\sigma\left((|\mathbf{w}_{s}|-\bm{\tau}_{s})/T\right)" display="inline"><semantics id="alg2.l13.m1.1a"><mrow id="alg2.l13.m1.1.1" xref="alg2.l13.m1.1.1.cmml"><msub id="alg2.l13.m1.1.1.3" xref="alg2.l13.m1.1.1.3.cmml"><mi id="alg2.l13.m1.1.1.3.2" xref="alg2.l13.m1.1.1.3.2.cmml">𝝅</mi><mi id="alg2.l13.m1.1.1.3.3" xref="alg2.l13.m1.1.1.3.3.cmml">s</mi></msub><mo stretchy="false" id="alg2.l13.m1.1.1.2" xref="alg2.l13.m1.1.1.2.cmml">←</mo><mrow id="alg2.l13.m1.1.1.1" xref="alg2.l13.m1.1.1.1.cmml"><mi id="alg2.l13.m1.1.1.1.3" xref="alg2.l13.m1.1.1.1.3.cmml">σ</mi><mo lspace="0em" rspace="0em" id="alg2.l13.m1.1.1.1.2" xref="alg2.l13.m1.1.1.1.2.cmml">​</mo><mrow id="alg2.l13.m1.1.1.1.1.1" xref="alg2.l13.m1.1.1.1.1.1.1.cmml"><mo id="alg2.l13.m1.1.1.1.1.1.2" xref="alg2.l13.m1.1.1.1.1.1.1.cmml">(</mo><mrow id="alg2.l13.m1.1.1.1.1.1.1" xref="alg2.l13.m1.1.1.1.1.1.1.cmml"><mrow id="alg2.l13.m1.1.1.1.1.1.1.1.1" xref="alg2.l13.m1.1.1.1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="alg2.l13.m1.1.1.1.1.1.1.1.1.2" xref="alg2.l13.m1.1.1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="alg2.l13.m1.1.1.1.1.1.1.1.1.1" xref="alg2.l13.m1.1.1.1.1.1.1.1.1.1.cmml"><mrow id="alg2.l13.m1.1.1.1.1.1.1.1.1.1.1.1" xref="alg2.l13.m1.1.1.1.1.1.1.1.1.1.1.2.cmml"><mo stretchy="false" id="alg2.l13.m1.1.1.1.1.1.1.1.1.1.1.1.2" xref="alg2.l13.m1.1.1.1.1.1.1.1.1.1.1.2.1.cmml">|</mo><msub id="alg2.l13.m1.1.1.1.1.1.1.1.1.1.1.1.1" xref="alg2.l13.m1.1.1.1.1.1.1.1.1.1.1.1.1.cmml"><mi id="alg2.l13.m1.1.1.1.1.1.1.1.1.1.1.1.1.2" xref="alg2.l13.m1.1.1.1.1.1.1.1.1.1.1.1.1.2.cmml">𝐰</mi><mi id="alg2.l13.m1.1.1.1.1.1.1.1.1.1.1.1.1.3" xref="alg2.l13.m1.1.1.1.1.1.1.1.1.1.1.1.1.3.cmml">s</mi></msub><mo stretchy="false" id="alg2.l13.m1.1.1.1.1.1.1.1.1.1.1.1.3" xref="alg2.l13.m1.1.1.1.1.1.1.1.1.1.1.2.1.cmml">|</mo></mrow><mo id="alg2.l13.m1.1.1.1.1.1.1.1.1.1.2" xref="alg2.l13.m1.1.1.1.1.1.1.1.1.1.2.cmml">−</mo><msub id="alg2.l13.m1.1.1.1.1.1.1.1.1.1.3" xref="alg2.l13.m1.1.1.1.1.1.1.1.1.1.3.cmml"><mi id="alg2.l13.m1.1.1.1.1.1.1.1.1.1.3.2" xref="alg2.l13.m1.1.1.1.1.1.1.1.1.1.3.2.cmml">𝝉</mi><mi id="alg2.l13.m1.1.1.1.1.1.1.1.1.1.3.3" xref="alg2.l13.m1.1.1.1.1.1.1.1.1.1.3.3.cmml">s</mi></msub></mrow><mo stretchy="false" id="alg2.l13.m1.1.1.1.1.1.1.1.1.3" xref="alg2.l13.m1.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow><mo id="alg2.l13.m1.1.1.1.1.1.1.2" xref="alg2.l13.m1.1.1.1.1.1.1.2.cmml">/</mo><mi id="alg2.l13.m1.1.1.1.1.1.1.3" xref="alg2.l13.m1.1.1.1.1.1.1.3.cmml">T</mi></mrow><mo id="alg2.l13.m1.1.1.1.1.1.3" xref="alg2.l13.m1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg2.l13.m1.1b"><apply id="alg2.l13.m1.1.1.cmml" xref="alg2.l13.m1.1.1"><ci id="alg2.l13.m1.1.1.2.cmml" xref="alg2.l13.m1.1.1.2">←</ci><apply id="alg2.l13.m1.1.1.3.cmml" xref="alg2.l13.m1.1.1.3"><csymbol cd="ambiguous" id="alg2.l13.m1.1.1.3.1.cmml" xref="alg2.l13.m1.1.1.3">subscript</csymbol><ci id="alg2.l13.m1.1.1.3.2.cmml" xref="alg2.l13.m1.1.1.3.2">𝝅</ci><ci id="alg2.l13.m1.1.1.3.3.cmml" xref="alg2.l13.m1.1.1.3.3">𝑠</ci></apply><apply id="alg2.l13.m1.1.1.1.cmml" xref="alg2.l13.m1.1.1.1"><times id="alg2.l13.m1.1.1.1.2.cmml" xref="alg2.l13.m1.1.1.1.2"></times><ci id="alg2.l13.m1.1.1.1.3.cmml" xref="alg2.l13.m1.1.1.1.3">𝜎</ci><apply id="alg2.l13.m1.1.1.1.1.1.1.cmml" xref="alg2.l13.m1.1.1.1.1.1"><divide id="alg2.l13.m1.1.1.1.1.1.1.2.cmml" xref="alg2.l13.m1.1.1.1.1.1.1.2"></divide><apply id="alg2.l13.m1.1.1.1.1.1.1.1.1.1.cmml" xref="alg2.l13.m1.1.1.1.1.1.1.1.1"><minus id="alg2.l13.m1.1.1.1.1.1.1.1.1.1.2.cmml" xref="alg2.l13.m1.1.1.1.1.1.1.1.1.1.2"></minus><apply id="alg2.l13.m1.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="alg2.l13.m1.1.1.1.1.1.1.1.1.1.1.1"><abs id="alg2.l13.m1.1.1.1.1.1.1.1.1.1.1.2.1.cmml" xref="alg2.l13.m1.1.1.1.1.1.1.1.1.1.1.1.2"></abs><apply id="alg2.l13.m1.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="alg2.l13.m1.1.1.1.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="alg2.l13.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="alg2.l13.m1.1.1.1.1.1.1.1.1.1.1.1.1">subscript</csymbol><ci id="alg2.l13.m1.1.1.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="alg2.l13.m1.1.1.1.1.1.1.1.1.1.1.1.1.2">𝐰</ci><ci id="alg2.l13.m1.1.1.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="alg2.l13.m1.1.1.1.1.1.1.1.1.1.1.1.1.3">𝑠</ci></apply></apply><apply id="alg2.l13.m1.1.1.1.1.1.1.1.1.1.3.cmml" xref="alg2.l13.m1.1.1.1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="alg2.l13.m1.1.1.1.1.1.1.1.1.1.3.1.cmml" xref="alg2.l13.m1.1.1.1.1.1.1.1.1.1.3">subscript</csymbol><ci id="alg2.l13.m1.1.1.1.1.1.1.1.1.1.3.2.cmml" xref="alg2.l13.m1.1.1.1.1.1.1.1.1.1.3.2">𝝉</ci><ci id="alg2.l13.m1.1.1.1.1.1.1.1.1.1.3.3.cmml" xref="alg2.l13.m1.1.1.1.1.1.1.1.1.1.3.3">𝑠</ci></apply></apply><ci id="alg2.l13.m1.1.1.1.1.1.1.3.cmml" xref="alg2.l13.m1.1.1.1.1.1.1.3">𝑇</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.l13.m1.1c">\bm{\pi}_{s}\leftarrow\sigma\left((|\mathbf{w}_{s}|-\bm{\tau}_{s})/T\right)</annotation></semantics></math>

</div>
<div id="alg2.l14" class="ltx_listingline">
<math id="alg2.l14.m1.1" class="ltx_Math" alttext="\mathbf{z}_{s}\sim q_{\bm{\pi}_{s}}(\mathbf{z}_{s})" display="inline"><semantics id="alg2.l14.m1.1a"><mrow id="alg2.l14.m1.1.1" xref="alg2.l14.m1.1.1.cmml"><msub id="alg2.l14.m1.1.1.3" xref="alg2.l14.m1.1.1.3.cmml"><mi id="alg2.l14.m1.1.1.3.2" xref="alg2.l14.m1.1.1.3.2.cmml">𝐳</mi><mi id="alg2.l14.m1.1.1.3.3" xref="alg2.l14.m1.1.1.3.3.cmml">s</mi></msub><mo id="alg2.l14.m1.1.1.2" xref="alg2.l14.m1.1.1.2.cmml">∼</mo><mrow id="alg2.l14.m1.1.1.1" xref="alg2.l14.m1.1.1.1.cmml"><msub id="alg2.l14.m1.1.1.1.3" xref="alg2.l14.m1.1.1.1.3.cmml"><mi id="alg2.l14.m1.1.1.1.3.2" xref="alg2.l14.m1.1.1.1.3.2.cmml">q</mi><msub id="alg2.l14.m1.1.1.1.3.3" xref="alg2.l14.m1.1.1.1.3.3.cmml"><mi id="alg2.l14.m1.1.1.1.3.3.2" xref="alg2.l14.m1.1.1.1.3.3.2.cmml">𝝅</mi><mi id="alg2.l14.m1.1.1.1.3.3.3" xref="alg2.l14.m1.1.1.1.3.3.3.cmml">s</mi></msub></msub><mo lspace="0em" rspace="0em" id="alg2.l14.m1.1.1.1.2" xref="alg2.l14.m1.1.1.1.2.cmml">​</mo><mrow id="alg2.l14.m1.1.1.1.1.1" xref="alg2.l14.m1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="alg2.l14.m1.1.1.1.1.1.2" xref="alg2.l14.m1.1.1.1.1.1.1.cmml">(</mo><msub id="alg2.l14.m1.1.1.1.1.1.1" xref="alg2.l14.m1.1.1.1.1.1.1.cmml"><mi id="alg2.l14.m1.1.1.1.1.1.1.2" xref="alg2.l14.m1.1.1.1.1.1.1.2.cmml">𝐳</mi><mi id="alg2.l14.m1.1.1.1.1.1.1.3" xref="alg2.l14.m1.1.1.1.1.1.1.3.cmml">s</mi></msub><mo stretchy="false" id="alg2.l14.m1.1.1.1.1.1.3" xref="alg2.l14.m1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg2.l14.m1.1b"><apply id="alg2.l14.m1.1.1.cmml" xref="alg2.l14.m1.1.1"><csymbol cd="latexml" id="alg2.l14.m1.1.1.2.cmml" xref="alg2.l14.m1.1.1.2">similar-to</csymbol><apply id="alg2.l14.m1.1.1.3.cmml" xref="alg2.l14.m1.1.1.3"><csymbol cd="ambiguous" id="alg2.l14.m1.1.1.3.1.cmml" xref="alg2.l14.m1.1.1.3">subscript</csymbol><ci id="alg2.l14.m1.1.1.3.2.cmml" xref="alg2.l14.m1.1.1.3.2">𝐳</ci><ci id="alg2.l14.m1.1.1.3.3.cmml" xref="alg2.l14.m1.1.1.3.3">𝑠</ci></apply><apply id="alg2.l14.m1.1.1.1.cmml" xref="alg2.l14.m1.1.1.1"><times id="alg2.l14.m1.1.1.1.2.cmml" xref="alg2.l14.m1.1.1.1.2"></times><apply id="alg2.l14.m1.1.1.1.3.cmml" xref="alg2.l14.m1.1.1.1.3"><csymbol cd="ambiguous" id="alg2.l14.m1.1.1.1.3.1.cmml" xref="alg2.l14.m1.1.1.1.3">subscript</csymbol><ci id="alg2.l14.m1.1.1.1.3.2.cmml" xref="alg2.l14.m1.1.1.1.3.2">𝑞</ci><apply id="alg2.l14.m1.1.1.1.3.3.cmml" xref="alg2.l14.m1.1.1.1.3.3"><csymbol cd="ambiguous" id="alg2.l14.m1.1.1.1.3.3.1.cmml" xref="alg2.l14.m1.1.1.1.3.3">subscript</csymbol><ci id="alg2.l14.m1.1.1.1.3.3.2.cmml" xref="alg2.l14.m1.1.1.1.3.3.2">𝝅</ci><ci id="alg2.l14.m1.1.1.1.3.3.3.cmml" xref="alg2.l14.m1.1.1.1.3.3.3">𝑠</ci></apply></apply><apply id="alg2.l14.m1.1.1.1.1.1.1.cmml" xref="alg2.l14.m1.1.1.1.1.1"><csymbol cd="ambiguous" id="alg2.l14.m1.1.1.1.1.1.1.1.cmml" xref="alg2.l14.m1.1.1.1.1.1">subscript</csymbol><ci id="alg2.l14.m1.1.1.1.1.1.1.2.cmml" xref="alg2.l14.m1.1.1.1.1.1.1.2">𝐳</ci><ci id="alg2.l14.m1.1.1.1.1.1.1.3.cmml" xref="alg2.l14.m1.1.1.1.1.1.1.3">𝑠</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.l14.m1.1c">\mathbf{z}_{s}\sim q_{\bm{\pi}_{s}}(\mathbf{z}_{s})</annotation></semantics></math>
</div>
<div id="alg2.l15" class="ltx_listingline">
<span id="alg2.l15.1" class="ltx_text ltx_font_bold">return</span> <math id="alg2.l15.m1.1" class="ltx_Math" alttext="\mathbf{z}_{s}" display="inline"><semantics id="alg2.l15.m1.1a"><msub id="alg2.l15.m1.1.1" xref="alg2.l15.m1.1.1.cmml"><mi id="alg2.l15.m1.1.1.2" xref="alg2.l15.m1.1.1.2.cmml">𝐳</mi><mi id="alg2.l15.m1.1.1.3" xref="alg2.l15.m1.1.1.3.cmml">s</mi></msub><annotation-xml encoding="MathML-Content" id="alg2.l15.m1.1b"><apply id="alg2.l15.m1.1.1.cmml" xref="alg2.l15.m1.1.1"><csymbol cd="ambiguous" id="alg2.l15.m1.1.1.1.cmml" xref="alg2.l15.m1.1.1">subscript</csymbol><ci id="alg2.l15.m1.1.1.2.cmml" xref="alg2.l15.m1.1.1.2">𝐳</ci><ci id="alg2.l15.m1.1.1.3.cmml" xref="alg2.l15.m1.1.1.3">𝑠</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.l15.m1.1c">\mathbf{z}_{s}</annotation></semantics></math>, <math id="alg2.l15.m2.1" class="ltx_Math" alttext="\mathbf{z}_{s}\odot\mathbf{w}_{s}" display="inline"><semantics id="alg2.l15.m2.1a"><mrow id="alg2.l15.m2.1.1" xref="alg2.l15.m2.1.1.cmml"><msub id="alg2.l15.m2.1.1.2" xref="alg2.l15.m2.1.1.2.cmml"><mi id="alg2.l15.m2.1.1.2.2" xref="alg2.l15.m2.1.1.2.2.cmml">𝐳</mi><mi id="alg2.l15.m2.1.1.2.3" xref="alg2.l15.m2.1.1.2.3.cmml">s</mi></msub><mo lspace="0.222em" rspace="0.222em" id="alg2.l15.m2.1.1.1" xref="alg2.l15.m2.1.1.1.cmml">⊙</mo><msub id="alg2.l15.m2.1.1.3" xref="alg2.l15.m2.1.1.3.cmml"><mi id="alg2.l15.m2.1.1.3.2" xref="alg2.l15.m2.1.1.3.2.cmml">𝐰</mi><mi id="alg2.l15.m2.1.1.3.3" xref="alg2.l15.m2.1.1.3.3.cmml">s</mi></msub></mrow><annotation-xml encoding="MathML-Content" id="alg2.l15.m2.1b"><apply id="alg2.l15.m2.1.1.cmml" xref="alg2.l15.m2.1.1"><csymbol cd="latexml" id="alg2.l15.m2.1.1.1.cmml" xref="alg2.l15.m2.1.1.1">direct-product</csymbol><apply id="alg2.l15.m2.1.1.2.cmml" xref="alg2.l15.m2.1.1.2"><csymbol cd="ambiguous" id="alg2.l15.m2.1.1.2.1.cmml" xref="alg2.l15.m2.1.1.2">subscript</csymbol><ci id="alg2.l15.m2.1.1.2.2.cmml" xref="alg2.l15.m2.1.1.2.2">𝐳</ci><ci id="alg2.l15.m2.1.1.2.3.cmml" xref="alg2.l15.m2.1.1.2.3">𝑠</ci></apply><apply id="alg2.l15.m2.1.1.3.cmml" xref="alg2.l15.m2.1.1.3"><csymbol cd="ambiguous" id="alg2.l15.m2.1.1.3.1.cmml" xref="alg2.l15.m2.1.1.3">subscript</csymbol><ci id="alg2.l15.m2.1.1.3.2.cmml" xref="alg2.l15.m2.1.1.3.2">𝐰</ci><ci id="alg2.l15.m2.1.1.3.3.cmml" xref="alg2.l15.m2.1.1.3.3">𝑠</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.l15.m2.1c">\mathbf{z}_{s}\odot\mathbf{w}_{s}</annotation></semantics></math>

</div>
</div>
</figure>
</section>
<section id="A10" class="ltx_appendix">
<h2 class="ltx_title ltx_title_appendix">
<span class="ltx_tag ltx_tag_appendix">Appendix J </span>Alternative priors for the hierarchical model</h2>

<div id="A10.p1" class="ltx_para">
<p id="A10.p1.1" class="ltx_p">In the main text we argued that the hierarchical model interpretation is highly flexible and allows for straightforward extensions. In this section we will demonstrate two variants that use either a Laplace or a mixture of Gaussians prior, coupled with hard-EM for learning the parameters of the hierarchical model.</p>
</div>
<section id="A10.SS1" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">J.1 </span>Federated learning with Laplace priors</h3>

<div id="A10.SS1.p1" class="ltx_para">
<p id="A10.SS1.p1.1" class="ltx_p">Lets start with the Laplace variant; the Laplace density for a specific local parameter <math id="A10.SS1.p1.1.m1.1" class="ltx_Math" alttext="\bm{\phi}_{si}" display="inline"><semantics id="A10.SS1.p1.1.m1.1a"><msub id="A10.SS1.p1.1.m1.1.1" xref="A10.SS1.p1.1.m1.1.1.cmml"><mi class="ltx_mathvariant_bold-italic" mathvariant="bold-italic" id="A10.SS1.p1.1.m1.1.1.2" xref="A10.SS1.p1.1.m1.1.1.2.cmml">ϕ</mi><mrow id="A10.SS1.p1.1.m1.1.1.3" xref="A10.SS1.p1.1.m1.1.1.3.cmml"><mi id="A10.SS1.p1.1.m1.1.1.3.2" xref="A10.SS1.p1.1.m1.1.1.3.2.cmml">s</mi><mo lspace="0em" rspace="0em" id="A10.SS1.p1.1.m1.1.1.3.1" xref="A10.SS1.p1.1.m1.1.1.3.1.cmml">​</mo><mi id="A10.SS1.p1.1.m1.1.1.3.3" xref="A10.SS1.p1.1.m1.1.1.3.3.cmml">i</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="A10.SS1.p1.1.m1.1b"><apply id="A10.SS1.p1.1.m1.1.1.cmml" xref="A10.SS1.p1.1.m1.1.1"><csymbol cd="ambiguous" id="A10.SS1.p1.1.m1.1.1.1.cmml" xref="A10.SS1.p1.1.m1.1.1">subscript</csymbol><ci id="A10.SS1.p1.1.m1.1.1.2.cmml" xref="A10.SS1.p1.1.m1.1.1.2">bold-italic-ϕ</ci><apply id="A10.SS1.p1.1.m1.1.1.3.cmml" xref="A10.SS1.p1.1.m1.1.1.3"><times id="A10.SS1.p1.1.m1.1.1.3.1.cmml" xref="A10.SS1.p1.1.m1.1.1.3.1"></times><ci id="A10.SS1.p1.1.m1.1.1.3.2.cmml" xref="A10.SS1.p1.1.m1.1.1.3.2">𝑠</ci><ci id="A10.SS1.p1.1.m1.1.1.3.3.cmml" xref="A10.SS1.p1.1.m1.1.1.3.3">𝑖</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A10.SS1.p1.1.m1.1c">\bm{\phi}_{si}</annotation></semantics></math> will be:</p>
<table id="A10.EGx35" class="ltx_equationgroup ltx_eqn_align ltx_eqn_table">

<tbody id="A10.E42"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math id="A10.E42.m1.1" class="ltx_Math" alttext="\displaystyle p(\bm{\phi}_{si}|\mathbf{w}_{i})" display="inline"><semantics id="A10.E42.m1.1a"><mrow id="A10.E42.m1.1.1" xref="A10.E42.m1.1.1.cmml"><mi id="A10.E42.m1.1.1.3" xref="A10.E42.m1.1.1.3.cmml">p</mi><mo lspace="0em" rspace="0em" id="A10.E42.m1.1.1.2" xref="A10.E42.m1.1.1.2.cmml">​</mo><mrow id="A10.E42.m1.1.1.1.1" xref="A10.E42.m1.1.1.1.1.1.cmml"><mo stretchy="false" id="A10.E42.m1.1.1.1.1.2" xref="A10.E42.m1.1.1.1.1.1.cmml">(</mo><mrow id="A10.E42.m1.1.1.1.1.1" xref="A10.E42.m1.1.1.1.1.1.cmml"><msub id="A10.E42.m1.1.1.1.1.1.2" xref="A10.E42.m1.1.1.1.1.1.2.cmml"><mi class="ltx_mathvariant_bold-italic" mathvariant="bold-italic" id="A10.E42.m1.1.1.1.1.1.2.2" xref="A10.E42.m1.1.1.1.1.1.2.2.cmml">ϕ</mi><mrow id="A10.E42.m1.1.1.1.1.1.2.3" xref="A10.E42.m1.1.1.1.1.1.2.3.cmml"><mi id="A10.E42.m1.1.1.1.1.1.2.3.2" xref="A10.E42.m1.1.1.1.1.1.2.3.2.cmml">s</mi><mo lspace="0em" rspace="0em" id="A10.E42.m1.1.1.1.1.1.2.3.1" xref="A10.E42.m1.1.1.1.1.1.2.3.1.cmml">​</mo><mi id="A10.E42.m1.1.1.1.1.1.2.3.3" xref="A10.E42.m1.1.1.1.1.1.2.3.3.cmml">i</mi></mrow></msub><mo fence="false" id="A10.E42.m1.1.1.1.1.1.1" xref="A10.E42.m1.1.1.1.1.1.1.cmml">|</mo><msub id="A10.E42.m1.1.1.1.1.1.3" xref="A10.E42.m1.1.1.1.1.1.3.cmml"><mi id="A10.E42.m1.1.1.1.1.1.3.2" xref="A10.E42.m1.1.1.1.1.1.3.2.cmml">𝐰</mi><mi id="A10.E42.m1.1.1.1.1.1.3.3" xref="A10.E42.m1.1.1.1.1.1.3.3.cmml">i</mi></msub></mrow><mo stretchy="false" id="A10.E42.m1.1.1.1.1.3" xref="A10.E42.m1.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="A10.E42.m1.1b"><apply id="A10.E42.m1.1.1.cmml" xref="A10.E42.m1.1.1"><times id="A10.E42.m1.1.1.2.cmml" xref="A10.E42.m1.1.1.2"></times><ci id="A10.E42.m1.1.1.3.cmml" xref="A10.E42.m1.1.1.3">𝑝</ci><apply id="A10.E42.m1.1.1.1.1.1.cmml" xref="A10.E42.m1.1.1.1.1"><csymbol cd="latexml" id="A10.E42.m1.1.1.1.1.1.1.cmml" xref="A10.E42.m1.1.1.1.1.1.1">conditional</csymbol><apply id="A10.E42.m1.1.1.1.1.1.2.cmml" xref="A10.E42.m1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="A10.E42.m1.1.1.1.1.1.2.1.cmml" xref="A10.E42.m1.1.1.1.1.1.2">subscript</csymbol><ci id="A10.E42.m1.1.1.1.1.1.2.2.cmml" xref="A10.E42.m1.1.1.1.1.1.2.2">bold-italic-ϕ</ci><apply id="A10.E42.m1.1.1.1.1.1.2.3.cmml" xref="A10.E42.m1.1.1.1.1.1.2.3"><times id="A10.E42.m1.1.1.1.1.1.2.3.1.cmml" xref="A10.E42.m1.1.1.1.1.1.2.3.1"></times><ci id="A10.E42.m1.1.1.1.1.1.2.3.2.cmml" xref="A10.E42.m1.1.1.1.1.1.2.3.2">𝑠</ci><ci id="A10.E42.m1.1.1.1.1.1.2.3.3.cmml" xref="A10.E42.m1.1.1.1.1.1.2.3.3">𝑖</ci></apply></apply><apply id="A10.E42.m1.1.1.1.1.1.3.cmml" xref="A10.E42.m1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="A10.E42.m1.1.1.1.1.1.3.1.cmml" xref="A10.E42.m1.1.1.1.1.1.3">subscript</csymbol><ci id="A10.E42.m1.1.1.1.1.1.3.2.cmml" xref="A10.E42.m1.1.1.1.1.1.3.2">𝐰</ci><ci id="A10.E42.m1.1.1.1.1.1.3.3.cmml" xref="A10.E42.m1.1.1.1.1.1.3.3">𝑖</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A10.E42.m1.1c">\displaystyle p(\bm{\phi}_{si}|\mathbf{w}_{i})</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math id="A10.E42.m2.2" class="ltx_Math" alttext="\displaystyle=\frac{\lambda}{2}\exp(-\lambda|\bm{\phi}_{si}-\mathbf{w}_{i}|)." display="inline"><semantics id="A10.E42.m2.2a"><mrow id="A10.E42.m2.2.2.1" xref="A10.E42.m2.2.2.1.1.cmml"><mrow id="A10.E42.m2.2.2.1.1" xref="A10.E42.m2.2.2.1.1.cmml"><mi id="A10.E42.m2.2.2.1.1.3" xref="A10.E42.m2.2.2.1.1.3.cmml"></mi><mo id="A10.E42.m2.2.2.1.1.2" xref="A10.E42.m2.2.2.1.1.2.cmml">=</mo><mrow id="A10.E42.m2.2.2.1.1.1" xref="A10.E42.m2.2.2.1.1.1.cmml"><mstyle displaystyle="true" id="A10.E42.m2.2.2.1.1.1.3" xref="A10.E42.m2.2.2.1.1.1.3.cmml"><mfrac id="A10.E42.m2.2.2.1.1.1.3a" xref="A10.E42.m2.2.2.1.1.1.3.cmml"><mi id="A10.E42.m2.2.2.1.1.1.3.2" xref="A10.E42.m2.2.2.1.1.1.3.2.cmml">λ</mi><mn id="A10.E42.m2.2.2.1.1.1.3.3" xref="A10.E42.m2.2.2.1.1.1.3.3.cmml">2</mn></mfrac></mstyle><mo lspace="0.167em" rspace="0em" id="A10.E42.m2.2.2.1.1.1.2" xref="A10.E42.m2.2.2.1.1.1.2.cmml">​</mo><mrow id="A10.E42.m2.2.2.1.1.1.1.1" xref="A10.E42.m2.2.2.1.1.1.1.2.cmml"><mi id="A10.E42.m2.1.1" xref="A10.E42.m2.1.1.cmml">exp</mi><mo id="A10.E42.m2.2.2.1.1.1.1.1a" xref="A10.E42.m2.2.2.1.1.1.1.2.cmml">⁡</mo><mrow id="A10.E42.m2.2.2.1.1.1.1.1.1" xref="A10.E42.m2.2.2.1.1.1.1.2.cmml"><mo stretchy="false" id="A10.E42.m2.2.2.1.1.1.1.1.1.2" xref="A10.E42.m2.2.2.1.1.1.1.2.cmml">(</mo><mrow id="A10.E42.m2.2.2.1.1.1.1.1.1.1" xref="A10.E42.m2.2.2.1.1.1.1.1.1.1.cmml"><mo id="A10.E42.m2.2.2.1.1.1.1.1.1.1a" xref="A10.E42.m2.2.2.1.1.1.1.1.1.1.cmml">−</mo><mrow id="A10.E42.m2.2.2.1.1.1.1.1.1.1.1" xref="A10.E42.m2.2.2.1.1.1.1.1.1.1.1.cmml"><mi id="A10.E42.m2.2.2.1.1.1.1.1.1.1.1.3" xref="A10.E42.m2.2.2.1.1.1.1.1.1.1.1.3.cmml">λ</mi><mo lspace="0em" rspace="0em" id="A10.E42.m2.2.2.1.1.1.1.1.1.1.1.2" xref="A10.E42.m2.2.2.1.1.1.1.1.1.1.1.2.cmml">​</mo><mrow id="A10.E42.m2.2.2.1.1.1.1.1.1.1.1.1.1" xref="A10.E42.m2.2.2.1.1.1.1.1.1.1.1.1.2.cmml"><mo stretchy="false" id="A10.E42.m2.2.2.1.1.1.1.1.1.1.1.1.1.2" xref="A10.E42.m2.2.2.1.1.1.1.1.1.1.1.1.2.1.cmml">|</mo><mrow id="A10.E42.m2.2.2.1.1.1.1.1.1.1.1.1.1.1" xref="A10.E42.m2.2.2.1.1.1.1.1.1.1.1.1.1.1.cmml"><msub id="A10.E42.m2.2.2.1.1.1.1.1.1.1.1.1.1.1.2" xref="A10.E42.m2.2.2.1.1.1.1.1.1.1.1.1.1.1.2.cmml"><mi class="ltx_mathvariant_bold-italic" mathvariant="bold-italic" id="A10.E42.m2.2.2.1.1.1.1.1.1.1.1.1.1.1.2.2" xref="A10.E42.m2.2.2.1.1.1.1.1.1.1.1.1.1.1.2.2.cmml">ϕ</mi><mrow id="A10.E42.m2.2.2.1.1.1.1.1.1.1.1.1.1.1.2.3" xref="A10.E42.m2.2.2.1.1.1.1.1.1.1.1.1.1.1.2.3.cmml"><mi id="A10.E42.m2.2.2.1.1.1.1.1.1.1.1.1.1.1.2.3.2" xref="A10.E42.m2.2.2.1.1.1.1.1.1.1.1.1.1.1.2.3.2.cmml">s</mi><mo lspace="0em" rspace="0em" id="A10.E42.m2.2.2.1.1.1.1.1.1.1.1.1.1.1.2.3.1" xref="A10.E42.m2.2.2.1.1.1.1.1.1.1.1.1.1.1.2.3.1.cmml">​</mo><mi id="A10.E42.m2.2.2.1.1.1.1.1.1.1.1.1.1.1.2.3.3" xref="A10.E42.m2.2.2.1.1.1.1.1.1.1.1.1.1.1.2.3.3.cmml">i</mi></mrow></msub><mo id="A10.E42.m2.2.2.1.1.1.1.1.1.1.1.1.1.1.1" xref="A10.E42.m2.2.2.1.1.1.1.1.1.1.1.1.1.1.1.cmml">−</mo><msub id="A10.E42.m2.2.2.1.1.1.1.1.1.1.1.1.1.1.3" xref="A10.E42.m2.2.2.1.1.1.1.1.1.1.1.1.1.1.3.cmml"><mi id="A10.E42.m2.2.2.1.1.1.1.1.1.1.1.1.1.1.3.2" xref="A10.E42.m2.2.2.1.1.1.1.1.1.1.1.1.1.1.3.2.cmml">𝐰</mi><mi id="A10.E42.m2.2.2.1.1.1.1.1.1.1.1.1.1.1.3.3" xref="A10.E42.m2.2.2.1.1.1.1.1.1.1.1.1.1.1.3.3.cmml">i</mi></msub></mrow><mo stretchy="false" id="A10.E42.m2.2.2.1.1.1.1.1.1.1.1.1.1.3" xref="A10.E42.m2.2.2.1.1.1.1.1.1.1.1.1.2.1.cmml">|</mo></mrow></mrow></mrow><mo stretchy="false" id="A10.E42.m2.2.2.1.1.1.1.1.1.3" xref="A10.E42.m2.2.2.1.1.1.1.2.cmml">)</mo></mrow></mrow></mrow></mrow><mo lspace="0em" id="A10.E42.m2.2.2.1.2" xref="A10.E42.m2.2.2.1.1.cmml">.</mo></mrow><annotation-xml encoding="MathML-Content" id="A10.E42.m2.2b"><apply id="A10.E42.m2.2.2.1.1.cmml" xref="A10.E42.m2.2.2.1"><eq id="A10.E42.m2.2.2.1.1.2.cmml" xref="A10.E42.m2.2.2.1.1.2"></eq><csymbol cd="latexml" id="A10.E42.m2.2.2.1.1.3.cmml" xref="A10.E42.m2.2.2.1.1.3">absent</csymbol><apply id="A10.E42.m2.2.2.1.1.1.cmml" xref="A10.E42.m2.2.2.1.1.1"><times id="A10.E42.m2.2.2.1.1.1.2.cmml" xref="A10.E42.m2.2.2.1.1.1.2"></times><apply id="A10.E42.m2.2.2.1.1.1.3.cmml" xref="A10.E42.m2.2.2.1.1.1.3"><divide id="A10.E42.m2.2.2.1.1.1.3.1.cmml" xref="A10.E42.m2.2.2.1.1.1.3"></divide><ci id="A10.E42.m2.2.2.1.1.1.3.2.cmml" xref="A10.E42.m2.2.2.1.1.1.3.2">𝜆</ci><cn type="integer" id="A10.E42.m2.2.2.1.1.1.3.3.cmml" xref="A10.E42.m2.2.2.1.1.1.3.3">2</cn></apply><apply id="A10.E42.m2.2.2.1.1.1.1.2.cmml" xref="A10.E42.m2.2.2.1.1.1.1.1"><exp id="A10.E42.m2.1.1.cmml" xref="A10.E42.m2.1.1"></exp><apply id="A10.E42.m2.2.2.1.1.1.1.1.1.1.cmml" xref="A10.E42.m2.2.2.1.1.1.1.1.1.1"><minus id="A10.E42.m2.2.2.1.1.1.1.1.1.1.2.cmml" xref="A10.E42.m2.2.2.1.1.1.1.1.1.1"></minus><apply id="A10.E42.m2.2.2.1.1.1.1.1.1.1.1.cmml" xref="A10.E42.m2.2.2.1.1.1.1.1.1.1.1"><times id="A10.E42.m2.2.2.1.1.1.1.1.1.1.1.2.cmml" xref="A10.E42.m2.2.2.1.1.1.1.1.1.1.1.2"></times><ci id="A10.E42.m2.2.2.1.1.1.1.1.1.1.1.3.cmml" xref="A10.E42.m2.2.2.1.1.1.1.1.1.1.1.3">𝜆</ci><apply id="A10.E42.m2.2.2.1.1.1.1.1.1.1.1.1.2.cmml" xref="A10.E42.m2.2.2.1.1.1.1.1.1.1.1.1.1"><abs id="A10.E42.m2.2.2.1.1.1.1.1.1.1.1.1.2.1.cmml" xref="A10.E42.m2.2.2.1.1.1.1.1.1.1.1.1.1.2"></abs><apply id="A10.E42.m2.2.2.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="A10.E42.m2.2.2.1.1.1.1.1.1.1.1.1.1.1"><minus id="A10.E42.m2.2.2.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="A10.E42.m2.2.2.1.1.1.1.1.1.1.1.1.1.1.1"></minus><apply id="A10.E42.m2.2.2.1.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="A10.E42.m2.2.2.1.1.1.1.1.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="A10.E42.m2.2.2.1.1.1.1.1.1.1.1.1.1.1.2.1.cmml" xref="A10.E42.m2.2.2.1.1.1.1.1.1.1.1.1.1.1.2">subscript</csymbol><ci id="A10.E42.m2.2.2.1.1.1.1.1.1.1.1.1.1.1.2.2.cmml" xref="A10.E42.m2.2.2.1.1.1.1.1.1.1.1.1.1.1.2.2">bold-italic-ϕ</ci><apply id="A10.E42.m2.2.2.1.1.1.1.1.1.1.1.1.1.1.2.3.cmml" xref="A10.E42.m2.2.2.1.1.1.1.1.1.1.1.1.1.1.2.3"><times id="A10.E42.m2.2.2.1.1.1.1.1.1.1.1.1.1.1.2.3.1.cmml" xref="A10.E42.m2.2.2.1.1.1.1.1.1.1.1.1.1.1.2.3.1"></times><ci id="A10.E42.m2.2.2.1.1.1.1.1.1.1.1.1.1.1.2.3.2.cmml" xref="A10.E42.m2.2.2.1.1.1.1.1.1.1.1.1.1.1.2.3.2">𝑠</ci><ci id="A10.E42.m2.2.2.1.1.1.1.1.1.1.1.1.1.1.2.3.3.cmml" xref="A10.E42.m2.2.2.1.1.1.1.1.1.1.1.1.1.1.2.3.3">𝑖</ci></apply></apply><apply id="A10.E42.m2.2.2.1.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="A10.E42.m2.2.2.1.1.1.1.1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="A10.E42.m2.2.2.1.1.1.1.1.1.1.1.1.1.1.3.1.cmml" xref="A10.E42.m2.2.2.1.1.1.1.1.1.1.1.1.1.1.3">subscript</csymbol><ci id="A10.E42.m2.2.2.1.1.1.1.1.1.1.1.1.1.1.3.2.cmml" xref="A10.E42.m2.2.2.1.1.1.1.1.1.1.1.1.1.1.3.2">𝐰</ci><ci id="A10.E42.m2.2.2.1.1.1.1.1.1.1.1.1.1.1.3.3.cmml" xref="A10.E42.m2.2.2.1.1.1.1.1.1.1.1.1.1.1.3.3">𝑖</ci></apply></apply></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A10.E42.m2.2c">\displaystyle=\frac{\lambda}{2}\exp(-\lambda|\bm{\phi}_{si}-\mathbf{w}_{i}|).</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(42)</span></td>
</tr></tbody>
</table>
<p id="A10.SS1.p1.14" class="ltx_p">Therefore the local objective of each shard and the global objective will be</p>
<table id="A10.EGx36" class="ltx_equationgroup ltx_eqn_align ltx_eqn_table">

<tbody id="A10.E43"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math id="A10.E43.m1.3" class="ltx_Math" alttext="\displaystyle\mathcal{L}_{s}(\mathcal{D}_{s},\mathbf{w},\mathbf{w}_{s})" display="inline"><semantics id="A10.E43.m1.3a"><mrow id="A10.E43.m1.3.3" xref="A10.E43.m1.3.3.cmml"><msub id="A10.E43.m1.3.3.4" xref="A10.E43.m1.3.3.4.cmml"><mi class="ltx_font_mathcaligraphic" id="A10.E43.m1.3.3.4.2" xref="A10.E43.m1.3.3.4.2.cmml">ℒ</mi><mi id="A10.E43.m1.3.3.4.3" xref="A10.E43.m1.3.3.4.3.cmml">s</mi></msub><mo lspace="0em" rspace="0em" id="A10.E43.m1.3.3.3" xref="A10.E43.m1.3.3.3.cmml">​</mo><mrow id="A10.E43.m1.3.3.2.2" xref="A10.E43.m1.3.3.2.3.cmml"><mo stretchy="false" id="A10.E43.m1.3.3.2.2.3" xref="A10.E43.m1.3.3.2.3.cmml">(</mo><msub id="A10.E43.m1.2.2.1.1.1" xref="A10.E43.m1.2.2.1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="A10.E43.m1.2.2.1.1.1.2" xref="A10.E43.m1.2.2.1.1.1.2.cmml">𝒟</mi><mi id="A10.E43.m1.2.2.1.1.1.3" xref="A10.E43.m1.2.2.1.1.1.3.cmml">s</mi></msub><mo id="A10.E43.m1.3.3.2.2.4" xref="A10.E43.m1.3.3.2.3.cmml">,</mo><mi id="A10.E43.m1.1.1" xref="A10.E43.m1.1.1.cmml">𝐰</mi><mo id="A10.E43.m1.3.3.2.2.5" xref="A10.E43.m1.3.3.2.3.cmml">,</mo><msub id="A10.E43.m1.3.3.2.2.2" xref="A10.E43.m1.3.3.2.2.2.cmml"><mi id="A10.E43.m1.3.3.2.2.2.2" xref="A10.E43.m1.3.3.2.2.2.2.cmml">𝐰</mi><mi id="A10.E43.m1.3.3.2.2.2.3" xref="A10.E43.m1.3.3.2.2.2.3.cmml">s</mi></msub><mo stretchy="false" id="A10.E43.m1.3.3.2.2.6" xref="A10.E43.m1.3.3.2.3.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="A10.E43.m1.3b"><apply id="A10.E43.m1.3.3.cmml" xref="A10.E43.m1.3.3"><times id="A10.E43.m1.3.3.3.cmml" xref="A10.E43.m1.3.3.3"></times><apply id="A10.E43.m1.3.3.4.cmml" xref="A10.E43.m1.3.3.4"><csymbol cd="ambiguous" id="A10.E43.m1.3.3.4.1.cmml" xref="A10.E43.m1.3.3.4">subscript</csymbol><ci id="A10.E43.m1.3.3.4.2.cmml" xref="A10.E43.m1.3.3.4.2">ℒ</ci><ci id="A10.E43.m1.3.3.4.3.cmml" xref="A10.E43.m1.3.3.4.3">𝑠</ci></apply><vector id="A10.E43.m1.3.3.2.3.cmml" xref="A10.E43.m1.3.3.2.2"><apply id="A10.E43.m1.2.2.1.1.1.cmml" xref="A10.E43.m1.2.2.1.1.1"><csymbol cd="ambiguous" id="A10.E43.m1.2.2.1.1.1.1.cmml" xref="A10.E43.m1.2.2.1.1.1">subscript</csymbol><ci id="A10.E43.m1.2.2.1.1.1.2.cmml" xref="A10.E43.m1.2.2.1.1.1.2">𝒟</ci><ci id="A10.E43.m1.2.2.1.1.1.3.cmml" xref="A10.E43.m1.2.2.1.1.1.3">𝑠</ci></apply><ci id="A10.E43.m1.1.1.cmml" xref="A10.E43.m1.1.1">𝐰</ci><apply id="A10.E43.m1.3.3.2.2.2.cmml" xref="A10.E43.m1.3.3.2.2.2"><csymbol cd="ambiguous" id="A10.E43.m1.3.3.2.2.2.1.cmml" xref="A10.E43.m1.3.3.2.2.2">subscript</csymbol><ci id="A10.E43.m1.3.3.2.2.2.2.cmml" xref="A10.E43.m1.3.3.2.2.2.2">𝐰</ci><ci id="A10.E43.m1.3.3.2.2.2.3.cmml" xref="A10.E43.m1.3.3.2.2.2.3">𝑠</ci></apply></vector></apply></annotation-xml><annotation encoding="application/x-tex" id="A10.E43.m1.3c">\displaystyle\mathcal{L}_{s}(\mathcal{D}_{s},\mathbf{w},\mathbf{w}_{s})</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math id="A10.E43.m2.1" class="ltx_Math" alttext="\displaystyle:=\sum_{i}^{N_{s}}L(\mathcal{D}_{si},\mathbf{w}_{s})-\lambda\sum_{j}|\mathbf{w}_{sj}-\mathbf{w}_{j}|+C," display="inline"><semantics id="A10.E43.m2.1a"><mrow id="A10.E43.m2.1.1.1" xref="A10.E43.m2.1.1.1.1.cmml"><mrow id="A10.E43.m2.1.1.1.1" xref="A10.E43.m2.1.1.1.1.cmml"><mi id="A10.E43.m2.1.1.1.1.5" xref="A10.E43.m2.1.1.1.1.5.cmml"></mi><mo lspace="0.278em" rspace="0.278em" id="A10.E43.m2.1.1.1.1.4" xref="A10.E43.m2.1.1.1.1.4.cmml">:=</mo><mrow id="A10.E43.m2.1.1.1.1.3" xref="A10.E43.m2.1.1.1.1.3.cmml"><mrow id="A10.E43.m2.1.1.1.1.3.3" xref="A10.E43.m2.1.1.1.1.3.3.cmml"><mrow id="A10.E43.m2.1.1.1.1.2.2.2" xref="A10.E43.m2.1.1.1.1.2.2.2.cmml"><mstyle displaystyle="true" id="A10.E43.m2.1.1.1.1.2.2.2.3" xref="A10.E43.m2.1.1.1.1.2.2.2.3.cmml"><munderover id="A10.E43.m2.1.1.1.1.2.2.2.3a" xref="A10.E43.m2.1.1.1.1.2.2.2.3.cmml"><mo movablelimits="false" id="A10.E43.m2.1.1.1.1.2.2.2.3.2.2" xref="A10.E43.m2.1.1.1.1.2.2.2.3.2.2.cmml">∑</mo><mi id="A10.E43.m2.1.1.1.1.2.2.2.3.2.3" xref="A10.E43.m2.1.1.1.1.2.2.2.3.2.3.cmml">i</mi><msub id="A10.E43.m2.1.1.1.1.2.2.2.3.3" xref="A10.E43.m2.1.1.1.1.2.2.2.3.3.cmml"><mi id="A10.E43.m2.1.1.1.1.2.2.2.3.3.2" xref="A10.E43.m2.1.1.1.1.2.2.2.3.3.2.cmml">N</mi><mi id="A10.E43.m2.1.1.1.1.2.2.2.3.3.3" xref="A10.E43.m2.1.1.1.1.2.2.2.3.3.3.cmml">s</mi></msub></munderover></mstyle><mrow id="A10.E43.m2.1.1.1.1.2.2.2.2" xref="A10.E43.m2.1.1.1.1.2.2.2.2.cmml"><mi id="A10.E43.m2.1.1.1.1.2.2.2.2.4" xref="A10.E43.m2.1.1.1.1.2.2.2.2.4.cmml">L</mi><mo lspace="0em" rspace="0em" id="A10.E43.m2.1.1.1.1.2.2.2.2.3" xref="A10.E43.m2.1.1.1.1.2.2.2.2.3.cmml">​</mo><mrow id="A10.E43.m2.1.1.1.1.2.2.2.2.2.2" xref="A10.E43.m2.1.1.1.1.2.2.2.2.2.3.cmml"><mo stretchy="false" id="A10.E43.m2.1.1.1.1.2.2.2.2.2.2.3" xref="A10.E43.m2.1.1.1.1.2.2.2.2.2.3.cmml">(</mo><msub id="A10.E43.m2.1.1.1.1.1.1.1.1.1.1.1" xref="A10.E43.m2.1.1.1.1.1.1.1.1.1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="A10.E43.m2.1.1.1.1.1.1.1.1.1.1.1.2" xref="A10.E43.m2.1.1.1.1.1.1.1.1.1.1.1.2.cmml">𝒟</mi><mrow id="A10.E43.m2.1.1.1.1.1.1.1.1.1.1.1.3" xref="A10.E43.m2.1.1.1.1.1.1.1.1.1.1.1.3.cmml"><mi id="A10.E43.m2.1.1.1.1.1.1.1.1.1.1.1.3.2" xref="A10.E43.m2.1.1.1.1.1.1.1.1.1.1.1.3.2.cmml">s</mi><mo lspace="0em" rspace="0em" id="A10.E43.m2.1.1.1.1.1.1.1.1.1.1.1.3.1" xref="A10.E43.m2.1.1.1.1.1.1.1.1.1.1.1.3.1.cmml">​</mo><mi id="A10.E43.m2.1.1.1.1.1.1.1.1.1.1.1.3.3" xref="A10.E43.m2.1.1.1.1.1.1.1.1.1.1.1.3.3.cmml">i</mi></mrow></msub><mo id="A10.E43.m2.1.1.1.1.2.2.2.2.2.2.4" xref="A10.E43.m2.1.1.1.1.2.2.2.2.2.3.cmml">,</mo><msub id="A10.E43.m2.1.1.1.1.2.2.2.2.2.2.2" xref="A10.E43.m2.1.1.1.1.2.2.2.2.2.2.2.cmml"><mi id="A10.E43.m2.1.1.1.1.2.2.2.2.2.2.2.2" xref="A10.E43.m2.1.1.1.1.2.2.2.2.2.2.2.2.cmml">𝐰</mi><mi id="A10.E43.m2.1.1.1.1.2.2.2.2.2.2.2.3" xref="A10.E43.m2.1.1.1.1.2.2.2.2.2.2.2.3.cmml">s</mi></msub><mo stretchy="false" id="A10.E43.m2.1.1.1.1.2.2.2.2.2.2.5" xref="A10.E43.m2.1.1.1.1.2.2.2.2.2.3.cmml">)</mo></mrow></mrow></mrow><mo id="A10.E43.m2.1.1.1.1.3.3.4" xref="A10.E43.m2.1.1.1.1.3.3.4.cmml">−</mo><mrow id="A10.E43.m2.1.1.1.1.3.3.3" xref="A10.E43.m2.1.1.1.1.3.3.3.cmml"><mi id="A10.E43.m2.1.1.1.1.3.3.3.3" xref="A10.E43.m2.1.1.1.1.3.3.3.3.cmml">λ</mi><mo lspace="0em" rspace="0em" id="A10.E43.m2.1.1.1.1.3.3.3.2" xref="A10.E43.m2.1.1.1.1.3.3.3.2.cmml">​</mo><mrow id="A10.E43.m2.1.1.1.1.3.3.3.1" xref="A10.E43.m2.1.1.1.1.3.3.3.1.cmml"><mstyle displaystyle="true" id="A10.E43.m2.1.1.1.1.3.3.3.1.2" xref="A10.E43.m2.1.1.1.1.3.3.3.1.2.cmml"><munder id="A10.E43.m2.1.1.1.1.3.3.3.1.2a" xref="A10.E43.m2.1.1.1.1.3.3.3.1.2.cmml"><mo movablelimits="false" id="A10.E43.m2.1.1.1.1.3.3.3.1.2.2" xref="A10.E43.m2.1.1.1.1.3.3.3.1.2.2.cmml">∑</mo><mi id="A10.E43.m2.1.1.1.1.3.3.3.1.2.3" xref="A10.E43.m2.1.1.1.1.3.3.3.1.2.3.cmml">j</mi></munder></mstyle><mrow id="A10.E43.m2.1.1.1.1.3.3.3.1.1.1" xref="A10.E43.m2.1.1.1.1.3.3.3.1.1.2.cmml"><mo stretchy="false" id="A10.E43.m2.1.1.1.1.3.3.3.1.1.1.2" xref="A10.E43.m2.1.1.1.1.3.3.3.1.1.2.1.cmml">|</mo><mrow id="A10.E43.m2.1.1.1.1.3.3.3.1.1.1.1" xref="A10.E43.m2.1.1.1.1.3.3.3.1.1.1.1.cmml"><msub id="A10.E43.m2.1.1.1.1.3.3.3.1.1.1.1.2" xref="A10.E43.m2.1.1.1.1.3.3.3.1.1.1.1.2.cmml"><mi id="A10.E43.m2.1.1.1.1.3.3.3.1.1.1.1.2.2" xref="A10.E43.m2.1.1.1.1.3.3.3.1.1.1.1.2.2.cmml">𝐰</mi><mrow id="A10.E43.m2.1.1.1.1.3.3.3.1.1.1.1.2.3" xref="A10.E43.m2.1.1.1.1.3.3.3.1.1.1.1.2.3.cmml"><mi id="A10.E43.m2.1.1.1.1.3.3.3.1.1.1.1.2.3.2" xref="A10.E43.m2.1.1.1.1.3.3.3.1.1.1.1.2.3.2.cmml">s</mi><mo lspace="0em" rspace="0em" id="A10.E43.m2.1.1.1.1.3.3.3.1.1.1.1.2.3.1" xref="A10.E43.m2.1.1.1.1.3.3.3.1.1.1.1.2.3.1.cmml">​</mo><mi id="A10.E43.m2.1.1.1.1.3.3.3.1.1.1.1.2.3.3" xref="A10.E43.m2.1.1.1.1.3.3.3.1.1.1.1.2.3.3.cmml">j</mi></mrow></msub><mo id="A10.E43.m2.1.1.1.1.3.3.3.1.1.1.1.1" xref="A10.E43.m2.1.1.1.1.3.3.3.1.1.1.1.1.cmml">−</mo><msub id="A10.E43.m2.1.1.1.1.3.3.3.1.1.1.1.3" xref="A10.E43.m2.1.1.1.1.3.3.3.1.1.1.1.3.cmml"><mi id="A10.E43.m2.1.1.1.1.3.3.3.1.1.1.1.3.2" xref="A10.E43.m2.1.1.1.1.3.3.3.1.1.1.1.3.2.cmml">𝐰</mi><mi id="A10.E43.m2.1.1.1.1.3.3.3.1.1.1.1.3.3" xref="A10.E43.m2.1.1.1.1.3.3.3.1.1.1.1.3.3.cmml">j</mi></msub></mrow><mo stretchy="false" id="A10.E43.m2.1.1.1.1.3.3.3.1.1.1.3" xref="A10.E43.m2.1.1.1.1.3.3.3.1.1.2.1.cmml">|</mo></mrow></mrow></mrow></mrow><mo id="A10.E43.m2.1.1.1.1.3.4" xref="A10.E43.m2.1.1.1.1.3.4.cmml">+</mo><mi id="A10.E43.m2.1.1.1.1.3.5" xref="A10.E43.m2.1.1.1.1.3.5.cmml">C</mi></mrow></mrow><mo id="A10.E43.m2.1.1.1.2" xref="A10.E43.m2.1.1.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="A10.E43.m2.1b"><apply id="A10.E43.m2.1.1.1.1.cmml" xref="A10.E43.m2.1.1.1"><csymbol cd="latexml" id="A10.E43.m2.1.1.1.1.4.cmml" xref="A10.E43.m2.1.1.1.1.4">assign</csymbol><csymbol cd="latexml" id="A10.E43.m2.1.1.1.1.5.cmml" xref="A10.E43.m2.1.1.1.1.5">absent</csymbol><apply id="A10.E43.m2.1.1.1.1.3.cmml" xref="A10.E43.m2.1.1.1.1.3"><plus id="A10.E43.m2.1.1.1.1.3.4.cmml" xref="A10.E43.m2.1.1.1.1.3.4"></plus><apply id="A10.E43.m2.1.1.1.1.3.3.cmml" xref="A10.E43.m2.1.1.1.1.3.3"><minus id="A10.E43.m2.1.1.1.1.3.3.4.cmml" xref="A10.E43.m2.1.1.1.1.3.3.4"></minus><apply id="A10.E43.m2.1.1.1.1.2.2.2.cmml" xref="A10.E43.m2.1.1.1.1.2.2.2"><apply id="A10.E43.m2.1.1.1.1.2.2.2.3.cmml" xref="A10.E43.m2.1.1.1.1.2.2.2.3"><csymbol cd="ambiguous" id="A10.E43.m2.1.1.1.1.2.2.2.3.1.cmml" xref="A10.E43.m2.1.1.1.1.2.2.2.3">superscript</csymbol><apply id="A10.E43.m2.1.1.1.1.2.2.2.3.2.cmml" xref="A10.E43.m2.1.1.1.1.2.2.2.3"><csymbol cd="ambiguous" id="A10.E43.m2.1.1.1.1.2.2.2.3.2.1.cmml" xref="A10.E43.m2.1.1.1.1.2.2.2.3">subscript</csymbol><sum id="A10.E43.m2.1.1.1.1.2.2.2.3.2.2.cmml" xref="A10.E43.m2.1.1.1.1.2.2.2.3.2.2"></sum><ci id="A10.E43.m2.1.1.1.1.2.2.2.3.2.3.cmml" xref="A10.E43.m2.1.1.1.1.2.2.2.3.2.3">𝑖</ci></apply><apply id="A10.E43.m2.1.1.1.1.2.2.2.3.3.cmml" xref="A10.E43.m2.1.1.1.1.2.2.2.3.3"><csymbol cd="ambiguous" id="A10.E43.m2.1.1.1.1.2.2.2.3.3.1.cmml" xref="A10.E43.m2.1.1.1.1.2.2.2.3.3">subscript</csymbol><ci id="A10.E43.m2.1.1.1.1.2.2.2.3.3.2.cmml" xref="A10.E43.m2.1.1.1.1.2.2.2.3.3.2">𝑁</ci><ci id="A10.E43.m2.1.1.1.1.2.2.2.3.3.3.cmml" xref="A10.E43.m2.1.1.1.1.2.2.2.3.3.3">𝑠</ci></apply></apply><apply id="A10.E43.m2.1.1.1.1.2.2.2.2.cmml" xref="A10.E43.m2.1.1.1.1.2.2.2.2"><times id="A10.E43.m2.1.1.1.1.2.2.2.2.3.cmml" xref="A10.E43.m2.1.1.1.1.2.2.2.2.3"></times><ci id="A10.E43.m2.1.1.1.1.2.2.2.2.4.cmml" xref="A10.E43.m2.1.1.1.1.2.2.2.2.4">𝐿</ci><interval closure="open" id="A10.E43.m2.1.1.1.1.2.2.2.2.2.3.cmml" xref="A10.E43.m2.1.1.1.1.2.2.2.2.2.2"><apply id="A10.E43.m2.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="A10.E43.m2.1.1.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="A10.E43.m2.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="A10.E43.m2.1.1.1.1.1.1.1.1.1.1.1">subscript</csymbol><ci id="A10.E43.m2.1.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="A10.E43.m2.1.1.1.1.1.1.1.1.1.1.1.2">𝒟</ci><apply id="A10.E43.m2.1.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="A10.E43.m2.1.1.1.1.1.1.1.1.1.1.1.3"><times id="A10.E43.m2.1.1.1.1.1.1.1.1.1.1.1.3.1.cmml" xref="A10.E43.m2.1.1.1.1.1.1.1.1.1.1.1.3.1"></times><ci id="A10.E43.m2.1.1.1.1.1.1.1.1.1.1.1.3.2.cmml" xref="A10.E43.m2.1.1.1.1.1.1.1.1.1.1.1.3.2">𝑠</ci><ci id="A10.E43.m2.1.1.1.1.1.1.1.1.1.1.1.3.3.cmml" xref="A10.E43.m2.1.1.1.1.1.1.1.1.1.1.1.3.3">𝑖</ci></apply></apply><apply id="A10.E43.m2.1.1.1.1.2.2.2.2.2.2.2.cmml" xref="A10.E43.m2.1.1.1.1.2.2.2.2.2.2.2"><csymbol cd="ambiguous" id="A10.E43.m2.1.1.1.1.2.2.2.2.2.2.2.1.cmml" xref="A10.E43.m2.1.1.1.1.2.2.2.2.2.2.2">subscript</csymbol><ci id="A10.E43.m2.1.1.1.1.2.2.2.2.2.2.2.2.cmml" xref="A10.E43.m2.1.1.1.1.2.2.2.2.2.2.2.2">𝐰</ci><ci id="A10.E43.m2.1.1.1.1.2.2.2.2.2.2.2.3.cmml" xref="A10.E43.m2.1.1.1.1.2.2.2.2.2.2.2.3">𝑠</ci></apply></interval></apply></apply><apply id="A10.E43.m2.1.1.1.1.3.3.3.cmml" xref="A10.E43.m2.1.1.1.1.3.3.3"><times id="A10.E43.m2.1.1.1.1.3.3.3.2.cmml" xref="A10.E43.m2.1.1.1.1.3.3.3.2"></times><ci id="A10.E43.m2.1.1.1.1.3.3.3.3.cmml" xref="A10.E43.m2.1.1.1.1.3.3.3.3">𝜆</ci><apply id="A10.E43.m2.1.1.1.1.3.3.3.1.cmml" xref="A10.E43.m2.1.1.1.1.3.3.3.1"><apply id="A10.E43.m2.1.1.1.1.3.3.3.1.2.cmml" xref="A10.E43.m2.1.1.1.1.3.3.3.1.2"><csymbol cd="ambiguous" id="A10.E43.m2.1.1.1.1.3.3.3.1.2.1.cmml" xref="A10.E43.m2.1.1.1.1.3.3.3.1.2">subscript</csymbol><sum id="A10.E43.m2.1.1.1.1.3.3.3.1.2.2.cmml" xref="A10.E43.m2.1.1.1.1.3.3.3.1.2.2"></sum><ci id="A10.E43.m2.1.1.1.1.3.3.3.1.2.3.cmml" xref="A10.E43.m2.1.1.1.1.3.3.3.1.2.3">𝑗</ci></apply><apply id="A10.E43.m2.1.1.1.1.3.3.3.1.1.2.cmml" xref="A10.E43.m2.1.1.1.1.3.3.3.1.1.1"><abs id="A10.E43.m2.1.1.1.1.3.3.3.1.1.2.1.cmml" xref="A10.E43.m2.1.1.1.1.3.3.3.1.1.1.2"></abs><apply id="A10.E43.m2.1.1.1.1.3.3.3.1.1.1.1.cmml" xref="A10.E43.m2.1.1.1.1.3.3.3.1.1.1.1"><minus id="A10.E43.m2.1.1.1.1.3.3.3.1.1.1.1.1.cmml" xref="A10.E43.m2.1.1.1.1.3.3.3.1.1.1.1.1"></minus><apply id="A10.E43.m2.1.1.1.1.3.3.3.1.1.1.1.2.cmml" xref="A10.E43.m2.1.1.1.1.3.3.3.1.1.1.1.2"><csymbol cd="ambiguous" id="A10.E43.m2.1.1.1.1.3.3.3.1.1.1.1.2.1.cmml" xref="A10.E43.m2.1.1.1.1.3.3.3.1.1.1.1.2">subscript</csymbol><ci id="A10.E43.m2.1.1.1.1.3.3.3.1.1.1.1.2.2.cmml" xref="A10.E43.m2.1.1.1.1.3.3.3.1.1.1.1.2.2">𝐰</ci><apply id="A10.E43.m2.1.1.1.1.3.3.3.1.1.1.1.2.3.cmml" xref="A10.E43.m2.1.1.1.1.3.3.3.1.1.1.1.2.3"><times id="A10.E43.m2.1.1.1.1.3.3.3.1.1.1.1.2.3.1.cmml" xref="A10.E43.m2.1.1.1.1.3.3.3.1.1.1.1.2.3.1"></times><ci id="A10.E43.m2.1.1.1.1.3.3.3.1.1.1.1.2.3.2.cmml" xref="A10.E43.m2.1.1.1.1.3.3.3.1.1.1.1.2.3.2">𝑠</ci><ci id="A10.E43.m2.1.1.1.1.3.3.3.1.1.1.1.2.3.3.cmml" xref="A10.E43.m2.1.1.1.1.3.3.3.1.1.1.1.2.3.3">𝑗</ci></apply></apply><apply id="A10.E43.m2.1.1.1.1.3.3.3.1.1.1.1.3.cmml" xref="A10.E43.m2.1.1.1.1.3.3.3.1.1.1.1.3"><csymbol cd="ambiguous" id="A10.E43.m2.1.1.1.1.3.3.3.1.1.1.1.3.1.cmml" xref="A10.E43.m2.1.1.1.1.3.3.3.1.1.1.1.3">subscript</csymbol><ci id="A10.E43.m2.1.1.1.1.3.3.3.1.1.1.1.3.2.cmml" xref="A10.E43.m2.1.1.1.1.3.3.3.1.1.1.1.3.2">𝐰</ci><ci id="A10.E43.m2.1.1.1.1.3.3.3.1.1.1.1.3.3.cmml" xref="A10.E43.m2.1.1.1.1.3.3.3.1.1.1.1.3.3">𝑗</ci></apply></apply></apply></apply></apply></apply><ci id="A10.E43.m2.1.1.1.1.3.5.cmml" xref="A10.E43.m2.1.1.1.1.3.5">𝐶</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A10.E43.m2.1c">\displaystyle:=\sum_{i}^{N_{s}}L(\mathcal{D}_{si},\mathbf{w}_{s})-\lambda\sum_{j}|\mathbf{w}_{sj}-\mathbf{w}_{j}|+C,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(43)</span></td>
</tr></tbody>
<tbody id="A10.E44"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math id="A10.E44.m1.1" class="ltx_Math" alttext="\displaystyle\mathcal{L}(\mathbf{w})" display="inline"><semantics id="A10.E44.m1.1a"><mrow id="A10.E44.m1.1.2" xref="A10.E44.m1.1.2.cmml"><mi class="ltx_font_mathcaligraphic" id="A10.E44.m1.1.2.2" xref="A10.E44.m1.1.2.2.cmml">ℒ</mi><mo lspace="0em" rspace="0em" id="A10.E44.m1.1.2.1" xref="A10.E44.m1.1.2.1.cmml">​</mo><mrow id="A10.E44.m1.1.2.3.2" xref="A10.E44.m1.1.2.cmml"><mo stretchy="false" id="A10.E44.m1.1.2.3.2.1" xref="A10.E44.m1.1.2.cmml">(</mo><mi id="A10.E44.m1.1.1" xref="A10.E44.m1.1.1.cmml">𝐰</mi><mo stretchy="false" id="A10.E44.m1.1.2.3.2.2" xref="A10.E44.m1.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="A10.E44.m1.1b"><apply id="A10.E44.m1.1.2.cmml" xref="A10.E44.m1.1.2"><times id="A10.E44.m1.1.2.1.cmml" xref="A10.E44.m1.1.2.1"></times><ci id="A10.E44.m1.1.2.2.cmml" xref="A10.E44.m1.1.2.2">ℒ</ci><ci id="A10.E44.m1.1.1.cmml" xref="A10.E44.m1.1.1">𝐰</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A10.E44.m1.1c">\displaystyle\mathcal{L}(\mathbf{w})</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math id="A10.E44.m2.3" class="ltx_Math" alttext="\displaystyle:=\sum_{s}\mathcal{L}_{s}(\mathcal{D}_{s},\mathbf{w},\mathbf{w}_{s})" display="inline"><semantics id="A10.E44.m2.3a"><mrow id="A10.E44.m2.3.3" xref="A10.E44.m2.3.3.cmml"><mi id="A10.E44.m2.3.3.4" xref="A10.E44.m2.3.3.4.cmml"></mi><mo lspace="0.278em" rspace="0.278em" id="A10.E44.m2.3.3.3" xref="A10.E44.m2.3.3.3.cmml">:=</mo><mrow id="A10.E44.m2.3.3.2" xref="A10.E44.m2.3.3.2.cmml"><mstyle displaystyle="true" id="A10.E44.m2.3.3.2.3" xref="A10.E44.m2.3.3.2.3.cmml"><munder id="A10.E44.m2.3.3.2.3a" xref="A10.E44.m2.3.3.2.3.cmml"><mo movablelimits="false" id="A10.E44.m2.3.3.2.3.2" xref="A10.E44.m2.3.3.2.3.2.cmml">∑</mo><mi id="A10.E44.m2.3.3.2.3.3" xref="A10.E44.m2.3.3.2.3.3.cmml">s</mi></munder></mstyle><mrow id="A10.E44.m2.3.3.2.2" xref="A10.E44.m2.3.3.2.2.cmml"><msub id="A10.E44.m2.3.3.2.2.4" xref="A10.E44.m2.3.3.2.2.4.cmml"><mi class="ltx_font_mathcaligraphic" id="A10.E44.m2.3.3.2.2.4.2" xref="A10.E44.m2.3.3.2.2.4.2.cmml">ℒ</mi><mi id="A10.E44.m2.3.3.2.2.4.3" xref="A10.E44.m2.3.3.2.2.4.3.cmml">s</mi></msub><mo lspace="0em" rspace="0em" id="A10.E44.m2.3.3.2.2.3" xref="A10.E44.m2.3.3.2.2.3.cmml">​</mo><mrow id="A10.E44.m2.3.3.2.2.2.2" xref="A10.E44.m2.3.3.2.2.2.3.cmml"><mo stretchy="false" id="A10.E44.m2.3.3.2.2.2.2.3" xref="A10.E44.m2.3.3.2.2.2.3.cmml">(</mo><msub id="A10.E44.m2.2.2.1.1.1.1.1" xref="A10.E44.m2.2.2.1.1.1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="A10.E44.m2.2.2.1.1.1.1.1.2" xref="A10.E44.m2.2.2.1.1.1.1.1.2.cmml">𝒟</mi><mi id="A10.E44.m2.2.2.1.1.1.1.1.3" xref="A10.E44.m2.2.2.1.1.1.1.1.3.cmml">s</mi></msub><mo id="A10.E44.m2.3.3.2.2.2.2.4" xref="A10.E44.m2.3.3.2.2.2.3.cmml">,</mo><mi id="A10.E44.m2.1.1" xref="A10.E44.m2.1.1.cmml">𝐰</mi><mo id="A10.E44.m2.3.3.2.2.2.2.5" xref="A10.E44.m2.3.3.2.2.2.3.cmml">,</mo><msub id="A10.E44.m2.3.3.2.2.2.2.2" xref="A10.E44.m2.3.3.2.2.2.2.2.cmml"><mi id="A10.E44.m2.3.3.2.2.2.2.2.2" xref="A10.E44.m2.3.3.2.2.2.2.2.2.cmml">𝐰</mi><mi id="A10.E44.m2.3.3.2.2.2.2.2.3" xref="A10.E44.m2.3.3.2.2.2.2.2.3.cmml">s</mi></msub><mo stretchy="false" id="A10.E44.m2.3.3.2.2.2.2.6" xref="A10.E44.m2.3.3.2.2.2.3.cmml">)</mo></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="A10.E44.m2.3b"><apply id="A10.E44.m2.3.3.cmml" xref="A10.E44.m2.3.3"><csymbol cd="latexml" id="A10.E44.m2.3.3.3.cmml" xref="A10.E44.m2.3.3.3">assign</csymbol><csymbol cd="latexml" id="A10.E44.m2.3.3.4.cmml" xref="A10.E44.m2.3.3.4">absent</csymbol><apply id="A10.E44.m2.3.3.2.cmml" xref="A10.E44.m2.3.3.2"><apply id="A10.E44.m2.3.3.2.3.cmml" xref="A10.E44.m2.3.3.2.3"><csymbol cd="ambiguous" id="A10.E44.m2.3.3.2.3.1.cmml" xref="A10.E44.m2.3.3.2.3">subscript</csymbol><sum id="A10.E44.m2.3.3.2.3.2.cmml" xref="A10.E44.m2.3.3.2.3.2"></sum><ci id="A10.E44.m2.3.3.2.3.3.cmml" xref="A10.E44.m2.3.3.2.3.3">𝑠</ci></apply><apply id="A10.E44.m2.3.3.2.2.cmml" xref="A10.E44.m2.3.3.2.2"><times id="A10.E44.m2.3.3.2.2.3.cmml" xref="A10.E44.m2.3.3.2.2.3"></times><apply id="A10.E44.m2.3.3.2.2.4.cmml" xref="A10.E44.m2.3.3.2.2.4"><csymbol cd="ambiguous" id="A10.E44.m2.3.3.2.2.4.1.cmml" xref="A10.E44.m2.3.3.2.2.4">subscript</csymbol><ci id="A10.E44.m2.3.3.2.2.4.2.cmml" xref="A10.E44.m2.3.3.2.2.4.2">ℒ</ci><ci id="A10.E44.m2.3.3.2.2.4.3.cmml" xref="A10.E44.m2.3.3.2.2.4.3">𝑠</ci></apply><vector id="A10.E44.m2.3.3.2.2.2.3.cmml" xref="A10.E44.m2.3.3.2.2.2.2"><apply id="A10.E44.m2.2.2.1.1.1.1.1.cmml" xref="A10.E44.m2.2.2.1.1.1.1.1"><csymbol cd="ambiguous" id="A10.E44.m2.2.2.1.1.1.1.1.1.cmml" xref="A10.E44.m2.2.2.1.1.1.1.1">subscript</csymbol><ci id="A10.E44.m2.2.2.1.1.1.1.1.2.cmml" xref="A10.E44.m2.2.2.1.1.1.1.1.2">𝒟</ci><ci id="A10.E44.m2.2.2.1.1.1.1.1.3.cmml" xref="A10.E44.m2.2.2.1.1.1.1.1.3">𝑠</ci></apply><ci id="A10.E44.m2.1.1.cmml" xref="A10.E44.m2.1.1">𝐰</ci><apply id="A10.E44.m2.3.3.2.2.2.2.2.cmml" xref="A10.E44.m2.3.3.2.2.2.2.2"><csymbol cd="ambiguous" id="A10.E44.m2.3.3.2.2.2.2.2.1.cmml" xref="A10.E44.m2.3.3.2.2.2.2.2">subscript</csymbol><ci id="A10.E44.m2.3.3.2.2.2.2.2.2.cmml" xref="A10.E44.m2.3.3.2.2.2.2.2.2">𝐰</ci><ci id="A10.E44.m2.3.3.2.2.2.2.2.3.cmml" xref="A10.E44.m2.3.3.2.2.2.2.2.3">𝑠</ci></apply></vector></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A10.E44.m2.3c">\displaystyle:=\sum_{s}\mathcal{L}_{s}(\mathcal{D}_{s},\mathbf{w},\mathbf{w}_{s})</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(44)</span></td>
</tr></tbody>
</table>
<p id="A10.SS1.p1.13" class="ltx_p">where again the global objective is a sum of all the local objectives and <math id="A10.SS1.p1.2.m1.1" class="ltx_Math" alttext="C" display="inline"><semantics id="A10.SS1.p1.2.m1.1a"><mi id="A10.SS1.p1.2.m1.1.1" xref="A10.SS1.p1.2.m1.1.1.cmml">C</mi><annotation-xml encoding="MathML-Content" id="A10.SS1.p1.2.m1.1b"><ci id="A10.SS1.p1.2.m1.1.1.cmml" xref="A10.SS1.p1.2.m1.1.1">𝐶</ci></annotation-xml><annotation encoding="application/x-tex" id="A10.SS1.p1.2.m1.1c">C</annotation></semantics></math> is a constant independent of the optimization. We can then proceed, in a similar fashion to traditional “cross-device” FL, by selecting a subset of shards <math id="A10.SS1.p1.3.m2.1" class="ltx_Math" alttext="B" display="inline"><semantics id="A10.SS1.p1.3.m2.1a"><mi id="A10.SS1.p1.3.m2.1.1" xref="A10.SS1.p1.3.m2.1.1.cmml">B</mi><annotation-xml encoding="MathML-Content" id="A10.SS1.p1.3.m2.1b"><ci id="A10.SS1.p1.3.m2.1.1.cmml" xref="A10.SS1.p1.3.m2.1.1">𝐵</ci></annotation-xml><annotation encoding="application/x-tex" id="A10.SS1.p1.3.m2.1c">B</annotation></semantics></math> to approximate the global objective. On these specific shards, we will then optimize <math id="A10.SS1.p1.4.m3.1" class="ltx_Math" alttext="\mathcal{L}_{s}" display="inline"><semantics id="A10.SS1.p1.4.m3.1a"><msub id="A10.SS1.p1.4.m3.1.1" xref="A10.SS1.p1.4.m3.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="A10.SS1.p1.4.m3.1.1.2" xref="A10.SS1.p1.4.m3.1.1.2.cmml">ℒ</mi><mi id="A10.SS1.p1.4.m3.1.1.3" xref="A10.SS1.p1.4.m3.1.1.3.cmml">s</mi></msub><annotation-xml encoding="MathML-Content" id="A10.SS1.p1.4.m3.1b"><apply id="A10.SS1.p1.4.m3.1.1.cmml" xref="A10.SS1.p1.4.m3.1.1"><csymbol cd="ambiguous" id="A10.SS1.p1.4.m3.1.1.1.cmml" xref="A10.SS1.p1.4.m3.1.1">subscript</csymbol><ci id="A10.SS1.p1.4.m3.1.1.2.cmml" xref="A10.SS1.p1.4.m3.1.1.2">ℒ</ci><ci id="A10.SS1.p1.4.m3.1.1.3.cmml" xref="A10.SS1.p1.4.m3.1.1.3">𝑠</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A10.SS1.p1.4.m3.1c">\mathcal{L}_{s}</annotation></semantics></math> with respect to <math id="A10.SS1.p1.5.m4.1" class="ltx_Math" alttext="\mathbf{w}_{s}" display="inline"><semantics id="A10.SS1.p1.5.m4.1a"><msub id="A10.SS1.p1.5.m4.1.1" xref="A10.SS1.p1.5.m4.1.1.cmml"><mi id="A10.SS1.p1.5.m4.1.1.2" xref="A10.SS1.p1.5.m4.1.1.2.cmml">𝐰</mi><mi id="A10.SS1.p1.5.m4.1.1.3" xref="A10.SS1.p1.5.m4.1.1.3.cmml">s</mi></msub><annotation-xml encoding="MathML-Content" id="A10.SS1.p1.5.m4.1b"><apply id="A10.SS1.p1.5.m4.1.1.cmml" xref="A10.SS1.p1.5.m4.1.1"><csymbol cd="ambiguous" id="A10.SS1.p1.5.m4.1.1.1.cmml" xref="A10.SS1.p1.5.m4.1.1">subscript</csymbol><ci id="A10.SS1.p1.5.m4.1.1.2.cmml" xref="A10.SS1.p1.5.m4.1.1.2">𝐰</ci><ci id="A10.SS1.p1.5.m4.1.1.3.cmml" xref="A10.SS1.p1.5.m4.1.1.3">𝑠</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A10.SS1.p1.5.m4.1c">\mathbf{w}_{s}</annotation></semantics></math> while keeping <math id="A10.SS1.p1.6.m5.1" class="ltx_Math" alttext="\mathbf{w}" display="inline"><semantics id="A10.SS1.p1.6.m5.1a"><mi id="A10.SS1.p1.6.m5.1.1" xref="A10.SS1.p1.6.m5.1.1.cmml">𝐰</mi><annotation-xml encoding="MathML-Content" id="A10.SS1.p1.6.m5.1b"><ci id="A10.SS1.p1.6.m5.1.1.cmml" xref="A10.SS1.p1.6.m5.1.1">𝐰</ci></annotation-xml><annotation encoding="application/x-tex" id="A10.SS1.p1.6.m5.1c">\mathbf{w}</annotation></semantics></math> fixed. Interestingly, due to the <math id="A10.SS1.p1.7.m6.1" class="ltx_Math" alttext="L_{1}" display="inline"><semantics id="A10.SS1.p1.7.m6.1a"><msub id="A10.SS1.p1.7.m6.1.1" xref="A10.SS1.p1.7.m6.1.1.cmml"><mi id="A10.SS1.p1.7.m6.1.1.2" xref="A10.SS1.p1.7.m6.1.1.2.cmml">L</mi><mn id="A10.SS1.p1.7.m6.1.1.3" xref="A10.SS1.p1.7.m6.1.1.3.cmml">1</mn></msub><annotation-xml encoding="MathML-Content" id="A10.SS1.p1.7.m6.1b"><apply id="A10.SS1.p1.7.m6.1.1.cmml" xref="A10.SS1.p1.7.m6.1.1"><csymbol cd="ambiguous" id="A10.SS1.p1.7.m6.1.1.1.cmml" xref="A10.SS1.p1.7.m6.1.1">subscript</csymbol><ci id="A10.SS1.p1.7.m6.1.1.2.cmml" xref="A10.SS1.p1.7.m6.1.1.2">𝐿</ci><cn type="integer" id="A10.SS1.p1.7.m6.1.1.3.cmml" xref="A10.SS1.p1.7.m6.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A10.SS1.p1.7.m6.1c">L_{1}</annotation></semantics></math> regularization term that appears in the local objective, we will have, depending on the regularization strength <math id="A10.SS1.p1.8.m7.1" class="ltx_Math" alttext="\lambda" display="inline"><semantics id="A10.SS1.p1.8.m7.1a"><mi id="A10.SS1.p1.8.m7.1.1" xref="A10.SS1.p1.8.m7.1.1.cmml">λ</mi><annotation-xml encoding="MathML-Content" id="A10.SS1.p1.8.m7.1b"><ci id="A10.SS1.p1.8.m7.1.1.cmml" xref="A10.SS1.p1.8.m7.1.1">𝜆</ci></annotation-xml><annotation encoding="application/x-tex" id="A10.SS1.p1.8.m7.1c">\lambda</annotation></semantics></math>, several local parameters <math id="A10.SS1.p1.9.m8.1" class="ltx_Math" alttext="\mathbf{w}_{s}" display="inline"><semantics id="A10.SS1.p1.9.m8.1a"><msub id="A10.SS1.p1.9.m8.1.1" xref="A10.SS1.p1.9.m8.1.1.cmml"><mi id="A10.SS1.p1.9.m8.1.1.2" xref="A10.SS1.p1.9.m8.1.1.2.cmml">𝐰</mi><mi id="A10.SS1.p1.9.m8.1.1.3" xref="A10.SS1.p1.9.m8.1.1.3.cmml">s</mi></msub><annotation-xml encoding="MathML-Content" id="A10.SS1.p1.9.m8.1b"><apply id="A10.SS1.p1.9.m8.1.1.cmml" xref="A10.SS1.p1.9.m8.1.1"><csymbol cd="ambiguous" id="A10.SS1.p1.9.m8.1.1.1.cmml" xref="A10.SS1.p1.9.m8.1.1">subscript</csymbol><ci id="A10.SS1.p1.9.m8.1.1.2.cmml" xref="A10.SS1.p1.9.m8.1.1.2">𝐰</ci><ci id="A10.SS1.p1.9.m8.1.1.3.cmml" xref="A10.SS1.p1.9.m8.1.1.3">𝑠</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A10.SS1.p1.9.m8.1c">\mathbf{w}_{s}</annotation></semantics></math> that will be exactly equal to the server parameters <math id="A10.SS1.p1.10.m9.1" class="ltx_Math" alttext="\mathbf{w}" display="inline"><semantics id="A10.SS1.p1.10.m9.1a"><mi id="A10.SS1.p1.10.m9.1.1" xref="A10.SS1.p1.10.m9.1.1.cmml">𝐰</mi><annotation-xml encoding="MathML-Content" id="A10.SS1.p1.10.m9.1b"><ci id="A10.SS1.p1.10.m9.1.1.cmml" xref="A10.SS1.p1.10.m9.1.1">𝐰</ci></annotation-xml><annotation encoding="application/x-tex" id="A10.SS1.p1.10.m9.1c">\mathbf{w}</annotation></semantics></math> even after optimization. Now given the optimized parameters from these shards, <math id="A10.SS1.p1.11.m10.1" class="ltx_Math" alttext="\mathbf{w}_{s}^{*}" display="inline"><semantics id="A10.SS1.p1.11.m10.1a"><msubsup id="A10.SS1.p1.11.m10.1.1" xref="A10.SS1.p1.11.m10.1.1.cmml"><mi id="A10.SS1.p1.11.m10.1.1.2.2" xref="A10.SS1.p1.11.m10.1.1.2.2.cmml">𝐰</mi><mi id="A10.SS1.p1.11.m10.1.1.2.3" xref="A10.SS1.p1.11.m10.1.1.2.3.cmml">s</mi><mo id="A10.SS1.p1.11.m10.1.1.3" xref="A10.SS1.p1.11.m10.1.1.3.cmml">∗</mo></msubsup><annotation-xml encoding="MathML-Content" id="A10.SS1.p1.11.m10.1b"><apply id="A10.SS1.p1.11.m10.1.1.cmml" xref="A10.SS1.p1.11.m10.1.1"><csymbol cd="ambiguous" id="A10.SS1.p1.11.m10.1.1.1.cmml" xref="A10.SS1.p1.11.m10.1.1">superscript</csymbol><apply id="A10.SS1.p1.11.m10.1.1.2.cmml" xref="A10.SS1.p1.11.m10.1.1"><csymbol cd="ambiguous" id="A10.SS1.p1.11.m10.1.1.2.1.cmml" xref="A10.SS1.p1.11.m10.1.1">subscript</csymbol><ci id="A10.SS1.p1.11.m10.1.1.2.2.cmml" xref="A10.SS1.p1.11.m10.1.1.2.2">𝐰</ci><ci id="A10.SS1.p1.11.m10.1.1.2.3.cmml" xref="A10.SS1.p1.11.m10.1.1.2.3">𝑠</ci></apply><times id="A10.SS1.p1.11.m10.1.1.3.cmml" xref="A10.SS1.p1.11.m10.1.1.3"></times></apply></annotation-xml><annotation encoding="application/x-tex" id="A10.SS1.p1.11.m10.1c">\mathbf{w}_{s}^{*}</annotation></semantics></math>, we will update the server parameters <math id="A10.SS1.p1.12.m11.1" class="ltx_Math" alttext="\mathbf{w}" display="inline"><semantics id="A10.SS1.p1.12.m11.1a"><mi id="A10.SS1.p1.12.m11.1.1" xref="A10.SS1.p1.12.m11.1.1.cmml">𝐰</mi><annotation-xml encoding="MathML-Content" id="A10.SS1.p1.12.m11.1b"><ci id="A10.SS1.p1.12.m11.1.1.cmml" xref="A10.SS1.p1.12.m11.1.1">𝐰</ci></annotation-xml><annotation encoding="application/x-tex" id="A10.SS1.p1.12.m11.1c">\mathbf{w}</annotation></semantics></math> for the M-step by either a gradient update or a closed form solution. Taking the derivative of the global objective with respect to a <math id="A10.SS1.p1.13.m12.1" class="ltx_Math" alttext="\mathbf{w}_{j}" display="inline"><semantics id="A10.SS1.p1.13.m12.1a"><msub id="A10.SS1.p1.13.m12.1.1" xref="A10.SS1.p1.13.m12.1.1.cmml"><mi id="A10.SS1.p1.13.m12.1.1.2" xref="A10.SS1.p1.13.m12.1.1.2.cmml">𝐰</mi><mi id="A10.SS1.p1.13.m12.1.1.3" xref="A10.SS1.p1.13.m12.1.1.3.cmml">j</mi></msub><annotation-xml encoding="MathML-Content" id="A10.SS1.p1.13.m12.1b"><apply id="A10.SS1.p1.13.m12.1.1.cmml" xref="A10.SS1.p1.13.m12.1.1"><csymbol cd="ambiguous" id="A10.SS1.p1.13.m12.1.1.1.cmml" xref="A10.SS1.p1.13.m12.1.1">subscript</csymbol><ci id="A10.SS1.p1.13.m12.1.1.2.cmml" xref="A10.SS1.p1.13.m12.1.1.2">𝐰</ci><ci id="A10.SS1.p1.13.m12.1.1.3.cmml" xref="A10.SS1.p1.13.m12.1.1.3">𝑗</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A10.SS1.p1.13.m12.1c">\mathbf{w}_{j}</annotation></semantics></math> we see that it has the following simple form</p>
<table id="A10.EGx37" class="ltx_equationgroup ltx_eqn_align ltx_eqn_table">

<tbody id="A10.E45"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math id="A10.E45.m1.1" class="ltx_Math" alttext="\displaystyle\frac{\partial{L}}{\partial\mathbf{w_{j}}}=\lambda\sum_{s\in B}\text{sign}(\mathbf{w}_{sj}-\mathbf{w}_{j})." display="inline"><semantics id="A10.E45.m1.1a"><mrow id="A10.E45.m1.1.1.1" xref="A10.E45.m1.1.1.1.1.cmml"><mrow id="A10.E45.m1.1.1.1.1" xref="A10.E45.m1.1.1.1.1.cmml"><mstyle displaystyle="true" id="A10.E45.m1.1.1.1.1.3" xref="A10.E45.m1.1.1.1.1.3.cmml"><mfrac id="A10.E45.m1.1.1.1.1.3a" xref="A10.E45.m1.1.1.1.1.3.cmml"><mrow id="A10.E45.m1.1.1.1.1.3.2" xref="A10.E45.m1.1.1.1.1.3.2.cmml"><mo rspace="0em" id="A10.E45.m1.1.1.1.1.3.2.1" xref="A10.E45.m1.1.1.1.1.3.2.1.cmml">∂</mo><mi id="A10.E45.m1.1.1.1.1.3.2.2" xref="A10.E45.m1.1.1.1.1.3.2.2.cmml">L</mi></mrow><mrow id="A10.E45.m1.1.1.1.1.3.3" xref="A10.E45.m1.1.1.1.1.3.3.cmml"><mo rspace="0em" id="A10.E45.m1.1.1.1.1.3.3.1" xref="A10.E45.m1.1.1.1.1.3.3.1.cmml">∂</mo><msub id="A10.E45.m1.1.1.1.1.3.3.2" xref="A10.E45.m1.1.1.1.1.3.3.2.cmml"><mi id="A10.E45.m1.1.1.1.1.3.3.2.2" xref="A10.E45.m1.1.1.1.1.3.3.2.2.cmml">𝐰</mi><mi id="A10.E45.m1.1.1.1.1.3.3.2.3" xref="A10.E45.m1.1.1.1.1.3.3.2.3.cmml">𝐣</mi></msub></mrow></mfrac></mstyle><mo id="A10.E45.m1.1.1.1.1.2" xref="A10.E45.m1.1.1.1.1.2.cmml">=</mo><mrow id="A10.E45.m1.1.1.1.1.1" xref="A10.E45.m1.1.1.1.1.1.cmml"><mi id="A10.E45.m1.1.1.1.1.1.3" xref="A10.E45.m1.1.1.1.1.1.3.cmml">λ</mi><mo lspace="0em" rspace="0em" id="A10.E45.m1.1.1.1.1.1.2" xref="A10.E45.m1.1.1.1.1.1.2.cmml">​</mo><mrow id="A10.E45.m1.1.1.1.1.1.1" xref="A10.E45.m1.1.1.1.1.1.1.cmml"><mstyle displaystyle="true" id="A10.E45.m1.1.1.1.1.1.1.2" xref="A10.E45.m1.1.1.1.1.1.1.2.cmml"><munder id="A10.E45.m1.1.1.1.1.1.1.2a" xref="A10.E45.m1.1.1.1.1.1.1.2.cmml"><mo movablelimits="false" id="A10.E45.m1.1.1.1.1.1.1.2.2" xref="A10.E45.m1.1.1.1.1.1.1.2.2.cmml">∑</mo><mrow id="A10.E45.m1.1.1.1.1.1.1.2.3" xref="A10.E45.m1.1.1.1.1.1.1.2.3.cmml"><mi id="A10.E45.m1.1.1.1.1.1.1.2.3.2" xref="A10.E45.m1.1.1.1.1.1.1.2.3.2.cmml">s</mi><mo id="A10.E45.m1.1.1.1.1.1.1.2.3.1" xref="A10.E45.m1.1.1.1.1.1.1.2.3.1.cmml">∈</mo><mi id="A10.E45.m1.1.1.1.1.1.1.2.3.3" xref="A10.E45.m1.1.1.1.1.1.1.2.3.3.cmml">B</mi></mrow></munder></mstyle><mrow id="A10.E45.m1.1.1.1.1.1.1.1" xref="A10.E45.m1.1.1.1.1.1.1.1.cmml"><mtext id="A10.E45.m1.1.1.1.1.1.1.1.3" xref="A10.E45.m1.1.1.1.1.1.1.1.3a.cmml">sign</mtext><mo lspace="0em" rspace="0em" id="A10.E45.m1.1.1.1.1.1.1.1.2" xref="A10.E45.m1.1.1.1.1.1.1.1.2.cmml">​</mo><mrow id="A10.E45.m1.1.1.1.1.1.1.1.1.1" xref="A10.E45.m1.1.1.1.1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="A10.E45.m1.1.1.1.1.1.1.1.1.1.2" xref="A10.E45.m1.1.1.1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="A10.E45.m1.1.1.1.1.1.1.1.1.1.1" xref="A10.E45.m1.1.1.1.1.1.1.1.1.1.1.cmml"><msub id="A10.E45.m1.1.1.1.1.1.1.1.1.1.1.2" xref="A10.E45.m1.1.1.1.1.1.1.1.1.1.1.2.cmml"><mi id="A10.E45.m1.1.1.1.1.1.1.1.1.1.1.2.2" xref="A10.E45.m1.1.1.1.1.1.1.1.1.1.1.2.2.cmml">𝐰</mi><mrow id="A10.E45.m1.1.1.1.1.1.1.1.1.1.1.2.3" xref="A10.E45.m1.1.1.1.1.1.1.1.1.1.1.2.3.cmml"><mi id="A10.E45.m1.1.1.1.1.1.1.1.1.1.1.2.3.2" xref="A10.E45.m1.1.1.1.1.1.1.1.1.1.1.2.3.2.cmml">s</mi><mo lspace="0em" rspace="0em" id="A10.E45.m1.1.1.1.1.1.1.1.1.1.1.2.3.1" xref="A10.E45.m1.1.1.1.1.1.1.1.1.1.1.2.3.1.cmml">​</mo><mi id="A10.E45.m1.1.1.1.1.1.1.1.1.1.1.2.3.3" xref="A10.E45.m1.1.1.1.1.1.1.1.1.1.1.2.3.3.cmml">j</mi></mrow></msub><mo id="A10.E45.m1.1.1.1.1.1.1.1.1.1.1.1" xref="A10.E45.m1.1.1.1.1.1.1.1.1.1.1.1.cmml">−</mo><msub id="A10.E45.m1.1.1.1.1.1.1.1.1.1.1.3" xref="A10.E45.m1.1.1.1.1.1.1.1.1.1.1.3.cmml"><mi id="A10.E45.m1.1.1.1.1.1.1.1.1.1.1.3.2" xref="A10.E45.m1.1.1.1.1.1.1.1.1.1.1.3.2.cmml">𝐰</mi><mi id="A10.E45.m1.1.1.1.1.1.1.1.1.1.1.3.3" xref="A10.E45.m1.1.1.1.1.1.1.1.1.1.1.3.3.cmml">j</mi></msub></mrow><mo stretchy="false" id="A10.E45.m1.1.1.1.1.1.1.1.1.1.3" xref="A10.E45.m1.1.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow></mrow></mrow><mo lspace="0em" id="A10.E45.m1.1.1.1.2" xref="A10.E45.m1.1.1.1.1.cmml">.</mo></mrow><annotation-xml encoding="MathML-Content" id="A10.E45.m1.1b"><apply id="A10.E45.m1.1.1.1.1.cmml" xref="A10.E45.m1.1.1.1"><eq id="A10.E45.m1.1.1.1.1.2.cmml" xref="A10.E45.m1.1.1.1.1.2"></eq><apply id="A10.E45.m1.1.1.1.1.3.cmml" xref="A10.E45.m1.1.1.1.1.3"><divide id="A10.E45.m1.1.1.1.1.3.1.cmml" xref="A10.E45.m1.1.1.1.1.3"></divide><apply id="A10.E45.m1.1.1.1.1.3.2.cmml" xref="A10.E45.m1.1.1.1.1.3.2"><partialdiff id="A10.E45.m1.1.1.1.1.3.2.1.cmml" xref="A10.E45.m1.1.1.1.1.3.2.1"></partialdiff><ci id="A10.E45.m1.1.1.1.1.3.2.2.cmml" xref="A10.E45.m1.1.1.1.1.3.2.2">𝐿</ci></apply><apply id="A10.E45.m1.1.1.1.1.3.3.cmml" xref="A10.E45.m1.1.1.1.1.3.3"><partialdiff id="A10.E45.m1.1.1.1.1.3.3.1.cmml" xref="A10.E45.m1.1.1.1.1.3.3.1"></partialdiff><apply id="A10.E45.m1.1.1.1.1.3.3.2.cmml" xref="A10.E45.m1.1.1.1.1.3.3.2"><csymbol cd="ambiguous" id="A10.E45.m1.1.1.1.1.3.3.2.1.cmml" xref="A10.E45.m1.1.1.1.1.3.3.2">subscript</csymbol><ci id="A10.E45.m1.1.1.1.1.3.3.2.2.cmml" xref="A10.E45.m1.1.1.1.1.3.3.2.2">𝐰</ci><ci id="A10.E45.m1.1.1.1.1.3.3.2.3.cmml" xref="A10.E45.m1.1.1.1.1.3.3.2.3">𝐣</ci></apply></apply></apply><apply id="A10.E45.m1.1.1.1.1.1.cmml" xref="A10.E45.m1.1.1.1.1.1"><times id="A10.E45.m1.1.1.1.1.1.2.cmml" xref="A10.E45.m1.1.1.1.1.1.2"></times><ci id="A10.E45.m1.1.1.1.1.1.3.cmml" xref="A10.E45.m1.1.1.1.1.1.3">𝜆</ci><apply id="A10.E45.m1.1.1.1.1.1.1.cmml" xref="A10.E45.m1.1.1.1.1.1.1"><apply id="A10.E45.m1.1.1.1.1.1.1.2.cmml" xref="A10.E45.m1.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="A10.E45.m1.1.1.1.1.1.1.2.1.cmml" xref="A10.E45.m1.1.1.1.1.1.1.2">subscript</csymbol><sum id="A10.E45.m1.1.1.1.1.1.1.2.2.cmml" xref="A10.E45.m1.1.1.1.1.1.1.2.2"></sum><apply id="A10.E45.m1.1.1.1.1.1.1.2.3.cmml" xref="A10.E45.m1.1.1.1.1.1.1.2.3"><in id="A10.E45.m1.1.1.1.1.1.1.2.3.1.cmml" xref="A10.E45.m1.1.1.1.1.1.1.2.3.1"></in><ci id="A10.E45.m1.1.1.1.1.1.1.2.3.2.cmml" xref="A10.E45.m1.1.1.1.1.1.1.2.3.2">𝑠</ci><ci id="A10.E45.m1.1.1.1.1.1.1.2.3.3.cmml" xref="A10.E45.m1.1.1.1.1.1.1.2.3.3">𝐵</ci></apply></apply><apply id="A10.E45.m1.1.1.1.1.1.1.1.cmml" xref="A10.E45.m1.1.1.1.1.1.1.1"><times id="A10.E45.m1.1.1.1.1.1.1.1.2.cmml" xref="A10.E45.m1.1.1.1.1.1.1.1.2"></times><ci id="A10.E45.m1.1.1.1.1.1.1.1.3a.cmml" xref="A10.E45.m1.1.1.1.1.1.1.1.3"><mtext id="A10.E45.m1.1.1.1.1.1.1.1.3.cmml" xref="A10.E45.m1.1.1.1.1.1.1.1.3">sign</mtext></ci><apply id="A10.E45.m1.1.1.1.1.1.1.1.1.1.1.cmml" xref="A10.E45.m1.1.1.1.1.1.1.1.1.1"><minus id="A10.E45.m1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="A10.E45.m1.1.1.1.1.1.1.1.1.1.1.1"></minus><apply id="A10.E45.m1.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="A10.E45.m1.1.1.1.1.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="A10.E45.m1.1.1.1.1.1.1.1.1.1.1.2.1.cmml" xref="A10.E45.m1.1.1.1.1.1.1.1.1.1.1.2">subscript</csymbol><ci id="A10.E45.m1.1.1.1.1.1.1.1.1.1.1.2.2.cmml" xref="A10.E45.m1.1.1.1.1.1.1.1.1.1.1.2.2">𝐰</ci><apply id="A10.E45.m1.1.1.1.1.1.1.1.1.1.1.2.3.cmml" xref="A10.E45.m1.1.1.1.1.1.1.1.1.1.1.2.3"><times id="A10.E45.m1.1.1.1.1.1.1.1.1.1.1.2.3.1.cmml" xref="A10.E45.m1.1.1.1.1.1.1.1.1.1.1.2.3.1"></times><ci id="A10.E45.m1.1.1.1.1.1.1.1.1.1.1.2.3.2.cmml" xref="A10.E45.m1.1.1.1.1.1.1.1.1.1.1.2.3.2">𝑠</ci><ci id="A10.E45.m1.1.1.1.1.1.1.1.1.1.1.2.3.3.cmml" xref="A10.E45.m1.1.1.1.1.1.1.1.1.1.1.2.3.3">𝑗</ci></apply></apply><apply id="A10.E45.m1.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="A10.E45.m1.1.1.1.1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="A10.E45.m1.1.1.1.1.1.1.1.1.1.1.3.1.cmml" xref="A10.E45.m1.1.1.1.1.1.1.1.1.1.1.3">subscript</csymbol><ci id="A10.E45.m1.1.1.1.1.1.1.1.1.1.1.3.2.cmml" xref="A10.E45.m1.1.1.1.1.1.1.1.1.1.1.3.2">𝐰</ci><ci id="A10.E45.m1.1.1.1.1.1.1.1.1.1.1.3.3.cmml" xref="A10.E45.m1.1.1.1.1.1.1.1.1.1.1.3.3">𝑗</ci></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A10.E45.m1.1c">\displaystyle\frac{\partial{L}}{\partial\mathbf{w_{j}}}=\lambda\sum_{s\in B}\text{sign}(\mathbf{w}_{sj}-\mathbf{w}_{j}).</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(45)</span></td>
</tr></tbody>
</table>
<p id="A10.SS1.p1.15" class="ltx_p">By setting it to zero, we see that the closed form solution is again easy to obtain</p>
<table id="A10.EGx38" class="ltx_equationgroup ltx_eqn_align ltx_eqn_table">

<tbody id="A10.E46"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math id="A10.E46.m1.4" class="ltx_Math" alttext="\displaystyle\frac{\partial{L}}{\partial\mathbf{w}_{j}}=0\Rightarrow\lambda\sum_{s\in B}\text{sign}(\mathbf{w}_{sj}-\mathbf{w}_{j})=0\Rightarrow\mathbf{w}_{j}=\text{median}(\mathbf{w}_{1j},\dots,\mathbf{w}_{Bj})" display="inline"><semantics id="A10.E46.m1.4a"><mrow id="A10.E46.m1.4.4" xref="A10.E46.m1.4.4.cmml"><mstyle displaystyle="true" id="A10.E46.m1.4.4.5" xref="A10.E46.m1.4.4.5.cmml"><mfrac id="A10.E46.m1.4.4.5a" xref="A10.E46.m1.4.4.5.cmml"><mrow id="A10.E46.m1.4.4.5.2" xref="A10.E46.m1.4.4.5.2.cmml"><mo rspace="0em" id="A10.E46.m1.4.4.5.2.1" xref="A10.E46.m1.4.4.5.2.1.cmml">∂</mo><mi id="A10.E46.m1.4.4.5.2.2" xref="A10.E46.m1.4.4.5.2.2.cmml">L</mi></mrow><mrow id="A10.E46.m1.4.4.5.3" xref="A10.E46.m1.4.4.5.3.cmml"><mo rspace="0em" id="A10.E46.m1.4.4.5.3.1" xref="A10.E46.m1.4.4.5.3.1.cmml">∂</mo><msub id="A10.E46.m1.4.4.5.3.2" xref="A10.E46.m1.4.4.5.3.2.cmml"><mi id="A10.E46.m1.4.4.5.3.2.2" xref="A10.E46.m1.4.4.5.3.2.2.cmml">𝐰</mi><mi id="A10.E46.m1.4.4.5.3.2.3" xref="A10.E46.m1.4.4.5.3.2.3.cmml">j</mi></msub></mrow></mfrac></mstyle><mo id="A10.E46.m1.4.4.6" xref="A10.E46.m1.4.4.6.cmml">=</mo><mn id="A10.E46.m1.4.4.7" xref="A10.E46.m1.4.4.7.cmml">0</mn><mo stretchy="false" id="A10.E46.m1.4.4.8" xref="A10.E46.m1.4.4.8.cmml">⇒</mo><mrow id="A10.E46.m1.2.2.1" xref="A10.E46.m1.2.2.1.cmml"><mi id="A10.E46.m1.2.2.1.3" xref="A10.E46.m1.2.2.1.3.cmml">λ</mi><mo lspace="0em" rspace="0em" id="A10.E46.m1.2.2.1.2" xref="A10.E46.m1.2.2.1.2.cmml">​</mo><mrow id="A10.E46.m1.2.2.1.1" xref="A10.E46.m1.2.2.1.1.cmml"><mstyle displaystyle="true" id="A10.E46.m1.2.2.1.1.2" xref="A10.E46.m1.2.2.1.1.2.cmml"><munder id="A10.E46.m1.2.2.1.1.2a" xref="A10.E46.m1.2.2.1.1.2.cmml"><mo movablelimits="false" id="A10.E46.m1.2.2.1.1.2.2" xref="A10.E46.m1.2.2.1.1.2.2.cmml">∑</mo><mrow id="A10.E46.m1.2.2.1.1.2.3" xref="A10.E46.m1.2.2.1.1.2.3.cmml"><mi id="A10.E46.m1.2.2.1.1.2.3.2" xref="A10.E46.m1.2.2.1.1.2.3.2.cmml">s</mi><mo id="A10.E46.m1.2.2.1.1.2.3.1" xref="A10.E46.m1.2.2.1.1.2.3.1.cmml">∈</mo><mi id="A10.E46.m1.2.2.1.1.2.3.3" xref="A10.E46.m1.2.2.1.1.2.3.3.cmml">B</mi></mrow></munder></mstyle><mrow id="A10.E46.m1.2.2.1.1.1" xref="A10.E46.m1.2.2.1.1.1.cmml"><mtext id="A10.E46.m1.2.2.1.1.1.3" xref="A10.E46.m1.2.2.1.1.1.3a.cmml">sign</mtext><mo lspace="0em" rspace="0em" id="A10.E46.m1.2.2.1.1.1.2" xref="A10.E46.m1.2.2.1.1.1.2.cmml">​</mo><mrow id="A10.E46.m1.2.2.1.1.1.1.1" xref="A10.E46.m1.2.2.1.1.1.1.1.1.cmml"><mo stretchy="false" id="A10.E46.m1.2.2.1.1.1.1.1.2" xref="A10.E46.m1.2.2.1.1.1.1.1.1.cmml">(</mo><mrow id="A10.E46.m1.2.2.1.1.1.1.1.1" xref="A10.E46.m1.2.2.1.1.1.1.1.1.cmml"><msub id="A10.E46.m1.2.2.1.1.1.1.1.1.2" xref="A10.E46.m1.2.2.1.1.1.1.1.1.2.cmml"><mi id="A10.E46.m1.2.2.1.1.1.1.1.1.2.2" xref="A10.E46.m1.2.2.1.1.1.1.1.1.2.2.cmml">𝐰</mi><mrow id="A10.E46.m1.2.2.1.1.1.1.1.1.2.3" xref="A10.E46.m1.2.2.1.1.1.1.1.1.2.3.cmml"><mi id="A10.E46.m1.2.2.1.1.1.1.1.1.2.3.2" xref="A10.E46.m1.2.2.1.1.1.1.1.1.2.3.2.cmml">s</mi><mo lspace="0em" rspace="0em" id="A10.E46.m1.2.2.1.1.1.1.1.1.2.3.1" xref="A10.E46.m1.2.2.1.1.1.1.1.1.2.3.1.cmml">​</mo><mi id="A10.E46.m1.2.2.1.1.1.1.1.1.2.3.3" xref="A10.E46.m1.2.2.1.1.1.1.1.1.2.3.3.cmml">j</mi></mrow></msub><mo id="A10.E46.m1.2.2.1.1.1.1.1.1.1" xref="A10.E46.m1.2.2.1.1.1.1.1.1.1.cmml">−</mo><msub id="A10.E46.m1.2.2.1.1.1.1.1.1.3" xref="A10.E46.m1.2.2.1.1.1.1.1.1.3.cmml"><mi id="A10.E46.m1.2.2.1.1.1.1.1.1.3.2" xref="A10.E46.m1.2.2.1.1.1.1.1.1.3.2.cmml">𝐰</mi><mi id="A10.E46.m1.2.2.1.1.1.1.1.1.3.3" xref="A10.E46.m1.2.2.1.1.1.1.1.1.3.3.cmml">j</mi></msub></mrow><mo stretchy="false" id="A10.E46.m1.2.2.1.1.1.1.1.3" xref="A10.E46.m1.2.2.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow></mrow><mo id="A10.E46.m1.4.4.9" xref="A10.E46.m1.4.4.9.cmml">=</mo><mn id="A10.E46.m1.4.4.10" xref="A10.E46.m1.4.4.10.cmml">0</mn><mo stretchy="false" id="A10.E46.m1.4.4.11" xref="A10.E46.m1.4.4.11.cmml">⇒</mo><msub id="A10.E46.m1.4.4.12" xref="A10.E46.m1.4.4.12.cmml"><mi id="A10.E46.m1.4.4.12.2" xref="A10.E46.m1.4.4.12.2.cmml">𝐰</mi><mi id="A10.E46.m1.4.4.12.3" xref="A10.E46.m1.4.4.12.3.cmml">j</mi></msub><mo id="A10.E46.m1.4.4.13" xref="A10.E46.m1.4.4.13.cmml">=</mo><mrow id="A10.E46.m1.4.4.3" xref="A10.E46.m1.4.4.3.cmml"><mtext id="A10.E46.m1.4.4.3.4" xref="A10.E46.m1.4.4.3.4a.cmml">median</mtext><mo lspace="0em" rspace="0em" id="A10.E46.m1.4.4.3.3" xref="A10.E46.m1.4.4.3.3.cmml">​</mo><mrow id="A10.E46.m1.4.4.3.2.2" xref="A10.E46.m1.4.4.3.2.3.cmml"><mo stretchy="false" id="A10.E46.m1.4.4.3.2.2.3" xref="A10.E46.m1.4.4.3.2.3.cmml">(</mo><msub id="A10.E46.m1.3.3.2.1.1.1" xref="A10.E46.m1.3.3.2.1.1.1.cmml"><mi id="A10.E46.m1.3.3.2.1.1.1.2" xref="A10.E46.m1.3.3.2.1.1.1.2.cmml">𝐰</mi><mrow id="A10.E46.m1.3.3.2.1.1.1.3" xref="A10.E46.m1.3.3.2.1.1.1.3.cmml"><mn id="A10.E46.m1.3.3.2.1.1.1.3.2" xref="A10.E46.m1.3.3.2.1.1.1.3.2.cmml">1</mn><mo lspace="0em" rspace="0em" id="A10.E46.m1.3.3.2.1.1.1.3.1" xref="A10.E46.m1.3.3.2.1.1.1.3.1.cmml">​</mo><mi id="A10.E46.m1.3.3.2.1.1.1.3.3" xref="A10.E46.m1.3.3.2.1.1.1.3.3.cmml">j</mi></mrow></msub><mo id="A10.E46.m1.4.4.3.2.2.4" xref="A10.E46.m1.4.4.3.2.3.cmml">,</mo><mi mathvariant="normal" id="A10.E46.m1.1.1" xref="A10.E46.m1.1.1.cmml">…</mi><mo id="A10.E46.m1.4.4.3.2.2.5" xref="A10.E46.m1.4.4.3.2.3.cmml">,</mo><msub id="A10.E46.m1.4.4.3.2.2.2" xref="A10.E46.m1.4.4.3.2.2.2.cmml"><mi id="A10.E46.m1.4.4.3.2.2.2.2" xref="A10.E46.m1.4.4.3.2.2.2.2.cmml">𝐰</mi><mrow id="A10.E46.m1.4.4.3.2.2.2.3" xref="A10.E46.m1.4.4.3.2.2.2.3.cmml"><mi id="A10.E46.m1.4.4.3.2.2.2.3.2" xref="A10.E46.m1.4.4.3.2.2.2.3.2.cmml">B</mi><mo lspace="0em" rspace="0em" id="A10.E46.m1.4.4.3.2.2.2.3.1" xref="A10.E46.m1.4.4.3.2.2.2.3.1.cmml">​</mo><mi id="A10.E46.m1.4.4.3.2.2.2.3.3" xref="A10.E46.m1.4.4.3.2.2.2.3.3.cmml">j</mi></mrow></msub><mo stretchy="false" id="A10.E46.m1.4.4.3.2.2.6" xref="A10.E46.m1.4.4.3.2.3.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="A10.E46.m1.4b"><apply id="A10.E46.m1.4.4.cmml" xref="A10.E46.m1.4.4"><and id="A10.E46.m1.4.4a.cmml" xref="A10.E46.m1.4.4"></and><apply id="A10.E46.m1.4.4b.cmml" xref="A10.E46.m1.4.4"><eq id="A10.E46.m1.4.4.6.cmml" xref="A10.E46.m1.4.4.6"></eq><apply id="A10.E46.m1.4.4.5.cmml" xref="A10.E46.m1.4.4.5"><divide id="A10.E46.m1.4.4.5.1.cmml" xref="A10.E46.m1.4.4.5"></divide><apply id="A10.E46.m1.4.4.5.2.cmml" xref="A10.E46.m1.4.4.5.2"><partialdiff id="A10.E46.m1.4.4.5.2.1.cmml" xref="A10.E46.m1.4.4.5.2.1"></partialdiff><ci id="A10.E46.m1.4.4.5.2.2.cmml" xref="A10.E46.m1.4.4.5.2.2">𝐿</ci></apply><apply id="A10.E46.m1.4.4.5.3.cmml" xref="A10.E46.m1.4.4.5.3"><partialdiff id="A10.E46.m1.4.4.5.3.1.cmml" xref="A10.E46.m1.4.4.5.3.1"></partialdiff><apply id="A10.E46.m1.4.4.5.3.2.cmml" xref="A10.E46.m1.4.4.5.3.2"><csymbol cd="ambiguous" id="A10.E46.m1.4.4.5.3.2.1.cmml" xref="A10.E46.m1.4.4.5.3.2">subscript</csymbol><ci id="A10.E46.m1.4.4.5.3.2.2.cmml" xref="A10.E46.m1.4.4.5.3.2.2">𝐰</ci><ci id="A10.E46.m1.4.4.5.3.2.3.cmml" xref="A10.E46.m1.4.4.5.3.2.3">𝑗</ci></apply></apply></apply><cn type="integer" id="A10.E46.m1.4.4.7.cmml" xref="A10.E46.m1.4.4.7">0</cn></apply><apply id="A10.E46.m1.4.4c.cmml" xref="A10.E46.m1.4.4"><ci id="A10.E46.m1.4.4.8.cmml" xref="A10.E46.m1.4.4.8">⇒</ci><share href="#A10.E46.m1.4.4.7.cmml" id="A10.E46.m1.4.4d.cmml" xref="A10.E46.m1.4.4"></share><apply id="A10.E46.m1.2.2.1.cmml" xref="A10.E46.m1.2.2.1"><times id="A10.E46.m1.2.2.1.2.cmml" xref="A10.E46.m1.2.2.1.2"></times><ci id="A10.E46.m1.2.2.1.3.cmml" xref="A10.E46.m1.2.2.1.3">𝜆</ci><apply id="A10.E46.m1.2.2.1.1.cmml" xref="A10.E46.m1.2.2.1.1"><apply id="A10.E46.m1.2.2.1.1.2.cmml" xref="A10.E46.m1.2.2.1.1.2"><csymbol cd="ambiguous" id="A10.E46.m1.2.2.1.1.2.1.cmml" xref="A10.E46.m1.2.2.1.1.2">subscript</csymbol><sum id="A10.E46.m1.2.2.1.1.2.2.cmml" xref="A10.E46.m1.2.2.1.1.2.2"></sum><apply id="A10.E46.m1.2.2.1.1.2.3.cmml" xref="A10.E46.m1.2.2.1.1.2.3"><in id="A10.E46.m1.2.2.1.1.2.3.1.cmml" xref="A10.E46.m1.2.2.1.1.2.3.1"></in><ci id="A10.E46.m1.2.2.1.1.2.3.2.cmml" xref="A10.E46.m1.2.2.1.1.2.3.2">𝑠</ci><ci id="A10.E46.m1.2.2.1.1.2.3.3.cmml" xref="A10.E46.m1.2.2.1.1.2.3.3">𝐵</ci></apply></apply><apply id="A10.E46.m1.2.2.1.1.1.cmml" xref="A10.E46.m1.2.2.1.1.1"><times id="A10.E46.m1.2.2.1.1.1.2.cmml" xref="A10.E46.m1.2.2.1.1.1.2"></times><ci id="A10.E46.m1.2.2.1.1.1.3a.cmml" xref="A10.E46.m1.2.2.1.1.1.3"><mtext id="A10.E46.m1.2.2.1.1.1.3.cmml" xref="A10.E46.m1.2.2.1.1.1.3">sign</mtext></ci><apply id="A10.E46.m1.2.2.1.1.1.1.1.1.cmml" xref="A10.E46.m1.2.2.1.1.1.1.1"><minus id="A10.E46.m1.2.2.1.1.1.1.1.1.1.cmml" xref="A10.E46.m1.2.2.1.1.1.1.1.1.1"></minus><apply id="A10.E46.m1.2.2.1.1.1.1.1.1.2.cmml" xref="A10.E46.m1.2.2.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="A10.E46.m1.2.2.1.1.1.1.1.1.2.1.cmml" xref="A10.E46.m1.2.2.1.1.1.1.1.1.2">subscript</csymbol><ci id="A10.E46.m1.2.2.1.1.1.1.1.1.2.2.cmml" xref="A10.E46.m1.2.2.1.1.1.1.1.1.2.2">𝐰</ci><apply id="A10.E46.m1.2.2.1.1.1.1.1.1.2.3.cmml" xref="A10.E46.m1.2.2.1.1.1.1.1.1.2.3"><times id="A10.E46.m1.2.2.1.1.1.1.1.1.2.3.1.cmml" xref="A10.E46.m1.2.2.1.1.1.1.1.1.2.3.1"></times><ci id="A10.E46.m1.2.2.1.1.1.1.1.1.2.3.2.cmml" xref="A10.E46.m1.2.2.1.1.1.1.1.1.2.3.2">𝑠</ci><ci id="A10.E46.m1.2.2.1.1.1.1.1.1.2.3.3.cmml" xref="A10.E46.m1.2.2.1.1.1.1.1.1.2.3.3">𝑗</ci></apply></apply><apply id="A10.E46.m1.2.2.1.1.1.1.1.1.3.cmml" xref="A10.E46.m1.2.2.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="A10.E46.m1.2.2.1.1.1.1.1.1.3.1.cmml" xref="A10.E46.m1.2.2.1.1.1.1.1.1.3">subscript</csymbol><ci id="A10.E46.m1.2.2.1.1.1.1.1.1.3.2.cmml" xref="A10.E46.m1.2.2.1.1.1.1.1.1.3.2">𝐰</ci><ci id="A10.E46.m1.2.2.1.1.1.1.1.1.3.3.cmml" xref="A10.E46.m1.2.2.1.1.1.1.1.1.3.3">𝑗</ci></apply></apply></apply></apply></apply></apply><apply id="A10.E46.m1.4.4e.cmml" xref="A10.E46.m1.4.4"><eq id="A10.E46.m1.4.4.9.cmml" xref="A10.E46.m1.4.4.9"></eq><share href="#A10.E46.m1.2.2.1.cmml" id="A10.E46.m1.4.4f.cmml" xref="A10.E46.m1.4.4"></share><cn type="integer" id="A10.E46.m1.4.4.10.cmml" xref="A10.E46.m1.4.4.10">0</cn></apply><apply id="A10.E46.m1.4.4g.cmml" xref="A10.E46.m1.4.4"><ci id="A10.E46.m1.4.4.11.cmml" xref="A10.E46.m1.4.4.11">⇒</ci><share href="#A10.E46.m1.4.4.10.cmml" id="A10.E46.m1.4.4h.cmml" xref="A10.E46.m1.4.4"></share><apply id="A10.E46.m1.4.4.12.cmml" xref="A10.E46.m1.4.4.12"><csymbol cd="ambiguous" id="A10.E46.m1.4.4.12.1.cmml" xref="A10.E46.m1.4.4.12">subscript</csymbol><ci id="A10.E46.m1.4.4.12.2.cmml" xref="A10.E46.m1.4.4.12.2">𝐰</ci><ci id="A10.E46.m1.4.4.12.3.cmml" xref="A10.E46.m1.4.4.12.3">𝑗</ci></apply></apply><apply id="A10.E46.m1.4.4i.cmml" xref="A10.E46.m1.4.4"><eq id="A10.E46.m1.4.4.13.cmml" xref="A10.E46.m1.4.4.13"></eq><share href="#A10.E46.m1.4.4.12.cmml" id="A10.E46.m1.4.4j.cmml" xref="A10.E46.m1.4.4"></share><apply id="A10.E46.m1.4.4.3.cmml" xref="A10.E46.m1.4.4.3"><times id="A10.E46.m1.4.4.3.3.cmml" xref="A10.E46.m1.4.4.3.3"></times><ci id="A10.E46.m1.4.4.3.4a.cmml" xref="A10.E46.m1.4.4.3.4"><mtext id="A10.E46.m1.4.4.3.4.cmml" xref="A10.E46.m1.4.4.3.4">median</mtext></ci><vector id="A10.E46.m1.4.4.3.2.3.cmml" xref="A10.E46.m1.4.4.3.2.2"><apply id="A10.E46.m1.3.3.2.1.1.1.cmml" xref="A10.E46.m1.3.3.2.1.1.1"><csymbol cd="ambiguous" id="A10.E46.m1.3.3.2.1.1.1.1.cmml" xref="A10.E46.m1.3.3.2.1.1.1">subscript</csymbol><ci id="A10.E46.m1.3.3.2.1.1.1.2.cmml" xref="A10.E46.m1.3.3.2.1.1.1.2">𝐰</ci><apply id="A10.E46.m1.3.3.2.1.1.1.3.cmml" xref="A10.E46.m1.3.3.2.1.1.1.3"><times id="A10.E46.m1.3.3.2.1.1.1.3.1.cmml" xref="A10.E46.m1.3.3.2.1.1.1.3.1"></times><cn type="integer" id="A10.E46.m1.3.3.2.1.1.1.3.2.cmml" xref="A10.E46.m1.3.3.2.1.1.1.3.2">1</cn><ci id="A10.E46.m1.3.3.2.1.1.1.3.3.cmml" xref="A10.E46.m1.3.3.2.1.1.1.3.3">𝑗</ci></apply></apply><ci id="A10.E46.m1.1.1.cmml" xref="A10.E46.m1.1.1">…</ci><apply id="A10.E46.m1.4.4.3.2.2.2.cmml" xref="A10.E46.m1.4.4.3.2.2.2"><csymbol cd="ambiguous" id="A10.E46.m1.4.4.3.2.2.2.1.cmml" xref="A10.E46.m1.4.4.3.2.2.2">subscript</csymbol><ci id="A10.E46.m1.4.4.3.2.2.2.2.cmml" xref="A10.E46.m1.4.4.3.2.2.2.2">𝐰</ci><apply id="A10.E46.m1.4.4.3.2.2.2.3.cmml" xref="A10.E46.m1.4.4.3.2.2.2.3"><times id="A10.E46.m1.4.4.3.2.2.2.3.1.cmml" xref="A10.E46.m1.4.4.3.2.2.2.3.1"></times><ci id="A10.E46.m1.4.4.3.2.2.2.3.2.cmml" xref="A10.E46.m1.4.4.3.2.2.2.3.2">𝐵</ci><ci id="A10.E46.m1.4.4.3.2.2.2.3.3.cmml" xref="A10.E46.m1.4.4.3.2.2.2.3.3">𝑗</ci></apply></apply></vector></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A10.E46.m1.4c">\displaystyle\frac{\partial{L}}{\partial\mathbf{w}_{j}}=0\Rightarrow\lambda\sum_{s\in B}\text{sign}(\mathbf{w}_{sj}-\mathbf{w}_{j})=0\Rightarrow\mathbf{w}_{j}=\text{median}(\mathbf{w}_{1j},\dots,\mathbf{w}_{Bj})</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(46)</span></td>
</tr></tbody>
</table>
<p id="A10.SS1.p1.16" class="ltx_p">since the median produces an equal number of positive and negative signs. Using the median in the server for updating its parameters is interesting, as it is more robust to “outlier” updates from the clients.</p>
</div>
</section>
<section id="A10.SS2" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">J.2 </span>Federated learning with mixture of Gaussian priors</h3>

<div id="A10.SS2.p1" class="ltx_para">
<p id="A10.SS2.p1.2" class="ltx_p">The mixture of Gaussians prior will allow us to learn an ensemble of models at the server. The density for the entire vector of local parameters <math id="A10.SS2.p1.1.m1.1" class="ltx_Math" alttext="\mathbf{w}_{s}" display="inline"><semantics id="A10.SS2.p1.1.m1.1a"><msub id="A10.SS2.p1.1.m1.1.1" xref="A10.SS2.p1.1.m1.1.1.cmml"><mi id="A10.SS2.p1.1.m1.1.1.2" xref="A10.SS2.p1.1.m1.1.1.2.cmml">𝐰</mi><mi id="A10.SS2.p1.1.m1.1.1.3" xref="A10.SS2.p1.1.m1.1.1.3.cmml">s</mi></msub><annotation-xml encoding="MathML-Content" id="A10.SS2.p1.1.m1.1b"><apply id="A10.SS2.p1.1.m1.1.1.cmml" xref="A10.SS2.p1.1.m1.1.1"><csymbol cd="ambiguous" id="A10.SS2.p1.1.m1.1.1.1.cmml" xref="A10.SS2.p1.1.m1.1.1">subscript</csymbol><ci id="A10.SS2.p1.1.m1.1.1.2.cmml" xref="A10.SS2.p1.1.m1.1.1.2">𝐰</ci><ci id="A10.SS2.p1.1.m1.1.1.3.cmml" xref="A10.SS2.p1.1.m1.1.1.3">𝑠</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A10.SS2.p1.1.m1.1c">\mathbf{w}_{s}</annotation></semantics></math> in the case of <math id="A10.SS2.p1.2.m2.1" class="ltx_Math" alttext="K" display="inline"><semantics id="A10.SS2.p1.2.m2.1a"><mi id="A10.SS2.p1.2.m2.1.1" xref="A10.SS2.p1.2.m2.1.1.cmml">K</mi><annotation-xml encoding="MathML-Content" id="A10.SS2.p1.2.m2.1b"><ci id="A10.SS2.p1.2.m2.1.1.cmml" xref="A10.SS2.p1.2.m2.1.1">𝐾</ci></annotation-xml><annotation encoding="application/x-tex" id="A10.SS2.p1.2.m2.1c">K</annotation></semantics></math> equiprobable components in the mixture will will be</p>
<table id="A10.EGx39" class="ltx_equationgroup ltx_eqn_align ltx_eqn_table">

<tbody id="A10.E47"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math id="A10.E47.m1.1" class="ltx_Math" alttext="\displaystyle p(\bm{\phi}_{s}|\mathbf{w}_{1:K})" display="inline"><semantics id="A10.E47.m1.1a"><mrow id="A10.E47.m1.1.1" xref="A10.E47.m1.1.1.cmml"><mi id="A10.E47.m1.1.1.3" xref="A10.E47.m1.1.1.3.cmml">p</mi><mo lspace="0em" rspace="0em" id="A10.E47.m1.1.1.2" xref="A10.E47.m1.1.1.2.cmml">​</mo><mrow id="A10.E47.m1.1.1.1.1" xref="A10.E47.m1.1.1.1.1.1.cmml"><mo stretchy="false" id="A10.E47.m1.1.1.1.1.2" xref="A10.E47.m1.1.1.1.1.1.cmml">(</mo><mrow id="A10.E47.m1.1.1.1.1.1" xref="A10.E47.m1.1.1.1.1.1.cmml"><msub id="A10.E47.m1.1.1.1.1.1.2" xref="A10.E47.m1.1.1.1.1.1.2.cmml"><mi class="ltx_mathvariant_bold-italic" mathvariant="bold-italic" id="A10.E47.m1.1.1.1.1.1.2.2" xref="A10.E47.m1.1.1.1.1.1.2.2.cmml">ϕ</mi><mi id="A10.E47.m1.1.1.1.1.1.2.3" xref="A10.E47.m1.1.1.1.1.1.2.3.cmml">s</mi></msub><mo fence="false" id="A10.E47.m1.1.1.1.1.1.1" xref="A10.E47.m1.1.1.1.1.1.1.cmml">|</mo><msub id="A10.E47.m1.1.1.1.1.1.3" xref="A10.E47.m1.1.1.1.1.1.3.cmml"><mi id="A10.E47.m1.1.1.1.1.1.3.2" xref="A10.E47.m1.1.1.1.1.1.3.2.cmml">𝐰</mi><mrow id="A10.E47.m1.1.1.1.1.1.3.3" xref="A10.E47.m1.1.1.1.1.1.3.3.cmml"><mn id="A10.E47.m1.1.1.1.1.1.3.3.2" xref="A10.E47.m1.1.1.1.1.1.3.3.2.cmml">1</mn><mo lspace="0.278em" rspace="0.278em" id="A10.E47.m1.1.1.1.1.1.3.3.1" xref="A10.E47.m1.1.1.1.1.1.3.3.1.cmml">:</mo><mi id="A10.E47.m1.1.1.1.1.1.3.3.3" xref="A10.E47.m1.1.1.1.1.1.3.3.3.cmml">K</mi></mrow></msub></mrow><mo stretchy="false" id="A10.E47.m1.1.1.1.1.3" xref="A10.E47.m1.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="A10.E47.m1.1b"><apply id="A10.E47.m1.1.1.cmml" xref="A10.E47.m1.1.1"><times id="A10.E47.m1.1.1.2.cmml" xref="A10.E47.m1.1.1.2"></times><ci id="A10.E47.m1.1.1.3.cmml" xref="A10.E47.m1.1.1.3">𝑝</ci><apply id="A10.E47.m1.1.1.1.1.1.cmml" xref="A10.E47.m1.1.1.1.1"><csymbol cd="latexml" id="A10.E47.m1.1.1.1.1.1.1.cmml" xref="A10.E47.m1.1.1.1.1.1.1">conditional</csymbol><apply id="A10.E47.m1.1.1.1.1.1.2.cmml" xref="A10.E47.m1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="A10.E47.m1.1.1.1.1.1.2.1.cmml" xref="A10.E47.m1.1.1.1.1.1.2">subscript</csymbol><ci id="A10.E47.m1.1.1.1.1.1.2.2.cmml" xref="A10.E47.m1.1.1.1.1.1.2.2">bold-italic-ϕ</ci><ci id="A10.E47.m1.1.1.1.1.1.2.3.cmml" xref="A10.E47.m1.1.1.1.1.1.2.3">𝑠</ci></apply><apply id="A10.E47.m1.1.1.1.1.1.3.cmml" xref="A10.E47.m1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="A10.E47.m1.1.1.1.1.1.3.1.cmml" xref="A10.E47.m1.1.1.1.1.1.3">subscript</csymbol><ci id="A10.E47.m1.1.1.1.1.1.3.2.cmml" xref="A10.E47.m1.1.1.1.1.1.3.2">𝐰</ci><apply id="A10.E47.m1.1.1.1.1.1.3.3.cmml" xref="A10.E47.m1.1.1.1.1.1.3.3"><ci id="A10.E47.m1.1.1.1.1.1.3.3.1.cmml" xref="A10.E47.m1.1.1.1.1.1.3.3.1">:</ci><cn type="integer" id="A10.E47.m1.1.1.1.1.1.3.3.2.cmml" xref="A10.E47.m1.1.1.1.1.1.3.3.2">1</cn><ci id="A10.E47.m1.1.1.1.1.1.3.3.3.cmml" xref="A10.E47.m1.1.1.1.1.1.3.3.3">𝐾</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A10.E47.m1.1c">\displaystyle p(\bm{\phi}_{s}|\mathbf{w}_{1:K})</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math id="A10.E47.m2.1" class="ltx_Math" alttext="\displaystyle=\frac{1}{K}\sum_{k}\mathcal{N}(\mathbf{w}_{k},(1/\lambda)\mathbf{I})." display="inline"><semantics id="A10.E47.m2.1a"><mrow id="A10.E47.m2.1.1.1" xref="A10.E47.m2.1.1.1.1.cmml"><mrow id="A10.E47.m2.1.1.1.1" xref="A10.E47.m2.1.1.1.1.cmml"><mi id="A10.E47.m2.1.1.1.1.4" xref="A10.E47.m2.1.1.1.1.4.cmml"></mi><mo id="A10.E47.m2.1.1.1.1.3" xref="A10.E47.m2.1.1.1.1.3.cmml">=</mo><mrow id="A10.E47.m2.1.1.1.1.2" xref="A10.E47.m2.1.1.1.1.2.cmml"><mstyle displaystyle="true" id="A10.E47.m2.1.1.1.1.2.4" xref="A10.E47.m2.1.1.1.1.2.4.cmml"><mfrac id="A10.E47.m2.1.1.1.1.2.4a" xref="A10.E47.m2.1.1.1.1.2.4.cmml"><mn id="A10.E47.m2.1.1.1.1.2.4.2" xref="A10.E47.m2.1.1.1.1.2.4.2.cmml">1</mn><mi id="A10.E47.m2.1.1.1.1.2.4.3" xref="A10.E47.m2.1.1.1.1.2.4.3.cmml">K</mi></mfrac></mstyle><mo lspace="0em" rspace="0em" id="A10.E47.m2.1.1.1.1.2.3" xref="A10.E47.m2.1.1.1.1.2.3.cmml">​</mo><mrow id="A10.E47.m2.1.1.1.1.2.2" xref="A10.E47.m2.1.1.1.1.2.2.cmml"><mstyle displaystyle="true" id="A10.E47.m2.1.1.1.1.2.2.3" xref="A10.E47.m2.1.1.1.1.2.2.3.cmml"><munder id="A10.E47.m2.1.1.1.1.2.2.3a" xref="A10.E47.m2.1.1.1.1.2.2.3.cmml"><mo movablelimits="false" id="A10.E47.m2.1.1.1.1.2.2.3.2" xref="A10.E47.m2.1.1.1.1.2.2.3.2.cmml">∑</mo><mi id="A10.E47.m2.1.1.1.1.2.2.3.3" xref="A10.E47.m2.1.1.1.1.2.2.3.3.cmml">k</mi></munder></mstyle><mrow id="A10.E47.m2.1.1.1.1.2.2.2" xref="A10.E47.m2.1.1.1.1.2.2.2.cmml"><mi class="ltx_font_mathcaligraphic" id="A10.E47.m2.1.1.1.1.2.2.2.4" xref="A10.E47.m2.1.1.1.1.2.2.2.4.cmml">𝒩</mi><mo lspace="0em" rspace="0em" id="A10.E47.m2.1.1.1.1.2.2.2.3" xref="A10.E47.m2.1.1.1.1.2.2.2.3.cmml">​</mo><mrow id="A10.E47.m2.1.1.1.1.2.2.2.2.2" xref="A10.E47.m2.1.1.1.1.2.2.2.2.3.cmml"><mo stretchy="false" id="A10.E47.m2.1.1.1.1.2.2.2.2.2.3" xref="A10.E47.m2.1.1.1.1.2.2.2.2.3.cmml">(</mo><msub id="A10.E47.m2.1.1.1.1.1.1.1.1.1.1" xref="A10.E47.m2.1.1.1.1.1.1.1.1.1.1.cmml"><mi id="A10.E47.m2.1.1.1.1.1.1.1.1.1.1.2" xref="A10.E47.m2.1.1.1.1.1.1.1.1.1.1.2.cmml">𝐰</mi><mi id="A10.E47.m2.1.1.1.1.1.1.1.1.1.1.3" xref="A10.E47.m2.1.1.1.1.1.1.1.1.1.1.3.cmml">k</mi></msub><mo id="A10.E47.m2.1.1.1.1.2.2.2.2.2.4" xref="A10.E47.m2.1.1.1.1.2.2.2.2.3.cmml">,</mo><mrow id="A10.E47.m2.1.1.1.1.2.2.2.2.2.2" xref="A10.E47.m2.1.1.1.1.2.2.2.2.2.2.cmml"><mrow id="A10.E47.m2.1.1.1.1.2.2.2.2.2.2.1.1" xref="A10.E47.m2.1.1.1.1.2.2.2.2.2.2.1.1.1.cmml"><mo stretchy="false" id="A10.E47.m2.1.1.1.1.2.2.2.2.2.2.1.1.2" xref="A10.E47.m2.1.1.1.1.2.2.2.2.2.2.1.1.1.cmml">(</mo><mrow id="A10.E47.m2.1.1.1.1.2.2.2.2.2.2.1.1.1" xref="A10.E47.m2.1.1.1.1.2.2.2.2.2.2.1.1.1.cmml"><mn id="A10.E47.m2.1.1.1.1.2.2.2.2.2.2.1.1.1.2" xref="A10.E47.m2.1.1.1.1.2.2.2.2.2.2.1.1.1.2.cmml">1</mn><mo id="A10.E47.m2.1.1.1.1.2.2.2.2.2.2.1.1.1.1" xref="A10.E47.m2.1.1.1.1.2.2.2.2.2.2.1.1.1.1.cmml">/</mo><mi id="A10.E47.m2.1.1.1.1.2.2.2.2.2.2.1.1.1.3" xref="A10.E47.m2.1.1.1.1.2.2.2.2.2.2.1.1.1.3.cmml">λ</mi></mrow><mo stretchy="false" id="A10.E47.m2.1.1.1.1.2.2.2.2.2.2.1.1.3" xref="A10.E47.m2.1.1.1.1.2.2.2.2.2.2.1.1.1.cmml">)</mo></mrow><mo lspace="0em" rspace="0em" id="A10.E47.m2.1.1.1.1.2.2.2.2.2.2.2" xref="A10.E47.m2.1.1.1.1.2.2.2.2.2.2.2.cmml">​</mo><mi id="A10.E47.m2.1.1.1.1.2.2.2.2.2.2.3" xref="A10.E47.m2.1.1.1.1.2.2.2.2.2.2.3.cmml">𝐈</mi></mrow><mo stretchy="false" id="A10.E47.m2.1.1.1.1.2.2.2.2.2.5" xref="A10.E47.m2.1.1.1.1.2.2.2.2.3.cmml">)</mo></mrow></mrow></mrow></mrow></mrow><mo lspace="0em" id="A10.E47.m2.1.1.1.2" xref="A10.E47.m2.1.1.1.1.cmml">.</mo></mrow><annotation-xml encoding="MathML-Content" id="A10.E47.m2.1b"><apply id="A10.E47.m2.1.1.1.1.cmml" xref="A10.E47.m2.1.1.1"><eq id="A10.E47.m2.1.1.1.1.3.cmml" xref="A10.E47.m2.1.1.1.1.3"></eq><csymbol cd="latexml" id="A10.E47.m2.1.1.1.1.4.cmml" xref="A10.E47.m2.1.1.1.1.4">absent</csymbol><apply id="A10.E47.m2.1.1.1.1.2.cmml" xref="A10.E47.m2.1.1.1.1.2"><times id="A10.E47.m2.1.1.1.1.2.3.cmml" xref="A10.E47.m2.1.1.1.1.2.3"></times><apply id="A10.E47.m2.1.1.1.1.2.4.cmml" xref="A10.E47.m2.1.1.1.1.2.4"><divide id="A10.E47.m2.1.1.1.1.2.4.1.cmml" xref="A10.E47.m2.1.1.1.1.2.4"></divide><cn type="integer" id="A10.E47.m2.1.1.1.1.2.4.2.cmml" xref="A10.E47.m2.1.1.1.1.2.4.2">1</cn><ci id="A10.E47.m2.1.1.1.1.2.4.3.cmml" xref="A10.E47.m2.1.1.1.1.2.4.3">𝐾</ci></apply><apply id="A10.E47.m2.1.1.1.1.2.2.cmml" xref="A10.E47.m2.1.1.1.1.2.2"><apply id="A10.E47.m2.1.1.1.1.2.2.3.cmml" xref="A10.E47.m2.1.1.1.1.2.2.3"><csymbol cd="ambiguous" id="A10.E47.m2.1.1.1.1.2.2.3.1.cmml" xref="A10.E47.m2.1.1.1.1.2.2.3">subscript</csymbol><sum id="A10.E47.m2.1.1.1.1.2.2.3.2.cmml" xref="A10.E47.m2.1.1.1.1.2.2.3.2"></sum><ci id="A10.E47.m2.1.1.1.1.2.2.3.3.cmml" xref="A10.E47.m2.1.1.1.1.2.2.3.3">𝑘</ci></apply><apply id="A10.E47.m2.1.1.1.1.2.2.2.cmml" xref="A10.E47.m2.1.1.1.1.2.2.2"><times id="A10.E47.m2.1.1.1.1.2.2.2.3.cmml" xref="A10.E47.m2.1.1.1.1.2.2.2.3"></times><ci id="A10.E47.m2.1.1.1.1.2.2.2.4.cmml" xref="A10.E47.m2.1.1.1.1.2.2.2.4">𝒩</ci><interval closure="open" id="A10.E47.m2.1.1.1.1.2.2.2.2.3.cmml" xref="A10.E47.m2.1.1.1.1.2.2.2.2.2"><apply id="A10.E47.m2.1.1.1.1.1.1.1.1.1.1.cmml" xref="A10.E47.m2.1.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="A10.E47.m2.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="A10.E47.m2.1.1.1.1.1.1.1.1.1.1">subscript</csymbol><ci id="A10.E47.m2.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="A10.E47.m2.1.1.1.1.1.1.1.1.1.1.2">𝐰</ci><ci id="A10.E47.m2.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="A10.E47.m2.1.1.1.1.1.1.1.1.1.1.3">𝑘</ci></apply><apply id="A10.E47.m2.1.1.1.1.2.2.2.2.2.2.cmml" xref="A10.E47.m2.1.1.1.1.2.2.2.2.2.2"><times id="A10.E47.m2.1.1.1.1.2.2.2.2.2.2.2.cmml" xref="A10.E47.m2.1.1.1.1.2.2.2.2.2.2.2"></times><apply id="A10.E47.m2.1.1.1.1.2.2.2.2.2.2.1.1.1.cmml" xref="A10.E47.m2.1.1.1.1.2.2.2.2.2.2.1.1"><divide id="A10.E47.m2.1.1.1.1.2.2.2.2.2.2.1.1.1.1.cmml" xref="A10.E47.m2.1.1.1.1.2.2.2.2.2.2.1.1.1.1"></divide><cn type="integer" id="A10.E47.m2.1.1.1.1.2.2.2.2.2.2.1.1.1.2.cmml" xref="A10.E47.m2.1.1.1.1.2.2.2.2.2.2.1.1.1.2">1</cn><ci id="A10.E47.m2.1.1.1.1.2.2.2.2.2.2.1.1.1.3.cmml" xref="A10.E47.m2.1.1.1.1.2.2.2.2.2.2.1.1.1.3">𝜆</ci></apply><ci id="A10.E47.m2.1.1.1.1.2.2.2.2.2.2.3.cmml" xref="A10.E47.m2.1.1.1.1.2.2.2.2.2.2.3">𝐈</ci></apply></interval></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A10.E47.m2.1c">\displaystyle=\frac{1}{K}\sum_{k}\mathcal{N}(\mathbf{w}_{k},(1/\lambda)\mathbf{I}).</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(47)</span></td>
</tr></tbody>
</table>
<p id="A10.SS2.p1.23" class="ltx_p">This will lead to the following local and global objectives</p>
<table id="A10.EGx40" class="ltx_equationgroup ltx_eqn_align ltx_eqn_table">

<tbody id="A10.E48"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math id="A10.E48.m1.3" class="ltx_Math" alttext="\displaystyle\mathcal{L}_{s}(\mathcal{D}_{s},\mathbf{w}_{1:K},\mathbf{w}_{s})" display="inline"><semantics id="A10.E48.m1.3a"><mrow id="A10.E48.m1.3.3" xref="A10.E48.m1.3.3.cmml"><msub id="A10.E48.m1.3.3.5" xref="A10.E48.m1.3.3.5.cmml"><mi class="ltx_font_mathcaligraphic" id="A10.E48.m1.3.3.5.2" xref="A10.E48.m1.3.3.5.2.cmml">ℒ</mi><mi id="A10.E48.m1.3.3.5.3" xref="A10.E48.m1.3.3.5.3.cmml">s</mi></msub><mo lspace="0em" rspace="0em" id="A10.E48.m1.3.3.4" xref="A10.E48.m1.3.3.4.cmml">​</mo><mrow id="A10.E48.m1.3.3.3.3" xref="A10.E48.m1.3.3.3.4.cmml"><mo stretchy="false" id="A10.E48.m1.3.3.3.3.4" xref="A10.E48.m1.3.3.3.4.cmml">(</mo><msub id="A10.E48.m1.1.1.1.1.1" xref="A10.E48.m1.1.1.1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="A10.E48.m1.1.1.1.1.1.2" xref="A10.E48.m1.1.1.1.1.1.2.cmml">𝒟</mi><mi id="A10.E48.m1.1.1.1.1.1.3" xref="A10.E48.m1.1.1.1.1.1.3.cmml">s</mi></msub><mo id="A10.E48.m1.3.3.3.3.5" xref="A10.E48.m1.3.3.3.4.cmml">,</mo><msub id="A10.E48.m1.2.2.2.2.2" xref="A10.E48.m1.2.2.2.2.2.cmml"><mi id="A10.E48.m1.2.2.2.2.2.2" xref="A10.E48.m1.2.2.2.2.2.2.cmml">𝐰</mi><mrow id="A10.E48.m1.2.2.2.2.2.3" xref="A10.E48.m1.2.2.2.2.2.3.cmml"><mn id="A10.E48.m1.2.2.2.2.2.3.2" xref="A10.E48.m1.2.2.2.2.2.3.2.cmml">1</mn><mo lspace="0.278em" rspace="0.278em" id="A10.E48.m1.2.2.2.2.2.3.1" xref="A10.E48.m1.2.2.2.2.2.3.1.cmml">:</mo><mi id="A10.E48.m1.2.2.2.2.2.3.3" xref="A10.E48.m1.2.2.2.2.2.3.3.cmml">K</mi></mrow></msub><mo id="A10.E48.m1.3.3.3.3.6" xref="A10.E48.m1.3.3.3.4.cmml">,</mo><msub id="A10.E48.m1.3.3.3.3.3" xref="A10.E48.m1.3.3.3.3.3.cmml"><mi id="A10.E48.m1.3.3.3.3.3.2" xref="A10.E48.m1.3.3.3.3.3.2.cmml">𝐰</mi><mi id="A10.E48.m1.3.3.3.3.3.3" xref="A10.E48.m1.3.3.3.3.3.3.cmml">s</mi></msub><mo stretchy="false" id="A10.E48.m1.3.3.3.3.7" xref="A10.E48.m1.3.3.3.4.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="A10.E48.m1.3b"><apply id="A10.E48.m1.3.3.cmml" xref="A10.E48.m1.3.3"><times id="A10.E48.m1.3.3.4.cmml" xref="A10.E48.m1.3.3.4"></times><apply id="A10.E48.m1.3.3.5.cmml" xref="A10.E48.m1.3.3.5"><csymbol cd="ambiguous" id="A10.E48.m1.3.3.5.1.cmml" xref="A10.E48.m1.3.3.5">subscript</csymbol><ci id="A10.E48.m1.3.3.5.2.cmml" xref="A10.E48.m1.3.3.5.2">ℒ</ci><ci id="A10.E48.m1.3.3.5.3.cmml" xref="A10.E48.m1.3.3.5.3">𝑠</ci></apply><vector id="A10.E48.m1.3.3.3.4.cmml" xref="A10.E48.m1.3.3.3.3"><apply id="A10.E48.m1.1.1.1.1.1.cmml" xref="A10.E48.m1.1.1.1.1.1"><csymbol cd="ambiguous" id="A10.E48.m1.1.1.1.1.1.1.cmml" xref="A10.E48.m1.1.1.1.1.1">subscript</csymbol><ci id="A10.E48.m1.1.1.1.1.1.2.cmml" xref="A10.E48.m1.1.1.1.1.1.2">𝒟</ci><ci id="A10.E48.m1.1.1.1.1.1.3.cmml" xref="A10.E48.m1.1.1.1.1.1.3">𝑠</ci></apply><apply id="A10.E48.m1.2.2.2.2.2.cmml" xref="A10.E48.m1.2.2.2.2.2"><csymbol cd="ambiguous" id="A10.E48.m1.2.2.2.2.2.1.cmml" xref="A10.E48.m1.2.2.2.2.2">subscript</csymbol><ci id="A10.E48.m1.2.2.2.2.2.2.cmml" xref="A10.E48.m1.2.2.2.2.2.2">𝐰</ci><apply id="A10.E48.m1.2.2.2.2.2.3.cmml" xref="A10.E48.m1.2.2.2.2.2.3"><ci id="A10.E48.m1.2.2.2.2.2.3.1.cmml" xref="A10.E48.m1.2.2.2.2.2.3.1">:</ci><cn type="integer" id="A10.E48.m1.2.2.2.2.2.3.2.cmml" xref="A10.E48.m1.2.2.2.2.2.3.2">1</cn><ci id="A10.E48.m1.2.2.2.2.2.3.3.cmml" xref="A10.E48.m1.2.2.2.2.2.3.3">𝐾</ci></apply></apply><apply id="A10.E48.m1.3.3.3.3.3.cmml" xref="A10.E48.m1.3.3.3.3.3"><csymbol cd="ambiguous" id="A10.E48.m1.3.3.3.3.3.1.cmml" xref="A10.E48.m1.3.3.3.3.3">subscript</csymbol><ci id="A10.E48.m1.3.3.3.3.3.2.cmml" xref="A10.E48.m1.3.3.3.3.3.2">𝐰</ci><ci id="A10.E48.m1.3.3.3.3.3.3.cmml" xref="A10.E48.m1.3.3.3.3.3.3">𝑠</ci></apply></vector></apply></annotation-xml><annotation encoding="application/x-tex" id="A10.E48.m1.3c">\displaystyle\mathcal{L}_{s}(\mathcal{D}_{s},\mathbf{w}_{1:K},\mathbf{w}_{s})</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math id="A10.E48.m2.2" class="ltx_Math" alttext="\displaystyle:=\sum_{i}^{N_{s}}L(\mathcal{D}_{si},\mathbf{w}_{s})+\log\sum_{k}\frac{Z_{k}}{K}\exp\left(-\frac{\lambda}{2}\|\mathbf{w}_{s}-\mathbf{w}_{k}\|^{2}\right)," display="inline"><semantics id="A10.E48.m2.2a"><mrow id="A10.E48.m2.2.2.1" xref="A10.E48.m2.2.2.1.1.cmml"><mrow id="A10.E48.m2.2.2.1.1" xref="A10.E48.m2.2.2.1.1.cmml"><mi id="A10.E48.m2.2.2.1.1.5" xref="A10.E48.m2.2.2.1.1.5.cmml"></mi><mo lspace="0.278em" rspace="0.278em" id="A10.E48.m2.2.2.1.1.4" xref="A10.E48.m2.2.2.1.1.4.cmml">:=</mo><mrow id="A10.E48.m2.2.2.1.1.3" xref="A10.E48.m2.2.2.1.1.3.cmml"><mrow id="A10.E48.m2.2.2.1.1.2.2" xref="A10.E48.m2.2.2.1.1.2.2.cmml"><mstyle displaystyle="true" id="A10.E48.m2.2.2.1.1.2.2.3" xref="A10.E48.m2.2.2.1.1.2.2.3.cmml"><munderover id="A10.E48.m2.2.2.1.1.2.2.3a" xref="A10.E48.m2.2.2.1.1.2.2.3.cmml"><mo movablelimits="false" id="A10.E48.m2.2.2.1.1.2.2.3.2.2" xref="A10.E48.m2.2.2.1.1.2.2.3.2.2.cmml">∑</mo><mi id="A10.E48.m2.2.2.1.1.2.2.3.2.3" xref="A10.E48.m2.2.2.1.1.2.2.3.2.3.cmml">i</mi><msub id="A10.E48.m2.2.2.1.1.2.2.3.3" xref="A10.E48.m2.2.2.1.1.2.2.3.3.cmml"><mi id="A10.E48.m2.2.2.1.1.2.2.3.3.2" xref="A10.E48.m2.2.2.1.1.2.2.3.3.2.cmml">N</mi><mi id="A10.E48.m2.2.2.1.1.2.2.3.3.3" xref="A10.E48.m2.2.2.1.1.2.2.3.3.3.cmml">s</mi></msub></munderover></mstyle><mrow id="A10.E48.m2.2.2.1.1.2.2.2" xref="A10.E48.m2.2.2.1.1.2.2.2.cmml"><mi id="A10.E48.m2.2.2.1.1.2.2.2.4" xref="A10.E48.m2.2.2.1.1.2.2.2.4.cmml">L</mi><mo lspace="0em" rspace="0em" id="A10.E48.m2.2.2.1.1.2.2.2.3" xref="A10.E48.m2.2.2.1.1.2.2.2.3.cmml">​</mo><mrow id="A10.E48.m2.2.2.1.1.2.2.2.2.2" xref="A10.E48.m2.2.2.1.1.2.2.2.2.3.cmml"><mo stretchy="false" id="A10.E48.m2.2.2.1.1.2.2.2.2.2.3" xref="A10.E48.m2.2.2.1.1.2.2.2.2.3.cmml">(</mo><msub id="A10.E48.m2.2.2.1.1.1.1.1.1.1.1" xref="A10.E48.m2.2.2.1.1.1.1.1.1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="A10.E48.m2.2.2.1.1.1.1.1.1.1.1.2" xref="A10.E48.m2.2.2.1.1.1.1.1.1.1.1.2.cmml">𝒟</mi><mrow id="A10.E48.m2.2.2.1.1.1.1.1.1.1.1.3" xref="A10.E48.m2.2.2.1.1.1.1.1.1.1.1.3.cmml"><mi id="A10.E48.m2.2.2.1.1.1.1.1.1.1.1.3.2" xref="A10.E48.m2.2.2.1.1.1.1.1.1.1.1.3.2.cmml">s</mi><mo lspace="0em" rspace="0em" id="A10.E48.m2.2.2.1.1.1.1.1.1.1.1.3.1" xref="A10.E48.m2.2.2.1.1.1.1.1.1.1.1.3.1.cmml">​</mo><mi id="A10.E48.m2.2.2.1.1.1.1.1.1.1.1.3.3" xref="A10.E48.m2.2.2.1.1.1.1.1.1.1.1.3.3.cmml">i</mi></mrow></msub><mo id="A10.E48.m2.2.2.1.1.2.2.2.2.2.4" xref="A10.E48.m2.2.2.1.1.2.2.2.2.3.cmml">,</mo><msub id="A10.E48.m2.2.2.1.1.2.2.2.2.2.2" xref="A10.E48.m2.2.2.1.1.2.2.2.2.2.2.cmml"><mi id="A10.E48.m2.2.2.1.1.2.2.2.2.2.2.2" xref="A10.E48.m2.2.2.1.1.2.2.2.2.2.2.2.cmml">𝐰</mi><mi id="A10.E48.m2.2.2.1.1.2.2.2.2.2.2.3" xref="A10.E48.m2.2.2.1.1.2.2.2.2.2.2.3.cmml">s</mi></msub><mo stretchy="false" id="A10.E48.m2.2.2.1.1.2.2.2.2.2.5" xref="A10.E48.m2.2.2.1.1.2.2.2.2.3.cmml">)</mo></mrow></mrow></mrow><mo id="A10.E48.m2.2.2.1.1.3.4" xref="A10.E48.m2.2.2.1.1.3.4.cmml">+</mo><mrow id="A10.E48.m2.2.2.1.1.3.3" xref="A10.E48.m2.2.2.1.1.3.3.cmml"><mi id="A10.E48.m2.2.2.1.1.3.3.3" xref="A10.E48.m2.2.2.1.1.3.3.3.cmml">log</mi><mo lspace="0.167em" rspace="0em" id="A10.E48.m2.2.2.1.1.3.3.2" xref="A10.E48.m2.2.2.1.1.3.3.2.cmml">​</mo><mrow id="A10.E48.m2.2.2.1.1.3.3.1" xref="A10.E48.m2.2.2.1.1.3.3.1.cmml"><mstyle displaystyle="true" id="A10.E48.m2.2.2.1.1.3.3.1.2" xref="A10.E48.m2.2.2.1.1.3.3.1.2.cmml"><munder id="A10.E48.m2.2.2.1.1.3.3.1.2a" xref="A10.E48.m2.2.2.1.1.3.3.1.2.cmml"><mo movablelimits="false" id="A10.E48.m2.2.2.1.1.3.3.1.2.2" xref="A10.E48.m2.2.2.1.1.3.3.1.2.2.cmml">∑</mo><mi id="A10.E48.m2.2.2.1.1.3.3.1.2.3" xref="A10.E48.m2.2.2.1.1.3.3.1.2.3.cmml">k</mi></munder></mstyle><mrow id="A10.E48.m2.2.2.1.1.3.3.1.1" xref="A10.E48.m2.2.2.1.1.3.3.1.1.cmml"><mstyle displaystyle="true" id="A10.E48.m2.2.2.1.1.3.3.1.1.3" xref="A10.E48.m2.2.2.1.1.3.3.1.1.3.cmml"><mfrac id="A10.E48.m2.2.2.1.1.3.3.1.1.3a" xref="A10.E48.m2.2.2.1.1.3.3.1.1.3.cmml"><msub id="A10.E48.m2.2.2.1.1.3.3.1.1.3.2" xref="A10.E48.m2.2.2.1.1.3.3.1.1.3.2.cmml"><mi id="A10.E48.m2.2.2.1.1.3.3.1.1.3.2.2" xref="A10.E48.m2.2.2.1.1.3.3.1.1.3.2.2.cmml">Z</mi><mi id="A10.E48.m2.2.2.1.1.3.3.1.1.3.2.3" xref="A10.E48.m2.2.2.1.1.3.3.1.1.3.2.3.cmml">k</mi></msub><mi id="A10.E48.m2.2.2.1.1.3.3.1.1.3.3" xref="A10.E48.m2.2.2.1.1.3.3.1.1.3.3.cmml">K</mi></mfrac></mstyle><mo lspace="0.167em" rspace="0em" id="A10.E48.m2.2.2.1.1.3.3.1.1.2" xref="A10.E48.m2.2.2.1.1.3.3.1.1.2.cmml">​</mo><mrow id="A10.E48.m2.2.2.1.1.3.3.1.1.1.1" xref="A10.E48.m2.2.2.1.1.3.3.1.1.1.2.cmml"><mi id="A10.E48.m2.1.1" xref="A10.E48.m2.1.1.cmml">exp</mi><mo id="A10.E48.m2.2.2.1.1.3.3.1.1.1.1a" xref="A10.E48.m2.2.2.1.1.3.3.1.1.1.2.cmml">⁡</mo><mrow id="A10.E48.m2.2.2.1.1.3.3.1.1.1.1.1" xref="A10.E48.m2.2.2.1.1.3.3.1.1.1.2.cmml"><mo id="A10.E48.m2.2.2.1.1.3.3.1.1.1.1.1.2" xref="A10.E48.m2.2.2.1.1.3.3.1.1.1.2.cmml">(</mo><mrow id="A10.E48.m2.2.2.1.1.3.3.1.1.1.1.1.1" xref="A10.E48.m2.2.2.1.1.3.3.1.1.1.1.1.1.cmml"><mo id="A10.E48.m2.2.2.1.1.3.3.1.1.1.1.1.1a" xref="A10.E48.m2.2.2.1.1.3.3.1.1.1.1.1.1.cmml">−</mo><mrow id="A10.E48.m2.2.2.1.1.3.3.1.1.1.1.1.1.1" xref="A10.E48.m2.2.2.1.1.3.3.1.1.1.1.1.1.1.cmml"><mstyle displaystyle="true" id="A10.E48.m2.2.2.1.1.3.3.1.1.1.1.1.1.1.3" xref="A10.E48.m2.2.2.1.1.3.3.1.1.1.1.1.1.1.3.cmml"><mfrac id="A10.E48.m2.2.2.1.1.3.3.1.1.1.1.1.1.1.3a" xref="A10.E48.m2.2.2.1.1.3.3.1.1.1.1.1.1.1.3.cmml"><mi id="A10.E48.m2.2.2.1.1.3.3.1.1.1.1.1.1.1.3.2" xref="A10.E48.m2.2.2.1.1.3.3.1.1.1.1.1.1.1.3.2.cmml">λ</mi><mn id="A10.E48.m2.2.2.1.1.3.3.1.1.1.1.1.1.1.3.3" xref="A10.E48.m2.2.2.1.1.3.3.1.1.1.1.1.1.1.3.3.cmml">2</mn></mfrac></mstyle><mo lspace="0em" rspace="0em" id="A10.E48.m2.2.2.1.1.3.3.1.1.1.1.1.1.1.2" xref="A10.E48.m2.2.2.1.1.3.3.1.1.1.1.1.1.1.2.cmml">​</mo><msup id="A10.E48.m2.2.2.1.1.3.3.1.1.1.1.1.1.1.1" xref="A10.E48.m2.2.2.1.1.3.3.1.1.1.1.1.1.1.1.cmml"><mrow id="A10.E48.m2.2.2.1.1.3.3.1.1.1.1.1.1.1.1.1.1" xref="A10.E48.m2.2.2.1.1.3.3.1.1.1.1.1.1.1.1.1.2.cmml"><mo stretchy="false" id="A10.E48.m2.2.2.1.1.3.3.1.1.1.1.1.1.1.1.1.1.2" xref="A10.E48.m2.2.2.1.1.3.3.1.1.1.1.1.1.1.1.1.2.1.cmml">‖</mo><mrow id="A10.E48.m2.2.2.1.1.3.3.1.1.1.1.1.1.1.1.1.1.1" xref="A10.E48.m2.2.2.1.1.3.3.1.1.1.1.1.1.1.1.1.1.1.cmml"><msub id="A10.E48.m2.2.2.1.1.3.3.1.1.1.1.1.1.1.1.1.1.1.2" xref="A10.E48.m2.2.2.1.1.3.3.1.1.1.1.1.1.1.1.1.1.1.2.cmml"><mi id="A10.E48.m2.2.2.1.1.3.3.1.1.1.1.1.1.1.1.1.1.1.2.2" xref="A10.E48.m2.2.2.1.1.3.3.1.1.1.1.1.1.1.1.1.1.1.2.2.cmml">𝐰</mi><mi id="A10.E48.m2.2.2.1.1.3.3.1.1.1.1.1.1.1.1.1.1.1.2.3" xref="A10.E48.m2.2.2.1.1.3.3.1.1.1.1.1.1.1.1.1.1.1.2.3.cmml">s</mi></msub><mo id="A10.E48.m2.2.2.1.1.3.3.1.1.1.1.1.1.1.1.1.1.1.1" xref="A10.E48.m2.2.2.1.1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.cmml">−</mo><msub id="A10.E48.m2.2.2.1.1.3.3.1.1.1.1.1.1.1.1.1.1.1.3" xref="A10.E48.m2.2.2.1.1.3.3.1.1.1.1.1.1.1.1.1.1.1.3.cmml"><mi id="A10.E48.m2.2.2.1.1.3.3.1.1.1.1.1.1.1.1.1.1.1.3.2" xref="A10.E48.m2.2.2.1.1.3.3.1.1.1.1.1.1.1.1.1.1.1.3.2.cmml">𝐰</mi><mi id="A10.E48.m2.2.2.1.1.3.3.1.1.1.1.1.1.1.1.1.1.1.3.3" xref="A10.E48.m2.2.2.1.1.3.3.1.1.1.1.1.1.1.1.1.1.1.3.3.cmml">k</mi></msub></mrow><mo stretchy="false" id="A10.E48.m2.2.2.1.1.3.3.1.1.1.1.1.1.1.1.1.1.3" xref="A10.E48.m2.2.2.1.1.3.3.1.1.1.1.1.1.1.1.1.2.1.cmml">‖</mo></mrow><mn id="A10.E48.m2.2.2.1.1.3.3.1.1.1.1.1.1.1.1.3" xref="A10.E48.m2.2.2.1.1.3.3.1.1.1.1.1.1.1.1.3.cmml">2</mn></msup></mrow></mrow><mo id="A10.E48.m2.2.2.1.1.3.3.1.1.1.1.1.3" xref="A10.E48.m2.2.2.1.1.3.3.1.1.1.2.cmml">)</mo></mrow></mrow></mrow></mrow></mrow></mrow></mrow><mo id="A10.E48.m2.2.2.1.2" xref="A10.E48.m2.2.2.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="A10.E48.m2.2b"><apply id="A10.E48.m2.2.2.1.1.cmml" xref="A10.E48.m2.2.2.1"><csymbol cd="latexml" id="A10.E48.m2.2.2.1.1.4.cmml" xref="A10.E48.m2.2.2.1.1.4">assign</csymbol><csymbol cd="latexml" id="A10.E48.m2.2.2.1.1.5.cmml" xref="A10.E48.m2.2.2.1.1.5">absent</csymbol><apply id="A10.E48.m2.2.2.1.1.3.cmml" xref="A10.E48.m2.2.2.1.1.3"><plus id="A10.E48.m2.2.2.1.1.3.4.cmml" xref="A10.E48.m2.2.2.1.1.3.4"></plus><apply id="A10.E48.m2.2.2.1.1.2.2.cmml" xref="A10.E48.m2.2.2.1.1.2.2"><apply id="A10.E48.m2.2.2.1.1.2.2.3.cmml" xref="A10.E48.m2.2.2.1.1.2.2.3"><csymbol cd="ambiguous" id="A10.E48.m2.2.2.1.1.2.2.3.1.cmml" xref="A10.E48.m2.2.2.1.1.2.2.3">superscript</csymbol><apply id="A10.E48.m2.2.2.1.1.2.2.3.2.cmml" xref="A10.E48.m2.2.2.1.1.2.2.3"><csymbol cd="ambiguous" id="A10.E48.m2.2.2.1.1.2.2.3.2.1.cmml" xref="A10.E48.m2.2.2.1.1.2.2.3">subscript</csymbol><sum id="A10.E48.m2.2.2.1.1.2.2.3.2.2.cmml" xref="A10.E48.m2.2.2.1.1.2.2.3.2.2"></sum><ci id="A10.E48.m2.2.2.1.1.2.2.3.2.3.cmml" xref="A10.E48.m2.2.2.1.1.2.2.3.2.3">𝑖</ci></apply><apply id="A10.E48.m2.2.2.1.1.2.2.3.3.cmml" xref="A10.E48.m2.2.2.1.1.2.2.3.3"><csymbol cd="ambiguous" id="A10.E48.m2.2.2.1.1.2.2.3.3.1.cmml" xref="A10.E48.m2.2.2.1.1.2.2.3.3">subscript</csymbol><ci id="A10.E48.m2.2.2.1.1.2.2.3.3.2.cmml" xref="A10.E48.m2.2.2.1.1.2.2.3.3.2">𝑁</ci><ci id="A10.E48.m2.2.2.1.1.2.2.3.3.3.cmml" xref="A10.E48.m2.2.2.1.1.2.2.3.3.3">𝑠</ci></apply></apply><apply id="A10.E48.m2.2.2.1.1.2.2.2.cmml" xref="A10.E48.m2.2.2.1.1.2.2.2"><times id="A10.E48.m2.2.2.1.1.2.2.2.3.cmml" xref="A10.E48.m2.2.2.1.1.2.2.2.3"></times><ci id="A10.E48.m2.2.2.1.1.2.2.2.4.cmml" xref="A10.E48.m2.2.2.1.1.2.2.2.4">𝐿</ci><interval closure="open" id="A10.E48.m2.2.2.1.1.2.2.2.2.3.cmml" xref="A10.E48.m2.2.2.1.1.2.2.2.2.2"><apply id="A10.E48.m2.2.2.1.1.1.1.1.1.1.1.cmml" xref="A10.E48.m2.2.2.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="A10.E48.m2.2.2.1.1.1.1.1.1.1.1.1.cmml" xref="A10.E48.m2.2.2.1.1.1.1.1.1.1.1">subscript</csymbol><ci id="A10.E48.m2.2.2.1.1.1.1.1.1.1.1.2.cmml" xref="A10.E48.m2.2.2.1.1.1.1.1.1.1.1.2">𝒟</ci><apply id="A10.E48.m2.2.2.1.1.1.1.1.1.1.1.3.cmml" xref="A10.E48.m2.2.2.1.1.1.1.1.1.1.1.3"><times id="A10.E48.m2.2.2.1.1.1.1.1.1.1.1.3.1.cmml" xref="A10.E48.m2.2.2.1.1.1.1.1.1.1.1.3.1"></times><ci id="A10.E48.m2.2.2.1.1.1.1.1.1.1.1.3.2.cmml" xref="A10.E48.m2.2.2.1.1.1.1.1.1.1.1.3.2">𝑠</ci><ci id="A10.E48.m2.2.2.1.1.1.1.1.1.1.1.3.3.cmml" xref="A10.E48.m2.2.2.1.1.1.1.1.1.1.1.3.3">𝑖</ci></apply></apply><apply id="A10.E48.m2.2.2.1.1.2.2.2.2.2.2.cmml" xref="A10.E48.m2.2.2.1.1.2.2.2.2.2.2"><csymbol cd="ambiguous" id="A10.E48.m2.2.2.1.1.2.2.2.2.2.2.1.cmml" xref="A10.E48.m2.2.2.1.1.2.2.2.2.2.2">subscript</csymbol><ci id="A10.E48.m2.2.2.1.1.2.2.2.2.2.2.2.cmml" xref="A10.E48.m2.2.2.1.1.2.2.2.2.2.2.2">𝐰</ci><ci id="A10.E48.m2.2.2.1.1.2.2.2.2.2.2.3.cmml" xref="A10.E48.m2.2.2.1.1.2.2.2.2.2.2.3">𝑠</ci></apply></interval></apply></apply><apply id="A10.E48.m2.2.2.1.1.3.3.cmml" xref="A10.E48.m2.2.2.1.1.3.3"><times id="A10.E48.m2.2.2.1.1.3.3.2.cmml" xref="A10.E48.m2.2.2.1.1.3.3.2"></times><log id="A10.E48.m2.2.2.1.1.3.3.3.cmml" xref="A10.E48.m2.2.2.1.1.3.3.3"></log><apply id="A10.E48.m2.2.2.1.1.3.3.1.cmml" xref="A10.E48.m2.2.2.1.1.3.3.1"><apply id="A10.E48.m2.2.2.1.1.3.3.1.2.cmml" xref="A10.E48.m2.2.2.1.1.3.3.1.2"><csymbol cd="ambiguous" id="A10.E48.m2.2.2.1.1.3.3.1.2.1.cmml" xref="A10.E48.m2.2.2.1.1.3.3.1.2">subscript</csymbol><sum id="A10.E48.m2.2.2.1.1.3.3.1.2.2.cmml" xref="A10.E48.m2.2.2.1.1.3.3.1.2.2"></sum><ci id="A10.E48.m2.2.2.1.1.3.3.1.2.3.cmml" xref="A10.E48.m2.2.2.1.1.3.3.1.2.3">𝑘</ci></apply><apply id="A10.E48.m2.2.2.1.1.3.3.1.1.cmml" xref="A10.E48.m2.2.2.1.1.3.3.1.1"><times id="A10.E48.m2.2.2.1.1.3.3.1.1.2.cmml" xref="A10.E48.m2.2.2.1.1.3.3.1.1.2"></times><apply id="A10.E48.m2.2.2.1.1.3.3.1.1.3.cmml" xref="A10.E48.m2.2.2.1.1.3.3.1.1.3"><divide id="A10.E48.m2.2.2.1.1.3.3.1.1.3.1.cmml" xref="A10.E48.m2.2.2.1.1.3.3.1.1.3"></divide><apply id="A10.E48.m2.2.2.1.1.3.3.1.1.3.2.cmml" xref="A10.E48.m2.2.2.1.1.3.3.1.1.3.2"><csymbol cd="ambiguous" id="A10.E48.m2.2.2.1.1.3.3.1.1.3.2.1.cmml" xref="A10.E48.m2.2.2.1.1.3.3.1.1.3.2">subscript</csymbol><ci id="A10.E48.m2.2.2.1.1.3.3.1.1.3.2.2.cmml" xref="A10.E48.m2.2.2.1.1.3.3.1.1.3.2.2">𝑍</ci><ci id="A10.E48.m2.2.2.1.1.3.3.1.1.3.2.3.cmml" xref="A10.E48.m2.2.2.1.1.3.3.1.1.3.2.3">𝑘</ci></apply><ci id="A10.E48.m2.2.2.1.1.3.3.1.1.3.3.cmml" xref="A10.E48.m2.2.2.1.1.3.3.1.1.3.3">𝐾</ci></apply><apply id="A10.E48.m2.2.2.1.1.3.3.1.1.1.2.cmml" xref="A10.E48.m2.2.2.1.1.3.3.1.1.1.1"><exp id="A10.E48.m2.1.1.cmml" xref="A10.E48.m2.1.1"></exp><apply id="A10.E48.m2.2.2.1.1.3.3.1.1.1.1.1.1.cmml" xref="A10.E48.m2.2.2.1.1.3.3.1.1.1.1.1.1"><minus id="A10.E48.m2.2.2.1.1.3.3.1.1.1.1.1.1.2.cmml" xref="A10.E48.m2.2.2.1.1.3.3.1.1.1.1.1.1"></minus><apply id="A10.E48.m2.2.2.1.1.3.3.1.1.1.1.1.1.1.cmml" xref="A10.E48.m2.2.2.1.1.3.3.1.1.1.1.1.1.1"><times id="A10.E48.m2.2.2.1.1.3.3.1.1.1.1.1.1.1.2.cmml" xref="A10.E48.m2.2.2.1.1.3.3.1.1.1.1.1.1.1.2"></times><apply id="A10.E48.m2.2.2.1.1.3.3.1.1.1.1.1.1.1.3.cmml" xref="A10.E48.m2.2.2.1.1.3.3.1.1.1.1.1.1.1.3"><divide id="A10.E48.m2.2.2.1.1.3.3.1.1.1.1.1.1.1.3.1.cmml" xref="A10.E48.m2.2.2.1.1.3.3.1.1.1.1.1.1.1.3"></divide><ci id="A10.E48.m2.2.2.1.1.3.3.1.1.1.1.1.1.1.3.2.cmml" xref="A10.E48.m2.2.2.1.1.3.3.1.1.1.1.1.1.1.3.2">𝜆</ci><cn type="integer" id="A10.E48.m2.2.2.1.1.3.3.1.1.1.1.1.1.1.3.3.cmml" xref="A10.E48.m2.2.2.1.1.3.3.1.1.1.1.1.1.1.3.3">2</cn></apply><apply id="A10.E48.m2.2.2.1.1.3.3.1.1.1.1.1.1.1.1.cmml" xref="A10.E48.m2.2.2.1.1.3.3.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="A10.E48.m2.2.2.1.1.3.3.1.1.1.1.1.1.1.1.2.cmml" xref="A10.E48.m2.2.2.1.1.3.3.1.1.1.1.1.1.1.1">superscript</csymbol><apply id="A10.E48.m2.2.2.1.1.3.3.1.1.1.1.1.1.1.1.1.2.cmml" xref="A10.E48.m2.2.2.1.1.3.3.1.1.1.1.1.1.1.1.1.1"><csymbol cd="latexml" id="A10.E48.m2.2.2.1.1.3.3.1.1.1.1.1.1.1.1.1.2.1.cmml" xref="A10.E48.m2.2.2.1.1.3.3.1.1.1.1.1.1.1.1.1.1.2">norm</csymbol><apply id="A10.E48.m2.2.2.1.1.3.3.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="A10.E48.m2.2.2.1.1.3.3.1.1.1.1.1.1.1.1.1.1.1"><minus id="A10.E48.m2.2.2.1.1.3.3.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="A10.E48.m2.2.2.1.1.3.3.1.1.1.1.1.1.1.1.1.1.1.1"></minus><apply id="A10.E48.m2.2.2.1.1.3.3.1.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="A10.E48.m2.2.2.1.1.3.3.1.1.1.1.1.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="A10.E48.m2.2.2.1.1.3.3.1.1.1.1.1.1.1.1.1.1.1.2.1.cmml" xref="A10.E48.m2.2.2.1.1.3.3.1.1.1.1.1.1.1.1.1.1.1.2">subscript</csymbol><ci id="A10.E48.m2.2.2.1.1.3.3.1.1.1.1.1.1.1.1.1.1.1.2.2.cmml" xref="A10.E48.m2.2.2.1.1.3.3.1.1.1.1.1.1.1.1.1.1.1.2.2">𝐰</ci><ci id="A10.E48.m2.2.2.1.1.3.3.1.1.1.1.1.1.1.1.1.1.1.2.3.cmml" xref="A10.E48.m2.2.2.1.1.3.3.1.1.1.1.1.1.1.1.1.1.1.2.3">𝑠</ci></apply><apply id="A10.E48.m2.2.2.1.1.3.3.1.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="A10.E48.m2.2.2.1.1.3.3.1.1.1.1.1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="A10.E48.m2.2.2.1.1.3.3.1.1.1.1.1.1.1.1.1.1.1.3.1.cmml" xref="A10.E48.m2.2.2.1.1.3.3.1.1.1.1.1.1.1.1.1.1.1.3">subscript</csymbol><ci id="A10.E48.m2.2.2.1.1.3.3.1.1.1.1.1.1.1.1.1.1.1.3.2.cmml" xref="A10.E48.m2.2.2.1.1.3.3.1.1.1.1.1.1.1.1.1.1.1.3.2">𝐰</ci><ci id="A10.E48.m2.2.2.1.1.3.3.1.1.1.1.1.1.1.1.1.1.1.3.3.cmml" xref="A10.E48.m2.2.2.1.1.3.3.1.1.1.1.1.1.1.1.1.1.1.3.3">𝑘</ci></apply></apply></apply><cn type="integer" id="A10.E48.m2.2.2.1.1.3.3.1.1.1.1.1.1.1.1.3.cmml" xref="A10.E48.m2.2.2.1.1.3.3.1.1.1.1.1.1.1.1.3">2</cn></apply></apply></apply></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A10.E48.m2.2c">\displaystyle:=\sum_{i}^{N_{s}}L(\mathcal{D}_{si},\mathbf{w}_{s})+\log\sum_{k}\frac{Z_{k}}{K}\exp\left(-\frac{\lambda}{2}\|\mathbf{w}_{s}-\mathbf{w}_{k}\|^{2}\right),</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(48)</span></td>
</tr></tbody>
<tbody id="A10.E49"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math id="A10.E49.m1.1" class="ltx_Math" alttext="\displaystyle\mathcal{L}(\mathbf{w}_{1:K})" display="inline"><semantics id="A10.E49.m1.1a"><mrow id="A10.E49.m1.1.1" xref="A10.E49.m1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="A10.E49.m1.1.1.3" xref="A10.E49.m1.1.1.3.cmml">ℒ</mi><mo lspace="0em" rspace="0em" id="A10.E49.m1.1.1.2" xref="A10.E49.m1.1.1.2.cmml">​</mo><mrow id="A10.E49.m1.1.1.1.1" xref="A10.E49.m1.1.1.1.1.1.cmml"><mo stretchy="false" id="A10.E49.m1.1.1.1.1.2" xref="A10.E49.m1.1.1.1.1.1.cmml">(</mo><msub id="A10.E49.m1.1.1.1.1.1" xref="A10.E49.m1.1.1.1.1.1.cmml"><mi id="A10.E49.m1.1.1.1.1.1.2" xref="A10.E49.m1.1.1.1.1.1.2.cmml">𝐰</mi><mrow id="A10.E49.m1.1.1.1.1.1.3" xref="A10.E49.m1.1.1.1.1.1.3.cmml"><mn id="A10.E49.m1.1.1.1.1.1.3.2" xref="A10.E49.m1.1.1.1.1.1.3.2.cmml">1</mn><mo lspace="0.278em" rspace="0.278em" id="A10.E49.m1.1.1.1.1.1.3.1" xref="A10.E49.m1.1.1.1.1.1.3.1.cmml">:</mo><mi id="A10.E49.m1.1.1.1.1.1.3.3" xref="A10.E49.m1.1.1.1.1.1.3.3.cmml">K</mi></mrow></msub><mo stretchy="false" id="A10.E49.m1.1.1.1.1.3" xref="A10.E49.m1.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="A10.E49.m1.1b"><apply id="A10.E49.m1.1.1.cmml" xref="A10.E49.m1.1.1"><times id="A10.E49.m1.1.1.2.cmml" xref="A10.E49.m1.1.1.2"></times><ci id="A10.E49.m1.1.1.3.cmml" xref="A10.E49.m1.1.1.3">ℒ</ci><apply id="A10.E49.m1.1.1.1.1.1.cmml" xref="A10.E49.m1.1.1.1.1"><csymbol cd="ambiguous" id="A10.E49.m1.1.1.1.1.1.1.cmml" xref="A10.E49.m1.1.1.1.1">subscript</csymbol><ci id="A10.E49.m1.1.1.1.1.1.2.cmml" xref="A10.E49.m1.1.1.1.1.1.2">𝐰</ci><apply id="A10.E49.m1.1.1.1.1.1.3.cmml" xref="A10.E49.m1.1.1.1.1.1.3"><ci id="A10.E49.m1.1.1.1.1.1.3.1.cmml" xref="A10.E49.m1.1.1.1.1.1.3.1">:</ci><cn type="integer" id="A10.E49.m1.1.1.1.1.1.3.2.cmml" xref="A10.E49.m1.1.1.1.1.1.3.2">1</cn><ci id="A10.E49.m1.1.1.1.1.1.3.3.cmml" xref="A10.E49.m1.1.1.1.1.1.3.3">𝐾</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A10.E49.m1.1c">\displaystyle\mathcal{L}(\mathbf{w}_{1:K})</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math id="A10.E49.m2.3" class="ltx_Math" alttext="\displaystyle:=\sum_{s}\mathcal{L}_{s}(\mathcal{D}_{s},\mathbf{w}_{1:K},\mathbf{w}_{s})" display="inline"><semantics id="A10.E49.m2.3a"><mrow id="A10.E49.m2.3.3" xref="A10.E49.m2.3.3.cmml"><mi id="A10.E49.m2.3.3.5" xref="A10.E49.m2.3.3.5.cmml"></mi><mo lspace="0.278em" rspace="0.278em" id="A10.E49.m2.3.3.4" xref="A10.E49.m2.3.3.4.cmml">:=</mo><mrow id="A10.E49.m2.3.3.3" xref="A10.E49.m2.3.3.3.cmml"><mstyle displaystyle="true" id="A10.E49.m2.3.3.3.4" xref="A10.E49.m2.3.3.3.4.cmml"><munder id="A10.E49.m2.3.3.3.4a" xref="A10.E49.m2.3.3.3.4.cmml"><mo movablelimits="false" id="A10.E49.m2.3.3.3.4.2" xref="A10.E49.m2.3.3.3.4.2.cmml">∑</mo><mi id="A10.E49.m2.3.3.3.4.3" xref="A10.E49.m2.3.3.3.4.3.cmml">s</mi></munder></mstyle><mrow id="A10.E49.m2.3.3.3.3" xref="A10.E49.m2.3.3.3.3.cmml"><msub id="A10.E49.m2.3.3.3.3.5" xref="A10.E49.m2.3.3.3.3.5.cmml"><mi class="ltx_font_mathcaligraphic" id="A10.E49.m2.3.3.3.3.5.2" xref="A10.E49.m2.3.3.3.3.5.2.cmml">ℒ</mi><mi id="A10.E49.m2.3.3.3.3.5.3" xref="A10.E49.m2.3.3.3.3.5.3.cmml">s</mi></msub><mo lspace="0em" rspace="0em" id="A10.E49.m2.3.3.3.3.4" xref="A10.E49.m2.3.3.3.3.4.cmml">​</mo><mrow id="A10.E49.m2.3.3.3.3.3.3" xref="A10.E49.m2.3.3.3.3.3.4.cmml"><mo stretchy="false" id="A10.E49.m2.3.3.3.3.3.3.4" xref="A10.E49.m2.3.3.3.3.3.4.cmml">(</mo><msub id="A10.E49.m2.1.1.1.1.1.1.1" xref="A10.E49.m2.1.1.1.1.1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="A10.E49.m2.1.1.1.1.1.1.1.2" xref="A10.E49.m2.1.1.1.1.1.1.1.2.cmml">𝒟</mi><mi id="A10.E49.m2.1.1.1.1.1.1.1.3" xref="A10.E49.m2.1.1.1.1.1.1.1.3.cmml">s</mi></msub><mo id="A10.E49.m2.3.3.3.3.3.3.5" xref="A10.E49.m2.3.3.3.3.3.4.cmml">,</mo><msub id="A10.E49.m2.2.2.2.2.2.2.2" xref="A10.E49.m2.2.2.2.2.2.2.2.cmml"><mi id="A10.E49.m2.2.2.2.2.2.2.2.2" xref="A10.E49.m2.2.2.2.2.2.2.2.2.cmml">𝐰</mi><mrow id="A10.E49.m2.2.2.2.2.2.2.2.3" xref="A10.E49.m2.2.2.2.2.2.2.2.3.cmml"><mn id="A10.E49.m2.2.2.2.2.2.2.2.3.2" xref="A10.E49.m2.2.2.2.2.2.2.2.3.2.cmml">1</mn><mo lspace="0.278em" rspace="0.278em" id="A10.E49.m2.2.2.2.2.2.2.2.3.1" xref="A10.E49.m2.2.2.2.2.2.2.2.3.1.cmml">:</mo><mi id="A10.E49.m2.2.2.2.2.2.2.2.3.3" xref="A10.E49.m2.2.2.2.2.2.2.2.3.3.cmml">K</mi></mrow></msub><mo id="A10.E49.m2.3.3.3.3.3.3.6" xref="A10.E49.m2.3.3.3.3.3.4.cmml">,</mo><msub id="A10.E49.m2.3.3.3.3.3.3.3" xref="A10.E49.m2.3.3.3.3.3.3.3.cmml"><mi id="A10.E49.m2.3.3.3.3.3.3.3.2" xref="A10.E49.m2.3.3.3.3.3.3.3.2.cmml">𝐰</mi><mi id="A10.E49.m2.3.3.3.3.3.3.3.3" xref="A10.E49.m2.3.3.3.3.3.3.3.3.cmml">s</mi></msub><mo stretchy="false" id="A10.E49.m2.3.3.3.3.3.3.7" xref="A10.E49.m2.3.3.3.3.3.4.cmml">)</mo></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="A10.E49.m2.3b"><apply id="A10.E49.m2.3.3.cmml" xref="A10.E49.m2.3.3"><csymbol cd="latexml" id="A10.E49.m2.3.3.4.cmml" xref="A10.E49.m2.3.3.4">assign</csymbol><csymbol cd="latexml" id="A10.E49.m2.3.3.5.cmml" xref="A10.E49.m2.3.3.5">absent</csymbol><apply id="A10.E49.m2.3.3.3.cmml" xref="A10.E49.m2.3.3.3"><apply id="A10.E49.m2.3.3.3.4.cmml" xref="A10.E49.m2.3.3.3.4"><csymbol cd="ambiguous" id="A10.E49.m2.3.3.3.4.1.cmml" xref="A10.E49.m2.3.3.3.4">subscript</csymbol><sum id="A10.E49.m2.3.3.3.4.2.cmml" xref="A10.E49.m2.3.3.3.4.2"></sum><ci id="A10.E49.m2.3.3.3.4.3.cmml" xref="A10.E49.m2.3.3.3.4.3">𝑠</ci></apply><apply id="A10.E49.m2.3.3.3.3.cmml" xref="A10.E49.m2.3.3.3.3"><times id="A10.E49.m2.3.3.3.3.4.cmml" xref="A10.E49.m2.3.3.3.3.4"></times><apply id="A10.E49.m2.3.3.3.3.5.cmml" xref="A10.E49.m2.3.3.3.3.5"><csymbol cd="ambiguous" id="A10.E49.m2.3.3.3.3.5.1.cmml" xref="A10.E49.m2.3.3.3.3.5">subscript</csymbol><ci id="A10.E49.m2.3.3.3.3.5.2.cmml" xref="A10.E49.m2.3.3.3.3.5.2">ℒ</ci><ci id="A10.E49.m2.3.3.3.3.5.3.cmml" xref="A10.E49.m2.3.3.3.3.5.3">𝑠</ci></apply><vector id="A10.E49.m2.3.3.3.3.3.4.cmml" xref="A10.E49.m2.3.3.3.3.3.3"><apply id="A10.E49.m2.1.1.1.1.1.1.1.cmml" xref="A10.E49.m2.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="A10.E49.m2.1.1.1.1.1.1.1.1.cmml" xref="A10.E49.m2.1.1.1.1.1.1.1">subscript</csymbol><ci id="A10.E49.m2.1.1.1.1.1.1.1.2.cmml" xref="A10.E49.m2.1.1.1.1.1.1.1.2">𝒟</ci><ci id="A10.E49.m2.1.1.1.1.1.1.1.3.cmml" xref="A10.E49.m2.1.1.1.1.1.1.1.3">𝑠</ci></apply><apply id="A10.E49.m2.2.2.2.2.2.2.2.cmml" xref="A10.E49.m2.2.2.2.2.2.2.2"><csymbol cd="ambiguous" id="A10.E49.m2.2.2.2.2.2.2.2.1.cmml" xref="A10.E49.m2.2.2.2.2.2.2.2">subscript</csymbol><ci id="A10.E49.m2.2.2.2.2.2.2.2.2.cmml" xref="A10.E49.m2.2.2.2.2.2.2.2.2">𝐰</ci><apply id="A10.E49.m2.2.2.2.2.2.2.2.3.cmml" xref="A10.E49.m2.2.2.2.2.2.2.2.3"><ci id="A10.E49.m2.2.2.2.2.2.2.2.3.1.cmml" xref="A10.E49.m2.2.2.2.2.2.2.2.3.1">:</ci><cn type="integer" id="A10.E49.m2.2.2.2.2.2.2.2.3.2.cmml" xref="A10.E49.m2.2.2.2.2.2.2.2.3.2">1</cn><ci id="A10.E49.m2.2.2.2.2.2.2.2.3.3.cmml" xref="A10.E49.m2.2.2.2.2.2.2.2.3.3">𝐾</ci></apply></apply><apply id="A10.E49.m2.3.3.3.3.3.3.3.cmml" xref="A10.E49.m2.3.3.3.3.3.3.3"><csymbol cd="ambiguous" id="A10.E49.m2.3.3.3.3.3.3.3.1.cmml" xref="A10.E49.m2.3.3.3.3.3.3.3">subscript</csymbol><ci id="A10.E49.m2.3.3.3.3.3.3.3.2.cmml" xref="A10.E49.m2.3.3.3.3.3.3.3.2">𝐰</ci><ci id="A10.E49.m2.3.3.3.3.3.3.3.3.cmml" xref="A10.E49.m2.3.3.3.3.3.3.3.3">𝑠</ci></apply></vector></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A10.E49.m2.3c">\displaystyle:=\sum_{s}\mathcal{L}_{s}(\mathcal{D}_{s},\mathbf{w}_{1:K},\mathbf{w}_{s})</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(49)</span></td>
</tr></tbody>
</table>
<p id="A10.SS2.p1.9" class="ltx_p">where <math id="A10.SS2.p1.3.m1.1" class="ltx_Math" alttext="Z_{k}" display="inline"><semantics id="A10.SS2.p1.3.m1.1a"><msub id="A10.SS2.p1.3.m1.1.1" xref="A10.SS2.p1.3.m1.1.1.cmml"><mi id="A10.SS2.p1.3.m1.1.1.2" xref="A10.SS2.p1.3.m1.1.1.2.cmml">Z</mi><mi id="A10.SS2.p1.3.m1.1.1.3" xref="A10.SS2.p1.3.m1.1.1.3.cmml">k</mi></msub><annotation-xml encoding="MathML-Content" id="A10.SS2.p1.3.m1.1b"><apply id="A10.SS2.p1.3.m1.1.1.cmml" xref="A10.SS2.p1.3.m1.1.1"><csymbol cd="ambiguous" id="A10.SS2.p1.3.m1.1.1.1.cmml" xref="A10.SS2.p1.3.m1.1.1">subscript</csymbol><ci id="A10.SS2.p1.3.m1.1.1.2.cmml" xref="A10.SS2.p1.3.m1.1.1.2">𝑍</ci><ci id="A10.SS2.p1.3.m1.1.1.3.cmml" xref="A10.SS2.p1.3.m1.1.1.3">𝑘</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A10.SS2.p1.3.m1.1c">Z_{k}</annotation></semantics></math> is the normalizing constant of component <math id="A10.SS2.p1.4.m2.1" class="ltx_Math" alttext="k" display="inline"><semantics id="A10.SS2.p1.4.m2.1a"><mi id="A10.SS2.p1.4.m2.1.1" xref="A10.SS2.p1.4.m2.1.1.cmml">k</mi><annotation-xml encoding="MathML-Content" id="A10.SS2.p1.4.m2.1b"><ci id="A10.SS2.p1.4.m2.1.1.cmml" xref="A10.SS2.p1.4.m2.1.1">𝑘</ci></annotation-xml><annotation encoding="application/x-tex" id="A10.SS2.p1.4.m2.1c">k</annotation></semantics></math>. Now we can proceed in a similar fashion and select a subset of shards <math id="A10.SS2.p1.5.m3.1" class="ltx_Math" alttext="B" display="inline"><semantics id="A10.SS2.p1.5.m3.1a"><mi id="A10.SS2.p1.5.m3.1.1" xref="A10.SS2.p1.5.m3.1.1.cmml">B</mi><annotation-xml encoding="MathML-Content" id="A10.SS2.p1.5.m3.1b"><ci id="A10.SS2.p1.5.m3.1.1.cmml" xref="A10.SS2.p1.5.m3.1.1">𝐵</ci></annotation-xml><annotation encoding="application/x-tex" id="A10.SS2.p1.5.m3.1c">B</annotation></semantics></math> to obtain the <math id="A10.SS2.p1.6.m4.1" class="ltx_Math" alttext="\bm{\phi}_{s}^{*}" display="inline"><semantics id="A10.SS2.p1.6.m4.1a"><msubsup id="A10.SS2.p1.6.m4.1.1" xref="A10.SS2.p1.6.m4.1.1.cmml"><mi class="ltx_mathvariant_bold-italic" mathvariant="bold-italic" id="A10.SS2.p1.6.m4.1.1.2.2" xref="A10.SS2.p1.6.m4.1.1.2.2.cmml">ϕ</mi><mi id="A10.SS2.p1.6.m4.1.1.2.3" xref="A10.SS2.p1.6.m4.1.1.2.3.cmml">s</mi><mo id="A10.SS2.p1.6.m4.1.1.3" xref="A10.SS2.p1.6.m4.1.1.3.cmml">∗</mo></msubsup><annotation-xml encoding="MathML-Content" id="A10.SS2.p1.6.m4.1b"><apply id="A10.SS2.p1.6.m4.1.1.cmml" xref="A10.SS2.p1.6.m4.1.1"><csymbol cd="ambiguous" id="A10.SS2.p1.6.m4.1.1.1.cmml" xref="A10.SS2.p1.6.m4.1.1">superscript</csymbol><apply id="A10.SS2.p1.6.m4.1.1.2.cmml" xref="A10.SS2.p1.6.m4.1.1"><csymbol cd="ambiguous" id="A10.SS2.p1.6.m4.1.1.2.1.cmml" xref="A10.SS2.p1.6.m4.1.1">subscript</csymbol><ci id="A10.SS2.p1.6.m4.1.1.2.2.cmml" xref="A10.SS2.p1.6.m4.1.1.2.2">bold-italic-ϕ</ci><ci id="A10.SS2.p1.6.m4.1.1.2.3.cmml" xref="A10.SS2.p1.6.m4.1.1.2.3">𝑠</ci></apply><times id="A10.SS2.p1.6.m4.1.1.3.cmml" xref="A10.SS2.p1.6.m4.1.1.3"></times></apply></annotation-xml><annotation encoding="application/x-tex" id="A10.SS2.p1.6.m4.1c">\bm{\phi}_{s}^{*}</annotation></semantics></math> while keeping the parameters of the prior <math id="A10.SS2.p1.7.m5.1" class="ltx_Math" alttext="\mathbf{w}_{1:K}" display="inline"><semantics id="A10.SS2.p1.7.m5.1a"><msub id="A10.SS2.p1.7.m5.1.1" xref="A10.SS2.p1.7.m5.1.1.cmml"><mi id="A10.SS2.p1.7.m5.1.1.2" xref="A10.SS2.p1.7.m5.1.1.2.cmml">𝐰</mi><mrow id="A10.SS2.p1.7.m5.1.1.3" xref="A10.SS2.p1.7.m5.1.1.3.cmml"><mn id="A10.SS2.p1.7.m5.1.1.3.2" xref="A10.SS2.p1.7.m5.1.1.3.2.cmml">1</mn><mo lspace="0.278em" rspace="0.278em" id="A10.SS2.p1.7.m5.1.1.3.1" xref="A10.SS2.p1.7.m5.1.1.3.1.cmml">:</mo><mi id="A10.SS2.p1.7.m5.1.1.3.3" xref="A10.SS2.p1.7.m5.1.1.3.3.cmml">K</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="A10.SS2.p1.7.m5.1b"><apply id="A10.SS2.p1.7.m5.1.1.cmml" xref="A10.SS2.p1.7.m5.1.1"><csymbol cd="ambiguous" id="A10.SS2.p1.7.m5.1.1.1.cmml" xref="A10.SS2.p1.7.m5.1.1">subscript</csymbol><ci id="A10.SS2.p1.7.m5.1.1.2.cmml" xref="A10.SS2.p1.7.m5.1.1.2">𝐰</ci><apply id="A10.SS2.p1.7.m5.1.1.3.cmml" xref="A10.SS2.p1.7.m5.1.1.3"><ci id="A10.SS2.p1.7.m5.1.1.3.1.cmml" xref="A10.SS2.p1.7.m5.1.1.3.1">:</ci><cn type="integer" id="A10.SS2.p1.7.m5.1.1.3.2.cmml" xref="A10.SS2.p1.7.m5.1.1.3.2">1</cn><ci id="A10.SS2.p1.7.m5.1.1.3.3.cmml" xref="A10.SS2.p1.7.m5.1.1.3.3">𝐾</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A10.SS2.p1.7.m5.1c">\mathbf{w}_{1:K}</annotation></semantics></math> fixed. Now by taking the gradient with respect to one of the members of the ensemble <math id="A10.SS2.p1.8.m6.1" class="ltx_Math" alttext="\mathbf{w}_{k}" display="inline"><semantics id="A10.SS2.p1.8.m6.1a"><msub id="A10.SS2.p1.8.m6.1.1" xref="A10.SS2.p1.8.m6.1.1.cmml"><mi id="A10.SS2.p1.8.m6.1.1.2" xref="A10.SS2.p1.8.m6.1.1.2.cmml">𝐰</mi><mi id="A10.SS2.p1.8.m6.1.1.3" xref="A10.SS2.p1.8.m6.1.1.3.cmml">k</mi></msub><annotation-xml encoding="MathML-Content" id="A10.SS2.p1.8.m6.1b"><apply id="A10.SS2.p1.8.m6.1.1.cmml" xref="A10.SS2.p1.8.m6.1.1"><csymbol cd="ambiguous" id="A10.SS2.p1.8.m6.1.1.1.cmml" xref="A10.SS2.p1.8.m6.1.1">subscript</csymbol><ci id="A10.SS2.p1.8.m6.1.1.2.cmml" xref="A10.SS2.p1.8.m6.1.1.2">𝐰</ci><ci id="A10.SS2.p1.8.m6.1.1.3.cmml" xref="A10.SS2.p1.8.m6.1.1.3">𝑘</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A10.SS2.p1.8.m6.1c">\mathbf{w}_{k}</annotation></semantics></math>, given the optimized local parameters <math id="A10.SS2.p1.9.m7.1" class="ltx_Math" alttext="\bm{\phi}_{s}^{*}" display="inline"><semantics id="A10.SS2.p1.9.m7.1a"><msubsup id="A10.SS2.p1.9.m7.1.1" xref="A10.SS2.p1.9.m7.1.1.cmml"><mi class="ltx_mathvariant_bold-italic" mathvariant="bold-italic" id="A10.SS2.p1.9.m7.1.1.2.2" xref="A10.SS2.p1.9.m7.1.1.2.2.cmml">ϕ</mi><mi id="A10.SS2.p1.9.m7.1.1.2.3" xref="A10.SS2.p1.9.m7.1.1.2.3.cmml">s</mi><mo id="A10.SS2.p1.9.m7.1.1.3" xref="A10.SS2.p1.9.m7.1.1.3.cmml">∗</mo></msubsup><annotation-xml encoding="MathML-Content" id="A10.SS2.p1.9.m7.1b"><apply id="A10.SS2.p1.9.m7.1.1.cmml" xref="A10.SS2.p1.9.m7.1.1"><csymbol cd="ambiguous" id="A10.SS2.p1.9.m7.1.1.1.cmml" xref="A10.SS2.p1.9.m7.1.1">superscript</csymbol><apply id="A10.SS2.p1.9.m7.1.1.2.cmml" xref="A10.SS2.p1.9.m7.1.1"><csymbol cd="ambiguous" id="A10.SS2.p1.9.m7.1.1.2.1.cmml" xref="A10.SS2.p1.9.m7.1.1">subscript</csymbol><ci id="A10.SS2.p1.9.m7.1.1.2.2.cmml" xref="A10.SS2.p1.9.m7.1.1.2.2">bold-italic-ϕ</ci><ci id="A10.SS2.p1.9.m7.1.1.2.3.cmml" xref="A10.SS2.p1.9.m7.1.1.2.3">𝑠</ci></apply><times id="A10.SS2.p1.9.m7.1.1.3.cmml" xref="A10.SS2.p1.9.m7.1.1.3"></times></apply></annotation-xml><annotation encoding="application/x-tex" id="A10.SS2.p1.9.m7.1c">\bm{\phi}_{s}^{*}</annotation></semantics></math>, we see that</p>
<table id="A10.EGx41" class="ltx_equationgroup ltx_eqn_align ltx_eqn_table">

<tbody id="A10.E50"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math id="A10.E50.m1.5" class="ltx_Math" alttext="\displaystyle\frac{\partial L}{\partial\mathbf{w}_{k}}=\lambda\sum_{s}\frac{\frac{Z_{k}}{K}\exp(-\frac{\lambda}{2}\|\mathbf{w}_{s}-\mathbf{w}_{k}\|^{2})}{\sum_{j}\frac{Z_{j}}{K}\exp(-\frac{\lambda}{2}\|\mathbf{w}_{s}-\mathbf{w}_{j}\|^{2})}(\mathbf{w}_{s}-\mathbf{w}_{k})." display="inline"><semantics id="A10.E50.m1.5a"><mrow id="A10.E50.m1.5.5.1" xref="A10.E50.m1.5.5.1.1.cmml"><mrow id="A10.E50.m1.5.5.1.1" xref="A10.E50.m1.5.5.1.1.cmml"><mstyle displaystyle="true" id="A10.E50.m1.5.5.1.1.3" xref="A10.E50.m1.5.5.1.1.3.cmml"><mfrac id="A10.E50.m1.5.5.1.1.3a" xref="A10.E50.m1.5.5.1.1.3.cmml"><mrow id="A10.E50.m1.5.5.1.1.3.2" xref="A10.E50.m1.5.5.1.1.3.2.cmml"><mo rspace="0em" id="A10.E50.m1.5.5.1.1.3.2.1" xref="A10.E50.m1.5.5.1.1.3.2.1.cmml">∂</mo><mi id="A10.E50.m1.5.5.1.1.3.2.2" xref="A10.E50.m1.5.5.1.1.3.2.2.cmml">L</mi></mrow><mrow id="A10.E50.m1.5.5.1.1.3.3" xref="A10.E50.m1.5.5.1.1.3.3.cmml"><mo rspace="0em" id="A10.E50.m1.5.5.1.1.3.3.1" xref="A10.E50.m1.5.5.1.1.3.3.1.cmml">∂</mo><msub id="A10.E50.m1.5.5.1.1.3.3.2" xref="A10.E50.m1.5.5.1.1.3.3.2.cmml"><mi id="A10.E50.m1.5.5.1.1.3.3.2.2" xref="A10.E50.m1.5.5.1.1.3.3.2.2.cmml">𝐰</mi><mi id="A10.E50.m1.5.5.1.1.3.3.2.3" xref="A10.E50.m1.5.5.1.1.3.3.2.3.cmml">k</mi></msub></mrow></mfrac></mstyle><mo id="A10.E50.m1.5.5.1.1.2" xref="A10.E50.m1.5.5.1.1.2.cmml">=</mo><mrow id="A10.E50.m1.5.5.1.1.1" xref="A10.E50.m1.5.5.1.1.1.cmml"><mi id="A10.E50.m1.5.5.1.1.1.3" xref="A10.E50.m1.5.5.1.1.1.3.cmml">λ</mi><mo lspace="0em" rspace="0em" id="A10.E50.m1.5.5.1.1.1.2" xref="A10.E50.m1.5.5.1.1.1.2.cmml">​</mo><mrow id="A10.E50.m1.5.5.1.1.1.1" xref="A10.E50.m1.5.5.1.1.1.1.cmml"><mstyle displaystyle="true" id="A10.E50.m1.5.5.1.1.1.1.2" xref="A10.E50.m1.5.5.1.1.1.1.2.cmml"><munder id="A10.E50.m1.5.5.1.1.1.1.2a" xref="A10.E50.m1.5.5.1.1.1.1.2.cmml"><mo movablelimits="false" id="A10.E50.m1.5.5.1.1.1.1.2.2" xref="A10.E50.m1.5.5.1.1.1.1.2.2.cmml">∑</mo><mi id="A10.E50.m1.5.5.1.1.1.1.2.3" xref="A10.E50.m1.5.5.1.1.1.1.2.3.cmml">s</mi></munder></mstyle><mrow id="A10.E50.m1.5.5.1.1.1.1.1" xref="A10.E50.m1.5.5.1.1.1.1.1.cmml"><mstyle displaystyle="true" id="A10.E50.m1.4.4" xref="A10.E50.m1.4.4.cmml"><mfrac id="A10.E50.m1.4.4a" xref="A10.E50.m1.4.4.cmml"><mrow id="A10.E50.m1.2.2.2" xref="A10.E50.m1.2.2.2.cmml"><mfrac id="A10.E50.m1.2.2.2.4" xref="A10.E50.m1.2.2.2.4.cmml"><msub id="A10.E50.m1.2.2.2.4.2" xref="A10.E50.m1.2.2.2.4.2.cmml"><mi id="A10.E50.m1.2.2.2.4.2.2" xref="A10.E50.m1.2.2.2.4.2.2.cmml">Z</mi><mi id="A10.E50.m1.2.2.2.4.2.3" xref="A10.E50.m1.2.2.2.4.2.3.cmml">k</mi></msub><mi id="A10.E50.m1.2.2.2.4.3" xref="A10.E50.m1.2.2.2.4.3.cmml">K</mi></mfrac><mo lspace="0.167em" rspace="0em" id="A10.E50.m1.2.2.2.3" xref="A10.E50.m1.2.2.2.3.cmml">​</mo><mrow id="A10.E50.m1.2.2.2.2.1" xref="A10.E50.m1.2.2.2.2.2.cmml"><mi id="A10.E50.m1.1.1.1.1" xref="A10.E50.m1.1.1.1.1.cmml">exp</mi><mo id="A10.E50.m1.2.2.2.2.1a" xref="A10.E50.m1.2.2.2.2.2.cmml">⁡</mo><mrow id="A10.E50.m1.2.2.2.2.1.1" xref="A10.E50.m1.2.2.2.2.2.cmml"><mo stretchy="false" id="A10.E50.m1.2.2.2.2.1.1.2" xref="A10.E50.m1.2.2.2.2.2.cmml">(</mo><mrow id="A10.E50.m1.2.2.2.2.1.1.1" xref="A10.E50.m1.2.2.2.2.1.1.1.cmml"><mo id="A10.E50.m1.2.2.2.2.1.1.1a" xref="A10.E50.m1.2.2.2.2.1.1.1.cmml">−</mo><mrow id="A10.E50.m1.2.2.2.2.1.1.1.1" xref="A10.E50.m1.2.2.2.2.1.1.1.1.cmml"><mfrac id="A10.E50.m1.2.2.2.2.1.1.1.1.3" xref="A10.E50.m1.2.2.2.2.1.1.1.1.3.cmml"><mi id="A10.E50.m1.2.2.2.2.1.1.1.1.3.2" xref="A10.E50.m1.2.2.2.2.1.1.1.1.3.2.cmml">λ</mi><mn id="A10.E50.m1.2.2.2.2.1.1.1.1.3.3" xref="A10.E50.m1.2.2.2.2.1.1.1.1.3.3.cmml">2</mn></mfrac><mo lspace="0em" rspace="0em" id="A10.E50.m1.2.2.2.2.1.1.1.1.2" xref="A10.E50.m1.2.2.2.2.1.1.1.1.2.cmml">​</mo><msup id="A10.E50.m1.2.2.2.2.1.1.1.1.1" xref="A10.E50.m1.2.2.2.2.1.1.1.1.1.cmml"><mrow id="A10.E50.m1.2.2.2.2.1.1.1.1.1.1.1" xref="A10.E50.m1.2.2.2.2.1.1.1.1.1.1.2.cmml"><mo stretchy="false" id="A10.E50.m1.2.2.2.2.1.1.1.1.1.1.1.2" xref="A10.E50.m1.2.2.2.2.1.1.1.1.1.1.2.1.cmml">‖</mo><mrow id="A10.E50.m1.2.2.2.2.1.1.1.1.1.1.1.1" xref="A10.E50.m1.2.2.2.2.1.1.1.1.1.1.1.1.cmml"><msub id="A10.E50.m1.2.2.2.2.1.1.1.1.1.1.1.1.2" xref="A10.E50.m1.2.2.2.2.1.1.1.1.1.1.1.1.2.cmml"><mi id="A10.E50.m1.2.2.2.2.1.1.1.1.1.1.1.1.2.2" xref="A10.E50.m1.2.2.2.2.1.1.1.1.1.1.1.1.2.2.cmml">𝐰</mi><mi id="A10.E50.m1.2.2.2.2.1.1.1.1.1.1.1.1.2.3" xref="A10.E50.m1.2.2.2.2.1.1.1.1.1.1.1.1.2.3.cmml">s</mi></msub><mo id="A10.E50.m1.2.2.2.2.1.1.1.1.1.1.1.1.1" xref="A10.E50.m1.2.2.2.2.1.1.1.1.1.1.1.1.1.cmml">−</mo><msub id="A10.E50.m1.2.2.2.2.1.1.1.1.1.1.1.1.3" xref="A10.E50.m1.2.2.2.2.1.1.1.1.1.1.1.1.3.cmml"><mi id="A10.E50.m1.2.2.2.2.1.1.1.1.1.1.1.1.3.2" xref="A10.E50.m1.2.2.2.2.1.1.1.1.1.1.1.1.3.2.cmml">𝐰</mi><mi id="A10.E50.m1.2.2.2.2.1.1.1.1.1.1.1.1.3.3" xref="A10.E50.m1.2.2.2.2.1.1.1.1.1.1.1.1.3.3.cmml">k</mi></msub></mrow><mo stretchy="false" id="A10.E50.m1.2.2.2.2.1.1.1.1.1.1.1.3" xref="A10.E50.m1.2.2.2.2.1.1.1.1.1.1.2.1.cmml">‖</mo></mrow><mn id="A10.E50.m1.2.2.2.2.1.1.1.1.1.3" xref="A10.E50.m1.2.2.2.2.1.1.1.1.1.3.cmml">2</mn></msup></mrow></mrow><mo stretchy="false" id="A10.E50.m1.2.2.2.2.1.1.3" xref="A10.E50.m1.2.2.2.2.2.cmml">)</mo></mrow></mrow></mrow><mrow id="A10.E50.m1.4.4.4" xref="A10.E50.m1.4.4.4.cmml"><msub id="A10.E50.m1.4.4.4.3" xref="A10.E50.m1.4.4.4.3.cmml"><mo id="A10.E50.m1.4.4.4.3.2" xref="A10.E50.m1.4.4.4.3.2.cmml">∑</mo><mi id="A10.E50.m1.4.4.4.3.3" xref="A10.E50.m1.4.4.4.3.3.cmml">j</mi></msub><mrow id="A10.E50.m1.4.4.4.2" xref="A10.E50.m1.4.4.4.2.cmml"><mfrac id="A10.E50.m1.4.4.4.2.3" xref="A10.E50.m1.4.4.4.2.3.cmml"><msub id="A10.E50.m1.4.4.4.2.3.2" xref="A10.E50.m1.4.4.4.2.3.2.cmml"><mi id="A10.E50.m1.4.4.4.2.3.2.2" xref="A10.E50.m1.4.4.4.2.3.2.2.cmml">Z</mi><mi id="A10.E50.m1.4.4.4.2.3.2.3" xref="A10.E50.m1.4.4.4.2.3.2.3.cmml">j</mi></msub><mi id="A10.E50.m1.4.4.4.2.3.3" xref="A10.E50.m1.4.4.4.2.3.3.cmml">K</mi></mfrac><mo lspace="0.167em" rspace="0em" id="A10.E50.m1.4.4.4.2.2" xref="A10.E50.m1.4.4.4.2.2.cmml">​</mo><mrow id="A10.E50.m1.4.4.4.2.1.1" xref="A10.E50.m1.4.4.4.2.1.2.cmml"><mi id="A10.E50.m1.3.3.3.1" xref="A10.E50.m1.3.3.3.1.cmml">exp</mi><mo id="A10.E50.m1.4.4.4.2.1.1a" xref="A10.E50.m1.4.4.4.2.1.2.cmml">⁡</mo><mrow id="A10.E50.m1.4.4.4.2.1.1.1" xref="A10.E50.m1.4.4.4.2.1.2.cmml"><mo stretchy="false" id="A10.E50.m1.4.4.4.2.1.1.1.2" xref="A10.E50.m1.4.4.4.2.1.2.cmml">(</mo><mrow id="A10.E50.m1.4.4.4.2.1.1.1.1" xref="A10.E50.m1.4.4.4.2.1.1.1.1.cmml"><mo id="A10.E50.m1.4.4.4.2.1.1.1.1a" xref="A10.E50.m1.4.4.4.2.1.1.1.1.cmml">−</mo><mrow id="A10.E50.m1.4.4.4.2.1.1.1.1.1" xref="A10.E50.m1.4.4.4.2.1.1.1.1.1.cmml"><mfrac id="A10.E50.m1.4.4.4.2.1.1.1.1.1.3" xref="A10.E50.m1.4.4.4.2.1.1.1.1.1.3.cmml"><mi id="A10.E50.m1.4.4.4.2.1.1.1.1.1.3.2" xref="A10.E50.m1.4.4.4.2.1.1.1.1.1.3.2.cmml">λ</mi><mn id="A10.E50.m1.4.4.4.2.1.1.1.1.1.3.3" xref="A10.E50.m1.4.4.4.2.1.1.1.1.1.3.3.cmml">2</mn></mfrac><mo lspace="0em" rspace="0em" id="A10.E50.m1.4.4.4.2.1.1.1.1.1.2" xref="A10.E50.m1.4.4.4.2.1.1.1.1.1.2.cmml">​</mo><msup id="A10.E50.m1.4.4.4.2.1.1.1.1.1.1" xref="A10.E50.m1.4.4.4.2.1.1.1.1.1.1.cmml"><mrow id="A10.E50.m1.4.4.4.2.1.1.1.1.1.1.1.1" xref="A10.E50.m1.4.4.4.2.1.1.1.1.1.1.1.2.cmml"><mo stretchy="false" id="A10.E50.m1.4.4.4.2.1.1.1.1.1.1.1.1.2" xref="A10.E50.m1.4.4.4.2.1.1.1.1.1.1.1.2.1.cmml">‖</mo><mrow id="A10.E50.m1.4.4.4.2.1.1.1.1.1.1.1.1.1" xref="A10.E50.m1.4.4.4.2.1.1.1.1.1.1.1.1.1.cmml"><msub id="A10.E50.m1.4.4.4.2.1.1.1.1.1.1.1.1.1.2" xref="A10.E50.m1.4.4.4.2.1.1.1.1.1.1.1.1.1.2.cmml"><mi id="A10.E50.m1.4.4.4.2.1.1.1.1.1.1.1.1.1.2.2" xref="A10.E50.m1.4.4.4.2.1.1.1.1.1.1.1.1.1.2.2.cmml">𝐰</mi><mi id="A10.E50.m1.4.4.4.2.1.1.1.1.1.1.1.1.1.2.3" xref="A10.E50.m1.4.4.4.2.1.1.1.1.1.1.1.1.1.2.3.cmml">s</mi></msub><mo id="A10.E50.m1.4.4.4.2.1.1.1.1.1.1.1.1.1.1" xref="A10.E50.m1.4.4.4.2.1.1.1.1.1.1.1.1.1.1.cmml">−</mo><msub id="A10.E50.m1.4.4.4.2.1.1.1.1.1.1.1.1.1.3" xref="A10.E50.m1.4.4.4.2.1.1.1.1.1.1.1.1.1.3.cmml"><mi id="A10.E50.m1.4.4.4.2.1.1.1.1.1.1.1.1.1.3.2" xref="A10.E50.m1.4.4.4.2.1.1.1.1.1.1.1.1.1.3.2.cmml">𝐰</mi><mi id="A10.E50.m1.4.4.4.2.1.1.1.1.1.1.1.1.1.3.3" xref="A10.E50.m1.4.4.4.2.1.1.1.1.1.1.1.1.1.3.3.cmml">j</mi></msub></mrow><mo stretchy="false" id="A10.E50.m1.4.4.4.2.1.1.1.1.1.1.1.1.3" xref="A10.E50.m1.4.4.4.2.1.1.1.1.1.1.1.2.1.cmml">‖</mo></mrow><mn id="A10.E50.m1.4.4.4.2.1.1.1.1.1.1.3" xref="A10.E50.m1.4.4.4.2.1.1.1.1.1.1.3.cmml">2</mn></msup></mrow></mrow><mo stretchy="false" id="A10.E50.m1.4.4.4.2.1.1.1.3" xref="A10.E50.m1.4.4.4.2.1.2.cmml">)</mo></mrow></mrow></mrow></mrow></mfrac></mstyle><mo lspace="0em" rspace="0em" id="A10.E50.m1.5.5.1.1.1.1.1.2" xref="A10.E50.m1.5.5.1.1.1.1.1.2.cmml">​</mo><mrow id="A10.E50.m1.5.5.1.1.1.1.1.1.1" xref="A10.E50.m1.5.5.1.1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="A10.E50.m1.5.5.1.1.1.1.1.1.1.2" xref="A10.E50.m1.5.5.1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="A10.E50.m1.5.5.1.1.1.1.1.1.1.1" xref="A10.E50.m1.5.5.1.1.1.1.1.1.1.1.cmml"><msub id="A10.E50.m1.5.5.1.1.1.1.1.1.1.1.2" xref="A10.E50.m1.5.5.1.1.1.1.1.1.1.1.2.cmml"><mi id="A10.E50.m1.5.5.1.1.1.1.1.1.1.1.2.2" xref="A10.E50.m1.5.5.1.1.1.1.1.1.1.1.2.2.cmml">𝐰</mi><mi id="A10.E50.m1.5.5.1.1.1.1.1.1.1.1.2.3" xref="A10.E50.m1.5.5.1.1.1.1.1.1.1.1.2.3.cmml">s</mi></msub><mo id="A10.E50.m1.5.5.1.1.1.1.1.1.1.1.1" xref="A10.E50.m1.5.5.1.1.1.1.1.1.1.1.1.cmml">−</mo><msub id="A10.E50.m1.5.5.1.1.1.1.1.1.1.1.3" xref="A10.E50.m1.5.5.1.1.1.1.1.1.1.1.3.cmml"><mi id="A10.E50.m1.5.5.1.1.1.1.1.1.1.1.3.2" xref="A10.E50.m1.5.5.1.1.1.1.1.1.1.1.3.2.cmml">𝐰</mi><mi id="A10.E50.m1.5.5.1.1.1.1.1.1.1.1.3.3" xref="A10.E50.m1.5.5.1.1.1.1.1.1.1.1.3.3.cmml">k</mi></msub></mrow><mo stretchy="false" id="A10.E50.m1.5.5.1.1.1.1.1.1.1.3" xref="A10.E50.m1.5.5.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow></mrow></mrow><mo lspace="0em" id="A10.E50.m1.5.5.1.2" xref="A10.E50.m1.5.5.1.1.cmml">.</mo></mrow><annotation-xml encoding="MathML-Content" id="A10.E50.m1.5b"><apply id="A10.E50.m1.5.5.1.1.cmml" xref="A10.E50.m1.5.5.1"><eq id="A10.E50.m1.5.5.1.1.2.cmml" xref="A10.E50.m1.5.5.1.1.2"></eq><apply id="A10.E50.m1.5.5.1.1.3.cmml" xref="A10.E50.m1.5.5.1.1.3"><divide id="A10.E50.m1.5.5.1.1.3.1.cmml" xref="A10.E50.m1.5.5.1.1.3"></divide><apply id="A10.E50.m1.5.5.1.1.3.2.cmml" xref="A10.E50.m1.5.5.1.1.3.2"><partialdiff id="A10.E50.m1.5.5.1.1.3.2.1.cmml" xref="A10.E50.m1.5.5.1.1.3.2.1"></partialdiff><ci id="A10.E50.m1.5.5.1.1.3.2.2.cmml" xref="A10.E50.m1.5.5.1.1.3.2.2">𝐿</ci></apply><apply id="A10.E50.m1.5.5.1.1.3.3.cmml" xref="A10.E50.m1.5.5.1.1.3.3"><partialdiff id="A10.E50.m1.5.5.1.1.3.3.1.cmml" xref="A10.E50.m1.5.5.1.1.3.3.1"></partialdiff><apply id="A10.E50.m1.5.5.1.1.3.3.2.cmml" xref="A10.E50.m1.5.5.1.1.3.3.2"><csymbol cd="ambiguous" id="A10.E50.m1.5.5.1.1.3.3.2.1.cmml" xref="A10.E50.m1.5.5.1.1.3.3.2">subscript</csymbol><ci id="A10.E50.m1.5.5.1.1.3.3.2.2.cmml" xref="A10.E50.m1.5.5.1.1.3.3.2.2">𝐰</ci><ci id="A10.E50.m1.5.5.1.1.3.3.2.3.cmml" xref="A10.E50.m1.5.5.1.1.3.3.2.3">𝑘</ci></apply></apply></apply><apply id="A10.E50.m1.5.5.1.1.1.cmml" xref="A10.E50.m1.5.5.1.1.1"><times id="A10.E50.m1.5.5.1.1.1.2.cmml" xref="A10.E50.m1.5.5.1.1.1.2"></times><ci id="A10.E50.m1.5.5.1.1.1.3.cmml" xref="A10.E50.m1.5.5.1.1.1.3">𝜆</ci><apply id="A10.E50.m1.5.5.1.1.1.1.cmml" xref="A10.E50.m1.5.5.1.1.1.1"><apply id="A10.E50.m1.5.5.1.1.1.1.2.cmml" xref="A10.E50.m1.5.5.1.1.1.1.2"><csymbol cd="ambiguous" id="A10.E50.m1.5.5.1.1.1.1.2.1.cmml" xref="A10.E50.m1.5.5.1.1.1.1.2">subscript</csymbol><sum id="A10.E50.m1.5.5.1.1.1.1.2.2.cmml" xref="A10.E50.m1.5.5.1.1.1.1.2.2"></sum><ci id="A10.E50.m1.5.5.1.1.1.1.2.3.cmml" xref="A10.E50.m1.5.5.1.1.1.1.2.3">𝑠</ci></apply><apply id="A10.E50.m1.5.5.1.1.1.1.1.cmml" xref="A10.E50.m1.5.5.1.1.1.1.1"><times id="A10.E50.m1.5.5.1.1.1.1.1.2.cmml" xref="A10.E50.m1.5.5.1.1.1.1.1.2"></times><apply id="A10.E50.m1.4.4.cmml" xref="A10.E50.m1.4.4"><divide id="A10.E50.m1.4.4.5.cmml" xref="A10.E50.m1.4.4"></divide><apply id="A10.E50.m1.2.2.2.cmml" xref="A10.E50.m1.2.2.2"><times id="A10.E50.m1.2.2.2.3.cmml" xref="A10.E50.m1.2.2.2.3"></times><apply id="A10.E50.m1.2.2.2.4.cmml" xref="A10.E50.m1.2.2.2.4"><divide id="A10.E50.m1.2.2.2.4.1.cmml" xref="A10.E50.m1.2.2.2.4"></divide><apply id="A10.E50.m1.2.2.2.4.2.cmml" xref="A10.E50.m1.2.2.2.4.2"><csymbol cd="ambiguous" id="A10.E50.m1.2.2.2.4.2.1.cmml" xref="A10.E50.m1.2.2.2.4.2">subscript</csymbol><ci id="A10.E50.m1.2.2.2.4.2.2.cmml" xref="A10.E50.m1.2.2.2.4.2.2">𝑍</ci><ci id="A10.E50.m1.2.2.2.4.2.3.cmml" xref="A10.E50.m1.2.2.2.4.2.3">𝑘</ci></apply><ci id="A10.E50.m1.2.2.2.4.3.cmml" xref="A10.E50.m1.2.2.2.4.3">𝐾</ci></apply><apply id="A10.E50.m1.2.2.2.2.2.cmml" xref="A10.E50.m1.2.2.2.2.1"><exp id="A10.E50.m1.1.1.1.1.cmml" xref="A10.E50.m1.1.1.1.1"></exp><apply id="A10.E50.m1.2.2.2.2.1.1.1.cmml" xref="A10.E50.m1.2.2.2.2.1.1.1"><minus id="A10.E50.m1.2.2.2.2.1.1.1.2.cmml" xref="A10.E50.m1.2.2.2.2.1.1.1"></minus><apply id="A10.E50.m1.2.2.2.2.1.1.1.1.cmml" xref="A10.E50.m1.2.2.2.2.1.1.1.1"><times id="A10.E50.m1.2.2.2.2.1.1.1.1.2.cmml" xref="A10.E50.m1.2.2.2.2.1.1.1.1.2"></times><apply id="A10.E50.m1.2.2.2.2.1.1.1.1.3.cmml" xref="A10.E50.m1.2.2.2.2.1.1.1.1.3"><divide id="A10.E50.m1.2.2.2.2.1.1.1.1.3.1.cmml" xref="A10.E50.m1.2.2.2.2.1.1.1.1.3"></divide><ci id="A10.E50.m1.2.2.2.2.1.1.1.1.3.2.cmml" xref="A10.E50.m1.2.2.2.2.1.1.1.1.3.2">𝜆</ci><cn type="integer" id="A10.E50.m1.2.2.2.2.1.1.1.1.3.3.cmml" xref="A10.E50.m1.2.2.2.2.1.1.1.1.3.3">2</cn></apply><apply id="A10.E50.m1.2.2.2.2.1.1.1.1.1.cmml" xref="A10.E50.m1.2.2.2.2.1.1.1.1.1"><csymbol cd="ambiguous" id="A10.E50.m1.2.2.2.2.1.1.1.1.1.2.cmml" xref="A10.E50.m1.2.2.2.2.1.1.1.1.1">superscript</csymbol><apply id="A10.E50.m1.2.2.2.2.1.1.1.1.1.1.2.cmml" xref="A10.E50.m1.2.2.2.2.1.1.1.1.1.1.1"><csymbol cd="latexml" id="A10.E50.m1.2.2.2.2.1.1.1.1.1.1.2.1.cmml" xref="A10.E50.m1.2.2.2.2.1.1.1.1.1.1.1.2">norm</csymbol><apply id="A10.E50.m1.2.2.2.2.1.1.1.1.1.1.1.1.cmml" xref="A10.E50.m1.2.2.2.2.1.1.1.1.1.1.1.1"><minus id="A10.E50.m1.2.2.2.2.1.1.1.1.1.1.1.1.1.cmml" xref="A10.E50.m1.2.2.2.2.1.1.1.1.1.1.1.1.1"></minus><apply id="A10.E50.m1.2.2.2.2.1.1.1.1.1.1.1.1.2.cmml" xref="A10.E50.m1.2.2.2.2.1.1.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="A10.E50.m1.2.2.2.2.1.1.1.1.1.1.1.1.2.1.cmml" xref="A10.E50.m1.2.2.2.2.1.1.1.1.1.1.1.1.2">subscript</csymbol><ci id="A10.E50.m1.2.2.2.2.1.1.1.1.1.1.1.1.2.2.cmml" xref="A10.E50.m1.2.2.2.2.1.1.1.1.1.1.1.1.2.2">𝐰</ci><ci id="A10.E50.m1.2.2.2.2.1.1.1.1.1.1.1.1.2.3.cmml" xref="A10.E50.m1.2.2.2.2.1.1.1.1.1.1.1.1.2.3">𝑠</ci></apply><apply id="A10.E50.m1.2.2.2.2.1.1.1.1.1.1.1.1.3.cmml" xref="A10.E50.m1.2.2.2.2.1.1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="A10.E50.m1.2.2.2.2.1.1.1.1.1.1.1.1.3.1.cmml" xref="A10.E50.m1.2.2.2.2.1.1.1.1.1.1.1.1.3">subscript</csymbol><ci id="A10.E50.m1.2.2.2.2.1.1.1.1.1.1.1.1.3.2.cmml" xref="A10.E50.m1.2.2.2.2.1.1.1.1.1.1.1.1.3.2">𝐰</ci><ci id="A10.E50.m1.2.2.2.2.1.1.1.1.1.1.1.1.3.3.cmml" xref="A10.E50.m1.2.2.2.2.1.1.1.1.1.1.1.1.3.3">𝑘</ci></apply></apply></apply><cn type="integer" id="A10.E50.m1.2.2.2.2.1.1.1.1.1.3.cmml" xref="A10.E50.m1.2.2.2.2.1.1.1.1.1.3">2</cn></apply></apply></apply></apply></apply><apply id="A10.E50.m1.4.4.4.cmml" xref="A10.E50.m1.4.4.4"><apply id="A10.E50.m1.4.4.4.3.cmml" xref="A10.E50.m1.4.4.4.3"><csymbol cd="ambiguous" id="A10.E50.m1.4.4.4.3.1.cmml" xref="A10.E50.m1.4.4.4.3">subscript</csymbol><sum id="A10.E50.m1.4.4.4.3.2.cmml" xref="A10.E50.m1.4.4.4.3.2"></sum><ci id="A10.E50.m1.4.4.4.3.3.cmml" xref="A10.E50.m1.4.4.4.3.3">𝑗</ci></apply><apply id="A10.E50.m1.4.4.4.2.cmml" xref="A10.E50.m1.4.4.4.2"><times id="A10.E50.m1.4.4.4.2.2.cmml" xref="A10.E50.m1.4.4.4.2.2"></times><apply id="A10.E50.m1.4.4.4.2.3.cmml" xref="A10.E50.m1.4.4.4.2.3"><divide id="A10.E50.m1.4.4.4.2.3.1.cmml" xref="A10.E50.m1.4.4.4.2.3"></divide><apply id="A10.E50.m1.4.4.4.2.3.2.cmml" xref="A10.E50.m1.4.4.4.2.3.2"><csymbol cd="ambiguous" id="A10.E50.m1.4.4.4.2.3.2.1.cmml" xref="A10.E50.m1.4.4.4.2.3.2">subscript</csymbol><ci id="A10.E50.m1.4.4.4.2.3.2.2.cmml" xref="A10.E50.m1.4.4.4.2.3.2.2">𝑍</ci><ci id="A10.E50.m1.4.4.4.2.3.2.3.cmml" xref="A10.E50.m1.4.4.4.2.3.2.3">𝑗</ci></apply><ci id="A10.E50.m1.4.4.4.2.3.3.cmml" xref="A10.E50.m1.4.4.4.2.3.3">𝐾</ci></apply><apply id="A10.E50.m1.4.4.4.2.1.2.cmml" xref="A10.E50.m1.4.4.4.2.1.1"><exp id="A10.E50.m1.3.3.3.1.cmml" xref="A10.E50.m1.3.3.3.1"></exp><apply id="A10.E50.m1.4.4.4.2.1.1.1.1.cmml" xref="A10.E50.m1.4.4.4.2.1.1.1.1"><minus id="A10.E50.m1.4.4.4.2.1.1.1.1.2.cmml" xref="A10.E50.m1.4.4.4.2.1.1.1.1"></minus><apply id="A10.E50.m1.4.4.4.2.1.1.1.1.1.cmml" xref="A10.E50.m1.4.4.4.2.1.1.1.1.1"><times id="A10.E50.m1.4.4.4.2.1.1.1.1.1.2.cmml" xref="A10.E50.m1.4.4.4.2.1.1.1.1.1.2"></times><apply id="A10.E50.m1.4.4.4.2.1.1.1.1.1.3.cmml" xref="A10.E50.m1.4.4.4.2.1.1.1.1.1.3"><divide id="A10.E50.m1.4.4.4.2.1.1.1.1.1.3.1.cmml" xref="A10.E50.m1.4.4.4.2.1.1.1.1.1.3"></divide><ci id="A10.E50.m1.4.4.4.2.1.1.1.1.1.3.2.cmml" xref="A10.E50.m1.4.4.4.2.1.1.1.1.1.3.2">𝜆</ci><cn type="integer" id="A10.E50.m1.4.4.4.2.1.1.1.1.1.3.3.cmml" xref="A10.E50.m1.4.4.4.2.1.1.1.1.1.3.3">2</cn></apply><apply id="A10.E50.m1.4.4.4.2.1.1.1.1.1.1.cmml" xref="A10.E50.m1.4.4.4.2.1.1.1.1.1.1"><csymbol cd="ambiguous" id="A10.E50.m1.4.4.4.2.1.1.1.1.1.1.2.cmml" xref="A10.E50.m1.4.4.4.2.1.1.1.1.1.1">superscript</csymbol><apply id="A10.E50.m1.4.4.4.2.1.1.1.1.1.1.1.2.cmml" xref="A10.E50.m1.4.4.4.2.1.1.1.1.1.1.1.1"><csymbol cd="latexml" id="A10.E50.m1.4.4.4.2.1.1.1.1.1.1.1.2.1.cmml" xref="A10.E50.m1.4.4.4.2.1.1.1.1.1.1.1.1.2">norm</csymbol><apply id="A10.E50.m1.4.4.4.2.1.1.1.1.1.1.1.1.1.cmml" xref="A10.E50.m1.4.4.4.2.1.1.1.1.1.1.1.1.1"><minus id="A10.E50.m1.4.4.4.2.1.1.1.1.1.1.1.1.1.1.cmml" xref="A10.E50.m1.4.4.4.2.1.1.1.1.1.1.1.1.1.1"></minus><apply id="A10.E50.m1.4.4.4.2.1.1.1.1.1.1.1.1.1.2.cmml" xref="A10.E50.m1.4.4.4.2.1.1.1.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="A10.E50.m1.4.4.4.2.1.1.1.1.1.1.1.1.1.2.1.cmml" xref="A10.E50.m1.4.4.4.2.1.1.1.1.1.1.1.1.1.2">subscript</csymbol><ci id="A10.E50.m1.4.4.4.2.1.1.1.1.1.1.1.1.1.2.2.cmml" xref="A10.E50.m1.4.4.4.2.1.1.1.1.1.1.1.1.1.2.2">𝐰</ci><ci id="A10.E50.m1.4.4.4.2.1.1.1.1.1.1.1.1.1.2.3.cmml" xref="A10.E50.m1.4.4.4.2.1.1.1.1.1.1.1.1.1.2.3">𝑠</ci></apply><apply id="A10.E50.m1.4.4.4.2.1.1.1.1.1.1.1.1.1.3.cmml" xref="A10.E50.m1.4.4.4.2.1.1.1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="A10.E50.m1.4.4.4.2.1.1.1.1.1.1.1.1.1.3.1.cmml" xref="A10.E50.m1.4.4.4.2.1.1.1.1.1.1.1.1.1.3">subscript</csymbol><ci id="A10.E50.m1.4.4.4.2.1.1.1.1.1.1.1.1.1.3.2.cmml" xref="A10.E50.m1.4.4.4.2.1.1.1.1.1.1.1.1.1.3.2">𝐰</ci><ci id="A10.E50.m1.4.4.4.2.1.1.1.1.1.1.1.1.1.3.3.cmml" xref="A10.E50.m1.4.4.4.2.1.1.1.1.1.1.1.1.1.3.3">𝑗</ci></apply></apply></apply><cn type="integer" id="A10.E50.m1.4.4.4.2.1.1.1.1.1.1.3.cmml" xref="A10.E50.m1.4.4.4.2.1.1.1.1.1.1.3">2</cn></apply></apply></apply></apply></apply></apply></apply><apply id="A10.E50.m1.5.5.1.1.1.1.1.1.1.1.cmml" xref="A10.E50.m1.5.5.1.1.1.1.1.1.1"><minus id="A10.E50.m1.5.5.1.1.1.1.1.1.1.1.1.cmml" xref="A10.E50.m1.5.5.1.1.1.1.1.1.1.1.1"></minus><apply id="A10.E50.m1.5.5.1.1.1.1.1.1.1.1.2.cmml" xref="A10.E50.m1.5.5.1.1.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="A10.E50.m1.5.5.1.1.1.1.1.1.1.1.2.1.cmml" xref="A10.E50.m1.5.5.1.1.1.1.1.1.1.1.2">subscript</csymbol><ci id="A10.E50.m1.5.5.1.1.1.1.1.1.1.1.2.2.cmml" xref="A10.E50.m1.5.5.1.1.1.1.1.1.1.1.2.2">𝐰</ci><ci id="A10.E50.m1.5.5.1.1.1.1.1.1.1.1.2.3.cmml" xref="A10.E50.m1.5.5.1.1.1.1.1.1.1.1.2.3">𝑠</ci></apply><apply id="A10.E50.m1.5.5.1.1.1.1.1.1.1.1.3.cmml" xref="A10.E50.m1.5.5.1.1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="A10.E50.m1.5.5.1.1.1.1.1.1.1.1.3.1.cmml" xref="A10.E50.m1.5.5.1.1.1.1.1.1.1.1.3">subscript</csymbol><ci id="A10.E50.m1.5.5.1.1.1.1.1.1.1.1.3.2.cmml" xref="A10.E50.m1.5.5.1.1.1.1.1.1.1.1.3.2">𝐰</ci><ci id="A10.E50.m1.5.5.1.1.1.1.1.1.1.1.3.3.cmml" xref="A10.E50.m1.5.5.1.1.1.1.1.1.1.1.3.3">𝑘</ci></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A10.E50.m1.5c">\displaystyle\frac{\partial L}{\partial\mathbf{w}_{k}}=\lambda\sum_{s}\frac{\frac{Z_{k}}{K}\exp(-\frac{\lambda}{2}\|\mathbf{w}_{s}-\mathbf{w}_{k}\|^{2})}{\sum_{j}\frac{Z_{j}}{K}\exp(-\frac{\lambda}{2}\|\mathbf{w}_{s}-\mathbf{w}_{j}\|^{2})}(\mathbf{w}_{s}-\mathbf{w}_{k}).</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(50)</span></td>
</tr></tbody>
</table>
<p id="A10.SS2.p1.18" class="ltx_p">Notice that this gradient estimate can also be interpreted in terms of a posterior distribution over the index <math id="A10.SS2.p1.10.m1.1" class="ltx_Math" alttext="z" display="inline"><semantics id="A10.SS2.p1.10.m1.1a"><mi id="A10.SS2.p1.10.m1.1.1" xref="A10.SS2.p1.10.m1.1.1.cmml">z</mi><annotation-xml encoding="MathML-Content" id="A10.SS2.p1.10.m1.1b"><ci id="A10.SS2.p1.10.m1.1.1.cmml" xref="A10.SS2.p1.10.m1.1.1">𝑧</ci></annotation-xml><annotation encoding="application/x-tex" id="A10.SS2.p1.10.m1.1c">z</annotation></semantics></math> (taking values in <math id="A10.SS2.p1.11.m2.3" class="ltx_Math" alttext="\{1,\dots,K\}" display="inline"><semantics id="A10.SS2.p1.11.m2.3a"><mrow id="A10.SS2.p1.11.m2.3.4.2" xref="A10.SS2.p1.11.m2.3.4.1.cmml"><mo stretchy="false" id="A10.SS2.p1.11.m2.3.4.2.1" xref="A10.SS2.p1.11.m2.3.4.1.cmml">{</mo><mn id="A10.SS2.p1.11.m2.1.1" xref="A10.SS2.p1.11.m2.1.1.cmml">1</mn><mo id="A10.SS2.p1.11.m2.3.4.2.2" xref="A10.SS2.p1.11.m2.3.4.1.cmml">,</mo><mi mathvariant="normal" id="A10.SS2.p1.11.m2.2.2" xref="A10.SS2.p1.11.m2.2.2.cmml">…</mi><mo id="A10.SS2.p1.11.m2.3.4.2.3" xref="A10.SS2.p1.11.m2.3.4.1.cmml">,</mo><mi id="A10.SS2.p1.11.m2.3.3" xref="A10.SS2.p1.11.m2.3.3.cmml">K</mi><mo stretchy="false" id="A10.SS2.p1.11.m2.3.4.2.4" xref="A10.SS2.p1.11.m2.3.4.1.cmml">}</mo></mrow><annotation-xml encoding="MathML-Content" id="A10.SS2.p1.11.m2.3b"><set id="A10.SS2.p1.11.m2.3.4.1.cmml" xref="A10.SS2.p1.11.m2.3.4.2"><cn type="integer" id="A10.SS2.p1.11.m2.1.1.cmml" xref="A10.SS2.p1.11.m2.1.1">1</cn><ci id="A10.SS2.p1.11.m2.2.2.cmml" xref="A10.SS2.p1.11.m2.2.2">…</ci><ci id="A10.SS2.p1.11.m2.3.3.cmml" xref="A10.SS2.p1.11.m2.3.3">𝐾</ci></set></annotation-xml><annotation encoding="application/x-tex" id="A10.SS2.p1.11.m2.3c">\{1,\dots,K\}</annotation></semantics></math>) given the “observed” variables <math id="A10.SS2.p1.12.m3.1" class="ltx_Math" alttext="\mathbf{w}_{s}" display="inline"><semantics id="A10.SS2.p1.12.m3.1a"><msub id="A10.SS2.p1.12.m3.1.1" xref="A10.SS2.p1.12.m3.1.1.cmml"><mi id="A10.SS2.p1.12.m3.1.1.2" xref="A10.SS2.p1.12.m3.1.1.2.cmml">𝐰</mi><mi id="A10.SS2.p1.12.m3.1.1.3" xref="A10.SS2.p1.12.m3.1.1.3.cmml">s</mi></msub><annotation-xml encoding="MathML-Content" id="A10.SS2.p1.12.m3.1b"><apply id="A10.SS2.p1.12.m3.1.1.cmml" xref="A10.SS2.p1.12.m3.1.1"><csymbol cd="ambiguous" id="A10.SS2.p1.12.m3.1.1.1.cmml" xref="A10.SS2.p1.12.m3.1.1">subscript</csymbol><ci id="A10.SS2.p1.12.m3.1.1.2.cmml" xref="A10.SS2.p1.12.m3.1.1.2">𝐰</ci><ci id="A10.SS2.p1.12.m3.1.1.3.cmml" xref="A10.SS2.p1.12.m3.1.1.3">𝑠</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A10.SS2.p1.12.m3.1c">\mathbf{w}_{s}</annotation></semantics></math>; we can treat <math id="A10.SS2.p1.13.m4.1" class="ltx_Math" alttext="1/K" display="inline"><semantics id="A10.SS2.p1.13.m4.1a"><mrow id="A10.SS2.p1.13.m4.1.1" xref="A10.SS2.p1.13.m4.1.1.cmml"><mn id="A10.SS2.p1.13.m4.1.1.2" xref="A10.SS2.p1.13.m4.1.1.2.cmml">1</mn><mo id="A10.SS2.p1.13.m4.1.1.1" xref="A10.SS2.p1.13.m4.1.1.1.cmml">/</mo><mi id="A10.SS2.p1.13.m4.1.1.3" xref="A10.SS2.p1.13.m4.1.1.3.cmml">K</mi></mrow><annotation-xml encoding="MathML-Content" id="A10.SS2.p1.13.m4.1b"><apply id="A10.SS2.p1.13.m4.1.1.cmml" xref="A10.SS2.p1.13.m4.1.1"><divide id="A10.SS2.p1.13.m4.1.1.1.cmml" xref="A10.SS2.p1.13.m4.1.1.1"></divide><cn type="integer" id="A10.SS2.p1.13.m4.1.1.2.cmml" xref="A10.SS2.p1.13.m4.1.1.2">1</cn><ci id="A10.SS2.p1.13.m4.1.1.3.cmml" xref="A10.SS2.p1.13.m4.1.1.3">𝐾</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A10.SS2.p1.13.m4.1c">1/K</annotation></semantics></math> as the prior probability of selecting component <math id="A10.SS2.p1.14.m5.1" class="ltx_Math" alttext="z=k" display="inline"><semantics id="A10.SS2.p1.14.m5.1a"><mrow id="A10.SS2.p1.14.m5.1.1" xref="A10.SS2.p1.14.m5.1.1.cmml"><mi id="A10.SS2.p1.14.m5.1.1.2" xref="A10.SS2.p1.14.m5.1.1.2.cmml">z</mi><mo id="A10.SS2.p1.14.m5.1.1.1" xref="A10.SS2.p1.14.m5.1.1.1.cmml">=</mo><mi id="A10.SS2.p1.14.m5.1.1.3" xref="A10.SS2.p1.14.m5.1.1.3.cmml">k</mi></mrow><annotation-xml encoding="MathML-Content" id="A10.SS2.p1.14.m5.1b"><apply id="A10.SS2.p1.14.m5.1.1.cmml" xref="A10.SS2.p1.14.m5.1.1"><eq id="A10.SS2.p1.14.m5.1.1.1.cmml" xref="A10.SS2.p1.14.m5.1.1.1"></eq><ci id="A10.SS2.p1.14.m5.1.1.2.cmml" xref="A10.SS2.p1.14.m5.1.1.2">𝑧</ci><ci id="A10.SS2.p1.14.m5.1.1.3.cmml" xref="A10.SS2.p1.14.m5.1.1.3">𝑘</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A10.SS2.p1.14.m5.1c">z=k</annotation></semantics></math>, i.e., <math id="A10.SS2.p1.15.m6.1" class="ltx_Math" alttext="p(z=k)" display="inline"><semantics id="A10.SS2.p1.15.m6.1a"><mrow id="A10.SS2.p1.15.m6.1.1" xref="A10.SS2.p1.15.m6.1.1.cmml"><mi id="A10.SS2.p1.15.m6.1.1.3" xref="A10.SS2.p1.15.m6.1.1.3.cmml">p</mi><mo lspace="0em" rspace="0em" id="A10.SS2.p1.15.m6.1.1.2" xref="A10.SS2.p1.15.m6.1.1.2.cmml">​</mo><mrow id="A10.SS2.p1.15.m6.1.1.1.1" xref="A10.SS2.p1.15.m6.1.1.1.1.1.cmml"><mo stretchy="false" id="A10.SS2.p1.15.m6.1.1.1.1.2" xref="A10.SS2.p1.15.m6.1.1.1.1.1.cmml">(</mo><mrow id="A10.SS2.p1.15.m6.1.1.1.1.1" xref="A10.SS2.p1.15.m6.1.1.1.1.1.cmml"><mi id="A10.SS2.p1.15.m6.1.1.1.1.1.2" xref="A10.SS2.p1.15.m6.1.1.1.1.1.2.cmml">z</mi><mo id="A10.SS2.p1.15.m6.1.1.1.1.1.1" xref="A10.SS2.p1.15.m6.1.1.1.1.1.1.cmml">=</mo><mi id="A10.SS2.p1.15.m6.1.1.1.1.1.3" xref="A10.SS2.p1.15.m6.1.1.1.1.1.3.cmml">k</mi></mrow><mo stretchy="false" id="A10.SS2.p1.15.m6.1.1.1.1.3" xref="A10.SS2.p1.15.m6.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="A10.SS2.p1.15.m6.1b"><apply id="A10.SS2.p1.15.m6.1.1.cmml" xref="A10.SS2.p1.15.m6.1.1"><times id="A10.SS2.p1.15.m6.1.1.2.cmml" xref="A10.SS2.p1.15.m6.1.1.2"></times><ci id="A10.SS2.p1.15.m6.1.1.3.cmml" xref="A10.SS2.p1.15.m6.1.1.3">𝑝</ci><apply id="A10.SS2.p1.15.m6.1.1.1.1.1.cmml" xref="A10.SS2.p1.15.m6.1.1.1.1"><eq id="A10.SS2.p1.15.m6.1.1.1.1.1.1.cmml" xref="A10.SS2.p1.15.m6.1.1.1.1.1.1"></eq><ci id="A10.SS2.p1.15.m6.1.1.1.1.1.2.cmml" xref="A10.SS2.p1.15.m6.1.1.1.1.1.2">𝑧</ci><ci id="A10.SS2.p1.15.m6.1.1.1.1.1.3.cmml" xref="A10.SS2.p1.15.m6.1.1.1.1.1.3">𝑘</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A10.SS2.p1.15.m6.1c">p(z=k)</annotation></semantics></math> and <math id="A10.SS2.p1.16.m7.2" class="ltx_Math" alttext="Z_{k}\exp(-\frac{\lambda}{2}\|\mathbf{w}_{s}-\mathbf{w}_{k}\|)" display="inline"><semantics id="A10.SS2.p1.16.m7.2a"><mrow id="A10.SS2.p1.16.m7.2.2" xref="A10.SS2.p1.16.m7.2.2.cmml"><msub id="A10.SS2.p1.16.m7.2.2.3" xref="A10.SS2.p1.16.m7.2.2.3.cmml"><mi id="A10.SS2.p1.16.m7.2.2.3.2" xref="A10.SS2.p1.16.m7.2.2.3.2.cmml">Z</mi><mi id="A10.SS2.p1.16.m7.2.2.3.3" xref="A10.SS2.p1.16.m7.2.2.3.3.cmml">k</mi></msub><mo lspace="0.167em" rspace="0em" id="A10.SS2.p1.16.m7.2.2.2" xref="A10.SS2.p1.16.m7.2.2.2.cmml">​</mo><mrow id="A10.SS2.p1.16.m7.2.2.1.1" xref="A10.SS2.p1.16.m7.2.2.1.2.cmml"><mi id="A10.SS2.p1.16.m7.1.1" xref="A10.SS2.p1.16.m7.1.1.cmml">exp</mi><mo id="A10.SS2.p1.16.m7.2.2.1.1a" xref="A10.SS2.p1.16.m7.2.2.1.2.cmml">⁡</mo><mrow id="A10.SS2.p1.16.m7.2.2.1.1.1" xref="A10.SS2.p1.16.m7.2.2.1.2.cmml"><mo stretchy="false" id="A10.SS2.p1.16.m7.2.2.1.1.1.2" xref="A10.SS2.p1.16.m7.2.2.1.2.cmml">(</mo><mrow id="A10.SS2.p1.16.m7.2.2.1.1.1.1" xref="A10.SS2.p1.16.m7.2.2.1.1.1.1.cmml"><mo id="A10.SS2.p1.16.m7.2.2.1.1.1.1a" xref="A10.SS2.p1.16.m7.2.2.1.1.1.1.cmml">−</mo><mrow id="A10.SS2.p1.16.m7.2.2.1.1.1.1.1" xref="A10.SS2.p1.16.m7.2.2.1.1.1.1.1.cmml"><mfrac id="A10.SS2.p1.16.m7.2.2.1.1.1.1.1.3" xref="A10.SS2.p1.16.m7.2.2.1.1.1.1.1.3.cmml"><mi id="A10.SS2.p1.16.m7.2.2.1.1.1.1.1.3.2" xref="A10.SS2.p1.16.m7.2.2.1.1.1.1.1.3.2.cmml">λ</mi><mn id="A10.SS2.p1.16.m7.2.2.1.1.1.1.1.3.3" xref="A10.SS2.p1.16.m7.2.2.1.1.1.1.1.3.3.cmml">2</mn></mfrac><mo lspace="0em" rspace="0em" id="A10.SS2.p1.16.m7.2.2.1.1.1.1.1.2" xref="A10.SS2.p1.16.m7.2.2.1.1.1.1.1.2.cmml">​</mo><mrow id="A10.SS2.p1.16.m7.2.2.1.1.1.1.1.1.1" xref="A10.SS2.p1.16.m7.2.2.1.1.1.1.1.1.2.cmml"><mo stretchy="false" id="A10.SS2.p1.16.m7.2.2.1.1.1.1.1.1.1.2" xref="A10.SS2.p1.16.m7.2.2.1.1.1.1.1.1.2.1.cmml">‖</mo><mrow id="A10.SS2.p1.16.m7.2.2.1.1.1.1.1.1.1.1" xref="A10.SS2.p1.16.m7.2.2.1.1.1.1.1.1.1.1.cmml"><msub id="A10.SS2.p1.16.m7.2.2.1.1.1.1.1.1.1.1.2" xref="A10.SS2.p1.16.m7.2.2.1.1.1.1.1.1.1.1.2.cmml"><mi id="A10.SS2.p1.16.m7.2.2.1.1.1.1.1.1.1.1.2.2" xref="A10.SS2.p1.16.m7.2.2.1.1.1.1.1.1.1.1.2.2.cmml">𝐰</mi><mi id="A10.SS2.p1.16.m7.2.2.1.1.1.1.1.1.1.1.2.3" xref="A10.SS2.p1.16.m7.2.2.1.1.1.1.1.1.1.1.2.3.cmml">s</mi></msub><mo id="A10.SS2.p1.16.m7.2.2.1.1.1.1.1.1.1.1.1" xref="A10.SS2.p1.16.m7.2.2.1.1.1.1.1.1.1.1.1.cmml">−</mo><msub id="A10.SS2.p1.16.m7.2.2.1.1.1.1.1.1.1.1.3" xref="A10.SS2.p1.16.m7.2.2.1.1.1.1.1.1.1.1.3.cmml"><mi id="A10.SS2.p1.16.m7.2.2.1.1.1.1.1.1.1.1.3.2" xref="A10.SS2.p1.16.m7.2.2.1.1.1.1.1.1.1.1.3.2.cmml">𝐰</mi><mi id="A10.SS2.p1.16.m7.2.2.1.1.1.1.1.1.1.1.3.3" xref="A10.SS2.p1.16.m7.2.2.1.1.1.1.1.1.1.1.3.3.cmml">k</mi></msub></mrow><mo stretchy="false" id="A10.SS2.p1.16.m7.2.2.1.1.1.1.1.1.1.3" xref="A10.SS2.p1.16.m7.2.2.1.1.1.1.1.1.2.1.cmml">‖</mo></mrow></mrow></mrow><mo stretchy="false" id="A10.SS2.p1.16.m7.2.2.1.1.1.3" xref="A10.SS2.p1.16.m7.2.2.1.2.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="A10.SS2.p1.16.m7.2b"><apply id="A10.SS2.p1.16.m7.2.2.cmml" xref="A10.SS2.p1.16.m7.2.2"><times id="A10.SS2.p1.16.m7.2.2.2.cmml" xref="A10.SS2.p1.16.m7.2.2.2"></times><apply id="A10.SS2.p1.16.m7.2.2.3.cmml" xref="A10.SS2.p1.16.m7.2.2.3"><csymbol cd="ambiguous" id="A10.SS2.p1.16.m7.2.2.3.1.cmml" xref="A10.SS2.p1.16.m7.2.2.3">subscript</csymbol><ci id="A10.SS2.p1.16.m7.2.2.3.2.cmml" xref="A10.SS2.p1.16.m7.2.2.3.2">𝑍</ci><ci id="A10.SS2.p1.16.m7.2.2.3.3.cmml" xref="A10.SS2.p1.16.m7.2.2.3.3">𝑘</ci></apply><apply id="A10.SS2.p1.16.m7.2.2.1.2.cmml" xref="A10.SS2.p1.16.m7.2.2.1.1"><exp id="A10.SS2.p1.16.m7.1.1.cmml" xref="A10.SS2.p1.16.m7.1.1"></exp><apply id="A10.SS2.p1.16.m7.2.2.1.1.1.1.cmml" xref="A10.SS2.p1.16.m7.2.2.1.1.1.1"><minus id="A10.SS2.p1.16.m7.2.2.1.1.1.1.2.cmml" xref="A10.SS2.p1.16.m7.2.2.1.1.1.1"></minus><apply id="A10.SS2.p1.16.m7.2.2.1.1.1.1.1.cmml" xref="A10.SS2.p1.16.m7.2.2.1.1.1.1.1"><times id="A10.SS2.p1.16.m7.2.2.1.1.1.1.1.2.cmml" xref="A10.SS2.p1.16.m7.2.2.1.1.1.1.1.2"></times><apply id="A10.SS2.p1.16.m7.2.2.1.1.1.1.1.3.cmml" xref="A10.SS2.p1.16.m7.2.2.1.1.1.1.1.3"><divide id="A10.SS2.p1.16.m7.2.2.1.1.1.1.1.3.1.cmml" xref="A10.SS2.p1.16.m7.2.2.1.1.1.1.1.3"></divide><ci id="A10.SS2.p1.16.m7.2.2.1.1.1.1.1.3.2.cmml" xref="A10.SS2.p1.16.m7.2.2.1.1.1.1.1.3.2">𝜆</ci><cn type="integer" id="A10.SS2.p1.16.m7.2.2.1.1.1.1.1.3.3.cmml" xref="A10.SS2.p1.16.m7.2.2.1.1.1.1.1.3.3">2</cn></apply><apply id="A10.SS2.p1.16.m7.2.2.1.1.1.1.1.1.2.cmml" xref="A10.SS2.p1.16.m7.2.2.1.1.1.1.1.1.1"><csymbol cd="latexml" id="A10.SS2.p1.16.m7.2.2.1.1.1.1.1.1.2.1.cmml" xref="A10.SS2.p1.16.m7.2.2.1.1.1.1.1.1.1.2">norm</csymbol><apply id="A10.SS2.p1.16.m7.2.2.1.1.1.1.1.1.1.1.cmml" xref="A10.SS2.p1.16.m7.2.2.1.1.1.1.1.1.1.1"><minus id="A10.SS2.p1.16.m7.2.2.1.1.1.1.1.1.1.1.1.cmml" xref="A10.SS2.p1.16.m7.2.2.1.1.1.1.1.1.1.1.1"></minus><apply id="A10.SS2.p1.16.m7.2.2.1.1.1.1.1.1.1.1.2.cmml" xref="A10.SS2.p1.16.m7.2.2.1.1.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="A10.SS2.p1.16.m7.2.2.1.1.1.1.1.1.1.1.2.1.cmml" xref="A10.SS2.p1.16.m7.2.2.1.1.1.1.1.1.1.1.2">subscript</csymbol><ci id="A10.SS2.p1.16.m7.2.2.1.1.1.1.1.1.1.1.2.2.cmml" xref="A10.SS2.p1.16.m7.2.2.1.1.1.1.1.1.1.1.2.2">𝐰</ci><ci id="A10.SS2.p1.16.m7.2.2.1.1.1.1.1.1.1.1.2.3.cmml" xref="A10.SS2.p1.16.m7.2.2.1.1.1.1.1.1.1.1.2.3">𝑠</ci></apply><apply id="A10.SS2.p1.16.m7.2.2.1.1.1.1.1.1.1.1.3.cmml" xref="A10.SS2.p1.16.m7.2.2.1.1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="A10.SS2.p1.16.m7.2.2.1.1.1.1.1.1.1.1.3.1.cmml" xref="A10.SS2.p1.16.m7.2.2.1.1.1.1.1.1.1.1.3">subscript</csymbol><ci id="A10.SS2.p1.16.m7.2.2.1.1.1.1.1.1.1.1.3.2.cmml" xref="A10.SS2.p1.16.m7.2.2.1.1.1.1.1.1.1.1.3.2">𝐰</ci><ci id="A10.SS2.p1.16.m7.2.2.1.1.1.1.1.1.1.1.3.3.cmml" xref="A10.SS2.p1.16.m7.2.2.1.1.1.1.1.1.1.1.3.3">𝑘</ci></apply></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A10.SS2.p1.16.m7.2c">Z_{k}\exp(-\frac{\lambda}{2}\|\mathbf{w}_{s}-\mathbf{w}_{k}\|)</annotation></semantics></math> as the probability of <math id="A10.SS2.p1.17.m8.1" class="ltx_Math" alttext="\mathbf{w}_{s}" display="inline"><semantics id="A10.SS2.p1.17.m8.1a"><msub id="A10.SS2.p1.17.m8.1.1" xref="A10.SS2.p1.17.m8.1.1.cmml"><mi id="A10.SS2.p1.17.m8.1.1.2" xref="A10.SS2.p1.17.m8.1.1.2.cmml">𝐰</mi><mi id="A10.SS2.p1.17.m8.1.1.3" xref="A10.SS2.p1.17.m8.1.1.3.cmml">s</mi></msub><annotation-xml encoding="MathML-Content" id="A10.SS2.p1.17.m8.1b"><apply id="A10.SS2.p1.17.m8.1.1.cmml" xref="A10.SS2.p1.17.m8.1.1"><csymbol cd="ambiguous" id="A10.SS2.p1.17.m8.1.1.1.cmml" xref="A10.SS2.p1.17.m8.1.1">subscript</csymbol><ci id="A10.SS2.p1.17.m8.1.1.2.cmml" xref="A10.SS2.p1.17.m8.1.1.2">𝐰</ci><ci id="A10.SS2.p1.17.m8.1.1.3.cmml" xref="A10.SS2.p1.17.m8.1.1.3">𝑠</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A10.SS2.p1.17.m8.1c">\mathbf{w}_{s}</annotation></semantics></math> under Gaussian component <math id="A10.SS2.p1.18.m9.1" class="ltx_Math" alttext="k" display="inline"><semantics id="A10.SS2.p1.18.m9.1a"><mi id="A10.SS2.p1.18.m9.1.1" xref="A10.SS2.p1.18.m9.1.1.cmml">k</mi><annotation-xml encoding="MathML-Content" id="A10.SS2.p1.18.m9.1b"><ci id="A10.SS2.p1.18.m9.1.1.cmml" xref="A10.SS2.p1.18.m9.1.1">𝑘</ci></annotation-xml><annotation encoding="application/x-tex" id="A10.SS2.p1.18.m9.1c">k</annotation></semantics></math>. In this way, the weighting term can be written as</p>
<table id="A10.EGx42" class="ltx_equationgroup ltx_eqn_align ltx_eqn_table">

<tbody id="A10.E51"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math id="A10.E51.m1.6" class="ltx_Math" alttext="\displaystyle\frac{\frac{Z_{k}}{K}\exp(-\frac{\lambda}{2}\|\mathbf{w}_{s}-\mathbf{w}_{k}\|^{2})}{\sum_{j}\frac{Z_{j}}{K}\exp(-\frac{\lambda}{2}\|\mathbf{w}_{s}-\mathbf{w}_{j}\|^{2})}=p(z=k|\mathbf{w}_{s},\mathbf{w}_{1:K},\lambda)." display="inline"><semantics id="A10.E51.m1.6a"><mrow id="A10.E51.m1.6.6.1" xref="A10.E51.m1.6.6.1.1.cmml"><mrow id="A10.E51.m1.6.6.1.1" xref="A10.E51.m1.6.6.1.1.cmml"><mstyle displaystyle="true" id="A10.E51.m1.4.4" xref="A10.E51.m1.4.4.cmml"><mfrac id="A10.E51.m1.4.4a" xref="A10.E51.m1.4.4.cmml"><mrow id="A10.E51.m1.2.2.2" xref="A10.E51.m1.2.2.2.cmml"><mfrac id="A10.E51.m1.2.2.2.4" xref="A10.E51.m1.2.2.2.4.cmml"><msub id="A10.E51.m1.2.2.2.4.2" xref="A10.E51.m1.2.2.2.4.2.cmml"><mi id="A10.E51.m1.2.2.2.4.2.2" xref="A10.E51.m1.2.2.2.4.2.2.cmml">Z</mi><mi id="A10.E51.m1.2.2.2.4.2.3" xref="A10.E51.m1.2.2.2.4.2.3.cmml">k</mi></msub><mi id="A10.E51.m1.2.2.2.4.3" xref="A10.E51.m1.2.2.2.4.3.cmml">K</mi></mfrac><mo lspace="0.167em" rspace="0em" id="A10.E51.m1.2.2.2.3" xref="A10.E51.m1.2.2.2.3.cmml">​</mo><mrow id="A10.E51.m1.2.2.2.2.1" xref="A10.E51.m1.2.2.2.2.2.cmml"><mi id="A10.E51.m1.1.1.1.1" xref="A10.E51.m1.1.1.1.1.cmml">exp</mi><mo id="A10.E51.m1.2.2.2.2.1a" xref="A10.E51.m1.2.2.2.2.2.cmml">⁡</mo><mrow id="A10.E51.m1.2.2.2.2.1.1" xref="A10.E51.m1.2.2.2.2.2.cmml"><mo stretchy="false" id="A10.E51.m1.2.2.2.2.1.1.2" xref="A10.E51.m1.2.2.2.2.2.cmml">(</mo><mrow id="A10.E51.m1.2.2.2.2.1.1.1" xref="A10.E51.m1.2.2.2.2.1.1.1.cmml"><mo id="A10.E51.m1.2.2.2.2.1.1.1a" xref="A10.E51.m1.2.2.2.2.1.1.1.cmml">−</mo><mrow id="A10.E51.m1.2.2.2.2.1.1.1.1" xref="A10.E51.m1.2.2.2.2.1.1.1.1.cmml"><mfrac id="A10.E51.m1.2.2.2.2.1.1.1.1.3" xref="A10.E51.m1.2.2.2.2.1.1.1.1.3.cmml"><mi id="A10.E51.m1.2.2.2.2.1.1.1.1.3.2" xref="A10.E51.m1.2.2.2.2.1.1.1.1.3.2.cmml">λ</mi><mn id="A10.E51.m1.2.2.2.2.1.1.1.1.3.3" xref="A10.E51.m1.2.2.2.2.1.1.1.1.3.3.cmml">2</mn></mfrac><mo lspace="0em" rspace="0em" id="A10.E51.m1.2.2.2.2.1.1.1.1.2" xref="A10.E51.m1.2.2.2.2.1.1.1.1.2.cmml">​</mo><msup id="A10.E51.m1.2.2.2.2.1.1.1.1.1" xref="A10.E51.m1.2.2.2.2.1.1.1.1.1.cmml"><mrow id="A10.E51.m1.2.2.2.2.1.1.1.1.1.1.1" xref="A10.E51.m1.2.2.2.2.1.1.1.1.1.1.2.cmml"><mo stretchy="false" id="A10.E51.m1.2.2.2.2.1.1.1.1.1.1.1.2" xref="A10.E51.m1.2.2.2.2.1.1.1.1.1.1.2.1.cmml">‖</mo><mrow id="A10.E51.m1.2.2.2.2.1.1.1.1.1.1.1.1" xref="A10.E51.m1.2.2.2.2.1.1.1.1.1.1.1.1.cmml"><msub id="A10.E51.m1.2.2.2.2.1.1.1.1.1.1.1.1.2" xref="A10.E51.m1.2.2.2.2.1.1.1.1.1.1.1.1.2.cmml"><mi id="A10.E51.m1.2.2.2.2.1.1.1.1.1.1.1.1.2.2" xref="A10.E51.m1.2.2.2.2.1.1.1.1.1.1.1.1.2.2.cmml">𝐰</mi><mi id="A10.E51.m1.2.2.2.2.1.1.1.1.1.1.1.1.2.3" xref="A10.E51.m1.2.2.2.2.1.1.1.1.1.1.1.1.2.3.cmml">s</mi></msub><mo id="A10.E51.m1.2.2.2.2.1.1.1.1.1.1.1.1.1" xref="A10.E51.m1.2.2.2.2.1.1.1.1.1.1.1.1.1.cmml">−</mo><msub id="A10.E51.m1.2.2.2.2.1.1.1.1.1.1.1.1.3" xref="A10.E51.m1.2.2.2.2.1.1.1.1.1.1.1.1.3.cmml"><mi id="A10.E51.m1.2.2.2.2.1.1.1.1.1.1.1.1.3.2" xref="A10.E51.m1.2.2.2.2.1.1.1.1.1.1.1.1.3.2.cmml">𝐰</mi><mi id="A10.E51.m1.2.2.2.2.1.1.1.1.1.1.1.1.3.3" xref="A10.E51.m1.2.2.2.2.1.1.1.1.1.1.1.1.3.3.cmml">k</mi></msub></mrow><mo stretchy="false" id="A10.E51.m1.2.2.2.2.1.1.1.1.1.1.1.3" xref="A10.E51.m1.2.2.2.2.1.1.1.1.1.1.2.1.cmml">‖</mo></mrow><mn id="A10.E51.m1.2.2.2.2.1.1.1.1.1.3" xref="A10.E51.m1.2.2.2.2.1.1.1.1.1.3.cmml">2</mn></msup></mrow></mrow><mo stretchy="false" id="A10.E51.m1.2.2.2.2.1.1.3" xref="A10.E51.m1.2.2.2.2.2.cmml">)</mo></mrow></mrow></mrow><mrow id="A10.E51.m1.4.4.4" xref="A10.E51.m1.4.4.4.cmml"><msub id="A10.E51.m1.4.4.4.3" xref="A10.E51.m1.4.4.4.3.cmml"><mo id="A10.E51.m1.4.4.4.3.2" xref="A10.E51.m1.4.4.4.3.2.cmml">∑</mo><mi id="A10.E51.m1.4.4.4.3.3" xref="A10.E51.m1.4.4.4.3.3.cmml">j</mi></msub><mrow id="A10.E51.m1.4.4.4.2" xref="A10.E51.m1.4.4.4.2.cmml"><mfrac id="A10.E51.m1.4.4.4.2.3" xref="A10.E51.m1.4.4.4.2.3.cmml"><msub id="A10.E51.m1.4.4.4.2.3.2" xref="A10.E51.m1.4.4.4.2.3.2.cmml"><mi id="A10.E51.m1.4.4.4.2.3.2.2" xref="A10.E51.m1.4.4.4.2.3.2.2.cmml">Z</mi><mi id="A10.E51.m1.4.4.4.2.3.2.3" xref="A10.E51.m1.4.4.4.2.3.2.3.cmml">j</mi></msub><mi id="A10.E51.m1.4.4.4.2.3.3" xref="A10.E51.m1.4.4.4.2.3.3.cmml">K</mi></mfrac><mo lspace="0.167em" rspace="0em" id="A10.E51.m1.4.4.4.2.2" xref="A10.E51.m1.4.4.4.2.2.cmml">​</mo><mrow id="A10.E51.m1.4.4.4.2.1.1" xref="A10.E51.m1.4.4.4.2.1.2.cmml"><mi id="A10.E51.m1.3.3.3.1" xref="A10.E51.m1.3.3.3.1.cmml">exp</mi><mo id="A10.E51.m1.4.4.4.2.1.1a" xref="A10.E51.m1.4.4.4.2.1.2.cmml">⁡</mo><mrow id="A10.E51.m1.4.4.4.2.1.1.1" xref="A10.E51.m1.4.4.4.2.1.2.cmml"><mo stretchy="false" id="A10.E51.m1.4.4.4.2.1.1.1.2" xref="A10.E51.m1.4.4.4.2.1.2.cmml">(</mo><mrow id="A10.E51.m1.4.4.4.2.1.1.1.1" xref="A10.E51.m1.4.4.4.2.1.1.1.1.cmml"><mo id="A10.E51.m1.4.4.4.2.1.1.1.1a" xref="A10.E51.m1.4.4.4.2.1.1.1.1.cmml">−</mo><mrow id="A10.E51.m1.4.4.4.2.1.1.1.1.1" xref="A10.E51.m1.4.4.4.2.1.1.1.1.1.cmml"><mfrac id="A10.E51.m1.4.4.4.2.1.1.1.1.1.3" xref="A10.E51.m1.4.4.4.2.1.1.1.1.1.3.cmml"><mi id="A10.E51.m1.4.4.4.2.1.1.1.1.1.3.2" xref="A10.E51.m1.4.4.4.2.1.1.1.1.1.3.2.cmml">λ</mi><mn id="A10.E51.m1.4.4.4.2.1.1.1.1.1.3.3" xref="A10.E51.m1.4.4.4.2.1.1.1.1.1.3.3.cmml">2</mn></mfrac><mo lspace="0em" rspace="0em" id="A10.E51.m1.4.4.4.2.1.1.1.1.1.2" xref="A10.E51.m1.4.4.4.2.1.1.1.1.1.2.cmml">​</mo><msup id="A10.E51.m1.4.4.4.2.1.1.1.1.1.1" xref="A10.E51.m1.4.4.4.2.1.1.1.1.1.1.cmml"><mrow id="A10.E51.m1.4.4.4.2.1.1.1.1.1.1.1.1" xref="A10.E51.m1.4.4.4.2.1.1.1.1.1.1.1.2.cmml"><mo stretchy="false" id="A10.E51.m1.4.4.4.2.1.1.1.1.1.1.1.1.2" xref="A10.E51.m1.4.4.4.2.1.1.1.1.1.1.1.2.1.cmml">‖</mo><mrow id="A10.E51.m1.4.4.4.2.1.1.1.1.1.1.1.1.1" xref="A10.E51.m1.4.4.4.2.1.1.1.1.1.1.1.1.1.cmml"><msub id="A10.E51.m1.4.4.4.2.1.1.1.1.1.1.1.1.1.2" xref="A10.E51.m1.4.4.4.2.1.1.1.1.1.1.1.1.1.2.cmml"><mi id="A10.E51.m1.4.4.4.2.1.1.1.1.1.1.1.1.1.2.2" xref="A10.E51.m1.4.4.4.2.1.1.1.1.1.1.1.1.1.2.2.cmml">𝐰</mi><mi id="A10.E51.m1.4.4.4.2.1.1.1.1.1.1.1.1.1.2.3" xref="A10.E51.m1.4.4.4.2.1.1.1.1.1.1.1.1.1.2.3.cmml">s</mi></msub><mo id="A10.E51.m1.4.4.4.2.1.1.1.1.1.1.1.1.1.1" xref="A10.E51.m1.4.4.4.2.1.1.1.1.1.1.1.1.1.1.cmml">−</mo><msub id="A10.E51.m1.4.4.4.2.1.1.1.1.1.1.1.1.1.3" xref="A10.E51.m1.4.4.4.2.1.1.1.1.1.1.1.1.1.3.cmml"><mi id="A10.E51.m1.4.4.4.2.1.1.1.1.1.1.1.1.1.3.2" xref="A10.E51.m1.4.4.4.2.1.1.1.1.1.1.1.1.1.3.2.cmml">𝐰</mi><mi id="A10.E51.m1.4.4.4.2.1.1.1.1.1.1.1.1.1.3.3" xref="A10.E51.m1.4.4.4.2.1.1.1.1.1.1.1.1.1.3.3.cmml">j</mi></msub></mrow><mo stretchy="false" id="A10.E51.m1.4.4.4.2.1.1.1.1.1.1.1.1.3" xref="A10.E51.m1.4.4.4.2.1.1.1.1.1.1.1.2.1.cmml">‖</mo></mrow><mn id="A10.E51.m1.4.4.4.2.1.1.1.1.1.1.3" xref="A10.E51.m1.4.4.4.2.1.1.1.1.1.1.3.cmml">2</mn></msup></mrow></mrow><mo stretchy="false" id="A10.E51.m1.4.4.4.2.1.1.1.3" xref="A10.E51.m1.4.4.4.2.1.2.cmml">)</mo></mrow></mrow></mrow></mrow></mfrac></mstyle><mo id="A10.E51.m1.6.6.1.1.2" xref="A10.E51.m1.6.6.1.1.2.cmml">=</mo><mrow id="A10.E51.m1.6.6.1.1.1" xref="A10.E51.m1.6.6.1.1.1.cmml"><mi id="A10.E51.m1.6.6.1.1.1.3" xref="A10.E51.m1.6.6.1.1.1.3.cmml">p</mi><mo lspace="0em" rspace="0em" id="A10.E51.m1.6.6.1.1.1.2" xref="A10.E51.m1.6.6.1.1.1.2.cmml">​</mo><mrow id="A10.E51.m1.6.6.1.1.1.1.1" xref="A10.E51.m1.6.6.1.1.1.1.1.1.cmml"><mo stretchy="false" id="A10.E51.m1.6.6.1.1.1.1.1.2" xref="A10.E51.m1.6.6.1.1.1.1.1.1.cmml">(</mo><mrow id="A10.E51.m1.6.6.1.1.1.1.1.1" xref="A10.E51.m1.6.6.1.1.1.1.1.1.cmml"><mi id="A10.E51.m1.6.6.1.1.1.1.1.1.4" xref="A10.E51.m1.6.6.1.1.1.1.1.1.4.cmml">z</mi><mo id="A10.E51.m1.6.6.1.1.1.1.1.1.3" xref="A10.E51.m1.6.6.1.1.1.1.1.1.3.cmml">=</mo><mrow id="A10.E51.m1.6.6.1.1.1.1.1.1.2" xref="A10.E51.m1.6.6.1.1.1.1.1.1.2.cmml"><mi id="A10.E51.m1.6.6.1.1.1.1.1.1.2.4" xref="A10.E51.m1.6.6.1.1.1.1.1.1.2.4.cmml">k</mi><mo fence="false" id="A10.E51.m1.6.6.1.1.1.1.1.1.2.3" xref="A10.E51.m1.6.6.1.1.1.1.1.1.2.3.cmml">|</mo><mrow id="A10.E51.m1.6.6.1.1.1.1.1.1.2.2.2" xref="A10.E51.m1.6.6.1.1.1.1.1.1.2.2.3.cmml"><msub id="A10.E51.m1.6.6.1.1.1.1.1.1.1.1.1.1" xref="A10.E51.m1.6.6.1.1.1.1.1.1.1.1.1.1.cmml"><mi id="A10.E51.m1.6.6.1.1.1.1.1.1.1.1.1.1.2" xref="A10.E51.m1.6.6.1.1.1.1.1.1.1.1.1.1.2.cmml">𝐰</mi><mi id="A10.E51.m1.6.6.1.1.1.1.1.1.1.1.1.1.3" xref="A10.E51.m1.6.6.1.1.1.1.1.1.1.1.1.1.3.cmml">s</mi></msub><mo id="A10.E51.m1.6.6.1.1.1.1.1.1.2.2.2.3" xref="A10.E51.m1.6.6.1.1.1.1.1.1.2.2.3.cmml">,</mo><msub id="A10.E51.m1.6.6.1.1.1.1.1.1.2.2.2.2" xref="A10.E51.m1.6.6.1.1.1.1.1.1.2.2.2.2.cmml"><mi id="A10.E51.m1.6.6.1.1.1.1.1.1.2.2.2.2.2" xref="A10.E51.m1.6.6.1.1.1.1.1.1.2.2.2.2.2.cmml">𝐰</mi><mrow id="A10.E51.m1.6.6.1.1.1.1.1.1.2.2.2.2.3" xref="A10.E51.m1.6.6.1.1.1.1.1.1.2.2.2.2.3.cmml"><mn id="A10.E51.m1.6.6.1.1.1.1.1.1.2.2.2.2.3.2" xref="A10.E51.m1.6.6.1.1.1.1.1.1.2.2.2.2.3.2.cmml">1</mn><mo lspace="0.278em" rspace="0.278em" id="A10.E51.m1.6.6.1.1.1.1.1.1.2.2.2.2.3.1" xref="A10.E51.m1.6.6.1.1.1.1.1.1.2.2.2.2.3.1.cmml">:</mo><mi id="A10.E51.m1.6.6.1.1.1.1.1.1.2.2.2.2.3.3" xref="A10.E51.m1.6.6.1.1.1.1.1.1.2.2.2.2.3.3.cmml">K</mi></mrow></msub><mo id="A10.E51.m1.6.6.1.1.1.1.1.1.2.2.2.4" xref="A10.E51.m1.6.6.1.1.1.1.1.1.2.2.3.cmml">,</mo><mi id="A10.E51.m1.5.5" xref="A10.E51.m1.5.5.cmml">λ</mi></mrow></mrow></mrow><mo stretchy="false" id="A10.E51.m1.6.6.1.1.1.1.1.3" xref="A10.E51.m1.6.6.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><mo lspace="0em" id="A10.E51.m1.6.6.1.2" xref="A10.E51.m1.6.6.1.1.cmml">.</mo></mrow><annotation-xml encoding="MathML-Content" id="A10.E51.m1.6b"><apply id="A10.E51.m1.6.6.1.1.cmml" xref="A10.E51.m1.6.6.1"><eq id="A10.E51.m1.6.6.1.1.2.cmml" xref="A10.E51.m1.6.6.1.1.2"></eq><apply id="A10.E51.m1.4.4.cmml" xref="A10.E51.m1.4.4"><divide id="A10.E51.m1.4.4.5.cmml" xref="A10.E51.m1.4.4"></divide><apply id="A10.E51.m1.2.2.2.cmml" xref="A10.E51.m1.2.2.2"><times id="A10.E51.m1.2.2.2.3.cmml" xref="A10.E51.m1.2.2.2.3"></times><apply id="A10.E51.m1.2.2.2.4.cmml" xref="A10.E51.m1.2.2.2.4"><divide id="A10.E51.m1.2.2.2.4.1.cmml" xref="A10.E51.m1.2.2.2.4"></divide><apply id="A10.E51.m1.2.2.2.4.2.cmml" xref="A10.E51.m1.2.2.2.4.2"><csymbol cd="ambiguous" id="A10.E51.m1.2.2.2.4.2.1.cmml" xref="A10.E51.m1.2.2.2.4.2">subscript</csymbol><ci id="A10.E51.m1.2.2.2.4.2.2.cmml" xref="A10.E51.m1.2.2.2.4.2.2">𝑍</ci><ci id="A10.E51.m1.2.2.2.4.2.3.cmml" xref="A10.E51.m1.2.2.2.4.2.3">𝑘</ci></apply><ci id="A10.E51.m1.2.2.2.4.3.cmml" xref="A10.E51.m1.2.2.2.4.3">𝐾</ci></apply><apply id="A10.E51.m1.2.2.2.2.2.cmml" xref="A10.E51.m1.2.2.2.2.1"><exp id="A10.E51.m1.1.1.1.1.cmml" xref="A10.E51.m1.1.1.1.1"></exp><apply id="A10.E51.m1.2.2.2.2.1.1.1.cmml" xref="A10.E51.m1.2.2.2.2.1.1.1"><minus id="A10.E51.m1.2.2.2.2.1.1.1.2.cmml" xref="A10.E51.m1.2.2.2.2.1.1.1"></minus><apply id="A10.E51.m1.2.2.2.2.1.1.1.1.cmml" xref="A10.E51.m1.2.2.2.2.1.1.1.1"><times id="A10.E51.m1.2.2.2.2.1.1.1.1.2.cmml" xref="A10.E51.m1.2.2.2.2.1.1.1.1.2"></times><apply id="A10.E51.m1.2.2.2.2.1.1.1.1.3.cmml" xref="A10.E51.m1.2.2.2.2.1.1.1.1.3"><divide id="A10.E51.m1.2.2.2.2.1.1.1.1.3.1.cmml" xref="A10.E51.m1.2.2.2.2.1.1.1.1.3"></divide><ci id="A10.E51.m1.2.2.2.2.1.1.1.1.3.2.cmml" xref="A10.E51.m1.2.2.2.2.1.1.1.1.3.2">𝜆</ci><cn type="integer" id="A10.E51.m1.2.2.2.2.1.1.1.1.3.3.cmml" xref="A10.E51.m1.2.2.2.2.1.1.1.1.3.3">2</cn></apply><apply id="A10.E51.m1.2.2.2.2.1.1.1.1.1.cmml" xref="A10.E51.m1.2.2.2.2.1.1.1.1.1"><csymbol cd="ambiguous" id="A10.E51.m1.2.2.2.2.1.1.1.1.1.2.cmml" xref="A10.E51.m1.2.2.2.2.1.1.1.1.1">superscript</csymbol><apply id="A10.E51.m1.2.2.2.2.1.1.1.1.1.1.2.cmml" xref="A10.E51.m1.2.2.2.2.1.1.1.1.1.1.1"><csymbol cd="latexml" id="A10.E51.m1.2.2.2.2.1.1.1.1.1.1.2.1.cmml" xref="A10.E51.m1.2.2.2.2.1.1.1.1.1.1.1.2">norm</csymbol><apply id="A10.E51.m1.2.2.2.2.1.1.1.1.1.1.1.1.cmml" xref="A10.E51.m1.2.2.2.2.1.1.1.1.1.1.1.1"><minus id="A10.E51.m1.2.2.2.2.1.1.1.1.1.1.1.1.1.cmml" xref="A10.E51.m1.2.2.2.2.1.1.1.1.1.1.1.1.1"></minus><apply id="A10.E51.m1.2.2.2.2.1.1.1.1.1.1.1.1.2.cmml" xref="A10.E51.m1.2.2.2.2.1.1.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="A10.E51.m1.2.2.2.2.1.1.1.1.1.1.1.1.2.1.cmml" xref="A10.E51.m1.2.2.2.2.1.1.1.1.1.1.1.1.2">subscript</csymbol><ci id="A10.E51.m1.2.2.2.2.1.1.1.1.1.1.1.1.2.2.cmml" xref="A10.E51.m1.2.2.2.2.1.1.1.1.1.1.1.1.2.2">𝐰</ci><ci id="A10.E51.m1.2.2.2.2.1.1.1.1.1.1.1.1.2.3.cmml" xref="A10.E51.m1.2.2.2.2.1.1.1.1.1.1.1.1.2.3">𝑠</ci></apply><apply id="A10.E51.m1.2.2.2.2.1.1.1.1.1.1.1.1.3.cmml" xref="A10.E51.m1.2.2.2.2.1.1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="A10.E51.m1.2.2.2.2.1.1.1.1.1.1.1.1.3.1.cmml" xref="A10.E51.m1.2.2.2.2.1.1.1.1.1.1.1.1.3">subscript</csymbol><ci id="A10.E51.m1.2.2.2.2.1.1.1.1.1.1.1.1.3.2.cmml" xref="A10.E51.m1.2.2.2.2.1.1.1.1.1.1.1.1.3.2">𝐰</ci><ci id="A10.E51.m1.2.2.2.2.1.1.1.1.1.1.1.1.3.3.cmml" xref="A10.E51.m1.2.2.2.2.1.1.1.1.1.1.1.1.3.3">𝑘</ci></apply></apply></apply><cn type="integer" id="A10.E51.m1.2.2.2.2.1.1.1.1.1.3.cmml" xref="A10.E51.m1.2.2.2.2.1.1.1.1.1.3">2</cn></apply></apply></apply></apply></apply><apply id="A10.E51.m1.4.4.4.cmml" xref="A10.E51.m1.4.4.4"><apply id="A10.E51.m1.4.4.4.3.cmml" xref="A10.E51.m1.4.4.4.3"><csymbol cd="ambiguous" id="A10.E51.m1.4.4.4.3.1.cmml" xref="A10.E51.m1.4.4.4.3">subscript</csymbol><sum id="A10.E51.m1.4.4.4.3.2.cmml" xref="A10.E51.m1.4.4.4.3.2"></sum><ci id="A10.E51.m1.4.4.4.3.3.cmml" xref="A10.E51.m1.4.4.4.3.3">𝑗</ci></apply><apply id="A10.E51.m1.4.4.4.2.cmml" xref="A10.E51.m1.4.4.4.2"><times id="A10.E51.m1.4.4.4.2.2.cmml" xref="A10.E51.m1.4.4.4.2.2"></times><apply id="A10.E51.m1.4.4.4.2.3.cmml" xref="A10.E51.m1.4.4.4.2.3"><divide id="A10.E51.m1.4.4.4.2.3.1.cmml" xref="A10.E51.m1.4.4.4.2.3"></divide><apply id="A10.E51.m1.4.4.4.2.3.2.cmml" xref="A10.E51.m1.4.4.4.2.3.2"><csymbol cd="ambiguous" id="A10.E51.m1.4.4.4.2.3.2.1.cmml" xref="A10.E51.m1.4.4.4.2.3.2">subscript</csymbol><ci id="A10.E51.m1.4.4.4.2.3.2.2.cmml" xref="A10.E51.m1.4.4.4.2.3.2.2">𝑍</ci><ci id="A10.E51.m1.4.4.4.2.3.2.3.cmml" xref="A10.E51.m1.4.4.4.2.3.2.3">𝑗</ci></apply><ci id="A10.E51.m1.4.4.4.2.3.3.cmml" xref="A10.E51.m1.4.4.4.2.3.3">𝐾</ci></apply><apply id="A10.E51.m1.4.4.4.2.1.2.cmml" xref="A10.E51.m1.4.4.4.2.1.1"><exp id="A10.E51.m1.3.3.3.1.cmml" xref="A10.E51.m1.3.3.3.1"></exp><apply id="A10.E51.m1.4.4.4.2.1.1.1.1.cmml" xref="A10.E51.m1.4.4.4.2.1.1.1.1"><minus id="A10.E51.m1.4.4.4.2.1.1.1.1.2.cmml" xref="A10.E51.m1.4.4.4.2.1.1.1.1"></minus><apply id="A10.E51.m1.4.4.4.2.1.1.1.1.1.cmml" xref="A10.E51.m1.4.4.4.2.1.1.1.1.1"><times id="A10.E51.m1.4.4.4.2.1.1.1.1.1.2.cmml" xref="A10.E51.m1.4.4.4.2.1.1.1.1.1.2"></times><apply id="A10.E51.m1.4.4.4.2.1.1.1.1.1.3.cmml" xref="A10.E51.m1.4.4.4.2.1.1.1.1.1.3"><divide id="A10.E51.m1.4.4.4.2.1.1.1.1.1.3.1.cmml" xref="A10.E51.m1.4.4.4.2.1.1.1.1.1.3"></divide><ci id="A10.E51.m1.4.4.4.2.1.1.1.1.1.3.2.cmml" xref="A10.E51.m1.4.4.4.2.1.1.1.1.1.3.2">𝜆</ci><cn type="integer" id="A10.E51.m1.4.4.4.2.1.1.1.1.1.3.3.cmml" xref="A10.E51.m1.4.4.4.2.1.1.1.1.1.3.3">2</cn></apply><apply id="A10.E51.m1.4.4.4.2.1.1.1.1.1.1.cmml" xref="A10.E51.m1.4.4.4.2.1.1.1.1.1.1"><csymbol cd="ambiguous" id="A10.E51.m1.4.4.4.2.1.1.1.1.1.1.2.cmml" xref="A10.E51.m1.4.4.4.2.1.1.1.1.1.1">superscript</csymbol><apply id="A10.E51.m1.4.4.4.2.1.1.1.1.1.1.1.2.cmml" xref="A10.E51.m1.4.4.4.2.1.1.1.1.1.1.1.1"><csymbol cd="latexml" id="A10.E51.m1.4.4.4.2.1.1.1.1.1.1.1.2.1.cmml" xref="A10.E51.m1.4.4.4.2.1.1.1.1.1.1.1.1.2">norm</csymbol><apply id="A10.E51.m1.4.4.4.2.1.1.1.1.1.1.1.1.1.cmml" xref="A10.E51.m1.4.4.4.2.1.1.1.1.1.1.1.1.1"><minus id="A10.E51.m1.4.4.4.2.1.1.1.1.1.1.1.1.1.1.cmml" xref="A10.E51.m1.4.4.4.2.1.1.1.1.1.1.1.1.1.1"></minus><apply id="A10.E51.m1.4.4.4.2.1.1.1.1.1.1.1.1.1.2.cmml" xref="A10.E51.m1.4.4.4.2.1.1.1.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="A10.E51.m1.4.4.4.2.1.1.1.1.1.1.1.1.1.2.1.cmml" xref="A10.E51.m1.4.4.4.2.1.1.1.1.1.1.1.1.1.2">subscript</csymbol><ci id="A10.E51.m1.4.4.4.2.1.1.1.1.1.1.1.1.1.2.2.cmml" xref="A10.E51.m1.4.4.4.2.1.1.1.1.1.1.1.1.1.2.2">𝐰</ci><ci id="A10.E51.m1.4.4.4.2.1.1.1.1.1.1.1.1.1.2.3.cmml" xref="A10.E51.m1.4.4.4.2.1.1.1.1.1.1.1.1.1.2.3">𝑠</ci></apply><apply id="A10.E51.m1.4.4.4.2.1.1.1.1.1.1.1.1.1.3.cmml" xref="A10.E51.m1.4.4.4.2.1.1.1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="A10.E51.m1.4.4.4.2.1.1.1.1.1.1.1.1.1.3.1.cmml" xref="A10.E51.m1.4.4.4.2.1.1.1.1.1.1.1.1.1.3">subscript</csymbol><ci id="A10.E51.m1.4.4.4.2.1.1.1.1.1.1.1.1.1.3.2.cmml" xref="A10.E51.m1.4.4.4.2.1.1.1.1.1.1.1.1.1.3.2">𝐰</ci><ci id="A10.E51.m1.4.4.4.2.1.1.1.1.1.1.1.1.1.3.3.cmml" xref="A10.E51.m1.4.4.4.2.1.1.1.1.1.1.1.1.1.3.3">𝑗</ci></apply></apply></apply><cn type="integer" id="A10.E51.m1.4.4.4.2.1.1.1.1.1.1.3.cmml" xref="A10.E51.m1.4.4.4.2.1.1.1.1.1.1.3">2</cn></apply></apply></apply></apply></apply></apply></apply><apply id="A10.E51.m1.6.6.1.1.1.cmml" xref="A10.E51.m1.6.6.1.1.1"><times id="A10.E51.m1.6.6.1.1.1.2.cmml" xref="A10.E51.m1.6.6.1.1.1.2"></times><ci id="A10.E51.m1.6.6.1.1.1.3.cmml" xref="A10.E51.m1.6.6.1.1.1.3">𝑝</ci><apply id="A10.E51.m1.6.6.1.1.1.1.1.1.cmml" xref="A10.E51.m1.6.6.1.1.1.1.1"><eq id="A10.E51.m1.6.6.1.1.1.1.1.1.3.cmml" xref="A10.E51.m1.6.6.1.1.1.1.1.1.3"></eq><ci id="A10.E51.m1.6.6.1.1.1.1.1.1.4.cmml" xref="A10.E51.m1.6.6.1.1.1.1.1.1.4">𝑧</ci><apply id="A10.E51.m1.6.6.1.1.1.1.1.1.2.cmml" xref="A10.E51.m1.6.6.1.1.1.1.1.1.2"><csymbol cd="latexml" id="A10.E51.m1.6.6.1.1.1.1.1.1.2.3.cmml" xref="A10.E51.m1.6.6.1.1.1.1.1.1.2.3">conditional</csymbol><ci id="A10.E51.m1.6.6.1.1.1.1.1.1.2.4.cmml" xref="A10.E51.m1.6.6.1.1.1.1.1.1.2.4">𝑘</ci><list id="A10.E51.m1.6.6.1.1.1.1.1.1.2.2.3.cmml" xref="A10.E51.m1.6.6.1.1.1.1.1.1.2.2.2"><apply id="A10.E51.m1.6.6.1.1.1.1.1.1.1.1.1.1.cmml" xref="A10.E51.m1.6.6.1.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="A10.E51.m1.6.6.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="A10.E51.m1.6.6.1.1.1.1.1.1.1.1.1.1">subscript</csymbol><ci id="A10.E51.m1.6.6.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="A10.E51.m1.6.6.1.1.1.1.1.1.1.1.1.1.2">𝐰</ci><ci id="A10.E51.m1.6.6.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="A10.E51.m1.6.6.1.1.1.1.1.1.1.1.1.1.3">𝑠</ci></apply><apply id="A10.E51.m1.6.6.1.1.1.1.1.1.2.2.2.2.cmml" xref="A10.E51.m1.6.6.1.1.1.1.1.1.2.2.2.2"><csymbol cd="ambiguous" id="A10.E51.m1.6.6.1.1.1.1.1.1.2.2.2.2.1.cmml" xref="A10.E51.m1.6.6.1.1.1.1.1.1.2.2.2.2">subscript</csymbol><ci id="A10.E51.m1.6.6.1.1.1.1.1.1.2.2.2.2.2.cmml" xref="A10.E51.m1.6.6.1.1.1.1.1.1.2.2.2.2.2">𝐰</ci><apply id="A10.E51.m1.6.6.1.1.1.1.1.1.2.2.2.2.3.cmml" xref="A10.E51.m1.6.6.1.1.1.1.1.1.2.2.2.2.3"><ci id="A10.E51.m1.6.6.1.1.1.1.1.1.2.2.2.2.3.1.cmml" xref="A10.E51.m1.6.6.1.1.1.1.1.1.2.2.2.2.3.1">:</ci><cn type="integer" id="A10.E51.m1.6.6.1.1.1.1.1.1.2.2.2.2.3.2.cmml" xref="A10.E51.m1.6.6.1.1.1.1.1.1.2.2.2.2.3.2">1</cn><ci id="A10.E51.m1.6.6.1.1.1.1.1.1.2.2.2.2.3.3.cmml" xref="A10.E51.m1.6.6.1.1.1.1.1.1.2.2.2.2.3.3">𝐾</ci></apply></apply><ci id="A10.E51.m1.5.5.cmml" xref="A10.E51.m1.5.5">𝜆</ci></list></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A10.E51.m1.6c">\displaystyle\frac{\frac{Z_{k}}{K}\exp(-\frac{\lambda}{2}\|\mathbf{w}_{s}-\mathbf{w}_{k}\|^{2})}{\sum_{j}\frac{Z_{j}}{K}\exp(-\frac{\lambda}{2}\|\mathbf{w}_{s}-\mathbf{w}_{j}\|^{2})}=p(z=k|\mathbf{w}_{s},\mathbf{w}_{1:K},\lambda).</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(51)</span></td>
</tr></tbody>
</table>
<p id="A10.SS2.p1.22" class="ltx_p">This make apparent the connection to Gaussian mixture models, since <math id="A10.SS2.p1.19.m1.2" class="ltx_Math" alttext="p(z=k|\mathbf{w}_{s},\mathbf{w}_{1:K},\lambda)" display="inline"><semantics id="A10.SS2.p1.19.m1.2a"><mrow id="A10.SS2.p1.19.m1.2.2" xref="A10.SS2.p1.19.m1.2.2.cmml"><mi id="A10.SS2.p1.19.m1.2.2.3" xref="A10.SS2.p1.19.m1.2.2.3.cmml">p</mi><mo lspace="0em" rspace="0em" id="A10.SS2.p1.19.m1.2.2.2" xref="A10.SS2.p1.19.m1.2.2.2.cmml">​</mo><mrow id="A10.SS2.p1.19.m1.2.2.1.1" xref="A10.SS2.p1.19.m1.2.2.1.1.1.cmml"><mo stretchy="false" id="A10.SS2.p1.19.m1.2.2.1.1.2" xref="A10.SS2.p1.19.m1.2.2.1.1.1.cmml">(</mo><mrow id="A10.SS2.p1.19.m1.2.2.1.1.1" xref="A10.SS2.p1.19.m1.2.2.1.1.1.cmml"><mi id="A10.SS2.p1.19.m1.2.2.1.1.1.4" xref="A10.SS2.p1.19.m1.2.2.1.1.1.4.cmml">z</mi><mo id="A10.SS2.p1.19.m1.2.2.1.1.1.3" xref="A10.SS2.p1.19.m1.2.2.1.1.1.3.cmml">=</mo><mrow id="A10.SS2.p1.19.m1.2.2.1.1.1.2" xref="A10.SS2.p1.19.m1.2.2.1.1.1.2.cmml"><mi id="A10.SS2.p1.19.m1.2.2.1.1.1.2.4" xref="A10.SS2.p1.19.m1.2.2.1.1.1.2.4.cmml">k</mi><mo fence="false" id="A10.SS2.p1.19.m1.2.2.1.1.1.2.3" xref="A10.SS2.p1.19.m1.2.2.1.1.1.2.3.cmml">|</mo><mrow id="A10.SS2.p1.19.m1.2.2.1.1.1.2.2.2" xref="A10.SS2.p1.19.m1.2.2.1.1.1.2.2.3.cmml"><msub id="A10.SS2.p1.19.m1.2.2.1.1.1.1.1.1.1" xref="A10.SS2.p1.19.m1.2.2.1.1.1.1.1.1.1.cmml"><mi id="A10.SS2.p1.19.m1.2.2.1.1.1.1.1.1.1.2" xref="A10.SS2.p1.19.m1.2.2.1.1.1.1.1.1.1.2.cmml">𝐰</mi><mi id="A10.SS2.p1.19.m1.2.2.1.1.1.1.1.1.1.3" xref="A10.SS2.p1.19.m1.2.2.1.1.1.1.1.1.1.3.cmml">s</mi></msub><mo id="A10.SS2.p1.19.m1.2.2.1.1.1.2.2.2.3" xref="A10.SS2.p1.19.m1.2.2.1.1.1.2.2.3.cmml">,</mo><msub id="A10.SS2.p1.19.m1.2.2.1.1.1.2.2.2.2" xref="A10.SS2.p1.19.m1.2.2.1.1.1.2.2.2.2.cmml"><mi id="A10.SS2.p1.19.m1.2.2.1.1.1.2.2.2.2.2" xref="A10.SS2.p1.19.m1.2.2.1.1.1.2.2.2.2.2.cmml">𝐰</mi><mrow id="A10.SS2.p1.19.m1.2.2.1.1.1.2.2.2.2.3" xref="A10.SS2.p1.19.m1.2.2.1.1.1.2.2.2.2.3.cmml"><mn id="A10.SS2.p1.19.m1.2.2.1.1.1.2.2.2.2.3.2" xref="A10.SS2.p1.19.m1.2.2.1.1.1.2.2.2.2.3.2.cmml">1</mn><mo lspace="0.278em" rspace="0.278em" id="A10.SS2.p1.19.m1.2.2.1.1.1.2.2.2.2.3.1" xref="A10.SS2.p1.19.m1.2.2.1.1.1.2.2.2.2.3.1.cmml">:</mo><mi id="A10.SS2.p1.19.m1.2.2.1.1.1.2.2.2.2.3.3" xref="A10.SS2.p1.19.m1.2.2.1.1.1.2.2.2.2.3.3.cmml">K</mi></mrow></msub><mo id="A10.SS2.p1.19.m1.2.2.1.1.1.2.2.2.4" xref="A10.SS2.p1.19.m1.2.2.1.1.1.2.2.3.cmml">,</mo><mi id="A10.SS2.p1.19.m1.1.1" xref="A10.SS2.p1.19.m1.1.1.cmml">λ</mi></mrow></mrow></mrow><mo stretchy="false" id="A10.SS2.p1.19.m1.2.2.1.1.3" xref="A10.SS2.p1.19.m1.2.2.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="A10.SS2.p1.19.m1.2b"><apply id="A10.SS2.p1.19.m1.2.2.cmml" xref="A10.SS2.p1.19.m1.2.2"><times id="A10.SS2.p1.19.m1.2.2.2.cmml" xref="A10.SS2.p1.19.m1.2.2.2"></times><ci id="A10.SS2.p1.19.m1.2.2.3.cmml" xref="A10.SS2.p1.19.m1.2.2.3">𝑝</ci><apply id="A10.SS2.p1.19.m1.2.2.1.1.1.cmml" xref="A10.SS2.p1.19.m1.2.2.1.1"><eq id="A10.SS2.p1.19.m1.2.2.1.1.1.3.cmml" xref="A10.SS2.p1.19.m1.2.2.1.1.1.3"></eq><ci id="A10.SS2.p1.19.m1.2.2.1.1.1.4.cmml" xref="A10.SS2.p1.19.m1.2.2.1.1.1.4">𝑧</ci><apply id="A10.SS2.p1.19.m1.2.2.1.1.1.2.cmml" xref="A10.SS2.p1.19.m1.2.2.1.1.1.2"><csymbol cd="latexml" id="A10.SS2.p1.19.m1.2.2.1.1.1.2.3.cmml" xref="A10.SS2.p1.19.m1.2.2.1.1.1.2.3">conditional</csymbol><ci id="A10.SS2.p1.19.m1.2.2.1.1.1.2.4.cmml" xref="A10.SS2.p1.19.m1.2.2.1.1.1.2.4">𝑘</ci><list id="A10.SS2.p1.19.m1.2.2.1.1.1.2.2.3.cmml" xref="A10.SS2.p1.19.m1.2.2.1.1.1.2.2.2"><apply id="A10.SS2.p1.19.m1.2.2.1.1.1.1.1.1.1.cmml" xref="A10.SS2.p1.19.m1.2.2.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="A10.SS2.p1.19.m1.2.2.1.1.1.1.1.1.1.1.cmml" xref="A10.SS2.p1.19.m1.2.2.1.1.1.1.1.1.1">subscript</csymbol><ci id="A10.SS2.p1.19.m1.2.2.1.1.1.1.1.1.1.2.cmml" xref="A10.SS2.p1.19.m1.2.2.1.1.1.1.1.1.1.2">𝐰</ci><ci id="A10.SS2.p1.19.m1.2.2.1.1.1.1.1.1.1.3.cmml" xref="A10.SS2.p1.19.m1.2.2.1.1.1.1.1.1.1.3">𝑠</ci></apply><apply id="A10.SS2.p1.19.m1.2.2.1.1.1.2.2.2.2.cmml" xref="A10.SS2.p1.19.m1.2.2.1.1.1.2.2.2.2"><csymbol cd="ambiguous" id="A10.SS2.p1.19.m1.2.2.1.1.1.2.2.2.2.1.cmml" xref="A10.SS2.p1.19.m1.2.2.1.1.1.2.2.2.2">subscript</csymbol><ci id="A10.SS2.p1.19.m1.2.2.1.1.1.2.2.2.2.2.cmml" xref="A10.SS2.p1.19.m1.2.2.1.1.1.2.2.2.2.2">𝐰</ci><apply id="A10.SS2.p1.19.m1.2.2.1.1.1.2.2.2.2.3.cmml" xref="A10.SS2.p1.19.m1.2.2.1.1.1.2.2.2.2.3"><ci id="A10.SS2.p1.19.m1.2.2.1.1.1.2.2.2.2.3.1.cmml" xref="A10.SS2.p1.19.m1.2.2.1.1.1.2.2.2.2.3.1">:</ci><cn type="integer" id="A10.SS2.p1.19.m1.2.2.1.1.1.2.2.2.2.3.2.cmml" xref="A10.SS2.p1.19.m1.2.2.1.1.1.2.2.2.2.3.2">1</cn><ci id="A10.SS2.p1.19.m1.2.2.1.1.1.2.2.2.2.3.3.cmml" xref="A10.SS2.p1.19.m1.2.2.1.1.1.2.2.2.2.3.3">𝐾</ci></apply></apply><ci id="A10.SS2.p1.19.m1.1.1.cmml" xref="A10.SS2.p1.19.m1.1.1">𝜆</ci></list></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A10.SS2.p1.19.m1.2c">p(z=k|\mathbf{w}_{s},\mathbf{w}_{1:K},\lambda)</annotation></semantics></math> is equivalent to the responsibility of component <math id="A10.SS2.p1.20.m2.1" class="ltx_Math" alttext="k" display="inline"><semantics id="A10.SS2.p1.20.m2.1a"><mi id="A10.SS2.p1.20.m2.1.1" xref="A10.SS2.p1.20.m2.1.1.cmml">k</mi><annotation-xml encoding="MathML-Content" id="A10.SS2.p1.20.m2.1b"><ci id="A10.SS2.p1.20.m2.1.1.cmml" xref="A10.SS2.p1.20.m2.1.1">𝑘</ci></annotation-xml><annotation encoding="application/x-tex" id="A10.SS2.p1.20.m2.1c">k</annotation></semantics></math> generating <math id="A10.SS2.p1.21.m3.1" class="ltx_Math" alttext="\mathbf{w}_{s}" display="inline"><semantics id="A10.SS2.p1.21.m3.1a"><msub id="A10.SS2.p1.21.m3.1.1" xref="A10.SS2.p1.21.m3.1.1.cmml"><mi id="A10.SS2.p1.21.m3.1.1.2" xref="A10.SS2.p1.21.m3.1.1.2.cmml">𝐰</mi><mi id="A10.SS2.p1.21.m3.1.1.3" xref="A10.SS2.p1.21.m3.1.1.3.cmml">s</mi></msub><annotation-xml encoding="MathML-Content" id="A10.SS2.p1.21.m3.1b"><apply id="A10.SS2.p1.21.m3.1.1.cmml" xref="A10.SS2.p1.21.m3.1.1"><csymbol cd="ambiguous" id="A10.SS2.p1.21.m3.1.1.1.cmml" xref="A10.SS2.p1.21.m3.1.1">subscript</csymbol><ci id="A10.SS2.p1.21.m3.1.1.2.cmml" xref="A10.SS2.p1.21.m3.1.1.2">𝐰</ci><ci id="A10.SS2.p1.21.m3.1.1.3.cmml" xref="A10.SS2.p1.21.m3.1.1.3">𝑠</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A10.SS2.p1.21.m3.1c">\mathbf{w}_{s}</annotation></semantics></math>. Now we can again find a closed form solution for <math id="A10.SS2.p1.22.m4.1" class="ltx_Math" alttext="\mathbf{w}_{k}" display="inline"><semantics id="A10.SS2.p1.22.m4.1a"><msub id="A10.SS2.p1.22.m4.1.1" xref="A10.SS2.p1.22.m4.1.1.cmml"><mi id="A10.SS2.p1.22.m4.1.1.2" xref="A10.SS2.p1.22.m4.1.1.2.cmml">𝐰</mi><mi id="A10.SS2.p1.22.m4.1.1.3" xref="A10.SS2.p1.22.m4.1.1.3.cmml">k</mi></msub><annotation-xml encoding="MathML-Content" id="A10.SS2.p1.22.m4.1b"><apply id="A10.SS2.p1.22.m4.1.1.cmml" xref="A10.SS2.p1.22.m4.1.1"><csymbol cd="ambiguous" id="A10.SS2.p1.22.m4.1.1.1.cmml" xref="A10.SS2.p1.22.m4.1.1">subscript</csymbol><ci id="A10.SS2.p1.22.m4.1.1.2.cmml" xref="A10.SS2.p1.22.m4.1.1.2">𝐰</ci><ci id="A10.SS2.p1.22.m4.1.1.3.cmml" xref="A10.SS2.p1.22.m4.1.1.3">𝑘</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A10.SS2.p1.22.m4.1c">\mathbf{w}_{k}</annotation></semantics></math> by setting the derivative to zero</p>
<table id="A10.EGx43" class="ltx_equationgroup ltx_eqn_align ltx_eqn_table">

<tbody id="A10.E52"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math id="A10.E52.m1.6" class="ltx_Math" alttext="\displaystyle\frac{\partial L}{\partial\mathbf{w}_{k}}=0\Rightarrow\lambda\sum_{s}p(z=k|\mathbf{w}_{s},\mathbf{w}_{1:K},\lambda)(\mathbf{w}_{s}-\mathbf{w}_{k})\Rightarrow\mathbf{w}_{k}=\sum_{s}\frac{p(z=k|\mathbf{w}_{s},\mathbf{w}_{1:K},\lambda)}{\sum_{j}p(z=k|\mathbf{w}_{j},\mathbf{w}_{1:K},\lambda)}\mathbf{w}_{s}," display="inline"><semantics id="A10.E52.m1.6a"><mrow id="A10.E52.m1.6.6.1" xref="A10.E52.m1.6.6.1.1.cmml"><mrow id="A10.E52.m1.6.6.1.1" xref="A10.E52.m1.6.6.1.1.cmml"><mstyle displaystyle="true" id="A10.E52.m1.6.6.1.1.4" xref="A10.E52.m1.6.6.1.1.4.cmml"><mfrac id="A10.E52.m1.6.6.1.1.4a" xref="A10.E52.m1.6.6.1.1.4.cmml"><mrow id="A10.E52.m1.6.6.1.1.4.2" xref="A10.E52.m1.6.6.1.1.4.2.cmml"><mo rspace="0em" id="A10.E52.m1.6.6.1.1.4.2.1" xref="A10.E52.m1.6.6.1.1.4.2.1.cmml">∂</mo><mi id="A10.E52.m1.6.6.1.1.4.2.2" xref="A10.E52.m1.6.6.1.1.4.2.2.cmml">L</mi></mrow><mrow id="A10.E52.m1.6.6.1.1.4.3" xref="A10.E52.m1.6.6.1.1.4.3.cmml"><mo rspace="0em" id="A10.E52.m1.6.6.1.1.4.3.1" xref="A10.E52.m1.6.6.1.1.4.3.1.cmml">∂</mo><msub id="A10.E52.m1.6.6.1.1.4.3.2" xref="A10.E52.m1.6.6.1.1.4.3.2.cmml"><mi id="A10.E52.m1.6.6.1.1.4.3.2.2" xref="A10.E52.m1.6.6.1.1.4.3.2.2.cmml">𝐰</mi><mi id="A10.E52.m1.6.6.1.1.4.3.2.3" xref="A10.E52.m1.6.6.1.1.4.3.2.3.cmml">k</mi></msub></mrow></mfrac></mstyle><mo id="A10.E52.m1.6.6.1.1.5" xref="A10.E52.m1.6.6.1.1.5.cmml">=</mo><mn id="A10.E52.m1.6.6.1.1.6" xref="A10.E52.m1.6.6.1.1.6.cmml">0</mn><mo stretchy="false" id="A10.E52.m1.6.6.1.1.7" xref="A10.E52.m1.6.6.1.1.7.cmml">⇒</mo><mrow id="A10.E52.m1.6.6.1.1.2" xref="A10.E52.m1.6.6.1.1.2.cmml"><mi id="A10.E52.m1.6.6.1.1.2.4" xref="A10.E52.m1.6.6.1.1.2.4.cmml">λ</mi><mo lspace="0em" rspace="0em" id="A10.E52.m1.6.6.1.1.2.3" xref="A10.E52.m1.6.6.1.1.2.3.cmml">​</mo><mrow id="A10.E52.m1.6.6.1.1.2.2" xref="A10.E52.m1.6.6.1.1.2.2.cmml"><mstyle displaystyle="true" id="A10.E52.m1.6.6.1.1.2.2.3" xref="A10.E52.m1.6.6.1.1.2.2.3.cmml"><munder id="A10.E52.m1.6.6.1.1.2.2.3a" xref="A10.E52.m1.6.6.1.1.2.2.3.cmml"><mo movablelimits="false" id="A10.E52.m1.6.6.1.1.2.2.3.2" xref="A10.E52.m1.6.6.1.1.2.2.3.2.cmml">∑</mo><mi id="A10.E52.m1.6.6.1.1.2.2.3.3" xref="A10.E52.m1.6.6.1.1.2.2.3.3.cmml">s</mi></munder></mstyle><mrow id="A10.E52.m1.6.6.1.1.2.2.2" xref="A10.E52.m1.6.6.1.1.2.2.2.cmml"><mi id="A10.E52.m1.6.6.1.1.2.2.2.4" xref="A10.E52.m1.6.6.1.1.2.2.2.4.cmml">p</mi><mo lspace="0em" rspace="0em" id="A10.E52.m1.6.6.1.1.2.2.2.3" xref="A10.E52.m1.6.6.1.1.2.2.2.3.cmml">​</mo><mrow id="A10.E52.m1.6.6.1.1.1.1.1.1.1" xref="A10.E52.m1.6.6.1.1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="A10.E52.m1.6.6.1.1.1.1.1.1.1.2" xref="A10.E52.m1.6.6.1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="A10.E52.m1.6.6.1.1.1.1.1.1.1.1" xref="A10.E52.m1.6.6.1.1.1.1.1.1.1.1.cmml"><mi id="A10.E52.m1.6.6.1.1.1.1.1.1.1.1.4" xref="A10.E52.m1.6.6.1.1.1.1.1.1.1.1.4.cmml">z</mi><mo id="A10.E52.m1.6.6.1.1.1.1.1.1.1.1.3" xref="A10.E52.m1.6.6.1.1.1.1.1.1.1.1.3.cmml">=</mo><mrow id="A10.E52.m1.6.6.1.1.1.1.1.1.1.1.2" xref="A10.E52.m1.6.6.1.1.1.1.1.1.1.1.2.cmml"><mi id="A10.E52.m1.6.6.1.1.1.1.1.1.1.1.2.4" xref="A10.E52.m1.6.6.1.1.1.1.1.1.1.1.2.4.cmml">k</mi><mo fence="false" id="A10.E52.m1.6.6.1.1.1.1.1.1.1.1.2.3" xref="A10.E52.m1.6.6.1.1.1.1.1.1.1.1.2.3.cmml">|</mo><mrow id="A10.E52.m1.6.6.1.1.1.1.1.1.1.1.2.2.2" xref="A10.E52.m1.6.6.1.1.1.1.1.1.1.1.2.2.3.cmml"><msub id="A10.E52.m1.6.6.1.1.1.1.1.1.1.1.1.1.1.1" xref="A10.E52.m1.6.6.1.1.1.1.1.1.1.1.1.1.1.1.cmml"><mi id="A10.E52.m1.6.6.1.1.1.1.1.1.1.1.1.1.1.1.2" xref="A10.E52.m1.6.6.1.1.1.1.1.1.1.1.1.1.1.1.2.cmml">𝐰</mi><mi id="A10.E52.m1.6.6.1.1.1.1.1.1.1.1.1.1.1.1.3" xref="A10.E52.m1.6.6.1.1.1.1.1.1.1.1.1.1.1.1.3.cmml">s</mi></msub><mo id="A10.E52.m1.6.6.1.1.1.1.1.1.1.1.2.2.2.3" xref="A10.E52.m1.6.6.1.1.1.1.1.1.1.1.2.2.3.cmml">,</mo><msub id="A10.E52.m1.6.6.1.1.1.1.1.1.1.1.2.2.2.2" xref="A10.E52.m1.6.6.1.1.1.1.1.1.1.1.2.2.2.2.cmml"><mi id="A10.E52.m1.6.6.1.1.1.1.1.1.1.1.2.2.2.2.2" xref="A10.E52.m1.6.6.1.1.1.1.1.1.1.1.2.2.2.2.2.cmml">𝐰</mi><mrow id="A10.E52.m1.6.6.1.1.1.1.1.1.1.1.2.2.2.2.3" xref="A10.E52.m1.6.6.1.1.1.1.1.1.1.1.2.2.2.2.3.cmml"><mn id="A10.E52.m1.6.6.1.1.1.1.1.1.1.1.2.2.2.2.3.2" xref="A10.E52.m1.6.6.1.1.1.1.1.1.1.1.2.2.2.2.3.2.cmml">1</mn><mo lspace="0.278em" rspace="0.278em" id="A10.E52.m1.6.6.1.1.1.1.1.1.1.1.2.2.2.2.3.1" xref="A10.E52.m1.6.6.1.1.1.1.1.1.1.1.2.2.2.2.3.1.cmml">:</mo><mi id="A10.E52.m1.6.6.1.1.1.1.1.1.1.1.2.2.2.2.3.3" xref="A10.E52.m1.6.6.1.1.1.1.1.1.1.1.2.2.2.2.3.3.cmml">K</mi></mrow></msub><mo id="A10.E52.m1.6.6.1.1.1.1.1.1.1.1.2.2.2.4" xref="A10.E52.m1.6.6.1.1.1.1.1.1.1.1.2.2.3.cmml">,</mo><mi id="A10.E52.m1.5.5" xref="A10.E52.m1.5.5.cmml">λ</mi></mrow></mrow></mrow><mo stretchy="false" id="A10.E52.m1.6.6.1.1.1.1.1.1.1.3" xref="A10.E52.m1.6.6.1.1.1.1.1.1.1.1.cmml">)</mo></mrow><mo lspace="0em" rspace="0em" id="A10.E52.m1.6.6.1.1.2.2.2.3a" xref="A10.E52.m1.6.6.1.1.2.2.2.3.cmml">​</mo><mrow id="A10.E52.m1.6.6.1.1.2.2.2.2.1" xref="A10.E52.m1.6.6.1.1.2.2.2.2.1.1.cmml"><mo stretchy="false" id="A10.E52.m1.6.6.1.1.2.2.2.2.1.2" xref="A10.E52.m1.6.6.1.1.2.2.2.2.1.1.cmml">(</mo><mrow id="A10.E52.m1.6.6.1.1.2.2.2.2.1.1" xref="A10.E52.m1.6.6.1.1.2.2.2.2.1.1.cmml"><msub id="A10.E52.m1.6.6.1.1.2.2.2.2.1.1.2" xref="A10.E52.m1.6.6.1.1.2.2.2.2.1.1.2.cmml"><mi id="A10.E52.m1.6.6.1.1.2.2.2.2.1.1.2.2" xref="A10.E52.m1.6.6.1.1.2.2.2.2.1.1.2.2.cmml">𝐰</mi><mi id="A10.E52.m1.6.6.1.1.2.2.2.2.1.1.2.3" xref="A10.E52.m1.6.6.1.1.2.2.2.2.1.1.2.3.cmml">s</mi></msub><mo id="A10.E52.m1.6.6.1.1.2.2.2.2.1.1.1" xref="A10.E52.m1.6.6.1.1.2.2.2.2.1.1.1.cmml">−</mo><msub id="A10.E52.m1.6.6.1.1.2.2.2.2.1.1.3" xref="A10.E52.m1.6.6.1.1.2.2.2.2.1.1.3.cmml"><mi id="A10.E52.m1.6.6.1.1.2.2.2.2.1.1.3.2" xref="A10.E52.m1.6.6.1.1.2.2.2.2.1.1.3.2.cmml">𝐰</mi><mi id="A10.E52.m1.6.6.1.1.2.2.2.2.1.1.3.3" xref="A10.E52.m1.6.6.1.1.2.2.2.2.1.1.3.3.cmml">k</mi></msub></mrow><mo stretchy="false" id="A10.E52.m1.6.6.1.1.2.2.2.2.1.3" xref="A10.E52.m1.6.6.1.1.2.2.2.2.1.1.cmml">)</mo></mrow></mrow></mrow></mrow><mo stretchy="false" id="A10.E52.m1.6.6.1.1.8" xref="A10.E52.m1.6.6.1.1.8.cmml">⇒</mo><msub id="A10.E52.m1.6.6.1.1.9" xref="A10.E52.m1.6.6.1.1.9.cmml"><mi id="A10.E52.m1.6.6.1.1.9.2" xref="A10.E52.m1.6.6.1.1.9.2.cmml">𝐰</mi><mi id="A10.E52.m1.6.6.1.1.9.3" xref="A10.E52.m1.6.6.1.1.9.3.cmml">k</mi></msub><mo id="A10.E52.m1.6.6.1.1.10" xref="A10.E52.m1.6.6.1.1.10.cmml">=</mo><mrow id="A10.E52.m1.6.6.1.1.11" xref="A10.E52.m1.6.6.1.1.11.cmml"><mstyle displaystyle="true" id="A10.E52.m1.6.6.1.1.11.1" xref="A10.E52.m1.6.6.1.1.11.1.cmml"><munder id="A10.E52.m1.6.6.1.1.11.1a" xref="A10.E52.m1.6.6.1.1.11.1.cmml"><mo movablelimits="false" id="A10.E52.m1.6.6.1.1.11.1.2" xref="A10.E52.m1.6.6.1.1.11.1.2.cmml">∑</mo><mi id="A10.E52.m1.6.6.1.1.11.1.3" xref="A10.E52.m1.6.6.1.1.11.1.3.cmml">s</mi></munder></mstyle><mrow id="A10.E52.m1.6.6.1.1.11.2" xref="A10.E52.m1.6.6.1.1.11.2.cmml"><mstyle displaystyle="true" id="A10.E52.m1.4.4" xref="A10.E52.m1.4.4.cmml"><mfrac id="A10.E52.m1.4.4a" xref="A10.E52.m1.4.4.cmml"><mrow id="A10.E52.m1.2.2.2" xref="A10.E52.m1.2.2.2.cmml"><mi id="A10.E52.m1.2.2.2.4" xref="A10.E52.m1.2.2.2.4.cmml">p</mi><mo lspace="0em" rspace="0em" id="A10.E52.m1.2.2.2.3" xref="A10.E52.m1.2.2.2.3.cmml">​</mo><mrow id="A10.E52.m1.2.2.2.2.1" xref="A10.E52.m1.2.2.2.2.1.1.cmml"><mo stretchy="false" id="A10.E52.m1.2.2.2.2.1.2" xref="A10.E52.m1.2.2.2.2.1.1.cmml">(</mo><mrow id="A10.E52.m1.2.2.2.2.1.1" xref="A10.E52.m1.2.2.2.2.1.1.cmml"><mi id="A10.E52.m1.2.2.2.2.1.1.4" xref="A10.E52.m1.2.2.2.2.1.1.4.cmml">z</mi><mo id="A10.E52.m1.2.2.2.2.1.1.3" xref="A10.E52.m1.2.2.2.2.1.1.3.cmml">=</mo><mrow id="A10.E52.m1.2.2.2.2.1.1.2" xref="A10.E52.m1.2.2.2.2.1.1.2.cmml"><mi id="A10.E52.m1.2.2.2.2.1.1.2.4" xref="A10.E52.m1.2.2.2.2.1.1.2.4.cmml">k</mi><mo fence="false" id="A10.E52.m1.2.2.2.2.1.1.2.3" xref="A10.E52.m1.2.2.2.2.1.1.2.3.cmml">|</mo><mrow id="A10.E52.m1.2.2.2.2.1.1.2.2.2" xref="A10.E52.m1.2.2.2.2.1.1.2.2.3.cmml"><msub id="A10.E52.m1.2.2.2.2.1.1.1.1.1.1" xref="A10.E52.m1.2.2.2.2.1.1.1.1.1.1.cmml"><mi id="A10.E52.m1.2.2.2.2.1.1.1.1.1.1.2" xref="A10.E52.m1.2.2.2.2.1.1.1.1.1.1.2.cmml">𝐰</mi><mi id="A10.E52.m1.2.2.2.2.1.1.1.1.1.1.3" xref="A10.E52.m1.2.2.2.2.1.1.1.1.1.1.3.cmml">s</mi></msub><mo id="A10.E52.m1.2.2.2.2.1.1.2.2.2.3" xref="A10.E52.m1.2.2.2.2.1.1.2.2.3.cmml">,</mo><msub id="A10.E52.m1.2.2.2.2.1.1.2.2.2.2" xref="A10.E52.m1.2.2.2.2.1.1.2.2.2.2.cmml"><mi id="A10.E52.m1.2.2.2.2.1.1.2.2.2.2.2" xref="A10.E52.m1.2.2.2.2.1.1.2.2.2.2.2.cmml">𝐰</mi><mrow id="A10.E52.m1.2.2.2.2.1.1.2.2.2.2.3" xref="A10.E52.m1.2.2.2.2.1.1.2.2.2.2.3.cmml"><mn id="A10.E52.m1.2.2.2.2.1.1.2.2.2.2.3.2" xref="A10.E52.m1.2.2.2.2.1.1.2.2.2.2.3.2.cmml">1</mn><mo lspace="0.278em" rspace="0.278em" id="A10.E52.m1.2.2.2.2.1.1.2.2.2.2.3.1" xref="A10.E52.m1.2.2.2.2.1.1.2.2.2.2.3.1.cmml">:</mo><mi id="A10.E52.m1.2.2.2.2.1.1.2.2.2.2.3.3" xref="A10.E52.m1.2.2.2.2.1.1.2.2.2.2.3.3.cmml">K</mi></mrow></msub><mo id="A10.E52.m1.2.2.2.2.1.1.2.2.2.4" xref="A10.E52.m1.2.2.2.2.1.1.2.2.3.cmml">,</mo><mi id="A10.E52.m1.1.1.1.1" xref="A10.E52.m1.1.1.1.1.cmml">λ</mi></mrow></mrow></mrow><mo stretchy="false" id="A10.E52.m1.2.2.2.2.1.3" xref="A10.E52.m1.2.2.2.2.1.1.cmml">)</mo></mrow></mrow><mrow id="A10.E52.m1.4.4.4" xref="A10.E52.m1.4.4.4.cmml"><msub id="A10.E52.m1.4.4.4.3" xref="A10.E52.m1.4.4.4.3.cmml"><mo id="A10.E52.m1.4.4.4.3.2" xref="A10.E52.m1.4.4.4.3.2.cmml">∑</mo><mi id="A10.E52.m1.4.4.4.3.3" xref="A10.E52.m1.4.4.4.3.3.cmml">j</mi></msub><mrow id="A10.E52.m1.4.4.4.2" xref="A10.E52.m1.4.4.4.2.cmml"><mi id="A10.E52.m1.4.4.4.2.3" xref="A10.E52.m1.4.4.4.2.3.cmml">p</mi><mo lspace="0em" rspace="0em" id="A10.E52.m1.4.4.4.2.2" xref="A10.E52.m1.4.4.4.2.2.cmml">​</mo><mrow id="A10.E52.m1.4.4.4.2.1.1" xref="A10.E52.m1.4.4.4.2.1.1.1.cmml"><mo stretchy="false" id="A10.E52.m1.4.4.4.2.1.1.2" xref="A10.E52.m1.4.4.4.2.1.1.1.cmml">(</mo><mrow id="A10.E52.m1.4.4.4.2.1.1.1" xref="A10.E52.m1.4.4.4.2.1.1.1.cmml"><mi id="A10.E52.m1.4.4.4.2.1.1.1.4" xref="A10.E52.m1.4.4.4.2.1.1.1.4.cmml">z</mi><mo id="A10.E52.m1.4.4.4.2.1.1.1.3" xref="A10.E52.m1.4.4.4.2.1.1.1.3.cmml">=</mo><mrow id="A10.E52.m1.4.4.4.2.1.1.1.2" xref="A10.E52.m1.4.4.4.2.1.1.1.2.cmml"><mi id="A10.E52.m1.4.4.4.2.1.1.1.2.4" xref="A10.E52.m1.4.4.4.2.1.1.1.2.4.cmml">k</mi><mo fence="false" id="A10.E52.m1.4.4.4.2.1.1.1.2.3" xref="A10.E52.m1.4.4.4.2.1.1.1.2.3.cmml">|</mo><mrow id="A10.E52.m1.4.4.4.2.1.1.1.2.2.2" xref="A10.E52.m1.4.4.4.2.1.1.1.2.2.3.cmml"><msub id="A10.E52.m1.4.4.4.2.1.1.1.1.1.1.1" xref="A10.E52.m1.4.4.4.2.1.1.1.1.1.1.1.cmml"><mi id="A10.E52.m1.4.4.4.2.1.1.1.1.1.1.1.2" xref="A10.E52.m1.4.4.4.2.1.1.1.1.1.1.1.2.cmml">𝐰</mi><mi id="A10.E52.m1.4.4.4.2.1.1.1.1.1.1.1.3" xref="A10.E52.m1.4.4.4.2.1.1.1.1.1.1.1.3.cmml">j</mi></msub><mo id="A10.E52.m1.4.4.4.2.1.1.1.2.2.2.3" xref="A10.E52.m1.4.4.4.2.1.1.1.2.2.3.cmml">,</mo><msub id="A10.E52.m1.4.4.4.2.1.1.1.2.2.2.2" xref="A10.E52.m1.4.4.4.2.1.1.1.2.2.2.2.cmml"><mi id="A10.E52.m1.4.4.4.2.1.1.1.2.2.2.2.2" xref="A10.E52.m1.4.4.4.2.1.1.1.2.2.2.2.2.cmml">𝐰</mi><mrow id="A10.E52.m1.4.4.4.2.1.1.1.2.2.2.2.3" xref="A10.E52.m1.4.4.4.2.1.1.1.2.2.2.2.3.cmml"><mn id="A10.E52.m1.4.4.4.2.1.1.1.2.2.2.2.3.2" xref="A10.E52.m1.4.4.4.2.1.1.1.2.2.2.2.3.2.cmml">1</mn><mo lspace="0.278em" rspace="0.278em" id="A10.E52.m1.4.4.4.2.1.1.1.2.2.2.2.3.1" xref="A10.E52.m1.4.4.4.2.1.1.1.2.2.2.2.3.1.cmml">:</mo><mi id="A10.E52.m1.4.4.4.2.1.1.1.2.2.2.2.3.3" xref="A10.E52.m1.4.4.4.2.1.1.1.2.2.2.2.3.3.cmml">K</mi></mrow></msub><mo id="A10.E52.m1.4.4.4.2.1.1.1.2.2.2.4" xref="A10.E52.m1.4.4.4.2.1.1.1.2.2.3.cmml">,</mo><mi id="A10.E52.m1.3.3.3.1" xref="A10.E52.m1.3.3.3.1.cmml">λ</mi></mrow></mrow></mrow><mo stretchy="false" id="A10.E52.m1.4.4.4.2.1.1.3" xref="A10.E52.m1.4.4.4.2.1.1.1.cmml">)</mo></mrow></mrow></mrow></mfrac></mstyle><mo lspace="0em" rspace="0em" id="A10.E52.m1.6.6.1.1.11.2.1" xref="A10.E52.m1.6.6.1.1.11.2.1.cmml">​</mo><msub id="A10.E52.m1.6.6.1.1.11.2.2" xref="A10.E52.m1.6.6.1.1.11.2.2.cmml"><mi id="A10.E52.m1.6.6.1.1.11.2.2.2" xref="A10.E52.m1.6.6.1.1.11.2.2.2.cmml">𝐰</mi><mi id="A10.E52.m1.6.6.1.1.11.2.2.3" xref="A10.E52.m1.6.6.1.1.11.2.2.3.cmml">s</mi></msub></mrow></mrow></mrow><mo id="A10.E52.m1.6.6.1.2" xref="A10.E52.m1.6.6.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="A10.E52.m1.6b"><apply id="A10.E52.m1.6.6.1.1.cmml" xref="A10.E52.m1.6.6.1"><and id="A10.E52.m1.6.6.1.1a.cmml" xref="A10.E52.m1.6.6.1"></and><apply id="A10.E52.m1.6.6.1.1b.cmml" xref="A10.E52.m1.6.6.1"><eq id="A10.E52.m1.6.6.1.1.5.cmml" xref="A10.E52.m1.6.6.1.1.5"></eq><apply id="A10.E52.m1.6.6.1.1.4.cmml" xref="A10.E52.m1.6.6.1.1.4"><divide id="A10.E52.m1.6.6.1.1.4.1.cmml" xref="A10.E52.m1.6.6.1.1.4"></divide><apply id="A10.E52.m1.6.6.1.1.4.2.cmml" xref="A10.E52.m1.6.6.1.1.4.2"><partialdiff id="A10.E52.m1.6.6.1.1.4.2.1.cmml" xref="A10.E52.m1.6.6.1.1.4.2.1"></partialdiff><ci id="A10.E52.m1.6.6.1.1.4.2.2.cmml" xref="A10.E52.m1.6.6.1.1.4.2.2">𝐿</ci></apply><apply id="A10.E52.m1.6.6.1.1.4.3.cmml" xref="A10.E52.m1.6.6.1.1.4.3"><partialdiff id="A10.E52.m1.6.6.1.1.4.3.1.cmml" xref="A10.E52.m1.6.6.1.1.4.3.1"></partialdiff><apply id="A10.E52.m1.6.6.1.1.4.3.2.cmml" xref="A10.E52.m1.6.6.1.1.4.3.2"><csymbol cd="ambiguous" id="A10.E52.m1.6.6.1.1.4.3.2.1.cmml" xref="A10.E52.m1.6.6.1.1.4.3.2">subscript</csymbol><ci id="A10.E52.m1.6.6.1.1.4.3.2.2.cmml" xref="A10.E52.m1.6.6.1.1.4.3.2.2">𝐰</ci><ci id="A10.E52.m1.6.6.1.1.4.3.2.3.cmml" xref="A10.E52.m1.6.6.1.1.4.3.2.3">𝑘</ci></apply></apply></apply><cn type="integer" id="A10.E52.m1.6.6.1.1.6.cmml" xref="A10.E52.m1.6.6.1.1.6">0</cn></apply><apply id="A10.E52.m1.6.6.1.1c.cmml" xref="A10.E52.m1.6.6.1"><ci id="A10.E52.m1.6.6.1.1.7.cmml" xref="A10.E52.m1.6.6.1.1.7">⇒</ci><share href="#A10.E52.m1.6.6.1.1.6.cmml" id="A10.E52.m1.6.6.1.1d.cmml" xref="A10.E52.m1.6.6.1"></share><apply id="A10.E52.m1.6.6.1.1.2.cmml" xref="A10.E52.m1.6.6.1.1.2"><times id="A10.E52.m1.6.6.1.1.2.3.cmml" xref="A10.E52.m1.6.6.1.1.2.3"></times><ci id="A10.E52.m1.6.6.1.1.2.4.cmml" xref="A10.E52.m1.6.6.1.1.2.4">𝜆</ci><apply id="A10.E52.m1.6.6.1.1.2.2.cmml" xref="A10.E52.m1.6.6.1.1.2.2"><apply id="A10.E52.m1.6.6.1.1.2.2.3.cmml" xref="A10.E52.m1.6.6.1.1.2.2.3"><csymbol cd="ambiguous" id="A10.E52.m1.6.6.1.1.2.2.3.1.cmml" xref="A10.E52.m1.6.6.1.1.2.2.3">subscript</csymbol><sum id="A10.E52.m1.6.6.1.1.2.2.3.2.cmml" xref="A10.E52.m1.6.6.1.1.2.2.3.2"></sum><ci id="A10.E52.m1.6.6.1.1.2.2.3.3.cmml" xref="A10.E52.m1.6.6.1.1.2.2.3.3">𝑠</ci></apply><apply id="A10.E52.m1.6.6.1.1.2.2.2.cmml" xref="A10.E52.m1.6.6.1.1.2.2.2"><times id="A10.E52.m1.6.6.1.1.2.2.2.3.cmml" xref="A10.E52.m1.6.6.1.1.2.2.2.3"></times><ci id="A10.E52.m1.6.6.1.1.2.2.2.4.cmml" xref="A10.E52.m1.6.6.1.1.2.2.2.4">𝑝</ci><apply id="A10.E52.m1.6.6.1.1.1.1.1.1.1.1.cmml" xref="A10.E52.m1.6.6.1.1.1.1.1.1.1"><eq id="A10.E52.m1.6.6.1.1.1.1.1.1.1.1.3.cmml" xref="A10.E52.m1.6.6.1.1.1.1.1.1.1.1.3"></eq><ci id="A10.E52.m1.6.6.1.1.1.1.1.1.1.1.4.cmml" xref="A10.E52.m1.6.6.1.1.1.1.1.1.1.1.4">𝑧</ci><apply id="A10.E52.m1.6.6.1.1.1.1.1.1.1.1.2.cmml" xref="A10.E52.m1.6.6.1.1.1.1.1.1.1.1.2"><csymbol cd="latexml" id="A10.E52.m1.6.6.1.1.1.1.1.1.1.1.2.3.cmml" xref="A10.E52.m1.6.6.1.1.1.1.1.1.1.1.2.3">conditional</csymbol><ci id="A10.E52.m1.6.6.1.1.1.1.1.1.1.1.2.4.cmml" xref="A10.E52.m1.6.6.1.1.1.1.1.1.1.1.2.4">𝑘</ci><list id="A10.E52.m1.6.6.1.1.1.1.1.1.1.1.2.2.3.cmml" xref="A10.E52.m1.6.6.1.1.1.1.1.1.1.1.2.2.2"><apply id="A10.E52.m1.6.6.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="A10.E52.m1.6.6.1.1.1.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="A10.E52.m1.6.6.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="A10.E52.m1.6.6.1.1.1.1.1.1.1.1.1.1.1.1">subscript</csymbol><ci id="A10.E52.m1.6.6.1.1.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="A10.E52.m1.6.6.1.1.1.1.1.1.1.1.1.1.1.1.2">𝐰</ci><ci id="A10.E52.m1.6.6.1.1.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="A10.E52.m1.6.6.1.1.1.1.1.1.1.1.1.1.1.1.3">𝑠</ci></apply><apply id="A10.E52.m1.6.6.1.1.1.1.1.1.1.1.2.2.2.2.cmml" xref="A10.E52.m1.6.6.1.1.1.1.1.1.1.1.2.2.2.2"><csymbol cd="ambiguous" id="A10.E52.m1.6.6.1.1.1.1.1.1.1.1.2.2.2.2.1.cmml" xref="A10.E52.m1.6.6.1.1.1.1.1.1.1.1.2.2.2.2">subscript</csymbol><ci id="A10.E52.m1.6.6.1.1.1.1.1.1.1.1.2.2.2.2.2.cmml" xref="A10.E52.m1.6.6.1.1.1.1.1.1.1.1.2.2.2.2.2">𝐰</ci><apply id="A10.E52.m1.6.6.1.1.1.1.1.1.1.1.2.2.2.2.3.cmml" xref="A10.E52.m1.6.6.1.1.1.1.1.1.1.1.2.2.2.2.3"><ci id="A10.E52.m1.6.6.1.1.1.1.1.1.1.1.2.2.2.2.3.1.cmml" xref="A10.E52.m1.6.6.1.1.1.1.1.1.1.1.2.2.2.2.3.1">:</ci><cn type="integer" id="A10.E52.m1.6.6.1.1.1.1.1.1.1.1.2.2.2.2.3.2.cmml" xref="A10.E52.m1.6.6.1.1.1.1.1.1.1.1.2.2.2.2.3.2">1</cn><ci id="A10.E52.m1.6.6.1.1.1.1.1.1.1.1.2.2.2.2.3.3.cmml" xref="A10.E52.m1.6.6.1.1.1.1.1.1.1.1.2.2.2.2.3.3">𝐾</ci></apply></apply><ci id="A10.E52.m1.5.5.cmml" xref="A10.E52.m1.5.5">𝜆</ci></list></apply></apply><apply id="A10.E52.m1.6.6.1.1.2.2.2.2.1.1.cmml" xref="A10.E52.m1.6.6.1.1.2.2.2.2.1"><minus id="A10.E52.m1.6.6.1.1.2.2.2.2.1.1.1.cmml" xref="A10.E52.m1.6.6.1.1.2.2.2.2.1.1.1"></minus><apply id="A10.E52.m1.6.6.1.1.2.2.2.2.1.1.2.cmml" xref="A10.E52.m1.6.6.1.1.2.2.2.2.1.1.2"><csymbol cd="ambiguous" id="A10.E52.m1.6.6.1.1.2.2.2.2.1.1.2.1.cmml" xref="A10.E52.m1.6.6.1.1.2.2.2.2.1.1.2">subscript</csymbol><ci id="A10.E52.m1.6.6.1.1.2.2.2.2.1.1.2.2.cmml" xref="A10.E52.m1.6.6.1.1.2.2.2.2.1.1.2.2">𝐰</ci><ci id="A10.E52.m1.6.6.1.1.2.2.2.2.1.1.2.3.cmml" xref="A10.E52.m1.6.6.1.1.2.2.2.2.1.1.2.3">𝑠</ci></apply><apply id="A10.E52.m1.6.6.1.1.2.2.2.2.1.1.3.cmml" xref="A10.E52.m1.6.6.1.1.2.2.2.2.1.1.3"><csymbol cd="ambiguous" id="A10.E52.m1.6.6.1.1.2.2.2.2.1.1.3.1.cmml" xref="A10.E52.m1.6.6.1.1.2.2.2.2.1.1.3">subscript</csymbol><ci id="A10.E52.m1.6.6.1.1.2.2.2.2.1.1.3.2.cmml" xref="A10.E52.m1.6.6.1.1.2.2.2.2.1.1.3.2">𝐰</ci><ci id="A10.E52.m1.6.6.1.1.2.2.2.2.1.1.3.3.cmml" xref="A10.E52.m1.6.6.1.1.2.2.2.2.1.1.3.3">𝑘</ci></apply></apply></apply></apply></apply></apply><apply id="A10.E52.m1.6.6.1.1e.cmml" xref="A10.E52.m1.6.6.1"><ci id="A10.E52.m1.6.6.1.1.8.cmml" xref="A10.E52.m1.6.6.1.1.8">⇒</ci><share href="#A10.E52.m1.6.6.1.1.2.cmml" id="A10.E52.m1.6.6.1.1f.cmml" xref="A10.E52.m1.6.6.1"></share><apply id="A10.E52.m1.6.6.1.1.9.cmml" xref="A10.E52.m1.6.6.1.1.9"><csymbol cd="ambiguous" id="A10.E52.m1.6.6.1.1.9.1.cmml" xref="A10.E52.m1.6.6.1.1.9">subscript</csymbol><ci id="A10.E52.m1.6.6.1.1.9.2.cmml" xref="A10.E52.m1.6.6.1.1.9.2">𝐰</ci><ci id="A10.E52.m1.6.6.1.1.9.3.cmml" xref="A10.E52.m1.6.6.1.1.9.3">𝑘</ci></apply></apply><apply id="A10.E52.m1.6.6.1.1g.cmml" xref="A10.E52.m1.6.6.1"><eq id="A10.E52.m1.6.6.1.1.10.cmml" xref="A10.E52.m1.6.6.1.1.10"></eq><share href="#A10.E52.m1.6.6.1.1.9.cmml" id="A10.E52.m1.6.6.1.1h.cmml" xref="A10.E52.m1.6.6.1"></share><apply id="A10.E52.m1.6.6.1.1.11.cmml" xref="A10.E52.m1.6.6.1.1.11"><apply id="A10.E52.m1.6.6.1.1.11.1.cmml" xref="A10.E52.m1.6.6.1.1.11.1"><csymbol cd="ambiguous" id="A10.E52.m1.6.6.1.1.11.1.1.cmml" xref="A10.E52.m1.6.6.1.1.11.1">subscript</csymbol><sum id="A10.E52.m1.6.6.1.1.11.1.2.cmml" xref="A10.E52.m1.6.6.1.1.11.1.2"></sum><ci id="A10.E52.m1.6.6.1.1.11.1.3.cmml" xref="A10.E52.m1.6.6.1.1.11.1.3">𝑠</ci></apply><apply id="A10.E52.m1.6.6.1.1.11.2.cmml" xref="A10.E52.m1.6.6.1.1.11.2"><times id="A10.E52.m1.6.6.1.1.11.2.1.cmml" xref="A10.E52.m1.6.6.1.1.11.2.1"></times><apply id="A10.E52.m1.4.4.cmml" xref="A10.E52.m1.4.4"><divide id="A10.E52.m1.4.4.5.cmml" xref="A10.E52.m1.4.4"></divide><apply id="A10.E52.m1.2.2.2.cmml" xref="A10.E52.m1.2.2.2"><times id="A10.E52.m1.2.2.2.3.cmml" xref="A10.E52.m1.2.2.2.3"></times><ci id="A10.E52.m1.2.2.2.4.cmml" xref="A10.E52.m1.2.2.2.4">𝑝</ci><apply id="A10.E52.m1.2.2.2.2.1.1.cmml" xref="A10.E52.m1.2.2.2.2.1"><eq id="A10.E52.m1.2.2.2.2.1.1.3.cmml" xref="A10.E52.m1.2.2.2.2.1.1.3"></eq><ci id="A10.E52.m1.2.2.2.2.1.1.4.cmml" xref="A10.E52.m1.2.2.2.2.1.1.4">𝑧</ci><apply id="A10.E52.m1.2.2.2.2.1.1.2.cmml" xref="A10.E52.m1.2.2.2.2.1.1.2"><csymbol cd="latexml" id="A10.E52.m1.2.2.2.2.1.1.2.3.cmml" xref="A10.E52.m1.2.2.2.2.1.1.2.3">conditional</csymbol><ci id="A10.E52.m1.2.2.2.2.1.1.2.4.cmml" xref="A10.E52.m1.2.2.2.2.1.1.2.4">𝑘</ci><list id="A10.E52.m1.2.2.2.2.1.1.2.2.3.cmml" xref="A10.E52.m1.2.2.2.2.1.1.2.2.2"><apply id="A10.E52.m1.2.2.2.2.1.1.1.1.1.1.cmml" xref="A10.E52.m1.2.2.2.2.1.1.1.1.1.1"><csymbol cd="ambiguous" id="A10.E52.m1.2.2.2.2.1.1.1.1.1.1.1.cmml" xref="A10.E52.m1.2.2.2.2.1.1.1.1.1.1">subscript</csymbol><ci id="A10.E52.m1.2.2.2.2.1.1.1.1.1.1.2.cmml" xref="A10.E52.m1.2.2.2.2.1.1.1.1.1.1.2">𝐰</ci><ci id="A10.E52.m1.2.2.2.2.1.1.1.1.1.1.3.cmml" xref="A10.E52.m1.2.2.2.2.1.1.1.1.1.1.3">𝑠</ci></apply><apply id="A10.E52.m1.2.2.2.2.1.1.2.2.2.2.cmml" xref="A10.E52.m1.2.2.2.2.1.1.2.2.2.2"><csymbol cd="ambiguous" id="A10.E52.m1.2.2.2.2.1.1.2.2.2.2.1.cmml" xref="A10.E52.m1.2.2.2.2.1.1.2.2.2.2">subscript</csymbol><ci id="A10.E52.m1.2.2.2.2.1.1.2.2.2.2.2.cmml" xref="A10.E52.m1.2.2.2.2.1.1.2.2.2.2.2">𝐰</ci><apply id="A10.E52.m1.2.2.2.2.1.1.2.2.2.2.3.cmml" xref="A10.E52.m1.2.2.2.2.1.1.2.2.2.2.3"><ci id="A10.E52.m1.2.2.2.2.1.1.2.2.2.2.3.1.cmml" xref="A10.E52.m1.2.2.2.2.1.1.2.2.2.2.3.1">:</ci><cn type="integer" id="A10.E52.m1.2.2.2.2.1.1.2.2.2.2.3.2.cmml" xref="A10.E52.m1.2.2.2.2.1.1.2.2.2.2.3.2">1</cn><ci id="A10.E52.m1.2.2.2.2.1.1.2.2.2.2.3.3.cmml" xref="A10.E52.m1.2.2.2.2.1.1.2.2.2.2.3.3">𝐾</ci></apply></apply><ci id="A10.E52.m1.1.1.1.1.cmml" xref="A10.E52.m1.1.1.1.1">𝜆</ci></list></apply></apply></apply><apply id="A10.E52.m1.4.4.4.cmml" xref="A10.E52.m1.4.4.4"><apply id="A10.E52.m1.4.4.4.3.cmml" xref="A10.E52.m1.4.4.4.3"><csymbol cd="ambiguous" id="A10.E52.m1.4.4.4.3.1.cmml" xref="A10.E52.m1.4.4.4.3">subscript</csymbol><sum id="A10.E52.m1.4.4.4.3.2.cmml" xref="A10.E52.m1.4.4.4.3.2"></sum><ci id="A10.E52.m1.4.4.4.3.3.cmml" xref="A10.E52.m1.4.4.4.3.3">𝑗</ci></apply><apply id="A10.E52.m1.4.4.4.2.cmml" xref="A10.E52.m1.4.4.4.2"><times id="A10.E52.m1.4.4.4.2.2.cmml" xref="A10.E52.m1.4.4.4.2.2"></times><ci id="A10.E52.m1.4.4.4.2.3.cmml" xref="A10.E52.m1.4.4.4.2.3">𝑝</ci><apply id="A10.E52.m1.4.4.4.2.1.1.1.cmml" xref="A10.E52.m1.4.4.4.2.1.1"><eq id="A10.E52.m1.4.4.4.2.1.1.1.3.cmml" xref="A10.E52.m1.4.4.4.2.1.1.1.3"></eq><ci id="A10.E52.m1.4.4.4.2.1.1.1.4.cmml" xref="A10.E52.m1.4.4.4.2.1.1.1.4">𝑧</ci><apply id="A10.E52.m1.4.4.4.2.1.1.1.2.cmml" xref="A10.E52.m1.4.4.4.2.1.1.1.2"><csymbol cd="latexml" id="A10.E52.m1.4.4.4.2.1.1.1.2.3.cmml" xref="A10.E52.m1.4.4.4.2.1.1.1.2.3">conditional</csymbol><ci id="A10.E52.m1.4.4.4.2.1.1.1.2.4.cmml" xref="A10.E52.m1.4.4.4.2.1.1.1.2.4">𝑘</ci><list id="A10.E52.m1.4.4.4.2.1.1.1.2.2.3.cmml" xref="A10.E52.m1.4.4.4.2.1.1.1.2.2.2"><apply id="A10.E52.m1.4.4.4.2.1.1.1.1.1.1.1.cmml" xref="A10.E52.m1.4.4.4.2.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="A10.E52.m1.4.4.4.2.1.1.1.1.1.1.1.1.cmml" xref="A10.E52.m1.4.4.4.2.1.1.1.1.1.1.1">subscript</csymbol><ci id="A10.E52.m1.4.4.4.2.1.1.1.1.1.1.1.2.cmml" xref="A10.E52.m1.4.4.4.2.1.1.1.1.1.1.1.2">𝐰</ci><ci id="A10.E52.m1.4.4.4.2.1.1.1.1.1.1.1.3.cmml" xref="A10.E52.m1.4.4.4.2.1.1.1.1.1.1.1.3">𝑗</ci></apply><apply id="A10.E52.m1.4.4.4.2.1.1.1.2.2.2.2.cmml" xref="A10.E52.m1.4.4.4.2.1.1.1.2.2.2.2"><csymbol cd="ambiguous" id="A10.E52.m1.4.4.4.2.1.1.1.2.2.2.2.1.cmml" xref="A10.E52.m1.4.4.4.2.1.1.1.2.2.2.2">subscript</csymbol><ci id="A10.E52.m1.4.4.4.2.1.1.1.2.2.2.2.2.cmml" xref="A10.E52.m1.4.4.4.2.1.1.1.2.2.2.2.2">𝐰</ci><apply id="A10.E52.m1.4.4.4.2.1.1.1.2.2.2.2.3.cmml" xref="A10.E52.m1.4.4.4.2.1.1.1.2.2.2.2.3"><ci id="A10.E52.m1.4.4.4.2.1.1.1.2.2.2.2.3.1.cmml" xref="A10.E52.m1.4.4.4.2.1.1.1.2.2.2.2.3.1">:</ci><cn type="integer" id="A10.E52.m1.4.4.4.2.1.1.1.2.2.2.2.3.2.cmml" xref="A10.E52.m1.4.4.4.2.1.1.1.2.2.2.2.3.2">1</cn><ci id="A10.E52.m1.4.4.4.2.1.1.1.2.2.2.2.3.3.cmml" xref="A10.E52.m1.4.4.4.2.1.1.1.2.2.2.2.3.3">𝐾</ci></apply></apply><ci id="A10.E52.m1.3.3.3.1.cmml" xref="A10.E52.m1.3.3.3.1">𝜆</ci></list></apply></apply></apply></apply></apply><apply id="A10.E52.m1.6.6.1.1.11.2.2.cmml" xref="A10.E52.m1.6.6.1.1.11.2.2"><csymbol cd="ambiguous" id="A10.E52.m1.6.6.1.1.11.2.2.1.cmml" xref="A10.E52.m1.6.6.1.1.11.2.2">subscript</csymbol><ci id="A10.E52.m1.6.6.1.1.11.2.2.2.cmml" xref="A10.E52.m1.6.6.1.1.11.2.2.2">𝐰</ci><ci id="A10.E52.m1.6.6.1.1.11.2.2.3.cmml" xref="A10.E52.m1.6.6.1.1.11.2.2.3">𝑠</ci></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A10.E52.m1.6c">\displaystyle\frac{\partial L}{\partial\mathbf{w}_{k}}=0\Rightarrow\lambda\sum_{s}p(z=k|\mathbf{w}_{s},\mathbf{w}_{1:K},\lambda)(\mathbf{w}_{s}-\mathbf{w}_{k})\Rightarrow\mathbf{w}_{k}=\sum_{s}\frac{p(z=k|\mathbf{w}_{s},\mathbf{w}_{1:K},\lambda)}{\sum_{j}p(z=k|\mathbf{w}_{j},\mathbf{w}_{1:K},\lambda)}\mathbf{w}_{s},</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(52)</span></td>
</tr></tbody>
</table>
<p id="A10.SS2.p1.24" class="ltx_p">which is again similar to the closed form update for the centroids in a Gaussian mixture model when trained with EM.

</p>
<div class="ltx_pagination ltx_role_newpage"></div>
</div>
</section>
</section>
</article>
</div>
<div class="ar5iv-footer"><a href="/html/2111.10191" class="ar5iv-nav-button ar5iv-nav-button-prev">◄</a>
    <a class="ar5iv-home-button" href="/"><img height="40" alt="ar5iv homepage" src="/assets/ar5iv.png"></a>
    <a href="/feeling_lucky" class="ar5iv-text-button">Feeling<br>lucky?</a>
    <a href="/log/2111.10192" class="ar5iv-text-button ar5iv-severity-error">Conversion<br>report</a>
    <a class="ar5iv-text-button" target="_blank" href="https://github.com/dginev/ar5iv/issues/new?template=improve-article--arxiv-id-.md&title=Improve+article+2111.10192">Report<br>an issue</a>
    <a href="https://arxiv.org/abs/2111.10192" class="ar5iv-text-button arxiv-ui-theme">View&nbsp;original<br>on&nbsp;arXiv</a><a href="/html/2111.10193" class="ar5iv-nav-button ar5iv-nav-button-next">►</a>
</div><footer class="ltx_page_footer">
<a class="ar5iv-toggle-color-scheme" href="javascript:toggleColorScheme()" title="Toggle ar5iv color scheme"><span class="color-scheme-icon"></span></a>
<a class="ar5iv-footer-button" href="https://arxiv.org/help/license" target="_blank">Copyright</a>
<a class="ar5iv-footer-button" href="https://arxiv.org/help/policies/privacy_policy" target="_blank">Privacy Policy</a>

<div class="ltx_page_logo">Generated  on Sat Mar  2 05:39:48 2024 by <a target="_blank" href="http://dlmf.nist.gov/LaTeXML/" class="ltx_LaTeXML_logo"><span style="letter-spacing:-0.2em; margin-right:0.1em;">L<span class="ltx_font_smallcaps" style="position:relative; bottom:2.2pt;">a</span>T<span class="ltx_font_smallcaps" style="font-size:120%;position:relative; bottom:-0.2ex;">e</span></span><span style="font-size:90%; position:relative; bottom:-0.2ex;">XML</span><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAsAAAAOCAYAAAD5YeaVAAAAAXNSR0IArs4c6QAAAAZiS0dEAP8A/wD/oL2nkwAAAAlwSFlzAAALEwAACxMBAJqcGAAAAAd0SU1FB9wKExQZLWTEaOUAAAAddEVYdENvbW1lbnQAQ3JlYXRlZCB3aXRoIFRoZSBHSU1Q72QlbgAAAdpJREFUKM9tkL+L2nAARz9fPZNCKFapUn8kyI0e4iRHSR1Kb8ng0lJw6FYHFwv2LwhOpcWxTjeUunYqOmqd6hEoRDhtDWdA8ApRYsSUCDHNt5ul13vz4w0vWCgUnnEc975arX6ORqN3VqtVZbfbTQC4uEHANM3jSqXymFI6yWazP2KxWAXAL9zCUa1Wy2tXVxheKA9YNoR8Pt+aTqe4FVVVvz05O6MBhqUIBGk8Hn8HAOVy+T+XLJfLS4ZhTiRJgqIoVBRFIoric47jPnmeB1mW/9rr9ZpSSn3Lsmir1fJZlqWlUonKsvwWwD8ymc/nXwVBeLjf7xEKhdBut9Hr9WgmkyGEkJwsy5eHG5vN5g0AKIoCAEgkEkin0wQAfN9/cXPdheu6P33fBwB4ngcAcByHJpPJl+fn54mD3Gg0NrquXxeLRQAAwzAYj8cwTZPwPH9/sVg8PXweDAauqqr2cDjEer1GJBLBZDJBs9mE4zjwfZ85lAGg2+06hmGgXq+j3+/DsixYlgVN03a9Xu8jgCNCyIegIAgx13Vfd7vdu+FweG8YRkjXdWy329+dTgeSJD3ieZ7RNO0VAXAPwDEAO5VKndi2fWrb9jWl9Esul6PZbDY9Go1OZ7PZ9z/lyuD3OozU2wAAAABJRU5ErkJggg==" alt="Mascot Sammy"></a>
</div></footer>
</div>

    <script>
      var canMathML = typeof(MathMLElement) == "function";
      if (!canMathML) {
        var body = document.querySelector("body");
        body.firstElementChild.setAttribute('style', 'opacity: 0;');
        var loading = document.createElement("div");
        loading.setAttribute("id", "mathjax-loading-spinner");
        var message = document.createElement("div");
        message.setAttribute("id", "mathjax-loading-message");
        message.innerText = "Typesetting Equations...";
        body.prepend(loading);
        body.prepend(message);

        var el = document.createElement("script");
        el.src = "https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js";
        document.querySelector("head").appendChild(el);

        window.MathJax = {
          startup: {
            pageReady: () => {
              return MathJax.startup.defaultPageReady().then(() => {
                body.removeChild(loading);
                body.removeChild(message);
                body.firstElementChild.removeAttribute('style');
              }); } } };
      }
    </script>
    <script>
    // Auxiliary function, building the preview feature when
    // an inline citation is clicked
    function clicked_cite(e) {
      e.preventDefault();
      let cite = this.closest('.ltx_cite');
      let next = cite.nextSibling;
      if (next && next.nodeType == Node.ELEMENT_NODE && next.getAttribute('class') == "ar5iv-bibitem-preview") {
        next.remove();
        return; }
      // Before adding a preview modal,
      // cleanup older previews, in case they're still open
      document.querySelectorAll('span.ar5iv-bibitem-preview').forEach(function(node) {
        node.remove();
      })

      // Create the preview
      preview = document.createElement('span');
      preview.setAttribute('class','ar5iv-bibitem-preview');
      let target = document.getElementById(this.getAttribute('href').slice(1));
      target.childNodes.forEach(function (child) {
        preview.append(child.cloneNode(true));
      });
      let close_x = document.createElement('button');
      close_x.setAttribute("aria-label","Close modal for bibliography item preview");
      close_x.textContent = "×";
      close_x.setAttribute('class', 'ar5iv-button-close-preview');
      close_x.setAttribute('onclick','this.parentNode.remove()');
      preview.append(close_x);
      preview.querySelectorAll('.ltx_tag_bibitem').forEach(function(node) {
        node.remove();
      });
      cite.parentNode.insertBefore(preview, cite.nextSibling);
      return;
    }
    // Global Document initialization:
    // - assign the preview feature to all inline citation links
    document.querySelectorAll(".ltx_cite .ltx_ref").forEach(function (link) {
      link.addEventListener("click", clicked_cite);
    });
    </script>
    </body>
</html>
