<!DOCTYPE html><html lang="en">
<head>
<meta http-equiv="content-type" content="text/html; charset=UTF-8">
<title>[2210.16142] Federated Learning for Chronic Obstructive Pulmonary Disease Classification with Partial Personalized Attention Mechanism *Corresponding Author. Email: chenweidao163@163.com.</title><meta property="og:description" content="Chronic Obstructive Pulmonary Disease (COPD) is the fourth leading cause of death worldwide. Yet, COPD diagnosis heavily relies on spirometric examination as well as functional airway limitation, which may cause a cons…">
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Federated Learning for Chronic Obstructive Pulmonary Disease Classification with Partial Personalized Attention Mechanism *Corresponding Author. Email: chenweidao163@163.com.">
<meta name="twitter:image:src" content="https://ar5iv.labs.arxiv.org/assets/ar5iv_card.png">
<meta name="twitter:image:alt" content="ar5iv logo">
<meta property="og:title" content="Federated Learning for Chronic Obstructive Pulmonary Disease Classification with Partial Personalized Attention Mechanism *Corresponding Author. Email: chenweidao163@163.com.">
<meta property="og:site_name" content="ar5iv">
<meta property="og:image" content="https://ar5iv.labs.arxiv.org/assets/ar5iv_card.png">
<meta property="og:type" content="article">
<meta property="og:url" content="https://ar5iv.labs.arxiv.org/html/2210.16142">

<!--Generated on Thu Mar 14 02:41:38 2024 by LaTeXML (version 0.8.8) http://dlmf.nist.gov/LaTeXML/.-->
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="keywords" lang="en" content="
Personalized federated learning,  Vision transformer,  Chronic obstructive pulmonary disease
">

<script>
  function detectColorScheme(){
    var theme="light";
    var current_theme = localStorage.getItem("ar5iv_theme");
    if(current_theme){
      if(current_theme == "dark"){
        theme = "dark";
      } }
    else if(!window.matchMedia) { return false; }
    else if(window.matchMedia("(prefers-color-scheme: dark)").matches) {
      theme = "dark"; }
    if (theme=="dark") {
      document.documentElement.setAttribute("data-theme", "dark");
    } else {
      document.documentElement.setAttribute("data-theme", "light"); } }

  detectColorScheme();

  function toggleColorScheme(){
    var current_theme = localStorage.getItem("ar5iv_theme");
    if (current_theme) {
      if (current_theme == "light") {
        localStorage.setItem("ar5iv_theme", "dark"); }
      else {
        localStorage.setItem("ar5iv_theme", "light"); } }
    else {
        localStorage.setItem("ar5iv_theme", "dark"); }
    detectColorScheme(); }
</script>
<link media="all" rel="stylesheet" href="/assets/ar5iv-fonts.0.8.0.min.css"><link media="all" rel="stylesheet" href="/assets/ar5iv.0.8.0.min.css"><link media="all" rel="stylesheet" href="/assets/ar5iv-site.0.2.2.css">
</head>
<body>
<div class="ltx_page_main">
<div class="ltx_page_content">
<article class="ltx_document ltx_authors_1line">
<h1 class="ltx_title ltx_title_document">
Federated Learning for Chronic Obstructive Pulmonary Disease Classification with Partial Personalized Attention Mechanism
<span id="id1.id1" class="ltx_note ltx_role_thanks"><sup class="ltx_note_mark">†</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">†</sup><span class="ltx_note_type">thanks: </span><sup id="id1.id1.1" class="ltx_sup">*</sup>Corresponding Author. Email: chenweidao163@163.com.</span></span></span>
</h1>
<div class="ltx_authors">
<span class="ltx_creator ltx_role_author">
<span class="ltx_personname">
Yiqing Shen<sup id="id2.1.id1" class="ltx_sup">1,2</sup>, Baiyun Liu<sup id="id3.2.id2" class="ltx_sup">2</sup>, Ruize Yu<sup id="id4.3.id3" class="ltx_sup">2</sup>, Yudong Wang<sup id="id5.4.id4" class="ltx_sup">2</sup>, Shaokang Wang<sup id="id6.5.id5" class="ltx_sup">2</sup>, Jiangfen Wu<sup id="id7.6.id6" class="ltx_sup">2</sup>, Weidao Chen<sup id="id8.7.id7" class="ltx_sup">2*</sup>
</span><span class="ltx_author_notes">
<span class="ltx_contact ltx_role_affiliation"><sup id="id9.8.id1" class="ltx_sup">1</sup>Johns Hopkins University, MD, USA
<sup id="id10.9.id2" class="ltx_sup">2</sup>Beijing Infervision Technology Co., Ltd., Beijing, China

</span></span></span>
</div>

<div class="ltx_abstract">
<h6 class="ltx_title ltx_title_abstract">Abstract</h6>
<p id="id11.id1" class="ltx_p">Chronic Obstructive Pulmonary Disease (COPD) is the fourth leading cause of death worldwide. Yet, COPD diagnosis heavily relies on spirometric examination as well as functional airway limitation, which may cause a considerable portion of COPD patients underdiagnosed especially at the early stage. Recent advance in deep learning (DL) has shown their promising potential in COPD identification from CT images. However, with heterogeneous syndromes and distinct phenotypes, DL models trained with CTs from one data center fail to generalize on images from another center. Due to privacy regularizations, a collaboration of distributed CT images into one centralized center is not feasible. Federated learning (FL) approaches enable us to train with distributed private data. Yet, routine FL solutions suffer from performance degradation in the case where COPD CTs are not independent and identically distributed (Non-IID). To address this issue, we propose a novel personalized federated learning (PFL) method based on vision transformer (ViT) for distributed and heterogeneous COPD CTs. To be more specific, we partially personalize some heads in multiheaded self-attention layers to learn the personalized attention for local data and retain the other heads shared to extract the common attention. To the best of our knowledge, this is the first proposal of a PFL framework specifically for ViT to identify COPD. Our evaluation of a dataset set curated from six medical centers shows our method outperforms the PFL approaches for convolutional neural networks.</p>
</div>
<div class="ltx_keywords">
<h6 class="ltx_title ltx_title_keywords">Index Terms: </h6>
Personalized federated learning, Vision transformer, Chronic obstructive pulmonary disease

</div>
<section id="S1" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">I </span><span id="S1.1.1" class="ltx_text ltx_font_smallcaps">Introduction</span>
</h2>

<div id="S1.p1" class="ltx_para">
<p id="S1.p1.1" class="ltx_p">Chronic Obstructive Pulmonary Disease (COPD) is a prevalent chronic pulmonary condition that remains a major cause of morbidity and mortality worldwide <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib7" title="" class="ltx_ref">7</a>, <a href="#bib.bib21" title="" class="ltx_ref">21</a>]</cite>. Present-day spirometric criteria often result in under-diagnosis and under-report in routine exams as COPD patients can be functional intact at their early state <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib19" title="" class="ltx_ref">19</a>]</cite>. Previous studies have demonstrated the successful application of deep learning (DL) models in the identification of COPD using computed tomography (CT) images as inputs, particularly the convolutional neural networks (CNNs) <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib8" title="" class="ltx_ref">8</a>, <a href="#bib.bib14" title="" class="ltx_ref">14</a>]</cite>. These models were mostly trained and validated on the large public database and the performance of which in the real-world testing varied depending on the patient source and distribution. Therefore, there is a clear need to generate a universally effective approach for COPD diagnosis in real clinical settings.</p>
</div>
<div id="S1.p2" class="ltx_para">
<p id="S1.p2.1" class="ltx_p">It is well recognized that COPD is a heterogeneous syndrome and adopts distinct phenotypes such as emphysema and airway loss, depending on the genetic variants and inflammatory subtypes <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib5" title="" class="ltx_ref">5</a>]</cite>. Thus, a rich source of data covering these phenotypes is critical for understanding the underlying mechanism of COPD heterogeneity. Yet, current privacy regulations <span id="S1.p2.1.1" class="ltx_text ltx_font_italic">e.g. <cite class="ltx_cite ltx_citemacro_cite"><span id="S1.p2.1.1.1.1" class="ltx_text ltx_font_upright">[</span><a href="#bib.bib1" title="" class="ltx_ref">1</a>, <a href="#bib.bib20" title="" class="ltx_ref">20</a><span id="S1.p2.1.1.2.2" class="ltx_text ltx_font_upright">]</span></cite></span> restrict a collaboration of the distributed data into a centralized center, because the availability of such confidential data is not permitted. To narrow this gap and mitigate the risk of privacy leakage, federated learning (FL) <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib15" title="" class="ltx_ref">15</a>]</cite>, as a machine learning paradigm, is proposed, where deep learning models are trained locally at the involved client without explicit data communication. Specifically, the clients can keep their data private, and only share weights and gradients for the model update. In this scenario, FL has already shown empirical success in various tasks of medical imaging <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib17" title="" class="ltx_ref">17</a>]</cite>, <span id="S1.p2.1.2" class="ltx_text ltx_font_italic">e.g. </span>COVID-19 CT detection <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib16" title="" class="ltx_ref">16</a>, <a href="#bib.bib23" title="" class="ltx_ref">23</a>]</cite>, histology tissue subtype classification <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib11" title="" class="ltx_ref">11</a>]</cite>.</p>
</div>
<div id="S1.p3" class="ltx_para">
<p id="S1.p3.1" class="ltx_p">Data heterogeneity in COPD CTs, characterized by varying geographical locations, patient distribution, image scanners, and diagnosis protocols, usually hinders the successful deployment of the FL model. Concretely, vanilla federate learning approaches are prone to suffer from performance degradation with non-IID (not independently and identically distributed) data, primarily caused by the weight divergence <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib24" title="" class="ltx_ref">24</a>]</cite>. Subsequently, personalized federated learning (PFL) is introduced to enable local models to learn local personalized weights <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib12" title="" class="ltx_ref">12</a>]</cite>, where the global shared model is personalized for each local client as an intermediate paradigm between pure local training and FL. Model weights personalization has received notable attention <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib2" title="" class="ltx_ref">2</a>, <a href="#bib.bib13" title="" class="ltx_ref">13</a>]</cite>. For example, <span id="S1.p3.1.1" class="ltx_text ltx_font_smallcaps">FedPer</span> decouples a neural network architecture into global base layers to be trained by <span id="S1.p3.1.2" class="ltx_text ltx_font_smallcaps">FedAvg</span>, and the top personalized layers to address the label distribution skew <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib10" title="" class="ltx_ref">10</a>]</cite>. <span id="S1.p3.1.3" class="ltx_text ltx_font_smallcaps">LG-FedAvg</span> is proposed by personalizing the bottom layer to tackle the feature distribution skew <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib13" title="" class="ltx_ref">13</a>]</cite>. Yet, these PFL approaches are primarily restricted to convolutional neural network (CNN) structures, without any specific design for Vision Transformer (ViT). In this paper, we first develop a PFL model for ViT <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib6" title="" class="ltx_ref">6</a>]</cite> because of its potential to tackle the heterogeneity in medical images <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib4" title="" class="ltx_ref">4</a>]</cite>. Innovatively, a partial personalization scheme is proposed for the Multiheaded Self-Attention (MSA) layers in ViT.</p>
</div>
<div id="S1.p4" class="ltx_para">
<p id="S1.p4.1" class="ltx_p">The major contributions are four-fold. First, we propose an FL model based on ViT for COPD CT image classification. Second, to address the data heterogeneity, a novel partial personalization for the multiheaded self-attention layer in ViT is developed. To the best of our knowledge, this is the first attempt at a PFL scheme for ViT. Third, to facilitate the PFL training, we propose a consistent regularization between the global shared and local private attention. Finally, experimental results on COPD data collected from multiple medical centers yield the effectiveness of our approach in comparison with the CNN-based PFL methods.</p>
</div>
<figure id="S1.F1" class="ltx_figure"><img src="/html/2210.16142/assets/x1.png" id="S1.F1.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="341" height="191" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 1: </span>The semantic illustration of partial personalization scheme for multiheaded self-attention layers in ViT. In MSA layers, we partially personalize some heads to learn the attentions for local personalized features, and the rest are remained shared globally to learn common attentions. The personalized weights reside locally, and the shared weights are aggregated globally.</figcaption>
</figure>
</section>
<section id="S2" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">II </span><span id="S2.1.1" class="ltx_text ltx_font_smallcaps">Methods</span>
</h2>

<div id="S2.p1" class="ltx_para">
<p id="S2.p1.1" class="ltx_p">In this section, we elaborate on the personalized federated multiple-instance learning framework based on ViT for COPD classification.</p>
</div>
<div id="S2.p2" class="ltx_para">
<p id="S2.p2.13" class="ltx_p"><span id="S2.p2.13.2" class="ltx_text ltx_font_bold">ViT Backbone.</span> We decompose the three dimensional CT volume input <math id="S2.p2.1.m1.3" class="ltx_Math" alttext="\mathbf{x}=[x_{1},\cdots,x_{n}]\in\mathbb{R}^{H\times W\times C}" display="inline"><semantics id="S2.p2.1.m1.3a"><mrow id="S2.p2.1.m1.3.3" xref="S2.p2.1.m1.3.3.cmml"><mi id="S2.p2.1.m1.3.3.4" xref="S2.p2.1.m1.3.3.4.cmml">𝐱</mi><mo id="S2.p2.1.m1.3.3.5" xref="S2.p2.1.m1.3.3.5.cmml">=</mo><mrow id="S2.p2.1.m1.3.3.2.2" xref="S2.p2.1.m1.3.3.2.3.cmml"><mo stretchy="false" id="S2.p2.1.m1.3.3.2.2.3" xref="S2.p2.1.m1.3.3.2.3.cmml">[</mo><msub id="S2.p2.1.m1.2.2.1.1.1" xref="S2.p2.1.m1.2.2.1.1.1.cmml"><mi id="S2.p2.1.m1.2.2.1.1.1.2" xref="S2.p2.1.m1.2.2.1.1.1.2.cmml">x</mi><mn id="S2.p2.1.m1.2.2.1.1.1.3" xref="S2.p2.1.m1.2.2.1.1.1.3.cmml">1</mn></msub><mo id="S2.p2.1.m1.3.3.2.2.4" xref="S2.p2.1.m1.3.3.2.3.cmml">,</mo><mi mathvariant="normal" id="S2.p2.1.m1.1.1" xref="S2.p2.1.m1.1.1.cmml">⋯</mi><mo id="S2.p2.1.m1.3.3.2.2.5" xref="S2.p2.1.m1.3.3.2.3.cmml">,</mo><msub id="S2.p2.1.m1.3.3.2.2.2" xref="S2.p2.1.m1.3.3.2.2.2.cmml"><mi id="S2.p2.1.m1.3.3.2.2.2.2" xref="S2.p2.1.m1.3.3.2.2.2.2.cmml">x</mi><mi id="S2.p2.1.m1.3.3.2.2.2.3" xref="S2.p2.1.m1.3.3.2.2.2.3.cmml">n</mi></msub><mo stretchy="false" id="S2.p2.1.m1.3.3.2.2.6" xref="S2.p2.1.m1.3.3.2.3.cmml">]</mo></mrow><mo id="S2.p2.1.m1.3.3.6" xref="S2.p2.1.m1.3.3.6.cmml">∈</mo><msup id="S2.p2.1.m1.3.3.7" xref="S2.p2.1.m1.3.3.7.cmml"><mi id="S2.p2.1.m1.3.3.7.2" xref="S2.p2.1.m1.3.3.7.2.cmml">ℝ</mi><mrow id="S2.p2.1.m1.3.3.7.3" xref="S2.p2.1.m1.3.3.7.3.cmml"><mi id="S2.p2.1.m1.3.3.7.3.2" xref="S2.p2.1.m1.3.3.7.3.2.cmml">H</mi><mo lspace="0.222em" rspace="0.222em" id="S2.p2.1.m1.3.3.7.3.1" xref="S2.p2.1.m1.3.3.7.3.1.cmml">×</mo><mi id="S2.p2.1.m1.3.3.7.3.3" xref="S2.p2.1.m1.3.3.7.3.3.cmml">W</mi><mo lspace="0.222em" rspace="0.222em" id="S2.p2.1.m1.3.3.7.3.1a" xref="S2.p2.1.m1.3.3.7.3.1.cmml">×</mo><mi id="S2.p2.1.m1.3.3.7.3.4" xref="S2.p2.1.m1.3.3.7.3.4.cmml">C</mi></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S2.p2.1.m1.3b"><apply id="S2.p2.1.m1.3.3.cmml" xref="S2.p2.1.m1.3.3"><and id="S2.p2.1.m1.3.3a.cmml" xref="S2.p2.1.m1.3.3"></and><apply id="S2.p2.1.m1.3.3b.cmml" xref="S2.p2.1.m1.3.3"><eq id="S2.p2.1.m1.3.3.5.cmml" xref="S2.p2.1.m1.3.3.5"></eq><ci id="S2.p2.1.m1.3.3.4.cmml" xref="S2.p2.1.m1.3.3.4">𝐱</ci><list id="S2.p2.1.m1.3.3.2.3.cmml" xref="S2.p2.1.m1.3.3.2.2"><apply id="S2.p2.1.m1.2.2.1.1.1.cmml" xref="S2.p2.1.m1.2.2.1.1.1"><csymbol cd="ambiguous" id="S2.p2.1.m1.2.2.1.1.1.1.cmml" xref="S2.p2.1.m1.2.2.1.1.1">subscript</csymbol><ci id="S2.p2.1.m1.2.2.1.1.1.2.cmml" xref="S2.p2.1.m1.2.2.1.1.1.2">𝑥</ci><cn type="integer" id="S2.p2.1.m1.2.2.1.1.1.3.cmml" xref="S2.p2.1.m1.2.2.1.1.1.3">1</cn></apply><ci id="S2.p2.1.m1.1.1.cmml" xref="S2.p2.1.m1.1.1">⋯</ci><apply id="S2.p2.1.m1.3.3.2.2.2.cmml" xref="S2.p2.1.m1.3.3.2.2.2"><csymbol cd="ambiguous" id="S2.p2.1.m1.3.3.2.2.2.1.cmml" xref="S2.p2.1.m1.3.3.2.2.2">subscript</csymbol><ci id="S2.p2.1.m1.3.3.2.2.2.2.cmml" xref="S2.p2.1.m1.3.3.2.2.2.2">𝑥</ci><ci id="S2.p2.1.m1.3.3.2.2.2.3.cmml" xref="S2.p2.1.m1.3.3.2.2.2.3">𝑛</ci></apply></list></apply><apply id="S2.p2.1.m1.3.3c.cmml" xref="S2.p2.1.m1.3.3"><in id="S2.p2.1.m1.3.3.6.cmml" xref="S2.p2.1.m1.3.3.6"></in><share href="#S2.p2.1.m1.3.3.2.cmml" id="S2.p2.1.m1.3.3d.cmml" xref="S2.p2.1.m1.3.3"></share><apply id="S2.p2.1.m1.3.3.7.cmml" xref="S2.p2.1.m1.3.3.7"><csymbol cd="ambiguous" id="S2.p2.1.m1.3.3.7.1.cmml" xref="S2.p2.1.m1.3.3.7">superscript</csymbol><ci id="S2.p2.1.m1.3.3.7.2.cmml" xref="S2.p2.1.m1.3.3.7.2">ℝ</ci><apply id="S2.p2.1.m1.3.3.7.3.cmml" xref="S2.p2.1.m1.3.3.7.3"><times id="S2.p2.1.m1.3.3.7.3.1.cmml" xref="S2.p2.1.m1.3.3.7.3.1"></times><ci id="S2.p2.1.m1.3.3.7.3.2.cmml" xref="S2.p2.1.m1.3.3.7.3.2">𝐻</ci><ci id="S2.p2.1.m1.3.3.7.3.3.cmml" xref="S2.p2.1.m1.3.3.7.3.3">𝑊</ci><ci id="S2.p2.1.m1.3.3.7.3.4.cmml" xref="S2.p2.1.m1.3.3.7.3.4">𝐶</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.p2.1.m1.3c">\mathbf{x}=[x_{1},\cdots,x_{n}]\in\mathbb{R}^{H\times W\times C}</annotation></semantics></math>, where <math id="S2.p2.2.m2.2" class="ltx_Math" alttext="(H,W)" display="inline"><semantics id="S2.p2.2.m2.2a"><mrow id="S2.p2.2.m2.2.3.2" xref="S2.p2.2.m2.2.3.1.cmml"><mo stretchy="false" id="S2.p2.2.m2.2.3.2.1" xref="S2.p2.2.m2.2.3.1.cmml">(</mo><mi id="S2.p2.2.m2.1.1" xref="S2.p2.2.m2.1.1.cmml">H</mi><mo id="S2.p2.2.m2.2.3.2.2" xref="S2.p2.2.m2.2.3.1.cmml">,</mo><mi id="S2.p2.2.m2.2.2" xref="S2.p2.2.m2.2.2.cmml">W</mi><mo stretchy="false" id="S2.p2.2.m2.2.3.2.3" xref="S2.p2.2.m2.2.3.1.cmml">)</mo></mrow><annotation-xml encoding="MathML-Content" id="S2.p2.2.m2.2b"><interval closure="open" id="S2.p2.2.m2.2.3.1.cmml" xref="S2.p2.2.m2.2.3.2"><ci id="S2.p2.2.m2.1.1.cmml" xref="S2.p2.2.m2.1.1">𝐻</ci><ci id="S2.p2.2.m2.2.2.cmml" xref="S2.p2.2.m2.2.2">𝑊</ci></interval></annotation-xml><annotation encoding="application/x-tex" id="S2.p2.2.m2.2c">(H,W)</annotation></semantics></math> is the image resolution, into <math id="S2.p2.3.m3.1" class="ltx_Math" alttext="C" display="inline"><semantics id="S2.p2.3.m3.1a"><mi id="S2.p2.3.m3.1.1" xref="S2.p2.3.m3.1.1.cmml">C</mi><annotation-xml encoding="MathML-Content" id="S2.p2.3.m3.1b"><ci id="S2.p2.3.m3.1.1.cmml" xref="S2.p2.3.m3.1.1">𝐶</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.p2.3.m3.1c">C</annotation></semantics></math> number of 2D slices <span id="S2.p2.4.1" class="ltx_text ltx_font_italic">i.e. <math id="S2.p2.4.1.m1.1" class="ltx_Math" alttext="x_{i}\in\mathbb{R}^{H\times W}" display="inline"><semantics id="S2.p2.4.1.m1.1a"><mrow id="S2.p2.4.1.m1.1.1" xref="S2.p2.4.1.m1.1.1.cmml"><msub id="S2.p2.4.1.m1.1.1.2" xref="S2.p2.4.1.m1.1.1.2.cmml"><mi id="S2.p2.4.1.m1.1.1.2.2" xref="S2.p2.4.1.m1.1.1.2.2.cmml">x</mi><mi id="S2.p2.4.1.m1.1.1.2.3" xref="S2.p2.4.1.m1.1.1.2.3.cmml">i</mi></msub><mo id="S2.p2.4.1.m1.1.1.1" xref="S2.p2.4.1.m1.1.1.1.cmml">∈</mo><msup id="S2.p2.4.1.m1.1.1.3" xref="S2.p2.4.1.m1.1.1.3.cmml"><mi id="S2.p2.4.1.m1.1.1.3.2" xref="S2.p2.4.1.m1.1.1.3.2.cmml">ℝ</mi><mrow id="S2.p2.4.1.m1.1.1.3.3" xref="S2.p2.4.1.m1.1.1.3.3.cmml"><mi id="S2.p2.4.1.m1.1.1.3.3.2" xref="S2.p2.4.1.m1.1.1.3.3.2.cmml">H</mi><mo lspace="0.222em" rspace="0.222em" id="S2.p2.4.1.m1.1.1.3.3.1" xref="S2.p2.4.1.m1.1.1.3.3.1.cmml">×</mo><mi id="S2.p2.4.1.m1.1.1.3.3.3" xref="S2.p2.4.1.m1.1.1.3.3.3.cmml">W</mi></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S2.p2.4.1.m1.1b"><apply id="S2.p2.4.1.m1.1.1.cmml" xref="S2.p2.4.1.m1.1.1"><in id="S2.p2.4.1.m1.1.1.1.cmml" xref="S2.p2.4.1.m1.1.1.1"></in><apply id="S2.p2.4.1.m1.1.1.2.cmml" xref="S2.p2.4.1.m1.1.1.2"><csymbol cd="ambiguous" id="S2.p2.4.1.m1.1.1.2.1.cmml" xref="S2.p2.4.1.m1.1.1.2">subscript</csymbol><ci id="S2.p2.4.1.m1.1.1.2.2.cmml" xref="S2.p2.4.1.m1.1.1.2.2">𝑥</ci><ci id="S2.p2.4.1.m1.1.1.2.3.cmml" xref="S2.p2.4.1.m1.1.1.2.3">𝑖</ci></apply><apply id="S2.p2.4.1.m1.1.1.3.cmml" xref="S2.p2.4.1.m1.1.1.3"><csymbol cd="ambiguous" id="S2.p2.4.1.m1.1.1.3.1.cmml" xref="S2.p2.4.1.m1.1.1.3">superscript</csymbol><ci id="S2.p2.4.1.m1.1.1.3.2.cmml" xref="S2.p2.4.1.m1.1.1.3.2">ℝ</ci><apply id="S2.p2.4.1.m1.1.1.3.3.cmml" xref="S2.p2.4.1.m1.1.1.3.3"><times id="S2.p2.4.1.m1.1.1.3.3.1.cmml" xref="S2.p2.4.1.m1.1.1.3.3.1"></times><ci id="S2.p2.4.1.m1.1.1.3.3.2.cmml" xref="S2.p2.4.1.m1.1.1.3.3.2">𝐻</ci><ci id="S2.p2.4.1.m1.1.1.3.3.3.cmml" xref="S2.p2.4.1.m1.1.1.3.3.3">𝑊</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.p2.4.1.m1.1c">x_{i}\in\mathbb{R}^{H\times W}</annotation></semantics></math></span> (<math id="S2.p2.5.m4.3" class="ltx_Math" alttext="i=1,\cdots,n" display="inline"><semantics id="S2.p2.5.m4.3a"><mrow id="S2.p2.5.m4.3.4" xref="S2.p2.5.m4.3.4.cmml"><mi id="S2.p2.5.m4.3.4.2" xref="S2.p2.5.m4.3.4.2.cmml">i</mi><mo id="S2.p2.5.m4.3.4.1" xref="S2.p2.5.m4.3.4.1.cmml">=</mo><mrow id="S2.p2.5.m4.3.4.3.2" xref="S2.p2.5.m4.3.4.3.1.cmml"><mn id="S2.p2.5.m4.1.1" xref="S2.p2.5.m4.1.1.cmml">1</mn><mo id="S2.p2.5.m4.3.4.3.2.1" xref="S2.p2.5.m4.3.4.3.1.cmml">,</mo><mi mathvariant="normal" id="S2.p2.5.m4.2.2" xref="S2.p2.5.m4.2.2.cmml">⋯</mi><mo id="S2.p2.5.m4.3.4.3.2.2" xref="S2.p2.5.m4.3.4.3.1.cmml">,</mo><mi id="S2.p2.5.m4.3.3" xref="S2.p2.5.m4.3.3.cmml">n</mi></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.p2.5.m4.3b"><apply id="S2.p2.5.m4.3.4.cmml" xref="S2.p2.5.m4.3.4"><eq id="S2.p2.5.m4.3.4.1.cmml" xref="S2.p2.5.m4.3.4.1"></eq><ci id="S2.p2.5.m4.3.4.2.cmml" xref="S2.p2.5.m4.3.4.2">𝑖</ci><list id="S2.p2.5.m4.3.4.3.1.cmml" xref="S2.p2.5.m4.3.4.3.2"><cn type="integer" id="S2.p2.5.m4.1.1.cmml" xref="S2.p2.5.m4.1.1">1</cn><ci id="S2.p2.5.m4.2.2.cmml" xref="S2.p2.5.m4.2.2">⋯</ci><ci id="S2.p2.5.m4.3.3.cmml" xref="S2.p2.5.m4.3.3">𝑛</ci></list></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.p2.5.m4.3c">i=1,\cdots,n</annotation></semantics></math>) to perform image flatting. Then, we denote the patch input as <math id="S2.p2.6.m5.1" class="ltx_Math" alttext="x_{i}^{p}\in\mathbb{R}^{N\times P^{2}}" display="inline"><semantics id="S2.p2.6.m5.1a"><mrow id="S2.p2.6.m5.1.1" xref="S2.p2.6.m5.1.1.cmml"><msubsup id="S2.p2.6.m5.1.1.2" xref="S2.p2.6.m5.1.1.2.cmml"><mi id="S2.p2.6.m5.1.1.2.2.2" xref="S2.p2.6.m5.1.1.2.2.2.cmml">x</mi><mi id="S2.p2.6.m5.1.1.2.2.3" xref="S2.p2.6.m5.1.1.2.2.3.cmml">i</mi><mi id="S2.p2.6.m5.1.1.2.3" xref="S2.p2.6.m5.1.1.2.3.cmml">p</mi></msubsup><mo id="S2.p2.6.m5.1.1.1" xref="S2.p2.6.m5.1.1.1.cmml">∈</mo><msup id="S2.p2.6.m5.1.1.3" xref="S2.p2.6.m5.1.1.3.cmml"><mi id="S2.p2.6.m5.1.1.3.2" xref="S2.p2.6.m5.1.1.3.2.cmml">ℝ</mi><mrow id="S2.p2.6.m5.1.1.3.3" xref="S2.p2.6.m5.1.1.3.3.cmml"><mi id="S2.p2.6.m5.1.1.3.3.2" xref="S2.p2.6.m5.1.1.3.3.2.cmml">N</mi><mo lspace="0.222em" rspace="0.222em" id="S2.p2.6.m5.1.1.3.3.1" xref="S2.p2.6.m5.1.1.3.3.1.cmml">×</mo><msup id="S2.p2.6.m5.1.1.3.3.3" xref="S2.p2.6.m5.1.1.3.3.3.cmml"><mi id="S2.p2.6.m5.1.1.3.3.3.2" xref="S2.p2.6.m5.1.1.3.3.3.2.cmml">P</mi><mn id="S2.p2.6.m5.1.1.3.3.3.3" xref="S2.p2.6.m5.1.1.3.3.3.3.cmml">2</mn></msup></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S2.p2.6.m5.1b"><apply id="S2.p2.6.m5.1.1.cmml" xref="S2.p2.6.m5.1.1"><in id="S2.p2.6.m5.1.1.1.cmml" xref="S2.p2.6.m5.1.1.1"></in><apply id="S2.p2.6.m5.1.1.2.cmml" xref="S2.p2.6.m5.1.1.2"><csymbol cd="ambiguous" id="S2.p2.6.m5.1.1.2.1.cmml" xref="S2.p2.6.m5.1.1.2">superscript</csymbol><apply id="S2.p2.6.m5.1.1.2.2.cmml" xref="S2.p2.6.m5.1.1.2"><csymbol cd="ambiguous" id="S2.p2.6.m5.1.1.2.2.1.cmml" xref="S2.p2.6.m5.1.1.2">subscript</csymbol><ci id="S2.p2.6.m5.1.1.2.2.2.cmml" xref="S2.p2.6.m5.1.1.2.2.2">𝑥</ci><ci id="S2.p2.6.m5.1.1.2.2.3.cmml" xref="S2.p2.6.m5.1.1.2.2.3">𝑖</ci></apply><ci id="S2.p2.6.m5.1.1.2.3.cmml" xref="S2.p2.6.m5.1.1.2.3">𝑝</ci></apply><apply id="S2.p2.6.m5.1.1.3.cmml" xref="S2.p2.6.m5.1.1.3"><csymbol cd="ambiguous" id="S2.p2.6.m5.1.1.3.1.cmml" xref="S2.p2.6.m5.1.1.3">superscript</csymbol><ci id="S2.p2.6.m5.1.1.3.2.cmml" xref="S2.p2.6.m5.1.1.3.2">ℝ</ci><apply id="S2.p2.6.m5.1.1.3.3.cmml" xref="S2.p2.6.m5.1.1.3.3"><times id="S2.p2.6.m5.1.1.3.3.1.cmml" xref="S2.p2.6.m5.1.1.3.3.1"></times><ci id="S2.p2.6.m5.1.1.3.3.2.cmml" xref="S2.p2.6.m5.1.1.3.3.2">𝑁</ci><apply id="S2.p2.6.m5.1.1.3.3.3.cmml" xref="S2.p2.6.m5.1.1.3.3.3"><csymbol cd="ambiguous" id="S2.p2.6.m5.1.1.3.3.3.1.cmml" xref="S2.p2.6.m5.1.1.3.3.3">superscript</csymbol><ci id="S2.p2.6.m5.1.1.3.3.3.2.cmml" xref="S2.p2.6.m5.1.1.3.3.3.2">𝑃</ci><cn type="integer" id="S2.p2.6.m5.1.1.3.3.3.3.cmml" xref="S2.p2.6.m5.1.1.3.3.3.3">2</cn></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.p2.6.m5.1c">x_{i}^{p}\in\mathbb{R}^{N\times P^{2}}</annotation></semantics></math> for slice <math id="S2.p2.7.m6.1" class="ltx_Math" alttext="x_{i}" display="inline"><semantics id="S2.p2.7.m6.1a"><msub id="S2.p2.7.m6.1.1" xref="S2.p2.7.m6.1.1.cmml"><mi id="S2.p2.7.m6.1.1.2" xref="S2.p2.7.m6.1.1.2.cmml">x</mi><mi id="S2.p2.7.m6.1.1.3" xref="S2.p2.7.m6.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S2.p2.7.m6.1b"><apply id="S2.p2.7.m6.1.1.cmml" xref="S2.p2.7.m6.1.1"><csymbol cd="ambiguous" id="S2.p2.7.m6.1.1.1.cmml" xref="S2.p2.7.m6.1.1">subscript</csymbol><ci id="S2.p2.7.m6.1.1.2.cmml" xref="S2.p2.7.m6.1.1.2">𝑥</ci><ci id="S2.p2.7.m6.1.1.3.cmml" xref="S2.p2.7.m6.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.p2.7.m6.1c">x_{i}</annotation></semantics></math>, where <math id="S2.p2.8.m7.2" class="ltx_Math" alttext="(P,P)" display="inline"><semantics id="S2.p2.8.m7.2a"><mrow id="S2.p2.8.m7.2.3.2" xref="S2.p2.8.m7.2.3.1.cmml"><mo stretchy="false" id="S2.p2.8.m7.2.3.2.1" xref="S2.p2.8.m7.2.3.1.cmml">(</mo><mi id="S2.p2.8.m7.1.1" xref="S2.p2.8.m7.1.1.cmml">P</mi><mo id="S2.p2.8.m7.2.3.2.2" xref="S2.p2.8.m7.2.3.1.cmml">,</mo><mi id="S2.p2.8.m7.2.2" xref="S2.p2.8.m7.2.2.cmml">P</mi><mo stretchy="false" id="S2.p2.8.m7.2.3.2.3" xref="S2.p2.8.m7.2.3.1.cmml">)</mo></mrow><annotation-xml encoding="MathML-Content" id="S2.p2.8.m7.2b"><interval closure="open" id="S2.p2.8.m7.2.3.1.cmml" xref="S2.p2.8.m7.2.3.2"><ci id="S2.p2.8.m7.1.1.cmml" xref="S2.p2.8.m7.1.1">𝑃</ci><ci id="S2.p2.8.m7.2.2.cmml" xref="S2.p2.8.m7.2.2">𝑃</ci></interval></annotation-xml><annotation encoding="application/x-tex" id="S2.p2.8.m7.2c">(P,P)</annotation></semantics></math> is the patch resolution and <math id="S2.p2.9.m8.1" class="ltx_Math" alttext="N=HW/P^{2}" display="inline"><semantics id="S2.p2.9.m8.1a"><mrow id="S2.p2.9.m8.1.1" xref="S2.p2.9.m8.1.1.cmml"><mi id="S2.p2.9.m8.1.1.2" xref="S2.p2.9.m8.1.1.2.cmml">N</mi><mo id="S2.p2.9.m8.1.1.1" xref="S2.p2.9.m8.1.1.1.cmml">=</mo><mrow id="S2.p2.9.m8.1.1.3" xref="S2.p2.9.m8.1.1.3.cmml"><mrow id="S2.p2.9.m8.1.1.3.2" xref="S2.p2.9.m8.1.1.3.2.cmml"><mi id="S2.p2.9.m8.1.1.3.2.2" xref="S2.p2.9.m8.1.1.3.2.2.cmml">H</mi><mo lspace="0em" rspace="0em" id="S2.p2.9.m8.1.1.3.2.1" xref="S2.p2.9.m8.1.1.3.2.1.cmml">​</mo><mi id="S2.p2.9.m8.1.1.3.2.3" xref="S2.p2.9.m8.1.1.3.2.3.cmml">W</mi></mrow><mo id="S2.p2.9.m8.1.1.3.1" xref="S2.p2.9.m8.1.1.3.1.cmml">/</mo><msup id="S2.p2.9.m8.1.1.3.3" xref="S2.p2.9.m8.1.1.3.3.cmml"><mi id="S2.p2.9.m8.1.1.3.3.2" xref="S2.p2.9.m8.1.1.3.3.2.cmml">P</mi><mn id="S2.p2.9.m8.1.1.3.3.3" xref="S2.p2.9.m8.1.1.3.3.3.cmml">2</mn></msup></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.p2.9.m8.1b"><apply id="S2.p2.9.m8.1.1.cmml" xref="S2.p2.9.m8.1.1"><eq id="S2.p2.9.m8.1.1.1.cmml" xref="S2.p2.9.m8.1.1.1"></eq><ci id="S2.p2.9.m8.1.1.2.cmml" xref="S2.p2.9.m8.1.1.2">𝑁</ci><apply id="S2.p2.9.m8.1.1.3.cmml" xref="S2.p2.9.m8.1.1.3"><divide id="S2.p2.9.m8.1.1.3.1.cmml" xref="S2.p2.9.m8.1.1.3.1"></divide><apply id="S2.p2.9.m8.1.1.3.2.cmml" xref="S2.p2.9.m8.1.1.3.2"><times id="S2.p2.9.m8.1.1.3.2.1.cmml" xref="S2.p2.9.m8.1.1.3.2.1"></times><ci id="S2.p2.9.m8.1.1.3.2.2.cmml" xref="S2.p2.9.m8.1.1.3.2.2">𝐻</ci><ci id="S2.p2.9.m8.1.1.3.2.3.cmml" xref="S2.p2.9.m8.1.1.3.2.3">𝑊</ci></apply><apply id="S2.p2.9.m8.1.1.3.3.cmml" xref="S2.p2.9.m8.1.1.3.3"><csymbol cd="ambiguous" id="S2.p2.9.m8.1.1.3.3.1.cmml" xref="S2.p2.9.m8.1.1.3.3">superscript</csymbol><ci id="S2.p2.9.m8.1.1.3.3.2.cmml" xref="S2.p2.9.m8.1.1.3.3.2">𝑃</ci><cn type="integer" id="S2.p2.9.m8.1.1.3.3.3.cmml" xref="S2.p2.9.m8.1.1.3.3.3">2</cn></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.p2.9.m8.1c">N=HW/P^{2}</annotation></semantics></math> is the number of patches in one slice. Afterwards, a learnable embedding is employed to vectorize the patch inputs into vector embedding <math id="S2.p2.10.m9.1" class="ltx_Math" alttext="\mathbf{z}_{0}" display="inline"><semantics id="S2.p2.10.m9.1a"><msub id="S2.p2.10.m9.1.1" xref="S2.p2.10.m9.1.1.cmml"><mi id="S2.p2.10.m9.1.1.2" xref="S2.p2.10.m9.1.1.2.cmml">𝐳</mi><mn id="S2.p2.10.m9.1.1.3" xref="S2.p2.10.m9.1.1.3.cmml">0</mn></msub><annotation-xml encoding="MathML-Content" id="S2.p2.10.m9.1b"><apply id="S2.p2.10.m9.1.1.cmml" xref="S2.p2.10.m9.1.1"><csymbol cd="ambiguous" id="S2.p2.10.m9.1.1.1.cmml" xref="S2.p2.10.m9.1.1">subscript</csymbol><ci id="S2.p2.10.m9.1.1.2.cmml" xref="S2.p2.10.m9.1.1.2">𝐳</ci><cn type="integer" id="S2.p2.10.m9.1.1.3.cmml" xref="S2.p2.10.m9.1.1.3">0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.p2.10.m9.1c">\mathbf{z}_{0}</annotation></semantics></math> <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib6" title="" class="ltx_ref">6</a>]</cite>. Rather than the convolutional layers, Vision Transformer (ViT) <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib6" title="" class="ltx_ref">6</a>]</cite> adopts Multi-head Self-Attention (MSA) and Multi-Layer Perceptron (MLP) operators on the embeddings. To be more specific, the latent output of <math id="S2.p2.11.m10.1" class="ltx_Math" alttext="l" display="inline"><semantics id="S2.p2.11.m10.1a"><mi id="S2.p2.11.m10.1.1" xref="S2.p2.11.m10.1.1.cmml">l</mi><annotation-xml encoding="MathML-Content" id="S2.p2.11.m10.1b"><ci id="S2.p2.11.m10.1.1.cmml" xref="S2.p2.11.m10.1.1">𝑙</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.p2.11.m10.1c">l</annotation></semantics></math><sup id="S2.p2.13.3" class="ltx_sup">th</sup> layer, for <math id="S2.p2.12.m11.3" class="ltx_Math" alttext="l=1,\cdots,L" display="inline"><semantics id="S2.p2.12.m11.3a"><mrow id="S2.p2.12.m11.3.4" xref="S2.p2.12.m11.3.4.cmml"><mi id="S2.p2.12.m11.3.4.2" xref="S2.p2.12.m11.3.4.2.cmml">l</mi><mo id="S2.p2.12.m11.3.4.1" xref="S2.p2.12.m11.3.4.1.cmml">=</mo><mrow id="S2.p2.12.m11.3.4.3.2" xref="S2.p2.12.m11.3.4.3.1.cmml"><mn id="S2.p2.12.m11.1.1" xref="S2.p2.12.m11.1.1.cmml">1</mn><mo id="S2.p2.12.m11.3.4.3.2.1" xref="S2.p2.12.m11.3.4.3.1.cmml">,</mo><mi mathvariant="normal" id="S2.p2.12.m11.2.2" xref="S2.p2.12.m11.2.2.cmml">⋯</mi><mo id="S2.p2.12.m11.3.4.3.2.2" xref="S2.p2.12.m11.3.4.3.1.cmml">,</mo><mi id="S2.p2.12.m11.3.3" xref="S2.p2.12.m11.3.3.cmml">L</mi></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.p2.12.m11.3b"><apply id="S2.p2.12.m11.3.4.cmml" xref="S2.p2.12.m11.3.4"><eq id="S2.p2.12.m11.3.4.1.cmml" xref="S2.p2.12.m11.3.4.1"></eq><ci id="S2.p2.12.m11.3.4.2.cmml" xref="S2.p2.12.m11.3.4.2">𝑙</ci><list id="S2.p2.12.m11.3.4.3.1.cmml" xref="S2.p2.12.m11.3.4.3.2"><cn type="integer" id="S2.p2.12.m11.1.1.cmml" xref="S2.p2.12.m11.1.1">1</cn><ci id="S2.p2.12.m11.2.2.cmml" xref="S2.p2.12.m11.2.2">⋯</ci><ci id="S2.p2.12.m11.3.3.cmml" xref="S2.p2.12.m11.3.3">𝐿</ci></list></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.p2.12.m11.3c">l=1,\cdots,L</annotation></semantics></math>, <math id="S2.p2.13.m12.1" class="ltx_Math" alttext="\mathbf{z}_{l}" display="inline"><semantics id="S2.p2.13.m12.1a"><msub id="S2.p2.13.m12.1.1" xref="S2.p2.13.m12.1.1.cmml"><mi id="S2.p2.13.m12.1.1.2" xref="S2.p2.13.m12.1.1.2.cmml">𝐳</mi><mi id="S2.p2.13.m12.1.1.3" xref="S2.p2.13.m12.1.1.3.cmml">l</mi></msub><annotation-xml encoding="MathML-Content" id="S2.p2.13.m12.1b"><apply id="S2.p2.13.m12.1.1.cmml" xref="S2.p2.13.m12.1.1"><csymbol cd="ambiguous" id="S2.p2.13.m12.1.1.1.cmml" xref="S2.p2.13.m12.1.1">subscript</csymbol><ci id="S2.p2.13.m12.1.1.2.cmml" xref="S2.p2.13.m12.1.1.2">𝐳</ci><ci id="S2.p2.13.m12.1.1.3.cmml" xref="S2.p2.13.m12.1.1.3">𝑙</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.p2.13.m12.1c">\mathbf{z}_{l}</annotation></semantics></math> is computed as:</p>
<table id="S2.E1" class="ltx_equationgroup ltx_eqn_table">
<tbody>
<tr id="S2.E1X" class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math id="S2.E1X.2.1.1.m1.1" class="ltx_Math" alttext="\displaystyle\mathbf{z}_{l}^{\prime}" display="inline"><semantics id="S2.E1X.2.1.1.m1.1a"><msubsup id="S2.E1X.2.1.1.m1.1.1" xref="S2.E1X.2.1.1.m1.1.1.cmml"><mi id="S2.E1X.2.1.1.m1.1.1.2.2" xref="S2.E1X.2.1.1.m1.1.1.2.2.cmml">𝐳</mi><mi id="S2.E1X.2.1.1.m1.1.1.2.3" xref="S2.E1X.2.1.1.m1.1.1.2.3.cmml">l</mi><mo id="S2.E1X.2.1.1.m1.1.1.3" xref="S2.E1X.2.1.1.m1.1.1.3.cmml">′</mo></msubsup><annotation-xml encoding="MathML-Content" id="S2.E1X.2.1.1.m1.1b"><apply id="S2.E1X.2.1.1.m1.1.1.cmml" xref="S2.E1X.2.1.1.m1.1.1"><csymbol cd="ambiguous" id="S2.E1X.2.1.1.m1.1.1.1.cmml" xref="S2.E1X.2.1.1.m1.1.1">superscript</csymbol><apply id="S2.E1X.2.1.1.m1.1.1.2.cmml" xref="S2.E1X.2.1.1.m1.1.1"><csymbol cd="ambiguous" id="S2.E1X.2.1.1.m1.1.1.2.1.cmml" xref="S2.E1X.2.1.1.m1.1.1">subscript</csymbol><ci id="S2.E1X.2.1.1.m1.1.1.2.2.cmml" xref="S2.E1X.2.1.1.m1.1.1.2.2">𝐳</ci><ci id="S2.E1X.2.1.1.m1.1.1.2.3.cmml" xref="S2.E1X.2.1.1.m1.1.1.2.3">𝑙</ci></apply><ci id="S2.E1X.2.1.1.m1.1.1.3.cmml" xref="S2.E1X.2.1.1.m1.1.1.3">′</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.E1X.2.1.1.m1.1c">\displaystyle\mathbf{z}_{l}^{\prime}</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math id="S2.E1X.3.2.2.m1.3" class="ltx_Math" alttext="\displaystyle=\operatorname{MSA}_{l}\left(\operatorname{LN}_{l,0}(\mathbf{z}_{l-1})\right)+\mathbf{z}_{l-1}," display="inline"><semantics id="S2.E1X.3.2.2.m1.3a"><mrow id="S2.E1X.3.2.2.m1.3.3.1" xref="S2.E1X.3.2.2.m1.3.3.1.1.cmml"><mrow id="S2.E1X.3.2.2.m1.3.3.1.1" xref="S2.E1X.3.2.2.m1.3.3.1.1.cmml"><mi id="S2.E1X.3.2.2.m1.3.3.1.1.4" xref="S2.E1X.3.2.2.m1.3.3.1.1.4.cmml"></mi><mo id="S2.E1X.3.2.2.m1.3.3.1.1.3" xref="S2.E1X.3.2.2.m1.3.3.1.1.3.cmml">=</mo><mrow id="S2.E1X.3.2.2.m1.3.3.1.1.2" xref="S2.E1X.3.2.2.m1.3.3.1.1.2.cmml"><mrow id="S2.E1X.3.2.2.m1.3.3.1.1.2.2.2" xref="S2.E1X.3.2.2.m1.3.3.1.1.2.2.3.cmml"><msub id="S2.E1X.3.2.2.m1.3.3.1.1.1.1.1.1" xref="S2.E1X.3.2.2.m1.3.3.1.1.1.1.1.1.cmml"><mi id="S2.E1X.3.2.2.m1.3.3.1.1.1.1.1.1.2" xref="S2.E1X.3.2.2.m1.3.3.1.1.1.1.1.1.2.cmml">MSA</mi><mi id="S2.E1X.3.2.2.m1.3.3.1.1.1.1.1.1.3" xref="S2.E1X.3.2.2.m1.3.3.1.1.1.1.1.1.3.cmml">l</mi></msub><mo id="S2.E1X.3.2.2.m1.3.3.1.1.2.2.2a" xref="S2.E1X.3.2.2.m1.3.3.1.1.2.2.3.cmml">⁡</mo><mrow id="S2.E1X.3.2.2.m1.3.3.1.1.2.2.2.2" xref="S2.E1X.3.2.2.m1.3.3.1.1.2.2.3.cmml"><mo id="S2.E1X.3.2.2.m1.3.3.1.1.2.2.2.2.2" xref="S2.E1X.3.2.2.m1.3.3.1.1.2.2.3.cmml">(</mo><mrow id="S2.E1X.3.2.2.m1.3.3.1.1.2.2.2.2.1.2" xref="S2.E1X.3.2.2.m1.3.3.1.1.2.2.2.2.1.3.cmml"><msub id="S2.E1X.3.2.2.m1.3.3.1.1.2.2.2.2.1.1.1" xref="S2.E1X.3.2.2.m1.3.3.1.1.2.2.2.2.1.1.1.cmml"><mi id="S2.E1X.3.2.2.m1.3.3.1.1.2.2.2.2.1.1.1.2" xref="S2.E1X.3.2.2.m1.3.3.1.1.2.2.2.2.1.1.1.2.cmml">LN</mi><mrow id="S2.E1X.3.2.2.m1.2.2.2.4" xref="S2.E1X.3.2.2.m1.2.2.2.3.cmml"><mi id="S2.E1X.3.2.2.m1.1.1.1.1" xref="S2.E1X.3.2.2.m1.1.1.1.1.cmml">l</mi><mo id="S2.E1X.3.2.2.m1.2.2.2.4.1" xref="S2.E1X.3.2.2.m1.2.2.2.3.cmml">,</mo><mn id="S2.E1X.3.2.2.m1.2.2.2.2" xref="S2.E1X.3.2.2.m1.2.2.2.2.cmml">0</mn></mrow></msub><mo id="S2.E1X.3.2.2.m1.3.3.1.1.2.2.2.2.1.2a" xref="S2.E1X.3.2.2.m1.3.3.1.1.2.2.2.2.1.3.cmml">⁡</mo><mrow id="S2.E1X.3.2.2.m1.3.3.1.1.2.2.2.2.1.2.2" xref="S2.E1X.3.2.2.m1.3.3.1.1.2.2.2.2.1.3.cmml"><mo stretchy="false" id="S2.E1X.3.2.2.m1.3.3.1.1.2.2.2.2.1.2.2.2" xref="S2.E1X.3.2.2.m1.3.3.1.1.2.2.2.2.1.3.cmml">(</mo><msub id="S2.E1X.3.2.2.m1.3.3.1.1.2.2.2.2.1.2.2.1" xref="S2.E1X.3.2.2.m1.3.3.1.1.2.2.2.2.1.2.2.1.cmml"><mi id="S2.E1X.3.2.2.m1.3.3.1.1.2.2.2.2.1.2.2.1.2" xref="S2.E1X.3.2.2.m1.3.3.1.1.2.2.2.2.1.2.2.1.2.cmml">𝐳</mi><mrow id="S2.E1X.3.2.2.m1.3.3.1.1.2.2.2.2.1.2.2.1.3" xref="S2.E1X.3.2.2.m1.3.3.1.1.2.2.2.2.1.2.2.1.3.cmml"><mi id="S2.E1X.3.2.2.m1.3.3.1.1.2.2.2.2.1.2.2.1.3.2" xref="S2.E1X.3.2.2.m1.3.3.1.1.2.2.2.2.1.2.2.1.3.2.cmml">l</mi><mo id="S2.E1X.3.2.2.m1.3.3.1.1.2.2.2.2.1.2.2.1.3.1" xref="S2.E1X.3.2.2.m1.3.3.1.1.2.2.2.2.1.2.2.1.3.1.cmml">−</mo><mn id="S2.E1X.3.2.2.m1.3.3.1.1.2.2.2.2.1.2.2.1.3.3" xref="S2.E1X.3.2.2.m1.3.3.1.1.2.2.2.2.1.2.2.1.3.3.cmml">1</mn></mrow></msub><mo stretchy="false" id="S2.E1X.3.2.2.m1.3.3.1.1.2.2.2.2.1.2.2.3" xref="S2.E1X.3.2.2.m1.3.3.1.1.2.2.2.2.1.3.cmml">)</mo></mrow></mrow><mo id="S2.E1X.3.2.2.m1.3.3.1.1.2.2.2.2.3" xref="S2.E1X.3.2.2.m1.3.3.1.1.2.2.3.cmml">)</mo></mrow></mrow><mo id="S2.E1X.3.2.2.m1.3.3.1.1.2.3" xref="S2.E1X.3.2.2.m1.3.3.1.1.2.3.cmml">+</mo><msub id="S2.E1X.3.2.2.m1.3.3.1.1.2.4" xref="S2.E1X.3.2.2.m1.3.3.1.1.2.4.cmml"><mi id="S2.E1X.3.2.2.m1.3.3.1.1.2.4.2" xref="S2.E1X.3.2.2.m1.3.3.1.1.2.4.2.cmml">𝐳</mi><mrow id="S2.E1X.3.2.2.m1.3.3.1.1.2.4.3" xref="S2.E1X.3.2.2.m1.3.3.1.1.2.4.3.cmml"><mi id="S2.E1X.3.2.2.m1.3.3.1.1.2.4.3.2" xref="S2.E1X.3.2.2.m1.3.3.1.1.2.4.3.2.cmml">l</mi><mo id="S2.E1X.3.2.2.m1.3.3.1.1.2.4.3.1" xref="S2.E1X.3.2.2.m1.3.3.1.1.2.4.3.1.cmml">−</mo><mn id="S2.E1X.3.2.2.m1.3.3.1.1.2.4.3.3" xref="S2.E1X.3.2.2.m1.3.3.1.1.2.4.3.3.cmml">1</mn></mrow></msub></mrow></mrow><mo id="S2.E1X.3.2.2.m1.3.3.1.2" xref="S2.E1X.3.2.2.m1.3.3.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S2.E1X.3.2.2.m1.3b"><apply id="S2.E1X.3.2.2.m1.3.3.1.1.cmml" xref="S2.E1X.3.2.2.m1.3.3.1"><eq id="S2.E1X.3.2.2.m1.3.3.1.1.3.cmml" xref="S2.E1X.3.2.2.m1.3.3.1.1.3"></eq><csymbol cd="latexml" id="S2.E1X.3.2.2.m1.3.3.1.1.4.cmml" xref="S2.E1X.3.2.2.m1.3.3.1.1.4">absent</csymbol><apply id="S2.E1X.3.2.2.m1.3.3.1.1.2.cmml" xref="S2.E1X.3.2.2.m1.3.3.1.1.2"><plus id="S2.E1X.3.2.2.m1.3.3.1.1.2.3.cmml" xref="S2.E1X.3.2.2.m1.3.3.1.1.2.3"></plus><apply id="S2.E1X.3.2.2.m1.3.3.1.1.2.2.3.cmml" xref="S2.E1X.3.2.2.m1.3.3.1.1.2.2.2"><apply id="S2.E1X.3.2.2.m1.3.3.1.1.1.1.1.1.cmml" xref="S2.E1X.3.2.2.m1.3.3.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S2.E1X.3.2.2.m1.3.3.1.1.1.1.1.1.1.cmml" xref="S2.E1X.3.2.2.m1.3.3.1.1.1.1.1.1">subscript</csymbol><ci id="S2.E1X.3.2.2.m1.3.3.1.1.1.1.1.1.2.cmml" xref="S2.E1X.3.2.2.m1.3.3.1.1.1.1.1.1.2">MSA</ci><ci id="S2.E1X.3.2.2.m1.3.3.1.1.1.1.1.1.3.cmml" xref="S2.E1X.3.2.2.m1.3.3.1.1.1.1.1.1.3">𝑙</ci></apply><apply id="S2.E1X.3.2.2.m1.3.3.1.1.2.2.2.2.1.3.cmml" xref="S2.E1X.3.2.2.m1.3.3.1.1.2.2.2.2.1.2"><apply id="S2.E1X.3.2.2.m1.3.3.1.1.2.2.2.2.1.1.1.cmml" xref="S2.E1X.3.2.2.m1.3.3.1.1.2.2.2.2.1.1.1"><csymbol cd="ambiguous" id="S2.E1X.3.2.2.m1.3.3.1.1.2.2.2.2.1.1.1.1.cmml" xref="S2.E1X.3.2.2.m1.3.3.1.1.2.2.2.2.1.1.1">subscript</csymbol><ci id="S2.E1X.3.2.2.m1.3.3.1.1.2.2.2.2.1.1.1.2.cmml" xref="S2.E1X.3.2.2.m1.3.3.1.1.2.2.2.2.1.1.1.2">LN</ci><list id="S2.E1X.3.2.2.m1.2.2.2.3.cmml" xref="S2.E1X.3.2.2.m1.2.2.2.4"><ci id="S2.E1X.3.2.2.m1.1.1.1.1.cmml" xref="S2.E1X.3.2.2.m1.1.1.1.1">𝑙</ci><cn type="integer" id="S2.E1X.3.2.2.m1.2.2.2.2.cmml" xref="S2.E1X.3.2.2.m1.2.2.2.2">0</cn></list></apply><apply id="S2.E1X.3.2.2.m1.3.3.1.1.2.2.2.2.1.2.2.1.cmml" xref="S2.E1X.3.2.2.m1.3.3.1.1.2.2.2.2.1.2.2.1"><csymbol cd="ambiguous" id="S2.E1X.3.2.2.m1.3.3.1.1.2.2.2.2.1.2.2.1.1.cmml" xref="S2.E1X.3.2.2.m1.3.3.1.1.2.2.2.2.1.2.2.1">subscript</csymbol><ci id="S2.E1X.3.2.2.m1.3.3.1.1.2.2.2.2.1.2.2.1.2.cmml" xref="S2.E1X.3.2.2.m1.3.3.1.1.2.2.2.2.1.2.2.1.2">𝐳</ci><apply id="S2.E1X.3.2.2.m1.3.3.1.1.2.2.2.2.1.2.2.1.3.cmml" xref="S2.E1X.3.2.2.m1.3.3.1.1.2.2.2.2.1.2.2.1.3"><minus id="S2.E1X.3.2.2.m1.3.3.1.1.2.2.2.2.1.2.2.1.3.1.cmml" xref="S2.E1X.3.2.2.m1.3.3.1.1.2.2.2.2.1.2.2.1.3.1"></minus><ci id="S2.E1X.3.2.2.m1.3.3.1.1.2.2.2.2.1.2.2.1.3.2.cmml" xref="S2.E1X.3.2.2.m1.3.3.1.1.2.2.2.2.1.2.2.1.3.2">𝑙</ci><cn type="integer" id="S2.E1X.3.2.2.m1.3.3.1.1.2.2.2.2.1.2.2.1.3.3.cmml" xref="S2.E1X.3.2.2.m1.3.3.1.1.2.2.2.2.1.2.2.1.3.3">1</cn></apply></apply></apply></apply><apply id="S2.E1X.3.2.2.m1.3.3.1.1.2.4.cmml" xref="S2.E1X.3.2.2.m1.3.3.1.1.2.4"><csymbol cd="ambiguous" id="S2.E1X.3.2.2.m1.3.3.1.1.2.4.1.cmml" xref="S2.E1X.3.2.2.m1.3.3.1.1.2.4">subscript</csymbol><ci id="S2.E1X.3.2.2.m1.3.3.1.1.2.4.2.cmml" xref="S2.E1X.3.2.2.m1.3.3.1.1.2.4.2">𝐳</ci><apply id="S2.E1X.3.2.2.m1.3.3.1.1.2.4.3.cmml" xref="S2.E1X.3.2.2.m1.3.3.1.1.2.4.3"><minus id="S2.E1X.3.2.2.m1.3.3.1.1.2.4.3.1.cmml" xref="S2.E1X.3.2.2.m1.3.3.1.1.2.4.3.1"></minus><ci id="S2.E1X.3.2.2.m1.3.3.1.1.2.4.3.2.cmml" xref="S2.E1X.3.2.2.m1.3.3.1.1.2.4.3.2">𝑙</ci><cn type="integer" id="S2.E1X.3.2.2.m1.3.3.1.1.2.4.3.3.cmml" xref="S2.E1X.3.2.2.m1.3.3.1.1.2.4.3.3">1</cn></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.E1X.3.2.2.m1.3c">\displaystyle=\operatorname{MSA}_{l}\left(\operatorname{LN}_{l,0}(\mathbf{z}_{l-1})\right)+\mathbf{z}_{l-1},</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="2" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equationgroup ltx_align_right">(1)</span></td>
</tr>
<tr id="S2.E1Xa" class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math id="S2.E1Xa.2.1.1.m1.1" class="ltx_Math" alttext="\displaystyle\mathbf{z}_{l}" display="inline"><semantics id="S2.E1Xa.2.1.1.m1.1a"><msub id="S2.E1Xa.2.1.1.m1.1.1" xref="S2.E1Xa.2.1.1.m1.1.1.cmml"><mi id="S2.E1Xa.2.1.1.m1.1.1.2" xref="S2.E1Xa.2.1.1.m1.1.1.2.cmml">𝐳</mi><mi id="S2.E1Xa.2.1.1.m1.1.1.3" xref="S2.E1Xa.2.1.1.m1.1.1.3.cmml">l</mi></msub><annotation-xml encoding="MathML-Content" id="S2.E1Xa.2.1.1.m1.1b"><apply id="S2.E1Xa.2.1.1.m1.1.1.cmml" xref="S2.E1Xa.2.1.1.m1.1.1"><csymbol cd="ambiguous" id="S2.E1Xa.2.1.1.m1.1.1.1.cmml" xref="S2.E1Xa.2.1.1.m1.1.1">subscript</csymbol><ci id="S2.E1Xa.2.1.1.m1.1.1.2.cmml" xref="S2.E1Xa.2.1.1.m1.1.1.2">𝐳</ci><ci id="S2.E1Xa.2.1.1.m1.1.1.3.cmml" xref="S2.E1Xa.2.1.1.m1.1.1.3">𝑙</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.E1Xa.2.1.1.m1.1c">\displaystyle\mathbf{z}_{l}</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math id="S2.E1Xa.3.2.2.m1.3" class="ltx_Math" alttext="\displaystyle=\operatorname{MLP}_{l}\left(\operatorname{LN}_{l,1}(\mathbf{z}_{l-1}^{\prime})\right)+\mathbf{z}_{l-1}^{\prime}\,," display="inline"><semantics id="S2.E1Xa.3.2.2.m1.3a"><mrow id="S2.E1Xa.3.2.2.m1.3.3.1" xref="S2.E1Xa.3.2.2.m1.3.3.1.1.cmml"><mrow id="S2.E1Xa.3.2.2.m1.3.3.1.1" xref="S2.E1Xa.3.2.2.m1.3.3.1.1.cmml"><mi id="S2.E1Xa.3.2.2.m1.3.3.1.1.4" xref="S2.E1Xa.3.2.2.m1.3.3.1.1.4.cmml"></mi><mo id="S2.E1Xa.3.2.2.m1.3.3.1.1.3" xref="S2.E1Xa.3.2.2.m1.3.3.1.1.3.cmml">=</mo><mrow id="S2.E1Xa.3.2.2.m1.3.3.1.1.2" xref="S2.E1Xa.3.2.2.m1.3.3.1.1.2.cmml"><mrow id="S2.E1Xa.3.2.2.m1.3.3.1.1.2.2.2" xref="S2.E1Xa.3.2.2.m1.3.3.1.1.2.2.3.cmml"><msub id="S2.E1Xa.3.2.2.m1.3.3.1.1.1.1.1.1" xref="S2.E1Xa.3.2.2.m1.3.3.1.1.1.1.1.1.cmml"><mi id="S2.E1Xa.3.2.2.m1.3.3.1.1.1.1.1.1.2" xref="S2.E1Xa.3.2.2.m1.3.3.1.1.1.1.1.1.2.cmml">MLP</mi><mi id="S2.E1Xa.3.2.2.m1.3.3.1.1.1.1.1.1.3" xref="S2.E1Xa.3.2.2.m1.3.3.1.1.1.1.1.1.3.cmml">l</mi></msub><mo id="S2.E1Xa.3.2.2.m1.3.3.1.1.2.2.2a" xref="S2.E1Xa.3.2.2.m1.3.3.1.1.2.2.3.cmml">⁡</mo><mrow id="S2.E1Xa.3.2.2.m1.3.3.1.1.2.2.2.2" xref="S2.E1Xa.3.2.2.m1.3.3.1.1.2.2.3.cmml"><mo id="S2.E1Xa.3.2.2.m1.3.3.1.1.2.2.2.2.2" xref="S2.E1Xa.3.2.2.m1.3.3.1.1.2.2.3.cmml">(</mo><mrow id="S2.E1Xa.3.2.2.m1.3.3.1.1.2.2.2.2.1.2" xref="S2.E1Xa.3.2.2.m1.3.3.1.1.2.2.2.2.1.3.cmml"><msub id="S2.E1Xa.3.2.2.m1.3.3.1.1.2.2.2.2.1.1.1" xref="S2.E1Xa.3.2.2.m1.3.3.1.1.2.2.2.2.1.1.1.cmml"><mi id="S2.E1Xa.3.2.2.m1.3.3.1.1.2.2.2.2.1.1.1.2" xref="S2.E1Xa.3.2.2.m1.3.3.1.1.2.2.2.2.1.1.1.2.cmml">LN</mi><mrow id="S2.E1Xa.3.2.2.m1.2.2.2.4" xref="S2.E1Xa.3.2.2.m1.2.2.2.3.cmml"><mi id="S2.E1Xa.3.2.2.m1.1.1.1.1" xref="S2.E1Xa.3.2.2.m1.1.1.1.1.cmml">l</mi><mo id="S2.E1Xa.3.2.2.m1.2.2.2.4.1" xref="S2.E1Xa.3.2.2.m1.2.2.2.3.cmml">,</mo><mn id="S2.E1Xa.3.2.2.m1.2.2.2.2" xref="S2.E1Xa.3.2.2.m1.2.2.2.2.cmml">1</mn></mrow></msub><mo id="S2.E1Xa.3.2.2.m1.3.3.1.1.2.2.2.2.1.2a" xref="S2.E1Xa.3.2.2.m1.3.3.1.1.2.2.2.2.1.3.cmml">⁡</mo><mrow id="S2.E1Xa.3.2.2.m1.3.3.1.1.2.2.2.2.1.2.2" xref="S2.E1Xa.3.2.2.m1.3.3.1.1.2.2.2.2.1.3.cmml"><mo stretchy="false" id="S2.E1Xa.3.2.2.m1.3.3.1.1.2.2.2.2.1.2.2.2" xref="S2.E1Xa.3.2.2.m1.3.3.1.1.2.2.2.2.1.3.cmml">(</mo><msubsup id="S2.E1Xa.3.2.2.m1.3.3.1.1.2.2.2.2.1.2.2.1" xref="S2.E1Xa.3.2.2.m1.3.3.1.1.2.2.2.2.1.2.2.1.cmml"><mi id="S2.E1Xa.3.2.2.m1.3.3.1.1.2.2.2.2.1.2.2.1.2.2" xref="S2.E1Xa.3.2.2.m1.3.3.1.1.2.2.2.2.1.2.2.1.2.2.cmml">𝐳</mi><mrow id="S2.E1Xa.3.2.2.m1.3.3.1.1.2.2.2.2.1.2.2.1.2.3" xref="S2.E1Xa.3.2.2.m1.3.3.1.1.2.2.2.2.1.2.2.1.2.3.cmml"><mi id="S2.E1Xa.3.2.2.m1.3.3.1.1.2.2.2.2.1.2.2.1.2.3.2" xref="S2.E1Xa.3.2.2.m1.3.3.1.1.2.2.2.2.1.2.2.1.2.3.2.cmml">l</mi><mo id="S2.E1Xa.3.2.2.m1.3.3.1.1.2.2.2.2.1.2.2.1.2.3.1" xref="S2.E1Xa.3.2.2.m1.3.3.1.1.2.2.2.2.1.2.2.1.2.3.1.cmml">−</mo><mn id="S2.E1Xa.3.2.2.m1.3.3.1.1.2.2.2.2.1.2.2.1.2.3.3" xref="S2.E1Xa.3.2.2.m1.3.3.1.1.2.2.2.2.1.2.2.1.2.3.3.cmml">1</mn></mrow><mo id="S2.E1Xa.3.2.2.m1.3.3.1.1.2.2.2.2.1.2.2.1.3" xref="S2.E1Xa.3.2.2.m1.3.3.1.1.2.2.2.2.1.2.2.1.3.cmml">′</mo></msubsup><mo stretchy="false" id="S2.E1Xa.3.2.2.m1.3.3.1.1.2.2.2.2.1.2.2.3" xref="S2.E1Xa.3.2.2.m1.3.3.1.1.2.2.2.2.1.3.cmml">)</mo></mrow></mrow><mo id="S2.E1Xa.3.2.2.m1.3.3.1.1.2.2.2.2.3" xref="S2.E1Xa.3.2.2.m1.3.3.1.1.2.2.3.cmml">)</mo></mrow></mrow><mo id="S2.E1Xa.3.2.2.m1.3.3.1.1.2.3" xref="S2.E1Xa.3.2.2.m1.3.3.1.1.2.3.cmml">+</mo><msubsup id="S2.E1Xa.3.2.2.m1.3.3.1.1.2.4" xref="S2.E1Xa.3.2.2.m1.3.3.1.1.2.4.cmml"><mi id="S2.E1Xa.3.2.2.m1.3.3.1.1.2.4.2.2" xref="S2.E1Xa.3.2.2.m1.3.3.1.1.2.4.2.2.cmml">𝐳</mi><mrow id="S2.E1Xa.3.2.2.m1.3.3.1.1.2.4.2.3" xref="S2.E1Xa.3.2.2.m1.3.3.1.1.2.4.2.3.cmml"><mi id="S2.E1Xa.3.2.2.m1.3.3.1.1.2.4.2.3.2" xref="S2.E1Xa.3.2.2.m1.3.3.1.1.2.4.2.3.2.cmml">l</mi><mo id="S2.E1Xa.3.2.2.m1.3.3.1.1.2.4.2.3.1" xref="S2.E1Xa.3.2.2.m1.3.3.1.1.2.4.2.3.1.cmml">−</mo><mn id="S2.E1Xa.3.2.2.m1.3.3.1.1.2.4.2.3.3" xref="S2.E1Xa.3.2.2.m1.3.3.1.1.2.4.2.3.3.cmml">1</mn></mrow><mo id="S2.E1Xa.3.2.2.m1.3.3.1.1.2.4.3" xref="S2.E1Xa.3.2.2.m1.3.3.1.1.2.4.3.cmml">′</mo></msubsup></mrow></mrow><mo id="S2.E1Xa.3.2.2.m1.3.3.1.2" xref="S2.E1Xa.3.2.2.m1.3.3.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S2.E1Xa.3.2.2.m1.3b"><apply id="S2.E1Xa.3.2.2.m1.3.3.1.1.cmml" xref="S2.E1Xa.3.2.2.m1.3.3.1"><eq id="S2.E1Xa.3.2.2.m1.3.3.1.1.3.cmml" xref="S2.E1Xa.3.2.2.m1.3.3.1.1.3"></eq><csymbol cd="latexml" id="S2.E1Xa.3.2.2.m1.3.3.1.1.4.cmml" xref="S2.E1Xa.3.2.2.m1.3.3.1.1.4">absent</csymbol><apply id="S2.E1Xa.3.2.2.m1.3.3.1.1.2.cmml" xref="S2.E1Xa.3.2.2.m1.3.3.1.1.2"><plus id="S2.E1Xa.3.2.2.m1.3.3.1.1.2.3.cmml" xref="S2.E1Xa.3.2.2.m1.3.3.1.1.2.3"></plus><apply id="S2.E1Xa.3.2.2.m1.3.3.1.1.2.2.3.cmml" xref="S2.E1Xa.3.2.2.m1.3.3.1.1.2.2.2"><apply id="S2.E1Xa.3.2.2.m1.3.3.1.1.1.1.1.1.cmml" xref="S2.E1Xa.3.2.2.m1.3.3.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S2.E1Xa.3.2.2.m1.3.3.1.1.1.1.1.1.1.cmml" xref="S2.E1Xa.3.2.2.m1.3.3.1.1.1.1.1.1">subscript</csymbol><ci id="S2.E1Xa.3.2.2.m1.3.3.1.1.1.1.1.1.2.cmml" xref="S2.E1Xa.3.2.2.m1.3.3.1.1.1.1.1.1.2">MLP</ci><ci id="S2.E1Xa.3.2.2.m1.3.3.1.1.1.1.1.1.3.cmml" xref="S2.E1Xa.3.2.2.m1.3.3.1.1.1.1.1.1.3">𝑙</ci></apply><apply id="S2.E1Xa.3.2.2.m1.3.3.1.1.2.2.2.2.1.3.cmml" xref="S2.E1Xa.3.2.2.m1.3.3.1.1.2.2.2.2.1.2"><apply id="S2.E1Xa.3.2.2.m1.3.3.1.1.2.2.2.2.1.1.1.cmml" xref="S2.E1Xa.3.2.2.m1.3.3.1.1.2.2.2.2.1.1.1"><csymbol cd="ambiguous" id="S2.E1Xa.3.2.2.m1.3.3.1.1.2.2.2.2.1.1.1.1.cmml" xref="S2.E1Xa.3.2.2.m1.3.3.1.1.2.2.2.2.1.1.1">subscript</csymbol><ci id="S2.E1Xa.3.2.2.m1.3.3.1.1.2.2.2.2.1.1.1.2.cmml" xref="S2.E1Xa.3.2.2.m1.3.3.1.1.2.2.2.2.1.1.1.2">LN</ci><list id="S2.E1Xa.3.2.2.m1.2.2.2.3.cmml" xref="S2.E1Xa.3.2.2.m1.2.2.2.4"><ci id="S2.E1Xa.3.2.2.m1.1.1.1.1.cmml" xref="S2.E1Xa.3.2.2.m1.1.1.1.1">𝑙</ci><cn type="integer" id="S2.E1Xa.3.2.2.m1.2.2.2.2.cmml" xref="S2.E1Xa.3.2.2.m1.2.2.2.2">1</cn></list></apply><apply id="S2.E1Xa.3.2.2.m1.3.3.1.1.2.2.2.2.1.2.2.1.cmml" xref="S2.E1Xa.3.2.2.m1.3.3.1.1.2.2.2.2.1.2.2.1"><csymbol cd="ambiguous" id="S2.E1Xa.3.2.2.m1.3.3.1.1.2.2.2.2.1.2.2.1.1.cmml" xref="S2.E1Xa.3.2.2.m1.3.3.1.1.2.2.2.2.1.2.2.1">superscript</csymbol><apply id="S2.E1Xa.3.2.2.m1.3.3.1.1.2.2.2.2.1.2.2.1.2.cmml" xref="S2.E1Xa.3.2.2.m1.3.3.1.1.2.2.2.2.1.2.2.1"><csymbol cd="ambiguous" id="S2.E1Xa.3.2.2.m1.3.3.1.1.2.2.2.2.1.2.2.1.2.1.cmml" xref="S2.E1Xa.3.2.2.m1.3.3.1.1.2.2.2.2.1.2.2.1">subscript</csymbol><ci id="S2.E1Xa.3.2.2.m1.3.3.1.1.2.2.2.2.1.2.2.1.2.2.cmml" xref="S2.E1Xa.3.2.2.m1.3.3.1.1.2.2.2.2.1.2.2.1.2.2">𝐳</ci><apply id="S2.E1Xa.3.2.2.m1.3.3.1.1.2.2.2.2.1.2.2.1.2.3.cmml" xref="S2.E1Xa.3.2.2.m1.3.3.1.1.2.2.2.2.1.2.2.1.2.3"><minus id="S2.E1Xa.3.2.2.m1.3.3.1.1.2.2.2.2.1.2.2.1.2.3.1.cmml" xref="S2.E1Xa.3.2.2.m1.3.3.1.1.2.2.2.2.1.2.2.1.2.3.1"></minus><ci id="S2.E1Xa.3.2.2.m1.3.3.1.1.2.2.2.2.1.2.2.1.2.3.2.cmml" xref="S2.E1Xa.3.2.2.m1.3.3.1.1.2.2.2.2.1.2.2.1.2.3.2">𝑙</ci><cn type="integer" id="S2.E1Xa.3.2.2.m1.3.3.1.1.2.2.2.2.1.2.2.1.2.3.3.cmml" xref="S2.E1Xa.3.2.2.m1.3.3.1.1.2.2.2.2.1.2.2.1.2.3.3">1</cn></apply></apply><ci id="S2.E1Xa.3.2.2.m1.3.3.1.1.2.2.2.2.1.2.2.1.3.cmml" xref="S2.E1Xa.3.2.2.m1.3.3.1.1.2.2.2.2.1.2.2.1.3">′</ci></apply></apply></apply><apply id="S2.E1Xa.3.2.2.m1.3.3.1.1.2.4.cmml" xref="S2.E1Xa.3.2.2.m1.3.3.1.1.2.4"><csymbol cd="ambiguous" id="S2.E1Xa.3.2.2.m1.3.3.1.1.2.4.1.cmml" xref="S2.E1Xa.3.2.2.m1.3.3.1.1.2.4">superscript</csymbol><apply id="S2.E1Xa.3.2.2.m1.3.3.1.1.2.4.2.cmml" xref="S2.E1Xa.3.2.2.m1.3.3.1.1.2.4"><csymbol cd="ambiguous" id="S2.E1Xa.3.2.2.m1.3.3.1.1.2.4.2.1.cmml" xref="S2.E1Xa.3.2.2.m1.3.3.1.1.2.4">subscript</csymbol><ci id="S2.E1Xa.3.2.2.m1.3.3.1.1.2.4.2.2.cmml" xref="S2.E1Xa.3.2.2.m1.3.3.1.1.2.4.2.2">𝐳</ci><apply id="S2.E1Xa.3.2.2.m1.3.3.1.1.2.4.2.3.cmml" xref="S2.E1Xa.3.2.2.m1.3.3.1.1.2.4.2.3"><minus id="S2.E1Xa.3.2.2.m1.3.3.1.1.2.4.2.3.1.cmml" xref="S2.E1Xa.3.2.2.m1.3.3.1.1.2.4.2.3.1"></minus><ci id="S2.E1Xa.3.2.2.m1.3.3.1.1.2.4.2.3.2.cmml" xref="S2.E1Xa.3.2.2.m1.3.3.1.1.2.4.2.3.2">𝑙</ci><cn type="integer" id="S2.E1Xa.3.2.2.m1.3.3.1.1.2.4.2.3.3.cmml" xref="S2.E1Xa.3.2.2.m1.3.3.1.1.2.4.2.3.3">1</cn></apply></apply><ci id="S2.E1Xa.3.2.2.m1.3.3.1.1.2.4.3.cmml" xref="S2.E1Xa.3.2.2.m1.3.3.1.1.2.4.3">′</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.E1Xa.3.2.2.m1.3c">\displaystyle=\operatorname{MLP}_{l}\left(\operatorname{LN}_{l,1}(\mathbf{z}_{l-1}^{\prime})\right)+\mathbf{z}_{l-1}^{\prime}\,,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr>
</tbody>
</table>
<p id="S2.p2.16" class="ltx_p">where we use the superscript <math id="S2.p2.14.m1.1" class="ltx_Math" alttext="l" display="inline"><semantics id="S2.p2.14.m1.1a"><mi id="S2.p2.14.m1.1.1" xref="S2.p2.14.m1.1.1.cmml">l</mi><annotation-xml encoding="MathML-Content" id="S2.p2.14.m1.1b"><ci id="S2.p2.14.m1.1.1.cmml" xref="S2.p2.14.m1.1.1">𝑙</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.p2.14.m1.1c">l</annotation></semantics></math> to denote the weights associated with the <math id="S2.p2.15.m2.1" class="ltx_Math" alttext="l" display="inline"><semantics id="S2.p2.15.m2.1a"><mi id="S2.p2.15.m2.1.1" xref="S2.p2.15.m2.1.1.cmml">l</mi><annotation-xml encoding="MathML-Content" id="S2.p2.15.m2.1b"><ci id="S2.p2.15.m2.1.1.cmml" xref="S2.p2.15.m2.1.1">𝑙</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.p2.15.m2.1c">l</annotation></semantics></math><sup id="S2.p2.16.1" class="ltx_sup">th</sup> layer, <math id="S2.p2.16.m3.2" class="ltx_Math" alttext="\operatorname{LN}(\cdot)" display="inline"><semantics id="S2.p2.16.m3.2a"><mrow id="S2.p2.16.m3.2.3.2" xref="S2.p2.16.m3.2.3.1.cmml"><mi id="S2.p2.16.m3.1.1" xref="S2.p2.16.m3.1.1.cmml">LN</mi><mo id="S2.p2.16.m3.2.3.2a" xref="S2.p2.16.m3.2.3.1.cmml">⁡</mo><mrow id="S2.p2.16.m3.2.3.2.1" xref="S2.p2.16.m3.2.3.1.cmml"><mo stretchy="false" id="S2.p2.16.m3.2.3.2.1.1" xref="S2.p2.16.m3.2.3.1.cmml">(</mo><mo lspace="0em" rspace="0em" id="S2.p2.16.m3.2.2" xref="S2.p2.16.m3.2.2.cmml">⋅</mo><mo stretchy="false" id="S2.p2.16.m3.2.3.2.1.2" xref="S2.p2.16.m3.2.3.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.p2.16.m3.2b"><apply id="S2.p2.16.m3.2.3.1.cmml" xref="S2.p2.16.m3.2.3.2"><ci id="S2.p2.16.m3.1.1.cmml" xref="S2.p2.16.m3.1.1">LN</ci><ci id="S2.p2.16.m3.2.2.cmml" xref="S2.p2.16.m3.2.2">⋅</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.p2.16.m3.2c">\operatorname{LN}(\cdot)</annotation></semantics></math> represents the layernorm <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib3" title="" class="ltx_ref">3</a>]</cite>.</p>
</div>
<div id="S2.p3" class="ltx_para">
<p id="S2.p3.1" class="ltx_p"><span id="S2.p3.1.1" class="ltx_text ltx_font_bold">Partial Personalization Scheme for MSA Layer in FL.</span> We propose a model personalization scheme for ViT in FL by keeping a designed percentage of weights in the attention layers residing locally during FL training, while the rest are shared across all clients. Specifically, a proportion of MSAs is personalized in each layer to learn local personalized attention representations from heterogeneous CT data, while the rest parameters retains globally shared to extract the common attention representations. We write the <math id="S2.p3.1.m1.1" class="ltx_Math" alttext="l" display="inline"><semantics id="S2.p3.1.m1.1a"><mi id="S2.p3.1.m1.1.1" xref="S2.p3.1.m1.1.1.cmml">l</mi><annotation-xml encoding="MathML-Content" id="S2.p3.1.m1.1b"><ci id="S2.p3.1.m1.1.1.cmml" xref="S2.p3.1.m1.1.1">𝑙</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.p3.1.m1.1c">l</annotation></semantics></math><sup id="S2.p3.1.2" class="ltx_sup">th</sup> MSA layer as</p>
<table id="S2.E2" class="ltx_equationgroup ltx_eqn_table">
<tbody>
<tr id="S2.E2X" class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_eqn_cell"></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math id="S2.E2X.2.1.1.m1.6" class="ltx_Math" alttext="\displaystyle=\mathbf{z}_{l-1}\mathbf{U}_{\mathbf{qkv},l,k},~{}~{}\text{for}~{}~{}k=1,\cdots,K_{l};" display="inline"><semantics id="S2.E2X.2.1.1.m1.6a"><mrow id="S2.E2X.2.1.1.m1.6.6.1"><mrow id="S2.E2X.2.1.1.m1.6.6.1.1.2" xref="S2.E2X.2.1.1.m1.6.6.1.1.3.cmml"><mrow id="S2.E2X.2.1.1.m1.6.6.1.1.1.1" xref="S2.E2X.2.1.1.m1.6.6.1.1.1.1.cmml"><mi id="S2.E2X.2.1.1.m1.6.6.1.1.1.1.2" xref="S2.E2X.2.1.1.m1.6.6.1.1.1.1.2.cmml"></mi><mo id="S2.E2X.2.1.1.m1.6.6.1.1.1.1.1" xref="S2.E2X.2.1.1.m1.6.6.1.1.1.1.1.cmml">=</mo><mrow id="S2.E2X.2.1.1.m1.6.6.1.1.1.1.3" xref="S2.E2X.2.1.1.m1.6.6.1.1.1.1.3.cmml"><msub id="S2.E2X.2.1.1.m1.6.6.1.1.1.1.3.2" xref="S2.E2X.2.1.1.m1.6.6.1.1.1.1.3.2.cmml"><mi id="S2.E2X.2.1.1.m1.6.6.1.1.1.1.3.2.2" xref="S2.E2X.2.1.1.m1.6.6.1.1.1.1.3.2.2.cmml">𝐳</mi><mrow id="S2.E2X.2.1.1.m1.6.6.1.1.1.1.3.2.3" xref="S2.E2X.2.1.1.m1.6.6.1.1.1.1.3.2.3.cmml"><mi id="S2.E2X.2.1.1.m1.6.6.1.1.1.1.3.2.3.2" xref="S2.E2X.2.1.1.m1.6.6.1.1.1.1.3.2.3.2.cmml">l</mi><mo id="S2.E2X.2.1.1.m1.6.6.1.1.1.1.3.2.3.1" xref="S2.E2X.2.1.1.m1.6.6.1.1.1.1.3.2.3.1.cmml">−</mo><mn id="S2.E2X.2.1.1.m1.6.6.1.1.1.1.3.2.3.3" xref="S2.E2X.2.1.1.m1.6.6.1.1.1.1.3.2.3.3.cmml">1</mn></mrow></msub><mo lspace="0em" rspace="0em" id="S2.E2X.2.1.1.m1.6.6.1.1.1.1.3.1" xref="S2.E2X.2.1.1.m1.6.6.1.1.1.1.3.1.cmml">​</mo><msub id="S2.E2X.2.1.1.m1.6.6.1.1.1.1.3.3" xref="S2.E2X.2.1.1.m1.6.6.1.1.1.1.3.3.cmml"><mi id="S2.E2X.2.1.1.m1.6.6.1.1.1.1.3.3.2" xref="S2.E2X.2.1.1.m1.6.6.1.1.1.1.3.3.2.cmml">𝐔</mi><mrow id="S2.E2X.2.1.1.m1.3.3.3.5" xref="S2.E2X.2.1.1.m1.3.3.3.4.cmml"><mi id="S2.E2X.2.1.1.m1.1.1.1.1" xref="S2.E2X.2.1.1.m1.1.1.1.1.cmml">𝐪𝐤𝐯</mi><mo id="S2.E2X.2.1.1.m1.3.3.3.5.1" xref="S2.E2X.2.1.1.m1.3.3.3.4.cmml">,</mo><mi id="S2.E2X.2.1.1.m1.2.2.2.2" xref="S2.E2X.2.1.1.m1.2.2.2.2.cmml">l</mi><mo id="S2.E2X.2.1.1.m1.3.3.3.5.2" xref="S2.E2X.2.1.1.m1.3.3.3.4.cmml">,</mo><mi id="S2.E2X.2.1.1.m1.3.3.3.3" xref="S2.E2X.2.1.1.m1.3.3.3.3.cmml">k</mi></mrow></msub></mrow></mrow><mo rspace="0.827em" id="S2.E2X.2.1.1.m1.6.6.1.1.2.3" xref="S2.E2X.2.1.1.m1.6.6.1.1.3a.cmml">,</mo><mrow id="S2.E2X.2.1.1.m1.6.6.1.1.2.2" xref="S2.E2X.2.1.1.m1.6.6.1.1.2.2.cmml"><mrow id="S2.E2X.2.1.1.m1.6.6.1.1.2.2.3" xref="S2.E2X.2.1.1.m1.6.6.1.1.2.2.3.cmml"><mtext id="S2.E2X.2.1.1.m1.6.6.1.1.2.2.3.2" xref="S2.E2X.2.1.1.m1.6.6.1.1.2.2.3.2a.cmml">for</mtext><mo lspace="0.660em" rspace="0em" id="S2.E2X.2.1.1.m1.6.6.1.1.2.2.3.1" xref="S2.E2X.2.1.1.m1.6.6.1.1.2.2.3.1.cmml">​</mo><mi id="S2.E2X.2.1.1.m1.6.6.1.1.2.2.3.3" xref="S2.E2X.2.1.1.m1.6.6.1.1.2.2.3.3.cmml">k</mi></mrow><mo id="S2.E2X.2.1.1.m1.6.6.1.1.2.2.2" xref="S2.E2X.2.1.1.m1.6.6.1.1.2.2.2.cmml">=</mo><mrow id="S2.E2X.2.1.1.m1.6.6.1.1.2.2.1.1" xref="S2.E2X.2.1.1.m1.6.6.1.1.2.2.1.2.cmml"><mn id="S2.E2X.2.1.1.m1.4.4" xref="S2.E2X.2.1.1.m1.4.4.cmml">1</mn><mo id="S2.E2X.2.1.1.m1.6.6.1.1.2.2.1.1.2" xref="S2.E2X.2.1.1.m1.6.6.1.1.2.2.1.2.cmml">,</mo><mi mathvariant="normal" id="S2.E2X.2.1.1.m1.5.5" xref="S2.E2X.2.1.1.m1.5.5.cmml">⋯</mi><mo id="S2.E2X.2.1.1.m1.6.6.1.1.2.2.1.1.3" xref="S2.E2X.2.1.1.m1.6.6.1.1.2.2.1.2.cmml">,</mo><msub id="S2.E2X.2.1.1.m1.6.6.1.1.2.2.1.1.1" xref="S2.E2X.2.1.1.m1.6.6.1.1.2.2.1.1.1.cmml"><mi id="S2.E2X.2.1.1.m1.6.6.1.1.2.2.1.1.1.2" xref="S2.E2X.2.1.1.m1.6.6.1.1.2.2.1.1.1.2.cmml">K</mi><mi id="S2.E2X.2.1.1.m1.6.6.1.1.2.2.1.1.1.3" xref="S2.E2X.2.1.1.m1.6.6.1.1.2.2.1.1.1.3.cmml">l</mi></msub></mrow></mrow></mrow><mo id="S2.E2X.2.1.1.m1.6.6.1.2">;</mo></mrow><annotation-xml encoding="MathML-Content" id="S2.E2X.2.1.1.m1.6b"><apply id="S2.E2X.2.1.1.m1.6.6.1.1.3.cmml" xref="S2.E2X.2.1.1.m1.6.6.1.1.2"><csymbol cd="ambiguous" id="S2.E2X.2.1.1.m1.6.6.1.1.3a.cmml" xref="S2.E2X.2.1.1.m1.6.6.1.1.2.3">formulae-sequence</csymbol><apply id="S2.E2X.2.1.1.m1.6.6.1.1.1.1.cmml" xref="S2.E2X.2.1.1.m1.6.6.1.1.1.1"><eq id="S2.E2X.2.1.1.m1.6.6.1.1.1.1.1.cmml" xref="S2.E2X.2.1.1.m1.6.6.1.1.1.1.1"></eq><csymbol cd="latexml" id="S2.E2X.2.1.1.m1.6.6.1.1.1.1.2.cmml" xref="S2.E2X.2.1.1.m1.6.6.1.1.1.1.2">absent</csymbol><apply id="S2.E2X.2.1.1.m1.6.6.1.1.1.1.3.cmml" xref="S2.E2X.2.1.1.m1.6.6.1.1.1.1.3"><times id="S2.E2X.2.1.1.m1.6.6.1.1.1.1.3.1.cmml" xref="S2.E2X.2.1.1.m1.6.6.1.1.1.1.3.1"></times><apply id="S2.E2X.2.1.1.m1.6.6.1.1.1.1.3.2.cmml" xref="S2.E2X.2.1.1.m1.6.6.1.1.1.1.3.2"><csymbol cd="ambiguous" id="S2.E2X.2.1.1.m1.6.6.1.1.1.1.3.2.1.cmml" xref="S2.E2X.2.1.1.m1.6.6.1.1.1.1.3.2">subscript</csymbol><ci id="S2.E2X.2.1.1.m1.6.6.1.1.1.1.3.2.2.cmml" xref="S2.E2X.2.1.1.m1.6.6.1.1.1.1.3.2.2">𝐳</ci><apply id="S2.E2X.2.1.1.m1.6.6.1.1.1.1.3.2.3.cmml" xref="S2.E2X.2.1.1.m1.6.6.1.1.1.1.3.2.3"><minus id="S2.E2X.2.1.1.m1.6.6.1.1.1.1.3.2.3.1.cmml" xref="S2.E2X.2.1.1.m1.6.6.1.1.1.1.3.2.3.1"></minus><ci id="S2.E2X.2.1.1.m1.6.6.1.1.1.1.3.2.3.2.cmml" xref="S2.E2X.2.1.1.m1.6.6.1.1.1.1.3.2.3.2">𝑙</ci><cn type="integer" id="S2.E2X.2.1.1.m1.6.6.1.1.1.1.3.2.3.3.cmml" xref="S2.E2X.2.1.1.m1.6.6.1.1.1.1.3.2.3.3">1</cn></apply></apply><apply id="S2.E2X.2.1.1.m1.6.6.1.1.1.1.3.3.cmml" xref="S2.E2X.2.1.1.m1.6.6.1.1.1.1.3.3"><csymbol cd="ambiguous" id="S2.E2X.2.1.1.m1.6.6.1.1.1.1.3.3.1.cmml" xref="S2.E2X.2.1.1.m1.6.6.1.1.1.1.3.3">subscript</csymbol><ci id="S2.E2X.2.1.1.m1.6.6.1.1.1.1.3.3.2.cmml" xref="S2.E2X.2.1.1.m1.6.6.1.1.1.1.3.3.2">𝐔</ci><list id="S2.E2X.2.1.1.m1.3.3.3.4.cmml" xref="S2.E2X.2.1.1.m1.3.3.3.5"><ci id="S2.E2X.2.1.1.m1.1.1.1.1.cmml" xref="S2.E2X.2.1.1.m1.1.1.1.1">𝐪𝐤𝐯</ci><ci id="S2.E2X.2.1.1.m1.2.2.2.2.cmml" xref="S2.E2X.2.1.1.m1.2.2.2.2">𝑙</ci><ci id="S2.E2X.2.1.1.m1.3.3.3.3.cmml" xref="S2.E2X.2.1.1.m1.3.3.3.3">𝑘</ci></list></apply></apply></apply><apply id="S2.E2X.2.1.1.m1.6.6.1.1.2.2.cmml" xref="S2.E2X.2.1.1.m1.6.6.1.1.2.2"><eq id="S2.E2X.2.1.1.m1.6.6.1.1.2.2.2.cmml" xref="S2.E2X.2.1.1.m1.6.6.1.1.2.2.2"></eq><apply id="S2.E2X.2.1.1.m1.6.6.1.1.2.2.3.cmml" xref="S2.E2X.2.1.1.m1.6.6.1.1.2.2.3"><times id="S2.E2X.2.1.1.m1.6.6.1.1.2.2.3.1.cmml" xref="S2.E2X.2.1.1.m1.6.6.1.1.2.2.3.1"></times><ci id="S2.E2X.2.1.1.m1.6.6.1.1.2.2.3.2a.cmml" xref="S2.E2X.2.1.1.m1.6.6.1.1.2.2.3.2"><mtext id="S2.E2X.2.1.1.m1.6.6.1.1.2.2.3.2.cmml" xref="S2.E2X.2.1.1.m1.6.6.1.1.2.2.3.2">for</mtext></ci><ci id="S2.E2X.2.1.1.m1.6.6.1.1.2.2.3.3.cmml" xref="S2.E2X.2.1.1.m1.6.6.1.1.2.2.3.3">𝑘</ci></apply><list id="S2.E2X.2.1.1.m1.6.6.1.1.2.2.1.2.cmml" xref="S2.E2X.2.1.1.m1.6.6.1.1.2.2.1.1"><cn type="integer" id="S2.E2X.2.1.1.m1.4.4.cmml" xref="S2.E2X.2.1.1.m1.4.4">1</cn><ci id="S2.E2X.2.1.1.m1.5.5.cmml" xref="S2.E2X.2.1.1.m1.5.5">⋯</ci><apply id="S2.E2X.2.1.1.m1.6.6.1.1.2.2.1.1.1.cmml" xref="S2.E2X.2.1.1.m1.6.6.1.1.2.2.1.1.1"><csymbol cd="ambiguous" id="S2.E2X.2.1.1.m1.6.6.1.1.2.2.1.1.1.1.cmml" xref="S2.E2X.2.1.1.m1.6.6.1.1.2.2.1.1.1">subscript</csymbol><ci id="S2.E2X.2.1.1.m1.6.6.1.1.2.2.1.1.1.2.cmml" xref="S2.E2X.2.1.1.m1.6.6.1.1.2.2.1.1.1.2">𝐾</ci><ci id="S2.E2X.2.1.1.m1.6.6.1.1.2.2.1.1.1.3.cmml" xref="S2.E2X.2.1.1.m1.6.6.1.1.2.2.1.1.1.3">𝑙</ci></apply></list></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.E2X.2.1.1.m1.6c">\displaystyle=\mathbf{z}_{l-1}\mathbf{U}_{\mathbf{qkv},l,k},~{}~{}\text{for}~{}~{}k=1,\cdots,K_{l};</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="3" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equationgroup ltx_align_right">(2)</span></td>
</tr>
<tr id="S2.E2Xa" class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math id="S2.E2Xa.2.1.1.m1.3" class="ltx_Math" alttext="\displaystyle SA_{l,k}(\mathbf{z}_{l-1})" display="inline"><semantics id="S2.E2Xa.2.1.1.m1.3a"><mrow id="S2.E2Xa.2.1.1.m1.3.3" xref="S2.E2Xa.2.1.1.m1.3.3.cmml"><mi id="S2.E2Xa.2.1.1.m1.3.3.3" xref="S2.E2Xa.2.1.1.m1.3.3.3.cmml">S</mi><mo lspace="0em" rspace="0em" id="S2.E2Xa.2.1.1.m1.3.3.2" xref="S2.E2Xa.2.1.1.m1.3.3.2.cmml">​</mo><msub id="S2.E2Xa.2.1.1.m1.3.3.4" xref="S2.E2Xa.2.1.1.m1.3.3.4.cmml"><mi id="S2.E2Xa.2.1.1.m1.3.3.4.2" xref="S2.E2Xa.2.1.1.m1.3.3.4.2.cmml">A</mi><mrow id="S2.E2Xa.2.1.1.m1.2.2.2.4" xref="S2.E2Xa.2.1.1.m1.2.2.2.3.cmml"><mi id="S2.E2Xa.2.1.1.m1.1.1.1.1" xref="S2.E2Xa.2.1.1.m1.1.1.1.1.cmml">l</mi><mo id="S2.E2Xa.2.1.1.m1.2.2.2.4.1" xref="S2.E2Xa.2.1.1.m1.2.2.2.3.cmml">,</mo><mi id="S2.E2Xa.2.1.1.m1.2.2.2.2" xref="S2.E2Xa.2.1.1.m1.2.2.2.2.cmml">k</mi></mrow></msub><mo lspace="0em" rspace="0em" id="S2.E2Xa.2.1.1.m1.3.3.2a" xref="S2.E2Xa.2.1.1.m1.3.3.2.cmml">​</mo><mrow id="S2.E2Xa.2.1.1.m1.3.3.1.1" xref="S2.E2Xa.2.1.1.m1.3.3.1.1.1.cmml"><mo stretchy="false" id="S2.E2Xa.2.1.1.m1.3.3.1.1.2" xref="S2.E2Xa.2.1.1.m1.3.3.1.1.1.cmml">(</mo><msub id="S2.E2Xa.2.1.1.m1.3.3.1.1.1" xref="S2.E2Xa.2.1.1.m1.3.3.1.1.1.cmml"><mi id="S2.E2Xa.2.1.1.m1.3.3.1.1.1.2" xref="S2.E2Xa.2.1.1.m1.3.3.1.1.1.2.cmml">𝐳</mi><mrow id="S2.E2Xa.2.1.1.m1.3.3.1.1.1.3" xref="S2.E2Xa.2.1.1.m1.3.3.1.1.1.3.cmml"><mi id="S2.E2Xa.2.1.1.m1.3.3.1.1.1.3.2" xref="S2.E2Xa.2.1.1.m1.3.3.1.1.1.3.2.cmml">l</mi><mo id="S2.E2Xa.2.1.1.m1.3.3.1.1.1.3.1" xref="S2.E2Xa.2.1.1.m1.3.3.1.1.1.3.1.cmml">−</mo><mn id="S2.E2Xa.2.1.1.m1.3.3.1.1.1.3.3" xref="S2.E2Xa.2.1.1.m1.3.3.1.1.1.3.3.cmml">1</mn></mrow></msub><mo stretchy="false" id="S2.E2Xa.2.1.1.m1.3.3.1.1.3" xref="S2.E2Xa.2.1.1.m1.3.3.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.E2Xa.2.1.1.m1.3b"><apply id="S2.E2Xa.2.1.1.m1.3.3.cmml" xref="S2.E2Xa.2.1.1.m1.3.3"><times id="S2.E2Xa.2.1.1.m1.3.3.2.cmml" xref="S2.E2Xa.2.1.1.m1.3.3.2"></times><ci id="S2.E2Xa.2.1.1.m1.3.3.3.cmml" xref="S2.E2Xa.2.1.1.m1.3.3.3">𝑆</ci><apply id="S2.E2Xa.2.1.1.m1.3.3.4.cmml" xref="S2.E2Xa.2.1.1.m1.3.3.4"><csymbol cd="ambiguous" id="S2.E2Xa.2.1.1.m1.3.3.4.1.cmml" xref="S2.E2Xa.2.1.1.m1.3.3.4">subscript</csymbol><ci id="S2.E2Xa.2.1.1.m1.3.3.4.2.cmml" xref="S2.E2Xa.2.1.1.m1.3.3.4.2">𝐴</ci><list id="S2.E2Xa.2.1.1.m1.2.2.2.3.cmml" xref="S2.E2Xa.2.1.1.m1.2.2.2.4"><ci id="S2.E2Xa.2.1.1.m1.1.1.1.1.cmml" xref="S2.E2Xa.2.1.1.m1.1.1.1.1">𝑙</ci><ci id="S2.E2Xa.2.1.1.m1.2.2.2.2.cmml" xref="S2.E2Xa.2.1.1.m1.2.2.2.2">𝑘</ci></list></apply><apply id="S2.E2Xa.2.1.1.m1.3.3.1.1.1.cmml" xref="S2.E2Xa.2.1.1.m1.3.3.1.1"><csymbol cd="ambiguous" id="S2.E2Xa.2.1.1.m1.3.3.1.1.1.1.cmml" xref="S2.E2Xa.2.1.1.m1.3.3.1.1">subscript</csymbol><ci id="S2.E2Xa.2.1.1.m1.3.3.1.1.1.2.cmml" xref="S2.E2Xa.2.1.1.m1.3.3.1.1.1.2">𝐳</ci><apply id="S2.E2Xa.2.1.1.m1.3.3.1.1.1.3.cmml" xref="S2.E2Xa.2.1.1.m1.3.3.1.1.1.3"><minus id="S2.E2Xa.2.1.1.m1.3.3.1.1.1.3.1.cmml" xref="S2.E2Xa.2.1.1.m1.3.3.1.1.1.3.1"></minus><ci id="S2.E2Xa.2.1.1.m1.3.3.1.1.1.3.2.cmml" xref="S2.E2Xa.2.1.1.m1.3.3.1.1.1.3.2">𝑙</ci><cn type="integer" id="S2.E2Xa.2.1.1.m1.3.3.1.1.1.3.3.cmml" xref="S2.E2Xa.2.1.1.m1.3.3.1.1.1.3.3">1</cn></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.E2Xa.2.1.1.m1.3c">\displaystyle SA_{l,k}(\mathbf{z}_{l-1})</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math id="S2.E2Xa.3.2.2.m1.8" class="ltx_Math" alttext="\displaystyle=\operatorname{softmax}(\mathbf{q}_{l,k}\mathbf{k}_{l,k}^{T}/\sqrt{D_{h}})\mathbf{v}_{l,k}" display="inline"><semantics id="S2.E2Xa.3.2.2.m1.8a"><mrow id="S2.E2Xa.3.2.2.m1.8.8" xref="S2.E2Xa.3.2.2.m1.8.8.cmml"><mi id="S2.E2Xa.3.2.2.m1.8.8.3" xref="S2.E2Xa.3.2.2.m1.8.8.3.cmml"></mi><mo id="S2.E2Xa.3.2.2.m1.8.8.2" xref="S2.E2Xa.3.2.2.m1.8.8.2.cmml">=</mo><mrow id="S2.E2Xa.3.2.2.m1.8.8.1" xref="S2.E2Xa.3.2.2.m1.8.8.1.cmml"><mrow id="S2.E2Xa.3.2.2.m1.8.8.1.1.1" xref="S2.E2Xa.3.2.2.m1.8.8.1.1.2.cmml"><mi id="S2.E2Xa.3.2.2.m1.7.7" xref="S2.E2Xa.3.2.2.m1.7.7.cmml">softmax</mi><mo id="S2.E2Xa.3.2.2.m1.8.8.1.1.1a" xref="S2.E2Xa.3.2.2.m1.8.8.1.1.2.cmml">⁡</mo><mrow id="S2.E2Xa.3.2.2.m1.8.8.1.1.1.1" xref="S2.E2Xa.3.2.2.m1.8.8.1.1.2.cmml"><mo stretchy="false" id="S2.E2Xa.3.2.2.m1.8.8.1.1.1.1.2" xref="S2.E2Xa.3.2.2.m1.8.8.1.1.2.cmml">(</mo><mrow id="S2.E2Xa.3.2.2.m1.8.8.1.1.1.1.1" xref="S2.E2Xa.3.2.2.m1.8.8.1.1.1.1.1.cmml"><mrow id="S2.E2Xa.3.2.2.m1.8.8.1.1.1.1.1.2" xref="S2.E2Xa.3.2.2.m1.8.8.1.1.1.1.1.2.cmml"><msub id="S2.E2Xa.3.2.2.m1.8.8.1.1.1.1.1.2.2" xref="S2.E2Xa.3.2.2.m1.8.8.1.1.1.1.1.2.2.cmml"><mi id="S2.E2Xa.3.2.2.m1.8.8.1.1.1.1.1.2.2.2" xref="S2.E2Xa.3.2.2.m1.8.8.1.1.1.1.1.2.2.2.cmml">𝐪</mi><mrow id="S2.E2Xa.3.2.2.m1.2.2.2.4" xref="S2.E2Xa.3.2.2.m1.2.2.2.3.cmml"><mi id="S2.E2Xa.3.2.2.m1.1.1.1.1" xref="S2.E2Xa.3.2.2.m1.1.1.1.1.cmml">l</mi><mo id="S2.E2Xa.3.2.2.m1.2.2.2.4.1" xref="S2.E2Xa.3.2.2.m1.2.2.2.3.cmml">,</mo><mi id="S2.E2Xa.3.2.2.m1.2.2.2.2" xref="S2.E2Xa.3.2.2.m1.2.2.2.2.cmml">k</mi></mrow></msub><mo lspace="0em" rspace="0em" id="S2.E2Xa.3.2.2.m1.8.8.1.1.1.1.1.2.1" xref="S2.E2Xa.3.2.2.m1.8.8.1.1.1.1.1.2.1.cmml">​</mo><msubsup id="S2.E2Xa.3.2.2.m1.8.8.1.1.1.1.1.2.3" xref="S2.E2Xa.3.2.2.m1.8.8.1.1.1.1.1.2.3.cmml"><mi id="S2.E2Xa.3.2.2.m1.8.8.1.1.1.1.1.2.3.2.2" xref="S2.E2Xa.3.2.2.m1.8.8.1.1.1.1.1.2.3.2.2.cmml">𝐤</mi><mrow id="S2.E2Xa.3.2.2.m1.4.4.2.4" xref="S2.E2Xa.3.2.2.m1.4.4.2.3.cmml"><mi id="S2.E2Xa.3.2.2.m1.3.3.1.1" xref="S2.E2Xa.3.2.2.m1.3.3.1.1.cmml">l</mi><mo id="S2.E2Xa.3.2.2.m1.4.4.2.4.1" xref="S2.E2Xa.3.2.2.m1.4.4.2.3.cmml">,</mo><mi id="S2.E2Xa.3.2.2.m1.4.4.2.2" xref="S2.E2Xa.3.2.2.m1.4.4.2.2.cmml">k</mi></mrow><mi id="S2.E2Xa.3.2.2.m1.8.8.1.1.1.1.1.2.3.3" xref="S2.E2Xa.3.2.2.m1.8.8.1.1.1.1.1.2.3.3.cmml">T</mi></msubsup></mrow><mo id="S2.E2Xa.3.2.2.m1.8.8.1.1.1.1.1.1" xref="S2.E2Xa.3.2.2.m1.8.8.1.1.1.1.1.1.cmml">/</mo><msqrt id="S2.E2Xa.3.2.2.m1.8.8.1.1.1.1.1.3" xref="S2.E2Xa.3.2.2.m1.8.8.1.1.1.1.1.3.cmml"><msub id="S2.E2Xa.3.2.2.m1.8.8.1.1.1.1.1.3.2" xref="S2.E2Xa.3.2.2.m1.8.8.1.1.1.1.1.3.2.cmml"><mi id="S2.E2Xa.3.2.2.m1.8.8.1.1.1.1.1.3.2.2" xref="S2.E2Xa.3.2.2.m1.8.8.1.1.1.1.1.3.2.2.cmml">D</mi><mi id="S2.E2Xa.3.2.2.m1.8.8.1.1.1.1.1.3.2.3" xref="S2.E2Xa.3.2.2.m1.8.8.1.1.1.1.1.3.2.3.cmml">h</mi></msub></msqrt></mrow><mo stretchy="false" id="S2.E2Xa.3.2.2.m1.8.8.1.1.1.1.3" xref="S2.E2Xa.3.2.2.m1.8.8.1.1.2.cmml">)</mo></mrow></mrow><mo lspace="0em" rspace="0em" id="S2.E2Xa.3.2.2.m1.8.8.1.2" xref="S2.E2Xa.3.2.2.m1.8.8.1.2.cmml">​</mo><msub id="S2.E2Xa.3.2.2.m1.8.8.1.3" xref="S2.E2Xa.3.2.2.m1.8.8.1.3.cmml"><mi id="S2.E2Xa.3.2.2.m1.8.8.1.3.2" xref="S2.E2Xa.3.2.2.m1.8.8.1.3.2.cmml">𝐯</mi><mrow id="S2.E2Xa.3.2.2.m1.6.6.2.4" xref="S2.E2Xa.3.2.2.m1.6.6.2.3.cmml"><mi id="S2.E2Xa.3.2.2.m1.5.5.1.1" xref="S2.E2Xa.3.2.2.m1.5.5.1.1.cmml">l</mi><mo id="S2.E2Xa.3.2.2.m1.6.6.2.4.1" xref="S2.E2Xa.3.2.2.m1.6.6.2.3.cmml">,</mo><mi id="S2.E2Xa.3.2.2.m1.6.6.2.2" xref="S2.E2Xa.3.2.2.m1.6.6.2.2.cmml">k</mi></mrow></msub></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.E2Xa.3.2.2.m1.8b"><apply id="S2.E2Xa.3.2.2.m1.8.8.cmml" xref="S2.E2Xa.3.2.2.m1.8.8"><eq id="S2.E2Xa.3.2.2.m1.8.8.2.cmml" xref="S2.E2Xa.3.2.2.m1.8.8.2"></eq><csymbol cd="latexml" id="S2.E2Xa.3.2.2.m1.8.8.3.cmml" xref="S2.E2Xa.3.2.2.m1.8.8.3">absent</csymbol><apply id="S2.E2Xa.3.2.2.m1.8.8.1.cmml" xref="S2.E2Xa.3.2.2.m1.8.8.1"><times id="S2.E2Xa.3.2.2.m1.8.8.1.2.cmml" xref="S2.E2Xa.3.2.2.m1.8.8.1.2"></times><apply id="S2.E2Xa.3.2.2.m1.8.8.1.1.2.cmml" xref="S2.E2Xa.3.2.2.m1.8.8.1.1.1"><ci id="S2.E2Xa.3.2.2.m1.7.7.cmml" xref="S2.E2Xa.3.2.2.m1.7.7">softmax</ci><apply id="S2.E2Xa.3.2.2.m1.8.8.1.1.1.1.1.cmml" xref="S2.E2Xa.3.2.2.m1.8.8.1.1.1.1.1"><divide id="S2.E2Xa.3.2.2.m1.8.8.1.1.1.1.1.1.cmml" xref="S2.E2Xa.3.2.2.m1.8.8.1.1.1.1.1.1"></divide><apply id="S2.E2Xa.3.2.2.m1.8.8.1.1.1.1.1.2.cmml" xref="S2.E2Xa.3.2.2.m1.8.8.1.1.1.1.1.2"><times id="S2.E2Xa.3.2.2.m1.8.8.1.1.1.1.1.2.1.cmml" xref="S2.E2Xa.3.2.2.m1.8.8.1.1.1.1.1.2.1"></times><apply id="S2.E2Xa.3.2.2.m1.8.8.1.1.1.1.1.2.2.cmml" xref="S2.E2Xa.3.2.2.m1.8.8.1.1.1.1.1.2.2"><csymbol cd="ambiguous" id="S2.E2Xa.3.2.2.m1.8.8.1.1.1.1.1.2.2.1.cmml" xref="S2.E2Xa.3.2.2.m1.8.8.1.1.1.1.1.2.2">subscript</csymbol><ci id="S2.E2Xa.3.2.2.m1.8.8.1.1.1.1.1.2.2.2.cmml" xref="S2.E2Xa.3.2.2.m1.8.8.1.1.1.1.1.2.2.2">𝐪</ci><list id="S2.E2Xa.3.2.2.m1.2.2.2.3.cmml" xref="S2.E2Xa.3.2.2.m1.2.2.2.4"><ci id="S2.E2Xa.3.2.2.m1.1.1.1.1.cmml" xref="S2.E2Xa.3.2.2.m1.1.1.1.1">𝑙</ci><ci id="S2.E2Xa.3.2.2.m1.2.2.2.2.cmml" xref="S2.E2Xa.3.2.2.m1.2.2.2.2">𝑘</ci></list></apply><apply id="S2.E2Xa.3.2.2.m1.8.8.1.1.1.1.1.2.3.cmml" xref="S2.E2Xa.3.2.2.m1.8.8.1.1.1.1.1.2.3"><csymbol cd="ambiguous" id="S2.E2Xa.3.2.2.m1.8.8.1.1.1.1.1.2.3.1.cmml" xref="S2.E2Xa.3.2.2.m1.8.8.1.1.1.1.1.2.3">superscript</csymbol><apply id="S2.E2Xa.3.2.2.m1.8.8.1.1.1.1.1.2.3.2.cmml" xref="S2.E2Xa.3.2.2.m1.8.8.1.1.1.1.1.2.3"><csymbol cd="ambiguous" id="S2.E2Xa.3.2.2.m1.8.8.1.1.1.1.1.2.3.2.1.cmml" xref="S2.E2Xa.3.2.2.m1.8.8.1.1.1.1.1.2.3">subscript</csymbol><ci id="S2.E2Xa.3.2.2.m1.8.8.1.1.1.1.1.2.3.2.2.cmml" xref="S2.E2Xa.3.2.2.m1.8.8.1.1.1.1.1.2.3.2.2">𝐤</ci><list id="S2.E2Xa.3.2.2.m1.4.4.2.3.cmml" xref="S2.E2Xa.3.2.2.m1.4.4.2.4"><ci id="S2.E2Xa.3.2.2.m1.3.3.1.1.cmml" xref="S2.E2Xa.3.2.2.m1.3.3.1.1">𝑙</ci><ci id="S2.E2Xa.3.2.2.m1.4.4.2.2.cmml" xref="S2.E2Xa.3.2.2.m1.4.4.2.2">𝑘</ci></list></apply><ci id="S2.E2Xa.3.2.2.m1.8.8.1.1.1.1.1.2.3.3.cmml" xref="S2.E2Xa.3.2.2.m1.8.8.1.1.1.1.1.2.3.3">𝑇</ci></apply></apply><apply id="S2.E2Xa.3.2.2.m1.8.8.1.1.1.1.1.3.cmml" xref="S2.E2Xa.3.2.2.m1.8.8.1.1.1.1.1.3"><root id="S2.E2Xa.3.2.2.m1.8.8.1.1.1.1.1.3a.cmml" xref="S2.E2Xa.3.2.2.m1.8.8.1.1.1.1.1.3"></root><apply id="S2.E2Xa.3.2.2.m1.8.8.1.1.1.1.1.3.2.cmml" xref="S2.E2Xa.3.2.2.m1.8.8.1.1.1.1.1.3.2"><csymbol cd="ambiguous" id="S2.E2Xa.3.2.2.m1.8.8.1.1.1.1.1.3.2.1.cmml" xref="S2.E2Xa.3.2.2.m1.8.8.1.1.1.1.1.3.2">subscript</csymbol><ci id="S2.E2Xa.3.2.2.m1.8.8.1.1.1.1.1.3.2.2.cmml" xref="S2.E2Xa.3.2.2.m1.8.8.1.1.1.1.1.3.2.2">𝐷</ci><ci id="S2.E2Xa.3.2.2.m1.8.8.1.1.1.1.1.3.2.3.cmml" xref="S2.E2Xa.3.2.2.m1.8.8.1.1.1.1.1.3.2.3">ℎ</ci></apply></apply></apply></apply><apply id="S2.E2Xa.3.2.2.m1.8.8.1.3.cmml" xref="S2.E2Xa.3.2.2.m1.8.8.1.3"><csymbol cd="ambiguous" id="S2.E2Xa.3.2.2.m1.8.8.1.3.1.cmml" xref="S2.E2Xa.3.2.2.m1.8.8.1.3">subscript</csymbol><ci id="S2.E2Xa.3.2.2.m1.8.8.1.3.2.cmml" xref="S2.E2Xa.3.2.2.m1.8.8.1.3.2">𝐯</ci><list id="S2.E2Xa.3.2.2.m1.6.6.2.3.cmml" xref="S2.E2Xa.3.2.2.m1.6.6.2.4"><ci id="S2.E2Xa.3.2.2.m1.5.5.1.1.cmml" xref="S2.E2Xa.3.2.2.m1.5.5.1.1">𝑙</ci><ci id="S2.E2Xa.3.2.2.m1.6.6.2.2.cmml" xref="S2.E2Xa.3.2.2.m1.6.6.2.2">𝑘</ci></list></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.E2Xa.3.2.2.m1.8c">\displaystyle=\operatorname{softmax}(\mathbf{q}_{l,k}\mathbf{k}_{l,k}^{T}/\sqrt{D_{h}})\mathbf{v}_{l,k}</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr>
<tr id="S2.E2Xb" class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math id="S2.E2Xb.2.1.1.m1.1" class="ltx_Math" alttext="\displaystyle MSA_{l}(\mathbf{z}_{l})" display="inline"><semantics id="S2.E2Xb.2.1.1.m1.1a"><mrow id="S2.E2Xb.2.1.1.m1.1.1" xref="S2.E2Xb.2.1.1.m1.1.1.cmml"><mi id="S2.E2Xb.2.1.1.m1.1.1.3" xref="S2.E2Xb.2.1.1.m1.1.1.3.cmml">M</mi><mo lspace="0em" rspace="0em" id="S2.E2Xb.2.1.1.m1.1.1.2" xref="S2.E2Xb.2.1.1.m1.1.1.2.cmml">​</mo><mi id="S2.E2Xb.2.1.1.m1.1.1.4" xref="S2.E2Xb.2.1.1.m1.1.1.4.cmml">S</mi><mo lspace="0em" rspace="0em" id="S2.E2Xb.2.1.1.m1.1.1.2a" xref="S2.E2Xb.2.1.1.m1.1.1.2.cmml">​</mo><msub id="S2.E2Xb.2.1.1.m1.1.1.5" xref="S2.E2Xb.2.1.1.m1.1.1.5.cmml"><mi id="S2.E2Xb.2.1.1.m1.1.1.5.2" xref="S2.E2Xb.2.1.1.m1.1.1.5.2.cmml">A</mi><mi id="S2.E2Xb.2.1.1.m1.1.1.5.3" xref="S2.E2Xb.2.1.1.m1.1.1.5.3.cmml">l</mi></msub><mo lspace="0em" rspace="0em" id="S2.E2Xb.2.1.1.m1.1.1.2b" xref="S2.E2Xb.2.1.1.m1.1.1.2.cmml">​</mo><mrow id="S2.E2Xb.2.1.1.m1.1.1.1.1" xref="S2.E2Xb.2.1.1.m1.1.1.1.1.1.cmml"><mo stretchy="false" id="S2.E2Xb.2.1.1.m1.1.1.1.1.2" xref="S2.E2Xb.2.1.1.m1.1.1.1.1.1.cmml">(</mo><msub id="S2.E2Xb.2.1.1.m1.1.1.1.1.1" xref="S2.E2Xb.2.1.1.m1.1.1.1.1.1.cmml"><mi id="S2.E2Xb.2.1.1.m1.1.1.1.1.1.2" xref="S2.E2Xb.2.1.1.m1.1.1.1.1.1.2.cmml">𝐳</mi><mi id="S2.E2Xb.2.1.1.m1.1.1.1.1.1.3" xref="S2.E2Xb.2.1.1.m1.1.1.1.1.1.3.cmml">l</mi></msub><mo stretchy="false" id="S2.E2Xb.2.1.1.m1.1.1.1.1.3" xref="S2.E2Xb.2.1.1.m1.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.E2Xb.2.1.1.m1.1b"><apply id="S2.E2Xb.2.1.1.m1.1.1.cmml" xref="S2.E2Xb.2.1.1.m1.1.1"><times id="S2.E2Xb.2.1.1.m1.1.1.2.cmml" xref="S2.E2Xb.2.1.1.m1.1.1.2"></times><ci id="S2.E2Xb.2.1.1.m1.1.1.3.cmml" xref="S2.E2Xb.2.1.1.m1.1.1.3">𝑀</ci><ci id="S2.E2Xb.2.1.1.m1.1.1.4.cmml" xref="S2.E2Xb.2.1.1.m1.1.1.4">𝑆</ci><apply id="S2.E2Xb.2.1.1.m1.1.1.5.cmml" xref="S2.E2Xb.2.1.1.m1.1.1.5"><csymbol cd="ambiguous" id="S2.E2Xb.2.1.1.m1.1.1.5.1.cmml" xref="S2.E2Xb.2.1.1.m1.1.1.5">subscript</csymbol><ci id="S2.E2Xb.2.1.1.m1.1.1.5.2.cmml" xref="S2.E2Xb.2.1.1.m1.1.1.5.2">𝐴</ci><ci id="S2.E2Xb.2.1.1.m1.1.1.5.3.cmml" xref="S2.E2Xb.2.1.1.m1.1.1.5.3">𝑙</ci></apply><apply id="S2.E2Xb.2.1.1.m1.1.1.1.1.1.cmml" xref="S2.E2Xb.2.1.1.m1.1.1.1.1"><csymbol cd="ambiguous" id="S2.E2Xb.2.1.1.m1.1.1.1.1.1.1.cmml" xref="S2.E2Xb.2.1.1.m1.1.1.1.1">subscript</csymbol><ci id="S2.E2Xb.2.1.1.m1.1.1.1.1.1.2.cmml" xref="S2.E2Xb.2.1.1.m1.1.1.1.1.1.2">𝐳</ci><ci id="S2.E2Xb.2.1.1.m1.1.1.1.1.1.3.cmml" xref="S2.E2Xb.2.1.1.m1.1.1.1.1.1.3">𝑙</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.E2Xb.2.1.1.m1.1c">\displaystyle MSA_{l}(\mathbf{z}_{l})</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math id="S2.E2Xb.3.2.2.m1.9" class="ltx_Math" alttext="\displaystyle=[SA_{l,1}(\mathbf{z}_{l-1}),\cdots,SA_{l,K_{l}}(\mathbf{z}_{l-1})]\mathbf{U}_{\mathbf{msa},l}" display="inline"><semantics id="S2.E2Xb.3.2.2.m1.9a"><mrow id="S2.E2Xb.3.2.2.m1.9.9" xref="S2.E2Xb.3.2.2.m1.9.9.cmml"><mi id="S2.E2Xb.3.2.2.m1.9.9.4" xref="S2.E2Xb.3.2.2.m1.9.9.4.cmml"></mi><mo id="S2.E2Xb.3.2.2.m1.9.9.3" xref="S2.E2Xb.3.2.2.m1.9.9.3.cmml">=</mo><mrow id="S2.E2Xb.3.2.2.m1.9.9.2" xref="S2.E2Xb.3.2.2.m1.9.9.2.cmml"><mrow id="S2.E2Xb.3.2.2.m1.9.9.2.2.2" xref="S2.E2Xb.3.2.2.m1.9.9.2.2.3.cmml"><mo stretchy="false" id="S2.E2Xb.3.2.2.m1.9.9.2.2.2.3" xref="S2.E2Xb.3.2.2.m1.9.9.2.2.3.cmml">[</mo><mrow id="S2.E2Xb.3.2.2.m1.8.8.1.1.1.1" xref="S2.E2Xb.3.2.2.m1.8.8.1.1.1.1.cmml"><mi id="S2.E2Xb.3.2.2.m1.8.8.1.1.1.1.3" xref="S2.E2Xb.3.2.2.m1.8.8.1.1.1.1.3.cmml">S</mi><mo lspace="0em" rspace="0em" id="S2.E2Xb.3.2.2.m1.8.8.1.1.1.1.2" xref="S2.E2Xb.3.2.2.m1.8.8.1.1.1.1.2.cmml">​</mo><msub id="S2.E2Xb.3.2.2.m1.8.8.1.1.1.1.4" xref="S2.E2Xb.3.2.2.m1.8.8.1.1.1.1.4.cmml"><mi id="S2.E2Xb.3.2.2.m1.8.8.1.1.1.1.4.2" xref="S2.E2Xb.3.2.2.m1.8.8.1.1.1.1.4.2.cmml">A</mi><mrow id="S2.E2Xb.3.2.2.m1.2.2.2.4" xref="S2.E2Xb.3.2.2.m1.2.2.2.3.cmml"><mi id="S2.E2Xb.3.2.2.m1.1.1.1.1" xref="S2.E2Xb.3.2.2.m1.1.1.1.1.cmml">l</mi><mo id="S2.E2Xb.3.2.2.m1.2.2.2.4.1" xref="S2.E2Xb.3.2.2.m1.2.2.2.3.cmml">,</mo><mn id="S2.E2Xb.3.2.2.m1.2.2.2.2" xref="S2.E2Xb.3.2.2.m1.2.2.2.2.cmml">1</mn></mrow></msub><mo lspace="0em" rspace="0em" id="S2.E2Xb.3.2.2.m1.8.8.1.1.1.1.2a" xref="S2.E2Xb.3.2.2.m1.8.8.1.1.1.1.2.cmml">​</mo><mrow id="S2.E2Xb.3.2.2.m1.8.8.1.1.1.1.1.1" xref="S2.E2Xb.3.2.2.m1.8.8.1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S2.E2Xb.3.2.2.m1.8.8.1.1.1.1.1.1.2" xref="S2.E2Xb.3.2.2.m1.8.8.1.1.1.1.1.1.1.cmml">(</mo><msub id="S2.E2Xb.3.2.2.m1.8.8.1.1.1.1.1.1.1" xref="S2.E2Xb.3.2.2.m1.8.8.1.1.1.1.1.1.1.cmml"><mi id="S2.E2Xb.3.2.2.m1.8.8.1.1.1.1.1.1.1.2" xref="S2.E2Xb.3.2.2.m1.8.8.1.1.1.1.1.1.1.2.cmml">𝐳</mi><mrow id="S2.E2Xb.3.2.2.m1.8.8.1.1.1.1.1.1.1.3" xref="S2.E2Xb.3.2.2.m1.8.8.1.1.1.1.1.1.1.3.cmml"><mi id="S2.E2Xb.3.2.2.m1.8.8.1.1.1.1.1.1.1.3.2" xref="S2.E2Xb.3.2.2.m1.8.8.1.1.1.1.1.1.1.3.2.cmml">l</mi><mo id="S2.E2Xb.3.2.2.m1.8.8.1.1.1.1.1.1.1.3.1" xref="S2.E2Xb.3.2.2.m1.8.8.1.1.1.1.1.1.1.3.1.cmml">−</mo><mn id="S2.E2Xb.3.2.2.m1.8.8.1.1.1.1.1.1.1.3.3" xref="S2.E2Xb.3.2.2.m1.8.8.1.1.1.1.1.1.1.3.3.cmml">1</mn></mrow></msub><mo stretchy="false" id="S2.E2Xb.3.2.2.m1.8.8.1.1.1.1.1.1.3" xref="S2.E2Xb.3.2.2.m1.8.8.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S2.E2Xb.3.2.2.m1.9.9.2.2.2.4" xref="S2.E2Xb.3.2.2.m1.9.9.2.2.3.cmml">,</mo><mi mathvariant="normal" id="S2.E2Xb.3.2.2.m1.7.7" xref="S2.E2Xb.3.2.2.m1.7.7.cmml">⋯</mi><mo id="S2.E2Xb.3.2.2.m1.9.9.2.2.2.5" xref="S2.E2Xb.3.2.2.m1.9.9.2.2.3.cmml">,</mo><mrow id="S2.E2Xb.3.2.2.m1.9.9.2.2.2.2" xref="S2.E2Xb.3.2.2.m1.9.9.2.2.2.2.cmml"><mi id="S2.E2Xb.3.2.2.m1.9.9.2.2.2.2.3" xref="S2.E2Xb.3.2.2.m1.9.9.2.2.2.2.3.cmml">S</mi><mo lspace="0em" rspace="0em" id="S2.E2Xb.3.2.2.m1.9.9.2.2.2.2.2" xref="S2.E2Xb.3.2.2.m1.9.9.2.2.2.2.2.cmml">​</mo><msub id="S2.E2Xb.3.2.2.m1.9.9.2.2.2.2.4" xref="S2.E2Xb.3.2.2.m1.9.9.2.2.2.2.4.cmml"><mi id="S2.E2Xb.3.2.2.m1.9.9.2.2.2.2.4.2" xref="S2.E2Xb.3.2.2.m1.9.9.2.2.2.2.4.2.cmml">A</mi><mrow id="S2.E2Xb.3.2.2.m1.4.4.2.2" xref="S2.E2Xb.3.2.2.m1.4.4.2.3.cmml"><mi id="S2.E2Xb.3.2.2.m1.3.3.1.1" xref="S2.E2Xb.3.2.2.m1.3.3.1.1.cmml">l</mi><mo id="S2.E2Xb.3.2.2.m1.4.4.2.2.2" xref="S2.E2Xb.3.2.2.m1.4.4.2.3.cmml">,</mo><msub id="S2.E2Xb.3.2.2.m1.4.4.2.2.1" xref="S2.E2Xb.3.2.2.m1.4.4.2.2.1.cmml"><mi id="S2.E2Xb.3.2.2.m1.4.4.2.2.1.2" xref="S2.E2Xb.3.2.2.m1.4.4.2.2.1.2.cmml">K</mi><mi id="S2.E2Xb.3.2.2.m1.4.4.2.2.1.3" xref="S2.E2Xb.3.2.2.m1.4.4.2.2.1.3.cmml">l</mi></msub></mrow></msub><mo lspace="0em" rspace="0em" id="S2.E2Xb.3.2.2.m1.9.9.2.2.2.2.2a" xref="S2.E2Xb.3.2.2.m1.9.9.2.2.2.2.2.cmml">​</mo><mrow id="S2.E2Xb.3.2.2.m1.9.9.2.2.2.2.1.1" xref="S2.E2Xb.3.2.2.m1.9.9.2.2.2.2.1.1.1.cmml"><mo stretchy="false" id="S2.E2Xb.3.2.2.m1.9.9.2.2.2.2.1.1.2" xref="S2.E2Xb.3.2.2.m1.9.9.2.2.2.2.1.1.1.cmml">(</mo><msub id="S2.E2Xb.3.2.2.m1.9.9.2.2.2.2.1.1.1" xref="S2.E2Xb.3.2.2.m1.9.9.2.2.2.2.1.1.1.cmml"><mi id="S2.E2Xb.3.2.2.m1.9.9.2.2.2.2.1.1.1.2" xref="S2.E2Xb.3.2.2.m1.9.9.2.2.2.2.1.1.1.2.cmml">𝐳</mi><mrow id="S2.E2Xb.3.2.2.m1.9.9.2.2.2.2.1.1.1.3" xref="S2.E2Xb.3.2.2.m1.9.9.2.2.2.2.1.1.1.3.cmml"><mi id="S2.E2Xb.3.2.2.m1.9.9.2.2.2.2.1.1.1.3.2" xref="S2.E2Xb.3.2.2.m1.9.9.2.2.2.2.1.1.1.3.2.cmml">l</mi><mo id="S2.E2Xb.3.2.2.m1.9.9.2.2.2.2.1.1.1.3.1" xref="S2.E2Xb.3.2.2.m1.9.9.2.2.2.2.1.1.1.3.1.cmml">−</mo><mn id="S2.E2Xb.3.2.2.m1.9.9.2.2.2.2.1.1.1.3.3" xref="S2.E2Xb.3.2.2.m1.9.9.2.2.2.2.1.1.1.3.3.cmml">1</mn></mrow></msub><mo stretchy="false" id="S2.E2Xb.3.2.2.m1.9.9.2.2.2.2.1.1.3" xref="S2.E2Xb.3.2.2.m1.9.9.2.2.2.2.1.1.1.cmml">)</mo></mrow></mrow><mo stretchy="false" id="S2.E2Xb.3.2.2.m1.9.9.2.2.2.6" xref="S2.E2Xb.3.2.2.m1.9.9.2.2.3.cmml">]</mo></mrow><mo lspace="0em" rspace="0em" id="S2.E2Xb.3.2.2.m1.9.9.2.3" xref="S2.E2Xb.3.2.2.m1.9.9.2.3.cmml">​</mo><msub id="S2.E2Xb.3.2.2.m1.9.9.2.4" xref="S2.E2Xb.3.2.2.m1.9.9.2.4.cmml"><mi id="S2.E2Xb.3.2.2.m1.9.9.2.4.2" xref="S2.E2Xb.3.2.2.m1.9.9.2.4.2.cmml">𝐔</mi><mrow id="S2.E2Xb.3.2.2.m1.6.6.2.4" xref="S2.E2Xb.3.2.2.m1.6.6.2.3.cmml"><mi id="S2.E2Xb.3.2.2.m1.5.5.1.1" xref="S2.E2Xb.3.2.2.m1.5.5.1.1.cmml">𝐦𝐬𝐚</mi><mo id="S2.E2Xb.3.2.2.m1.6.6.2.4.1" xref="S2.E2Xb.3.2.2.m1.6.6.2.3.cmml">,</mo><mi id="S2.E2Xb.3.2.2.m1.6.6.2.2" xref="S2.E2Xb.3.2.2.m1.6.6.2.2.cmml">l</mi></mrow></msub></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.E2Xb.3.2.2.m1.9b"><apply id="S2.E2Xb.3.2.2.m1.9.9.cmml" xref="S2.E2Xb.3.2.2.m1.9.9"><eq id="S2.E2Xb.3.2.2.m1.9.9.3.cmml" xref="S2.E2Xb.3.2.2.m1.9.9.3"></eq><csymbol cd="latexml" id="S2.E2Xb.3.2.2.m1.9.9.4.cmml" xref="S2.E2Xb.3.2.2.m1.9.9.4">absent</csymbol><apply id="S2.E2Xb.3.2.2.m1.9.9.2.cmml" xref="S2.E2Xb.3.2.2.m1.9.9.2"><times id="S2.E2Xb.3.2.2.m1.9.9.2.3.cmml" xref="S2.E2Xb.3.2.2.m1.9.9.2.3"></times><list id="S2.E2Xb.3.2.2.m1.9.9.2.2.3.cmml" xref="S2.E2Xb.3.2.2.m1.9.9.2.2.2"><apply id="S2.E2Xb.3.2.2.m1.8.8.1.1.1.1.cmml" xref="S2.E2Xb.3.2.2.m1.8.8.1.1.1.1"><times id="S2.E2Xb.3.2.2.m1.8.8.1.1.1.1.2.cmml" xref="S2.E2Xb.3.2.2.m1.8.8.1.1.1.1.2"></times><ci id="S2.E2Xb.3.2.2.m1.8.8.1.1.1.1.3.cmml" xref="S2.E2Xb.3.2.2.m1.8.8.1.1.1.1.3">𝑆</ci><apply id="S2.E2Xb.3.2.2.m1.8.8.1.1.1.1.4.cmml" xref="S2.E2Xb.3.2.2.m1.8.8.1.1.1.1.4"><csymbol cd="ambiguous" id="S2.E2Xb.3.2.2.m1.8.8.1.1.1.1.4.1.cmml" xref="S2.E2Xb.3.2.2.m1.8.8.1.1.1.1.4">subscript</csymbol><ci id="S2.E2Xb.3.2.2.m1.8.8.1.1.1.1.4.2.cmml" xref="S2.E2Xb.3.2.2.m1.8.8.1.1.1.1.4.2">𝐴</ci><list id="S2.E2Xb.3.2.2.m1.2.2.2.3.cmml" xref="S2.E2Xb.3.2.2.m1.2.2.2.4"><ci id="S2.E2Xb.3.2.2.m1.1.1.1.1.cmml" xref="S2.E2Xb.3.2.2.m1.1.1.1.1">𝑙</ci><cn type="integer" id="S2.E2Xb.3.2.2.m1.2.2.2.2.cmml" xref="S2.E2Xb.3.2.2.m1.2.2.2.2">1</cn></list></apply><apply id="S2.E2Xb.3.2.2.m1.8.8.1.1.1.1.1.1.1.cmml" xref="S2.E2Xb.3.2.2.m1.8.8.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S2.E2Xb.3.2.2.m1.8.8.1.1.1.1.1.1.1.1.cmml" xref="S2.E2Xb.3.2.2.m1.8.8.1.1.1.1.1.1">subscript</csymbol><ci id="S2.E2Xb.3.2.2.m1.8.8.1.1.1.1.1.1.1.2.cmml" xref="S2.E2Xb.3.2.2.m1.8.8.1.1.1.1.1.1.1.2">𝐳</ci><apply id="S2.E2Xb.3.2.2.m1.8.8.1.1.1.1.1.1.1.3.cmml" xref="S2.E2Xb.3.2.2.m1.8.8.1.1.1.1.1.1.1.3"><minus id="S2.E2Xb.3.2.2.m1.8.8.1.1.1.1.1.1.1.3.1.cmml" xref="S2.E2Xb.3.2.2.m1.8.8.1.1.1.1.1.1.1.3.1"></minus><ci id="S2.E2Xb.3.2.2.m1.8.8.1.1.1.1.1.1.1.3.2.cmml" xref="S2.E2Xb.3.2.2.m1.8.8.1.1.1.1.1.1.1.3.2">𝑙</ci><cn type="integer" id="S2.E2Xb.3.2.2.m1.8.8.1.1.1.1.1.1.1.3.3.cmml" xref="S2.E2Xb.3.2.2.m1.8.8.1.1.1.1.1.1.1.3.3">1</cn></apply></apply></apply><ci id="S2.E2Xb.3.2.2.m1.7.7.cmml" xref="S2.E2Xb.3.2.2.m1.7.7">⋯</ci><apply id="S2.E2Xb.3.2.2.m1.9.9.2.2.2.2.cmml" xref="S2.E2Xb.3.2.2.m1.9.9.2.2.2.2"><times id="S2.E2Xb.3.2.2.m1.9.9.2.2.2.2.2.cmml" xref="S2.E2Xb.3.2.2.m1.9.9.2.2.2.2.2"></times><ci id="S2.E2Xb.3.2.2.m1.9.9.2.2.2.2.3.cmml" xref="S2.E2Xb.3.2.2.m1.9.9.2.2.2.2.3">𝑆</ci><apply id="S2.E2Xb.3.2.2.m1.9.9.2.2.2.2.4.cmml" xref="S2.E2Xb.3.2.2.m1.9.9.2.2.2.2.4"><csymbol cd="ambiguous" id="S2.E2Xb.3.2.2.m1.9.9.2.2.2.2.4.1.cmml" xref="S2.E2Xb.3.2.2.m1.9.9.2.2.2.2.4">subscript</csymbol><ci id="S2.E2Xb.3.2.2.m1.9.9.2.2.2.2.4.2.cmml" xref="S2.E2Xb.3.2.2.m1.9.9.2.2.2.2.4.2">𝐴</ci><list id="S2.E2Xb.3.2.2.m1.4.4.2.3.cmml" xref="S2.E2Xb.3.2.2.m1.4.4.2.2"><ci id="S2.E2Xb.3.2.2.m1.3.3.1.1.cmml" xref="S2.E2Xb.3.2.2.m1.3.3.1.1">𝑙</ci><apply id="S2.E2Xb.3.2.2.m1.4.4.2.2.1.cmml" xref="S2.E2Xb.3.2.2.m1.4.4.2.2.1"><csymbol cd="ambiguous" id="S2.E2Xb.3.2.2.m1.4.4.2.2.1.1.cmml" xref="S2.E2Xb.3.2.2.m1.4.4.2.2.1">subscript</csymbol><ci id="S2.E2Xb.3.2.2.m1.4.4.2.2.1.2.cmml" xref="S2.E2Xb.3.2.2.m1.4.4.2.2.1.2">𝐾</ci><ci id="S2.E2Xb.3.2.2.m1.4.4.2.2.1.3.cmml" xref="S2.E2Xb.3.2.2.m1.4.4.2.2.1.3">𝑙</ci></apply></list></apply><apply id="S2.E2Xb.3.2.2.m1.9.9.2.2.2.2.1.1.1.cmml" xref="S2.E2Xb.3.2.2.m1.9.9.2.2.2.2.1.1"><csymbol cd="ambiguous" id="S2.E2Xb.3.2.2.m1.9.9.2.2.2.2.1.1.1.1.cmml" xref="S2.E2Xb.3.2.2.m1.9.9.2.2.2.2.1.1">subscript</csymbol><ci id="S2.E2Xb.3.2.2.m1.9.9.2.2.2.2.1.1.1.2.cmml" xref="S2.E2Xb.3.2.2.m1.9.9.2.2.2.2.1.1.1.2">𝐳</ci><apply id="S2.E2Xb.3.2.2.m1.9.9.2.2.2.2.1.1.1.3.cmml" xref="S2.E2Xb.3.2.2.m1.9.9.2.2.2.2.1.1.1.3"><minus id="S2.E2Xb.3.2.2.m1.9.9.2.2.2.2.1.1.1.3.1.cmml" xref="S2.E2Xb.3.2.2.m1.9.9.2.2.2.2.1.1.1.3.1"></minus><ci id="S2.E2Xb.3.2.2.m1.9.9.2.2.2.2.1.1.1.3.2.cmml" xref="S2.E2Xb.3.2.2.m1.9.9.2.2.2.2.1.1.1.3.2">𝑙</ci><cn type="integer" id="S2.E2Xb.3.2.2.m1.9.9.2.2.2.2.1.1.1.3.3.cmml" xref="S2.E2Xb.3.2.2.m1.9.9.2.2.2.2.1.1.1.3.3">1</cn></apply></apply></apply></list><apply id="S2.E2Xb.3.2.2.m1.9.9.2.4.cmml" xref="S2.E2Xb.3.2.2.m1.9.9.2.4"><csymbol cd="ambiguous" id="S2.E2Xb.3.2.2.m1.9.9.2.4.1.cmml" xref="S2.E2Xb.3.2.2.m1.9.9.2.4">subscript</csymbol><ci id="S2.E2Xb.3.2.2.m1.9.9.2.4.2.cmml" xref="S2.E2Xb.3.2.2.m1.9.9.2.4.2">𝐔</ci><list id="S2.E2Xb.3.2.2.m1.6.6.2.3.cmml" xref="S2.E2Xb.3.2.2.m1.6.6.2.4"><ci id="S2.E2Xb.3.2.2.m1.5.5.1.1.cmml" xref="S2.E2Xb.3.2.2.m1.5.5.1.1">𝐦𝐬𝐚</ci><ci id="S2.E2Xb.3.2.2.m1.6.6.2.2.cmml" xref="S2.E2Xb.3.2.2.m1.6.6.2.2">𝑙</ci></list></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.E2Xb.3.2.2.m1.9c">\displaystyle=[SA_{l,1}(\mathbf{z}_{l-1}),\cdots,SA_{l,K_{l}}(\mathbf{z}_{l-1})]\mathbf{U}_{\mathbf{msa},l}</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr>
</tbody>
</table>
<p id="S2.p3.8" class="ltx_p">where <math id="S2.p3.2.m1.1" class="ltx_Math" alttext="D_{h}" display="inline"><semantics id="S2.p3.2.m1.1a"><msub id="S2.p3.2.m1.1.1" xref="S2.p3.2.m1.1.1.cmml"><mi id="S2.p3.2.m1.1.1.2" xref="S2.p3.2.m1.1.1.2.cmml">D</mi><mi id="S2.p3.2.m1.1.1.3" xref="S2.p3.2.m1.1.1.3.cmml">h</mi></msub><annotation-xml encoding="MathML-Content" id="S2.p3.2.m1.1b"><apply id="S2.p3.2.m1.1.1.cmml" xref="S2.p3.2.m1.1.1"><csymbol cd="ambiguous" id="S2.p3.2.m1.1.1.1.cmml" xref="S2.p3.2.m1.1.1">subscript</csymbol><ci id="S2.p3.2.m1.1.1.2.cmml" xref="S2.p3.2.m1.1.1.2">𝐷</ci><ci id="S2.p3.2.m1.1.1.3.cmml" xref="S2.p3.2.m1.1.1.3">ℎ</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.p3.2.m1.1c">D_{h}</annotation></semantics></math> is the size of vectors <math id="S2.p3.3.m2.9" class="ltx_Math" alttext="\mathbf{q}_{l,k},\mathbf{k}_{l,k},\mathbf{v}_{l,k}" display="inline"><semantics id="S2.p3.3.m2.9a"><mrow id="S2.p3.3.m2.9.9.3" xref="S2.p3.3.m2.9.9.4.cmml"><msub id="S2.p3.3.m2.7.7.1.1" xref="S2.p3.3.m2.7.7.1.1.cmml"><mi id="S2.p3.3.m2.7.7.1.1.2" xref="S2.p3.3.m2.7.7.1.1.2.cmml">𝐪</mi><mrow id="S2.p3.3.m2.2.2.2.4" xref="S2.p3.3.m2.2.2.2.3.cmml"><mi id="S2.p3.3.m2.1.1.1.1" xref="S2.p3.3.m2.1.1.1.1.cmml">l</mi><mo id="S2.p3.3.m2.2.2.2.4.1" xref="S2.p3.3.m2.2.2.2.3.cmml">,</mo><mi id="S2.p3.3.m2.2.2.2.2" xref="S2.p3.3.m2.2.2.2.2.cmml">k</mi></mrow></msub><mo id="S2.p3.3.m2.9.9.3.4" xref="S2.p3.3.m2.9.9.4.cmml">,</mo><msub id="S2.p3.3.m2.8.8.2.2" xref="S2.p3.3.m2.8.8.2.2.cmml"><mi id="S2.p3.3.m2.8.8.2.2.2" xref="S2.p3.3.m2.8.8.2.2.2.cmml">𝐤</mi><mrow id="S2.p3.3.m2.4.4.2.4" xref="S2.p3.3.m2.4.4.2.3.cmml"><mi id="S2.p3.3.m2.3.3.1.1" xref="S2.p3.3.m2.3.3.1.1.cmml">l</mi><mo id="S2.p3.3.m2.4.4.2.4.1" xref="S2.p3.3.m2.4.4.2.3.cmml">,</mo><mi id="S2.p3.3.m2.4.4.2.2" xref="S2.p3.3.m2.4.4.2.2.cmml">k</mi></mrow></msub><mo id="S2.p3.3.m2.9.9.3.5" xref="S2.p3.3.m2.9.9.4.cmml">,</mo><msub id="S2.p3.3.m2.9.9.3.3" xref="S2.p3.3.m2.9.9.3.3.cmml"><mi id="S2.p3.3.m2.9.9.3.3.2" xref="S2.p3.3.m2.9.9.3.3.2.cmml">𝐯</mi><mrow id="S2.p3.3.m2.6.6.2.4" xref="S2.p3.3.m2.6.6.2.3.cmml"><mi id="S2.p3.3.m2.5.5.1.1" xref="S2.p3.3.m2.5.5.1.1.cmml">l</mi><mo id="S2.p3.3.m2.6.6.2.4.1" xref="S2.p3.3.m2.6.6.2.3.cmml">,</mo><mi id="S2.p3.3.m2.6.6.2.2" xref="S2.p3.3.m2.6.6.2.2.cmml">k</mi></mrow></msub></mrow><annotation-xml encoding="MathML-Content" id="S2.p3.3.m2.9b"><list id="S2.p3.3.m2.9.9.4.cmml" xref="S2.p3.3.m2.9.9.3"><apply id="S2.p3.3.m2.7.7.1.1.cmml" xref="S2.p3.3.m2.7.7.1.1"><csymbol cd="ambiguous" id="S2.p3.3.m2.7.7.1.1.1.cmml" xref="S2.p3.3.m2.7.7.1.1">subscript</csymbol><ci id="S2.p3.3.m2.7.7.1.1.2.cmml" xref="S2.p3.3.m2.7.7.1.1.2">𝐪</ci><list id="S2.p3.3.m2.2.2.2.3.cmml" xref="S2.p3.3.m2.2.2.2.4"><ci id="S2.p3.3.m2.1.1.1.1.cmml" xref="S2.p3.3.m2.1.1.1.1">𝑙</ci><ci id="S2.p3.3.m2.2.2.2.2.cmml" xref="S2.p3.3.m2.2.2.2.2">𝑘</ci></list></apply><apply id="S2.p3.3.m2.8.8.2.2.cmml" xref="S2.p3.3.m2.8.8.2.2"><csymbol cd="ambiguous" id="S2.p3.3.m2.8.8.2.2.1.cmml" xref="S2.p3.3.m2.8.8.2.2">subscript</csymbol><ci id="S2.p3.3.m2.8.8.2.2.2.cmml" xref="S2.p3.3.m2.8.8.2.2.2">𝐤</ci><list id="S2.p3.3.m2.4.4.2.3.cmml" xref="S2.p3.3.m2.4.4.2.4"><ci id="S2.p3.3.m2.3.3.1.1.cmml" xref="S2.p3.3.m2.3.3.1.1">𝑙</ci><ci id="S2.p3.3.m2.4.4.2.2.cmml" xref="S2.p3.3.m2.4.4.2.2">𝑘</ci></list></apply><apply id="S2.p3.3.m2.9.9.3.3.cmml" xref="S2.p3.3.m2.9.9.3.3"><csymbol cd="ambiguous" id="S2.p3.3.m2.9.9.3.3.1.cmml" xref="S2.p3.3.m2.9.9.3.3">subscript</csymbol><ci id="S2.p3.3.m2.9.9.3.3.2.cmml" xref="S2.p3.3.m2.9.9.3.3.2">𝐯</ci><list id="S2.p3.3.m2.6.6.2.3.cmml" xref="S2.p3.3.m2.6.6.2.4"><ci id="S2.p3.3.m2.5.5.1.1.cmml" xref="S2.p3.3.m2.5.5.1.1">𝑙</ci><ci id="S2.p3.3.m2.6.6.2.2.cmml" xref="S2.p3.3.m2.6.6.2.2">𝑘</ci></list></apply></list></annotation-xml><annotation encoding="application/x-tex" id="S2.p3.3.m2.9c">\mathbf{q}_{l,k},\mathbf{k}_{l,k},\mathbf{v}_{l,k}</annotation></semantics></math>, <math id="S2.p3.4.m3.1" class="ltx_Math" alttext="K_{l}" display="inline"><semantics id="S2.p3.4.m3.1a"><msub id="S2.p3.4.m3.1.1" xref="S2.p3.4.m3.1.1.cmml"><mi id="S2.p3.4.m3.1.1.2" xref="S2.p3.4.m3.1.1.2.cmml">K</mi><mi id="S2.p3.4.m3.1.1.3" xref="S2.p3.4.m3.1.1.3.cmml">l</mi></msub><annotation-xml encoding="MathML-Content" id="S2.p3.4.m3.1b"><apply id="S2.p3.4.m3.1.1.cmml" xref="S2.p3.4.m3.1.1"><csymbol cd="ambiguous" id="S2.p3.4.m3.1.1.1.cmml" xref="S2.p3.4.m3.1.1">subscript</csymbol><ci id="S2.p3.4.m3.1.1.2.cmml" xref="S2.p3.4.m3.1.1.2">𝐾</ci><ci id="S2.p3.4.m3.1.1.3.cmml" xref="S2.p3.4.m3.1.1.3">𝑙</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.p3.4.m3.1c">K_{l}</annotation></semantics></math> is the total number of self-attention heads of <math id="S2.p3.5.m4.10" class="ltx_Math" alttext="\mathbf{U}_{\mathbf{msa},l}=[\mathbf{U}_{\mathbf{msa},l,1},\cdots\mathbf{U}_{\mathbf{msa},l,K_{l}}]^{T}" display="inline"><semantics id="S2.p3.5.m4.10a"><mrow id="S2.p3.5.m4.10.10" xref="S2.p3.5.m4.10.10.cmml"><msub id="S2.p3.5.m4.10.10.4" xref="S2.p3.5.m4.10.10.4.cmml"><mi id="S2.p3.5.m4.10.10.4.2" xref="S2.p3.5.m4.10.10.4.2.cmml">𝐔</mi><mrow id="S2.p3.5.m4.2.2.2.4" xref="S2.p3.5.m4.2.2.2.3.cmml"><mi id="S2.p3.5.m4.1.1.1.1" xref="S2.p3.5.m4.1.1.1.1.cmml">𝐦𝐬𝐚</mi><mo id="S2.p3.5.m4.2.2.2.4.1" xref="S2.p3.5.m4.2.2.2.3.cmml">,</mo><mi id="S2.p3.5.m4.2.2.2.2" xref="S2.p3.5.m4.2.2.2.2.cmml">l</mi></mrow></msub><mo id="S2.p3.5.m4.10.10.3" xref="S2.p3.5.m4.10.10.3.cmml">=</mo><msup id="S2.p3.5.m4.10.10.2" xref="S2.p3.5.m4.10.10.2.cmml"><mrow id="S2.p3.5.m4.10.10.2.2.2" xref="S2.p3.5.m4.10.10.2.2.3.cmml"><mo stretchy="false" id="S2.p3.5.m4.10.10.2.2.2.3" xref="S2.p3.5.m4.10.10.2.2.3.cmml">[</mo><msub id="S2.p3.5.m4.9.9.1.1.1.1" xref="S2.p3.5.m4.9.9.1.1.1.1.cmml"><mi id="S2.p3.5.m4.9.9.1.1.1.1.2" xref="S2.p3.5.m4.9.9.1.1.1.1.2.cmml">𝐔</mi><mrow id="S2.p3.5.m4.5.5.3.5" xref="S2.p3.5.m4.5.5.3.4.cmml"><mi id="S2.p3.5.m4.3.3.1.1" xref="S2.p3.5.m4.3.3.1.1.cmml">𝐦𝐬𝐚</mi><mo id="S2.p3.5.m4.5.5.3.5.1" xref="S2.p3.5.m4.5.5.3.4.cmml">,</mo><mi id="S2.p3.5.m4.4.4.2.2" xref="S2.p3.5.m4.4.4.2.2.cmml">l</mi><mo id="S2.p3.5.m4.5.5.3.5.2" xref="S2.p3.5.m4.5.5.3.4.cmml">,</mo><mn id="S2.p3.5.m4.5.5.3.3" xref="S2.p3.5.m4.5.5.3.3.cmml">1</mn></mrow></msub><mo id="S2.p3.5.m4.10.10.2.2.2.4" xref="S2.p3.5.m4.10.10.2.2.3.cmml">,</mo><mrow id="S2.p3.5.m4.10.10.2.2.2.2" xref="S2.p3.5.m4.10.10.2.2.2.2.cmml"><mi mathvariant="normal" id="S2.p3.5.m4.10.10.2.2.2.2.2" xref="S2.p3.5.m4.10.10.2.2.2.2.2.cmml">⋯</mi><mo lspace="0em" rspace="0em" id="S2.p3.5.m4.10.10.2.2.2.2.1" xref="S2.p3.5.m4.10.10.2.2.2.2.1.cmml">​</mo><msub id="S2.p3.5.m4.10.10.2.2.2.2.3" xref="S2.p3.5.m4.10.10.2.2.2.2.3.cmml"><mi id="S2.p3.5.m4.10.10.2.2.2.2.3.2" xref="S2.p3.5.m4.10.10.2.2.2.2.3.2.cmml">𝐔</mi><mrow id="S2.p3.5.m4.8.8.3.3" xref="S2.p3.5.m4.8.8.3.4.cmml"><mi id="S2.p3.5.m4.6.6.1.1" xref="S2.p3.5.m4.6.6.1.1.cmml">𝐦𝐬𝐚</mi><mo id="S2.p3.5.m4.8.8.3.3.2" xref="S2.p3.5.m4.8.8.3.4.cmml">,</mo><mi id="S2.p3.5.m4.7.7.2.2" xref="S2.p3.5.m4.7.7.2.2.cmml">l</mi><mo id="S2.p3.5.m4.8.8.3.3.3" xref="S2.p3.5.m4.8.8.3.4.cmml">,</mo><msub id="S2.p3.5.m4.8.8.3.3.1" xref="S2.p3.5.m4.8.8.3.3.1.cmml"><mi id="S2.p3.5.m4.8.8.3.3.1.2" xref="S2.p3.5.m4.8.8.3.3.1.2.cmml">K</mi><mi id="S2.p3.5.m4.8.8.3.3.1.3" xref="S2.p3.5.m4.8.8.3.3.1.3.cmml">l</mi></msub></mrow></msub></mrow><mo stretchy="false" id="S2.p3.5.m4.10.10.2.2.2.5" xref="S2.p3.5.m4.10.10.2.2.3.cmml">]</mo></mrow><mi id="S2.p3.5.m4.10.10.2.4" xref="S2.p3.5.m4.10.10.2.4.cmml">T</mi></msup></mrow><annotation-xml encoding="MathML-Content" id="S2.p3.5.m4.10b"><apply id="S2.p3.5.m4.10.10.cmml" xref="S2.p3.5.m4.10.10"><eq id="S2.p3.5.m4.10.10.3.cmml" xref="S2.p3.5.m4.10.10.3"></eq><apply id="S2.p3.5.m4.10.10.4.cmml" xref="S2.p3.5.m4.10.10.4"><csymbol cd="ambiguous" id="S2.p3.5.m4.10.10.4.1.cmml" xref="S2.p3.5.m4.10.10.4">subscript</csymbol><ci id="S2.p3.5.m4.10.10.4.2.cmml" xref="S2.p3.5.m4.10.10.4.2">𝐔</ci><list id="S2.p3.5.m4.2.2.2.3.cmml" xref="S2.p3.5.m4.2.2.2.4"><ci id="S2.p3.5.m4.1.1.1.1.cmml" xref="S2.p3.5.m4.1.1.1.1">𝐦𝐬𝐚</ci><ci id="S2.p3.5.m4.2.2.2.2.cmml" xref="S2.p3.5.m4.2.2.2.2">𝑙</ci></list></apply><apply id="S2.p3.5.m4.10.10.2.cmml" xref="S2.p3.5.m4.10.10.2"><csymbol cd="ambiguous" id="S2.p3.5.m4.10.10.2.3.cmml" xref="S2.p3.5.m4.10.10.2">superscript</csymbol><interval closure="closed" id="S2.p3.5.m4.10.10.2.2.3.cmml" xref="S2.p3.5.m4.10.10.2.2.2"><apply id="S2.p3.5.m4.9.9.1.1.1.1.cmml" xref="S2.p3.5.m4.9.9.1.1.1.1"><csymbol cd="ambiguous" id="S2.p3.5.m4.9.9.1.1.1.1.1.cmml" xref="S2.p3.5.m4.9.9.1.1.1.1">subscript</csymbol><ci id="S2.p3.5.m4.9.9.1.1.1.1.2.cmml" xref="S2.p3.5.m4.9.9.1.1.1.1.2">𝐔</ci><list id="S2.p3.5.m4.5.5.3.4.cmml" xref="S2.p3.5.m4.5.5.3.5"><ci id="S2.p3.5.m4.3.3.1.1.cmml" xref="S2.p3.5.m4.3.3.1.1">𝐦𝐬𝐚</ci><ci id="S2.p3.5.m4.4.4.2.2.cmml" xref="S2.p3.5.m4.4.4.2.2">𝑙</ci><cn type="integer" id="S2.p3.5.m4.5.5.3.3.cmml" xref="S2.p3.5.m4.5.5.3.3">1</cn></list></apply><apply id="S2.p3.5.m4.10.10.2.2.2.2.cmml" xref="S2.p3.5.m4.10.10.2.2.2.2"><times id="S2.p3.5.m4.10.10.2.2.2.2.1.cmml" xref="S2.p3.5.m4.10.10.2.2.2.2.1"></times><ci id="S2.p3.5.m4.10.10.2.2.2.2.2.cmml" xref="S2.p3.5.m4.10.10.2.2.2.2.2">⋯</ci><apply id="S2.p3.5.m4.10.10.2.2.2.2.3.cmml" xref="S2.p3.5.m4.10.10.2.2.2.2.3"><csymbol cd="ambiguous" id="S2.p3.5.m4.10.10.2.2.2.2.3.1.cmml" xref="S2.p3.5.m4.10.10.2.2.2.2.3">subscript</csymbol><ci id="S2.p3.5.m4.10.10.2.2.2.2.3.2.cmml" xref="S2.p3.5.m4.10.10.2.2.2.2.3.2">𝐔</ci><list id="S2.p3.5.m4.8.8.3.4.cmml" xref="S2.p3.5.m4.8.8.3.3"><ci id="S2.p3.5.m4.6.6.1.1.cmml" xref="S2.p3.5.m4.6.6.1.1">𝐦𝐬𝐚</ci><ci id="S2.p3.5.m4.7.7.2.2.cmml" xref="S2.p3.5.m4.7.7.2.2">𝑙</ci><apply id="S2.p3.5.m4.8.8.3.3.1.cmml" xref="S2.p3.5.m4.8.8.3.3.1"><csymbol cd="ambiguous" id="S2.p3.5.m4.8.8.3.3.1.1.cmml" xref="S2.p3.5.m4.8.8.3.3.1">subscript</csymbol><ci id="S2.p3.5.m4.8.8.3.3.1.2.cmml" xref="S2.p3.5.m4.8.8.3.3.1.2">𝐾</ci><ci id="S2.p3.5.m4.8.8.3.3.1.3.cmml" xref="S2.p3.5.m4.8.8.3.3.1.3">𝑙</ci></apply></list></apply></apply></interval><ci id="S2.p3.5.m4.10.10.2.4.cmml" xref="S2.p3.5.m4.10.10.2.4">𝑇</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.p3.5.m4.10c">\mathbf{U}_{\mathbf{msa},l}=[\mathbf{U}_{\mathbf{msa},l,1},\cdots\mathbf{U}_{\mathbf{msa},l,K_{l}}]^{T}</annotation></semantics></math>. We follow the same terminology and definitions of <math id="S2.p3.6.m5.1" class="ltx_Math" alttext="\mathbf{U}" display="inline"><semantics id="S2.p3.6.m5.1a"><mi id="S2.p3.6.m5.1.1" xref="S2.p3.6.m5.1.1.cmml">𝐔</mi><annotation-xml encoding="MathML-Content" id="S2.p3.6.m5.1b"><ci id="S2.p3.6.m5.1.1.cmml" xref="S2.p3.6.m5.1.1">𝐔</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.p3.6.m5.1c">\mathbf{U}</annotation></semantics></math> as in <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib6" title="" class="ltx_ref">6</a>]</cite>. To enable the ViT to capture the local personalized attention for heterogeneous data, we personalize a number of <math id="S2.p3.7.m6.1" class="ltx_Math" alttext="P_{l}&lt;K_{l}" display="inline"><semantics id="S2.p3.7.m6.1a"><mrow id="S2.p3.7.m6.1.1" xref="S2.p3.7.m6.1.1.cmml"><msub id="S2.p3.7.m6.1.1.2" xref="S2.p3.7.m6.1.1.2.cmml"><mi id="S2.p3.7.m6.1.1.2.2" xref="S2.p3.7.m6.1.1.2.2.cmml">P</mi><mi id="S2.p3.7.m6.1.1.2.3" xref="S2.p3.7.m6.1.1.2.3.cmml">l</mi></msub><mo id="S2.p3.7.m6.1.1.1" xref="S2.p3.7.m6.1.1.1.cmml">&lt;</mo><msub id="S2.p3.7.m6.1.1.3" xref="S2.p3.7.m6.1.1.3.cmml"><mi id="S2.p3.7.m6.1.1.3.2" xref="S2.p3.7.m6.1.1.3.2.cmml">K</mi><mi id="S2.p3.7.m6.1.1.3.3" xref="S2.p3.7.m6.1.1.3.3.cmml">l</mi></msub></mrow><annotation-xml encoding="MathML-Content" id="S2.p3.7.m6.1b"><apply id="S2.p3.7.m6.1.1.cmml" xref="S2.p3.7.m6.1.1"><lt id="S2.p3.7.m6.1.1.1.cmml" xref="S2.p3.7.m6.1.1.1"></lt><apply id="S2.p3.7.m6.1.1.2.cmml" xref="S2.p3.7.m6.1.1.2"><csymbol cd="ambiguous" id="S2.p3.7.m6.1.1.2.1.cmml" xref="S2.p3.7.m6.1.1.2">subscript</csymbol><ci id="S2.p3.7.m6.1.1.2.2.cmml" xref="S2.p3.7.m6.1.1.2.2">𝑃</ci><ci id="S2.p3.7.m6.1.1.2.3.cmml" xref="S2.p3.7.m6.1.1.2.3">𝑙</ci></apply><apply id="S2.p3.7.m6.1.1.3.cmml" xref="S2.p3.7.m6.1.1.3"><csymbol cd="ambiguous" id="S2.p3.7.m6.1.1.3.1.cmml" xref="S2.p3.7.m6.1.1.3">subscript</csymbol><ci id="S2.p3.7.m6.1.1.3.2.cmml" xref="S2.p3.7.m6.1.1.3.2">𝐾</ci><ci id="S2.p3.7.m6.1.1.3.3.cmml" xref="S2.p3.7.m6.1.1.3.3">𝑙</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.p3.7.m6.1c">P_{l}&lt;K_{l}</annotation></semantics></math> heads in the MSA layers. Specifically, the collection of personalized weights in <math id="S2.p3.8.m7.1" class="ltx_Math" alttext="l" display="inline"><semantics id="S2.p3.8.m7.1a"><mi id="S2.p3.8.m7.1.1" xref="S2.p3.8.m7.1.1.cmml">l</mi><annotation-xml encoding="MathML-Content" id="S2.p3.8.m7.1b"><ci id="S2.p3.8.m7.1.1.cmml" xref="S2.p3.8.m7.1.1">𝑙</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.p3.8.m7.1c">l</annotation></semantics></math><sup id="S2.p3.8.1" class="ltx_sup">th</sup> MSA comprises two
parts <span id="S2.p3.8.2" class="ltx_text ltx_font_italic">i.e.</span></p>
<table id="S4.EGx1" class="ltx_equationgroup ltx_eqn_align ltx_eqn_table">

<tbody id="S2.E3"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math id="S2.E3.m1.2" class="ltx_Math" alttext="\displaystyle\mathbf{U}_{\mathbf{qkv},l}^{p}" display="inline"><semantics id="S2.E3.m1.2a"><msubsup id="S2.E3.m1.2.3" xref="S2.E3.m1.2.3.cmml"><mi id="S2.E3.m1.2.3.2.2" xref="S2.E3.m1.2.3.2.2.cmml">𝐔</mi><mrow id="S2.E3.m1.2.2.2.4" xref="S2.E3.m1.2.2.2.3.cmml"><mi id="S2.E3.m1.1.1.1.1" xref="S2.E3.m1.1.1.1.1.cmml">𝐪𝐤𝐯</mi><mo id="S2.E3.m1.2.2.2.4.1" xref="S2.E3.m1.2.2.2.3.cmml">,</mo><mi id="S2.E3.m1.2.2.2.2" xref="S2.E3.m1.2.2.2.2.cmml">l</mi></mrow><mi id="S2.E3.m1.2.3.3" xref="S2.E3.m1.2.3.3.cmml">p</mi></msubsup><annotation-xml encoding="MathML-Content" id="S2.E3.m1.2b"><apply id="S2.E3.m1.2.3.cmml" xref="S2.E3.m1.2.3"><csymbol cd="ambiguous" id="S2.E3.m1.2.3.1.cmml" xref="S2.E3.m1.2.3">superscript</csymbol><apply id="S2.E3.m1.2.3.2.cmml" xref="S2.E3.m1.2.3"><csymbol cd="ambiguous" id="S2.E3.m1.2.3.2.1.cmml" xref="S2.E3.m1.2.3">subscript</csymbol><ci id="S2.E3.m1.2.3.2.2.cmml" xref="S2.E3.m1.2.3.2.2">𝐔</ci><list id="S2.E3.m1.2.2.2.3.cmml" xref="S2.E3.m1.2.2.2.4"><ci id="S2.E3.m1.1.1.1.1.cmml" xref="S2.E3.m1.1.1.1.1">𝐪𝐤𝐯</ci><ci id="S2.E3.m1.2.2.2.2.cmml" xref="S2.E3.m1.2.2.2.2">𝑙</ci></list></apply><ci id="S2.E3.m1.2.3.3.cmml" xref="S2.E3.m1.2.3.3">𝑝</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.E3.m1.2c">\displaystyle\mathbf{U}_{\mathbf{qkv},l}^{p}</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math id="S2.E3.m2.9" class="ltx_Math" alttext="\displaystyle=[\mathbf{U}_{\mathbf{qkv},l,1},\cdots,\mathbf{U}_{\mathbf{qkv},l,P_{l}}]" display="inline"><semantics id="S2.E3.m2.9a"><mrow id="S2.E3.m2.9.9" xref="S2.E3.m2.9.9.cmml"><mi id="S2.E3.m2.9.9.4" xref="S2.E3.m2.9.9.4.cmml"></mi><mo id="S2.E3.m2.9.9.3" xref="S2.E3.m2.9.9.3.cmml">=</mo><mrow id="S2.E3.m2.9.9.2.2" xref="S2.E3.m2.9.9.2.3.cmml"><mo stretchy="false" id="S2.E3.m2.9.9.2.2.3" xref="S2.E3.m2.9.9.2.3.cmml">[</mo><msub id="S2.E3.m2.8.8.1.1.1" xref="S2.E3.m2.8.8.1.1.1.cmml"><mi id="S2.E3.m2.8.8.1.1.1.2" xref="S2.E3.m2.8.8.1.1.1.2.cmml">𝐔</mi><mrow id="S2.E3.m2.3.3.3.5" xref="S2.E3.m2.3.3.3.4.cmml"><mi id="S2.E3.m2.1.1.1.1" xref="S2.E3.m2.1.1.1.1.cmml">𝐪𝐤𝐯</mi><mo id="S2.E3.m2.3.3.3.5.1" xref="S2.E3.m2.3.3.3.4.cmml">,</mo><mi id="S2.E3.m2.2.2.2.2" xref="S2.E3.m2.2.2.2.2.cmml">l</mi><mo id="S2.E3.m2.3.3.3.5.2" xref="S2.E3.m2.3.3.3.4.cmml">,</mo><mn id="S2.E3.m2.3.3.3.3" xref="S2.E3.m2.3.3.3.3.cmml">1</mn></mrow></msub><mo id="S2.E3.m2.9.9.2.2.4" xref="S2.E3.m2.9.9.2.3.cmml">,</mo><mi mathvariant="normal" id="S2.E3.m2.7.7" xref="S2.E3.m2.7.7.cmml">⋯</mi><mo id="S2.E3.m2.9.9.2.2.5" xref="S2.E3.m2.9.9.2.3.cmml">,</mo><msub id="S2.E3.m2.9.9.2.2.2" xref="S2.E3.m2.9.9.2.2.2.cmml"><mi id="S2.E3.m2.9.9.2.2.2.2" xref="S2.E3.m2.9.9.2.2.2.2.cmml">𝐔</mi><mrow id="S2.E3.m2.6.6.3.3" xref="S2.E3.m2.6.6.3.4.cmml"><mi id="S2.E3.m2.4.4.1.1" xref="S2.E3.m2.4.4.1.1.cmml">𝐪𝐤𝐯</mi><mo id="S2.E3.m2.6.6.3.3.2" xref="S2.E3.m2.6.6.3.4.cmml">,</mo><mi id="S2.E3.m2.5.5.2.2" xref="S2.E3.m2.5.5.2.2.cmml">l</mi><mo id="S2.E3.m2.6.6.3.3.3" xref="S2.E3.m2.6.6.3.4.cmml">,</mo><msub id="S2.E3.m2.6.6.3.3.1" xref="S2.E3.m2.6.6.3.3.1.cmml"><mi id="S2.E3.m2.6.6.3.3.1.2" xref="S2.E3.m2.6.6.3.3.1.2.cmml">P</mi><mi id="S2.E3.m2.6.6.3.3.1.3" xref="S2.E3.m2.6.6.3.3.1.3.cmml">l</mi></msub></mrow></msub><mo stretchy="false" id="S2.E3.m2.9.9.2.2.6" xref="S2.E3.m2.9.9.2.3.cmml">]</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.E3.m2.9b"><apply id="S2.E3.m2.9.9.cmml" xref="S2.E3.m2.9.9"><eq id="S2.E3.m2.9.9.3.cmml" xref="S2.E3.m2.9.9.3"></eq><csymbol cd="latexml" id="S2.E3.m2.9.9.4.cmml" xref="S2.E3.m2.9.9.4">absent</csymbol><list id="S2.E3.m2.9.9.2.3.cmml" xref="S2.E3.m2.9.9.2.2"><apply id="S2.E3.m2.8.8.1.1.1.cmml" xref="S2.E3.m2.8.8.1.1.1"><csymbol cd="ambiguous" id="S2.E3.m2.8.8.1.1.1.1.cmml" xref="S2.E3.m2.8.8.1.1.1">subscript</csymbol><ci id="S2.E3.m2.8.8.1.1.1.2.cmml" xref="S2.E3.m2.8.8.1.1.1.2">𝐔</ci><list id="S2.E3.m2.3.3.3.4.cmml" xref="S2.E3.m2.3.3.3.5"><ci id="S2.E3.m2.1.1.1.1.cmml" xref="S2.E3.m2.1.1.1.1">𝐪𝐤𝐯</ci><ci id="S2.E3.m2.2.2.2.2.cmml" xref="S2.E3.m2.2.2.2.2">𝑙</ci><cn type="integer" id="S2.E3.m2.3.3.3.3.cmml" xref="S2.E3.m2.3.3.3.3">1</cn></list></apply><ci id="S2.E3.m2.7.7.cmml" xref="S2.E3.m2.7.7">⋯</ci><apply id="S2.E3.m2.9.9.2.2.2.cmml" xref="S2.E3.m2.9.9.2.2.2"><csymbol cd="ambiguous" id="S2.E3.m2.9.9.2.2.2.1.cmml" xref="S2.E3.m2.9.9.2.2.2">subscript</csymbol><ci id="S2.E3.m2.9.9.2.2.2.2.cmml" xref="S2.E3.m2.9.9.2.2.2.2">𝐔</ci><list id="S2.E3.m2.6.6.3.4.cmml" xref="S2.E3.m2.6.6.3.3"><ci id="S2.E3.m2.4.4.1.1.cmml" xref="S2.E3.m2.4.4.1.1">𝐪𝐤𝐯</ci><ci id="S2.E3.m2.5.5.2.2.cmml" xref="S2.E3.m2.5.5.2.2">𝑙</ci><apply id="S2.E3.m2.6.6.3.3.1.cmml" xref="S2.E3.m2.6.6.3.3.1"><csymbol cd="ambiguous" id="S2.E3.m2.6.6.3.3.1.1.cmml" xref="S2.E3.m2.6.6.3.3.1">subscript</csymbol><ci id="S2.E3.m2.6.6.3.3.1.2.cmml" xref="S2.E3.m2.6.6.3.3.1.2">𝑃</ci><ci id="S2.E3.m2.6.6.3.3.1.3.cmml" xref="S2.E3.m2.6.6.3.3.1.3">𝑙</ci></apply></list></apply></list></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.E3.m2.9c">\displaystyle=[\mathbf{U}_{\mathbf{qkv},l,1},\cdots,\mathbf{U}_{\mathbf{qkv},l,P_{l}}]</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(3)</span></td>
</tr></tbody>
<tbody id="S2.E4"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math id="S2.E4.m1.2" class="ltx_Math" alttext="\displaystyle\mathbf{U}_{\mathbf{msa},l}^{p}" display="inline"><semantics id="S2.E4.m1.2a"><msubsup id="S2.E4.m1.2.3" xref="S2.E4.m1.2.3.cmml"><mi id="S2.E4.m1.2.3.2.2" xref="S2.E4.m1.2.3.2.2.cmml">𝐔</mi><mrow id="S2.E4.m1.2.2.2.4" xref="S2.E4.m1.2.2.2.3.cmml"><mi id="S2.E4.m1.1.1.1.1" xref="S2.E4.m1.1.1.1.1.cmml">𝐦𝐬𝐚</mi><mo id="S2.E4.m1.2.2.2.4.1" xref="S2.E4.m1.2.2.2.3.cmml">,</mo><mi id="S2.E4.m1.2.2.2.2" xref="S2.E4.m1.2.2.2.2.cmml">l</mi></mrow><mi id="S2.E4.m1.2.3.3" xref="S2.E4.m1.2.3.3.cmml">p</mi></msubsup><annotation-xml encoding="MathML-Content" id="S2.E4.m1.2b"><apply id="S2.E4.m1.2.3.cmml" xref="S2.E4.m1.2.3"><csymbol cd="ambiguous" id="S2.E4.m1.2.3.1.cmml" xref="S2.E4.m1.2.3">superscript</csymbol><apply id="S2.E4.m1.2.3.2.cmml" xref="S2.E4.m1.2.3"><csymbol cd="ambiguous" id="S2.E4.m1.2.3.2.1.cmml" xref="S2.E4.m1.2.3">subscript</csymbol><ci id="S2.E4.m1.2.3.2.2.cmml" xref="S2.E4.m1.2.3.2.2">𝐔</ci><list id="S2.E4.m1.2.2.2.3.cmml" xref="S2.E4.m1.2.2.2.4"><ci id="S2.E4.m1.1.1.1.1.cmml" xref="S2.E4.m1.1.1.1.1">𝐦𝐬𝐚</ci><ci id="S2.E4.m1.2.2.2.2.cmml" xref="S2.E4.m1.2.2.2.2">𝑙</ci></list></apply><ci id="S2.E4.m1.2.3.3.cmml" xref="S2.E4.m1.2.3.3">𝑝</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.E4.m1.2c">\displaystyle\mathbf{U}_{\mathbf{msa},l}^{p}</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math id="S2.E4.m2.8" class="ltx_Math" alttext="\displaystyle=[\mathbf{U}_{\mathbf{msa},l,1},\cdots,\mathbf{U}_{\mathbf{msa},l,P_{l}}]," display="inline"><semantics id="S2.E4.m2.8a"><mrow id="S2.E4.m2.8.8.1" xref="S2.E4.m2.8.8.1.1.cmml"><mrow id="S2.E4.m2.8.8.1.1" xref="S2.E4.m2.8.8.1.1.cmml"><mi id="S2.E4.m2.8.8.1.1.4" xref="S2.E4.m2.8.8.1.1.4.cmml"></mi><mo id="S2.E4.m2.8.8.1.1.3" xref="S2.E4.m2.8.8.1.1.3.cmml">=</mo><mrow id="S2.E4.m2.8.8.1.1.2.2" xref="S2.E4.m2.8.8.1.1.2.3.cmml"><mo stretchy="false" id="S2.E4.m2.8.8.1.1.2.2.3" xref="S2.E4.m2.8.8.1.1.2.3.cmml">[</mo><msub id="S2.E4.m2.8.8.1.1.1.1.1" xref="S2.E4.m2.8.8.1.1.1.1.1.cmml"><mi id="S2.E4.m2.8.8.1.1.1.1.1.2" xref="S2.E4.m2.8.8.1.1.1.1.1.2.cmml">𝐔</mi><mrow id="S2.E4.m2.3.3.3.5" xref="S2.E4.m2.3.3.3.4.cmml"><mi id="S2.E4.m2.1.1.1.1" xref="S2.E4.m2.1.1.1.1.cmml">𝐦𝐬𝐚</mi><mo id="S2.E4.m2.3.3.3.5.1" xref="S2.E4.m2.3.3.3.4.cmml">,</mo><mi id="S2.E4.m2.2.2.2.2" xref="S2.E4.m2.2.2.2.2.cmml">l</mi><mo id="S2.E4.m2.3.3.3.5.2" xref="S2.E4.m2.3.3.3.4.cmml">,</mo><mn id="S2.E4.m2.3.3.3.3" xref="S2.E4.m2.3.3.3.3.cmml">1</mn></mrow></msub><mo id="S2.E4.m2.8.8.1.1.2.2.4" xref="S2.E4.m2.8.8.1.1.2.3.cmml">,</mo><mi mathvariant="normal" id="S2.E4.m2.7.7" xref="S2.E4.m2.7.7.cmml">⋯</mi><mo id="S2.E4.m2.8.8.1.1.2.2.5" xref="S2.E4.m2.8.8.1.1.2.3.cmml">,</mo><msub id="S2.E4.m2.8.8.1.1.2.2.2" xref="S2.E4.m2.8.8.1.1.2.2.2.cmml"><mi id="S2.E4.m2.8.8.1.1.2.2.2.2" xref="S2.E4.m2.8.8.1.1.2.2.2.2.cmml">𝐔</mi><mrow id="S2.E4.m2.6.6.3.3" xref="S2.E4.m2.6.6.3.4.cmml"><mi id="S2.E4.m2.4.4.1.1" xref="S2.E4.m2.4.4.1.1.cmml">𝐦𝐬𝐚</mi><mo id="S2.E4.m2.6.6.3.3.2" xref="S2.E4.m2.6.6.3.4.cmml">,</mo><mi id="S2.E4.m2.5.5.2.2" xref="S2.E4.m2.5.5.2.2.cmml">l</mi><mo id="S2.E4.m2.6.6.3.3.3" xref="S2.E4.m2.6.6.3.4.cmml">,</mo><msub id="S2.E4.m2.6.6.3.3.1" xref="S2.E4.m2.6.6.3.3.1.cmml"><mi id="S2.E4.m2.6.6.3.3.1.2" xref="S2.E4.m2.6.6.3.3.1.2.cmml">P</mi><mi id="S2.E4.m2.6.6.3.3.1.3" xref="S2.E4.m2.6.6.3.3.1.3.cmml">l</mi></msub></mrow></msub><mo stretchy="false" id="S2.E4.m2.8.8.1.1.2.2.6" xref="S2.E4.m2.8.8.1.1.2.3.cmml">]</mo></mrow></mrow><mo id="S2.E4.m2.8.8.1.2" xref="S2.E4.m2.8.8.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S2.E4.m2.8b"><apply id="S2.E4.m2.8.8.1.1.cmml" xref="S2.E4.m2.8.8.1"><eq id="S2.E4.m2.8.8.1.1.3.cmml" xref="S2.E4.m2.8.8.1.1.3"></eq><csymbol cd="latexml" id="S2.E4.m2.8.8.1.1.4.cmml" xref="S2.E4.m2.8.8.1.1.4">absent</csymbol><list id="S2.E4.m2.8.8.1.1.2.3.cmml" xref="S2.E4.m2.8.8.1.1.2.2"><apply id="S2.E4.m2.8.8.1.1.1.1.1.cmml" xref="S2.E4.m2.8.8.1.1.1.1.1"><csymbol cd="ambiguous" id="S2.E4.m2.8.8.1.1.1.1.1.1.cmml" xref="S2.E4.m2.8.8.1.1.1.1.1">subscript</csymbol><ci id="S2.E4.m2.8.8.1.1.1.1.1.2.cmml" xref="S2.E4.m2.8.8.1.1.1.1.1.2">𝐔</ci><list id="S2.E4.m2.3.3.3.4.cmml" xref="S2.E4.m2.3.3.3.5"><ci id="S2.E4.m2.1.1.1.1.cmml" xref="S2.E4.m2.1.1.1.1">𝐦𝐬𝐚</ci><ci id="S2.E4.m2.2.2.2.2.cmml" xref="S2.E4.m2.2.2.2.2">𝑙</ci><cn type="integer" id="S2.E4.m2.3.3.3.3.cmml" xref="S2.E4.m2.3.3.3.3">1</cn></list></apply><ci id="S2.E4.m2.7.7.cmml" xref="S2.E4.m2.7.7">⋯</ci><apply id="S2.E4.m2.8.8.1.1.2.2.2.cmml" xref="S2.E4.m2.8.8.1.1.2.2.2"><csymbol cd="ambiguous" id="S2.E4.m2.8.8.1.1.2.2.2.1.cmml" xref="S2.E4.m2.8.8.1.1.2.2.2">subscript</csymbol><ci id="S2.E4.m2.8.8.1.1.2.2.2.2.cmml" xref="S2.E4.m2.8.8.1.1.2.2.2.2">𝐔</ci><list id="S2.E4.m2.6.6.3.4.cmml" xref="S2.E4.m2.6.6.3.3"><ci id="S2.E4.m2.4.4.1.1.cmml" xref="S2.E4.m2.4.4.1.1">𝐦𝐬𝐚</ci><ci id="S2.E4.m2.5.5.2.2.cmml" xref="S2.E4.m2.5.5.2.2">𝑙</ci><apply id="S2.E4.m2.6.6.3.3.1.cmml" xref="S2.E4.m2.6.6.3.3.1"><csymbol cd="ambiguous" id="S2.E4.m2.6.6.3.3.1.1.cmml" xref="S2.E4.m2.6.6.3.3.1">subscript</csymbol><ci id="S2.E4.m2.6.6.3.3.1.2.cmml" xref="S2.E4.m2.6.6.3.3.1.2">𝑃</ci><ci id="S2.E4.m2.6.6.3.3.1.3.cmml" xref="S2.E4.m2.6.6.3.3.1.3">𝑙</ci></apply></list></apply></list></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.E4.m2.8c">\displaystyle=[\mathbf{U}_{\mathbf{msa},l,1},\cdots,\mathbf{U}_{\mathbf{msa},l,P_{l}}],</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(4)</span></td>
</tr></tbody>
</table>
<p id="S2.p3.17" class="ltx_p">where superscript <math id="S2.p3.9.m1.1" class="ltx_Math" alttext="p" display="inline"><semantics id="S2.p3.9.m1.1a"><mi id="S2.p3.9.m1.1.1" xref="S2.p3.9.m1.1.1.cmml">p</mi><annotation-xml encoding="MathML-Content" id="S2.p3.9.m1.1b"><ci id="S2.p3.9.m1.1.1.cmml" xref="S2.p3.9.m1.1.1">𝑝</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.p3.9.m1.1c">p</annotation></semantics></math> denotes the personalized weights. On the other hand, the global shared weights are made up of
<math id="S2.p3.10.m2.11" class="ltx_Math" alttext="\mathbf{U}_{\mathbf{qkv},l}^{g}=[\mathbf{U}_{\mathbf{qkv},l,P_{l}+1},\cdots,\mathbf{U}_{\mathbf{qkv},l,K_{l}}]" display="inline"><semantics id="S2.p3.10.m2.11a"><mrow id="S2.p3.10.m2.11.11" xref="S2.p3.10.m2.11.11.cmml"><msubsup id="S2.p3.10.m2.11.11.4" xref="S2.p3.10.m2.11.11.4.cmml"><mi id="S2.p3.10.m2.11.11.4.2.2" xref="S2.p3.10.m2.11.11.4.2.2.cmml">𝐔</mi><mrow id="S2.p3.10.m2.2.2.2.4" xref="S2.p3.10.m2.2.2.2.3.cmml"><mi id="S2.p3.10.m2.1.1.1.1" xref="S2.p3.10.m2.1.1.1.1.cmml">𝐪𝐤𝐯</mi><mo id="S2.p3.10.m2.2.2.2.4.1" xref="S2.p3.10.m2.2.2.2.3.cmml">,</mo><mi id="S2.p3.10.m2.2.2.2.2" xref="S2.p3.10.m2.2.2.2.2.cmml">l</mi></mrow><mi id="S2.p3.10.m2.11.11.4.3" xref="S2.p3.10.m2.11.11.4.3.cmml">g</mi></msubsup><mo id="S2.p3.10.m2.11.11.3" xref="S2.p3.10.m2.11.11.3.cmml">=</mo><mrow id="S2.p3.10.m2.11.11.2.2" xref="S2.p3.10.m2.11.11.2.3.cmml"><mo stretchy="false" id="S2.p3.10.m2.11.11.2.2.3" xref="S2.p3.10.m2.11.11.2.3.cmml">[</mo><msub id="S2.p3.10.m2.10.10.1.1.1" xref="S2.p3.10.m2.10.10.1.1.1.cmml"><mi id="S2.p3.10.m2.10.10.1.1.1.2" xref="S2.p3.10.m2.10.10.1.1.1.2.cmml">𝐔</mi><mrow id="S2.p3.10.m2.5.5.3.3" xref="S2.p3.10.m2.5.5.3.4.cmml"><mi id="S2.p3.10.m2.3.3.1.1" xref="S2.p3.10.m2.3.3.1.1.cmml">𝐪𝐤𝐯</mi><mo id="S2.p3.10.m2.5.5.3.3.2" xref="S2.p3.10.m2.5.5.3.4.cmml">,</mo><mi id="S2.p3.10.m2.4.4.2.2" xref="S2.p3.10.m2.4.4.2.2.cmml">l</mi><mo id="S2.p3.10.m2.5.5.3.3.3" xref="S2.p3.10.m2.5.5.3.4.cmml">,</mo><mrow id="S2.p3.10.m2.5.5.3.3.1" xref="S2.p3.10.m2.5.5.3.3.1.cmml"><msub id="S2.p3.10.m2.5.5.3.3.1.2" xref="S2.p3.10.m2.5.5.3.3.1.2.cmml"><mi id="S2.p3.10.m2.5.5.3.3.1.2.2" xref="S2.p3.10.m2.5.5.3.3.1.2.2.cmml">P</mi><mi id="S2.p3.10.m2.5.5.3.3.1.2.3" xref="S2.p3.10.m2.5.5.3.3.1.2.3.cmml">l</mi></msub><mo id="S2.p3.10.m2.5.5.3.3.1.1" xref="S2.p3.10.m2.5.5.3.3.1.1.cmml">+</mo><mn id="S2.p3.10.m2.5.5.3.3.1.3" xref="S2.p3.10.m2.5.5.3.3.1.3.cmml">1</mn></mrow></mrow></msub><mo id="S2.p3.10.m2.11.11.2.2.4" xref="S2.p3.10.m2.11.11.2.3.cmml">,</mo><mi mathvariant="normal" id="S2.p3.10.m2.9.9" xref="S2.p3.10.m2.9.9.cmml">⋯</mi><mo id="S2.p3.10.m2.11.11.2.2.5" xref="S2.p3.10.m2.11.11.2.3.cmml">,</mo><msub id="S2.p3.10.m2.11.11.2.2.2" xref="S2.p3.10.m2.11.11.2.2.2.cmml"><mi id="S2.p3.10.m2.11.11.2.2.2.2" xref="S2.p3.10.m2.11.11.2.2.2.2.cmml">𝐔</mi><mrow id="S2.p3.10.m2.8.8.3.3" xref="S2.p3.10.m2.8.8.3.4.cmml"><mi id="S2.p3.10.m2.6.6.1.1" xref="S2.p3.10.m2.6.6.1.1.cmml">𝐪𝐤𝐯</mi><mo id="S2.p3.10.m2.8.8.3.3.2" xref="S2.p3.10.m2.8.8.3.4.cmml">,</mo><mi id="S2.p3.10.m2.7.7.2.2" xref="S2.p3.10.m2.7.7.2.2.cmml">l</mi><mo id="S2.p3.10.m2.8.8.3.3.3" xref="S2.p3.10.m2.8.8.3.4.cmml">,</mo><msub id="S2.p3.10.m2.8.8.3.3.1" xref="S2.p3.10.m2.8.8.3.3.1.cmml"><mi id="S2.p3.10.m2.8.8.3.3.1.2" xref="S2.p3.10.m2.8.8.3.3.1.2.cmml">K</mi><mi id="S2.p3.10.m2.8.8.3.3.1.3" xref="S2.p3.10.m2.8.8.3.3.1.3.cmml">l</mi></msub></mrow></msub><mo stretchy="false" id="S2.p3.10.m2.11.11.2.2.6" xref="S2.p3.10.m2.11.11.2.3.cmml">]</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.p3.10.m2.11b"><apply id="S2.p3.10.m2.11.11.cmml" xref="S2.p3.10.m2.11.11"><eq id="S2.p3.10.m2.11.11.3.cmml" xref="S2.p3.10.m2.11.11.3"></eq><apply id="S2.p3.10.m2.11.11.4.cmml" xref="S2.p3.10.m2.11.11.4"><csymbol cd="ambiguous" id="S2.p3.10.m2.11.11.4.1.cmml" xref="S2.p3.10.m2.11.11.4">superscript</csymbol><apply id="S2.p3.10.m2.11.11.4.2.cmml" xref="S2.p3.10.m2.11.11.4"><csymbol cd="ambiguous" id="S2.p3.10.m2.11.11.4.2.1.cmml" xref="S2.p3.10.m2.11.11.4">subscript</csymbol><ci id="S2.p3.10.m2.11.11.4.2.2.cmml" xref="S2.p3.10.m2.11.11.4.2.2">𝐔</ci><list id="S2.p3.10.m2.2.2.2.3.cmml" xref="S2.p3.10.m2.2.2.2.4"><ci id="S2.p3.10.m2.1.1.1.1.cmml" xref="S2.p3.10.m2.1.1.1.1">𝐪𝐤𝐯</ci><ci id="S2.p3.10.m2.2.2.2.2.cmml" xref="S2.p3.10.m2.2.2.2.2">𝑙</ci></list></apply><ci id="S2.p3.10.m2.11.11.4.3.cmml" xref="S2.p3.10.m2.11.11.4.3">𝑔</ci></apply><list id="S2.p3.10.m2.11.11.2.3.cmml" xref="S2.p3.10.m2.11.11.2.2"><apply id="S2.p3.10.m2.10.10.1.1.1.cmml" xref="S2.p3.10.m2.10.10.1.1.1"><csymbol cd="ambiguous" id="S2.p3.10.m2.10.10.1.1.1.1.cmml" xref="S2.p3.10.m2.10.10.1.1.1">subscript</csymbol><ci id="S2.p3.10.m2.10.10.1.1.1.2.cmml" xref="S2.p3.10.m2.10.10.1.1.1.2">𝐔</ci><list id="S2.p3.10.m2.5.5.3.4.cmml" xref="S2.p3.10.m2.5.5.3.3"><ci id="S2.p3.10.m2.3.3.1.1.cmml" xref="S2.p3.10.m2.3.3.1.1">𝐪𝐤𝐯</ci><ci id="S2.p3.10.m2.4.4.2.2.cmml" xref="S2.p3.10.m2.4.4.2.2">𝑙</ci><apply id="S2.p3.10.m2.5.5.3.3.1.cmml" xref="S2.p3.10.m2.5.5.3.3.1"><plus id="S2.p3.10.m2.5.5.3.3.1.1.cmml" xref="S2.p3.10.m2.5.5.3.3.1.1"></plus><apply id="S2.p3.10.m2.5.5.3.3.1.2.cmml" xref="S2.p3.10.m2.5.5.3.3.1.2"><csymbol cd="ambiguous" id="S2.p3.10.m2.5.5.3.3.1.2.1.cmml" xref="S2.p3.10.m2.5.5.3.3.1.2">subscript</csymbol><ci id="S2.p3.10.m2.5.5.3.3.1.2.2.cmml" xref="S2.p3.10.m2.5.5.3.3.1.2.2">𝑃</ci><ci id="S2.p3.10.m2.5.5.3.3.1.2.3.cmml" xref="S2.p3.10.m2.5.5.3.3.1.2.3">𝑙</ci></apply><cn type="integer" id="S2.p3.10.m2.5.5.3.3.1.3.cmml" xref="S2.p3.10.m2.5.5.3.3.1.3">1</cn></apply></list></apply><ci id="S2.p3.10.m2.9.9.cmml" xref="S2.p3.10.m2.9.9">⋯</ci><apply id="S2.p3.10.m2.11.11.2.2.2.cmml" xref="S2.p3.10.m2.11.11.2.2.2"><csymbol cd="ambiguous" id="S2.p3.10.m2.11.11.2.2.2.1.cmml" xref="S2.p3.10.m2.11.11.2.2.2">subscript</csymbol><ci id="S2.p3.10.m2.11.11.2.2.2.2.cmml" xref="S2.p3.10.m2.11.11.2.2.2.2">𝐔</ci><list id="S2.p3.10.m2.8.8.3.4.cmml" xref="S2.p3.10.m2.8.8.3.3"><ci id="S2.p3.10.m2.6.6.1.1.cmml" xref="S2.p3.10.m2.6.6.1.1">𝐪𝐤𝐯</ci><ci id="S2.p3.10.m2.7.7.2.2.cmml" xref="S2.p3.10.m2.7.7.2.2">𝑙</ci><apply id="S2.p3.10.m2.8.8.3.3.1.cmml" xref="S2.p3.10.m2.8.8.3.3.1"><csymbol cd="ambiguous" id="S2.p3.10.m2.8.8.3.3.1.1.cmml" xref="S2.p3.10.m2.8.8.3.3.1">subscript</csymbol><ci id="S2.p3.10.m2.8.8.3.3.1.2.cmml" xref="S2.p3.10.m2.8.8.3.3.1.2">𝐾</ci><ci id="S2.p3.10.m2.8.8.3.3.1.3.cmml" xref="S2.p3.10.m2.8.8.3.3.1.3">𝑙</ci></apply></list></apply></list></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.p3.10.m2.11c">\mathbf{U}_{\mathbf{qkv},l}^{g}=[\mathbf{U}_{\mathbf{qkv},l,P_{l}+1},\cdots,\mathbf{U}_{\mathbf{qkv},l,K_{l}}]</annotation></semantics></math> and <math id="S2.p3.11.m3.11" class="ltx_Math" alttext="\mathbf{U}_{\mathbf{msa},l}^{g}=[\mathbf{U}_{\mathbf{msa},l,P_{l}+1},\cdots,\mathbf{U}_{\mathbf{msa},P_{l}+1,K_{l}}]" display="inline"><semantics id="S2.p3.11.m3.11a"><mrow id="S2.p3.11.m3.11.11" xref="S2.p3.11.m3.11.11.cmml"><msubsup id="S2.p3.11.m3.11.11.4" xref="S2.p3.11.m3.11.11.4.cmml"><mi id="S2.p3.11.m3.11.11.4.2.2" xref="S2.p3.11.m3.11.11.4.2.2.cmml">𝐔</mi><mrow id="S2.p3.11.m3.2.2.2.4" xref="S2.p3.11.m3.2.2.2.3.cmml"><mi id="S2.p3.11.m3.1.1.1.1" xref="S2.p3.11.m3.1.1.1.1.cmml">𝐦𝐬𝐚</mi><mo id="S2.p3.11.m3.2.2.2.4.1" xref="S2.p3.11.m3.2.2.2.3.cmml">,</mo><mi id="S2.p3.11.m3.2.2.2.2" xref="S2.p3.11.m3.2.2.2.2.cmml">l</mi></mrow><mi id="S2.p3.11.m3.11.11.4.3" xref="S2.p3.11.m3.11.11.4.3.cmml">g</mi></msubsup><mo id="S2.p3.11.m3.11.11.3" xref="S2.p3.11.m3.11.11.3.cmml">=</mo><mrow id="S2.p3.11.m3.11.11.2.2" xref="S2.p3.11.m3.11.11.2.3.cmml"><mo stretchy="false" id="S2.p3.11.m3.11.11.2.2.3" xref="S2.p3.11.m3.11.11.2.3.cmml">[</mo><msub id="S2.p3.11.m3.10.10.1.1.1" xref="S2.p3.11.m3.10.10.1.1.1.cmml"><mi id="S2.p3.11.m3.10.10.1.1.1.2" xref="S2.p3.11.m3.10.10.1.1.1.2.cmml">𝐔</mi><mrow id="S2.p3.11.m3.5.5.3.3" xref="S2.p3.11.m3.5.5.3.4.cmml"><mi id="S2.p3.11.m3.3.3.1.1" xref="S2.p3.11.m3.3.3.1.1.cmml">𝐦𝐬𝐚</mi><mo id="S2.p3.11.m3.5.5.3.3.2" xref="S2.p3.11.m3.5.5.3.4.cmml">,</mo><mi id="S2.p3.11.m3.4.4.2.2" xref="S2.p3.11.m3.4.4.2.2.cmml">l</mi><mo id="S2.p3.11.m3.5.5.3.3.3" xref="S2.p3.11.m3.5.5.3.4.cmml">,</mo><mrow id="S2.p3.11.m3.5.5.3.3.1" xref="S2.p3.11.m3.5.5.3.3.1.cmml"><msub id="S2.p3.11.m3.5.5.3.3.1.2" xref="S2.p3.11.m3.5.5.3.3.1.2.cmml"><mi id="S2.p3.11.m3.5.5.3.3.1.2.2" xref="S2.p3.11.m3.5.5.3.3.1.2.2.cmml">P</mi><mi id="S2.p3.11.m3.5.5.3.3.1.2.3" xref="S2.p3.11.m3.5.5.3.3.1.2.3.cmml">l</mi></msub><mo id="S2.p3.11.m3.5.5.3.3.1.1" xref="S2.p3.11.m3.5.5.3.3.1.1.cmml">+</mo><mn id="S2.p3.11.m3.5.5.3.3.1.3" xref="S2.p3.11.m3.5.5.3.3.1.3.cmml">1</mn></mrow></mrow></msub><mo id="S2.p3.11.m3.11.11.2.2.4" xref="S2.p3.11.m3.11.11.2.3.cmml">,</mo><mi mathvariant="normal" id="S2.p3.11.m3.9.9" xref="S2.p3.11.m3.9.9.cmml">⋯</mi><mo id="S2.p3.11.m3.11.11.2.2.5" xref="S2.p3.11.m3.11.11.2.3.cmml">,</mo><msub id="S2.p3.11.m3.11.11.2.2.2" xref="S2.p3.11.m3.11.11.2.2.2.cmml"><mi id="S2.p3.11.m3.11.11.2.2.2.2" xref="S2.p3.11.m3.11.11.2.2.2.2.cmml">𝐔</mi><mrow id="S2.p3.11.m3.8.8.3.3" xref="S2.p3.11.m3.8.8.3.4.cmml"><mi id="S2.p3.11.m3.6.6.1.1" xref="S2.p3.11.m3.6.6.1.1.cmml">𝐦𝐬𝐚</mi><mo id="S2.p3.11.m3.8.8.3.3.3" xref="S2.p3.11.m3.8.8.3.4.cmml">,</mo><mrow id="S2.p3.11.m3.7.7.2.2.1" xref="S2.p3.11.m3.7.7.2.2.1.cmml"><msub id="S2.p3.11.m3.7.7.2.2.1.2" xref="S2.p3.11.m3.7.7.2.2.1.2.cmml"><mi id="S2.p3.11.m3.7.7.2.2.1.2.2" xref="S2.p3.11.m3.7.7.2.2.1.2.2.cmml">P</mi><mi id="S2.p3.11.m3.7.7.2.2.1.2.3" xref="S2.p3.11.m3.7.7.2.2.1.2.3.cmml">l</mi></msub><mo id="S2.p3.11.m3.7.7.2.2.1.1" xref="S2.p3.11.m3.7.7.2.2.1.1.cmml">+</mo><mn id="S2.p3.11.m3.7.7.2.2.1.3" xref="S2.p3.11.m3.7.7.2.2.1.3.cmml">1</mn></mrow><mo id="S2.p3.11.m3.8.8.3.3.4" xref="S2.p3.11.m3.8.8.3.4.cmml">,</mo><msub id="S2.p3.11.m3.8.8.3.3.2" xref="S2.p3.11.m3.8.8.3.3.2.cmml"><mi id="S2.p3.11.m3.8.8.3.3.2.2" xref="S2.p3.11.m3.8.8.3.3.2.2.cmml">K</mi><mi id="S2.p3.11.m3.8.8.3.3.2.3" xref="S2.p3.11.m3.8.8.3.3.2.3.cmml">l</mi></msub></mrow></msub><mo stretchy="false" id="S2.p3.11.m3.11.11.2.2.6" xref="S2.p3.11.m3.11.11.2.3.cmml">]</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.p3.11.m3.11b"><apply id="S2.p3.11.m3.11.11.cmml" xref="S2.p3.11.m3.11.11"><eq id="S2.p3.11.m3.11.11.3.cmml" xref="S2.p3.11.m3.11.11.3"></eq><apply id="S2.p3.11.m3.11.11.4.cmml" xref="S2.p3.11.m3.11.11.4"><csymbol cd="ambiguous" id="S2.p3.11.m3.11.11.4.1.cmml" xref="S2.p3.11.m3.11.11.4">superscript</csymbol><apply id="S2.p3.11.m3.11.11.4.2.cmml" xref="S2.p3.11.m3.11.11.4"><csymbol cd="ambiguous" id="S2.p3.11.m3.11.11.4.2.1.cmml" xref="S2.p3.11.m3.11.11.4">subscript</csymbol><ci id="S2.p3.11.m3.11.11.4.2.2.cmml" xref="S2.p3.11.m3.11.11.4.2.2">𝐔</ci><list id="S2.p3.11.m3.2.2.2.3.cmml" xref="S2.p3.11.m3.2.2.2.4"><ci id="S2.p3.11.m3.1.1.1.1.cmml" xref="S2.p3.11.m3.1.1.1.1">𝐦𝐬𝐚</ci><ci id="S2.p3.11.m3.2.2.2.2.cmml" xref="S2.p3.11.m3.2.2.2.2">𝑙</ci></list></apply><ci id="S2.p3.11.m3.11.11.4.3.cmml" xref="S2.p3.11.m3.11.11.4.3">𝑔</ci></apply><list id="S2.p3.11.m3.11.11.2.3.cmml" xref="S2.p3.11.m3.11.11.2.2"><apply id="S2.p3.11.m3.10.10.1.1.1.cmml" xref="S2.p3.11.m3.10.10.1.1.1"><csymbol cd="ambiguous" id="S2.p3.11.m3.10.10.1.1.1.1.cmml" xref="S2.p3.11.m3.10.10.1.1.1">subscript</csymbol><ci id="S2.p3.11.m3.10.10.1.1.1.2.cmml" xref="S2.p3.11.m3.10.10.1.1.1.2">𝐔</ci><list id="S2.p3.11.m3.5.5.3.4.cmml" xref="S2.p3.11.m3.5.5.3.3"><ci id="S2.p3.11.m3.3.3.1.1.cmml" xref="S2.p3.11.m3.3.3.1.1">𝐦𝐬𝐚</ci><ci id="S2.p3.11.m3.4.4.2.2.cmml" xref="S2.p3.11.m3.4.4.2.2">𝑙</ci><apply id="S2.p3.11.m3.5.5.3.3.1.cmml" xref="S2.p3.11.m3.5.5.3.3.1"><plus id="S2.p3.11.m3.5.5.3.3.1.1.cmml" xref="S2.p3.11.m3.5.5.3.3.1.1"></plus><apply id="S2.p3.11.m3.5.5.3.3.1.2.cmml" xref="S2.p3.11.m3.5.5.3.3.1.2"><csymbol cd="ambiguous" id="S2.p3.11.m3.5.5.3.3.1.2.1.cmml" xref="S2.p3.11.m3.5.5.3.3.1.2">subscript</csymbol><ci id="S2.p3.11.m3.5.5.3.3.1.2.2.cmml" xref="S2.p3.11.m3.5.5.3.3.1.2.2">𝑃</ci><ci id="S2.p3.11.m3.5.5.3.3.1.2.3.cmml" xref="S2.p3.11.m3.5.5.3.3.1.2.3">𝑙</ci></apply><cn type="integer" id="S2.p3.11.m3.5.5.3.3.1.3.cmml" xref="S2.p3.11.m3.5.5.3.3.1.3">1</cn></apply></list></apply><ci id="S2.p3.11.m3.9.9.cmml" xref="S2.p3.11.m3.9.9">⋯</ci><apply id="S2.p3.11.m3.11.11.2.2.2.cmml" xref="S2.p3.11.m3.11.11.2.2.2"><csymbol cd="ambiguous" id="S2.p3.11.m3.11.11.2.2.2.1.cmml" xref="S2.p3.11.m3.11.11.2.2.2">subscript</csymbol><ci id="S2.p3.11.m3.11.11.2.2.2.2.cmml" xref="S2.p3.11.m3.11.11.2.2.2.2">𝐔</ci><list id="S2.p3.11.m3.8.8.3.4.cmml" xref="S2.p3.11.m3.8.8.3.3"><ci id="S2.p3.11.m3.6.6.1.1.cmml" xref="S2.p3.11.m3.6.6.1.1">𝐦𝐬𝐚</ci><apply id="S2.p3.11.m3.7.7.2.2.1.cmml" xref="S2.p3.11.m3.7.7.2.2.1"><plus id="S2.p3.11.m3.7.7.2.2.1.1.cmml" xref="S2.p3.11.m3.7.7.2.2.1.1"></plus><apply id="S2.p3.11.m3.7.7.2.2.1.2.cmml" xref="S2.p3.11.m3.7.7.2.2.1.2"><csymbol cd="ambiguous" id="S2.p3.11.m3.7.7.2.2.1.2.1.cmml" xref="S2.p3.11.m3.7.7.2.2.1.2">subscript</csymbol><ci id="S2.p3.11.m3.7.7.2.2.1.2.2.cmml" xref="S2.p3.11.m3.7.7.2.2.1.2.2">𝑃</ci><ci id="S2.p3.11.m3.7.7.2.2.1.2.3.cmml" xref="S2.p3.11.m3.7.7.2.2.1.2.3">𝑙</ci></apply><cn type="integer" id="S2.p3.11.m3.7.7.2.2.1.3.cmml" xref="S2.p3.11.m3.7.7.2.2.1.3">1</cn></apply><apply id="S2.p3.11.m3.8.8.3.3.2.cmml" xref="S2.p3.11.m3.8.8.3.3.2"><csymbol cd="ambiguous" id="S2.p3.11.m3.8.8.3.3.2.1.cmml" xref="S2.p3.11.m3.8.8.3.3.2">subscript</csymbol><ci id="S2.p3.11.m3.8.8.3.3.2.2.cmml" xref="S2.p3.11.m3.8.8.3.3.2.2">𝐾</ci><ci id="S2.p3.11.m3.8.8.3.3.2.3.cmml" xref="S2.p3.11.m3.8.8.3.3.2.3">𝑙</ci></apply></list></apply></list></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.p3.11.m3.11c">\mathbf{U}_{\mathbf{msa},l}^{g}=[\mathbf{U}_{\mathbf{msa},l,P_{l}+1},\cdots,\mathbf{U}_{\mathbf{msa},P_{l}+1,K_{l}}]</annotation></semantics></math>,
where superscript <math id="S2.p3.12.m4.1" class="ltx_Math" alttext="p" display="inline"><semantics id="S2.p3.12.m4.1a"><mi id="S2.p3.12.m4.1.1" xref="S2.p3.12.m4.1.1.cmml">p</mi><annotation-xml encoding="MathML-Content" id="S2.p3.12.m4.1b"><ci id="S2.p3.12.m4.1.1.cmml" xref="S2.p3.12.m4.1.1">𝑝</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.p3.12.m4.1c">p</annotation></semantics></math> denotes the personalized weights. The global shared weights will be uploaded to the central server and aggregated by <span id="S2.p3.17.2" class="ltx_text ltx_font_smallcaps">FedAvg</span> in the training stage <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib15" title="" class="ltx_ref">15</a>]</cite> to extract the global shared attentions. For model simplicity, we use a uniform personalization ratio for all MSAs <span id="S2.p3.13.1" class="ltx_text ltx_font_italic">i.e. <math id="S2.p3.13.1.m1.2" class="ltx_Math" alttext="\frac{P_{l}}{K_{l}}=p\in(0,1)" display="inline"><semantics id="S2.p3.13.1.m1.2a"><mrow id="S2.p3.13.1.m1.2.3" xref="S2.p3.13.1.m1.2.3.cmml"><mfrac id="S2.p3.13.1.m1.2.3.2" xref="S2.p3.13.1.m1.2.3.2.cmml"><msub id="S2.p3.13.1.m1.2.3.2.2" xref="S2.p3.13.1.m1.2.3.2.2.cmml"><mi id="S2.p3.13.1.m1.2.3.2.2.2" xref="S2.p3.13.1.m1.2.3.2.2.2.cmml">P</mi><mi id="S2.p3.13.1.m1.2.3.2.2.3" xref="S2.p3.13.1.m1.2.3.2.2.3.cmml">l</mi></msub><msub id="S2.p3.13.1.m1.2.3.2.3" xref="S2.p3.13.1.m1.2.3.2.3.cmml"><mi id="S2.p3.13.1.m1.2.3.2.3.2" xref="S2.p3.13.1.m1.2.3.2.3.2.cmml">K</mi><mi id="S2.p3.13.1.m1.2.3.2.3.3" xref="S2.p3.13.1.m1.2.3.2.3.3.cmml">l</mi></msub></mfrac><mo id="S2.p3.13.1.m1.2.3.3" xref="S2.p3.13.1.m1.2.3.3.cmml">=</mo><mi id="S2.p3.13.1.m1.2.3.4" xref="S2.p3.13.1.m1.2.3.4.cmml">p</mi><mo id="S2.p3.13.1.m1.2.3.5" xref="S2.p3.13.1.m1.2.3.5.cmml">∈</mo><mrow id="S2.p3.13.1.m1.2.3.6.2" xref="S2.p3.13.1.m1.2.3.6.1.cmml"><mo stretchy="false" id="S2.p3.13.1.m1.2.3.6.2.1" xref="S2.p3.13.1.m1.2.3.6.1.cmml">(</mo><mn id="S2.p3.13.1.m1.1.1" xref="S2.p3.13.1.m1.1.1.cmml">0</mn><mo id="S2.p3.13.1.m1.2.3.6.2.2" xref="S2.p3.13.1.m1.2.3.6.1.cmml">,</mo><mn id="S2.p3.13.1.m1.2.2" xref="S2.p3.13.1.m1.2.2.cmml">1</mn><mo stretchy="false" id="S2.p3.13.1.m1.2.3.6.2.3" xref="S2.p3.13.1.m1.2.3.6.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.p3.13.1.m1.2b"><apply id="S2.p3.13.1.m1.2.3.cmml" xref="S2.p3.13.1.m1.2.3"><and id="S2.p3.13.1.m1.2.3a.cmml" xref="S2.p3.13.1.m1.2.3"></and><apply id="S2.p3.13.1.m1.2.3b.cmml" xref="S2.p3.13.1.m1.2.3"><eq id="S2.p3.13.1.m1.2.3.3.cmml" xref="S2.p3.13.1.m1.2.3.3"></eq><apply id="S2.p3.13.1.m1.2.3.2.cmml" xref="S2.p3.13.1.m1.2.3.2"><divide id="S2.p3.13.1.m1.2.3.2.1.cmml" xref="S2.p3.13.1.m1.2.3.2"></divide><apply id="S2.p3.13.1.m1.2.3.2.2.cmml" xref="S2.p3.13.1.m1.2.3.2.2"><csymbol cd="ambiguous" id="S2.p3.13.1.m1.2.3.2.2.1.cmml" xref="S2.p3.13.1.m1.2.3.2.2">subscript</csymbol><ci id="S2.p3.13.1.m1.2.3.2.2.2.cmml" xref="S2.p3.13.1.m1.2.3.2.2.2">𝑃</ci><ci id="S2.p3.13.1.m1.2.3.2.2.3.cmml" xref="S2.p3.13.1.m1.2.3.2.2.3">𝑙</ci></apply><apply id="S2.p3.13.1.m1.2.3.2.3.cmml" xref="S2.p3.13.1.m1.2.3.2.3"><csymbol cd="ambiguous" id="S2.p3.13.1.m1.2.3.2.3.1.cmml" xref="S2.p3.13.1.m1.2.3.2.3">subscript</csymbol><ci id="S2.p3.13.1.m1.2.3.2.3.2.cmml" xref="S2.p3.13.1.m1.2.3.2.3.2">𝐾</ci><ci id="S2.p3.13.1.m1.2.3.2.3.3.cmml" xref="S2.p3.13.1.m1.2.3.2.3.3">𝑙</ci></apply></apply><ci id="S2.p3.13.1.m1.2.3.4.cmml" xref="S2.p3.13.1.m1.2.3.4">𝑝</ci></apply><apply id="S2.p3.13.1.m1.2.3c.cmml" xref="S2.p3.13.1.m1.2.3"><in id="S2.p3.13.1.m1.2.3.5.cmml" xref="S2.p3.13.1.m1.2.3.5"></in><share href="#S2.p3.13.1.m1.2.3.4.cmml" id="S2.p3.13.1.m1.2.3d.cmml" xref="S2.p3.13.1.m1.2.3"></share><interval closure="open" id="S2.p3.13.1.m1.2.3.6.1.cmml" xref="S2.p3.13.1.m1.2.3.6.2"><cn type="integer" id="S2.p3.13.1.m1.1.1.cmml" xref="S2.p3.13.1.m1.1.1">0</cn><cn type="integer" id="S2.p3.13.1.m1.2.2.cmml" xref="S2.p3.13.1.m1.2.2">1</cn></interval></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.p3.13.1.m1.2c">\frac{P_{l}}{K_{l}}=p\in(0,1)</annotation></semantics></math></span> for <math id="S2.p3.14.m5.2" class="ltx_Math" alttext="l=1,\cdots L" display="inline"><semantics id="S2.p3.14.m5.2a"><mrow id="S2.p3.14.m5.2.2" xref="S2.p3.14.m5.2.2.cmml"><mi id="S2.p3.14.m5.2.2.3" xref="S2.p3.14.m5.2.2.3.cmml">l</mi><mo id="S2.p3.14.m5.2.2.2" xref="S2.p3.14.m5.2.2.2.cmml">=</mo><mrow id="S2.p3.14.m5.2.2.1.1" xref="S2.p3.14.m5.2.2.1.2.cmml"><mn id="S2.p3.14.m5.1.1" xref="S2.p3.14.m5.1.1.cmml">1</mn><mo id="S2.p3.14.m5.2.2.1.1.2" xref="S2.p3.14.m5.2.2.1.2.cmml">,</mo><mrow id="S2.p3.14.m5.2.2.1.1.1" xref="S2.p3.14.m5.2.2.1.1.1.cmml"><mi mathvariant="normal" id="S2.p3.14.m5.2.2.1.1.1.2" xref="S2.p3.14.m5.2.2.1.1.1.2.cmml">⋯</mi><mo lspace="0em" rspace="0em" id="S2.p3.14.m5.2.2.1.1.1.1" xref="S2.p3.14.m5.2.2.1.1.1.1.cmml">​</mo><mi id="S2.p3.14.m5.2.2.1.1.1.3" xref="S2.p3.14.m5.2.2.1.1.1.3.cmml">L</mi></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.p3.14.m5.2b"><apply id="S2.p3.14.m5.2.2.cmml" xref="S2.p3.14.m5.2.2"><eq id="S2.p3.14.m5.2.2.2.cmml" xref="S2.p3.14.m5.2.2.2"></eq><ci id="S2.p3.14.m5.2.2.3.cmml" xref="S2.p3.14.m5.2.2.3">𝑙</ci><list id="S2.p3.14.m5.2.2.1.2.cmml" xref="S2.p3.14.m5.2.2.1.1"><cn type="integer" id="S2.p3.14.m5.1.1.cmml" xref="S2.p3.14.m5.1.1">1</cn><apply id="S2.p3.14.m5.2.2.1.1.1.cmml" xref="S2.p3.14.m5.2.2.1.1.1"><times id="S2.p3.14.m5.2.2.1.1.1.1.cmml" xref="S2.p3.14.m5.2.2.1.1.1.1"></times><ci id="S2.p3.14.m5.2.2.1.1.1.2.cmml" xref="S2.p3.14.m5.2.2.1.1.1.2">⋯</ci><ci id="S2.p3.14.m5.2.2.1.1.1.3.cmml" xref="S2.p3.14.m5.2.2.1.1.1.3">𝐿</ci></apply></list></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.p3.14.m5.2c">l=1,\cdots L</annotation></semantics></math>. Then, the value of <math id="S2.p3.15.m6.1" class="ltx_Math" alttext="p" display="inline"><semantics id="S2.p3.15.m6.1a"><mi id="S2.p3.15.m6.1.1" xref="S2.p3.15.m6.1.1.cmml">p</mi><annotation-xml encoding="MathML-Content" id="S2.p3.15.m6.1b"><ci id="S2.p3.15.m6.1.1.cmml" xref="S2.p3.15.m6.1.1">𝑝</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.p3.15.m6.1c">p</annotation></semantics></math> determines the strength of model personalization. For example, <math id="S2.p3.16.m7.1" class="ltx_Math" alttext="p=1" display="inline"><semantics id="S2.p3.16.m7.1a"><mrow id="S2.p3.16.m7.1.1" xref="S2.p3.16.m7.1.1.cmml"><mi id="S2.p3.16.m7.1.1.2" xref="S2.p3.16.m7.1.1.2.cmml">p</mi><mo id="S2.p3.16.m7.1.1.1" xref="S2.p3.16.m7.1.1.1.cmml">=</mo><mn id="S2.p3.16.m7.1.1.3" xref="S2.p3.16.m7.1.1.3.cmml">1</mn></mrow><annotation-xml encoding="MathML-Content" id="S2.p3.16.m7.1b"><apply id="S2.p3.16.m7.1.1.cmml" xref="S2.p3.16.m7.1.1"><eq id="S2.p3.16.m7.1.1.1.cmml" xref="S2.p3.16.m7.1.1.1"></eq><ci id="S2.p3.16.m7.1.1.2.cmml" xref="S2.p3.16.m7.1.1.2">𝑝</ci><cn type="integer" id="S2.p3.16.m7.1.1.3.cmml" xref="S2.p3.16.m7.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.p3.16.m7.1c">p=1</annotation></semantics></math> degrades the method to be a local training way i.e., no shared parameters via the central server except the MLP layers; while <math id="S2.p3.17.m8.1" class="ltx_Math" alttext="p=0" display="inline"><semantics id="S2.p3.17.m8.1a"><mrow id="S2.p3.17.m8.1.1" xref="S2.p3.17.m8.1.1.cmml"><mi id="S2.p3.17.m8.1.1.2" xref="S2.p3.17.m8.1.1.2.cmml">p</mi><mo id="S2.p3.17.m8.1.1.1" xref="S2.p3.17.m8.1.1.1.cmml">=</mo><mn id="S2.p3.17.m8.1.1.3" xref="S2.p3.17.m8.1.1.3.cmml">0</mn></mrow><annotation-xml encoding="MathML-Content" id="S2.p3.17.m8.1b"><apply id="S2.p3.17.m8.1.1.cmml" xref="S2.p3.17.m8.1.1"><eq id="S2.p3.17.m8.1.1.1.cmml" xref="S2.p3.17.m8.1.1.1"></eq><ci id="S2.p3.17.m8.1.1.2.cmml" xref="S2.p3.17.m8.1.1.2">𝑝</ci><cn type="integer" id="S2.p3.17.m8.1.1.3.cmml" xref="S2.p3.17.m8.1.1.3">0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.p3.17.m8.1c">p=0</annotation></semantics></math> becomes the vanilla <span id="S2.p3.17.3" class="ltx_text ltx_font_smallcaps">FedAvg</span>. The overall architecture of our proposed partial personalization scheme for attention layers is depicted in Fig. <a href="#S1.F1" title="Figure 1 ‣ I Introduction ‣ Federated Learning for Chronic Obstructive Pulmonary Disease Classification with Partial Personalized Attention Mechanism *Corresponding Author. Email: chenweidao163@163.com." class="ltx_ref"><span class="ltx_text ltx_ref_tag">1</span></a>.</p>
</div>
<div id="S2.p4" class="ltx_para">
<p id="S2.p4.4" class="ltx_p"><span id="S2.p4.4.2" class="ltx_text ltx_font_bold">Consistency Regularization between Local Personalized and Global Shared Weights.</span> The partial personalization scheme enables us to impose an additional regularization on the local personalized weights. We term the globally shared subnet in ViT excluding all personalized MSA weights <span id="S2.p4.1.1" class="ltx_text ltx_font_italic">i.e. <math id="S2.p4.1.1.m1.9" class="ltx_Math" alttext="\{\mathbf{U}_{\mathbf{qkv},l}^{p},\mathbf{U}_{\mathbf{msa},l}^{p}|l=1,\cdots,L\}" display="inline"><semantics id="S2.p4.1.1.m1.9a"><mrow id="S2.p4.1.1.m1.9.9.2" xref="S2.p4.1.1.m1.9.9.3.cmml"><mo stretchy="false" id="S2.p4.1.1.m1.9.9.2.3" xref="S2.p4.1.1.m1.9.9.3.1.cmml">{</mo><mrow id="S2.p4.1.1.m1.8.8.1.1.2" xref="S2.p4.1.1.m1.8.8.1.1.3.cmml"><msubsup id="S2.p4.1.1.m1.8.8.1.1.1.1" xref="S2.p4.1.1.m1.8.8.1.1.1.1.cmml"><mi id="S2.p4.1.1.m1.8.8.1.1.1.1.2.2" xref="S2.p4.1.1.m1.8.8.1.1.1.1.2.2.cmml">𝐔</mi><mrow id="S2.p4.1.1.m1.2.2.2.4" xref="S2.p4.1.1.m1.2.2.2.3.cmml"><mi id="S2.p4.1.1.m1.1.1.1.1" xref="S2.p4.1.1.m1.1.1.1.1.cmml">𝐪𝐤𝐯</mi><mo id="S2.p4.1.1.m1.2.2.2.4.1" xref="S2.p4.1.1.m1.2.2.2.3.cmml">,</mo><mi id="S2.p4.1.1.m1.2.2.2.2" xref="S2.p4.1.1.m1.2.2.2.2.cmml">l</mi></mrow><mi id="S2.p4.1.1.m1.8.8.1.1.1.1.3" xref="S2.p4.1.1.m1.8.8.1.1.1.1.3.cmml">p</mi></msubsup><mo id="S2.p4.1.1.m1.8.8.1.1.2.3" xref="S2.p4.1.1.m1.8.8.1.1.3.cmml">,</mo><msubsup id="S2.p4.1.1.m1.8.8.1.1.2.2" xref="S2.p4.1.1.m1.8.8.1.1.2.2.cmml"><mi id="S2.p4.1.1.m1.8.8.1.1.2.2.2.2" xref="S2.p4.1.1.m1.8.8.1.1.2.2.2.2.cmml">𝐔</mi><mrow id="S2.p4.1.1.m1.4.4.2.4" xref="S2.p4.1.1.m1.4.4.2.3.cmml"><mi id="S2.p4.1.1.m1.3.3.1.1" xref="S2.p4.1.1.m1.3.3.1.1.cmml">𝐦𝐬𝐚</mi><mo id="S2.p4.1.1.m1.4.4.2.4.1" xref="S2.p4.1.1.m1.4.4.2.3.cmml">,</mo><mi id="S2.p4.1.1.m1.4.4.2.2" xref="S2.p4.1.1.m1.4.4.2.2.cmml">l</mi></mrow><mi id="S2.p4.1.1.m1.8.8.1.1.2.2.3" xref="S2.p4.1.1.m1.8.8.1.1.2.2.3.cmml">p</mi></msubsup></mrow><mo lspace="0em" rspace="0em" id="S2.p4.1.1.m1.9.9.2.4" xref="S2.p4.1.1.m1.9.9.3.1.cmml">|</mo><mrow id="S2.p4.1.1.m1.9.9.2.2" xref="S2.p4.1.1.m1.9.9.2.2.cmml"><mi id="S2.p4.1.1.m1.9.9.2.2.2" xref="S2.p4.1.1.m1.9.9.2.2.2.cmml">l</mi><mo id="S2.p4.1.1.m1.9.9.2.2.1" xref="S2.p4.1.1.m1.9.9.2.2.1.cmml">=</mo><mrow id="S2.p4.1.1.m1.9.9.2.2.3.2" xref="S2.p4.1.1.m1.9.9.2.2.3.1.cmml"><mn id="S2.p4.1.1.m1.5.5" xref="S2.p4.1.1.m1.5.5.cmml">1</mn><mo id="S2.p4.1.1.m1.9.9.2.2.3.2.1" xref="S2.p4.1.1.m1.9.9.2.2.3.1.cmml">,</mo><mi mathvariant="normal" id="S2.p4.1.1.m1.6.6" xref="S2.p4.1.1.m1.6.6.cmml">⋯</mi><mo id="S2.p4.1.1.m1.9.9.2.2.3.2.2" xref="S2.p4.1.1.m1.9.9.2.2.3.1.cmml">,</mo><mi id="S2.p4.1.1.m1.7.7" xref="S2.p4.1.1.m1.7.7.cmml">L</mi></mrow></mrow><mo stretchy="false" id="S2.p4.1.1.m1.9.9.2.5" xref="S2.p4.1.1.m1.9.9.3.1.cmml">}</mo></mrow><annotation-xml encoding="MathML-Content" id="S2.p4.1.1.m1.9b"><apply id="S2.p4.1.1.m1.9.9.3.cmml" xref="S2.p4.1.1.m1.9.9.2"><csymbol cd="latexml" id="S2.p4.1.1.m1.9.9.3.1.cmml" xref="S2.p4.1.1.m1.9.9.2.3">conditional-set</csymbol><list id="S2.p4.1.1.m1.8.8.1.1.3.cmml" xref="S2.p4.1.1.m1.8.8.1.1.2"><apply id="S2.p4.1.1.m1.8.8.1.1.1.1.cmml" xref="S2.p4.1.1.m1.8.8.1.1.1.1"><csymbol cd="ambiguous" id="S2.p4.1.1.m1.8.8.1.1.1.1.1.cmml" xref="S2.p4.1.1.m1.8.8.1.1.1.1">superscript</csymbol><apply id="S2.p4.1.1.m1.8.8.1.1.1.1.2.cmml" xref="S2.p4.1.1.m1.8.8.1.1.1.1"><csymbol cd="ambiguous" id="S2.p4.1.1.m1.8.8.1.1.1.1.2.1.cmml" xref="S2.p4.1.1.m1.8.8.1.1.1.1">subscript</csymbol><ci id="S2.p4.1.1.m1.8.8.1.1.1.1.2.2.cmml" xref="S2.p4.1.1.m1.8.8.1.1.1.1.2.2">𝐔</ci><list id="S2.p4.1.1.m1.2.2.2.3.cmml" xref="S2.p4.1.1.m1.2.2.2.4"><ci id="S2.p4.1.1.m1.1.1.1.1.cmml" xref="S2.p4.1.1.m1.1.1.1.1">𝐪𝐤𝐯</ci><ci id="S2.p4.1.1.m1.2.2.2.2.cmml" xref="S2.p4.1.1.m1.2.2.2.2">𝑙</ci></list></apply><ci id="S2.p4.1.1.m1.8.8.1.1.1.1.3.cmml" xref="S2.p4.1.1.m1.8.8.1.1.1.1.3">𝑝</ci></apply><apply id="S2.p4.1.1.m1.8.8.1.1.2.2.cmml" xref="S2.p4.1.1.m1.8.8.1.1.2.2"><csymbol cd="ambiguous" id="S2.p4.1.1.m1.8.8.1.1.2.2.1.cmml" xref="S2.p4.1.1.m1.8.8.1.1.2.2">superscript</csymbol><apply id="S2.p4.1.1.m1.8.8.1.1.2.2.2.cmml" xref="S2.p4.1.1.m1.8.8.1.1.2.2"><csymbol cd="ambiguous" id="S2.p4.1.1.m1.8.8.1.1.2.2.2.1.cmml" xref="S2.p4.1.1.m1.8.8.1.1.2.2">subscript</csymbol><ci id="S2.p4.1.1.m1.8.8.1.1.2.2.2.2.cmml" xref="S2.p4.1.1.m1.8.8.1.1.2.2.2.2">𝐔</ci><list id="S2.p4.1.1.m1.4.4.2.3.cmml" xref="S2.p4.1.1.m1.4.4.2.4"><ci id="S2.p4.1.1.m1.3.3.1.1.cmml" xref="S2.p4.1.1.m1.3.3.1.1">𝐦𝐬𝐚</ci><ci id="S2.p4.1.1.m1.4.4.2.2.cmml" xref="S2.p4.1.1.m1.4.4.2.2">𝑙</ci></list></apply><ci id="S2.p4.1.1.m1.8.8.1.1.2.2.3.cmml" xref="S2.p4.1.1.m1.8.8.1.1.2.2.3">𝑝</ci></apply></list><apply id="S2.p4.1.1.m1.9.9.2.2.cmml" xref="S2.p4.1.1.m1.9.9.2.2"><eq id="S2.p4.1.1.m1.9.9.2.2.1.cmml" xref="S2.p4.1.1.m1.9.9.2.2.1"></eq><ci id="S2.p4.1.1.m1.9.9.2.2.2.cmml" xref="S2.p4.1.1.m1.9.9.2.2.2">𝑙</ci><list id="S2.p4.1.1.m1.9.9.2.2.3.1.cmml" xref="S2.p4.1.1.m1.9.9.2.2.3.2"><cn type="integer" id="S2.p4.1.1.m1.5.5.cmml" xref="S2.p4.1.1.m1.5.5">1</cn><ci id="S2.p4.1.1.m1.6.6.cmml" xref="S2.p4.1.1.m1.6.6">⋯</ci><ci id="S2.p4.1.1.m1.7.7.cmml" xref="S2.p4.1.1.m1.7.7">𝐿</ci></list></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.p4.1.1.m1.9c">\{\mathbf{U}_{\mathbf{qkv},l}^{p},\mathbf{U}_{\mathbf{msa},l}^{p}|l=1,\cdots,L\}</annotation></semantics></math></span>, as <math id="S2.p4.2.m1.2" class="ltx_Math" alttext="\operatorname{ViT}^{g}(\cdot)" display="inline"><semantics id="S2.p4.2.m1.2a"><mrow id="S2.p4.2.m1.2.2.1" xref="S2.p4.2.m1.2.2.2.cmml"><msup id="S2.p4.2.m1.2.2.1.1" xref="S2.p4.2.m1.2.2.1.1.cmml"><mi id="S2.p4.2.m1.2.2.1.1.2" xref="S2.p4.2.m1.2.2.1.1.2.cmml">ViT</mi><mi id="S2.p4.2.m1.2.2.1.1.3" xref="S2.p4.2.m1.2.2.1.1.3.cmml">g</mi></msup><mo id="S2.p4.2.m1.2.2.1a" xref="S2.p4.2.m1.2.2.2.cmml">⁡</mo><mrow id="S2.p4.2.m1.2.2.1.2" xref="S2.p4.2.m1.2.2.2.cmml"><mo stretchy="false" id="S2.p4.2.m1.2.2.1.2.1" xref="S2.p4.2.m1.2.2.2.cmml">(</mo><mo lspace="0em" rspace="0em" id="S2.p4.2.m1.1.1" xref="S2.p4.2.m1.1.1.cmml">⋅</mo><mo stretchy="false" id="S2.p4.2.m1.2.2.1.2.2" xref="S2.p4.2.m1.2.2.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.p4.2.m1.2b"><apply id="S2.p4.2.m1.2.2.2.cmml" xref="S2.p4.2.m1.2.2.1"><apply id="S2.p4.2.m1.2.2.1.1.cmml" xref="S2.p4.2.m1.2.2.1.1"><csymbol cd="ambiguous" id="S2.p4.2.m1.2.2.1.1.1.cmml" xref="S2.p4.2.m1.2.2.1.1">superscript</csymbol><ci id="S2.p4.2.m1.2.2.1.1.2.cmml" xref="S2.p4.2.m1.2.2.1.1.2">ViT</ci><ci id="S2.p4.2.m1.2.2.1.1.3.cmml" xref="S2.p4.2.m1.2.2.1.1.3">𝑔</ci></apply><ci id="S2.p4.2.m1.1.1.cmml" xref="S2.p4.2.m1.1.1">⋅</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.p4.2.m1.2c">\operatorname{ViT}^{g}(\cdot)</annotation></semantics></math> <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib22" title="" class="ltx_ref">22</a>]</cite>. In parallel, we name another client-specific subnet with only personalized MSA weights as <math id="S2.p4.3.m2.4" class="ltx_Math" alttext="\operatorname{ViT}^{p,j}(\cdot)" display="inline"><semantics id="S2.p4.3.m2.4a"><mrow id="S2.p4.3.m2.4.4.1" xref="S2.p4.3.m2.4.4.2.cmml"><msup id="S2.p4.3.m2.4.4.1.1" xref="S2.p4.3.m2.4.4.1.1.cmml"><mi id="S2.p4.3.m2.4.4.1.1.2" xref="S2.p4.3.m2.4.4.1.1.2.cmml">ViT</mi><mrow id="S2.p4.3.m2.2.2.2.4" xref="S2.p4.3.m2.2.2.2.3.cmml"><mi id="S2.p4.3.m2.1.1.1.1" xref="S2.p4.3.m2.1.1.1.1.cmml">p</mi><mo id="S2.p4.3.m2.2.2.2.4.1" xref="S2.p4.3.m2.2.2.2.3.cmml">,</mo><mi id="S2.p4.3.m2.2.2.2.2" xref="S2.p4.3.m2.2.2.2.2.cmml">j</mi></mrow></msup><mo id="S2.p4.3.m2.4.4.1a" xref="S2.p4.3.m2.4.4.2.cmml">⁡</mo><mrow id="S2.p4.3.m2.4.4.1.2" xref="S2.p4.3.m2.4.4.2.cmml"><mo stretchy="false" id="S2.p4.3.m2.4.4.1.2.1" xref="S2.p4.3.m2.4.4.2.cmml">(</mo><mo lspace="0em" rspace="0em" id="S2.p4.3.m2.3.3" xref="S2.p4.3.m2.3.3.cmml">⋅</mo><mo stretchy="false" id="S2.p4.3.m2.4.4.1.2.2" xref="S2.p4.3.m2.4.4.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.p4.3.m2.4b"><apply id="S2.p4.3.m2.4.4.2.cmml" xref="S2.p4.3.m2.4.4.1"><apply id="S2.p4.3.m2.4.4.1.1.cmml" xref="S2.p4.3.m2.4.4.1.1"><csymbol cd="ambiguous" id="S2.p4.3.m2.4.4.1.1.1.cmml" xref="S2.p4.3.m2.4.4.1.1">superscript</csymbol><ci id="S2.p4.3.m2.4.4.1.1.2.cmml" xref="S2.p4.3.m2.4.4.1.1.2">ViT</ci><list id="S2.p4.3.m2.2.2.2.3.cmml" xref="S2.p4.3.m2.2.2.2.4"><ci id="S2.p4.3.m2.1.1.1.1.cmml" xref="S2.p4.3.m2.1.1.1.1">𝑝</ci><ci id="S2.p4.3.m2.2.2.2.2.cmml" xref="S2.p4.3.m2.2.2.2.2">𝑗</ci></list></apply><ci id="S2.p4.3.m2.3.3.cmml" xref="S2.p4.3.m2.3.3">⋅</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.p4.3.m2.4c">\operatorname{ViT}^{p,j}(\cdot)</annotation></semantics></math> where <math id="S2.p4.4.m3.1" class="ltx_Math" alttext="j" display="inline"><semantics id="S2.p4.4.m3.1a"><mi id="S2.p4.4.m3.1.1" xref="S2.p4.4.m3.1.1.cmml">j</mi><annotation-xml encoding="MathML-Content" id="S2.p4.4.m3.1b"><ci id="S2.p4.4.m3.1.1.cmml" xref="S2.p4.4.m3.1.1">𝑗</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.p4.4.m3.1c">j</annotation></semantics></math> is the associated client ID. We impose a consistency regularization to force the local personalized weights and shared weights ultimately generate predictions that coincide with each other. To achieve this goal, we propose a mutual consistent regularization, depicted as follows</p>
<table id="S2.E5" class="ltx_equationgroup ltx_eqn_table">
<tbody>
<tr id="S2.E5X" class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math id="S2.E5X.2.1.1.m1.1" class="ltx_Math" alttext="\displaystyle\mathcal{L}_{con}^{j}" display="inline"><semantics id="S2.E5X.2.1.1.m1.1a"><msubsup id="S2.E5X.2.1.1.m1.1.1" xref="S2.E5X.2.1.1.m1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S2.E5X.2.1.1.m1.1.1.2.2" xref="S2.E5X.2.1.1.m1.1.1.2.2.cmml">ℒ</mi><mrow id="S2.E5X.2.1.1.m1.1.1.2.3" xref="S2.E5X.2.1.1.m1.1.1.2.3.cmml"><mi id="S2.E5X.2.1.1.m1.1.1.2.3.2" xref="S2.E5X.2.1.1.m1.1.1.2.3.2.cmml">c</mi><mo lspace="0em" rspace="0em" id="S2.E5X.2.1.1.m1.1.1.2.3.1" xref="S2.E5X.2.1.1.m1.1.1.2.3.1.cmml">​</mo><mi id="S2.E5X.2.1.1.m1.1.1.2.3.3" xref="S2.E5X.2.1.1.m1.1.1.2.3.3.cmml">o</mi><mo lspace="0em" rspace="0em" id="S2.E5X.2.1.1.m1.1.1.2.3.1a" xref="S2.E5X.2.1.1.m1.1.1.2.3.1.cmml">​</mo><mi id="S2.E5X.2.1.1.m1.1.1.2.3.4" xref="S2.E5X.2.1.1.m1.1.1.2.3.4.cmml">n</mi></mrow><mi id="S2.E5X.2.1.1.m1.1.1.3" xref="S2.E5X.2.1.1.m1.1.1.3.cmml">j</mi></msubsup><annotation-xml encoding="MathML-Content" id="S2.E5X.2.1.1.m1.1b"><apply id="S2.E5X.2.1.1.m1.1.1.cmml" xref="S2.E5X.2.1.1.m1.1.1"><csymbol cd="ambiguous" id="S2.E5X.2.1.1.m1.1.1.1.cmml" xref="S2.E5X.2.1.1.m1.1.1">superscript</csymbol><apply id="S2.E5X.2.1.1.m1.1.1.2.cmml" xref="S2.E5X.2.1.1.m1.1.1"><csymbol cd="ambiguous" id="S2.E5X.2.1.1.m1.1.1.2.1.cmml" xref="S2.E5X.2.1.1.m1.1.1">subscript</csymbol><ci id="S2.E5X.2.1.1.m1.1.1.2.2.cmml" xref="S2.E5X.2.1.1.m1.1.1.2.2">ℒ</ci><apply id="S2.E5X.2.1.1.m1.1.1.2.3.cmml" xref="S2.E5X.2.1.1.m1.1.1.2.3"><times id="S2.E5X.2.1.1.m1.1.1.2.3.1.cmml" xref="S2.E5X.2.1.1.m1.1.1.2.3.1"></times><ci id="S2.E5X.2.1.1.m1.1.1.2.3.2.cmml" xref="S2.E5X.2.1.1.m1.1.1.2.3.2">𝑐</ci><ci id="S2.E5X.2.1.1.m1.1.1.2.3.3.cmml" xref="S2.E5X.2.1.1.m1.1.1.2.3.3">𝑜</ci><ci id="S2.E5X.2.1.1.m1.1.1.2.3.4.cmml" xref="S2.E5X.2.1.1.m1.1.1.2.3.4">𝑛</ci></apply></apply><ci id="S2.E5X.2.1.1.m1.1.1.3.cmml" xref="S2.E5X.2.1.1.m1.1.1.3">𝑗</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.E5X.2.1.1.m1.1c">\displaystyle\mathcal{L}_{con}^{j}</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math id="S2.E5X.3.2.2.m1.6" class="ltx_Math" alttext="\displaystyle=\mathbf{KL}(\sigma(\operatorname{ViT}^{g}(\mathbf{x})/T),\sigma(\operatorname{ViT}^{p,j}(\mathbf{x})/T))+" display="inline"><semantics id="S2.E5X.3.2.2.m1.6a"><mrow id="S2.E5X.3.2.2.m1.6.6" xref="S2.E5X.3.2.2.m1.6.6.cmml"><mi id="S2.E5X.3.2.2.m1.6.6.4" xref="S2.E5X.3.2.2.m1.6.6.4.cmml"></mi><mo id="S2.E5X.3.2.2.m1.6.6.3" xref="S2.E5X.3.2.2.m1.6.6.3.cmml">=</mo><mrow id="S2.E5X.3.2.2.m1.6.6.2" xref="S2.E5X.3.2.2.m1.6.6.2.cmml"><mrow id="S2.E5X.3.2.2.m1.6.6.2.2" xref="S2.E5X.3.2.2.m1.6.6.2.2.cmml"><mi id="S2.E5X.3.2.2.m1.6.6.2.2.4" xref="S2.E5X.3.2.2.m1.6.6.2.2.4.cmml">𝐊𝐋</mi><mo lspace="0em" rspace="0em" id="S2.E5X.3.2.2.m1.6.6.2.2.3" xref="S2.E5X.3.2.2.m1.6.6.2.2.3.cmml">​</mo><mrow id="S2.E5X.3.2.2.m1.6.6.2.2.2.2" xref="S2.E5X.3.2.2.m1.6.6.2.2.2.3.cmml"><mo stretchy="false" id="S2.E5X.3.2.2.m1.6.6.2.2.2.2.3" xref="S2.E5X.3.2.2.m1.6.6.2.2.2.3.cmml">(</mo><mrow id="S2.E5X.3.2.2.m1.5.5.1.1.1.1.1" xref="S2.E5X.3.2.2.m1.5.5.1.1.1.1.1.cmml"><mi id="S2.E5X.3.2.2.m1.5.5.1.1.1.1.1.3" xref="S2.E5X.3.2.2.m1.5.5.1.1.1.1.1.3.cmml">σ</mi><mo lspace="0em" rspace="0em" id="S2.E5X.3.2.2.m1.5.5.1.1.1.1.1.2" xref="S2.E5X.3.2.2.m1.5.5.1.1.1.1.1.2.cmml">​</mo><mrow id="S2.E5X.3.2.2.m1.5.5.1.1.1.1.1.1.1" xref="S2.E5X.3.2.2.m1.5.5.1.1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S2.E5X.3.2.2.m1.5.5.1.1.1.1.1.1.1.2" xref="S2.E5X.3.2.2.m1.5.5.1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="S2.E5X.3.2.2.m1.5.5.1.1.1.1.1.1.1.1" xref="S2.E5X.3.2.2.m1.5.5.1.1.1.1.1.1.1.1.cmml"><mrow id="S2.E5X.3.2.2.m1.5.5.1.1.1.1.1.1.1.1.1.1" xref="S2.E5X.3.2.2.m1.5.5.1.1.1.1.1.1.1.1.1.2.cmml"><msup id="S2.E5X.3.2.2.m1.5.5.1.1.1.1.1.1.1.1.1.1.1" xref="S2.E5X.3.2.2.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.cmml"><mi id="S2.E5X.3.2.2.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.2" xref="S2.E5X.3.2.2.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.2.cmml">ViT</mi><mi id="S2.E5X.3.2.2.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.3" xref="S2.E5X.3.2.2.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.3.cmml">g</mi></msup><mo id="S2.E5X.3.2.2.m1.5.5.1.1.1.1.1.1.1.1.1.1a" xref="S2.E5X.3.2.2.m1.5.5.1.1.1.1.1.1.1.1.1.2.cmml">⁡</mo><mrow id="S2.E5X.3.2.2.m1.5.5.1.1.1.1.1.1.1.1.1.1.2" xref="S2.E5X.3.2.2.m1.5.5.1.1.1.1.1.1.1.1.1.2.cmml"><mo stretchy="false" id="S2.E5X.3.2.2.m1.5.5.1.1.1.1.1.1.1.1.1.1.2.1" xref="S2.E5X.3.2.2.m1.5.5.1.1.1.1.1.1.1.1.1.2.cmml">(</mo><mi id="S2.E5X.3.2.2.m1.3.3" xref="S2.E5X.3.2.2.m1.3.3.cmml">𝐱</mi><mo stretchy="false" id="S2.E5X.3.2.2.m1.5.5.1.1.1.1.1.1.1.1.1.1.2.2" xref="S2.E5X.3.2.2.m1.5.5.1.1.1.1.1.1.1.1.1.2.cmml">)</mo></mrow></mrow><mo id="S2.E5X.3.2.2.m1.5.5.1.1.1.1.1.1.1.1.2" xref="S2.E5X.3.2.2.m1.5.5.1.1.1.1.1.1.1.1.2.cmml">/</mo><mi id="S2.E5X.3.2.2.m1.5.5.1.1.1.1.1.1.1.1.3" xref="S2.E5X.3.2.2.m1.5.5.1.1.1.1.1.1.1.1.3.cmml">T</mi></mrow><mo stretchy="false" id="S2.E5X.3.2.2.m1.5.5.1.1.1.1.1.1.1.3" xref="S2.E5X.3.2.2.m1.5.5.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S2.E5X.3.2.2.m1.6.6.2.2.2.2.4" xref="S2.E5X.3.2.2.m1.6.6.2.2.2.3.cmml">,</mo><mrow id="S2.E5X.3.2.2.m1.6.6.2.2.2.2.2" xref="S2.E5X.3.2.2.m1.6.6.2.2.2.2.2.cmml"><mi id="S2.E5X.3.2.2.m1.6.6.2.2.2.2.2.3" xref="S2.E5X.3.2.2.m1.6.6.2.2.2.2.2.3.cmml">σ</mi><mo lspace="0em" rspace="0em" id="S2.E5X.3.2.2.m1.6.6.2.2.2.2.2.2" xref="S2.E5X.3.2.2.m1.6.6.2.2.2.2.2.2.cmml">​</mo><mrow id="S2.E5X.3.2.2.m1.6.6.2.2.2.2.2.1.1" xref="S2.E5X.3.2.2.m1.6.6.2.2.2.2.2.1.1.1.cmml"><mo stretchy="false" id="S2.E5X.3.2.2.m1.6.6.2.2.2.2.2.1.1.2" xref="S2.E5X.3.2.2.m1.6.6.2.2.2.2.2.1.1.1.cmml">(</mo><mrow id="S2.E5X.3.2.2.m1.6.6.2.2.2.2.2.1.1.1" xref="S2.E5X.3.2.2.m1.6.6.2.2.2.2.2.1.1.1.cmml"><mrow id="S2.E5X.3.2.2.m1.6.6.2.2.2.2.2.1.1.1.1.1" xref="S2.E5X.3.2.2.m1.6.6.2.2.2.2.2.1.1.1.1.2.cmml"><msup id="S2.E5X.3.2.2.m1.6.6.2.2.2.2.2.1.1.1.1.1.1" xref="S2.E5X.3.2.2.m1.6.6.2.2.2.2.2.1.1.1.1.1.1.cmml"><mi id="S2.E5X.3.2.2.m1.6.6.2.2.2.2.2.1.1.1.1.1.1.2" xref="S2.E5X.3.2.2.m1.6.6.2.2.2.2.2.1.1.1.1.1.1.2.cmml">ViT</mi><mrow id="S2.E5X.3.2.2.m1.2.2.2.4" xref="S2.E5X.3.2.2.m1.2.2.2.3.cmml"><mi id="S2.E5X.3.2.2.m1.1.1.1.1" xref="S2.E5X.3.2.2.m1.1.1.1.1.cmml">p</mi><mo id="S2.E5X.3.2.2.m1.2.2.2.4.1" xref="S2.E5X.3.2.2.m1.2.2.2.3.cmml">,</mo><mi id="S2.E5X.3.2.2.m1.2.2.2.2" xref="S2.E5X.3.2.2.m1.2.2.2.2.cmml">j</mi></mrow></msup><mo id="S2.E5X.3.2.2.m1.6.6.2.2.2.2.2.1.1.1.1.1a" xref="S2.E5X.3.2.2.m1.6.6.2.2.2.2.2.1.1.1.1.2.cmml">⁡</mo><mrow id="S2.E5X.3.2.2.m1.6.6.2.2.2.2.2.1.1.1.1.1.2" xref="S2.E5X.3.2.2.m1.6.6.2.2.2.2.2.1.1.1.1.2.cmml"><mo stretchy="false" id="S2.E5X.3.2.2.m1.6.6.2.2.2.2.2.1.1.1.1.1.2.1" xref="S2.E5X.3.2.2.m1.6.6.2.2.2.2.2.1.1.1.1.2.cmml">(</mo><mi id="S2.E5X.3.2.2.m1.4.4" xref="S2.E5X.3.2.2.m1.4.4.cmml">𝐱</mi><mo stretchy="false" id="S2.E5X.3.2.2.m1.6.6.2.2.2.2.2.1.1.1.1.1.2.2" xref="S2.E5X.3.2.2.m1.6.6.2.2.2.2.2.1.1.1.1.2.cmml">)</mo></mrow></mrow><mo id="S2.E5X.3.2.2.m1.6.6.2.2.2.2.2.1.1.1.2" xref="S2.E5X.3.2.2.m1.6.6.2.2.2.2.2.1.1.1.2.cmml">/</mo><mi id="S2.E5X.3.2.2.m1.6.6.2.2.2.2.2.1.1.1.3" xref="S2.E5X.3.2.2.m1.6.6.2.2.2.2.2.1.1.1.3.cmml">T</mi></mrow><mo stretchy="false" id="S2.E5X.3.2.2.m1.6.6.2.2.2.2.2.1.1.3" xref="S2.E5X.3.2.2.m1.6.6.2.2.2.2.2.1.1.1.cmml">)</mo></mrow></mrow><mo stretchy="false" id="S2.E5X.3.2.2.m1.6.6.2.2.2.2.5" xref="S2.E5X.3.2.2.m1.6.6.2.2.2.3.cmml">)</mo></mrow></mrow><mo id="S2.E5X.3.2.2.m1.6.6.2.4" xref="S2.E5X.3.2.2.m1.6.6.2.4.cmml">+</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.E5X.3.2.2.m1.6b"><apply id="S2.E5X.3.2.2.m1.6.6.cmml" xref="S2.E5X.3.2.2.m1.6.6"><eq id="S2.E5X.3.2.2.m1.6.6.3.cmml" xref="S2.E5X.3.2.2.m1.6.6.3"></eq><csymbol cd="latexml" id="S2.E5X.3.2.2.m1.6.6.4.cmml" xref="S2.E5X.3.2.2.m1.6.6.4">absent</csymbol><apply id="S2.E5X.3.2.2.m1.6.6.2.cmml" xref="S2.E5X.3.2.2.m1.6.6.2"><csymbol cd="latexml" id="S2.E5X.3.2.2.m1.6.6.2.3.cmml" xref="S2.E5X.3.2.2.m1.6.6.2">limit-from</csymbol><apply id="S2.E5X.3.2.2.m1.6.6.2.2.cmml" xref="S2.E5X.3.2.2.m1.6.6.2.2"><times id="S2.E5X.3.2.2.m1.6.6.2.2.3.cmml" xref="S2.E5X.3.2.2.m1.6.6.2.2.3"></times><ci id="S2.E5X.3.2.2.m1.6.6.2.2.4.cmml" xref="S2.E5X.3.2.2.m1.6.6.2.2.4">𝐊𝐋</ci><interval closure="open" id="S2.E5X.3.2.2.m1.6.6.2.2.2.3.cmml" xref="S2.E5X.3.2.2.m1.6.6.2.2.2.2"><apply id="S2.E5X.3.2.2.m1.5.5.1.1.1.1.1.cmml" xref="S2.E5X.3.2.2.m1.5.5.1.1.1.1.1"><times id="S2.E5X.3.2.2.m1.5.5.1.1.1.1.1.2.cmml" xref="S2.E5X.3.2.2.m1.5.5.1.1.1.1.1.2"></times><ci id="S2.E5X.3.2.2.m1.5.5.1.1.1.1.1.3.cmml" xref="S2.E5X.3.2.2.m1.5.5.1.1.1.1.1.3">𝜎</ci><apply id="S2.E5X.3.2.2.m1.5.5.1.1.1.1.1.1.1.1.cmml" xref="S2.E5X.3.2.2.m1.5.5.1.1.1.1.1.1.1"><divide id="S2.E5X.3.2.2.m1.5.5.1.1.1.1.1.1.1.1.2.cmml" xref="S2.E5X.3.2.2.m1.5.5.1.1.1.1.1.1.1.1.2"></divide><apply id="S2.E5X.3.2.2.m1.5.5.1.1.1.1.1.1.1.1.1.2.cmml" xref="S2.E5X.3.2.2.m1.5.5.1.1.1.1.1.1.1.1.1.1"><apply id="S2.E5X.3.2.2.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S2.E5X.3.2.2.m1.5.5.1.1.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S2.E5X.3.2.2.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S2.E5X.3.2.2.m1.5.5.1.1.1.1.1.1.1.1.1.1.1">superscript</csymbol><ci id="S2.E5X.3.2.2.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S2.E5X.3.2.2.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.2">ViT</ci><ci id="S2.E5X.3.2.2.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="S2.E5X.3.2.2.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.3">𝑔</ci></apply><ci id="S2.E5X.3.2.2.m1.3.3.cmml" xref="S2.E5X.3.2.2.m1.3.3">𝐱</ci></apply><ci id="S2.E5X.3.2.2.m1.5.5.1.1.1.1.1.1.1.1.3.cmml" xref="S2.E5X.3.2.2.m1.5.5.1.1.1.1.1.1.1.1.3">𝑇</ci></apply></apply><apply id="S2.E5X.3.2.2.m1.6.6.2.2.2.2.2.cmml" xref="S2.E5X.3.2.2.m1.6.6.2.2.2.2.2"><times id="S2.E5X.3.2.2.m1.6.6.2.2.2.2.2.2.cmml" xref="S2.E5X.3.2.2.m1.6.6.2.2.2.2.2.2"></times><ci id="S2.E5X.3.2.2.m1.6.6.2.2.2.2.2.3.cmml" xref="S2.E5X.3.2.2.m1.6.6.2.2.2.2.2.3">𝜎</ci><apply id="S2.E5X.3.2.2.m1.6.6.2.2.2.2.2.1.1.1.cmml" xref="S2.E5X.3.2.2.m1.6.6.2.2.2.2.2.1.1"><divide id="S2.E5X.3.2.2.m1.6.6.2.2.2.2.2.1.1.1.2.cmml" xref="S2.E5X.3.2.2.m1.6.6.2.2.2.2.2.1.1.1.2"></divide><apply id="S2.E5X.3.2.2.m1.6.6.2.2.2.2.2.1.1.1.1.2.cmml" xref="S2.E5X.3.2.2.m1.6.6.2.2.2.2.2.1.1.1.1.1"><apply id="S2.E5X.3.2.2.m1.6.6.2.2.2.2.2.1.1.1.1.1.1.cmml" xref="S2.E5X.3.2.2.m1.6.6.2.2.2.2.2.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S2.E5X.3.2.2.m1.6.6.2.2.2.2.2.1.1.1.1.1.1.1.cmml" xref="S2.E5X.3.2.2.m1.6.6.2.2.2.2.2.1.1.1.1.1.1">superscript</csymbol><ci id="S2.E5X.3.2.2.m1.6.6.2.2.2.2.2.1.1.1.1.1.1.2.cmml" xref="S2.E5X.3.2.2.m1.6.6.2.2.2.2.2.1.1.1.1.1.1.2">ViT</ci><list id="S2.E5X.3.2.2.m1.2.2.2.3.cmml" xref="S2.E5X.3.2.2.m1.2.2.2.4"><ci id="S2.E5X.3.2.2.m1.1.1.1.1.cmml" xref="S2.E5X.3.2.2.m1.1.1.1.1">𝑝</ci><ci id="S2.E5X.3.2.2.m1.2.2.2.2.cmml" xref="S2.E5X.3.2.2.m1.2.2.2.2">𝑗</ci></list></apply><ci id="S2.E5X.3.2.2.m1.4.4.cmml" xref="S2.E5X.3.2.2.m1.4.4">𝐱</ci></apply><ci id="S2.E5X.3.2.2.m1.6.6.2.2.2.2.2.1.1.1.3.cmml" xref="S2.E5X.3.2.2.m1.6.6.2.2.2.2.2.1.1.1.3">𝑇</ci></apply></apply></interval></apply><plus id="S2.E5X.3.2.2.m1.6.6.2.4.cmml" xref="S2.E5X.3.2.2.m1.6.6.2.4"></plus></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.E5X.3.2.2.m1.6c">\displaystyle=\mathbf{KL}(\sigma(\operatorname{ViT}^{g}(\mathbf{x})/T),\sigma(\operatorname{ViT}^{p,j}(\mathbf{x})/T))+</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="2" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equationgroup ltx_align_right">(5)</span></td>
</tr>
<tr id="S2.E5Xa" class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_eqn_cell"></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math id="S2.E5Xa.2.1.1.m1.5" class="ltx_Math" alttext="\displaystyle\mathbf{KL}(\sigma(\operatorname{ViT}^{p,j}(\mathbf{x})/T),\sigma(\operatorname{ViT}^{g}(\mathbf{x})/T))\,." display="inline"><semantics id="S2.E5Xa.2.1.1.m1.5a"><mrow id="S2.E5Xa.2.1.1.m1.5.5.1" xref="S2.E5Xa.2.1.1.m1.5.5.1.1.cmml"><mrow id="S2.E5Xa.2.1.1.m1.5.5.1.1" xref="S2.E5Xa.2.1.1.m1.5.5.1.1.cmml"><mi id="S2.E5Xa.2.1.1.m1.5.5.1.1.4" xref="S2.E5Xa.2.1.1.m1.5.5.1.1.4.cmml">𝐊𝐋</mi><mo lspace="0em" rspace="0em" id="S2.E5Xa.2.1.1.m1.5.5.1.1.3" xref="S2.E5Xa.2.1.1.m1.5.5.1.1.3.cmml">​</mo><mrow id="S2.E5Xa.2.1.1.m1.5.5.1.1.2.2" xref="S2.E5Xa.2.1.1.m1.5.5.1.1.2.3.cmml"><mo stretchy="false" id="S2.E5Xa.2.1.1.m1.5.5.1.1.2.2.3" xref="S2.E5Xa.2.1.1.m1.5.5.1.1.2.3.cmml">(</mo><mrow id="S2.E5Xa.2.1.1.m1.5.5.1.1.1.1.1" xref="S2.E5Xa.2.1.1.m1.5.5.1.1.1.1.1.cmml"><mi id="S2.E5Xa.2.1.1.m1.5.5.1.1.1.1.1.3" xref="S2.E5Xa.2.1.1.m1.5.5.1.1.1.1.1.3.cmml">σ</mi><mo lspace="0em" rspace="0em" id="S2.E5Xa.2.1.1.m1.5.5.1.1.1.1.1.2" xref="S2.E5Xa.2.1.1.m1.5.5.1.1.1.1.1.2.cmml">​</mo><mrow id="S2.E5Xa.2.1.1.m1.5.5.1.1.1.1.1.1.1" xref="S2.E5Xa.2.1.1.m1.5.5.1.1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S2.E5Xa.2.1.1.m1.5.5.1.1.1.1.1.1.1.2" xref="S2.E5Xa.2.1.1.m1.5.5.1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="S2.E5Xa.2.1.1.m1.5.5.1.1.1.1.1.1.1.1" xref="S2.E5Xa.2.1.1.m1.5.5.1.1.1.1.1.1.1.1.cmml"><mrow id="S2.E5Xa.2.1.1.m1.5.5.1.1.1.1.1.1.1.1.1.1" xref="S2.E5Xa.2.1.1.m1.5.5.1.1.1.1.1.1.1.1.1.2.cmml"><msup id="S2.E5Xa.2.1.1.m1.5.5.1.1.1.1.1.1.1.1.1.1.1" xref="S2.E5Xa.2.1.1.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.cmml"><mi id="S2.E5Xa.2.1.1.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.2" xref="S2.E5Xa.2.1.1.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.2.cmml">ViT</mi><mrow id="S2.E5Xa.2.1.1.m1.2.2.2.4" xref="S2.E5Xa.2.1.1.m1.2.2.2.3.cmml"><mi id="S2.E5Xa.2.1.1.m1.1.1.1.1" xref="S2.E5Xa.2.1.1.m1.1.1.1.1.cmml">p</mi><mo id="S2.E5Xa.2.1.1.m1.2.2.2.4.1" xref="S2.E5Xa.2.1.1.m1.2.2.2.3.cmml">,</mo><mi id="S2.E5Xa.2.1.1.m1.2.2.2.2" xref="S2.E5Xa.2.1.1.m1.2.2.2.2.cmml">j</mi></mrow></msup><mo id="S2.E5Xa.2.1.1.m1.5.5.1.1.1.1.1.1.1.1.1.1a" xref="S2.E5Xa.2.1.1.m1.5.5.1.1.1.1.1.1.1.1.1.2.cmml">⁡</mo><mrow id="S2.E5Xa.2.1.1.m1.5.5.1.1.1.1.1.1.1.1.1.1.2" xref="S2.E5Xa.2.1.1.m1.5.5.1.1.1.1.1.1.1.1.1.2.cmml"><mo stretchy="false" id="S2.E5Xa.2.1.1.m1.5.5.1.1.1.1.1.1.1.1.1.1.2.1" xref="S2.E5Xa.2.1.1.m1.5.5.1.1.1.1.1.1.1.1.1.2.cmml">(</mo><mi id="S2.E5Xa.2.1.1.m1.3.3" xref="S2.E5Xa.2.1.1.m1.3.3.cmml">𝐱</mi><mo stretchy="false" id="S2.E5Xa.2.1.1.m1.5.5.1.1.1.1.1.1.1.1.1.1.2.2" xref="S2.E5Xa.2.1.1.m1.5.5.1.1.1.1.1.1.1.1.1.2.cmml">)</mo></mrow></mrow><mo id="S2.E5Xa.2.1.1.m1.5.5.1.1.1.1.1.1.1.1.2" xref="S2.E5Xa.2.1.1.m1.5.5.1.1.1.1.1.1.1.1.2.cmml">/</mo><mi id="S2.E5Xa.2.1.1.m1.5.5.1.1.1.1.1.1.1.1.3" xref="S2.E5Xa.2.1.1.m1.5.5.1.1.1.1.1.1.1.1.3.cmml">T</mi></mrow><mo stretchy="false" id="S2.E5Xa.2.1.1.m1.5.5.1.1.1.1.1.1.1.3" xref="S2.E5Xa.2.1.1.m1.5.5.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S2.E5Xa.2.1.1.m1.5.5.1.1.2.2.4" xref="S2.E5Xa.2.1.1.m1.5.5.1.1.2.3.cmml">,</mo><mrow id="S2.E5Xa.2.1.1.m1.5.5.1.1.2.2.2" xref="S2.E5Xa.2.1.1.m1.5.5.1.1.2.2.2.cmml"><mi id="S2.E5Xa.2.1.1.m1.5.5.1.1.2.2.2.3" xref="S2.E5Xa.2.1.1.m1.5.5.1.1.2.2.2.3.cmml">σ</mi><mo lspace="0em" rspace="0em" id="S2.E5Xa.2.1.1.m1.5.5.1.1.2.2.2.2" xref="S2.E5Xa.2.1.1.m1.5.5.1.1.2.2.2.2.cmml">​</mo><mrow id="S2.E5Xa.2.1.1.m1.5.5.1.1.2.2.2.1.1" xref="S2.E5Xa.2.1.1.m1.5.5.1.1.2.2.2.1.1.1.cmml"><mo stretchy="false" id="S2.E5Xa.2.1.1.m1.5.5.1.1.2.2.2.1.1.2" xref="S2.E5Xa.2.1.1.m1.5.5.1.1.2.2.2.1.1.1.cmml">(</mo><mrow id="S2.E5Xa.2.1.1.m1.5.5.1.1.2.2.2.1.1.1" xref="S2.E5Xa.2.1.1.m1.5.5.1.1.2.2.2.1.1.1.cmml"><mrow id="S2.E5Xa.2.1.1.m1.5.5.1.1.2.2.2.1.1.1.1.1" xref="S2.E5Xa.2.1.1.m1.5.5.1.1.2.2.2.1.1.1.1.2.cmml"><msup id="S2.E5Xa.2.1.1.m1.5.5.1.1.2.2.2.1.1.1.1.1.1" xref="S2.E5Xa.2.1.1.m1.5.5.1.1.2.2.2.1.1.1.1.1.1.cmml"><mi id="S2.E5Xa.2.1.1.m1.5.5.1.1.2.2.2.1.1.1.1.1.1.2" xref="S2.E5Xa.2.1.1.m1.5.5.1.1.2.2.2.1.1.1.1.1.1.2.cmml">ViT</mi><mi id="S2.E5Xa.2.1.1.m1.5.5.1.1.2.2.2.1.1.1.1.1.1.3" xref="S2.E5Xa.2.1.1.m1.5.5.1.1.2.2.2.1.1.1.1.1.1.3.cmml">g</mi></msup><mo id="S2.E5Xa.2.1.1.m1.5.5.1.1.2.2.2.1.1.1.1.1a" xref="S2.E5Xa.2.1.1.m1.5.5.1.1.2.2.2.1.1.1.1.2.cmml">⁡</mo><mrow id="S2.E5Xa.2.1.1.m1.5.5.1.1.2.2.2.1.1.1.1.1.2" xref="S2.E5Xa.2.1.1.m1.5.5.1.1.2.2.2.1.1.1.1.2.cmml"><mo stretchy="false" id="S2.E5Xa.2.1.1.m1.5.5.1.1.2.2.2.1.1.1.1.1.2.1" xref="S2.E5Xa.2.1.1.m1.5.5.1.1.2.2.2.1.1.1.1.2.cmml">(</mo><mi id="S2.E5Xa.2.1.1.m1.4.4" xref="S2.E5Xa.2.1.1.m1.4.4.cmml">𝐱</mi><mo stretchy="false" id="S2.E5Xa.2.1.1.m1.5.5.1.1.2.2.2.1.1.1.1.1.2.2" xref="S2.E5Xa.2.1.1.m1.5.5.1.1.2.2.2.1.1.1.1.2.cmml">)</mo></mrow></mrow><mo id="S2.E5Xa.2.1.1.m1.5.5.1.1.2.2.2.1.1.1.2" xref="S2.E5Xa.2.1.1.m1.5.5.1.1.2.2.2.1.1.1.2.cmml">/</mo><mi id="S2.E5Xa.2.1.1.m1.5.5.1.1.2.2.2.1.1.1.3" xref="S2.E5Xa.2.1.1.m1.5.5.1.1.2.2.2.1.1.1.3.cmml">T</mi></mrow><mo stretchy="false" id="S2.E5Xa.2.1.1.m1.5.5.1.1.2.2.2.1.1.3" xref="S2.E5Xa.2.1.1.m1.5.5.1.1.2.2.2.1.1.1.cmml">)</mo></mrow></mrow><mo stretchy="false" id="S2.E5Xa.2.1.1.m1.5.5.1.1.2.2.5" xref="S2.E5Xa.2.1.1.m1.5.5.1.1.2.3.cmml">)</mo></mrow></mrow><mo lspace="0.170em" id="S2.E5Xa.2.1.1.m1.5.5.1.2" xref="S2.E5Xa.2.1.1.m1.5.5.1.1.cmml">.</mo></mrow><annotation-xml encoding="MathML-Content" id="S2.E5Xa.2.1.1.m1.5b"><apply id="S2.E5Xa.2.1.1.m1.5.5.1.1.cmml" xref="S2.E5Xa.2.1.1.m1.5.5.1"><times id="S2.E5Xa.2.1.1.m1.5.5.1.1.3.cmml" xref="S2.E5Xa.2.1.1.m1.5.5.1.1.3"></times><ci id="S2.E5Xa.2.1.1.m1.5.5.1.1.4.cmml" xref="S2.E5Xa.2.1.1.m1.5.5.1.1.4">𝐊𝐋</ci><interval closure="open" id="S2.E5Xa.2.1.1.m1.5.5.1.1.2.3.cmml" xref="S2.E5Xa.2.1.1.m1.5.5.1.1.2.2"><apply id="S2.E5Xa.2.1.1.m1.5.5.1.1.1.1.1.cmml" xref="S2.E5Xa.2.1.1.m1.5.5.1.1.1.1.1"><times id="S2.E5Xa.2.1.1.m1.5.5.1.1.1.1.1.2.cmml" xref="S2.E5Xa.2.1.1.m1.5.5.1.1.1.1.1.2"></times><ci id="S2.E5Xa.2.1.1.m1.5.5.1.1.1.1.1.3.cmml" xref="S2.E5Xa.2.1.1.m1.5.5.1.1.1.1.1.3">𝜎</ci><apply id="S2.E5Xa.2.1.1.m1.5.5.1.1.1.1.1.1.1.1.cmml" xref="S2.E5Xa.2.1.1.m1.5.5.1.1.1.1.1.1.1"><divide id="S2.E5Xa.2.1.1.m1.5.5.1.1.1.1.1.1.1.1.2.cmml" xref="S2.E5Xa.2.1.1.m1.5.5.1.1.1.1.1.1.1.1.2"></divide><apply id="S2.E5Xa.2.1.1.m1.5.5.1.1.1.1.1.1.1.1.1.2.cmml" xref="S2.E5Xa.2.1.1.m1.5.5.1.1.1.1.1.1.1.1.1.1"><apply id="S2.E5Xa.2.1.1.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S2.E5Xa.2.1.1.m1.5.5.1.1.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S2.E5Xa.2.1.1.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S2.E5Xa.2.1.1.m1.5.5.1.1.1.1.1.1.1.1.1.1.1">superscript</csymbol><ci id="S2.E5Xa.2.1.1.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S2.E5Xa.2.1.1.m1.5.5.1.1.1.1.1.1.1.1.1.1.1.2">ViT</ci><list id="S2.E5Xa.2.1.1.m1.2.2.2.3.cmml" xref="S2.E5Xa.2.1.1.m1.2.2.2.4"><ci id="S2.E5Xa.2.1.1.m1.1.1.1.1.cmml" xref="S2.E5Xa.2.1.1.m1.1.1.1.1">𝑝</ci><ci id="S2.E5Xa.2.1.1.m1.2.2.2.2.cmml" xref="S2.E5Xa.2.1.1.m1.2.2.2.2">𝑗</ci></list></apply><ci id="S2.E5Xa.2.1.1.m1.3.3.cmml" xref="S2.E5Xa.2.1.1.m1.3.3">𝐱</ci></apply><ci id="S2.E5Xa.2.1.1.m1.5.5.1.1.1.1.1.1.1.1.3.cmml" xref="S2.E5Xa.2.1.1.m1.5.5.1.1.1.1.1.1.1.1.3">𝑇</ci></apply></apply><apply id="S2.E5Xa.2.1.1.m1.5.5.1.1.2.2.2.cmml" xref="S2.E5Xa.2.1.1.m1.5.5.1.1.2.2.2"><times id="S2.E5Xa.2.1.1.m1.5.5.1.1.2.2.2.2.cmml" xref="S2.E5Xa.2.1.1.m1.5.5.1.1.2.2.2.2"></times><ci id="S2.E5Xa.2.1.1.m1.5.5.1.1.2.2.2.3.cmml" xref="S2.E5Xa.2.1.1.m1.5.5.1.1.2.2.2.3">𝜎</ci><apply id="S2.E5Xa.2.1.1.m1.5.5.1.1.2.2.2.1.1.1.cmml" xref="S2.E5Xa.2.1.1.m1.5.5.1.1.2.2.2.1.1"><divide id="S2.E5Xa.2.1.1.m1.5.5.1.1.2.2.2.1.1.1.2.cmml" xref="S2.E5Xa.2.1.1.m1.5.5.1.1.2.2.2.1.1.1.2"></divide><apply id="S2.E5Xa.2.1.1.m1.5.5.1.1.2.2.2.1.1.1.1.2.cmml" xref="S2.E5Xa.2.1.1.m1.5.5.1.1.2.2.2.1.1.1.1.1"><apply id="S2.E5Xa.2.1.1.m1.5.5.1.1.2.2.2.1.1.1.1.1.1.cmml" xref="S2.E5Xa.2.1.1.m1.5.5.1.1.2.2.2.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S2.E5Xa.2.1.1.m1.5.5.1.1.2.2.2.1.1.1.1.1.1.1.cmml" xref="S2.E5Xa.2.1.1.m1.5.5.1.1.2.2.2.1.1.1.1.1.1">superscript</csymbol><ci id="S2.E5Xa.2.1.1.m1.5.5.1.1.2.2.2.1.1.1.1.1.1.2.cmml" xref="S2.E5Xa.2.1.1.m1.5.5.1.1.2.2.2.1.1.1.1.1.1.2">ViT</ci><ci id="S2.E5Xa.2.1.1.m1.5.5.1.1.2.2.2.1.1.1.1.1.1.3.cmml" xref="S2.E5Xa.2.1.1.m1.5.5.1.1.2.2.2.1.1.1.1.1.1.3">𝑔</ci></apply><ci id="S2.E5Xa.2.1.1.m1.4.4.cmml" xref="S2.E5Xa.2.1.1.m1.4.4">𝐱</ci></apply><ci id="S2.E5Xa.2.1.1.m1.5.5.1.1.2.2.2.1.1.1.3.cmml" xref="S2.E5Xa.2.1.1.m1.5.5.1.1.2.2.2.1.1.1.3">𝑇</ci></apply></apply></interval></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.E5Xa.2.1.1.m1.5c">\displaystyle\mathbf{KL}(\sigma(\operatorname{ViT}^{p,j}(\mathbf{x})/T),\sigma(\operatorname{ViT}^{g}(\mathbf{x})/T))\,.</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr>
</tbody>
</table>
<p id="S2.p4.8" class="ltx_p">The softmax <math id="S2.p4.5.m1.1" class="ltx_Math" alttext="\sigma(\cdot)" display="inline"><semantics id="S2.p4.5.m1.1a"><mrow id="S2.p4.5.m1.1.2" xref="S2.p4.5.m1.1.2.cmml"><mi id="S2.p4.5.m1.1.2.2" xref="S2.p4.5.m1.1.2.2.cmml">σ</mi><mo lspace="0em" rspace="0em" id="S2.p4.5.m1.1.2.1" xref="S2.p4.5.m1.1.2.1.cmml">​</mo><mrow id="S2.p4.5.m1.1.2.3.2" xref="S2.p4.5.m1.1.2.cmml"><mo stretchy="false" id="S2.p4.5.m1.1.2.3.2.1" xref="S2.p4.5.m1.1.2.cmml">(</mo><mo lspace="0em" rspace="0em" id="S2.p4.5.m1.1.1" xref="S2.p4.5.m1.1.1.cmml">⋅</mo><mo stretchy="false" id="S2.p4.5.m1.1.2.3.2.2" xref="S2.p4.5.m1.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.p4.5.m1.1b"><apply id="S2.p4.5.m1.1.2.cmml" xref="S2.p4.5.m1.1.2"><times id="S2.p4.5.m1.1.2.1.cmml" xref="S2.p4.5.m1.1.2.1"></times><ci id="S2.p4.5.m1.1.2.2.cmml" xref="S2.p4.5.m1.1.2.2">𝜎</ci><ci id="S2.p4.5.m1.1.1.cmml" xref="S2.p4.5.m1.1.1">⋅</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.p4.5.m1.1c">\sigma(\cdot)</annotation></semantics></math> softens the outputs of subnets after being divided by the temperature <math id="S2.p4.6.m2.1" class="ltx_Math" alttext="T" display="inline"><semantics id="S2.p4.6.m2.1a"><mi id="S2.p4.6.m2.1.1" xref="S2.p4.6.m2.1.1.cmml">T</mi><annotation-xml encoding="MathML-Content" id="S2.p4.6.m2.1b"><ci id="S2.p4.6.m2.1.1.cmml" xref="S2.p4.6.m2.1.1">𝑇</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.p4.6.m2.1c">T</annotation></semantics></math>. KL-divergence <math id="S2.p4.7.m3.2" class="ltx_Math" alttext="\mathbf{KL}(\cdot,\cdot)" display="inline"><semantics id="S2.p4.7.m3.2a"><mrow id="S2.p4.7.m3.2.3" xref="S2.p4.7.m3.2.3.cmml"><mi id="S2.p4.7.m3.2.3.2" xref="S2.p4.7.m3.2.3.2.cmml">𝐊𝐋</mi><mo lspace="0em" rspace="0em" id="S2.p4.7.m3.2.3.1" xref="S2.p4.7.m3.2.3.1.cmml">​</mo><mrow id="S2.p4.7.m3.2.3.3.2" xref="S2.p4.7.m3.2.3.3.1.cmml"><mo stretchy="false" id="S2.p4.7.m3.2.3.3.2.1" xref="S2.p4.7.m3.2.3.3.1.cmml">(</mo><mo lspace="0em" rspace="0em" id="S2.p4.7.m3.1.1" xref="S2.p4.7.m3.1.1.cmml">⋅</mo><mo rspace="0em" id="S2.p4.7.m3.2.3.3.2.2" xref="S2.p4.7.m3.2.3.3.1.cmml">,</mo><mo lspace="0em" rspace="0em" id="S2.p4.7.m3.2.2" xref="S2.p4.7.m3.2.2.cmml">⋅</mo><mo stretchy="false" id="S2.p4.7.m3.2.3.3.2.3" xref="S2.p4.7.m3.2.3.3.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.p4.7.m3.2b"><apply id="S2.p4.7.m3.2.3.cmml" xref="S2.p4.7.m3.2.3"><times id="S2.p4.7.m3.2.3.1.cmml" xref="S2.p4.7.m3.2.3.1"></times><ci id="S2.p4.7.m3.2.3.2.cmml" xref="S2.p4.7.m3.2.3.2">𝐊𝐋</ci><interval closure="open" id="S2.p4.7.m3.2.3.3.1.cmml" xref="S2.p4.7.m3.2.3.3.2"><ci id="S2.p4.7.m3.1.1.cmml" xref="S2.p4.7.m3.1.1">⋅</ci><ci id="S2.p4.7.m3.2.2.cmml" xref="S2.p4.7.m3.2.2">⋅</ci></interval></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.p4.7.m3.2c">\mathbf{KL}(\cdot,\cdot)</annotation></semantics></math> is not interchangeable, hence we symmetry it in Eq. (<a href="#S2.E5" title="In II Methods ‣ Federated Learning for Chronic Obstructive Pulmonary Disease Classification with Partial Personalized Attention Mechanism *Corresponding Author. Email: chenweidao163@163.com." class="ltx_ref"><span class="ltx_text ltx_ref_tag">5</span></a>). In the local training stage at <math id="S2.p4.8.m4.1" class="ltx_Math" alttext="j" display="inline"><semantics id="S2.p4.8.m4.1a"><mi id="S2.p4.8.m4.1.1" xref="S2.p4.8.m4.1.1.cmml">j</mi><annotation-xml encoding="MathML-Content" id="S2.p4.8.m4.1b"><ci id="S2.p4.8.m4.1.1.cmml" xref="S2.p4.8.m4.1.1">𝑗</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.p4.8.m4.1c">j</annotation></semantics></math><sup id="S2.p4.8.1" class="ltx_sup">th</sup>, the overall objective is</p>
<table id="S4.EGx2" class="ltx_equationgroup ltx_eqn_align ltx_eqn_table">

<tbody id="S2.E6"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math id="S2.E6.m1.1" class="ltx_Math" alttext="\displaystyle\mathcal{L}^{j}=" display="inline"><semantics id="S2.E6.m1.1a"><mrow id="S2.E6.m1.1.1" xref="S2.E6.m1.1.1.cmml"><msup id="S2.E6.m1.1.1.2" xref="S2.E6.m1.1.1.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S2.E6.m1.1.1.2.2" xref="S2.E6.m1.1.1.2.2.cmml">ℒ</mi><mi id="S2.E6.m1.1.1.2.3" xref="S2.E6.m1.1.1.2.3.cmml">j</mi></msup><mo id="S2.E6.m1.1.1.1" xref="S2.E6.m1.1.1.1.cmml">=</mo><mi id="S2.E6.m1.1.1.3" xref="S2.E6.m1.1.1.3.cmml"></mi></mrow><annotation-xml encoding="MathML-Content" id="S2.E6.m1.1b"><apply id="S2.E6.m1.1.1.cmml" xref="S2.E6.m1.1.1"><eq id="S2.E6.m1.1.1.1.cmml" xref="S2.E6.m1.1.1.1"></eq><apply id="S2.E6.m1.1.1.2.cmml" xref="S2.E6.m1.1.1.2"><csymbol cd="ambiguous" id="S2.E6.m1.1.1.2.1.cmml" xref="S2.E6.m1.1.1.2">superscript</csymbol><ci id="S2.E6.m1.1.1.2.2.cmml" xref="S2.E6.m1.1.1.2.2">ℒ</ci><ci id="S2.E6.m1.1.1.2.3.cmml" xref="S2.E6.m1.1.1.2.3">𝑗</ci></apply><csymbol cd="latexml" id="S2.E6.m1.1.1.3.cmml" xref="S2.E6.m1.1.1.3">absent</csymbol></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.E6.m1.1c">\displaystyle\mathcal{L}^{j}=</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math id="S2.E6.m2.2" class="ltx_Math" alttext="\displaystyle\mathcal{L}_{ce}+\lambda\cdot\mathcal{L}_{con}^{j},~{}~{}\text{with}" display="inline"><semantics id="S2.E6.m2.2a"><mrow id="S2.E6.m2.2.2.1" xref="S2.E6.m2.2.2.2.cmml"><mrow id="S2.E6.m2.2.2.1.1" xref="S2.E6.m2.2.2.1.1.cmml"><msub id="S2.E6.m2.2.2.1.1.2" xref="S2.E6.m2.2.2.1.1.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S2.E6.m2.2.2.1.1.2.2" xref="S2.E6.m2.2.2.1.1.2.2.cmml">ℒ</mi><mrow id="S2.E6.m2.2.2.1.1.2.3" xref="S2.E6.m2.2.2.1.1.2.3.cmml"><mi id="S2.E6.m2.2.2.1.1.2.3.2" xref="S2.E6.m2.2.2.1.1.2.3.2.cmml">c</mi><mo lspace="0em" rspace="0em" id="S2.E6.m2.2.2.1.1.2.3.1" xref="S2.E6.m2.2.2.1.1.2.3.1.cmml">​</mo><mi id="S2.E6.m2.2.2.1.1.2.3.3" xref="S2.E6.m2.2.2.1.1.2.3.3.cmml">e</mi></mrow></msub><mo id="S2.E6.m2.2.2.1.1.1" xref="S2.E6.m2.2.2.1.1.1.cmml">+</mo><mrow id="S2.E6.m2.2.2.1.1.3" xref="S2.E6.m2.2.2.1.1.3.cmml"><mi id="S2.E6.m2.2.2.1.1.3.2" xref="S2.E6.m2.2.2.1.1.3.2.cmml">λ</mi><mo lspace="0.222em" rspace="0.222em" id="S2.E6.m2.2.2.1.1.3.1" xref="S2.E6.m2.2.2.1.1.3.1.cmml">⋅</mo><msubsup id="S2.E6.m2.2.2.1.1.3.3" xref="S2.E6.m2.2.2.1.1.3.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S2.E6.m2.2.2.1.1.3.3.2.2" xref="S2.E6.m2.2.2.1.1.3.3.2.2.cmml">ℒ</mi><mrow id="S2.E6.m2.2.2.1.1.3.3.2.3" xref="S2.E6.m2.2.2.1.1.3.3.2.3.cmml"><mi id="S2.E6.m2.2.2.1.1.3.3.2.3.2" xref="S2.E6.m2.2.2.1.1.3.3.2.3.2.cmml">c</mi><mo lspace="0em" rspace="0em" id="S2.E6.m2.2.2.1.1.3.3.2.3.1" xref="S2.E6.m2.2.2.1.1.3.3.2.3.1.cmml">​</mo><mi id="S2.E6.m2.2.2.1.1.3.3.2.3.3" xref="S2.E6.m2.2.2.1.1.3.3.2.3.3.cmml">o</mi><mo lspace="0em" rspace="0em" id="S2.E6.m2.2.2.1.1.3.3.2.3.1a" xref="S2.E6.m2.2.2.1.1.3.3.2.3.1.cmml">​</mo><mi id="S2.E6.m2.2.2.1.1.3.3.2.3.4" xref="S2.E6.m2.2.2.1.1.3.3.2.3.4.cmml">n</mi></mrow><mi id="S2.E6.m2.2.2.1.1.3.3.3" xref="S2.E6.m2.2.2.1.1.3.3.3.cmml">j</mi></msubsup></mrow></mrow><mo rspace="0.827em" id="S2.E6.m2.2.2.1.2" xref="S2.E6.m2.2.2.2.cmml">,</mo><mtext id="S2.E6.m2.1.1" xref="S2.E6.m2.1.1a.cmml">with</mtext></mrow><annotation-xml encoding="MathML-Content" id="S2.E6.m2.2b"><list id="S2.E6.m2.2.2.2.cmml" xref="S2.E6.m2.2.2.1"><apply id="S2.E6.m2.2.2.1.1.cmml" xref="S2.E6.m2.2.2.1.1"><plus id="S2.E6.m2.2.2.1.1.1.cmml" xref="S2.E6.m2.2.2.1.1.1"></plus><apply id="S2.E6.m2.2.2.1.1.2.cmml" xref="S2.E6.m2.2.2.1.1.2"><csymbol cd="ambiguous" id="S2.E6.m2.2.2.1.1.2.1.cmml" xref="S2.E6.m2.2.2.1.1.2">subscript</csymbol><ci id="S2.E6.m2.2.2.1.1.2.2.cmml" xref="S2.E6.m2.2.2.1.1.2.2">ℒ</ci><apply id="S2.E6.m2.2.2.1.1.2.3.cmml" xref="S2.E6.m2.2.2.1.1.2.3"><times id="S2.E6.m2.2.2.1.1.2.3.1.cmml" xref="S2.E6.m2.2.2.1.1.2.3.1"></times><ci id="S2.E6.m2.2.2.1.1.2.3.2.cmml" xref="S2.E6.m2.2.2.1.1.2.3.2">𝑐</ci><ci id="S2.E6.m2.2.2.1.1.2.3.3.cmml" xref="S2.E6.m2.2.2.1.1.2.3.3">𝑒</ci></apply></apply><apply id="S2.E6.m2.2.2.1.1.3.cmml" xref="S2.E6.m2.2.2.1.1.3"><ci id="S2.E6.m2.2.2.1.1.3.1.cmml" xref="S2.E6.m2.2.2.1.1.3.1">⋅</ci><ci id="S2.E6.m2.2.2.1.1.3.2.cmml" xref="S2.E6.m2.2.2.1.1.3.2">𝜆</ci><apply id="S2.E6.m2.2.2.1.1.3.3.cmml" xref="S2.E6.m2.2.2.1.1.3.3"><csymbol cd="ambiguous" id="S2.E6.m2.2.2.1.1.3.3.1.cmml" xref="S2.E6.m2.2.2.1.1.3.3">superscript</csymbol><apply id="S2.E6.m2.2.2.1.1.3.3.2.cmml" xref="S2.E6.m2.2.2.1.1.3.3"><csymbol cd="ambiguous" id="S2.E6.m2.2.2.1.1.3.3.2.1.cmml" xref="S2.E6.m2.2.2.1.1.3.3">subscript</csymbol><ci id="S2.E6.m2.2.2.1.1.3.3.2.2.cmml" xref="S2.E6.m2.2.2.1.1.3.3.2.2">ℒ</ci><apply id="S2.E6.m2.2.2.1.1.3.3.2.3.cmml" xref="S2.E6.m2.2.2.1.1.3.3.2.3"><times id="S2.E6.m2.2.2.1.1.3.3.2.3.1.cmml" xref="S2.E6.m2.2.2.1.1.3.3.2.3.1"></times><ci id="S2.E6.m2.2.2.1.1.3.3.2.3.2.cmml" xref="S2.E6.m2.2.2.1.1.3.3.2.3.2">𝑐</ci><ci id="S2.E6.m2.2.2.1.1.3.3.2.3.3.cmml" xref="S2.E6.m2.2.2.1.1.3.3.2.3.3">𝑜</ci><ci id="S2.E6.m2.2.2.1.1.3.3.2.3.4.cmml" xref="S2.E6.m2.2.2.1.1.3.3.2.3.4">𝑛</ci></apply></apply><ci id="S2.E6.m2.2.2.1.1.3.3.3.cmml" xref="S2.E6.m2.2.2.1.1.3.3.3">𝑗</ci></apply></apply></apply><ci id="S2.E6.m2.1.1a.cmml" xref="S2.E6.m2.1.1"><mtext id="S2.E6.m2.1.1.cmml" xref="S2.E6.m2.1.1">with</mtext></ci></list></annotation-xml><annotation encoding="application/x-tex" id="S2.E6.m2.2c">\displaystyle\mathcal{L}_{ce}+\lambda\cdot\mathcal{L}_{con}^{j},~{}~{}\text{with}</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(6)</span></td>
</tr></tbody>
<tbody id="S2.E7"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_eqn_cell"></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math id="S2.E7.m1.5" class="ltx_Math" alttext="\displaystyle\mathcal{L}_{ce}=\operatorname{CrossEntropy}(\operatorname{ViT}(\mathbf{x}),y)," display="inline"><semantics id="S2.E7.m1.5a"><mrow id="S2.E7.m1.5.5.1" xref="S2.E7.m1.5.5.1.1.cmml"><mrow id="S2.E7.m1.5.5.1.1" xref="S2.E7.m1.5.5.1.1.cmml"><msub id="S2.E7.m1.5.5.1.1.3" xref="S2.E7.m1.5.5.1.1.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S2.E7.m1.5.5.1.1.3.2" xref="S2.E7.m1.5.5.1.1.3.2.cmml">ℒ</mi><mrow id="S2.E7.m1.5.5.1.1.3.3" xref="S2.E7.m1.5.5.1.1.3.3.cmml"><mi id="S2.E7.m1.5.5.1.1.3.3.2" xref="S2.E7.m1.5.5.1.1.3.3.2.cmml">c</mi><mo lspace="0em" rspace="0em" id="S2.E7.m1.5.5.1.1.3.3.1" xref="S2.E7.m1.5.5.1.1.3.3.1.cmml">​</mo><mi id="S2.E7.m1.5.5.1.1.3.3.3" xref="S2.E7.m1.5.5.1.1.3.3.3.cmml">e</mi></mrow></msub><mo id="S2.E7.m1.5.5.1.1.2" xref="S2.E7.m1.5.5.1.1.2.cmml">=</mo><mrow id="S2.E7.m1.5.5.1.1.1.1" xref="S2.E7.m1.5.5.1.1.1.2.cmml"><mi id="S2.E7.m1.3.3" xref="S2.E7.m1.3.3.cmml">CrossEntropy</mi><mo id="S2.E7.m1.5.5.1.1.1.1a" xref="S2.E7.m1.5.5.1.1.1.2.cmml">⁡</mo><mrow id="S2.E7.m1.5.5.1.1.1.1.1" xref="S2.E7.m1.5.5.1.1.1.2.cmml"><mo stretchy="false" id="S2.E7.m1.5.5.1.1.1.1.1.2" xref="S2.E7.m1.5.5.1.1.1.2.cmml">(</mo><mrow id="S2.E7.m1.5.5.1.1.1.1.1.1.2" xref="S2.E7.m1.5.5.1.1.1.1.1.1.1.cmml"><mi id="S2.E7.m1.1.1" xref="S2.E7.m1.1.1.cmml">ViT</mi><mo id="S2.E7.m1.5.5.1.1.1.1.1.1.2a" xref="S2.E7.m1.5.5.1.1.1.1.1.1.1.cmml">⁡</mo><mrow id="S2.E7.m1.5.5.1.1.1.1.1.1.2.1" xref="S2.E7.m1.5.5.1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S2.E7.m1.5.5.1.1.1.1.1.1.2.1.1" xref="S2.E7.m1.5.5.1.1.1.1.1.1.1.cmml">(</mo><mi id="S2.E7.m1.2.2" xref="S2.E7.m1.2.2.cmml">𝐱</mi><mo stretchy="false" id="S2.E7.m1.5.5.1.1.1.1.1.1.2.1.2" xref="S2.E7.m1.5.5.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S2.E7.m1.5.5.1.1.1.1.1.3" xref="S2.E7.m1.5.5.1.1.1.2.cmml">,</mo><mi id="S2.E7.m1.4.4" xref="S2.E7.m1.4.4.cmml">y</mi><mo stretchy="false" id="S2.E7.m1.5.5.1.1.1.1.1.4" xref="S2.E7.m1.5.5.1.1.1.2.cmml">)</mo></mrow></mrow></mrow><mo id="S2.E7.m1.5.5.1.2" xref="S2.E7.m1.5.5.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S2.E7.m1.5b"><apply id="S2.E7.m1.5.5.1.1.cmml" xref="S2.E7.m1.5.5.1"><eq id="S2.E7.m1.5.5.1.1.2.cmml" xref="S2.E7.m1.5.5.1.1.2"></eq><apply id="S2.E7.m1.5.5.1.1.3.cmml" xref="S2.E7.m1.5.5.1.1.3"><csymbol cd="ambiguous" id="S2.E7.m1.5.5.1.1.3.1.cmml" xref="S2.E7.m1.5.5.1.1.3">subscript</csymbol><ci id="S2.E7.m1.5.5.1.1.3.2.cmml" xref="S2.E7.m1.5.5.1.1.3.2">ℒ</ci><apply id="S2.E7.m1.5.5.1.1.3.3.cmml" xref="S2.E7.m1.5.5.1.1.3.3"><times id="S2.E7.m1.5.5.1.1.3.3.1.cmml" xref="S2.E7.m1.5.5.1.1.3.3.1"></times><ci id="S2.E7.m1.5.5.1.1.3.3.2.cmml" xref="S2.E7.m1.5.5.1.1.3.3.2">𝑐</ci><ci id="S2.E7.m1.5.5.1.1.3.3.3.cmml" xref="S2.E7.m1.5.5.1.1.3.3.3">𝑒</ci></apply></apply><apply id="S2.E7.m1.5.5.1.1.1.2.cmml" xref="S2.E7.m1.5.5.1.1.1.1"><ci id="S2.E7.m1.3.3.cmml" xref="S2.E7.m1.3.3">CrossEntropy</ci><apply id="S2.E7.m1.5.5.1.1.1.1.1.1.1.cmml" xref="S2.E7.m1.5.5.1.1.1.1.1.1.2"><ci id="S2.E7.m1.1.1.cmml" xref="S2.E7.m1.1.1">ViT</ci><ci id="S2.E7.m1.2.2.cmml" xref="S2.E7.m1.2.2">𝐱</ci></apply><ci id="S2.E7.m1.4.4.cmml" xref="S2.E7.m1.4.4">𝑦</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.E7.m1.5c">\displaystyle\mathcal{L}_{ce}=\operatorname{CrossEntropy}(\operatorname{ViT}(\mathbf{x}),y),</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(7)</span></td>
</tr></tbody>
</table>
<p id="S2.p4.11" class="ltx_p">where <math id="S2.p4.9.m1.1" class="ltx_Math" alttext="y" display="inline"><semantics id="S2.p4.9.m1.1a"><mi id="S2.p4.9.m1.1.1" xref="S2.p4.9.m1.1.1.cmml">y</mi><annotation-xml encoding="MathML-Content" id="S2.p4.9.m1.1b"><ci id="S2.p4.9.m1.1.1.cmml" xref="S2.p4.9.m1.1.1">𝑦</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.p4.9.m1.1c">y</annotation></semantics></math> is the ground truth associated with input image <math id="S2.p4.10.m2.1" class="ltx_Math" alttext="\mathbf{x}" display="inline"><semantics id="S2.p4.10.m2.1a"><mi id="S2.p4.10.m2.1.1" xref="S2.p4.10.m2.1.1.cmml">𝐱</mi><annotation-xml encoding="MathML-Content" id="S2.p4.10.m2.1b"><ci id="S2.p4.10.m2.1.1.cmml" xref="S2.p4.10.m2.1.1">𝐱</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.p4.10.m2.1c">\mathbf{x}</annotation></semantics></math>. Coefficient <math id="S2.p4.11.m3.1" class="ltx_Math" alttext="\lambda" display="inline"><semantics id="S2.p4.11.m3.1a"><mi id="S2.p4.11.m3.1.1" xref="S2.p4.11.m3.1.1.cmml">λ</mi><annotation-xml encoding="MathML-Content" id="S2.p4.11.m3.1b"><ci id="S2.p4.11.m3.1.1.cmml" xref="S2.p4.11.m3.1.1">𝜆</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.p4.11.m3.1c">\lambda</annotation></semantics></math> balances the cross entropy loss and the consistency regularization term.</p>
</div>
</section>
<section id="S3" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">III </span><span id="S3.1.1" class="ltx_text ltx_font_smallcaps">Experiments</span>
</h2>

<div id="S3.p1" class="ltx_para">
<p id="S3.p1.1" class="ltx_p"><span id="S3.p1.1.1" class="ltx_text ltx_font_bold">Datasets.</span> This study retrospectively collects and utilizes CT images of large patient cohorts from a public dataset NLST (Center 1) <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib18" title="" class="ltx_ref">18</a>]</cite> and five hospitals (Center 2-6) <span id="S3.p1.1.2" class="ltx_text ltx_font_italic">i.e. </span>a total number of six medical centers. Post-bronchodilator pulmonary function testing was available for all patients and applied as the primary criteria for COPD diagnosis <span id="S3.p1.1.3" class="ltx_text ltx_font_italic">i.e. </span>a forced expiratory volume in 1 sec (FEV1)/forced vital capacity (FVC) ratio of <math id="S3.p1.1.m1.1" class="ltx_Math" alttext="&lt;" display="inline"><semantics id="S3.p1.1.m1.1a"><mo id="S3.p1.1.m1.1.1" xref="S3.p1.1.m1.1.1.cmml">&lt;</mo><annotation-xml encoding="MathML-Content" id="S3.p1.1.m1.1b"><lt id="S3.p1.1.m1.1.1.cmml" xref="S3.p1.1.m1.1.1"></lt></annotation-xml><annotation encoding="application/x-tex" id="S3.p1.1.m1.1c">&lt;</annotation></semantics></math> 0.7. The inclusion criteria were (i) participants that underwent single inspiratory breath-hold CT scans in the supine position; (ii) at least one-time pulmonary function test; and (iii) aged 18 years and older and with no history of thoracic surgery. The exclusion criteria were (i) incomplete clinical or radiological data; (ii) compromised image quality; and (iii) substandard spirometric data. Data from different centers were collected from similar periods to exclude the selection bias on the time scale. The NLST public dataset included participants between 55 and 74 years old, with a smoking history of more than 30 pack-years and no self-reported history of lung cancer, thereby allowing us to include low-dose CT acquired among smokers in the dataset, which further adds to the data heterogeneity.
A total of 2856 participants were enrolled in the final cohort. Among them, 1077 patients were diagnosed with COPD and the other 1779 patients with non-COPD. The data volume of each dataset and data distributions are depicted in Fig. <a href="#S3.F2" title="Figure 2 ‣ III Experiments ‣ Federated Learning for Chronic Obstructive Pulmonary Disease Classification with Partial Personalized Attention Mechanism *Corresponding Author. Email: chenweidao163@163.com." class="ltx_ref"><span class="ltx_text ltx_ref_tag">2</span></a>.
Briefly, contiguous CT images were reconstructed in the transverse (axial) plane using standard reconstruction algorithms, creating three-dimensional volumes with up to 5.0 mm slice thickness.</p>
</div>
<figure id="S3.F2" class="ltx_figure"><img src="/html/2210.16142/assets/x2.png" id="S3.F2.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="461" height="194" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 2: </span>Data scale (a) and the distributions (b) of COPD CT slides from six medical centers used in our evaluation.</figcaption>
</figure>
<div id="S3.p2" class="ltx_para">
<p id="S3.p2.3" class="ltx_p"><span id="S3.p2.3.1" class="ltx_text ltx_font_bold">Implementations.</span> We implemented our methods and the baseline approaches by Pytorch on one NVIDIA Tesla V100 GPU device, where the distributed environment of FL is simulated by training the local epoch sequentially.
We use a consistent training scheme. A stochastic gradient descent optimizer is adopted for each local model update, where the Nesterov momentum and the weight decay rate are set to 0.9 and <math id="S3.p2.1.m1.1" class="ltx_Math" alttext="5\times 10^{-4}" display="inline"><semantics id="S3.p2.1.m1.1a"><mrow id="S3.p2.1.m1.1.1" xref="S3.p2.1.m1.1.1.cmml"><mn id="S3.p2.1.m1.1.1.2" xref="S3.p2.1.m1.1.1.2.cmml">5</mn><mo lspace="0.222em" rspace="0.222em" id="S3.p2.1.m1.1.1.1" xref="S3.p2.1.m1.1.1.1.cmml">×</mo><msup id="S3.p2.1.m1.1.1.3" xref="S3.p2.1.m1.1.1.3.cmml"><mn id="S3.p2.1.m1.1.1.3.2" xref="S3.p2.1.m1.1.1.3.2.cmml">10</mn><mrow id="S3.p2.1.m1.1.1.3.3" xref="S3.p2.1.m1.1.1.3.3.cmml"><mo id="S3.p2.1.m1.1.1.3.3a" xref="S3.p2.1.m1.1.1.3.3.cmml">−</mo><mn id="S3.p2.1.m1.1.1.3.3.2" xref="S3.p2.1.m1.1.1.3.3.2.cmml">4</mn></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S3.p2.1.m1.1b"><apply id="S3.p2.1.m1.1.1.cmml" xref="S3.p2.1.m1.1.1"><times id="S3.p2.1.m1.1.1.1.cmml" xref="S3.p2.1.m1.1.1.1"></times><cn type="integer" id="S3.p2.1.m1.1.1.2.cmml" xref="S3.p2.1.m1.1.1.2">5</cn><apply id="S3.p2.1.m1.1.1.3.cmml" xref="S3.p2.1.m1.1.1.3"><csymbol cd="ambiguous" id="S3.p2.1.m1.1.1.3.1.cmml" xref="S3.p2.1.m1.1.1.3">superscript</csymbol><cn type="integer" id="S3.p2.1.m1.1.1.3.2.cmml" xref="S3.p2.1.m1.1.1.3.2">10</cn><apply id="S3.p2.1.m1.1.1.3.3.cmml" xref="S3.p2.1.m1.1.1.3.3"><minus id="S3.p2.1.m1.1.1.3.3.1.cmml" xref="S3.p2.1.m1.1.1.3.3"></minus><cn type="integer" id="S3.p2.1.m1.1.1.3.3.2.cmml" xref="S3.p2.1.m1.1.1.3.3.2">4</cn></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p2.1.m1.1c">5\times 10^{-4}</annotation></semantics></math> respectively. The total federated epoch number is set to 50, with the local epoch number to 3. The temperature <math id="S3.p2.2.m2.1" class="ltx_Math" alttext="T" display="inline"><semantics id="S3.p2.2.m2.1a"><mi id="S3.p2.2.m2.1.1" xref="S3.p2.2.m2.1.1.cmml">T</mi><annotation-xml encoding="MathML-Content" id="S3.p2.2.m2.1b"><ci id="S3.p2.2.m2.1.1.cmml" xref="S3.p2.2.m2.1.1">𝑇</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.p2.2.m2.1c">T</annotation></semantics></math> in Eq. (<a href="#S2.E5" title="In II Methods ‣ Federated Learning for Chronic Obstructive Pulmonary Disease Classification with Partial Personalized Attention Mechanism *Corresponding Author. Email: chenweidao163@163.com." class="ltx_ref"><span class="ltx_text ltx_ref_tag">5</span></a>) is set to 4.0, the balancing coefficient in Eq. (<a href="#S2.E6" title="In II Methods ‣ Federated Learning for Chronic Obstructive Pulmonary Disease Classification with Partial Personalized Attention Mechanism *Corresponding Author. Email: chenweidao163@163.com." class="ltx_ref"><span class="ltx_text ltx_ref_tag">6</span></a>) as 1, and the personalization ratio <math id="S3.p2.3.m3.1" class="ltx_Math" alttext="p=0.6" display="inline"><semantics id="S3.p2.3.m3.1a"><mrow id="S3.p2.3.m3.1.1" xref="S3.p2.3.m3.1.1.cmml"><mi id="S3.p2.3.m3.1.1.2" xref="S3.p2.3.m3.1.1.2.cmml">p</mi><mo id="S3.p2.3.m3.1.1.1" xref="S3.p2.3.m3.1.1.1.cmml">=</mo><mn id="S3.p2.3.m3.1.1.3" xref="S3.p2.3.m3.1.1.3.cmml">0.6</mn></mrow><annotation-xml encoding="MathML-Content" id="S3.p2.3.m3.1b"><apply id="S3.p2.3.m3.1.1.cmml" xref="S3.p2.3.m3.1.1"><eq id="S3.p2.3.m3.1.1.1.cmml" xref="S3.p2.3.m3.1.1.1"></eq><ci id="S3.p2.3.m3.1.1.2.cmml" xref="S3.p2.3.m3.1.1.2">𝑝</ci><cn type="float" id="S3.p2.3.m3.1.1.3.cmml" xref="S3.p2.3.m3.1.1.3">0.6</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p2.3.m3.1c">p=0.6</annotation></semantics></math>.</p>
</div>
<figure id="S3.T1" class="ltx_table">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table">TABLE I: </span>Performance comparison with local training, FL with various network architectures and PFL with CNNs <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib2" title="" class="ltx_ref">2</a>, <a href="#bib.bib13" title="" class="ltx_ref">13</a>]</cite>. We demonstrate the performance of our approach both with and without the consistent regularization <span id="S3.T1.2.1" class="ltx_text ltx_font_italic">i.e. <math id="S3.T1.2.1.m1.1" class="ltx_Math" alttext="\mathcal{L}_{con}" display="inline"><semantics id="S3.T1.2.1.m1.1b"><msub id="S3.T1.2.1.m1.1.1" xref="S3.T1.2.1.m1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.T1.2.1.m1.1.1.2" xref="S3.T1.2.1.m1.1.1.2.cmml">ℒ</mi><mrow id="S3.T1.2.1.m1.1.1.3" xref="S3.T1.2.1.m1.1.1.3.cmml"><mi id="S3.T1.2.1.m1.1.1.3.2" xref="S3.T1.2.1.m1.1.1.3.2.cmml">c</mi><mo lspace="0em" rspace="0em" id="S3.T1.2.1.m1.1.1.3.1" xref="S3.T1.2.1.m1.1.1.3.1.cmml">​</mo><mi id="S3.T1.2.1.m1.1.1.3.3" xref="S3.T1.2.1.m1.1.1.3.3.cmml">o</mi><mo lspace="0em" rspace="0em" id="S3.T1.2.1.m1.1.1.3.1b" xref="S3.T1.2.1.m1.1.1.3.1.cmml">​</mo><mi id="S3.T1.2.1.m1.1.1.3.4" xref="S3.T1.2.1.m1.1.1.3.4.cmml">n</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S3.T1.2.1.m1.1c"><apply id="S3.T1.2.1.m1.1.1.cmml" xref="S3.T1.2.1.m1.1.1"><csymbol cd="ambiguous" id="S3.T1.2.1.m1.1.1.1.cmml" xref="S3.T1.2.1.m1.1.1">subscript</csymbol><ci id="S3.T1.2.1.m1.1.1.2.cmml" xref="S3.T1.2.1.m1.1.1.2">ℒ</ci><apply id="S3.T1.2.1.m1.1.1.3.cmml" xref="S3.T1.2.1.m1.1.1.3"><times id="S3.T1.2.1.m1.1.1.3.1.cmml" xref="S3.T1.2.1.m1.1.1.3.1"></times><ci id="S3.T1.2.1.m1.1.1.3.2.cmml" xref="S3.T1.2.1.m1.1.1.3.2">𝑐</ci><ci id="S3.T1.2.1.m1.1.1.3.3.cmml" xref="S3.T1.2.1.m1.1.1.3.3">𝑜</ci><ci id="S3.T1.2.1.m1.1.1.3.4.cmml" xref="S3.T1.2.1.m1.1.1.3.4">𝑛</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.T1.2.1.m1.1d">\mathcal{L}_{con}</annotation></semantics></math></span>. ‘Local # j’ denotes the local test AUC of the Center j, and ‘new’ denotes the new test AUC. The best performance is marked in <span id="S3.T1.7.2" class="ltx_text ltx_font_bold">boldface</span>, and the second best is <span id="S3.T1.8.3" class="ltx_text ltx_framed ltx_framed_underline">underlined</span>.</figcaption>
<div id="S3.T1.4" class="ltx_inline-block ltx_align_center ltx_transformed_outer" style="width:433.6pt;height:233.3pt;vertical-align:-0.0pt;"><span class="ltx_transformed_inner" style="transform:translate(-0.6pt,0.3pt) scale(0.997112212755485,0.997112212755485) ;">
<table id="S3.T1.4.2" class="ltx_tabular ltx_guessed_headers ltx_align_middle">
<thead class="ltx_thead">
<tr id="S3.T1.4.2.3.1" class="ltx_tr">
<th id="S3.T1.4.2.3.1.1" class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_th_row ltx_border_r ltx_border_tt">methods</th>
<th id="S3.T1.4.2.3.1.2" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt">local#1</th>
<th id="S3.T1.4.2.3.1.3" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt">local#2</th>
<th id="S3.T1.4.2.3.1.4" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt">local#3</th>
<th id="S3.T1.4.2.3.1.5" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt">local#4</th>
<th id="S3.T1.4.2.3.1.6" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt">local#5</th>
<th id="S3.T1.4.2.3.1.7" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_r ltx_border_tt">local#6</th>
<th id="S3.T1.4.2.3.1.8" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt">new</th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr id="S3.T1.4.2.4.1" class="ltx_tr">
<th id="S3.T1.4.2.4.1.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r ltx_border_t">Local Train+ResNet32</th>
<td id="S3.T1.4.2.4.1.2" class="ltx_td ltx_align_center ltx_border_t">0.720</td>
<td id="S3.T1.4.2.4.1.3" class="ltx_td ltx_align_center ltx_border_t">0.709</td>
<td id="S3.T1.4.2.4.1.4" class="ltx_td ltx_align_center ltx_border_t">0.674</td>
<td id="S3.T1.4.2.4.1.5" class="ltx_td ltx_align_center ltx_border_t">0.688</td>
<td id="S3.T1.4.2.4.1.6" class="ltx_td ltx_align_center ltx_border_t">0.612</td>
<td id="S3.T1.4.2.4.1.7" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">0.613</td>
<td id="S3.T1.4.2.4.1.8" class="ltx_td ltx_align_center ltx_border_t">0.674</td>
</tr>
<tr id="S3.T1.4.2.5.2" class="ltx_tr">
<th id="S3.T1.4.2.5.2.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r">Local Train+ResNet110</th>
<td id="S3.T1.4.2.5.2.2" class="ltx_td ltx_align_center">0.731</td>
<td id="S3.T1.4.2.5.2.3" class="ltx_td ltx_align_center">0.720</td>
<td id="S3.T1.4.2.5.2.4" class="ltx_td ltx_align_center">0.675</td>
<td id="S3.T1.4.2.5.2.5" class="ltx_td ltx_align_center">0.692</td>
<td id="S3.T1.4.2.5.2.6" class="ltx_td ltx_align_center">0.631</td>
<td id="S3.T1.4.2.5.2.7" class="ltx_td ltx_align_center ltx_border_r">0.618</td>
<td id="S3.T1.4.2.5.2.8" class="ltx_td ltx_align_center">0.680</td>
</tr>
<tr id="S3.T1.4.2.6.3" class="ltx_tr">
<th id="S3.T1.4.2.6.3.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r">Local Train+ViT</th>
<td id="S3.T1.4.2.6.3.2" class="ltx_td ltx_align_center">0.712</td>
<td id="S3.T1.4.2.6.3.3" class="ltx_td ltx_align_center">0.714</td>
<td id="S3.T1.4.2.6.3.4" class="ltx_td ltx_align_center">0.678</td>
<td id="S3.T1.4.2.6.3.5" class="ltx_td ltx_align_center">0.701</td>
<td id="S3.T1.4.2.6.3.6" class="ltx_td ltx_align_center">0.621</td>
<td id="S3.T1.4.2.6.3.7" class="ltx_td ltx_align_center ltx_border_r">0.634</td>
<td id="S3.T1.4.2.6.3.8" class="ltx_td ltx_align_center">0.687</td>
</tr>
<tr id="S3.T1.4.2.7.4" class="ltx_tr">
<th id="S3.T1.4.2.7.4.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r">
<span id="S3.T1.4.2.7.4.1.1" class="ltx_ERROR undefined">\hdashline</span><span id="S3.T1.4.2.7.4.1.2" class="ltx_text ltx_font_smallcaps">FedAvg</span>+ResNet32</th>
<td id="S3.T1.4.2.7.4.2" class="ltx_td ltx_align_center">0.821</td>
<td id="S3.T1.4.2.7.4.3" class="ltx_td ltx_align_center">0.834</td>
<td id="S3.T1.4.2.7.4.4" class="ltx_td ltx_align_center">0.832</td>
<td id="S3.T1.4.2.7.4.5" class="ltx_td ltx_align_center">0.827</td>
<td id="S3.T1.4.2.7.4.6" class="ltx_td ltx_align_center">0.790</td>
<td id="S3.T1.4.2.7.4.7" class="ltx_td ltx_align_center ltx_border_r">0.829</td>
<td id="S3.T1.4.2.7.4.8" class="ltx_td ltx_align_center">0.783</td>
</tr>
<tr id="S3.T1.4.2.8.5" class="ltx_tr">
<th id="S3.T1.4.2.8.5.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r">
<span id="S3.T1.4.2.8.5.1.1" class="ltx_text ltx_font_smallcaps">FedAvg</span>+ResNet110</th>
<td id="S3.T1.4.2.8.5.2" class="ltx_td ltx_align_center">0.828</td>
<td id="S3.T1.4.2.8.5.3" class="ltx_td ltx_align_center">0.836</td>
<td id="S3.T1.4.2.8.5.4" class="ltx_td ltx_align_center">0.835</td>
<td id="S3.T1.4.2.8.5.5" class="ltx_td ltx_align_center">0.815</td>
<td id="S3.T1.4.2.8.5.6" class="ltx_td ltx_align_center">0.799</td>
<td id="S3.T1.4.2.8.5.7" class="ltx_td ltx_align_center ltx_border_r">0.835</td>
<td id="S3.T1.4.2.8.5.8" class="ltx_td ltx_align_center">0.794</td>
</tr>
<tr id="S3.T1.4.2.9.6" class="ltx_tr">
<th id="S3.T1.4.2.9.6.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r">
<span id="S3.T1.4.2.9.6.1.1" class="ltx_text ltx_font_smallcaps">FedAvg</span>+ViT</th>
<td id="S3.T1.4.2.9.6.2" class="ltx_td ltx_align_center">0.835</td>
<td id="S3.T1.4.2.9.6.3" class="ltx_td ltx_align_center">0.839</td>
<td id="S3.T1.4.2.9.6.4" class="ltx_td ltx_align_center">0.841</td>
<td id="S3.T1.4.2.9.6.5" class="ltx_td ltx_align_center">0.842</td>
<td id="S3.T1.4.2.9.6.6" class="ltx_td ltx_align_center">0.811</td>
<td id="S3.T1.4.2.9.6.7" class="ltx_td ltx_align_center ltx_border_r">0.831</td>
<td id="S3.T1.4.2.9.6.8" class="ltx_td ltx_align_center">0.805</td>
</tr>
<tr id="S3.T1.4.2.10.7" class="ltx_tr">
<th id="S3.T1.4.2.10.7.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r">
<span id="S3.T1.4.2.10.7.1.1" class="ltx_ERROR undefined">\hdashline</span><span id="S3.T1.4.2.10.7.1.2" class="ltx_text ltx_font_smallcaps">FedPer</span>+ResNet32</th>
<td id="S3.T1.4.2.10.7.2" class="ltx_td ltx_align_center">0.844</td>
<td id="S3.T1.4.2.10.7.3" class="ltx_td ltx_align_center">0.853</td>
<td id="S3.T1.4.2.10.7.4" class="ltx_td ltx_align_center">0.847</td>
<td id="S3.T1.4.2.10.7.5" class="ltx_td ltx_align_center">0.848</td>
<td id="S3.T1.4.2.10.7.6" class="ltx_td ltx_align_center">0.832</td>
<td id="S3.T1.4.2.10.7.7" class="ltx_td ltx_align_center ltx_border_r">0.810</td>
<td id="S3.T1.4.2.10.7.8" class="ltx_td ltx_align_center">0.773</td>
</tr>
<tr id="S3.T1.4.2.11.8" class="ltx_tr">
<th id="S3.T1.4.2.11.8.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r">
<span id="S3.T1.4.2.11.8.1.1" class="ltx_text ltx_font_smallcaps">FedPer</span>+ResNet110</th>
<td id="S3.T1.4.2.11.8.2" class="ltx_td ltx_align_center">0.839</td>
<td id="S3.T1.4.2.11.8.3" class="ltx_td ltx_align_center">0.852</td>
<td id="S3.T1.4.2.11.8.4" class="ltx_td ltx_align_center">0.852</td>
<td id="S3.T1.4.2.11.8.5" class="ltx_td ltx_align_center">0.849</td>
<td id="S3.T1.4.2.11.8.6" class="ltx_td ltx_align_center">0.834</td>
<td id="S3.T1.4.2.11.8.7" class="ltx_td ltx_align_center ltx_border_r">0.816</td>
<td id="S3.T1.4.2.11.8.8" class="ltx_td ltx_align_center">0.776</td>
</tr>
<tr id="S3.T1.4.2.12.9" class="ltx_tr">
<th id="S3.T1.4.2.12.9.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r">
<span id="S3.T1.4.2.12.9.1.1" class="ltx_ERROR undefined">\hdashline</span><span id="S3.T1.4.2.12.9.1.2" class="ltx_text ltx_font_smallcaps">LG-FedAvg</span>+ResNet32</th>
<td id="S3.T1.4.2.12.9.2" class="ltx_td ltx_align_center">0.867</td>
<td id="S3.T1.4.2.12.9.3" class="ltx_td ltx_align_center">0.859</td>
<td id="S3.T1.4.2.12.9.4" class="ltx_td ltx_align_center">0.856</td>
<td id="S3.T1.4.2.12.9.5" class="ltx_td ltx_align_center">0.841</td>
<td id="S3.T1.4.2.12.9.6" class="ltx_td ltx_align_center">0.845</td>
<td id="S3.T1.4.2.12.9.7" class="ltx_td ltx_align_center ltx_border_r">0.837</td>
<td id="S3.T1.4.2.12.9.8" class="ltx_td ltx_align_center">0.802</td>
</tr>
<tr id="S3.T1.4.2.13.10" class="ltx_tr">
<th id="S3.T1.4.2.13.10.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r">
<span id="S3.T1.4.2.13.10.1.1" class="ltx_text ltx_font_smallcaps">LG-FedAvg</span>+ResNet110</th>
<td id="S3.T1.4.2.13.10.2" class="ltx_td ltx_align_center">0.871</td>
<td id="S3.T1.4.2.13.10.3" class="ltx_td ltx_align_center">0.858</td>
<td id="S3.T1.4.2.13.10.4" class="ltx_td ltx_align_center">0.857</td>
<td id="S3.T1.4.2.13.10.5" class="ltx_td ltx_align_center">0.832</td>
<td id="S3.T1.4.2.13.10.6" class="ltx_td ltx_align_center">0.859</td>
<td id="S3.T1.4.2.13.10.7" class="ltx_td ltx_align_center ltx_border_r">0.810</td>
<td id="S3.T1.4.2.13.10.8" class="ltx_td ltx_align_center">0.809</td>
</tr>
<tr id="S3.T1.3.1.1" class="ltx_tr">
<th id="S3.T1.3.1.1.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r">
<span id="S3.T1.3.1.1.1.1" class="ltx_ERROR undefined">\hdashline</span>Ours (w/o <math id="S3.T1.3.1.1.1.m1.1" class="ltx_Math" alttext="\mathcal{L}_{con}" display="inline"><semantics id="S3.T1.3.1.1.1.m1.1a"><msub id="S3.T1.3.1.1.1.m1.1.1" xref="S3.T1.3.1.1.1.m1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.T1.3.1.1.1.m1.1.1.2" xref="S3.T1.3.1.1.1.m1.1.1.2.cmml">ℒ</mi><mrow id="S3.T1.3.1.1.1.m1.1.1.3" xref="S3.T1.3.1.1.1.m1.1.1.3.cmml"><mi id="S3.T1.3.1.1.1.m1.1.1.3.2" xref="S3.T1.3.1.1.1.m1.1.1.3.2.cmml">c</mi><mo lspace="0em" rspace="0em" id="S3.T1.3.1.1.1.m1.1.1.3.1" xref="S3.T1.3.1.1.1.m1.1.1.3.1.cmml">​</mo><mi id="S3.T1.3.1.1.1.m1.1.1.3.3" xref="S3.T1.3.1.1.1.m1.1.1.3.3.cmml">o</mi><mo lspace="0em" rspace="0em" id="S3.T1.3.1.1.1.m1.1.1.3.1a" xref="S3.T1.3.1.1.1.m1.1.1.3.1.cmml">​</mo><mi id="S3.T1.3.1.1.1.m1.1.1.3.4" xref="S3.T1.3.1.1.1.m1.1.1.3.4.cmml">n</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S3.T1.3.1.1.1.m1.1b"><apply id="S3.T1.3.1.1.1.m1.1.1.cmml" xref="S3.T1.3.1.1.1.m1.1.1"><csymbol cd="ambiguous" id="S3.T1.3.1.1.1.m1.1.1.1.cmml" xref="S3.T1.3.1.1.1.m1.1.1">subscript</csymbol><ci id="S3.T1.3.1.1.1.m1.1.1.2.cmml" xref="S3.T1.3.1.1.1.m1.1.1.2">ℒ</ci><apply id="S3.T1.3.1.1.1.m1.1.1.3.cmml" xref="S3.T1.3.1.1.1.m1.1.1.3"><times id="S3.T1.3.1.1.1.m1.1.1.3.1.cmml" xref="S3.T1.3.1.1.1.m1.1.1.3.1"></times><ci id="S3.T1.3.1.1.1.m1.1.1.3.2.cmml" xref="S3.T1.3.1.1.1.m1.1.1.3.2">𝑐</ci><ci id="S3.T1.3.1.1.1.m1.1.1.3.3.cmml" xref="S3.T1.3.1.1.1.m1.1.1.3.3">𝑜</ci><ci id="S3.T1.3.1.1.1.m1.1.1.3.4.cmml" xref="S3.T1.3.1.1.1.m1.1.1.3.4">𝑛</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.T1.3.1.1.1.m1.1c">\mathcal{L}_{con}</annotation></semantics></math>)</th>
<td id="S3.T1.3.1.1.2" class="ltx_td ltx_align_center"><span id="S3.T1.3.1.1.2.1" class="ltx_text ltx_framed ltx_framed_underline">0.883</span></td>
<td id="S3.T1.3.1.1.3" class="ltx_td ltx_align_center"><span id="S3.T1.3.1.1.3.1" class="ltx_text ltx_framed ltx_framed_underline">0.864</span></td>
<td id="S3.T1.3.1.1.4" class="ltx_td ltx_align_center"><span id="S3.T1.3.1.1.4.1" class="ltx_text ltx_framed ltx_framed_underline">0.870</span></td>
<td id="S3.T1.3.1.1.5" class="ltx_td ltx_align_center"><span id="S3.T1.3.1.1.5.1" class="ltx_text ltx_framed ltx_framed_underline">0.851</span></td>
<td id="S3.T1.3.1.1.6" class="ltx_td ltx_align_center"><span id="S3.T1.3.1.1.6.1" class="ltx_text ltx_framed ltx_framed_underline">0.865</span></td>
<td id="S3.T1.3.1.1.7" class="ltx_td ltx_align_center ltx_border_r"><span id="S3.T1.3.1.1.7.1" class="ltx_text ltx_framed ltx_framed_underline">0.839</span></td>
<td id="S3.T1.3.1.1.8" class="ltx_td ltx_align_center"><span id="S3.T1.3.1.1.8.1" class="ltx_text ltx_framed ltx_framed_underline">0.841</span></td>
</tr>
<tr id="S3.T1.4.2.2" class="ltx_tr">
<th id="S3.T1.4.2.2.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_bb ltx_border_r">Ours (w <math id="S3.T1.4.2.2.1.m1.1" class="ltx_Math" alttext="\mathcal{L}_{con}" display="inline"><semantics id="S3.T1.4.2.2.1.m1.1a"><msub id="S3.T1.4.2.2.1.m1.1.1" xref="S3.T1.4.2.2.1.m1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.T1.4.2.2.1.m1.1.1.2" xref="S3.T1.4.2.2.1.m1.1.1.2.cmml">ℒ</mi><mrow id="S3.T1.4.2.2.1.m1.1.1.3" xref="S3.T1.4.2.2.1.m1.1.1.3.cmml"><mi id="S3.T1.4.2.2.1.m1.1.1.3.2" xref="S3.T1.4.2.2.1.m1.1.1.3.2.cmml">c</mi><mo lspace="0em" rspace="0em" id="S3.T1.4.2.2.1.m1.1.1.3.1" xref="S3.T1.4.2.2.1.m1.1.1.3.1.cmml">​</mo><mi id="S3.T1.4.2.2.1.m1.1.1.3.3" xref="S3.T1.4.2.2.1.m1.1.1.3.3.cmml">o</mi><mo lspace="0em" rspace="0em" id="S3.T1.4.2.2.1.m1.1.1.3.1a" xref="S3.T1.4.2.2.1.m1.1.1.3.1.cmml">​</mo><mi id="S3.T1.4.2.2.1.m1.1.1.3.4" xref="S3.T1.4.2.2.1.m1.1.1.3.4.cmml">n</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S3.T1.4.2.2.1.m1.1b"><apply id="S3.T1.4.2.2.1.m1.1.1.cmml" xref="S3.T1.4.2.2.1.m1.1.1"><csymbol cd="ambiguous" id="S3.T1.4.2.2.1.m1.1.1.1.cmml" xref="S3.T1.4.2.2.1.m1.1.1">subscript</csymbol><ci id="S3.T1.4.2.2.1.m1.1.1.2.cmml" xref="S3.T1.4.2.2.1.m1.1.1.2">ℒ</ci><apply id="S3.T1.4.2.2.1.m1.1.1.3.cmml" xref="S3.T1.4.2.2.1.m1.1.1.3"><times id="S3.T1.4.2.2.1.m1.1.1.3.1.cmml" xref="S3.T1.4.2.2.1.m1.1.1.3.1"></times><ci id="S3.T1.4.2.2.1.m1.1.1.3.2.cmml" xref="S3.T1.4.2.2.1.m1.1.1.3.2">𝑐</ci><ci id="S3.T1.4.2.2.1.m1.1.1.3.3.cmml" xref="S3.T1.4.2.2.1.m1.1.1.3.3">𝑜</ci><ci id="S3.T1.4.2.2.1.m1.1.1.3.4.cmml" xref="S3.T1.4.2.2.1.m1.1.1.3.4">𝑛</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.T1.4.2.2.1.m1.1c">\mathcal{L}_{con}</annotation></semantics></math>)</th>
<td id="S3.T1.4.2.2.2" class="ltx_td ltx_align_center ltx_border_bb"><span id="S3.T1.4.2.2.2.1" class="ltx_text ltx_font_bold">0.887</span></td>
<td id="S3.T1.4.2.2.3" class="ltx_td ltx_align_center ltx_border_bb"><span id="S3.T1.4.2.2.3.1" class="ltx_text ltx_font_bold">0.871</span></td>
<td id="S3.T1.4.2.2.4" class="ltx_td ltx_align_center ltx_border_bb"><span id="S3.T1.4.2.2.4.1" class="ltx_text ltx_font_bold">0.874</span></td>
<td id="S3.T1.4.2.2.5" class="ltx_td ltx_align_center ltx_border_bb"><span id="S3.T1.4.2.2.5.1" class="ltx_text ltx_font_bold">0.862</span></td>
<td id="S3.T1.4.2.2.6" class="ltx_td ltx_align_center ltx_border_bb"><span id="S3.T1.4.2.2.6.1" class="ltx_text ltx_font_bold">0.876</span></td>
<td id="S3.T1.4.2.2.7" class="ltx_td ltx_align_center ltx_border_bb ltx_border_r"><span id="S3.T1.4.2.2.7.1" class="ltx_text ltx_font_bold">0.843</span></td>
<td id="S3.T1.4.2.2.8" class="ltx_td ltx_align_center ltx_border_bb"><span id="S3.T1.4.2.2.8.1" class="ltx_text ltx_font_bold">0.854</span></td>
</tr>
</tbody>
</table>
</span></div>
</figure>
<div id="S3.p3" class="ltx_para">
<p id="S3.p3.1" class="ltx_p"><span id="S3.p3.1.1" class="ltx_text ltx_font_bold">Method Comparison.</span> We compare our method with the baseline vanilla FL <span id="S3.p3.1.2" class="ltx_text ltx_font_smallcaps">FedAvg</span> and local training. We also compare our proposed method with CNN-based PFL approaches, where ResNet32 and ResNet110 <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib9" title="" class="ltx_ref">9</a>]</cite> are selected as the CNN backbones for their compact structures and outstanding performance in the medical domain. We use ViT-Small <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib6" title="" class="ltx_ref">6</a>]</cite> as the backbone in our PFL approach. All backbone networks are trained from scratch, without loading any pre-trained weights for a fair comparison. Two state-of-the-art personalization are compared, namely <span id="S3.p3.1.3" class="ltx_text ltx_font_smallcaps">FedPer</span> <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib2" title="" class="ltx_ref">2</a>]</cite> and <span id="S3.p3.1.4" class="ltx_text ltx_font_smallcaps">LG-FedAvg</span> <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib13" title="" class="ltx_ref">13</a>]</cite>. For the extra hyper-parameters involved in these compared methods, we retain their original settings. We use the AUC (Area Under Curve) as the evaluation metric in two configurations, namely local test and new test <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib13" title="" class="ltx_ref">13</a>]</cite>. In the local test, we know precisely the client ID where the CT images come from, thus we can choose the particular associated local model. These metrics intend to measure the performance of local personalized weights. In the new test, the client ID of the test sample is unknown, thus we employ an ensemble of all local models to derive averaged predictions, intending to measure the compatibility between local and global weights.</p>
</div>
<div id="S3.p4" class="ltx_para">
<p id="S3.p4.3" class="ltx_p"><span id="S3.p4.3.2" class="ltx_text ltx_font_bold">Results.</span> As shown in Table <a href="#S3.T1" title="TABLE I ‣ III Experiments ‣ Federated Learning for Chronic Obstructive Pulmonary Disease Classification with Partial Personalized Attention Mechanism *Corresponding Author. Email: chenweidao163@163.com." class="ltx_ref"><span class="ltx_text ltx_ref_tag">I</span></a>, our personalization scheme can improve baseline <span id="S3.p4.3.3" class="ltx_text ltx_font_smallcaps">FedAvg</span> by 0.012 to 0.065 local test AUC and 0.049 new test AUC. Moreover, our approach outperforms the state-of-the-art CNN-based PFL methods and illustrates a higher improvement rate to these methods in terms of local test AUC. Our method achieves the highest new test AUC indicating that our model is capable of extracting the common attention with the global shared weights, in addition to the local personalized attention with the personalized weights. With the consistent regularization <span id="S3.p4.1.1" class="ltx_text ltx_font_italic">i.e. <math id="S3.p4.1.1.m1.1" class="ltx_Math" alttext="\mathcal{L}_{con}" display="inline"><semantics id="S3.p4.1.1.m1.1a"><msub id="S3.p4.1.1.m1.1.1" xref="S3.p4.1.1.m1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.p4.1.1.m1.1.1.2" xref="S3.p4.1.1.m1.1.1.2.cmml">ℒ</mi><mrow id="S3.p4.1.1.m1.1.1.3" xref="S3.p4.1.1.m1.1.1.3.cmml"><mi id="S3.p4.1.1.m1.1.1.3.2" xref="S3.p4.1.1.m1.1.1.3.2.cmml">c</mi><mo lspace="0em" rspace="0em" id="S3.p4.1.1.m1.1.1.3.1" xref="S3.p4.1.1.m1.1.1.3.1.cmml">​</mo><mi id="S3.p4.1.1.m1.1.1.3.3" xref="S3.p4.1.1.m1.1.1.3.3.cmml">o</mi><mo lspace="0em" rspace="0em" id="S3.p4.1.1.m1.1.1.3.1a" xref="S3.p4.1.1.m1.1.1.3.1.cmml">​</mo><mi id="S3.p4.1.1.m1.1.1.3.4" xref="S3.p4.1.1.m1.1.1.3.4.cmml">n</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S3.p4.1.1.m1.1b"><apply id="S3.p4.1.1.m1.1.1.cmml" xref="S3.p4.1.1.m1.1.1"><csymbol cd="ambiguous" id="S3.p4.1.1.m1.1.1.1.cmml" xref="S3.p4.1.1.m1.1.1">subscript</csymbol><ci id="S3.p4.1.1.m1.1.1.2.cmml" xref="S3.p4.1.1.m1.1.1.2">ℒ</ci><apply id="S3.p4.1.1.m1.1.1.3.cmml" xref="S3.p4.1.1.m1.1.1.3"><times id="S3.p4.1.1.m1.1.1.3.1.cmml" xref="S3.p4.1.1.m1.1.1.3.1"></times><ci id="S3.p4.1.1.m1.1.1.3.2.cmml" xref="S3.p4.1.1.m1.1.1.3.2">𝑐</ci><ci id="S3.p4.1.1.m1.1.1.3.3.cmml" xref="S3.p4.1.1.m1.1.1.3.3">𝑜</ci><ci id="S3.p4.1.1.m1.1.1.3.4.cmml" xref="S3.p4.1.1.m1.1.1.3.4">𝑛</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p4.1.1.m1.1c">\mathcal{L}_{con}</annotation></semantics></math></span> in Eq. (<a href="#S2.E5" title="In II Methods ‣ Federated Learning for Chronic Obstructive Pulmonary Disease Classification with Partial Personalized Attention Mechanism *Corresponding Author. Email: chenweidao163@163.com." class="ltx_ref"><span class="ltx_text ltx_ref_tag">5</span></a>), our method achieves extra performance gain, suggesting the effectiveness of each component of our method.
As shown in Fig. <a href="#S3.F3" title="Figure 3 ‣ III Experiments ‣ Federated Learning for Chronic Obstructive Pulmonary Disease Classification with Partial Personalized Attention Mechanism *Corresponding Author. Email: chenweidao163@163.com." class="ltx_ref"><span class="ltx_text ltx_ref_tag">3</span></a>, the method achieves the highest performance in terms of Local Test AUC when <math id="S3.p4.2.m1.1" class="ltx_Math" alttext="p=0.6" display="inline"><semantics id="S3.p4.2.m1.1a"><mrow id="S3.p4.2.m1.1.1" xref="S3.p4.2.m1.1.1.cmml"><mi id="S3.p4.2.m1.1.1.2" xref="S3.p4.2.m1.1.1.2.cmml">p</mi><mo id="S3.p4.2.m1.1.1.1" xref="S3.p4.2.m1.1.1.1.cmml">=</mo><mn id="S3.p4.2.m1.1.1.3" xref="S3.p4.2.m1.1.1.3.cmml">0.6</mn></mrow><annotation-xml encoding="MathML-Content" id="S3.p4.2.m1.1b"><apply id="S3.p4.2.m1.1.1.cmml" xref="S3.p4.2.m1.1.1"><eq id="S3.p4.2.m1.1.1.1.cmml" xref="S3.p4.2.m1.1.1.1"></eq><ci id="S3.p4.2.m1.1.1.2.cmml" xref="S3.p4.2.m1.1.1.2">𝑝</ci><cn type="float" id="S3.p4.2.m1.1.1.3.cmml" xref="S3.p4.2.m1.1.1.3">0.6</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p4.2.m1.1c">p=0.6</annotation></semantics></math> and New Test AUC with <math id="S3.p4.3.m2.1" class="ltx_Math" alttext="p=0.4" display="inline"><semantics id="S3.p4.3.m2.1a"><mrow id="S3.p4.3.m2.1.1" xref="S3.p4.3.m2.1.1.cmml"><mi id="S3.p4.3.m2.1.1.2" xref="S3.p4.3.m2.1.1.2.cmml">p</mi><mo id="S3.p4.3.m2.1.1.1" xref="S3.p4.3.m2.1.1.1.cmml">=</mo><mn id="S3.p4.3.m2.1.1.3" xref="S3.p4.3.m2.1.1.3.cmml">0.4</mn></mrow><annotation-xml encoding="MathML-Content" id="S3.p4.3.m2.1b"><apply id="S3.p4.3.m2.1.1.cmml" xref="S3.p4.3.m2.1.1"><eq id="S3.p4.3.m2.1.1.1.cmml" xref="S3.p4.3.m2.1.1.1"></eq><ci id="S3.p4.3.m2.1.1.2.cmml" xref="S3.p4.3.m2.1.1.2">𝑝</ci><cn type="float" id="S3.p4.3.m2.1.1.3.cmml" xref="S3.p4.3.m2.1.1.3">0.4</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p4.3.m2.1c">p=0.4</annotation></semantics></math>,
which implies that a competitive proportion of local personalized knowledge can mitigate the data shift dilemma among different local data centers.</p>
</div>
<figure id="S3.F3" class="ltx_figure"><img src="/html/2210.16142/assets/figs/ablation.png" id="S3.F3.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="515" height="365" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 3: </span>Ablation on the effect of personalization ratio <math id="S3.F3.2.m1.1" class="ltx_Math" alttext="p" display="inline"><semantics id="S3.F3.2.m1.1b"><mi id="S3.F3.2.m1.1.1" xref="S3.F3.2.m1.1.1.cmml">p</mi><annotation-xml encoding="MathML-Content" id="S3.F3.2.m1.1c"><ci id="S3.F3.2.m1.1.1.cmml" xref="S3.F3.2.m1.1.1">𝑝</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.F3.2.m1.1d">p</annotation></semantics></math> in terms of averaged local test AUC and new test AUC.</figcaption>
</figure>
</section>
<section id="S4" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">IV </span><span id="S4.1.1" class="ltx_text ltx_font_smallcaps">Conclusion</span>
</h2>

<div id="S4.p1" class="ltx_para">
<p id="S4.p1.1" class="ltx_p">In this paper, a novel partial personalization scheme is proposed, specifically for vision transformers in the federated learning paradigm. To be more specific, some heads in the multiheaded self-attention layer are personalized, while the rest heads remain globally shared. The partial personalization scheme intends to learn both local attention and global attention. We evaluate our method on COPD CT images curated from six data centers. Our method, with a consistent regularization between local and global self-attention heads, significantly improves the baseline <span id="S4.p1.1.1" class="ltx_text ltx_font_smallcaps">FedAvg</span> and outperforms other CNN-based PFL methods. One interesting future direction is to evaluate our approach to different data modalities.</p>
</div>
</section>
<section id="bib" class="ltx_bibliography">
<h2 class="ltx_title ltx_title_bibliography">References</h2>

<ul class="ltx_biblist">
<li id="bib.bib1" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[1]</span>
<span class="ltx_bibblock">
George J Annas.

</span>
<span class="ltx_bibblock">Hipaa regulations—a new era of medical-record privacy?, 2003.

</span>
</li>
<li id="bib.bib2" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[2]</span>
<span class="ltx_bibblock">
Manoj Ghuhan Arivazhagan et al.

</span>
<span class="ltx_bibblock">Federated learning with personalization layers.

</span>
<span class="ltx_bibblock"><span id="bib.bib2.1.1" class="ltx_text ltx_font_italic">arXiv preprint arXiv:1912.00818</span>, 2019.

</span>
</li>
<li id="bib.bib3" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[3]</span>
<span class="ltx_bibblock">
Jimmy Lei Ba et al.

</span>
<span class="ltx_bibblock">Layer normalization.

</span>
<span class="ltx_bibblock"><span id="bib.bib3.1.1" class="ltx_text ltx_font_italic">arXiv preprint arXiv:1607.06450</span>, 2016.

</span>
</li>
<li id="bib.bib4" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[4]</span>
<span class="ltx_bibblock">
Tom Brown et al.

</span>
<span class="ltx_bibblock">Language models are few-shot learners.

</span>
<span class="ltx_bibblock"><span id="bib.bib4.1.1" class="ltx_text ltx_font_italic">Advances in neural information processing systems</span>,
33:1877–1901, 2020.

</span>
</li>
<li id="bib.bib5" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[5]</span>
<span class="ltx_bibblock">
Veronika Cheplygina et al.

</span>
<span class="ltx_bibblock">Transfer learning for multicenter classification of chronic
obstructive pulmonary disease.

</span>
<span class="ltx_bibblock"><span id="bib.bib5.1.1" class="ltx_text ltx_font_italic">IEEE journal of biomedical and health informatics</span>,
22(5):1486–1496, 2017.

</span>
</li>
<li id="bib.bib6" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[6]</span>
<span class="ltx_bibblock">
Alexey Dosovitskiy et al.

</span>
<span class="ltx_bibblock">An image is worth 16x16 words: Transformers for image recognition at
scale.

</span>
<span class="ltx_bibblock"><span id="bib.bib6.1.1" class="ltx_text ltx_font_italic">arXiv preprint arXiv:2010.11929</span>, 2020.

</span>
</li>
<li id="bib.bib7" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[7]</span>
<span class="ltx_bibblock">
Centers for Disease Control, Prevention (CDC, et al.

</span>
<span class="ltx_bibblock">Million hearts: strategies to reduce the prevalence of leading
cardiovascular disease risk factors–united states, 2011.

</span>
<span class="ltx_bibblock"><span id="bib.bib7.1.1" class="ltx_text ltx_font_italic">MMWR. Morbidity and mortality weekly report</span>, 60(36):1248–1251,
2011.

</span>
</li>
<li id="bib.bib8" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[8]</span>
<span class="ltx_bibblock">
Kyle A Hasenstab et al.

</span>
<span class="ltx_bibblock">Automated ct staging of chronic obstructive pulmonary disease
severity for predicting disease progression and mortality with a deep
learning convolutional neural network.

</span>
<span class="ltx_bibblock"><span id="bib.bib8.1.1" class="ltx_text ltx_font_italic">Radiology: Cardiothoracic Imaging</span>, 3(2):e200477, 2021.

</span>
</li>
<li id="bib.bib9" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[9]</span>
<span class="ltx_bibblock">
K. He et al.

</span>
<span class="ltx_bibblock">Deep residual learning for image recognition.

</span>
<span class="ltx_bibblock">In <span id="bib.bib9.1.1" class="ltx_text ltx_font_italic">Proceedings of the IEEE conference on computer vision and
pattern recognition</span>, pages 770–778, 2016.

</span>
</li>
<li id="bib.bib10" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[10]</span>
<span class="ltx_bibblock">
Peter Kairouz et al.

</span>
<span class="ltx_bibblock">Advances and open problems in federated learning.

</span>
<span class="ltx_bibblock"><span id="bib.bib10.1.1" class="ltx_text ltx_font_italic">arXiv preprint arXiv:1912.04977</span>, 2019.

</span>
</li>
<li id="bib.bib11" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[11]</span>
<span class="ltx_bibblock">
Jing Ke et al.

</span>
<span class="ltx_bibblock">Style normalization in histology with federated learning.

</span>
<span class="ltx_bibblock">In <span id="bib.bib11.1.1" class="ltx_text ltx_font_italic">2021 IEEE 18th International Symposium on Biomedical Imaging
(ISBI)</span>, pages 953–956. IEEE, 2021.

</span>
</li>
<li id="bib.bib12" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[12]</span>
<span class="ltx_bibblock">
Viraj Kulkarni et al.

</span>
<span class="ltx_bibblock">Survey of personalization techniques for federated learning.

</span>
<span class="ltx_bibblock">In <span id="bib.bib12.1.1" class="ltx_text ltx_font_italic">2020 Fourth World Conference on Smart Trends in Systems,
Security and Sustainability (WorldS4)</span>, pages 794–797. IEEE, 2020.

</span>
</li>
<li id="bib.bib13" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[13]</span>
<span class="ltx_bibblock">
Paul Pu Liang et al.

</span>
<span class="ltx_bibblock">Think locally, act globally: Federated learning with local and global
representations.

</span>
<span class="ltx_bibblock"><span id="bib.bib13.1.1" class="ltx_text ltx_font_italic">arXiv preprint arXiv:2001.01523</span>, 2020.

</span>
</li>
<li id="bib.bib14" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[14]</span>
<span class="ltx_bibblock">
Katherine E Lowe et al.

</span>
<span class="ltx_bibblock">Copdgene® 2019: redefining the diagnosis of chronic
obstructive pulmonary disease.

</span>
<span class="ltx_bibblock"><span id="bib.bib14.1.1" class="ltx_text ltx_font_italic">Chronic Obstructive Pulmonary Diseases: Journal of the COPD
Foundation</span>, 6(5):384, 2019.

</span>
</li>
<li id="bib.bib15" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[15]</span>
<span class="ltx_bibblock">
H. Brendan McMahan et al.

</span>
<span class="ltx_bibblock">Communication-efficient learning of deep networks from decentralized
data, 2017.

</span>
</li>
<li id="bib.bib16" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[16]</span>
<span class="ltx_bibblock">
Adnan Qayyum et al.

</span>
<span class="ltx_bibblock">Collaborative federated learning for healthcare: Multi-modal covid-19
diagnosis at the edge.

</span>
<span class="ltx_bibblock"><span id="bib.bib16.1.1" class="ltx_text ltx_font_italic">arXiv preprint arXiv:2101.07511</span>, 2021.

</span>
</li>
<li id="bib.bib17" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[17]</span>
<span class="ltx_bibblock">
Nicola Rieke et al.

</span>
<span class="ltx_bibblock">The future of digital health with federated learning.

</span>
<span class="ltx_bibblock"><span id="bib.bib17.1.1" class="ltx_text ltx_font_italic">NPJ digital medicine</span>, 3(1):1–7, 2020.

</span>
</li>
<li id="bib.bib18" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[18]</span>
<span class="ltx_bibblock">
National Lung Screening Trial Research Team.

</span>
<span class="ltx_bibblock">Reduced lung-cancer mortality with low-dose computed tomographic
screening.

</span>
<span class="ltx_bibblock"><span id="bib.bib18.1.1" class="ltx_text ltx_font_italic">New England Journal of Medicine</span>, 365(5):395–409, 2011.

</span>
</li>
<li id="bib.bib19" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[19]</span>
<span class="ltx_bibblock">
Jørgen Vestbo et al.

</span>
<span class="ltx_bibblock">Changes in forced expiratory volume in 1 second over time in copd.

</span>
<span class="ltx_bibblock"><span id="bib.bib19.1.1" class="ltx_text ltx_font_italic">New England Journal of Medicine</span>, 365(13):1184–1192, 2011.

</span>
</li>
<li id="bib.bib20" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[20]</span>
<span class="ltx_bibblock">
Paul Voigt et al.

</span>
<span class="ltx_bibblock">The eu general data protection regulation (gdpr).

</span>
<span class="ltx_bibblock"><span id="bib.bib20.1.1" class="ltx_text ltx_font_italic">A Practical Guide, 1st Ed., Cham: Springer International
Publishing</span>, 10:3152676, 2017.

</span>
</li>
<li id="bib.bib21" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[21]</span>
<span class="ltx_bibblock">
Ruohua Yan et al.

</span>
<span class="ltx_bibblock">Healthy lifestyle behaviors among individuals with chronic
obstructive pulmonary disease in urban and rural communities in china: a
large community-based epidemiological study.

</span>
<span class="ltx_bibblock"><span id="bib.bib21.1.1" class="ltx_text ltx_font_italic">International Journal of Chronic Obstructive Pulmonary Disease</span>,
12:3311, 2017.

</span>
</li>
<li id="bib.bib22" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[22]</span>
<span class="ltx_bibblock">
Jiahui Yu et al.

</span>
<span class="ltx_bibblock">Universally slimmable networks and improved training techniques.

</span>
<span class="ltx_bibblock">In <span id="bib.bib22.1.1" class="ltx_text ltx_font_italic">Proceedings of the IEEE/CVF International Conference on
Computer Vision</span>, pages 1803–1811, 2019.

</span>
</li>
<li id="bib.bib23" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[23]</span>
<span class="ltx_bibblock">
Weishan Zhang et al.

</span>
<span class="ltx_bibblock">Dynamic-fusion-based federated learning for covid-19 detection.

</span>
<span class="ltx_bibblock"><span id="bib.bib23.1.1" class="ltx_text ltx_font_italic">IEEE Internet of Things Journal</span>, 8(21):15884–15891, 2021.

</span>
</li>
<li id="bib.bib24" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[24]</span>
<span class="ltx_bibblock">
Yue Zhao et al.

</span>
<span class="ltx_bibblock">Federated learning with non-iid data.

</span>
<span class="ltx_bibblock"><span id="bib.bib24.1.1" class="ltx_text ltx_font_italic">arXiv preprint arXiv:1806.00582</span>, 2018.

</span>
</li>
</ul>
</section>
</article>
</div>
<div class="ar5iv-footer"><a href="/html/2210.16141" class="ar5iv-nav-button ar5iv-nav-button-prev">◄</a>
    <a class="ar5iv-home-button" href="/"><img height="40" alt="ar5iv homepage" src="/assets/ar5iv.png"></a>
    <a href="/feeling_lucky" class="ar5iv-text-button">Feeling<br>lucky?</a>
    <a href="/log/2210.16142" class="ar5iv-text-button ar5iv-severity-error">Conversion<br>report</a>
    <a class="ar5iv-text-button" target="_blank" href="https://github.com/dginev/ar5iv/issues/new?template=improve-article--arxiv-id-.md&title=Improve+article+2210.16142">Report<br>an issue</a>
    <a href="https://arxiv.org/abs/2210.16142" class="ar5iv-text-button arxiv-ui-theme">View&nbsp;original<br>on&nbsp;arXiv</a><a href="/html/2210.16143" class="ar5iv-nav-button ar5iv-nav-button-next">►</a>
</div><footer class="ltx_page_footer">
<a class="ar5iv-toggle-color-scheme" href="javascript:toggleColorScheme()" title="Toggle ar5iv color scheme"><span class="color-scheme-icon"></span></a>
<a class="ar5iv-footer-button" href="https://arxiv.org/help/license" target="_blank">Copyright</a>
<a class="ar5iv-footer-button" href="https://arxiv.org/help/policies/privacy_policy" target="_blank">Privacy Policy</a>

<div class="ltx_page_logo">Generated  on Thu Mar 14 02:41:38 2024 by <a target="_blank" href="http://dlmf.nist.gov/LaTeXML/" class="ltx_LaTeXML_logo"><span style="letter-spacing:-0.2em; margin-right:0.1em;">L<span class="ltx_font_smallcaps" style="position:relative; bottom:2.2pt;">a</span>T<span class="ltx_font_smallcaps" style="font-size:120%;position:relative; bottom:-0.2ex;">e</span></span><span style="font-size:90%; position:relative; bottom:-0.2ex;">XML</span><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAsAAAAOCAYAAAD5YeaVAAAAAXNSR0IArs4c6QAAAAZiS0dEAP8A/wD/oL2nkwAAAAlwSFlzAAALEwAACxMBAJqcGAAAAAd0SU1FB9wKExQZLWTEaOUAAAAddEVYdENvbW1lbnQAQ3JlYXRlZCB3aXRoIFRoZSBHSU1Q72QlbgAAAdpJREFUKM9tkL+L2nAARz9fPZNCKFapUn8kyI0e4iRHSR1Kb8ng0lJw6FYHFwv2LwhOpcWxTjeUunYqOmqd6hEoRDhtDWdA8ApRYsSUCDHNt5ul13vz4w0vWCgUnnEc975arX6ORqN3VqtVZbfbTQC4uEHANM3jSqXymFI6yWazP2KxWAXAL9zCUa1Wy2tXVxheKA9YNoR8Pt+aTqe4FVVVvz05O6MBhqUIBGk8Hn8HAOVy+T+XLJfLS4ZhTiRJgqIoVBRFIoric47jPnmeB1mW/9rr9ZpSSn3Lsmir1fJZlqWlUonKsvwWwD8ymc/nXwVBeLjf7xEKhdBut9Hr9WgmkyGEkJwsy5eHG5vN5g0AKIoCAEgkEkin0wQAfN9/cXPdheu6P33fBwB4ngcAcByHJpPJl+fn54mD3Gg0NrquXxeLRQAAwzAYj8cwTZPwPH9/sVg8PXweDAauqqr2cDjEer1GJBLBZDJBs9mE4zjwfZ85lAGg2+06hmGgXq+j3+/DsixYlgVN03a9Xu8jgCNCyIegIAgx13Vfd7vdu+FweG8YRkjXdWy329+dTgeSJD3ieZ7RNO0VAXAPwDEAO5VKndi2fWrb9jWl9Esul6PZbDY9Go1OZ7PZ9z/lyuD3OozU2wAAAABJRU5ErkJggg==" alt="Mascot Sammy"></a>
</div></footer>
</div>

    <script>
      var canMathML = typeof(MathMLElement) == "function";
      if (!canMathML) {
        var body = document.querySelector("body");
        body.firstElementChild.setAttribute('style', 'opacity: 0;');
        var loading = document.createElement("div");
        loading.setAttribute("id", "mathjax-loading-spinner");
        var message = document.createElement("div");
        message.setAttribute("id", "mathjax-loading-message");
        message.innerText = "Typesetting Equations...";
        body.prepend(loading);
        body.prepend(message);

        var el = document.createElement("script");
        el.src = "https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js";
        document.querySelector("head").appendChild(el);

        window.MathJax = {
          startup: {
            pageReady: () => {
              return MathJax.startup.defaultPageReady().then(() => {
                body.removeChild(loading);
                body.removeChild(message);
                body.firstElementChild.removeAttribute('style');
              }); } } };
      }
    </script>
    <script>
    // Auxiliary function, building the preview feature when
    // an inline citation is clicked
    function clicked_cite(e) {
      e.preventDefault();
      let cite = this.closest('.ltx_cite');
      let next = cite.nextSibling;
      if (next && next.nodeType == Node.ELEMENT_NODE && next.getAttribute('class') == "ar5iv-bibitem-preview") {
        next.remove();
        return; }
      // Before adding a preview modal,
      // cleanup older previews, in case they're still open
      document.querySelectorAll('span.ar5iv-bibitem-preview').forEach(function(node) {
        node.remove();
      })

      // Create the preview
      preview = document.createElement('span');
      preview.setAttribute('class','ar5iv-bibitem-preview');
      let target = document.getElementById(this.getAttribute('href').slice(1));
      target.childNodes.forEach(function (child) {
        preview.append(child.cloneNode(true));
      });
      let close_x = document.createElement('button');
      close_x.setAttribute("aria-label","Close modal for bibliography item preview");
      close_x.textContent = "×";
      close_x.setAttribute('class', 'ar5iv-button-close-preview');
      close_x.setAttribute('onclick','this.parentNode.remove()');
      preview.append(close_x);
      preview.querySelectorAll('.ltx_tag_bibitem').forEach(function(node) {
        node.remove();
      });
      cite.parentNode.insertBefore(preview, cite.nextSibling);
      return;
    }
    // Global Document initialization:
    // - assign the preview feature to all inline citation links
    document.querySelectorAll(".ltx_cite .ltx_ref").forEach(function (link) {
      link.addEventListener("click", clicked_cite);
    });
    </script>
    </body>
</html>
