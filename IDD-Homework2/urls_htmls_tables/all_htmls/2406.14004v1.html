<!DOCTYPE html>
<html lang="en">
<head>
<meta content="text/html; charset=utf-8" http-equiv="content-type"/>
<title>A re-ranking model with pre-feedback learning at serving time in e-commerce</title>
<!--Generated on Thu Jun 20 05:15:03 2024 by LaTeXML (version 0.8.8) http://dlmf.nist.gov/LaTeXML/.-->
<meta content="width=device-width, initial-scale=1, shrink-to-fit=no" name="viewport"/>
<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet" type="text/css"/>
<link href="/static/browse/0.3.4/css/ar5iv.0.7.9.min.css" rel="stylesheet" type="text/css"/>
<link href="/static/browse/0.3.4/css/ar5iv-fonts.0.7.9.min.css" rel="stylesheet" type="text/css"/>
<link href="/static/browse/0.3.4/css/latexml_styles.css" rel="stylesheet" type="text/css"/>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.3.3/html2canvas.min.js"></script>
<script src="/static/browse/0.3.4/js/addons_new.js"></script>
<script src="/static/browse/0.3.4/js/feedbackOverlay.js"></script>
<meta content="online learning,  re-ranking,  surrogate model,  recommender system,  e-commerce" lang="en" name="keywords"/>
<base href="/html/2406.14004v1/"/></head>
<body>
<nav class="ltx_page_navbar">
<nav class="ltx_TOC">
<ol class="ltx_toclist">
<li class="ltx_tocentry ltx_tocentry_section"><a class="ltx_ref" href="https://arxiv.org/html/2406.14004v1#S1" title="In A re-ranking model with pre-feedback learning at serving time in e-commerce"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">1 </span>Introduction</span></a></li>
<li class="ltx_tocentry ltx_tocentry_section"><a class="ltx_ref" href="https://arxiv.org/html/2406.14004v1#S2" title="In A re-ranking model with pre-feedback learning at serving time in e-commerce"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">2 </span>Preliminary</span></a></li>
<li class="ltx_tocentry ltx_tocentry_section"><a class="ltx_ref" href="https://arxiv.org/html/2406.14004v1#S3" title="In A re-ranking model with pre-feedback learning at serving time in e-commerce"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3 </span>LAST: The Proposed Method</span></a></li>
<li class="ltx_tocentry ltx_tocentry_section">
<a class="ltx_ref" href="https://arxiv.org/html/2406.14004v1#S4" title="In A re-ranking model with pre-feedback learning at serving time in e-commerce"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">4 </span>Experiments</span></a>
<ol class="ltx_toclist ltx_toclist_section">
<li class="ltx_tocentry ltx_tocentry_subsection">
<a class="ltx_ref" href="https://arxiv.org/html/2406.14004v1#S4.SS1" title="In 4. Experiments ‣ A re-ranking model with pre-feedback learning at serving time in e-commerce"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">4.1 </span>Offline Experiments</span></a>
<ol class="ltx_toclist ltx_toclist_subsection">
<li class="ltx_tocentry ltx_tocentry_subsubsection"><a class="ltx_ref" href="https://arxiv.org/html/2406.14004v1#S4.SS1.SSS1" title="In 4.1. Offline Experiments ‣ 4. Experiments ‣ A re-ranking model with pre-feedback learning at serving time in e-commerce"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">4.1.1 </span>Performance Analysis</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsubsection"><a class="ltx_ref" href="https://arxiv.org/html/2406.14004v1#S4.SS1.SSS2" title="In 4.1. Offline Experiments ‣ 4. Experiments ‣ A re-ranking model with pre-feedback learning at serving time in e-commerce"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">4.1.2 </span>Hyper-parameters Analysis</span></a></li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2406.14004v1#S4.SS2" title="In 4. Experiments ‣ A re-ranking model with pre-feedback learning at serving time in e-commerce"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">4.2 </span>Online Experiments</span></a></li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_section"><a class="ltx_ref" href="https://arxiv.org/html/2406.14004v1#S5" title="In A re-ranking model with pre-feedback learning at serving time in e-commerce"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">5 </span>Conclusion</span></a></li>
<li class="ltx_tocentry ltx_tocentry_section">
<a class="ltx_ref" href="https://arxiv.org/html/2406.14004v1#S6" title="In A re-ranking model with pre-feedback learning at serving time in e-commerce"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">6 </span>Auxiliary Material</span></a>
<ol class="ltx_toclist ltx_toclist_section">
<li class="ltx_tocentry ltx_tocentry_subsection">
<a class="ltx_ref" href="https://arxiv.org/html/2406.14004v1#S6.SS1" title="In 6. Auxiliary Material ‣ A re-ranking model with pre-feedback learning at serving time in e-commerce"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">6.1 </span>Offline Experiment Setup</span></a>
<ol class="ltx_toclist ltx_toclist_subsection">
<li class="ltx_tocentry ltx_tocentry_subsubsection"><a class="ltx_ref" href="https://arxiv.org/html/2406.14004v1#S6.SS1.SSS1" title="In 6.1. Offline Experiment Setup ‣ 6. Auxiliary Material ‣ A re-ranking model with pre-feedback learning at serving time in e-commerce"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">6.1.1 </span>Offline Experiment 1</span></a></li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2406.14004v1#S6.SS2" title="In 6. Auxiliary Material ‣ A re-ranking model with pre-feedback learning at serving time in e-commerce"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">6.2 </span>Online Experiment Setup</span></a></li>
</ol>
</li>
</ol></nav>
</nav>
<div class="ltx_page_main">
<div class="ltx_page_content">
<article class="ltx_document ltx_authors_1line ltx_leqno">
<h1 class="ltx_title ltx_title_document">A re-ranking model with pre-feedback learning at serving time in e-commerce</h1>
<div class="ltx_authors">
<span class="ltx_creator ltx_role_author">
<span class="ltx_personname">Yuan Wang
</span><span class="ltx_author_notes">
<span class="ltx_contact ltx_role_email"><a href="mailto:wy175696@alibaba-inc.com">wy175696@alibaba-inc.com</a>
</span></span></span>
<span class="ltx_author_before">, </span><span class="ltx_creator ltx_role_author">
<span class="ltx_personname">Zhiyu Li
</span><span class="ltx_author_notes">
<span class="ltx_contact ltx_role_email"><a href="mailto:tuanyu.lzy@alibaba-inc.com">tuanyu.lzy@alibaba-inc.com</a>
</span>
<span class="ltx_contact ltx_role_affiliation"><span class="ltx_text ltx_affiliation_institution" id="id1.1.id1">Alibaba Group</span><span class="ltx_text ltx_affiliation_city" id="id2.2.id2">Hangzhou</span><span class="ltx_text ltx_affiliation_state" id="id3.3.id3">Zhejiang</span><span class="ltx_text ltx_affiliation_country" id="id4.4.id4">China</span>
</span></span></span>
<span class="ltx_author_before">, </span><span class="ltx_creator ltx_role_author">
<span class="ltx_personname">Changshuo Zhang
</span><span class="ltx_author_notes">
<span class="ltx_contact ltx_role_affiliation"><span class="ltx_text ltx_affiliation_institution" id="id5.1.id1">Gaoling School of Artificial Intelligence, Renmin University of China</span><span class="ltx_text ltx_affiliation_city" id="id6.2.id2">Beijing</span><span class="ltx_text ltx_affiliation_country" id="id7.3.id3">China</span>
</span>
<span class="ltx_contact ltx_role_email"><a href="mailto:lyingcs@ruc.edu.cn">lyingcs@ruc.edu.cn</a>
</span></span></span>
<span class="ltx_author_before">, </span><span class="ltx_creator ltx_role_author">
<span class="ltx_personname">Sirui Chen
</span><span class="ltx_author_notes">
<span class="ltx_contact ltx_role_affiliation"><span class="ltx_text ltx_affiliation_institution" id="id8.1.id1">School of Information, Renmin University of China</span><span class="ltx_text ltx_affiliation_city" id="id9.2.id2">Beijing</span><span class="ltx_text ltx_affiliation_country" id="id10.3.id3">China</span>
</span>
<span class="ltx_contact ltx_role_email"><a href="mailto:chensr16@gmail.com">chensr16@gmail.com</a>
</span></span></span>
<span class="ltx_author_before">, </span><span class="ltx_creator ltx_role_author">
<span class="ltx_personname">Xiao Zhang
</span><span class="ltx_author_notes">
<span class="ltx_contact ltx_role_affiliation"><span class="ltx_text ltx_affiliation_institution" id="id11.1.id1">Gaoling School of Artificial Intelligence, Renmin University of China</span><span class="ltx_text ltx_affiliation_city" id="id12.2.id2">Beijing</span><span class="ltx_text ltx_affiliation_country" id="id13.3.id3">China</span>
</span>
<span class="ltx_contact ltx_role_email"><a href="mailto:zhangx89@ruc.edu.cn">zhangx89@ruc.edu.cn</a>
</span></span></span>
<span class="ltx_author_before">, </span><span class="ltx_creator ltx_role_author">
<span class="ltx_personname">Jun Xu
</span><span class="ltx_author_notes">
<span class="ltx_contact ltx_role_affiliation"><span class="ltx_text ltx_affiliation_institution" id="id14.1.id1">Gaoling School of Artificial Intelligence, Renmin University of China</span><span class="ltx_text ltx_affiliation_city" id="id15.2.id2">Beijing</span><span class="ltx_text ltx_affiliation_country" id="id16.3.id3">China</span>
</span>
<span class="ltx_contact ltx_role_email"><a href="mailto:junxu@ruc.edu.cn">junxu@ruc.edu.cn</a>
</span></span></span>
<span class="ltx_author_before"> and </span><span class="ltx_creator ltx_role_author">
<span class="ltx_personname">Quan Lin
</span><span class="ltx_author_notes">
<span class="ltx_contact ltx_role_affiliation"><span class="ltx_text ltx_affiliation_institution" id="id17.1.id1">Alibaba Group</span><span class="ltx_text ltx_affiliation_city" id="id18.2.id2">Hangzhou</span><span class="ltx_text ltx_affiliation_state" id="id19.3.id3">Zhejiang</span><span class="ltx_text ltx_affiliation_country" id="id20.4.id4">China</span>
</span>
<span class="ltx_contact ltx_role_email"><a href="mailto:tieyi.lq@alibaba-inc.com">tieyi.lq@alibaba-inc.com</a>
</span></span></span>
</div>
<div class="ltx_dates">(2018)</div>
<h1 class="ltx_title ltx_title_document">Do Not Wait: Learning Re-Ranking Model Without User Feedback At Serving Time in E-Commerce</h1>
<div class="ltx_authors">
<span class="ltx_creator ltx_role_author">
<span class="ltx_personname">Yuan Wang
</span><span class="ltx_author_notes">
<span class="ltx_contact ltx_role_email"><a href="mailto:wy175696@alibaba-inc.com">wy175696@alibaba-inc.com</a>
</span></span></span>
<span class="ltx_author_before">, </span><span class="ltx_creator ltx_role_author">
<span class="ltx_personname">Zhiyu Li
</span><span class="ltx_author_notes">
<span class="ltx_contact ltx_role_email"><a href="mailto:tuanyu.lzy@alibaba-inc.com">tuanyu.lzy@alibaba-inc.com</a>
</span>
<span class="ltx_contact ltx_role_affiliation"><span class="ltx_text ltx_affiliation_institution" id="id1.1.id1">Alibaba Group</span><span class="ltx_text ltx_affiliation_city" id="id2.2.id2">Hangzhou</span><span class="ltx_text ltx_affiliation_state" id="id3.3.id3">Zhejiang</span><span class="ltx_text ltx_affiliation_country" id="id4.4.id4">China</span>
</span></span></span>
<span class="ltx_author_before">, </span><span class="ltx_creator ltx_role_author">
<span class="ltx_personname">Changshuo Zhang
</span><span class="ltx_author_notes">
<span class="ltx_contact ltx_role_affiliation"><span class="ltx_text ltx_affiliation_institution" id="id5.1.id1">Gaoling School of Artificial Intelligence, Renmin University of China</span><span class="ltx_text ltx_affiliation_city" id="id6.2.id2">Beijing</span><span class="ltx_text ltx_affiliation_country" id="id7.3.id3">China</span>
</span>
<span class="ltx_contact ltx_role_email"><a href="mailto:lyingcs@ruc.edu.cn">lyingcs@ruc.edu.cn</a>
</span></span></span>
<span class="ltx_author_before">, </span><span class="ltx_creator ltx_role_author">
<span class="ltx_personname">Sirui Chen
</span><span class="ltx_author_notes">
<span class="ltx_contact ltx_role_affiliation"><span class="ltx_text ltx_affiliation_institution" id="id8.1.id1">School of Information, Renmin University of China</span><span class="ltx_text ltx_affiliation_city" id="id9.2.id2">Beijing</span><span class="ltx_text ltx_affiliation_country" id="id10.3.id3">China</span>
</span>
<span class="ltx_contact ltx_role_email"><a href="mailto:chensr16@gmail.com">chensr16@gmail.com</a>
</span></span></span>
<span class="ltx_author_before">, </span><span class="ltx_creator ltx_role_author">
<span class="ltx_personname">Xiao Zhang
</span><span class="ltx_author_notes">
<span class="ltx_contact ltx_role_affiliation"><span class="ltx_text ltx_affiliation_institution" id="id11.1.id1">Gaoling School of Artificial Intelligence, Renmin University of China</span><span class="ltx_text ltx_affiliation_city" id="id12.2.id2">Beijing</span><span class="ltx_text ltx_affiliation_country" id="id13.3.id3">China</span>
</span>
<span class="ltx_contact ltx_role_email"><a href="mailto:zhangx89@ruc.edu.cn">zhangx89@ruc.edu.cn</a>
</span></span></span>
<span class="ltx_author_before">, </span><span class="ltx_creator ltx_role_author">
<span class="ltx_personname">Jun Xu
</span><span class="ltx_author_notes">
<span class="ltx_contact ltx_role_affiliation"><span class="ltx_text ltx_affiliation_institution" id="id14.1.id1">Gaoling School of Artificial Intelligence, Renmin University of China</span><span class="ltx_text ltx_affiliation_city" id="id15.2.id2">Beijing</span><span class="ltx_text ltx_affiliation_country" id="id16.3.id3">China</span>
</span>
<span class="ltx_contact ltx_role_email"><a href="mailto:junxu@ruc.edu.cn">junxu@ruc.edu.cn</a>
</span></span></span>
<span class="ltx_author_before"> and </span><span class="ltx_creator ltx_role_author">
<span class="ltx_personname">Quan Lin
</span><span class="ltx_author_notes">
<span class="ltx_contact ltx_role_affiliation"><span class="ltx_text ltx_affiliation_institution" id="id17.1.id1">Alibaba Group</span><span class="ltx_text ltx_affiliation_city" id="id18.2.id2">Hangzhou</span><span class="ltx_text ltx_affiliation_state" id="id19.3.id3">Zhejiang</span><span class="ltx_text ltx_affiliation_country" id="id20.4.id4">China</span>
</span>
<span class="ltx_contact ltx_role_email"><a href="mailto:tieyi.lq@alibaba-inc.com">tieyi.lq@alibaba-inc.com</a>
</span></span></span>
</div>
<div class="ltx_dates">(2018)</div>
<div class="ltx_abstract">
<h6 class="ltx_title ltx_title_abstract">Abstract.</h6>
<p class="ltx_p" id="id21.id1">Recommender systems have been widely used in e-commerce, and re-ranking models are playing an increasingly significant role in the domain, which leverages the inter-item influence and determines the final recommendation lists. Online learning methods keep updating a deployed model with the latest available samples to capture the shifting of the underlying data distribution in e-commerce. However, they depend on the availability of real user feedback, which may be delayed by hours or even days, such as item purchases, leading to a lag in model enhancement.
In this paper, we propose a novel extension of online learning methods for re-ranking modeling, which we term LAST, an acronym for Learning At Serving Time. It circumvents the requirement of user feedback by using a surrogate model to provide the instructional signal needed to steer model improvement. Upon receiving an online request, LAST finds and applies a model modification on the fly before generating a recommendation result for the request. The modification is request-specific and transient. It means the modification is tailored to and only to the current request to capture the specific context of the request. After a request, the modification is discarded, which helps to prevent error propagation and stabilizes the online learning procedure since the predictions of the surrogate model may be inaccurate. Most importantly, as a complement to feedback-based online learning methods, LAST can be seamlessly integrated into existing online learning systems to create a more adaptive and responsive recommendation experience. Comprehensive experiments, both offline and online, affirm that LAST outperforms state-of-the-art re-ranking models.</p>
</div>
<div class="ltx_keywords">online learning, re-ranking, surrogate model, recommender system, e-commerce
</div>
<span class="ltx_note ltx_note_frontmatter ltx_role_copyright" id="id1"><sup class="ltx_note_mark">†</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">†</sup><span class="ltx_note_type">copyright: </span>acmlicensed</span></span></span><span class="ltx_note ltx_note_frontmatter ltx_role_journalyear" id="id2"><sup class="ltx_note_mark">†</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">†</sup><span class="ltx_note_type">journalyear: </span>2018</span></span></span><span class="ltx_note ltx_note_frontmatter ltx_role_doi" id="id3"><sup class="ltx_note_mark">†</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">†</sup><span class="ltx_note_type">doi: </span>XXXXXXX.XXXXXXX</span></span></span><span class="ltx_note ltx_note_frontmatter ltx_role_conference" id="id4"><sup class="ltx_note_mark">†</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">†</sup><span class="ltx_note_type">conference: </span>Make sure to enter the correct
conference title from your rights confirmation emai; June 03–05,
2018; Woodstock, NY</span></span></span><span class="ltx_note ltx_note_frontmatter ltx_role_isbn" id="id5"><sup class="ltx_note_mark">†</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">†</sup><span class="ltx_note_type">isbn: </span>978-1-4503-XXXX-X/18/06</span></span></span><span class="ltx_note ltx_note_frontmatter ltx_role_ccs" id="id6"><sup class="ltx_note_mark">†</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">†</sup><span class="ltx_note_type">ccs: </span>Theory of computation Online algorithms</span></span></span><span class="ltx_note ltx_note_frontmatter ltx_role_ccs" id="id7"><sup class="ltx_note_mark">†</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">†</sup><span class="ltx_note_type">ccs: </span>Computing methodologies Learning paradigms</span></span></span><span class="ltx_note ltx_note_frontmatter ltx_role_ccs" id="id8"><sup class="ltx_note_mark">†</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">†</sup><span class="ltx_note_type">ccs: </span>Applied computing Online shopping</span></span></span>
<section class="ltx_section" id="S1">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">1. </span>Introduction</h2>
<div class="ltx_para" id="S1.p1">
<p class="ltx_p" id="S1.p1.1">Machine learning-based and deep learning-based recommendation models have become an integral part of e-commerce platforms, such as Taobao and Amazon. Re-ranking models <cite class="ltx_cite ltx_citemacro_citep">(Zhuang et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2406.14004v1#bib.bib26" title="">2018</a>; Pei et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2406.14004v1#bib.bib17" title="">2019</a>; Ai et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2406.14004v1#bib.bib2" title="">2018</a>, <a class="ltx_ref" href="https://arxiv.org/html/2406.14004v1#bib.bib3" title="">2019</a>; Bello et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2406.14004v1#bib.bib4" title="">2018</a>)</cite> typically reside in the last stage of an industrial recommendation pipeline and directly determine the final recommendation lists. They explicitly consider the mutual influence between items and explore all permutations of candidates, which makes it challenging to train a re-ranking model. Reinforcement Learning (RL) <cite class="ltx_cite ltx_citemacro_citep">(Kaelbling et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2406.14004v1#bib.bib10" title="">1996</a>; Li, <a class="ltx_ref" href="https://arxiv.org/html/2406.14004v1#bib.bib13" title="">2017</a>; Wiering and Van Otterlo, <a class="ltx_ref" href="https://arxiv.org/html/2406.14004v1#bib.bib21" title="">2012</a>)</cite> searching algorithms and an Actor-Evaluator (AE) framework <cite class="ltx_cite ltx_citemacro_citep">(Gong et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2406.14004v1#bib.bib6" title="">2019</a>; Huzhang et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2406.14004v1#bib.bib8" title="">2021</a>; Wang et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2406.14004v1#bib.bib20" title="">2019</a>)</cite> have been proposed to automatically find the best recommendation list-generating policy, removing the burden of manually specifying the best recommendation list as the label in Supervised Learning (SL). After the deployment of a re-ranking model, online learning methods <cite class="ltx_cite ltx_citemacro_citep">(Sahoo et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2406.14004v1#bib.bib18" title="">2018</a>; Hazan, <a class="ltx_ref" href="https://arxiv.org/html/2406.14004v1#bib.bib7" title="">2016</a>; Zhang et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2406.14004v1#bib.bib24" title="">2019</a>)</cite> can be applied to continuously update the deployed model using the latest available samples so that the model can capture real-time changes in the data distribution. As shown in Fig. <a class="ltx_ref" href="https://arxiv.org/html/2406.14004v1#S1.F1" title="Figure 1 ‣ 1. Introduction ‣ A re-ranking model with pre-feedback learning at serving time in e-commerce"><span class="ltx_text ltx_ref_tag">1</span></a> on the left-hand side, these updates are directly integrated into the deployed model, accumulating over time and shaping all subsequent predictions. One fundamental limitation of these methods is that they depend on the availability of real user feedback, which, akin to product purchases in e-commerce, may come several hours or even days later and ultimately constrains the temporal effectiveness of the model. Moreover, at any given moment, all requests are served with a fixed model instance, lacking contextual adaptations. In a large e-commerce platform, a recommender system may receive tens of thousands of requests within a second. These requests have their own context, reflecting diverse user preferences. A single model may not be able to capture all the variety.</p>
</div>
<div class="ltx_para" id="S1.p2">
<p class="ltx_p" id="S1.p2.1">In this paper, we propose LAST, an acronym for Learning At Serving Time. It ensures continuous model optimization and fine-grained model adaptation even in situations where feedback is unattainable, as illustrated on the right-hand side in Fig. <a class="ltx_ref" href="https://arxiv.org/html/2406.14004v1#S1.F1" title="Figure 1 ‣ 1. Introduction ‣ A re-ranking model with pre-feedback learning at serving time in e-commerce"><span class="ltx_text ltx_ref_tag">1</span></a>. It uses a surrogate evaluation model as the instructional signal to steer model refinement to ensure model freshness. LAST generates transient, contextually tailored model adjustments for each request, meticulously engineered to optimize the recommendation efficacy of each request. After each recommendation, the according modification is discarded, leaving no residual influence on the deployed model. This design helps to prevent error propagation and stabilize the online learning procedure since the predictions of the surrogate model may be inaccurate. It is also more friendly to the online engineering system, as the modification functionality can be implemented as a normal model module, requiring no upgrading of the online engineering system, with or without the support of classic online learning. Most importantly, this design ensures seamless integration of LAST with existing feedback-based online learning methods. Comprehensive experiments, both offline and online, affirm that LAST outperforms state-of-the-art re-ranking models.</p>
</div>
<div class="ltx_para" id="S1.p3">
<p class="ltx_p" id="S1.p3.1">The main contributions of the paper are:
<br class="ltx_break"/><span class="ltx_text ltx_font_bold" id="S1.p3.1.1">(1) A new re-ranking model with unique online learning ability.</span> LAST boosts recommendation quality by feedback-independent, transient, request-specific, engineering-friendly online model modifications. It addresses the inherent temporal and adaptation limitations of conventional online learning methods and can be combined with them to enhance user satisfaction and system outcomes. 
<br class="ltx_break"/><span class="ltx_text ltx_font_bold" id="S1.p3.1.2">(2) Comprehensive evaluations of the new proposal.</span> We demonstrate the effectiveness of LAST offline with publicly available data and online in an industrial environment. We have released the experimental code to increase reproducibility.</p>
</div>
<figure class="ltx_figure" id="S1.F1"><img alt="Refer to caption" class="ltx_graphics ltx_img_square" height="222" id="S1.F1.g1" src="extracted/5679954/online_models_v3.png" width="210"/>
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure"><span class="ltx_text" id="S1.F1.4.2.1" style="font-size:90%;">Figure 1</span>. </span><span class="ltx_text" id="S1.F1.2.1" style="font-size:90%;">Classic online learning methods and our new proposal, LAST. <math alttext="\boldsymbol{\theta}" class="ltx_Math" display="inline" id="S1.F1.2.1.m1.1"><semantics id="S1.F1.2.1.m1.1b"><mi id="S1.F1.2.1.m1.1.1" xref="S1.F1.2.1.m1.1.1.cmml">𝜽</mi><annotation-xml encoding="MathML-Content" id="S1.F1.2.1.m1.1c"><ci id="S1.F1.2.1.m1.1.1.cmml" xref="S1.F1.2.1.m1.1.1">𝜽</ci></annotation-xml><annotation encoding="application/x-tex" id="S1.F1.2.1.m1.1d">\boldsymbol{\theta}</annotation><annotation encoding="application/x-llamapun" id="S1.F1.2.1.m1.1e">bold_italic_θ</annotation></semantics></math> means the parameter of a model. The classic methods rely on authentic user feedback, providing enduring non-request-specific updates. LAST provides transient request-specific updates with the help of a surrogate evaluation model. The two can work synergistically to create a more adaptive and responsive online serving system.
</span></figcaption>
</figure>
</section>
<section class="ltx_section" id="S2">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">2. </span>Preliminary</h2>
<div class="ltx_para" id="S2.p1">
<p class="ltx_p" id="S2.p1.6">In this section, we formally introduce the problem definition of re-ranking modeling and the AE framework. Given a set of <math alttext="M" class="ltx_Math" display="inline" id="S2.p1.1.m1.1"><semantics id="S2.p1.1.m1.1a"><mi id="S2.p1.1.m1.1.1" xref="S2.p1.1.m1.1.1.cmml">M</mi><annotation-xml encoding="MathML-Content" id="S2.p1.1.m1.1b"><ci id="S2.p1.1.m1.1.1.cmml" xref="S2.p1.1.m1.1.1">𝑀</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.p1.1.m1.1c">M</annotation><annotation encoding="application/x-llamapun" id="S2.p1.1.m1.1d">italic_M</annotation></semantics></math> candidate items <math alttext="\mathcal{C}=\{c_{i}\}_{1\leq i\leq M}" class="ltx_Math" display="inline" id="S2.p1.2.m2.1"><semantics id="S2.p1.2.m2.1a"><mrow id="S2.p1.2.m2.1.1" xref="S2.p1.2.m2.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S2.p1.2.m2.1.1.3" xref="S2.p1.2.m2.1.1.3.cmml">𝒞</mi><mo id="S2.p1.2.m2.1.1.2" xref="S2.p1.2.m2.1.1.2.cmml">=</mo><msub id="S2.p1.2.m2.1.1.1" xref="S2.p1.2.m2.1.1.1.cmml"><mrow id="S2.p1.2.m2.1.1.1.1.1" xref="S2.p1.2.m2.1.1.1.1.2.cmml"><mo id="S2.p1.2.m2.1.1.1.1.1.2" stretchy="false" xref="S2.p1.2.m2.1.1.1.1.2.cmml">{</mo><msub id="S2.p1.2.m2.1.1.1.1.1.1" xref="S2.p1.2.m2.1.1.1.1.1.1.cmml"><mi id="S2.p1.2.m2.1.1.1.1.1.1.2" xref="S2.p1.2.m2.1.1.1.1.1.1.2.cmml">c</mi><mi id="S2.p1.2.m2.1.1.1.1.1.1.3" xref="S2.p1.2.m2.1.1.1.1.1.1.3.cmml">i</mi></msub><mo id="S2.p1.2.m2.1.1.1.1.1.3" stretchy="false" xref="S2.p1.2.m2.1.1.1.1.2.cmml">}</mo></mrow><mrow id="S2.p1.2.m2.1.1.1.3" xref="S2.p1.2.m2.1.1.1.3.cmml"><mn id="S2.p1.2.m2.1.1.1.3.2" xref="S2.p1.2.m2.1.1.1.3.2.cmml">1</mn><mo id="S2.p1.2.m2.1.1.1.3.3" xref="S2.p1.2.m2.1.1.1.3.3.cmml">≤</mo><mi id="S2.p1.2.m2.1.1.1.3.4" xref="S2.p1.2.m2.1.1.1.3.4.cmml">i</mi><mo id="S2.p1.2.m2.1.1.1.3.5" xref="S2.p1.2.m2.1.1.1.3.5.cmml">≤</mo><mi id="S2.p1.2.m2.1.1.1.3.6" xref="S2.p1.2.m2.1.1.1.3.6.cmml">M</mi></mrow></msub></mrow><annotation-xml encoding="MathML-Content" id="S2.p1.2.m2.1b"><apply id="S2.p1.2.m2.1.1.cmml" xref="S2.p1.2.m2.1.1"><eq id="S2.p1.2.m2.1.1.2.cmml" xref="S2.p1.2.m2.1.1.2"></eq><ci id="S2.p1.2.m2.1.1.3.cmml" xref="S2.p1.2.m2.1.1.3">𝒞</ci><apply id="S2.p1.2.m2.1.1.1.cmml" xref="S2.p1.2.m2.1.1.1"><csymbol cd="ambiguous" id="S2.p1.2.m2.1.1.1.2.cmml" xref="S2.p1.2.m2.1.1.1">subscript</csymbol><set id="S2.p1.2.m2.1.1.1.1.2.cmml" xref="S2.p1.2.m2.1.1.1.1.1"><apply id="S2.p1.2.m2.1.1.1.1.1.1.cmml" xref="S2.p1.2.m2.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S2.p1.2.m2.1.1.1.1.1.1.1.cmml" xref="S2.p1.2.m2.1.1.1.1.1.1">subscript</csymbol><ci id="S2.p1.2.m2.1.1.1.1.1.1.2.cmml" xref="S2.p1.2.m2.1.1.1.1.1.1.2">𝑐</ci><ci id="S2.p1.2.m2.1.1.1.1.1.1.3.cmml" xref="S2.p1.2.m2.1.1.1.1.1.1.3">𝑖</ci></apply></set><apply id="S2.p1.2.m2.1.1.1.3.cmml" xref="S2.p1.2.m2.1.1.1.3"><and id="S2.p1.2.m2.1.1.1.3a.cmml" xref="S2.p1.2.m2.1.1.1.3"></and><apply id="S2.p1.2.m2.1.1.1.3b.cmml" xref="S2.p1.2.m2.1.1.1.3"><leq id="S2.p1.2.m2.1.1.1.3.3.cmml" xref="S2.p1.2.m2.1.1.1.3.3"></leq><cn id="S2.p1.2.m2.1.1.1.3.2.cmml" type="integer" xref="S2.p1.2.m2.1.1.1.3.2">1</cn><ci id="S2.p1.2.m2.1.1.1.3.4.cmml" xref="S2.p1.2.m2.1.1.1.3.4">𝑖</ci></apply><apply id="S2.p1.2.m2.1.1.1.3c.cmml" xref="S2.p1.2.m2.1.1.1.3"><leq id="S2.p1.2.m2.1.1.1.3.5.cmml" xref="S2.p1.2.m2.1.1.1.3.5"></leq><share href="https://arxiv.org/html/2406.14004v1#S2.p1.2.m2.1.1.1.3.4.cmml" id="S2.p1.2.m2.1.1.1.3d.cmml" xref="S2.p1.2.m2.1.1.1.3"></share><ci id="S2.p1.2.m2.1.1.1.3.6.cmml" xref="S2.p1.2.m2.1.1.1.3.6">𝑀</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.p1.2.m2.1c">\mathcal{C}=\{c_{i}\}_{1\leq i\leq M}</annotation><annotation encoding="application/x-llamapun" id="S2.p1.2.m2.1d">caligraphic_C = { italic_c start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT } start_POSTSUBSCRIPT 1 ≤ italic_i ≤ italic_M end_POSTSUBSCRIPT</annotation></semantics></math>, a user <math alttext="u\in\mathcal{U}" class="ltx_Math" display="inline" id="S2.p1.3.m3.1"><semantics id="S2.p1.3.m3.1a"><mrow id="S2.p1.3.m3.1.1" xref="S2.p1.3.m3.1.1.cmml"><mi id="S2.p1.3.m3.1.1.2" xref="S2.p1.3.m3.1.1.2.cmml">u</mi><mo id="S2.p1.3.m3.1.1.1" xref="S2.p1.3.m3.1.1.1.cmml">∈</mo><mi class="ltx_font_mathcaligraphic" id="S2.p1.3.m3.1.1.3" xref="S2.p1.3.m3.1.1.3.cmml">𝒰</mi></mrow><annotation-xml encoding="MathML-Content" id="S2.p1.3.m3.1b"><apply id="S2.p1.3.m3.1.1.cmml" xref="S2.p1.3.m3.1.1"><in id="S2.p1.3.m3.1.1.1.cmml" xref="S2.p1.3.m3.1.1.1"></in><ci id="S2.p1.3.m3.1.1.2.cmml" xref="S2.p1.3.m3.1.1.2">𝑢</ci><ci id="S2.p1.3.m3.1.1.3.cmml" xref="S2.p1.3.m3.1.1.3">𝒰</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.p1.3.m3.1c">u\in\mathcal{U}</annotation><annotation encoding="application/x-llamapun" id="S2.p1.3.m3.1d">italic_u ∈ caligraphic_U</annotation></semantics></math>, and a list reward function <math alttext="R(\cdot)" class="ltx_Math" display="inline" id="S2.p1.4.m4.1"><semantics id="S2.p1.4.m4.1a"><mrow id="S2.p1.4.m4.1.2" xref="S2.p1.4.m4.1.2.cmml"><mi id="S2.p1.4.m4.1.2.2" xref="S2.p1.4.m4.1.2.2.cmml">R</mi><mo id="S2.p1.4.m4.1.2.1" xref="S2.p1.4.m4.1.2.1.cmml">⁢</mo><mrow id="S2.p1.4.m4.1.2.3.2" xref="S2.p1.4.m4.1.2.cmml"><mo id="S2.p1.4.m4.1.2.3.2.1" stretchy="false" xref="S2.p1.4.m4.1.2.cmml">(</mo><mo id="S2.p1.4.m4.1.1" lspace="0em" rspace="0em" xref="S2.p1.4.m4.1.1.cmml">⋅</mo><mo id="S2.p1.4.m4.1.2.3.2.2" stretchy="false" xref="S2.p1.4.m4.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.p1.4.m4.1b"><apply id="S2.p1.4.m4.1.2.cmml" xref="S2.p1.4.m4.1.2"><times id="S2.p1.4.m4.1.2.1.cmml" xref="S2.p1.4.m4.1.2.1"></times><ci id="S2.p1.4.m4.1.2.2.cmml" xref="S2.p1.4.m4.1.2.2">𝑅</ci><ci id="S2.p1.4.m4.1.1.cmml" xref="S2.p1.4.m4.1.1">⋅</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.p1.4.m4.1c">R(\cdot)</annotation><annotation encoding="application/x-llamapun" id="S2.p1.4.m4.1d">italic_R ( ⋅ )</annotation></semantics></math>, the goal of a re-ranking model is to find the optimal list <math alttext="L_{\mathcal{C}}^{*}" class="ltx_Math" display="inline" id="S2.p1.5.m5.1"><semantics id="S2.p1.5.m5.1a"><msubsup id="S2.p1.5.m5.1.1" xref="S2.p1.5.m5.1.1.cmml"><mi id="S2.p1.5.m5.1.1.2.2" xref="S2.p1.5.m5.1.1.2.2.cmml">L</mi><mi class="ltx_font_mathcaligraphic" id="S2.p1.5.m5.1.1.2.3" xref="S2.p1.5.m5.1.1.2.3.cmml">𝒞</mi><mo id="S2.p1.5.m5.1.1.3" xref="S2.p1.5.m5.1.1.3.cmml">∗</mo></msubsup><annotation-xml encoding="MathML-Content" id="S2.p1.5.m5.1b"><apply id="S2.p1.5.m5.1.1.cmml" xref="S2.p1.5.m5.1.1"><csymbol cd="ambiguous" id="S2.p1.5.m5.1.1.1.cmml" xref="S2.p1.5.m5.1.1">superscript</csymbol><apply id="S2.p1.5.m5.1.1.2.cmml" xref="S2.p1.5.m5.1.1"><csymbol cd="ambiguous" id="S2.p1.5.m5.1.1.2.1.cmml" xref="S2.p1.5.m5.1.1">subscript</csymbol><ci id="S2.p1.5.m5.1.1.2.2.cmml" xref="S2.p1.5.m5.1.1.2.2">𝐿</ci><ci id="S2.p1.5.m5.1.1.2.3.cmml" xref="S2.p1.5.m5.1.1.2.3">𝒞</ci></apply><times id="S2.p1.5.m5.1.1.3.cmml" xref="S2.p1.5.m5.1.1.3"></times></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.p1.5.m5.1c">L_{\mathcal{C}}^{*}</annotation><annotation encoding="application/x-llamapun" id="S2.p1.5.m5.1d">italic_L start_POSTSUBSCRIPT caligraphic_C end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ∗ end_POSTSUPERSCRIPT</annotation></semantics></math> composed by items in <math alttext="\mathcal{C}" class="ltx_Math" display="inline" id="S2.p1.6.m6.1"><semantics id="S2.p1.6.m6.1a"><mi class="ltx_font_mathcaligraphic" id="S2.p1.6.m6.1.1" xref="S2.p1.6.m6.1.1.cmml">𝒞</mi><annotation-xml encoding="MathML-Content" id="S2.p1.6.m6.1b"><ci id="S2.p1.6.m6.1.1.cmml" xref="S2.p1.6.m6.1.1">𝒞</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.p1.6.m6.1c">\mathcal{C}</annotation><annotation encoding="application/x-llamapun" id="S2.p1.6.m6.1d">caligraphic_C</annotation></semantics></math>:</p>
<table class="ltx_equation ltx_eqn_table" id="S2.Ex1">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="L_{\mathcal{C}}^{*}=\underset{L_{\mathcal{C}}}{\arg\max}~{}R(u,L_{\mathcal{C}}%
,y_{L_{\mathcal{C}}})," class="ltx_Math" display="block" id="S2.Ex1.m1.2"><semantics id="S2.Ex1.m1.2a"><mrow id="S2.Ex1.m1.2.2.1" xref="S2.Ex1.m1.2.2.1.1.cmml"><mrow id="S2.Ex1.m1.2.2.1.1" xref="S2.Ex1.m1.2.2.1.1.cmml"><msubsup id="S2.Ex1.m1.2.2.1.1.4" xref="S2.Ex1.m1.2.2.1.1.4.cmml"><mi id="S2.Ex1.m1.2.2.1.1.4.2.2" xref="S2.Ex1.m1.2.2.1.1.4.2.2.cmml">L</mi><mi class="ltx_font_mathcaligraphic" id="S2.Ex1.m1.2.2.1.1.4.2.3" xref="S2.Ex1.m1.2.2.1.1.4.2.3.cmml">𝒞</mi><mo id="S2.Ex1.m1.2.2.1.1.4.3" xref="S2.Ex1.m1.2.2.1.1.4.3.cmml">∗</mo></msubsup><mo id="S2.Ex1.m1.2.2.1.1.3" xref="S2.Ex1.m1.2.2.1.1.3.cmml">=</mo><mrow id="S2.Ex1.m1.2.2.1.1.2" xref="S2.Ex1.m1.2.2.1.1.2.cmml"><munder accentunder="true" id="S2.Ex1.m1.2.2.1.1.2.4" xref="S2.Ex1.m1.2.2.1.1.2.4.cmml"><mrow id="S2.Ex1.m1.2.2.1.1.2.4.2" xref="S2.Ex1.m1.2.2.1.1.2.4.2.cmml"><mi id="S2.Ex1.m1.2.2.1.1.2.4.2.1" xref="S2.Ex1.m1.2.2.1.1.2.4.2.1.cmml">arg</mi><mo id="S2.Ex1.m1.2.2.1.1.2.4.2a" lspace="0.167em" xref="S2.Ex1.m1.2.2.1.1.2.4.2.cmml">⁡</mo><mi id="S2.Ex1.m1.2.2.1.1.2.4.2.2" xref="S2.Ex1.m1.2.2.1.1.2.4.2.2.cmml">max</mi></mrow><msub id="S2.Ex1.m1.2.2.1.1.2.4.1" xref="S2.Ex1.m1.2.2.1.1.2.4.1.cmml"><mi id="S2.Ex1.m1.2.2.1.1.2.4.1.2" xref="S2.Ex1.m1.2.2.1.1.2.4.1.2.cmml">L</mi><mi class="ltx_font_mathcaligraphic" id="S2.Ex1.m1.2.2.1.1.2.4.1.3" xref="S2.Ex1.m1.2.2.1.1.2.4.1.3.cmml">𝒞</mi></msub></munder><mo id="S2.Ex1.m1.2.2.1.1.2.3" lspace="0.167em" xref="S2.Ex1.m1.2.2.1.1.2.3.cmml">⁢</mo><mi id="S2.Ex1.m1.2.2.1.1.2.5" xref="S2.Ex1.m1.2.2.1.1.2.5.cmml">R</mi><mo id="S2.Ex1.m1.2.2.1.1.2.3a" xref="S2.Ex1.m1.2.2.1.1.2.3.cmml">⁢</mo><mrow id="S2.Ex1.m1.2.2.1.1.2.2.2" xref="S2.Ex1.m1.2.2.1.1.2.2.3.cmml"><mo id="S2.Ex1.m1.2.2.1.1.2.2.2.3" stretchy="false" xref="S2.Ex1.m1.2.2.1.1.2.2.3.cmml">(</mo><mi id="S2.Ex1.m1.1.1" xref="S2.Ex1.m1.1.1.cmml">u</mi><mo id="S2.Ex1.m1.2.2.1.1.2.2.2.4" xref="S2.Ex1.m1.2.2.1.1.2.2.3.cmml">,</mo><msub id="S2.Ex1.m1.2.2.1.1.1.1.1.1" xref="S2.Ex1.m1.2.2.1.1.1.1.1.1.cmml"><mi id="S2.Ex1.m1.2.2.1.1.1.1.1.1.2" xref="S2.Ex1.m1.2.2.1.1.1.1.1.1.2.cmml">L</mi><mi class="ltx_font_mathcaligraphic" id="S2.Ex1.m1.2.2.1.1.1.1.1.1.3" xref="S2.Ex1.m1.2.2.1.1.1.1.1.1.3.cmml">𝒞</mi></msub><mo id="S2.Ex1.m1.2.2.1.1.2.2.2.5" xref="S2.Ex1.m1.2.2.1.1.2.2.3.cmml">,</mo><msub id="S2.Ex1.m1.2.2.1.1.2.2.2.2" xref="S2.Ex1.m1.2.2.1.1.2.2.2.2.cmml"><mi id="S2.Ex1.m1.2.2.1.1.2.2.2.2.2" xref="S2.Ex1.m1.2.2.1.1.2.2.2.2.2.cmml">y</mi><msub id="S2.Ex1.m1.2.2.1.1.2.2.2.2.3" xref="S2.Ex1.m1.2.2.1.1.2.2.2.2.3.cmml"><mi id="S2.Ex1.m1.2.2.1.1.2.2.2.2.3.2" xref="S2.Ex1.m1.2.2.1.1.2.2.2.2.3.2.cmml">L</mi><mi class="ltx_font_mathcaligraphic" id="S2.Ex1.m1.2.2.1.1.2.2.2.2.3.3" xref="S2.Ex1.m1.2.2.1.1.2.2.2.2.3.3.cmml">𝒞</mi></msub></msub><mo id="S2.Ex1.m1.2.2.1.1.2.2.2.6" stretchy="false" xref="S2.Ex1.m1.2.2.1.1.2.2.3.cmml">)</mo></mrow></mrow></mrow><mo id="S2.Ex1.m1.2.2.1.2" xref="S2.Ex1.m1.2.2.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S2.Ex1.m1.2b"><apply id="S2.Ex1.m1.2.2.1.1.cmml" xref="S2.Ex1.m1.2.2.1"><eq id="S2.Ex1.m1.2.2.1.1.3.cmml" xref="S2.Ex1.m1.2.2.1.1.3"></eq><apply id="S2.Ex1.m1.2.2.1.1.4.cmml" xref="S2.Ex1.m1.2.2.1.1.4"><csymbol cd="ambiguous" id="S2.Ex1.m1.2.2.1.1.4.1.cmml" xref="S2.Ex1.m1.2.2.1.1.4">superscript</csymbol><apply id="S2.Ex1.m1.2.2.1.1.4.2.cmml" xref="S2.Ex1.m1.2.2.1.1.4"><csymbol cd="ambiguous" id="S2.Ex1.m1.2.2.1.1.4.2.1.cmml" xref="S2.Ex1.m1.2.2.1.1.4">subscript</csymbol><ci id="S2.Ex1.m1.2.2.1.1.4.2.2.cmml" xref="S2.Ex1.m1.2.2.1.1.4.2.2">𝐿</ci><ci id="S2.Ex1.m1.2.2.1.1.4.2.3.cmml" xref="S2.Ex1.m1.2.2.1.1.4.2.3">𝒞</ci></apply><times id="S2.Ex1.m1.2.2.1.1.4.3.cmml" xref="S2.Ex1.m1.2.2.1.1.4.3"></times></apply><apply id="S2.Ex1.m1.2.2.1.1.2.cmml" xref="S2.Ex1.m1.2.2.1.1.2"><times id="S2.Ex1.m1.2.2.1.1.2.3.cmml" xref="S2.Ex1.m1.2.2.1.1.2.3"></times><apply id="S2.Ex1.m1.2.2.1.1.2.4.cmml" xref="S2.Ex1.m1.2.2.1.1.2.4"><apply id="S2.Ex1.m1.2.2.1.1.2.4.1.cmml" xref="S2.Ex1.m1.2.2.1.1.2.4.1"><csymbol cd="ambiguous" id="S2.Ex1.m1.2.2.1.1.2.4.1.1.cmml" xref="S2.Ex1.m1.2.2.1.1.2.4.1">subscript</csymbol><ci id="S2.Ex1.m1.2.2.1.1.2.4.1.2.cmml" xref="S2.Ex1.m1.2.2.1.1.2.4.1.2">𝐿</ci><ci id="S2.Ex1.m1.2.2.1.1.2.4.1.3.cmml" xref="S2.Ex1.m1.2.2.1.1.2.4.1.3">𝒞</ci></apply><apply id="S2.Ex1.m1.2.2.1.1.2.4.2.cmml" xref="S2.Ex1.m1.2.2.1.1.2.4.2"><arg id="S2.Ex1.m1.2.2.1.1.2.4.2.1.cmml" xref="S2.Ex1.m1.2.2.1.1.2.4.2.1"></arg><max id="S2.Ex1.m1.2.2.1.1.2.4.2.2.cmml" xref="S2.Ex1.m1.2.2.1.1.2.4.2.2"></max></apply></apply><ci id="S2.Ex1.m1.2.2.1.1.2.5.cmml" xref="S2.Ex1.m1.2.2.1.1.2.5">𝑅</ci><vector id="S2.Ex1.m1.2.2.1.1.2.2.3.cmml" xref="S2.Ex1.m1.2.2.1.1.2.2.2"><ci id="S2.Ex1.m1.1.1.cmml" xref="S2.Ex1.m1.1.1">𝑢</ci><apply id="S2.Ex1.m1.2.2.1.1.1.1.1.1.cmml" xref="S2.Ex1.m1.2.2.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S2.Ex1.m1.2.2.1.1.1.1.1.1.1.cmml" xref="S2.Ex1.m1.2.2.1.1.1.1.1.1">subscript</csymbol><ci id="S2.Ex1.m1.2.2.1.1.1.1.1.1.2.cmml" xref="S2.Ex1.m1.2.2.1.1.1.1.1.1.2">𝐿</ci><ci id="S2.Ex1.m1.2.2.1.1.1.1.1.1.3.cmml" xref="S2.Ex1.m1.2.2.1.1.1.1.1.1.3">𝒞</ci></apply><apply id="S2.Ex1.m1.2.2.1.1.2.2.2.2.cmml" xref="S2.Ex1.m1.2.2.1.1.2.2.2.2"><csymbol cd="ambiguous" id="S2.Ex1.m1.2.2.1.1.2.2.2.2.1.cmml" xref="S2.Ex1.m1.2.2.1.1.2.2.2.2">subscript</csymbol><ci id="S2.Ex1.m1.2.2.1.1.2.2.2.2.2.cmml" xref="S2.Ex1.m1.2.2.1.1.2.2.2.2.2">𝑦</ci><apply id="S2.Ex1.m1.2.2.1.1.2.2.2.2.3.cmml" xref="S2.Ex1.m1.2.2.1.1.2.2.2.2.3"><csymbol cd="ambiguous" id="S2.Ex1.m1.2.2.1.1.2.2.2.2.3.1.cmml" xref="S2.Ex1.m1.2.2.1.1.2.2.2.2.3">subscript</csymbol><ci id="S2.Ex1.m1.2.2.1.1.2.2.2.2.3.2.cmml" xref="S2.Ex1.m1.2.2.1.1.2.2.2.2.3.2">𝐿</ci><ci id="S2.Ex1.m1.2.2.1.1.2.2.2.2.3.3.cmml" xref="S2.Ex1.m1.2.2.1.1.2.2.2.2.3.3">𝒞</ci></apply></apply></vector></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.Ex1.m1.2c">L_{\mathcal{C}}^{*}=\underset{L_{\mathcal{C}}}{\arg\max}~{}R(u,L_{\mathcal{C}}%
,y_{L_{\mathcal{C}}}),</annotation><annotation encoding="application/x-llamapun" id="S2.Ex1.m1.2d">italic_L start_POSTSUBSCRIPT caligraphic_C end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ∗ end_POSTSUPERSCRIPT = start_UNDERACCENT italic_L start_POSTSUBSCRIPT caligraphic_C end_POSTSUBSCRIPT end_UNDERACCENT start_ARG roman_arg roman_max end_ARG italic_R ( italic_u , italic_L start_POSTSUBSCRIPT caligraphic_C end_POSTSUBSCRIPT , italic_y start_POSTSUBSCRIPT italic_L start_POSTSUBSCRIPT caligraphic_C end_POSTSUBSCRIPT end_POSTSUBSCRIPT ) ,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S2.p1.16">where each list is of length <math alttext="N" class="ltx_Math" display="inline" id="S2.p1.7.m1.1"><semantics id="S2.p1.7.m1.1a"><mi id="S2.p1.7.m1.1.1" xref="S2.p1.7.m1.1.1.cmml">N</mi><annotation-xml encoding="MathML-Content" id="S2.p1.7.m1.1b"><ci id="S2.p1.7.m1.1.1.cmml" xref="S2.p1.7.m1.1.1">𝑁</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.p1.7.m1.1c">N</annotation><annotation encoding="application/x-llamapun" id="S2.p1.7.m1.1d">italic_N</annotation></semantics></math> and it is obvious that <math alttext="N\leq M" class="ltx_Math" display="inline" id="S2.p1.8.m2.1"><semantics id="S2.p1.8.m2.1a"><mrow id="S2.p1.8.m2.1.1" xref="S2.p1.8.m2.1.1.cmml"><mi id="S2.p1.8.m2.1.1.2" xref="S2.p1.8.m2.1.1.2.cmml">N</mi><mo id="S2.p1.8.m2.1.1.1" xref="S2.p1.8.m2.1.1.1.cmml">≤</mo><mi id="S2.p1.8.m2.1.1.3" xref="S2.p1.8.m2.1.1.3.cmml">M</mi></mrow><annotation-xml encoding="MathML-Content" id="S2.p1.8.m2.1b"><apply id="S2.p1.8.m2.1.1.cmml" xref="S2.p1.8.m2.1.1"><leq id="S2.p1.8.m2.1.1.1.cmml" xref="S2.p1.8.m2.1.1.1"></leq><ci id="S2.p1.8.m2.1.1.2.cmml" xref="S2.p1.8.m2.1.1.2">𝑁</ci><ci id="S2.p1.8.m2.1.1.3.cmml" xref="S2.p1.8.m2.1.1.3">𝑀</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.p1.8.m2.1c">N\leq M</annotation><annotation encoding="application/x-llamapun" id="S2.p1.8.m2.1d">italic_N ≤ italic_M</annotation></semantics></math>.
<math alttext="y_{L_{\mathcal{C}}}" class="ltx_Math" display="inline" id="S2.p1.9.m3.1"><semantics id="S2.p1.9.m3.1a"><msub id="S2.p1.9.m3.1.1" xref="S2.p1.9.m3.1.1.cmml"><mi id="S2.p1.9.m3.1.1.2" xref="S2.p1.9.m3.1.1.2.cmml">y</mi><msub id="S2.p1.9.m3.1.1.3" xref="S2.p1.9.m3.1.1.3.cmml"><mi id="S2.p1.9.m3.1.1.3.2" xref="S2.p1.9.m3.1.1.3.2.cmml">L</mi><mi class="ltx_font_mathcaligraphic" id="S2.p1.9.m3.1.1.3.3" xref="S2.p1.9.m3.1.1.3.3.cmml">𝒞</mi></msub></msub><annotation-xml encoding="MathML-Content" id="S2.p1.9.m3.1b"><apply id="S2.p1.9.m3.1.1.cmml" xref="S2.p1.9.m3.1.1"><csymbol cd="ambiguous" id="S2.p1.9.m3.1.1.1.cmml" xref="S2.p1.9.m3.1.1">subscript</csymbol><ci id="S2.p1.9.m3.1.1.2.cmml" xref="S2.p1.9.m3.1.1.2">𝑦</ci><apply id="S2.p1.9.m3.1.1.3.cmml" xref="S2.p1.9.m3.1.1.3"><csymbol cd="ambiguous" id="S2.p1.9.m3.1.1.3.1.cmml" xref="S2.p1.9.m3.1.1.3">subscript</csymbol><ci id="S2.p1.9.m3.1.1.3.2.cmml" xref="S2.p1.9.m3.1.1.3.2">𝐿</ci><ci id="S2.p1.9.m3.1.1.3.3.cmml" xref="S2.p1.9.m3.1.1.3.3">𝒞</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.p1.9.m3.1c">y_{L_{\mathcal{C}}}</annotation><annotation encoding="application/x-llamapun" id="S2.p1.9.m3.1d">italic_y start_POSTSUBSCRIPT italic_L start_POSTSUBSCRIPT caligraphic_C end_POSTSUBSCRIPT end_POSTSUBSCRIPT</annotation></semantics></math> is the feedback of the user <math alttext="u" class="ltx_Math" display="inline" id="S2.p1.10.m4.1"><semantics id="S2.p1.10.m4.1a"><mi id="S2.p1.10.m4.1.1" xref="S2.p1.10.m4.1.1.cmml">u</mi><annotation-xml encoding="MathML-Content" id="S2.p1.10.m4.1b"><ci id="S2.p1.10.m4.1.1.cmml" xref="S2.p1.10.m4.1.1">𝑢</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.p1.10.m4.1c">u</annotation><annotation encoding="application/x-llamapun" id="S2.p1.10.m4.1d">italic_u</annotation></semantics></math> to the list <math alttext="L_{\mathcal{C}}" class="ltx_Math" display="inline" id="S2.p1.11.m5.1"><semantics id="S2.p1.11.m5.1a"><msub id="S2.p1.11.m5.1.1" xref="S2.p1.11.m5.1.1.cmml"><mi id="S2.p1.11.m5.1.1.2" xref="S2.p1.11.m5.1.1.2.cmml">L</mi><mi class="ltx_font_mathcaligraphic" id="S2.p1.11.m5.1.1.3" xref="S2.p1.11.m5.1.1.3.cmml">𝒞</mi></msub><annotation-xml encoding="MathML-Content" id="S2.p1.11.m5.1b"><apply id="S2.p1.11.m5.1.1.cmml" xref="S2.p1.11.m5.1.1"><csymbol cd="ambiguous" id="S2.p1.11.m5.1.1.1.cmml" xref="S2.p1.11.m5.1.1">subscript</csymbol><ci id="S2.p1.11.m5.1.1.2.cmml" xref="S2.p1.11.m5.1.1.2">𝐿</ci><ci id="S2.p1.11.m5.1.1.3.cmml" xref="S2.p1.11.m5.1.1.3">𝒞</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.p1.11.m5.1c">L_{\mathcal{C}}</annotation><annotation encoding="application/x-llamapun" id="S2.p1.11.m5.1d">italic_L start_POSTSUBSCRIPT caligraphic_C end_POSTSUBSCRIPT</annotation></semantics></math>. In e-commerce, <math alttext="y" class="ltx_Math" display="inline" id="S2.p1.12.m6.1"><semantics id="S2.p1.12.m6.1a"><mi id="S2.p1.12.m6.1.1" xref="S2.p1.12.m6.1.1.cmml">y</mi><annotation-xml encoding="MathML-Content" id="S2.p1.12.m6.1b"><ci id="S2.p1.12.m6.1.1.cmml" xref="S2.p1.12.m6.1.1">𝑦</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.p1.12.m6.1c">y</annotation><annotation encoding="application/x-llamapun" id="S2.p1.12.m6.1d">italic_y</annotation></semantics></math> usually involves user engagements, such as click and purchase.
<math alttext="R(\cdot)" class="ltx_Math" display="inline" id="S2.p1.13.m7.1"><semantics id="S2.p1.13.m7.1a"><mrow id="S2.p1.13.m7.1.2" xref="S2.p1.13.m7.1.2.cmml"><mi id="S2.p1.13.m7.1.2.2" xref="S2.p1.13.m7.1.2.2.cmml">R</mi><mo id="S2.p1.13.m7.1.2.1" xref="S2.p1.13.m7.1.2.1.cmml">⁢</mo><mrow id="S2.p1.13.m7.1.2.3.2" xref="S2.p1.13.m7.1.2.cmml"><mo id="S2.p1.13.m7.1.2.3.2.1" stretchy="false" xref="S2.p1.13.m7.1.2.cmml">(</mo><mo id="S2.p1.13.m7.1.1" lspace="0em" rspace="0em" xref="S2.p1.13.m7.1.1.cmml">⋅</mo><mo id="S2.p1.13.m7.1.2.3.2.2" stretchy="false" xref="S2.p1.13.m7.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.p1.13.m7.1b"><apply id="S2.p1.13.m7.1.2.cmml" xref="S2.p1.13.m7.1.2"><times id="S2.p1.13.m7.1.2.1.cmml" xref="S2.p1.13.m7.1.2.1"></times><ci id="S2.p1.13.m7.1.2.2.cmml" xref="S2.p1.13.m7.1.2.2">𝑅</ci><ci id="S2.p1.13.m7.1.1.cmml" xref="S2.p1.13.m7.1.1">⋅</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.p1.13.m7.1c">R(\cdot)</annotation><annotation encoding="application/x-llamapun" id="S2.p1.13.m7.1d">italic_R ( ⋅ )</annotation></semantics></math> may also consider other desirable aspects of the recommended list, such as diversity <cite class="ltx_cite ltx_citemacro_citep">(Jiang et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2406.14004v1#bib.bib9" title="">2017</a>; Liu et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2406.14004v1#bib.bib14" title="">2020</a>; Xia et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2406.14004v1#bib.bib23" title="">2017</a>)</cite>, novelty <cite class="ltx_cite ltx_citemacro_citep">(Xia et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2406.14004v1#bib.bib22" title="">2016</a>; Kotkov et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2406.14004v1#bib.bib12" title="">2016</a>)</cite>, and fairness <cite class="ltx_cite ltx_citemacro_citep">(Karako and Manggala, <a class="ltx_ref" href="https://arxiv.org/html/2406.14004v1#bib.bib11" title="">2018</a>; Oosterhuis, <a class="ltx_ref" href="https://arxiv.org/html/2406.14004v1#bib.bib15" title="">2021</a>; Zhu et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2406.14004v1#bib.bib25" title="">2021</a>)</cite>.
Here, we assume the existence of a single optimal list. For simplicity, we henceforth drop the subscript <math alttext="\mathcal{C}" class="ltx_Math" display="inline" id="S2.p1.14.m8.1"><semantics id="S2.p1.14.m8.1a"><mi class="ltx_font_mathcaligraphic" id="S2.p1.14.m8.1.1" xref="S2.p1.14.m8.1.1.cmml">𝒞</mi><annotation-xml encoding="MathML-Content" id="S2.p1.14.m8.1b"><ci id="S2.p1.14.m8.1.1.cmml" xref="S2.p1.14.m8.1.1">𝒞</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.p1.14.m8.1c">\mathcal{C}</annotation><annotation encoding="application/x-llamapun" id="S2.p1.14.m8.1d">caligraphic_C</annotation></semantics></math>.
A list-generating model <math alttext="G(\cdot)" class="ltx_Math" display="inline" id="S2.p1.15.m9.1"><semantics id="S2.p1.15.m9.1a"><mrow id="S2.p1.15.m9.1.2" xref="S2.p1.15.m9.1.2.cmml"><mi id="S2.p1.15.m9.1.2.2" xref="S2.p1.15.m9.1.2.2.cmml">G</mi><mo id="S2.p1.15.m9.1.2.1" xref="S2.p1.15.m9.1.2.1.cmml">⁢</mo><mrow id="S2.p1.15.m9.1.2.3.2" xref="S2.p1.15.m9.1.2.cmml"><mo id="S2.p1.15.m9.1.2.3.2.1" stretchy="false" xref="S2.p1.15.m9.1.2.cmml">(</mo><mo id="S2.p1.15.m9.1.1" lspace="0em" rspace="0em" xref="S2.p1.15.m9.1.1.cmml">⋅</mo><mo id="S2.p1.15.m9.1.2.3.2.2" stretchy="false" xref="S2.p1.15.m9.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.p1.15.m9.1b"><apply id="S2.p1.15.m9.1.2.cmml" xref="S2.p1.15.m9.1.2"><times id="S2.p1.15.m9.1.2.1.cmml" xref="S2.p1.15.m9.1.2.1"></times><ci id="S2.p1.15.m9.1.2.2.cmml" xref="S2.p1.15.m9.1.2.2">𝐺</ci><ci id="S2.p1.15.m9.1.1.cmml" xref="S2.p1.15.m9.1.1">⋅</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.p1.15.m9.1c">G(\cdot)</annotation><annotation encoding="application/x-llamapun" id="S2.p1.15.m9.1d">italic_G ( ⋅ )</annotation></semantics></math>, parameterized by <math alttext="\boldsymbol{\theta}" class="ltx_Math" display="inline" id="S2.p1.16.m10.1"><semantics id="S2.p1.16.m10.1a"><mi id="S2.p1.16.m10.1.1" xref="S2.p1.16.m10.1.1.cmml">𝜽</mi><annotation-xml encoding="MathML-Content" id="S2.p1.16.m10.1b"><ci id="S2.p1.16.m10.1.1.cmml" xref="S2.p1.16.m10.1.1">𝜽</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.p1.16.m10.1c">\boldsymbol{\theta}</annotation><annotation encoding="application/x-llamapun" id="S2.p1.16.m10.1d">bold_italic_θ</annotation></semantics></math>, is trained to find the optimal list in a single forward execution:</p>
<table class="ltx_equation ltx_eqn_table" id="S2.Ex2">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\widehat{L^{*}}=G(u,\mathcal{C};\boldsymbol{\theta})" class="ltx_Math" display="block" id="S2.Ex2.m1.3"><semantics id="S2.Ex2.m1.3a"><mrow id="S2.Ex2.m1.3.4" xref="S2.Ex2.m1.3.4.cmml"><mover accent="true" id="S2.Ex2.m1.3.4.2" xref="S2.Ex2.m1.3.4.2.cmml"><msup id="S2.Ex2.m1.3.4.2.2" xref="S2.Ex2.m1.3.4.2.2.cmml"><mi id="S2.Ex2.m1.3.4.2.2.2" xref="S2.Ex2.m1.3.4.2.2.2.cmml">L</mi><mo id="S2.Ex2.m1.3.4.2.2.3" xref="S2.Ex2.m1.3.4.2.2.3.cmml">∗</mo></msup><mo id="S2.Ex2.m1.3.4.2.1" xref="S2.Ex2.m1.3.4.2.1.cmml">^</mo></mover><mo id="S2.Ex2.m1.3.4.1" xref="S2.Ex2.m1.3.4.1.cmml">=</mo><mrow id="S2.Ex2.m1.3.4.3" xref="S2.Ex2.m1.3.4.3.cmml"><mi id="S2.Ex2.m1.3.4.3.2" xref="S2.Ex2.m1.3.4.3.2.cmml">G</mi><mo id="S2.Ex2.m1.3.4.3.1" xref="S2.Ex2.m1.3.4.3.1.cmml">⁢</mo><mrow id="S2.Ex2.m1.3.4.3.3.2" xref="S2.Ex2.m1.3.4.3.3.1.cmml"><mo id="S2.Ex2.m1.3.4.3.3.2.1" stretchy="false" xref="S2.Ex2.m1.3.4.3.3.1.cmml">(</mo><mi id="S2.Ex2.m1.1.1" xref="S2.Ex2.m1.1.1.cmml">u</mi><mo id="S2.Ex2.m1.3.4.3.3.2.2" xref="S2.Ex2.m1.3.4.3.3.1.cmml">,</mo><mi class="ltx_font_mathcaligraphic" id="S2.Ex2.m1.2.2" xref="S2.Ex2.m1.2.2.cmml">𝒞</mi><mo id="S2.Ex2.m1.3.4.3.3.2.3" xref="S2.Ex2.m1.3.4.3.3.1.cmml">;</mo><mi id="S2.Ex2.m1.3.3" xref="S2.Ex2.m1.3.3.cmml">𝜽</mi><mo id="S2.Ex2.m1.3.4.3.3.2.4" stretchy="false" xref="S2.Ex2.m1.3.4.3.3.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.Ex2.m1.3b"><apply id="S2.Ex2.m1.3.4.cmml" xref="S2.Ex2.m1.3.4"><eq id="S2.Ex2.m1.3.4.1.cmml" xref="S2.Ex2.m1.3.4.1"></eq><apply id="S2.Ex2.m1.3.4.2.cmml" xref="S2.Ex2.m1.3.4.2"><ci id="S2.Ex2.m1.3.4.2.1.cmml" xref="S2.Ex2.m1.3.4.2.1">^</ci><apply id="S2.Ex2.m1.3.4.2.2.cmml" xref="S2.Ex2.m1.3.4.2.2"><csymbol cd="ambiguous" id="S2.Ex2.m1.3.4.2.2.1.cmml" xref="S2.Ex2.m1.3.4.2.2">superscript</csymbol><ci id="S2.Ex2.m1.3.4.2.2.2.cmml" xref="S2.Ex2.m1.3.4.2.2.2">𝐿</ci><times id="S2.Ex2.m1.3.4.2.2.3.cmml" xref="S2.Ex2.m1.3.4.2.2.3"></times></apply></apply><apply id="S2.Ex2.m1.3.4.3.cmml" xref="S2.Ex2.m1.3.4.3"><times id="S2.Ex2.m1.3.4.3.1.cmml" xref="S2.Ex2.m1.3.4.3.1"></times><ci id="S2.Ex2.m1.3.4.3.2.cmml" xref="S2.Ex2.m1.3.4.3.2">𝐺</ci><vector id="S2.Ex2.m1.3.4.3.3.1.cmml" xref="S2.Ex2.m1.3.4.3.3.2"><ci id="S2.Ex2.m1.1.1.cmml" xref="S2.Ex2.m1.1.1">𝑢</ci><ci id="S2.Ex2.m1.2.2.cmml" xref="S2.Ex2.m1.2.2">𝒞</ci><ci id="S2.Ex2.m1.3.3.cmml" xref="S2.Ex2.m1.3.3">𝜽</ci></vector></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.Ex2.m1.3c">\widehat{L^{*}}=G(u,\mathcal{C};\boldsymbol{\theta})</annotation><annotation encoding="application/x-llamapun" id="S2.Ex2.m1.3d">over^ start_ARG italic_L start_POSTSUPERSCRIPT ∗ end_POSTSUPERSCRIPT end_ARG = italic_G ( italic_u , caligraphic_C ; bold_italic_θ )</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S2.p1.17">In the actor-evaluator framework, <math alttext="G(\cdot)" class="ltx_Math" display="inline" id="S2.p1.17.m1.1"><semantics id="S2.p1.17.m1.1a"><mrow id="S2.p1.17.m1.1.2" xref="S2.p1.17.m1.1.2.cmml"><mi id="S2.p1.17.m1.1.2.2" xref="S2.p1.17.m1.1.2.2.cmml">G</mi><mo id="S2.p1.17.m1.1.2.1" xref="S2.p1.17.m1.1.2.1.cmml">⁢</mo><mrow id="S2.p1.17.m1.1.2.3.2" xref="S2.p1.17.m1.1.2.cmml"><mo id="S2.p1.17.m1.1.2.3.2.1" stretchy="false" xref="S2.p1.17.m1.1.2.cmml">(</mo><mo id="S2.p1.17.m1.1.1" lspace="0em" rspace="0em" xref="S2.p1.17.m1.1.1.cmml">⋅</mo><mo id="S2.p1.17.m1.1.2.3.2.2" stretchy="false" xref="S2.p1.17.m1.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.p1.17.m1.1b"><apply id="S2.p1.17.m1.1.2.cmml" xref="S2.p1.17.m1.1.2"><times id="S2.p1.17.m1.1.2.1.cmml" xref="S2.p1.17.m1.1.2.1"></times><ci id="S2.p1.17.m1.1.2.2.cmml" xref="S2.p1.17.m1.1.2.2">𝐺</ci><ci id="S2.p1.17.m1.1.1.cmml" xref="S2.p1.17.m1.1.1">⋅</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.p1.17.m1.1c">G(\cdot)</annotation><annotation encoding="application/x-llamapun" id="S2.p1.17.m1.1d">italic_G ( ⋅ )</annotation></semantics></math> is called the actor. The training of the actor can be described as:</p>
<table class="ltx_equation ltx_eqn_table" id="S2.Ex3">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\underset{\boldsymbol{\theta}}{\max}~{}\mathbb{E}_{u,\mathcal{C}}[R(u,G(u,%
\mathcal{C};\boldsymbol{\theta}),y_{G(u,\mathcal{C};\boldsymbol{\theta})})]," class="ltx_Math" display="block" id="S2.Ex3.m1.10"><semantics id="S2.Ex3.m1.10a"><mrow id="S2.Ex3.m1.10.10.1" xref="S2.Ex3.m1.10.10.1.1.cmml"><mrow id="S2.Ex3.m1.10.10.1.1" xref="S2.Ex3.m1.10.10.1.1.cmml"><munder accentunder="true" id="S2.Ex3.m1.10.10.1.1.3" xref="S2.Ex3.m1.10.10.1.1.3.cmml"><mi id="S2.Ex3.m1.10.10.1.1.3.2" xref="S2.Ex3.m1.10.10.1.1.3.2.cmml">max</mi><mo id="S2.Ex3.m1.10.10.1.1.3.1" xref="S2.Ex3.m1.10.10.1.1.3.1.cmml">𝜽</mo></munder><mo id="S2.Ex3.m1.10.10.1.1.2" lspace="0.497em" xref="S2.Ex3.m1.10.10.1.1.2.cmml">⁢</mo><msub id="S2.Ex3.m1.10.10.1.1.4" xref="S2.Ex3.m1.10.10.1.1.4.cmml"><mi id="S2.Ex3.m1.10.10.1.1.4.2" xref="S2.Ex3.m1.10.10.1.1.4.2.cmml">𝔼</mi><mrow id="S2.Ex3.m1.2.2.2.4" xref="S2.Ex3.m1.2.2.2.3.cmml"><mi id="S2.Ex3.m1.1.1.1.1" xref="S2.Ex3.m1.1.1.1.1.cmml">u</mi><mo id="S2.Ex3.m1.2.2.2.4.1" xref="S2.Ex3.m1.2.2.2.3.cmml">,</mo><mi class="ltx_font_mathcaligraphic" id="S2.Ex3.m1.2.2.2.2" xref="S2.Ex3.m1.2.2.2.2.cmml">𝒞</mi></mrow></msub><mo id="S2.Ex3.m1.10.10.1.1.2a" xref="S2.Ex3.m1.10.10.1.1.2.cmml">⁢</mo><mrow id="S2.Ex3.m1.10.10.1.1.1.1" xref="S2.Ex3.m1.10.10.1.1.1.2.cmml"><mo id="S2.Ex3.m1.10.10.1.1.1.1.2" stretchy="false" xref="S2.Ex3.m1.10.10.1.1.1.2.1.cmml">[</mo><mrow id="S2.Ex3.m1.10.10.1.1.1.1.1" xref="S2.Ex3.m1.10.10.1.1.1.1.1.cmml"><mi id="S2.Ex3.m1.10.10.1.1.1.1.1.4" xref="S2.Ex3.m1.10.10.1.1.1.1.1.4.cmml">R</mi><mo id="S2.Ex3.m1.10.10.1.1.1.1.1.3" xref="S2.Ex3.m1.10.10.1.1.1.1.1.3.cmml">⁢</mo><mrow id="S2.Ex3.m1.10.10.1.1.1.1.1.2.2" xref="S2.Ex3.m1.10.10.1.1.1.1.1.2.3.cmml"><mo id="S2.Ex3.m1.10.10.1.1.1.1.1.2.2.3" stretchy="false" xref="S2.Ex3.m1.10.10.1.1.1.1.1.2.3.cmml">(</mo><mi id="S2.Ex3.m1.9.9" xref="S2.Ex3.m1.9.9.cmml">u</mi><mo id="S2.Ex3.m1.10.10.1.1.1.1.1.2.2.4" xref="S2.Ex3.m1.10.10.1.1.1.1.1.2.3.cmml">,</mo><mrow id="S2.Ex3.m1.10.10.1.1.1.1.1.1.1.1" xref="S2.Ex3.m1.10.10.1.1.1.1.1.1.1.1.cmml"><mi id="S2.Ex3.m1.10.10.1.1.1.1.1.1.1.1.2" xref="S2.Ex3.m1.10.10.1.1.1.1.1.1.1.1.2.cmml">G</mi><mo id="S2.Ex3.m1.10.10.1.1.1.1.1.1.1.1.1" xref="S2.Ex3.m1.10.10.1.1.1.1.1.1.1.1.1.cmml">⁢</mo><mrow id="S2.Ex3.m1.10.10.1.1.1.1.1.1.1.1.3.2" xref="S2.Ex3.m1.10.10.1.1.1.1.1.1.1.1.3.1.cmml"><mo id="S2.Ex3.m1.10.10.1.1.1.1.1.1.1.1.3.2.1" stretchy="false" xref="S2.Ex3.m1.10.10.1.1.1.1.1.1.1.1.3.1.cmml">(</mo><mi id="S2.Ex3.m1.6.6" xref="S2.Ex3.m1.6.6.cmml">u</mi><mo id="S2.Ex3.m1.10.10.1.1.1.1.1.1.1.1.3.2.2" xref="S2.Ex3.m1.10.10.1.1.1.1.1.1.1.1.3.1.cmml">,</mo><mi class="ltx_font_mathcaligraphic" id="S2.Ex3.m1.7.7" xref="S2.Ex3.m1.7.7.cmml">𝒞</mi><mo id="S2.Ex3.m1.10.10.1.1.1.1.1.1.1.1.3.2.3" xref="S2.Ex3.m1.10.10.1.1.1.1.1.1.1.1.3.1.cmml">;</mo><mi id="S2.Ex3.m1.8.8" xref="S2.Ex3.m1.8.8.cmml">𝜽</mi><mo id="S2.Ex3.m1.10.10.1.1.1.1.1.1.1.1.3.2.4" stretchy="false" xref="S2.Ex3.m1.10.10.1.1.1.1.1.1.1.1.3.1.cmml">)</mo></mrow></mrow><mo id="S2.Ex3.m1.10.10.1.1.1.1.1.2.2.5" xref="S2.Ex3.m1.10.10.1.1.1.1.1.2.3.cmml">,</mo><msub id="S2.Ex3.m1.10.10.1.1.1.1.1.2.2.2" xref="S2.Ex3.m1.10.10.1.1.1.1.1.2.2.2.cmml"><mi id="S2.Ex3.m1.10.10.1.1.1.1.1.2.2.2.2" xref="S2.Ex3.m1.10.10.1.1.1.1.1.2.2.2.2.cmml">y</mi><mrow id="S2.Ex3.m1.5.5.3" xref="S2.Ex3.m1.5.5.3.cmml"><mi id="S2.Ex3.m1.5.5.3.5" xref="S2.Ex3.m1.5.5.3.5.cmml">G</mi><mo id="S2.Ex3.m1.5.5.3.4" xref="S2.Ex3.m1.5.5.3.4.cmml">⁢</mo><mrow id="S2.Ex3.m1.5.5.3.6.2" xref="S2.Ex3.m1.5.5.3.6.1.cmml"><mo id="S2.Ex3.m1.5.5.3.6.2.1" stretchy="false" xref="S2.Ex3.m1.5.5.3.6.1.cmml">(</mo><mi id="S2.Ex3.m1.3.3.1.1" xref="S2.Ex3.m1.3.3.1.1.cmml">u</mi><mo id="S2.Ex3.m1.5.5.3.6.2.2" xref="S2.Ex3.m1.5.5.3.6.1.cmml">,</mo><mi class="ltx_font_mathcaligraphic" id="S2.Ex3.m1.4.4.2.2" xref="S2.Ex3.m1.4.4.2.2.cmml">𝒞</mi><mo id="S2.Ex3.m1.5.5.3.6.2.3" xref="S2.Ex3.m1.5.5.3.6.1.cmml">;</mo><mi id="S2.Ex3.m1.5.5.3.3" xref="S2.Ex3.m1.5.5.3.3.cmml">𝜽</mi><mo id="S2.Ex3.m1.5.5.3.6.2.4" stretchy="false" xref="S2.Ex3.m1.5.5.3.6.1.cmml">)</mo></mrow></mrow></msub><mo id="S2.Ex3.m1.10.10.1.1.1.1.1.2.2.6" stretchy="false" xref="S2.Ex3.m1.10.10.1.1.1.1.1.2.3.cmml">)</mo></mrow></mrow><mo id="S2.Ex3.m1.10.10.1.1.1.1.3" stretchy="false" xref="S2.Ex3.m1.10.10.1.1.1.2.1.cmml">]</mo></mrow></mrow><mo id="S2.Ex3.m1.10.10.1.2" xref="S2.Ex3.m1.10.10.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S2.Ex3.m1.10b"><apply id="S2.Ex3.m1.10.10.1.1.cmml" xref="S2.Ex3.m1.10.10.1"><times id="S2.Ex3.m1.10.10.1.1.2.cmml" xref="S2.Ex3.m1.10.10.1.1.2"></times><apply id="S2.Ex3.m1.10.10.1.1.3.cmml" xref="S2.Ex3.m1.10.10.1.1.3"><ci id="S2.Ex3.m1.10.10.1.1.3.1.cmml" xref="S2.Ex3.m1.10.10.1.1.3.1">𝜽</ci><max id="S2.Ex3.m1.10.10.1.1.3.2.cmml" xref="S2.Ex3.m1.10.10.1.1.3.2"></max></apply><apply id="S2.Ex3.m1.10.10.1.1.4.cmml" xref="S2.Ex3.m1.10.10.1.1.4"><csymbol cd="ambiguous" id="S2.Ex3.m1.10.10.1.1.4.1.cmml" xref="S2.Ex3.m1.10.10.1.1.4">subscript</csymbol><ci id="S2.Ex3.m1.10.10.1.1.4.2.cmml" xref="S2.Ex3.m1.10.10.1.1.4.2">𝔼</ci><list id="S2.Ex3.m1.2.2.2.3.cmml" xref="S2.Ex3.m1.2.2.2.4"><ci id="S2.Ex3.m1.1.1.1.1.cmml" xref="S2.Ex3.m1.1.1.1.1">𝑢</ci><ci id="S2.Ex3.m1.2.2.2.2.cmml" xref="S2.Ex3.m1.2.2.2.2">𝒞</ci></list></apply><apply id="S2.Ex3.m1.10.10.1.1.1.2.cmml" xref="S2.Ex3.m1.10.10.1.1.1.1"><csymbol cd="latexml" id="S2.Ex3.m1.10.10.1.1.1.2.1.cmml" xref="S2.Ex3.m1.10.10.1.1.1.1.2">delimited-[]</csymbol><apply id="S2.Ex3.m1.10.10.1.1.1.1.1.cmml" xref="S2.Ex3.m1.10.10.1.1.1.1.1"><times id="S2.Ex3.m1.10.10.1.1.1.1.1.3.cmml" xref="S2.Ex3.m1.10.10.1.1.1.1.1.3"></times><ci id="S2.Ex3.m1.10.10.1.1.1.1.1.4.cmml" xref="S2.Ex3.m1.10.10.1.1.1.1.1.4">𝑅</ci><vector id="S2.Ex3.m1.10.10.1.1.1.1.1.2.3.cmml" xref="S2.Ex3.m1.10.10.1.1.1.1.1.2.2"><ci id="S2.Ex3.m1.9.9.cmml" xref="S2.Ex3.m1.9.9">𝑢</ci><apply id="S2.Ex3.m1.10.10.1.1.1.1.1.1.1.1.cmml" xref="S2.Ex3.m1.10.10.1.1.1.1.1.1.1.1"><times id="S2.Ex3.m1.10.10.1.1.1.1.1.1.1.1.1.cmml" xref="S2.Ex3.m1.10.10.1.1.1.1.1.1.1.1.1"></times><ci id="S2.Ex3.m1.10.10.1.1.1.1.1.1.1.1.2.cmml" xref="S2.Ex3.m1.10.10.1.1.1.1.1.1.1.1.2">𝐺</ci><vector id="S2.Ex3.m1.10.10.1.1.1.1.1.1.1.1.3.1.cmml" xref="S2.Ex3.m1.10.10.1.1.1.1.1.1.1.1.3.2"><ci id="S2.Ex3.m1.6.6.cmml" xref="S2.Ex3.m1.6.6">𝑢</ci><ci id="S2.Ex3.m1.7.7.cmml" xref="S2.Ex3.m1.7.7">𝒞</ci><ci id="S2.Ex3.m1.8.8.cmml" xref="S2.Ex3.m1.8.8">𝜽</ci></vector></apply><apply id="S2.Ex3.m1.10.10.1.1.1.1.1.2.2.2.cmml" xref="S2.Ex3.m1.10.10.1.1.1.1.1.2.2.2"><csymbol cd="ambiguous" id="S2.Ex3.m1.10.10.1.1.1.1.1.2.2.2.1.cmml" xref="S2.Ex3.m1.10.10.1.1.1.1.1.2.2.2">subscript</csymbol><ci id="S2.Ex3.m1.10.10.1.1.1.1.1.2.2.2.2.cmml" xref="S2.Ex3.m1.10.10.1.1.1.1.1.2.2.2.2">𝑦</ci><apply id="S2.Ex3.m1.5.5.3.cmml" xref="S2.Ex3.m1.5.5.3"><times id="S2.Ex3.m1.5.5.3.4.cmml" xref="S2.Ex3.m1.5.5.3.4"></times><ci id="S2.Ex3.m1.5.5.3.5.cmml" xref="S2.Ex3.m1.5.5.3.5">𝐺</ci><vector id="S2.Ex3.m1.5.5.3.6.1.cmml" xref="S2.Ex3.m1.5.5.3.6.2"><ci id="S2.Ex3.m1.3.3.1.1.cmml" xref="S2.Ex3.m1.3.3.1.1">𝑢</ci><ci id="S2.Ex3.m1.4.4.2.2.cmml" xref="S2.Ex3.m1.4.4.2.2">𝒞</ci><ci id="S2.Ex3.m1.5.5.3.3.cmml" xref="S2.Ex3.m1.5.5.3.3">𝜽</ci></vector></apply></apply></vector></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.Ex3.m1.10c">\underset{\boldsymbol{\theta}}{\max}~{}\mathbb{E}_{u,\mathcal{C}}[R(u,G(u,%
\mathcal{C};\boldsymbol{\theta}),y_{G(u,\mathcal{C};\boldsymbol{\theta})})],</annotation><annotation encoding="application/x-llamapun" id="S2.Ex3.m1.10d">underbold_italic_θ start_ARG roman_max end_ARG blackboard_E start_POSTSUBSCRIPT italic_u , caligraphic_C end_POSTSUBSCRIPT [ italic_R ( italic_u , italic_G ( italic_u , caligraphic_C ; bold_italic_θ ) , italic_y start_POSTSUBSCRIPT italic_G ( italic_u , caligraphic_C ; bold_italic_θ ) end_POSTSUBSCRIPT ) ] ,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S2.p1.24">where <math alttext="\mathbb{E}" class="ltx_Math" display="inline" id="S2.p1.18.m1.1"><semantics id="S2.p1.18.m1.1a"><mi id="S2.p1.18.m1.1.1" xref="S2.p1.18.m1.1.1.cmml">𝔼</mi><annotation-xml encoding="MathML-Content" id="S2.p1.18.m1.1b"><ci id="S2.p1.18.m1.1.1.cmml" xref="S2.p1.18.m1.1.1">𝔼</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.p1.18.m1.1c">\mathbb{E}</annotation><annotation encoding="application/x-llamapun" id="S2.p1.18.m1.1d">blackboard_E</annotation></semantics></math> means expectation.
However, in the training process, the actor unavoidably generates lists that have never been shown to the user, and thus <math alttext="y" class="ltx_Math" display="inline" id="S2.p1.19.m2.1"><semantics id="S2.p1.19.m2.1a"><mi id="S2.p1.19.m2.1.1" xref="S2.p1.19.m2.1.1.cmml">y</mi><annotation-xml encoding="MathML-Content" id="S2.p1.19.m2.1b"><ci id="S2.p1.19.m2.1.1.cmml" xref="S2.p1.19.m2.1.1">𝑦</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.p1.19.m2.1c">y</annotation><annotation encoding="application/x-llamapun" id="S2.p1.19.m2.1d">italic_y</annotation></semantics></math> is not available. To overcome this problem, a surrogate model <math alttext="E(\cdot)" class="ltx_Math" display="inline" id="S2.p1.20.m3.1"><semantics id="S2.p1.20.m3.1a"><mrow id="S2.p1.20.m3.1.2" xref="S2.p1.20.m3.1.2.cmml"><mi id="S2.p1.20.m3.1.2.2" xref="S2.p1.20.m3.1.2.2.cmml">E</mi><mo id="S2.p1.20.m3.1.2.1" xref="S2.p1.20.m3.1.2.1.cmml">⁢</mo><mrow id="S2.p1.20.m3.1.2.3.2" xref="S2.p1.20.m3.1.2.cmml"><mo id="S2.p1.20.m3.1.2.3.2.1" stretchy="false" xref="S2.p1.20.m3.1.2.cmml">(</mo><mo id="S2.p1.20.m3.1.1" lspace="0em" rspace="0em" xref="S2.p1.20.m3.1.1.cmml">⋅</mo><mo id="S2.p1.20.m3.1.2.3.2.2" stretchy="false" xref="S2.p1.20.m3.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.p1.20.m3.1b"><apply id="S2.p1.20.m3.1.2.cmml" xref="S2.p1.20.m3.1.2"><times id="S2.p1.20.m3.1.2.1.cmml" xref="S2.p1.20.m3.1.2.1"></times><ci id="S2.p1.20.m3.1.2.2.cmml" xref="S2.p1.20.m3.1.2.2">𝐸</ci><ci id="S2.p1.20.m3.1.1.cmml" xref="S2.p1.20.m3.1.1">⋅</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.p1.20.m3.1c">E(\cdot)</annotation><annotation encoding="application/x-llamapun" id="S2.p1.20.m3.1d">italic_E ( ⋅ )</annotation></semantics></math>, is trained to approximate <math alttext="R(\cdot)" class="ltx_Math" display="inline" id="S2.p1.21.m4.1"><semantics id="S2.p1.21.m4.1a"><mrow id="S2.p1.21.m4.1.2" xref="S2.p1.21.m4.1.2.cmml"><mi id="S2.p1.21.m4.1.2.2" xref="S2.p1.21.m4.1.2.2.cmml">R</mi><mo id="S2.p1.21.m4.1.2.1" xref="S2.p1.21.m4.1.2.1.cmml">⁢</mo><mrow id="S2.p1.21.m4.1.2.3.2" xref="S2.p1.21.m4.1.2.cmml"><mo id="S2.p1.21.m4.1.2.3.2.1" stretchy="false" xref="S2.p1.21.m4.1.2.cmml">(</mo><mo id="S2.p1.21.m4.1.1" lspace="0em" rspace="0em" xref="S2.p1.21.m4.1.1.cmml">⋅</mo><mo id="S2.p1.21.m4.1.2.3.2.2" stretchy="false" xref="S2.p1.21.m4.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.p1.21.m4.1b"><apply id="S2.p1.21.m4.1.2.cmml" xref="S2.p1.21.m4.1.2"><times id="S2.p1.21.m4.1.2.1.cmml" xref="S2.p1.21.m4.1.2.1"></times><ci id="S2.p1.21.m4.1.2.2.cmml" xref="S2.p1.21.m4.1.2.2">𝑅</ci><ci id="S2.p1.21.m4.1.1.cmml" xref="S2.p1.21.m4.1.1">⋅</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.p1.21.m4.1c">R(\cdot)</annotation><annotation encoding="application/x-llamapun" id="S2.p1.21.m4.1d">italic_R ( ⋅ )</annotation></semantics></math> in the actor-evaluator framework, namely <math alttext="E(u,L;\boldsymbol{\phi})\to R(u,L,y_{L})" class="ltx_Math" display="inline" id="S2.p1.22.m5.6"><semantics id="S2.p1.22.m5.6a"><mrow id="S2.p1.22.m5.6.6" xref="S2.p1.22.m5.6.6.cmml"><mrow id="S2.p1.22.m5.6.6.3" xref="S2.p1.22.m5.6.6.3.cmml"><mi id="S2.p1.22.m5.6.6.3.2" xref="S2.p1.22.m5.6.6.3.2.cmml">E</mi><mo id="S2.p1.22.m5.6.6.3.1" xref="S2.p1.22.m5.6.6.3.1.cmml">⁢</mo><mrow id="S2.p1.22.m5.6.6.3.3.2" xref="S2.p1.22.m5.6.6.3.3.1.cmml"><mo id="S2.p1.22.m5.6.6.3.3.2.1" stretchy="false" xref="S2.p1.22.m5.6.6.3.3.1.cmml">(</mo><mi id="S2.p1.22.m5.1.1" xref="S2.p1.22.m5.1.1.cmml">u</mi><mo id="S2.p1.22.m5.6.6.3.3.2.2" xref="S2.p1.22.m5.6.6.3.3.1.cmml">,</mo><mi id="S2.p1.22.m5.2.2" xref="S2.p1.22.m5.2.2.cmml">L</mi><mo id="S2.p1.22.m5.6.6.3.3.2.3" xref="S2.p1.22.m5.6.6.3.3.1.cmml">;</mo><mi class="ltx_mathvariant_bold-italic" id="S2.p1.22.m5.3.3" mathvariant="bold-italic" xref="S2.p1.22.m5.3.3.cmml">ϕ</mi><mo id="S2.p1.22.m5.6.6.3.3.2.4" stretchy="false" xref="S2.p1.22.m5.6.6.3.3.1.cmml">)</mo></mrow></mrow><mo id="S2.p1.22.m5.6.6.2" stretchy="false" xref="S2.p1.22.m5.6.6.2.cmml">→</mo><mrow id="S2.p1.22.m5.6.6.1" xref="S2.p1.22.m5.6.6.1.cmml"><mi id="S2.p1.22.m5.6.6.1.3" xref="S2.p1.22.m5.6.6.1.3.cmml">R</mi><mo id="S2.p1.22.m5.6.6.1.2" xref="S2.p1.22.m5.6.6.1.2.cmml">⁢</mo><mrow id="S2.p1.22.m5.6.6.1.1.1" xref="S2.p1.22.m5.6.6.1.1.2.cmml"><mo id="S2.p1.22.m5.6.6.1.1.1.2" stretchy="false" xref="S2.p1.22.m5.6.6.1.1.2.cmml">(</mo><mi id="S2.p1.22.m5.4.4" xref="S2.p1.22.m5.4.4.cmml">u</mi><mo id="S2.p1.22.m5.6.6.1.1.1.3" xref="S2.p1.22.m5.6.6.1.1.2.cmml">,</mo><mi id="S2.p1.22.m5.5.5" xref="S2.p1.22.m5.5.5.cmml">L</mi><mo id="S2.p1.22.m5.6.6.1.1.1.4" xref="S2.p1.22.m5.6.6.1.1.2.cmml">,</mo><msub id="S2.p1.22.m5.6.6.1.1.1.1" xref="S2.p1.22.m5.6.6.1.1.1.1.cmml"><mi id="S2.p1.22.m5.6.6.1.1.1.1.2" xref="S2.p1.22.m5.6.6.1.1.1.1.2.cmml">y</mi><mi id="S2.p1.22.m5.6.6.1.1.1.1.3" xref="S2.p1.22.m5.6.6.1.1.1.1.3.cmml">L</mi></msub><mo id="S2.p1.22.m5.6.6.1.1.1.5" stretchy="false" xref="S2.p1.22.m5.6.6.1.1.2.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.p1.22.m5.6b"><apply id="S2.p1.22.m5.6.6.cmml" xref="S2.p1.22.m5.6.6"><ci id="S2.p1.22.m5.6.6.2.cmml" xref="S2.p1.22.m5.6.6.2">→</ci><apply id="S2.p1.22.m5.6.6.3.cmml" xref="S2.p1.22.m5.6.6.3"><times id="S2.p1.22.m5.6.6.3.1.cmml" xref="S2.p1.22.m5.6.6.3.1"></times><ci id="S2.p1.22.m5.6.6.3.2.cmml" xref="S2.p1.22.m5.6.6.3.2">𝐸</ci><vector id="S2.p1.22.m5.6.6.3.3.1.cmml" xref="S2.p1.22.m5.6.6.3.3.2"><ci id="S2.p1.22.m5.1.1.cmml" xref="S2.p1.22.m5.1.1">𝑢</ci><ci id="S2.p1.22.m5.2.2.cmml" xref="S2.p1.22.m5.2.2">𝐿</ci><ci id="S2.p1.22.m5.3.3.cmml" xref="S2.p1.22.m5.3.3">bold-italic-ϕ</ci></vector></apply><apply id="S2.p1.22.m5.6.6.1.cmml" xref="S2.p1.22.m5.6.6.1"><times id="S2.p1.22.m5.6.6.1.2.cmml" xref="S2.p1.22.m5.6.6.1.2"></times><ci id="S2.p1.22.m5.6.6.1.3.cmml" xref="S2.p1.22.m5.6.6.1.3">𝑅</ci><vector id="S2.p1.22.m5.6.6.1.1.2.cmml" xref="S2.p1.22.m5.6.6.1.1.1"><ci id="S2.p1.22.m5.4.4.cmml" xref="S2.p1.22.m5.4.4">𝑢</ci><ci id="S2.p1.22.m5.5.5.cmml" xref="S2.p1.22.m5.5.5">𝐿</ci><apply id="S2.p1.22.m5.6.6.1.1.1.1.cmml" xref="S2.p1.22.m5.6.6.1.1.1.1"><csymbol cd="ambiguous" id="S2.p1.22.m5.6.6.1.1.1.1.1.cmml" xref="S2.p1.22.m5.6.6.1.1.1.1">subscript</csymbol><ci id="S2.p1.22.m5.6.6.1.1.1.1.2.cmml" xref="S2.p1.22.m5.6.6.1.1.1.1.2">𝑦</ci><ci id="S2.p1.22.m5.6.6.1.1.1.1.3.cmml" xref="S2.p1.22.m5.6.6.1.1.1.1.3">𝐿</ci></apply></vector></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.p1.22.m5.6c">E(u,L;\boldsymbol{\phi})\to R(u,L,y_{L})</annotation><annotation encoding="application/x-llamapun" id="S2.p1.22.m5.6d">italic_E ( italic_u , italic_L ; bold_italic_ϕ ) → italic_R ( italic_u , italic_L , italic_y start_POSTSUBSCRIPT italic_L end_POSTSUBSCRIPT )</annotation></semantics></math>, where <math alttext="\boldsymbol{\phi}" class="ltx_Math" display="inline" id="S2.p1.23.m6.1"><semantics id="S2.p1.23.m6.1a"><mi class="ltx_mathvariant_bold-italic" id="S2.p1.23.m6.1.1" mathvariant="bold-italic" xref="S2.p1.23.m6.1.1.cmml">ϕ</mi><annotation-xml encoding="MathML-Content" id="S2.p1.23.m6.1b"><ci id="S2.p1.23.m6.1.1.cmml" xref="S2.p1.23.m6.1.1">bold-italic-ϕ</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.p1.23.m6.1c">\boldsymbol{\phi}</annotation><annotation encoding="application/x-llamapun" id="S2.p1.23.m6.1d">bold_italic_ϕ</annotation></semantics></math> is the parameter of <math alttext="E(\cdot)" class="ltx_Math" display="inline" id="S2.p1.24.m7.1"><semantics id="S2.p1.24.m7.1a"><mrow id="S2.p1.24.m7.1.2" xref="S2.p1.24.m7.1.2.cmml"><mi id="S2.p1.24.m7.1.2.2" xref="S2.p1.24.m7.1.2.2.cmml">E</mi><mo id="S2.p1.24.m7.1.2.1" xref="S2.p1.24.m7.1.2.1.cmml">⁢</mo><mrow id="S2.p1.24.m7.1.2.3.2" xref="S2.p1.24.m7.1.2.cmml"><mo id="S2.p1.24.m7.1.2.3.2.1" stretchy="false" xref="S2.p1.24.m7.1.2.cmml">(</mo><mo id="S2.p1.24.m7.1.1" lspace="0em" rspace="0em" xref="S2.p1.24.m7.1.1.cmml">⋅</mo><mo id="S2.p1.24.m7.1.2.3.2.2" stretchy="false" xref="S2.p1.24.m7.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.p1.24.m7.1b"><apply id="S2.p1.24.m7.1.2.cmml" xref="S2.p1.24.m7.1.2"><times id="S2.p1.24.m7.1.2.1.cmml" xref="S2.p1.24.m7.1.2.1"></times><ci id="S2.p1.24.m7.1.2.2.cmml" xref="S2.p1.24.m7.1.2.2">𝐸</ci><ci id="S2.p1.24.m7.1.1.cmml" xref="S2.p1.24.m7.1.1">⋅</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.p1.24.m7.1c">E(\cdot)</annotation><annotation encoding="application/x-llamapun" id="S2.p1.24.m7.1d">italic_E ( ⋅ )</annotation></semantics></math>. The surrogate model is called the evaluator, and it is trained before the actor as</p>
<table class="ltx_equation ltx_eqn_table" id="S2.Ex4">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\underset{\boldsymbol{\phi}}{\min}~{}\mathbb{E}_{u,L}[diff(E(u,L;\boldsymbol{%
\phi}),R(u,L,y_{L}))]." class="ltx_Math" display="block" id="S2.Ex4.m1.8"><semantics id="S2.Ex4.m1.8a"><mrow id="S2.Ex4.m1.8.8.1" xref="S2.Ex4.m1.8.8.1.1.cmml"><mrow id="S2.Ex4.m1.8.8.1.1" xref="S2.Ex4.m1.8.8.1.1.cmml"><munder accentunder="true" id="S2.Ex4.m1.8.8.1.1.3" xref="S2.Ex4.m1.8.8.1.1.3.cmml"><mi id="S2.Ex4.m1.8.8.1.1.3.2" xref="S2.Ex4.m1.8.8.1.1.3.2.cmml">min</mi><mo class="ltx_mathvariant_bold-italic" id="S2.Ex4.m1.8.8.1.1.3.1" mathvariant="bold-italic" xref="S2.Ex4.m1.8.8.1.1.3.1.cmml">ϕ</mo></munder><mo id="S2.Ex4.m1.8.8.1.1.2" lspace="0.497em" xref="S2.Ex4.m1.8.8.1.1.2.cmml">⁢</mo><msub id="S2.Ex4.m1.8.8.1.1.4" xref="S2.Ex4.m1.8.8.1.1.4.cmml"><mi id="S2.Ex4.m1.8.8.1.1.4.2" xref="S2.Ex4.m1.8.8.1.1.4.2.cmml">𝔼</mi><mrow id="S2.Ex4.m1.2.2.2.4" xref="S2.Ex4.m1.2.2.2.3.cmml"><mi id="S2.Ex4.m1.1.1.1.1" xref="S2.Ex4.m1.1.1.1.1.cmml">u</mi><mo id="S2.Ex4.m1.2.2.2.4.1" xref="S2.Ex4.m1.2.2.2.3.cmml">,</mo><mi id="S2.Ex4.m1.2.2.2.2" xref="S2.Ex4.m1.2.2.2.2.cmml">L</mi></mrow></msub><mo id="S2.Ex4.m1.8.8.1.1.2a" xref="S2.Ex4.m1.8.8.1.1.2.cmml">⁢</mo><mrow id="S2.Ex4.m1.8.8.1.1.1.1" xref="S2.Ex4.m1.8.8.1.1.1.2.cmml"><mo id="S2.Ex4.m1.8.8.1.1.1.1.2" stretchy="false" xref="S2.Ex4.m1.8.8.1.1.1.2.1.cmml">[</mo><mrow id="S2.Ex4.m1.8.8.1.1.1.1.1" xref="S2.Ex4.m1.8.8.1.1.1.1.1.cmml"><mi id="S2.Ex4.m1.8.8.1.1.1.1.1.4" xref="S2.Ex4.m1.8.8.1.1.1.1.1.4.cmml">d</mi><mo id="S2.Ex4.m1.8.8.1.1.1.1.1.3" xref="S2.Ex4.m1.8.8.1.1.1.1.1.3.cmml">⁢</mo><mi id="S2.Ex4.m1.8.8.1.1.1.1.1.5" xref="S2.Ex4.m1.8.8.1.1.1.1.1.5.cmml">i</mi><mo id="S2.Ex4.m1.8.8.1.1.1.1.1.3a" xref="S2.Ex4.m1.8.8.1.1.1.1.1.3.cmml">⁢</mo><mi id="S2.Ex4.m1.8.8.1.1.1.1.1.6" xref="S2.Ex4.m1.8.8.1.1.1.1.1.6.cmml">f</mi><mo id="S2.Ex4.m1.8.8.1.1.1.1.1.3b" xref="S2.Ex4.m1.8.8.1.1.1.1.1.3.cmml">⁢</mo><mi id="S2.Ex4.m1.8.8.1.1.1.1.1.7" xref="S2.Ex4.m1.8.8.1.1.1.1.1.7.cmml">f</mi><mo id="S2.Ex4.m1.8.8.1.1.1.1.1.3c" xref="S2.Ex4.m1.8.8.1.1.1.1.1.3.cmml">⁢</mo><mrow id="S2.Ex4.m1.8.8.1.1.1.1.1.2.2" xref="S2.Ex4.m1.8.8.1.1.1.1.1.2.3.cmml"><mo id="S2.Ex4.m1.8.8.1.1.1.1.1.2.2.3" stretchy="false" xref="S2.Ex4.m1.8.8.1.1.1.1.1.2.3.cmml">(</mo><mrow id="S2.Ex4.m1.8.8.1.1.1.1.1.1.1.1" xref="S2.Ex4.m1.8.8.1.1.1.1.1.1.1.1.cmml"><mi id="S2.Ex4.m1.8.8.1.1.1.1.1.1.1.1.2" xref="S2.Ex4.m1.8.8.1.1.1.1.1.1.1.1.2.cmml">E</mi><mo id="S2.Ex4.m1.8.8.1.1.1.1.1.1.1.1.1" xref="S2.Ex4.m1.8.8.1.1.1.1.1.1.1.1.1.cmml">⁢</mo><mrow id="S2.Ex4.m1.8.8.1.1.1.1.1.1.1.1.3.2" xref="S2.Ex4.m1.8.8.1.1.1.1.1.1.1.1.3.1.cmml"><mo id="S2.Ex4.m1.8.8.1.1.1.1.1.1.1.1.3.2.1" stretchy="false" xref="S2.Ex4.m1.8.8.1.1.1.1.1.1.1.1.3.1.cmml">(</mo><mi id="S2.Ex4.m1.3.3" xref="S2.Ex4.m1.3.3.cmml">u</mi><mo id="S2.Ex4.m1.8.8.1.1.1.1.1.1.1.1.3.2.2" xref="S2.Ex4.m1.8.8.1.1.1.1.1.1.1.1.3.1.cmml">,</mo><mi id="S2.Ex4.m1.4.4" xref="S2.Ex4.m1.4.4.cmml">L</mi><mo id="S2.Ex4.m1.8.8.1.1.1.1.1.1.1.1.3.2.3" xref="S2.Ex4.m1.8.8.1.1.1.1.1.1.1.1.3.1.cmml">;</mo><mi class="ltx_mathvariant_bold-italic" id="S2.Ex4.m1.5.5" mathvariant="bold-italic" xref="S2.Ex4.m1.5.5.cmml">ϕ</mi><mo id="S2.Ex4.m1.8.8.1.1.1.1.1.1.1.1.3.2.4" stretchy="false" xref="S2.Ex4.m1.8.8.1.1.1.1.1.1.1.1.3.1.cmml">)</mo></mrow></mrow><mo id="S2.Ex4.m1.8.8.1.1.1.1.1.2.2.4" xref="S2.Ex4.m1.8.8.1.1.1.1.1.2.3.cmml">,</mo><mrow id="S2.Ex4.m1.8.8.1.1.1.1.1.2.2.2" xref="S2.Ex4.m1.8.8.1.1.1.1.1.2.2.2.cmml"><mi id="S2.Ex4.m1.8.8.1.1.1.1.1.2.2.2.3" xref="S2.Ex4.m1.8.8.1.1.1.1.1.2.2.2.3.cmml">R</mi><mo id="S2.Ex4.m1.8.8.1.1.1.1.1.2.2.2.2" xref="S2.Ex4.m1.8.8.1.1.1.1.1.2.2.2.2.cmml">⁢</mo><mrow id="S2.Ex4.m1.8.8.1.1.1.1.1.2.2.2.1.1" xref="S2.Ex4.m1.8.8.1.1.1.1.1.2.2.2.1.2.cmml"><mo id="S2.Ex4.m1.8.8.1.1.1.1.1.2.2.2.1.1.2" stretchy="false" xref="S2.Ex4.m1.8.8.1.1.1.1.1.2.2.2.1.2.cmml">(</mo><mi id="S2.Ex4.m1.6.6" xref="S2.Ex4.m1.6.6.cmml">u</mi><mo id="S2.Ex4.m1.8.8.1.1.1.1.1.2.2.2.1.1.3" xref="S2.Ex4.m1.8.8.1.1.1.1.1.2.2.2.1.2.cmml">,</mo><mi id="S2.Ex4.m1.7.7" xref="S2.Ex4.m1.7.7.cmml">L</mi><mo id="S2.Ex4.m1.8.8.1.1.1.1.1.2.2.2.1.1.4" xref="S2.Ex4.m1.8.8.1.1.1.1.1.2.2.2.1.2.cmml">,</mo><msub id="S2.Ex4.m1.8.8.1.1.1.1.1.2.2.2.1.1.1" xref="S2.Ex4.m1.8.8.1.1.1.1.1.2.2.2.1.1.1.cmml"><mi id="S2.Ex4.m1.8.8.1.1.1.1.1.2.2.2.1.1.1.2" xref="S2.Ex4.m1.8.8.1.1.1.1.1.2.2.2.1.1.1.2.cmml">y</mi><mi id="S2.Ex4.m1.8.8.1.1.1.1.1.2.2.2.1.1.1.3" xref="S2.Ex4.m1.8.8.1.1.1.1.1.2.2.2.1.1.1.3.cmml">L</mi></msub><mo id="S2.Ex4.m1.8.8.1.1.1.1.1.2.2.2.1.1.5" stretchy="false" xref="S2.Ex4.m1.8.8.1.1.1.1.1.2.2.2.1.2.cmml">)</mo></mrow></mrow><mo id="S2.Ex4.m1.8.8.1.1.1.1.1.2.2.5" stretchy="false" xref="S2.Ex4.m1.8.8.1.1.1.1.1.2.3.cmml">)</mo></mrow></mrow><mo id="S2.Ex4.m1.8.8.1.1.1.1.3" stretchy="false" xref="S2.Ex4.m1.8.8.1.1.1.2.1.cmml">]</mo></mrow></mrow><mo id="S2.Ex4.m1.8.8.1.2" lspace="0em" xref="S2.Ex4.m1.8.8.1.1.cmml">.</mo></mrow><annotation-xml encoding="MathML-Content" id="S2.Ex4.m1.8b"><apply id="S2.Ex4.m1.8.8.1.1.cmml" xref="S2.Ex4.m1.8.8.1"><times id="S2.Ex4.m1.8.8.1.1.2.cmml" xref="S2.Ex4.m1.8.8.1.1.2"></times><apply id="S2.Ex4.m1.8.8.1.1.3.cmml" xref="S2.Ex4.m1.8.8.1.1.3"><ci id="S2.Ex4.m1.8.8.1.1.3.1.cmml" xref="S2.Ex4.m1.8.8.1.1.3.1">bold-italic-ϕ</ci><min id="S2.Ex4.m1.8.8.1.1.3.2.cmml" xref="S2.Ex4.m1.8.8.1.1.3.2"></min></apply><apply id="S2.Ex4.m1.8.8.1.1.4.cmml" xref="S2.Ex4.m1.8.8.1.1.4"><csymbol cd="ambiguous" id="S2.Ex4.m1.8.8.1.1.4.1.cmml" xref="S2.Ex4.m1.8.8.1.1.4">subscript</csymbol><ci id="S2.Ex4.m1.8.8.1.1.4.2.cmml" xref="S2.Ex4.m1.8.8.1.1.4.2">𝔼</ci><list id="S2.Ex4.m1.2.2.2.3.cmml" xref="S2.Ex4.m1.2.2.2.4"><ci id="S2.Ex4.m1.1.1.1.1.cmml" xref="S2.Ex4.m1.1.1.1.1">𝑢</ci><ci id="S2.Ex4.m1.2.2.2.2.cmml" xref="S2.Ex4.m1.2.2.2.2">𝐿</ci></list></apply><apply id="S2.Ex4.m1.8.8.1.1.1.2.cmml" xref="S2.Ex4.m1.8.8.1.1.1.1"><csymbol cd="latexml" id="S2.Ex4.m1.8.8.1.1.1.2.1.cmml" xref="S2.Ex4.m1.8.8.1.1.1.1.2">delimited-[]</csymbol><apply id="S2.Ex4.m1.8.8.1.1.1.1.1.cmml" xref="S2.Ex4.m1.8.8.1.1.1.1.1"><times id="S2.Ex4.m1.8.8.1.1.1.1.1.3.cmml" xref="S2.Ex4.m1.8.8.1.1.1.1.1.3"></times><ci id="S2.Ex4.m1.8.8.1.1.1.1.1.4.cmml" xref="S2.Ex4.m1.8.8.1.1.1.1.1.4">𝑑</ci><ci id="S2.Ex4.m1.8.8.1.1.1.1.1.5.cmml" xref="S2.Ex4.m1.8.8.1.1.1.1.1.5">𝑖</ci><ci id="S2.Ex4.m1.8.8.1.1.1.1.1.6.cmml" xref="S2.Ex4.m1.8.8.1.1.1.1.1.6">𝑓</ci><ci id="S2.Ex4.m1.8.8.1.1.1.1.1.7.cmml" xref="S2.Ex4.m1.8.8.1.1.1.1.1.7">𝑓</ci><interval closure="open" id="S2.Ex4.m1.8.8.1.1.1.1.1.2.3.cmml" xref="S2.Ex4.m1.8.8.1.1.1.1.1.2.2"><apply id="S2.Ex4.m1.8.8.1.1.1.1.1.1.1.1.cmml" xref="S2.Ex4.m1.8.8.1.1.1.1.1.1.1.1"><times id="S2.Ex4.m1.8.8.1.1.1.1.1.1.1.1.1.cmml" xref="S2.Ex4.m1.8.8.1.1.1.1.1.1.1.1.1"></times><ci id="S2.Ex4.m1.8.8.1.1.1.1.1.1.1.1.2.cmml" xref="S2.Ex4.m1.8.8.1.1.1.1.1.1.1.1.2">𝐸</ci><vector id="S2.Ex4.m1.8.8.1.1.1.1.1.1.1.1.3.1.cmml" xref="S2.Ex4.m1.8.8.1.1.1.1.1.1.1.1.3.2"><ci id="S2.Ex4.m1.3.3.cmml" xref="S2.Ex4.m1.3.3">𝑢</ci><ci id="S2.Ex4.m1.4.4.cmml" xref="S2.Ex4.m1.4.4">𝐿</ci><ci id="S2.Ex4.m1.5.5.cmml" xref="S2.Ex4.m1.5.5">bold-italic-ϕ</ci></vector></apply><apply id="S2.Ex4.m1.8.8.1.1.1.1.1.2.2.2.cmml" xref="S2.Ex4.m1.8.8.1.1.1.1.1.2.2.2"><times id="S2.Ex4.m1.8.8.1.1.1.1.1.2.2.2.2.cmml" xref="S2.Ex4.m1.8.8.1.1.1.1.1.2.2.2.2"></times><ci id="S2.Ex4.m1.8.8.1.1.1.1.1.2.2.2.3.cmml" xref="S2.Ex4.m1.8.8.1.1.1.1.1.2.2.2.3">𝑅</ci><vector id="S2.Ex4.m1.8.8.1.1.1.1.1.2.2.2.1.2.cmml" xref="S2.Ex4.m1.8.8.1.1.1.1.1.2.2.2.1.1"><ci id="S2.Ex4.m1.6.6.cmml" xref="S2.Ex4.m1.6.6">𝑢</ci><ci id="S2.Ex4.m1.7.7.cmml" xref="S2.Ex4.m1.7.7">𝐿</ci><apply id="S2.Ex4.m1.8.8.1.1.1.1.1.2.2.2.1.1.1.cmml" xref="S2.Ex4.m1.8.8.1.1.1.1.1.2.2.2.1.1.1"><csymbol cd="ambiguous" id="S2.Ex4.m1.8.8.1.1.1.1.1.2.2.2.1.1.1.1.cmml" xref="S2.Ex4.m1.8.8.1.1.1.1.1.2.2.2.1.1.1">subscript</csymbol><ci id="S2.Ex4.m1.8.8.1.1.1.1.1.2.2.2.1.1.1.2.cmml" xref="S2.Ex4.m1.8.8.1.1.1.1.1.2.2.2.1.1.1.2">𝑦</ci><ci id="S2.Ex4.m1.8.8.1.1.1.1.1.2.2.2.1.1.1.3.cmml" xref="S2.Ex4.m1.8.8.1.1.1.1.1.2.2.2.1.1.1.3">𝐿</ci></apply></vector></apply></interval></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.Ex4.m1.8c">\underset{\boldsymbol{\phi}}{\min}~{}\mathbb{E}_{u,L}[diff(E(u,L;\boldsymbol{%
\phi}),R(u,L,y_{L}))].</annotation><annotation encoding="application/x-llamapun" id="S2.Ex4.m1.8d">underbold_italic_ϕ start_ARG roman_min end_ARG blackboard_E start_POSTSUBSCRIPT italic_u , italic_L end_POSTSUBSCRIPT [ italic_d italic_i italic_f italic_f ( italic_E ( italic_u , italic_L ; bold_italic_ϕ ) , italic_R ( italic_u , italic_L , italic_y start_POSTSUBSCRIPT italic_L end_POSTSUBSCRIPT ) ) ] .</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S2.p1.26">Notably, the evaluator learns how to predict user feedback during the training process.
Then, the training of the actor becomes:</p>
<table class="ltx_equation ltx_eqn_table" id="S2.Ex5">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\underset{\boldsymbol{\theta}}{\max}~{}\mathbb{E}_{u,\mathcal{C}}[E(u,G(u,%
\mathcal{C};\boldsymbol{\theta}))]." class="ltx_Math" display="block" id="S2.Ex5.m1.7"><semantics id="S2.Ex5.m1.7a"><mrow id="S2.Ex5.m1.7.7.1" xref="S2.Ex5.m1.7.7.1.1.cmml"><mrow id="S2.Ex5.m1.7.7.1.1" xref="S2.Ex5.m1.7.7.1.1.cmml"><munder accentunder="true" id="S2.Ex5.m1.7.7.1.1.3" xref="S2.Ex5.m1.7.7.1.1.3.cmml"><mi id="S2.Ex5.m1.7.7.1.1.3.2" xref="S2.Ex5.m1.7.7.1.1.3.2.cmml">max</mi><mo id="S2.Ex5.m1.7.7.1.1.3.1" xref="S2.Ex5.m1.7.7.1.1.3.1.cmml">𝜽</mo></munder><mo id="S2.Ex5.m1.7.7.1.1.2" lspace="0.497em" xref="S2.Ex5.m1.7.7.1.1.2.cmml">⁢</mo><msub id="S2.Ex5.m1.7.7.1.1.4" xref="S2.Ex5.m1.7.7.1.1.4.cmml"><mi id="S2.Ex5.m1.7.7.1.1.4.2" xref="S2.Ex5.m1.7.7.1.1.4.2.cmml">𝔼</mi><mrow id="S2.Ex5.m1.2.2.2.4" xref="S2.Ex5.m1.2.2.2.3.cmml"><mi id="S2.Ex5.m1.1.1.1.1" xref="S2.Ex5.m1.1.1.1.1.cmml">u</mi><mo id="S2.Ex5.m1.2.2.2.4.1" xref="S2.Ex5.m1.2.2.2.3.cmml">,</mo><mi class="ltx_font_mathcaligraphic" id="S2.Ex5.m1.2.2.2.2" xref="S2.Ex5.m1.2.2.2.2.cmml">𝒞</mi></mrow></msub><mo id="S2.Ex5.m1.7.7.1.1.2a" xref="S2.Ex5.m1.7.7.1.1.2.cmml">⁢</mo><mrow id="S2.Ex5.m1.7.7.1.1.1.1" xref="S2.Ex5.m1.7.7.1.1.1.2.cmml"><mo id="S2.Ex5.m1.7.7.1.1.1.1.2" stretchy="false" xref="S2.Ex5.m1.7.7.1.1.1.2.1.cmml">[</mo><mrow id="S2.Ex5.m1.7.7.1.1.1.1.1" xref="S2.Ex5.m1.7.7.1.1.1.1.1.cmml"><mi id="S2.Ex5.m1.7.7.1.1.1.1.1.3" xref="S2.Ex5.m1.7.7.1.1.1.1.1.3.cmml">E</mi><mo id="S2.Ex5.m1.7.7.1.1.1.1.1.2" xref="S2.Ex5.m1.7.7.1.1.1.1.1.2.cmml">⁢</mo><mrow id="S2.Ex5.m1.7.7.1.1.1.1.1.1.1" xref="S2.Ex5.m1.7.7.1.1.1.1.1.1.2.cmml"><mo id="S2.Ex5.m1.7.7.1.1.1.1.1.1.1.2" stretchy="false" xref="S2.Ex5.m1.7.7.1.1.1.1.1.1.2.cmml">(</mo><mi id="S2.Ex5.m1.6.6" xref="S2.Ex5.m1.6.6.cmml">u</mi><mo id="S2.Ex5.m1.7.7.1.1.1.1.1.1.1.3" xref="S2.Ex5.m1.7.7.1.1.1.1.1.1.2.cmml">,</mo><mrow id="S2.Ex5.m1.7.7.1.1.1.1.1.1.1.1" xref="S2.Ex5.m1.7.7.1.1.1.1.1.1.1.1.cmml"><mi id="S2.Ex5.m1.7.7.1.1.1.1.1.1.1.1.2" xref="S2.Ex5.m1.7.7.1.1.1.1.1.1.1.1.2.cmml">G</mi><mo id="S2.Ex5.m1.7.7.1.1.1.1.1.1.1.1.1" xref="S2.Ex5.m1.7.7.1.1.1.1.1.1.1.1.1.cmml">⁢</mo><mrow id="S2.Ex5.m1.7.7.1.1.1.1.1.1.1.1.3.2" xref="S2.Ex5.m1.7.7.1.1.1.1.1.1.1.1.3.1.cmml"><mo id="S2.Ex5.m1.7.7.1.1.1.1.1.1.1.1.3.2.1" stretchy="false" xref="S2.Ex5.m1.7.7.1.1.1.1.1.1.1.1.3.1.cmml">(</mo><mi id="S2.Ex5.m1.3.3" xref="S2.Ex5.m1.3.3.cmml">u</mi><mo id="S2.Ex5.m1.7.7.1.1.1.1.1.1.1.1.3.2.2" xref="S2.Ex5.m1.7.7.1.1.1.1.1.1.1.1.3.1.cmml">,</mo><mi class="ltx_font_mathcaligraphic" id="S2.Ex5.m1.4.4" xref="S2.Ex5.m1.4.4.cmml">𝒞</mi><mo id="S2.Ex5.m1.7.7.1.1.1.1.1.1.1.1.3.2.3" xref="S2.Ex5.m1.7.7.1.1.1.1.1.1.1.1.3.1.cmml">;</mo><mi id="S2.Ex5.m1.5.5" xref="S2.Ex5.m1.5.5.cmml">𝜽</mi><mo id="S2.Ex5.m1.7.7.1.1.1.1.1.1.1.1.3.2.4" stretchy="false" xref="S2.Ex5.m1.7.7.1.1.1.1.1.1.1.1.3.1.cmml">)</mo></mrow></mrow><mo id="S2.Ex5.m1.7.7.1.1.1.1.1.1.1.4" stretchy="false" xref="S2.Ex5.m1.7.7.1.1.1.1.1.1.2.cmml">)</mo></mrow></mrow><mo id="S2.Ex5.m1.7.7.1.1.1.1.3" stretchy="false" xref="S2.Ex5.m1.7.7.1.1.1.2.1.cmml">]</mo></mrow></mrow><mo id="S2.Ex5.m1.7.7.1.2" lspace="0em" xref="S2.Ex5.m1.7.7.1.1.cmml">.</mo></mrow><annotation-xml encoding="MathML-Content" id="S2.Ex5.m1.7b"><apply id="S2.Ex5.m1.7.7.1.1.cmml" xref="S2.Ex5.m1.7.7.1"><times id="S2.Ex5.m1.7.7.1.1.2.cmml" xref="S2.Ex5.m1.7.7.1.1.2"></times><apply id="S2.Ex5.m1.7.7.1.1.3.cmml" xref="S2.Ex5.m1.7.7.1.1.3"><ci id="S2.Ex5.m1.7.7.1.1.3.1.cmml" xref="S2.Ex5.m1.7.7.1.1.3.1">𝜽</ci><max id="S2.Ex5.m1.7.7.1.1.3.2.cmml" xref="S2.Ex5.m1.7.7.1.1.3.2"></max></apply><apply id="S2.Ex5.m1.7.7.1.1.4.cmml" xref="S2.Ex5.m1.7.7.1.1.4"><csymbol cd="ambiguous" id="S2.Ex5.m1.7.7.1.1.4.1.cmml" xref="S2.Ex5.m1.7.7.1.1.4">subscript</csymbol><ci id="S2.Ex5.m1.7.7.1.1.4.2.cmml" xref="S2.Ex5.m1.7.7.1.1.4.2">𝔼</ci><list id="S2.Ex5.m1.2.2.2.3.cmml" xref="S2.Ex5.m1.2.2.2.4"><ci id="S2.Ex5.m1.1.1.1.1.cmml" xref="S2.Ex5.m1.1.1.1.1">𝑢</ci><ci id="S2.Ex5.m1.2.2.2.2.cmml" xref="S2.Ex5.m1.2.2.2.2">𝒞</ci></list></apply><apply id="S2.Ex5.m1.7.7.1.1.1.2.cmml" xref="S2.Ex5.m1.7.7.1.1.1.1"><csymbol cd="latexml" id="S2.Ex5.m1.7.7.1.1.1.2.1.cmml" xref="S2.Ex5.m1.7.7.1.1.1.1.2">delimited-[]</csymbol><apply id="S2.Ex5.m1.7.7.1.1.1.1.1.cmml" xref="S2.Ex5.m1.7.7.1.1.1.1.1"><times id="S2.Ex5.m1.7.7.1.1.1.1.1.2.cmml" xref="S2.Ex5.m1.7.7.1.1.1.1.1.2"></times><ci id="S2.Ex5.m1.7.7.1.1.1.1.1.3.cmml" xref="S2.Ex5.m1.7.7.1.1.1.1.1.3">𝐸</ci><interval closure="open" id="S2.Ex5.m1.7.7.1.1.1.1.1.1.2.cmml" xref="S2.Ex5.m1.7.7.1.1.1.1.1.1.1"><ci id="S2.Ex5.m1.6.6.cmml" xref="S2.Ex5.m1.6.6">𝑢</ci><apply id="S2.Ex5.m1.7.7.1.1.1.1.1.1.1.1.cmml" xref="S2.Ex5.m1.7.7.1.1.1.1.1.1.1.1"><times id="S2.Ex5.m1.7.7.1.1.1.1.1.1.1.1.1.cmml" xref="S2.Ex5.m1.7.7.1.1.1.1.1.1.1.1.1"></times><ci id="S2.Ex5.m1.7.7.1.1.1.1.1.1.1.1.2.cmml" xref="S2.Ex5.m1.7.7.1.1.1.1.1.1.1.1.2">𝐺</ci><vector id="S2.Ex5.m1.7.7.1.1.1.1.1.1.1.1.3.1.cmml" xref="S2.Ex5.m1.7.7.1.1.1.1.1.1.1.1.3.2"><ci id="S2.Ex5.m1.3.3.cmml" xref="S2.Ex5.m1.3.3">𝑢</ci><ci id="S2.Ex5.m1.4.4.cmml" xref="S2.Ex5.m1.4.4">𝒞</ci><ci id="S2.Ex5.m1.5.5.cmml" xref="S2.Ex5.m1.5.5">𝜽</ci></vector></apply></interval></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.Ex5.m1.7c">\underset{\boldsymbol{\theta}}{\max}~{}\mathbb{E}_{u,\mathcal{C}}[E(u,G(u,%
\mathcal{C};\boldsymbol{\theta}))].</annotation><annotation encoding="application/x-llamapun" id="S2.Ex5.m1.7d">underbold_italic_θ start_ARG roman_max end_ARG blackboard_E start_POSTSUBSCRIPT italic_u , caligraphic_C end_POSTSUBSCRIPT [ italic_E ( italic_u , italic_G ( italic_u , caligraphic_C ; bold_italic_θ ) ) ] .</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S2.p1.25">It is crucial to see that the whole offline training process of the actor does not directly depend on user feedback, given the evaluator <math alttext="E(\cdot)" class="ltx_Math" display="inline" id="S2.p1.25.m1.1"><semantics id="S2.p1.25.m1.1a"><mrow id="S2.p1.25.m1.1.2" xref="S2.p1.25.m1.1.2.cmml"><mi id="S2.p1.25.m1.1.2.2" xref="S2.p1.25.m1.1.2.2.cmml">E</mi><mo id="S2.p1.25.m1.1.2.1" xref="S2.p1.25.m1.1.2.1.cmml">⁢</mo><mrow id="S2.p1.25.m1.1.2.3.2" xref="S2.p1.25.m1.1.2.cmml"><mo id="S2.p1.25.m1.1.2.3.2.1" stretchy="false" xref="S2.p1.25.m1.1.2.cmml">(</mo><mo id="S2.p1.25.m1.1.1" lspace="0em" rspace="0em" xref="S2.p1.25.m1.1.1.cmml">⋅</mo><mo id="S2.p1.25.m1.1.2.3.2.2" stretchy="false" xref="S2.p1.25.m1.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.p1.25.m1.1b"><apply id="S2.p1.25.m1.1.2.cmml" xref="S2.p1.25.m1.1.2"><times id="S2.p1.25.m1.1.2.1.cmml" xref="S2.p1.25.m1.1.2.1"></times><ci id="S2.p1.25.m1.1.2.2.cmml" xref="S2.p1.25.m1.1.2.2">𝐸</ci><ci id="S2.p1.25.m1.1.1.cmml" xref="S2.p1.25.m1.1.1">⋅</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.p1.25.m1.1c">E(\cdot)</annotation><annotation encoding="application/x-llamapun" id="S2.p1.25.m1.1d">italic_E ( ⋅ )</annotation></semantics></math>.</p>
</div>
</section>
<section class="ltx_section" id="S3">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">3. </span>LAST: The Proposed Method</h2>
<figure class="ltx_figure" id="S3.F2"><img alt="Refer to caption" class="ltx_graphics ltx_img_landscape" height="171" id="S3.F2.g1" src="extracted/5679954/LAST_framework_v2.png" width="287"/>
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure"><span class="ltx_text" id="S3.F2.2.1.1" style="font-size:90%;">Figure 2</span>. </span><span class="ltx_text" id="S3.F2.3.2" style="font-size:90%;">Online serving processes of re-ranking models. (a) The traditional re-ranking models. The model generates a recommendation list based on its fixed policy and presents the list directly to the user. (b) The cascade version of LAST. The actor interacts with the evaluator iteratively to improve its list-generating policy for higher evaluations. The list generated in the last iteration is presented to the user. (c) The parallel version of LAST. A separate gradient exploration module suggests potential model modifications. The actor tries out the suggestions, and the evaluator estimates their quality. The list with the highest evaluation is presented to the user.</span></figcaption>
</figure>
<div class="ltx_para" id="S3.p1">
<p class="ltx_p" id="S3.p1.2">Classic online learning methods rely on the real user feedback, which can be delayed by hours or even days, such as item purchases. LAST ensures continuous model optimization and fine-grained model adaptation even in the absence of user feedback. When a user request, denoted as <math alttext="(u,\mathcal{C})" class="ltx_Math" display="inline" id="S3.p1.1.m1.2"><semantics id="S3.p1.1.m1.2a"><mrow id="S3.p1.1.m1.2.3.2" xref="S3.p1.1.m1.2.3.1.cmml"><mo id="S3.p1.1.m1.2.3.2.1" stretchy="false" xref="S3.p1.1.m1.2.3.1.cmml">(</mo><mi id="S3.p1.1.m1.1.1" xref="S3.p1.1.m1.1.1.cmml">u</mi><mo id="S3.p1.1.m1.2.3.2.2" xref="S3.p1.1.m1.2.3.1.cmml">,</mo><mi class="ltx_font_mathcaligraphic" id="S3.p1.1.m1.2.2" xref="S3.p1.1.m1.2.2.cmml">𝒞</mi><mo id="S3.p1.1.m1.2.3.2.3" stretchy="false" xref="S3.p1.1.m1.2.3.1.cmml">)</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.p1.1.m1.2b"><interval closure="open" id="S3.p1.1.m1.2.3.1.cmml" xref="S3.p1.1.m1.2.3.2"><ci id="S3.p1.1.m1.1.1.cmml" xref="S3.p1.1.m1.1.1">𝑢</ci><ci id="S3.p1.1.m1.2.2.cmml" xref="S3.p1.1.m1.2.2">𝒞</ci></interval></annotation-xml><annotation encoding="application/x-tex" id="S3.p1.1.m1.2c">(u,\mathcal{C})</annotation><annotation encoding="application/x-llamapun" id="S3.p1.1.m1.2d">( italic_u , caligraphic_C )</annotation></semantics></math>, is received, LAST adds a request-specific disposable modification, <math alttext="\Delta\boldsymbol{\theta}" class="ltx_Math" display="inline" id="S3.p1.2.m2.1"><semantics id="S3.p1.2.m2.1a"><mrow id="S3.p1.2.m2.1.1" xref="S3.p1.2.m2.1.1.cmml"><mi id="S3.p1.2.m2.1.1.2" mathvariant="normal" xref="S3.p1.2.m2.1.1.2.cmml">Δ</mi><mo id="S3.p1.2.m2.1.1.1" xref="S3.p1.2.m2.1.1.1.cmml">⁢</mo><mi id="S3.p1.2.m2.1.1.3" xref="S3.p1.2.m2.1.1.3.cmml">𝜽</mi></mrow><annotation-xml encoding="MathML-Content" id="S3.p1.2.m2.1b"><apply id="S3.p1.2.m2.1.1.cmml" xref="S3.p1.2.m2.1.1"><times id="S3.p1.2.m2.1.1.1.cmml" xref="S3.p1.2.m2.1.1.1"></times><ci id="S3.p1.2.m2.1.1.2.cmml" xref="S3.p1.2.m2.1.1.2">Δ</ci><ci id="S3.p1.2.m2.1.1.3.cmml" xref="S3.p1.2.m2.1.1.3">𝜽</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p1.2.m2.1c">\Delta\boldsymbol{\theta}</annotation><annotation encoding="application/x-llamapun" id="S3.p1.2.m2.1d">roman_Δ bold_italic_θ</annotation></semantics></math>, to enhance the deployed model:</p>
<table class="ltx_equation ltx_eqn_table" id="S3.Ex6">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\widehat{L^{*}}_{LAST}=G(u,\mathcal{C};\boldsymbol{\theta}+\Delta\boldsymbol{%
\theta}^{*}(u,\mathcal{C}))." class="ltx_Math" display="block" id="S3.Ex6.m1.5"><semantics id="S3.Ex6.m1.5a"><mrow id="S3.Ex6.m1.5.5.1" xref="S3.Ex6.m1.5.5.1.1.cmml"><mrow id="S3.Ex6.m1.5.5.1.1" xref="S3.Ex6.m1.5.5.1.1.cmml"><msub id="S3.Ex6.m1.5.5.1.1.3" xref="S3.Ex6.m1.5.5.1.1.3.cmml"><mover accent="true" id="S3.Ex6.m1.5.5.1.1.3.2" xref="S3.Ex6.m1.5.5.1.1.3.2.cmml"><msup id="S3.Ex6.m1.5.5.1.1.3.2.2" xref="S3.Ex6.m1.5.5.1.1.3.2.2.cmml"><mi id="S3.Ex6.m1.5.5.1.1.3.2.2.2" xref="S3.Ex6.m1.5.5.1.1.3.2.2.2.cmml">L</mi><mo id="S3.Ex6.m1.5.5.1.1.3.2.2.3" xref="S3.Ex6.m1.5.5.1.1.3.2.2.3.cmml">∗</mo></msup><mo id="S3.Ex6.m1.5.5.1.1.3.2.1" xref="S3.Ex6.m1.5.5.1.1.3.2.1.cmml">^</mo></mover><mrow id="S3.Ex6.m1.5.5.1.1.3.3" xref="S3.Ex6.m1.5.5.1.1.3.3.cmml"><mi id="S3.Ex6.m1.5.5.1.1.3.3.2" xref="S3.Ex6.m1.5.5.1.1.3.3.2.cmml">L</mi><mo id="S3.Ex6.m1.5.5.1.1.3.3.1" xref="S3.Ex6.m1.5.5.1.1.3.3.1.cmml">⁢</mo><mi id="S3.Ex6.m1.5.5.1.1.3.3.3" xref="S3.Ex6.m1.5.5.1.1.3.3.3.cmml">A</mi><mo id="S3.Ex6.m1.5.5.1.1.3.3.1a" xref="S3.Ex6.m1.5.5.1.1.3.3.1.cmml">⁢</mo><mi id="S3.Ex6.m1.5.5.1.1.3.3.4" xref="S3.Ex6.m1.5.5.1.1.3.3.4.cmml">S</mi><mo id="S3.Ex6.m1.5.5.1.1.3.3.1b" xref="S3.Ex6.m1.5.5.1.1.3.3.1.cmml">⁢</mo><mi id="S3.Ex6.m1.5.5.1.1.3.3.5" xref="S3.Ex6.m1.5.5.1.1.3.3.5.cmml">T</mi></mrow></msub><mo id="S3.Ex6.m1.5.5.1.1.2" xref="S3.Ex6.m1.5.5.1.1.2.cmml">=</mo><mrow id="S3.Ex6.m1.5.5.1.1.1" xref="S3.Ex6.m1.5.5.1.1.1.cmml"><mi id="S3.Ex6.m1.5.5.1.1.1.3" xref="S3.Ex6.m1.5.5.1.1.1.3.cmml">G</mi><mo id="S3.Ex6.m1.5.5.1.1.1.2" xref="S3.Ex6.m1.5.5.1.1.1.2.cmml">⁢</mo><mrow id="S3.Ex6.m1.5.5.1.1.1.1.1" xref="S3.Ex6.m1.5.5.1.1.1.1.2.cmml"><mo id="S3.Ex6.m1.5.5.1.1.1.1.1.2" stretchy="false" xref="S3.Ex6.m1.5.5.1.1.1.1.2.cmml">(</mo><mi id="S3.Ex6.m1.3.3" xref="S3.Ex6.m1.3.3.cmml">u</mi><mo id="S3.Ex6.m1.5.5.1.1.1.1.1.3" xref="S3.Ex6.m1.5.5.1.1.1.1.2.cmml">,</mo><mi class="ltx_font_mathcaligraphic" id="S3.Ex6.m1.4.4" xref="S3.Ex6.m1.4.4.cmml">𝒞</mi><mo id="S3.Ex6.m1.5.5.1.1.1.1.1.4" xref="S3.Ex6.m1.5.5.1.1.1.1.2.cmml">;</mo><mrow id="S3.Ex6.m1.5.5.1.1.1.1.1.1" xref="S3.Ex6.m1.5.5.1.1.1.1.1.1.cmml"><mi id="S3.Ex6.m1.5.5.1.1.1.1.1.1.2" xref="S3.Ex6.m1.5.5.1.1.1.1.1.1.2.cmml">𝜽</mi><mo id="S3.Ex6.m1.5.5.1.1.1.1.1.1.1" xref="S3.Ex6.m1.5.5.1.1.1.1.1.1.1.cmml">+</mo><mrow id="S3.Ex6.m1.5.5.1.1.1.1.1.1.3" xref="S3.Ex6.m1.5.5.1.1.1.1.1.1.3.cmml"><mi id="S3.Ex6.m1.5.5.1.1.1.1.1.1.3.2" mathvariant="normal" xref="S3.Ex6.m1.5.5.1.1.1.1.1.1.3.2.cmml">Δ</mi><mo id="S3.Ex6.m1.5.5.1.1.1.1.1.1.3.1" xref="S3.Ex6.m1.5.5.1.1.1.1.1.1.3.1.cmml">⁢</mo><msup id="S3.Ex6.m1.5.5.1.1.1.1.1.1.3.3" xref="S3.Ex6.m1.5.5.1.1.1.1.1.1.3.3.cmml"><mi id="S3.Ex6.m1.5.5.1.1.1.1.1.1.3.3.2" xref="S3.Ex6.m1.5.5.1.1.1.1.1.1.3.3.2.cmml">𝜽</mi><mo id="S3.Ex6.m1.5.5.1.1.1.1.1.1.3.3.3" xref="S3.Ex6.m1.5.5.1.1.1.1.1.1.3.3.3.cmml">∗</mo></msup><mo id="S3.Ex6.m1.5.5.1.1.1.1.1.1.3.1a" xref="S3.Ex6.m1.5.5.1.1.1.1.1.1.3.1.cmml">⁢</mo><mrow id="S3.Ex6.m1.5.5.1.1.1.1.1.1.3.4.2" xref="S3.Ex6.m1.5.5.1.1.1.1.1.1.3.4.1.cmml"><mo id="S3.Ex6.m1.5.5.1.1.1.1.1.1.3.4.2.1" stretchy="false" xref="S3.Ex6.m1.5.5.1.1.1.1.1.1.3.4.1.cmml">(</mo><mi id="S3.Ex6.m1.1.1" xref="S3.Ex6.m1.1.1.cmml">u</mi><mo id="S3.Ex6.m1.5.5.1.1.1.1.1.1.3.4.2.2" xref="S3.Ex6.m1.5.5.1.1.1.1.1.1.3.4.1.cmml">,</mo><mi class="ltx_font_mathcaligraphic" id="S3.Ex6.m1.2.2" xref="S3.Ex6.m1.2.2.cmml">𝒞</mi><mo id="S3.Ex6.m1.5.5.1.1.1.1.1.1.3.4.2.3" stretchy="false" xref="S3.Ex6.m1.5.5.1.1.1.1.1.1.3.4.1.cmml">)</mo></mrow></mrow></mrow><mo id="S3.Ex6.m1.5.5.1.1.1.1.1.5" stretchy="false" xref="S3.Ex6.m1.5.5.1.1.1.1.2.cmml">)</mo></mrow></mrow></mrow><mo id="S3.Ex6.m1.5.5.1.2" lspace="0em" xref="S3.Ex6.m1.5.5.1.1.cmml">.</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.Ex6.m1.5b"><apply id="S3.Ex6.m1.5.5.1.1.cmml" xref="S3.Ex6.m1.5.5.1"><eq id="S3.Ex6.m1.5.5.1.1.2.cmml" xref="S3.Ex6.m1.5.5.1.1.2"></eq><apply id="S3.Ex6.m1.5.5.1.1.3.cmml" xref="S3.Ex6.m1.5.5.1.1.3"><csymbol cd="ambiguous" id="S3.Ex6.m1.5.5.1.1.3.1.cmml" xref="S3.Ex6.m1.5.5.1.1.3">subscript</csymbol><apply id="S3.Ex6.m1.5.5.1.1.3.2.cmml" xref="S3.Ex6.m1.5.5.1.1.3.2"><ci id="S3.Ex6.m1.5.5.1.1.3.2.1.cmml" xref="S3.Ex6.m1.5.5.1.1.3.2.1">^</ci><apply id="S3.Ex6.m1.5.5.1.1.3.2.2.cmml" xref="S3.Ex6.m1.5.5.1.1.3.2.2"><csymbol cd="ambiguous" id="S3.Ex6.m1.5.5.1.1.3.2.2.1.cmml" xref="S3.Ex6.m1.5.5.1.1.3.2.2">superscript</csymbol><ci id="S3.Ex6.m1.5.5.1.1.3.2.2.2.cmml" xref="S3.Ex6.m1.5.5.1.1.3.2.2.2">𝐿</ci><times id="S3.Ex6.m1.5.5.1.1.3.2.2.3.cmml" xref="S3.Ex6.m1.5.5.1.1.3.2.2.3"></times></apply></apply><apply id="S3.Ex6.m1.5.5.1.1.3.3.cmml" xref="S3.Ex6.m1.5.5.1.1.3.3"><times id="S3.Ex6.m1.5.5.1.1.3.3.1.cmml" xref="S3.Ex6.m1.5.5.1.1.3.3.1"></times><ci id="S3.Ex6.m1.5.5.1.1.3.3.2.cmml" xref="S3.Ex6.m1.5.5.1.1.3.3.2">𝐿</ci><ci id="S3.Ex6.m1.5.5.1.1.3.3.3.cmml" xref="S3.Ex6.m1.5.5.1.1.3.3.3">𝐴</ci><ci id="S3.Ex6.m1.5.5.1.1.3.3.4.cmml" xref="S3.Ex6.m1.5.5.1.1.3.3.4">𝑆</ci><ci id="S3.Ex6.m1.5.5.1.1.3.3.5.cmml" xref="S3.Ex6.m1.5.5.1.1.3.3.5">𝑇</ci></apply></apply><apply id="S3.Ex6.m1.5.5.1.1.1.cmml" xref="S3.Ex6.m1.5.5.1.1.1"><times id="S3.Ex6.m1.5.5.1.1.1.2.cmml" xref="S3.Ex6.m1.5.5.1.1.1.2"></times><ci id="S3.Ex6.m1.5.5.1.1.1.3.cmml" xref="S3.Ex6.m1.5.5.1.1.1.3">𝐺</ci><vector id="S3.Ex6.m1.5.5.1.1.1.1.2.cmml" xref="S3.Ex6.m1.5.5.1.1.1.1.1"><ci id="S3.Ex6.m1.3.3.cmml" xref="S3.Ex6.m1.3.3">𝑢</ci><ci id="S3.Ex6.m1.4.4.cmml" xref="S3.Ex6.m1.4.4">𝒞</ci><apply id="S3.Ex6.m1.5.5.1.1.1.1.1.1.cmml" xref="S3.Ex6.m1.5.5.1.1.1.1.1.1"><plus id="S3.Ex6.m1.5.5.1.1.1.1.1.1.1.cmml" xref="S3.Ex6.m1.5.5.1.1.1.1.1.1.1"></plus><ci id="S3.Ex6.m1.5.5.1.1.1.1.1.1.2.cmml" xref="S3.Ex6.m1.5.5.1.1.1.1.1.1.2">𝜽</ci><apply id="S3.Ex6.m1.5.5.1.1.1.1.1.1.3.cmml" xref="S3.Ex6.m1.5.5.1.1.1.1.1.1.3"><times id="S3.Ex6.m1.5.5.1.1.1.1.1.1.3.1.cmml" xref="S3.Ex6.m1.5.5.1.1.1.1.1.1.3.1"></times><ci id="S3.Ex6.m1.5.5.1.1.1.1.1.1.3.2.cmml" xref="S3.Ex6.m1.5.5.1.1.1.1.1.1.3.2">Δ</ci><apply id="S3.Ex6.m1.5.5.1.1.1.1.1.1.3.3.cmml" xref="S3.Ex6.m1.5.5.1.1.1.1.1.1.3.3"><csymbol cd="ambiguous" id="S3.Ex6.m1.5.5.1.1.1.1.1.1.3.3.1.cmml" xref="S3.Ex6.m1.5.5.1.1.1.1.1.1.3.3">superscript</csymbol><ci id="S3.Ex6.m1.5.5.1.1.1.1.1.1.3.3.2.cmml" xref="S3.Ex6.m1.5.5.1.1.1.1.1.1.3.3.2">𝜽</ci><times id="S3.Ex6.m1.5.5.1.1.1.1.1.1.3.3.3.cmml" xref="S3.Ex6.m1.5.5.1.1.1.1.1.1.3.3.3"></times></apply><interval closure="open" id="S3.Ex6.m1.5.5.1.1.1.1.1.1.3.4.1.cmml" xref="S3.Ex6.m1.5.5.1.1.1.1.1.1.3.4.2"><ci id="S3.Ex6.m1.1.1.cmml" xref="S3.Ex6.m1.1.1">𝑢</ci><ci id="S3.Ex6.m1.2.2.cmml" xref="S3.Ex6.m1.2.2">𝒞</ci></interval></apply></apply></vector></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.Ex6.m1.5c">\widehat{L^{*}}_{LAST}=G(u,\mathcal{C};\boldsymbol{\theta}+\Delta\boldsymbol{%
\theta}^{*}(u,\mathcal{C})).</annotation><annotation encoding="application/x-llamapun" id="S3.Ex6.m1.5d">over^ start_ARG italic_L start_POSTSUPERSCRIPT ∗ end_POSTSUPERSCRIPT end_ARG start_POSTSUBSCRIPT italic_L italic_A italic_S italic_T end_POSTSUBSCRIPT = italic_G ( italic_u , caligraphic_C ; bold_italic_θ + roman_Δ bold_italic_θ start_POSTSUPERSCRIPT ∗ end_POSTSUPERSCRIPT ( italic_u , caligraphic_C ) ) .</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S3.p1.3">The optimal modification <math alttext="\Delta\boldsymbol{\theta}^{*}(u,\mathcal{C})" class="ltx_Math" display="inline" id="S3.p1.3.m1.2"><semantics id="S3.p1.3.m1.2a"><mrow id="S3.p1.3.m1.2.3" xref="S3.p1.3.m1.2.3.cmml"><mi id="S3.p1.3.m1.2.3.2" mathvariant="normal" xref="S3.p1.3.m1.2.3.2.cmml">Δ</mi><mo id="S3.p1.3.m1.2.3.1" xref="S3.p1.3.m1.2.3.1.cmml">⁢</mo><msup id="S3.p1.3.m1.2.3.3" xref="S3.p1.3.m1.2.3.3.cmml"><mi id="S3.p1.3.m1.2.3.3.2" xref="S3.p1.3.m1.2.3.3.2.cmml">𝜽</mi><mo id="S3.p1.3.m1.2.3.3.3" xref="S3.p1.3.m1.2.3.3.3.cmml">∗</mo></msup><mo id="S3.p1.3.m1.2.3.1a" xref="S3.p1.3.m1.2.3.1.cmml">⁢</mo><mrow id="S3.p1.3.m1.2.3.4.2" xref="S3.p1.3.m1.2.3.4.1.cmml"><mo id="S3.p1.3.m1.2.3.4.2.1" stretchy="false" xref="S3.p1.3.m1.2.3.4.1.cmml">(</mo><mi id="S3.p1.3.m1.1.1" xref="S3.p1.3.m1.1.1.cmml">u</mi><mo id="S3.p1.3.m1.2.3.4.2.2" xref="S3.p1.3.m1.2.3.4.1.cmml">,</mo><mi class="ltx_font_mathcaligraphic" id="S3.p1.3.m1.2.2" xref="S3.p1.3.m1.2.2.cmml">𝒞</mi><mo id="S3.p1.3.m1.2.3.4.2.3" stretchy="false" xref="S3.p1.3.m1.2.3.4.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.p1.3.m1.2b"><apply id="S3.p1.3.m1.2.3.cmml" xref="S3.p1.3.m1.2.3"><times id="S3.p1.3.m1.2.3.1.cmml" xref="S3.p1.3.m1.2.3.1"></times><ci id="S3.p1.3.m1.2.3.2.cmml" xref="S3.p1.3.m1.2.3.2">Δ</ci><apply id="S3.p1.3.m1.2.3.3.cmml" xref="S3.p1.3.m1.2.3.3"><csymbol cd="ambiguous" id="S3.p1.3.m1.2.3.3.1.cmml" xref="S3.p1.3.m1.2.3.3">superscript</csymbol><ci id="S3.p1.3.m1.2.3.3.2.cmml" xref="S3.p1.3.m1.2.3.3.2">𝜽</ci><times id="S3.p1.3.m1.2.3.3.3.cmml" xref="S3.p1.3.m1.2.3.3.3"></times></apply><interval closure="open" id="S3.p1.3.m1.2.3.4.1.cmml" xref="S3.p1.3.m1.2.3.4.2"><ci id="S3.p1.3.m1.1.1.cmml" xref="S3.p1.3.m1.1.1">𝑢</ci><ci id="S3.p1.3.m1.2.2.cmml" xref="S3.p1.3.m1.2.2">𝒞</ci></interval></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p1.3.m1.2c">\Delta\boldsymbol{\theta}^{*}(u,\mathcal{C})</annotation><annotation encoding="application/x-llamapun" id="S3.p1.3.m1.2d">roman_Δ bold_italic_θ start_POSTSUPERSCRIPT ∗ end_POSTSUPERSCRIPT ( italic_u , caligraphic_C )</annotation></semantics></math> can be obtained with the help of the evaluator:</p>
<table class="ltx_equation ltx_eqn_table" id="S3.Ex7">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\Delta\boldsymbol{\theta}^{*}(u,\mathcal{C})=\underset{\Delta\boldsymbol{%
\theta}}{\arg\max}~{}E(u,G(u,\mathcal{C};\boldsymbol{\theta}+\Delta\boldsymbol%
{\theta}))." class="ltx_Math" display="block" id="S3.Ex7.m1.6"><semantics id="S3.Ex7.m1.6a"><mrow id="S3.Ex7.m1.6.6.1" xref="S3.Ex7.m1.6.6.1.1.cmml"><mrow id="S3.Ex7.m1.6.6.1.1" xref="S3.Ex7.m1.6.6.1.1.cmml"><mrow id="S3.Ex7.m1.6.6.1.1.3" xref="S3.Ex7.m1.6.6.1.1.3.cmml"><mi id="S3.Ex7.m1.6.6.1.1.3.2" mathvariant="normal" xref="S3.Ex7.m1.6.6.1.1.3.2.cmml">Δ</mi><mo id="S3.Ex7.m1.6.6.1.1.3.1" xref="S3.Ex7.m1.6.6.1.1.3.1.cmml">⁢</mo><msup id="S3.Ex7.m1.6.6.1.1.3.3" xref="S3.Ex7.m1.6.6.1.1.3.3.cmml"><mi id="S3.Ex7.m1.6.6.1.1.3.3.2" xref="S3.Ex7.m1.6.6.1.1.3.3.2.cmml">𝜽</mi><mo id="S3.Ex7.m1.6.6.1.1.3.3.3" xref="S3.Ex7.m1.6.6.1.1.3.3.3.cmml">∗</mo></msup><mo id="S3.Ex7.m1.6.6.1.1.3.1a" xref="S3.Ex7.m1.6.6.1.1.3.1.cmml">⁢</mo><mrow id="S3.Ex7.m1.6.6.1.1.3.4.2" xref="S3.Ex7.m1.6.6.1.1.3.4.1.cmml"><mo id="S3.Ex7.m1.6.6.1.1.3.4.2.1" stretchy="false" xref="S3.Ex7.m1.6.6.1.1.3.4.1.cmml">(</mo><mi id="S3.Ex7.m1.1.1" xref="S3.Ex7.m1.1.1.cmml">u</mi><mo id="S3.Ex7.m1.6.6.1.1.3.4.2.2" xref="S3.Ex7.m1.6.6.1.1.3.4.1.cmml">,</mo><mi class="ltx_font_mathcaligraphic" id="S3.Ex7.m1.2.2" xref="S3.Ex7.m1.2.2.cmml">𝒞</mi><mo id="S3.Ex7.m1.6.6.1.1.3.4.2.3" stretchy="false" xref="S3.Ex7.m1.6.6.1.1.3.4.1.cmml">)</mo></mrow></mrow><mo id="S3.Ex7.m1.6.6.1.1.2" xref="S3.Ex7.m1.6.6.1.1.2.cmml">=</mo><mrow id="S3.Ex7.m1.6.6.1.1.1" xref="S3.Ex7.m1.6.6.1.1.1.cmml"><munder accentunder="true" id="S3.Ex7.m1.6.6.1.1.1.3" xref="S3.Ex7.m1.6.6.1.1.1.3.cmml"><mrow id="S3.Ex7.m1.6.6.1.1.1.3.2" xref="S3.Ex7.m1.6.6.1.1.1.3.2.cmml"><mi id="S3.Ex7.m1.6.6.1.1.1.3.2.1" xref="S3.Ex7.m1.6.6.1.1.1.3.2.1.cmml">arg</mi><mo id="S3.Ex7.m1.6.6.1.1.1.3.2a" lspace="0.167em" xref="S3.Ex7.m1.6.6.1.1.1.3.2.cmml">⁡</mo><mi id="S3.Ex7.m1.6.6.1.1.1.3.2.2" xref="S3.Ex7.m1.6.6.1.1.1.3.2.2.cmml">max</mi></mrow><mrow id="S3.Ex7.m1.6.6.1.1.1.3.1" xref="S3.Ex7.m1.6.6.1.1.1.3.1.cmml"><mi id="S3.Ex7.m1.6.6.1.1.1.3.1.2" mathvariant="normal" xref="S3.Ex7.m1.6.6.1.1.1.3.1.2.cmml">Δ</mi><mo id="S3.Ex7.m1.6.6.1.1.1.3.1.1" xref="S3.Ex7.m1.6.6.1.1.1.3.1.1.cmml">⁢</mo><mi id="S3.Ex7.m1.6.6.1.1.1.3.1.3" xref="S3.Ex7.m1.6.6.1.1.1.3.1.3.cmml">𝜽</mi></mrow></munder><mo id="S3.Ex7.m1.6.6.1.1.1.2" lspace="0.167em" xref="S3.Ex7.m1.6.6.1.1.1.2.cmml">⁢</mo><mi id="S3.Ex7.m1.6.6.1.1.1.4" xref="S3.Ex7.m1.6.6.1.1.1.4.cmml">E</mi><mo id="S3.Ex7.m1.6.6.1.1.1.2a" xref="S3.Ex7.m1.6.6.1.1.1.2.cmml">⁢</mo><mrow id="S3.Ex7.m1.6.6.1.1.1.1.1" xref="S3.Ex7.m1.6.6.1.1.1.1.2.cmml"><mo id="S3.Ex7.m1.6.6.1.1.1.1.1.2" stretchy="false" xref="S3.Ex7.m1.6.6.1.1.1.1.2.cmml">(</mo><mi id="S3.Ex7.m1.5.5" xref="S3.Ex7.m1.5.5.cmml">u</mi><mo id="S3.Ex7.m1.6.6.1.1.1.1.1.3" xref="S3.Ex7.m1.6.6.1.1.1.1.2.cmml">,</mo><mrow id="S3.Ex7.m1.6.6.1.1.1.1.1.1" xref="S3.Ex7.m1.6.6.1.1.1.1.1.1.cmml"><mi id="S3.Ex7.m1.6.6.1.1.1.1.1.1.3" xref="S3.Ex7.m1.6.6.1.1.1.1.1.1.3.cmml">G</mi><mo id="S3.Ex7.m1.6.6.1.1.1.1.1.1.2" xref="S3.Ex7.m1.6.6.1.1.1.1.1.1.2.cmml">⁢</mo><mrow id="S3.Ex7.m1.6.6.1.1.1.1.1.1.1.1" xref="S3.Ex7.m1.6.6.1.1.1.1.1.1.1.2.cmml"><mo id="S3.Ex7.m1.6.6.1.1.1.1.1.1.1.1.2" stretchy="false" xref="S3.Ex7.m1.6.6.1.1.1.1.1.1.1.2.cmml">(</mo><mi id="S3.Ex7.m1.3.3" xref="S3.Ex7.m1.3.3.cmml">u</mi><mo id="S3.Ex7.m1.6.6.1.1.1.1.1.1.1.1.3" xref="S3.Ex7.m1.6.6.1.1.1.1.1.1.1.2.cmml">,</mo><mi class="ltx_font_mathcaligraphic" id="S3.Ex7.m1.4.4" xref="S3.Ex7.m1.4.4.cmml">𝒞</mi><mo id="S3.Ex7.m1.6.6.1.1.1.1.1.1.1.1.4" xref="S3.Ex7.m1.6.6.1.1.1.1.1.1.1.2.cmml">;</mo><mrow id="S3.Ex7.m1.6.6.1.1.1.1.1.1.1.1.1" xref="S3.Ex7.m1.6.6.1.1.1.1.1.1.1.1.1.cmml"><mi id="S3.Ex7.m1.6.6.1.1.1.1.1.1.1.1.1.2" xref="S3.Ex7.m1.6.6.1.1.1.1.1.1.1.1.1.2.cmml">𝜽</mi><mo id="S3.Ex7.m1.6.6.1.1.1.1.1.1.1.1.1.1" xref="S3.Ex7.m1.6.6.1.1.1.1.1.1.1.1.1.1.cmml">+</mo><mrow id="S3.Ex7.m1.6.6.1.1.1.1.1.1.1.1.1.3" xref="S3.Ex7.m1.6.6.1.1.1.1.1.1.1.1.1.3.cmml"><mi id="S3.Ex7.m1.6.6.1.1.1.1.1.1.1.1.1.3.2" mathvariant="normal" xref="S3.Ex7.m1.6.6.1.1.1.1.1.1.1.1.1.3.2.cmml">Δ</mi><mo id="S3.Ex7.m1.6.6.1.1.1.1.1.1.1.1.1.3.1" xref="S3.Ex7.m1.6.6.1.1.1.1.1.1.1.1.1.3.1.cmml">⁢</mo><mi id="S3.Ex7.m1.6.6.1.1.1.1.1.1.1.1.1.3.3" xref="S3.Ex7.m1.6.6.1.1.1.1.1.1.1.1.1.3.3.cmml">𝜽</mi></mrow></mrow><mo id="S3.Ex7.m1.6.6.1.1.1.1.1.1.1.1.5" stretchy="false" xref="S3.Ex7.m1.6.6.1.1.1.1.1.1.1.2.cmml">)</mo></mrow></mrow><mo id="S3.Ex7.m1.6.6.1.1.1.1.1.4" stretchy="false" xref="S3.Ex7.m1.6.6.1.1.1.1.2.cmml">)</mo></mrow></mrow></mrow><mo id="S3.Ex7.m1.6.6.1.2" lspace="0em" xref="S3.Ex7.m1.6.6.1.1.cmml">.</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.Ex7.m1.6b"><apply id="S3.Ex7.m1.6.6.1.1.cmml" xref="S3.Ex7.m1.6.6.1"><eq id="S3.Ex7.m1.6.6.1.1.2.cmml" xref="S3.Ex7.m1.6.6.1.1.2"></eq><apply id="S3.Ex7.m1.6.6.1.1.3.cmml" xref="S3.Ex7.m1.6.6.1.1.3"><times id="S3.Ex7.m1.6.6.1.1.3.1.cmml" xref="S3.Ex7.m1.6.6.1.1.3.1"></times><ci id="S3.Ex7.m1.6.6.1.1.3.2.cmml" xref="S3.Ex7.m1.6.6.1.1.3.2">Δ</ci><apply id="S3.Ex7.m1.6.6.1.1.3.3.cmml" xref="S3.Ex7.m1.6.6.1.1.3.3"><csymbol cd="ambiguous" id="S3.Ex7.m1.6.6.1.1.3.3.1.cmml" xref="S3.Ex7.m1.6.6.1.1.3.3">superscript</csymbol><ci id="S3.Ex7.m1.6.6.1.1.3.3.2.cmml" xref="S3.Ex7.m1.6.6.1.1.3.3.2">𝜽</ci><times id="S3.Ex7.m1.6.6.1.1.3.3.3.cmml" xref="S3.Ex7.m1.6.6.1.1.3.3.3"></times></apply><interval closure="open" id="S3.Ex7.m1.6.6.1.1.3.4.1.cmml" xref="S3.Ex7.m1.6.6.1.1.3.4.2"><ci id="S3.Ex7.m1.1.1.cmml" xref="S3.Ex7.m1.1.1">𝑢</ci><ci id="S3.Ex7.m1.2.2.cmml" xref="S3.Ex7.m1.2.2">𝒞</ci></interval></apply><apply id="S3.Ex7.m1.6.6.1.1.1.cmml" xref="S3.Ex7.m1.6.6.1.1.1"><times id="S3.Ex7.m1.6.6.1.1.1.2.cmml" xref="S3.Ex7.m1.6.6.1.1.1.2"></times><apply id="S3.Ex7.m1.6.6.1.1.1.3.cmml" xref="S3.Ex7.m1.6.6.1.1.1.3"><apply id="S3.Ex7.m1.6.6.1.1.1.3.1.cmml" xref="S3.Ex7.m1.6.6.1.1.1.3.1"><times id="S3.Ex7.m1.6.6.1.1.1.3.1.1.cmml" xref="S3.Ex7.m1.6.6.1.1.1.3.1.1"></times><ci id="S3.Ex7.m1.6.6.1.1.1.3.1.2.cmml" xref="S3.Ex7.m1.6.6.1.1.1.3.1.2">Δ</ci><ci id="S3.Ex7.m1.6.6.1.1.1.3.1.3.cmml" xref="S3.Ex7.m1.6.6.1.1.1.3.1.3">𝜽</ci></apply><apply id="S3.Ex7.m1.6.6.1.1.1.3.2.cmml" xref="S3.Ex7.m1.6.6.1.1.1.3.2"><arg id="S3.Ex7.m1.6.6.1.1.1.3.2.1.cmml" xref="S3.Ex7.m1.6.6.1.1.1.3.2.1"></arg><max id="S3.Ex7.m1.6.6.1.1.1.3.2.2.cmml" xref="S3.Ex7.m1.6.6.1.1.1.3.2.2"></max></apply></apply><ci id="S3.Ex7.m1.6.6.1.1.1.4.cmml" xref="S3.Ex7.m1.6.6.1.1.1.4">𝐸</ci><interval closure="open" id="S3.Ex7.m1.6.6.1.1.1.1.2.cmml" xref="S3.Ex7.m1.6.6.1.1.1.1.1"><ci id="S3.Ex7.m1.5.5.cmml" xref="S3.Ex7.m1.5.5">𝑢</ci><apply id="S3.Ex7.m1.6.6.1.1.1.1.1.1.cmml" xref="S3.Ex7.m1.6.6.1.1.1.1.1.1"><times id="S3.Ex7.m1.6.6.1.1.1.1.1.1.2.cmml" xref="S3.Ex7.m1.6.6.1.1.1.1.1.1.2"></times><ci id="S3.Ex7.m1.6.6.1.1.1.1.1.1.3.cmml" xref="S3.Ex7.m1.6.6.1.1.1.1.1.1.3">𝐺</ci><vector id="S3.Ex7.m1.6.6.1.1.1.1.1.1.1.2.cmml" xref="S3.Ex7.m1.6.6.1.1.1.1.1.1.1.1"><ci id="S3.Ex7.m1.3.3.cmml" xref="S3.Ex7.m1.3.3">𝑢</ci><ci id="S3.Ex7.m1.4.4.cmml" xref="S3.Ex7.m1.4.4">𝒞</ci><apply id="S3.Ex7.m1.6.6.1.1.1.1.1.1.1.1.1.cmml" xref="S3.Ex7.m1.6.6.1.1.1.1.1.1.1.1.1"><plus id="S3.Ex7.m1.6.6.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.Ex7.m1.6.6.1.1.1.1.1.1.1.1.1.1"></plus><ci id="S3.Ex7.m1.6.6.1.1.1.1.1.1.1.1.1.2.cmml" xref="S3.Ex7.m1.6.6.1.1.1.1.1.1.1.1.1.2">𝜽</ci><apply id="S3.Ex7.m1.6.6.1.1.1.1.1.1.1.1.1.3.cmml" xref="S3.Ex7.m1.6.6.1.1.1.1.1.1.1.1.1.3"><times id="S3.Ex7.m1.6.6.1.1.1.1.1.1.1.1.1.3.1.cmml" xref="S3.Ex7.m1.6.6.1.1.1.1.1.1.1.1.1.3.1"></times><ci id="S3.Ex7.m1.6.6.1.1.1.1.1.1.1.1.1.3.2.cmml" xref="S3.Ex7.m1.6.6.1.1.1.1.1.1.1.1.1.3.2">Δ</ci><ci id="S3.Ex7.m1.6.6.1.1.1.1.1.1.1.1.1.3.3.cmml" xref="S3.Ex7.m1.6.6.1.1.1.1.1.1.1.1.1.3.3">𝜽</ci></apply></apply></vector></apply></interval></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.Ex7.m1.6c">\Delta\boldsymbol{\theta}^{*}(u,\mathcal{C})=\underset{\Delta\boldsymbol{%
\theta}}{\arg\max}~{}E(u,G(u,\mathcal{C};\boldsymbol{\theta}+\Delta\boldsymbol%
{\theta})).</annotation><annotation encoding="application/x-llamapun" id="S3.Ex7.m1.6d">roman_Δ bold_italic_θ start_POSTSUPERSCRIPT ∗ end_POSTSUPERSCRIPT ( italic_u , caligraphic_C ) = start_UNDERACCENT roman_Δ bold_italic_θ end_UNDERACCENT start_ARG roman_arg roman_max end_ARG italic_E ( italic_u , italic_G ( italic_u , caligraphic_C ; bold_italic_θ + roman_Δ bold_italic_θ ) ) .</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S3.p1.4">This modification is computed on the fly, tailored to the individual context of the request, capturing the unique needs and preferences of the user. After serving the current request, the modification is discarded and the model is restored to the state when the current request is received.</p>
</div>
<div class="ltx_para" id="S3.p2">
<p class="ltx_p" id="S3.p2.3">We introduce two versions of LAST algorithms with more details. The first is the cascade version, which finds the optimal modification <math alttext="\Delta\boldsymbol{\theta}^{*}(u,\mathcal{C})" class="ltx_Math" display="inline" id="S3.p2.1.m1.2"><semantics id="S3.p2.1.m1.2a"><mrow id="S3.p2.1.m1.2.3" xref="S3.p2.1.m1.2.3.cmml"><mi id="S3.p2.1.m1.2.3.2" mathvariant="normal" xref="S3.p2.1.m1.2.3.2.cmml">Δ</mi><mo id="S3.p2.1.m1.2.3.1" xref="S3.p2.1.m1.2.3.1.cmml">⁢</mo><msup id="S3.p2.1.m1.2.3.3" xref="S3.p2.1.m1.2.3.3.cmml"><mi id="S3.p2.1.m1.2.3.3.2" xref="S3.p2.1.m1.2.3.3.2.cmml">𝜽</mi><mo id="S3.p2.1.m1.2.3.3.3" xref="S3.p2.1.m1.2.3.3.3.cmml">∗</mo></msup><mo id="S3.p2.1.m1.2.3.1a" xref="S3.p2.1.m1.2.3.1.cmml">⁢</mo><mrow id="S3.p2.1.m1.2.3.4.2" xref="S3.p2.1.m1.2.3.4.1.cmml"><mo id="S3.p2.1.m1.2.3.4.2.1" stretchy="false" xref="S3.p2.1.m1.2.3.4.1.cmml">(</mo><mi id="S3.p2.1.m1.1.1" xref="S3.p2.1.m1.1.1.cmml">u</mi><mo id="S3.p2.1.m1.2.3.4.2.2" xref="S3.p2.1.m1.2.3.4.1.cmml">,</mo><mi class="ltx_font_mathcaligraphic" id="S3.p2.1.m1.2.2" xref="S3.p2.1.m1.2.2.cmml">𝒞</mi><mo id="S3.p2.1.m1.2.3.4.2.3" stretchy="false" xref="S3.p2.1.m1.2.3.4.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.p2.1.m1.2b"><apply id="S3.p2.1.m1.2.3.cmml" xref="S3.p2.1.m1.2.3"><times id="S3.p2.1.m1.2.3.1.cmml" xref="S3.p2.1.m1.2.3.1"></times><ci id="S3.p2.1.m1.2.3.2.cmml" xref="S3.p2.1.m1.2.3.2">Δ</ci><apply id="S3.p2.1.m1.2.3.3.cmml" xref="S3.p2.1.m1.2.3.3"><csymbol cd="ambiguous" id="S3.p2.1.m1.2.3.3.1.cmml" xref="S3.p2.1.m1.2.3.3">superscript</csymbol><ci id="S3.p2.1.m1.2.3.3.2.cmml" xref="S3.p2.1.m1.2.3.3.2">𝜽</ci><times id="S3.p2.1.m1.2.3.3.3.cmml" xref="S3.p2.1.m1.2.3.3.3"></times></apply><interval closure="open" id="S3.p2.1.m1.2.3.4.1.cmml" xref="S3.p2.1.m1.2.3.4.2"><ci id="S3.p2.1.m1.1.1.cmml" xref="S3.p2.1.m1.1.1">𝑢</ci><ci id="S3.p2.1.m1.2.2.cmml" xref="S3.p2.1.m1.2.2">𝒞</ci></interval></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p2.1.m1.2c">\Delta\boldsymbol{\theta}^{*}(u,\mathcal{C})</annotation><annotation encoding="application/x-llamapun" id="S3.p2.1.m1.2d">roman_Δ bold_italic_θ start_POSTSUPERSCRIPT ∗ end_POSTSUPERSCRIPT ( italic_u , caligraphic_C )</annotation></semantics></math> through an iterative process as shown in Fig. <a class="ltx_ref" href="https://arxiv.org/html/2406.14004v1#S3.F2" title="Figure 2 ‣ 3. LAST: The Proposed Method ‣ A re-ranking model with pre-feedback learning at serving time in e-commerce"><span class="ltx_text ltx_ref_tag">2</span></a> (b). Upon the arrival of a new user request, the cascade approach commences by generating a prediction using the currently deployed model and subsequently invokes the evaluation function, <math alttext="E(\cdot)" class="ltx_Math" display="inline" id="S3.p2.2.m2.1"><semantics id="S3.p2.2.m2.1a"><mrow id="S3.p2.2.m2.1.2" xref="S3.p2.2.m2.1.2.cmml"><mi id="S3.p2.2.m2.1.2.2" xref="S3.p2.2.m2.1.2.2.cmml">E</mi><mo id="S3.p2.2.m2.1.2.1" xref="S3.p2.2.m2.1.2.1.cmml">⁢</mo><mrow id="S3.p2.2.m2.1.2.3.2" xref="S3.p2.2.m2.1.2.cmml"><mo id="S3.p2.2.m2.1.2.3.2.1" stretchy="false" xref="S3.p2.2.m2.1.2.cmml">(</mo><mo id="S3.p2.2.m2.1.1" lspace="0em" rspace="0em" xref="S3.p2.2.m2.1.1.cmml">⋅</mo><mo id="S3.p2.2.m2.1.2.3.2.2" stretchy="false" xref="S3.p2.2.m2.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.p2.2.m2.1b"><apply id="S3.p2.2.m2.1.2.cmml" xref="S3.p2.2.m2.1.2"><times id="S3.p2.2.m2.1.2.1.cmml" xref="S3.p2.2.m2.1.2.1"></times><ci id="S3.p2.2.m2.1.2.2.cmml" xref="S3.p2.2.m2.1.2.2">𝐸</ci><ci id="S3.p2.2.m2.1.1.cmml" xref="S3.p2.2.m2.1.1">⋅</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p2.2.m2.1c">E(\cdot)</annotation><annotation encoding="application/x-llamapun" id="S3.p2.2.m2.1d">italic_E ( ⋅ )</annotation></semantics></math>, to assess the quality of this prediction. Thereafter, LAST endeavors to adjust the model parameters, <math alttext="\boldsymbol{\theta}" class="ltx_Math" display="inline" id="S3.p2.3.m3.1"><semantics id="S3.p2.3.m3.1a"><mi id="S3.p2.3.m3.1.1" xref="S3.p2.3.m3.1.1.cmml">𝜽</mi><annotation-xml encoding="MathML-Content" id="S3.p2.3.m3.1b"><ci id="S3.p2.3.m3.1.1.cmml" xref="S3.p2.3.m3.1.1">𝜽</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.p2.3.m3.1c">\boldsymbol{\theta}</annotation><annotation encoding="application/x-llamapun" id="S3.p2.3.m3.1d">bold_italic_θ</annotation></semantics></math>, in an effort to enhance the evaluation score. The specific methods employed for updating may vary based on the application context and can range from straightforward gradient descent techniques to more intricate RL strategies. Following this initial modification of the model, LAST attempts to produce a revised list of recommendations. It proceeds to engage in a cycle of prediction, evaluation, and parameter updating until a predetermined stopping criterion is satisfied. This criterion can be defined as a minimal change in evaluation per iteration or a maximum number of iterations. The recommendation list produced in the final iteration is presented to the user. Although the cascade version of LAST can be highly effective, its iterative nature has the potential to lead to a substantial increase in the system’s response time. This delay may render the cascade variant less suitable for online serving systems, where a rapid response is crucial.</p>
</div>
<div class="ltx_para" id="S3.p3">
<p class="ltx_p" id="S3.p3.10">The parallel version of LAST offers enhanced efficiency compared to its cascade counterpart, as shown in Fig. <a class="ltx_ref" href="https://arxiv.org/html/2406.14004v1#S3.F2" title="Figure 2 ‣ 3. LAST: The Proposed Method ‣ A re-ranking model with pre-feedback learning at serving time in e-commerce"><span class="ltx_text ltx_ref_tag">2</span></a> (c). It introduces a new gradient exploration module that suggests potential model modifications. After receiving the modification suggestions, the generator attempts the suggestions, and <math alttext="E(\cdot)" class="ltx_Math" display="inline" id="S3.p3.1.m1.1"><semantics id="S3.p3.1.m1.1a"><mrow id="S3.p3.1.m1.1.2" xref="S3.p3.1.m1.1.2.cmml"><mi id="S3.p3.1.m1.1.2.2" xref="S3.p3.1.m1.1.2.2.cmml">E</mi><mo id="S3.p3.1.m1.1.2.1" xref="S3.p3.1.m1.1.2.1.cmml">⁢</mo><mrow id="S3.p3.1.m1.1.2.3.2" xref="S3.p3.1.m1.1.2.cmml"><mo id="S3.p3.1.m1.1.2.3.2.1" stretchy="false" xref="S3.p3.1.m1.1.2.cmml">(</mo><mo id="S3.p3.1.m1.1.1" lspace="0em" rspace="0em" xref="S3.p3.1.m1.1.1.cmml">⋅</mo><mo id="S3.p3.1.m1.1.2.3.2.2" stretchy="false" xref="S3.p3.1.m1.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.p3.1.m1.1b"><apply id="S3.p3.1.m1.1.2.cmml" xref="S3.p3.1.m1.1.2"><times id="S3.p3.1.m1.1.2.1.cmml" xref="S3.p3.1.m1.1.2.1"></times><ci id="S3.p3.1.m1.1.2.2.cmml" xref="S3.p3.1.m1.1.2.2">𝐸</ci><ci id="S3.p3.1.m1.1.1.cmml" xref="S3.p3.1.m1.1.1">⋅</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p3.1.m1.1c">E(\cdot)</annotation><annotation encoding="application/x-llamapun" id="S3.p3.1.m1.1d">italic_E ( ⋅ )</annotation></semantics></math> estimates their effectiveness. The list with the highest evaluation is presented to the user. Algorithm. <a class="ltx_ref" href="https://arxiv.org/html/2406.14004v1#alg1" title="Algorithm 1 ‣ 3. LAST: The Proposed Method ‣ A re-ranking model with pre-feedback learning at serving time in e-commerce"><span class="ltx_text ltx_ref_tag">1</span></a> shows a more concrete implementation. We explore two very special gradient directions: the one increasing the generating probability of the current list and its opposite. It is interesting that finding these directions does not involve the execution of <math alttext="E(\cdot)" class="ltx_Math" display="inline" id="S3.p3.2.m2.1"><semantics id="S3.p3.2.m2.1a"><mrow id="S3.p3.2.m2.1.2" xref="S3.p3.2.m2.1.2.cmml"><mi id="S3.p3.2.m2.1.2.2" xref="S3.p3.2.m2.1.2.2.cmml">E</mi><mo id="S3.p3.2.m2.1.2.1" xref="S3.p3.2.m2.1.2.1.cmml">⁢</mo><mrow id="S3.p3.2.m2.1.2.3.2" xref="S3.p3.2.m2.1.2.cmml"><mo id="S3.p3.2.m2.1.2.3.2.1" stretchy="false" xref="S3.p3.2.m2.1.2.cmml">(</mo><mo id="S3.p3.2.m2.1.1" lspace="0em" rspace="0em" xref="S3.p3.2.m2.1.1.cmml">⋅</mo><mo id="S3.p3.2.m2.1.2.3.2.2" stretchy="false" xref="S3.p3.2.m2.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.p3.2.m2.1b"><apply id="S3.p3.2.m2.1.2.cmml" xref="S3.p3.2.m2.1.2"><times id="S3.p3.2.m2.1.2.1.cmml" xref="S3.p3.2.m2.1.2.1"></times><ci id="S3.p3.2.m2.1.2.2.cmml" xref="S3.p3.2.m2.1.2.2">𝐸</ci><ci id="S3.p3.2.m2.1.1.cmml" xref="S3.p3.2.m2.1.1">⋅</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p3.2.m2.1c">E(\cdot)</annotation><annotation encoding="application/x-llamapun" id="S3.p3.2.m2.1d">italic_E ( ⋅ )</annotation></semantics></math>. Mirroring the principles of offline training, we enhance the probability of list generation when a high reward is obtained, and conversely, lower it when the reward is minor. The value obtained from <math alttext="E(\cdot)" class="ltx_Math" display="inline" id="S3.p3.3.m3.1"><semantics id="S3.p3.3.m3.1a"><mrow id="S3.p3.3.m3.1.2" xref="S3.p3.3.m3.1.2.cmml"><mi id="S3.p3.3.m3.1.2.2" xref="S3.p3.3.m3.1.2.2.cmml">E</mi><mo id="S3.p3.3.m3.1.2.1" xref="S3.p3.3.m3.1.2.1.cmml">⁢</mo><mrow id="S3.p3.3.m3.1.2.3.2" xref="S3.p3.3.m3.1.2.cmml"><mo id="S3.p3.3.m3.1.2.3.2.1" stretchy="false" xref="S3.p3.3.m3.1.2.cmml">(</mo><mo id="S3.p3.3.m3.1.1" lspace="0em" rspace="0em" xref="S3.p3.3.m3.1.1.cmml">⋅</mo><mo id="S3.p3.3.m3.1.2.3.2.2" stretchy="false" xref="S3.p3.3.m3.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.p3.3.m3.1b"><apply id="S3.p3.3.m3.1.2.cmml" xref="S3.p3.3.m3.1.2"><times id="S3.p3.3.m3.1.2.1.cmml" xref="S3.p3.3.m3.1.2.1"></times><ci id="S3.p3.3.m3.1.2.2.cmml" xref="S3.p3.3.m3.1.2.2">𝐸</ci><ci id="S3.p3.3.m3.1.1.cmml" xref="S3.p3.3.m3.1.1">⋅</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p3.3.m3.1c">E(\cdot)</annotation><annotation encoding="application/x-llamapun" id="S3.p3.3.m3.1d">italic_E ( ⋅ )</annotation></semantics></math> is instrumental in calibrating the magnitude of the updates, but not the direction. The list generating probability <math alttext="P(L)" class="ltx_Math" display="inline" id="S3.p3.4.m4.1"><semantics id="S3.p3.4.m4.1a"><mrow id="S3.p3.4.m4.1.2" xref="S3.p3.4.m4.1.2.cmml"><mi id="S3.p3.4.m4.1.2.2" xref="S3.p3.4.m4.1.2.2.cmml">P</mi><mo id="S3.p3.4.m4.1.2.1" xref="S3.p3.4.m4.1.2.1.cmml">⁢</mo><mrow id="S3.p3.4.m4.1.2.3.2" xref="S3.p3.4.m4.1.2.cmml"><mo id="S3.p3.4.m4.1.2.3.2.1" stretchy="false" xref="S3.p3.4.m4.1.2.cmml">(</mo><mi id="S3.p3.4.m4.1.1" xref="S3.p3.4.m4.1.1.cmml">L</mi><mo id="S3.p3.4.m4.1.2.3.2.2" stretchy="false" xref="S3.p3.4.m4.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.p3.4.m4.1b"><apply id="S3.p3.4.m4.1.2.cmml" xref="S3.p3.4.m4.1.2"><times id="S3.p3.4.m4.1.2.1.cmml" xref="S3.p3.4.m4.1.2.1"></times><ci id="S3.p3.4.m4.1.2.2.cmml" xref="S3.p3.4.m4.1.2.2">𝑃</ci><ci id="S3.p3.4.m4.1.1.cmml" xref="S3.p3.4.m4.1.1">𝐿</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p3.4.m4.1c">P(L)</annotation><annotation encoding="application/x-llamapun" id="S3.p3.4.m4.1d">italic_P ( italic_L )</annotation></semantics></math> can be easily derived from a generative actor. The gradient is normalized with respect to the magnitude of <math alttext="\boldsymbol{\theta}" class="ltx_Math" display="inline" id="S3.p3.5.m5.1"><semantics id="S3.p3.5.m5.1a"><mi id="S3.p3.5.m5.1.1" xref="S3.p3.5.m5.1.1.cmml">𝜽</mi><annotation-xml encoding="MathML-Content" id="S3.p3.5.m5.1b"><ci id="S3.p3.5.m5.1.1.cmml" xref="S3.p3.5.m5.1.1">𝜽</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.p3.5.m5.1c">\boldsymbol{\theta}</annotation><annotation encoding="application/x-llamapun" id="S3.p3.5.m5.1d">bold_italic_θ</annotation></semantics></math>. The normalized gradient and a set of manually specified step sizes are utilized to provide the model modification suggestions. The partial gradient of <math alttext="E(\cdot)" class="ltx_Math" display="inline" id="S3.p3.6.m6.1"><semantics id="S3.p3.6.m6.1a"><mrow id="S3.p3.6.m6.1.2" xref="S3.p3.6.m6.1.2.cmml"><mi id="S3.p3.6.m6.1.2.2" xref="S3.p3.6.m6.1.2.2.cmml">E</mi><mo id="S3.p3.6.m6.1.2.1" xref="S3.p3.6.m6.1.2.1.cmml">⁢</mo><mrow id="S3.p3.6.m6.1.2.3.2" xref="S3.p3.6.m6.1.2.cmml"><mo id="S3.p3.6.m6.1.2.3.2.1" stretchy="false" xref="S3.p3.6.m6.1.2.cmml">(</mo><mo id="S3.p3.6.m6.1.1" lspace="0em" rspace="0em" xref="S3.p3.6.m6.1.1.cmml">⋅</mo><mo id="S3.p3.6.m6.1.2.3.2.2" stretchy="false" xref="S3.p3.6.m6.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.p3.6.m6.1b"><apply id="S3.p3.6.m6.1.2.cmml" xref="S3.p3.6.m6.1.2"><times id="S3.p3.6.m6.1.2.1.cmml" xref="S3.p3.6.m6.1.2.1"></times><ci id="S3.p3.6.m6.1.2.2.cmml" xref="S3.p3.6.m6.1.2.2">𝐸</ci><ci id="S3.p3.6.m6.1.1.cmml" xref="S3.p3.6.m6.1.1">⋅</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p3.6.m6.1c">E(\cdot)</annotation><annotation encoding="application/x-llamapun" id="S3.p3.6.m6.1d">italic_E ( ⋅ )</annotation></semantics></math> with respect to <math alttext="\boldsymbol{\theta}" class="ltx_Math" display="inline" id="S3.p3.7.m7.1"><semantics id="S3.p3.7.m7.1a"><mi id="S3.p3.7.m7.1.1" xref="S3.p3.7.m7.1.1.cmml">𝜽</mi><annotation-xml encoding="MathML-Content" id="S3.p3.7.m7.1b"><ci id="S3.p3.7.m7.1.1.cmml" xref="S3.p3.7.m7.1.1">𝜽</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.p3.7.m7.1c">\boldsymbol{\theta}</annotation><annotation encoding="application/x-llamapun" id="S3.p3.7.m7.1d">bold_italic_θ</annotation></semantics></math> is not directly used because <math alttext="E(\cdot)" class="ltx_Math" display="inline" id="S3.p3.8.m8.1"><semantics id="S3.p3.8.m8.1a"><mrow id="S3.p3.8.m8.1.2" xref="S3.p3.8.m8.1.2.cmml"><mi id="S3.p3.8.m8.1.2.2" xref="S3.p3.8.m8.1.2.2.cmml">E</mi><mo id="S3.p3.8.m8.1.2.1" xref="S3.p3.8.m8.1.2.1.cmml">⁢</mo><mrow id="S3.p3.8.m8.1.2.3.2" xref="S3.p3.8.m8.1.2.cmml"><mo id="S3.p3.8.m8.1.2.3.2.1" stretchy="false" xref="S3.p3.8.m8.1.2.cmml">(</mo><mo id="S3.p3.8.m8.1.1" lspace="0em" rspace="0em" xref="S3.p3.8.m8.1.1.cmml">⋅</mo><mo id="S3.p3.8.m8.1.2.3.2.2" stretchy="false" xref="S3.p3.8.m8.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.p3.8.m8.1b"><apply id="S3.p3.8.m8.1.2.cmml" xref="S3.p3.8.m8.1.2"><times id="S3.p3.8.m8.1.2.1.cmml" xref="S3.p3.8.m8.1.2.1"></times><ci id="S3.p3.8.m8.1.2.2.cmml" xref="S3.p3.8.m8.1.2.2">𝐸</ci><ci id="S3.p3.8.m8.1.1.cmml" xref="S3.p3.8.m8.1.1">⋅</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p3.8.m8.1c">E(\cdot)</annotation><annotation encoding="application/x-llamapun" id="S3.p3.8.m8.1d">italic_E ( ⋅ )</annotation></semantics></math> may not be a function of <math alttext="\boldsymbol{\theta}" class="ltx_Math" display="inline" id="S3.p3.9.m9.1"><semantics id="S3.p3.9.m9.1a"><mi id="S3.p3.9.m9.1.1" xref="S3.p3.9.m9.1.1.cmml">𝜽</mi><annotation-xml encoding="MathML-Content" id="S3.p3.9.m9.1b"><ci id="S3.p3.9.m9.1.1.cmml" xref="S3.p3.9.m9.1.1">𝜽</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.p3.9.m9.1c">\boldsymbol{\theta}</annotation><annotation encoding="application/x-llamapun" id="S3.p3.9.m9.1d">bold_italic_θ</annotation></semantics></math> and thus the partial gradient does not exist. Modern neural network models can have billions of parameters. It is not necessary or efficient to modify all of them for a single request. A more feasible solution is to modify only a key subset of <math alttext="\boldsymbol{\theta}" class="ltx_Math" display="inline" id="S3.p3.10.m10.1"><semantics id="S3.p3.10.m10.1a"><mi id="S3.p3.10.m10.1.1" xref="S3.p3.10.m10.1.1.cmml">𝜽</mi><annotation-xml encoding="MathML-Content" id="S3.p3.10.m10.1b"><ci id="S3.p3.10.m10.1.1.cmml" xref="S3.p3.10.m10.1.1">𝜽</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.p3.10.m10.1c">\boldsymbol{\theta}</annotation><annotation encoding="application/x-llamapun" id="S3.p3.10.m10.1d">bold_italic_θ</annotation></semantics></math>.</p>
</div>
<figure class="ltx_float ltx_float_algorithm ltx_framed ltx_framed_top" id="alg1">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_float"><span class="ltx_text ltx_font_bold" id="alg1.2.1.1">Algorithm 1</span> </span> LAST, the parallel version implementation.</figcaption>
<div class="ltx_listing ltx_listing" id="alg1.3">
<div class="ltx_listingline" id="alg1.l0">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg1.l0.1.1.1" style="font-size:80%;">0:</span></span>  a user <math alttext="u" class="ltx_Math" display="inline" id="alg1.l0.m1.1"><semantics id="alg1.l0.m1.1a"><mi id="alg1.l0.m1.1.1" xref="alg1.l0.m1.1.1.cmml">u</mi><annotation-xml encoding="MathML-Content" id="alg1.l0.m1.1b"><ci id="alg1.l0.m1.1.1.cmml" xref="alg1.l0.m1.1.1">𝑢</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.l0.m1.1c">u</annotation><annotation encoding="application/x-llamapun" id="alg1.l0.m1.1d">italic_u</annotation></semantics></math>; a candidate item set <math alttext="\mathcal{C}" class="ltx_Math" display="inline" id="alg1.l0.m2.1"><semantics id="alg1.l0.m2.1a"><mi class="ltx_font_mathcaligraphic" id="alg1.l0.m2.1.1" xref="alg1.l0.m2.1.1.cmml">𝒞</mi><annotation-xml encoding="MathML-Content" id="alg1.l0.m2.1b"><ci id="alg1.l0.m2.1.1.cmml" xref="alg1.l0.m2.1.1">𝒞</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.l0.m2.1c">\mathcal{C}</annotation><annotation encoding="application/x-llamapun" id="alg1.l0.m2.1d">caligraphic_C</annotation></semantics></math>; a deployed actor model <math alttext="G(\cdot;\boldsymbol{\theta})" class="ltx_Math" display="inline" id="alg1.l0.m3.2"><semantics id="alg1.l0.m3.2a"><mrow id="alg1.l0.m3.2.3" xref="alg1.l0.m3.2.3.cmml"><mi id="alg1.l0.m3.2.3.2" xref="alg1.l0.m3.2.3.2.cmml">G</mi><mo id="alg1.l0.m3.2.3.1" xref="alg1.l0.m3.2.3.1.cmml">⁢</mo><mrow id="alg1.l0.m3.2.3.3.2" xref="alg1.l0.m3.2.3.3.1.cmml"><mo id="alg1.l0.m3.2.3.3.2.1" stretchy="false" xref="alg1.l0.m3.2.3.3.1.cmml">(</mo><mo id="alg1.l0.m3.1.1" lspace="0em" rspace="0em" xref="alg1.l0.m3.1.1.cmml">⋅</mo><mo id="alg1.l0.m3.2.3.3.2.2" xref="alg1.l0.m3.2.3.3.1.cmml">;</mo><mi id="alg1.l0.m3.2.2" xref="alg1.l0.m3.2.2.cmml">𝜽</mi><mo id="alg1.l0.m3.2.3.3.2.3" stretchy="false" xref="alg1.l0.m3.2.3.3.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l0.m3.2b"><apply id="alg1.l0.m3.2.3.cmml" xref="alg1.l0.m3.2.3"><times id="alg1.l0.m3.2.3.1.cmml" xref="alg1.l0.m3.2.3.1"></times><ci id="alg1.l0.m3.2.3.2.cmml" xref="alg1.l0.m3.2.3.2">𝐺</ci><list id="alg1.l0.m3.2.3.3.1.cmml" xref="alg1.l0.m3.2.3.3.2"><ci id="alg1.l0.m3.1.1.cmml" xref="alg1.l0.m3.1.1">⋅</ci><ci id="alg1.l0.m3.2.2.cmml" xref="alg1.l0.m3.2.2">𝜽</ci></list></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l0.m3.2c">G(\cdot;\boldsymbol{\theta})</annotation><annotation encoding="application/x-llamapun" id="alg1.l0.m3.2d">italic_G ( ⋅ ; bold_italic_θ )</annotation></semantics></math> parameterized by <math alttext="\boldsymbol{\theta}" class="ltx_Math" display="inline" id="alg1.l0.m4.1"><semantics id="alg1.l0.m4.1a"><mi id="alg1.l0.m4.1.1" xref="alg1.l0.m4.1.1.cmml">𝜽</mi><annotation-xml encoding="MathML-Content" id="alg1.l0.m4.1b"><ci id="alg1.l0.m4.1.1.cmml" xref="alg1.l0.m4.1.1">𝜽</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.l0.m4.1c">\boldsymbol{\theta}</annotation><annotation encoding="application/x-llamapun" id="alg1.l0.m4.1d">bold_italic_θ</annotation></semantics></math>; a list evaluation function <math alttext="E(\cdot)" class="ltx_Math" display="inline" id="alg1.l0.m5.1"><semantics id="alg1.l0.m5.1a"><mrow id="alg1.l0.m5.1.2" xref="alg1.l0.m5.1.2.cmml"><mi id="alg1.l0.m5.1.2.2" xref="alg1.l0.m5.1.2.2.cmml">E</mi><mo id="alg1.l0.m5.1.2.1" xref="alg1.l0.m5.1.2.1.cmml">⁢</mo><mrow id="alg1.l0.m5.1.2.3.2" xref="alg1.l0.m5.1.2.cmml"><mo id="alg1.l0.m5.1.2.3.2.1" stretchy="false" xref="alg1.l0.m5.1.2.cmml">(</mo><mo id="alg1.l0.m5.1.1" lspace="0em" rspace="0em" xref="alg1.l0.m5.1.1.cmml">⋅</mo><mo id="alg1.l0.m5.1.2.3.2.2" stretchy="false" xref="alg1.l0.m5.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l0.m5.1b"><apply id="alg1.l0.m5.1.2.cmml" xref="alg1.l0.m5.1.2"><times id="alg1.l0.m5.1.2.1.cmml" xref="alg1.l0.m5.1.2.1"></times><ci id="alg1.l0.m5.1.2.2.cmml" xref="alg1.l0.m5.1.2.2">𝐸</ci><ci id="alg1.l0.m5.1.1.cmml" xref="alg1.l0.m5.1.1">⋅</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l0.m5.1c">E(\cdot)</annotation><annotation encoding="application/x-llamapun" id="alg1.l0.m5.1d">italic_E ( ⋅ )</annotation></semantics></math>; a function <math alttext="P(L)" class="ltx_Math" display="inline" id="alg1.l0.m6.1"><semantics id="alg1.l0.m6.1a"><mrow id="alg1.l0.m6.1.2" xref="alg1.l0.m6.1.2.cmml"><mi id="alg1.l0.m6.1.2.2" xref="alg1.l0.m6.1.2.2.cmml">P</mi><mo id="alg1.l0.m6.1.2.1" xref="alg1.l0.m6.1.2.1.cmml">⁢</mo><mrow id="alg1.l0.m6.1.2.3.2" xref="alg1.l0.m6.1.2.cmml"><mo id="alg1.l0.m6.1.2.3.2.1" stretchy="false" xref="alg1.l0.m6.1.2.cmml">(</mo><mi id="alg1.l0.m6.1.1" xref="alg1.l0.m6.1.1.cmml">L</mi><mo id="alg1.l0.m6.1.2.3.2.2" stretchy="false" xref="alg1.l0.m6.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l0.m6.1b"><apply id="alg1.l0.m6.1.2.cmml" xref="alg1.l0.m6.1.2"><times id="alg1.l0.m6.1.2.1.cmml" xref="alg1.l0.m6.1.2.1"></times><ci id="alg1.l0.m6.1.2.2.cmml" xref="alg1.l0.m6.1.2.2">𝑃</ci><ci id="alg1.l0.m6.1.1.cmml" xref="alg1.l0.m6.1.1">𝐿</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l0.m6.1c">P(L)</annotation><annotation encoding="application/x-llamapun" id="alg1.l0.m6.1d">italic_P ( italic_L )</annotation></semantics></math> indicating the probability of <math alttext="G" class="ltx_Math" display="inline" id="alg1.l0.m7.1"><semantics id="alg1.l0.m7.1a"><mi id="alg1.l0.m7.1.1" xref="alg1.l0.m7.1.1.cmml">G</mi><annotation-xml encoding="MathML-Content" id="alg1.l0.m7.1b"><ci id="alg1.l0.m7.1.1.cmml" xref="alg1.l0.m7.1.1">𝐺</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.l0.m7.1c">G</annotation><annotation encoding="application/x-llamapun" id="alg1.l0.m7.1d">italic_G</annotation></semantics></math> generating list <math alttext="L" class="ltx_Math" display="inline" id="alg1.l0.m8.1"><semantics id="alg1.l0.m8.1a"><mi id="alg1.l0.m8.1.1" xref="alg1.l0.m8.1.1.cmml">L</mi><annotation-xml encoding="MathML-Content" id="alg1.l0.m8.1b"><ci id="alg1.l0.m8.1.1.cmml" xref="alg1.l0.m8.1.1">𝐿</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.l0.m8.1c">L</annotation><annotation encoding="application/x-llamapun" id="alg1.l0.m8.1d">italic_L</annotation></semantics></math>; a list of step size <math alttext="[\eta_{1},\eta_{2},...]" class="ltx_Math" display="inline" id="alg1.l0.m9.3"><semantics id="alg1.l0.m9.3a"><mrow id="alg1.l0.m9.3.3.2" xref="alg1.l0.m9.3.3.3.cmml"><mo id="alg1.l0.m9.3.3.2.3" stretchy="false" xref="alg1.l0.m9.3.3.3.cmml">[</mo><msub id="alg1.l0.m9.2.2.1.1" xref="alg1.l0.m9.2.2.1.1.cmml"><mi id="alg1.l0.m9.2.2.1.1.2" xref="alg1.l0.m9.2.2.1.1.2.cmml">η</mi><mn id="alg1.l0.m9.2.2.1.1.3" xref="alg1.l0.m9.2.2.1.1.3.cmml">1</mn></msub><mo id="alg1.l0.m9.3.3.2.4" xref="alg1.l0.m9.3.3.3.cmml">,</mo><msub id="alg1.l0.m9.3.3.2.2" xref="alg1.l0.m9.3.3.2.2.cmml"><mi id="alg1.l0.m9.3.3.2.2.2" xref="alg1.l0.m9.3.3.2.2.2.cmml">η</mi><mn id="alg1.l0.m9.3.3.2.2.3" xref="alg1.l0.m9.3.3.2.2.3.cmml">2</mn></msub><mo id="alg1.l0.m9.3.3.2.5" xref="alg1.l0.m9.3.3.3.cmml">,</mo><mi id="alg1.l0.m9.1.1" mathvariant="normal" xref="alg1.l0.m9.1.1.cmml">…</mi><mo id="alg1.l0.m9.3.3.2.6" stretchy="false" xref="alg1.l0.m9.3.3.3.cmml">]</mo></mrow><annotation-xml encoding="MathML-Content" id="alg1.l0.m9.3b"><list id="alg1.l0.m9.3.3.3.cmml" xref="alg1.l0.m9.3.3.2"><apply id="alg1.l0.m9.2.2.1.1.cmml" xref="alg1.l0.m9.2.2.1.1"><csymbol cd="ambiguous" id="alg1.l0.m9.2.2.1.1.1.cmml" xref="alg1.l0.m9.2.2.1.1">subscript</csymbol><ci id="alg1.l0.m9.2.2.1.1.2.cmml" xref="alg1.l0.m9.2.2.1.1.2">𝜂</ci><cn id="alg1.l0.m9.2.2.1.1.3.cmml" type="integer" xref="alg1.l0.m9.2.2.1.1.3">1</cn></apply><apply id="alg1.l0.m9.3.3.2.2.cmml" xref="alg1.l0.m9.3.3.2.2"><csymbol cd="ambiguous" id="alg1.l0.m9.3.3.2.2.1.cmml" xref="alg1.l0.m9.3.3.2.2">subscript</csymbol><ci id="alg1.l0.m9.3.3.2.2.2.cmml" xref="alg1.l0.m9.3.3.2.2.2">𝜂</ci><cn id="alg1.l0.m9.3.3.2.2.3.cmml" type="integer" xref="alg1.l0.m9.3.3.2.2.3">2</cn></apply><ci id="alg1.l0.m9.1.1.cmml" xref="alg1.l0.m9.1.1">…</ci></list></annotation-xml><annotation encoding="application/x-tex" id="alg1.l0.m9.3c">[\eta_{1},\eta_{2},...]</annotation><annotation encoding="application/x-llamapun" id="alg1.l0.m9.3d">[ italic_η start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT , italic_η start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT , … ]</annotation></semantics></math>; a constant factor <math alttext="\alpha" class="ltx_Math" display="inline" id="alg1.l0.m10.1"><semantics id="alg1.l0.m10.1a"><mi id="alg1.l0.m10.1.1" xref="alg1.l0.m10.1.1.cmml">α</mi><annotation-xml encoding="MathML-Content" id="alg1.l0.m10.1b"><ci id="alg1.l0.m10.1.1.cmml" xref="alg1.l0.m10.1.1">𝛼</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.l0.m10.1c">\alpha</annotation><annotation encoding="application/x-llamapun" id="alg1.l0.m10.1d">italic_α</annotation></semantics></math> for gradient normalization

</div>
<div class="ltx_listingline" id="alg1.l0a">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg1.l0a.1.1.1" style="font-size:80%;">0:</span></span>  a predicted optimal recommendation list <math alttext="\widehat{L^{*}}_{LAST}" class="ltx_Math" display="inline" id="alg1.l0a.m1.1"><semantics id="alg1.l0a.m1.1a"><msub id="alg1.l0a.m1.1.1" xref="alg1.l0a.m1.1.1.cmml"><mover accent="true" id="alg1.l0a.m1.1.1.2" xref="alg1.l0a.m1.1.1.2.cmml"><msup id="alg1.l0a.m1.1.1.2.2" xref="alg1.l0a.m1.1.1.2.2.cmml"><mi id="alg1.l0a.m1.1.1.2.2.2" xref="alg1.l0a.m1.1.1.2.2.2.cmml">L</mi><mo id="alg1.l0a.m1.1.1.2.2.3" xref="alg1.l0a.m1.1.1.2.2.3.cmml">∗</mo></msup><mo id="alg1.l0a.m1.1.1.2.1" xref="alg1.l0a.m1.1.1.2.1.cmml">^</mo></mover><mrow id="alg1.l0a.m1.1.1.3" xref="alg1.l0a.m1.1.1.3.cmml"><mi id="alg1.l0a.m1.1.1.3.2" xref="alg1.l0a.m1.1.1.3.2.cmml">L</mi><mo id="alg1.l0a.m1.1.1.3.1" xref="alg1.l0a.m1.1.1.3.1.cmml">⁢</mo><mi id="alg1.l0a.m1.1.1.3.3" xref="alg1.l0a.m1.1.1.3.3.cmml">A</mi><mo id="alg1.l0a.m1.1.1.3.1a" xref="alg1.l0a.m1.1.1.3.1.cmml">⁢</mo><mi id="alg1.l0a.m1.1.1.3.4" xref="alg1.l0a.m1.1.1.3.4.cmml">S</mi><mo id="alg1.l0a.m1.1.1.3.1b" xref="alg1.l0a.m1.1.1.3.1.cmml">⁢</mo><mi id="alg1.l0a.m1.1.1.3.5" xref="alg1.l0a.m1.1.1.3.5.cmml">T</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="alg1.l0a.m1.1b"><apply id="alg1.l0a.m1.1.1.cmml" xref="alg1.l0a.m1.1.1"><csymbol cd="ambiguous" id="alg1.l0a.m1.1.1.1.cmml" xref="alg1.l0a.m1.1.1">subscript</csymbol><apply id="alg1.l0a.m1.1.1.2.cmml" xref="alg1.l0a.m1.1.1.2"><ci id="alg1.l0a.m1.1.1.2.1.cmml" xref="alg1.l0a.m1.1.1.2.1">^</ci><apply id="alg1.l0a.m1.1.1.2.2.cmml" xref="alg1.l0a.m1.1.1.2.2"><csymbol cd="ambiguous" id="alg1.l0a.m1.1.1.2.2.1.cmml" xref="alg1.l0a.m1.1.1.2.2">superscript</csymbol><ci id="alg1.l0a.m1.1.1.2.2.2.cmml" xref="alg1.l0a.m1.1.1.2.2.2">𝐿</ci><times id="alg1.l0a.m1.1.1.2.2.3.cmml" xref="alg1.l0a.m1.1.1.2.2.3"></times></apply></apply><apply id="alg1.l0a.m1.1.1.3.cmml" xref="alg1.l0a.m1.1.1.3"><times id="alg1.l0a.m1.1.1.3.1.cmml" xref="alg1.l0a.m1.1.1.3.1"></times><ci id="alg1.l0a.m1.1.1.3.2.cmml" xref="alg1.l0a.m1.1.1.3.2">𝐿</ci><ci id="alg1.l0a.m1.1.1.3.3.cmml" xref="alg1.l0a.m1.1.1.3.3">𝐴</ci><ci id="alg1.l0a.m1.1.1.3.4.cmml" xref="alg1.l0a.m1.1.1.3.4">𝑆</ci><ci id="alg1.l0a.m1.1.1.3.5.cmml" xref="alg1.l0a.m1.1.1.3.5">𝑇</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l0a.m1.1c">\widehat{L^{*}}_{LAST}</annotation><annotation encoding="application/x-llamapun" id="alg1.l0a.m1.1d">over^ start_ARG italic_L start_POSTSUPERSCRIPT ∗ end_POSTSUPERSCRIPT end_ARG start_POSTSUBSCRIPT italic_L italic_A italic_S italic_T end_POSTSUBSCRIPT</annotation></semantics></math> for <math alttext="u" class="ltx_Math" display="inline" id="alg1.l0a.m2.1"><semantics id="alg1.l0a.m2.1a"><mi id="alg1.l0a.m2.1.1" xref="alg1.l0a.m2.1.1.cmml">u</mi><annotation-xml encoding="MathML-Content" id="alg1.l0a.m2.1b"><ci id="alg1.l0a.m2.1.1.cmml" xref="alg1.l0a.m2.1.1">𝑢</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.l0a.m2.1c">u</annotation><annotation encoding="application/x-llamapun" id="alg1.l0a.m2.1d">italic_u</annotation></semantics></math>, which is composed by items in <math alttext="\mathcal{C}" class="ltx_Math" display="inline" id="alg1.l0a.m3.1"><semantics id="alg1.l0a.m3.1a"><mi class="ltx_font_mathcaligraphic" id="alg1.l0a.m3.1.1" xref="alg1.l0a.m3.1.1.cmml">𝒞</mi><annotation-xml encoding="MathML-Content" id="alg1.l0a.m3.1b"><ci id="alg1.l0a.m3.1.1.cmml" xref="alg1.l0a.m3.1.1">𝒞</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.l0a.m3.1c">\mathcal{C}</annotation><annotation encoding="application/x-llamapun" id="alg1.l0a.m3.1d">caligraphic_C</annotation></semantics></math>
</div>
<div class="ltx_listingline" id="alg1.l1">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg1.l1.1.1.1" style="font-size:80%;">1:</span></span>  <math alttext="\hat{L}\leftarrow G(u,\mathcal{C};\boldsymbol{\theta})" class="ltx_Math" display="inline" id="alg1.l1.m1.3"><semantics id="alg1.l1.m1.3a"><mrow id="alg1.l1.m1.3.4" xref="alg1.l1.m1.3.4.cmml"><mover accent="true" id="alg1.l1.m1.3.4.2" xref="alg1.l1.m1.3.4.2.cmml"><mi id="alg1.l1.m1.3.4.2.2" xref="alg1.l1.m1.3.4.2.2.cmml">L</mi><mo id="alg1.l1.m1.3.4.2.1" xref="alg1.l1.m1.3.4.2.1.cmml">^</mo></mover><mo id="alg1.l1.m1.3.4.1" stretchy="false" xref="alg1.l1.m1.3.4.1.cmml">←</mo><mrow id="alg1.l1.m1.3.4.3" xref="alg1.l1.m1.3.4.3.cmml"><mi id="alg1.l1.m1.3.4.3.2" xref="alg1.l1.m1.3.4.3.2.cmml">G</mi><mo id="alg1.l1.m1.3.4.3.1" xref="alg1.l1.m1.3.4.3.1.cmml">⁢</mo><mrow id="alg1.l1.m1.3.4.3.3.2" xref="alg1.l1.m1.3.4.3.3.1.cmml"><mo id="alg1.l1.m1.3.4.3.3.2.1" stretchy="false" xref="alg1.l1.m1.3.4.3.3.1.cmml">(</mo><mi id="alg1.l1.m1.1.1" xref="alg1.l1.m1.1.1.cmml">u</mi><mo id="alg1.l1.m1.3.4.3.3.2.2" xref="alg1.l1.m1.3.4.3.3.1.cmml">,</mo><mi class="ltx_font_mathcaligraphic" id="alg1.l1.m1.2.2" xref="alg1.l1.m1.2.2.cmml">𝒞</mi><mo id="alg1.l1.m1.3.4.3.3.2.3" xref="alg1.l1.m1.3.4.3.3.1.cmml">;</mo><mi id="alg1.l1.m1.3.3" xref="alg1.l1.m1.3.3.cmml">𝜽</mi><mo id="alg1.l1.m1.3.4.3.3.2.4" stretchy="false" xref="alg1.l1.m1.3.4.3.3.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l1.m1.3b"><apply id="alg1.l1.m1.3.4.cmml" xref="alg1.l1.m1.3.4"><ci id="alg1.l1.m1.3.4.1.cmml" xref="alg1.l1.m1.3.4.1">←</ci><apply id="alg1.l1.m1.3.4.2.cmml" xref="alg1.l1.m1.3.4.2"><ci id="alg1.l1.m1.3.4.2.1.cmml" xref="alg1.l1.m1.3.4.2.1">^</ci><ci id="alg1.l1.m1.3.4.2.2.cmml" xref="alg1.l1.m1.3.4.2.2">𝐿</ci></apply><apply id="alg1.l1.m1.3.4.3.cmml" xref="alg1.l1.m1.3.4.3"><times id="alg1.l1.m1.3.4.3.1.cmml" xref="alg1.l1.m1.3.4.3.1"></times><ci id="alg1.l1.m1.3.4.3.2.cmml" xref="alg1.l1.m1.3.4.3.2">𝐺</ci><vector id="alg1.l1.m1.3.4.3.3.1.cmml" xref="alg1.l1.m1.3.4.3.3.2"><ci id="alg1.l1.m1.1.1.cmml" xref="alg1.l1.m1.1.1">𝑢</ci><ci id="alg1.l1.m1.2.2.cmml" xref="alg1.l1.m1.2.2">𝒞</ci><ci id="alg1.l1.m1.3.3.cmml" xref="alg1.l1.m1.3.3">𝜽</ci></vector></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l1.m1.3c">\hat{L}\leftarrow G(u,\mathcal{C};\boldsymbol{\theta})</annotation><annotation encoding="application/x-llamapun" id="alg1.l1.m1.3d">over^ start_ARG italic_L end_ARG ← italic_G ( italic_u , caligraphic_C ; bold_italic_θ )</annotation></semantics></math> {run the prediction model}

</div>
<div class="ltx_listingline" id="alg1.l2">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg1.l2.1.1.1" style="font-size:80%;">2:</span></span>  <math alttext="\boldsymbol{g}_{\boldsymbol{\theta}}\leftarrow\frac{\partial P(\hat{L})}{%
\partial\boldsymbol{\theta}}" class="ltx_Math" display="inline" id="alg1.l2.m1.1"><semantics id="alg1.l2.m1.1a"><mrow id="alg1.l2.m1.1.2" xref="alg1.l2.m1.1.2.cmml"><msub id="alg1.l2.m1.1.2.2" xref="alg1.l2.m1.1.2.2.cmml"><mi id="alg1.l2.m1.1.2.2.2" xref="alg1.l2.m1.1.2.2.2.cmml">𝒈</mi><mi id="alg1.l2.m1.1.2.2.3" xref="alg1.l2.m1.1.2.2.3.cmml">𝜽</mi></msub><mo id="alg1.l2.m1.1.2.1" stretchy="false" xref="alg1.l2.m1.1.2.1.cmml">←</mo><mfrac id="alg1.l2.m1.1.1" xref="alg1.l2.m1.1.1.cmml"><mrow id="alg1.l2.m1.1.1.1" xref="alg1.l2.m1.1.1.1.cmml"><mo id="alg1.l2.m1.1.1.1.2" rspace="0em" xref="alg1.l2.m1.1.1.1.2.cmml">∂</mo><mrow id="alg1.l2.m1.1.1.1.3" xref="alg1.l2.m1.1.1.1.3.cmml"><mi id="alg1.l2.m1.1.1.1.3.2" xref="alg1.l2.m1.1.1.1.3.2.cmml">P</mi><mo id="alg1.l2.m1.1.1.1.3.1" xref="alg1.l2.m1.1.1.1.3.1.cmml">⁢</mo><mrow id="alg1.l2.m1.1.1.1.3.3.2" xref="alg1.l2.m1.1.1.1.1.cmml"><mo id="alg1.l2.m1.1.1.1.3.3.2.1" stretchy="false" xref="alg1.l2.m1.1.1.1.1.cmml">(</mo><mover accent="true" id="alg1.l2.m1.1.1.1.1" xref="alg1.l2.m1.1.1.1.1.cmml"><mi id="alg1.l2.m1.1.1.1.1.2" xref="alg1.l2.m1.1.1.1.1.2.cmml">L</mi><mo id="alg1.l2.m1.1.1.1.1.1" xref="alg1.l2.m1.1.1.1.1.1.cmml">^</mo></mover><mo id="alg1.l2.m1.1.1.1.3.3.2.2" stretchy="false" xref="alg1.l2.m1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><mrow id="alg1.l2.m1.1.1.3" xref="alg1.l2.m1.1.1.3.cmml"><mo id="alg1.l2.m1.1.1.3.1" rspace="0em" xref="alg1.l2.m1.1.1.3.1.cmml">∂</mo><mi id="alg1.l2.m1.1.1.3.2" xref="alg1.l2.m1.1.1.3.2.cmml">𝜽</mi></mrow></mfrac></mrow><annotation-xml encoding="MathML-Content" id="alg1.l2.m1.1b"><apply id="alg1.l2.m1.1.2.cmml" xref="alg1.l2.m1.1.2"><ci id="alg1.l2.m1.1.2.1.cmml" xref="alg1.l2.m1.1.2.1">←</ci><apply id="alg1.l2.m1.1.2.2.cmml" xref="alg1.l2.m1.1.2.2"><csymbol cd="ambiguous" id="alg1.l2.m1.1.2.2.1.cmml" xref="alg1.l2.m1.1.2.2">subscript</csymbol><ci id="alg1.l2.m1.1.2.2.2.cmml" xref="alg1.l2.m1.1.2.2.2">𝒈</ci><ci id="alg1.l2.m1.1.2.2.3.cmml" xref="alg1.l2.m1.1.2.2.3">𝜽</ci></apply><apply id="alg1.l2.m1.1.1.cmml" xref="alg1.l2.m1.1.1"><divide id="alg1.l2.m1.1.1.2.cmml" xref="alg1.l2.m1.1.1"></divide><apply id="alg1.l2.m1.1.1.1.cmml" xref="alg1.l2.m1.1.1.1"><partialdiff id="alg1.l2.m1.1.1.1.2.cmml" xref="alg1.l2.m1.1.1.1.2"></partialdiff><apply id="alg1.l2.m1.1.1.1.3.cmml" xref="alg1.l2.m1.1.1.1.3"><times id="alg1.l2.m1.1.1.1.3.1.cmml" xref="alg1.l2.m1.1.1.1.3.1"></times><ci id="alg1.l2.m1.1.1.1.3.2.cmml" xref="alg1.l2.m1.1.1.1.3.2">𝑃</ci><apply id="alg1.l2.m1.1.1.1.1.cmml" xref="alg1.l2.m1.1.1.1.3.3.2"><ci id="alg1.l2.m1.1.1.1.1.1.cmml" xref="alg1.l2.m1.1.1.1.1.1">^</ci><ci id="alg1.l2.m1.1.1.1.1.2.cmml" xref="alg1.l2.m1.1.1.1.1.2">𝐿</ci></apply></apply></apply><apply id="alg1.l2.m1.1.1.3.cmml" xref="alg1.l2.m1.1.1.3"><partialdiff id="alg1.l2.m1.1.1.3.1.cmml" xref="alg1.l2.m1.1.1.3.1"></partialdiff><ci id="alg1.l2.m1.1.1.3.2.cmml" xref="alg1.l2.m1.1.1.3.2">𝜽</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l2.m1.1c">\boldsymbol{g}_{\boldsymbol{\theta}}\leftarrow\frac{\partial P(\hat{L})}{%
\partial\boldsymbol{\theta}}</annotation><annotation encoding="application/x-llamapun" id="alg1.l2.m1.1d">bold_italic_g start_POSTSUBSCRIPT bold_italic_θ end_POSTSUBSCRIPT ← divide start_ARG ∂ italic_P ( over^ start_ARG italic_L end_ARG ) end_ARG start_ARG ∂ bold_italic_θ end_ARG</annotation></semantics></math> {calculate the partial derivative of <math alttext="P" class="ltx_Math" display="inline" id="alg1.l2.m2.1"><semantics id="alg1.l2.m2.1a"><mi id="alg1.l2.m2.1.1" xref="alg1.l2.m2.1.1.cmml">P</mi><annotation-xml encoding="MathML-Content" id="alg1.l2.m2.1b"><ci id="alg1.l2.m2.1.1.cmml" xref="alg1.l2.m2.1.1">𝑃</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.l2.m2.1c">P</annotation><annotation encoding="application/x-llamapun" id="alg1.l2.m2.1d">italic_P</annotation></semantics></math> with respect to <math alttext="\boldsymbol{\theta}" class="ltx_Math" display="inline" id="alg1.l2.m3.1"><semantics id="alg1.l2.m3.1a"><mi id="alg1.l2.m3.1.1" xref="alg1.l2.m3.1.1.cmml">𝜽</mi><annotation-xml encoding="MathML-Content" id="alg1.l2.m3.1b"><ci id="alg1.l2.m3.1.1.cmml" xref="alg1.l2.m3.1.1">𝜽</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.l2.m3.1c">\boldsymbol{\theta}</annotation><annotation encoding="application/x-llamapun" id="alg1.l2.m3.1d">bold_italic_θ</annotation></semantics></math>}

</div>
<div class="ltx_listingline" id="alg1.l3">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg1.l3.1.1.1" style="font-size:80%;">3:</span></span>  <math alttext="\Delta\boldsymbol{\theta}\leftarrow\alpha\frac{\left|\boldsymbol{\theta}\right%
|}{\left|\boldsymbol{g}_{\boldsymbol{\theta}}\right|}\boldsymbol{g}_{%
\boldsymbol{\theta}}" class="ltx_Math" display="inline" id="alg1.l3.m1.2"><semantics id="alg1.l3.m1.2a"><mrow id="alg1.l3.m1.2.3" xref="alg1.l3.m1.2.3.cmml"><mrow id="alg1.l3.m1.2.3.2" xref="alg1.l3.m1.2.3.2.cmml"><mi id="alg1.l3.m1.2.3.2.2" mathvariant="normal" xref="alg1.l3.m1.2.3.2.2.cmml">Δ</mi><mo id="alg1.l3.m1.2.3.2.1" xref="alg1.l3.m1.2.3.2.1.cmml">⁢</mo><mi id="alg1.l3.m1.2.3.2.3" xref="alg1.l3.m1.2.3.2.3.cmml">𝜽</mi></mrow><mo id="alg1.l3.m1.2.3.1" stretchy="false" xref="alg1.l3.m1.2.3.1.cmml">←</mo><mrow id="alg1.l3.m1.2.3.3" xref="alg1.l3.m1.2.3.3.cmml"><mi id="alg1.l3.m1.2.3.3.2" xref="alg1.l3.m1.2.3.3.2.cmml">α</mi><mo id="alg1.l3.m1.2.3.3.1" xref="alg1.l3.m1.2.3.3.1.cmml">⁢</mo><mfrac id="alg1.l3.m1.2.2" xref="alg1.l3.m1.2.2.cmml"><mrow id="alg1.l3.m1.1.1.1.3" xref="alg1.l3.m1.1.1.1.2.cmml"><mo id="alg1.l3.m1.1.1.1.3.1" xref="alg1.l3.m1.1.1.1.2.1.cmml">|</mo><mi id="alg1.l3.m1.1.1.1.1" xref="alg1.l3.m1.1.1.1.1.cmml">𝜽</mi><mo id="alg1.l3.m1.1.1.1.3.2" xref="alg1.l3.m1.1.1.1.2.1.cmml">|</mo></mrow><mrow id="alg1.l3.m1.2.2.2.1" xref="alg1.l3.m1.2.2.2.2.cmml"><mo id="alg1.l3.m1.2.2.2.1.2" xref="alg1.l3.m1.2.2.2.2.1.cmml">|</mo><msub id="alg1.l3.m1.2.2.2.1.1" xref="alg1.l3.m1.2.2.2.1.1.cmml"><mi id="alg1.l3.m1.2.2.2.1.1.2" xref="alg1.l3.m1.2.2.2.1.1.2.cmml">𝒈</mi><mi id="alg1.l3.m1.2.2.2.1.1.3" xref="alg1.l3.m1.2.2.2.1.1.3.cmml">𝜽</mi></msub><mo id="alg1.l3.m1.2.2.2.1.3" xref="alg1.l3.m1.2.2.2.2.1.cmml">|</mo></mrow></mfrac><mo id="alg1.l3.m1.2.3.3.1a" xref="alg1.l3.m1.2.3.3.1.cmml">⁢</mo><msub id="alg1.l3.m1.2.3.3.3" xref="alg1.l3.m1.2.3.3.3.cmml"><mi id="alg1.l3.m1.2.3.3.3.2" xref="alg1.l3.m1.2.3.3.3.2.cmml">𝒈</mi><mi id="alg1.l3.m1.2.3.3.3.3" xref="alg1.l3.m1.2.3.3.3.3.cmml">𝜽</mi></msub></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l3.m1.2b"><apply id="alg1.l3.m1.2.3.cmml" xref="alg1.l3.m1.2.3"><ci id="alg1.l3.m1.2.3.1.cmml" xref="alg1.l3.m1.2.3.1">←</ci><apply id="alg1.l3.m1.2.3.2.cmml" xref="alg1.l3.m1.2.3.2"><times id="alg1.l3.m1.2.3.2.1.cmml" xref="alg1.l3.m1.2.3.2.1"></times><ci id="alg1.l3.m1.2.3.2.2.cmml" xref="alg1.l3.m1.2.3.2.2">Δ</ci><ci id="alg1.l3.m1.2.3.2.3.cmml" xref="alg1.l3.m1.2.3.2.3">𝜽</ci></apply><apply id="alg1.l3.m1.2.3.3.cmml" xref="alg1.l3.m1.2.3.3"><times id="alg1.l3.m1.2.3.3.1.cmml" xref="alg1.l3.m1.2.3.3.1"></times><ci id="alg1.l3.m1.2.3.3.2.cmml" xref="alg1.l3.m1.2.3.3.2">𝛼</ci><apply id="alg1.l3.m1.2.2.cmml" xref="alg1.l3.m1.2.2"><divide id="alg1.l3.m1.2.2.3.cmml" xref="alg1.l3.m1.2.2"></divide><apply id="alg1.l3.m1.1.1.1.2.cmml" xref="alg1.l3.m1.1.1.1.3"><abs id="alg1.l3.m1.1.1.1.2.1.cmml" xref="alg1.l3.m1.1.1.1.3.1"></abs><ci id="alg1.l3.m1.1.1.1.1.cmml" xref="alg1.l3.m1.1.1.1.1">𝜽</ci></apply><apply id="alg1.l3.m1.2.2.2.2.cmml" xref="alg1.l3.m1.2.2.2.1"><abs id="alg1.l3.m1.2.2.2.2.1.cmml" xref="alg1.l3.m1.2.2.2.1.2"></abs><apply id="alg1.l3.m1.2.2.2.1.1.cmml" xref="alg1.l3.m1.2.2.2.1.1"><csymbol cd="ambiguous" id="alg1.l3.m1.2.2.2.1.1.1.cmml" xref="alg1.l3.m1.2.2.2.1.1">subscript</csymbol><ci id="alg1.l3.m1.2.2.2.1.1.2.cmml" xref="alg1.l3.m1.2.2.2.1.1.2">𝒈</ci><ci id="alg1.l3.m1.2.2.2.1.1.3.cmml" xref="alg1.l3.m1.2.2.2.1.1.3">𝜽</ci></apply></apply></apply><apply id="alg1.l3.m1.2.3.3.3.cmml" xref="alg1.l3.m1.2.3.3.3"><csymbol cd="ambiguous" id="alg1.l3.m1.2.3.3.3.1.cmml" xref="alg1.l3.m1.2.3.3.3">subscript</csymbol><ci id="alg1.l3.m1.2.3.3.3.2.cmml" xref="alg1.l3.m1.2.3.3.3.2">𝒈</ci><ci id="alg1.l3.m1.2.3.3.3.3.cmml" xref="alg1.l3.m1.2.3.3.3.3">𝜽</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l3.m1.2c">\Delta\boldsymbol{\theta}\leftarrow\alpha\frac{\left|\boldsymbol{\theta}\right%
|}{\left|\boldsymbol{g}_{\boldsymbol{\theta}}\right|}\boldsymbol{g}_{%
\boldsymbol{\theta}}</annotation><annotation encoding="application/x-llamapun" id="alg1.l3.m1.2d">roman_Δ bold_italic_θ ← italic_α divide start_ARG | bold_italic_θ | end_ARG start_ARG | bold_italic_g start_POSTSUBSCRIPT bold_italic_θ end_POSTSUBSCRIPT | end_ARG bold_italic_g start_POSTSUBSCRIPT bold_italic_θ end_POSTSUBSCRIPT</annotation></semantics></math> {normalize the gradient}

</div>
<div class="ltx_listingline" id="alg1.l4">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg1.l4.1.1.1" style="font-size:80%;">4:</span></span>  <span class="ltx_text ltx_font_bold" id="alg1.l4.2">for</span> <math alttext="\eta" class="ltx_Math" display="inline" id="alg1.l4.m1.1"><semantics id="alg1.l4.m1.1a"><mi id="alg1.l4.m1.1.1" xref="alg1.l4.m1.1.1.cmml">η</mi><annotation-xml encoding="MathML-Content" id="alg1.l4.m1.1b"><ci id="alg1.l4.m1.1.1.cmml" xref="alg1.l4.m1.1.1">𝜂</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.l4.m1.1c">\eta</annotation><annotation encoding="application/x-llamapun" id="alg1.l4.m1.1d">italic_η</annotation></semantics></math> in <math alttext="[\eta_{1},\eta_{2},...]" class="ltx_Math" display="inline" id="alg1.l4.m2.3"><semantics id="alg1.l4.m2.3a"><mrow id="alg1.l4.m2.3.3.2" xref="alg1.l4.m2.3.3.3.cmml"><mo id="alg1.l4.m2.3.3.2.3" stretchy="false" xref="alg1.l4.m2.3.3.3.cmml">[</mo><msub id="alg1.l4.m2.2.2.1.1" xref="alg1.l4.m2.2.2.1.1.cmml"><mi id="alg1.l4.m2.2.2.1.1.2" xref="alg1.l4.m2.2.2.1.1.2.cmml">η</mi><mn id="alg1.l4.m2.2.2.1.1.3" xref="alg1.l4.m2.2.2.1.1.3.cmml">1</mn></msub><mo id="alg1.l4.m2.3.3.2.4" xref="alg1.l4.m2.3.3.3.cmml">,</mo><msub id="alg1.l4.m2.3.3.2.2" xref="alg1.l4.m2.3.3.2.2.cmml"><mi id="alg1.l4.m2.3.3.2.2.2" xref="alg1.l4.m2.3.3.2.2.2.cmml">η</mi><mn id="alg1.l4.m2.3.3.2.2.3" xref="alg1.l4.m2.3.3.2.2.3.cmml">2</mn></msub><mo id="alg1.l4.m2.3.3.2.5" xref="alg1.l4.m2.3.3.3.cmml">,</mo><mi id="alg1.l4.m2.1.1" mathvariant="normal" xref="alg1.l4.m2.1.1.cmml">…</mi><mo id="alg1.l4.m2.3.3.2.6" stretchy="false" xref="alg1.l4.m2.3.3.3.cmml">]</mo></mrow><annotation-xml encoding="MathML-Content" id="alg1.l4.m2.3b"><list id="alg1.l4.m2.3.3.3.cmml" xref="alg1.l4.m2.3.3.2"><apply id="alg1.l4.m2.2.2.1.1.cmml" xref="alg1.l4.m2.2.2.1.1"><csymbol cd="ambiguous" id="alg1.l4.m2.2.2.1.1.1.cmml" xref="alg1.l4.m2.2.2.1.1">subscript</csymbol><ci id="alg1.l4.m2.2.2.1.1.2.cmml" xref="alg1.l4.m2.2.2.1.1.2">𝜂</ci><cn id="alg1.l4.m2.2.2.1.1.3.cmml" type="integer" xref="alg1.l4.m2.2.2.1.1.3">1</cn></apply><apply id="alg1.l4.m2.3.3.2.2.cmml" xref="alg1.l4.m2.3.3.2.2"><csymbol cd="ambiguous" id="alg1.l4.m2.3.3.2.2.1.cmml" xref="alg1.l4.m2.3.3.2.2">subscript</csymbol><ci id="alg1.l4.m2.3.3.2.2.2.cmml" xref="alg1.l4.m2.3.3.2.2.2">𝜂</ci><cn id="alg1.l4.m2.3.3.2.2.3.cmml" type="integer" xref="alg1.l4.m2.3.3.2.2.3">2</cn></apply><ci id="alg1.l4.m2.1.1.cmml" xref="alg1.l4.m2.1.1">…</ci></list></annotation-xml><annotation encoding="application/x-tex" id="alg1.l4.m2.3c">[\eta_{1},\eta_{2},...]</annotation><annotation encoding="application/x-llamapun" id="alg1.l4.m2.3d">[ italic_η start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT , italic_η start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT , … ]</annotation></semantics></math> <span class="ltx_text ltx_font_bold" id="alg1.l4.3">do</span>
</div>
<div class="ltx_listingline" id="alg1.l5">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg1.l5.1.1.1" style="font-size:80%;">5:</span></span>     <math alttext="\hat{L}_{\eta}\leftarrow G(u,\mathcal{C};\boldsymbol{\theta}+\eta\Delta%
\boldsymbol{\theta})" class="ltx_Math" display="inline" id="alg1.l5.m1.3"><semantics id="alg1.l5.m1.3a"><mrow id="alg1.l5.m1.3.3" xref="alg1.l5.m1.3.3.cmml"><msub id="alg1.l5.m1.3.3.3" xref="alg1.l5.m1.3.3.3.cmml"><mover accent="true" id="alg1.l5.m1.3.3.3.2" xref="alg1.l5.m1.3.3.3.2.cmml"><mi id="alg1.l5.m1.3.3.3.2.2" xref="alg1.l5.m1.3.3.3.2.2.cmml">L</mi><mo id="alg1.l5.m1.3.3.3.2.1" xref="alg1.l5.m1.3.3.3.2.1.cmml">^</mo></mover><mi id="alg1.l5.m1.3.3.3.3" xref="alg1.l5.m1.3.3.3.3.cmml">η</mi></msub><mo id="alg1.l5.m1.3.3.2" stretchy="false" xref="alg1.l5.m1.3.3.2.cmml">←</mo><mrow id="alg1.l5.m1.3.3.1" xref="alg1.l5.m1.3.3.1.cmml"><mi id="alg1.l5.m1.3.3.1.3" xref="alg1.l5.m1.3.3.1.3.cmml">G</mi><mo id="alg1.l5.m1.3.3.1.2" xref="alg1.l5.m1.3.3.1.2.cmml">⁢</mo><mrow id="alg1.l5.m1.3.3.1.1.1" xref="alg1.l5.m1.3.3.1.1.2.cmml"><mo id="alg1.l5.m1.3.3.1.1.1.2" stretchy="false" xref="alg1.l5.m1.3.3.1.1.2.cmml">(</mo><mi id="alg1.l5.m1.1.1" xref="alg1.l5.m1.1.1.cmml">u</mi><mo id="alg1.l5.m1.3.3.1.1.1.3" xref="alg1.l5.m1.3.3.1.1.2.cmml">,</mo><mi class="ltx_font_mathcaligraphic" id="alg1.l5.m1.2.2" xref="alg1.l5.m1.2.2.cmml">𝒞</mi><mo id="alg1.l5.m1.3.3.1.1.1.4" xref="alg1.l5.m1.3.3.1.1.2.cmml">;</mo><mrow id="alg1.l5.m1.3.3.1.1.1.1" xref="alg1.l5.m1.3.3.1.1.1.1.cmml"><mi id="alg1.l5.m1.3.3.1.1.1.1.2" xref="alg1.l5.m1.3.3.1.1.1.1.2.cmml">𝜽</mi><mo id="alg1.l5.m1.3.3.1.1.1.1.1" xref="alg1.l5.m1.3.3.1.1.1.1.1.cmml">+</mo><mrow id="alg1.l5.m1.3.3.1.1.1.1.3" xref="alg1.l5.m1.3.3.1.1.1.1.3.cmml"><mi id="alg1.l5.m1.3.3.1.1.1.1.3.2" xref="alg1.l5.m1.3.3.1.1.1.1.3.2.cmml">η</mi><mo id="alg1.l5.m1.3.3.1.1.1.1.3.1" xref="alg1.l5.m1.3.3.1.1.1.1.3.1.cmml">⁢</mo><mi id="alg1.l5.m1.3.3.1.1.1.1.3.3" mathvariant="normal" xref="alg1.l5.m1.3.3.1.1.1.1.3.3.cmml">Δ</mi><mo id="alg1.l5.m1.3.3.1.1.1.1.3.1a" xref="alg1.l5.m1.3.3.1.1.1.1.3.1.cmml">⁢</mo><mi id="alg1.l5.m1.3.3.1.1.1.1.3.4" xref="alg1.l5.m1.3.3.1.1.1.1.3.4.cmml">𝜽</mi></mrow></mrow><mo id="alg1.l5.m1.3.3.1.1.1.5" stretchy="false" xref="alg1.l5.m1.3.3.1.1.2.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l5.m1.3b"><apply id="alg1.l5.m1.3.3.cmml" xref="alg1.l5.m1.3.3"><ci id="alg1.l5.m1.3.3.2.cmml" xref="alg1.l5.m1.3.3.2">←</ci><apply id="alg1.l5.m1.3.3.3.cmml" xref="alg1.l5.m1.3.3.3"><csymbol cd="ambiguous" id="alg1.l5.m1.3.3.3.1.cmml" xref="alg1.l5.m1.3.3.3">subscript</csymbol><apply id="alg1.l5.m1.3.3.3.2.cmml" xref="alg1.l5.m1.3.3.3.2"><ci id="alg1.l5.m1.3.3.3.2.1.cmml" xref="alg1.l5.m1.3.3.3.2.1">^</ci><ci id="alg1.l5.m1.3.3.3.2.2.cmml" xref="alg1.l5.m1.3.3.3.2.2">𝐿</ci></apply><ci id="alg1.l5.m1.3.3.3.3.cmml" xref="alg1.l5.m1.3.3.3.3">𝜂</ci></apply><apply id="alg1.l5.m1.3.3.1.cmml" xref="alg1.l5.m1.3.3.1"><times id="alg1.l5.m1.3.3.1.2.cmml" xref="alg1.l5.m1.3.3.1.2"></times><ci id="alg1.l5.m1.3.3.1.3.cmml" xref="alg1.l5.m1.3.3.1.3">𝐺</ci><vector id="alg1.l5.m1.3.3.1.1.2.cmml" xref="alg1.l5.m1.3.3.1.1.1"><ci id="alg1.l5.m1.1.1.cmml" xref="alg1.l5.m1.1.1">𝑢</ci><ci id="alg1.l5.m1.2.2.cmml" xref="alg1.l5.m1.2.2">𝒞</ci><apply id="alg1.l5.m1.3.3.1.1.1.1.cmml" xref="alg1.l5.m1.3.3.1.1.1.1"><plus id="alg1.l5.m1.3.3.1.1.1.1.1.cmml" xref="alg1.l5.m1.3.3.1.1.1.1.1"></plus><ci id="alg1.l5.m1.3.3.1.1.1.1.2.cmml" xref="alg1.l5.m1.3.3.1.1.1.1.2">𝜽</ci><apply id="alg1.l5.m1.3.3.1.1.1.1.3.cmml" xref="alg1.l5.m1.3.3.1.1.1.1.3"><times id="alg1.l5.m1.3.3.1.1.1.1.3.1.cmml" xref="alg1.l5.m1.3.3.1.1.1.1.3.1"></times><ci id="alg1.l5.m1.3.3.1.1.1.1.3.2.cmml" xref="alg1.l5.m1.3.3.1.1.1.1.3.2">𝜂</ci><ci id="alg1.l5.m1.3.3.1.1.1.1.3.3.cmml" xref="alg1.l5.m1.3.3.1.1.1.1.3.3">Δ</ci><ci id="alg1.l5.m1.3.3.1.1.1.1.3.4.cmml" xref="alg1.l5.m1.3.3.1.1.1.1.3.4">𝜽</ci></apply></apply></vector></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l5.m1.3c">\hat{L}_{\eta}\leftarrow G(u,\mathcal{C};\boldsymbol{\theta}+\eta\Delta%
\boldsymbol{\theta})</annotation><annotation encoding="application/x-llamapun" id="alg1.l5.m1.3d">over^ start_ARG italic_L end_ARG start_POSTSUBSCRIPT italic_η end_POSTSUBSCRIPT ← italic_G ( italic_u , caligraphic_C ; bold_italic_θ + italic_η roman_Δ bold_italic_θ )</annotation></semantics></math>
</div>
<div class="ltx_listingline" id="alg1.l6">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg1.l6.1.1.1" style="font-size:80%;">6:</span></span>     <math alttext="E_{\eta}\leftarrow E(u,\hat{L}_{\eta})" class="ltx_Math" display="inline" id="alg1.l6.m1.2"><semantics id="alg1.l6.m1.2a"><mrow id="alg1.l6.m1.2.2" xref="alg1.l6.m1.2.2.cmml"><msub id="alg1.l6.m1.2.2.3" xref="alg1.l6.m1.2.2.3.cmml"><mi id="alg1.l6.m1.2.2.3.2" xref="alg1.l6.m1.2.2.3.2.cmml">E</mi><mi id="alg1.l6.m1.2.2.3.3" xref="alg1.l6.m1.2.2.3.3.cmml">η</mi></msub><mo id="alg1.l6.m1.2.2.2" stretchy="false" xref="alg1.l6.m1.2.2.2.cmml">←</mo><mrow id="alg1.l6.m1.2.2.1" xref="alg1.l6.m1.2.2.1.cmml"><mi id="alg1.l6.m1.2.2.1.3" xref="alg1.l6.m1.2.2.1.3.cmml">E</mi><mo id="alg1.l6.m1.2.2.1.2" xref="alg1.l6.m1.2.2.1.2.cmml">⁢</mo><mrow id="alg1.l6.m1.2.2.1.1.1" xref="alg1.l6.m1.2.2.1.1.2.cmml"><mo id="alg1.l6.m1.2.2.1.1.1.2" stretchy="false" xref="alg1.l6.m1.2.2.1.1.2.cmml">(</mo><mi id="alg1.l6.m1.1.1" xref="alg1.l6.m1.1.1.cmml">u</mi><mo id="alg1.l6.m1.2.2.1.1.1.3" xref="alg1.l6.m1.2.2.1.1.2.cmml">,</mo><msub id="alg1.l6.m1.2.2.1.1.1.1" xref="alg1.l6.m1.2.2.1.1.1.1.cmml"><mover accent="true" id="alg1.l6.m1.2.2.1.1.1.1.2" xref="alg1.l6.m1.2.2.1.1.1.1.2.cmml"><mi id="alg1.l6.m1.2.2.1.1.1.1.2.2" xref="alg1.l6.m1.2.2.1.1.1.1.2.2.cmml">L</mi><mo id="alg1.l6.m1.2.2.1.1.1.1.2.1" xref="alg1.l6.m1.2.2.1.1.1.1.2.1.cmml">^</mo></mover><mi id="alg1.l6.m1.2.2.1.1.1.1.3" xref="alg1.l6.m1.2.2.1.1.1.1.3.cmml">η</mi></msub><mo id="alg1.l6.m1.2.2.1.1.1.4" stretchy="false" xref="alg1.l6.m1.2.2.1.1.2.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l6.m1.2b"><apply id="alg1.l6.m1.2.2.cmml" xref="alg1.l6.m1.2.2"><ci id="alg1.l6.m1.2.2.2.cmml" xref="alg1.l6.m1.2.2.2">←</ci><apply id="alg1.l6.m1.2.2.3.cmml" xref="alg1.l6.m1.2.2.3"><csymbol cd="ambiguous" id="alg1.l6.m1.2.2.3.1.cmml" xref="alg1.l6.m1.2.2.3">subscript</csymbol><ci id="alg1.l6.m1.2.2.3.2.cmml" xref="alg1.l6.m1.2.2.3.2">𝐸</ci><ci id="alg1.l6.m1.2.2.3.3.cmml" xref="alg1.l6.m1.2.2.3.3">𝜂</ci></apply><apply id="alg1.l6.m1.2.2.1.cmml" xref="alg1.l6.m1.2.2.1"><times id="alg1.l6.m1.2.2.1.2.cmml" xref="alg1.l6.m1.2.2.1.2"></times><ci id="alg1.l6.m1.2.2.1.3.cmml" xref="alg1.l6.m1.2.2.1.3">𝐸</ci><interval closure="open" id="alg1.l6.m1.2.2.1.1.2.cmml" xref="alg1.l6.m1.2.2.1.1.1"><ci id="alg1.l6.m1.1.1.cmml" xref="alg1.l6.m1.1.1">𝑢</ci><apply id="alg1.l6.m1.2.2.1.1.1.1.cmml" xref="alg1.l6.m1.2.2.1.1.1.1"><csymbol cd="ambiguous" id="alg1.l6.m1.2.2.1.1.1.1.1.cmml" xref="alg1.l6.m1.2.2.1.1.1.1">subscript</csymbol><apply id="alg1.l6.m1.2.2.1.1.1.1.2.cmml" xref="alg1.l6.m1.2.2.1.1.1.1.2"><ci id="alg1.l6.m1.2.2.1.1.1.1.2.1.cmml" xref="alg1.l6.m1.2.2.1.1.1.1.2.1">^</ci><ci id="alg1.l6.m1.2.2.1.1.1.1.2.2.cmml" xref="alg1.l6.m1.2.2.1.1.1.1.2.2">𝐿</ci></apply><ci id="alg1.l6.m1.2.2.1.1.1.1.3.cmml" xref="alg1.l6.m1.2.2.1.1.1.1.3">𝜂</ci></apply></interval></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l6.m1.2c">E_{\eta}\leftarrow E(u,\hat{L}_{\eta})</annotation><annotation encoding="application/x-llamapun" id="alg1.l6.m1.2d">italic_E start_POSTSUBSCRIPT italic_η end_POSTSUBSCRIPT ← italic_E ( italic_u , over^ start_ARG italic_L end_ARG start_POSTSUBSCRIPT italic_η end_POSTSUBSCRIPT )</annotation></semantics></math>
</div>
<div class="ltx_listingline" id="alg1.l7">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg1.l7.1.1.1" style="font-size:80%;">7:</span></span>  <span class="ltx_text ltx_font_bold" id="alg1.l7.2">end</span> <span class="ltx_text ltx_font_bold" id="alg1.l7.3">for</span>
</div>
<div class="ltx_listingline" id="alg1.l8">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg1.l8.1.1.1" style="font-size:80%;">8:</span></span>  <math alttext="\eta^{*}=\mathrm{argmax}_{\eta}E_{\eta}" class="ltx_Math" display="inline" id="alg1.l8.m1.1"><semantics id="alg1.l8.m1.1a"><mrow id="alg1.l8.m1.1.1" xref="alg1.l8.m1.1.1.cmml"><msup id="alg1.l8.m1.1.1.2" xref="alg1.l8.m1.1.1.2.cmml"><mi id="alg1.l8.m1.1.1.2.2" xref="alg1.l8.m1.1.1.2.2.cmml">η</mi><mo id="alg1.l8.m1.1.1.2.3" xref="alg1.l8.m1.1.1.2.3.cmml">∗</mo></msup><mo id="alg1.l8.m1.1.1.1" xref="alg1.l8.m1.1.1.1.cmml">=</mo><mrow id="alg1.l8.m1.1.1.3" xref="alg1.l8.m1.1.1.3.cmml"><msub id="alg1.l8.m1.1.1.3.2" xref="alg1.l8.m1.1.1.3.2.cmml"><mi id="alg1.l8.m1.1.1.3.2.2" xref="alg1.l8.m1.1.1.3.2.2.cmml">argmax</mi><mi id="alg1.l8.m1.1.1.3.2.3" xref="alg1.l8.m1.1.1.3.2.3.cmml">η</mi></msub><mo id="alg1.l8.m1.1.1.3.1" xref="alg1.l8.m1.1.1.3.1.cmml">⁢</mo><msub id="alg1.l8.m1.1.1.3.3" xref="alg1.l8.m1.1.1.3.3.cmml"><mi id="alg1.l8.m1.1.1.3.3.2" xref="alg1.l8.m1.1.1.3.3.2.cmml">E</mi><mi id="alg1.l8.m1.1.1.3.3.3" xref="alg1.l8.m1.1.1.3.3.3.cmml">η</mi></msub></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l8.m1.1b"><apply id="alg1.l8.m1.1.1.cmml" xref="alg1.l8.m1.1.1"><eq id="alg1.l8.m1.1.1.1.cmml" xref="alg1.l8.m1.1.1.1"></eq><apply id="alg1.l8.m1.1.1.2.cmml" xref="alg1.l8.m1.1.1.2"><csymbol cd="ambiguous" id="alg1.l8.m1.1.1.2.1.cmml" xref="alg1.l8.m1.1.1.2">superscript</csymbol><ci id="alg1.l8.m1.1.1.2.2.cmml" xref="alg1.l8.m1.1.1.2.2">𝜂</ci><times id="alg1.l8.m1.1.1.2.3.cmml" xref="alg1.l8.m1.1.1.2.3"></times></apply><apply id="alg1.l8.m1.1.1.3.cmml" xref="alg1.l8.m1.1.1.3"><times id="alg1.l8.m1.1.1.3.1.cmml" xref="alg1.l8.m1.1.1.3.1"></times><apply id="alg1.l8.m1.1.1.3.2.cmml" xref="alg1.l8.m1.1.1.3.2"><csymbol cd="ambiguous" id="alg1.l8.m1.1.1.3.2.1.cmml" xref="alg1.l8.m1.1.1.3.2">subscript</csymbol><ci id="alg1.l8.m1.1.1.3.2.2.cmml" xref="alg1.l8.m1.1.1.3.2.2">argmax</ci><ci id="alg1.l8.m1.1.1.3.2.3.cmml" xref="alg1.l8.m1.1.1.3.2.3">𝜂</ci></apply><apply id="alg1.l8.m1.1.1.3.3.cmml" xref="alg1.l8.m1.1.1.3.3"><csymbol cd="ambiguous" id="alg1.l8.m1.1.1.3.3.1.cmml" xref="alg1.l8.m1.1.1.3.3">subscript</csymbol><ci id="alg1.l8.m1.1.1.3.3.2.cmml" xref="alg1.l8.m1.1.1.3.3.2">𝐸</ci><ci id="alg1.l8.m1.1.1.3.3.3.cmml" xref="alg1.l8.m1.1.1.3.3.3">𝜂</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l8.m1.1c">\eta^{*}=\mathrm{argmax}_{\eta}E_{\eta}</annotation><annotation encoding="application/x-llamapun" id="alg1.l8.m1.1d">italic_η start_POSTSUPERSCRIPT ∗ end_POSTSUPERSCRIPT = roman_argmax start_POSTSUBSCRIPT italic_η end_POSTSUBSCRIPT italic_E start_POSTSUBSCRIPT italic_η end_POSTSUBSCRIPT</annotation></semantics></math>
</div>
<div class="ltx_listingline" id="alg1.l9">
<span class="ltx_tag ltx_tag_listingline"><span class="ltx_text" id="alg1.l9.1.1.1" style="font-size:80%;">9:</span></span>  <span class="ltx_text ltx_font_bold" id="alg1.l9.2">return</span>  <math alttext="\widehat{L^{*}}_{LAST}=L_{\eta^{*}}" class="ltx_Math" display="inline" id="alg1.l9.m1.1"><semantics id="alg1.l9.m1.1a"><mrow id="alg1.l9.m1.1.1" xref="alg1.l9.m1.1.1.cmml"><msub id="alg1.l9.m1.1.1.2" xref="alg1.l9.m1.1.1.2.cmml"><mover accent="true" id="alg1.l9.m1.1.1.2.2" xref="alg1.l9.m1.1.1.2.2.cmml"><msup id="alg1.l9.m1.1.1.2.2.2" xref="alg1.l9.m1.1.1.2.2.2.cmml"><mi id="alg1.l9.m1.1.1.2.2.2.2" xref="alg1.l9.m1.1.1.2.2.2.2.cmml">L</mi><mo id="alg1.l9.m1.1.1.2.2.2.3" xref="alg1.l9.m1.1.1.2.2.2.3.cmml">∗</mo></msup><mo id="alg1.l9.m1.1.1.2.2.1" xref="alg1.l9.m1.1.1.2.2.1.cmml">^</mo></mover><mrow id="alg1.l9.m1.1.1.2.3" xref="alg1.l9.m1.1.1.2.3.cmml"><mi id="alg1.l9.m1.1.1.2.3.2" xref="alg1.l9.m1.1.1.2.3.2.cmml">L</mi><mo id="alg1.l9.m1.1.1.2.3.1" xref="alg1.l9.m1.1.1.2.3.1.cmml">⁢</mo><mi id="alg1.l9.m1.1.1.2.3.3" xref="alg1.l9.m1.1.1.2.3.3.cmml">A</mi><mo id="alg1.l9.m1.1.1.2.3.1a" xref="alg1.l9.m1.1.1.2.3.1.cmml">⁢</mo><mi id="alg1.l9.m1.1.1.2.3.4" xref="alg1.l9.m1.1.1.2.3.4.cmml">S</mi><mo id="alg1.l9.m1.1.1.2.3.1b" xref="alg1.l9.m1.1.1.2.3.1.cmml">⁢</mo><mi id="alg1.l9.m1.1.1.2.3.5" xref="alg1.l9.m1.1.1.2.3.5.cmml">T</mi></mrow></msub><mo id="alg1.l9.m1.1.1.1" xref="alg1.l9.m1.1.1.1.cmml">=</mo><msub id="alg1.l9.m1.1.1.3" xref="alg1.l9.m1.1.1.3.cmml"><mi id="alg1.l9.m1.1.1.3.2" xref="alg1.l9.m1.1.1.3.2.cmml">L</mi><msup id="alg1.l9.m1.1.1.3.3" xref="alg1.l9.m1.1.1.3.3.cmml"><mi id="alg1.l9.m1.1.1.3.3.2" xref="alg1.l9.m1.1.1.3.3.2.cmml">η</mi><mo id="alg1.l9.m1.1.1.3.3.3" xref="alg1.l9.m1.1.1.3.3.3.cmml">∗</mo></msup></msub></mrow><annotation-xml encoding="MathML-Content" id="alg1.l9.m1.1b"><apply id="alg1.l9.m1.1.1.cmml" xref="alg1.l9.m1.1.1"><eq id="alg1.l9.m1.1.1.1.cmml" xref="alg1.l9.m1.1.1.1"></eq><apply id="alg1.l9.m1.1.1.2.cmml" xref="alg1.l9.m1.1.1.2"><csymbol cd="ambiguous" id="alg1.l9.m1.1.1.2.1.cmml" xref="alg1.l9.m1.1.1.2">subscript</csymbol><apply id="alg1.l9.m1.1.1.2.2.cmml" xref="alg1.l9.m1.1.1.2.2"><ci id="alg1.l9.m1.1.1.2.2.1.cmml" xref="alg1.l9.m1.1.1.2.2.1">^</ci><apply id="alg1.l9.m1.1.1.2.2.2.cmml" xref="alg1.l9.m1.1.1.2.2.2"><csymbol cd="ambiguous" id="alg1.l9.m1.1.1.2.2.2.1.cmml" xref="alg1.l9.m1.1.1.2.2.2">superscript</csymbol><ci id="alg1.l9.m1.1.1.2.2.2.2.cmml" xref="alg1.l9.m1.1.1.2.2.2.2">𝐿</ci><times id="alg1.l9.m1.1.1.2.2.2.3.cmml" xref="alg1.l9.m1.1.1.2.2.2.3"></times></apply></apply><apply id="alg1.l9.m1.1.1.2.3.cmml" xref="alg1.l9.m1.1.1.2.3"><times id="alg1.l9.m1.1.1.2.3.1.cmml" xref="alg1.l9.m1.1.1.2.3.1"></times><ci id="alg1.l9.m1.1.1.2.3.2.cmml" xref="alg1.l9.m1.1.1.2.3.2">𝐿</ci><ci id="alg1.l9.m1.1.1.2.3.3.cmml" xref="alg1.l9.m1.1.1.2.3.3">𝐴</ci><ci id="alg1.l9.m1.1.1.2.3.4.cmml" xref="alg1.l9.m1.1.1.2.3.4">𝑆</ci><ci id="alg1.l9.m1.1.1.2.3.5.cmml" xref="alg1.l9.m1.1.1.2.3.5">𝑇</ci></apply></apply><apply id="alg1.l9.m1.1.1.3.cmml" xref="alg1.l9.m1.1.1.3"><csymbol cd="ambiguous" id="alg1.l9.m1.1.1.3.1.cmml" xref="alg1.l9.m1.1.1.3">subscript</csymbol><ci id="alg1.l9.m1.1.1.3.2.cmml" xref="alg1.l9.m1.1.1.3.2">𝐿</ci><apply id="alg1.l9.m1.1.1.3.3.cmml" xref="alg1.l9.m1.1.1.3.3"><csymbol cd="ambiguous" id="alg1.l9.m1.1.1.3.3.1.cmml" xref="alg1.l9.m1.1.1.3.3">superscript</csymbol><ci id="alg1.l9.m1.1.1.3.3.2.cmml" xref="alg1.l9.m1.1.1.3.3.2">𝜂</ci><times id="alg1.l9.m1.1.1.3.3.3.cmml" xref="alg1.l9.m1.1.1.3.3.3"></times></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l9.m1.1c">\widehat{L^{*}}_{LAST}=L_{\eta^{*}}</annotation><annotation encoding="application/x-llamapun" id="alg1.l9.m1.1d">over^ start_ARG italic_L start_POSTSUPERSCRIPT ∗ end_POSTSUPERSCRIPT end_ARG start_POSTSUBSCRIPT italic_L italic_A italic_S italic_T end_POSTSUBSCRIPT = italic_L start_POSTSUBSCRIPT italic_η start_POSTSUPERSCRIPT ∗ end_POSTSUPERSCRIPT end_POSTSUBSCRIPT</annotation></semantics></math>
</div>
</div>
</figure>
</section>
<section class="ltx_section" id="S4">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">4. </span>Experiments</h2>
<section class="ltx_subsection" id="S4.SS1">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.1. </span>Offline Experiments</h3>
<div class="ltx_para" id="S4.SS1.p1">
<p class="ltx_p" id="S4.SS1.p1.1">We conduct our offline experiments on the benchmark LibRerank<span class="ltx_note ltx_role_footnote" id="footnote1"><sup class="ltx_note_mark">1</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">1</sup><span class="ltx_tag ltx_tag_note">1</span>https://github.com/LibRerank-Community/LibRerank</span></span></span> with the public recommendation dataset Ad2<span class="ltx_note ltx_role_footnote" id="footnote2"><sup class="ltx_note_mark">2</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">2</sup><span class="ltx_tag ltx_tag_note">2</span>https://tianchi.aliyun.com/dataset/56</span></span></span>. The source code has been released<span class="ltx_note ltx_role_footnote" id="footnote3"><sup class="ltx_note_mark">3</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">3</sup><span class="ltx_tag ltx_tag_note">3</span>https://anonymous.4open.science/r/LAST-BCCE</span></span></span>. For more details on the experimental setup, please refer to Auxiliary Materials. Our offline experiments aim to answer two key questions: (i) Does LAST outperform the latest re-ranking models? and (ii) How do hyper-parameters impact the effectiveness of LAST?</p>
</div>
<section class="ltx_subsubsection" id="S4.SS1.SSS1">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">4.1.1. </span>Performance Analysis</h4>
<div class="ltx_para" id="S4.SS1.SSS1.p1">
<p class="ltx_p" id="S4.SS1.SSS1.p1.1">In the first offline experiment, we train re-ranking models to boost user engagement. To make a fair comparison between AE and non-AE models, we use NDCG as the evaluation function to train AE models. The non-AE methods obtain the final recommendation list by ranking candidates according to the engagement probability prediction of each item from high to low.
Table. <a class="ltx_ref" href="https://arxiv.org/html/2406.14004v1#S4.T1" title="Table 1 ‣ 4.1.1. Performance Analysis ‣ 4.1. Offline Experiments ‣ 4. Experiments ‣ A re-ranking model with pre-feedback learning at serving time in e-commerce"><span class="ltx_text ltx_ref_tag">1</span></a> summarizes the results. It is interesting to see that the non-AE methods, including GSF<cite class="ltx_cite ltx_citemacro_citep">(Ai et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2406.14004v1#bib.bib3" title="">2019</a>)</cite>, DLCM<cite class="ltx_cite ltx_citemacro_citep">(Ai et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2406.14004v1#bib.bib2" title="">2018</a>)</cite>, SetRank<cite class="ltx_cite ltx_citemacro_citep">(Pang et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2406.14004v1#bib.bib16" title="">2020</a>)</cite>, and PRM<cite class="ltx_cite ltx_citemacro_citep">(Pei et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2406.14004v1#bib.bib17" title="">2019</a>)</cite>, outperform the AE methods, i.e. EGR<cite class="ltx_cite ltx_citemacro_citep">(Wang et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2406.14004v1#bib.bib20" title="">2019</a>)</cite> and CMR(Greedy)<cite class="ltx_cite ltx_citemacro_citep">(Chen et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2406.14004v1#bib.bib5" title="">2023</a>)</cite>. These AE methods use a single-list strategy, which means the actor will only generate a single recommendation list, by picking the item with the largest selection probability in each step. We think it is because ”ranking the items according to the predicted user engagement probabilities” is a very strong prior, it significantly reduced the modeling difficulty. RL searching algorithms do not know this prior and thus converge to a worse local optimal. When it comes to AE re-ranking models with the multi-list strategy including CMR(Sampling) and LAST, they beat other baselines by a large margin. It reflects the simple fact that more trials can always lead to better results, in probability. The margins seem surprisingly large. This is because MAP and NDCG are discrete functions and heavily emphasize the top lists. For example, the NDCG value of the perfect list ”1, 0, 0, 0, 0” is 1 and 0.63 for a close list ”0, 1, 0, 0, 0”. The former is nearly 59 percent higher than the latter, which appears to be exaggerated. Here 1 in the list means a relevant item and 0 means an irrelevant one. LAST performs significantly better than all other baselines, which supports the benefit of serving time adaptation.</p>
</div>
<figure class="ltx_table" id="S4.T1">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_table"><span class="ltx_text" id="S4.T1.8.2.1" style="font-size:90%;">Table 1</span>. </span><span class="ltx_text" id="S4.T1.2.1" style="font-size:90%;">Offline comparison of re-ranking models. The AE re-ranking models use the NDCG metric as the evaluator. The best results is bolded and the runner-up is underlined. * indicates that the improvement over the best baseline is statistically significant (<math alttext="p" class="ltx_Math" display="inline" id="S4.T1.2.1.m1.1"><semantics id="S4.T1.2.1.m1.1b"><mi id="S4.T1.2.1.m1.1.1" xref="S4.T1.2.1.m1.1.1.cmml">p</mi><annotation-xml encoding="MathML-Content" id="S4.T1.2.1.m1.1c"><ci id="S4.T1.2.1.m1.1.1.cmml" xref="S4.T1.2.1.m1.1.1">𝑝</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.T1.2.1.m1.1d">p</annotation><annotation encoding="application/x-llamapun" id="S4.T1.2.1.m1.1e">italic_p</annotation></semantics></math>-value ¡ 0.05).</span></figcaption>
<table class="ltx_tabular ltx_guessed_headers ltx_align_middle" id="S4.T1.6">
<thead class="ltx_thead">
<tr class="ltx_tr" id="S4.T1.6.5.1">
<th class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_border_tt" id="S4.T1.6.5.1.1">Method</th>
<th class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_border_tt" id="S4.T1.6.5.1.2">map@5</th>
<th class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_border_tt" id="S4.T1.6.5.1.3">map@10</th>
<th class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_border_tt" id="S4.T1.6.5.1.4">ndcg@5</th>
<th class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_border_tt" id="S4.T1.6.5.1.5">ndcg@10</th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr class="ltx_tr" id="S4.T1.6.6.1">
<td class="ltx_td ltx_align_left ltx_border_t" id="S4.T1.6.6.1.1">GSF</td>
<td class="ltx_td ltx_align_left ltx_border_t" id="S4.T1.6.6.1.2">0.6038</td>
<td class="ltx_td ltx_align_left ltx_border_t" id="S4.T1.6.6.1.3">0.6074</td>
<td class="ltx_td ltx_align_left ltx_border_t" id="S4.T1.6.6.1.4">0.6838</td>
<td class="ltx_td ltx_align_left ltx_border_t" id="S4.T1.6.6.1.5">0.6984</td>
</tr>
<tr class="ltx_tr" id="S4.T1.6.7.2">
<td class="ltx_td ltx_align_left" id="S4.T1.6.7.2.1">DLCM</td>
<td class="ltx_td ltx_align_left" id="S4.T1.6.7.2.2">0.6169</td>
<td class="ltx_td ltx_align_left" id="S4.T1.6.7.2.3">0.6201</td>
<td class="ltx_td ltx_align_left" id="S4.T1.6.7.2.4">0.6948</td>
<td class="ltx_td ltx_align_left" id="S4.T1.6.7.2.5">0.7080</td>
</tr>
<tr class="ltx_tr" id="S4.T1.6.8.3">
<td class="ltx_td ltx_align_left" id="S4.T1.6.8.3.1">SetRank</td>
<td class="ltx_td ltx_align_left" id="S4.T1.6.8.3.2">0.6084</td>
<td class="ltx_td ltx_align_left" id="S4.T1.6.8.3.3">0.6122</td>
<td class="ltx_td ltx_align_left" id="S4.T1.6.8.3.4">0.6878</td>
<td class="ltx_td ltx_align_left" id="S4.T1.6.8.3.5">0.7020</td>
</tr>
<tr class="ltx_tr" id="S4.T1.6.9.4">
<td class="ltx_td ltx_align_left" id="S4.T1.6.9.4.1">PRM</td>
<td class="ltx_td ltx_align_left" id="S4.T1.6.9.4.2">0.6176</td>
<td class="ltx_td ltx_align_left" id="S4.T1.6.9.4.3">0.6209</td>
<td class="ltx_td ltx_align_left" id="S4.T1.6.9.4.4">0.6950</td>
<td class="ltx_td ltx_align_left" id="S4.T1.6.9.4.5">0.7087</td>
</tr>
<tr class="ltx_tr" id="S4.T1.6.10.5">
<td class="ltx_td ltx_align_left" id="S4.T1.6.10.5.1">EGR</td>
<td class="ltx_td ltx_align_left" id="S4.T1.6.10.5.2">0.6010</td>
<td class="ltx_td ltx_align_left" id="S4.T1.6.10.5.3">0.6047</td>
<td class="ltx_td ltx_align_left" id="S4.T1.6.10.5.4">0.6822</td>
<td class="ltx_td ltx_align_left" id="S4.T1.6.10.5.5">0.6964</td>
</tr>
<tr class="ltx_tr" id="S4.T1.6.11.6">
<td class="ltx_td ltx_align_left" id="S4.T1.6.11.6.1">CMR(Greedy)</td>
<td class="ltx_td ltx_align_left" id="S4.T1.6.11.6.2">0.6032</td>
<td class="ltx_td ltx_align_left" id="S4.T1.6.11.6.3">0.6067</td>
<td class="ltx_td ltx_align_left" id="S4.T1.6.11.6.4">0.6838</td>
<td class="ltx_td ltx_align_left" id="S4.T1.6.11.6.5">0.6979</td>
</tr>
<tr class="ltx_tr" id="S4.T1.6.12.7">
<td class="ltx_td ltx_align_left" id="S4.T1.6.12.7.1">CMR(Sampling)</td>
<td class="ltx_td ltx_align_left" id="S4.T1.6.12.7.2"><span class="ltx_text ltx_framed ltx_framed_underline" id="S4.T1.6.12.7.2.1">0.6559</span></td>
<td class="ltx_td ltx_align_left" id="S4.T1.6.12.7.3"><span class="ltx_text ltx_framed ltx_framed_underline" id="S4.T1.6.12.7.3.1">0.6587</span></td>
<td class="ltx_td ltx_align_left" id="S4.T1.6.12.7.4"><span class="ltx_text ltx_framed ltx_framed_underline" id="S4.T1.6.12.7.4.1">0.7243</span></td>
<td class="ltx_td ltx_align_left" id="S4.T1.6.12.7.5"><span class="ltx_text ltx_framed ltx_framed_underline" id="S4.T1.6.12.7.5.1">0.7370</span></td>
</tr>
<tr class="ltx_tr" id="S4.T1.6.4">
<td class="ltx_td ltx_align_left ltx_border_bb" id="S4.T1.6.4.5">LAST</td>
<td class="ltx_td ltx_align_left ltx_border_bb" id="S4.T1.3.1.1"><span class="ltx_text ltx_font_bold" id="S4.T1.3.1.1.1">0.6623<sup class="ltx_sup" id="S4.T1.3.1.1.1.1"><span class="ltx_text ltx_font_medium ltx_font_italic" id="S4.T1.3.1.1.1.1.1">∗</span></sup></span></td>
<td class="ltx_td ltx_align_left ltx_border_bb" id="S4.T1.4.2.2"><span class="ltx_text ltx_font_bold" id="S4.T1.4.2.2.1">0.6652<sup class="ltx_sup" id="S4.T1.4.2.2.1.1"><span class="ltx_text ltx_font_medium ltx_font_italic" id="S4.T1.4.2.2.1.1.1">∗</span></sup></span></td>
<td class="ltx_td ltx_align_left ltx_border_bb" id="S4.T1.5.3.3"><span class="ltx_text ltx_font_bold" id="S4.T1.5.3.3.1">0.7289<sup class="ltx_sup" id="S4.T1.5.3.3.1.1"><span class="ltx_text ltx_font_medium ltx_font_italic" id="S4.T1.5.3.3.1.1.1">∗</span></sup></span></td>
<td class="ltx_td ltx_align_left ltx_border_bb" id="S4.T1.6.4.4"><span class="ltx_text ltx_font_bold" id="S4.T1.6.4.4.1">0.7418<sup class="ltx_sup" id="S4.T1.6.4.4.1.1"><span class="ltx_text ltx_font_medium ltx_font_italic" id="S4.T1.6.4.4.1.1.1">∗</span></sup></span></td>
</tr>
</tbody>
</table>
</figure>
<div class="ltx_para" id="S4.SS1.SSS1.p2">
<p class="ltx_p" id="S4.SS1.SSS1.p2.1">In the second offline experiment, we train the AE re-ranking models with a pre-trained evaluator, which is the standard practice of the AE framework, leading to better online performance experimentally. In this experiment, the model structure of the evaluator is the same as in CMR, and it tries to predict the click probability of each item. We use evaluator@N to indicate the quality of the recommendation list, which represents the item-wise average click probability of the top N items. The results in Table. <a class="ltx_ref" href="https://arxiv.org/html/2406.14004v1#S4.T2" title="Table 2 ‣ 4.1.1. Performance Analysis ‣ 4.1. Offline Experiments ‣ 4. Experiments ‣ A re-ranking model with pre-feedback learning at serving time in e-commerce"><span class="ltx_text ltx_ref_tag">2</span></a> clearly show the advantage of re-ranking models with the multi-list strategy over the ones with the single-list strategy, and the advantage of LAST over baselines. The relative improvements appear to be more reasonable compared to the first offline experiment, which is more likely to indicate the improvement online.</p>
</div>
<figure class="ltx_table" id="S4.T2">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_table"><span class="ltx_text" id="S4.T2.6.2.1" style="font-size:90%;">Table 2</span>. </span><span class="ltx_text" id="S4.T2.2.1" style="font-size:90%;">Offline comparison of re-ranking models. The AE re-ranking models use a pre-trained model evaluator to predict user engagement. The best results is bolded and the runner-up is underlined. * indicates that the improvement over the best baseline is statistically significant (<math alttext="p" class="ltx_Math" display="inline" id="S4.T2.2.1.m1.1"><semantics id="S4.T2.2.1.m1.1b"><mi id="S4.T2.2.1.m1.1.1" xref="S4.T2.2.1.m1.1.1.cmml">p</mi><annotation-xml encoding="MathML-Content" id="S4.T2.2.1.m1.1c"><ci id="S4.T2.2.1.m1.1.1.cmml" xref="S4.T2.2.1.m1.1.1">𝑝</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.T2.2.1.m1.1d">p</annotation><annotation encoding="application/x-llamapun" id="S4.T2.2.1.m1.1e">italic_p</annotation></semantics></math>-value ¡ 0.05).</span></figcaption>
<table class="ltx_tabular ltx_guessed_headers ltx_align_middle" id="S4.T2.4">
<thead class="ltx_thead">
<tr class="ltx_tr" id="S4.T2.4.3.1">
<th class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_border_tt" id="S4.T2.4.3.1.1">Method</th>
<th class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_border_tt" id="S4.T2.4.3.1.2">evaluator@5</th>
<th class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_border_tt" id="S4.T2.4.3.1.3">evaluator@10</th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr class="ltx_tr" id="S4.T2.4.4.1">
<td class="ltx_td ltx_align_left ltx_border_t" id="S4.T2.4.4.1.1">EGR</td>
<td class="ltx_td ltx_align_left ltx_border_t" id="S4.T2.4.4.1.2">0.3215</td>
<td class="ltx_td ltx_align_left ltx_border_t" id="S4.T2.4.4.1.3">0.3086</td>
</tr>
<tr class="ltx_tr" id="S4.T2.4.5.2">
<td class="ltx_td ltx_align_left" id="S4.T2.4.5.2.1">CMR(Greedy)</td>
<td class="ltx_td ltx_align_left" id="S4.T2.4.5.2.2">0.3259</td>
<td class="ltx_td ltx_align_left" id="S4.T2.4.5.2.3">0.3131</td>
</tr>
<tr class="ltx_tr" id="S4.T2.4.6.3">
<td class="ltx_td ltx_align_left" id="S4.T2.4.6.3.1">CMR(Sampling)</td>
<td class="ltx_td ltx_align_left" id="S4.T2.4.6.3.2"><span class="ltx_text ltx_framed ltx_framed_underline" id="S4.T2.4.6.3.2.1">0.3395</span></td>
<td class="ltx_td ltx_align_left" id="S4.T2.4.6.3.3"><span class="ltx_text ltx_framed ltx_framed_underline" id="S4.T2.4.6.3.3.1">0.3267</span></td>
</tr>
<tr class="ltx_tr" id="S4.T2.4.2">
<td class="ltx_td ltx_align_left ltx_border_bb" id="S4.T2.4.2.3">LAST</td>
<td class="ltx_td ltx_align_left ltx_border_bb" id="S4.T2.3.1.1"><span class="ltx_text ltx_font_bold" id="S4.T2.3.1.1.1">0.3438<sup class="ltx_sup" id="S4.T2.3.1.1.1.1"><span class="ltx_text ltx_font_medium ltx_font_italic" id="S4.T2.3.1.1.1.1.1">∗</span></sup></span></td>
<td class="ltx_td ltx_align_left ltx_border_bb" id="S4.T2.4.2.2"><span class="ltx_text ltx_font_bold" id="S4.T2.4.2.2.1">0.3310<sup class="ltx_sup" id="S4.T2.4.2.2.1.1"><span class="ltx_text ltx_font_medium ltx_font_italic" id="S4.T2.4.2.2.1.1.1">∗</span></sup></span></td>
</tr>
</tbody>
</table>
</figure>
</section>
<section class="ltx_subsubsection" id="S4.SS1.SSS2">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">4.1.2. </span>Hyper-parameters Analysis</h4>
<div class="ltx_para" id="S4.SS1.SSS2.p1">
<p class="ltx_p" id="S4.SS1.SSS2.p1.6">We evaluate the impact of two core hyper-parameters of LAST in the third offline experiment. Fig. <a class="ltx_ref" href="https://arxiv.org/html/2406.14004v1#S4.F3" title="Figure 3 ‣ 4.1.2. Hyper-parameters Analysis ‣ 4.1. Offline Experiments ‣ 4. Experiments ‣ A re-ranking model with pre-feedback learning at serving time in e-commerce"><span class="ltx_text ltx_ref_tag">3</span></a>(a) shows the influence of the length of the step size lists <math alttext="[\eta_{1},\eta_{2},...]" class="ltx_Math" display="inline" id="S4.SS1.SSS2.p1.1.m1.3"><semantics id="S4.SS1.SSS2.p1.1.m1.3a"><mrow id="S4.SS1.SSS2.p1.1.m1.3.3.2" xref="S4.SS1.SSS2.p1.1.m1.3.3.3.cmml"><mo id="S4.SS1.SSS2.p1.1.m1.3.3.2.3" stretchy="false" xref="S4.SS1.SSS2.p1.1.m1.3.3.3.cmml">[</mo><msub id="S4.SS1.SSS2.p1.1.m1.2.2.1.1" xref="S4.SS1.SSS2.p1.1.m1.2.2.1.1.cmml"><mi id="S4.SS1.SSS2.p1.1.m1.2.2.1.1.2" xref="S4.SS1.SSS2.p1.1.m1.2.2.1.1.2.cmml">η</mi><mn id="S4.SS1.SSS2.p1.1.m1.2.2.1.1.3" xref="S4.SS1.SSS2.p1.1.m1.2.2.1.1.3.cmml">1</mn></msub><mo id="S4.SS1.SSS2.p1.1.m1.3.3.2.4" xref="S4.SS1.SSS2.p1.1.m1.3.3.3.cmml">,</mo><msub id="S4.SS1.SSS2.p1.1.m1.3.3.2.2" xref="S4.SS1.SSS2.p1.1.m1.3.3.2.2.cmml"><mi id="S4.SS1.SSS2.p1.1.m1.3.3.2.2.2" xref="S4.SS1.SSS2.p1.1.m1.3.3.2.2.2.cmml">η</mi><mn id="S4.SS1.SSS2.p1.1.m1.3.3.2.2.3" xref="S4.SS1.SSS2.p1.1.m1.3.3.2.2.3.cmml">2</mn></msub><mo id="S4.SS1.SSS2.p1.1.m1.3.3.2.5" xref="S4.SS1.SSS2.p1.1.m1.3.3.3.cmml">,</mo><mi id="S4.SS1.SSS2.p1.1.m1.1.1" mathvariant="normal" xref="S4.SS1.SSS2.p1.1.m1.1.1.cmml">…</mi><mo id="S4.SS1.SSS2.p1.1.m1.3.3.2.6" stretchy="false" xref="S4.SS1.SSS2.p1.1.m1.3.3.3.cmml">]</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.SSS2.p1.1.m1.3b"><list id="S4.SS1.SSS2.p1.1.m1.3.3.3.cmml" xref="S4.SS1.SSS2.p1.1.m1.3.3.2"><apply id="S4.SS1.SSS2.p1.1.m1.2.2.1.1.cmml" xref="S4.SS1.SSS2.p1.1.m1.2.2.1.1"><csymbol cd="ambiguous" id="S4.SS1.SSS2.p1.1.m1.2.2.1.1.1.cmml" xref="S4.SS1.SSS2.p1.1.m1.2.2.1.1">subscript</csymbol><ci id="S4.SS1.SSS2.p1.1.m1.2.2.1.1.2.cmml" xref="S4.SS1.SSS2.p1.1.m1.2.2.1.1.2">𝜂</ci><cn id="S4.SS1.SSS2.p1.1.m1.2.2.1.1.3.cmml" type="integer" xref="S4.SS1.SSS2.p1.1.m1.2.2.1.1.3">1</cn></apply><apply id="S4.SS1.SSS2.p1.1.m1.3.3.2.2.cmml" xref="S4.SS1.SSS2.p1.1.m1.3.3.2.2"><csymbol cd="ambiguous" id="S4.SS1.SSS2.p1.1.m1.3.3.2.2.1.cmml" xref="S4.SS1.SSS2.p1.1.m1.3.3.2.2">subscript</csymbol><ci id="S4.SS1.SSS2.p1.1.m1.3.3.2.2.2.cmml" xref="S4.SS1.SSS2.p1.1.m1.3.3.2.2.2">𝜂</ci><cn id="S4.SS1.SSS2.p1.1.m1.3.3.2.2.3.cmml" type="integer" xref="S4.SS1.SSS2.p1.1.m1.3.3.2.2.3">2</cn></apply><ci id="S4.SS1.SSS2.p1.1.m1.1.1.cmml" xref="S4.SS1.SSS2.p1.1.m1.1.1">…</ci></list></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSS2.p1.1.m1.3c">[\eta_{1},\eta_{2},...]</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.SSS2.p1.1.m1.3d">[ italic_η start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT , italic_η start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT , … ]</annotation></semantics></math>, where each <math alttext="\eta" class="ltx_Math" display="inline" id="S4.SS1.SSS2.p1.2.m2.1"><semantics id="S4.SS1.SSS2.p1.2.m2.1a"><mi id="S4.SS1.SSS2.p1.2.m2.1.1" xref="S4.SS1.SSS2.p1.2.m2.1.1.cmml">η</mi><annotation-xml encoding="MathML-Content" id="S4.SS1.SSS2.p1.2.m2.1b"><ci id="S4.SS1.SSS2.p1.2.m2.1.1.cmml" xref="S4.SS1.SSS2.p1.2.m2.1.1">𝜂</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSS2.p1.2.m2.1c">\eta</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.SSS2.p1.2.m2.1d">italic_η</annotation></semantics></math> generates a recommendation list. We can see that more list trials always lead to higher evaluation scores and LAST is clearly more effective than CMR(Sampling). Fig. <a class="ltx_ref" href="https://arxiv.org/html/2406.14004v1#S4.F3" title="Figure 3 ‣ 4.1.2. Hyper-parameters Analysis ‣ 4.1. Offline Experiments ‣ 4. Experiments ‣ A re-ranking model with pre-feedback learning at serving time in e-commerce"><span class="ltx_text ltx_ref_tag">3</span></a>(b) depicts the influence of the normalization factor <math alttext="\alpha" class="ltx_Math" display="inline" id="S4.SS1.SSS2.p1.3.m3.1"><semantics id="S4.SS1.SSS2.p1.3.m3.1a"><mi id="S4.SS1.SSS2.p1.3.m3.1.1" xref="S4.SS1.SSS2.p1.3.m3.1.1.cmml">α</mi><annotation-xml encoding="MathML-Content" id="S4.SS1.SSS2.p1.3.m3.1b"><ci id="S4.SS1.SSS2.p1.3.m3.1.1.cmml" xref="S4.SS1.SSS2.p1.3.m3.1.1">𝛼</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSS2.p1.3.m3.1c">\alpha</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.SSS2.p1.3.m3.1d">italic_α</annotation></semantics></math>. When <math alttext="\alpha" class="ltx_Math" display="inline" id="S4.SS1.SSS2.p1.4.m4.1"><semantics id="S4.SS1.SSS2.p1.4.m4.1a"><mi id="S4.SS1.SSS2.p1.4.m4.1.1" xref="S4.SS1.SSS2.p1.4.m4.1.1.cmml">α</mi><annotation-xml encoding="MathML-Content" id="S4.SS1.SSS2.p1.4.m4.1b"><ci id="S4.SS1.SSS2.p1.4.m4.1.1.cmml" xref="S4.SS1.SSS2.p1.4.m4.1.1">𝛼</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSS2.p1.4.m4.1c">\alpha</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.SSS2.p1.4.m4.1d">italic_α</annotation></semantics></math> is too small, the modification is not strong enough to effectively change the recommendation lists to increase the evaluation score; when <math alttext="\alpha" class="ltx_Math" display="inline" id="S4.SS1.SSS2.p1.5.m5.1"><semantics id="S4.SS1.SSS2.p1.5.m5.1a"><mi id="S4.SS1.SSS2.p1.5.m5.1.1" xref="S4.SS1.SSS2.p1.5.m5.1.1.cmml">α</mi><annotation-xml encoding="MathML-Content" id="S4.SS1.SSS2.p1.5.m5.1b"><ci id="S4.SS1.SSS2.p1.5.m5.1.1.cmml" xref="S4.SS1.SSS2.p1.5.m5.1.1">𝛼</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSS2.p1.5.m5.1c">\alpha</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.SSS2.p1.5.m5.1d">italic_α</annotation></semantics></math> goes too big, the direction indicated by the local gradient becomes unreliable. Both lead to a suppressed LAST improvement. The performance of LAST reaches its peak when <math alttext="\alpha" class="ltx_Math" display="inline" id="S4.SS1.SSS2.p1.6.m6.1"><semantics id="S4.SS1.SSS2.p1.6.m6.1a"><mi id="S4.SS1.SSS2.p1.6.m6.1.1" xref="S4.SS1.SSS2.p1.6.m6.1.1.cmml">α</mi><annotation-xml encoding="MathML-Content" id="S4.SS1.SSS2.p1.6.m6.1b"><ci id="S4.SS1.SSS2.p1.6.m6.1.1.cmml" xref="S4.SS1.SSS2.p1.6.m6.1.1">𝛼</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSS2.p1.6.m6.1c">\alpha</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.SSS2.p1.6.m6.1d">italic_α</annotation></semantics></math> is 1%.</p>
</div>
<figure class="ltx_figure" id="S4.F3">
<div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_2">
<figure class="ltx_figure ltx_figure_panel ltx_align_center" id="S4.F3.1"><img alt="Refer to caption" class="ltx_graphics ltx_img_landscape" height="450" id="S4.F3.1.g1" src="extracted/5679954/step_size2.png" width="598"/>
</figure>
</div>
<div class="ltx_flex_cell ltx_flex_size_2">
<figure class="ltx_figure ltx_figure_panel ltx_align_center" id="S4.F3.2"><img alt="Refer to caption" class="ltx_graphics ltx_img_landscape" height="439" id="S4.F3.2.g1" src="extracted/5679954/norm.png" width="598"/>
</figure>
</div>
</div>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span class="ltx_text" id="S4.F3.4.1.1" style="font-size:90%;">Figure 3</span>. </span><span class="ltx_text" id="S4.F3.5.2" style="font-size:90%;">The impact of hyper-parameters on LAST.</span></figcaption>
</figure>
</section>
</section>
<section class="ltx_subsection" id="S4.SS2">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.2. </span>Online Experiments</h3>
<div class="ltx_para" id="S4.SS2.p1">
<p class="ltx_p" id="S4.SS2.p1.1">We conduct online experiments on the ”Subscribe” scene in the Taobao App, a leading e-commerce platform in China. We aim to improve the purchase number per user, meanwhile maintaining the user interaction frequency, namely the click number per user. CMR(Sampling) is the baseline and LAST is the experiment method. For more details on the experimental setup, please refer to Auxiliary Materials.
The results from the online A/B testing are summarized in Table <a class="ltx_ref" href="https://arxiv.org/html/2406.14004v1#S4.T3" title="Table 3 ‣ 4.2. Online Experiments ‣ 4. Experiments ‣ A re-ranking model with pre-feedback learning at serving time in e-commerce"><span class="ltx_text ltx_ref_tag">3</span></a>, where the superiority of LAST is evident. By explicitly adapting its model parameters in real-time to each incoming request, LAST is able to achieve a higher conversion rate, leading to more purchases, without detracting from user engagement.</p>
</div>
<figure class="ltx_table" id="S4.T3">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_table"><span class="ltx_text" id="S4.T3.2.1.1" style="font-size:90%;">Table 3</span>. </span><span class="ltx_text" id="S4.T3.3.2" style="font-size:90%;">Online A/B test results, LAST over CMR(Sampling).</span></figcaption>
<table class="ltx_tabular ltx_guessed_headers ltx_align_middle" id="S4.T3.4">
<thead class="ltx_thead">
<tr class="ltx_tr" id="S4.T3.4.1.1">
<th class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_th_row ltx_border_tt" id="S4.T3.4.1.1.1"><span class="ltx_text" id="S4.T3.4.1.1.1.1" style="font-size:90%;">Metric</span></th>
<th class="ltx_td ltx_align_right ltx_th ltx_th_column ltx_border_tt" id="S4.T3.4.1.1.2"><span class="ltx_text" id="S4.T3.4.1.1.2.1" style="font-size:90%;">Relative improvement</span></th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr class="ltx_tr" id="S4.T3.4.2.1">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t" id="S4.T3.4.2.1.1"><span class="ltx_text" id="S4.T3.4.2.1.1.1" style="font-size:90%;">click number per user</span></th>
<td class="ltx_td ltx_align_right ltx_border_t" id="S4.T3.4.2.1.2"><span class="ltx_text" id="S4.T3.4.2.1.2.1" style="font-size:90%;">0.08%</span></td>
</tr>
<tr class="ltx_tr" id="S4.T3.4.3.2">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_bb" id="S4.T3.4.3.2.1"><span class="ltx_text" id="S4.T3.4.3.2.1.1" style="font-size:90%;">purchase number per user</span></th>
<td class="ltx_td ltx_align_right ltx_border_bb" id="S4.T3.4.3.2.2"><span class="ltx_text" id="S4.T3.4.3.2.2.1" style="font-size:90%;">2.08%</span></td>
</tr>
</tbody>
</table>
</figure>
</section>
</section>
<section class="ltx_section" id="S5">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">5. </span>Conclusion</h2>
<div class="ltx_para" id="S5.p1">
<p class="ltx_p" id="S5.p1.1">We propose a novel re-ranking model in e-commerce with a unique online learning ability. Distinct from existing methods, it can achieve effective model online learning without waiting for real user feedback, by using supervision signals provided by a surrogate model. Deliberated algorithmic designs are introduced to fulfill its full potential. It introduces request-specific modifications to maximize model adaptation to the context of each request. It discards the modifications after each recommendation to stabilize the training procedure. These designs ensure LAST can work in harmony with existing online learning systems while providing improved temporal effectiveness and incremental adaptation. Through extensive offline and online experiments, we demonstrate the strength of the new proposed model.</p>
</div>
</section>
<section class="ltx_bibliography" id="bib">
<h2 class="ltx_title ltx_title_bibliography">References</h2>
<ul class="ltx_biblist">
<li class="ltx_bibitem" id="bib.bib1">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">(1)</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib2">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Ai et al<span class="ltx_text" id="bib.bib2.2.2.1">.</span> (2018)</span>
<span class="ltx_bibblock">
Qingyao Ai, Keping Bi, Jiafeng Guo, and W Bruce Croft. 2018.

</span>
<span class="ltx_bibblock">Learning a deep listwise context model for ranking refinement. In <em class="ltx_emph ltx_font_italic" id="bib.bib2.3.1">The 41st international ACM SIGIR conference on research &amp; development in information retrieval</em>. 135–144.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib3">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Ai et al<span class="ltx_text" id="bib.bib3.2.2.1">.</span> (2019)</span>
<span class="ltx_bibblock">
Qingyao Ai, Xuanhui Wang, Sebastian Bruch, Nadav Golbandi, Michael Bendersky, and Marc Najork. 2019.

</span>
<span class="ltx_bibblock">Learning groupwise multivariate scoring functions using deep neural networks. In <em class="ltx_emph ltx_font_italic" id="bib.bib3.3.1">Proceedings of the 2019 ACM SIGIR international conference on theory of information retrieval</em>. 85–92.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib4">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Bello et al<span class="ltx_text" id="bib.bib4.2.2.1">.</span> (2018)</span>
<span class="ltx_bibblock">
Irwan Bello, Sayali Kulkarni, Sagar Jain, Craig Boutilier, Ed Chi, Elad Eban, Xiyang Luo, Alan Mackey, and Ofer Meshi. 2018.

</span>
<span class="ltx_bibblock">Seq2slate: Re-ranking and slate optimization with rnns.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib4.3.1">arXiv preprint arXiv:1810.02019</em> (2018).

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib5">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Chen et al<span class="ltx_text" id="bib.bib5.2.2.1">.</span> (2023)</span>
<span class="ltx_bibblock">
Sirui Chen, Yuan Wang, Zijing Wen, Zhiyu Li, Changshuo Zhang, Xiao Zhang, Quan Lin, Cheng Zhu, and Jun Xu. 2023.

</span>
<span class="ltx_bibblock">Controllable Multi-Objective Re-ranking with Policy Hypernetworks. In <em class="ltx_emph ltx_font_italic" id="bib.bib5.3.1">Proceedings of the 29th ACM SIGKDD Conference on Knowledge Discovery and Data Mining</em>. 3855–3864.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib6">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Gong et al<span class="ltx_text" id="bib.bib6.2.2.1">.</span> (2019)</span>
<span class="ltx_bibblock">
Yu Gong, Yu Zhu, Lu Duan, Qingwen Liu, Ziyu Guan, Fei Sun, Wenwu Ou, and Kenny Q Zhu. 2019.

</span>
<span class="ltx_bibblock">Exact-k recommendation via maximal clique optimization. In <em class="ltx_emph ltx_font_italic" id="bib.bib6.3.1">Proceedings of the 25th ACM SIGKDD international conference on knowledge discovery &amp; data mining</em>. 617–626.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib7">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Hazan (2016)</span>
<span class="ltx_bibblock">
Elad Hazan. 2016.

</span>
<span class="ltx_bibblock">Introduction to online convex optimization.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib7.1.1">Foundations and Trends<sup class="ltx_sup" id="bib.bib7.1.1.1">®</sup> in Optimization</em> 2, 3-4 (2016), 157–325.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib8">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Huzhang et al<span class="ltx_text" id="bib.bib8.2.2.1">.</span> (2021)</span>
<span class="ltx_bibblock">
Guangda Huzhang, Zhenjia Pang, Yongqing Gao, Yawen Liu, Weijie Shen, Wen-Ji Zhou, Qing Da, Anxiang Zeng, Han Yu, Yang Yu, et al<span class="ltx_text" id="bib.bib8.3.1">.</span> 2021.

</span>
<span class="ltx_bibblock">AliExpress Learning-To-Rank: Maximizing online model performance without going online.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib8.4.1">IEEE Transactions on Knowledge and Data Engineering</em> (2021).

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib9">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Jiang et al<span class="ltx_text" id="bib.bib9.2.2.1">.</span> (2017)</span>
<span class="ltx_bibblock">
Zhengbao Jiang, Ji-Rong Wen, Zhicheng Dou, Wayne Xin Zhao, Jian-Yun Nie, and Ming Yue. 2017.

</span>
<span class="ltx_bibblock">Learning to diversify search results via subtopic attention. In <em class="ltx_emph ltx_font_italic" id="bib.bib9.3.1">Proceedings of the 40th international ACM SIGIR Conference on Research and Development in Information Retrieval</em>. 545–554.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib10">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Kaelbling et al<span class="ltx_text" id="bib.bib10.2.2.1">.</span> (1996)</span>
<span class="ltx_bibblock">
Leslie Pack Kaelbling, Michael L Littman, and Andrew W Moore. 1996.

</span>
<span class="ltx_bibblock">Reinforcement learning: A survey.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib10.3.1">Journal of artificial intelligence research</em> 4 (1996), 237–285.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib11">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Karako and Manggala (2018)</span>
<span class="ltx_bibblock">
Chen Karako and Putra Manggala. 2018.

</span>
<span class="ltx_bibblock">Using image fairness representations in diversity-based re-ranking for recommendations. In <em class="ltx_emph ltx_font_italic" id="bib.bib11.1.1">Adjunct Publication of the 26th Conference on User Modeling, Adaptation and Personalization</em>. 23–28.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib12">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Kotkov et al<span class="ltx_text" id="bib.bib12.2.2.1">.</span> (2016)</span>
<span class="ltx_bibblock">
Denis Kotkov, Shuaiqiang Wang, and Jari Veijalainen. 2016.

</span>
<span class="ltx_bibblock">A survey of serendipity in recommender systems.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib12.3.1">Knowledge-Based Systems</em> 111 (2016), 180–192.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib13">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Li (2017)</span>
<span class="ltx_bibblock">
Yuxi Li. 2017.

</span>
<span class="ltx_bibblock">Deep reinforcement learning: An overview.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib13.1.1">arXiv preprint arXiv:1701.07274</em> (2017).

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib14">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Liu et al<span class="ltx_text" id="bib.bib14.2.2.1">.</span> (2020)</span>
<span class="ltx_bibblock">
Jiongnan Liu, Zhicheng Dou, Xiaojie Wang, Shuqi Lu, and Ji-Rong Wen. 2020.

</span>
<span class="ltx_bibblock">DVGAN: a minimax game for search result diversification combining explicit and implicit features. In <em class="ltx_emph ltx_font_italic" id="bib.bib14.3.1">Proceedings of the 43rd International ACM SIGIR Conference on Research and Development in Information Retrieval</em>. 479–488.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib15">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Oosterhuis (2021)</span>
<span class="ltx_bibblock">
Harrie Oosterhuis. 2021.

</span>
<span class="ltx_bibblock">Computationally efficient optimization of plackett-luce ranking models for relevance and fairness. In <em class="ltx_emph ltx_font_italic" id="bib.bib15.1.1">Proceedings of the 44th International ACM SIGIR Conference on Research and Development in Information Retrieval</em>. 1023–1032.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib16">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Pang et al<span class="ltx_text" id="bib.bib16.2.2.1">.</span> (2020)</span>
<span class="ltx_bibblock">
Liang Pang, Jun Xu, Qingyao Ai, Yanyan Lan, Xueqi Cheng, and Jirong Wen. 2020.

</span>
<span class="ltx_bibblock">Setrank: Learning a permutation-invariant ranking model for information retrieval. In <em class="ltx_emph ltx_font_italic" id="bib.bib16.3.1">Proceedings of the 43rd International ACM SIGIR Conference on Research and Development in Information Retrieval</em>. 499–508.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib17">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Pei et al<span class="ltx_text" id="bib.bib17.2.2.1">.</span> (2019)</span>
<span class="ltx_bibblock">
Changhua Pei, Yi Zhang, Yongfeng Zhang, Fei Sun, Xiao Lin, Hanxiao Sun, Jian Wu, Peng Jiang, Junfeng Ge, Wenwu Ou, et al<span class="ltx_text" id="bib.bib17.3.1">.</span> 2019.

</span>
<span class="ltx_bibblock">Personalized re-ranking for recommendation. In <em class="ltx_emph ltx_font_italic" id="bib.bib17.4.1">Proceedings of the 13th ACM conference on recommender systems</em>. 3–11.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib18">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Sahoo et al<span class="ltx_text" id="bib.bib18.2.2.1">.</span> (2018)</span>
<span class="ltx_bibblock">
Doyen Sahoo, Quang Pham, Jing Lu, and Steven C. H. Hoi. 2018.

</span>
<span class="ltx_bibblock">Online Deep Learning: Learning Deep Neural Networks on the Fly. In <em class="ltx_emph ltx_font_italic" id="bib.bib18.3.1">Proceedings of the 27th International Joint Conference on Artificial Intelligence</em>. International Joint Conferences on Artificial Intelligence Organization, 2660–2666.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib19">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Vaswani et al<span class="ltx_text" id="bib.bib19.2.2.1">.</span> (2017)</span>
<span class="ltx_bibblock">
Ashish Vaswani, Noam Shazeer, Niki Parmar, Jakob Uszkoreit, Llion Jones, Aidan N Gomez, Łukasz Kaiser, and Illia Polosukhin. 2017.

</span>
<span class="ltx_bibblock">Attention is all you need.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib19.3.1">Advances in neural information processing systems</em> 30 (2017).

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib20">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Wang et al<span class="ltx_text" id="bib.bib20.2.2.1">.</span> (2019)</span>
<span class="ltx_bibblock">
Fan Wang, Xiaomin Fang, Lihang Liu, Yaxue Chen, Jiucheng Tao, Zhiming Peng, Cihang Jin, and Hao Tian. 2019.

</span>
<span class="ltx_bibblock">Sequential evaluation and generation framework for combinatorial recommender system.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib20.3.1">arXiv preprint arXiv:1902.00245</em> (2019).

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib21">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Wiering and Van Otterlo (2012)</span>
<span class="ltx_bibblock">
Marco A Wiering and Martijn Van Otterlo. 2012.

</span>
<span class="ltx_bibblock">Reinforcement learning.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib21.1.1">Adaptation, learning, and optimization</em> 12, 3 (2012), 729.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib22">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Xia et al<span class="ltx_text" id="bib.bib22.2.2.1">.</span> (2016)</span>
<span class="ltx_bibblock">
Long Xia, Jun Xu, Yanyan Lan, Jiafeng Guo, and Xueqi Cheng. 2016.

</span>
<span class="ltx_bibblock">Modeling document novelty with neural tensor network for search result diversification. In <em class="ltx_emph ltx_font_italic" id="bib.bib22.3.1">Proceedings of the 39th International ACM SIGIR conference on Research and Development in Information Retrieval</em>. 395–404.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib23">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Xia et al<span class="ltx_text" id="bib.bib23.2.2.1">.</span> (2017)</span>
<span class="ltx_bibblock">
Long Xia, Jun Xu, Yanyan Lan, Jiafeng Guo, Wei Zeng, and Xueqi Cheng. 2017.

</span>
<span class="ltx_bibblock">Adapting Markov decision process for search result diversification. In <em class="ltx_emph ltx_font_italic" id="bib.bib23.3.1">Proceedings of the 40th international ACM SIGIR conference on research and development in information retrieval</em>. 535–544.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib24">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Zhang et al<span class="ltx_text" id="bib.bib24.2.2.1">.</span> (2019)</span>
<span class="ltx_bibblock">
Xiao Zhang, Yun Liao, and Shizhong Liao. 2019.

</span>
<span class="ltx_bibblock">A survey on online kernel selection for online kernel learning.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib24.3.1">WIREs Data Mining and Knowledge Discovery</em> 9, 2 (2019), e1295.

</span>
<span class="ltx_bibblock">
<a class="ltx_ref ltx_url ltx_font_typewriter" href="https://doi.org/10.1002/widm.1295" title="">https://doi.org/10.1002/widm.1295</a>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib25">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Zhu et al<span class="ltx_text" id="bib.bib25.2.2.1">.</span> (2021)</span>
<span class="ltx_bibblock">
Ziwei Zhu, Jingu Kim, Trung Nguyen, Aish Fenton, and James Caverlee. 2021.

</span>
<span class="ltx_bibblock">Fairness among new items in cold start recommender systems. In <em class="ltx_emph ltx_font_italic" id="bib.bib25.3.1">Proceedings of the 44th International ACM SIGIR Conference on Research and Development in Information Retrieval</em>. 767–776.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib26">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Zhuang et al<span class="ltx_text" id="bib.bib26.2.2.1">.</span> (2018)</span>
<span class="ltx_bibblock">
Tao Zhuang, Wenwu Ou, and Zhirong Wang. 2018.

</span>
<span class="ltx_bibblock">Globally optimized mutual influence aware ranking in e-commerce search.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib26.3.1">arXiv preprint arXiv:1805.08524</em> (2018).

</span>
<span class="ltx_bibblock">
</span>
</li>
</ul>
</section>
<div class="ltx_pagination ltx_role_newpage"></div>
<section class="ltx_section" id="S6">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">6. </span>Auxiliary Material</h2>
<section class="ltx_subsection" id="S6.SS1">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">6.1. </span>Offline Experiment Setup</h3>
<div class="ltx_para" id="S6.SS1.p1">
<p class="ltx_p" id="S6.SS1.p1.1">The original Ad dataset records 1 million users and 26 million ad display/click logs, with 8 user profiles (e.g., id, age, and occupation), 6 item features (e.g., id, campaign, and brand). LibRerank transformed the records of each user into ranking lists according to the timestamp of the user browsing the advertisement. Items that have been interacted with within 5 minutes are sliced into a list. The final Ad dataset contains 349,404 items and 483,049 lists.</p>
</div>
<div class="ltx_para" id="S6.SS1.p2">
<p class="ltx_p" id="S6.SS1.p2.1">We chose a wide range of representative and state-of-the-art re-ranking methods as baselines.</p>
<ul class="ltx_itemize" id="S6.I1">
<li class="ltx_item" id="S6.I1.i1" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S6.I1.i1.p1">
<p class="ltx_p" id="S6.I1.i1.p1.1">GSF <cite class="ltx_cite ltx_citemacro_citep">(Ai et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2406.14004v1#bib.bib3" title="">2019</a>)</cite>: This method explicitly divides item candidates into overlapping groups of size 2 or 3 and introduces a group-based scoring function to represent items in each group.</p>
</div>
</li>
<li class="ltx_item" id="S6.I1.i2" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S6.I1.i2.p1">
<p class="ltx_p" id="S6.I1.i2.p1.1">DLCM <cite class="ltx_cite ltx_citemacro_citep">(Ai et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2406.14004v1#bib.bib2" title="">2018</a>)</cite>: Deep Listwise Context Model uses a Gated Recurrent Unit (GRU) to capture the global context of a recommendation.</p>
</div>
</li>
<li class="ltx_item" id="S6.I1.i3" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S6.I1.i3.p1">
<p class="ltx_p" id="S6.I1.i3.p1.1">PRM<cite class="ltx_cite ltx_citemacro_citep">(Pei et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2406.14004v1#bib.bib17" title="">2019</a>)</cite>: The Personalized Re-ranking Model uses transformer blocks <cite class="ltx_cite ltx_citemacro_citep">(Vaswani et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2406.14004v1#bib.bib19" title="">2017</a>)</cite> to capture the mutual influence between item candidates.</p>
</div>
</li>
<li class="ltx_item" id="S6.I1.i4" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S6.I1.i4.p1">
<p class="ltx_p" id="S6.I1.i4.p1.1">SetRank <cite class="ltx_cite ltx_citemacro_citep">(Pang et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2406.14004v1#bib.bib16" title="">2020</a>)</cite>: SetRank is a Bayesian approach for collaborative ranking, which aims at maximizing the posterior probability of set-wise preference comparisons.</p>
</div>
</li>
<li class="ltx_item" id="S6.I1.i5" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S6.I1.i5.p1">
<p class="ltx_p" id="S6.I1.i5.p1.1">EGR <cite class="ltx_cite ltx_citemacro_citep">(Wang et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2406.14004v1#bib.bib20" title="">2019</a>)</cite>: A re-ranking model uses an evaluator-generator framework that includes a generator responsible for generating feasible permutations, and an evaluator that assesses the list-wise utility of each permutation. The framework is also known as the actor-evaluator. The two differ only in terminology.</p>
</div>
</li>
<li class="ltx_item" id="S6.I1.i6" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S6.I1.i6.p1">
<p class="ltx_p" id="S6.I1.i6.p1.1">CMR(Greedy) <cite class="ltx_cite ltx_citemacro_citep">(Chen et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2406.14004v1#bib.bib5" title="">2023</a>)</cite>: An enhanced version of EGR with more powerful model structures. The actor works in a greedy manner, which means the actor always picks the item with the largest selection probability in each step and generates only one recommendation list for each request.</p>
</div>
</li>
<li class="ltx_item" id="S6.I1.i7" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S6.I1.i7.p1">
<p class="ltx_p" id="S6.I1.i7.p1.1">CMR(Sampling): The model structure is the same as above. The actor generates multiple recommendation lists using Thompson Sampling and the list with the highest evaluation score is presented to a user. The parameters of the actor remain the same during serving time. It is the re-ranking model that serves the main traffic of our industrial applied recommendation scene.</p>
</div>
</li>
<li class="ltx_item" id="S6.I1.i8" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S6.I1.i8.p1">
<p class="ltx_p" id="S6.I1.i8.p1.1">LAST: The model structure is the same as above. The actor generates multiple recommendation lists using the parallel version of LAST. The list with the highest evaluation score is presented to a user.</p>
</div>
</li>
</ul>
</div>
<section class="ltx_subsubsection" id="S6.SS1.SSS1">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">6.1.1. </span>Offline Experiment 1</h4>
<div class="ltx_para" id="S6.SS1.SSS1.p1">
<p class="ltx_p" id="S6.SS1.SSS1.p1.1">The non-AE re-ranking models, including GSF, DLCM, SetRank, and PRM, are trained with item-level user feedback labels. In other words, they try to predict user engagement of each item, considering the candidate context. The final recommendation list is obtained by ranking candidates according to the engagement probability prediction from high to low. To make a fair comparison between AE and non-AE models, in this experiment, we use NDCG as the evaluation function to train AE models. Evaluation based on NDCG uses a hidden assumption that the user feedback on each item stays the same after re-ranking the lists. It is not likely to hold in the perspective of re-ranking modeling. However, it is an unavoidable assumption in non-AE re-ranking models and is widely used in related works.</p>
</div>
</section>
</section>
<section class="ltx_subsection" id="S6.SS2">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">6.2. </span>Online Experiment Setup</h3>
<div class="ltx_para" id="S6.SS2.p1">
<p class="ltx_p" id="S6.SS2.p1.1">We conduct online experiments on the ”Subscribe” scene in the Taobao App, a leading e-commerce platform in China. Its main entrance is the ”Subscribe” button on top of Taobao’s main landing page and it is a stream of various elements including items, posters, videos, etc. 2,003,565 users were involved in the 7-day long experiments.
In the online experiment, we aim to improve the purchase number per user, meanwhile maintaining the user interaction frequency, indicated by the click number per user. CMR(Sampling) is the baseline method, which serves the main traffic of our online scene and LAST is the experiment method. The main difference between the two is that LAST uses online request-adaptive modification. Other aspects, such as the model structure, the offline training process, and the exploration number of lists during online serving are the same between the two. We do not have classic online learning methods deployed at this moment because of engineering limitations. LAST learning functionality can be implemented as a normal model module and does not need any extra engineering support. We leave the combination of the two in further study.</p>
</div>
</section>
</section>
</article>
</div>
<footer class="ltx_page_footer">
<div class="ltx_page_logo">Generated  on Thu Jun 20 05:15:03 2024 by <a class="ltx_LaTeXML_logo" href="http://dlmf.nist.gov/LaTeXML/"><span style="letter-spacing:-0.2em; margin-right:0.1em;">L<span class="ltx_font_smallcaps" style="position:relative; bottom:2.2pt;">a</span>T<span class="ltx_font_smallcaps" style="font-size:120%;position:relative; bottom:-0.2ex;">e</span></span><span style="font-size:90%; position:relative; bottom:-0.2ex;">XML</span><img alt="Mascot Sammy" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAsAAAAOCAYAAAD5YeaVAAAAAXNSR0IArs4c6QAAAAZiS0dEAP8A/wD/oL2nkwAAAAlwSFlzAAALEwAACxMBAJqcGAAAAAd0SU1FB9wKExQZLWTEaOUAAAAddEVYdENvbW1lbnQAQ3JlYXRlZCB3aXRoIFRoZSBHSU1Q72QlbgAAAdpJREFUKM9tkL+L2nAARz9fPZNCKFapUn8kyI0e4iRHSR1Kb8ng0lJw6FYHFwv2LwhOpcWxTjeUunYqOmqd6hEoRDhtDWdA8ApRYsSUCDHNt5ul13vz4w0vWCgUnnEc975arX6ORqN3VqtVZbfbTQC4uEHANM3jSqXymFI6yWazP2KxWAXAL9zCUa1Wy2tXVxheKA9YNoR8Pt+aTqe4FVVVvz05O6MBhqUIBGk8Hn8HAOVy+T+XLJfLS4ZhTiRJgqIoVBRFIoric47jPnmeB1mW/9rr9ZpSSn3Lsmir1fJZlqWlUonKsvwWwD8ymc/nXwVBeLjf7xEKhdBut9Hr9WgmkyGEkJwsy5eHG5vN5g0AKIoCAEgkEkin0wQAfN9/cXPdheu6P33fBwB4ngcAcByHJpPJl+fn54mD3Gg0NrquXxeLRQAAwzAYj8cwTZPwPH9/sVg8PXweDAauqqr2cDjEer1GJBLBZDJBs9mE4zjwfZ85lAGg2+06hmGgXq+j3+/DsixYlgVN03a9Xu8jgCNCyIegIAgx13Vfd7vdu+FweG8YRkjXdWy329+dTgeSJD3ieZ7RNO0VAXAPwDEAO5VKndi2fWrb9jWl9Esul6PZbDY9Go1OZ7PZ9z/lyuD3OozU2wAAAABJRU5ErkJggg=="/></a>
</div></footer>
</div>
</body>
</html>
