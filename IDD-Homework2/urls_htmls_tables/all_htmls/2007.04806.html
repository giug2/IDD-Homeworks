<!DOCTYPE html><html lang="en">
<head>
<meta http-equiv="content-type" content="text/html; charset=UTF-8">
<title>[2007.04806] Client Adaptation improves Federated Learning with Simulated Non-IID Clients</title><meta property="og:description" content="We present a federated learning approach for learning a client adaptable, robust model when data is non-identically and non-independently distributed (non-IID) across clients.
By simulating heterogeneous clients, we sh…">
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Client Adaptation improves Federated Learning with Simulated Non-IID Clients">
<meta name="twitter:image:src" content="https://ar5iv.labs.arxiv.org/assets/ar5iv_card.png">
<meta name="twitter:image:alt" content="ar5iv logo">
<meta property="og:title" content="Client Adaptation improves Federated Learning with Simulated Non-IID Clients">
<meta property="og:site_name" content="ar5iv">
<meta property="og:image" content="https://ar5iv.labs.arxiv.org/assets/ar5iv_card.png">
<meta property="og:type" content="article">
<meta property="og:url" content="https://ar5iv.labs.arxiv.org/html/2007.04806">

<!--Generated on Thu Mar 14 13:02:40 2024 by LaTeXML (version 0.8.8) http://dlmf.nist.gov/LaTeXML/.-->
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="keywords" lang="en" content="federated learning,  audio representation,  distributed">

<script>
  function detectColorScheme(){
    var theme="light";
    var current_theme = localStorage.getItem("ar5iv_theme");
    if(current_theme){
      if(current_theme == "dark"){
        theme = "dark";
      } }
    else if(!window.matchMedia) { return false; }
    else if(window.matchMedia("(prefers-color-scheme: dark)").matches) {
      theme = "dark"; }
    if (theme=="dark") {
      document.documentElement.setAttribute("data-theme", "dark");
    } else {
      document.documentElement.setAttribute("data-theme", "light"); } }

  detectColorScheme();

  function toggleColorScheme(){
    var current_theme = localStorage.getItem("ar5iv_theme");
    if (current_theme) {
      if (current_theme == "light") {
        localStorage.setItem("ar5iv_theme", "dark"); }
      else {
        localStorage.setItem("ar5iv_theme", "light"); } }
    else {
        localStorage.setItem("ar5iv_theme", "dark"); }
    detectColorScheme(); }
</script>
<link media="all" rel="stylesheet" href="/assets/ar5iv-fonts.0.8.0.min.css"><link media="all" rel="stylesheet" href="/assets/ar5iv.0.8.0.min.css"><link media="all" rel="stylesheet" href="/assets/ar5iv-site.0.2.2.css">
</head>
<body>
<div class="ltx_page_main">
<div class="ltx_page_content">
<article class="ltx_document ltx_pruned_first">
<h1 class="ltx_title ltx_title_document">Client Adaptation improves Federated Learning
<br class="ltx_break">with Simulated Non-IID Clients</h1>
<div class="ltx_authors">
<span class="ltx_creator ltx_role_author">
<span class="ltx_personname">L. Rieger
</span></span>
<span class="ltx_author_before">  </span><span class="ltx_creator ltx_role_author">
<span class="ltx_personname">R. M. Th. Høegh
</span></span>
<span class="ltx_author_before">  </span><span class="ltx_creator ltx_role_author">
<span class="ltx_personname">L. K. Hansen
</span></span>
</div>

<div class="ltx_abstract">
<h6 class="ltx_title ltx_title_abstract">Abstract</h6>
<p id="id1.id1" class="ltx_p">We present a federated learning approach for learning a client adaptable, robust model when data is non-identically and non-independently distributed (non-IID) across clients.
By simulating heterogeneous clients, we show that adding learned client-specific conditioning improves model performance, and the approach is shown to work on balanced and imbalanced data set from both audio and image domains.
The client adaptation is implemented by a conditional gated activation
unit and is particularly beneficial when there are large differences between the data distribution for each client, a common scenario in federated learning.</p>
</div>
<div class="ltx_keywords">federated learning, audio representation, distributed
</div>
<div id="p2" class="ltx_para">
<br class="ltx_break">
</div>
<section id="S1" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">1 </span>Introduction</h2>

<div id="S1.p1" class="ltx_para">
<p id="S1.p1.1" class="ltx_p">As of 2019, an estimated three billion mobile phones are connected to the internet, collectively amassing a staggering amount of information <cite class="ltx_cite ltx_citemacro_citep">(Lim et al., <a href="#bib.bib14" title="" class="ltx_ref">2019</a>)</cite>, and it is highly desirable to make this data available for ever more data-demanding neural networks.
Traditional approaches for training neural networks require that all data is collected in one place for training.
However, as the data is often sensitive, and contains a wealth of private information about the user, centralized data collection is not always realizable or desirable.</p>
</div>
<div id="S1.p2" class="ltx_para">
<p id="S1.p2.1" class="ltx_p">Federated learning (FL) provides an approach to learn a centralized model from decentralized data in a privacy-aware manner <cite class="ltx_cite ltx_citemacro_citep">(McMahan et al., <a href="#bib.bib16" title="" class="ltx_ref">2016</a>)</cite>.
Local copies of a global model are trained at participating decentralized nodes (or clients) with local data, and the model is then consolidated episodically.
While there are privacy concerns about potential data leakage through model updates, federated learning is often preferable to training a model in a centralized manner <cite class="ltx_cite ltx_citemacro_citep">(Wei et al., <a href="#bib.bib24" title="" class="ltx_ref">2020</a>)</cite>.
Learning in this decentralized manner does, however, pose new problems for training neural networks, especially when the data available at individual clients is highly heterogeneous as well as sensitive from a privacy perspective.
An example of such highly sensitive data is audio collected by personal mobile devices.</p>
</div>
<div id="S1.p3" class="ltx_para">
<p id="S1.p3.1" class="ltx_p">A federated learning approach where the data does not leave the person’s phone is particularly well-suited for this scenario.
Yet, such data from smartphones is challenging in multiple points. Not only might the data be class imbalanced, but even conditioned on the class the feature distributions between clients can diverge, as people are in different environments with different soundscapes and use different phones to record the data.
<cite class="ltx_cite ltx_citemacro_citet">Li et al. (<a href="#bib.bib13" title="" class="ltx_ref">2019b</a>)</cite> noted that while the original federated learning algorithm FederatedAveraging algorithm (<span id="S1.p3.1.1" class="ltx_text ltx_font_smallcaps">FedAvg</span>) will converge under certain strong assumptions, it lacks this guarantee under this more realistic assumption that data distribution between clients will be diverse.</p>
</div>
<div id="S1.p4" class="ltx_para">
<p id="S1.p4.1" class="ltx_p">However, certain features of the input, while variant across clients, are likely to be consistent for a single client, as people tend to e.g. use the same phone for a long amount of time and do not change their voice or speaking patterns substantially.
Motivated by this, we propose to learn a local embedding for each client along with the global model as shown in <a href="#S3.F1" title="In 3.2 Client adaptation through conditional gated activation units ‣ 3 Methods ‣ Client Adaptation improves Federated Learning with Simulated Non-IID Clients" class="ltx_ref"><span class="ltx_text ltx_ref_tag">Fig.</span> <span class="ltx_text ltx_ref_tag">1</span></a>.
We evaluate this approach, which we coined the conditional gated activation unit (CGAU), on two classification tasks, one from the audio domain and one from the image domain, covering both balanced and imbalanced data. CGAU outperforms a baseline in both scenarios, showing the usefulness of learning localized features explicitly as opposed to encoding them in the global model.</p>
</div>
<div id="S1.p5" class="ltx_para">
<p id="S1.p5.1" class="ltx_p">The current paper presents two contributions. Firstly, we propose the conditional gated activation unit (CGAU), an enhancement for current neural network architectures suited for federated learning that captures features in client-dependent non-IID data. CGAU can be utilized in conjunction with currently used federated learning algorithms such as <span id="S1.p5.1.1" class="ltx_text ltx_font_smallcaps">FedAvg</span>. Secondly, to evaluate CGAU, we present a principled approach to simulate clients with non-IID data for evaluating federated learning. The approach utilizes embeddings from pre-trained networks to simulate clients by finding clusters in the embedding space.</p>
</div>
</section>
<section id="S2" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">2 </span>Background</h2>

<div id="S2.p1" class="ltx_para">
<p id="S2.p1.1" class="ltx_p">In 2016 <cite class="ltx_cite ltx_citemacro_citet">McMahan et al. (<a href="#bib.bib15" title="" class="ltx_ref">2017</a>)</cite> coined the term federated learning to refer to the training of a model with data that is only available at many distributed devices. This setting is characterized by a few properties that challenge traditional machine learning approaches. For one, the data is typically distributed on a large number of clients. Additionally, since there is a large variance in the behaviour and environment of the typical phone user, it is non-IID. Finally, the data is likely to be unbalanced, i.e. there is a large variance in the number of samples and class distributions at each client.</p>
</div>
<div id="S2.p2" class="ltx_para">
<p id="S2.p2.3" class="ltx_p">To combat those issues they proposed the <span id="S2.p2.3.1" class="ltx_text ltx_font_smallcaps">FedAvg</span>, a variant on traditional stochastic gradient descent (SGD).
<span id="S2.p2.3.2" class="ltx_text ltx_font_smallcaps">FedAvg</span> consolidates training updates from a large number of different sources with potentially unbalanced training data. Each client has a local copy of the model to be trained. In each round, a fraction of the total clients available computes the weight update of the model on their locally available data. The number of weight updates before global consolidation <math id="S2.p2.1.m1.1" class="ltx_Math" alttext="E" display="inline"><semantics id="S2.p2.1.m1.1a"><mi id="S2.p2.1.m1.1.1" xref="S2.p2.1.m1.1.1.cmml">E</mi><annotation-xml encoding="MathML-Content" id="S2.p2.1.m1.1b"><ci id="S2.p2.1.m1.1.1.cmml" xref="S2.p2.1.m1.1.1">𝐸</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.p2.1.m1.1c">E</annotation></semantics></math> is a hyperparameter.
After <math id="S2.p2.2.m2.1" class="ltx_Math" alttext="E" display="inline"><semantics id="S2.p2.2.m2.1a"><mi id="S2.p2.2.m2.1.1" xref="S2.p2.2.m2.1.1.cmml">E</mi><annotation-xml encoding="MathML-Content" id="S2.p2.2.m2.1b"><ci id="S2.p2.2.m2.1.1.cmml" xref="S2.p2.2.m2.1.1">𝐸</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.p2.2.m2.1c">E</annotation></semantics></math> weight updates on the local model, the client sends the local model to the server. The server averages the model weights from all clients into the global model.
By only synchronizing the local models every <math id="S2.p2.3.m3.1" class="ltx_Math" alttext="E" display="inline"><semantics id="S2.p2.3.m3.1a"><mi id="S2.p2.3.m3.1.1" xref="S2.p2.3.m3.1.1.cmml">E</mi><annotation-xml encoding="MathML-Content" id="S2.p2.3.m3.1b"><ci id="S2.p2.3.m3.1.1.cmml" xref="S2.p2.3.m3.1.1">𝐸</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.p2.3.m3.1c">E</annotation></semantics></math> steps, the communication cost is greatly reduced, making <span id="S2.p2.3.3" class="ltx_text ltx_font_smallcaps">FedAvg</span> feasible for training on distributed clients.</p>
</div>
<div id="S2.p3" class="ltx_para">
<p id="S2.p3.1" class="ltx_p">Since <cite class="ltx_cite ltx_citemacro_citet">McMahan et al. (<a href="#bib.bib15" title="" class="ltx_ref">2017</a>)</cite> a number of papers have followed up on this approach, aiming to e.g. reduce the necessary communication between clients, examine the vulnerability of the model towards adversarial attacks or deal with non-IID data <cite class="ltx_cite ltx_citemacro_citep">(Konečnỳ et al., <a href="#bib.bib10" title="" class="ltx_ref">2016</a>; Sattler et al., <a href="#bib.bib20" title="" class="ltx_ref">2019</a>; Li et al., <a href="#bib.bib13" title="" class="ltx_ref">2019b</a>; Bagdasaryan et al., <a href="#bib.bib2" title="" class="ltx_ref">2018</a>; Nguyen et al., <a href="#bib.bib17" title="" class="ltx_ref">2020</a>)</cite>.
We focus specifically on approaches dealing with non-IID data, and we will in the following assume a traditional supervised learning task, learning a function that maps an input to an output class. This covers the most common tasks where federated learning is used.</p>
</div>
<div id="S2.p4" class="ltx_para">
<p id="S2.p4.1" class="ltx_p"><cite class="ltx_cite ltx_citemacro_citet">Zhao et al. (<a href="#bib.bib25" title="" class="ltx_ref">2018</a>)</cite> showed that federated learning is vulnerable to data being non-IID in the distribution of classes with the extreme case being that each client only sees one class.
They show that the difficulty arises because the model weights from different classes diverge too much before global synchronization. They also show how weight divergence in between clients is bounded by the earth mover’s distance in between the distributions of classes from the clients and the global distribution. The model performance can be partly recovered by sharing a small proportion of the data globally to all clients. In contrast to our work, they only consider differences in distribution over the classes, not in characteristics of the input data (non-IID feature distributions as opposed to class distributions).</p>
</div>
<div id="S2.p5" class="ltx_para">
<p id="S2.p5.1" class="ltx_p"><cite class="ltx_cite ltx_citemacro_citet">Sattler et al. (<a href="#bib.bib20" title="" class="ltx_ref">2019</a>)</cite> proposed a new compression scheme, sparse ternary compression (STC) to reduce the communication necessary in a non-IID setting regarding the class distributions from the individual clients.</p>
</div>
<div id="S2.p6" class="ltx_para">
<p id="S2.p6.1" class="ltx_p">Recently <cite class="ltx_cite ltx_citemacro_citet">Li et al. (<a href="#bib.bib13" title="" class="ltx_ref">2019b</a>)</cite> further examined the influence of non-IID data on model performance. They show empirically and theoretically that heterogeneous data will slow down convergence of the model to the minimum and established that with non-IID data, the learning rate must be decayed over time for the model to converge to the optimal state.</p>
</div>
<div id="S2.p7" class="ltx_para">
<p id="S2.p7.1" class="ltx_p"><cite class="ltx_cite ltx_citemacro_citet">Peng et al. (<a href="#bib.bib19" title="" class="ltx_ref">2019</a>)</cite> aim to mitigate the effect of domain shift heterogeneity by learning invariant features with adversarial reconstruction. They split up the embedding of the input into a domain-specific and domain-invariant part by minimizing mutual information between the two components. Then only the domain-invariant component is used for classification of the original task while an additional loss function is placed on a complete reconstruction of the input embedding from both. In this way, the network learns to disentangle the domain-invariant features and becomes more robust towards domain shift.</p>
</div>
<div id="S2.p8" class="ltx_para">
<p id="S2.p8.1" class="ltx_p">Finally, <cite class="ltx_cite ltx_citemacro_citet">Ghosh et al. (<a href="#bib.bib6" title="" class="ltx_ref">2019</a>)</cite> proposes a solution for training with heterogeneous data distributions on the clients. They propose first finding independent locally optimal solutions for each client. The clients then send their model to the server. The server clusters the clients based on the locally optimal solutions. Consequently, a traditional FL optimization is run for each client cluster.
Like in our work, they explicitly consider diversity in the data distributions.
However, in contrast to our work <cite class="ltx_cite ltx_citemacro_citet">Ghosh et al. (<a href="#bib.bib6" title="" class="ltx_ref">2019</a>)</cite> do not work with neural networks as it assumes a (relatively) low-dimensional representation of the learnt algorithm parameters.</p>
</div>
</section>
<section id="S3" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">3 </span>Methods</h2>

<section id="S3.SS1" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.1 </span>Federated learning with pre-trained networks</h3>

<div id="S3.SS1.p1" class="ltx_para">
<p id="S3.SS1.p1.1" class="ltx_p">Deep learning requires, in general, a large amount of data and computational power for training, and the resulting models are often of considerable size in terms of memory.
In settings where resources like computational power, data, and data transfer are limited, e.g., for federated learning on mobile devices, the resource demands of training deep neural networks from scratch can be prohibitively large. Pre-trained neural networks, fine-tuned on the task at hand via transfer-learning present a viable solution for these issues.</p>
</div>
<div id="S3.SS1.p2" class="ltx_para">
<p id="S3.SS1.p2.1" class="ltx_p">We investigate the use of pre-trained networks for classifications tasks in a federated learning scheme, where a pre-trained network is used as a “frozen” feature extractor (that is, the pre-trained network is not further trained using federated learning).
By using a pre-trained network, we off-load the needed computational power and data required from the federated learning process as the feature extractor network can be trained centrally using any available but task-relevant data, or taken from already trained networks from a relevant domain.
Additionally, the communication costs are reduced, as the feature extractor does not need to be sent back and forth between rounds of federated learning.
The federated learning then only has to learn to solve the problem of interest by learning a (much smaller) classifier on top of the embedding that the pre-trained network produces.</p>
</div>
</section>
<section id="S3.SS2" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.2 </span>Client adaptation through conditional gated activation units</h3>

<div id="S3.SS2.p1" class="ltx_para">
<p id="S3.SS2.p1.1" class="ltx_p">Heterogeneous clients with features that are non-IID are an inevitable part of federated learning in realistic settings.
Given a set of completely homogeneous clients, anything a model learns based on a particular client would generalize to other clients.
With heterogeneous clients, however, some class characteristics for a particular client might, or might not, generalize to other clients.
Similarly, some shared class characteristics might be expressed differently at each client.
Learning in such heterogeneous settings is more difficult, in part, as the information that can be shared between clients is reduced (e.g. by patterns distinct to a subset of clients, which we will call client-specific expression) and the information that can be shared is obfuscated (the same underlying pattern looks somewhat different at different clients, which we will call client-specific modulation).</p>
</div>
<div id="S3.SS2.p2" class="ltx_para">
<p id="S3.SS2.p2.1" class="ltx_p">We propose the use of a simple architectural component for enabling a (federated learning) model to identify whether global features are expressed at a client and how each client modulates global patterns.
Specifically, for the classifiers on top of the pre-trained networks, we use a feed-forward neural network with gated activation units and enable the model to condition the units based on the client.
We will refer to units as a conditional gated activation units, CGAU, see <a href="#S3.F1" title="In 3.2 Client adaptation through conditional gated activation units ‣ 3 Methods ‣ Client Adaptation improves Federated Learning with Simulated Non-IID Clients" class="ltx_ref"><span class="ltx_text ltx_ref_tag">Fig.</span> <span class="ltx_text ltx_ref_tag">1</span></a>.
A federated learning algorithm, such as <span id="S3.SS2.p2.1.1" class="ltx_text ltx_font_smallcaps">FedAvg</span>, can then be used to optimize the classifier.</p>
</div>
<div id="S3.SS2.p3" class="ltx_para">
<p id="S3.SS2.p3.8" class="ltx_p">The CGAU consists of two parts.
In a gated part (orange), an input <math id="S3.SS2.p3.1.m1.1" class="ltx_Math" alttext="\mathbf{x}" display="inline"><semantics id="S3.SS2.p3.1.m1.1a"><mi id="S3.SS2.p3.1.m1.1.1" xref="S3.SS2.p3.1.m1.1.1.cmml">𝐱</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p3.1.m1.1b"><ci id="S3.SS2.p3.1.m1.1.1.cmml" xref="S3.SS2.p3.1.m1.1.1">𝐱</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p3.1.m1.1c">\mathbf{x}</annotation></semantics></math> is processed by filter- and gate-weights (learnable <math id="S3.SS2.p3.2.m2.2" class="ltx_Math" alttext="\mathbf{W}_{f},\,\mathbf{W}_{g}\in\mathbb{R}^{D\times N}" display="inline"><semantics id="S3.SS2.p3.2.m2.2a"><mrow id="S3.SS2.p3.2.m2.2.2" xref="S3.SS2.p3.2.m2.2.2.cmml"><mrow id="S3.SS2.p3.2.m2.2.2.2.2" xref="S3.SS2.p3.2.m2.2.2.2.3.cmml"><msub id="S3.SS2.p3.2.m2.1.1.1.1.1" xref="S3.SS2.p3.2.m2.1.1.1.1.1.cmml"><mi id="S3.SS2.p3.2.m2.1.1.1.1.1.2" xref="S3.SS2.p3.2.m2.1.1.1.1.1.2.cmml">𝐖</mi><mi id="S3.SS2.p3.2.m2.1.1.1.1.1.3" xref="S3.SS2.p3.2.m2.1.1.1.1.1.3.cmml">f</mi></msub><mo rspace="0.337em" id="S3.SS2.p3.2.m2.2.2.2.2.3" xref="S3.SS2.p3.2.m2.2.2.2.3.cmml">,</mo><msub id="S3.SS2.p3.2.m2.2.2.2.2.2" xref="S3.SS2.p3.2.m2.2.2.2.2.2.cmml"><mi id="S3.SS2.p3.2.m2.2.2.2.2.2.2" xref="S3.SS2.p3.2.m2.2.2.2.2.2.2.cmml">𝐖</mi><mi id="S3.SS2.p3.2.m2.2.2.2.2.2.3" xref="S3.SS2.p3.2.m2.2.2.2.2.2.3.cmml">g</mi></msub></mrow><mo id="S3.SS2.p3.2.m2.2.2.3" xref="S3.SS2.p3.2.m2.2.2.3.cmml">∈</mo><msup id="S3.SS2.p3.2.m2.2.2.4" xref="S3.SS2.p3.2.m2.2.2.4.cmml"><mi id="S3.SS2.p3.2.m2.2.2.4.2" xref="S3.SS2.p3.2.m2.2.2.4.2.cmml">ℝ</mi><mrow id="S3.SS2.p3.2.m2.2.2.4.3" xref="S3.SS2.p3.2.m2.2.2.4.3.cmml"><mi id="S3.SS2.p3.2.m2.2.2.4.3.2" xref="S3.SS2.p3.2.m2.2.2.4.3.2.cmml">D</mi><mo lspace="0.222em" rspace="0.222em" id="S3.SS2.p3.2.m2.2.2.4.3.1" xref="S3.SS2.p3.2.m2.2.2.4.3.1.cmml">×</mo><mi id="S3.SS2.p3.2.m2.2.2.4.3.3" xref="S3.SS2.p3.2.m2.2.2.4.3.3.cmml">N</mi></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p3.2.m2.2b"><apply id="S3.SS2.p3.2.m2.2.2.cmml" xref="S3.SS2.p3.2.m2.2.2"><in id="S3.SS2.p3.2.m2.2.2.3.cmml" xref="S3.SS2.p3.2.m2.2.2.3"></in><list id="S3.SS2.p3.2.m2.2.2.2.3.cmml" xref="S3.SS2.p3.2.m2.2.2.2.2"><apply id="S3.SS2.p3.2.m2.1.1.1.1.1.cmml" xref="S3.SS2.p3.2.m2.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS2.p3.2.m2.1.1.1.1.1.1.cmml" xref="S3.SS2.p3.2.m2.1.1.1.1.1">subscript</csymbol><ci id="S3.SS2.p3.2.m2.1.1.1.1.1.2.cmml" xref="S3.SS2.p3.2.m2.1.1.1.1.1.2">𝐖</ci><ci id="S3.SS2.p3.2.m2.1.1.1.1.1.3.cmml" xref="S3.SS2.p3.2.m2.1.1.1.1.1.3">𝑓</ci></apply><apply id="S3.SS2.p3.2.m2.2.2.2.2.2.cmml" xref="S3.SS2.p3.2.m2.2.2.2.2.2"><csymbol cd="ambiguous" id="S3.SS2.p3.2.m2.2.2.2.2.2.1.cmml" xref="S3.SS2.p3.2.m2.2.2.2.2.2">subscript</csymbol><ci id="S3.SS2.p3.2.m2.2.2.2.2.2.2.cmml" xref="S3.SS2.p3.2.m2.2.2.2.2.2.2">𝐖</ci><ci id="S3.SS2.p3.2.m2.2.2.2.2.2.3.cmml" xref="S3.SS2.p3.2.m2.2.2.2.2.2.3">𝑔</ci></apply></list><apply id="S3.SS2.p3.2.m2.2.2.4.cmml" xref="S3.SS2.p3.2.m2.2.2.4"><csymbol cd="ambiguous" id="S3.SS2.p3.2.m2.2.2.4.1.cmml" xref="S3.SS2.p3.2.m2.2.2.4">superscript</csymbol><ci id="S3.SS2.p3.2.m2.2.2.4.2.cmml" xref="S3.SS2.p3.2.m2.2.2.4.2">ℝ</ci><apply id="S3.SS2.p3.2.m2.2.2.4.3.cmml" xref="S3.SS2.p3.2.m2.2.2.4.3"><times id="S3.SS2.p3.2.m2.2.2.4.3.1.cmml" xref="S3.SS2.p3.2.m2.2.2.4.3.1"></times><ci id="S3.SS2.p3.2.m2.2.2.4.3.2.cmml" xref="S3.SS2.p3.2.m2.2.2.4.3.2">𝐷</ci><ci id="S3.SS2.p3.2.m2.2.2.4.3.3.cmml" xref="S3.SS2.p3.2.m2.2.2.4.3.3">𝑁</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p3.2.m2.2c">\mathbf{W}_{f},\,\mathbf{W}_{g}\in\mathbb{R}^{D\times N}</annotation></semantics></math>, respectively, where <math id="S3.SS2.p3.3.m3.1" class="ltx_Math" alttext="N" display="inline"><semantics id="S3.SS2.p3.3.m3.1a"><mi id="S3.SS2.p3.3.m3.1.1" xref="S3.SS2.p3.3.m3.1.1.cmml">N</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p3.3.m3.1b"><ci id="S3.SS2.p3.3.m3.1.1.cmml" xref="S3.SS2.p3.3.m3.1.1">𝑁</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p3.3.m3.1c">N</annotation></semantics></math> is the number of units and <math id="S3.SS2.p3.4.m4.1" class="ltx_Math" alttext="D" display="inline"><semantics id="S3.SS2.p3.4.m4.1a"><mi id="S3.SS2.p3.4.m4.1.1" xref="S3.SS2.p3.4.m4.1.1.cmml">D</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p3.4.m4.1b"><ci id="S3.SS2.p3.4.m4.1.1.cmml" xref="S3.SS2.p3.4.m4.1.1">𝐷</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p3.4.m4.1c">D</annotation></semantics></math> is the dimensionality of the input) followed by a hyperbolic tangent or a sigmoidal activation function.
The conditioning part (green) shifts the responses of the filter (<math id="S3.SS2.p3.5.m5.1" class="ltx_Math" alttext="\mathbf{W}_{f}^{\top}\mathbf{x}" display="inline"><semantics id="S3.SS2.p3.5.m5.1a"><mrow id="S3.SS2.p3.5.m5.1.1" xref="S3.SS2.p3.5.m5.1.1.cmml"><msubsup id="S3.SS2.p3.5.m5.1.1.2" xref="S3.SS2.p3.5.m5.1.1.2.cmml"><mi id="S3.SS2.p3.5.m5.1.1.2.2.2" xref="S3.SS2.p3.5.m5.1.1.2.2.2.cmml">𝐖</mi><mi id="S3.SS2.p3.5.m5.1.1.2.2.3" xref="S3.SS2.p3.5.m5.1.1.2.2.3.cmml">f</mi><mo id="S3.SS2.p3.5.m5.1.1.2.3" xref="S3.SS2.p3.5.m5.1.1.2.3.cmml">⊤</mo></msubsup><mo lspace="0em" rspace="0em" id="S3.SS2.p3.5.m5.1.1.1" xref="S3.SS2.p3.5.m5.1.1.1.cmml">​</mo><mi id="S3.SS2.p3.5.m5.1.1.3" xref="S3.SS2.p3.5.m5.1.1.3.cmml">𝐱</mi></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p3.5.m5.1b"><apply id="S3.SS2.p3.5.m5.1.1.cmml" xref="S3.SS2.p3.5.m5.1.1"><times id="S3.SS2.p3.5.m5.1.1.1.cmml" xref="S3.SS2.p3.5.m5.1.1.1"></times><apply id="S3.SS2.p3.5.m5.1.1.2.cmml" xref="S3.SS2.p3.5.m5.1.1.2"><csymbol cd="ambiguous" id="S3.SS2.p3.5.m5.1.1.2.1.cmml" xref="S3.SS2.p3.5.m5.1.1.2">superscript</csymbol><apply id="S3.SS2.p3.5.m5.1.1.2.2.cmml" xref="S3.SS2.p3.5.m5.1.1.2"><csymbol cd="ambiguous" id="S3.SS2.p3.5.m5.1.1.2.2.1.cmml" xref="S3.SS2.p3.5.m5.1.1.2">subscript</csymbol><ci id="S3.SS2.p3.5.m5.1.1.2.2.2.cmml" xref="S3.SS2.p3.5.m5.1.1.2.2.2">𝐖</ci><ci id="S3.SS2.p3.5.m5.1.1.2.2.3.cmml" xref="S3.SS2.p3.5.m5.1.1.2.2.3">𝑓</ci></apply><csymbol cd="latexml" id="S3.SS2.p3.5.m5.1.1.2.3.cmml" xref="S3.SS2.p3.5.m5.1.1.2.3">top</csymbol></apply><ci id="S3.SS2.p3.5.m5.1.1.3.cmml" xref="S3.SS2.p3.5.m5.1.1.3">𝐱</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p3.5.m5.1c">\mathbf{W}_{f}^{\top}\mathbf{x}</annotation></semantics></math>) and gate (<math id="S3.SS2.p3.6.m6.1" class="ltx_Math" alttext="\mathbf{W}_{g}^{\top}\mathbf{x}" display="inline"><semantics id="S3.SS2.p3.6.m6.1a"><mrow id="S3.SS2.p3.6.m6.1.1" xref="S3.SS2.p3.6.m6.1.1.cmml"><msubsup id="S3.SS2.p3.6.m6.1.1.2" xref="S3.SS2.p3.6.m6.1.1.2.cmml"><mi id="S3.SS2.p3.6.m6.1.1.2.2.2" xref="S3.SS2.p3.6.m6.1.1.2.2.2.cmml">𝐖</mi><mi id="S3.SS2.p3.6.m6.1.1.2.2.3" xref="S3.SS2.p3.6.m6.1.1.2.2.3.cmml">g</mi><mo id="S3.SS2.p3.6.m6.1.1.2.3" xref="S3.SS2.p3.6.m6.1.1.2.3.cmml">⊤</mo></msubsup><mo lspace="0em" rspace="0em" id="S3.SS2.p3.6.m6.1.1.1" xref="S3.SS2.p3.6.m6.1.1.1.cmml">​</mo><mi id="S3.SS2.p3.6.m6.1.1.3" xref="S3.SS2.p3.6.m6.1.1.3.cmml">𝐱</mi></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p3.6.m6.1b"><apply id="S3.SS2.p3.6.m6.1.1.cmml" xref="S3.SS2.p3.6.m6.1.1"><times id="S3.SS2.p3.6.m6.1.1.1.cmml" xref="S3.SS2.p3.6.m6.1.1.1"></times><apply id="S3.SS2.p3.6.m6.1.1.2.cmml" xref="S3.SS2.p3.6.m6.1.1.2"><csymbol cd="ambiguous" id="S3.SS2.p3.6.m6.1.1.2.1.cmml" xref="S3.SS2.p3.6.m6.1.1.2">superscript</csymbol><apply id="S3.SS2.p3.6.m6.1.1.2.2.cmml" xref="S3.SS2.p3.6.m6.1.1.2"><csymbol cd="ambiguous" id="S3.SS2.p3.6.m6.1.1.2.2.1.cmml" xref="S3.SS2.p3.6.m6.1.1.2">subscript</csymbol><ci id="S3.SS2.p3.6.m6.1.1.2.2.2.cmml" xref="S3.SS2.p3.6.m6.1.1.2.2.2">𝐖</ci><ci id="S3.SS2.p3.6.m6.1.1.2.2.3.cmml" xref="S3.SS2.p3.6.m6.1.1.2.2.3">𝑔</ci></apply><csymbol cd="latexml" id="S3.SS2.p3.6.m6.1.1.2.3.cmml" xref="S3.SS2.p3.6.m6.1.1.2.3">top</csymbol></apply><ci id="S3.SS2.p3.6.m6.1.1.3.cmml" xref="S3.SS2.p3.6.m6.1.1.3">𝐱</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p3.6.m6.1c">\mathbf{W}_{g}^{\top}\mathbf{x}</annotation></semantics></math>) before applying the activation functions.
A simplifying view of the process, to provide some intuition, is that the conditioning of the filtering responses modulates the global features (“what the feature is”), and the conditioning of the gating responses controls the client expression of features (“whether this feature is active”), each through corresponding learnable weights <math id="S3.SS2.p3.7.m7.2" class="ltx_Math" alttext="\mathbf{V}_{f},\mathbf{V}_{g}\in\mathbb{R}^{K\times N}" display="inline"><semantics id="S3.SS2.p3.7.m7.2a"><mrow id="S3.SS2.p3.7.m7.2.2" xref="S3.SS2.p3.7.m7.2.2.cmml"><mrow id="S3.SS2.p3.7.m7.2.2.2.2" xref="S3.SS2.p3.7.m7.2.2.2.3.cmml"><msub id="S3.SS2.p3.7.m7.1.1.1.1.1" xref="S3.SS2.p3.7.m7.1.1.1.1.1.cmml"><mi id="S3.SS2.p3.7.m7.1.1.1.1.1.2" xref="S3.SS2.p3.7.m7.1.1.1.1.1.2.cmml">𝐕</mi><mi id="S3.SS2.p3.7.m7.1.1.1.1.1.3" xref="S3.SS2.p3.7.m7.1.1.1.1.1.3.cmml">f</mi></msub><mo id="S3.SS2.p3.7.m7.2.2.2.2.3" xref="S3.SS2.p3.7.m7.2.2.2.3.cmml">,</mo><msub id="S3.SS2.p3.7.m7.2.2.2.2.2" xref="S3.SS2.p3.7.m7.2.2.2.2.2.cmml"><mi id="S3.SS2.p3.7.m7.2.2.2.2.2.2" xref="S3.SS2.p3.7.m7.2.2.2.2.2.2.cmml">𝐕</mi><mi id="S3.SS2.p3.7.m7.2.2.2.2.2.3" xref="S3.SS2.p3.7.m7.2.2.2.2.2.3.cmml">g</mi></msub></mrow><mo id="S3.SS2.p3.7.m7.2.2.3" xref="S3.SS2.p3.7.m7.2.2.3.cmml">∈</mo><msup id="S3.SS2.p3.7.m7.2.2.4" xref="S3.SS2.p3.7.m7.2.2.4.cmml"><mi id="S3.SS2.p3.7.m7.2.2.4.2" xref="S3.SS2.p3.7.m7.2.2.4.2.cmml">ℝ</mi><mrow id="S3.SS2.p3.7.m7.2.2.4.3" xref="S3.SS2.p3.7.m7.2.2.4.3.cmml"><mi id="S3.SS2.p3.7.m7.2.2.4.3.2" xref="S3.SS2.p3.7.m7.2.2.4.3.2.cmml">K</mi><mo lspace="0.222em" rspace="0.222em" id="S3.SS2.p3.7.m7.2.2.4.3.1" xref="S3.SS2.p3.7.m7.2.2.4.3.1.cmml">×</mo><mi id="S3.SS2.p3.7.m7.2.2.4.3.3" xref="S3.SS2.p3.7.m7.2.2.4.3.3.cmml">N</mi></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p3.7.m7.2b"><apply id="S3.SS2.p3.7.m7.2.2.cmml" xref="S3.SS2.p3.7.m7.2.2"><in id="S3.SS2.p3.7.m7.2.2.3.cmml" xref="S3.SS2.p3.7.m7.2.2.3"></in><list id="S3.SS2.p3.7.m7.2.2.2.3.cmml" xref="S3.SS2.p3.7.m7.2.2.2.2"><apply id="S3.SS2.p3.7.m7.1.1.1.1.1.cmml" xref="S3.SS2.p3.7.m7.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS2.p3.7.m7.1.1.1.1.1.1.cmml" xref="S3.SS2.p3.7.m7.1.1.1.1.1">subscript</csymbol><ci id="S3.SS2.p3.7.m7.1.1.1.1.1.2.cmml" xref="S3.SS2.p3.7.m7.1.1.1.1.1.2">𝐕</ci><ci id="S3.SS2.p3.7.m7.1.1.1.1.1.3.cmml" xref="S3.SS2.p3.7.m7.1.1.1.1.1.3">𝑓</ci></apply><apply id="S3.SS2.p3.7.m7.2.2.2.2.2.cmml" xref="S3.SS2.p3.7.m7.2.2.2.2.2"><csymbol cd="ambiguous" id="S3.SS2.p3.7.m7.2.2.2.2.2.1.cmml" xref="S3.SS2.p3.7.m7.2.2.2.2.2">subscript</csymbol><ci id="S3.SS2.p3.7.m7.2.2.2.2.2.2.cmml" xref="S3.SS2.p3.7.m7.2.2.2.2.2.2">𝐕</ci><ci id="S3.SS2.p3.7.m7.2.2.2.2.2.3.cmml" xref="S3.SS2.p3.7.m7.2.2.2.2.2.3">𝑔</ci></apply></list><apply id="S3.SS2.p3.7.m7.2.2.4.cmml" xref="S3.SS2.p3.7.m7.2.2.4"><csymbol cd="ambiguous" id="S3.SS2.p3.7.m7.2.2.4.1.cmml" xref="S3.SS2.p3.7.m7.2.2.4">superscript</csymbol><ci id="S3.SS2.p3.7.m7.2.2.4.2.cmml" xref="S3.SS2.p3.7.m7.2.2.4.2">ℝ</ci><apply id="S3.SS2.p3.7.m7.2.2.4.3.cmml" xref="S3.SS2.p3.7.m7.2.2.4.3"><times id="S3.SS2.p3.7.m7.2.2.4.3.1.cmml" xref="S3.SS2.p3.7.m7.2.2.4.3.1"></times><ci id="S3.SS2.p3.7.m7.2.2.4.3.2.cmml" xref="S3.SS2.p3.7.m7.2.2.4.3.2">𝐾</ci><ci id="S3.SS2.p3.7.m7.2.2.4.3.3.cmml" xref="S3.SS2.p3.7.m7.2.2.4.3.3">𝑁</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p3.7.m7.2c">\mathbf{V}_{f},\mathbf{V}_{g}\in\mathbb{R}^{K\times N}</annotation></semantics></math>, where <math id="S3.SS2.p3.8.m8.1" class="ltx_Math" alttext="K" display="inline"><semantics id="S3.SS2.p3.8.m8.1a"><mi id="S3.SS2.p3.8.m8.1.1" xref="S3.SS2.p3.8.m8.1.1.cmml">K</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p3.8.m8.1b"><ci id="S3.SS2.p3.8.m8.1.1.cmml" xref="S3.SS2.p3.8.m8.1.1">𝐾</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p3.8.m8.1c">K</annotation></semantics></math> is the number of clients.</p>
</div>
<div id="S3.SS2.p4" class="ltx_para">
<p id="S3.SS2.p4.1" class="ltx_p">In total, the output of the CGAU, <math id="S3.SS2.p4.1.m1.1" class="ltx_Math" alttext="\mathbf{z}" display="inline"><semantics id="S3.SS2.p4.1.m1.1a"><mi id="S3.SS2.p4.1.m1.1.1" xref="S3.SS2.p4.1.m1.1.1.cmml">𝐳</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p4.1.m1.1b"><ci id="S3.SS2.p4.1.m1.1.1.cmml" xref="S3.SS2.p4.1.m1.1.1">𝐳</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p4.1.m1.1c">\mathbf{z}</annotation></semantics></math>, is:</p>
<table id="S3.E1" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S3.E1.m1.4" class="ltx_Math" alttext="\mathbf{z}=\overbrace{\tanh(\mathbf{W}_{f}^{\top}\mathbf{x}+\underbrace{\mathbf{V}_{f}^{\top}\mathbf{h}}_{\mathrm{\color[rgb]{0.46484375,0.98046875,0}modulation}})}^{\mathrm{\color[rgb]{0.9921875,0.6171875,0}filter}}\odot\overbrace{\sigma(\mathbf{W}_{g}^{\top}\mathbf{x}+\underbrace{\mathbf{V}_{g}^{\top}\mathbf{h}}_{\mathrm{\color[rgb]{0.46484375,0.98046875,0}expression}})}^{\mathrm{\color[rgb]{0.9921875,0.6171875,0}gate}}," display="block"><semantics id="S3.E1.m1.4a"><mrow id="S3.E1.m1.4.4.1" xref="S3.E1.m1.4.4.1.1.cmml"><mrow id="S3.E1.m1.4.4.1.1" xref="S3.E1.m1.4.4.1.1.cmml"><mi id="S3.E1.m1.4.4.1.1.2" xref="S3.E1.m1.4.4.1.1.2.cmml">𝐳</mi><mo id="S3.E1.m1.4.4.1.1.1" xref="S3.E1.m1.4.4.1.1.1.cmml">=</mo><mrow id="S3.E1.m1.4.4.1.1.3" xref="S3.E1.m1.4.4.1.1.3.cmml"><mover id="S3.E1.m1.4.4.1.1.3.2" xref="S3.E1.m1.4.4.1.1.3.2.cmml"><mover accent="true" id="S3.E1.m1.2.2" xref="S3.E1.m1.2.2.cmml"><mrow id="S3.E1.m1.2.2.2.2" xref="S3.E1.m1.2.2.2.3.cmml"><mi id="S3.E1.m1.1.1.1.1" xref="S3.E1.m1.1.1.1.1.cmml">tanh</mi><mo id="S3.E1.m1.2.2.2.2a" xref="S3.E1.m1.2.2.2.3.cmml">⁡</mo><mrow id="S3.E1.m1.2.2.2.2.1" xref="S3.E1.m1.2.2.2.3.cmml"><mo stretchy="false" id="S3.E1.m1.2.2.2.2.1.2" xref="S3.E1.m1.2.2.2.3.cmml">(</mo><mrow id="S3.E1.m1.2.2.2.2.1.1" xref="S3.E1.m1.2.2.2.2.1.1.cmml"><mrow id="S3.E1.m1.2.2.2.2.1.1.2" xref="S3.E1.m1.2.2.2.2.1.1.2.cmml"><msubsup id="S3.E1.m1.2.2.2.2.1.1.2.2" xref="S3.E1.m1.2.2.2.2.1.1.2.2.cmml"><mi id="S3.E1.m1.2.2.2.2.1.1.2.2.2.2" xref="S3.E1.m1.2.2.2.2.1.1.2.2.2.2.cmml">𝐖</mi><mi id="S3.E1.m1.2.2.2.2.1.1.2.2.2.3" xref="S3.E1.m1.2.2.2.2.1.1.2.2.2.3.cmml">f</mi><mo id="S3.E1.m1.2.2.2.2.1.1.2.2.3" xref="S3.E1.m1.2.2.2.2.1.1.2.2.3.cmml">⊤</mo></msubsup><mo lspace="0em" rspace="0em" id="S3.E1.m1.2.2.2.2.1.1.2.1" xref="S3.E1.m1.2.2.2.2.1.1.2.1.cmml">​</mo><mi id="S3.E1.m1.2.2.2.2.1.1.2.3" xref="S3.E1.m1.2.2.2.2.1.1.2.3.cmml">𝐱</mi></mrow><mo id="S3.E1.m1.2.2.2.2.1.1.1" xref="S3.E1.m1.2.2.2.2.1.1.1.cmml">+</mo><munder id="S3.E1.m1.2.2.2.2.1.1.3" xref="S3.E1.m1.2.2.2.2.1.1.3.cmml"><munder accentunder="true" id="S3.E1.m1.2.2.2.2.1.1.3.2" xref="S3.E1.m1.2.2.2.2.1.1.3.2.cmml"><mrow id="S3.E1.m1.2.2.2.2.1.1.3.2.2" xref="S3.E1.m1.2.2.2.2.1.1.3.2.2.cmml"><msubsup id="S3.E1.m1.2.2.2.2.1.1.3.2.2.2" xref="S3.E1.m1.2.2.2.2.1.1.3.2.2.2.cmml"><mi id="S3.E1.m1.2.2.2.2.1.1.3.2.2.2.2.2" xref="S3.E1.m1.2.2.2.2.1.1.3.2.2.2.2.2.cmml">𝐕</mi><mi id="S3.E1.m1.2.2.2.2.1.1.3.2.2.2.2.3" xref="S3.E1.m1.2.2.2.2.1.1.3.2.2.2.2.3.cmml">f</mi><mo id="S3.E1.m1.2.2.2.2.1.1.3.2.2.2.3" xref="S3.E1.m1.2.2.2.2.1.1.3.2.2.2.3.cmml">⊤</mo></msubsup><mo lspace="0em" rspace="0em" id="S3.E1.m1.2.2.2.2.1.1.3.2.2.1" xref="S3.E1.m1.2.2.2.2.1.1.3.2.2.1.cmml">​</mo><mi id="S3.E1.m1.2.2.2.2.1.1.3.2.2.3" xref="S3.E1.m1.2.2.2.2.1.1.3.2.2.3.cmml">𝐡</mi></mrow><mo id="S3.E1.m1.2.2.2.2.1.1.3.2.1" xref="S3.E1.m1.2.2.2.2.1.1.3.2.1.cmml">⏟</mo></munder><mi mathcolor="#77FA00" id="S3.E1.m1.2.2.2.2.1.1.3.3" xref="S3.E1.m1.2.2.2.2.1.1.3.3.cmml">modulation</mi></munder></mrow><mo rspace="0.055em" stretchy="false" id="S3.E1.m1.2.2.2.2.1.3" xref="S3.E1.m1.2.2.2.3.cmml">)</mo></mrow></mrow><mo id="S3.E1.m1.2.2.3" xref="S3.E1.m1.2.2.3.cmml">⏞</mo></mover><mi mathcolor="#FD9D00" id="S3.E1.m1.4.4.1.1.3.2.2" xref="S3.E1.m1.4.4.1.1.3.2.2.cmml">filter</mi></mover><mo rspace="0.222em" id="S3.E1.m1.4.4.1.1.3.1" xref="S3.E1.m1.4.4.1.1.3.1.cmml">⊙</mo><mover id="S3.E1.m1.4.4.1.1.3.3" xref="S3.E1.m1.4.4.1.1.3.3.cmml"><mover accent="true" id="S3.E1.m1.3.3" xref="S3.E1.m1.3.3.cmml"><mrow id="S3.E1.m1.3.3.1" xref="S3.E1.m1.3.3.1.cmml"><mi id="S3.E1.m1.3.3.1.3" xref="S3.E1.m1.3.3.1.3.cmml">σ</mi><mo lspace="0em" rspace="0em" id="S3.E1.m1.3.3.1.2" xref="S3.E1.m1.3.3.1.2.cmml">​</mo><mrow id="S3.E1.m1.3.3.1.1.1" xref="S3.E1.m1.3.3.1.1.1.1.cmml"><mo stretchy="false" id="S3.E1.m1.3.3.1.1.1.2" xref="S3.E1.m1.3.3.1.1.1.1.cmml">(</mo><mrow id="S3.E1.m1.3.3.1.1.1.1" xref="S3.E1.m1.3.3.1.1.1.1.cmml"><mrow id="S3.E1.m1.3.3.1.1.1.1.2" xref="S3.E1.m1.3.3.1.1.1.1.2.cmml"><msubsup id="S3.E1.m1.3.3.1.1.1.1.2.2" xref="S3.E1.m1.3.3.1.1.1.1.2.2.cmml"><mi id="S3.E1.m1.3.3.1.1.1.1.2.2.2.2" xref="S3.E1.m1.3.3.1.1.1.1.2.2.2.2.cmml">𝐖</mi><mi id="S3.E1.m1.3.3.1.1.1.1.2.2.2.3" xref="S3.E1.m1.3.3.1.1.1.1.2.2.2.3.cmml">g</mi><mo id="S3.E1.m1.3.3.1.1.1.1.2.2.3" xref="S3.E1.m1.3.3.1.1.1.1.2.2.3.cmml">⊤</mo></msubsup><mo lspace="0em" rspace="0em" id="S3.E1.m1.3.3.1.1.1.1.2.1" xref="S3.E1.m1.3.3.1.1.1.1.2.1.cmml">​</mo><mi id="S3.E1.m1.3.3.1.1.1.1.2.3" xref="S3.E1.m1.3.3.1.1.1.1.2.3.cmml">𝐱</mi></mrow><mo id="S3.E1.m1.3.3.1.1.1.1.1" xref="S3.E1.m1.3.3.1.1.1.1.1.cmml">+</mo><munder id="S3.E1.m1.3.3.1.1.1.1.3" xref="S3.E1.m1.3.3.1.1.1.1.3.cmml"><munder accentunder="true" id="S3.E1.m1.3.3.1.1.1.1.3.2" xref="S3.E1.m1.3.3.1.1.1.1.3.2.cmml"><mrow id="S3.E1.m1.3.3.1.1.1.1.3.2.2" xref="S3.E1.m1.3.3.1.1.1.1.3.2.2.cmml"><msubsup id="S3.E1.m1.3.3.1.1.1.1.3.2.2.2" xref="S3.E1.m1.3.3.1.1.1.1.3.2.2.2.cmml"><mi id="S3.E1.m1.3.3.1.1.1.1.3.2.2.2.2.2" xref="S3.E1.m1.3.3.1.1.1.1.3.2.2.2.2.2.cmml">𝐕</mi><mi id="S3.E1.m1.3.3.1.1.1.1.3.2.2.2.2.3" xref="S3.E1.m1.3.3.1.1.1.1.3.2.2.2.2.3.cmml">g</mi><mo id="S3.E1.m1.3.3.1.1.1.1.3.2.2.2.3" xref="S3.E1.m1.3.3.1.1.1.1.3.2.2.2.3.cmml">⊤</mo></msubsup><mo lspace="0em" rspace="0em" id="S3.E1.m1.3.3.1.1.1.1.3.2.2.1" xref="S3.E1.m1.3.3.1.1.1.1.3.2.2.1.cmml">​</mo><mi id="S3.E1.m1.3.3.1.1.1.1.3.2.2.3" xref="S3.E1.m1.3.3.1.1.1.1.3.2.2.3.cmml">𝐡</mi></mrow><mo id="S3.E1.m1.3.3.1.1.1.1.3.2.1" xref="S3.E1.m1.3.3.1.1.1.1.3.2.1.cmml">⏟</mo></munder><mi mathcolor="#77FA00" id="S3.E1.m1.3.3.1.1.1.1.3.3" xref="S3.E1.m1.3.3.1.1.1.1.3.3.cmml">expression</mi></munder></mrow><mo stretchy="false" id="S3.E1.m1.3.3.1.1.1.3" xref="S3.E1.m1.3.3.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S3.E1.m1.3.3.2" xref="S3.E1.m1.3.3.2.cmml">⏞</mo></mover><mi mathcolor="#FD9D00" id="S3.E1.m1.4.4.1.1.3.3.2" xref="S3.E1.m1.4.4.1.1.3.3.2.cmml">gate</mi></mover></mrow></mrow><mo id="S3.E1.m1.4.4.1.2" xref="S3.E1.m1.4.4.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E1.m1.4b"><apply id="S3.E1.m1.4.4.1.1.cmml" xref="S3.E1.m1.4.4.1"><eq id="S3.E1.m1.4.4.1.1.1.cmml" xref="S3.E1.m1.4.4.1.1.1"></eq><ci id="S3.E1.m1.4.4.1.1.2.cmml" xref="S3.E1.m1.4.4.1.1.2">𝐳</ci><apply id="S3.E1.m1.4.4.1.1.3.cmml" xref="S3.E1.m1.4.4.1.1.3"><csymbol cd="latexml" id="S3.E1.m1.4.4.1.1.3.1.cmml" xref="S3.E1.m1.4.4.1.1.3.1">direct-product</csymbol><apply id="S3.E1.m1.4.4.1.1.3.2.cmml" xref="S3.E1.m1.4.4.1.1.3.2"><csymbol cd="ambiguous" id="S3.E1.m1.4.4.1.1.3.2.1.cmml" xref="S3.E1.m1.4.4.1.1.3.2">superscript</csymbol><apply id="S3.E1.m1.2.2.cmml" xref="S3.E1.m1.2.2"><ci id="S3.E1.m1.2.2.3.cmml" xref="S3.E1.m1.2.2.3">⏞</ci><apply id="S3.E1.m1.2.2.2.3.cmml" xref="S3.E1.m1.2.2.2.2"><tanh id="S3.E1.m1.1.1.1.1.cmml" xref="S3.E1.m1.1.1.1.1"></tanh><apply id="S3.E1.m1.2.2.2.2.1.1.cmml" xref="S3.E1.m1.2.2.2.2.1.1"><plus id="S3.E1.m1.2.2.2.2.1.1.1.cmml" xref="S3.E1.m1.2.2.2.2.1.1.1"></plus><apply id="S3.E1.m1.2.2.2.2.1.1.2.cmml" xref="S3.E1.m1.2.2.2.2.1.1.2"><times id="S3.E1.m1.2.2.2.2.1.1.2.1.cmml" xref="S3.E1.m1.2.2.2.2.1.1.2.1"></times><apply id="S3.E1.m1.2.2.2.2.1.1.2.2.cmml" xref="S3.E1.m1.2.2.2.2.1.1.2.2"><csymbol cd="ambiguous" id="S3.E1.m1.2.2.2.2.1.1.2.2.1.cmml" xref="S3.E1.m1.2.2.2.2.1.1.2.2">superscript</csymbol><apply id="S3.E1.m1.2.2.2.2.1.1.2.2.2.cmml" xref="S3.E1.m1.2.2.2.2.1.1.2.2"><csymbol cd="ambiguous" id="S3.E1.m1.2.2.2.2.1.1.2.2.2.1.cmml" xref="S3.E1.m1.2.2.2.2.1.1.2.2">subscript</csymbol><ci id="S3.E1.m1.2.2.2.2.1.1.2.2.2.2.cmml" xref="S3.E1.m1.2.2.2.2.1.1.2.2.2.2">𝐖</ci><ci id="S3.E1.m1.2.2.2.2.1.1.2.2.2.3.cmml" xref="S3.E1.m1.2.2.2.2.1.1.2.2.2.3">𝑓</ci></apply><csymbol cd="latexml" id="S3.E1.m1.2.2.2.2.1.1.2.2.3.cmml" xref="S3.E1.m1.2.2.2.2.1.1.2.2.3">top</csymbol></apply><ci id="S3.E1.m1.2.2.2.2.1.1.2.3.cmml" xref="S3.E1.m1.2.2.2.2.1.1.2.3">𝐱</ci></apply><apply id="S3.E1.m1.2.2.2.2.1.1.3.cmml" xref="S3.E1.m1.2.2.2.2.1.1.3"><csymbol cd="ambiguous" id="S3.E1.m1.2.2.2.2.1.1.3.1.cmml" xref="S3.E1.m1.2.2.2.2.1.1.3">subscript</csymbol><apply id="S3.E1.m1.2.2.2.2.1.1.3.2.cmml" xref="S3.E1.m1.2.2.2.2.1.1.3.2"><ci id="S3.E1.m1.2.2.2.2.1.1.3.2.1.cmml" xref="S3.E1.m1.2.2.2.2.1.1.3.2.1">⏟</ci><apply id="S3.E1.m1.2.2.2.2.1.1.3.2.2.cmml" xref="S3.E1.m1.2.2.2.2.1.1.3.2.2"><times id="S3.E1.m1.2.2.2.2.1.1.3.2.2.1.cmml" xref="S3.E1.m1.2.2.2.2.1.1.3.2.2.1"></times><apply id="S3.E1.m1.2.2.2.2.1.1.3.2.2.2.cmml" xref="S3.E1.m1.2.2.2.2.1.1.3.2.2.2"><csymbol cd="ambiguous" id="S3.E1.m1.2.2.2.2.1.1.3.2.2.2.1.cmml" xref="S3.E1.m1.2.2.2.2.1.1.3.2.2.2">superscript</csymbol><apply id="S3.E1.m1.2.2.2.2.1.1.3.2.2.2.2.cmml" xref="S3.E1.m1.2.2.2.2.1.1.3.2.2.2"><csymbol cd="ambiguous" id="S3.E1.m1.2.2.2.2.1.1.3.2.2.2.2.1.cmml" xref="S3.E1.m1.2.2.2.2.1.1.3.2.2.2">subscript</csymbol><ci id="S3.E1.m1.2.2.2.2.1.1.3.2.2.2.2.2.cmml" xref="S3.E1.m1.2.2.2.2.1.1.3.2.2.2.2.2">𝐕</ci><ci id="S3.E1.m1.2.2.2.2.1.1.3.2.2.2.2.3.cmml" xref="S3.E1.m1.2.2.2.2.1.1.3.2.2.2.2.3">𝑓</ci></apply><csymbol cd="latexml" id="S3.E1.m1.2.2.2.2.1.1.3.2.2.2.3.cmml" xref="S3.E1.m1.2.2.2.2.1.1.3.2.2.2.3">top</csymbol></apply><ci id="S3.E1.m1.2.2.2.2.1.1.3.2.2.3.cmml" xref="S3.E1.m1.2.2.2.2.1.1.3.2.2.3">𝐡</ci></apply></apply><ci id="S3.E1.m1.2.2.2.2.1.1.3.3.cmml" xref="S3.E1.m1.2.2.2.2.1.1.3.3">modulation</ci></apply></apply></apply></apply><ci id="S3.E1.m1.4.4.1.1.3.2.2.cmml" xref="S3.E1.m1.4.4.1.1.3.2.2">filter</ci></apply><apply id="S3.E1.m1.4.4.1.1.3.3.cmml" xref="S3.E1.m1.4.4.1.1.3.3"><csymbol cd="ambiguous" id="S3.E1.m1.4.4.1.1.3.3.1.cmml" xref="S3.E1.m1.4.4.1.1.3.3">superscript</csymbol><apply id="S3.E1.m1.3.3.cmml" xref="S3.E1.m1.3.3"><ci id="S3.E1.m1.3.3.2.cmml" xref="S3.E1.m1.3.3.2">⏞</ci><apply id="S3.E1.m1.3.3.1.cmml" xref="S3.E1.m1.3.3.1"><times id="S3.E1.m1.3.3.1.2.cmml" xref="S3.E1.m1.3.3.1.2"></times><ci id="S3.E1.m1.3.3.1.3.cmml" xref="S3.E1.m1.3.3.1.3">𝜎</ci><apply id="S3.E1.m1.3.3.1.1.1.1.cmml" xref="S3.E1.m1.3.3.1.1.1"><plus id="S3.E1.m1.3.3.1.1.1.1.1.cmml" xref="S3.E1.m1.3.3.1.1.1.1.1"></plus><apply id="S3.E1.m1.3.3.1.1.1.1.2.cmml" xref="S3.E1.m1.3.3.1.1.1.1.2"><times id="S3.E1.m1.3.3.1.1.1.1.2.1.cmml" xref="S3.E1.m1.3.3.1.1.1.1.2.1"></times><apply id="S3.E1.m1.3.3.1.1.1.1.2.2.cmml" xref="S3.E1.m1.3.3.1.1.1.1.2.2"><csymbol cd="ambiguous" id="S3.E1.m1.3.3.1.1.1.1.2.2.1.cmml" xref="S3.E1.m1.3.3.1.1.1.1.2.2">superscript</csymbol><apply id="S3.E1.m1.3.3.1.1.1.1.2.2.2.cmml" xref="S3.E1.m1.3.3.1.1.1.1.2.2"><csymbol cd="ambiguous" id="S3.E1.m1.3.3.1.1.1.1.2.2.2.1.cmml" xref="S3.E1.m1.3.3.1.1.1.1.2.2">subscript</csymbol><ci id="S3.E1.m1.3.3.1.1.1.1.2.2.2.2.cmml" xref="S3.E1.m1.3.3.1.1.1.1.2.2.2.2">𝐖</ci><ci id="S3.E1.m1.3.3.1.1.1.1.2.2.2.3.cmml" xref="S3.E1.m1.3.3.1.1.1.1.2.2.2.3">𝑔</ci></apply><csymbol cd="latexml" id="S3.E1.m1.3.3.1.1.1.1.2.2.3.cmml" xref="S3.E1.m1.3.3.1.1.1.1.2.2.3">top</csymbol></apply><ci id="S3.E1.m1.3.3.1.1.1.1.2.3.cmml" xref="S3.E1.m1.3.3.1.1.1.1.2.3">𝐱</ci></apply><apply id="S3.E1.m1.3.3.1.1.1.1.3.cmml" xref="S3.E1.m1.3.3.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.E1.m1.3.3.1.1.1.1.3.1.cmml" xref="S3.E1.m1.3.3.1.1.1.1.3">subscript</csymbol><apply id="S3.E1.m1.3.3.1.1.1.1.3.2.cmml" xref="S3.E1.m1.3.3.1.1.1.1.3.2"><ci id="S3.E1.m1.3.3.1.1.1.1.3.2.1.cmml" xref="S3.E1.m1.3.3.1.1.1.1.3.2.1">⏟</ci><apply id="S3.E1.m1.3.3.1.1.1.1.3.2.2.cmml" xref="S3.E1.m1.3.3.1.1.1.1.3.2.2"><times id="S3.E1.m1.3.3.1.1.1.1.3.2.2.1.cmml" xref="S3.E1.m1.3.3.1.1.1.1.3.2.2.1"></times><apply id="S3.E1.m1.3.3.1.1.1.1.3.2.2.2.cmml" xref="S3.E1.m1.3.3.1.1.1.1.3.2.2.2"><csymbol cd="ambiguous" id="S3.E1.m1.3.3.1.1.1.1.3.2.2.2.1.cmml" xref="S3.E1.m1.3.3.1.1.1.1.3.2.2.2">superscript</csymbol><apply id="S3.E1.m1.3.3.1.1.1.1.3.2.2.2.2.cmml" xref="S3.E1.m1.3.3.1.1.1.1.3.2.2.2"><csymbol cd="ambiguous" id="S3.E1.m1.3.3.1.1.1.1.3.2.2.2.2.1.cmml" xref="S3.E1.m1.3.3.1.1.1.1.3.2.2.2">subscript</csymbol><ci id="S3.E1.m1.3.3.1.1.1.1.3.2.2.2.2.2.cmml" xref="S3.E1.m1.3.3.1.1.1.1.3.2.2.2.2.2">𝐕</ci><ci id="S3.E1.m1.3.3.1.1.1.1.3.2.2.2.2.3.cmml" xref="S3.E1.m1.3.3.1.1.1.1.3.2.2.2.2.3">𝑔</ci></apply><csymbol cd="latexml" id="S3.E1.m1.3.3.1.1.1.1.3.2.2.2.3.cmml" xref="S3.E1.m1.3.3.1.1.1.1.3.2.2.2.3">top</csymbol></apply><ci id="S3.E1.m1.3.3.1.1.1.1.3.2.2.3.cmml" xref="S3.E1.m1.3.3.1.1.1.1.3.2.2.3">𝐡</ci></apply></apply><ci id="S3.E1.m1.3.3.1.1.1.1.3.3.cmml" xref="S3.E1.m1.3.3.1.1.1.1.3.3">expression</ci></apply></apply></apply></apply><ci id="S3.E1.m1.4.4.1.1.3.3.2.cmml" xref="S3.E1.m1.4.4.1.1.3.3.2">gate</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E1.m1.4c">\mathbf{z}=\overbrace{\tanh(\mathbf{W}_{f}^{\top}\mathbf{x}+\underbrace{\mathbf{V}_{f}^{\top}\mathbf{h}}_{\mathrm{\color[rgb]{0.46484375,0.98046875,0}modulation}})}^{\mathrm{\color[rgb]{0.9921875,0.6171875,0}filter}}\odot\overbrace{\sigma(\mathbf{W}_{g}^{\top}\mathbf{x}+\underbrace{\mathbf{V}_{g}^{\top}\mathbf{h}}_{\mathrm{\color[rgb]{0.46484375,0.98046875,0}expression}})}^{\mathrm{\color[rgb]{0.9921875,0.6171875,0}gate}},</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(1)</span></td>
</tr></tbody>
</table>
<p id="S3.SS2.p4.9" class="ltx_p">where <math id="S3.SS2.p4.2.m1.1" class="ltx_Math" alttext="\mathbf{x}" display="inline"><semantics id="S3.SS2.p4.2.m1.1a"><mi id="S3.SS2.p4.2.m1.1.1" xref="S3.SS2.p4.2.m1.1.1.cmml">𝐱</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p4.2.m1.1b"><ci id="S3.SS2.p4.2.m1.1.1.cmml" xref="S3.SS2.p4.2.m1.1.1">𝐱</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p4.2.m1.1c">\mathbf{x}</annotation></semantics></math> are and <math id="S3.SS2.p4.3.m2.1" class="ltx_Math" alttext="\mathbf{z}" display="inline"><semantics id="S3.SS2.p4.3.m2.1a"><mi id="S3.SS2.p4.3.m2.1.1" xref="S3.SS2.p4.3.m2.1.1.cmml">𝐳</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p4.3.m2.1b"><ci id="S3.SS2.p4.3.m2.1.1.cmml" xref="S3.SS2.p4.3.m2.1.1">𝐳</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p4.3.m2.1c">\mathbf{z}</annotation></semantics></math> are the input to and output of a layer in the classifier (biases omitted, <math id="S3.SS2.p4.4.m3.1" class="ltx_Math" alttext="\odot" display="inline"><semantics id="S3.SS2.p4.4.m3.1a"><mo id="S3.SS2.p4.4.m3.1.1" xref="S3.SS2.p4.4.m3.1.1.cmml">⊙</mo><annotation-xml encoding="MathML-Content" id="S3.SS2.p4.4.m3.1b"><csymbol cd="latexml" id="S3.SS2.p4.4.m3.1.1.cmml" xref="S3.SS2.p4.4.m3.1.1">direct-product</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p4.4.m3.1c">\odot</annotation></semantics></math> is the Hadamard product, and <math id="S3.SS2.p4.5.m4.1" class="ltx_Math" alttext="\tanh" display="inline"><semantics id="S3.SS2.p4.5.m4.1a"><mi id="S3.SS2.p4.5.m4.1.1" xref="S3.SS2.p4.5.m4.1.1.cmml">tanh</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p4.5.m4.1b"><tanh id="S3.SS2.p4.5.m4.1.1.cmml" xref="S3.SS2.p4.5.m4.1.1"></tanh></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p4.5.m4.1c">\tanh</annotation></semantics></math> and <math id="S3.SS2.p4.6.m5.1" class="ltx_Math" alttext="\sigma" display="inline"><semantics id="S3.SS2.p4.6.m5.1a"><mi id="S3.SS2.p4.6.m5.1.1" xref="S3.SS2.p4.6.m5.1.1.cmml">σ</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p4.6.m5.1b"><ci id="S3.SS2.p4.6.m5.1.1.cmml" xref="S3.SS2.p4.6.m5.1.1">𝜎</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p4.6.m5.1c">\sigma</annotation></semantics></math> are the hyperbolic tangent and sigmoidal activation functions).
In the simulated setup, the conditioning is a one-hot encoding of clients IDs, captured as <math id="S3.SS2.p4.7.m6.1" class="ltx_Math" alttext="\mathbf{h}\in\mathbb{R}^{K}" display="inline"><semantics id="S3.SS2.p4.7.m6.1a"><mrow id="S3.SS2.p4.7.m6.1.1" xref="S3.SS2.p4.7.m6.1.1.cmml"><mi id="S3.SS2.p4.7.m6.1.1.2" xref="S3.SS2.p4.7.m6.1.1.2.cmml">𝐡</mi><mo id="S3.SS2.p4.7.m6.1.1.1" xref="S3.SS2.p4.7.m6.1.1.1.cmml">∈</mo><msup id="S3.SS2.p4.7.m6.1.1.3" xref="S3.SS2.p4.7.m6.1.1.3.cmml"><mi id="S3.SS2.p4.7.m6.1.1.3.2" xref="S3.SS2.p4.7.m6.1.1.3.2.cmml">ℝ</mi><mi id="S3.SS2.p4.7.m6.1.1.3.3" xref="S3.SS2.p4.7.m6.1.1.3.3.cmml">K</mi></msup></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p4.7.m6.1b"><apply id="S3.SS2.p4.7.m6.1.1.cmml" xref="S3.SS2.p4.7.m6.1.1"><in id="S3.SS2.p4.7.m6.1.1.1.cmml" xref="S3.SS2.p4.7.m6.1.1.1"></in><ci id="S3.SS2.p4.7.m6.1.1.2.cmml" xref="S3.SS2.p4.7.m6.1.1.2">𝐡</ci><apply id="S3.SS2.p4.7.m6.1.1.3.cmml" xref="S3.SS2.p4.7.m6.1.1.3"><csymbol cd="ambiguous" id="S3.SS2.p4.7.m6.1.1.3.1.cmml" xref="S3.SS2.p4.7.m6.1.1.3">superscript</csymbol><ci id="S3.SS2.p4.7.m6.1.1.3.2.cmml" xref="S3.SS2.p4.7.m6.1.1.3.2">ℝ</ci><ci id="S3.SS2.p4.7.m6.1.1.3.3.cmml" xref="S3.SS2.p4.7.m6.1.1.3.3">𝐾</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p4.7.m6.1c">\mathbf{h}\in\mathbb{R}^{K}</annotation></semantics></math>.
Importantly, in a real federated learning setting, we do not need to share the learnt client conditioning; for a particular client, the one-hot encoding, in essence, selects the dimension of the matrices <math id="S3.SS2.p4.8.m7.1" class="ltx_Math" alttext="\mathbf{V_{f}}" display="inline"><semantics id="S3.SS2.p4.8.m7.1a"><msub id="S3.SS2.p4.8.m7.1.1" xref="S3.SS2.p4.8.m7.1.1.cmml"><mi id="S3.SS2.p4.8.m7.1.1.2" xref="S3.SS2.p4.8.m7.1.1.2.cmml">𝐕</mi><mi id="S3.SS2.p4.8.m7.1.1.3" xref="S3.SS2.p4.8.m7.1.1.3.cmml">𝐟</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.p4.8.m7.1b"><apply id="S3.SS2.p4.8.m7.1.1.cmml" xref="S3.SS2.p4.8.m7.1.1"><csymbol cd="ambiguous" id="S3.SS2.p4.8.m7.1.1.1.cmml" xref="S3.SS2.p4.8.m7.1.1">subscript</csymbol><ci id="S3.SS2.p4.8.m7.1.1.2.cmml" xref="S3.SS2.p4.8.m7.1.1.2">𝐕</ci><ci id="S3.SS2.p4.8.m7.1.1.3.cmml" xref="S3.SS2.p4.8.m7.1.1.3">𝐟</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p4.8.m7.1c">\mathbf{V_{f}}</annotation></semantics></math> and <math id="S3.SS2.p4.9.m8.1" class="ltx_Math" alttext="\mathbf{V_{g}}" display="inline"><semantics id="S3.SS2.p4.9.m8.1a"><msub id="S3.SS2.p4.9.m8.1.1" xref="S3.SS2.p4.9.m8.1.1.cmml"><mi id="S3.SS2.p4.9.m8.1.1.2" xref="S3.SS2.p4.9.m8.1.1.2.cmml">𝐕</mi><mi id="S3.SS2.p4.9.m8.1.1.3" xref="S3.SS2.p4.9.m8.1.1.3.cmml">𝐠</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.p4.9.m8.1b"><apply id="S3.SS2.p4.9.m8.1.1.cmml" xref="S3.SS2.p4.9.m8.1.1"><csymbol cd="ambiguous" id="S3.SS2.p4.9.m8.1.1.1.cmml" xref="S3.SS2.p4.9.m8.1.1">subscript</csymbol><ci id="S3.SS2.p4.9.m8.1.1.2.cmml" xref="S3.SS2.p4.9.m8.1.1.2">𝐕</ci><ci id="S3.SS2.p4.9.m8.1.1.3.cmml" xref="S3.SS2.p4.9.m8.1.1.3">𝐠</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p4.9.m8.1c">\mathbf{V_{g}}</annotation></semantics></math> that pertains to the client. This conditioning can simply be maintained locally and can be thought of as an additional local, learnable translation of the filtering and gating responses.</p>
</div>
<figure id="S3.F1" class="ltx_figure"><img src="/html/2007.04806/assets/figures/conditioned_gated_activation_unit.png" id="S3.F1.g1" class="ltx_graphics ltx_centering ltx_img_square" width="210" height="190" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span id="S3.F1.8.4.1" class="ltx_text" style="font-size:90%;">Figure 1</span>: </span><span id="S3.F1.6.3" class="ltx_text" style="font-size:90%;">A gated activation unit with conditioning. Input features, <math id="S3.F1.4.1.m1.1" class="ltx_Math" alttext="\mathbf{x}" display="inline"><semantics id="S3.F1.4.1.m1.1b"><mi id="S3.F1.4.1.m1.1.1" xref="S3.F1.4.1.m1.1.1.cmml">𝐱</mi><annotation-xml encoding="MathML-Content" id="S3.F1.4.1.m1.1c"><ci id="S3.F1.4.1.m1.1.1.cmml" xref="S3.F1.4.1.m1.1.1">𝐱</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.F1.4.1.m1.1d">\mathbf{x}</annotation></semantics></math>, are processed by a gated activation unit (orange), and the resulting filtering and gating outputs are conditioned (green) based on client one-hot encoding, <math id="S3.F1.5.2.m2.1" class="ltx_Math" alttext="\mathbf{h}" display="inline"><semantics id="S3.F1.5.2.m2.1b"><mi id="S3.F1.5.2.m2.1.1" xref="S3.F1.5.2.m2.1.1.cmml">𝐡</mi><annotation-xml encoding="MathML-Content" id="S3.F1.5.2.m2.1c"><ci id="S3.F1.5.2.m2.1.1.cmml" xref="S3.F1.5.2.m2.1.1">𝐡</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.F1.5.2.m2.1d">\mathbf{h}</annotation></semantics></math>, resulting in the output, <math id="S3.F1.6.3.m3.1" class="ltx_Math" alttext="\mathbf{z}" display="inline"><semantics id="S3.F1.6.3.m3.1b"><mi id="S3.F1.6.3.m3.1.1" xref="S3.F1.6.3.m3.1.1.cmml">𝐳</mi><annotation-xml encoding="MathML-Content" id="S3.F1.6.3.m3.1c"><ci id="S3.F1.6.3.m3.1.1.cmml" xref="S3.F1.6.3.m3.1.1">𝐳</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.F1.6.3.m3.1d">\mathbf{z}</annotation></semantics></math>. Blue indicates matrix multiplications with learnable weights, yellow are activation functions, and red are element-wise binary operators.</span></figcaption>
</figure>
<div id="S3.SS2.p5" class="ltx_para">
<p id="S3.SS2.p5.1" class="ltx_p">Gated activation units with conditioning in this format have been used both in the WaveNet and PixelCNN architecture <cite class="ltx_cite ltx_citemacro_citep">(Oord et al., <a href="#bib.bib18" title="" class="ltx_ref">2016</a>; Van den Oord et al., <a href="#bib.bib23" title="" class="ltx_ref">2016</a>)</cite> in a convolutional form, and are based on previous work on gated activation units in e.g. highway networks <cite class="ltx_cite ltx_citemacro_citep">(Srivastava et al., <a href="#bib.bib21" title="" class="ltx_ref">2015</a>)</cite> and long short-term memory cells <cite class="ltx_cite ltx_citemacro_citep">(Hochreiter &amp; Schmidhuber, <a href="#bib.bib8" title="" class="ltx_ref">1997</a>)</cite>.</p>
</div>
</section>
<section id="S3.SS3" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.3 </span>Simulating clients with non-IID features</h3>

<div id="S3.SS3.p1" class="ltx_para">
<p id="S3.SS3.p1.1" class="ltx_p">While non-IID clients, both in terms of their label distribution and feature distributions, are inevitable in realistic federated learning, most data sets that are commonly investigated in deep learning do not have any inherent client identification for the samples of the data set.
One approach to simulate a more realistic scenario in lieu of actual clients is to assign only a subset of all labels to any given client in a set of simulated clients.
This approach mimics a scenario in which the label distributions are non-IID across clients (as in e.g. <cite class="ltx_cite ltx_citemacro_citep">(Zhao et al., <a href="#bib.bib25" title="" class="ltx_ref">2018</a>)</cite>).</p>
</div>
<div id="S3.SS3.p2" class="ltx_para">
<p id="S3.SS3.p2.1" class="ltx_p">However, in realistic settings, we might encounter that clients express a particular class differently, which can also be thought of as having features that are (even class conditionally) non-IID.
In order to simulate such non-IID client feature distributions, we investigate simulated clients where the samples of a particular class are clustered based on the feature embedding from a pre-trained network.</p>
</div>
<div id="S3.SS3.p3" class="ltx_para">
<p id="S3.SS3.p3.7" class="ltx_p">We simulate clients by splitting the data, <math id="S3.SS3.p3.1.m1.1" class="ltx_Math" alttext="\mathcal{D}" display="inline"><semantics id="S3.SS3.p3.1.m1.1a"><mi class="ltx_font_mathcaligraphic" id="S3.SS3.p3.1.m1.1.1" xref="S3.SS3.p3.1.m1.1.1.cmml">𝒟</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.p3.1.m1.1b"><ci id="S3.SS3.p3.1.m1.1.1.cmml" xref="S3.SS3.p3.1.m1.1.1">𝒟</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p3.1.m1.1c">\mathcal{D}</annotation></semantics></math>, in <math id="S3.SS3.p3.2.m2.1" class="ltx_Math" alttext="K" display="inline"><semantics id="S3.SS3.p3.2.m2.1a"><mi id="S3.SS3.p3.2.m2.1.1" xref="S3.SS3.p3.2.m2.1.1.cmml">K</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.p3.2.m2.1b"><ci id="S3.SS3.p3.2.m2.1.1.cmml" xref="S3.SS3.p3.2.m2.1.1">𝐾</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p3.2.m2.1c">K</annotation></semantics></math> nodes, <math id="S3.SS3.p3.3.m3.3" class="ltx_Math" alttext="\mathcal{K}=\{1,\ldots,K\}" display="inline"><semantics id="S3.SS3.p3.3.m3.3a"><mrow id="S3.SS3.p3.3.m3.3.4" xref="S3.SS3.p3.3.m3.3.4.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS3.p3.3.m3.3.4.2" xref="S3.SS3.p3.3.m3.3.4.2.cmml">𝒦</mi><mo id="S3.SS3.p3.3.m3.3.4.1" xref="S3.SS3.p3.3.m3.3.4.1.cmml">=</mo><mrow id="S3.SS3.p3.3.m3.3.4.3.2" xref="S3.SS3.p3.3.m3.3.4.3.1.cmml"><mo stretchy="false" id="S3.SS3.p3.3.m3.3.4.3.2.1" xref="S3.SS3.p3.3.m3.3.4.3.1.cmml">{</mo><mn id="S3.SS3.p3.3.m3.1.1" xref="S3.SS3.p3.3.m3.1.1.cmml">1</mn><mo id="S3.SS3.p3.3.m3.3.4.3.2.2" xref="S3.SS3.p3.3.m3.3.4.3.1.cmml">,</mo><mi mathvariant="normal" id="S3.SS3.p3.3.m3.2.2" xref="S3.SS3.p3.3.m3.2.2.cmml">…</mi><mo id="S3.SS3.p3.3.m3.3.4.3.2.3" xref="S3.SS3.p3.3.m3.3.4.3.1.cmml">,</mo><mi id="S3.SS3.p3.3.m3.3.3" xref="S3.SS3.p3.3.m3.3.3.cmml">K</mi><mo stretchy="false" id="S3.SS3.p3.3.m3.3.4.3.2.4" xref="S3.SS3.p3.3.m3.3.4.3.1.cmml">}</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.p3.3.m3.3b"><apply id="S3.SS3.p3.3.m3.3.4.cmml" xref="S3.SS3.p3.3.m3.3.4"><eq id="S3.SS3.p3.3.m3.3.4.1.cmml" xref="S3.SS3.p3.3.m3.3.4.1"></eq><ci id="S3.SS3.p3.3.m3.3.4.2.cmml" xref="S3.SS3.p3.3.m3.3.4.2">𝒦</ci><set id="S3.SS3.p3.3.m3.3.4.3.1.cmml" xref="S3.SS3.p3.3.m3.3.4.3.2"><cn type="integer" id="S3.SS3.p3.3.m3.1.1.cmml" xref="S3.SS3.p3.3.m3.1.1">1</cn><ci id="S3.SS3.p3.3.m3.2.2.cmml" xref="S3.SS3.p3.3.m3.2.2">…</ci><ci id="S3.SS3.p3.3.m3.3.3.cmml" xref="S3.SS3.p3.3.m3.3.3">𝐾</ci></set></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p3.3.m3.3c">\mathcal{K}=\{1,\ldots,K\}</annotation></semantics></math>.
Each node <math id="S3.SS3.p3.4.m4.1" class="ltx_Math" alttext="k" display="inline"><semantics id="S3.SS3.p3.4.m4.1a"><mi id="S3.SS3.p3.4.m4.1.1" xref="S3.SS3.p3.4.m4.1.1.cmml">k</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.p3.4.m4.1b"><ci id="S3.SS3.p3.4.m4.1.1.cmml" xref="S3.SS3.p3.4.m4.1.1">𝑘</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p3.4.m4.1c">k</annotation></semantics></math> has a disjoint data set <math id="S3.SS3.p3.5.m5.1" class="ltx_Math" alttext="\mathcal{D}_{k}\subset\mathcal{D}" display="inline"><semantics id="S3.SS3.p3.5.m5.1a"><mrow id="S3.SS3.p3.5.m5.1.1" xref="S3.SS3.p3.5.m5.1.1.cmml"><msub id="S3.SS3.p3.5.m5.1.1.2" xref="S3.SS3.p3.5.m5.1.1.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS3.p3.5.m5.1.1.2.2" xref="S3.SS3.p3.5.m5.1.1.2.2.cmml">𝒟</mi><mi id="S3.SS3.p3.5.m5.1.1.2.3" xref="S3.SS3.p3.5.m5.1.1.2.3.cmml">k</mi></msub><mo id="S3.SS3.p3.5.m5.1.1.1" xref="S3.SS3.p3.5.m5.1.1.1.cmml">⊂</mo><mi class="ltx_font_mathcaligraphic" id="S3.SS3.p3.5.m5.1.1.3" xref="S3.SS3.p3.5.m5.1.1.3.cmml">𝒟</mi></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.p3.5.m5.1b"><apply id="S3.SS3.p3.5.m5.1.1.cmml" xref="S3.SS3.p3.5.m5.1.1"><subset id="S3.SS3.p3.5.m5.1.1.1.cmml" xref="S3.SS3.p3.5.m5.1.1.1"></subset><apply id="S3.SS3.p3.5.m5.1.1.2.cmml" xref="S3.SS3.p3.5.m5.1.1.2"><csymbol cd="ambiguous" id="S3.SS3.p3.5.m5.1.1.2.1.cmml" xref="S3.SS3.p3.5.m5.1.1.2">subscript</csymbol><ci id="S3.SS3.p3.5.m5.1.1.2.2.cmml" xref="S3.SS3.p3.5.m5.1.1.2.2">𝒟</ci><ci id="S3.SS3.p3.5.m5.1.1.2.3.cmml" xref="S3.SS3.p3.5.m5.1.1.2.3">𝑘</ci></apply><ci id="S3.SS3.p3.5.m5.1.1.3.cmml" xref="S3.SS3.p3.5.m5.1.1.3">𝒟</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p3.5.m5.1c">\mathcal{D}_{k}\subset\mathcal{D}</annotation></semantics></math> available for federated training, such that
<math id="S3.SS3.p3.6.m6.1" class="ltx_Math" alttext="\bigcup\limits_{k=1}^{K}\mathcal{D}_{k}=\mathcal{D}" display="inline"><semantics id="S3.SS3.p3.6.m6.1a"><mrow id="S3.SS3.p3.6.m6.1.1" xref="S3.SS3.p3.6.m6.1.1.cmml"><mrow id="S3.SS3.p3.6.m6.1.1.2" xref="S3.SS3.p3.6.m6.1.1.2.cmml"><munderover id="S3.SS3.p3.6.m6.1.1.2.1" xref="S3.SS3.p3.6.m6.1.1.2.1.cmml"><mo movablelimits="false" id="S3.SS3.p3.6.m6.1.1.2.1.2.2" xref="S3.SS3.p3.6.m6.1.1.2.1.2.2.cmml">⋃</mo><mrow id="S3.SS3.p3.6.m6.1.1.2.1.2.3" xref="S3.SS3.p3.6.m6.1.1.2.1.2.3.cmml"><mi id="S3.SS3.p3.6.m6.1.1.2.1.2.3.2" xref="S3.SS3.p3.6.m6.1.1.2.1.2.3.2.cmml">k</mi><mo id="S3.SS3.p3.6.m6.1.1.2.1.2.3.1" xref="S3.SS3.p3.6.m6.1.1.2.1.2.3.1.cmml">=</mo><mn id="S3.SS3.p3.6.m6.1.1.2.1.2.3.3" xref="S3.SS3.p3.6.m6.1.1.2.1.2.3.3.cmml">1</mn></mrow><mi id="S3.SS3.p3.6.m6.1.1.2.1.3" xref="S3.SS3.p3.6.m6.1.1.2.1.3.cmml">K</mi></munderover><msub id="S3.SS3.p3.6.m6.1.1.2.2" xref="S3.SS3.p3.6.m6.1.1.2.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS3.p3.6.m6.1.1.2.2.2" xref="S3.SS3.p3.6.m6.1.1.2.2.2.cmml">𝒟</mi><mi id="S3.SS3.p3.6.m6.1.1.2.2.3" xref="S3.SS3.p3.6.m6.1.1.2.2.3.cmml">k</mi></msub></mrow><mo id="S3.SS3.p3.6.m6.1.1.1" xref="S3.SS3.p3.6.m6.1.1.1.cmml">=</mo><mi class="ltx_font_mathcaligraphic" id="S3.SS3.p3.6.m6.1.1.3" xref="S3.SS3.p3.6.m6.1.1.3.cmml">𝒟</mi></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.p3.6.m6.1b"><apply id="S3.SS3.p3.6.m6.1.1.cmml" xref="S3.SS3.p3.6.m6.1.1"><eq id="S3.SS3.p3.6.m6.1.1.1.cmml" xref="S3.SS3.p3.6.m6.1.1.1"></eq><apply id="S3.SS3.p3.6.m6.1.1.2.cmml" xref="S3.SS3.p3.6.m6.1.1.2"><apply id="S3.SS3.p3.6.m6.1.1.2.1.cmml" xref="S3.SS3.p3.6.m6.1.1.2.1"><csymbol cd="ambiguous" id="S3.SS3.p3.6.m6.1.1.2.1.1.cmml" xref="S3.SS3.p3.6.m6.1.1.2.1">superscript</csymbol><apply id="S3.SS3.p3.6.m6.1.1.2.1.2.cmml" xref="S3.SS3.p3.6.m6.1.1.2.1"><csymbol cd="ambiguous" id="S3.SS3.p3.6.m6.1.1.2.1.2.1.cmml" xref="S3.SS3.p3.6.m6.1.1.2.1">subscript</csymbol><union id="S3.SS3.p3.6.m6.1.1.2.1.2.2.cmml" xref="S3.SS3.p3.6.m6.1.1.2.1.2.2"></union><apply id="S3.SS3.p3.6.m6.1.1.2.1.2.3.cmml" xref="S3.SS3.p3.6.m6.1.1.2.1.2.3"><eq id="S3.SS3.p3.6.m6.1.1.2.1.2.3.1.cmml" xref="S3.SS3.p3.6.m6.1.1.2.1.2.3.1"></eq><ci id="S3.SS3.p3.6.m6.1.1.2.1.2.3.2.cmml" xref="S3.SS3.p3.6.m6.1.1.2.1.2.3.2">𝑘</ci><cn type="integer" id="S3.SS3.p3.6.m6.1.1.2.1.2.3.3.cmml" xref="S3.SS3.p3.6.m6.1.1.2.1.2.3.3">1</cn></apply></apply><ci id="S3.SS3.p3.6.m6.1.1.2.1.3.cmml" xref="S3.SS3.p3.6.m6.1.1.2.1.3">𝐾</ci></apply><apply id="S3.SS3.p3.6.m6.1.1.2.2.cmml" xref="S3.SS3.p3.6.m6.1.1.2.2"><csymbol cd="ambiguous" id="S3.SS3.p3.6.m6.1.1.2.2.1.cmml" xref="S3.SS3.p3.6.m6.1.1.2.2">subscript</csymbol><ci id="S3.SS3.p3.6.m6.1.1.2.2.2.cmml" xref="S3.SS3.p3.6.m6.1.1.2.2.2">𝒟</ci><ci id="S3.SS3.p3.6.m6.1.1.2.2.3.cmml" xref="S3.SS3.p3.6.m6.1.1.2.2.3">𝑘</ci></apply></apply><ci id="S3.SS3.p3.6.m6.1.1.3.cmml" xref="S3.SS3.p3.6.m6.1.1.3">𝒟</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p3.6.m6.1c">\bigcup\limits_{k=1}^{K}\mathcal{D}_{k}=\mathcal{D}</annotation></semantics></math>.
For a given data set with <math id="S3.SS3.p3.7.m7.1" class="ltx_Math" alttext="C" display="inline"><semantics id="S3.SS3.p3.7.m7.1a"><mi id="S3.SS3.p3.7.m7.1.1" xref="S3.SS3.p3.7.m7.1.1.cmml">C</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.p3.7.m7.1b"><ci id="S3.SS3.p3.7.m7.1.1.cmml" xref="S3.SS3.p3.7.m7.1.1">𝐶</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p3.7.m7.1c">C</annotation></semantics></math> classes, we partition the data in training and test data, and embed the available data using a pre-trained network (cf. <a href="#S3.SS1" title="3.1 Federated learning with pre-trained networks ‣ 3 Methods ‣ Client Adaptation improves Federated Learning with Simulated Non-IID Clients" class="ltx_ref"><span class="ltx_text ltx_ref_tag">Section</span> <span class="ltx_text ltx_ref_tag">3.1</span></a>).
We then learn a dimensionality reduction on the training partition of the embedded data through principal component analysis.
For simplicity, we use the first two principal components of the training data and project all the available data onto these.</p>
</div>
<div id="S3.SS3.p4" class="ltx_para">
<p id="S3.SS3.p4.5" class="ltx_p">For each class, we then cluster the training data using a <math id="S3.SS3.p4.1.m1.1" class="ltx_Math" alttext="K" display="inline"><semantics id="S3.SS3.p4.1.m1.1a"><mi id="S3.SS3.p4.1.m1.1.1" xref="S3.SS3.p4.1.m1.1.1.cmml">K</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.p4.1.m1.1b"><ci id="S3.SS3.p4.1.m1.1.1.cmml" xref="S3.SS3.p4.1.m1.1.1">𝐾</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p4.1.m1.1c">K</annotation></semantics></math>-means clustering, thereby obtaining a set of <math id="S3.SS3.p4.2.m2.1" class="ltx_Math" alttext="C" display="inline"><semantics id="S3.SS3.p4.2.m2.1a"><mi id="S3.SS3.p4.2.m2.1.1" xref="S3.SS3.p4.2.m2.1.1.cmml">C</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.p4.2.m2.1b"><ci id="S3.SS3.p4.2.m2.1.1.cmml" xref="S3.SS3.p4.2.m2.1.1">𝐶</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p4.2.m2.1c">C</annotation></semantics></math> times <math id="S3.SS3.p4.3.m3.1" class="ltx_Math" alttext="K" display="inline"><semantics id="S3.SS3.p4.3.m3.1a"><mi id="S3.SS3.p4.3.m3.1.1" xref="S3.SS3.p4.3.m3.1.1.cmml">K</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.p4.3.m3.1b"><ci id="S3.SS3.p4.3.m3.1.1.cmml" xref="S3.SS3.p4.3.m3.1.1">𝐾</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p4.3.m3.1c">K</annotation></semantics></math> cluster centroids.
Each of the <math id="S3.SS3.p4.4.m4.1" class="ltx_Math" alttext="K" display="inline"><semantics id="S3.SS3.p4.4.m4.1a"><mi id="S3.SS3.p4.4.m4.1.1" xref="S3.SS3.p4.4.m4.1.1.cmml">K</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.p4.4.m4.1b"><ci id="S3.SS3.p4.4.m4.1.1.cmml" xref="S3.SS3.p4.4.m4.1.1">𝐾</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p4.4.m4.1c">K</annotation></semantics></math> clients are then assigned a set of centroids such that samples that are the closest to one of a client’s <math id="S3.SS3.p4.5.m5.1" class="ltx_Math" alttext="C" display="inline"><semantics id="S3.SS3.p4.5.m5.1a"><mi id="S3.SS3.p4.5.m5.1.1" xref="S3.SS3.p4.5.m5.1.1.cmml">C</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.p4.5.m5.1b"><ci id="S3.SS3.p4.5.m5.1.1.cmml" xref="S3.SS3.p4.5.m5.1.1">𝐶</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p4.5.m5.1c">C</annotation></semantics></math> centroids belongs to that client.
In this manner, we obtain data distributions in the embedding space that are locally clustered and distinct in each client.</p>
</div>
</section>
<section id="S3.SS4" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.4 </span>Quantifying heterogeneity of client feature distributions</h3>

<div id="S3.SS4.p1" class="ltx_para">
<p id="S3.SS4.p1.11" class="ltx_p">We are interested in understanding how non-IID data distributions (beyond class distributions) affects federated learning.
We consider data from <math id="S3.SS4.p1.1.m1.1" class="ltx_Math" alttext="K" display="inline"><semantics id="S3.SS4.p1.1.m1.1a"><mi id="S3.SS4.p1.1.m1.1.1" xref="S3.SS4.p1.1.m1.1.1.cmml">K</mi><annotation-xml encoding="MathML-Content" id="S3.SS4.p1.1.m1.1b"><ci id="S3.SS4.p1.1.m1.1.1.cmml" xref="S3.SS4.p1.1.m1.1.1">𝐾</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p1.1.m1.1c">K</annotation></semantics></math> clients, where the <math id="S3.SS4.p1.2.m2.1" class="ltx_Math" alttext="k" display="inline"><semantics id="S3.SS4.p1.2.m2.1a"><mi id="S3.SS4.p1.2.m2.1.1" xref="S3.SS4.p1.2.m2.1.1.cmml">k</mi><annotation-xml encoding="MathML-Content" id="S3.SS4.p1.2.m2.1b"><ci id="S3.SS4.p1.2.m2.1.1.cmml" xref="S3.SS4.p1.2.m2.1.1">𝑘</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p1.2.m2.1c">k</annotation></semantics></math>’th client-specific data <math id="S3.SS4.p1.3.m3.1" class="ltx_Math" alttext="\mathcal{D}_{k}" display="inline"><semantics id="S3.SS4.p1.3.m3.1a"><msub id="S3.SS4.p1.3.m3.1.1" xref="S3.SS4.p1.3.m3.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS4.p1.3.m3.1.1.2" xref="S3.SS4.p1.3.m3.1.1.2.cmml">𝒟</mi><mi id="S3.SS4.p1.3.m3.1.1.3" xref="S3.SS4.p1.3.m3.1.1.3.cmml">k</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS4.p1.3.m3.1b"><apply id="S3.SS4.p1.3.m3.1.1.cmml" xref="S3.SS4.p1.3.m3.1.1"><csymbol cd="ambiguous" id="S3.SS4.p1.3.m3.1.1.1.cmml" xref="S3.SS4.p1.3.m3.1.1">subscript</csymbol><ci id="S3.SS4.p1.3.m3.1.1.2.cmml" xref="S3.SS4.p1.3.m3.1.1.2">𝒟</ci><ci id="S3.SS4.p1.3.m3.1.1.3.cmml" xref="S3.SS4.p1.3.m3.1.1.3">𝑘</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p1.3.m3.1c">\mathcal{D}_{k}</annotation></semantics></math> consists of <math id="S3.SS4.p1.4.m4.1" class="ltx_Math" alttext="M_{k}" display="inline"><semantics id="S3.SS4.p1.4.m4.1a"><msub id="S3.SS4.p1.4.m4.1.1" xref="S3.SS4.p1.4.m4.1.1.cmml"><mi id="S3.SS4.p1.4.m4.1.1.2" xref="S3.SS4.p1.4.m4.1.1.2.cmml">M</mi><mi id="S3.SS4.p1.4.m4.1.1.3" xref="S3.SS4.p1.4.m4.1.1.3.cmml">k</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS4.p1.4.m4.1b"><apply id="S3.SS4.p1.4.m4.1.1.cmml" xref="S3.SS4.p1.4.m4.1.1"><csymbol cd="ambiguous" id="S3.SS4.p1.4.m4.1.1.1.cmml" xref="S3.SS4.p1.4.m4.1.1">subscript</csymbol><ci id="S3.SS4.p1.4.m4.1.1.2.cmml" xref="S3.SS4.p1.4.m4.1.1.2">𝑀</ci><ci id="S3.SS4.p1.4.m4.1.1.3.cmml" xref="S3.SS4.p1.4.m4.1.1.3">𝑘</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p1.4.m4.1c">M_{k}</annotation></semantics></math> pairs of input/label-pairs <math id="S3.SS4.p1.5.m5.2" class="ltx_Math" alttext="\{\mathbf{x}_{m}^{k},y_{m}^{k}\}_{m=0}^{M_{k}}" display="inline"><semantics id="S3.SS4.p1.5.m5.2a"><msubsup id="S3.SS4.p1.5.m5.2.2" xref="S3.SS4.p1.5.m5.2.2.cmml"><mrow id="S3.SS4.p1.5.m5.2.2.2.2.2" xref="S3.SS4.p1.5.m5.2.2.2.2.3.cmml"><mo stretchy="false" id="S3.SS4.p1.5.m5.2.2.2.2.2.3" xref="S3.SS4.p1.5.m5.2.2.2.2.3.cmml">{</mo><msubsup id="S3.SS4.p1.5.m5.1.1.1.1.1.1" xref="S3.SS4.p1.5.m5.1.1.1.1.1.1.cmml"><mi id="S3.SS4.p1.5.m5.1.1.1.1.1.1.2.2" xref="S3.SS4.p1.5.m5.1.1.1.1.1.1.2.2.cmml">𝐱</mi><mi id="S3.SS4.p1.5.m5.1.1.1.1.1.1.2.3" xref="S3.SS4.p1.5.m5.1.1.1.1.1.1.2.3.cmml">m</mi><mi id="S3.SS4.p1.5.m5.1.1.1.1.1.1.3" xref="S3.SS4.p1.5.m5.1.1.1.1.1.1.3.cmml">k</mi></msubsup><mo id="S3.SS4.p1.5.m5.2.2.2.2.2.4" xref="S3.SS4.p1.5.m5.2.2.2.2.3.cmml">,</mo><msubsup id="S3.SS4.p1.5.m5.2.2.2.2.2.2" xref="S3.SS4.p1.5.m5.2.2.2.2.2.2.cmml"><mi id="S3.SS4.p1.5.m5.2.2.2.2.2.2.2.2" xref="S3.SS4.p1.5.m5.2.2.2.2.2.2.2.2.cmml">y</mi><mi id="S3.SS4.p1.5.m5.2.2.2.2.2.2.2.3" xref="S3.SS4.p1.5.m5.2.2.2.2.2.2.2.3.cmml">m</mi><mi id="S3.SS4.p1.5.m5.2.2.2.2.2.2.3" xref="S3.SS4.p1.5.m5.2.2.2.2.2.2.3.cmml">k</mi></msubsup><mo stretchy="false" id="S3.SS4.p1.5.m5.2.2.2.2.2.5" xref="S3.SS4.p1.5.m5.2.2.2.2.3.cmml">}</mo></mrow><mrow id="S3.SS4.p1.5.m5.2.2.2.4" xref="S3.SS4.p1.5.m5.2.2.2.4.cmml"><mi id="S3.SS4.p1.5.m5.2.2.2.4.2" xref="S3.SS4.p1.5.m5.2.2.2.4.2.cmml">m</mi><mo id="S3.SS4.p1.5.m5.2.2.2.4.1" xref="S3.SS4.p1.5.m5.2.2.2.4.1.cmml">=</mo><mn id="S3.SS4.p1.5.m5.2.2.2.4.3" xref="S3.SS4.p1.5.m5.2.2.2.4.3.cmml">0</mn></mrow><msub id="S3.SS4.p1.5.m5.2.2.4" xref="S3.SS4.p1.5.m5.2.2.4.cmml"><mi id="S3.SS4.p1.5.m5.2.2.4.2" xref="S3.SS4.p1.5.m5.2.2.4.2.cmml">M</mi><mi id="S3.SS4.p1.5.m5.2.2.4.3" xref="S3.SS4.p1.5.m5.2.2.4.3.cmml">k</mi></msub></msubsup><annotation-xml encoding="MathML-Content" id="S3.SS4.p1.5.m5.2b"><apply id="S3.SS4.p1.5.m5.2.2.cmml" xref="S3.SS4.p1.5.m5.2.2"><csymbol cd="ambiguous" id="S3.SS4.p1.5.m5.2.2.3.cmml" xref="S3.SS4.p1.5.m5.2.2">superscript</csymbol><apply id="S3.SS4.p1.5.m5.2.2.2.cmml" xref="S3.SS4.p1.5.m5.2.2"><csymbol cd="ambiguous" id="S3.SS4.p1.5.m5.2.2.2.3.cmml" xref="S3.SS4.p1.5.m5.2.2">subscript</csymbol><set id="S3.SS4.p1.5.m5.2.2.2.2.3.cmml" xref="S3.SS4.p1.5.m5.2.2.2.2.2"><apply id="S3.SS4.p1.5.m5.1.1.1.1.1.1.cmml" xref="S3.SS4.p1.5.m5.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS4.p1.5.m5.1.1.1.1.1.1.1.cmml" xref="S3.SS4.p1.5.m5.1.1.1.1.1.1">superscript</csymbol><apply id="S3.SS4.p1.5.m5.1.1.1.1.1.1.2.cmml" xref="S3.SS4.p1.5.m5.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS4.p1.5.m5.1.1.1.1.1.1.2.1.cmml" xref="S3.SS4.p1.5.m5.1.1.1.1.1.1">subscript</csymbol><ci id="S3.SS4.p1.5.m5.1.1.1.1.1.1.2.2.cmml" xref="S3.SS4.p1.5.m5.1.1.1.1.1.1.2.2">𝐱</ci><ci id="S3.SS4.p1.5.m5.1.1.1.1.1.1.2.3.cmml" xref="S3.SS4.p1.5.m5.1.1.1.1.1.1.2.3">𝑚</ci></apply><ci id="S3.SS4.p1.5.m5.1.1.1.1.1.1.3.cmml" xref="S3.SS4.p1.5.m5.1.1.1.1.1.1.3">𝑘</ci></apply><apply id="S3.SS4.p1.5.m5.2.2.2.2.2.2.cmml" xref="S3.SS4.p1.5.m5.2.2.2.2.2.2"><csymbol cd="ambiguous" id="S3.SS4.p1.5.m5.2.2.2.2.2.2.1.cmml" xref="S3.SS4.p1.5.m5.2.2.2.2.2.2">superscript</csymbol><apply id="S3.SS4.p1.5.m5.2.2.2.2.2.2.2.cmml" xref="S3.SS4.p1.5.m5.2.2.2.2.2.2"><csymbol cd="ambiguous" id="S3.SS4.p1.5.m5.2.2.2.2.2.2.2.1.cmml" xref="S3.SS4.p1.5.m5.2.2.2.2.2.2">subscript</csymbol><ci id="S3.SS4.p1.5.m5.2.2.2.2.2.2.2.2.cmml" xref="S3.SS4.p1.5.m5.2.2.2.2.2.2.2.2">𝑦</ci><ci id="S3.SS4.p1.5.m5.2.2.2.2.2.2.2.3.cmml" xref="S3.SS4.p1.5.m5.2.2.2.2.2.2.2.3">𝑚</ci></apply><ci id="S3.SS4.p1.5.m5.2.2.2.2.2.2.3.cmml" xref="S3.SS4.p1.5.m5.2.2.2.2.2.2.3">𝑘</ci></apply></set><apply id="S3.SS4.p1.5.m5.2.2.2.4.cmml" xref="S3.SS4.p1.5.m5.2.2.2.4"><eq id="S3.SS4.p1.5.m5.2.2.2.4.1.cmml" xref="S3.SS4.p1.5.m5.2.2.2.4.1"></eq><ci id="S3.SS4.p1.5.m5.2.2.2.4.2.cmml" xref="S3.SS4.p1.5.m5.2.2.2.4.2">𝑚</ci><cn type="integer" id="S3.SS4.p1.5.m5.2.2.2.4.3.cmml" xref="S3.SS4.p1.5.m5.2.2.2.4.3">0</cn></apply></apply><apply id="S3.SS4.p1.5.m5.2.2.4.cmml" xref="S3.SS4.p1.5.m5.2.2.4"><csymbol cd="ambiguous" id="S3.SS4.p1.5.m5.2.2.4.1.cmml" xref="S3.SS4.p1.5.m5.2.2.4">subscript</csymbol><ci id="S3.SS4.p1.5.m5.2.2.4.2.cmml" xref="S3.SS4.p1.5.m5.2.2.4.2">𝑀</ci><ci id="S3.SS4.p1.5.m5.2.2.4.3.cmml" xref="S3.SS4.p1.5.m5.2.2.4.3">𝑘</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p1.5.m5.2c">\{\mathbf{x}_{m}^{k},y_{m}^{k}\}_{m=0}^{M_{k}}</annotation></semantics></math>.
We can say that the class distribution follows a categorical distribution over <math id="S3.SS4.p1.6.m6.1" class="ltx_Math" alttext="C" display="inline"><semantics id="S3.SS4.p1.6.m6.1a"><mi id="S3.SS4.p1.6.m6.1.1" xref="S3.SS4.p1.6.m6.1.1.cmml">C</mi><annotation-xml encoding="MathML-Content" id="S3.SS4.p1.6.m6.1b"><ci id="S3.SS4.p1.6.m6.1.1.cmml" xref="S3.SS4.p1.6.m6.1.1">𝐶</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p1.6.m6.1c">C</annotation></semantics></math> classes, each with some probability for that client, expressible as a vector <math id="S3.SS4.p1.7.m7.1" class="ltx_Math" alttext="\mathbf{p}_{k}" display="inline"><semantics id="S3.SS4.p1.7.m7.1a"><msub id="S3.SS4.p1.7.m7.1.1" xref="S3.SS4.p1.7.m7.1.1.cmml"><mi id="S3.SS4.p1.7.m7.1.1.2" xref="S3.SS4.p1.7.m7.1.1.2.cmml">𝐩</mi><mi id="S3.SS4.p1.7.m7.1.1.3" xref="S3.SS4.p1.7.m7.1.1.3.cmml">k</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS4.p1.7.m7.1b"><apply id="S3.SS4.p1.7.m7.1.1.cmml" xref="S3.SS4.p1.7.m7.1.1"><csymbol cd="ambiguous" id="S3.SS4.p1.7.m7.1.1.1.cmml" xref="S3.SS4.p1.7.m7.1.1">subscript</csymbol><ci id="S3.SS4.p1.7.m7.1.1.2.cmml" xref="S3.SS4.p1.7.m7.1.1.2">𝐩</ci><ci id="S3.SS4.p1.7.m7.1.1.3.cmml" xref="S3.SS4.p1.7.m7.1.1.3">𝑘</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p1.7.m7.1c">\mathbf{p}_{k}</annotation></semantics></math>, such that <math id="S3.SS4.p1.8.m8.2" class="ltx_Math" alttext="y_{m}^{k}\sim\mathrm{Cat}(C,\mathbf{p}_{k})" display="inline"><semantics id="S3.SS4.p1.8.m8.2a"><mrow id="S3.SS4.p1.8.m8.2.2" xref="S3.SS4.p1.8.m8.2.2.cmml"><msubsup id="S3.SS4.p1.8.m8.2.2.3" xref="S3.SS4.p1.8.m8.2.2.3.cmml"><mi id="S3.SS4.p1.8.m8.2.2.3.2.2" xref="S3.SS4.p1.8.m8.2.2.3.2.2.cmml">y</mi><mi id="S3.SS4.p1.8.m8.2.2.3.2.3" xref="S3.SS4.p1.8.m8.2.2.3.2.3.cmml">m</mi><mi id="S3.SS4.p1.8.m8.2.2.3.3" xref="S3.SS4.p1.8.m8.2.2.3.3.cmml">k</mi></msubsup><mo id="S3.SS4.p1.8.m8.2.2.2" xref="S3.SS4.p1.8.m8.2.2.2.cmml">∼</mo><mrow id="S3.SS4.p1.8.m8.2.2.1" xref="S3.SS4.p1.8.m8.2.2.1.cmml"><mi id="S3.SS4.p1.8.m8.2.2.1.3" xref="S3.SS4.p1.8.m8.2.2.1.3.cmml">Cat</mi><mo lspace="0em" rspace="0em" id="S3.SS4.p1.8.m8.2.2.1.2" xref="S3.SS4.p1.8.m8.2.2.1.2.cmml">​</mo><mrow id="S3.SS4.p1.8.m8.2.2.1.1.1" xref="S3.SS4.p1.8.m8.2.2.1.1.2.cmml"><mo stretchy="false" id="S3.SS4.p1.8.m8.2.2.1.1.1.2" xref="S3.SS4.p1.8.m8.2.2.1.1.2.cmml">(</mo><mi id="S3.SS4.p1.8.m8.1.1" xref="S3.SS4.p1.8.m8.1.1.cmml">C</mi><mo id="S3.SS4.p1.8.m8.2.2.1.1.1.3" xref="S3.SS4.p1.8.m8.2.2.1.1.2.cmml">,</mo><msub id="S3.SS4.p1.8.m8.2.2.1.1.1.1" xref="S3.SS4.p1.8.m8.2.2.1.1.1.1.cmml"><mi id="S3.SS4.p1.8.m8.2.2.1.1.1.1.2" xref="S3.SS4.p1.8.m8.2.2.1.1.1.1.2.cmml">𝐩</mi><mi id="S3.SS4.p1.8.m8.2.2.1.1.1.1.3" xref="S3.SS4.p1.8.m8.2.2.1.1.1.1.3.cmml">k</mi></msub><mo stretchy="false" id="S3.SS4.p1.8.m8.2.2.1.1.1.4" xref="S3.SS4.p1.8.m8.2.2.1.1.2.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS4.p1.8.m8.2b"><apply id="S3.SS4.p1.8.m8.2.2.cmml" xref="S3.SS4.p1.8.m8.2.2"><csymbol cd="latexml" id="S3.SS4.p1.8.m8.2.2.2.cmml" xref="S3.SS4.p1.8.m8.2.2.2">similar-to</csymbol><apply id="S3.SS4.p1.8.m8.2.2.3.cmml" xref="S3.SS4.p1.8.m8.2.2.3"><csymbol cd="ambiguous" id="S3.SS4.p1.8.m8.2.2.3.1.cmml" xref="S3.SS4.p1.8.m8.2.2.3">superscript</csymbol><apply id="S3.SS4.p1.8.m8.2.2.3.2.cmml" xref="S3.SS4.p1.8.m8.2.2.3"><csymbol cd="ambiguous" id="S3.SS4.p1.8.m8.2.2.3.2.1.cmml" xref="S3.SS4.p1.8.m8.2.2.3">subscript</csymbol><ci id="S3.SS4.p1.8.m8.2.2.3.2.2.cmml" xref="S3.SS4.p1.8.m8.2.2.3.2.2">𝑦</ci><ci id="S3.SS4.p1.8.m8.2.2.3.2.3.cmml" xref="S3.SS4.p1.8.m8.2.2.3.2.3">𝑚</ci></apply><ci id="S3.SS4.p1.8.m8.2.2.3.3.cmml" xref="S3.SS4.p1.8.m8.2.2.3.3">𝑘</ci></apply><apply id="S3.SS4.p1.8.m8.2.2.1.cmml" xref="S3.SS4.p1.8.m8.2.2.1"><times id="S3.SS4.p1.8.m8.2.2.1.2.cmml" xref="S3.SS4.p1.8.m8.2.2.1.2"></times><ci id="S3.SS4.p1.8.m8.2.2.1.3.cmml" xref="S3.SS4.p1.8.m8.2.2.1.3">Cat</ci><interval closure="open" id="S3.SS4.p1.8.m8.2.2.1.1.2.cmml" xref="S3.SS4.p1.8.m8.2.2.1.1.1"><ci id="S3.SS4.p1.8.m8.1.1.cmml" xref="S3.SS4.p1.8.m8.1.1">𝐶</ci><apply id="S3.SS4.p1.8.m8.2.2.1.1.1.1.cmml" xref="S3.SS4.p1.8.m8.2.2.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS4.p1.8.m8.2.2.1.1.1.1.1.cmml" xref="S3.SS4.p1.8.m8.2.2.1.1.1.1">subscript</csymbol><ci id="S3.SS4.p1.8.m8.2.2.1.1.1.1.2.cmml" xref="S3.SS4.p1.8.m8.2.2.1.1.1.1.2">𝐩</ci><ci id="S3.SS4.p1.8.m8.2.2.1.1.1.1.3.cmml" xref="S3.SS4.p1.8.m8.2.2.1.1.1.1.3">𝑘</ci></apply></interval></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p1.8.m8.2c">y_{m}^{k}\sim\mathrm{Cat}(C,\mathbf{p}_{k})</annotation></semantics></math>. Previous studies have considered how differences in <math id="S3.SS4.p1.9.m9.1" class="ltx_Math" alttext="\mathbf{p}_{k}" display="inline"><semantics id="S3.SS4.p1.9.m9.1a"><msub id="S3.SS4.p1.9.m9.1.1" xref="S3.SS4.p1.9.m9.1.1.cmml"><mi id="S3.SS4.p1.9.m9.1.1.2" xref="S3.SS4.p1.9.m9.1.1.2.cmml">𝐩</mi><mi id="S3.SS4.p1.9.m9.1.1.3" xref="S3.SS4.p1.9.m9.1.1.3.cmml">k</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS4.p1.9.m9.1b"><apply id="S3.SS4.p1.9.m9.1.1.cmml" xref="S3.SS4.p1.9.m9.1.1"><csymbol cd="ambiguous" id="S3.SS4.p1.9.m9.1.1.1.cmml" xref="S3.SS4.p1.9.m9.1.1">subscript</csymbol><ci id="S3.SS4.p1.9.m9.1.1.2.cmml" xref="S3.SS4.p1.9.m9.1.1.2">𝐩</ci><ci id="S3.SS4.p1.9.m9.1.1.3.cmml" xref="S3.SS4.p1.9.m9.1.1.3">𝑘</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p1.9.m9.1c">\mathbf{p}_{k}</annotation></semantics></math> for different clients affect learning.
In contrast, we are interested in how differences of the input data, <math id="S3.SS4.p1.10.m10.1" class="ltx_Math" alttext="\mathbf{x}_{m}^{k}\sim p_{k}\left(\mathbf{x}\right)" display="inline"><semantics id="S3.SS4.p1.10.m10.1a"><mrow id="S3.SS4.p1.10.m10.1.2" xref="S3.SS4.p1.10.m10.1.2.cmml"><msubsup id="S3.SS4.p1.10.m10.1.2.2" xref="S3.SS4.p1.10.m10.1.2.2.cmml"><mi id="S3.SS4.p1.10.m10.1.2.2.2.2" xref="S3.SS4.p1.10.m10.1.2.2.2.2.cmml">𝐱</mi><mi id="S3.SS4.p1.10.m10.1.2.2.2.3" xref="S3.SS4.p1.10.m10.1.2.2.2.3.cmml">m</mi><mi id="S3.SS4.p1.10.m10.1.2.2.3" xref="S3.SS4.p1.10.m10.1.2.2.3.cmml">k</mi></msubsup><mo id="S3.SS4.p1.10.m10.1.2.1" xref="S3.SS4.p1.10.m10.1.2.1.cmml">∼</mo><mrow id="S3.SS4.p1.10.m10.1.2.3" xref="S3.SS4.p1.10.m10.1.2.3.cmml"><msub id="S3.SS4.p1.10.m10.1.2.3.2" xref="S3.SS4.p1.10.m10.1.2.3.2.cmml"><mi id="S3.SS4.p1.10.m10.1.2.3.2.2" xref="S3.SS4.p1.10.m10.1.2.3.2.2.cmml">p</mi><mi id="S3.SS4.p1.10.m10.1.2.3.2.3" xref="S3.SS4.p1.10.m10.1.2.3.2.3.cmml">k</mi></msub><mo lspace="0em" rspace="0em" id="S3.SS4.p1.10.m10.1.2.3.1" xref="S3.SS4.p1.10.m10.1.2.3.1.cmml">​</mo><mrow id="S3.SS4.p1.10.m10.1.2.3.3.2" xref="S3.SS4.p1.10.m10.1.2.3.cmml"><mo id="S3.SS4.p1.10.m10.1.2.3.3.2.1" xref="S3.SS4.p1.10.m10.1.2.3.cmml">(</mo><mi id="S3.SS4.p1.10.m10.1.1" xref="S3.SS4.p1.10.m10.1.1.cmml">𝐱</mi><mo id="S3.SS4.p1.10.m10.1.2.3.3.2.2" xref="S3.SS4.p1.10.m10.1.2.3.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS4.p1.10.m10.1b"><apply id="S3.SS4.p1.10.m10.1.2.cmml" xref="S3.SS4.p1.10.m10.1.2"><csymbol cd="latexml" id="S3.SS4.p1.10.m10.1.2.1.cmml" xref="S3.SS4.p1.10.m10.1.2.1">similar-to</csymbol><apply id="S3.SS4.p1.10.m10.1.2.2.cmml" xref="S3.SS4.p1.10.m10.1.2.2"><csymbol cd="ambiguous" id="S3.SS4.p1.10.m10.1.2.2.1.cmml" xref="S3.SS4.p1.10.m10.1.2.2">superscript</csymbol><apply id="S3.SS4.p1.10.m10.1.2.2.2.cmml" xref="S3.SS4.p1.10.m10.1.2.2"><csymbol cd="ambiguous" id="S3.SS4.p1.10.m10.1.2.2.2.1.cmml" xref="S3.SS4.p1.10.m10.1.2.2">subscript</csymbol><ci id="S3.SS4.p1.10.m10.1.2.2.2.2.cmml" xref="S3.SS4.p1.10.m10.1.2.2.2.2">𝐱</ci><ci id="S3.SS4.p1.10.m10.1.2.2.2.3.cmml" xref="S3.SS4.p1.10.m10.1.2.2.2.3">𝑚</ci></apply><ci id="S3.SS4.p1.10.m10.1.2.2.3.cmml" xref="S3.SS4.p1.10.m10.1.2.2.3">𝑘</ci></apply><apply id="S3.SS4.p1.10.m10.1.2.3.cmml" xref="S3.SS4.p1.10.m10.1.2.3"><times id="S3.SS4.p1.10.m10.1.2.3.1.cmml" xref="S3.SS4.p1.10.m10.1.2.3.1"></times><apply id="S3.SS4.p1.10.m10.1.2.3.2.cmml" xref="S3.SS4.p1.10.m10.1.2.3.2"><csymbol cd="ambiguous" id="S3.SS4.p1.10.m10.1.2.3.2.1.cmml" xref="S3.SS4.p1.10.m10.1.2.3.2">subscript</csymbol><ci id="S3.SS4.p1.10.m10.1.2.3.2.2.cmml" xref="S3.SS4.p1.10.m10.1.2.3.2.2">𝑝</ci><ci id="S3.SS4.p1.10.m10.1.2.3.2.3.cmml" xref="S3.SS4.p1.10.m10.1.2.3.2.3">𝑘</ci></apply><ci id="S3.SS4.p1.10.m10.1.1.cmml" xref="S3.SS4.p1.10.m10.1.1">𝐱</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p1.10.m10.1c">\mathbf{x}_{m}^{k}\sim p_{k}\left(\mathbf{x}\right)</annotation></semantics></math>, affect learning. We consider derived features, or embeddings, as learnt in a pre-trained network <math id="S3.SS4.p1.11.m11.1" class="ltx_Math" alttext="\mathbf{z}_{m}^{k}=f_{\theta}(\mathbf{x}_{m}^{k})" display="inline"><semantics id="S3.SS4.p1.11.m11.1a"><mrow id="S3.SS4.p1.11.m11.1.1" xref="S3.SS4.p1.11.m11.1.1.cmml"><msubsup id="S3.SS4.p1.11.m11.1.1.3" xref="S3.SS4.p1.11.m11.1.1.3.cmml"><mi id="S3.SS4.p1.11.m11.1.1.3.2.2" xref="S3.SS4.p1.11.m11.1.1.3.2.2.cmml">𝐳</mi><mi id="S3.SS4.p1.11.m11.1.1.3.2.3" xref="S3.SS4.p1.11.m11.1.1.3.2.3.cmml">m</mi><mi id="S3.SS4.p1.11.m11.1.1.3.3" xref="S3.SS4.p1.11.m11.1.1.3.3.cmml">k</mi></msubsup><mo id="S3.SS4.p1.11.m11.1.1.2" xref="S3.SS4.p1.11.m11.1.1.2.cmml">=</mo><mrow id="S3.SS4.p1.11.m11.1.1.1" xref="S3.SS4.p1.11.m11.1.1.1.cmml"><msub id="S3.SS4.p1.11.m11.1.1.1.3" xref="S3.SS4.p1.11.m11.1.1.1.3.cmml"><mi id="S3.SS4.p1.11.m11.1.1.1.3.2" xref="S3.SS4.p1.11.m11.1.1.1.3.2.cmml">f</mi><mi id="S3.SS4.p1.11.m11.1.1.1.3.3" xref="S3.SS4.p1.11.m11.1.1.1.3.3.cmml">θ</mi></msub><mo lspace="0em" rspace="0em" id="S3.SS4.p1.11.m11.1.1.1.2" xref="S3.SS4.p1.11.m11.1.1.1.2.cmml">​</mo><mrow id="S3.SS4.p1.11.m11.1.1.1.1.1" xref="S3.SS4.p1.11.m11.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S3.SS4.p1.11.m11.1.1.1.1.1.2" xref="S3.SS4.p1.11.m11.1.1.1.1.1.1.cmml">(</mo><msubsup id="S3.SS4.p1.11.m11.1.1.1.1.1.1" xref="S3.SS4.p1.11.m11.1.1.1.1.1.1.cmml"><mi id="S3.SS4.p1.11.m11.1.1.1.1.1.1.2.2" xref="S3.SS4.p1.11.m11.1.1.1.1.1.1.2.2.cmml">𝐱</mi><mi id="S3.SS4.p1.11.m11.1.1.1.1.1.1.2.3" xref="S3.SS4.p1.11.m11.1.1.1.1.1.1.2.3.cmml">m</mi><mi id="S3.SS4.p1.11.m11.1.1.1.1.1.1.3" xref="S3.SS4.p1.11.m11.1.1.1.1.1.1.3.cmml">k</mi></msubsup><mo stretchy="false" id="S3.SS4.p1.11.m11.1.1.1.1.1.3" xref="S3.SS4.p1.11.m11.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS4.p1.11.m11.1b"><apply id="S3.SS4.p1.11.m11.1.1.cmml" xref="S3.SS4.p1.11.m11.1.1"><eq id="S3.SS4.p1.11.m11.1.1.2.cmml" xref="S3.SS4.p1.11.m11.1.1.2"></eq><apply id="S3.SS4.p1.11.m11.1.1.3.cmml" xref="S3.SS4.p1.11.m11.1.1.3"><csymbol cd="ambiguous" id="S3.SS4.p1.11.m11.1.1.3.1.cmml" xref="S3.SS4.p1.11.m11.1.1.3">superscript</csymbol><apply id="S3.SS4.p1.11.m11.1.1.3.2.cmml" xref="S3.SS4.p1.11.m11.1.1.3"><csymbol cd="ambiguous" id="S3.SS4.p1.11.m11.1.1.3.2.1.cmml" xref="S3.SS4.p1.11.m11.1.1.3">subscript</csymbol><ci id="S3.SS4.p1.11.m11.1.1.3.2.2.cmml" xref="S3.SS4.p1.11.m11.1.1.3.2.2">𝐳</ci><ci id="S3.SS4.p1.11.m11.1.1.3.2.3.cmml" xref="S3.SS4.p1.11.m11.1.1.3.2.3">𝑚</ci></apply><ci id="S3.SS4.p1.11.m11.1.1.3.3.cmml" xref="S3.SS4.p1.11.m11.1.1.3.3">𝑘</ci></apply><apply id="S3.SS4.p1.11.m11.1.1.1.cmml" xref="S3.SS4.p1.11.m11.1.1.1"><times id="S3.SS4.p1.11.m11.1.1.1.2.cmml" xref="S3.SS4.p1.11.m11.1.1.1.2"></times><apply id="S3.SS4.p1.11.m11.1.1.1.3.cmml" xref="S3.SS4.p1.11.m11.1.1.1.3"><csymbol cd="ambiguous" id="S3.SS4.p1.11.m11.1.1.1.3.1.cmml" xref="S3.SS4.p1.11.m11.1.1.1.3">subscript</csymbol><ci id="S3.SS4.p1.11.m11.1.1.1.3.2.cmml" xref="S3.SS4.p1.11.m11.1.1.1.3.2">𝑓</ci><ci id="S3.SS4.p1.11.m11.1.1.1.3.3.cmml" xref="S3.SS4.p1.11.m11.1.1.1.3.3">𝜃</ci></apply><apply id="S3.SS4.p1.11.m11.1.1.1.1.1.1.cmml" xref="S3.SS4.p1.11.m11.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS4.p1.11.m11.1.1.1.1.1.1.1.cmml" xref="S3.SS4.p1.11.m11.1.1.1.1.1">superscript</csymbol><apply id="S3.SS4.p1.11.m11.1.1.1.1.1.1.2.cmml" xref="S3.SS4.p1.11.m11.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS4.p1.11.m11.1.1.1.1.1.1.2.1.cmml" xref="S3.SS4.p1.11.m11.1.1.1.1.1">subscript</csymbol><ci id="S3.SS4.p1.11.m11.1.1.1.1.1.1.2.2.cmml" xref="S3.SS4.p1.11.m11.1.1.1.1.1.1.2.2">𝐱</ci><ci id="S3.SS4.p1.11.m11.1.1.1.1.1.1.2.3.cmml" xref="S3.SS4.p1.11.m11.1.1.1.1.1.1.2.3">𝑚</ci></apply><ci id="S3.SS4.p1.11.m11.1.1.1.1.1.1.3.cmml" xref="S3.SS4.p1.11.m11.1.1.1.1.1.1.3">𝑘</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p1.11.m11.1c">\mathbf{z}_{m}^{k}=f_{\theta}(\mathbf{x}_{m}^{k})</annotation></semantics></math> as the basis for investigation—partly inspired by the use of the Fréchet Inception Distance <cite class="ltx_cite ltx_citemacro_citep">(Heusel et al., <a href="#bib.bib7" title="" class="ltx_ref">2017</a>)</cite> for evaluating the performance of generative adversarial networks.</p>
</div>
<div id="S3.SS4.p2" class="ltx_para">
<p id="S3.SS4.p2.4" class="ltx_p">For the purposes of this paper, we define the overall client data heterogeneity as the average distances from any given client to the rest of the clients in their distributions of embeddings, <math id="S3.SS4.p2.1.m1.1" class="ltx_Math" alttext="\mathbf{z}_{m}^{k}\sim p_{k}\left(\mathbf{z}\right)" display="inline"><semantics id="S3.SS4.p2.1.m1.1a"><mrow id="S3.SS4.p2.1.m1.1.2" xref="S3.SS4.p2.1.m1.1.2.cmml"><msubsup id="S3.SS4.p2.1.m1.1.2.2" xref="S3.SS4.p2.1.m1.1.2.2.cmml"><mi id="S3.SS4.p2.1.m1.1.2.2.2.2" xref="S3.SS4.p2.1.m1.1.2.2.2.2.cmml">𝐳</mi><mi id="S3.SS4.p2.1.m1.1.2.2.2.3" xref="S3.SS4.p2.1.m1.1.2.2.2.3.cmml">m</mi><mi id="S3.SS4.p2.1.m1.1.2.2.3" xref="S3.SS4.p2.1.m1.1.2.2.3.cmml">k</mi></msubsup><mo id="S3.SS4.p2.1.m1.1.2.1" xref="S3.SS4.p2.1.m1.1.2.1.cmml">∼</mo><mrow id="S3.SS4.p2.1.m1.1.2.3" xref="S3.SS4.p2.1.m1.1.2.3.cmml"><msub id="S3.SS4.p2.1.m1.1.2.3.2" xref="S3.SS4.p2.1.m1.1.2.3.2.cmml"><mi id="S3.SS4.p2.1.m1.1.2.3.2.2" xref="S3.SS4.p2.1.m1.1.2.3.2.2.cmml">p</mi><mi id="S3.SS4.p2.1.m1.1.2.3.2.3" xref="S3.SS4.p2.1.m1.1.2.3.2.3.cmml">k</mi></msub><mo lspace="0em" rspace="0em" id="S3.SS4.p2.1.m1.1.2.3.1" xref="S3.SS4.p2.1.m1.1.2.3.1.cmml">​</mo><mrow id="S3.SS4.p2.1.m1.1.2.3.3.2" xref="S3.SS4.p2.1.m1.1.2.3.cmml"><mo id="S3.SS4.p2.1.m1.1.2.3.3.2.1" xref="S3.SS4.p2.1.m1.1.2.3.cmml">(</mo><mi id="S3.SS4.p2.1.m1.1.1" xref="S3.SS4.p2.1.m1.1.1.cmml">𝐳</mi><mo id="S3.SS4.p2.1.m1.1.2.3.3.2.2" xref="S3.SS4.p2.1.m1.1.2.3.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS4.p2.1.m1.1b"><apply id="S3.SS4.p2.1.m1.1.2.cmml" xref="S3.SS4.p2.1.m1.1.2"><csymbol cd="latexml" id="S3.SS4.p2.1.m1.1.2.1.cmml" xref="S3.SS4.p2.1.m1.1.2.1">similar-to</csymbol><apply id="S3.SS4.p2.1.m1.1.2.2.cmml" xref="S3.SS4.p2.1.m1.1.2.2"><csymbol cd="ambiguous" id="S3.SS4.p2.1.m1.1.2.2.1.cmml" xref="S3.SS4.p2.1.m1.1.2.2">superscript</csymbol><apply id="S3.SS4.p2.1.m1.1.2.2.2.cmml" xref="S3.SS4.p2.1.m1.1.2.2"><csymbol cd="ambiguous" id="S3.SS4.p2.1.m1.1.2.2.2.1.cmml" xref="S3.SS4.p2.1.m1.1.2.2">subscript</csymbol><ci id="S3.SS4.p2.1.m1.1.2.2.2.2.cmml" xref="S3.SS4.p2.1.m1.1.2.2.2.2">𝐳</ci><ci id="S3.SS4.p2.1.m1.1.2.2.2.3.cmml" xref="S3.SS4.p2.1.m1.1.2.2.2.3">𝑚</ci></apply><ci id="S3.SS4.p2.1.m1.1.2.2.3.cmml" xref="S3.SS4.p2.1.m1.1.2.2.3">𝑘</ci></apply><apply id="S3.SS4.p2.1.m1.1.2.3.cmml" xref="S3.SS4.p2.1.m1.1.2.3"><times id="S3.SS4.p2.1.m1.1.2.3.1.cmml" xref="S3.SS4.p2.1.m1.1.2.3.1"></times><apply id="S3.SS4.p2.1.m1.1.2.3.2.cmml" xref="S3.SS4.p2.1.m1.1.2.3.2"><csymbol cd="ambiguous" id="S3.SS4.p2.1.m1.1.2.3.2.1.cmml" xref="S3.SS4.p2.1.m1.1.2.3.2">subscript</csymbol><ci id="S3.SS4.p2.1.m1.1.2.3.2.2.cmml" xref="S3.SS4.p2.1.m1.1.2.3.2.2">𝑝</ci><ci id="S3.SS4.p2.1.m1.1.2.3.2.3.cmml" xref="S3.SS4.p2.1.m1.1.2.3.2.3">𝑘</ci></apply><ci id="S3.SS4.p2.1.m1.1.1.cmml" xref="S3.SS4.p2.1.m1.1.1">𝐳</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p2.1.m1.1c">\mathbf{z}_{m}^{k}\sim p_{k}\left(\mathbf{z}\right)</annotation></semantics></math>.
Under a strong assumption of normality, the level of heterogeneity is quantifiable as a distance between multivariate Gaussians, and we consider the Fréchet distance between two distributions <math id="S3.SS4.p2.2.m2.1" class="ltx_Math" alttext="D_{1}" display="inline"><semantics id="S3.SS4.p2.2.m2.1a"><msub id="S3.SS4.p2.2.m2.1.1" xref="S3.SS4.p2.2.m2.1.1.cmml"><mi id="S3.SS4.p2.2.m2.1.1.2" xref="S3.SS4.p2.2.m2.1.1.2.cmml">D</mi><mn id="S3.SS4.p2.2.m2.1.1.3" xref="S3.SS4.p2.2.m2.1.1.3.cmml">1</mn></msub><annotation-xml encoding="MathML-Content" id="S3.SS4.p2.2.m2.1b"><apply id="S3.SS4.p2.2.m2.1.1.cmml" xref="S3.SS4.p2.2.m2.1.1"><csymbol cd="ambiguous" id="S3.SS4.p2.2.m2.1.1.1.cmml" xref="S3.SS4.p2.2.m2.1.1">subscript</csymbol><ci id="S3.SS4.p2.2.m2.1.1.2.cmml" xref="S3.SS4.p2.2.m2.1.1.2">𝐷</ci><cn type="integer" id="S3.SS4.p2.2.m2.1.1.3.cmml" xref="S3.SS4.p2.2.m2.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p2.2.m2.1c">D_{1}</annotation></semantics></math> and <math id="S3.SS4.p2.3.m3.1" class="ltx_Math" alttext="D_{2}" display="inline"><semantics id="S3.SS4.p2.3.m3.1a"><msub id="S3.SS4.p2.3.m3.1.1" xref="S3.SS4.p2.3.m3.1.1.cmml"><mi id="S3.SS4.p2.3.m3.1.1.2" xref="S3.SS4.p2.3.m3.1.1.2.cmml">D</mi><mn id="S3.SS4.p2.3.m3.1.1.3" xref="S3.SS4.p2.3.m3.1.1.3.cmml">2</mn></msub><annotation-xml encoding="MathML-Content" id="S3.SS4.p2.3.m3.1b"><apply id="S3.SS4.p2.3.m3.1.1.cmml" xref="S3.SS4.p2.3.m3.1.1"><csymbol cd="ambiguous" id="S3.SS4.p2.3.m3.1.1.1.cmml" xref="S3.SS4.p2.3.m3.1.1">subscript</csymbol><ci id="S3.SS4.p2.3.m3.1.1.2.cmml" xref="S3.SS4.p2.3.m3.1.1.2">𝐷</ci><cn type="integer" id="S3.SS4.p2.3.m3.1.1.3.cmml" xref="S3.SS4.p2.3.m3.1.1.3">2</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p2.3.m3.1c">D_{2}</annotation></semantics></math>, <math id="S3.SS4.p2.4.m4.2" class="ltx_Math" alttext="d^{2}(D_{1},D_{2})" display="inline"><semantics id="S3.SS4.p2.4.m4.2a"><mrow id="S3.SS4.p2.4.m4.2.2" xref="S3.SS4.p2.4.m4.2.2.cmml"><msup id="S3.SS4.p2.4.m4.2.2.4" xref="S3.SS4.p2.4.m4.2.2.4.cmml"><mi id="S3.SS4.p2.4.m4.2.2.4.2" xref="S3.SS4.p2.4.m4.2.2.4.2.cmml">d</mi><mn id="S3.SS4.p2.4.m4.2.2.4.3" xref="S3.SS4.p2.4.m4.2.2.4.3.cmml">2</mn></msup><mo lspace="0em" rspace="0em" id="S3.SS4.p2.4.m4.2.2.3" xref="S3.SS4.p2.4.m4.2.2.3.cmml">​</mo><mrow id="S3.SS4.p2.4.m4.2.2.2.2" xref="S3.SS4.p2.4.m4.2.2.2.3.cmml"><mo stretchy="false" id="S3.SS4.p2.4.m4.2.2.2.2.3" xref="S3.SS4.p2.4.m4.2.2.2.3.cmml">(</mo><msub id="S3.SS4.p2.4.m4.1.1.1.1.1" xref="S3.SS4.p2.4.m4.1.1.1.1.1.cmml"><mi id="S3.SS4.p2.4.m4.1.1.1.1.1.2" xref="S3.SS4.p2.4.m4.1.1.1.1.1.2.cmml">D</mi><mn id="S3.SS4.p2.4.m4.1.1.1.1.1.3" xref="S3.SS4.p2.4.m4.1.1.1.1.1.3.cmml">1</mn></msub><mo id="S3.SS4.p2.4.m4.2.2.2.2.4" xref="S3.SS4.p2.4.m4.2.2.2.3.cmml">,</mo><msub id="S3.SS4.p2.4.m4.2.2.2.2.2" xref="S3.SS4.p2.4.m4.2.2.2.2.2.cmml"><mi id="S3.SS4.p2.4.m4.2.2.2.2.2.2" xref="S3.SS4.p2.4.m4.2.2.2.2.2.2.cmml">D</mi><mn id="S3.SS4.p2.4.m4.2.2.2.2.2.3" xref="S3.SS4.p2.4.m4.2.2.2.2.2.3.cmml">2</mn></msub><mo stretchy="false" id="S3.SS4.p2.4.m4.2.2.2.2.5" xref="S3.SS4.p2.4.m4.2.2.2.3.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS4.p2.4.m4.2b"><apply id="S3.SS4.p2.4.m4.2.2.cmml" xref="S3.SS4.p2.4.m4.2.2"><times id="S3.SS4.p2.4.m4.2.2.3.cmml" xref="S3.SS4.p2.4.m4.2.2.3"></times><apply id="S3.SS4.p2.4.m4.2.2.4.cmml" xref="S3.SS4.p2.4.m4.2.2.4"><csymbol cd="ambiguous" id="S3.SS4.p2.4.m4.2.2.4.1.cmml" xref="S3.SS4.p2.4.m4.2.2.4">superscript</csymbol><ci id="S3.SS4.p2.4.m4.2.2.4.2.cmml" xref="S3.SS4.p2.4.m4.2.2.4.2">𝑑</ci><cn type="integer" id="S3.SS4.p2.4.m4.2.2.4.3.cmml" xref="S3.SS4.p2.4.m4.2.2.4.3">2</cn></apply><interval closure="open" id="S3.SS4.p2.4.m4.2.2.2.3.cmml" xref="S3.SS4.p2.4.m4.2.2.2.2"><apply id="S3.SS4.p2.4.m4.1.1.1.1.1.cmml" xref="S3.SS4.p2.4.m4.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS4.p2.4.m4.1.1.1.1.1.1.cmml" xref="S3.SS4.p2.4.m4.1.1.1.1.1">subscript</csymbol><ci id="S3.SS4.p2.4.m4.1.1.1.1.1.2.cmml" xref="S3.SS4.p2.4.m4.1.1.1.1.1.2">𝐷</ci><cn type="integer" id="S3.SS4.p2.4.m4.1.1.1.1.1.3.cmml" xref="S3.SS4.p2.4.m4.1.1.1.1.1.3">1</cn></apply><apply id="S3.SS4.p2.4.m4.2.2.2.2.2.cmml" xref="S3.SS4.p2.4.m4.2.2.2.2.2"><csymbol cd="ambiguous" id="S3.SS4.p2.4.m4.2.2.2.2.2.1.cmml" xref="S3.SS4.p2.4.m4.2.2.2.2.2">subscript</csymbol><ci id="S3.SS4.p2.4.m4.2.2.2.2.2.2.cmml" xref="S3.SS4.p2.4.m4.2.2.2.2.2.2">𝐷</ci><cn type="integer" id="S3.SS4.p2.4.m4.2.2.2.2.2.3.cmml" xref="S3.SS4.p2.4.m4.2.2.2.2.2.3">2</cn></apply></interval></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p2.4.m4.2c">d^{2}(D_{1},D_{2})</annotation></semantics></math> (among other names also know as the 2<sup id="S3.SS4.p2.4.1" class="ltx_sup">nd</sup> Wasserstein distance).</p>
</div>
<div id="S3.SS4.p3" class="ltx_para">
<p id="S3.SS4.p3.2" class="ltx_p">The Fréchet distance between two multivariate Gaussians, <math id="S3.SS4.p3.1.m1.2" class="ltx_Math" alttext="D_{1}=\mathcal{N}\left(\mu_{1},\Sigma_{1}\right)" display="inline"><semantics id="S3.SS4.p3.1.m1.2a"><mrow id="S3.SS4.p3.1.m1.2.2" xref="S3.SS4.p3.1.m1.2.2.cmml"><msub id="S3.SS4.p3.1.m1.2.2.4" xref="S3.SS4.p3.1.m1.2.2.4.cmml"><mi id="S3.SS4.p3.1.m1.2.2.4.2" xref="S3.SS4.p3.1.m1.2.2.4.2.cmml">D</mi><mn id="S3.SS4.p3.1.m1.2.2.4.3" xref="S3.SS4.p3.1.m1.2.2.4.3.cmml">1</mn></msub><mo id="S3.SS4.p3.1.m1.2.2.3" xref="S3.SS4.p3.1.m1.2.2.3.cmml">=</mo><mrow id="S3.SS4.p3.1.m1.2.2.2" xref="S3.SS4.p3.1.m1.2.2.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS4.p3.1.m1.2.2.2.4" xref="S3.SS4.p3.1.m1.2.2.2.4.cmml">𝒩</mi><mo lspace="0em" rspace="0em" id="S3.SS4.p3.1.m1.2.2.2.3" xref="S3.SS4.p3.1.m1.2.2.2.3.cmml">​</mo><mrow id="S3.SS4.p3.1.m1.2.2.2.2.2" xref="S3.SS4.p3.1.m1.2.2.2.2.3.cmml"><mo id="S3.SS4.p3.1.m1.2.2.2.2.2.3" xref="S3.SS4.p3.1.m1.2.2.2.2.3.cmml">(</mo><msub id="S3.SS4.p3.1.m1.1.1.1.1.1.1" xref="S3.SS4.p3.1.m1.1.1.1.1.1.1.cmml"><mi id="S3.SS4.p3.1.m1.1.1.1.1.1.1.2" xref="S3.SS4.p3.1.m1.1.1.1.1.1.1.2.cmml">μ</mi><mn id="S3.SS4.p3.1.m1.1.1.1.1.1.1.3" xref="S3.SS4.p3.1.m1.1.1.1.1.1.1.3.cmml">1</mn></msub><mo id="S3.SS4.p3.1.m1.2.2.2.2.2.4" xref="S3.SS4.p3.1.m1.2.2.2.2.3.cmml">,</mo><msub id="S3.SS4.p3.1.m1.2.2.2.2.2.2" xref="S3.SS4.p3.1.m1.2.2.2.2.2.2.cmml"><mi mathvariant="normal" id="S3.SS4.p3.1.m1.2.2.2.2.2.2.2" xref="S3.SS4.p3.1.m1.2.2.2.2.2.2.2.cmml">Σ</mi><mn id="S3.SS4.p3.1.m1.2.2.2.2.2.2.3" xref="S3.SS4.p3.1.m1.2.2.2.2.2.2.3.cmml">1</mn></msub><mo id="S3.SS4.p3.1.m1.2.2.2.2.2.5" xref="S3.SS4.p3.1.m1.2.2.2.2.3.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS4.p3.1.m1.2b"><apply id="S3.SS4.p3.1.m1.2.2.cmml" xref="S3.SS4.p3.1.m1.2.2"><eq id="S3.SS4.p3.1.m1.2.2.3.cmml" xref="S3.SS4.p3.1.m1.2.2.3"></eq><apply id="S3.SS4.p3.1.m1.2.2.4.cmml" xref="S3.SS4.p3.1.m1.2.2.4"><csymbol cd="ambiguous" id="S3.SS4.p3.1.m1.2.2.4.1.cmml" xref="S3.SS4.p3.1.m1.2.2.4">subscript</csymbol><ci id="S3.SS4.p3.1.m1.2.2.4.2.cmml" xref="S3.SS4.p3.1.m1.2.2.4.2">𝐷</ci><cn type="integer" id="S3.SS4.p3.1.m1.2.2.4.3.cmml" xref="S3.SS4.p3.1.m1.2.2.4.3">1</cn></apply><apply id="S3.SS4.p3.1.m1.2.2.2.cmml" xref="S3.SS4.p3.1.m1.2.2.2"><times id="S3.SS4.p3.1.m1.2.2.2.3.cmml" xref="S3.SS4.p3.1.m1.2.2.2.3"></times><ci id="S3.SS4.p3.1.m1.2.2.2.4.cmml" xref="S3.SS4.p3.1.m1.2.2.2.4">𝒩</ci><interval closure="open" id="S3.SS4.p3.1.m1.2.2.2.2.3.cmml" xref="S3.SS4.p3.1.m1.2.2.2.2.2"><apply id="S3.SS4.p3.1.m1.1.1.1.1.1.1.cmml" xref="S3.SS4.p3.1.m1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS4.p3.1.m1.1.1.1.1.1.1.1.cmml" xref="S3.SS4.p3.1.m1.1.1.1.1.1.1">subscript</csymbol><ci id="S3.SS4.p3.1.m1.1.1.1.1.1.1.2.cmml" xref="S3.SS4.p3.1.m1.1.1.1.1.1.1.2">𝜇</ci><cn type="integer" id="S3.SS4.p3.1.m1.1.1.1.1.1.1.3.cmml" xref="S3.SS4.p3.1.m1.1.1.1.1.1.1.3">1</cn></apply><apply id="S3.SS4.p3.1.m1.2.2.2.2.2.2.cmml" xref="S3.SS4.p3.1.m1.2.2.2.2.2.2"><csymbol cd="ambiguous" id="S3.SS4.p3.1.m1.2.2.2.2.2.2.1.cmml" xref="S3.SS4.p3.1.m1.2.2.2.2.2.2">subscript</csymbol><ci id="S3.SS4.p3.1.m1.2.2.2.2.2.2.2.cmml" xref="S3.SS4.p3.1.m1.2.2.2.2.2.2.2">Σ</ci><cn type="integer" id="S3.SS4.p3.1.m1.2.2.2.2.2.2.3.cmml" xref="S3.SS4.p3.1.m1.2.2.2.2.2.2.3">1</cn></apply></interval></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p3.1.m1.2c">D_{1}=\mathcal{N}\left(\mu_{1},\Sigma_{1}\right)</annotation></semantics></math> and <math id="S3.SS4.p3.2.m2.2" class="ltx_Math" alttext="D_{2}=\mathcal{N}\left(\mu_{2},\Sigma_{2}\right)" display="inline"><semantics id="S3.SS4.p3.2.m2.2a"><mrow id="S3.SS4.p3.2.m2.2.2" xref="S3.SS4.p3.2.m2.2.2.cmml"><msub id="S3.SS4.p3.2.m2.2.2.4" xref="S3.SS4.p3.2.m2.2.2.4.cmml"><mi id="S3.SS4.p3.2.m2.2.2.4.2" xref="S3.SS4.p3.2.m2.2.2.4.2.cmml">D</mi><mn id="S3.SS4.p3.2.m2.2.2.4.3" xref="S3.SS4.p3.2.m2.2.2.4.3.cmml">2</mn></msub><mo id="S3.SS4.p3.2.m2.2.2.3" xref="S3.SS4.p3.2.m2.2.2.3.cmml">=</mo><mrow id="S3.SS4.p3.2.m2.2.2.2" xref="S3.SS4.p3.2.m2.2.2.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS4.p3.2.m2.2.2.2.4" xref="S3.SS4.p3.2.m2.2.2.2.4.cmml">𝒩</mi><mo lspace="0em" rspace="0em" id="S3.SS4.p3.2.m2.2.2.2.3" xref="S3.SS4.p3.2.m2.2.2.2.3.cmml">​</mo><mrow id="S3.SS4.p3.2.m2.2.2.2.2.2" xref="S3.SS4.p3.2.m2.2.2.2.2.3.cmml"><mo id="S3.SS4.p3.2.m2.2.2.2.2.2.3" xref="S3.SS4.p3.2.m2.2.2.2.2.3.cmml">(</mo><msub id="S3.SS4.p3.2.m2.1.1.1.1.1.1" xref="S3.SS4.p3.2.m2.1.1.1.1.1.1.cmml"><mi id="S3.SS4.p3.2.m2.1.1.1.1.1.1.2" xref="S3.SS4.p3.2.m2.1.1.1.1.1.1.2.cmml">μ</mi><mn id="S3.SS4.p3.2.m2.1.1.1.1.1.1.3" xref="S3.SS4.p3.2.m2.1.1.1.1.1.1.3.cmml">2</mn></msub><mo id="S3.SS4.p3.2.m2.2.2.2.2.2.4" xref="S3.SS4.p3.2.m2.2.2.2.2.3.cmml">,</mo><msub id="S3.SS4.p3.2.m2.2.2.2.2.2.2" xref="S3.SS4.p3.2.m2.2.2.2.2.2.2.cmml"><mi mathvariant="normal" id="S3.SS4.p3.2.m2.2.2.2.2.2.2.2" xref="S3.SS4.p3.2.m2.2.2.2.2.2.2.2.cmml">Σ</mi><mn id="S3.SS4.p3.2.m2.2.2.2.2.2.2.3" xref="S3.SS4.p3.2.m2.2.2.2.2.2.2.3.cmml">2</mn></msub><mo id="S3.SS4.p3.2.m2.2.2.2.2.2.5" xref="S3.SS4.p3.2.m2.2.2.2.2.3.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS4.p3.2.m2.2b"><apply id="S3.SS4.p3.2.m2.2.2.cmml" xref="S3.SS4.p3.2.m2.2.2"><eq id="S3.SS4.p3.2.m2.2.2.3.cmml" xref="S3.SS4.p3.2.m2.2.2.3"></eq><apply id="S3.SS4.p3.2.m2.2.2.4.cmml" xref="S3.SS4.p3.2.m2.2.2.4"><csymbol cd="ambiguous" id="S3.SS4.p3.2.m2.2.2.4.1.cmml" xref="S3.SS4.p3.2.m2.2.2.4">subscript</csymbol><ci id="S3.SS4.p3.2.m2.2.2.4.2.cmml" xref="S3.SS4.p3.2.m2.2.2.4.2">𝐷</ci><cn type="integer" id="S3.SS4.p3.2.m2.2.2.4.3.cmml" xref="S3.SS4.p3.2.m2.2.2.4.3">2</cn></apply><apply id="S3.SS4.p3.2.m2.2.2.2.cmml" xref="S3.SS4.p3.2.m2.2.2.2"><times id="S3.SS4.p3.2.m2.2.2.2.3.cmml" xref="S3.SS4.p3.2.m2.2.2.2.3"></times><ci id="S3.SS4.p3.2.m2.2.2.2.4.cmml" xref="S3.SS4.p3.2.m2.2.2.2.4">𝒩</ci><interval closure="open" id="S3.SS4.p3.2.m2.2.2.2.2.3.cmml" xref="S3.SS4.p3.2.m2.2.2.2.2.2"><apply id="S3.SS4.p3.2.m2.1.1.1.1.1.1.cmml" xref="S3.SS4.p3.2.m2.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS4.p3.2.m2.1.1.1.1.1.1.1.cmml" xref="S3.SS4.p3.2.m2.1.1.1.1.1.1">subscript</csymbol><ci id="S3.SS4.p3.2.m2.1.1.1.1.1.1.2.cmml" xref="S3.SS4.p3.2.m2.1.1.1.1.1.1.2">𝜇</ci><cn type="integer" id="S3.SS4.p3.2.m2.1.1.1.1.1.1.3.cmml" xref="S3.SS4.p3.2.m2.1.1.1.1.1.1.3">2</cn></apply><apply id="S3.SS4.p3.2.m2.2.2.2.2.2.2.cmml" xref="S3.SS4.p3.2.m2.2.2.2.2.2.2"><csymbol cd="ambiguous" id="S3.SS4.p3.2.m2.2.2.2.2.2.2.1.cmml" xref="S3.SS4.p3.2.m2.2.2.2.2.2.2">subscript</csymbol><ci id="S3.SS4.p3.2.m2.2.2.2.2.2.2.2.cmml" xref="S3.SS4.p3.2.m2.2.2.2.2.2.2.2">Σ</ci><cn type="integer" id="S3.SS4.p3.2.m2.2.2.2.2.2.2.3.cmml" xref="S3.SS4.p3.2.m2.2.2.2.2.2.2.3">2</cn></apply></interval></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p3.2.m2.2c">D_{2}=\mathcal{N}\left(\mu_{2},\Sigma_{2}\right)</annotation></semantics></math>, can be determined as:</p>
<table id="S3.E2" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S3.E2.m1.2" class="ltx_Math" alttext="d^{2}(D_{1},D_{2})=||\mu_{1}-\mu_{2}||_{2}^{2}+\operatorname{Tr}\left(\Sigma_{1}+\Sigma_{2}-2\left(\Sigma_{1}\Sigma_{2}\right)^{1/2}\right)." display="block"><semantics id="S3.E2.m1.2a"><mrow id="S3.E2.m1.2.2.1" xref="S3.E2.m1.2.2.1.1.cmml"><mrow id="S3.E2.m1.2.2.1.1" xref="S3.E2.m1.2.2.1.1.cmml"><mrow id="S3.E2.m1.2.2.1.1.2" xref="S3.E2.m1.2.2.1.1.2.cmml"><msup id="S3.E2.m1.2.2.1.1.2.4" xref="S3.E2.m1.2.2.1.1.2.4.cmml"><mi id="S3.E2.m1.2.2.1.1.2.4.2" xref="S3.E2.m1.2.2.1.1.2.4.2.cmml">d</mi><mn id="S3.E2.m1.2.2.1.1.2.4.3" xref="S3.E2.m1.2.2.1.1.2.4.3.cmml">2</mn></msup><mo lspace="0em" rspace="0em" id="S3.E2.m1.2.2.1.1.2.3" xref="S3.E2.m1.2.2.1.1.2.3.cmml">​</mo><mrow id="S3.E2.m1.2.2.1.1.2.2.2" xref="S3.E2.m1.2.2.1.1.2.2.3.cmml"><mo stretchy="false" id="S3.E2.m1.2.2.1.1.2.2.2.3" xref="S3.E2.m1.2.2.1.1.2.2.3.cmml">(</mo><msub id="S3.E2.m1.2.2.1.1.1.1.1.1" xref="S3.E2.m1.2.2.1.1.1.1.1.1.cmml"><mi id="S3.E2.m1.2.2.1.1.1.1.1.1.2" xref="S3.E2.m1.2.2.1.1.1.1.1.1.2.cmml">D</mi><mn id="S3.E2.m1.2.2.1.1.1.1.1.1.3" xref="S3.E2.m1.2.2.1.1.1.1.1.1.3.cmml">1</mn></msub><mo id="S3.E2.m1.2.2.1.1.2.2.2.4" xref="S3.E2.m1.2.2.1.1.2.2.3.cmml">,</mo><msub id="S3.E2.m1.2.2.1.1.2.2.2.2" xref="S3.E2.m1.2.2.1.1.2.2.2.2.cmml"><mi id="S3.E2.m1.2.2.1.1.2.2.2.2.2" xref="S3.E2.m1.2.2.1.1.2.2.2.2.2.cmml">D</mi><mn id="S3.E2.m1.2.2.1.1.2.2.2.2.3" xref="S3.E2.m1.2.2.1.1.2.2.2.2.3.cmml">2</mn></msub><mo stretchy="false" id="S3.E2.m1.2.2.1.1.2.2.2.5" xref="S3.E2.m1.2.2.1.1.2.2.3.cmml">)</mo></mrow></mrow><mo id="S3.E2.m1.2.2.1.1.5" xref="S3.E2.m1.2.2.1.1.5.cmml">=</mo><mrow id="S3.E2.m1.2.2.1.1.4" xref="S3.E2.m1.2.2.1.1.4.cmml"><msubsup id="S3.E2.m1.2.2.1.1.3.1" xref="S3.E2.m1.2.2.1.1.3.1.cmml"><mrow id="S3.E2.m1.2.2.1.1.3.1.1.1.1" xref="S3.E2.m1.2.2.1.1.3.1.1.1.2.cmml"><mo stretchy="false" id="S3.E2.m1.2.2.1.1.3.1.1.1.1.2" xref="S3.E2.m1.2.2.1.1.3.1.1.1.2.1.cmml">‖</mo><mrow id="S3.E2.m1.2.2.1.1.3.1.1.1.1.1" xref="S3.E2.m1.2.2.1.1.3.1.1.1.1.1.cmml"><msub id="S3.E2.m1.2.2.1.1.3.1.1.1.1.1.2" xref="S3.E2.m1.2.2.1.1.3.1.1.1.1.1.2.cmml"><mi id="S3.E2.m1.2.2.1.1.3.1.1.1.1.1.2.2" xref="S3.E2.m1.2.2.1.1.3.1.1.1.1.1.2.2.cmml">μ</mi><mn id="S3.E2.m1.2.2.1.1.3.1.1.1.1.1.2.3" xref="S3.E2.m1.2.2.1.1.3.1.1.1.1.1.2.3.cmml">1</mn></msub><mo id="S3.E2.m1.2.2.1.1.3.1.1.1.1.1.1" xref="S3.E2.m1.2.2.1.1.3.1.1.1.1.1.1.cmml">−</mo><msub id="S3.E2.m1.2.2.1.1.3.1.1.1.1.1.3" xref="S3.E2.m1.2.2.1.1.3.1.1.1.1.1.3.cmml"><mi id="S3.E2.m1.2.2.1.1.3.1.1.1.1.1.3.2" xref="S3.E2.m1.2.2.1.1.3.1.1.1.1.1.3.2.cmml">μ</mi><mn id="S3.E2.m1.2.2.1.1.3.1.1.1.1.1.3.3" xref="S3.E2.m1.2.2.1.1.3.1.1.1.1.1.3.3.cmml">2</mn></msub></mrow><mo stretchy="false" id="S3.E2.m1.2.2.1.1.3.1.1.1.1.3" xref="S3.E2.m1.2.2.1.1.3.1.1.1.2.1.cmml">‖</mo></mrow><mn id="S3.E2.m1.2.2.1.1.3.1.1.3" xref="S3.E2.m1.2.2.1.1.3.1.1.3.cmml">2</mn><mn id="S3.E2.m1.2.2.1.1.3.1.3" xref="S3.E2.m1.2.2.1.1.3.1.3.cmml">2</mn></msubsup><mo id="S3.E2.m1.2.2.1.1.4.3" xref="S3.E2.m1.2.2.1.1.4.3.cmml">+</mo><mrow id="S3.E2.m1.2.2.1.1.4.2.1" xref="S3.E2.m1.2.2.1.1.4.2.2.cmml"><mi id="S3.E2.m1.1.1" xref="S3.E2.m1.1.1.cmml">Tr</mi><mo id="S3.E2.m1.2.2.1.1.4.2.1a" xref="S3.E2.m1.2.2.1.1.4.2.2.cmml">⁡</mo><mrow id="S3.E2.m1.2.2.1.1.4.2.1.1" xref="S3.E2.m1.2.2.1.1.4.2.2.cmml"><mo id="S3.E2.m1.2.2.1.1.4.2.1.1.2" xref="S3.E2.m1.2.2.1.1.4.2.2.cmml">(</mo><mrow id="S3.E2.m1.2.2.1.1.4.2.1.1.1" xref="S3.E2.m1.2.2.1.1.4.2.1.1.1.cmml"><mrow id="S3.E2.m1.2.2.1.1.4.2.1.1.1.3" xref="S3.E2.m1.2.2.1.1.4.2.1.1.1.3.cmml"><msub id="S3.E2.m1.2.2.1.1.4.2.1.1.1.3.2" xref="S3.E2.m1.2.2.1.1.4.2.1.1.1.3.2.cmml"><mi mathvariant="normal" id="S3.E2.m1.2.2.1.1.4.2.1.1.1.3.2.2" xref="S3.E2.m1.2.2.1.1.4.2.1.1.1.3.2.2.cmml">Σ</mi><mn id="S3.E2.m1.2.2.1.1.4.2.1.1.1.3.2.3" xref="S3.E2.m1.2.2.1.1.4.2.1.1.1.3.2.3.cmml">1</mn></msub><mo id="S3.E2.m1.2.2.1.1.4.2.1.1.1.3.1" xref="S3.E2.m1.2.2.1.1.4.2.1.1.1.3.1.cmml">+</mo><msub id="S3.E2.m1.2.2.1.1.4.2.1.1.1.3.3" xref="S3.E2.m1.2.2.1.1.4.2.1.1.1.3.3.cmml"><mi mathvariant="normal" id="S3.E2.m1.2.2.1.1.4.2.1.1.1.3.3.2" xref="S3.E2.m1.2.2.1.1.4.2.1.1.1.3.3.2.cmml">Σ</mi><mn id="S3.E2.m1.2.2.1.1.4.2.1.1.1.3.3.3" xref="S3.E2.m1.2.2.1.1.4.2.1.1.1.3.3.3.cmml">2</mn></msub></mrow><mo id="S3.E2.m1.2.2.1.1.4.2.1.1.1.2" xref="S3.E2.m1.2.2.1.1.4.2.1.1.1.2.cmml">−</mo><mrow id="S3.E2.m1.2.2.1.1.4.2.1.1.1.1" xref="S3.E2.m1.2.2.1.1.4.2.1.1.1.1.cmml"><mn id="S3.E2.m1.2.2.1.1.4.2.1.1.1.1.3" xref="S3.E2.m1.2.2.1.1.4.2.1.1.1.1.3.cmml">2</mn><mo lspace="0em" rspace="0em" id="S3.E2.m1.2.2.1.1.4.2.1.1.1.1.2" xref="S3.E2.m1.2.2.1.1.4.2.1.1.1.1.2.cmml">​</mo><msup id="S3.E2.m1.2.2.1.1.4.2.1.1.1.1.1" xref="S3.E2.m1.2.2.1.1.4.2.1.1.1.1.1.cmml"><mrow id="S3.E2.m1.2.2.1.1.4.2.1.1.1.1.1.1.1" xref="S3.E2.m1.2.2.1.1.4.2.1.1.1.1.1.1.1.1.cmml"><mo id="S3.E2.m1.2.2.1.1.4.2.1.1.1.1.1.1.1.2" xref="S3.E2.m1.2.2.1.1.4.2.1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="S3.E2.m1.2.2.1.1.4.2.1.1.1.1.1.1.1.1" xref="S3.E2.m1.2.2.1.1.4.2.1.1.1.1.1.1.1.1.cmml"><msub id="S3.E2.m1.2.2.1.1.4.2.1.1.1.1.1.1.1.1.2" xref="S3.E2.m1.2.2.1.1.4.2.1.1.1.1.1.1.1.1.2.cmml"><mi mathvariant="normal" id="S3.E2.m1.2.2.1.1.4.2.1.1.1.1.1.1.1.1.2.2" xref="S3.E2.m1.2.2.1.1.4.2.1.1.1.1.1.1.1.1.2.2.cmml">Σ</mi><mn id="S3.E2.m1.2.2.1.1.4.2.1.1.1.1.1.1.1.1.2.3" xref="S3.E2.m1.2.2.1.1.4.2.1.1.1.1.1.1.1.1.2.3.cmml">1</mn></msub><mo lspace="0em" rspace="0em" id="S3.E2.m1.2.2.1.1.4.2.1.1.1.1.1.1.1.1.1" xref="S3.E2.m1.2.2.1.1.4.2.1.1.1.1.1.1.1.1.1.cmml">​</mo><msub id="S3.E2.m1.2.2.1.1.4.2.1.1.1.1.1.1.1.1.3" xref="S3.E2.m1.2.2.1.1.4.2.1.1.1.1.1.1.1.1.3.cmml"><mi mathvariant="normal" id="S3.E2.m1.2.2.1.1.4.2.1.1.1.1.1.1.1.1.3.2" xref="S3.E2.m1.2.2.1.1.4.2.1.1.1.1.1.1.1.1.3.2.cmml">Σ</mi><mn id="S3.E2.m1.2.2.1.1.4.2.1.1.1.1.1.1.1.1.3.3" xref="S3.E2.m1.2.2.1.1.4.2.1.1.1.1.1.1.1.1.3.3.cmml">2</mn></msub></mrow><mo id="S3.E2.m1.2.2.1.1.4.2.1.1.1.1.1.1.1.3" xref="S3.E2.m1.2.2.1.1.4.2.1.1.1.1.1.1.1.1.cmml">)</mo></mrow><mrow id="S3.E2.m1.2.2.1.1.4.2.1.1.1.1.1.3" xref="S3.E2.m1.2.2.1.1.4.2.1.1.1.1.1.3.cmml"><mn id="S3.E2.m1.2.2.1.1.4.2.1.1.1.1.1.3.2" xref="S3.E2.m1.2.2.1.1.4.2.1.1.1.1.1.3.2.cmml">1</mn><mo id="S3.E2.m1.2.2.1.1.4.2.1.1.1.1.1.3.1" xref="S3.E2.m1.2.2.1.1.4.2.1.1.1.1.1.3.1.cmml">/</mo><mn id="S3.E2.m1.2.2.1.1.4.2.1.1.1.1.1.3.3" xref="S3.E2.m1.2.2.1.1.4.2.1.1.1.1.1.3.3.cmml">2</mn></mrow></msup></mrow></mrow><mo id="S3.E2.m1.2.2.1.1.4.2.1.1.3" xref="S3.E2.m1.2.2.1.1.4.2.2.cmml">)</mo></mrow></mrow></mrow></mrow><mo lspace="0em" id="S3.E2.m1.2.2.1.2" xref="S3.E2.m1.2.2.1.1.cmml">.</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E2.m1.2b"><apply id="S3.E2.m1.2.2.1.1.cmml" xref="S3.E2.m1.2.2.1"><eq id="S3.E2.m1.2.2.1.1.5.cmml" xref="S3.E2.m1.2.2.1.1.5"></eq><apply id="S3.E2.m1.2.2.1.1.2.cmml" xref="S3.E2.m1.2.2.1.1.2"><times id="S3.E2.m1.2.2.1.1.2.3.cmml" xref="S3.E2.m1.2.2.1.1.2.3"></times><apply id="S3.E2.m1.2.2.1.1.2.4.cmml" xref="S3.E2.m1.2.2.1.1.2.4"><csymbol cd="ambiguous" id="S3.E2.m1.2.2.1.1.2.4.1.cmml" xref="S3.E2.m1.2.2.1.1.2.4">superscript</csymbol><ci id="S3.E2.m1.2.2.1.1.2.4.2.cmml" xref="S3.E2.m1.2.2.1.1.2.4.2">𝑑</ci><cn type="integer" id="S3.E2.m1.2.2.1.1.2.4.3.cmml" xref="S3.E2.m1.2.2.1.1.2.4.3">2</cn></apply><interval closure="open" id="S3.E2.m1.2.2.1.1.2.2.3.cmml" xref="S3.E2.m1.2.2.1.1.2.2.2"><apply id="S3.E2.m1.2.2.1.1.1.1.1.1.cmml" xref="S3.E2.m1.2.2.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E2.m1.2.2.1.1.1.1.1.1.1.cmml" xref="S3.E2.m1.2.2.1.1.1.1.1.1">subscript</csymbol><ci id="S3.E2.m1.2.2.1.1.1.1.1.1.2.cmml" xref="S3.E2.m1.2.2.1.1.1.1.1.1.2">𝐷</ci><cn type="integer" id="S3.E2.m1.2.2.1.1.1.1.1.1.3.cmml" xref="S3.E2.m1.2.2.1.1.1.1.1.1.3">1</cn></apply><apply id="S3.E2.m1.2.2.1.1.2.2.2.2.cmml" xref="S3.E2.m1.2.2.1.1.2.2.2.2"><csymbol cd="ambiguous" id="S3.E2.m1.2.2.1.1.2.2.2.2.1.cmml" xref="S3.E2.m1.2.2.1.1.2.2.2.2">subscript</csymbol><ci id="S3.E2.m1.2.2.1.1.2.2.2.2.2.cmml" xref="S3.E2.m1.2.2.1.1.2.2.2.2.2">𝐷</ci><cn type="integer" id="S3.E2.m1.2.2.1.1.2.2.2.2.3.cmml" xref="S3.E2.m1.2.2.1.1.2.2.2.2.3">2</cn></apply></interval></apply><apply id="S3.E2.m1.2.2.1.1.4.cmml" xref="S3.E2.m1.2.2.1.1.4"><plus id="S3.E2.m1.2.2.1.1.4.3.cmml" xref="S3.E2.m1.2.2.1.1.4.3"></plus><apply id="S3.E2.m1.2.2.1.1.3.1.cmml" xref="S3.E2.m1.2.2.1.1.3.1"><csymbol cd="ambiguous" id="S3.E2.m1.2.2.1.1.3.1.2.cmml" xref="S3.E2.m1.2.2.1.1.3.1">superscript</csymbol><apply id="S3.E2.m1.2.2.1.1.3.1.1.cmml" xref="S3.E2.m1.2.2.1.1.3.1"><csymbol cd="ambiguous" id="S3.E2.m1.2.2.1.1.3.1.1.2.cmml" xref="S3.E2.m1.2.2.1.1.3.1">subscript</csymbol><apply id="S3.E2.m1.2.2.1.1.3.1.1.1.2.cmml" xref="S3.E2.m1.2.2.1.1.3.1.1.1.1"><csymbol cd="latexml" id="S3.E2.m1.2.2.1.1.3.1.1.1.2.1.cmml" xref="S3.E2.m1.2.2.1.1.3.1.1.1.1.2">norm</csymbol><apply id="S3.E2.m1.2.2.1.1.3.1.1.1.1.1.cmml" xref="S3.E2.m1.2.2.1.1.3.1.1.1.1.1"><minus id="S3.E2.m1.2.2.1.1.3.1.1.1.1.1.1.cmml" xref="S3.E2.m1.2.2.1.1.3.1.1.1.1.1.1"></minus><apply id="S3.E2.m1.2.2.1.1.3.1.1.1.1.1.2.cmml" xref="S3.E2.m1.2.2.1.1.3.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.E2.m1.2.2.1.1.3.1.1.1.1.1.2.1.cmml" xref="S3.E2.m1.2.2.1.1.3.1.1.1.1.1.2">subscript</csymbol><ci id="S3.E2.m1.2.2.1.1.3.1.1.1.1.1.2.2.cmml" xref="S3.E2.m1.2.2.1.1.3.1.1.1.1.1.2.2">𝜇</ci><cn type="integer" id="S3.E2.m1.2.2.1.1.3.1.1.1.1.1.2.3.cmml" xref="S3.E2.m1.2.2.1.1.3.1.1.1.1.1.2.3">1</cn></apply><apply id="S3.E2.m1.2.2.1.1.3.1.1.1.1.1.3.cmml" xref="S3.E2.m1.2.2.1.1.3.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.E2.m1.2.2.1.1.3.1.1.1.1.1.3.1.cmml" xref="S3.E2.m1.2.2.1.1.3.1.1.1.1.1.3">subscript</csymbol><ci id="S3.E2.m1.2.2.1.1.3.1.1.1.1.1.3.2.cmml" xref="S3.E2.m1.2.2.1.1.3.1.1.1.1.1.3.2">𝜇</ci><cn type="integer" id="S3.E2.m1.2.2.1.1.3.1.1.1.1.1.3.3.cmml" xref="S3.E2.m1.2.2.1.1.3.1.1.1.1.1.3.3">2</cn></apply></apply></apply><cn type="integer" id="S3.E2.m1.2.2.1.1.3.1.1.3.cmml" xref="S3.E2.m1.2.2.1.1.3.1.1.3">2</cn></apply><cn type="integer" id="S3.E2.m1.2.2.1.1.3.1.3.cmml" xref="S3.E2.m1.2.2.1.1.3.1.3">2</cn></apply><apply id="S3.E2.m1.2.2.1.1.4.2.2.cmml" xref="S3.E2.m1.2.2.1.1.4.2.1"><ci id="S3.E2.m1.1.1.cmml" xref="S3.E2.m1.1.1">Tr</ci><apply id="S3.E2.m1.2.2.1.1.4.2.1.1.1.cmml" xref="S3.E2.m1.2.2.1.1.4.2.1.1.1"><minus id="S3.E2.m1.2.2.1.1.4.2.1.1.1.2.cmml" xref="S3.E2.m1.2.2.1.1.4.2.1.1.1.2"></minus><apply id="S3.E2.m1.2.2.1.1.4.2.1.1.1.3.cmml" xref="S3.E2.m1.2.2.1.1.4.2.1.1.1.3"><plus id="S3.E2.m1.2.2.1.1.4.2.1.1.1.3.1.cmml" xref="S3.E2.m1.2.2.1.1.4.2.1.1.1.3.1"></plus><apply id="S3.E2.m1.2.2.1.1.4.2.1.1.1.3.2.cmml" xref="S3.E2.m1.2.2.1.1.4.2.1.1.1.3.2"><csymbol cd="ambiguous" id="S3.E2.m1.2.2.1.1.4.2.1.1.1.3.2.1.cmml" xref="S3.E2.m1.2.2.1.1.4.2.1.1.1.3.2">subscript</csymbol><ci id="S3.E2.m1.2.2.1.1.4.2.1.1.1.3.2.2.cmml" xref="S3.E2.m1.2.2.1.1.4.2.1.1.1.3.2.2">Σ</ci><cn type="integer" id="S3.E2.m1.2.2.1.1.4.2.1.1.1.3.2.3.cmml" xref="S3.E2.m1.2.2.1.1.4.2.1.1.1.3.2.3">1</cn></apply><apply id="S3.E2.m1.2.2.1.1.4.2.1.1.1.3.3.cmml" xref="S3.E2.m1.2.2.1.1.4.2.1.1.1.3.3"><csymbol cd="ambiguous" id="S3.E2.m1.2.2.1.1.4.2.1.1.1.3.3.1.cmml" xref="S3.E2.m1.2.2.1.1.4.2.1.1.1.3.3">subscript</csymbol><ci id="S3.E2.m1.2.2.1.1.4.2.1.1.1.3.3.2.cmml" xref="S3.E2.m1.2.2.1.1.4.2.1.1.1.3.3.2">Σ</ci><cn type="integer" id="S3.E2.m1.2.2.1.1.4.2.1.1.1.3.3.3.cmml" xref="S3.E2.m1.2.2.1.1.4.2.1.1.1.3.3.3">2</cn></apply></apply><apply id="S3.E2.m1.2.2.1.1.4.2.1.1.1.1.cmml" xref="S3.E2.m1.2.2.1.1.4.2.1.1.1.1"><times id="S3.E2.m1.2.2.1.1.4.2.1.1.1.1.2.cmml" xref="S3.E2.m1.2.2.1.1.4.2.1.1.1.1.2"></times><cn type="integer" id="S3.E2.m1.2.2.1.1.4.2.1.1.1.1.3.cmml" xref="S3.E2.m1.2.2.1.1.4.2.1.1.1.1.3">2</cn><apply id="S3.E2.m1.2.2.1.1.4.2.1.1.1.1.1.cmml" xref="S3.E2.m1.2.2.1.1.4.2.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E2.m1.2.2.1.1.4.2.1.1.1.1.1.2.cmml" xref="S3.E2.m1.2.2.1.1.4.2.1.1.1.1.1">superscript</csymbol><apply id="S3.E2.m1.2.2.1.1.4.2.1.1.1.1.1.1.1.1.cmml" xref="S3.E2.m1.2.2.1.1.4.2.1.1.1.1.1.1.1"><times id="S3.E2.m1.2.2.1.1.4.2.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E2.m1.2.2.1.1.4.2.1.1.1.1.1.1.1.1.1"></times><apply id="S3.E2.m1.2.2.1.1.4.2.1.1.1.1.1.1.1.1.2.cmml" xref="S3.E2.m1.2.2.1.1.4.2.1.1.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.E2.m1.2.2.1.1.4.2.1.1.1.1.1.1.1.1.2.1.cmml" xref="S3.E2.m1.2.2.1.1.4.2.1.1.1.1.1.1.1.1.2">subscript</csymbol><ci id="S3.E2.m1.2.2.1.1.4.2.1.1.1.1.1.1.1.1.2.2.cmml" xref="S3.E2.m1.2.2.1.1.4.2.1.1.1.1.1.1.1.1.2.2">Σ</ci><cn type="integer" id="S3.E2.m1.2.2.1.1.4.2.1.1.1.1.1.1.1.1.2.3.cmml" xref="S3.E2.m1.2.2.1.1.4.2.1.1.1.1.1.1.1.1.2.3">1</cn></apply><apply id="S3.E2.m1.2.2.1.1.4.2.1.1.1.1.1.1.1.1.3.cmml" xref="S3.E2.m1.2.2.1.1.4.2.1.1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.E2.m1.2.2.1.1.4.2.1.1.1.1.1.1.1.1.3.1.cmml" xref="S3.E2.m1.2.2.1.1.4.2.1.1.1.1.1.1.1.1.3">subscript</csymbol><ci id="S3.E2.m1.2.2.1.1.4.2.1.1.1.1.1.1.1.1.3.2.cmml" xref="S3.E2.m1.2.2.1.1.4.2.1.1.1.1.1.1.1.1.3.2">Σ</ci><cn type="integer" id="S3.E2.m1.2.2.1.1.4.2.1.1.1.1.1.1.1.1.3.3.cmml" xref="S3.E2.m1.2.2.1.1.4.2.1.1.1.1.1.1.1.1.3.3">2</cn></apply></apply><apply id="S3.E2.m1.2.2.1.1.4.2.1.1.1.1.1.3.cmml" xref="S3.E2.m1.2.2.1.1.4.2.1.1.1.1.1.3"><divide id="S3.E2.m1.2.2.1.1.4.2.1.1.1.1.1.3.1.cmml" xref="S3.E2.m1.2.2.1.1.4.2.1.1.1.1.1.3.1"></divide><cn type="integer" id="S3.E2.m1.2.2.1.1.4.2.1.1.1.1.1.3.2.cmml" xref="S3.E2.m1.2.2.1.1.4.2.1.1.1.1.1.3.2">1</cn><cn type="integer" id="S3.E2.m1.2.2.1.1.4.2.1.1.1.1.1.3.3.cmml" xref="S3.E2.m1.2.2.1.1.4.2.1.1.1.1.1.3.3">2</cn></apply></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E2.m1.2c">d^{2}(D_{1},D_{2})=||\mu_{1}-\mu_{2}||_{2}^{2}+\operatorname{Tr}\left(\Sigma_{1}+\Sigma_{2}-2\left(\Sigma_{1}\Sigma_{2}\right)^{1/2}\right).</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(2)</span></td>
</tr></tbody>
</table>
</div>
<div id="S3.SS4.p4" class="ltx_para">
<p id="S3.SS4.p4.6" class="ltx_p">For a given set of clients <math id="S3.SS4.p4.1.m1.3" class="ltx_Math" alttext="\mathcal{K}=\{1,\ldots,K\}" display="inline"><semantics id="S3.SS4.p4.1.m1.3a"><mrow id="S3.SS4.p4.1.m1.3.4" xref="S3.SS4.p4.1.m1.3.4.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS4.p4.1.m1.3.4.2" xref="S3.SS4.p4.1.m1.3.4.2.cmml">𝒦</mi><mo id="S3.SS4.p4.1.m1.3.4.1" xref="S3.SS4.p4.1.m1.3.4.1.cmml">=</mo><mrow id="S3.SS4.p4.1.m1.3.4.3.2" xref="S3.SS4.p4.1.m1.3.4.3.1.cmml"><mo stretchy="false" id="S3.SS4.p4.1.m1.3.4.3.2.1" xref="S3.SS4.p4.1.m1.3.4.3.1.cmml">{</mo><mn id="S3.SS4.p4.1.m1.1.1" xref="S3.SS4.p4.1.m1.1.1.cmml">1</mn><mo id="S3.SS4.p4.1.m1.3.4.3.2.2" xref="S3.SS4.p4.1.m1.3.4.3.1.cmml">,</mo><mi mathvariant="normal" id="S3.SS4.p4.1.m1.2.2" xref="S3.SS4.p4.1.m1.2.2.cmml">…</mi><mo id="S3.SS4.p4.1.m1.3.4.3.2.3" xref="S3.SS4.p4.1.m1.3.4.3.1.cmml">,</mo><mi id="S3.SS4.p4.1.m1.3.3" xref="S3.SS4.p4.1.m1.3.3.cmml">K</mi><mo stretchy="false" id="S3.SS4.p4.1.m1.3.4.3.2.4" xref="S3.SS4.p4.1.m1.3.4.3.1.cmml">}</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS4.p4.1.m1.3b"><apply id="S3.SS4.p4.1.m1.3.4.cmml" xref="S3.SS4.p4.1.m1.3.4"><eq id="S3.SS4.p4.1.m1.3.4.1.cmml" xref="S3.SS4.p4.1.m1.3.4.1"></eq><ci id="S3.SS4.p4.1.m1.3.4.2.cmml" xref="S3.SS4.p4.1.m1.3.4.2">𝒦</ci><set id="S3.SS4.p4.1.m1.3.4.3.1.cmml" xref="S3.SS4.p4.1.m1.3.4.3.2"><cn type="integer" id="S3.SS4.p4.1.m1.1.1.cmml" xref="S3.SS4.p4.1.m1.1.1">1</cn><ci id="S3.SS4.p4.1.m1.2.2.cmml" xref="S3.SS4.p4.1.m1.2.2">…</ci><ci id="S3.SS4.p4.1.m1.3.3.cmml" xref="S3.SS4.p4.1.m1.3.3">𝐾</ci></set></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p4.1.m1.3c">\mathcal{K}=\{1,\ldots,K\}</annotation></semantics></math>, we are interested in measuring the overall level of heterogeneity, and so we quantify this heterogeneity of clients by determining the distance from any given client to all other clients in their embeddings.
We determine sample mean, <math id="S3.SS4.p4.2.m2.1" class="ltx_Math" alttext="\mu_{k}" display="inline"><semantics id="S3.SS4.p4.2.m2.1a"><msub id="S3.SS4.p4.2.m2.1.1" xref="S3.SS4.p4.2.m2.1.1.cmml"><mi id="S3.SS4.p4.2.m2.1.1.2" xref="S3.SS4.p4.2.m2.1.1.2.cmml">μ</mi><mi id="S3.SS4.p4.2.m2.1.1.3" xref="S3.SS4.p4.2.m2.1.1.3.cmml">k</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS4.p4.2.m2.1b"><apply id="S3.SS4.p4.2.m2.1.1.cmml" xref="S3.SS4.p4.2.m2.1.1"><csymbol cd="ambiguous" id="S3.SS4.p4.2.m2.1.1.1.cmml" xref="S3.SS4.p4.2.m2.1.1">subscript</csymbol><ci id="S3.SS4.p4.2.m2.1.1.2.cmml" xref="S3.SS4.p4.2.m2.1.1.2">𝜇</ci><ci id="S3.SS4.p4.2.m2.1.1.3.cmml" xref="S3.SS4.p4.2.m2.1.1.3">𝑘</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p4.2.m2.1c">\mu_{k}</annotation></semantics></math>, and covariance, <math id="S3.SS4.p4.3.m3.1" class="ltx_Math" alttext="\Sigma_{k}" display="inline"><semantics id="S3.SS4.p4.3.m3.1a"><msub id="S3.SS4.p4.3.m3.1.1" xref="S3.SS4.p4.3.m3.1.1.cmml"><mi mathvariant="normal" id="S3.SS4.p4.3.m3.1.1.2" xref="S3.SS4.p4.3.m3.1.1.2.cmml">Σ</mi><mi id="S3.SS4.p4.3.m3.1.1.3" xref="S3.SS4.p4.3.m3.1.1.3.cmml">k</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS4.p4.3.m3.1b"><apply id="S3.SS4.p4.3.m3.1.1.cmml" xref="S3.SS4.p4.3.m3.1.1"><csymbol cd="ambiguous" id="S3.SS4.p4.3.m3.1.1.1.cmml" xref="S3.SS4.p4.3.m3.1.1">subscript</csymbol><ci id="S3.SS4.p4.3.m3.1.1.2.cmml" xref="S3.SS4.p4.3.m3.1.1.2">Σ</ci><ci id="S3.SS4.p4.3.m3.1.1.3.cmml" xref="S3.SS4.p4.3.m3.1.1.3">𝑘</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p4.3.m3.1c">\Sigma_{k}</annotation></semantics></math>, of the embeddings for both the client-specific data (thus assuming <math id="S3.SS4.p4.4.m4.2" class="ltx_Math" alttext="\mathbf{z}_{m}^{k}\sim D_{k}=\mathcal{N}\left(\mu_{k},\Sigma_{k}\right)" display="inline"><semantics id="S3.SS4.p4.4.m4.2a"><mrow id="S3.SS4.p4.4.m4.2.2" xref="S3.SS4.p4.4.m4.2.2.cmml"><msubsup id="S3.SS4.p4.4.m4.2.2.4" xref="S3.SS4.p4.4.m4.2.2.4.cmml"><mi id="S3.SS4.p4.4.m4.2.2.4.2.2" xref="S3.SS4.p4.4.m4.2.2.4.2.2.cmml">𝐳</mi><mi id="S3.SS4.p4.4.m4.2.2.4.2.3" xref="S3.SS4.p4.4.m4.2.2.4.2.3.cmml">m</mi><mi id="S3.SS4.p4.4.m4.2.2.4.3" xref="S3.SS4.p4.4.m4.2.2.4.3.cmml">k</mi></msubsup><mo id="S3.SS4.p4.4.m4.2.2.5" xref="S3.SS4.p4.4.m4.2.2.5.cmml">∼</mo><msub id="S3.SS4.p4.4.m4.2.2.6" xref="S3.SS4.p4.4.m4.2.2.6.cmml"><mi id="S3.SS4.p4.4.m4.2.2.6.2" xref="S3.SS4.p4.4.m4.2.2.6.2.cmml">D</mi><mi id="S3.SS4.p4.4.m4.2.2.6.3" xref="S3.SS4.p4.4.m4.2.2.6.3.cmml">k</mi></msub><mo id="S3.SS4.p4.4.m4.2.2.7" xref="S3.SS4.p4.4.m4.2.2.7.cmml">=</mo><mrow id="S3.SS4.p4.4.m4.2.2.2" xref="S3.SS4.p4.4.m4.2.2.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS4.p4.4.m4.2.2.2.4" xref="S3.SS4.p4.4.m4.2.2.2.4.cmml">𝒩</mi><mo lspace="0em" rspace="0em" id="S3.SS4.p4.4.m4.2.2.2.3" xref="S3.SS4.p4.4.m4.2.2.2.3.cmml">​</mo><mrow id="S3.SS4.p4.4.m4.2.2.2.2.2" xref="S3.SS4.p4.4.m4.2.2.2.2.3.cmml"><mo id="S3.SS4.p4.4.m4.2.2.2.2.2.3" xref="S3.SS4.p4.4.m4.2.2.2.2.3.cmml">(</mo><msub id="S3.SS4.p4.4.m4.1.1.1.1.1.1" xref="S3.SS4.p4.4.m4.1.1.1.1.1.1.cmml"><mi id="S3.SS4.p4.4.m4.1.1.1.1.1.1.2" xref="S3.SS4.p4.4.m4.1.1.1.1.1.1.2.cmml">μ</mi><mi id="S3.SS4.p4.4.m4.1.1.1.1.1.1.3" xref="S3.SS4.p4.4.m4.1.1.1.1.1.1.3.cmml">k</mi></msub><mo id="S3.SS4.p4.4.m4.2.2.2.2.2.4" xref="S3.SS4.p4.4.m4.2.2.2.2.3.cmml">,</mo><msub id="S3.SS4.p4.4.m4.2.2.2.2.2.2" xref="S3.SS4.p4.4.m4.2.2.2.2.2.2.cmml"><mi mathvariant="normal" id="S3.SS4.p4.4.m4.2.2.2.2.2.2.2" xref="S3.SS4.p4.4.m4.2.2.2.2.2.2.2.cmml">Σ</mi><mi id="S3.SS4.p4.4.m4.2.2.2.2.2.2.3" xref="S3.SS4.p4.4.m4.2.2.2.2.2.2.3.cmml">k</mi></msub><mo id="S3.SS4.p4.4.m4.2.2.2.2.2.5" xref="S3.SS4.p4.4.m4.2.2.2.2.3.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS4.p4.4.m4.2b"><apply id="S3.SS4.p4.4.m4.2.2.cmml" xref="S3.SS4.p4.4.m4.2.2"><and id="S3.SS4.p4.4.m4.2.2a.cmml" xref="S3.SS4.p4.4.m4.2.2"></and><apply id="S3.SS4.p4.4.m4.2.2b.cmml" xref="S3.SS4.p4.4.m4.2.2"><csymbol cd="latexml" id="S3.SS4.p4.4.m4.2.2.5.cmml" xref="S3.SS4.p4.4.m4.2.2.5">similar-to</csymbol><apply id="S3.SS4.p4.4.m4.2.2.4.cmml" xref="S3.SS4.p4.4.m4.2.2.4"><csymbol cd="ambiguous" id="S3.SS4.p4.4.m4.2.2.4.1.cmml" xref="S3.SS4.p4.4.m4.2.2.4">superscript</csymbol><apply id="S3.SS4.p4.4.m4.2.2.4.2.cmml" xref="S3.SS4.p4.4.m4.2.2.4"><csymbol cd="ambiguous" id="S3.SS4.p4.4.m4.2.2.4.2.1.cmml" xref="S3.SS4.p4.4.m4.2.2.4">subscript</csymbol><ci id="S3.SS4.p4.4.m4.2.2.4.2.2.cmml" xref="S3.SS4.p4.4.m4.2.2.4.2.2">𝐳</ci><ci id="S3.SS4.p4.4.m4.2.2.4.2.3.cmml" xref="S3.SS4.p4.4.m4.2.2.4.2.3">𝑚</ci></apply><ci id="S3.SS4.p4.4.m4.2.2.4.3.cmml" xref="S3.SS4.p4.4.m4.2.2.4.3">𝑘</ci></apply><apply id="S3.SS4.p4.4.m4.2.2.6.cmml" xref="S3.SS4.p4.4.m4.2.2.6"><csymbol cd="ambiguous" id="S3.SS4.p4.4.m4.2.2.6.1.cmml" xref="S3.SS4.p4.4.m4.2.2.6">subscript</csymbol><ci id="S3.SS4.p4.4.m4.2.2.6.2.cmml" xref="S3.SS4.p4.4.m4.2.2.6.2">𝐷</ci><ci id="S3.SS4.p4.4.m4.2.2.6.3.cmml" xref="S3.SS4.p4.4.m4.2.2.6.3">𝑘</ci></apply></apply><apply id="S3.SS4.p4.4.m4.2.2c.cmml" xref="S3.SS4.p4.4.m4.2.2"><eq id="S3.SS4.p4.4.m4.2.2.7.cmml" xref="S3.SS4.p4.4.m4.2.2.7"></eq><share href="#S3.SS4.p4.4.m4.2.2.6.cmml" id="S3.SS4.p4.4.m4.2.2d.cmml" xref="S3.SS4.p4.4.m4.2.2"></share><apply id="S3.SS4.p4.4.m4.2.2.2.cmml" xref="S3.SS4.p4.4.m4.2.2.2"><times id="S3.SS4.p4.4.m4.2.2.2.3.cmml" xref="S3.SS4.p4.4.m4.2.2.2.3"></times><ci id="S3.SS4.p4.4.m4.2.2.2.4.cmml" xref="S3.SS4.p4.4.m4.2.2.2.4">𝒩</ci><interval closure="open" id="S3.SS4.p4.4.m4.2.2.2.2.3.cmml" xref="S3.SS4.p4.4.m4.2.2.2.2.2"><apply id="S3.SS4.p4.4.m4.1.1.1.1.1.1.cmml" xref="S3.SS4.p4.4.m4.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS4.p4.4.m4.1.1.1.1.1.1.1.cmml" xref="S3.SS4.p4.4.m4.1.1.1.1.1.1">subscript</csymbol><ci id="S3.SS4.p4.4.m4.1.1.1.1.1.1.2.cmml" xref="S3.SS4.p4.4.m4.1.1.1.1.1.1.2">𝜇</ci><ci id="S3.SS4.p4.4.m4.1.1.1.1.1.1.3.cmml" xref="S3.SS4.p4.4.m4.1.1.1.1.1.1.3">𝑘</ci></apply><apply id="S3.SS4.p4.4.m4.2.2.2.2.2.2.cmml" xref="S3.SS4.p4.4.m4.2.2.2.2.2.2"><csymbol cd="ambiguous" id="S3.SS4.p4.4.m4.2.2.2.2.2.2.1.cmml" xref="S3.SS4.p4.4.m4.2.2.2.2.2.2">subscript</csymbol><ci id="S3.SS4.p4.4.m4.2.2.2.2.2.2.2.cmml" xref="S3.SS4.p4.4.m4.2.2.2.2.2.2.2">Σ</ci><ci id="S3.SS4.p4.4.m4.2.2.2.2.2.2.3.cmml" xref="S3.SS4.p4.4.m4.2.2.2.2.2.2.3">𝑘</ci></apply></interval></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p4.4.m4.2c">\mathbf{z}_{m}^{k}\sim D_{k}=\mathcal{N}\left(\mu_{k},\Sigma_{k}\right)</annotation></semantics></math>), and a pooling of the data from all other clients (<math id="S3.SS4.p4.5.m5.2" class="ltx_Math" alttext="D_{\mathcal{K}\setminus k}=\mathcal{N}\left(\mu_{\mathcal{K}\setminus k},\Sigma_{\mathcal{K}\setminus k}\right)" display="inline"><semantics id="S3.SS4.p4.5.m5.2a"><mrow id="S3.SS4.p4.5.m5.2.2" xref="S3.SS4.p4.5.m5.2.2.cmml"><msub id="S3.SS4.p4.5.m5.2.2.4" xref="S3.SS4.p4.5.m5.2.2.4.cmml"><mi id="S3.SS4.p4.5.m5.2.2.4.2" xref="S3.SS4.p4.5.m5.2.2.4.2.cmml">D</mi><mrow id="S3.SS4.p4.5.m5.2.2.4.3" xref="S3.SS4.p4.5.m5.2.2.4.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS4.p4.5.m5.2.2.4.3.2" xref="S3.SS4.p4.5.m5.2.2.4.3.2.cmml">𝒦</mi><mo id="S3.SS4.p4.5.m5.2.2.4.3.1" xref="S3.SS4.p4.5.m5.2.2.4.3.1.cmml">∖</mo><mi id="S3.SS4.p4.5.m5.2.2.4.3.3" xref="S3.SS4.p4.5.m5.2.2.4.3.3.cmml">k</mi></mrow></msub><mo id="S3.SS4.p4.5.m5.2.2.3" xref="S3.SS4.p4.5.m5.2.2.3.cmml">=</mo><mrow id="S3.SS4.p4.5.m5.2.2.2" xref="S3.SS4.p4.5.m5.2.2.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS4.p4.5.m5.2.2.2.4" xref="S3.SS4.p4.5.m5.2.2.2.4.cmml">𝒩</mi><mo lspace="0em" rspace="0em" id="S3.SS4.p4.5.m5.2.2.2.3" xref="S3.SS4.p4.5.m5.2.2.2.3.cmml">​</mo><mrow id="S3.SS4.p4.5.m5.2.2.2.2.2" xref="S3.SS4.p4.5.m5.2.2.2.2.3.cmml"><mo id="S3.SS4.p4.5.m5.2.2.2.2.2.3" xref="S3.SS4.p4.5.m5.2.2.2.2.3.cmml">(</mo><msub id="S3.SS4.p4.5.m5.1.1.1.1.1.1" xref="S3.SS4.p4.5.m5.1.1.1.1.1.1.cmml"><mi id="S3.SS4.p4.5.m5.1.1.1.1.1.1.2" xref="S3.SS4.p4.5.m5.1.1.1.1.1.1.2.cmml">μ</mi><mrow id="S3.SS4.p4.5.m5.1.1.1.1.1.1.3" xref="S3.SS4.p4.5.m5.1.1.1.1.1.1.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS4.p4.5.m5.1.1.1.1.1.1.3.2" xref="S3.SS4.p4.5.m5.1.1.1.1.1.1.3.2.cmml">𝒦</mi><mo id="S3.SS4.p4.5.m5.1.1.1.1.1.1.3.1" xref="S3.SS4.p4.5.m5.1.1.1.1.1.1.3.1.cmml">∖</mo><mi id="S3.SS4.p4.5.m5.1.1.1.1.1.1.3.3" xref="S3.SS4.p4.5.m5.1.1.1.1.1.1.3.3.cmml">k</mi></mrow></msub><mo id="S3.SS4.p4.5.m5.2.2.2.2.2.4" xref="S3.SS4.p4.5.m5.2.2.2.2.3.cmml">,</mo><msub id="S3.SS4.p4.5.m5.2.2.2.2.2.2" xref="S3.SS4.p4.5.m5.2.2.2.2.2.2.cmml"><mi mathvariant="normal" id="S3.SS4.p4.5.m5.2.2.2.2.2.2.2" xref="S3.SS4.p4.5.m5.2.2.2.2.2.2.2.cmml">Σ</mi><mrow id="S3.SS4.p4.5.m5.2.2.2.2.2.2.3" xref="S3.SS4.p4.5.m5.2.2.2.2.2.2.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS4.p4.5.m5.2.2.2.2.2.2.3.2" xref="S3.SS4.p4.5.m5.2.2.2.2.2.2.3.2.cmml">𝒦</mi><mo id="S3.SS4.p4.5.m5.2.2.2.2.2.2.3.1" xref="S3.SS4.p4.5.m5.2.2.2.2.2.2.3.1.cmml">∖</mo><mi id="S3.SS4.p4.5.m5.2.2.2.2.2.2.3.3" xref="S3.SS4.p4.5.m5.2.2.2.2.2.2.3.3.cmml">k</mi></mrow></msub><mo id="S3.SS4.p4.5.m5.2.2.2.2.2.5" xref="S3.SS4.p4.5.m5.2.2.2.2.3.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS4.p4.5.m5.2b"><apply id="S3.SS4.p4.5.m5.2.2.cmml" xref="S3.SS4.p4.5.m5.2.2"><eq id="S3.SS4.p4.5.m5.2.2.3.cmml" xref="S3.SS4.p4.5.m5.2.2.3"></eq><apply id="S3.SS4.p4.5.m5.2.2.4.cmml" xref="S3.SS4.p4.5.m5.2.2.4"><csymbol cd="ambiguous" id="S3.SS4.p4.5.m5.2.2.4.1.cmml" xref="S3.SS4.p4.5.m5.2.2.4">subscript</csymbol><ci id="S3.SS4.p4.5.m5.2.2.4.2.cmml" xref="S3.SS4.p4.5.m5.2.2.4.2">𝐷</ci><apply id="S3.SS4.p4.5.m5.2.2.4.3.cmml" xref="S3.SS4.p4.5.m5.2.2.4.3"><setdiff id="S3.SS4.p4.5.m5.2.2.4.3.1.cmml" xref="S3.SS4.p4.5.m5.2.2.4.3.1"></setdiff><ci id="S3.SS4.p4.5.m5.2.2.4.3.2.cmml" xref="S3.SS4.p4.5.m5.2.2.4.3.2">𝒦</ci><ci id="S3.SS4.p4.5.m5.2.2.4.3.3.cmml" xref="S3.SS4.p4.5.m5.2.2.4.3.3">𝑘</ci></apply></apply><apply id="S3.SS4.p4.5.m5.2.2.2.cmml" xref="S3.SS4.p4.5.m5.2.2.2"><times id="S3.SS4.p4.5.m5.2.2.2.3.cmml" xref="S3.SS4.p4.5.m5.2.2.2.3"></times><ci id="S3.SS4.p4.5.m5.2.2.2.4.cmml" xref="S3.SS4.p4.5.m5.2.2.2.4">𝒩</ci><interval closure="open" id="S3.SS4.p4.5.m5.2.2.2.2.3.cmml" xref="S3.SS4.p4.5.m5.2.2.2.2.2"><apply id="S3.SS4.p4.5.m5.1.1.1.1.1.1.cmml" xref="S3.SS4.p4.5.m5.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS4.p4.5.m5.1.1.1.1.1.1.1.cmml" xref="S3.SS4.p4.5.m5.1.1.1.1.1.1">subscript</csymbol><ci id="S3.SS4.p4.5.m5.1.1.1.1.1.1.2.cmml" xref="S3.SS4.p4.5.m5.1.1.1.1.1.1.2">𝜇</ci><apply id="S3.SS4.p4.5.m5.1.1.1.1.1.1.3.cmml" xref="S3.SS4.p4.5.m5.1.1.1.1.1.1.3"><setdiff id="S3.SS4.p4.5.m5.1.1.1.1.1.1.3.1.cmml" xref="S3.SS4.p4.5.m5.1.1.1.1.1.1.3.1"></setdiff><ci id="S3.SS4.p4.5.m5.1.1.1.1.1.1.3.2.cmml" xref="S3.SS4.p4.5.m5.1.1.1.1.1.1.3.2">𝒦</ci><ci id="S3.SS4.p4.5.m5.1.1.1.1.1.1.3.3.cmml" xref="S3.SS4.p4.5.m5.1.1.1.1.1.1.3.3">𝑘</ci></apply></apply><apply id="S3.SS4.p4.5.m5.2.2.2.2.2.2.cmml" xref="S3.SS4.p4.5.m5.2.2.2.2.2.2"><csymbol cd="ambiguous" id="S3.SS4.p4.5.m5.2.2.2.2.2.2.1.cmml" xref="S3.SS4.p4.5.m5.2.2.2.2.2.2">subscript</csymbol><ci id="S3.SS4.p4.5.m5.2.2.2.2.2.2.2.cmml" xref="S3.SS4.p4.5.m5.2.2.2.2.2.2.2">Σ</ci><apply id="S3.SS4.p4.5.m5.2.2.2.2.2.2.3.cmml" xref="S3.SS4.p4.5.m5.2.2.2.2.2.2.3"><setdiff id="S3.SS4.p4.5.m5.2.2.2.2.2.2.3.1.cmml" xref="S3.SS4.p4.5.m5.2.2.2.2.2.2.3.1"></setdiff><ci id="S3.SS4.p4.5.m5.2.2.2.2.2.2.3.2.cmml" xref="S3.SS4.p4.5.m5.2.2.2.2.2.2.3.2">𝒦</ci><ci id="S3.SS4.p4.5.m5.2.2.2.2.2.2.3.3.cmml" xref="S3.SS4.p4.5.m5.2.2.2.2.2.2.3.3">𝑘</ci></apply></apply></interval></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p4.5.m5.2c">D_{\mathcal{K}\setminus k}=\mathcal{N}\left(\mu_{\mathcal{K}\setminus k},\Sigma_{\mathcal{K}\setminus k}\right)</annotation></semantics></math>)
We determine the distance using <a href="#S3.E2" title="In 3.4 Quantifying heterogeneity of client feature distributions ‣ 3 Methods ‣ Client Adaptation improves Federated Learning with Simulated Non-IID Clients" class="ltx_ref"><span class="ltx_text ltx_ref_tag">Eq.</span> <span class="ltx_text ltx_ref_tag">2</span></a>, and then use the average distance as our measure of heterogeneity, <math id="S3.SS4.p4.6.m6.1" class="ltx_Math" alttext="\Gamma" display="inline"><semantics id="S3.SS4.p4.6.m6.1a"><mi mathvariant="normal" id="S3.SS4.p4.6.m6.1.1" xref="S3.SS4.p4.6.m6.1.1.cmml">Γ</mi><annotation-xml encoding="MathML-Content" id="S3.SS4.p4.6.m6.1b"><ci id="S3.SS4.p4.6.m6.1.1.cmml" xref="S3.SS4.p4.6.m6.1.1">Γ</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p4.6.m6.1c">\Gamma</annotation></semantics></math>:</p>
</div>
<div id="S3.SS4.p5" class="ltx_para">
<table id="S3.E3" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S3.E3.m1.2" class="ltx_Math" alttext="\Gamma=\frac{1}{K}\sum_{k=1}^{K}d^{2}(D_{k},D_{\mathcal{K}\setminus k})" display="block"><semantics id="S3.E3.m1.2a"><mrow id="S3.E3.m1.2.2" xref="S3.E3.m1.2.2.cmml"><mi mathvariant="normal" id="S3.E3.m1.2.2.4" xref="S3.E3.m1.2.2.4.cmml">Γ</mi><mo id="S3.E3.m1.2.2.3" xref="S3.E3.m1.2.2.3.cmml">=</mo><mrow id="S3.E3.m1.2.2.2" xref="S3.E3.m1.2.2.2.cmml"><mfrac id="S3.E3.m1.2.2.2.4" xref="S3.E3.m1.2.2.2.4.cmml"><mn id="S3.E3.m1.2.2.2.4.2" xref="S3.E3.m1.2.2.2.4.2.cmml">1</mn><mi id="S3.E3.m1.2.2.2.4.3" xref="S3.E3.m1.2.2.2.4.3.cmml">K</mi></mfrac><mo lspace="0em" rspace="0em" id="S3.E3.m1.2.2.2.3" xref="S3.E3.m1.2.2.2.3.cmml">​</mo><mrow id="S3.E3.m1.2.2.2.2" xref="S3.E3.m1.2.2.2.2.cmml"><munderover id="S3.E3.m1.2.2.2.2.3" xref="S3.E3.m1.2.2.2.2.3.cmml"><mo movablelimits="false" id="S3.E3.m1.2.2.2.2.3.2.2" xref="S3.E3.m1.2.2.2.2.3.2.2.cmml">∑</mo><mrow id="S3.E3.m1.2.2.2.2.3.2.3" xref="S3.E3.m1.2.2.2.2.3.2.3.cmml"><mi id="S3.E3.m1.2.2.2.2.3.2.3.2" xref="S3.E3.m1.2.2.2.2.3.2.3.2.cmml">k</mi><mo id="S3.E3.m1.2.2.2.2.3.2.3.1" xref="S3.E3.m1.2.2.2.2.3.2.3.1.cmml">=</mo><mn id="S3.E3.m1.2.2.2.2.3.2.3.3" xref="S3.E3.m1.2.2.2.2.3.2.3.3.cmml">1</mn></mrow><mi id="S3.E3.m1.2.2.2.2.3.3" xref="S3.E3.m1.2.2.2.2.3.3.cmml">K</mi></munderover><mrow id="S3.E3.m1.2.2.2.2.2" xref="S3.E3.m1.2.2.2.2.2.cmml"><msup id="S3.E3.m1.2.2.2.2.2.4" xref="S3.E3.m1.2.2.2.2.2.4.cmml"><mi id="S3.E3.m1.2.2.2.2.2.4.2" xref="S3.E3.m1.2.2.2.2.2.4.2.cmml">d</mi><mn id="S3.E3.m1.2.2.2.2.2.4.3" xref="S3.E3.m1.2.2.2.2.2.4.3.cmml">2</mn></msup><mo lspace="0em" rspace="0em" id="S3.E3.m1.2.2.2.2.2.3" xref="S3.E3.m1.2.2.2.2.2.3.cmml">​</mo><mrow id="S3.E3.m1.2.2.2.2.2.2.2" xref="S3.E3.m1.2.2.2.2.2.2.3.cmml"><mo stretchy="false" id="S3.E3.m1.2.2.2.2.2.2.2.3" xref="S3.E3.m1.2.2.2.2.2.2.3.cmml">(</mo><msub id="S3.E3.m1.1.1.1.1.1.1.1.1" xref="S3.E3.m1.1.1.1.1.1.1.1.1.cmml"><mi id="S3.E3.m1.1.1.1.1.1.1.1.1.2" xref="S3.E3.m1.1.1.1.1.1.1.1.1.2.cmml">D</mi><mi id="S3.E3.m1.1.1.1.1.1.1.1.1.3" xref="S3.E3.m1.1.1.1.1.1.1.1.1.3.cmml">k</mi></msub><mo id="S3.E3.m1.2.2.2.2.2.2.2.4" xref="S3.E3.m1.2.2.2.2.2.2.3.cmml">,</mo><msub id="S3.E3.m1.2.2.2.2.2.2.2.2" xref="S3.E3.m1.2.2.2.2.2.2.2.2.cmml"><mi id="S3.E3.m1.2.2.2.2.2.2.2.2.2" xref="S3.E3.m1.2.2.2.2.2.2.2.2.2.cmml">D</mi><mrow id="S3.E3.m1.2.2.2.2.2.2.2.2.3" xref="S3.E3.m1.2.2.2.2.2.2.2.2.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.E3.m1.2.2.2.2.2.2.2.2.3.2" xref="S3.E3.m1.2.2.2.2.2.2.2.2.3.2.cmml">𝒦</mi><mo id="S3.E3.m1.2.2.2.2.2.2.2.2.3.1" xref="S3.E3.m1.2.2.2.2.2.2.2.2.3.1.cmml">∖</mo><mi id="S3.E3.m1.2.2.2.2.2.2.2.2.3.3" xref="S3.E3.m1.2.2.2.2.2.2.2.2.3.3.cmml">k</mi></mrow></msub><mo stretchy="false" id="S3.E3.m1.2.2.2.2.2.2.2.5" xref="S3.E3.m1.2.2.2.2.2.2.3.cmml">)</mo></mrow></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.E3.m1.2b"><apply id="S3.E3.m1.2.2.cmml" xref="S3.E3.m1.2.2"><eq id="S3.E3.m1.2.2.3.cmml" xref="S3.E3.m1.2.2.3"></eq><ci id="S3.E3.m1.2.2.4.cmml" xref="S3.E3.m1.2.2.4">Γ</ci><apply id="S3.E3.m1.2.2.2.cmml" xref="S3.E3.m1.2.2.2"><times id="S3.E3.m1.2.2.2.3.cmml" xref="S3.E3.m1.2.2.2.3"></times><apply id="S3.E3.m1.2.2.2.4.cmml" xref="S3.E3.m1.2.2.2.4"><divide id="S3.E3.m1.2.2.2.4.1.cmml" xref="S3.E3.m1.2.2.2.4"></divide><cn type="integer" id="S3.E3.m1.2.2.2.4.2.cmml" xref="S3.E3.m1.2.2.2.4.2">1</cn><ci id="S3.E3.m1.2.2.2.4.3.cmml" xref="S3.E3.m1.2.2.2.4.3">𝐾</ci></apply><apply id="S3.E3.m1.2.2.2.2.cmml" xref="S3.E3.m1.2.2.2.2"><apply id="S3.E3.m1.2.2.2.2.3.cmml" xref="S3.E3.m1.2.2.2.2.3"><csymbol cd="ambiguous" id="S3.E3.m1.2.2.2.2.3.1.cmml" xref="S3.E3.m1.2.2.2.2.3">superscript</csymbol><apply id="S3.E3.m1.2.2.2.2.3.2.cmml" xref="S3.E3.m1.2.2.2.2.3"><csymbol cd="ambiguous" id="S3.E3.m1.2.2.2.2.3.2.1.cmml" xref="S3.E3.m1.2.2.2.2.3">subscript</csymbol><sum id="S3.E3.m1.2.2.2.2.3.2.2.cmml" xref="S3.E3.m1.2.2.2.2.3.2.2"></sum><apply id="S3.E3.m1.2.2.2.2.3.2.3.cmml" xref="S3.E3.m1.2.2.2.2.3.2.3"><eq id="S3.E3.m1.2.2.2.2.3.2.3.1.cmml" xref="S3.E3.m1.2.2.2.2.3.2.3.1"></eq><ci id="S3.E3.m1.2.2.2.2.3.2.3.2.cmml" xref="S3.E3.m1.2.2.2.2.3.2.3.2">𝑘</ci><cn type="integer" id="S3.E3.m1.2.2.2.2.3.2.3.3.cmml" xref="S3.E3.m1.2.2.2.2.3.2.3.3">1</cn></apply></apply><ci id="S3.E3.m1.2.2.2.2.3.3.cmml" xref="S3.E3.m1.2.2.2.2.3.3">𝐾</ci></apply><apply id="S3.E3.m1.2.2.2.2.2.cmml" xref="S3.E3.m1.2.2.2.2.2"><times id="S3.E3.m1.2.2.2.2.2.3.cmml" xref="S3.E3.m1.2.2.2.2.2.3"></times><apply id="S3.E3.m1.2.2.2.2.2.4.cmml" xref="S3.E3.m1.2.2.2.2.2.4"><csymbol cd="ambiguous" id="S3.E3.m1.2.2.2.2.2.4.1.cmml" xref="S3.E3.m1.2.2.2.2.2.4">superscript</csymbol><ci id="S3.E3.m1.2.2.2.2.2.4.2.cmml" xref="S3.E3.m1.2.2.2.2.2.4.2">𝑑</ci><cn type="integer" id="S3.E3.m1.2.2.2.2.2.4.3.cmml" xref="S3.E3.m1.2.2.2.2.2.4.3">2</cn></apply><interval closure="open" id="S3.E3.m1.2.2.2.2.2.2.3.cmml" xref="S3.E3.m1.2.2.2.2.2.2.2"><apply id="S3.E3.m1.1.1.1.1.1.1.1.1.cmml" xref="S3.E3.m1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E3.m1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E3.m1.1.1.1.1.1.1.1.1">subscript</csymbol><ci id="S3.E3.m1.1.1.1.1.1.1.1.1.2.cmml" xref="S3.E3.m1.1.1.1.1.1.1.1.1.2">𝐷</ci><ci id="S3.E3.m1.1.1.1.1.1.1.1.1.3.cmml" xref="S3.E3.m1.1.1.1.1.1.1.1.1.3">𝑘</ci></apply><apply id="S3.E3.m1.2.2.2.2.2.2.2.2.cmml" xref="S3.E3.m1.2.2.2.2.2.2.2.2"><csymbol cd="ambiguous" id="S3.E3.m1.2.2.2.2.2.2.2.2.1.cmml" xref="S3.E3.m1.2.2.2.2.2.2.2.2">subscript</csymbol><ci id="S3.E3.m1.2.2.2.2.2.2.2.2.2.cmml" xref="S3.E3.m1.2.2.2.2.2.2.2.2.2">𝐷</ci><apply id="S3.E3.m1.2.2.2.2.2.2.2.2.3.cmml" xref="S3.E3.m1.2.2.2.2.2.2.2.2.3"><setdiff id="S3.E3.m1.2.2.2.2.2.2.2.2.3.1.cmml" xref="S3.E3.m1.2.2.2.2.2.2.2.2.3.1"></setdiff><ci id="S3.E3.m1.2.2.2.2.2.2.2.2.3.2.cmml" xref="S3.E3.m1.2.2.2.2.2.2.2.2.3.2">𝒦</ci><ci id="S3.E3.m1.2.2.2.2.2.2.2.2.3.3.cmml" xref="S3.E3.m1.2.2.2.2.2.2.2.2.3.3">𝑘</ci></apply></apply></interval></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E3.m1.2c">\Gamma=\frac{1}{K}\sum_{k=1}^{K}d^{2}(D_{k},D_{\mathcal{K}\setminus k})</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(3)</span></td>
</tr></tbody>
</table>
</div>
</section>
</section>
<section id="S4" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">4 </span>Experiments</h2>

<figure id="S4.F2" class="ltx_figure">
<div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_2">
<figure id="S4.F2.sf1" class="ltx_figure ltx_figure_panel ltx_align_center"><img src="/html/2007.04806/assets/x1.png" id="S4.F2.sf1.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="461" height="307" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span id="S4.F2.sf1.2.1.1" class="ltx_text" style="font-size:90%;">(a)</span> </span><span id="S4.F2.sf1.3.2" class="ltx_text" style="font-size:90%;">Experiment 1: results on FSD (audio) data. </span></figcaption>
</figure>
</div>
<div class="ltx_flex_cell ltx_flex_size_2">
<figure id="S4.F2.sf2" class="ltx_figure ltx_figure_panel ltx_align_center"><img src="/html/2007.04806/assets/x2.png" id="S4.F2.sf2.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="461" height="307" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span id="S4.F2.sf2.2.1.1" class="ltx_text" style="font-size:90%;">(b)</span> </span><span id="S4.F2.sf2.3.2" class="ltx_text" style="font-size:90%;">Experiment II: results on CIFAR-10. </span></figcaption>
</figure>
</div>
</div>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span id="S4.F2.2.1.1" class="ltx_text" style="font-size:90%;">Figure 2</span>: </span><span id="S4.F2.3.2" class="ltx_text" style="font-size:90%;">Experimental results. The model trained with CGAU (in red) performs better (or equally well) than the baseline (in blue) at all levels of shuffling. CGAU is particularly beneficial for simulated very heterogeneous (non-IID) clients), marked by the performance difference at no shuffling.</span></figcaption>
</figure>
<div id="S4.p1" class="ltx_para">
<p id="S4.p1.1" class="ltx_p">We use two data sets to evaluate our proposed scheme, one based on audio data and one on image data. We chose the two data sets to cover imbalanced and balanced data as well as binary and multi-class tasks. In both settings we use a pre-trained network that was not trained on the data set at hand. The pre-trained networks are used as feature extractors to provide the features for a classifier. Experiments were carried out with Tensorflow Federated <cite class="ltx_cite ltx_citemacro_citep">(Abadi et al., <a href="#bib.bib1" title="" class="ltx_ref">2015</a>)</cite>.</p>
</div>
<div id="S4.p2" class="ltx_para">
<p id="S4.p2.1" class="ltx_p">We investigate the performance of a classifier that utilizes client adaption through conditional gated activation units, as described in <a href="#S3.SS2" title="3.2 Client adaptation through conditional gated activation units ‣ 3 Methods ‣ Client Adaptation improves Federated Learning with Simulated Non-IID Clients" class="ltx_ref"><span class="ltx_text ltx_ref_tag">Section</span> <span class="ltx_text ltx_ref_tag">3.2</span></a>. We contrast the effect of client adaption with a standard feed-forward neural network with rectified linear units without conditioning.</p>
</div>
<div id="S4.p3" class="ltx_para">
<p id="S4.p3.1" class="ltx_p">We simulated clients with non-IID features by clustering the embedding features in the manner described in <a href="#S3.SS3" title="3.3 Simulating clients with non-IID features ‣ 3 Methods ‣ Client Adaptation improves Federated Learning with Simulated Non-IID Clients" class="ltx_ref"><span class="ltx_text ltx_ref_tag">Section</span> <span class="ltx_text ltx_ref_tag">3.3</span></a>.
We can control the level of client heterogeneity by shuffling a certain percentage of the sample client assignments. For a shuffling proportion of 0.0, no samples are randomly re-assigned to any of the <math id="S4.p3.1.m1.1" class="ltx_Math" alttext="K" display="inline"><semantics id="S4.p3.1.m1.1a"><mi id="S4.p3.1.m1.1.1" xref="S4.p3.1.m1.1.1.cmml">K</mi><annotation-xml encoding="MathML-Content" id="S4.p3.1.m1.1b"><ci id="S4.p3.1.m1.1.1.cmml" xref="S4.p3.1.m1.1.1">𝐾</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.p3.1.m1.1c">K</annotation></semantics></math> clients. In this case, we consider the simulated clients to be maximally non-IID (all samples that are the closest to a particular centroid are collected in one client). On the other hand, a shuffling of 1.0 corresponds to completely random assignment of samples to clients.</p>
</div>
<div id="S4.p4" class="ltx_para">
<p id="S4.p4.1" class="ltx_p">In Experiment I, we investigate data from the Freesound Database (FSD) Kaggle 2018 data set <cite class="ltx_cite ltx_citemacro_citep">(Fonseca et al., <a href="#bib.bib4" title="" class="ltx_ref">2018</a>)</cite>. FSD contains approximately 11k audio clips from 41 different classes (such as laughter, keys jangling, writing, trumpet, and coughing). In Experiment II, we investigate CIFAR-10 <cite class="ltx_cite ltx_citemacro_citep">(Krizhevsky et al., <a href="#bib.bib11" title="" class="ltx_ref">2009</a>)</cite>, a popular image dataset featuring 32x32 resolution natural images from ten different classes. Additionally, we illustrate how the conditioning through CGAU changing the neural network solution on a XOR-problem in <a href="#A1" title="Appendix A CGAU on XOR dataset ‣ Client Adaptation improves Federated Learning with Simulated Non-IID Clients" class="ltx_ref"><span class="ltx_text ltx_ref_tag">Appendix</span> <span class="ltx_text ltx_ref_tag">A</span></a>.</p>
</div>
<section id="S4.SS1" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.1 </span>Experiment I: audio cough detection</h3>

<div id="S4.SS1.p1" class="ltx_para">
<p id="S4.SS1.p1.1" class="ltx_p">In our investigation of audio data, we construct a binary problem from the FSD by subdividing the labels into a positive class of audio labelled as cough, and a much larger negative class of any other label in FSD.
FSD as a whole has a total of 273 examples of the cough label.</p>
</div>
<div id="S4.SS1.p2" class="ltx_para">
<p id="S4.SS1.p2.1" class="ltx_p">We use a pre-trained MobileNet <cite class="ltx_cite ltx_citemacro_citep">(Howard et al., <a href="#bib.bib9" title="" class="ltx_ref">2017</a>)</cite> called YamNet<span id="footnote1" class="ltx_note ltx_role_footnote"><sup class="ltx_note_mark">1</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">1</sup><span class="ltx_tag ltx_tag_note">1</span>Maintained by M. Plakal and D. Ellis and available in the <a href="github.com/tensorflow/models/tree/master/research/audioset/yamnet" title="" class="ltx_ref ltx_href">Tensorflow AudioSet research repository</a>.</span></span></span> trained on the AudioSet data <cite class="ltx_cite ltx_citemacro_citep">(Gemmeke et al., <a href="#bib.bib5" title="" class="ltx_ref">2017</a>)</cite> to obtain embeddings. Audio inputs are resampled to 16 kHz mono signals, and converted to stabilized log-mel spectrograms. YamNet outputs a 1024-dimensional vector for each patch in the log-mel spectrogram, where a patch corresponds to 960 ms of waveform input (only full 960 ms patches are considered and any remainder of the signal is dropped). We obtain an embedding robust to varying time-length of the FSD audio samples by max-pooling the patch-features across the patches (the temporal dimension).</p>
</div>
<div id="S4.SS1.p3" class="ltx_para">
<p id="S4.SS1.p3.1" class="ltx_p">We train a 2-layer classifier with 64 units with 50 % dropout between layers.
The classifier is trained using <span id="S4.SS1.p3.1.1" class="ltx_text ltx_font_smallcaps">FedAvg</span> <cite class="ltx_cite ltx_citemacro_citep">(McMahan et al., <a href="#bib.bib15" title="" class="ltx_ref">2017</a>)</cite> with 10 simulated clients, and at each round of federated learning all 10 clients were included.
Each client completed 10 steps of gradient descent with batch sizes of 32 samples, or until all client data had been seen once—each client had a variable size of data set, seeing as samples are assigned based on proximity to the cluster centroids.
The clients utilized a stochastic gradient descent optimizer<span id="footnote2" class="ltx_note ltx_role_footnote"><sup class="ltx_note_mark">2</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">2</sup><span class="ltx_tag ltx_tag_note">2</span>A momentum and a decay was specified, but at a later stage it was discovered that the states were erroneously resat at each round (i.e. at each 10 steps), effectively thus having no decay, and momenta building over only 10 steps.</span></span></span>.
We retain the original FSD training and test partitions.
While training, we monitor the loss of a held-out sub-partition of 5 % the training set (a validation partition) by centrally collecting the outcomes on the validation data points at each client.
The best model (model weights) with the lowest cross-entropy loss on the validation partition across clients after a total of a 1000 rounds of federated learning is then used in the final evaluation on the test set.</p>
</div>
<div id="S4.SS1.p4" class="ltx_para">
<p id="S4.SS1.p4.1" class="ltx_p">We determine the average Fréchet distances from any given client’s features to all others (as described in <a href="#S3.SS4" title="3.4 Quantifying heterogeneity of client feature distributions ‣ 3 Methods ‣ Client Adaptation improves Federated Learning with Simulated Non-IID Clients" class="ltx_ref"><span class="ltx_text ltx_ref_tag">Section</span> <span class="ltx_text ltx_ref_tag">3.4</span></a>). The results averaged across replicates of the shuffling proportion are shown in <a href="#S4.T1" title="In 4.1 Experiment I: audio cough detection ‣ 4 Experiments ‣ Client Adaptation improves Federated Learning with Simulated Non-IID Clients" class="ltx_ref"><span class="ltx_text ltx_ref_tag">Table</span> <span class="ltx_text ltx_ref_tag">1</span></a>.</p>
</div>
<div id="S4.SS1.p5" class="ltx_para">
<p id="S4.SS1.p5.1" class="ltx_p">We evaluate the performance for shuffling proportions ranging from 0.0 to 1.0 in steps of 0.2 with 12 repetitions of the experiment at each level for both with and without client adaption. Since the data is imbalanced, we measure the model performance in terms of the area under the receiver operating characteristic (AUC).
The results are shown in <a href="#S4.F2.sf1" title="In Figure 2 ‣ 4 Experiments ‣ Client Adaptation improves Federated Learning with Simulated Non-IID Clients" class="ltx_ref"><span class="ltx_text ltx_ref_tag">Fig.</span> <span class="ltx_text ltx_ref_tag">2(a)</span></a>.
We see that a model without client adaption (in blue) performs consistently at about 0.994 across the range of shuffling.
The model with client adaption (orange) outperforms this baseline model for the most non-IID clients (lowest levels of shuffling), and has an AUC of about 0.998, thus improving performance for the most heterogeneous simulated clients.
For more homogeneous clients, we see no discernible difference between the performance of the two models.</p>
</div>
<figure id="S4.T1" class="ltx_table">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table"><span id="S4.T1.4.2.1" class="ltx_text" style="font-size:90%;">Table 1</span>: </span><span id="S4.T1.2.1" class="ltx_text" style="font-size:90%;">Client average Fréchet distances, <math id="S4.T1.2.1.m1.1" class="ltx_Math" alttext="\Gamma" display="inline"><semantics id="S4.T1.2.1.m1.1b"><mi mathvariant="normal" id="S4.T1.2.1.m1.1.1" xref="S4.T1.2.1.m1.1.1.cmml">Γ</mi><annotation-xml encoding="MathML-Content" id="S4.T1.2.1.m1.1c"><ci id="S4.T1.2.1.m1.1.1.cmml" xref="S4.T1.2.1.m1.1.1">Γ</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.T1.2.1.m1.1d">\Gamma</annotation></semantics></math>, in relation to proportion of shuffled labels, for the audio data in Experiment 1. Increasing the proportion of shuffled labels decreases the distances.</span></figcaption>
<table id="S4.T1.5" class="ltx_tabular ltx_centering ltx_align_middle">
<tbody class="ltx_tbody">
<tr id="S4.T1.5.1.1" class="ltx_tr">
<td id="S4.T1.5.1.1.1" class="ltx_td ltx_align_left ltx_border_tt">Proportion of shuffled labels</td>
<td id="S4.T1.5.1.1.2" class="ltx_td ltx_align_right ltx_border_tt">0.0</td>
<td id="S4.T1.5.1.1.3" class="ltx_td ltx_align_right ltx_border_tt">0.2</td>
<td id="S4.T1.5.1.1.4" class="ltx_td ltx_align_right ltx_border_tt">0.4</td>
<td id="S4.T1.5.1.1.5" class="ltx_td ltx_align_right ltx_border_tt">0.6</td>
<td id="S4.T1.5.1.1.6" class="ltx_td ltx_align_right ltx_border_tt">0.8</td>
<td id="S4.T1.5.1.1.7" class="ltx_td ltx_align_right ltx_border_tt">1.0</td>
</tr>
<tr id="S4.T1.5.2.2" class="ltx_tr">
<td id="S4.T1.5.2.2.1" class="ltx_td ltx_align_left ltx_border_bb ltx_border_t">Average client Fréchet distance</td>
<td id="S4.T1.5.2.2.2" class="ltx_td ltx_align_right ltx_border_bb ltx_border_t">1784.4</td>
<td id="S4.T1.5.2.2.3" class="ltx_td ltx_align_right ltx_border_bb ltx_border_t">980.0</td>
<td id="S4.T1.5.2.2.4" class="ltx_td ltx_align_right ltx_border_bb ltx_border_t">550.5</td>
<td id="S4.T1.5.2.2.5" class="ltx_td ltx_align_right ltx_border_bb ltx_border_t">271.0</td>
<td id="S4.T1.5.2.2.6" class="ltx_td ltx_align_right ltx_border_bb ltx_border_t">91.8</td>
<td id="S4.T1.5.2.2.7" class="ltx_td ltx_align_right ltx_border_bb ltx_border_t">19.9</td>
</tr>
</tbody>
</table>
</figure>
</section>
<section id="S4.SS2" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.2 </span>Experiment II: image label classification</h3>

<div id="S4.SS2.p1" class="ltx_para">
<p id="S4.SS2.p1.1" class="ltx_p">To show that our approach also works on a balanced and more challenging data set, we show results on CIFAR-10 <cite class="ltx_cite ltx_citemacro_citep">(Krizhevsky et al., <a href="#bib.bib11" title="" class="ltx_ref">2009</a>)</cite>.</p>
</div>
<div id="S4.SS2.p2" class="ltx_para">
<p id="S4.SS2.p2.1" class="ltx_p">We use an Inception architecture pre-trained<span id="footnote3" class="ltx_note ltx_role_footnote"><sup class="ltx_note_mark">3</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">3</sup><span class="ltx_tag ltx_tag_note">3</span>Model from <a target="_blank" href="https://github.com/pytorch/vision/tree/master/torchvision" title="" class="ltx_ref ltx_href">github.com/pytorch/vision/tree/master/torchvision</a></span></span></span> on ImageNet
<cite class="ltx_cite ltx_citemacro_citep">(Szegedy et al., <a href="#bib.bib22" title="" class="ltx_ref">2016</a>; Deng et al., <a href="#bib.bib3" title="" class="ltx_ref">2009</a>)</cite>.
The embeddings were extracted from the next to last layer.
To align the CIFAR-10 images with the resolution of ImageNet, we upsampled the images to 299x299 pixels.
We randomly partitioned the training data set into 80 % training data and 20 % validation data.
The classifier network mirrors the one used in the audio-experiment, except the dimensions were increased to 128 hidden units each in the two layers.
The federated learning scheme is similar to the audio experiment, but utilizes an increased learning rate of 0.01, and all models were trained for 500 epochs.
All configurations were run five times with different seeds. Training with CGAU took roughly 85% longer per epoch in the simulated setting.</p>
</div>
<div id="S4.SS2.p3" class="ltx_para">
<p id="S4.SS2.p3.1" class="ltx_p">We show results for this task in <a href="#S4.F2.sf2" title="In Figure 2 ‣ 4 Experiments ‣ Client Adaptation improves Federated Learning with Simulated Non-IID Clients" class="ltx_ref"><span class="ltx_text ltx_ref_tag">Fig.</span> <span class="ltx_text ltx_ref_tag">2(b)</span></a>. Since the class sizes of CIFAR-10 are balanced, we show model performance in terms of the accuracy.
The model with client adaption outperforms the baseline (without client adaption) at all levels of label shuffling. However, it works particularly well when there is a large difference in the training distribution between clients.</p>
</div>
</section>
</section>
<section id="S5" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">5 </span>Discussion</h2>

<div id="S5.p1" class="ltx_para">
<p id="S5.p1.1" class="ltx_p">In <a href="#S4.F2.sf1" title="In Figure 2 ‣ 4 Experiments ‣ Client Adaptation improves Federated Learning with Simulated Non-IID Clients" class="ltx_ref"><span class="ltx_text ltx_ref_tag">Fig.</span> <span class="ltx_text ltx_ref_tag">2(a)</span></a> and <a href="#S4.F2.sf2" title="In Figure 2 ‣ 4 Experiments ‣ Client Adaptation improves Federated Learning with Simulated Non-IID Clients" class="ltx_ref"><span class="ltx_text ltx_ref_tag">Fig.</span> <span class="ltx_text ltx_ref_tag">2(b)</span></a> we see that the models trained with the proposed conditional gated activation unit outperforms or perform equal to the baseline model at all levels of diversity between clients. In additional experiments on a toy dataset we show that CGAU does enable the network to learn client specific features and feature expressions (results in <a href="#A1" title="Appendix A CGAU on XOR dataset ‣ Client Adaptation improves Federated Learning with Simulated Non-IID Clients" class="ltx_ref"><span class="ltx_text ltx_ref_tag">Appendix</span> <span class="ltx_text ltx_ref_tag">A</span></a>).</p>
</div>
<div id="S5.p2" class="ltx_para">
<p id="S5.p2.1" class="ltx_p">Notably, CGAU is particularly useful when there is a high diversity between clients (no or little label shuffling).
This may be more pronounced due to the effects of transfer learning, i.e. fine-tuning an already pre-trained model on the available task-specific data.
As a result, the embeddings from the lower layers may be worse at “discounting”’ client-variant features, making it particularly important to learn client-specific embeddings along with global embeddings.</p>
</div>
<div id="S5.p3" class="ltx_para">
<p id="S5.p3.1" class="ltx_p">In preliminary experiments on CIFAR-10, we found that the gain in using CGAUs were not as pronounced when the feature embeddings are extracted from a network pre-trained with CIFAR-10—and not with ImageNet as shown on <a href="#S4.F2.sf2" title="In Figure 2 ‣ 4 Experiments ‣ Client Adaptation improves Federated Learning with Simulated Non-IID Clients" class="ltx_ref"><span class="ltx_text ltx_ref_tag">Fig.</span> <span class="ltx_text ltx_ref_tag">2(b)</span></a>. We theorize that CGAUs are particularly useful when the feature extractor was not trained on the same data distribution, as the feature extractor will not be as adept at extracting invariant features while discarding spurious features in the embedding.</p>
</div>
<div id="S5.p4" class="ltx_para">
<p id="S5.p4.2" class="ltx_p">To ensure that low shuffling does correspond to higher diversity in between client data distributions we provide the average Fréchet distance from each individual client to the remaining data, <math id="S5.p4.1.m1.1" class="ltx_Math" alttext="\Gamma" display="inline"><semantics id="S5.p4.1.m1.1a"><mi mathvariant="normal" id="S5.p4.1.m1.1.1" xref="S5.p4.1.m1.1.1.cmml">Γ</mi><annotation-xml encoding="MathML-Content" id="S5.p4.1.m1.1b"><ci id="S5.p4.1.m1.1.1.cmml" xref="S5.p4.1.m1.1.1">Γ</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.p4.1.m1.1c">\Gamma</annotation></semantics></math>, in <a href="#S4.T1" title="In 4.1 Experiment I: audio cough detection ‣ 4 Experiments ‣ Client Adaptation improves Federated Learning with Simulated Non-IID Clients" class="ltx_ref"><span class="ltx_text ltx_ref_tag">Table</span> <span class="ltx_text ltx_ref_tag">1</span></a>.
We see that label shuffling rates correlate well with <math id="S5.p4.2.m2.1" class="ltx_Math" alttext="\Gamma" display="inline"><semantics id="S5.p4.2.m2.1a"><mi mathvariant="normal" id="S5.p4.2.m2.1.1" xref="S5.p4.2.m2.1.1.cmml">Γ</mi><annotation-xml encoding="MathML-Content" id="S5.p4.2.m2.1b"><ci id="S5.p4.2.m2.1.1.cmml" xref="S5.p4.2.m2.1.1">Γ</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.p4.2.m2.1c">\Gamma</annotation></semantics></math>, implying that clustering based on the embedding may be a good alternative, or addition, to class clustering for artificially creating non-IID data sets.
In particular it allows us to measure the impact of data that is non-IID even when conditioned on the classes.</p>
</div>
<div id="S5.p5" class="ltx_para">
<p id="S5.p5.1" class="ltx_p">A surprising effect is that applying CGAU results in predictive accuracy increasing for diverse data distributions (low proportion of shuffling). We would expect the accuracy to be decreased for the base model for diverse data distributions as the models diverge between synchronizations and to stay relatively equal for the model with CGAU. Instead the base model performs relatively equal across all levels of label shuffling whereas the CGAU model performs better for a low proportion of label shuffling. We hypothesize that this is due to the model learning the specific data distribution from each client.</p>
</div>
<div id="S5.p6" class="ltx_para">
<p id="S5.p6.1" class="ltx_p">While the cough detection problem is highly imbalanced, the classification task is a less challenging problem when using a well-suited pre-trained network.
A considerable portion of the audio samples are, e.g., musical instruments with tonal qualities, that are quite straightforward to distinguish from coughs.
This is also evident from the experimental results, where even the baseline effectively solves the task with an AUC of about 0.994.</p>
</div>
<div id="S5.p7" class="ltx_para">
<p id="S5.p7.1" class="ltx_p">A marked difference in problem complexity between Experiment I and II is evident in the performance difference at homogeneous clients (shuffling of 1.0). The model capacity (if naïvely measured as parameter count) is doubled by the filtering and gating alone in using the CGAU compared to the baseline. This increase in capacity is not beneficial for the homogeneous clients in the audio task, but does increase the test accuracy on the CIFAR-10 problem from about 0.780 to 0.785. This also increases the computational power needed for each round of learning, potentially exacerbating problems with e.g. stragglers in real federated learning systems; whether the performance gains of CGAU is worth such trade-offs remains to be investigated.</p>
</div>
<div id="S5.p8" class="ltx_para">
<p id="S5.p8.1" class="ltx_p">In our experiments, we worked with a relatively low number of clients (ten clients for both experiments). This was done to ensure that the clustering as described in <a href="#S3.SS4" title="3.4 Quantifying heterogeneity of client feature distributions ‣ 3 Methods ‣ Client Adaptation improves Federated Learning with Simulated Non-IID Clients" class="ltx_ref"><span class="ltx_text ltx_ref_tag">Section</span> <span class="ltx_text ltx_ref_tag">3.4</span></a> resulted in semantically meaningful clusters of data samples. Examining the effect with a larger number of clients is needed, seeing as FL usually works with a (much) larger number of clients.
A potential alternative solution may be to use a clustering scheme as suggested in <cite class="ltx_cite ltx_citemacro_citet">Ghosh et al. (<a href="#bib.bib6" title="" class="ltx_ref">2019</a>)</cite> to find clients with shared attributes. However, sharing characteristics specific to a client in a privacy-compliant manner may be a challenge.</p>
</div>
<div id="S5.p9" class="ltx_para">
<p id="S5.p9.1" class="ltx_p">Incorporating client-information directly in federated learning models, even if only locally, is a potential opening for attacks on privacy. The client-specific conditioning does not need to be shared, yet any use of conditioning in the manner of the investigated CGAU would need to be evaluated for robustness to attacks.</p>
</div>
</section>
<section id="S6" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">6 </span>Conclusion</h2>

<div id="S6.p1" class="ltx_para">
<p id="S6.p1.1" class="ltx_p">Extant previous work has shown that models trained in a federated learning manner converge much slower if the used data sets are non-IID between clients <cite class="ltx_cite ltx_citemacro_citep">(Li et al., <a href="#bib.bib12" title="" class="ltx_ref">2019a</a>)</cite>. Since this is an extremely common characteristic when learning from sensitive user data, it presents a serious hindrance to the utilization of federated learning.</p>
</div>
<div id="S6.p2" class="ltx_para">
<p id="S6.p2.1" class="ltx_p">We present a simple approach to reduce the impact of local features by learning patterns specific to each client along with the global model. In experiments we show that our approach outperforms the baseline for scenarios with heterogeneous clients. We find evidence that our approach may be particularly beneficial when using a transfer learning approach to extract embeddings.</p>
</div>
<div class="ltx_pagination ltx_role_newpage"></div>
</section>
<section id="bib" class="ltx_bibliography">
<h2 class="ltx_title ltx_title_bibliography">References</h2>

<ul class="ltx_biblist">
<li id="bib.bib1" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Abadi et al. (2015)</span>
<span class="ltx_bibblock">
Abadi, M., Agarwal, A., Barham, P., Brevdo, E., Chen, Z., Citro, C., Corrado,
G. S., Davis, A., Dean, J., Devin, M., Ghemawat, S., Goodfellow, I., Harp,
A., Irving, G., Isard, M., Jia, Y., Jozefowicz, R., Kaiser, L., Kudlur, M.,
Levenberg, J., Mané, D., Monga, R., Moore, S., Murray, D., Olah, C.,
Schuster, M., Shlens, J., Steiner, B., Sutskever, I., Talwar, K., Tucker, P.,
Vanhoucke, V., Vasudevan, V., Viégas, F., Vinyals, O., Warden, P.,
Wattenberg, M., Wicke, M., Yu, Y., and Zheng, X.

</span>
<span class="ltx_bibblock">TensorFlow: Large-scale machine learning on heterogeneous systems,
2015.

</span>
<span class="ltx_bibblock">URL <a target="_blank" href="http://tensorflow.org/" title="" class="ltx_ref ltx_url ltx_font_typewriter">http://tensorflow.org/</a>.

</span>
<span class="ltx_bibblock">Software available from tensorflow.org.

</span>
</li>
<li id="bib.bib2" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Bagdasaryan et al. (2018)</span>
<span class="ltx_bibblock">
Bagdasaryan, E., Veit, A., Hua, Y., Estrin, D., and Shmatikov, V.

</span>
<span class="ltx_bibblock">How to backdoor federated learning.

</span>
<span class="ltx_bibblock"><em id="bib.bib2.1.1" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:1807.00459</em>, 2018.

</span>
</li>
<li id="bib.bib3" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Deng et al. (2009)</span>
<span class="ltx_bibblock">
Deng, J., Dong, W., Socher, R., Li, L.-J., Li, K., and Fei-Fei, L.

</span>
<span class="ltx_bibblock">Imagenet: A large-scale hierarchical image database.

</span>
<span class="ltx_bibblock">In <em id="bib.bib3.1.1" class="ltx_emph ltx_font_italic">2009 IEEE conference on computer vision and pattern
recognition</em>, pp.  248–255. Ieee, 2009.

</span>
</li>
<li id="bib.bib4" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Fonseca et al. (2018)</span>
<span class="ltx_bibblock">
Fonseca, E., Plakal, M., Font, F., Ellis, D. P., Favory, X., Pons, J., and
Serra, X.

</span>
<span class="ltx_bibblock">General-purpose tagging of freesound audio with audioset labels: Task
description, dataset, and baseline.

</span>
<span class="ltx_bibblock"><em id="bib.bib4.1.1" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:1807.09902</em>, 2018.

</span>
</li>
<li id="bib.bib5" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Gemmeke et al. (2017)</span>
<span class="ltx_bibblock">
Gemmeke, J. F., Ellis, D. P., Freedman, D., Jansen, A., Lawrence, W., Moore,
R. C., Plakal, M., and Ritter, M.

</span>
<span class="ltx_bibblock">Audio set: An ontology and human-labeled dataset for audio events.

</span>
<span class="ltx_bibblock">In <em id="bib.bib5.1.1" class="ltx_emph ltx_font_italic">2017 IEEE International Conference on Acoustics, Speech and
Signal Processing (ICASSP)</em>, pp.  776–780. IEEE, 2017.

</span>
</li>
<li id="bib.bib6" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Ghosh et al. (2019)</span>
<span class="ltx_bibblock">
Ghosh, A., Hong, J., Yin, D., and Ramchandran, K.

</span>
<span class="ltx_bibblock">Robust Federated Learning in a Heterogeneous Environment.

</span>
<span class="ltx_bibblock">jun 2019.

</span>
<span class="ltx_bibblock">URL <a target="_blank" href="http://arxiv.org/abs/1906.06629" title="" class="ltx_ref ltx_url ltx_font_typewriter">http://arxiv.org/abs/1906.06629</a>.

</span>
</li>
<li id="bib.bib7" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Heusel et al. (2017)</span>
<span class="ltx_bibblock">
Heusel, M., Ramsauer, H., Unterthiner, T., Nessler, B., and Hochreiter, S.

</span>
<span class="ltx_bibblock">Gans trained by a two time-scale update rule converge to a local nash
equilibrium.

</span>
<span class="ltx_bibblock">In <em id="bib.bib7.1.1" class="ltx_emph ltx_font_italic">Advances in neural information processing systems</em>, pp. 6626–6637, 2017.

</span>
</li>
<li id="bib.bib8" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Hochreiter &amp; Schmidhuber (1997)</span>
<span class="ltx_bibblock">
Hochreiter, S. and Schmidhuber, J.

</span>
<span class="ltx_bibblock">Long short-term memory.

</span>
<span class="ltx_bibblock"><em id="bib.bib8.1.1" class="ltx_emph ltx_font_italic">Neural computation</em>, 9(8):1735–1780, 1997.

</span>
</li>
<li id="bib.bib9" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Howard et al. (2017)</span>
<span class="ltx_bibblock">
Howard, A. G., Zhu, M., Chen, B., Kalenichenko, D., Wang, W., Weyand, T.,
Andreetto, M., and Adam, H.

</span>
<span class="ltx_bibblock">Mobilenets: Efficient convolutional neural networks for mobile vision
applications.

</span>
<span class="ltx_bibblock"><em id="bib.bib9.1.1" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:1704.04861</em>, 2017.

</span>
</li>
<li id="bib.bib10" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Konečnỳ et al. (2016)</span>
<span class="ltx_bibblock">
Konečnỳ, J., McMahan, H. B., Yu, F. X., Richtárik, P., Suresh,
A. T., and Bacon, D.

</span>
<span class="ltx_bibblock">Federated learning: Strategies for improving communication
efficiency.

</span>
<span class="ltx_bibblock"><em id="bib.bib10.1.1" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:1610.05492</em>, 2016.

</span>
</li>
<li id="bib.bib11" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Krizhevsky et al. (2009)</span>
<span class="ltx_bibblock">
Krizhevsky, A., Hinton, G., et al.

</span>
<span class="ltx_bibblock">Learning multiple layers of features from tiny images.

</span>
<span class="ltx_bibblock">2009.

</span>
</li>
<li id="bib.bib12" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Li et al. (2019a)</span>
<span class="ltx_bibblock">
Li, X., Huang, K., Yang, W., Wang, S., and Zhang, Z.

</span>
<span class="ltx_bibblock">On the Convergence of FedAvg on Non-IID Data.

</span>
<span class="ltx_bibblock">jul 2019a.

</span>
<span class="ltx_bibblock">URL <a target="_blank" href="http://arxiv.org/abs/1907.02189" title="" class="ltx_ref ltx_url ltx_font_typewriter">http://arxiv.org/abs/1907.02189</a>.

</span>
</li>
<li id="bib.bib13" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Li et al. (2019b)</span>
<span class="ltx_bibblock">
Li, X., Huang, K., Yang, W., Wang, S., and Zhang, Z.

</span>
<span class="ltx_bibblock">On the Convergence of FedAvg on Non-IID Data.

</span>
<span class="ltx_bibblock">jul 2019b.

</span>
<span class="ltx_bibblock">URL <a target="_blank" href="http://arxiv.org/abs/1907.02189" title="" class="ltx_ref ltx_url ltx_font_typewriter">http://arxiv.org/abs/1907.02189</a>.

</span>
</li>
<li id="bib.bib14" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Lim et al. (2019)</span>
<span class="ltx_bibblock">
Lim, W. Y. B., Luong, N. C., Hoang, D. T., Jiao, Y., Liang, Y.-C., Yang, Q.,
Niyato, D., and Miao, C.

</span>
<span class="ltx_bibblock">Federated Learning in Mobile Edge Networks: A Comprehensive Survey.

</span>
<span class="ltx_bibblock"><em id="bib.bib14.1.1" class="ltx_emph ltx_font_italic">IEEE Communications Surveys and Tutorials</em>, sep 2019.

</span>
<span class="ltx_bibblock">URL <a target="_blank" href="http://arxiv.org/abs/1909.11875" title="" class="ltx_ref ltx_url ltx_font_typewriter">http://arxiv.org/abs/1909.11875</a>.

</span>
</li>
<li id="bib.bib15" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">McMahan et al. (2017)</span>
<span class="ltx_bibblock">
McMahan, B., Moore, E., Ramage, D., Hampson, S., and y Arcas, B. A.

</span>
<span class="ltx_bibblock">Communication-efficient learning of deep networks from decentralized
data.

</span>
<span class="ltx_bibblock">In <em id="bib.bib15.1.1" class="ltx_emph ltx_font_italic">Artificial Intelligence and Statistics</em>, pp.  1273–1282,
2017.

</span>
</li>
<li id="bib.bib16" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">McMahan et al. (2016)</span>
<span class="ltx_bibblock">
McMahan, H. B., Moore, E., Ramage, D., Hampson, S., and Arcas, B. A. y.

</span>
<span class="ltx_bibblock">Communication-Efficient Learning of Deep Networks from Decentralized
Data.

</span>
<span class="ltx_bibblock"><em id="bib.bib16.1.1" class="ltx_emph ltx_font_italic">Proceedings of the 20th International Conference on Artificial
Intelligence and Statistics, AISTATS 2017</em>, feb 2016.

</span>
<span class="ltx_bibblock">URL <a target="_blank" href="http://arxiv.org/abs/1602.05629" title="" class="ltx_ref ltx_url ltx_font_typewriter">http://arxiv.org/abs/1602.05629</a>.

</span>
</li>
<li id="bib.bib17" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Nguyen et al. (2020)</span>
<span class="ltx_bibblock">
Nguyen, T. D., Rieger, P., Miettinen, M., and Sadeghi, A.-R.

</span>
<span class="ltx_bibblock">Poisoning attacks on federated learning-based iot intrusion detection
system.

</span>
<span class="ltx_bibblock">2020.

</span>
</li>
<li id="bib.bib18" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Oord et al. (2016)</span>
<span class="ltx_bibblock">
Oord, A. v. d., Dieleman, S., Zen, H., Simonyan, K., Vinyals, O., Graves, A.,
Kalchbrenner, N., Senior, A., and Kavukcuoglu, K.

</span>
<span class="ltx_bibblock">Wavenet: A generative model for raw audio.

</span>
<span class="ltx_bibblock"><em id="bib.bib18.1.1" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:1609.03499</em>, 2016.

</span>
</li>
<li id="bib.bib19" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Peng et al. (2019)</span>
<span class="ltx_bibblock">
Peng, X., Huang, Z., Zhu, Y., and Saenko, K.

</span>
<span class="ltx_bibblock">FEDERATED ADVERSARIAL DOMAIN ADAPTATION.

</span>
<span class="ltx_bibblock">Technical report, sep 2019.

</span>
</li>
<li id="bib.bib20" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Sattler et al. (2019)</span>
<span class="ltx_bibblock">
Sattler, F., Wiedemann, S., Muller, K.-R., and Samek, W.

</span>
<span class="ltx_bibblock">Robust and Communication-Efficient Federated Learning From
Non-i.i.d. Data.

</span>
<span class="ltx_bibblock"><em id="bib.bib20.1.1" class="ltx_emph ltx_font_italic">IEEE Transactions on Neural Networks and Learning Systems</em>,
pp.  1–14, nov 2019.

</span>
<span class="ltx_bibblock">ISSN 2162-237X.

</span>
<span class="ltx_bibblock">doi: <span class="ltx_ref ltx_nolink ltx_Url ltx_ref_self">10.1109/tnnls.2019.2944481</span>.

</span>
</li>
<li id="bib.bib21" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Srivastava et al. (2015)</span>
<span class="ltx_bibblock">
Srivastava, R. K., Greff, K., and Schmidhuber, J.

</span>
<span class="ltx_bibblock">Highway networks.

</span>
<span class="ltx_bibblock"><em id="bib.bib21.1.1" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:1505.00387</em>, 2015.

</span>
</li>
<li id="bib.bib22" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Szegedy et al. (2016)</span>
<span class="ltx_bibblock">
Szegedy, C., Vanhoucke, V., Ioffe, S., Shlens, J., and Wojna, Z.

</span>
<span class="ltx_bibblock">Rethinking the inception architecture for computer vision.

</span>
<span class="ltx_bibblock">In <em id="bib.bib22.1.1" class="ltx_emph ltx_font_italic">Proceedings of the IEEE conference on computer vision and
pattern recognition</em>, pp.  2818–2826, 2016.

</span>
</li>
<li id="bib.bib23" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Van den Oord et al. (2016)</span>
<span class="ltx_bibblock">
Van den Oord, A., Kalchbrenner, N., Espeholt, L., Vinyals, O., Graves, A.,
et al.

</span>
<span class="ltx_bibblock">Conditional image generation with pixelcnn decoders.

</span>
<span class="ltx_bibblock">In <em id="bib.bib23.1.1" class="ltx_emph ltx_font_italic">Advances in neural information processing systems</em>, pp. 4790–4798, 2016.

</span>
</li>
<li id="bib.bib24" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Wei et al. (2020)</span>
<span class="ltx_bibblock">
Wei, K., Li, J., Ding, M., Ma, C., Yang, H. H., Farokhi, F., Jin,
S., Quek, T. Q. S., and Poor, H. V.

</span>
<span class="ltx_bibblock">Federated learning with differential privacy: Algorithms and
performance analysis.

</span>
<span class="ltx_bibblock"><em id="bib.bib24.1.1" class="ltx_emph ltx_font_italic">IEEE Transactions on Information Forensics and Security</em>, pp. 1–1, 2020.

</span>
</li>
<li id="bib.bib25" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Zhao et al. (2018)</span>
<span class="ltx_bibblock">
Zhao, Y., Li, M., Lai, L., Suda, N., Civin, D., and Chandra, V.

</span>
<span class="ltx_bibblock">Federated Learning with Non-IID Data.

</span>
<span class="ltx_bibblock">jun 2018.

</span>
<span class="ltx_bibblock">URL <a target="_blank" href="http://arxiv.org/abs/1806.00582" title="" class="ltx_ref ltx_url ltx_font_typewriter">http://arxiv.org/abs/1806.00582</a>.

</span>
</li>
</ul>
</section>
<div class="ltx_pagination ltx_role_newpage"></div>
<section id="A1" class="ltx_appendix">
<h2 class="ltx_title ltx_title_appendix">
<span class="ltx_tag ltx_tag_appendix">Appendix A </span>CGAU on XOR dataset</h2>

<div id="A1.p1" class="ltx_para">
<p id="A1.p1.5" class="ltx_p">We can illustrate the workings of the CGAU by investigating an augmented version of the classic XOR-problem.
We consider a two-class problem with two features, <math id="A1.p1.1.m1.1" class="ltx_Math" alttext="x_{1}" display="inline"><semantics id="A1.p1.1.m1.1a"><msub id="A1.p1.1.m1.1.1" xref="A1.p1.1.m1.1.1.cmml"><mi id="A1.p1.1.m1.1.1.2" xref="A1.p1.1.m1.1.1.2.cmml">x</mi><mn id="A1.p1.1.m1.1.1.3" xref="A1.p1.1.m1.1.1.3.cmml">1</mn></msub><annotation-xml encoding="MathML-Content" id="A1.p1.1.m1.1b"><apply id="A1.p1.1.m1.1.1.cmml" xref="A1.p1.1.m1.1.1"><csymbol cd="ambiguous" id="A1.p1.1.m1.1.1.1.cmml" xref="A1.p1.1.m1.1.1">subscript</csymbol><ci id="A1.p1.1.m1.1.1.2.cmml" xref="A1.p1.1.m1.1.1.2">𝑥</ci><cn type="integer" id="A1.p1.1.m1.1.1.3.cmml" xref="A1.p1.1.m1.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.p1.1.m1.1c">x_{1}</annotation></semantics></math> and <math id="A1.p1.2.m2.1" class="ltx_Math" alttext="x_{2}" display="inline"><semantics id="A1.p1.2.m2.1a"><msub id="A1.p1.2.m2.1.1" xref="A1.p1.2.m2.1.1.cmml"><mi id="A1.p1.2.m2.1.1.2" xref="A1.p1.2.m2.1.1.2.cmml">x</mi><mn id="A1.p1.2.m2.1.1.3" xref="A1.p1.2.m2.1.1.3.cmml">2</mn></msub><annotation-xml encoding="MathML-Content" id="A1.p1.2.m2.1b"><apply id="A1.p1.2.m2.1.1.cmml" xref="A1.p1.2.m2.1.1"><csymbol cd="ambiguous" id="A1.p1.2.m2.1.1.1.cmml" xref="A1.p1.2.m2.1.1">subscript</csymbol><ci id="A1.p1.2.m2.1.1.2.cmml" xref="A1.p1.2.m2.1.1.2">𝑥</ci><cn type="integer" id="A1.p1.2.m2.1.1.3.cmml" xref="A1.p1.2.m2.1.1.3">2</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.p1.2.m2.1c">x_{2}</annotation></semantics></math>. The negative class (red) consists of two clusters for which the features have the same sign, and the positive class (blue) is characterized by having the features of opposite sign. The augmentation to the XOR-problem is that we consider the clusters to be from two different clients: client one (“up client”) has only positive <math id="A1.p1.3.m3.1" class="ltx_Math" alttext="x_{2}" display="inline"><semantics id="A1.p1.3.m3.1a"><msub id="A1.p1.3.m3.1.1" xref="A1.p1.3.m3.1.1.cmml"><mi id="A1.p1.3.m3.1.1.2" xref="A1.p1.3.m3.1.1.2.cmml">x</mi><mn id="A1.p1.3.m3.1.1.3" xref="A1.p1.3.m3.1.1.3.cmml">2</mn></msub><annotation-xml encoding="MathML-Content" id="A1.p1.3.m3.1b"><apply id="A1.p1.3.m3.1.1.cmml" xref="A1.p1.3.m3.1.1"><csymbol cd="ambiguous" id="A1.p1.3.m3.1.1.1.cmml" xref="A1.p1.3.m3.1.1">subscript</csymbol><ci id="A1.p1.3.m3.1.1.2.cmml" xref="A1.p1.3.m3.1.1.2">𝑥</ci><cn type="integer" id="A1.p1.3.m3.1.1.3.cmml" xref="A1.p1.3.m3.1.1.3">2</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.p1.3.m3.1c">x_{2}</annotation></semantics></math>, and client two has only negative <math id="A1.p1.4.m4.1" class="ltx_Math" alttext="x_{2}" display="inline"><semantics id="A1.p1.4.m4.1a"><msub id="A1.p1.4.m4.1.1" xref="A1.p1.4.m4.1.1.cmml"><mi id="A1.p1.4.m4.1.1.2" xref="A1.p1.4.m4.1.1.2.cmml">x</mi><mn id="A1.p1.4.m4.1.1.3" xref="A1.p1.4.m4.1.1.3.cmml">2</mn></msub><annotation-xml encoding="MathML-Content" id="A1.p1.4.m4.1b"><apply id="A1.p1.4.m4.1.1.cmml" xref="A1.p1.4.m4.1.1"><csymbol cd="ambiguous" id="A1.p1.4.m4.1.1.1.cmml" xref="A1.p1.4.m4.1.1">subscript</csymbol><ci id="A1.p1.4.m4.1.1.2.cmml" xref="A1.p1.4.m4.1.1.2">𝑥</ci><cn type="integer" id="A1.p1.4.m4.1.1.3.cmml" xref="A1.p1.4.m4.1.1.3">2</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.p1.4.m4.1c">x_{2}</annotation></semantics></math> (“down client”). Ignoring the clients and solving the problem using a multi-layer perceptron (MLP, with two hidden units) results in a solution of the form shown on <a href="#A1.F3.sf1" title="In Appendix A CGAU on XOR dataset ‣ Client Adaptation improves Federated Learning with Simulated Non-IID Clients" class="ltx_ref"><span class="ltx_text ltx_ref_tag">Fig.</span> <span class="ltx_text ltx_ref_tag">3(a)</span></a>, whereas a CGAU with one gated unit (<math id="A1.p1.5.m5.1" class="ltx_Math" alttext="N=1" display="inline"><semantics id="A1.p1.5.m5.1a"><mrow id="A1.p1.5.m5.1.1" xref="A1.p1.5.m5.1.1.cmml"><mi id="A1.p1.5.m5.1.1.2" xref="A1.p1.5.m5.1.1.2.cmml">N</mi><mo id="A1.p1.5.m5.1.1.1" xref="A1.p1.5.m5.1.1.1.cmml">=</mo><mn id="A1.p1.5.m5.1.1.3" xref="A1.p1.5.m5.1.1.3.cmml">1</mn></mrow><annotation-xml encoding="MathML-Content" id="A1.p1.5.m5.1b"><apply id="A1.p1.5.m5.1.1.cmml" xref="A1.p1.5.m5.1.1"><eq id="A1.p1.5.m5.1.1.1.cmml" xref="A1.p1.5.m5.1.1.1"></eq><ci id="A1.p1.5.m5.1.1.2.cmml" xref="A1.p1.5.m5.1.1.2">𝑁</ci><cn type="integer" id="A1.p1.5.m5.1.1.3.cmml" xref="A1.p1.5.m5.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.p1.5.m5.1c">N=1</annotation></semantics></math>) results in a solution of the form shown on <a href="#A1.F3.sf2" title="In Appendix A CGAU on XOR dataset ‣ Client Adaptation improves Federated Learning with Simulated Non-IID Clients" class="ltx_ref"><span class="ltx_text ltx_ref_tag">Fig.</span> <span class="ltx_text ltx_ref_tag">3(b)</span></a>.</p>
</div>
<div id="A1.p2" class="ltx_para">
<p id="A1.p2.4" class="ltx_p">The un-conditioned filter and gate outputs are shown on <a href="#A1.F3.sf3" title="In Appendix A CGAU on XOR dataset ‣ Client Adaptation improves Federated Learning with Simulated Non-IID Clients" class="ltx_ref"><span class="ltx_text ltx_ref_tag">Fig.</span> <span class="ltx_text ltx_ref_tag">3(c)</span></a> and <a href="#A1.F3.sf4" title="In Appendix A CGAU on XOR dataset ‣ Client Adaptation improves Federated Learning with Simulated Non-IID Clients" class="ltx_ref"><span class="ltx_text ltx_ref_tag">Fig.</span> <span class="ltx_text ltx_ref_tag">3(d)</span></a>.
We see how the filter has learnt a split on the sign of <math id="A1.p2.1.m1.1" class="ltx_Math" alttext="x_{1}" display="inline"><semantics id="A1.p2.1.m1.1a"><msub id="A1.p2.1.m1.1.1" xref="A1.p2.1.m1.1.1.cmml"><mi id="A1.p2.1.m1.1.1.2" xref="A1.p2.1.m1.1.1.2.cmml">x</mi><mn id="A1.p2.1.m1.1.1.3" xref="A1.p2.1.m1.1.1.3.cmml">1</mn></msub><annotation-xml encoding="MathML-Content" id="A1.p2.1.m1.1b"><apply id="A1.p2.1.m1.1.1.cmml" xref="A1.p2.1.m1.1.1"><csymbol cd="ambiguous" id="A1.p2.1.m1.1.1.1.cmml" xref="A1.p2.1.m1.1.1">subscript</csymbol><ci id="A1.p2.1.m1.1.1.2.cmml" xref="A1.p2.1.m1.1.1.2">𝑥</ci><cn type="integer" id="A1.p2.1.m1.1.1.3.cmml" xref="A1.p2.1.m1.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.p2.1.m1.1c">x_{1}</annotation></semantics></math>, and the gate is shutting off any information for negative <math id="A1.p2.2.m2.1" class="ltx_Math" alttext="x_{1}" display="inline"><semantics id="A1.p2.2.m2.1a"><msub id="A1.p2.2.m2.1.1" xref="A1.p2.2.m2.1.1.cmml"><mi id="A1.p2.2.m2.1.1.2" xref="A1.p2.2.m2.1.1.2.cmml">x</mi><mn id="A1.p2.2.m2.1.1.3" xref="A1.p2.2.m2.1.1.3.cmml">1</mn></msub><annotation-xml encoding="MathML-Content" id="A1.p2.2.m2.1b"><apply id="A1.p2.2.m2.1.1.cmml" xref="A1.p2.2.m2.1.1"><csymbol cd="ambiguous" id="A1.p2.2.m2.1.1.1.cmml" xref="A1.p2.2.m2.1.1">subscript</csymbol><ci id="A1.p2.2.m2.1.1.2.cmml" xref="A1.p2.2.m2.1.1.2">𝑥</ci><cn type="integer" id="A1.p2.2.m2.1.1.3.cmml" xref="A1.p2.2.m2.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.p2.2.m2.1c">x_{1}</annotation></semantics></math>.
Looking at <a href="#A1.F3.sf5" title="In Appendix A CGAU on XOR dataset ‣ Client Adaptation improves Federated Learning with Simulated Non-IID Clients" class="ltx_ref"><span class="ltx_text ltx_ref_tag">Fig.</span> <span class="ltx_text ltx_ref_tag">3(e)</span></a> and <a href="#A1.F3.sf6" title="In Appendix A CGAU on XOR dataset ‣ Client Adaptation improves Federated Learning with Simulated Non-IID Clients" class="ltx_ref"><span class="ltx_text ltx_ref_tag">Fig.</span> <span class="ltx_text ltx_ref_tag">3(f)</span></a>, we see how the CGAU has learnt to modulate the up clients filter feature by moving the shift in activation towards more positive <math id="A1.p2.3.m3.1" class="ltx_Math" alttext="x_{1}" display="inline"><semantics id="A1.p2.3.m3.1a"><msub id="A1.p2.3.m3.1.1" xref="A1.p2.3.m3.1.1.cmml"><mi id="A1.p2.3.m3.1.1.2" xref="A1.p2.3.m3.1.1.2.cmml">x</mi><mn id="A1.p2.3.m3.1.1.3" xref="A1.p2.3.m3.1.1.3.cmml">1</mn></msub><annotation-xml encoding="MathML-Content" id="A1.p2.3.m3.1b"><apply id="A1.p2.3.m3.1.1.cmml" xref="A1.p2.3.m3.1.1"><csymbol cd="ambiguous" id="A1.p2.3.m3.1.1.1.cmml" xref="A1.p2.3.m3.1.1">subscript</csymbol><ci id="A1.p2.3.m3.1.1.2.cmml" xref="A1.p2.3.m3.1.1.2">𝑥</ci><cn type="integer" id="A1.p2.3.m3.1.1.3.cmml" xref="A1.p2.3.m3.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.p2.3.m3.1c">x_{1}</annotation></semantics></math>, and similarly, we see that the it has learnt to shift the gating for the down client towards more negative <math id="A1.p2.4.m4.1" class="ltx_Math" alttext="x_{1}" display="inline"><semantics id="A1.p2.4.m4.1a"><msub id="A1.p2.4.m4.1.1" xref="A1.p2.4.m4.1.1.cmml"><mi id="A1.p2.4.m4.1.1.2" xref="A1.p2.4.m4.1.1.2.cmml">x</mi><mn id="A1.p2.4.m4.1.1.3" xref="A1.p2.4.m4.1.1.3.cmml">1</mn></msub><annotation-xml encoding="MathML-Content" id="A1.p2.4.m4.1b"><apply id="A1.p2.4.m4.1.1.cmml" xref="A1.p2.4.m4.1.1"><csymbol cd="ambiguous" id="A1.p2.4.m4.1.1.1.cmml" xref="A1.p2.4.m4.1.1">subscript</csymbol><ci id="A1.p2.4.m4.1.1.2.cmml" xref="A1.p2.4.m4.1.1.2">𝑥</ci><cn type="integer" id="A1.p2.4.m4.1.1.3.cmml" xref="A1.p2.4.m4.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.p2.4.m4.1c">x_{1}</annotation></semantics></math>.</p>
</div>
<div id="A1.p3" class="ltx_para">
<p id="A1.p3.1" class="ltx_p">In a sense, this enables the CGAU to solve the problem for the down client using “client-specific expression”, and enables the CGAU to solve the problem for the up client by using “client-specific modulation”; this assertion can be confirmed by turning off the two types of conditioning in making a plot like <a href="#A1.F3.sf2" title="In Appendix A CGAU on XOR dataset ‣ Client Adaptation improves Federated Learning with Simulated Non-IID Clients" class="ltx_ref"><span class="ltx_text ltx_ref_tag">Fig.</span> <span class="ltx_text ltx_ref_tag">3(b)</span></a>, which is shown on <a href="#A1.F3.sf8" title="In Appendix A CGAU on XOR dataset ‣ Client Adaptation improves Federated Learning with Simulated Non-IID Clients" class="ltx_ref"><span class="ltx_text ltx_ref_tag">Fig.</span> <span class="ltx_text ltx_ref_tag">3(h)</span></a> and <a href="#A1.F3.sf7" title="In Appendix A CGAU on XOR dataset ‣ Client Adaptation improves Federated Learning with Simulated Non-IID Clients" class="ltx_ref"><span class="ltx_text ltx_ref_tag">Fig.</span> <span class="ltx_text ltx_ref_tag">3(g)</span></a>.</p>
</div>
<figure id="A1.fig1" class="ltx_figure">
<div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_2">
<figure id="A1.F3.sf1" class="ltx_figure ltx_figure_panel"><img src="/html/2007.04806/assets/figures/XOR/1.png" id="A1.F3.sf1.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="479" height="379" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span id="A1.F3.sf1.2.1.1" class="ltx_text" style="font-size:90%;">(a)</span> </span><span id="A1.F3.sf1.3.2" class="ltx_text" style="font-size:90%;">Decision boundaries for MLP.</span></figcaption>
</figure>
</div>
<div class="ltx_flex_cell ltx_flex_size_2">
<figure id="A1.F3.sf2" class="ltx_figure ltx_figure_panel"><img src="/html/2007.04806/assets/figures/XOR/2.png" id="A1.F3.sf2.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="479" height="379" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span id="A1.F3.sf2.2.1.1" class="ltx_text" style="font-size:90%;">(b)</span> </span><span id="A1.F3.sf2.3.2" class="ltx_text" style="font-size:90%;">Decision boundaries for CGAU.</span></figcaption>
</figure>
</div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_2">
<figure id="A1.F3.sf3" class="ltx_figure ltx_figure_panel"><img src="/html/2007.04806/assets/figures/XOR/c.png" id="A1.F3.sf3.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="479" height="368" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span id="A1.F3.sf3.2.1.1" class="ltx_text" style="font-size:90%;">(c)</span> </span><span id="A1.F3.sf3.3.2" class="ltx_text" style="font-size:90%;">CGAU filter activation without conditioning.</span></figcaption>
</figure>
</div>
<div class="ltx_flex_cell ltx_flex_size_2">
<figure id="A1.F3.sf4" class="ltx_figure ltx_figure_panel"><img src="/html/2007.04806/assets/figures/XOR/d.png" id="A1.F3.sf4.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="479" height="380" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span id="A1.F3.sf4.2.1.1" class="ltx_text" style="font-size:90%;">(d)</span> </span><span id="A1.F3.sf4.3.2" class="ltx_text" style="font-size:90%;">CGAU gating activation without conditioning.</span></figcaption>
</figure>
</div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_2">
<figure id="A1.F3.sf5" class="ltx_figure ltx_figure_panel"><img src="/html/2007.04806/assets/figures/XOR/a.png" id="A1.F3.sf5.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="479" height="368" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span id="A1.F3.sf5.2.1.1" class="ltx_text" style="font-size:90%;">(e)</span> </span><span id="A1.F3.sf5.3.2" class="ltx_text" style="font-size:90%;">CGAU filter activation with conditioning.</span></figcaption>
</figure>
</div>
<div class="ltx_flex_cell ltx_flex_size_2">
<figure id="A1.F3.sf6" class="ltx_figure ltx_figure_panel"><img src="/html/2007.04806/assets/figures/XOR/b.png" id="A1.F3.sf6.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="479" height="380" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span id="A1.F3.sf6.2.1.1" class="ltx_text" style="font-size:90%;">(f)</span> </span><span id="A1.F3.sf6.3.2" class="ltx_text" style="font-size:90%;">CGAU gate activation with conditioning.</span></figcaption>
</figure>
</div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_2">
<figure id="A1.F3.sf7" class="ltx_figure ltx_figure_panel"><img src="/html/2007.04806/assets/figures/XOR/3.png" id="A1.F3.sf7.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="479" height="380" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span id="A1.F3.sf7.2.1.1" class="ltx_text" style="font-size:90%;">(g)</span> </span><span id="A1.F3.sf7.3.2" class="ltx_text" style="font-size:90%;">Decision boundaries for CGAU without client modulation.</span></figcaption>
</figure>
</div>
<div class="ltx_flex_cell ltx_flex_size_2">
<figure id="A1.F3.sf8" class="ltx_figure ltx_figure_panel"><img src="/html/2007.04806/assets/figures/XOR/4.png" id="A1.F3.sf8.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="479" height="380" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span id="A1.F3.sf8.2.1.1" class="ltx_text" style="font-size:90%;">(h)</span> </span><span id="A1.F3.sf8.3.2" class="ltx_text" style="font-size:90%;">Decision boundaries for CGAU with client expression.</span></figcaption>
</figure>
</div>
</div>
</figure>
</section>
</article>
</div>
<div class="ar5iv-footer"><a href="/html/2007.04805" class="ar5iv-nav-button ar5iv-nav-button-prev">◄</a>
    <a class="ar5iv-home-button" href="/"><img height="40" alt="ar5iv homepage" src="/assets/ar5iv.png"></a>
    <a href="/feeling_lucky" class="ar5iv-text-button">Feeling<br>lucky?</a>
    <a href="/log/2007.04806" class="ar5iv-text-button ar5iv-severity-ok">Conversion<br>report</a>
    <a class="ar5iv-text-button" target="_blank" href="https://github.com/dginev/ar5iv/issues/new?template=improve-article--arxiv-id-.md&title=Improve+article+2007.04806">Report<br>an issue</a>
    <a href="https://arxiv.org/abs/2007.04806" class="ar5iv-text-button arxiv-ui-theme">View&nbsp;original<br>on&nbsp;arXiv</a><a href="/html/2007.04807" class="ar5iv-nav-button ar5iv-nav-button-next">►</a>
</div><footer class="ltx_page_footer">
<a class="ar5iv-toggle-color-scheme" href="javascript:toggleColorScheme()" title="Toggle ar5iv color scheme"><span class="color-scheme-icon"></span></a>
<a class="ar5iv-footer-button" href="https://arxiv.org/help/license" target="_blank">Copyright</a>
<a class="ar5iv-footer-button" href="https://arxiv.org/help/policies/privacy_policy" target="_blank">Privacy Policy</a>

<div class="ltx_page_logo">Generated  on Thu Mar 14 13:02:40 2024 by <a target="_blank" href="http://dlmf.nist.gov/LaTeXML/" class="ltx_LaTeXML_logo"><span style="letter-spacing:-0.2em; margin-right:0.1em;">L<span class="ltx_font_smallcaps" style="position:relative; bottom:2.2pt;">a</span>T<span class="ltx_font_smallcaps" style="font-size:120%;position:relative; bottom:-0.2ex;">e</span></span><span style="font-size:90%; position:relative; bottom:-0.2ex;">XML</span><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAsAAAAOCAYAAAD5YeaVAAAAAXNSR0IArs4c6QAAAAZiS0dEAP8A/wD/oL2nkwAAAAlwSFlzAAALEwAACxMBAJqcGAAAAAd0SU1FB9wKExQZLWTEaOUAAAAddEVYdENvbW1lbnQAQ3JlYXRlZCB3aXRoIFRoZSBHSU1Q72QlbgAAAdpJREFUKM9tkL+L2nAARz9fPZNCKFapUn8kyI0e4iRHSR1Kb8ng0lJw6FYHFwv2LwhOpcWxTjeUunYqOmqd6hEoRDhtDWdA8ApRYsSUCDHNt5ul13vz4w0vWCgUnnEc975arX6ORqN3VqtVZbfbTQC4uEHANM3jSqXymFI6yWazP2KxWAXAL9zCUa1Wy2tXVxheKA9YNoR8Pt+aTqe4FVVVvz05O6MBhqUIBGk8Hn8HAOVy+T+XLJfLS4ZhTiRJgqIoVBRFIoric47jPnmeB1mW/9rr9ZpSSn3Lsmir1fJZlqWlUonKsvwWwD8ymc/nXwVBeLjf7xEKhdBut9Hr9WgmkyGEkJwsy5eHG5vN5g0AKIoCAEgkEkin0wQAfN9/cXPdheu6P33fBwB4ngcAcByHJpPJl+fn54mD3Gg0NrquXxeLRQAAwzAYj8cwTZPwPH9/sVg8PXweDAauqqr2cDjEer1GJBLBZDJBs9mE4zjwfZ85lAGg2+06hmGgXq+j3+/DsixYlgVN03a9Xu8jgCNCyIegIAgx13Vfd7vdu+FweG8YRkjXdWy329+dTgeSJD3ieZ7RNO0VAXAPwDEAO5VKndi2fWrb9jWl9Esul6PZbDY9Go1OZ7PZ9z/lyuD3OozU2wAAAABJRU5ErkJggg==" alt="Mascot Sammy"></a>
</div></footer>
</div>

    <script>
      var canMathML = typeof(MathMLElement) == "function";
      if (!canMathML) {
        var body = document.querySelector("body");
        body.firstElementChild.setAttribute('style', 'opacity: 0;');
        var loading = document.createElement("div");
        loading.setAttribute("id", "mathjax-loading-spinner");
        var message = document.createElement("div");
        message.setAttribute("id", "mathjax-loading-message");
        message.innerText = "Typesetting Equations...";
        body.prepend(loading);
        body.prepend(message);

        var el = document.createElement("script");
        el.src = "https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js";
        document.querySelector("head").appendChild(el);

        window.MathJax = {
          startup: {
            pageReady: () => {
              return MathJax.startup.defaultPageReady().then(() => {
                body.removeChild(loading);
                body.removeChild(message);
                body.firstElementChild.removeAttribute('style');
              }); } } };
      }
    </script>
    <script>
    // Auxiliary function, building the preview feature when
    // an inline citation is clicked
    function clicked_cite(e) {
      e.preventDefault();
      let cite = this.closest('.ltx_cite');
      let next = cite.nextSibling;
      if (next && next.nodeType == Node.ELEMENT_NODE && next.getAttribute('class') == "ar5iv-bibitem-preview") {
        next.remove();
        return; }
      // Before adding a preview modal,
      // cleanup older previews, in case they're still open
      document.querySelectorAll('span.ar5iv-bibitem-preview').forEach(function(node) {
        node.remove();
      })

      // Create the preview
      preview = document.createElement('span');
      preview.setAttribute('class','ar5iv-bibitem-preview');
      let target = document.getElementById(this.getAttribute('href').slice(1));
      target.childNodes.forEach(function (child) {
        preview.append(child.cloneNode(true));
      });
      let close_x = document.createElement('button');
      close_x.setAttribute("aria-label","Close modal for bibliography item preview");
      close_x.textContent = "×";
      close_x.setAttribute('class', 'ar5iv-button-close-preview');
      close_x.setAttribute('onclick','this.parentNode.remove()');
      preview.append(close_x);
      preview.querySelectorAll('.ltx_tag_bibitem').forEach(function(node) {
        node.remove();
      });
      cite.parentNode.insertBefore(preview, cite.nextSibling);
      return;
    }
    // Global Document initialization:
    // - assign the preview feature to all inline citation links
    document.querySelectorAll(".ltx_cite .ltx_ref").forEach(function (link) {
      link.addEventListener("click", clicked_cite);
    });
    </script>
    </body>
</html>
