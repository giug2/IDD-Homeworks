<!DOCTYPE html>
<html lang="en">
<head>
<meta content="text/html; charset=utf-8" http-equiv="content-type"/>
<title>Deep Probability Segmentation: Are segmentation models probability estimators?</title>
<!--Generated on Thu Sep 19 07:48:41 2024 by LaTeXML (version 0.8.8) http://dlmf.nist.gov/LaTeXML/.-->
<meta content="width=device-width, initial-scale=1, shrink-to-fit=no" name="viewport"/>
<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet" type="text/css"/>
<link href="/static/browse/0.3.4/css/ar5iv.0.7.9.min.css" rel="stylesheet" type="text/css"/>
<link href="/static/browse/0.3.4/css/ar5iv-fonts.0.7.9.min.css" rel="stylesheet" type="text/css"/>
<link href="/static/browse/0.3.4/css/latexml_styles.css" rel="stylesheet" type="text/css"/>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.3.3/html2canvas.min.js"></script>
<script src="/static/browse/0.3.4/js/addons_new.js"></script>
<script src="/static/browse/0.3.4/js/feedbackOverlay.js"></script>
<meta content="
deep probability estimation,  image segmentation,  convolutional neural networks
" lang="en" name="keywords"/>
<base href="/html/2409.12535v1/"/></head>
<body>
<nav class="ltx_page_navbar">
<nav class="ltx_TOC">
<ol class="ltx_toclist">
<li class="ltx_tocentry ltx_tocentry_section"><a class="ltx_ref" href="https://arxiv.org/html/2409.12535v1#S1" title="In Deep Probability Segmentation: Are segmentation models probability estimators?"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">I </span><span class="ltx_text ltx_font_smallcaps">Introduction</span></span></a></li>
<li class="ltx_tocentry ltx_tocentry_section"><a class="ltx_ref" href="https://arxiv.org/html/2409.12535v1#S2" title="In Deep Probability Segmentation: Are segmentation models probability estimators?"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">II </span><span class="ltx_text ltx_font_smallcaps">Related works</span></span></a></li>
<li class="ltx_tocentry ltx_tocentry_section">
<a class="ltx_ref" href="https://arxiv.org/html/2409.12535v1#S3" title="In Deep Probability Segmentation: Are segmentation models probability estimators?"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">III </span><span class="ltx_text ltx_font_smallcaps">Material and methods</span></span></a>
<ol class="ltx_toclist ltx_toclist_section">
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2409.12535v1#S3.SS1" title="In III Material and methods ‣ Deep Probability Segmentation: Are segmentation models probability estimators?"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref"><span class="ltx_text">III-A</span> </span><span class="ltx_text ltx_font_italic">Case studies</span></span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2409.12535v1#S3.SS2" title="In III Material and methods ‣ Deep Probability Segmentation: Are segmentation models probability estimators?"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref"><span class="ltx_text">III-B</span> </span><span class="ltx_text ltx_font_italic">Problem formulation</span></span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2409.12535v1#S3.SS3" title="In III Material and methods ‣ Deep Probability Segmentation: Are segmentation models probability estimators?"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref"><span class="ltx_text">III-C</span> </span><span class="ltx_text ltx_font_italic">Evaluation metrics</span></span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2409.12535v1#S3.SS4" title="In III Material and methods ‣ Deep Probability Segmentation: Are segmentation models probability estimators?"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref"><span class="ltx_text">III-D</span> </span><span class="ltx_text ltx_font_italic">CaPE regularization</span></span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2409.12535v1#S3.SS5" title="In III Material and methods ‣ Deep Probability Segmentation: Are segmentation models probability estimators?"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref"><span class="ltx_text">III-E</span> </span><span class="ltx_text ltx_font_italic">Experimental design</span></span></a></li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_section"><a class="ltx_ref" href="https://arxiv.org/html/2409.12535v1#S4" title="In Deep Probability Segmentation: Are segmentation models probability estimators?"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">IV </span><span class="ltx_text ltx_font_smallcaps">Results and discussions</span></span></a></li>
<li class="ltx_tocentry ltx_tocentry_section"><a class="ltx_ref" href="https://arxiv.org/html/2409.12535v1#S5" title="In Deep Probability Segmentation: Are segmentation models probability estimators?"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">V </span><span class="ltx_text ltx_font_smallcaps">Conclusions</span></span></a></li>
</ol></nav>
</nav>
<div class="ltx_page_main">
<div class="ltx_page_content">
<article class="ltx_document ltx_authors_1line">
<h1 class="ltx_title ltx_title_document">Deep Probability Segmentation: Are segmentation models probability estimators? 
<br class="ltx_break"/>
</h1>
<div class="ltx_authors">
<span class="ltx_creator ltx_role_author">
<span class="ltx_personname">Simone Fassio
</span><span class="ltx_author_notes">
<span class="ltx_contact ltx_role_affiliation"><span class="ltx_text ltx_font_italic" id="id1.1.id1">Politecnico di Torino</span>
<br class="ltx_break"/>Torino, Italy 
<br class="ltx_break"/>simone.fassio@studenti.polito.it
</span></span></span>
<span class="ltx_author_before">  </span><span class="ltx_creator ltx_role_author">
<span class="ltx_personname">Simone Monaco, Daniele Apiletti
</span><span class="ltx_author_notes">
<span class="ltx_contact ltx_role_affiliation"><span class="ltx_text ltx_font_italic" id="id2.1.id1">Deparment of Control and Computing engineering, Politecnico di Torino</span>
<br class="ltx_break"/>Torino, Italy 
<br class="ltx_break"/>{name}.{surname}@polito.it
</span></span></span>
</div>
<div class="ltx_abstract">
<h6 class="ltx_title ltx_title_abstract">Abstract</h6>
<p class="ltx_p" id="id3.id1">Deep learning has revolutionized various fields by enabling highly accurate predictions and estimates. One important application is probabilistic prediction, where models estimate the probability of events rather than deterministic outcomes. This approach is particularly relevant and, therefore, still unexplored for segmentation tasks where each pixel in an image needs to be classified. Conventional models often overlook the probabilistic nature of labels, but accurate uncertainty estimation is crucial for improving the reliability and applicability of models.</p>
<p class="ltx_p" id="id4.id2">In this study, we applied Calibrated Probability Estimation (CaPE) to segmentation tasks to evaluate its impact on model calibration. Our results indicate that while CaPE improves calibration, its effect is less pronounced compared to classification tasks, suggesting that segmentation models can inherently provide better probability estimates. We also investigated the influence of dataset size and bin optimization on the effectiveness of calibration. Our results emphasize the expressive power of segmentation models as probability estimators and incorporate probabilistic reasoning, which is crucial for applications requiring precise uncertainty quantification.</p>
</div>
<div class="ltx_keywords">
<h6 class="ltx_title ltx_title_keywords">Index Terms: </h6>
deep probability estimation, image segmentation, convolutional neural networks

</div>
<section class="ltx_section" id="S1">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">I </span><span class="ltx_text ltx_font_smallcaps" id="S1.1.1">Introduction</span>
</h2>
<div class="ltx_para" id="S1.p1">
<p class="ltx_p" id="S1.p1.1">Machine learning, particularly deep learning, has transformed various fields by enabling models to achieve exceptional accuracy in predictions and estimates. This success is due to its ability to extract latent patterns from large data sets and generalize them to new cases. A widely used application of deep learning is supervised learning, where models learn to map the input data to a ground truth that represents the target outcome. Traditionally, this mapping is viewed as deterministic without considering the probabilistic nature that these labels may inherently have. However, this view changes when models answer questions such as <span class="ltx_text ltx_font_italic" id="S1.p1.1.1">will it rain heavily?</span> or <span class="ltx_text ltx_font_italic" id="S1.p1.1.2">will a forest fire affect a region?</span> where the answer is inherently probabilistic. Models developed for probabilistic predictions need to be trained on observed outcomes, which are accessible parts of the latent probability distribution. This paradigm shift, which involves aleatory uncertainty quantification within model prediction, has received only moderate attention, but traditional models generally yield inconsistent results <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.12535v1#bib.bib1" title="">1</a>]</cite>.</p>
</div>
<div class="ltx_para" id="S1.p2">
<p class="ltx_p" id="S1.p2.1">Besides this, an emerging and increasingly popular variant of classification tasks is segmentation, where the goal is to assign a class to each pixel in an input image. The probabilistic interpretation discussed above can of course also be applied to segmentation, but with the added complexity that spatial relationships between the pixels must be taken into account. Neighboring pixels often share contextual information that influences their labeling. However, as the image size increases, so does the uncertainty associated with these labels. This is due to the potential aleatory uncertainty arising from both the underlying probability distribution and annotation errors.</p>
</div>
<div class="ltx_para" id="S1.p3">
<p class="ltx_p" id="S1.p3.1">Considering this probabilistic view during segmentation is crucial for improving the reliability and applicability of the resulting models in practical scenarios. Accurate uncertainty estimation improves the robustness of segmentation results and provides valuable insights into the confidence levels of predictions. This capability is particularly important in areas where accurate segmentation supports decision making, risk assessment, and scientific research. Therefore, advanced methods that integrate probabilistic reasoning into segmentation models hold great promise for improving their effectiveness and versatility in various applications. Based on previous studies using neural networks as probability estimators <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.12535v1#bib.bib1" title="">1</a>]</cite>, we aim to extend this idea to segmentation tasks. This will allow us to investigate the impact of pixel correlations and assess how the latest models in this field can perform this type of task.</p>
</div>
<div class="ltx_para" id="S1.p4">
<p class="ltx_p" id="S1.p4.1">Our study applied Calibrated Probability Estimation (CaPE) to segmentation tasks to assess its impact on improving model calibration. Although CaPE led to improvements in calibration, its effectiveness appeared somewhat subdued compared to its performance on classification tasks. This observation suggests that many segmentation datasets inherently provide reasonably accurate probability estimates without additional calibration interventions. We also investigated possible correlations between the target event’s probability distribution and the training dataset’s size. Furthermore, we performed detailed investigations on optimizing the number of bins, a critical hyperparameter within the CaPE method.</p>
</div>
<div class="ltx_para" id="S1.p5">
<p class="ltx_p" id="S1.p5.1">By delving deeper into these aspects, we can not only evaluate the direct benefits of probabilistic modelling in segmentation, but also understand the nuanced factors influencing the quality of probability estimates in this context. This exploration is crucial for improving the reliability and applicability of segmentation models in various real-world scenarios, where accurate uncertainty quantification can significantly improve decision making and domain-specific applications.</p>
</div>
<div class="ltx_para" id="S1.p6">
<p class="ltx_p" id="S1.p6.1">The paper is structured as follows: Section <a class="ltx_ref" href="https://arxiv.org/html/2409.12535v1#S2" title="II Related works ‣ Deep Probability Segmentation: Are segmentation models probability estimators?"><span class="ltx_text ltx_ref_tag">II</span></a> gives an overview of related work on probabilistic estimation in neural networks and its application to segmentation tasks. Section <a class="ltx_ref" href="https://arxiv.org/html/2409.12535v1#S3" title="III Material and methods ‣ Deep Probability Segmentation: Are segmentation models probability estimators?"><span class="ltx_text ltx_ref_tag">III</span></a> outlines our methodology, including the implementation of Calibrated Probability Estimation (CaPE) in segmentation, details of the validation dataset and the evaluation metrics used. Section <a class="ltx_ref" href="https://arxiv.org/html/2409.12535v1#S4" title="IV Results and discussions ‣ Deep Probability Segmentation: Are segmentation models probability estimators?"><span class="ltx_text ltx_ref_tag">IV</span></a> presents and discusses the results. Section <a class="ltx_ref" href="https://arxiv.org/html/2409.12535v1#S5" title="V Conclusions ‣ Deep Probability Segmentation: Are segmentation models probability estimators?"><span class="ltx_text ltx_ref_tag">V</span></a> concludes with a summary of our results and suggestions for future research directions.</p>
</div>
</section>
<section class="ltx_section" id="S2">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">II </span><span class="ltx_text ltx_font_smallcaps" id="S2.1.1">Related works</span>
</h2>
<div class="ltx_para" id="S2.p1">
<p class="ltx_p" id="S2.p1.1">Deep neural networks, especially when applied to classification tasks, often produce probability estimates reflecting the model’s confidence. However, these estimates can be inaccurate, leading to poorly calibrated predictions. To overcome this challenge, several methods have been proposed to improve calibration, including post-processing techniques and ensembling.</p>
</div>
<div class="ltx_para" id="S2.p2">
<p class="ltx_p" id="S2.p2.1">Post-processing techniques aim to refine output probabilities to improve the calibration of unseen data. Notably, Guo et al. <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.12535v1#bib.bib2" title="">2</a>]</cite> introduced temperature scaling, incorporating a temperature parameter into the softmax function. This parameter is optimized to minimize negative log-likelihood loss, thereby adjusting the model’s confidence levels to improve calibration. Another approach involves training a recalibration model based on the outputs of an uncalibrated model <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.12535v1#bib.bib3" title="">3</a>]</cite>. These methods have demonstrated effectiveness in enhancing the calibration of deep learning algorithms in a model-agnostic fashion, without altering their fundamental architectures.</p>
</div>
<div class="ltx_para" id="S2.p3">
<p class="ltx_p" id="S2.p3.1">Conversely, ensembling techniques combine multiple models to enhance generalization and alleviate miscalibration. For instance, Zhang et al. <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.12535v1#bib.bib4" title="">4</a>]</cite> proposed Mix-n-Match, which employs a single model and combines predictions using multiple temperature scaling transformations.</p>
</div>
<div class="ltx_para" id="S2.p4">
<p class="ltx_p" id="S2.p4.1">Recently, Liu et al. <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.12535v1#bib.bib1" title="">1</a>]</cite> introduced Calibrated Probability Estimation (CaPE), a training technique aimed at improving neural networks’ ability to generate reliable probability estimates. The method ensures that the output probabilities match the empirical probabilities derived from the data, thereby calibrating the model results when confronted with aleatory uncertainty in the data. While this method has proven successful on various synthetic and real-world classification tasks, it has not yet been applied to tasks with non-independently identically distributed (<span class="ltx_text ltx_font_italic" id="S2.p4.1.1">i.i.d.</span>) data, such as image segmentation problems or predictions on graph structures. This work aims to extend this analysis in this direction and show how traditional models behave when confronted with aleatory uncertainty in the data and how calibration affects them.</p>
</div>
<div class="ltx_para" id="S2.p5">
<p class="ltx_p" id="S2.p5.1">Deep learning segmentation models have been used in various fields that are inherently fraught with uncertainty. Among these, medical imaging is a prominent application area where researchers have grappled with the challenge of overcoming uncertainty in label assignment. For example, Kohl et al. <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.12535v1#bib.bib5" title="">5</a>]</cite> introduced a probabilistic U-Net, which provides segmentation results along with the uncertainty associated with these predictions. This capability is crucial in medical diagnostics, as understanding the confidence level of detection significantly influences clinical decisions. In addition, Krygier et al. <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.12535v1#bib.bib6" title="">6</a>]</cite> investigated the impact of labeling uncertainty in 3D medical images and proposed a method to quantify this uncertainty through Bayesian convolutional neural networks and Monte Carlo dropout. Their results illustrate the complexity of uncertainty distributions in simulations that challenge conventional segmentation boundaries.</p>
</div>
<div class="ltx_para" id="S2.p6">
<p class="ltx_p" id="S2.p6.1">In another domain, Hu et al. <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.12535v1#bib.bib7" title="">7</a>]</cite> explored the use of deep learning architectures for post-processing deterministic numerical weather predictions of precipitation, focusing on improving forecast accuracy and deriving uncertainty estimates. Their segmentation approach, leveraging distributional parameters of a censored shifted gamma distribution, addresses the uncertainty arising from the numerical simulation inputs. However, the applicability of this method is highly task-dependent.</p>
</div>
<div class="ltx_para" id="S2.p7">
<p class="ltx_p" id="S2.p7.1">In addition, Monaco et al. <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.12535v1#bib.bib8" title="">8</a>]</cite> investigated segmentation models for assessing the severity of wildfires, emphasizing the challenge posed by unreliable ground truth labels. Their work emphasizes the importance of understanding the uncertainty of the input data to predict the severity of wildfires accurately.</p>
</div>
<div class="ltx_para" id="S2.p8">
<p class="ltx_p" id="S2.p8.1">To date, the capabilities of these segmentation models as deep probability estimators have not been systematically investigated.</p>
</div>
</section>
<section class="ltx_section" id="S3">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">III </span><span class="ltx_text ltx_font_smallcaps" id="S3.1.1">Material and methods</span>
</h2>
<section class="ltx_subsection" id="S3.SS1">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection"><span class="ltx_text" id="S3.SS1.4.1.1">III-A</span> </span><span class="ltx_text ltx_font_italic" id="S3.SS1.5.2">Case studies</span>
</h3>
<div class="ltx_para" id="S3.SS1.p1">
<p class="ltx_p" id="S3.SS1.p1.1">In this study, we use two different datasets to evaluate the performance of our proposed model in different domains. The first dataset is the German Weather Service (GWS) dataset, which focuses on weather forecasting and predicts the probability of exceeding a certain weather threshold at each location. The second dataset was developed specifically for Burned Area Detection (BAD) and estimating the extent of damage. It includes the segmentation of satellite images and aims to determine the probability that the area represented by each pixel is burnt with a predefined severity.</p>
</div>
<div class="ltx_para" id="S3.SS1.p2">
<p class="ltx_p" id="S3.SS1.p2.1">The <span class="ltx_text ltx_font_bold" id="S3.SS1.p2.1.1">GWS</span> dataset comprises quality-controlled rainfall-depth composites gathered from 17 operational Doppler radars, providing a comprehensive perspective on precipitation patterns. Our analysis uses 30-minute precipitation data, comprising three precipitation maps from the past 30 minutes, to predict the probability of precipitation exceeding various thresholds in each pixel one hour after the most recent measurement. Given the size of the dataset, we decided to use only part of it, as using the entire dataset would not provide additional valuable information. Therefore, we reduced the number of events to 3000, which we selected from the 15,000 events with the highest average precipitation, which is in line with our task. Furthermore, from the original resolution of 900x900, we only considered the central part of 512x384, which was then scaled to 128x96. This procedure reduced the demand for computational resources, but we observed that it did not significantly impact the overall result.</p>
</div>
<div class="ltx_para" id="S3.SS1.p3">
<p class="ltx_p" id="S3.SS1.p3.1">The <span class="ltx_text ltx_font_bold" id="S3.SS1.p3.1.1">BAD</span> dataset contains 73 satellite images of various forests damaged by wildfires across Europe with a resolution of up to 10 meters per pixel. The Sentinel-2 L2A satellite mission collected the data, while the target labels were generated from Copernicus Emergency Management Service annotations, with five severity levels from undamaged to completely destroyed <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.12535v1#bib.bib9" title="">9</a>, <a class="ltx_ref" href="https://arxiv.org/html/2409.12535v1#bib.bib8" title="">8</a>]</cite>. The images we used were taken within one month of the wildfire event, ensuring minimal cloud cover. The original images of the dataset are divided into tiles of 128x96 pixels. To remain consistent with the previous dataset, we select only the tiles that contain at least one burned pixel, resulting in 2,691 valid tiles.</p>
</div>
<div class="ltx_para" id="S3.SS1.p4">
<p class="ltx_p" id="S3.SS1.p4.1">Table <a class="ltx_ref" href="https://arxiv.org/html/2409.12535v1#S3.T1" title="TABLE I ‣ III-A Case studies ‣ III Material and methods ‣ Deep Probability Segmentation: Are segmentation models probability estimators?"><span class="ltx_text ltx_ref_tag">I</span></a> describes the thresholds that were considered for each dataset and their respective probabilities of being exceeded.</p>
</div>
<figure class="ltx_table" id="S3.T1">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_table">TABLE I: </span>Thresholds and Probabilities for Each Dataset</figcaption>
<table class="ltx_tabular ltx_centering ltx_align_middle" id="S3.T1.1">
<tbody class="ltx_tbody">
<tr class="ltx_tr" id="S3.T1.1.1.1">
<td class="ltx_td ltx_align_center ltx_border_l ltx_border_r ltx_border_t" id="S3.T1.1.1.1.1"><span class="ltx_text ltx_font_bold" id="S3.T1.1.1.1.1.1">Dataset</span></td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S3.T1.1.1.1.2"><span class="ltx_text ltx_font_bold" id="S3.T1.1.1.1.2.1">Threshold</span></td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S3.T1.1.1.1.3"><span class="ltx_text ltx_font_bold" id="S3.T1.1.1.1.3.1">Probability (%)</span></td>
</tr>
<tr class="ltx_tr" id="S3.T1.1.2.2">
<td class="ltx_td ltx_align_center ltx_border_l ltx_border_r ltx_border_t" id="S3.T1.1.2.2.1" rowspan="5"><span class="ltx_text" id="S3.T1.1.2.2.1.1">GWS</span></td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S3.T1.1.2.2.2">0.02</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S3.T1.1.2.2.3">30</td>
</tr>
<tr class="ltx_tr" id="S3.T1.1.3.3">
<td class="ltx_td ltx_align_center ltx_border_r" id="S3.T1.1.3.3.1">0.125</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S3.T1.1.3.3.2">14</td>
</tr>
<tr class="ltx_tr" id="S3.T1.1.4.4">
<td class="ltx_td ltx_align_center ltx_border_r" id="S3.T1.1.4.4.1">0.250</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S3.T1.1.4.4.2">7</td>
</tr>
<tr class="ltx_tr" id="S3.T1.1.5.5">
<td class="ltx_td ltx_align_center ltx_border_r" id="S3.T1.1.5.5.1">0.5</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S3.T1.1.5.5.2">3.2</td>
</tr>
<tr class="ltx_tr" id="S3.T1.1.6.6">
<td class="ltx_td ltx_align_center ltx_border_r" id="S3.T1.1.6.6.1">0.75</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S3.T1.1.6.6.2">1.1</td>
</tr>
<tr class="ltx_tr" id="S3.T1.1.7.7">
<td class="ltx_td ltx_align_center ltx_border_b ltx_border_l ltx_border_r ltx_border_t" id="S3.T1.1.7.7.1" rowspan="3"><span class="ltx_text" id="S3.T1.1.7.7.1.1">BAD</span></td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S3.T1.1.7.7.2">Severity Level 1</td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S3.T1.1.7.7.3">46</td>
</tr>
<tr class="ltx_tr" id="S3.T1.1.8.8">
<td class="ltx_td ltx_align_center ltx_border_r" id="S3.T1.1.8.8.1">Severity Level 3</td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S3.T1.1.8.8.2">27</td>
</tr>
<tr class="ltx_tr" id="S3.T1.1.9.9">
<td class="ltx_td ltx_align_center ltx_border_b ltx_border_r" id="S3.T1.1.9.9.1">Severity Level 4</td>
<td class="ltx_td ltx_align_center ltx_border_b ltx_border_r" id="S3.T1.1.9.9.2">14</td>
</tr>
</tbody>
</table>
</figure>
</section>
<section class="ltx_subsection" id="S3.SS2">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection"><span class="ltx_text" id="S3.SS2.4.1.1">III-B</span> </span><span class="ltx_text ltx_font_italic" id="S3.SS2.5.2">Problem formulation</span>
</h3>
<div class="ltx_para" id="S3.SS2.p1">
<p class="ltx_p" id="S3.SS2.p1.6">The probability estimation task involves evaluating the likelihood of an event of interest based on the available data. In our context, we consider a dataset comprising <math alttext="n" class="ltx_Math" display="inline" id="S3.SS2.p1.1.m1.1"><semantics id="S3.SS2.p1.1.m1.1a"><mi id="S3.SS2.p1.1.m1.1.1" xref="S3.SS2.p1.1.m1.1.1.cmml">n</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.1.m1.1b"><ci id="S3.SS2.p1.1.m1.1.1.cmml" xref="S3.SS2.p1.1.m1.1.1">𝑛</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.1.m1.1c">n</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p1.1.m1.1d">italic_n</annotation></semantics></math> example images <math alttext="x_{i}" class="ltx_Math" display="inline" id="S3.SS2.p1.2.m2.1"><semantics id="S3.SS2.p1.2.m2.1a"><msub id="S3.SS2.p1.2.m2.1.1" xref="S3.SS2.p1.2.m2.1.1.cmml"><mi id="S3.SS2.p1.2.m2.1.1.2" xref="S3.SS2.p1.2.m2.1.1.2.cmml">x</mi><mi id="S3.SS2.p1.2.m2.1.1.3" xref="S3.SS2.p1.2.m2.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.2.m2.1b"><apply id="S3.SS2.p1.2.m2.1.1.cmml" xref="S3.SS2.p1.2.m2.1.1"><csymbol cd="ambiguous" id="S3.SS2.p1.2.m2.1.1.1.cmml" xref="S3.SS2.p1.2.m2.1.1">subscript</csymbol><ci id="S3.SS2.p1.2.m2.1.1.2.cmml" xref="S3.SS2.p1.2.m2.1.1.2">𝑥</ci><ci id="S3.SS2.p1.2.m2.1.1.3.cmml" xref="S3.SS2.p1.2.m2.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.2.m2.1c">x_{i}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p1.2.m2.1d">italic_x start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT</annotation></semantics></math> of size <math alttext="D\times W" class="ltx_Math" display="inline" id="S3.SS2.p1.3.m3.1"><semantics id="S3.SS2.p1.3.m3.1a"><mrow id="S3.SS2.p1.3.m3.1.1" xref="S3.SS2.p1.3.m3.1.1.cmml"><mi id="S3.SS2.p1.3.m3.1.1.2" xref="S3.SS2.p1.3.m3.1.1.2.cmml">D</mi><mo id="S3.SS2.p1.3.m3.1.1.1" lspace="0.222em" rspace="0.222em" xref="S3.SS2.p1.3.m3.1.1.1.cmml">×</mo><mi id="S3.SS2.p1.3.m3.1.1.3" xref="S3.SS2.p1.3.m3.1.1.3.cmml">W</mi></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.3.m3.1b"><apply id="S3.SS2.p1.3.m3.1.1.cmml" xref="S3.SS2.p1.3.m3.1.1"><times id="S3.SS2.p1.3.m3.1.1.1.cmml" xref="S3.SS2.p1.3.m3.1.1.1"></times><ci id="S3.SS2.p1.3.m3.1.1.2.cmml" xref="S3.SS2.p1.3.m3.1.1.2">𝐷</ci><ci id="S3.SS2.p1.3.m3.1.1.3.cmml" xref="S3.SS2.p1.3.m3.1.1.3">𝑊</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.3.m3.1c">D\times W</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p1.3.m3.1d">italic_D × italic_W</annotation></semantics></math> along with their corresponding segmentation maps <math alttext="y_{i}" class="ltx_Math" display="inline" id="S3.SS2.p1.4.m4.1"><semantics id="S3.SS2.p1.4.m4.1a"><msub id="S3.SS2.p1.4.m4.1.1" xref="S3.SS2.p1.4.m4.1.1.cmml"><mi id="S3.SS2.p1.4.m4.1.1.2" xref="S3.SS2.p1.4.m4.1.1.2.cmml">y</mi><mi id="S3.SS2.p1.4.m4.1.1.3" xref="S3.SS2.p1.4.m4.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.4.m4.1b"><apply id="S3.SS2.p1.4.m4.1.1.cmml" xref="S3.SS2.p1.4.m4.1.1"><csymbol cd="ambiguous" id="S3.SS2.p1.4.m4.1.1.1.cmml" xref="S3.SS2.p1.4.m4.1.1">subscript</csymbol><ci id="S3.SS2.p1.4.m4.1.1.2.cmml" xref="S3.SS2.p1.4.m4.1.1.2">𝑦</ci><ci id="S3.SS2.p1.4.m4.1.1.3.cmml" xref="S3.SS2.p1.4.m4.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.4.m4.1c">y_{i}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p1.4.m4.1d">italic_y start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT</annotation></semantics></math> of the same dimensions. Each pixel in <math alttext="y_{i}" class="ltx_Math" display="inline" id="S3.SS2.p1.5.m5.1"><semantics id="S3.SS2.p1.5.m5.1a"><msub id="S3.SS2.p1.5.m5.1.1" xref="S3.SS2.p1.5.m5.1.1.cmml"><mi id="S3.SS2.p1.5.m5.1.1.2" xref="S3.SS2.p1.5.m5.1.1.2.cmml">y</mi><mi id="S3.SS2.p1.5.m5.1.1.3" xref="S3.SS2.p1.5.m5.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.5.m5.1b"><apply id="S3.SS2.p1.5.m5.1.1.cmml" xref="S3.SS2.p1.5.m5.1.1"><csymbol cd="ambiguous" id="S3.SS2.p1.5.m5.1.1.1.cmml" xref="S3.SS2.p1.5.m5.1.1">subscript</csymbol><ci id="S3.SS2.p1.5.m5.1.1.2.cmml" xref="S3.SS2.p1.5.m5.1.1.2">𝑦</ci><ci id="S3.SS2.p1.5.m5.1.1.3.cmml" xref="S3.SS2.p1.5.m5.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.5.m5.1c">y_{i}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p1.5.m5.1d">italic_y start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT</annotation></semantics></math> is binary, with a 0 or 1 value indicating whether the event occurred at the corresponding position in <math alttext="x_{i}" class="ltx_Math" display="inline" id="S3.SS2.p1.6.m6.1"><semantics id="S3.SS2.p1.6.m6.1a"><msub id="S3.SS2.p1.6.m6.1.1" xref="S3.SS2.p1.6.m6.1.1.cmml"><mi id="S3.SS2.p1.6.m6.1.1.2" xref="S3.SS2.p1.6.m6.1.1.2.cmml">x</mi><mi id="S3.SS2.p1.6.m6.1.1.3" xref="S3.SS2.p1.6.m6.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.6.m6.1b"><apply id="S3.SS2.p1.6.m6.1.1.cmml" xref="S3.SS2.p1.6.m6.1.1"><csymbol cd="ambiguous" id="S3.SS2.p1.6.m6.1.1.1.cmml" xref="S3.SS2.p1.6.m6.1.1">subscript</csymbol><ci id="S3.SS2.p1.6.m6.1.1.2.cmml" xref="S3.SS2.p1.6.m6.1.1.2">𝑥</ci><ci id="S3.SS2.p1.6.m6.1.1.3.cmml" xref="S3.SS2.p1.6.m6.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.6.m6.1c">x_{i}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p1.6.m6.1d">italic_x start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT</annotation></semantics></math>.</p>
</div>
<div class="ltx_para" id="S3.SS2.p2">
<p class="ltx_p" id="S3.SS2.p2.8">To illustrate, consider the example of rainfall estimation beyond a defined threshold in climate forecasting. Here <math alttext="x_{i}" class="ltx_Math" display="inline" id="S3.SS2.p2.1.m1.1"><semantics id="S3.SS2.p2.1.m1.1a"><msub id="S3.SS2.p2.1.m1.1.1" xref="S3.SS2.p2.1.m1.1.1.cmml"><mi id="S3.SS2.p2.1.m1.1.1.2" xref="S3.SS2.p2.1.m1.1.1.2.cmml">x</mi><mi id="S3.SS2.p2.1.m1.1.1.3" xref="S3.SS2.p2.1.m1.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.p2.1.m1.1b"><apply id="S3.SS2.p2.1.m1.1.1.cmml" xref="S3.SS2.p2.1.m1.1.1"><csymbol cd="ambiguous" id="S3.SS2.p2.1.m1.1.1.1.cmml" xref="S3.SS2.p2.1.m1.1.1">subscript</csymbol><ci id="S3.SS2.p2.1.m1.1.1.2.cmml" xref="S3.SS2.p2.1.m1.1.1.2">𝑥</ci><ci id="S3.SS2.p2.1.m1.1.1.3.cmml" xref="S3.SS2.p2.1.m1.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p2.1.m1.1c">x_{i}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p2.1.m1.1d">italic_x start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT</annotation></semantics></math> represents meaningful available quantities from a previous time step, while <math alttext="y_{i}" class="ltx_Math" display="inline" id="S3.SS2.p2.2.m2.1"><semantics id="S3.SS2.p2.2.m2.1a"><msub id="S3.SS2.p2.2.m2.1.1" xref="S3.SS2.p2.2.m2.1.1.cmml"><mi id="S3.SS2.p2.2.m2.1.1.2" xref="S3.SS2.p2.2.m2.1.1.2.cmml">y</mi><mi id="S3.SS2.p2.2.m2.1.1.3" xref="S3.SS2.p2.2.m2.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.p2.2.m2.1b"><apply id="S3.SS2.p2.2.m2.1.1.cmml" xref="S3.SS2.p2.2.m2.1.1"><csymbol cd="ambiguous" id="S3.SS2.p2.2.m2.1.1.1.cmml" xref="S3.SS2.p2.2.m2.1.1">subscript</csymbol><ci id="S3.SS2.p2.2.m2.1.1.2.cmml" xref="S3.SS2.p2.2.m2.1.1.2">𝑦</ci><ci id="S3.SS2.p2.2.m2.1.1.3.cmml" xref="S3.SS2.p2.2.m2.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p2.2.m2.1c">y_{i}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p2.2.m2.1d">italic_y start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT</annotation></semantics></math> is the binary map stating if the rain quantity exceeded the threshold in each pixel in the grid. The data inherently contains uncertainty. Each pixel’s value may depend on previous time steps or unavailable meteorological information. We can consider each pixel <math alttext="y_{i}" class="ltx_Math" display="inline" id="S3.SS2.p2.3.m3.1"><semantics id="S3.SS2.p2.3.m3.1a"><msub id="S3.SS2.p2.3.m3.1.1" xref="S3.SS2.p2.3.m3.1.1.cmml"><mi id="S3.SS2.p2.3.m3.1.1.2" xref="S3.SS2.p2.3.m3.1.1.2.cmml">y</mi><mi id="S3.SS2.p2.3.m3.1.1.3" xref="S3.SS2.p2.3.m3.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.p2.3.m3.1b"><apply id="S3.SS2.p2.3.m3.1.1.cmml" xref="S3.SS2.p2.3.m3.1.1"><csymbol cd="ambiguous" id="S3.SS2.p2.3.m3.1.1.1.cmml" xref="S3.SS2.p2.3.m3.1.1">subscript</csymbol><ci id="S3.SS2.p2.3.m3.1.1.2.cmml" xref="S3.SS2.p2.3.m3.1.1.2">𝑦</ci><ci id="S3.SS2.p2.3.m3.1.1.3.cmml" xref="S3.SS2.p2.3.m3.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p2.3.m3.1c">y_{i}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p2.3.m3.1d">italic_y start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT</annotation></semantics></math> to be 1 with a certain probability <math alttext="p_{i}" class="ltx_Math" display="inline" id="S3.SS2.p2.4.m4.1"><semantics id="S3.SS2.p2.4.m4.1a"><msub id="S3.SS2.p2.4.m4.1.1" xref="S3.SS2.p2.4.m4.1.1.cmml"><mi id="S3.SS2.p2.4.m4.1.1.2" xref="S3.SS2.p2.4.m4.1.1.2.cmml">p</mi><mi id="S3.SS2.p2.4.m4.1.1.3" xref="S3.SS2.p2.4.m4.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.p2.4.m4.1b"><apply id="S3.SS2.p2.4.m4.1.1.cmml" xref="S3.SS2.p2.4.m4.1.1"><csymbol cd="ambiguous" id="S3.SS2.p2.4.m4.1.1.1.cmml" xref="S3.SS2.p2.4.m4.1.1">subscript</csymbol><ci id="S3.SS2.p2.4.m4.1.1.2.cmml" xref="S3.SS2.p2.4.m4.1.1.2">𝑝</ci><ci id="S3.SS2.p2.4.m4.1.1.3.cmml" xref="S3.SS2.p2.4.m4.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p2.4.m4.1c">p_{i}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p2.4.m4.1d">italic_p start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT</annotation></semantics></math> associated with neighbouring pixels from <math alttext="x_{i}" class="ltx_Math" display="inline" id="S3.SS2.p2.5.m5.1"><semantics id="S3.SS2.p2.5.m5.1a"><msub id="S3.SS2.p2.5.m5.1.1" xref="S3.SS2.p2.5.m5.1.1.cmml"><mi id="S3.SS2.p2.5.m5.1.1.2" xref="S3.SS2.p2.5.m5.1.1.2.cmml">x</mi><mi id="S3.SS2.p2.5.m5.1.1.3" xref="S3.SS2.p2.5.m5.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.p2.5.m5.1b"><apply id="S3.SS2.p2.5.m5.1.1.cmml" xref="S3.SS2.p2.5.m5.1.1"><csymbol cd="ambiguous" id="S3.SS2.p2.5.m5.1.1.1.cmml" xref="S3.SS2.p2.5.m5.1.1">subscript</csymbol><ci id="S3.SS2.p2.5.m5.1.1.2.cmml" xref="S3.SS2.p2.5.m5.1.1.2">𝑥</ci><ci id="S3.SS2.p2.5.m5.1.1.3.cmml" xref="S3.SS2.p2.5.m5.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p2.5.m5.1c">x_{i}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p2.5.m5.1d">italic_x start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT</annotation></semantics></math>. This is because the input data provides important information about the event’s occurrence. Then, a probability-estimation model will be trained to produce the best estimation <math alttext="\hat{p}" class="ltx_Math" display="inline" id="S3.SS2.p2.6.m6.1"><semantics id="S3.SS2.p2.6.m6.1a"><mover accent="true" id="S3.SS2.p2.6.m6.1.1" xref="S3.SS2.p2.6.m6.1.1.cmml"><mi id="S3.SS2.p2.6.m6.1.1.2" xref="S3.SS2.p2.6.m6.1.1.2.cmml">p</mi><mo id="S3.SS2.p2.6.m6.1.1.1" xref="S3.SS2.p2.6.m6.1.1.1.cmml">^</mo></mover><annotation-xml encoding="MathML-Content" id="S3.SS2.p2.6.m6.1b"><apply id="S3.SS2.p2.6.m6.1.1.cmml" xref="S3.SS2.p2.6.m6.1.1"><ci id="S3.SS2.p2.6.m6.1.1.1.cmml" xref="S3.SS2.p2.6.m6.1.1.1">^</ci><ci id="S3.SS2.p2.6.m6.1.1.2.cmml" xref="S3.SS2.p2.6.m6.1.1.2">𝑝</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p2.6.m6.1c">\hat{p}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p2.6.m6.1d">over^ start_ARG italic_p end_ARG</annotation></semantics></math> of <math alttext="p" class="ltx_Math" display="inline" id="S3.SS2.p2.7.m7.1"><semantics id="S3.SS2.p2.7.m7.1a"><mi id="S3.SS2.p2.7.m7.1.1" xref="S3.SS2.p2.7.m7.1.1.cmml">p</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p2.7.m7.1b"><ci id="S3.SS2.p2.7.m7.1.1.cmml" xref="S3.SS2.p2.7.m7.1.1">𝑝</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p2.7.m7.1c">p</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p2.7.m7.1d">italic_p</annotation></semantics></math> on new images <math alttext="x" class="ltx_Math" display="inline" id="S3.SS2.p2.8.m8.1"><semantics id="S3.SS2.p2.8.m8.1a"><mi id="S3.SS2.p2.8.m8.1.1" xref="S3.SS2.p2.8.m8.1.1.cmml">x</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p2.8.m8.1b"><ci id="S3.SS2.p2.8.m8.1.1.cmml" xref="S3.SS2.p2.8.m8.1.1">𝑥</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p2.8.m8.1c">x</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p2.8.m8.1d">italic_x</annotation></semantics></math>. It is worth noting that this is not a traditional classification task, as the goal is to predict the probability of the outcome, which inherently involves aleatory uncertainty.</p>
</div>
<div class="ltx_para" id="S3.SS2.p3">
<p class="ltx_p" id="S3.SS2.p3.3">To measure the effectiveness of our model, it is useful to introduce the concept of calibration, which refers to the correspondence between the predicted probabilities and the actual results. We need this concept if we rely on the observed results since the real probability <math alttext="p" class="ltx_Math" display="inline" id="S3.SS2.p3.1.m1.1"><semantics id="S3.SS2.p3.1.m1.1a"><mi id="S3.SS2.p3.1.m1.1.1" xref="S3.SS2.p3.1.m1.1.1.cmml">p</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p3.1.m1.1b"><ci id="S3.SS2.p3.1.m1.1.1.cmml" xref="S3.SS2.p3.1.m1.1.1">𝑝</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p3.1.m1.1c">p</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p3.1.m1.1d">italic_p</annotation></semantics></math> is unavailable. Then, a probability-estimation model <math alttext="f_{\theta}" class="ltx_Math" display="inline" id="S3.SS2.p3.2.m2.1"><semantics id="S3.SS2.p3.2.m2.1a"><msub id="S3.SS2.p3.2.m2.1.1" xref="S3.SS2.p3.2.m2.1.1.cmml"><mi id="S3.SS2.p3.2.m2.1.1.2" xref="S3.SS2.p3.2.m2.1.1.2.cmml">f</mi><mi id="S3.SS2.p3.2.m2.1.1.3" xref="S3.SS2.p3.2.m2.1.1.3.cmml">θ</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.p3.2.m2.1b"><apply id="S3.SS2.p3.2.m2.1.1.cmml" xref="S3.SS2.p3.2.m2.1.1"><csymbol cd="ambiguous" id="S3.SS2.p3.2.m2.1.1.1.cmml" xref="S3.SS2.p3.2.m2.1.1">subscript</csymbol><ci id="S3.SS2.p3.2.m2.1.1.2.cmml" xref="S3.SS2.p3.2.m2.1.1.2">𝑓</ci><ci id="S3.SS2.p3.2.m2.1.1.3.cmml" xref="S3.SS2.p3.2.m2.1.1.3">𝜃</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p3.2.m2.1c">f_{\theta}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p3.2.m2.1d">italic_f start_POSTSUBSCRIPT italic_θ end_POSTSUBSCRIPT</annotation></semantics></math> parameterized with weights <math alttext="\theta" class="ltx_Math" display="inline" id="S3.SS2.p3.3.m3.1"><semantics id="S3.SS2.p3.3.m3.1a"><mi id="S3.SS2.p3.3.m3.1.1" xref="S3.SS2.p3.3.m3.1.1.cmml">θ</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p3.3.m3.1b"><ci id="S3.SS2.p3.3.m3.1.1.cmml" xref="S3.SS2.p3.3.m3.1.1">𝜃</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p3.3.m3.1c">\theta</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p3.3.m3.1d">italic_θ</annotation></semantics></math>, we define as follows:</p>
</div>
<div class="ltx_theorem ltx_theorem_definition" id="Thmdefinition1">
<h6 class="ltx_title ltx_runin ltx_title_theorem"><span class="ltx_tag ltx_tag_theorem"><span class="ltx_text ltx_font_bold" id="Thmdefinition1.1.1.1">Definition 1</span></span></h6>
<div class="ltx_para" id="Thmdefinition1.p1">
<p class="ltx_p" id="Thmdefinition1.p1.2"><span class="ltx_text ltx_font_italic" id="Thmdefinition1.p1.2.2">The parametric model <math alttext="f_{\theta}" class="ltx_Math" display="inline" id="Thmdefinition1.p1.1.1.m1.1"><semantics id="Thmdefinition1.p1.1.1.m1.1a"><msub id="Thmdefinition1.p1.1.1.m1.1.1" xref="Thmdefinition1.p1.1.1.m1.1.1.cmml"><mi id="Thmdefinition1.p1.1.1.m1.1.1.2" xref="Thmdefinition1.p1.1.1.m1.1.1.2.cmml">f</mi><mi id="Thmdefinition1.p1.1.1.m1.1.1.3" xref="Thmdefinition1.p1.1.1.m1.1.1.3.cmml">θ</mi></msub><annotation-xml encoding="MathML-Content" id="Thmdefinition1.p1.1.1.m1.1b"><apply id="Thmdefinition1.p1.1.1.m1.1.1.cmml" xref="Thmdefinition1.p1.1.1.m1.1.1"><csymbol cd="ambiguous" id="Thmdefinition1.p1.1.1.m1.1.1.1.cmml" xref="Thmdefinition1.p1.1.1.m1.1.1">subscript</csymbol><ci id="Thmdefinition1.p1.1.1.m1.1.1.2.cmml" xref="Thmdefinition1.p1.1.1.m1.1.1.2">𝑓</ci><ci id="Thmdefinition1.p1.1.1.m1.1.1.3.cmml" xref="Thmdefinition1.p1.1.1.m1.1.1.3">𝜃</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="Thmdefinition1.p1.1.1.m1.1c">f_{\theta}</annotation><annotation encoding="application/x-llamapun" id="Thmdefinition1.p1.1.1.m1.1d">italic_f start_POSTSUBSCRIPT italic_θ end_POSTSUBSCRIPT</annotation></semantics></math> is well-calibrated if exists a small interval <math alttext="I(q)" class="ltx_Math" display="inline" id="Thmdefinition1.p1.2.2.m2.1"><semantics id="Thmdefinition1.p1.2.2.m2.1a"><mrow id="Thmdefinition1.p1.2.2.m2.1.2" xref="Thmdefinition1.p1.2.2.m2.1.2.cmml"><mi id="Thmdefinition1.p1.2.2.m2.1.2.2" xref="Thmdefinition1.p1.2.2.m2.1.2.2.cmml">I</mi><mo id="Thmdefinition1.p1.2.2.m2.1.2.1" xref="Thmdefinition1.p1.2.2.m2.1.2.1.cmml">⁢</mo><mrow id="Thmdefinition1.p1.2.2.m2.1.2.3.2" xref="Thmdefinition1.p1.2.2.m2.1.2.cmml"><mo id="Thmdefinition1.p1.2.2.m2.1.2.3.2.1" stretchy="false" xref="Thmdefinition1.p1.2.2.m2.1.2.cmml">(</mo><mi id="Thmdefinition1.p1.2.2.m2.1.1" xref="Thmdefinition1.p1.2.2.m2.1.1.cmml">q</mi><mo id="Thmdefinition1.p1.2.2.m2.1.2.3.2.2" stretchy="false" xref="Thmdefinition1.p1.2.2.m2.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="Thmdefinition1.p1.2.2.m2.1b"><apply id="Thmdefinition1.p1.2.2.m2.1.2.cmml" xref="Thmdefinition1.p1.2.2.m2.1.2"><times id="Thmdefinition1.p1.2.2.m2.1.2.1.cmml" xref="Thmdefinition1.p1.2.2.m2.1.2.1"></times><ci id="Thmdefinition1.p1.2.2.m2.1.2.2.cmml" xref="Thmdefinition1.p1.2.2.m2.1.2.2">𝐼</ci><ci id="Thmdefinition1.p1.2.2.m2.1.1.cmml" xref="Thmdefinition1.p1.2.2.m2.1.1">𝑞</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="Thmdefinition1.p1.2.2.m2.1c">I(q)</annotation><annotation encoding="application/x-llamapun" id="Thmdefinition1.p1.2.2.m2.1d">italic_I ( italic_q )</annotation></semantics></math> such that</span></p>
<table class="ltx_equation ltx_eqn_table" id="S3.E1">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\mathcal{P}(y=1|f_{\theta}(x)\in I(q))=q,\;\;\forall 0\leq q\leq 1," class="ltx_Math" display="block" id="S3.E1.m1.3"><semantics id="S3.E1.m1.3a"><mrow id="S3.E1.m1.3.3.1"><mrow id="S3.E1.m1.3.3.1.1.2" xref="S3.E1.m1.3.3.1.1.3.cmml"><mrow id="S3.E1.m1.3.3.1.1.1.1" xref="S3.E1.m1.3.3.1.1.1.1.cmml"><mrow id="S3.E1.m1.3.3.1.1.1.1.1" xref="S3.E1.m1.3.3.1.1.1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.E1.m1.3.3.1.1.1.1.1.3" xref="S3.E1.m1.3.3.1.1.1.1.1.3.cmml">𝒫</mi><mo id="S3.E1.m1.3.3.1.1.1.1.1.2" xref="S3.E1.m1.3.3.1.1.1.1.1.2.cmml">⁢</mo><mrow id="S3.E1.m1.3.3.1.1.1.1.1.1.1" xref="S3.E1.m1.3.3.1.1.1.1.1.1.1.1.cmml"><mo id="S3.E1.m1.3.3.1.1.1.1.1.1.1.2" stretchy="false" xref="S3.E1.m1.3.3.1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="S3.E1.m1.3.3.1.1.1.1.1.1.1.1" xref="S3.E1.m1.3.3.1.1.1.1.1.1.1.1.cmml"><mi id="S3.E1.m1.3.3.1.1.1.1.1.1.1.1.2" xref="S3.E1.m1.3.3.1.1.1.1.1.1.1.1.2.cmml">y</mi><mo id="S3.E1.m1.3.3.1.1.1.1.1.1.1.1.3" xref="S3.E1.m1.3.3.1.1.1.1.1.1.1.1.3.cmml">=</mo><mrow id="S3.E1.m1.3.3.1.1.1.1.1.1.1.1.4" xref="S3.E1.m1.3.3.1.1.1.1.1.1.1.1.4.cmml"><mn id="S3.E1.m1.3.3.1.1.1.1.1.1.1.1.4.2" xref="S3.E1.m1.3.3.1.1.1.1.1.1.1.1.4.2.cmml">1</mn><mo fence="false" id="S3.E1.m1.3.3.1.1.1.1.1.1.1.1.4.1" xref="S3.E1.m1.3.3.1.1.1.1.1.1.1.1.4.1.cmml">|</mo><mrow id="S3.E1.m1.3.3.1.1.1.1.1.1.1.1.4.3" xref="S3.E1.m1.3.3.1.1.1.1.1.1.1.1.4.3.cmml"><msub id="S3.E1.m1.3.3.1.1.1.1.1.1.1.1.4.3.2" xref="S3.E1.m1.3.3.1.1.1.1.1.1.1.1.4.3.2.cmml"><mi id="S3.E1.m1.3.3.1.1.1.1.1.1.1.1.4.3.2.2" xref="S3.E1.m1.3.3.1.1.1.1.1.1.1.1.4.3.2.2.cmml">f</mi><mi id="S3.E1.m1.3.3.1.1.1.1.1.1.1.1.4.3.2.3" xref="S3.E1.m1.3.3.1.1.1.1.1.1.1.1.4.3.2.3.cmml">θ</mi></msub><mo id="S3.E1.m1.3.3.1.1.1.1.1.1.1.1.4.3.1" xref="S3.E1.m1.3.3.1.1.1.1.1.1.1.1.4.3.1.cmml">⁢</mo><mrow id="S3.E1.m1.3.3.1.1.1.1.1.1.1.1.4.3.3.2" xref="S3.E1.m1.3.3.1.1.1.1.1.1.1.1.4.3.cmml"><mo id="S3.E1.m1.3.3.1.1.1.1.1.1.1.1.4.3.3.2.1" stretchy="false" xref="S3.E1.m1.3.3.1.1.1.1.1.1.1.1.4.3.cmml">(</mo><mi id="S3.E1.m1.1.1" xref="S3.E1.m1.1.1.cmml">x</mi><mo id="S3.E1.m1.3.3.1.1.1.1.1.1.1.1.4.3.3.2.2" stretchy="false" xref="S3.E1.m1.3.3.1.1.1.1.1.1.1.1.4.3.cmml">)</mo></mrow></mrow></mrow><mo id="S3.E1.m1.3.3.1.1.1.1.1.1.1.1.5" xref="S3.E1.m1.3.3.1.1.1.1.1.1.1.1.5.cmml">∈</mo><mrow id="S3.E1.m1.3.3.1.1.1.1.1.1.1.1.6" xref="S3.E1.m1.3.3.1.1.1.1.1.1.1.1.6.cmml"><mi id="S3.E1.m1.3.3.1.1.1.1.1.1.1.1.6.2" xref="S3.E1.m1.3.3.1.1.1.1.1.1.1.1.6.2.cmml">I</mi><mo id="S3.E1.m1.3.3.1.1.1.1.1.1.1.1.6.1" xref="S3.E1.m1.3.3.1.1.1.1.1.1.1.1.6.1.cmml">⁢</mo><mrow id="S3.E1.m1.3.3.1.1.1.1.1.1.1.1.6.3.2" xref="S3.E1.m1.3.3.1.1.1.1.1.1.1.1.6.cmml"><mo id="S3.E1.m1.3.3.1.1.1.1.1.1.1.1.6.3.2.1" stretchy="false" xref="S3.E1.m1.3.3.1.1.1.1.1.1.1.1.6.cmml">(</mo><mi id="S3.E1.m1.2.2" xref="S3.E1.m1.2.2.cmml">q</mi><mo id="S3.E1.m1.3.3.1.1.1.1.1.1.1.1.6.3.2.2" stretchy="false" xref="S3.E1.m1.3.3.1.1.1.1.1.1.1.1.6.cmml">)</mo></mrow></mrow></mrow><mo id="S3.E1.m1.3.3.1.1.1.1.1.1.1.3" stretchy="false" xref="S3.E1.m1.3.3.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S3.E1.m1.3.3.1.1.1.1.2" xref="S3.E1.m1.3.3.1.1.1.1.2.cmml">=</mo><mi id="S3.E1.m1.3.3.1.1.1.1.3" xref="S3.E1.m1.3.3.1.1.1.1.3.cmml">q</mi></mrow><mo id="S3.E1.m1.3.3.1.1.2.3" rspace="0.727em" xref="S3.E1.m1.3.3.1.1.3a.cmml">,</mo><mrow id="S3.E1.m1.3.3.1.1.2.2" xref="S3.E1.m1.3.3.1.1.2.2.cmml"><mrow id="S3.E1.m1.3.3.1.1.2.2.2" xref="S3.E1.m1.3.3.1.1.2.2.2.cmml"><mo id="S3.E1.m1.3.3.1.1.2.2.2.1" rspace="0.167em" xref="S3.E1.m1.3.3.1.1.2.2.2.1.cmml">∀</mo><mn id="S3.E1.m1.3.3.1.1.2.2.2.2" xref="S3.E1.m1.3.3.1.1.2.2.2.2.cmml">0</mn></mrow><mo id="S3.E1.m1.3.3.1.1.2.2.3" xref="S3.E1.m1.3.3.1.1.2.2.3.cmml">≤</mo><mi id="S3.E1.m1.3.3.1.1.2.2.4" xref="S3.E1.m1.3.3.1.1.2.2.4.cmml">q</mi><mo id="S3.E1.m1.3.3.1.1.2.2.5" xref="S3.E1.m1.3.3.1.1.2.2.5.cmml">≤</mo><mn id="S3.E1.m1.3.3.1.1.2.2.6" xref="S3.E1.m1.3.3.1.1.2.2.6.cmml">1</mn></mrow></mrow><mo id="S3.E1.m1.3.3.1.2">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E1.m1.3b"><apply id="S3.E1.m1.3.3.1.1.3.cmml" xref="S3.E1.m1.3.3.1.1.2"><csymbol cd="ambiguous" id="S3.E1.m1.3.3.1.1.3a.cmml" xref="S3.E1.m1.3.3.1.1.2.3">formulae-sequence</csymbol><apply id="S3.E1.m1.3.3.1.1.1.1.cmml" xref="S3.E1.m1.3.3.1.1.1.1"><eq id="S3.E1.m1.3.3.1.1.1.1.2.cmml" xref="S3.E1.m1.3.3.1.1.1.1.2"></eq><apply id="S3.E1.m1.3.3.1.1.1.1.1.cmml" xref="S3.E1.m1.3.3.1.1.1.1.1"><times id="S3.E1.m1.3.3.1.1.1.1.1.2.cmml" xref="S3.E1.m1.3.3.1.1.1.1.1.2"></times><ci id="S3.E1.m1.3.3.1.1.1.1.1.3.cmml" xref="S3.E1.m1.3.3.1.1.1.1.1.3">𝒫</ci><apply id="S3.E1.m1.3.3.1.1.1.1.1.1.1.1.cmml" xref="S3.E1.m1.3.3.1.1.1.1.1.1.1"><and id="S3.E1.m1.3.3.1.1.1.1.1.1.1.1a.cmml" xref="S3.E1.m1.3.3.1.1.1.1.1.1.1"></and><apply id="S3.E1.m1.3.3.1.1.1.1.1.1.1.1b.cmml" xref="S3.E1.m1.3.3.1.1.1.1.1.1.1"><eq id="S3.E1.m1.3.3.1.1.1.1.1.1.1.1.3.cmml" xref="S3.E1.m1.3.3.1.1.1.1.1.1.1.1.3"></eq><ci id="S3.E1.m1.3.3.1.1.1.1.1.1.1.1.2.cmml" xref="S3.E1.m1.3.3.1.1.1.1.1.1.1.1.2">𝑦</ci><apply id="S3.E1.m1.3.3.1.1.1.1.1.1.1.1.4.cmml" xref="S3.E1.m1.3.3.1.1.1.1.1.1.1.1.4"><csymbol cd="latexml" id="S3.E1.m1.3.3.1.1.1.1.1.1.1.1.4.1.cmml" xref="S3.E1.m1.3.3.1.1.1.1.1.1.1.1.4.1">conditional</csymbol><cn id="S3.E1.m1.3.3.1.1.1.1.1.1.1.1.4.2.cmml" type="integer" xref="S3.E1.m1.3.3.1.1.1.1.1.1.1.1.4.2">1</cn><apply id="S3.E1.m1.3.3.1.1.1.1.1.1.1.1.4.3.cmml" xref="S3.E1.m1.3.3.1.1.1.1.1.1.1.1.4.3"><times id="S3.E1.m1.3.3.1.1.1.1.1.1.1.1.4.3.1.cmml" xref="S3.E1.m1.3.3.1.1.1.1.1.1.1.1.4.3.1"></times><apply id="S3.E1.m1.3.3.1.1.1.1.1.1.1.1.4.3.2.cmml" xref="S3.E1.m1.3.3.1.1.1.1.1.1.1.1.4.3.2"><csymbol cd="ambiguous" id="S3.E1.m1.3.3.1.1.1.1.1.1.1.1.4.3.2.1.cmml" xref="S3.E1.m1.3.3.1.1.1.1.1.1.1.1.4.3.2">subscript</csymbol><ci id="S3.E1.m1.3.3.1.1.1.1.1.1.1.1.4.3.2.2.cmml" xref="S3.E1.m1.3.3.1.1.1.1.1.1.1.1.4.3.2.2">𝑓</ci><ci id="S3.E1.m1.3.3.1.1.1.1.1.1.1.1.4.3.2.3.cmml" xref="S3.E1.m1.3.3.1.1.1.1.1.1.1.1.4.3.2.3">𝜃</ci></apply><ci id="S3.E1.m1.1.1.cmml" xref="S3.E1.m1.1.1">𝑥</ci></apply></apply></apply><apply id="S3.E1.m1.3.3.1.1.1.1.1.1.1.1c.cmml" xref="S3.E1.m1.3.3.1.1.1.1.1.1.1"><in id="S3.E1.m1.3.3.1.1.1.1.1.1.1.1.5.cmml" xref="S3.E1.m1.3.3.1.1.1.1.1.1.1.1.5"></in><share href="https://arxiv.org/html/2409.12535v1#S3.E1.m1.3.3.1.1.1.1.1.1.1.1.4.cmml" id="S3.E1.m1.3.3.1.1.1.1.1.1.1.1d.cmml" xref="S3.E1.m1.3.3.1.1.1.1.1.1.1"></share><apply id="S3.E1.m1.3.3.1.1.1.1.1.1.1.1.6.cmml" xref="S3.E1.m1.3.3.1.1.1.1.1.1.1.1.6"><times id="S3.E1.m1.3.3.1.1.1.1.1.1.1.1.6.1.cmml" xref="S3.E1.m1.3.3.1.1.1.1.1.1.1.1.6.1"></times><ci id="S3.E1.m1.3.3.1.1.1.1.1.1.1.1.6.2.cmml" xref="S3.E1.m1.3.3.1.1.1.1.1.1.1.1.6.2">𝐼</ci><ci id="S3.E1.m1.2.2.cmml" xref="S3.E1.m1.2.2">𝑞</ci></apply></apply></apply></apply><ci id="S3.E1.m1.3.3.1.1.1.1.3.cmml" xref="S3.E1.m1.3.3.1.1.1.1.3">𝑞</ci></apply><apply id="S3.E1.m1.3.3.1.1.2.2.cmml" xref="S3.E1.m1.3.3.1.1.2.2"><and id="S3.E1.m1.3.3.1.1.2.2a.cmml" xref="S3.E1.m1.3.3.1.1.2.2"></and><apply id="S3.E1.m1.3.3.1.1.2.2b.cmml" xref="S3.E1.m1.3.3.1.1.2.2"><leq id="S3.E1.m1.3.3.1.1.2.2.3.cmml" xref="S3.E1.m1.3.3.1.1.2.2.3"></leq><apply id="S3.E1.m1.3.3.1.1.2.2.2.cmml" xref="S3.E1.m1.3.3.1.1.2.2.2"><csymbol cd="latexml" id="S3.E1.m1.3.3.1.1.2.2.2.1.cmml" xref="S3.E1.m1.3.3.1.1.2.2.2.1">for-all</csymbol><cn id="S3.E1.m1.3.3.1.1.2.2.2.2.cmml" type="integer" xref="S3.E1.m1.3.3.1.1.2.2.2.2">0</cn></apply><ci id="S3.E1.m1.3.3.1.1.2.2.4.cmml" xref="S3.E1.m1.3.3.1.1.2.2.4">𝑞</ci></apply><apply id="S3.E1.m1.3.3.1.1.2.2c.cmml" xref="S3.E1.m1.3.3.1.1.2.2"><leq id="S3.E1.m1.3.3.1.1.2.2.5.cmml" xref="S3.E1.m1.3.3.1.1.2.2.5"></leq><share href="https://arxiv.org/html/2409.12535v1#S3.E1.m1.3.3.1.1.2.2.4.cmml" id="S3.E1.m1.3.3.1.1.2.2d.cmml" xref="S3.E1.m1.3.3.1.1.2.2"></share><cn id="S3.E1.m1.3.3.1.1.2.2.6.cmml" type="integer" xref="S3.E1.m1.3.3.1.1.2.2.6">1</cn></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E1.m1.3c">\mathcal{P}(y=1|f_{\theta}(x)\in I(q))=q,\;\;\forall 0\leq q\leq 1,</annotation><annotation encoding="application/x-llamapun" id="S3.E1.m1.3d">caligraphic_P ( italic_y = 1 | italic_f start_POSTSUBSCRIPT italic_θ end_POSTSUBSCRIPT ( italic_x ) ∈ italic_I ( italic_q ) ) = italic_q , ∀ 0 ≤ italic_q ≤ 1 ,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(1)</span></td>
</tr></tbody>
</table>
</div>
</div>
<div class="ltx_para" id="S3.SS2.p4">
<p class="ltx_p" id="S3.SS2.p4.3">where <math alttext="y" class="ltx_Math" display="inline" id="S3.SS2.p4.1.m1.1"><semantics id="S3.SS2.p4.1.m1.1a"><mi id="S3.SS2.p4.1.m1.1.1" xref="S3.SS2.p4.1.m1.1.1.cmml">y</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p4.1.m1.1b"><ci id="S3.SS2.p4.1.m1.1.1.cmml" xref="S3.SS2.p4.1.m1.1.1">𝑦</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p4.1.m1.1c">y</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p4.1.m1.1d">italic_y</annotation></semantics></math> is the observation associated with the input <math alttext="x" class="ltx_Math" display="inline" id="S3.SS2.p4.2.m2.1"><semantics id="S3.SS2.p4.2.m2.1a"><mi id="S3.SS2.p4.2.m2.1.1" xref="S3.SS2.p4.2.m2.1.1.cmml">x</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p4.2.m2.1b"><ci id="S3.SS2.p4.2.m2.1.1.cmml" xref="S3.SS2.p4.2.m2.1.1">𝑥</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p4.2.m2.1c">x</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p4.2.m2.1d">italic_x</annotation></semantics></math> and <math alttext="f_{\theta}(x)" class="ltx_Math" display="inline" id="S3.SS2.p4.3.m3.1"><semantics id="S3.SS2.p4.3.m3.1a"><mrow id="S3.SS2.p4.3.m3.1.2" xref="S3.SS2.p4.3.m3.1.2.cmml"><msub id="S3.SS2.p4.3.m3.1.2.2" xref="S3.SS2.p4.3.m3.1.2.2.cmml"><mi id="S3.SS2.p4.3.m3.1.2.2.2" xref="S3.SS2.p4.3.m3.1.2.2.2.cmml">f</mi><mi id="S3.SS2.p4.3.m3.1.2.2.3" xref="S3.SS2.p4.3.m3.1.2.2.3.cmml">θ</mi></msub><mo id="S3.SS2.p4.3.m3.1.2.1" xref="S3.SS2.p4.3.m3.1.2.1.cmml">⁢</mo><mrow id="S3.SS2.p4.3.m3.1.2.3.2" xref="S3.SS2.p4.3.m3.1.2.cmml"><mo id="S3.SS2.p4.3.m3.1.2.3.2.1" stretchy="false" xref="S3.SS2.p4.3.m3.1.2.cmml">(</mo><mi id="S3.SS2.p4.3.m3.1.1" xref="S3.SS2.p4.3.m3.1.1.cmml">x</mi><mo id="S3.SS2.p4.3.m3.1.2.3.2.2" stretchy="false" xref="S3.SS2.p4.3.m3.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p4.3.m3.1b"><apply id="S3.SS2.p4.3.m3.1.2.cmml" xref="S3.SS2.p4.3.m3.1.2"><times id="S3.SS2.p4.3.m3.1.2.1.cmml" xref="S3.SS2.p4.3.m3.1.2.1"></times><apply id="S3.SS2.p4.3.m3.1.2.2.cmml" xref="S3.SS2.p4.3.m3.1.2.2"><csymbol cd="ambiguous" id="S3.SS2.p4.3.m3.1.2.2.1.cmml" xref="S3.SS2.p4.3.m3.1.2.2">subscript</csymbol><ci id="S3.SS2.p4.3.m3.1.2.2.2.cmml" xref="S3.SS2.p4.3.m3.1.2.2.2">𝑓</ci><ci id="S3.SS2.p4.3.m3.1.2.2.3.cmml" xref="S3.SS2.p4.3.m3.1.2.2.3">𝜃</ci></apply><ci id="S3.SS2.p4.3.m3.1.1.cmml" xref="S3.SS2.p4.3.m3.1.1">𝑥</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p4.3.m3.1c">f_{\theta}(x)</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p4.3.m3.1d">italic_f start_POSTSUBSCRIPT italic_θ end_POSTSUBSCRIPT ( italic_x )</annotation></semantics></math> is the probability predicted by model.</p>
</div>
</section>
<section class="ltx_subsection" id="S3.SS3">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection"><span class="ltx_text" id="S3.SS3.4.1.1">III-C</span> </span><span class="ltx_text ltx_font_italic" id="S3.SS3.5.2">Evaluation metrics</span>
</h3>
<div class="ltx_para" id="S3.SS3.p1">
<p class="ltx_p" id="S3.SS3.p1.10">Expected Calibration Error (ECE) <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.12535v1#bib.bib2" title="">2</a>]</cite> is a standard calibration assessment. To evaluate the probabilities predicted by the model, we compare them with empirically observed probabilities. To do this, we group all pixels <math alttext="x_{i}" class="ltx_Math" display="inline" id="S3.SS3.p1.1.m1.1"><semantics id="S3.SS3.p1.1.m1.1a"><msub id="S3.SS3.p1.1.m1.1.1" xref="S3.SS3.p1.1.m1.1.1.cmml"><mi id="S3.SS3.p1.1.m1.1.1.2" xref="S3.SS3.p1.1.m1.1.1.2.cmml">x</mi><mi id="S3.SS3.p1.1.m1.1.1.3" xref="S3.SS3.p1.1.m1.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS3.p1.1.m1.1b"><apply id="S3.SS3.p1.1.m1.1.1.cmml" xref="S3.SS3.p1.1.m1.1.1"><csymbol cd="ambiguous" id="S3.SS3.p1.1.m1.1.1.1.cmml" xref="S3.SS3.p1.1.m1.1.1">subscript</csymbol><ci id="S3.SS3.p1.1.m1.1.1.2.cmml" xref="S3.SS3.p1.1.m1.1.1.2">𝑥</ci><ci id="S3.SS3.p1.1.m1.1.1.3.cmml" xref="S3.SS3.p1.1.m1.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p1.1.m1.1c">x_{i}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p1.1.m1.1d">italic_x start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT</annotation></semantics></math> where the model’s output matches a certain value and calculate the proportion of these pixels with a result of 1. If this proportion is very similar to the probability predicted by the model, the model is considered to be well-calibrated. In our context, we have repeated these considerations for each pixel of the input data <math alttext="x_{i}" class="ltx_Math" display="inline" id="S3.SS3.p1.2.m2.1"><semantics id="S3.SS3.p1.2.m2.1a"><msub id="S3.SS3.p1.2.m2.1.1" xref="S3.SS3.p1.2.m2.1.1.cmml"><mi id="S3.SS3.p1.2.m2.1.1.2" xref="S3.SS3.p1.2.m2.1.1.2.cmml">x</mi><mi id="S3.SS3.p1.2.m2.1.1.3" xref="S3.SS3.p1.2.m2.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS3.p1.2.m2.1b"><apply id="S3.SS3.p1.2.m2.1.1.cmml" xref="S3.SS3.p1.2.m2.1.1"><csymbol cd="ambiguous" id="S3.SS3.p1.2.m2.1.1.1.cmml" xref="S3.SS3.p1.2.m2.1.1">subscript</csymbol><ci id="S3.SS3.p1.2.m2.1.1.2.cmml" xref="S3.SS3.p1.2.m2.1.1.2">𝑥</ci><ci id="S3.SS3.p1.2.m2.1.1.3.cmml" xref="S3.SS3.p1.2.m2.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p1.2.m2.1c">x_{i}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p1.2.m2.1d">italic_x start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT</annotation></semantics></math> and the corresponding results <math alttext="y_{i}" class="ltx_Math" display="inline" id="S3.SS3.p1.3.m3.1"><semantics id="S3.SS3.p1.3.m3.1a"><msub id="S3.SS3.p1.3.m3.1.1" xref="S3.SS3.p1.3.m3.1.1.cmml"><mi id="S3.SS3.p1.3.m3.1.1.2" xref="S3.SS3.p1.3.m3.1.1.2.cmml">y</mi><mi id="S3.SS3.p1.3.m3.1.1.3" xref="S3.SS3.p1.3.m3.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS3.p1.3.m3.1b"><apply id="S3.SS3.p1.3.m3.1.1.cmml" xref="S3.SS3.p1.3.m3.1.1"><csymbol cd="ambiguous" id="S3.SS3.p1.3.m3.1.1.1.cmml" xref="S3.SS3.p1.3.m3.1.1">subscript</csymbol><ci id="S3.SS3.p1.3.m3.1.1.2.cmml" xref="S3.SS3.p1.3.m3.1.1.2">𝑦</ci><ci id="S3.SS3.p1.3.m3.1.1.3.cmml" xref="S3.SS3.p1.3.m3.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p1.3.m3.1c">y_{i}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p1.3.m3.1d">italic_y start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT</annotation></semantics></math>. Once we gather the outcomes for all pixels <math alttext="y_{i}" class="ltx_Math" display="inline" id="S3.SS3.p1.4.m4.1"><semantics id="S3.SS3.p1.4.m4.1a"><msub id="S3.SS3.p1.4.m4.1.1" xref="S3.SS3.p1.4.m4.1.1.cmml"><mi id="S3.SS3.p1.4.m4.1.1.2" xref="S3.SS3.p1.4.m4.1.1.2.cmml">y</mi><mi id="S3.SS3.p1.4.m4.1.1.3" xref="S3.SS3.p1.4.m4.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS3.p1.4.m4.1b"><apply id="S3.SS3.p1.4.m4.1.1.cmml" xref="S3.SS3.p1.4.m4.1.1"><csymbol cd="ambiguous" id="S3.SS3.p1.4.m4.1.1.1.cmml" xref="S3.SS3.p1.4.m4.1.1">subscript</csymbol><ci id="S3.SS3.p1.4.m4.1.1.2.cmml" xref="S3.SS3.p1.4.m4.1.1.2">𝑦</ci><ci id="S3.SS3.p1.4.m4.1.1.3.cmml" xref="S3.SS3.p1.4.m4.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p1.4.m4.1c">y_{i}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p1.4.m4.1d">italic_y start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT</annotation></semantics></math>, we can partition the model’s predicted probabilities, represented by <math alttext="f_{\theta}(x_{i})" class="ltx_Math" display="inline" id="S3.SS3.p1.5.m5.1"><semantics id="S3.SS3.p1.5.m5.1a"><mrow id="S3.SS3.p1.5.m5.1.1" xref="S3.SS3.p1.5.m5.1.1.cmml"><msub id="S3.SS3.p1.5.m5.1.1.3" xref="S3.SS3.p1.5.m5.1.1.3.cmml"><mi id="S3.SS3.p1.5.m5.1.1.3.2" xref="S3.SS3.p1.5.m5.1.1.3.2.cmml">f</mi><mi id="S3.SS3.p1.5.m5.1.1.3.3" xref="S3.SS3.p1.5.m5.1.1.3.3.cmml">θ</mi></msub><mo id="S3.SS3.p1.5.m5.1.1.2" xref="S3.SS3.p1.5.m5.1.1.2.cmml">⁢</mo><mrow id="S3.SS3.p1.5.m5.1.1.1.1" xref="S3.SS3.p1.5.m5.1.1.1.1.1.cmml"><mo id="S3.SS3.p1.5.m5.1.1.1.1.2" stretchy="false" xref="S3.SS3.p1.5.m5.1.1.1.1.1.cmml">(</mo><msub id="S3.SS3.p1.5.m5.1.1.1.1.1" xref="S3.SS3.p1.5.m5.1.1.1.1.1.cmml"><mi id="S3.SS3.p1.5.m5.1.1.1.1.1.2" xref="S3.SS3.p1.5.m5.1.1.1.1.1.2.cmml">x</mi><mi id="S3.SS3.p1.5.m5.1.1.1.1.1.3" xref="S3.SS3.p1.5.m5.1.1.1.1.1.3.cmml">i</mi></msub><mo id="S3.SS3.p1.5.m5.1.1.1.1.3" stretchy="false" xref="S3.SS3.p1.5.m5.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.p1.5.m5.1b"><apply id="S3.SS3.p1.5.m5.1.1.cmml" xref="S3.SS3.p1.5.m5.1.1"><times id="S3.SS3.p1.5.m5.1.1.2.cmml" xref="S3.SS3.p1.5.m5.1.1.2"></times><apply id="S3.SS3.p1.5.m5.1.1.3.cmml" xref="S3.SS3.p1.5.m5.1.1.3"><csymbol cd="ambiguous" id="S3.SS3.p1.5.m5.1.1.3.1.cmml" xref="S3.SS3.p1.5.m5.1.1.3">subscript</csymbol><ci id="S3.SS3.p1.5.m5.1.1.3.2.cmml" xref="S3.SS3.p1.5.m5.1.1.3.2">𝑓</ci><ci id="S3.SS3.p1.5.m5.1.1.3.3.cmml" xref="S3.SS3.p1.5.m5.1.1.3.3">𝜃</ci></apply><apply id="S3.SS3.p1.5.m5.1.1.1.1.1.cmml" xref="S3.SS3.p1.5.m5.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS3.p1.5.m5.1.1.1.1.1.1.cmml" xref="S3.SS3.p1.5.m5.1.1.1.1">subscript</csymbol><ci id="S3.SS3.p1.5.m5.1.1.1.1.1.2.cmml" xref="S3.SS3.p1.5.m5.1.1.1.1.1.2">𝑥</ci><ci id="S3.SS3.p1.5.m5.1.1.1.1.1.3.cmml" xref="S3.SS3.p1.5.m5.1.1.1.1.1.3">𝑖</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p1.5.m5.1c">f_{\theta}(x_{i})</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p1.5.m5.1d">italic_f start_POSTSUBSCRIPT italic_θ end_POSTSUBSCRIPT ( italic_x start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT )</annotation></semantics></math> , into <math alttext="B" class="ltx_Math" display="inline" id="S3.SS3.p1.6.m6.1"><semantics id="S3.SS3.p1.6.m6.1a"><mi id="S3.SS3.p1.6.m6.1.1" xref="S3.SS3.p1.6.m6.1.1.cmml">B</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.p1.6.m6.1b"><ci id="S3.SS3.p1.6.m6.1.1.cmml" xref="S3.SS3.p1.6.m6.1.1">𝐵</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p1.6.m6.1c">B</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p1.6.m6.1d">italic_B</annotation></semantics></math> bins: <math alttext="I_{1},I_{2},\ldots,I_{B}" class="ltx_Math" display="inline" id="S3.SS3.p1.7.m7.4"><semantics id="S3.SS3.p1.7.m7.4a"><mrow id="S3.SS3.p1.7.m7.4.4.3" xref="S3.SS3.p1.7.m7.4.4.4.cmml"><msub id="S3.SS3.p1.7.m7.2.2.1.1" xref="S3.SS3.p1.7.m7.2.2.1.1.cmml"><mi id="S3.SS3.p1.7.m7.2.2.1.1.2" xref="S3.SS3.p1.7.m7.2.2.1.1.2.cmml">I</mi><mn id="S3.SS3.p1.7.m7.2.2.1.1.3" xref="S3.SS3.p1.7.m7.2.2.1.1.3.cmml">1</mn></msub><mo id="S3.SS3.p1.7.m7.4.4.3.4" xref="S3.SS3.p1.7.m7.4.4.4.cmml">,</mo><msub id="S3.SS3.p1.7.m7.3.3.2.2" xref="S3.SS3.p1.7.m7.3.3.2.2.cmml"><mi id="S3.SS3.p1.7.m7.3.3.2.2.2" xref="S3.SS3.p1.7.m7.3.3.2.2.2.cmml">I</mi><mn id="S3.SS3.p1.7.m7.3.3.2.2.3" xref="S3.SS3.p1.7.m7.3.3.2.2.3.cmml">2</mn></msub><mo id="S3.SS3.p1.7.m7.4.4.3.5" xref="S3.SS3.p1.7.m7.4.4.4.cmml">,</mo><mi id="S3.SS3.p1.7.m7.1.1" mathvariant="normal" xref="S3.SS3.p1.7.m7.1.1.cmml">…</mi><mo id="S3.SS3.p1.7.m7.4.4.3.6" xref="S3.SS3.p1.7.m7.4.4.4.cmml">,</mo><msub id="S3.SS3.p1.7.m7.4.4.3.3" xref="S3.SS3.p1.7.m7.4.4.3.3.cmml"><mi id="S3.SS3.p1.7.m7.4.4.3.3.2" xref="S3.SS3.p1.7.m7.4.4.3.3.2.cmml">I</mi><mi id="S3.SS3.p1.7.m7.4.4.3.3.3" xref="S3.SS3.p1.7.m7.4.4.3.3.3.cmml">B</mi></msub></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.p1.7.m7.4b"><list id="S3.SS3.p1.7.m7.4.4.4.cmml" xref="S3.SS3.p1.7.m7.4.4.3"><apply id="S3.SS3.p1.7.m7.2.2.1.1.cmml" xref="S3.SS3.p1.7.m7.2.2.1.1"><csymbol cd="ambiguous" id="S3.SS3.p1.7.m7.2.2.1.1.1.cmml" xref="S3.SS3.p1.7.m7.2.2.1.1">subscript</csymbol><ci id="S3.SS3.p1.7.m7.2.2.1.1.2.cmml" xref="S3.SS3.p1.7.m7.2.2.1.1.2">𝐼</ci><cn id="S3.SS3.p1.7.m7.2.2.1.1.3.cmml" type="integer" xref="S3.SS3.p1.7.m7.2.2.1.1.3">1</cn></apply><apply id="S3.SS3.p1.7.m7.3.3.2.2.cmml" xref="S3.SS3.p1.7.m7.3.3.2.2"><csymbol cd="ambiguous" id="S3.SS3.p1.7.m7.3.3.2.2.1.cmml" xref="S3.SS3.p1.7.m7.3.3.2.2">subscript</csymbol><ci id="S3.SS3.p1.7.m7.3.3.2.2.2.cmml" xref="S3.SS3.p1.7.m7.3.3.2.2.2">𝐼</ci><cn id="S3.SS3.p1.7.m7.3.3.2.2.3.cmml" type="integer" xref="S3.SS3.p1.7.m7.3.3.2.2.3">2</cn></apply><ci id="S3.SS3.p1.7.m7.1.1.cmml" xref="S3.SS3.p1.7.m7.1.1">…</ci><apply id="S3.SS3.p1.7.m7.4.4.3.3.cmml" xref="S3.SS3.p1.7.m7.4.4.3.3"><csymbol cd="ambiguous" id="S3.SS3.p1.7.m7.4.4.3.3.1.cmml" xref="S3.SS3.p1.7.m7.4.4.3.3">subscript</csymbol><ci id="S3.SS3.p1.7.m7.4.4.3.3.2.cmml" xref="S3.SS3.p1.7.m7.4.4.3.3.2">𝐼</ci><ci id="S3.SS3.p1.7.m7.4.4.3.3.3.cmml" xref="S3.SS3.p1.7.m7.4.4.3.3.3">𝐵</ci></apply></list></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p1.7.m7.4c">I_{1},I_{2},\ldots,I_{B}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p1.7.m7.4d">italic_I start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT , italic_I start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT , … , italic_I start_POSTSUBSCRIPT italic_B end_POSTSUBSCRIPT</annotation></semantics></math>. This partitioning is based on the predicted probability values assigned to each pixel.
Let <math alttext="Q_{1},\ldots,Q_{B-1}" class="ltx_Math" display="inline" id="S3.SS3.p1.8.m8.3"><semantics id="S3.SS3.p1.8.m8.3a"><mrow id="S3.SS3.p1.8.m8.3.3.2" xref="S3.SS3.p1.8.m8.3.3.3.cmml"><msub id="S3.SS3.p1.8.m8.2.2.1.1" xref="S3.SS3.p1.8.m8.2.2.1.1.cmml"><mi id="S3.SS3.p1.8.m8.2.2.1.1.2" xref="S3.SS3.p1.8.m8.2.2.1.1.2.cmml">Q</mi><mn id="S3.SS3.p1.8.m8.2.2.1.1.3" xref="S3.SS3.p1.8.m8.2.2.1.1.3.cmml">1</mn></msub><mo id="S3.SS3.p1.8.m8.3.3.2.3" xref="S3.SS3.p1.8.m8.3.3.3.cmml">,</mo><mi id="S3.SS3.p1.8.m8.1.1" mathvariant="normal" xref="S3.SS3.p1.8.m8.1.1.cmml">…</mi><mo id="S3.SS3.p1.8.m8.3.3.2.4" xref="S3.SS3.p1.8.m8.3.3.3.cmml">,</mo><msub id="S3.SS3.p1.8.m8.3.3.2.2" xref="S3.SS3.p1.8.m8.3.3.2.2.cmml"><mi id="S3.SS3.p1.8.m8.3.3.2.2.2" xref="S3.SS3.p1.8.m8.3.3.2.2.2.cmml">Q</mi><mrow id="S3.SS3.p1.8.m8.3.3.2.2.3" xref="S3.SS3.p1.8.m8.3.3.2.2.3.cmml"><mi id="S3.SS3.p1.8.m8.3.3.2.2.3.2" xref="S3.SS3.p1.8.m8.3.3.2.2.3.2.cmml">B</mi><mo id="S3.SS3.p1.8.m8.3.3.2.2.3.1" xref="S3.SS3.p1.8.m8.3.3.2.2.3.1.cmml">−</mo><mn id="S3.SS3.p1.8.m8.3.3.2.2.3.3" xref="S3.SS3.p1.8.m8.3.3.2.2.3.3.cmml">1</mn></mrow></msub></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.p1.8.m8.3b"><list id="S3.SS3.p1.8.m8.3.3.3.cmml" xref="S3.SS3.p1.8.m8.3.3.2"><apply id="S3.SS3.p1.8.m8.2.2.1.1.cmml" xref="S3.SS3.p1.8.m8.2.2.1.1"><csymbol cd="ambiguous" id="S3.SS3.p1.8.m8.2.2.1.1.1.cmml" xref="S3.SS3.p1.8.m8.2.2.1.1">subscript</csymbol><ci id="S3.SS3.p1.8.m8.2.2.1.1.2.cmml" xref="S3.SS3.p1.8.m8.2.2.1.1.2">𝑄</ci><cn id="S3.SS3.p1.8.m8.2.2.1.1.3.cmml" type="integer" xref="S3.SS3.p1.8.m8.2.2.1.1.3">1</cn></apply><ci id="S3.SS3.p1.8.m8.1.1.cmml" xref="S3.SS3.p1.8.m8.1.1">…</ci><apply id="S3.SS3.p1.8.m8.3.3.2.2.cmml" xref="S3.SS3.p1.8.m8.3.3.2.2"><csymbol cd="ambiguous" id="S3.SS3.p1.8.m8.3.3.2.2.1.cmml" xref="S3.SS3.p1.8.m8.3.3.2.2">subscript</csymbol><ci id="S3.SS3.p1.8.m8.3.3.2.2.2.cmml" xref="S3.SS3.p1.8.m8.3.3.2.2.2">𝑄</ci><apply id="S3.SS3.p1.8.m8.3.3.2.2.3.cmml" xref="S3.SS3.p1.8.m8.3.3.2.2.3"><minus id="S3.SS3.p1.8.m8.3.3.2.2.3.1.cmml" xref="S3.SS3.p1.8.m8.3.3.2.2.3.1"></minus><ci id="S3.SS3.p1.8.m8.3.3.2.2.3.2.cmml" xref="S3.SS3.p1.8.m8.3.3.2.2.3.2">𝐵</ci><cn id="S3.SS3.p1.8.m8.3.3.2.2.3.3.cmml" type="integer" xref="S3.SS3.p1.8.m8.3.3.2.2.3.3">1</cn></apply></apply></list></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p1.8.m8.3c">Q_{1},\ldots,Q_{B-1}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p1.8.m8.3d">italic_Q start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT , … , italic_Q start_POSTSUBSCRIPT italic_B - 1 end_POSTSUBSCRIPT</annotation></semantics></math> be the <math alttext="B" class="ltx_Math" display="inline" id="S3.SS3.p1.9.m9.1"><semantics id="S3.SS3.p1.9.m9.1a"><mi id="S3.SS3.p1.9.m9.1.1" xref="S3.SS3.p1.9.m9.1.1.cmml">B</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.p1.9.m9.1b"><ci id="S3.SS3.p1.9.m9.1.1.cmml" xref="S3.SS3.p1.9.m9.1.1">𝐵</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p1.9.m9.1c">B</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p1.9.m9.1d">italic_B</annotation></semantics></math>-quantiles of the set <math alttext="\{f_{\theta}(x_{1}),\ldots,f_{\theta}(x_{N})\}" class="ltx_Math" display="inline" id="S3.SS3.p1.10.m10.3"><semantics id="S3.SS3.p1.10.m10.3a"><mrow id="S3.SS3.p1.10.m10.3.3.2" xref="S3.SS3.p1.10.m10.3.3.3.cmml"><mo id="S3.SS3.p1.10.m10.3.3.2.3" stretchy="false" xref="S3.SS3.p1.10.m10.3.3.3.cmml">{</mo><mrow id="S3.SS3.p1.10.m10.2.2.1.1" xref="S3.SS3.p1.10.m10.2.2.1.1.cmml"><msub id="S3.SS3.p1.10.m10.2.2.1.1.3" xref="S3.SS3.p1.10.m10.2.2.1.1.3.cmml"><mi id="S3.SS3.p1.10.m10.2.2.1.1.3.2" xref="S3.SS3.p1.10.m10.2.2.1.1.3.2.cmml">f</mi><mi id="S3.SS3.p1.10.m10.2.2.1.1.3.3" xref="S3.SS3.p1.10.m10.2.2.1.1.3.3.cmml">θ</mi></msub><mo id="S3.SS3.p1.10.m10.2.2.1.1.2" xref="S3.SS3.p1.10.m10.2.2.1.1.2.cmml">⁢</mo><mrow id="S3.SS3.p1.10.m10.2.2.1.1.1.1" xref="S3.SS3.p1.10.m10.2.2.1.1.1.1.1.cmml"><mo id="S3.SS3.p1.10.m10.2.2.1.1.1.1.2" stretchy="false" xref="S3.SS3.p1.10.m10.2.2.1.1.1.1.1.cmml">(</mo><msub id="S3.SS3.p1.10.m10.2.2.1.1.1.1.1" xref="S3.SS3.p1.10.m10.2.2.1.1.1.1.1.cmml"><mi id="S3.SS3.p1.10.m10.2.2.1.1.1.1.1.2" xref="S3.SS3.p1.10.m10.2.2.1.1.1.1.1.2.cmml">x</mi><mn id="S3.SS3.p1.10.m10.2.2.1.1.1.1.1.3" xref="S3.SS3.p1.10.m10.2.2.1.1.1.1.1.3.cmml">1</mn></msub><mo id="S3.SS3.p1.10.m10.2.2.1.1.1.1.3" stretchy="false" xref="S3.SS3.p1.10.m10.2.2.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S3.SS3.p1.10.m10.3.3.2.4" xref="S3.SS3.p1.10.m10.3.3.3.cmml">,</mo><mi id="S3.SS3.p1.10.m10.1.1" mathvariant="normal" xref="S3.SS3.p1.10.m10.1.1.cmml">…</mi><mo id="S3.SS3.p1.10.m10.3.3.2.5" xref="S3.SS3.p1.10.m10.3.3.3.cmml">,</mo><mrow id="S3.SS3.p1.10.m10.3.3.2.2" xref="S3.SS3.p1.10.m10.3.3.2.2.cmml"><msub id="S3.SS3.p1.10.m10.3.3.2.2.3" xref="S3.SS3.p1.10.m10.3.3.2.2.3.cmml"><mi id="S3.SS3.p1.10.m10.3.3.2.2.3.2" xref="S3.SS3.p1.10.m10.3.3.2.2.3.2.cmml">f</mi><mi id="S3.SS3.p1.10.m10.3.3.2.2.3.3" xref="S3.SS3.p1.10.m10.3.3.2.2.3.3.cmml">θ</mi></msub><mo id="S3.SS3.p1.10.m10.3.3.2.2.2" xref="S3.SS3.p1.10.m10.3.3.2.2.2.cmml">⁢</mo><mrow id="S3.SS3.p1.10.m10.3.3.2.2.1.1" xref="S3.SS3.p1.10.m10.3.3.2.2.1.1.1.cmml"><mo id="S3.SS3.p1.10.m10.3.3.2.2.1.1.2" stretchy="false" xref="S3.SS3.p1.10.m10.3.3.2.2.1.1.1.cmml">(</mo><msub id="S3.SS3.p1.10.m10.3.3.2.2.1.1.1" xref="S3.SS3.p1.10.m10.3.3.2.2.1.1.1.cmml"><mi id="S3.SS3.p1.10.m10.3.3.2.2.1.1.1.2" xref="S3.SS3.p1.10.m10.3.3.2.2.1.1.1.2.cmml">x</mi><mi id="S3.SS3.p1.10.m10.3.3.2.2.1.1.1.3" xref="S3.SS3.p1.10.m10.3.3.2.2.1.1.1.3.cmml">N</mi></msub><mo id="S3.SS3.p1.10.m10.3.3.2.2.1.1.3" stretchy="false" xref="S3.SS3.p1.10.m10.3.3.2.2.1.1.1.cmml">)</mo></mrow></mrow><mo id="S3.SS3.p1.10.m10.3.3.2.6" stretchy="false" xref="S3.SS3.p1.10.m10.3.3.3.cmml">}</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.p1.10.m10.3b"><set id="S3.SS3.p1.10.m10.3.3.3.cmml" xref="S3.SS3.p1.10.m10.3.3.2"><apply id="S3.SS3.p1.10.m10.2.2.1.1.cmml" xref="S3.SS3.p1.10.m10.2.2.1.1"><times id="S3.SS3.p1.10.m10.2.2.1.1.2.cmml" xref="S3.SS3.p1.10.m10.2.2.1.1.2"></times><apply id="S3.SS3.p1.10.m10.2.2.1.1.3.cmml" xref="S3.SS3.p1.10.m10.2.2.1.1.3"><csymbol cd="ambiguous" id="S3.SS3.p1.10.m10.2.2.1.1.3.1.cmml" xref="S3.SS3.p1.10.m10.2.2.1.1.3">subscript</csymbol><ci id="S3.SS3.p1.10.m10.2.2.1.1.3.2.cmml" xref="S3.SS3.p1.10.m10.2.2.1.1.3.2">𝑓</ci><ci id="S3.SS3.p1.10.m10.2.2.1.1.3.3.cmml" xref="S3.SS3.p1.10.m10.2.2.1.1.3.3">𝜃</ci></apply><apply id="S3.SS3.p1.10.m10.2.2.1.1.1.1.1.cmml" xref="S3.SS3.p1.10.m10.2.2.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS3.p1.10.m10.2.2.1.1.1.1.1.1.cmml" xref="S3.SS3.p1.10.m10.2.2.1.1.1.1">subscript</csymbol><ci id="S3.SS3.p1.10.m10.2.2.1.1.1.1.1.2.cmml" xref="S3.SS3.p1.10.m10.2.2.1.1.1.1.1.2">𝑥</ci><cn id="S3.SS3.p1.10.m10.2.2.1.1.1.1.1.3.cmml" type="integer" xref="S3.SS3.p1.10.m10.2.2.1.1.1.1.1.3">1</cn></apply></apply><ci id="S3.SS3.p1.10.m10.1.1.cmml" xref="S3.SS3.p1.10.m10.1.1">…</ci><apply id="S3.SS3.p1.10.m10.3.3.2.2.cmml" xref="S3.SS3.p1.10.m10.3.3.2.2"><times id="S3.SS3.p1.10.m10.3.3.2.2.2.cmml" xref="S3.SS3.p1.10.m10.3.3.2.2.2"></times><apply id="S3.SS3.p1.10.m10.3.3.2.2.3.cmml" xref="S3.SS3.p1.10.m10.3.3.2.2.3"><csymbol cd="ambiguous" id="S3.SS3.p1.10.m10.3.3.2.2.3.1.cmml" xref="S3.SS3.p1.10.m10.3.3.2.2.3">subscript</csymbol><ci id="S3.SS3.p1.10.m10.3.3.2.2.3.2.cmml" xref="S3.SS3.p1.10.m10.3.3.2.2.3.2">𝑓</ci><ci id="S3.SS3.p1.10.m10.3.3.2.2.3.3.cmml" xref="S3.SS3.p1.10.m10.3.3.2.2.3.3">𝜃</ci></apply><apply id="S3.SS3.p1.10.m10.3.3.2.2.1.1.1.cmml" xref="S3.SS3.p1.10.m10.3.3.2.2.1.1"><csymbol cd="ambiguous" id="S3.SS3.p1.10.m10.3.3.2.2.1.1.1.1.cmml" xref="S3.SS3.p1.10.m10.3.3.2.2.1.1">subscript</csymbol><ci id="S3.SS3.p1.10.m10.3.3.2.2.1.1.1.2.cmml" xref="S3.SS3.p1.10.m10.3.3.2.2.1.1.1.2">𝑥</ci><ci id="S3.SS3.p1.10.m10.3.3.2.2.1.1.1.3.cmml" xref="S3.SS3.p1.10.m10.3.3.2.2.1.1.1.3">𝑁</ci></apply></apply></set></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p1.10.m10.3c">\{f_{\theta}(x_{1}),\ldots,f_{\theta}(x_{N})\}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p1.10.m10.3d">{ italic_f start_POSTSUBSCRIPT italic_θ end_POSTSUBSCRIPT ( italic_x start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT ) , … , italic_f start_POSTSUBSCRIPT italic_θ end_POSTSUBSCRIPT ( italic_x start_POSTSUBSCRIPT italic_N end_POSTSUBSCRIPT ) }</annotation></semantics></math>, we have</p>
<table class="ltx_equation ltx_eqn_table" id="S3.E2">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="I_{b}:=[Q_{b-1},Q_{b}]\cap\{f_{\theta}(x_{i})\}_{i=1}^{N}\quad\text{(setting }%
Q_{0}=0)." class="ltx_math_unparsed" display="block" id="S3.E2.m1.1"><semantics id="S3.E2.m1.1a"><mrow id="S3.E2.m1.1b"><msub id="S3.E2.m1.1.1"><mi id="S3.E2.m1.1.1.2">I</mi><mi id="S3.E2.m1.1.1.3">b</mi></msub><mo id="S3.E2.m1.1.2" lspace="0.278em" rspace="0.278em">:=</mo><mrow id="S3.E2.m1.1.3"><mo id="S3.E2.m1.1.3.1" stretchy="false">[</mo><msub id="S3.E2.m1.1.3.2"><mi id="S3.E2.m1.1.3.2.2">Q</mi><mrow id="S3.E2.m1.1.3.2.3"><mi id="S3.E2.m1.1.3.2.3.2">b</mi><mo id="S3.E2.m1.1.3.2.3.1">−</mo><mn id="S3.E2.m1.1.3.2.3.3">1</mn></mrow></msub><mo id="S3.E2.m1.1.3.3">,</mo><msub id="S3.E2.m1.1.3.4"><mi id="S3.E2.m1.1.3.4.2">Q</mi><mi id="S3.E2.m1.1.3.4.3">b</mi></msub><mo id="S3.E2.m1.1.3.5" stretchy="false">]</mo></mrow><mo id="S3.E2.m1.1.4">∩</mo><msubsup id="S3.E2.m1.1.5"><mrow id="S3.E2.m1.1.5.2.2"><mo id="S3.E2.m1.1.5.2.2.1" stretchy="false">{</mo><msub id="S3.E2.m1.1.5.2.2.2"><mi id="S3.E2.m1.1.5.2.2.2.2">f</mi><mi id="S3.E2.m1.1.5.2.2.2.3">θ</mi></msub><mrow id="S3.E2.m1.1.5.2.2.3"><mo id="S3.E2.m1.1.5.2.2.3.1" stretchy="false">(</mo><msub id="S3.E2.m1.1.5.2.2.3.2"><mi id="S3.E2.m1.1.5.2.2.3.2.2">x</mi><mi id="S3.E2.m1.1.5.2.2.3.2.3">i</mi></msub><mo id="S3.E2.m1.1.5.2.2.3.3" stretchy="false">)</mo></mrow><mo id="S3.E2.m1.1.5.2.2.4" stretchy="false">}</mo></mrow><mrow id="S3.E2.m1.1.5.2.3"><mi id="S3.E2.m1.1.5.2.3.2">i</mi><mo id="S3.E2.m1.1.5.2.3.1">=</mo><mn id="S3.E2.m1.1.5.2.3.3">1</mn></mrow><mi id="S3.E2.m1.1.5.3">N</mi></msubsup><mspace id="S3.E2.m1.1.6" width="1em"></mspace><mtext id="S3.E2.m1.1.7">(setting </mtext><msub id="S3.E2.m1.1.8"><mi id="S3.E2.m1.1.8.2">Q</mi><mn id="S3.E2.m1.1.8.3">0</mn></msub><mo id="S3.E2.m1.1.9">=</mo><mn id="S3.E2.m1.1.10">0</mn><mo id="S3.E2.m1.1.11" stretchy="false">)</mo><mo id="S3.E2.m1.1.12" lspace="0em">.</mo></mrow><annotation encoding="application/x-tex" id="S3.E2.m1.1c">I_{b}:=[Q_{b-1},Q_{b}]\cap\{f_{\theta}(x_{i})\}_{i=1}^{N}\quad\text{(setting }%
Q_{0}=0).</annotation><annotation encoding="application/x-llamapun" id="S3.E2.m1.1d">italic_I start_POSTSUBSCRIPT italic_b end_POSTSUBSCRIPT := [ italic_Q start_POSTSUBSCRIPT italic_b - 1 end_POSTSUBSCRIPT , italic_Q start_POSTSUBSCRIPT italic_b end_POSTSUBSCRIPT ] ∩ { italic_f start_POSTSUBSCRIPT italic_θ end_POSTSUBSCRIPT ( italic_x start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT ) } start_POSTSUBSCRIPT italic_i = 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_N end_POSTSUPERSCRIPT (setting italic_Q start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT = 0 ) .</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(2)</span></td>
</tr></tbody>
</table>
</div>
<div class="ltx_para" id="S3.SS3.p2">
<p class="ltx_p" id="S3.SS3.p2.1">For each bin <math alttext="I_{b}^{i}" class="ltx_Math" display="inline" id="S3.SS3.p2.1.m1.1"><semantics id="S3.SS3.p2.1.m1.1a"><msubsup id="S3.SS3.p2.1.m1.1.1" xref="S3.SS3.p2.1.m1.1.1.cmml"><mi id="S3.SS3.p2.1.m1.1.1.2.2" xref="S3.SS3.p2.1.m1.1.1.2.2.cmml">I</mi><mi id="S3.SS3.p2.1.m1.1.1.2.3" xref="S3.SS3.p2.1.m1.1.1.2.3.cmml">b</mi><mi id="S3.SS3.p2.1.m1.1.1.3" xref="S3.SS3.p2.1.m1.1.1.3.cmml">i</mi></msubsup><annotation-xml encoding="MathML-Content" id="S3.SS3.p2.1.m1.1b"><apply id="S3.SS3.p2.1.m1.1.1.cmml" xref="S3.SS3.p2.1.m1.1.1"><csymbol cd="ambiguous" id="S3.SS3.p2.1.m1.1.1.1.cmml" xref="S3.SS3.p2.1.m1.1.1">superscript</csymbol><apply id="S3.SS3.p2.1.m1.1.1.2.cmml" xref="S3.SS3.p2.1.m1.1.1"><csymbol cd="ambiguous" id="S3.SS3.p2.1.m1.1.1.2.1.cmml" xref="S3.SS3.p2.1.m1.1.1">subscript</csymbol><ci id="S3.SS3.p2.1.m1.1.1.2.2.cmml" xref="S3.SS3.p2.1.m1.1.1.2.2">𝐼</ci><ci id="S3.SS3.p2.1.m1.1.1.2.3.cmml" xref="S3.SS3.p2.1.m1.1.1.2.3">𝑏</ci></apply><ci id="S3.SS3.p2.1.m1.1.1.3.cmml" xref="S3.SS3.p2.1.m1.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p2.1.m1.1c">I_{b}^{i}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p2.1.m1.1d">italic_I start_POSTSUBSCRIPT italic_b end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_i end_POSTSUPERSCRIPT</annotation></semantics></math>, we compute the mean of empirical and predicted probabilities, defined as</p>
</div>
<div class="ltx_para" id="S3.SS3.p3">
<table class="ltx_equation ltx_eqn_table" id="S3.E3">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="p_{\text{emp}}^{(b)}=\mathbb{E}\left(y\mid f_{\theta}(x)\in I_{b}\right)=\frac%
{1}{|I_{b}|}\sum_{i\in\text{Index}\left(I_{b}\right)}y_{i}" class="ltx_Math" display="block" id="S3.E3.m1.5"><semantics id="S3.E3.m1.5a"><mrow id="S3.E3.m1.5.5" xref="S3.E3.m1.5.5.cmml"><msubsup id="S3.E3.m1.5.5.3" xref="S3.E3.m1.5.5.3.cmml"><mi id="S3.E3.m1.5.5.3.2.2" xref="S3.E3.m1.5.5.3.2.2.cmml">p</mi><mtext id="S3.E3.m1.5.5.3.2.3" xref="S3.E3.m1.5.5.3.2.3a.cmml">emp</mtext><mrow id="S3.E3.m1.1.1.1.3" xref="S3.E3.m1.5.5.3.cmml"><mo id="S3.E3.m1.1.1.1.3.1" stretchy="false" xref="S3.E3.m1.5.5.3.cmml">(</mo><mi id="S3.E3.m1.1.1.1.1" xref="S3.E3.m1.1.1.1.1.cmml">b</mi><mo id="S3.E3.m1.1.1.1.3.2" stretchy="false" xref="S3.E3.m1.5.5.3.cmml">)</mo></mrow></msubsup><mo id="S3.E3.m1.5.5.4" xref="S3.E3.m1.5.5.4.cmml">=</mo><mrow id="S3.E3.m1.5.5.1" xref="S3.E3.m1.5.5.1.cmml"><mi id="S3.E3.m1.5.5.1.3" xref="S3.E3.m1.5.5.1.3.cmml">𝔼</mi><mo id="S3.E3.m1.5.5.1.2" xref="S3.E3.m1.5.5.1.2.cmml">⁢</mo><mrow id="S3.E3.m1.5.5.1.1.1" xref="S3.E3.m1.5.5.1.1.1.1.cmml"><mo id="S3.E3.m1.5.5.1.1.1.2" xref="S3.E3.m1.5.5.1.1.1.1.cmml">(</mo><mrow id="S3.E3.m1.5.5.1.1.1.1" xref="S3.E3.m1.5.5.1.1.1.1.cmml"><mrow id="S3.E3.m1.5.5.1.1.1.1.2" xref="S3.E3.m1.5.5.1.1.1.1.2.cmml"><mi id="S3.E3.m1.5.5.1.1.1.1.2.2" xref="S3.E3.m1.5.5.1.1.1.1.2.2.cmml">y</mi><mo id="S3.E3.m1.5.5.1.1.1.1.2.1" xref="S3.E3.m1.5.5.1.1.1.1.2.1.cmml">∣</mo><mrow id="S3.E3.m1.5.5.1.1.1.1.2.3" xref="S3.E3.m1.5.5.1.1.1.1.2.3.cmml"><msub id="S3.E3.m1.5.5.1.1.1.1.2.3.2" xref="S3.E3.m1.5.5.1.1.1.1.2.3.2.cmml"><mi id="S3.E3.m1.5.5.1.1.1.1.2.3.2.2" xref="S3.E3.m1.5.5.1.1.1.1.2.3.2.2.cmml">f</mi><mi id="S3.E3.m1.5.5.1.1.1.1.2.3.2.3" xref="S3.E3.m1.5.5.1.1.1.1.2.3.2.3.cmml">θ</mi></msub><mo id="S3.E3.m1.5.5.1.1.1.1.2.3.1" xref="S3.E3.m1.5.5.1.1.1.1.2.3.1.cmml">⁢</mo><mrow id="S3.E3.m1.5.5.1.1.1.1.2.3.3.2" xref="S3.E3.m1.5.5.1.1.1.1.2.3.cmml"><mo id="S3.E3.m1.5.5.1.1.1.1.2.3.3.2.1" stretchy="false" xref="S3.E3.m1.5.5.1.1.1.1.2.3.cmml">(</mo><mi id="S3.E3.m1.4.4" xref="S3.E3.m1.4.4.cmml">x</mi><mo id="S3.E3.m1.5.5.1.1.1.1.2.3.3.2.2" stretchy="false" xref="S3.E3.m1.5.5.1.1.1.1.2.3.cmml">)</mo></mrow></mrow></mrow><mo id="S3.E3.m1.5.5.1.1.1.1.1" xref="S3.E3.m1.5.5.1.1.1.1.1.cmml">∈</mo><msub id="S3.E3.m1.5.5.1.1.1.1.3" xref="S3.E3.m1.5.5.1.1.1.1.3.cmml"><mi id="S3.E3.m1.5.5.1.1.1.1.3.2" xref="S3.E3.m1.5.5.1.1.1.1.3.2.cmml">I</mi><mi id="S3.E3.m1.5.5.1.1.1.1.3.3" xref="S3.E3.m1.5.5.1.1.1.1.3.3.cmml">b</mi></msub></mrow><mo id="S3.E3.m1.5.5.1.1.1.3" xref="S3.E3.m1.5.5.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S3.E3.m1.5.5.5" xref="S3.E3.m1.5.5.5.cmml">=</mo><mrow id="S3.E3.m1.5.5.6" xref="S3.E3.m1.5.5.6.cmml"><mfrac id="S3.E3.m1.2.2" xref="S3.E3.m1.2.2.cmml"><mn id="S3.E3.m1.2.2.3" xref="S3.E3.m1.2.2.3.cmml">1</mn><mrow id="S3.E3.m1.2.2.1.1" xref="S3.E3.m1.2.2.1.2.cmml"><mo id="S3.E3.m1.2.2.1.1.2" stretchy="false" xref="S3.E3.m1.2.2.1.2.1.cmml">|</mo><msub id="S3.E3.m1.2.2.1.1.1" xref="S3.E3.m1.2.2.1.1.1.cmml"><mi id="S3.E3.m1.2.2.1.1.1.2" xref="S3.E3.m1.2.2.1.1.1.2.cmml">I</mi><mi id="S3.E3.m1.2.2.1.1.1.3" xref="S3.E3.m1.2.2.1.1.1.3.cmml">b</mi></msub><mo id="S3.E3.m1.2.2.1.1.3" stretchy="false" xref="S3.E3.m1.2.2.1.2.1.cmml">|</mo></mrow></mfrac><mo id="S3.E3.m1.5.5.6.1" xref="S3.E3.m1.5.5.6.1.cmml">⁢</mo><mrow id="S3.E3.m1.5.5.6.2" xref="S3.E3.m1.5.5.6.2.cmml"><munder id="S3.E3.m1.5.5.6.2.1" xref="S3.E3.m1.5.5.6.2.1.cmml"><mo id="S3.E3.m1.5.5.6.2.1.2" movablelimits="false" xref="S3.E3.m1.5.5.6.2.1.2.cmml">∑</mo><mrow id="S3.E3.m1.3.3.1" xref="S3.E3.m1.3.3.1.cmml"><mi id="S3.E3.m1.3.3.1.3" xref="S3.E3.m1.3.3.1.3.cmml">i</mi><mo id="S3.E3.m1.3.3.1.2" xref="S3.E3.m1.3.3.1.2.cmml">∈</mo><mrow id="S3.E3.m1.3.3.1.1" xref="S3.E3.m1.3.3.1.1.cmml"><mtext id="S3.E3.m1.3.3.1.1.3" xref="S3.E3.m1.3.3.1.1.3a.cmml">Index</mtext><mo id="S3.E3.m1.3.3.1.1.2" xref="S3.E3.m1.3.3.1.1.2.cmml">⁢</mo><mrow id="S3.E3.m1.3.3.1.1.1.1" xref="S3.E3.m1.3.3.1.1.1.1.1.cmml"><mo id="S3.E3.m1.3.3.1.1.1.1.2" xref="S3.E3.m1.3.3.1.1.1.1.1.cmml">(</mo><msub id="S3.E3.m1.3.3.1.1.1.1.1" xref="S3.E3.m1.3.3.1.1.1.1.1.cmml"><mi id="S3.E3.m1.3.3.1.1.1.1.1.2" xref="S3.E3.m1.3.3.1.1.1.1.1.2.cmml">I</mi><mi id="S3.E3.m1.3.3.1.1.1.1.1.3" xref="S3.E3.m1.3.3.1.1.1.1.1.3.cmml">b</mi></msub><mo id="S3.E3.m1.3.3.1.1.1.1.3" xref="S3.E3.m1.3.3.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow></munder><msub id="S3.E3.m1.5.5.6.2.2" xref="S3.E3.m1.5.5.6.2.2.cmml"><mi id="S3.E3.m1.5.5.6.2.2.2" xref="S3.E3.m1.5.5.6.2.2.2.cmml">y</mi><mi id="S3.E3.m1.5.5.6.2.2.3" xref="S3.E3.m1.5.5.6.2.2.3.cmml">i</mi></msub></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.E3.m1.5b"><apply id="S3.E3.m1.5.5.cmml" xref="S3.E3.m1.5.5"><and id="S3.E3.m1.5.5a.cmml" xref="S3.E3.m1.5.5"></and><apply id="S3.E3.m1.5.5b.cmml" xref="S3.E3.m1.5.5"><eq id="S3.E3.m1.5.5.4.cmml" xref="S3.E3.m1.5.5.4"></eq><apply id="S3.E3.m1.5.5.3.cmml" xref="S3.E3.m1.5.5.3"><csymbol cd="ambiguous" id="S3.E3.m1.5.5.3.1.cmml" xref="S3.E3.m1.5.5.3">superscript</csymbol><apply id="S3.E3.m1.5.5.3.2.cmml" xref="S3.E3.m1.5.5.3"><csymbol cd="ambiguous" id="S3.E3.m1.5.5.3.2.1.cmml" xref="S3.E3.m1.5.5.3">subscript</csymbol><ci id="S3.E3.m1.5.5.3.2.2.cmml" xref="S3.E3.m1.5.5.3.2.2">𝑝</ci><ci id="S3.E3.m1.5.5.3.2.3a.cmml" xref="S3.E3.m1.5.5.3.2.3"><mtext id="S3.E3.m1.5.5.3.2.3.cmml" mathsize="70%" xref="S3.E3.m1.5.5.3.2.3">emp</mtext></ci></apply><ci id="S3.E3.m1.1.1.1.1.cmml" xref="S3.E3.m1.1.1.1.1">𝑏</ci></apply><apply id="S3.E3.m1.5.5.1.cmml" xref="S3.E3.m1.5.5.1"><times id="S3.E3.m1.5.5.1.2.cmml" xref="S3.E3.m1.5.5.1.2"></times><ci id="S3.E3.m1.5.5.1.3.cmml" xref="S3.E3.m1.5.5.1.3">𝔼</ci><apply id="S3.E3.m1.5.5.1.1.1.1.cmml" xref="S3.E3.m1.5.5.1.1.1"><in id="S3.E3.m1.5.5.1.1.1.1.1.cmml" xref="S3.E3.m1.5.5.1.1.1.1.1"></in><apply id="S3.E3.m1.5.5.1.1.1.1.2.cmml" xref="S3.E3.m1.5.5.1.1.1.1.2"><csymbol cd="latexml" id="S3.E3.m1.5.5.1.1.1.1.2.1.cmml" xref="S3.E3.m1.5.5.1.1.1.1.2.1">conditional</csymbol><ci id="S3.E3.m1.5.5.1.1.1.1.2.2.cmml" xref="S3.E3.m1.5.5.1.1.1.1.2.2">𝑦</ci><apply id="S3.E3.m1.5.5.1.1.1.1.2.3.cmml" xref="S3.E3.m1.5.5.1.1.1.1.2.3"><times id="S3.E3.m1.5.5.1.1.1.1.2.3.1.cmml" xref="S3.E3.m1.5.5.1.1.1.1.2.3.1"></times><apply id="S3.E3.m1.5.5.1.1.1.1.2.3.2.cmml" xref="S3.E3.m1.5.5.1.1.1.1.2.3.2"><csymbol cd="ambiguous" id="S3.E3.m1.5.5.1.1.1.1.2.3.2.1.cmml" xref="S3.E3.m1.5.5.1.1.1.1.2.3.2">subscript</csymbol><ci id="S3.E3.m1.5.5.1.1.1.1.2.3.2.2.cmml" xref="S3.E3.m1.5.5.1.1.1.1.2.3.2.2">𝑓</ci><ci id="S3.E3.m1.5.5.1.1.1.1.2.3.2.3.cmml" xref="S3.E3.m1.5.5.1.1.1.1.2.3.2.3">𝜃</ci></apply><ci id="S3.E3.m1.4.4.cmml" xref="S3.E3.m1.4.4">𝑥</ci></apply></apply><apply id="S3.E3.m1.5.5.1.1.1.1.3.cmml" xref="S3.E3.m1.5.5.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.E3.m1.5.5.1.1.1.1.3.1.cmml" xref="S3.E3.m1.5.5.1.1.1.1.3">subscript</csymbol><ci id="S3.E3.m1.5.5.1.1.1.1.3.2.cmml" xref="S3.E3.m1.5.5.1.1.1.1.3.2">𝐼</ci><ci id="S3.E3.m1.5.5.1.1.1.1.3.3.cmml" xref="S3.E3.m1.5.5.1.1.1.1.3.3">𝑏</ci></apply></apply></apply></apply><apply id="S3.E3.m1.5.5c.cmml" xref="S3.E3.m1.5.5"><eq id="S3.E3.m1.5.5.5.cmml" xref="S3.E3.m1.5.5.5"></eq><share href="https://arxiv.org/html/2409.12535v1#S3.E3.m1.5.5.1.cmml" id="S3.E3.m1.5.5d.cmml" xref="S3.E3.m1.5.5"></share><apply id="S3.E3.m1.5.5.6.cmml" xref="S3.E3.m1.5.5.6"><times id="S3.E3.m1.5.5.6.1.cmml" xref="S3.E3.m1.5.5.6.1"></times><apply id="S3.E3.m1.2.2.cmml" xref="S3.E3.m1.2.2"><divide id="S3.E3.m1.2.2.2.cmml" xref="S3.E3.m1.2.2"></divide><cn id="S3.E3.m1.2.2.3.cmml" type="integer" xref="S3.E3.m1.2.2.3">1</cn><apply id="S3.E3.m1.2.2.1.2.cmml" xref="S3.E3.m1.2.2.1.1"><abs id="S3.E3.m1.2.2.1.2.1.cmml" xref="S3.E3.m1.2.2.1.1.2"></abs><apply id="S3.E3.m1.2.2.1.1.1.cmml" xref="S3.E3.m1.2.2.1.1.1"><csymbol cd="ambiguous" id="S3.E3.m1.2.2.1.1.1.1.cmml" xref="S3.E3.m1.2.2.1.1.1">subscript</csymbol><ci id="S3.E3.m1.2.2.1.1.1.2.cmml" xref="S3.E3.m1.2.2.1.1.1.2">𝐼</ci><ci id="S3.E3.m1.2.2.1.1.1.3.cmml" xref="S3.E3.m1.2.2.1.1.1.3">𝑏</ci></apply></apply></apply><apply id="S3.E3.m1.5.5.6.2.cmml" xref="S3.E3.m1.5.5.6.2"><apply id="S3.E3.m1.5.5.6.2.1.cmml" xref="S3.E3.m1.5.5.6.2.1"><csymbol cd="ambiguous" id="S3.E3.m1.5.5.6.2.1.1.cmml" xref="S3.E3.m1.5.5.6.2.1">subscript</csymbol><sum id="S3.E3.m1.5.5.6.2.1.2.cmml" xref="S3.E3.m1.5.5.6.2.1.2"></sum><apply id="S3.E3.m1.3.3.1.cmml" xref="S3.E3.m1.3.3.1"><in id="S3.E3.m1.3.3.1.2.cmml" xref="S3.E3.m1.3.3.1.2"></in><ci id="S3.E3.m1.3.3.1.3.cmml" xref="S3.E3.m1.3.3.1.3">𝑖</ci><apply id="S3.E3.m1.3.3.1.1.cmml" xref="S3.E3.m1.3.3.1.1"><times id="S3.E3.m1.3.3.1.1.2.cmml" xref="S3.E3.m1.3.3.1.1.2"></times><ci id="S3.E3.m1.3.3.1.1.3a.cmml" xref="S3.E3.m1.3.3.1.1.3"><mtext id="S3.E3.m1.3.3.1.1.3.cmml" mathsize="70%" xref="S3.E3.m1.3.3.1.1.3">Index</mtext></ci><apply id="S3.E3.m1.3.3.1.1.1.1.1.cmml" xref="S3.E3.m1.3.3.1.1.1.1"><csymbol cd="ambiguous" id="S3.E3.m1.3.3.1.1.1.1.1.1.cmml" xref="S3.E3.m1.3.3.1.1.1.1">subscript</csymbol><ci id="S3.E3.m1.3.3.1.1.1.1.1.2.cmml" xref="S3.E3.m1.3.3.1.1.1.1.1.2">𝐼</ci><ci id="S3.E3.m1.3.3.1.1.1.1.1.3.cmml" xref="S3.E3.m1.3.3.1.1.1.1.1.3">𝑏</ci></apply></apply></apply></apply><apply id="S3.E3.m1.5.5.6.2.2.cmml" xref="S3.E3.m1.5.5.6.2.2"><csymbol cd="ambiguous" id="S3.E3.m1.5.5.6.2.2.1.cmml" xref="S3.E3.m1.5.5.6.2.2">subscript</csymbol><ci id="S3.E3.m1.5.5.6.2.2.2.cmml" xref="S3.E3.m1.5.5.6.2.2.2">𝑦</ci><ci id="S3.E3.m1.5.5.6.2.2.3.cmml" xref="S3.E3.m1.5.5.6.2.2.3">𝑖</ci></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E3.m1.5c">p_{\text{emp}}^{(b)}=\mathbb{E}\left(y\mid f_{\theta}(x)\in I_{b}\right)=\frac%
{1}{|I_{b}|}\sum_{i\in\text{Index}\left(I_{b}\right)}y_{i}</annotation><annotation encoding="application/x-llamapun" id="S3.E3.m1.5d">italic_p start_POSTSUBSCRIPT emp end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ( italic_b ) end_POSTSUPERSCRIPT = blackboard_E ( italic_y ∣ italic_f start_POSTSUBSCRIPT italic_θ end_POSTSUBSCRIPT ( italic_x ) ∈ italic_I start_POSTSUBSCRIPT italic_b end_POSTSUBSCRIPT ) = divide start_ARG 1 end_ARG start_ARG | italic_I start_POSTSUBSCRIPT italic_b end_POSTSUBSCRIPT | end_ARG ∑ start_POSTSUBSCRIPT italic_i ∈ Index ( italic_I start_POSTSUBSCRIPT italic_b end_POSTSUBSCRIPT ) end_POSTSUBSCRIPT italic_y start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(3)</span></td>
</tr></tbody>
</table>
<table class="ltx_equation ltx_eqn_table" id="S3.E4">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="q^{(b)}=\frac{1}{|I_{b}|}\sum_{i\in\text{Index}\left(I_{b}\right)}f_{\theta}%
\left(x_{i}\right)" class="ltx_Math" display="block" id="S3.E4.m1.4"><semantics id="S3.E4.m1.4a"><mrow id="S3.E4.m1.4.4" xref="S3.E4.m1.4.4.cmml"><msup id="S3.E4.m1.4.4.3" xref="S3.E4.m1.4.4.3.cmml"><mi id="S3.E4.m1.4.4.3.2" xref="S3.E4.m1.4.4.3.2.cmml">q</mi><mrow id="S3.E4.m1.1.1.1.3" xref="S3.E4.m1.4.4.3.cmml"><mo id="S3.E4.m1.1.1.1.3.1" stretchy="false" xref="S3.E4.m1.4.4.3.cmml">(</mo><mi id="S3.E4.m1.1.1.1.1" xref="S3.E4.m1.1.1.1.1.cmml">b</mi><mo id="S3.E4.m1.1.1.1.3.2" stretchy="false" xref="S3.E4.m1.4.4.3.cmml">)</mo></mrow></msup><mo id="S3.E4.m1.4.4.2" xref="S3.E4.m1.4.4.2.cmml">=</mo><mrow id="S3.E4.m1.4.4.1" xref="S3.E4.m1.4.4.1.cmml"><mfrac id="S3.E4.m1.2.2" xref="S3.E4.m1.2.2.cmml"><mn id="S3.E4.m1.2.2.3" xref="S3.E4.m1.2.2.3.cmml">1</mn><mrow id="S3.E4.m1.2.2.1.1" xref="S3.E4.m1.2.2.1.2.cmml"><mo id="S3.E4.m1.2.2.1.1.2" stretchy="false" xref="S3.E4.m1.2.2.1.2.1.cmml">|</mo><msub id="S3.E4.m1.2.2.1.1.1" xref="S3.E4.m1.2.2.1.1.1.cmml"><mi id="S3.E4.m1.2.2.1.1.1.2" xref="S3.E4.m1.2.2.1.1.1.2.cmml">I</mi><mi id="S3.E4.m1.2.2.1.1.1.3" xref="S3.E4.m1.2.2.1.1.1.3.cmml">b</mi></msub><mo id="S3.E4.m1.2.2.1.1.3" stretchy="false" xref="S3.E4.m1.2.2.1.2.1.cmml">|</mo></mrow></mfrac><mo id="S3.E4.m1.4.4.1.2" xref="S3.E4.m1.4.4.1.2.cmml">⁢</mo><mrow id="S3.E4.m1.4.4.1.1" xref="S3.E4.m1.4.4.1.1.cmml"><munder id="S3.E4.m1.4.4.1.1.2" xref="S3.E4.m1.4.4.1.1.2.cmml"><mo id="S3.E4.m1.4.4.1.1.2.2" movablelimits="false" xref="S3.E4.m1.4.4.1.1.2.2.cmml">∑</mo><mrow id="S3.E4.m1.3.3.1" xref="S3.E4.m1.3.3.1.cmml"><mi id="S3.E4.m1.3.3.1.3" xref="S3.E4.m1.3.3.1.3.cmml">i</mi><mo id="S3.E4.m1.3.3.1.2" xref="S3.E4.m1.3.3.1.2.cmml">∈</mo><mrow id="S3.E4.m1.3.3.1.1" xref="S3.E4.m1.3.3.1.1.cmml"><mtext id="S3.E4.m1.3.3.1.1.3" xref="S3.E4.m1.3.3.1.1.3a.cmml">Index</mtext><mo id="S3.E4.m1.3.3.1.1.2" xref="S3.E4.m1.3.3.1.1.2.cmml">⁢</mo><mrow id="S3.E4.m1.3.3.1.1.1.1" xref="S3.E4.m1.3.3.1.1.1.1.1.cmml"><mo id="S3.E4.m1.3.3.1.1.1.1.2" xref="S3.E4.m1.3.3.1.1.1.1.1.cmml">(</mo><msub id="S3.E4.m1.3.3.1.1.1.1.1" xref="S3.E4.m1.3.3.1.1.1.1.1.cmml"><mi id="S3.E4.m1.3.3.1.1.1.1.1.2" xref="S3.E4.m1.3.3.1.1.1.1.1.2.cmml">I</mi><mi id="S3.E4.m1.3.3.1.1.1.1.1.3" xref="S3.E4.m1.3.3.1.1.1.1.1.3.cmml">b</mi></msub><mo id="S3.E4.m1.3.3.1.1.1.1.3" xref="S3.E4.m1.3.3.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow></munder><mrow id="S3.E4.m1.4.4.1.1.1" xref="S3.E4.m1.4.4.1.1.1.cmml"><msub id="S3.E4.m1.4.4.1.1.1.3" xref="S3.E4.m1.4.4.1.1.1.3.cmml"><mi id="S3.E4.m1.4.4.1.1.1.3.2" xref="S3.E4.m1.4.4.1.1.1.3.2.cmml">f</mi><mi id="S3.E4.m1.4.4.1.1.1.3.3" xref="S3.E4.m1.4.4.1.1.1.3.3.cmml">θ</mi></msub><mo id="S3.E4.m1.4.4.1.1.1.2" xref="S3.E4.m1.4.4.1.1.1.2.cmml">⁢</mo><mrow id="S3.E4.m1.4.4.1.1.1.1.1" xref="S3.E4.m1.4.4.1.1.1.1.1.1.cmml"><mo id="S3.E4.m1.4.4.1.1.1.1.1.2" xref="S3.E4.m1.4.4.1.1.1.1.1.1.cmml">(</mo><msub id="S3.E4.m1.4.4.1.1.1.1.1.1" xref="S3.E4.m1.4.4.1.1.1.1.1.1.cmml"><mi id="S3.E4.m1.4.4.1.1.1.1.1.1.2" xref="S3.E4.m1.4.4.1.1.1.1.1.1.2.cmml">x</mi><mi id="S3.E4.m1.4.4.1.1.1.1.1.1.3" xref="S3.E4.m1.4.4.1.1.1.1.1.1.3.cmml">i</mi></msub><mo id="S3.E4.m1.4.4.1.1.1.1.1.3" xref="S3.E4.m1.4.4.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.E4.m1.4b"><apply id="S3.E4.m1.4.4.cmml" xref="S3.E4.m1.4.4"><eq id="S3.E4.m1.4.4.2.cmml" xref="S3.E4.m1.4.4.2"></eq><apply id="S3.E4.m1.4.4.3.cmml" xref="S3.E4.m1.4.4.3"><csymbol cd="ambiguous" id="S3.E4.m1.4.4.3.1.cmml" xref="S3.E4.m1.4.4.3">superscript</csymbol><ci id="S3.E4.m1.4.4.3.2.cmml" xref="S3.E4.m1.4.4.3.2">𝑞</ci><ci id="S3.E4.m1.1.1.1.1.cmml" xref="S3.E4.m1.1.1.1.1">𝑏</ci></apply><apply id="S3.E4.m1.4.4.1.cmml" xref="S3.E4.m1.4.4.1"><times id="S3.E4.m1.4.4.1.2.cmml" xref="S3.E4.m1.4.4.1.2"></times><apply id="S3.E4.m1.2.2.cmml" xref="S3.E4.m1.2.2"><divide id="S3.E4.m1.2.2.2.cmml" xref="S3.E4.m1.2.2"></divide><cn id="S3.E4.m1.2.2.3.cmml" type="integer" xref="S3.E4.m1.2.2.3">1</cn><apply id="S3.E4.m1.2.2.1.2.cmml" xref="S3.E4.m1.2.2.1.1"><abs id="S3.E4.m1.2.2.1.2.1.cmml" xref="S3.E4.m1.2.2.1.1.2"></abs><apply id="S3.E4.m1.2.2.1.1.1.cmml" xref="S3.E4.m1.2.2.1.1.1"><csymbol cd="ambiguous" id="S3.E4.m1.2.2.1.1.1.1.cmml" xref="S3.E4.m1.2.2.1.1.1">subscript</csymbol><ci id="S3.E4.m1.2.2.1.1.1.2.cmml" xref="S3.E4.m1.2.2.1.1.1.2">𝐼</ci><ci id="S3.E4.m1.2.2.1.1.1.3.cmml" xref="S3.E4.m1.2.2.1.1.1.3">𝑏</ci></apply></apply></apply><apply id="S3.E4.m1.4.4.1.1.cmml" xref="S3.E4.m1.4.4.1.1"><apply id="S3.E4.m1.4.4.1.1.2.cmml" xref="S3.E4.m1.4.4.1.1.2"><csymbol cd="ambiguous" id="S3.E4.m1.4.4.1.1.2.1.cmml" xref="S3.E4.m1.4.4.1.1.2">subscript</csymbol><sum id="S3.E4.m1.4.4.1.1.2.2.cmml" xref="S3.E4.m1.4.4.1.1.2.2"></sum><apply id="S3.E4.m1.3.3.1.cmml" xref="S3.E4.m1.3.3.1"><in id="S3.E4.m1.3.3.1.2.cmml" xref="S3.E4.m1.3.3.1.2"></in><ci id="S3.E4.m1.3.3.1.3.cmml" xref="S3.E4.m1.3.3.1.3">𝑖</ci><apply id="S3.E4.m1.3.3.1.1.cmml" xref="S3.E4.m1.3.3.1.1"><times id="S3.E4.m1.3.3.1.1.2.cmml" xref="S3.E4.m1.3.3.1.1.2"></times><ci id="S3.E4.m1.3.3.1.1.3a.cmml" xref="S3.E4.m1.3.3.1.1.3"><mtext id="S3.E4.m1.3.3.1.1.3.cmml" mathsize="70%" xref="S3.E4.m1.3.3.1.1.3">Index</mtext></ci><apply id="S3.E4.m1.3.3.1.1.1.1.1.cmml" xref="S3.E4.m1.3.3.1.1.1.1"><csymbol cd="ambiguous" id="S3.E4.m1.3.3.1.1.1.1.1.1.cmml" xref="S3.E4.m1.3.3.1.1.1.1">subscript</csymbol><ci id="S3.E4.m1.3.3.1.1.1.1.1.2.cmml" xref="S3.E4.m1.3.3.1.1.1.1.1.2">𝐼</ci><ci id="S3.E4.m1.3.3.1.1.1.1.1.3.cmml" xref="S3.E4.m1.3.3.1.1.1.1.1.3">𝑏</ci></apply></apply></apply></apply><apply id="S3.E4.m1.4.4.1.1.1.cmml" xref="S3.E4.m1.4.4.1.1.1"><times id="S3.E4.m1.4.4.1.1.1.2.cmml" xref="S3.E4.m1.4.4.1.1.1.2"></times><apply id="S3.E4.m1.4.4.1.1.1.3.cmml" xref="S3.E4.m1.4.4.1.1.1.3"><csymbol cd="ambiguous" id="S3.E4.m1.4.4.1.1.1.3.1.cmml" xref="S3.E4.m1.4.4.1.1.1.3">subscript</csymbol><ci id="S3.E4.m1.4.4.1.1.1.3.2.cmml" xref="S3.E4.m1.4.4.1.1.1.3.2">𝑓</ci><ci id="S3.E4.m1.4.4.1.1.1.3.3.cmml" xref="S3.E4.m1.4.4.1.1.1.3.3">𝜃</ci></apply><apply id="S3.E4.m1.4.4.1.1.1.1.1.1.cmml" xref="S3.E4.m1.4.4.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E4.m1.4.4.1.1.1.1.1.1.1.cmml" xref="S3.E4.m1.4.4.1.1.1.1.1">subscript</csymbol><ci id="S3.E4.m1.4.4.1.1.1.1.1.1.2.cmml" xref="S3.E4.m1.4.4.1.1.1.1.1.1.2">𝑥</ci><ci id="S3.E4.m1.4.4.1.1.1.1.1.1.3.cmml" xref="S3.E4.m1.4.4.1.1.1.1.1.1.3">𝑖</ci></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E4.m1.4c">q^{(b)}=\frac{1}{|I_{b}|}\sum_{i\in\text{Index}\left(I_{b}\right)}f_{\theta}%
\left(x_{i}\right)</annotation><annotation encoding="application/x-llamapun" id="S3.E4.m1.4d">italic_q start_POSTSUPERSCRIPT ( italic_b ) end_POSTSUPERSCRIPT = divide start_ARG 1 end_ARG start_ARG | italic_I start_POSTSUBSCRIPT italic_b end_POSTSUBSCRIPT | end_ARG ∑ start_POSTSUBSCRIPT italic_i ∈ Index ( italic_I start_POSTSUBSCRIPT italic_b end_POSTSUBSCRIPT ) end_POSTSUBSCRIPT italic_f start_POSTSUBSCRIPT italic_θ end_POSTSUBSCRIPT ( italic_x start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT )</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(4)</span></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S3.SS3.p3.2">where Index(<math alttext="I_{b}" class="ltx_Math" display="inline" id="S3.SS3.p3.1.m1.1"><semantics id="S3.SS3.p3.1.m1.1a"><msub id="S3.SS3.p3.1.m1.1.1" xref="S3.SS3.p3.1.m1.1.1.cmml"><mi id="S3.SS3.p3.1.m1.1.1.2" xref="S3.SS3.p3.1.m1.1.1.2.cmml">I</mi><mi id="S3.SS3.p3.1.m1.1.1.3" xref="S3.SS3.p3.1.m1.1.1.3.cmml">b</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS3.p3.1.m1.1b"><apply id="S3.SS3.p3.1.m1.1.1.cmml" xref="S3.SS3.p3.1.m1.1.1"><csymbol cd="ambiguous" id="S3.SS3.p3.1.m1.1.1.1.cmml" xref="S3.SS3.p3.1.m1.1.1">subscript</csymbol><ci id="S3.SS3.p3.1.m1.1.1.2.cmml" xref="S3.SS3.p3.1.m1.1.1.2">𝐼</ci><ci id="S3.SS3.p3.1.m1.1.1.3.cmml" xref="S3.SS3.p3.1.m1.1.1.3">𝑏</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p3.1.m1.1c">I_{b}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p3.1.m1.1d">italic_I start_POSTSUBSCRIPT italic_b end_POSTSUBSCRIPT</annotation></semantics></math>) = <math alttext="\{i\mid f_{\theta}(x_{i})\in I_{b}\}" class="ltx_Math" display="inline" id="S3.SS3.p3.2.m2.2"><semantics id="S3.SS3.p3.2.m2.2a"><mrow id="S3.SS3.p3.2.m2.2.2.1" xref="S3.SS3.p3.2.m2.2.2.2.cmml"><mo id="S3.SS3.p3.2.m2.2.2.1.2" stretchy="false" xref="S3.SS3.p3.2.m2.2.2.2.1.cmml">{</mo><mi id="S3.SS3.p3.2.m2.1.1" xref="S3.SS3.p3.2.m2.1.1.cmml">i</mi><mo fence="true" id="S3.SS3.p3.2.m2.2.2.1.3" lspace="0em" rspace="0em" xref="S3.SS3.p3.2.m2.2.2.2.1.cmml">∣</mo><mrow id="S3.SS3.p3.2.m2.2.2.1.1" xref="S3.SS3.p3.2.m2.2.2.1.1.cmml"><mrow id="S3.SS3.p3.2.m2.2.2.1.1.1" xref="S3.SS3.p3.2.m2.2.2.1.1.1.cmml"><msub id="S3.SS3.p3.2.m2.2.2.1.1.1.3" xref="S3.SS3.p3.2.m2.2.2.1.1.1.3.cmml"><mi id="S3.SS3.p3.2.m2.2.2.1.1.1.3.2" xref="S3.SS3.p3.2.m2.2.2.1.1.1.3.2.cmml">f</mi><mi id="S3.SS3.p3.2.m2.2.2.1.1.1.3.3" xref="S3.SS3.p3.2.m2.2.2.1.1.1.3.3.cmml">θ</mi></msub><mo id="S3.SS3.p3.2.m2.2.2.1.1.1.2" xref="S3.SS3.p3.2.m2.2.2.1.1.1.2.cmml">⁢</mo><mrow id="S3.SS3.p3.2.m2.2.2.1.1.1.1.1" xref="S3.SS3.p3.2.m2.2.2.1.1.1.1.1.1.cmml"><mo id="S3.SS3.p3.2.m2.2.2.1.1.1.1.1.2" stretchy="false" xref="S3.SS3.p3.2.m2.2.2.1.1.1.1.1.1.cmml">(</mo><msub id="S3.SS3.p3.2.m2.2.2.1.1.1.1.1.1" xref="S3.SS3.p3.2.m2.2.2.1.1.1.1.1.1.cmml"><mi id="S3.SS3.p3.2.m2.2.2.1.1.1.1.1.1.2" xref="S3.SS3.p3.2.m2.2.2.1.1.1.1.1.1.2.cmml">x</mi><mi id="S3.SS3.p3.2.m2.2.2.1.1.1.1.1.1.3" xref="S3.SS3.p3.2.m2.2.2.1.1.1.1.1.1.3.cmml">i</mi></msub><mo id="S3.SS3.p3.2.m2.2.2.1.1.1.1.1.3" stretchy="false" xref="S3.SS3.p3.2.m2.2.2.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S3.SS3.p3.2.m2.2.2.1.1.2" xref="S3.SS3.p3.2.m2.2.2.1.1.2.cmml">∈</mo><msub id="S3.SS3.p3.2.m2.2.2.1.1.3" xref="S3.SS3.p3.2.m2.2.2.1.1.3.cmml"><mi id="S3.SS3.p3.2.m2.2.2.1.1.3.2" xref="S3.SS3.p3.2.m2.2.2.1.1.3.2.cmml">I</mi><mi id="S3.SS3.p3.2.m2.2.2.1.1.3.3" xref="S3.SS3.p3.2.m2.2.2.1.1.3.3.cmml">b</mi></msub></mrow><mo id="S3.SS3.p3.2.m2.2.2.1.4" stretchy="false" xref="S3.SS3.p3.2.m2.2.2.2.1.cmml">}</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.p3.2.m2.2b"><apply id="S3.SS3.p3.2.m2.2.2.2.cmml" xref="S3.SS3.p3.2.m2.2.2.1"><csymbol cd="latexml" id="S3.SS3.p3.2.m2.2.2.2.1.cmml" xref="S3.SS3.p3.2.m2.2.2.1.2">conditional-set</csymbol><ci id="S3.SS3.p3.2.m2.1.1.cmml" xref="S3.SS3.p3.2.m2.1.1">𝑖</ci><apply id="S3.SS3.p3.2.m2.2.2.1.1.cmml" xref="S3.SS3.p3.2.m2.2.2.1.1"><in id="S3.SS3.p3.2.m2.2.2.1.1.2.cmml" xref="S3.SS3.p3.2.m2.2.2.1.1.2"></in><apply id="S3.SS3.p3.2.m2.2.2.1.1.1.cmml" xref="S3.SS3.p3.2.m2.2.2.1.1.1"><times id="S3.SS3.p3.2.m2.2.2.1.1.1.2.cmml" xref="S3.SS3.p3.2.m2.2.2.1.1.1.2"></times><apply id="S3.SS3.p3.2.m2.2.2.1.1.1.3.cmml" xref="S3.SS3.p3.2.m2.2.2.1.1.1.3"><csymbol cd="ambiguous" id="S3.SS3.p3.2.m2.2.2.1.1.1.3.1.cmml" xref="S3.SS3.p3.2.m2.2.2.1.1.1.3">subscript</csymbol><ci id="S3.SS3.p3.2.m2.2.2.1.1.1.3.2.cmml" xref="S3.SS3.p3.2.m2.2.2.1.1.1.3.2">𝑓</ci><ci id="S3.SS3.p3.2.m2.2.2.1.1.1.3.3.cmml" xref="S3.SS3.p3.2.m2.2.2.1.1.1.3.3">𝜃</ci></apply><apply id="S3.SS3.p3.2.m2.2.2.1.1.1.1.1.1.cmml" xref="S3.SS3.p3.2.m2.2.2.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS3.p3.2.m2.2.2.1.1.1.1.1.1.1.cmml" xref="S3.SS3.p3.2.m2.2.2.1.1.1.1.1">subscript</csymbol><ci id="S3.SS3.p3.2.m2.2.2.1.1.1.1.1.1.2.cmml" xref="S3.SS3.p3.2.m2.2.2.1.1.1.1.1.1.2">𝑥</ci><ci id="S3.SS3.p3.2.m2.2.2.1.1.1.1.1.1.3.cmml" xref="S3.SS3.p3.2.m2.2.2.1.1.1.1.1.1.3">𝑖</ci></apply></apply><apply id="S3.SS3.p3.2.m2.2.2.1.1.3.cmml" xref="S3.SS3.p3.2.m2.2.2.1.1.3"><csymbol cd="ambiguous" id="S3.SS3.p3.2.m2.2.2.1.1.3.1.cmml" xref="S3.SS3.p3.2.m2.2.2.1.1.3">subscript</csymbol><ci id="S3.SS3.p3.2.m2.2.2.1.1.3.2.cmml" xref="S3.SS3.p3.2.m2.2.2.1.1.3.2">𝐼</ci><ci id="S3.SS3.p3.2.m2.2.2.1.1.3.3.cmml" xref="S3.SS3.p3.2.m2.2.2.1.1.3.3">𝑏</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p3.2.m2.2c">\{i\mid f_{\theta}(x_{i})\in I_{b}\}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p3.2.m2.2d">{ italic_i ∣ italic_f start_POSTSUBSCRIPT italic_θ end_POSTSUBSCRIPT ( italic_x start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT ) ∈ italic_I start_POSTSUBSCRIPT italic_b end_POSTSUBSCRIPT }</annotation></semantics></math></p>
</div>
<div class="ltx_para" id="S3.SS3.p4">
<table class="ltx_equation ltx_eqn_table" id="S3.E5">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\text{ECE}=\frac{1}{B}\sum_{b=1}^{B}\left|p_{\text{emp}}^{(b)}-q^{(b)}\right|" class="ltx_Math" display="block" id="S3.E5.m1.3"><semantics id="S3.E5.m1.3a"><mrow id="S3.E5.m1.3.3" xref="S3.E5.m1.3.3.cmml"><mtext id="S3.E5.m1.3.3.3" xref="S3.E5.m1.3.3.3a.cmml">ECE</mtext><mo id="S3.E5.m1.3.3.2" xref="S3.E5.m1.3.3.2.cmml">=</mo><mrow id="S3.E5.m1.3.3.1" xref="S3.E5.m1.3.3.1.cmml"><mfrac id="S3.E5.m1.3.3.1.3" xref="S3.E5.m1.3.3.1.3.cmml"><mn id="S3.E5.m1.3.3.1.3.2" xref="S3.E5.m1.3.3.1.3.2.cmml">1</mn><mi id="S3.E5.m1.3.3.1.3.3" xref="S3.E5.m1.3.3.1.3.3.cmml">B</mi></mfrac><mo id="S3.E5.m1.3.3.1.2" xref="S3.E5.m1.3.3.1.2.cmml">⁢</mo><mrow id="S3.E5.m1.3.3.1.1" xref="S3.E5.m1.3.3.1.1.cmml"><munderover id="S3.E5.m1.3.3.1.1.2" xref="S3.E5.m1.3.3.1.1.2.cmml"><mo id="S3.E5.m1.3.3.1.1.2.2.2" movablelimits="false" rspace="0em" xref="S3.E5.m1.3.3.1.1.2.2.2.cmml">∑</mo><mrow id="S3.E5.m1.3.3.1.1.2.2.3" xref="S3.E5.m1.3.3.1.1.2.2.3.cmml"><mi id="S3.E5.m1.3.3.1.1.2.2.3.2" xref="S3.E5.m1.3.3.1.1.2.2.3.2.cmml">b</mi><mo id="S3.E5.m1.3.3.1.1.2.2.3.1" xref="S3.E5.m1.3.3.1.1.2.2.3.1.cmml">=</mo><mn id="S3.E5.m1.3.3.1.1.2.2.3.3" xref="S3.E5.m1.3.3.1.1.2.2.3.3.cmml">1</mn></mrow><mi id="S3.E5.m1.3.3.1.1.2.3" xref="S3.E5.m1.3.3.1.1.2.3.cmml">B</mi></munderover><mrow id="S3.E5.m1.3.3.1.1.1.1" xref="S3.E5.m1.3.3.1.1.1.2.cmml"><mo id="S3.E5.m1.3.3.1.1.1.1.2" xref="S3.E5.m1.3.3.1.1.1.2.1.cmml">|</mo><mrow id="S3.E5.m1.3.3.1.1.1.1.1" xref="S3.E5.m1.3.3.1.1.1.1.1.cmml"><msubsup id="S3.E5.m1.3.3.1.1.1.1.1.2" xref="S3.E5.m1.3.3.1.1.1.1.1.2.cmml"><mi id="S3.E5.m1.3.3.1.1.1.1.1.2.2.2" xref="S3.E5.m1.3.3.1.1.1.1.1.2.2.2.cmml">p</mi><mtext id="S3.E5.m1.3.3.1.1.1.1.1.2.2.3" xref="S3.E5.m1.3.3.1.1.1.1.1.2.2.3a.cmml">emp</mtext><mrow id="S3.E5.m1.1.1.1.3" xref="S3.E5.m1.3.3.1.1.1.1.1.2.cmml"><mo id="S3.E5.m1.1.1.1.3.1" stretchy="false" xref="S3.E5.m1.3.3.1.1.1.1.1.2.cmml">(</mo><mi id="S3.E5.m1.1.1.1.1" xref="S3.E5.m1.1.1.1.1.cmml">b</mi><mo id="S3.E5.m1.1.1.1.3.2" stretchy="false" xref="S3.E5.m1.3.3.1.1.1.1.1.2.cmml">)</mo></mrow></msubsup><mo id="S3.E5.m1.3.3.1.1.1.1.1.1" xref="S3.E5.m1.3.3.1.1.1.1.1.1.cmml">−</mo><msup id="S3.E5.m1.3.3.1.1.1.1.1.3" xref="S3.E5.m1.3.3.1.1.1.1.1.3.cmml"><mi id="S3.E5.m1.3.3.1.1.1.1.1.3.2" xref="S3.E5.m1.3.3.1.1.1.1.1.3.2.cmml">q</mi><mrow id="S3.E5.m1.2.2.1.3" xref="S3.E5.m1.3.3.1.1.1.1.1.3.cmml"><mo id="S3.E5.m1.2.2.1.3.1" stretchy="false" xref="S3.E5.m1.3.3.1.1.1.1.1.3.cmml">(</mo><mi id="S3.E5.m1.2.2.1.1" xref="S3.E5.m1.2.2.1.1.cmml">b</mi><mo id="S3.E5.m1.2.2.1.3.2" stretchy="false" xref="S3.E5.m1.3.3.1.1.1.1.1.3.cmml">)</mo></mrow></msup></mrow><mo id="S3.E5.m1.3.3.1.1.1.1.3" xref="S3.E5.m1.3.3.1.1.1.2.1.cmml">|</mo></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.E5.m1.3b"><apply id="S3.E5.m1.3.3.cmml" xref="S3.E5.m1.3.3"><eq id="S3.E5.m1.3.3.2.cmml" xref="S3.E5.m1.3.3.2"></eq><ci id="S3.E5.m1.3.3.3a.cmml" xref="S3.E5.m1.3.3.3"><mtext id="S3.E5.m1.3.3.3.cmml" xref="S3.E5.m1.3.3.3">ECE</mtext></ci><apply id="S3.E5.m1.3.3.1.cmml" xref="S3.E5.m1.3.3.1"><times id="S3.E5.m1.3.3.1.2.cmml" xref="S3.E5.m1.3.3.1.2"></times><apply id="S3.E5.m1.3.3.1.3.cmml" xref="S3.E5.m1.3.3.1.3"><divide id="S3.E5.m1.3.3.1.3.1.cmml" xref="S3.E5.m1.3.3.1.3"></divide><cn id="S3.E5.m1.3.3.1.3.2.cmml" type="integer" xref="S3.E5.m1.3.3.1.3.2">1</cn><ci id="S3.E5.m1.3.3.1.3.3.cmml" xref="S3.E5.m1.3.3.1.3.3">𝐵</ci></apply><apply id="S3.E5.m1.3.3.1.1.cmml" xref="S3.E5.m1.3.3.1.1"><apply id="S3.E5.m1.3.3.1.1.2.cmml" xref="S3.E5.m1.3.3.1.1.2"><csymbol cd="ambiguous" id="S3.E5.m1.3.3.1.1.2.1.cmml" xref="S3.E5.m1.3.3.1.1.2">superscript</csymbol><apply id="S3.E5.m1.3.3.1.1.2.2.cmml" xref="S3.E5.m1.3.3.1.1.2"><csymbol cd="ambiguous" id="S3.E5.m1.3.3.1.1.2.2.1.cmml" xref="S3.E5.m1.3.3.1.1.2">subscript</csymbol><sum id="S3.E5.m1.3.3.1.1.2.2.2.cmml" xref="S3.E5.m1.3.3.1.1.2.2.2"></sum><apply id="S3.E5.m1.3.3.1.1.2.2.3.cmml" xref="S3.E5.m1.3.3.1.1.2.2.3"><eq id="S3.E5.m1.3.3.1.1.2.2.3.1.cmml" xref="S3.E5.m1.3.3.1.1.2.2.3.1"></eq><ci id="S3.E5.m1.3.3.1.1.2.2.3.2.cmml" xref="S3.E5.m1.3.3.1.1.2.2.3.2">𝑏</ci><cn id="S3.E5.m1.3.3.1.1.2.2.3.3.cmml" type="integer" xref="S3.E5.m1.3.3.1.1.2.2.3.3">1</cn></apply></apply><ci id="S3.E5.m1.3.3.1.1.2.3.cmml" xref="S3.E5.m1.3.3.1.1.2.3">𝐵</ci></apply><apply id="S3.E5.m1.3.3.1.1.1.2.cmml" xref="S3.E5.m1.3.3.1.1.1.1"><abs id="S3.E5.m1.3.3.1.1.1.2.1.cmml" xref="S3.E5.m1.3.3.1.1.1.1.2"></abs><apply id="S3.E5.m1.3.3.1.1.1.1.1.cmml" xref="S3.E5.m1.3.3.1.1.1.1.1"><minus id="S3.E5.m1.3.3.1.1.1.1.1.1.cmml" xref="S3.E5.m1.3.3.1.1.1.1.1.1"></minus><apply id="S3.E5.m1.3.3.1.1.1.1.1.2.cmml" xref="S3.E5.m1.3.3.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.E5.m1.3.3.1.1.1.1.1.2.1.cmml" xref="S3.E5.m1.3.3.1.1.1.1.1.2">superscript</csymbol><apply id="S3.E5.m1.3.3.1.1.1.1.1.2.2.cmml" xref="S3.E5.m1.3.3.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.E5.m1.3.3.1.1.1.1.1.2.2.1.cmml" xref="S3.E5.m1.3.3.1.1.1.1.1.2">subscript</csymbol><ci id="S3.E5.m1.3.3.1.1.1.1.1.2.2.2.cmml" xref="S3.E5.m1.3.3.1.1.1.1.1.2.2.2">𝑝</ci><ci id="S3.E5.m1.3.3.1.1.1.1.1.2.2.3a.cmml" xref="S3.E5.m1.3.3.1.1.1.1.1.2.2.3"><mtext id="S3.E5.m1.3.3.1.1.1.1.1.2.2.3.cmml" mathsize="70%" xref="S3.E5.m1.3.3.1.1.1.1.1.2.2.3">emp</mtext></ci></apply><ci id="S3.E5.m1.1.1.1.1.cmml" xref="S3.E5.m1.1.1.1.1">𝑏</ci></apply><apply id="S3.E5.m1.3.3.1.1.1.1.1.3.cmml" xref="S3.E5.m1.3.3.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.E5.m1.3.3.1.1.1.1.1.3.1.cmml" xref="S3.E5.m1.3.3.1.1.1.1.1.3">superscript</csymbol><ci id="S3.E5.m1.3.3.1.1.1.1.1.3.2.cmml" xref="S3.E5.m1.3.3.1.1.1.1.1.3.2">𝑞</ci><ci id="S3.E5.m1.2.2.1.1.cmml" xref="S3.E5.m1.2.2.1.1">𝑏</ci></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E5.m1.3c">\text{ECE}=\frac{1}{B}\sum_{b=1}^{B}\left|p_{\text{emp}}^{(b)}-q^{(b)}\right|</annotation><annotation encoding="application/x-llamapun" id="S3.E5.m1.3d">ECE = divide start_ARG 1 end_ARG start_ARG italic_B end_ARG ∑ start_POSTSUBSCRIPT italic_b = 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_B end_POSTSUPERSCRIPT | italic_p start_POSTSUBSCRIPT emp end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ( italic_b ) end_POSTSUPERSCRIPT - italic_q start_POSTSUPERSCRIPT ( italic_b ) end_POSTSUPERSCRIPT |</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(5)</span></td>
</tr></tbody>
</table>
</div>
<div class="ltx_para" id="S3.SS3.p5">
<p class="ltx_p" id="S3.SS3.p5.5">Another important metric for quantifying uncertainty is the Brier score, which measures the mean squared difference between the predicted probabilities and the actual outcomes and provides a single score that summarizes the accuracy of probabilistic predictions.</p>
<table class="ltx_equation ltx_eqn_table" id="S3.E6">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\text{Brier}=\frac{1}{N}\sum_{i=1}^{N}(f_{\theta}(x_{i})-y_{i})^{2}" class="ltx_Math" display="block" id="S3.E6.m1.1"><semantics id="S3.E6.m1.1a"><mrow id="S3.E6.m1.1.1" xref="S3.E6.m1.1.1.cmml"><mtext id="S3.E6.m1.1.1.3" xref="S3.E6.m1.1.1.3a.cmml">Brier</mtext><mo id="S3.E6.m1.1.1.2" xref="S3.E6.m1.1.1.2.cmml">=</mo><mrow id="S3.E6.m1.1.1.1" xref="S3.E6.m1.1.1.1.cmml"><mfrac id="S3.E6.m1.1.1.1.3" xref="S3.E6.m1.1.1.1.3.cmml"><mn id="S3.E6.m1.1.1.1.3.2" xref="S3.E6.m1.1.1.1.3.2.cmml">1</mn><mi id="S3.E6.m1.1.1.1.3.3" xref="S3.E6.m1.1.1.1.3.3.cmml">N</mi></mfrac><mo id="S3.E6.m1.1.1.1.2" xref="S3.E6.m1.1.1.1.2.cmml">⁢</mo><mrow id="S3.E6.m1.1.1.1.1" xref="S3.E6.m1.1.1.1.1.cmml"><munderover id="S3.E6.m1.1.1.1.1.2" xref="S3.E6.m1.1.1.1.1.2.cmml"><mo id="S3.E6.m1.1.1.1.1.2.2.2" movablelimits="false" rspace="0em" xref="S3.E6.m1.1.1.1.1.2.2.2.cmml">∑</mo><mrow id="S3.E6.m1.1.1.1.1.2.2.3" xref="S3.E6.m1.1.1.1.1.2.2.3.cmml"><mi id="S3.E6.m1.1.1.1.1.2.2.3.2" xref="S3.E6.m1.1.1.1.1.2.2.3.2.cmml">i</mi><mo id="S3.E6.m1.1.1.1.1.2.2.3.1" xref="S3.E6.m1.1.1.1.1.2.2.3.1.cmml">=</mo><mn id="S3.E6.m1.1.1.1.1.2.2.3.3" xref="S3.E6.m1.1.1.1.1.2.2.3.3.cmml">1</mn></mrow><mi id="S3.E6.m1.1.1.1.1.2.3" xref="S3.E6.m1.1.1.1.1.2.3.cmml">N</mi></munderover><msup id="S3.E6.m1.1.1.1.1.1" xref="S3.E6.m1.1.1.1.1.1.cmml"><mrow id="S3.E6.m1.1.1.1.1.1.1.1" xref="S3.E6.m1.1.1.1.1.1.1.1.1.cmml"><mo id="S3.E6.m1.1.1.1.1.1.1.1.2" stretchy="false" xref="S3.E6.m1.1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="S3.E6.m1.1.1.1.1.1.1.1.1" xref="S3.E6.m1.1.1.1.1.1.1.1.1.cmml"><mrow id="S3.E6.m1.1.1.1.1.1.1.1.1.1" xref="S3.E6.m1.1.1.1.1.1.1.1.1.1.cmml"><msub id="S3.E6.m1.1.1.1.1.1.1.1.1.1.3" xref="S3.E6.m1.1.1.1.1.1.1.1.1.1.3.cmml"><mi id="S3.E6.m1.1.1.1.1.1.1.1.1.1.3.2" xref="S3.E6.m1.1.1.1.1.1.1.1.1.1.3.2.cmml">f</mi><mi id="S3.E6.m1.1.1.1.1.1.1.1.1.1.3.3" xref="S3.E6.m1.1.1.1.1.1.1.1.1.1.3.3.cmml">θ</mi></msub><mo id="S3.E6.m1.1.1.1.1.1.1.1.1.1.2" xref="S3.E6.m1.1.1.1.1.1.1.1.1.1.2.cmml">⁢</mo><mrow id="S3.E6.m1.1.1.1.1.1.1.1.1.1.1.1" xref="S3.E6.m1.1.1.1.1.1.1.1.1.1.1.1.1.cmml"><mo id="S3.E6.m1.1.1.1.1.1.1.1.1.1.1.1.2" stretchy="false" xref="S3.E6.m1.1.1.1.1.1.1.1.1.1.1.1.1.cmml">(</mo><msub id="S3.E6.m1.1.1.1.1.1.1.1.1.1.1.1.1" xref="S3.E6.m1.1.1.1.1.1.1.1.1.1.1.1.1.cmml"><mi id="S3.E6.m1.1.1.1.1.1.1.1.1.1.1.1.1.2" xref="S3.E6.m1.1.1.1.1.1.1.1.1.1.1.1.1.2.cmml">x</mi><mi id="S3.E6.m1.1.1.1.1.1.1.1.1.1.1.1.1.3" xref="S3.E6.m1.1.1.1.1.1.1.1.1.1.1.1.1.3.cmml">i</mi></msub><mo id="S3.E6.m1.1.1.1.1.1.1.1.1.1.1.1.3" stretchy="false" xref="S3.E6.m1.1.1.1.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S3.E6.m1.1.1.1.1.1.1.1.1.2" xref="S3.E6.m1.1.1.1.1.1.1.1.1.2.cmml">−</mo><msub id="S3.E6.m1.1.1.1.1.1.1.1.1.3" xref="S3.E6.m1.1.1.1.1.1.1.1.1.3.cmml"><mi id="S3.E6.m1.1.1.1.1.1.1.1.1.3.2" xref="S3.E6.m1.1.1.1.1.1.1.1.1.3.2.cmml">y</mi><mi id="S3.E6.m1.1.1.1.1.1.1.1.1.3.3" xref="S3.E6.m1.1.1.1.1.1.1.1.1.3.3.cmml">i</mi></msub></mrow><mo id="S3.E6.m1.1.1.1.1.1.1.1.3" stretchy="false" xref="S3.E6.m1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow><mn id="S3.E6.m1.1.1.1.1.1.3" xref="S3.E6.m1.1.1.1.1.1.3.cmml">2</mn></msup></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.E6.m1.1b"><apply id="S3.E6.m1.1.1.cmml" xref="S3.E6.m1.1.1"><eq id="S3.E6.m1.1.1.2.cmml" xref="S3.E6.m1.1.1.2"></eq><ci id="S3.E6.m1.1.1.3a.cmml" xref="S3.E6.m1.1.1.3"><mtext id="S3.E6.m1.1.1.3.cmml" xref="S3.E6.m1.1.1.3">Brier</mtext></ci><apply id="S3.E6.m1.1.1.1.cmml" xref="S3.E6.m1.1.1.1"><times id="S3.E6.m1.1.1.1.2.cmml" xref="S3.E6.m1.1.1.1.2"></times><apply id="S3.E6.m1.1.1.1.3.cmml" xref="S3.E6.m1.1.1.1.3"><divide id="S3.E6.m1.1.1.1.3.1.cmml" xref="S3.E6.m1.1.1.1.3"></divide><cn id="S3.E6.m1.1.1.1.3.2.cmml" type="integer" xref="S3.E6.m1.1.1.1.3.2">1</cn><ci id="S3.E6.m1.1.1.1.3.3.cmml" xref="S3.E6.m1.1.1.1.3.3">𝑁</ci></apply><apply id="S3.E6.m1.1.1.1.1.cmml" xref="S3.E6.m1.1.1.1.1"><apply id="S3.E6.m1.1.1.1.1.2.cmml" xref="S3.E6.m1.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.E6.m1.1.1.1.1.2.1.cmml" xref="S3.E6.m1.1.1.1.1.2">superscript</csymbol><apply id="S3.E6.m1.1.1.1.1.2.2.cmml" xref="S3.E6.m1.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.E6.m1.1.1.1.1.2.2.1.cmml" xref="S3.E6.m1.1.1.1.1.2">subscript</csymbol><sum id="S3.E6.m1.1.1.1.1.2.2.2.cmml" xref="S3.E6.m1.1.1.1.1.2.2.2"></sum><apply id="S3.E6.m1.1.1.1.1.2.2.3.cmml" xref="S3.E6.m1.1.1.1.1.2.2.3"><eq id="S3.E6.m1.1.1.1.1.2.2.3.1.cmml" xref="S3.E6.m1.1.1.1.1.2.2.3.1"></eq><ci id="S3.E6.m1.1.1.1.1.2.2.3.2.cmml" xref="S3.E6.m1.1.1.1.1.2.2.3.2">𝑖</ci><cn id="S3.E6.m1.1.1.1.1.2.2.3.3.cmml" type="integer" xref="S3.E6.m1.1.1.1.1.2.2.3.3">1</cn></apply></apply><ci id="S3.E6.m1.1.1.1.1.2.3.cmml" xref="S3.E6.m1.1.1.1.1.2.3">𝑁</ci></apply><apply id="S3.E6.m1.1.1.1.1.1.cmml" xref="S3.E6.m1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E6.m1.1.1.1.1.1.2.cmml" xref="S3.E6.m1.1.1.1.1.1">superscript</csymbol><apply id="S3.E6.m1.1.1.1.1.1.1.1.1.cmml" xref="S3.E6.m1.1.1.1.1.1.1.1"><minus id="S3.E6.m1.1.1.1.1.1.1.1.1.2.cmml" xref="S3.E6.m1.1.1.1.1.1.1.1.1.2"></minus><apply id="S3.E6.m1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E6.m1.1.1.1.1.1.1.1.1.1"><times id="S3.E6.m1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S3.E6.m1.1.1.1.1.1.1.1.1.1.2"></times><apply id="S3.E6.m1.1.1.1.1.1.1.1.1.1.3.cmml" xref="S3.E6.m1.1.1.1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.E6.m1.1.1.1.1.1.1.1.1.1.3.1.cmml" xref="S3.E6.m1.1.1.1.1.1.1.1.1.1.3">subscript</csymbol><ci id="S3.E6.m1.1.1.1.1.1.1.1.1.1.3.2.cmml" xref="S3.E6.m1.1.1.1.1.1.1.1.1.1.3.2">𝑓</ci><ci id="S3.E6.m1.1.1.1.1.1.1.1.1.1.3.3.cmml" xref="S3.E6.m1.1.1.1.1.1.1.1.1.1.3.3">𝜃</ci></apply><apply id="S3.E6.m1.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E6.m1.1.1.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E6.m1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E6.m1.1.1.1.1.1.1.1.1.1.1.1">subscript</csymbol><ci id="S3.E6.m1.1.1.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S3.E6.m1.1.1.1.1.1.1.1.1.1.1.1.1.2">𝑥</ci><ci id="S3.E6.m1.1.1.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="S3.E6.m1.1.1.1.1.1.1.1.1.1.1.1.1.3">𝑖</ci></apply></apply><apply id="S3.E6.m1.1.1.1.1.1.1.1.1.3.cmml" xref="S3.E6.m1.1.1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.E6.m1.1.1.1.1.1.1.1.1.3.1.cmml" xref="S3.E6.m1.1.1.1.1.1.1.1.1.3">subscript</csymbol><ci id="S3.E6.m1.1.1.1.1.1.1.1.1.3.2.cmml" xref="S3.E6.m1.1.1.1.1.1.1.1.1.3.2">𝑦</ci><ci id="S3.E6.m1.1.1.1.1.1.1.1.1.3.3.cmml" xref="S3.E6.m1.1.1.1.1.1.1.1.1.3.3">𝑖</ci></apply></apply><cn id="S3.E6.m1.1.1.1.1.1.3.cmml" type="integer" xref="S3.E6.m1.1.1.1.1.1.3">2</cn></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E6.m1.1c">\text{Brier}=\frac{1}{N}\sum_{i=1}^{N}(f_{\theta}(x_{i})-y_{i})^{2}</annotation><annotation encoding="application/x-llamapun" id="S3.E6.m1.1d">Brier = divide start_ARG 1 end_ARG start_ARG italic_N end_ARG ∑ start_POSTSUBSCRIPT italic_i = 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_N end_POSTSUPERSCRIPT ( italic_f start_POSTSUBSCRIPT italic_θ end_POSTSUBSCRIPT ( italic_x start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT ) - italic_y start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT ) start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(6)</span></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S3.SS3.p5.4">where <math alttext="N" class="ltx_Math" display="inline" id="S3.SS3.p5.1.m1.1"><semantics id="S3.SS3.p5.1.m1.1a"><mi id="S3.SS3.p5.1.m1.1.1" xref="S3.SS3.p5.1.m1.1.1.cmml">N</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.p5.1.m1.1b"><ci id="S3.SS3.p5.1.m1.1.1.cmml" xref="S3.SS3.p5.1.m1.1.1">𝑁</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p5.1.m1.1c">N</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p5.1.m1.1d">italic_N</annotation></semantics></math> is the number of predictions, <math alttext="f_{\theta}(x_{i})" class="ltx_Math" display="inline" id="S3.SS3.p5.2.m2.1"><semantics id="S3.SS3.p5.2.m2.1a"><mrow id="S3.SS3.p5.2.m2.1.1" xref="S3.SS3.p5.2.m2.1.1.cmml"><msub id="S3.SS3.p5.2.m2.1.1.3" xref="S3.SS3.p5.2.m2.1.1.3.cmml"><mi id="S3.SS3.p5.2.m2.1.1.3.2" xref="S3.SS3.p5.2.m2.1.1.3.2.cmml">f</mi><mi id="S3.SS3.p5.2.m2.1.1.3.3" xref="S3.SS3.p5.2.m2.1.1.3.3.cmml">θ</mi></msub><mo id="S3.SS3.p5.2.m2.1.1.2" xref="S3.SS3.p5.2.m2.1.1.2.cmml">⁢</mo><mrow id="S3.SS3.p5.2.m2.1.1.1.1" xref="S3.SS3.p5.2.m2.1.1.1.1.1.cmml"><mo id="S3.SS3.p5.2.m2.1.1.1.1.2" stretchy="false" xref="S3.SS3.p5.2.m2.1.1.1.1.1.cmml">(</mo><msub id="S3.SS3.p5.2.m2.1.1.1.1.1" xref="S3.SS3.p5.2.m2.1.1.1.1.1.cmml"><mi id="S3.SS3.p5.2.m2.1.1.1.1.1.2" xref="S3.SS3.p5.2.m2.1.1.1.1.1.2.cmml">x</mi><mi id="S3.SS3.p5.2.m2.1.1.1.1.1.3" xref="S3.SS3.p5.2.m2.1.1.1.1.1.3.cmml">i</mi></msub><mo id="S3.SS3.p5.2.m2.1.1.1.1.3" stretchy="false" xref="S3.SS3.p5.2.m2.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.p5.2.m2.1b"><apply id="S3.SS3.p5.2.m2.1.1.cmml" xref="S3.SS3.p5.2.m2.1.1"><times id="S3.SS3.p5.2.m2.1.1.2.cmml" xref="S3.SS3.p5.2.m2.1.1.2"></times><apply id="S3.SS3.p5.2.m2.1.1.3.cmml" xref="S3.SS3.p5.2.m2.1.1.3"><csymbol cd="ambiguous" id="S3.SS3.p5.2.m2.1.1.3.1.cmml" xref="S3.SS3.p5.2.m2.1.1.3">subscript</csymbol><ci id="S3.SS3.p5.2.m2.1.1.3.2.cmml" xref="S3.SS3.p5.2.m2.1.1.3.2">𝑓</ci><ci id="S3.SS3.p5.2.m2.1.1.3.3.cmml" xref="S3.SS3.p5.2.m2.1.1.3.3">𝜃</ci></apply><apply id="S3.SS3.p5.2.m2.1.1.1.1.1.cmml" xref="S3.SS3.p5.2.m2.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS3.p5.2.m2.1.1.1.1.1.1.cmml" xref="S3.SS3.p5.2.m2.1.1.1.1">subscript</csymbol><ci id="S3.SS3.p5.2.m2.1.1.1.1.1.2.cmml" xref="S3.SS3.p5.2.m2.1.1.1.1.1.2">𝑥</ci><ci id="S3.SS3.p5.2.m2.1.1.1.1.1.3.cmml" xref="S3.SS3.p5.2.m2.1.1.1.1.1.3">𝑖</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p5.2.m2.1c">f_{\theta}(x_{i})</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p5.2.m2.1d">italic_f start_POSTSUBSCRIPT italic_θ end_POSTSUBSCRIPT ( italic_x start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT )</annotation></semantics></math> is the predicted probability for the <math alttext="i" class="ltx_Math" display="inline" id="S3.SS3.p5.3.m3.1"><semantics id="S3.SS3.p5.3.m3.1a"><mi id="S3.SS3.p5.3.m3.1.1" xref="S3.SS3.p5.3.m3.1.1.cmml">i</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.p5.3.m3.1b"><ci id="S3.SS3.p5.3.m3.1.1.cmml" xref="S3.SS3.p5.3.m3.1.1">𝑖</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p5.3.m3.1c">i</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p5.3.m3.1d">italic_i</annotation></semantics></math>-th pixel, and <math alttext="y_{i}" class="ltx_Math" display="inline" id="S3.SS3.p5.4.m4.1"><semantics id="S3.SS3.p5.4.m4.1a"><msub id="S3.SS3.p5.4.m4.1.1" xref="S3.SS3.p5.4.m4.1.1.cmml"><mi id="S3.SS3.p5.4.m4.1.1.2" xref="S3.SS3.p5.4.m4.1.1.2.cmml">y</mi><mi id="S3.SS3.p5.4.m4.1.1.3" xref="S3.SS3.p5.4.m4.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS3.p5.4.m4.1b"><apply id="S3.SS3.p5.4.m4.1.1.cmml" xref="S3.SS3.p5.4.m4.1.1"><csymbol cd="ambiguous" id="S3.SS3.p5.4.m4.1.1.1.cmml" xref="S3.SS3.p5.4.m4.1.1">subscript</csymbol><ci id="S3.SS3.p5.4.m4.1.1.2.cmml" xref="S3.SS3.p5.4.m4.1.1.2">𝑦</ci><ci id="S3.SS3.p5.4.m4.1.1.3.cmml" xref="S3.SS3.p5.4.m4.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p5.4.m4.1c">y_{i}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p5.4.m4.1d">italic_y start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT</annotation></semantics></math> is the actual binary outcome.A lower Brier score indicates better performance because it means that the predicted probabilities are closer to the actual results. The Brier score ranges from 0, a perfect probabilistic prediction, to 1, the worst possible deviation from the target probability.</p>
</div>
<div class="ltx_para" id="S3.SS3.p6">
<p class="ltx_p" id="S3.SS3.p6.2">Finally, the Kullback-Leibler (KL) divergence is a widely used evaluation metric in machine learning and information theory, especially for comparing probability distributions.
It measures the difference between two probability distributions and indicates how much a distribution deviates from a reference distribution.
Mathematically, the KL divergence between a distribution <math alttext="Q" class="ltx_Math" display="inline" id="S3.SS3.p6.1.m1.1"><semantics id="S3.SS3.p6.1.m1.1a"><mi id="S3.SS3.p6.1.m1.1.1" xref="S3.SS3.p6.1.m1.1.1.cmml">Q</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.p6.1.m1.1b"><ci id="S3.SS3.p6.1.m1.1.1.cmml" xref="S3.SS3.p6.1.m1.1.1">𝑄</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p6.1.m1.1c">Q</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p6.1.m1.1d">italic_Q</annotation></semantics></math> (the estimated distribution) and a distribution <math alttext="P" class="ltx_Math" display="inline" id="S3.SS3.p6.2.m2.1"><semantics id="S3.SS3.p6.2.m2.1a"><mi id="S3.SS3.p6.2.m2.1.1" xref="S3.SS3.p6.2.m2.1.1.cmml">P</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.p6.2.m2.1b"><ci id="S3.SS3.p6.2.m2.1.1.cmml" xref="S3.SS3.p6.2.m2.1.1">𝑃</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p6.2.m2.1c">P</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p6.2.m2.1d">italic_P</annotation></semantics></math> (the true distribution) is defined as follows:</p>
<table class="ltx_equation ltx_eqn_table" id="S3.E7">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="D_{\text{KL}}(P\parallel Q)=\sum_{i}P(i)\log\left(\frac{P(i)}{Q(i)}\right)" class="ltx_Math" display="block" id="S3.E7.m1.5"><semantics id="S3.E7.m1.5a"><mrow id="S3.E7.m1.5.5" xref="S3.E7.m1.5.5.cmml"><mrow id="S3.E7.m1.5.5.1" xref="S3.E7.m1.5.5.1.cmml"><msub id="S3.E7.m1.5.5.1.3" xref="S3.E7.m1.5.5.1.3.cmml"><mi id="S3.E7.m1.5.5.1.3.2" xref="S3.E7.m1.5.5.1.3.2.cmml">D</mi><mtext id="S3.E7.m1.5.5.1.3.3" xref="S3.E7.m1.5.5.1.3.3a.cmml">KL</mtext></msub><mo id="S3.E7.m1.5.5.1.2" xref="S3.E7.m1.5.5.1.2.cmml">⁢</mo><mrow id="S3.E7.m1.5.5.1.1.1" xref="S3.E7.m1.5.5.1.1.1.1.cmml"><mo id="S3.E7.m1.5.5.1.1.1.2" stretchy="false" xref="S3.E7.m1.5.5.1.1.1.1.cmml">(</mo><mrow id="S3.E7.m1.5.5.1.1.1.1" xref="S3.E7.m1.5.5.1.1.1.1.cmml"><mi id="S3.E7.m1.5.5.1.1.1.1.2" xref="S3.E7.m1.5.5.1.1.1.1.2.cmml">P</mi><mo id="S3.E7.m1.5.5.1.1.1.1.1" xref="S3.E7.m1.5.5.1.1.1.1.1.cmml">∥</mo><mi id="S3.E7.m1.5.5.1.1.1.1.3" xref="S3.E7.m1.5.5.1.1.1.1.3.cmml">Q</mi></mrow><mo id="S3.E7.m1.5.5.1.1.1.3" stretchy="false" xref="S3.E7.m1.5.5.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S3.E7.m1.5.5.2" rspace="0.111em" xref="S3.E7.m1.5.5.2.cmml">=</mo><mrow id="S3.E7.m1.5.5.3" xref="S3.E7.m1.5.5.3.cmml"><munder id="S3.E7.m1.5.5.3.1" xref="S3.E7.m1.5.5.3.1.cmml"><mo id="S3.E7.m1.5.5.3.1.2" movablelimits="false" xref="S3.E7.m1.5.5.3.1.2.cmml">∑</mo><mi id="S3.E7.m1.5.5.3.1.3" xref="S3.E7.m1.5.5.3.1.3.cmml">i</mi></munder><mrow id="S3.E7.m1.5.5.3.2" xref="S3.E7.m1.5.5.3.2.cmml"><mi id="S3.E7.m1.5.5.3.2.2" xref="S3.E7.m1.5.5.3.2.2.cmml">P</mi><mo id="S3.E7.m1.5.5.3.2.1" xref="S3.E7.m1.5.5.3.2.1.cmml">⁢</mo><mrow id="S3.E7.m1.5.5.3.2.3.2" xref="S3.E7.m1.5.5.3.2.cmml"><mo id="S3.E7.m1.5.5.3.2.3.2.1" stretchy="false" xref="S3.E7.m1.5.5.3.2.cmml">(</mo><mi id="S3.E7.m1.3.3" xref="S3.E7.m1.3.3.cmml">i</mi><mo id="S3.E7.m1.5.5.3.2.3.2.2" stretchy="false" xref="S3.E7.m1.5.5.3.2.cmml">)</mo></mrow><mo id="S3.E7.m1.5.5.3.2.1a" lspace="0.167em" xref="S3.E7.m1.5.5.3.2.1.cmml">⁢</mo><mrow id="S3.E7.m1.5.5.3.2.4.2" xref="S3.E7.m1.5.5.3.2.4.1.cmml"><mi id="S3.E7.m1.4.4" xref="S3.E7.m1.4.4.cmml">log</mi><mo id="S3.E7.m1.5.5.3.2.4.2a" xref="S3.E7.m1.5.5.3.2.4.1.cmml">⁡</mo><mrow id="S3.E7.m1.5.5.3.2.4.2.1" xref="S3.E7.m1.5.5.3.2.4.1.cmml"><mo id="S3.E7.m1.5.5.3.2.4.2.1.1" xref="S3.E7.m1.5.5.3.2.4.1.cmml">(</mo><mfrac id="S3.E7.m1.2.2" xref="S3.E7.m1.2.2.cmml"><mrow id="S3.E7.m1.1.1.1" xref="S3.E7.m1.1.1.1.cmml"><mi id="S3.E7.m1.1.1.1.3" xref="S3.E7.m1.1.1.1.3.cmml">P</mi><mo id="S3.E7.m1.1.1.1.2" xref="S3.E7.m1.1.1.1.2.cmml">⁢</mo><mrow id="S3.E7.m1.1.1.1.4.2" xref="S3.E7.m1.1.1.1.cmml"><mo id="S3.E7.m1.1.1.1.4.2.1" stretchy="false" xref="S3.E7.m1.1.1.1.cmml">(</mo><mi id="S3.E7.m1.1.1.1.1" xref="S3.E7.m1.1.1.1.1.cmml">i</mi><mo id="S3.E7.m1.1.1.1.4.2.2" stretchy="false" xref="S3.E7.m1.1.1.1.cmml">)</mo></mrow></mrow><mrow id="S3.E7.m1.2.2.2" xref="S3.E7.m1.2.2.2.cmml"><mi id="S3.E7.m1.2.2.2.3" xref="S3.E7.m1.2.2.2.3.cmml">Q</mi><mo id="S3.E7.m1.2.2.2.2" xref="S3.E7.m1.2.2.2.2.cmml">⁢</mo><mrow id="S3.E7.m1.2.2.2.4.2" xref="S3.E7.m1.2.2.2.cmml"><mo id="S3.E7.m1.2.2.2.4.2.1" stretchy="false" xref="S3.E7.m1.2.2.2.cmml">(</mo><mi id="S3.E7.m1.2.2.2.1" xref="S3.E7.m1.2.2.2.1.cmml">i</mi><mo id="S3.E7.m1.2.2.2.4.2.2" stretchy="false" xref="S3.E7.m1.2.2.2.cmml">)</mo></mrow></mrow></mfrac><mo id="S3.E7.m1.5.5.3.2.4.2.1.2" xref="S3.E7.m1.5.5.3.2.4.1.cmml">)</mo></mrow></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.E7.m1.5b"><apply id="S3.E7.m1.5.5.cmml" xref="S3.E7.m1.5.5"><eq id="S3.E7.m1.5.5.2.cmml" xref="S3.E7.m1.5.5.2"></eq><apply id="S3.E7.m1.5.5.1.cmml" xref="S3.E7.m1.5.5.1"><times id="S3.E7.m1.5.5.1.2.cmml" xref="S3.E7.m1.5.5.1.2"></times><apply id="S3.E7.m1.5.5.1.3.cmml" xref="S3.E7.m1.5.5.1.3"><csymbol cd="ambiguous" id="S3.E7.m1.5.5.1.3.1.cmml" xref="S3.E7.m1.5.5.1.3">subscript</csymbol><ci id="S3.E7.m1.5.5.1.3.2.cmml" xref="S3.E7.m1.5.5.1.3.2">𝐷</ci><ci id="S3.E7.m1.5.5.1.3.3a.cmml" xref="S3.E7.m1.5.5.1.3.3"><mtext id="S3.E7.m1.5.5.1.3.3.cmml" mathsize="70%" xref="S3.E7.m1.5.5.1.3.3">KL</mtext></ci></apply><apply id="S3.E7.m1.5.5.1.1.1.1.cmml" xref="S3.E7.m1.5.5.1.1.1"><csymbol cd="latexml" id="S3.E7.m1.5.5.1.1.1.1.1.cmml" xref="S3.E7.m1.5.5.1.1.1.1.1">conditional</csymbol><ci id="S3.E7.m1.5.5.1.1.1.1.2.cmml" xref="S3.E7.m1.5.5.1.1.1.1.2">𝑃</ci><ci id="S3.E7.m1.5.5.1.1.1.1.3.cmml" xref="S3.E7.m1.5.5.1.1.1.1.3">𝑄</ci></apply></apply><apply id="S3.E7.m1.5.5.3.cmml" xref="S3.E7.m1.5.5.3"><apply id="S3.E7.m1.5.5.3.1.cmml" xref="S3.E7.m1.5.5.3.1"><csymbol cd="ambiguous" id="S3.E7.m1.5.5.3.1.1.cmml" xref="S3.E7.m1.5.5.3.1">subscript</csymbol><sum id="S3.E7.m1.5.5.3.1.2.cmml" xref="S3.E7.m1.5.5.3.1.2"></sum><ci id="S3.E7.m1.5.5.3.1.3.cmml" xref="S3.E7.m1.5.5.3.1.3">𝑖</ci></apply><apply id="S3.E7.m1.5.5.3.2.cmml" xref="S3.E7.m1.5.5.3.2"><times id="S3.E7.m1.5.5.3.2.1.cmml" xref="S3.E7.m1.5.5.3.2.1"></times><ci id="S3.E7.m1.5.5.3.2.2.cmml" xref="S3.E7.m1.5.5.3.2.2">𝑃</ci><ci id="S3.E7.m1.3.3.cmml" xref="S3.E7.m1.3.3">𝑖</ci><apply id="S3.E7.m1.5.5.3.2.4.1.cmml" xref="S3.E7.m1.5.5.3.2.4.2"><log id="S3.E7.m1.4.4.cmml" xref="S3.E7.m1.4.4"></log><apply id="S3.E7.m1.2.2.cmml" xref="S3.E7.m1.2.2"><divide id="S3.E7.m1.2.2.3.cmml" xref="S3.E7.m1.2.2"></divide><apply id="S3.E7.m1.1.1.1.cmml" xref="S3.E7.m1.1.1.1"><times id="S3.E7.m1.1.1.1.2.cmml" xref="S3.E7.m1.1.1.1.2"></times><ci id="S3.E7.m1.1.1.1.3.cmml" xref="S3.E7.m1.1.1.1.3">𝑃</ci><ci id="S3.E7.m1.1.1.1.1.cmml" xref="S3.E7.m1.1.1.1.1">𝑖</ci></apply><apply id="S3.E7.m1.2.2.2.cmml" xref="S3.E7.m1.2.2.2"><times id="S3.E7.m1.2.2.2.2.cmml" xref="S3.E7.m1.2.2.2.2"></times><ci id="S3.E7.m1.2.2.2.3.cmml" xref="S3.E7.m1.2.2.2.3">𝑄</ci><ci id="S3.E7.m1.2.2.2.1.cmml" xref="S3.E7.m1.2.2.2.1">𝑖</ci></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E7.m1.5c">D_{\text{KL}}(P\parallel Q)=\sum_{i}P(i)\log\left(\frac{P(i)}{Q(i)}\right)</annotation><annotation encoding="application/x-llamapun" id="S3.E7.m1.5d">italic_D start_POSTSUBSCRIPT KL end_POSTSUBSCRIPT ( italic_P ∥ italic_Q ) = ∑ start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT italic_P ( italic_i ) roman_log ( divide start_ARG italic_P ( italic_i ) end_ARG start_ARG italic_Q ( italic_i ) end_ARG )</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(7)</span></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S3.SS3.p6.5">In this formula, <math alttext="P(i)" class="ltx_Math" display="inline" id="S3.SS3.p6.3.m1.1"><semantics id="S3.SS3.p6.3.m1.1a"><mrow id="S3.SS3.p6.3.m1.1.2" xref="S3.SS3.p6.3.m1.1.2.cmml"><mi id="S3.SS3.p6.3.m1.1.2.2" xref="S3.SS3.p6.3.m1.1.2.2.cmml">P</mi><mo id="S3.SS3.p6.3.m1.1.2.1" xref="S3.SS3.p6.3.m1.1.2.1.cmml">⁢</mo><mrow id="S3.SS3.p6.3.m1.1.2.3.2" xref="S3.SS3.p6.3.m1.1.2.cmml"><mo id="S3.SS3.p6.3.m1.1.2.3.2.1" stretchy="false" xref="S3.SS3.p6.3.m1.1.2.cmml">(</mo><mi id="S3.SS3.p6.3.m1.1.1" xref="S3.SS3.p6.3.m1.1.1.cmml">i</mi><mo id="S3.SS3.p6.3.m1.1.2.3.2.2" stretchy="false" xref="S3.SS3.p6.3.m1.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.p6.3.m1.1b"><apply id="S3.SS3.p6.3.m1.1.2.cmml" xref="S3.SS3.p6.3.m1.1.2"><times id="S3.SS3.p6.3.m1.1.2.1.cmml" xref="S3.SS3.p6.3.m1.1.2.1"></times><ci id="S3.SS3.p6.3.m1.1.2.2.cmml" xref="S3.SS3.p6.3.m1.1.2.2">𝑃</ci><ci id="S3.SS3.p6.3.m1.1.1.cmml" xref="S3.SS3.p6.3.m1.1.1">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p6.3.m1.1c">P(i)</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p6.3.m1.1d">italic_P ( italic_i )</annotation></semantics></math> represents the true probability of the <math alttext="i" class="ltx_Math" display="inline" id="S3.SS3.p6.4.m2.1"><semantics id="S3.SS3.p6.4.m2.1a"><mi id="S3.SS3.p6.4.m2.1.1" xref="S3.SS3.p6.4.m2.1.1.cmml">i</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.p6.4.m2.1b"><ci id="S3.SS3.p6.4.m2.1.1.cmml" xref="S3.SS3.p6.4.m2.1.1">𝑖</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p6.4.m2.1c">i</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p6.4.m2.1d">italic_i</annotation></semantics></math>-th event, and <math alttext="Q(i)" class="ltx_Math" display="inline" id="S3.SS3.p6.5.m3.1"><semantics id="S3.SS3.p6.5.m3.1a"><mrow id="S3.SS3.p6.5.m3.1.2" xref="S3.SS3.p6.5.m3.1.2.cmml"><mi id="S3.SS3.p6.5.m3.1.2.2" xref="S3.SS3.p6.5.m3.1.2.2.cmml">Q</mi><mo id="S3.SS3.p6.5.m3.1.2.1" xref="S3.SS3.p6.5.m3.1.2.1.cmml">⁢</mo><mrow id="S3.SS3.p6.5.m3.1.2.3.2" xref="S3.SS3.p6.5.m3.1.2.cmml"><mo id="S3.SS3.p6.5.m3.1.2.3.2.1" stretchy="false" xref="S3.SS3.p6.5.m3.1.2.cmml">(</mo><mi id="S3.SS3.p6.5.m3.1.1" xref="S3.SS3.p6.5.m3.1.1.cmml">i</mi><mo id="S3.SS3.p6.5.m3.1.2.3.2.2" stretchy="false" xref="S3.SS3.p6.5.m3.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.p6.5.m3.1b"><apply id="S3.SS3.p6.5.m3.1.2.cmml" xref="S3.SS3.p6.5.m3.1.2"><times id="S3.SS3.p6.5.m3.1.2.1.cmml" xref="S3.SS3.p6.5.m3.1.2.1"></times><ci id="S3.SS3.p6.5.m3.1.2.2.cmml" xref="S3.SS3.p6.5.m3.1.2.2">𝑄</ci><ci id="S3.SS3.p6.5.m3.1.1.cmml" xref="S3.SS3.p6.5.m3.1.1">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p6.5.m3.1c">Q(i)</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p6.5.m3.1d">italic_Q ( italic_i )</annotation></semantics></math> represents the predicted probability of the same event. KL divergence is a valuable tool for evaluating the performance of probabilistic models. Quantifying the divergence between the predicted and true distributions clearly measures how well a model captures the underlying data distribution.</p>
</div>
</section>
<section class="ltx_subsection" id="S3.SS4">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection"><span class="ltx_text" id="S3.SS4.4.1.1">III-D</span> </span><span class="ltx_text ltx_font_italic" id="S3.SS4.5.2">CaPE regularization</span>
</h3>
<div class="ltx_para" id="S3.SS4.p1">
<p class="ltx_p" id="S3.SS4.p1.4">Based on the definition from Liu et al. <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.12535v1#bib.bib1" title="">1</a>]</cite>, we introduce CaPE regularization to a segmentation pipeline, to evaluate whether it can improve the model performance.
This method is designed to improve the calibration of probabilistic models by minimizing a calibration loss alongside the traditional discrimination loss <math alttext="\mathcal{L}_{D}" class="ltx_Math" display="inline" id="S3.SS4.p1.1.m1.1"><semantics id="S3.SS4.p1.1.m1.1a"><msub id="S3.SS4.p1.1.m1.1.1" xref="S3.SS4.p1.1.m1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS4.p1.1.m1.1.1.2" xref="S3.SS4.p1.1.m1.1.1.2.cmml">ℒ</mi><mi id="S3.SS4.p1.1.m1.1.1.3" xref="S3.SS4.p1.1.m1.1.1.3.cmml">D</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS4.p1.1.m1.1b"><apply id="S3.SS4.p1.1.m1.1.1.cmml" xref="S3.SS4.p1.1.m1.1.1"><csymbol cd="ambiguous" id="S3.SS4.p1.1.m1.1.1.1.cmml" xref="S3.SS4.p1.1.m1.1.1">subscript</csymbol><ci id="S3.SS4.p1.1.m1.1.1.2.cmml" xref="S3.SS4.p1.1.m1.1.1.2">ℒ</ci><ci id="S3.SS4.p1.1.m1.1.1.3.cmml" xref="S3.SS4.p1.1.m1.1.1.3">𝐷</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p1.1.m1.1c">\mathcal{L}_{D}</annotation><annotation encoding="application/x-llamapun" id="S3.SS4.p1.1.m1.1d">caligraphic_L start_POSTSUBSCRIPT italic_D end_POSTSUBSCRIPT</annotation></semantics></math>, generally Binary Cross Entropy (BCE). CaPE strategy initially trains the model on <math alttext="\mathcal{L}_{D}" class="ltx_Math" display="inline" id="S3.SS4.p1.2.m2.1"><semantics id="S3.SS4.p1.2.m2.1a"><msub id="S3.SS4.p1.2.m2.1.1" xref="S3.SS4.p1.2.m2.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS4.p1.2.m2.1.1.2" xref="S3.SS4.p1.2.m2.1.1.2.cmml">ℒ</mi><mi id="S3.SS4.p1.2.m2.1.1.3" xref="S3.SS4.p1.2.m2.1.1.3.cmml">D</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS4.p1.2.m2.1b"><apply id="S3.SS4.p1.2.m2.1.1.cmml" xref="S3.SS4.p1.2.m2.1.1"><csymbol cd="ambiguous" id="S3.SS4.p1.2.m2.1.1.1.cmml" xref="S3.SS4.p1.2.m2.1.1">subscript</csymbol><ci id="S3.SS4.p1.2.m2.1.1.2.cmml" xref="S3.SS4.p1.2.m2.1.1.2">ℒ</ci><ci id="S3.SS4.p1.2.m2.1.1.3.cmml" xref="S3.SS4.p1.2.m2.1.1.3">𝐷</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p1.2.m2.1c">\mathcal{L}_{D}</annotation><annotation encoding="application/x-llamapun" id="S3.SS4.p1.2.m2.1d">caligraphic_L start_POSTSUBSCRIPT italic_D end_POSTSUBSCRIPT</annotation></semantics></math> with early stopping to prevent overfitting. It then employs a weighted sum approach, combining <math alttext="\mathcal{L}_{D}" class="ltx_Math" display="inline" id="S3.SS4.p1.3.m3.1"><semantics id="S3.SS4.p1.3.m3.1a"><msub id="S3.SS4.p1.3.m3.1.1" xref="S3.SS4.p1.3.m3.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS4.p1.3.m3.1.1.2" xref="S3.SS4.p1.3.m3.1.1.2.cmml">ℒ</mi><mi id="S3.SS4.p1.3.m3.1.1.3" xref="S3.SS4.p1.3.m3.1.1.3.cmml">D</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS4.p1.3.m3.1b"><apply id="S3.SS4.p1.3.m3.1.1.cmml" xref="S3.SS4.p1.3.m3.1.1"><csymbol cd="ambiguous" id="S3.SS4.p1.3.m3.1.1.1.cmml" xref="S3.SS4.p1.3.m3.1.1">subscript</csymbol><ci id="S3.SS4.p1.3.m3.1.1.2.cmml" xref="S3.SS4.p1.3.m3.1.1.2">ℒ</ci><ci id="S3.SS4.p1.3.m3.1.1.3.cmml" xref="S3.SS4.p1.3.m3.1.1.3">𝐷</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p1.3.m3.1c">\mathcal{L}_{D}</annotation><annotation encoding="application/x-llamapun" id="S3.SS4.p1.3.m3.1d">caligraphic_L start_POSTSUBSCRIPT italic_D end_POSTSUBSCRIPT</annotation></semantics></math> with an extra term <math alttext="\mathcal{L}_{C}" class="ltx_Math" display="inline" id="S3.SS4.p1.4.m4.1"><semantics id="S3.SS4.p1.4.m4.1a"><msub id="S3.SS4.p1.4.m4.1.1" xref="S3.SS4.p1.4.m4.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS4.p1.4.m4.1.1.2" xref="S3.SS4.p1.4.m4.1.1.2.cmml">ℒ</mi><mi id="S3.SS4.p1.4.m4.1.1.3" xref="S3.SS4.p1.4.m4.1.1.3.cmml">C</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS4.p1.4.m4.1b"><apply id="S3.SS4.p1.4.m4.1.1.cmml" xref="S3.SS4.p1.4.m4.1.1"><csymbol cd="ambiguous" id="S3.SS4.p1.4.m4.1.1.1.cmml" xref="S3.SS4.p1.4.m4.1.1">subscript</csymbol><ci id="S3.SS4.p1.4.m4.1.1.2.cmml" xref="S3.SS4.p1.4.m4.1.1.2">ℒ</ci><ci id="S3.SS4.p1.4.m4.1.1.3.cmml" xref="S3.SS4.p1.4.m4.1.1.3">𝐶</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p1.4.m4.1c">\mathcal{L}_{C}</annotation><annotation encoding="application/x-llamapun" id="S3.SS4.p1.4.m4.1d">caligraphic_L start_POSTSUBSCRIPT italic_C end_POSTSUBSCRIPT</annotation></semantics></math> enforcing model calibration. This second term measures the cross-entropy between the model’s predicted probabilities and the empirical probabilities conditioned on the model output.
The discrimination loss compares the predicted probability for each area with the actual label, penalizing the predictions based on the difference between the inferred probability and the true label. In contrast, the calibration loss compares the predicted probability distribution to the empirical one. This dual optimization aims to enhance both the discrimination ability and the calibration of the model, ensuring that the predicted probabilities align closely with the true likelihood of outcomes. The two loss functions are formalized as follows:</p>
</div>
<div class="ltx_para" id="S3.SS4.p2">
<table class="ltx_equation ltx_eqn_table" id="S3.E8">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\begin{split}\mathcal{L}_{\text{D}}&amp;=-\sum_{i=1}^{N}\left[y_{i}\log(f_{\theta}%
(x_{i}))+(1-y_{i})\log(1-f_{\theta}(x_{i}))\right]\\
\mathcal{L}_{\text{C}}&amp;=-\sum_{i=1}^{N}\left[p_{\text{emp}}^{i}\log\left(f_{%
\theta}(x_{i})\right)+\left(1-p_{\text{emp}}^{i}\right)\log\left(1-f_{\theta}(%
x_{i})\right)\right]\end{split}" class="ltx_Math" display="block" id="S3.E8.m1.82"><semantics id="S3.E8.m1.82a"><mtable columnspacing="0pt" displaystyle="true" id="S3.E8.m1.82.82.4" rowspacing="0pt" xref="S3.E8.m1.80.80.2.cmml"><mtr id="S3.E8.m1.82.82.4a" xref="S3.E8.m1.80.80.2.cmml"><mtd class="ltx_align_right" columnalign="right" id="S3.E8.m1.82.82.4b" xref="S3.E8.m1.80.80.2.cmml"><msub id="S3.E8.m1.2.2.2.2.2" xref="S3.E8.m1.80.80.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.E8.m1.1.1.1.1.1.1" xref="S3.E8.m1.1.1.1.1.1.1.cmml">ℒ</mi><mtext id="S3.E8.m1.2.2.2.2.2.2.1" xref="S3.E8.m1.2.2.2.2.2.2.1a.cmml">D</mtext></msub></mtd><mtd class="ltx_align_left" columnalign="left" id="S3.E8.m1.82.82.4c" xref="S3.E8.m1.80.80.2.cmml"><mrow id="S3.E8.m1.81.81.3.79.39.37" xref="S3.E8.m1.80.80.2.cmml"><mi id="S3.E8.m1.81.81.3.79.39.37.38" xref="S3.E8.m1.80.80.2a.cmml"></mi><mo id="S3.E8.m1.3.3.3.3.1.1" xref="S3.E8.m1.3.3.3.3.1.1.cmml">=</mo><mrow id="S3.E8.m1.81.81.3.79.39.37.37" xref="S3.E8.m1.80.80.2.cmml"><mo id="S3.E8.m1.81.81.3.79.39.37.37a" xref="S3.E8.m1.80.80.2a.cmml">−</mo><mrow id="S3.E8.m1.81.81.3.79.39.37.37.1" xref="S3.E8.m1.80.80.2.cmml"><munderover id="S3.E8.m1.81.81.3.79.39.37.37.1.2" xref="S3.E8.m1.80.80.2.cmml"><mo id="S3.E8.m1.5.5.5.5.3.3" movablelimits="false" rspace="0em" xref="S3.E8.m1.5.5.5.5.3.3.cmml">∑</mo><mrow id="S3.E8.m1.6.6.6.6.4.4.1" xref="S3.E8.m1.6.6.6.6.4.4.1.cmml"><mi id="S3.E8.m1.6.6.6.6.4.4.1.2" xref="S3.E8.m1.6.6.6.6.4.4.1.2.cmml">i</mi><mo id="S3.E8.m1.6.6.6.6.4.4.1.1" xref="S3.E8.m1.6.6.6.6.4.4.1.1.cmml">=</mo><mn id="S3.E8.m1.6.6.6.6.4.4.1.3" xref="S3.E8.m1.6.6.6.6.4.4.1.3.cmml">1</mn></mrow><mi id="S3.E8.m1.7.7.7.7.5.5.1" xref="S3.E8.m1.7.7.7.7.5.5.1.cmml">N</mi></munderover><mrow id="S3.E8.m1.81.81.3.79.39.37.37.1.1.1" xref="S3.E8.m1.80.80.2.cmml"><mo id="S3.E8.m1.8.8.8.8.6.6" xref="S3.E8.m1.80.80.2a.cmml">[</mo><mrow id="S3.E8.m1.81.81.3.79.39.37.37.1.1.1.1" xref="S3.E8.m1.80.80.2.cmml"><mrow id="S3.E8.m1.81.81.3.79.39.37.37.1.1.1.1.1" xref="S3.E8.m1.80.80.2.cmml"><msub id="S3.E8.m1.81.81.3.79.39.37.37.1.1.1.1.1.3" xref="S3.E8.m1.80.80.2.cmml"><mi id="S3.E8.m1.9.9.9.9.7.7" xref="S3.E8.m1.9.9.9.9.7.7.cmml">y</mi><mi id="S3.E8.m1.10.10.10.10.8.8.1" xref="S3.E8.m1.10.10.10.10.8.8.1.cmml">i</mi></msub><mo id="S3.E8.m1.81.81.3.79.39.37.37.1.1.1.1.1.2" lspace="0.167em" xref="S3.E8.m1.80.80.2a.cmml">⁢</mo><mrow id="S3.E8.m1.81.81.3.79.39.37.37.1.1.1.1.1.1.1" xref="S3.E8.m1.80.80.2.cmml"><mi id="S3.E8.m1.11.11.11.11.9.9" xref="S3.E8.m1.11.11.11.11.9.9.cmml">log</mi><mo id="S3.E8.m1.81.81.3.79.39.37.37.1.1.1.1.1.1.1a" xref="S3.E8.m1.80.80.2a.cmml">⁡</mo><mrow id="S3.E8.m1.81.81.3.79.39.37.37.1.1.1.1.1.1.1.1" xref="S3.E8.m1.80.80.2.cmml"><mo id="S3.E8.m1.12.12.12.12.10.10" stretchy="false" xref="S3.E8.m1.80.80.2a.cmml">(</mo><mrow id="S3.E8.m1.81.81.3.79.39.37.37.1.1.1.1.1.1.1.1.1" xref="S3.E8.m1.80.80.2.cmml"><msub id="S3.E8.m1.81.81.3.79.39.37.37.1.1.1.1.1.1.1.1.1.3" xref="S3.E8.m1.80.80.2.cmml"><mi id="S3.E8.m1.13.13.13.13.11.11" xref="S3.E8.m1.13.13.13.13.11.11.cmml">f</mi><mi id="S3.E8.m1.14.14.14.14.12.12.1" xref="S3.E8.m1.14.14.14.14.12.12.1.cmml">θ</mi></msub><mo id="S3.E8.m1.81.81.3.79.39.37.37.1.1.1.1.1.1.1.1.1.2" xref="S3.E8.m1.80.80.2a.cmml">⁢</mo><mrow id="S3.E8.m1.81.81.3.79.39.37.37.1.1.1.1.1.1.1.1.1.1.1" xref="S3.E8.m1.80.80.2.cmml"><mo id="S3.E8.m1.15.15.15.15.13.13" stretchy="false" xref="S3.E8.m1.80.80.2a.cmml">(</mo><msub id="S3.E8.m1.81.81.3.79.39.37.37.1.1.1.1.1.1.1.1.1.1.1.1" xref="S3.E8.m1.80.80.2.cmml"><mi id="S3.E8.m1.16.16.16.16.14.14" xref="S3.E8.m1.16.16.16.16.14.14.cmml">x</mi><mi id="S3.E8.m1.17.17.17.17.15.15.1" xref="S3.E8.m1.17.17.17.17.15.15.1.cmml">i</mi></msub><mo id="S3.E8.m1.18.18.18.18.16.16" stretchy="false" xref="S3.E8.m1.80.80.2a.cmml">)</mo></mrow></mrow><mo id="S3.E8.m1.19.19.19.19.17.17" stretchy="false" xref="S3.E8.m1.80.80.2a.cmml">)</mo></mrow></mrow></mrow><mo id="S3.E8.m1.20.20.20.20.18.18" xref="S3.E8.m1.20.20.20.20.18.18.cmml">+</mo><mrow id="S3.E8.m1.81.81.3.79.39.37.37.1.1.1.1.3" xref="S3.E8.m1.80.80.2.cmml"><mrow id="S3.E8.m1.81.81.3.79.39.37.37.1.1.1.1.2.1.1" xref="S3.E8.m1.80.80.2.cmml"><mo id="S3.E8.m1.21.21.21.21.19.19" stretchy="false" xref="S3.E8.m1.80.80.2a.cmml">(</mo><mrow id="S3.E8.m1.81.81.3.79.39.37.37.1.1.1.1.2.1.1.1" xref="S3.E8.m1.80.80.2.cmml"><mn id="S3.E8.m1.22.22.22.22.20.20" xref="S3.E8.m1.22.22.22.22.20.20.cmml">1</mn><mo id="S3.E8.m1.23.23.23.23.21.21" xref="S3.E8.m1.23.23.23.23.21.21.cmml">−</mo><msub id="S3.E8.m1.81.81.3.79.39.37.37.1.1.1.1.2.1.1.1.1" xref="S3.E8.m1.80.80.2.cmml"><mi id="S3.E8.m1.24.24.24.24.22.22" xref="S3.E8.m1.24.24.24.24.22.22.cmml">y</mi><mi id="S3.E8.m1.25.25.25.25.23.23.1" xref="S3.E8.m1.25.25.25.25.23.23.1.cmml">i</mi></msub></mrow><mo id="S3.E8.m1.26.26.26.26.24.24" stretchy="false" xref="S3.E8.m1.80.80.2a.cmml">)</mo></mrow><mo id="S3.E8.m1.81.81.3.79.39.37.37.1.1.1.1.3.3" lspace="0.167em" xref="S3.E8.m1.80.80.2a.cmml">⁢</mo><mrow id="S3.E8.m1.81.81.3.79.39.37.37.1.1.1.1.3.2.1" xref="S3.E8.m1.80.80.2.cmml"><mi id="S3.E8.m1.27.27.27.27.25.25" xref="S3.E8.m1.27.27.27.27.25.25.cmml">log</mi><mo id="S3.E8.m1.81.81.3.79.39.37.37.1.1.1.1.3.2.1a" xref="S3.E8.m1.80.80.2a.cmml">⁡</mo><mrow id="S3.E8.m1.81.81.3.79.39.37.37.1.1.1.1.3.2.1.1" xref="S3.E8.m1.80.80.2.cmml"><mo id="S3.E8.m1.28.28.28.28.26.26" stretchy="false" xref="S3.E8.m1.80.80.2a.cmml">(</mo><mrow id="S3.E8.m1.81.81.3.79.39.37.37.1.1.1.1.3.2.1.1.1" xref="S3.E8.m1.80.80.2.cmml"><mn id="S3.E8.m1.29.29.29.29.27.27" xref="S3.E8.m1.29.29.29.29.27.27.cmml">1</mn><mo id="S3.E8.m1.30.30.30.30.28.28" xref="S3.E8.m1.30.30.30.30.28.28.cmml">−</mo><mrow id="S3.E8.m1.81.81.3.79.39.37.37.1.1.1.1.3.2.1.1.1.1" xref="S3.E8.m1.80.80.2.cmml"><msub id="S3.E8.m1.81.81.3.79.39.37.37.1.1.1.1.3.2.1.1.1.1.3" xref="S3.E8.m1.80.80.2.cmml"><mi id="S3.E8.m1.31.31.31.31.29.29" xref="S3.E8.m1.31.31.31.31.29.29.cmml">f</mi><mi id="S3.E8.m1.32.32.32.32.30.30.1" xref="S3.E8.m1.32.32.32.32.30.30.1.cmml">θ</mi></msub><mo id="S3.E8.m1.81.81.3.79.39.37.37.1.1.1.1.3.2.1.1.1.1.2" xref="S3.E8.m1.80.80.2a.cmml">⁢</mo><mrow id="S3.E8.m1.81.81.3.79.39.37.37.1.1.1.1.3.2.1.1.1.1.1.1" xref="S3.E8.m1.80.80.2.cmml"><mo id="S3.E8.m1.33.33.33.33.31.31" stretchy="false" xref="S3.E8.m1.80.80.2a.cmml">(</mo><msub id="S3.E8.m1.81.81.3.79.39.37.37.1.1.1.1.3.2.1.1.1.1.1.1.1" xref="S3.E8.m1.80.80.2.cmml"><mi id="S3.E8.m1.34.34.34.34.32.32" xref="S3.E8.m1.34.34.34.34.32.32.cmml">x</mi><mi id="S3.E8.m1.35.35.35.35.33.33.1" xref="S3.E8.m1.35.35.35.35.33.33.1.cmml">i</mi></msub><mo id="S3.E8.m1.36.36.36.36.34.34" stretchy="false" xref="S3.E8.m1.80.80.2a.cmml">)</mo></mrow></mrow></mrow><mo id="S3.E8.m1.37.37.37.37.35.35" stretchy="false" xref="S3.E8.m1.80.80.2a.cmml">)</mo></mrow></mrow></mrow></mrow><mo id="S3.E8.m1.38.38.38.38.36.36" xref="S3.E8.m1.80.80.2a.cmml">]</mo></mrow></mrow></mrow></mrow></mtd></mtr><mtr id="S3.E8.m1.82.82.4d" xref="S3.E8.m1.80.80.2.cmml"><mtd class="ltx_align_right" columnalign="right" id="S3.E8.m1.82.82.4e" xref="S3.E8.m1.80.80.2.cmml"><msub id="S3.E8.m1.40.40.40.2.2" xref="S3.E8.m1.80.80.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.E8.m1.39.39.39.1.1.1" xref="S3.E8.m1.39.39.39.1.1.1.cmml">ℒ</mi><mtext id="S3.E8.m1.40.40.40.2.2.2.1" xref="S3.E8.m1.40.40.40.2.2.2.1a.cmml">C</mtext></msub></mtd><mtd class="ltx_align_left" columnalign="left" id="S3.E8.m1.82.82.4f" xref="S3.E8.m1.80.80.2.cmml"><mrow id="S3.E8.m1.82.82.4.80.41.39" xref="S3.E8.m1.80.80.2.cmml"><mi id="S3.E8.m1.82.82.4.80.41.39.40" xref="S3.E8.m1.80.80.2a.cmml"></mi><mo id="S3.E8.m1.41.41.41.3.1.1" xref="S3.E8.m1.41.41.41.3.1.1.cmml">=</mo><mrow id="S3.E8.m1.82.82.4.80.41.39.39" xref="S3.E8.m1.80.80.2.cmml"><mo id="S3.E8.m1.82.82.4.80.41.39.39a" xref="S3.E8.m1.80.80.2a.cmml">−</mo><mrow id="S3.E8.m1.82.82.4.80.41.39.39.1" xref="S3.E8.m1.80.80.2.cmml"><munderover id="S3.E8.m1.82.82.4.80.41.39.39.1.2" xref="S3.E8.m1.80.80.2.cmml"><mo id="S3.E8.m1.43.43.43.5.3.3" movablelimits="false" rspace="0em" xref="S3.E8.m1.43.43.43.5.3.3.cmml">∑</mo><mrow id="S3.E8.m1.44.44.44.6.4.4.1" xref="S3.E8.m1.44.44.44.6.4.4.1.cmml"><mi id="S3.E8.m1.44.44.44.6.4.4.1.2" xref="S3.E8.m1.44.44.44.6.4.4.1.2.cmml">i</mi><mo id="S3.E8.m1.44.44.44.6.4.4.1.1" xref="S3.E8.m1.44.44.44.6.4.4.1.1.cmml">=</mo><mn id="S3.E8.m1.44.44.44.6.4.4.1.3" xref="S3.E8.m1.44.44.44.6.4.4.1.3.cmml">1</mn></mrow><mi id="S3.E8.m1.45.45.45.7.5.5.1" xref="S3.E8.m1.45.45.45.7.5.5.1.cmml">N</mi></munderover><mrow id="S3.E8.m1.82.82.4.80.41.39.39.1.1.1" xref="S3.E8.m1.80.80.2.cmml"><mo id="S3.E8.m1.46.46.46.8.6.6" xref="S3.E8.m1.80.80.2a.cmml">[</mo><mrow id="S3.E8.m1.82.82.4.80.41.39.39.1.1.1.1" xref="S3.E8.m1.80.80.2.cmml"><mrow id="S3.E8.m1.82.82.4.80.41.39.39.1.1.1.1.1" xref="S3.E8.m1.80.80.2.cmml"><msubsup id="S3.E8.m1.82.82.4.80.41.39.39.1.1.1.1.1.3" xref="S3.E8.m1.80.80.2.cmml"><mi id="S3.E8.m1.47.47.47.9.7.7" xref="S3.E8.m1.47.47.47.9.7.7.cmml">p</mi><mtext id="S3.E8.m1.48.48.48.10.8.8.1" xref="S3.E8.m1.48.48.48.10.8.8.1a.cmml">emp</mtext><mi id="S3.E8.m1.49.49.49.11.9.9.1" xref="S3.E8.m1.49.49.49.11.9.9.1.cmml">i</mi></msubsup><mo id="S3.E8.m1.82.82.4.80.41.39.39.1.1.1.1.1.2" lspace="0.167em" xref="S3.E8.m1.80.80.2a.cmml">⁢</mo><mrow id="S3.E8.m1.82.82.4.80.41.39.39.1.1.1.1.1.1.1" xref="S3.E8.m1.80.80.2.cmml"><mi id="S3.E8.m1.50.50.50.12.10.10" xref="S3.E8.m1.50.50.50.12.10.10.cmml">log</mi><mo id="S3.E8.m1.82.82.4.80.41.39.39.1.1.1.1.1.1.1a" xref="S3.E8.m1.80.80.2a.cmml">⁡</mo><mrow id="S3.E8.m1.82.82.4.80.41.39.39.1.1.1.1.1.1.1.1" xref="S3.E8.m1.80.80.2.cmml"><mo id="S3.E8.m1.51.51.51.13.11.11" xref="S3.E8.m1.80.80.2a.cmml">(</mo><mrow id="S3.E8.m1.82.82.4.80.41.39.39.1.1.1.1.1.1.1.1.1" xref="S3.E8.m1.80.80.2.cmml"><msub id="S3.E8.m1.82.82.4.80.41.39.39.1.1.1.1.1.1.1.1.1.3" xref="S3.E8.m1.80.80.2.cmml"><mi id="S3.E8.m1.52.52.52.14.12.12" xref="S3.E8.m1.52.52.52.14.12.12.cmml">f</mi><mi id="S3.E8.m1.53.53.53.15.13.13.1" xref="S3.E8.m1.53.53.53.15.13.13.1.cmml">θ</mi></msub><mo id="S3.E8.m1.82.82.4.80.41.39.39.1.1.1.1.1.1.1.1.1.2" xref="S3.E8.m1.80.80.2a.cmml">⁢</mo><mrow id="S3.E8.m1.82.82.4.80.41.39.39.1.1.1.1.1.1.1.1.1.1.1" xref="S3.E8.m1.80.80.2.cmml"><mo id="S3.E8.m1.54.54.54.16.14.14" stretchy="false" xref="S3.E8.m1.80.80.2a.cmml">(</mo><msub id="S3.E8.m1.82.82.4.80.41.39.39.1.1.1.1.1.1.1.1.1.1.1.1" xref="S3.E8.m1.80.80.2.cmml"><mi id="S3.E8.m1.55.55.55.17.15.15" xref="S3.E8.m1.55.55.55.17.15.15.cmml">x</mi><mi id="S3.E8.m1.56.56.56.18.16.16.1" xref="S3.E8.m1.56.56.56.18.16.16.1.cmml">i</mi></msub><mo id="S3.E8.m1.57.57.57.19.17.17" stretchy="false" xref="S3.E8.m1.80.80.2a.cmml">)</mo></mrow></mrow><mo id="S3.E8.m1.58.58.58.20.18.18" xref="S3.E8.m1.80.80.2a.cmml">)</mo></mrow></mrow></mrow><mo id="S3.E8.m1.59.59.59.21.19.19" xref="S3.E8.m1.59.59.59.21.19.19.cmml">+</mo><mrow id="S3.E8.m1.82.82.4.80.41.39.39.1.1.1.1.3" xref="S3.E8.m1.80.80.2.cmml"><mrow id="S3.E8.m1.82.82.4.80.41.39.39.1.1.1.1.2.1.1" xref="S3.E8.m1.80.80.2.cmml"><mo id="S3.E8.m1.60.60.60.22.20.20" xref="S3.E8.m1.80.80.2a.cmml">(</mo><mrow id="S3.E8.m1.82.82.4.80.41.39.39.1.1.1.1.2.1.1.1" xref="S3.E8.m1.80.80.2.cmml"><mn id="S3.E8.m1.61.61.61.23.21.21" xref="S3.E8.m1.61.61.61.23.21.21.cmml">1</mn><mo id="S3.E8.m1.62.62.62.24.22.22" xref="S3.E8.m1.62.62.62.24.22.22.cmml">−</mo><msubsup id="S3.E8.m1.82.82.4.80.41.39.39.1.1.1.1.2.1.1.1.1" xref="S3.E8.m1.80.80.2.cmml"><mi id="S3.E8.m1.63.63.63.25.23.23" xref="S3.E8.m1.63.63.63.25.23.23.cmml">p</mi><mtext id="S3.E8.m1.64.64.64.26.24.24.1" xref="S3.E8.m1.64.64.64.26.24.24.1a.cmml">emp</mtext><mi id="S3.E8.m1.65.65.65.27.25.25.1" xref="S3.E8.m1.65.65.65.27.25.25.1.cmml">i</mi></msubsup></mrow><mo id="S3.E8.m1.66.66.66.28.26.26" xref="S3.E8.m1.80.80.2a.cmml">)</mo></mrow><mo id="S3.E8.m1.82.82.4.80.41.39.39.1.1.1.1.3.3" lspace="0.167em" xref="S3.E8.m1.80.80.2a.cmml">⁢</mo><mrow id="S3.E8.m1.82.82.4.80.41.39.39.1.1.1.1.3.2.1" xref="S3.E8.m1.80.80.2.cmml"><mi id="S3.E8.m1.67.67.67.29.27.27" xref="S3.E8.m1.67.67.67.29.27.27.cmml">log</mi><mo id="S3.E8.m1.82.82.4.80.41.39.39.1.1.1.1.3.2.1a" xref="S3.E8.m1.80.80.2a.cmml">⁡</mo><mrow id="S3.E8.m1.82.82.4.80.41.39.39.1.1.1.1.3.2.1.1" xref="S3.E8.m1.80.80.2.cmml"><mo id="S3.E8.m1.68.68.68.30.28.28" xref="S3.E8.m1.80.80.2a.cmml">(</mo><mrow id="S3.E8.m1.82.82.4.80.41.39.39.1.1.1.1.3.2.1.1.1" xref="S3.E8.m1.80.80.2.cmml"><mn id="S3.E8.m1.69.69.69.31.29.29" xref="S3.E8.m1.69.69.69.31.29.29.cmml">1</mn><mo id="S3.E8.m1.70.70.70.32.30.30" xref="S3.E8.m1.70.70.70.32.30.30.cmml">−</mo><mrow id="S3.E8.m1.82.82.4.80.41.39.39.1.1.1.1.3.2.1.1.1.1" xref="S3.E8.m1.80.80.2.cmml"><msub id="S3.E8.m1.82.82.4.80.41.39.39.1.1.1.1.3.2.1.1.1.1.3" xref="S3.E8.m1.80.80.2.cmml"><mi id="S3.E8.m1.71.71.71.33.31.31" xref="S3.E8.m1.71.71.71.33.31.31.cmml">f</mi><mi id="S3.E8.m1.72.72.72.34.32.32.1" xref="S3.E8.m1.72.72.72.34.32.32.1.cmml">θ</mi></msub><mo id="S3.E8.m1.82.82.4.80.41.39.39.1.1.1.1.3.2.1.1.1.1.2" xref="S3.E8.m1.80.80.2a.cmml">⁢</mo><mrow id="S3.E8.m1.82.82.4.80.41.39.39.1.1.1.1.3.2.1.1.1.1.1.1" xref="S3.E8.m1.80.80.2.cmml"><mo id="S3.E8.m1.73.73.73.35.33.33" stretchy="false" xref="S3.E8.m1.80.80.2a.cmml">(</mo><msub id="S3.E8.m1.82.82.4.80.41.39.39.1.1.1.1.3.2.1.1.1.1.1.1.1" xref="S3.E8.m1.80.80.2.cmml"><mi id="S3.E8.m1.74.74.74.36.34.34" xref="S3.E8.m1.74.74.74.36.34.34.cmml">x</mi><mi id="S3.E8.m1.75.75.75.37.35.35.1" xref="S3.E8.m1.75.75.75.37.35.35.1.cmml">i</mi></msub><mo id="S3.E8.m1.76.76.76.38.36.36" stretchy="false" xref="S3.E8.m1.80.80.2a.cmml">)</mo></mrow></mrow></mrow><mo id="S3.E8.m1.77.77.77.39.37.37" xref="S3.E8.m1.80.80.2a.cmml">)</mo></mrow></mrow></mrow></mrow><mo id="S3.E8.m1.78.78.78.40.38.38" xref="S3.E8.m1.80.80.2a.cmml">]</mo></mrow></mrow></mrow></mrow></mtd></mtr></mtable><annotation-xml encoding="MathML-Content" id="S3.E8.m1.82b"><apply id="S3.E8.m1.80.80.2.cmml" xref="S3.E8.m1.82.82.4"><and id="S3.E8.m1.80.80.2a.cmml" xref="S3.E8.m1.81.81.3.79.39.37.38"></and><apply id="S3.E8.m1.80.80.2b.cmml" xref="S3.E8.m1.82.82.4"><eq id="S3.E8.m1.3.3.3.3.1.1.cmml" xref="S3.E8.m1.3.3.3.3.1.1"></eq><apply id="S3.E8.m1.80.80.2.4.cmml" xref="S3.E8.m1.82.82.4"><csymbol cd="ambiguous" id="S3.E8.m1.80.80.2.4.1.cmml" xref="S3.E8.m1.81.81.3.79.39.37.38">subscript</csymbol><ci id="S3.E8.m1.1.1.1.1.1.1.cmml" xref="S3.E8.m1.1.1.1.1.1.1">ℒ</ci><ci id="S3.E8.m1.2.2.2.2.2.2.1a.cmml" xref="S3.E8.m1.2.2.2.2.2.2.1"><mtext id="S3.E8.m1.2.2.2.2.2.2.1.cmml" mathsize="70%" xref="S3.E8.m1.2.2.2.2.2.2.1">D</mtext></ci></apply><apply id="S3.E8.m1.79.79.1.1.cmml" xref="S3.E8.m1.82.82.4"><minus id="S3.E8.m1.4.4.4.4.2.2.cmml" xref="S3.E8.m1.82.82.4"></minus><apply id="S3.E8.m1.79.79.1.1.1.cmml" xref="S3.E8.m1.82.82.4"><apply id="S3.E8.m1.79.79.1.1.1.2.cmml" xref="S3.E8.m1.82.82.4"><csymbol cd="ambiguous" id="S3.E8.m1.79.79.1.1.1.2.1.cmml" xref="S3.E8.m1.81.81.3.79.39.37.38">superscript</csymbol><apply id="S3.E8.m1.79.79.1.1.1.2.2.cmml" xref="S3.E8.m1.82.82.4"><csymbol cd="ambiguous" id="S3.E8.m1.79.79.1.1.1.2.2.1.cmml" xref="S3.E8.m1.81.81.3.79.39.37.38">subscript</csymbol><sum id="S3.E8.m1.5.5.5.5.3.3.cmml" xref="S3.E8.m1.5.5.5.5.3.3"></sum><apply id="S3.E8.m1.6.6.6.6.4.4.1.cmml" xref="S3.E8.m1.6.6.6.6.4.4.1"><eq id="S3.E8.m1.6.6.6.6.4.4.1.1.cmml" xref="S3.E8.m1.6.6.6.6.4.4.1.1"></eq><ci id="S3.E8.m1.6.6.6.6.4.4.1.2.cmml" xref="S3.E8.m1.6.6.6.6.4.4.1.2">𝑖</ci><cn id="S3.E8.m1.6.6.6.6.4.4.1.3.cmml" type="integer" xref="S3.E8.m1.6.6.6.6.4.4.1.3">1</cn></apply></apply><ci id="S3.E8.m1.7.7.7.7.5.5.1.cmml" xref="S3.E8.m1.7.7.7.7.5.5.1">𝑁</ci></apply><apply id="S3.E8.m1.79.79.1.1.1.1.cmml" xref="S3.E8.m1.82.82.4"><times id="S3.E8.m1.79.79.1.1.1.1.2.cmml" xref="S3.E8.m1.81.81.3.79.39.37.38"></times><apply id="S3.E8.m1.79.79.1.1.1.1.1.2.cmml" xref="S3.E8.m1.82.82.4"><csymbol cd="latexml" id="S3.E8.m1.79.79.1.1.1.1.1.2.1.cmml" xref="S3.E8.m1.82.82.4">delimited-[]</csymbol><apply id="S3.E8.m1.79.79.1.1.1.1.1.1.1.cmml" xref="S3.E8.m1.82.82.4"><plus id="S3.E8.m1.20.20.20.20.18.18.cmml" xref="S3.E8.m1.20.20.20.20.18.18"></plus><apply id="S3.E8.m1.79.79.1.1.1.1.1.1.1.1.cmml" xref="S3.E8.m1.82.82.4"><times id="S3.E8.m1.79.79.1.1.1.1.1.1.1.1.2.cmml" xref="S3.E8.m1.82.82.4"></times><apply id="S3.E8.m1.79.79.1.1.1.1.1.1.1.1.3.cmml" xref="S3.E8.m1.82.82.4"><csymbol cd="ambiguous" id="S3.E8.m1.79.79.1.1.1.1.1.1.1.1.3.1.cmml" xref="S3.E8.m1.82.82.4">subscript</csymbol><ci id="S3.E8.m1.9.9.9.9.7.7.cmml" xref="S3.E8.m1.9.9.9.9.7.7">𝑦</ci><ci id="S3.E8.m1.10.10.10.10.8.8.1.cmml" xref="S3.E8.m1.10.10.10.10.8.8.1">𝑖</ci></apply><apply id="S3.E8.m1.79.79.1.1.1.1.1.1.1.1.1.2.cmml" xref="S3.E8.m1.82.82.4"><log id="S3.E8.m1.11.11.11.11.9.9.cmml" xref="S3.E8.m1.11.11.11.11.9.9"></log><apply id="S3.E8.m1.79.79.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E8.m1.82.82.4"><times id="S3.E8.m1.79.79.1.1.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S3.E8.m1.82.82.4"></times><apply id="S3.E8.m1.79.79.1.1.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="S3.E8.m1.82.82.4"><csymbol cd="ambiguous" id="S3.E8.m1.79.79.1.1.1.1.1.1.1.1.1.1.1.1.3.1.cmml" xref="S3.E8.m1.82.82.4">subscript</csymbol><ci id="S3.E8.m1.13.13.13.13.11.11.cmml" xref="S3.E8.m1.13.13.13.13.11.11">𝑓</ci><ci id="S3.E8.m1.14.14.14.14.12.12.1.cmml" xref="S3.E8.m1.14.14.14.14.12.12.1">𝜃</ci></apply><apply id="S3.E8.m1.79.79.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E8.m1.82.82.4"><csymbol cd="ambiguous" id="S3.E8.m1.79.79.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E8.m1.82.82.4">subscript</csymbol><ci id="S3.E8.m1.16.16.16.16.14.14.cmml" xref="S3.E8.m1.16.16.16.16.14.14">𝑥</ci><ci id="S3.E8.m1.17.17.17.17.15.15.1.cmml" xref="S3.E8.m1.17.17.17.17.15.15.1">𝑖</ci></apply></apply></apply></apply><apply id="S3.E8.m1.79.79.1.1.1.1.1.1.1.3.cmml" xref="S3.E8.m1.82.82.4"><times id="S3.E8.m1.79.79.1.1.1.1.1.1.1.3.3.cmml" xref="S3.E8.m1.82.82.4"></times><apply id="S3.E8.m1.79.79.1.1.1.1.1.1.1.2.1.1.1.cmml" xref="S3.E8.m1.82.82.4"><minus id="S3.E8.m1.23.23.23.23.21.21.cmml" xref="S3.E8.m1.23.23.23.23.21.21"></minus><cn id="S3.E8.m1.22.22.22.22.20.20.cmml" type="integer" xref="S3.E8.m1.22.22.22.22.20.20">1</cn><apply id="S3.E8.m1.79.79.1.1.1.1.1.1.1.2.1.1.1.3.cmml" xref="S3.E8.m1.82.82.4"><csymbol cd="ambiguous" id="S3.E8.m1.79.79.1.1.1.1.1.1.1.2.1.1.1.3.1.cmml" xref="S3.E8.m1.82.82.4">subscript</csymbol><ci id="S3.E8.m1.24.24.24.24.22.22.cmml" xref="S3.E8.m1.24.24.24.24.22.22">𝑦</ci><ci id="S3.E8.m1.25.25.25.25.23.23.1.cmml" xref="S3.E8.m1.25.25.25.25.23.23.1">𝑖</ci></apply></apply><apply id="S3.E8.m1.79.79.1.1.1.1.1.1.1.3.2.2.cmml" xref="S3.E8.m1.82.82.4"><log id="S3.E8.m1.27.27.27.27.25.25.cmml" xref="S3.E8.m1.27.27.27.27.25.25"></log><apply id="S3.E8.m1.79.79.1.1.1.1.1.1.1.3.2.1.1.1.cmml" xref="S3.E8.m1.82.82.4"><minus id="S3.E8.m1.30.30.30.30.28.28.cmml" xref="S3.E8.m1.30.30.30.30.28.28"></minus><cn id="S3.E8.m1.29.29.29.29.27.27.cmml" type="integer" xref="S3.E8.m1.29.29.29.29.27.27">1</cn><apply id="S3.E8.m1.79.79.1.1.1.1.1.1.1.3.2.1.1.1.1.cmml" xref="S3.E8.m1.82.82.4"><times id="S3.E8.m1.79.79.1.1.1.1.1.1.1.3.2.1.1.1.1.2.cmml" xref="S3.E8.m1.82.82.4"></times><apply id="S3.E8.m1.79.79.1.1.1.1.1.1.1.3.2.1.1.1.1.3.cmml" xref="S3.E8.m1.82.82.4"><csymbol cd="ambiguous" id="S3.E8.m1.79.79.1.1.1.1.1.1.1.3.2.1.1.1.1.3.1.cmml" xref="S3.E8.m1.82.82.4">subscript</csymbol><ci id="S3.E8.m1.31.31.31.31.29.29.cmml" xref="S3.E8.m1.31.31.31.31.29.29">𝑓</ci><ci id="S3.E8.m1.32.32.32.32.30.30.1.cmml" xref="S3.E8.m1.32.32.32.32.30.30.1">𝜃</ci></apply><apply id="S3.E8.m1.79.79.1.1.1.1.1.1.1.3.2.1.1.1.1.1.1.1.cmml" xref="S3.E8.m1.82.82.4"><csymbol cd="ambiguous" id="S3.E8.m1.79.79.1.1.1.1.1.1.1.3.2.1.1.1.1.1.1.1.1.cmml" xref="S3.E8.m1.82.82.4">subscript</csymbol><ci id="S3.E8.m1.34.34.34.34.32.32.cmml" xref="S3.E8.m1.34.34.34.34.32.32">𝑥</ci><ci id="S3.E8.m1.35.35.35.35.33.33.1.cmml" xref="S3.E8.m1.35.35.35.35.33.33.1">𝑖</ci></apply></apply></apply></apply></apply></apply></apply><apply id="S3.E8.m1.79.79.1.1.1.1.3.cmml" xref="S3.E8.m1.82.82.4"><csymbol cd="ambiguous" id="S3.E8.m1.79.79.1.1.1.1.3.1.cmml" xref="S3.E8.m1.81.81.3.79.39.37.38">subscript</csymbol><ci id="S3.E8.m1.39.39.39.1.1.1.cmml" xref="S3.E8.m1.39.39.39.1.1.1">ℒ</ci><ci id="S3.E8.m1.40.40.40.2.2.2.1a.cmml" xref="S3.E8.m1.40.40.40.2.2.2.1"><mtext id="S3.E8.m1.40.40.40.2.2.2.1.cmml" mathsize="70%" xref="S3.E8.m1.40.40.40.2.2.2.1">C</mtext></ci></apply></apply></apply></apply></apply><apply id="S3.E8.m1.80.80.2c.cmml" xref="S3.E8.m1.82.82.4"><eq id="S3.E8.m1.41.41.41.3.1.1.cmml" xref="S3.E8.m1.41.41.41.3.1.1"></eq><share href="https://arxiv.org/html/2409.12535v1#S3.E8.m1.79.79.1.1.cmml" id="S3.E8.m1.80.80.2d.cmml" xref="S3.E8.m1.81.81.3.79.39.37.38"></share><apply id="S3.E8.m1.80.80.2.2.cmml" xref="S3.E8.m1.82.82.4"><minus id="S3.E8.m1.42.42.42.4.2.2.cmml" xref="S3.E8.m1.82.82.4"></minus><apply id="S3.E8.m1.80.80.2.2.1.cmml" xref="S3.E8.m1.82.82.4"><apply id="S3.E8.m1.80.80.2.2.1.2.cmml" xref="S3.E8.m1.82.82.4"><csymbol cd="ambiguous" id="S3.E8.m1.80.80.2.2.1.2.1.cmml" xref="S3.E8.m1.81.81.3.79.39.37.38">superscript</csymbol><apply id="S3.E8.m1.80.80.2.2.1.2.2.cmml" xref="S3.E8.m1.82.82.4"><csymbol cd="ambiguous" id="S3.E8.m1.80.80.2.2.1.2.2.1.cmml" xref="S3.E8.m1.81.81.3.79.39.37.38">subscript</csymbol><sum id="S3.E8.m1.43.43.43.5.3.3.cmml" xref="S3.E8.m1.43.43.43.5.3.3"></sum><apply id="S3.E8.m1.44.44.44.6.4.4.1.cmml" xref="S3.E8.m1.44.44.44.6.4.4.1"><eq id="S3.E8.m1.44.44.44.6.4.4.1.1.cmml" xref="S3.E8.m1.44.44.44.6.4.4.1.1"></eq><ci id="S3.E8.m1.44.44.44.6.4.4.1.2.cmml" xref="S3.E8.m1.44.44.44.6.4.4.1.2">𝑖</ci><cn id="S3.E8.m1.44.44.44.6.4.4.1.3.cmml" type="integer" xref="S3.E8.m1.44.44.44.6.4.4.1.3">1</cn></apply></apply><ci id="S3.E8.m1.45.45.45.7.5.5.1.cmml" xref="S3.E8.m1.45.45.45.7.5.5.1">𝑁</ci></apply><apply id="S3.E8.m1.80.80.2.2.1.1.2.cmml" xref="S3.E8.m1.82.82.4"><csymbol cd="latexml" id="S3.E8.m1.80.80.2.2.1.1.2.1.cmml" xref="S3.E8.m1.82.82.4">delimited-[]</csymbol><apply id="S3.E8.m1.80.80.2.2.1.1.1.1.cmml" xref="S3.E8.m1.82.82.4"><plus id="S3.E8.m1.59.59.59.21.19.19.cmml" xref="S3.E8.m1.59.59.59.21.19.19"></plus><apply id="S3.E8.m1.80.80.2.2.1.1.1.1.1.cmml" xref="S3.E8.m1.82.82.4"><times id="S3.E8.m1.80.80.2.2.1.1.1.1.1.2.cmml" xref="S3.E8.m1.82.82.4"></times><apply id="S3.E8.m1.80.80.2.2.1.1.1.1.1.3.cmml" xref="S3.E8.m1.82.82.4"><csymbol cd="ambiguous" id="S3.E8.m1.80.80.2.2.1.1.1.1.1.3.1.cmml" xref="S3.E8.m1.82.82.4">superscript</csymbol><apply id="S3.E8.m1.80.80.2.2.1.1.1.1.1.3.2.cmml" xref="S3.E8.m1.82.82.4"><csymbol cd="ambiguous" id="S3.E8.m1.80.80.2.2.1.1.1.1.1.3.2.1.cmml" xref="S3.E8.m1.82.82.4">subscript</csymbol><ci id="S3.E8.m1.47.47.47.9.7.7.cmml" xref="S3.E8.m1.47.47.47.9.7.7">𝑝</ci><ci id="S3.E8.m1.48.48.48.10.8.8.1a.cmml" xref="S3.E8.m1.48.48.48.10.8.8.1"><mtext id="S3.E8.m1.48.48.48.10.8.8.1.cmml" mathsize="70%" xref="S3.E8.m1.48.48.48.10.8.8.1">emp</mtext></ci></apply><ci id="S3.E8.m1.49.49.49.11.9.9.1.cmml" xref="S3.E8.m1.49.49.49.11.9.9.1">𝑖</ci></apply><apply id="S3.E8.m1.80.80.2.2.1.1.1.1.1.1.2.cmml" xref="S3.E8.m1.82.82.4"><log id="S3.E8.m1.50.50.50.12.10.10.cmml" xref="S3.E8.m1.50.50.50.12.10.10"></log><apply id="S3.E8.m1.80.80.2.2.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E8.m1.82.82.4"><times id="S3.E8.m1.80.80.2.2.1.1.1.1.1.1.1.1.1.2.cmml" xref="S3.E8.m1.82.82.4"></times><apply id="S3.E8.m1.80.80.2.2.1.1.1.1.1.1.1.1.1.3.cmml" xref="S3.E8.m1.82.82.4"><csymbol cd="ambiguous" id="S3.E8.m1.80.80.2.2.1.1.1.1.1.1.1.1.1.3.1.cmml" xref="S3.E8.m1.82.82.4">subscript</csymbol><ci id="S3.E8.m1.52.52.52.14.12.12.cmml" xref="S3.E8.m1.52.52.52.14.12.12">𝑓</ci><ci id="S3.E8.m1.53.53.53.15.13.13.1.cmml" xref="S3.E8.m1.53.53.53.15.13.13.1">𝜃</ci></apply><apply id="S3.E8.m1.80.80.2.2.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E8.m1.82.82.4"><csymbol cd="ambiguous" id="S3.E8.m1.80.80.2.2.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E8.m1.82.82.4">subscript</csymbol><ci id="S3.E8.m1.55.55.55.17.15.15.cmml" xref="S3.E8.m1.55.55.55.17.15.15">𝑥</ci><ci id="S3.E8.m1.56.56.56.18.16.16.1.cmml" xref="S3.E8.m1.56.56.56.18.16.16.1">𝑖</ci></apply></apply></apply></apply><apply id="S3.E8.m1.80.80.2.2.1.1.1.1.3.cmml" xref="S3.E8.m1.82.82.4"><times id="S3.E8.m1.80.80.2.2.1.1.1.1.3.3.cmml" xref="S3.E8.m1.82.82.4"></times><apply id="S3.E8.m1.80.80.2.2.1.1.1.1.2.1.1.1.cmml" xref="S3.E8.m1.82.82.4"><minus id="S3.E8.m1.62.62.62.24.22.22.cmml" xref="S3.E8.m1.62.62.62.24.22.22"></minus><cn id="S3.E8.m1.61.61.61.23.21.21.cmml" type="integer" xref="S3.E8.m1.61.61.61.23.21.21">1</cn><apply id="S3.E8.m1.80.80.2.2.1.1.1.1.2.1.1.1.3.cmml" xref="S3.E8.m1.82.82.4"><csymbol cd="ambiguous" id="S3.E8.m1.80.80.2.2.1.1.1.1.2.1.1.1.3.1.cmml" xref="S3.E8.m1.82.82.4">superscript</csymbol><apply id="S3.E8.m1.80.80.2.2.1.1.1.1.2.1.1.1.3.2.cmml" xref="S3.E8.m1.82.82.4"><csymbol cd="ambiguous" id="S3.E8.m1.80.80.2.2.1.1.1.1.2.1.1.1.3.2.1.cmml" xref="S3.E8.m1.82.82.4">subscript</csymbol><ci id="S3.E8.m1.63.63.63.25.23.23.cmml" xref="S3.E8.m1.63.63.63.25.23.23">𝑝</ci><ci id="S3.E8.m1.64.64.64.26.24.24.1a.cmml" xref="S3.E8.m1.64.64.64.26.24.24.1"><mtext id="S3.E8.m1.64.64.64.26.24.24.1.cmml" mathsize="70%" xref="S3.E8.m1.64.64.64.26.24.24.1">emp</mtext></ci></apply><ci id="S3.E8.m1.65.65.65.27.25.25.1.cmml" xref="S3.E8.m1.65.65.65.27.25.25.1">𝑖</ci></apply></apply><apply id="S3.E8.m1.80.80.2.2.1.1.1.1.3.2.2.cmml" xref="S3.E8.m1.82.82.4"><log id="S3.E8.m1.67.67.67.29.27.27.cmml" xref="S3.E8.m1.67.67.67.29.27.27"></log><apply id="S3.E8.m1.80.80.2.2.1.1.1.1.3.2.1.1.1.cmml" xref="S3.E8.m1.82.82.4"><minus id="S3.E8.m1.70.70.70.32.30.30.cmml" xref="S3.E8.m1.70.70.70.32.30.30"></minus><cn id="S3.E8.m1.69.69.69.31.29.29.cmml" type="integer" xref="S3.E8.m1.69.69.69.31.29.29">1</cn><apply id="S3.E8.m1.80.80.2.2.1.1.1.1.3.2.1.1.1.1.cmml" xref="S3.E8.m1.82.82.4"><times id="S3.E8.m1.80.80.2.2.1.1.1.1.3.2.1.1.1.1.2.cmml" xref="S3.E8.m1.82.82.4"></times><apply id="S3.E8.m1.80.80.2.2.1.1.1.1.3.2.1.1.1.1.3.cmml" xref="S3.E8.m1.82.82.4"><csymbol cd="ambiguous" id="S3.E8.m1.80.80.2.2.1.1.1.1.3.2.1.1.1.1.3.1.cmml" xref="S3.E8.m1.82.82.4">subscript</csymbol><ci id="S3.E8.m1.71.71.71.33.31.31.cmml" xref="S3.E8.m1.71.71.71.33.31.31">𝑓</ci><ci id="S3.E8.m1.72.72.72.34.32.32.1.cmml" xref="S3.E8.m1.72.72.72.34.32.32.1">𝜃</ci></apply><apply id="S3.E8.m1.80.80.2.2.1.1.1.1.3.2.1.1.1.1.1.1.1.cmml" xref="S3.E8.m1.82.82.4"><csymbol cd="ambiguous" id="S3.E8.m1.80.80.2.2.1.1.1.1.3.2.1.1.1.1.1.1.1.1.cmml" xref="S3.E8.m1.82.82.4">subscript</csymbol><ci id="S3.E8.m1.74.74.74.36.34.34.cmml" xref="S3.E8.m1.74.74.74.36.34.34">𝑥</ci><ci id="S3.E8.m1.75.75.75.37.35.35.1.cmml" xref="S3.E8.m1.75.75.75.37.35.35.1">𝑖</ci></apply></apply></apply></apply></apply></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E8.m1.82c">\begin{split}\mathcal{L}_{\text{D}}&amp;=-\sum_{i=1}^{N}\left[y_{i}\log(f_{\theta}%
(x_{i}))+(1-y_{i})\log(1-f_{\theta}(x_{i}))\right]\\
\mathcal{L}_{\text{C}}&amp;=-\sum_{i=1}^{N}\left[p_{\text{emp}}^{i}\log\left(f_{%
\theta}(x_{i})\right)+\left(1-p_{\text{emp}}^{i}\right)\log\left(1-f_{\theta}(%
x_{i})\right)\right]\end{split}</annotation><annotation encoding="application/x-llamapun" id="S3.E8.m1.82d">start_ROW start_CELL caligraphic_L start_POSTSUBSCRIPT D end_POSTSUBSCRIPT end_CELL start_CELL = - ∑ start_POSTSUBSCRIPT italic_i = 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_N end_POSTSUPERSCRIPT [ italic_y start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT roman_log ( italic_f start_POSTSUBSCRIPT italic_θ end_POSTSUBSCRIPT ( italic_x start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT ) ) + ( 1 - italic_y start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT ) roman_log ( 1 - italic_f start_POSTSUBSCRIPT italic_θ end_POSTSUBSCRIPT ( italic_x start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT ) ) ] end_CELL end_ROW start_ROW start_CELL caligraphic_L start_POSTSUBSCRIPT C end_POSTSUBSCRIPT end_CELL start_CELL = - ∑ start_POSTSUBSCRIPT italic_i = 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_N end_POSTSUPERSCRIPT [ italic_p start_POSTSUBSCRIPT emp end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_i end_POSTSUPERSCRIPT roman_log ( italic_f start_POSTSUBSCRIPT italic_θ end_POSTSUBSCRIPT ( italic_x start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT ) ) + ( 1 - italic_p start_POSTSUBSCRIPT emp end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_i end_POSTSUPERSCRIPT ) roman_log ( 1 - italic_f start_POSTSUBSCRIPT italic_θ end_POSTSUBSCRIPT ( italic_x start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT ) ) ] end_CELL end_ROW</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(8)</span></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S3.SS4.p2.5">where <math alttext="p^{i}_{\text{emp}}" class="ltx_Math" display="inline" id="S3.SS4.p2.1.m1.1"><semantics id="S3.SS4.p2.1.m1.1a"><msubsup id="S3.SS4.p2.1.m1.1.1" xref="S3.SS4.p2.1.m1.1.1.cmml"><mi id="S3.SS4.p2.1.m1.1.1.2.2" xref="S3.SS4.p2.1.m1.1.1.2.2.cmml">p</mi><mtext id="S3.SS4.p2.1.m1.1.1.3" xref="S3.SS4.p2.1.m1.1.1.3a.cmml">emp</mtext><mi id="S3.SS4.p2.1.m1.1.1.2.3" xref="S3.SS4.p2.1.m1.1.1.2.3.cmml">i</mi></msubsup><annotation-xml encoding="MathML-Content" id="S3.SS4.p2.1.m1.1b"><apply id="S3.SS4.p2.1.m1.1.1.cmml" xref="S3.SS4.p2.1.m1.1.1"><csymbol cd="ambiguous" id="S3.SS4.p2.1.m1.1.1.1.cmml" xref="S3.SS4.p2.1.m1.1.1">subscript</csymbol><apply id="S3.SS4.p2.1.m1.1.1.2.cmml" xref="S3.SS4.p2.1.m1.1.1"><csymbol cd="ambiguous" id="S3.SS4.p2.1.m1.1.1.2.1.cmml" xref="S3.SS4.p2.1.m1.1.1">superscript</csymbol><ci id="S3.SS4.p2.1.m1.1.1.2.2.cmml" xref="S3.SS4.p2.1.m1.1.1.2.2">𝑝</ci><ci id="S3.SS4.p2.1.m1.1.1.2.3.cmml" xref="S3.SS4.p2.1.m1.1.1.2.3">𝑖</ci></apply><ci id="S3.SS4.p2.1.m1.1.1.3a.cmml" xref="S3.SS4.p2.1.m1.1.1.3"><mtext id="S3.SS4.p2.1.m1.1.1.3.cmml" mathsize="70%" xref="S3.SS4.p2.1.m1.1.1.3">emp</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p2.1.m1.1c">p^{i}_{\text{emp}}</annotation><annotation encoding="application/x-llamapun" id="S3.SS4.p2.1.m1.1d">italic_p start_POSTSUPERSCRIPT italic_i end_POSTSUPERSCRIPT start_POSTSUBSCRIPT emp end_POSTSUBSCRIPT</annotation></semantics></math> is an estimate of the conditional probability <math alttext="P[y=1\mid f_{\theta}(x)\in I(f_{\theta}(x_{i}))]" class="ltx_Math" display="inline" id="S3.SS4.p2.2.m2.2"><semantics id="S3.SS4.p2.2.m2.2a"><mrow id="S3.SS4.p2.2.m2.2.2" xref="S3.SS4.p2.2.m2.2.2.cmml"><mi id="S3.SS4.p2.2.m2.2.2.3" xref="S3.SS4.p2.2.m2.2.2.3.cmml">P</mi><mo id="S3.SS4.p2.2.m2.2.2.2" xref="S3.SS4.p2.2.m2.2.2.2.cmml">⁢</mo><mrow id="S3.SS4.p2.2.m2.2.2.1.1" xref="S3.SS4.p2.2.m2.2.2.1.2.cmml"><mo id="S3.SS4.p2.2.m2.2.2.1.1.2" stretchy="false" xref="S3.SS4.p2.2.m2.2.2.1.2.1.cmml">[</mo><mrow id="S3.SS4.p2.2.m2.2.2.1.1.1" xref="S3.SS4.p2.2.m2.2.2.1.1.1.cmml"><mi id="S3.SS4.p2.2.m2.2.2.1.1.1.3" xref="S3.SS4.p2.2.m2.2.2.1.1.1.3.cmml">y</mi><mo id="S3.SS4.p2.2.m2.2.2.1.1.1.4" xref="S3.SS4.p2.2.m2.2.2.1.1.1.4.cmml">=</mo><mrow id="S3.SS4.p2.2.m2.2.2.1.1.1.5" xref="S3.SS4.p2.2.m2.2.2.1.1.1.5.cmml"><mn id="S3.SS4.p2.2.m2.2.2.1.1.1.5.2" xref="S3.SS4.p2.2.m2.2.2.1.1.1.5.2.cmml">1</mn><mo id="S3.SS4.p2.2.m2.2.2.1.1.1.5.1" xref="S3.SS4.p2.2.m2.2.2.1.1.1.5.1.cmml">∣</mo><mrow id="S3.SS4.p2.2.m2.2.2.1.1.1.5.3" xref="S3.SS4.p2.2.m2.2.2.1.1.1.5.3.cmml"><msub id="S3.SS4.p2.2.m2.2.2.1.1.1.5.3.2" xref="S3.SS4.p2.2.m2.2.2.1.1.1.5.3.2.cmml"><mi id="S3.SS4.p2.2.m2.2.2.1.1.1.5.3.2.2" xref="S3.SS4.p2.2.m2.2.2.1.1.1.5.3.2.2.cmml">f</mi><mi id="S3.SS4.p2.2.m2.2.2.1.1.1.5.3.2.3" xref="S3.SS4.p2.2.m2.2.2.1.1.1.5.3.2.3.cmml">θ</mi></msub><mo id="S3.SS4.p2.2.m2.2.2.1.1.1.5.3.1" xref="S3.SS4.p2.2.m2.2.2.1.1.1.5.3.1.cmml">⁢</mo><mrow id="S3.SS4.p2.2.m2.2.2.1.1.1.5.3.3.2" xref="S3.SS4.p2.2.m2.2.2.1.1.1.5.3.cmml"><mo id="S3.SS4.p2.2.m2.2.2.1.1.1.5.3.3.2.1" stretchy="false" xref="S3.SS4.p2.2.m2.2.2.1.1.1.5.3.cmml">(</mo><mi id="S3.SS4.p2.2.m2.1.1" xref="S3.SS4.p2.2.m2.1.1.cmml">x</mi><mo id="S3.SS4.p2.2.m2.2.2.1.1.1.5.3.3.2.2" stretchy="false" xref="S3.SS4.p2.2.m2.2.2.1.1.1.5.3.cmml">)</mo></mrow></mrow></mrow><mo id="S3.SS4.p2.2.m2.2.2.1.1.1.6" xref="S3.SS4.p2.2.m2.2.2.1.1.1.6.cmml">∈</mo><mrow id="S3.SS4.p2.2.m2.2.2.1.1.1.1" xref="S3.SS4.p2.2.m2.2.2.1.1.1.1.cmml"><mi id="S3.SS4.p2.2.m2.2.2.1.1.1.1.3" xref="S3.SS4.p2.2.m2.2.2.1.1.1.1.3.cmml">I</mi><mo id="S3.SS4.p2.2.m2.2.2.1.1.1.1.2" xref="S3.SS4.p2.2.m2.2.2.1.1.1.1.2.cmml">⁢</mo><mrow id="S3.SS4.p2.2.m2.2.2.1.1.1.1.1.1" xref="S3.SS4.p2.2.m2.2.2.1.1.1.1.1.1.1.cmml"><mo id="S3.SS4.p2.2.m2.2.2.1.1.1.1.1.1.2" stretchy="false" xref="S3.SS4.p2.2.m2.2.2.1.1.1.1.1.1.1.cmml">(</mo><mrow id="S3.SS4.p2.2.m2.2.2.1.1.1.1.1.1.1" xref="S3.SS4.p2.2.m2.2.2.1.1.1.1.1.1.1.cmml"><msub id="S3.SS4.p2.2.m2.2.2.1.1.1.1.1.1.1.3" xref="S3.SS4.p2.2.m2.2.2.1.1.1.1.1.1.1.3.cmml"><mi id="S3.SS4.p2.2.m2.2.2.1.1.1.1.1.1.1.3.2" xref="S3.SS4.p2.2.m2.2.2.1.1.1.1.1.1.1.3.2.cmml">f</mi><mi id="S3.SS4.p2.2.m2.2.2.1.1.1.1.1.1.1.3.3" xref="S3.SS4.p2.2.m2.2.2.1.1.1.1.1.1.1.3.3.cmml">θ</mi></msub><mo id="S3.SS4.p2.2.m2.2.2.1.1.1.1.1.1.1.2" xref="S3.SS4.p2.2.m2.2.2.1.1.1.1.1.1.1.2.cmml">⁢</mo><mrow id="S3.SS4.p2.2.m2.2.2.1.1.1.1.1.1.1.1.1" xref="S3.SS4.p2.2.m2.2.2.1.1.1.1.1.1.1.1.1.1.cmml"><mo id="S3.SS4.p2.2.m2.2.2.1.1.1.1.1.1.1.1.1.2" stretchy="false" xref="S3.SS4.p2.2.m2.2.2.1.1.1.1.1.1.1.1.1.1.cmml">(</mo><msub id="S3.SS4.p2.2.m2.2.2.1.1.1.1.1.1.1.1.1.1" xref="S3.SS4.p2.2.m2.2.2.1.1.1.1.1.1.1.1.1.1.cmml"><mi id="S3.SS4.p2.2.m2.2.2.1.1.1.1.1.1.1.1.1.1.2" xref="S3.SS4.p2.2.m2.2.2.1.1.1.1.1.1.1.1.1.1.2.cmml">x</mi><mi id="S3.SS4.p2.2.m2.2.2.1.1.1.1.1.1.1.1.1.1.3" xref="S3.SS4.p2.2.m2.2.2.1.1.1.1.1.1.1.1.1.1.3.cmml">i</mi></msub><mo id="S3.SS4.p2.2.m2.2.2.1.1.1.1.1.1.1.1.1.3" stretchy="false" xref="S3.SS4.p2.2.m2.2.2.1.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S3.SS4.p2.2.m2.2.2.1.1.1.1.1.1.3" stretchy="false" xref="S3.SS4.p2.2.m2.2.2.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><mo id="S3.SS4.p2.2.m2.2.2.1.1.3" stretchy="false" xref="S3.SS4.p2.2.m2.2.2.1.2.1.cmml">]</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS4.p2.2.m2.2b"><apply id="S3.SS4.p2.2.m2.2.2.cmml" xref="S3.SS4.p2.2.m2.2.2"><times id="S3.SS4.p2.2.m2.2.2.2.cmml" xref="S3.SS4.p2.2.m2.2.2.2"></times><ci id="S3.SS4.p2.2.m2.2.2.3.cmml" xref="S3.SS4.p2.2.m2.2.2.3">𝑃</ci><apply id="S3.SS4.p2.2.m2.2.2.1.2.cmml" xref="S3.SS4.p2.2.m2.2.2.1.1"><csymbol cd="latexml" id="S3.SS4.p2.2.m2.2.2.1.2.1.cmml" xref="S3.SS4.p2.2.m2.2.2.1.1.2">delimited-[]</csymbol><apply id="S3.SS4.p2.2.m2.2.2.1.1.1.cmml" xref="S3.SS4.p2.2.m2.2.2.1.1.1"><and id="S3.SS4.p2.2.m2.2.2.1.1.1a.cmml" xref="S3.SS4.p2.2.m2.2.2.1.1.1"></and><apply id="S3.SS4.p2.2.m2.2.2.1.1.1b.cmml" xref="S3.SS4.p2.2.m2.2.2.1.1.1"><eq id="S3.SS4.p2.2.m2.2.2.1.1.1.4.cmml" xref="S3.SS4.p2.2.m2.2.2.1.1.1.4"></eq><ci id="S3.SS4.p2.2.m2.2.2.1.1.1.3.cmml" xref="S3.SS4.p2.2.m2.2.2.1.1.1.3">𝑦</ci><apply id="S3.SS4.p2.2.m2.2.2.1.1.1.5.cmml" xref="S3.SS4.p2.2.m2.2.2.1.1.1.5"><csymbol cd="latexml" id="S3.SS4.p2.2.m2.2.2.1.1.1.5.1.cmml" xref="S3.SS4.p2.2.m2.2.2.1.1.1.5.1">conditional</csymbol><cn id="S3.SS4.p2.2.m2.2.2.1.1.1.5.2.cmml" type="integer" xref="S3.SS4.p2.2.m2.2.2.1.1.1.5.2">1</cn><apply id="S3.SS4.p2.2.m2.2.2.1.1.1.5.3.cmml" xref="S3.SS4.p2.2.m2.2.2.1.1.1.5.3"><times id="S3.SS4.p2.2.m2.2.2.1.1.1.5.3.1.cmml" xref="S3.SS4.p2.2.m2.2.2.1.1.1.5.3.1"></times><apply id="S3.SS4.p2.2.m2.2.2.1.1.1.5.3.2.cmml" xref="S3.SS4.p2.2.m2.2.2.1.1.1.5.3.2"><csymbol cd="ambiguous" id="S3.SS4.p2.2.m2.2.2.1.1.1.5.3.2.1.cmml" xref="S3.SS4.p2.2.m2.2.2.1.1.1.5.3.2">subscript</csymbol><ci id="S3.SS4.p2.2.m2.2.2.1.1.1.5.3.2.2.cmml" xref="S3.SS4.p2.2.m2.2.2.1.1.1.5.3.2.2">𝑓</ci><ci id="S3.SS4.p2.2.m2.2.2.1.1.1.5.3.2.3.cmml" xref="S3.SS4.p2.2.m2.2.2.1.1.1.5.3.2.3">𝜃</ci></apply><ci id="S3.SS4.p2.2.m2.1.1.cmml" xref="S3.SS4.p2.2.m2.1.1">𝑥</ci></apply></apply></apply><apply id="S3.SS4.p2.2.m2.2.2.1.1.1c.cmml" xref="S3.SS4.p2.2.m2.2.2.1.1.1"><in id="S3.SS4.p2.2.m2.2.2.1.1.1.6.cmml" xref="S3.SS4.p2.2.m2.2.2.1.1.1.6"></in><share href="https://arxiv.org/html/2409.12535v1#S3.SS4.p2.2.m2.2.2.1.1.1.5.cmml" id="S3.SS4.p2.2.m2.2.2.1.1.1d.cmml" xref="S3.SS4.p2.2.m2.2.2.1.1.1"></share><apply id="S3.SS4.p2.2.m2.2.2.1.1.1.1.cmml" xref="S3.SS4.p2.2.m2.2.2.1.1.1.1"><times id="S3.SS4.p2.2.m2.2.2.1.1.1.1.2.cmml" xref="S3.SS4.p2.2.m2.2.2.1.1.1.1.2"></times><ci id="S3.SS4.p2.2.m2.2.2.1.1.1.1.3.cmml" xref="S3.SS4.p2.2.m2.2.2.1.1.1.1.3">𝐼</ci><apply id="S3.SS4.p2.2.m2.2.2.1.1.1.1.1.1.1.cmml" xref="S3.SS4.p2.2.m2.2.2.1.1.1.1.1.1"><times id="S3.SS4.p2.2.m2.2.2.1.1.1.1.1.1.1.2.cmml" xref="S3.SS4.p2.2.m2.2.2.1.1.1.1.1.1.1.2"></times><apply id="S3.SS4.p2.2.m2.2.2.1.1.1.1.1.1.1.3.cmml" xref="S3.SS4.p2.2.m2.2.2.1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.SS4.p2.2.m2.2.2.1.1.1.1.1.1.1.3.1.cmml" xref="S3.SS4.p2.2.m2.2.2.1.1.1.1.1.1.1.3">subscript</csymbol><ci id="S3.SS4.p2.2.m2.2.2.1.1.1.1.1.1.1.3.2.cmml" xref="S3.SS4.p2.2.m2.2.2.1.1.1.1.1.1.1.3.2">𝑓</ci><ci id="S3.SS4.p2.2.m2.2.2.1.1.1.1.1.1.1.3.3.cmml" xref="S3.SS4.p2.2.m2.2.2.1.1.1.1.1.1.1.3.3">𝜃</ci></apply><apply id="S3.SS4.p2.2.m2.2.2.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.SS4.p2.2.m2.2.2.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS4.p2.2.m2.2.2.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.SS4.p2.2.m2.2.2.1.1.1.1.1.1.1.1.1">subscript</csymbol><ci id="S3.SS4.p2.2.m2.2.2.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S3.SS4.p2.2.m2.2.2.1.1.1.1.1.1.1.1.1.1.2">𝑥</ci><ci id="S3.SS4.p2.2.m2.2.2.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="S3.SS4.p2.2.m2.2.2.1.1.1.1.1.1.1.1.1.1.3">𝑖</ci></apply></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p2.2.m2.2c">P[y=1\mid f_{\theta}(x)\in I(f_{\theta}(x_{i}))]</annotation><annotation encoding="application/x-llamapun" id="S3.SS4.p2.2.m2.2d">italic_P [ italic_y = 1 ∣ italic_f start_POSTSUBSCRIPT italic_θ end_POSTSUBSCRIPT ( italic_x ) ∈ italic_I ( italic_f start_POSTSUBSCRIPT italic_θ end_POSTSUBSCRIPT ( italic_x start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT ) ) ]</annotation></semantics></math> and <math alttext="I(f_{\theta}(x_{i}))" class="ltx_Math" display="inline" id="S3.SS4.p2.3.m3.1"><semantics id="S3.SS4.p2.3.m3.1a"><mrow id="S3.SS4.p2.3.m3.1.1" xref="S3.SS4.p2.3.m3.1.1.cmml"><mi id="S3.SS4.p2.3.m3.1.1.3" xref="S3.SS4.p2.3.m3.1.1.3.cmml">I</mi><mo id="S3.SS4.p2.3.m3.1.1.2" xref="S3.SS4.p2.3.m3.1.1.2.cmml">⁢</mo><mrow id="S3.SS4.p2.3.m3.1.1.1.1" xref="S3.SS4.p2.3.m3.1.1.1.1.1.cmml"><mo id="S3.SS4.p2.3.m3.1.1.1.1.2" stretchy="false" xref="S3.SS4.p2.3.m3.1.1.1.1.1.cmml">(</mo><mrow id="S3.SS4.p2.3.m3.1.1.1.1.1" xref="S3.SS4.p2.3.m3.1.1.1.1.1.cmml"><msub id="S3.SS4.p2.3.m3.1.1.1.1.1.3" xref="S3.SS4.p2.3.m3.1.1.1.1.1.3.cmml"><mi id="S3.SS4.p2.3.m3.1.1.1.1.1.3.2" xref="S3.SS4.p2.3.m3.1.1.1.1.1.3.2.cmml">f</mi><mi id="S3.SS4.p2.3.m3.1.1.1.1.1.3.3" xref="S3.SS4.p2.3.m3.1.1.1.1.1.3.3.cmml">θ</mi></msub><mo id="S3.SS4.p2.3.m3.1.1.1.1.1.2" xref="S3.SS4.p2.3.m3.1.1.1.1.1.2.cmml">⁢</mo><mrow id="S3.SS4.p2.3.m3.1.1.1.1.1.1.1" xref="S3.SS4.p2.3.m3.1.1.1.1.1.1.1.1.cmml"><mo id="S3.SS4.p2.3.m3.1.1.1.1.1.1.1.2" stretchy="false" xref="S3.SS4.p2.3.m3.1.1.1.1.1.1.1.1.cmml">(</mo><msub id="S3.SS4.p2.3.m3.1.1.1.1.1.1.1.1" xref="S3.SS4.p2.3.m3.1.1.1.1.1.1.1.1.cmml"><mi id="S3.SS4.p2.3.m3.1.1.1.1.1.1.1.1.2" xref="S3.SS4.p2.3.m3.1.1.1.1.1.1.1.1.2.cmml">x</mi><mi id="S3.SS4.p2.3.m3.1.1.1.1.1.1.1.1.3" xref="S3.SS4.p2.3.m3.1.1.1.1.1.1.1.1.3.cmml">i</mi></msub><mo id="S3.SS4.p2.3.m3.1.1.1.1.1.1.1.3" stretchy="false" xref="S3.SS4.p2.3.m3.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S3.SS4.p2.3.m3.1.1.1.1.3" stretchy="false" xref="S3.SS4.p2.3.m3.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS4.p2.3.m3.1b"><apply id="S3.SS4.p2.3.m3.1.1.cmml" xref="S3.SS4.p2.3.m3.1.1"><times id="S3.SS4.p2.3.m3.1.1.2.cmml" xref="S3.SS4.p2.3.m3.1.1.2"></times><ci id="S3.SS4.p2.3.m3.1.1.3.cmml" xref="S3.SS4.p2.3.m3.1.1.3">𝐼</ci><apply id="S3.SS4.p2.3.m3.1.1.1.1.1.cmml" xref="S3.SS4.p2.3.m3.1.1.1.1"><times id="S3.SS4.p2.3.m3.1.1.1.1.1.2.cmml" xref="S3.SS4.p2.3.m3.1.1.1.1.1.2"></times><apply id="S3.SS4.p2.3.m3.1.1.1.1.1.3.cmml" xref="S3.SS4.p2.3.m3.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.SS4.p2.3.m3.1.1.1.1.1.3.1.cmml" xref="S3.SS4.p2.3.m3.1.1.1.1.1.3">subscript</csymbol><ci id="S3.SS4.p2.3.m3.1.1.1.1.1.3.2.cmml" xref="S3.SS4.p2.3.m3.1.1.1.1.1.3.2">𝑓</ci><ci id="S3.SS4.p2.3.m3.1.1.1.1.1.3.3.cmml" xref="S3.SS4.p2.3.m3.1.1.1.1.1.3.3">𝜃</ci></apply><apply id="S3.SS4.p2.3.m3.1.1.1.1.1.1.1.1.cmml" xref="S3.SS4.p2.3.m3.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS4.p2.3.m3.1.1.1.1.1.1.1.1.1.cmml" xref="S3.SS4.p2.3.m3.1.1.1.1.1.1.1">subscript</csymbol><ci id="S3.SS4.p2.3.m3.1.1.1.1.1.1.1.1.2.cmml" xref="S3.SS4.p2.3.m3.1.1.1.1.1.1.1.1.2">𝑥</ci><ci id="S3.SS4.p2.3.m3.1.1.1.1.1.1.1.1.3.cmml" xref="S3.SS4.p2.3.m3.1.1.1.1.1.1.1.1.3">𝑖</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p2.3.m3.1c">I(f_{\theta}(x_{i}))</annotation><annotation encoding="application/x-llamapun" id="S3.SS4.p2.3.m3.1d">italic_I ( italic_f start_POSTSUBSCRIPT italic_θ end_POSTSUBSCRIPT ( italic_x start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT ) )</annotation></semantics></math> is a small interval centered at <math alttext="f(x_{i})" class="ltx_Math" display="inline" id="S3.SS4.p2.4.m4.1"><semantics id="S3.SS4.p2.4.m4.1a"><mrow id="S3.SS4.p2.4.m4.1.1" xref="S3.SS4.p2.4.m4.1.1.cmml"><mi id="S3.SS4.p2.4.m4.1.1.3" xref="S3.SS4.p2.4.m4.1.1.3.cmml">f</mi><mo id="S3.SS4.p2.4.m4.1.1.2" xref="S3.SS4.p2.4.m4.1.1.2.cmml">⁢</mo><mrow id="S3.SS4.p2.4.m4.1.1.1.1" xref="S3.SS4.p2.4.m4.1.1.1.1.1.cmml"><mo id="S3.SS4.p2.4.m4.1.1.1.1.2" stretchy="false" xref="S3.SS4.p2.4.m4.1.1.1.1.1.cmml">(</mo><msub id="S3.SS4.p2.4.m4.1.1.1.1.1" xref="S3.SS4.p2.4.m4.1.1.1.1.1.cmml"><mi id="S3.SS4.p2.4.m4.1.1.1.1.1.2" xref="S3.SS4.p2.4.m4.1.1.1.1.1.2.cmml">x</mi><mi id="S3.SS4.p2.4.m4.1.1.1.1.1.3" xref="S3.SS4.p2.4.m4.1.1.1.1.1.3.cmml">i</mi></msub><mo id="S3.SS4.p2.4.m4.1.1.1.1.3" stretchy="false" xref="S3.SS4.p2.4.m4.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS4.p2.4.m4.1b"><apply id="S3.SS4.p2.4.m4.1.1.cmml" xref="S3.SS4.p2.4.m4.1.1"><times id="S3.SS4.p2.4.m4.1.1.2.cmml" xref="S3.SS4.p2.4.m4.1.1.2"></times><ci id="S3.SS4.p2.4.m4.1.1.3.cmml" xref="S3.SS4.p2.4.m4.1.1.3">𝑓</ci><apply id="S3.SS4.p2.4.m4.1.1.1.1.1.cmml" xref="S3.SS4.p2.4.m4.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS4.p2.4.m4.1.1.1.1.1.1.cmml" xref="S3.SS4.p2.4.m4.1.1.1.1">subscript</csymbol><ci id="S3.SS4.p2.4.m4.1.1.1.1.1.2.cmml" xref="S3.SS4.p2.4.m4.1.1.1.1.1.2">𝑥</ci><ci id="S3.SS4.p2.4.m4.1.1.1.1.1.3.cmml" xref="S3.SS4.p2.4.m4.1.1.1.1.1.3">𝑖</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p2.4.m4.1c">f(x_{i})</annotation><annotation encoding="application/x-llamapun" id="S3.SS4.p2.4.m4.1d">italic_f ( italic_x start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT )</annotation></semantics></math>. We consider the <span class="ltx_text ltx_font_italic" id="S3.SS4.p2.5.1">bin</span> version of CaPE method for estimating <math alttext="p_{\text{emp}}^{i}" class="ltx_Math" display="inline" id="S3.SS4.p2.5.m5.1"><semantics id="S3.SS4.p2.5.m5.1a"><msubsup id="S3.SS4.p2.5.m5.1.1" xref="S3.SS4.p2.5.m5.1.1.cmml"><mi id="S3.SS4.p2.5.m5.1.1.2.2" xref="S3.SS4.p2.5.m5.1.1.2.2.cmml">p</mi><mtext id="S3.SS4.p2.5.m5.1.1.2.3" xref="S3.SS4.p2.5.m5.1.1.2.3a.cmml">emp</mtext><mi id="S3.SS4.p2.5.m5.1.1.3" xref="S3.SS4.p2.5.m5.1.1.3.cmml">i</mi></msubsup><annotation-xml encoding="MathML-Content" id="S3.SS4.p2.5.m5.1b"><apply id="S3.SS4.p2.5.m5.1.1.cmml" xref="S3.SS4.p2.5.m5.1.1"><csymbol cd="ambiguous" id="S3.SS4.p2.5.m5.1.1.1.cmml" xref="S3.SS4.p2.5.m5.1.1">superscript</csymbol><apply id="S3.SS4.p2.5.m5.1.1.2.cmml" xref="S3.SS4.p2.5.m5.1.1"><csymbol cd="ambiguous" id="S3.SS4.p2.5.m5.1.1.2.1.cmml" xref="S3.SS4.p2.5.m5.1.1">subscript</csymbol><ci id="S3.SS4.p2.5.m5.1.1.2.2.cmml" xref="S3.SS4.p2.5.m5.1.1.2.2">𝑝</ci><ci id="S3.SS4.p2.5.m5.1.1.2.3a.cmml" xref="S3.SS4.p2.5.m5.1.1.2.3"><mtext id="S3.SS4.p2.5.m5.1.1.2.3.cmml" mathsize="70%" xref="S3.SS4.p2.5.m5.1.1.2.3">emp</mtext></ci></apply><ci id="S3.SS4.p2.5.m5.1.1.3.cmml" xref="S3.SS4.p2.5.m5.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p2.5.m5.1c">p_{\text{emp}}^{i}</annotation><annotation encoding="application/x-llamapun" id="S3.SS4.p2.5.m5.1d">italic_p start_POSTSUBSCRIPT emp end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_i end_POSTSUPERSCRIPT</annotation></semantics></math>, which involves dividing the training set into bins.</p>
</div>
<div class="ltx_para" id="S3.SS4.p3">
<p class="ltx_p" id="S3.SS4.p3.6">We identify the bin <math alttext="b_{i}" class="ltx_Math" display="inline" id="S3.SS4.p3.1.m1.1"><semantics id="S3.SS4.p3.1.m1.1a"><msub id="S3.SS4.p3.1.m1.1.1" xref="S3.SS4.p3.1.m1.1.1.cmml"><mi id="S3.SS4.p3.1.m1.1.1.2" xref="S3.SS4.p3.1.m1.1.1.2.cmml">b</mi><mi id="S3.SS4.p3.1.m1.1.1.3" xref="S3.SS4.p3.1.m1.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS4.p3.1.m1.1b"><apply id="S3.SS4.p3.1.m1.1.1.cmml" xref="S3.SS4.p3.1.m1.1.1"><csymbol cd="ambiguous" id="S3.SS4.p3.1.m1.1.1.1.cmml" xref="S3.SS4.p3.1.m1.1.1">subscript</csymbol><ci id="S3.SS4.p3.1.m1.1.1.2.cmml" xref="S3.SS4.p3.1.m1.1.1.2">𝑏</ci><ci id="S3.SS4.p3.1.m1.1.1.3.cmml" xref="S3.SS4.p3.1.m1.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p3.1.m1.1c">b_{i}</annotation><annotation encoding="application/x-llamapun" id="S3.SS4.p3.1.m1.1d">italic_b start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT</annotation></semantics></math> that contains <math alttext="f_{\theta}(x)" class="ltx_Math" display="inline" id="S3.SS4.p3.2.m2.1"><semantics id="S3.SS4.p3.2.m2.1a"><mrow id="S3.SS4.p3.2.m2.1.2" xref="S3.SS4.p3.2.m2.1.2.cmml"><msub id="S3.SS4.p3.2.m2.1.2.2" xref="S3.SS4.p3.2.m2.1.2.2.cmml"><mi id="S3.SS4.p3.2.m2.1.2.2.2" xref="S3.SS4.p3.2.m2.1.2.2.2.cmml">f</mi><mi id="S3.SS4.p3.2.m2.1.2.2.3" xref="S3.SS4.p3.2.m2.1.2.2.3.cmml">θ</mi></msub><mo id="S3.SS4.p3.2.m2.1.2.1" xref="S3.SS4.p3.2.m2.1.2.1.cmml">⁢</mo><mrow id="S3.SS4.p3.2.m2.1.2.3.2" xref="S3.SS4.p3.2.m2.1.2.cmml"><mo id="S3.SS4.p3.2.m2.1.2.3.2.1" stretchy="false" xref="S3.SS4.p3.2.m2.1.2.cmml">(</mo><mi id="S3.SS4.p3.2.m2.1.1" xref="S3.SS4.p3.2.m2.1.1.cmml">x</mi><mo id="S3.SS4.p3.2.m2.1.2.3.2.2" stretchy="false" xref="S3.SS4.p3.2.m2.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS4.p3.2.m2.1b"><apply id="S3.SS4.p3.2.m2.1.2.cmml" xref="S3.SS4.p3.2.m2.1.2"><times id="S3.SS4.p3.2.m2.1.2.1.cmml" xref="S3.SS4.p3.2.m2.1.2.1"></times><apply id="S3.SS4.p3.2.m2.1.2.2.cmml" xref="S3.SS4.p3.2.m2.1.2.2"><csymbol cd="ambiguous" id="S3.SS4.p3.2.m2.1.2.2.1.cmml" xref="S3.SS4.p3.2.m2.1.2.2">subscript</csymbol><ci id="S3.SS4.p3.2.m2.1.2.2.2.cmml" xref="S3.SS4.p3.2.m2.1.2.2.2">𝑓</ci><ci id="S3.SS4.p3.2.m2.1.2.2.3.cmml" xref="S3.SS4.p3.2.m2.1.2.2.3">𝜃</ci></apply><ci id="S3.SS4.p3.2.m2.1.1.cmml" xref="S3.SS4.p3.2.m2.1.1">𝑥</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p3.2.m2.1c">f_{\theta}(x)</annotation><annotation encoding="application/x-llamapun" id="S3.SS4.p3.2.m2.1d">italic_f start_POSTSUBSCRIPT italic_θ end_POSTSUBSCRIPT ( italic_x )</annotation></semantics></math> and assign <math alttext="p_{\text{emp}}^{i}" class="ltx_Math" display="inline" id="S3.SS4.p3.3.m3.1"><semantics id="S3.SS4.p3.3.m3.1a"><msubsup id="S3.SS4.p3.3.m3.1.1" xref="S3.SS4.p3.3.m3.1.1.cmml"><mi id="S3.SS4.p3.3.m3.1.1.2.2" xref="S3.SS4.p3.3.m3.1.1.2.2.cmml">p</mi><mtext id="S3.SS4.p3.3.m3.1.1.2.3" xref="S3.SS4.p3.3.m3.1.1.2.3a.cmml">emp</mtext><mi id="S3.SS4.p3.3.m3.1.1.3" xref="S3.SS4.p3.3.m3.1.1.3.cmml">i</mi></msubsup><annotation-xml encoding="MathML-Content" id="S3.SS4.p3.3.m3.1b"><apply id="S3.SS4.p3.3.m3.1.1.cmml" xref="S3.SS4.p3.3.m3.1.1"><csymbol cd="ambiguous" id="S3.SS4.p3.3.m3.1.1.1.cmml" xref="S3.SS4.p3.3.m3.1.1">superscript</csymbol><apply id="S3.SS4.p3.3.m3.1.1.2.cmml" xref="S3.SS4.p3.3.m3.1.1"><csymbol cd="ambiguous" id="S3.SS4.p3.3.m3.1.1.2.1.cmml" xref="S3.SS4.p3.3.m3.1.1">subscript</csymbol><ci id="S3.SS4.p3.3.m3.1.1.2.2.cmml" xref="S3.SS4.p3.3.m3.1.1.2.2">𝑝</ci><ci id="S3.SS4.p3.3.m3.1.1.2.3a.cmml" xref="S3.SS4.p3.3.m3.1.1.2.3"><mtext id="S3.SS4.p3.3.m3.1.1.2.3.cmml" mathsize="70%" xref="S3.SS4.p3.3.m3.1.1.2.3">emp</mtext></ci></apply><ci id="S3.SS4.p3.3.m3.1.1.3.cmml" xref="S3.SS4.p3.3.m3.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p3.3.m3.1c">p_{\text{emp}}^{i}</annotation><annotation encoding="application/x-llamapun" id="S3.SS4.p3.3.m3.1d">italic_p start_POSTSUBSCRIPT emp end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_i end_POSTSUPERSCRIPT</annotation></semantics></math> as <math alttext="p_{\text{emp}}^{(b_{i})}" class="ltx_Math" display="inline" id="S3.SS4.p3.4.m4.1"><semantics id="S3.SS4.p3.4.m4.1a"><msubsup id="S3.SS4.p3.4.m4.1.2" xref="S3.SS4.p3.4.m4.1.2.cmml"><mi id="S3.SS4.p3.4.m4.1.2.2.2" xref="S3.SS4.p3.4.m4.1.2.2.2.cmml">p</mi><mtext id="S3.SS4.p3.4.m4.1.2.2.3" xref="S3.SS4.p3.4.m4.1.2.2.3a.cmml">emp</mtext><mrow id="S3.SS4.p3.4.m4.1.1.1.1" xref="S3.SS4.p3.4.m4.1.1.1.1.1.cmml"><mo id="S3.SS4.p3.4.m4.1.1.1.1.2" stretchy="false" xref="S3.SS4.p3.4.m4.1.1.1.1.1.cmml">(</mo><msub id="S3.SS4.p3.4.m4.1.1.1.1.1" xref="S3.SS4.p3.4.m4.1.1.1.1.1.cmml"><mi id="S3.SS4.p3.4.m4.1.1.1.1.1.2" xref="S3.SS4.p3.4.m4.1.1.1.1.1.2.cmml">b</mi><mi id="S3.SS4.p3.4.m4.1.1.1.1.1.3" xref="S3.SS4.p3.4.m4.1.1.1.1.1.3.cmml">i</mi></msub><mo id="S3.SS4.p3.4.m4.1.1.1.1.3" stretchy="false" xref="S3.SS4.p3.4.m4.1.1.1.1.1.cmml">)</mo></mrow></msubsup><annotation-xml encoding="MathML-Content" id="S3.SS4.p3.4.m4.1b"><apply id="S3.SS4.p3.4.m4.1.2.cmml" xref="S3.SS4.p3.4.m4.1.2"><csymbol cd="ambiguous" id="S3.SS4.p3.4.m4.1.2.1.cmml" xref="S3.SS4.p3.4.m4.1.2">superscript</csymbol><apply id="S3.SS4.p3.4.m4.1.2.2.cmml" xref="S3.SS4.p3.4.m4.1.2"><csymbol cd="ambiguous" id="S3.SS4.p3.4.m4.1.2.2.1.cmml" xref="S3.SS4.p3.4.m4.1.2">subscript</csymbol><ci id="S3.SS4.p3.4.m4.1.2.2.2.cmml" xref="S3.SS4.p3.4.m4.1.2.2.2">𝑝</ci><ci id="S3.SS4.p3.4.m4.1.2.2.3a.cmml" xref="S3.SS4.p3.4.m4.1.2.2.3"><mtext id="S3.SS4.p3.4.m4.1.2.2.3.cmml" mathsize="70%" xref="S3.SS4.p3.4.m4.1.2.2.3">emp</mtext></ci></apply><apply id="S3.SS4.p3.4.m4.1.1.1.1.1.cmml" xref="S3.SS4.p3.4.m4.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS4.p3.4.m4.1.1.1.1.1.1.cmml" xref="S3.SS4.p3.4.m4.1.1.1.1">subscript</csymbol><ci id="S3.SS4.p3.4.m4.1.1.1.1.1.2.cmml" xref="S3.SS4.p3.4.m4.1.1.1.1.1.2">𝑏</ci><ci id="S3.SS4.p3.4.m4.1.1.1.1.1.3.cmml" xref="S3.SS4.p3.4.m4.1.1.1.1.1.3">𝑖</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p3.4.m4.1c">p_{\text{emp}}^{(b_{i})}</annotation><annotation encoding="application/x-llamapun" id="S3.SS4.p3.4.m4.1d">italic_p start_POSTSUBSCRIPT emp end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ( italic_b start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT ) end_POSTSUPERSCRIPT</annotation></semantics></math> in Equation <a class="ltx_ref" href="https://arxiv.org/html/2409.12535v1#S3.E3" title="In III-C Evaluation metrics ‣ III Material and methods ‣ Deep Probability Segmentation: Are segmentation models probability estimators?"><span class="ltx_text ltx_ref_tag">3</span></a>. This method can be efficiently executed by arranging the predictions <math alttext="p_{i}" class="ltx_Math" display="inline" id="S3.SS4.p3.5.m5.1"><semantics id="S3.SS4.p3.5.m5.1a"><msub id="S3.SS4.p3.5.m5.1.1" xref="S3.SS4.p3.5.m5.1.1.cmml"><mi id="S3.SS4.p3.5.m5.1.1.2" xref="S3.SS4.p3.5.m5.1.1.2.cmml">p</mi><mi id="S3.SS4.p3.5.m5.1.1.3" xref="S3.SS4.p3.5.m5.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS4.p3.5.m5.1b"><apply id="S3.SS4.p3.5.m5.1.1.cmml" xref="S3.SS4.p3.5.m5.1.1"><csymbol cd="ambiguous" id="S3.SS4.p3.5.m5.1.1.1.cmml" xref="S3.SS4.p3.5.m5.1.1">subscript</csymbol><ci id="S3.SS4.p3.5.m5.1.1.2.cmml" xref="S3.SS4.p3.5.m5.1.1.2">𝑝</ci><ci id="S3.SS4.p3.5.m5.1.1.3.cmml" xref="S3.SS4.p3.5.m5.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p3.5.m5.1c">p_{i}</annotation><annotation encoding="application/x-llamapun" id="S3.SS4.p3.5.m5.1d">italic_p start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT</annotation></semantics></math>. The calibration loss necessitates a reasonable estimation of the empirical probabilities <math alttext="p_{\text{emp}}(i)" class="ltx_Math" display="inline" id="S3.SS4.p3.6.m6.1"><semantics id="S3.SS4.p3.6.m6.1a"><mrow id="S3.SS4.p3.6.m6.1.2" xref="S3.SS4.p3.6.m6.1.2.cmml"><msub id="S3.SS4.p3.6.m6.1.2.2" xref="S3.SS4.p3.6.m6.1.2.2.cmml"><mi id="S3.SS4.p3.6.m6.1.2.2.2" xref="S3.SS4.p3.6.m6.1.2.2.2.cmml">p</mi><mtext id="S3.SS4.p3.6.m6.1.2.2.3" xref="S3.SS4.p3.6.m6.1.2.2.3a.cmml">emp</mtext></msub><mo id="S3.SS4.p3.6.m6.1.2.1" xref="S3.SS4.p3.6.m6.1.2.1.cmml">⁢</mo><mrow id="S3.SS4.p3.6.m6.1.2.3.2" xref="S3.SS4.p3.6.m6.1.2.cmml"><mo id="S3.SS4.p3.6.m6.1.2.3.2.1" stretchy="false" xref="S3.SS4.p3.6.m6.1.2.cmml">(</mo><mi id="S3.SS4.p3.6.m6.1.1" xref="S3.SS4.p3.6.m6.1.1.cmml">i</mi><mo id="S3.SS4.p3.6.m6.1.2.3.2.2" stretchy="false" xref="S3.SS4.p3.6.m6.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS4.p3.6.m6.1b"><apply id="S3.SS4.p3.6.m6.1.2.cmml" xref="S3.SS4.p3.6.m6.1.2"><times id="S3.SS4.p3.6.m6.1.2.1.cmml" xref="S3.SS4.p3.6.m6.1.2.1"></times><apply id="S3.SS4.p3.6.m6.1.2.2.cmml" xref="S3.SS4.p3.6.m6.1.2.2"><csymbol cd="ambiguous" id="S3.SS4.p3.6.m6.1.2.2.1.cmml" xref="S3.SS4.p3.6.m6.1.2.2">subscript</csymbol><ci id="S3.SS4.p3.6.m6.1.2.2.2.cmml" xref="S3.SS4.p3.6.m6.1.2.2.2">𝑝</ci><ci id="S3.SS4.p3.6.m6.1.2.2.3a.cmml" xref="S3.SS4.p3.6.m6.1.2.2.3"><mtext id="S3.SS4.p3.6.m6.1.2.2.3.cmml" mathsize="70%" xref="S3.SS4.p3.6.m6.1.2.2.3">emp</mtext></ci></apply><ci id="S3.SS4.p3.6.m6.1.1.cmml" xref="S3.SS4.p3.6.m6.1.1">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p3.6.m6.1c">p_{\text{emp}}(i)</annotation><annotation encoding="application/x-llamapun" id="S3.SS4.p3.6.m6.1d">italic_p start_POSTSUBSCRIPT emp end_POSTSUBSCRIPT ( italic_i )</annotation></semantics></math>, which can be derived from the model after initial training.</p>
</div>
</section>
<section class="ltx_subsection" id="S3.SS5">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection"><span class="ltx_text" id="S3.SS5.4.1.1">III-E</span> </span><span class="ltx_text ltx_font_italic" id="S3.SS5.5.2">Experimental design</span>
</h3>
<div class="ltx_para" id="S3.SS5.p1">
<p class="ltx_p" id="S3.SS5.p1.1">To determine the ability of the segmentation model to estimate the probability behind the data, we examine the performance differences between a traditional training pipeline and training the same architecture with the CaPE strategy.</p>
</div>
<div class="ltx_para" id="S3.SS5.p2">
<p class="ltx_p" id="S3.SS5.p2.1">For all experiments, we chose a U-Net <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.12535v1#bib.bib10" title="">10</a>]</cite> as the segmentation model because it performs best for similar tasks in limited data domains <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.12535v1#bib.bib11" title="">11</a>]</cite>. Our entire pipeline is not dependent on this choice. We, therefore, also chose this model because it serves as a solid foundation for the segmentation task, and the results obtained with this architecture can potentially be transferred to other related architectures.</p>
</div>
<div class="ltx_para" id="S3.SS5.p3">
<p class="ltx_p" id="S3.SS5.p3.1">Our network has a symmetrical 5-block structure with an encoder and a decoder. The encoding path sequentially reduces the spatial dimensions of the feature maps while increasing the number of channels, starting with 64 channels and doubling with each step until 1024 channels are reached. This process allows the network to capture increasingly abstract and detailed features. The decoder path then upsamples these feature maps back to the original input resolution and reverses the encoder process. Notably, our implementation does not use skip connections, which are typically used in U-Net architectures to combine high-resolution features from the encoder with high-sampled features in the decoder. The final output layer of the network generates a segmentation mask in which the intensity of each pixel indicates the probability that it exceeds the predefined threshold. This structure allows us to effectively analyze and segment the input data based on the learned features.
As a loss function, we use the BCE loss, a common choice for binary segmentation tasks.</p>
</div>
<div class="ltx_para" id="S3.SS5.p4">
<p class="ltx_p" id="S3.SS5.p4.1">The training was performed on a system equipped with 128 GB RAM and an NVIDIA Tesla V100 GPU with 16 GB memory. We trained over 50 epochs with the Adam optimizer and a learning rate of 0.0001. The early stopping strategy is applied to the validation loss, with a patience of 15 epochs and a minimum delta of <math alttext="0" class="ltx_Math" display="inline" id="S3.SS5.p4.1.m1.1"><semantics id="S3.SS5.p4.1.m1.1a"><mn id="S3.SS5.p4.1.m1.1.1" xref="S3.SS5.p4.1.m1.1.1.cmml">0</mn><annotation-xml encoding="MathML-Content" id="S3.SS5.p4.1.m1.1b"><cn id="S3.SS5.p4.1.m1.1.1.cmml" type="integer" xref="S3.SS5.p4.1.m1.1.1">0</cn></annotation-xml></semantics></math>. To evaluate the model’s performance, we used a 9-fold cross-validation approach: 7 folds were used as the training set, 1 fold as the validation set, and 1 fold as the test set. All results are finally aggregated from the test sets of each fold. The code used to perform the experiments is available upon request.</p>
</div>
</section>
</section>
<section class="ltx_section" id="S4">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">IV </span><span class="ltx_text ltx_font_smallcaps" id="S4.1.1">Results and discussions</span>
</h2>
<div class="ltx_para" id="S4.p1">
<p class="ltx_p" id="S4.p1.1">One of the main questions is whether the advantages of the CaPE strategy still apply to the segmentation task. To clarify this point, Figure <a class="ltx_ref" href="https://arxiv.org/html/2409.12535v1#S4.F1" title="Figure 1 ‣ IV Results and discussions ‣ Deep Probability Segmentation: Are segmentation models probability estimators?"><span class="ltx_text ltx_ref_tag">1</span></a> shows the learning curve of the model over the first 50 epochs. The black arrow shows the point at which early stopping detected an overfitting validation loss, triggering the start of CaPE application. The red curves represent a model trained with the combined losses in Equation <a class="ltx_ref" href="https://arxiv.org/html/2409.12535v1#S3.E8" title="In III-D CaPE regularization ‣ III Material and methods ‣ Deep Probability Segmentation: Are segmentation models probability estimators?"><span class="ltx_text ltx_ref_tag">8</span></a>, while the blue curves represent the model trained with <math alttext="\mathcal{L}_{D}" class="ltx_Math" display="inline" id="S4.p1.1.m1.1"><semantics id="S4.p1.1.m1.1a"><msub id="S4.p1.1.m1.1.1" xref="S4.p1.1.m1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.p1.1.m1.1.1.2" xref="S4.p1.1.m1.1.1.2.cmml">ℒ</mi><mi id="S4.p1.1.m1.1.1.3" xref="S4.p1.1.m1.1.1.3.cmml">D</mi></msub><annotation-xml encoding="MathML-Content" id="S4.p1.1.m1.1b"><apply id="S4.p1.1.m1.1.1.cmml" xref="S4.p1.1.m1.1.1"><csymbol cd="ambiguous" id="S4.p1.1.m1.1.1.1.cmml" xref="S4.p1.1.m1.1.1">subscript</csymbol><ci id="S4.p1.1.m1.1.1.2.cmml" xref="S4.p1.1.m1.1.1.2">ℒ</ci><ci id="S4.p1.1.m1.1.1.3.cmml" xref="S4.p1.1.m1.1.1.3">𝐷</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.p1.1.m1.1c">\mathcal{L}_{D}</annotation><annotation encoding="application/x-llamapun" id="S4.p1.1.m1.1d">caligraphic_L start_POSTSUBSCRIPT italic_D end_POSTSUBSCRIPT</annotation></semantics></math> after early stopping. The presented training refers to the GWS dataset with the following parameters: dataset size of 1500, number of bins set to 20, and a threshold of 0.250 mm/h. We present this setting because, according to our experiments, it represents an average case.
In the remainder of this analysis, we will look in detail at the contribution of calibration on the distribution of dataset labels and other relevant hyperparameters.</p>
</div>
<figure class="ltx_figure" id="S4.F1"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="617" id="S4.F1.g1" src="x1.png" width="829"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 1: </span>Comparison between the learning curves of BCE minimization and CaPE over 50 epochs, smoothed with a 3-epoch moving average. The numbers from left to right are the training loss, validation loss, Brier score and KL divergence, respectively. The softer lines represent the raw data. The CaPE method starts with the minimum of the validation loss. From this point onwards, the effect compared to BCE training is evident.</figcaption>
</figure>
<div class="ltx_para" id="S4.p2">
<p class="ltx_p" id="S4.p2.1">We find that both training and validation losses initially decrease. Then, CaPE regularization limits overfitting for about ten epochs after its first application. This indicates that it can stabilize the training and provide slightly better results than the unregularized model. However, this improvement does not reflect a significant reduction in Brier score and KL divergence. This behavior is clearly different from what was observed in non-segmentation tasks, suggesting that segmentation models may be inherently better calibrated than other architectures evaluated in this work.</p>
</div>
<div class="ltx_para" id="S4.p3">
<p class="ltx_p" id="S4.p3.1">At this point, we focused our experiments on describing the different contributions of the CaPE method when the threshold, and thus the distribution of the event we want to predict, changes. In particular, we investigated how different threshold settings affect model calibration and uncertainty estimates when the size of the training dataset varies. These two parameters regulate the distribution of positive labels and may provide different contributions to the regularization strategy.</p>
</div>
<figure class="ltx_figure" id="S4.F2"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_square" height="1021" id="S4.F2.g1" src="x2.png" width="831"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 2: </span>Comparison of the Expected Calibration Error (ECE) for the GWS and BAD datasets across different dataset sizes. The solid lines represent the results after applying the CaPE method, while the dashed lines represent the results with early stopping.</figcaption>
</figure>
<div class="ltx_para" id="S4.p4">
<p class="ltx_p" id="S4.p4.1">Figure <a class="ltx_ref" href="https://arxiv.org/html/2409.12535v1#S4.F2" title="Figure 2 ‣ IV Results and discussions ‣ Deep Probability Segmentation: Are segmentation models probability estimators?"><span class="ltx_text ltx_ref_tag">2</span></a> shows the best value of ECE achieved by the models over the variable threshold probability for both datasets under analysis.
Based on the upper graph, we observe a positive correlation between ECE and the probability of exceeding the threshold in the GWS dataset. This suggests that as the probability of exceeding the weather threshold increases, the calibration error also tends to increase, indicating greater uncertainty in these forecasts. This finding is crucial as it highlights a potential challenge in achieving well-calibrated probabilities under conditions of high uncertainty. In particular, when the model predicts a high probability of extreme weather events, the uncertainty in these predictions becomes larger, leading to higher calibration errors. Remarkably, the discrepancies between CaPE and non-CaPE results increase with the threshold value, especially for curves representing large training sets.</p>
</div>
<div class="ltx_para" id="S4.p5">
<p class="ltx_p" id="S4.p5.1">In contrast, the BAD dataset does not reflect the positive correlation between threshold and ECE. In this dataset, there were fewer possible thresholds that were more likely to be exceeded than in the GWS dataset. This discrepancy could be due to the nature of the data and the distribution of events in the BAD dataset. In particular, we can assume that the higher probability of exceeding the thresholds could simplify the prediction task and reduce the calibration error. In addition, the model’s difficulty distinguishing between the first and subsequent severity levels could also contribute to this behavior, suggesting that the model may perform better when the event distribution is less complex. It is worth noting that CaPE makes no significant contributions in this dataset, except at the smallest size of the training dataset.</p>
</div>
<div class="ltx_para" id="S4.p6">
<p class="ltx_p" id="S4.p6.1">As for ECE, Figure <a class="ltx_ref" href="https://arxiv.org/html/2409.12535v1#S4.F3" title="Figure 3 ‣ IV Results and discussions ‣ Deep Probability Segmentation: Are segmentation models probability estimators?"><span class="ltx_text ltx_ref_tag">3</span></a> illustrates the behaviour of KL divergence when the threshold probability varies. We observe a much smaller variation in KL divergence compared to the previous plot, especially for the GWS dataset. Overall, we can conclude that the contribution of CaPE in this metric is negligible in most cases. Furthermore, it is interesting to note that the two metrics are still highly correlated: the trends in the KL divergence graphs are very similar to those in the ECE graphs in Figure  <a class="ltx_ref" href="https://arxiv.org/html/2409.12535v1#S4.F2" title="Figure 2 ‣ IV Results and discussions ‣ Deep Probability Segmentation: Are segmentation models probability estimators?"><span class="ltx_text ltx_ref_tag">2</span></a>. This similarity suggests that both metrics capture related aspects of model performance despite their different formulations.
Both Figures  <a class="ltx_ref" href="https://arxiv.org/html/2409.12535v1#S4.F2" title="Figure 2 ‣ IV Results and discussions ‣ Deep Probability Segmentation: Are segmentation models probability estimators?"><span class="ltx_text ltx_ref_tag">2</span></a> and  <a class="ltx_ref" href="https://arxiv.org/html/2409.12535v1#S4.F3" title="Figure 3 ‣ IV Results and discussions ‣ Deep Probability Segmentation: Are segmentation models probability estimators?"><span class="ltx_text ltx_ref_tag">3</span></a> show data for a bin number of 20 for the CaPE method. We found that different numbers of bins in our experiments would lead to similar results overall, apart from minor local differences.</p>
</div>
<figure class="ltx_figure" id="S4.F3"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_square" height="1021" id="S4.F3.g1" src="x3.png" width="831"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 3: </span>Comparison of KL for the GWS and BAD datasets across different dataset sizes. The solid lines represent the results after applying the CaPE method, while the dashed lines represent the results with early stopping.</figcaption>
</figure>
<div class="ltx_para" id="S4.p7">
<p class="ltx_p" id="S4.p7.1">Finally, this analysis also shows no significant correlation between the size of the data set, the threshold, and the number of bins on the effectiveness of the CaPE method. These parameters appear to be highly task-dependent, suggesting that their influence depends on the nature of the task in question. For example, while the number of bins may be critical for one dataset, it may not have the same impact on another dataset with different characteristics. This task dependency emphasizes the importance of tailoring the calibration approach to the specific requirements and characteristics of the dataset.</p>
</div>
<div class="ltx_para" id="S4.p8">
<p class="ltx_p" id="S4.p8.1">This observation highlights the effectiveness of the calibration strategy, but also suggests that both regularization against overfitting and calibration of probabilities in segmentation tasks seem to have a smaller effect compared to traditional problems, as shown by Liu et al. <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.12535v1#bib.bib1" title="">1</a>]</cite>. This result suggests the intriguing possibility that segmentation models are inherently better calibrated, possibly due to the non-i.i.d. nature of pixels in image data in such tasks.</p>
</div>
</section>
<section class="ltx_section" id="S5">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">V </span><span class="ltx_text ltx_font_smallcaps" id="S5.1.1">Conclusions</span>
</h2>
<div class="ltx_para" id="S5.p1">
<p class="ltx_p" id="S5.p1.1">In this study, we investigated the application of the Calibrated Probability Estimation (CaPE) method to segmentation tasks specifically targeting weather forecasting and fire area detection. Our experiments have shown that while CaPE offers some advantages in model calibration, its impact is less pronounced than classification tasks. This result suggests that certain segmentation datasets inherently provide well-calibrated probability estimates.
A key advantage of CaPE was its role in preventing overfitting by acting as a regularization technique. Despite minimal improvements in metrics such as KL and Brier score, CaPE effectively maintained calibration and improved the robustness of the model to overfitting.
Further research will aim to corroborate these results by extending this setting to more diverse datasets, such as medical images. In these applications, accurate probability estimation is crucial for segmentation, and the general scarcity of high-quality data poses a major challenge. Exploring the effectiveness of the CaPE method or other calibration techniques, such as semantic-aware grouping <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2409.12535v1#bib.bib12" title="">12</a>]</cite>, will provide deeper insights into its potential and limitations in these scenarios. This will ultimately contribute to developing more reliable and well-calibrated segmentation models.</p>
</div>
</section>
<section class="ltx_bibliography" id="bib">
<h2 class="ltx_title ltx_title_bibliography">References</h2>
<ul class="ltx_biblist">
<li class="ltx_bibitem" id="bib.bib1">
<span class="ltx_tag ltx_tag_bibitem">[1]</span>
<span class="ltx_bibblock">
S. Liu, A. Kaku, W. Zhu, M. Leibovich, S. Mohan, B. Yu, H. Huang, L. Zanna, N. Razavian, J. Niles-Weed <em class="ltx_emph ltx_font_italic" id="bib.bib1.1.1">et al.</em>, “Deep probability estimation,” <em class="ltx_emph ltx_font_italic" id="bib.bib1.2.2">arXiv preprint arXiv:2111.10734</em>, 2021.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib2">
<span class="ltx_tag ltx_tag_bibitem">[2]</span>
<span class="ltx_bibblock">
C. Guo, G. Pleiss, Y. Sun, and K. Q. Weinberger, “On calibration of modern neural networks,” in <em class="ltx_emph ltx_font_italic" id="bib.bib2.1.1">International conference on machine learning</em>.   PMLR, 2017, pp. 1321–1330.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib3">
<span class="ltx_tag ltx_tag_bibitem">[3]</span>
<span class="ltx_bibblock">
V. Kuleshov, N. Fenner, and S. Ermon, “Accurate uncertainties for deep learning using calibrated regression,” in <em class="ltx_emph ltx_font_italic" id="bib.bib3.1.1">International conference on machine learning</em>.   PMLR, 2018, pp. 2796–2804.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib4">
<span class="ltx_tag ltx_tag_bibitem">[4]</span>
<span class="ltx_bibblock">
J. Zhang, B. Kailkhura, and T. Y.-J. Han, “Mix-n-match: Ensemble and compositional methods for uncertainty calibration in deep learning,” in <em class="ltx_emph ltx_font_italic" id="bib.bib4.1.1">International conference on machine learning</em>.   PMLR, 2020, pp. 11 117–11 128.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib5">
<span class="ltx_tag ltx_tag_bibitem">[5]</span>
<span class="ltx_bibblock">
S. Kohl, B. Romera-Paredes, C. Meyer, J. De Fauw, J. R. Ledsam, K. Maier-Hein, S. Eslami, D. Jimenez Rezende, and O. Ronneberger, “A probabilistic u-net for segmentation of ambiguous images,” <em class="ltx_emph ltx_font_italic" id="bib.bib5.1.1">Advances in neural information processing systems</em>, vol. 31, 2018.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib6">
<span class="ltx_tag ltx_tag_bibitem">[6]</span>
<span class="ltx_bibblock">
M. C. Krygier, T. LaBonte, C. Martinez, C. Norris, K. Sharma, L. N. Collins, P. P. Mukherjee, and S. A. Roberts, “Quantifying the unknown impact of segmentation uncertainty on image-based simulations,” <em class="ltx_emph ltx_font_italic" id="bib.bib6.1.1">Nature communications</em>, vol. 12, no. 1, p. 5414, 2021.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib7">
<span class="ltx_tag ltx_tag_bibitem">[7]</span>
<span class="ltx_bibblock">
W. Hu, M. Ghazvinian, W. E. Chapman, A. Sengupta, F. M. Ralph, and L. Delle Monache, “Deep learning forecast uncertainty for precipitation over the western united states,” <em class="ltx_emph ltx_font_italic" id="bib.bib7.1.1">Monthly Weather Review</em>, vol. 151, no. 6, pp. 1367–1385, 2023.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib8">
<span class="ltx_tag ltx_tag_bibitem">[8]</span>
<span class="ltx_bibblock">
S. Monaco, S. Greco, A. Farasin, L. Colomba, D. Apiletti, P. Garza, T. Cerquitelli, and E. Baralis, “Attention to fires: Multi-channel deep learning models for wildfire severity prediction,” <em class="ltx_emph ltx_font_italic" id="bib.bib8.1.1">Applied Sciences</em>, vol. 11, no. 22, p. 11060, 2021.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib9">
<span class="ltx_tag ltx_tag_bibitem">[9]</span>
<span class="ltx_bibblock">
L. Colomba, A. Farasin, S. Monaco, S. Greco, P. Garza, D. Apiletti, E. Baralis, and T. Cerquitelli, “A dataset for burned area delineation and severity estimation from satellite imagery,” in <em class="ltx_emph ltx_font_italic" id="bib.bib9.1.1">Proceedings of the 31st ACM International Conference on Information &amp; Knowledge Management</em>, 2022, pp. 3893–3897.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib10">
<span class="ltx_tag ltx_tag_bibitem">[10]</span>
<span class="ltx_bibblock">
O. Ronneberger, P. Fischer, and T. Brox, “U-net: Convolutional networks for biomedical image segmentation,” in <em class="ltx_emph ltx_font_italic" id="bib.bib10.1.1">Medical image computing and computer-assisted intervention–MICCAI 2015: 18th international conference, Munich, Germany, October 5-9, 2015, proceedings, part III 18</em>.   Springer, 2015, pp. 234–241.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib11">
<span class="ltx_tag ltx_tag_bibitem">[11]</span>
<span class="ltx_bibblock">
R. Wang, T. Lei, R. Cui, B. Zhang, H. Meng, and A. K. Nandi, “Medical image segmentation using deep learning: A survey,” <em class="ltx_emph ltx_font_italic" id="bib.bib11.1.1">IET Image Processing</em>, vol. 16, no. 5, pp. 1243–1267, 2022.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib12">
<span class="ltx_tag ltx_tag_bibitem">[12]</span>
<span class="ltx_bibblock">
J.-Q. Yang, D.-C. Zhan, and L. Gan, “Beyond probability partitions: Calibrating neural networks with semantic aware grouping,” <em class="ltx_emph ltx_font_italic" id="bib.bib12.1.1">Advances in Neural Information Processing Systems</em>, vol. 36, 2024.

</span>
</li>
</ul>
</section>
</article>
</div>
<footer class="ltx_page_footer">
<div class="ltx_page_logo">Generated  on Thu Sep 19 07:48:41 2024 by <a class="ltx_LaTeXML_logo" href="http://dlmf.nist.gov/LaTeXML/"><span style="letter-spacing:-0.2em; margin-right:0.1em;">L<span class="ltx_font_smallcaps" style="position:relative; bottom:2.2pt;">a</span>T<span class="ltx_font_smallcaps" style="font-size:120%;position:relative; bottom:-0.2ex;">e</span></span><span style="font-size:90%; position:relative; bottom:-0.2ex;">XML</span><img alt="Mascot Sammy" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAsAAAAOCAYAAAD5YeaVAAAAAXNSR0IArs4c6QAAAAZiS0dEAP8A/wD/oL2nkwAAAAlwSFlzAAALEwAACxMBAJqcGAAAAAd0SU1FB9wKExQZLWTEaOUAAAAddEVYdENvbW1lbnQAQ3JlYXRlZCB3aXRoIFRoZSBHSU1Q72QlbgAAAdpJREFUKM9tkL+L2nAARz9fPZNCKFapUn8kyI0e4iRHSR1Kb8ng0lJw6FYHFwv2LwhOpcWxTjeUunYqOmqd6hEoRDhtDWdA8ApRYsSUCDHNt5ul13vz4w0vWCgUnnEc975arX6ORqN3VqtVZbfbTQC4uEHANM3jSqXymFI6yWazP2KxWAXAL9zCUa1Wy2tXVxheKA9YNoR8Pt+aTqe4FVVVvz05O6MBhqUIBGk8Hn8HAOVy+T+XLJfLS4ZhTiRJgqIoVBRFIoric47jPnmeB1mW/9rr9ZpSSn3Lsmir1fJZlqWlUonKsvwWwD8ymc/nXwVBeLjf7xEKhdBut9Hr9WgmkyGEkJwsy5eHG5vN5g0AKIoCAEgkEkin0wQAfN9/cXPdheu6P33fBwB4ngcAcByHJpPJl+fn54mD3Gg0NrquXxeLRQAAwzAYj8cwTZPwPH9/sVg8PXweDAauqqr2cDjEer1GJBLBZDJBs9mE4zjwfZ85lAGg2+06hmGgXq+j3+/DsixYlgVN03a9Xu8jgCNCyIegIAgx13Vfd7vdu+FweG8YRkjXdWy329+dTgeSJD3ieZ7RNO0VAXAPwDEAO5VKndi2fWrb9jWl9Esul6PZbDY9Go1OZ7PZ9z/lyuD3OozU2wAAAABJRU5ErkJggg=="/></a>
</div></footer>
</div>
</body>
</html>
