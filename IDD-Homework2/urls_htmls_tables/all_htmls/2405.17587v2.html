<!DOCTYPE html>
<html lang="en">
<head>
<meta content="text/html; charset=utf-8" http-equiv="content-type"/>
<title>RAGSys: Item-Cold-Start Recommender as RAG System</title>
<!--Generated on Thu Aug 15 22:28:44 2024 by LaTeXML (version 0.8.8) http://dlmf.nist.gov/LaTeXML/.-->
<meta content="width=device-width, initial-scale=1, shrink-to-fit=no" name="viewport"/>
<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet" type="text/css"/>
<link href="/static/browse/0.3.4/css/ar5iv.0.7.9.min.css" rel="stylesheet" type="text/css"/>
<link href="/static/browse/0.3.4/css/ar5iv-fonts.0.7.9.min.css" rel="stylesheet" type="text/css"/>
<link href="/static/browse/0.3.4/css/latexml_styles.css" rel="stylesheet" type="text/css"/>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.3.3/html2canvas.min.js"></script>
<script src="/static/browse/0.3.4/js/addons_new.js"></script>
<script src="/static/browse/0.3.4/js/feedbackOverlay.js"></script>
<base href="/html/2405.17587v2/"/></head>
<body>
<nav class="ltx_page_navbar">
<nav class="ltx_TOC">
<ol class="ltx_toclist">
<li class="ltx_tocentry ltx_tocentry_section"><a class="ltx_ref" href="https://arxiv.org/html/2405.17587v2#S1" title="In RAGSys: Item-Cold-Start Recommender as RAG System"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">1 </span>Introduction</span></a></li>
<li class="ltx_tocentry ltx_tocentry_section">
<a class="ltx_ref" href="https://arxiv.org/html/2405.17587v2#S2" title="In RAGSys: Item-Cold-Start Recommender as RAG System"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">2 </span>Related Work</span></a>
<ol class="ltx_toclist ltx_toclist_section">
<li class="ltx_tocentry ltx_tocentry_subsection">
<a class="ltx_ref" href="https://arxiv.org/html/2405.17587v2#S2.SS1" title="In 2 Related Work ‣ RAGSys: Item-Cold-Start Recommender as RAG System"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">2.1 </span>Few-Shot In-Context Learning with Retrieval Augmented Generation</span></a>
<ol class="ltx_toclist ltx_toclist_subsection">
<li class="ltx_tocentry ltx_tocentry_subsubsection"><a class="ltx_ref" href="https://arxiv.org/html/2405.17587v2#S2.SS1.SSS1" title="In 2.1 Few-Shot In-Context Learning with Retrieval Augmented Generation ‣ 2 Related Work ‣ RAGSys: Item-Cold-Start Recommender as RAG System"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">2.1.1 </span>Pure Diversity</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsubsection"><a class="ltx_ref" href="https://arxiv.org/html/2405.17587v2#S2.SS1.SSS2" title="In 2.1 Few-Shot In-Context Learning with Retrieval Augmented Generation ‣ 2 Related Work ‣ RAGSys: Item-Cold-Start Recommender as RAG System"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">2.1.2 </span>Pure Quality</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsubsection"><a class="ltx_ref" href="https://arxiv.org/html/2405.17587v2#S2.SS1.SSS3" title="In 2.1 Few-Shot In-Context Learning with Retrieval Augmented Generation ‣ 2 Related Work ‣ RAGSys: Item-Cold-Start Recommender as RAG System"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">2.1.3 </span>Pure Relevance</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsubsection"><a class="ltx_ref" href="https://arxiv.org/html/2405.17587v2#S2.SS1.SSS4" title="In 2.1 Few-Shot In-Context Learning with Retrieval Augmented Generation ‣ 2 Related Work ‣ RAGSys: Item-Cold-Start Recommender as RAG System"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">2.1.4 </span>Diversity/Relevance Trade-off</span></a></li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_subsection">
<a class="ltx_ref" href="https://arxiv.org/html/2405.17587v2#S2.SS2" title="In 2 Related Work ‣ RAGSys: Item-Cold-Start Recommender as RAG System"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">2.2 </span>Diversity in Information Retrieval and Online Learning</span></a>
<ol class="ltx_toclist ltx_toclist_subsection">
<li class="ltx_tocentry ltx_tocentry_subsubsection"><a class="ltx_ref" href="https://arxiv.org/html/2405.17587v2#S2.SS2.SSS1" title="In 2.2 Diversity in Information Retrieval and Online Learning ‣ 2 Related Work ‣ RAGSys: Item-Cold-Start Recommender as RAG System"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">2.2.1 </span>In Information Retrieval</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsubsection"><a class="ltx_ref" href="https://arxiv.org/html/2405.17587v2#S2.SS2.SSS2" title="In 2.2 Diversity in Information Retrieval and Online Learning ‣ 2 Related Work ‣ RAGSys: Item-Cold-Start Recommender as RAG System"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">2.2.2 </span>In Recommender Systems</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsubsection"><a class="ltx_ref" href="https://arxiv.org/html/2405.17587v2#S2.SS2.SSS3" title="In 2.2 Diversity in Information Retrieval and Online Learning ‣ 2 Related Work ‣ RAGSys: Item-Cold-Start Recommender as RAG System"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">2.2.3 </span>In Online Learning</span></a></li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_subsection">
<a class="ltx_ref" href="https://arxiv.org/html/2405.17587v2#S2.SS3" title="In 2 Related Work ‣ RAGSys: Item-Cold-Start Recommender as RAG System"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">2.3 </span>Quality Biases in Information Retrieval</span></a>
<ol class="ltx_toclist ltx_toclist_subsection">
<li class="ltx_tocentry ltx_tocentry_subsubsection"><a class="ltx_ref" href="https://arxiv.org/html/2405.17587v2#S2.SS3.SSS1" title="In 2.3 Quality Biases in Information Retrieval ‣ 2 Related Work ‣ RAGSys: Item-Cold-Start Recommender as RAG System"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">2.3.1 </span>Content-Based Quality Biases</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsubsection"><a class="ltx_ref" href="https://arxiv.org/html/2405.17587v2#S2.SS3.SSS2" title="In 2.3 Quality Biases in Information Retrieval ‣ 2 Related Work ‣ RAGSys: Item-Cold-Start Recommender as RAG System"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">2.3.2 </span>Graph-Based Quality Biases</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsubsection"><a class="ltx_ref" href="https://arxiv.org/html/2405.17587v2#S2.SS3.SSS3" title="In 2.3 Quality Biases in Information Retrieval ‣ 2 Related Work ‣ RAGSys: Item-Cold-Start Recommender as RAG System"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">2.3.3 </span>Connections to Recommender Systems</span></a></li>
</ol>
</li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_section">
<a class="ltx_ref" href="https://arxiv.org/html/2405.17587v2#S3" title="In RAGSys: Item-Cold-Start Recommender as RAG System"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3 </span>Methodology</span></a>
<ol class="ltx_toclist ltx_toclist_section">
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2405.17587v2#S3.SS1" title="In 3 Methodology ‣ RAGSys: Item-Cold-Start Recommender as RAG System"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3.1 </span>Problem Statement</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection">
<a class="ltx_ref" href="https://arxiv.org/html/2405.17587v2#S3.SS2" title="In 3 Methodology ‣ RAGSys: Item-Cold-Start Recommender as RAG System"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3.2 </span>Evaluation</span></a>
<ol class="ltx_toclist ltx_toclist_subsection">
<li class="ltx_tocentry ltx_tocentry_subsubsection"><a class="ltx_ref" href="https://arxiv.org/html/2405.17587v2#S3.SS2.SSS1" title="In 3.2 Evaluation ‣ 3 Methodology ‣ RAGSys: Item-Cold-Start Recommender as RAG System"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3.2.1 </span>Classification Metrics</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsubsection"><a class="ltx_ref" href="https://arxiv.org/html/2405.17587v2#S3.SS2.SSS2" title="In 3.2 Evaluation ‣ 3 Methodology ‣ RAGSys: Item-Cold-Start Recommender as RAG System"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3.2.2 </span>Direct Preference Optimization Metric</span></a></li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_subsection">
<a class="ltx_ref" href="https://arxiv.org/html/2405.17587v2#S3.SS3" title="In 3 Methodology ‣ RAGSys: Item-Cold-Start Recommender as RAG System"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3.3 </span>Retrieval Algorithm</span></a>
<ol class="ltx_toclist ltx_toclist_subsection">
<li class="ltx_tocentry ltx_tocentry_subsubsection"><a class="ltx_ref" href="https://arxiv.org/html/2405.17587v2#S3.SS3.SSS1" title="In 3.3 Retrieval Algorithm ‣ 3 Methodology ‣ RAGSys: Item-Cold-Start Recommender as RAG System"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3.3.1 </span>Query Relevance</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsubsection"><a class="ltx_ref" href="https://arxiv.org/html/2405.17587v2#S3.SS3.SSS2" title="In 3.3 Retrieval Algorithm ‣ 3 Methodology ‣ RAGSys: Item-Cold-Start Recommender as RAG System"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3.3.2 </span>Retrieved Demonstrations Diversity</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsubsection"><a class="ltx_ref" href="https://arxiv.org/html/2405.17587v2#S3.SS3.SSS3" title="In 3.3 Retrieval Algorithm ‣ 3 Methodology ‣ RAGSys: Item-Cold-Start Recommender as RAG System"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3.3.3 </span>Demonstration Quality Bias</span></a></li>
</ol>
</li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_section">
<a class="ltx_ref" href="https://arxiv.org/html/2405.17587v2#S4" title="In RAGSys: Item-Cold-Start Recommender as RAG System"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">4 </span>Experiments</span></a>
<ol class="ltx_toclist ltx_toclist_section">
<li class="ltx_tocentry ltx_tocentry_subsection">
<a class="ltx_ref" href="https://arxiv.org/html/2405.17587v2#S4.SS1" title="In 4 Experiments ‣ RAGSys: Item-Cold-Start Recommender as RAG System"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">4.1 </span>Experimental Setup</span></a>
<ol class="ltx_toclist ltx_toclist_subsection">
<li class="ltx_tocentry ltx_tocentry_subsubsection"><a class="ltx_ref" href="https://arxiv.org/html/2405.17587v2#S4.SS1.SSS1" title="In 4.1 Experimental Setup ‣ 4 Experiments ‣ RAGSys: Item-Cold-Start Recommender as RAG System"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">4.1.1 </span>The Dataset Choice</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsubsection"><a class="ltx_ref" href="https://arxiv.org/html/2405.17587v2#S4.SS1.SSS2" title="In 4.1 Experimental Setup ‣ 4 Experiments ‣ RAGSys: Item-Cold-Start Recommender as RAG System"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">4.1.2 </span>The TruthfulQA Dataset</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsubsection"><a class="ltx_ref" href="https://arxiv.org/html/2405.17587v2#S4.SS1.SSS3" title="In 4.1 Experimental Setup ‣ 4 Experiments ‣ RAGSys: Item-Cold-Start Recommender as RAG System"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">4.1.3 </span>Generating Demonstrations Pairs and Triplets</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsubsection"><a class="ltx_ref" href="https://arxiv.org/html/2405.17587v2#S4.SS1.SSS4" title="In 4.1 Experimental Setup ‣ 4 Experiments ‣ RAGSys: Item-Cold-Start Recommender as RAG System"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">4.1.4 </span>The Language Models</span></a></li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2405.17587v2#S4.SS2" title="In 4 Experiments ‣ RAGSys: Item-Cold-Start Recommender as RAG System"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">4.2 </span>Implementation Details and Ablation Study</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2405.17587v2#S4.SS3" title="In 4 Experiments ‣ RAGSys: Item-Cold-Start Recommender as RAG System"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">4.3 </span>Main Results</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2405.17587v2#S4.SS4" title="In 4 Experiments ‣ RAGSys: Item-Cold-Start Recommender as RAG System"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">4.4 </span>Calibrating Diversity using DPO</span></a></li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_section">
<a class="ltx_ref" href="https://arxiv.org/html/2405.17587v2#S5" title="In RAGSys: Item-Cold-Start Recommender as RAG System"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">5 </span>Discussion: Real-World RAG Systems</span></a>
<ol class="ltx_toclist ltx_toclist_section">
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2405.17587v2#S5.SS1" title="In 5 Discussion: Real-World RAG Systems ‣ RAGSys: Item-Cold-Start Recommender as RAG System"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">5.1 </span>Balancing Performance and Efficiency</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2405.17587v2#S5.SS2" title="In 5 Discussion: Real-World RAG Systems ‣ RAGSys: Item-Cold-Start Recommender as RAG System"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">5.2 </span>ICL RAG versus Fine-Tuning</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2405.17587v2#S5.SS3" title="In 5 Discussion: Real-World RAG Systems ‣ RAGSys: Item-Cold-Start Recommender as RAG System"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">5.3 </span>Achieving State-of-the-Art Retrieval with Available Tools</span></a></li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_section"><a class="ltx_ref" href="https://arxiv.org/html/2405.17587v2#S6" title="In RAGSys: Item-Cold-Start Recommender as RAG System"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">6 </span>Conclusion</span></a></li>
<li class="ltx_tocentry ltx_tocentry_section"><a class="ltx_ref" href="https://arxiv.org/html/2405.17587v2#S7" title="In RAGSys: Item-Cold-Start Recommender as RAG System"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">7 </span>Acknowledgments</span></a></li>
</ol></nav>
</nav>
<div class="ltx_page_main">
<div class="ltx_page_content">
<article class="ltx_document ltx_authors_1line">
<div class="ltx_para" id="p1">
<span class="ltx_ERROR undefined" id="p1.1">\copyrightclause</span>
<p class="ltx_p" id="p1.2">Copyright for this paper by its authors.
Use permitted under Creative Commons License Attribution 4.0
International (CC BY 4.0).</p>
</div>
<div class="ltx_para" id="p2">
<span class="ltx_ERROR undefined" id="p2.1">\conference</span>
<p class="ltx_p" id="p2.2">Information Retrieval’s Role in RAG Systems (IR-RAG) - 2024</p>
</div>
<div class="ltx_para" id="p3">
<p class="ltx_p" id="p3.1">[email=emile@crossingminds.com,
]
<span class="ltx_ERROR undefined" id="p3.1.1">\cormark</span>[1]
<span class="ltx_ERROR undefined" id="p3.1.2">\fnmark</span>[1]</p>
</div>
<div class="ltx_para" id="p4">
<p class="ltx_p" id="p4.1">[email=garrin.mcgoldrick@crossingminds.com,
]
<span class="ltx_ERROR undefined" id="p4.1.1">\fnmark</span>[1]</p>
</div>
<div class="ltx_para" id="p5">
<span class="ltx_ERROR undefined" id="p5.1">\cortext</span>
<p class="ltx_p" id="p5.2">[1]Corresponding author.
<span class="ltx_ERROR undefined" id="p5.2.1">\fntext</span>[1]Both authors contributed equally to this research.</p>
</div>
<h1 class="ltx_title ltx_title_document">RAGSys: Item-Cold-Start Recommender as RAG System</h1>
<div class="ltx_authors">
<span class="ltx_creator ltx_role_author">
<span class="ltx_personname">Emile Contal
</span><span class="ltx_author_notes">
<span class="ltx_contact ltx_role_address">Crossing Minds Inc, San Francisco, USA
</span></span></span>
<span class="ltx_author_before">  </span><span class="ltx_creator ltx_role_author">
<span class="ltx_personname">Garrin McGoldrick
</span></span>
</div>
<div class="ltx_dates">(2024)</div>
<div class="ltx_abstract">
<h6 class="ltx_title ltx_title_abstract">Abstract</h6>
<p class="ltx_p" id="id1.id1">Large Language Models (LLM) hold immense promise for real-world applications, but their generic knowledge often falls short of domain-specific needs. Fine-tuning, a common approach, can suffer from catastrophic forgetting and hinder generalizability. In-Context Learning (ICL) offers an alternative, which can leverage Retrieval-Augmented Generation (RAG) to provide LLMs with relevant demonstrations for few-shot learning tasks. This paper explores the desired qualities of a demonstration retrieval system for ICL. We argue that ICL retrieval in this context resembles item-cold-start recommender systems, prioritizing discovery and maximizing information gain over strict relevance. We propose a novel evaluation method that measures the LLM’s subsequent performance on NLP tasks, eliminating the need for subjective diversity scores. Our findings demonstrate the critical role of diversity and quality bias in retrieved demonstrations for effective ICL, and highlight the potential of recommender system techniques in this domain.</p>
</div>
<div class="ltx_classification">
<h6 class="ltx_title ltx_title_classification">keywords: </h6>
Recommender systems <span class="ltx_ERROR undefined" id="id2.id1">\sep</span>Information Retrieval <span class="ltx_ERROR undefined" id="id3.id2">\sep</span>Large Language Models <span class="ltx_ERROR undefined" id="id4.id3">\sep</span>Few-Shot Learning <span class="ltx_ERROR undefined" id="id5.id4">\sep</span>In-Context-Learning

</div>
<section class="ltx_section" id="S1">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">1 </span>Introduction</h2>
<div class="ltx_para" id="S1.p1">
<p class="ltx_p" id="S1.p1.1">Large Language Models (LLMs) have emerged as a powerful tool for natural language processing, demonstrating remarkable abilities in areas like text completion, summarization, and question answering <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2405.17587v2#bib.bib1" title="">1</a>]</cite>. One of their most intriguing capabilities is their potential to learn "common sense" – general knowledge about the world that allows them to reason and make inferences beyond the literal meaning of text. This has fueled excitement about the possibility of achieving zero-shot learning, where LLMs can solve unseen problems without any prior training on specific tasks <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2405.17587v2#bib.bib2" title="">2</a>]</cite>.</p>
</div>
<div class="ltx_para" id="S1.p2">
<p class="ltx_p" id="S1.p2.1">However, a crucial distinction exists between generic public knowledge and the specific private knowledge required for most real-world use cases. While LLMs excel at generic text completion or chat-like interactions, practical applications often demand solving specific and repeatable downstream tasks within a particular domain <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2405.17587v2#bib.bib3" title="">3</a>]</cite>. This typically necessitates knowledge specific to a business or organization, such as understanding internal processes, up-to-date product details, or customer behavior.</p>
</div>
<div class="ltx_para" id="S1.p3">
<p class="ltx_p" id="S1.p3.1">Fine-tuning, a technique where LLMs are trained on large datasets tailored to the target task, offers a path towards adapting LLMs to these domain-specific needs. Yet, fine-tuning presents significant challenges. When trained on tasks-specific data, LLMs tend to forget knowledge and skills gained in the initial training, a phenomenon referred to as Catastrophic Forgetting <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2405.17587v2#bib.bib4" title="">4</a>]</cite>. Consequently, a fine-tuned LLM loses some of its ability to generalize to novel examples that aren’t well represented in its fine-tuning training data. Moreover, while fine-tuning allows an LLM to memorize task-specific information, it doesn’t necessarily allow the LLM to reason about that information <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2405.17587v2#bib.bib5" title="">5</a>]</cite>. As a final consideration, keeping LLMs constantly up-to-date using fine-tuning can be infeasible, especially for domains with frequently changing information like e-commerce product inventory, whereas it is easy to update a database in real-time from which information is retrieved.</p>
</div>
<div class="ltx_para" id="S1.p4">
<p class="ltx_p" id="S1.p4.1">As an alternative to fine-tuning, In-Context Learning (ICL) offers a promising approach for leveraging LLMs in scenarios with limited data. This approach exploits the demonstrated ability of LLMs for "meta-learning" – essentially, learning how to learn.
In <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2405.17587v2#bib.bib6" title="">6</a>]</cite>, the authors prove the capacity of LLMs to effectively ingest in-context training data points and solve statistical optimization problems such as gradient descent.
ICL enables practitioners to leverage Retrieval Augmented Generation (RAG),
that is enriching the input prompt by information that is retrieved in real-time <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2405.17587v2#bib.bib7" title="">7</a>]</cite>.
We refer to <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2405.17587v2#bib.bib8" title="">8</a>]</cite> for a recent survey on ICL.</p>
</div>
<div class="ltx_para" id="S1.p5">
<p class="ltx_p" id="S1.p5.2">This paper focuses on few-shot learning and the retrieval of relevant demonstrations for this process, where a demonstration is some text which is included in the LLM’s context to demonstrate how the LLM should formulate correct answers. Few-shot learning presents a well-structured problem, allowing us to evaluate the quality of the retrieval algorithm using established classification metrics. Crucially, we show that enriching a language model with a few-shot example retriever offers a powerful method to achieve fine-tuning-like behavior, steering the output of the LLM towards the desired outcome even with limited data.
Interestingly, increasing the context size in prompts beyond a certain point yields diminishing returns. The most impactful information resides within a relatively small set of well-chosen demonstrations, rather than overloading the prompt with vast amounts of data <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2405.17587v2#bib.bib9" title="">9</a>]</cite>. This highlights the importance of effective retrieval strategies, transforming <math alttext="k" class="ltx_Math" display="inline" id="S1.p5.1.m1.1"><semantics id="S1.p5.1.m1.1a"><mi id="S1.p5.1.m1.1.1" xref="S1.p5.1.m1.1.1.cmml">k</mi><annotation-xml encoding="MathML-Content" id="S1.p5.1.m1.1b"><ci id="S1.p5.1.m1.1.1.cmml" xref="S1.p5.1.m1.1.1">𝑘</ci></annotation-xml><annotation encoding="application/x-tex" id="S1.p5.1.m1.1c">k</annotation><annotation encoding="application/x-llamapun" id="S1.p5.1.m1.1d">italic_k</annotation></semantics></math>-shot learning into a top-<math alttext="k" class="ltx_Math" display="inline" id="S1.p5.2.m2.1"><semantics id="S1.p5.2.m2.1a"><mi id="S1.p5.2.m2.1.1" xref="S1.p5.2.m2.1.1.cmml">k</mi><annotation-xml encoding="MathML-Content" id="S1.p5.2.m2.1b"><ci id="S1.p5.2.m2.1.1.cmml" xref="S1.p5.2.m2.1.1">𝑘</ci></annotation-xml><annotation encoding="application/x-tex" id="S1.p5.2.m2.1c">k</annotation><annotation encoding="application/x-llamapun" id="S1.p5.2.m2.1d">italic_k</annotation></semantics></math> information retrieval problem at its core.</p>
</div>
<div class="ltx_para" id="S1.p6">
<p class="ltx_p" id="S1.p6.1">Building upon this concept, this paper identifies desirable properties for a RAG system under the framework of few-shot learning. We demonstrate that state-of-the-art retrieval systems in this context resemble item-cold-start recommender systems. Unlike exact search algorithms that prioritize precision and recall, our focus is on discovery, by maximizing the set of collective information gain from the retrieved demonstrations. This necessitates solving various trade-offs between query relevance, quality scoring, as well as diversity algorithms to ensure a variety of informative examples are surfaced.
Furthermore, we propose a method for evaluating RAG system performance through the subsequent performance of the enriched LLM on established NLP tasks like question answering or text generation. This methodology offers a valuable approach to directly assessing diversity and quality-based retrieval systems, which removes the need to define a subjective diversity score, a historically challenging aspect of evaluating such systems in academic settings <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2405.17587v2#bib.bib10" title="">10</a>]</cite>.</p>
</div>
<div class="ltx_para" id="S1.p7">
<p class="ltx_p" id="S1.p7.1">To summarize, in this paper we study the impact of diversity and quality bias in retrieving demonstrations for ICL.
We start by reviewing the use of diversity and other biases in both ICL and Information Retrieval works.
We then propose a method for evaluating the performance of different retrieval algorithms.
Then we present experiments and results demonstrating the impact of diversity and quality bias on an LLM’s ability to generate correct answers.
Finally we discuss the applicability of state-of-the-art ICL retrieval algorithms in real-world setting,
and show that recommendation engines offer a better solution than semantic search engines.</p>
</div>
</section>
<section class="ltx_section" id="S2">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">2 </span>Related Work</h2>
<div class="ltx_para" id="S2.p1">
<p class="ltx_p" id="S2.p1.1">This paper sits at the intersection of two distinct, but increasingly intertwined, research areas: In-Context Learning for Large Language Models and Information Retrieval. While ICL focuses on enabling LLMs to learn from carefully selected contextual information, IR deals with retrieving relevant information from document collections. Our work leverages concepts from both fields to address the challenge of few-shot learning with LLMs.</p>
</div>
<section class="ltx_subsection" id="S2.SS1">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">2.1 </span>Few-Shot In-Context Learning with Retrieval Augmented Generation</h3>
<div class="ltx_para" id="S2.SS1.p1">
<p class="ltx_p" id="S2.SS1.p1.1">Within the context of RAG, few-shot learning can be defined as a specific scenario where the "documents" retrieved are actually "examples" used to guide the LLM. These examples can also be referred to interchangeably as "In-Context Examples" (ICE) or "demonstrations". The importance of ICL in achieving state-of-the-art LLM performance is undeniable, with its ubiquitous presence in top benchmarks across various domains. Consequently, ICL research is a rapidly evolving field with numerous proposed algorithms.</p>
</div>
<section class="ltx_subsubsection" id="S2.SS1.SSS1">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">2.1.1 </span>Pure Diversity</h4>
<div class="ltx_para" id="S2.SS1.SSS1.p1">
<p class="ltx_p" id="S2.SS1.SSS1.p1.2">Several noteworthy ICL approaches have emerged that address the challenge of retrieving informative examples for few-shot learning. Some methods only promote the diversity of the demonstrations, like in <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2405.17587v2#bib.bib11" title="">11</a>]</cite> where the authors utilize <math alttext="k" class="ltx_Math" display="inline" id="S2.SS1.SSS1.p1.1.m1.1"><semantics id="S2.SS1.SSS1.p1.1.m1.1a"><mi id="S2.SS1.SSS1.p1.1.m1.1.1" xref="S2.SS1.SSS1.p1.1.m1.1.1.cmml">k</mi><annotation-xml encoding="MathML-Content" id="S2.SS1.SSS1.p1.1.m1.1b"><ci id="S2.SS1.SSS1.p1.1.m1.1.1.cmml" xref="S2.SS1.SSS1.p1.1.m1.1.1">𝑘</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.SSS1.p1.1.m1.1c">k</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.SSS1.p1.1.m1.1d">italic_k</annotation></semantics></math>-means clustering in a dense embeddings space to achieve diversity. By applying <math alttext="k" class="ltx_Math" display="inline" id="S2.SS1.SSS1.p1.2.m2.1"><semantics id="S2.SS1.SSS1.p1.2.m2.1a"><mi id="S2.SS1.SSS1.p1.2.m2.1.1" xref="S2.SS1.SSS1.p1.2.m2.1.1.cmml">k</mi><annotation-xml encoding="MathML-Content" id="S2.SS1.SSS1.p1.2.m2.1b"><ci id="S2.SS1.SSS1.p1.2.m2.1.1.cmml" xref="S2.SS1.SSS1.p1.2.m2.1.1">𝑘</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.SSS1.p1.2.m2.1c">k</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.SSS1.p1.2.m2.1d">italic_k</annotation></semantics></math>-means to the sentence embeddings of the demonstrations, this approach ensures that the retrieved examples cover a variety of semantic spaces, inherently increasing the mutual information of the retrieved set, but without taking into account the relevancy to the query.</p>
</div>
</section>
<section class="ltx_subsubsection" id="S2.SS1.SSS2">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">2.1.2 </span>Pure Quality</h4>
<div class="ltx_para" id="S2.SS1.SSS2.p1">
<p class="ltx_p" id="S2.SS1.SSS2.p1.1">Other approaches focuses on identifying examples where the LLM exhibits low token-level uncertainty. In <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2405.17587v2#bib.bib12" title="">12</a>]</cite> the authors analyze token probabilities within candidate 0-shot prompts. By prioritizing prompts where the LLM has the highest generation likelihood (low perplexity), this approach aims to select examples that hold the potential for significant learning gains for the LLM.
The intuition that the authors give is that a prompt that is more expected by the LLM is more likely to help it extracting the relevant information.
Accessing the per-token probabilities for all examples incurs a significant compute cost, but can be pre-computed as they do not depend on the query.</p>
</div>
</section>
<section class="ltx_subsubsection" id="S2.SS1.SSS3">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">2.1.3 </span>Pure Relevance</h4>
<div class="ltx_para" id="S2.SS1.SSS3.p1">
<p class="ltx_p" id="S2.SS1.SSS3.p1.1">Notably, a connection can be drawn between traditional full-text search algorithms and pure relevance approaches. In <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2405.17587v2#bib.bib13" title="">13</a>]</cite> the authors use BM25 <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2405.17587v2#bib.bib14" title="">14</a>]</cite>, a well-established retrieval ranking function commonly used in information retrieval tasks. This approach essentially leverages the strengths of BM25 in identifying examples with terms highly similar to the query, to select the most relevant examples for the specific task at hand. This strategy ensures the retrieved examples are topically relevant to the task while potentially introducing some variation in the specific phrasing or wording used.</p>
</div>
<div class="ltx_para" id="S2.SS1.SSS3.p2">
<p class="ltx_p" id="S2.SS1.SSS3.p2.1">Finally, neural ranking, one of the most commonly used ICL approach, typically yielding superior results <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2405.17587v2#bib.bib15" title="">15</a>, <a class="ltx_ref" href="https://arxiv.org/html/2405.17587v2#bib.bib16" title="">16</a>, <a class="ltx_ref" href="https://arxiv.org/html/2405.17587v2#bib.bib17" title="">17</a>, <a class="ltx_ref" href="https://arxiv.org/html/2405.17587v2#bib.bib18" title="">18</a>, <a class="ltx_ref" href="https://arxiv.org/html/2405.17587v2#bib.bib19" title="">19</a>]</cite>, is maximizing similarity in a dense embeddings space. These methods, like <code class="ltx_verbatim ltx_font_typewriter" id="S2.SS1.SSS3.p2.1.1">KATE</code> <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2405.17587v2#bib.bib20" title="">20</a>]</cite>, utilize <math alttext="k" class="ltx_Math" display="inline" id="S2.SS1.SSS3.p2.1.m1.1"><semantics id="S2.SS1.SSS3.p2.1.m1.1a"><mi id="S2.SS1.SSS3.p2.1.m1.1.1" xref="S2.SS1.SSS3.p2.1.m1.1.1.cmml">k</mi><annotation-xml encoding="MathML-Content" id="S2.SS1.SSS3.p2.1.m1.1b"><ci id="S2.SS1.SSS3.p2.1.m1.1.1.cmml" xref="S2.SS1.SSS3.p2.1.m1.1.1">𝑘</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.SSS3.p2.1.m1.1c">k</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.SSS3.p2.1.m1.1d">italic_k</annotation></semantics></math>-Nearest Neighbors (<code class="ltx_verbatim ltx_font_typewriter" id="S2.SS1.SSS3.p2.1.2">kNN</code>) search using the cosine distance of sentence embeddings to retrieve the examples most semantically similar to the prompt. Scaling this method leverages vector search algorithms, commonly used in large-scale information retrieval tasks, where efficient retrieval of semantically similar documents is crucial.</p>
</div>
<div class="ltx_para" id="S2.SS1.SSS3.p3">
<p class="ltx_p" id="S2.SS1.SSS3.p3.1">While general purpose pre-trained embeddings like <code class="ltx_verbatim ltx_font_typewriter" id="S2.SS1.SSS3.p3.1.1">BERT</code> <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2405.17587v2#bib.bib21" title="">21</a>]</cite> form a strong baseline, learning specific embeddings for retrieval, and in particular ICL, is a very active area of research. In <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2405.17587v2#bib.bib22" title="">22</a>]</cite> the authors build upon <code class="ltx_verbatim ltx_font_typewriter" id="S2.SS1.SSS3.p3.1.2">BERT</code> and introduce <code class="ltx_verbatim ltx_font_typewriter" id="S2.SS1.SSS3.p3.1.3">ColBERT</code> that improves the retrieval performances by an order of magnitude.
Other embeddings model have been proposed for ICL retrieval in <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2405.17587v2#bib.bib16" title="">16</a>]</cite> and <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2405.17587v2#bib.bib17" title="">17</a>]</cite>.
Some authors also explored training full language models <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2405.17587v2#bib.bib15" title="">15</a>]</cite>, as well as LLM <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2405.17587v2#bib.bib19" title="">19</a>]</cite>, showing further improvements compared to traditional embedding-based approaches.
While leading to superior results, these supervised neural ranking models for learning-to-rank necessitate orders of magnitude more training examples data, that is typically not available to practitioners. In addition, without any explicit metric space such as dense embeddings, efficient retrieval indexing such as <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2405.17587v2#bib.bib23" title="">23</a>]</cite> cannot be used.</p>
</div>
</section>
<section class="ltx_subsubsection" id="S2.SS1.SSS4">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">2.1.4 </span>Diversity/Relevance Trade-off</h4>
<div class="ltx_para" id="S2.SS1.SSS4.p1">
<p class="ltx_p" id="S2.SS1.SSS4.p1.1">While both relevance and diversity are crucial for effective few-shot learning, methods yielding the best ICL results combine these two paradigms rather than prioritizing one over the other. This is achieved by maximizing a carefully balanced trade-off between semantic similarity to the prompt and diversity of the retrieved examples. Unsupervised techniques can be adapted to prioritize the selection of examples that are both relevant to the prompt and dissimilar to each other.
In <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2405.17587v2#bib.bib24" title="">24</a>]</cite> the authors introduce a greedy method to select relevant demonstrations while ensuring enough coverage. They define specific coverage strategies adapted to the problem of program generation.
In <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2405.17587v2#bib.bib25" title="">25</a>]</cite> the authors employs an active learning setting, where a voting algorithm selects a set of examples penalizing the top-<math alttext="k" class="ltx_Math" display="inline" id="S2.SS1.SSS4.p1.1.m1.1"><semantics id="S2.SS1.SSS4.p1.1.m1.1a"><mi id="S2.SS1.SSS4.p1.1.m1.1.1" xref="S2.SS1.SSS4.p1.1.m1.1.1.cmml">k</mi><annotation-xml encoding="MathML-Content" id="S2.SS1.SSS4.p1.1.m1.1b"><ci id="S2.SS1.SSS4.p1.1.m1.1.1.cmml" xref="S2.SS1.SSS4.p1.1.m1.1.1">𝑘</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.SSS4.p1.1.m1.1c">k</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.SSS4.p1.1.m1.1d">italic_k</annotation></semantics></math> closest from already selected ones, using cosine distance in an embedding space.</p>
</div>
<div class="ltx_para" id="S2.SS1.SSS4.p2">
<p class="ltx_p" id="S2.SS1.SSS4.p2.1">The most popular unsupervised approach for achieving this balance between relevance and diversity is Maximal Marginal Relevance (MMR). MMR retrieves a set of examples by iteratively selecting the example that maximizes a linear combination of the scores of relevance to the prompt and dissimilarity to the previously retrieved examples.
It was analyzed in <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2405.17587v2#bib.bib26" title="">26</a>]</cite> for ICL and was shown to outperform simpler methods.
Alternatively to MMR, Determinantal Point Processes (DPP) has been used in <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2405.17587v2#bib.bib18" title="">18</a>]</cite> to optimize the joint information of the selected <math alttext="k" class="ltx_Math" display="inline" id="S2.SS1.SSS4.p2.1.m1.1"><semantics id="S2.SS1.SSS4.p2.1.m1.1a"><mi id="S2.SS1.SSS4.p2.1.m1.1.1" xref="S2.SS1.SSS4.p2.1.m1.1.1.cmml">k</mi><annotation-xml encoding="MathML-Content" id="S2.SS1.SSS4.p2.1.m1.1b"><ci id="S2.SS1.SSS4.p2.1.m1.1.1.cmml" xref="S2.SS1.SSS4.p2.1.m1.1.1">𝑘</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.SSS4.p2.1.m1.1c">k</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.SSS4.p2.1.m1.1d">italic_k</annotation></semantics></math> examples. However, exactly solving the DPP optimization being <code class="ltx_verbatim ltx_font_typewriter" id="S2.SS1.SSS4.p2.1.1">NP</code>-hard, hence the authors also employs greedy maximization.</p>
</div>
</section>
</section>
<section class="ltx_subsection" id="S2.SS2">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">2.2 </span>Diversity in Information Retrieval and Online Learning</h3>
<div class="ltx_para" id="S2.SS2.p1">
<p class="ltx_p" id="S2.SS2.p1.1">The concept of diversity in information retrieval has been a long-running topic of research.
In this section we propose a short review of the use of diversity in the IR literature and related domains.</p>
</div>
<section class="ltx_subsubsection" id="S2.SS2.SSS1">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">2.2.1 </span>In Information Retrieval</h4>
<div class="ltx_para" id="S2.SS2.SSS1.p1">
<p class="ltx_p" id="S2.SS2.SSS1.p1.2">The MMR algorithm was analyzed in <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2405.17587v2#bib.bib27" title="">27</a>]</cite>, and compared against other approached like <code class="ltx_verbatim ltx_font_typewriter" id="S2.SS2.SSS1.p1.2.1">KL</code>-divergence optimization in <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2405.17587v2#bib.bib28" title="">28</a>]</cite>.
Pure retrieval algorithms typically optimize for recall, not information maximization.
Agreeing on a diversity objective function remains a challenge.
Diversity is sometimes introduced as a heuristic to cover possible interpretations of the same query,
instead of minimizing information overlap from near-duplicated results.
In <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2405.17587v2#bib.bib10" title="">10</a>]</cite> the authors leverage a concept of <span class="ltx_text ltx_font_italic" id="S2.SS2.SSS1.p1.2.2">information nuggets</span> with documents to estimate the redundancy of the set of retrieved documents.
Topic modeling is also employed, such as <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2405.17587v2#bib.bib29" title="">29</a>]</cite> that uses a taxonomy of categories labelling the documents and the queries.
The desired properties of diverse retrieval are furthermore characterized in <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2405.17587v2#bib.bib30" title="">30</a>]</cite>.
A various set of similarity methods and diversification algorithms are analyzed in <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2405.17587v2#bib.bib31" title="">31</a>]</cite> on sparse features vectors.
Among diversity evaluation methods based on topic modelling, three notable criteria used in the <code class="ltx_verbatim ltx_font_typewriter" id="S2.SS2.SSS1.p1.2.3">TREC</code> Diversity track <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2405.17587v2#bib.bib32" title="">32</a>]</cite>, <code class="ltx_verbatim ltx_font_typewriter" id="S2.SS2.SSS1.p1.2.4">ERR-IA</code> <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2405.17587v2#bib.bib33" title="">33</a>]</cite>, <math alttext="\alpha" class="ltx_Math" display="inline" id="S2.SS2.SSS1.p1.1.m1.1"><semantics id="S2.SS2.SSS1.p1.1.m1.1a"><mi id="S2.SS2.SSS1.p1.1.m1.1.1" xref="S2.SS2.SSS1.p1.1.m1.1.1.cmml">α</mi><annotation-xml encoding="MathML-Content" id="S2.SS2.SSS1.p1.1.m1.1b"><ci id="S2.SS2.SSS1.p1.1.m1.1.1.cmml" xref="S2.SS2.SSS1.p1.1.m1.1.1">𝛼</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.SSS1.p1.1.m1.1c">\alpha</annotation><annotation encoding="application/x-llamapun" id="S2.SS2.SSS1.p1.1.m1.1d">italic_α</annotation></semantics></math>-<code class="ltx_verbatim ltx_font_typewriter" id="S2.SS2.SSS1.p1.2.5">nDCG</code>@<math alttext="k" class="ltx_Math" display="inline" id="S2.SS2.SSS1.p1.2.m2.1"><semantics id="S2.SS2.SSS1.p1.2.m2.1a"><mi id="S2.SS2.SSS1.p1.2.m2.1.1" xref="S2.SS2.SSS1.p1.2.m2.1.1.cmml">k</mi><annotation-xml encoding="MathML-Content" id="S2.SS2.SSS1.p1.2.m2.1b"><ci id="S2.SS2.SSS1.p1.2.m2.1.1.cmml" xref="S2.SS2.SSS1.p1.2.m2.1.1">𝑘</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.SSS1.p1.2.m2.1c">k</annotation><annotation encoding="application/x-llamapun" id="S2.SS2.SSS1.p1.2.m2.1d">italic_k</annotation></semantics></math> <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2405.17587v2#bib.bib10" title="">10</a>]</cite>, and <code class="ltx_verbatim ltx_font_typewriter" id="S2.SS2.SSS1.p1.2.6">NRBP</code> <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2405.17587v2#bib.bib34" title="">34</a>]</cite>, are compared in <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2405.17587v2#bib.bib35" title="">35</a>]</cite>.</p>
</div>
</section>
<section class="ltx_subsubsection" id="S2.SS2.SSS2">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">2.2.2 </span>In Recommender Systems</h4>
<div class="ltx_para" id="S2.SS2.SSS2.p1">
<p class="ltx_p" id="S2.SS2.SSS2.p1.1">Within IR, the recommender system literature brings an additional point-of-view on studying diversity in retrieval, by focusing on the benefit of diverse results for a user, instead of evaluating methods against a potentially arbitrary relevance/diversity trade-off.
The difficulty of evaluating the impact of diversity, and the necessity for large scale real-world recommendation studies has been explored in <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2405.17587v2#bib.bib36" title="">36</a>]</cite>.
In <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2405.17587v2#bib.bib37" title="">37</a>]</cite> and <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2405.17587v2#bib.bib38" title="">38</a>]</cite> the authors model the user behavior conditioned on the set of retrieved items.
In <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2405.17587v2#bib.bib39" title="">39</a>]</cite> the authors improve the diversity versus relevance trade-off in recommender systems by directly learning a ranking model that favor diversity, instead of only applying diversity re-ranking methods.</p>
</div>
</section>
<section class="ltx_subsubsection" id="S2.SS2.SSS3">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">2.2.3 </span>In Online Learning</h4>
<div class="ltx_para" id="S2.SS2.SSS3.p1">
<p class="ltx_p" id="S2.SS2.SSS3.p1.1">Learning a trade-off between relevancy and diversity also naturally occurs in related online frameworks such as active learning, multi-armed bandits and Bayesian optimization.
In <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2405.17587v2#bib.bib40" title="">40</a>]</cite> the authors modify a learning-to-rank algorithm from users feedback, to inherently learn diverse rankings and demonstrate a positive impact on the original relevance metric.
Other approaches such as <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2405.17587v2#bib.bib41" title="">41</a>]</cite> also introduce diversity in learning-to-rank algorithms while preserving the offline settings, but then are limited to evaluate using direct diversity measures.</p>
</div>
<div class="ltx_para" id="S2.SS2.SSS3.p2">
<p class="ltx_p" id="S2.SS2.SSS3.p2.1">Within batch-mode Bayesian optimization, in <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2405.17587v2#bib.bib42" title="">42</a>]</cite> and <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2405.17587v2#bib.bib43" title="">43</a>]</cite> the authors analyze two greedy exploration/exploitation algorithms to select the next batch of items maximizing the cumulative reward. Like with recommender systems, these online settings exemplify the theoretical and empirical importance of diversifying the selected set of items despite the true objective function only including pure relevance, the cumulative reward.</p>
</div>
</section>
</section>
<section class="ltx_subsection" id="S2.SS3">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">2.3 </span>Quality Biases in Information Retrieval</h3>
<div class="ltx_para" id="S2.SS3.p1">
<p class="ltx_p" id="S2.SS3.p1.1">Complementing the discussion on diversity in information retrieval, quality bias also plays a crucial role in effective retrieval. Quality bias refers to the prioritization of documents or examples considered to be more reliable or informative within the retrieved set. Incorporating quality considerations into retrieval algorithms can significantly improve standard unbiased IR metrics.</p>
</div>
<div class="ltx_para" id="S2.SS3.p2">
<p class="ltx_p" id="S2.SS3.p2.1">Several approaches have been explored to address quality bias in pure IR tasks. These can be broadly categorized into content-based and graph-based methods.</p>
</div>
<section class="ltx_subsubsection" id="S2.SS3.SSS1">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">2.3.1 </span>Content-Based Quality Biases</h4>
<div class="ltx_para" id="S2.SS3.SSS1.p1">
<p class="ltx_p" id="S2.SS3.SSS1.p1.1">Content-based methods leverage existing signals inside the documents themselves to identify potentially lower-quality content. Examples include spam detection scores developed in works like <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2405.17587v2#bib.bib44" title="">44</a>]</cite> and <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2405.17587v2#bib.bib45" title="">45</a>]</cite>. By incorporating such scores during retrieval, the system can prioritize higher quality documents.
More sophisticated content-based approaches don’t limit at spam classification, but extract more generic quality features the content of documents. Works like <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2405.17587v2#bib.bib46" title="">46</a>]</cite> explore features such as stop-word statistics or entropy of the documents to generate quality scores. The authors demonstrate that biasing standard retrieval using these features leads to improved retrieval effectiveness even using unbiased IR metrics like <code class="ltx_verbatim ltx_font_typewriter" id="S2.SS3.SSS1.p1.1.1">nDCG</code>.</p>
</div>
</section>
<section class="ltx_subsubsection" id="S2.SS3.SSS2">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">2.3.2 </span>Graph-Based Quality Biases</h4>
<div class="ltx_para" id="S2.SS3.SSS2.p1">
<p class="ltx_p" id="S2.SS3.SSS2.p1.1">Instead of relying on the content itself, graph-based algorithms inherently capture implicit quality signals within their ranking model. <code class="ltx_verbatim ltx_font_typewriter" id="S2.SS3.SSS2.p1.1.1">PageRank</code>, a seminal algorithm for web search ranking introduced in <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2405.17587v2#bib.bib47" title="">47</a>]</cite>, exemplifies this approach. <code class="ltx_verbatim ltx_font_typewriter" id="S2.SS3.SSS2.p1.1.2">PageRank</code> leverages the links structure between web articles to assign higher importance to web pages that are linked to by other high-quality pages. This process implicitly prioritizes documents with a higher perceived quality based on the quality of their in-links.</p>
</div>
</section>
<section class="ltx_subsubsection" id="S2.SS3.SSS3">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">2.3.3 </span>Connections to Recommender Systems</h4>
<div class="ltx_para" id="S2.SS3.SSS3.p1">
<p class="ltx_p" id="S2.SS3.SSS3.p1.1">Interestingly, the concept of inherent quality bias in graph-based IR approaches resembles collaborative filtering techniques employed in recommender systems. In an analogous manner to learning-to-rank on a (item, item) graph, collaborative filtering addresses learning-to-rank on a bipartite (user, item) graph. In this way, collaborative filtering also implicitly learns a trade-off between item similarity and popularity, favoring items that are both similar to the user’s past preferences and also generally well-received by other users.</p>
</div>
</section>
</section>
</section>
<section class="ltx_section" id="S3">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">3 </span>Methodology</h2>
<div class="ltx_para" id="S3.p1">
<p class="ltx_p" id="S3.p1.1">We propose to frame the ICL problem as an item-cold-start recommendation problem, where the query is an unseen item, and the objective is to retrieve from the pool of candidate few-shot demonstrations a set of items maximizing the cumulative reward to the user (the LLM). In this case, the reward is a measure of how much the retrieved items increase the probability that the LLM generates a correct answer. A solution to this optimization problem requires not only relevance, but also diversity and quality in the retrieved items, such that the amount of useful information presented to the LLM in the context is maximized.</p>
</div>
<div class="ltx_para" id="S3.p2">
<p class="ltx_p" id="S3.p2.1">Further, we propose to measure the impact of diversity on the retrieved items by directly calculating the probability of the LLM generating a correct answer given the context items. This is in contrast to a typical retrieval context where the retriever is evaluated by calculating some metric relating to the accuracy and recall of documents most similar to the query. In such a setting, it is typical to add a term to the metric which measures the diversity of the retrieved documents to promote more diverse retrievers, knowing that diversity improves the reward to the user but without having an explicit model connecting diversity to the user’s reward. In the case of retrieving demonstrations for inclusion in an LLM’s context, we can directly measure the impact of diversity on the LLM’s reward by calculating the probability of the LLM generating a correct answer.</p>
</div>
<section class="ltx_subsection" id="S3.SS1">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.1 </span>Problem Statement</h3>
<div class="ltx_para" id="S3.SS1.p1">
<p class="ltx_p" id="S3.SS1.p1.2">Consider an answer <math alttext="a" class="ltx_Math" display="inline" id="S3.SS1.p1.1.m1.1"><semantics id="S3.SS1.p1.1.m1.1a"><mi id="S3.SS1.p1.1.m1.1.1" xref="S3.SS1.p1.1.m1.1.1.cmml">a</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.1.m1.1b"><ci id="S3.SS1.p1.1.m1.1.1.cmml" xref="S3.SS1.p1.1.m1.1.1">𝑎</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.1.m1.1c">a</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p1.1.m1.1d">italic_a</annotation></semantics></math> that should be generated by an LLM in response to a query <math alttext="q" class="ltx_Math" display="inline" id="S3.SS1.p1.2.m2.1"><semantics id="S3.SS1.p1.2.m2.1a"><mi id="S3.SS1.p1.2.m2.1.1" xref="S3.SS1.p1.2.m2.1.1.cmml">q</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.2.m2.1b"><ci id="S3.SS1.p1.2.m2.1.1.cmml" xref="S3.SS1.p1.2.m2.1.1">𝑞</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.2.m2.1c">q</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p1.2.m2.1d">italic_q</annotation></semantics></math>. The query can be a simple question such as "Who was the first man to walk on the moon?", or more general message such as "I’d like to find red shoes". The answer could take on many forms, such a factual response "Neil Armstrong", a clarifying question "What size and style of shoe are you looking for?", a JSON payload to send to an API "<span class="ltx_text ltx_font_typewriter" id="S3.SS1.p1.2.1">{"search_terms":["red","shoe"]}</span>" etc.</p>
</div>
<div class="ltx_para" id="S3.SS1.p2">
<p class="ltx_p" id="S3.SS1.p2.8">Consider a set of demonstrations <math alttext="\mathcal{D}" class="ltx_Math" display="inline" id="S3.SS1.p2.1.m1.1"><semantics id="S3.SS1.p2.1.m1.1a"><mi class="ltx_font_mathcaligraphic" id="S3.SS1.p2.1.m1.1.1" xref="S3.SS1.p2.1.m1.1.1.cmml">𝒟</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p2.1.m1.1b"><ci id="S3.SS1.p2.1.m1.1.1.cmml" xref="S3.SS1.p2.1.m1.1.1">𝒟</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p2.1.m1.1c">\mathcal{D}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p2.1.m1.1d">caligraphic_D</annotation></semantics></math>, where each demonstration is a pair <math alttext="(q,a)" class="ltx_Math" display="inline" id="S3.SS1.p2.2.m2.2"><semantics id="S3.SS1.p2.2.m2.2a"><mrow id="S3.SS1.p2.2.m2.2.3.2" xref="S3.SS1.p2.2.m2.2.3.1.cmml"><mo id="S3.SS1.p2.2.m2.2.3.2.1" stretchy="false" xref="S3.SS1.p2.2.m2.2.3.1.cmml">(</mo><mi id="S3.SS1.p2.2.m2.1.1" xref="S3.SS1.p2.2.m2.1.1.cmml">q</mi><mo id="S3.SS1.p2.2.m2.2.3.2.2" xref="S3.SS1.p2.2.m2.2.3.1.cmml">,</mo><mi id="S3.SS1.p2.2.m2.2.2" xref="S3.SS1.p2.2.m2.2.2.cmml">a</mi><mo id="S3.SS1.p2.2.m2.2.3.2.3" stretchy="false" xref="S3.SS1.p2.2.m2.2.3.1.cmml">)</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p2.2.m2.2b"><interval closure="open" id="S3.SS1.p2.2.m2.2.3.1.cmml" xref="S3.SS1.p2.2.m2.2.3.2"><ci id="S3.SS1.p2.2.m2.1.1.cmml" xref="S3.SS1.p2.2.m2.1.1">𝑞</ci><ci id="S3.SS1.p2.2.m2.2.2.cmml" xref="S3.SS1.p2.2.m2.2.2">𝑎</ci></interval></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p2.2.m2.2c">(q,a)</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p2.2.m2.2d">( italic_q , italic_a )</annotation></semantics></math> containing a query <math alttext="q" class="ltx_Math" display="inline" id="S3.SS1.p2.3.m3.1"><semantics id="S3.SS1.p2.3.m3.1a"><mi id="S3.SS1.p2.3.m3.1.1" xref="S3.SS1.p2.3.m3.1.1.cmml">q</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p2.3.m3.1b"><ci id="S3.SS1.p2.3.m3.1.1.cmml" xref="S3.SS1.p2.3.m3.1.1">𝑞</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p2.3.m3.1c">q</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p2.3.m3.1d">italic_q</annotation></semantics></math> and correct answer <math alttext="a" class="ltx_Math" display="inline" id="S3.SS1.p2.4.m4.1"><semantics id="S3.SS1.p2.4.m4.1a"><mi id="S3.SS1.p2.4.m4.1.1" xref="S3.SS1.p2.4.m4.1.1.cmml">a</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p2.4.m4.1b"><ci id="S3.SS1.p2.4.m4.1.1.cmml" xref="S3.SS1.p2.4.m4.1.1">𝑎</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p2.4.m4.1c">a</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p2.4.m4.1d">italic_a</annotation></semantics></math>, or a triple <math alttext="(q,a,\bar{a})" class="ltx_Math" display="inline" id="S3.SS1.p2.5.m5.3"><semantics id="S3.SS1.p2.5.m5.3a"><mrow id="S3.SS1.p2.5.m5.3.4.2" xref="S3.SS1.p2.5.m5.3.4.1.cmml"><mo id="S3.SS1.p2.5.m5.3.4.2.1" stretchy="false" xref="S3.SS1.p2.5.m5.3.4.1.cmml">(</mo><mi id="S3.SS1.p2.5.m5.1.1" xref="S3.SS1.p2.5.m5.1.1.cmml">q</mi><mo id="S3.SS1.p2.5.m5.3.4.2.2" xref="S3.SS1.p2.5.m5.3.4.1.cmml">,</mo><mi id="S3.SS1.p2.5.m5.2.2" xref="S3.SS1.p2.5.m5.2.2.cmml">a</mi><mo id="S3.SS1.p2.5.m5.3.4.2.3" xref="S3.SS1.p2.5.m5.3.4.1.cmml">,</mo><mover accent="true" id="S3.SS1.p2.5.m5.3.3" xref="S3.SS1.p2.5.m5.3.3.cmml"><mi id="S3.SS1.p2.5.m5.3.3.2" xref="S3.SS1.p2.5.m5.3.3.2.cmml">a</mi><mo id="S3.SS1.p2.5.m5.3.3.1" xref="S3.SS1.p2.5.m5.3.3.1.cmml">¯</mo></mover><mo id="S3.SS1.p2.5.m5.3.4.2.4" stretchy="false" xref="S3.SS1.p2.5.m5.3.4.1.cmml">)</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p2.5.m5.3b"><vector id="S3.SS1.p2.5.m5.3.4.1.cmml" xref="S3.SS1.p2.5.m5.3.4.2"><ci id="S3.SS1.p2.5.m5.1.1.cmml" xref="S3.SS1.p2.5.m5.1.1">𝑞</ci><ci id="S3.SS1.p2.5.m5.2.2.cmml" xref="S3.SS1.p2.5.m5.2.2">𝑎</ci><apply id="S3.SS1.p2.5.m5.3.3.cmml" xref="S3.SS1.p2.5.m5.3.3"><ci id="S3.SS1.p2.5.m5.3.3.1.cmml" xref="S3.SS1.p2.5.m5.3.3.1">¯</ci><ci id="S3.SS1.p2.5.m5.3.3.2.cmml" xref="S3.SS1.p2.5.m5.3.3.2">𝑎</ci></apply></vector></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p2.5.m5.3c">(q,a,\bar{a})</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p2.5.m5.3d">( italic_q , italic_a , over¯ start_ARG italic_a end_ARG )</annotation></semantics></math> which additionally contains an incorrect answer <math alttext="\bar{a}" class="ltx_Math" display="inline" id="S3.SS1.p2.6.m6.1"><semantics id="S3.SS1.p2.6.m6.1a"><mover accent="true" id="S3.SS1.p2.6.m6.1.1" xref="S3.SS1.p2.6.m6.1.1.cmml"><mi id="S3.SS1.p2.6.m6.1.1.2" xref="S3.SS1.p2.6.m6.1.1.2.cmml">a</mi><mo id="S3.SS1.p2.6.m6.1.1.1" xref="S3.SS1.p2.6.m6.1.1.1.cmml">¯</mo></mover><annotation-xml encoding="MathML-Content" id="S3.SS1.p2.6.m6.1b"><apply id="S3.SS1.p2.6.m6.1.1.cmml" xref="S3.SS1.p2.6.m6.1.1"><ci id="S3.SS1.p2.6.m6.1.1.1.cmml" xref="S3.SS1.p2.6.m6.1.1.1">¯</ci><ci id="S3.SS1.p2.6.m6.1.1.2.cmml" xref="S3.SS1.p2.6.m6.1.1.2">𝑎</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p2.6.m6.1c">\bar{a}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p2.6.m6.1d">over¯ start_ARG italic_a end_ARG</annotation></semantics></math>. Datasets under this later triplet form are commonly used in Contrastive Learning approaches. We call <math alttext="C" class="ltx_Math" display="inline" id="S3.SS1.p2.7.m7.1"><semantics id="S3.SS1.p2.7.m7.1a"><mi id="S3.SS1.p2.7.m7.1.1" xref="S3.SS1.p2.7.m7.1.1.cmml">C</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p2.7.m7.1b"><ci id="S3.SS1.p2.7.m7.1.1.cmml" xref="S3.SS1.p2.7.m7.1.1">𝐶</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p2.7.m7.1c">C</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p2.7.m7.1d">italic_C</annotation></semantics></math>, a subset of demonstrations retrieved from <math alttext="\mathcal{D}" class="ltx_Math" display="inline" id="S3.SS1.p2.8.m8.1"><semantics id="S3.SS1.p2.8.m8.1a"><mi class="ltx_font_mathcaligraphic" id="S3.SS1.p2.8.m8.1.1" xref="S3.SS1.p2.8.m8.1.1.cmml">𝒟</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p2.8.m8.1b"><ci id="S3.SS1.p2.8.m8.1.1.cmml" xref="S3.SS1.p2.8.m8.1.1">𝒟</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p2.8.m8.1c">\mathcal{D}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p2.8.m8.1d">caligraphic_D</annotation></semantics></math>, the context.</p>
</div>
<div class="ltx_para" id="S3.SS1.p3">
<table class="ltx_equation ltx_eqn_table" id="S3.Ex1">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="C\subset\mathcal{D}=\big{\{}(q_{i},a_{i},\bar{a}_{i}),\dots,(q_{n},a_{n},\bar{%
a}_{n})\big{\}}" class="ltx_Math" display="block" id="S3.Ex1.m1.3"><semantics id="S3.Ex1.m1.3a"><mrow id="S3.Ex1.m1.3.3" xref="S3.Ex1.m1.3.3.cmml"><mi id="S3.Ex1.m1.3.3.4" xref="S3.Ex1.m1.3.3.4.cmml">C</mi><mo id="S3.Ex1.m1.3.3.5" xref="S3.Ex1.m1.3.3.5.cmml">⊂</mo><mi class="ltx_font_mathcaligraphic" id="S3.Ex1.m1.3.3.6" xref="S3.Ex1.m1.3.3.6.cmml">𝒟</mi><mo id="S3.Ex1.m1.3.3.7" xref="S3.Ex1.m1.3.3.7.cmml">=</mo><mrow id="S3.Ex1.m1.3.3.2.2" xref="S3.Ex1.m1.3.3.2.3.cmml"><mo id="S3.Ex1.m1.3.3.2.2.3" maxsize="120%" minsize="120%" xref="S3.Ex1.m1.3.3.2.3.cmml">{</mo><mrow id="S3.Ex1.m1.2.2.1.1.1.3" xref="S3.Ex1.m1.2.2.1.1.1.4.cmml"><mo id="S3.Ex1.m1.2.2.1.1.1.3.4" stretchy="false" xref="S3.Ex1.m1.2.2.1.1.1.4.cmml">(</mo><msub id="S3.Ex1.m1.2.2.1.1.1.1.1" xref="S3.Ex1.m1.2.2.1.1.1.1.1.cmml"><mi id="S3.Ex1.m1.2.2.1.1.1.1.1.2" xref="S3.Ex1.m1.2.2.1.1.1.1.1.2.cmml">q</mi><mi id="S3.Ex1.m1.2.2.1.1.1.1.1.3" xref="S3.Ex1.m1.2.2.1.1.1.1.1.3.cmml">i</mi></msub><mo id="S3.Ex1.m1.2.2.1.1.1.3.5" xref="S3.Ex1.m1.2.2.1.1.1.4.cmml">,</mo><msub id="S3.Ex1.m1.2.2.1.1.1.2.2" xref="S3.Ex1.m1.2.2.1.1.1.2.2.cmml"><mi id="S3.Ex1.m1.2.2.1.1.1.2.2.2" xref="S3.Ex1.m1.2.2.1.1.1.2.2.2.cmml">a</mi><mi id="S3.Ex1.m1.2.2.1.1.1.2.2.3" xref="S3.Ex1.m1.2.2.1.1.1.2.2.3.cmml">i</mi></msub><mo id="S3.Ex1.m1.2.2.1.1.1.3.6" xref="S3.Ex1.m1.2.2.1.1.1.4.cmml">,</mo><msub id="S3.Ex1.m1.2.2.1.1.1.3.3" xref="S3.Ex1.m1.2.2.1.1.1.3.3.cmml"><mover accent="true" id="S3.Ex1.m1.2.2.1.1.1.3.3.2" xref="S3.Ex1.m1.2.2.1.1.1.3.3.2.cmml"><mi id="S3.Ex1.m1.2.2.1.1.1.3.3.2.2" xref="S3.Ex1.m1.2.2.1.1.1.3.3.2.2.cmml">a</mi><mo id="S3.Ex1.m1.2.2.1.1.1.3.3.2.1" xref="S3.Ex1.m1.2.2.1.1.1.3.3.2.1.cmml">¯</mo></mover><mi id="S3.Ex1.m1.2.2.1.1.1.3.3.3" xref="S3.Ex1.m1.2.2.1.1.1.3.3.3.cmml">i</mi></msub><mo id="S3.Ex1.m1.2.2.1.1.1.3.7" stretchy="false" xref="S3.Ex1.m1.2.2.1.1.1.4.cmml">)</mo></mrow><mo id="S3.Ex1.m1.3.3.2.2.4" xref="S3.Ex1.m1.3.3.2.3.cmml">,</mo><mi id="S3.Ex1.m1.1.1" mathvariant="normal" xref="S3.Ex1.m1.1.1.cmml">…</mi><mo id="S3.Ex1.m1.3.3.2.2.5" xref="S3.Ex1.m1.3.3.2.3.cmml">,</mo><mrow id="S3.Ex1.m1.3.3.2.2.2.3" xref="S3.Ex1.m1.3.3.2.2.2.4.cmml"><mo id="S3.Ex1.m1.3.3.2.2.2.3.4" stretchy="false" xref="S3.Ex1.m1.3.3.2.2.2.4.cmml">(</mo><msub id="S3.Ex1.m1.3.3.2.2.2.1.1" xref="S3.Ex1.m1.3.3.2.2.2.1.1.cmml"><mi id="S3.Ex1.m1.3.3.2.2.2.1.1.2" xref="S3.Ex1.m1.3.3.2.2.2.1.1.2.cmml">q</mi><mi id="S3.Ex1.m1.3.3.2.2.2.1.1.3" xref="S3.Ex1.m1.3.3.2.2.2.1.1.3.cmml">n</mi></msub><mo id="S3.Ex1.m1.3.3.2.2.2.3.5" xref="S3.Ex1.m1.3.3.2.2.2.4.cmml">,</mo><msub id="S3.Ex1.m1.3.3.2.2.2.2.2" xref="S3.Ex1.m1.3.3.2.2.2.2.2.cmml"><mi id="S3.Ex1.m1.3.3.2.2.2.2.2.2" xref="S3.Ex1.m1.3.3.2.2.2.2.2.2.cmml">a</mi><mi id="S3.Ex1.m1.3.3.2.2.2.2.2.3" xref="S3.Ex1.m1.3.3.2.2.2.2.2.3.cmml">n</mi></msub><mo id="S3.Ex1.m1.3.3.2.2.2.3.6" xref="S3.Ex1.m1.3.3.2.2.2.4.cmml">,</mo><msub id="S3.Ex1.m1.3.3.2.2.2.3.3" xref="S3.Ex1.m1.3.3.2.2.2.3.3.cmml"><mover accent="true" id="S3.Ex1.m1.3.3.2.2.2.3.3.2" xref="S3.Ex1.m1.3.3.2.2.2.3.3.2.cmml"><mi id="S3.Ex1.m1.3.3.2.2.2.3.3.2.2" xref="S3.Ex1.m1.3.3.2.2.2.3.3.2.2.cmml">a</mi><mo id="S3.Ex1.m1.3.3.2.2.2.3.3.2.1" xref="S3.Ex1.m1.3.3.2.2.2.3.3.2.1.cmml">¯</mo></mover><mi id="S3.Ex1.m1.3.3.2.2.2.3.3.3" xref="S3.Ex1.m1.3.3.2.2.2.3.3.3.cmml">n</mi></msub><mo id="S3.Ex1.m1.3.3.2.2.2.3.7" stretchy="false" xref="S3.Ex1.m1.3.3.2.2.2.4.cmml">)</mo></mrow><mo id="S3.Ex1.m1.3.3.2.2.6" maxsize="120%" minsize="120%" xref="S3.Ex1.m1.3.3.2.3.cmml">}</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.Ex1.m1.3b"><apply id="S3.Ex1.m1.3.3.cmml" xref="S3.Ex1.m1.3.3"><and id="S3.Ex1.m1.3.3a.cmml" xref="S3.Ex1.m1.3.3"></and><apply id="S3.Ex1.m1.3.3b.cmml" xref="S3.Ex1.m1.3.3"><subset id="S3.Ex1.m1.3.3.5.cmml" xref="S3.Ex1.m1.3.3.5"></subset><ci id="S3.Ex1.m1.3.3.4.cmml" xref="S3.Ex1.m1.3.3.4">𝐶</ci><ci id="S3.Ex1.m1.3.3.6.cmml" xref="S3.Ex1.m1.3.3.6">𝒟</ci></apply><apply id="S3.Ex1.m1.3.3c.cmml" xref="S3.Ex1.m1.3.3"><eq id="S3.Ex1.m1.3.3.7.cmml" xref="S3.Ex1.m1.3.3.7"></eq><share href="https://arxiv.org/html/2405.17587v2#S3.Ex1.m1.3.3.6.cmml" id="S3.Ex1.m1.3.3d.cmml" xref="S3.Ex1.m1.3.3"></share><set id="S3.Ex1.m1.3.3.2.3.cmml" xref="S3.Ex1.m1.3.3.2.2"><vector id="S3.Ex1.m1.2.2.1.1.1.4.cmml" xref="S3.Ex1.m1.2.2.1.1.1.3"><apply id="S3.Ex1.m1.2.2.1.1.1.1.1.cmml" xref="S3.Ex1.m1.2.2.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.Ex1.m1.2.2.1.1.1.1.1.1.cmml" xref="S3.Ex1.m1.2.2.1.1.1.1.1">subscript</csymbol><ci id="S3.Ex1.m1.2.2.1.1.1.1.1.2.cmml" xref="S3.Ex1.m1.2.2.1.1.1.1.1.2">𝑞</ci><ci id="S3.Ex1.m1.2.2.1.1.1.1.1.3.cmml" xref="S3.Ex1.m1.2.2.1.1.1.1.1.3">𝑖</ci></apply><apply id="S3.Ex1.m1.2.2.1.1.1.2.2.cmml" xref="S3.Ex1.m1.2.2.1.1.1.2.2"><csymbol cd="ambiguous" id="S3.Ex1.m1.2.2.1.1.1.2.2.1.cmml" xref="S3.Ex1.m1.2.2.1.1.1.2.2">subscript</csymbol><ci id="S3.Ex1.m1.2.2.1.1.1.2.2.2.cmml" xref="S3.Ex1.m1.2.2.1.1.1.2.2.2">𝑎</ci><ci id="S3.Ex1.m1.2.2.1.1.1.2.2.3.cmml" xref="S3.Ex1.m1.2.2.1.1.1.2.2.3">𝑖</ci></apply><apply id="S3.Ex1.m1.2.2.1.1.1.3.3.cmml" xref="S3.Ex1.m1.2.2.1.1.1.3.3"><csymbol cd="ambiguous" id="S3.Ex1.m1.2.2.1.1.1.3.3.1.cmml" xref="S3.Ex1.m1.2.2.1.1.1.3.3">subscript</csymbol><apply id="S3.Ex1.m1.2.2.1.1.1.3.3.2.cmml" xref="S3.Ex1.m1.2.2.1.1.1.3.3.2"><ci id="S3.Ex1.m1.2.2.1.1.1.3.3.2.1.cmml" xref="S3.Ex1.m1.2.2.1.1.1.3.3.2.1">¯</ci><ci id="S3.Ex1.m1.2.2.1.1.1.3.3.2.2.cmml" xref="S3.Ex1.m1.2.2.1.1.1.3.3.2.2">𝑎</ci></apply><ci id="S3.Ex1.m1.2.2.1.1.1.3.3.3.cmml" xref="S3.Ex1.m1.2.2.1.1.1.3.3.3">𝑖</ci></apply></vector><ci id="S3.Ex1.m1.1.1.cmml" xref="S3.Ex1.m1.1.1">…</ci><vector id="S3.Ex1.m1.3.3.2.2.2.4.cmml" xref="S3.Ex1.m1.3.3.2.2.2.3"><apply id="S3.Ex1.m1.3.3.2.2.2.1.1.cmml" xref="S3.Ex1.m1.3.3.2.2.2.1.1"><csymbol cd="ambiguous" id="S3.Ex1.m1.3.3.2.2.2.1.1.1.cmml" xref="S3.Ex1.m1.3.3.2.2.2.1.1">subscript</csymbol><ci id="S3.Ex1.m1.3.3.2.2.2.1.1.2.cmml" xref="S3.Ex1.m1.3.3.2.2.2.1.1.2">𝑞</ci><ci id="S3.Ex1.m1.3.3.2.2.2.1.1.3.cmml" xref="S3.Ex1.m1.3.3.2.2.2.1.1.3">𝑛</ci></apply><apply id="S3.Ex1.m1.3.3.2.2.2.2.2.cmml" xref="S3.Ex1.m1.3.3.2.2.2.2.2"><csymbol cd="ambiguous" id="S3.Ex1.m1.3.3.2.2.2.2.2.1.cmml" xref="S3.Ex1.m1.3.3.2.2.2.2.2">subscript</csymbol><ci id="S3.Ex1.m1.3.3.2.2.2.2.2.2.cmml" xref="S3.Ex1.m1.3.3.2.2.2.2.2.2">𝑎</ci><ci id="S3.Ex1.m1.3.3.2.2.2.2.2.3.cmml" xref="S3.Ex1.m1.3.3.2.2.2.2.2.3">𝑛</ci></apply><apply id="S3.Ex1.m1.3.3.2.2.2.3.3.cmml" xref="S3.Ex1.m1.3.3.2.2.2.3.3"><csymbol cd="ambiguous" id="S3.Ex1.m1.3.3.2.2.2.3.3.1.cmml" xref="S3.Ex1.m1.3.3.2.2.2.3.3">subscript</csymbol><apply id="S3.Ex1.m1.3.3.2.2.2.3.3.2.cmml" xref="S3.Ex1.m1.3.3.2.2.2.3.3.2"><ci id="S3.Ex1.m1.3.3.2.2.2.3.3.2.1.cmml" xref="S3.Ex1.m1.3.3.2.2.2.3.3.2.1">¯</ci><ci id="S3.Ex1.m1.3.3.2.2.2.3.3.2.2.cmml" xref="S3.Ex1.m1.3.3.2.2.2.3.3.2.2">𝑎</ci></apply><ci id="S3.Ex1.m1.3.3.2.2.2.3.3.3.cmml" xref="S3.Ex1.m1.3.3.2.2.2.3.3.3">𝑛</ci></apply></vector></set></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.Ex1.m1.3c">C\subset\mathcal{D}=\big{\{}(q_{i},a_{i},\bar{a}_{i}),\dots,(q_{n},a_{n},\bar{%
a}_{n})\big{\}}</annotation><annotation encoding="application/x-llamapun" id="S3.Ex1.m1.3d">italic_C ⊂ caligraphic_D = { ( italic_q start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT , italic_a start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT , over¯ start_ARG italic_a end_ARG start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT ) , … , ( italic_q start_POSTSUBSCRIPT italic_n end_POSTSUBSCRIPT , italic_a start_POSTSUBSCRIPT italic_n end_POSTSUBSCRIPT , over¯ start_ARG italic_a end_ARG start_POSTSUBSCRIPT italic_n end_POSTSUBSCRIPT ) }</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
</div>
<div class="ltx_para" id="S3.SS1.p4">
<p class="ltx_p" id="S3.SS1.p4.8">Given an auto-regressive LLM <math alttext="M" class="ltx_Math" display="inline" id="S3.SS1.p4.1.m1.1"><semantics id="S3.SS1.p4.1.m1.1a"><mi id="S3.SS1.p4.1.m1.1.1" xref="S3.SS1.p4.1.m1.1.1.cmml">M</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p4.1.m1.1b"><ci id="S3.SS1.p4.1.m1.1.1.cmml" xref="S3.SS1.p4.1.m1.1.1">𝑀</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p4.1.m1.1c">M</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p4.1.m1.1d">italic_M</annotation></semantics></math>, the query <math alttext="q" class="ltx_Math" display="inline" id="S3.SS1.p4.2.m2.1"><semantics id="S3.SS1.p4.2.m2.1a"><mi id="S3.SS1.p4.2.m2.1.1" xref="S3.SS1.p4.2.m2.1.1.cmml">q</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p4.2.m2.1b"><ci id="S3.SS1.p4.2.m2.1.1.cmml" xref="S3.SS1.p4.2.m2.1.1">𝑞</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p4.2.m2.1c">q</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p4.2.m2.1d">italic_q</annotation></semantics></math>, and a retrieved context <math alttext="C" class="ltx_Math" display="inline" id="S3.SS1.p4.3.m3.1"><semantics id="S3.SS1.p4.3.m3.1a"><mi id="S3.SS1.p4.3.m3.1.1" xref="S3.SS1.p4.3.m3.1.1.cmml">C</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p4.3.m3.1b"><ci id="S3.SS1.p4.3.m3.1.1.cmml" xref="S3.SS1.p4.3.m3.1.1">𝐶</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p4.3.m3.1c">C</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p4.3.m3.1d">italic_C</annotation></semantics></math>, we define <math alttext="p_{M}(a\mid q,C)" class="ltx_Math" display="inline" id="S3.SS1.p4.4.m4.3"><semantics id="S3.SS1.p4.4.m4.3a"><mrow id="S3.SS1.p4.4.m4.3.3" xref="S3.SS1.p4.4.m4.3.3.cmml"><msub id="S3.SS1.p4.4.m4.3.3.3" xref="S3.SS1.p4.4.m4.3.3.3.cmml"><mi id="S3.SS1.p4.4.m4.3.3.3.2" xref="S3.SS1.p4.4.m4.3.3.3.2.cmml">p</mi><mi id="S3.SS1.p4.4.m4.3.3.3.3" xref="S3.SS1.p4.4.m4.3.3.3.3.cmml">M</mi></msub><mo id="S3.SS1.p4.4.m4.3.3.2" xref="S3.SS1.p4.4.m4.3.3.2.cmml">⁢</mo><mrow id="S3.SS1.p4.4.m4.3.3.1.1" xref="S3.SS1.p4.4.m4.3.3.1.1.1.cmml"><mo id="S3.SS1.p4.4.m4.3.3.1.1.2" stretchy="false" xref="S3.SS1.p4.4.m4.3.3.1.1.1.cmml">(</mo><mrow id="S3.SS1.p4.4.m4.3.3.1.1.1" xref="S3.SS1.p4.4.m4.3.3.1.1.1.cmml"><mi id="S3.SS1.p4.4.m4.3.3.1.1.1.2" xref="S3.SS1.p4.4.m4.3.3.1.1.1.2.cmml">a</mi><mo id="S3.SS1.p4.4.m4.3.3.1.1.1.1" xref="S3.SS1.p4.4.m4.3.3.1.1.1.1.cmml">∣</mo><mrow id="S3.SS1.p4.4.m4.3.3.1.1.1.3.2" xref="S3.SS1.p4.4.m4.3.3.1.1.1.3.1.cmml"><mi id="S3.SS1.p4.4.m4.1.1" xref="S3.SS1.p4.4.m4.1.1.cmml">q</mi><mo id="S3.SS1.p4.4.m4.3.3.1.1.1.3.2.1" xref="S3.SS1.p4.4.m4.3.3.1.1.1.3.1.cmml">,</mo><mi id="S3.SS1.p4.4.m4.2.2" xref="S3.SS1.p4.4.m4.2.2.cmml">C</mi></mrow></mrow><mo id="S3.SS1.p4.4.m4.3.3.1.1.3" stretchy="false" xref="S3.SS1.p4.4.m4.3.3.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p4.4.m4.3b"><apply id="S3.SS1.p4.4.m4.3.3.cmml" xref="S3.SS1.p4.4.m4.3.3"><times id="S3.SS1.p4.4.m4.3.3.2.cmml" xref="S3.SS1.p4.4.m4.3.3.2"></times><apply id="S3.SS1.p4.4.m4.3.3.3.cmml" xref="S3.SS1.p4.4.m4.3.3.3"><csymbol cd="ambiguous" id="S3.SS1.p4.4.m4.3.3.3.1.cmml" xref="S3.SS1.p4.4.m4.3.3.3">subscript</csymbol><ci id="S3.SS1.p4.4.m4.3.3.3.2.cmml" xref="S3.SS1.p4.4.m4.3.3.3.2">𝑝</ci><ci id="S3.SS1.p4.4.m4.3.3.3.3.cmml" xref="S3.SS1.p4.4.m4.3.3.3.3">𝑀</ci></apply><apply id="S3.SS1.p4.4.m4.3.3.1.1.1.cmml" xref="S3.SS1.p4.4.m4.3.3.1.1"><csymbol cd="latexml" id="S3.SS1.p4.4.m4.3.3.1.1.1.1.cmml" xref="S3.SS1.p4.4.m4.3.3.1.1.1.1">conditional</csymbol><ci id="S3.SS1.p4.4.m4.3.3.1.1.1.2.cmml" xref="S3.SS1.p4.4.m4.3.3.1.1.1.2">𝑎</ci><list id="S3.SS1.p4.4.m4.3.3.1.1.1.3.1.cmml" xref="S3.SS1.p4.4.m4.3.3.1.1.1.3.2"><ci id="S3.SS1.p4.4.m4.1.1.cmml" xref="S3.SS1.p4.4.m4.1.1">𝑞</ci><ci id="S3.SS1.p4.4.m4.2.2.cmml" xref="S3.SS1.p4.4.m4.2.2">𝐶</ci></list></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p4.4.m4.3c">p_{M}(a\mid q,C)</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p4.4.m4.3d">italic_p start_POSTSUBSCRIPT italic_M end_POSTSUBSCRIPT ( italic_a ∣ italic_q , italic_C )</annotation></semantics></math> the probability that <math alttext="M" class="ltx_Math" display="inline" id="S3.SS1.p4.5.m5.1"><semantics id="S3.SS1.p4.5.m5.1a"><mi id="S3.SS1.p4.5.m5.1.1" xref="S3.SS1.p4.5.m5.1.1.cmml">M</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p4.5.m5.1b"><ci id="S3.SS1.p4.5.m5.1.1.cmml" xref="S3.SS1.p4.5.m5.1.1">𝑀</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p4.5.m5.1c">M</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p4.5.m5.1d">italic_M</annotation></semantics></math> generates the answer <math alttext="a" class="ltx_Math" display="inline" id="S3.SS1.p4.6.m6.1"><semantics id="S3.SS1.p4.6.m6.1a"><mi id="S3.SS1.p4.6.m6.1.1" xref="S3.SS1.p4.6.m6.1.1.cmml">a</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p4.6.m6.1b"><ci id="S3.SS1.p4.6.m6.1.1.cmml" xref="S3.SS1.p4.6.m6.1.1">𝑎</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p4.6.m6.1c">a</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p4.6.m6.1d">italic_a</annotation></semantics></math>.
In practice, the tokens of the examples from the context <math alttext="C" class="ltx_Math" display="inline" id="S3.SS1.p4.7.m7.1"><semantics id="S3.SS1.p4.7.m7.1a"><mi id="S3.SS1.p4.7.m7.1.1" xref="S3.SS1.p4.7.m7.1.1.cmml">C</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p4.7.m7.1b"><ci id="S3.SS1.p4.7.m7.1.1.cmml" xref="S3.SS1.p4.7.m7.1.1">𝐶</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p4.7.m7.1c">C</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p4.7.m7.1d">italic_C</annotation></semantics></math> are appended to the tokens of the query <math alttext="q" class="ltx_Math" display="inline" id="S3.SS1.p4.8.m8.1"><semantics id="S3.SS1.p4.8.m8.1a"><mi id="S3.SS1.p4.8.m8.1.1" xref="S3.SS1.p4.8.m8.1.1.cmml">q</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p4.8.m8.1b"><ci id="S3.SS1.p4.8.m8.1.1.cmml" xref="S3.SS1.p4.8.m8.1.1">𝑞</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p4.8.m8.1c">q</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p4.8.m8.1d">italic_q</annotation></semantics></math>, using prompt formatting techniques that may be optimized to a specific LLM.</p>
</div>
<div class="ltx_para" id="S3.SS1.p5">
<p class="ltx_p" id="S3.SS1.p5.6">Putting it all together, for an unseen query <math alttext="q" class="ltx_Math" display="inline" id="S3.SS1.p5.1.m1.1"><semantics id="S3.SS1.p5.1.m1.1a"><mi id="S3.SS1.p5.1.m1.1.1" xref="S3.SS1.p5.1.m1.1.1.cmml">q</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p5.1.m1.1b"><ci id="S3.SS1.p5.1.m1.1.1.cmml" xref="S3.SS1.p5.1.m1.1.1">𝑞</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p5.1.m1.1c">q</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p5.1.m1.1d">italic_q</annotation></semantics></math> and unseen correct answer <math alttext="a" class="ltx_Math" display="inline" id="S3.SS1.p5.2.m2.1"><semantics id="S3.SS1.p5.2.m2.1a"><mi id="S3.SS1.p5.2.m2.1.1" xref="S3.SS1.p5.2.m2.1.1.cmml">a</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p5.2.m2.1b"><ci id="S3.SS1.p5.2.m2.1.1.cmml" xref="S3.SS1.p5.2.m2.1.1">𝑎</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p5.2.m2.1c">a</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p5.2.m2.1d">italic_a</annotation></semantics></math>, a few-shot retriever <math alttext="R_{\mathcal{D}}" class="ltx_Math" display="inline" id="S3.SS1.p5.3.m3.1"><semantics id="S3.SS1.p5.3.m3.1a"><msub id="S3.SS1.p5.3.m3.1.1" xref="S3.SS1.p5.3.m3.1.1.cmml"><mi id="S3.SS1.p5.3.m3.1.1.2" xref="S3.SS1.p5.3.m3.1.1.2.cmml">R</mi><mi class="ltx_font_mathcaligraphic" id="S3.SS1.p5.3.m3.1.1.3" xref="S3.SS1.p5.3.m3.1.1.3.cmml">𝒟</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.p5.3.m3.1b"><apply id="S3.SS1.p5.3.m3.1.1.cmml" xref="S3.SS1.p5.3.m3.1.1"><csymbol cd="ambiguous" id="S3.SS1.p5.3.m3.1.1.1.cmml" xref="S3.SS1.p5.3.m3.1.1">subscript</csymbol><ci id="S3.SS1.p5.3.m3.1.1.2.cmml" xref="S3.SS1.p5.3.m3.1.1.2">𝑅</ci><ci id="S3.SS1.p5.3.m3.1.1.3.cmml" xref="S3.SS1.p5.3.m3.1.1.3">𝒟</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p5.3.m3.1c">R_{\mathcal{D}}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p5.3.m3.1d">italic_R start_POSTSUBSCRIPT caligraphic_D end_POSTSUBSCRIPT</annotation></semantics></math> must efficiently retrieve a subset of <math alttext="k" class="ltx_Math" display="inline" id="S3.SS1.p5.4.m4.1"><semantics id="S3.SS1.p5.4.m4.1a"><mi id="S3.SS1.p5.4.m4.1.1" xref="S3.SS1.p5.4.m4.1.1.cmml">k</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p5.4.m4.1b"><ci id="S3.SS1.p5.4.m4.1.1.cmml" xref="S3.SS1.p5.4.m4.1.1">𝑘</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p5.4.m4.1c">k</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p5.4.m4.1d">italic_k</annotation></semantics></math> demonstrations <math alttext="R_{\mathcal{D}}(q)\in\mathcal{D}^{k}" class="ltx_Math" display="inline" id="S3.SS1.p5.5.m5.1"><semantics id="S3.SS1.p5.5.m5.1a"><mrow id="S3.SS1.p5.5.m5.1.2" xref="S3.SS1.p5.5.m5.1.2.cmml"><mrow id="S3.SS1.p5.5.m5.1.2.2" xref="S3.SS1.p5.5.m5.1.2.2.cmml"><msub id="S3.SS1.p5.5.m5.1.2.2.2" xref="S3.SS1.p5.5.m5.1.2.2.2.cmml"><mi id="S3.SS1.p5.5.m5.1.2.2.2.2" xref="S3.SS1.p5.5.m5.1.2.2.2.2.cmml">R</mi><mi class="ltx_font_mathcaligraphic" id="S3.SS1.p5.5.m5.1.2.2.2.3" xref="S3.SS1.p5.5.m5.1.2.2.2.3.cmml">𝒟</mi></msub><mo id="S3.SS1.p5.5.m5.1.2.2.1" xref="S3.SS1.p5.5.m5.1.2.2.1.cmml">⁢</mo><mrow id="S3.SS1.p5.5.m5.1.2.2.3.2" xref="S3.SS1.p5.5.m5.1.2.2.cmml"><mo id="S3.SS1.p5.5.m5.1.2.2.3.2.1" stretchy="false" xref="S3.SS1.p5.5.m5.1.2.2.cmml">(</mo><mi id="S3.SS1.p5.5.m5.1.1" xref="S3.SS1.p5.5.m5.1.1.cmml">q</mi><mo id="S3.SS1.p5.5.m5.1.2.2.3.2.2" stretchy="false" xref="S3.SS1.p5.5.m5.1.2.2.cmml">)</mo></mrow></mrow><mo id="S3.SS1.p5.5.m5.1.2.1" xref="S3.SS1.p5.5.m5.1.2.1.cmml">∈</mo><msup id="S3.SS1.p5.5.m5.1.2.3" xref="S3.SS1.p5.5.m5.1.2.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS1.p5.5.m5.1.2.3.2" xref="S3.SS1.p5.5.m5.1.2.3.2.cmml">𝒟</mi><mi id="S3.SS1.p5.5.m5.1.2.3.3" xref="S3.SS1.p5.5.m5.1.2.3.3.cmml">k</mi></msup></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p5.5.m5.1b"><apply id="S3.SS1.p5.5.m5.1.2.cmml" xref="S3.SS1.p5.5.m5.1.2"><in id="S3.SS1.p5.5.m5.1.2.1.cmml" xref="S3.SS1.p5.5.m5.1.2.1"></in><apply id="S3.SS1.p5.5.m5.1.2.2.cmml" xref="S3.SS1.p5.5.m5.1.2.2"><times id="S3.SS1.p5.5.m5.1.2.2.1.cmml" xref="S3.SS1.p5.5.m5.1.2.2.1"></times><apply id="S3.SS1.p5.5.m5.1.2.2.2.cmml" xref="S3.SS1.p5.5.m5.1.2.2.2"><csymbol cd="ambiguous" id="S3.SS1.p5.5.m5.1.2.2.2.1.cmml" xref="S3.SS1.p5.5.m5.1.2.2.2">subscript</csymbol><ci id="S3.SS1.p5.5.m5.1.2.2.2.2.cmml" xref="S3.SS1.p5.5.m5.1.2.2.2.2">𝑅</ci><ci id="S3.SS1.p5.5.m5.1.2.2.2.3.cmml" xref="S3.SS1.p5.5.m5.1.2.2.2.3">𝒟</ci></apply><ci id="S3.SS1.p5.5.m5.1.1.cmml" xref="S3.SS1.p5.5.m5.1.1">𝑞</ci></apply><apply id="S3.SS1.p5.5.m5.1.2.3.cmml" xref="S3.SS1.p5.5.m5.1.2.3"><csymbol cd="ambiguous" id="S3.SS1.p5.5.m5.1.2.3.1.cmml" xref="S3.SS1.p5.5.m5.1.2.3">superscript</csymbol><ci id="S3.SS1.p5.5.m5.1.2.3.2.cmml" xref="S3.SS1.p5.5.m5.1.2.3.2">𝒟</ci><ci id="S3.SS1.p5.5.m5.1.2.3.3.cmml" xref="S3.SS1.p5.5.m5.1.2.3.3">𝑘</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p5.5.m5.1c">R_{\mathcal{D}}(q)\in\mathcal{D}^{k}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p5.5.m5.1d">italic_R start_POSTSUBSCRIPT caligraphic_D end_POSTSUBSCRIPT ( italic_q ) ∈ caligraphic_D start_POSTSUPERSCRIPT italic_k end_POSTSUPERSCRIPT</annotation></semantics></math>
such that <math alttext="p_{M}(a\mid q,R_{\mathcal{D}}(q))" class="ltx_Math" display="inline" id="S3.SS1.p5.6.m6.3"><semantics id="S3.SS1.p5.6.m6.3a"><mrow id="S3.SS1.p5.6.m6.3.3" xref="S3.SS1.p5.6.m6.3.3.cmml"><msub id="S3.SS1.p5.6.m6.3.3.3" xref="S3.SS1.p5.6.m6.3.3.3.cmml"><mi id="S3.SS1.p5.6.m6.3.3.3.2" xref="S3.SS1.p5.6.m6.3.3.3.2.cmml">p</mi><mi id="S3.SS1.p5.6.m6.3.3.3.3" xref="S3.SS1.p5.6.m6.3.3.3.3.cmml">M</mi></msub><mo id="S3.SS1.p5.6.m6.3.3.2" xref="S3.SS1.p5.6.m6.3.3.2.cmml">⁢</mo><mrow id="S3.SS1.p5.6.m6.3.3.1.1" xref="S3.SS1.p5.6.m6.3.3.1.1.1.cmml"><mo id="S3.SS1.p5.6.m6.3.3.1.1.2" stretchy="false" xref="S3.SS1.p5.6.m6.3.3.1.1.1.cmml">(</mo><mrow id="S3.SS1.p5.6.m6.3.3.1.1.1" xref="S3.SS1.p5.6.m6.3.3.1.1.1.cmml"><mi id="S3.SS1.p5.6.m6.3.3.1.1.1.3" xref="S3.SS1.p5.6.m6.3.3.1.1.1.3.cmml">a</mi><mo id="S3.SS1.p5.6.m6.3.3.1.1.1.2" xref="S3.SS1.p5.6.m6.3.3.1.1.1.2.cmml">∣</mo><mrow id="S3.SS1.p5.6.m6.3.3.1.1.1.1.1" xref="S3.SS1.p5.6.m6.3.3.1.1.1.1.2.cmml"><mi id="S3.SS1.p5.6.m6.2.2" xref="S3.SS1.p5.6.m6.2.2.cmml">q</mi><mo id="S3.SS1.p5.6.m6.3.3.1.1.1.1.1.2" xref="S3.SS1.p5.6.m6.3.3.1.1.1.1.2.cmml">,</mo><mrow id="S3.SS1.p5.6.m6.3.3.1.1.1.1.1.1" xref="S3.SS1.p5.6.m6.3.3.1.1.1.1.1.1.cmml"><msub id="S3.SS1.p5.6.m6.3.3.1.1.1.1.1.1.2" xref="S3.SS1.p5.6.m6.3.3.1.1.1.1.1.1.2.cmml"><mi id="S3.SS1.p5.6.m6.3.3.1.1.1.1.1.1.2.2" xref="S3.SS1.p5.6.m6.3.3.1.1.1.1.1.1.2.2.cmml">R</mi><mi class="ltx_font_mathcaligraphic" id="S3.SS1.p5.6.m6.3.3.1.1.1.1.1.1.2.3" xref="S3.SS1.p5.6.m6.3.3.1.1.1.1.1.1.2.3.cmml">𝒟</mi></msub><mo id="S3.SS1.p5.6.m6.3.3.1.1.1.1.1.1.1" xref="S3.SS1.p5.6.m6.3.3.1.1.1.1.1.1.1.cmml">⁢</mo><mrow id="S3.SS1.p5.6.m6.3.3.1.1.1.1.1.1.3.2" xref="S3.SS1.p5.6.m6.3.3.1.1.1.1.1.1.cmml"><mo id="S3.SS1.p5.6.m6.3.3.1.1.1.1.1.1.3.2.1" stretchy="false" xref="S3.SS1.p5.6.m6.3.3.1.1.1.1.1.1.cmml">(</mo><mi id="S3.SS1.p5.6.m6.1.1" xref="S3.SS1.p5.6.m6.1.1.cmml">q</mi><mo id="S3.SS1.p5.6.m6.3.3.1.1.1.1.1.1.3.2.2" stretchy="false" xref="S3.SS1.p5.6.m6.3.3.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow></mrow><mo id="S3.SS1.p5.6.m6.3.3.1.1.3" stretchy="false" xref="S3.SS1.p5.6.m6.3.3.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p5.6.m6.3b"><apply id="S3.SS1.p5.6.m6.3.3.cmml" xref="S3.SS1.p5.6.m6.3.3"><times id="S3.SS1.p5.6.m6.3.3.2.cmml" xref="S3.SS1.p5.6.m6.3.3.2"></times><apply id="S3.SS1.p5.6.m6.3.3.3.cmml" xref="S3.SS1.p5.6.m6.3.3.3"><csymbol cd="ambiguous" id="S3.SS1.p5.6.m6.3.3.3.1.cmml" xref="S3.SS1.p5.6.m6.3.3.3">subscript</csymbol><ci id="S3.SS1.p5.6.m6.3.3.3.2.cmml" xref="S3.SS1.p5.6.m6.3.3.3.2">𝑝</ci><ci id="S3.SS1.p5.6.m6.3.3.3.3.cmml" xref="S3.SS1.p5.6.m6.3.3.3.3">𝑀</ci></apply><apply id="S3.SS1.p5.6.m6.3.3.1.1.1.cmml" xref="S3.SS1.p5.6.m6.3.3.1.1"><csymbol cd="latexml" id="S3.SS1.p5.6.m6.3.3.1.1.1.2.cmml" xref="S3.SS1.p5.6.m6.3.3.1.1.1.2">conditional</csymbol><ci id="S3.SS1.p5.6.m6.3.3.1.1.1.3.cmml" xref="S3.SS1.p5.6.m6.3.3.1.1.1.3">𝑎</ci><list id="S3.SS1.p5.6.m6.3.3.1.1.1.1.2.cmml" xref="S3.SS1.p5.6.m6.3.3.1.1.1.1.1"><ci id="S3.SS1.p5.6.m6.2.2.cmml" xref="S3.SS1.p5.6.m6.2.2">𝑞</ci><apply id="S3.SS1.p5.6.m6.3.3.1.1.1.1.1.1.cmml" xref="S3.SS1.p5.6.m6.3.3.1.1.1.1.1.1"><times id="S3.SS1.p5.6.m6.3.3.1.1.1.1.1.1.1.cmml" xref="S3.SS1.p5.6.m6.3.3.1.1.1.1.1.1.1"></times><apply id="S3.SS1.p5.6.m6.3.3.1.1.1.1.1.1.2.cmml" xref="S3.SS1.p5.6.m6.3.3.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.SS1.p5.6.m6.3.3.1.1.1.1.1.1.2.1.cmml" xref="S3.SS1.p5.6.m6.3.3.1.1.1.1.1.1.2">subscript</csymbol><ci id="S3.SS1.p5.6.m6.3.3.1.1.1.1.1.1.2.2.cmml" xref="S3.SS1.p5.6.m6.3.3.1.1.1.1.1.1.2.2">𝑅</ci><ci id="S3.SS1.p5.6.m6.3.3.1.1.1.1.1.1.2.3.cmml" xref="S3.SS1.p5.6.m6.3.3.1.1.1.1.1.1.2.3">𝒟</ci></apply><ci id="S3.SS1.p5.6.m6.1.1.cmml" xref="S3.SS1.p5.6.m6.1.1">𝑞</ci></apply></list></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p5.6.m6.3c">p_{M}(a\mid q,R_{\mathcal{D}}(q))</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p5.6.m6.3d">italic_p start_POSTSUBSCRIPT italic_M end_POSTSUBSCRIPT ( italic_a ∣ italic_q , italic_R start_POSTSUBSCRIPT caligraphic_D end_POSTSUBSCRIPT ( italic_q ) )</annotation></semantics></math> is maximized.</p>
</div>
</section>
<section class="ltx_subsection" id="S3.SS2">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.2 </span>Evaluation</h3>
<div class="ltx_para" id="S3.SS2.p1">
<p class="ltx_p" id="S3.SS2.p1.6">Consider the probability of generating the correct answer <math alttext="a" class="ltx_Math" display="inline" id="S3.SS2.p1.1.m1.1"><semantics id="S3.SS2.p1.1.m1.1a"><mi id="S3.SS2.p1.1.m1.1.1" xref="S3.SS2.p1.1.m1.1.1.cmml">a</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.1.m1.1b"><ci id="S3.SS2.p1.1.m1.1.1.cmml" xref="S3.SS2.p1.1.m1.1.1">𝑎</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.1.m1.1c">a</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p1.1.m1.1d">italic_a</annotation></semantics></math> given an empty context <math alttext="p_{M}(a\mid q)" class="ltx_Math" display="inline" id="S3.SS2.p1.2.m2.1"><semantics id="S3.SS2.p1.2.m2.1a"><mrow id="S3.SS2.p1.2.m2.1.1" xref="S3.SS2.p1.2.m2.1.1.cmml"><msub id="S3.SS2.p1.2.m2.1.1.3" xref="S3.SS2.p1.2.m2.1.1.3.cmml"><mi id="S3.SS2.p1.2.m2.1.1.3.2" xref="S3.SS2.p1.2.m2.1.1.3.2.cmml">p</mi><mi id="S3.SS2.p1.2.m2.1.1.3.3" xref="S3.SS2.p1.2.m2.1.1.3.3.cmml">M</mi></msub><mo id="S3.SS2.p1.2.m2.1.1.2" xref="S3.SS2.p1.2.m2.1.1.2.cmml">⁢</mo><mrow id="S3.SS2.p1.2.m2.1.1.1.1" xref="S3.SS2.p1.2.m2.1.1.1.1.1.cmml"><mo id="S3.SS2.p1.2.m2.1.1.1.1.2" stretchy="false" xref="S3.SS2.p1.2.m2.1.1.1.1.1.cmml">(</mo><mrow id="S3.SS2.p1.2.m2.1.1.1.1.1" xref="S3.SS2.p1.2.m2.1.1.1.1.1.cmml"><mi id="S3.SS2.p1.2.m2.1.1.1.1.1.2" xref="S3.SS2.p1.2.m2.1.1.1.1.1.2.cmml">a</mi><mo id="S3.SS2.p1.2.m2.1.1.1.1.1.1" xref="S3.SS2.p1.2.m2.1.1.1.1.1.1.cmml">∣</mo><mi id="S3.SS2.p1.2.m2.1.1.1.1.1.3" xref="S3.SS2.p1.2.m2.1.1.1.1.1.3.cmml">q</mi></mrow><mo id="S3.SS2.p1.2.m2.1.1.1.1.3" stretchy="false" xref="S3.SS2.p1.2.m2.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.2.m2.1b"><apply id="S3.SS2.p1.2.m2.1.1.cmml" xref="S3.SS2.p1.2.m2.1.1"><times id="S3.SS2.p1.2.m2.1.1.2.cmml" xref="S3.SS2.p1.2.m2.1.1.2"></times><apply id="S3.SS2.p1.2.m2.1.1.3.cmml" xref="S3.SS2.p1.2.m2.1.1.3"><csymbol cd="ambiguous" id="S3.SS2.p1.2.m2.1.1.3.1.cmml" xref="S3.SS2.p1.2.m2.1.1.3">subscript</csymbol><ci id="S3.SS2.p1.2.m2.1.1.3.2.cmml" xref="S3.SS2.p1.2.m2.1.1.3.2">𝑝</ci><ci id="S3.SS2.p1.2.m2.1.1.3.3.cmml" xref="S3.SS2.p1.2.m2.1.1.3.3">𝑀</ci></apply><apply id="S3.SS2.p1.2.m2.1.1.1.1.1.cmml" xref="S3.SS2.p1.2.m2.1.1.1.1"><csymbol cd="latexml" id="S3.SS2.p1.2.m2.1.1.1.1.1.1.cmml" xref="S3.SS2.p1.2.m2.1.1.1.1.1.1">conditional</csymbol><ci id="S3.SS2.p1.2.m2.1.1.1.1.1.2.cmml" xref="S3.SS2.p1.2.m2.1.1.1.1.1.2">𝑎</ci><ci id="S3.SS2.p1.2.m2.1.1.1.1.1.3.cmml" xref="S3.SS2.p1.2.m2.1.1.1.1.1.3">𝑞</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.2.m2.1c">p_{M}(a\mid q)</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p1.2.m2.1d">italic_p start_POSTSUBSCRIPT italic_M end_POSTSUBSCRIPT ( italic_a ∣ italic_q )</annotation></semantics></math>. We are interested in evaluating how much the context <math alttext="C" class="ltx_Math" display="inline" id="S3.SS2.p1.3.m3.1"><semantics id="S3.SS2.p1.3.m3.1a"><mi id="S3.SS2.p1.3.m3.1.1" xref="S3.SS2.p1.3.m3.1.1.cmml">C</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.3.m3.1b"><ci id="S3.SS2.p1.3.m3.1.1.cmml" xref="S3.SS2.p1.3.m3.1.1">𝐶</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.3.m3.1c">C</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p1.3.m3.1d">italic_C</annotation></semantics></math> increases the probability of the correct answer <math alttext="a" class="ltx_Math" display="inline" id="S3.SS2.p1.4.m4.1"><semantics id="S3.SS2.p1.4.m4.1a"><mi id="S3.SS2.p1.4.m4.1.1" xref="S3.SS2.p1.4.m4.1.1.cmml">a</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.4.m4.1b"><ci id="S3.SS2.p1.4.m4.1.1.cmml" xref="S3.SS2.p1.4.m4.1.1">𝑎</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.4.m4.1c">a</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p1.4.m4.1d">italic_a</annotation></semantics></math>. That is, we want a metric which is related to difference of <math alttext="p_{M}(a\mid q,C)" class="ltx_Math" display="inline" id="S3.SS2.p1.5.m5.3"><semantics id="S3.SS2.p1.5.m5.3a"><mrow id="S3.SS2.p1.5.m5.3.3" xref="S3.SS2.p1.5.m5.3.3.cmml"><msub id="S3.SS2.p1.5.m5.3.3.3" xref="S3.SS2.p1.5.m5.3.3.3.cmml"><mi id="S3.SS2.p1.5.m5.3.3.3.2" xref="S3.SS2.p1.5.m5.3.3.3.2.cmml">p</mi><mi id="S3.SS2.p1.5.m5.3.3.3.3" xref="S3.SS2.p1.5.m5.3.3.3.3.cmml">M</mi></msub><mo id="S3.SS2.p1.5.m5.3.3.2" xref="S3.SS2.p1.5.m5.3.3.2.cmml">⁢</mo><mrow id="S3.SS2.p1.5.m5.3.3.1.1" xref="S3.SS2.p1.5.m5.3.3.1.1.1.cmml"><mo id="S3.SS2.p1.5.m5.3.3.1.1.2" stretchy="false" xref="S3.SS2.p1.5.m5.3.3.1.1.1.cmml">(</mo><mrow id="S3.SS2.p1.5.m5.3.3.1.1.1" xref="S3.SS2.p1.5.m5.3.3.1.1.1.cmml"><mi id="S3.SS2.p1.5.m5.3.3.1.1.1.2" xref="S3.SS2.p1.5.m5.3.3.1.1.1.2.cmml">a</mi><mo id="S3.SS2.p1.5.m5.3.3.1.1.1.1" xref="S3.SS2.p1.5.m5.3.3.1.1.1.1.cmml">∣</mo><mrow id="S3.SS2.p1.5.m5.3.3.1.1.1.3.2" xref="S3.SS2.p1.5.m5.3.3.1.1.1.3.1.cmml"><mi id="S3.SS2.p1.5.m5.1.1" xref="S3.SS2.p1.5.m5.1.1.cmml">q</mi><mo id="S3.SS2.p1.5.m5.3.3.1.1.1.3.2.1" xref="S3.SS2.p1.5.m5.3.3.1.1.1.3.1.cmml">,</mo><mi id="S3.SS2.p1.5.m5.2.2" xref="S3.SS2.p1.5.m5.2.2.cmml">C</mi></mrow></mrow><mo id="S3.SS2.p1.5.m5.3.3.1.1.3" stretchy="false" xref="S3.SS2.p1.5.m5.3.3.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.5.m5.3b"><apply id="S3.SS2.p1.5.m5.3.3.cmml" xref="S3.SS2.p1.5.m5.3.3"><times id="S3.SS2.p1.5.m5.3.3.2.cmml" xref="S3.SS2.p1.5.m5.3.3.2"></times><apply id="S3.SS2.p1.5.m5.3.3.3.cmml" xref="S3.SS2.p1.5.m5.3.3.3"><csymbol cd="ambiguous" id="S3.SS2.p1.5.m5.3.3.3.1.cmml" xref="S3.SS2.p1.5.m5.3.3.3">subscript</csymbol><ci id="S3.SS2.p1.5.m5.3.3.3.2.cmml" xref="S3.SS2.p1.5.m5.3.3.3.2">𝑝</ci><ci id="S3.SS2.p1.5.m5.3.3.3.3.cmml" xref="S3.SS2.p1.5.m5.3.3.3.3">𝑀</ci></apply><apply id="S3.SS2.p1.5.m5.3.3.1.1.1.cmml" xref="S3.SS2.p1.5.m5.3.3.1.1"><csymbol cd="latexml" id="S3.SS2.p1.5.m5.3.3.1.1.1.1.cmml" xref="S3.SS2.p1.5.m5.3.3.1.1.1.1">conditional</csymbol><ci id="S3.SS2.p1.5.m5.3.3.1.1.1.2.cmml" xref="S3.SS2.p1.5.m5.3.3.1.1.1.2">𝑎</ci><list id="S3.SS2.p1.5.m5.3.3.1.1.1.3.1.cmml" xref="S3.SS2.p1.5.m5.3.3.1.1.1.3.2"><ci id="S3.SS2.p1.5.m5.1.1.cmml" xref="S3.SS2.p1.5.m5.1.1">𝑞</ci><ci id="S3.SS2.p1.5.m5.2.2.cmml" xref="S3.SS2.p1.5.m5.2.2">𝐶</ci></list></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.5.m5.3c">p_{M}(a\mid q,C)</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p1.5.m5.3d">italic_p start_POSTSUBSCRIPT italic_M end_POSTSUBSCRIPT ( italic_a ∣ italic_q , italic_C )</annotation></semantics></math> and <math alttext="p_{M}(a\mid q)" class="ltx_Math" display="inline" id="S3.SS2.p1.6.m6.1"><semantics id="S3.SS2.p1.6.m6.1a"><mrow id="S3.SS2.p1.6.m6.1.1" xref="S3.SS2.p1.6.m6.1.1.cmml"><msub id="S3.SS2.p1.6.m6.1.1.3" xref="S3.SS2.p1.6.m6.1.1.3.cmml"><mi id="S3.SS2.p1.6.m6.1.1.3.2" xref="S3.SS2.p1.6.m6.1.1.3.2.cmml">p</mi><mi id="S3.SS2.p1.6.m6.1.1.3.3" xref="S3.SS2.p1.6.m6.1.1.3.3.cmml">M</mi></msub><mo id="S3.SS2.p1.6.m6.1.1.2" xref="S3.SS2.p1.6.m6.1.1.2.cmml">⁢</mo><mrow id="S3.SS2.p1.6.m6.1.1.1.1" xref="S3.SS2.p1.6.m6.1.1.1.1.1.cmml"><mo id="S3.SS2.p1.6.m6.1.1.1.1.2" stretchy="false" xref="S3.SS2.p1.6.m6.1.1.1.1.1.cmml">(</mo><mrow id="S3.SS2.p1.6.m6.1.1.1.1.1" xref="S3.SS2.p1.6.m6.1.1.1.1.1.cmml"><mi id="S3.SS2.p1.6.m6.1.1.1.1.1.2" xref="S3.SS2.p1.6.m6.1.1.1.1.1.2.cmml">a</mi><mo id="S3.SS2.p1.6.m6.1.1.1.1.1.1" xref="S3.SS2.p1.6.m6.1.1.1.1.1.1.cmml">∣</mo><mi id="S3.SS2.p1.6.m6.1.1.1.1.1.3" xref="S3.SS2.p1.6.m6.1.1.1.1.1.3.cmml">q</mi></mrow><mo id="S3.SS2.p1.6.m6.1.1.1.1.3" stretchy="false" xref="S3.SS2.p1.6.m6.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.6.m6.1b"><apply id="S3.SS2.p1.6.m6.1.1.cmml" xref="S3.SS2.p1.6.m6.1.1"><times id="S3.SS2.p1.6.m6.1.1.2.cmml" xref="S3.SS2.p1.6.m6.1.1.2"></times><apply id="S3.SS2.p1.6.m6.1.1.3.cmml" xref="S3.SS2.p1.6.m6.1.1.3"><csymbol cd="ambiguous" id="S3.SS2.p1.6.m6.1.1.3.1.cmml" xref="S3.SS2.p1.6.m6.1.1.3">subscript</csymbol><ci id="S3.SS2.p1.6.m6.1.1.3.2.cmml" xref="S3.SS2.p1.6.m6.1.1.3.2">𝑝</ci><ci id="S3.SS2.p1.6.m6.1.1.3.3.cmml" xref="S3.SS2.p1.6.m6.1.1.3.3">𝑀</ci></apply><apply id="S3.SS2.p1.6.m6.1.1.1.1.1.cmml" xref="S3.SS2.p1.6.m6.1.1.1.1"><csymbol cd="latexml" id="S3.SS2.p1.6.m6.1.1.1.1.1.1.cmml" xref="S3.SS2.p1.6.m6.1.1.1.1.1.1">conditional</csymbol><ci id="S3.SS2.p1.6.m6.1.1.1.1.1.2.cmml" xref="S3.SS2.p1.6.m6.1.1.1.1.1.2">𝑎</ci><ci id="S3.SS2.p1.6.m6.1.1.1.1.1.3.cmml" xref="S3.SS2.p1.6.m6.1.1.1.1.1.3">𝑞</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.6.m6.1c">p_{M}(a\mid q)</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p1.6.m6.1d">italic_p start_POSTSUBSCRIPT italic_M end_POSTSUBSCRIPT ( italic_a ∣ italic_q )</annotation></semantics></math>.</p>
</div>
<div class="ltx_para" id="S3.SS2.p2">
<p class="ltx_p" id="S3.SS2.p2.8">In a pure retrieval setting, we would be interested in finding the context <math alttext="C" class="ltx_Math" display="inline" id="S3.SS2.p2.1.m1.1"><semantics id="S3.SS2.p2.1.m1.1a"><mi id="S3.SS2.p2.1.m1.1.1" xref="S3.SS2.p2.1.m1.1.1.cmml">C</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p2.1.m1.1b"><ci id="S3.SS2.p2.1.m1.1.1.cmml" xref="S3.SS2.p2.1.m1.1.1">𝐶</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p2.1.m1.1c">C</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p2.1.m1.1d">italic_C</annotation></semantics></math> which contains the <math alttext="k" class="ltx_Math" display="inline" id="S3.SS2.p2.2.m2.1"><semantics id="S3.SS2.p2.2.m2.1a"><mi id="S3.SS2.p2.2.m2.1.1" xref="S3.SS2.p2.2.m2.1.1.cmml">k</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p2.2.m2.1b"><ci id="S3.SS2.p2.2.m2.1.1.cmml" xref="S3.SS2.p2.2.m2.1.1">𝑘</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p2.2.m2.1c">k</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p2.2.m2.1d">italic_k</annotation></semantics></math> demonstrations that are most similar to the <math alttext="q" class="ltx_Math" display="inline" id="S3.SS2.p2.3.m3.1"><semantics id="S3.SS2.p2.3.m3.1a"><mi id="S3.SS2.p2.3.m3.1.1" xref="S3.SS2.p2.3.m3.1.1.cmml">q</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p2.3.m3.1b"><ci id="S3.SS2.p2.3.m3.1.1.cmml" xref="S3.SS2.p2.3.m3.1.1">𝑞</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p2.3.m3.1c">q</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p2.3.m3.1d">italic_q</annotation></semantics></math>. And we could argue that if there exists a smooth function <math alttext="f:q\to a" class="ltx_Math" display="inline" id="S3.SS2.p2.4.m4.1"><semantics id="S3.SS2.p2.4.m4.1a"><mrow id="S3.SS2.p2.4.m4.1.1" xref="S3.SS2.p2.4.m4.1.1.cmml"><mi id="S3.SS2.p2.4.m4.1.1.2" xref="S3.SS2.p2.4.m4.1.1.2.cmml">f</mi><mo id="S3.SS2.p2.4.m4.1.1.1" lspace="0.278em" rspace="0.278em" xref="S3.SS2.p2.4.m4.1.1.1.cmml">:</mo><mrow id="S3.SS2.p2.4.m4.1.1.3" xref="S3.SS2.p2.4.m4.1.1.3.cmml"><mi id="S3.SS2.p2.4.m4.1.1.3.2" xref="S3.SS2.p2.4.m4.1.1.3.2.cmml">q</mi><mo id="S3.SS2.p2.4.m4.1.1.3.1" stretchy="false" xref="S3.SS2.p2.4.m4.1.1.3.1.cmml">→</mo><mi id="S3.SS2.p2.4.m4.1.1.3.3" xref="S3.SS2.p2.4.m4.1.1.3.3.cmml">a</mi></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p2.4.m4.1b"><apply id="S3.SS2.p2.4.m4.1.1.cmml" xref="S3.SS2.p2.4.m4.1.1"><ci id="S3.SS2.p2.4.m4.1.1.1.cmml" xref="S3.SS2.p2.4.m4.1.1.1">:</ci><ci id="S3.SS2.p2.4.m4.1.1.2.cmml" xref="S3.SS2.p2.4.m4.1.1.2">𝑓</ci><apply id="S3.SS2.p2.4.m4.1.1.3.cmml" xref="S3.SS2.p2.4.m4.1.1.3"><ci id="S3.SS2.p2.4.m4.1.1.3.1.cmml" xref="S3.SS2.p2.4.m4.1.1.3.1">→</ci><ci id="S3.SS2.p2.4.m4.1.1.3.2.cmml" xref="S3.SS2.p2.4.m4.1.1.3.2">𝑞</ci><ci id="S3.SS2.p2.4.m4.1.1.3.3.cmml" xref="S3.SS2.p2.4.m4.1.1.3.3">𝑎</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p2.4.m4.1c">f:q\to a</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p2.4.m4.1d">italic_f : italic_q → italic_a</annotation></semantics></math> which maps a query to its correct answer, then by retrieving the demonstrations whose queries are nearest to <math alttext="q" class="ltx_Math" display="inline" id="S3.SS2.p2.5.m5.1"><semantics id="S3.SS2.p2.5.m5.1a"><mi id="S3.SS2.p2.5.m5.1.1" xref="S3.SS2.p2.5.m5.1.1.cmml">q</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p2.5.m5.1b"><ci id="S3.SS2.p2.5.m5.1.1.cmml" xref="S3.SS2.p2.5.m5.1.1">𝑞</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p2.5.m5.1c">q</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p2.5.m5.1d">italic_q</annotation></semantics></math>, we should also be retrieving the answers which are closest to <math alttext="a" class="ltx_Math" display="inline" id="S3.SS2.p2.6.m6.1"><semantics id="S3.SS2.p2.6.m6.1a"><mi id="S3.SS2.p2.6.m6.1.1" xref="S3.SS2.p2.6.m6.1.1.cmml">a</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p2.6.m6.1b"><ci id="S3.SS2.p2.6.m6.1.1.cmml" xref="S3.SS2.p2.6.m6.1.1">𝑎</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p2.6.m6.1c">a</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p2.6.m6.1d">italic_a</annotation></semantics></math>, and this should help the language model <math alttext="M" class="ltx_Math" display="inline" id="S3.SS2.p2.7.m7.1"><semantics id="S3.SS2.p2.7.m7.1a"><mi id="S3.SS2.p2.7.m7.1.1" xref="S3.SS2.p2.7.m7.1.1.cmml">M</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p2.7.m7.1b"><ci id="S3.SS2.p2.7.m7.1.1.cmml" xref="S3.SS2.p2.7.m7.1.1">𝑀</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p2.7.m7.1c">M</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p2.7.m7.1d">italic_M</annotation></semantics></math> generate the correct answer <math alttext="a" class="ltx_Math" display="inline" id="S3.SS2.p2.8.m8.1"><semantics id="S3.SS2.p2.8.m8.1a"><mi id="S3.SS2.p2.8.m8.1.1" xref="S3.SS2.p2.8.m8.1.1.cmml">a</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p2.8.m8.1b"><ci id="S3.SS2.p2.8.m8.1.1.cmml" xref="S3.SS2.p2.8.m8.1.1">𝑎</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p2.8.m8.1c">a</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p2.8.m8.1d">italic_a</annotation></semantics></math>.</p>
</div>
<div class="ltx_para" id="S3.SS2.p3">
<p class="ltx_p" id="S3.SS2.p3.8">However, it is doubtful that the space in which <math alttext="q" class="ltx_Math" display="inline" id="S3.SS2.p3.1.m1.1"><semantics id="S3.SS2.p3.1.m1.1a"><mi id="S3.SS2.p3.1.m1.1.1" xref="S3.SS2.p3.1.m1.1.1.cmml">q</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p3.1.m1.1b"><ci id="S3.SS2.p3.1.m1.1.1.cmml" xref="S3.SS2.p3.1.m1.1.1">𝑞</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p3.1.m1.1c">q</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p3.1.m1.1d">italic_q</annotation></semantics></math> is compared to the demonstrations is one in which the function <math alttext="f:q\to a" class="ltx_Math" display="inline" id="S3.SS2.p3.2.m2.1"><semantics id="S3.SS2.p3.2.m2.1a"><mrow id="S3.SS2.p3.2.m2.1.1" xref="S3.SS2.p3.2.m2.1.1.cmml"><mi id="S3.SS2.p3.2.m2.1.1.2" xref="S3.SS2.p3.2.m2.1.1.2.cmml">f</mi><mo id="S3.SS2.p3.2.m2.1.1.1" lspace="0.278em" rspace="0.278em" xref="S3.SS2.p3.2.m2.1.1.1.cmml">:</mo><mrow id="S3.SS2.p3.2.m2.1.1.3" xref="S3.SS2.p3.2.m2.1.1.3.cmml"><mi id="S3.SS2.p3.2.m2.1.1.3.2" xref="S3.SS2.p3.2.m2.1.1.3.2.cmml">q</mi><mo id="S3.SS2.p3.2.m2.1.1.3.1" stretchy="false" xref="S3.SS2.p3.2.m2.1.1.3.1.cmml">→</mo><mi id="S3.SS2.p3.2.m2.1.1.3.3" xref="S3.SS2.p3.2.m2.1.1.3.3.cmml">a</mi></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p3.2.m2.1b"><apply id="S3.SS2.p3.2.m2.1.1.cmml" xref="S3.SS2.p3.2.m2.1.1"><ci id="S3.SS2.p3.2.m2.1.1.1.cmml" xref="S3.SS2.p3.2.m2.1.1.1">:</ci><ci id="S3.SS2.p3.2.m2.1.1.2.cmml" xref="S3.SS2.p3.2.m2.1.1.2">𝑓</ci><apply id="S3.SS2.p3.2.m2.1.1.3.cmml" xref="S3.SS2.p3.2.m2.1.1.3"><ci id="S3.SS2.p3.2.m2.1.1.3.1.cmml" xref="S3.SS2.p3.2.m2.1.1.3.1">→</ci><ci id="S3.SS2.p3.2.m2.1.1.3.2.cmml" xref="S3.SS2.p3.2.m2.1.1.3.2">𝑞</ci><ci id="S3.SS2.p3.2.m2.1.1.3.3.cmml" xref="S3.SS2.p3.2.m2.1.1.3.3">𝑎</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p3.2.m2.1c">f:q\to a</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p3.2.m2.1d">italic_f : italic_q → italic_a</annotation></semantics></math> is smooth, so it is not necessarily true that the retrieved answers are closest to <math alttext="a" class="ltx_Math" display="inline" id="S3.SS2.p3.3.m3.1"><semantics id="S3.SS2.p3.3.m3.1a"><mi id="S3.SS2.p3.3.m3.1.1" xref="S3.SS2.p3.3.m3.1.1.cmml">a</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p3.3.m3.1b"><ci id="S3.SS2.p3.3.m3.1.1.cmml" xref="S3.SS2.p3.3.m3.1.1">𝑎</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p3.3.m3.1c">a</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p3.3.m3.1d">italic_a</annotation></semantics></math>. Nor is it necessarily true that <math alttext="p_{M}(a\mid q,C)" class="ltx_Math" display="inline" id="S3.SS2.p3.4.m4.3"><semantics id="S3.SS2.p3.4.m4.3a"><mrow id="S3.SS2.p3.4.m4.3.3" xref="S3.SS2.p3.4.m4.3.3.cmml"><msub id="S3.SS2.p3.4.m4.3.3.3" xref="S3.SS2.p3.4.m4.3.3.3.cmml"><mi id="S3.SS2.p3.4.m4.3.3.3.2" xref="S3.SS2.p3.4.m4.3.3.3.2.cmml">p</mi><mi id="S3.SS2.p3.4.m4.3.3.3.3" xref="S3.SS2.p3.4.m4.3.3.3.3.cmml">M</mi></msub><mo id="S3.SS2.p3.4.m4.3.3.2" xref="S3.SS2.p3.4.m4.3.3.2.cmml">⁢</mo><mrow id="S3.SS2.p3.4.m4.3.3.1.1" xref="S3.SS2.p3.4.m4.3.3.1.1.1.cmml"><mo id="S3.SS2.p3.4.m4.3.3.1.1.2" stretchy="false" xref="S3.SS2.p3.4.m4.3.3.1.1.1.cmml">(</mo><mrow id="S3.SS2.p3.4.m4.3.3.1.1.1" xref="S3.SS2.p3.4.m4.3.3.1.1.1.cmml"><mi id="S3.SS2.p3.4.m4.3.3.1.1.1.2" xref="S3.SS2.p3.4.m4.3.3.1.1.1.2.cmml">a</mi><mo id="S3.SS2.p3.4.m4.3.3.1.1.1.1" xref="S3.SS2.p3.4.m4.3.3.1.1.1.1.cmml">∣</mo><mrow id="S3.SS2.p3.4.m4.3.3.1.1.1.3.2" xref="S3.SS2.p3.4.m4.3.3.1.1.1.3.1.cmml"><mi id="S3.SS2.p3.4.m4.1.1" xref="S3.SS2.p3.4.m4.1.1.cmml">q</mi><mo id="S3.SS2.p3.4.m4.3.3.1.1.1.3.2.1" xref="S3.SS2.p3.4.m4.3.3.1.1.1.3.1.cmml">,</mo><mi id="S3.SS2.p3.4.m4.2.2" xref="S3.SS2.p3.4.m4.2.2.cmml">C</mi></mrow></mrow><mo id="S3.SS2.p3.4.m4.3.3.1.1.3" stretchy="false" xref="S3.SS2.p3.4.m4.3.3.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p3.4.m4.3b"><apply id="S3.SS2.p3.4.m4.3.3.cmml" xref="S3.SS2.p3.4.m4.3.3"><times id="S3.SS2.p3.4.m4.3.3.2.cmml" xref="S3.SS2.p3.4.m4.3.3.2"></times><apply id="S3.SS2.p3.4.m4.3.3.3.cmml" xref="S3.SS2.p3.4.m4.3.3.3"><csymbol cd="ambiguous" id="S3.SS2.p3.4.m4.3.3.3.1.cmml" xref="S3.SS2.p3.4.m4.3.3.3">subscript</csymbol><ci id="S3.SS2.p3.4.m4.3.3.3.2.cmml" xref="S3.SS2.p3.4.m4.3.3.3.2">𝑝</ci><ci id="S3.SS2.p3.4.m4.3.3.3.3.cmml" xref="S3.SS2.p3.4.m4.3.3.3.3">𝑀</ci></apply><apply id="S3.SS2.p3.4.m4.3.3.1.1.1.cmml" xref="S3.SS2.p3.4.m4.3.3.1.1"><csymbol cd="latexml" id="S3.SS2.p3.4.m4.3.3.1.1.1.1.cmml" xref="S3.SS2.p3.4.m4.3.3.1.1.1.1">conditional</csymbol><ci id="S3.SS2.p3.4.m4.3.3.1.1.1.2.cmml" xref="S3.SS2.p3.4.m4.3.3.1.1.1.2">𝑎</ci><list id="S3.SS2.p3.4.m4.3.3.1.1.1.3.1.cmml" xref="S3.SS2.p3.4.m4.3.3.1.1.1.3.2"><ci id="S3.SS2.p3.4.m4.1.1.cmml" xref="S3.SS2.p3.4.m4.1.1">𝑞</ci><ci id="S3.SS2.p3.4.m4.2.2.cmml" xref="S3.SS2.p3.4.m4.2.2">𝐶</ci></list></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p3.4.m4.3c">p_{M}(a\mid q,C)</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p3.4.m4.3d">italic_p start_POSTSUBSCRIPT italic_M end_POSTSUBSCRIPT ( italic_a ∣ italic_q , italic_C )</annotation></semantics></math> is maximized when <math alttext="C" class="ltx_Math" display="inline" id="S3.SS2.p3.5.m5.1"><semantics id="S3.SS2.p3.5.m5.1a"><mi id="S3.SS2.p3.5.m5.1.1" xref="S3.SS2.p3.5.m5.1.1.cmml">C</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p3.5.m5.1b"><ci id="S3.SS2.p3.5.m5.1.1.cmml" xref="S3.SS2.p3.5.m5.1.1">𝐶</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p3.5.m5.1c">C</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p3.5.m5.1d">italic_C</annotation></semantics></math> contains those answers closest to <math alttext="a" class="ltx_Math" display="inline" id="S3.SS2.p3.6.m6.1"><semantics id="S3.SS2.p3.6.m6.1a"><mi id="S3.SS2.p3.6.m6.1.1" xref="S3.SS2.p3.6.m6.1.1.cmml">a</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p3.6.m6.1b"><ci id="S3.SS2.p3.6.m6.1.1.cmml" xref="S3.SS2.p3.6.m6.1.1">𝑎</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p3.6.m6.1c">a</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p3.6.m6.1d">italic_a</annotation></semantics></math>. Consider that the answer <math alttext="a" class="ltx_Math" display="inline" id="S3.SS2.p3.7.m7.1"><semantics id="S3.SS2.p3.7.m7.1a"><mi id="S3.SS2.p3.7.m7.1.1" xref="S3.SS2.p3.7.m7.1.1.cmml">a</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p3.7.m7.1b"><ci id="S3.SS2.p3.7.m7.1.1.cmml" xref="S3.SS2.p3.7.m7.1.1">𝑎</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p3.7.m7.1c">a</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p3.7.m7.1d">italic_a</annotation></semantics></math> might depend on some information which isn’t contained in <math alttext="a" class="ltx_Math" display="inline" id="S3.SS2.p3.8.m8.1"><semantics id="S3.SS2.p3.8.m8.1a"><mi id="S3.SS2.p3.8.m8.1.1" xref="S3.SS2.p3.8.m8.1.1.cmml">a</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p3.8.m8.1b"><ci id="S3.SS2.p3.8.m8.1.1.cmml" xref="S3.SS2.p3.8.m8.1.1">𝑎</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p3.8.m8.1c">a</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p3.8.m8.1d">italic_a</annotation></semantics></math> or any nearby answer.</p>
</div>
<div class="ltx_para" id="S3.SS2.p4">
<p class="ltx_p" id="S3.SS2.p4.5">Therefore, we prefer to measure <math alttext="p_{M}(a\mid q,C)" class="ltx_Math" display="inline" id="S3.SS2.p4.1.m1.3"><semantics id="S3.SS2.p4.1.m1.3a"><mrow id="S3.SS2.p4.1.m1.3.3" xref="S3.SS2.p4.1.m1.3.3.cmml"><msub id="S3.SS2.p4.1.m1.3.3.3" xref="S3.SS2.p4.1.m1.3.3.3.cmml"><mi id="S3.SS2.p4.1.m1.3.3.3.2" xref="S3.SS2.p4.1.m1.3.3.3.2.cmml">p</mi><mi id="S3.SS2.p4.1.m1.3.3.3.3" xref="S3.SS2.p4.1.m1.3.3.3.3.cmml">M</mi></msub><mo id="S3.SS2.p4.1.m1.3.3.2" xref="S3.SS2.p4.1.m1.3.3.2.cmml">⁢</mo><mrow id="S3.SS2.p4.1.m1.3.3.1.1" xref="S3.SS2.p4.1.m1.3.3.1.1.1.cmml"><mo id="S3.SS2.p4.1.m1.3.3.1.1.2" stretchy="false" xref="S3.SS2.p4.1.m1.3.3.1.1.1.cmml">(</mo><mrow id="S3.SS2.p4.1.m1.3.3.1.1.1" xref="S3.SS2.p4.1.m1.3.3.1.1.1.cmml"><mi id="S3.SS2.p4.1.m1.3.3.1.1.1.2" xref="S3.SS2.p4.1.m1.3.3.1.1.1.2.cmml">a</mi><mo id="S3.SS2.p4.1.m1.3.3.1.1.1.1" xref="S3.SS2.p4.1.m1.3.3.1.1.1.1.cmml">∣</mo><mrow id="S3.SS2.p4.1.m1.3.3.1.1.1.3.2" xref="S3.SS2.p4.1.m1.3.3.1.1.1.3.1.cmml"><mi id="S3.SS2.p4.1.m1.1.1" xref="S3.SS2.p4.1.m1.1.1.cmml">q</mi><mo id="S3.SS2.p4.1.m1.3.3.1.1.1.3.2.1" xref="S3.SS2.p4.1.m1.3.3.1.1.1.3.1.cmml">,</mo><mi id="S3.SS2.p4.1.m1.2.2" xref="S3.SS2.p4.1.m1.2.2.cmml">C</mi></mrow></mrow><mo id="S3.SS2.p4.1.m1.3.3.1.1.3" stretchy="false" xref="S3.SS2.p4.1.m1.3.3.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p4.1.m1.3b"><apply id="S3.SS2.p4.1.m1.3.3.cmml" xref="S3.SS2.p4.1.m1.3.3"><times id="S3.SS2.p4.1.m1.3.3.2.cmml" xref="S3.SS2.p4.1.m1.3.3.2"></times><apply id="S3.SS2.p4.1.m1.3.3.3.cmml" xref="S3.SS2.p4.1.m1.3.3.3"><csymbol cd="ambiguous" id="S3.SS2.p4.1.m1.3.3.3.1.cmml" xref="S3.SS2.p4.1.m1.3.3.3">subscript</csymbol><ci id="S3.SS2.p4.1.m1.3.3.3.2.cmml" xref="S3.SS2.p4.1.m1.3.3.3.2">𝑝</ci><ci id="S3.SS2.p4.1.m1.3.3.3.3.cmml" xref="S3.SS2.p4.1.m1.3.3.3.3">𝑀</ci></apply><apply id="S3.SS2.p4.1.m1.3.3.1.1.1.cmml" xref="S3.SS2.p4.1.m1.3.3.1.1"><csymbol cd="latexml" id="S3.SS2.p4.1.m1.3.3.1.1.1.1.cmml" xref="S3.SS2.p4.1.m1.3.3.1.1.1.1">conditional</csymbol><ci id="S3.SS2.p4.1.m1.3.3.1.1.1.2.cmml" xref="S3.SS2.p4.1.m1.3.3.1.1.1.2">𝑎</ci><list id="S3.SS2.p4.1.m1.3.3.1.1.1.3.1.cmml" xref="S3.SS2.p4.1.m1.3.3.1.1.1.3.2"><ci id="S3.SS2.p4.1.m1.1.1.cmml" xref="S3.SS2.p4.1.m1.1.1">𝑞</ci><ci id="S3.SS2.p4.1.m1.2.2.cmml" xref="S3.SS2.p4.1.m1.2.2">𝐶</ci></list></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p4.1.m1.3c">p_{M}(a\mid q,C)</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p4.1.m1.3d">italic_p start_POSTSUBSCRIPT italic_M end_POSTSUBSCRIPT ( italic_a ∣ italic_q , italic_C )</annotation></semantics></math> directly. In practice, given that <math alttext="M" class="ltx_Math" display="inline" id="S3.SS2.p4.2.m2.1"><semantics id="S3.SS2.p4.2.m2.1a"><mi id="S3.SS2.p4.2.m2.1.1" xref="S3.SS2.p4.2.m2.1.1.cmml">M</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p4.2.m2.1b"><ci id="S3.SS2.p4.2.m2.1.1.cmml" xref="S3.SS2.p4.2.m2.1.1">𝑀</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p4.2.m2.1c">M</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p4.2.m2.1d">italic_M</annotation></semantics></math> is an auto-regressive language model, this is done by taking the product of the probability of each token generated by <math alttext="M" class="ltx_Math" display="inline" id="S3.SS2.p4.3.m3.1"><semantics id="S3.SS2.p4.3.m3.1a"><mi id="S3.SS2.p4.3.m3.1.1" xref="S3.SS2.p4.3.m3.1.1.cmml">M</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p4.3.m3.1b"><ci id="S3.SS2.p4.3.m3.1.1.cmml" xref="S3.SS2.p4.3.m3.1.1">𝑀</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p4.3.m3.1c">M</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p4.3.m3.1d">italic_M</annotation></semantics></math>. The model generates text sequentially by predicting one token at a time based on the previously generated tokens. Let <math alttext="a=(a_{1},a_{2},\ldots,a_{n})" class="ltx_Math" display="inline" id="S3.SS2.p4.4.m4.4"><semantics id="S3.SS2.p4.4.m4.4a"><mrow id="S3.SS2.p4.4.m4.4.4" xref="S3.SS2.p4.4.m4.4.4.cmml"><mi id="S3.SS2.p4.4.m4.4.4.5" xref="S3.SS2.p4.4.m4.4.4.5.cmml">a</mi><mo id="S3.SS2.p4.4.m4.4.4.4" xref="S3.SS2.p4.4.m4.4.4.4.cmml">=</mo><mrow id="S3.SS2.p4.4.m4.4.4.3.3" xref="S3.SS2.p4.4.m4.4.4.3.4.cmml"><mo id="S3.SS2.p4.4.m4.4.4.3.3.4" stretchy="false" xref="S3.SS2.p4.4.m4.4.4.3.4.cmml">(</mo><msub id="S3.SS2.p4.4.m4.2.2.1.1.1" xref="S3.SS2.p4.4.m4.2.2.1.1.1.cmml"><mi id="S3.SS2.p4.4.m4.2.2.1.1.1.2" xref="S3.SS2.p4.4.m4.2.2.1.1.1.2.cmml">a</mi><mn id="S3.SS2.p4.4.m4.2.2.1.1.1.3" xref="S3.SS2.p4.4.m4.2.2.1.1.1.3.cmml">1</mn></msub><mo id="S3.SS2.p4.4.m4.4.4.3.3.5" xref="S3.SS2.p4.4.m4.4.4.3.4.cmml">,</mo><msub id="S3.SS2.p4.4.m4.3.3.2.2.2" xref="S3.SS2.p4.4.m4.3.3.2.2.2.cmml"><mi id="S3.SS2.p4.4.m4.3.3.2.2.2.2" xref="S3.SS2.p4.4.m4.3.3.2.2.2.2.cmml">a</mi><mn id="S3.SS2.p4.4.m4.3.3.2.2.2.3" xref="S3.SS2.p4.4.m4.3.3.2.2.2.3.cmml">2</mn></msub><mo id="S3.SS2.p4.4.m4.4.4.3.3.6" xref="S3.SS2.p4.4.m4.4.4.3.4.cmml">,</mo><mi id="S3.SS2.p4.4.m4.1.1" mathvariant="normal" xref="S3.SS2.p4.4.m4.1.1.cmml">…</mi><mo id="S3.SS2.p4.4.m4.4.4.3.3.7" xref="S3.SS2.p4.4.m4.4.4.3.4.cmml">,</mo><msub id="S3.SS2.p4.4.m4.4.4.3.3.3" xref="S3.SS2.p4.4.m4.4.4.3.3.3.cmml"><mi id="S3.SS2.p4.4.m4.4.4.3.3.3.2" xref="S3.SS2.p4.4.m4.4.4.3.3.3.2.cmml">a</mi><mi id="S3.SS2.p4.4.m4.4.4.3.3.3.3" xref="S3.SS2.p4.4.m4.4.4.3.3.3.3.cmml">n</mi></msub><mo id="S3.SS2.p4.4.m4.4.4.3.3.8" stretchy="false" xref="S3.SS2.p4.4.m4.4.4.3.4.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p4.4.m4.4b"><apply id="S3.SS2.p4.4.m4.4.4.cmml" xref="S3.SS2.p4.4.m4.4.4"><eq id="S3.SS2.p4.4.m4.4.4.4.cmml" xref="S3.SS2.p4.4.m4.4.4.4"></eq><ci id="S3.SS2.p4.4.m4.4.4.5.cmml" xref="S3.SS2.p4.4.m4.4.4.5">𝑎</ci><vector id="S3.SS2.p4.4.m4.4.4.3.4.cmml" xref="S3.SS2.p4.4.m4.4.4.3.3"><apply id="S3.SS2.p4.4.m4.2.2.1.1.1.cmml" xref="S3.SS2.p4.4.m4.2.2.1.1.1"><csymbol cd="ambiguous" id="S3.SS2.p4.4.m4.2.2.1.1.1.1.cmml" xref="S3.SS2.p4.4.m4.2.2.1.1.1">subscript</csymbol><ci id="S3.SS2.p4.4.m4.2.2.1.1.1.2.cmml" xref="S3.SS2.p4.4.m4.2.2.1.1.1.2">𝑎</ci><cn id="S3.SS2.p4.4.m4.2.2.1.1.1.3.cmml" type="integer" xref="S3.SS2.p4.4.m4.2.2.1.1.1.3">1</cn></apply><apply id="S3.SS2.p4.4.m4.3.3.2.2.2.cmml" xref="S3.SS2.p4.4.m4.3.3.2.2.2"><csymbol cd="ambiguous" id="S3.SS2.p4.4.m4.3.3.2.2.2.1.cmml" xref="S3.SS2.p4.4.m4.3.3.2.2.2">subscript</csymbol><ci id="S3.SS2.p4.4.m4.3.3.2.2.2.2.cmml" xref="S3.SS2.p4.4.m4.3.3.2.2.2.2">𝑎</ci><cn id="S3.SS2.p4.4.m4.3.3.2.2.2.3.cmml" type="integer" xref="S3.SS2.p4.4.m4.3.3.2.2.2.3">2</cn></apply><ci id="S3.SS2.p4.4.m4.1.1.cmml" xref="S3.SS2.p4.4.m4.1.1">…</ci><apply id="S3.SS2.p4.4.m4.4.4.3.3.3.cmml" xref="S3.SS2.p4.4.m4.4.4.3.3.3"><csymbol cd="ambiguous" id="S3.SS2.p4.4.m4.4.4.3.3.3.1.cmml" xref="S3.SS2.p4.4.m4.4.4.3.3.3">subscript</csymbol><ci id="S3.SS2.p4.4.m4.4.4.3.3.3.2.cmml" xref="S3.SS2.p4.4.m4.4.4.3.3.3.2">𝑎</ci><ci id="S3.SS2.p4.4.m4.4.4.3.3.3.3.cmml" xref="S3.SS2.p4.4.m4.4.4.3.3.3.3">𝑛</ci></apply></vector></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p4.4.m4.4c">a=(a_{1},a_{2},\ldots,a_{n})</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p4.4.m4.4d">italic_a = ( italic_a start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT , italic_a start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT , … , italic_a start_POSTSUBSCRIPT italic_n end_POSTSUBSCRIPT )</annotation></semantics></math> represent a sequence of tokens produced by the model. The probability of the model generating the sequence <math alttext="a" class="ltx_Math" display="inline" id="S3.SS2.p4.5.m5.1"><semantics id="S3.SS2.p4.5.m5.1a"><mi id="S3.SS2.p4.5.m5.1.1" xref="S3.SS2.p4.5.m5.1.1.cmml">a</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p4.5.m5.1b"><ci id="S3.SS2.p4.5.m5.1.1.cmml" xref="S3.SS2.p4.5.m5.1.1">𝑎</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p4.5.m5.1c">a</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p4.5.m5.1d">italic_a</annotation></semantics></math> can be expressed as the joint probability of generating each token in the sequence, conditioned on the tokens that precede it. This can be mathematically represented as:</p>
<table class="ltx_equation ltx_eqn_table" id="S3.Ex2">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="p(a)=p(a_{1})\cdot p(a_{2}|a_{1})\cdot p(a_{3}|a_{1},a_{2})\cdots p(a_{n}|a_{1%
},a_{2},\ldots,a_{n-1})" class="ltx_Math" display="block" id="S3.Ex2.m1.6"><semantics id="S3.Ex2.m1.6a"><mrow id="S3.Ex2.m1.6.6" xref="S3.Ex2.m1.6.6.cmml"><mrow id="S3.Ex2.m1.6.6.6" xref="S3.Ex2.m1.6.6.6.cmml"><mi id="S3.Ex2.m1.6.6.6.2" xref="S3.Ex2.m1.6.6.6.2.cmml">p</mi><mo id="S3.Ex2.m1.6.6.6.1" xref="S3.Ex2.m1.6.6.6.1.cmml">⁢</mo><mrow id="S3.Ex2.m1.6.6.6.3.2" xref="S3.Ex2.m1.6.6.6.cmml"><mo id="S3.Ex2.m1.6.6.6.3.2.1" stretchy="false" xref="S3.Ex2.m1.6.6.6.cmml">(</mo><mi id="S3.Ex2.m1.1.1" xref="S3.Ex2.m1.1.1.cmml">a</mi><mo id="S3.Ex2.m1.6.6.6.3.2.2" stretchy="false" xref="S3.Ex2.m1.6.6.6.cmml">)</mo></mrow></mrow><mo id="S3.Ex2.m1.6.6.5" xref="S3.Ex2.m1.6.6.5.cmml">=</mo><mrow id="S3.Ex2.m1.6.6.4" xref="S3.Ex2.m1.6.6.4.cmml"><mrow id="S3.Ex2.m1.4.4.2.2" xref="S3.Ex2.m1.4.4.2.2.cmml"><mrow id="S3.Ex2.m1.4.4.2.2.2" xref="S3.Ex2.m1.4.4.2.2.2.cmml"><mrow id="S3.Ex2.m1.3.3.1.1.1.1" xref="S3.Ex2.m1.3.3.1.1.1.1.cmml"><mrow id="S3.Ex2.m1.3.3.1.1.1.1.1" xref="S3.Ex2.m1.3.3.1.1.1.1.1.cmml"><mi id="S3.Ex2.m1.3.3.1.1.1.1.1.3" xref="S3.Ex2.m1.3.3.1.1.1.1.1.3.cmml">p</mi><mo id="S3.Ex2.m1.3.3.1.1.1.1.1.2" xref="S3.Ex2.m1.3.3.1.1.1.1.1.2.cmml">⁢</mo><mrow id="S3.Ex2.m1.3.3.1.1.1.1.1.1.1" xref="S3.Ex2.m1.3.3.1.1.1.1.1.1.1.1.cmml"><mo id="S3.Ex2.m1.3.3.1.1.1.1.1.1.1.2" stretchy="false" xref="S3.Ex2.m1.3.3.1.1.1.1.1.1.1.1.cmml">(</mo><msub id="S3.Ex2.m1.3.3.1.1.1.1.1.1.1.1" xref="S3.Ex2.m1.3.3.1.1.1.1.1.1.1.1.cmml"><mi id="S3.Ex2.m1.3.3.1.1.1.1.1.1.1.1.2" xref="S3.Ex2.m1.3.3.1.1.1.1.1.1.1.1.2.cmml">a</mi><mn id="S3.Ex2.m1.3.3.1.1.1.1.1.1.1.1.3" xref="S3.Ex2.m1.3.3.1.1.1.1.1.1.1.1.3.cmml">1</mn></msub><mo id="S3.Ex2.m1.3.3.1.1.1.1.1.1.1.3" rspace="0.055em" stretchy="false" xref="S3.Ex2.m1.3.3.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S3.Ex2.m1.3.3.1.1.1.1.2" rspace="0.222em" xref="S3.Ex2.m1.3.3.1.1.1.1.2.cmml">⋅</mo><mi id="S3.Ex2.m1.3.3.1.1.1.1.3" xref="S3.Ex2.m1.3.3.1.1.1.1.3.cmml">p</mi></mrow><mo id="S3.Ex2.m1.4.4.2.2.2.3" xref="S3.Ex2.m1.4.4.2.2.2.3.cmml">⁢</mo><mrow id="S3.Ex2.m1.4.4.2.2.2.2.1" xref="S3.Ex2.m1.4.4.2.2.2.2.1.1.cmml"><mo id="S3.Ex2.m1.4.4.2.2.2.2.1.2" stretchy="false" xref="S3.Ex2.m1.4.4.2.2.2.2.1.1.cmml">(</mo><mrow id="S3.Ex2.m1.4.4.2.2.2.2.1.1" xref="S3.Ex2.m1.4.4.2.2.2.2.1.1.cmml"><msub id="S3.Ex2.m1.4.4.2.2.2.2.1.1.2" xref="S3.Ex2.m1.4.4.2.2.2.2.1.1.2.cmml"><mi id="S3.Ex2.m1.4.4.2.2.2.2.1.1.2.2" xref="S3.Ex2.m1.4.4.2.2.2.2.1.1.2.2.cmml">a</mi><mn id="S3.Ex2.m1.4.4.2.2.2.2.1.1.2.3" xref="S3.Ex2.m1.4.4.2.2.2.2.1.1.2.3.cmml">2</mn></msub><mo fence="false" id="S3.Ex2.m1.4.4.2.2.2.2.1.1.1" xref="S3.Ex2.m1.4.4.2.2.2.2.1.1.1.cmml">|</mo><msub id="S3.Ex2.m1.4.4.2.2.2.2.1.1.3" xref="S3.Ex2.m1.4.4.2.2.2.2.1.1.3.cmml"><mi id="S3.Ex2.m1.4.4.2.2.2.2.1.1.3.2" xref="S3.Ex2.m1.4.4.2.2.2.2.1.1.3.2.cmml">a</mi><mn id="S3.Ex2.m1.4.4.2.2.2.2.1.1.3.3" xref="S3.Ex2.m1.4.4.2.2.2.2.1.1.3.3.cmml">1</mn></msub></mrow><mo id="S3.Ex2.m1.4.4.2.2.2.2.1.3" rspace="0.055em" stretchy="false" xref="S3.Ex2.m1.4.4.2.2.2.2.1.1.cmml">)</mo></mrow></mrow><mo id="S3.Ex2.m1.4.4.2.2.3" rspace="0.222em" xref="S3.Ex2.m1.4.4.2.2.3.cmml">⋅</mo><mi id="S3.Ex2.m1.4.4.2.2.4" xref="S3.Ex2.m1.4.4.2.2.4.cmml">p</mi></mrow><mo id="S3.Ex2.m1.6.6.4.5" xref="S3.Ex2.m1.6.6.4.5.cmml">⁢</mo><mrow id="S3.Ex2.m1.5.5.3.3.1" xref="S3.Ex2.m1.5.5.3.3.1.1.cmml"><mo id="S3.Ex2.m1.5.5.3.3.1.2" stretchy="false" xref="S3.Ex2.m1.5.5.3.3.1.1.cmml">(</mo><mrow id="S3.Ex2.m1.5.5.3.3.1.1" xref="S3.Ex2.m1.5.5.3.3.1.1.cmml"><msub id="S3.Ex2.m1.5.5.3.3.1.1.4" xref="S3.Ex2.m1.5.5.3.3.1.1.4.cmml"><mi id="S3.Ex2.m1.5.5.3.3.1.1.4.2" xref="S3.Ex2.m1.5.5.3.3.1.1.4.2.cmml">a</mi><mn id="S3.Ex2.m1.5.5.3.3.1.1.4.3" xref="S3.Ex2.m1.5.5.3.3.1.1.4.3.cmml">3</mn></msub><mo fence="false" id="S3.Ex2.m1.5.5.3.3.1.1.3" xref="S3.Ex2.m1.5.5.3.3.1.1.3.cmml">|</mo><mrow id="S3.Ex2.m1.5.5.3.3.1.1.2.2" xref="S3.Ex2.m1.5.5.3.3.1.1.2.3.cmml"><msub id="S3.Ex2.m1.5.5.3.3.1.1.1.1.1" xref="S3.Ex2.m1.5.5.3.3.1.1.1.1.1.cmml"><mi id="S3.Ex2.m1.5.5.3.3.1.1.1.1.1.2" xref="S3.Ex2.m1.5.5.3.3.1.1.1.1.1.2.cmml">a</mi><mn id="S3.Ex2.m1.5.5.3.3.1.1.1.1.1.3" xref="S3.Ex2.m1.5.5.3.3.1.1.1.1.1.3.cmml">1</mn></msub><mo id="S3.Ex2.m1.5.5.3.3.1.1.2.2.3" xref="S3.Ex2.m1.5.5.3.3.1.1.2.3.cmml">,</mo><msub id="S3.Ex2.m1.5.5.3.3.1.1.2.2.2" xref="S3.Ex2.m1.5.5.3.3.1.1.2.2.2.cmml"><mi id="S3.Ex2.m1.5.5.3.3.1.1.2.2.2.2" xref="S3.Ex2.m1.5.5.3.3.1.1.2.2.2.2.cmml">a</mi><mn id="S3.Ex2.m1.5.5.3.3.1.1.2.2.2.3" xref="S3.Ex2.m1.5.5.3.3.1.1.2.2.2.3.cmml">2</mn></msub></mrow></mrow><mo id="S3.Ex2.m1.5.5.3.3.1.3" stretchy="false" xref="S3.Ex2.m1.5.5.3.3.1.1.cmml">)</mo></mrow><mo id="S3.Ex2.m1.6.6.4.5a" xref="S3.Ex2.m1.6.6.4.5.cmml">⁢</mo><mi id="S3.Ex2.m1.6.6.4.6" mathvariant="normal" xref="S3.Ex2.m1.6.6.4.6.cmml">⋯</mi><mo id="S3.Ex2.m1.6.6.4.5b" xref="S3.Ex2.m1.6.6.4.5.cmml">⁢</mo><mi id="S3.Ex2.m1.6.6.4.7" xref="S3.Ex2.m1.6.6.4.7.cmml">p</mi><mo id="S3.Ex2.m1.6.6.4.5c" xref="S3.Ex2.m1.6.6.4.5.cmml">⁢</mo><mrow id="S3.Ex2.m1.6.6.4.4.1" xref="S3.Ex2.m1.6.6.4.4.1.1.cmml"><mo id="S3.Ex2.m1.6.6.4.4.1.2" stretchy="false" xref="S3.Ex2.m1.6.6.4.4.1.1.cmml">(</mo><mrow id="S3.Ex2.m1.6.6.4.4.1.1" xref="S3.Ex2.m1.6.6.4.4.1.1.cmml"><msub id="S3.Ex2.m1.6.6.4.4.1.1.5" xref="S3.Ex2.m1.6.6.4.4.1.1.5.cmml"><mi id="S3.Ex2.m1.6.6.4.4.1.1.5.2" xref="S3.Ex2.m1.6.6.4.4.1.1.5.2.cmml">a</mi><mi id="S3.Ex2.m1.6.6.4.4.1.1.5.3" xref="S3.Ex2.m1.6.6.4.4.1.1.5.3.cmml">n</mi></msub><mo fence="false" id="S3.Ex2.m1.6.6.4.4.1.1.4" xref="S3.Ex2.m1.6.6.4.4.1.1.4.cmml">|</mo><mrow id="S3.Ex2.m1.6.6.4.4.1.1.3.3" xref="S3.Ex2.m1.6.6.4.4.1.1.3.4.cmml"><msub id="S3.Ex2.m1.6.6.4.4.1.1.1.1.1" xref="S3.Ex2.m1.6.6.4.4.1.1.1.1.1.cmml"><mi id="S3.Ex2.m1.6.6.4.4.1.1.1.1.1.2" xref="S3.Ex2.m1.6.6.4.4.1.1.1.1.1.2.cmml">a</mi><mn id="S3.Ex2.m1.6.6.4.4.1.1.1.1.1.3" xref="S3.Ex2.m1.6.6.4.4.1.1.1.1.1.3.cmml">1</mn></msub><mo id="S3.Ex2.m1.6.6.4.4.1.1.3.3.4" xref="S3.Ex2.m1.6.6.4.4.1.1.3.4.cmml">,</mo><msub id="S3.Ex2.m1.6.6.4.4.1.1.2.2.2" xref="S3.Ex2.m1.6.6.4.4.1.1.2.2.2.cmml"><mi id="S3.Ex2.m1.6.6.4.4.1.1.2.2.2.2" xref="S3.Ex2.m1.6.6.4.4.1.1.2.2.2.2.cmml">a</mi><mn id="S3.Ex2.m1.6.6.4.4.1.1.2.2.2.3" xref="S3.Ex2.m1.6.6.4.4.1.1.2.2.2.3.cmml">2</mn></msub><mo id="S3.Ex2.m1.6.6.4.4.1.1.3.3.5" xref="S3.Ex2.m1.6.6.4.4.1.1.3.4.cmml">,</mo><mi id="S3.Ex2.m1.2.2" mathvariant="normal" xref="S3.Ex2.m1.2.2.cmml">…</mi><mo id="S3.Ex2.m1.6.6.4.4.1.1.3.3.6" xref="S3.Ex2.m1.6.6.4.4.1.1.3.4.cmml">,</mo><msub id="S3.Ex2.m1.6.6.4.4.1.1.3.3.3" xref="S3.Ex2.m1.6.6.4.4.1.1.3.3.3.cmml"><mi id="S3.Ex2.m1.6.6.4.4.1.1.3.3.3.2" xref="S3.Ex2.m1.6.6.4.4.1.1.3.3.3.2.cmml">a</mi><mrow id="S3.Ex2.m1.6.6.4.4.1.1.3.3.3.3" xref="S3.Ex2.m1.6.6.4.4.1.1.3.3.3.3.cmml"><mi id="S3.Ex2.m1.6.6.4.4.1.1.3.3.3.3.2" xref="S3.Ex2.m1.6.6.4.4.1.1.3.3.3.3.2.cmml">n</mi><mo id="S3.Ex2.m1.6.6.4.4.1.1.3.3.3.3.1" xref="S3.Ex2.m1.6.6.4.4.1.1.3.3.3.3.1.cmml">−</mo><mn id="S3.Ex2.m1.6.6.4.4.1.1.3.3.3.3.3" xref="S3.Ex2.m1.6.6.4.4.1.1.3.3.3.3.3.cmml">1</mn></mrow></msub></mrow></mrow><mo id="S3.Ex2.m1.6.6.4.4.1.3" stretchy="false" xref="S3.Ex2.m1.6.6.4.4.1.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.Ex2.m1.6b"><apply id="S3.Ex2.m1.6.6.cmml" xref="S3.Ex2.m1.6.6"><eq id="S3.Ex2.m1.6.6.5.cmml" xref="S3.Ex2.m1.6.6.5"></eq><apply id="S3.Ex2.m1.6.6.6.cmml" xref="S3.Ex2.m1.6.6.6"><times id="S3.Ex2.m1.6.6.6.1.cmml" xref="S3.Ex2.m1.6.6.6.1"></times><ci id="S3.Ex2.m1.6.6.6.2.cmml" xref="S3.Ex2.m1.6.6.6.2">𝑝</ci><ci id="S3.Ex2.m1.1.1.cmml" xref="S3.Ex2.m1.1.1">𝑎</ci></apply><apply id="S3.Ex2.m1.6.6.4.cmml" xref="S3.Ex2.m1.6.6.4"><times id="S3.Ex2.m1.6.6.4.5.cmml" xref="S3.Ex2.m1.6.6.4.5"></times><apply id="S3.Ex2.m1.4.4.2.2.cmml" xref="S3.Ex2.m1.4.4.2.2"><ci id="S3.Ex2.m1.4.4.2.2.3.cmml" xref="S3.Ex2.m1.4.4.2.2.3">⋅</ci><apply id="S3.Ex2.m1.4.4.2.2.2.cmml" xref="S3.Ex2.m1.4.4.2.2.2"><times id="S3.Ex2.m1.4.4.2.2.2.3.cmml" xref="S3.Ex2.m1.4.4.2.2.2.3"></times><apply id="S3.Ex2.m1.3.3.1.1.1.1.cmml" xref="S3.Ex2.m1.3.3.1.1.1.1"><ci id="S3.Ex2.m1.3.3.1.1.1.1.2.cmml" xref="S3.Ex2.m1.3.3.1.1.1.1.2">⋅</ci><apply id="S3.Ex2.m1.3.3.1.1.1.1.1.cmml" xref="S3.Ex2.m1.3.3.1.1.1.1.1"><times id="S3.Ex2.m1.3.3.1.1.1.1.1.2.cmml" xref="S3.Ex2.m1.3.3.1.1.1.1.1.2"></times><ci id="S3.Ex2.m1.3.3.1.1.1.1.1.3.cmml" xref="S3.Ex2.m1.3.3.1.1.1.1.1.3">𝑝</ci><apply id="S3.Ex2.m1.3.3.1.1.1.1.1.1.1.1.cmml" xref="S3.Ex2.m1.3.3.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.Ex2.m1.3.3.1.1.1.1.1.1.1.1.1.cmml" xref="S3.Ex2.m1.3.3.1.1.1.1.1.1.1">subscript</csymbol><ci id="S3.Ex2.m1.3.3.1.1.1.1.1.1.1.1.2.cmml" xref="S3.Ex2.m1.3.3.1.1.1.1.1.1.1.1.2">𝑎</ci><cn id="S3.Ex2.m1.3.3.1.1.1.1.1.1.1.1.3.cmml" type="integer" xref="S3.Ex2.m1.3.3.1.1.1.1.1.1.1.1.3">1</cn></apply></apply><ci id="S3.Ex2.m1.3.3.1.1.1.1.3.cmml" xref="S3.Ex2.m1.3.3.1.1.1.1.3">𝑝</ci></apply><apply id="S3.Ex2.m1.4.4.2.2.2.2.1.1.cmml" xref="S3.Ex2.m1.4.4.2.2.2.2.1"><csymbol cd="latexml" id="S3.Ex2.m1.4.4.2.2.2.2.1.1.1.cmml" xref="S3.Ex2.m1.4.4.2.2.2.2.1.1.1">conditional</csymbol><apply id="S3.Ex2.m1.4.4.2.2.2.2.1.1.2.cmml" xref="S3.Ex2.m1.4.4.2.2.2.2.1.1.2"><csymbol cd="ambiguous" id="S3.Ex2.m1.4.4.2.2.2.2.1.1.2.1.cmml" xref="S3.Ex2.m1.4.4.2.2.2.2.1.1.2">subscript</csymbol><ci id="S3.Ex2.m1.4.4.2.2.2.2.1.1.2.2.cmml" xref="S3.Ex2.m1.4.4.2.2.2.2.1.1.2.2">𝑎</ci><cn id="S3.Ex2.m1.4.4.2.2.2.2.1.1.2.3.cmml" type="integer" xref="S3.Ex2.m1.4.4.2.2.2.2.1.1.2.3">2</cn></apply><apply id="S3.Ex2.m1.4.4.2.2.2.2.1.1.3.cmml" xref="S3.Ex2.m1.4.4.2.2.2.2.1.1.3"><csymbol cd="ambiguous" id="S3.Ex2.m1.4.4.2.2.2.2.1.1.3.1.cmml" xref="S3.Ex2.m1.4.4.2.2.2.2.1.1.3">subscript</csymbol><ci id="S3.Ex2.m1.4.4.2.2.2.2.1.1.3.2.cmml" xref="S3.Ex2.m1.4.4.2.2.2.2.1.1.3.2">𝑎</ci><cn id="S3.Ex2.m1.4.4.2.2.2.2.1.1.3.3.cmml" type="integer" xref="S3.Ex2.m1.4.4.2.2.2.2.1.1.3.3">1</cn></apply></apply></apply><ci id="S3.Ex2.m1.4.4.2.2.4.cmml" xref="S3.Ex2.m1.4.4.2.2.4">𝑝</ci></apply><apply id="S3.Ex2.m1.5.5.3.3.1.1.cmml" xref="S3.Ex2.m1.5.5.3.3.1"><csymbol cd="latexml" id="S3.Ex2.m1.5.5.3.3.1.1.3.cmml" xref="S3.Ex2.m1.5.5.3.3.1.1.3">conditional</csymbol><apply id="S3.Ex2.m1.5.5.3.3.1.1.4.cmml" xref="S3.Ex2.m1.5.5.3.3.1.1.4"><csymbol cd="ambiguous" id="S3.Ex2.m1.5.5.3.3.1.1.4.1.cmml" xref="S3.Ex2.m1.5.5.3.3.1.1.4">subscript</csymbol><ci id="S3.Ex2.m1.5.5.3.3.1.1.4.2.cmml" xref="S3.Ex2.m1.5.5.3.3.1.1.4.2">𝑎</ci><cn id="S3.Ex2.m1.5.5.3.3.1.1.4.3.cmml" type="integer" xref="S3.Ex2.m1.5.5.3.3.1.1.4.3">3</cn></apply><list id="S3.Ex2.m1.5.5.3.3.1.1.2.3.cmml" xref="S3.Ex2.m1.5.5.3.3.1.1.2.2"><apply id="S3.Ex2.m1.5.5.3.3.1.1.1.1.1.cmml" xref="S3.Ex2.m1.5.5.3.3.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.Ex2.m1.5.5.3.3.1.1.1.1.1.1.cmml" xref="S3.Ex2.m1.5.5.3.3.1.1.1.1.1">subscript</csymbol><ci id="S3.Ex2.m1.5.5.3.3.1.1.1.1.1.2.cmml" xref="S3.Ex2.m1.5.5.3.3.1.1.1.1.1.2">𝑎</ci><cn id="S3.Ex2.m1.5.5.3.3.1.1.1.1.1.3.cmml" type="integer" xref="S3.Ex2.m1.5.5.3.3.1.1.1.1.1.3">1</cn></apply><apply id="S3.Ex2.m1.5.5.3.3.1.1.2.2.2.cmml" xref="S3.Ex2.m1.5.5.3.3.1.1.2.2.2"><csymbol cd="ambiguous" id="S3.Ex2.m1.5.5.3.3.1.1.2.2.2.1.cmml" xref="S3.Ex2.m1.5.5.3.3.1.1.2.2.2">subscript</csymbol><ci id="S3.Ex2.m1.5.5.3.3.1.1.2.2.2.2.cmml" xref="S3.Ex2.m1.5.5.3.3.1.1.2.2.2.2">𝑎</ci><cn id="S3.Ex2.m1.5.5.3.3.1.1.2.2.2.3.cmml" type="integer" xref="S3.Ex2.m1.5.5.3.3.1.1.2.2.2.3">2</cn></apply></list></apply><ci id="S3.Ex2.m1.6.6.4.6.cmml" xref="S3.Ex2.m1.6.6.4.6">⋯</ci><ci id="S3.Ex2.m1.6.6.4.7.cmml" xref="S3.Ex2.m1.6.6.4.7">𝑝</ci><apply id="S3.Ex2.m1.6.6.4.4.1.1.cmml" xref="S3.Ex2.m1.6.6.4.4.1"><csymbol cd="latexml" id="S3.Ex2.m1.6.6.4.4.1.1.4.cmml" xref="S3.Ex2.m1.6.6.4.4.1.1.4">conditional</csymbol><apply id="S3.Ex2.m1.6.6.4.4.1.1.5.cmml" xref="S3.Ex2.m1.6.6.4.4.1.1.5"><csymbol cd="ambiguous" id="S3.Ex2.m1.6.6.4.4.1.1.5.1.cmml" xref="S3.Ex2.m1.6.6.4.4.1.1.5">subscript</csymbol><ci id="S3.Ex2.m1.6.6.4.4.1.1.5.2.cmml" xref="S3.Ex2.m1.6.6.4.4.1.1.5.2">𝑎</ci><ci id="S3.Ex2.m1.6.6.4.4.1.1.5.3.cmml" xref="S3.Ex2.m1.6.6.4.4.1.1.5.3">𝑛</ci></apply><list id="S3.Ex2.m1.6.6.4.4.1.1.3.4.cmml" xref="S3.Ex2.m1.6.6.4.4.1.1.3.3"><apply id="S3.Ex2.m1.6.6.4.4.1.1.1.1.1.cmml" xref="S3.Ex2.m1.6.6.4.4.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.Ex2.m1.6.6.4.4.1.1.1.1.1.1.cmml" xref="S3.Ex2.m1.6.6.4.4.1.1.1.1.1">subscript</csymbol><ci id="S3.Ex2.m1.6.6.4.4.1.1.1.1.1.2.cmml" xref="S3.Ex2.m1.6.6.4.4.1.1.1.1.1.2">𝑎</ci><cn id="S3.Ex2.m1.6.6.4.4.1.1.1.1.1.3.cmml" type="integer" xref="S3.Ex2.m1.6.6.4.4.1.1.1.1.1.3">1</cn></apply><apply id="S3.Ex2.m1.6.6.4.4.1.1.2.2.2.cmml" xref="S3.Ex2.m1.6.6.4.4.1.1.2.2.2"><csymbol cd="ambiguous" id="S3.Ex2.m1.6.6.4.4.1.1.2.2.2.1.cmml" xref="S3.Ex2.m1.6.6.4.4.1.1.2.2.2">subscript</csymbol><ci id="S3.Ex2.m1.6.6.4.4.1.1.2.2.2.2.cmml" xref="S3.Ex2.m1.6.6.4.4.1.1.2.2.2.2">𝑎</ci><cn id="S3.Ex2.m1.6.6.4.4.1.1.2.2.2.3.cmml" type="integer" xref="S3.Ex2.m1.6.6.4.4.1.1.2.2.2.3">2</cn></apply><ci id="S3.Ex2.m1.2.2.cmml" xref="S3.Ex2.m1.2.2">…</ci><apply id="S3.Ex2.m1.6.6.4.4.1.1.3.3.3.cmml" xref="S3.Ex2.m1.6.6.4.4.1.1.3.3.3"><csymbol cd="ambiguous" id="S3.Ex2.m1.6.6.4.4.1.1.3.3.3.1.cmml" xref="S3.Ex2.m1.6.6.4.4.1.1.3.3.3">subscript</csymbol><ci id="S3.Ex2.m1.6.6.4.4.1.1.3.3.3.2.cmml" xref="S3.Ex2.m1.6.6.4.4.1.1.3.3.3.2">𝑎</ci><apply id="S3.Ex2.m1.6.6.4.4.1.1.3.3.3.3.cmml" xref="S3.Ex2.m1.6.6.4.4.1.1.3.3.3.3"><minus id="S3.Ex2.m1.6.6.4.4.1.1.3.3.3.3.1.cmml" xref="S3.Ex2.m1.6.6.4.4.1.1.3.3.3.3.1"></minus><ci id="S3.Ex2.m1.6.6.4.4.1.1.3.3.3.3.2.cmml" xref="S3.Ex2.m1.6.6.4.4.1.1.3.3.3.3.2">𝑛</ci><cn id="S3.Ex2.m1.6.6.4.4.1.1.3.3.3.3.3.cmml" type="integer" xref="S3.Ex2.m1.6.6.4.4.1.1.3.3.3.3.3">1</cn></apply></apply></list></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.Ex2.m1.6c">p(a)=p(a_{1})\cdot p(a_{2}|a_{1})\cdot p(a_{3}|a_{1},a_{2})\cdots p(a_{n}|a_{1%
},a_{2},\ldots,a_{n-1})</annotation><annotation encoding="application/x-llamapun" id="S3.Ex2.m1.6d">italic_p ( italic_a ) = italic_p ( italic_a start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT ) ⋅ italic_p ( italic_a start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT | italic_a start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT ) ⋅ italic_p ( italic_a start_POSTSUBSCRIPT 3 end_POSTSUBSCRIPT | italic_a start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT , italic_a start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT ) ⋯ italic_p ( italic_a start_POSTSUBSCRIPT italic_n end_POSTSUBSCRIPT | italic_a start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT , italic_a start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT , … , italic_a start_POSTSUBSCRIPT italic_n - 1 end_POSTSUBSCRIPT )</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
</div>
<div class="ltx_para" id="S3.SS2.p5">
<p class="ltx_p" id="S3.SS2.p5.1">Thus, <math alttext="p_{M}(a\mid q,C)" class="ltx_Math" display="inline" id="S3.SS2.p5.1.m1.3"><semantics id="S3.SS2.p5.1.m1.3a"><mrow id="S3.SS2.p5.1.m1.3.3" xref="S3.SS2.p5.1.m1.3.3.cmml"><msub id="S3.SS2.p5.1.m1.3.3.3" xref="S3.SS2.p5.1.m1.3.3.3.cmml"><mi id="S3.SS2.p5.1.m1.3.3.3.2" xref="S3.SS2.p5.1.m1.3.3.3.2.cmml">p</mi><mi id="S3.SS2.p5.1.m1.3.3.3.3" xref="S3.SS2.p5.1.m1.3.3.3.3.cmml">M</mi></msub><mo id="S3.SS2.p5.1.m1.3.3.2" xref="S3.SS2.p5.1.m1.3.3.2.cmml">⁢</mo><mrow id="S3.SS2.p5.1.m1.3.3.1.1" xref="S3.SS2.p5.1.m1.3.3.1.1.1.cmml"><mo id="S3.SS2.p5.1.m1.3.3.1.1.2" stretchy="false" xref="S3.SS2.p5.1.m1.3.3.1.1.1.cmml">(</mo><mrow id="S3.SS2.p5.1.m1.3.3.1.1.1" xref="S3.SS2.p5.1.m1.3.3.1.1.1.cmml"><mi id="S3.SS2.p5.1.m1.3.3.1.1.1.2" xref="S3.SS2.p5.1.m1.3.3.1.1.1.2.cmml">a</mi><mo id="S3.SS2.p5.1.m1.3.3.1.1.1.1" xref="S3.SS2.p5.1.m1.3.3.1.1.1.1.cmml">∣</mo><mrow id="S3.SS2.p5.1.m1.3.3.1.1.1.3.2" xref="S3.SS2.p5.1.m1.3.3.1.1.1.3.1.cmml"><mi id="S3.SS2.p5.1.m1.1.1" xref="S3.SS2.p5.1.m1.1.1.cmml">q</mi><mo id="S3.SS2.p5.1.m1.3.3.1.1.1.3.2.1" xref="S3.SS2.p5.1.m1.3.3.1.1.1.3.1.cmml">,</mo><mi id="S3.SS2.p5.1.m1.2.2" xref="S3.SS2.p5.1.m1.2.2.cmml">C</mi></mrow></mrow><mo id="S3.SS2.p5.1.m1.3.3.1.1.3" stretchy="false" xref="S3.SS2.p5.1.m1.3.3.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p5.1.m1.3b"><apply id="S3.SS2.p5.1.m1.3.3.cmml" xref="S3.SS2.p5.1.m1.3.3"><times id="S3.SS2.p5.1.m1.3.3.2.cmml" xref="S3.SS2.p5.1.m1.3.3.2"></times><apply id="S3.SS2.p5.1.m1.3.3.3.cmml" xref="S3.SS2.p5.1.m1.3.3.3"><csymbol cd="ambiguous" id="S3.SS2.p5.1.m1.3.3.3.1.cmml" xref="S3.SS2.p5.1.m1.3.3.3">subscript</csymbol><ci id="S3.SS2.p5.1.m1.3.3.3.2.cmml" xref="S3.SS2.p5.1.m1.3.3.3.2">𝑝</ci><ci id="S3.SS2.p5.1.m1.3.3.3.3.cmml" xref="S3.SS2.p5.1.m1.3.3.3.3">𝑀</ci></apply><apply id="S3.SS2.p5.1.m1.3.3.1.1.1.cmml" xref="S3.SS2.p5.1.m1.3.3.1.1"><csymbol cd="latexml" id="S3.SS2.p5.1.m1.3.3.1.1.1.1.cmml" xref="S3.SS2.p5.1.m1.3.3.1.1.1.1">conditional</csymbol><ci id="S3.SS2.p5.1.m1.3.3.1.1.1.2.cmml" xref="S3.SS2.p5.1.m1.3.3.1.1.1.2">𝑎</ci><list id="S3.SS2.p5.1.m1.3.3.1.1.1.3.1.cmml" xref="S3.SS2.p5.1.m1.3.3.1.1.1.3.2"><ci id="S3.SS2.p5.1.m1.1.1.cmml" xref="S3.SS2.p5.1.m1.1.1">𝑞</ci><ci id="S3.SS2.p5.1.m1.2.2.cmml" xref="S3.SS2.p5.1.m1.2.2">𝐶</ci></list></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p5.1.m1.3c">p_{M}(a\mid q,C)</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p5.1.m1.3d">italic_p start_POSTSUBSCRIPT italic_M end_POSTSUBSCRIPT ( italic_a ∣ italic_q , italic_C )</annotation></semantics></math> is the product of the conditional probabilities of each token, and these probabilities are output by the LLM at inference time and are readily available in APIs serving LLMs such as the OpenAI API.</p>
</div>
<section class="ltx_subsubsection" id="S3.SS2.SSS1">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">3.2.1 </span>Classification Metrics</h4>
<div class="ltx_para" id="S3.SS2.SSS1.p1">
<p class="ltx_p" id="S3.SS2.SSS1.p1.1">In binary classification, accuracy is typically used as an evaluation metric, and can be defined as:</p>
<table class="ltx_equation ltx_eqn_table" id="S3.Ex3">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\frac{1}{|\mathcal{D}|}\sum_{(x,y,\bar{y})\in\mathcal{D}}\mathbf{1}\big{(}p(y%
\mid x)&gt;p(\bar{y}\mid x)\big{)}" class="ltx_Math" display="block" id="S3.Ex3.m1.5"><semantics id="S3.Ex3.m1.5a"><mrow id="S3.Ex3.m1.5.5" xref="S3.Ex3.m1.5.5.cmml"><mfrac id="S3.Ex3.m1.1.1" xref="S3.Ex3.m1.1.1.cmml"><mn id="S3.Ex3.m1.1.1.3" xref="S3.Ex3.m1.1.1.3.cmml">1</mn><mrow id="S3.Ex3.m1.1.1.1.3" xref="S3.Ex3.m1.1.1.1.2.cmml"><mo id="S3.Ex3.m1.1.1.1.3.1" stretchy="false" xref="S3.Ex3.m1.1.1.1.2.1.cmml">|</mo><mi class="ltx_font_mathcaligraphic" id="S3.Ex3.m1.1.1.1.1" xref="S3.Ex3.m1.1.1.1.1.cmml">𝒟</mi><mo id="S3.Ex3.m1.1.1.1.3.2" stretchy="false" xref="S3.Ex3.m1.1.1.1.2.1.cmml">|</mo></mrow></mfrac><mo id="S3.Ex3.m1.5.5.2" xref="S3.Ex3.m1.5.5.2.cmml">⁢</mo><mrow id="S3.Ex3.m1.5.5.1" xref="S3.Ex3.m1.5.5.1.cmml"><munder id="S3.Ex3.m1.5.5.1.2" xref="S3.Ex3.m1.5.5.1.2.cmml"><mo id="S3.Ex3.m1.5.5.1.2.2" movablelimits="false" xref="S3.Ex3.m1.5.5.1.2.2.cmml">∑</mo><mrow id="S3.Ex3.m1.4.4.3" xref="S3.Ex3.m1.4.4.3.cmml"><mrow id="S3.Ex3.m1.4.4.3.5.2" xref="S3.Ex3.m1.4.4.3.5.1.cmml"><mo id="S3.Ex3.m1.4.4.3.5.2.1" stretchy="false" xref="S3.Ex3.m1.4.4.3.5.1.cmml">(</mo><mi id="S3.Ex3.m1.2.2.1.1" xref="S3.Ex3.m1.2.2.1.1.cmml">x</mi><mo id="S3.Ex3.m1.4.4.3.5.2.2" xref="S3.Ex3.m1.4.4.3.5.1.cmml">,</mo><mi id="S3.Ex3.m1.3.3.2.2" xref="S3.Ex3.m1.3.3.2.2.cmml">y</mi><mo id="S3.Ex3.m1.4.4.3.5.2.3" xref="S3.Ex3.m1.4.4.3.5.1.cmml">,</mo><mover accent="true" id="S3.Ex3.m1.4.4.3.3" xref="S3.Ex3.m1.4.4.3.3.cmml"><mi id="S3.Ex3.m1.4.4.3.3.2" xref="S3.Ex3.m1.4.4.3.3.2.cmml">y</mi><mo id="S3.Ex3.m1.4.4.3.3.1" xref="S3.Ex3.m1.4.4.3.3.1.cmml">¯</mo></mover><mo id="S3.Ex3.m1.4.4.3.5.2.4" stretchy="false" xref="S3.Ex3.m1.4.4.3.5.1.cmml">)</mo></mrow><mo id="S3.Ex3.m1.4.4.3.4" xref="S3.Ex3.m1.4.4.3.4.cmml">∈</mo><mi class="ltx_font_mathcaligraphic" id="S3.Ex3.m1.4.4.3.6" xref="S3.Ex3.m1.4.4.3.6.cmml">𝒟</mi></mrow></munder><mrow id="S3.Ex3.m1.5.5.1.1" xref="S3.Ex3.m1.5.5.1.1.cmml"><mn id="S3.Ex3.m1.5.5.1.1.3" xref="S3.Ex3.m1.5.5.1.1.3.cmml">𝟏</mn><mo id="S3.Ex3.m1.5.5.1.1.2" xref="S3.Ex3.m1.5.5.1.1.2.cmml">⁢</mo><mrow id="S3.Ex3.m1.5.5.1.1.1.1" xref="S3.Ex3.m1.5.5.1.1.1.1.1.cmml"><mo id="S3.Ex3.m1.5.5.1.1.1.1.2" maxsize="120%" minsize="120%" xref="S3.Ex3.m1.5.5.1.1.1.1.1.cmml">(</mo><mrow id="S3.Ex3.m1.5.5.1.1.1.1.1" xref="S3.Ex3.m1.5.5.1.1.1.1.1.cmml"><mrow id="S3.Ex3.m1.5.5.1.1.1.1.1.1" xref="S3.Ex3.m1.5.5.1.1.1.1.1.1.cmml"><mi id="S3.Ex3.m1.5.5.1.1.1.1.1.1.3" xref="S3.Ex3.m1.5.5.1.1.1.1.1.1.3.cmml">p</mi><mo id="S3.Ex3.m1.5.5.1.1.1.1.1.1.2" xref="S3.Ex3.m1.5.5.1.1.1.1.1.1.2.cmml">⁢</mo><mrow id="S3.Ex3.m1.5.5.1.1.1.1.1.1.1.1" xref="S3.Ex3.m1.5.5.1.1.1.1.1.1.1.1.1.cmml"><mo id="S3.Ex3.m1.5.5.1.1.1.1.1.1.1.1.2" stretchy="false" xref="S3.Ex3.m1.5.5.1.1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="S3.Ex3.m1.5.5.1.1.1.1.1.1.1.1.1" xref="S3.Ex3.m1.5.5.1.1.1.1.1.1.1.1.1.cmml"><mi id="S3.Ex3.m1.5.5.1.1.1.1.1.1.1.1.1.2" xref="S3.Ex3.m1.5.5.1.1.1.1.1.1.1.1.1.2.cmml">y</mi><mo id="S3.Ex3.m1.5.5.1.1.1.1.1.1.1.1.1.1" xref="S3.Ex3.m1.5.5.1.1.1.1.1.1.1.1.1.1.cmml">∣</mo><mi id="S3.Ex3.m1.5.5.1.1.1.1.1.1.1.1.1.3" xref="S3.Ex3.m1.5.5.1.1.1.1.1.1.1.1.1.3.cmml">x</mi></mrow><mo id="S3.Ex3.m1.5.5.1.1.1.1.1.1.1.1.3" stretchy="false" xref="S3.Ex3.m1.5.5.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S3.Ex3.m1.5.5.1.1.1.1.1.3" xref="S3.Ex3.m1.5.5.1.1.1.1.1.3.cmml">&gt;</mo><mrow id="S3.Ex3.m1.5.5.1.1.1.1.1.2" xref="S3.Ex3.m1.5.5.1.1.1.1.1.2.cmml"><mi id="S3.Ex3.m1.5.5.1.1.1.1.1.2.3" xref="S3.Ex3.m1.5.5.1.1.1.1.1.2.3.cmml">p</mi><mo id="S3.Ex3.m1.5.5.1.1.1.1.1.2.2" xref="S3.Ex3.m1.5.5.1.1.1.1.1.2.2.cmml">⁢</mo><mrow id="S3.Ex3.m1.5.5.1.1.1.1.1.2.1.1" xref="S3.Ex3.m1.5.5.1.1.1.1.1.2.1.1.1.cmml"><mo id="S3.Ex3.m1.5.5.1.1.1.1.1.2.1.1.2" stretchy="false" xref="S3.Ex3.m1.5.5.1.1.1.1.1.2.1.1.1.cmml">(</mo><mrow id="S3.Ex3.m1.5.5.1.1.1.1.1.2.1.1.1" xref="S3.Ex3.m1.5.5.1.1.1.1.1.2.1.1.1.cmml"><mover accent="true" id="S3.Ex3.m1.5.5.1.1.1.1.1.2.1.1.1.2" xref="S3.Ex3.m1.5.5.1.1.1.1.1.2.1.1.1.2.cmml"><mi id="S3.Ex3.m1.5.5.1.1.1.1.1.2.1.1.1.2.2" xref="S3.Ex3.m1.5.5.1.1.1.1.1.2.1.1.1.2.2.cmml">y</mi><mo id="S3.Ex3.m1.5.5.1.1.1.1.1.2.1.1.1.2.1" xref="S3.Ex3.m1.5.5.1.1.1.1.1.2.1.1.1.2.1.cmml">¯</mo></mover><mo id="S3.Ex3.m1.5.5.1.1.1.1.1.2.1.1.1.1" xref="S3.Ex3.m1.5.5.1.1.1.1.1.2.1.1.1.1.cmml">∣</mo><mi id="S3.Ex3.m1.5.5.1.1.1.1.1.2.1.1.1.3" xref="S3.Ex3.m1.5.5.1.1.1.1.1.2.1.1.1.3.cmml">x</mi></mrow><mo id="S3.Ex3.m1.5.5.1.1.1.1.1.2.1.1.3" stretchy="false" xref="S3.Ex3.m1.5.5.1.1.1.1.1.2.1.1.1.cmml">)</mo></mrow></mrow></mrow><mo id="S3.Ex3.m1.5.5.1.1.1.1.3" maxsize="120%" minsize="120%" xref="S3.Ex3.m1.5.5.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.Ex3.m1.5b"><apply id="S3.Ex3.m1.5.5.cmml" xref="S3.Ex3.m1.5.5"><times id="S3.Ex3.m1.5.5.2.cmml" xref="S3.Ex3.m1.5.5.2"></times><apply id="S3.Ex3.m1.1.1.cmml" xref="S3.Ex3.m1.1.1"><divide id="S3.Ex3.m1.1.1.2.cmml" xref="S3.Ex3.m1.1.1"></divide><cn id="S3.Ex3.m1.1.1.3.cmml" type="integer" xref="S3.Ex3.m1.1.1.3">1</cn><apply id="S3.Ex3.m1.1.1.1.2.cmml" xref="S3.Ex3.m1.1.1.1.3"><abs id="S3.Ex3.m1.1.1.1.2.1.cmml" xref="S3.Ex3.m1.1.1.1.3.1"></abs><ci id="S3.Ex3.m1.1.1.1.1.cmml" xref="S3.Ex3.m1.1.1.1.1">𝒟</ci></apply></apply><apply id="S3.Ex3.m1.5.5.1.cmml" xref="S3.Ex3.m1.5.5.1"><apply id="S3.Ex3.m1.5.5.1.2.cmml" xref="S3.Ex3.m1.5.5.1.2"><csymbol cd="ambiguous" id="S3.Ex3.m1.5.5.1.2.1.cmml" xref="S3.Ex3.m1.5.5.1.2">subscript</csymbol><sum id="S3.Ex3.m1.5.5.1.2.2.cmml" xref="S3.Ex3.m1.5.5.1.2.2"></sum><apply id="S3.Ex3.m1.4.4.3.cmml" xref="S3.Ex3.m1.4.4.3"><in id="S3.Ex3.m1.4.4.3.4.cmml" xref="S3.Ex3.m1.4.4.3.4"></in><vector id="S3.Ex3.m1.4.4.3.5.1.cmml" xref="S3.Ex3.m1.4.4.3.5.2"><ci id="S3.Ex3.m1.2.2.1.1.cmml" xref="S3.Ex3.m1.2.2.1.1">𝑥</ci><ci id="S3.Ex3.m1.3.3.2.2.cmml" xref="S3.Ex3.m1.3.3.2.2">𝑦</ci><apply id="S3.Ex3.m1.4.4.3.3.cmml" xref="S3.Ex3.m1.4.4.3.3"><ci id="S3.Ex3.m1.4.4.3.3.1.cmml" xref="S3.Ex3.m1.4.4.3.3.1">¯</ci><ci id="S3.Ex3.m1.4.4.3.3.2.cmml" xref="S3.Ex3.m1.4.4.3.3.2">𝑦</ci></apply></vector><ci id="S3.Ex3.m1.4.4.3.6.cmml" xref="S3.Ex3.m1.4.4.3.6">𝒟</ci></apply></apply><apply id="S3.Ex3.m1.5.5.1.1.cmml" xref="S3.Ex3.m1.5.5.1.1"><times id="S3.Ex3.m1.5.5.1.1.2.cmml" xref="S3.Ex3.m1.5.5.1.1.2"></times><cn id="S3.Ex3.m1.5.5.1.1.3.cmml" type="integer" xref="S3.Ex3.m1.5.5.1.1.3">1</cn><apply id="S3.Ex3.m1.5.5.1.1.1.1.1.cmml" xref="S3.Ex3.m1.5.5.1.1.1.1"><gt id="S3.Ex3.m1.5.5.1.1.1.1.1.3.cmml" xref="S3.Ex3.m1.5.5.1.1.1.1.1.3"></gt><apply id="S3.Ex3.m1.5.5.1.1.1.1.1.1.cmml" xref="S3.Ex3.m1.5.5.1.1.1.1.1.1"><times id="S3.Ex3.m1.5.5.1.1.1.1.1.1.2.cmml" xref="S3.Ex3.m1.5.5.1.1.1.1.1.1.2"></times><ci id="S3.Ex3.m1.5.5.1.1.1.1.1.1.3.cmml" xref="S3.Ex3.m1.5.5.1.1.1.1.1.1.3">𝑝</ci><apply id="S3.Ex3.m1.5.5.1.1.1.1.1.1.1.1.1.cmml" xref="S3.Ex3.m1.5.5.1.1.1.1.1.1.1.1"><csymbol cd="latexml" id="S3.Ex3.m1.5.5.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.Ex3.m1.5.5.1.1.1.1.1.1.1.1.1.1">conditional</csymbol><ci id="S3.Ex3.m1.5.5.1.1.1.1.1.1.1.1.1.2.cmml" xref="S3.Ex3.m1.5.5.1.1.1.1.1.1.1.1.1.2">𝑦</ci><ci id="S3.Ex3.m1.5.5.1.1.1.1.1.1.1.1.1.3.cmml" xref="S3.Ex3.m1.5.5.1.1.1.1.1.1.1.1.1.3">𝑥</ci></apply></apply><apply id="S3.Ex3.m1.5.5.1.1.1.1.1.2.cmml" xref="S3.Ex3.m1.5.5.1.1.1.1.1.2"><times id="S3.Ex3.m1.5.5.1.1.1.1.1.2.2.cmml" xref="S3.Ex3.m1.5.5.1.1.1.1.1.2.2"></times><ci id="S3.Ex3.m1.5.5.1.1.1.1.1.2.3.cmml" xref="S3.Ex3.m1.5.5.1.1.1.1.1.2.3">𝑝</ci><apply id="S3.Ex3.m1.5.5.1.1.1.1.1.2.1.1.1.cmml" xref="S3.Ex3.m1.5.5.1.1.1.1.1.2.1.1"><csymbol cd="latexml" id="S3.Ex3.m1.5.5.1.1.1.1.1.2.1.1.1.1.cmml" xref="S3.Ex3.m1.5.5.1.1.1.1.1.2.1.1.1.1">conditional</csymbol><apply id="S3.Ex3.m1.5.5.1.1.1.1.1.2.1.1.1.2.cmml" xref="S3.Ex3.m1.5.5.1.1.1.1.1.2.1.1.1.2"><ci id="S3.Ex3.m1.5.5.1.1.1.1.1.2.1.1.1.2.1.cmml" xref="S3.Ex3.m1.5.5.1.1.1.1.1.2.1.1.1.2.1">¯</ci><ci id="S3.Ex3.m1.5.5.1.1.1.1.1.2.1.1.1.2.2.cmml" xref="S3.Ex3.m1.5.5.1.1.1.1.1.2.1.1.1.2.2">𝑦</ci></apply><ci id="S3.Ex3.m1.5.5.1.1.1.1.1.2.1.1.1.3.cmml" xref="S3.Ex3.m1.5.5.1.1.1.1.1.2.1.1.1.3">𝑥</ci></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.Ex3.m1.5c">\frac{1}{|\mathcal{D}|}\sum_{(x,y,\bar{y})\in\mathcal{D}}\mathbf{1}\big{(}p(y%
\mid x)&gt;p(\bar{y}\mid x)\big{)}</annotation><annotation encoding="application/x-llamapun" id="S3.Ex3.m1.5d">divide start_ARG 1 end_ARG start_ARG | caligraphic_D | end_ARG ∑ start_POSTSUBSCRIPT ( italic_x , italic_y , over¯ start_ARG italic_y end_ARG ) ∈ caligraphic_D end_POSTSUBSCRIPT bold_1 ( italic_p ( italic_y ∣ italic_x ) &gt; italic_p ( over¯ start_ARG italic_y end_ARG ∣ italic_x ) )</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
</div>
<div class="ltx_para" id="S3.SS2.SSS1.p2">
<p class="ltx_p" id="S3.SS2.SSS1.p2.6">Where: <math alttext="|\mathcal{D}|" class="ltx_Math" display="inline" id="S3.SS2.SSS1.p2.1.m1.1"><semantics id="S3.SS2.SSS1.p2.1.m1.1a"><mrow id="S3.SS2.SSS1.p2.1.m1.1.2.2" xref="S3.SS2.SSS1.p2.1.m1.1.2.1.cmml"><mo id="S3.SS2.SSS1.p2.1.m1.1.2.2.1" stretchy="false" xref="S3.SS2.SSS1.p2.1.m1.1.2.1.1.cmml">|</mo><mi class="ltx_font_mathcaligraphic" id="S3.SS2.SSS1.p2.1.m1.1.1" xref="S3.SS2.SSS1.p2.1.m1.1.1.cmml">𝒟</mi><mo id="S3.SS2.SSS1.p2.1.m1.1.2.2.2" stretchy="false" xref="S3.SS2.SSS1.p2.1.m1.1.2.1.1.cmml">|</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS1.p2.1.m1.1b"><apply id="S3.SS2.SSS1.p2.1.m1.1.2.1.cmml" xref="S3.SS2.SSS1.p2.1.m1.1.2.2"><abs id="S3.SS2.SSS1.p2.1.m1.1.2.1.1.cmml" xref="S3.SS2.SSS1.p2.1.m1.1.2.2.1"></abs><ci id="S3.SS2.SSS1.p2.1.m1.1.1.cmml" xref="S3.SS2.SSS1.p2.1.m1.1.1">𝒟</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS1.p2.1.m1.1c">|\mathcal{D}|</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS1.p2.1.m1.1d">| caligraphic_D |</annotation></semantics></math> is the number of examples in the dataset <math alttext="\mathcal{D}" class="ltx_Math" display="inline" id="S3.SS2.SSS1.p2.2.m2.1"><semantics id="S3.SS2.SSS1.p2.2.m2.1a"><mi class="ltx_font_mathcaligraphic" id="S3.SS2.SSS1.p2.2.m2.1.1" xref="S3.SS2.SSS1.p2.2.m2.1.1.cmml">𝒟</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS1.p2.2.m2.1b"><ci id="S3.SS2.SSS1.p2.2.m2.1.1.cmml" xref="S3.SS2.SSS1.p2.2.m2.1.1">𝒟</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS1.p2.2.m2.1c">\mathcal{D}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS1.p2.2.m2.1d">caligraphic_D</annotation></semantics></math>; <math alttext="\mathbf{1}(\cdot)" class="ltx_Math" display="inline" id="S3.SS2.SSS1.p2.3.m3.1"><semantics id="S3.SS2.SSS1.p2.3.m3.1a"><mrow id="S3.SS2.SSS1.p2.3.m3.1.2" xref="S3.SS2.SSS1.p2.3.m3.1.2.cmml"><mn id="S3.SS2.SSS1.p2.3.m3.1.2.2" xref="S3.SS2.SSS1.p2.3.m3.1.2.2.cmml">𝟏</mn><mo id="S3.SS2.SSS1.p2.3.m3.1.2.1" xref="S3.SS2.SSS1.p2.3.m3.1.2.1.cmml">⁢</mo><mrow id="S3.SS2.SSS1.p2.3.m3.1.2.3.2" xref="S3.SS2.SSS1.p2.3.m3.1.2.cmml"><mo id="S3.SS2.SSS1.p2.3.m3.1.2.3.2.1" stretchy="false" xref="S3.SS2.SSS1.p2.3.m3.1.2.cmml">(</mo><mo id="S3.SS2.SSS1.p2.3.m3.1.1" lspace="0em" rspace="0em" xref="S3.SS2.SSS1.p2.3.m3.1.1.cmml">⋅</mo><mo id="S3.SS2.SSS1.p2.3.m3.1.2.3.2.2" stretchy="false" xref="S3.SS2.SSS1.p2.3.m3.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS1.p2.3.m3.1b"><apply id="S3.SS2.SSS1.p2.3.m3.1.2.cmml" xref="S3.SS2.SSS1.p2.3.m3.1.2"><times id="S3.SS2.SSS1.p2.3.m3.1.2.1.cmml" xref="S3.SS2.SSS1.p2.3.m3.1.2.1"></times><cn id="S3.SS2.SSS1.p2.3.m3.1.2.2.cmml" type="integer" xref="S3.SS2.SSS1.p2.3.m3.1.2.2">1</cn><ci id="S3.SS2.SSS1.p2.3.m3.1.1.cmml" xref="S3.SS2.SSS1.p2.3.m3.1.1">⋅</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS1.p2.3.m3.1c">\mathbf{1}(\cdot)</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS1.p2.3.m3.1d">bold_1 ( ⋅ )</annotation></semantics></math> is the indicator function that returns 1 if the condition is true and 0 otherwise; and <math alttext="y" class="ltx_Math" display="inline" id="S3.SS2.SSS1.p2.4.m4.1"><semantics id="S3.SS2.SSS1.p2.4.m4.1a"><mi id="S3.SS2.SSS1.p2.4.m4.1.1" xref="S3.SS2.SSS1.p2.4.m4.1.1.cmml">y</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS1.p2.4.m4.1b"><ci id="S3.SS2.SSS1.p2.4.m4.1.1.cmml" xref="S3.SS2.SSS1.p2.4.m4.1.1">𝑦</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS1.p2.4.m4.1c">y</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS1.p2.4.m4.1d">italic_y</annotation></semantics></math> (<math alttext="\bar{y}" class="ltx_Math" display="inline" id="S3.SS2.SSS1.p2.5.m5.1"><semantics id="S3.SS2.SSS1.p2.5.m5.1a"><mover accent="true" id="S3.SS2.SSS1.p2.5.m5.1.1" xref="S3.SS2.SSS1.p2.5.m5.1.1.cmml"><mi id="S3.SS2.SSS1.p2.5.m5.1.1.2" xref="S3.SS2.SSS1.p2.5.m5.1.1.2.cmml">y</mi><mo id="S3.SS2.SSS1.p2.5.m5.1.1.1" xref="S3.SS2.SSS1.p2.5.m5.1.1.1.cmml">¯</mo></mover><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS1.p2.5.m5.1b"><apply id="S3.SS2.SSS1.p2.5.m5.1.1.cmml" xref="S3.SS2.SSS1.p2.5.m5.1.1"><ci id="S3.SS2.SSS1.p2.5.m5.1.1.1.cmml" xref="S3.SS2.SSS1.p2.5.m5.1.1.1">¯</ci><ci id="S3.SS2.SSS1.p2.5.m5.1.1.2.cmml" xref="S3.SS2.SSS1.p2.5.m5.1.1.2">𝑦</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS1.p2.5.m5.1c">\bar{y}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS1.p2.5.m5.1d">over¯ start_ARG italic_y end_ARG</annotation></semantics></math>) is the correct (incorrect) label for example <math alttext="x" class="ltx_Math" display="inline" id="S3.SS2.SSS1.p2.6.m6.1"><semantics id="S3.SS2.SSS1.p2.6.m6.1a"><mi id="S3.SS2.SSS1.p2.6.m6.1.1" xref="S3.SS2.SSS1.p2.6.m6.1.1.cmml">x</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS1.p2.6.m6.1b"><ci id="S3.SS2.SSS1.p2.6.m6.1.1.cmml" xref="S3.SS2.SSS1.p2.6.m6.1.1">𝑥</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS1.p2.6.m6.1c">x</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS1.p2.6.m6.1d">italic_x</annotation></semantics></math>.</p>
</div>
<div class="ltx_para" id="S3.SS2.SSS1.p3">
<p class="ltx_p" id="S3.SS2.SSS1.p3.3">Given a retriever <math alttext="R_{\mathcal{D}}" class="ltx_Math" display="inline" id="S3.SS2.SSS1.p3.1.m1.1"><semantics id="S3.SS2.SSS1.p3.1.m1.1a"><msub id="S3.SS2.SSS1.p3.1.m1.1.1" xref="S3.SS2.SSS1.p3.1.m1.1.1.cmml"><mi id="S3.SS2.SSS1.p3.1.m1.1.1.2" xref="S3.SS2.SSS1.p3.1.m1.1.1.2.cmml">R</mi><mi class="ltx_font_mathcaligraphic" id="S3.SS2.SSS1.p3.1.m1.1.1.3" xref="S3.SS2.SSS1.p3.1.m1.1.1.3.cmml">𝒟</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS1.p3.1.m1.1b"><apply id="S3.SS2.SSS1.p3.1.m1.1.1.cmml" xref="S3.SS2.SSS1.p3.1.m1.1.1"><csymbol cd="ambiguous" id="S3.SS2.SSS1.p3.1.m1.1.1.1.cmml" xref="S3.SS2.SSS1.p3.1.m1.1.1">subscript</csymbol><ci id="S3.SS2.SSS1.p3.1.m1.1.1.2.cmml" xref="S3.SS2.SSS1.p3.1.m1.1.1.2">𝑅</ci><ci id="S3.SS2.SSS1.p3.1.m1.1.1.3.cmml" xref="S3.SS2.SSS1.p3.1.m1.1.1.3">𝒟</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS1.p3.1.m1.1c">R_{\mathcal{D}}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS1.p3.1.m1.1d">italic_R start_POSTSUBSCRIPT caligraphic_D end_POSTSUBSCRIPT</annotation></semantics></math> and a demonstration <math alttext="(q,a,\bar{a})\in\mathcal{D}" class="ltx_Math" display="inline" id="S3.SS2.SSS1.p3.2.m2.3"><semantics id="S3.SS2.SSS1.p3.2.m2.3a"><mrow id="S3.SS2.SSS1.p3.2.m2.3.4" xref="S3.SS2.SSS1.p3.2.m2.3.4.cmml"><mrow id="S3.SS2.SSS1.p3.2.m2.3.4.2.2" xref="S3.SS2.SSS1.p3.2.m2.3.4.2.1.cmml"><mo id="S3.SS2.SSS1.p3.2.m2.3.4.2.2.1" stretchy="false" xref="S3.SS2.SSS1.p3.2.m2.3.4.2.1.cmml">(</mo><mi id="S3.SS2.SSS1.p3.2.m2.1.1" xref="S3.SS2.SSS1.p3.2.m2.1.1.cmml">q</mi><mo id="S3.SS2.SSS1.p3.2.m2.3.4.2.2.2" xref="S3.SS2.SSS1.p3.2.m2.3.4.2.1.cmml">,</mo><mi id="S3.SS2.SSS1.p3.2.m2.2.2" xref="S3.SS2.SSS1.p3.2.m2.2.2.cmml">a</mi><mo id="S3.SS2.SSS1.p3.2.m2.3.4.2.2.3" xref="S3.SS2.SSS1.p3.2.m2.3.4.2.1.cmml">,</mo><mover accent="true" id="S3.SS2.SSS1.p3.2.m2.3.3" xref="S3.SS2.SSS1.p3.2.m2.3.3.cmml"><mi id="S3.SS2.SSS1.p3.2.m2.3.3.2" xref="S3.SS2.SSS1.p3.2.m2.3.3.2.cmml">a</mi><mo id="S3.SS2.SSS1.p3.2.m2.3.3.1" xref="S3.SS2.SSS1.p3.2.m2.3.3.1.cmml">¯</mo></mover><mo id="S3.SS2.SSS1.p3.2.m2.3.4.2.2.4" stretchy="false" xref="S3.SS2.SSS1.p3.2.m2.3.4.2.1.cmml">)</mo></mrow><mo id="S3.SS2.SSS1.p3.2.m2.3.4.1" xref="S3.SS2.SSS1.p3.2.m2.3.4.1.cmml">∈</mo><mi class="ltx_font_mathcaligraphic" id="S3.SS2.SSS1.p3.2.m2.3.4.3" xref="S3.SS2.SSS1.p3.2.m2.3.4.3.cmml">𝒟</mi></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS1.p3.2.m2.3b"><apply id="S3.SS2.SSS1.p3.2.m2.3.4.cmml" xref="S3.SS2.SSS1.p3.2.m2.3.4"><in id="S3.SS2.SSS1.p3.2.m2.3.4.1.cmml" xref="S3.SS2.SSS1.p3.2.m2.3.4.1"></in><vector id="S3.SS2.SSS1.p3.2.m2.3.4.2.1.cmml" xref="S3.SS2.SSS1.p3.2.m2.3.4.2.2"><ci id="S3.SS2.SSS1.p3.2.m2.1.1.cmml" xref="S3.SS2.SSS1.p3.2.m2.1.1">𝑞</ci><ci id="S3.SS2.SSS1.p3.2.m2.2.2.cmml" xref="S3.SS2.SSS1.p3.2.m2.2.2">𝑎</ci><apply id="S3.SS2.SSS1.p3.2.m2.3.3.cmml" xref="S3.SS2.SSS1.p3.2.m2.3.3"><ci id="S3.SS2.SSS1.p3.2.m2.3.3.1.cmml" xref="S3.SS2.SSS1.p3.2.m2.3.3.1">¯</ci><ci id="S3.SS2.SSS1.p3.2.m2.3.3.2.cmml" xref="S3.SS2.SSS1.p3.2.m2.3.3.2">𝑎</ci></apply></vector><ci id="S3.SS2.SSS1.p3.2.m2.3.4.3.cmml" xref="S3.SS2.SSS1.p3.2.m2.3.4.3">𝒟</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS1.p3.2.m2.3c">(q,a,\bar{a})\in\mathcal{D}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS1.p3.2.m2.3d">( italic_q , italic_a , over¯ start_ARG italic_a end_ARG ) ∈ caligraphic_D</annotation></semantics></math>, we introduce the simplified leave-one-out notation <math alttext="R(q)=R_{\mathcal{D}\setminus\{(q,a,\bar{a})\}}(q)" class="ltx_Math" display="inline" id="S3.SS2.SSS1.p3.3.m3.6"><semantics id="S3.SS2.SSS1.p3.3.m3.6a"><mrow id="S3.SS2.SSS1.p3.3.m3.6.7" xref="S3.SS2.SSS1.p3.3.m3.6.7.cmml"><mrow id="S3.SS2.SSS1.p3.3.m3.6.7.2" xref="S3.SS2.SSS1.p3.3.m3.6.7.2.cmml"><mi id="S3.SS2.SSS1.p3.3.m3.6.7.2.2" xref="S3.SS2.SSS1.p3.3.m3.6.7.2.2.cmml">R</mi><mo id="S3.SS2.SSS1.p3.3.m3.6.7.2.1" xref="S3.SS2.SSS1.p3.3.m3.6.7.2.1.cmml">⁢</mo><mrow id="S3.SS2.SSS1.p3.3.m3.6.7.2.3.2" xref="S3.SS2.SSS1.p3.3.m3.6.7.2.cmml"><mo id="S3.SS2.SSS1.p3.3.m3.6.7.2.3.2.1" stretchy="false" xref="S3.SS2.SSS1.p3.3.m3.6.7.2.cmml">(</mo><mi id="S3.SS2.SSS1.p3.3.m3.5.5" xref="S3.SS2.SSS1.p3.3.m3.5.5.cmml">q</mi><mo id="S3.SS2.SSS1.p3.3.m3.6.7.2.3.2.2" stretchy="false" xref="S3.SS2.SSS1.p3.3.m3.6.7.2.cmml">)</mo></mrow></mrow><mo id="S3.SS2.SSS1.p3.3.m3.6.7.1" xref="S3.SS2.SSS1.p3.3.m3.6.7.1.cmml">=</mo><mrow id="S3.SS2.SSS1.p3.3.m3.6.7.3" xref="S3.SS2.SSS1.p3.3.m3.6.7.3.cmml"><msub id="S3.SS2.SSS1.p3.3.m3.6.7.3.2" xref="S3.SS2.SSS1.p3.3.m3.6.7.3.2.cmml"><mi id="S3.SS2.SSS1.p3.3.m3.6.7.3.2.2" xref="S3.SS2.SSS1.p3.3.m3.6.7.3.2.2.cmml">R</mi><mrow id="S3.SS2.SSS1.p3.3.m3.4.4.4" xref="S3.SS2.SSS1.p3.3.m3.4.4.4.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS2.SSS1.p3.3.m3.4.4.4.6" xref="S3.SS2.SSS1.p3.3.m3.4.4.4.6.cmml">𝒟</mi><mo id="S3.SS2.SSS1.p3.3.m3.4.4.4.5" xref="S3.SS2.SSS1.p3.3.m3.4.4.4.5.cmml">∖</mo><mrow id="S3.SS2.SSS1.p3.3.m3.4.4.4.4.1" xref="S3.SS2.SSS1.p3.3.m3.4.4.4.4.2.cmml"><mo id="S3.SS2.SSS1.p3.3.m3.4.4.4.4.1.2" stretchy="false" xref="S3.SS2.SSS1.p3.3.m3.4.4.4.4.2.cmml">{</mo><mrow id="S3.SS2.SSS1.p3.3.m3.4.4.4.4.1.1.2" xref="S3.SS2.SSS1.p3.3.m3.4.4.4.4.1.1.1.cmml"><mo id="S3.SS2.SSS1.p3.3.m3.4.4.4.4.1.1.2.1" stretchy="false" xref="S3.SS2.SSS1.p3.3.m3.4.4.4.4.1.1.1.cmml">(</mo><mi id="S3.SS2.SSS1.p3.3.m3.1.1.1.1" xref="S3.SS2.SSS1.p3.3.m3.1.1.1.1.cmml">q</mi><mo id="S3.SS2.SSS1.p3.3.m3.4.4.4.4.1.1.2.2" xref="S3.SS2.SSS1.p3.3.m3.4.4.4.4.1.1.1.cmml">,</mo><mi id="S3.SS2.SSS1.p3.3.m3.2.2.2.2" xref="S3.SS2.SSS1.p3.3.m3.2.2.2.2.cmml">a</mi><mo id="S3.SS2.SSS1.p3.3.m3.4.4.4.4.1.1.2.3" xref="S3.SS2.SSS1.p3.3.m3.4.4.4.4.1.1.1.cmml">,</mo><mover accent="true" id="S3.SS2.SSS1.p3.3.m3.3.3.3.3" xref="S3.SS2.SSS1.p3.3.m3.3.3.3.3.cmml"><mi id="S3.SS2.SSS1.p3.3.m3.3.3.3.3.2" xref="S3.SS2.SSS1.p3.3.m3.3.3.3.3.2.cmml">a</mi><mo id="S3.SS2.SSS1.p3.3.m3.3.3.3.3.1" xref="S3.SS2.SSS1.p3.3.m3.3.3.3.3.1.cmml">¯</mo></mover><mo id="S3.SS2.SSS1.p3.3.m3.4.4.4.4.1.1.2.4" stretchy="false" xref="S3.SS2.SSS1.p3.3.m3.4.4.4.4.1.1.1.cmml">)</mo></mrow><mo id="S3.SS2.SSS1.p3.3.m3.4.4.4.4.1.3" stretchy="false" xref="S3.SS2.SSS1.p3.3.m3.4.4.4.4.2.cmml">}</mo></mrow></mrow></msub><mo id="S3.SS2.SSS1.p3.3.m3.6.7.3.1" xref="S3.SS2.SSS1.p3.3.m3.6.7.3.1.cmml">⁢</mo><mrow id="S3.SS2.SSS1.p3.3.m3.6.7.3.3.2" xref="S3.SS2.SSS1.p3.3.m3.6.7.3.cmml"><mo id="S3.SS2.SSS1.p3.3.m3.6.7.3.3.2.1" stretchy="false" xref="S3.SS2.SSS1.p3.3.m3.6.7.3.cmml">(</mo><mi id="S3.SS2.SSS1.p3.3.m3.6.6" xref="S3.SS2.SSS1.p3.3.m3.6.6.cmml">q</mi><mo id="S3.SS2.SSS1.p3.3.m3.6.7.3.3.2.2" stretchy="false" xref="S3.SS2.SSS1.p3.3.m3.6.7.3.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS1.p3.3.m3.6b"><apply id="S3.SS2.SSS1.p3.3.m3.6.7.cmml" xref="S3.SS2.SSS1.p3.3.m3.6.7"><eq id="S3.SS2.SSS1.p3.3.m3.6.7.1.cmml" xref="S3.SS2.SSS1.p3.3.m3.6.7.1"></eq><apply id="S3.SS2.SSS1.p3.3.m3.6.7.2.cmml" xref="S3.SS2.SSS1.p3.3.m3.6.7.2"><times id="S3.SS2.SSS1.p3.3.m3.6.7.2.1.cmml" xref="S3.SS2.SSS1.p3.3.m3.6.7.2.1"></times><ci id="S3.SS2.SSS1.p3.3.m3.6.7.2.2.cmml" xref="S3.SS2.SSS1.p3.3.m3.6.7.2.2">𝑅</ci><ci id="S3.SS2.SSS1.p3.3.m3.5.5.cmml" xref="S3.SS2.SSS1.p3.3.m3.5.5">𝑞</ci></apply><apply id="S3.SS2.SSS1.p3.3.m3.6.7.3.cmml" xref="S3.SS2.SSS1.p3.3.m3.6.7.3"><times id="S3.SS2.SSS1.p3.3.m3.6.7.3.1.cmml" xref="S3.SS2.SSS1.p3.3.m3.6.7.3.1"></times><apply id="S3.SS2.SSS1.p3.3.m3.6.7.3.2.cmml" xref="S3.SS2.SSS1.p3.3.m3.6.7.3.2"><csymbol cd="ambiguous" id="S3.SS2.SSS1.p3.3.m3.6.7.3.2.1.cmml" xref="S3.SS2.SSS1.p3.3.m3.6.7.3.2">subscript</csymbol><ci id="S3.SS2.SSS1.p3.3.m3.6.7.3.2.2.cmml" xref="S3.SS2.SSS1.p3.3.m3.6.7.3.2.2">𝑅</ci><apply id="S3.SS2.SSS1.p3.3.m3.4.4.4.cmml" xref="S3.SS2.SSS1.p3.3.m3.4.4.4"><setdiff id="S3.SS2.SSS1.p3.3.m3.4.4.4.5.cmml" xref="S3.SS2.SSS1.p3.3.m3.4.4.4.5"></setdiff><ci id="S3.SS2.SSS1.p3.3.m3.4.4.4.6.cmml" xref="S3.SS2.SSS1.p3.3.m3.4.4.4.6">𝒟</ci><set id="S3.SS2.SSS1.p3.3.m3.4.4.4.4.2.cmml" xref="S3.SS2.SSS1.p3.3.m3.4.4.4.4.1"><vector id="S3.SS2.SSS1.p3.3.m3.4.4.4.4.1.1.1.cmml" xref="S3.SS2.SSS1.p3.3.m3.4.4.4.4.1.1.2"><ci id="S3.SS2.SSS1.p3.3.m3.1.1.1.1.cmml" xref="S3.SS2.SSS1.p3.3.m3.1.1.1.1">𝑞</ci><ci id="S3.SS2.SSS1.p3.3.m3.2.2.2.2.cmml" xref="S3.SS2.SSS1.p3.3.m3.2.2.2.2">𝑎</ci><apply id="S3.SS2.SSS1.p3.3.m3.3.3.3.3.cmml" xref="S3.SS2.SSS1.p3.3.m3.3.3.3.3"><ci id="S3.SS2.SSS1.p3.3.m3.3.3.3.3.1.cmml" xref="S3.SS2.SSS1.p3.3.m3.3.3.3.3.1">¯</ci><ci id="S3.SS2.SSS1.p3.3.m3.3.3.3.3.2.cmml" xref="S3.SS2.SSS1.p3.3.m3.3.3.3.3.2">𝑎</ci></apply></vector></set></apply></apply><ci id="S3.SS2.SSS1.p3.3.m3.6.6.cmml" xref="S3.SS2.SSS1.p3.3.m3.6.6">𝑞</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS1.p3.3.m3.6c">R(q)=R_{\mathcal{D}\setminus\{(q,a,\bar{a})\}}(q)</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS1.p3.3.m3.6d">italic_R ( italic_q ) = italic_R start_POSTSUBSCRIPT caligraphic_D ∖ { ( italic_q , italic_a , over¯ start_ARG italic_a end_ARG ) } end_POSTSUBSCRIPT ( italic_q )</annotation></semantics></math>.
We define the metric MC1 which is related to accuracy:</p>
<table class="ltx_equation ltx_eqn_table" id="S3.Ex4">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\text{MC1}=\frac{1}{|\mathcal{D}|}\sum_{(q,a,\bar{a})\in\mathcal{D}}\mathbf{1}%
\Big{(}p_{M}\big{(}a\mid q,R(q)\big{)}&gt;p_{M}\big{(}\bar{a}\mid q,R(q)\big{)}%
\Big{)}" class="ltx_Math" display="block" id="S3.Ex4.m1.9"><semantics id="S3.Ex4.m1.9a"><mrow id="S3.Ex4.m1.9.9" xref="S3.Ex4.m1.9.9.cmml"><mtext id="S3.Ex4.m1.9.9.3" xref="S3.Ex4.m1.9.9.3a.cmml">MC1</mtext><mo id="S3.Ex4.m1.9.9.2" xref="S3.Ex4.m1.9.9.2.cmml">=</mo><mrow id="S3.Ex4.m1.9.9.1" xref="S3.Ex4.m1.9.9.1.cmml"><mfrac id="S3.Ex4.m1.1.1" xref="S3.Ex4.m1.1.1.cmml"><mn id="S3.Ex4.m1.1.1.3" xref="S3.Ex4.m1.1.1.3.cmml">1</mn><mrow id="S3.Ex4.m1.1.1.1.3" xref="S3.Ex4.m1.1.1.1.2.cmml"><mo id="S3.Ex4.m1.1.1.1.3.1" stretchy="false" xref="S3.Ex4.m1.1.1.1.2.1.cmml">|</mo><mi class="ltx_font_mathcaligraphic" id="S3.Ex4.m1.1.1.1.1" xref="S3.Ex4.m1.1.1.1.1.cmml">𝒟</mi><mo id="S3.Ex4.m1.1.1.1.3.2" stretchy="false" xref="S3.Ex4.m1.1.1.1.2.1.cmml">|</mo></mrow></mfrac><mo id="S3.Ex4.m1.9.9.1.2" xref="S3.Ex4.m1.9.9.1.2.cmml">⁢</mo><mrow id="S3.Ex4.m1.9.9.1.1" xref="S3.Ex4.m1.9.9.1.1.cmml"><munder id="S3.Ex4.m1.9.9.1.1.2" xref="S3.Ex4.m1.9.9.1.1.2.cmml"><mo id="S3.Ex4.m1.9.9.1.1.2.2" movablelimits="false" xref="S3.Ex4.m1.9.9.1.1.2.2.cmml">∑</mo><mrow id="S3.Ex4.m1.4.4.3" xref="S3.Ex4.m1.4.4.3.cmml"><mrow id="S3.Ex4.m1.4.4.3.5.2" xref="S3.Ex4.m1.4.4.3.5.1.cmml"><mo id="S3.Ex4.m1.4.4.3.5.2.1" stretchy="false" xref="S3.Ex4.m1.4.4.3.5.1.cmml">(</mo><mi id="S3.Ex4.m1.2.2.1.1" xref="S3.Ex4.m1.2.2.1.1.cmml">q</mi><mo id="S3.Ex4.m1.4.4.3.5.2.2" xref="S3.Ex4.m1.4.4.3.5.1.cmml">,</mo><mi id="S3.Ex4.m1.3.3.2.2" xref="S3.Ex4.m1.3.3.2.2.cmml">a</mi><mo id="S3.Ex4.m1.4.4.3.5.2.3" xref="S3.Ex4.m1.4.4.3.5.1.cmml">,</mo><mover accent="true" id="S3.Ex4.m1.4.4.3.3" xref="S3.Ex4.m1.4.4.3.3.cmml"><mi id="S3.Ex4.m1.4.4.3.3.2" xref="S3.Ex4.m1.4.4.3.3.2.cmml">a</mi><mo id="S3.Ex4.m1.4.4.3.3.1" xref="S3.Ex4.m1.4.4.3.3.1.cmml">¯</mo></mover><mo id="S3.Ex4.m1.4.4.3.5.2.4" stretchy="false" xref="S3.Ex4.m1.4.4.3.5.1.cmml">)</mo></mrow><mo id="S3.Ex4.m1.4.4.3.4" xref="S3.Ex4.m1.4.4.3.4.cmml">∈</mo><mi class="ltx_font_mathcaligraphic" id="S3.Ex4.m1.4.4.3.6" xref="S3.Ex4.m1.4.4.3.6.cmml">𝒟</mi></mrow></munder><mrow id="S3.Ex4.m1.9.9.1.1.1" xref="S3.Ex4.m1.9.9.1.1.1.cmml"><mn id="S3.Ex4.m1.9.9.1.1.1.3" xref="S3.Ex4.m1.9.9.1.1.1.3.cmml">𝟏</mn><mo id="S3.Ex4.m1.9.9.1.1.1.2" xref="S3.Ex4.m1.9.9.1.1.1.2.cmml">⁢</mo><mrow id="S3.Ex4.m1.9.9.1.1.1.1.1" xref="S3.Ex4.m1.9.9.1.1.1.1.1.1.cmml"><mo id="S3.Ex4.m1.9.9.1.1.1.1.1.2" maxsize="160%" minsize="160%" xref="S3.Ex4.m1.9.9.1.1.1.1.1.1.cmml">(</mo><mrow id="S3.Ex4.m1.9.9.1.1.1.1.1.1" xref="S3.Ex4.m1.9.9.1.1.1.1.1.1.cmml"><mrow id="S3.Ex4.m1.9.9.1.1.1.1.1.1.1" xref="S3.Ex4.m1.9.9.1.1.1.1.1.1.1.cmml"><msub id="S3.Ex4.m1.9.9.1.1.1.1.1.1.1.3" xref="S3.Ex4.m1.9.9.1.1.1.1.1.1.1.3.cmml"><mi id="S3.Ex4.m1.9.9.1.1.1.1.1.1.1.3.2" xref="S3.Ex4.m1.9.9.1.1.1.1.1.1.1.3.2.cmml">p</mi><mi id="S3.Ex4.m1.9.9.1.1.1.1.1.1.1.3.3" xref="S3.Ex4.m1.9.9.1.1.1.1.1.1.1.3.3.cmml">M</mi></msub><mo id="S3.Ex4.m1.9.9.1.1.1.1.1.1.1.2" xref="S3.Ex4.m1.9.9.1.1.1.1.1.1.1.2.cmml">⁢</mo><mrow id="S3.Ex4.m1.9.9.1.1.1.1.1.1.1.1.1" xref="S3.Ex4.m1.9.9.1.1.1.1.1.1.1.1.1.1.cmml"><mo id="S3.Ex4.m1.9.9.1.1.1.1.1.1.1.1.1.2" maxsize="120%" minsize="120%" xref="S3.Ex4.m1.9.9.1.1.1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="S3.Ex4.m1.9.9.1.1.1.1.1.1.1.1.1.1" xref="S3.Ex4.m1.9.9.1.1.1.1.1.1.1.1.1.1.cmml"><mi id="S3.Ex4.m1.9.9.1.1.1.1.1.1.1.1.1.1.3" xref="S3.Ex4.m1.9.9.1.1.1.1.1.1.1.1.1.1.3.cmml">a</mi><mo id="S3.Ex4.m1.9.9.1.1.1.1.1.1.1.1.1.1.2" xref="S3.Ex4.m1.9.9.1.1.1.1.1.1.1.1.1.1.2.cmml">∣</mo><mrow id="S3.Ex4.m1.9.9.1.1.1.1.1.1.1.1.1.1.1.1" xref="S3.Ex4.m1.9.9.1.1.1.1.1.1.1.1.1.1.1.2.cmml"><mi id="S3.Ex4.m1.6.6" xref="S3.Ex4.m1.6.6.cmml">q</mi><mo id="S3.Ex4.m1.9.9.1.1.1.1.1.1.1.1.1.1.1.1.2" xref="S3.Ex4.m1.9.9.1.1.1.1.1.1.1.1.1.1.1.2.cmml">,</mo><mrow id="S3.Ex4.m1.9.9.1.1.1.1.1.1.1.1.1.1.1.1.1" xref="S3.Ex4.m1.9.9.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml"><mi id="S3.Ex4.m1.9.9.1.1.1.1.1.1.1.1.1.1.1.1.1.2" xref="S3.Ex4.m1.9.9.1.1.1.1.1.1.1.1.1.1.1.1.1.2.cmml">R</mi><mo id="S3.Ex4.m1.9.9.1.1.1.1.1.1.1.1.1.1.1.1.1.1" xref="S3.Ex4.m1.9.9.1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml">⁢</mo><mrow id="S3.Ex4.m1.9.9.1.1.1.1.1.1.1.1.1.1.1.1.1.3.2" xref="S3.Ex4.m1.9.9.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml"><mo id="S3.Ex4.m1.9.9.1.1.1.1.1.1.1.1.1.1.1.1.1.3.2.1" stretchy="false" xref="S3.Ex4.m1.9.9.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml">(</mo><mi id="S3.Ex4.m1.5.5" xref="S3.Ex4.m1.5.5.cmml">q</mi><mo id="S3.Ex4.m1.9.9.1.1.1.1.1.1.1.1.1.1.1.1.1.3.2.2" stretchy="false" xref="S3.Ex4.m1.9.9.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow></mrow><mo id="S3.Ex4.m1.9.9.1.1.1.1.1.1.1.1.1.3" maxsize="120%" minsize="120%" xref="S3.Ex4.m1.9.9.1.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S3.Ex4.m1.9.9.1.1.1.1.1.1.3" xref="S3.Ex4.m1.9.9.1.1.1.1.1.1.3.cmml">&gt;</mo><mrow id="S3.Ex4.m1.9.9.1.1.1.1.1.1.2" xref="S3.Ex4.m1.9.9.1.1.1.1.1.1.2.cmml"><msub id="S3.Ex4.m1.9.9.1.1.1.1.1.1.2.3" xref="S3.Ex4.m1.9.9.1.1.1.1.1.1.2.3.cmml"><mi id="S3.Ex4.m1.9.9.1.1.1.1.1.1.2.3.2" xref="S3.Ex4.m1.9.9.1.1.1.1.1.1.2.3.2.cmml">p</mi><mi id="S3.Ex4.m1.9.9.1.1.1.1.1.1.2.3.3" xref="S3.Ex4.m1.9.9.1.1.1.1.1.1.2.3.3.cmml">M</mi></msub><mo id="S3.Ex4.m1.9.9.1.1.1.1.1.1.2.2" xref="S3.Ex4.m1.9.9.1.1.1.1.1.1.2.2.cmml">⁢</mo><mrow id="S3.Ex4.m1.9.9.1.1.1.1.1.1.2.1.1" xref="S3.Ex4.m1.9.9.1.1.1.1.1.1.2.1.1.1.cmml"><mo id="S3.Ex4.m1.9.9.1.1.1.1.1.1.2.1.1.2" maxsize="120%" minsize="120%" xref="S3.Ex4.m1.9.9.1.1.1.1.1.1.2.1.1.1.cmml">(</mo><mrow id="S3.Ex4.m1.9.9.1.1.1.1.1.1.2.1.1.1" xref="S3.Ex4.m1.9.9.1.1.1.1.1.1.2.1.1.1.cmml"><mover accent="true" id="S3.Ex4.m1.9.9.1.1.1.1.1.1.2.1.1.1.3" xref="S3.Ex4.m1.9.9.1.1.1.1.1.1.2.1.1.1.3.cmml"><mi id="S3.Ex4.m1.9.9.1.1.1.1.1.1.2.1.1.1.3.2" xref="S3.Ex4.m1.9.9.1.1.1.1.1.1.2.1.1.1.3.2.cmml">a</mi><mo id="S3.Ex4.m1.9.9.1.1.1.1.1.1.2.1.1.1.3.1" xref="S3.Ex4.m1.9.9.1.1.1.1.1.1.2.1.1.1.3.1.cmml">¯</mo></mover><mo id="S3.Ex4.m1.9.9.1.1.1.1.1.1.2.1.1.1.2" xref="S3.Ex4.m1.9.9.1.1.1.1.1.1.2.1.1.1.2.cmml">∣</mo><mrow id="S3.Ex4.m1.9.9.1.1.1.1.1.1.2.1.1.1.1.1" xref="S3.Ex4.m1.9.9.1.1.1.1.1.1.2.1.1.1.1.2.cmml"><mi id="S3.Ex4.m1.8.8" xref="S3.Ex4.m1.8.8.cmml">q</mi><mo id="S3.Ex4.m1.9.9.1.1.1.1.1.1.2.1.1.1.1.1.2" xref="S3.Ex4.m1.9.9.1.1.1.1.1.1.2.1.1.1.1.2.cmml">,</mo><mrow id="S3.Ex4.m1.9.9.1.1.1.1.1.1.2.1.1.1.1.1.1" xref="S3.Ex4.m1.9.9.1.1.1.1.1.1.2.1.1.1.1.1.1.cmml"><mi id="S3.Ex4.m1.9.9.1.1.1.1.1.1.2.1.1.1.1.1.1.2" xref="S3.Ex4.m1.9.9.1.1.1.1.1.1.2.1.1.1.1.1.1.2.cmml">R</mi><mo id="S3.Ex4.m1.9.9.1.1.1.1.1.1.2.1.1.1.1.1.1.1" xref="S3.Ex4.m1.9.9.1.1.1.1.1.1.2.1.1.1.1.1.1.1.cmml">⁢</mo><mrow id="S3.Ex4.m1.9.9.1.1.1.1.1.1.2.1.1.1.1.1.1.3.2" xref="S3.Ex4.m1.9.9.1.1.1.1.1.1.2.1.1.1.1.1.1.cmml"><mo id="S3.Ex4.m1.9.9.1.1.1.1.1.1.2.1.1.1.1.1.1.3.2.1" stretchy="false" xref="S3.Ex4.m1.9.9.1.1.1.1.1.1.2.1.1.1.1.1.1.cmml">(</mo><mi id="S3.Ex4.m1.7.7" xref="S3.Ex4.m1.7.7.cmml">q</mi><mo id="S3.Ex4.m1.9.9.1.1.1.1.1.1.2.1.1.1.1.1.1.3.2.2" stretchy="false" xref="S3.Ex4.m1.9.9.1.1.1.1.1.1.2.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow></mrow><mo id="S3.Ex4.m1.9.9.1.1.1.1.1.1.2.1.1.3" maxsize="120%" minsize="120%" xref="S3.Ex4.m1.9.9.1.1.1.1.1.1.2.1.1.1.cmml">)</mo></mrow></mrow></mrow><mo id="S3.Ex4.m1.9.9.1.1.1.1.1.3" maxsize="160%" minsize="160%" xref="S3.Ex4.m1.9.9.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.Ex4.m1.9b"><apply id="S3.Ex4.m1.9.9.cmml" xref="S3.Ex4.m1.9.9"><eq id="S3.Ex4.m1.9.9.2.cmml" xref="S3.Ex4.m1.9.9.2"></eq><ci id="S3.Ex4.m1.9.9.3a.cmml" xref="S3.Ex4.m1.9.9.3"><mtext id="S3.Ex4.m1.9.9.3.cmml" xref="S3.Ex4.m1.9.9.3">MC1</mtext></ci><apply id="S3.Ex4.m1.9.9.1.cmml" xref="S3.Ex4.m1.9.9.1"><times id="S3.Ex4.m1.9.9.1.2.cmml" xref="S3.Ex4.m1.9.9.1.2"></times><apply id="S3.Ex4.m1.1.1.cmml" xref="S3.Ex4.m1.1.1"><divide id="S3.Ex4.m1.1.1.2.cmml" xref="S3.Ex4.m1.1.1"></divide><cn id="S3.Ex4.m1.1.1.3.cmml" type="integer" xref="S3.Ex4.m1.1.1.3">1</cn><apply id="S3.Ex4.m1.1.1.1.2.cmml" xref="S3.Ex4.m1.1.1.1.3"><abs id="S3.Ex4.m1.1.1.1.2.1.cmml" xref="S3.Ex4.m1.1.1.1.3.1"></abs><ci id="S3.Ex4.m1.1.1.1.1.cmml" xref="S3.Ex4.m1.1.1.1.1">𝒟</ci></apply></apply><apply id="S3.Ex4.m1.9.9.1.1.cmml" xref="S3.Ex4.m1.9.9.1.1"><apply id="S3.Ex4.m1.9.9.1.1.2.cmml" xref="S3.Ex4.m1.9.9.1.1.2"><csymbol cd="ambiguous" id="S3.Ex4.m1.9.9.1.1.2.1.cmml" xref="S3.Ex4.m1.9.9.1.1.2">subscript</csymbol><sum id="S3.Ex4.m1.9.9.1.1.2.2.cmml" xref="S3.Ex4.m1.9.9.1.1.2.2"></sum><apply id="S3.Ex4.m1.4.4.3.cmml" xref="S3.Ex4.m1.4.4.3"><in id="S3.Ex4.m1.4.4.3.4.cmml" xref="S3.Ex4.m1.4.4.3.4"></in><vector id="S3.Ex4.m1.4.4.3.5.1.cmml" xref="S3.Ex4.m1.4.4.3.5.2"><ci id="S3.Ex4.m1.2.2.1.1.cmml" xref="S3.Ex4.m1.2.2.1.1">𝑞</ci><ci id="S3.Ex4.m1.3.3.2.2.cmml" xref="S3.Ex4.m1.3.3.2.2">𝑎</ci><apply id="S3.Ex4.m1.4.4.3.3.cmml" xref="S3.Ex4.m1.4.4.3.3"><ci id="S3.Ex4.m1.4.4.3.3.1.cmml" xref="S3.Ex4.m1.4.4.3.3.1">¯</ci><ci id="S3.Ex4.m1.4.4.3.3.2.cmml" xref="S3.Ex4.m1.4.4.3.3.2">𝑎</ci></apply></vector><ci id="S3.Ex4.m1.4.4.3.6.cmml" xref="S3.Ex4.m1.4.4.3.6">𝒟</ci></apply></apply><apply id="S3.Ex4.m1.9.9.1.1.1.cmml" xref="S3.Ex4.m1.9.9.1.1.1"><times id="S3.Ex4.m1.9.9.1.1.1.2.cmml" xref="S3.Ex4.m1.9.9.1.1.1.2"></times><cn id="S3.Ex4.m1.9.9.1.1.1.3.cmml" type="integer" xref="S3.Ex4.m1.9.9.1.1.1.3">1</cn><apply id="S3.Ex4.m1.9.9.1.1.1.1.1.1.cmml" xref="S3.Ex4.m1.9.9.1.1.1.1.1"><gt id="S3.Ex4.m1.9.9.1.1.1.1.1.1.3.cmml" xref="S3.Ex4.m1.9.9.1.1.1.1.1.1.3"></gt><apply id="S3.Ex4.m1.9.9.1.1.1.1.1.1.1.cmml" xref="S3.Ex4.m1.9.9.1.1.1.1.1.1.1"><times id="S3.Ex4.m1.9.9.1.1.1.1.1.1.1.2.cmml" xref="S3.Ex4.m1.9.9.1.1.1.1.1.1.1.2"></times><apply id="S3.Ex4.m1.9.9.1.1.1.1.1.1.1.3.cmml" xref="S3.Ex4.m1.9.9.1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.Ex4.m1.9.9.1.1.1.1.1.1.1.3.1.cmml" xref="S3.Ex4.m1.9.9.1.1.1.1.1.1.1.3">subscript</csymbol><ci id="S3.Ex4.m1.9.9.1.1.1.1.1.1.1.3.2.cmml" xref="S3.Ex4.m1.9.9.1.1.1.1.1.1.1.3.2">𝑝</ci><ci id="S3.Ex4.m1.9.9.1.1.1.1.1.1.1.3.3.cmml" xref="S3.Ex4.m1.9.9.1.1.1.1.1.1.1.3.3">𝑀</ci></apply><apply id="S3.Ex4.m1.9.9.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.Ex4.m1.9.9.1.1.1.1.1.1.1.1.1"><csymbol cd="latexml" id="S3.Ex4.m1.9.9.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S3.Ex4.m1.9.9.1.1.1.1.1.1.1.1.1.1.2">conditional</csymbol><ci id="S3.Ex4.m1.9.9.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="S3.Ex4.m1.9.9.1.1.1.1.1.1.1.1.1.1.3">𝑎</ci><list id="S3.Ex4.m1.9.9.1.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S3.Ex4.m1.9.9.1.1.1.1.1.1.1.1.1.1.1.1"><ci id="S3.Ex4.m1.6.6.cmml" xref="S3.Ex4.m1.6.6">𝑞</ci><apply id="S3.Ex4.m1.9.9.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.Ex4.m1.9.9.1.1.1.1.1.1.1.1.1.1.1.1.1"><times id="S3.Ex4.m1.9.9.1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.Ex4.m1.9.9.1.1.1.1.1.1.1.1.1.1.1.1.1.1"></times><ci id="S3.Ex4.m1.9.9.1.1.1.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S3.Ex4.m1.9.9.1.1.1.1.1.1.1.1.1.1.1.1.1.2">𝑅</ci><ci id="S3.Ex4.m1.5.5.cmml" xref="S3.Ex4.m1.5.5">𝑞</ci></apply></list></apply></apply><apply id="S3.Ex4.m1.9.9.1.1.1.1.1.1.2.cmml" xref="S3.Ex4.m1.9.9.1.1.1.1.1.1.2"><times id="S3.Ex4.m1.9.9.1.1.1.1.1.1.2.2.cmml" xref="S3.Ex4.m1.9.9.1.1.1.1.1.1.2.2"></times><apply id="S3.Ex4.m1.9.9.1.1.1.1.1.1.2.3.cmml" xref="S3.Ex4.m1.9.9.1.1.1.1.1.1.2.3"><csymbol cd="ambiguous" id="S3.Ex4.m1.9.9.1.1.1.1.1.1.2.3.1.cmml" xref="S3.Ex4.m1.9.9.1.1.1.1.1.1.2.3">subscript</csymbol><ci id="S3.Ex4.m1.9.9.1.1.1.1.1.1.2.3.2.cmml" xref="S3.Ex4.m1.9.9.1.1.1.1.1.1.2.3.2">𝑝</ci><ci id="S3.Ex4.m1.9.9.1.1.1.1.1.1.2.3.3.cmml" xref="S3.Ex4.m1.9.9.1.1.1.1.1.1.2.3.3">𝑀</ci></apply><apply id="S3.Ex4.m1.9.9.1.1.1.1.1.1.2.1.1.1.cmml" xref="S3.Ex4.m1.9.9.1.1.1.1.1.1.2.1.1"><csymbol cd="latexml" id="S3.Ex4.m1.9.9.1.1.1.1.1.1.2.1.1.1.2.cmml" xref="S3.Ex4.m1.9.9.1.1.1.1.1.1.2.1.1.1.2">conditional</csymbol><apply id="S3.Ex4.m1.9.9.1.1.1.1.1.1.2.1.1.1.3.cmml" xref="S3.Ex4.m1.9.9.1.1.1.1.1.1.2.1.1.1.3"><ci id="S3.Ex4.m1.9.9.1.1.1.1.1.1.2.1.1.1.3.1.cmml" xref="S3.Ex4.m1.9.9.1.1.1.1.1.1.2.1.1.1.3.1">¯</ci><ci id="S3.Ex4.m1.9.9.1.1.1.1.1.1.2.1.1.1.3.2.cmml" xref="S3.Ex4.m1.9.9.1.1.1.1.1.1.2.1.1.1.3.2">𝑎</ci></apply><list id="S3.Ex4.m1.9.9.1.1.1.1.1.1.2.1.1.1.1.2.cmml" xref="S3.Ex4.m1.9.9.1.1.1.1.1.1.2.1.1.1.1.1"><ci id="S3.Ex4.m1.8.8.cmml" xref="S3.Ex4.m1.8.8">𝑞</ci><apply id="S3.Ex4.m1.9.9.1.1.1.1.1.1.2.1.1.1.1.1.1.cmml" xref="S3.Ex4.m1.9.9.1.1.1.1.1.1.2.1.1.1.1.1.1"><times id="S3.Ex4.m1.9.9.1.1.1.1.1.1.2.1.1.1.1.1.1.1.cmml" xref="S3.Ex4.m1.9.9.1.1.1.1.1.1.2.1.1.1.1.1.1.1"></times><ci id="S3.Ex4.m1.9.9.1.1.1.1.1.1.2.1.1.1.1.1.1.2.cmml" xref="S3.Ex4.m1.9.9.1.1.1.1.1.1.2.1.1.1.1.1.1.2">𝑅</ci><ci id="S3.Ex4.m1.7.7.cmml" xref="S3.Ex4.m1.7.7">𝑞</ci></apply></list></apply></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.Ex4.m1.9c">\text{MC1}=\frac{1}{|\mathcal{D}|}\sum_{(q,a,\bar{a})\in\mathcal{D}}\mathbf{1}%
\Big{(}p_{M}\big{(}a\mid q,R(q)\big{)}&gt;p_{M}\big{(}\bar{a}\mid q,R(q)\big{)}%
\Big{)}</annotation><annotation encoding="application/x-llamapun" id="S3.Ex4.m1.9d">MC1 = divide start_ARG 1 end_ARG start_ARG | caligraphic_D | end_ARG ∑ start_POSTSUBSCRIPT ( italic_q , italic_a , over¯ start_ARG italic_a end_ARG ) ∈ caligraphic_D end_POSTSUBSCRIPT bold_1 ( italic_p start_POSTSUBSCRIPT italic_M end_POSTSUBSCRIPT ( italic_a ∣ italic_q , italic_R ( italic_q ) ) &gt; italic_p start_POSTSUBSCRIPT italic_M end_POSTSUBSCRIPT ( over¯ start_ARG italic_a end_ARG ∣ italic_q , italic_R ( italic_q ) ) )</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
</div>
<div class="ltx_para" id="S3.SS2.SSS1.p4">
<p class="ltx_p" id="S3.SS2.SSS1.p4.1">In the case that many incorrect answers are provided for each query <math alttext="\mathbf{\bar{a}}" class="ltx_Math" display="inline" id="S3.SS2.SSS1.p4.1.m1.1"><semantics id="S3.SS2.SSS1.p4.1.m1.1a"><mover accent="true" id="S3.SS2.SSS1.p4.1.m1.1.1" xref="S3.SS2.SSS1.p4.1.m1.1.1.cmml"><mi id="S3.SS2.SSS1.p4.1.m1.1.1.2" xref="S3.SS2.SSS1.p4.1.m1.1.1.2.cmml">𝐚</mi><mo id="S3.SS2.SSS1.p4.1.m1.1.1.1" xref="S3.SS2.SSS1.p4.1.m1.1.1.1.cmml">¯</mo></mover><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS1.p4.1.m1.1b"><apply id="S3.SS2.SSS1.p4.1.m1.1.1.cmml" xref="S3.SS2.SSS1.p4.1.m1.1.1"><ci id="S3.SS2.SSS1.p4.1.m1.1.1.1.cmml" xref="S3.SS2.SSS1.p4.1.m1.1.1.1">¯</ci><ci id="S3.SS2.SSS1.p4.1.m1.1.1.2.cmml" xref="S3.SS2.SSS1.p4.1.m1.1.1.2">𝐚</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS1.p4.1.m1.1c">\mathbf{\bar{a}}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS1.p4.1.m1.1d">over¯ start_ARG bold_a end_ARG</annotation></semantics></math>, we can extend this in the same manner as multi-class classification by requiring that the correct answer have greater probability than all the incorrect answers:</p>
<table class="ltx_equation ltx_eqn_table" id="S3.Ex5">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\frac{1}{|\mathcal{D}|}\sum_{(q,a,\mathbf{\bar{a}})\in\mathcal{D}}\prod_{\bar{%
a}\in\mathbf{\bar{a}}}\mathbf{1}\Big{(}p_{M}\big{(}a\mid q,R(q)\big{)}&gt;p_{M}%
\big{(}\bar{a}\mid q,R(q)\big{)}\Big{)}" class="ltx_Math" display="block" id="S3.Ex5.m1.9"><semantics id="S3.Ex5.m1.9a"><mrow id="S3.Ex5.m1.9.9" xref="S3.Ex5.m1.9.9.cmml"><mfrac id="S3.Ex5.m1.1.1" xref="S3.Ex5.m1.1.1.cmml"><mn id="S3.Ex5.m1.1.1.3" xref="S3.Ex5.m1.1.1.3.cmml">1</mn><mrow id="S3.Ex5.m1.1.1.1.3" xref="S3.Ex5.m1.1.1.1.2.cmml"><mo id="S3.Ex5.m1.1.1.1.3.1" stretchy="false" xref="S3.Ex5.m1.1.1.1.2.1.cmml">|</mo><mi class="ltx_font_mathcaligraphic" id="S3.Ex5.m1.1.1.1.1" xref="S3.Ex5.m1.1.1.1.1.cmml">𝒟</mi><mo id="S3.Ex5.m1.1.1.1.3.2" stretchy="false" xref="S3.Ex5.m1.1.1.1.2.1.cmml">|</mo></mrow></mfrac><mo id="S3.Ex5.m1.9.9.2" xref="S3.Ex5.m1.9.9.2.cmml">⁢</mo><mrow id="S3.Ex5.m1.9.9.1" xref="S3.Ex5.m1.9.9.1.cmml"><munder id="S3.Ex5.m1.9.9.1.2" xref="S3.Ex5.m1.9.9.1.2.cmml"><mo id="S3.Ex5.m1.9.9.1.2.2" movablelimits="false" rspace="0em" xref="S3.Ex5.m1.9.9.1.2.2.cmml">∑</mo><mrow id="S3.Ex5.m1.4.4.3" xref="S3.Ex5.m1.4.4.3.cmml"><mrow id="S3.Ex5.m1.4.4.3.5.2" xref="S3.Ex5.m1.4.4.3.5.1.cmml"><mo id="S3.Ex5.m1.4.4.3.5.2.1" stretchy="false" xref="S3.Ex5.m1.4.4.3.5.1.cmml">(</mo><mi id="S3.Ex5.m1.2.2.1.1" xref="S3.Ex5.m1.2.2.1.1.cmml">q</mi><mo id="S3.Ex5.m1.4.4.3.5.2.2" xref="S3.Ex5.m1.4.4.3.5.1.cmml">,</mo><mi id="S3.Ex5.m1.3.3.2.2" xref="S3.Ex5.m1.3.3.2.2.cmml">a</mi><mo id="S3.Ex5.m1.4.4.3.5.2.3" xref="S3.Ex5.m1.4.4.3.5.1.cmml">,</mo><mover accent="true" id="S3.Ex5.m1.4.4.3.3" xref="S3.Ex5.m1.4.4.3.3.cmml"><mi id="S3.Ex5.m1.4.4.3.3.2" xref="S3.Ex5.m1.4.4.3.3.2.cmml">𝐚</mi><mo id="S3.Ex5.m1.4.4.3.3.1" xref="S3.Ex5.m1.4.4.3.3.1.cmml">¯</mo></mover><mo id="S3.Ex5.m1.4.4.3.5.2.4" stretchy="false" xref="S3.Ex5.m1.4.4.3.5.1.cmml">)</mo></mrow><mo id="S3.Ex5.m1.4.4.3.4" xref="S3.Ex5.m1.4.4.3.4.cmml">∈</mo><mi class="ltx_font_mathcaligraphic" id="S3.Ex5.m1.4.4.3.6" xref="S3.Ex5.m1.4.4.3.6.cmml">𝒟</mi></mrow></munder><mrow id="S3.Ex5.m1.9.9.1.1" xref="S3.Ex5.m1.9.9.1.1.cmml"><munder id="S3.Ex5.m1.9.9.1.1.2" xref="S3.Ex5.m1.9.9.1.1.2.cmml"><mo id="S3.Ex5.m1.9.9.1.1.2.2" movablelimits="false" xref="S3.Ex5.m1.9.9.1.1.2.2.cmml">∏</mo><mrow id="S3.Ex5.m1.9.9.1.1.2.3" xref="S3.Ex5.m1.9.9.1.1.2.3.cmml"><mover accent="true" id="S3.Ex5.m1.9.9.1.1.2.3.2" xref="S3.Ex5.m1.9.9.1.1.2.3.2.cmml"><mi id="S3.Ex5.m1.9.9.1.1.2.3.2.2" xref="S3.Ex5.m1.9.9.1.1.2.3.2.2.cmml">a</mi><mo id="S3.Ex5.m1.9.9.1.1.2.3.2.1" xref="S3.Ex5.m1.9.9.1.1.2.3.2.1.cmml">¯</mo></mover><mo id="S3.Ex5.m1.9.9.1.1.2.3.1" xref="S3.Ex5.m1.9.9.1.1.2.3.1.cmml">∈</mo><mover accent="true" id="S3.Ex5.m1.9.9.1.1.2.3.3" xref="S3.Ex5.m1.9.9.1.1.2.3.3.cmml"><mi id="S3.Ex5.m1.9.9.1.1.2.3.3.2" xref="S3.Ex5.m1.9.9.1.1.2.3.3.2.cmml">𝐚</mi><mo id="S3.Ex5.m1.9.9.1.1.2.3.3.1" xref="S3.Ex5.m1.9.9.1.1.2.3.3.1.cmml">¯</mo></mover></mrow></munder><mrow id="S3.Ex5.m1.9.9.1.1.1" xref="S3.Ex5.m1.9.9.1.1.1.cmml"><mn id="S3.Ex5.m1.9.9.1.1.1.3" xref="S3.Ex5.m1.9.9.1.1.1.3.cmml">𝟏</mn><mo id="S3.Ex5.m1.9.9.1.1.1.2" xref="S3.Ex5.m1.9.9.1.1.1.2.cmml">⁢</mo><mrow id="S3.Ex5.m1.9.9.1.1.1.1.1" xref="S3.Ex5.m1.9.9.1.1.1.1.1.1.cmml"><mo id="S3.Ex5.m1.9.9.1.1.1.1.1.2" maxsize="160%" minsize="160%" xref="S3.Ex5.m1.9.9.1.1.1.1.1.1.cmml">(</mo><mrow id="S3.Ex5.m1.9.9.1.1.1.1.1.1" xref="S3.Ex5.m1.9.9.1.1.1.1.1.1.cmml"><mrow id="S3.Ex5.m1.9.9.1.1.1.1.1.1.1" xref="S3.Ex5.m1.9.9.1.1.1.1.1.1.1.cmml"><msub id="S3.Ex5.m1.9.9.1.1.1.1.1.1.1.3" xref="S3.Ex5.m1.9.9.1.1.1.1.1.1.1.3.cmml"><mi id="S3.Ex5.m1.9.9.1.1.1.1.1.1.1.3.2" xref="S3.Ex5.m1.9.9.1.1.1.1.1.1.1.3.2.cmml">p</mi><mi id="S3.Ex5.m1.9.9.1.1.1.1.1.1.1.3.3" xref="S3.Ex5.m1.9.9.1.1.1.1.1.1.1.3.3.cmml">M</mi></msub><mo id="S3.Ex5.m1.9.9.1.1.1.1.1.1.1.2" xref="S3.Ex5.m1.9.9.1.1.1.1.1.1.1.2.cmml">⁢</mo><mrow id="S3.Ex5.m1.9.9.1.1.1.1.1.1.1.1.1" xref="S3.Ex5.m1.9.9.1.1.1.1.1.1.1.1.1.1.cmml"><mo id="S3.Ex5.m1.9.9.1.1.1.1.1.1.1.1.1.2" maxsize="120%" minsize="120%" xref="S3.Ex5.m1.9.9.1.1.1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="S3.Ex5.m1.9.9.1.1.1.1.1.1.1.1.1.1" xref="S3.Ex5.m1.9.9.1.1.1.1.1.1.1.1.1.1.cmml"><mi id="S3.Ex5.m1.9.9.1.1.1.1.1.1.1.1.1.1.3" xref="S3.Ex5.m1.9.9.1.1.1.1.1.1.1.1.1.1.3.cmml">a</mi><mo id="S3.Ex5.m1.9.9.1.1.1.1.1.1.1.1.1.1.2" xref="S3.Ex5.m1.9.9.1.1.1.1.1.1.1.1.1.1.2.cmml">∣</mo><mrow id="S3.Ex5.m1.9.9.1.1.1.1.1.1.1.1.1.1.1.1" xref="S3.Ex5.m1.9.9.1.1.1.1.1.1.1.1.1.1.1.2.cmml"><mi id="S3.Ex5.m1.6.6" xref="S3.Ex5.m1.6.6.cmml">q</mi><mo id="S3.Ex5.m1.9.9.1.1.1.1.1.1.1.1.1.1.1.1.2" xref="S3.Ex5.m1.9.9.1.1.1.1.1.1.1.1.1.1.1.2.cmml">,</mo><mrow id="S3.Ex5.m1.9.9.1.1.1.1.1.1.1.1.1.1.1.1.1" xref="S3.Ex5.m1.9.9.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml"><mi id="S3.Ex5.m1.9.9.1.1.1.1.1.1.1.1.1.1.1.1.1.2" xref="S3.Ex5.m1.9.9.1.1.1.1.1.1.1.1.1.1.1.1.1.2.cmml">R</mi><mo id="S3.Ex5.m1.9.9.1.1.1.1.1.1.1.1.1.1.1.1.1.1" xref="S3.Ex5.m1.9.9.1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml">⁢</mo><mrow id="S3.Ex5.m1.9.9.1.1.1.1.1.1.1.1.1.1.1.1.1.3.2" xref="S3.Ex5.m1.9.9.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml"><mo id="S3.Ex5.m1.9.9.1.1.1.1.1.1.1.1.1.1.1.1.1.3.2.1" stretchy="false" xref="S3.Ex5.m1.9.9.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml">(</mo><mi id="S3.Ex5.m1.5.5" xref="S3.Ex5.m1.5.5.cmml">q</mi><mo id="S3.Ex5.m1.9.9.1.1.1.1.1.1.1.1.1.1.1.1.1.3.2.2" stretchy="false" xref="S3.Ex5.m1.9.9.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow></mrow><mo id="S3.Ex5.m1.9.9.1.1.1.1.1.1.1.1.1.3" maxsize="120%" minsize="120%" xref="S3.Ex5.m1.9.9.1.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S3.Ex5.m1.9.9.1.1.1.1.1.1.3" xref="S3.Ex5.m1.9.9.1.1.1.1.1.1.3.cmml">&gt;</mo><mrow id="S3.Ex5.m1.9.9.1.1.1.1.1.1.2" xref="S3.Ex5.m1.9.9.1.1.1.1.1.1.2.cmml"><msub id="S3.Ex5.m1.9.9.1.1.1.1.1.1.2.3" xref="S3.Ex5.m1.9.9.1.1.1.1.1.1.2.3.cmml"><mi id="S3.Ex5.m1.9.9.1.1.1.1.1.1.2.3.2" xref="S3.Ex5.m1.9.9.1.1.1.1.1.1.2.3.2.cmml">p</mi><mi id="S3.Ex5.m1.9.9.1.1.1.1.1.1.2.3.3" xref="S3.Ex5.m1.9.9.1.1.1.1.1.1.2.3.3.cmml">M</mi></msub><mo id="S3.Ex5.m1.9.9.1.1.1.1.1.1.2.2" xref="S3.Ex5.m1.9.9.1.1.1.1.1.1.2.2.cmml">⁢</mo><mrow id="S3.Ex5.m1.9.9.1.1.1.1.1.1.2.1.1" xref="S3.Ex5.m1.9.9.1.1.1.1.1.1.2.1.1.1.cmml"><mo id="S3.Ex5.m1.9.9.1.1.1.1.1.1.2.1.1.2" maxsize="120%" minsize="120%" xref="S3.Ex5.m1.9.9.1.1.1.1.1.1.2.1.1.1.cmml">(</mo><mrow id="S3.Ex5.m1.9.9.1.1.1.1.1.1.2.1.1.1" xref="S3.Ex5.m1.9.9.1.1.1.1.1.1.2.1.1.1.cmml"><mover accent="true" id="S3.Ex5.m1.9.9.1.1.1.1.1.1.2.1.1.1.3" xref="S3.Ex5.m1.9.9.1.1.1.1.1.1.2.1.1.1.3.cmml"><mi id="S3.Ex5.m1.9.9.1.1.1.1.1.1.2.1.1.1.3.2" xref="S3.Ex5.m1.9.9.1.1.1.1.1.1.2.1.1.1.3.2.cmml">a</mi><mo id="S3.Ex5.m1.9.9.1.1.1.1.1.1.2.1.1.1.3.1" xref="S3.Ex5.m1.9.9.1.1.1.1.1.1.2.1.1.1.3.1.cmml">¯</mo></mover><mo id="S3.Ex5.m1.9.9.1.1.1.1.1.1.2.1.1.1.2" xref="S3.Ex5.m1.9.9.1.1.1.1.1.1.2.1.1.1.2.cmml">∣</mo><mrow id="S3.Ex5.m1.9.9.1.1.1.1.1.1.2.1.1.1.1.1" xref="S3.Ex5.m1.9.9.1.1.1.1.1.1.2.1.1.1.1.2.cmml"><mi id="S3.Ex5.m1.8.8" xref="S3.Ex5.m1.8.8.cmml">q</mi><mo id="S3.Ex5.m1.9.9.1.1.1.1.1.1.2.1.1.1.1.1.2" xref="S3.Ex5.m1.9.9.1.1.1.1.1.1.2.1.1.1.1.2.cmml">,</mo><mrow id="S3.Ex5.m1.9.9.1.1.1.1.1.1.2.1.1.1.1.1.1" xref="S3.Ex5.m1.9.9.1.1.1.1.1.1.2.1.1.1.1.1.1.cmml"><mi id="S3.Ex5.m1.9.9.1.1.1.1.1.1.2.1.1.1.1.1.1.2" xref="S3.Ex5.m1.9.9.1.1.1.1.1.1.2.1.1.1.1.1.1.2.cmml">R</mi><mo id="S3.Ex5.m1.9.9.1.1.1.1.1.1.2.1.1.1.1.1.1.1" xref="S3.Ex5.m1.9.9.1.1.1.1.1.1.2.1.1.1.1.1.1.1.cmml">⁢</mo><mrow id="S3.Ex5.m1.9.9.1.1.1.1.1.1.2.1.1.1.1.1.1.3.2" xref="S3.Ex5.m1.9.9.1.1.1.1.1.1.2.1.1.1.1.1.1.cmml"><mo id="S3.Ex5.m1.9.9.1.1.1.1.1.1.2.1.1.1.1.1.1.3.2.1" stretchy="false" xref="S3.Ex5.m1.9.9.1.1.1.1.1.1.2.1.1.1.1.1.1.cmml">(</mo><mi id="S3.Ex5.m1.7.7" xref="S3.Ex5.m1.7.7.cmml">q</mi><mo id="S3.Ex5.m1.9.9.1.1.1.1.1.1.2.1.1.1.1.1.1.3.2.2" stretchy="false" xref="S3.Ex5.m1.9.9.1.1.1.1.1.1.2.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow></mrow><mo id="S3.Ex5.m1.9.9.1.1.1.1.1.1.2.1.1.3" maxsize="120%" minsize="120%" xref="S3.Ex5.m1.9.9.1.1.1.1.1.1.2.1.1.1.cmml">)</mo></mrow></mrow></mrow><mo id="S3.Ex5.m1.9.9.1.1.1.1.1.3" maxsize="160%" minsize="160%" xref="S3.Ex5.m1.9.9.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.Ex5.m1.9b"><apply id="S3.Ex5.m1.9.9.cmml" xref="S3.Ex5.m1.9.9"><times id="S3.Ex5.m1.9.9.2.cmml" xref="S3.Ex5.m1.9.9.2"></times><apply id="S3.Ex5.m1.1.1.cmml" xref="S3.Ex5.m1.1.1"><divide id="S3.Ex5.m1.1.1.2.cmml" xref="S3.Ex5.m1.1.1"></divide><cn id="S3.Ex5.m1.1.1.3.cmml" type="integer" xref="S3.Ex5.m1.1.1.3">1</cn><apply id="S3.Ex5.m1.1.1.1.2.cmml" xref="S3.Ex5.m1.1.1.1.3"><abs id="S3.Ex5.m1.1.1.1.2.1.cmml" xref="S3.Ex5.m1.1.1.1.3.1"></abs><ci id="S3.Ex5.m1.1.1.1.1.cmml" xref="S3.Ex5.m1.1.1.1.1">𝒟</ci></apply></apply><apply id="S3.Ex5.m1.9.9.1.cmml" xref="S3.Ex5.m1.9.9.1"><apply id="S3.Ex5.m1.9.9.1.2.cmml" xref="S3.Ex5.m1.9.9.1.2"><csymbol cd="ambiguous" id="S3.Ex5.m1.9.9.1.2.1.cmml" xref="S3.Ex5.m1.9.9.1.2">subscript</csymbol><sum id="S3.Ex5.m1.9.9.1.2.2.cmml" xref="S3.Ex5.m1.9.9.1.2.2"></sum><apply id="S3.Ex5.m1.4.4.3.cmml" xref="S3.Ex5.m1.4.4.3"><in id="S3.Ex5.m1.4.4.3.4.cmml" xref="S3.Ex5.m1.4.4.3.4"></in><vector id="S3.Ex5.m1.4.4.3.5.1.cmml" xref="S3.Ex5.m1.4.4.3.5.2"><ci id="S3.Ex5.m1.2.2.1.1.cmml" xref="S3.Ex5.m1.2.2.1.1">𝑞</ci><ci id="S3.Ex5.m1.3.3.2.2.cmml" xref="S3.Ex5.m1.3.3.2.2">𝑎</ci><apply id="S3.Ex5.m1.4.4.3.3.cmml" xref="S3.Ex5.m1.4.4.3.3"><ci id="S3.Ex5.m1.4.4.3.3.1.cmml" xref="S3.Ex5.m1.4.4.3.3.1">¯</ci><ci id="S3.Ex5.m1.4.4.3.3.2.cmml" xref="S3.Ex5.m1.4.4.3.3.2">𝐚</ci></apply></vector><ci id="S3.Ex5.m1.4.4.3.6.cmml" xref="S3.Ex5.m1.4.4.3.6">𝒟</ci></apply></apply><apply id="S3.Ex5.m1.9.9.1.1.cmml" xref="S3.Ex5.m1.9.9.1.1"><apply id="S3.Ex5.m1.9.9.1.1.2.cmml" xref="S3.Ex5.m1.9.9.1.1.2"><csymbol cd="ambiguous" id="S3.Ex5.m1.9.9.1.1.2.1.cmml" xref="S3.Ex5.m1.9.9.1.1.2">subscript</csymbol><csymbol cd="latexml" id="S3.Ex5.m1.9.9.1.1.2.2.cmml" xref="S3.Ex5.m1.9.9.1.1.2.2">product</csymbol><apply id="S3.Ex5.m1.9.9.1.1.2.3.cmml" xref="S3.Ex5.m1.9.9.1.1.2.3"><in id="S3.Ex5.m1.9.9.1.1.2.3.1.cmml" xref="S3.Ex5.m1.9.9.1.1.2.3.1"></in><apply id="S3.Ex5.m1.9.9.1.1.2.3.2.cmml" xref="S3.Ex5.m1.9.9.1.1.2.3.2"><ci id="S3.Ex5.m1.9.9.1.1.2.3.2.1.cmml" xref="S3.Ex5.m1.9.9.1.1.2.3.2.1">¯</ci><ci id="S3.Ex5.m1.9.9.1.1.2.3.2.2.cmml" xref="S3.Ex5.m1.9.9.1.1.2.3.2.2">𝑎</ci></apply><apply id="S3.Ex5.m1.9.9.1.1.2.3.3.cmml" xref="S3.Ex5.m1.9.9.1.1.2.3.3"><ci id="S3.Ex5.m1.9.9.1.1.2.3.3.1.cmml" xref="S3.Ex5.m1.9.9.1.1.2.3.3.1">¯</ci><ci id="S3.Ex5.m1.9.9.1.1.2.3.3.2.cmml" xref="S3.Ex5.m1.9.9.1.1.2.3.3.2">𝐚</ci></apply></apply></apply><apply id="S3.Ex5.m1.9.9.1.1.1.cmml" xref="S3.Ex5.m1.9.9.1.1.1"><times id="S3.Ex5.m1.9.9.1.1.1.2.cmml" xref="S3.Ex5.m1.9.9.1.1.1.2"></times><cn id="S3.Ex5.m1.9.9.1.1.1.3.cmml" type="integer" xref="S3.Ex5.m1.9.9.1.1.1.3">1</cn><apply id="S3.Ex5.m1.9.9.1.1.1.1.1.1.cmml" xref="S3.Ex5.m1.9.9.1.1.1.1.1"><gt id="S3.Ex5.m1.9.9.1.1.1.1.1.1.3.cmml" xref="S3.Ex5.m1.9.9.1.1.1.1.1.1.3"></gt><apply id="S3.Ex5.m1.9.9.1.1.1.1.1.1.1.cmml" xref="S3.Ex5.m1.9.9.1.1.1.1.1.1.1"><times id="S3.Ex5.m1.9.9.1.1.1.1.1.1.1.2.cmml" xref="S3.Ex5.m1.9.9.1.1.1.1.1.1.1.2"></times><apply id="S3.Ex5.m1.9.9.1.1.1.1.1.1.1.3.cmml" xref="S3.Ex5.m1.9.9.1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.Ex5.m1.9.9.1.1.1.1.1.1.1.3.1.cmml" xref="S3.Ex5.m1.9.9.1.1.1.1.1.1.1.3">subscript</csymbol><ci id="S3.Ex5.m1.9.9.1.1.1.1.1.1.1.3.2.cmml" xref="S3.Ex5.m1.9.9.1.1.1.1.1.1.1.3.2">𝑝</ci><ci id="S3.Ex5.m1.9.9.1.1.1.1.1.1.1.3.3.cmml" xref="S3.Ex5.m1.9.9.1.1.1.1.1.1.1.3.3">𝑀</ci></apply><apply id="S3.Ex5.m1.9.9.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.Ex5.m1.9.9.1.1.1.1.1.1.1.1.1"><csymbol cd="latexml" id="S3.Ex5.m1.9.9.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S3.Ex5.m1.9.9.1.1.1.1.1.1.1.1.1.1.2">conditional</csymbol><ci id="S3.Ex5.m1.9.9.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="S3.Ex5.m1.9.9.1.1.1.1.1.1.1.1.1.1.3">𝑎</ci><list id="S3.Ex5.m1.9.9.1.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S3.Ex5.m1.9.9.1.1.1.1.1.1.1.1.1.1.1.1"><ci id="S3.Ex5.m1.6.6.cmml" xref="S3.Ex5.m1.6.6">𝑞</ci><apply id="S3.Ex5.m1.9.9.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.Ex5.m1.9.9.1.1.1.1.1.1.1.1.1.1.1.1.1"><times id="S3.Ex5.m1.9.9.1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.Ex5.m1.9.9.1.1.1.1.1.1.1.1.1.1.1.1.1.1"></times><ci id="S3.Ex5.m1.9.9.1.1.1.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S3.Ex5.m1.9.9.1.1.1.1.1.1.1.1.1.1.1.1.1.2">𝑅</ci><ci id="S3.Ex5.m1.5.5.cmml" xref="S3.Ex5.m1.5.5">𝑞</ci></apply></list></apply></apply><apply id="S3.Ex5.m1.9.9.1.1.1.1.1.1.2.cmml" xref="S3.Ex5.m1.9.9.1.1.1.1.1.1.2"><times id="S3.Ex5.m1.9.9.1.1.1.1.1.1.2.2.cmml" xref="S3.Ex5.m1.9.9.1.1.1.1.1.1.2.2"></times><apply id="S3.Ex5.m1.9.9.1.1.1.1.1.1.2.3.cmml" xref="S3.Ex5.m1.9.9.1.1.1.1.1.1.2.3"><csymbol cd="ambiguous" id="S3.Ex5.m1.9.9.1.1.1.1.1.1.2.3.1.cmml" xref="S3.Ex5.m1.9.9.1.1.1.1.1.1.2.3">subscript</csymbol><ci id="S3.Ex5.m1.9.9.1.1.1.1.1.1.2.3.2.cmml" xref="S3.Ex5.m1.9.9.1.1.1.1.1.1.2.3.2">𝑝</ci><ci id="S3.Ex5.m1.9.9.1.1.1.1.1.1.2.3.3.cmml" xref="S3.Ex5.m1.9.9.1.1.1.1.1.1.2.3.3">𝑀</ci></apply><apply id="S3.Ex5.m1.9.9.1.1.1.1.1.1.2.1.1.1.cmml" xref="S3.Ex5.m1.9.9.1.1.1.1.1.1.2.1.1"><csymbol cd="latexml" id="S3.Ex5.m1.9.9.1.1.1.1.1.1.2.1.1.1.2.cmml" xref="S3.Ex5.m1.9.9.1.1.1.1.1.1.2.1.1.1.2">conditional</csymbol><apply id="S3.Ex5.m1.9.9.1.1.1.1.1.1.2.1.1.1.3.cmml" xref="S3.Ex5.m1.9.9.1.1.1.1.1.1.2.1.1.1.3"><ci id="S3.Ex5.m1.9.9.1.1.1.1.1.1.2.1.1.1.3.1.cmml" xref="S3.Ex5.m1.9.9.1.1.1.1.1.1.2.1.1.1.3.1">¯</ci><ci id="S3.Ex5.m1.9.9.1.1.1.1.1.1.2.1.1.1.3.2.cmml" xref="S3.Ex5.m1.9.9.1.1.1.1.1.1.2.1.1.1.3.2">𝑎</ci></apply><list id="S3.Ex5.m1.9.9.1.1.1.1.1.1.2.1.1.1.1.2.cmml" xref="S3.Ex5.m1.9.9.1.1.1.1.1.1.2.1.1.1.1.1"><ci id="S3.Ex5.m1.8.8.cmml" xref="S3.Ex5.m1.8.8">𝑞</ci><apply id="S3.Ex5.m1.9.9.1.1.1.1.1.1.2.1.1.1.1.1.1.cmml" xref="S3.Ex5.m1.9.9.1.1.1.1.1.1.2.1.1.1.1.1.1"><times id="S3.Ex5.m1.9.9.1.1.1.1.1.1.2.1.1.1.1.1.1.1.cmml" xref="S3.Ex5.m1.9.9.1.1.1.1.1.1.2.1.1.1.1.1.1.1"></times><ci id="S3.Ex5.m1.9.9.1.1.1.1.1.1.2.1.1.1.1.1.1.2.cmml" xref="S3.Ex5.m1.9.9.1.1.1.1.1.1.2.1.1.1.1.1.1.2">𝑅</ci><ci id="S3.Ex5.m1.7.7.cmml" xref="S3.Ex5.m1.7.7">𝑞</ci></apply></list></apply></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.Ex5.m1.9c">\frac{1}{|\mathcal{D}|}\sum_{(q,a,\mathbf{\bar{a}})\in\mathcal{D}}\prod_{\bar{%
a}\in\mathbf{\bar{a}}}\mathbf{1}\Big{(}p_{M}\big{(}a\mid q,R(q)\big{)}&gt;p_{M}%
\big{(}\bar{a}\mid q,R(q)\big{)}\Big{)}</annotation><annotation encoding="application/x-llamapun" id="S3.Ex5.m1.9d">divide start_ARG 1 end_ARG start_ARG | caligraphic_D | end_ARG ∑ start_POSTSUBSCRIPT ( italic_q , italic_a , over¯ start_ARG bold_a end_ARG ) ∈ caligraphic_D end_POSTSUBSCRIPT ∏ start_POSTSUBSCRIPT over¯ start_ARG italic_a end_ARG ∈ over¯ start_ARG bold_a end_ARG end_POSTSUBSCRIPT bold_1 ( italic_p start_POSTSUBSCRIPT italic_M end_POSTSUBSCRIPT ( italic_a ∣ italic_q , italic_R ( italic_q ) ) &gt; italic_p start_POSTSUBSCRIPT italic_M end_POSTSUBSCRIPT ( over¯ start_ARG italic_a end_ARG ∣ italic_q , italic_R ( italic_q ) ) )</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
</div>
<div class="ltx_para" id="S3.SS2.SSS1.p5">
<p class="ltx_p" id="S3.SS2.SSS1.p5.2">We also define a metric MC2 which extends this further to the case that multiple correct answers <math alttext="\mathbf{a}" class="ltx_Math" display="inline" id="S3.SS2.SSS1.p5.1.m1.1"><semantics id="S3.SS2.SSS1.p5.1.m1.1a"><mi id="S3.SS2.SSS1.p5.1.m1.1.1" xref="S3.SS2.SSS1.p5.1.m1.1.1.cmml">𝐚</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS1.p5.1.m1.1b"><ci id="S3.SS2.SSS1.p5.1.m1.1.1.cmml" xref="S3.SS2.SSS1.p5.1.m1.1.1">𝐚</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS1.p5.1.m1.1c">\mathbf{a}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS1.p5.1.m1.1d">bold_a</annotation></semantics></math> and multiple incorrect answers <math alttext="\mathbf{\bar{a}}" class="ltx_Math" display="inline" id="S3.SS2.SSS1.p5.2.m2.1"><semantics id="S3.SS2.SSS1.p5.2.m2.1a"><mover accent="true" id="S3.SS2.SSS1.p5.2.m2.1.1" xref="S3.SS2.SSS1.p5.2.m2.1.1.cmml"><mi id="S3.SS2.SSS1.p5.2.m2.1.1.2" xref="S3.SS2.SSS1.p5.2.m2.1.1.2.cmml">𝐚</mi><mo id="S3.SS2.SSS1.p5.2.m2.1.1.1" xref="S3.SS2.SSS1.p5.2.m2.1.1.1.cmml">¯</mo></mover><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS1.p5.2.m2.1b"><apply id="S3.SS2.SSS1.p5.2.m2.1.1.cmml" xref="S3.SS2.SSS1.p5.2.m2.1.1"><ci id="S3.SS2.SSS1.p5.2.m2.1.1.1.cmml" xref="S3.SS2.SSS1.p5.2.m2.1.1.1">¯</ci><ci id="S3.SS2.SSS1.p5.2.m2.1.1.2.cmml" xref="S3.SS2.SSS1.p5.2.m2.1.1.2">𝐚</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS1.p5.2.m2.1c">\mathbf{\bar{a}}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS1.p5.2.m2.1d">over¯ start_ARG bold_a end_ARG</annotation></semantics></math> are provided for each query. This metric is the average number of correct answers which have greater probability than all incorrect answers.</p>
<table class="ltx_equation ltx_eqn_table" id="S3.Ex6">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\text{MC2}=\frac{1}{|\mathcal{D}|}\sum_{(q,\mathbf{a},\mathbf{\bar{a}})\in%
\mathcal{D}}\frac{1}{|\mathbf{a}|}\sum_{a\in\mathbf{a}}\prod_{\bar{a}\in%
\mathbf{\bar{a}}}\mathbf{1}\Big{(}p_{M}\big{(}a\mid q,R(q)\big{)}&gt;p_{M}\big{(}%
\bar{a}\mid q,R(q)\big{)}\Big{)}" class="ltx_Math" display="block" id="S3.Ex6.m1.10"><semantics id="S3.Ex6.m1.10a"><mrow id="S3.Ex6.m1.10.10" xref="S3.Ex6.m1.10.10.cmml"><mtext id="S3.Ex6.m1.10.10.3" xref="S3.Ex6.m1.10.10.3a.cmml">MC2</mtext><mo id="S3.Ex6.m1.10.10.2" xref="S3.Ex6.m1.10.10.2.cmml">=</mo><mrow id="S3.Ex6.m1.10.10.1" xref="S3.Ex6.m1.10.10.1.cmml"><mfrac id="S3.Ex6.m1.1.1" xref="S3.Ex6.m1.1.1.cmml"><mn id="S3.Ex6.m1.1.1.3" xref="S3.Ex6.m1.1.1.3.cmml">1</mn><mrow id="S3.Ex6.m1.1.1.1.3" xref="S3.Ex6.m1.1.1.1.2.cmml"><mo id="S3.Ex6.m1.1.1.1.3.1" stretchy="false" xref="S3.Ex6.m1.1.1.1.2.1.cmml">|</mo><mi class="ltx_font_mathcaligraphic" id="S3.Ex6.m1.1.1.1.1" xref="S3.Ex6.m1.1.1.1.1.cmml">𝒟</mi><mo id="S3.Ex6.m1.1.1.1.3.2" stretchy="false" xref="S3.Ex6.m1.1.1.1.2.1.cmml">|</mo></mrow></mfrac><mo id="S3.Ex6.m1.10.10.1.2" xref="S3.Ex6.m1.10.10.1.2.cmml">⁢</mo><mrow id="S3.Ex6.m1.10.10.1.1" xref="S3.Ex6.m1.10.10.1.1.cmml"><munder id="S3.Ex6.m1.10.10.1.1.2" xref="S3.Ex6.m1.10.10.1.1.2.cmml"><mo id="S3.Ex6.m1.10.10.1.1.2.2" movablelimits="false" xref="S3.Ex6.m1.10.10.1.1.2.2.cmml">∑</mo><mrow id="S3.Ex6.m1.4.4.3" xref="S3.Ex6.m1.4.4.3.cmml"><mrow id="S3.Ex6.m1.4.4.3.5.2" xref="S3.Ex6.m1.4.4.3.5.1.cmml"><mo id="S3.Ex6.m1.4.4.3.5.2.1" stretchy="false" xref="S3.Ex6.m1.4.4.3.5.1.cmml">(</mo><mi id="S3.Ex6.m1.2.2.1.1" xref="S3.Ex6.m1.2.2.1.1.cmml">q</mi><mo id="S3.Ex6.m1.4.4.3.5.2.2" xref="S3.Ex6.m1.4.4.3.5.1.cmml">,</mo><mi id="S3.Ex6.m1.3.3.2.2" xref="S3.Ex6.m1.3.3.2.2.cmml">𝐚</mi><mo id="S3.Ex6.m1.4.4.3.5.2.3" xref="S3.Ex6.m1.4.4.3.5.1.cmml">,</mo><mover accent="true" id="S3.Ex6.m1.4.4.3.3" xref="S3.Ex6.m1.4.4.3.3.cmml"><mi id="S3.Ex6.m1.4.4.3.3.2" xref="S3.Ex6.m1.4.4.3.3.2.cmml">𝐚</mi><mo id="S3.Ex6.m1.4.4.3.3.1" xref="S3.Ex6.m1.4.4.3.3.1.cmml">¯</mo></mover><mo id="S3.Ex6.m1.4.4.3.5.2.4" stretchy="false" xref="S3.Ex6.m1.4.4.3.5.1.cmml">)</mo></mrow><mo id="S3.Ex6.m1.4.4.3.4" xref="S3.Ex6.m1.4.4.3.4.cmml">∈</mo><mi class="ltx_font_mathcaligraphic" id="S3.Ex6.m1.4.4.3.6" xref="S3.Ex6.m1.4.4.3.6.cmml">𝒟</mi></mrow></munder><mrow id="S3.Ex6.m1.10.10.1.1.1" xref="S3.Ex6.m1.10.10.1.1.1.cmml"><mfrac id="S3.Ex6.m1.5.5" xref="S3.Ex6.m1.5.5.cmml"><mn id="S3.Ex6.m1.5.5.3" xref="S3.Ex6.m1.5.5.3.cmml">1</mn><mrow id="S3.Ex6.m1.5.5.1.3" xref="S3.Ex6.m1.5.5.1.2.cmml"><mo id="S3.Ex6.m1.5.5.1.3.1" stretchy="false" xref="S3.Ex6.m1.5.5.1.2.1.cmml">|</mo><mi id="S3.Ex6.m1.5.5.1.1" xref="S3.Ex6.m1.5.5.1.1.cmml">𝐚</mi><mo id="S3.Ex6.m1.5.5.1.3.2" stretchy="false" xref="S3.Ex6.m1.5.5.1.2.1.cmml">|</mo></mrow></mfrac><mo id="S3.Ex6.m1.10.10.1.1.1.2" xref="S3.Ex6.m1.10.10.1.1.1.2.cmml">⁢</mo><mrow id="S3.Ex6.m1.10.10.1.1.1.1" xref="S3.Ex6.m1.10.10.1.1.1.1.cmml"><munder id="S3.Ex6.m1.10.10.1.1.1.1.2" xref="S3.Ex6.m1.10.10.1.1.1.1.2.cmml"><mo id="S3.Ex6.m1.10.10.1.1.1.1.2.2" movablelimits="false" rspace="0em" xref="S3.Ex6.m1.10.10.1.1.1.1.2.2.cmml">∑</mo><mrow id="S3.Ex6.m1.10.10.1.1.1.1.2.3" xref="S3.Ex6.m1.10.10.1.1.1.1.2.3.cmml"><mi id="S3.Ex6.m1.10.10.1.1.1.1.2.3.2" xref="S3.Ex6.m1.10.10.1.1.1.1.2.3.2.cmml">a</mi><mo id="S3.Ex6.m1.10.10.1.1.1.1.2.3.1" xref="S3.Ex6.m1.10.10.1.1.1.1.2.3.1.cmml">∈</mo><mi id="S3.Ex6.m1.10.10.1.1.1.1.2.3.3" xref="S3.Ex6.m1.10.10.1.1.1.1.2.3.3.cmml">𝐚</mi></mrow></munder><mrow id="S3.Ex6.m1.10.10.1.1.1.1.1" xref="S3.Ex6.m1.10.10.1.1.1.1.1.cmml"><munder id="S3.Ex6.m1.10.10.1.1.1.1.1.2" xref="S3.Ex6.m1.10.10.1.1.1.1.1.2.cmml"><mo id="S3.Ex6.m1.10.10.1.1.1.1.1.2.2" movablelimits="false" xref="S3.Ex6.m1.10.10.1.1.1.1.1.2.2.cmml">∏</mo><mrow id="S3.Ex6.m1.10.10.1.1.1.1.1.2.3" xref="S3.Ex6.m1.10.10.1.1.1.1.1.2.3.cmml"><mover accent="true" id="S3.Ex6.m1.10.10.1.1.1.1.1.2.3.2" xref="S3.Ex6.m1.10.10.1.1.1.1.1.2.3.2.cmml"><mi id="S3.Ex6.m1.10.10.1.1.1.1.1.2.3.2.2" xref="S3.Ex6.m1.10.10.1.1.1.1.1.2.3.2.2.cmml">a</mi><mo id="S3.Ex6.m1.10.10.1.1.1.1.1.2.3.2.1" xref="S3.Ex6.m1.10.10.1.1.1.1.1.2.3.2.1.cmml">¯</mo></mover><mo id="S3.Ex6.m1.10.10.1.1.1.1.1.2.3.1" xref="S3.Ex6.m1.10.10.1.1.1.1.1.2.3.1.cmml">∈</mo><mover accent="true" id="S3.Ex6.m1.10.10.1.1.1.1.1.2.3.3" xref="S3.Ex6.m1.10.10.1.1.1.1.1.2.3.3.cmml"><mi id="S3.Ex6.m1.10.10.1.1.1.1.1.2.3.3.2" xref="S3.Ex6.m1.10.10.1.1.1.1.1.2.3.3.2.cmml">𝐚</mi><mo id="S3.Ex6.m1.10.10.1.1.1.1.1.2.3.3.1" xref="S3.Ex6.m1.10.10.1.1.1.1.1.2.3.3.1.cmml">¯</mo></mover></mrow></munder><mrow id="S3.Ex6.m1.10.10.1.1.1.1.1.1" xref="S3.Ex6.m1.10.10.1.1.1.1.1.1.cmml"><mn id="S3.Ex6.m1.10.10.1.1.1.1.1.1.3" xref="S3.Ex6.m1.10.10.1.1.1.1.1.1.3.cmml">𝟏</mn><mo id="S3.Ex6.m1.10.10.1.1.1.1.1.1.2" xref="S3.Ex6.m1.10.10.1.1.1.1.1.1.2.cmml">⁢</mo><mrow id="S3.Ex6.m1.10.10.1.1.1.1.1.1.1.1" xref="S3.Ex6.m1.10.10.1.1.1.1.1.1.1.1.1.cmml"><mo id="S3.Ex6.m1.10.10.1.1.1.1.1.1.1.1.2" maxsize="160%" minsize="160%" xref="S3.Ex6.m1.10.10.1.1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="S3.Ex6.m1.10.10.1.1.1.1.1.1.1.1.1" xref="S3.Ex6.m1.10.10.1.1.1.1.1.1.1.1.1.cmml"><mrow id="S3.Ex6.m1.10.10.1.1.1.1.1.1.1.1.1.1" xref="S3.Ex6.m1.10.10.1.1.1.1.1.1.1.1.1.1.cmml"><msub id="S3.Ex6.m1.10.10.1.1.1.1.1.1.1.1.1.1.3" xref="S3.Ex6.m1.10.10.1.1.1.1.1.1.1.1.1.1.3.cmml"><mi id="S3.Ex6.m1.10.10.1.1.1.1.1.1.1.1.1.1.3.2" xref="S3.Ex6.m1.10.10.1.1.1.1.1.1.1.1.1.1.3.2.cmml">p</mi><mi id="S3.Ex6.m1.10.10.1.1.1.1.1.1.1.1.1.1.3.3" xref="S3.Ex6.m1.10.10.1.1.1.1.1.1.1.1.1.1.3.3.cmml">M</mi></msub><mo id="S3.Ex6.m1.10.10.1.1.1.1.1.1.1.1.1.1.2" xref="S3.Ex6.m1.10.10.1.1.1.1.1.1.1.1.1.1.2.cmml">⁢</mo><mrow id="S3.Ex6.m1.10.10.1.1.1.1.1.1.1.1.1.1.1.1" xref="S3.Ex6.m1.10.10.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml"><mo id="S3.Ex6.m1.10.10.1.1.1.1.1.1.1.1.1.1.1.1.2" maxsize="120%" minsize="120%" xref="S3.Ex6.m1.10.10.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="S3.Ex6.m1.10.10.1.1.1.1.1.1.1.1.1.1.1.1.1" xref="S3.Ex6.m1.10.10.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml"><mi id="S3.Ex6.m1.10.10.1.1.1.1.1.1.1.1.1.1.1.1.1.3" xref="S3.Ex6.m1.10.10.1.1.1.1.1.1.1.1.1.1.1.1.1.3.cmml">a</mi><mo id="S3.Ex6.m1.10.10.1.1.1.1.1.1.1.1.1.1.1.1.1.2" xref="S3.Ex6.m1.10.10.1.1.1.1.1.1.1.1.1.1.1.1.1.2.cmml">∣</mo><mrow id="S3.Ex6.m1.10.10.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1" xref="S3.Ex6.m1.10.10.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.cmml"><mi id="S3.Ex6.m1.7.7" xref="S3.Ex6.m1.7.7.cmml">q</mi><mo id="S3.Ex6.m1.10.10.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2" xref="S3.Ex6.m1.10.10.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.cmml">,</mo><mrow id="S3.Ex6.m1.10.10.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1" xref="S3.Ex6.m1.10.10.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml"><mi id="S3.Ex6.m1.10.10.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2" xref="S3.Ex6.m1.10.10.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.cmml">R</mi><mo id="S3.Ex6.m1.10.10.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1" xref="S3.Ex6.m1.10.10.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml">⁢</mo><mrow id="S3.Ex6.m1.10.10.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.2" xref="S3.Ex6.m1.10.10.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml"><mo id="S3.Ex6.m1.10.10.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.2.1" stretchy="false" xref="S3.Ex6.m1.10.10.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml">(</mo><mi id="S3.Ex6.m1.6.6" xref="S3.Ex6.m1.6.6.cmml">q</mi><mo id="S3.Ex6.m1.10.10.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.2.2" stretchy="false" xref="S3.Ex6.m1.10.10.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow></mrow><mo id="S3.Ex6.m1.10.10.1.1.1.1.1.1.1.1.1.1.1.1.3" maxsize="120%" minsize="120%" xref="S3.Ex6.m1.10.10.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S3.Ex6.m1.10.10.1.1.1.1.1.1.1.1.1.3" xref="S3.Ex6.m1.10.10.1.1.1.1.1.1.1.1.1.3.cmml">&gt;</mo><mrow id="S3.Ex6.m1.10.10.1.1.1.1.1.1.1.1.1.2" xref="S3.Ex6.m1.10.10.1.1.1.1.1.1.1.1.1.2.cmml"><msub id="S3.Ex6.m1.10.10.1.1.1.1.1.1.1.1.1.2.3" xref="S3.Ex6.m1.10.10.1.1.1.1.1.1.1.1.1.2.3.cmml"><mi id="S3.Ex6.m1.10.10.1.1.1.1.1.1.1.1.1.2.3.2" xref="S3.Ex6.m1.10.10.1.1.1.1.1.1.1.1.1.2.3.2.cmml">p</mi><mi id="S3.Ex6.m1.10.10.1.1.1.1.1.1.1.1.1.2.3.3" xref="S3.Ex6.m1.10.10.1.1.1.1.1.1.1.1.1.2.3.3.cmml">M</mi></msub><mo id="S3.Ex6.m1.10.10.1.1.1.1.1.1.1.1.1.2.2" xref="S3.Ex6.m1.10.10.1.1.1.1.1.1.1.1.1.2.2.cmml">⁢</mo><mrow id="S3.Ex6.m1.10.10.1.1.1.1.1.1.1.1.1.2.1.1" xref="S3.Ex6.m1.10.10.1.1.1.1.1.1.1.1.1.2.1.1.1.cmml"><mo id="S3.Ex6.m1.10.10.1.1.1.1.1.1.1.1.1.2.1.1.2" maxsize="120%" minsize="120%" xref="S3.Ex6.m1.10.10.1.1.1.1.1.1.1.1.1.2.1.1.1.cmml">(</mo><mrow id="S3.Ex6.m1.10.10.1.1.1.1.1.1.1.1.1.2.1.1.1" xref="S3.Ex6.m1.10.10.1.1.1.1.1.1.1.1.1.2.1.1.1.cmml"><mover accent="true" id="S3.Ex6.m1.10.10.1.1.1.1.1.1.1.1.1.2.1.1.1.3" xref="S3.Ex6.m1.10.10.1.1.1.1.1.1.1.1.1.2.1.1.1.3.cmml"><mi id="S3.Ex6.m1.10.10.1.1.1.1.1.1.1.1.1.2.1.1.1.3.2" xref="S3.Ex6.m1.10.10.1.1.1.1.1.1.1.1.1.2.1.1.1.3.2.cmml">a</mi><mo id="S3.Ex6.m1.10.10.1.1.1.1.1.1.1.1.1.2.1.1.1.3.1" xref="S3.Ex6.m1.10.10.1.1.1.1.1.1.1.1.1.2.1.1.1.3.1.cmml">¯</mo></mover><mo id="S3.Ex6.m1.10.10.1.1.1.1.1.1.1.1.1.2.1.1.1.2" xref="S3.Ex6.m1.10.10.1.1.1.1.1.1.1.1.1.2.1.1.1.2.cmml">∣</mo><mrow id="S3.Ex6.m1.10.10.1.1.1.1.1.1.1.1.1.2.1.1.1.1.1" xref="S3.Ex6.m1.10.10.1.1.1.1.1.1.1.1.1.2.1.1.1.1.2.cmml"><mi id="S3.Ex6.m1.9.9" xref="S3.Ex6.m1.9.9.cmml">q</mi><mo id="S3.Ex6.m1.10.10.1.1.1.1.1.1.1.1.1.2.1.1.1.1.1.2" xref="S3.Ex6.m1.10.10.1.1.1.1.1.1.1.1.1.2.1.1.1.1.2.cmml">,</mo><mrow id="S3.Ex6.m1.10.10.1.1.1.1.1.1.1.1.1.2.1.1.1.1.1.1" xref="S3.Ex6.m1.10.10.1.1.1.1.1.1.1.1.1.2.1.1.1.1.1.1.cmml"><mi id="S3.Ex6.m1.10.10.1.1.1.1.1.1.1.1.1.2.1.1.1.1.1.1.2" xref="S3.Ex6.m1.10.10.1.1.1.1.1.1.1.1.1.2.1.1.1.1.1.1.2.cmml">R</mi><mo id="S3.Ex6.m1.10.10.1.1.1.1.1.1.1.1.1.2.1.1.1.1.1.1.1" xref="S3.Ex6.m1.10.10.1.1.1.1.1.1.1.1.1.2.1.1.1.1.1.1.1.cmml">⁢</mo><mrow id="S3.Ex6.m1.10.10.1.1.1.1.1.1.1.1.1.2.1.1.1.1.1.1.3.2" xref="S3.Ex6.m1.10.10.1.1.1.1.1.1.1.1.1.2.1.1.1.1.1.1.cmml"><mo id="S3.Ex6.m1.10.10.1.1.1.1.1.1.1.1.1.2.1.1.1.1.1.1.3.2.1" stretchy="false" xref="S3.Ex6.m1.10.10.1.1.1.1.1.1.1.1.1.2.1.1.1.1.1.1.cmml">(</mo><mi id="S3.Ex6.m1.8.8" xref="S3.Ex6.m1.8.8.cmml">q</mi><mo id="S3.Ex6.m1.10.10.1.1.1.1.1.1.1.1.1.2.1.1.1.1.1.1.3.2.2" stretchy="false" xref="S3.Ex6.m1.10.10.1.1.1.1.1.1.1.1.1.2.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow></mrow><mo id="S3.Ex6.m1.10.10.1.1.1.1.1.1.1.1.1.2.1.1.3" maxsize="120%" minsize="120%" xref="S3.Ex6.m1.10.10.1.1.1.1.1.1.1.1.1.2.1.1.1.cmml">)</mo></mrow></mrow></mrow><mo id="S3.Ex6.m1.10.10.1.1.1.1.1.1.1.1.3" maxsize="160%" minsize="160%" xref="S3.Ex6.m1.10.10.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow></mrow></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.Ex6.m1.10b"><apply id="S3.Ex6.m1.10.10.cmml" xref="S3.Ex6.m1.10.10"><eq id="S3.Ex6.m1.10.10.2.cmml" xref="S3.Ex6.m1.10.10.2"></eq><ci id="S3.Ex6.m1.10.10.3a.cmml" xref="S3.Ex6.m1.10.10.3"><mtext id="S3.Ex6.m1.10.10.3.cmml" xref="S3.Ex6.m1.10.10.3">MC2</mtext></ci><apply id="S3.Ex6.m1.10.10.1.cmml" xref="S3.Ex6.m1.10.10.1"><times id="S3.Ex6.m1.10.10.1.2.cmml" xref="S3.Ex6.m1.10.10.1.2"></times><apply id="S3.Ex6.m1.1.1.cmml" xref="S3.Ex6.m1.1.1"><divide id="S3.Ex6.m1.1.1.2.cmml" xref="S3.Ex6.m1.1.1"></divide><cn id="S3.Ex6.m1.1.1.3.cmml" type="integer" xref="S3.Ex6.m1.1.1.3">1</cn><apply id="S3.Ex6.m1.1.1.1.2.cmml" xref="S3.Ex6.m1.1.1.1.3"><abs id="S3.Ex6.m1.1.1.1.2.1.cmml" xref="S3.Ex6.m1.1.1.1.3.1"></abs><ci id="S3.Ex6.m1.1.1.1.1.cmml" xref="S3.Ex6.m1.1.1.1.1">𝒟</ci></apply></apply><apply id="S3.Ex6.m1.10.10.1.1.cmml" xref="S3.Ex6.m1.10.10.1.1"><apply id="S3.Ex6.m1.10.10.1.1.2.cmml" xref="S3.Ex6.m1.10.10.1.1.2"><csymbol cd="ambiguous" id="S3.Ex6.m1.10.10.1.1.2.1.cmml" xref="S3.Ex6.m1.10.10.1.1.2">subscript</csymbol><sum id="S3.Ex6.m1.10.10.1.1.2.2.cmml" xref="S3.Ex6.m1.10.10.1.1.2.2"></sum><apply id="S3.Ex6.m1.4.4.3.cmml" xref="S3.Ex6.m1.4.4.3"><in id="S3.Ex6.m1.4.4.3.4.cmml" xref="S3.Ex6.m1.4.4.3.4"></in><vector id="S3.Ex6.m1.4.4.3.5.1.cmml" xref="S3.Ex6.m1.4.4.3.5.2"><ci id="S3.Ex6.m1.2.2.1.1.cmml" xref="S3.Ex6.m1.2.2.1.1">𝑞</ci><ci id="S3.Ex6.m1.3.3.2.2.cmml" xref="S3.Ex6.m1.3.3.2.2">𝐚</ci><apply id="S3.Ex6.m1.4.4.3.3.cmml" xref="S3.Ex6.m1.4.4.3.3"><ci id="S3.Ex6.m1.4.4.3.3.1.cmml" xref="S3.Ex6.m1.4.4.3.3.1">¯</ci><ci id="S3.Ex6.m1.4.4.3.3.2.cmml" xref="S3.Ex6.m1.4.4.3.3.2">𝐚</ci></apply></vector><ci id="S3.Ex6.m1.4.4.3.6.cmml" xref="S3.Ex6.m1.4.4.3.6">𝒟</ci></apply></apply><apply id="S3.Ex6.m1.10.10.1.1.1.cmml" xref="S3.Ex6.m1.10.10.1.1.1"><times id="S3.Ex6.m1.10.10.1.1.1.2.cmml" xref="S3.Ex6.m1.10.10.1.1.1.2"></times><apply id="S3.Ex6.m1.5.5.cmml" xref="S3.Ex6.m1.5.5"><divide id="S3.Ex6.m1.5.5.2.cmml" xref="S3.Ex6.m1.5.5"></divide><cn id="S3.Ex6.m1.5.5.3.cmml" type="integer" xref="S3.Ex6.m1.5.5.3">1</cn><apply id="S3.Ex6.m1.5.5.1.2.cmml" xref="S3.Ex6.m1.5.5.1.3"><abs id="S3.Ex6.m1.5.5.1.2.1.cmml" xref="S3.Ex6.m1.5.5.1.3.1"></abs><ci id="S3.Ex6.m1.5.5.1.1.cmml" xref="S3.Ex6.m1.5.5.1.1">𝐚</ci></apply></apply><apply id="S3.Ex6.m1.10.10.1.1.1.1.cmml" xref="S3.Ex6.m1.10.10.1.1.1.1"><apply id="S3.Ex6.m1.10.10.1.1.1.1.2.cmml" xref="S3.Ex6.m1.10.10.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.Ex6.m1.10.10.1.1.1.1.2.1.cmml" xref="S3.Ex6.m1.10.10.1.1.1.1.2">subscript</csymbol><sum id="S3.Ex6.m1.10.10.1.1.1.1.2.2.cmml" xref="S3.Ex6.m1.10.10.1.1.1.1.2.2"></sum><apply id="S3.Ex6.m1.10.10.1.1.1.1.2.3.cmml" xref="S3.Ex6.m1.10.10.1.1.1.1.2.3"><in id="S3.Ex6.m1.10.10.1.1.1.1.2.3.1.cmml" xref="S3.Ex6.m1.10.10.1.1.1.1.2.3.1"></in><ci id="S3.Ex6.m1.10.10.1.1.1.1.2.3.2.cmml" xref="S3.Ex6.m1.10.10.1.1.1.1.2.3.2">𝑎</ci><ci id="S3.Ex6.m1.10.10.1.1.1.1.2.3.3.cmml" xref="S3.Ex6.m1.10.10.1.1.1.1.2.3.3">𝐚</ci></apply></apply><apply id="S3.Ex6.m1.10.10.1.1.1.1.1.cmml" xref="S3.Ex6.m1.10.10.1.1.1.1.1"><apply id="S3.Ex6.m1.10.10.1.1.1.1.1.2.cmml" xref="S3.Ex6.m1.10.10.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.Ex6.m1.10.10.1.1.1.1.1.2.1.cmml" xref="S3.Ex6.m1.10.10.1.1.1.1.1.2">subscript</csymbol><csymbol cd="latexml" id="S3.Ex6.m1.10.10.1.1.1.1.1.2.2.cmml" xref="S3.Ex6.m1.10.10.1.1.1.1.1.2.2">product</csymbol><apply id="S3.Ex6.m1.10.10.1.1.1.1.1.2.3.cmml" xref="S3.Ex6.m1.10.10.1.1.1.1.1.2.3"><in id="S3.Ex6.m1.10.10.1.1.1.1.1.2.3.1.cmml" xref="S3.Ex6.m1.10.10.1.1.1.1.1.2.3.1"></in><apply id="S3.Ex6.m1.10.10.1.1.1.1.1.2.3.2.cmml" xref="S3.Ex6.m1.10.10.1.1.1.1.1.2.3.2"><ci id="S3.Ex6.m1.10.10.1.1.1.1.1.2.3.2.1.cmml" xref="S3.Ex6.m1.10.10.1.1.1.1.1.2.3.2.1">¯</ci><ci id="S3.Ex6.m1.10.10.1.1.1.1.1.2.3.2.2.cmml" xref="S3.Ex6.m1.10.10.1.1.1.1.1.2.3.2.2">𝑎</ci></apply><apply id="S3.Ex6.m1.10.10.1.1.1.1.1.2.3.3.cmml" xref="S3.Ex6.m1.10.10.1.1.1.1.1.2.3.3"><ci id="S3.Ex6.m1.10.10.1.1.1.1.1.2.3.3.1.cmml" xref="S3.Ex6.m1.10.10.1.1.1.1.1.2.3.3.1">¯</ci><ci id="S3.Ex6.m1.10.10.1.1.1.1.1.2.3.3.2.cmml" xref="S3.Ex6.m1.10.10.1.1.1.1.1.2.3.3.2">𝐚</ci></apply></apply></apply><apply id="S3.Ex6.m1.10.10.1.1.1.1.1.1.cmml" xref="S3.Ex6.m1.10.10.1.1.1.1.1.1"><times id="S3.Ex6.m1.10.10.1.1.1.1.1.1.2.cmml" xref="S3.Ex6.m1.10.10.1.1.1.1.1.1.2"></times><cn id="S3.Ex6.m1.10.10.1.1.1.1.1.1.3.cmml" type="integer" xref="S3.Ex6.m1.10.10.1.1.1.1.1.1.3">1</cn><apply id="S3.Ex6.m1.10.10.1.1.1.1.1.1.1.1.1.cmml" xref="S3.Ex6.m1.10.10.1.1.1.1.1.1.1.1"><gt id="S3.Ex6.m1.10.10.1.1.1.1.1.1.1.1.1.3.cmml" xref="S3.Ex6.m1.10.10.1.1.1.1.1.1.1.1.1.3"></gt><apply id="S3.Ex6.m1.10.10.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.Ex6.m1.10.10.1.1.1.1.1.1.1.1.1.1"><times id="S3.Ex6.m1.10.10.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S3.Ex6.m1.10.10.1.1.1.1.1.1.1.1.1.1.2"></times><apply id="S3.Ex6.m1.10.10.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="S3.Ex6.m1.10.10.1.1.1.1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.Ex6.m1.10.10.1.1.1.1.1.1.1.1.1.1.3.1.cmml" xref="S3.Ex6.m1.10.10.1.1.1.1.1.1.1.1.1.1.3">subscript</csymbol><ci id="S3.Ex6.m1.10.10.1.1.1.1.1.1.1.1.1.1.3.2.cmml" xref="S3.Ex6.m1.10.10.1.1.1.1.1.1.1.1.1.1.3.2">𝑝</ci><ci id="S3.Ex6.m1.10.10.1.1.1.1.1.1.1.1.1.1.3.3.cmml" xref="S3.Ex6.m1.10.10.1.1.1.1.1.1.1.1.1.1.3.3">𝑀</ci></apply><apply id="S3.Ex6.m1.10.10.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.Ex6.m1.10.10.1.1.1.1.1.1.1.1.1.1.1.1"><csymbol cd="latexml" id="S3.Ex6.m1.10.10.1.1.1.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S3.Ex6.m1.10.10.1.1.1.1.1.1.1.1.1.1.1.1.1.2">conditional</csymbol><ci id="S3.Ex6.m1.10.10.1.1.1.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="S3.Ex6.m1.10.10.1.1.1.1.1.1.1.1.1.1.1.1.1.3">𝑎</ci><list id="S3.Ex6.m1.10.10.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S3.Ex6.m1.10.10.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1"><ci id="S3.Ex6.m1.7.7.cmml" xref="S3.Ex6.m1.7.7">𝑞</ci><apply id="S3.Ex6.m1.10.10.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.Ex6.m1.10.10.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1"><times id="S3.Ex6.m1.10.10.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.Ex6.m1.10.10.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1"></times><ci id="S3.Ex6.m1.10.10.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S3.Ex6.m1.10.10.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2">𝑅</ci><ci id="S3.Ex6.m1.6.6.cmml" xref="S3.Ex6.m1.6.6">𝑞</ci></apply></list></apply></apply><apply id="S3.Ex6.m1.10.10.1.1.1.1.1.1.1.1.1.2.cmml" xref="S3.Ex6.m1.10.10.1.1.1.1.1.1.1.1.1.2"><times id="S3.Ex6.m1.10.10.1.1.1.1.1.1.1.1.1.2.2.cmml" xref="S3.Ex6.m1.10.10.1.1.1.1.1.1.1.1.1.2.2"></times><apply id="S3.Ex6.m1.10.10.1.1.1.1.1.1.1.1.1.2.3.cmml" xref="S3.Ex6.m1.10.10.1.1.1.1.1.1.1.1.1.2.3"><csymbol cd="ambiguous" id="S3.Ex6.m1.10.10.1.1.1.1.1.1.1.1.1.2.3.1.cmml" xref="S3.Ex6.m1.10.10.1.1.1.1.1.1.1.1.1.2.3">subscript</csymbol><ci id="S3.Ex6.m1.10.10.1.1.1.1.1.1.1.1.1.2.3.2.cmml" xref="S3.Ex6.m1.10.10.1.1.1.1.1.1.1.1.1.2.3.2">𝑝</ci><ci id="S3.Ex6.m1.10.10.1.1.1.1.1.1.1.1.1.2.3.3.cmml" xref="S3.Ex6.m1.10.10.1.1.1.1.1.1.1.1.1.2.3.3">𝑀</ci></apply><apply id="S3.Ex6.m1.10.10.1.1.1.1.1.1.1.1.1.2.1.1.1.cmml" xref="S3.Ex6.m1.10.10.1.1.1.1.1.1.1.1.1.2.1.1"><csymbol cd="latexml" id="S3.Ex6.m1.10.10.1.1.1.1.1.1.1.1.1.2.1.1.1.2.cmml" xref="S3.Ex6.m1.10.10.1.1.1.1.1.1.1.1.1.2.1.1.1.2">conditional</csymbol><apply id="S3.Ex6.m1.10.10.1.1.1.1.1.1.1.1.1.2.1.1.1.3.cmml" xref="S3.Ex6.m1.10.10.1.1.1.1.1.1.1.1.1.2.1.1.1.3"><ci id="S3.Ex6.m1.10.10.1.1.1.1.1.1.1.1.1.2.1.1.1.3.1.cmml" xref="S3.Ex6.m1.10.10.1.1.1.1.1.1.1.1.1.2.1.1.1.3.1">¯</ci><ci id="S3.Ex6.m1.10.10.1.1.1.1.1.1.1.1.1.2.1.1.1.3.2.cmml" xref="S3.Ex6.m1.10.10.1.1.1.1.1.1.1.1.1.2.1.1.1.3.2">𝑎</ci></apply><list id="S3.Ex6.m1.10.10.1.1.1.1.1.1.1.1.1.2.1.1.1.1.2.cmml" xref="S3.Ex6.m1.10.10.1.1.1.1.1.1.1.1.1.2.1.1.1.1.1"><ci id="S3.Ex6.m1.9.9.cmml" xref="S3.Ex6.m1.9.9">𝑞</ci><apply id="S3.Ex6.m1.10.10.1.1.1.1.1.1.1.1.1.2.1.1.1.1.1.1.cmml" xref="S3.Ex6.m1.10.10.1.1.1.1.1.1.1.1.1.2.1.1.1.1.1.1"><times id="S3.Ex6.m1.10.10.1.1.1.1.1.1.1.1.1.2.1.1.1.1.1.1.1.cmml" xref="S3.Ex6.m1.10.10.1.1.1.1.1.1.1.1.1.2.1.1.1.1.1.1.1"></times><ci id="S3.Ex6.m1.10.10.1.1.1.1.1.1.1.1.1.2.1.1.1.1.1.1.2.cmml" xref="S3.Ex6.m1.10.10.1.1.1.1.1.1.1.1.1.2.1.1.1.1.1.1.2">𝑅</ci><ci id="S3.Ex6.m1.8.8.cmml" xref="S3.Ex6.m1.8.8">𝑞</ci></apply></list></apply></apply></apply></apply></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.Ex6.m1.10c">\text{MC2}=\frac{1}{|\mathcal{D}|}\sum_{(q,\mathbf{a},\mathbf{\bar{a}})\in%
\mathcal{D}}\frac{1}{|\mathbf{a}|}\sum_{a\in\mathbf{a}}\prod_{\bar{a}\in%
\mathbf{\bar{a}}}\mathbf{1}\Big{(}p_{M}\big{(}a\mid q,R(q)\big{)}&gt;p_{M}\big{(}%
\bar{a}\mid q,R(q)\big{)}\Big{)}</annotation><annotation encoding="application/x-llamapun" id="S3.Ex6.m1.10d">MC2 = divide start_ARG 1 end_ARG start_ARG | caligraphic_D | end_ARG ∑ start_POSTSUBSCRIPT ( italic_q , bold_a , over¯ start_ARG bold_a end_ARG ) ∈ caligraphic_D end_POSTSUBSCRIPT divide start_ARG 1 end_ARG start_ARG | bold_a | end_ARG ∑ start_POSTSUBSCRIPT italic_a ∈ bold_a end_POSTSUBSCRIPT ∏ start_POSTSUBSCRIPT over¯ start_ARG italic_a end_ARG ∈ over¯ start_ARG bold_a end_ARG end_POSTSUBSCRIPT bold_1 ( italic_p start_POSTSUBSCRIPT italic_M end_POSTSUBSCRIPT ( italic_a ∣ italic_q , italic_R ( italic_q ) ) &gt; italic_p start_POSTSUBSCRIPT italic_M end_POSTSUBSCRIPT ( over¯ start_ARG italic_a end_ARG ∣ italic_q , italic_R ( italic_q ) ) )</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
</div>
<div class="ltx_para" id="S3.SS2.SSS1.p6">
<p class="ltx_p" id="S3.SS2.SSS1.p6.1">Finally, we define the related metric MC3. This metric is the ratio of probability of correct answers to the probability of incorrect answers.</p>
<table class="ltx_equation ltx_eqn_table" id="S3.Ex7">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\text{MC3}=\frac{1}{|\mathcal{D}|}\sum_{(q,\mathbf{a},\mathbf{\bar{a}})\in%
\mathcal{D}}\frac{\sum_{a\in\mathbf{a}}p_{M}\big{(}a\mid q,R(q)\big{)}}{\sum_{%
\bar{a}\in\mathbf{\bar{a}}}p_{M}\big{(}\bar{a}\mid q,R(q)\big{)}}" class="ltx_Math" display="block" id="S3.Ex7.m1.10"><semantics id="S3.Ex7.m1.10a"><mrow id="S3.Ex7.m1.10.11" xref="S3.Ex7.m1.10.11.cmml"><mtext id="S3.Ex7.m1.10.11.2" xref="S3.Ex7.m1.10.11.2a.cmml">MC3</mtext><mo id="S3.Ex7.m1.10.11.1" xref="S3.Ex7.m1.10.11.1.cmml">=</mo><mrow id="S3.Ex7.m1.10.11.3" xref="S3.Ex7.m1.10.11.3.cmml"><mfrac id="S3.Ex7.m1.1.1" xref="S3.Ex7.m1.1.1.cmml"><mn id="S3.Ex7.m1.1.1.3" xref="S3.Ex7.m1.1.1.3.cmml">1</mn><mrow id="S3.Ex7.m1.1.1.1.3" xref="S3.Ex7.m1.1.1.1.2.cmml"><mo id="S3.Ex7.m1.1.1.1.3.1" stretchy="false" xref="S3.Ex7.m1.1.1.1.2.1.cmml">|</mo><mi class="ltx_font_mathcaligraphic" id="S3.Ex7.m1.1.1.1.1" xref="S3.Ex7.m1.1.1.1.1.cmml">𝒟</mi><mo id="S3.Ex7.m1.1.1.1.3.2" stretchy="false" xref="S3.Ex7.m1.1.1.1.2.1.cmml">|</mo></mrow></mfrac><mo id="S3.Ex7.m1.10.11.3.1" xref="S3.Ex7.m1.10.11.3.1.cmml">⁢</mo><mrow id="S3.Ex7.m1.10.11.3.2" xref="S3.Ex7.m1.10.11.3.2.cmml"><munder id="S3.Ex7.m1.10.11.3.2.1" xref="S3.Ex7.m1.10.11.3.2.1.cmml"><mo id="S3.Ex7.m1.10.11.3.2.1.2" movablelimits="false" xref="S3.Ex7.m1.10.11.3.2.1.2.cmml">∑</mo><mrow id="S3.Ex7.m1.4.4.3" xref="S3.Ex7.m1.4.4.3.cmml"><mrow id="S3.Ex7.m1.4.4.3.5.2" xref="S3.Ex7.m1.4.4.3.5.1.cmml"><mo id="S3.Ex7.m1.4.4.3.5.2.1" stretchy="false" xref="S3.Ex7.m1.4.4.3.5.1.cmml">(</mo><mi id="S3.Ex7.m1.2.2.1.1" xref="S3.Ex7.m1.2.2.1.1.cmml">q</mi><mo id="S3.Ex7.m1.4.4.3.5.2.2" xref="S3.Ex7.m1.4.4.3.5.1.cmml">,</mo><mi id="S3.Ex7.m1.3.3.2.2" xref="S3.Ex7.m1.3.3.2.2.cmml">𝐚</mi><mo id="S3.Ex7.m1.4.4.3.5.2.3" xref="S3.Ex7.m1.4.4.3.5.1.cmml">,</mo><mover accent="true" id="S3.Ex7.m1.4.4.3.3" xref="S3.Ex7.m1.4.4.3.3.cmml"><mi id="S3.Ex7.m1.4.4.3.3.2" xref="S3.Ex7.m1.4.4.3.3.2.cmml">𝐚</mi><mo id="S3.Ex7.m1.4.4.3.3.1" xref="S3.Ex7.m1.4.4.3.3.1.cmml">¯</mo></mover><mo id="S3.Ex7.m1.4.4.3.5.2.4" stretchy="false" xref="S3.Ex7.m1.4.4.3.5.1.cmml">)</mo></mrow><mo id="S3.Ex7.m1.4.4.3.4" xref="S3.Ex7.m1.4.4.3.4.cmml">∈</mo><mi class="ltx_font_mathcaligraphic" id="S3.Ex7.m1.4.4.3.6" xref="S3.Ex7.m1.4.4.3.6.cmml">𝒟</mi></mrow></munder><mfrac id="S3.Ex7.m1.10.10" xref="S3.Ex7.m1.10.10.cmml"><mrow id="S3.Ex7.m1.7.7.3" xref="S3.Ex7.m1.7.7.3.cmml"><msub id="S3.Ex7.m1.7.7.3.4" xref="S3.Ex7.m1.7.7.3.4.cmml"><mo id="S3.Ex7.m1.7.7.3.4.2" xref="S3.Ex7.m1.7.7.3.4.2.cmml">∑</mo><mrow id="S3.Ex7.m1.7.7.3.4.3" xref="S3.Ex7.m1.7.7.3.4.3.cmml"><mi id="S3.Ex7.m1.7.7.3.4.3.2" xref="S3.Ex7.m1.7.7.3.4.3.2.cmml">a</mi><mo id="S3.Ex7.m1.7.7.3.4.3.1" xref="S3.Ex7.m1.7.7.3.4.3.1.cmml">∈</mo><mi id="S3.Ex7.m1.7.7.3.4.3.3" xref="S3.Ex7.m1.7.7.3.4.3.3.cmml">𝐚</mi></mrow></msub><mrow id="S3.Ex7.m1.7.7.3.3" xref="S3.Ex7.m1.7.7.3.3.cmml"><msub id="S3.Ex7.m1.7.7.3.3.3" xref="S3.Ex7.m1.7.7.3.3.3.cmml"><mi id="S3.Ex7.m1.7.7.3.3.3.2" xref="S3.Ex7.m1.7.7.3.3.3.2.cmml">p</mi><mi id="S3.Ex7.m1.7.7.3.3.3.3" xref="S3.Ex7.m1.7.7.3.3.3.3.cmml">M</mi></msub><mo id="S3.Ex7.m1.7.7.3.3.2" xref="S3.Ex7.m1.7.7.3.3.2.cmml">⁢</mo><mrow id="S3.Ex7.m1.7.7.3.3.1.1" xref="S3.Ex7.m1.7.7.3.3.1.1.1.cmml"><mo id="S3.Ex7.m1.7.7.3.3.1.1.2" maxsize="120%" minsize="120%" xref="S3.Ex7.m1.7.7.3.3.1.1.1.cmml">(</mo><mrow id="S3.Ex7.m1.7.7.3.3.1.1.1" xref="S3.Ex7.m1.7.7.3.3.1.1.1.cmml"><mi id="S3.Ex7.m1.7.7.3.3.1.1.1.3" xref="S3.Ex7.m1.7.7.3.3.1.1.1.3.cmml">a</mi><mo id="S3.Ex7.m1.7.7.3.3.1.1.1.2" xref="S3.Ex7.m1.7.7.3.3.1.1.1.2.cmml">∣</mo><mrow id="S3.Ex7.m1.7.7.3.3.1.1.1.1.1" xref="S3.Ex7.m1.7.7.3.3.1.1.1.1.2.cmml"><mi id="S3.Ex7.m1.6.6.2.2" xref="S3.Ex7.m1.6.6.2.2.cmml">q</mi><mo id="S3.Ex7.m1.7.7.3.3.1.1.1.1.1.2" xref="S3.Ex7.m1.7.7.3.3.1.1.1.1.2.cmml">,</mo><mrow id="S3.Ex7.m1.7.7.3.3.1.1.1.1.1.1" xref="S3.Ex7.m1.7.7.3.3.1.1.1.1.1.1.cmml"><mi id="S3.Ex7.m1.7.7.3.3.1.1.1.1.1.1.2" xref="S3.Ex7.m1.7.7.3.3.1.1.1.1.1.1.2.cmml">R</mi><mo id="S3.Ex7.m1.7.7.3.3.1.1.1.1.1.1.1" xref="S3.Ex7.m1.7.7.3.3.1.1.1.1.1.1.1.cmml">⁢</mo><mrow id="S3.Ex7.m1.7.7.3.3.1.1.1.1.1.1.3.2" xref="S3.Ex7.m1.7.7.3.3.1.1.1.1.1.1.cmml"><mo id="S3.Ex7.m1.7.7.3.3.1.1.1.1.1.1.3.2.1" stretchy="false" xref="S3.Ex7.m1.7.7.3.3.1.1.1.1.1.1.cmml">(</mo><mi id="S3.Ex7.m1.5.5.1.1" xref="S3.Ex7.m1.5.5.1.1.cmml">q</mi><mo id="S3.Ex7.m1.7.7.3.3.1.1.1.1.1.1.3.2.2" stretchy="false" xref="S3.Ex7.m1.7.7.3.3.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow></mrow><mo id="S3.Ex7.m1.7.7.3.3.1.1.3" maxsize="120%" minsize="120%" xref="S3.Ex7.m1.7.7.3.3.1.1.1.cmml">)</mo></mrow></mrow></mrow><mrow id="S3.Ex7.m1.10.10.6" xref="S3.Ex7.m1.10.10.6.cmml"><msub id="S3.Ex7.m1.10.10.6.4" xref="S3.Ex7.m1.10.10.6.4.cmml"><mo id="S3.Ex7.m1.10.10.6.4.2" xref="S3.Ex7.m1.10.10.6.4.2.cmml">∑</mo><mrow id="S3.Ex7.m1.10.10.6.4.3" xref="S3.Ex7.m1.10.10.6.4.3.cmml"><mover accent="true" id="S3.Ex7.m1.10.10.6.4.3.2" xref="S3.Ex7.m1.10.10.6.4.3.2.cmml"><mi id="S3.Ex7.m1.10.10.6.4.3.2.2" xref="S3.Ex7.m1.10.10.6.4.3.2.2.cmml">a</mi><mo id="S3.Ex7.m1.10.10.6.4.3.2.1" xref="S3.Ex7.m1.10.10.6.4.3.2.1.cmml">¯</mo></mover><mo id="S3.Ex7.m1.10.10.6.4.3.1" xref="S3.Ex7.m1.10.10.6.4.3.1.cmml">∈</mo><mover accent="true" id="S3.Ex7.m1.10.10.6.4.3.3" xref="S3.Ex7.m1.10.10.6.4.3.3.cmml"><mi id="S3.Ex7.m1.10.10.6.4.3.3.2" xref="S3.Ex7.m1.10.10.6.4.3.3.2.cmml">𝐚</mi><mo id="S3.Ex7.m1.10.10.6.4.3.3.1" xref="S3.Ex7.m1.10.10.6.4.3.3.1.cmml">¯</mo></mover></mrow></msub><mrow id="S3.Ex7.m1.10.10.6.3" xref="S3.Ex7.m1.10.10.6.3.cmml"><msub id="S3.Ex7.m1.10.10.6.3.3" xref="S3.Ex7.m1.10.10.6.3.3.cmml"><mi id="S3.Ex7.m1.10.10.6.3.3.2" xref="S3.Ex7.m1.10.10.6.3.3.2.cmml">p</mi><mi id="S3.Ex7.m1.10.10.6.3.3.3" xref="S3.Ex7.m1.10.10.6.3.3.3.cmml">M</mi></msub><mo id="S3.Ex7.m1.10.10.6.3.2" xref="S3.Ex7.m1.10.10.6.3.2.cmml">⁢</mo><mrow id="S3.Ex7.m1.10.10.6.3.1.1" xref="S3.Ex7.m1.10.10.6.3.1.1.1.cmml"><mo id="S3.Ex7.m1.10.10.6.3.1.1.2" maxsize="120%" minsize="120%" xref="S3.Ex7.m1.10.10.6.3.1.1.1.cmml">(</mo><mrow id="S3.Ex7.m1.10.10.6.3.1.1.1" xref="S3.Ex7.m1.10.10.6.3.1.1.1.cmml"><mover accent="true" id="S3.Ex7.m1.10.10.6.3.1.1.1.3" xref="S3.Ex7.m1.10.10.6.3.1.1.1.3.cmml"><mi id="S3.Ex7.m1.10.10.6.3.1.1.1.3.2" xref="S3.Ex7.m1.10.10.6.3.1.1.1.3.2.cmml">a</mi><mo id="S3.Ex7.m1.10.10.6.3.1.1.1.3.1" xref="S3.Ex7.m1.10.10.6.3.1.1.1.3.1.cmml">¯</mo></mover><mo id="S3.Ex7.m1.10.10.6.3.1.1.1.2" xref="S3.Ex7.m1.10.10.6.3.1.1.1.2.cmml">∣</mo><mrow id="S3.Ex7.m1.10.10.6.3.1.1.1.1.1" xref="S3.Ex7.m1.10.10.6.3.1.1.1.1.2.cmml"><mi id="S3.Ex7.m1.9.9.5.2" xref="S3.Ex7.m1.9.9.5.2.cmml">q</mi><mo id="S3.Ex7.m1.10.10.6.3.1.1.1.1.1.2" xref="S3.Ex7.m1.10.10.6.3.1.1.1.1.2.cmml">,</mo><mrow id="S3.Ex7.m1.10.10.6.3.1.1.1.1.1.1" xref="S3.Ex7.m1.10.10.6.3.1.1.1.1.1.1.cmml"><mi id="S3.Ex7.m1.10.10.6.3.1.1.1.1.1.1.2" xref="S3.Ex7.m1.10.10.6.3.1.1.1.1.1.1.2.cmml">R</mi><mo id="S3.Ex7.m1.10.10.6.3.1.1.1.1.1.1.1" xref="S3.Ex7.m1.10.10.6.3.1.1.1.1.1.1.1.cmml">⁢</mo><mrow id="S3.Ex7.m1.10.10.6.3.1.1.1.1.1.1.3.2" xref="S3.Ex7.m1.10.10.6.3.1.1.1.1.1.1.cmml"><mo id="S3.Ex7.m1.10.10.6.3.1.1.1.1.1.1.3.2.1" stretchy="false" xref="S3.Ex7.m1.10.10.6.3.1.1.1.1.1.1.cmml">(</mo><mi id="S3.Ex7.m1.8.8.4.1" xref="S3.Ex7.m1.8.8.4.1.cmml">q</mi><mo id="S3.Ex7.m1.10.10.6.3.1.1.1.1.1.1.3.2.2" stretchy="false" xref="S3.Ex7.m1.10.10.6.3.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow></mrow><mo id="S3.Ex7.m1.10.10.6.3.1.1.3" maxsize="120%" minsize="120%" xref="S3.Ex7.m1.10.10.6.3.1.1.1.cmml">)</mo></mrow></mrow></mrow></mfrac></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.Ex7.m1.10b"><apply id="S3.Ex7.m1.10.11.cmml" xref="S3.Ex7.m1.10.11"><eq id="S3.Ex7.m1.10.11.1.cmml" xref="S3.Ex7.m1.10.11.1"></eq><ci id="S3.Ex7.m1.10.11.2a.cmml" xref="S3.Ex7.m1.10.11.2"><mtext id="S3.Ex7.m1.10.11.2.cmml" xref="S3.Ex7.m1.10.11.2">MC3</mtext></ci><apply id="S3.Ex7.m1.10.11.3.cmml" xref="S3.Ex7.m1.10.11.3"><times id="S3.Ex7.m1.10.11.3.1.cmml" xref="S3.Ex7.m1.10.11.3.1"></times><apply id="S3.Ex7.m1.1.1.cmml" xref="S3.Ex7.m1.1.1"><divide id="S3.Ex7.m1.1.1.2.cmml" xref="S3.Ex7.m1.1.1"></divide><cn id="S3.Ex7.m1.1.1.3.cmml" type="integer" xref="S3.Ex7.m1.1.1.3">1</cn><apply id="S3.Ex7.m1.1.1.1.2.cmml" xref="S3.Ex7.m1.1.1.1.3"><abs id="S3.Ex7.m1.1.1.1.2.1.cmml" xref="S3.Ex7.m1.1.1.1.3.1"></abs><ci id="S3.Ex7.m1.1.1.1.1.cmml" xref="S3.Ex7.m1.1.1.1.1">𝒟</ci></apply></apply><apply id="S3.Ex7.m1.10.11.3.2.cmml" xref="S3.Ex7.m1.10.11.3.2"><apply id="S3.Ex7.m1.10.11.3.2.1.cmml" xref="S3.Ex7.m1.10.11.3.2.1"><csymbol cd="ambiguous" id="S3.Ex7.m1.10.11.3.2.1.1.cmml" xref="S3.Ex7.m1.10.11.3.2.1">subscript</csymbol><sum id="S3.Ex7.m1.10.11.3.2.1.2.cmml" xref="S3.Ex7.m1.10.11.3.2.1.2"></sum><apply id="S3.Ex7.m1.4.4.3.cmml" xref="S3.Ex7.m1.4.4.3"><in id="S3.Ex7.m1.4.4.3.4.cmml" xref="S3.Ex7.m1.4.4.3.4"></in><vector id="S3.Ex7.m1.4.4.3.5.1.cmml" xref="S3.Ex7.m1.4.4.3.5.2"><ci id="S3.Ex7.m1.2.2.1.1.cmml" xref="S3.Ex7.m1.2.2.1.1">𝑞</ci><ci id="S3.Ex7.m1.3.3.2.2.cmml" xref="S3.Ex7.m1.3.3.2.2">𝐚</ci><apply id="S3.Ex7.m1.4.4.3.3.cmml" xref="S3.Ex7.m1.4.4.3.3"><ci id="S3.Ex7.m1.4.4.3.3.1.cmml" xref="S3.Ex7.m1.4.4.3.3.1">¯</ci><ci id="S3.Ex7.m1.4.4.3.3.2.cmml" xref="S3.Ex7.m1.4.4.3.3.2">𝐚</ci></apply></vector><ci id="S3.Ex7.m1.4.4.3.6.cmml" xref="S3.Ex7.m1.4.4.3.6">𝒟</ci></apply></apply><apply id="S3.Ex7.m1.10.10.cmml" xref="S3.Ex7.m1.10.10"><divide id="S3.Ex7.m1.10.10.7.cmml" xref="S3.Ex7.m1.10.10"></divide><apply id="S3.Ex7.m1.7.7.3.cmml" xref="S3.Ex7.m1.7.7.3"><apply id="S3.Ex7.m1.7.7.3.4.cmml" xref="S3.Ex7.m1.7.7.3.4"><csymbol cd="ambiguous" id="S3.Ex7.m1.7.7.3.4.1.cmml" xref="S3.Ex7.m1.7.7.3.4">subscript</csymbol><sum id="S3.Ex7.m1.7.7.3.4.2.cmml" xref="S3.Ex7.m1.7.7.3.4.2"></sum><apply id="S3.Ex7.m1.7.7.3.4.3.cmml" xref="S3.Ex7.m1.7.7.3.4.3"><in id="S3.Ex7.m1.7.7.3.4.3.1.cmml" xref="S3.Ex7.m1.7.7.3.4.3.1"></in><ci id="S3.Ex7.m1.7.7.3.4.3.2.cmml" xref="S3.Ex7.m1.7.7.3.4.3.2">𝑎</ci><ci id="S3.Ex7.m1.7.7.3.4.3.3.cmml" xref="S3.Ex7.m1.7.7.3.4.3.3">𝐚</ci></apply></apply><apply id="S3.Ex7.m1.7.7.3.3.cmml" xref="S3.Ex7.m1.7.7.3.3"><times id="S3.Ex7.m1.7.7.3.3.2.cmml" xref="S3.Ex7.m1.7.7.3.3.2"></times><apply id="S3.Ex7.m1.7.7.3.3.3.cmml" xref="S3.Ex7.m1.7.7.3.3.3"><csymbol cd="ambiguous" id="S3.Ex7.m1.7.7.3.3.3.1.cmml" xref="S3.Ex7.m1.7.7.3.3.3">subscript</csymbol><ci id="S3.Ex7.m1.7.7.3.3.3.2.cmml" xref="S3.Ex7.m1.7.7.3.3.3.2">𝑝</ci><ci id="S3.Ex7.m1.7.7.3.3.3.3.cmml" xref="S3.Ex7.m1.7.7.3.3.3.3">𝑀</ci></apply><apply id="S3.Ex7.m1.7.7.3.3.1.1.1.cmml" xref="S3.Ex7.m1.7.7.3.3.1.1"><csymbol cd="latexml" id="S3.Ex7.m1.7.7.3.3.1.1.1.2.cmml" xref="S3.Ex7.m1.7.7.3.3.1.1.1.2">conditional</csymbol><ci id="S3.Ex7.m1.7.7.3.3.1.1.1.3.cmml" xref="S3.Ex7.m1.7.7.3.3.1.1.1.3">𝑎</ci><list id="S3.Ex7.m1.7.7.3.3.1.1.1.1.2.cmml" xref="S3.Ex7.m1.7.7.3.3.1.1.1.1.1"><ci id="S3.Ex7.m1.6.6.2.2.cmml" xref="S3.Ex7.m1.6.6.2.2">𝑞</ci><apply id="S3.Ex7.m1.7.7.3.3.1.1.1.1.1.1.cmml" xref="S3.Ex7.m1.7.7.3.3.1.1.1.1.1.1"><times id="S3.Ex7.m1.7.7.3.3.1.1.1.1.1.1.1.cmml" xref="S3.Ex7.m1.7.7.3.3.1.1.1.1.1.1.1"></times><ci id="S3.Ex7.m1.7.7.3.3.1.1.1.1.1.1.2.cmml" xref="S3.Ex7.m1.7.7.3.3.1.1.1.1.1.1.2">𝑅</ci><ci id="S3.Ex7.m1.5.5.1.1.cmml" xref="S3.Ex7.m1.5.5.1.1">𝑞</ci></apply></list></apply></apply></apply><apply id="S3.Ex7.m1.10.10.6.cmml" xref="S3.Ex7.m1.10.10.6"><apply id="S3.Ex7.m1.10.10.6.4.cmml" xref="S3.Ex7.m1.10.10.6.4"><csymbol cd="ambiguous" id="S3.Ex7.m1.10.10.6.4.1.cmml" xref="S3.Ex7.m1.10.10.6.4">subscript</csymbol><sum id="S3.Ex7.m1.10.10.6.4.2.cmml" xref="S3.Ex7.m1.10.10.6.4.2"></sum><apply id="S3.Ex7.m1.10.10.6.4.3.cmml" xref="S3.Ex7.m1.10.10.6.4.3"><in id="S3.Ex7.m1.10.10.6.4.3.1.cmml" xref="S3.Ex7.m1.10.10.6.4.3.1"></in><apply id="S3.Ex7.m1.10.10.6.4.3.2.cmml" xref="S3.Ex7.m1.10.10.6.4.3.2"><ci id="S3.Ex7.m1.10.10.6.4.3.2.1.cmml" xref="S3.Ex7.m1.10.10.6.4.3.2.1">¯</ci><ci id="S3.Ex7.m1.10.10.6.4.3.2.2.cmml" xref="S3.Ex7.m1.10.10.6.4.3.2.2">𝑎</ci></apply><apply id="S3.Ex7.m1.10.10.6.4.3.3.cmml" xref="S3.Ex7.m1.10.10.6.4.3.3"><ci id="S3.Ex7.m1.10.10.6.4.3.3.1.cmml" xref="S3.Ex7.m1.10.10.6.4.3.3.1">¯</ci><ci id="S3.Ex7.m1.10.10.6.4.3.3.2.cmml" xref="S3.Ex7.m1.10.10.6.4.3.3.2">𝐚</ci></apply></apply></apply><apply id="S3.Ex7.m1.10.10.6.3.cmml" xref="S3.Ex7.m1.10.10.6.3"><times id="S3.Ex7.m1.10.10.6.3.2.cmml" xref="S3.Ex7.m1.10.10.6.3.2"></times><apply id="S3.Ex7.m1.10.10.6.3.3.cmml" xref="S3.Ex7.m1.10.10.6.3.3"><csymbol cd="ambiguous" id="S3.Ex7.m1.10.10.6.3.3.1.cmml" xref="S3.Ex7.m1.10.10.6.3.3">subscript</csymbol><ci id="S3.Ex7.m1.10.10.6.3.3.2.cmml" xref="S3.Ex7.m1.10.10.6.3.3.2">𝑝</ci><ci id="S3.Ex7.m1.10.10.6.3.3.3.cmml" xref="S3.Ex7.m1.10.10.6.3.3.3">𝑀</ci></apply><apply id="S3.Ex7.m1.10.10.6.3.1.1.1.cmml" xref="S3.Ex7.m1.10.10.6.3.1.1"><csymbol cd="latexml" id="S3.Ex7.m1.10.10.6.3.1.1.1.2.cmml" xref="S3.Ex7.m1.10.10.6.3.1.1.1.2">conditional</csymbol><apply id="S3.Ex7.m1.10.10.6.3.1.1.1.3.cmml" xref="S3.Ex7.m1.10.10.6.3.1.1.1.3"><ci id="S3.Ex7.m1.10.10.6.3.1.1.1.3.1.cmml" xref="S3.Ex7.m1.10.10.6.3.1.1.1.3.1">¯</ci><ci id="S3.Ex7.m1.10.10.6.3.1.1.1.3.2.cmml" xref="S3.Ex7.m1.10.10.6.3.1.1.1.3.2">𝑎</ci></apply><list id="S3.Ex7.m1.10.10.6.3.1.1.1.1.2.cmml" xref="S3.Ex7.m1.10.10.6.3.1.1.1.1.1"><ci id="S3.Ex7.m1.9.9.5.2.cmml" xref="S3.Ex7.m1.9.9.5.2">𝑞</ci><apply id="S3.Ex7.m1.10.10.6.3.1.1.1.1.1.1.cmml" xref="S3.Ex7.m1.10.10.6.3.1.1.1.1.1.1"><times id="S3.Ex7.m1.10.10.6.3.1.1.1.1.1.1.1.cmml" xref="S3.Ex7.m1.10.10.6.3.1.1.1.1.1.1.1"></times><ci id="S3.Ex7.m1.10.10.6.3.1.1.1.1.1.1.2.cmml" xref="S3.Ex7.m1.10.10.6.3.1.1.1.1.1.1.2">𝑅</ci><ci id="S3.Ex7.m1.8.8.4.1.cmml" xref="S3.Ex7.m1.8.8.4.1">𝑞</ci></apply></list></apply></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.Ex7.m1.10c">\text{MC3}=\frac{1}{|\mathcal{D}|}\sum_{(q,\mathbf{a},\mathbf{\bar{a}})\in%
\mathcal{D}}\frac{\sum_{a\in\mathbf{a}}p_{M}\big{(}a\mid q,R(q)\big{)}}{\sum_{%
\bar{a}\in\mathbf{\bar{a}}}p_{M}\big{(}\bar{a}\mid q,R(q)\big{)}}</annotation><annotation encoding="application/x-llamapun" id="S3.Ex7.m1.10d">MC3 = divide start_ARG 1 end_ARG start_ARG | caligraphic_D | end_ARG ∑ start_POSTSUBSCRIPT ( italic_q , bold_a , over¯ start_ARG bold_a end_ARG ) ∈ caligraphic_D end_POSTSUBSCRIPT divide start_ARG ∑ start_POSTSUBSCRIPT italic_a ∈ bold_a end_POSTSUBSCRIPT italic_p start_POSTSUBSCRIPT italic_M end_POSTSUBSCRIPT ( italic_a ∣ italic_q , italic_R ( italic_q ) ) end_ARG start_ARG ∑ start_POSTSUBSCRIPT over¯ start_ARG italic_a end_ARG ∈ over¯ start_ARG bold_a end_ARG end_POSTSUBSCRIPT italic_p start_POSTSUBSCRIPT italic_M end_POSTSUBSCRIPT ( over¯ start_ARG italic_a end_ARG ∣ italic_q , italic_R ( italic_q ) ) end_ARG</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
</div>
<div class="ltx_para" id="S3.SS2.SSS1.p7">
<p class="ltx_p" id="S3.SS2.SSS1.p7.1">These metrics and their names follow those defined in <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2405.17587v2#bib.bib48" title="">48</a>]</cite>. While they are easy to interpret, these metrics are not well normalized: they don’t take into account all possible correct and incorrect answers. As a result, if the sample of correct and incorrect answers have varying lengths and use of rare vocabulary tokens, these will impact the metrics.</p>
</div>
</section>
<section class="ltx_subsubsection" id="S3.SS2.SSS2">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">3.2.2 </span>Direct Preference Optimization Metric</h4>
<div class="ltx_para" id="S3.SS2.SSS2.p1">
<p class="ltx_p" id="S3.SS2.SSS2.p1.1">We postulate that an ideal metric should obey the following properties: it should be positive when the retrieved context increases the probability of a correct answer; it should be equal in magnitude when the probability of a correct answer halves or doubles; it should relate to the probability of getting all correct answers such that if any one correct answer is impossible, the metric is minimized. Moreover, in the case that incorrect answers are provided, it should be positive when the context <math alttext="C" class="ltx_Math" display="inline" id="S3.SS2.SSS2.p1.1.m1.1"><semantics id="S3.SS2.SSS2.p1.1.m1.1a"><mi id="S3.SS2.SSS2.p1.1.m1.1.1" xref="S3.SS2.SSS2.p1.1.m1.1.1.cmml">C</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS2.p1.1.m1.1b"><ci id="S3.SS2.SSS2.p1.1.m1.1.1.cmml" xref="S3.SS2.SSS2.p1.1.m1.1.1">𝐶</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS2.p1.1.m1.1c">C</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS2.p1.1.m1.1d">italic_C</annotation></semantics></math> increases the probability of correct answers more than that of incorrect answers.</p>
</div>
<div class="ltx_para" id="S3.SS2.SSS2.p2">
<p class="ltx_p" id="S3.SS2.SSS2.p2.1">We define the DPO metric as the negative of the Direct Preference Optimization loss <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2405.17587v2#bib.bib49" title="">49</a>]</cite>, which satisfies these properties:</p>
</div>
<div class="ltx_para" id="S3.SS2.SSS2.p3">
<table class="ltx_equation ltx_eqn_table" id="S3.Ex8">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\text{DPO}=\log\sigma\Big{(}\log\frac{p_{M}\big{(}a\mid q,R(q)\big{)}}{p_{M}(a%
\mid q)}-\log\frac{p_{M}\big{(}\bar{a}\mid q,R(q)\big{)}}{p_{M}(\bar{a}\mid q)%
}\Big{)}" class="ltx_Math" display="block" id="S3.Ex8.m1.9"><semantics id="S3.Ex8.m1.9a"><mrow id="S3.Ex8.m1.9.9" xref="S3.Ex8.m1.9.9.cmml"><mtext id="S3.Ex8.m1.9.9.3" xref="S3.Ex8.m1.9.9.3a.cmml">DPO</mtext><mo id="S3.Ex8.m1.9.9.2" xref="S3.Ex8.m1.9.9.2.cmml">=</mo><mrow id="S3.Ex8.m1.9.9.1" xref="S3.Ex8.m1.9.9.1.cmml"><mrow id="S3.Ex8.m1.9.9.1.3" xref="S3.Ex8.m1.9.9.1.3.cmml"><mi id="S3.Ex8.m1.9.9.1.3.1" xref="S3.Ex8.m1.9.9.1.3.1.cmml">log</mi><mo id="S3.Ex8.m1.9.9.1.3a" lspace="0.167em" xref="S3.Ex8.m1.9.9.1.3.cmml">⁡</mo><mi id="S3.Ex8.m1.9.9.1.3.2" xref="S3.Ex8.m1.9.9.1.3.2.cmml">σ</mi></mrow><mo id="S3.Ex8.m1.9.9.1.2" xref="S3.Ex8.m1.9.9.1.2.cmml">⁢</mo><mrow id="S3.Ex8.m1.9.9.1.1.1" xref="S3.Ex8.m1.9.9.1.1.1.1.cmml"><mo id="S3.Ex8.m1.9.9.1.1.1.2" maxsize="160%" minsize="160%" xref="S3.Ex8.m1.9.9.1.1.1.1.cmml">(</mo><mrow id="S3.Ex8.m1.9.9.1.1.1.1" xref="S3.Ex8.m1.9.9.1.1.1.1.cmml"><mrow id="S3.Ex8.m1.9.9.1.1.1.1.2" xref="S3.Ex8.m1.9.9.1.1.1.1.2.cmml"><mi id="S3.Ex8.m1.9.9.1.1.1.1.2.1" xref="S3.Ex8.m1.9.9.1.1.1.1.2.1.cmml">log</mi><mo id="S3.Ex8.m1.9.9.1.1.1.1.2a" lspace="0.167em" xref="S3.Ex8.m1.9.9.1.1.1.1.2.cmml">⁡</mo><mfrac id="S3.Ex8.m1.4.4" xref="S3.Ex8.m1.4.4.cmml"><mrow id="S3.Ex8.m1.3.3.3" xref="S3.Ex8.m1.3.3.3.cmml"><msub id="S3.Ex8.m1.3.3.3.5" xref="S3.Ex8.m1.3.3.3.5.cmml"><mi id="S3.Ex8.m1.3.3.3.5.2" xref="S3.Ex8.m1.3.3.3.5.2.cmml">p</mi><mi id="S3.Ex8.m1.3.3.3.5.3" xref="S3.Ex8.m1.3.3.3.5.3.cmml">M</mi></msub><mo id="S3.Ex8.m1.3.3.3.4" xref="S3.Ex8.m1.3.3.3.4.cmml">⁢</mo><mrow id="S3.Ex8.m1.3.3.3.3.1" xref="S3.Ex8.m1.3.3.3.3.1.1.cmml"><mo id="S3.Ex8.m1.3.3.3.3.1.2" maxsize="120%" minsize="120%" xref="S3.Ex8.m1.3.3.3.3.1.1.cmml">(</mo><mrow id="S3.Ex8.m1.3.3.3.3.1.1" xref="S3.Ex8.m1.3.3.3.3.1.1.cmml"><mi id="S3.Ex8.m1.3.3.3.3.1.1.3" xref="S3.Ex8.m1.3.3.3.3.1.1.3.cmml">a</mi><mo id="S3.Ex8.m1.3.3.3.3.1.1.2" xref="S3.Ex8.m1.3.3.3.3.1.1.2.cmml">∣</mo><mrow id="S3.Ex8.m1.3.3.3.3.1.1.1.1" xref="S3.Ex8.m1.3.3.3.3.1.1.1.2.cmml"><mi id="S3.Ex8.m1.2.2.2.2" xref="S3.Ex8.m1.2.2.2.2.cmml">q</mi><mo id="S3.Ex8.m1.3.3.3.3.1.1.1.1.2" xref="S3.Ex8.m1.3.3.3.3.1.1.1.2.cmml">,</mo><mrow id="S3.Ex8.m1.3.3.3.3.1.1.1.1.1" xref="S3.Ex8.m1.3.3.3.3.1.1.1.1.1.cmml"><mi id="S3.Ex8.m1.3.3.3.3.1.1.1.1.1.2" xref="S3.Ex8.m1.3.3.3.3.1.1.1.1.1.2.cmml">R</mi><mo id="S3.Ex8.m1.3.3.3.3.1.1.1.1.1.1" xref="S3.Ex8.m1.3.3.3.3.1.1.1.1.1.1.cmml">⁢</mo><mrow id="S3.Ex8.m1.3.3.3.3.1.1.1.1.1.3.2" xref="S3.Ex8.m1.3.3.3.3.1.1.1.1.1.cmml"><mo id="S3.Ex8.m1.3.3.3.3.1.1.1.1.1.3.2.1" stretchy="false" xref="S3.Ex8.m1.3.3.3.3.1.1.1.1.1.cmml">(</mo><mi id="S3.Ex8.m1.1.1.1.1" xref="S3.Ex8.m1.1.1.1.1.cmml">q</mi><mo id="S3.Ex8.m1.3.3.3.3.1.1.1.1.1.3.2.2" stretchy="false" xref="S3.Ex8.m1.3.3.3.3.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow></mrow><mo id="S3.Ex8.m1.3.3.3.3.1.3" maxsize="120%" minsize="120%" xref="S3.Ex8.m1.3.3.3.3.1.1.cmml">)</mo></mrow></mrow><mrow id="S3.Ex8.m1.4.4.4" xref="S3.Ex8.m1.4.4.4.cmml"><msub id="S3.Ex8.m1.4.4.4.3" xref="S3.Ex8.m1.4.4.4.3.cmml"><mi id="S3.Ex8.m1.4.4.4.3.2" xref="S3.Ex8.m1.4.4.4.3.2.cmml">p</mi><mi id="S3.Ex8.m1.4.4.4.3.3" xref="S3.Ex8.m1.4.4.4.3.3.cmml">M</mi></msub><mo id="S3.Ex8.m1.4.4.4.2" xref="S3.Ex8.m1.4.4.4.2.cmml">⁢</mo><mrow id="S3.Ex8.m1.4.4.4.1.1" xref="S3.Ex8.m1.4.4.4.1.1.1.cmml"><mo id="S3.Ex8.m1.4.4.4.1.1.2" stretchy="false" xref="S3.Ex8.m1.4.4.4.1.1.1.cmml">(</mo><mrow id="S3.Ex8.m1.4.4.4.1.1.1" xref="S3.Ex8.m1.4.4.4.1.1.1.cmml"><mi id="S3.Ex8.m1.4.4.4.1.1.1.2" xref="S3.Ex8.m1.4.4.4.1.1.1.2.cmml">a</mi><mo id="S3.Ex8.m1.4.4.4.1.1.1.1" xref="S3.Ex8.m1.4.4.4.1.1.1.1.cmml">∣</mo><mi id="S3.Ex8.m1.4.4.4.1.1.1.3" xref="S3.Ex8.m1.4.4.4.1.1.1.3.cmml">q</mi></mrow><mo id="S3.Ex8.m1.4.4.4.1.1.3" stretchy="false" xref="S3.Ex8.m1.4.4.4.1.1.1.cmml">)</mo></mrow></mrow></mfrac></mrow><mo id="S3.Ex8.m1.9.9.1.1.1.1.1" xref="S3.Ex8.m1.9.9.1.1.1.1.1.cmml">−</mo><mrow id="S3.Ex8.m1.9.9.1.1.1.1.3" xref="S3.Ex8.m1.9.9.1.1.1.1.3.cmml"><mi id="S3.Ex8.m1.9.9.1.1.1.1.3.1" xref="S3.Ex8.m1.9.9.1.1.1.1.3.1.cmml">log</mi><mo id="S3.Ex8.m1.9.9.1.1.1.1.3a" lspace="0.167em" xref="S3.Ex8.m1.9.9.1.1.1.1.3.cmml">⁡</mo><mfrac id="S3.Ex8.m1.8.8" xref="S3.Ex8.m1.8.8.cmml"><mrow id="S3.Ex8.m1.7.7.3" xref="S3.Ex8.m1.7.7.3.cmml"><msub id="S3.Ex8.m1.7.7.3.5" xref="S3.Ex8.m1.7.7.3.5.cmml"><mi id="S3.Ex8.m1.7.7.3.5.2" xref="S3.Ex8.m1.7.7.3.5.2.cmml">p</mi><mi id="S3.Ex8.m1.7.7.3.5.3" xref="S3.Ex8.m1.7.7.3.5.3.cmml">M</mi></msub><mo id="S3.Ex8.m1.7.7.3.4" xref="S3.Ex8.m1.7.7.3.4.cmml">⁢</mo><mrow id="S3.Ex8.m1.7.7.3.3.1" xref="S3.Ex8.m1.7.7.3.3.1.1.cmml"><mo id="S3.Ex8.m1.7.7.3.3.1.2" maxsize="120%" minsize="120%" xref="S3.Ex8.m1.7.7.3.3.1.1.cmml">(</mo><mrow id="S3.Ex8.m1.7.7.3.3.1.1" xref="S3.Ex8.m1.7.7.3.3.1.1.cmml"><mover accent="true" id="S3.Ex8.m1.7.7.3.3.1.1.3" xref="S3.Ex8.m1.7.7.3.3.1.1.3.cmml"><mi id="S3.Ex8.m1.7.7.3.3.1.1.3.2" xref="S3.Ex8.m1.7.7.3.3.1.1.3.2.cmml">a</mi><mo id="S3.Ex8.m1.7.7.3.3.1.1.3.1" xref="S3.Ex8.m1.7.7.3.3.1.1.3.1.cmml">¯</mo></mover><mo id="S3.Ex8.m1.7.7.3.3.1.1.2" xref="S3.Ex8.m1.7.7.3.3.1.1.2.cmml">∣</mo><mrow id="S3.Ex8.m1.7.7.3.3.1.1.1.1" xref="S3.Ex8.m1.7.7.3.3.1.1.1.2.cmml"><mi id="S3.Ex8.m1.6.6.2.2" xref="S3.Ex8.m1.6.6.2.2.cmml">q</mi><mo id="S3.Ex8.m1.7.7.3.3.1.1.1.1.2" xref="S3.Ex8.m1.7.7.3.3.1.1.1.2.cmml">,</mo><mrow id="S3.Ex8.m1.7.7.3.3.1.1.1.1.1" xref="S3.Ex8.m1.7.7.3.3.1.1.1.1.1.cmml"><mi id="S3.Ex8.m1.7.7.3.3.1.1.1.1.1.2" xref="S3.Ex8.m1.7.7.3.3.1.1.1.1.1.2.cmml">R</mi><mo id="S3.Ex8.m1.7.7.3.3.1.1.1.1.1.1" xref="S3.Ex8.m1.7.7.3.3.1.1.1.1.1.1.cmml">⁢</mo><mrow id="S3.Ex8.m1.7.7.3.3.1.1.1.1.1.3.2" xref="S3.Ex8.m1.7.7.3.3.1.1.1.1.1.cmml"><mo id="S3.Ex8.m1.7.7.3.3.1.1.1.1.1.3.2.1" stretchy="false" xref="S3.Ex8.m1.7.7.3.3.1.1.1.1.1.cmml">(</mo><mi id="S3.Ex8.m1.5.5.1.1" xref="S3.Ex8.m1.5.5.1.1.cmml">q</mi><mo id="S3.Ex8.m1.7.7.3.3.1.1.1.1.1.3.2.2" stretchy="false" xref="S3.Ex8.m1.7.7.3.3.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow></mrow><mo id="S3.Ex8.m1.7.7.3.3.1.3" maxsize="120%" minsize="120%" xref="S3.Ex8.m1.7.7.3.3.1.1.cmml">)</mo></mrow></mrow><mrow id="S3.Ex8.m1.8.8.4" xref="S3.Ex8.m1.8.8.4.cmml"><msub id="S3.Ex8.m1.8.8.4.3" xref="S3.Ex8.m1.8.8.4.3.cmml"><mi id="S3.Ex8.m1.8.8.4.3.2" xref="S3.Ex8.m1.8.8.4.3.2.cmml">p</mi><mi id="S3.Ex8.m1.8.8.4.3.3" xref="S3.Ex8.m1.8.8.4.3.3.cmml">M</mi></msub><mo id="S3.Ex8.m1.8.8.4.2" xref="S3.Ex8.m1.8.8.4.2.cmml">⁢</mo><mrow id="S3.Ex8.m1.8.8.4.1.1" xref="S3.Ex8.m1.8.8.4.1.1.1.cmml"><mo id="S3.Ex8.m1.8.8.4.1.1.2" stretchy="false" xref="S3.Ex8.m1.8.8.4.1.1.1.cmml">(</mo><mrow id="S3.Ex8.m1.8.8.4.1.1.1" xref="S3.Ex8.m1.8.8.4.1.1.1.cmml"><mover accent="true" id="S3.Ex8.m1.8.8.4.1.1.1.2" xref="S3.Ex8.m1.8.8.4.1.1.1.2.cmml"><mi id="S3.Ex8.m1.8.8.4.1.1.1.2.2" xref="S3.Ex8.m1.8.8.4.1.1.1.2.2.cmml">a</mi><mo id="S3.Ex8.m1.8.8.4.1.1.1.2.1" xref="S3.Ex8.m1.8.8.4.1.1.1.2.1.cmml">¯</mo></mover><mo id="S3.Ex8.m1.8.8.4.1.1.1.1" xref="S3.Ex8.m1.8.8.4.1.1.1.1.cmml">∣</mo><mi id="S3.Ex8.m1.8.8.4.1.1.1.3" xref="S3.Ex8.m1.8.8.4.1.1.1.3.cmml">q</mi></mrow><mo id="S3.Ex8.m1.8.8.4.1.1.3" stretchy="false" xref="S3.Ex8.m1.8.8.4.1.1.1.cmml">)</mo></mrow></mrow></mfrac></mrow></mrow><mo id="S3.Ex8.m1.9.9.1.1.1.3" maxsize="160%" minsize="160%" xref="S3.Ex8.m1.9.9.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.Ex8.m1.9b"><apply id="S3.Ex8.m1.9.9.cmml" xref="S3.Ex8.m1.9.9"><eq id="S3.Ex8.m1.9.9.2.cmml" xref="S3.Ex8.m1.9.9.2"></eq><ci id="S3.Ex8.m1.9.9.3a.cmml" xref="S3.Ex8.m1.9.9.3"><mtext id="S3.Ex8.m1.9.9.3.cmml" xref="S3.Ex8.m1.9.9.3">DPO</mtext></ci><apply id="S3.Ex8.m1.9.9.1.cmml" xref="S3.Ex8.m1.9.9.1"><times id="S3.Ex8.m1.9.9.1.2.cmml" xref="S3.Ex8.m1.9.9.1.2"></times><apply id="S3.Ex8.m1.9.9.1.3.cmml" xref="S3.Ex8.m1.9.9.1.3"><log id="S3.Ex8.m1.9.9.1.3.1.cmml" xref="S3.Ex8.m1.9.9.1.3.1"></log><ci id="S3.Ex8.m1.9.9.1.3.2.cmml" xref="S3.Ex8.m1.9.9.1.3.2">𝜎</ci></apply><apply id="S3.Ex8.m1.9.9.1.1.1.1.cmml" xref="S3.Ex8.m1.9.9.1.1.1"><minus id="S3.Ex8.m1.9.9.1.1.1.1.1.cmml" xref="S3.Ex8.m1.9.9.1.1.1.1.1"></minus><apply id="S3.Ex8.m1.9.9.1.1.1.1.2.cmml" xref="S3.Ex8.m1.9.9.1.1.1.1.2"><log id="S3.Ex8.m1.9.9.1.1.1.1.2.1.cmml" xref="S3.Ex8.m1.9.9.1.1.1.1.2.1"></log><apply id="S3.Ex8.m1.4.4.cmml" xref="S3.Ex8.m1.4.4"><divide id="S3.Ex8.m1.4.4.5.cmml" xref="S3.Ex8.m1.4.4"></divide><apply id="S3.Ex8.m1.3.3.3.cmml" xref="S3.Ex8.m1.3.3.3"><times id="S3.Ex8.m1.3.3.3.4.cmml" xref="S3.Ex8.m1.3.3.3.4"></times><apply id="S3.Ex8.m1.3.3.3.5.cmml" xref="S3.Ex8.m1.3.3.3.5"><csymbol cd="ambiguous" id="S3.Ex8.m1.3.3.3.5.1.cmml" xref="S3.Ex8.m1.3.3.3.5">subscript</csymbol><ci id="S3.Ex8.m1.3.3.3.5.2.cmml" xref="S3.Ex8.m1.3.3.3.5.2">𝑝</ci><ci id="S3.Ex8.m1.3.3.3.5.3.cmml" xref="S3.Ex8.m1.3.3.3.5.3">𝑀</ci></apply><apply id="S3.Ex8.m1.3.3.3.3.1.1.cmml" xref="S3.Ex8.m1.3.3.3.3.1"><csymbol cd="latexml" id="S3.Ex8.m1.3.3.3.3.1.1.2.cmml" xref="S3.Ex8.m1.3.3.3.3.1.1.2">conditional</csymbol><ci id="S3.Ex8.m1.3.3.3.3.1.1.3.cmml" xref="S3.Ex8.m1.3.3.3.3.1.1.3">𝑎</ci><list id="S3.Ex8.m1.3.3.3.3.1.1.1.2.cmml" xref="S3.Ex8.m1.3.3.3.3.1.1.1.1"><ci id="S3.Ex8.m1.2.2.2.2.cmml" xref="S3.Ex8.m1.2.2.2.2">𝑞</ci><apply id="S3.Ex8.m1.3.3.3.3.1.1.1.1.1.cmml" xref="S3.Ex8.m1.3.3.3.3.1.1.1.1.1"><times id="S3.Ex8.m1.3.3.3.3.1.1.1.1.1.1.cmml" xref="S3.Ex8.m1.3.3.3.3.1.1.1.1.1.1"></times><ci id="S3.Ex8.m1.3.3.3.3.1.1.1.1.1.2.cmml" xref="S3.Ex8.m1.3.3.3.3.1.1.1.1.1.2">𝑅</ci><ci id="S3.Ex8.m1.1.1.1.1.cmml" xref="S3.Ex8.m1.1.1.1.1">𝑞</ci></apply></list></apply></apply><apply id="S3.Ex8.m1.4.4.4.cmml" xref="S3.Ex8.m1.4.4.4"><times id="S3.Ex8.m1.4.4.4.2.cmml" xref="S3.Ex8.m1.4.4.4.2"></times><apply id="S3.Ex8.m1.4.4.4.3.cmml" xref="S3.Ex8.m1.4.4.4.3"><csymbol cd="ambiguous" id="S3.Ex8.m1.4.4.4.3.1.cmml" xref="S3.Ex8.m1.4.4.4.3">subscript</csymbol><ci id="S3.Ex8.m1.4.4.4.3.2.cmml" xref="S3.Ex8.m1.4.4.4.3.2">𝑝</ci><ci id="S3.Ex8.m1.4.4.4.3.3.cmml" xref="S3.Ex8.m1.4.4.4.3.3">𝑀</ci></apply><apply id="S3.Ex8.m1.4.4.4.1.1.1.cmml" xref="S3.Ex8.m1.4.4.4.1.1"><csymbol cd="latexml" id="S3.Ex8.m1.4.4.4.1.1.1.1.cmml" xref="S3.Ex8.m1.4.4.4.1.1.1.1">conditional</csymbol><ci id="S3.Ex8.m1.4.4.4.1.1.1.2.cmml" xref="S3.Ex8.m1.4.4.4.1.1.1.2">𝑎</ci><ci id="S3.Ex8.m1.4.4.4.1.1.1.3.cmml" xref="S3.Ex8.m1.4.4.4.1.1.1.3">𝑞</ci></apply></apply></apply></apply><apply id="S3.Ex8.m1.9.9.1.1.1.1.3.cmml" xref="S3.Ex8.m1.9.9.1.1.1.1.3"><log id="S3.Ex8.m1.9.9.1.1.1.1.3.1.cmml" xref="S3.Ex8.m1.9.9.1.1.1.1.3.1"></log><apply id="S3.Ex8.m1.8.8.cmml" xref="S3.Ex8.m1.8.8"><divide id="S3.Ex8.m1.8.8.5.cmml" xref="S3.Ex8.m1.8.8"></divide><apply id="S3.Ex8.m1.7.7.3.cmml" xref="S3.Ex8.m1.7.7.3"><times id="S3.Ex8.m1.7.7.3.4.cmml" xref="S3.Ex8.m1.7.7.3.4"></times><apply id="S3.Ex8.m1.7.7.3.5.cmml" xref="S3.Ex8.m1.7.7.3.5"><csymbol cd="ambiguous" id="S3.Ex8.m1.7.7.3.5.1.cmml" xref="S3.Ex8.m1.7.7.3.5">subscript</csymbol><ci id="S3.Ex8.m1.7.7.3.5.2.cmml" xref="S3.Ex8.m1.7.7.3.5.2">𝑝</ci><ci id="S3.Ex8.m1.7.7.3.5.3.cmml" xref="S3.Ex8.m1.7.7.3.5.3">𝑀</ci></apply><apply id="S3.Ex8.m1.7.7.3.3.1.1.cmml" xref="S3.Ex8.m1.7.7.3.3.1"><csymbol cd="latexml" id="S3.Ex8.m1.7.7.3.3.1.1.2.cmml" xref="S3.Ex8.m1.7.7.3.3.1.1.2">conditional</csymbol><apply id="S3.Ex8.m1.7.7.3.3.1.1.3.cmml" xref="S3.Ex8.m1.7.7.3.3.1.1.3"><ci id="S3.Ex8.m1.7.7.3.3.1.1.3.1.cmml" xref="S3.Ex8.m1.7.7.3.3.1.1.3.1">¯</ci><ci id="S3.Ex8.m1.7.7.3.3.1.1.3.2.cmml" xref="S3.Ex8.m1.7.7.3.3.1.1.3.2">𝑎</ci></apply><list id="S3.Ex8.m1.7.7.3.3.1.1.1.2.cmml" xref="S3.Ex8.m1.7.7.3.3.1.1.1.1"><ci id="S3.Ex8.m1.6.6.2.2.cmml" xref="S3.Ex8.m1.6.6.2.2">𝑞</ci><apply id="S3.Ex8.m1.7.7.3.3.1.1.1.1.1.cmml" xref="S3.Ex8.m1.7.7.3.3.1.1.1.1.1"><times id="S3.Ex8.m1.7.7.3.3.1.1.1.1.1.1.cmml" xref="S3.Ex8.m1.7.7.3.3.1.1.1.1.1.1"></times><ci id="S3.Ex8.m1.7.7.3.3.1.1.1.1.1.2.cmml" xref="S3.Ex8.m1.7.7.3.3.1.1.1.1.1.2">𝑅</ci><ci id="S3.Ex8.m1.5.5.1.1.cmml" xref="S3.Ex8.m1.5.5.1.1">𝑞</ci></apply></list></apply></apply><apply id="S3.Ex8.m1.8.8.4.cmml" xref="S3.Ex8.m1.8.8.4"><times id="S3.Ex8.m1.8.8.4.2.cmml" xref="S3.Ex8.m1.8.8.4.2"></times><apply id="S3.Ex8.m1.8.8.4.3.cmml" xref="S3.Ex8.m1.8.8.4.3"><csymbol cd="ambiguous" id="S3.Ex8.m1.8.8.4.3.1.cmml" xref="S3.Ex8.m1.8.8.4.3">subscript</csymbol><ci id="S3.Ex8.m1.8.8.4.3.2.cmml" xref="S3.Ex8.m1.8.8.4.3.2">𝑝</ci><ci id="S3.Ex8.m1.8.8.4.3.3.cmml" xref="S3.Ex8.m1.8.8.4.3.3">𝑀</ci></apply><apply id="S3.Ex8.m1.8.8.4.1.1.1.cmml" xref="S3.Ex8.m1.8.8.4.1.1"><csymbol cd="latexml" id="S3.Ex8.m1.8.8.4.1.1.1.1.cmml" xref="S3.Ex8.m1.8.8.4.1.1.1.1">conditional</csymbol><apply id="S3.Ex8.m1.8.8.4.1.1.1.2.cmml" xref="S3.Ex8.m1.8.8.4.1.1.1.2"><ci id="S3.Ex8.m1.8.8.4.1.1.1.2.1.cmml" xref="S3.Ex8.m1.8.8.4.1.1.1.2.1">¯</ci><ci id="S3.Ex8.m1.8.8.4.1.1.1.2.2.cmml" xref="S3.Ex8.m1.8.8.4.1.1.1.2.2">𝑎</ci></apply><ci id="S3.Ex8.m1.8.8.4.1.1.1.3.cmml" xref="S3.Ex8.m1.8.8.4.1.1.1.3">𝑞</ci></apply></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.Ex8.m1.9c">\text{DPO}=\log\sigma\Big{(}\log\frac{p_{M}\big{(}a\mid q,R(q)\big{)}}{p_{M}(a%
\mid q)}-\log\frac{p_{M}\big{(}\bar{a}\mid q,R(q)\big{)}}{p_{M}(\bar{a}\mid q)%
}\Big{)}</annotation><annotation encoding="application/x-llamapun" id="S3.Ex8.m1.9d">DPO = roman_log italic_σ ( roman_log divide start_ARG italic_p start_POSTSUBSCRIPT italic_M end_POSTSUBSCRIPT ( italic_a ∣ italic_q , italic_R ( italic_q ) ) end_ARG start_ARG italic_p start_POSTSUBSCRIPT italic_M end_POSTSUBSCRIPT ( italic_a ∣ italic_q ) end_ARG - roman_log divide start_ARG italic_p start_POSTSUBSCRIPT italic_M end_POSTSUBSCRIPT ( over¯ start_ARG italic_a end_ARG ∣ italic_q , italic_R ( italic_q ) ) end_ARG start_ARG italic_p start_POSTSUBSCRIPT italic_M end_POSTSUBSCRIPT ( over¯ start_ARG italic_a end_ARG ∣ italic_q ) end_ARG )</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
</div>
<div class="ltx_para" id="S3.SS2.SSS2.p4">
<p class="ltx_p" id="S3.SS2.SSS2.p4.1">In the case that incorrect answers are not available, the term containing <math alttext="\bar{a}" class="ltx_Math" display="inline" id="S3.SS2.SSS2.p4.1.m1.1"><semantics id="S3.SS2.SSS2.p4.1.m1.1a"><mover accent="true" id="S3.SS2.SSS2.p4.1.m1.1.1" xref="S3.SS2.SSS2.p4.1.m1.1.1.cmml"><mi id="S3.SS2.SSS2.p4.1.m1.1.1.2" xref="S3.SS2.SSS2.p4.1.m1.1.1.2.cmml">a</mi><mo id="S3.SS2.SSS2.p4.1.m1.1.1.1" xref="S3.SS2.SSS2.p4.1.m1.1.1.1.cmml">¯</mo></mover><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS2.p4.1.m1.1b"><apply id="S3.SS2.SSS2.p4.1.m1.1.1.cmml" xref="S3.SS2.SSS2.p4.1.m1.1.1"><ci id="S3.SS2.SSS2.p4.1.m1.1.1.1.cmml" xref="S3.SS2.SSS2.p4.1.m1.1.1.1">¯</ci><ci id="S3.SS2.SSS2.p4.1.m1.1.1.2.cmml" xref="S3.SS2.SSS2.p4.1.m1.1.1.2">𝑎</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS2.p4.1.m1.1c">\bar{a}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS2.p4.1.m1.1d">over¯ start_ARG italic_a end_ARG</annotation></semantics></math> can be omitted while preserving the aforementioned properties.</p>
</div>
<div class="ltx_para" id="S3.SS2.SSS2.p5">
<p class="ltx_p" id="S3.SS2.SSS2.p5.2">Because the metric is proportional to probability ratio <math alttext="p_{M}(a\mid q,C)/p_{M}(a\mid q)" class="ltx_Math" display="inline" id="S3.SS2.SSS2.p5.1.m1.4"><semantics id="S3.SS2.SSS2.p5.1.m1.4a"><mrow id="S3.SS2.SSS2.p5.1.m1.4.4" xref="S3.SS2.SSS2.p5.1.m1.4.4.cmml"><mrow id="S3.SS2.SSS2.p5.1.m1.3.3.1" xref="S3.SS2.SSS2.p5.1.m1.3.3.1.cmml"><mrow id="S3.SS2.SSS2.p5.1.m1.3.3.1.1" xref="S3.SS2.SSS2.p5.1.m1.3.3.1.1.cmml"><msub id="S3.SS2.SSS2.p5.1.m1.3.3.1.1.3" xref="S3.SS2.SSS2.p5.1.m1.3.3.1.1.3.cmml"><mi id="S3.SS2.SSS2.p5.1.m1.3.3.1.1.3.2" xref="S3.SS2.SSS2.p5.1.m1.3.3.1.1.3.2.cmml">p</mi><mi id="S3.SS2.SSS2.p5.1.m1.3.3.1.1.3.3" xref="S3.SS2.SSS2.p5.1.m1.3.3.1.1.3.3.cmml">M</mi></msub><mo id="S3.SS2.SSS2.p5.1.m1.3.3.1.1.2" xref="S3.SS2.SSS2.p5.1.m1.3.3.1.1.2.cmml">⁢</mo><mrow id="S3.SS2.SSS2.p5.1.m1.3.3.1.1.1.1" xref="S3.SS2.SSS2.p5.1.m1.3.3.1.1.1.1.1.cmml"><mo id="S3.SS2.SSS2.p5.1.m1.3.3.1.1.1.1.2" stretchy="false" xref="S3.SS2.SSS2.p5.1.m1.3.3.1.1.1.1.1.cmml">(</mo><mrow id="S3.SS2.SSS2.p5.1.m1.3.3.1.1.1.1.1" xref="S3.SS2.SSS2.p5.1.m1.3.3.1.1.1.1.1.cmml"><mi id="S3.SS2.SSS2.p5.1.m1.3.3.1.1.1.1.1.2" xref="S3.SS2.SSS2.p5.1.m1.3.3.1.1.1.1.1.2.cmml">a</mi><mo id="S3.SS2.SSS2.p5.1.m1.3.3.1.1.1.1.1.1" xref="S3.SS2.SSS2.p5.1.m1.3.3.1.1.1.1.1.1.cmml">∣</mo><mrow id="S3.SS2.SSS2.p5.1.m1.3.3.1.1.1.1.1.3.2" xref="S3.SS2.SSS2.p5.1.m1.3.3.1.1.1.1.1.3.1.cmml"><mi id="S3.SS2.SSS2.p5.1.m1.1.1" xref="S3.SS2.SSS2.p5.1.m1.1.1.cmml">q</mi><mo id="S3.SS2.SSS2.p5.1.m1.3.3.1.1.1.1.1.3.2.1" xref="S3.SS2.SSS2.p5.1.m1.3.3.1.1.1.1.1.3.1.cmml">,</mo><mi id="S3.SS2.SSS2.p5.1.m1.2.2" xref="S3.SS2.SSS2.p5.1.m1.2.2.cmml">C</mi></mrow></mrow><mo id="S3.SS2.SSS2.p5.1.m1.3.3.1.1.1.1.3" stretchy="false" xref="S3.SS2.SSS2.p5.1.m1.3.3.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S3.SS2.SSS2.p5.1.m1.3.3.1.2" xref="S3.SS2.SSS2.p5.1.m1.3.3.1.2.cmml">/</mo><msub id="S3.SS2.SSS2.p5.1.m1.3.3.1.3" xref="S3.SS2.SSS2.p5.1.m1.3.3.1.3.cmml"><mi id="S3.SS2.SSS2.p5.1.m1.3.3.1.3.2" xref="S3.SS2.SSS2.p5.1.m1.3.3.1.3.2.cmml">p</mi><mi id="S3.SS2.SSS2.p5.1.m1.3.3.1.3.3" xref="S3.SS2.SSS2.p5.1.m1.3.3.1.3.3.cmml">M</mi></msub></mrow><mo id="S3.SS2.SSS2.p5.1.m1.4.4.3" xref="S3.SS2.SSS2.p5.1.m1.4.4.3.cmml">⁢</mo><mrow id="S3.SS2.SSS2.p5.1.m1.4.4.2.1" xref="S3.SS2.SSS2.p5.1.m1.4.4.2.1.1.cmml"><mo id="S3.SS2.SSS2.p5.1.m1.4.4.2.1.2" stretchy="false" xref="S3.SS2.SSS2.p5.1.m1.4.4.2.1.1.cmml">(</mo><mrow id="S3.SS2.SSS2.p5.1.m1.4.4.2.1.1" xref="S3.SS2.SSS2.p5.1.m1.4.4.2.1.1.cmml"><mi id="S3.SS2.SSS2.p5.1.m1.4.4.2.1.1.2" xref="S3.SS2.SSS2.p5.1.m1.4.4.2.1.1.2.cmml">a</mi><mo id="S3.SS2.SSS2.p5.1.m1.4.4.2.1.1.1" xref="S3.SS2.SSS2.p5.1.m1.4.4.2.1.1.1.cmml">∣</mo><mi id="S3.SS2.SSS2.p5.1.m1.4.4.2.1.1.3" xref="S3.SS2.SSS2.p5.1.m1.4.4.2.1.1.3.cmml">q</mi></mrow><mo id="S3.SS2.SSS2.p5.1.m1.4.4.2.1.3" stretchy="false" xref="S3.SS2.SSS2.p5.1.m1.4.4.2.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS2.p5.1.m1.4b"><apply id="S3.SS2.SSS2.p5.1.m1.4.4.cmml" xref="S3.SS2.SSS2.p5.1.m1.4.4"><times id="S3.SS2.SSS2.p5.1.m1.4.4.3.cmml" xref="S3.SS2.SSS2.p5.1.m1.4.4.3"></times><apply id="S3.SS2.SSS2.p5.1.m1.3.3.1.cmml" xref="S3.SS2.SSS2.p5.1.m1.3.3.1"><divide id="S3.SS2.SSS2.p5.1.m1.3.3.1.2.cmml" xref="S3.SS2.SSS2.p5.1.m1.3.3.1.2"></divide><apply id="S3.SS2.SSS2.p5.1.m1.3.3.1.1.cmml" xref="S3.SS2.SSS2.p5.1.m1.3.3.1.1"><times id="S3.SS2.SSS2.p5.1.m1.3.3.1.1.2.cmml" xref="S3.SS2.SSS2.p5.1.m1.3.3.1.1.2"></times><apply id="S3.SS2.SSS2.p5.1.m1.3.3.1.1.3.cmml" xref="S3.SS2.SSS2.p5.1.m1.3.3.1.1.3"><csymbol cd="ambiguous" id="S3.SS2.SSS2.p5.1.m1.3.3.1.1.3.1.cmml" xref="S3.SS2.SSS2.p5.1.m1.3.3.1.1.3">subscript</csymbol><ci id="S3.SS2.SSS2.p5.1.m1.3.3.1.1.3.2.cmml" xref="S3.SS2.SSS2.p5.1.m1.3.3.1.1.3.2">𝑝</ci><ci id="S3.SS2.SSS2.p5.1.m1.3.3.1.1.3.3.cmml" xref="S3.SS2.SSS2.p5.1.m1.3.3.1.1.3.3">𝑀</ci></apply><apply id="S3.SS2.SSS2.p5.1.m1.3.3.1.1.1.1.1.cmml" xref="S3.SS2.SSS2.p5.1.m1.3.3.1.1.1.1"><csymbol cd="latexml" id="S3.SS2.SSS2.p5.1.m1.3.3.1.1.1.1.1.1.cmml" xref="S3.SS2.SSS2.p5.1.m1.3.3.1.1.1.1.1.1">conditional</csymbol><ci id="S3.SS2.SSS2.p5.1.m1.3.3.1.1.1.1.1.2.cmml" xref="S3.SS2.SSS2.p5.1.m1.3.3.1.1.1.1.1.2">𝑎</ci><list id="S3.SS2.SSS2.p5.1.m1.3.3.1.1.1.1.1.3.1.cmml" xref="S3.SS2.SSS2.p5.1.m1.3.3.1.1.1.1.1.3.2"><ci id="S3.SS2.SSS2.p5.1.m1.1.1.cmml" xref="S3.SS2.SSS2.p5.1.m1.1.1">𝑞</ci><ci id="S3.SS2.SSS2.p5.1.m1.2.2.cmml" xref="S3.SS2.SSS2.p5.1.m1.2.2">𝐶</ci></list></apply></apply><apply id="S3.SS2.SSS2.p5.1.m1.3.3.1.3.cmml" xref="S3.SS2.SSS2.p5.1.m1.3.3.1.3"><csymbol cd="ambiguous" id="S3.SS2.SSS2.p5.1.m1.3.3.1.3.1.cmml" xref="S3.SS2.SSS2.p5.1.m1.3.3.1.3">subscript</csymbol><ci id="S3.SS2.SSS2.p5.1.m1.3.3.1.3.2.cmml" xref="S3.SS2.SSS2.p5.1.m1.3.3.1.3.2">𝑝</ci><ci id="S3.SS2.SSS2.p5.1.m1.3.3.1.3.3.cmml" xref="S3.SS2.SSS2.p5.1.m1.3.3.1.3.3">𝑀</ci></apply></apply><apply id="S3.SS2.SSS2.p5.1.m1.4.4.2.1.1.cmml" xref="S3.SS2.SSS2.p5.1.m1.4.4.2.1"><csymbol cd="latexml" id="S3.SS2.SSS2.p5.1.m1.4.4.2.1.1.1.cmml" xref="S3.SS2.SSS2.p5.1.m1.4.4.2.1.1.1">conditional</csymbol><ci id="S3.SS2.SSS2.p5.1.m1.4.4.2.1.1.2.cmml" xref="S3.SS2.SSS2.p5.1.m1.4.4.2.1.1.2">𝑎</ci><ci id="S3.SS2.SSS2.p5.1.m1.4.4.2.1.1.3.cmml" xref="S3.SS2.SSS2.p5.1.m1.4.4.2.1.1.3">𝑞</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS2.p5.1.m1.4c">p_{M}(a\mid q,C)/p_{M}(a\mid q)</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS2.p5.1.m1.4d">italic_p start_POSTSUBSCRIPT italic_M end_POSTSUBSCRIPT ( italic_a ∣ italic_q , italic_C ) / italic_p start_POSTSUBSCRIPT italic_M end_POSTSUBSCRIPT ( italic_a ∣ italic_q )</annotation></semantics></math> rather than the absolute probability <math alttext="p_{M}(a\mid q,C)" class="ltx_Math" display="inline" id="S3.SS2.SSS2.p5.2.m2.3"><semantics id="S3.SS2.SSS2.p5.2.m2.3a"><mrow id="S3.SS2.SSS2.p5.2.m2.3.3" xref="S3.SS2.SSS2.p5.2.m2.3.3.cmml"><msub id="S3.SS2.SSS2.p5.2.m2.3.3.3" xref="S3.SS2.SSS2.p5.2.m2.3.3.3.cmml"><mi id="S3.SS2.SSS2.p5.2.m2.3.3.3.2" xref="S3.SS2.SSS2.p5.2.m2.3.3.3.2.cmml">p</mi><mi id="S3.SS2.SSS2.p5.2.m2.3.3.3.3" xref="S3.SS2.SSS2.p5.2.m2.3.3.3.3.cmml">M</mi></msub><mo id="S3.SS2.SSS2.p5.2.m2.3.3.2" xref="S3.SS2.SSS2.p5.2.m2.3.3.2.cmml">⁢</mo><mrow id="S3.SS2.SSS2.p5.2.m2.3.3.1.1" xref="S3.SS2.SSS2.p5.2.m2.3.3.1.1.1.cmml"><mo id="S3.SS2.SSS2.p5.2.m2.3.3.1.1.2" stretchy="false" xref="S3.SS2.SSS2.p5.2.m2.3.3.1.1.1.cmml">(</mo><mrow id="S3.SS2.SSS2.p5.2.m2.3.3.1.1.1" xref="S3.SS2.SSS2.p5.2.m2.3.3.1.1.1.cmml"><mi id="S3.SS2.SSS2.p5.2.m2.3.3.1.1.1.2" xref="S3.SS2.SSS2.p5.2.m2.3.3.1.1.1.2.cmml">a</mi><mo id="S3.SS2.SSS2.p5.2.m2.3.3.1.1.1.1" xref="S3.SS2.SSS2.p5.2.m2.3.3.1.1.1.1.cmml">∣</mo><mrow id="S3.SS2.SSS2.p5.2.m2.3.3.1.1.1.3.2" xref="S3.SS2.SSS2.p5.2.m2.3.3.1.1.1.3.1.cmml"><mi id="S3.SS2.SSS2.p5.2.m2.1.1" xref="S3.SS2.SSS2.p5.2.m2.1.1.cmml">q</mi><mo id="S3.SS2.SSS2.p5.2.m2.3.3.1.1.1.3.2.1" xref="S3.SS2.SSS2.p5.2.m2.3.3.1.1.1.3.1.cmml">,</mo><mi id="S3.SS2.SSS2.p5.2.m2.2.2" xref="S3.SS2.SSS2.p5.2.m2.2.2.cmml">C</mi></mrow></mrow><mo id="S3.SS2.SSS2.p5.2.m2.3.3.1.1.3" stretchy="false" xref="S3.SS2.SSS2.p5.2.m2.3.3.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS2.p5.2.m2.3b"><apply id="S3.SS2.SSS2.p5.2.m2.3.3.cmml" xref="S3.SS2.SSS2.p5.2.m2.3.3"><times id="S3.SS2.SSS2.p5.2.m2.3.3.2.cmml" xref="S3.SS2.SSS2.p5.2.m2.3.3.2"></times><apply id="S3.SS2.SSS2.p5.2.m2.3.3.3.cmml" xref="S3.SS2.SSS2.p5.2.m2.3.3.3"><csymbol cd="ambiguous" id="S3.SS2.SSS2.p5.2.m2.3.3.3.1.cmml" xref="S3.SS2.SSS2.p5.2.m2.3.3.3">subscript</csymbol><ci id="S3.SS2.SSS2.p5.2.m2.3.3.3.2.cmml" xref="S3.SS2.SSS2.p5.2.m2.3.3.3.2">𝑝</ci><ci id="S3.SS2.SSS2.p5.2.m2.3.3.3.3.cmml" xref="S3.SS2.SSS2.p5.2.m2.3.3.3.3">𝑀</ci></apply><apply id="S3.SS2.SSS2.p5.2.m2.3.3.1.1.1.cmml" xref="S3.SS2.SSS2.p5.2.m2.3.3.1.1"><csymbol cd="latexml" id="S3.SS2.SSS2.p5.2.m2.3.3.1.1.1.1.cmml" xref="S3.SS2.SSS2.p5.2.m2.3.3.1.1.1.1">conditional</csymbol><ci id="S3.SS2.SSS2.p5.2.m2.3.3.1.1.1.2.cmml" xref="S3.SS2.SSS2.p5.2.m2.3.3.1.1.1.2">𝑎</ci><list id="S3.SS2.SSS2.p5.2.m2.3.3.1.1.1.3.1.cmml" xref="S3.SS2.SSS2.p5.2.m2.3.3.1.1.1.3.2"><ci id="S3.SS2.SSS2.p5.2.m2.1.1.cmml" xref="S3.SS2.SSS2.p5.2.m2.1.1">𝑞</ci><ci id="S3.SS2.SSS2.p5.2.m2.2.2.cmml" xref="S3.SS2.SSS2.p5.2.m2.2.2">𝐶</ci></list></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS2.p5.2.m2.3c">p_{M}(a\mid q,C)</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS2.p5.2.m2.3d">italic_p start_POSTSUBSCRIPT italic_M end_POSTSUBSCRIPT ( italic_a ∣ italic_q , italic_C )</annotation></semantics></math>, it is invariant to the number of tokens and frequency of rare vocabulary tokens in the answer. If this were not the case, then the score for an example would get a positive (negative) bias if the correct (incorrect) answer is shorter. Similarly, the score across a set of examples would weigh examples with shorter answers more strongly.</p>
</div>
<div class="ltx_para" id="S3.SS2.SSS2.p6">
<p class="ltx_p" id="S3.SS2.SSS2.p6.10">Another aspect of the DPO metric that is worth considering is that by using this metric to optimize the retriever, we are effectively fine-tuning a model. Consider the LLM model <math alttext="p_{M}(a\mid q)" class="ltx_Math" display="inline" id="S3.SS2.SSS2.p6.1.m1.1"><semantics id="S3.SS2.SSS2.p6.1.m1.1a"><mrow id="S3.SS2.SSS2.p6.1.m1.1.1" xref="S3.SS2.SSS2.p6.1.m1.1.1.cmml"><msub id="S3.SS2.SSS2.p6.1.m1.1.1.3" xref="S3.SS2.SSS2.p6.1.m1.1.1.3.cmml"><mi id="S3.SS2.SSS2.p6.1.m1.1.1.3.2" xref="S3.SS2.SSS2.p6.1.m1.1.1.3.2.cmml">p</mi><mi id="S3.SS2.SSS2.p6.1.m1.1.1.3.3" xref="S3.SS2.SSS2.p6.1.m1.1.1.3.3.cmml">M</mi></msub><mo id="S3.SS2.SSS2.p6.1.m1.1.1.2" xref="S3.SS2.SSS2.p6.1.m1.1.1.2.cmml">⁢</mo><mrow id="S3.SS2.SSS2.p6.1.m1.1.1.1.1" xref="S3.SS2.SSS2.p6.1.m1.1.1.1.1.1.cmml"><mo id="S3.SS2.SSS2.p6.1.m1.1.1.1.1.2" stretchy="false" xref="S3.SS2.SSS2.p6.1.m1.1.1.1.1.1.cmml">(</mo><mrow id="S3.SS2.SSS2.p6.1.m1.1.1.1.1.1" xref="S3.SS2.SSS2.p6.1.m1.1.1.1.1.1.cmml"><mi id="S3.SS2.SSS2.p6.1.m1.1.1.1.1.1.2" xref="S3.SS2.SSS2.p6.1.m1.1.1.1.1.1.2.cmml">a</mi><mo id="S3.SS2.SSS2.p6.1.m1.1.1.1.1.1.1" xref="S3.SS2.SSS2.p6.1.m1.1.1.1.1.1.1.cmml">∣</mo><mi id="S3.SS2.SSS2.p6.1.m1.1.1.1.1.1.3" xref="S3.SS2.SSS2.p6.1.m1.1.1.1.1.1.3.cmml">q</mi></mrow><mo id="S3.SS2.SSS2.p6.1.m1.1.1.1.1.3" stretchy="false" xref="S3.SS2.SSS2.p6.1.m1.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS2.p6.1.m1.1b"><apply id="S3.SS2.SSS2.p6.1.m1.1.1.cmml" xref="S3.SS2.SSS2.p6.1.m1.1.1"><times id="S3.SS2.SSS2.p6.1.m1.1.1.2.cmml" xref="S3.SS2.SSS2.p6.1.m1.1.1.2"></times><apply id="S3.SS2.SSS2.p6.1.m1.1.1.3.cmml" xref="S3.SS2.SSS2.p6.1.m1.1.1.3"><csymbol cd="ambiguous" id="S3.SS2.SSS2.p6.1.m1.1.1.3.1.cmml" xref="S3.SS2.SSS2.p6.1.m1.1.1.3">subscript</csymbol><ci id="S3.SS2.SSS2.p6.1.m1.1.1.3.2.cmml" xref="S3.SS2.SSS2.p6.1.m1.1.1.3.2">𝑝</ci><ci id="S3.SS2.SSS2.p6.1.m1.1.1.3.3.cmml" xref="S3.SS2.SSS2.p6.1.m1.1.1.3.3">𝑀</ci></apply><apply id="S3.SS2.SSS2.p6.1.m1.1.1.1.1.1.cmml" xref="S3.SS2.SSS2.p6.1.m1.1.1.1.1"><csymbol cd="latexml" id="S3.SS2.SSS2.p6.1.m1.1.1.1.1.1.1.cmml" xref="S3.SS2.SSS2.p6.1.m1.1.1.1.1.1.1">conditional</csymbol><ci id="S3.SS2.SSS2.p6.1.m1.1.1.1.1.1.2.cmml" xref="S3.SS2.SSS2.p6.1.m1.1.1.1.1.1.2">𝑎</ci><ci id="S3.SS2.SSS2.p6.1.m1.1.1.1.1.1.3.cmml" xref="S3.SS2.SSS2.p6.1.m1.1.1.1.1.1.3">𝑞</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS2.p6.1.m1.1c">p_{M}(a\mid q)</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS2.p6.1.m1.1d">italic_p start_POSTSUBSCRIPT italic_M end_POSTSUBSCRIPT ( italic_a ∣ italic_q )</annotation></semantics></math> which assigns a probability of a generation <math alttext="a" class="ltx_Math" display="inline" id="S3.SS2.SSS2.p6.2.m2.1"><semantics id="S3.SS2.SSS2.p6.2.m2.1a"><mi id="S3.SS2.SSS2.p6.2.m2.1.1" xref="S3.SS2.SSS2.p6.2.m2.1.1.cmml">a</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS2.p6.2.m2.1b"><ci id="S3.SS2.SSS2.p6.2.m2.1.1.cmml" xref="S3.SS2.SSS2.p6.2.m2.1.1">𝑎</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS2.p6.2.m2.1c">a</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS2.p6.2.m2.1d">italic_a</annotation></semantics></math> given a prompt <math alttext="q" class="ltx_Math" display="inline" id="S3.SS2.SSS2.p6.3.m3.1"><semantics id="S3.SS2.SSS2.p6.3.m3.1a"><mi id="S3.SS2.SSS2.p6.3.m3.1.1" xref="S3.SS2.SSS2.p6.3.m3.1.1.cmml">q</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS2.p6.3.m3.1b"><ci id="S3.SS2.SSS2.p6.3.m3.1.1.cmml" xref="S3.SS2.SSS2.p6.3.m3.1.1">𝑞</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS2.p6.3.m3.1c">q</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS2.p6.3.m3.1d">italic_q</annotation></semantics></math>. Now consider another model <math alttext="p_{M}^{\prime}(a\mid q^{\prime})" class="ltx_Math" display="inline" id="S3.SS2.SSS2.p6.4.m4.1"><semantics id="S3.SS2.SSS2.p6.4.m4.1a"><mrow id="S3.SS2.SSS2.p6.4.m4.1.1" xref="S3.SS2.SSS2.p6.4.m4.1.1.cmml"><msubsup id="S3.SS2.SSS2.p6.4.m4.1.1.3" xref="S3.SS2.SSS2.p6.4.m4.1.1.3.cmml"><mi id="S3.SS2.SSS2.p6.4.m4.1.1.3.2.2" xref="S3.SS2.SSS2.p6.4.m4.1.1.3.2.2.cmml">p</mi><mi id="S3.SS2.SSS2.p6.4.m4.1.1.3.2.3" xref="S3.SS2.SSS2.p6.4.m4.1.1.3.2.3.cmml">M</mi><mo id="S3.SS2.SSS2.p6.4.m4.1.1.3.3" xref="S3.SS2.SSS2.p6.4.m4.1.1.3.3.cmml">′</mo></msubsup><mo id="S3.SS2.SSS2.p6.4.m4.1.1.2" xref="S3.SS2.SSS2.p6.4.m4.1.1.2.cmml">⁢</mo><mrow id="S3.SS2.SSS2.p6.4.m4.1.1.1.1" xref="S3.SS2.SSS2.p6.4.m4.1.1.1.1.1.cmml"><mo id="S3.SS2.SSS2.p6.4.m4.1.1.1.1.2" stretchy="false" xref="S3.SS2.SSS2.p6.4.m4.1.1.1.1.1.cmml">(</mo><mrow id="S3.SS2.SSS2.p6.4.m4.1.1.1.1.1" xref="S3.SS2.SSS2.p6.4.m4.1.1.1.1.1.cmml"><mi id="S3.SS2.SSS2.p6.4.m4.1.1.1.1.1.2" xref="S3.SS2.SSS2.p6.4.m4.1.1.1.1.1.2.cmml">a</mi><mo id="S3.SS2.SSS2.p6.4.m4.1.1.1.1.1.1" xref="S3.SS2.SSS2.p6.4.m4.1.1.1.1.1.1.cmml">∣</mo><msup id="S3.SS2.SSS2.p6.4.m4.1.1.1.1.1.3" xref="S3.SS2.SSS2.p6.4.m4.1.1.1.1.1.3.cmml"><mi id="S3.SS2.SSS2.p6.4.m4.1.1.1.1.1.3.2" xref="S3.SS2.SSS2.p6.4.m4.1.1.1.1.1.3.2.cmml">q</mi><mo id="S3.SS2.SSS2.p6.4.m4.1.1.1.1.1.3.3" xref="S3.SS2.SSS2.p6.4.m4.1.1.1.1.1.3.3.cmml">′</mo></msup></mrow><mo id="S3.SS2.SSS2.p6.4.m4.1.1.1.1.3" stretchy="false" xref="S3.SS2.SSS2.p6.4.m4.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS2.p6.4.m4.1b"><apply id="S3.SS2.SSS2.p6.4.m4.1.1.cmml" xref="S3.SS2.SSS2.p6.4.m4.1.1"><times id="S3.SS2.SSS2.p6.4.m4.1.1.2.cmml" xref="S3.SS2.SSS2.p6.4.m4.1.1.2"></times><apply id="S3.SS2.SSS2.p6.4.m4.1.1.3.cmml" xref="S3.SS2.SSS2.p6.4.m4.1.1.3"><csymbol cd="ambiguous" id="S3.SS2.SSS2.p6.4.m4.1.1.3.1.cmml" xref="S3.SS2.SSS2.p6.4.m4.1.1.3">superscript</csymbol><apply id="S3.SS2.SSS2.p6.4.m4.1.1.3.2.cmml" xref="S3.SS2.SSS2.p6.4.m4.1.1.3"><csymbol cd="ambiguous" id="S3.SS2.SSS2.p6.4.m4.1.1.3.2.1.cmml" xref="S3.SS2.SSS2.p6.4.m4.1.1.3">subscript</csymbol><ci id="S3.SS2.SSS2.p6.4.m4.1.1.3.2.2.cmml" xref="S3.SS2.SSS2.p6.4.m4.1.1.3.2.2">𝑝</ci><ci id="S3.SS2.SSS2.p6.4.m4.1.1.3.2.3.cmml" xref="S3.SS2.SSS2.p6.4.m4.1.1.3.2.3">𝑀</ci></apply><ci id="S3.SS2.SSS2.p6.4.m4.1.1.3.3.cmml" xref="S3.SS2.SSS2.p6.4.m4.1.1.3.3">′</ci></apply><apply id="S3.SS2.SSS2.p6.4.m4.1.1.1.1.1.cmml" xref="S3.SS2.SSS2.p6.4.m4.1.1.1.1"><csymbol cd="latexml" id="S3.SS2.SSS2.p6.4.m4.1.1.1.1.1.1.cmml" xref="S3.SS2.SSS2.p6.4.m4.1.1.1.1.1.1">conditional</csymbol><ci id="S3.SS2.SSS2.p6.4.m4.1.1.1.1.1.2.cmml" xref="S3.SS2.SSS2.p6.4.m4.1.1.1.1.1.2">𝑎</ci><apply id="S3.SS2.SSS2.p6.4.m4.1.1.1.1.1.3.cmml" xref="S3.SS2.SSS2.p6.4.m4.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.SS2.SSS2.p6.4.m4.1.1.1.1.1.3.1.cmml" xref="S3.SS2.SSS2.p6.4.m4.1.1.1.1.1.3">superscript</csymbol><ci id="S3.SS2.SSS2.p6.4.m4.1.1.1.1.1.3.2.cmml" xref="S3.SS2.SSS2.p6.4.m4.1.1.1.1.1.3.2">𝑞</ci><ci id="S3.SS2.SSS2.p6.4.m4.1.1.1.1.1.3.3.cmml" xref="S3.SS2.SSS2.p6.4.m4.1.1.1.1.1.3.3">′</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS2.p6.4.m4.1c">p_{M}^{\prime}(a\mid q^{\prime})</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS2.p6.4.m4.1d">italic_p start_POSTSUBSCRIPT italic_M end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT ( italic_a ∣ italic_q start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT )</annotation></semantics></math>, where <math alttext="q^{\prime}=R(q)" class="ltx_Math" display="inline" id="S3.SS2.SSS2.p6.5.m5.1"><semantics id="S3.SS2.SSS2.p6.5.m5.1a"><mrow id="S3.SS2.SSS2.p6.5.m5.1.2" xref="S3.SS2.SSS2.p6.5.m5.1.2.cmml"><msup id="S3.SS2.SSS2.p6.5.m5.1.2.2" xref="S3.SS2.SSS2.p6.5.m5.1.2.2.cmml"><mi id="S3.SS2.SSS2.p6.5.m5.1.2.2.2" xref="S3.SS2.SSS2.p6.5.m5.1.2.2.2.cmml">q</mi><mo id="S3.SS2.SSS2.p6.5.m5.1.2.2.3" xref="S3.SS2.SSS2.p6.5.m5.1.2.2.3.cmml">′</mo></msup><mo id="S3.SS2.SSS2.p6.5.m5.1.2.1" xref="S3.SS2.SSS2.p6.5.m5.1.2.1.cmml">=</mo><mrow id="S3.SS2.SSS2.p6.5.m5.1.2.3" xref="S3.SS2.SSS2.p6.5.m5.1.2.3.cmml"><mi id="S3.SS2.SSS2.p6.5.m5.1.2.3.2" xref="S3.SS2.SSS2.p6.5.m5.1.2.3.2.cmml">R</mi><mo id="S3.SS2.SSS2.p6.5.m5.1.2.3.1" xref="S3.SS2.SSS2.p6.5.m5.1.2.3.1.cmml">⁢</mo><mrow id="S3.SS2.SSS2.p6.5.m5.1.2.3.3.2" xref="S3.SS2.SSS2.p6.5.m5.1.2.3.cmml"><mo id="S3.SS2.SSS2.p6.5.m5.1.2.3.3.2.1" stretchy="false" xref="S3.SS2.SSS2.p6.5.m5.1.2.3.cmml">(</mo><mi id="S3.SS2.SSS2.p6.5.m5.1.1" xref="S3.SS2.SSS2.p6.5.m5.1.1.cmml">q</mi><mo id="S3.SS2.SSS2.p6.5.m5.1.2.3.3.2.2" stretchy="false" xref="S3.SS2.SSS2.p6.5.m5.1.2.3.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS2.p6.5.m5.1b"><apply id="S3.SS2.SSS2.p6.5.m5.1.2.cmml" xref="S3.SS2.SSS2.p6.5.m5.1.2"><eq id="S3.SS2.SSS2.p6.5.m5.1.2.1.cmml" xref="S3.SS2.SSS2.p6.5.m5.1.2.1"></eq><apply id="S3.SS2.SSS2.p6.5.m5.1.2.2.cmml" xref="S3.SS2.SSS2.p6.5.m5.1.2.2"><csymbol cd="ambiguous" id="S3.SS2.SSS2.p6.5.m5.1.2.2.1.cmml" xref="S3.SS2.SSS2.p6.5.m5.1.2.2">superscript</csymbol><ci id="S3.SS2.SSS2.p6.5.m5.1.2.2.2.cmml" xref="S3.SS2.SSS2.p6.5.m5.1.2.2.2">𝑞</ci><ci id="S3.SS2.SSS2.p6.5.m5.1.2.2.3.cmml" xref="S3.SS2.SSS2.p6.5.m5.1.2.2.3">′</ci></apply><apply id="S3.SS2.SSS2.p6.5.m5.1.2.3.cmml" xref="S3.SS2.SSS2.p6.5.m5.1.2.3"><times id="S3.SS2.SSS2.p6.5.m5.1.2.3.1.cmml" xref="S3.SS2.SSS2.p6.5.m5.1.2.3.1"></times><ci id="S3.SS2.SSS2.p6.5.m5.1.2.3.2.cmml" xref="S3.SS2.SSS2.p6.5.m5.1.2.3.2">𝑅</ci><ci id="S3.SS2.SSS2.p6.5.m5.1.1.cmml" xref="S3.SS2.SSS2.p6.5.m5.1.1">𝑞</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS2.p6.5.m5.1c">q^{\prime}=R(q)</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS2.p6.5.m5.1d">italic_q start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT = italic_R ( italic_q )</annotation></semantics></math>. From this perspective, we can consider that <math alttext="p_{M}^{\prime}" class="ltx_Math" display="inline" id="S3.SS2.SSS2.p6.6.m6.1"><semantics id="S3.SS2.SSS2.p6.6.m6.1a"><msubsup id="S3.SS2.SSS2.p6.6.m6.1.1" xref="S3.SS2.SSS2.p6.6.m6.1.1.cmml"><mi id="S3.SS2.SSS2.p6.6.m6.1.1.2.2" xref="S3.SS2.SSS2.p6.6.m6.1.1.2.2.cmml">p</mi><mi id="S3.SS2.SSS2.p6.6.m6.1.1.2.3" xref="S3.SS2.SSS2.p6.6.m6.1.1.2.3.cmml">M</mi><mo id="S3.SS2.SSS2.p6.6.m6.1.1.3" xref="S3.SS2.SSS2.p6.6.m6.1.1.3.cmml">′</mo></msubsup><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS2.p6.6.m6.1b"><apply id="S3.SS2.SSS2.p6.6.m6.1.1.cmml" xref="S3.SS2.SSS2.p6.6.m6.1.1"><csymbol cd="ambiguous" id="S3.SS2.SSS2.p6.6.m6.1.1.1.cmml" xref="S3.SS2.SSS2.p6.6.m6.1.1">superscript</csymbol><apply id="S3.SS2.SSS2.p6.6.m6.1.1.2.cmml" xref="S3.SS2.SSS2.p6.6.m6.1.1"><csymbol cd="ambiguous" id="S3.SS2.SSS2.p6.6.m6.1.1.2.1.cmml" xref="S3.SS2.SSS2.p6.6.m6.1.1">subscript</csymbol><ci id="S3.SS2.SSS2.p6.6.m6.1.1.2.2.cmml" xref="S3.SS2.SSS2.p6.6.m6.1.1.2.2">𝑝</ci><ci id="S3.SS2.SSS2.p6.6.m6.1.1.2.3.cmml" xref="S3.SS2.SSS2.p6.6.m6.1.1.2.3">𝑀</ci></apply><ci id="S3.SS2.SSS2.p6.6.m6.1.1.3.cmml" xref="S3.SS2.SSS2.p6.6.m6.1.1.3">′</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS2.p6.6.m6.1c">p_{M}^{\prime}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS2.p6.6.m6.1d">italic_p start_POSTSUBSCRIPT italic_M end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT</annotation></semantics></math> is functionally the same as <math alttext="p_{M}" class="ltx_Math" display="inline" id="S3.SS2.SSS2.p6.7.m7.1"><semantics id="S3.SS2.SSS2.p6.7.m7.1a"><msub id="S3.SS2.SSS2.p6.7.m7.1.1" xref="S3.SS2.SSS2.p6.7.m7.1.1.cmml"><mi id="S3.SS2.SSS2.p6.7.m7.1.1.2" xref="S3.SS2.SSS2.p6.7.m7.1.1.2.cmml">p</mi><mi id="S3.SS2.SSS2.p6.7.m7.1.1.3" xref="S3.SS2.SSS2.p6.7.m7.1.1.3.cmml">M</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS2.p6.7.m7.1b"><apply id="S3.SS2.SSS2.p6.7.m7.1.1.cmml" xref="S3.SS2.SSS2.p6.7.m7.1.1"><csymbol cd="ambiguous" id="S3.SS2.SSS2.p6.7.m7.1.1.1.cmml" xref="S3.SS2.SSS2.p6.7.m7.1.1">subscript</csymbol><ci id="S3.SS2.SSS2.p6.7.m7.1.1.2.cmml" xref="S3.SS2.SSS2.p6.7.m7.1.1.2">𝑝</ci><ci id="S3.SS2.SSS2.p6.7.m7.1.1.3.cmml" xref="S3.SS2.SSS2.p6.7.m7.1.1.3">𝑀</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS2.p6.7.m7.1c">p_{M}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS2.p6.7.m7.1d">italic_p start_POSTSUBSCRIPT italic_M end_POSTSUBSCRIPT</annotation></semantics></math> but with added parameters arising from <math alttext="R" class="ltx_Math" display="inline" id="S3.SS2.SSS2.p6.8.m8.1"><semantics id="S3.SS2.SSS2.p6.8.m8.1a"><mi id="S3.SS2.SSS2.p6.8.m8.1.1" xref="S3.SS2.SSS2.p6.8.m8.1.1.cmml">R</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS2.p6.8.m8.1b"><ci id="S3.SS2.SSS2.p6.8.m8.1.1.cmml" xref="S3.SS2.SSS2.p6.8.m8.1.1">𝑅</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS2.p6.8.m8.1c">R</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS2.p6.8.m8.1d">italic_R</annotation></semantics></math>. And so, by finding a retriever <math alttext="R" class="ltx_Math" display="inline" id="S3.SS2.SSS2.p6.9.m9.1"><semantics id="S3.SS2.SSS2.p6.9.m9.1a"><mi id="S3.SS2.SSS2.p6.9.m9.1.1" xref="S3.SS2.SSS2.p6.9.m9.1.1.cmml">R</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS2.p6.9.m9.1b"><ci id="S3.SS2.SSS2.p6.9.m9.1.1.cmml" xref="S3.SS2.SSS2.p6.9.m9.1.1">𝑅</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS2.p6.9.m9.1c">R</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS2.p6.9.m9.1d">italic_R</annotation></semantics></math> which maximizes the DPO metric, we are in effect fine-tuning the model <math alttext="p_{M}^{\prime}" class="ltx_Math" display="inline" id="S3.SS2.SSS2.p6.10.m10.1"><semantics id="S3.SS2.SSS2.p6.10.m10.1a"><msubsup id="S3.SS2.SSS2.p6.10.m10.1.1" xref="S3.SS2.SSS2.p6.10.m10.1.1.cmml"><mi id="S3.SS2.SSS2.p6.10.m10.1.1.2.2" xref="S3.SS2.SSS2.p6.10.m10.1.1.2.2.cmml">p</mi><mi id="S3.SS2.SSS2.p6.10.m10.1.1.2.3" xref="S3.SS2.SSS2.p6.10.m10.1.1.2.3.cmml">M</mi><mo id="S3.SS2.SSS2.p6.10.m10.1.1.3" xref="S3.SS2.SSS2.p6.10.m10.1.1.3.cmml">′</mo></msubsup><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS2.p6.10.m10.1b"><apply id="S3.SS2.SSS2.p6.10.m10.1.1.cmml" xref="S3.SS2.SSS2.p6.10.m10.1.1"><csymbol cd="ambiguous" id="S3.SS2.SSS2.p6.10.m10.1.1.1.cmml" xref="S3.SS2.SSS2.p6.10.m10.1.1">superscript</csymbol><apply id="S3.SS2.SSS2.p6.10.m10.1.1.2.cmml" xref="S3.SS2.SSS2.p6.10.m10.1.1"><csymbol cd="ambiguous" id="S3.SS2.SSS2.p6.10.m10.1.1.2.1.cmml" xref="S3.SS2.SSS2.p6.10.m10.1.1">subscript</csymbol><ci id="S3.SS2.SSS2.p6.10.m10.1.1.2.2.cmml" xref="S3.SS2.SSS2.p6.10.m10.1.1.2.2">𝑝</ci><ci id="S3.SS2.SSS2.p6.10.m10.1.1.2.3.cmml" xref="S3.SS2.SSS2.p6.10.m10.1.1.2.3">𝑀</ci></apply><ci id="S3.SS2.SSS2.p6.10.m10.1.1.3.cmml" xref="S3.SS2.SSS2.p6.10.m10.1.1.3">′</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS2.p6.10.m10.1c">p_{M}^{\prime}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS2.p6.10.m10.1d">italic_p start_POSTSUBSCRIPT italic_M end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT</annotation></semantics></math>.</p>
</div>
</section>
</section>
<section class="ltx_subsection" id="S3.SS3">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.3 </span>Retrieval Algorithm</h3>
<div class="ltx_para" id="S3.SS3.p1">
<p class="ltx_p" id="S3.SS3.p1.1">This section details the core algorithm employed for few-shot demonstration retrieval, which leverages a greedy strategy to maximize a combination of three key scores: query relevance, demonstration diversity, and demonstration quality bias.
The full retrieval algorithm is presented in Algorithm <a class="ltx_ref" href="https://arxiv.org/html/2405.17587v2#alg1" title="Algorithm 1 ‣ 3.3.3 Demonstration Quality Bias ‣ 3.3 Retrieval Algorithm ‣ 3 Methodology ‣ RAGSys: Item-Cold-Start Recommender as RAG System"><span class="ltx_text ltx_ref_tag">1</span></a>.</p>
</div>
<section class="ltx_subsubsection" id="S3.SS3.SSS1">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">3.3.1 </span>Query Relevance</h4>
<div class="ltx_para" id="S3.SS3.SSS1.p1">
<p class="ltx_p" id="S3.SS3.SSS1.p1.1">The relevance score between the query and each candidate demonstration is calculated using the cosine similarity of their respective <code class="ltx_verbatim ltx_font_typewriter" id="S3.SS3.SSS1.p1.1.1">BERT</code> embeddings <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2405.17587v2#bib.bib21" title="">21</a>]</cite>. By computing the cosine similarity between the query embedding and the embedding of each demonstration’s query, we obtain a score that reflects the topical similarity and semantic alignment between the query and the candidate demonstration.</p>
</div>
</section>
<section class="ltx_subsubsection" id="S3.SS3.SSS2">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">3.3.2 </span>Retrieved Demonstrations Diversity</h4>
<div class="ltx_para" id="S3.SS3.SSS2.p1">
<p class="ltx_p" id="S3.SS3.SSS2.p1.2">To promote diversity in the retrieved demonstrations and avoid redundancy, we incorporate the Maximal Marginal Relevance (MMR) algorithm. MMR iteratively selects the items that maximizes the combined score of relevance to the query and dissimilarity to the previously chosen items. This ensures a balance between retrieving relevant items and ensuring they cover a variety of information. A parameter, <math alttext="\lambda_{d}" class="ltx_Math" display="inline" id="S3.SS3.SSS2.p1.1.m1.1"><semantics id="S3.SS3.SSS2.p1.1.m1.1a"><msub id="S3.SS3.SSS2.p1.1.m1.1.1" xref="S3.SS3.SSS2.p1.1.m1.1.1.cmml"><mi id="S3.SS3.SSS2.p1.1.m1.1.1.2" xref="S3.SS3.SSS2.p1.1.m1.1.1.2.cmml">λ</mi><mi id="S3.SS3.SSS2.p1.1.m1.1.1.3" xref="S3.SS3.SSS2.p1.1.m1.1.1.3.cmml">d</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS2.p1.1.m1.1b"><apply id="S3.SS3.SSS2.p1.1.m1.1.1.cmml" xref="S3.SS3.SSS2.p1.1.m1.1.1"><csymbol cd="ambiguous" id="S3.SS3.SSS2.p1.1.m1.1.1.1.cmml" xref="S3.SS3.SSS2.p1.1.m1.1.1">subscript</csymbol><ci id="S3.SS3.SSS2.p1.1.m1.1.1.2.cmml" xref="S3.SS3.SSS2.p1.1.m1.1.1.2">𝜆</ci><ci id="S3.SS3.SSS2.p1.1.m1.1.1.3.cmml" xref="S3.SS3.SSS2.p1.1.m1.1.1.3">𝑑</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS2.p1.1.m1.1c">\lambda_{d}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.SSS2.p1.1.m1.1d">italic_λ start_POSTSUBSCRIPT italic_d end_POSTSUBSCRIPT</annotation></semantics></math>, is used to control the trade-off between relevance and diversity. Higher values of <math alttext="\lambda_{d}" class="ltx_Math" display="inline" id="S3.SS3.SSS2.p1.2.m2.1"><semantics id="S3.SS3.SSS2.p1.2.m2.1a"><msub id="S3.SS3.SSS2.p1.2.m2.1.1" xref="S3.SS3.SSS2.p1.2.m2.1.1.cmml"><mi id="S3.SS3.SSS2.p1.2.m2.1.1.2" xref="S3.SS3.SSS2.p1.2.m2.1.1.2.cmml">λ</mi><mi id="S3.SS3.SSS2.p1.2.m2.1.1.3" xref="S3.SS3.SSS2.p1.2.m2.1.1.3.cmml">d</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS2.p1.2.m2.1b"><apply id="S3.SS3.SSS2.p1.2.m2.1.1.cmml" xref="S3.SS3.SSS2.p1.2.m2.1.1"><csymbol cd="ambiguous" id="S3.SS3.SSS2.p1.2.m2.1.1.1.cmml" xref="S3.SS3.SSS2.p1.2.m2.1.1">subscript</csymbol><ci id="S3.SS3.SSS2.p1.2.m2.1.1.2.cmml" xref="S3.SS3.SSS2.p1.2.m2.1.1.2">𝜆</ci><ci id="S3.SS3.SSS2.p1.2.m2.1.1.3.cmml" xref="S3.SS3.SSS2.p1.2.m2.1.1.3">𝑑</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS2.p1.2.m2.1c">\lambda_{d}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.SSS2.p1.2.m2.1d">italic_λ start_POSTSUBSCRIPT italic_d end_POSTSUBSCRIPT</annotation></semantics></math> prioritize relevance, whereas lower values prioritize diversity.</p>
</div>
</section>
<section class="ltx_subsubsection" id="S3.SS3.SSS3">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">3.3.3 </span>Demonstration Quality Bias</h4>
<div class="ltx_para" id="S3.SS3.SSS3.p1">
<p class="ltx_p" id="S3.SS3.SSS3.p1.2">While the pre-trained <code class="ltx_verbatim ltx_font_typewriter" id="S3.SS3.SSS3.p1.2.1">BERT</code> embeddings capture semantic relationships, they do not inherently account for the quality of the few-shot demonstrations. To address this, we explicitly introduce a demonstration quality bias term related to the popularity of an item in a training dataset. This score is computed using the log perplexity of the demonstration answer <math alttext="a" class="ltx_Math" display="inline" id="S3.SS3.SSS3.p1.1.m1.1"><semantics id="S3.SS3.SSS3.p1.1.m1.1a"><mi id="S3.SS3.SSS3.p1.1.m1.1.1" xref="S3.SS3.SSS3.p1.1.m1.1.1.cmml">a</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS3.p1.1.m1.1b"><ci id="S3.SS3.SSS3.p1.1.m1.1.1.cmml" xref="S3.SS3.SSS3.p1.1.m1.1.1">𝑎</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS3.p1.1.m1.1c">a</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.SSS3.p1.1.m1.1d">italic_a</annotation></semantics></math>, given the demonstration question <math alttext="q" class="ltx_Math" display="inline" id="S3.SS3.SSS3.p1.2.m2.1"><semantics id="S3.SS3.SSS3.p1.2.m2.1a"><mi id="S3.SS3.SSS3.p1.2.m2.1.1" xref="S3.SS3.SSS3.p1.2.m2.1.1.cmml">q</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS3.p1.2.m2.1b"><ci id="S3.SS3.SSS3.p1.2.m2.1.1.cmml" xref="S3.SS3.SSS3.p1.2.m2.1.1">𝑞</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS3.p1.2.m2.1c">q</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.SSS3.p1.2.m2.1d">italic_q</annotation></semantics></math>.</p>
<table class="ltx_equation ltx_eqn_table" id="S3.Ex9">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\frac{1}{|a|}\sum_{a_{i}\in a}\log p_{M}(a_{i}\mid q)" class="ltx_Math" display="block" id="S3.Ex9.m1.2"><semantics id="S3.Ex9.m1.2a"><mrow id="S3.Ex9.m1.2.2" xref="S3.Ex9.m1.2.2.cmml"><mfrac id="S3.Ex9.m1.1.1" xref="S3.Ex9.m1.1.1.cmml"><mn id="S3.Ex9.m1.1.1.3" xref="S3.Ex9.m1.1.1.3.cmml">1</mn><mrow id="S3.Ex9.m1.1.1.1.3" xref="S3.Ex9.m1.1.1.1.2.cmml"><mo id="S3.Ex9.m1.1.1.1.3.1" stretchy="false" xref="S3.Ex9.m1.1.1.1.2.1.cmml">|</mo><mi id="S3.Ex9.m1.1.1.1.1" xref="S3.Ex9.m1.1.1.1.1.cmml">a</mi><mo id="S3.Ex9.m1.1.1.1.3.2" stretchy="false" xref="S3.Ex9.m1.1.1.1.2.1.cmml">|</mo></mrow></mfrac><mo id="S3.Ex9.m1.2.2.2" xref="S3.Ex9.m1.2.2.2.cmml">⁢</mo><mrow id="S3.Ex9.m1.2.2.1" xref="S3.Ex9.m1.2.2.1.cmml"><munder id="S3.Ex9.m1.2.2.1.2" xref="S3.Ex9.m1.2.2.1.2.cmml"><mo id="S3.Ex9.m1.2.2.1.2.2" movablelimits="false" xref="S3.Ex9.m1.2.2.1.2.2.cmml">∑</mo><mrow id="S3.Ex9.m1.2.2.1.2.3" xref="S3.Ex9.m1.2.2.1.2.3.cmml"><msub id="S3.Ex9.m1.2.2.1.2.3.2" xref="S3.Ex9.m1.2.2.1.2.3.2.cmml"><mi id="S3.Ex9.m1.2.2.1.2.3.2.2" xref="S3.Ex9.m1.2.2.1.2.3.2.2.cmml">a</mi><mi id="S3.Ex9.m1.2.2.1.2.3.2.3" xref="S3.Ex9.m1.2.2.1.2.3.2.3.cmml">i</mi></msub><mo id="S3.Ex9.m1.2.2.1.2.3.1" xref="S3.Ex9.m1.2.2.1.2.3.1.cmml">∈</mo><mi id="S3.Ex9.m1.2.2.1.2.3.3" xref="S3.Ex9.m1.2.2.1.2.3.3.cmml">a</mi></mrow></munder><mrow id="S3.Ex9.m1.2.2.1.1" xref="S3.Ex9.m1.2.2.1.1.cmml"><mrow id="S3.Ex9.m1.2.2.1.1.3" xref="S3.Ex9.m1.2.2.1.1.3.cmml"><mi id="S3.Ex9.m1.2.2.1.1.3.1" xref="S3.Ex9.m1.2.2.1.1.3.1.cmml">log</mi><mo id="S3.Ex9.m1.2.2.1.1.3a" lspace="0.167em" xref="S3.Ex9.m1.2.2.1.1.3.cmml">⁡</mo><msub id="S3.Ex9.m1.2.2.1.1.3.2" xref="S3.Ex9.m1.2.2.1.1.3.2.cmml"><mi id="S3.Ex9.m1.2.2.1.1.3.2.2" xref="S3.Ex9.m1.2.2.1.1.3.2.2.cmml">p</mi><mi id="S3.Ex9.m1.2.2.1.1.3.2.3" xref="S3.Ex9.m1.2.2.1.1.3.2.3.cmml">M</mi></msub></mrow><mo id="S3.Ex9.m1.2.2.1.1.2" xref="S3.Ex9.m1.2.2.1.1.2.cmml">⁢</mo><mrow id="S3.Ex9.m1.2.2.1.1.1.1" xref="S3.Ex9.m1.2.2.1.1.1.1.1.cmml"><mo id="S3.Ex9.m1.2.2.1.1.1.1.2" stretchy="false" xref="S3.Ex9.m1.2.2.1.1.1.1.1.cmml">(</mo><mrow id="S3.Ex9.m1.2.2.1.1.1.1.1" xref="S3.Ex9.m1.2.2.1.1.1.1.1.cmml"><msub id="S3.Ex9.m1.2.2.1.1.1.1.1.2" xref="S3.Ex9.m1.2.2.1.1.1.1.1.2.cmml"><mi id="S3.Ex9.m1.2.2.1.1.1.1.1.2.2" xref="S3.Ex9.m1.2.2.1.1.1.1.1.2.2.cmml">a</mi><mi id="S3.Ex9.m1.2.2.1.1.1.1.1.2.3" xref="S3.Ex9.m1.2.2.1.1.1.1.1.2.3.cmml">i</mi></msub><mo id="S3.Ex9.m1.2.2.1.1.1.1.1.1" xref="S3.Ex9.m1.2.2.1.1.1.1.1.1.cmml">∣</mo><mi id="S3.Ex9.m1.2.2.1.1.1.1.1.3" xref="S3.Ex9.m1.2.2.1.1.1.1.1.3.cmml">q</mi></mrow><mo id="S3.Ex9.m1.2.2.1.1.1.1.3" stretchy="false" xref="S3.Ex9.m1.2.2.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.Ex9.m1.2b"><apply id="S3.Ex9.m1.2.2.cmml" xref="S3.Ex9.m1.2.2"><times id="S3.Ex9.m1.2.2.2.cmml" xref="S3.Ex9.m1.2.2.2"></times><apply id="S3.Ex9.m1.1.1.cmml" xref="S3.Ex9.m1.1.1"><divide id="S3.Ex9.m1.1.1.2.cmml" xref="S3.Ex9.m1.1.1"></divide><cn id="S3.Ex9.m1.1.1.3.cmml" type="integer" xref="S3.Ex9.m1.1.1.3">1</cn><apply id="S3.Ex9.m1.1.1.1.2.cmml" xref="S3.Ex9.m1.1.1.1.3"><abs id="S3.Ex9.m1.1.1.1.2.1.cmml" xref="S3.Ex9.m1.1.1.1.3.1"></abs><ci id="S3.Ex9.m1.1.1.1.1.cmml" xref="S3.Ex9.m1.1.1.1.1">𝑎</ci></apply></apply><apply id="S3.Ex9.m1.2.2.1.cmml" xref="S3.Ex9.m1.2.2.1"><apply id="S3.Ex9.m1.2.2.1.2.cmml" xref="S3.Ex9.m1.2.2.1.2"><csymbol cd="ambiguous" id="S3.Ex9.m1.2.2.1.2.1.cmml" xref="S3.Ex9.m1.2.2.1.2">subscript</csymbol><sum id="S3.Ex9.m1.2.2.1.2.2.cmml" xref="S3.Ex9.m1.2.2.1.2.2"></sum><apply id="S3.Ex9.m1.2.2.1.2.3.cmml" xref="S3.Ex9.m1.2.2.1.2.3"><in id="S3.Ex9.m1.2.2.1.2.3.1.cmml" xref="S3.Ex9.m1.2.2.1.2.3.1"></in><apply id="S3.Ex9.m1.2.2.1.2.3.2.cmml" xref="S3.Ex9.m1.2.2.1.2.3.2"><csymbol cd="ambiguous" id="S3.Ex9.m1.2.2.1.2.3.2.1.cmml" xref="S3.Ex9.m1.2.2.1.2.3.2">subscript</csymbol><ci id="S3.Ex9.m1.2.2.1.2.3.2.2.cmml" xref="S3.Ex9.m1.2.2.1.2.3.2.2">𝑎</ci><ci id="S3.Ex9.m1.2.2.1.2.3.2.3.cmml" xref="S3.Ex9.m1.2.2.1.2.3.2.3">𝑖</ci></apply><ci id="S3.Ex9.m1.2.2.1.2.3.3.cmml" xref="S3.Ex9.m1.2.2.1.2.3.3">𝑎</ci></apply></apply><apply id="S3.Ex9.m1.2.2.1.1.cmml" xref="S3.Ex9.m1.2.2.1.1"><times id="S3.Ex9.m1.2.2.1.1.2.cmml" xref="S3.Ex9.m1.2.2.1.1.2"></times><apply id="S3.Ex9.m1.2.2.1.1.3.cmml" xref="S3.Ex9.m1.2.2.1.1.3"><log id="S3.Ex9.m1.2.2.1.1.3.1.cmml" xref="S3.Ex9.m1.2.2.1.1.3.1"></log><apply id="S3.Ex9.m1.2.2.1.1.3.2.cmml" xref="S3.Ex9.m1.2.2.1.1.3.2"><csymbol cd="ambiguous" id="S3.Ex9.m1.2.2.1.1.3.2.1.cmml" xref="S3.Ex9.m1.2.2.1.1.3.2">subscript</csymbol><ci id="S3.Ex9.m1.2.2.1.1.3.2.2.cmml" xref="S3.Ex9.m1.2.2.1.1.3.2.2">𝑝</ci><ci id="S3.Ex9.m1.2.2.1.1.3.2.3.cmml" xref="S3.Ex9.m1.2.2.1.1.3.2.3">𝑀</ci></apply></apply><apply id="S3.Ex9.m1.2.2.1.1.1.1.1.cmml" xref="S3.Ex9.m1.2.2.1.1.1.1"><csymbol cd="latexml" id="S3.Ex9.m1.2.2.1.1.1.1.1.1.cmml" xref="S3.Ex9.m1.2.2.1.1.1.1.1.1">conditional</csymbol><apply id="S3.Ex9.m1.2.2.1.1.1.1.1.2.cmml" xref="S3.Ex9.m1.2.2.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.Ex9.m1.2.2.1.1.1.1.1.2.1.cmml" xref="S3.Ex9.m1.2.2.1.1.1.1.1.2">subscript</csymbol><ci id="S3.Ex9.m1.2.2.1.1.1.1.1.2.2.cmml" xref="S3.Ex9.m1.2.2.1.1.1.1.1.2.2">𝑎</ci><ci id="S3.Ex9.m1.2.2.1.1.1.1.1.2.3.cmml" xref="S3.Ex9.m1.2.2.1.1.1.1.1.2.3">𝑖</ci></apply><ci id="S3.Ex9.m1.2.2.1.1.1.1.1.3.cmml" xref="S3.Ex9.m1.2.2.1.1.1.1.1.3">𝑞</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.Ex9.m1.2c">\frac{1}{|a|}\sum_{a_{i}\in a}\log p_{M}(a_{i}\mid q)</annotation><annotation encoding="application/x-llamapun" id="S3.Ex9.m1.2d">divide start_ARG 1 end_ARG start_ARG | italic_a | end_ARG ∑ start_POSTSUBSCRIPT italic_a start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT ∈ italic_a end_POSTSUBSCRIPT roman_log italic_p start_POSTSUBSCRIPT italic_M end_POSTSUBSCRIPT ( italic_a start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT ∣ italic_q )</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
</div>
<div class="ltx_para" id="S3.SS3.SSS3.p2">
<p class="ltx_p" id="S3.SS3.SSS3.p2.4">This can be interpreted as measuring the probability of the correct answer <math alttext="a" class="ltx_Math" display="inline" id="S3.SS3.SSS3.p2.1.m1.1"><semantics id="S3.SS3.SSS3.p2.1.m1.1a"><mi id="S3.SS3.SSS3.p2.1.m1.1.1" xref="S3.SS3.SSS3.p2.1.m1.1.1.cmml">a</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS3.p2.1.m1.1b"><ci id="S3.SS3.SSS3.p2.1.m1.1.1.cmml" xref="S3.SS3.SSS3.p2.1.m1.1.1">𝑎</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS3.p2.1.m1.1c">a</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.SSS3.p2.1.m1.1d">italic_a</annotation></semantics></math> given the query <math alttext="q" class="ltx_Math" display="inline" id="S3.SS3.SSS3.p2.2.m2.1"><semantics id="S3.SS3.SSS3.p2.2.m2.1a"><mi id="S3.SS3.SSS3.p2.2.m2.1.1" xref="S3.SS3.SSS3.p2.2.m2.1.1.cmml">q</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS3.p2.2.m2.1b"><ci id="S3.SS3.SSS3.p2.2.m2.1.1.cmml" xref="S3.SS3.SSS3.p2.2.m2.1.1">𝑞</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS3.p2.2.m2.1c">q</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.SSS3.p2.2.m2.1d">italic_q</annotation></semantics></math>, normalized to the length of the answer. This can also been interpreted as a proxy for a popularity bias, akin to the number of connections of an item in graph-based retrieval algorithms like recommender systems. Like in the article <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2405.17587v2#bib.bib12" title="">12</a>]</cite>, the intuition is that the more frequently a related sequence of tokens occurs in the pre-training dataset of the LLM, the more likely the model will be able to extract its relevant information.
Rather than directly analyzing the massive amount of text data (often trillions of tokens) used to pre-train the LLM, we focus on the perplexity of the sequence. Perplexity acts as a proxy, indicating how surprised the LLM is by the sequence, essentially, how well it aligns with what the LLM expects to see.
A parameter <math alttext="\lambda_{b}" class="ltx_Math" display="inline" id="S3.SS3.SSS3.p2.3.m3.1"><semantics id="S3.SS3.SSS3.p2.3.m3.1a"><msub id="S3.SS3.SSS3.p2.3.m3.1.1" xref="S3.SS3.SSS3.p2.3.m3.1.1.cmml"><mi id="S3.SS3.SSS3.p2.3.m3.1.1.2" xref="S3.SS3.SSS3.p2.3.m3.1.1.2.cmml">λ</mi><mi id="S3.SS3.SSS3.p2.3.m3.1.1.3" xref="S3.SS3.SSS3.p2.3.m3.1.1.3.cmml">b</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS3.p2.3.m3.1b"><apply id="S3.SS3.SSS3.p2.3.m3.1.1.cmml" xref="S3.SS3.SSS3.p2.3.m3.1.1"><csymbol cd="ambiguous" id="S3.SS3.SSS3.p2.3.m3.1.1.1.cmml" xref="S3.SS3.SSS3.p2.3.m3.1.1">subscript</csymbol><ci id="S3.SS3.SSS3.p2.3.m3.1.1.2.cmml" xref="S3.SS3.SSS3.p2.3.m3.1.1.2">𝜆</ci><ci id="S3.SS3.SSS3.p2.3.m3.1.1.3.cmml" xref="S3.SS3.SSS3.p2.3.m3.1.1.3">𝑏</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS3.p2.3.m3.1c">\lambda_{b}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.SSS3.p2.3.m3.1d">italic_λ start_POSTSUBSCRIPT italic_b end_POSTSUBSCRIPT</annotation></semantics></math> controls the trade-off between relevance/diversity and quality bias. Lower values of <math alttext="\lambda_{b}" class="ltx_Math" display="inline" id="S3.SS3.SSS3.p2.4.m4.1"><semantics id="S3.SS3.SSS3.p2.4.m4.1a"><msub id="S3.SS3.SSS3.p2.4.m4.1.1" xref="S3.SS3.SSS3.p2.4.m4.1.1.cmml"><mi id="S3.SS3.SSS3.p2.4.m4.1.1.2" xref="S3.SS3.SSS3.p2.4.m4.1.1.2.cmml">λ</mi><mi id="S3.SS3.SSS3.p2.4.m4.1.1.3" xref="S3.SS3.SSS3.p2.4.m4.1.1.3.cmml">b</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS3.p2.4.m4.1b"><apply id="S3.SS3.SSS3.p2.4.m4.1.1.cmml" xref="S3.SS3.SSS3.p2.4.m4.1.1"><csymbol cd="ambiguous" id="S3.SS3.SSS3.p2.4.m4.1.1.1.cmml" xref="S3.SS3.SSS3.p2.4.m4.1.1">subscript</csymbol><ci id="S3.SS3.SSS3.p2.4.m4.1.1.2.cmml" xref="S3.SS3.SSS3.p2.4.m4.1.1.2">𝜆</ci><ci id="S3.SS3.SSS3.p2.4.m4.1.1.3.cmml" xref="S3.SS3.SSS3.p2.4.m4.1.1.3">𝑏</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS3.p2.4.m4.1c">\lambda_{b}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.SSS3.p2.4.m4.1d">italic_λ start_POSTSUBSCRIPT italic_b end_POSTSUBSCRIPT</annotation></semantics></math> emphasize high-quality demonstrations.</p>
</div>
<figure class="ltx_float ltx_float_algorithm ltx_framed ltx_framed_top" id="alg1">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_float"><span class="ltx_text ltx_font_bold" id="alg1.2.1.1">Algorithm 1</span> </span> MMR with quality bias</figcaption>
<div class="ltx_listing ltx_listing" id="alg1.3">
<div class="ltx_listingline" id="alg1.l1">
<math alttext="1\leq k\leq n" class="ltx_Math" display="inline" id="alg1.l1.m1.1"><semantics id="alg1.l1.m1.1a"><mrow id="alg1.l1.m1.1.1" xref="alg1.l1.m1.1.1.cmml"><mn id="alg1.l1.m1.1.1.2" xref="alg1.l1.m1.1.1.2.cmml">1</mn><mo id="alg1.l1.m1.1.1.3" xref="alg1.l1.m1.1.1.3.cmml">≤</mo><mi id="alg1.l1.m1.1.1.4" xref="alg1.l1.m1.1.1.4.cmml">k</mi><mo id="alg1.l1.m1.1.1.5" xref="alg1.l1.m1.1.1.5.cmml">≤</mo><mi id="alg1.l1.m1.1.1.6" xref="alg1.l1.m1.1.1.6.cmml">n</mi></mrow><annotation-xml encoding="MathML-Content" id="alg1.l1.m1.1b"><apply id="alg1.l1.m1.1.1.cmml" xref="alg1.l1.m1.1.1"><and id="alg1.l1.m1.1.1a.cmml" xref="alg1.l1.m1.1.1"></and><apply id="alg1.l1.m1.1.1b.cmml" xref="alg1.l1.m1.1.1"><leq id="alg1.l1.m1.1.1.3.cmml" xref="alg1.l1.m1.1.1.3"></leq><cn id="alg1.l1.m1.1.1.2.cmml" type="integer" xref="alg1.l1.m1.1.1.2">1</cn><ci id="alg1.l1.m1.1.1.4.cmml" xref="alg1.l1.m1.1.1.4">𝑘</ci></apply><apply id="alg1.l1.m1.1.1c.cmml" xref="alg1.l1.m1.1.1"><leq id="alg1.l1.m1.1.1.5.cmml" xref="alg1.l1.m1.1.1.5"></leq><share href="https://arxiv.org/html/2405.17587v2#alg1.l1.m1.1.1.4.cmml" id="alg1.l1.m1.1.1d.cmml" xref="alg1.l1.m1.1.1"></share><ci id="alg1.l1.m1.1.1.6.cmml" xref="alg1.l1.m1.1.1.6">𝑛</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l1.m1.1c">1\leq k\leq n</annotation><annotation encoding="application/x-llamapun" id="alg1.l1.m1.1d">1 ≤ italic_k ≤ italic_n</annotation></semantics></math>;  <math alttext="0\leq\lambda_{d}\leq 1" class="ltx_Math" display="inline" id="alg1.l1.m2.1"><semantics id="alg1.l1.m2.1a"><mrow id="alg1.l1.m2.1.1" xref="alg1.l1.m2.1.1.cmml"><mn id="alg1.l1.m2.1.1.2" xref="alg1.l1.m2.1.1.2.cmml">0</mn><mo id="alg1.l1.m2.1.1.3" xref="alg1.l1.m2.1.1.3.cmml">≤</mo><msub id="alg1.l1.m2.1.1.4" xref="alg1.l1.m2.1.1.4.cmml"><mi id="alg1.l1.m2.1.1.4.2" xref="alg1.l1.m2.1.1.4.2.cmml">λ</mi><mi id="alg1.l1.m2.1.1.4.3" xref="alg1.l1.m2.1.1.4.3.cmml">d</mi></msub><mo id="alg1.l1.m2.1.1.5" xref="alg1.l1.m2.1.1.5.cmml">≤</mo><mn id="alg1.l1.m2.1.1.6" xref="alg1.l1.m2.1.1.6.cmml">1</mn></mrow><annotation-xml encoding="MathML-Content" id="alg1.l1.m2.1b"><apply id="alg1.l1.m2.1.1.cmml" xref="alg1.l1.m2.1.1"><and id="alg1.l1.m2.1.1a.cmml" xref="alg1.l1.m2.1.1"></and><apply id="alg1.l1.m2.1.1b.cmml" xref="alg1.l1.m2.1.1"><leq id="alg1.l1.m2.1.1.3.cmml" xref="alg1.l1.m2.1.1.3"></leq><cn id="alg1.l1.m2.1.1.2.cmml" type="integer" xref="alg1.l1.m2.1.1.2">0</cn><apply id="alg1.l1.m2.1.1.4.cmml" xref="alg1.l1.m2.1.1.4"><csymbol cd="ambiguous" id="alg1.l1.m2.1.1.4.1.cmml" xref="alg1.l1.m2.1.1.4">subscript</csymbol><ci id="alg1.l1.m2.1.1.4.2.cmml" xref="alg1.l1.m2.1.1.4.2">𝜆</ci><ci id="alg1.l1.m2.1.1.4.3.cmml" xref="alg1.l1.m2.1.1.4.3">𝑑</ci></apply></apply><apply id="alg1.l1.m2.1.1c.cmml" xref="alg1.l1.m2.1.1"><leq id="alg1.l1.m2.1.1.5.cmml" xref="alg1.l1.m2.1.1.5"></leq><share href="https://arxiv.org/html/2405.17587v2#alg1.l1.m2.1.1.4.cmml" id="alg1.l1.m2.1.1d.cmml" xref="alg1.l1.m2.1.1"></share><cn id="alg1.l1.m2.1.1.6.cmml" type="integer" xref="alg1.l1.m2.1.1.6">1</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l1.m2.1c">0\leq\lambda_{d}\leq 1</annotation><annotation encoding="application/x-llamapun" id="alg1.l1.m2.1d">0 ≤ italic_λ start_POSTSUBSCRIPT italic_d end_POSTSUBSCRIPT ≤ 1</annotation></semantics></math>;  <math alttext="0\leq\lambda_{b}\leq 1" class="ltx_Math" display="inline" id="alg1.l1.m3.1"><semantics id="alg1.l1.m3.1a"><mrow id="alg1.l1.m3.1.1" xref="alg1.l1.m3.1.1.cmml"><mn id="alg1.l1.m3.1.1.2" xref="alg1.l1.m3.1.1.2.cmml">0</mn><mo id="alg1.l1.m3.1.1.3" xref="alg1.l1.m3.1.1.3.cmml">≤</mo><msub id="alg1.l1.m3.1.1.4" xref="alg1.l1.m3.1.1.4.cmml"><mi id="alg1.l1.m3.1.1.4.2" xref="alg1.l1.m3.1.1.4.2.cmml">λ</mi><mi id="alg1.l1.m3.1.1.4.3" xref="alg1.l1.m3.1.1.4.3.cmml">b</mi></msub><mo id="alg1.l1.m3.1.1.5" xref="alg1.l1.m3.1.1.5.cmml">≤</mo><mn id="alg1.l1.m3.1.1.6" xref="alg1.l1.m3.1.1.6.cmml">1</mn></mrow><annotation-xml encoding="MathML-Content" id="alg1.l1.m3.1b"><apply id="alg1.l1.m3.1.1.cmml" xref="alg1.l1.m3.1.1"><and id="alg1.l1.m3.1.1a.cmml" xref="alg1.l1.m3.1.1"></and><apply id="alg1.l1.m3.1.1b.cmml" xref="alg1.l1.m3.1.1"><leq id="alg1.l1.m3.1.1.3.cmml" xref="alg1.l1.m3.1.1.3"></leq><cn id="alg1.l1.m3.1.1.2.cmml" type="integer" xref="alg1.l1.m3.1.1.2">0</cn><apply id="alg1.l1.m3.1.1.4.cmml" xref="alg1.l1.m3.1.1.4"><csymbol cd="ambiguous" id="alg1.l1.m3.1.1.4.1.cmml" xref="alg1.l1.m3.1.1.4">subscript</csymbol><ci id="alg1.l1.m3.1.1.4.2.cmml" xref="alg1.l1.m3.1.1.4.2">𝜆</ci><ci id="alg1.l1.m3.1.1.4.3.cmml" xref="alg1.l1.m3.1.1.4.3">𝑏</ci></apply></apply><apply id="alg1.l1.m3.1.1c.cmml" xref="alg1.l1.m3.1.1"><leq id="alg1.l1.m3.1.1.5.cmml" xref="alg1.l1.m3.1.1.5"></leq><share href="https://arxiv.org/html/2405.17587v2#alg1.l1.m3.1.1.4.cmml" id="alg1.l1.m3.1.1d.cmml" xref="alg1.l1.m3.1.1"></share><cn id="alg1.l1.m3.1.1.6.cmml" type="integer" xref="alg1.l1.m3.1.1.6">1</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l1.m3.1c">0\leq\lambda_{b}\leq 1</annotation><annotation encoding="application/x-llamapun" id="alg1.l1.m3.1d">0 ≤ italic_λ start_POSTSUBSCRIPT italic_b end_POSTSUBSCRIPT ≤ 1</annotation></semantics></math>
</div>
<div class="ltx_listingline" id="alg1.l2">
<math alttext="Q\in\mathbb{R}^{d}" class="ltx_Math" display="inline" id="alg1.l2.m1.1"><semantics id="alg1.l2.m1.1a"><mrow id="alg1.l2.m1.1.1" xref="alg1.l2.m1.1.1.cmml"><mi id="alg1.l2.m1.1.1.2" xref="alg1.l2.m1.1.1.2.cmml">Q</mi><mo id="alg1.l2.m1.1.1.1" xref="alg1.l2.m1.1.1.1.cmml">∈</mo><msup id="alg1.l2.m1.1.1.3" xref="alg1.l2.m1.1.1.3.cmml"><mi id="alg1.l2.m1.1.1.3.2" xref="alg1.l2.m1.1.1.3.2.cmml">ℝ</mi><mi id="alg1.l2.m1.1.1.3.3" xref="alg1.l2.m1.1.1.3.3.cmml">d</mi></msup></mrow><annotation-xml encoding="MathML-Content" id="alg1.l2.m1.1b"><apply id="alg1.l2.m1.1.1.cmml" xref="alg1.l2.m1.1.1"><in id="alg1.l2.m1.1.1.1.cmml" xref="alg1.l2.m1.1.1.1"></in><ci id="alg1.l2.m1.1.1.2.cmml" xref="alg1.l2.m1.1.1.2">𝑄</ci><apply id="alg1.l2.m1.1.1.3.cmml" xref="alg1.l2.m1.1.1.3"><csymbol cd="ambiguous" id="alg1.l2.m1.1.1.3.1.cmml" xref="alg1.l2.m1.1.1.3">superscript</csymbol><ci id="alg1.l2.m1.1.1.3.2.cmml" xref="alg1.l2.m1.1.1.3.2">ℝ</ci><ci id="alg1.l2.m1.1.1.3.3.cmml" xref="alg1.l2.m1.1.1.3.3">𝑑</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l2.m1.1c">Q\in\mathbb{R}^{d}</annotation><annotation encoding="application/x-llamapun" id="alg1.l2.m1.1d">italic_Q ∈ blackboard_R start_POSTSUPERSCRIPT italic_d end_POSTSUPERSCRIPT</annotation></semantics></math> <span class="ltx_text" id="alg1.l2.1" style="float:right;"><math alttext="\triangleright" class="ltx_Math" display="inline" id="alg1.l2.1.m1.1"><semantics id="alg1.l2.1.m1.1a"><mo id="alg1.l2.1.m1.1.1" xref="alg1.l2.1.m1.1.1.cmml">▷</mo><annotation-xml encoding="MathML-Content" id="alg1.l2.1.m1.1b"><ci id="alg1.l2.1.m1.1.1.cmml" xref="alg1.l2.1.m1.1.1">▷</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.l2.1.m1.1c">\triangleright</annotation><annotation encoding="application/x-llamapun" id="alg1.l2.1.m1.1d">▷</annotation></semantics></math> query embedding
</span>
</div>
<div class="ltx_listingline" id="alg1.l3">
<math alttext="\forall 1\leq i\leq n" class="ltx_Math" display="inline" id="alg1.l3.m1.1"><semantics id="alg1.l3.m1.1a"><mrow id="alg1.l3.m1.1.1" xref="alg1.l3.m1.1.1.cmml"><mrow id="alg1.l3.m1.1.1.2" xref="alg1.l3.m1.1.1.2.cmml"><mo id="alg1.l3.m1.1.1.2.1" rspace="0.167em" xref="alg1.l3.m1.1.1.2.1.cmml">∀</mo><mn id="alg1.l3.m1.1.1.2.2" xref="alg1.l3.m1.1.1.2.2.cmml">1</mn></mrow><mo id="alg1.l3.m1.1.1.3" xref="alg1.l3.m1.1.1.3.cmml">≤</mo><mi id="alg1.l3.m1.1.1.4" xref="alg1.l3.m1.1.1.4.cmml">i</mi><mo id="alg1.l3.m1.1.1.5" xref="alg1.l3.m1.1.1.5.cmml">≤</mo><mi id="alg1.l3.m1.1.1.6" xref="alg1.l3.m1.1.1.6.cmml">n</mi></mrow><annotation-xml encoding="MathML-Content" id="alg1.l3.m1.1b"><apply id="alg1.l3.m1.1.1.cmml" xref="alg1.l3.m1.1.1"><and id="alg1.l3.m1.1.1a.cmml" xref="alg1.l3.m1.1.1"></and><apply id="alg1.l3.m1.1.1b.cmml" xref="alg1.l3.m1.1.1"><leq id="alg1.l3.m1.1.1.3.cmml" xref="alg1.l3.m1.1.1.3"></leq><apply id="alg1.l3.m1.1.1.2.cmml" xref="alg1.l3.m1.1.1.2"><csymbol cd="latexml" id="alg1.l3.m1.1.1.2.1.cmml" xref="alg1.l3.m1.1.1.2.1">for-all</csymbol><cn id="alg1.l3.m1.1.1.2.2.cmml" type="integer" xref="alg1.l3.m1.1.1.2.2">1</cn></apply><ci id="alg1.l3.m1.1.1.4.cmml" xref="alg1.l3.m1.1.1.4">𝑖</ci></apply><apply id="alg1.l3.m1.1.1c.cmml" xref="alg1.l3.m1.1.1"><leq id="alg1.l3.m1.1.1.5.cmml" xref="alg1.l3.m1.1.1.5"></leq><share href="https://arxiv.org/html/2405.17587v2#alg1.l3.m1.1.1.4.cmml" id="alg1.l3.m1.1.1d.cmml" xref="alg1.l3.m1.1.1"></share><ci id="alg1.l3.m1.1.1.6.cmml" xref="alg1.l3.m1.1.1.6">𝑛</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l3.m1.1c">\forall 1\leq i\leq n</annotation><annotation encoding="application/x-llamapun" id="alg1.l3.m1.1d">∀ 1 ≤ italic_i ≤ italic_n</annotation></semantics></math>,  <math alttext="E_{i}\in\mathbb{R}^{d}" class="ltx_Math" display="inline" id="alg1.l3.m2.1"><semantics id="alg1.l3.m2.1a"><mrow id="alg1.l3.m2.1.1" xref="alg1.l3.m2.1.1.cmml"><msub id="alg1.l3.m2.1.1.2" xref="alg1.l3.m2.1.1.2.cmml"><mi id="alg1.l3.m2.1.1.2.2" xref="alg1.l3.m2.1.1.2.2.cmml">E</mi><mi id="alg1.l3.m2.1.1.2.3" xref="alg1.l3.m2.1.1.2.3.cmml">i</mi></msub><mo id="alg1.l3.m2.1.1.1" xref="alg1.l3.m2.1.1.1.cmml">∈</mo><msup id="alg1.l3.m2.1.1.3" xref="alg1.l3.m2.1.1.3.cmml"><mi id="alg1.l3.m2.1.1.3.2" xref="alg1.l3.m2.1.1.3.2.cmml">ℝ</mi><mi id="alg1.l3.m2.1.1.3.3" xref="alg1.l3.m2.1.1.3.3.cmml">d</mi></msup></mrow><annotation-xml encoding="MathML-Content" id="alg1.l3.m2.1b"><apply id="alg1.l3.m2.1.1.cmml" xref="alg1.l3.m2.1.1"><in id="alg1.l3.m2.1.1.1.cmml" xref="alg1.l3.m2.1.1.1"></in><apply id="alg1.l3.m2.1.1.2.cmml" xref="alg1.l3.m2.1.1.2"><csymbol cd="ambiguous" id="alg1.l3.m2.1.1.2.1.cmml" xref="alg1.l3.m2.1.1.2">subscript</csymbol><ci id="alg1.l3.m2.1.1.2.2.cmml" xref="alg1.l3.m2.1.1.2.2">𝐸</ci><ci id="alg1.l3.m2.1.1.2.3.cmml" xref="alg1.l3.m2.1.1.2.3">𝑖</ci></apply><apply id="alg1.l3.m2.1.1.3.cmml" xref="alg1.l3.m2.1.1.3"><csymbol cd="ambiguous" id="alg1.l3.m2.1.1.3.1.cmml" xref="alg1.l3.m2.1.1.3">superscript</csymbol><ci id="alg1.l3.m2.1.1.3.2.cmml" xref="alg1.l3.m2.1.1.3.2">ℝ</ci><ci id="alg1.l3.m2.1.1.3.3.cmml" xref="alg1.l3.m2.1.1.3.3">𝑑</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l3.m2.1c">E_{i}\in\mathbb{R}^{d}</annotation><annotation encoding="application/x-llamapun" id="alg1.l3.m2.1d">italic_E start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT ∈ blackboard_R start_POSTSUPERSCRIPT italic_d end_POSTSUPERSCRIPT</annotation></semantics></math> <span class="ltx_text" id="alg1.l3.1" style="float:right;"><math alttext="\triangleright" class="ltx_Math" display="inline" id="alg1.l3.1.m1.1"><semantics id="alg1.l3.1.m1.1a"><mo id="alg1.l3.1.m1.1.1" xref="alg1.l3.1.m1.1.1.cmml">▷</mo><annotation-xml encoding="MathML-Content" id="alg1.l3.1.m1.1b"><ci id="alg1.l3.1.m1.1.1.cmml" xref="alg1.l3.1.m1.1.1">▷</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.l3.1.m1.1c">\triangleright</annotation><annotation encoding="application/x-llamapun" id="alg1.l3.1.m1.1d">▷</annotation></semantics></math> example question embedding
</span>
</div>
<div class="ltx_listingline" id="alg1.l4">
<math alttext="\forall 1\leq i\leq n" class="ltx_Math" display="inline" id="alg1.l4.m1.1"><semantics id="alg1.l4.m1.1a"><mrow id="alg1.l4.m1.1.1" xref="alg1.l4.m1.1.1.cmml"><mrow id="alg1.l4.m1.1.1.2" xref="alg1.l4.m1.1.1.2.cmml"><mo id="alg1.l4.m1.1.1.2.1" rspace="0.167em" xref="alg1.l4.m1.1.1.2.1.cmml">∀</mo><mn id="alg1.l4.m1.1.1.2.2" xref="alg1.l4.m1.1.1.2.2.cmml">1</mn></mrow><mo id="alg1.l4.m1.1.1.3" xref="alg1.l4.m1.1.1.3.cmml">≤</mo><mi id="alg1.l4.m1.1.1.4" xref="alg1.l4.m1.1.1.4.cmml">i</mi><mo id="alg1.l4.m1.1.1.5" xref="alg1.l4.m1.1.1.5.cmml">≤</mo><mi id="alg1.l4.m1.1.1.6" xref="alg1.l4.m1.1.1.6.cmml">n</mi></mrow><annotation-xml encoding="MathML-Content" id="alg1.l4.m1.1b"><apply id="alg1.l4.m1.1.1.cmml" xref="alg1.l4.m1.1.1"><and id="alg1.l4.m1.1.1a.cmml" xref="alg1.l4.m1.1.1"></and><apply id="alg1.l4.m1.1.1b.cmml" xref="alg1.l4.m1.1.1"><leq id="alg1.l4.m1.1.1.3.cmml" xref="alg1.l4.m1.1.1.3"></leq><apply id="alg1.l4.m1.1.1.2.cmml" xref="alg1.l4.m1.1.1.2"><csymbol cd="latexml" id="alg1.l4.m1.1.1.2.1.cmml" xref="alg1.l4.m1.1.1.2.1">for-all</csymbol><cn id="alg1.l4.m1.1.1.2.2.cmml" type="integer" xref="alg1.l4.m1.1.1.2.2">1</cn></apply><ci id="alg1.l4.m1.1.1.4.cmml" xref="alg1.l4.m1.1.1.4">𝑖</ci></apply><apply id="alg1.l4.m1.1.1c.cmml" xref="alg1.l4.m1.1.1"><leq id="alg1.l4.m1.1.1.5.cmml" xref="alg1.l4.m1.1.1.5"></leq><share href="https://arxiv.org/html/2405.17587v2#alg1.l4.m1.1.1.4.cmml" id="alg1.l4.m1.1.1d.cmml" xref="alg1.l4.m1.1.1"></share><ci id="alg1.l4.m1.1.1.6.cmml" xref="alg1.l4.m1.1.1.6">𝑛</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l4.m1.1c">\forall 1\leq i\leq n</annotation><annotation encoding="application/x-llamapun" id="alg1.l4.m1.1d">∀ 1 ≤ italic_i ≤ italic_n</annotation></semantics></math>,  <math alttext="b_{i}\in\mathbb{R}" class="ltx_Math" display="inline" id="alg1.l4.m2.1"><semantics id="alg1.l4.m2.1a"><mrow id="alg1.l4.m2.1.1" xref="alg1.l4.m2.1.1.cmml"><msub id="alg1.l4.m2.1.1.2" xref="alg1.l4.m2.1.1.2.cmml"><mi id="alg1.l4.m2.1.1.2.2" xref="alg1.l4.m2.1.1.2.2.cmml">b</mi><mi id="alg1.l4.m2.1.1.2.3" xref="alg1.l4.m2.1.1.2.3.cmml">i</mi></msub><mo id="alg1.l4.m2.1.1.1" xref="alg1.l4.m2.1.1.1.cmml">∈</mo><mi id="alg1.l4.m2.1.1.3" xref="alg1.l4.m2.1.1.3.cmml">ℝ</mi></mrow><annotation-xml encoding="MathML-Content" id="alg1.l4.m2.1b"><apply id="alg1.l4.m2.1.1.cmml" xref="alg1.l4.m2.1.1"><in id="alg1.l4.m2.1.1.1.cmml" xref="alg1.l4.m2.1.1.1"></in><apply id="alg1.l4.m2.1.1.2.cmml" xref="alg1.l4.m2.1.1.2"><csymbol cd="ambiguous" id="alg1.l4.m2.1.1.2.1.cmml" xref="alg1.l4.m2.1.1.2">subscript</csymbol><ci id="alg1.l4.m2.1.1.2.2.cmml" xref="alg1.l4.m2.1.1.2.2">𝑏</ci><ci id="alg1.l4.m2.1.1.2.3.cmml" xref="alg1.l4.m2.1.1.2.3">𝑖</ci></apply><ci id="alg1.l4.m2.1.1.3.cmml" xref="alg1.l4.m2.1.1.3">ℝ</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l4.m2.1c">b_{i}\in\mathbb{R}</annotation><annotation encoding="application/x-llamapun" id="alg1.l4.m2.1d">italic_b start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT ∈ blackboard_R</annotation></semantics></math> <span class="ltx_text" id="alg1.l4.1" style="float:right;"><math alttext="\triangleright" class="ltx_Math" display="inline" id="alg1.l4.1.m1.1"><semantics id="alg1.l4.1.m1.1a"><mo id="alg1.l4.1.m1.1.1" xref="alg1.l4.1.m1.1.1.cmml">▷</mo><annotation-xml encoding="MathML-Content" id="alg1.l4.1.m1.1b"><ci id="alg1.l4.1.m1.1.1.cmml" xref="alg1.l4.1.m1.1.1">▷</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.l4.1.m1.1c">\triangleright</annotation><annotation encoding="application/x-llamapun" id="alg1.l4.1.m1.1d">▷</annotation></semantics></math> example quality bias
</span>
</div>
<div class="ltx_listingline" id="alg1.l5">
<math alttext="Q\leftarrow\frac{Q}{\|Q\|}" class="ltx_Math" display="inline" id="alg1.l5.m1.1"><semantics id="alg1.l5.m1.1a"><mrow id="alg1.l5.m1.1.2" xref="alg1.l5.m1.1.2.cmml"><mi id="alg1.l5.m1.1.2.2" xref="alg1.l5.m1.1.2.2.cmml">Q</mi><mo id="alg1.l5.m1.1.2.1" stretchy="false" xref="alg1.l5.m1.1.2.1.cmml">←</mo><mfrac id="alg1.l5.m1.1.1" xref="alg1.l5.m1.1.1.cmml"><mi id="alg1.l5.m1.1.1.3" xref="alg1.l5.m1.1.1.3.cmml">Q</mi><mrow id="alg1.l5.m1.1.1.1.3" xref="alg1.l5.m1.1.1.1.2.cmml"><mo id="alg1.l5.m1.1.1.1.3.1" stretchy="false" xref="alg1.l5.m1.1.1.1.2.1.cmml">‖</mo><mi id="alg1.l5.m1.1.1.1.1" xref="alg1.l5.m1.1.1.1.1.cmml">Q</mi><mo id="alg1.l5.m1.1.1.1.3.2" stretchy="false" xref="alg1.l5.m1.1.1.1.2.1.cmml">‖</mo></mrow></mfrac></mrow><annotation-xml encoding="MathML-Content" id="alg1.l5.m1.1b"><apply id="alg1.l5.m1.1.2.cmml" xref="alg1.l5.m1.1.2"><ci id="alg1.l5.m1.1.2.1.cmml" xref="alg1.l5.m1.1.2.1">←</ci><ci id="alg1.l5.m1.1.2.2.cmml" xref="alg1.l5.m1.1.2.2">𝑄</ci><apply id="alg1.l5.m1.1.1.cmml" xref="alg1.l5.m1.1.1"><divide id="alg1.l5.m1.1.1.2.cmml" xref="alg1.l5.m1.1.1"></divide><ci id="alg1.l5.m1.1.1.3.cmml" xref="alg1.l5.m1.1.1.3">𝑄</ci><apply id="alg1.l5.m1.1.1.1.2.cmml" xref="alg1.l5.m1.1.1.1.3"><csymbol cd="latexml" id="alg1.l5.m1.1.1.1.2.1.cmml" xref="alg1.l5.m1.1.1.1.3.1">norm</csymbol><ci id="alg1.l5.m1.1.1.1.1.cmml" xref="alg1.l5.m1.1.1.1.1">𝑄</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l5.m1.1c">Q\leftarrow\frac{Q}{\|Q\|}</annotation><annotation encoding="application/x-llamapun" id="alg1.l5.m1.1d">italic_Q ← divide start_ARG italic_Q end_ARG start_ARG ∥ italic_Q ∥ end_ARG</annotation></semantics></math>;  <math alttext="\forall 1\leq i\leq n" class="ltx_Math" display="inline" id="alg1.l5.m2.1"><semantics id="alg1.l5.m2.1a"><mrow id="alg1.l5.m2.1.1" xref="alg1.l5.m2.1.1.cmml"><mrow id="alg1.l5.m2.1.1.2" xref="alg1.l5.m2.1.1.2.cmml"><mo id="alg1.l5.m2.1.1.2.1" rspace="0.167em" xref="alg1.l5.m2.1.1.2.1.cmml">∀</mo><mn id="alg1.l5.m2.1.1.2.2" xref="alg1.l5.m2.1.1.2.2.cmml">1</mn></mrow><mo id="alg1.l5.m2.1.1.3" xref="alg1.l5.m2.1.1.3.cmml">≤</mo><mi id="alg1.l5.m2.1.1.4" xref="alg1.l5.m2.1.1.4.cmml">i</mi><mo id="alg1.l5.m2.1.1.5" xref="alg1.l5.m2.1.1.5.cmml">≤</mo><mi id="alg1.l5.m2.1.1.6" xref="alg1.l5.m2.1.1.6.cmml">n</mi></mrow><annotation-xml encoding="MathML-Content" id="alg1.l5.m2.1b"><apply id="alg1.l5.m2.1.1.cmml" xref="alg1.l5.m2.1.1"><and id="alg1.l5.m2.1.1a.cmml" xref="alg1.l5.m2.1.1"></and><apply id="alg1.l5.m2.1.1b.cmml" xref="alg1.l5.m2.1.1"><leq id="alg1.l5.m2.1.1.3.cmml" xref="alg1.l5.m2.1.1.3"></leq><apply id="alg1.l5.m2.1.1.2.cmml" xref="alg1.l5.m2.1.1.2"><csymbol cd="latexml" id="alg1.l5.m2.1.1.2.1.cmml" xref="alg1.l5.m2.1.1.2.1">for-all</csymbol><cn id="alg1.l5.m2.1.1.2.2.cmml" type="integer" xref="alg1.l5.m2.1.1.2.2">1</cn></apply><ci id="alg1.l5.m2.1.1.4.cmml" xref="alg1.l5.m2.1.1.4">𝑖</ci></apply><apply id="alg1.l5.m2.1.1c.cmml" xref="alg1.l5.m2.1.1"><leq id="alg1.l5.m2.1.1.5.cmml" xref="alg1.l5.m2.1.1.5"></leq><share href="https://arxiv.org/html/2405.17587v2#alg1.l5.m2.1.1.4.cmml" id="alg1.l5.m2.1.1d.cmml" xref="alg1.l5.m2.1.1"></share><ci id="alg1.l5.m2.1.1.6.cmml" xref="alg1.l5.m2.1.1.6">𝑛</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l5.m2.1c">\forall 1\leq i\leq n</annotation><annotation encoding="application/x-llamapun" id="alg1.l5.m2.1d">∀ 1 ≤ italic_i ≤ italic_n</annotation></semantics></math>,  <math alttext="E_{i}\leftarrow\frac{E_{i}}{\|E_{i}\|}" class="ltx_Math" display="inline" id="alg1.l5.m3.1"><semantics id="alg1.l5.m3.1a"><mrow id="alg1.l5.m3.1.2" xref="alg1.l5.m3.1.2.cmml"><msub id="alg1.l5.m3.1.2.2" xref="alg1.l5.m3.1.2.2.cmml"><mi id="alg1.l5.m3.1.2.2.2" xref="alg1.l5.m3.1.2.2.2.cmml">E</mi><mi id="alg1.l5.m3.1.2.2.3" xref="alg1.l5.m3.1.2.2.3.cmml">i</mi></msub><mo id="alg1.l5.m3.1.2.1" stretchy="false" xref="alg1.l5.m3.1.2.1.cmml">←</mo><mfrac id="alg1.l5.m3.1.1" xref="alg1.l5.m3.1.1.cmml"><msub id="alg1.l5.m3.1.1.3" xref="alg1.l5.m3.1.1.3.cmml"><mi id="alg1.l5.m3.1.1.3.2" xref="alg1.l5.m3.1.1.3.2.cmml">E</mi><mi id="alg1.l5.m3.1.1.3.3" xref="alg1.l5.m3.1.1.3.3.cmml">i</mi></msub><mrow id="alg1.l5.m3.1.1.1.1" xref="alg1.l5.m3.1.1.1.2.cmml"><mo id="alg1.l5.m3.1.1.1.1.2" stretchy="false" xref="alg1.l5.m3.1.1.1.2.1.cmml">‖</mo><msub id="alg1.l5.m3.1.1.1.1.1" xref="alg1.l5.m3.1.1.1.1.1.cmml"><mi id="alg1.l5.m3.1.1.1.1.1.2" xref="alg1.l5.m3.1.1.1.1.1.2.cmml">E</mi><mi id="alg1.l5.m3.1.1.1.1.1.3" xref="alg1.l5.m3.1.1.1.1.1.3.cmml">i</mi></msub><mo id="alg1.l5.m3.1.1.1.1.3" stretchy="false" xref="alg1.l5.m3.1.1.1.2.1.cmml">‖</mo></mrow></mfrac></mrow><annotation-xml encoding="MathML-Content" id="alg1.l5.m3.1b"><apply id="alg1.l5.m3.1.2.cmml" xref="alg1.l5.m3.1.2"><ci id="alg1.l5.m3.1.2.1.cmml" xref="alg1.l5.m3.1.2.1">←</ci><apply id="alg1.l5.m3.1.2.2.cmml" xref="alg1.l5.m3.1.2.2"><csymbol cd="ambiguous" id="alg1.l5.m3.1.2.2.1.cmml" xref="alg1.l5.m3.1.2.2">subscript</csymbol><ci id="alg1.l5.m3.1.2.2.2.cmml" xref="alg1.l5.m3.1.2.2.2">𝐸</ci><ci id="alg1.l5.m3.1.2.2.3.cmml" xref="alg1.l5.m3.1.2.2.3">𝑖</ci></apply><apply id="alg1.l5.m3.1.1.cmml" xref="alg1.l5.m3.1.1"><divide id="alg1.l5.m3.1.1.2.cmml" xref="alg1.l5.m3.1.1"></divide><apply id="alg1.l5.m3.1.1.3.cmml" xref="alg1.l5.m3.1.1.3"><csymbol cd="ambiguous" id="alg1.l5.m3.1.1.3.1.cmml" xref="alg1.l5.m3.1.1.3">subscript</csymbol><ci id="alg1.l5.m3.1.1.3.2.cmml" xref="alg1.l5.m3.1.1.3.2">𝐸</ci><ci id="alg1.l5.m3.1.1.3.3.cmml" xref="alg1.l5.m3.1.1.3.3">𝑖</ci></apply><apply id="alg1.l5.m3.1.1.1.2.cmml" xref="alg1.l5.m3.1.1.1.1"><csymbol cd="latexml" id="alg1.l5.m3.1.1.1.2.1.cmml" xref="alg1.l5.m3.1.1.1.1.2">norm</csymbol><apply id="alg1.l5.m3.1.1.1.1.1.cmml" xref="alg1.l5.m3.1.1.1.1.1"><csymbol cd="ambiguous" id="alg1.l5.m3.1.1.1.1.1.1.cmml" xref="alg1.l5.m3.1.1.1.1.1">subscript</csymbol><ci id="alg1.l5.m3.1.1.1.1.1.2.cmml" xref="alg1.l5.m3.1.1.1.1.1.2">𝐸</ci><ci id="alg1.l5.m3.1.1.1.1.1.3.cmml" xref="alg1.l5.m3.1.1.1.1.1.3">𝑖</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l5.m3.1c">E_{i}\leftarrow\frac{E_{i}}{\|E_{i}\|}</annotation><annotation encoding="application/x-llamapun" id="alg1.l5.m3.1d">italic_E start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT ← divide start_ARG italic_E start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT end_ARG start_ARG ∥ italic_E start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT ∥ end_ARG</annotation></semantics></math>
</div>
<div class="ltx_listingline" id="alg1.l6">
<math alttext="\forall 1\leq i\leq n" class="ltx_Math" display="inline" id="alg1.l6.m1.1"><semantics id="alg1.l6.m1.1a"><mrow id="alg1.l6.m1.1.1" xref="alg1.l6.m1.1.1.cmml"><mrow id="alg1.l6.m1.1.1.2" xref="alg1.l6.m1.1.1.2.cmml"><mo id="alg1.l6.m1.1.1.2.1" rspace="0.167em" xref="alg1.l6.m1.1.1.2.1.cmml">∀</mo><mn id="alg1.l6.m1.1.1.2.2" xref="alg1.l6.m1.1.1.2.2.cmml">1</mn></mrow><mo id="alg1.l6.m1.1.1.3" xref="alg1.l6.m1.1.1.3.cmml">≤</mo><mi id="alg1.l6.m1.1.1.4" xref="alg1.l6.m1.1.1.4.cmml">i</mi><mo id="alg1.l6.m1.1.1.5" xref="alg1.l6.m1.1.1.5.cmml">≤</mo><mi id="alg1.l6.m1.1.1.6" xref="alg1.l6.m1.1.1.6.cmml">n</mi></mrow><annotation-xml encoding="MathML-Content" id="alg1.l6.m1.1b"><apply id="alg1.l6.m1.1.1.cmml" xref="alg1.l6.m1.1.1"><and id="alg1.l6.m1.1.1a.cmml" xref="alg1.l6.m1.1.1"></and><apply id="alg1.l6.m1.1.1b.cmml" xref="alg1.l6.m1.1.1"><leq id="alg1.l6.m1.1.1.3.cmml" xref="alg1.l6.m1.1.1.3"></leq><apply id="alg1.l6.m1.1.1.2.cmml" xref="alg1.l6.m1.1.1.2"><csymbol cd="latexml" id="alg1.l6.m1.1.1.2.1.cmml" xref="alg1.l6.m1.1.1.2.1">for-all</csymbol><cn id="alg1.l6.m1.1.1.2.2.cmml" type="integer" xref="alg1.l6.m1.1.1.2.2">1</cn></apply><ci id="alg1.l6.m1.1.1.4.cmml" xref="alg1.l6.m1.1.1.4">𝑖</ci></apply><apply id="alg1.l6.m1.1.1c.cmml" xref="alg1.l6.m1.1.1"><leq id="alg1.l6.m1.1.1.5.cmml" xref="alg1.l6.m1.1.1.5"></leq><share href="https://arxiv.org/html/2405.17587v2#alg1.l6.m1.1.1.4.cmml" id="alg1.l6.m1.1.1d.cmml" xref="alg1.l6.m1.1.1"></share><ci id="alg1.l6.m1.1.1.6.cmml" xref="alg1.l6.m1.1.1.6">𝑛</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l6.m1.1c">\forall 1\leq i\leq n</annotation><annotation encoding="application/x-llamapun" id="alg1.l6.m1.1d">∀ 1 ≤ italic_i ≤ italic_n</annotation></semantics></math>,  <math alttext="v_{i}\leftarrow\lambda_{b}QE_{i}^{\top}+(1-\lambda_{b})b_{i}" class="ltx_Math" display="inline" id="alg1.l6.m2.1"><semantics id="alg1.l6.m2.1a"><mrow id="alg1.l6.m2.1.1" xref="alg1.l6.m2.1.1.cmml"><msub id="alg1.l6.m2.1.1.3" xref="alg1.l6.m2.1.1.3.cmml"><mi id="alg1.l6.m2.1.1.3.2" xref="alg1.l6.m2.1.1.3.2.cmml">v</mi><mi id="alg1.l6.m2.1.1.3.3" xref="alg1.l6.m2.1.1.3.3.cmml">i</mi></msub><mo id="alg1.l6.m2.1.1.2" stretchy="false" xref="alg1.l6.m2.1.1.2.cmml">←</mo><mrow id="alg1.l6.m2.1.1.1" xref="alg1.l6.m2.1.1.1.cmml"><mrow id="alg1.l6.m2.1.1.1.3" xref="alg1.l6.m2.1.1.1.3.cmml"><msub id="alg1.l6.m2.1.1.1.3.2" xref="alg1.l6.m2.1.1.1.3.2.cmml"><mi id="alg1.l6.m2.1.1.1.3.2.2" xref="alg1.l6.m2.1.1.1.3.2.2.cmml">λ</mi><mi id="alg1.l6.m2.1.1.1.3.2.3" xref="alg1.l6.m2.1.1.1.3.2.3.cmml">b</mi></msub><mo id="alg1.l6.m2.1.1.1.3.1" xref="alg1.l6.m2.1.1.1.3.1.cmml">⁢</mo><mi id="alg1.l6.m2.1.1.1.3.3" xref="alg1.l6.m2.1.1.1.3.3.cmml">Q</mi><mo id="alg1.l6.m2.1.1.1.3.1a" xref="alg1.l6.m2.1.1.1.3.1.cmml">⁢</mo><msubsup id="alg1.l6.m2.1.1.1.3.4" xref="alg1.l6.m2.1.1.1.3.4.cmml"><mi id="alg1.l6.m2.1.1.1.3.4.2.2" xref="alg1.l6.m2.1.1.1.3.4.2.2.cmml">E</mi><mi id="alg1.l6.m2.1.1.1.3.4.2.3" xref="alg1.l6.m2.1.1.1.3.4.2.3.cmml">i</mi><mo id="alg1.l6.m2.1.1.1.3.4.3" xref="alg1.l6.m2.1.1.1.3.4.3.cmml">⊤</mo></msubsup></mrow><mo id="alg1.l6.m2.1.1.1.2" xref="alg1.l6.m2.1.1.1.2.cmml">+</mo><mrow id="alg1.l6.m2.1.1.1.1" xref="alg1.l6.m2.1.1.1.1.cmml"><mrow id="alg1.l6.m2.1.1.1.1.1.1" xref="alg1.l6.m2.1.1.1.1.1.1.1.cmml"><mo id="alg1.l6.m2.1.1.1.1.1.1.2" stretchy="false" xref="alg1.l6.m2.1.1.1.1.1.1.1.cmml">(</mo><mrow id="alg1.l6.m2.1.1.1.1.1.1.1" xref="alg1.l6.m2.1.1.1.1.1.1.1.cmml"><mn id="alg1.l6.m2.1.1.1.1.1.1.1.2" xref="alg1.l6.m2.1.1.1.1.1.1.1.2.cmml">1</mn><mo id="alg1.l6.m2.1.1.1.1.1.1.1.1" xref="alg1.l6.m2.1.1.1.1.1.1.1.1.cmml">−</mo><msub id="alg1.l6.m2.1.1.1.1.1.1.1.3" xref="alg1.l6.m2.1.1.1.1.1.1.1.3.cmml"><mi id="alg1.l6.m2.1.1.1.1.1.1.1.3.2" xref="alg1.l6.m2.1.1.1.1.1.1.1.3.2.cmml">λ</mi><mi id="alg1.l6.m2.1.1.1.1.1.1.1.3.3" xref="alg1.l6.m2.1.1.1.1.1.1.1.3.3.cmml">b</mi></msub></mrow><mo id="alg1.l6.m2.1.1.1.1.1.1.3" stretchy="false" xref="alg1.l6.m2.1.1.1.1.1.1.1.cmml">)</mo></mrow><mo id="alg1.l6.m2.1.1.1.1.2" xref="alg1.l6.m2.1.1.1.1.2.cmml">⁢</mo><msub id="alg1.l6.m2.1.1.1.1.3" xref="alg1.l6.m2.1.1.1.1.3.cmml"><mi id="alg1.l6.m2.1.1.1.1.3.2" xref="alg1.l6.m2.1.1.1.1.3.2.cmml">b</mi><mi id="alg1.l6.m2.1.1.1.1.3.3" xref="alg1.l6.m2.1.1.1.1.3.3.cmml">i</mi></msub></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l6.m2.1b"><apply id="alg1.l6.m2.1.1.cmml" xref="alg1.l6.m2.1.1"><ci id="alg1.l6.m2.1.1.2.cmml" xref="alg1.l6.m2.1.1.2">←</ci><apply id="alg1.l6.m2.1.1.3.cmml" xref="alg1.l6.m2.1.1.3"><csymbol cd="ambiguous" id="alg1.l6.m2.1.1.3.1.cmml" xref="alg1.l6.m2.1.1.3">subscript</csymbol><ci id="alg1.l6.m2.1.1.3.2.cmml" xref="alg1.l6.m2.1.1.3.2">𝑣</ci><ci id="alg1.l6.m2.1.1.3.3.cmml" xref="alg1.l6.m2.1.1.3.3">𝑖</ci></apply><apply id="alg1.l6.m2.1.1.1.cmml" xref="alg1.l6.m2.1.1.1"><plus id="alg1.l6.m2.1.1.1.2.cmml" xref="alg1.l6.m2.1.1.1.2"></plus><apply id="alg1.l6.m2.1.1.1.3.cmml" xref="alg1.l6.m2.1.1.1.3"><times id="alg1.l6.m2.1.1.1.3.1.cmml" xref="alg1.l6.m2.1.1.1.3.1"></times><apply id="alg1.l6.m2.1.1.1.3.2.cmml" xref="alg1.l6.m2.1.1.1.3.2"><csymbol cd="ambiguous" id="alg1.l6.m2.1.1.1.3.2.1.cmml" xref="alg1.l6.m2.1.1.1.3.2">subscript</csymbol><ci id="alg1.l6.m2.1.1.1.3.2.2.cmml" xref="alg1.l6.m2.1.1.1.3.2.2">𝜆</ci><ci id="alg1.l6.m2.1.1.1.3.2.3.cmml" xref="alg1.l6.m2.1.1.1.3.2.3">𝑏</ci></apply><ci id="alg1.l6.m2.1.1.1.3.3.cmml" xref="alg1.l6.m2.1.1.1.3.3">𝑄</ci><apply id="alg1.l6.m2.1.1.1.3.4.cmml" xref="alg1.l6.m2.1.1.1.3.4"><csymbol cd="ambiguous" id="alg1.l6.m2.1.1.1.3.4.1.cmml" xref="alg1.l6.m2.1.1.1.3.4">superscript</csymbol><apply id="alg1.l6.m2.1.1.1.3.4.2.cmml" xref="alg1.l6.m2.1.1.1.3.4"><csymbol cd="ambiguous" id="alg1.l6.m2.1.1.1.3.4.2.1.cmml" xref="alg1.l6.m2.1.1.1.3.4">subscript</csymbol><ci id="alg1.l6.m2.1.1.1.3.4.2.2.cmml" xref="alg1.l6.m2.1.1.1.3.4.2.2">𝐸</ci><ci id="alg1.l6.m2.1.1.1.3.4.2.3.cmml" xref="alg1.l6.m2.1.1.1.3.4.2.3">𝑖</ci></apply><csymbol cd="latexml" id="alg1.l6.m2.1.1.1.3.4.3.cmml" xref="alg1.l6.m2.1.1.1.3.4.3">top</csymbol></apply></apply><apply id="alg1.l6.m2.1.1.1.1.cmml" xref="alg1.l6.m2.1.1.1.1"><times id="alg1.l6.m2.1.1.1.1.2.cmml" xref="alg1.l6.m2.1.1.1.1.2"></times><apply id="alg1.l6.m2.1.1.1.1.1.1.1.cmml" xref="alg1.l6.m2.1.1.1.1.1.1"><minus id="alg1.l6.m2.1.1.1.1.1.1.1.1.cmml" xref="alg1.l6.m2.1.1.1.1.1.1.1.1"></minus><cn id="alg1.l6.m2.1.1.1.1.1.1.1.2.cmml" type="integer" xref="alg1.l6.m2.1.1.1.1.1.1.1.2">1</cn><apply id="alg1.l6.m2.1.1.1.1.1.1.1.3.cmml" xref="alg1.l6.m2.1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="alg1.l6.m2.1.1.1.1.1.1.1.3.1.cmml" xref="alg1.l6.m2.1.1.1.1.1.1.1.3">subscript</csymbol><ci id="alg1.l6.m2.1.1.1.1.1.1.1.3.2.cmml" xref="alg1.l6.m2.1.1.1.1.1.1.1.3.2">𝜆</ci><ci id="alg1.l6.m2.1.1.1.1.1.1.1.3.3.cmml" xref="alg1.l6.m2.1.1.1.1.1.1.1.3.3">𝑏</ci></apply></apply><apply id="alg1.l6.m2.1.1.1.1.3.cmml" xref="alg1.l6.m2.1.1.1.1.3"><csymbol cd="ambiguous" id="alg1.l6.m2.1.1.1.1.3.1.cmml" xref="alg1.l6.m2.1.1.1.1.3">subscript</csymbol><ci id="alg1.l6.m2.1.1.1.1.3.2.cmml" xref="alg1.l6.m2.1.1.1.1.3.2">𝑏</ci><ci id="alg1.l6.m2.1.1.1.1.3.3.cmml" xref="alg1.l6.m2.1.1.1.1.3.3">𝑖</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l6.m2.1c">v_{i}\leftarrow\lambda_{b}QE_{i}^{\top}+(1-\lambda_{b})b_{i}</annotation><annotation encoding="application/x-llamapun" id="alg1.l6.m2.1d">italic_v start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT ← italic_λ start_POSTSUBSCRIPT italic_b end_POSTSUBSCRIPT italic_Q italic_E start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ⊤ end_POSTSUPERSCRIPT + ( 1 - italic_λ start_POSTSUBSCRIPT italic_b end_POSTSUBSCRIPT ) italic_b start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT</annotation></semantics></math>
</div>
<div class="ltx_listingline" id="alg1.l7">
<math alttext="C_{1}\leftarrow\arg\max_{i}v_{i}" class="ltx_Math" display="inline" id="alg1.l7.m1.1"><semantics id="alg1.l7.m1.1a"><mrow id="alg1.l7.m1.1.1" xref="alg1.l7.m1.1.1.cmml"><msub id="alg1.l7.m1.1.1.2" xref="alg1.l7.m1.1.1.2.cmml"><mi id="alg1.l7.m1.1.1.2.2" xref="alg1.l7.m1.1.1.2.2.cmml">C</mi><mn id="alg1.l7.m1.1.1.2.3" xref="alg1.l7.m1.1.1.2.3.cmml">1</mn></msub><mo id="alg1.l7.m1.1.1.1" stretchy="false" xref="alg1.l7.m1.1.1.1.cmml">←</mo><mrow id="alg1.l7.m1.1.1.3" xref="alg1.l7.m1.1.1.3.cmml"><mi id="alg1.l7.m1.1.1.3.1" xref="alg1.l7.m1.1.1.3.1.cmml">arg</mi><mo id="alg1.l7.m1.1.1.3a" lspace="0.167em" xref="alg1.l7.m1.1.1.3.cmml">⁡</mo><mrow id="alg1.l7.m1.1.1.3.2" xref="alg1.l7.m1.1.1.3.2.cmml"><msub id="alg1.l7.m1.1.1.3.2.1" xref="alg1.l7.m1.1.1.3.2.1.cmml"><mi id="alg1.l7.m1.1.1.3.2.1.2" xref="alg1.l7.m1.1.1.3.2.1.2.cmml">max</mi><mi id="alg1.l7.m1.1.1.3.2.1.3" xref="alg1.l7.m1.1.1.3.2.1.3.cmml">i</mi></msub><mo id="alg1.l7.m1.1.1.3.2a" lspace="0.167em" xref="alg1.l7.m1.1.1.3.2.cmml">⁡</mo><msub id="alg1.l7.m1.1.1.3.2.2" xref="alg1.l7.m1.1.1.3.2.2.cmml"><mi id="alg1.l7.m1.1.1.3.2.2.2" xref="alg1.l7.m1.1.1.3.2.2.2.cmml">v</mi><mi id="alg1.l7.m1.1.1.3.2.2.3" xref="alg1.l7.m1.1.1.3.2.2.3.cmml">i</mi></msub></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l7.m1.1b"><apply id="alg1.l7.m1.1.1.cmml" xref="alg1.l7.m1.1.1"><ci id="alg1.l7.m1.1.1.1.cmml" xref="alg1.l7.m1.1.1.1">←</ci><apply id="alg1.l7.m1.1.1.2.cmml" xref="alg1.l7.m1.1.1.2"><csymbol cd="ambiguous" id="alg1.l7.m1.1.1.2.1.cmml" xref="alg1.l7.m1.1.1.2">subscript</csymbol><ci id="alg1.l7.m1.1.1.2.2.cmml" xref="alg1.l7.m1.1.1.2.2">𝐶</ci><cn id="alg1.l7.m1.1.1.2.3.cmml" type="integer" xref="alg1.l7.m1.1.1.2.3">1</cn></apply><apply id="alg1.l7.m1.1.1.3.cmml" xref="alg1.l7.m1.1.1.3"><arg id="alg1.l7.m1.1.1.3.1.cmml" xref="alg1.l7.m1.1.1.3.1"></arg><apply id="alg1.l7.m1.1.1.3.2.cmml" xref="alg1.l7.m1.1.1.3.2"><apply id="alg1.l7.m1.1.1.3.2.1.cmml" xref="alg1.l7.m1.1.1.3.2.1"><csymbol cd="ambiguous" id="alg1.l7.m1.1.1.3.2.1.1.cmml" xref="alg1.l7.m1.1.1.3.2.1">subscript</csymbol><max id="alg1.l7.m1.1.1.3.2.1.2.cmml" xref="alg1.l7.m1.1.1.3.2.1.2"></max><ci id="alg1.l7.m1.1.1.3.2.1.3.cmml" xref="alg1.l7.m1.1.1.3.2.1.3">𝑖</ci></apply><apply id="alg1.l7.m1.1.1.3.2.2.cmml" xref="alg1.l7.m1.1.1.3.2.2"><csymbol cd="ambiguous" id="alg1.l7.m1.1.1.3.2.2.1.cmml" xref="alg1.l7.m1.1.1.3.2.2">subscript</csymbol><ci id="alg1.l7.m1.1.1.3.2.2.2.cmml" xref="alg1.l7.m1.1.1.3.2.2.2">𝑣</ci><ci id="alg1.l7.m1.1.1.3.2.2.3.cmml" xref="alg1.l7.m1.1.1.3.2.2.3">𝑖</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l7.m1.1c">C_{1}\leftarrow\arg\max_{i}v_{i}</annotation><annotation encoding="application/x-llamapun" id="alg1.l7.m1.1d">italic_C start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT ← roman_arg roman_max start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT italic_v start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT</annotation></semantics></math>
</div>
<div class="ltx_listingline" id="alg1.l8">
<span class="ltx_text ltx_font_bold" id="alg1.l8.1">for</span> <math alttext="2\leq s\leq k" class="ltx_Math" display="inline" id="alg1.l8.m1.1"><semantics id="alg1.l8.m1.1a"><mrow id="alg1.l8.m1.1.1" xref="alg1.l8.m1.1.1.cmml"><mn id="alg1.l8.m1.1.1.2" xref="alg1.l8.m1.1.1.2.cmml">2</mn><mo id="alg1.l8.m1.1.1.3" xref="alg1.l8.m1.1.1.3.cmml">≤</mo><mi id="alg1.l8.m1.1.1.4" xref="alg1.l8.m1.1.1.4.cmml">s</mi><mo id="alg1.l8.m1.1.1.5" xref="alg1.l8.m1.1.1.5.cmml">≤</mo><mi id="alg1.l8.m1.1.1.6" xref="alg1.l8.m1.1.1.6.cmml">k</mi></mrow><annotation-xml encoding="MathML-Content" id="alg1.l8.m1.1b"><apply id="alg1.l8.m1.1.1.cmml" xref="alg1.l8.m1.1.1"><and id="alg1.l8.m1.1.1a.cmml" xref="alg1.l8.m1.1.1"></and><apply id="alg1.l8.m1.1.1b.cmml" xref="alg1.l8.m1.1.1"><leq id="alg1.l8.m1.1.1.3.cmml" xref="alg1.l8.m1.1.1.3"></leq><cn id="alg1.l8.m1.1.1.2.cmml" type="integer" xref="alg1.l8.m1.1.1.2">2</cn><ci id="alg1.l8.m1.1.1.4.cmml" xref="alg1.l8.m1.1.1.4">𝑠</ci></apply><apply id="alg1.l8.m1.1.1c.cmml" xref="alg1.l8.m1.1.1"><leq id="alg1.l8.m1.1.1.5.cmml" xref="alg1.l8.m1.1.1.5"></leq><share href="https://arxiv.org/html/2405.17587v2#alg1.l8.m1.1.1.4.cmml" id="alg1.l8.m1.1.1d.cmml" xref="alg1.l8.m1.1.1"></share><ci id="alg1.l8.m1.1.1.6.cmml" xref="alg1.l8.m1.1.1.6">𝑘</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l8.m1.1c">2\leq s\leq k</annotation><annotation encoding="application/x-llamapun" id="alg1.l8.m1.1d">2 ≤ italic_s ≤ italic_k</annotation></semantics></math> <span class="ltx_text ltx_font_bold" id="alg1.l8.2">do</span>
</div>
<div class="ltx_listingline" id="alg1.l9">     <math alttext="\forall 1\leq i\leq n" class="ltx_Math" display="inline" id="alg1.l9.m1.1"><semantics id="alg1.l9.m1.1a"><mrow id="alg1.l9.m1.1.1" xref="alg1.l9.m1.1.1.cmml"><mrow id="alg1.l9.m1.1.1.2" xref="alg1.l9.m1.1.1.2.cmml"><mo id="alg1.l9.m1.1.1.2.1" rspace="0.167em" xref="alg1.l9.m1.1.1.2.1.cmml">∀</mo><mn id="alg1.l9.m1.1.1.2.2" xref="alg1.l9.m1.1.1.2.2.cmml">1</mn></mrow><mo id="alg1.l9.m1.1.1.3" xref="alg1.l9.m1.1.1.3.cmml">≤</mo><mi id="alg1.l9.m1.1.1.4" xref="alg1.l9.m1.1.1.4.cmml">i</mi><mo id="alg1.l9.m1.1.1.5" xref="alg1.l9.m1.1.1.5.cmml">≤</mo><mi id="alg1.l9.m1.1.1.6" xref="alg1.l9.m1.1.1.6.cmml">n</mi></mrow><annotation-xml encoding="MathML-Content" id="alg1.l9.m1.1b"><apply id="alg1.l9.m1.1.1.cmml" xref="alg1.l9.m1.1.1"><and id="alg1.l9.m1.1.1a.cmml" xref="alg1.l9.m1.1.1"></and><apply id="alg1.l9.m1.1.1b.cmml" xref="alg1.l9.m1.1.1"><leq id="alg1.l9.m1.1.1.3.cmml" xref="alg1.l9.m1.1.1.3"></leq><apply id="alg1.l9.m1.1.1.2.cmml" xref="alg1.l9.m1.1.1.2"><csymbol cd="latexml" id="alg1.l9.m1.1.1.2.1.cmml" xref="alg1.l9.m1.1.1.2.1">for-all</csymbol><cn id="alg1.l9.m1.1.1.2.2.cmml" type="integer" xref="alg1.l9.m1.1.1.2.2">1</cn></apply><ci id="alg1.l9.m1.1.1.4.cmml" xref="alg1.l9.m1.1.1.4">𝑖</ci></apply><apply id="alg1.l9.m1.1.1c.cmml" xref="alg1.l9.m1.1.1"><leq id="alg1.l9.m1.1.1.5.cmml" xref="alg1.l9.m1.1.1.5"></leq><share href="https://arxiv.org/html/2405.17587v2#alg1.l9.m1.1.1.4.cmml" id="alg1.l9.m1.1.1d.cmml" xref="alg1.l9.m1.1.1"></share><ci id="alg1.l9.m1.1.1.6.cmml" xref="alg1.l9.m1.1.1.6">𝑛</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l9.m1.1c">\forall 1\leq i\leq n</annotation><annotation encoding="application/x-llamapun" id="alg1.l9.m1.1d">∀ 1 ≤ italic_i ≤ italic_n</annotation></semantics></math>,  <math alttext="m_{i}\leftarrow\max_{1\leq j&lt;s}E_{i}E_{C_{j}}^{\top}" class="ltx_Math" display="inline" id="alg1.l9.m2.1"><semantics id="alg1.l9.m2.1a"><mrow id="alg1.l9.m2.1.1" xref="alg1.l9.m2.1.1.cmml"><msub id="alg1.l9.m2.1.1.2" xref="alg1.l9.m2.1.1.2.cmml"><mi id="alg1.l9.m2.1.1.2.2" xref="alg1.l9.m2.1.1.2.2.cmml">m</mi><mi id="alg1.l9.m2.1.1.2.3" xref="alg1.l9.m2.1.1.2.3.cmml">i</mi></msub><mo id="alg1.l9.m2.1.1.1" stretchy="false" xref="alg1.l9.m2.1.1.1.cmml">←</mo><mrow id="alg1.l9.m2.1.1.3" xref="alg1.l9.m2.1.1.3.cmml"><msub id="alg1.l9.m2.1.1.3.1" xref="alg1.l9.m2.1.1.3.1.cmml"><mi id="alg1.l9.m2.1.1.3.1.2" xref="alg1.l9.m2.1.1.3.1.2.cmml">max</mi><mrow id="alg1.l9.m2.1.1.3.1.3" xref="alg1.l9.m2.1.1.3.1.3.cmml"><mn id="alg1.l9.m2.1.1.3.1.3.2" xref="alg1.l9.m2.1.1.3.1.3.2.cmml">1</mn><mo id="alg1.l9.m2.1.1.3.1.3.3" xref="alg1.l9.m2.1.1.3.1.3.3.cmml">≤</mo><mi id="alg1.l9.m2.1.1.3.1.3.4" xref="alg1.l9.m2.1.1.3.1.3.4.cmml">j</mi><mo id="alg1.l9.m2.1.1.3.1.3.5" xref="alg1.l9.m2.1.1.3.1.3.5.cmml">&lt;</mo><mi id="alg1.l9.m2.1.1.3.1.3.6" xref="alg1.l9.m2.1.1.3.1.3.6.cmml">s</mi></mrow></msub><mo id="alg1.l9.m2.1.1.3a" lspace="0.167em" xref="alg1.l9.m2.1.1.3.cmml">⁡</mo><mrow id="alg1.l9.m2.1.1.3.2" xref="alg1.l9.m2.1.1.3.2.cmml"><msub id="alg1.l9.m2.1.1.3.2.2" xref="alg1.l9.m2.1.1.3.2.2.cmml"><mi id="alg1.l9.m2.1.1.3.2.2.2" xref="alg1.l9.m2.1.1.3.2.2.2.cmml">E</mi><mi id="alg1.l9.m2.1.1.3.2.2.3" xref="alg1.l9.m2.1.1.3.2.2.3.cmml">i</mi></msub><mo id="alg1.l9.m2.1.1.3.2.1" xref="alg1.l9.m2.1.1.3.2.1.cmml">⁢</mo><msubsup id="alg1.l9.m2.1.1.3.2.3" xref="alg1.l9.m2.1.1.3.2.3.cmml"><mi id="alg1.l9.m2.1.1.3.2.3.2.2" xref="alg1.l9.m2.1.1.3.2.3.2.2.cmml">E</mi><msub id="alg1.l9.m2.1.1.3.2.3.2.3" xref="alg1.l9.m2.1.1.3.2.3.2.3.cmml"><mi id="alg1.l9.m2.1.1.3.2.3.2.3.2" xref="alg1.l9.m2.1.1.3.2.3.2.3.2.cmml">C</mi><mi id="alg1.l9.m2.1.1.3.2.3.2.3.3" xref="alg1.l9.m2.1.1.3.2.3.2.3.3.cmml">j</mi></msub><mo id="alg1.l9.m2.1.1.3.2.3.3" xref="alg1.l9.m2.1.1.3.2.3.3.cmml">⊤</mo></msubsup></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l9.m2.1b"><apply id="alg1.l9.m2.1.1.cmml" xref="alg1.l9.m2.1.1"><ci id="alg1.l9.m2.1.1.1.cmml" xref="alg1.l9.m2.1.1.1">←</ci><apply id="alg1.l9.m2.1.1.2.cmml" xref="alg1.l9.m2.1.1.2"><csymbol cd="ambiguous" id="alg1.l9.m2.1.1.2.1.cmml" xref="alg1.l9.m2.1.1.2">subscript</csymbol><ci id="alg1.l9.m2.1.1.2.2.cmml" xref="alg1.l9.m2.1.1.2.2">𝑚</ci><ci id="alg1.l9.m2.1.1.2.3.cmml" xref="alg1.l9.m2.1.1.2.3">𝑖</ci></apply><apply id="alg1.l9.m2.1.1.3.cmml" xref="alg1.l9.m2.1.1.3"><apply id="alg1.l9.m2.1.1.3.1.cmml" xref="alg1.l9.m2.1.1.3.1"><csymbol cd="ambiguous" id="alg1.l9.m2.1.1.3.1.1.cmml" xref="alg1.l9.m2.1.1.3.1">subscript</csymbol><max id="alg1.l9.m2.1.1.3.1.2.cmml" xref="alg1.l9.m2.1.1.3.1.2"></max><apply id="alg1.l9.m2.1.1.3.1.3.cmml" xref="alg1.l9.m2.1.1.3.1.3"><and id="alg1.l9.m2.1.1.3.1.3a.cmml" xref="alg1.l9.m2.1.1.3.1.3"></and><apply id="alg1.l9.m2.1.1.3.1.3b.cmml" xref="alg1.l9.m2.1.1.3.1.3"><leq id="alg1.l9.m2.1.1.3.1.3.3.cmml" xref="alg1.l9.m2.1.1.3.1.3.3"></leq><cn id="alg1.l9.m2.1.1.3.1.3.2.cmml" type="integer" xref="alg1.l9.m2.1.1.3.1.3.2">1</cn><ci id="alg1.l9.m2.1.1.3.1.3.4.cmml" xref="alg1.l9.m2.1.1.3.1.3.4">𝑗</ci></apply><apply id="alg1.l9.m2.1.1.3.1.3c.cmml" xref="alg1.l9.m2.1.1.3.1.3"><lt id="alg1.l9.m2.1.1.3.1.3.5.cmml" xref="alg1.l9.m2.1.1.3.1.3.5"></lt><share href="https://arxiv.org/html/2405.17587v2#alg1.l9.m2.1.1.3.1.3.4.cmml" id="alg1.l9.m2.1.1.3.1.3d.cmml" xref="alg1.l9.m2.1.1.3.1.3"></share><ci id="alg1.l9.m2.1.1.3.1.3.6.cmml" xref="alg1.l9.m2.1.1.3.1.3.6">𝑠</ci></apply></apply></apply><apply id="alg1.l9.m2.1.1.3.2.cmml" xref="alg1.l9.m2.1.1.3.2"><times id="alg1.l9.m2.1.1.3.2.1.cmml" xref="alg1.l9.m2.1.1.3.2.1"></times><apply id="alg1.l9.m2.1.1.3.2.2.cmml" xref="alg1.l9.m2.1.1.3.2.2"><csymbol cd="ambiguous" id="alg1.l9.m2.1.1.3.2.2.1.cmml" xref="alg1.l9.m2.1.1.3.2.2">subscript</csymbol><ci id="alg1.l9.m2.1.1.3.2.2.2.cmml" xref="alg1.l9.m2.1.1.3.2.2.2">𝐸</ci><ci id="alg1.l9.m2.1.1.3.2.2.3.cmml" xref="alg1.l9.m2.1.1.3.2.2.3">𝑖</ci></apply><apply id="alg1.l9.m2.1.1.3.2.3.cmml" xref="alg1.l9.m2.1.1.3.2.3"><csymbol cd="ambiguous" id="alg1.l9.m2.1.1.3.2.3.1.cmml" xref="alg1.l9.m2.1.1.3.2.3">superscript</csymbol><apply id="alg1.l9.m2.1.1.3.2.3.2.cmml" xref="alg1.l9.m2.1.1.3.2.3"><csymbol cd="ambiguous" id="alg1.l9.m2.1.1.3.2.3.2.1.cmml" xref="alg1.l9.m2.1.1.3.2.3">subscript</csymbol><ci id="alg1.l9.m2.1.1.3.2.3.2.2.cmml" xref="alg1.l9.m2.1.1.3.2.3.2.2">𝐸</ci><apply id="alg1.l9.m2.1.1.3.2.3.2.3.cmml" xref="alg1.l9.m2.1.1.3.2.3.2.3"><csymbol cd="ambiguous" id="alg1.l9.m2.1.1.3.2.3.2.3.1.cmml" xref="alg1.l9.m2.1.1.3.2.3.2.3">subscript</csymbol><ci id="alg1.l9.m2.1.1.3.2.3.2.3.2.cmml" xref="alg1.l9.m2.1.1.3.2.3.2.3.2">𝐶</ci><ci id="alg1.l9.m2.1.1.3.2.3.2.3.3.cmml" xref="alg1.l9.m2.1.1.3.2.3.2.3.3">𝑗</ci></apply></apply><csymbol cd="latexml" id="alg1.l9.m2.1.1.3.2.3.3.cmml" xref="alg1.l9.m2.1.1.3.2.3.3">top</csymbol></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l9.m2.1c">m_{i}\leftarrow\max_{1\leq j&lt;s}E_{i}E_{C_{j}}^{\top}</annotation><annotation encoding="application/x-llamapun" id="alg1.l9.m2.1d">italic_m start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT ← roman_max start_POSTSUBSCRIPT 1 ≤ italic_j &lt; italic_s end_POSTSUBSCRIPT italic_E start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT italic_E start_POSTSUBSCRIPT italic_C start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ⊤ end_POSTSUPERSCRIPT</annotation></semantics></math>
</div>
<div class="ltx_listingline" id="alg1.l10">     <math alttext="\forall 1\leq i\leq n" class="ltx_Math" display="inline" id="alg1.l10.m1.1"><semantics id="alg1.l10.m1.1a"><mrow id="alg1.l10.m1.1.1" xref="alg1.l10.m1.1.1.cmml"><mrow id="alg1.l10.m1.1.1.2" xref="alg1.l10.m1.1.1.2.cmml"><mo id="alg1.l10.m1.1.1.2.1" rspace="0.167em" xref="alg1.l10.m1.1.1.2.1.cmml">∀</mo><mn id="alg1.l10.m1.1.1.2.2" xref="alg1.l10.m1.1.1.2.2.cmml">1</mn></mrow><mo id="alg1.l10.m1.1.1.3" xref="alg1.l10.m1.1.1.3.cmml">≤</mo><mi id="alg1.l10.m1.1.1.4" xref="alg1.l10.m1.1.1.4.cmml">i</mi><mo id="alg1.l10.m1.1.1.5" xref="alg1.l10.m1.1.1.5.cmml">≤</mo><mi id="alg1.l10.m1.1.1.6" xref="alg1.l10.m1.1.1.6.cmml">n</mi></mrow><annotation-xml encoding="MathML-Content" id="alg1.l10.m1.1b"><apply id="alg1.l10.m1.1.1.cmml" xref="alg1.l10.m1.1.1"><and id="alg1.l10.m1.1.1a.cmml" xref="alg1.l10.m1.1.1"></and><apply id="alg1.l10.m1.1.1b.cmml" xref="alg1.l10.m1.1.1"><leq id="alg1.l10.m1.1.1.3.cmml" xref="alg1.l10.m1.1.1.3"></leq><apply id="alg1.l10.m1.1.1.2.cmml" xref="alg1.l10.m1.1.1.2"><csymbol cd="latexml" id="alg1.l10.m1.1.1.2.1.cmml" xref="alg1.l10.m1.1.1.2.1">for-all</csymbol><cn id="alg1.l10.m1.1.1.2.2.cmml" type="integer" xref="alg1.l10.m1.1.1.2.2">1</cn></apply><ci id="alg1.l10.m1.1.1.4.cmml" xref="alg1.l10.m1.1.1.4">𝑖</ci></apply><apply id="alg1.l10.m1.1.1c.cmml" xref="alg1.l10.m1.1.1"><leq id="alg1.l10.m1.1.1.5.cmml" xref="alg1.l10.m1.1.1.5"></leq><share href="https://arxiv.org/html/2405.17587v2#alg1.l10.m1.1.1.4.cmml" id="alg1.l10.m1.1.1d.cmml" xref="alg1.l10.m1.1.1"></share><ci id="alg1.l10.m1.1.1.6.cmml" xref="alg1.l10.m1.1.1.6">𝑛</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l10.m1.1c">\forall 1\leq i\leq n</annotation><annotation encoding="application/x-llamapun" id="alg1.l10.m1.1d">∀ 1 ≤ italic_i ≤ italic_n</annotation></semantics></math>,  <math alttext="w_{i}\leftarrow\lambda_{d}v_{i}-(1-\lambda_{d})m_{i}" class="ltx_Math" display="inline" id="alg1.l10.m2.1"><semantics id="alg1.l10.m2.1a"><mrow id="alg1.l10.m2.1.1" xref="alg1.l10.m2.1.1.cmml"><msub id="alg1.l10.m2.1.1.3" xref="alg1.l10.m2.1.1.3.cmml"><mi id="alg1.l10.m2.1.1.3.2" xref="alg1.l10.m2.1.1.3.2.cmml">w</mi><mi id="alg1.l10.m2.1.1.3.3" xref="alg1.l10.m2.1.1.3.3.cmml">i</mi></msub><mo id="alg1.l10.m2.1.1.2" stretchy="false" xref="alg1.l10.m2.1.1.2.cmml">←</mo><mrow id="alg1.l10.m2.1.1.1" xref="alg1.l10.m2.1.1.1.cmml"><mrow id="alg1.l10.m2.1.1.1.3" xref="alg1.l10.m2.1.1.1.3.cmml"><msub id="alg1.l10.m2.1.1.1.3.2" xref="alg1.l10.m2.1.1.1.3.2.cmml"><mi id="alg1.l10.m2.1.1.1.3.2.2" xref="alg1.l10.m2.1.1.1.3.2.2.cmml">λ</mi><mi id="alg1.l10.m2.1.1.1.3.2.3" xref="alg1.l10.m2.1.1.1.3.2.3.cmml">d</mi></msub><mo id="alg1.l10.m2.1.1.1.3.1" xref="alg1.l10.m2.1.1.1.3.1.cmml">⁢</mo><msub id="alg1.l10.m2.1.1.1.3.3" xref="alg1.l10.m2.1.1.1.3.3.cmml"><mi id="alg1.l10.m2.1.1.1.3.3.2" xref="alg1.l10.m2.1.1.1.3.3.2.cmml">v</mi><mi id="alg1.l10.m2.1.1.1.3.3.3" xref="alg1.l10.m2.1.1.1.3.3.3.cmml">i</mi></msub></mrow><mo id="alg1.l10.m2.1.1.1.2" xref="alg1.l10.m2.1.1.1.2.cmml">−</mo><mrow id="alg1.l10.m2.1.1.1.1" xref="alg1.l10.m2.1.1.1.1.cmml"><mrow id="alg1.l10.m2.1.1.1.1.1.1" xref="alg1.l10.m2.1.1.1.1.1.1.1.cmml"><mo id="alg1.l10.m2.1.1.1.1.1.1.2" stretchy="false" xref="alg1.l10.m2.1.1.1.1.1.1.1.cmml">(</mo><mrow id="alg1.l10.m2.1.1.1.1.1.1.1" xref="alg1.l10.m2.1.1.1.1.1.1.1.cmml"><mn id="alg1.l10.m2.1.1.1.1.1.1.1.2" xref="alg1.l10.m2.1.1.1.1.1.1.1.2.cmml">1</mn><mo id="alg1.l10.m2.1.1.1.1.1.1.1.1" xref="alg1.l10.m2.1.1.1.1.1.1.1.1.cmml">−</mo><msub id="alg1.l10.m2.1.1.1.1.1.1.1.3" xref="alg1.l10.m2.1.1.1.1.1.1.1.3.cmml"><mi id="alg1.l10.m2.1.1.1.1.1.1.1.3.2" xref="alg1.l10.m2.1.1.1.1.1.1.1.3.2.cmml">λ</mi><mi id="alg1.l10.m2.1.1.1.1.1.1.1.3.3" xref="alg1.l10.m2.1.1.1.1.1.1.1.3.3.cmml">d</mi></msub></mrow><mo id="alg1.l10.m2.1.1.1.1.1.1.3" stretchy="false" xref="alg1.l10.m2.1.1.1.1.1.1.1.cmml">)</mo></mrow><mo id="alg1.l10.m2.1.1.1.1.2" xref="alg1.l10.m2.1.1.1.1.2.cmml">⁢</mo><msub id="alg1.l10.m2.1.1.1.1.3" xref="alg1.l10.m2.1.1.1.1.3.cmml"><mi id="alg1.l10.m2.1.1.1.1.3.2" xref="alg1.l10.m2.1.1.1.1.3.2.cmml">m</mi><mi id="alg1.l10.m2.1.1.1.1.3.3" xref="alg1.l10.m2.1.1.1.1.3.3.cmml">i</mi></msub></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l10.m2.1b"><apply id="alg1.l10.m2.1.1.cmml" xref="alg1.l10.m2.1.1"><ci id="alg1.l10.m2.1.1.2.cmml" xref="alg1.l10.m2.1.1.2">←</ci><apply id="alg1.l10.m2.1.1.3.cmml" xref="alg1.l10.m2.1.1.3"><csymbol cd="ambiguous" id="alg1.l10.m2.1.1.3.1.cmml" xref="alg1.l10.m2.1.1.3">subscript</csymbol><ci id="alg1.l10.m2.1.1.3.2.cmml" xref="alg1.l10.m2.1.1.3.2">𝑤</ci><ci id="alg1.l10.m2.1.1.3.3.cmml" xref="alg1.l10.m2.1.1.3.3">𝑖</ci></apply><apply id="alg1.l10.m2.1.1.1.cmml" xref="alg1.l10.m2.1.1.1"><minus id="alg1.l10.m2.1.1.1.2.cmml" xref="alg1.l10.m2.1.1.1.2"></minus><apply id="alg1.l10.m2.1.1.1.3.cmml" xref="alg1.l10.m2.1.1.1.3"><times id="alg1.l10.m2.1.1.1.3.1.cmml" xref="alg1.l10.m2.1.1.1.3.1"></times><apply id="alg1.l10.m2.1.1.1.3.2.cmml" xref="alg1.l10.m2.1.1.1.3.2"><csymbol cd="ambiguous" id="alg1.l10.m2.1.1.1.3.2.1.cmml" xref="alg1.l10.m2.1.1.1.3.2">subscript</csymbol><ci id="alg1.l10.m2.1.1.1.3.2.2.cmml" xref="alg1.l10.m2.1.1.1.3.2.2">𝜆</ci><ci id="alg1.l10.m2.1.1.1.3.2.3.cmml" xref="alg1.l10.m2.1.1.1.3.2.3">𝑑</ci></apply><apply id="alg1.l10.m2.1.1.1.3.3.cmml" xref="alg1.l10.m2.1.1.1.3.3"><csymbol cd="ambiguous" id="alg1.l10.m2.1.1.1.3.3.1.cmml" xref="alg1.l10.m2.1.1.1.3.3">subscript</csymbol><ci id="alg1.l10.m2.1.1.1.3.3.2.cmml" xref="alg1.l10.m2.1.1.1.3.3.2">𝑣</ci><ci id="alg1.l10.m2.1.1.1.3.3.3.cmml" xref="alg1.l10.m2.1.1.1.3.3.3">𝑖</ci></apply></apply><apply id="alg1.l10.m2.1.1.1.1.cmml" xref="alg1.l10.m2.1.1.1.1"><times id="alg1.l10.m2.1.1.1.1.2.cmml" xref="alg1.l10.m2.1.1.1.1.2"></times><apply id="alg1.l10.m2.1.1.1.1.1.1.1.cmml" xref="alg1.l10.m2.1.1.1.1.1.1"><minus id="alg1.l10.m2.1.1.1.1.1.1.1.1.cmml" xref="alg1.l10.m2.1.1.1.1.1.1.1.1"></minus><cn id="alg1.l10.m2.1.1.1.1.1.1.1.2.cmml" type="integer" xref="alg1.l10.m2.1.1.1.1.1.1.1.2">1</cn><apply id="alg1.l10.m2.1.1.1.1.1.1.1.3.cmml" xref="alg1.l10.m2.1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="alg1.l10.m2.1.1.1.1.1.1.1.3.1.cmml" xref="alg1.l10.m2.1.1.1.1.1.1.1.3">subscript</csymbol><ci id="alg1.l10.m2.1.1.1.1.1.1.1.3.2.cmml" xref="alg1.l10.m2.1.1.1.1.1.1.1.3.2">𝜆</ci><ci id="alg1.l10.m2.1.1.1.1.1.1.1.3.3.cmml" xref="alg1.l10.m2.1.1.1.1.1.1.1.3.3">𝑑</ci></apply></apply><apply id="alg1.l10.m2.1.1.1.1.3.cmml" xref="alg1.l10.m2.1.1.1.1.3"><csymbol cd="ambiguous" id="alg1.l10.m2.1.1.1.1.3.1.cmml" xref="alg1.l10.m2.1.1.1.1.3">subscript</csymbol><ci id="alg1.l10.m2.1.1.1.1.3.2.cmml" xref="alg1.l10.m2.1.1.1.1.3.2">𝑚</ci><ci id="alg1.l10.m2.1.1.1.1.3.3.cmml" xref="alg1.l10.m2.1.1.1.1.3.3">𝑖</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l10.m2.1c">w_{i}\leftarrow\lambda_{d}v_{i}-(1-\lambda_{d})m_{i}</annotation><annotation encoding="application/x-llamapun" id="alg1.l10.m2.1d">italic_w start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT ← italic_λ start_POSTSUBSCRIPT italic_d end_POSTSUBSCRIPT italic_v start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT - ( 1 - italic_λ start_POSTSUBSCRIPT italic_d end_POSTSUBSCRIPT ) italic_m start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT</annotation></semantics></math>
</div>
<div class="ltx_listingline" id="alg1.l11">     <math alttext="C_{s}\leftarrow\arg\max_{i\notin\{C_{1},\dots,C_{s-1}\}}w_{i}" class="ltx_Math" display="inline" id="alg1.l11.m1.3"><semantics id="alg1.l11.m1.3a"><mrow id="alg1.l11.m1.3.4" xref="alg1.l11.m1.3.4.cmml"><msub id="alg1.l11.m1.3.4.2" xref="alg1.l11.m1.3.4.2.cmml"><mi id="alg1.l11.m1.3.4.2.2" xref="alg1.l11.m1.3.4.2.2.cmml">C</mi><mi id="alg1.l11.m1.3.4.2.3" xref="alg1.l11.m1.3.4.2.3.cmml">s</mi></msub><mo id="alg1.l11.m1.3.4.1" stretchy="false" xref="alg1.l11.m1.3.4.1.cmml">←</mo><mrow id="alg1.l11.m1.3.4.3" xref="alg1.l11.m1.3.4.3.cmml"><mi id="alg1.l11.m1.3.4.3.1" xref="alg1.l11.m1.3.4.3.1.cmml">arg</mi><mo id="alg1.l11.m1.3.4.3a" lspace="0.167em" xref="alg1.l11.m1.3.4.3.cmml">⁡</mo><mrow id="alg1.l11.m1.3.4.3.2" xref="alg1.l11.m1.3.4.3.2.cmml"><msub id="alg1.l11.m1.3.4.3.2.1" xref="alg1.l11.m1.3.4.3.2.1.cmml"><mi id="alg1.l11.m1.3.4.3.2.1.2" xref="alg1.l11.m1.3.4.3.2.1.2.cmml">max</mi><mrow id="alg1.l11.m1.3.3.3" xref="alg1.l11.m1.3.3.3.cmml"><mi id="alg1.l11.m1.3.3.3.5" xref="alg1.l11.m1.3.3.3.5.cmml">i</mi><mo id="alg1.l11.m1.3.3.3.4" xref="alg1.l11.m1.3.3.3.4.cmml">∉</mo><mrow id="alg1.l11.m1.3.3.3.3.2" xref="alg1.l11.m1.3.3.3.3.3.cmml"><mo id="alg1.l11.m1.3.3.3.3.2.3" stretchy="false" xref="alg1.l11.m1.3.3.3.3.3.cmml">{</mo><msub id="alg1.l11.m1.2.2.2.2.1.1" xref="alg1.l11.m1.2.2.2.2.1.1.cmml"><mi id="alg1.l11.m1.2.2.2.2.1.1.2" xref="alg1.l11.m1.2.2.2.2.1.1.2.cmml">C</mi><mn id="alg1.l11.m1.2.2.2.2.1.1.3" xref="alg1.l11.m1.2.2.2.2.1.1.3.cmml">1</mn></msub><mo id="alg1.l11.m1.3.3.3.3.2.4" xref="alg1.l11.m1.3.3.3.3.3.cmml">,</mo><mi id="alg1.l11.m1.1.1.1.1" mathvariant="normal" xref="alg1.l11.m1.1.1.1.1.cmml">…</mi><mo id="alg1.l11.m1.3.3.3.3.2.5" xref="alg1.l11.m1.3.3.3.3.3.cmml">,</mo><msub id="alg1.l11.m1.3.3.3.3.2.2" xref="alg1.l11.m1.3.3.3.3.2.2.cmml"><mi id="alg1.l11.m1.3.3.3.3.2.2.2" xref="alg1.l11.m1.3.3.3.3.2.2.2.cmml">C</mi><mrow id="alg1.l11.m1.3.3.3.3.2.2.3" xref="alg1.l11.m1.3.3.3.3.2.2.3.cmml"><mi id="alg1.l11.m1.3.3.3.3.2.2.3.2" xref="alg1.l11.m1.3.3.3.3.2.2.3.2.cmml">s</mi><mo id="alg1.l11.m1.3.3.3.3.2.2.3.1" xref="alg1.l11.m1.3.3.3.3.2.2.3.1.cmml">−</mo><mn id="alg1.l11.m1.3.3.3.3.2.2.3.3" xref="alg1.l11.m1.3.3.3.3.2.2.3.3.cmml">1</mn></mrow></msub><mo id="alg1.l11.m1.3.3.3.3.2.6" stretchy="false" xref="alg1.l11.m1.3.3.3.3.3.cmml">}</mo></mrow></mrow></msub><mo id="alg1.l11.m1.3.4.3.2a" lspace="0.167em" xref="alg1.l11.m1.3.4.3.2.cmml">⁡</mo><msub id="alg1.l11.m1.3.4.3.2.2" xref="alg1.l11.m1.3.4.3.2.2.cmml"><mi id="alg1.l11.m1.3.4.3.2.2.2" xref="alg1.l11.m1.3.4.3.2.2.2.cmml">w</mi><mi id="alg1.l11.m1.3.4.3.2.2.3" xref="alg1.l11.m1.3.4.3.2.2.3.cmml">i</mi></msub></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l11.m1.3b"><apply id="alg1.l11.m1.3.4.cmml" xref="alg1.l11.m1.3.4"><ci id="alg1.l11.m1.3.4.1.cmml" xref="alg1.l11.m1.3.4.1">←</ci><apply id="alg1.l11.m1.3.4.2.cmml" xref="alg1.l11.m1.3.4.2"><csymbol cd="ambiguous" id="alg1.l11.m1.3.4.2.1.cmml" xref="alg1.l11.m1.3.4.2">subscript</csymbol><ci id="alg1.l11.m1.3.4.2.2.cmml" xref="alg1.l11.m1.3.4.2.2">𝐶</ci><ci id="alg1.l11.m1.3.4.2.3.cmml" xref="alg1.l11.m1.3.4.2.3">𝑠</ci></apply><apply id="alg1.l11.m1.3.4.3.cmml" xref="alg1.l11.m1.3.4.3"><arg id="alg1.l11.m1.3.4.3.1.cmml" xref="alg1.l11.m1.3.4.3.1"></arg><apply id="alg1.l11.m1.3.4.3.2.cmml" xref="alg1.l11.m1.3.4.3.2"><apply id="alg1.l11.m1.3.4.3.2.1.cmml" xref="alg1.l11.m1.3.4.3.2.1"><csymbol cd="ambiguous" id="alg1.l11.m1.3.4.3.2.1.1.cmml" xref="alg1.l11.m1.3.4.3.2.1">subscript</csymbol><max id="alg1.l11.m1.3.4.3.2.1.2.cmml" xref="alg1.l11.m1.3.4.3.2.1.2"></max><apply id="alg1.l11.m1.3.3.3.cmml" xref="alg1.l11.m1.3.3.3"><notin id="alg1.l11.m1.3.3.3.4.cmml" xref="alg1.l11.m1.3.3.3.4"></notin><ci id="alg1.l11.m1.3.3.3.5.cmml" xref="alg1.l11.m1.3.3.3.5">𝑖</ci><set id="alg1.l11.m1.3.3.3.3.3.cmml" xref="alg1.l11.m1.3.3.3.3.2"><apply id="alg1.l11.m1.2.2.2.2.1.1.cmml" xref="alg1.l11.m1.2.2.2.2.1.1"><csymbol cd="ambiguous" id="alg1.l11.m1.2.2.2.2.1.1.1.cmml" xref="alg1.l11.m1.2.2.2.2.1.1">subscript</csymbol><ci id="alg1.l11.m1.2.2.2.2.1.1.2.cmml" xref="alg1.l11.m1.2.2.2.2.1.1.2">𝐶</ci><cn id="alg1.l11.m1.2.2.2.2.1.1.3.cmml" type="integer" xref="alg1.l11.m1.2.2.2.2.1.1.3">1</cn></apply><ci id="alg1.l11.m1.1.1.1.1.cmml" xref="alg1.l11.m1.1.1.1.1">…</ci><apply id="alg1.l11.m1.3.3.3.3.2.2.cmml" xref="alg1.l11.m1.3.3.3.3.2.2"><csymbol cd="ambiguous" id="alg1.l11.m1.3.3.3.3.2.2.1.cmml" xref="alg1.l11.m1.3.3.3.3.2.2">subscript</csymbol><ci id="alg1.l11.m1.3.3.3.3.2.2.2.cmml" xref="alg1.l11.m1.3.3.3.3.2.2.2">𝐶</ci><apply id="alg1.l11.m1.3.3.3.3.2.2.3.cmml" xref="alg1.l11.m1.3.3.3.3.2.2.3"><minus id="alg1.l11.m1.3.3.3.3.2.2.3.1.cmml" xref="alg1.l11.m1.3.3.3.3.2.2.3.1"></minus><ci id="alg1.l11.m1.3.3.3.3.2.2.3.2.cmml" xref="alg1.l11.m1.3.3.3.3.2.2.3.2">𝑠</ci><cn id="alg1.l11.m1.3.3.3.3.2.2.3.3.cmml" type="integer" xref="alg1.l11.m1.3.3.3.3.2.2.3.3">1</cn></apply></apply></set></apply></apply><apply id="alg1.l11.m1.3.4.3.2.2.cmml" xref="alg1.l11.m1.3.4.3.2.2"><csymbol cd="ambiguous" id="alg1.l11.m1.3.4.3.2.2.1.cmml" xref="alg1.l11.m1.3.4.3.2.2">subscript</csymbol><ci id="alg1.l11.m1.3.4.3.2.2.2.cmml" xref="alg1.l11.m1.3.4.3.2.2.2">𝑤</ci><ci id="alg1.l11.m1.3.4.3.2.2.3.cmml" xref="alg1.l11.m1.3.4.3.2.2.3">𝑖</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l11.m1.3c">C_{s}\leftarrow\arg\max_{i\notin\{C_{1},\dots,C_{s-1}\}}w_{i}</annotation><annotation encoding="application/x-llamapun" id="alg1.l11.m1.3d">italic_C start_POSTSUBSCRIPT italic_s end_POSTSUBSCRIPT ← roman_arg roman_max start_POSTSUBSCRIPT italic_i ∉ { italic_C start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT , … , italic_C start_POSTSUBSCRIPT italic_s - 1 end_POSTSUBSCRIPT } end_POSTSUBSCRIPT italic_w start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT</annotation></semantics></math>
</div>
<div class="ltx_listingline" id="alg1.l12">
<span class="ltx_text ltx_font_bold" id="alg1.l12.1">end</span> <span class="ltx_text ltx_font_bold" id="alg1.l12.2">for</span>
</div>
</div>
</figure>
</section>
</section>
</section>
<section class="ltx_section" id="S4">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">4 </span>Experiments</h2>
<section class="ltx_subsection" id="S4.SS1">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.1 </span>Experimental Setup</h3>
<section class="ltx_subsubsection" id="S4.SS1.SSS1">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">4.1.1 </span>The Dataset Choice</h4>
<div class="ltx_para" id="S4.SS1.SSS1.p1">
<p class="ltx_p" id="S4.SS1.SSS1.p1.1">We are interested in a publicly available dataset which meets the following criteria: it should have enough statistical power so that we can resolve small differences in accuracy, ideally it will have hundreds of examples or more; it doesn’t need to have vast amounts of data as this isn’t a typical setting for few-shot learning, and the cost of conducting experiments can become burdensome; it should provide correct and incorrect answers so that we can report classification metrics from Section <a class="ltx_ref" href="https://arxiv.org/html/2405.17587v2#S3.SS2.SSS1" title="3.2.1 Classification Metrics ‣ 3.2 Evaluation ‣ 3 Methodology ‣ RAGSys: Item-Cold-Start Recommender as RAG System"><span class="ltx_text ltx_ref_tag">3.2.1</span></a>; it should be big enough to contain similar examples with partially redundant information so the use of diversity can improve collective information presented to the LLM in a context.</p>
</div>
</section>
<section class="ltx_subsubsection" id="S4.SS1.SSS2">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">4.1.2 </span>The TruthfulQA Dataset</h4>
<div class="ltx_para" id="S4.SS1.SSS2.p1">
<p class="ltx_p" id="S4.SS1.SSS2.p1.2">We chose to conduct our experiments using the TruthfulQA dataset <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2405.17587v2#bib.bib48" title="">48</a>]</cite> which meets these requirements. The dataset contains 817 distinct examples, which yields a standard error in the range of 1% to 2% for accuracy measures in the range of 90% to 50%. Each example contains a single query, and a variable number of correct and incorrect answers. And by considering each distinct <math alttext="(q,a)" class="ltx_Math" display="inline" id="S4.SS1.SSS2.p1.1.m1.2"><semantics id="S4.SS1.SSS2.p1.1.m1.2a"><mrow id="S4.SS1.SSS2.p1.1.m1.2.3.2" xref="S4.SS1.SSS2.p1.1.m1.2.3.1.cmml"><mo id="S4.SS1.SSS2.p1.1.m1.2.3.2.1" stretchy="false" xref="S4.SS1.SSS2.p1.1.m1.2.3.1.cmml">(</mo><mi id="S4.SS1.SSS2.p1.1.m1.1.1" xref="S4.SS1.SSS2.p1.1.m1.1.1.cmml">q</mi><mo id="S4.SS1.SSS2.p1.1.m1.2.3.2.2" xref="S4.SS1.SSS2.p1.1.m1.2.3.1.cmml">,</mo><mi id="S4.SS1.SSS2.p1.1.m1.2.2" xref="S4.SS1.SSS2.p1.1.m1.2.2.cmml">a</mi><mo id="S4.SS1.SSS2.p1.1.m1.2.3.2.3" stretchy="false" xref="S4.SS1.SSS2.p1.1.m1.2.3.1.cmml">)</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.SSS2.p1.1.m1.2b"><interval closure="open" id="S4.SS1.SSS2.p1.1.m1.2.3.1.cmml" xref="S4.SS1.SSS2.p1.1.m1.2.3.2"><ci id="S4.SS1.SSS2.p1.1.m1.1.1.cmml" xref="S4.SS1.SSS2.p1.1.m1.1.1">𝑞</ci><ci id="S4.SS1.SSS2.p1.1.m1.2.2.cmml" xref="S4.SS1.SSS2.p1.1.m1.2.2">𝑎</ci></interval></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSS2.p1.1.m1.2c">(q,a)</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.SSS2.p1.1.m1.2d">( italic_q , italic_a )</annotation></semantics></math> pair as a demonstration for the purpose of building a context, the retriever is faced with similar demonstrations as multiple <math alttext="(q,a)" class="ltx_Math" display="inline" id="S4.SS1.SSS2.p1.2.m2.2"><semantics id="S4.SS1.SSS2.p1.2.m2.2a"><mrow id="S4.SS1.SSS2.p1.2.m2.2.3.2" xref="S4.SS1.SSS2.p1.2.m2.2.3.1.cmml"><mo id="S4.SS1.SSS2.p1.2.m2.2.3.2.1" stretchy="false" xref="S4.SS1.SSS2.p1.2.m2.2.3.1.cmml">(</mo><mi id="S4.SS1.SSS2.p1.2.m2.1.1" xref="S4.SS1.SSS2.p1.2.m2.1.1.cmml">q</mi><mo id="S4.SS1.SSS2.p1.2.m2.2.3.2.2" xref="S4.SS1.SSS2.p1.2.m2.2.3.1.cmml">,</mo><mi id="S4.SS1.SSS2.p1.2.m2.2.2" xref="S4.SS1.SSS2.p1.2.m2.2.2.cmml">a</mi><mo id="S4.SS1.SSS2.p1.2.m2.2.3.2.3" stretchy="false" xref="S4.SS1.SSS2.p1.2.m2.2.3.1.cmml">)</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.SSS2.p1.2.m2.2b"><interval closure="open" id="S4.SS1.SSS2.p1.2.m2.2.3.1.cmml" xref="S4.SS1.SSS2.p1.2.m2.2.3.2"><ci id="S4.SS1.SSS2.p1.2.m2.1.1.cmml" xref="S4.SS1.SSS2.p1.2.m2.1.1">𝑞</ci><ci id="S4.SS1.SSS2.p1.2.m2.2.2.cmml" xref="S4.SS1.SSS2.p1.2.m2.2.2">𝑎</ci></interval></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSS2.p1.2.m2.2c">(q,a)</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.SSS2.p1.2.m2.2d">( italic_q , italic_a )</annotation></semantics></math> pairs share the same query (on average, the dataset contains 3.5 correct answers for each query).</p>
</div>
</section>
<section class="ltx_subsubsection" id="S4.SS1.SSS3">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">4.1.3 </span>Generating Demonstrations Pairs and Triplets</h4>
<div class="ltx_para" id="S4.SS1.SSS3.p1">
<p class="ltx_p" id="S4.SS1.SSS3.p1.1">The dataset is used in three different ways in this paper:</p>
</div>
<div class="ltx_para" id="S4.SS1.SSS3.p2">
<ul class="ltx_itemize" id="S4.I1">
<li class="ltx_item" id="S4.I1.i1" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S4.I1.i1.p1">
<p class="ltx_p" id="S4.I1.i1.p1.1"><math alttext="\mathcal{D}_{MC}" class="ltx_Math" display="inline" id="S4.I1.i1.p1.1.m1.1"><semantics id="S4.I1.i1.p1.1.m1.1a"><msub id="S4.I1.i1.p1.1.m1.1.1" xref="S4.I1.i1.p1.1.m1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.I1.i1.p1.1.m1.1.1.2" xref="S4.I1.i1.p1.1.m1.1.1.2.cmml">𝒟</mi><mrow id="S4.I1.i1.p1.1.m1.1.1.3" xref="S4.I1.i1.p1.1.m1.1.1.3.cmml"><mi id="S4.I1.i1.p1.1.m1.1.1.3.2" xref="S4.I1.i1.p1.1.m1.1.1.3.2.cmml">M</mi><mo id="S4.I1.i1.p1.1.m1.1.1.3.1" xref="S4.I1.i1.p1.1.m1.1.1.3.1.cmml">⁢</mo><mi id="S4.I1.i1.p1.1.m1.1.1.3.3" xref="S4.I1.i1.p1.1.m1.1.1.3.3.cmml">C</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S4.I1.i1.p1.1.m1.1b"><apply id="S4.I1.i1.p1.1.m1.1.1.cmml" xref="S4.I1.i1.p1.1.m1.1.1"><csymbol cd="ambiguous" id="S4.I1.i1.p1.1.m1.1.1.1.cmml" xref="S4.I1.i1.p1.1.m1.1.1">subscript</csymbol><ci id="S4.I1.i1.p1.1.m1.1.1.2.cmml" xref="S4.I1.i1.p1.1.m1.1.1.2">𝒟</ci><apply id="S4.I1.i1.p1.1.m1.1.1.3.cmml" xref="S4.I1.i1.p1.1.m1.1.1.3"><times id="S4.I1.i1.p1.1.m1.1.1.3.1.cmml" xref="S4.I1.i1.p1.1.m1.1.1.3.1"></times><ci id="S4.I1.i1.p1.1.m1.1.1.3.2.cmml" xref="S4.I1.i1.p1.1.m1.1.1.3.2">𝑀</ci><ci id="S4.I1.i1.p1.1.m1.1.1.3.3.cmml" xref="S4.I1.i1.p1.1.m1.1.1.3.3">𝐶</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.I1.i1.p1.1.m1.1c">\mathcal{D}_{MC}</annotation><annotation encoding="application/x-llamapun" id="S4.I1.i1.p1.1.m1.1d">caligraphic_D start_POSTSUBSCRIPT italic_M italic_C end_POSTSUBSCRIPT</annotation></semantics></math>: this is the dataset as described in <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2405.17587v2#bib.bib48" title="">48</a>]</cite>. It contains 817 examples, each of which contains a variable number of correct and incorrect answers. The metrics MC1, MC2 and MC3, which can accept an arbitrary number of correct and incorrect answers as inputs, are calculated over this dataset.</p>
</div>
</li>
<li class="ltx_item" id="S4.I1.i2" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S4.I1.i2.p1">
<p class="ltx_p" id="S4.I1.i2.p1.3"><math alttext="\mathcal{D}_{DPO}" class="ltx_Math" display="inline" id="S4.I1.i2.p1.1.m1.1"><semantics id="S4.I1.i2.p1.1.m1.1a"><msub id="S4.I1.i2.p1.1.m1.1.1" xref="S4.I1.i2.p1.1.m1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.I1.i2.p1.1.m1.1.1.2" xref="S4.I1.i2.p1.1.m1.1.1.2.cmml">𝒟</mi><mrow id="S4.I1.i2.p1.1.m1.1.1.3" xref="S4.I1.i2.p1.1.m1.1.1.3.cmml"><mi id="S4.I1.i2.p1.1.m1.1.1.3.2" xref="S4.I1.i2.p1.1.m1.1.1.3.2.cmml">D</mi><mo id="S4.I1.i2.p1.1.m1.1.1.3.1" xref="S4.I1.i2.p1.1.m1.1.1.3.1.cmml">⁢</mo><mi id="S4.I1.i2.p1.1.m1.1.1.3.3" xref="S4.I1.i2.p1.1.m1.1.1.3.3.cmml">P</mi><mo id="S4.I1.i2.p1.1.m1.1.1.3.1a" xref="S4.I1.i2.p1.1.m1.1.1.3.1.cmml">⁢</mo><mi id="S4.I1.i2.p1.1.m1.1.1.3.4" xref="S4.I1.i2.p1.1.m1.1.1.3.4.cmml">O</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S4.I1.i2.p1.1.m1.1b"><apply id="S4.I1.i2.p1.1.m1.1.1.cmml" xref="S4.I1.i2.p1.1.m1.1.1"><csymbol cd="ambiguous" id="S4.I1.i2.p1.1.m1.1.1.1.cmml" xref="S4.I1.i2.p1.1.m1.1.1">subscript</csymbol><ci id="S4.I1.i2.p1.1.m1.1.1.2.cmml" xref="S4.I1.i2.p1.1.m1.1.1.2">𝒟</ci><apply id="S4.I1.i2.p1.1.m1.1.1.3.cmml" xref="S4.I1.i2.p1.1.m1.1.1.3"><times id="S4.I1.i2.p1.1.m1.1.1.3.1.cmml" xref="S4.I1.i2.p1.1.m1.1.1.3.1"></times><ci id="S4.I1.i2.p1.1.m1.1.1.3.2.cmml" xref="S4.I1.i2.p1.1.m1.1.1.3.2">𝐷</ci><ci id="S4.I1.i2.p1.1.m1.1.1.3.3.cmml" xref="S4.I1.i2.p1.1.m1.1.1.3.3">𝑃</ci><ci id="S4.I1.i2.p1.1.m1.1.1.3.4.cmml" xref="S4.I1.i2.p1.1.m1.1.1.3.4">𝑂</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.I1.i2.p1.1.m1.1c">\mathcal{D}_{DPO}</annotation><annotation encoding="application/x-llamapun" id="S4.I1.i2.p1.1.m1.1d">caligraphic_D start_POSTSUBSCRIPT italic_D italic_P italic_O end_POSTSUBSCRIPT</annotation></semantics></math>: this is the set of every distinct <math alttext="(q,a,\bar{a})" class="ltx_Math" display="inline" id="S4.I1.i2.p1.2.m2.3"><semantics id="S4.I1.i2.p1.2.m2.3a"><mrow id="S4.I1.i2.p1.2.m2.3.4.2" xref="S4.I1.i2.p1.2.m2.3.4.1.cmml"><mo id="S4.I1.i2.p1.2.m2.3.4.2.1" stretchy="false" xref="S4.I1.i2.p1.2.m2.3.4.1.cmml">(</mo><mi id="S4.I1.i2.p1.2.m2.1.1" xref="S4.I1.i2.p1.2.m2.1.1.cmml">q</mi><mo id="S4.I1.i2.p1.2.m2.3.4.2.2" xref="S4.I1.i2.p1.2.m2.3.4.1.cmml">,</mo><mi id="S4.I1.i2.p1.2.m2.2.2" xref="S4.I1.i2.p1.2.m2.2.2.cmml">a</mi><mo id="S4.I1.i2.p1.2.m2.3.4.2.3" xref="S4.I1.i2.p1.2.m2.3.4.1.cmml">,</mo><mover accent="true" id="S4.I1.i2.p1.2.m2.3.3" xref="S4.I1.i2.p1.2.m2.3.3.cmml"><mi id="S4.I1.i2.p1.2.m2.3.3.2" xref="S4.I1.i2.p1.2.m2.3.3.2.cmml">a</mi><mo id="S4.I1.i2.p1.2.m2.3.3.1" xref="S4.I1.i2.p1.2.m2.3.3.1.cmml">¯</mo></mover><mo id="S4.I1.i2.p1.2.m2.3.4.2.4" stretchy="false" xref="S4.I1.i2.p1.2.m2.3.4.1.cmml">)</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.I1.i2.p1.2.m2.3b"><vector id="S4.I1.i2.p1.2.m2.3.4.1.cmml" xref="S4.I1.i2.p1.2.m2.3.4.2"><ci id="S4.I1.i2.p1.2.m2.1.1.cmml" xref="S4.I1.i2.p1.2.m2.1.1">𝑞</ci><ci id="S4.I1.i2.p1.2.m2.2.2.cmml" xref="S4.I1.i2.p1.2.m2.2.2">𝑎</ci><apply id="S4.I1.i2.p1.2.m2.3.3.cmml" xref="S4.I1.i2.p1.2.m2.3.3"><ci id="S4.I1.i2.p1.2.m2.3.3.1.cmml" xref="S4.I1.i2.p1.2.m2.3.3.1">¯</ci><ci id="S4.I1.i2.p1.2.m2.3.3.2.cmml" xref="S4.I1.i2.p1.2.m2.3.3.2">𝑎</ci></apply></vector></annotation-xml><annotation encoding="application/x-tex" id="S4.I1.i2.p1.2.m2.3c">(q,a,\bar{a})</annotation><annotation encoding="application/x-llamapun" id="S4.I1.i2.p1.2.m2.3d">( italic_q , italic_a , over¯ start_ARG italic_a end_ARG )</annotation></semantics></math> triple contained in <math alttext="\mathcal{D}_{MC}" class="ltx_Math" display="inline" id="S4.I1.i2.p1.3.m3.1"><semantics id="S4.I1.i2.p1.3.m3.1a"><msub id="S4.I1.i2.p1.3.m3.1.1" xref="S4.I1.i2.p1.3.m3.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.I1.i2.p1.3.m3.1.1.2" xref="S4.I1.i2.p1.3.m3.1.1.2.cmml">𝒟</mi><mrow id="S4.I1.i2.p1.3.m3.1.1.3" xref="S4.I1.i2.p1.3.m3.1.1.3.cmml"><mi id="S4.I1.i2.p1.3.m3.1.1.3.2" xref="S4.I1.i2.p1.3.m3.1.1.3.2.cmml">M</mi><mo id="S4.I1.i2.p1.3.m3.1.1.3.1" xref="S4.I1.i2.p1.3.m3.1.1.3.1.cmml">⁢</mo><mi id="S4.I1.i2.p1.3.m3.1.1.3.3" xref="S4.I1.i2.p1.3.m3.1.1.3.3.cmml">C</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S4.I1.i2.p1.3.m3.1b"><apply id="S4.I1.i2.p1.3.m3.1.1.cmml" xref="S4.I1.i2.p1.3.m3.1.1"><csymbol cd="ambiguous" id="S4.I1.i2.p1.3.m3.1.1.1.cmml" xref="S4.I1.i2.p1.3.m3.1.1">subscript</csymbol><ci id="S4.I1.i2.p1.3.m3.1.1.2.cmml" xref="S4.I1.i2.p1.3.m3.1.1.2">𝒟</ci><apply id="S4.I1.i2.p1.3.m3.1.1.3.cmml" xref="S4.I1.i2.p1.3.m3.1.1.3"><times id="S4.I1.i2.p1.3.m3.1.1.3.1.cmml" xref="S4.I1.i2.p1.3.m3.1.1.3.1"></times><ci id="S4.I1.i2.p1.3.m3.1.1.3.2.cmml" xref="S4.I1.i2.p1.3.m3.1.1.3.2">𝑀</ci><ci id="S4.I1.i2.p1.3.m3.1.1.3.3.cmml" xref="S4.I1.i2.p1.3.m3.1.1.3.3">𝐶</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.I1.i2.p1.3.m3.1c">\mathcal{D}_{MC}</annotation><annotation encoding="application/x-llamapun" id="S4.I1.i2.p1.3.m3.1d">caligraphic_D start_POSTSUBSCRIPT italic_M italic_C end_POSTSUBSCRIPT</annotation></semantics></math>. It contains 12,485 such triplets. The DPO metric is calculated over this dataset.</p>
</div>
</li>
<li class="ltx_item" id="S4.I1.i3" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S4.I1.i3.p1">
<p class="ltx_p" id="S4.I1.i3.p1.4"><math alttext="\mathcal{D}_{ICL}" class="ltx_Math" display="inline" id="S4.I1.i3.p1.1.m1.1"><semantics id="S4.I1.i3.p1.1.m1.1a"><msub id="S4.I1.i3.p1.1.m1.1.1" xref="S4.I1.i3.p1.1.m1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.I1.i3.p1.1.m1.1.1.2" xref="S4.I1.i3.p1.1.m1.1.1.2.cmml">𝒟</mi><mrow id="S4.I1.i3.p1.1.m1.1.1.3" xref="S4.I1.i3.p1.1.m1.1.1.3.cmml"><mi id="S4.I1.i3.p1.1.m1.1.1.3.2" xref="S4.I1.i3.p1.1.m1.1.1.3.2.cmml">I</mi><mo id="S4.I1.i3.p1.1.m1.1.1.3.1" xref="S4.I1.i3.p1.1.m1.1.1.3.1.cmml">⁢</mo><mi id="S4.I1.i3.p1.1.m1.1.1.3.3" xref="S4.I1.i3.p1.1.m1.1.1.3.3.cmml">C</mi><mo id="S4.I1.i3.p1.1.m1.1.1.3.1a" xref="S4.I1.i3.p1.1.m1.1.1.3.1.cmml">⁢</mo><mi id="S4.I1.i3.p1.1.m1.1.1.3.4" xref="S4.I1.i3.p1.1.m1.1.1.3.4.cmml">L</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S4.I1.i3.p1.1.m1.1b"><apply id="S4.I1.i3.p1.1.m1.1.1.cmml" xref="S4.I1.i3.p1.1.m1.1.1"><csymbol cd="ambiguous" id="S4.I1.i3.p1.1.m1.1.1.1.cmml" xref="S4.I1.i3.p1.1.m1.1.1">subscript</csymbol><ci id="S4.I1.i3.p1.1.m1.1.1.2.cmml" xref="S4.I1.i3.p1.1.m1.1.1.2">𝒟</ci><apply id="S4.I1.i3.p1.1.m1.1.1.3.cmml" xref="S4.I1.i3.p1.1.m1.1.1.3"><times id="S4.I1.i3.p1.1.m1.1.1.3.1.cmml" xref="S4.I1.i3.p1.1.m1.1.1.3.1"></times><ci id="S4.I1.i3.p1.1.m1.1.1.3.2.cmml" xref="S4.I1.i3.p1.1.m1.1.1.3.2">𝐼</ci><ci id="S4.I1.i3.p1.1.m1.1.1.3.3.cmml" xref="S4.I1.i3.p1.1.m1.1.1.3.3">𝐶</ci><ci id="S4.I1.i3.p1.1.m1.1.1.3.4.cmml" xref="S4.I1.i3.p1.1.m1.1.1.3.4">𝐿</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.I1.i3.p1.1.m1.1c">\mathcal{D}_{ICL}</annotation><annotation encoding="application/x-llamapun" id="S4.I1.i3.p1.1.m1.1d">caligraphic_D start_POSTSUBSCRIPT italic_I italic_C italic_L end_POSTSUBSCRIPT</annotation></semantics></math>: this is the set of every distinct <math alttext="(q,a)" class="ltx_Math" display="inline" id="S4.I1.i3.p1.2.m2.2"><semantics id="S4.I1.i3.p1.2.m2.2a"><mrow id="S4.I1.i3.p1.2.m2.2.3.2" xref="S4.I1.i3.p1.2.m2.2.3.1.cmml"><mo id="S4.I1.i3.p1.2.m2.2.3.2.1" stretchy="false" xref="S4.I1.i3.p1.2.m2.2.3.1.cmml">(</mo><mi id="S4.I1.i3.p1.2.m2.1.1" xref="S4.I1.i3.p1.2.m2.1.1.cmml">q</mi><mo id="S4.I1.i3.p1.2.m2.2.3.2.2" xref="S4.I1.i3.p1.2.m2.2.3.1.cmml">,</mo><mi id="S4.I1.i3.p1.2.m2.2.2" xref="S4.I1.i3.p1.2.m2.2.2.cmml">a</mi><mo id="S4.I1.i3.p1.2.m2.2.3.2.3" stretchy="false" xref="S4.I1.i3.p1.2.m2.2.3.1.cmml">)</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.I1.i3.p1.2.m2.2b"><interval closure="open" id="S4.I1.i3.p1.2.m2.2.3.1.cmml" xref="S4.I1.i3.p1.2.m2.2.3.2"><ci id="S4.I1.i3.p1.2.m2.1.1.cmml" xref="S4.I1.i3.p1.2.m2.1.1">𝑞</ci><ci id="S4.I1.i3.p1.2.m2.2.2.cmml" xref="S4.I1.i3.p1.2.m2.2.2">𝑎</ci></interval></annotation-xml><annotation encoding="application/x-tex" id="S4.I1.i3.p1.2.m2.2c">(q,a)</annotation><annotation encoding="application/x-llamapun" id="S4.I1.i3.p1.2.m2.2d">( italic_q , italic_a )</annotation></semantics></math> pairs contained in <math alttext="\mathcal{D}_{MC}" class="ltx_Math" display="inline" id="S4.I1.i3.p1.3.m3.1"><semantics id="S4.I1.i3.p1.3.m3.1a"><msub id="S4.I1.i3.p1.3.m3.1.1" xref="S4.I1.i3.p1.3.m3.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.I1.i3.p1.3.m3.1.1.2" xref="S4.I1.i3.p1.3.m3.1.1.2.cmml">𝒟</mi><mrow id="S4.I1.i3.p1.3.m3.1.1.3" xref="S4.I1.i3.p1.3.m3.1.1.3.cmml"><mi id="S4.I1.i3.p1.3.m3.1.1.3.2" xref="S4.I1.i3.p1.3.m3.1.1.3.2.cmml">M</mi><mo id="S4.I1.i3.p1.3.m3.1.1.3.1" xref="S4.I1.i3.p1.3.m3.1.1.3.1.cmml">⁢</mo><mi id="S4.I1.i3.p1.3.m3.1.1.3.3" xref="S4.I1.i3.p1.3.m3.1.1.3.3.cmml">C</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S4.I1.i3.p1.3.m3.1b"><apply id="S4.I1.i3.p1.3.m3.1.1.cmml" xref="S4.I1.i3.p1.3.m3.1.1"><csymbol cd="ambiguous" id="S4.I1.i3.p1.3.m3.1.1.1.cmml" xref="S4.I1.i3.p1.3.m3.1.1">subscript</csymbol><ci id="S4.I1.i3.p1.3.m3.1.1.2.cmml" xref="S4.I1.i3.p1.3.m3.1.1.2">𝒟</ci><apply id="S4.I1.i3.p1.3.m3.1.1.3.cmml" xref="S4.I1.i3.p1.3.m3.1.1.3"><times id="S4.I1.i3.p1.3.m3.1.1.3.1.cmml" xref="S4.I1.i3.p1.3.m3.1.1.3.1"></times><ci id="S4.I1.i3.p1.3.m3.1.1.3.2.cmml" xref="S4.I1.i3.p1.3.m3.1.1.3.2">𝑀</ci><ci id="S4.I1.i3.p1.3.m3.1.1.3.3.cmml" xref="S4.I1.i3.p1.3.m3.1.1.3.3">𝐶</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.I1.i3.p1.3.m3.1c">\mathcal{D}_{MC}</annotation><annotation encoding="application/x-llamapun" id="S4.I1.i3.p1.3.m3.1d">caligraphic_D start_POSTSUBSCRIPT italic_M italic_C end_POSTSUBSCRIPT</annotation></semantics></math>. It contains 2,846 such pairs. This is the set of demonstrations from which a context is drawn. That is, <math alttext="C\subset\mathcal{D}_{ICL}" class="ltx_Math" display="inline" id="S4.I1.i3.p1.4.m4.1"><semantics id="S4.I1.i3.p1.4.m4.1a"><mrow id="S4.I1.i3.p1.4.m4.1.1" xref="S4.I1.i3.p1.4.m4.1.1.cmml"><mi id="S4.I1.i3.p1.4.m4.1.1.2" xref="S4.I1.i3.p1.4.m4.1.1.2.cmml">C</mi><mo id="S4.I1.i3.p1.4.m4.1.1.1" xref="S4.I1.i3.p1.4.m4.1.1.1.cmml">⊂</mo><msub id="S4.I1.i3.p1.4.m4.1.1.3" xref="S4.I1.i3.p1.4.m4.1.1.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.I1.i3.p1.4.m4.1.1.3.2" xref="S4.I1.i3.p1.4.m4.1.1.3.2.cmml">𝒟</mi><mrow id="S4.I1.i3.p1.4.m4.1.1.3.3" xref="S4.I1.i3.p1.4.m4.1.1.3.3.cmml"><mi id="S4.I1.i3.p1.4.m4.1.1.3.3.2" xref="S4.I1.i3.p1.4.m4.1.1.3.3.2.cmml">I</mi><mo id="S4.I1.i3.p1.4.m4.1.1.3.3.1" xref="S4.I1.i3.p1.4.m4.1.1.3.3.1.cmml">⁢</mo><mi id="S4.I1.i3.p1.4.m4.1.1.3.3.3" xref="S4.I1.i3.p1.4.m4.1.1.3.3.3.cmml">C</mi><mo id="S4.I1.i3.p1.4.m4.1.1.3.3.1a" xref="S4.I1.i3.p1.4.m4.1.1.3.3.1.cmml">⁢</mo><mi id="S4.I1.i3.p1.4.m4.1.1.3.3.4" xref="S4.I1.i3.p1.4.m4.1.1.3.3.4.cmml">L</mi></mrow></msub></mrow><annotation-xml encoding="MathML-Content" id="S4.I1.i3.p1.4.m4.1b"><apply id="S4.I1.i3.p1.4.m4.1.1.cmml" xref="S4.I1.i3.p1.4.m4.1.1"><subset id="S4.I1.i3.p1.4.m4.1.1.1.cmml" xref="S4.I1.i3.p1.4.m4.1.1.1"></subset><ci id="S4.I1.i3.p1.4.m4.1.1.2.cmml" xref="S4.I1.i3.p1.4.m4.1.1.2">𝐶</ci><apply id="S4.I1.i3.p1.4.m4.1.1.3.cmml" xref="S4.I1.i3.p1.4.m4.1.1.3"><csymbol cd="ambiguous" id="S4.I1.i3.p1.4.m4.1.1.3.1.cmml" xref="S4.I1.i3.p1.4.m4.1.1.3">subscript</csymbol><ci id="S4.I1.i3.p1.4.m4.1.1.3.2.cmml" xref="S4.I1.i3.p1.4.m4.1.1.3.2">𝒟</ci><apply id="S4.I1.i3.p1.4.m4.1.1.3.3.cmml" xref="S4.I1.i3.p1.4.m4.1.1.3.3"><times id="S4.I1.i3.p1.4.m4.1.1.3.3.1.cmml" xref="S4.I1.i3.p1.4.m4.1.1.3.3.1"></times><ci id="S4.I1.i3.p1.4.m4.1.1.3.3.2.cmml" xref="S4.I1.i3.p1.4.m4.1.1.3.3.2">𝐼</ci><ci id="S4.I1.i3.p1.4.m4.1.1.3.3.3.cmml" xref="S4.I1.i3.p1.4.m4.1.1.3.3.3">𝐶</ci><ci id="S4.I1.i3.p1.4.m4.1.1.3.3.4.cmml" xref="S4.I1.i3.p1.4.m4.1.1.3.3.4">𝐿</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.I1.i3.p1.4.m4.1c">C\subset\mathcal{D}_{ICL}</annotation><annotation encoding="application/x-llamapun" id="S4.I1.i3.p1.4.m4.1d">italic_C ⊂ caligraphic_D start_POSTSUBSCRIPT italic_I italic_C italic_L end_POSTSUBSCRIPT</annotation></semantics></math>.</p>
</div>
</li>
</ul>
</div>
<div class="ltx_para" id="S4.SS1.SSS3.p3">
<p class="ltx_p" id="S4.SS1.SSS3.p3.4">When calculating a metric score for an example <math alttext="(q_{i},\mathbf{a}_{i},\mathbf{\bar{a}}_{i})" class="ltx_Math" display="inline" id="S4.SS1.SSS3.p3.1.m1.3"><semantics id="S4.SS1.SSS3.p3.1.m1.3a"><mrow id="S4.SS1.SSS3.p3.1.m1.3.3.3" xref="S4.SS1.SSS3.p3.1.m1.3.3.4.cmml"><mo id="S4.SS1.SSS3.p3.1.m1.3.3.3.4" stretchy="false" xref="S4.SS1.SSS3.p3.1.m1.3.3.4.cmml">(</mo><msub id="S4.SS1.SSS3.p3.1.m1.1.1.1.1" xref="S4.SS1.SSS3.p3.1.m1.1.1.1.1.cmml"><mi id="S4.SS1.SSS3.p3.1.m1.1.1.1.1.2" xref="S4.SS1.SSS3.p3.1.m1.1.1.1.1.2.cmml">q</mi><mi id="S4.SS1.SSS3.p3.1.m1.1.1.1.1.3" xref="S4.SS1.SSS3.p3.1.m1.1.1.1.1.3.cmml">i</mi></msub><mo id="S4.SS1.SSS3.p3.1.m1.3.3.3.5" xref="S4.SS1.SSS3.p3.1.m1.3.3.4.cmml">,</mo><msub id="S4.SS1.SSS3.p3.1.m1.2.2.2.2" xref="S4.SS1.SSS3.p3.1.m1.2.2.2.2.cmml"><mi id="S4.SS1.SSS3.p3.1.m1.2.2.2.2.2" xref="S4.SS1.SSS3.p3.1.m1.2.2.2.2.2.cmml">𝐚</mi><mi id="S4.SS1.SSS3.p3.1.m1.2.2.2.2.3" xref="S4.SS1.SSS3.p3.1.m1.2.2.2.2.3.cmml">i</mi></msub><mo id="S4.SS1.SSS3.p3.1.m1.3.3.3.6" xref="S4.SS1.SSS3.p3.1.m1.3.3.4.cmml">,</mo><msub id="S4.SS1.SSS3.p3.1.m1.3.3.3.3" xref="S4.SS1.SSS3.p3.1.m1.3.3.3.3.cmml"><mover accent="true" id="S4.SS1.SSS3.p3.1.m1.3.3.3.3.2" xref="S4.SS1.SSS3.p3.1.m1.3.3.3.3.2.cmml"><mi id="S4.SS1.SSS3.p3.1.m1.3.3.3.3.2.2" xref="S4.SS1.SSS3.p3.1.m1.3.3.3.3.2.2.cmml">𝐚</mi><mo id="S4.SS1.SSS3.p3.1.m1.3.3.3.3.2.1" xref="S4.SS1.SSS3.p3.1.m1.3.3.3.3.2.1.cmml">¯</mo></mover><mi id="S4.SS1.SSS3.p3.1.m1.3.3.3.3.3" xref="S4.SS1.SSS3.p3.1.m1.3.3.3.3.3.cmml">i</mi></msub><mo id="S4.SS1.SSS3.p3.1.m1.3.3.3.7" stretchy="false" xref="S4.SS1.SSS3.p3.1.m1.3.3.4.cmml">)</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.SSS3.p3.1.m1.3b"><vector id="S4.SS1.SSS3.p3.1.m1.3.3.4.cmml" xref="S4.SS1.SSS3.p3.1.m1.3.3.3"><apply id="S4.SS1.SSS3.p3.1.m1.1.1.1.1.cmml" xref="S4.SS1.SSS3.p3.1.m1.1.1.1.1"><csymbol cd="ambiguous" id="S4.SS1.SSS3.p3.1.m1.1.1.1.1.1.cmml" xref="S4.SS1.SSS3.p3.1.m1.1.1.1.1">subscript</csymbol><ci id="S4.SS1.SSS3.p3.1.m1.1.1.1.1.2.cmml" xref="S4.SS1.SSS3.p3.1.m1.1.1.1.1.2">𝑞</ci><ci id="S4.SS1.SSS3.p3.1.m1.1.1.1.1.3.cmml" xref="S4.SS1.SSS3.p3.1.m1.1.1.1.1.3">𝑖</ci></apply><apply id="S4.SS1.SSS3.p3.1.m1.2.2.2.2.cmml" xref="S4.SS1.SSS3.p3.1.m1.2.2.2.2"><csymbol cd="ambiguous" id="S4.SS1.SSS3.p3.1.m1.2.2.2.2.1.cmml" xref="S4.SS1.SSS3.p3.1.m1.2.2.2.2">subscript</csymbol><ci id="S4.SS1.SSS3.p3.1.m1.2.2.2.2.2.cmml" xref="S4.SS1.SSS3.p3.1.m1.2.2.2.2.2">𝐚</ci><ci id="S4.SS1.SSS3.p3.1.m1.2.2.2.2.3.cmml" xref="S4.SS1.SSS3.p3.1.m1.2.2.2.2.3">𝑖</ci></apply><apply id="S4.SS1.SSS3.p3.1.m1.3.3.3.3.cmml" xref="S4.SS1.SSS3.p3.1.m1.3.3.3.3"><csymbol cd="ambiguous" id="S4.SS1.SSS3.p3.1.m1.3.3.3.3.1.cmml" xref="S4.SS1.SSS3.p3.1.m1.3.3.3.3">subscript</csymbol><apply id="S4.SS1.SSS3.p3.1.m1.3.3.3.3.2.cmml" xref="S4.SS1.SSS3.p3.1.m1.3.3.3.3.2"><ci id="S4.SS1.SSS3.p3.1.m1.3.3.3.3.2.1.cmml" xref="S4.SS1.SSS3.p3.1.m1.3.3.3.3.2.1">¯</ci><ci id="S4.SS1.SSS3.p3.1.m1.3.3.3.3.2.2.cmml" xref="S4.SS1.SSS3.p3.1.m1.3.3.3.3.2.2">𝐚</ci></apply><ci id="S4.SS1.SSS3.p3.1.m1.3.3.3.3.3.cmml" xref="S4.SS1.SSS3.p3.1.m1.3.3.3.3.3">𝑖</ci></apply></vector></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSS3.p3.1.m1.3c">(q_{i},\mathbf{a}_{i},\mathbf{\bar{a}}_{i})</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.SSS3.p3.1.m1.3d">( italic_q start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT , bold_a start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT , over¯ start_ARG bold_a end_ARG start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT )</annotation></semantics></math>, all demonstrations with the query <math alttext="q_{i}" class="ltx_Math" display="inline" id="S4.SS1.SSS3.p3.2.m2.1"><semantics id="S4.SS1.SSS3.p3.2.m2.1a"><msub id="S4.SS1.SSS3.p3.2.m2.1.1" xref="S4.SS1.SSS3.p3.2.m2.1.1.cmml"><mi id="S4.SS1.SSS3.p3.2.m2.1.1.2" xref="S4.SS1.SSS3.p3.2.m2.1.1.2.cmml">q</mi><mi id="S4.SS1.SSS3.p3.2.m2.1.1.3" xref="S4.SS1.SSS3.p3.2.m2.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS1.SSS3.p3.2.m2.1b"><apply id="S4.SS1.SSS3.p3.2.m2.1.1.cmml" xref="S4.SS1.SSS3.p3.2.m2.1.1"><csymbol cd="ambiguous" id="S4.SS1.SSS3.p3.2.m2.1.1.1.cmml" xref="S4.SS1.SSS3.p3.2.m2.1.1">subscript</csymbol><ci id="S4.SS1.SSS3.p3.2.m2.1.1.2.cmml" xref="S4.SS1.SSS3.p3.2.m2.1.1.2">𝑞</ci><ci id="S4.SS1.SSS3.p3.2.m2.1.1.3.cmml" xref="S4.SS1.SSS3.p3.2.m2.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSS3.p3.2.m2.1c">q_{i}</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.SSS3.p3.2.m2.1d">italic_q start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT</annotation></semantics></math> are left out from the demonstrations available for inclusion in the context. In this manner, the correct answers <math alttext="\mathbf{a}_{i}" class="ltx_Math" display="inline" id="S4.SS1.SSS3.p3.3.m3.1"><semantics id="S4.SS1.SSS3.p3.3.m3.1a"><msub id="S4.SS1.SSS3.p3.3.m3.1.1" xref="S4.SS1.SSS3.p3.3.m3.1.1.cmml"><mi id="S4.SS1.SSS3.p3.3.m3.1.1.2" xref="S4.SS1.SSS3.p3.3.m3.1.1.2.cmml">𝐚</mi><mi id="S4.SS1.SSS3.p3.3.m3.1.1.3" xref="S4.SS1.SSS3.p3.3.m3.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS1.SSS3.p3.3.m3.1b"><apply id="S4.SS1.SSS3.p3.3.m3.1.1.cmml" xref="S4.SS1.SSS3.p3.3.m3.1.1"><csymbol cd="ambiguous" id="S4.SS1.SSS3.p3.3.m3.1.1.1.cmml" xref="S4.SS1.SSS3.p3.3.m3.1.1">subscript</csymbol><ci id="S4.SS1.SSS3.p3.3.m3.1.1.2.cmml" xref="S4.SS1.SSS3.p3.3.m3.1.1.2">𝐚</ci><ci id="S4.SS1.SSS3.p3.3.m3.1.1.3.cmml" xref="S4.SS1.SSS3.p3.3.m3.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSS3.p3.3.m3.1c">\mathbf{a}_{i}</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.SSS3.p3.3.m3.1d">bold_a start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT</annotation></semantics></math> are not included in the context when the LLM is presented with query <math alttext="q_{i}" class="ltx_Math" display="inline" id="S4.SS1.SSS3.p3.4.m4.1"><semantics id="S4.SS1.SSS3.p3.4.m4.1a"><msub id="S4.SS1.SSS3.p3.4.m4.1.1" xref="S4.SS1.SSS3.p3.4.m4.1.1.cmml"><mi id="S4.SS1.SSS3.p3.4.m4.1.1.2" xref="S4.SS1.SSS3.p3.4.m4.1.1.2.cmml">q</mi><mi id="S4.SS1.SSS3.p3.4.m4.1.1.3" xref="S4.SS1.SSS3.p3.4.m4.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS1.SSS3.p3.4.m4.1b"><apply id="S4.SS1.SSS3.p3.4.m4.1.1.cmml" xref="S4.SS1.SSS3.p3.4.m4.1.1"><csymbol cd="ambiguous" id="S4.SS1.SSS3.p3.4.m4.1.1.1.cmml" xref="S4.SS1.SSS3.p3.4.m4.1.1">subscript</csymbol><ci id="S4.SS1.SSS3.p3.4.m4.1.1.2.cmml" xref="S4.SS1.SSS3.p3.4.m4.1.1.2">𝑞</ci><ci id="S4.SS1.SSS3.p3.4.m4.1.1.3.cmml" xref="S4.SS1.SSS3.p3.4.m4.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSS3.p3.4.m4.1c">q_{i}</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.SSS3.p3.4.m4.1d">italic_q start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT</annotation></semantics></math>.</p>
</div>
</section>
<section class="ltx_subsubsection" id="S4.SS1.SSS4">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">4.1.4 </span>The Language Models</h4>
<div class="ltx_para" id="S4.SS1.SSS4.p1">
<p class="ltx_p" id="S4.SS1.SSS4.p1.1">We conducted our experiments using four noteworthy LLMs:
the smaller base text-completion model <span class="ltx_text ltx_font_italic" id="S4.SS1.SSS4.p1.1.1">Mistral-7B-v0.1</span> (7B parameters), and the larger instruct-fine-tuned mixture of models <span class="ltx_text ltx_font_italic" id="S4.SS1.SSS4.p1.1.2">Mixtral-8x22B-Instruct-v0.1</span> (141B parameters) from Mistral <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2405.17587v2#bib.bib50" title="">50</a>]</cite>;
as well as a smaller chat-tuned model <span class="ltx_text ltx_font_italic" id="S4.SS1.SSS4.p1.1.3">Llama-3-8B-chat</span> (8B parameters) and a larger chat-tuned model <span class="ltx_text ltx_font_italic" id="S4.SS1.SSS4.p1.1.4">Llama-3-70B-chat</span> (70B parameters) from Llama
<span class="ltx_note ltx_role_footnote" id="footnote1"><sup class="ltx_note_mark">1</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">1</sup><span class="ltx_tag ltx_tag_note">1</span><a class="ltx_ref ltx_url ltx_font_typewriter" href="https://llama.meta.com/llama3/" title="">https://llama.meta.com/llama3/</a></span></span></span>.</p>
</div>
<div class="ltx_para" id="S4.SS1.SSS4.p2">
<p class="ltx_p" id="S4.SS1.SSS4.p2.1">All four models are open-weights LLMs, meaning their internal parameters are publicly available for scrutiny and potential fine-tuning.
These modern models stand out for achieving impressive performance on various tasks despite their relatively compact size. This efficiency makes it an attractive option for resource-constrained environments where deploying colossal models might not be feasible.</p>
</div>
</section>
</section>
<section class="ltx_subsection" id="S4.SS2">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.2 </span>Implementation Details and Ablation Study</h3>
<div class="ltx_para" id="S4.SS2.p1">
<p class="ltx_p" id="S4.SS2.p1.1">We implemented the Algorithm <a class="ltx_ref" href="https://arxiv.org/html/2405.17587v2#alg1" title="Algorithm 1 ‣ 3.3.3 Demonstration Quality Bias ‣ 3.3 Retrieval Algorithm ‣ 3 Methodology ‣ RAGSys: Item-Cold-Start Recommender as RAG System"><span class="ltx_text ltx_ref_tag">1</span></a> and metrics from Section <a class="ltx_ref" href="https://arxiv.org/html/2405.17587v2#S3.SS2.SSS1" title="3.2.1 Classification Metrics ‣ 3.2 Evaluation ‣ 3 Methodology ‣ RAGSys: Item-Cold-Start Recommender as RAG System"><span class="ltx_text ltx_ref_tag">3.2.1</span></a> in python. We computed <code class="ltx_verbatim ltx_font_typewriter" id="S4.SS2.p1.1.1">BERT</code> embeddings using the package <span class="ltx_text ltx_font_italic" id="S4.SS2.p1.1.2">sentence_transformers</span> <span class="ltx_note ltx_role_footnote" id="footnote2"><sup class="ltx_note_mark">2</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">2</sup><span class="ltx_tag ltx_tag_note">2</span><a class="ltx_ref ltx_url ltx_font_typewriter" href="https://sbert.net/" title="">https://sbert.net/</a></span></span></span>, and implemented the retrieval algorithms in <span class="ltx_text ltx_font_italic" id="S4.SS2.p1.1.3">numpy</span>. We queried all LLM models using the Together API <span class="ltx_note ltx_role_footnote" id="footnote3"><sup class="ltx_note_mark">3</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">3</sup><span class="ltx_tag ltx_tag_note">3</span><a class="ltx_ref ltx_url ltx_font_typewriter" href="https://docs.together.ai/docs/inference-python" title="">https://docs.together.ai/docs/inference-python</a></span></span></span>.</p>
</div>
<div class="ltx_para" id="S4.SS2.p2">
<p class="ltx_p" id="S4.SS2.p2.3">We did not perform hyper-parameter tuning, and fixed the two parameters to <math alttext="\lambda_{d}=0.75" class="ltx_Math" display="inline" id="S4.SS2.p2.1.m1.1"><semantics id="S4.SS2.p2.1.m1.1a"><mrow id="S4.SS2.p2.1.m1.1.1" xref="S4.SS2.p2.1.m1.1.1.cmml"><msub id="S4.SS2.p2.1.m1.1.1.2" xref="S4.SS2.p2.1.m1.1.1.2.cmml"><mi id="S4.SS2.p2.1.m1.1.1.2.2" xref="S4.SS2.p2.1.m1.1.1.2.2.cmml">λ</mi><mi id="S4.SS2.p2.1.m1.1.1.2.3" xref="S4.SS2.p2.1.m1.1.1.2.3.cmml">d</mi></msub><mo id="S4.SS2.p2.1.m1.1.1.1" xref="S4.SS2.p2.1.m1.1.1.1.cmml">=</mo><mn id="S4.SS2.p2.1.m1.1.1.3" xref="S4.SS2.p2.1.m1.1.1.3.cmml">0.75</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.p2.1.m1.1b"><apply id="S4.SS2.p2.1.m1.1.1.cmml" xref="S4.SS2.p2.1.m1.1.1"><eq id="S4.SS2.p2.1.m1.1.1.1.cmml" xref="S4.SS2.p2.1.m1.1.1.1"></eq><apply id="S4.SS2.p2.1.m1.1.1.2.cmml" xref="S4.SS2.p2.1.m1.1.1.2"><csymbol cd="ambiguous" id="S4.SS2.p2.1.m1.1.1.2.1.cmml" xref="S4.SS2.p2.1.m1.1.1.2">subscript</csymbol><ci id="S4.SS2.p2.1.m1.1.1.2.2.cmml" xref="S4.SS2.p2.1.m1.1.1.2.2">𝜆</ci><ci id="S4.SS2.p2.1.m1.1.1.2.3.cmml" xref="S4.SS2.p2.1.m1.1.1.2.3">𝑑</ci></apply><cn id="S4.SS2.p2.1.m1.1.1.3.cmml" type="float" xref="S4.SS2.p2.1.m1.1.1.3">0.75</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p2.1.m1.1c">\lambda_{d}=0.75</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.p2.1.m1.1d">italic_λ start_POSTSUBSCRIPT italic_d end_POSTSUBSCRIPT = 0.75</annotation></semantics></math> and <math alttext="\lambda_{b}=0.95" class="ltx_Math" display="inline" id="S4.SS2.p2.2.m2.1"><semantics id="S4.SS2.p2.2.m2.1a"><mrow id="S4.SS2.p2.2.m2.1.1" xref="S4.SS2.p2.2.m2.1.1.cmml"><msub id="S4.SS2.p2.2.m2.1.1.2" xref="S4.SS2.p2.2.m2.1.1.2.cmml"><mi id="S4.SS2.p2.2.m2.1.1.2.2" xref="S4.SS2.p2.2.m2.1.1.2.2.cmml">λ</mi><mi id="S4.SS2.p2.2.m2.1.1.2.3" xref="S4.SS2.p2.2.m2.1.1.2.3.cmml">b</mi></msub><mo id="S4.SS2.p2.2.m2.1.1.1" xref="S4.SS2.p2.2.m2.1.1.1.cmml">=</mo><mn id="S4.SS2.p2.2.m2.1.1.3" xref="S4.SS2.p2.2.m2.1.1.3.cmml">0.95</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.p2.2.m2.1b"><apply id="S4.SS2.p2.2.m2.1.1.cmml" xref="S4.SS2.p2.2.m2.1.1"><eq id="S4.SS2.p2.2.m2.1.1.1.cmml" xref="S4.SS2.p2.2.m2.1.1.1"></eq><apply id="S4.SS2.p2.2.m2.1.1.2.cmml" xref="S4.SS2.p2.2.m2.1.1.2"><csymbol cd="ambiguous" id="S4.SS2.p2.2.m2.1.1.2.1.cmml" xref="S4.SS2.p2.2.m2.1.1.2">subscript</csymbol><ci id="S4.SS2.p2.2.m2.1.1.2.2.cmml" xref="S4.SS2.p2.2.m2.1.1.2.2">𝜆</ci><ci id="S4.SS2.p2.2.m2.1.1.2.3.cmml" xref="S4.SS2.p2.2.m2.1.1.2.3">𝑏</ci></apply><cn id="S4.SS2.p2.2.m2.1.1.3.cmml" type="float" xref="S4.SS2.p2.2.m2.1.1.3">0.95</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p2.2.m2.1c">\lambda_{b}=0.95</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.p2.2.m2.1d">italic_λ start_POSTSUBSCRIPT italic_b end_POSTSUBSCRIPT = 0.95</annotation></semantics></math> in all experiments.
We fixed the amount of retrieved demonstrations to <math alttext="k=6" class="ltx_Math" display="inline" id="S4.SS2.p2.3.m3.1"><semantics id="S4.SS2.p2.3.m3.1a"><mrow id="S4.SS2.p2.3.m3.1.1" xref="S4.SS2.p2.3.m3.1.1.cmml"><mi id="S4.SS2.p2.3.m3.1.1.2" xref="S4.SS2.p2.3.m3.1.1.2.cmml">k</mi><mo id="S4.SS2.p2.3.m3.1.1.1" xref="S4.SS2.p2.3.m3.1.1.1.cmml">=</mo><mn id="S4.SS2.p2.3.m3.1.1.3" xref="S4.SS2.p2.3.m3.1.1.3.cmml">6</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.p2.3.m3.1b"><apply id="S4.SS2.p2.3.m3.1.1.cmml" xref="S4.SS2.p2.3.m3.1.1"><eq id="S4.SS2.p2.3.m3.1.1.1.cmml" xref="S4.SS2.p2.3.m3.1.1.1"></eq><ci id="S4.SS2.p2.3.m3.1.1.2.cmml" xref="S4.SS2.p2.3.m3.1.1.2">𝑘</ci><cn id="S4.SS2.p2.3.m3.1.1.3.cmml" type="integer" xref="S4.SS2.p2.3.m3.1.1.3">6</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p2.3.m3.1c">k=6</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.p2.3.m3.1d">italic_k = 6</annotation></semantics></math>, matching the number of few-shot examples from the fixed primer example from the TruthfulQA paper <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2405.17587v2#bib.bib48" title="">48</a>]</cite>.</p>
</div>
<div class="ltx_para" id="S4.SS2.p3">
<p class="ltx_p" id="S4.SS2.p3.1">To measure the impact of the separated components of Algorithm <a class="ltx_ref" href="https://arxiv.org/html/2405.17587v2#alg1" title="Algorithm 1 ‣ 3.3.3 Demonstration Quality Bias ‣ 3.3 Retrieval Algorithm ‣ 3 Methodology ‣ RAGSys: Item-Cold-Start Recommender as RAG System"><span class="ltx_text ltx_ref_tag">1</span></a>, relevance, diversity, and bias, we implemented variants of the retrieval algorithm using only one or two of the three components:</p>
</div>
<div class="ltx_para" id="S4.SS2.p4">
<ul class="ltx_itemize" id="S4.I2">
<li class="ltx_item" id="S4.I2.i1" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S4.I2.i1.p1">
<p class="ltx_p" id="S4.I2.i1.p1.1">Fix: fixed primer examples <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2405.17587v2#bib.bib48" title="">48</a>]</cite></p>
</div>
</li>
<li class="ltx_item" id="S4.I2.i2" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S4.I2.i2.p1">
<p class="ltx_p" id="S4.I2.i2.p1.1">Bias: Pure quality bias <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2405.17587v2#bib.bib12" title="">12</a>]</cite></p>
</div>
</li>
<li class="ltx_item" id="S4.I2.i3" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S4.I2.i3.p1">
<p class="ltx_p" id="S4.I2.i3.p1.1">Rel: Pure semantic similarity <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2405.17587v2#bib.bib20" title="">20</a>]</cite> (<code class="ltx_verbatim ltx_font_typewriter" id="S4.I2.i3.p1.1.1">KATE</code>)</p>
</div>
</li>
<li class="ltx_item" id="S4.I2.i4" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S4.I2.i4.p1">
<p class="ltx_p" id="S4.I2.i4.p1.1">Rel+Bias: Semantic similarity plus quality bias</p>
</div>
</li>
<li class="ltx_item" id="S4.I2.i5" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S4.I2.i5.p1">
<p class="ltx_p" id="S4.I2.i5.p1.1">Rel+Div: Semantic similarity plus diversity <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2405.17587v2#bib.bib26" title="">26</a>]</cite></p>
</div>
</li>
<li class="ltx_item" id="S4.I2.i6" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S4.I2.i6.p1">
<p class="ltx_p" id="S4.I2.i6.p1.1">Rel+Bias+Div: Algorithm <a class="ltx_ref" href="https://arxiv.org/html/2405.17587v2#alg1" title="Algorithm 1 ‣ 3.3.3 Demonstration Quality Bias ‣ 3.3 Retrieval Algorithm ‣ 3 Methodology ‣ RAGSys: Item-Cold-Start Recommender as RAG System"><span class="ltx_text ltx_ref_tag">1</span></a></p>
</div>
</li>
</ul>
</div>
</section>
<section class="ltx_subsection" id="S4.SS3">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.3 </span>Main Results</h3>
<div class="ltx_para" id="S4.SS3.p1">
<p class="ltx_p" id="S4.SS3.p1.1">We present the experimental metrics for the 6 retrievers for the 4 different LLMs:
in Table <a class="ltx_ref" href="https://arxiv.org/html/2405.17587v2#S4.T2" title="Table 2 ‣ 4.3 Main Results ‣ 4 Experiments ‣ RAGSys: Item-Cold-Start Recommender as RAG System"><span class="ltx_text ltx_ref_tag">2</span></a> and <a class="ltx_ref" href="https://arxiv.org/html/2405.17587v2#S4.T2" title="Table 2 ‣ 4.3 Main Results ‣ 4 Experiments ‣ RAGSys: Item-Cold-Start Recommender as RAG System"><span class="ltx_text ltx_ref_tag">2</span></a> for the Mistral models,
and Table <a class="ltx_ref" href="https://arxiv.org/html/2405.17587v2#S4.T4" title="Table 4 ‣ 4.3 Main Results ‣ 4 Experiments ‣ RAGSys: Item-Cold-Start Recommender as RAG System"><span class="ltx_text ltx_ref_tag">4</span></a> and <a class="ltx_ref" href="https://arxiv.org/html/2405.17587v2#S4.T4" title="Table 4 ‣ 4.3 Main Results ‣ 4 Experiments ‣ RAGSys: Item-Cold-Start Recommender as RAG System"><span class="ltx_text ltx_ref_tag">4</span></a> for the Llama-3 models.</p>
</div>
<figure class="ltx_table" id="S4.T2">
<div class="ltx_flex_figure ltx_flex_table">
<div class="ltx_flex_cell ltx_flex_size_2">
<figure class="ltx_figure ltx_figure_panel ltx_minipage ltx_align_middle" id="S4.T2.fig1" style="width:216.8pt;">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure">Table 1: </span>Evaluation Metrics with <span class="ltx_text ltx_font_italic" id="S4.T2.fig1.2.1">Mistral-7B-v0.1</span></figcaption>
<table class="ltx_tabular ltx_align_middle" id="S4.T2.fig1.3">
<tr class="ltx_tr" id="S4.T2.fig1.3.1">
<td class="ltx_td ltx_align_left ltx_border_tt" id="S4.T2.fig1.3.1.1">Method</td>
<td class="ltx_td ltx_align_right ltx_border_tt" id="S4.T2.fig1.3.1.2">DPO</td>
<td class="ltx_td ltx_align_right ltx_border_tt" id="S4.T2.fig1.3.1.3">MC1</td>
<td class="ltx_td ltx_align_right ltx_border_tt" id="S4.T2.fig1.3.1.4">MC2</td>
<td class="ltx_td ltx_align_right ltx_border_r ltx_border_tt" id="S4.T2.fig1.3.1.5">MC3</td>
</tr>
<tr class="ltx_tr" id="S4.T2.fig1.3.2">
<td class="ltx_td ltx_align_left ltx_border_t" id="S4.T2.fig1.3.2.1"><span class="ltx_text" id="S4.T2.fig1.3.2.1.1" style="font-size:90%;">Fix</span></td>
<td class="ltx_td ltx_align_right ltx_border_t" id="S4.T2.fig1.3.2.2">-20.40</td>
<td class="ltx_td ltx_align_right ltx_border_t" id="S4.T2.fig1.3.2.3">0.2815</td>
<td class="ltx_td ltx_align_right ltx_border_t" id="S4.T2.fig1.3.2.4">0.2086</td>
<td class="ltx_td ltx_align_right ltx_border_r ltx_border_t" id="S4.T2.fig1.3.2.5">0.4285</td>
</tr>
<tr class="ltx_tr" id="S4.T2.fig1.3.3">
<td class="ltx_td ltx_align_left" id="S4.T2.fig1.3.3.1">Bias</td>
<td class="ltx_td ltx_align_right" id="S4.T2.fig1.3.3.2">-33.56</td>
<td class="ltx_td ltx_align_right" id="S4.T2.fig1.3.3.3">0.2411</td>
<td class="ltx_td ltx_align_right" id="S4.T2.fig1.3.3.4">0.1652</td>
<td class="ltx_td ltx_align_right ltx_border_r" id="S4.T2.fig1.3.3.5">0.3596</td>
</tr>
<tr class="ltx_tr" id="S4.T2.fig1.3.4">
<td class="ltx_td ltx_align_left" id="S4.T2.fig1.3.4.1">Rel</td>
<td class="ltx_td ltx_align_right" id="S4.T2.fig1.3.4.2">-12.71</td>
<td class="ltx_td ltx_align_right" id="S4.T2.fig1.3.4.3">0.4455</td>
<td class="ltx_td ltx_align_right" id="S4.T2.fig1.3.4.4">0.3664</td>
<td class="ltx_td ltx_align_right ltx_border_r" id="S4.T2.fig1.3.4.5">0.5925</td>
</tr>
<tr class="ltx_tr" id="S4.T2.fig1.3.5">
<td class="ltx_td ltx_align_left" id="S4.T2.fig1.3.5.1">Rel+Bias</td>
<td class="ltx_td ltx_align_right" id="S4.T2.fig1.3.5.2">-13.63</td>
<td class="ltx_td ltx_align_right" id="S4.T2.fig1.3.5.3">0.4602</td>
<td class="ltx_td ltx_align_right" id="S4.T2.fig1.3.5.4">0.3663</td>
<td class="ltx_td ltx_align_right ltx_border_r" id="S4.T2.fig1.3.5.5">0.5969</td>
</tr>
<tr class="ltx_tr" id="S4.T2.fig1.3.6">
<td class="ltx_td ltx_align_left" id="S4.T2.fig1.3.6.1">Rel+Div</td>
<td class="ltx_td ltx_align_right" id="S4.T2.fig1.3.6.2"><span class="ltx_text ltx_font_bold" id="S4.T2.fig1.3.6.2.1">-12.37</span></td>
<td class="ltx_td ltx_align_right" id="S4.T2.fig1.3.6.3"><span class="ltx_text ltx_font_bold" id="S4.T2.fig1.3.6.3.1">0.5177</span></td>
<td class="ltx_td ltx_align_right" id="S4.T2.fig1.3.6.4"><span class="ltx_text ltx_font_bold" id="S4.T2.fig1.3.6.4.1">0.3930</span></td>
<td class="ltx_td ltx_align_right ltx_border_r" id="S4.T2.fig1.3.6.5"><span class="ltx_text ltx_font_bold" id="S4.T2.fig1.3.6.5.1">0.6616</span></td>
</tr>
<tr class="ltx_tr" id="S4.T2.fig1.3.7">
<td class="ltx_td ltx_align_left ltx_border_bb" id="S4.T2.fig1.3.7.1">Rel+Div+Bias</td>
<td class="ltx_td ltx_align_right ltx_border_bb" id="S4.T2.fig1.3.7.2">-14.54</td>
<td class="ltx_td ltx_align_right ltx_border_bb" id="S4.T2.fig1.3.7.3">0.4676</td>
<td class="ltx_td ltx_align_right ltx_border_bb" id="S4.T2.fig1.3.7.4">0.3592</td>
<td class="ltx_td ltx_align_right ltx_border_bb ltx_border_r" id="S4.T2.fig1.3.7.5">0.6255</td>
</tr>
</table>
</figure>
</div>
<div class="ltx_flex_cell ltx_flex_size_2">
<figure class="ltx_figure ltx_figure_panel ltx_minipage ltx_align_middle" id="S4.T2.fig2" style="width:216.8pt;">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure">Table 2: </span>Evaluation Metrics with <span class="ltx_text ltx_font_italic" id="S4.T2.fig2.2.1">Mixtral-8x22B-Instruct-v0.1</span></figcaption>
<table class="ltx_tabular ltx_align_middle" id="S4.T2.fig2.3">
<tr class="ltx_tr" id="S4.T2.fig2.3.1">
<td class="ltx_td ltx_align_left ltx_border_l ltx_border_tt" id="S4.T2.fig2.3.1.1">Method</td>
<td class="ltx_td ltx_align_right ltx_border_tt" id="S4.T2.fig2.3.1.2">DPO</td>
<td class="ltx_td ltx_align_right ltx_border_tt" id="S4.T2.fig2.3.1.3">MC1</td>
<td class="ltx_td ltx_align_right ltx_border_tt" id="S4.T2.fig2.3.1.4">MC2</td>
<td class="ltx_td ltx_align_right ltx_border_tt" id="S4.T2.fig2.3.1.5">MC3</td>
</tr>
<tr class="ltx_tr" id="S4.T2.fig2.3.2">
<td class="ltx_td ltx_align_left ltx_border_l ltx_border_t" id="S4.T2.fig2.3.2.1">Fix</td>
<td class="ltx_td ltx_align_right ltx_border_t" id="S4.T2.fig2.3.2.2">-19.06</td>
<td class="ltx_td ltx_align_right ltx_border_t" id="S4.T2.fig2.3.2.3">0.5202</td>
<td class="ltx_td ltx_align_right ltx_border_t" id="S4.T2.fig2.3.2.4">0.3896</td>
<td class="ltx_td ltx_align_right ltx_border_t" id="S4.T2.fig2.3.2.5">0.6799</td>
</tr>
<tr class="ltx_tr" id="S4.T2.fig2.3.3">
<td class="ltx_td ltx_align_left ltx_border_l" id="S4.T2.fig2.3.3.1">Bias</td>
<td class="ltx_td ltx_align_right" id="S4.T2.fig2.3.3.2">-27.30</td>
<td class="ltx_td ltx_align_right" id="S4.T2.fig2.3.3.3">0.4382</td>
<td class="ltx_td ltx_align_right" id="S4.T2.fig2.3.3.4">0.3096</td>
<td class="ltx_td ltx_align_right" id="S4.T2.fig2.3.3.5">0.5948</td>
</tr>
<tr class="ltx_tr" id="S4.T2.fig2.3.4">
<td class="ltx_td ltx_align_left ltx_border_l" id="S4.T2.fig2.3.4.1">Rel</td>
<td class="ltx_td ltx_align_right" id="S4.T2.fig2.3.4.2">-15.17</td>
<td class="ltx_td ltx_align_right" id="S4.T2.fig2.3.4.3">0.6193</td>
<td class="ltx_td ltx_align_right" id="S4.T2.fig2.3.4.4">0.5004</td>
<td class="ltx_td ltx_align_right" id="S4.T2.fig2.3.4.5">0.7616</td>
</tr>
<tr class="ltx_tr" id="S4.T2.fig2.3.5">
<td class="ltx_td ltx_align_left ltx_border_l" id="S4.T2.fig2.3.5.1">Rel+Bias</td>
<td class="ltx_td ltx_align_right" id="S4.T2.fig2.3.5.2">-14.77</td>
<td class="ltx_td ltx_align_right" id="S4.T2.fig2.3.5.3">0.6389</td>
<td class="ltx_td ltx_align_right" id="S4.T2.fig2.3.5.4">0.5080</td>
<td class="ltx_td ltx_align_right" id="S4.T2.fig2.3.5.5">0.7657</td>
</tr>
<tr class="ltx_tr" id="S4.T2.fig2.3.6">
<td class="ltx_td ltx_align_left ltx_border_l" id="S4.T2.fig2.3.6.1">Rel+Div</td>
<td class="ltx_td ltx_align_right" id="S4.T2.fig2.3.6.2"><span class="ltx_text ltx_font_bold" id="S4.T2.fig2.3.6.2.1">-12.67</span></td>
<td class="ltx_td ltx_align_right" id="S4.T2.fig2.3.6.3"><span class="ltx_text ltx_font_bold" id="S4.T2.fig2.3.6.3.1">0.6879</span></td>
<td class="ltx_td ltx_align_right" id="S4.T2.fig2.3.6.4"><span class="ltx_text ltx_font_bold" id="S4.T2.fig2.3.6.4.1">0.5181</span></td>
<td class="ltx_td ltx_align_right" id="S4.T2.fig2.3.6.5"><span class="ltx_text ltx_font_bold" id="S4.T2.fig2.3.6.5.1">0.8092</span></td>
</tr>
<tr class="ltx_tr" id="S4.T2.fig2.3.7">
<td class="ltx_td ltx_align_left ltx_border_bb ltx_border_l" id="S4.T2.fig2.3.7.1">Rel+Div+Bias</td>
<td class="ltx_td ltx_align_right ltx_border_bb" id="S4.T2.fig2.3.7.2">-13.29</td>
<td class="ltx_td ltx_align_right ltx_border_bb" id="S4.T2.fig2.3.7.3">0.6573</td>
<td class="ltx_td ltx_align_right ltx_border_bb" id="S4.T2.fig2.3.7.4">0.5071</td>
<td class="ltx_td ltx_align_right ltx_border_bb" id="S4.T2.fig2.3.7.5">0.7924</td>
</tr>
</table>
</figure>
</div>
</div>
</figure>
<figure class="ltx_table" id="S4.T4">
<div class="ltx_flex_figure ltx_flex_table">
<div class="ltx_flex_cell ltx_flex_size_2">
<figure class="ltx_figure ltx_figure_panel ltx_minipage ltx_align_middle" id="S4.T4.fig1" style="width:216.8pt;">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure">Table 3: </span>Evaluation Metrics with <span class="ltx_text ltx_font_italic" id="S4.T4.fig1.2.1">Llama-3-8B-chat</span></figcaption>
<table class="ltx_tabular ltx_align_middle" id="S4.T4.fig1.3">
<tr class="ltx_tr" id="S4.T4.fig1.3.1">
<td class="ltx_td ltx_align_left ltx_border_tt" id="S4.T4.fig1.3.1.1">Method</td>
<td class="ltx_td ltx_align_right ltx_border_tt" id="S4.T4.fig1.3.1.2">DPO</td>
<td class="ltx_td ltx_align_right ltx_border_tt" id="S4.T4.fig1.3.1.3">MC1</td>
<td class="ltx_td ltx_align_right ltx_border_tt" id="S4.T4.fig1.3.1.4">MC2</td>
<td class="ltx_td ltx_align_right ltx_border_r ltx_border_tt" id="S4.T4.fig1.3.1.5">MC3</td>
</tr>
<tr class="ltx_tr" id="S4.T4.fig1.3.2">
<td class="ltx_td ltx_align_left ltx_border_t" id="S4.T4.fig1.3.2.1">Fix</td>
<td class="ltx_td ltx_align_right ltx_border_t" id="S4.T4.fig1.3.2.2">-22.12</td>
<td class="ltx_td ltx_align_right ltx_border_t" id="S4.T4.fig1.3.2.3">0.3623</td>
<td class="ltx_td ltx_align_right ltx_border_t" id="S4.T4.fig1.3.2.4">0.2709</td>
<td class="ltx_td ltx_align_right ltx_border_r ltx_border_t" id="S4.T4.fig1.3.2.5">0.5195</td>
</tr>
<tr class="ltx_tr" id="S4.T4.fig1.3.3">
<td class="ltx_td ltx_align_left" id="S4.T4.fig1.3.3.1">Bias</td>
<td class="ltx_td ltx_align_right" id="S4.T4.fig1.3.3.2">-17.55</td>
<td class="ltx_td ltx_align_right" id="S4.T4.fig1.3.3.3">0.3831</td>
<td class="ltx_td ltx_align_right" id="S4.T4.fig1.3.3.4">0.2876</td>
<td class="ltx_td ltx_align_right ltx_border_r" id="S4.T4.fig1.3.3.5">0.5729</td>
</tr>
<tr class="ltx_tr" id="S4.T4.fig1.3.4">
<td class="ltx_td ltx_align_left" id="S4.T4.fig1.3.4.1">Rel</td>
<td class="ltx_td ltx_align_right" id="S4.T4.fig1.3.4.2">-17.20</td>
<td class="ltx_td ltx_align_right" id="S4.T4.fig1.3.4.3">0.4920</td>
<td class="ltx_td ltx_align_right" id="S4.T4.fig1.3.4.4">0.4046</td>
<td class="ltx_td ltx_align_right ltx_border_r" id="S4.T4.fig1.3.4.5">0.6518</td>
</tr>
<tr class="ltx_tr" id="S4.T4.fig1.3.5">
<td class="ltx_td ltx_align_left" id="S4.T4.fig1.3.5.1">Rel+Bias</td>
<td class="ltx_td ltx_align_right" id="S4.T4.fig1.3.5.2">-17.14</td>
<td class="ltx_td ltx_align_right" id="S4.T4.fig1.3.5.3">0.5043</td>
<td class="ltx_td ltx_align_right" id="S4.T4.fig1.3.5.4">0.4083</td>
<td class="ltx_td ltx_align_right ltx_border_r" id="S4.T4.fig1.3.5.5">0.6570</td>
</tr>
<tr class="ltx_tr" id="S4.T4.fig1.3.6">
<td class="ltx_td ltx_align_left" id="S4.T4.fig1.3.6.1">Rel+Div</td>
<td class="ltx_td ltx_align_right" id="S4.T4.fig1.3.6.2">-16.14</td>
<td class="ltx_td ltx_align_right" id="S4.T4.fig1.3.6.3"><span class="ltx_text ltx_font_bold" id="S4.T4.fig1.3.6.3.1">0.5520</span></td>
<td class="ltx_td ltx_align_right" id="S4.T4.fig1.3.6.4"><span class="ltx_text ltx_font_bold" id="S4.T4.fig1.3.6.4.1">0.4173</span></td>
<td class="ltx_td ltx_align_right ltx_border_r" id="S4.T4.fig1.3.6.5"><span class="ltx_text ltx_font_bold" id="S4.T4.fig1.3.6.5.1">0.7009</span></td>
</tr>
<tr class="ltx_tr" id="S4.T4.fig1.3.7">
<td class="ltx_td ltx_align_left ltx_border_bb" id="S4.T4.fig1.3.7.1">Rel+Div+Bias</td>
<td class="ltx_td ltx_align_right ltx_border_bb" id="S4.T4.fig1.3.7.2"><span class="ltx_text ltx_font_bold" id="S4.T4.fig1.3.7.2.1">-15.80</span></td>
<td class="ltx_td ltx_align_right ltx_border_bb" id="S4.T4.fig1.3.7.3">0.5177</td>
<td class="ltx_td ltx_align_right ltx_border_bb" id="S4.T4.fig1.3.7.4">0.4007</td>
<td class="ltx_td ltx_align_right ltx_border_bb ltx_border_r" id="S4.T4.fig1.3.7.5">0.6841</td>
</tr>
</table>
</figure>
</div>
<div class="ltx_flex_cell ltx_flex_size_2">
<figure class="ltx_figure ltx_figure_panel ltx_minipage ltx_align_middle" id="S4.T4.fig2" style="width:216.8pt;">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure">Table 4: </span>Evaluation Metrics with <span class="ltx_text ltx_font_italic" id="S4.T4.fig2.2.1">Llama-3-70B-chat</span></figcaption>
<table class="ltx_tabular ltx_align_middle" id="S4.T4.fig2.3">
<tr class="ltx_tr" id="S4.T4.fig2.3.1">
<td class="ltx_td ltx_align_left ltx_border_l ltx_border_tt" id="S4.T4.fig2.3.1.1">Method</td>
<td class="ltx_td ltx_align_right ltx_border_tt" id="S4.T4.fig2.3.1.2">DPO</td>
<td class="ltx_td ltx_align_right ltx_border_tt" id="S4.T4.fig2.3.1.3">MC1</td>
<td class="ltx_td ltx_align_right ltx_border_tt" id="S4.T4.fig2.3.1.4">MC2</td>
<td class="ltx_td ltx_align_right ltx_border_tt" id="S4.T4.fig2.3.1.5">MC3</td>
</tr>
<tr class="ltx_tr" id="S4.T4.fig2.3.2">
<td class="ltx_td ltx_align_left ltx_border_l ltx_border_t" id="S4.T4.fig2.3.2.1">Fix</td>
<td class="ltx_td ltx_align_right ltx_border_t" id="S4.T4.fig2.3.2.2">-23.05</td>
<td class="ltx_td ltx_align_right ltx_border_t" id="S4.T4.fig2.3.2.3">0.4382</td>
<td class="ltx_td ltx_align_right ltx_border_t" id="S4.T4.fig2.3.2.4">0.3375</td>
<td class="ltx_td ltx_align_right ltx_border_t" id="S4.T4.fig2.3.2.5">0.6184</td>
</tr>
<tr class="ltx_tr" id="S4.T4.fig2.3.3">
<td class="ltx_td ltx_align_left ltx_border_l" id="S4.T4.fig2.3.3.1">Bias</td>
<td class="ltx_td ltx_align_right" id="S4.T4.fig2.3.3.2">-20.41</td>
<td class="ltx_td ltx_align_right" id="S4.T4.fig2.3.3.3">0.4455</td>
<td class="ltx_td ltx_align_right" id="S4.T4.fig2.3.3.4">0.3303</td>
<td class="ltx_td ltx_align_right" id="S4.T4.fig2.3.3.5">0.6424</td>
</tr>
<tr class="ltx_tr" id="S4.T4.fig2.3.4">
<td class="ltx_td ltx_align_left ltx_border_l" id="S4.T4.fig2.3.4.1">Rel</td>
<td class="ltx_td ltx_align_right" id="S4.T4.fig2.3.4.2">-19.02</td>
<td class="ltx_td ltx_align_right" id="S4.T4.fig2.3.4.3">0.5483</td>
<td class="ltx_td ltx_align_right" id="S4.T4.fig2.3.4.4">0.4482</td>
<td class="ltx_td ltx_align_right" id="S4.T4.fig2.3.4.5">0.6958</td>
</tr>
<tr class="ltx_tr" id="S4.T4.fig2.3.5">
<td class="ltx_td ltx_align_left ltx_border_l" id="S4.T4.fig2.3.5.1">Rel+Bias</td>
<td class="ltx_td ltx_align_right" id="S4.T4.fig2.3.5.2">-19.09</td>
<td class="ltx_td ltx_align_right" id="S4.T4.fig2.3.5.3">0.5532</td>
<td class="ltx_td ltx_align_right" id="S4.T4.fig2.3.5.4">0.4495</td>
<td class="ltx_td ltx_align_right" id="S4.T4.fig2.3.5.5">0.7054</td>
</tr>
<tr class="ltx_tr" id="S4.T4.fig2.3.6">
<td class="ltx_td ltx_align_left ltx_border_l" id="S4.T4.fig2.3.6.1">Rel+Div</td>
<td class="ltx_td ltx_align_right" id="S4.T4.fig2.3.6.2">-13.93</td>
<td class="ltx_td ltx_align_right" id="S4.T4.fig2.3.6.3"><span class="ltx_text ltx_font_bold" id="S4.T4.fig2.3.6.3.1">0.6389</span></td>
<td class="ltx_td ltx_align_right" id="S4.T4.fig2.3.6.4"><span class="ltx_text ltx_font_bold" id="S4.T4.fig2.3.6.4.1">0.4834</span></td>
<td class="ltx_td ltx_align_right" id="S4.T4.fig2.3.6.5"><span class="ltx_text ltx_font_bold" id="S4.T4.fig2.3.6.5.1">0.7758</span></td>
</tr>
<tr class="ltx_tr" id="S4.T4.fig2.3.7">
<td class="ltx_td ltx_align_left ltx_border_bb ltx_border_l" id="S4.T4.fig2.3.7.1">Rel+Div+Bias</td>
<td class="ltx_td ltx_align_right ltx_border_bb" id="S4.T4.fig2.3.7.2"><span class="ltx_text ltx_font_bold" id="S4.T4.fig2.3.7.2.1">-13.72</span></td>
<td class="ltx_td ltx_align_right ltx_border_bb" id="S4.T4.fig2.3.7.3">0.6022</td>
<td class="ltx_td ltx_align_right ltx_border_bb" id="S4.T4.fig2.3.7.4">0.4621</td>
<td class="ltx_td ltx_align_right ltx_border_bb" id="S4.T4.fig2.3.7.5">0.7583</td>
</tr>
</table>
</figure>
</div>
</div>
</figure>
<div class="ltx_para" id="S4.SS3.p2">
<p class="ltx_p" id="S4.SS3.p2.1">Our evaluation relies on a combination of metrics to assess the effectiveness of different retrieval strategies for ICL. The normalized DPO metric provides the most valuable insights for each LLM individually but cannot be directly compared across models. The three additional classification metrics allow for objective performance comparisons across models. However, these metrics are susceptible to bias based on token sequence length.</p>
</div>
<div class="ltx_para" id="S4.SS3.p3">
<p class="ltx_p" id="S4.SS3.p3.1">The impact of few-shot learning is best seen by comparing the three MC metrics for <span class="ltx_text ltx_font_italic" id="S4.SS3.p3.1.1">Rel+Div</span> for a smaller model against <span class="ltx_text ltx_font_italic" id="S4.SS3.p3.1.2">Fix</span> for a larger model: the smaller models (7B and 8B parameters) enriched with ICL RAG are essentially matching or outperforming the bigger models (141B and 70B parameters) without ICL RAG.</p>
</div>
<div class="ltx_para" id="S4.SS3.p4">
<p class="ltx_p" id="S4.SS3.p4.1">The results consistently demonstrate that incorporating both relevance and diversity into the retrieval strategy leads to superior performance across all metrics and for both LLMs.
For all models, and for all metrics, <span class="ltx_text ltx_font_italic" id="S4.SS3.p4.1.1">Rel+Div</span> largely outperforms <span class="ltx_text ltx_font_italic" id="S4.SS3.p4.1.2">Rel</span>.
This finding reinforces the importance of not just retrieving relevant demonstrations but also ensuring a diverse set that maximizes the informative value for the LLM.</p>
</div>
<div class="ltx_para" id="S4.SS3.p5">
<p class="ltx_p" id="S4.SS3.p5.1">Interestingly, the impact of the low perplexity bias yields contrasting results. For both Mistral models, adding this bias results in a decline in performance on almost all metrics. Conversely, both Llama-3 models exhibit overall improvement with the low perplexity bias, in particular with the DPO metric. This intriguing observation suggests that LLM-dependent hyper-parameter tuning of <math alttext="\lambda_{b}" class="ltx_Math" display="inline" id="S4.SS3.p5.1.m1.1"><semantics id="S4.SS3.p5.1.m1.1a"><msub id="S4.SS3.p5.1.m1.1.1" xref="S4.SS3.p5.1.m1.1.1.cmml"><mi id="S4.SS3.p5.1.m1.1.1.2" xref="S4.SS3.p5.1.m1.1.1.2.cmml">λ</mi><mi id="S4.SS3.p5.1.m1.1.1.3" xref="S4.SS3.p5.1.m1.1.1.3.cmml">b</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS3.p5.1.m1.1b"><apply id="S4.SS3.p5.1.m1.1.1.cmml" xref="S4.SS3.p5.1.m1.1.1"><csymbol cd="ambiguous" id="S4.SS3.p5.1.m1.1.1.1.cmml" xref="S4.SS3.p5.1.m1.1.1">subscript</csymbol><ci id="S4.SS3.p5.1.m1.1.1.2.cmml" xref="S4.SS3.p5.1.m1.1.1.2">𝜆</ci><ci id="S4.SS3.p5.1.m1.1.1.3.cmml" xref="S4.SS3.p5.1.m1.1.1.3">𝑏</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p5.1.m1.1c">\lambda_{b}</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.p5.1.m1.1d">italic_λ start_POSTSUBSCRIPT italic_b end_POSTSUBSCRIPT</annotation></semantics></math> might be necessary to optimize retrieval strategies for specific models. Alternatively, the low perplexity bias itself may benefit from further refinement. Using an opposite intuition, we may argue that instead of prioritizing demonstrations the LLM already finds likely, introducing demonstrations that surprise the model the most could be beneficial for certain LLMs, potentially maximizing the learning impact of each demonstration. These findings open exciting new avenues for future research in ICL retrieval strategies, creating a parallel with novelty and serendipity concepts in recommender systems.</p>
</div>
</section>
<section class="ltx_subsection" id="S4.SS4">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.4 </span>Calibrating Diversity using DPO</h3>
<div class="ltx_para" id="S4.SS4.p1">
<p class="ltx_p" id="S4.SS4.p1.4">Calibrating the amount of diversity in the retrieved set is crucial when optimizing ICL retrieval. We highlight the difficulty of achieving this without our proposed methodology by demonstrating the non-monotonous relationship between the amount of diversity in the retrieved demonstrations and the resulting benefit to the LLM performance. To quantify diversity, we calculate the average cosine similarity between the <code class="ltx_verbatim ltx_font_typewriter" id="S4.SS4.p1.4.1">BERT</code> embeddings of each demonstration pair within the retrieved set. The LLM’s benefit is measured using the DPO metric. We then systematically vary <math alttext="\lambda_{d}" class="ltx_Math" display="inline" id="S4.SS4.p1.1.m1.1"><semantics id="S4.SS4.p1.1.m1.1a"><msub id="S4.SS4.p1.1.m1.1.1" xref="S4.SS4.p1.1.m1.1.1.cmml"><mi id="S4.SS4.p1.1.m1.1.1.2" xref="S4.SS4.p1.1.m1.1.1.2.cmml">λ</mi><mi id="S4.SS4.p1.1.m1.1.1.3" xref="S4.SS4.p1.1.m1.1.1.3.cmml">d</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS4.p1.1.m1.1b"><apply id="S4.SS4.p1.1.m1.1.1.cmml" xref="S4.SS4.p1.1.m1.1.1"><csymbol cd="ambiguous" id="S4.SS4.p1.1.m1.1.1.1.cmml" xref="S4.SS4.p1.1.m1.1.1">subscript</csymbol><ci id="S4.SS4.p1.1.m1.1.1.2.cmml" xref="S4.SS4.p1.1.m1.1.1.2">𝜆</ci><ci id="S4.SS4.p1.1.m1.1.1.3.cmml" xref="S4.SS4.p1.1.m1.1.1.3">𝑑</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS4.p1.1.m1.1c">\lambda_{d}</annotation><annotation encoding="application/x-llamapun" id="S4.SS4.p1.1.m1.1d">italic_λ start_POSTSUBSCRIPT italic_d end_POSTSUBSCRIPT</annotation></semantics></math> while keeping the LLM fixed (<span class="ltx_text ltx_font_italic" id="S4.SS4.p1.4.2">Llama-3-8B-chat</span>), the quality bias fixed (<math alttext="\lambda_{b}=0.95" class="ltx_Math" display="inline" id="S4.SS4.p1.2.m2.1"><semantics id="S4.SS4.p1.2.m2.1a"><mrow id="S4.SS4.p1.2.m2.1.1" xref="S4.SS4.p1.2.m2.1.1.cmml"><msub id="S4.SS4.p1.2.m2.1.1.2" xref="S4.SS4.p1.2.m2.1.1.2.cmml"><mi id="S4.SS4.p1.2.m2.1.1.2.2" xref="S4.SS4.p1.2.m2.1.1.2.2.cmml">λ</mi><mi id="S4.SS4.p1.2.m2.1.1.2.3" xref="S4.SS4.p1.2.m2.1.1.2.3.cmml">b</mi></msub><mo id="S4.SS4.p1.2.m2.1.1.1" xref="S4.SS4.p1.2.m2.1.1.1.cmml">=</mo><mn id="S4.SS4.p1.2.m2.1.1.3" xref="S4.SS4.p1.2.m2.1.1.3.cmml">0.95</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.SS4.p1.2.m2.1b"><apply id="S4.SS4.p1.2.m2.1.1.cmml" xref="S4.SS4.p1.2.m2.1.1"><eq id="S4.SS4.p1.2.m2.1.1.1.cmml" xref="S4.SS4.p1.2.m2.1.1.1"></eq><apply id="S4.SS4.p1.2.m2.1.1.2.cmml" xref="S4.SS4.p1.2.m2.1.1.2"><csymbol cd="ambiguous" id="S4.SS4.p1.2.m2.1.1.2.1.cmml" xref="S4.SS4.p1.2.m2.1.1.2">subscript</csymbol><ci id="S4.SS4.p1.2.m2.1.1.2.2.cmml" xref="S4.SS4.p1.2.m2.1.1.2.2">𝜆</ci><ci id="S4.SS4.p1.2.m2.1.1.2.3.cmml" xref="S4.SS4.p1.2.m2.1.1.2.3">𝑏</ci></apply><cn id="S4.SS4.p1.2.m2.1.1.3.cmml" type="float" xref="S4.SS4.p1.2.m2.1.1.3">0.95</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS4.p1.2.m2.1c">\lambda_{b}=0.95</annotation><annotation encoding="application/x-llamapun" id="S4.SS4.p1.2.m2.1d">italic_λ start_POSTSUBSCRIPT italic_b end_POSTSUBSCRIPT = 0.95</annotation></semantics></math>), and the number of retrieved demonstrations constant (<math alttext="k=6" class="ltx_Math" display="inline" id="S4.SS4.p1.3.m3.1"><semantics id="S4.SS4.p1.3.m3.1a"><mrow id="S4.SS4.p1.3.m3.1.1" xref="S4.SS4.p1.3.m3.1.1.cmml"><mi id="S4.SS4.p1.3.m3.1.1.2" xref="S4.SS4.p1.3.m3.1.1.2.cmml">k</mi><mo id="S4.SS4.p1.3.m3.1.1.1" xref="S4.SS4.p1.3.m3.1.1.1.cmml">=</mo><mn id="S4.SS4.p1.3.m3.1.1.3" xref="S4.SS4.p1.3.m3.1.1.3.cmml">6</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.SS4.p1.3.m3.1b"><apply id="S4.SS4.p1.3.m3.1.1.cmml" xref="S4.SS4.p1.3.m3.1.1"><eq id="S4.SS4.p1.3.m3.1.1.1.cmml" xref="S4.SS4.p1.3.m3.1.1.1"></eq><ci id="S4.SS4.p1.3.m3.1.1.2.cmml" xref="S4.SS4.p1.3.m3.1.1.2">𝑘</ci><cn id="S4.SS4.p1.3.m3.1.1.3.cmml" type="integer" xref="S4.SS4.p1.3.m3.1.1.3">6</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS4.p1.3.m3.1c">k=6</annotation><annotation encoding="application/x-llamapun" id="S4.SS4.p1.3.m3.1d">italic_k = 6</annotation></semantics></math>) to observe the empirical correlation between diversity and DPO. The results are visualized in Figure <a class="ltx_ref" href="https://arxiv.org/html/2405.17587v2#S4.F1" title="Figure 1 ‣ 4.4 Calibrating Diversity using DPO ‣ 4 Experiments ‣ RAGSys: Item-Cold-Start Recommender as RAG System"><span class="ltx_text ltx_ref_tag">1</span></a>. This experiment underscores the importance of a metric measuring the impact of the retrieved context on the LLM, like DPO. Without such a metric, it would be challenging to effectively calibrate <math alttext="\lambda_{d}" class="ltx_Math" display="inline" id="S4.SS4.p1.4.m4.1"><semantics id="S4.SS4.p1.4.m4.1a"><msub id="S4.SS4.p1.4.m4.1.1" xref="S4.SS4.p1.4.m4.1.1.cmml"><mi id="S4.SS4.p1.4.m4.1.1.2" xref="S4.SS4.p1.4.m4.1.1.2.cmml">λ</mi><mi id="S4.SS4.p1.4.m4.1.1.3" xref="S4.SS4.p1.4.m4.1.1.3.cmml">d</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS4.p1.4.m4.1b"><apply id="S4.SS4.p1.4.m4.1.1.cmml" xref="S4.SS4.p1.4.m4.1.1"><csymbol cd="ambiguous" id="S4.SS4.p1.4.m4.1.1.1.cmml" xref="S4.SS4.p1.4.m4.1.1">subscript</csymbol><ci id="S4.SS4.p1.4.m4.1.1.2.cmml" xref="S4.SS4.p1.4.m4.1.1.2">𝜆</ci><ci id="S4.SS4.p1.4.m4.1.1.3.cmml" xref="S4.SS4.p1.4.m4.1.1.3">𝑑</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS4.p1.4.m4.1c">\lambda_{d}</annotation><annotation encoding="application/x-llamapun" id="S4.SS4.p1.4.m4.1d">italic_λ start_POSTSUBSCRIPT italic_d end_POSTSUBSCRIPT</annotation></semantics></math> and achieve the optimal balance between relevance and diversity in the retrieved demonstrations.</p>
</div>
<figure class="ltx_figure" id="S4.F1"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="337" id="S4.F1.g1" src="extracted/5792755/cosine_sim_vs_dpo.png" width="449"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 1: </span>Diversity Metric and DPO. Non-monotonous relationship between a diversity metric, the average cosine similarity between embedding pairs, and the quality metric DPO. Obtained by varying <math alttext="\lambda_{d}" class="ltx_Math" display="inline" id="S4.F1.3.m1.1"><semantics id="S4.F1.3.m1.1b"><msub id="S4.F1.3.m1.1.1" xref="S4.F1.3.m1.1.1.cmml"><mi id="S4.F1.3.m1.1.1.2" xref="S4.F1.3.m1.1.1.2.cmml">λ</mi><mi id="S4.F1.3.m1.1.1.3" xref="S4.F1.3.m1.1.1.3.cmml">d</mi></msub><annotation-xml encoding="MathML-Content" id="S4.F1.3.m1.1c"><apply id="S4.F1.3.m1.1.1.cmml" xref="S4.F1.3.m1.1.1"><csymbol cd="ambiguous" id="S4.F1.3.m1.1.1.1.cmml" xref="S4.F1.3.m1.1.1">subscript</csymbol><ci id="S4.F1.3.m1.1.1.2.cmml" xref="S4.F1.3.m1.1.1.2">𝜆</ci><ci id="S4.F1.3.m1.1.1.3.cmml" xref="S4.F1.3.m1.1.1.3">𝑑</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.F1.3.m1.1d">\lambda_{d}</annotation><annotation encoding="application/x-llamapun" id="S4.F1.3.m1.1e">italic_λ start_POSTSUBSCRIPT italic_d end_POSTSUBSCRIPT</annotation></semantics></math> with <span class="ltx_text ltx_font_italic" id="S4.F1.6.1">Llama-3-8B-chat</span> and <math alttext="k=6" class="ltx_Math" display="inline" id="S4.F1.4.m2.1"><semantics id="S4.F1.4.m2.1b"><mrow id="S4.F1.4.m2.1.1" xref="S4.F1.4.m2.1.1.cmml"><mi id="S4.F1.4.m2.1.1.2" xref="S4.F1.4.m2.1.1.2.cmml">k</mi><mo id="S4.F1.4.m2.1.1.1" xref="S4.F1.4.m2.1.1.1.cmml">=</mo><mn id="S4.F1.4.m2.1.1.3" xref="S4.F1.4.m2.1.1.3.cmml">6</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.F1.4.m2.1c"><apply id="S4.F1.4.m2.1.1.cmml" xref="S4.F1.4.m2.1.1"><eq id="S4.F1.4.m2.1.1.1.cmml" xref="S4.F1.4.m2.1.1.1"></eq><ci id="S4.F1.4.m2.1.1.2.cmml" xref="S4.F1.4.m2.1.1.2">𝑘</ci><cn id="S4.F1.4.m2.1.1.3.cmml" type="integer" xref="S4.F1.4.m2.1.1.3">6</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.F1.4.m2.1d">k=6</annotation><annotation encoding="application/x-llamapun" id="S4.F1.4.m2.1e">italic_k = 6</annotation></semantics></math>.</figcaption>
</figure>
</section>
</section>
<section class="ltx_section" id="S5">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">5 </span>Discussion: Real-World RAG Systems</h2>
<div class="ltx_para" id="S5.p1">
<p class="ltx_p" id="S5.p1.1">While the importance of diversity in ICL retrieval is paramount, we note that readily available RAG systems rarely implement it directly within the core retrieval algorithm. There are several practical considerations to keep in mind for successful deployment.</p>
</div>
<section class="ltx_subsection" id="S5.SS1">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">5.1 </span>Balancing Performance and Efficiency</h3>
<div class="ltx_para" id="S5.SS1.p1">
<p class="ltx_p" id="S5.SS1.p1.1">Retrieval latency is crucial at scale. Exhaustive, brute-force nearest neighbor search is computationally expensive and impractical. Instead, real-world systems leverage efficient indexing techniques and approximated <code class="ltx_verbatim ltx_font_typewriter" id="S5.SS1.p1.1.1">kNN</code> algorithms, as described in <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2405.17587v2#bib.bib23" title="">23</a>]</cite>, to ensure fast retrieval times. This approach is essential for handling large datasets while maintaining responsiveness.
To seamlessly integrate with existing retrieval engines and leverage their optimized search capabilities, a retrieval algorithm for RAG must ensure its data is stored in a format compatible with these engines. Commonly indexed data structures include text itself or low-dimensional dense vector embeddings. By adhering to these indexing practices, RAG systems can effectively leverage the power of existing retrieval engines and achieve fast, scalable retrieval of informative examples.</p>
</div>
</section>
<section class="ltx_subsection" id="S5.SS2">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">5.2 </span>ICL RAG versus Fine-Tuning</h3>
<div class="ltx_para" id="S5.SS2.p1">
<p class="ltx_p" id="S5.SS2.p1.1">The computational cost of ICL may be evaluated against the cost of fine-tuning. For instance, consider a large LLM like <code class="ltx_verbatim ltx_font_typewriter" id="S5.SS2.p1.1.1">gpt-3.5</code> with a current price 6x larger per input tokens between fine-tuned or default model
<span class="ltx_note ltx_role_footnote" id="footnote4"><sup class="ltx_note_mark">4</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">4</sup><span class="ltx_tag ltx_tag_note">4</span>In May 2024, the price of <span class="ltx_text ltx_font_italic" id="footnote4.1">gpt-turbo-0125</span> is $0.5/M input tokens, $1.5/M output tokens; and fine-tuned price of $3/M input tokens, $6/M output tokens, $8M fine-tuning tokens</span></span></span>.
While ICL requires additional input tokens, it is guaranteed to offer cost savings compared to fine-tuning when <math alttext="k&lt;6" class="ltx_Math" display="inline" id="S5.SS2.p1.1.m1.1"><semantics id="S5.SS2.p1.1.m1.1a"><mrow id="S5.SS2.p1.1.m1.1.1" xref="S5.SS2.p1.1.m1.1.1.cmml"><mi id="S5.SS2.p1.1.m1.1.1.2" xref="S5.SS2.p1.1.m1.1.1.2.cmml">k</mi><mo id="S5.SS2.p1.1.m1.1.1.1" xref="S5.SS2.p1.1.m1.1.1.1.cmml">&lt;</mo><mn id="S5.SS2.p1.1.m1.1.1.3" xref="S5.SS2.p1.1.m1.1.1.3.cmml">6</mn></mrow><annotation-xml encoding="MathML-Content" id="S5.SS2.p1.1.m1.1b"><apply id="S5.SS2.p1.1.m1.1.1.cmml" xref="S5.SS2.p1.1.m1.1.1"><lt id="S5.SS2.p1.1.m1.1.1.1.cmml" xref="S5.SS2.p1.1.m1.1.1.1"></lt><ci id="S5.SS2.p1.1.m1.1.1.2.cmml" xref="S5.SS2.p1.1.m1.1.1.2">𝑘</ci><cn id="S5.SS2.p1.1.m1.1.1.3.cmml" type="integer" xref="S5.SS2.p1.1.m1.1.1.3">6</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS2.p1.1.m1.1c">k&lt;6</annotation><annotation encoding="application/x-llamapun" id="S5.SS2.p1.1.m1.1d">italic_k &lt; 6</annotation></semantics></math> with this model.</p>
</div>
<div class="ltx_para" id="S5.SS2.p2">
<p class="ltx_p" id="S5.SS2.p2.1">An interesting contrast between ICL and fine-tuning is highlighted in the paper <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2405.17587v2#bib.bib51" title="">51</a>]</cite>. The paper argues that fine-tuning can be more efficient than few-shot ICL in terms of cost and latency due to the super-linear increase in LLM latency with growing prompt sizes. However, this latency concern is less relevant with inference-throughput optimized LLM systems built with large GPU clusters, such as commonly used APIs. In these systems, the observed latency remains independent of the prompt size. From a latency perspective, adding ICL demonstrations can be considered free. Additionally, the paper suggests that ICL requires scanning through 100% of the demonstrations at query time. However this does not hold when employing real retrieval engines with indexing and approximate <code class="ltx_verbatim ltx_font_typewriter" id="S5.SS2.p2.1.1">kNN</code>, which significantly reduce the number of examples scanned during retrieval.</p>
</div>
<div class="ltx_para" id="S5.SS2.p3">
<p class="ltx_p" id="S5.SS2.p3.1">Furthermore, building a curated database of few-shot demonstrations offers significant advantages to practitioners. These demonstrations are not specific to a single LLM but can be readily utilized with any LLM architecture. This eliminates vendor lock-in and lets practitioners leverage the best LLM for the task at hand without concerns about compatibility. Perhaps even more importantly, a well-maintained database of few-shot examples automatically benefits from the continuous advancements in LLM technology. As newer, more powerful pre-trained LLMs become rapidly available, existing demonstrations can be used to enrich them quickly. This ensures applications leverage the latest capabilities without the need to completely re-engineer workflows. This reusability and adaptability position our few-shot learning engine as a powerful tool for harnessing the ever-evolving potential of LLMs to solve real business challenges.</p>
</div>
</section>
<section class="ltx_subsection" id="S5.SS3">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">5.3 </span>Achieving State-of-the-Art Retrieval with Available Tools</h3>
<div class="ltx_para" id="S5.SS3.p1">
<p class="ltx_p" id="S5.SS3.p1.1">Traditional full-text search algorithms like BM25 lead to empirically lower ICL quality. Vector stores offer a more suitable solution for efficient retrieval based on semantic similarity. Numerous vendors provide vector store solutions, and they can be broadly categorized as follows:</p>
</div>
<div class="ltx_para" id="S5.SS3.p2">
<p class="ltx_p" id="S5.SS3.p2.1">In-Memory vector indexes, such as <code class="ltx_verbatim ltx_font_typewriter" id="S5.SS3.p2.1.1">FAISS</code> and <code class="ltx_verbatim ltx_font_typewriter" id="S5.SS3.p2.1.2">nmslib</code>, offer exceptional speed with minimal setup complexity, but limited scalability for larger datasets. They may not implement in-place addition or deletion of the indexed vectors.
Self-Hosted vector databases, such as <code class="ltx_verbatim ltx_font_typewriter" id="S5.SS3.p2.1.3">Elasticsearch</code> and <code class="ltx_verbatim ltx_font_typewriter" id="S5.SS3.p2.1.4">Postgres</code>, provide a balance between scalability and performance, at a much larger setup complexity. They typically implement efficient addition and deletion of the indexed vectors.
SaaS vector stores, such as <code class="ltx_verbatim ltx_font_typewriter" id="S5.SS3.p2.1.5">Pinecone</code> and <code class="ltx_verbatim ltx_font_typewriter" id="S5.SS3.p2.1.6">VertexAI</code>, offer a convenient option with pre-configured infrastructure and almost no setup complexity.
We invite the reader to consult the lists of integrated vector stores
of LangChain <span class="ltx_note ltx_role_footnote" id="footnote5"><sup class="ltx_note_mark">5</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">5</sup><span class="ltx_tag ltx_tag_note">5</span><a class="ltx_ref ltx_url ltx_font_typewriter" href="https://python.langchain.com/docs/integrations/vectorstores/" title="">https://python.langchain.com/docs/integrations/vectorstores/</a></span></span></span>
and LlamaIndex <span class="ltx_note ltx_role_footnote" id="footnote6"><sup class="ltx_note_mark">6</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">6</sup><span class="ltx_tag ltx_tag_note">6</span><a class="ltx_ref ltx_url ltx_font_typewriter" href="https://docs.llamaindex.ai/en/stable/module_guides/storing/vector_stores/" title="">https://docs.llamaindex.ai/en/stable/module_guides/storing/vector_stores/</a></span></span></span>
for near-exhaustive lists of available tools.</p>
</div>
<div class="ltx_para" id="S5.SS3.p3">
<p class="ltx_p" id="S5.SS3.p3.1">Due to the complexities of incorporating such rules directly within retrieval indexing algorithm <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2405.17587v2#bib.bib52" title="">52</a>]</cite>, none of the solutions known to the authors from any of the above category implements diversity or quality biasing of the result.
A common heuristic to mitigate this problem is to retrieve a larger set of candidate examples (e.g., double the desired number) and then apply diversity techniques like MMR on the retrieved candidates as a post-processing step.
Quality biasing can be indirectly achieved by modifying the indexed embeddings themselves. For instance, reducing the norm of embeddings associated with low-quality content can nudge the retrieval algorithm towards higher-quality examples. An exact implementation in the context of cosine-similarity or dot-product relevance is to add an additional column storing the quality bias, and set the corresponding value to <math alttext="1" class="ltx_Math" display="inline" id="S5.SS3.p3.1.m1.1"><semantics id="S5.SS3.p3.1.m1.1a"><mn id="S5.SS3.p3.1.m1.1.1" xref="S5.SS3.p3.1.m1.1.1.cmml">1</mn><annotation-xml encoding="MathML-Content" id="S5.SS3.p3.1.m1.1b"><cn id="S5.SS3.p3.1.m1.1.1.cmml" type="integer" xref="S5.SS3.p3.1.m1.1.1">1</cn></annotation-xml><annotation encoding="application/x-tex" id="S5.SS3.p3.1.m1.1c">1</annotation><annotation encoding="application/x-llamapun" id="S5.SS3.p3.1.m1.1d">1</annotation></semantics></math> in the embedding of the query.</p>
</div>
<div class="ltx_para" id="S5.SS3.p4">
<p class="ltx_p" id="S5.SS3.p4.1">While vector search offers a powerful foundation for practical ICL retrieval, it often lacks native support for essential considerations like diversity or quality bias. These aspects are crucial for ensuring informative and effective retrieval of few-shot learning examples. Existing tools for recommendation engines, on the other hand, often excel in these areas. Recommendation engines natively incorporate rules that promote diversity by recommending a variety of items, or quality bias by prioritizing most popular products. Future research directions as well as practical systems for ICL retrieval could explore adapting or integrating these well-established techniques from recommender systems to further enhance the effectiveness and sophistication of few-shot learning through information retrieval. State-of-the-art ICL for real-world applications can be achieved by combining the strengths of vector search with the established "diversity-aware" retrieval approaches from recommender systems.</p>
</div>
</section>
</section>
<section class="ltx_section" id="S6">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">6 </span>Conclusion</h2>
<div class="ltx_para" id="S6.p1">
<p class="ltx_p" id="S6.p1.1">This paper explored the critical role of information retrieval in ICL for few-shot learning with Large Language Models. Our work identified key desirable properties for ICL retrieval systems. We demonstrated that state-of-the-art retrieval in this domain resembles recommender systems under the item cold-start problems. Unlike traditional information retrieval prioritizing for exact recall, our approach emphasizes discovery by maximizing the collective information gain from retrieved demonstrations. This necessitates balancing query relevance, quality scoring, and diversity to ensure a variety of informative examples are surfaced.
Furthermore, we propose a novel evaluation method for ICL retrieval based on the subsequent performance of the enriched LLM on NLP tasks. This approach eliminates the need for subjective diversity scores, a challenge in information retrieval evaluation.
Our findings demonstrate the significant impact of diversity and quality bias in retrieving demonstrations for ICL. By incorporating these well-established techniques from recommender systems, we can unlock the full potential of ICL for few-shot learning and empower LLMs to tackle real-world tasks with limited data.</p>
</div>
</section>
<section class="ltx_section" id="S7">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">7 </span>Acknowledgments</h2>
<div class="ltx_para" id="S7.p1">
<p class="ltx_p" id="S7.p1.1">To Ching-Wei Chen, for finding the name <span class="ltx_text ltx_font_italic" id="S7.p1.1.1">RAGSys</span>, and the entire Crossing Minds team for their support during this research.</p>
</div>
</section>
<section class="ltx_bibliography" id="bib">
<h2 class="ltx_title ltx_title_bibliography">References</h2>
<ul class="ltx_biblist">
<li class="ltx_bibitem" id="bib.bib1">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Brown et al. [2020]</span>
<span class="ltx_bibblock">
T. Brown, B. Mann, N. Ryder, M. Subbiah, J. D. Kaplan, P. Dhariwal, A. Neelakantan, P. Shyam, G. Sastry, A. Askell, et al.,

</span>
<span class="ltx_bibblock">Language models are few-shot learners,

</span>
<span class="ltx_bibblock">Advances in neural information processing systems 33 (2020) 1877–1901.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib2">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Kojima et al. [2022]</span>
<span class="ltx_bibblock">
T. Kojima, S. S. Gu, M. Reid, Y. Matsuo, Y. Iwasawa,

</span>
<span class="ltx_bibblock">Large language models are zero-shot reasoners,

</span>
<span class="ltx_bibblock">in: S. Koyejo, S. Mohamed, A. Agarwal, D. Belgrave, K. Cho, A. Oh (Eds.), Advances in Neural Information Processing Systems, volume 35, Curran Associates, Inc., 2022, pp. 22199–22213. URL: <a class="ltx_ref ltx_url ltx_font_typewriter" href="https://proceedings.neurips.cc/paper_files/paper/2022/file/8bb0d291acd4acf06ef112099c16f326-Paper-Conference.pdf" title="">https://proceedings.neurips.cc/paper_files/paper/2022/file/8bb0d291acd4acf06ef112099c16f326-Paper-Conference.pdf</a>.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib3">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Hu et al. [2022]</span>
<span class="ltx_bibblock">
E. J. Hu, yelong shen, P. Wallis, Z. Allen-Zhu, Y. Li, S. Wang, L. Wang, W. Chen,

</span>
<span class="ltx_bibblock">LoRA: Low-rank adaptation of large language models,

</span>
<span class="ltx_bibblock">in: International Conference on Learning Representations, 2022. URL: <a class="ltx_ref ltx_url ltx_font_typewriter" href="https://openreview.net/forum?id=nZeVKeeFYf9" title="">https://openreview.net/forum?id=nZeVKeeFYf9</a>.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib4">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Luo et al. [2023]</span>
<span class="ltx_bibblock">
Y. Luo, Z. Yang, F. Meng, Y. Li, J. Zhou, Y. Zhang,

</span>
<span class="ltx_bibblock">An empirical study of catastrophic forgetting in large language models during continual fine-tuning,

</span>
<span class="ltx_bibblock">ArXiv abs/2308.08747 (2023). URL: <a class="ltx_ref ltx_url ltx_font_typewriter" href="https://api.semanticscholar.org/CorpusID:261031244" title="">https://api.semanticscholar.org/CorpusID:261031244</a>.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib5">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Berglund et al. [2023]</span>
<span class="ltx_bibblock">
L. Berglund, M. Tong, M. Kaufmann, M. Balesni, A. C. Stickland, T. Korbak, O. Evans,

</span>
<span class="ltx_bibblock">The reversal curse: Llms trained on "a is b" fail to learn "b is a",

</span>
<span class="ltx_bibblock">ArXiv abs/2309.12288 (2023). URL: <a class="ltx_ref ltx_url ltx_font_typewriter" href="https://api.semanticscholar.org/CorpusID:262083829" title="">https://api.semanticscholar.org/CorpusID:262083829</a>.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib6">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Bai et al. [2023]</span>
<span class="ltx_bibblock">
Y. Bai, F. Chen, H. Wang, C. Xiong, S. Mei,

</span>
<span class="ltx_bibblock">Transformers as statisticians: Provable in-context learning with in-context algorithm selection,

</span>
<span class="ltx_bibblock">in: A. Oh, T. Neumann, A. Globerson, K. Saenko, M. Hardt, S. Levine (Eds.), Advances in Neural Information Processing Systems, volume 36, Curran Associates, Inc., 2023, pp. 57125–57211. URL: <a class="ltx_ref ltx_url ltx_font_typewriter" href="https://proceedings.neurips.cc/paper_files/paper/2023/file/b2e63e36c57e153b9015fece2352a9f9-Paper-Conference.pdf" title="">https://proceedings.neurips.cc/paper_files/paper/2023/file/b2e63e36c57e153b9015fece2352a9f9-Paper-Conference.pdf</a>.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib7">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Ram et al. [2023]</span>
<span class="ltx_bibblock">
O. Ram, Y. Levine, I. Dalmedigos, D. Muhlgay, A. Shashua, K. Leyton-Brown, Y. Shoham,

</span>
<span class="ltx_bibblock">In-Context Retrieval-Augmented Language Models,

</span>
<span class="ltx_bibblock">Transactions of the Association for Computational Linguistics 11 (2023) 1316–1331. doi:<a class="ltx_ref" href="https:/doi.org/10.1162/tacl_a_00605" title="">10.1162/tacl_a_00605</a>.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib8">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Dong et al. [2023]</span>
<span class="ltx_bibblock">
Q. Dong, L. Li, D. Dai, C. Zheng, Z. Wu, B. Chang, X. Sun, J. Xu, L. Li, Z. Sui,

</span>
<span class="ltx_bibblock">A survey for in-context learning,

</span>
<span class="ltx_bibblock">CoRR abs/2301.00234 (2023).

</span>
</li>
<li class="ltx_bibitem" id="bib.bib9">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Machlab and Battle [2024]</span>
<span class="ltx_bibblock">
D. Machlab, R. Battle,

</span>
<span class="ltx_bibblock">LLM In-Context Recall is Prompt Dependent,

</span>
<span class="ltx_bibblock">CoRR (2024) arXiv:2404.08865. doi:<a class="ltx_ref" href="https:/doi.org/10.48550/arXiv.2404.08865" title="">10.48550/arXiv.2404.08865</a>. <a class="ltx_ref ltx_href ltx_font_typewriter" href="http://arxiv.org/abs/2404.08865" title="">arXiv:2404.08865</a>.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib10">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Clarke et al. [2008]</span>
<span class="ltx_bibblock">
C. L. Clarke, M. Kolla, G. V. Cormack, O. Vechtomova, A. Ashkan, S. Büttcher, I. MacKinnon,

</span>
<span class="ltx_bibblock">Novelty and diversity in information retrieval evaluation,

</span>
<span class="ltx_bibblock">in: Proceedings of the 31st Annual International ACM SIGIR Conference on Research and Development in Information Retrieval, SIGIR ’08, Association for Computing Machinery, New York, NY, USA, 2008, p. 659–666. doi:<a class="ltx_ref" href="https:/doi.org/10.1145/1390334.1390446" title="">10.1145/1390334.1390446</a>.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib11">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Yu et al. [2023]</span>
<span class="ltx_bibblock">
W. Yu, D. Iter, S. Wang, Y. Xu, M. Ju, S. Sanyal, C. Zhu, M. Zeng, M. Jiang,

</span>
<span class="ltx_bibblock">Generate rather than retrieve: Large language models are strong context generators,

</span>
<span class="ltx_bibblock">in: International Conference for Learning Representation (ICLR), 2023.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib12">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Gonen et al. [2023]</span>
<span class="ltx_bibblock">
H. Gonen, S. Iyer, T. Blevins, N. Smith, L. Zettlemoyer,

</span>
<span class="ltx_bibblock">Demystifying prompts in language models via perplexity estimation,

</span>
<span class="ltx_bibblock">in: H. Bouamor, J. Pino, K. Bali (Eds.), Findings of the Association for Computational Linguistics: EMNLP 2023, Association for Computational Linguistics, Singapore, 2023, pp. 10136–10148. doi:<a class="ltx_ref" href="https:/doi.org/10.18653/v1/2023.findings-emnlp.679" title="">10.18653/v1/2023.findings-emnlp.679</a>.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib13">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Agrawal et al. [2023]</span>
<span class="ltx_bibblock">
S. Agrawal, C. Zhou, M. Lewis, L. Zettlemoyer, M. Ghazvininejad,

</span>
<span class="ltx_bibblock">In-context examples selection for machine translation,

</span>
<span class="ltx_bibblock">in: A. Rogers, J. Boyd-Graber, N. Okazaki (Eds.), Findings of the Association for Computational Linguistics: ACL 2023, Association for Computational Linguistics, Toronto, Canada, 2023, pp. 8857–8873. doi:<a class="ltx_ref" href="https:/doi.org/10.18653/v1/2023.findings-acl.564" title="">10.18653/v1/2023.findings-acl.564</a>.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib14">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Robertson et al. [1995]</span>
<span class="ltx_bibblock">
S. Robertson, S. Walker, S. Jones, M. M. Hancock-Beaulieu, M. Gatford,

</span>
<span class="ltx_bibblock">Okapi at trec-3,

</span>
<span class="ltx_bibblock">in: Overview of the Third Text REtrieval Conference (TREC-3), Gaithersburg, MD: NIST, 1995, pp. 109–126. URL: <a class="ltx_ref ltx_url ltx_font_typewriter" href="https://www.microsoft.com/en-us/research/publication/okapi-at-trec-3/" title="">https://www.microsoft.com/en-us/research/publication/okapi-at-trec-3/</a>.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib15">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Rubin et al. [2022]</span>
<span class="ltx_bibblock">
O. Rubin, J. Herzig, J. Berant,

</span>
<span class="ltx_bibblock">Learning to retrieve prompts for in-context learning,

</span>
<span class="ltx_bibblock">in: M. Carpuat, M.-C. de Marneffe, I. V. Meza Ruiz (Eds.), Proceedings of the 2022 Conference of the North American Chapter of the Association for Computational Linguistics: Human Language Technologies, Association for Computational Linguistics, Seattle, United States, 2022, pp. 2655–2671. doi:<a class="ltx_ref" href="https:/doi.org/10.18653/v1/2022.naacl-main.191" title="">10.18653/v1/2022.naacl-main.191</a>.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib16">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Wang et al. [2022]</span>
<span class="ltx_bibblock">
L. Wang, N. Yang, X. Huang, B. Jiao, L. Yang, D. Jiang, R. Majumder, F. Wei,

</span>
<span class="ltx_bibblock">Text Embeddings by Weakly-Supervised Contrastive Pre-training,

</span>
<span class="ltx_bibblock">CoRR (2022) arXiv:2212.03533. doi:<a class="ltx_ref" href="https:/doi.org/10.48550/arXiv.2212.03533" title="">10.48550/arXiv.2212.03533</a>. <a class="ltx_ref ltx_href ltx_font_typewriter" href="http://arxiv.org/abs/2212.03533" title="">arXiv:2212.03533</a>.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib17">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Li et al. [2023]</span>
<span class="ltx_bibblock">
X. Li, K. Lv, H. Yan, T. Lin, W. Zhu, Y. Ni, G. Xie, X. Wang, X. Qiu,

</span>
<span class="ltx_bibblock">Unified demonstration retriever for in-context learning,

</span>
<span class="ltx_bibblock">in: A. Rogers, J. Boyd-Graber, N. Okazaki (Eds.), Proceedings of the 61st Annual Meeting of the Association for Computational Linguistics (Volume 1: Long Papers), Association for Computational Linguistics, Toronto, Canada, 2023, pp. 4644–4668. doi:<a class="ltx_ref" href="https:/doi.org/10.18653/v1/2023.acl-long.256" title="">10.18653/v1/2023.acl-long.256</a>.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib18">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Ye et al. [2023]</span>
<span class="ltx_bibblock">
J. Ye, Z. Wu, J. Feng, T. Yu, L. Kong,

</span>
<span class="ltx_bibblock">Compositional exemplars for in-context learning,

</span>
<span class="ltx_bibblock">in: A. Krause, E. Brunskill, K. Cho, B. Engelhardt, S. Sabato, J. Scarlett (Eds.), Proceedings of the 40th International Conference on Machine Learning, volume 202 of <span class="ltx_text ltx_font_italic" id="bib.bib18.1.1">Proceedings of Machine Learning Research</span>, PMLR, 2023, pp. 39818–39833. URL: <a class="ltx_ref ltx_url ltx_font_typewriter" href="https://proceedings.mlr.press/v202/ye23c.html" title="">https://proceedings.mlr.press/v202/ye23c.html</a>.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib19">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Wang et al. [2024]</span>
<span class="ltx_bibblock">
L. Wang, N. Yang, F. Wei,

</span>
<span class="ltx_bibblock">Learning to retrieve in-context examples for large language models,

</span>
<span class="ltx_bibblock">in: Y. Graham, M. Purver (Eds.), Proceedings of the 18th Conference of the European Chapter of the Association for Computational Linguistics (Volume 1: Long Papers), Association for Computational Linguistics, St. Julian’s, Malta, 2024, pp. 1752–1767.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib20">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Liu et al. [2022]</span>
<span class="ltx_bibblock">
J. Liu, D. Shen, Y. Zhang, B. Dolan, L. Carin, W. Chen,

</span>
<span class="ltx_bibblock">What makes good in-context examples for GPT-3?,

</span>
<span class="ltx_bibblock">in: E. Agirre, M. Apidianaki, I. Vulić (Eds.), Proceedings of Deep Learning Inside Out (DeeLIO 2022): The 3rd Workshop on Knowledge Extraction and Integration for Deep Learning Architectures, Association for Computational Linguistics, Dublin, Ireland and Online, 2022, pp. 100–114. doi:<a class="ltx_ref" href="https:/doi.org/10.18653/v1/2022.deelio-1.10" title="">10.18653/v1/2022.deelio-1.10</a>.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib21">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Devlin et al. [2019]</span>
<span class="ltx_bibblock">
J. Devlin, M.-W. Chang, K. Lee, K. Toutanova,

</span>
<span class="ltx_bibblock">BERT: Pre-training of deep bidirectional transformers for language understanding,

</span>
<span class="ltx_bibblock">in: J. Burstein, C. Doran, T. Solorio (Eds.), Proceedings of the 2019 Conference of the North American Chapter of the Association for Computational Linguistics: Human Language Technologies, Volume 1 (Long and Short Papers), Association for Computational Linguistics, Minneapolis, Minnesota, 2019, pp. 4171–4186. doi:<a class="ltx_ref" href="https:/doi.org/10.18653/v1/N19-1423" title="">10.18653/v1/N19-1423</a>.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib22">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Khattab and Zaharia [2020]</span>
<span class="ltx_bibblock">
O. Khattab, M. Zaharia,

</span>
<span class="ltx_bibblock">Colbert: Efficient and effective passage search via contextualized late interaction over bert,

</span>
<span class="ltx_bibblock">in: Proceedings of the 43rd International ACM SIGIR Conference on Research and Development in Information Retrieval, SIGIR ’20, Association for Computing Machinery, New York, NY, USA, 2020, p. 39–48. doi:<a class="ltx_ref" href="https:/doi.org/10.1145/3397271.3401075" title="">10.1145/3397271.3401075</a>.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib23">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Beygelzimer et al. [2006]</span>
<span class="ltx_bibblock">
A. Beygelzimer, S. Kakade, J. Langford,

</span>
<span class="ltx_bibblock">Cover trees for nearest neighbor,

</span>
<span class="ltx_bibblock">in: Proceedings of the 23rd International Conference on Machine Learning, ICML ’06, Association for Computing Machinery, New York, NY, USA, 2006, p. 97–104. doi:<a class="ltx_ref" href="https:/doi.org/10.1145/1143844.1143857" title="">10.1145/1143844.1143857</a>.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib24">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Levy et al. [2023]</span>
<span class="ltx_bibblock">
I. Levy, B. Bogin, J. Berant,

</span>
<span class="ltx_bibblock">Diverse demonstrations improve in-context compositional generalization,

</span>
<span class="ltx_bibblock">in: A. Rogers, J. Boyd-Graber, N. Okazaki (Eds.), Proceedings of the 61st Annual Meeting of the Association for Computational Linguistics (Volume 1: Long Papers), Association for Computational Linguistics, Toronto, Canada, 2023, pp. 1401–1422. doi:<a class="ltx_ref" href="https:/doi.org/10.18653/v1/2023.acl-long.78" title="">10.18653/v1/2023.acl-long.78</a>.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib25">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Su et al. [2023]</span>
<span class="ltx_bibblock">
H. Su, J. Kasai, C. H. Wu, W. Shi, T. Wang, J. Xin, R. Z. 0037, M. Ostendorf, L. Zettlemoyer, N. A. Smith, T. Y. 0009,

</span>
<span class="ltx_bibblock">Selective annotation makes language models better few-shot learners,

</span>
<span class="ltx_bibblock">in: The Eleventh International Conference on Learning Representations, ICLR 2023, Kigali, Rwanda, May 1-5, 2023, OpenReview.net, 2023. URL: <a class="ltx_ref ltx_url ltx_font_typewriter" href="https://openreview.net/pdf?id=qY1hlv7gwg" title="">https://openreview.net/pdf?id=qY1hlv7gwg</a>.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib26">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Ye et al. [2023]</span>
<span class="ltx_bibblock">
X. Ye, S. Iyer, A. Celikyilmaz, V. Stoyanov, G. Durrett, R. Pasunuru,

</span>
<span class="ltx_bibblock">Complementary explanations for effective in-context learning,

</span>
<span class="ltx_bibblock">in: A. Rogers, J. Boyd-Graber, N. Okazaki (Eds.), Findings of the Association for Computational Linguistics: ACL 2023, Association for Computational Linguistics, Toronto, Canada, 2023, pp. 4469–4484. doi:<a class="ltx_ref" href="https:/doi.org/10.18653/v1/2023.findings-acl.273" title="">10.18653/v1/2023.findings-acl.273</a>.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib27">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Carbonell and Goldstein [1998]</span>
<span class="ltx_bibblock">
J. Carbonell, J. Goldstein,

</span>
<span class="ltx_bibblock">The use of mmr, diversity-based reranking for reordering documents and producing summaries,

</span>
<span class="ltx_bibblock">in: Proceedings of the 21st Annual International ACM SIGIR Conference on Research and Development in Information Retrieval, SIGIR ’98, Association for Computing Machinery, New York, NY, USA, 1998, p. 335–336. doi:<a class="ltx_ref" href="https:/doi.org/10.1145/290941.291025" title="">10.1145/290941.291025</a>.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib28">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Zhai et al. [2003]</span>
<span class="ltx_bibblock">
C. X. Zhai, W. W. Cohen, J. Lafferty,

</span>
<span class="ltx_bibblock">Beyond independent relevance: methods and evaluation metrics for subtopic retrieval,

</span>
<span class="ltx_bibblock">in: Proceedings of the 26th Annual International ACM SIGIR Conference on Research and Development in Informaion Retrieval, SIGIR ’03, Association for Computing Machinery, New York, NY, USA, 2003, p. 10–17. doi:<a class="ltx_ref" href="https:/doi.org/10.1145/860435.860440" title="">10.1145/860435.860440</a>.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib29">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Agrawal et al. [2009]</span>
<span class="ltx_bibblock">
R. Agrawal, S. Gollapudi, A. Halverson, S. Ieong,

</span>
<span class="ltx_bibblock">Diversifying search results,

</span>
<span class="ltx_bibblock">in: Proceedings of the Second ACM International Conference on Web Search and Data Mining, WSDM ’09, Association for Computing Machinery, New York, NY, USA, 2009, p. 5–14. URL: <a class="ltx_ref ltx_url ltx_font_typewriter" href="https://doi.org/10.1145/1498759.1498766" title="">https://doi.org/10.1145/1498759.1498766</a>. doi:<a class="ltx_ref" href="https:/doi.org/10.1145/1498759.1498766" title="">10.1145/1498759.1498766</a>.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib30">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Gollapudi and Sharma [2009]</span>
<span class="ltx_bibblock">
S. Gollapudi, A. Sharma,

</span>
<span class="ltx_bibblock">An axiomatic approach for result diversification,

</span>
<span class="ltx_bibblock">in: Proceedings of the 18th International Conference on World Wide Web, WWW ’09, Association for Computing Machinery, New York, NY, USA, 2009, p. 381–390. doi:<a class="ltx_ref" href="https:/doi.org/10.1145/1526709.1526761" title="">10.1145/1526709.1526761</a>.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib31">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Vieira et al. [2011]</span>
<span class="ltx_bibblock">
M. R. Vieira, H. L. Razente, M. C. N. Barioni, M. Hadjieleftheriou, D. Srivastava, C. Traina, V. J. Tsotras,

</span>
<span class="ltx_bibblock">On query result diversification,

</span>
<span class="ltx_bibblock">in: Proceedings of the 2011 IEEE 27th International Conference on Data Engineering, ICDE ’11, IEEE Computer Society, USA, 2011, p. 1163–1174. doi:<a class="ltx_ref" href="https:/doi.org/10.1109/ICDE.2011.5767846" title="">10.1109/ICDE.2011.5767846</a>.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib32">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Clarke et al. [2009]</span>
<span class="ltx_bibblock">
C. L. Clarke, N. Craswell, I. Soboroff,

</span>
<span class="ltx_bibblock">Overview of the trec 2009 web track.,

</span>
<span class="ltx_bibblock">in: Trec, volume 9, 2009, pp. 20–29.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib33">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Chapelle et al. [2009]</span>
<span class="ltx_bibblock">
O. Chapelle, D. Metlzer, Y. Zhang, P. Grinspan,

</span>
<span class="ltx_bibblock">Expected reciprocal rank for graded relevance,

</span>
<span class="ltx_bibblock">in: Proceedings of the 18th ACM Conference on Information and Knowledge Management, CIKM ’09, Association for Computing Machinery, New York, NY, USA, 2009, p. 621–630. doi:<a class="ltx_ref" href="https:/doi.org/10.1145/1645953.1646033" title="">10.1145/1645953.1646033</a>.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib34">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Clarke et al. [2009]</span>
<span class="ltx_bibblock">
C. L. Clarke, M. Kolla, O. Vechtomova,

</span>
<span class="ltx_bibblock">An effectiveness measure for ambiguous and underspecified queries,

</span>
<span class="ltx_bibblock">in: Proceedings of the 2nd International Conference on Theory of Information Retrieval: Advances in Information Retrieval Theory, ICTIR ’09, Springer-Verlag, Berlin, Heidelberg, 2009, p. 188–199. doi:<a class="ltx_ref" href="https:/doi.org/10.1007/978-3-642-04417-5_17" title="">10.1007/978-3-642-04417-5_17</a>.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib35">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Clarke et al. [2011]</span>
<span class="ltx_bibblock">
C. L. Clarke, N. Craswell, I. Soboroff, A. Ashkan,

</span>
<span class="ltx_bibblock">A comparative analysis of cascade measures for novelty and diversity,

</span>
<span class="ltx_bibblock">in: Proceedings of the Fourth ACM International Conference on Web Search and Data Mining, WSDM ’11, Association for Computing Machinery, New York, NY, USA, 2011, p. 75–84. doi:<a class="ltx_ref" href="https:/doi.org/10.1145/1935826.1935847" title="">10.1145/1935826.1935847</a>.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib36">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Ziegler et al. [2005]</span>
<span class="ltx_bibblock">
C.-N. Ziegler, S. M. McNee, J. A. Konstan, G. Lausen,

</span>
<span class="ltx_bibblock">Improving recommendation lists through topic diversification,

</span>
<span class="ltx_bibblock">in: Proceedings of the 14th International Conference on World Wide Web, WWW ’05, Association for Computing Machinery, New York, NY, USA, 2005, p. 22–32. doi:<a class="ltx_ref" href="https:/doi.org/10.1145/1060745.1060754" title="">10.1145/1060745.1060754</a>.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib37">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Vargas and Castells [2011]</span>
<span class="ltx_bibblock">
S. Vargas, P. Castells,

</span>
<span class="ltx_bibblock">Rank and relevance in novelty and diversity metrics for recommender systems,

</span>
<span class="ltx_bibblock">in: Proceedings of the Fifth ACM Conference on Recommender Systems, RecSys ’11, Association for Computing Machinery, New York, NY, USA, 2011, p. 109–116. doi:<a class="ltx_ref" href="https:/doi.org/10.1145/2043932.2043955" title="">10.1145/2043932.2043955</a>.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib38">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Vargas [2014]</span>
<span class="ltx_bibblock">
S. Vargas,

</span>
<span class="ltx_bibblock">Novelty and diversity enhancement and evaluation in recommender systems and information retrieval,

</span>
<span class="ltx_bibblock">in: Proceedings of the 37th International ACM SIGIR Conference on Research &amp; Development in Information Retrieval, SIGIR ’14, Association for Computing Machinery, New York, NY, USA, 2014, p. 1281. doi:<a class="ltx_ref" href="https:/doi.org/10.1145/2600428.2610382" title="">10.1145/2600428.2610382</a>.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib39">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Zheng et al. [2021]</span>
<span class="ltx_bibblock">
Y. Zheng, C. Gao, L. Chen, D. Jin, Y. Li,

</span>
<span class="ltx_bibblock">Dgcn: Diversified recommendation with graph convolutional networks,

</span>
<span class="ltx_bibblock">in: Proceedings of the Web Conference 2021, WWW ’21, Association for Computing Machinery, New York, NY, USA, 2021, p. 401–412. doi:<a class="ltx_ref" href="https:/doi.org/10.1145/3442381.3449835" title="">10.1145/3442381.3449835</a>.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib40">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Radlinski et al. [2008]</span>
<span class="ltx_bibblock">
F. Radlinski, R. Kleinberg, T. Joachims,

</span>
<span class="ltx_bibblock">Learning diverse rankings with multi-armed bandits,

</span>
<span class="ltx_bibblock">in: Proceedings of the 25th International Conference on Machine Learning, ICML ’08, Association for Computing Machinery, New York, NY, USA, 2008, p. 784–791. doi:<a class="ltx_ref" href="https:/doi.org/10.1145/1390156.1390255" title="">10.1145/1390156.1390255</a>.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib41">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Zhu et al. [2014]</span>
<span class="ltx_bibblock">
Y. Zhu, Y. Lan, J. Guo, X. Cheng, S. Niu,

</span>
<span class="ltx_bibblock">Learning for search result diversification,

</span>
<span class="ltx_bibblock">in: Proceedings of the 37th International ACM SIGIR Conference on Research &amp; Development in Information Retrieval, SIGIR ’14, Association for Computing Machinery, New York, NY, USA, 2014, p. 293–302. doi:<a class="ltx_ref" href="https:/doi.org/10.1145/2600428.2609634" title="">10.1145/2600428.2609634</a>.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib42">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Desautels et al. [2014]</span>
<span class="ltx_bibblock">
T. Desautels, A. Krause, J. W. Burdick,

</span>
<span class="ltx_bibblock">Parallelizing exploration-exploitation tradeoffs in gaussian process bandit optimization,

</span>
<span class="ltx_bibblock">Journal of Machine Learning Research 15 (2014) 4053–4103. URL: <a class="ltx_ref ltx_url ltx_font_typewriter" href="http://jmlr.org/papers/v15/desautels14a.html" title="">http://jmlr.org/papers/v15/desautels14a.html</a>.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib43">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Contal et al. [2013]</span>
<span class="ltx_bibblock">
E. Contal, D. Buffoni, A. Robicquet, N. Vayatis,

</span>
<span class="ltx_bibblock">Parallel gaussian process optimization with upper confidence bound and pure exploration,

</span>
<span class="ltx_bibblock">in: H. Blockeel, K. Kersting, S. Nijssen, F. Železný (Eds.), Machine Learning and Knowledge Discovery in Databases, Springer Berlin Heidelberg, Berlin, Heidelberg, 2013, pp. 225–240.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib44">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Ntoulas et al. [2006]</span>
<span class="ltx_bibblock">
A. Ntoulas, M. Najork, M. Manasse, D. Fetterly,

</span>
<span class="ltx_bibblock">Detecting spam web pages through content analysis,

</span>
<span class="ltx_bibblock">in: Proceedings of the 15th International Conference on World Wide Web, WWW ’06, Association for Computing Machinery, New York, NY, USA, 2006, p. 83–92. doi:<a class="ltx_ref" href="https:/doi.org/10.1145/1135777.1135794" title="">10.1145/1135777.1135794</a>.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib45">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Cormack et al. [2011]</span>
<span class="ltx_bibblock">
G. V. Cormack, M. D. Smucker, C. L. A. Clarke,

</span>
<span class="ltx_bibblock">Efficient and effective spam filtering and re-ranking for large web datasets,

</span>
<span class="ltx_bibblock">Inf. Retr. 14 (2011) 441–465. doi:<a class="ltx_ref" href="https:/doi.org/10.1007/s10791-011-9162-z" title="">10.1007/s10791-011-9162-z</a>.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib46">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Bendersky et al. [2011]</span>
<span class="ltx_bibblock">
M. Bendersky, W. B. Croft, Y. Diao,

</span>
<span class="ltx_bibblock">Quality-biased ranking of web documents,

</span>
<span class="ltx_bibblock">in: Proceedings of the Fourth ACM International Conference on Web Search and Data Mining, WSDM ’11, Association for Computing Machinery, New York, NY, USA, 2011, p. 95–104. doi:<a class="ltx_ref" href="https:/doi.org/10.1145/1935826.1935849" title="">10.1145/1935826.1935849</a>.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib47">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Brin and Page [1998]</span>
<span class="ltx_bibblock">
S. Brin, L. Page,

</span>
<span class="ltx_bibblock">The anatomy of a large-scale hypertextual web search engine,

</span>
<span class="ltx_bibblock">Computer Networks and ISDN Systems 30 (1998) 107–117. URL: <a class="ltx_ref ltx_url ltx_font_typewriter" href="https://www.sciencedirect.com/science/article/pii/S016975529800110X" title="">https://www.sciencedirect.com/science/article/pii/S016975529800110X</a>, proceedings of the Seventh International World Wide Web Conference.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib48">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Lin et al. [2021]</span>
<span class="ltx_bibblock">
S. C. Lin, J. Hilton, O. Evans,

</span>
<span class="ltx_bibblock">Truthfulqa: Measuring how models mimic human falsehoods,

</span>
<span class="ltx_bibblock">in: Annual Meeting of the Association for Computational Linguistics, 2021. URL: <a class="ltx_ref ltx_url ltx_font_typewriter" href="https://api.semanticscholar.org/CorpusID:237532606" title="">https://api.semanticscholar.org/CorpusID:237532606</a>.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib49">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Rafailov et al. [2023]</span>
<span class="ltx_bibblock">
R. Rafailov, A. Sharma, E. Mitchell, C. D. Manning, S. Ermon, C. Finn,

</span>
<span class="ltx_bibblock">Direct preference optimization: Your language model is secretly a reward model,

</span>
<span class="ltx_bibblock">in: A. Oh, T. Neumann, A. Globerson, K. Saenko, M. Hardt, S. Levine (Eds.), Advances in Neural Information Processing Systems, volume 36, Curran Associates, Inc., 2023, pp. 53728–53741. URL: <a class="ltx_ref ltx_url ltx_font_typewriter" href="https://proceedings.neurips.cc/paper_files/paper/2023/file/a85b405ed65c6477a4fe8302b5e06ce7-Paper-Conference.pdf" title="">https://proceedings.neurips.cc/paper_files/paper/2023/file/a85b405ed65c6477a4fe8302b5e06ce7-Paper-Conference.pdf</a>.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib50">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Jiang et al. [2023]</span>
<span class="ltx_bibblock">
A. Q. Jiang, A. Sablayrolles, A. Mensch, C. Bamford, D. Singh Chaplot, D. de las Casas, F. Bressand, G. Lengyel, G. Lample, L. Saulnier, L. Renard Lavaud, M.-A. Lachaux, P. Stock, T. Le Scao, T. Lavril, T. Wang, T. Lacroix, W. El Sayed,

</span>
<span class="ltx_bibblock">Mistral 7B,

</span>
<span class="ltx_bibblock">arXiv e-prints (2023) arXiv:2310.06825. doi:<a class="ltx_ref" href="https:/doi.org/10.48550/arXiv.2310.06825" title="">10.48550/arXiv.2310.06825</a>. <a class="ltx_ref ltx_href ltx_font_typewriter" href="http://arxiv.org/abs/2310.06825" title="">arXiv:2310.06825</a>.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib51">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Liu et al. [2022]</span>
<span class="ltx_bibblock">
H. Liu, D. Tam, M. Muqeeth, J. Mohta, T. Huang, M. Bansal, C. A. Raffel,

</span>
<span class="ltx_bibblock">Few-shot parameter-efficient fine-tuning is better and cheaper than in-context learning,

</span>
<span class="ltx_bibblock">in: S. Koyejo, S. Mohamed, A. Agarwal, D. Belgrave, K. Cho, A. Oh (Eds.), Advances in Neural Information Processing Systems, volume 35, Curran Associates, Inc., 2022, pp. 1950–1965. URL: <a class="ltx_ref ltx_url ltx_font_typewriter" href="https://proceedings.neurips.cc/paper_files/paper/2022/file/0cde695b83bd186c1fd456302888454c-Paper-Conference.pdf" title="">https://proceedings.neurips.cc/paper_files/paper/2022/file/0cde695b83bd186c1fd456302888454c-Paper-Conference.pdf</a>.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib52">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Li and Chan [2013]</span>
<span class="ltx_bibblock">
L. Li, C.-Y. Chan,

</span>
<span class="ltx_bibblock">Efficient indexing for diverse query results,

</span>
<span class="ltx_bibblock">Proc. VLDB Endow. 6 (2013) 745–756. doi:<a class="ltx_ref" href="https:/doi.org/10.14778/2536360.2536373" title="">10.14778/2536360.2536373</a>.

</span>
</li>
</ul>
</section>
</article>
</div>
<footer class="ltx_page_footer">
<div class="ltx_page_logo">Generated  on Thu Aug 15 22:28:44 2024 by <a class="ltx_LaTeXML_logo" href="http://dlmf.nist.gov/LaTeXML/"><span style="letter-spacing:-0.2em; margin-right:0.1em;">L<span class="ltx_font_smallcaps" style="position:relative; bottom:2.2pt;">a</span>T<span class="ltx_font_smallcaps" style="font-size:120%;position:relative; bottom:-0.2ex;">e</span></span><span style="font-size:90%; position:relative; bottom:-0.2ex;">XML</span><img alt="Mascot Sammy" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAsAAAAOCAYAAAD5YeaVAAAAAXNSR0IArs4c6QAAAAZiS0dEAP8A/wD/oL2nkwAAAAlwSFlzAAALEwAACxMBAJqcGAAAAAd0SU1FB9wKExQZLWTEaOUAAAAddEVYdENvbW1lbnQAQ3JlYXRlZCB3aXRoIFRoZSBHSU1Q72QlbgAAAdpJREFUKM9tkL+L2nAARz9fPZNCKFapUn8kyI0e4iRHSR1Kb8ng0lJw6FYHFwv2LwhOpcWxTjeUunYqOmqd6hEoRDhtDWdA8ApRYsSUCDHNt5ul13vz4w0vWCgUnnEc975arX6ORqN3VqtVZbfbTQC4uEHANM3jSqXymFI6yWazP2KxWAXAL9zCUa1Wy2tXVxheKA9YNoR8Pt+aTqe4FVVVvz05O6MBhqUIBGk8Hn8HAOVy+T+XLJfLS4ZhTiRJgqIoVBRFIoric47jPnmeB1mW/9rr9ZpSSn3Lsmir1fJZlqWlUonKsvwWwD8ymc/nXwVBeLjf7xEKhdBut9Hr9WgmkyGEkJwsy5eHG5vN5g0AKIoCAEgkEkin0wQAfN9/cXPdheu6P33fBwB4ngcAcByHJpPJl+fn54mD3Gg0NrquXxeLRQAAwzAYj8cwTZPwPH9/sVg8PXweDAauqqr2cDjEer1GJBLBZDJBs9mE4zjwfZ85lAGg2+06hmGgXq+j3+/DsixYlgVN03a9Xu8jgCNCyIegIAgx13Vfd7vdu+FweG8YRkjXdWy329+dTgeSJD3ieZ7RNO0VAXAPwDEAO5VKndi2fWrb9jWl9Esul6PZbDY9Go1OZ7PZ9z/lyuD3OozU2wAAAABJRU5ErkJggg=="/></a>
</div></footer>
</div>
</body>
</html>
