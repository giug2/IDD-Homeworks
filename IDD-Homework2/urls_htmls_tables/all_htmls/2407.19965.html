<!DOCTYPE html>
<html lang="en">
<head>
<meta content="text/html; charset=utf-8" http-equiv="content-type"/>
<title>Simply Trainable Nearest Neighbour Machine Translation with GPU Inference</title>
<!--Generated on Mon Aug 19 08:49:21 2024 by LaTeXML (version 0.8.8) http://dlmf.nist.gov/LaTeXML/.-->
<meta content="width=device-width, initial-scale=1, shrink-to-fit=no" name="viewport"/>
<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet" type="text/css"/>
<link href="/static/browse/0.3.4/css/ar5iv.0.7.9.min.css" rel="stylesheet" type="text/css"/>
<link href="/static/browse/0.3.4/css/ar5iv-fonts.0.7.9.min.css" rel="stylesheet" type="text/css"/>
<link href="/static/browse/0.3.4/css/latexml_styles.css" rel="stylesheet" type="text/css"/>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.3.3/html2canvas.min.js"></script>
<script src="/static/browse/0.3.4/js/addons_new.js"></script>
<script src="/static/browse/0.3.4/js/feedbackOverlay.js"></script>
<base href="/html/2407.19965v2/"/></head>
<body>
<nav class="ltx_page_navbar">
<nav class="ltx_TOC">
<ol class="ltx_toclist">
<li class="ltx_tocentry ltx_tocentry_section"><a class="ltx_ref" href="https://arxiv.org/html/2407.19965v2#S1" title="In Simply Trainable Nearest Neighbour Machine Translation with GPU Inference"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">1 </span>Introduction</span></a></li>
<li class="ltx_tocentry ltx_tocentry_section">
<a class="ltx_ref" href="https://arxiv.org/html/2407.19965v2#S2" title="In Simply Trainable Nearest Neighbour Machine Translation with GPU Inference"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">2 </span>Background: kNN-MT</span></a>
<ol class="ltx_toclist ltx_toclist_section">
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2407.19965v2#S2.SS1" title="In 2 Background: kNN-MT ‣ Simply Trainable Nearest Neighbour Machine Translation with GPU Inference"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">2.1 </span>Vanilla-kNN</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2407.19965v2#S2.SS2" title="In 2 Background: kNN-MT ‣ Simply Trainable Nearest Neighbour Machine Translation with GPU Inference"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">2.2 </span>SK-MT</span></a></li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_section"><a class="ltx_ref" href="https://arxiv.org/html/2407.19965v2#S3" title="In Simply Trainable Nearest Neighbour Machine Translation with GPU Inference"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3 </span>Single-Layer Trainable Interpolation</span></a></li>
<li class="ltx_tocentry ltx_tocentry_section">
<a class="ltx_ref" href="https://arxiv.org/html/2407.19965v2#S4" title="In Simply Trainable Nearest Neighbour Machine Translation with GPU Inference"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">4 </span>Experimental Results</span></a>
<ol class="ltx_toclist ltx_toclist_section">
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2407.19965v2#S4.SS1" title="In 4 Experimental Results ‣ Simply Trainable Nearest Neighbour Machine Translation with GPU Inference"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">4.1 </span>Experimental Setup</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2407.19965v2#S4.SS2" title="In 4 Experimental Results ‣ Simply Trainable Nearest Neighbour Machine Translation with GPU Inference"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">4.2 </span>Trainable <span class="ltx_text ltx_font_italic">k</span>NN Retrieval Results</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2407.19965v2#S4.SS3" title="In 4 Experimental Results ‣ Simply Trainable Nearest Neighbour Machine Translation with GPU Inference"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">4.3 </span>GPU Inference Results</span></a></li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_section"><a class="ltx_ref" href="https://arxiv.org/html/2407.19965v2#S5" title="In Simply Trainable Nearest Neighbour Machine Translation with GPU Inference"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">5 </span>Conclusion</span></a></li>
</ol></nav>
</nav>
<div class="ltx_page_main">
<div class="ltx_page_content">
<article class="ltx_document ltx_authors_1line">
<h1 class="ltx_title ltx_title_document">Simply Trainable Nearest Neighbour Machine Translation with GPU Inference</h1>
<div class="ltx_authors">
<span class="ltx_creator ltx_role_author">
<span class="ltx_personname"><span class="ltx_ERROR undefined" id="id1.1.id1">\name</span><span class="ltx_text ltx_font_bold" id="id2.2.id2">Hossam Amer*</span> <span class="ltx_ERROR undefined" id="id3.3.id3">\addr</span>hossamamer@microsoft.com
<span class="ltx_ERROR undefined" id="id4.4.id4">\AND</span><span class="ltx_ERROR undefined" id="id5.5.id5">\name</span><span class="ltx_text ltx_font_bold" id="id6.6.id6">Abdelrahman Abouelenin*</span> <span class="ltx_ERROR undefined" id="id7.7.id7">\addr</span>ababouelenin@microsoft.com
<span class="ltx_ERROR undefined" id="id8.8.id8">\AND</span><span class="ltx_ERROR undefined" id="id9.9.id9">\name</span><span class="ltx_text ltx_font_bold" id="id10.10.id10">Mohamed Maher</span> <span class="ltx_ERROR undefined" id="id11.11.id11">\addr</span>momaherg@gmail.com
<span class="ltx_ERROR undefined" id="id12.12.id12">\AND</span><span class="ltx_ERROR undefined" id="id13.13.id13">\name</span><span class="ltx_text ltx_font_bold" id="id14.14.id14">Evram Narouz</span> <span class="ltx_ERROR undefined" id="id15.15.id15">\addr</span>evramnarouz@microsoft.com
<span class="ltx_ERROR undefined" id="id16.16.id16">\AND</span><span class="ltx_ERROR undefined" id="id17.17.id17">\name</span><span class="ltx_text ltx_font_bold" id="id18.18.id18">Mohamed Afify</span> <span class="ltx_ERROR undefined" id="id19.19.id19">\addr</span>mafify@microsoft.com
<span class="ltx_ERROR undefined" id="id20.20.id20">\AND</span><span class="ltx_ERROR undefined" id="id21.21.id21">\name</span><span class="ltx_text ltx_font_bold" id="id22.22.id22">Hany Awadallah</span> <span class="ltx_ERROR undefined" id="id23.23.id23">\addr</span>hanyh@microsoft.com
</span></span>
</div>
<div class="ltx_abstract">
<h6 class="ltx_title ltx_title_abstract">Abstract</h6>
<p class="ltx_p" id="id24.id1">Nearest neighbor machine translation is a successful approach for fast domain adaption, which interpolates the pre-trained transformers with domain-specific token-level k-nearest-neighbor (kNN) retrieval without retraining. Despite kNN MT’s success, searching large reference corpus and fixed interpolation between the kNN and pre-trained model led to computational complexity and translation quality challenges. Among other papers, <cite class="ltx_cite ltx_citemacro_cite">Dai et al., (<a class="ltx_ref" href="https://arxiv.org/html/2407.19965v2#bib.bib1" title="">2023</a>)</cite> proposed methods to obtain a small number of reference samples dynamically for which they introduced a distance-aware interpolation method using an equation that includes free parameters. This paper proposes a simply trainable nearest neighbor machine translation and carry out inference experiments on GPU. Similar to <cite class="ltx_cite ltx_citemacro_cite">Dai et al., (<a class="ltx_ref" href="https://arxiv.org/html/2407.19965v2#bib.bib1" title="">2023</a>)</cite>, we first adaptively construct a small datastore for each input sentence. Second, we train a single-layer network for the interpolation coefficient between the knnMT and pre-trained result to automatically interpolate in different domains. Experimental results on different domains show that our proposed method
either improves or sometimes maintain the translation quality of methods in <cite class="ltx_cite ltx_citemacro_cite">Dai et al., (<a class="ltx_ref" href="https://arxiv.org/html/2407.19965v2#bib.bib1" title="">2023</a>)</cite> while being automatic. In addition, our GPU inference results demonstrate that knnMT can be integrated into GPUs with a drop of only 5% in terms of speed.</p>
</div>
<div class="ltx_pagination ltx_role_start_2_columns"></div>
<section class="ltx_section" id="S1">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">1 </span>Introduction</h2>
<div class="ltx_para" id="S1.p1">
<p class="ltx_p" id="S1.p1.1">Neural Machine Translation (NMT) has been showing an increasing trend of translation quality owing to the ongoing development of deep neural network models <cite class="ltx_cite ltx_citemacro_cite">Vaswani et al., (<a class="ltx_ref" href="https://arxiv.org/html/2407.19965v2#bib.bib10" title="">2017</a>); Kim et al., (<a class="ltx_ref" href="https://arxiv.org/html/2407.19965v2#bib.bib5" title="">2021</a>)</cite>. However, the quality of these models is limited as soon as the domain of the input test sentences is different than the training data.
<span class="ltx_note ltx_role_footnote" id="footnote1"><sup class="ltx_note_mark">†</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">†</sup>* equal contribution</span></span></span>
To handle this out-of-domain problem, k-nearest neighbor machine translation (kNN-MT) has proven to be successful in many studies <cite class="ltx_cite ltx_citemacro_cite">Khandelwal et al., (<a class="ltx_ref" href="https://arxiv.org/html/2407.19965v2#bib.bib4" title="">2021</a>); <a class="ltx_ref" href="https://arxiv.org/html/2407.19965v2#bib.bib12" title="">Zheng et al., 021a </a>; <a class="ltx_ref" href="https://arxiv.org/html/2407.19965v2#bib.bib13" title="">Zheng et al., 021b </a>; Jiang et al., (<a class="ltx_ref" href="https://arxiv.org/html/2407.19965v2#bib.bib3" title="">2021</a>); Wang et al., (<a class="ltx_ref" href="https://arxiv.org/html/2407.19965v2#bib.bib11" title="">2022</a>); Meng et al., (<a class="ltx_ref" href="https://arxiv.org/html/2407.19965v2#bib.bib6" title="">2022</a>)</cite>, and thus piqued much attention in the community of machine translation. At the core of kNN-MT, a kNN classifier over an external datastore is built based on cached decoder representations and corresponding target tokens. This classifier is utilized to augment the given NMT model without finetuning leading to improved predictions, especially for domain adaption. Augmenting the NMT model is done via interpolating between the output probability distribution of the NMT model and the kNN classifier output probability distribution.</p>
</div>
<div class="ltx_para" id="S1.p2">
<p class="ltx_p" id="S1.p2.1">Despite kNN-MT’s noticeable success in alleviating the domain adaption problem, vanilla kNN-MT proposed in <cite class="ltx_cite ltx_citemacro_cite">Khandelwal et al., (<a class="ltx_ref" href="https://arxiv.org/html/2407.19965v2#bib.bib4" title="">2021</a>)</cite> mainly suffers two challenges slowing down kNN-MT’s deployment. First, vanilla kNN-MT requires large datastore sizes resulting in massive storage and expensive latency overheads during inference. For example, <cite class="ltx_cite ltx_citemacro_cite">Khandelwal et al., (<a class="ltx_ref" href="https://arxiv.org/html/2407.19965v2#bib.bib4" title="">2021</a>)</cite> showed that kNN-MT is two orders of magnitude slower than the base NMT system in a generation speed when retrieving 64 keys from a datastore containing billions of records. Second, the interpolation between the NMT model and the kNN classifier is fixed for all sentences in the test sets and manually tuned to improve translation quality.</p>
</div>
<div class="ltx_para" id="S1.p3">
<p class="ltx_p" id="S1.p3.1">Techniques in the literature have been proposed to overcome kNN-MT’s challenges. For example, <cite class="ltx_cite ltx_citemacro_cite">Meng et al., (<a class="ltx_ref" href="https://arxiv.org/html/2407.19965v2#bib.bib6" title="">2022</a>)</cite> designed Fast kNN-MT where a subset of the large datastore is created for each source sentence by searching for the nearest token-level neighbors of the source tokens and mapping them to the corresponding target tokens. Building on <cite class="ltx_cite ltx_citemacro_cite">Meng et al., (<a class="ltx_ref" href="https://arxiv.org/html/2407.19965v2#bib.bib6" title="">2022</a>)</cite>, <cite class="ltx_cite ltx_citemacro_cite">Dai et al., (<a class="ltx_ref" href="https://arxiv.org/html/2407.19965v2#bib.bib1" title="">2023</a>)</cite> proposed a simple and scalable kNN-MT that leverages current efficient text retrieval mechanisms, such as BM25 <cite class="ltx_cite ltx_citemacro_cite">Robertson et al., (<a class="ltx_ref" href="https://arxiv.org/html/2407.19965v2#bib.bib9" title="">2009</a>)</cite>, to obtain a small number of reference samples that have high semantic similarities with the input sentence, and then dynamically construct a tiny datastore by forwarding the samples to the pre-trained model. <cite class="ltx_cite ltx_citemacro_cite">Dai et al., (<a class="ltx_ref" href="https://arxiv.org/html/2407.19965v2#bib.bib1" title="">2023</a>)</cite> successfully introduced a simple distance-aware interpolation equation to adaptively incorporate kNN retrieval results into the NMT model. However, this simple equation required manual tuning. Along the same line, <cite class="ltx_cite ltx_citemacro_cite">Jiang et al., (<a class="ltx_ref" href="https://arxiv.org/html/2407.19965v2#bib.bib2" title="">2022</a>)</cite> proposed a trainable interpolation method but with six-layer neural network. To the best of our knowledge, these papers did not integrate kNN-MT into GPU inference to observe the trade-off between accuracy and speed results.</p>
</div>
<div class="ltx_para" id="S1.p4">
<p class="ltx_p" id="S1.p4.1">This paper proposes a simply trainable nearest neighbor machine translation via a single-layer neural network and demonstrates kNN feasibility with GPU inference. Similar to <cite class="ltx_cite ltx_citemacro_cite">Dai et al., (<a class="ltx_ref" href="https://arxiv.org/html/2407.19965v2#bib.bib1" title="">2023</a>)</cite>, we reduce the large datastore size by extracting online a small number of reference samples that have high semantic similarities with the input test sentence using the efficient BM25 retrieval algorithm (<cite class="ltx_cite ltx_citemacro_cite">Robertson et al., (<a class="ltx_ref" href="https://arxiv.org/html/2407.19965v2#bib.bib9" title="">2009</a>)</cite>). Based on these insights, we propose a simply trainable single-layer neural network that adaptively interpolates the NMT and knnMT probability distributions per domain in an average of 40 minutes of a single GPU training time. Last but not least, we integrate kNN-MT into FasterTransformer, a highly optimized NMT GPU inference implementation offered by NVIDIA, and observe its speed and accuracy performance on a sparsely activated large-scale MoE. Experimental results show the translation quality effectiveness of our adaptive and automatic interpolation technique and insignificant speed drop of knnMT on GPU. Contributions of this paper are listed below:</p>
</div>
<div class="ltx_para" id="S1.p5">
<ul class="ltx_itemize" id="S1.I1">
<li class="ltx_item" id="S1.I1.i1" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S1.I1.i1.p1">
<p class="ltx_p" id="S1.I1.i1.p1.1">Propose and develop an adaptive and trainable single-layer neural network for knnMT interpolation that trains in 40 minutes. (Section <a class="ltx_ref" href="https://arxiv.org/html/2407.19965v2#S3" title="3 Single-Layer Trainable Interpolation ‣ Simply Trainable Nearest Neighbour Machine Translation with GPU Inference"><span class="ltx_text ltx_ref_tag">3</span></a>).</p>
</div>
</li>
<li class="ltx_item" id="S1.I1.i2" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S1.I1.i2.p1">
<p class="ltx_p" id="S1.I1.i2.p1.1">Experimental results show that the proposed method improves the results of Sk-MT in some domains while maintaining the result in some other domains (Section <a class="ltx_ref" href="https://arxiv.org/html/2407.19965v2#S4.SS2" title="4.2 Trainable kNN Retrieval Results ‣ 4 Experimental Results ‣ Simply Trainable Nearest Neighbour Machine Translation with GPU Inference"><span class="ltx_text ltx_ref_tag">4.2</span></a>).</p>
</div>
</li>
<li class="ltx_item" id="S1.I1.i3" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S1.I1.i3.p1">
<p class="ltx_p" id="S1.I1.i3.p1.1">Integrate knnMT interpolation with GPU inference and introduce the speed-to-accuracy trade-off results. (Section <a class="ltx_ref" href="https://arxiv.org/html/2407.19965v2#S4.SS3" title="4.3 GPU Inference Results ‣ 4 Experimental Results ‣ Simply Trainable Nearest Neighbour Machine Translation with GPU Inference"><span class="ltx_text ltx_ref_tag">4.3</span></a>).</p>
</div>
</li>
</ul>
</div>
<div class="ltx_para" id="S1.p6">
<p class="ltx_p" id="S1.p6.1">This remainder of this paper is organized as follows: Section <a class="ltx_ref" href="https://arxiv.org/html/2407.19965v2#S2" title="2 Background: kNN-MT ‣ Simply Trainable Nearest Neighbour Machine Translation with GPU Inference"><span class="ltx_text ltx_ref_tag">2</span></a> introduces knnMT and summarizes Sk-MT paving the road to the proposed method in Section <a class="ltx_ref" href="https://arxiv.org/html/2407.19965v2#S3" title="3 Single-Layer Trainable Interpolation ‣ Simply Trainable Nearest Neighbour Machine Translation with GPU Inference"><span class="ltx_text ltx_ref_tag">3</span></a>. Section <a class="ltx_ref" href="https://arxiv.org/html/2407.19965v2#S3" title="3 Single-Layer Trainable Interpolation ‣ Simply Trainable Nearest Neighbour Machine Translation with GPU Inference"><span class="ltx_text ltx_ref_tag">3</span></a> provides the experimental results while finally concluding in Section <a class="ltx_ref" href="https://arxiv.org/html/2407.19965v2#S5" title="5 Conclusion ‣ Simply Trainable Nearest Neighbour Machine Translation with GPU Inference"><span class="ltx_text ltx_ref_tag">5</span></a>.</p>
</div>
</section>
<section class="ltx_section" id="S2">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">2 </span>Background: kNN-MT</h2>
<section class="ltx_subsection" id="S2.SS1">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">2.1 </span>Vanilla-kNN</h3>
<div class="ltx_para" id="S2.SS1.p1">
<p class="ltx_p" id="S2.SS1.p1.1">In vanilla-kNN, a datastore is created to convert a bilingual sentence into a set of key-value pairs. These keys and values are defined in Equation <a class="ltx_ref" href="https://arxiv.org/html/2407.19965v2#S2.E1" title="In 2.1 Vanilla-kNN ‣ 2 Background: kNN-MT ‣ Simply Trainable Nearest Neighbour Machine Translation with GPU Inference"><span class="ltx_text ltx_ref_tag">1</span></a>.</p>
</div>
<div class="ltx_para" id="S2.SS1.p2">
<table class="ltx_equation ltx_eqn_table" id="S2.E1">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="K,V=F(x,y_{&lt;t}),y_{t}" class="ltx_Math" display="block" id="S2.E1.m1.5"><semantics id="S2.E1.m1.5a"><mrow id="S2.E1.m1.5.5.2" xref="S2.E1.m1.5.5.3.cmml"><mrow id="S2.E1.m1.4.4.1.1" xref="S2.E1.m1.4.4.1.1.cmml"><mrow id="S2.E1.m1.4.4.1.1.3.2" xref="S2.E1.m1.4.4.1.1.3.1.cmml"><mi id="S2.E1.m1.2.2" xref="S2.E1.m1.2.2.cmml">K</mi><mo id="S2.E1.m1.4.4.1.1.3.2.1" xref="S2.E1.m1.4.4.1.1.3.1.cmml">,</mo><mi id="S2.E1.m1.3.3" xref="S2.E1.m1.3.3.cmml">V</mi></mrow><mo id="S2.E1.m1.4.4.1.1.2" xref="S2.E1.m1.4.4.1.1.2.cmml">=</mo><mrow id="S2.E1.m1.4.4.1.1.1" xref="S2.E1.m1.4.4.1.1.1.cmml"><mi id="S2.E1.m1.4.4.1.1.1.3" xref="S2.E1.m1.4.4.1.1.1.3.cmml">F</mi><mo id="S2.E1.m1.4.4.1.1.1.2" xref="S2.E1.m1.4.4.1.1.1.2.cmml">⁢</mo><mrow id="S2.E1.m1.4.4.1.1.1.1.1" xref="S2.E1.m1.4.4.1.1.1.1.2.cmml"><mo id="S2.E1.m1.4.4.1.1.1.1.1.2" stretchy="false" xref="S2.E1.m1.4.4.1.1.1.1.2.cmml">(</mo><mi id="S2.E1.m1.1.1" xref="S2.E1.m1.1.1.cmml">x</mi><mo id="S2.E1.m1.4.4.1.1.1.1.1.3" xref="S2.E1.m1.4.4.1.1.1.1.2.cmml">,</mo><msub id="S2.E1.m1.4.4.1.1.1.1.1.1" xref="S2.E1.m1.4.4.1.1.1.1.1.1.cmml"><mi id="S2.E1.m1.4.4.1.1.1.1.1.1.2" xref="S2.E1.m1.4.4.1.1.1.1.1.1.2.cmml">y</mi><mrow id="S2.E1.m1.4.4.1.1.1.1.1.1.3" xref="S2.E1.m1.4.4.1.1.1.1.1.1.3.cmml"><mi id="S2.E1.m1.4.4.1.1.1.1.1.1.3.2" xref="S2.E1.m1.4.4.1.1.1.1.1.1.3.2.cmml"></mi><mo id="S2.E1.m1.4.4.1.1.1.1.1.1.3.1" xref="S2.E1.m1.4.4.1.1.1.1.1.1.3.1.cmml">&lt;</mo><mi id="S2.E1.m1.4.4.1.1.1.1.1.1.3.3" xref="S2.E1.m1.4.4.1.1.1.1.1.1.3.3.cmml">t</mi></mrow></msub><mo id="S2.E1.m1.4.4.1.1.1.1.1.4" stretchy="false" xref="S2.E1.m1.4.4.1.1.1.1.2.cmml">)</mo></mrow></mrow></mrow><mo id="S2.E1.m1.5.5.2.3" xref="S2.E1.m1.5.5.3a.cmml">,</mo><msub id="S2.E1.m1.5.5.2.2" xref="S2.E1.m1.5.5.2.2.cmml"><mi id="S2.E1.m1.5.5.2.2.2" xref="S2.E1.m1.5.5.2.2.2.cmml">y</mi><mi id="S2.E1.m1.5.5.2.2.3" xref="S2.E1.m1.5.5.2.2.3.cmml">t</mi></msub></mrow><annotation-xml encoding="MathML-Content" id="S2.E1.m1.5b"><apply id="S2.E1.m1.5.5.3.cmml" xref="S2.E1.m1.5.5.2"><csymbol cd="ambiguous" id="S2.E1.m1.5.5.3a.cmml" xref="S2.E1.m1.5.5.2.3">formulae-sequence</csymbol><apply id="S2.E1.m1.4.4.1.1.cmml" xref="S2.E1.m1.4.4.1.1"><eq id="S2.E1.m1.4.4.1.1.2.cmml" xref="S2.E1.m1.4.4.1.1.2"></eq><list id="S2.E1.m1.4.4.1.1.3.1.cmml" xref="S2.E1.m1.4.4.1.1.3.2"><ci id="S2.E1.m1.2.2.cmml" xref="S2.E1.m1.2.2">𝐾</ci><ci id="S2.E1.m1.3.3.cmml" xref="S2.E1.m1.3.3">𝑉</ci></list><apply id="S2.E1.m1.4.4.1.1.1.cmml" xref="S2.E1.m1.4.4.1.1.1"><times id="S2.E1.m1.4.4.1.1.1.2.cmml" xref="S2.E1.m1.4.4.1.1.1.2"></times><ci id="S2.E1.m1.4.4.1.1.1.3.cmml" xref="S2.E1.m1.4.4.1.1.1.3">𝐹</ci><interval closure="open" id="S2.E1.m1.4.4.1.1.1.1.2.cmml" xref="S2.E1.m1.4.4.1.1.1.1.1"><ci id="S2.E1.m1.1.1.cmml" xref="S2.E1.m1.1.1">𝑥</ci><apply id="S2.E1.m1.4.4.1.1.1.1.1.1.cmml" xref="S2.E1.m1.4.4.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S2.E1.m1.4.4.1.1.1.1.1.1.1.cmml" xref="S2.E1.m1.4.4.1.1.1.1.1.1">subscript</csymbol><ci id="S2.E1.m1.4.4.1.1.1.1.1.1.2.cmml" xref="S2.E1.m1.4.4.1.1.1.1.1.1.2">𝑦</ci><apply id="S2.E1.m1.4.4.1.1.1.1.1.1.3.cmml" xref="S2.E1.m1.4.4.1.1.1.1.1.1.3"><lt id="S2.E1.m1.4.4.1.1.1.1.1.1.3.1.cmml" xref="S2.E1.m1.4.4.1.1.1.1.1.1.3.1"></lt><csymbol cd="latexml" id="S2.E1.m1.4.4.1.1.1.1.1.1.3.2.cmml" xref="S2.E1.m1.4.4.1.1.1.1.1.1.3.2">absent</csymbol><ci id="S2.E1.m1.4.4.1.1.1.1.1.1.3.3.cmml" xref="S2.E1.m1.4.4.1.1.1.1.1.1.3.3">𝑡</ci></apply></apply></interval></apply></apply><apply id="S2.E1.m1.5.5.2.2.cmml" xref="S2.E1.m1.5.5.2.2"><csymbol cd="ambiguous" id="S2.E1.m1.5.5.2.2.1.cmml" xref="S2.E1.m1.5.5.2.2">subscript</csymbol><ci id="S2.E1.m1.5.5.2.2.2.cmml" xref="S2.E1.m1.5.5.2.2.2">𝑦</ci><ci id="S2.E1.m1.5.5.2.2.3.cmml" xref="S2.E1.m1.5.5.2.2.3">𝑡</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.E1.m1.5c">K,V=F(x,y_{&lt;t}),y_{t}</annotation><annotation encoding="application/x-llamapun" id="S2.E1.m1.5d">italic_K , italic_V = italic_F ( italic_x , italic_y start_POSTSUBSCRIPT &lt; italic_t end_POSTSUBSCRIPT ) , italic_y start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(1)</span></td>
</tr></tbody>
</table>
</div>
<div class="ltx_para" id="S2.SS1.p3">
<p class="ltx_p" id="S2.SS1.p3.6">where (x, y) <math alttext="\in" class="ltx_Math" display="inline" id="S2.SS1.p3.1.m1.1"><semantics id="S2.SS1.p3.1.m1.1a"><mo id="S2.SS1.p3.1.m1.1.1" xref="S2.SS1.p3.1.m1.1.1.cmml">∈</mo><annotation-xml encoding="MathML-Content" id="S2.SS1.p3.1.m1.1b"><in id="S2.SS1.p3.1.m1.1.1.cmml" xref="S2.SS1.p3.1.m1.1.1"></in></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p3.1.m1.1c">\in</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.p3.1.m1.1d">∈</annotation></semantics></math> (X, Y) define the reference corpus for which the pretrained NMT model generates the context representation <math alttext="F(x,y_{&lt;t}" class="ltx_math_unparsed" display="inline" id="S2.SS1.p3.2.m2.1"><semantics id="S2.SS1.p3.2.m2.1a"><mrow id="S2.SS1.p3.2.m2.1b"><mi id="S2.SS1.p3.2.m2.1.2">F</mi><mrow id="S2.SS1.p3.2.m2.1.3"><mo id="S2.SS1.p3.2.m2.1.3.1" stretchy="false">(</mo><mi id="S2.SS1.p3.2.m2.1.1">x</mi><mo id="S2.SS1.p3.2.m2.1.3.2">,</mo><msub id="S2.SS1.p3.2.m2.1.3.3"><mi id="S2.SS1.p3.2.m2.1.3.3.2">y</mi><mrow id="S2.SS1.p3.2.m2.1.3.3.3"><mi id="S2.SS1.p3.2.m2.1.3.3.3.2"></mi><mo id="S2.SS1.p3.2.m2.1.3.3.3.1">&lt;</mo><mi id="S2.SS1.p3.2.m2.1.3.3.3.3">t</mi></mrow></msub></mrow></mrow><annotation encoding="application/x-tex" id="S2.SS1.p3.2.m2.1c">F(x,y_{&lt;t}</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.p3.2.m2.1d">italic_F ( italic_x , italic_y start_POSTSUBSCRIPT &lt; italic_t end_POSTSUBSCRIPT</annotation></semantics></math> at each time step <math alttext="t" class="ltx_Math" display="inline" id="S2.SS1.p3.3.m3.1"><semantics id="S2.SS1.p3.3.m3.1a"><mi id="S2.SS1.p3.3.m3.1.1" xref="S2.SS1.p3.3.m3.1.1.cmml">t</mi><annotation-xml encoding="MathML-Content" id="S2.SS1.p3.3.m3.1b"><ci id="S2.SS1.p3.3.m3.1.1.cmml" xref="S2.SS1.p3.3.m3.1.1">𝑡</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p3.3.m3.1c">t</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.p3.3.m3.1d">italic_t</annotation></semantics></math>. Then we collect the output
hidden state <math alttext="F(x,y_{&lt;t})" class="ltx_Math" display="inline" id="S2.SS1.p3.4.m4.2"><semantics id="S2.SS1.p3.4.m4.2a"><mrow id="S2.SS1.p3.4.m4.2.2" xref="S2.SS1.p3.4.m4.2.2.cmml"><mi id="S2.SS1.p3.4.m4.2.2.3" xref="S2.SS1.p3.4.m4.2.2.3.cmml">F</mi><mo id="S2.SS1.p3.4.m4.2.2.2" xref="S2.SS1.p3.4.m4.2.2.2.cmml">⁢</mo><mrow id="S2.SS1.p3.4.m4.2.2.1.1" xref="S2.SS1.p3.4.m4.2.2.1.2.cmml"><mo id="S2.SS1.p3.4.m4.2.2.1.1.2" stretchy="false" xref="S2.SS1.p3.4.m4.2.2.1.2.cmml">(</mo><mi id="S2.SS1.p3.4.m4.1.1" xref="S2.SS1.p3.4.m4.1.1.cmml">x</mi><mo id="S2.SS1.p3.4.m4.2.2.1.1.3" xref="S2.SS1.p3.4.m4.2.2.1.2.cmml">,</mo><msub id="S2.SS1.p3.4.m4.2.2.1.1.1" xref="S2.SS1.p3.4.m4.2.2.1.1.1.cmml"><mi id="S2.SS1.p3.4.m4.2.2.1.1.1.2" xref="S2.SS1.p3.4.m4.2.2.1.1.1.2.cmml">y</mi><mrow id="S2.SS1.p3.4.m4.2.2.1.1.1.3" xref="S2.SS1.p3.4.m4.2.2.1.1.1.3.cmml"><mi id="S2.SS1.p3.4.m4.2.2.1.1.1.3.2" xref="S2.SS1.p3.4.m4.2.2.1.1.1.3.2.cmml"></mi><mo id="S2.SS1.p3.4.m4.2.2.1.1.1.3.1" xref="S2.SS1.p3.4.m4.2.2.1.1.1.3.1.cmml">&lt;</mo><mi id="S2.SS1.p3.4.m4.2.2.1.1.1.3.3" xref="S2.SS1.p3.4.m4.2.2.1.1.1.3.3.cmml">t</mi></mrow></msub><mo id="S2.SS1.p3.4.m4.2.2.1.1.4" stretchy="false" xref="S2.SS1.p3.4.m4.2.2.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.SS1.p3.4.m4.2b"><apply id="S2.SS1.p3.4.m4.2.2.cmml" xref="S2.SS1.p3.4.m4.2.2"><times id="S2.SS1.p3.4.m4.2.2.2.cmml" xref="S2.SS1.p3.4.m4.2.2.2"></times><ci id="S2.SS1.p3.4.m4.2.2.3.cmml" xref="S2.SS1.p3.4.m4.2.2.3">𝐹</ci><interval closure="open" id="S2.SS1.p3.4.m4.2.2.1.2.cmml" xref="S2.SS1.p3.4.m4.2.2.1.1"><ci id="S2.SS1.p3.4.m4.1.1.cmml" xref="S2.SS1.p3.4.m4.1.1">𝑥</ci><apply id="S2.SS1.p3.4.m4.2.2.1.1.1.cmml" xref="S2.SS1.p3.4.m4.2.2.1.1.1"><csymbol cd="ambiguous" id="S2.SS1.p3.4.m4.2.2.1.1.1.1.cmml" xref="S2.SS1.p3.4.m4.2.2.1.1.1">subscript</csymbol><ci id="S2.SS1.p3.4.m4.2.2.1.1.1.2.cmml" xref="S2.SS1.p3.4.m4.2.2.1.1.1.2">𝑦</ci><apply id="S2.SS1.p3.4.m4.2.2.1.1.1.3.cmml" xref="S2.SS1.p3.4.m4.2.2.1.1.1.3"><lt id="S2.SS1.p3.4.m4.2.2.1.1.1.3.1.cmml" xref="S2.SS1.p3.4.m4.2.2.1.1.1.3.1"></lt><csymbol cd="latexml" id="S2.SS1.p3.4.m4.2.2.1.1.1.3.2.cmml" xref="S2.SS1.p3.4.m4.2.2.1.1.1.3.2">absent</csymbol><ci id="S2.SS1.p3.4.m4.2.2.1.1.1.3.3.cmml" xref="S2.SS1.p3.4.m4.2.2.1.1.1.3.3">𝑡</ci></apply></apply></interval></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p3.4.m4.2c">F(x,y_{&lt;t})</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.p3.4.m4.2d">italic_F ( italic_x , italic_y start_POSTSUBSCRIPT &lt; italic_t end_POSTSUBSCRIPT )</annotation></semantics></math> as key and <math alttext="y_{t}" class="ltx_Math" display="inline" id="S2.SS1.p3.5.m5.1"><semantics id="S2.SS1.p3.5.m5.1a"><msub id="S2.SS1.p3.5.m5.1.1" xref="S2.SS1.p3.5.m5.1.1.cmml"><mi id="S2.SS1.p3.5.m5.1.1.2" xref="S2.SS1.p3.5.m5.1.1.2.cmml">y</mi><mi id="S2.SS1.p3.5.m5.1.1.3" xref="S2.SS1.p3.5.m5.1.1.3.cmml">t</mi></msub><annotation-xml encoding="MathML-Content" id="S2.SS1.p3.5.m5.1b"><apply id="S2.SS1.p3.5.m5.1.1.cmml" xref="S2.SS1.p3.5.m5.1.1"><csymbol cd="ambiguous" id="S2.SS1.p3.5.m5.1.1.1.cmml" xref="S2.SS1.p3.5.m5.1.1">subscript</csymbol><ci id="S2.SS1.p3.5.m5.1.1.2.cmml" xref="S2.SS1.p3.5.m5.1.1.2">𝑦</ci><ci id="S2.SS1.p3.5.m5.1.1.3.cmml" xref="S2.SS1.p3.5.m5.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p3.5.m5.1c">y_{t}</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.p3.5.m5.1d">italic_y start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT</annotation></semantics></math> as value to construct the whole datastore <math alttext="(K,V)" class="ltx_Math" display="inline" id="S2.SS1.p3.6.m6.2"><semantics id="S2.SS1.p3.6.m6.2a"><mrow id="S2.SS1.p3.6.m6.2.3.2" xref="S2.SS1.p3.6.m6.2.3.1.cmml"><mo id="S2.SS1.p3.6.m6.2.3.2.1" stretchy="false" xref="S2.SS1.p3.6.m6.2.3.1.cmml">(</mo><mi id="S2.SS1.p3.6.m6.1.1" xref="S2.SS1.p3.6.m6.1.1.cmml">K</mi><mo id="S2.SS1.p3.6.m6.2.3.2.2" xref="S2.SS1.p3.6.m6.2.3.1.cmml">,</mo><mi id="S2.SS1.p3.6.m6.2.2" xref="S2.SS1.p3.6.m6.2.2.cmml">V</mi><mo id="S2.SS1.p3.6.m6.2.3.2.3" stretchy="false" xref="S2.SS1.p3.6.m6.2.3.1.cmml">)</mo></mrow><annotation-xml encoding="MathML-Content" id="S2.SS1.p3.6.m6.2b"><interval closure="open" id="S2.SS1.p3.6.m6.2.3.1.cmml" xref="S2.SS1.p3.6.m6.2.3.2"><ci id="S2.SS1.p3.6.m6.1.1.cmml" xref="S2.SS1.p3.6.m6.1.1">𝐾</ci><ci id="S2.SS1.p3.6.m6.2.2.cmml" xref="S2.SS1.p3.6.m6.2.2">𝑉</ci></interval></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p3.6.m6.2c">(K,V)</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.p3.6.m6.2d">( italic_K , italic_V )</annotation></semantics></math>.</p>
</div>
<div class="ltx_para" id="S2.SS1.p4">
<p class="ltx_p" id="S2.SS1.p4.3">At inference time, the current context representation <math alttext="F(x,\hat{y}_{&lt;t})" class="ltx_Math" display="inline" id="S2.SS1.p4.1.m1.2"><semantics id="S2.SS1.p4.1.m1.2a"><mrow id="S2.SS1.p4.1.m1.2.2" xref="S2.SS1.p4.1.m1.2.2.cmml"><mi id="S2.SS1.p4.1.m1.2.2.3" xref="S2.SS1.p4.1.m1.2.2.3.cmml">F</mi><mo id="S2.SS1.p4.1.m1.2.2.2" xref="S2.SS1.p4.1.m1.2.2.2.cmml">⁢</mo><mrow id="S2.SS1.p4.1.m1.2.2.1.1" xref="S2.SS1.p4.1.m1.2.2.1.2.cmml"><mo id="S2.SS1.p4.1.m1.2.2.1.1.2" stretchy="false" xref="S2.SS1.p4.1.m1.2.2.1.2.cmml">(</mo><mi id="S2.SS1.p4.1.m1.1.1" xref="S2.SS1.p4.1.m1.1.1.cmml">x</mi><mo id="S2.SS1.p4.1.m1.2.2.1.1.3" xref="S2.SS1.p4.1.m1.2.2.1.2.cmml">,</mo><msub id="S2.SS1.p4.1.m1.2.2.1.1.1" xref="S2.SS1.p4.1.m1.2.2.1.1.1.cmml"><mover accent="true" id="S2.SS1.p4.1.m1.2.2.1.1.1.2" xref="S2.SS1.p4.1.m1.2.2.1.1.1.2.cmml"><mi id="S2.SS1.p4.1.m1.2.2.1.1.1.2.2" xref="S2.SS1.p4.1.m1.2.2.1.1.1.2.2.cmml">y</mi><mo id="S2.SS1.p4.1.m1.2.2.1.1.1.2.1" xref="S2.SS1.p4.1.m1.2.2.1.1.1.2.1.cmml">^</mo></mover><mrow id="S2.SS1.p4.1.m1.2.2.1.1.1.3" xref="S2.SS1.p4.1.m1.2.2.1.1.1.3.cmml"><mi id="S2.SS1.p4.1.m1.2.2.1.1.1.3.2" xref="S2.SS1.p4.1.m1.2.2.1.1.1.3.2.cmml"></mi><mo id="S2.SS1.p4.1.m1.2.2.1.1.1.3.1" xref="S2.SS1.p4.1.m1.2.2.1.1.1.3.1.cmml">&lt;</mo><mi id="S2.SS1.p4.1.m1.2.2.1.1.1.3.3" xref="S2.SS1.p4.1.m1.2.2.1.1.1.3.3.cmml">t</mi></mrow></msub><mo id="S2.SS1.p4.1.m1.2.2.1.1.4" stretchy="false" xref="S2.SS1.p4.1.m1.2.2.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.SS1.p4.1.m1.2b"><apply id="S2.SS1.p4.1.m1.2.2.cmml" xref="S2.SS1.p4.1.m1.2.2"><times id="S2.SS1.p4.1.m1.2.2.2.cmml" xref="S2.SS1.p4.1.m1.2.2.2"></times><ci id="S2.SS1.p4.1.m1.2.2.3.cmml" xref="S2.SS1.p4.1.m1.2.2.3">𝐹</ci><interval closure="open" id="S2.SS1.p4.1.m1.2.2.1.2.cmml" xref="S2.SS1.p4.1.m1.2.2.1.1"><ci id="S2.SS1.p4.1.m1.1.1.cmml" xref="S2.SS1.p4.1.m1.1.1">𝑥</ci><apply id="S2.SS1.p4.1.m1.2.2.1.1.1.cmml" xref="S2.SS1.p4.1.m1.2.2.1.1.1"><csymbol cd="ambiguous" id="S2.SS1.p4.1.m1.2.2.1.1.1.1.cmml" xref="S2.SS1.p4.1.m1.2.2.1.1.1">subscript</csymbol><apply id="S2.SS1.p4.1.m1.2.2.1.1.1.2.cmml" xref="S2.SS1.p4.1.m1.2.2.1.1.1.2"><ci id="S2.SS1.p4.1.m1.2.2.1.1.1.2.1.cmml" xref="S2.SS1.p4.1.m1.2.2.1.1.1.2.1">^</ci><ci id="S2.SS1.p4.1.m1.2.2.1.1.1.2.2.cmml" xref="S2.SS1.p4.1.m1.2.2.1.1.1.2.2">𝑦</ci></apply><apply id="S2.SS1.p4.1.m1.2.2.1.1.1.3.cmml" xref="S2.SS1.p4.1.m1.2.2.1.1.1.3"><lt id="S2.SS1.p4.1.m1.2.2.1.1.1.3.1.cmml" xref="S2.SS1.p4.1.m1.2.2.1.1.1.3.1"></lt><csymbol cd="latexml" id="S2.SS1.p4.1.m1.2.2.1.1.1.3.2.cmml" xref="S2.SS1.p4.1.m1.2.2.1.1.1.3.2">absent</csymbol><ci id="S2.SS1.p4.1.m1.2.2.1.1.1.3.3.cmml" xref="S2.SS1.p4.1.m1.2.2.1.1.1.3.3">𝑡</ci></apply></apply></interval></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p4.1.m1.2c">F(x,\hat{y}_{&lt;t})</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.p4.1.m1.2d">italic_F ( italic_x , over^ start_ARG italic_y end_ARG start_POSTSUBSCRIPT &lt; italic_t end_POSTSUBSCRIPT )</annotation></semantics></math> at decoding step <math alttext="t" class="ltx_Math" display="inline" id="S2.SS1.p4.2.m2.1"><semantics id="S2.SS1.p4.2.m2.1a"><mi id="S2.SS1.p4.2.m2.1.1" xref="S2.SS1.p4.2.m2.1.1.cmml">t</mi><annotation-xml encoding="MathML-Content" id="S2.SS1.p4.2.m2.1b"><ci id="S2.SS1.p4.2.m2.1.1.cmml" xref="S2.SS1.p4.2.m2.1.1">𝑡</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p4.2.m2.1c">t</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.p4.2.m2.1d">italic_t</annotation></semantics></math>, as well as the already generated words, are leveraged to generate a retrieval distribution <math alttext="P_{knn}(y_{t}|y_{&lt;t},x)" class="ltx_Math" display="inline" id="S2.SS1.p4.3.m3.2"><semantics id="S2.SS1.p4.3.m3.2a"><mrow id="S2.SS1.p4.3.m3.2.2" xref="S2.SS1.p4.3.m3.2.2.cmml"><msub id="S2.SS1.p4.3.m3.2.2.3" xref="S2.SS1.p4.3.m3.2.2.3.cmml"><mi id="S2.SS1.p4.3.m3.2.2.3.2" xref="S2.SS1.p4.3.m3.2.2.3.2.cmml">P</mi><mrow id="S2.SS1.p4.3.m3.2.2.3.3" xref="S2.SS1.p4.3.m3.2.2.3.3.cmml"><mi id="S2.SS1.p4.3.m3.2.2.3.3.2" xref="S2.SS1.p4.3.m3.2.2.3.3.2.cmml">k</mi><mo id="S2.SS1.p4.3.m3.2.2.3.3.1" xref="S2.SS1.p4.3.m3.2.2.3.3.1.cmml">⁢</mo><mi id="S2.SS1.p4.3.m3.2.2.3.3.3" xref="S2.SS1.p4.3.m3.2.2.3.3.3.cmml">n</mi><mo id="S2.SS1.p4.3.m3.2.2.3.3.1a" xref="S2.SS1.p4.3.m3.2.2.3.3.1.cmml">⁢</mo><mi id="S2.SS1.p4.3.m3.2.2.3.3.4" xref="S2.SS1.p4.3.m3.2.2.3.3.4.cmml">n</mi></mrow></msub><mo id="S2.SS1.p4.3.m3.2.2.2" xref="S2.SS1.p4.3.m3.2.2.2.cmml">⁢</mo><mrow id="S2.SS1.p4.3.m3.2.2.1.1" xref="S2.SS1.p4.3.m3.2.2.1.1.1.cmml"><mo id="S2.SS1.p4.3.m3.2.2.1.1.2" stretchy="false" xref="S2.SS1.p4.3.m3.2.2.1.1.1.cmml">(</mo><mrow id="S2.SS1.p4.3.m3.2.2.1.1.1" xref="S2.SS1.p4.3.m3.2.2.1.1.1.cmml"><msub id="S2.SS1.p4.3.m3.2.2.1.1.1.3" xref="S2.SS1.p4.3.m3.2.2.1.1.1.3.cmml"><mi id="S2.SS1.p4.3.m3.2.2.1.1.1.3.2" xref="S2.SS1.p4.3.m3.2.2.1.1.1.3.2.cmml">y</mi><mi id="S2.SS1.p4.3.m3.2.2.1.1.1.3.3" xref="S2.SS1.p4.3.m3.2.2.1.1.1.3.3.cmml">t</mi></msub><mo fence="false" id="S2.SS1.p4.3.m3.2.2.1.1.1.2" xref="S2.SS1.p4.3.m3.2.2.1.1.1.2.cmml">|</mo><mrow id="S2.SS1.p4.3.m3.2.2.1.1.1.1.1" xref="S2.SS1.p4.3.m3.2.2.1.1.1.1.2.cmml"><msub id="S2.SS1.p4.3.m3.2.2.1.1.1.1.1.1" xref="S2.SS1.p4.3.m3.2.2.1.1.1.1.1.1.cmml"><mi id="S2.SS1.p4.3.m3.2.2.1.1.1.1.1.1.2" xref="S2.SS1.p4.3.m3.2.2.1.1.1.1.1.1.2.cmml">y</mi><mrow id="S2.SS1.p4.3.m3.2.2.1.1.1.1.1.1.3" xref="S2.SS1.p4.3.m3.2.2.1.1.1.1.1.1.3.cmml"><mi id="S2.SS1.p4.3.m3.2.2.1.1.1.1.1.1.3.2" xref="S2.SS1.p4.3.m3.2.2.1.1.1.1.1.1.3.2.cmml"></mi><mo id="S2.SS1.p4.3.m3.2.2.1.1.1.1.1.1.3.1" xref="S2.SS1.p4.3.m3.2.2.1.1.1.1.1.1.3.1.cmml">&lt;</mo><mi id="S2.SS1.p4.3.m3.2.2.1.1.1.1.1.1.3.3" xref="S2.SS1.p4.3.m3.2.2.1.1.1.1.1.1.3.3.cmml">t</mi></mrow></msub><mo id="S2.SS1.p4.3.m3.2.2.1.1.1.1.1.2" xref="S2.SS1.p4.3.m3.2.2.1.1.1.1.2.cmml">,</mo><mi id="S2.SS1.p4.3.m3.1.1" xref="S2.SS1.p4.3.m3.1.1.cmml">x</mi></mrow></mrow><mo id="S2.SS1.p4.3.m3.2.2.1.1.3" stretchy="false" xref="S2.SS1.p4.3.m3.2.2.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.SS1.p4.3.m3.2b"><apply id="S2.SS1.p4.3.m3.2.2.cmml" xref="S2.SS1.p4.3.m3.2.2"><times id="S2.SS1.p4.3.m3.2.2.2.cmml" xref="S2.SS1.p4.3.m3.2.2.2"></times><apply id="S2.SS1.p4.3.m3.2.2.3.cmml" xref="S2.SS1.p4.3.m3.2.2.3"><csymbol cd="ambiguous" id="S2.SS1.p4.3.m3.2.2.3.1.cmml" xref="S2.SS1.p4.3.m3.2.2.3">subscript</csymbol><ci id="S2.SS1.p4.3.m3.2.2.3.2.cmml" xref="S2.SS1.p4.3.m3.2.2.3.2">𝑃</ci><apply id="S2.SS1.p4.3.m3.2.2.3.3.cmml" xref="S2.SS1.p4.3.m3.2.2.3.3"><times id="S2.SS1.p4.3.m3.2.2.3.3.1.cmml" xref="S2.SS1.p4.3.m3.2.2.3.3.1"></times><ci id="S2.SS1.p4.3.m3.2.2.3.3.2.cmml" xref="S2.SS1.p4.3.m3.2.2.3.3.2">𝑘</ci><ci id="S2.SS1.p4.3.m3.2.2.3.3.3.cmml" xref="S2.SS1.p4.3.m3.2.2.3.3.3">𝑛</ci><ci id="S2.SS1.p4.3.m3.2.2.3.3.4.cmml" xref="S2.SS1.p4.3.m3.2.2.3.3.4">𝑛</ci></apply></apply><apply id="S2.SS1.p4.3.m3.2.2.1.1.1.cmml" xref="S2.SS1.p4.3.m3.2.2.1.1"><csymbol cd="latexml" id="S2.SS1.p4.3.m3.2.2.1.1.1.2.cmml" xref="S2.SS1.p4.3.m3.2.2.1.1.1.2">conditional</csymbol><apply id="S2.SS1.p4.3.m3.2.2.1.1.1.3.cmml" xref="S2.SS1.p4.3.m3.2.2.1.1.1.3"><csymbol cd="ambiguous" id="S2.SS1.p4.3.m3.2.2.1.1.1.3.1.cmml" xref="S2.SS1.p4.3.m3.2.2.1.1.1.3">subscript</csymbol><ci id="S2.SS1.p4.3.m3.2.2.1.1.1.3.2.cmml" xref="S2.SS1.p4.3.m3.2.2.1.1.1.3.2">𝑦</ci><ci id="S2.SS1.p4.3.m3.2.2.1.1.1.3.3.cmml" xref="S2.SS1.p4.3.m3.2.2.1.1.1.3.3">𝑡</ci></apply><list id="S2.SS1.p4.3.m3.2.2.1.1.1.1.2.cmml" xref="S2.SS1.p4.3.m3.2.2.1.1.1.1.1"><apply id="S2.SS1.p4.3.m3.2.2.1.1.1.1.1.1.cmml" xref="S2.SS1.p4.3.m3.2.2.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S2.SS1.p4.3.m3.2.2.1.1.1.1.1.1.1.cmml" xref="S2.SS1.p4.3.m3.2.2.1.1.1.1.1.1">subscript</csymbol><ci id="S2.SS1.p4.3.m3.2.2.1.1.1.1.1.1.2.cmml" xref="S2.SS1.p4.3.m3.2.2.1.1.1.1.1.1.2">𝑦</ci><apply id="S2.SS1.p4.3.m3.2.2.1.1.1.1.1.1.3.cmml" xref="S2.SS1.p4.3.m3.2.2.1.1.1.1.1.1.3"><lt id="S2.SS1.p4.3.m3.2.2.1.1.1.1.1.1.3.1.cmml" xref="S2.SS1.p4.3.m3.2.2.1.1.1.1.1.1.3.1"></lt><csymbol cd="latexml" id="S2.SS1.p4.3.m3.2.2.1.1.1.1.1.1.3.2.cmml" xref="S2.SS1.p4.3.m3.2.2.1.1.1.1.1.1.3.2">absent</csymbol><ci id="S2.SS1.p4.3.m3.2.2.1.1.1.1.1.1.3.3.cmml" xref="S2.SS1.p4.3.m3.2.2.1.1.1.1.1.1.3.3">𝑡</ci></apply></apply><ci id="S2.SS1.p4.3.m3.1.1.cmml" xref="S2.SS1.p4.3.m3.1.1">𝑥</ci></list></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p4.3.m3.2c">P_{knn}(y_{t}|y_{&lt;t},x)</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.p4.3.m3.2d">italic_P start_POSTSUBSCRIPT italic_k italic_n italic_n end_POSTSUBSCRIPT ( italic_y start_POSTSUBSCRIPT italic_t end_POSTSUBSCRIPT | italic_y start_POSTSUBSCRIPT &lt; italic_t end_POSTSUBSCRIPT , italic_x )</annotation></semantics></math> over the entire vocabulary:</p>
</div>
<div class="ltx_para" id="S2.SS1.p5">
<span class="ltx_ERROR undefined" id="S2.SS1.p5.1">{dmath}</span>
<p class="ltx_p" id="S2.SS1.p5.2">P_knn(y_t—x, ^y_¡t) 
<br class="ltx_break"/>∝∑_(h_i,v_i)∈N_tI_y_t=v_i exp(-L<span class="ltx_text" id="S2.SS1.p5.2.2.2.2.1.1.1" style="font-size:70%;">2</span>(hi,F(x,^y<span class="ltx_text" id="S2.SS1.p5.2.2.2.5.1.1.1" style="font-size:70%;">¡t</span>))T)</p>
</div>
<div class="ltx_para" id="S2.SS1.p6">
<p class="ltx_p" id="S2.SS1.p6.1">where L2 is the Euclidean distance between the current context embedding and the embedding of a token from the data store.
In vanilla KNN-MT, a predefined interpolation weight <math alttext="\lambda" class="ltx_Math" display="inline" id="S2.SS1.p6.1.m1.1"><semantics id="S2.SS1.p6.1.m1.1a"><mi id="S2.SS1.p6.1.m1.1.1" xref="S2.SS1.p6.1.m1.1.1.cmml">λ</mi><annotation-xml encoding="MathML-Content" id="S2.SS1.p6.1.m1.1b"><ci id="S2.SS1.p6.1.m1.1.1.cmml" xref="S2.SS1.p6.1.m1.1.1">𝜆</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p6.1.m1.1c">\lambda</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.p6.1.m1.1d">italic_λ</annotation></semantics></math> is fixed as a hyperparameter. This weight interpolates between the probability distribution computed from KNN and the probability distribution generated from the pretrained NMT model (see Equation <a class="ltx_ref" href="https://arxiv.org/html/2407.19965v2#S2.SS1" title="2.1 Vanilla-kNN ‣ 2 Background: kNN-MT ‣ Simply Trainable Nearest Neighbour Machine Translation with GPU Inference"><span class="ltx_text ltx_ref_tag">2.1</span></a>).</p>
</div>
<div class="ltx_para" id="S2.SS1.p7">
<span class="ltx_ERROR undefined" id="S2.SS1.p7.1">{dmath}</span>
<p class="ltx_p" id="S2.SS1.p7.2">P(y_t—x, ^y_¡t)= <span class="ltx_text ltx_font_italic" id="S2.SS1.p7.2.2">λ</span>*P_mt( y_t—x, ^y_¡t) 
<br class="ltx_break"/>+
(1-<span class="ltx_text ltx_font_italic" id="S2.SS1.p7.2.4">λ</span>)*P_knn(y_t—x, ^y_¡t)</p>
</div>
</section>
<section class="ltx_subsection" id="S2.SS2">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">2.2 </span>SK-MT</h3>
<div class="ltx_para" id="S2.SS2.p1">
<p class="ltx_p" id="S2.SS2.p1.1">In SK-MT <cite class="ltx_cite ltx_citemacro_cite">Dai et al., (<a class="ltx_ref" href="https://arxiv.org/html/2407.19965v2#bib.bib1" title="">2023</a>)</cite>, Elasticsearch is used for semantic retrieval components to create a sentence adaptive datastore instead of a static and extensive datastore used in Vanilla kNN-MT. In specific, Elasticsearch does two main operations: Index &amp; Search; storing parallel sentences in indexes format, and then retrieving 32 sentences per input sentence with the highest relevance score from the training corpus.</p>
</div>
<div class="ltx_para" id="S2.SS2.p2">
<p class="ltx_p" id="S2.SS2.p2.1">Also, SK-MT provided a successful way of setting the interpolation coefficient in Equation <a class="ltx_ref" href="https://arxiv.org/html/2407.19965v2#S2.E2" title="In 2.2 SK-MT ‣ 2 Background: kNN-MT ‣ Simply Trainable Nearest Neighbour Machine Translation with GPU Inference"><span class="ltx_text ltx_ref_tag">2</span></a>.</p>
</div>
<div class="ltx_para" id="S2.SS2.p3">
<table class="ltx_equation ltx_eqn_table" id="S2.E2">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\lambda=Relu(1-\frac{d_{0}}{T})" class="ltx_Math" display="block" id="S2.E2.m1.1"><semantics id="S2.E2.m1.1a"><mrow id="S2.E2.m1.1.1" xref="S2.E2.m1.1.1.cmml"><mi id="S2.E2.m1.1.1.3" xref="S2.E2.m1.1.1.3.cmml">λ</mi><mo id="S2.E2.m1.1.1.2" xref="S2.E2.m1.1.1.2.cmml">=</mo><mrow id="S2.E2.m1.1.1.1" xref="S2.E2.m1.1.1.1.cmml"><mi id="S2.E2.m1.1.1.1.3" xref="S2.E2.m1.1.1.1.3.cmml">R</mi><mo id="S2.E2.m1.1.1.1.2" xref="S2.E2.m1.1.1.1.2.cmml">⁢</mo><mi id="S2.E2.m1.1.1.1.4" xref="S2.E2.m1.1.1.1.4.cmml">e</mi><mo id="S2.E2.m1.1.1.1.2a" xref="S2.E2.m1.1.1.1.2.cmml">⁢</mo><mi id="S2.E2.m1.1.1.1.5" xref="S2.E2.m1.1.1.1.5.cmml">l</mi><mo id="S2.E2.m1.1.1.1.2b" xref="S2.E2.m1.1.1.1.2.cmml">⁢</mo><mi id="S2.E2.m1.1.1.1.6" xref="S2.E2.m1.1.1.1.6.cmml">u</mi><mo id="S2.E2.m1.1.1.1.2c" xref="S2.E2.m1.1.1.1.2.cmml">⁢</mo><mrow id="S2.E2.m1.1.1.1.1.1" xref="S2.E2.m1.1.1.1.1.1.1.cmml"><mo id="S2.E2.m1.1.1.1.1.1.2" stretchy="false" xref="S2.E2.m1.1.1.1.1.1.1.cmml">(</mo><mrow id="S2.E2.m1.1.1.1.1.1.1" xref="S2.E2.m1.1.1.1.1.1.1.cmml"><mn id="S2.E2.m1.1.1.1.1.1.1.2" xref="S2.E2.m1.1.1.1.1.1.1.2.cmml">1</mn><mo id="S2.E2.m1.1.1.1.1.1.1.1" xref="S2.E2.m1.1.1.1.1.1.1.1.cmml">−</mo><mfrac id="S2.E2.m1.1.1.1.1.1.1.3" xref="S2.E2.m1.1.1.1.1.1.1.3.cmml"><msub id="S2.E2.m1.1.1.1.1.1.1.3.2" xref="S2.E2.m1.1.1.1.1.1.1.3.2.cmml"><mi id="S2.E2.m1.1.1.1.1.1.1.3.2.2" xref="S2.E2.m1.1.1.1.1.1.1.3.2.2.cmml">d</mi><mn id="S2.E2.m1.1.1.1.1.1.1.3.2.3" xref="S2.E2.m1.1.1.1.1.1.1.3.2.3.cmml">0</mn></msub><mi id="S2.E2.m1.1.1.1.1.1.1.3.3" xref="S2.E2.m1.1.1.1.1.1.1.3.3.cmml">T</mi></mfrac></mrow><mo id="S2.E2.m1.1.1.1.1.1.3" stretchy="false" xref="S2.E2.m1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.E2.m1.1b"><apply id="S2.E2.m1.1.1.cmml" xref="S2.E2.m1.1.1"><eq id="S2.E2.m1.1.1.2.cmml" xref="S2.E2.m1.1.1.2"></eq><ci id="S2.E2.m1.1.1.3.cmml" xref="S2.E2.m1.1.1.3">𝜆</ci><apply id="S2.E2.m1.1.1.1.cmml" xref="S2.E2.m1.1.1.1"><times id="S2.E2.m1.1.1.1.2.cmml" xref="S2.E2.m1.1.1.1.2"></times><ci id="S2.E2.m1.1.1.1.3.cmml" xref="S2.E2.m1.1.1.1.3">𝑅</ci><ci id="S2.E2.m1.1.1.1.4.cmml" xref="S2.E2.m1.1.1.1.4">𝑒</ci><ci id="S2.E2.m1.1.1.1.5.cmml" xref="S2.E2.m1.1.1.1.5">𝑙</ci><ci id="S2.E2.m1.1.1.1.6.cmml" xref="S2.E2.m1.1.1.1.6">𝑢</ci><apply id="S2.E2.m1.1.1.1.1.1.1.cmml" xref="S2.E2.m1.1.1.1.1.1"><minus id="S2.E2.m1.1.1.1.1.1.1.1.cmml" xref="S2.E2.m1.1.1.1.1.1.1.1"></minus><cn id="S2.E2.m1.1.1.1.1.1.1.2.cmml" type="integer" xref="S2.E2.m1.1.1.1.1.1.1.2">1</cn><apply id="S2.E2.m1.1.1.1.1.1.1.3.cmml" xref="S2.E2.m1.1.1.1.1.1.1.3"><divide id="S2.E2.m1.1.1.1.1.1.1.3.1.cmml" xref="S2.E2.m1.1.1.1.1.1.1.3"></divide><apply id="S2.E2.m1.1.1.1.1.1.1.3.2.cmml" xref="S2.E2.m1.1.1.1.1.1.1.3.2"><csymbol cd="ambiguous" id="S2.E2.m1.1.1.1.1.1.1.3.2.1.cmml" xref="S2.E2.m1.1.1.1.1.1.1.3.2">subscript</csymbol><ci id="S2.E2.m1.1.1.1.1.1.1.3.2.2.cmml" xref="S2.E2.m1.1.1.1.1.1.1.3.2.2">𝑑</ci><cn id="S2.E2.m1.1.1.1.1.1.1.3.2.3.cmml" type="integer" xref="S2.E2.m1.1.1.1.1.1.1.3.2.3">0</cn></apply><ci id="S2.E2.m1.1.1.1.1.1.1.3.3.cmml" xref="S2.E2.m1.1.1.1.1.1.1.3.3">𝑇</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.E2.m1.1c">\lambda=Relu(1-\frac{d_{0}}{T})</annotation><annotation encoding="application/x-llamapun" id="S2.E2.m1.1d">italic_λ = italic_R italic_e italic_l italic_u ( 1 - divide start_ARG italic_d start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT end_ARG start_ARG italic_T end_ARG )</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(2)</span></td>
</tr></tbody>
</table>
</div>
<div class="ltx_para ltx_noindent" id="S2.SS2.p4">
<p class="ltx_p" id="S2.SS2.p4.2">where <math alttext="d_{0}" class="ltx_Math" display="inline" id="S2.SS2.p4.1.m1.1"><semantics id="S2.SS2.p4.1.m1.1a"><msub id="S2.SS2.p4.1.m1.1.1" xref="S2.SS2.p4.1.m1.1.1.cmml"><mi id="S2.SS2.p4.1.m1.1.1.2" xref="S2.SS2.p4.1.m1.1.1.2.cmml">d</mi><mn id="S2.SS2.p4.1.m1.1.1.3" xref="S2.SS2.p4.1.m1.1.1.3.cmml">0</mn></msub><annotation-xml encoding="MathML-Content" id="S2.SS2.p4.1.m1.1b"><apply id="S2.SS2.p4.1.m1.1.1.cmml" xref="S2.SS2.p4.1.m1.1.1"><csymbol cd="ambiguous" id="S2.SS2.p4.1.m1.1.1.1.cmml" xref="S2.SS2.p4.1.m1.1.1">subscript</csymbol><ci id="S2.SS2.p4.1.m1.1.1.2.cmml" xref="S2.SS2.p4.1.m1.1.1.2">𝑑</ci><cn id="S2.SS2.p4.1.m1.1.1.3.cmml" type="integer" xref="S2.SS2.p4.1.m1.1.1.3">0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p4.1.m1.1c">d_{0}</annotation><annotation encoding="application/x-llamapun" id="S2.SS2.p4.1.m1.1d">italic_d start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT</annotation></semantics></math> is the top-1 L2 distance
during the nearest neighbor search, <math alttext="T" class="ltx_Math" display="inline" id="S2.SS2.p4.2.m2.1"><semantics id="S2.SS2.p4.2.m2.1a"><mi id="S2.SS2.p4.2.m2.1.1" xref="S2.SS2.p4.2.m2.1.1.cmml">T</mi><annotation-xml encoding="MathML-Content" id="S2.SS2.p4.2.m2.1b"><ci id="S2.SS2.p4.2.m2.1.1.cmml" xref="S2.SS2.p4.2.m2.1.1">𝑇</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p4.2.m2.1c">T</annotation><annotation encoding="application/x-llamapun" id="S2.SS2.p4.2.m2.1d">italic_T</annotation></semantics></math> is the temperature parameter and is typically fixed.</p>
</div>
</section>
</section>
<section class="ltx_section" id="S3">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">3 </span>Single-Layer Trainable Interpolation</h2>
<div class="ltx_para" id="S3.p1">
<p class="ltx_p" id="S3.p1.5">Even though SK-MT introduced a simple solution that derives the interpolation weight from the distance, a fixed parameter <math alttext="T" class="ltx_Math" display="inline" id="S3.p1.1.m1.1"><semantics id="S3.p1.1.m1.1a"><mi id="S3.p1.1.m1.1.1" xref="S3.p1.1.m1.1.1.cmml">T</mi><annotation-xml encoding="MathML-Content" id="S3.p1.1.m1.1b"><ci id="S3.p1.1.m1.1.1.cmml" xref="S3.p1.1.m1.1.1">𝑇</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.p1.1.m1.1c">T</annotation><annotation encoding="application/x-llamapun" id="S3.p1.1.m1.1d">italic_T</annotation></semantics></math> for all datasets is tuned to produce the best results and <math alttext="T=100" class="ltx_Math" display="inline" id="S3.p1.2.m2.1"><semantics id="S3.p1.2.m2.1a"><mrow id="S3.p1.2.m2.1.1" xref="S3.p1.2.m2.1.1.cmml"><mi id="S3.p1.2.m2.1.1.2" xref="S3.p1.2.m2.1.1.2.cmml">T</mi><mo id="S3.p1.2.m2.1.1.1" xref="S3.p1.2.m2.1.1.1.cmml">=</mo><mn id="S3.p1.2.m2.1.1.3" xref="S3.p1.2.m2.1.1.3.cmml">100</mn></mrow><annotation-xml encoding="MathML-Content" id="S3.p1.2.m2.1b"><apply id="S3.p1.2.m2.1.1.cmml" xref="S3.p1.2.m2.1.1"><eq id="S3.p1.2.m2.1.1.1.cmml" xref="S3.p1.2.m2.1.1.1"></eq><ci id="S3.p1.2.m2.1.1.2.cmml" xref="S3.p1.2.m2.1.1.2">𝑇</ci><cn id="S3.p1.2.m2.1.1.3.cmml" type="integer" xref="S3.p1.2.m2.1.1.3">100</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p1.2.m2.1c">T=100</annotation><annotation encoding="application/x-llamapun" id="S3.p1.2.m2.1d">italic_T = 100</annotation></semantics></math> is recommended. A fixed temperature may not be optimal for all domains and datasets. For example, Table <a class="ltx_ref" href="https://arxiv.org/html/2407.19965v2#S3.T1" title="Table 1 ‣ 3 Single-Layer Trainable Interpolation ‣ Simply Trainable Nearest Neighbour Machine Translation with GPU Inference"><span class="ltx_text ltx_ref_tag">1</span></a> shows the BLEU score from the Koran dataset when varying <math alttext="T" class="ltx_Math" display="inline" id="S3.p1.3.m3.1"><semantics id="S3.p1.3.m3.1a"><mi id="S3.p1.3.m3.1.1" xref="S3.p1.3.m3.1.1.cmml">T</mi><annotation-xml encoding="MathML-Content" id="S3.p1.3.m3.1b"><ci id="S3.p1.3.m3.1.1.cmml" xref="S3.p1.3.m3.1.1">𝑇</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.p1.3.m3.1c">T</annotation><annotation encoding="application/x-llamapun" id="S3.p1.3.m3.1d">italic_T</annotation></semantics></math> from 100 to 500 with a step size of 100. As seen in the table, <math alttext="T=300" class="ltx_Math" display="inline" id="S3.p1.4.m4.1"><semantics id="S3.p1.4.m4.1a"><mrow id="S3.p1.4.m4.1.1" xref="S3.p1.4.m4.1.1.cmml"><mi id="S3.p1.4.m4.1.1.2" xref="S3.p1.4.m4.1.1.2.cmml">T</mi><mo id="S3.p1.4.m4.1.1.1" xref="S3.p1.4.m4.1.1.1.cmml">=</mo><mn id="S3.p1.4.m4.1.1.3" xref="S3.p1.4.m4.1.1.3.cmml">300</mn></mrow><annotation-xml encoding="MathML-Content" id="S3.p1.4.m4.1b"><apply id="S3.p1.4.m4.1.1.cmml" xref="S3.p1.4.m4.1.1"><eq id="S3.p1.4.m4.1.1.1.cmml" xref="S3.p1.4.m4.1.1.1"></eq><ci id="S3.p1.4.m4.1.1.2.cmml" xref="S3.p1.4.m4.1.1.2">𝑇</ci><cn id="S3.p1.4.m4.1.1.3.cmml" type="integer" xref="S3.p1.4.m4.1.1.3">300</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p1.4.m4.1c">T=300</annotation><annotation encoding="application/x-llamapun" id="S3.p1.4.m4.1d">italic_T = 300</annotation></semantics></math> increases the BLEU score providing evidence that the temperature value can vary with the dataset and does not have to be the recommended SK-MT <math alttext="T=100" class="ltx_Math" display="inline" id="S3.p1.5.m5.1"><semantics id="S3.p1.5.m5.1a"><mrow id="S3.p1.5.m5.1.1" xref="S3.p1.5.m5.1.1.cmml"><mi id="S3.p1.5.m5.1.1.2" xref="S3.p1.5.m5.1.1.2.cmml">T</mi><mo id="S3.p1.5.m5.1.1.1" xref="S3.p1.5.m5.1.1.1.cmml">=</mo><mn id="S3.p1.5.m5.1.1.3" xref="S3.p1.5.m5.1.1.3.cmml">100</mn></mrow><annotation-xml encoding="MathML-Content" id="S3.p1.5.m5.1b"><apply id="S3.p1.5.m5.1.1.cmml" xref="S3.p1.5.m5.1.1"><eq id="S3.p1.5.m5.1.1.1.cmml" xref="S3.p1.5.m5.1.1.1"></eq><ci id="S3.p1.5.m5.1.1.2.cmml" xref="S3.p1.5.m5.1.1.2">𝑇</ci><cn id="S3.p1.5.m5.1.1.3.cmml" type="integer" xref="S3.p1.5.m5.1.1.3">100</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p1.5.m5.1c">T=100</annotation><annotation encoding="application/x-llamapun" id="S3.p1.5.m5.1d">italic_T = 100</annotation></semantics></math>. This observation motivates a simple and trainable method to adaptively find the temperature parameter for each dataset.</p>
</div>
<figure class="ltx_table" id="S3.T1">
<table class="ltx_tabular ltx_centering ltx_guessed_headers ltx_align_middle" id="S3.T1.1">
<thead class="ltx_thead">
<tr class="ltx_tr" id="S3.T1.1.1.1">
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_th_row ltx_border_l ltx_border_r ltx_border_t" id="S3.T1.1.1.1.1">Temperature (T)</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_r ltx_border_t" id="S3.T1.1.1.1.2">BLEU</th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr class="ltx_tr" id="S3.T1.1.2.1">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_l ltx_border_r ltx_border_t" id="S3.T1.1.2.1.1">100</th>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S3.T1.1.2.1.2">15.5</td>
</tr>
<tr class="ltx_tr" id="S3.T1.1.3.2">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_l ltx_border_r ltx_border_t" id="S3.T1.1.3.2.1">200</th>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S3.T1.1.3.2.2">15.9</td>
</tr>
<tr class="ltx_tr" id="S3.T1.1.4.3">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_l ltx_border_r ltx_border_t" id="S3.T1.1.4.3.1">300</th>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S3.T1.1.4.3.2">16.1</td>
</tr>
<tr class="ltx_tr" id="S3.T1.1.5.4">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_l ltx_border_r ltx_border_t" id="S3.T1.1.5.4.1">400</th>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S3.T1.1.5.4.2">15.9</td>
</tr>
<tr class="ltx_tr" id="S3.T1.1.6.5">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_b ltx_border_l ltx_border_r ltx_border_t" id="S3.T1.1.6.5.1">500</th>
<td class="ltx_td ltx_align_center ltx_border_b ltx_border_r ltx_border_t" id="S3.T1.1.6.5.2">15.5</td>
</tr>
</tbody>
</table>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table">Table 1: </span>Koran Temperature Variation</figcaption>
</figure>
<div class="ltx_para" id="S3.p2">
<p class="ltx_p" id="S3.p2.1">The proposed simple neural network consists of a single layer trained to predict the interpolation weight given the distance of the retrieved kNN candidates. This is in contrast to other adaptive interpolation methods e.g. <cite class="ltx_cite ltx_citemacro_cite">Jiang et al., (<a class="ltx_ref" href="https://arxiv.org/html/2407.19965v2#bib.bib2" title="">2022</a>)</cite> that use more layers and learnable parameters. We use the development set of each domain to optimize our single-layer network.</p>
</div>
<div class="ltx_para" id="S3.p3">
<p class="ltx_p" id="S3.p3.2">Our training objective is designed to provide better translation quality. Knowing the ground truth token, we can choose the best interpolation weight that produces the best probability distribution that we can get from the interpolation between <math alttext="P_{mt}" class="ltx_Math" display="inline" id="S3.p3.1.m1.1"><semantics id="S3.p3.1.m1.1a"><msub id="S3.p3.1.m1.1.1" xref="S3.p3.1.m1.1.1.cmml"><mi id="S3.p3.1.m1.1.1.2" xref="S3.p3.1.m1.1.1.2.cmml">P</mi><mrow id="S3.p3.1.m1.1.1.3" xref="S3.p3.1.m1.1.1.3.cmml"><mi id="S3.p3.1.m1.1.1.3.2" xref="S3.p3.1.m1.1.1.3.2.cmml">m</mi><mo id="S3.p3.1.m1.1.1.3.1" xref="S3.p3.1.m1.1.1.3.1.cmml">⁢</mo><mi id="S3.p3.1.m1.1.1.3.3" xref="S3.p3.1.m1.1.1.3.3.cmml">t</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S3.p3.1.m1.1b"><apply id="S3.p3.1.m1.1.1.cmml" xref="S3.p3.1.m1.1.1"><csymbol cd="ambiguous" id="S3.p3.1.m1.1.1.1.cmml" xref="S3.p3.1.m1.1.1">subscript</csymbol><ci id="S3.p3.1.m1.1.1.2.cmml" xref="S3.p3.1.m1.1.1.2">𝑃</ci><apply id="S3.p3.1.m1.1.1.3.cmml" xref="S3.p3.1.m1.1.1.3"><times id="S3.p3.1.m1.1.1.3.1.cmml" xref="S3.p3.1.m1.1.1.3.1"></times><ci id="S3.p3.1.m1.1.1.3.2.cmml" xref="S3.p3.1.m1.1.1.3.2">𝑚</ci><ci id="S3.p3.1.m1.1.1.3.3.cmml" xref="S3.p3.1.m1.1.1.3.3">𝑡</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p3.1.m1.1c">P_{mt}</annotation><annotation encoding="application/x-llamapun" id="S3.p3.1.m1.1d">italic_P start_POSTSUBSCRIPT italic_m italic_t end_POSTSUBSCRIPT</annotation></semantics></math> and <math alttext="P_{knn}" class="ltx_Math" display="inline" id="S3.p3.2.m2.1"><semantics id="S3.p3.2.m2.1a"><msub id="S3.p3.2.m2.1.1" xref="S3.p3.2.m2.1.1.cmml"><mi id="S3.p3.2.m2.1.1.2" xref="S3.p3.2.m2.1.1.2.cmml">P</mi><mrow id="S3.p3.2.m2.1.1.3" xref="S3.p3.2.m2.1.1.3.cmml"><mi id="S3.p3.2.m2.1.1.3.2" xref="S3.p3.2.m2.1.1.3.2.cmml">k</mi><mo id="S3.p3.2.m2.1.1.3.1" xref="S3.p3.2.m2.1.1.3.1.cmml">⁢</mo><mi id="S3.p3.2.m2.1.1.3.3" xref="S3.p3.2.m2.1.1.3.3.cmml">n</mi><mo id="S3.p3.2.m2.1.1.3.1a" xref="S3.p3.2.m2.1.1.3.1.cmml">⁢</mo><mi id="S3.p3.2.m2.1.1.3.4" xref="S3.p3.2.m2.1.1.3.4.cmml">n</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S3.p3.2.m2.1b"><apply id="S3.p3.2.m2.1.1.cmml" xref="S3.p3.2.m2.1.1"><csymbol cd="ambiguous" id="S3.p3.2.m2.1.1.1.cmml" xref="S3.p3.2.m2.1.1">subscript</csymbol><ci id="S3.p3.2.m2.1.1.2.cmml" xref="S3.p3.2.m2.1.1.2">𝑃</ci><apply id="S3.p3.2.m2.1.1.3.cmml" xref="S3.p3.2.m2.1.1.3"><times id="S3.p3.2.m2.1.1.3.1.cmml" xref="S3.p3.2.m2.1.1.3.1"></times><ci id="S3.p3.2.m2.1.1.3.2.cmml" xref="S3.p3.2.m2.1.1.3.2">𝑘</ci><ci id="S3.p3.2.m2.1.1.3.3.cmml" xref="S3.p3.2.m2.1.1.3.3">𝑛</ci><ci id="S3.p3.2.m2.1.1.3.4.cmml" xref="S3.p3.2.m2.1.1.3.4">𝑛</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p3.2.m2.1c">P_{knn}</annotation><annotation encoding="application/x-llamapun" id="S3.p3.2.m2.1d">italic_P start_POSTSUBSCRIPT italic_k italic_n italic_n end_POSTSUBSCRIPT</annotation></semantics></math>. Thus, our final objective is to create a sharper final probability distribution toward our ground truth token.</p>
</div>
<figure class="ltx_float ltx_algorithm" id="algorithm1">
<div class="ltx_listing ltx_lst_numbers_left ltx_listing" id="algorithm1.13">
<div class="ltx_listingline" id="algorithm1.1.1">
<span class="ltx_tag ltx_tag_listingline">1</span>
<math alttext="len\leftarrow length(y)" class="ltx_Math" display="inline" id="algorithm1.1.1.m1.1"><semantics id="algorithm1.1.1.m1.1a"><mrow id="algorithm1.1.1.m1.1.2" xref="algorithm1.1.1.m1.1.2.cmml"><mrow id="algorithm1.1.1.m1.1.2.2" xref="algorithm1.1.1.m1.1.2.2.cmml"><mi id="algorithm1.1.1.m1.1.2.2.2" xref="algorithm1.1.1.m1.1.2.2.2.cmml">l</mi><mo id="algorithm1.1.1.m1.1.2.2.1" xref="algorithm1.1.1.m1.1.2.2.1.cmml">⁢</mo><mi id="algorithm1.1.1.m1.1.2.2.3" xref="algorithm1.1.1.m1.1.2.2.3.cmml">e</mi><mo id="algorithm1.1.1.m1.1.2.2.1a" xref="algorithm1.1.1.m1.1.2.2.1.cmml">⁢</mo><mi id="algorithm1.1.1.m1.1.2.2.4" xref="algorithm1.1.1.m1.1.2.2.4.cmml">n</mi></mrow><mo id="algorithm1.1.1.m1.1.2.1" stretchy="false" xref="algorithm1.1.1.m1.1.2.1.cmml">←</mo><mrow id="algorithm1.1.1.m1.1.2.3" xref="algorithm1.1.1.m1.1.2.3.cmml"><mi id="algorithm1.1.1.m1.1.2.3.2" xref="algorithm1.1.1.m1.1.2.3.2.cmml">l</mi><mo id="algorithm1.1.1.m1.1.2.3.1" xref="algorithm1.1.1.m1.1.2.3.1.cmml">⁢</mo><mi id="algorithm1.1.1.m1.1.2.3.3" xref="algorithm1.1.1.m1.1.2.3.3.cmml">e</mi><mo id="algorithm1.1.1.m1.1.2.3.1a" xref="algorithm1.1.1.m1.1.2.3.1.cmml">⁢</mo><mi id="algorithm1.1.1.m1.1.2.3.4" xref="algorithm1.1.1.m1.1.2.3.4.cmml">n</mi><mo id="algorithm1.1.1.m1.1.2.3.1b" xref="algorithm1.1.1.m1.1.2.3.1.cmml">⁢</mo><mi id="algorithm1.1.1.m1.1.2.3.5" xref="algorithm1.1.1.m1.1.2.3.5.cmml">g</mi><mo id="algorithm1.1.1.m1.1.2.3.1c" xref="algorithm1.1.1.m1.1.2.3.1.cmml">⁢</mo><mi id="algorithm1.1.1.m1.1.2.3.6" xref="algorithm1.1.1.m1.1.2.3.6.cmml">t</mi><mo id="algorithm1.1.1.m1.1.2.3.1d" xref="algorithm1.1.1.m1.1.2.3.1.cmml">⁢</mo><mi id="algorithm1.1.1.m1.1.2.3.7" xref="algorithm1.1.1.m1.1.2.3.7.cmml">h</mi><mo id="algorithm1.1.1.m1.1.2.3.1e" xref="algorithm1.1.1.m1.1.2.3.1.cmml">⁢</mo><mrow id="algorithm1.1.1.m1.1.2.3.8.2" xref="algorithm1.1.1.m1.1.2.3.cmml"><mo id="algorithm1.1.1.m1.1.2.3.8.2.1" stretchy="false" xref="algorithm1.1.1.m1.1.2.3.cmml">(</mo><mi id="algorithm1.1.1.m1.1.1" xref="algorithm1.1.1.m1.1.1.cmml">y</mi><mo id="algorithm1.1.1.m1.1.2.3.8.2.2" stretchy="false" xref="algorithm1.1.1.m1.1.2.3.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="algorithm1.1.1.m1.1b"><apply id="algorithm1.1.1.m1.1.2.cmml" xref="algorithm1.1.1.m1.1.2"><ci id="algorithm1.1.1.m1.1.2.1.cmml" xref="algorithm1.1.1.m1.1.2.1">←</ci><apply id="algorithm1.1.1.m1.1.2.2.cmml" xref="algorithm1.1.1.m1.1.2.2"><times id="algorithm1.1.1.m1.1.2.2.1.cmml" xref="algorithm1.1.1.m1.1.2.2.1"></times><ci id="algorithm1.1.1.m1.1.2.2.2.cmml" xref="algorithm1.1.1.m1.1.2.2.2">𝑙</ci><ci id="algorithm1.1.1.m1.1.2.2.3.cmml" xref="algorithm1.1.1.m1.1.2.2.3">𝑒</ci><ci id="algorithm1.1.1.m1.1.2.2.4.cmml" xref="algorithm1.1.1.m1.1.2.2.4">𝑛</ci></apply><apply id="algorithm1.1.1.m1.1.2.3.cmml" xref="algorithm1.1.1.m1.1.2.3"><times id="algorithm1.1.1.m1.1.2.3.1.cmml" xref="algorithm1.1.1.m1.1.2.3.1"></times><ci id="algorithm1.1.1.m1.1.2.3.2.cmml" xref="algorithm1.1.1.m1.1.2.3.2">𝑙</ci><ci id="algorithm1.1.1.m1.1.2.3.3.cmml" xref="algorithm1.1.1.m1.1.2.3.3">𝑒</ci><ci id="algorithm1.1.1.m1.1.2.3.4.cmml" xref="algorithm1.1.1.m1.1.2.3.4">𝑛</ci><ci id="algorithm1.1.1.m1.1.2.3.5.cmml" xref="algorithm1.1.1.m1.1.2.3.5">𝑔</ci><ci id="algorithm1.1.1.m1.1.2.3.6.cmml" xref="algorithm1.1.1.m1.1.2.3.6">𝑡</ci><ci id="algorithm1.1.1.m1.1.2.3.7.cmml" xref="algorithm1.1.1.m1.1.2.3.7">ℎ</ci><ci id="algorithm1.1.1.m1.1.1.cmml" xref="algorithm1.1.1.m1.1.1">𝑦</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="algorithm1.1.1.m1.1c">len\leftarrow length(y)</annotation><annotation encoding="application/x-llamapun" id="algorithm1.1.1.m1.1d">italic_l italic_e italic_n ← italic_l italic_e italic_n italic_g italic_t italic_h ( italic_y )</annotation></semantics></math>;
</div>
<div class="ltx_listingline" id="algorithm1.2.2">
<span class="ltx_tag ltx_tag_listingline">2</span>
<math alttext="t\leftarrow 0" class="ltx_Math" display="inline" id="algorithm1.2.2.m1.1"><semantics id="algorithm1.2.2.m1.1a"><mrow id="algorithm1.2.2.m1.1.1" xref="algorithm1.2.2.m1.1.1.cmml"><mi id="algorithm1.2.2.m1.1.1.2" xref="algorithm1.2.2.m1.1.1.2.cmml">t</mi><mo id="algorithm1.2.2.m1.1.1.1" stretchy="false" xref="algorithm1.2.2.m1.1.1.1.cmml">←</mo><mn id="algorithm1.2.2.m1.1.1.3" xref="algorithm1.2.2.m1.1.1.3.cmml">0</mn></mrow><annotation-xml encoding="MathML-Content" id="algorithm1.2.2.m1.1b"><apply id="algorithm1.2.2.m1.1.1.cmml" xref="algorithm1.2.2.m1.1.1"><ci id="algorithm1.2.2.m1.1.1.1.cmml" xref="algorithm1.2.2.m1.1.1.1">←</ci><ci id="algorithm1.2.2.m1.1.1.2.cmml" xref="algorithm1.2.2.m1.1.1.2">𝑡</ci><cn id="algorithm1.2.2.m1.1.1.3.cmml" type="integer" xref="algorithm1.2.2.m1.1.1.3">0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="algorithm1.2.2.m1.1c">t\leftarrow 0</annotation><annotation encoding="application/x-llamapun" id="algorithm1.2.2.m1.1d">italic_t ← 0</annotation></semantics></math>;
</div>
<div class="ltx_listingline" id="algorithm1.3.3">
<span class="ltx_tag ltx_tag_listingline">3</span>
<span class="ltx_text ltx_font_bold" id="algorithm1.3.3.2">while</span> <em class="ltx_emph ltx_font_italic" id="algorithm1.3.3.1"><math alttext="t\neq len" class="ltx_Math" display="inline" id="algorithm1.3.3.1.m1.1"><semantics id="algorithm1.3.3.1.m1.1a"><mrow id="algorithm1.3.3.1.m1.1.1" xref="algorithm1.3.3.1.m1.1.1.cmml"><mi id="algorithm1.3.3.1.m1.1.1.2" xref="algorithm1.3.3.1.m1.1.1.2.cmml">t</mi><mo id="algorithm1.3.3.1.m1.1.1.1" xref="algorithm1.3.3.1.m1.1.1.1.cmml">≠</mo><mrow id="algorithm1.3.3.1.m1.1.1.3" xref="algorithm1.3.3.1.m1.1.1.3.cmml"><mi id="algorithm1.3.3.1.m1.1.1.3.2" xref="algorithm1.3.3.1.m1.1.1.3.2.cmml">l</mi><mo id="algorithm1.3.3.1.m1.1.1.3.1" xref="algorithm1.3.3.1.m1.1.1.3.1.cmml">⁢</mo><mi id="algorithm1.3.3.1.m1.1.1.3.3" xref="algorithm1.3.3.1.m1.1.1.3.3.cmml">e</mi><mo id="algorithm1.3.3.1.m1.1.1.3.1a" xref="algorithm1.3.3.1.m1.1.1.3.1.cmml">⁢</mo><mi id="algorithm1.3.3.1.m1.1.1.3.4" xref="algorithm1.3.3.1.m1.1.1.3.4.cmml">n</mi></mrow></mrow><annotation-xml encoding="MathML-Content" id="algorithm1.3.3.1.m1.1b"><apply id="algorithm1.3.3.1.m1.1.1.cmml" xref="algorithm1.3.3.1.m1.1.1"><neq id="algorithm1.3.3.1.m1.1.1.1.cmml" xref="algorithm1.3.3.1.m1.1.1.1"></neq><ci id="algorithm1.3.3.1.m1.1.1.2.cmml" xref="algorithm1.3.3.1.m1.1.1.2">𝑡</ci><apply id="algorithm1.3.3.1.m1.1.1.3.cmml" xref="algorithm1.3.3.1.m1.1.1.3"><times id="algorithm1.3.3.1.m1.1.1.3.1.cmml" xref="algorithm1.3.3.1.m1.1.1.3.1"></times><ci id="algorithm1.3.3.1.m1.1.1.3.2.cmml" xref="algorithm1.3.3.1.m1.1.1.3.2">𝑙</ci><ci id="algorithm1.3.3.1.m1.1.1.3.3.cmml" xref="algorithm1.3.3.1.m1.1.1.3.3">𝑒</ci><ci id="algorithm1.3.3.1.m1.1.1.3.4.cmml" xref="algorithm1.3.3.1.m1.1.1.3.4">𝑛</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="algorithm1.3.3.1.m1.1c">t\neq len</annotation><annotation encoding="application/x-llamapun" id="algorithm1.3.3.1.m1.1d">italic_t ≠ italic_l italic_e italic_n</annotation></semantics></math></em> <span class="ltx_text ltx_font_bold" id="algorithm1.3.3.3">do</span>
</div>
<div class="ltx_listingline" id="algorithm1.4.4">
<span class="ltx_tag ltx_tag_listingline">4</span>  <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>   
<math alttext="gt\leftarrow" class="ltx_Math" display="inline" id="algorithm1.4.4.m1.1"><semantics id="algorithm1.4.4.m1.1a"><mrow id="algorithm1.4.4.m1.1.1" xref="algorithm1.4.4.m1.1.1.cmml"><mrow id="algorithm1.4.4.m1.1.1.2" xref="algorithm1.4.4.m1.1.1.2.cmml"><mi id="algorithm1.4.4.m1.1.1.2.2" xref="algorithm1.4.4.m1.1.1.2.2.cmml">g</mi><mo id="algorithm1.4.4.m1.1.1.2.1" xref="algorithm1.4.4.m1.1.1.2.1.cmml">⁢</mo><mi id="algorithm1.4.4.m1.1.1.2.3" xref="algorithm1.4.4.m1.1.1.2.3.cmml">t</mi></mrow><mo id="algorithm1.4.4.m1.1.1.1" stretchy="false" xref="algorithm1.4.4.m1.1.1.1.cmml">←</mo><mi id="algorithm1.4.4.m1.1.1.3" xref="algorithm1.4.4.m1.1.1.3.cmml"></mi></mrow><annotation-xml encoding="MathML-Content" id="algorithm1.4.4.m1.1b"><apply id="algorithm1.4.4.m1.1.1.cmml" xref="algorithm1.4.4.m1.1.1"><ci id="algorithm1.4.4.m1.1.1.1.cmml" xref="algorithm1.4.4.m1.1.1.1">←</ci><apply id="algorithm1.4.4.m1.1.1.2.cmml" xref="algorithm1.4.4.m1.1.1.2"><times id="algorithm1.4.4.m1.1.1.2.1.cmml" xref="algorithm1.4.4.m1.1.1.2.1"></times><ci id="algorithm1.4.4.m1.1.1.2.2.cmml" xref="algorithm1.4.4.m1.1.1.2.2">𝑔</ci><ci id="algorithm1.4.4.m1.1.1.2.3.cmml" xref="algorithm1.4.4.m1.1.1.2.3">𝑡</ci></apply><csymbol cd="latexml" id="algorithm1.4.4.m1.1.1.3.cmml" xref="algorithm1.4.4.m1.1.1.3">absent</csymbol></apply></annotation-xml><annotation encoding="application/x-tex" id="algorithm1.4.4.m1.1c">gt\leftarrow</annotation><annotation encoding="application/x-llamapun" id="algorithm1.4.4.m1.1d">italic_g italic_t ←</annotation></semantics></math> ground truth Index;
</div>
<div class="ltx_listingline" id="algorithm1.5.5">
<span class="ltx_tag ltx_tag_listingline">5</span>  <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>   
generate <math alttext="Pknn(y_{&lt;t},x)" class="ltx_Math" display="inline" id="algorithm1.5.5.m1.2"><semantics id="algorithm1.5.5.m1.2a"><mrow id="algorithm1.5.5.m1.2.2" xref="algorithm1.5.5.m1.2.2.cmml"><mi id="algorithm1.5.5.m1.2.2.3" xref="algorithm1.5.5.m1.2.2.3.cmml">P</mi><mo id="algorithm1.5.5.m1.2.2.2" xref="algorithm1.5.5.m1.2.2.2.cmml">⁢</mo><mi id="algorithm1.5.5.m1.2.2.4" xref="algorithm1.5.5.m1.2.2.4.cmml">k</mi><mo id="algorithm1.5.5.m1.2.2.2a" xref="algorithm1.5.5.m1.2.2.2.cmml">⁢</mo><mi id="algorithm1.5.5.m1.2.2.5" xref="algorithm1.5.5.m1.2.2.5.cmml">n</mi><mo id="algorithm1.5.5.m1.2.2.2b" xref="algorithm1.5.5.m1.2.2.2.cmml">⁢</mo><mi id="algorithm1.5.5.m1.2.2.6" xref="algorithm1.5.5.m1.2.2.6.cmml">n</mi><mo id="algorithm1.5.5.m1.2.2.2c" xref="algorithm1.5.5.m1.2.2.2.cmml">⁢</mo><mrow id="algorithm1.5.5.m1.2.2.1.1" xref="algorithm1.5.5.m1.2.2.1.2.cmml"><mo id="algorithm1.5.5.m1.2.2.1.1.2" stretchy="false" xref="algorithm1.5.5.m1.2.2.1.2.cmml">(</mo><msub id="algorithm1.5.5.m1.2.2.1.1.1" xref="algorithm1.5.5.m1.2.2.1.1.1.cmml"><mi id="algorithm1.5.5.m1.2.2.1.1.1.2" xref="algorithm1.5.5.m1.2.2.1.1.1.2.cmml">y</mi><mrow id="algorithm1.5.5.m1.2.2.1.1.1.3" xref="algorithm1.5.5.m1.2.2.1.1.1.3.cmml"><mi id="algorithm1.5.5.m1.2.2.1.1.1.3.2" xref="algorithm1.5.5.m1.2.2.1.1.1.3.2.cmml"></mi><mo id="algorithm1.5.5.m1.2.2.1.1.1.3.1" xref="algorithm1.5.5.m1.2.2.1.1.1.3.1.cmml">&lt;</mo><mi id="algorithm1.5.5.m1.2.2.1.1.1.3.3" xref="algorithm1.5.5.m1.2.2.1.1.1.3.3.cmml">t</mi></mrow></msub><mo id="algorithm1.5.5.m1.2.2.1.1.3" xref="algorithm1.5.5.m1.2.2.1.2.cmml">,</mo><mi id="algorithm1.5.5.m1.1.1" xref="algorithm1.5.5.m1.1.1.cmml">x</mi><mo id="algorithm1.5.5.m1.2.2.1.1.4" stretchy="false" xref="algorithm1.5.5.m1.2.2.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="algorithm1.5.5.m1.2b"><apply id="algorithm1.5.5.m1.2.2.cmml" xref="algorithm1.5.5.m1.2.2"><times id="algorithm1.5.5.m1.2.2.2.cmml" xref="algorithm1.5.5.m1.2.2.2"></times><ci id="algorithm1.5.5.m1.2.2.3.cmml" xref="algorithm1.5.5.m1.2.2.3">𝑃</ci><ci id="algorithm1.5.5.m1.2.2.4.cmml" xref="algorithm1.5.5.m1.2.2.4">𝑘</ci><ci id="algorithm1.5.5.m1.2.2.5.cmml" xref="algorithm1.5.5.m1.2.2.5">𝑛</ci><ci id="algorithm1.5.5.m1.2.2.6.cmml" xref="algorithm1.5.5.m1.2.2.6">𝑛</ci><interval closure="open" id="algorithm1.5.5.m1.2.2.1.2.cmml" xref="algorithm1.5.5.m1.2.2.1.1"><apply id="algorithm1.5.5.m1.2.2.1.1.1.cmml" xref="algorithm1.5.5.m1.2.2.1.1.1"><csymbol cd="ambiguous" id="algorithm1.5.5.m1.2.2.1.1.1.1.cmml" xref="algorithm1.5.5.m1.2.2.1.1.1">subscript</csymbol><ci id="algorithm1.5.5.m1.2.2.1.1.1.2.cmml" xref="algorithm1.5.5.m1.2.2.1.1.1.2">𝑦</ci><apply id="algorithm1.5.5.m1.2.2.1.1.1.3.cmml" xref="algorithm1.5.5.m1.2.2.1.1.1.3"><lt id="algorithm1.5.5.m1.2.2.1.1.1.3.1.cmml" xref="algorithm1.5.5.m1.2.2.1.1.1.3.1"></lt><csymbol cd="latexml" id="algorithm1.5.5.m1.2.2.1.1.1.3.2.cmml" xref="algorithm1.5.5.m1.2.2.1.1.1.3.2">absent</csymbol><ci id="algorithm1.5.5.m1.2.2.1.1.1.3.3.cmml" xref="algorithm1.5.5.m1.2.2.1.1.1.3.3">𝑡</ci></apply></apply><ci id="algorithm1.5.5.m1.1.1.cmml" xref="algorithm1.5.5.m1.1.1">𝑥</ci></interval></apply></annotation-xml><annotation encoding="application/x-tex" id="algorithm1.5.5.m1.2c">Pknn(y_{&lt;t},x)</annotation><annotation encoding="application/x-llamapun" id="algorithm1.5.5.m1.2d">italic_P italic_k italic_n italic_n ( italic_y start_POSTSUBSCRIPT &lt; italic_t end_POSTSUBSCRIPT , italic_x )</annotation></semantics></math>;
</div>
<div class="ltx_listingline" id="algorithm1.6.6">
<span class="ltx_tag ltx_tag_listingline">6</span>  <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>   
generate <math alttext="Pmt(y_{&lt;t},x)" class="ltx_Math" display="inline" id="algorithm1.6.6.m1.2"><semantics id="algorithm1.6.6.m1.2a"><mrow id="algorithm1.6.6.m1.2.2" xref="algorithm1.6.6.m1.2.2.cmml"><mi id="algorithm1.6.6.m1.2.2.3" xref="algorithm1.6.6.m1.2.2.3.cmml">P</mi><mo id="algorithm1.6.6.m1.2.2.2" xref="algorithm1.6.6.m1.2.2.2.cmml">⁢</mo><mi id="algorithm1.6.6.m1.2.2.4" xref="algorithm1.6.6.m1.2.2.4.cmml">m</mi><mo id="algorithm1.6.6.m1.2.2.2a" xref="algorithm1.6.6.m1.2.2.2.cmml">⁢</mo><mi id="algorithm1.6.6.m1.2.2.5" xref="algorithm1.6.6.m1.2.2.5.cmml">t</mi><mo id="algorithm1.6.6.m1.2.2.2b" xref="algorithm1.6.6.m1.2.2.2.cmml">⁢</mo><mrow id="algorithm1.6.6.m1.2.2.1.1" xref="algorithm1.6.6.m1.2.2.1.2.cmml"><mo id="algorithm1.6.6.m1.2.2.1.1.2" stretchy="false" xref="algorithm1.6.6.m1.2.2.1.2.cmml">(</mo><msub id="algorithm1.6.6.m1.2.2.1.1.1" xref="algorithm1.6.6.m1.2.2.1.1.1.cmml"><mi id="algorithm1.6.6.m1.2.2.1.1.1.2" xref="algorithm1.6.6.m1.2.2.1.1.1.2.cmml">y</mi><mrow id="algorithm1.6.6.m1.2.2.1.1.1.3" xref="algorithm1.6.6.m1.2.2.1.1.1.3.cmml"><mi id="algorithm1.6.6.m1.2.2.1.1.1.3.2" xref="algorithm1.6.6.m1.2.2.1.1.1.3.2.cmml"></mi><mo id="algorithm1.6.6.m1.2.2.1.1.1.3.1" xref="algorithm1.6.6.m1.2.2.1.1.1.3.1.cmml">&lt;</mo><mi id="algorithm1.6.6.m1.2.2.1.1.1.3.3" xref="algorithm1.6.6.m1.2.2.1.1.1.3.3.cmml">t</mi></mrow></msub><mo id="algorithm1.6.6.m1.2.2.1.1.3" xref="algorithm1.6.6.m1.2.2.1.2.cmml">,</mo><mi id="algorithm1.6.6.m1.1.1" xref="algorithm1.6.6.m1.1.1.cmml">x</mi><mo id="algorithm1.6.6.m1.2.2.1.1.4" stretchy="false" xref="algorithm1.6.6.m1.2.2.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="algorithm1.6.6.m1.2b"><apply id="algorithm1.6.6.m1.2.2.cmml" xref="algorithm1.6.6.m1.2.2"><times id="algorithm1.6.6.m1.2.2.2.cmml" xref="algorithm1.6.6.m1.2.2.2"></times><ci id="algorithm1.6.6.m1.2.2.3.cmml" xref="algorithm1.6.6.m1.2.2.3">𝑃</ci><ci id="algorithm1.6.6.m1.2.2.4.cmml" xref="algorithm1.6.6.m1.2.2.4">𝑚</ci><ci id="algorithm1.6.6.m1.2.2.5.cmml" xref="algorithm1.6.6.m1.2.2.5">𝑡</ci><interval closure="open" id="algorithm1.6.6.m1.2.2.1.2.cmml" xref="algorithm1.6.6.m1.2.2.1.1"><apply id="algorithm1.6.6.m1.2.2.1.1.1.cmml" xref="algorithm1.6.6.m1.2.2.1.1.1"><csymbol cd="ambiguous" id="algorithm1.6.6.m1.2.2.1.1.1.1.cmml" xref="algorithm1.6.6.m1.2.2.1.1.1">subscript</csymbol><ci id="algorithm1.6.6.m1.2.2.1.1.1.2.cmml" xref="algorithm1.6.6.m1.2.2.1.1.1.2">𝑦</ci><apply id="algorithm1.6.6.m1.2.2.1.1.1.3.cmml" xref="algorithm1.6.6.m1.2.2.1.1.1.3"><lt id="algorithm1.6.6.m1.2.2.1.1.1.3.1.cmml" xref="algorithm1.6.6.m1.2.2.1.1.1.3.1"></lt><csymbol cd="latexml" id="algorithm1.6.6.m1.2.2.1.1.1.3.2.cmml" xref="algorithm1.6.6.m1.2.2.1.1.1.3.2">absent</csymbol><ci id="algorithm1.6.6.m1.2.2.1.1.1.3.3.cmml" xref="algorithm1.6.6.m1.2.2.1.1.1.3.3">𝑡</ci></apply></apply><ci id="algorithm1.6.6.m1.1.1.cmml" xref="algorithm1.6.6.m1.1.1">𝑥</ci></interval></apply></annotation-xml><annotation encoding="application/x-tex" id="algorithm1.6.6.m1.2c">Pmt(y_{&lt;t},x)</annotation><annotation encoding="application/x-llamapun" id="algorithm1.6.6.m1.2d">italic_P italic_m italic_t ( italic_y start_POSTSUBSCRIPT &lt; italic_t end_POSTSUBSCRIPT , italic_x )</annotation></semantics></math>;
</div>
<div class="ltx_listingline" id="algorithm1.7.7">
<span class="ltx_tag ltx_tag_listingline">7</span>  <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>   
<span class="ltx_text ltx_font_bold" id="algorithm1.7.7.2">if</span> <em class="ltx_emph ltx_font_italic" id="algorithm1.7.7.1"><math alttext="Pknn(gt|y_{&lt;t},x)\geq Pmt(gt|y_{&lt;t},x)" class="ltx_Math" display="inline" id="algorithm1.7.7.1.m1.4"><semantics id="algorithm1.7.7.1.m1.4a"><mrow id="algorithm1.7.7.1.m1.4.4" xref="algorithm1.7.7.1.m1.4.4.cmml"><mrow id="algorithm1.7.7.1.m1.3.3.1" xref="algorithm1.7.7.1.m1.3.3.1.cmml"><mi id="algorithm1.7.7.1.m1.3.3.1.3" xref="algorithm1.7.7.1.m1.3.3.1.3.cmml">P</mi><mo id="algorithm1.7.7.1.m1.3.3.1.2" xref="algorithm1.7.7.1.m1.3.3.1.2.cmml">⁢</mo><mi id="algorithm1.7.7.1.m1.3.3.1.4" xref="algorithm1.7.7.1.m1.3.3.1.4.cmml">k</mi><mo id="algorithm1.7.7.1.m1.3.3.1.2a" xref="algorithm1.7.7.1.m1.3.3.1.2.cmml">⁢</mo><mi id="algorithm1.7.7.1.m1.3.3.1.5" xref="algorithm1.7.7.1.m1.3.3.1.5.cmml">n</mi><mo id="algorithm1.7.7.1.m1.3.3.1.2b" xref="algorithm1.7.7.1.m1.3.3.1.2.cmml">⁢</mo><mi id="algorithm1.7.7.1.m1.3.3.1.6" xref="algorithm1.7.7.1.m1.3.3.1.6.cmml">n</mi><mo id="algorithm1.7.7.1.m1.3.3.1.2c" xref="algorithm1.7.7.1.m1.3.3.1.2.cmml">⁢</mo><mrow id="algorithm1.7.7.1.m1.3.3.1.1.1" xref="algorithm1.7.7.1.m1.3.3.1.1.1.1.cmml"><mo id="algorithm1.7.7.1.m1.3.3.1.1.1.2" stretchy="false" xref="algorithm1.7.7.1.m1.3.3.1.1.1.1.cmml">(</mo><mrow id="algorithm1.7.7.1.m1.3.3.1.1.1.1" xref="algorithm1.7.7.1.m1.3.3.1.1.1.1.cmml"><mrow id="algorithm1.7.7.1.m1.3.3.1.1.1.1.3" xref="algorithm1.7.7.1.m1.3.3.1.1.1.1.3.cmml"><mi id="algorithm1.7.7.1.m1.3.3.1.1.1.1.3.2" xref="algorithm1.7.7.1.m1.3.3.1.1.1.1.3.2.cmml">g</mi><mo id="algorithm1.7.7.1.m1.3.3.1.1.1.1.3.1" xref="algorithm1.7.7.1.m1.3.3.1.1.1.1.3.1.cmml">⁢</mo><mi id="algorithm1.7.7.1.m1.3.3.1.1.1.1.3.3" xref="algorithm1.7.7.1.m1.3.3.1.1.1.1.3.3.cmml">t</mi></mrow><mo fence="false" id="algorithm1.7.7.1.m1.3.3.1.1.1.1.2" xref="algorithm1.7.7.1.m1.3.3.1.1.1.1.2.cmml">|</mo><mrow id="algorithm1.7.7.1.m1.3.3.1.1.1.1.1.1" xref="algorithm1.7.7.1.m1.3.3.1.1.1.1.1.2.cmml"><msub id="algorithm1.7.7.1.m1.3.3.1.1.1.1.1.1.1" xref="algorithm1.7.7.1.m1.3.3.1.1.1.1.1.1.1.cmml"><mi id="algorithm1.7.7.1.m1.3.3.1.1.1.1.1.1.1.2" xref="algorithm1.7.7.1.m1.3.3.1.1.1.1.1.1.1.2.cmml">y</mi><mrow id="algorithm1.7.7.1.m1.3.3.1.1.1.1.1.1.1.3" xref="algorithm1.7.7.1.m1.3.3.1.1.1.1.1.1.1.3.cmml"><mi id="algorithm1.7.7.1.m1.3.3.1.1.1.1.1.1.1.3.2" xref="algorithm1.7.7.1.m1.3.3.1.1.1.1.1.1.1.3.2.cmml"></mi><mo id="algorithm1.7.7.1.m1.3.3.1.1.1.1.1.1.1.3.1" xref="algorithm1.7.7.1.m1.3.3.1.1.1.1.1.1.1.3.1.cmml">&lt;</mo><mi id="algorithm1.7.7.1.m1.3.3.1.1.1.1.1.1.1.3.3" xref="algorithm1.7.7.1.m1.3.3.1.1.1.1.1.1.1.3.3.cmml">t</mi></mrow></msub><mo id="algorithm1.7.7.1.m1.3.3.1.1.1.1.1.1.2" xref="algorithm1.7.7.1.m1.3.3.1.1.1.1.1.2.cmml">,</mo><mi id="algorithm1.7.7.1.m1.1.1" xref="algorithm1.7.7.1.m1.1.1.cmml">x</mi></mrow></mrow><mo id="algorithm1.7.7.1.m1.3.3.1.1.1.3" stretchy="false" xref="algorithm1.7.7.1.m1.3.3.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="algorithm1.7.7.1.m1.4.4.3" xref="algorithm1.7.7.1.m1.4.4.3.cmml">≥</mo><mrow id="algorithm1.7.7.1.m1.4.4.2" xref="algorithm1.7.7.1.m1.4.4.2.cmml"><mi id="algorithm1.7.7.1.m1.4.4.2.3" xref="algorithm1.7.7.1.m1.4.4.2.3.cmml">P</mi><mo id="algorithm1.7.7.1.m1.4.4.2.2" xref="algorithm1.7.7.1.m1.4.4.2.2.cmml">⁢</mo><mi id="algorithm1.7.7.1.m1.4.4.2.4" xref="algorithm1.7.7.1.m1.4.4.2.4.cmml">m</mi><mo id="algorithm1.7.7.1.m1.4.4.2.2a" xref="algorithm1.7.7.1.m1.4.4.2.2.cmml">⁢</mo><mi id="algorithm1.7.7.1.m1.4.4.2.5" xref="algorithm1.7.7.1.m1.4.4.2.5.cmml">t</mi><mo id="algorithm1.7.7.1.m1.4.4.2.2b" xref="algorithm1.7.7.1.m1.4.4.2.2.cmml">⁢</mo><mrow id="algorithm1.7.7.1.m1.4.4.2.1.1" xref="algorithm1.7.7.1.m1.4.4.2.1.1.1.cmml"><mo id="algorithm1.7.7.1.m1.4.4.2.1.1.2" stretchy="false" xref="algorithm1.7.7.1.m1.4.4.2.1.1.1.cmml">(</mo><mrow id="algorithm1.7.7.1.m1.4.4.2.1.1.1" xref="algorithm1.7.7.1.m1.4.4.2.1.1.1.cmml"><mrow id="algorithm1.7.7.1.m1.4.4.2.1.1.1.3" xref="algorithm1.7.7.1.m1.4.4.2.1.1.1.3.cmml"><mi id="algorithm1.7.7.1.m1.4.4.2.1.1.1.3.2" xref="algorithm1.7.7.1.m1.4.4.2.1.1.1.3.2.cmml">g</mi><mo id="algorithm1.7.7.1.m1.4.4.2.1.1.1.3.1" xref="algorithm1.7.7.1.m1.4.4.2.1.1.1.3.1.cmml">⁢</mo><mi id="algorithm1.7.7.1.m1.4.4.2.1.1.1.3.3" xref="algorithm1.7.7.1.m1.4.4.2.1.1.1.3.3.cmml">t</mi></mrow><mo fence="false" id="algorithm1.7.7.1.m1.4.4.2.1.1.1.2" xref="algorithm1.7.7.1.m1.4.4.2.1.1.1.2.cmml">|</mo><mrow id="algorithm1.7.7.1.m1.4.4.2.1.1.1.1.1" xref="algorithm1.7.7.1.m1.4.4.2.1.1.1.1.2.cmml"><msub id="algorithm1.7.7.1.m1.4.4.2.1.1.1.1.1.1" xref="algorithm1.7.7.1.m1.4.4.2.1.1.1.1.1.1.cmml"><mi id="algorithm1.7.7.1.m1.4.4.2.1.1.1.1.1.1.2" xref="algorithm1.7.7.1.m1.4.4.2.1.1.1.1.1.1.2.cmml">y</mi><mrow id="algorithm1.7.7.1.m1.4.4.2.1.1.1.1.1.1.3" xref="algorithm1.7.7.1.m1.4.4.2.1.1.1.1.1.1.3.cmml"><mi id="algorithm1.7.7.1.m1.4.4.2.1.1.1.1.1.1.3.2" xref="algorithm1.7.7.1.m1.4.4.2.1.1.1.1.1.1.3.2.cmml"></mi><mo id="algorithm1.7.7.1.m1.4.4.2.1.1.1.1.1.1.3.1" xref="algorithm1.7.7.1.m1.4.4.2.1.1.1.1.1.1.3.1.cmml">&lt;</mo><mi id="algorithm1.7.7.1.m1.4.4.2.1.1.1.1.1.1.3.3" xref="algorithm1.7.7.1.m1.4.4.2.1.1.1.1.1.1.3.3.cmml">t</mi></mrow></msub><mo id="algorithm1.7.7.1.m1.4.4.2.1.1.1.1.1.2" xref="algorithm1.7.7.1.m1.4.4.2.1.1.1.1.2.cmml">,</mo><mi id="algorithm1.7.7.1.m1.2.2" xref="algorithm1.7.7.1.m1.2.2.cmml">x</mi></mrow></mrow><mo id="algorithm1.7.7.1.m1.4.4.2.1.1.3" stretchy="false" xref="algorithm1.7.7.1.m1.4.4.2.1.1.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="algorithm1.7.7.1.m1.4b"><apply id="algorithm1.7.7.1.m1.4.4.cmml" xref="algorithm1.7.7.1.m1.4.4"><geq id="algorithm1.7.7.1.m1.4.4.3.cmml" xref="algorithm1.7.7.1.m1.4.4.3"></geq><apply id="algorithm1.7.7.1.m1.3.3.1.cmml" xref="algorithm1.7.7.1.m1.3.3.1"><times id="algorithm1.7.7.1.m1.3.3.1.2.cmml" xref="algorithm1.7.7.1.m1.3.3.1.2"></times><ci id="algorithm1.7.7.1.m1.3.3.1.3.cmml" xref="algorithm1.7.7.1.m1.3.3.1.3">𝑃</ci><ci id="algorithm1.7.7.1.m1.3.3.1.4.cmml" xref="algorithm1.7.7.1.m1.3.3.1.4">𝑘</ci><ci id="algorithm1.7.7.1.m1.3.3.1.5.cmml" xref="algorithm1.7.7.1.m1.3.3.1.5">𝑛</ci><ci id="algorithm1.7.7.1.m1.3.3.1.6.cmml" xref="algorithm1.7.7.1.m1.3.3.1.6">𝑛</ci><apply id="algorithm1.7.7.1.m1.3.3.1.1.1.1.cmml" xref="algorithm1.7.7.1.m1.3.3.1.1.1"><csymbol cd="latexml" id="algorithm1.7.7.1.m1.3.3.1.1.1.1.2.cmml" xref="algorithm1.7.7.1.m1.3.3.1.1.1.1.2">conditional</csymbol><apply id="algorithm1.7.7.1.m1.3.3.1.1.1.1.3.cmml" xref="algorithm1.7.7.1.m1.3.3.1.1.1.1.3"><times id="algorithm1.7.7.1.m1.3.3.1.1.1.1.3.1.cmml" xref="algorithm1.7.7.1.m1.3.3.1.1.1.1.3.1"></times><ci id="algorithm1.7.7.1.m1.3.3.1.1.1.1.3.2.cmml" xref="algorithm1.7.7.1.m1.3.3.1.1.1.1.3.2">𝑔</ci><ci id="algorithm1.7.7.1.m1.3.3.1.1.1.1.3.3.cmml" xref="algorithm1.7.7.1.m1.3.3.1.1.1.1.3.3">𝑡</ci></apply><list id="algorithm1.7.7.1.m1.3.3.1.1.1.1.1.2.cmml" xref="algorithm1.7.7.1.m1.3.3.1.1.1.1.1.1"><apply id="algorithm1.7.7.1.m1.3.3.1.1.1.1.1.1.1.cmml" xref="algorithm1.7.7.1.m1.3.3.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="algorithm1.7.7.1.m1.3.3.1.1.1.1.1.1.1.1.cmml" xref="algorithm1.7.7.1.m1.3.3.1.1.1.1.1.1.1">subscript</csymbol><ci id="algorithm1.7.7.1.m1.3.3.1.1.1.1.1.1.1.2.cmml" xref="algorithm1.7.7.1.m1.3.3.1.1.1.1.1.1.1.2">𝑦</ci><apply id="algorithm1.7.7.1.m1.3.3.1.1.1.1.1.1.1.3.cmml" xref="algorithm1.7.7.1.m1.3.3.1.1.1.1.1.1.1.3"><lt id="algorithm1.7.7.1.m1.3.3.1.1.1.1.1.1.1.3.1.cmml" xref="algorithm1.7.7.1.m1.3.3.1.1.1.1.1.1.1.3.1"></lt><csymbol cd="latexml" id="algorithm1.7.7.1.m1.3.3.1.1.1.1.1.1.1.3.2.cmml" xref="algorithm1.7.7.1.m1.3.3.1.1.1.1.1.1.1.3.2">absent</csymbol><ci id="algorithm1.7.7.1.m1.3.3.1.1.1.1.1.1.1.3.3.cmml" xref="algorithm1.7.7.1.m1.3.3.1.1.1.1.1.1.1.3.3">𝑡</ci></apply></apply><ci id="algorithm1.7.7.1.m1.1.1.cmml" xref="algorithm1.7.7.1.m1.1.1">𝑥</ci></list></apply></apply><apply id="algorithm1.7.7.1.m1.4.4.2.cmml" xref="algorithm1.7.7.1.m1.4.4.2"><times id="algorithm1.7.7.1.m1.4.4.2.2.cmml" xref="algorithm1.7.7.1.m1.4.4.2.2"></times><ci id="algorithm1.7.7.1.m1.4.4.2.3.cmml" xref="algorithm1.7.7.1.m1.4.4.2.3">𝑃</ci><ci id="algorithm1.7.7.1.m1.4.4.2.4.cmml" xref="algorithm1.7.7.1.m1.4.4.2.4">𝑚</ci><ci id="algorithm1.7.7.1.m1.4.4.2.5.cmml" xref="algorithm1.7.7.1.m1.4.4.2.5">𝑡</ci><apply id="algorithm1.7.7.1.m1.4.4.2.1.1.1.cmml" xref="algorithm1.7.7.1.m1.4.4.2.1.1"><csymbol cd="latexml" id="algorithm1.7.7.1.m1.4.4.2.1.1.1.2.cmml" xref="algorithm1.7.7.1.m1.4.4.2.1.1.1.2">conditional</csymbol><apply id="algorithm1.7.7.1.m1.4.4.2.1.1.1.3.cmml" xref="algorithm1.7.7.1.m1.4.4.2.1.1.1.3"><times id="algorithm1.7.7.1.m1.4.4.2.1.1.1.3.1.cmml" xref="algorithm1.7.7.1.m1.4.4.2.1.1.1.3.1"></times><ci id="algorithm1.7.7.1.m1.4.4.2.1.1.1.3.2.cmml" xref="algorithm1.7.7.1.m1.4.4.2.1.1.1.3.2">𝑔</ci><ci id="algorithm1.7.7.1.m1.4.4.2.1.1.1.3.3.cmml" xref="algorithm1.7.7.1.m1.4.4.2.1.1.1.3.3">𝑡</ci></apply><list id="algorithm1.7.7.1.m1.4.4.2.1.1.1.1.2.cmml" xref="algorithm1.7.7.1.m1.4.4.2.1.1.1.1.1"><apply id="algorithm1.7.7.1.m1.4.4.2.1.1.1.1.1.1.cmml" xref="algorithm1.7.7.1.m1.4.4.2.1.1.1.1.1.1"><csymbol cd="ambiguous" id="algorithm1.7.7.1.m1.4.4.2.1.1.1.1.1.1.1.cmml" xref="algorithm1.7.7.1.m1.4.4.2.1.1.1.1.1.1">subscript</csymbol><ci id="algorithm1.7.7.1.m1.4.4.2.1.1.1.1.1.1.2.cmml" xref="algorithm1.7.7.1.m1.4.4.2.1.1.1.1.1.1.2">𝑦</ci><apply id="algorithm1.7.7.1.m1.4.4.2.1.1.1.1.1.1.3.cmml" xref="algorithm1.7.7.1.m1.4.4.2.1.1.1.1.1.1.3"><lt id="algorithm1.7.7.1.m1.4.4.2.1.1.1.1.1.1.3.1.cmml" xref="algorithm1.7.7.1.m1.4.4.2.1.1.1.1.1.1.3.1"></lt><csymbol cd="latexml" id="algorithm1.7.7.1.m1.4.4.2.1.1.1.1.1.1.3.2.cmml" xref="algorithm1.7.7.1.m1.4.4.2.1.1.1.1.1.1.3.2">absent</csymbol><ci id="algorithm1.7.7.1.m1.4.4.2.1.1.1.1.1.1.3.3.cmml" xref="algorithm1.7.7.1.m1.4.4.2.1.1.1.1.1.1.3.3">𝑡</ci></apply></apply><ci id="algorithm1.7.7.1.m1.2.2.cmml" xref="algorithm1.7.7.1.m1.2.2">𝑥</ci></list></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="algorithm1.7.7.1.m1.4c">Pknn(gt|y_{&lt;t},x)\geq Pmt(gt|y_{&lt;t},x)</annotation><annotation encoding="application/x-llamapun" id="algorithm1.7.7.1.m1.4d">italic_P italic_k italic_n italic_n ( italic_g italic_t | italic_y start_POSTSUBSCRIPT &lt; italic_t end_POSTSUBSCRIPT , italic_x ) ≥ italic_P italic_m italic_t ( italic_g italic_t | italic_y start_POSTSUBSCRIPT &lt; italic_t end_POSTSUBSCRIPT , italic_x )</annotation></semantics></math></em> <span class="ltx_text ltx_font_bold" id="algorithm1.7.7.3">then</span>
</div>
<div class="ltx_listingline" id="algorithm1.8.8">
<span class="ltx_tag ltx_tag_listingline">8</span>  <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>     <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>   
<math alttext="label=1" class="ltx_Math" display="inline" id="algorithm1.8.8.m1.1"><semantics id="algorithm1.8.8.m1.1a"><mrow id="algorithm1.8.8.m1.1.1" xref="algorithm1.8.8.m1.1.1.cmml"><mrow id="algorithm1.8.8.m1.1.1.2" xref="algorithm1.8.8.m1.1.1.2.cmml"><mi id="algorithm1.8.8.m1.1.1.2.2" xref="algorithm1.8.8.m1.1.1.2.2.cmml">l</mi><mo id="algorithm1.8.8.m1.1.1.2.1" xref="algorithm1.8.8.m1.1.1.2.1.cmml">⁢</mo><mi id="algorithm1.8.8.m1.1.1.2.3" xref="algorithm1.8.8.m1.1.1.2.3.cmml">a</mi><mo id="algorithm1.8.8.m1.1.1.2.1a" xref="algorithm1.8.8.m1.1.1.2.1.cmml">⁢</mo><mi id="algorithm1.8.8.m1.1.1.2.4" xref="algorithm1.8.8.m1.1.1.2.4.cmml">b</mi><mo id="algorithm1.8.8.m1.1.1.2.1b" xref="algorithm1.8.8.m1.1.1.2.1.cmml">⁢</mo><mi id="algorithm1.8.8.m1.1.1.2.5" xref="algorithm1.8.8.m1.1.1.2.5.cmml">e</mi><mo id="algorithm1.8.8.m1.1.1.2.1c" xref="algorithm1.8.8.m1.1.1.2.1.cmml">⁢</mo><mi id="algorithm1.8.8.m1.1.1.2.6" xref="algorithm1.8.8.m1.1.1.2.6.cmml">l</mi></mrow><mo id="algorithm1.8.8.m1.1.1.1" xref="algorithm1.8.8.m1.1.1.1.cmml">=</mo><mn id="algorithm1.8.8.m1.1.1.3" xref="algorithm1.8.8.m1.1.1.3.cmml">1</mn></mrow><annotation-xml encoding="MathML-Content" id="algorithm1.8.8.m1.1b"><apply id="algorithm1.8.8.m1.1.1.cmml" xref="algorithm1.8.8.m1.1.1"><eq id="algorithm1.8.8.m1.1.1.1.cmml" xref="algorithm1.8.8.m1.1.1.1"></eq><apply id="algorithm1.8.8.m1.1.1.2.cmml" xref="algorithm1.8.8.m1.1.1.2"><times id="algorithm1.8.8.m1.1.1.2.1.cmml" xref="algorithm1.8.8.m1.1.1.2.1"></times><ci id="algorithm1.8.8.m1.1.1.2.2.cmml" xref="algorithm1.8.8.m1.1.1.2.2">𝑙</ci><ci id="algorithm1.8.8.m1.1.1.2.3.cmml" xref="algorithm1.8.8.m1.1.1.2.3">𝑎</ci><ci id="algorithm1.8.8.m1.1.1.2.4.cmml" xref="algorithm1.8.8.m1.1.1.2.4">𝑏</ci><ci id="algorithm1.8.8.m1.1.1.2.5.cmml" xref="algorithm1.8.8.m1.1.1.2.5">𝑒</ci><ci id="algorithm1.8.8.m1.1.1.2.6.cmml" xref="algorithm1.8.8.m1.1.1.2.6">𝑙</ci></apply><cn id="algorithm1.8.8.m1.1.1.3.cmml" type="integer" xref="algorithm1.8.8.m1.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="algorithm1.8.8.m1.1c">label=1</annotation><annotation encoding="application/x-llamapun" id="algorithm1.8.8.m1.1d">italic_l italic_a italic_b italic_e italic_l = 1</annotation></semantics></math>;
</div>
<div class="ltx_listingline" id="algorithm1.13.14">  <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>     <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>    <span class="ltx_text ltx_font_typewriter" id="algorithm1.13.14.1">// </span><span class="ltx_text ltx_font_typewriter" id="algorithm1.13.14.2">favoring Pknn </span>
</div>
<div class="ltx_listingline" id="algorithm1.13.15">
<span class="ltx_tag ltx_tag_listingline">9</span>  <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>     <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>   

</div>
<div class="ltx_listingline" id="algorithm1.13.16">
<span class="ltx_tag ltx_tag_listingline">10</span>  <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>   <span class="ltx_text ltx_font_bold" id="algorithm1.13.16.1">else</span>
</div>
<div class="ltx_listingline" id="algorithm1.9.9">
<span class="ltx_tag ltx_tag_listingline">11</span>  <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>     <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>   
<math alttext="label=0" class="ltx_Math" display="inline" id="algorithm1.9.9.m1.1"><semantics id="algorithm1.9.9.m1.1a"><mrow id="algorithm1.9.9.m1.1.1" xref="algorithm1.9.9.m1.1.1.cmml"><mrow id="algorithm1.9.9.m1.1.1.2" xref="algorithm1.9.9.m1.1.1.2.cmml"><mi id="algorithm1.9.9.m1.1.1.2.2" xref="algorithm1.9.9.m1.1.1.2.2.cmml">l</mi><mo id="algorithm1.9.9.m1.1.1.2.1" xref="algorithm1.9.9.m1.1.1.2.1.cmml">⁢</mo><mi id="algorithm1.9.9.m1.1.1.2.3" xref="algorithm1.9.9.m1.1.1.2.3.cmml">a</mi><mo id="algorithm1.9.9.m1.1.1.2.1a" xref="algorithm1.9.9.m1.1.1.2.1.cmml">⁢</mo><mi id="algorithm1.9.9.m1.1.1.2.4" xref="algorithm1.9.9.m1.1.1.2.4.cmml">b</mi><mo id="algorithm1.9.9.m1.1.1.2.1b" xref="algorithm1.9.9.m1.1.1.2.1.cmml">⁢</mo><mi id="algorithm1.9.9.m1.1.1.2.5" xref="algorithm1.9.9.m1.1.1.2.5.cmml">e</mi><mo id="algorithm1.9.9.m1.1.1.2.1c" xref="algorithm1.9.9.m1.1.1.2.1.cmml">⁢</mo><mi id="algorithm1.9.9.m1.1.1.2.6" xref="algorithm1.9.9.m1.1.1.2.6.cmml">l</mi></mrow><mo id="algorithm1.9.9.m1.1.1.1" xref="algorithm1.9.9.m1.1.1.1.cmml">=</mo><mn id="algorithm1.9.9.m1.1.1.3" xref="algorithm1.9.9.m1.1.1.3.cmml">0</mn></mrow><annotation-xml encoding="MathML-Content" id="algorithm1.9.9.m1.1b"><apply id="algorithm1.9.9.m1.1.1.cmml" xref="algorithm1.9.9.m1.1.1"><eq id="algorithm1.9.9.m1.1.1.1.cmml" xref="algorithm1.9.9.m1.1.1.1"></eq><apply id="algorithm1.9.9.m1.1.1.2.cmml" xref="algorithm1.9.9.m1.1.1.2"><times id="algorithm1.9.9.m1.1.1.2.1.cmml" xref="algorithm1.9.9.m1.1.1.2.1"></times><ci id="algorithm1.9.9.m1.1.1.2.2.cmml" xref="algorithm1.9.9.m1.1.1.2.2">𝑙</ci><ci id="algorithm1.9.9.m1.1.1.2.3.cmml" xref="algorithm1.9.9.m1.1.1.2.3">𝑎</ci><ci id="algorithm1.9.9.m1.1.1.2.4.cmml" xref="algorithm1.9.9.m1.1.1.2.4">𝑏</ci><ci id="algorithm1.9.9.m1.1.1.2.5.cmml" xref="algorithm1.9.9.m1.1.1.2.5">𝑒</ci><ci id="algorithm1.9.9.m1.1.1.2.6.cmml" xref="algorithm1.9.9.m1.1.1.2.6">𝑙</ci></apply><cn id="algorithm1.9.9.m1.1.1.3.cmml" type="integer" xref="algorithm1.9.9.m1.1.1.3">0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="algorithm1.9.9.m1.1c">label=0</annotation><annotation encoding="application/x-llamapun" id="algorithm1.9.9.m1.1d">italic_l italic_a italic_b italic_e italic_l = 0</annotation></semantics></math>;
</div>
<div class="ltx_listingline" id="algorithm1.13.17">
<span class="ltx_tag ltx_tag_listingline">12</span>  <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>     <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>   

</div>
<div class="ltx_listingline" id="algorithm1.10.10">
<span class="ltx_tag ltx_tag_listingline">13</span>  <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>   <math alttext="\lambda_{pred}=Sigmoid(W\cdot D_{0}+B)" class="ltx_Math" display="inline" id="algorithm1.10.10.m1.1"><semantics id="algorithm1.10.10.m1.1a"><mrow id="algorithm1.10.10.m1.1.1" xref="algorithm1.10.10.m1.1.1.cmml"><msub id="algorithm1.10.10.m1.1.1.3" xref="algorithm1.10.10.m1.1.1.3.cmml"><mi id="algorithm1.10.10.m1.1.1.3.2" xref="algorithm1.10.10.m1.1.1.3.2.cmml">λ</mi><mrow id="algorithm1.10.10.m1.1.1.3.3" xref="algorithm1.10.10.m1.1.1.3.3.cmml"><mi id="algorithm1.10.10.m1.1.1.3.3.2" xref="algorithm1.10.10.m1.1.1.3.3.2.cmml">p</mi><mo id="algorithm1.10.10.m1.1.1.3.3.1" xref="algorithm1.10.10.m1.1.1.3.3.1.cmml">⁢</mo><mi id="algorithm1.10.10.m1.1.1.3.3.3" xref="algorithm1.10.10.m1.1.1.3.3.3.cmml">r</mi><mo id="algorithm1.10.10.m1.1.1.3.3.1a" xref="algorithm1.10.10.m1.1.1.3.3.1.cmml">⁢</mo><mi id="algorithm1.10.10.m1.1.1.3.3.4" xref="algorithm1.10.10.m1.1.1.3.3.4.cmml">e</mi><mo id="algorithm1.10.10.m1.1.1.3.3.1b" xref="algorithm1.10.10.m1.1.1.3.3.1.cmml">⁢</mo><mi id="algorithm1.10.10.m1.1.1.3.3.5" xref="algorithm1.10.10.m1.1.1.3.3.5.cmml">d</mi></mrow></msub><mo id="algorithm1.10.10.m1.1.1.2" xref="algorithm1.10.10.m1.1.1.2.cmml">=</mo><mrow id="algorithm1.10.10.m1.1.1.1" xref="algorithm1.10.10.m1.1.1.1.cmml"><mi id="algorithm1.10.10.m1.1.1.1.3" xref="algorithm1.10.10.m1.1.1.1.3.cmml">S</mi><mo id="algorithm1.10.10.m1.1.1.1.2" xref="algorithm1.10.10.m1.1.1.1.2.cmml">⁢</mo><mi id="algorithm1.10.10.m1.1.1.1.4" xref="algorithm1.10.10.m1.1.1.1.4.cmml">i</mi><mo id="algorithm1.10.10.m1.1.1.1.2a" xref="algorithm1.10.10.m1.1.1.1.2.cmml">⁢</mo><mi id="algorithm1.10.10.m1.1.1.1.5" xref="algorithm1.10.10.m1.1.1.1.5.cmml">g</mi><mo id="algorithm1.10.10.m1.1.1.1.2b" xref="algorithm1.10.10.m1.1.1.1.2.cmml">⁢</mo><mi id="algorithm1.10.10.m1.1.1.1.6" xref="algorithm1.10.10.m1.1.1.1.6.cmml">m</mi><mo id="algorithm1.10.10.m1.1.1.1.2c" xref="algorithm1.10.10.m1.1.1.1.2.cmml">⁢</mo><mi id="algorithm1.10.10.m1.1.1.1.7" xref="algorithm1.10.10.m1.1.1.1.7.cmml">o</mi><mo id="algorithm1.10.10.m1.1.1.1.2d" xref="algorithm1.10.10.m1.1.1.1.2.cmml">⁢</mo><mi id="algorithm1.10.10.m1.1.1.1.8" xref="algorithm1.10.10.m1.1.1.1.8.cmml">i</mi><mo id="algorithm1.10.10.m1.1.1.1.2e" xref="algorithm1.10.10.m1.1.1.1.2.cmml">⁢</mo><mi id="algorithm1.10.10.m1.1.1.1.9" xref="algorithm1.10.10.m1.1.1.1.9.cmml">d</mi><mo id="algorithm1.10.10.m1.1.1.1.2f" xref="algorithm1.10.10.m1.1.1.1.2.cmml">⁢</mo><mrow id="algorithm1.10.10.m1.1.1.1.1.1" xref="algorithm1.10.10.m1.1.1.1.1.1.1.cmml"><mo id="algorithm1.10.10.m1.1.1.1.1.1.2" stretchy="false" xref="algorithm1.10.10.m1.1.1.1.1.1.1.cmml">(</mo><mrow id="algorithm1.10.10.m1.1.1.1.1.1.1" xref="algorithm1.10.10.m1.1.1.1.1.1.1.cmml"><mrow id="algorithm1.10.10.m1.1.1.1.1.1.1.2" xref="algorithm1.10.10.m1.1.1.1.1.1.1.2.cmml"><mi id="algorithm1.10.10.m1.1.1.1.1.1.1.2.2" xref="algorithm1.10.10.m1.1.1.1.1.1.1.2.2.cmml">W</mi><mo id="algorithm1.10.10.m1.1.1.1.1.1.1.2.1" lspace="0.222em" rspace="0.222em" xref="algorithm1.10.10.m1.1.1.1.1.1.1.2.1.cmml">⋅</mo><msub id="algorithm1.10.10.m1.1.1.1.1.1.1.2.3" xref="algorithm1.10.10.m1.1.1.1.1.1.1.2.3.cmml"><mi id="algorithm1.10.10.m1.1.1.1.1.1.1.2.3.2" xref="algorithm1.10.10.m1.1.1.1.1.1.1.2.3.2.cmml">D</mi><mn id="algorithm1.10.10.m1.1.1.1.1.1.1.2.3.3" xref="algorithm1.10.10.m1.1.1.1.1.1.1.2.3.3.cmml">0</mn></msub></mrow><mo id="algorithm1.10.10.m1.1.1.1.1.1.1.1" xref="algorithm1.10.10.m1.1.1.1.1.1.1.1.cmml">+</mo><mi id="algorithm1.10.10.m1.1.1.1.1.1.1.3" xref="algorithm1.10.10.m1.1.1.1.1.1.1.3.cmml">B</mi></mrow><mo id="algorithm1.10.10.m1.1.1.1.1.1.3" stretchy="false" xref="algorithm1.10.10.m1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="algorithm1.10.10.m1.1b"><apply id="algorithm1.10.10.m1.1.1.cmml" xref="algorithm1.10.10.m1.1.1"><eq id="algorithm1.10.10.m1.1.1.2.cmml" xref="algorithm1.10.10.m1.1.1.2"></eq><apply id="algorithm1.10.10.m1.1.1.3.cmml" xref="algorithm1.10.10.m1.1.1.3"><csymbol cd="ambiguous" id="algorithm1.10.10.m1.1.1.3.1.cmml" xref="algorithm1.10.10.m1.1.1.3">subscript</csymbol><ci id="algorithm1.10.10.m1.1.1.3.2.cmml" xref="algorithm1.10.10.m1.1.1.3.2">𝜆</ci><apply id="algorithm1.10.10.m1.1.1.3.3.cmml" xref="algorithm1.10.10.m1.1.1.3.3"><times id="algorithm1.10.10.m1.1.1.3.3.1.cmml" xref="algorithm1.10.10.m1.1.1.3.3.1"></times><ci id="algorithm1.10.10.m1.1.1.3.3.2.cmml" xref="algorithm1.10.10.m1.1.1.3.3.2">𝑝</ci><ci id="algorithm1.10.10.m1.1.1.3.3.3.cmml" xref="algorithm1.10.10.m1.1.1.3.3.3">𝑟</ci><ci id="algorithm1.10.10.m1.1.1.3.3.4.cmml" xref="algorithm1.10.10.m1.1.1.3.3.4">𝑒</ci><ci id="algorithm1.10.10.m1.1.1.3.3.5.cmml" xref="algorithm1.10.10.m1.1.1.3.3.5">𝑑</ci></apply></apply><apply id="algorithm1.10.10.m1.1.1.1.cmml" xref="algorithm1.10.10.m1.1.1.1"><times id="algorithm1.10.10.m1.1.1.1.2.cmml" xref="algorithm1.10.10.m1.1.1.1.2"></times><ci id="algorithm1.10.10.m1.1.1.1.3.cmml" xref="algorithm1.10.10.m1.1.1.1.3">𝑆</ci><ci id="algorithm1.10.10.m1.1.1.1.4.cmml" xref="algorithm1.10.10.m1.1.1.1.4">𝑖</ci><ci id="algorithm1.10.10.m1.1.1.1.5.cmml" xref="algorithm1.10.10.m1.1.1.1.5">𝑔</ci><ci id="algorithm1.10.10.m1.1.1.1.6.cmml" xref="algorithm1.10.10.m1.1.1.1.6">𝑚</ci><ci id="algorithm1.10.10.m1.1.1.1.7.cmml" xref="algorithm1.10.10.m1.1.1.1.7">𝑜</ci><ci id="algorithm1.10.10.m1.1.1.1.8.cmml" xref="algorithm1.10.10.m1.1.1.1.8">𝑖</ci><ci id="algorithm1.10.10.m1.1.1.1.9.cmml" xref="algorithm1.10.10.m1.1.1.1.9">𝑑</ci><apply id="algorithm1.10.10.m1.1.1.1.1.1.1.cmml" xref="algorithm1.10.10.m1.1.1.1.1.1"><plus id="algorithm1.10.10.m1.1.1.1.1.1.1.1.cmml" xref="algorithm1.10.10.m1.1.1.1.1.1.1.1"></plus><apply id="algorithm1.10.10.m1.1.1.1.1.1.1.2.cmml" xref="algorithm1.10.10.m1.1.1.1.1.1.1.2"><ci id="algorithm1.10.10.m1.1.1.1.1.1.1.2.1.cmml" xref="algorithm1.10.10.m1.1.1.1.1.1.1.2.1">⋅</ci><ci id="algorithm1.10.10.m1.1.1.1.1.1.1.2.2.cmml" xref="algorithm1.10.10.m1.1.1.1.1.1.1.2.2">𝑊</ci><apply id="algorithm1.10.10.m1.1.1.1.1.1.1.2.3.cmml" xref="algorithm1.10.10.m1.1.1.1.1.1.1.2.3"><csymbol cd="ambiguous" id="algorithm1.10.10.m1.1.1.1.1.1.1.2.3.1.cmml" xref="algorithm1.10.10.m1.1.1.1.1.1.1.2.3">subscript</csymbol><ci id="algorithm1.10.10.m1.1.1.1.1.1.1.2.3.2.cmml" xref="algorithm1.10.10.m1.1.1.1.1.1.1.2.3.2">𝐷</ci><cn id="algorithm1.10.10.m1.1.1.1.1.1.1.2.3.3.cmml" type="integer" xref="algorithm1.10.10.m1.1.1.1.1.1.1.2.3.3">0</cn></apply></apply><ci id="algorithm1.10.10.m1.1.1.1.1.1.1.3.cmml" xref="algorithm1.10.10.m1.1.1.1.1.1.1.3">𝐵</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="algorithm1.10.10.m1.1c">\lambda_{pred}=Sigmoid(W\cdot D_{0}+B)</annotation><annotation encoding="application/x-llamapun" id="algorithm1.10.10.m1.1d">italic_λ start_POSTSUBSCRIPT italic_p italic_r italic_e italic_d end_POSTSUBSCRIPT = italic_S italic_i italic_g italic_m italic_o italic_i italic_d ( italic_W ⋅ italic_D start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT + italic_B )</annotation></semantics></math>;
</div>
<div class="ltx_listingline" id="algorithm1.11.11">
<span class="ltx_tag ltx_tag_listingline">14</span>  <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>   
<math alttext="loss\leftarrow CrossEntropy(\lambda_{pred},label)" class="ltx_Math" display="inline" id="algorithm1.11.11.m1.2"><semantics id="algorithm1.11.11.m1.2a"><mrow id="algorithm1.11.11.m1.2.2" xref="algorithm1.11.11.m1.2.2.cmml"><mrow id="algorithm1.11.11.m1.2.2.4" xref="algorithm1.11.11.m1.2.2.4.cmml"><mi id="algorithm1.11.11.m1.2.2.4.2" xref="algorithm1.11.11.m1.2.2.4.2.cmml">l</mi><mo id="algorithm1.11.11.m1.2.2.4.1" xref="algorithm1.11.11.m1.2.2.4.1.cmml">⁢</mo><mi id="algorithm1.11.11.m1.2.2.4.3" xref="algorithm1.11.11.m1.2.2.4.3.cmml">o</mi><mo id="algorithm1.11.11.m1.2.2.4.1a" xref="algorithm1.11.11.m1.2.2.4.1.cmml">⁢</mo><mi id="algorithm1.11.11.m1.2.2.4.4" xref="algorithm1.11.11.m1.2.2.4.4.cmml">s</mi><mo id="algorithm1.11.11.m1.2.2.4.1b" xref="algorithm1.11.11.m1.2.2.4.1.cmml">⁢</mo><mi id="algorithm1.11.11.m1.2.2.4.5" xref="algorithm1.11.11.m1.2.2.4.5.cmml">s</mi></mrow><mo id="algorithm1.11.11.m1.2.2.3" stretchy="false" xref="algorithm1.11.11.m1.2.2.3.cmml">←</mo><mrow id="algorithm1.11.11.m1.2.2.2" xref="algorithm1.11.11.m1.2.2.2.cmml"><mi id="algorithm1.11.11.m1.2.2.2.4" xref="algorithm1.11.11.m1.2.2.2.4.cmml">C</mi><mo id="algorithm1.11.11.m1.2.2.2.3" xref="algorithm1.11.11.m1.2.2.2.3.cmml">⁢</mo><mi id="algorithm1.11.11.m1.2.2.2.5" xref="algorithm1.11.11.m1.2.2.2.5.cmml">r</mi><mo id="algorithm1.11.11.m1.2.2.2.3a" xref="algorithm1.11.11.m1.2.2.2.3.cmml">⁢</mo><mi id="algorithm1.11.11.m1.2.2.2.6" xref="algorithm1.11.11.m1.2.2.2.6.cmml">o</mi><mo id="algorithm1.11.11.m1.2.2.2.3b" xref="algorithm1.11.11.m1.2.2.2.3.cmml">⁢</mo><mi id="algorithm1.11.11.m1.2.2.2.7" xref="algorithm1.11.11.m1.2.2.2.7.cmml">s</mi><mo id="algorithm1.11.11.m1.2.2.2.3c" xref="algorithm1.11.11.m1.2.2.2.3.cmml">⁢</mo><mi id="algorithm1.11.11.m1.2.2.2.8" xref="algorithm1.11.11.m1.2.2.2.8.cmml">s</mi><mo id="algorithm1.11.11.m1.2.2.2.3d" xref="algorithm1.11.11.m1.2.2.2.3.cmml">⁢</mo><mi id="algorithm1.11.11.m1.2.2.2.9" xref="algorithm1.11.11.m1.2.2.2.9.cmml">E</mi><mo id="algorithm1.11.11.m1.2.2.2.3e" xref="algorithm1.11.11.m1.2.2.2.3.cmml">⁢</mo><mi id="algorithm1.11.11.m1.2.2.2.10" xref="algorithm1.11.11.m1.2.2.2.10.cmml">n</mi><mo id="algorithm1.11.11.m1.2.2.2.3f" xref="algorithm1.11.11.m1.2.2.2.3.cmml">⁢</mo><mi id="algorithm1.11.11.m1.2.2.2.11" xref="algorithm1.11.11.m1.2.2.2.11.cmml">t</mi><mo id="algorithm1.11.11.m1.2.2.2.3g" xref="algorithm1.11.11.m1.2.2.2.3.cmml">⁢</mo><mi id="algorithm1.11.11.m1.2.2.2.12" xref="algorithm1.11.11.m1.2.2.2.12.cmml">r</mi><mo id="algorithm1.11.11.m1.2.2.2.3h" xref="algorithm1.11.11.m1.2.2.2.3.cmml">⁢</mo><mi id="algorithm1.11.11.m1.2.2.2.13" xref="algorithm1.11.11.m1.2.2.2.13.cmml">o</mi><mo id="algorithm1.11.11.m1.2.2.2.3i" xref="algorithm1.11.11.m1.2.2.2.3.cmml">⁢</mo><mi id="algorithm1.11.11.m1.2.2.2.14" xref="algorithm1.11.11.m1.2.2.2.14.cmml">p</mi><mo id="algorithm1.11.11.m1.2.2.2.3j" xref="algorithm1.11.11.m1.2.2.2.3.cmml">⁢</mo><mi id="algorithm1.11.11.m1.2.2.2.15" xref="algorithm1.11.11.m1.2.2.2.15.cmml">y</mi><mo id="algorithm1.11.11.m1.2.2.2.3k" xref="algorithm1.11.11.m1.2.2.2.3.cmml">⁢</mo><mrow id="algorithm1.11.11.m1.2.2.2.2.2" xref="algorithm1.11.11.m1.2.2.2.2.3.cmml"><mo id="algorithm1.11.11.m1.2.2.2.2.2.3" stretchy="false" xref="algorithm1.11.11.m1.2.2.2.2.3.cmml">(</mo><msub id="algorithm1.11.11.m1.1.1.1.1.1.1" xref="algorithm1.11.11.m1.1.1.1.1.1.1.cmml"><mi id="algorithm1.11.11.m1.1.1.1.1.1.1.2" xref="algorithm1.11.11.m1.1.1.1.1.1.1.2.cmml">λ</mi><mrow id="algorithm1.11.11.m1.1.1.1.1.1.1.3" xref="algorithm1.11.11.m1.1.1.1.1.1.1.3.cmml"><mi id="algorithm1.11.11.m1.1.1.1.1.1.1.3.2" xref="algorithm1.11.11.m1.1.1.1.1.1.1.3.2.cmml">p</mi><mo id="algorithm1.11.11.m1.1.1.1.1.1.1.3.1" xref="algorithm1.11.11.m1.1.1.1.1.1.1.3.1.cmml">⁢</mo><mi id="algorithm1.11.11.m1.1.1.1.1.1.1.3.3" xref="algorithm1.11.11.m1.1.1.1.1.1.1.3.3.cmml">r</mi><mo id="algorithm1.11.11.m1.1.1.1.1.1.1.3.1a" xref="algorithm1.11.11.m1.1.1.1.1.1.1.3.1.cmml">⁢</mo><mi id="algorithm1.11.11.m1.1.1.1.1.1.1.3.4" xref="algorithm1.11.11.m1.1.1.1.1.1.1.3.4.cmml">e</mi><mo id="algorithm1.11.11.m1.1.1.1.1.1.1.3.1b" xref="algorithm1.11.11.m1.1.1.1.1.1.1.3.1.cmml">⁢</mo><mi id="algorithm1.11.11.m1.1.1.1.1.1.1.3.5" xref="algorithm1.11.11.m1.1.1.1.1.1.1.3.5.cmml">d</mi></mrow></msub><mo id="algorithm1.11.11.m1.2.2.2.2.2.4" xref="algorithm1.11.11.m1.2.2.2.2.3.cmml">,</mo><mrow id="algorithm1.11.11.m1.2.2.2.2.2.2" xref="algorithm1.11.11.m1.2.2.2.2.2.2.cmml"><mi id="algorithm1.11.11.m1.2.2.2.2.2.2.2" xref="algorithm1.11.11.m1.2.2.2.2.2.2.2.cmml">l</mi><mo id="algorithm1.11.11.m1.2.2.2.2.2.2.1" xref="algorithm1.11.11.m1.2.2.2.2.2.2.1.cmml">⁢</mo><mi id="algorithm1.11.11.m1.2.2.2.2.2.2.3" xref="algorithm1.11.11.m1.2.2.2.2.2.2.3.cmml">a</mi><mo id="algorithm1.11.11.m1.2.2.2.2.2.2.1a" xref="algorithm1.11.11.m1.2.2.2.2.2.2.1.cmml">⁢</mo><mi id="algorithm1.11.11.m1.2.2.2.2.2.2.4" xref="algorithm1.11.11.m1.2.2.2.2.2.2.4.cmml">b</mi><mo id="algorithm1.11.11.m1.2.2.2.2.2.2.1b" xref="algorithm1.11.11.m1.2.2.2.2.2.2.1.cmml">⁢</mo><mi id="algorithm1.11.11.m1.2.2.2.2.2.2.5" xref="algorithm1.11.11.m1.2.2.2.2.2.2.5.cmml">e</mi><mo id="algorithm1.11.11.m1.2.2.2.2.2.2.1c" xref="algorithm1.11.11.m1.2.2.2.2.2.2.1.cmml">⁢</mo><mi id="algorithm1.11.11.m1.2.2.2.2.2.2.6" xref="algorithm1.11.11.m1.2.2.2.2.2.2.6.cmml">l</mi></mrow><mo id="algorithm1.11.11.m1.2.2.2.2.2.5" stretchy="false" xref="algorithm1.11.11.m1.2.2.2.2.3.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="algorithm1.11.11.m1.2b"><apply id="algorithm1.11.11.m1.2.2.cmml" xref="algorithm1.11.11.m1.2.2"><ci id="algorithm1.11.11.m1.2.2.3.cmml" xref="algorithm1.11.11.m1.2.2.3">←</ci><apply id="algorithm1.11.11.m1.2.2.4.cmml" xref="algorithm1.11.11.m1.2.2.4"><times id="algorithm1.11.11.m1.2.2.4.1.cmml" xref="algorithm1.11.11.m1.2.2.4.1"></times><ci id="algorithm1.11.11.m1.2.2.4.2.cmml" xref="algorithm1.11.11.m1.2.2.4.2">𝑙</ci><ci id="algorithm1.11.11.m1.2.2.4.3.cmml" xref="algorithm1.11.11.m1.2.2.4.3">𝑜</ci><ci id="algorithm1.11.11.m1.2.2.4.4.cmml" xref="algorithm1.11.11.m1.2.2.4.4">𝑠</ci><ci id="algorithm1.11.11.m1.2.2.4.5.cmml" xref="algorithm1.11.11.m1.2.2.4.5">𝑠</ci></apply><apply id="algorithm1.11.11.m1.2.2.2.cmml" xref="algorithm1.11.11.m1.2.2.2"><times id="algorithm1.11.11.m1.2.2.2.3.cmml" xref="algorithm1.11.11.m1.2.2.2.3"></times><ci id="algorithm1.11.11.m1.2.2.2.4.cmml" xref="algorithm1.11.11.m1.2.2.2.4">𝐶</ci><ci id="algorithm1.11.11.m1.2.2.2.5.cmml" xref="algorithm1.11.11.m1.2.2.2.5">𝑟</ci><ci id="algorithm1.11.11.m1.2.2.2.6.cmml" xref="algorithm1.11.11.m1.2.2.2.6">𝑜</ci><ci id="algorithm1.11.11.m1.2.2.2.7.cmml" xref="algorithm1.11.11.m1.2.2.2.7">𝑠</ci><ci id="algorithm1.11.11.m1.2.2.2.8.cmml" xref="algorithm1.11.11.m1.2.2.2.8">𝑠</ci><ci id="algorithm1.11.11.m1.2.2.2.9.cmml" xref="algorithm1.11.11.m1.2.2.2.9">𝐸</ci><ci id="algorithm1.11.11.m1.2.2.2.10.cmml" xref="algorithm1.11.11.m1.2.2.2.10">𝑛</ci><ci id="algorithm1.11.11.m1.2.2.2.11.cmml" xref="algorithm1.11.11.m1.2.2.2.11">𝑡</ci><ci id="algorithm1.11.11.m1.2.2.2.12.cmml" xref="algorithm1.11.11.m1.2.2.2.12">𝑟</ci><ci id="algorithm1.11.11.m1.2.2.2.13.cmml" xref="algorithm1.11.11.m1.2.2.2.13">𝑜</ci><ci id="algorithm1.11.11.m1.2.2.2.14.cmml" xref="algorithm1.11.11.m1.2.2.2.14">𝑝</ci><ci id="algorithm1.11.11.m1.2.2.2.15.cmml" xref="algorithm1.11.11.m1.2.2.2.15">𝑦</ci><interval closure="open" id="algorithm1.11.11.m1.2.2.2.2.3.cmml" xref="algorithm1.11.11.m1.2.2.2.2.2"><apply id="algorithm1.11.11.m1.1.1.1.1.1.1.cmml" xref="algorithm1.11.11.m1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="algorithm1.11.11.m1.1.1.1.1.1.1.1.cmml" xref="algorithm1.11.11.m1.1.1.1.1.1.1">subscript</csymbol><ci id="algorithm1.11.11.m1.1.1.1.1.1.1.2.cmml" xref="algorithm1.11.11.m1.1.1.1.1.1.1.2">𝜆</ci><apply id="algorithm1.11.11.m1.1.1.1.1.1.1.3.cmml" xref="algorithm1.11.11.m1.1.1.1.1.1.1.3"><times id="algorithm1.11.11.m1.1.1.1.1.1.1.3.1.cmml" xref="algorithm1.11.11.m1.1.1.1.1.1.1.3.1"></times><ci id="algorithm1.11.11.m1.1.1.1.1.1.1.3.2.cmml" xref="algorithm1.11.11.m1.1.1.1.1.1.1.3.2">𝑝</ci><ci id="algorithm1.11.11.m1.1.1.1.1.1.1.3.3.cmml" xref="algorithm1.11.11.m1.1.1.1.1.1.1.3.3">𝑟</ci><ci id="algorithm1.11.11.m1.1.1.1.1.1.1.3.4.cmml" xref="algorithm1.11.11.m1.1.1.1.1.1.1.3.4">𝑒</ci><ci id="algorithm1.11.11.m1.1.1.1.1.1.1.3.5.cmml" xref="algorithm1.11.11.m1.1.1.1.1.1.1.3.5">𝑑</ci></apply></apply><apply id="algorithm1.11.11.m1.2.2.2.2.2.2.cmml" xref="algorithm1.11.11.m1.2.2.2.2.2.2"><times id="algorithm1.11.11.m1.2.2.2.2.2.2.1.cmml" xref="algorithm1.11.11.m1.2.2.2.2.2.2.1"></times><ci id="algorithm1.11.11.m1.2.2.2.2.2.2.2.cmml" xref="algorithm1.11.11.m1.2.2.2.2.2.2.2">𝑙</ci><ci id="algorithm1.11.11.m1.2.2.2.2.2.2.3.cmml" xref="algorithm1.11.11.m1.2.2.2.2.2.2.3">𝑎</ci><ci id="algorithm1.11.11.m1.2.2.2.2.2.2.4.cmml" xref="algorithm1.11.11.m1.2.2.2.2.2.2.4">𝑏</ci><ci id="algorithm1.11.11.m1.2.2.2.2.2.2.5.cmml" xref="algorithm1.11.11.m1.2.2.2.2.2.2.5">𝑒</ci><ci id="algorithm1.11.11.m1.2.2.2.2.2.2.6.cmml" xref="algorithm1.11.11.m1.2.2.2.2.2.2.6">𝑙</ci></apply></interval></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="algorithm1.11.11.m1.2c">loss\leftarrow CrossEntropy(\lambda_{pred},label)</annotation><annotation encoding="application/x-llamapun" id="algorithm1.11.11.m1.2d">italic_l italic_o italic_s italic_s ← italic_C italic_r italic_o italic_s italic_s italic_E italic_n italic_t italic_r italic_o italic_p italic_y ( italic_λ start_POSTSUBSCRIPT italic_p italic_r italic_e italic_d end_POSTSUBSCRIPT , italic_l italic_a italic_b italic_e italic_l )</annotation></semantics></math>;
</div>
<div class="ltx_listingline" id="algorithm1.12.12">
<span class="ltx_tag ltx_tag_listingline">15</span>  <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>   
update <math alttext="W,B" class="ltx_Math" display="inline" id="algorithm1.12.12.m1.2"><semantics id="algorithm1.12.12.m1.2a"><mrow id="algorithm1.12.12.m1.2.3.2" xref="algorithm1.12.12.m1.2.3.1.cmml"><mi id="algorithm1.12.12.m1.1.1" xref="algorithm1.12.12.m1.1.1.cmml">W</mi><mo id="algorithm1.12.12.m1.2.3.2.1" xref="algorithm1.12.12.m1.2.3.1.cmml">,</mo><mi id="algorithm1.12.12.m1.2.2" xref="algorithm1.12.12.m1.2.2.cmml">B</mi></mrow><annotation-xml encoding="MathML-Content" id="algorithm1.12.12.m1.2b"><list id="algorithm1.12.12.m1.2.3.1.cmml" xref="algorithm1.12.12.m1.2.3.2"><ci id="algorithm1.12.12.m1.1.1.cmml" xref="algorithm1.12.12.m1.1.1">𝑊</ci><ci id="algorithm1.12.12.m1.2.2.cmml" xref="algorithm1.12.12.m1.2.2">𝐵</ci></list></annotation-xml><annotation encoding="application/x-tex" id="algorithm1.12.12.m1.2c">W,B</annotation><annotation encoding="application/x-llamapun" id="algorithm1.12.12.m1.2d">italic_W , italic_B</annotation></semantics></math>;
</div>
<div class="ltx_listingline" id="algorithm1.13.13">
<span class="ltx_tag ltx_tag_listingline">16</span>  <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>   
<math alttext="t=t+1" class="ltx_Math" display="inline" id="algorithm1.13.13.m1.1"><semantics id="algorithm1.13.13.m1.1a"><mrow id="algorithm1.13.13.m1.1.1" xref="algorithm1.13.13.m1.1.1.cmml"><mi id="algorithm1.13.13.m1.1.1.2" xref="algorithm1.13.13.m1.1.1.2.cmml">t</mi><mo id="algorithm1.13.13.m1.1.1.1" xref="algorithm1.13.13.m1.1.1.1.cmml">=</mo><mrow id="algorithm1.13.13.m1.1.1.3" xref="algorithm1.13.13.m1.1.1.3.cmml"><mi id="algorithm1.13.13.m1.1.1.3.2" xref="algorithm1.13.13.m1.1.1.3.2.cmml">t</mi><mo id="algorithm1.13.13.m1.1.1.3.1" xref="algorithm1.13.13.m1.1.1.3.1.cmml">+</mo><mn id="algorithm1.13.13.m1.1.1.3.3" xref="algorithm1.13.13.m1.1.1.3.3.cmml">1</mn></mrow></mrow><annotation-xml encoding="MathML-Content" id="algorithm1.13.13.m1.1b"><apply id="algorithm1.13.13.m1.1.1.cmml" xref="algorithm1.13.13.m1.1.1"><eq id="algorithm1.13.13.m1.1.1.1.cmml" xref="algorithm1.13.13.m1.1.1.1"></eq><ci id="algorithm1.13.13.m1.1.1.2.cmml" xref="algorithm1.13.13.m1.1.1.2">𝑡</ci><apply id="algorithm1.13.13.m1.1.1.3.cmml" xref="algorithm1.13.13.m1.1.1.3"><plus id="algorithm1.13.13.m1.1.1.3.1.cmml" xref="algorithm1.13.13.m1.1.1.3.1"></plus><ci id="algorithm1.13.13.m1.1.1.3.2.cmml" xref="algorithm1.13.13.m1.1.1.3.2">𝑡</ci><cn id="algorithm1.13.13.m1.1.1.3.3.cmml" type="integer" xref="algorithm1.13.13.m1.1.1.3.3">1</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="algorithm1.13.13.m1.1c">t=t+1</annotation><annotation encoding="application/x-llamapun" id="algorithm1.13.13.m1.1d">italic_t = italic_t + 1</annotation></semantics></math>;
</div>
<div class="ltx_listingline" id="algorithm1.13.18">
<span class="ltx_tag ltx_tag_listingline">17</span>  <span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span>   

</div>
<div class="ltx_listingline" id="algorithm1.13.19">
</div>
</div>
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_float"><span class="ltx_text ltx_font_bold" id="algorithm1.15.1.1">Algorithm 1</span> </span>Training Interpolation Layer</figcaption>
</figure>
<div class="ltx_para" id="S3.p4">
<p class="ltx_p" id="S3.p4.3">As shown in Algorithm <a class="ltx_ref" href="https://arxiv.org/html/2407.19965v2#algorithm1" title="In 3 Single-Layer Trainable Interpolation ‣ Simply Trainable Nearest Neighbour Machine Translation with GPU Inference"><span class="ltx_text ltx_ref_tag">1</span></a>, our training procedure is divided into two stages at each decoding step.
The first stage examines the probability of the ground truth token in both distributions <math alttext="P_{knn}" class="ltx_Math" display="inline" id="S3.p4.1.m1.1"><semantics id="S3.p4.1.m1.1a"><msub id="S3.p4.1.m1.1.1" xref="S3.p4.1.m1.1.1.cmml"><mi id="S3.p4.1.m1.1.1.2" xref="S3.p4.1.m1.1.1.2.cmml">P</mi><mrow id="S3.p4.1.m1.1.1.3" xref="S3.p4.1.m1.1.1.3.cmml"><mi id="S3.p4.1.m1.1.1.3.2" xref="S3.p4.1.m1.1.1.3.2.cmml">k</mi><mo id="S3.p4.1.m1.1.1.3.1" xref="S3.p4.1.m1.1.1.3.1.cmml">⁢</mo><mi id="S3.p4.1.m1.1.1.3.3" xref="S3.p4.1.m1.1.1.3.3.cmml">n</mi><mo id="S3.p4.1.m1.1.1.3.1a" xref="S3.p4.1.m1.1.1.3.1.cmml">⁢</mo><mi id="S3.p4.1.m1.1.1.3.4" xref="S3.p4.1.m1.1.1.3.4.cmml">n</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S3.p4.1.m1.1b"><apply id="S3.p4.1.m1.1.1.cmml" xref="S3.p4.1.m1.1.1"><csymbol cd="ambiguous" id="S3.p4.1.m1.1.1.1.cmml" xref="S3.p4.1.m1.1.1">subscript</csymbol><ci id="S3.p4.1.m1.1.1.2.cmml" xref="S3.p4.1.m1.1.1.2">𝑃</ci><apply id="S3.p4.1.m1.1.1.3.cmml" xref="S3.p4.1.m1.1.1.3"><times id="S3.p4.1.m1.1.1.3.1.cmml" xref="S3.p4.1.m1.1.1.3.1"></times><ci id="S3.p4.1.m1.1.1.3.2.cmml" xref="S3.p4.1.m1.1.1.3.2">𝑘</ci><ci id="S3.p4.1.m1.1.1.3.3.cmml" xref="S3.p4.1.m1.1.1.3.3">𝑛</ci><ci id="S3.p4.1.m1.1.1.3.4.cmml" xref="S3.p4.1.m1.1.1.3.4">𝑛</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p4.1.m1.1c">P_{knn}</annotation><annotation encoding="application/x-llamapun" id="S3.p4.1.m1.1d">italic_P start_POSTSUBSCRIPT italic_k italic_n italic_n end_POSTSUBSCRIPT</annotation></semantics></math> and <math alttext="P_{mt}" class="ltx_Math" display="inline" id="S3.p4.2.m2.1"><semantics id="S3.p4.2.m2.1a"><msub id="S3.p4.2.m2.1.1" xref="S3.p4.2.m2.1.1.cmml"><mi id="S3.p4.2.m2.1.1.2" xref="S3.p4.2.m2.1.1.2.cmml">P</mi><mrow id="S3.p4.2.m2.1.1.3" xref="S3.p4.2.m2.1.1.3.cmml"><mi id="S3.p4.2.m2.1.1.3.2" xref="S3.p4.2.m2.1.1.3.2.cmml">m</mi><mo id="S3.p4.2.m2.1.1.3.1" xref="S3.p4.2.m2.1.1.3.1.cmml">⁢</mo><mi id="S3.p4.2.m2.1.1.3.3" xref="S3.p4.2.m2.1.1.3.3.cmml">t</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S3.p4.2.m2.1b"><apply id="S3.p4.2.m2.1.1.cmml" xref="S3.p4.2.m2.1.1"><csymbol cd="ambiguous" id="S3.p4.2.m2.1.1.1.cmml" xref="S3.p4.2.m2.1.1">subscript</csymbol><ci id="S3.p4.2.m2.1.1.2.cmml" xref="S3.p4.2.m2.1.1.2">𝑃</ci><apply id="S3.p4.2.m2.1.1.3.cmml" xref="S3.p4.2.m2.1.1.3"><times id="S3.p4.2.m2.1.1.3.1.cmml" xref="S3.p4.2.m2.1.1.3.1"></times><ci id="S3.p4.2.m2.1.1.3.2.cmml" xref="S3.p4.2.m2.1.1.3.2">𝑚</ci><ci id="S3.p4.2.m2.1.1.3.3.cmml" xref="S3.p4.2.m2.1.1.3.3">𝑡</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p4.2.m2.1c">P_{mt}</annotation><annotation encoding="application/x-llamapun" id="S3.p4.2.m2.1d">italic_P start_POSTSUBSCRIPT italic_m italic_t end_POSTSUBSCRIPT</annotation></semantics></math>. If the probability of the ground truth token <math alttext="P_{knn}" class="ltx_Math" display="inline" id="S3.p4.3.m3.1"><semantics id="S3.p4.3.m3.1a"><msub id="S3.p4.3.m3.1.1" xref="S3.p4.3.m3.1.1.cmml"><mi id="S3.p4.3.m3.1.1.2" xref="S3.p4.3.m3.1.1.2.cmml">P</mi><mrow id="S3.p4.3.m3.1.1.3" xref="S3.p4.3.m3.1.1.3.cmml"><mi id="S3.p4.3.m3.1.1.3.2" xref="S3.p4.3.m3.1.1.3.2.cmml">k</mi><mo id="S3.p4.3.m3.1.1.3.1" xref="S3.p4.3.m3.1.1.3.1.cmml">⁢</mo><mi id="S3.p4.3.m3.1.1.3.3" xref="S3.p4.3.m3.1.1.3.3.cmml">n</mi><mo id="S3.p4.3.m3.1.1.3.1a" xref="S3.p4.3.m3.1.1.3.1.cmml">⁢</mo><mi id="S3.p4.3.m3.1.1.3.4" xref="S3.p4.3.m3.1.1.3.4.cmml">n</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S3.p4.3.m3.1b"><apply id="S3.p4.3.m3.1.1.cmml" xref="S3.p4.3.m3.1.1"><csymbol cd="ambiguous" id="S3.p4.3.m3.1.1.1.cmml" xref="S3.p4.3.m3.1.1">subscript</csymbol><ci id="S3.p4.3.m3.1.1.2.cmml" xref="S3.p4.3.m3.1.1.2">𝑃</ci><apply id="S3.p4.3.m3.1.1.3.cmml" xref="S3.p4.3.m3.1.1.3"><times id="S3.p4.3.m3.1.1.3.1.cmml" xref="S3.p4.3.m3.1.1.3.1"></times><ci id="S3.p4.3.m3.1.1.3.2.cmml" xref="S3.p4.3.m3.1.1.3.2">𝑘</ci><ci id="S3.p4.3.m3.1.1.3.3.cmml" xref="S3.p4.3.m3.1.1.3.3">𝑛</ci><ci id="S3.p4.3.m3.1.1.3.4.cmml" xref="S3.p4.3.m3.1.1.3.4">𝑛</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p4.3.m3.1c">P_{knn}</annotation><annotation encoding="application/x-llamapun" id="S3.p4.3.m3.1d">italic_P start_POSTSUBSCRIPT italic_k italic_n italic_n end_POSTSUBSCRIPT</annotation></semantics></math> is higher then we set the label to 1 otherwise we set the label to 0. The second stage trains our single-layer network using binary loss.</p>
</div>
<figure class="ltx_table" id="S3.T2">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_table">Table 2: </span>Translation quality of the proposed method versus other methods at Beam=5 and K=2.</figcaption>
<table class="ltx_tabular ltx_guessed_headers ltx_align_middle" id="S3.T2.1">
<thead class="ltx_thead">
<tr class="ltx_tr" id="S3.T2.1.1.1">
<th class="ltx_td ltx_nopad_l ltx_align_justify ltx_th ltx_th_column ltx_border_tt ltx_border_t" id="S3.T2.1.1.1.1">
<span class="ltx_rule" style="width:1.5pt;background:black;display:inline-block;"> </span>  
<span class="ltx_inline-block ltx_align_top" id="S3.T2.1.1.1.1.1">
<span class="ltx_p" id="S3.T2.1.1.1.1.1.1"><span class="ltx_text ltx_font_bold" id="S3.T2.1.1.1.1.1.1.1">Domain</span></span>
</span>  <span class="ltx_rule" style="width:1.5pt;background:black;display:inline-block;"> </span>
</th>
<th class="ltx_td ltx_align_right ltx_th ltx_th_column ltx_border_tt ltx_border_t" colspan="3" id="S3.T2.1.1.1.2">
<span class="ltx_text ltx_font_bold" id="S3.T2.1.1.1.2.1">BLEU</span>   <span class="ltx_rule" style="width:1.5pt;background:black;display:inline-block;"> </span>
</th>
<th class="ltx_td ltx_align_right ltx_th ltx_th_column ltx_border_tt ltx_border_t" colspan="3" id="S3.T2.1.1.1.3">
<span class="ltx_text ltx_font_bold" id="S3.T2.1.1.1.3.1">WMT22-COMET-da</span>   <span class="ltx_rule" style="width:1.5pt;background:black;display:inline-block;"> </span>
</th>
</tr>
<tr class="ltx_tr" id="S3.T2.1.2.2">
<th class="ltx_td ltx_nopad_l ltx_align_justify ltx_th ltx_th_column" id="S3.T2.1.2.2.1">
<span class="ltx_rule" style="width:1.5pt;background:black;display:inline-block;"> </span>    <span class="ltx_rule" style="width:1.5pt;background:black;display:inline-block;"> </span>
</th>
<th class="ltx_td ltx_align_right ltx_th ltx_th_column ltx_border_t" id="S3.T2.1.2.2.2">
<span class="ltx_text ltx_font_bold" id="S3.T2.1.2.2.2.1">NMT</span>   <span class="ltx_rule" style="width:1.5pt;background:black;display:inline-block;"> </span>
</th>
<th class="ltx_td ltx_align_right ltx_th ltx_th_column ltx_border_t" id="S3.T2.1.2.2.3">
<span class="ltx_text ltx_font_bold" id="S3.T2.1.2.2.3.1">SK-MT</span>   <span class="ltx_rule" style="width:1.5pt;background:black;display:inline-block;"> </span>
</th>
<th class="ltx_td ltx_align_right ltx_th ltx_th_column ltx_border_t" id="S3.T2.1.2.2.4">
<span class="ltx_text ltx_font_bold" id="S3.T2.1.2.2.4.1">Trainable</span>   <span class="ltx_rule" style="width:1.5pt;background:black;display:inline-block;"> </span>
</th>
<th class="ltx_td ltx_align_right ltx_th ltx_th_column ltx_border_t" id="S3.T2.1.2.2.5">
<span class="ltx_text ltx_font_bold" id="S3.T2.1.2.2.5.1">NMT</span>   <span class="ltx_rule" style="width:1.5pt;background:black;display:inline-block;"> </span>
</th>
<th class="ltx_td ltx_align_right ltx_th ltx_th_column ltx_border_t" id="S3.T2.1.2.2.6">
<span class="ltx_text ltx_font_bold" id="S3.T2.1.2.2.6.1">SK-MT</span>   <span class="ltx_rule" style="width:1.5pt;background:black;display:inline-block;"> </span>
</th>
<th class="ltx_td ltx_align_right ltx_th ltx_th_column ltx_border_t" id="S3.T2.1.2.2.7">
<span class="ltx_text ltx_font_bold" id="S3.T2.1.2.2.7.1">Trainable</span>   <span class="ltx_rule" style="width:1.5pt;background:black;display:inline-block;"> </span>
</th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr class="ltx_tr" id="S3.T2.1.3.1">
<td class="ltx_td ltx_nopad_l ltx_align_justify ltx_border_t" id="S3.T2.1.3.1.1">
<span class="ltx_rule" style="width:1.5pt;background:black;display:inline-block;"> </span>  
<span class="ltx_inline-block ltx_align_top" id="S3.T2.1.3.1.1.1">
<span class="ltx_p" id="S3.T2.1.3.1.1.1.1">IT</span>
</span>  <span class="ltx_rule" style="width:1.5pt;background:black;display:inline-block;"> </span>
</td>
<td class="ltx_td ltx_align_justify ltx_border_t" id="S3.T2.1.3.1.2">
<span class="ltx_inline-block ltx_align_top" id="S3.T2.1.3.1.2.1">
<span class="ltx_p" id="S3.T2.1.3.1.2.1.1">38</span>
</span>  <span class="ltx_rule" style="width:1.5pt;background:black;display:inline-block;"> </span>
</td>
<td class="ltx_td ltx_align_right ltx_border_t" id="S3.T2.1.3.1.3">45.5   <span class="ltx_rule" style="width:1.5pt;background:black;display:inline-block;"> </span>
</td>
<td class="ltx_td ltx_align_justify ltx_border_t" id="S3.T2.1.3.1.4">
<span class="ltx_inline-block ltx_align_top" id="S3.T2.1.3.1.4.1">
<span class="ltx_p" id="S3.T2.1.3.1.4.1.1">46.1</span>
</span>  <span class="ltx_rule" style="width:1.5pt;background:black;display:inline-block;"> </span>
</td>
<td class="ltx_td ltx_align_right ltx_border_t" id="S3.T2.1.3.1.5">83.0   <span class="ltx_rule" style="width:1.5pt;background:black;display:inline-block;"> </span>
</td>
<td class="ltx_td ltx_align_justify ltx_border_t" id="S3.T2.1.3.1.6">
<span class="ltx_inline-block ltx_align_top" id="S3.T2.1.3.1.6.1">
<span class="ltx_p" id="S3.T2.1.3.1.6.1.1">85.0</span>
</span>  <span class="ltx_rule" style="width:1.5pt;background:black;display:inline-block;"> </span>
</td>
<td class="ltx_td ltx_align_justify ltx_border_t" id="S3.T2.1.3.1.7">
<span class="ltx_inline-block ltx_align_top" id="S3.T2.1.3.1.7.1">
<span class="ltx_p" id="S3.T2.1.3.1.7.1.1">85.0</span>
</span>  <span class="ltx_rule" style="width:1.5pt;background:black;display:inline-block;"> </span>
</td>
</tr>
<tr class="ltx_tr" id="S3.T2.1.4.2">
<td class="ltx_td ltx_nopad_l ltx_align_justify ltx_border_t" id="S3.T2.1.4.2.1">
<span class="ltx_rule" style="width:1.5pt;background:black;display:inline-block;"> </span>  
<span class="ltx_inline-block ltx_align_top" id="S3.T2.1.4.2.1.1">
<span class="ltx_p" id="S3.T2.1.4.2.1.1.1">Law</span>
</span>  <span class="ltx_rule" style="width:1.5pt;background:black;display:inline-block;"> </span>
</td>
<td class="ltx_td ltx_align_justify ltx_border_t" id="S3.T2.1.4.2.2">
<span class="ltx_inline-block ltx_align_top" id="S3.T2.1.4.2.2.1">
<span class="ltx_p" id="S3.T2.1.4.2.2.1.1">49.6</span>
</span>  <span class="ltx_rule" style="width:1.5pt;background:black;display:inline-block;"> </span>
</td>
<td class="ltx_td ltx_align_right ltx_border_t" id="S3.T2.1.4.2.3">62.8   <span class="ltx_rule" style="width:1.5pt;background:black;display:inline-block;"> </span>
</td>
<td class="ltx_td ltx_align_justify ltx_border_t" id="S3.T2.1.4.2.4">
<span class="ltx_inline-block ltx_align_top" id="S3.T2.1.4.2.4.1">
<span class="ltx_p" id="S3.T2.1.4.2.4.1.1">62.7</span>
</span>  <span class="ltx_rule" style="width:1.5pt;background:black;display:inline-block;"> </span>
</td>
<td class="ltx_td ltx_align_right ltx_border_t" id="S3.T2.1.4.2.5">86.7   <span class="ltx_rule" style="width:1.5pt;background:black;display:inline-block;"> </span>
</td>
<td class="ltx_td ltx_align_justify ltx_border_t" id="S3.T2.1.4.2.6">
<span class="ltx_inline-block ltx_align_top" id="S3.T2.1.4.2.6.1">
<span class="ltx_p" id="S3.T2.1.4.2.6.1.1">88.3</span>
</span>  <span class="ltx_rule" style="width:1.5pt;background:black;display:inline-block;"> </span>
</td>
<td class="ltx_td ltx_align_justify ltx_border_t" id="S3.T2.1.4.2.7">
<span class="ltx_inline-block ltx_align_top" id="S3.T2.1.4.2.7.1">
<span class="ltx_p" id="S3.T2.1.4.2.7.1.1">88.0</span>
</span>  <span class="ltx_rule" style="width:1.5pt;background:black;display:inline-block;"> </span>
</td>
</tr>
<tr class="ltx_tr" id="S3.T2.1.5.3">
<td class="ltx_td ltx_nopad_l ltx_align_justify ltx_border_t" id="S3.T2.1.5.3.1">
<span class="ltx_rule" style="width:1.5pt;background:black;display:inline-block;"> </span>  
<span class="ltx_inline-block ltx_align_top" id="S3.T2.1.5.3.1.1">
<span class="ltx_p" id="S3.T2.1.5.3.1.1.1">Koran</span>
</span>  <span class="ltx_rule" style="width:1.5pt;background:black;display:inline-block;"> </span>
</td>
<td class="ltx_td ltx_align_justify ltx_border_t" id="S3.T2.1.5.3.2">
<span class="ltx_inline-block ltx_align_top" id="S3.T2.1.5.3.2.1">
<span class="ltx_p" id="S3.T2.1.5.3.2.1.1">12.2</span>
</span>  <span class="ltx_rule" style="width:1.5pt;background:black;display:inline-block;"> </span>
</td>
<td class="ltx_td ltx_align_right ltx_border_t" id="S3.T2.1.5.3.3">15.5   <span class="ltx_rule" style="width:1.5pt;background:black;display:inline-block;"> </span>
</td>
<td class="ltx_td ltx_align_justify ltx_border_t" id="S3.T2.1.5.3.4">
<span class="ltx_inline-block ltx_align_top" id="S3.T2.1.5.3.4.1">
<span class="ltx_p" id="S3.T2.1.5.3.4.1.1">16.4</span>
</span>  <span class="ltx_rule" style="width:1.5pt;background:black;display:inline-block;"> </span>
</td>
<td class="ltx_td ltx_align_right ltx_border_t" id="S3.T2.1.5.3.5">69.1   <span class="ltx_rule" style="width:1.5pt;background:black;display:inline-block;"> </span>
</td>
<td class="ltx_td ltx_align_justify ltx_border_t" id="S3.T2.1.5.3.6">
<span class="ltx_inline-block ltx_align_top" id="S3.T2.1.5.3.6.1">
<span class="ltx_p" id="S3.T2.1.5.3.6.1.1">70.0</span>
</span>  <span class="ltx_rule" style="width:1.5pt;background:black;display:inline-block;"> </span>
</td>
<td class="ltx_td ltx_align_justify ltx_border_t" id="S3.T2.1.5.3.7">
<span class="ltx_inline-block ltx_align_top" id="S3.T2.1.5.3.7.1">
<span class="ltx_p" id="S3.T2.1.5.3.7.1.1">70.6</span>
</span>  <span class="ltx_rule" style="width:1.5pt;background:black;display:inline-block;"> </span>
</td>
</tr>
<tr class="ltx_tr" id="S3.T2.1.6.4">
<td class="ltx_td ltx_nopad_l ltx_align_justify ltx_border_t" id="S3.T2.1.6.4.1">
<span class="ltx_rule" style="width:1.5pt;background:black;display:inline-block;"> </span>  
<span class="ltx_inline-block ltx_align_top" id="S3.T2.1.6.4.1.1">
<span class="ltx_p" id="S3.T2.1.6.4.1.1.1">e-commerce</span>
</span>  <span class="ltx_rule" style="width:1.5pt;background:black;display:inline-block;"> </span>
</td>
<td class="ltx_td ltx_align_justify ltx_border_t" id="S3.T2.1.6.4.2">
<span class="ltx_inline-block ltx_align_top" id="S3.T2.1.6.4.2.1">
<span class="ltx_p" id="S3.T2.1.6.4.2.1.1">52.5</span>
</span>  <span class="ltx_rule" style="width:1.5pt;background:black;display:inline-block;"> </span>
</td>
<td class="ltx_td ltx_align_right ltx_border_t" id="S3.T2.1.6.4.3">58.1   <span class="ltx_rule" style="width:1.5pt;background:black;display:inline-block;"> </span>
</td>
<td class="ltx_td ltx_align_justify ltx_border_t" id="S3.T2.1.6.4.4">
<span class="ltx_inline-block ltx_align_top" id="S3.T2.1.6.4.4.1">
<span class="ltx_p" id="S3.T2.1.6.4.4.1.1">58.5</span>
</span>  <span class="ltx_rule" style="width:1.5pt;background:black;display:inline-block;"> </span>
</td>
<td class="ltx_td ltx_align_right ltx_border_t" id="S3.T2.1.6.4.5">90.7   <span class="ltx_rule" style="width:1.5pt;background:black;display:inline-block;"> </span>
</td>
<td class="ltx_td ltx_align_justify ltx_border_t" id="S3.T2.1.6.4.6">
<span class="ltx_inline-block ltx_align_top" id="S3.T2.1.6.4.6.1">
<span class="ltx_p" id="S3.T2.1.6.4.6.1.1">90.9</span>
</span>  <span class="ltx_rule" style="width:1.5pt;background:black;display:inline-block;"> </span>
</td>
<td class="ltx_td ltx_align_justify ltx_border_t" id="S3.T2.1.6.4.7">
<span class="ltx_inline-block ltx_align_top" id="S3.T2.1.6.4.7.1">
<span class="ltx_p" id="S3.T2.1.6.4.7.1.1">90.9</span>
</span>  <span class="ltx_rule" style="width:1.5pt;background:black;display:inline-block;"> </span>
</td>
</tr>
<tr class="ltx_tr" id="S3.T2.1.7.5">
<td class="ltx_td ltx_nopad_l ltx_align_justify ltx_border_t" id="S3.T2.1.7.5.1">
<span class="ltx_rule" style="width:1.5pt;background:black;display:inline-block;"> </span>  
<span class="ltx_inline-block ltx_align_top" id="S3.T2.1.7.5.1.1">
<span class="ltx_p" id="S3.T2.1.7.5.1.1.1">finance</span>
</span>  <span class="ltx_rule" style="width:1.5pt;background:black;display:inline-block;"> </span>
</td>
<td class="ltx_td ltx_align_justify ltx_border_t" id="S3.T2.1.7.5.2">
<span class="ltx_inline-block ltx_align_top" id="S3.T2.1.7.5.2.1">
<span class="ltx_p" id="S3.T2.1.7.5.2.1.1">48.6</span>
</span>  <span class="ltx_rule" style="width:1.5pt;background:black;display:inline-block;"> </span>
</td>
<td class="ltx_td ltx_align_right ltx_border_t" id="S3.T2.1.7.5.3">53.3   <span class="ltx_rule" style="width:1.5pt;background:black;display:inline-block;"> </span>
</td>
<td class="ltx_td ltx_align_justify ltx_border_t" id="S3.T2.1.7.5.4">
<span class="ltx_inline-block ltx_align_top" id="S3.T2.1.7.5.4.1">
<span class="ltx_p" id="S3.T2.1.7.5.4.1.1">53.3</span>
</span>  <span class="ltx_rule" style="width:1.5pt;background:black;display:inline-block;"> </span>
</td>
<td class="ltx_td ltx_align_right ltx_border_t" id="S3.T2.1.7.5.5">70.6   <span class="ltx_rule" style="width:1.5pt;background:black;display:inline-block;"> </span>
</td>
<td class="ltx_td ltx_align_justify ltx_border_t" id="S3.T2.1.7.5.6">
<span class="ltx_inline-block ltx_align_top" id="S3.T2.1.7.5.6.1">
<span class="ltx_p" id="S3.T2.1.7.5.6.1.1">94.2</span>
</span>  <span class="ltx_rule" style="width:1.5pt;background:black;display:inline-block;"> </span>
</td>
<td class="ltx_td ltx_align_justify ltx_border_t" id="S3.T2.1.7.5.7">
<span class="ltx_inline-block ltx_align_top" id="S3.T2.1.7.5.7.1">
<span class="ltx_p" id="S3.T2.1.7.5.7.1.1">93.9</span>
</span>  <span class="ltx_rule" style="width:1.5pt;background:black;display:inline-block;"> </span>
</td>
</tr>
<tr class="ltx_tr" id="S3.T2.1.8.6">
<td class="ltx_td ltx_nopad_l ltx_align_justify ltx_border_tt ltx_border_t" id="S3.T2.1.8.6.1">
<span class="ltx_rule" style="width:1.5pt;background:black;display:inline-block;"> </span>  
<span class="ltx_inline-block ltx_align_top" id="S3.T2.1.8.6.1.1">
<span class="ltx_p" id="S3.T2.1.8.6.1.1.1">Medical</span>
</span>  <span class="ltx_rule" style="width:1.5pt;background:black;display:inline-block;"> </span>
</td>
<td class="ltx_td ltx_align_justify ltx_border_tt ltx_border_t" id="S3.T2.1.8.6.2">
<span class="ltx_inline-block ltx_align_top" id="S3.T2.1.8.6.2.1">
<span class="ltx_p" id="S3.T2.1.8.6.2.1.1">42.7</span>
</span>  <span class="ltx_rule" style="width:1.5pt;background:black;display:inline-block;"> </span>
</td>
<td class="ltx_td ltx_align_right ltx_border_tt ltx_border_t" id="S3.T2.1.8.6.3">57.1   <span class="ltx_rule" style="width:1.5pt;background:black;display:inline-block;"> </span>
</td>
<td class="ltx_td ltx_align_justify ltx_border_tt ltx_border_t" id="S3.T2.1.8.6.4">
<span class="ltx_inline-block ltx_align_top" id="S3.T2.1.8.6.4.1">
<span class="ltx_p" id="S3.T2.1.8.6.4.1.1">57.2</span>
</span>  <span class="ltx_rule" style="width:1.5pt;background:black;display:inline-block;"> </span>
</td>
<td class="ltx_td ltx_align_right ltx_border_tt ltx_border_t" id="S3.T2.1.8.6.5">83.9   <span class="ltx_rule" style="width:1.5pt;background:black;display:inline-block;"> </span>
</td>
<td class="ltx_td ltx_align_justify ltx_border_tt ltx_border_t" id="S3.T2.1.8.6.6">
<span class="ltx_inline-block ltx_align_top" id="S3.T2.1.8.6.6.1">
<span class="ltx_p" id="S3.T2.1.8.6.6.1.1">85.2</span>
</span>  <span class="ltx_rule" style="width:1.5pt;background:black;display:inline-block;"> </span>
</td>
<td class="ltx_td ltx_align_justify ltx_border_tt ltx_border_t" id="S3.T2.1.8.6.7">
<span class="ltx_inline-block ltx_align_top" id="S3.T2.1.8.6.7.1">
<span class="ltx_p" id="S3.T2.1.8.6.7.1.1">85.0</span>
</span>  <span class="ltx_rule" style="width:1.5pt;background:black;display:inline-block;"> </span>
</td>
</tr>
<tr class="ltx_tr" id="S3.T2.1.9.7">
<td class="ltx_td ltx_nopad_l ltx_align_justify ltx_border_t" id="S3.T2.1.9.7.1">
<span class="ltx_rule" style="width:1.5pt;background:black;display:inline-block;"> </span>  
<span class="ltx_inline-block ltx_align_top" id="S3.T2.1.9.7.1.1">
<span class="ltx_p" id="S3.T2.1.9.7.1.1.1">medpharma</span>
</span>  <span class="ltx_rule" style="width:1.5pt;background:black;display:inline-block;"> </span>
</td>
<td class="ltx_td ltx_align_justify ltx_border_t" id="S3.T2.1.9.7.2">
<span class="ltx_inline-block ltx_align_top" id="S3.T2.1.9.7.2.1">
<span class="ltx_p" id="S3.T2.1.9.7.2.1.1">41.6</span>
</span>  <span class="ltx_rule" style="width:1.5pt;background:black;display:inline-block;"> </span>
</td>
<td class="ltx_td ltx_align_right ltx_border_t" id="S3.T2.1.9.7.3">47.4   <span class="ltx_rule" style="width:1.5pt;background:black;display:inline-block;"> </span>
</td>
<td class="ltx_td ltx_align_justify ltx_border_t" id="S3.T2.1.9.7.4">
<span class="ltx_inline-block ltx_align_top" id="S3.T2.1.9.7.4.1">
<span class="ltx_p" id="S3.T2.1.9.7.4.1.1">48.1</span>
</span>  <span class="ltx_rule" style="width:1.5pt;background:black;display:inline-block;"> </span>
</td>
<td class="ltx_td ltx_align_right ltx_border_t" id="S3.T2.1.9.7.5">92.2   <span class="ltx_rule" style="width:1.5pt;background:black;display:inline-block;"> </span>
</td>
<td class="ltx_td ltx_align_justify ltx_border_t" id="S3.T2.1.9.7.6">
<span class="ltx_inline-block ltx_align_top" id="S3.T2.1.9.7.6.1">
<span class="ltx_p" id="S3.T2.1.9.7.6.1.1">92.0</span>
</span>  <span class="ltx_rule" style="width:1.5pt;background:black;display:inline-block;"> </span>
</td>
<td class="ltx_td ltx_align_justify ltx_border_t" id="S3.T2.1.9.7.7">
<span class="ltx_inline-block ltx_align_top" id="S3.T2.1.9.7.7.1">
<span class="ltx_p" id="S3.T2.1.9.7.7.1.1">92.5</span>
</span>  <span class="ltx_rule" style="width:1.5pt;background:black;display:inline-block;"> </span>
</td>
</tr>
<tr class="ltx_tr" id="S3.T2.1.10.8">
<td class="ltx_td ltx_nopad_l ltx_align_justify ltx_border_bb ltx_border_tt" id="S3.T2.1.10.8.1">
<span class="ltx_rule" style="width:1.5pt;background:black;display:inline-block;"> </span>  
<span class="ltx_inline-block ltx_align_top" id="S3.T2.1.10.8.1.1">
<span class="ltx_p" id="S3.T2.1.10.8.1.1.1"><span class="ltx_text ltx_font_bold" id="S3.T2.1.10.8.1.1.1.1">AVERAGE</span></span>
</span>  <span class="ltx_rule" style="width:1.5pt;background:black;display:inline-block;"> </span>
</td>
<td class="ltx_td ltx_align_justify ltx_border_bb ltx_border_tt" id="S3.T2.1.10.8.2">
<span class="ltx_inline-block ltx_align_top" id="S3.T2.1.10.8.2.1">
<span class="ltx_p" id="S3.T2.1.10.8.2.1.1">40.8</span>
</span>  <span class="ltx_rule" style="width:1.5pt;background:black;display:inline-block;"> </span>
</td>
<td class="ltx_td ltx_align_right ltx_border_bb ltx_border_tt" id="S3.T2.1.10.8.3">48.5   <span class="ltx_rule" style="width:1.5pt;background:black;display:inline-block;"> </span>
</td>
<td class="ltx_td ltx_align_justify ltx_border_bb ltx_border_tt" id="S3.T2.1.10.8.4">
<span class="ltx_inline-block ltx_align_top" id="S3.T2.1.10.8.4.1">
<span class="ltx_p" id="S3.T2.1.10.8.4.1.1">48.9</span>
</span>  <span class="ltx_rule" style="width:1.5pt;background:black;display:inline-block;"> </span>
</td>
<td class="ltx_td ltx_align_right ltx_border_bb ltx_border_tt" id="S3.T2.1.10.8.5">82.4   <span class="ltx_rule" style="width:1.5pt;background:black;display:inline-block;"> </span>
</td>
<td class="ltx_td ltx_align_justify ltx_border_bb ltx_border_tt" id="S3.T2.1.10.8.6">
<span class="ltx_inline-block ltx_align_top" id="S3.T2.1.10.8.6.1">
<span class="ltx_p" id="S3.T2.1.10.8.6.1.1">86.5</span>
</span>  <span class="ltx_rule" style="width:1.5pt;background:black;display:inline-block;"> </span>
</td>
<td class="ltx_td ltx_align_justify ltx_border_bb ltx_border_tt" id="S3.T2.1.10.8.7">
<span class="ltx_inline-block ltx_align_top" id="S3.T2.1.10.8.7.1">
<span class="ltx_p" id="S3.T2.1.10.8.7.1.1">86.6</span>
</span>  <span class="ltx_rule" style="width:1.5pt;background:black;display:inline-block;"> </span>
</td>
</tr>
</tbody>
</table>
</figure>
<figure class="ltx_table" id="S3.T3">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_table">Table 3: </span>GPU Inference Results on ZCode M3 Model.</figcaption>
<table class="ltx_tabular ltx_align_middle" id="S3.T3.1">
<tbody class="ltx_tbody">
<tr class="ltx_tr" id="S3.T3.1.1.1">
<td class="ltx_td ltx_nopad_l ltx_align_justify ltx_border_tt ltx_border_t" id="S3.T3.1.1.1.1">
<span class="ltx_rule" style="width:1.5pt;background:black;display:inline-block;"> </span>    <span class="ltx_rule" style="width:1.5pt;background:black;display:inline-block;"> </span>
</td>
<td class="ltx_td ltx_align_right ltx_border_tt ltx_border_t" colspan="3" id="S3.T3.1.1.1.2">
<span class="ltx_text ltx_font_bold" id="S3.T3.1.1.1.2.1">beam=1, batch=1</span>   <span class="ltx_rule" style="width:1.5pt;background:black;display:inline-block;"> </span>
</td>
<td class="ltx_td ltx_align_right ltx_border_tt ltx_border_t" colspan="3" id="S3.T3.1.1.1.3">
<span class="ltx_text ltx_font_bold" id="S3.T3.1.1.1.3.1">beam=2, batch=20</span>   <span class="ltx_rule" style="width:1.5pt;background:black;display:inline-block;"> </span>
</td>
</tr>
<tr class="ltx_tr" id="S3.T3.1.2.2">
<td class="ltx_td ltx_nopad_l ltx_align_justify" id="S3.T3.1.2.2.1">
<span class="ltx_rule" style="width:1.5pt;background:black;display:inline-block;"> </span>  
<span class="ltx_inline-block ltx_align_top" id="S3.T3.1.2.2.1.1">
<span class="ltx_p" id="S3.T3.1.2.2.1.1.1"><span class="ltx_text ltx_font_bold" id="S3.T3.1.2.2.1.1.1.1">Domain</span></span>
</span>  <span class="ltx_rule" style="width:1.5pt;background:black;display:inline-block;"> </span>
</td>
<td class="ltx_td ltx_align_right ltx_border_t" colspan="2" id="S3.T3.1.2.2.2">
<span class="ltx_text ltx_font_bold" id="S3.T3.1.2.2.2.1">BLEU</span>   <span class="ltx_rule" style="width:1.5pt;background:black;display:inline-block;"> </span>
</td>
<td class="ltx_td ltx_align_right ltx_border_t" id="S3.T3.1.2.2.3">
<span class="ltx_text ltx_font_bold" id="S3.T3.1.2.2.3.1">Speed Drop (%)</span>   <span class="ltx_rule" style="width:1.5pt;background:black;display:inline-block;"> </span>
</td>
<td class="ltx_td ltx_align_right ltx_border_t" colspan="2" id="S3.T3.1.2.2.4">
<span class="ltx_text ltx_font_bold" id="S3.T3.1.2.2.4.1">BLEU</span>   <span class="ltx_rule" style="width:1.5pt;background:black;display:inline-block;"> </span>
</td>
<td class="ltx_td ltx_align_right ltx_border_t" id="S3.T3.1.2.2.5">
<span class="ltx_text ltx_font_bold" id="S3.T3.1.2.2.5.1">Speed Drop (%)</span>   <span class="ltx_rule" style="width:1.5pt;background:black;display:inline-block;"> </span>
</td>
</tr>
<tr class="ltx_tr" id="S3.T3.1.3.3">
<td class="ltx_td ltx_nopad_l ltx_align_justify" id="S3.T3.1.3.3.1">
<span class="ltx_rule" style="width:1.5pt;background:black;display:inline-block;"> </span>    <span class="ltx_rule" style="width:1.5pt;background:black;display:inline-block;"> </span>
</td>
<td class="ltx_td ltx_align_left ltx_border_t" id="S3.T3.1.3.3.2">NMT   <span class="ltx_rule" style="width:1.5pt;background:black;display:inline-block;"> </span>
</td>
<td class="ltx_td ltx_align_justify ltx_border_t" id="S3.T3.1.3.3.3">
<span class="ltx_inline-block ltx_align_top" id="S3.T3.1.3.3.3.1">
<span class="ltx_p" id="S3.T3.1.3.3.3.1.1">knn-MT</span>
</span>  <span class="ltx_rule" style="width:1.5pt;background:black;display:inline-block;"> </span>
</td>
<td class="ltx_td ltx_align_right" id="S3.T3.1.3.3.4">  <span class="ltx_rule" style="width:1.5pt;background:black;display:inline-block;"> </span>
</td>
<td class="ltx_td ltx_align_left ltx_border_t" id="S3.T3.1.3.3.5">NMT   <span class="ltx_rule" style="width:1.5pt;background:black;display:inline-block;"> </span>
</td>
<td class="ltx_td ltx_align_justify ltx_border_t" id="S3.T3.1.3.3.6">
<span class="ltx_inline-block ltx_align_top" id="S3.T3.1.3.3.6.1">
<span class="ltx_p" id="S3.T3.1.3.3.6.1.1">knn-MT</span>
</span>  <span class="ltx_rule" style="width:1.5pt;background:black;display:inline-block;"> </span>
</td>
<td class="ltx_td ltx_align_right" id="S3.T3.1.3.3.7">  <span class="ltx_rule" style="width:1.5pt;background:black;display:inline-block;"> </span>
</td>
</tr>
<tr class="ltx_tr" id="S3.T3.1.4.4">
<td class="ltx_td ltx_nopad_l ltx_align_justify ltx_border_t" id="S3.T3.1.4.4.1">
<span class="ltx_rule" style="width:1.5pt;background:black;display:inline-block;"> </span>  
<span class="ltx_inline-block ltx_align_top" id="S3.T3.1.4.4.1.1">
<span class="ltx_p" id="S3.T3.1.4.4.1.1.1">IT</span>
</span>  <span class="ltx_rule" style="width:1.5pt;background:black;display:inline-block;"> </span>
</td>
<td class="ltx_td ltx_align_left ltx_border_t" id="S3.T3.1.4.4.2">37.6   <span class="ltx_rule" style="width:1.5pt;background:black;display:inline-block;"> </span>
</td>
<td class="ltx_td ltx_align_justify ltx_border_t" id="S3.T3.1.4.4.3">
<span class="ltx_inline-block ltx_align_top" id="S3.T3.1.4.4.3.1">
<span class="ltx_p" id="S3.T3.1.4.4.3.1.1">43.8</span>
</span>  <span class="ltx_rule" style="width:1.5pt;background:black;display:inline-block;"> </span>
</td>
<td class="ltx_td ltx_align_right ltx_border_t" id="S3.T3.1.4.4.4">4.9   <span class="ltx_rule" style="width:1.5pt;background:black;display:inline-block;"> </span>
</td>
<td class="ltx_td ltx_align_left ltx_border_t" id="S3.T3.1.4.4.5">37.4   <span class="ltx_rule" style="width:1.5pt;background:black;display:inline-block;"> </span>
</td>
<td class="ltx_td ltx_align_justify ltx_border_t" id="S3.T3.1.4.4.6">
<span class="ltx_inline-block ltx_align_top" id="S3.T3.1.4.4.6.1">
<span class="ltx_p" id="S3.T3.1.4.4.6.1.1">43.7</span>
</span>  <span class="ltx_rule" style="width:1.5pt;background:black;display:inline-block;"> </span>
</td>
<td class="ltx_td ltx_align_right ltx_border_t" id="S3.T3.1.4.4.7">6.5   <span class="ltx_rule" style="width:1.5pt;background:black;display:inline-block;"> </span>
</td>
</tr>
<tr class="ltx_tr" id="S3.T3.1.5.5">
<td class="ltx_td ltx_nopad_l ltx_align_justify ltx_border_t" id="S3.T3.1.5.5.1">
<span class="ltx_rule" style="width:1.5pt;background:black;display:inline-block;"> </span>  
<span class="ltx_inline-block ltx_align_top" id="S3.T3.1.5.5.1.1">
<span class="ltx_p" id="S3.T3.1.5.5.1.1.1">Medical</span>
</span>  <span class="ltx_rule" style="width:1.5pt;background:black;display:inline-block;"> </span>
</td>
<td class="ltx_td ltx_align_left ltx_border_t" id="S3.T3.1.5.5.2">45.6   <span class="ltx_rule" style="width:1.5pt;background:black;display:inline-block;"> </span>
</td>
<td class="ltx_td ltx_align_justify ltx_border_t" id="S3.T3.1.5.5.3">
<span class="ltx_inline-block ltx_align_top" id="S3.T3.1.5.5.3.1">
<span class="ltx_p" id="S3.T3.1.5.5.3.1.1">55.6</span>
</span>  <span class="ltx_rule" style="width:1.5pt;background:black;display:inline-block;"> </span>
</td>
<td class="ltx_td ltx_align_right ltx_border_t" id="S3.T3.1.5.5.4">5.0   <span class="ltx_rule" style="width:1.5pt;background:black;display:inline-block;"> </span>
</td>
<td class="ltx_td ltx_align_left ltx_border_t" id="S3.T3.1.5.5.5">45.8   <span class="ltx_rule" style="width:1.5pt;background:black;display:inline-block;"> </span>
</td>
<td class="ltx_td ltx_align_justify ltx_border_t" id="S3.T3.1.5.5.6">
<span class="ltx_inline-block ltx_align_top" id="S3.T3.1.5.5.6.1">
<span class="ltx_p" id="S3.T3.1.5.5.6.1.1">56.3</span>
</span>  <span class="ltx_rule" style="width:1.5pt;background:black;display:inline-block;"> </span>
</td>
<td class="ltx_td ltx_align_right ltx_border_t" id="S3.T3.1.5.5.7">9.1   <span class="ltx_rule" style="width:1.5pt;background:black;display:inline-block;"> </span>
</td>
</tr>
<tr class="ltx_tr" id="S3.T3.1.6.6">
<td class="ltx_td ltx_nopad_l ltx_align_justify ltx_border_t" id="S3.T3.1.6.6.1">
<span class="ltx_rule" style="width:1.5pt;background:black;display:inline-block;"> </span>  
<span class="ltx_inline-block ltx_align_top" id="S3.T3.1.6.6.1.1">
<span class="ltx_p" id="S3.T3.1.6.6.1.1.1">Law</span>
</span>  <span class="ltx_rule" style="width:1.5pt;background:black;display:inline-block;"> </span>
</td>
<td class="ltx_td ltx_align_left ltx_border_t" id="S3.T3.1.6.6.2">54.1   <span class="ltx_rule" style="width:1.5pt;background:black;display:inline-block;"> </span>
</td>
<td class="ltx_td ltx_align_justify ltx_border_t" id="S3.T3.1.6.6.3">
<span class="ltx_inline-block ltx_align_top" id="S3.T3.1.6.6.3.1">
<span class="ltx_p" id="S3.T3.1.6.6.3.1.1">61.8</span>
</span>  <span class="ltx_rule" style="width:1.5pt;background:black;display:inline-block;"> </span>
</td>
<td class="ltx_td ltx_align_right ltx_border_t" id="S3.T3.1.6.6.4">5.8   <span class="ltx_rule" style="width:1.5pt;background:black;display:inline-block;"> </span>
</td>
<td class="ltx_td ltx_align_left ltx_border_t" id="S3.T3.1.6.6.5">54.1   <span class="ltx_rule" style="width:1.5pt;background:black;display:inline-block;"> </span>
</td>
<td class="ltx_td ltx_align_justify ltx_border_t" id="S3.T3.1.6.6.6">
<span class="ltx_inline-block ltx_align_top" id="S3.T3.1.6.6.6.1">
<span class="ltx_p" id="S3.T3.1.6.6.6.1.1">62.2</span>
</span>  <span class="ltx_rule" style="width:1.5pt;background:black;display:inline-block;"> </span>
</td>
<td class="ltx_td ltx_align_right ltx_border_t" id="S3.T3.1.6.6.7">5.5   <span class="ltx_rule" style="width:1.5pt;background:black;display:inline-block;"> </span>
</td>
</tr>
<tr class="ltx_tr" id="S3.T3.1.7.7">
<td class="ltx_td ltx_nopad_l ltx_align_justify ltx_border_bb ltx_border_tt" id="S3.T3.1.7.7.1">
<span class="ltx_rule" style="width:1.5pt;background:black;display:inline-block;"> </span>  
<span class="ltx_inline-block ltx_align_top" id="S3.T3.1.7.7.1.1">
<span class="ltx_p" id="S3.T3.1.7.7.1.1.1"><span class="ltx_text ltx_font_bold" id="S3.T3.1.7.7.1.1.1.1">AVERAGE</span></span>
</span>  <span class="ltx_rule" style="width:1.5pt;background:black;display:inline-block;"> </span>
</td>
<td class="ltx_td ltx_align_left ltx_border_bb ltx_border_tt" id="S3.T3.1.7.7.2">
<span class="ltx_text ltx_font_bold" id="S3.T3.1.7.7.2.1">45.7</span>   <span class="ltx_rule" style="width:1.5pt;background:black;display:inline-block;"> </span>
</td>
<td class="ltx_td ltx_align_justify ltx_border_bb ltx_border_tt" id="S3.T3.1.7.7.3">
<span class="ltx_inline-block ltx_align_top" id="S3.T3.1.7.7.3.1">
<span class="ltx_p" id="S3.T3.1.7.7.3.1.1"><span class="ltx_text ltx_font_bold" id="S3.T3.1.7.7.3.1.1.1">53.7</span></span>
</span>  <span class="ltx_rule" style="width:1.5pt;background:black;display:inline-block;"> </span>
</td>
<td class="ltx_td ltx_align_right ltx_border_bb ltx_border_tt" id="S3.T3.1.7.7.4">
<span class="ltx_text ltx_font_bold" id="S3.T3.1.7.7.4.1">5.2</span>   <span class="ltx_rule" style="width:1.5pt;background:black;display:inline-block;"> </span>
</td>
<td class="ltx_td ltx_align_left ltx_border_bb ltx_border_tt" id="S3.T3.1.7.7.5">
<span class="ltx_text ltx_font_bold" id="S3.T3.1.7.7.5.1">45.7</span>   <span class="ltx_rule" style="width:1.5pt;background:black;display:inline-block;"> </span>
</td>
<td class="ltx_td ltx_align_justify ltx_border_bb ltx_border_tt" id="S3.T3.1.7.7.6">
<span class="ltx_inline-block ltx_align_top" id="S3.T3.1.7.7.6.1">
<span class="ltx_p" id="S3.T3.1.7.7.6.1.1"><span class="ltx_text ltx_font_bold" id="S3.T3.1.7.7.6.1.1.1">54.0</span></span>
</span>  <span class="ltx_rule" style="width:1.5pt;background:black;display:inline-block;"> </span>
</td>
<td class="ltx_td ltx_align_right ltx_border_bb ltx_border_tt" id="S3.T3.1.7.7.7">
<span class="ltx_text ltx_font_bold" id="S3.T3.1.7.7.7.1">7.0</span>   <span class="ltx_rule" style="width:1.5pt;background:black;display:inline-block;"> </span>
</td>
</tr>
</tbody>
</table>
</figure>
</section>
<section class="ltx_section" id="S4">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">4 </span>Experimental Results</h2>
<section class="ltx_subsection" id="S4.SS1">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.1 </span>Experimental Setup</h3>
<div class="ltx_para ltx_noindent" id="S4.SS1.p1">
<p class="ltx_p" id="S4.SS1.p1.1"><span class="ltx_text ltx_font_bold" id="S4.SS1.p1.1.1">Input stimuli and Datasets:</span> We test our methodology in 2 language directions: German-English (deen), and English-Czech (encs). For deen, we employ the multi-domain dataset as the baseline <cite class="ltx_cite ltx_citemacro_cite">Khandelwal et al., (<a class="ltx_ref" href="https://arxiv.org/html/2407.19965v2#bib.bib4" title="">2021</a>)</cite> in addition to an e-commerce domain. For encs, we utilize two other domains: finance and medpharma. Our evaluation metrics are the SacreBLEU <cite class="ltx_cite ltx_citemacro_cite">Post, (<a class="ltx_ref" href="https://arxiv.org/html/2407.19965v2#bib.bib7" title="">2018</a>)</cite> and COMET-22 (wmt22-COMET-da) <cite class="ltx_cite ltx_citemacro_cite">Rei et al., (<a class="ltx_ref" href="https://arxiv.org/html/2407.19965v2#bib.bib8" title="">2022</a>)</cite>, a reference-based metric that combines direct assessments (DA), sentence-level scores, and word-level tags from Multidimensional Quality Metrics (MQM) error annotations.</p>
</div>
<div class="ltx_para ltx_noindent" id="S4.SS1.p2">
<p class="ltx_p" id="S4.SS1.p2.1"><span class="ltx_text ltx_font_bold" id="S4.SS1.p2.1.1">Models:</span> Three transformer models are used in our experiments. The first two of the three are used to measure the translation quality; these two are constructed from 12 encoder layers and 12 decoder layers with 512 hidden dimensions and 2048 feedforward layer hidden dimensions with 8 multi-head attention heads. The third transformer is the ZCode M3 model reviewed and presented in <cite class="ltx_cite ltx_citemacro_cite">Kim et al., (<a class="ltx_ref" href="https://arxiv.org/html/2407.19965v2#bib.bib5" title="">2021</a>)</cite>. ZCode M3 is constructed from 24 encoder layers and 12 decoder layers with 1024 hidden dimensions and 4096 feedforward layer hidden dimensions with 16 multi-head attention heads. The ZCode M3 has 32 experts, 5B parameters, and 128,000 vocab size.</p>
</div>
<div class="ltx_para ltx_noindent" id="S4.SS1.p3">
<p class="ltx_p" id="S4.SS1.p3.1"><span class="ltx_text ltx_font_bold" id="S4.SS1.p3.1.1">Baselines:</span> The model without knnMT is one baseline. To compare to other methods on our inhouse transformers, we utilize the SK-MT method that uses a distance-aware adapter <cite class="ltx_cite ltx_citemacro_cite">Dai et al., (<a class="ltx_ref" href="https://arxiv.org/html/2407.19965v2#bib.bib1" title="">2023</a>)</cite>. In <cite class="ltx_cite ltx_citemacro_cite">Dai et al., (<a class="ltx_ref" href="https://arxiv.org/html/2407.19965v2#bib.bib1" title="">2023</a>)</cite>, the authors compared with other methods and showed success so we use <cite class="ltx_cite ltx_citemacro_cite">Dai et al., (<a class="ltx_ref" href="https://arxiv.org/html/2407.19965v2#bib.bib1" title="">2023</a>)</cite> as a transitive proxy to compare with other methods.</p>
</div>
<div class="ltx_para ltx_noindent" id="S4.SS1.p4">
<p class="ltx_p" id="S4.SS1.p4.1"><span class="ltx_text ltx_font_bold" id="S4.SS1.p4.1.1">GPU Inference Hardware and Environment:</span> Inference and speed evaluation experiments are carried out on a single NVIDIA Tesla V100 GPU. Our inference environment is the highly optimized FasterTransformer from NVIDIA. Without loss of generality, we fix interpolation to <math alttext="\lambda=Relu(1-\frac{d_{0}}{100})" class="ltx_Math" display="inline" id="S4.SS1.p4.1.m1.1"><semantics id="S4.SS1.p4.1.m1.1a"><mrow id="S4.SS1.p4.1.m1.1.1" xref="S4.SS1.p4.1.m1.1.1.cmml"><mi id="S4.SS1.p4.1.m1.1.1.3" xref="S4.SS1.p4.1.m1.1.1.3.cmml">λ</mi><mo id="S4.SS1.p4.1.m1.1.1.2" xref="S4.SS1.p4.1.m1.1.1.2.cmml">=</mo><mrow id="S4.SS1.p4.1.m1.1.1.1" xref="S4.SS1.p4.1.m1.1.1.1.cmml"><mi id="S4.SS1.p4.1.m1.1.1.1.3" xref="S4.SS1.p4.1.m1.1.1.1.3.cmml">R</mi><mo id="S4.SS1.p4.1.m1.1.1.1.2" xref="S4.SS1.p4.1.m1.1.1.1.2.cmml">⁢</mo><mi id="S4.SS1.p4.1.m1.1.1.1.4" xref="S4.SS1.p4.1.m1.1.1.1.4.cmml">e</mi><mo id="S4.SS1.p4.1.m1.1.1.1.2a" xref="S4.SS1.p4.1.m1.1.1.1.2.cmml">⁢</mo><mi id="S4.SS1.p4.1.m1.1.1.1.5" xref="S4.SS1.p4.1.m1.1.1.1.5.cmml">l</mi><mo id="S4.SS1.p4.1.m1.1.1.1.2b" xref="S4.SS1.p4.1.m1.1.1.1.2.cmml">⁢</mo><mi id="S4.SS1.p4.1.m1.1.1.1.6" xref="S4.SS1.p4.1.m1.1.1.1.6.cmml">u</mi><mo id="S4.SS1.p4.1.m1.1.1.1.2c" xref="S4.SS1.p4.1.m1.1.1.1.2.cmml">⁢</mo><mrow id="S4.SS1.p4.1.m1.1.1.1.1.1" xref="S4.SS1.p4.1.m1.1.1.1.1.1.1.cmml"><mo id="S4.SS1.p4.1.m1.1.1.1.1.1.2" stretchy="false" xref="S4.SS1.p4.1.m1.1.1.1.1.1.1.cmml">(</mo><mrow id="S4.SS1.p4.1.m1.1.1.1.1.1.1" xref="S4.SS1.p4.1.m1.1.1.1.1.1.1.cmml"><mn id="S4.SS1.p4.1.m1.1.1.1.1.1.1.2" xref="S4.SS1.p4.1.m1.1.1.1.1.1.1.2.cmml">1</mn><mo id="S4.SS1.p4.1.m1.1.1.1.1.1.1.1" xref="S4.SS1.p4.1.m1.1.1.1.1.1.1.1.cmml">−</mo><mfrac id="S4.SS1.p4.1.m1.1.1.1.1.1.1.3" xref="S4.SS1.p4.1.m1.1.1.1.1.1.1.3.cmml"><msub id="S4.SS1.p4.1.m1.1.1.1.1.1.1.3.2" xref="S4.SS1.p4.1.m1.1.1.1.1.1.1.3.2.cmml"><mi id="S4.SS1.p4.1.m1.1.1.1.1.1.1.3.2.2" xref="S4.SS1.p4.1.m1.1.1.1.1.1.1.3.2.2.cmml">d</mi><mn id="S4.SS1.p4.1.m1.1.1.1.1.1.1.3.2.3" xref="S4.SS1.p4.1.m1.1.1.1.1.1.1.3.2.3.cmml">0</mn></msub><mn id="S4.SS1.p4.1.m1.1.1.1.1.1.1.3.3" xref="S4.SS1.p4.1.m1.1.1.1.1.1.1.3.3.cmml">100</mn></mfrac></mrow><mo id="S4.SS1.p4.1.m1.1.1.1.1.1.3" stretchy="false" xref="S4.SS1.p4.1.m1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.p4.1.m1.1b"><apply id="S4.SS1.p4.1.m1.1.1.cmml" xref="S4.SS1.p4.1.m1.1.1"><eq id="S4.SS1.p4.1.m1.1.1.2.cmml" xref="S4.SS1.p4.1.m1.1.1.2"></eq><ci id="S4.SS1.p4.1.m1.1.1.3.cmml" xref="S4.SS1.p4.1.m1.1.1.3">𝜆</ci><apply id="S4.SS1.p4.1.m1.1.1.1.cmml" xref="S4.SS1.p4.1.m1.1.1.1"><times id="S4.SS1.p4.1.m1.1.1.1.2.cmml" xref="S4.SS1.p4.1.m1.1.1.1.2"></times><ci id="S4.SS1.p4.1.m1.1.1.1.3.cmml" xref="S4.SS1.p4.1.m1.1.1.1.3">𝑅</ci><ci id="S4.SS1.p4.1.m1.1.1.1.4.cmml" xref="S4.SS1.p4.1.m1.1.1.1.4">𝑒</ci><ci id="S4.SS1.p4.1.m1.1.1.1.5.cmml" xref="S4.SS1.p4.1.m1.1.1.1.5">𝑙</ci><ci id="S4.SS1.p4.1.m1.1.1.1.6.cmml" xref="S4.SS1.p4.1.m1.1.1.1.6">𝑢</ci><apply id="S4.SS1.p4.1.m1.1.1.1.1.1.1.cmml" xref="S4.SS1.p4.1.m1.1.1.1.1.1"><minus id="S4.SS1.p4.1.m1.1.1.1.1.1.1.1.cmml" xref="S4.SS1.p4.1.m1.1.1.1.1.1.1.1"></minus><cn id="S4.SS1.p4.1.m1.1.1.1.1.1.1.2.cmml" type="integer" xref="S4.SS1.p4.1.m1.1.1.1.1.1.1.2">1</cn><apply id="S4.SS1.p4.1.m1.1.1.1.1.1.1.3.cmml" xref="S4.SS1.p4.1.m1.1.1.1.1.1.1.3"><divide id="S4.SS1.p4.1.m1.1.1.1.1.1.1.3.1.cmml" xref="S4.SS1.p4.1.m1.1.1.1.1.1.1.3"></divide><apply id="S4.SS1.p4.1.m1.1.1.1.1.1.1.3.2.cmml" xref="S4.SS1.p4.1.m1.1.1.1.1.1.1.3.2"><csymbol cd="ambiguous" id="S4.SS1.p4.1.m1.1.1.1.1.1.1.3.2.1.cmml" xref="S4.SS1.p4.1.m1.1.1.1.1.1.1.3.2">subscript</csymbol><ci id="S4.SS1.p4.1.m1.1.1.1.1.1.1.3.2.2.cmml" xref="S4.SS1.p4.1.m1.1.1.1.1.1.1.3.2.2">𝑑</ci><cn id="S4.SS1.p4.1.m1.1.1.1.1.1.1.3.2.3.cmml" type="integer" xref="S4.SS1.p4.1.m1.1.1.1.1.1.1.3.2.3">0</cn></apply><cn id="S4.SS1.p4.1.m1.1.1.1.1.1.1.3.3.cmml" type="integer" xref="S4.SS1.p4.1.m1.1.1.1.1.1.1.3.3">100</cn></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p4.1.m1.1c">\lambda=Relu(1-\frac{d_{0}}{100})</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p4.1.m1.1d">italic_λ = italic_R italic_e italic_l italic_u ( 1 - divide start_ARG italic_d start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT end_ARG start_ARG 100 end_ARG )</annotation></semantics></math> and measure the speed.</p>
</div>
</section>
<section class="ltx_subsection" id="S4.SS2">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.2 </span>Trainable <span class="ltx_text ltx_font_italic" id="S4.SS2.1.1">k</span>NN Retrieval Results</h3>
<div class="ltx_para" id="S4.SS2.p1">
<p class="ltx_p" id="S4.SS2.p1.1">Table <a class="ltx_ref" href="https://arxiv.org/html/2407.19965v2#S3.T2" title="Table 2 ‣ 3 Single-Layer Trainable Interpolation ‣ Simply Trainable Nearest Neighbour Machine Translation with GPU Inference"><span class="ltx_text ltx_ref_tag">2</span></a> shows the translation quality performance comparison between the proposed trainable method and other baselines. As shown in the table, our proposed trainable method improves the NMT baseline translation quality by a large margin. In addition, the proposed method
improves or sometimes maintains the overall translation quality relative to SK-MT on average in terms of the BLEU and COMET
scores. In some domains like IT and Koran, the proposed method improves the SK-MT performance. This result demonstrates the ability to at least maintain the performance of SK-MT while using a single-layer neural network. Also, these results overall show the adaptability of the proposed method to different datasets. For Medical and medpharma, SK-MT outperforms our proposed method because the datastore built by the dev set does not have any semantic similarity to the training set leading to imbalanced binary labeling, whereas the test does not have this imbalanced binary labeling. To overcome this challenge, we suggest that we add weights to the binary cross-entropy training loss function. With this weighted loss function, our trainable method achieves 57.2 BLEU, 85 COMET in Medical, and 48.1 BLEU, 92.5 COMET in medphrama. These results increase our average results to 48.9 BLEU, and 86.6 COMET, respectively.</p>
</div>
<div class="ltx_para" id="S4.SS2.p2">
<p class="ltx_p" id="S4.SS2.p2.1">Turning to the translation quality in terms of COMET, we observe that SK-MT still either maintain or improve the quality in the majority of the domains. We also notice that the improvements in BLEU scores do not fully transfer to COMET. We believe that this is due to the fact that COMET is trained on general domain data, therefore it’s less sensitive to domain terminology and more focused on coherence and fluency. For example, e-commerce has an improvement of roughly 6 BLEU points relative to NMT, while the improvement is 0.3 COMET score points.</p>
</div>
</section>
<section class="ltx_subsection" id="S4.SS3">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.3 </span>GPU Inference Results</h3>
<div class="ltx_para" id="S4.SS3.p1">
<p class="ltx_p" id="S4.SS3.p1.1">Table <a class="ltx_ref" href="https://arxiv.org/html/2407.19965v2#S3.T3" title="Table 3 ‣ 3 Single-Layer Trainable Interpolation ‣ Simply Trainable Nearest Neighbour Machine Translation with GPU Inference"><span class="ltx_text ltx_ref_tag">3</span></a> depicts the speed results of ZCode M3 inference and corresponding BLEU scores in three domains under test namely, IT, Medical, and Law. The kNN-MT results for beam=1, batch=1 setting on the large scale MoE improves the NMT baseline with a large margin while dropping the speed by only 5.2% on average. Similarly, kNN-MT has an improved translation quality with only a drop of 7% relative to NMT as beam and batch increase to 2 and 20, respectively. These results show the potential of deploying the knnMT domain adaption approach in such a large-scale model as ZCode M3.</p>
</div>
</section>
</section>
<section class="ltx_section" id="S5">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">5 </span>Conclusion</h2>
<div class="ltx_para" id="S5.p1">
<p class="ltx_p" id="S5.p1.1">This paper proposes a simply single-layer trainable nearest-neighbor machine translation and carries out experiments on large-scale models to demonstrate kNN feasibility with GPU Inference. Experimental results show the translation quality effectiveness of our adaptive and automatic interpolation technique relative to other methods in literature, the training simplicity in 40 mins on single-GPU, and insignificant speed drop of knnMT on GPU inference.</p>
</div>
</section>
<section class="ltx_bibliography" id="bib">
<h2 class="ltx_title ltx_title_bibliography">References</h2>
<ul class="ltx_biblist">
<li class="ltx_bibitem" id="bib.bib1">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Dai et al.,  (2023)</span>
<span class="ltx_bibblock">
Dai, Y., Zhang, Z., Liu, Q., Cui, Q., Li, W., Du, Y., and Xu, T. (2023).

</span>
<span class="ltx_bibblock">Simple and scalable nearest neighbor machine translation.

</span>
<span class="ltx_bibblock">In <span class="ltx_text ltx_font_italic" id="bib.bib1.1.1">The Eleventh International Conference on Learning Representations (ICLR)</span>.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib2">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Jiang et al.,  (2022)</span>
<span class="ltx_bibblock">
Jiang, H., Lu, Z., Meng, F., Zhou, C., Zhou, J., Huang, D., and Su, J. (2022).

</span>
<span class="ltx_bibblock">Towards robust k-nearest-neighbor machine translation.

</span>
<span class="ltx_bibblock">In <span class="ltx_text ltx_font_italic" id="bib.bib2.1.1">Proceedings of the 2022 Conference on Empirical Methods in Natural Language Processing</span>, pages 5468–5477, Abu Dhabi, United Arab Emirates. Association for Computational Linguistics.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib3">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Jiang et al.,  (2021)</span>
<span class="ltx_bibblock">
Jiang, Q., Wang, M., Cao, J., Cheng, S., Huang, S., and Li, L. (2021).

</span>
<span class="ltx_bibblock">Learning kernel-smoothed machine translation with retrieved examples.

</span>
<span class="ltx_bibblock">In <span class="ltx_text ltx_font_italic" id="bib.bib3.1.1">Proceedings of the 2021 Conference on Empirical Methods in Natural Language Processing</span>, pages 7280–7290, Online and Punta Cana, Dominican Republic. Association for Computational Linguistics.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib4">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Khandelwal et al.,  (2021)</span>
<span class="ltx_bibblock">
Khandelwal, U., Fan, A., Jurafsky, D., Zettlemoyer, L., and Lewis, M. (2021).

</span>
<span class="ltx_bibblock">Nearest neighbor machine translation.

</span>
<span class="ltx_bibblock">In <span class="ltx_text ltx_font_italic" id="bib.bib4.1.1">International Conference on Learning Representations (ICLR)</span>.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib5">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Kim et al.,  (2021)</span>
<span class="ltx_bibblock">
Kim, Y. J., Awan, A. A., Muzio, A., Salinas, A. F. C., Lu, L., Hendy, A., Rajbhandari, S., He, Y., and Awadalla, H. H. (2021).

</span>
<span class="ltx_bibblock">Scalable and efficient moe training for multitask multilingual models.

</span>
<span class="ltx_bibblock"><span class="ltx_text ltx_font_italic" id="bib.bib5.1.1">arXiv preprint arXiv:2109.10465</span>.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib6">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Meng et al.,  (2022)</span>
<span class="ltx_bibblock">
Meng, Y., Li, X., Zheng, X., Wu, F., Sun, X., Zhang, T., and Li, J. (2022).

</span>
<span class="ltx_bibblock">Fast nearest neighbor machine translation.

</span>
<span class="ltx_bibblock">In <span class="ltx_text ltx_font_italic" id="bib.bib6.1.1">Findings of the Association for Computational Linguistics: ACL 2022</span>, pages 555–565, Dublin, Ireland. Association for Computational Linguistics.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib7">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Post,  (2018)</span>
<span class="ltx_bibblock">
Post, M. (2018).

</span>
<span class="ltx_bibblock">A call for clarity in reporting BLEU scores.

</span>
<span class="ltx_bibblock">In Bojar, O., Chatterjee, R., Federmann, C., Fishel, M., Graham, Y., Haddow, B., Huck, M., Yepes, A. J., Koehn, P., Monz, C., Negri, M., Névéol, A., Neves, M., Post, M., Specia, L., Turchi, M., and Verspoor, K., editors, <span class="ltx_text ltx_font_italic" id="bib.bib7.1.1">Proceedings of the Third Conference on Machine Translation: Research Papers</span>, pages 186–191, Brussels, Belgium. Association for Computational Linguistics.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib8">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Rei et al.,  (2022)</span>
<span class="ltx_bibblock">
Rei, R., De Souza, J. G., Alves, D., Zerva, C., Farinha, A. C., Glushkova, T., Lavie, A., Coheur, L., and Martins, A. F. (2022).

</span>
<span class="ltx_bibblock">Comet-22: Unbabel-ist 2022 submission for the metrics shared task.

</span>
<span class="ltx_bibblock">In <span class="ltx_text ltx_font_italic" id="bib.bib8.1.1">Proceedings of the Seventh Conference on Machine Translation (WMT)</span>, pages 578–585.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib9">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Robertson et al.,  (2009)</span>
<span class="ltx_bibblock">
Robertson, S., Zaragoza, H., et al. (2009).

</span>
<span class="ltx_bibblock">The probabilistic relevance framework: Bm25 and beyond.

</span>
<span class="ltx_bibblock"><span class="ltx_text ltx_font_italic" id="bib.bib9.1.1">Foundations and Trends® in Information Retrieval</span>, 3(4):333–389.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib10">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Vaswani et al.,  (2017)</span>
<span class="ltx_bibblock">
Vaswani, A., Shazeer, N., Parmar, N., Uszkoreit, J., Jones, L., Gomez, A. N., Kaiser, L., and Polosukhin, I. (2017).

</span>
<span class="ltx_bibblock">Attention is all you need.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib11">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Wang et al.,  (2022)</span>
<span class="ltx_bibblock">
Wang, D., Fan, K., Chen, B., and Xiong, D. (2022).

</span>
<span class="ltx_bibblock">Efficient cluster-based <math alttext="k" class="ltx_Math" display="inline" id="bib.bib11.1.m1.1"><semantics id="bib.bib11.1.m1.1a"><mi id="bib.bib11.1.m1.1.1" xref="bib.bib11.1.m1.1.1.cmml">k</mi><annotation-xml encoding="MathML-Content" id="bib.bib11.1.m1.1b"><ci id="bib.bib11.1.m1.1.1.cmml" xref="bib.bib11.1.m1.1.1">𝑘</ci></annotation-xml><annotation encoding="application/x-tex" id="bib.bib11.1.m1.1c">k</annotation><annotation encoding="application/x-llamapun" id="bib.bib11.1.m1.1d">italic_k</annotation></semantics></math>-nearest-neighbor machine translation.

</span>
<span class="ltx_bibblock">In <span class="ltx_text ltx_font_italic" id="bib.bib11.2.1">Proceedings of the 60th Annual Meeting of the Association for Computational Linguistics (Volume 1: Long Papers)</span>, pages 2175–2187, Dublin, Ireland. Association for Computational Linguistics.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib12">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">(12)</span>
<span class="ltx_bibblock">
Zheng, X., Zhang, Z., Guo, J., Huang, S., Chen, B., Luo, W., and Chen, J. (2021a).

</span>
<span class="ltx_bibblock">Adaptive nearest neighbor machine translation.

</span>
<span class="ltx_bibblock">In <span class="ltx_text ltx_font_italic" id="bib.bib12.1.1">Proceedings of the 59th Annual Meeting of the Association for Computational Linguistics and the 11th International Joint Conference on Natural Language Processing (Volume 2: Short Papers)</span>, pages 368–374, Online. Association for Computational Linguistics.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib13">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">(13)</span>
<span class="ltx_bibblock">
Zheng, X., Zhang, Z., Huang, S., Chen, B., Xie, J., Luo, W., and Chen, J. (2021b).

</span>
<span class="ltx_bibblock">Non-parametric unsupervised domain adaptation for neural machine translation.

</span>
<span class="ltx_bibblock">In <span class="ltx_text ltx_font_italic" id="bib.bib13.1.1">Findings of the Association for Computational Linguistics: EMNLP 2021</span>, pages 4234–4241, Punta Cana, Dominican Republic. Association for Computational Linguistics.

</span>
</li>
</ul>
</section>
<div class="ltx_pagination ltx_role_end_2_columns"></div>
<div class="ltx_pagination ltx_role_newpage"></div>
</article>
</div>
<footer class="ltx_page_footer">
<div class="ltx_page_logo">Generated  on Mon Aug 19 08:49:21 2024 by <a class="ltx_LaTeXML_logo" href="http://dlmf.nist.gov/LaTeXML/"><span style="letter-spacing:-0.2em; margin-right:0.1em;">L<span class="ltx_font_smallcaps" style="position:relative; bottom:2.2pt;">a</span>T<span class="ltx_font_smallcaps" style="font-size:120%;position:relative; bottom:-0.2ex;">e</span></span><span style="font-size:90%; position:relative; bottom:-0.2ex;">XML</span><img alt="Mascot Sammy" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAsAAAAOCAYAAAD5YeaVAAAAAXNSR0IArs4c6QAAAAZiS0dEAP8A/wD/oL2nkwAAAAlwSFlzAAALEwAACxMBAJqcGAAAAAd0SU1FB9wKExQZLWTEaOUAAAAddEVYdENvbW1lbnQAQ3JlYXRlZCB3aXRoIFRoZSBHSU1Q72QlbgAAAdpJREFUKM9tkL+L2nAARz9fPZNCKFapUn8kyI0e4iRHSR1Kb8ng0lJw6FYHFwv2LwhOpcWxTjeUunYqOmqd6hEoRDhtDWdA8ApRYsSUCDHNt5ul13vz4w0vWCgUnnEc975arX6ORqN3VqtVZbfbTQC4uEHANM3jSqXymFI6yWazP2KxWAXAL9zCUa1Wy2tXVxheKA9YNoR8Pt+aTqe4FVVVvz05O6MBhqUIBGk8Hn8HAOVy+T+XLJfLS4ZhTiRJgqIoVBRFIoric47jPnmeB1mW/9rr9ZpSSn3Lsmir1fJZlqWlUonKsvwWwD8ymc/nXwVBeLjf7xEKhdBut9Hr9WgmkyGEkJwsy5eHG5vN5g0AKIoCAEgkEkin0wQAfN9/cXPdheu6P33fBwB4ngcAcByHJpPJl+fn54mD3Gg0NrquXxeLRQAAwzAYj8cwTZPwPH9/sVg8PXweDAauqqr2cDjEer1GJBLBZDJBs9mE4zjwfZ85lAGg2+06hmGgXq+j3+/DsixYlgVN03a9Xu8jgCNCyIegIAgx13Vfd7vdu+FweG8YRkjXdWy329+dTgeSJD3ieZ7RNO0VAXAPwDEAO5VKndi2fWrb9jWl9Esul6PZbDY9Go1OZ7PZ9z/lyuD3OozU2wAAAABJRU5ErkJggg=="/></a>
</div></footer>
</div>
</body>
</html>
