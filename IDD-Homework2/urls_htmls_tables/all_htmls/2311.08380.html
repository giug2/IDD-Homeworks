<!DOCTYPE html>
<html lang="en">
<head>
<meta content="text/html; charset=utf-8" http-equiv="content-type"/>
<title>Direct Preference Optimization for Neural Machine Translation with Minimum Bayes Risk Decoding</title>
<!--Generated on Wed May  1 19:05:43 2024 by LaTeXML (version 0.8.8) http://dlmf.nist.gov/LaTeXML/.-->
<meta content="width=device-width, initial-scale=1, shrink-to-fit=no" name="viewport"/>
<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet" type="text/css"/>
<link href="/static/browse/0.3.4/css/ar5iv.0.7.9.min.css" rel="stylesheet" type="text/css"/>
<link href="/static/browse/0.3.4/css/ar5iv-fonts.0.7.9.min.css" rel="stylesheet" type="text/css"/>
<link href="/static/browse/0.3.4/css/latexml_styles.css" rel="stylesheet" type="text/css"/>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.3.3/html2canvas.min.js"></script>
<script src="/static/browse/0.3.4/js/addons_new.js"></script>
<script src="/static/browse/0.3.4/js/feedbackOverlay.js"></script>
<base href="/html/2311.08380v2/"/></head>
<body>
<nav class="ltx_page_navbar">
<nav class="ltx_TOC">
<ol class="ltx_toclist">
<li class="ltx_tocentry ltx_tocentry_section"><a class="ltx_ref" href="https://arxiv.org/html/2311.08380v2#S1" title="In Direct Preference Optimization for Neural Machine Translation with Minimum Bayes Risk Decoding"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">1 </span>Introduction</span></a></li>
<li class="ltx_tocentry ltx_tocentry_section">
<a class="ltx_ref" href="https://arxiv.org/html/2311.08380v2#S2" title="In Direct Preference Optimization for Neural Machine Translation with Minimum Bayes Risk Decoding"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">2 </span>MBR and DPO</span></a>
<ol class="ltx_toclist ltx_toclist_section">
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2311.08380v2#S2.SS1" title="In 2 MBR and DPO ‣ Direct Preference Optimization for Neural Machine Translation with Minimum Bayes Risk Decoding"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">2.1 </span>DPO Fine-Tuning Objective</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2311.08380v2#S2.SS2" title="In 2 MBR and DPO ‣ Direct Preference Optimization for Neural Machine Translation with Minimum Bayes Risk Decoding"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">2.2 </span>Related Work in Translation</span></a></li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_section">
<a class="ltx_ref" href="https://arxiv.org/html/2311.08380v2#S3" title="In Direct Preference Optimization for Neural Machine Translation with Minimum Bayes Risk Decoding"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3 </span>Methodology</span></a>
<ol class="ltx_toclist ltx_toclist_section">
<li class="ltx_tocentry ltx_tocentry_subsection">
<a class="ltx_ref" href="https://arxiv.org/html/2311.08380v2#S3.SS1" title="In 3 Methodology ‣ Direct Preference Optimization for Neural Machine Translation with Minimum Bayes Risk Decoding"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3.1 </span>Creation of the DPO Preference Sets</span></a>
<ol class="ltx_toclist ltx_toclist_subsection">
<li class="ltx_tocentry ltx_tocentry_paragraph"><a class="ltx_ref" href="https://arxiv.org/html/2311.08380v2#S3.SS1.SSS0.Px1" title="In 3.1 Creation of the DPO Preference Sets ‣ 3 Methodology ‣ Direct Preference Optimization for Neural Machine Translation with Minimum Bayes Risk Decoding"><span class="ltx_text ltx_ref_title">Preference Selection Strategies</span></a></li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2311.08380v2#S3.SS2" title="In 3 Methodology ‣ Direct Preference Optimization for Neural Machine Translation with Minimum Bayes Risk Decoding"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3.2 </span>DPO Fine-Tuning</span></a></li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_section">
<a class="ltx_ref" href="https://arxiv.org/html/2311.08380v2#S4" title="In Direct Preference Optimization for Neural Machine Translation with Minimum Bayes Risk Decoding"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">4 </span>DPO MBR Fine-Tuning and MT</span></a>
<ol class="ltx_toclist ltx_toclist_section">
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2311.08380v2#S4.SS1" title="In 4 DPO MBR Fine-Tuning and MT ‣ Direct Preference Optimization for Neural Machine Translation with Minimum Bayes Risk Decoding"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">4.1 </span>DPO Fine-Tuning Teaches a MLLM to Learn Its MBR Preferences</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection">
<a class="ltx_ref" href="https://arxiv.org/html/2311.08380v2#S4.SS2" title="In 4 DPO MBR Fine-Tuning and MT ‣ Direct Preference Optimization for Neural Machine Translation with Minimum Bayes Risk Decoding"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">4.2 </span>DPO MBR Translation</span></a>
<ol class="ltx_toclist ltx_toclist_subsection">
<li class="ltx_tocentry ltx_tocentry_subsubsection"><a class="ltx_ref" href="https://arxiv.org/html/2311.08380v2#S4.SS2.SSS1" title="In 4.2 DPO MBR Translation ‣ 4 DPO MBR Fine-Tuning and MT ‣ Direct Preference Optimization for Neural Machine Translation with Minimum Bayes Risk Decoding"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">4.2.1 </span>KL-Divergence Regularization</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsubsection"><a class="ltx_ref" href="https://arxiv.org/html/2311.08380v2#S4.SS2.SSS2" title="In 4.2 DPO MBR Translation ‣ 4 DPO MBR Fine-Tuning and MT ‣ Direct Preference Optimization for Neural Machine Translation with Minimum Bayes Risk Decoding"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">4.2.2 </span>Effects of Pair Selection Strategy</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsubsection"><a class="ltx_ref" href="https://arxiv.org/html/2311.08380v2#S4.SS2.SSS3" title="In 4.2 DPO MBR Translation ‣ 4 DPO MBR Fine-Tuning and MT ‣ Direct Preference Optimization for Neural Machine Translation with Minimum Bayes Risk Decoding"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">4.2.3 </span>Effects of Size of Hypothesis Set</span></a></li>
</ol>
</li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_section"><a class="ltx_ref" href="https://arxiv.org/html/2311.08380v2#S5" title="In Direct Preference Optimization for Neural Machine Translation with Minimum Bayes Risk Decoding"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">5 </span>Conclusion</span></a></li>
<li class="ltx_tocentry ltx_tocentry_section"><a class="ltx_ref" href="https://arxiv.org/html/2311.08380v2#S6" title="In Direct Preference Optimization for Neural Machine Translation with Minimum Bayes Risk Decoding"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">6 </span>Acknowledgement</span></a></li>
<li class="ltx_tocentry ltx_tocentry_section"><a class="ltx_ref" href="https://arxiv.org/html/2311.08380v2#S7" title="In Direct Preference Optimization for Neural Machine Translation with Minimum Bayes Risk Decoding"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">7 </span>Limitations</span></a></li>
<li class="ltx_tocentry ltx_tocentry_section"><a class="ltx_ref" href="https://arxiv.org/html/2311.08380v2#S8" title="In Direct Preference Optimization for Neural Machine Translation with Minimum Bayes Risk Decoding"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">8 </span>Risks</span></a></li>
<li class="ltx_tocentry ltx_tocentry_appendix"><a class="ltx_ref" href="https://arxiv.org/html/2311.08380v2#A1" title="In Direct Preference Optimization for Neural Machine Translation with Minimum Bayes Risk Decoding"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">A </span>Translation Performance in BLEU</span></a></li>
<li class="ltx_tocentry ltx_tocentry_appendix">
<a class="ltx_ref" href="https://arxiv.org/html/2311.08380v2#A2" title="In Direct Preference Optimization for Neural Machine Translation with Minimum Bayes Risk Decoding"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">B </span>Training Details</span></a>
<ol class="ltx_toclist ltx_toclist_appendix">
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2311.08380v2#A2.SS1" title="In Appendix B Training Details ‣ Direct Preference Optimization for Neural Machine Translation with Minimum Bayes Risk Decoding"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">B.1 </span>DPO MBR Fine-tuning Details</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2311.08380v2#A2.SS2" title="In Appendix B Training Details ‣ Direct Preference Optimization for Neural Machine Translation with Minimum Bayes Risk Decoding"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">B.2 </span>Supervised Fine-tuning</span></a></li>
</ol>
</li>
</ol></nav>
</nav>
<div class="ltx_page_main">
<div class="ltx_page_content">
<article class="ltx_document">
<h1 class="ltx_title ltx_title_document">Direct Preference Optimization for Neural Machine Translation with Minimum Bayes Risk Decoding</h1>
<div class="ltx_authors">
<span class="ltx_creator ltx_role_author">
<span class="ltx_personname">Guangyu Yang, Jinghong Chen, Weizhe Lin, Bill Byrne 
<br class="ltx_break"/>Department of Engineering 
<br class="ltx_break"/>University of Cambridge 
<br class="ltx_break"/><span class="ltx_text ltx_font_typewriter" id="id1.1.id1">{gy266, jc2124, wl356, wjb31}@cam.ac.uk</span>
</span></span>
</div>
<div class="ltx_abstract">
<h6 class="ltx_title ltx_title_abstract">Abstract</h6>
<p class="ltx_p" id="id2.id1">Minimum Bayes Risk (MBR) decoding can significantly improve translation performance of Multilingual Large Language Models (MLLMs). However, MBR decoding is computationally expensive. We show how the recently developed Reinforcement Learning technique, Direct Preference Optimization (DPO), can fine-tune MLLMs to get the gains of MBR without any additional computation in inference. Our method uses only a small monolingual fine-tuning set and yields significantly improved performance on multiple NMT test sets compared to MLLMs without DPO.</p>
</div>
<div class="ltx_para ltx_noindent" id="p1">
<div class="ltx_block ltx_align_bottom" id="p1.1">
<p class="ltx_p" id="p1.1.1"><span class="ltx_text ltx_font_bold" id="p1.1.1.1">Direct Preference Optimization for Neural Machine Translation with Minimum Bayes Risk Decoding</span></p>
<br class="ltx_break ltx_centering"/>
<p class="ltx_p ltx_align_center" id="p1.1.2" style="width:433.6pt;"><span class="ltx_text ltx_inline-block" id="p1.1.2.1" style="width:0.0pt;">
<span class="ltx_tabular ltx_align_top" id="p1.1.2.1.1">
<span class="ltx_tbody">
<span class="ltx_tr" id="p1.1.2.1.1.1.1">
<span class="ltx_td ltx_align_center" id="p1.1.2.1.1.1.1.1"><span class="ltx_text ltx_font_bold" id="p1.1.2.1.1.1.1.1.1">Guangyu Yang, Jinghong Chen, Weizhe Lin, Bill Byrne</span></span></span>
<span class="ltx_tr" id="p1.1.2.1.1.2.2">
<span class="ltx_td ltx_align_center" id="p1.1.2.1.1.2.2.1">Department of Engineering</span></span>
<span class="ltx_tr" id="p1.1.2.1.1.3.3">
<span class="ltx_td ltx_align_center" id="p1.1.2.1.1.3.3.1">University of Cambridge</span></span>
<span class="ltx_tr" id="p1.1.2.1.1.4.4">
<span class="ltx_td ltx_align_center" id="p1.1.2.1.1.4.4.1"><span class="ltx_text ltx_font_typewriter" id="p1.1.2.1.1.4.4.1.1">{gy266, jc2124, wl356, wjb31}@cam.ac.uk</span></span></span>
</span>
</span></span></p>
<br class="ltx_break ltx_centering"/>
</div>
</div>
<section class="ltx_section" id="S1">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">1 </span>Introduction</h2>
<div class="ltx_para" id="S1.p1">
<p class="ltx_p" id="S1.p1.1">MBR decoding <cite class="ltx_cite ltx_citemacro_cite">Kumar and Byrne (<a class="ltx_ref" href="https://arxiv.org/html/2311.08380v2#bib.bib13" title="">2004</a>); Eikema and Aziz (<a class="ltx_ref" href="https://arxiv.org/html/2311.08380v2#bib.bib5" title="">2022</a>); Suzgun et al. (<a class="ltx_ref" href="https://arxiv.org/html/2311.08380v2#bib.bib22" title="">2023</a>)</cite> is a two-pass procedure that generates multiple translation hypotheses and selects a hypothesis based on Bayesian risk. Recent work <cite class="ltx_cite ltx_citemacro_cite">Garcia et al. (<a class="ltx_ref" href="https://arxiv.org/html/2311.08380v2#bib.bib9" title="">2023</a>); Suzgun et al. (<a class="ltx_ref" href="https://arxiv.org/html/2311.08380v2#bib.bib22" title="">2023</a>); Yang (<a class="ltx_ref" href="https://arxiv.org/html/2311.08380v2#bib.bib24" title="">2023</a>)</cite> has shown that MBR decoding can significantly boost the translation performance of MLLMs <cite class="ltx_cite ltx_citemacro_cite">Lin et al. (<a class="ltx_ref" href="https://arxiv.org/html/2311.08380v2#bib.bib14" title="">2022</a>); Muennighoff et al. (<a class="ltx_ref" href="https://arxiv.org/html/2311.08380v2#bib.bib15" title="">2023</a>); Zeng et al. (<a class="ltx_ref" href="https://arxiv.org/html/2311.08380v2#bib.bib25" title="">2023a</a>)</cite>, outperforming greedy decoding and beam search. However, MBR decoding is expensive, both in computation and in latency.</p>
</div>
<div class="ltx_para" id="S1.p2">
<p class="ltx_p" id="S1.p2.1">Our goal is to fine-tune a base MLLM so that it has the same single-pass decoding performance as MBR decoding. We propose
a novel self-supervised fine-tuning method based on DPO <cite class="ltx_cite ltx_citemacro_cite">Rafailov et al. (<a class="ltx_ref" href="https://arxiv.org/html/2311.08380v2#bib.bib18" title="">2023</a>)</cite>. Our method uses MBR decoding on an MLLM to produce a preference dataset consisting of pairs of ranked translations. The DPO algorithm is used to fine-tune the MLLM to prefer the higher-ranked translations over lower-ranked ones. MLLMs optimized for MBR preference achieve significantly better translation performance when decoded with beam search, achieving translation quality on par with MBR decoding of the original model.</p>
</div>
</section>
<section class="ltx_section" id="S2">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">2 </span>MBR and DPO</h2>
<div class="ltx_para" id="S2.p1">
<p class="ltx_p" id="S2.p1.2">We follow the expectation-by-sampling approach to MBR <cite class="ltx_cite ltx_citemacro_cite">Eikema and Aziz (<a class="ltx_ref" href="https://arxiv.org/html/2311.08380v2#bib.bib5" title="">2022</a>)</cite>. Given a set of sampled translations <math alttext="H({\bf x})=\{{\bf y}^{\prime}\sim P(\cdot|{\bf x})\}" class="ltx_math_unparsed" display="inline" id="S2.p1.1.m1.1"><semantics id="S2.p1.1.m1.1a"><mrow id="S2.p1.1.m1.1b"><mi id="S2.p1.1.m1.1.2">H</mi><mrow id="S2.p1.1.m1.1.3"><mo id="S2.p1.1.m1.1.3.1" stretchy="false">(</mo><mi id="S2.p1.1.m1.1.1">𝐱</mi><mo id="S2.p1.1.m1.1.3.2" stretchy="false">)</mo></mrow><mo id="S2.p1.1.m1.1.4">=</mo><mrow id="S2.p1.1.m1.1.5"><mo id="S2.p1.1.m1.1.5.1" stretchy="false">{</mo><msup id="S2.p1.1.m1.1.5.2"><mi id="S2.p1.1.m1.1.5.2.2">𝐲</mi><mo id="S2.p1.1.m1.1.5.2.3">′</mo></msup><mo id="S2.p1.1.m1.1.5.3">∼</mo><mi id="S2.p1.1.m1.1.5.4">P</mi><mrow id="S2.p1.1.m1.1.5.5"><mo id="S2.p1.1.m1.1.5.5.1" stretchy="false">(</mo><mo id="S2.p1.1.m1.1.5.5.2" lspace="0em" rspace="0em">⋅</mo><mo fence="false" id="S2.p1.1.m1.1.5.5.3" rspace="0.167em" stretchy="false">|</mo><mi id="S2.p1.1.m1.1.5.5.4">𝐱</mi><mo id="S2.p1.1.m1.1.5.5.5" stretchy="false">)</mo></mrow><mo id="S2.p1.1.m1.1.5.6" stretchy="false">}</mo></mrow></mrow><annotation encoding="application/x-tex" id="S2.p1.1.m1.1c">H({\bf x})=\{{\bf y}^{\prime}\sim P(\cdot|{\bf x})\}</annotation><annotation encoding="application/x-llamapun" id="S2.p1.1.m1.1d">italic_H ( bold_x ) = { bold_y start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT ∼ italic_P ( ⋅ | bold_x ) }</annotation></semantics></math> and a loss (or utility) function <math alttext="L(\cdot,\cdot)" class="ltx_Math" display="inline" id="S2.p1.2.m2.2"><semantics id="S2.p1.2.m2.2a"><mrow id="S2.p1.2.m2.2.3" xref="S2.p1.2.m2.2.3.cmml"><mi id="S2.p1.2.m2.2.3.2" xref="S2.p1.2.m2.2.3.2.cmml">L</mi><mo id="S2.p1.2.m2.2.3.1" xref="S2.p1.2.m2.2.3.1.cmml">⁢</mo><mrow id="S2.p1.2.m2.2.3.3.2" xref="S2.p1.2.m2.2.3.3.1.cmml"><mo id="S2.p1.2.m2.2.3.3.2.1" stretchy="false" xref="S2.p1.2.m2.2.3.3.1.cmml">(</mo><mo id="S2.p1.2.m2.1.1" lspace="0em" rspace="0em" xref="S2.p1.2.m2.1.1.cmml">⋅</mo><mo id="S2.p1.2.m2.2.3.3.2.2" rspace="0em" xref="S2.p1.2.m2.2.3.3.1.cmml">,</mo><mo id="S2.p1.2.m2.2.2" lspace="0em" rspace="0em" xref="S2.p1.2.m2.2.2.cmml">⋅</mo><mo id="S2.p1.2.m2.2.3.3.2.3" stretchy="false" xref="S2.p1.2.m2.2.3.3.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.p1.2.m2.2b"><apply id="S2.p1.2.m2.2.3.cmml" xref="S2.p1.2.m2.2.3"><times id="S2.p1.2.m2.2.3.1.cmml" xref="S2.p1.2.m2.2.3.1"></times><ci id="S2.p1.2.m2.2.3.2.cmml" xref="S2.p1.2.m2.2.3.2">𝐿</ci><interval closure="open" id="S2.p1.2.m2.2.3.3.1.cmml" xref="S2.p1.2.m2.2.3.3.2"><ci id="S2.p1.2.m2.1.1.cmml" xref="S2.p1.2.m2.1.1">⋅</ci><ci id="S2.p1.2.m2.2.2.cmml" xref="S2.p1.2.m2.2.2">⋅</ci></interval></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.p1.2.m2.2c">L(\cdot,\cdot)</annotation><annotation encoding="application/x-llamapun" id="S2.p1.2.m2.2d">italic_L ( ⋅ , ⋅ )</annotation></semantics></math>, the score (negative Bayes risk) of each translation is found as</p>
<table class="ltx_equation ltx_eqn_table" id="S2.E1">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="S({\bf y})=-\frac{1}{|H(x)|}\sum_{{\bf y}^{\prime}\in H({\bf x})}L({\bf y}^{%
\prime},{\bf y})" class="ltx_Math" display="block" id="S2.E1.m1.6"><semantics id="S2.E1.m1.6a"><mrow id="S2.E1.m1.6.6" xref="S2.E1.m1.6.6.cmml"><mrow id="S2.E1.m1.6.6.3" xref="S2.E1.m1.6.6.3.cmml"><mi id="S2.E1.m1.6.6.3.2" xref="S2.E1.m1.6.6.3.2.cmml">S</mi><mo id="S2.E1.m1.6.6.3.1" xref="S2.E1.m1.6.6.3.1.cmml">⁢</mo><mrow id="S2.E1.m1.6.6.3.3.2" xref="S2.E1.m1.6.6.3.cmml"><mo id="S2.E1.m1.6.6.3.3.2.1" stretchy="false" xref="S2.E1.m1.6.6.3.cmml">(</mo><mi id="S2.E1.m1.4.4" xref="S2.E1.m1.4.4.cmml">𝐲</mi><mo id="S2.E1.m1.6.6.3.3.2.2" stretchy="false" xref="S2.E1.m1.6.6.3.cmml">)</mo></mrow></mrow><mo id="S2.E1.m1.6.6.2" xref="S2.E1.m1.6.6.2.cmml">=</mo><mrow id="S2.E1.m1.6.6.1" xref="S2.E1.m1.6.6.1.cmml"><mo id="S2.E1.m1.6.6.1a" xref="S2.E1.m1.6.6.1.cmml">−</mo><mrow id="S2.E1.m1.6.6.1.1" xref="S2.E1.m1.6.6.1.1.cmml"><mfrac id="S2.E1.m1.2.2" xref="S2.E1.m1.2.2.cmml"><mn id="S2.E1.m1.2.2.4" xref="S2.E1.m1.2.2.4.cmml">1</mn><mrow id="S2.E1.m1.2.2.2.2" xref="S2.E1.m1.2.2.2.3.cmml"><mo id="S2.E1.m1.2.2.2.2.2" stretchy="false" xref="S2.E1.m1.2.2.2.3.1.cmml">|</mo><mrow id="S2.E1.m1.2.2.2.2.1" xref="S2.E1.m1.2.2.2.2.1.cmml"><mi id="S2.E1.m1.2.2.2.2.1.2" xref="S2.E1.m1.2.2.2.2.1.2.cmml">H</mi><mo id="S2.E1.m1.2.2.2.2.1.1" xref="S2.E1.m1.2.2.2.2.1.1.cmml">⁢</mo><mrow id="S2.E1.m1.2.2.2.2.1.3.2" xref="S2.E1.m1.2.2.2.2.1.cmml"><mo id="S2.E1.m1.2.2.2.2.1.3.2.1" stretchy="false" xref="S2.E1.m1.2.2.2.2.1.cmml">(</mo><mi id="S2.E1.m1.1.1.1.1" xref="S2.E1.m1.1.1.1.1.cmml">x</mi><mo id="S2.E1.m1.2.2.2.2.1.3.2.2" stretchy="false" xref="S2.E1.m1.2.2.2.2.1.cmml">)</mo></mrow></mrow><mo id="S2.E1.m1.2.2.2.2.3" stretchy="false" xref="S2.E1.m1.2.2.2.3.1.cmml">|</mo></mrow></mfrac><mo id="S2.E1.m1.6.6.1.1.2" xref="S2.E1.m1.6.6.1.1.2.cmml">⁢</mo><mrow id="S2.E1.m1.6.6.1.1.1" xref="S2.E1.m1.6.6.1.1.1.cmml"><munder id="S2.E1.m1.6.6.1.1.1.2" xref="S2.E1.m1.6.6.1.1.1.2.cmml"><mo id="S2.E1.m1.6.6.1.1.1.2.2" movablelimits="false" xref="S2.E1.m1.6.6.1.1.1.2.2.cmml">∑</mo><mrow id="S2.E1.m1.3.3.1" xref="S2.E1.m1.3.3.1.cmml"><msup id="S2.E1.m1.3.3.1.3" xref="S2.E1.m1.3.3.1.3.cmml"><mi id="S2.E1.m1.3.3.1.3.2" xref="S2.E1.m1.3.3.1.3.2.cmml">𝐲</mi><mo id="S2.E1.m1.3.3.1.3.3" xref="S2.E1.m1.3.3.1.3.3.cmml">′</mo></msup><mo id="S2.E1.m1.3.3.1.2" xref="S2.E1.m1.3.3.1.2.cmml">∈</mo><mrow id="S2.E1.m1.3.3.1.4" xref="S2.E1.m1.3.3.1.4.cmml"><mi id="S2.E1.m1.3.3.1.4.2" xref="S2.E1.m1.3.3.1.4.2.cmml">H</mi><mo id="S2.E1.m1.3.3.1.4.1" xref="S2.E1.m1.3.3.1.4.1.cmml">⁢</mo><mrow id="S2.E1.m1.3.3.1.4.3.2" xref="S2.E1.m1.3.3.1.4.cmml"><mo id="S2.E1.m1.3.3.1.4.3.2.1" stretchy="false" xref="S2.E1.m1.3.3.1.4.cmml">(</mo><mi id="S2.E1.m1.3.3.1.1" xref="S2.E1.m1.3.3.1.1.cmml">𝐱</mi><mo id="S2.E1.m1.3.3.1.4.3.2.2" stretchy="false" xref="S2.E1.m1.3.3.1.4.cmml">)</mo></mrow></mrow></mrow></munder><mrow id="S2.E1.m1.6.6.1.1.1.1" xref="S2.E1.m1.6.6.1.1.1.1.cmml"><mi id="S2.E1.m1.6.6.1.1.1.1.3" xref="S2.E1.m1.6.6.1.1.1.1.3.cmml">L</mi><mo id="S2.E1.m1.6.6.1.1.1.1.2" xref="S2.E1.m1.6.6.1.1.1.1.2.cmml">⁢</mo><mrow id="S2.E1.m1.6.6.1.1.1.1.1.1" xref="S2.E1.m1.6.6.1.1.1.1.1.2.cmml"><mo id="S2.E1.m1.6.6.1.1.1.1.1.1.2" stretchy="false" xref="S2.E1.m1.6.6.1.1.1.1.1.2.cmml">(</mo><msup id="S2.E1.m1.6.6.1.1.1.1.1.1.1" xref="S2.E1.m1.6.6.1.1.1.1.1.1.1.cmml"><mi id="S2.E1.m1.6.6.1.1.1.1.1.1.1.2" xref="S2.E1.m1.6.6.1.1.1.1.1.1.1.2.cmml">𝐲</mi><mo id="S2.E1.m1.6.6.1.1.1.1.1.1.1.3" xref="S2.E1.m1.6.6.1.1.1.1.1.1.1.3.cmml">′</mo></msup><mo id="S2.E1.m1.6.6.1.1.1.1.1.1.3" xref="S2.E1.m1.6.6.1.1.1.1.1.2.cmml">,</mo><mi id="S2.E1.m1.5.5" xref="S2.E1.m1.5.5.cmml">𝐲</mi><mo id="S2.E1.m1.6.6.1.1.1.1.1.1.4" stretchy="false" xref="S2.E1.m1.6.6.1.1.1.1.1.2.cmml">)</mo></mrow></mrow></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.E1.m1.6b"><apply id="S2.E1.m1.6.6.cmml" xref="S2.E1.m1.6.6"><eq id="S2.E1.m1.6.6.2.cmml" xref="S2.E1.m1.6.6.2"></eq><apply id="S2.E1.m1.6.6.3.cmml" xref="S2.E1.m1.6.6.3"><times id="S2.E1.m1.6.6.3.1.cmml" xref="S2.E1.m1.6.6.3.1"></times><ci id="S2.E1.m1.6.6.3.2.cmml" xref="S2.E1.m1.6.6.3.2">𝑆</ci><ci id="S2.E1.m1.4.4.cmml" xref="S2.E1.m1.4.4">𝐲</ci></apply><apply id="S2.E1.m1.6.6.1.cmml" xref="S2.E1.m1.6.6.1"><minus id="S2.E1.m1.6.6.1.2.cmml" xref="S2.E1.m1.6.6.1"></minus><apply id="S2.E1.m1.6.6.1.1.cmml" xref="S2.E1.m1.6.6.1.1"><times id="S2.E1.m1.6.6.1.1.2.cmml" xref="S2.E1.m1.6.6.1.1.2"></times><apply id="S2.E1.m1.2.2.cmml" xref="S2.E1.m1.2.2"><divide id="S2.E1.m1.2.2.3.cmml" xref="S2.E1.m1.2.2"></divide><cn id="S2.E1.m1.2.2.4.cmml" type="integer" xref="S2.E1.m1.2.2.4">1</cn><apply id="S2.E1.m1.2.2.2.3.cmml" xref="S2.E1.m1.2.2.2.2"><abs id="S2.E1.m1.2.2.2.3.1.cmml" xref="S2.E1.m1.2.2.2.2.2"></abs><apply id="S2.E1.m1.2.2.2.2.1.cmml" xref="S2.E1.m1.2.2.2.2.1"><times id="S2.E1.m1.2.2.2.2.1.1.cmml" xref="S2.E1.m1.2.2.2.2.1.1"></times><ci id="S2.E1.m1.2.2.2.2.1.2.cmml" xref="S2.E1.m1.2.2.2.2.1.2">𝐻</ci><ci id="S2.E1.m1.1.1.1.1.cmml" xref="S2.E1.m1.1.1.1.1">𝑥</ci></apply></apply></apply><apply id="S2.E1.m1.6.6.1.1.1.cmml" xref="S2.E1.m1.6.6.1.1.1"><apply id="S2.E1.m1.6.6.1.1.1.2.cmml" xref="S2.E1.m1.6.6.1.1.1.2"><csymbol cd="ambiguous" id="S2.E1.m1.6.6.1.1.1.2.1.cmml" xref="S2.E1.m1.6.6.1.1.1.2">subscript</csymbol><sum id="S2.E1.m1.6.6.1.1.1.2.2.cmml" xref="S2.E1.m1.6.6.1.1.1.2.2"></sum><apply id="S2.E1.m1.3.3.1.cmml" xref="S2.E1.m1.3.3.1"><in id="S2.E1.m1.3.3.1.2.cmml" xref="S2.E1.m1.3.3.1.2"></in><apply id="S2.E1.m1.3.3.1.3.cmml" xref="S2.E1.m1.3.3.1.3"><csymbol cd="ambiguous" id="S2.E1.m1.3.3.1.3.1.cmml" xref="S2.E1.m1.3.3.1.3">superscript</csymbol><ci id="S2.E1.m1.3.3.1.3.2.cmml" xref="S2.E1.m1.3.3.1.3.2">𝐲</ci><ci id="S2.E1.m1.3.3.1.3.3.cmml" xref="S2.E1.m1.3.3.1.3.3">′</ci></apply><apply id="S2.E1.m1.3.3.1.4.cmml" xref="S2.E1.m1.3.3.1.4"><times id="S2.E1.m1.3.3.1.4.1.cmml" xref="S2.E1.m1.3.3.1.4.1"></times><ci id="S2.E1.m1.3.3.1.4.2.cmml" xref="S2.E1.m1.3.3.1.4.2">𝐻</ci><ci id="S2.E1.m1.3.3.1.1.cmml" xref="S2.E1.m1.3.3.1.1">𝐱</ci></apply></apply></apply><apply id="S2.E1.m1.6.6.1.1.1.1.cmml" xref="S2.E1.m1.6.6.1.1.1.1"><times id="S2.E1.m1.6.6.1.1.1.1.2.cmml" xref="S2.E1.m1.6.6.1.1.1.1.2"></times><ci id="S2.E1.m1.6.6.1.1.1.1.3.cmml" xref="S2.E1.m1.6.6.1.1.1.1.3">𝐿</ci><interval closure="open" id="S2.E1.m1.6.6.1.1.1.1.1.2.cmml" xref="S2.E1.m1.6.6.1.1.1.1.1.1"><apply id="S2.E1.m1.6.6.1.1.1.1.1.1.1.cmml" xref="S2.E1.m1.6.6.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S2.E1.m1.6.6.1.1.1.1.1.1.1.1.cmml" xref="S2.E1.m1.6.6.1.1.1.1.1.1.1">superscript</csymbol><ci id="S2.E1.m1.6.6.1.1.1.1.1.1.1.2.cmml" xref="S2.E1.m1.6.6.1.1.1.1.1.1.1.2">𝐲</ci><ci id="S2.E1.m1.6.6.1.1.1.1.1.1.1.3.cmml" xref="S2.E1.m1.6.6.1.1.1.1.1.1.1.3">′</ci></apply><ci id="S2.E1.m1.5.5.cmml" xref="S2.E1.m1.5.5">𝐲</ci></interval></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.E1.m1.6c">S({\bf y})=-\frac{1}{|H(x)|}\sum_{{\bf y}^{\prime}\in H({\bf x})}L({\bf y}^{%
\prime},{\bf y})</annotation><annotation encoding="application/x-llamapun" id="S2.E1.m1.6d">italic_S ( bold_y ) = - divide start_ARG 1 end_ARG start_ARG | italic_H ( italic_x ) | end_ARG ∑ start_POSTSUBSCRIPT bold_y start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT ∈ italic_H ( bold_x ) end_POSTSUBSCRIPT italic_L ( bold_y start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT , bold_y )</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(1)</span></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S2.p1.3">and the MBR hypothesis is then computed as</p>
<table class="ltx_equation ltx_eqn_table" id="S2.E2">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\mathbf{y}^{*}=\operatorname*{arg\,max}_{\mathbf{y}\in H({\bf x})}S(\mathbf{y})" class="ltx_Math" display="block" id="S2.E2.m1.2"><semantics id="S2.E2.m1.2a"><mrow id="S2.E2.m1.2.3" xref="S2.E2.m1.2.3.cmml"><msup id="S2.E2.m1.2.3.2" xref="S2.E2.m1.2.3.2.cmml"><mi id="S2.E2.m1.2.3.2.2" xref="S2.E2.m1.2.3.2.2.cmml">𝐲</mi><mo id="S2.E2.m1.2.3.2.3" xref="S2.E2.m1.2.3.2.3.cmml">∗</mo></msup><mo id="S2.E2.m1.2.3.1" xref="S2.E2.m1.2.3.1.cmml">=</mo><mrow id="S2.E2.m1.2.3.3" xref="S2.E2.m1.2.3.3.cmml"><mrow id="S2.E2.m1.2.3.3.2" xref="S2.E2.m1.2.3.3.2.cmml"><munder id="S2.E2.m1.2.3.3.2.1" xref="S2.E2.m1.2.3.3.2.1.cmml"><mrow id="S2.E2.m1.2.3.3.2.1.2" xref="S2.E2.m1.2.3.3.2.1.2.cmml"><mi id="S2.E2.m1.2.3.3.2.1.2.2" xref="S2.E2.m1.2.3.3.2.1.2.2.cmml">arg</mi><mo id="S2.E2.m1.2.3.3.2.1.2.1" lspace="0.170em" xref="S2.E2.m1.2.3.3.2.1.2.1.cmml">⁢</mo><mi id="S2.E2.m1.2.3.3.2.1.2.3" xref="S2.E2.m1.2.3.3.2.1.2.3.cmml">max</mi></mrow><mrow id="S2.E2.m1.1.1.1" xref="S2.E2.m1.1.1.1.cmml"><mi id="S2.E2.m1.1.1.1.3" xref="S2.E2.m1.1.1.1.3.cmml">𝐲</mi><mo id="S2.E2.m1.1.1.1.2" xref="S2.E2.m1.1.1.1.2.cmml">∈</mo><mrow id="S2.E2.m1.1.1.1.4" xref="S2.E2.m1.1.1.1.4.cmml"><mi id="S2.E2.m1.1.1.1.4.2" xref="S2.E2.m1.1.1.1.4.2.cmml">H</mi><mo id="S2.E2.m1.1.1.1.4.1" xref="S2.E2.m1.1.1.1.4.1.cmml">⁢</mo><mrow id="S2.E2.m1.1.1.1.4.3.2" xref="S2.E2.m1.1.1.1.4.cmml"><mo id="S2.E2.m1.1.1.1.4.3.2.1" stretchy="false" xref="S2.E2.m1.1.1.1.4.cmml">(</mo><mi id="S2.E2.m1.1.1.1.1" xref="S2.E2.m1.1.1.1.1.cmml">𝐱</mi><mo id="S2.E2.m1.1.1.1.4.3.2.2" stretchy="false" xref="S2.E2.m1.1.1.1.4.cmml">)</mo></mrow></mrow></mrow></munder><mo id="S2.E2.m1.2.3.3.2a" xref="S2.E2.m1.2.3.3.2.cmml">⁡</mo><mi id="S2.E2.m1.2.3.3.2.2" xref="S2.E2.m1.2.3.3.2.2.cmml">S</mi></mrow><mo id="S2.E2.m1.2.3.3.1" xref="S2.E2.m1.2.3.3.1.cmml">⁢</mo><mrow id="S2.E2.m1.2.3.3.3.2" xref="S2.E2.m1.2.3.3.cmml"><mo id="S2.E2.m1.2.3.3.3.2.1" stretchy="false" xref="S2.E2.m1.2.3.3.cmml">(</mo><mi id="S2.E2.m1.2.2" xref="S2.E2.m1.2.2.cmml">𝐲</mi><mo id="S2.E2.m1.2.3.3.3.2.2" stretchy="false" xref="S2.E2.m1.2.3.3.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.E2.m1.2b"><apply id="S2.E2.m1.2.3.cmml" xref="S2.E2.m1.2.3"><eq id="S2.E2.m1.2.3.1.cmml" xref="S2.E2.m1.2.3.1"></eq><apply id="S2.E2.m1.2.3.2.cmml" xref="S2.E2.m1.2.3.2"><csymbol cd="ambiguous" id="S2.E2.m1.2.3.2.1.cmml" xref="S2.E2.m1.2.3.2">superscript</csymbol><ci id="S2.E2.m1.2.3.2.2.cmml" xref="S2.E2.m1.2.3.2.2">𝐲</ci><times id="S2.E2.m1.2.3.2.3.cmml" xref="S2.E2.m1.2.3.2.3"></times></apply><apply id="S2.E2.m1.2.3.3.cmml" xref="S2.E2.m1.2.3.3"><times id="S2.E2.m1.2.3.3.1.cmml" xref="S2.E2.m1.2.3.3.1"></times><apply id="S2.E2.m1.2.3.3.2.cmml" xref="S2.E2.m1.2.3.3.2"><apply id="S2.E2.m1.2.3.3.2.1.cmml" xref="S2.E2.m1.2.3.3.2.1"><csymbol cd="ambiguous" id="S2.E2.m1.2.3.3.2.1.1.cmml" xref="S2.E2.m1.2.3.3.2.1">subscript</csymbol><apply id="S2.E2.m1.2.3.3.2.1.2.cmml" xref="S2.E2.m1.2.3.3.2.1.2"><times id="S2.E2.m1.2.3.3.2.1.2.1.cmml" xref="S2.E2.m1.2.3.3.2.1.2.1"></times><ci id="S2.E2.m1.2.3.3.2.1.2.2.cmml" xref="S2.E2.m1.2.3.3.2.1.2.2">arg</ci><ci id="S2.E2.m1.2.3.3.2.1.2.3.cmml" xref="S2.E2.m1.2.3.3.2.1.2.3">max</ci></apply><apply id="S2.E2.m1.1.1.1.cmml" xref="S2.E2.m1.1.1.1"><in id="S2.E2.m1.1.1.1.2.cmml" xref="S2.E2.m1.1.1.1.2"></in><ci id="S2.E2.m1.1.1.1.3.cmml" xref="S2.E2.m1.1.1.1.3">𝐲</ci><apply id="S2.E2.m1.1.1.1.4.cmml" xref="S2.E2.m1.1.1.1.4"><times id="S2.E2.m1.1.1.1.4.1.cmml" xref="S2.E2.m1.1.1.1.4.1"></times><ci id="S2.E2.m1.1.1.1.4.2.cmml" xref="S2.E2.m1.1.1.1.4.2">𝐻</ci><ci id="S2.E2.m1.1.1.1.1.cmml" xref="S2.E2.m1.1.1.1.1">𝐱</ci></apply></apply></apply><ci id="S2.E2.m1.2.3.3.2.2.cmml" xref="S2.E2.m1.2.3.3.2.2">𝑆</ci></apply><ci id="S2.E2.m1.2.2.cmml" xref="S2.E2.m1.2.2">𝐲</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.E2.m1.2c">\mathbf{y}^{*}=\operatorname*{arg\,max}_{\mathbf{y}\in H({\bf x})}S(\mathbf{y})</annotation><annotation encoding="application/x-llamapun" id="S2.E2.m1.2d">bold_y start_POSTSUPERSCRIPT ∗ end_POSTSUPERSCRIPT = start_OPERATOR roman_arg roman_max end_OPERATOR start_POSTSUBSCRIPT bold_y ∈ italic_H ( bold_x ) end_POSTSUBSCRIPT italic_S ( bold_y )</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(2)</span></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S2.p1.4">This is simple but expensive. Our goal is to train a model that produces translations with scores consistent with MBR, but without multi-step decoding.
</p>
</div>
<section class="ltx_subsection" id="S2.SS1">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">2.1 </span>DPO Fine-Tuning Objective</h3>
<div class="ltx_para" id="S2.SS1.p1">
<p class="ltx_p" id="S2.SS1.p1.6">DPO <cite class="ltx_cite ltx_citemacro_cite">Rafailov et al. (<a class="ltx_ref" href="https://arxiv.org/html/2311.08380v2#bib.bib18" title="">2023</a>)</cite> reformulates the usual approach to Reinforcement Learning from Human Feedback (RLHF)
so as to avoid a distinct reward modelling step. The typical RLHF criteria is</p>
<table class="ltx_equationgroup ltx_eqn_align ltx_eqn_table" id="A2.EGx1">
<tbody id="S2.E3"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math alttext="\displaystyle\max_{\pi_{\theta}}~{}" class="ltx_Math" display="inline" id="S2.E3.m1.1"><semantics id="S2.E3.m1.1a"><munder id="S2.E3.m1.1.1" xref="S2.E3.m1.1.1.cmml"><mi id="S2.E3.m1.1.1.2" xref="S2.E3.m1.1.1.2.cmml">max</mi><msub id="S2.E3.m1.1.1.3" xref="S2.E3.m1.1.1.3.cmml"><mi id="S2.E3.m1.1.1.3.2" xref="S2.E3.m1.1.1.3.2.cmml">π</mi><mi id="S2.E3.m1.1.1.3.3" xref="S2.E3.m1.1.1.3.3.cmml">θ</mi></msub></munder><annotation-xml encoding="MathML-Content" id="S2.E3.m1.1b"><apply id="S2.E3.m1.1.1.cmml" xref="S2.E3.m1.1.1"><csymbol cd="ambiguous" id="S2.E3.m1.1.1.1.cmml" xref="S2.E3.m1.1.1">subscript</csymbol><max id="S2.E3.m1.1.1.2.cmml" xref="S2.E3.m1.1.1.2"></max><apply id="S2.E3.m1.1.1.3.cmml" xref="S2.E3.m1.1.1.3"><csymbol cd="ambiguous" id="S2.E3.m1.1.1.3.1.cmml" xref="S2.E3.m1.1.1.3">subscript</csymbol><ci id="S2.E3.m1.1.1.3.2.cmml" xref="S2.E3.m1.1.1.3.2">𝜋</ci><ci id="S2.E3.m1.1.1.3.3.cmml" xref="S2.E3.m1.1.1.3.3">𝜃</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.E3.m1.1c">\displaystyle\max_{\pi_{\theta}}~{}</annotation><annotation encoding="application/x-llamapun" id="S2.E3.m1.1d">roman_max start_POSTSUBSCRIPT italic_π start_POSTSUBSCRIPT italic_θ end_POSTSUBSCRIPT end_POSTSUBSCRIPT</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle\mathbb{E}_{\mathbf{x}\sim D,\mathbf{y}\sim\pi_{\theta}(\mathbf{y%
}|\mathbf{x})}\left[r_{\phi}(\mathbf{x},\mathbf{y})\right]" class="ltx_Math" display="inline" id="S2.E3.m2.5"><semantics id="S2.E3.m2.5a"><mrow id="S2.E3.m2.5.5" xref="S2.E3.m2.5.5.cmml"><msub id="S2.E3.m2.5.5.3" xref="S2.E3.m2.5.5.3.cmml"><mi id="S2.E3.m2.5.5.3.2" xref="S2.E3.m2.5.5.3.2.cmml">𝔼</mi><mrow id="S2.E3.m2.2.2.2.2" xref="S2.E3.m2.2.2.2.3.cmml"><mrow id="S2.E3.m2.1.1.1.1.1" xref="S2.E3.m2.1.1.1.1.1.cmml"><mi id="S2.E3.m2.1.1.1.1.1.2" xref="S2.E3.m2.1.1.1.1.1.2.cmml">𝐱</mi><mo id="S2.E3.m2.1.1.1.1.1.1" xref="S2.E3.m2.1.1.1.1.1.1.cmml">∼</mo><mi id="S2.E3.m2.1.1.1.1.1.3" xref="S2.E3.m2.1.1.1.1.1.3.cmml">D</mi></mrow><mo id="S2.E3.m2.2.2.2.2.3" xref="S2.E3.m2.2.2.2.3a.cmml">,</mo><mrow id="S2.E3.m2.2.2.2.2.2" xref="S2.E3.m2.2.2.2.2.2.cmml"><mi id="S2.E3.m2.2.2.2.2.2.3" xref="S2.E3.m2.2.2.2.2.2.3.cmml">𝐲</mi><mo id="S2.E3.m2.2.2.2.2.2.2" xref="S2.E3.m2.2.2.2.2.2.2.cmml">∼</mo><mrow id="S2.E3.m2.2.2.2.2.2.1" xref="S2.E3.m2.2.2.2.2.2.1.cmml"><msub id="S2.E3.m2.2.2.2.2.2.1.3" xref="S2.E3.m2.2.2.2.2.2.1.3.cmml"><mi id="S2.E3.m2.2.2.2.2.2.1.3.2" xref="S2.E3.m2.2.2.2.2.2.1.3.2.cmml">π</mi><mi id="S2.E3.m2.2.2.2.2.2.1.3.3" xref="S2.E3.m2.2.2.2.2.2.1.3.3.cmml">θ</mi></msub><mo id="S2.E3.m2.2.2.2.2.2.1.2" xref="S2.E3.m2.2.2.2.2.2.1.2.cmml">⁢</mo><mrow id="S2.E3.m2.2.2.2.2.2.1.1.1" xref="S2.E3.m2.2.2.2.2.2.1.1.1.1.cmml"><mo id="S2.E3.m2.2.2.2.2.2.1.1.1.2" stretchy="false" xref="S2.E3.m2.2.2.2.2.2.1.1.1.1.cmml">(</mo><mrow id="S2.E3.m2.2.2.2.2.2.1.1.1.1" xref="S2.E3.m2.2.2.2.2.2.1.1.1.1.cmml"><mi id="S2.E3.m2.2.2.2.2.2.1.1.1.1.2" xref="S2.E3.m2.2.2.2.2.2.1.1.1.1.2.cmml">𝐲</mi><mo fence="false" id="S2.E3.m2.2.2.2.2.2.1.1.1.1.1" xref="S2.E3.m2.2.2.2.2.2.1.1.1.1.1.cmml">|</mo><mi id="S2.E3.m2.2.2.2.2.2.1.1.1.1.3" xref="S2.E3.m2.2.2.2.2.2.1.1.1.1.3.cmml">𝐱</mi></mrow><mo id="S2.E3.m2.2.2.2.2.2.1.1.1.3" stretchy="false" xref="S2.E3.m2.2.2.2.2.2.1.1.1.1.cmml">)</mo></mrow></mrow></mrow></mrow></msub><mo id="S2.E3.m2.5.5.2" xref="S2.E3.m2.5.5.2.cmml">⁢</mo><mrow id="S2.E3.m2.5.5.1.1" xref="S2.E3.m2.5.5.1.2.cmml"><mo id="S2.E3.m2.5.5.1.1.2" xref="S2.E3.m2.5.5.1.2.1.cmml">[</mo><mrow id="S2.E3.m2.5.5.1.1.1" xref="S2.E3.m2.5.5.1.1.1.cmml"><msub id="S2.E3.m2.5.5.1.1.1.2" xref="S2.E3.m2.5.5.1.1.1.2.cmml"><mi id="S2.E3.m2.5.5.1.1.1.2.2" xref="S2.E3.m2.5.5.1.1.1.2.2.cmml">r</mi><mi id="S2.E3.m2.5.5.1.1.1.2.3" xref="S2.E3.m2.5.5.1.1.1.2.3.cmml">ϕ</mi></msub><mo id="S2.E3.m2.5.5.1.1.1.1" xref="S2.E3.m2.5.5.1.1.1.1.cmml">⁢</mo><mrow id="S2.E3.m2.5.5.1.1.1.3.2" xref="S2.E3.m2.5.5.1.1.1.3.1.cmml"><mo id="S2.E3.m2.5.5.1.1.1.3.2.1" stretchy="false" xref="S2.E3.m2.5.5.1.1.1.3.1.cmml">(</mo><mi id="S2.E3.m2.3.3" xref="S2.E3.m2.3.3.cmml">𝐱</mi><mo id="S2.E3.m2.5.5.1.1.1.3.2.2" xref="S2.E3.m2.5.5.1.1.1.3.1.cmml">,</mo><mi id="S2.E3.m2.4.4" xref="S2.E3.m2.4.4.cmml">𝐲</mi><mo id="S2.E3.m2.5.5.1.1.1.3.2.3" stretchy="false" xref="S2.E3.m2.5.5.1.1.1.3.1.cmml">)</mo></mrow></mrow><mo id="S2.E3.m2.5.5.1.1.3" xref="S2.E3.m2.5.5.1.2.1.cmml">]</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.E3.m2.5b"><apply id="S2.E3.m2.5.5.cmml" xref="S2.E3.m2.5.5"><times id="S2.E3.m2.5.5.2.cmml" xref="S2.E3.m2.5.5.2"></times><apply id="S2.E3.m2.5.5.3.cmml" xref="S2.E3.m2.5.5.3"><csymbol cd="ambiguous" id="S2.E3.m2.5.5.3.1.cmml" xref="S2.E3.m2.5.5.3">subscript</csymbol><ci id="S2.E3.m2.5.5.3.2.cmml" xref="S2.E3.m2.5.5.3.2">𝔼</ci><apply id="S2.E3.m2.2.2.2.3.cmml" xref="S2.E3.m2.2.2.2.2"><csymbol cd="ambiguous" id="S2.E3.m2.2.2.2.3a.cmml" xref="S2.E3.m2.2.2.2.2.3">formulae-sequence</csymbol><apply id="S2.E3.m2.1.1.1.1.1.cmml" xref="S2.E3.m2.1.1.1.1.1"><csymbol cd="latexml" id="S2.E3.m2.1.1.1.1.1.1.cmml" xref="S2.E3.m2.1.1.1.1.1.1">similar-to</csymbol><ci id="S2.E3.m2.1.1.1.1.1.2.cmml" xref="S2.E3.m2.1.1.1.1.1.2">𝐱</ci><ci id="S2.E3.m2.1.1.1.1.1.3.cmml" xref="S2.E3.m2.1.1.1.1.1.3">𝐷</ci></apply><apply id="S2.E3.m2.2.2.2.2.2.cmml" xref="S2.E3.m2.2.2.2.2.2"><csymbol cd="latexml" id="S2.E3.m2.2.2.2.2.2.2.cmml" xref="S2.E3.m2.2.2.2.2.2.2">similar-to</csymbol><ci id="S2.E3.m2.2.2.2.2.2.3.cmml" xref="S2.E3.m2.2.2.2.2.2.3">𝐲</ci><apply id="S2.E3.m2.2.2.2.2.2.1.cmml" xref="S2.E3.m2.2.2.2.2.2.1"><times id="S2.E3.m2.2.2.2.2.2.1.2.cmml" xref="S2.E3.m2.2.2.2.2.2.1.2"></times><apply id="S2.E3.m2.2.2.2.2.2.1.3.cmml" xref="S2.E3.m2.2.2.2.2.2.1.3"><csymbol cd="ambiguous" id="S2.E3.m2.2.2.2.2.2.1.3.1.cmml" xref="S2.E3.m2.2.2.2.2.2.1.3">subscript</csymbol><ci id="S2.E3.m2.2.2.2.2.2.1.3.2.cmml" xref="S2.E3.m2.2.2.2.2.2.1.3.2">𝜋</ci><ci id="S2.E3.m2.2.2.2.2.2.1.3.3.cmml" xref="S2.E3.m2.2.2.2.2.2.1.3.3">𝜃</ci></apply><apply id="S2.E3.m2.2.2.2.2.2.1.1.1.1.cmml" xref="S2.E3.m2.2.2.2.2.2.1.1.1"><csymbol cd="latexml" id="S2.E3.m2.2.2.2.2.2.1.1.1.1.1.cmml" xref="S2.E3.m2.2.2.2.2.2.1.1.1.1.1">conditional</csymbol><ci id="S2.E3.m2.2.2.2.2.2.1.1.1.1.2.cmml" xref="S2.E3.m2.2.2.2.2.2.1.1.1.1.2">𝐲</ci><ci id="S2.E3.m2.2.2.2.2.2.1.1.1.1.3.cmml" xref="S2.E3.m2.2.2.2.2.2.1.1.1.1.3">𝐱</ci></apply></apply></apply></apply></apply><apply id="S2.E3.m2.5.5.1.2.cmml" xref="S2.E3.m2.5.5.1.1"><csymbol cd="latexml" id="S2.E3.m2.5.5.1.2.1.cmml" xref="S2.E3.m2.5.5.1.1.2">delimited-[]</csymbol><apply id="S2.E3.m2.5.5.1.1.1.cmml" xref="S2.E3.m2.5.5.1.1.1"><times id="S2.E3.m2.5.5.1.1.1.1.cmml" xref="S2.E3.m2.5.5.1.1.1.1"></times><apply id="S2.E3.m2.5.5.1.1.1.2.cmml" xref="S2.E3.m2.5.5.1.1.1.2"><csymbol cd="ambiguous" id="S2.E3.m2.5.5.1.1.1.2.1.cmml" xref="S2.E3.m2.5.5.1.1.1.2">subscript</csymbol><ci id="S2.E3.m2.5.5.1.1.1.2.2.cmml" xref="S2.E3.m2.5.5.1.1.1.2.2">𝑟</ci><ci id="S2.E3.m2.5.5.1.1.1.2.3.cmml" xref="S2.E3.m2.5.5.1.1.1.2.3">italic-ϕ</ci></apply><interval closure="open" id="S2.E3.m2.5.5.1.1.1.3.1.cmml" xref="S2.E3.m2.5.5.1.1.1.3.2"><ci id="S2.E3.m2.3.3.cmml" xref="S2.E3.m2.3.3">𝐱</ci><ci id="S2.E3.m2.4.4.cmml" xref="S2.E3.m2.4.4">𝐲</ci></interval></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.E3.m2.5c">\displaystyle\mathbb{E}_{\mathbf{x}\sim D,\mathbf{y}\sim\pi_{\theta}(\mathbf{y%
}|\mathbf{x})}\left[r_{\phi}(\mathbf{x},\mathbf{y})\right]</annotation><annotation encoding="application/x-llamapun" id="S2.E3.m2.5d">blackboard_E start_POSTSUBSCRIPT bold_x ∼ italic_D , bold_y ∼ italic_π start_POSTSUBSCRIPT italic_θ end_POSTSUBSCRIPT ( bold_y | bold_x ) end_POSTSUBSCRIPT [ italic_r start_POSTSUBSCRIPT italic_ϕ end_POSTSUBSCRIPT ( bold_x , bold_y ) ]</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(3)</span></td>
</tr></tbody>
<tbody id="S2.Ex1"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_eqn_cell"></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle-\beta\mathbb{D}_{KL}\left[\pi_{\theta}(\mathbf{y}|\mathbf{x})%
\parallel\pi_{\text{ref}}(\mathbf{y}|\mathbf{x})\right]" class="ltx_math_unparsed" display="inline" id="S2.Ex1.m1.1"><semantics id="S2.Ex1.m1.1a"><mrow id="S2.Ex1.m1.1b"><mo id="S2.Ex1.m1.1.1">−</mo><mi id="S2.Ex1.m1.1.2">β</mi><msub id="S2.Ex1.m1.1.3"><mi id="S2.Ex1.m1.1.3.2">𝔻</mi><mrow id="S2.Ex1.m1.1.3.3"><mi id="S2.Ex1.m1.1.3.3.2">K</mi><mo id="S2.Ex1.m1.1.3.3.1">⁢</mo><mi id="S2.Ex1.m1.1.3.3.3">L</mi></mrow></msub><mrow id="S2.Ex1.m1.1.4"><mo id="S2.Ex1.m1.1.4.1">[</mo><msub id="S2.Ex1.m1.1.4.2"><mi id="S2.Ex1.m1.1.4.2.2">π</mi><mi id="S2.Ex1.m1.1.4.2.3">θ</mi></msub><mrow id="S2.Ex1.m1.1.4.3"><mo id="S2.Ex1.m1.1.4.3.1" stretchy="false">(</mo><mi id="S2.Ex1.m1.1.4.3.2">𝐲</mi><mo fence="false" id="S2.Ex1.m1.1.4.3.3" rspace="0.167em" stretchy="false">|</mo><mi id="S2.Ex1.m1.1.4.3.4">𝐱</mi><mo id="S2.Ex1.m1.1.4.3.5" stretchy="false">)</mo></mrow><mo id="S2.Ex1.m1.1.4.4" lspace="0em" rspace="0.167em">∥</mo><msub id="S2.Ex1.m1.1.4.5"><mi id="S2.Ex1.m1.1.4.5.2">π</mi><mtext id="S2.Ex1.m1.1.4.5.3">ref</mtext></msub><mrow id="S2.Ex1.m1.1.4.6"><mo id="S2.Ex1.m1.1.4.6.1" stretchy="false">(</mo><mi id="S2.Ex1.m1.1.4.6.2">𝐲</mi><mo fence="false" id="S2.Ex1.m1.1.4.6.3" rspace="0.167em" stretchy="false">|</mo><mi id="S2.Ex1.m1.1.4.6.4">𝐱</mi><mo id="S2.Ex1.m1.1.4.6.5" stretchy="false">)</mo></mrow><mo id="S2.Ex1.m1.1.4.7">]</mo></mrow></mrow><annotation encoding="application/x-tex" id="S2.Ex1.m1.1c">\displaystyle-\beta\mathbb{D}_{KL}\left[\pi_{\theta}(\mathbf{y}|\mathbf{x})%
\parallel\pi_{\text{ref}}(\mathbf{y}|\mathbf{x})\right]</annotation><annotation encoding="application/x-llamapun" id="S2.Ex1.m1.1d">- italic_β blackboard_D start_POSTSUBSCRIPT italic_K italic_L end_POSTSUBSCRIPT [ italic_π start_POSTSUBSCRIPT italic_θ end_POSTSUBSCRIPT ( bold_y | bold_x ) ∥ italic_π start_POSTSUBSCRIPT ref end_POSTSUBSCRIPT ( bold_y | bold_x ) ]</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S2.SS1.p1.5">where <math alttext="r_{\phi}" class="ltx_Math" display="inline" id="S2.SS1.p1.1.m1.1"><semantics id="S2.SS1.p1.1.m1.1a"><msub id="S2.SS1.p1.1.m1.1.1" xref="S2.SS1.p1.1.m1.1.1.cmml"><mi id="S2.SS1.p1.1.m1.1.1.2" xref="S2.SS1.p1.1.m1.1.1.2.cmml">r</mi><mi id="S2.SS1.p1.1.m1.1.1.3" xref="S2.SS1.p1.1.m1.1.1.3.cmml">ϕ</mi></msub><annotation-xml encoding="MathML-Content" id="S2.SS1.p1.1.m1.1b"><apply id="S2.SS1.p1.1.m1.1.1.cmml" xref="S2.SS1.p1.1.m1.1.1"><csymbol cd="ambiguous" id="S2.SS1.p1.1.m1.1.1.1.cmml" xref="S2.SS1.p1.1.m1.1.1">subscript</csymbol><ci id="S2.SS1.p1.1.m1.1.1.2.cmml" xref="S2.SS1.p1.1.m1.1.1.2">𝑟</ci><ci id="S2.SS1.p1.1.m1.1.1.3.cmml" xref="S2.SS1.p1.1.m1.1.1.3">italic-ϕ</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p1.1.m1.1c">r_{\phi}</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.p1.1.m1.1d">italic_r start_POSTSUBSCRIPT italic_ϕ end_POSTSUBSCRIPT</annotation></semantics></math> is a reward model trained from human feedback, <math alttext="\pi_{\theta}" class="ltx_Math" display="inline" id="S2.SS1.p1.2.m2.1"><semantics id="S2.SS1.p1.2.m2.1a"><msub id="S2.SS1.p1.2.m2.1.1" xref="S2.SS1.p1.2.m2.1.1.cmml"><mi id="S2.SS1.p1.2.m2.1.1.2" xref="S2.SS1.p1.2.m2.1.1.2.cmml">π</mi><mi id="S2.SS1.p1.2.m2.1.1.3" xref="S2.SS1.p1.2.m2.1.1.3.cmml">θ</mi></msub><annotation-xml encoding="MathML-Content" id="S2.SS1.p1.2.m2.1b"><apply id="S2.SS1.p1.2.m2.1.1.cmml" xref="S2.SS1.p1.2.m2.1.1"><csymbol cd="ambiguous" id="S2.SS1.p1.2.m2.1.1.1.cmml" xref="S2.SS1.p1.2.m2.1.1">subscript</csymbol><ci id="S2.SS1.p1.2.m2.1.1.2.cmml" xref="S2.SS1.p1.2.m2.1.1.2">𝜋</ci><ci id="S2.SS1.p1.2.m2.1.1.3.cmml" xref="S2.SS1.p1.2.m2.1.1.3">𝜃</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p1.2.m2.1c">\pi_{\theta}</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.p1.2.m2.1d">italic_π start_POSTSUBSCRIPT italic_θ end_POSTSUBSCRIPT</annotation></semantics></math> is the model being trained, and <math alttext="\pi_{\text{ref}}" class="ltx_Math" display="inline" id="S2.SS1.p1.3.m3.1"><semantics id="S2.SS1.p1.3.m3.1a"><msub id="S2.SS1.p1.3.m3.1.1" xref="S2.SS1.p1.3.m3.1.1.cmml"><mi id="S2.SS1.p1.3.m3.1.1.2" xref="S2.SS1.p1.3.m3.1.1.2.cmml">π</mi><mtext id="S2.SS1.p1.3.m3.1.1.3" xref="S2.SS1.p1.3.m3.1.1.3a.cmml">ref</mtext></msub><annotation-xml encoding="MathML-Content" id="S2.SS1.p1.3.m3.1b"><apply id="S2.SS1.p1.3.m3.1.1.cmml" xref="S2.SS1.p1.3.m3.1.1"><csymbol cd="ambiguous" id="S2.SS1.p1.3.m3.1.1.1.cmml" xref="S2.SS1.p1.3.m3.1.1">subscript</csymbol><ci id="S2.SS1.p1.3.m3.1.1.2.cmml" xref="S2.SS1.p1.3.m3.1.1.2">𝜋</ci><ci id="S2.SS1.p1.3.m3.1.1.3a.cmml" xref="S2.SS1.p1.3.m3.1.1.3"><mtext id="S2.SS1.p1.3.m3.1.1.3.cmml" mathsize="70%" xref="S2.SS1.p1.3.m3.1.1.3">ref</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p1.3.m3.1c">\pi_{\text{ref}}</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.p1.3.m3.1d">italic_π start_POSTSUBSCRIPT ref end_POSTSUBSCRIPT</annotation></semantics></math> is the reference model. DPO effectively replaces the reward model with a preference distribution based on <math alttext="\pi_{\theta}" class="ltx_Math" display="inline" id="S2.SS1.p1.4.m4.1"><semantics id="S2.SS1.p1.4.m4.1a"><msub id="S2.SS1.p1.4.m4.1.1" xref="S2.SS1.p1.4.m4.1.1.cmml"><mi id="S2.SS1.p1.4.m4.1.1.2" xref="S2.SS1.p1.4.m4.1.1.2.cmml">π</mi><mi id="S2.SS1.p1.4.m4.1.1.3" xref="S2.SS1.p1.4.m4.1.1.3.cmml">θ</mi></msub><annotation-xml encoding="MathML-Content" id="S2.SS1.p1.4.m4.1b"><apply id="S2.SS1.p1.4.m4.1.1.cmml" xref="S2.SS1.p1.4.m4.1.1"><csymbol cd="ambiguous" id="S2.SS1.p1.4.m4.1.1.1.cmml" xref="S2.SS1.p1.4.m4.1.1">subscript</csymbol><ci id="S2.SS1.p1.4.m4.1.1.2.cmml" xref="S2.SS1.p1.4.m4.1.1.2">𝜋</ci><ci id="S2.SS1.p1.4.m4.1.1.3.cmml" xref="S2.SS1.p1.4.m4.1.1.3">𝜃</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p1.4.m4.1c">\pi_{\theta}</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.p1.4.m4.1d">italic_π start_POSTSUBSCRIPT italic_θ end_POSTSUBSCRIPT</annotation></semantics></math>, the model being trained; DPO also retains the KL regularization term with weighting <math alttext="\beta" class="ltx_Math" display="inline" id="S2.SS1.p1.5.m5.1"><semantics id="S2.SS1.p1.5.m5.1a"><mi id="S2.SS1.p1.5.m5.1.1" xref="S2.SS1.p1.5.m5.1.1.cmml">β</mi><annotation-xml encoding="MathML-Content" id="S2.SS1.p1.5.m5.1b"><ci id="S2.SS1.p1.5.m5.1.1.cmml" xref="S2.SS1.p1.5.m5.1.1">𝛽</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p1.5.m5.1c">\beta</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.p1.5.m5.1d">italic_β</annotation></semantics></math>.</p>
</div>
<div class="ltx_para" id="S2.SS1.p2">
<p class="ltx_p" id="S2.SS1.p2.10">The preference dataset <math alttext="D" class="ltx_Math" display="inline" id="S2.SS1.p2.1.m1.1"><semantics id="S2.SS1.p2.1.m1.1a"><mi id="S2.SS1.p2.1.m1.1.1" xref="S2.SS1.p2.1.m1.1.1.cmml">D</mi><annotation-xml encoding="MathML-Content" id="S2.SS1.p2.1.m1.1b"><ci id="S2.SS1.p2.1.m1.1.1.cmml" xref="S2.SS1.p2.1.m1.1.1">𝐷</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p2.1.m1.1c">D</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.p2.1.m1.1d">italic_D</annotation></semantics></math> for DPO consists of triplets <math alttext="(\mathbf{x},\mathbf{y}_{w},\mathbf{y}_{l})" class="ltx_Math" display="inline" id="S2.SS1.p2.2.m2.3"><semantics id="S2.SS1.p2.2.m2.3a"><mrow id="S2.SS1.p2.2.m2.3.3.2" xref="S2.SS1.p2.2.m2.3.3.3.cmml"><mo id="S2.SS1.p2.2.m2.3.3.2.3" stretchy="false" xref="S2.SS1.p2.2.m2.3.3.3.cmml">(</mo><mi id="S2.SS1.p2.2.m2.1.1" xref="S2.SS1.p2.2.m2.1.1.cmml">𝐱</mi><mo id="S2.SS1.p2.2.m2.3.3.2.4" xref="S2.SS1.p2.2.m2.3.3.3.cmml">,</mo><msub id="S2.SS1.p2.2.m2.2.2.1.1" xref="S2.SS1.p2.2.m2.2.2.1.1.cmml"><mi id="S2.SS1.p2.2.m2.2.2.1.1.2" xref="S2.SS1.p2.2.m2.2.2.1.1.2.cmml">𝐲</mi><mi id="S2.SS1.p2.2.m2.2.2.1.1.3" xref="S2.SS1.p2.2.m2.2.2.1.1.3.cmml">w</mi></msub><mo id="S2.SS1.p2.2.m2.3.3.2.5" xref="S2.SS1.p2.2.m2.3.3.3.cmml">,</mo><msub id="S2.SS1.p2.2.m2.3.3.2.2" xref="S2.SS1.p2.2.m2.3.3.2.2.cmml"><mi id="S2.SS1.p2.2.m2.3.3.2.2.2" xref="S2.SS1.p2.2.m2.3.3.2.2.2.cmml">𝐲</mi><mi id="S2.SS1.p2.2.m2.3.3.2.2.3" xref="S2.SS1.p2.2.m2.3.3.2.2.3.cmml">l</mi></msub><mo id="S2.SS1.p2.2.m2.3.3.2.6" stretchy="false" xref="S2.SS1.p2.2.m2.3.3.3.cmml">)</mo></mrow><annotation-xml encoding="MathML-Content" id="S2.SS1.p2.2.m2.3b"><vector id="S2.SS1.p2.2.m2.3.3.3.cmml" xref="S2.SS1.p2.2.m2.3.3.2"><ci id="S2.SS1.p2.2.m2.1.1.cmml" xref="S2.SS1.p2.2.m2.1.1">𝐱</ci><apply id="S2.SS1.p2.2.m2.2.2.1.1.cmml" xref="S2.SS1.p2.2.m2.2.2.1.1"><csymbol cd="ambiguous" id="S2.SS1.p2.2.m2.2.2.1.1.1.cmml" xref="S2.SS1.p2.2.m2.2.2.1.1">subscript</csymbol><ci id="S2.SS1.p2.2.m2.2.2.1.1.2.cmml" xref="S2.SS1.p2.2.m2.2.2.1.1.2">𝐲</ci><ci id="S2.SS1.p2.2.m2.2.2.1.1.3.cmml" xref="S2.SS1.p2.2.m2.2.2.1.1.3">𝑤</ci></apply><apply id="S2.SS1.p2.2.m2.3.3.2.2.cmml" xref="S2.SS1.p2.2.m2.3.3.2.2"><csymbol cd="ambiguous" id="S2.SS1.p2.2.m2.3.3.2.2.1.cmml" xref="S2.SS1.p2.2.m2.3.3.2.2">subscript</csymbol><ci id="S2.SS1.p2.2.m2.3.3.2.2.2.cmml" xref="S2.SS1.p2.2.m2.3.3.2.2.2">𝐲</ci><ci id="S2.SS1.p2.2.m2.3.3.2.2.3.cmml" xref="S2.SS1.p2.2.m2.3.3.2.2.3">𝑙</ci></apply></vector></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p2.2.m2.3c">(\mathbf{x},\mathbf{y}_{w},\mathbf{y}_{l})</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.p2.2.m2.3d">( bold_x , bold_y start_POSTSUBSCRIPT italic_w end_POSTSUBSCRIPT , bold_y start_POSTSUBSCRIPT italic_l end_POSTSUBSCRIPT )</annotation></semantics></math> where <math alttext="\mathbf{x}" class="ltx_Math" display="inline" id="S2.SS1.p2.3.m3.1"><semantics id="S2.SS1.p2.3.m3.1a"><mi id="S2.SS1.p2.3.m3.1.1" xref="S2.SS1.p2.3.m3.1.1.cmml">𝐱</mi><annotation-xml encoding="MathML-Content" id="S2.SS1.p2.3.m3.1b"><ci id="S2.SS1.p2.3.m3.1.1.cmml" xref="S2.SS1.p2.3.m3.1.1">𝐱</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p2.3.m3.1c">\mathbf{x}</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.p2.3.m3.1d">bold_x</annotation></semantics></math> is the input prompt, <math alttext="\mathbf{y}_{w}" class="ltx_Math" display="inline" id="S2.SS1.p2.4.m4.1"><semantics id="S2.SS1.p2.4.m4.1a"><msub id="S2.SS1.p2.4.m4.1.1" xref="S2.SS1.p2.4.m4.1.1.cmml"><mi id="S2.SS1.p2.4.m4.1.1.2" xref="S2.SS1.p2.4.m4.1.1.2.cmml">𝐲</mi><mi id="S2.SS1.p2.4.m4.1.1.3" xref="S2.SS1.p2.4.m4.1.1.3.cmml">w</mi></msub><annotation-xml encoding="MathML-Content" id="S2.SS1.p2.4.m4.1b"><apply id="S2.SS1.p2.4.m4.1.1.cmml" xref="S2.SS1.p2.4.m4.1.1"><csymbol cd="ambiguous" id="S2.SS1.p2.4.m4.1.1.1.cmml" xref="S2.SS1.p2.4.m4.1.1">subscript</csymbol><ci id="S2.SS1.p2.4.m4.1.1.2.cmml" xref="S2.SS1.p2.4.m4.1.1.2">𝐲</ci><ci id="S2.SS1.p2.4.m4.1.1.3.cmml" xref="S2.SS1.p2.4.m4.1.1.3">𝑤</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p2.4.m4.1c">\mathbf{y}_{w}</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.p2.4.m4.1d">bold_y start_POSTSUBSCRIPT italic_w end_POSTSUBSCRIPT</annotation></semantics></math> is the winnng (prefered) response, and <math alttext="\mathbf{y}_{l}" class="ltx_Math" display="inline" id="S2.SS1.p2.5.m5.1"><semantics id="S2.SS1.p2.5.m5.1a"><msub id="S2.SS1.p2.5.m5.1.1" xref="S2.SS1.p2.5.m5.1.1.cmml"><mi id="S2.SS1.p2.5.m5.1.1.2" xref="S2.SS1.p2.5.m5.1.1.2.cmml">𝐲</mi><mi id="S2.SS1.p2.5.m5.1.1.3" xref="S2.SS1.p2.5.m5.1.1.3.cmml">l</mi></msub><annotation-xml encoding="MathML-Content" id="S2.SS1.p2.5.m5.1b"><apply id="S2.SS1.p2.5.m5.1.1.cmml" xref="S2.SS1.p2.5.m5.1.1"><csymbol cd="ambiguous" id="S2.SS1.p2.5.m5.1.1.1.cmml" xref="S2.SS1.p2.5.m5.1.1">subscript</csymbol><ci id="S2.SS1.p2.5.m5.1.1.2.cmml" xref="S2.SS1.p2.5.m5.1.1.2">𝐲</ci><ci id="S2.SS1.p2.5.m5.1.1.3.cmml" xref="S2.SS1.p2.5.m5.1.1.3">𝑙</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p2.5.m5.1c">\mathbf{y}_{l}</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.p2.5.m5.1d">bold_y start_POSTSUBSCRIPT italic_l end_POSTSUBSCRIPT</annotation></semantics></math> is the losing (disprefered) response. DPO uses the language model likelihood to approximate the reward as <math alttext="\beta\text{log}\frac{\pi_{\theta}(\mathbf{y}|\mathbf{x})}{\pi_{\text{ref}}(%
\mathbf{y}|\mathbf{x})}" class="ltx_Math" display="inline" id="S2.SS1.p2.6.m6.2"><semantics id="S2.SS1.p2.6.m6.2a"><mrow id="S2.SS1.p2.6.m6.2.3" xref="S2.SS1.p2.6.m6.2.3.cmml"><mi id="S2.SS1.p2.6.m6.2.3.2" xref="S2.SS1.p2.6.m6.2.3.2.cmml">β</mi><mo id="S2.SS1.p2.6.m6.2.3.1" xref="S2.SS1.p2.6.m6.2.3.1.cmml">⁢</mo><mtext id="S2.SS1.p2.6.m6.2.3.3" xref="S2.SS1.p2.6.m6.2.3.3a.cmml">log</mtext><mo id="S2.SS1.p2.6.m6.2.3.1a" xref="S2.SS1.p2.6.m6.2.3.1.cmml">⁢</mo><mfrac id="S2.SS1.p2.6.m6.2.2" xref="S2.SS1.p2.6.m6.2.2.cmml"><mrow id="S2.SS1.p2.6.m6.1.1.1" xref="S2.SS1.p2.6.m6.1.1.1.cmml"><msub id="S2.SS1.p2.6.m6.1.1.1.3" xref="S2.SS1.p2.6.m6.1.1.1.3.cmml"><mi id="S2.SS1.p2.6.m6.1.1.1.3.2" xref="S2.SS1.p2.6.m6.1.1.1.3.2.cmml">π</mi><mi id="S2.SS1.p2.6.m6.1.1.1.3.3" xref="S2.SS1.p2.6.m6.1.1.1.3.3.cmml">θ</mi></msub><mo id="S2.SS1.p2.6.m6.1.1.1.2" xref="S2.SS1.p2.6.m6.1.1.1.2.cmml">⁢</mo><mrow id="S2.SS1.p2.6.m6.1.1.1.1.1" xref="S2.SS1.p2.6.m6.1.1.1.1.1.1.cmml"><mo id="S2.SS1.p2.6.m6.1.1.1.1.1.2" stretchy="false" xref="S2.SS1.p2.6.m6.1.1.1.1.1.1.cmml">(</mo><mrow id="S2.SS1.p2.6.m6.1.1.1.1.1.1" xref="S2.SS1.p2.6.m6.1.1.1.1.1.1.cmml"><mi id="S2.SS1.p2.6.m6.1.1.1.1.1.1.2" xref="S2.SS1.p2.6.m6.1.1.1.1.1.1.2.cmml">𝐲</mi><mo fence="false" id="S2.SS1.p2.6.m6.1.1.1.1.1.1.1" xref="S2.SS1.p2.6.m6.1.1.1.1.1.1.1.cmml">|</mo><mi id="S2.SS1.p2.6.m6.1.1.1.1.1.1.3" xref="S2.SS1.p2.6.m6.1.1.1.1.1.1.3.cmml">𝐱</mi></mrow><mo id="S2.SS1.p2.6.m6.1.1.1.1.1.3" stretchy="false" xref="S2.SS1.p2.6.m6.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mrow id="S2.SS1.p2.6.m6.2.2.2" xref="S2.SS1.p2.6.m6.2.2.2.cmml"><msub id="S2.SS1.p2.6.m6.2.2.2.3" xref="S2.SS1.p2.6.m6.2.2.2.3.cmml"><mi id="S2.SS1.p2.6.m6.2.2.2.3.2" xref="S2.SS1.p2.6.m6.2.2.2.3.2.cmml">π</mi><mtext id="S2.SS1.p2.6.m6.2.2.2.3.3" xref="S2.SS1.p2.6.m6.2.2.2.3.3a.cmml">ref</mtext></msub><mo id="S2.SS1.p2.6.m6.2.2.2.2" xref="S2.SS1.p2.6.m6.2.2.2.2.cmml">⁢</mo><mrow id="S2.SS1.p2.6.m6.2.2.2.1.1" xref="S2.SS1.p2.6.m6.2.2.2.1.1.1.cmml"><mo id="S2.SS1.p2.6.m6.2.2.2.1.1.2" stretchy="false" xref="S2.SS1.p2.6.m6.2.2.2.1.1.1.cmml">(</mo><mrow id="S2.SS1.p2.6.m6.2.2.2.1.1.1" xref="S2.SS1.p2.6.m6.2.2.2.1.1.1.cmml"><mi id="S2.SS1.p2.6.m6.2.2.2.1.1.1.2" xref="S2.SS1.p2.6.m6.2.2.2.1.1.1.2.cmml">𝐲</mi><mo fence="false" id="S2.SS1.p2.6.m6.2.2.2.1.1.1.1" xref="S2.SS1.p2.6.m6.2.2.2.1.1.1.1.cmml">|</mo><mi id="S2.SS1.p2.6.m6.2.2.2.1.1.1.3" xref="S2.SS1.p2.6.m6.2.2.2.1.1.1.3.cmml">𝐱</mi></mrow><mo id="S2.SS1.p2.6.m6.2.2.2.1.1.3" stretchy="false" xref="S2.SS1.p2.6.m6.2.2.2.1.1.1.cmml">)</mo></mrow></mrow></mfrac></mrow><annotation-xml encoding="MathML-Content" id="S2.SS1.p2.6.m6.2b"><apply id="S2.SS1.p2.6.m6.2.3.cmml" xref="S2.SS1.p2.6.m6.2.3"><times id="S2.SS1.p2.6.m6.2.3.1.cmml" xref="S2.SS1.p2.6.m6.2.3.1"></times><ci id="S2.SS1.p2.6.m6.2.3.2.cmml" xref="S2.SS1.p2.6.m6.2.3.2">𝛽</ci><ci id="S2.SS1.p2.6.m6.2.3.3a.cmml" xref="S2.SS1.p2.6.m6.2.3.3"><mtext id="S2.SS1.p2.6.m6.2.3.3.cmml" xref="S2.SS1.p2.6.m6.2.3.3">log</mtext></ci><apply id="S2.SS1.p2.6.m6.2.2.cmml" xref="S2.SS1.p2.6.m6.2.2"><divide id="S2.SS1.p2.6.m6.2.2.3.cmml" xref="S2.SS1.p2.6.m6.2.2"></divide><apply id="S2.SS1.p2.6.m6.1.1.1.cmml" xref="S2.SS1.p2.6.m6.1.1.1"><times id="S2.SS1.p2.6.m6.1.1.1.2.cmml" xref="S2.SS1.p2.6.m6.1.1.1.2"></times><apply id="S2.SS1.p2.6.m6.1.1.1.3.cmml" xref="S2.SS1.p2.6.m6.1.1.1.3"><csymbol cd="ambiguous" id="S2.SS1.p2.6.m6.1.1.1.3.1.cmml" xref="S2.SS1.p2.6.m6.1.1.1.3">subscript</csymbol><ci id="S2.SS1.p2.6.m6.1.1.1.3.2.cmml" xref="S2.SS1.p2.6.m6.1.1.1.3.2">𝜋</ci><ci id="S2.SS1.p2.6.m6.1.1.1.3.3.cmml" xref="S2.SS1.p2.6.m6.1.1.1.3.3">𝜃</ci></apply><apply id="S2.SS1.p2.6.m6.1.1.1.1.1.1.cmml" xref="S2.SS1.p2.6.m6.1.1.1.1.1"><csymbol cd="latexml" id="S2.SS1.p2.6.m6.1.1.1.1.1.1.1.cmml" xref="S2.SS1.p2.6.m6.1.1.1.1.1.1.1">conditional</csymbol><ci id="S2.SS1.p2.6.m6.1.1.1.1.1.1.2.cmml" xref="S2.SS1.p2.6.m6.1.1.1.1.1.1.2">𝐲</ci><ci id="S2.SS1.p2.6.m6.1.1.1.1.1.1.3.cmml" xref="S2.SS1.p2.6.m6.1.1.1.1.1.1.3">𝐱</ci></apply></apply><apply id="S2.SS1.p2.6.m6.2.2.2.cmml" xref="S2.SS1.p2.6.m6.2.2.2"><times id="S2.SS1.p2.6.m6.2.2.2.2.cmml" xref="S2.SS1.p2.6.m6.2.2.2.2"></times><apply id="S2.SS1.p2.6.m6.2.2.2.3.cmml" xref="S2.SS1.p2.6.m6.2.2.2.3"><csymbol cd="ambiguous" id="S2.SS1.p2.6.m6.2.2.2.3.1.cmml" xref="S2.SS1.p2.6.m6.2.2.2.3">subscript</csymbol><ci id="S2.SS1.p2.6.m6.2.2.2.3.2.cmml" xref="S2.SS1.p2.6.m6.2.2.2.3.2">𝜋</ci><ci id="S2.SS1.p2.6.m6.2.2.2.3.3a.cmml" xref="S2.SS1.p2.6.m6.2.2.2.3.3"><mtext id="S2.SS1.p2.6.m6.2.2.2.3.3.cmml" mathsize="50%" xref="S2.SS1.p2.6.m6.2.2.2.3.3">ref</mtext></ci></apply><apply id="S2.SS1.p2.6.m6.2.2.2.1.1.1.cmml" xref="S2.SS1.p2.6.m6.2.2.2.1.1"><csymbol cd="latexml" id="S2.SS1.p2.6.m6.2.2.2.1.1.1.1.cmml" xref="S2.SS1.p2.6.m6.2.2.2.1.1.1.1">conditional</csymbol><ci id="S2.SS1.p2.6.m6.2.2.2.1.1.1.2.cmml" xref="S2.SS1.p2.6.m6.2.2.2.1.1.1.2">𝐲</ci><ci id="S2.SS1.p2.6.m6.2.2.2.1.1.1.3.cmml" xref="S2.SS1.p2.6.m6.2.2.2.1.1.1.3">𝐱</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p2.6.m6.2c">\beta\text{log}\frac{\pi_{\theta}(\mathbf{y}|\mathbf{x})}{\pi_{\text{ref}}(%
\mathbf{y}|\mathbf{x})}</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.p2.6.m6.2d">italic_β log divide start_ARG italic_π start_POSTSUBSCRIPT italic_θ end_POSTSUBSCRIPT ( bold_y | bold_x ) end_ARG start_ARG italic_π start_POSTSUBSCRIPT ref end_POSTSUBSCRIPT ( bold_y | bold_x ) end_ARG</annotation></semantics></math>. During training, with <math alttext="\pi_{\theta}" class="ltx_Math" display="inline" id="S2.SS1.p2.7.m7.1"><semantics id="S2.SS1.p2.7.m7.1a"><msub id="S2.SS1.p2.7.m7.1.1" xref="S2.SS1.p2.7.m7.1.1.cmml"><mi id="S2.SS1.p2.7.m7.1.1.2" xref="S2.SS1.p2.7.m7.1.1.2.cmml">π</mi><mi id="S2.SS1.p2.7.m7.1.1.3" xref="S2.SS1.p2.7.m7.1.1.3.cmml">θ</mi></msub><annotation-xml encoding="MathML-Content" id="S2.SS1.p2.7.m7.1b"><apply id="S2.SS1.p2.7.m7.1.1.cmml" xref="S2.SS1.p2.7.m7.1.1"><csymbol cd="ambiguous" id="S2.SS1.p2.7.m7.1.1.1.cmml" xref="S2.SS1.p2.7.m7.1.1">subscript</csymbol><ci id="S2.SS1.p2.7.m7.1.1.2.cmml" xref="S2.SS1.p2.7.m7.1.1.2">𝜋</ci><ci id="S2.SS1.p2.7.m7.1.1.3.cmml" xref="S2.SS1.p2.7.m7.1.1.3">𝜃</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p2.7.m7.1c">\pi_{\theta}</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.p2.7.m7.1d">italic_π start_POSTSUBSCRIPT italic_θ end_POSTSUBSCRIPT</annotation></semantics></math> typically initialized from <math alttext="\pi_{\text{ref}}" class="ltx_Math" display="inline" id="S2.SS1.p2.8.m8.1"><semantics id="S2.SS1.p2.8.m8.1a"><msub id="S2.SS1.p2.8.m8.1.1" xref="S2.SS1.p2.8.m8.1.1.cmml"><mi id="S2.SS1.p2.8.m8.1.1.2" xref="S2.SS1.p2.8.m8.1.1.2.cmml">π</mi><mtext id="S2.SS1.p2.8.m8.1.1.3" xref="S2.SS1.p2.8.m8.1.1.3a.cmml">ref</mtext></msub><annotation-xml encoding="MathML-Content" id="S2.SS1.p2.8.m8.1b"><apply id="S2.SS1.p2.8.m8.1.1.cmml" xref="S2.SS1.p2.8.m8.1.1"><csymbol cd="ambiguous" id="S2.SS1.p2.8.m8.1.1.1.cmml" xref="S2.SS1.p2.8.m8.1.1">subscript</csymbol><ci id="S2.SS1.p2.8.m8.1.1.2.cmml" xref="S2.SS1.p2.8.m8.1.1.2">𝜋</ci><ci id="S2.SS1.p2.8.m8.1.1.3a.cmml" xref="S2.SS1.p2.8.m8.1.1.3"><mtext id="S2.SS1.p2.8.m8.1.1.3.cmml" mathsize="70%" xref="S2.SS1.p2.8.m8.1.1.3">ref</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p2.8.m8.1c">\pi_{\text{ref}}</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.p2.8.m8.1d">italic_π start_POSTSUBSCRIPT ref end_POSTSUBSCRIPT</annotation></semantics></math>, the objective is to maximize the expected reward margin between <math alttext="\mathbf{y}_{w}" class="ltx_Math" display="inline" id="S2.SS1.p2.9.m9.1"><semantics id="S2.SS1.p2.9.m9.1a"><msub id="S2.SS1.p2.9.m9.1.1" xref="S2.SS1.p2.9.m9.1.1.cmml"><mi id="S2.SS1.p2.9.m9.1.1.2" xref="S2.SS1.p2.9.m9.1.1.2.cmml">𝐲</mi><mi id="S2.SS1.p2.9.m9.1.1.3" xref="S2.SS1.p2.9.m9.1.1.3.cmml">w</mi></msub><annotation-xml encoding="MathML-Content" id="S2.SS1.p2.9.m9.1b"><apply id="S2.SS1.p2.9.m9.1.1.cmml" xref="S2.SS1.p2.9.m9.1.1"><csymbol cd="ambiguous" id="S2.SS1.p2.9.m9.1.1.1.cmml" xref="S2.SS1.p2.9.m9.1.1">subscript</csymbol><ci id="S2.SS1.p2.9.m9.1.1.2.cmml" xref="S2.SS1.p2.9.m9.1.1.2">𝐲</ci><ci id="S2.SS1.p2.9.m9.1.1.3.cmml" xref="S2.SS1.p2.9.m9.1.1.3">𝑤</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p2.9.m9.1c">\mathbf{y}_{w}</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.p2.9.m9.1d">bold_y start_POSTSUBSCRIPT italic_w end_POSTSUBSCRIPT</annotation></semantics></math> and <math alttext="\mathbf{y}_{l}" class="ltx_Math" display="inline" id="S2.SS1.p2.10.m10.1"><semantics id="S2.SS1.p2.10.m10.1a"><msub id="S2.SS1.p2.10.m10.1.1" xref="S2.SS1.p2.10.m10.1.1.cmml"><mi id="S2.SS1.p2.10.m10.1.1.2" xref="S2.SS1.p2.10.m10.1.1.2.cmml">𝐲</mi><mi id="S2.SS1.p2.10.m10.1.1.3" xref="S2.SS1.p2.10.m10.1.1.3.cmml">l</mi></msub><annotation-xml encoding="MathML-Content" id="S2.SS1.p2.10.m10.1b"><apply id="S2.SS1.p2.10.m10.1.1.cmml" xref="S2.SS1.p2.10.m10.1.1"><csymbol cd="ambiguous" id="S2.SS1.p2.10.m10.1.1.1.cmml" xref="S2.SS1.p2.10.m10.1.1">subscript</csymbol><ci id="S2.SS1.p2.10.m10.1.1.2.cmml" xref="S2.SS1.p2.10.m10.1.1.2">𝐲</ci><ci id="S2.SS1.p2.10.m10.1.1.3.cmml" xref="S2.SS1.p2.10.m10.1.1.3">𝑙</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p2.10.m10.1c">\mathbf{y}_{l}</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.p2.10.m10.1d">bold_y start_POSTSUBSCRIPT italic_l end_POSTSUBSCRIPT</annotation></semantics></math>:</p>
<table class="ltx_equation ltx_eqn_table" id="S2.E4">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="L_{\text{DPO}}=-\mathbb{\mathop{E}}_{(\mathbf{x},\mathbf{y}_{w},\mathbf{y}_{l}%
)\sim D}[\text{log}\sigma(M(\mathbf{y}_{w},\mathbf{y}_{l},{\bf x},\theta))]" class="ltx_Math" display="block" id="S2.E4.m1.6"><semantics id="S2.E4.m1.6a"><mrow id="S2.E4.m1.6.6" xref="S2.E4.m1.6.6.cmml"><msub id="S2.E4.m1.6.6.3" xref="S2.E4.m1.6.6.3.cmml"><mi id="S2.E4.m1.6.6.3.2" xref="S2.E4.m1.6.6.3.2.cmml">L</mi><mtext id="S2.E4.m1.6.6.3.3" xref="S2.E4.m1.6.6.3.3a.cmml">DPO</mtext></msub><mo id="S2.E4.m1.6.6.2" xref="S2.E4.m1.6.6.2.cmml">=</mo><mrow id="S2.E4.m1.6.6.1" xref="S2.E4.m1.6.6.1.cmml"><mo id="S2.E4.m1.6.6.1a" xref="S2.E4.m1.6.6.1.cmml">−</mo><mrow id="S2.E4.m1.6.6.1.1" xref="S2.E4.m1.6.6.1.1.cmml"><munder id="S2.E4.m1.6.6.1.1.2" xref="S2.E4.m1.6.6.1.1.2.cmml"><mo id="S2.E4.m1.6.6.1.1.2.2" lspace="0.167em" movablelimits="false" rspace="0em" xref="S2.E4.m1.6.6.1.1.2.2.cmml">𝔼</mo><mrow id="S2.E4.m1.3.3.3" xref="S2.E4.m1.3.3.3.cmml"><mrow id="S2.E4.m1.3.3.3.3.2" xref="S2.E4.m1.3.3.3.3.3.cmml"><mo id="S2.E4.m1.3.3.3.3.2.3" stretchy="false" xref="S2.E4.m1.3.3.3.3.3.cmml">(</mo><mi id="S2.E4.m1.1.1.1.1" xref="S2.E4.m1.1.1.1.1.cmml">𝐱</mi><mo id="S2.E4.m1.3.3.3.3.2.4" xref="S2.E4.m1.3.3.3.3.3.cmml">,</mo><msub id="S2.E4.m1.2.2.2.2.1.1" xref="S2.E4.m1.2.2.2.2.1.1.cmml"><mi id="S2.E4.m1.2.2.2.2.1.1.2" xref="S2.E4.m1.2.2.2.2.1.1.2.cmml">𝐲</mi><mi id="S2.E4.m1.2.2.2.2.1.1.3" xref="S2.E4.m1.2.2.2.2.1.1.3.cmml">w</mi></msub><mo id="S2.E4.m1.3.3.3.3.2.5" xref="S2.E4.m1.3.3.3.3.3.cmml">,</mo><msub id="S2.E4.m1.3.3.3.3.2.2" xref="S2.E4.m1.3.3.3.3.2.2.cmml"><mi id="S2.E4.m1.3.3.3.3.2.2.2" xref="S2.E4.m1.3.3.3.3.2.2.2.cmml">𝐲</mi><mi id="S2.E4.m1.3.3.3.3.2.2.3" xref="S2.E4.m1.3.3.3.3.2.2.3.cmml">l</mi></msub><mo id="S2.E4.m1.3.3.3.3.2.6" stretchy="false" xref="S2.E4.m1.3.3.3.3.3.cmml">)</mo></mrow><mo id="S2.E4.m1.3.3.3.4" xref="S2.E4.m1.3.3.3.4.cmml">∼</mo><mi id="S2.E4.m1.3.3.3.5" xref="S2.E4.m1.3.3.3.5.cmml">D</mi></mrow></munder><mrow id="S2.E4.m1.6.6.1.1.1.1" xref="S2.E4.m1.6.6.1.1.1.2.cmml"><mo id="S2.E4.m1.6.6.1.1.1.1.2" stretchy="false" xref="S2.E4.m1.6.6.1.1.1.2.1.cmml">[</mo><mrow id="S2.E4.m1.6.6.1.1.1.1.1" xref="S2.E4.m1.6.6.1.1.1.1.1.cmml"><mtext id="S2.E4.m1.6.6.1.1.1.1.1.3" xref="S2.E4.m1.6.6.1.1.1.1.1.3a.cmml">log</mtext><mo id="S2.E4.m1.6.6.1.1.1.1.1.2" xref="S2.E4.m1.6.6.1.1.1.1.1.2.cmml">⁢</mo><mi id="S2.E4.m1.6.6.1.1.1.1.1.4" xref="S2.E4.m1.6.6.1.1.1.1.1.4.cmml">σ</mi><mo id="S2.E4.m1.6.6.1.1.1.1.1.2a" xref="S2.E4.m1.6.6.1.1.1.1.1.2.cmml">⁢</mo><mrow id="S2.E4.m1.6.6.1.1.1.1.1.1.1" xref="S2.E4.m1.6.6.1.1.1.1.1.1.1.1.cmml"><mo id="S2.E4.m1.6.6.1.1.1.1.1.1.1.2" stretchy="false" xref="S2.E4.m1.6.6.1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="S2.E4.m1.6.6.1.1.1.1.1.1.1.1" xref="S2.E4.m1.6.6.1.1.1.1.1.1.1.1.cmml"><mi id="S2.E4.m1.6.6.1.1.1.1.1.1.1.1.4" xref="S2.E4.m1.6.6.1.1.1.1.1.1.1.1.4.cmml">M</mi><mo id="S2.E4.m1.6.6.1.1.1.1.1.1.1.1.3" xref="S2.E4.m1.6.6.1.1.1.1.1.1.1.1.3.cmml">⁢</mo><mrow id="S2.E4.m1.6.6.1.1.1.1.1.1.1.1.2.2" xref="S2.E4.m1.6.6.1.1.1.1.1.1.1.1.2.3.cmml"><mo id="S2.E4.m1.6.6.1.1.1.1.1.1.1.1.2.2.3" stretchy="false" xref="S2.E4.m1.6.6.1.1.1.1.1.1.1.1.2.3.cmml">(</mo><msub id="S2.E4.m1.6.6.1.1.1.1.1.1.1.1.1.1.1" xref="S2.E4.m1.6.6.1.1.1.1.1.1.1.1.1.1.1.cmml"><mi id="S2.E4.m1.6.6.1.1.1.1.1.1.1.1.1.1.1.2" xref="S2.E4.m1.6.6.1.1.1.1.1.1.1.1.1.1.1.2.cmml">𝐲</mi><mi id="S2.E4.m1.6.6.1.1.1.1.1.1.1.1.1.1.1.3" xref="S2.E4.m1.6.6.1.1.1.1.1.1.1.1.1.1.1.3.cmml">w</mi></msub><mo id="S2.E4.m1.6.6.1.1.1.1.1.1.1.1.2.2.4" xref="S2.E4.m1.6.6.1.1.1.1.1.1.1.1.2.3.cmml">,</mo><msub id="S2.E4.m1.6.6.1.1.1.1.1.1.1.1.2.2.2" xref="S2.E4.m1.6.6.1.1.1.1.1.1.1.1.2.2.2.cmml"><mi id="S2.E4.m1.6.6.1.1.1.1.1.1.1.1.2.2.2.2" xref="S2.E4.m1.6.6.1.1.1.1.1.1.1.1.2.2.2.2.cmml">𝐲</mi><mi id="S2.E4.m1.6.6.1.1.1.1.1.1.1.1.2.2.2.3" xref="S2.E4.m1.6.6.1.1.1.1.1.1.1.1.2.2.2.3.cmml">l</mi></msub><mo id="S2.E4.m1.6.6.1.1.1.1.1.1.1.1.2.2.5" xref="S2.E4.m1.6.6.1.1.1.1.1.1.1.1.2.3.cmml">,</mo><mi id="S2.E4.m1.4.4" xref="S2.E4.m1.4.4.cmml">𝐱</mi><mo id="S2.E4.m1.6.6.1.1.1.1.1.1.1.1.2.2.6" xref="S2.E4.m1.6.6.1.1.1.1.1.1.1.1.2.3.cmml">,</mo><mi id="S2.E4.m1.5.5" xref="S2.E4.m1.5.5.cmml">θ</mi><mo id="S2.E4.m1.6.6.1.1.1.1.1.1.1.1.2.2.7" stretchy="false" xref="S2.E4.m1.6.6.1.1.1.1.1.1.1.1.2.3.cmml">)</mo></mrow></mrow><mo id="S2.E4.m1.6.6.1.1.1.1.1.1.1.3" stretchy="false" xref="S2.E4.m1.6.6.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S2.E4.m1.6.6.1.1.1.1.3" stretchy="false" xref="S2.E4.m1.6.6.1.1.1.2.1.cmml">]</mo></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.E4.m1.6b"><apply id="S2.E4.m1.6.6.cmml" xref="S2.E4.m1.6.6"><eq id="S2.E4.m1.6.6.2.cmml" xref="S2.E4.m1.6.6.2"></eq><apply id="S2.E4.m1.6.6.3.cmml" xref="S2.E4.m1.6.6.3"><csymbol cd="ambiguous" id="S2.E4.m1.6.6.3.1.cmml" xref="S2.E4.m1.6.6.3">subscript</csymbol><ci id="S2.E4.m1.6.6.3.2.cmml" xref="S2.E4.m1.6.6.3.2">𝐿</ci><ci id="S2.E4.m1.6.6.3.3a.cmml" xref="S2.E4.m1.6.6.3.3"><mtext id="S2.E4.m1.6.6.3.3.cmml" mathsize="70%" xref="S2.E4.m1.6.6.3.3">DPO</mtext></ci></apply><apply id="S2.E4.m1.6.6.1.cmml" xref="S2.E4.m1.6.6.1"><minus id="S2.E4.m1.6.6.1.2.cmml" xref="S2.E4.m1.6.6.1"></minus><apply id="S2.E4.m1.6.6.1.1.cmml" xref="S2.E4.m1.6.6.1.1"><apply id="S2.E4.m1.6.6.1.1.2.cmml" xref="S2.E4.m1.6.6.1.1.2"><csymbol cd="ambiguous" id="S2.E4.m1.6.6.1.1.2.1.cmml" xref="S2.E4.m1.6.6.1.1.2">subscript</csymbol><ci id="S2.E4.m1.6.6.1.1.2.2.cmml" xref="S2.E4.m1.6.6.1.1.2.2">𝔼</ci><apply id="S2.E4.m1.3.3.3.cmml" xref="S2.E4.m1.3.3.3"><csymbol cd="latexml" id="S2.E4.m1.3.3.3.4.cmml" xref="S2.E4.m1.3.3.3.4">similar-to</csymbol><vector id="S2.E4.m1.3.3.3.3.3.cmml" xref="S2.E4.m1.3.3.3.3.2"><ci id="S2.E4.m1.1.1.1.1.cmml" xref="S2.E4.m1.1.1.1.1">𝐱</ci><apply id="S2.E4.m1.2.2.2.2.1.1.cmml" xref="S2.E4.m1.2.2.2.2.1.1"><csymbol cd="ambiguous" id="S2.E4.m1.2.2.2.2.1.1.1.cmml" xref="S2.E4.m1.2.2.2.2.1.1">subscript</csymbol><ci id="S2.E4.m1.2.2.2.2.1.1.2.cmml" xref="S2.E4.m1.2.2.2.2.1.1.2">𝐲</ci><ci id="S2.E4.m1.2.2.2.2.1.1.3.cmml" xref="S2.E4.m1.2.2.2.2.1.1.3">𝑤</ci></apply><apply id="S2.E4.m1.3.3.3.3.2.2.cmml" xref="S2.E4.m1.3.3.3.3.2.2"><csymbol cd="ambiguous" id="S2.E4.m1.3.3.3.3.2.2.1.cmml" xref="S2.E4.m1.3.3.3.3.2.2">subscript</csymbol><ci id="S2.E4.m1.3.3.3.3.2.2.2.cmml" xref="S2.E4.m1.3.3.3.3.2.2.2">𝐲</ci><ci id="S2.E4.m1.3.3.3.3.2.2.3.cmml" xref="S2.E4.m1.3.3.3.3.2.2.3">𝑙</ci></apply></vector><ci id="S2.E4.m1.3.3.3.5.cmml" xref="S2.E4.m1.3.3.3.5">𝐷</ci></apply></apply><apply id="S2.E4.m1.6.6.1.1.1.2.cmml" xref="S2.E4.m1.6.6.1.1.1.1"><csymbol cd="latexml" id="S2.E4.m1.6.6.1.1.1.2.1.cmml" xref="S2.E4.m1.6.6.1.1.1.1.2">delimited-[]</csymbol><apply id="S2.E4.m1.6.6.1.1.1.1.1.cmml" xref="S2.E4.m1.6.6.1.1.1.1.1"><times id="S2.E4.m1.6.6.1.1.1.1.1.2.cmml" xref="S2.E4.m1.6.6.1.1.1.1.1.2"></times><ci id="S2.E4.m1.6.6.1.1.1.1.1.3a.cmml" xref="S2.E4.m1.6.6.1.1.1.1.1.3"><mtext id="S2.E4.m1.6.6.1.1.1.1.1.3.cmml" xref="S2.E4.m1.6.6.1.1.1.1.1.3">log</mtext></ci><ci id="S2.E4.m1.6.6.1.1.1.1.1.4.cmml" xref="S2.E4.m1.6.6.1.1.1.1.1.4">𝜎</ci><apply id="S2.E4.m1.6.6.1.1.1.1.1.1.1.1.cmml" xref="S2.E4.m1.6.6.1.1.1.1.1.1.1"><times id="S2.E4.m1.6.6.1.1.1.1.1.1.1.1.3.cmml" xref="S2.E4.m1.6.6.1.1.1.1.1.1.1.1.3"></times><ci id="S2.E4.m1.6.6.1.1.1.1.1.1.1.1.4.cmml" xref="S2.E4.m1.6.6.1.1.1.1.1.1.1.1.4">𝑀</ci><vector id="S2.E4.m1.6.6.1.1.1.1.1.1.1.1.2.3.cmml" xref="S2.E4.m1.6.6.1.1.1.1.1.1.1.1.2.2"><apply id="S2.E4.m1.6.6.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S2.E4.m1.6.6.1.1.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S2.E4.m1.6.6.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S2.E4.m1.6.6.1.1.1.1.1.1.1.1.1.1.1">subscript</csymbol><ci id="S2.E4.m1.6.6.1.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S2.E4.m1.6.6.1.1.1.1.1.1.1.1.1.1.1.2">𝐲</ci><ci id="S2.E4.m1.6.6.1.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="S2.E4.m1.6.6.1.1.1.1.1.1.1.1.1.1.1.3">𝑤</ci></apply><apply id="S2.E4.m1.6.6.1.1.1.1.1.1.1.1.2.2.2.cmml" xref="S2.E4.m1.6.6.1.1.1.1.1.1.1.1.2.2.2"><csymbol cd="ambiguous" id="S2.E4.m1.6.6.1.1.1.1.1.1.1.1.2.2.2.1.cmml" xref="S2.E4.m1.6.6.1.1.1.1.1.1.1.1.2.2.2">subscript</csymbol><ci id="S2.E4.m1.6.6.1.1.1.1.1.1.1.1.2.2.2.2.cmml" xref="S2.E4.m1.6.6.1.1.1.1.1.1.1.1.2.2.2.2">𝐲</ci><ci id="S2.E4.m1.6.6.1.1.1.1.1.1.1.1.2.2.2.3.cmml" xref="S2.E4.m1.6.6.1.1.1.1.1.1.1.1.2.2.2.3">𝑙</ci></apply><ci id="S2.E4.m1.4.4.cmml" xref="S2.E4.m1.4.4">𝐱</ci><ci id="S2.E4.m1.5.5.cmml" xref="S2.E4.m1.5.5">𝜃</ci></vector></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.E4.m1.6c">L_{\text{DPO}}=-\mathbb{\mathop{E}}_{(\mathbf{x},\mathbf{y}_{w},\mathbf{y}_{l}%
)\sim D}[\text{log}\sigma(M(\mathbf{y}_{w},\mathbf{y}_{l},{\bf x},\theta))]</annotation><annotation encoding="application/x-llamapun" id="S2.E4.m1.6d">italic_L start_POSTSUBSCRIPT DPO end_POSTSUBSCRIPT = - blackboard_E start_POSTSUBSCRIPT ( bold_x , bold_y start_POSTSUBSCRIPT italic_w end_POSTSUBSCRIPT , bold_y start_POSTSUBSCRIPT italic_l end_POSTSUBSCRIPT ) ∼ italic_D end_POSTSUBSCRIPT [ log italic_σ ( italic_M ( bold_y start_POSTSUBSCRIPT italic_w end_POSTSUBSCRIPT , bold_y start_POSTSUBSCRIPT italic_l end_POSTSUBSCRIPT , bold_x , italic_θ ) ) ]</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(4)</span></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S2.SS1.p2.11">where the reward margin <math alttext="M(\mathbf{y}_{w},\mathbf{y}_{l},{\bf x},\theta)" class="ltx_Math" display="inline" id="S2.SS1.p2.11.m1.4"><semantics id="S2.SS1.p2.11.m1.4a"><mrow id="S2.SS1.p2.11.m1.4.4" xref="S2.SS1.p2.11.m1.4.4.cmml"><mi id="S2.SS1.p2.11.m1.4.4.4" xref="S2.SS1.p2.11.m1.4.4.4.cmml">M</mi><mo id="S2.SS1.p2.11.m1.4.4.3" xref="S2.SS1.p2.11.m1.4.4.3.cmml">⁢</mo><mrow id="S2.SS1.p2.11.m1.4.4.2.2" xref="S2.SS1.p2.11.m1.4.4.2.3.cmml"><mo id="S2.SS1.p2.11.m1.4.4.2.2.3" stretchy="false" xref="S2.SS1.p2.11.m1.4.4.2.3.cmml">(</mo><msub id="S2.SS1.p2.11.m1.3.3.1.1.1" xref="S2.SS1.p2.11.m1.3.3.1.1.1.cmml"><mi id="S2.SS1.p2.11.m1.3.3.1.1.1.2" xref="S2.SS1.p2.11.m1.3.3.1.1.1.2.cmml">𝐲</mi><mi id="S2.SS1.p2.11.m1.3.3.1.1.1.3" xref="S2.SS1.p2.11.m1.3.3.1.1.1.3.cmml">w</mi></msub><mo id="S2.SS1.p2.11.m1.4.4.2.2.4" xref="S2.SS1.p2.11.m1.4.4.2.3.cmml">,</mo><msub id="S2.SS1.p2.11.m1.4.4.2.2.2" xref="S2.SS1.p2.11.m1.4.4.2.2.2.cmml"><mi id="S2.SS1.p2.11.m1.4.4.2.2.2.2" xref="S2.SS1.p2.11.m1.4.4.2.2.2.2.cmml">𝐲</mi><mi id="S2.SS1.p2.11.m1.4.4.2.2.2.3" xref="S2.SS1.p2.11.m1.4.4.2.2.2.3.cmml">l</mi></msub><mo id="S2.SS1.p2.11.m1.4.4.2.2.5" xref="S2.SS1.p2.11.m1.4.4.2.3.cmml">,</mo><mi id="S2.SS1.p2.11.m1.1.1" xref="S2.SS1.p2.11.m1.1.1.cmml">𝐱</mi><mo id="S2.SS1.p2.11.m1.4.4.2.2.6" xref="S2.SS1.p2.11.m1.4.4.2.3.cmml">,</mo><mi id="S2.SS1.p2.11.m1.2.2" xref="S2.SS1.p2.11.m1.2.2.cmml">θ</mi><mo id="S2.SS1.p2.11.m1.4.4.2.2.7" stretchy="false" xref="S2.SS1.p2.11.m1.4.4.2.3.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.SS1.p2.11.m1.4b"><apply id="S2.SS1.p2.11.m1.4.4.cmml" xref="S2.SS1.p2.11.m1.4.4"><times id="S2.SS1.p2.11.m1.4.4.3.cmml" xref="S2.SS1.p2.11.m1.4.4.3"></times><ci id="S2.SS1.p2.11.m1.4.4.4.cmml" xref="S2.SS1.p2.11.m1.4.4.4">𝑀</ci><vector id="S2.SS1.p2.11.m1.4.4.2.3.cmml" xref="S2.SS1.p2.11.m1.4.4.2.2"><apply id="S2.SS1.p2.11.m1.3.3.1.1.1.cmml" xref="S2.SS1.p2.11.m1.3.3.1.1.1"><csymbol cd="ambiguous" id="S2.SS1.p2.11.m1.3.3.1.1.1.1.cmml" xref="S2.SS1.p2.11.m1.3.3.1.1.1">subscript</csymbol><ci id="S2.SS1.p2.11.m1.3.3.1.1.1.2.cmml" xref="S2.SS1.p2.11.m1.3.3.1.1.1.2">𝐲</ci><ci id="S2.SS1.p2.11.m1.3.3.1.1.1.3.cmml" xref="S2.SS1.p2.11.m1.3.3.1.1.1.3">𝑤</ci></apply><apply id="S2.SS1.p2.11.m1.4.4.2.2.2.cmml" xref="S2.SS1.p2.11.m1.4.4.2.2.2"><csymbol cd="ambiguous" id="S2.SS1.p2.11.m1.4.4.2.2.2.1.cmml" xref="S2.SS1.p2.11.m1.4.4.2.2.2">subscript</csymbol><ci id="S2.SS1.p2.11.m1.4.4.2.2.2.2.cmml" xref="S2.SS1.p2.11.m1.4.4.2.2.2.2">𝐲</ci><ci id="S2.SS1.p2.11.m1.4.4.2.2.2.3.cmml" xref="S2.SS1.p2.11.m1.4.4.2.2.2.3">𝑙</ci></apply><ci id="S2.SS1.p2.11.m1.1.1.cmml" xref="S2.SS1.p2.11.m1.1.1">𝐱</ci><ci id="S2.SS1.p2.11.m1.2.2.cmml" xref="S2.SS1.p2.11.m1.2.2">𝜃</ci></vector></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p2.11.m1.4c">M(\mathbf{y}_{w},\mathbf{y}_{l},{\bf x},\theta)</annotation><annotation encoding="application/x-llamapun" id="S2.SS1.p2.11.m1.4d">italic_M ( bold_y start_POSTSUBSCRIPT italic_w end_POSTSUBSCRIPT , bold_y start_POSTSUBSCRIPT italic_l end_POSTSUBSCRIPT , bold_x , italic_θ )</annotation></semantics></math> is</p>
<table class="ltx_equation ltx_eqn_table" id="S2.E5">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\beta\,(\text{log}\frac{\pi_{\theta}(\mathbf{y}_{w}|\mathbf{x})}{\pi_{\text{%
ref}}(\mathbf{y}_{w}|\mathbf{x})}-\text{log}\frac{\pi_{\theta}(\mathbf{y}_{l}|%
\mathbf{x})}{\pi_{\text{ref}}(\mathbf{y}_{l}|\mathbf{x})})" class="ltx_Math" display="block" id="S2.E5.m1.5"><semantics id="S2.E5.m1.5a"><mrow id="S2.E5.m1.5.5" xref="S2.E5.m1.5.5.cmml"><mi id="S2.E5.m1.5.5.3" xref="S2.E5.m1.5.5.3.cmml">β</mi><mo id="S2.E5.m1.5.5.2" lspace="0.170em" xref="S2.E5.m1.5.5.2.cmml">⁢</mo><mrow id="S2.E5.m1.5.5.1.1" xref="S2.E5.m1.5.5.1.1.1.cmml"><mo id="S2.E5.m1.5.5.1.1.2" stretchy="false" xref="S2.E5.m1.5.5.1.1.1.cmml">(</mo><mrow id="S2.E5.m1.5.5.1.1.1" xref="S2.E5.m1.5.5.1.1.1.cmml"><mrow id="S2.E5.m1.5.5.1.1.1.2" xref="S2.E5.m1.5.5.1.1.1.2.cmml"><mtext id="S2.E5.m1.5.5.1.1.1.2.2" xref="S2.E5.m1.5.5.1.1.1.2.2a.cmml">log</mtext><mo id="S2.E5.m1.5.5.1.1.1.2.1" xref="S2.E5.m1.5.5.1.1.1.2.1.cmml">⁢</mo><mfrac id="S2.E5.m1.2.2" xref="S2.E5.m1.2.2.cmml"><mrow id="S2.E5.m1.1.1.1" xref="S2.E5.m1.1.1.1.cmml"><msub id="S2.E5.m1.1.1.1.3" xref="S2.E5.m1.1.1.1.3.cmml"><mi id="S2.E5.m1.1.1.1.3.2" xref="S2.E5.m1.1.1.1.3.2.cmml">π</mi><mi id="S2.E5.m1.1.1.1.3.3" xref="S2.E5.m1.1.1.1.3.3.cmml">θ</mi></msub><mo id="S2.E5.m1.1.1.1.2" xref="S2.E5.m1.1.1.1.2.cmml">⁢</mo><mrow id="S2.E5.m1.1.1.1.1.1" xref="S2.E5.m1.1.1.1.1.1.1.cmml"><mo id="S2.E5.m1.1.1.1.1.1.2" stretchy="false" xref="S2.E5.m1.1.1.1.1.1.1.cmml">(</mo><mrow id="S2.E5.m1.1.1.1.1.1.1" xref="S2.E5.m1.1.1.1.1.1.1.cmml"><msub id="S2.E5.m1.1.1.1.1.1.1.2" xref="S2.E5.m1.1.1.1.1.1.1.2.cmml"><mi id="S2.E5.m1.1.1.1.1.1.1.2.2" xref="S2.E5.m1.1.1.1.1.1.1.2.2.cmml">𝐲</mi><mi id="S2.E5.m1.1.1.1.1.1.1.2.3" xref="S2.E5.m1.1.1.1.1.1.1.2.3.cmml">w</mi></msub><mo fence="false" id="S2.E5.m1.1.1.1.1.1.1.1" xref="S2.E5.m1.1.1.1.1.1.1.1.cmml">|</mo><mi id="S2.E5.m1.1.1.1.1.1.1.3" xref="S2.E5.m1.1.1.1.1.1.1.3.cmml">𝐱</mi></mrow><mo id="S2.E5.m1.1.1.1.1.1.3" stretchy="false" xref="S2.E5.m1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mrow id="S2.E5.m1.2.2.2" xref="S2.E5.m1.2.2.2.cmml"><msub id="S2.E5.m1.2.2.2.3" xref="S2.E5.m1.2.2.2.3.cmml"><mi id="S2.E5.m1.2.2.2.3.2" xref="S2.E5.m1.2.2.2.3.2.cmml">π</mi><mtext id="S2.E5.m1.2.2.2.3.3" xref="S2.E5.m1.2.2.2.3.3a.cmml">ref</mtext></msub><mo id="S2.E5.m1.2.2.2.2" xref="S2.E5.m1.2.2.2.2.cmml">⁢</mo><mrow id="S2.E5.m1.2.2.2.1.1" xref="S2.E5.m1.2.2.2.1.1.1.cmml"><mo id="S2.E5.m1.2.2.2.1.1.2" stretchy="false" xref="S2.E5.m1.2.2.2.1.1.1.cmml">(</mo><mrow id="S2.E5.m1.2.2.2.1.1.1" xref="S2.E5.m1.2.2.2.1.1.1.cmml"><msub id="S2.E5.m1.2.2.2.1.1.1.2" xref="S2.E5.m1.2.2.2.1.1.1.2.cmml"><mi id="S2.E5.m1.2.2.2.1.1.1.2.2" xref="S2.E5.m1.2.2.2.1.1.1.2.2.cmml">𝐲</mi><mi id="S2.E5.m1.2.2.2.1.1.1.2.3" xref="S2.E5.m1.2.2.2.1.1.1.2.3.cmml">w</mi></msub><mo fence="false" id="S2.E5.m1.2.2.2.1.1.1.1" xref="S2.E5.m1.2.2.2.1.1.1.1.cmml">|</mo><mi id="S2.E5.m1.2.2.2.1.1.1.3" xref="S2.E5.m1.2.2.2.1.1.1.3.cmml">𝐱</mi></mrow><mo id="S2.E5.m1.2.2.2.1.1.3" stretchy="false" xref="S2.E5.m1.2.2.2.1.1.1.cmml">)</mo></mrow></mrow></mfrac></mrow><mo id="S2.E5.m1.5.5.1.1.1.1" xref="S2.E5.m1.5.5.1.1.1.1.cmml">−</mo><mrow id="S2.E5.m1.5.5.1.1.1.3" xref="S2.E5.m1.5.5.1.1.1.3.cmml"><mtext id="S2.E5.m1.5.5.1.1.1.3.2" xref="S2.E5.m1.5.5.1.1.1.3.2a.cmml">log</mtext><mo id="S2.E5.m1.5.5.1.1.1.3.1" xref="S2.E5.m1.5.5.1.1.1.3.1.cmml">⁢</mo><mfrac id="S2.E5.m1.4.4" xref="S2.E5.m1.4.4.cmml"><mrow id="S2.E5.m1.3.3.1" xref="S2.E5.m1.3.3.1.cmml"><msub id="S2.E5.m1.3.3.1.3" xref="S2.E5.m1.3.3.1.3.cmml"><mi id="S2.E5.m1.3.3.1.3.2" xref="S2.E5.m1.3.3.1.3.2.cmml">π</mi><mi id="S2.E5.m1.3.3.1.3.3" xref="S2.E5.m1.3.3.1.3.3.cmml">θ</mi></msub><mo id="S2.E5.m1.3.3.1.2" xref="S2.E5.m1.3.3.1.2.cmml">⁢</mo><mrow id="S2.E5.m1.3.3.1.1.1" xref="S2.E5.m1.3.3.1.1.1.1.cmml"><mo id="S2.E5.m1.3.3.1.1.1.2" stretchy="false" xref="S2.E5.m1.3.3.1.1.1.1.cmml">(</mo><mrow id="S2.E5.m1.3.3.1.1.1.1" xref="S2.E5.m1.3.3.1.1.1.1.cmml"><msub id="S2.E5.m1.3.3.1.1.1.1.2" xref="S2.E5.m1.3.3.1.1.1.1.2.cmml"><mi id="S2.E5.m1.3.3.1.1.1.1.2.2" xref="S2.E5.m1.3.3.1.1.1.1.2.2.cmml">𝐲</mi><mi id="S2.E5.m1.3.3.1.1.1.1.2.3" xref="S2.E5.m1.3.3.1.1.1.1.2.3.cmml">l</mi></msub><mo fence="false" id="S2.E5.m1.3.3.1.1.1.1.1" xref="S2.E5.m1.3.3.1.1.1.1.1.cmml">|</mo><mi id="S2.E5.m1.3.3.1.1.1.1.3" xref="S2.E5.m1.3.3.1.1.1.1.3.cmml">𝐱</mi></mrow><mo id="S2.E5.m1.3.3.1.1.1.3" stretchy="false" xref="S2.E5.m1.3.3.1.1.1.1.cmml">)</mo></mrow></mrow><mrow id="S2.E5.m1.4.4.2" xref="S2.E5.m1.4.4.2.cmml"><msub id="S2.E5.m1.4.4.2.3" xref="S2.E5.m1.4.4.2.3.cmml"><mi id="S2.E5.m1.4.4.2.3.2" xref="S2.E5.m1.4.4.2.3.2.cmml">π</mi><mtext id="S2.E5.m1.4.4.2.3.3" xref="S2.E5.m1.4.4.2.3.3a.cmml">ref</mtext></msub><mo id="S2.E5.m1.4.4.2.2" xref="S2.E5.m1.4.4.2.2.cmml">⁢</mo><mrow id="S2.E5.m1.4.4.2.1.1" xref="S2.E5.m1.4.4.2.1.1.1.cmml"><mo id="S2.E5.m1.4.4.2.1.1.2" stretchy="false" xref="S2.E5.m1.4.4.2.1.1.1.cmml">(</mo><mrow id="S2.E5.m1.4.4.2.1.1.1" xref="S2.E5.m1.4.4.2.1.1.1.cmml"><msub id="S2.E5.m1.4.4.2.1.1.1.2" xref="S2.E5.m1.4.4.2.1.1.1.2.cmml"><mi id="S2.E5.m1.4.4.2.1.1.1.2.2" xref="S2.E5.m1.4.4.2.1.1.1.2.2.cmml">𝐲</mi><mi id="S2.E5.m1.4.4.2.1.1.1.2.3" xref="S2.E5.m1.4.4.2.1.1.1.2.3.cmml">l</mi></msub><mo fence="false" id="S2.E5.m1.4.4.2.1.1.1.1" xref="S2.E5.m1.4.4.2.1.1.1.1.cmml">|</mo><mi id="S2.E5.m1.4.4.2.1.1.1.3" xref="S2.E5.m1.4.4.2.1.1.1.3.cmml">𝐱</mi></mrow><mo id="S2.E5.m1.4.4.2.1.1.3" stretchy="false" xref="S2.E5.m1.4.4.2.1.1.1.cmml">)</mo></mrow></mrow></mfrac></mrow></mrow><mo id="S2.E5.m1.5.5.1.1.3" stretchy="false" xref="S2.E5.m1.5.5.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.E5.m1.5b"><apply id="S2.E5.m1.5.5.cmml" xref="S2.E5.m1.5.5"><times id="S2.E5.m1.5.5.2.cmml" xref="S2.E5.m1.5.5.2"></times><ci id="S2.E5.m1.5.5.3.cmml" xref="S2.E5.m1.5.5.3">𝛽</ci><apply id="S2.E5.m1.5.5.1.1.1.cmml" xref="S2.E5.m1.5.5.1.1"><minus id="S2.E5.m1.5.5.1.1.1.1.cmml" xref="S2.E5.m1.5.5.1.1.1.1"></minus><apply id="S2.E5.m1.5.5.1.1.1.2.cmml" xref="S2.E5.m1.5.5.1.1.1.2"><times id="S2.E5.m1.5.5.1.1.1.2.1.cmml" xref="S2.E5.m1.5.5.1.1.1.2.1"></times><ci id="S2.E5.m1.5.5.1.1.1.2.2a.cmml" xref="S2.E5.m1.5.5.1.1.1.2.2"><mtext id="S2.E5.m1.5.5.1.1.1.2.2.cmml" xref="S2.E5.m1.5.5.1.1.1.2.2">log</mtext></ci><apply id="S2.E5.m1.2.2.cmml" xref="S2.E5.m1.2.2"><divide id="S2.E5.m1.2.2.3.cmml" xref="S2.E5.m1.2.2"></divide><apply id="S2.E5.m1.1.1.1.cmml" xref="S2.E5.m1.1.1.1"><times id="S2.E5.m1.1.1.1.2.cmml" xref="S2.E5.m1.1.1.1.2"></times><apply id="S2.E5.m1.1.1.1.3.cmml" xref="S2.E5.m1.1.1.1.3"><csymbol cd="ambiguous" id="S2.E5.m1.1.1.1.3.1.cmml" xref="S2.E5.m1.1.1.1.3">subscript</csymbol><ci id="S2.E5.m1.1.1.1.3.2.cmml" xref="S2.E5.m1.1.1.1.3.2">𝜋</ci><ci id="S2.E5.m1.1.1.1.3.3.cmml" xref="S2.E5.m1.1.1.1.3.3">𝜃</ci></apply><apply id="S2.E5.m1.1.1.1.1.1.1.cmml" xref="S2.E5.m1.1.1.1.1.1"><csymbol cd="latexml" id="S2.E5.m1.1.1.1.1.1.1.1.cmml" xref="S2.E5.m1.1.1.1.1.1.1.1">conditional</csymbol><apply id="S2.E5.m1.1.1.1.1.1.1.2.cmml" xref="S2.E5.m1.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S2.E5.m1.1.1.1.1.1.1.2.1.cmml" xref="S2.E5.m1.1.1.1.1.1.1.2">subscript</csymbol><ci id="S2.E5.m1.1.1.1.1.1.1.2.2.cmml" xref="S2.E5.m1.1.1.1.1.1.1.2.2">𝐲</ci><ci id="S2.E5.m1.1.1.1.1.1.1.2.3.cmml" xref="S2.E5.m1.1.1.1.1.1.1.2.3">𝑤</ci></apply><ci id="S2.E5.m1.1.1.1.1.1.1.3.cmml" xref="S2.E5.m1.1.1.1.1.1.1.3">𝐱</ci></apply></apply><apply id="S2.E5.m1.2.2.2.cmml" xref="S2.E5.m1.2.2.2"><times id="S2.E5.m1.2.2.2.2.cmml" xref="S2.E5.m1.2.2.2.2"></times><apply id="S2.E5.m1.2.2.2.3.cmml" xref="S2.E5.m1.2.2.2.3"><csymbol cd="ambiguous" id="S2.E5.m1.2.2.2.3.1.cmml" xref="S2.E5.m1.2.2.2.3">subscript</csymbol><ci id="S2.E5.m1.2.2.2.3.2.cmml" xref="S2.E5.m1.2.2.2.3.2">𝜋</ci><ci id="S2.E5.m1.2.2.2.3.3a.cmml" xref="S2.E5.m1.2.2.2.3.3"><mtext id="S2.E5.m1.2.2.2.3.3.cmml" mathsize="70%" xref="S2.E5.m1.2.2.2.3.3">ref</mtext></ci></apply><apply id="S2.E5.m1.2.2.2.1.1.1.cmml" xref="S2.E5.m1.2.2.2.1.1"><csymbol cd="latexml" id="S2.E5.m1.2.2.2.1.1.1.1.cmml" xref="S2.E5.m1.2.2.2.1.1.1.1">conditional</csymbol><apply id="S2.E5.m1.2.2.2.1.1.1.2.cmml" xref="S2.E5.m1.2.2.2.1.1.1.2"><csymbol cd="ambiguous" id="S2.E5.m1.2.2.2.1.1.1.2.1.cmml" xref="S2.E5.m1.2.2.2.1.1.1.2">subscript</csymbol><ci id="S2.E5.m1.2.2.2.1.1.1.2.2.cmml" xref="S2.E5.m1.2.2.2.1.1.1.2.2">𝐲</ci><ci id="S2.E5.m1.2.2.2.1.1.1.2.3.cmml" xref="S2.E5.m1.2.2.2.1.1.1.2.3">𝑤</ci></apply><ci id="S2.E5.m1.2.2.2.1.1.1.3.cmml" xref="S2.E5.m1.2.2.2.1.1.1.3">𝐱</ci></apply></apply></apply></apply><apply id="S2.E5.m1.5.5.1.1.1.3.cmml" xref="S2.E5.m1.5.5.1.1.1.3"><times id="S2.E5.m1.5.5.1.1.1.3.1.cmml" xref="S2.E5.m1.5.5.1.1.1.3.1"></times><ci id="S2.E5.m1.5.5.1.1.1.3.2a.cmml" xref="S2.E5.m1.5.5.1.1.1.3.2"><mtext id="S2.E5.m1.5.5.1.1.1.3.2.cmml" xref="S2.E5.m1.5.5.1.1.1.3.2">log</mtext></ci><apply id="S2.E5.m1.4.4.cmml" xref="S2.E5.m1.4.4"><divide id="S2.E5.m1.4.4.3.cmml" xref="S2.E5.m1.4.4"></divide><apply id="S2.E5.m1.3.3.1.cmml" xref="S2.E5.m1.3.3.1"><times id="S2.E5.m1.3.3.1.2.cmml" xref="S2.E5.m1.3.3.1.2"></times><apply id="S2.E5.m1.3.3.1.3.cmml" xref="S2.E5.m1.3.3.1.3"><csymbol cd="ambiguous" id="S2.E5.m1.3.3.1.3.1.cmml" xref="S2.E5.m1.3.3.1.3">subscript</csymbol><ci id="S2.E5.m1.3.3.1.3.2.cmml" xref="S2.E5.m1.3.3.1.3.2">𝜋</ci><ci id="S2.E5.m1.3.3.1.3.3.cmml" xref="S2.E5.m1.3.3.1.3.3">𝜃</ci></apply><apply id="S2.E5.m1.3.3.1.1.1.1.cmml" xref="S2.E5.m1.3.3.1.1.1"><csymbol cd="latexml" id="S2.E5.m1.3.3.1.1.1.1.1.cmml" xref="S2.E5.m1.3.3.1.1.1.1.1">conditional</csymbol><apply id="S2.E5.m1.3.3.1.1.1.1.2.cmml" xref="S2.E5.m1.3.3.1.1.1.1.2"><csymbol cd="ambiguous" id="S2.E5.m1.3.3.1.1.1.1.2.1.cmml" xref="S2.E5.m1.3.3.1.1.1.1.2">subscript</csymbol><ci id="S2.E5.m1.3.3.1.1.1.1.2.2.cmml" xref="S2.E5.m1.3.3.1.1.1.1.2.2">𝐲</ci><ci id="S2.E5.m1.3.3.1.1.1.1.2.3.cmml" xref="S2.E5.m1.3.3.1.1.1.1.2.3">𝑙</ci></apply><ci id="S2.E5.m1.3.3.1.1.1.1.3.cmml" xref="S2.E5.m1.3.3.1.1.1.1.3">𝐱</ci></apply></apply><apply id="S2.E5.m1.4.4.2.cmml" xref="S2.E5.m1.4.4.2"><times id="S2.E5.m1.4.4.2.2.cmml" xref="S2.E5.m1.4.4.2.2"></times><apply id="S2.E5.m1.4.4.2.3.cmml" xref="S2.E5.m1.4.4.2.3"><csymbol cd="ambiguous" id="S2.E5.m1.4.4.2.3.1.cmml" xref="S2.E5.m1.4.4.2.3">subscript</csymbol><ci id="S2.E5.m1.4.4.2.3.2.cmml" xref="S2.E5.m1.4.4.2.3.2">𝜋</ci><ci id="S2.E5.m1.4.4.2.3.3a.cmml" xref="S2.E5.m1.4.4.2.3.3"><mtext id="S2.E5.m1.4.4.2.3.3.cmml" mathsize="70%" xref="S2.E5.m1.4.4.2.3.3">ref</mtext></ci></apply><apply id="S2.E5.m1.4.4.2.1.1.1.cmml" xref="S2.E5.m1.4.4.2.1.1"><csymbol cd="latexml" id="S2.E5.m1.4.4.2.1.1.1.1.cmml" xref="S2.E5.m1.4.4.2.1.1.1.1">conditional</csymbol><apply id="S2.E5.m1.4.4.2.1.1.1.2.cmml" xref="S2.E5.m1.4.4.2.1.1.1.2"><csymbol cd="ambiguous" id="S2.E5.m1.4.4.2.1.1.1.2.1.cmml" xref="S2.E5.m1.4.4.2.1.1.1.2">subscript</csymbol><ci id="S2.E5.m1.4.4.2.1.1.1.2.2.cmml" xref="S2.E5.m1.4.4.2.1.1.1.2.2">𝐲</ci><ci id="S2.E5.m1.4.4.2.1.1.1.2.3.cmml" xref="S2.E5.m1.4.4.2.1.1.1.2.3">𝑙</ci></apply><ci id="S2.E5.m1.4.4.2.1.1.1.3.cmml" xref="S2.E5.m1.4.4.2.1.1.1.3">𝐱</ci></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.E5.m1.5c">\beta\,(\text{log}\frac{\pi_{\theta}(\mathbf{y}_{w}|\mathbf{x})}{\pi_{\text{%
ref}}(\mathbf{y}_{w}|\mathbf{x})}-\text{log}\frac{\pi_{\theta}(\mathbf{y}_{l}|%
\mathbf{x})}{\pi_{\text{ref}}(\mathbf{y}_{l}|\mathbf{x})})</annotation><annotation encoding="application/x-llamapun" id="S2.E5.m1.5d">italic_β ( log divide start_ARG italic_π start_POSTSUBSCRIPT italic_θ end_POSTSUBSCRIPT ( bold_y start_POSTSUBSCRIPT italic_w end_POSTSUBSCRIPT | bold_x ) end_ARG start_ARG italic_π start_POSTSUBSCRIPT ref end_POSTSUBSCRIPT ( bold_y start_POSTSUBSCRIPT italic_w end_POSTSUBSCRIPT | bold_x ) end_ARG - log divide start_ARG italic_π start_POSTSUBSCRIPT italic_θ end_POSTSUBSCRIPT ( bold_y start_POSTSUBSCRIPT italic_l end_POSTSUBSCRIPT | bold_x ) end_ARG start_ARG italic_π start_POSTSUBSCRIPT ref end_POSTSUBSCRIPT ( bold_y start_POSTSUBSCRIPT italic_l end_POSTSUBSCRIPT | bold_x ) end_ARG )</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(5)</span></td>
</tr></tbody>
</table>
</div>
</section>
<section class="ltx_subsection" id="S2.SS2">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">2.2 </span>Related Work in Translation</h3>
<div class="ltx_para" id="S2.SS2.p1">
<p class="ltx_p" id="S2.SS2.p1.1">Previous work has explored the effectiveness of enhancing the translation performance of LLMs via Reinforcement Learning (RL) algorithms or supervised fine-tuning. <cite class="ltx_cite ltx_citemacro_citet">Dong et al. (<a class="ltx_ref" href="https://arxiv.org/html/2311.08380v2#bib.bib4" title="">2023</a>)</cite> proposed RAFT that iteratively generates samples and fine-tunes the model on the filtered samples ranked by a reward model. <cite class="ltx_cite ltx_citemacro_citet">Gulcehre et al. (<a class="ltx_ref" href="https://arxiv.org/html/2311.08380v2#bib.bib11" title="">2023</a>)</cite> proposed ReST that uses similar method for translation task, where they apply several fine-tuning steps on a sampled dataset, each time higher ranked samples.</p>
</div>
<div class="ltx_para" id="S2.SS2.p2">
<p class="ltx_p" id="S2.SS2.p2.1">Similar to our pairwise preference learning, <cite class="ltx_cite ltx_citemacro_citet">Zeng et al. (<a class="ltx_ref" href="https://arxiv.org/html/2311.08380v2#bib.bib26" title="">2023b</a>)</cite> introduced a framework TIM to enhance the translation performance of LLMs by learning to compare good translations and bad translations via a preference learning loss.</p>
</div>
<div class="ltx_para" id="S2.SS2.p3">
<p class="ltx_p" id="S2.SS2.p3.1">Contemporaneous with this work, <cite class="ltx_cite ltx_citemacro_citet">Finkelstein et al. (<a class="ltx_ref" href="https://arxiv.org/html/2311.08380v2#bib.bib6" title="">2023</a>)</cite> proposed MBR fine-tuning, which fine-tunes an NMT model on the MBR decoding outputs generated either by the model itself or by an LLM. However, their MBR fine-tuning utilizes only the final translations of MBR decoding whereas our fine-tuning method uses sets of sampled translations ranked by MBR, thus enabling the model to learn the same ranking preferences as MBR.</p>
</div>
</section>
</section>
<section class="ltx_section" id="S3">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">3 </span>Methodology</h2>
<div class="ltx_para" id="S3.p1">
<p class="ltx_p" id="S3.p1.1">Our method combines MBR decoding and DPO fine-tuning <cite class="ltx_cite ltx_citemacro_cite">Yang (<a class="ltx_ref" href="https://arxiv.org/html/2311.08380v2#bib.bib24" title="">2023</a>)</cite>. We use the MBR procedure to calculate a score (Equation <a class="ltx_ref" href="https://arxiv.org/html/2311.08380v2#S2.E1" title="In 2 MBR and DPO ‣ Direct Preference Optimization for Neural Machine Translation with Minimum Bayes Risk Decoding"><span class="ltx_text ltx_ref_tag">1</span></a>) for each of a set of translation hypothesis generated by the base model. We then fine-tune the base model using the DPO objective (Equations <a class="ltx_ref" href="https://arxiv.org/html/2311.08380v2#S2.E4" title="In 2.1 DPO Fine-Tuning Objective ‣ 2 MBR and DPO ‣ Direct Preference Optimization for Neural Machine Translation with Minimum Bayes Risk Decoding"><span class="ltx_text ltx_ref_tag">4</span></a>,<a class="ltx_ref" href="https://arxiv.org/html/2311.08380v2#S2.E5" title="In 2.1 DPO Fine-Tuning Objective ‣ 2 MBR and DPO ‣ Direct Preference Optimization for Neural Machine Translation with Minimum Bayes Risk Decoding"><span class="ltx_text ltx_ref_tag">5</span></a>) where the winning and losing hypotheses provided to DPO are chosen based on their relative MBR scores. If successful, the fine-tuned model will have learned to rank translations consistently with MBR decoding under the base model.</p>
</div>
<section class="ltx_subsection" id="S3.SS1">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.1 </span>Creation of the DPO Preference Sets </h3>
<div class="ltx_para" id="S3.SS1.p1">
<p class="ltx_p" id="S3.SS1.p1.3">Following <cite class="ltx_cite ltx_citemacro_citet">Eikema and Aziz (<a class="ltx_ref" href="https://arxiv.org/html/2311.08380v2#bib.bib5" title="">2022</a>)</cite>, we use sampling to generate the translation hypotheses that will be used in DPO. For a source sentence <math alttext="\mathbf{x}" class="ltx_Math" display="inline" id="S3.SS1.p1.1.m1.1"><semantics id="S3.SS1.p1.1.m1.1a"><mi id="S3.SS1.p1.1.m1.1.1" xref="S3.SS1.p1.1.m1.1.1.cmml">𝐱</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.1.m1.1b"><ci id="S3.SS1.p1.1.m1.1.1.cmml" xref="S3.SS1.p1.1.m1.1.1">𝐱</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.1.m1.1c">\mathbf{x}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p1.1.m1.1d">bold_x</annotation></semantics></math> we use simple ancestral sampling with a temperature of 0.7 to create a set of translations <math alttext="H(x)=\{\mathbf{y}\sim\pi_{base}(\mathbf{y}|\mathbf{x})\}" class="ltx_Math" display="inline" id="S3.SS1.p1.2.m2.2"><semantics id="S3.SS1.p1.2.m2.2a"><mrow id="S3.SS1.p1.2.m2.2.2" xref="S3.SS1.p1.2.m2.2.2.cmml"><mrow id="S3.SS1.p1.2.m2.2.2.3" xref="S3.SS1.p1.2.m2.2.2.3.cmml"><mi id="S3.SS1.p1.2.m2.2.2.3.2" xref="S3.SS1.p1.2.m2.2.2.3.2.cmml">H</mi><mo id="S3.SS1.p1.2.m2.2.2.3.1" xref="S3.SS1.p1.2.m2.2.2.3.1.cmml">⁢</mo><mrow id="S3.SS1.p1.2.m2.2.2.3.3.2" xref="S3.SS1.p1.2.m2.2.2.3.cmml"><mo id="S3.SS1.p1.2.m2.2.2.3.3.2.1" stretchy="false" xref="S3.SS1.p1.2.m2.2.2.3.cmml">(</mo><mi id="S3.SS1.p1.2.m2.1.1" xref="S3.SS1.p1.2.m2.1.1.cmml">x</mi><mo id="S3.SS1.p1.2.m2.2.2.3.3.2.2" stretchy="false" xref="S3.SS1.p1.2.m2.2.2.3.cmml">)</mo></mrow></mrow><mo id="S3.SS1.p1.2.m2.2.2.2" xref="S3.SS1.p1.2.m2.2.2.2.cmml">=</mo><mrow id="S3.SS1.p1.2.m2.2.2.1.1" xref="S3.SS1.p1.2.m2.2.2.1.2.cmml"><mo id="S3.SS1.p1.2.m2.2.2.1.1.2" stretchy="false" xref="S3.SS1.p1.2.m2.2.2.1.2.cmml">{</mo><mrow id="S3.SS1.p1.2.m2.2.2.1.1.1" xref="S3.SS1.p1.2.m2.2.2.1.1.1.cmml"><mi id="S3.SS1.p1.2.m2.2.2.1.1.1.3" xref="S3.SS1.p1.2.m2.2.2.1.1.1.3.cmml">𝐲</mi><mo id="S3.SS1.p1.2.m2.2.2.1.1.1.2" xref="S3.SS1.p1.2.m2.2.2.1.1.1.2.cmml">∼</mo><mrow id="S3.SS1.p1.2.m2.2.2.1.1.1.1" xref="S3.SS1.p1.2.m2.2.2.1.1.1.1.cmml"><msub id="S3.SS1.p1.2.m2.2.2.1.1.1.1.3" xref="S3.SS1.p1.2.m2.2.2.1.1.1.1.3.cmml"><mi id="S3.SS1.p1.2.m2.2.2.1.1.1.1.3.2" xref="S3.SS1.p1.2.m2.2.2.1.1.1.1.3.2.cmml">π</mi><mrow id="S3.SS1.p1.2.m2.2.2.1.1.1.1.3.3" xref="S3.SS1.p1.2.m2.2.2.1.1.1.1.3.3.cmml"><mi id="S3.SS1.p1.2.m2.2.2.1.1.1.1.3.3.2" xref="S3.SS1.p1.2.m2.2.2.1.1.1.1.3.3.2.cmml">b</mi><mo id="S3.SS1.p1.2.m2.2.2.1.1.1.1.3.3.1" xref="S3.SS1.p1.2.m2.2.2.1.1.1.1.3.3.1.cmml">⁢</mo><mi id="S3.SS1.p1.2.m2.2.2.1.1.1.1.3.3.3" xref="S3.SS1.p1.2.m2.2.2.1.1.1.1.3.3.3.cmml">a</mi><mo id="S3.SS1.p1.2.m2.2.2.1.1.1.1.3.3.1a" xref="S3.SS1.p1.2.m2.2.2.1.1.1.1.3.3.1.cmml">⁢</mo><mi id="S3.SS1.p1.2.m2.2.2.1.1.1.1.3.3.4" xref="S3.SS1.p1.2.m2.2.2.1.1.1.1.3.3.4.cmml">s</mi><mo id="S3.SS1.p1.2.m2.2.2.1.1.1.1.3.3.1b" xref="S3.SS1.p1.2.m2.2.2.1.1.1.1.3.3.1.cmml">⁢</mo><mi id="S3.SS1.p1.2.m2.2.2.1.1.1.1.3.3.5" xref="S3.SS1.p1.2.m2.2.2.1.1.1.1.3.3.5.cmml">e</mi></mrow></msub><mo id="S3.SS1.p1.2.m2.2.2.1.1.1.1.2" xref="S3.SS1.p1.2.m2.2.2.1.1.1.1.2.cmml">⁢</mo><mrow id="S3.SS1.p1.2.m2.2.2.1.1.1.1.1.1" xref="S3.SS1.p1.2.m2.2.2.1.1.1.1.1.1.1.cmml"><mo id="S3.SS1.p1.2.m2.2.2.1.1.1.1.1.1.2" stretchy="false" xref="S3.SS1.p1.2.m2.2.2.1.1.1.1.1.1.1.cmml">(</mo><mrow id="S3.SS1.p1.2.m2.2.2.1.1.1.1.1.1.1" xref="S3.SS1.p1.2.m2.2.2.1.1.1.1.1.1.1.cmml"><mi id="S3.SS1.p1.2.m2.2.2.1.1.1.1.1.1.1.2" xref="S3.SS1.p1.2.m2.2.2.1.1.1.1.1.1.1.2.cmml">𝐲</mi><mo fence="false" id="S3.SS1.p1.2.m2.2.2.1.1.1.1.1.1.1.1" xref="S3.SS1.p1.2.m2.2.2.1.1.1.1.1.1.1.1.cmml">|</mo><mi id="S3.SS1.p1.2.m2.2.2.1.1.1.1.1.1.1.3" xref="S3.SS1.p1.2.m2.2.2.1.1.1.1.1.1.1.3.cmml">𝐱</mi></mrow><mo id="S3.SS1.p1.2.m2.2.2.1.1.1.1.1.1.3" stretchy="false" xref="S3.SS1.p1.2.m2.2.2.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><mo id="S3.SS1.p1.2.m2.2.2.1.1.3" stretchy="false" xref="S3.SS1.p1.2.m2.2.2.1.2.cmml">}</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.2.m2.2b"><apply id="S3.SS1.p1.2.m2.2.2.cmml" xref="S3.SS1.p1.2.m2.2.2"><eq id="S3.SS1.p1.2.m2.2.2.2.cmml" xref="S3.SS1.p1.2.m2.2.2.2"></eq><apply id="S3.SS1.p1.2.m2.2.2.3.cmml" xref="S3.SS1.p1.2.m2.2.2.3"><times id="S3.SS1.p1.2.m2.2.2.3.1.cmml" xref="S3.SS1.p1.2.m2.2.2.3.1"></times><ci id="S3.SS1.p1.2.m2.2.2.3.2.cmml" xref="S3.SS1.p1.2.m2.2.2.3.2">𝐻</ci><ci id="S3.SS1.p1.2.m2.1.1.cmml" xref="S3.SS1.p1.2.m2.1.1">𝑥</ci></apply><set id="S3.SS1.p1.2.m2.2.2.1.2.cmml" xref="S3.SS1.p1.2.m2.2.2.1.1"><apply id="S3.SS1.p1.2.m2.2.2.1.1.1.cmml" xref="S3.SS1.p1.2.m2.2.2.1.1.1"><csymbol cd="latexml" id="S3.SS1.p1.2.m2.2.2.1.1.1.2.cmml" xref="S3.SS1.p1.2.m2.2.2.1.1.1.2">similar-to</csymbol><ci id="S3.SS1.p1.2.m2.2.2.1.1.1.3.cmml" xref="S3.SS1.p1.2.m2.2.2.1.1.1.3">𝐲</ci><apply id="S3.SS1.p1.2.m2.2.2.1.1.1.1.cmml" xref="S3.SS1.p1.2.m2.2.2.1.1.1.1"><times id="S3.SS1.p1.2.m2.2.2.1.1.1.1.2.cmml" xref="S3.SS1.p1.2.m2.2.2.1.1.1.1.2"></times><apply id="S3.SS1.p1.2.m2.2.2.1.1.1.1.3.cmml" xref="S3.SS1.p1.2.m2.2.2.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.SS1.p1.2.m2.2.2.1.1.1.1.3.1.cmml" xref="S3.SS1.p1.2.m2.2.2.1.1.1.1.3">subscript</csymbol><ci id="S3.SS1.p1.2.m2.2.2.1.1.1.1.3.2.cmml" xref="S3.SS1.p1.2.m2.2.2.1.1.1.1.3.2">𝜋</ci><apply id="S3.SS1.p1.2.m2.2.2.1.1.1.1.3.3.cmml" xref="S3.SS1.p1.2.m2.2.2.1.1.1.1.3.3"><times id="S3.SS1.p1.2.m2.2.2.1.1.1.1.3.3.1.cmml" xref="S3.SS1.p1.2.m2.2.2.1.1.1.1.3.3.1"></times><ci id="S3.SS1.p1.2.m2.2.2.1.1.1.1.3.3.2.cmml" xref="S3.SS1.p1.2.m2.2.2.1.1.1.1.3.3.2">𝑏</ci><ci id="S3.SS1.p1.2.m2.2.2.1.1.1.1.3.3.3.cmml" xref="S3.SS1.p1.2.m2.2.2.1.1.1.1.3.3.3">𝑎</ci><ci id="S3.SS1.p1.2.m2.2.2.1.1.1.1.3.3.4.cmml" xref="S3.SS1.p1.2.m2.2.2.1.1.1.1.3.3.4">𝑠</ci><ci id="S3.SS1.p1.2.m2.2.2.1.1.1.1.3.3.5.cmml" xref="S3.SS1.p1.2.m2.2.2.1.1.1.1.3.3.5">𝑒</ci></apply></apply><apply id="S3.SS1.p1.2.m2.2.2.1.1.1.1.1.1.1.cmml" xref="S3.SS1.p1.2.m2.2.2.1.1.1.1.1.1"><csymbol cd="latexml" id="S3.SS1.p1.2.m2.2.2.1.1.1.1.1.1.1.1.cmml" xref="S3.SS1.p1.2.m2.2.2.1.1.1.1.1.1.1.1">conditional</csymbol><ci id="S3.SS1.p1.2.m2.2.2.1.1.1.1.1.1.1.2.cmml" xref="S3.SS1.p1.2.m2.2.2.1.1.1.1.1.1.1.2">𝐲</ci><ci id="S3.SS1.p1.2.m2.2.2.1.1.1.1.1.1.1.3.cmml" xref="S3.SS1.p1.2.m2.2.2.1.1.1.1.1.1.1.3">𝐱</ci></apply></apply></apply></set></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.2.m2.2c">H(x)=\{\mathbf{y}\sim\pi_{base}(\mathbf{y}|\mathbf{x})\}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p1.2.m2.2d">italic_H ( italic_x ) = { bold_y ∼ italic_π start_POSTSUBSCRIPT italic_b italic_a italic_s italic_e end_POSTSUBSCRIPT ( bold_y | bold_x ) }</annotation></semantics></math> of size <math alttext="|H(x)|" class="ltx_Math" display="inline" id="S3.SS1.p1.3.m3.2"><semantics id="S3.SS1.p1.3.m3.2a"><mrow id="S3.SS1.p1.3.m3.2.2.1" xref="S3.SS1.p1.3.m3.2.2.2.cmml"><mo id="S3.SS1.p1.3.m3.2.2.1.2" stretchy="false" xref="S3.SS1.p1.3.m3.2.2.2.1.cmml">|</mo><mrow id="S3.SS1.p1.3.m3.2.2.1.1" xref="S3.SS1.p1.3.m3.2.2.1.1.cmml"><mi id="S3.SS1.p1.3.m3.2.2.1.1.2" xref="S3.SS1.p1.3.m3.2.2.1.1.2.cmml">H</mi><mo id="S3.SS1.p1.3.m3.2.2.1.1.1" xref="S3.SS1.p1.3.m3.2.2.1.1.1.cmml">⁢</mo><mrow id="S3.SS1.p1.3.m3.2.2.1.1.3.2" xref="S3.SS1.p1.3.m3.2.2.1.1.cmml"><mo id="S3.SS1.p1.3.m3.2.2.1.1.3.2.1" stretchy="false" xref="S3.SS1.p1.3.m3.2.2.1.1.cmml">(</mo><mi id="S3.SS1.p1.3.m3.1.1" xref="S3.SS1.p1.3.m3.1.1.cmml">x</mi><mo id="S3.SS1.p1.3.m3.2.2.1.1.3.2.2" stretchy="false" xref="S3.SS1.p1.3.m3.2.2.1.1.cmml">)</mo></mrow></mrow><mo id="S3.SS1.p1.3.m3.2.2.1.3" stretchy="false" xref="S3.SS1.p1.3.m3.2.2.2.1.cmml">|</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.3.m3.2b"><apply id="S3.SS1.p1.3.m3.2.2.2.cmml" xref="S3.SS1.p1.3.m3.2.2.1"><abs id="S3.SS1.p1.3.m3.2.2.2.1.cmml" xref="S3.SS1.p1.3.m3.2.2.1.2"></abs><apply id="S3.SS1.p1.3.m3.2.2.1.1.cmml" xref="S3.SS1.p1.3.m3.2.2.1.1"><times id="S3.SS1.p1.3.m3.2.2.1.1.1.cmml" xref="S3.SS1.p1.3.m3.2.2.1.1.1"></times><ci id="S3.SS1.p1.3.m3.2.2.1.1.2.cmml" xref="S3.SS1.p1.3.m3.2.2.1.1.2">𝐻</ci><ci id="S3.SS1.p1.3.m3.1.1.cmml" xref="S3.SS1.p1.3.m3.1.1">𝑥</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.3.m3.2c">|H(x)|</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p1.3.m3.2d">| italic_H ( italic_x ) |</annotation></semantics></math>. We use this collection as both the MBR evidence and hypothesis spaces <cite class="ltx_cite ltx_citemacro_cite">Goel and Byrne (<a class="ltx_ref" href="https://arxiv.org/html/2311.08380v2#bib.bib10" title="">2000</a>)</cite>.</p>
</div>
<div class="ltx_para" id="S3.SS1.p2">
<p class="ltx_p" id="S3.SS1.p2.3">The hypotheses in <math alttext="H(x)" class="ltx_Math" display="inline" id="S3.SS1.p2.1.m1.1"><semantics id="S3.SS1.p2.1.m1.1a"><mrow id="S3.SS1.p2.1.m1.1.2" xref="S3.SS1.p2.1.m1.1.2.cmml"><mi id="S3.SS1.p2.1.m1.1.2.2" xref="S3.SS1.p2.1.m1.1.2.2.cmml">H</mi><mo id="S3.SS1.p2.1.m1.1.2.1" xref="S3.SS1.p2.1.m1.1.2.1.cmml">⁢</mo><mrow id="S3.SS1.p2.1.m1.1.2.3.2" xref="S3.SS1.p2.1.m1.1.2.cmml"><mo id="S3.SS1.p2.1.m1.1.2.3.2.1" stretchy="false" xref="S3.SS1.p2.1.m1.1.2.cmml">(</mo><mi id="S3.SS1.p2.1.m1.1.1" xref="S3.SS1.p2.1.m1.1.1.cmml">x</mi><mo id="S3.SS1.p2.1.m1.1.2.3.2.2" stretchy="false" xref="S3.SS1.p2.1.m1.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p2.1.m1.1b"><apply id="S3.SS1.p2.1.m1.1.2.cmml" xref="S3.SS1.p2.1.m1.1.2"><times id="S3.SS1.p2.1.m1.1.2.1.cmml" xref="S3.SS1.p2.1.m1.1.2.1"></times><ci id="S3.SS1.p2.1.m1.1.2.2.cmml" xref="S3.SS1.p2.1.m1.1.2.2">𝐻</ci><ci id="S3.SS1.p2.1.m1.1.1.cmml" xref="S3.SS1.p2.1.m1.1.1">𝑥</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p2.1.m1.1c">H(x)</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p2.1.m1.1d">italic_H ( italic_x )</annotation></semantics></math> are ordered by their MBR scores as <math alttext="\mathbf{y}_{1},\mathbf{y}_{2},...,\mathbf{y}_{|H|}" class="ltx_Math" display="inline" id="S3.SS1.p2.2.m2.5"><semantics id="S3.SS1.p2.2.m2.5a"><mrow id="S3.SS1.p2.2.m2.5.5.3" xref="S3.SS1.p2.2.m2.5.5.4.cmml"><msub id="S3.SS1.p2.2.m2.3.3.1.1" xref="S3.SS1.p2.2.m2.3.3.1.1.cmml"><mi id="S3.SS1.p2.2.m2.3.3.1.1.2" xref="S3.SS1.p2.2.m2.3.3.1.1.2.cmml">𝐲</mi><mn id="S3.SS1.p2.2.m2.3.3.1.1.3" xref="S3.SS1.p2.2.m2.3.3.1.1.3.cmml">1</mn></msub><mo id="S3.SS1.p2.2.m2.5.5.3.4" xref="S3.SS1.p2.2.m2.5.5.4.cmml">,</mo><msub id="S3.SS1.p2.2.m2.4.4.2.2" xref="S3.SS1.p2.2.m2.4.4.2.2.cmml"><mi id="S3.SS1.p2.2.m2.4.4.2.2.2" xref="S3.SS1.p2.2.m2.4.4.2.2.2.cmml">𝐲</mi><mn id="S3.SS1.p2.2.m2.4.4.2.2.3" xref="S3.SS1.p2.2.m2.4.4.2.2.3.cmml">2</mn></msub><mo id="S3.SS1.p2.2.m2.5.5.3.5" xref="S3.SS1.p2.2.m2.5.5.4.cmml">,</mo><mi id="S3.SS1.p2.2.m2.2.2" mathvariant="normal" xref="S3.SS1.p2.2.m2.2.2.cmml">…</mi><mo id="S3.SS1.p2.2.m2.5.5.3.6" xref="S3.SS1.p2.2.m2.5.5.4.cmml">,</mo><msub id="S3.SS1.p2.2.m2.5.5.3.3" xref="S3.SS1.p2.2.m2.5.5.3.3.cmml"><mi id="S3.SS1.p2.2.m2.5.5.3.3.2" xref="S3.SS1.p2.2.m2.5.5.3.3.2.cmml">𝐲</mi><mrow id="S3.SS1.p2.2.m2.1.1.1.3" xref="S3.SS1.p2.2.m2.1.1.1.2.cmml"><mo id="S3.SS1.p2.2.m2.1.1.1.3.1" stretchy="false" xref="S3.SS1.p2.2.m2.1.1.1.2.1.cmml">|</mo><mi id="S3.SS1.p2.2.m2.1.1.1.1" xref="S3.SS1.p2.2.m2.1.1.1.1.cmml">H</mi><mo id="S3.SS1.p2.2.m2.1.1.1.3.2" stretchy="false" xref="S3.SS1.p2.2.m2.1.1.1.2.1.cmml">|</mo></mrow></msub></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p2.2.m2.5b"><list id="S3.SS1.p2.2.m2.5.5.4.cmml" xref="S3.SS1.p2.2.m2.5.5.3"><apply id="S3.SS1.p2.2.m2.3.3.1.1.cmml" xref="S3.SS1.p2.2.m2.3.3.1.1"><csymbol cd="ambiguous" id="S3.SS1.p2.2.m2.3.3.1.1.1.cmml" xref="S3.SS1.p2.2.m2.3.3.1.1">subscript</csymbol><ci id="S3.SS1.p2.2.m2.3.3.1.1.2.cmml" xref="S3.SS1.p2.2.m2.3.3.1.1.2">𝐲</ci><cn id="S3.SS1.p2.2.m2.3.3.1.1.3.cmml" type="integer" xref="S3.SS1.p2.2.m2.3.3.1.1.3">1</cn></apply><apply id="S3.SS1.p2.2.m2.4.4.2.2.cmml" xref="S3.SS1.p2.2.m2.4.4.2.2"><csymbol cd="ambiguous" id="S3.SS1.p2.2.m2.4.4.2.2.1.cmml" xref="S3.SS1.p2.2.m2.4.4.2.2">subscript</csymbol><ci id="S3.SS1.p2.2.m2.4.4.2.2.2.cmml" xref="S3.SS1.p2.2.m2.4.4.2.2.2">𝐲</ci><cn id="S3.SS1.p2.2.m2.4.4.2.2.3.cmml" type="integer" xref="S3.SS1.p2.2.m2.4.4.2.2.3">2</cn></apply><ci id="S3.SS1.p2.2.m2.2.2.cmml" xref="S3.SS1.p2.2.m2.2.2">…</ci><apply id="S3.SS1.p2.2.m2.5.5.3.3.cmml" xref="S3.SS1.p2.2.m2.5.5.3.3"><csymbol cd="ambiguous" id="S3.SS1.p2.2.m2.5.5.3.3.1.cmml" xref="S3.SS1.p2.2.m2.5.5.3.3">subscript</csymbol><ci id="S3.SS1.p2.2.m2.5.5.3.3.2.cmml" xref="S3.SS1.p2.2.m2.5.5.3.3.2">𝐲</ci><apply id="S3.SS1.p2.2.m2.1.1.1.2.cmml" xref="S3.SS1.p2.2.m2.1.1.1.3"><abs id="S3.SS1.p2.2.m2.1.1.1.2.1.cmml" xref="S3.SS1.p2.2.m2.1.1.1.3.1"></abs><ci id="S3.SS1.p2.2.m2.1.1.1.1.cmml" xref="S3.SS1.p2.2.m2.1.1.1.1">𝐻</ci></apply></apply></list></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p2.2.m2.5c">\mathbf{y}_{1},\mathbf{y}_{2},...,\mathbf{y}_{|H|}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p2.2.m2.5d">bold_y start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT , bold_y start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT , … , bold_y start_POSTSUBSCRIPT | italic_H | end_POSTSUBSCRIPT</annotation></semantics></math> with the BLEURT metric <cite class="ltx_cite ltx_citemacro_cite">Sellam et al. (<a class="ltx_ref" href="https://arxiv.org/html/2311.08380v2#bib.bib21" title="">2020</a>)</cite> as the utility function. The ordering reflects the MBR preference, i.e. <math alttext="\mathbf{y}_{1}" class="ltx_Math" display="inline" id="S3.SS1.p2.3.m3.1"><semantics id="S3.SS1.p2.3.m3.1a"><msub id="S3.SS1.p2.3.m3.1.1" xref="S3.SS1.p2.3.m3.1.1.cmml"><mi id="S3.SS1.p2.3.m3.1.1.2" xref="S3.SS1.p2.3.m3.1.1.2.cmml">𝐲</mi><mn id="S3.SS1.p2.3.m3.1.1.3" xref="S3.SS1.p2.3.m3.1.1.3.cmml">1</mn></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.p2.3.m3.1b"><apply id="S3.SS1.p2.3.m3.1.1.cmml" xref="S3.SS1.p2.3.m3.1.1"><csymbol cd="ambiguous" id="S3.SS1.p2.3.m3.1.1.1.cmml" xref="S3.SS1.p2.3.m3.1.1">subscript</csymbol><ci id="S3.SS1.p2.3.m3.1.1.2.cmml" xref="S3.SS1.p2.3.m3.1.1.2">𝐲</ci><cn id="S3.SS1.p2.3.m3.1.1.3.cmml" type="integer" xref="S3.SS1.p2.3.m3.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p2.3.m3.1c">\mathbf{y}_{1}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p2.3.m3.1d">bold_y start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT</annotation></semantics></math> would be the most preferred MBR hypothesis.</p>
</div>
<section class="ltx_paragraph" id="S3.SS1.SSS0.Px1">
<h5 class="ltx_title ltx_title_paragraph">Preference Selection Strategies</h5>
<div class="ltx_para" id="S3.SS1.SSS0.Px1.p1">
<p class="ltx_p" id="S3.SS1.SSS0.Px1.p1.5">DPO requires a set of preference triplets <math alttext="\mathcal{D}=\{({\bf x},\mathbf{y}_{w},\mathbf{y}_{l})\}" class="ltx_Math" display="inline" id="S3.SS1.SSS0.Px1.p1.1.m1.2"><semantics id="S3.SS1.SSS0.Px1.p1.1.m1.2a"><mrow id="S3.SS1.SSS0.Px1.p1.1.m1.2.2" xref="S3.SS1.SSS0.Px1.p1.1.m1.2.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS1.SSS0.Px1.p1.1.m1.2.2.3" xref="S3.SS1.SSS0.Px1.p1.1.m1.2.2.3.cmml">𝒟</mi><mo id="S3.SS1.SSS0.Px1.p1.1.m1.2.2.2" xref="S3.SS1.SSS0.Px1.p1.1.m1.2.2.2.cmml">=</mo><mrow id="S3.SS1.SSS0.Px1.p1.1.m1.2.2.1.1" xref="S3.SS1.SSS0.Px1.p1.1.m1.2.2.1.2.cmml"><mo id="S3.SS1.SSS0.Px1.p1.1.m1.2.2.1.1.2" stretchy="false" xref="S3.SS1.SSS0.Px1.p1.1.m1.2.2.1.2.cmml">{</mo><mrow id="S3.SS1.SSS0.Px1.p1.1.m1.2.2.1.1.1.2" xref="S3.SS1.SSS0.Px1.p1.1.m1.2.2.1.1.1.3.cmml"><mo id="S3.SS1.SSS0.Px1.p1.1.m1.2.2.1.1.1.2.3" stretchy="false" xref="S3.SS1.SSS0.Px1.p1.1.m1.2.2.1.1.1.3.cmml">(</mo><mi id="S3.SS1.SSS0.Px1.p1.1.m1.1.1" xref="S3.SS1.SSS0.Px1.p1.1.m1.1.1.cmml">𝐱</mi><mo id="S3.SS1.SSS0.Px1.p1.1.m1.2.2.1.1.1.2.4" xref="S3.SS1.SSS0.Px1.p1.1.m1.2.2.1.1.1.3.cmml">,</mo><msub id="S3.SS1.SSS0.Px1.p1.1.m1.2.2.1.1.1.1.1" xref="S3.SS1.SSS0.Px1.p1.1.m1.2.2.1.1.1.1.1.cmml"><mi id="S3.SS1.SSS0.Px1.p1.1.m1.2.2.1.1.1.1.1.2" xref="S3.SS1.SSS0.Px1.p1.1.m1.2.2.1.1.1.1.1.2.cmml">𝐲</mi><mi id="S3.SS1.SSS0.Px1.p1.1.m1.2.2.1.1.1.1.1.3" xref="S3.SS1.SSS0.Px1.p1.1.m1.2.2.1.1.1.1.1.3.cmml">w</mi></msub><mo id="S3.SS1.SSS0.Px1.p1.1.m1.2.2.1.1.1.2.5" xref="S3.SS1.SSS0.Px1.p1.1.m1.2.2.1.1.1.3.cmml">,</mo><msub id="S3.SS1.SSS0.Px1.p1.1.m1.2.2.1.1.1.2.2" xref="S3.SS1.SSS0.Px1.p1.1.m1.2.2.1.1.1.2.2.cmml"><mi id="S3.SS1.SSS0.Px1.p1.1.m1.2.2.1.1.1.2.2.2" xref="S3.SS1.SSS0.Px1.p1.1.m1.2.2.1.1.1.2.2.2.cmml">𝐲</mi><mi id="S3.SS1.SSS0.Px1.p1.1.m1.2.2.1.1.1.2.2.3" xref="S3.SS1.SSS0.Px1.p1.1.m1.2.2.1.1.1.2.2.3.cmml">l</mi></msub><mo id="S3.SS1.SSS0.Px1.p1.1.m1.2.2.1.1.1.2.6" stretchy="false" xref="S3.SS1.SSS0.Px1.p1.1.m1.2.2.1.1.1.3.cmml">)</mo></mrow><mo id="S3.SS1.SSS0.Px1.p1.1.m1.2.2.1.1.3" stretchy="false" xref="S3.SS1.SSS0.Px1.p1.1.m1.2.2.1.2.cmml">}</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS0.Px1.p1.1.m1.2b"><apply id="S3.SS1.SSS0.Px1.p1.1.m1.2.2.cmml" xref="S3.SS1.SSS0.Px1.p1.1.m1.2.2"><eq id="S3.SS1.SSS0.Px1.p1.1.m1.2.2.2.cmml" xref="S3.SS1.SSS0.Px1.p1.1.m1.2.2.2"></eq><ci id="S3.SS1.SSS0.Px1.p1.1.m1.2.2.3.cmml" xref="S3.SS1.SSS0.Px1.p1.1.m1.2.2.3">𝒟</ci><set id="S3.SS1.SSS0.Px1.p1.1.m1.2.2.1.2.cmml" xref="S3.SS1.SSS0.Px1.p1.1.m1.2.2.1.1"><vector id="S3.SS1.SSS0.Px1.p1.1.m1.2.2.1.1.1.3.cmml" xref="S3.SS1.SSS0.Px1.p1.1.m1.2.2.1.1.1.2"><ci id="S3.SS1.SSS0.Px1.p1.1.m1.1.1.cmml" xref="S3.SS1.SSS0.Px1.p1.1.m1.1.1">𝐱</ci><apply id="S3.SS1.SSS0.Px1.p1.1.m1.2.2.1.1.1.1.1.cmml" xref="S3.SS1.SSS0.Px1.p1.1.m1.2.2.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS1.SSS0.Px1.p1.1.m1.2.2.1.1.1.1.1.1.cmml" xref="S3.SS1.SSS0.Px1.p1.1.m1.2.2.1.1.1.1.1">subscript</csymbol><ci id="S3.SS1.SSS0.Px1.p1.1.m1.2.2.1.1.1.1.1.2.cmml" xref="S3.SS1.SSS0.Px1.p1.1.m1.2.2.1.1.1.1.1.2">𝐲</ci><ci id="S3.SS1.SSS0.Px1.p1.1.m1.2.2.1.1.1.1.1.3.cmml" xref="S3.SS1.SSS0.Px1.p1.1.m1.2.2.1.1.1.1.1.3">𝑤</ci></apply><apply id="S3.SS1.SSS0.Px1.p1.1.m1.2.2.1.1.1.2.2.cmml" xref="S3.SS1.SSS0.Px1.p1.1.m1.2.2.1.1.1.2.2"><csymbol cd="ambiguous" id="S3.SS1.SSS0.Px1.p1.1.m1.2.2.1.1.1.2.2.1.cmml" xref="S3.SS1.SSS0.Px1.p1.1.m1.2.2.1.1.1.2.2">subscript</csymbol><ci id="S3.SS1.SSS0.Px1.p1.1.m1.2.2.1.1.1.2.2.2.cmml" xref="S3.SS1.SSS0.Px1.p1.1.m1.2.2.1.1.1.2.2.2">𝐲</ci><ci id="S3.SS1.SSS0.Px1.p1.1.m1.2.2.1.1.1.2.2.3.cmml" xref="S3.SS1.SSS0.Px1.p1.1.m1.2.2.1.1.1.2.2.3">𝑙</ci></apply></vector></set></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS0.Px1.p1.1.m1.2c">\mathcal{D}=\{({\bf x},\mathbf{y}_{w},\mathbf{y}_{l})\}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.SSS0.Px1.p1.1.m1.2d">caligraphic_D = { ( bold_x , bold_y start_POSTSUBSCRIPT italic_w end_POSTSUBSCRIPT , bold_y start_POSTSUBSCRIPT italic_l end_POSTSUBSCRIPT ) }</annotation></semantics></math> where <math alttext="\mathbf{y}_{w}" class="ltx_Math" display="inline" id="S3.SS1.SSS0.Px1.p1.2.m2.1"><semantics id="S3.SS1.SSS0.Px1.p1.2.m2.1a"><msub id="S3.SS1.SSS0.Px1.p1.2.m2.1.1" xref="S3.SS1.SSS0.Px1.p1.2.m2.1.1.cmml"><mi id="S3.SS1.SSS0.Px1.p1.2.m2.1.1.2" xref="S3.SS1.SSS0.Px1.p1.2.m2.1.1.2.cmml">𝐲</mi><mi id="S3.SS1.SSS0.Px1.p1.2.m2.1.1.3" xref="S3.SS1.SSS0.Px1.p1.2.m2.1.1.3.cmml">w</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS0.Px1.p1.2.m2.1b"><apply id="S3.SS1.SSS0.Px1.p1.2.m2.1.1.cmml" xref="S3.SS1.SSS0.Px1.p1.2.m2.1.1"><csymbol cd="ambiguous" id="S3.SS1.SSS0.Px1.p1.2.m2.1.1.1.cmml" xref="S3.SS1.SSS0.Px1.p1.2.m2.1.1">subscript</csymbol><ci id="S3.SS1.SSS0.Px1.p1.2.m2.1.1.2.cmml" xref="S3.SS1.SSS0.Px1.p1.2.m2.1.1.2">𝐲</ci><ci id="S3.SS1.SSS0.Px1.p1.2.m2.1.1.3.cmml" xref="S3.SS1.SSS0.Px1.p1.2.m2.1.1.3">𝑤</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS0.Px1.p1.2.m2.1c">\mathbf{y}_{w}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.SSS0.Px1.p1.2.m2.1d">bold_y start_POSTSUBSCRIPT italic_w end_POSTSUBSCRIPT</annotation></semantics></math> has better MBR score than <math alttext="\mathbf{y}_{l}" class="ltx_Math" display="inline" id="S3.SS1.SSS0.Px1.p1.3.m3.1"><semantics id="S3.SS1.SSS0.Px1.p1.3.m3.1a"><msub id="S3.SS1.SSS0.Px1.p1.3.m3.1.1" xref="S3.SS1.SSS0.Px1.p1.3.m3.1.1.cmml"><mi id="S3.SS1.SSS0.Px1.p1.3.m3.1.1.2" xref="S3.SS1.SSS0.Px1.p1.3.m3.1.1.2.cmml">𝐲</mi><mi id="S3.SS1.SSS0.Px1.p1.3.m3.1.1.3" xref="S3.SS1.SSS0.Px1.p1.3.m3.1.1.3.cmml">l</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS0.Px1.p1.3.m3.1b"><apply id="S3.SS1.SSS0.Px1.p1.3.m3.1.1.cmml" xref="S3.SS1.SSS0.Px1.p1.3.m3.1.1"><csymbol cd="ambiguous" id="S3.SS1.SSS0.Px1.p1.3.m3.1.1.1.cmml" xref="S3.SS1.SSS0.Px1.p1.3.m3.1.1">subscript</csymbol><ci id="S3.SS1.SSS0.Px1.p1.3.m3.1.1.2.cmml" xref="S3.SS1.SSS0.Px1.p1.3.m3.1.1.2">𝐲</ci><ci id="S3.SS1.SSS0.Px1.p1.3.m3.1.1.3.cmml" xref="S3.SS1.SSS0.Px1.p1.3.m3.1.1.3">𝑙</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS0.Px1.p1.3.m3.1c">\mathbf{y}_{l}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.SSS0.Px1.p1.3.m3.1d">bold_y start_POSTSUBSCRIPT italic_l end_POSTSUBSCRIPT</annotation></semantics></math> and both of the hypotheses are selected from the hypothesis set <math alttext="H(x)" class="ltx_Math" display="inline" id="S3.SS1.SSS0.Px1.p1.4.m4.1"><semantics id="S3.SS1.SSS0.Px1.p1.4.m4.1a"><mrow id="S3.SS1.SSS0.Px1.p1.4.m4.1.2" xref="S3.SS1.SSS0.Px1.p1.4.m4.1.2.cmml"><mi id="S3.SS1.SSS0.Px1.p1.4.m4.1.2.2" xref="S3.SS1.SSS0.Px1.p1.4.m4.1.2.2.cmml">H</mi><mo id="S3.SS1.SSS0.Px1.p1.4.m4.1.2.1" xref="S3.SS1.SSS0.Px1.p1.4.m4.1.2.1.cmml">⁢</mo><mrow id="S3.SS1.SSS0.Px1.p1.4.m4.1.2.3.2" xref="S3.SS1.SSS0.Px1.p1.4.m4.1.2.cmml"><mo id="S3.SS1.SSS0.Px1.p1.4.m4.1.2.3.2.1" stretchy="false" xref="S3.SS1.SSS0.Px1.p1.4.m4.1.2.cmml">(</mo><mi id="S3.SS1.SSS0.Px1.p1.4.m4.1.1" xref="S3.SS1.SSS0.Px1.p1.4.m4.1.1.cmml">x</mi><mo id="S3.SS1.SSS0.Px1.p1.4.m4.1.2.3.2.2" stretchy="false" xref="S3.SS1.SSS0.Px1.p1.4.m4.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS0.Px1.p1.4.m4.1b"><apply id="S3.SS1.SSS0.Px1.p1.4.m4.1.2.cmml" xref="S3.SS1.SSS0.Px1.p1.4.m4.1.2"><times id="S3.SS1.SSS0.Px1.p1.4.m4.1.2.1.cmml" xref="S3.SS1.SSS0.Px1.p1.4.m4.1.2.1"></times><ci id="S3.SS1.SSS0.Px1.p1.4.m4.1.2.2.cmml" xref="S3.SS1.SSS0.Px1.p1.4.m4.1.2.2">𝐻</ci><ci id="S3.SS1.SSS0.Px1.p1.4.m4.1.1.cmml" xref="S3.SS1.SSS0.Px1.p1.4.m4.1.1">𝑥</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS0.Px1.p1.4.m4.1c">H(x)</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.SSS0.Px1.p1.4.m4.1d">italic_H ( italic_x )</annotation></semantics></math>.
There are numerous strategies for selecting the preference pairs <math alttext="(\mathbf{y}_{w},\mathbf{y}_{l})" class="ltx_Math" display="inline" id="S3.SS1.SSS0.Px1.p1.5.m5.2"><semantics id="S3.SS1.SSS0.Px1.p1.5.m5.2a"><mrow id="S3.SS1.SSS0.Px1.p1.5.m5.2.2.2" xref="S3.SS1.SSS0.Px1.p1.5.m5.2.2.3.cmml"><mo id="S3.SS1.SSS0.Px1.p1.5.m5.2.2.2.3" stretchy="false" xref="S3.SS1.SSS0.Px1.p1.5.m5.2.2.3.cmml">(</mo><msub id="S3.SS1.SSS0.Px1.p1.5.m5.1.1.1.1" xref="S3.SS1.SSS0.Px1.p1.5.m5.1.1.1.1.cmml"><mi id="S3.SS1.SSS0.Px1.p1.5.m5.1.1.1.1.2" xref="S3.SS1.SSS0.Px1.p1.5.m5.1.1.1.1.2.cmml">𝐲</mi><mi id="S3.SS1.SSS0.Px1.p1.5.m5.1.1.1.1.3" xref="S3.SS1.SSS0.Px1.p1.5.m5.1.1.1.1.3.cmml">w</mi></msub><mo id="S3.SS1.SSS0.Px1.p1.5.m5.2.2.2.4" xref="S3.SS1.SSS0.Px1.p1.5.m5.2.2.3.cmml">,</mo><msub id="S3.SS1.SSS0.Px1.p1.5.m5.2.2.2.2" xref="S3.SS1.SSS0.Px1.p1.5.m5.2.2.2.2.cmml"><mi id="S3.SS1.SSS0.Px1.p1.5.m5.2.2.2.2.2" xref="S3.SS1.SSS0.Px1.p1.5.m5.2.2.2.2.2.cmml">𝐲</mi><mi id="S3.SS1.SSS0.Px1.p1.5.m5.2.2.2.2.3" xref="S3.SS1.SSS0.Px1.p1.5.m5.2.2.2.2.3.cmml">l</mi></msub><mo id="S3.SS1.SSS0.Px1.p1.5.m5.2.2.2.5" stretchy="false" xref="S3.SS1.SSS0.Px1.p1.5.m5.2.2.3.cmml">)</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.SSS0.Px1.p1.5.m5.2b"><interval closure="open" id="S3.SS1.SSS0.Px1.p1.5.m5.2.2.3.cmml" xref="S3.SS1.SSS0.Px1.p1.5.m5.2.2.2"><apply id="S3.SS1.SSS0.Px1.p1.5.m5.1.1.1.1.cmml" xref="S3.SS1.SSS0.Px1.p1.5.m5.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS1.SSS0.Px1.p1.5.m5.1.1.1.1.1.cmml" xref="S3.SS1.SSS0.Px1.p1.5.m5.1.1.1.1">subscript</csymbol><ci id="S3.SS1.SSS0.Px1.p1.5.m5.1.1.1.1.2.cmml" xref="S3.SS1.SSS0.Px1.p1.5.m5.1.1.1.1.2">𝐲</ci><ci id="S3.SS1.SSS0.Px1.p1.5.m5.1.1.1.1.3.cmml" xref="S3.SS1.SSS0.Px1.p1.5.m5.1.1.1.1.3">𝑤</ci></apply><apply id="S3.SS1.SSS0.Px1.p1.5.m5.2.2.2.2.cmml" xref="S3.SS1.SSS0.Px1.p1.5.m5.2.2.2.2"><csymbol cd="ambiguous" id="S3.SS1.SSS0.Px1.p1.5.m5.2.2.2.2.1.cmml" xref="S3.SS1.SSS0.Px1.p1.5.m5.2.2.2.2">subscript</csymbol><ci id="S3.SS1.SSS0.Px1.p1.5.m5.2.2.2.2.2.cmml" xref="S3.SS1.SSS0.Px1.p1.5.m5.2.2.2.2.2">𝐲</ci><ci id="S3.SS1.SSS0.Px1.p1.5.m5.2.2.2.2.3.cmml" xref="S3.SS1.SSS0.Px1.p1.5.m5.2.2.2.2.3">𝑙</ci></apply></interval></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.SSS0.Px1.p1.5.m5.2c">(\mathbf{y}_{w},\mathbf{y}_{l})</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.SSS0.Px1.p1.5.m5.2d">( bold_y start_POSTSUBSCRIPT italic_w end_POSTSUBSCRIPT , bold_y start_POSTSUBSCRIPT italic_l end_POSTSUBSCRIPT )</annotation></semantics></math> from the hypothesis set. We experimented with four selection schemes:</p>
<ol class="ltx_enumerate" id="S3.I1">
<li class="ltx_item" id="S3.I1.i1" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">1.</span>
<div class="ltx_para" id="S3.I1.i1.p1">
<p class="ltx_p" id="S3.I1.i1.p1.2"><span class="ltx_text ltx_font_bold" id="S3.I1.i1.p1.2.1">BW</span> is a simple strategy that selects the <span class="ltx_text ltx_font_bold" id="S3.I1.i1.p1.2.2">best</span> and <span class="ltx_text ltx_font_bold" id="S3.I1.i1.p1.2.3">worst</span> translation hypotheses from the ranked sets. For each source sentence <math alttext="\mathbf{x}" class="ltx_Math" display="inline" id="S3.I1.i1.p1.1.m1.1"><semantics id="S3.I1.i1.p1.1.m1.1a"><mi id="S3.I1.i1.p1.1.m1.1.1" xref="S3.I1.i1.p1.1.m1.1.1.cmml">𝐱</mi><annotation-xml encoding="MathML-Content" id="S3.I1.i1.p1.1.m1.1b"><ci id="S3.I1.i1.p1.1.m1.1.1.cmml" xref="S3.I1.i1.p1.1.m1.1.1">𝐱</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.I1.i1.p1.1.m1.1c">\mathbf{x}</annotation><annotation encoding="application/x-llamapun" id="S3.I1.i1.p1.1.m1.1d">bold_x</annotation></semantics></math>, we only have one preference triplet <math alttext="(\mathbf{x},\mathbf{y}_{1},\mathbf{y}_{|H(x)|})" class="ltx_Math" display="inline" id="S3.I1.i1.p1.2.m2.5"><semantics id="S3.I1.i1.p1.2.m2.5a"><mrow id="S3.I1.i1.p1.2.m2.5.5.2" xref="S3.I1.i1.p1.2.m2.5.5.3.cmml"><mo id="S3.I1.i1.p1.2.m2.5.5.2.3" stretchy="false" xref="S3.I1.i1.p1.2.m2.5.5.3.cmml">(</mo><mi id="S3.I1.i1.p1.2.m2.3.3" xref="S3.I1.i1.p1.2.m2.3.3.cmml">𝐱</mi><mo id="S3.I1.i1.p1.2.m2.5.5.2.4" xref="S3.I1.i1.p1.2.m2.5.5.3.cmml">,</mo><msub id="S3.I1.i1.p1.2.m2.4.4.1.1" xref="S3.I1.i1.p1.2.m2.4.4.1.1.cmml"><mi id="S3.I1.i1.p1.2.m2.4.4.1.1.2" xref="S3.I1.i1.p1.2.m2.4.4.1.1.2.cmml">𝐲</mi><mn id="S3.I1.i1.p1.2.m2.4.4.1.1.3" xref="S3.I1.i1.p1.2.m2.4.4.1.1.3.cmml">1</mn></msub><mo id="S3.I1.i1.p1.2.m2.5.5.2.5" xref="S3.I1.i1.p1.2.m2.5.5.3.cmml">,</mo><msub id="S3.I1.i1.p1.2.m2.5.5.2.2" xref="S3.I1.i1.p1.2.m2.5.5.2.2.cmml"><mi id="S3.I1.i1.p1.2.m2.5.5.2.2.2" xref="S3.I1.i1.p1.2.m2.5.5.2.2.2.cmml">𝐲</mi><mrow id="S3.I1.i1.p1.2.m2.2.2.2.2" xref="S3.I1.i1.p1.2.m2.2.2.2.3.cmml"><mo id="S3.I1.i1.p1.2.m2.2.2.2.2.2" stretchy="false" xref="S3.I1.i1.p1.2.m2.2.2.2.3.1.cmml">|</mo><mrow id="S3.I1.i1.p1.2.m2.2.2.2.2.1" xref="S3.I1.i1.p1.2.m2.2.2.2.2.1.cmml"><mi id="S3.I1.i1.p1.2.m2.2.2.2.2.1.2" xref="S3.I1.i1.p1.2.m2.2.2.2.2.1.2.cmml">H</mi><mo id="S3.I1.i1.p1.2.m2.2.2.2.2.1.1" xref="S3.I1.i1.p1.2.m2.2.2.2.2.1.1.cmml">⁢</mo><mrow id="S3.I1.i1.p1.2.m2.2.2.2.2.1.3.2" xref="S3.I1.i1.p1.2.m2.2.2.2.2.1.cmml"><mo id="S3.I1.i1.p1.2.m2.2.2.2.2.1.3.2.1" stretchy="false" xref="S3.I1.i1.p1.2.m2.2.2.2.2.1.cmml">(</mo><mi id="S3.I1.i1.p1.2.m2.1.1.1.1" xref="S3.I1.i1.p1.2.m2.1.1.1.1.cmml">x</mi><mo id="S3.I1.i1.p1.2.m2.2.2.2.2.1.3.2.2" stretchy="false" xref="S3.I1.i1.p1.2.m2.2.2.2.2.1.cmml">)</mo></mrow></mrow><mo id="S3.I1.i1.p1.2.m2.2.2.2.2.3" stretchy="false" xref="S3.I1.i1.p1.2.m2.2.2.2.3.1.cmml">|</mo></mrow></msub><mo id="S3.I1.i1.p1.2.m2.5.5.2.6" stretchy="false" xref="S3.I1.i1.p1.2.m2.5.5.3.cmml">)</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.I1.i1.p1.2.m2.5b"><vector id="S3.I1.i1.p1.2.m2.5.5.3.cmml" xref="S3.I1.i1.p1.2.m2.5.5.2"><ci id="S3.I1.i1.p1.2.m2.3.3.cmml" xref="S3.I1.i1.p1.2.m2.3.3">𝐱</ci><apply id="S3.I1.i1.p1.2.m2.4.4.1.1.cmml" xref="S3.I1.i1.p1.2.m2.4.4.1.1"><csymbol cd="ambiguous" id="S3.I1.i1.p1.2.m2.4.4.1.1.1.cmml" xref="S3.I1.i1.p1.2.m2.4.4.1.1">subscript</csymbol><ci id="S3.I1.i1.p1.2.m2.4.4.1.1.2.cmml" xref="S3.I1.i1.p1.2.m2.4.4.1.1.2">𝐲</ci><cn id="S3.I1.i1.p1.2.m2.4.4.1.1.3.cmml" type="integer" xref="S3.I1.i1.p1.2.m2.4.4.1.1.3">1</cn></apply><apply id="S3.I1.i1.p1.2.m2.5.5.2.2.cmml" xref="S3.I1.i1.p1.2.m2.5.5.2.2"><csymbol cd="ambiguous" id="S3.I1.i1.p1.2.m2.5.5.2.2.1.cmml" xref="S3.I1.i1.p1.2.m2.5.5.2.2">subscript</csymbol><ci id="S3.I1.i1.p1.2.m2.5.5.2.2.2.cmml" xref="S3.I1.i1.p1.2.m2.5.5.2.2.2">𝐲</ci><apply id="S3.I1.i1.p1.2.m2.2.2.2.3.cmml" xref="S3.I1.i1.p1.2.m2.2.2.2.2"><abs id="S3.I1.i1.p1.2.m2.2.2.2.3.1.cmml" xref="S3.I1.i1.p1.2.m2.2.2.2.2.2"></abs><apply id="S3.I1.i1.p1.2.m2.2.2.2.2.1.cmml" xref="S3.I1.i1.p1.2.m2.2.2.2.2.1"><times id="S3.I1.i1.p1.2.m2.2.2.2.2.1.1.cmml" xref="S3.I1.i1.p1.2.m2.2.2.2.2.1.1"></times><ci id="S3.I1.i1.p1.2.m2.2.2.2.2.1.2.cmml" xref="S3.I1.i1.p1.2.m2.2.2.2.2.1.2">𝐻</ci><ci id="S3.I1.i1.p1.2.m2.1.1.1.1.cmml" xref="S3.I1.i1.p1.2.m2.1.1.1.1">𝑥</ci></apply></apply></apply></vector></annotation-xml><annotation encoding="application/x-tex" id="S3.I1.i1.p1.2.m2.5c">(\mathbf{x},\mathbf{y}_{1},\mathbf{y}_{|H(x)|})</annotation><annotation encoding="application/x-llamapun" id="S3.I1.i1.p1.2.m2.5d">( bold_x , bold_y start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT , bold_y start_POSTSUBSCRIPT | italic_H ( italic_x ) | end_POSTSUBSCRIPT )</annotation></semantics></math>.</p>
</div>
</li>
<li class="ltx_item" id="S3.I1.i2" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">2.</span>
<div class="ltx_para" id="S3.I1.i2.p1">
<p class="ltx_p" id="S3.I1.i2.p1.4"><span class="ltx_text ltx_font_bold" id="S3.I1.i2.p1.4.1">BMW</span> adds the <span class="ltx_text ltx_font_bold" id="S3.I1.i2.p1.4.2">middle</span> hypothesis <math alttext="\mathbf{y}_{m}" class="ltx_Math" display="inline" id="S3.I1.i2.p1.1.m1.1"><semantics id="S3.I1.i2.p1.1.m1.1a"><msub id="S3.I1.i2.p1.1.m1.1.1" xref="S3.I1.i2.p1.1.m1.1.1.cmml"><mi id="S3.I1.i2.p1.1.m1.1.1.2" xref="S3.I1.i2.p1.1.m1.1.1.2.cmml">𝐲</mi><mi id="S3.I1.i2.p1.1.m1.1.1.3" xref="S3.I1.i2.p1.1.m1.1.1.3.cmml">m</mi></msub><annotation-xml encoding="MathML-Content" id="S3.I1.i2.p1.1.m1.1b"><apply id="S3.I1.i2.p1.1.m1.1.1.cmml" xref="S3.I1.i2.p1.1.m1.1.1"><csymbol cd="ambiguous" id="S3.I1.i2.p1.1.m1.1.1.1.cmml" xref="S3.I1.i2.p1.1.m1.1.1">subscript</csymbol><ci id="S3.I1.i2.p1.1.m1.1.1.2.cmml" xref="S3.I1.i2.p1.1.m1.1.1.2">𝐲</ci><ci id="S3.I1.i2.p1.1.m1.1.1.3.cmml" xref="S3.I1.i2.p1.1.m1.1.1.3">𝑚</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.I1.i2.p1.1.m1.1c">\mathbf{y}_{m}</annotation><annotation encoding="application/x-llamapun" id="S3.I1.i2.p1.1.m1.1d">bold_y start_POSTSUBSCRIPT italic_m end_POSTSUBSCRIPT</annotation></semantics></math> from the ranked lists with index <math alttext="m=\lceil|H(x)|/2\rceil" class="ltx_Math" display="inline" id="S3.I1.i2.p1.2.m2.2"><semantics id="S3.I1.i2.p1.2.m2.2a"><mrow id="S3.I1.i2.p1.2.m2.2.2" xref="S3.I1.i2.p1.2.m2.2.2.cmml"><mi id="S3.I1.i2.p1.2.m2.2.2.3" xref="S3.I1.i2.p1.2.m2.2.2.3.cmml">m</mi><mo id="S3.I1.i2.p1.2.m2.2.2.2" xref="S3.I1.i2.p1.2.m2.2.2.2.cmml">=</mo><mrow id="S3.I1.i2.p1.2.m2.2.2.1.1" xref="S3.I1.i2.p1.2.m2.2.2.1.2.cmml"><mo id="S3.I1.i2.p1.2.m2.2.2.1.1.2" stretchy="false" xref="S3.I1.i2.p1.2.m2.2.2.1.2.1.cmml">⌈</mo><mrow id="S3.I1.i2.p1.2.m2.2.2.1.1.1" xref="S3.I1.i2.p1.2.m2.2.2.1.1.1.cmml"><mrow id="S3.I1.i2.p1.2.m2.2.2.1.1.1.1.1" xref="S3.I1.i2.p1.2.m2.2.2.1.1.1.1.2.cmml"><mo id="S3.I1.i2.p1.2.m2.2.2.1.1.1.1.1.2" stretchy="false" xref="S3.I1.i2.p1.2.m2.2.2.1.1.1.1.2.1.cmml">|</mo><mrow id="S3.I1.i2.p1.2.m2.2.2.1.1.1.1.1.1" xref="S3.I1.i2.p1.2.m2.2.2.1.1.1.1.1.1.cmml"><mi id="S3.I1.i2.p1.2.m2.2.2.1.1.1.1.1.1.2" xref="S3.I1.i2.p1.2.m2.2.2.1.1.1.1.1.1.2.cmml">H</mi><mo id="S3.I1.i2.p1.2.m2.2.2.1.1.1.1.1.1.1" xref="S3.I1.i2.p1.2.m2.2.2.1.1.1.1.1.1.1.cmml">⁢</mo><mrow id="S3.I1.i2.p1.2.m2.2.2.1.1.1.1.1.1.3.2" xref="S3.I1.i2.p1.2.m2.2.2.1.1.1.1.1.1.cmml"><mo id="S3.I1.i2.p1.2.m2.2.2.1.1.1.1.1.1.3.2.1" stretchy="false" xref="S3.I1.i2.p1.2.m2.2.2.1.1.1.1.1.1.cmml">(</mo><mi id="S3.I1.i2.p1.2.m2.1.1" xref="S3.I1.i2.p1.2.m2.1.1.cmml">x</mi><mo id="S3.I1.i2.p1.2.m2.2.2.1.1.1.1.1.1.3.2.2" stretchy="false" xref="S3.I1.i2.p1.2.m2.2.2.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S3.I1.i2.p1.2.m2.2.2.1.1.1.1.1.3" stretchy="false" xref="S3.I1.i2.p1.2.m2.2.2.1.1.1.1.2.1.cmml">|</mo></mrow><mo id="S3.I1.i2.p1.2.m2.2.2.1.1.1.2" xref="S3.I1.i2.p1.2.m2.2.2.1.1.1.2.cmml">/</mo><mn id="S3.I1.i2.p1.2.m2.2.2.1.1.1.3" xref="S3.I1.i2.p1.2.m2.2.2.1.1.1.3.cmml">2</mn></mrow><mo id="S3.I1.i2.p1.2.m2.2.2.1.1.3" stretchy="false" xref="S3.I1.i2.p1.2.m2.2.2.1.2.1.cmml">⌉</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.I1.i2.p1.2.m2.2b"><apply id="S3.I1.i2.p1.2.m2.2.2.cmml" xref="S3.I1.i2.p1.2.m2.2.2"><eq id="S3.I1.i2.p1.2.m2.2.2.2.cmml" xref="S3.I1.i2.p1.2.m2.2.2.2"></eq><ci id="S3.I1.i2.p1.2.m2.2.2.3.cmml" xref="S3.I1.i2.p1.2.m2.2.2.3">𝑚</ci><apply id="S3.I1.i2.p1.2.m2.2.2.1.2.cmml" xref="S3.I1.i2.p1.2.m2.2.2.1.1"><ceiling id="S3.I1.i2.p1.2.m2.2.2.1.2.1.cmml" xref="S3.I1.i2.p1.2.m2.2.2.1.1.2"></ceiling><apply id="S3.I1.i2.p1.2.m2.2.2.1.1.1.cmml" xref="S3.I1.i2.p1.2.m2.2.2.1.1.1"><divide id="S3.I1.i2.p1.2.m2.2.2.1.1.1.2.cmml" xref="S3.I1.i2.p1.2.m2.2.2.1.1.1.2"></divide><apply id="S3.I1.i2.p1.2.m2.2.2.1.1.1.1.2.cmml" xref="S3.I1.i2.p1.2.m2.2.2.1.1.1.1.1"><abs id="S3.I1.i2.p1.2.m2.2.2.1.1.1.1.2.1.cmml" xref="S3.I1.i2.p1.2.m2.2.2.1.1.1.1.1.2"></abs><apply id="S3.I1.i2.p1.2.m2.2.2.1.1.1.1.1.1.cmml" xref="S3.I1.i2.p1.2.m2.2.2.1.1.1.1.1.1"><times id="S3.I1.i2.p1.2.m2.2.2.1.1.1.1.1.1.1.cmml" xref="S3.I1.i2.p1.2.m2.2.2.1.1.1.1.1.1.1"></times><ci id="S3.I1.i2.p1.2.m2.2.2.1.1.1.1.1.1.2.cmml" xref="S3.I1.i2.p1.2.m2.2.2.1.1.1.1.1.1.2">𝐻</ci><ci id="S3.I1.i2.p1.2.m2.1.1.cmml" xref="S3.I1.i2.p1.2.m2.1.1">𝑥</ci></apply></apply><cn id="S3.I1.i2.p1.2.m2.2.2.1.1.1.3.cmml" type="integer" xref="S3.I1.i2.p1.2.m2.2.2.1.1.1.3">2</cn></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.I1.i2.p1.2.m2.2c">m=\lceil|H(x)|/2\rceil</annotation><annotation encoding="application/x-llamapun" id="S3.I1.i2.p1.2.m2.2d">italic_m = ⌈ | italic_H ( italic_x ) | / 2 ⌉</annotation></semantics></math>.
This gives two triplets per source sentence: <math alttext="(\mathbf{x},\mathbf{y}_{1},\mathbf{y}_{m})" class="ltx_Math" display="inline" id="S3.I1.i2.p1.3.m3.3"><semantics id="S3.I1.i2.p1.3.m3.3a"><mrow id="S3.I1.i2.p1.3.m3.3.3.2" xref="S3.I1.i2.p1.3.m3.3.3.3.cmml"><mo id="S3.I1.i2.p1.3.m3.3.3.2.3" stretchy="false" xref="S3.I1.i2.p1.3.m3.3.3.3.cmml">(</mo><mi id="S3.I1.i2.p1.3.m3.1.1" xref="S3.I1.i2.p1.3.m3.1.1.cmml">𝐱</mi><mo id="S3.I1.i2.p1.3.m3.3.3.2.4" xref="S3.I1.i2.p1.3.m3.3.3.3.cmml">,</mo><msub id="S3.I1.i2.p1.3.m3.2.2.1.1" xref="S3.I1.i2.p1.3.m3.2.2.1.1.cmml"><mi id="S3.I1.i2.p1.3.m3.2.2.1.1.2" xref="S3.I1.i2.p1.3.m3.2.2.1.1.2.cmml">𝐲</mi><mn id="S3.I1.i2.p1.3.m3.2.2.1.1.3" xref="S3.I1.i2.p1.3.m3.2.2.1.1.3.cmml">1</mn></msub><mo id="S3.I1.i2.p1.3.m3.3.3.2.5" xref="S3.I1.i2.p1.3.m3.3.3.3.cmml">,</mo><msub id="S3.I1.i2.p1.3.m3.3.3.2.2" xref="S3.I1.i2.p1.3.m3.3.3.2.2.cmml"><mi id="S3.I1.i2.p1.3.m3.3.3.2.2.2" xref="S3.I1.i2.p1.3.m3.3.3.2.2.2.cmml">𝐲</mi><mi id="S3.I1.i2.p1.3.m3.3.3.2.2.3" xref="S3.I1.i2.p1.3.m3.3.3.2.2.3.cmml">m</mi></msub><mo id="S3.I1.i2.p1.3.m3.3.3.2.6" stretchy="false" xref="S3.I1.i2.p1.3.m3.3.3.3.cmml">)</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.I1.i2.p1.3.m3.3b"><vector id="S3.I1.i2.p1.3.m3.3.3.3.cmml" xref="S3.I1.i2.p1.3.m3.3.3.2"><ci id="S3.I1.i2.p1.3.m3.1.1.cmml" xref="S3.I1.i2.p1.3.m3.1.1">𝐱</ci><apply id="S3.I1.i2.p1.3.m3.2.2.1.1.cmml" xref="S3.I1.i2.p1.3.m3.2.2.1.1"><csymbol cd="ambiguous" id="S3.I1.i2.p1.3.m3.2.2.1.1.1.cmml" xref="S3.I1.i2.p1.3.m3.2.2.1.1">subscript</csymbol><ci id="S3.I1.i2.p1.3.m3.2.2.1.1.2.cmml" xref="S3.I1.i2.p1.3.m3.2.2.1.1.2">𝐲</ci><cn id="S3.I1.i2.p1.3.m3.2.2.1.1.3.cmml" type="integer" xref="S3.I1.i2.p1.3.m3.2.2.1.1.3">1</cn></apply><apply id="S3.I1.i2.p1.3.m3.3.3.2.2.cmml" xref="S3.I1.i2.p1.3.m3.3.3.2.2"><csymbol cd="ambiguous" id="S3.I1.i2.p1.3.m3.3.3.2.2.1.cmml" xref="S3.I1.i2.p1.3.m3.3.3.2.2">subscript</csymbol><ci id="S3.I1.i2.p1.3.m3.3.3.2.2.2.cmml" xref="S3.I1.i2.p1.3.m3.3.3.2.2.2">𝐲</ci><ci id="S3.I1.i2.p1.3.m3.3.3.2.2.3.cmml" xref="S3.I1.i2.p1.3.m3.3.3.2.2.3">𝑚</ci></apply></vector></annotation-xml><annotation encoding="application/x-tex" id="S3.I1.i2.p1.3.m3.3c">(\mathbf{x},\mathbf{y}_{1},\mathbf{y}_{m})</annotation><annotation encoding="application/x-llamapun" id="S3.I1.i2.p1.3.m3.3d">( bold_x , bold_y start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT , bold_y start_POSTSUBSCRIPT italic_m end_POSTSUBSCRIPT )</annotation></semantics></math> and <math alttext="(\mathbf{x},\mathbf{y}_{m},\mathbf{y}_{|H(x)|})" class="ltx_Math" display="inline" id="S3.I1.i2.p1.4.m4.5"><semantics id="S3.I1.i2.p1.4.m4.5a"><mrow id="S3.I1.i2.p1.4.m4.5.5.2" xref="S3.I1.i2.p1.4.m4.5.5.3.cmml"><mo id="S3.I1.i2.p1.4.m4.5.5.2.3" stretchy="false" xref="S3.I1.i2.p1.4.m4.5.5.3.cmml">(</mo><mi id="S3.I1.i2.p1.4.m4.3.3" xref="S3.I1.i2.p1.4.m4.3.3.cmml">𝐱</mi><mo id="S3.I1.i2.p1.4.m4.5.5.2.4" xref="S3.I1.i2.p1.4.m4.5.5.3.cmml">,</mo><msub id="S3.I1.i2.p1.4.m4.4.4.1.1" xref="S3.I1.i2.p1.4.m4.4.4.1.1.cmml"><mi id="S3.I1.i2.p1.4.m4.4.4.1.1.2" xref="S3.I1.i2.p1.4.m4.4.4.1.1.2.cmml">𝐲</mi><mi id="S3.I1.i2.p1.4.m4.4.4.1.1.3" xref="S3.I1.i2.p1.4.m4.4.4.1.1.3.cmml">m</mi></msub><mo id="S3.I1.i2.p1.4.m4.5.5.2.5" xref="S3.I1.i2.p1.4.m4.5.5.3.cmml">,</mo><msub id="S3.I1.i2.p1.4.m4.5.5.2.2" xref="S3.I1.i2.p1.4.m4.5.5.2.2.cmml"><mi id="S3.I1.i2.p1.4.m4.5.5.2.2.2" xref="S3.I1.i2.p1.4.m4.5.5.2.2.2.cmml">𝐲</mi><mrow id="S3.I1.i2.p1.4.m4.2.2.2.2" xref="S3.I1.i2.p1.4.m4.2.2.2.3.cmml"><mo id="S3.I1.i2.p1.4.m4.2.2.2.2.2" stretchy="false" xref="S3.I1.i2.p1.4.m4.2.2.2.3.1.cmml">|</mo><mrow id="S3.I1.i2.p1.4.m4.2.2.2.2.1" xref="S3.I1.i2.p1.4.m4.2.2.2.2.1.cmml"><mi id="S3.I1.i2.p1.4.m4.2.2.2.2.1.2" xref="S3.I1.i2.p1.4.m4.2.2.2.2.1.2.cmml">H</mi><mo id="S3.I1.i2.p1.4.m4.2.2.2.2.1.1" xref="S3.I1.i2.p1.4.m4.2.2.2.2.1.1.cmml">⁢</mo><mrow id="S3.I1.i2.p1.4.m4.2.2.2.2.1.3.2" xref="S3.I1.i2.p1.4.m4.2.2.2.2.1.cmml"><mo id="S3.I1.i2.p1.4.m4.2.2.2.2.1.3.2.1" stretchy="false" xref="S3.I1.i2.p1.4.m4.2.2.2.2.1.cmml">(</mo><mi id="S3.I1.i2.p1.4.m4.1.1.1.1" xref="S3.I1.i2.p1.4.m4.1.1.1.1.cmml">x</mi><mo id="S3.I1.i2.p1.4.m4.2.2.2.2.1.3.2.2" stretchy="false" xref="S3.I1.i2.p1.4.m4.2.2.2.2.1.cmml">)</mo></mrow></mrow><mo id="S3.I1.i2.p1.4.m4.2.2.2.2.3" stretchy="false" xref="S3.I1.i2.p1.4.m4.2.2.2.3.1.cmml">|</mo></mrow></msub><mo id="S3.I1.i2.p1.4.m4.5.5.2.6" stretchy="false" xref="S3.I1.i2.p1.4.m4.5.5.3.cmml">)</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.I1.i2.p1.4.m4.5b"><vector id="S3.I1.i2.p1.4.m4.5.5.3.cmml" xref="S3.I1.i2.p1.4.m4.5.5.2"><ci id="S3.I1.i2.p1.4.m4.3.3.cmml" xref="S3.I1.i2.p1.4.m4.3.3">𝐱</ci><apply id="S3.I1.i2.p1.4.m4.4.4.1.1.cmml" xref="S3.I1.i2.p1.4.m4.4.4.1.1"><csymbol cd="ambiguous" id="S3.I1.i2.p1.4.m4.4.4.1.1.1.cmml" xref="S3.I1.i2.p1.4.m4.4.4.1.1">subscript</csymbol><ci id="S3.I1.i2.p1.4.m4.4.4.1.1.2.cmml" xref="S3.I1.i2.p1.4.m4.4.4.1.1.2">𝐲</ci><ci id="S3.I1.i2.p1.4.m4.4.4.1.1.3.cmml" xref="S3.I1.i2.p1.4.m4.4.4.1.1.3">𝑚</ci></apply><apply id="S3.I1.i2.p1.4.m4.5.5.2.2.cmml" xref="S3.I1.i2.p1.4.m4.5.5.2.2"><csymbol cd="ambiguous" id="S3.I1.i2.p1.4.m4.5.5.2.2.1.cmml" xref="S3.I1.i2.p1.4.m4.5.5.2.2">subscript</csymbol><ci id="S3.I1.i2.p1.4.m4.5.5.2.2.2.cmml" xref="S3.I1.i2.p1.4.m4.5.5.2.2.2">𝐲</ci><apply id="S3.I1.i2.p1.4.m4.2.2.2.3.cmml" xref="S3.I1.i2.p1.4.m4.2.2.2.2"><abs id="S3.I1.i2.p1.4.m4.2.2.2.3.1.cmml" xref="S3.I1.i2.p1.4.m4.2.2.2.2.2"></abs><apply id="S3.I1.i2.p1.4.m4.2.2.2.2.1.cmml" xref="S3.I1.i2.p1.4.m4.2.2.2.2.1"><times id="S3.I1.i2.p1.4.m4.2.2.2.2.1.1.cmml" xref="S3.I1.i2.p1.4.m4.2.2.2.2.1.1"></times><ci id="S3.I1.i2.p1.4.m4.2.2.2.2.1.2.cmml" xref="S3.I1.i2.p1.4.m4.2.2.2.2.1.2">𝐻</ci><ci id="S3.I1.i2.p1.4.m4.1.1.1.1.cmml" xref="S3.I1.i2.p1.4.m4.1.1.1.1">𝑥</ci></apply></apply></apply></vector></annotation-xml><annotation encoding="application/x-tex" id="S3.I1.i2.p1.4.m4.5c">(\mathbf{x},\mathbf{y}_{m},\mathbf{y}_{|H(x)|})</annotation><annotation encoding="application/x-llamapun" id="S3.I1.i2.p1.4.m4.5d">( bold_x , bold_y start_POSTSUBSCRIPT italic_m end_POSTSUBSCRIPT , bold_y start_POSTSUBSCRIPT | italic_H ( italic_x ) | end_POSTSUBSCRIPT )</annotation></semantics></math>.</p>
</div>
</li>
<li class="ltx_item" id="S3.I1.i3" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">3.</span>
<div class="ltx_para" id="S3.I1.i3.p1">
<p class="ltx_p" id="S3.I1.i3.p1.4"><span class="ltx_text ltx_font_bold" id="S3.I1.i3.p1.4.1">CP</span> selects <span class="ltx_text ltx_font_bold" id="S3.I1.i3.p1.4.2">consecutive pairs</span> from the ranked list, yielding <math alttext="|H(x)|-1" class="ltx_Math" display="inline" id="S3.I1.i3.p1.1.m1.2"><semantics id="S3.I1.i3.p1.1.m1.2a"><mrow id="S3.I1.i3.p1.1.m1.2.2" xref="S3.I1.i3.p1.1.m1.2.2.cmml"><mrow id="S3.I1.i3.p1.1.m1.2.2.1.1" xref="S3.I1.i3.p1.1.m1.2.2.1.2.cmml"><mo id="S3.I1.i3.p1.1.m1.2.2.1.1.2" stretchy="false" xref="S3.I1.i3.p1.1.m1.2.2.1.2.1.cmml">|</mo><mrow id="S3.I1.i3.p1.1.m1.2.2.1.1.1" xref="S3.I1.i3.p1.1.m1.2.2.1.1.1.cmml"><mi id="S3.I1.i3.p1.1.m1.2.2.1.1.1.2" xref="S3.I1.i3.p1.1.m1.2.2.1.1.1.2.cmml">H</mi><mo id="S3.I1.i3.p1.1.m1.2.2.1.1.1.1" xref="S3.I1.i3.p1.1.m1.2.2.1.1.1.1.cmml">⁢</mo><mrow id="S3.I1.i3.p1.1.m1.2.2.1.1.1.3.2" xref="S3.I1.i3.p1.1.m1.2.2.1.1.1.cmml"><mo id="S3.I1.i3.p1.1.m1.2.2.1.1.1.3.2.1" stretchy="false" xref="S3.I1.i3.p1.1.m1.2.2.1.1.1.cmml">(</mo><mi id="S3.I1.i3.p1.1.m1.1.1" xref="S3.I1.i3.p1.1.m1.1.1.cmml">x</mi><mo id="S3.I1.i3.p1.1.m1.2.2.1.1.1.3.2.2" stretchy="false" xref="S3.I1.i3.p1.1.m1.2.2.1.1.1.cmml">)</mo></mrow></mrow><mo id="S3.I1.i3.p1.1.m1.2.2.1.1.3" stretchy="false" xref="S3.I1.i3.p1.1.m1.2.2.1.2.1.cmml">|</mo></mrow><mo id="S3.I1.i3.p1.1.m1.2.2.2" xref="S3.I1.i3.p1.1.m1.2.2.2.cmml">−</mo><mn id="S3.I1.i3.p1.1.m1.2.2.3" xref="S3.I1.i3.p1.1.m1.2.2.3.cmml">1</mn></mrow><annotation-xml encoding="MathML-Content" id="S3.I1.i3.p1.1.m1.2b"><apply id="S3.I1.i3.p1.1.m1.2.2.cmml" xref="S3.I1.i3.p1.1.m1.2.2"><minus id="S3.I1.i3.p1.1.m1.2.2.2.cmml" xref="S3.I1.i3.p1.1.m1.2.2.2"></minus><apply id="S3.I1.i3.p1.1.m1.2.2.1.2.cmml" xref="S3.I1.i3.p1.1.m1.2.2.1.1"><abs id="S3.I1.i3.p1.1.m1.2.2.1.2.1.cmml" xref="S3.I1.i3.p1.1.m1.2.2.1.1.2"></abs><apply id="S3.I1.i3.p1.1.m1.2.2.1.1.1.cmml" xref="S3.I1.i3.p1.1.m1.2.2.1.1.1"><times id="S3.I1.i3.p1.1.m1.2.2.1.1.1.1.cmml" xref="S3.I1.i3.p1.1.m1.2.2.1.1.1.1"></times><ci id="S3.I1.i3.p1.1.m1.2.2.1.1.1.2.cmml" xref="S3.I1.i3.p1.1.m1.2.2.1.1.1.2">𝐻</ci><ci id="S3.I1.i3.p1.1.m1.1.1.cmml" xref="S3.I1.i3.p1.1.m1.1.1">𝑥</ci></apply></apply><cn id="S3.I1.i3.p1.1.m1.2.2.3.cmml" type="integer" xref="S3.I1.i3.p1.1.m1.2.2.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.I1.i3.p1.1.m1.2c">|H(x)|-1</annotation><annotation encoding="application/x-llamapun" id="S3.I1.i3.p1.1.m1.2d">| italic_H ( italic_x ) | - 1</annotation></semantics></math> triplets per source sentence, as <math alttext="(\mathbf{x},\mathbf{y}_{1},\mathbf{y}_{2})" class="ltx_Math" display="inline" id="S3.I1.i3.p1.2.m2.3"><semantics id="S3.I1.i3.p1.2.m2.3a"><mrow id="S3.I1.i3.p1.2.m2.3.3.2" xref="S3.I1.i3.p1.2.m2.3.3.3.cmml"><mo id="S3.I1.i3.p1.2.m2.3.3.2.3" stretchy="false" xref="S3.I1.i3.p1.2.m2.3.3.3.cmml">(</mo><mi id="S3.I1.i3.p1.2.m2.1.1" xref="S3.I1.i3.p1.2.m2.1.1.cmml">𝐱</mi><mo id="S3.I1.i3.p1.2.m2.3.3.2.4" xref="S3.I1.i3.p1.2.m2.3.3.3.cmml">,</mo><msub id="S3.I1.i3.p1.2.m2.2.2.1.1" xref="S3.I1.i3.p1.2.m2.2.2.1.1.cmml"><mi id="S3.I1.i3.p1.2.m2.2.2.1.1.2" xref="S3.I1.i3.p1.2.m2.2.2.1.1.2.cmml">𝐲</mi><mn id="S3.I1.i3.p1.2.m2.2.2.1.1.3" xref="S3.I1.i3.p1.2.m2.2.2.1.1.3.cmml">1</mn></msub><mo id="S3.I1.i3.p1.2.m2.3.3.2.5" xref="S3.I1.i3.p1.2.m2.3.3.3.cmml">,</mo><msub id="S3.I1.i3.p1.2.m2.3.3.2.2" xref="S3.I1.i3.p1.2.m2.3.3.2.2.cmml"><mi id="S3.I1.i3.p1.2.m2.3.3.2.2.2" xref="S3.I1.i3.p1.2.m2.3.3.2.2.2.cmml">𝐲</mi><mn id="S3.I1.i3.p1.2.m2.3.3.2.2.3" xref="S3.I1.i3.p1.2.m2.3.3.2.2.3.cmml">2</mn></msub><mo id="S3.I1.i3.p1.2.m2.3.3.2.6" stretchy="false" xref="S3.I1.i3.p1.2.m2.3.3.3.cmml">)</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.I1.i3.p1.2.m2.3b"><vector id="S3.I1.i3.p1.2.m2.3.3.3.cmml" xref="S3.I1.i3.p1.2.m2.3.3.2"><ci id="S3.I1.i3.p1.2.m2.1.1.cmml" xref="S3.I1.i3.p1.2.m2.1.1">𝐱</ci><apply id="S3.I1.i3.p1.2.m2.2.2.1.1.cmml" xref="S3.I1.i3.p1.2.m2.2.2.1.1"><csymbol cd="ambiguous" id="S3.I1.i3.p1.2.m2.2.2.1.1.1.cmml" xref="S3.I1.i3.p1.2.m2.2.2.1.1">subscript</csymbol><ci id="S3.I1.i3.p1.2.m2.2.2.1.1.2.cmml" xref="S3.I1.i3.p1.2.m2.2.2.1.1.2">𝐲</ci><cn id="S3.I1.i3.p1.2.m2.2.2.1.1.3.cmml" type="integer" xref="S3.I1.i3.p1.2.m2.2.2.1.1.3">1</cn></apply><apply id="S3.I1.i3.p1.2.m2.3.3.2.2.cmml" xref="S3.I1.i3.p1.2.m2.3.3.2.2"><csymbol cd="ambiguous" id="S3.I1.i3.p1.2.m2.3.3.2.2.1.cmml" xref="S3.I1.i3.p1.2.m2.3.3.2.2">subscript</csymbol><ci id="S3.I1.i3.p1.2.m2.3.3.2.2.2.cmml" xref="S3.I1.i3.p1.2.m2.3.3.2.2.2">𝐲</ci><cn id="S3.I1.i3.p1.2.m2.3.3.2.2.3.cmml" type="integer" xref="S3.I1.i3.p1.2.m2.3.3.2.2.3">2</cn></apply></vector></annotation-xml><annotation encoding="application/x-tex" id="S3.I1.i3.p1.2.m2.3c">(\mathbf{x},\mathbf{y}_{1},\mathbf{y}_{2})</annotation><annotation encoding="application/x-llamapun" id="S3.I1.i3.p1.2.m2.3d">( bold_x , bold_y start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT , bold_y start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT )</annotation></semantics></math>, <math alttext="(\mathbf{x},\mathbf{y}_{2},\mathbf{y}_{3})" class="ltx_Math" display="inline" id="S3.I1.i3.p1.3.m3.3"><semantics id="S3.I1.i3.p1.3.m3.3a"><mrow id="S3.I1.i3.p1.3.m3.3.3.2" xref="S3.I1.i3.p1.3.m3.3.3.3.cmml"><mo id="S3.I1.i3.p1.3.m3.3.3.2.3" stretchy="false" xref="S3.I1.i3.p1.3.m3.3.3.3.cmml">(</mo><mi id="S3.I1.i3.p1.3.m3.1.1" xref="S3.I1.i3.p1.3.m3.1.1.cmml">𝐱</mi><mo id="S3.I1.i3.p1.3.m3.3.3.2.4" xref="S3.I1.i3.p1.3.m3.3.3.3.cmml">,</mo><msub id="S3.I1.i3.p1.3.m3.2.2.1.1" xref="S3.I1.i3.p1.3.m3.2.2.1.1.cmml"><mi id="S3.I1.i3.p1.3.m3.2.2.1.1.2" xref="S3.I1.i3.p1.3.m3.2.2.1.1.2.cmml">𝐲</mi><mn id="S3.I1.i3.p1.3.m3.2.2.1.1.3" xref="S3.I1.i3.p1.3.m3.2.2.1.1.3.cmml">2</mn></msub><mo id="S3.I1.i3.p1.3.m3.3.3.2.5" xref="S3.I1.i3.p1.3.m3.3.3.3.cmml">,</mo><msub id="S3.I1.i3.p1.3.m3.3.3.2.2" xref="S3.I1.i3.p1.3.m3.3.3.2.2.cmml"><mi id="S3.I1.i3.p1.3.m3.3.3.2.2.2" xref="S3.I1.i3.p1.3.m3.3.3.2.2.2.cmml">𝐲</mi><mn id="S3.I1.i3.p1.3.m3.3.3.2.2.3" xref="S3.I1.i3.p1.3.m3.3.3.2.2.3.cmml">3</mn></msub><mo id="S3.I1.i3.p1.3.m3.3.3.2.6" stretchy="false" xref="S3.I1.i3.p1.3.m3.3.3.3.cmml">)</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.I1.i3.p1.3.m3.3b"><vector id="S3.I1.i3.p1.3.m3.3.3.3.cmml" xref="S3.I1.i3.p1.3.m3.3.3.2"><ci id="S3.I1.i3.p1.3.m3.1.1.cmml" xref="S3.I1.i3.p1.3.m3.1.1">𝐱</ci><apply id="S3.I1.i3.p1.3.m3.2.2.1.1.cmml" xref="S3.I1.i3.p1.3.m3.2.2.1.1"><csymbol cd="ambiguous" id="S3.I1.i3.p1.3.m3.2.2.1.1.1.cmml" xref="S3.I1.i3.p1.3.m3.2.2.1.1">subscript</csymbol><ci id="S3.I1.i3.p1.3.m3.2.2.1.1.2.cmml" xref="S3.I1.i3.p1.3.m3.2.2.1.1.2">𝐲</ci><cn id="S3.I1.i3.p1.3.m3.2.2.1.1.3.cmml" type="integer" xref="S3.I1.i3.p1.3.m3.2.2.1.1.3">2</cn></apply><apply id="S3.I1.i3.p1.3.m3.3.3.2.2.cmml" xref="S3.I1.i3.p1.3.m3.3.3.2.2"><csymbol cd="ambiguous" id="S3.I1.i3.p1.3.m3.3.3.2.2.1.cmml" xref="S3.I1.i3.p1.3.m3.3.3.2.2">subscript</csymbol><ci id="S3.I1.i3.p1.3.m3.3.3.2.2.2.cmml" xref="S3.I1.i3.p1.3.m3.3.3.2.2.2">𝐲</ci><cn id="S3.I1.i3.p1.3.m3.3.3.2.2.3.cmml" type="integer" xref="S3.I1.i3.p1.3.m3.3.3.2.2.3">3</cn></apply></vector></annotation-xml><annotation encoding="application/x-tex" id="S3.I1.i3.p1.3.m3.3c">(\mathbf{x},\mathbf{y}_{2},\mathbf{y}_{3})</annotation><annotation encoding="application/x-llamapun" id="S3.I1.i3.p1.3.m3.3d">( bold_x , bold_y start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT , bold_y start_POSTSUBSCRIPT 3 end_POSTSUBSCRIPT )</annotation></semantics></math>, <math alttext="\ldots" class="ltx_Math" display="inline" id="S3.I1.i3.p1.4.m4.1"><semantics id="S3.I1.i3.p1.4.m4.1a"><mi id="S3.I1.i3.p1.4.m4.1.1" mathvariant="normal" xref="S3.I1.i3.p1.4.m4.1.1.cmml">…</mi><annotation-xml encoding="MathML-Content" id="S3.I1.i3.p1.4.m4.1b"><ci id="S3.I1.i3.p1.4.m4.1.1.cmml" xref="S3.I1.i3.p1.4.m4.1.1">…</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.I1.i3.p1.4.m4.1c">\ldots</annotation><annotation encoding="application/x-llamapun" id="S3.I1.i3.p1.4.m4.1d">…</annotation></semantics></math></p>
</div>
</li>
<li class="ltx_item" id="S3.I1.i4" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">4.</span>
<div class="ltx_para" id="S3.I1.i4.p1">
<p class="ltx_p" id="S3.I1.i4.p1.3"><span class="ltx_text ltx_font_bold" id="S3.I1.i4.p1.3.1">CPS</span> introduces a <span class="ltx_text ltx_font_bold" id="S3.I1.i4.p1.3.2">stride</span> into the CP selection strategy so as to avoid requiring DPO to learn distinctions between translations that are similarly ranked. For example, with a stride of 2 we select triplets <math alttext="(\mathbf{x},\mathbf{y}_{1},\mathbf{y}_{3})" class="ltx_Math" display="inline" id="S3.I1.i4.p1.1.m1.3"><semantics id="S3.I1.i4.p1.1.m1.3a"><mrow id="S3.I1.i4.p1.1.m1.3.3.2" xref="S3.I1.i4.p1.1.m1.3.3.3.cmml"><mo id="S3.I1.i4.p1.1.m1.3.3.2.3" stretchy="false" xref="S3.I1.i4.p1.1.m1.3.3.3.cmml">(</mo><mi id="S3.I1.i4.p1.1.m1.1.1" xref="S3.I1.i4.p1.1.m1.1.1.cmml">𝐱</mi><mo id="S3.I1.i4.p1.1.m1.3.3.2.4" xref="S3.I1.i4.p1.1.m1.3.3.3.cmml">,</mo><msub id="S3.I1.i4.p1.1.m1.2.2.1.1" xref="S3.I1.i4.p1.1.m1.2.2.1.1.cmml"><mi id="S3.I1.i4.p1.1.m1.2.2.1.1.2" xref="S3.I1.i4.p1.1.m1.2.2.1.1.2.cmml">𝐲</mi><mn id="S3.I1.i4.p1.1.m1.2.2.1.1.3" xref="S3.I1.i4.p1.1.m1.2.2.1.1.3.cmml">1</mn></msub><mo id="S3.I1.i4.p1.1.m1.3.3.2.5" xref="S3.I1.i4.p1.1.m1.3.3.3.cmml">,</mo><msub id="S3.I1.i4.p1.1.m1.3.3.2.2" xref="S3.I1.i4.p1.1.m1.3.3.2.2.cmml"><mi id="S3.I1.i4.p1.1.m1.3.3.2.2.2" xref="S3.I1.i4.p1.1.m1.3.3.2.2.2.cmml">𝐲</mi><mn id="S3.I1.i4.p1.1.m1.3.3.2.2.3" xref="S3.I1.i4.p1.1.m1.3.3.2.2.3.cmml">3</mn></msub><mo id="S3.I1.i4.p1.1.m1.3.3.2.6" stretchy="false" xref="S3.I1.i4.p1.1.m1.3.3.3.cmml">)</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.I1.i4.p1.1.m1.3b"><vector id="S3.I1.i4.p1.1.m1.3.3.3.cmml" xref="S3.I1.i4.p1.1.m1.3.3.2"><ci id="S3.I1.i4.p1.1.m1.1.1.cmml" xref="S3.I1.i4.p1.1.m1.1.1">𝐱</ci><apply id="S3.I1.i4.p1.1.m1.2.2.1.1.cmml" xref="S3.I1.i4.p1.1.m1.2.2.1.1"><csymbol cd="ambiguous" id="S3.I1.i4.p1.1.m1.2.2.1.1.1.cmml" xref="S3.I1.i4.p1.1.m1.2.2.1.1">subscript</csymbol><ci id="S3.I1.i4.p1.1.m1.2.2.1.1.2.cmml" xref="S3.I1.i4.p1.1.m1.2.2.1.1.2">𝐲</ci><cn id="S3.I1.i4.p1.1.m1.2.2.1.1.3.cmml" type="integer" xref="S3.I1.i4.p1.1.m1.2.2.1.1.3">1</cn></apply><apply id="S3.I1.i4.p1.1.m1.3.3.2.2.cmml" xref="S3.I1.i4.p1.1.m1.3.3.2.2"><csymbol cd="ambiguous" id="S3.I1.i4.p1.1.m1.3.3.2.2.1.cmml" xref="S3.I1.i4.p1.1.m1.3.3.2.2">subscript</csymbol><ci id="S3.I1.i4.p1.1.m1.3.3.2.2.2.cmml" xref="S3.I1.i4.p1.1.m1.3.3.2.2.2">𝐲</ci><cn id="S3.I1.i4.p1.1.m1.3.3.2.2.3.cmml" type="integer" xref="S3.I1.i4.p1.1.m1.3.3.2.2.3">3</cn></apply></vector></annotation-xml><annotation encoding="application/x-tex" id="S3.I1.i4.p1.1.m1.3c">(\mathbf{x},\mathbf{y}_{1},\mathbf{y}_{3})</annotation><annotation encoding="application/x-llamapun" id="S3.I1.i4.p1.1.m1.3d">( bold_x , bold_y start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT , bold_y start_POSTSUBSCRIPT 3 end_POSTSUBSCRIPT )</annotation></semantics></math>, <math alttext="(\mathbf{x},\mathbf{y}_{3},\mathbf{y}_{5})" class="ltx_Math" display="inline" id="S3.I1.i4.p1.2.m2.3"><semantics id="S3.I1.i4.p1.2.m2.3a"><mrow id="S3.I1.i4.p1.2.m2.3.3.2" xref="S3.I1.i4.p1.2.m2.3.3.3.cmml"><mo id="S3.I1.i4.p1.2.m2.3.3.2.3" stretchy="false" xref="S3.I1.i4.p1.2.m2.3.3.3.cmml">(</mo><mi id="S3.I1.i4.p1.2.m2.1.1" xref="S3.I1.i4.p1.2.m2.1.1.cmml">𝐱</mi><mo id="S3.I1.i4.p1.2.m2.3.3.2.4" xref="S3.I1.i4.p1.2.m2.3.3.3.cmml">,</mo><msub id="S3.I1.i4.p1.2.m2.2.2.1.1" xref="S3.I1.i4.p1.2.m2.2.2.1.1.cmml"><mi id="S3.I1.i4.p1.2.m2.2.2.1.1.2" xref="S3.I1.i4.p1.2.m2.2.2.1.1.2.cmml">𝐲</mi><mn id="S3.I1.i4.p1.2.m2.2.2.1.1.3" xref="S3.I1.i4.p1.2.m2.2.2.1.1.3.cmml">3</mn></msub><mo id="S3.I1.i4.p1.2.m2.3.3.2.5" xref="S3.I1.i4.p1.2.m2.3.3.3.cmml">,</mo><msub id="S3.I1.i4.p1.2.m2.3.3.2.2" xref="S3.I1.i4.p1.2.m2.3.3.2.2.cmml"><mi id="S3.I1.i4.p1.2.m2.3.3.2.2.2" xref="S3.I1.i4.p1.2.m2.3.3.2.2.2.cmml">𝐲</mi><mn id="S3.I1.i4.p1.2.m2.3.3.2.2.3" xref="S3.I1.i4.p1.2.m2.3.3.2.2.3.cmml">5</mn></msub><mo id="S3.I1.i4.p1.2.m2.3.3.2.6" stretchy="false" xref="S3.I1.i4.p1.2.m2.3.3.3.cmml">)</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.I1.i4.p1.2.m2.3b"><vector id="S3.I1.i4.p1.2.m2.3.3.3.cmml" xref="S3.I1.i4.p1.2.m2.3.3.2"><ci id="S3.I1.i4.p1.2.m2.1.1.cmml" xref="S3.I1.i4.p1.2.m2.1.1">𝐱</ci><apply id="S3.I1.i4.p1.2.m2.2.2.1.1.cmml" xref="S3.I1.i4.p1.2.m2.2.2.1.1"><csymbol cd="ambiguous" id="S3.I1.i4.p1.2.m2.2.2.1.1.1.cmml" xref="S3.I1.i4.p1.2.m2.2.2.1.1">subscript</csymbol><ci id="S3.I1.i4.p1.2.m2.2.2.1.1.2.cmml" xref="S3.I1.i4.p1.2.m2.2.2.1.1.2">𝐲</ci><cn id="S3.I1.i4.p1.2.m2.2.2.1.1.3.cmml" type="integer" xref="S3.I1.i4.p1.2.m2.2.2.1.1.3">3</cn></apply><apply id="S3.I1.i4.p1.2.m2.3.3.2.2.cmml" xref="S3.I1.i4.p1.2.m2.3.3.2.2"><csymbol cd="ambiguous" id="S3.I1.i4.p1.2.m2.3.3.2.2.1.cmml" xref="S3.I1.i4.p1.2.m2.3.3.2.2">subscript</csymbol><ci id="S3.I1.i4.p1.2.m2.3.3.2.2.2.cmml" xref="S3.I1.i4.p1.2.m2.3.3.2.2.2">𝐲</ci><cn id="S3.I1.i4.p1.2.m2.3.3.2.2.3.cmml" type="integer" xref="S3.I1.i4.p1.2.m2.3.3.2.2.3">5</cn></apply></vector></annotation-xml><annotation encoding="application/x-tex" id="S3.I1.i4.p1.2.m2.3c">(\mathbf{x},\mathbf{y}_{3},\mathbf{y}_{5})</annotation><annotation encoding="application/x-llamapun" id="S3.I1.i4.p1.2.m2.3d">( bold_x , bold_y start_POSTSUBSCRIPT 3 end_POSTSUBSCRIPT , bold_y start_POSTSUBSCRIPT 5 end_POSTSUBSCRIPT )</annotation></semantics></math>, <math alttext="\ldots" class="ltx_Math" display="inline" id="S3.I1.i4.p1.3.m3.1"><semantics id="S3.I1.i4.p1.3.m3.1a"><mi id="S3.I1.i4.p1.3.m3.1.1" mathvariant="normal" xref="S3.I1.i4.p1.3.m3.1.1.cmml">…</mi><annotation-xml encoding="MathML-Content" id="S3.I1.i4.p1.3.m3.1b"><ci id="S3.I1.i4.p1.3.m3.1.1.cmml" xref="S3.I1.i4.p1.3.m3.1.1">…</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.I1.i4.p1.3.m3.1c">\ldots</annotation><annotation encoding="application/x-llamapun" id="S3.I1.i4.p1.3.m3.1d">…</annotation></semantics></math>
</p>
</div>
</li>
</ol>
</div>
</section>
</section>
<section class="ltx_subsection" id="S3.SS2">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.2 </span>DPO Fine-Tuning</h3>
<div class="ltx_para" id="S3.SS2.p1">
<p class="ltx_p" id="S3.SS2.p1.3">With a set of preference triplets <math alttext="\mathcal{D}" class="ltx_Math" display="inline" id="S3.SS2.p1.1.m1.1"><semantics id="S3.SS2.p1.1.m1.1a"><mi class="ltx_font_mathcaligraphic" id="S3.SS2.p1.1.m1.1.1" xref="S3.SS2.p1.1.m1.1.1.cmml">𝒟</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.1.m1.1b"><ci id="S3.SS2.p1.1.m1.1.1.cmml" xref="S3.SS2.p1.1.m1.1.1">𝒟</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.1.m1.1c">\mathcal{D}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p1.1.m1.1d">caligraphic_D</annotation></semantics></math> selected by one of the schemes above,
DPO fine-tuning proceeds as described in Section <a class="ltx_ref" href="https://arxiv.org/html/2311.08380v2#S2.SS1" title="2.1 DPO Fine-Tuning Objective ‣ 2 MBR and DPO ‣ Direct Preference Optimization for Neural Machine Translation with Minimum Bayes Risk Decoding"><span class="ltx_text ltx_ref_tag">2.1</span></a> and by <cite class="ltx_cite ltx_citemacro_citet">Rafailov et al. (<a class="ltx_ref" href="https://arxiv.org/html/2311.08380v2#bib.bib18" title="">2023</a>)</cite>. The
base model serves as the reference model in Equation <a class="ltx_ref" href="https://arxiv.org/html/2311.08380v2#S2.E4" title="In 2.1 DPO Fine-Tuning Objective ‣ 2 MBR and DPO ‣ Direct Preference Optimization for Neural Machine Translation with Minimum Bayes Risk Decoding"><span class="ltx_text ltx_ref_tag">4</span></a>. The base model is also used to initialise
<math alttext="\pi_{\theta}" class="ltx_Math" display="inline" id="S3.SS2.p1.2.m2.1"><semantics id="S3.SS2.p1.2.m2.1a"><msub id="S3.SS2.p1.2.m2.1.1" xref="S3.SS2.p1.2.m2.1.1.cmml"><mi id="S3.SS2.p1.2.m2.1.1.2" xref="S3.SS2.p1.2.m2.1.1.2.cmml">π</mi><mi id="S3.SS2.p1.2.m2.1.1.3" xref="S3.SS2.p1.2.m2.1.1.3.cmml">θ</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.2.m2.1b"><apply id="S3.SS2.p1.2.m2.1.1.cmml" xref="S3.SS2.p1.2.m2.1.1"><csymbol cd="ambiguous" id="S3.SS2.p1.2.m2.1.1.1.cmml" xref="S3.SS2.p1.2.m2.1.1">subscript</csymbol><ci id="S3.SS2.p1.2.m2.1.1.2.cmml" xref="S3.SS2.p1.2.m2.1.1.2">𝜋</ci><ci id="S3.SS2.p1.2.m2.1.1.3.cmml" xref="S3.SS2.p1.2.m2.1.1.3">𝜃</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.2.m2.1c">\pi_{\theta}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p1.2.m2.1d">italic_π start_POSTSUBSCRIPT italic_θ end_POSTSUBSCRIPT</annotation></semantics></math>, which is the model being fine-tuned.
The only DPO hyper-parameter we tune is <math alttext="\beta" class="ltx_Math" display="inline" id="S3.SS2.p1.3.m3.1"><semantics id="S3.SS2.p1.3.m3.1a"><mi id="S3.SS2.p1.3.m3.1.1" xref="S3.SS2.p1.3.m3.1.1.cmml">β</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.3.m3.1b"><ci id="S3.SS2.p1.3.m3.1.1.cmml" xref="S3.SS2.p1.3.m3.1.1">𝛽</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.3.m3.1c">\beta</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p1.3.m3.1d">italic_β</annotation></semantics></math>, which regulates how the fine-tuned model departs from the reference model <cite class="ltx_cite ltx_citemacro_citet">Rafailov et al. (<a class="ltx_ref" href="https://arxiv.org/html/2311.08380v2#bib.bib18" title="">2023</a>)</cite>.</p>
</div>
</section>
</section>
<section class="ltx_section" id="S4">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">4 </span>DPO MBR Fine-Tuning and MT</h2>
<figure class="ltx_figure" id="S4.F1"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_missing ltx_missing_image" id="S4.F1.g1" src=""/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 1: </span>Reward margins for DPO MBR fine-tuning of BLOOMZ and BLOOMZ-mt with BMW and CPS (stride of 2) selection strategies. Margins are calculated on the Zh-En fine-tuning set (WMT20 test set) as fine-tuning proceeds over one epoch. Results are plotted as moving averages with a window size of 20. CPS yields more preference pairs than BMW.</figcaption>
</figure>
<div class="ltx_para ltx_noindent" id="S4.p1">
<p class="ltx_p" id="S4.p1.1"><span class="ltx_text ltx_font_bold" id="S4.p1.1.1">Datasets</span>: We evaluate translation on the WMT21 news translation test sets <cite class="ltx_cite ltx_citemacro_cite">Akhbardeh et al. (<a class="ltx_ref" href="https://arxiv.org/html/2311.08380v2#bib.bib1" title="">2021</a>)</cite> and the WMT22 general translation for Chinese-English <cite class="ltx_cite ltx_citemacro_cite">Kocmi et al. (<a class="ltx_ref" href="https://arxiv.org/html/2311.08380v2#bib.bib12" title="">2022</a>)</cite>, and the IWSLT 2017 test set for French-English <cite class="ltx_cite ltx_citemacro_cite">Cettolo et al. (<a class="ltx_ref" href="https://arxiv.org/html/2311.08380v2#bib.bib3" title="">2017</a>)</cite>. For DPO fine-tuning we use the source language text in the WMT20 test sets for Chinese-English <cite class="ltx_cite ltx_citemacro_cite">Barrault et al. (<a class="ltx_ref" href="https://arxiv.org/html/2311.08380v2#bib.bib2" title="">2020</a>)</cite> and IWSLT 2017 validation sets for French-English. We do not use the corresponding reference translations, as DPO MBR fine-tuning is unsupervised. The fine-tuning and test sets are distinct and do not overlap.</p>
</div>
<div class="ltx_para ltx_noindent" id="S4.p2">
<p class="ltx_p" id="S4.p2.1"><span class="ltx_text ltx_font_bold" id="S4.p2.1.1">Models</span>: We use the BLOOMZ and BLOOMZ-mt models <cite class="ltx_cite ltx_citemacro_cite">Muennighoff et al. (<a class="ltx_ref" href="https://arxiv.org/html/2311.08380v2#bib.bib15" title="">2023</a>)</cite> with 7.1 billion parameters as our base model. BLOOMZ-mt was pre-trained on 366 billion tokens from monolingual texts and was fine-tuned for translation task on Flores-200 <cite class="ltx_cite ltx_citemacro_cite">NLLB Team et al. (<a class="ltx_ref" href="https://arxiv.org/html/2311.08380v2#bib.bib16" title="">2022</a>)</cite> and Tatoeba <cite class="ltx_cite ltx_citemacro_cite">Tiedemann (<a class="ltx_ref" href="https://arxiv.org/html/2311.08380v2#bib.bib23" title="">2020</a>)</cite> datasets. To prompt the model for translation, we include two randomly selected translation examples from the fine-tuning set into the input prompt as demonstration examples; these prompts are kept fixed throughout. In addition, we also fine-tuned the BLOOMZ-mt model in a supervised fashion for each language pair and denote this third base model as BLOOMZ-mt-sft. We use previous WMT news translation test sets from 2017 to 2020 as supervised fine-tuning sets for Chinese-English, and the first 20000 translation pairs from the IWSLT 2017 training set for French-English. Training details can be found in Appendix <a class="ltx_ref" href="https://arxiv.org/html/2311.08380v2#A2" title="Appendix B Training Details ‣ Direct Preference Optimization for Neural Machine Translation with Minimum Bayes Risk Decoding"><span class="ltx_text ltx_ref_tag">B</span></a>.</p>
</div>
<div class="ltx_para ltx_noindent" id="S4.p3">
<p class="ltx_p" id="S4.p3.1"><span class="ltx_text ltx_font_bold" id="S4.p3.1.1">Evaluation Metrics</span>: We use three evaluation metrics: BLEU <cite class="ltx_cite ltx_citemacro_cite">Papineni et al. (<a class="ltx_ref" href="https://arxiv.org/html/2311.08380v2#bib.bib17" title="">2002</a>)</cite>, BLEURT <cite class="ltx_cite ltx_citemacro_cite">Sellam et al. (<a class="ltx_ref" href="https://arxiv.org/html/2311.08380v2#bib.bib21" title="">2020</a>)</cite>, and COMET-22 <cite class="ltx_cite ltx_citemacro_cite">Rei et al. (<a class="ltx_ref" href="https://arxiv.org/html/2311.08380v2#bib.bib20" title="">2020</a>, <a class="ltx_ref" href="https://arxiv.org/html/2311.08380v2#bib.bib19" title="">2022</a>)</cite>.
BLEU serves only as a safety check:
Ideally DPO fine-tuning should not decrease BLEU.</p>
</div>
<div class="ltx_para ltx_noindent" id="S4.p4">
<p class="ltx_p" id="S4.p4.1"><span class="ltx_text ltx_font_bold" id="S4.p4.1.1">Baselines and Targets</span>: We take the base model and evaluate it on all the test sets with both beam search and MBR decoding. Our fine-tuned models, when decoded with beam search, should achieve similar performance as MBR decoding under the base model and show improvement over the base model.</p>
</div>
<figure class="ltx_figure" id="S4.F2"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_missing ltx_missing_image" id="S4.F2.g1" src=""/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 2: </span>Reward margin distributions over all preference pairs extracted via the BMW scheme from a held-out dataset (WMT18 Zh-En test). Distributions are gathered over the entire held-out set at model checkpoints at the beginning, a quarter, middle, three quarters, and end of one epoch of DPO fine-tuning. <math alttext="|H|=8" class="ltx_Math" display="inline" id="S4.F2.3.m1.1"><semantics id="S4.F2.3.m1.1b"><mrow id="S4.F2.3.m1.1.2" xref="S4.F2.3.m1.1.2.cmml"><mrow id="S4.F2.3.m1.1.2.2.2" xref="S4.F2.3.m1.1.2.2.1.cmml"><mo id="S4.F2.3.m1.1.2.2.2.1" stretchy="false" xref="S4.F2.3.m1.1.2.2.1.1.cmml">|</mo><mi id="S4.F2.3.m1.1.1" xref="S4.F2.3.m1.1.1.cmml">H</mi><mo id="S4.F2.3.m1.1.2.2.2.2" stretchy="false" xref="S4.F2.3.m1.1.2.2.1.1.cmml">|</mo></mrow><mo id="S4.F2.3.m1.1.2.1" xref="S4.F2.3.m1.1.2.1.cmml">=</mo><mn id="S4.F2.3.m1.1.2.3" xref="S4.F2.3.m1.1.2.3.cmml">8</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.F2.3.m1.1c"><apply id="S4.F2.3.m1.1.2.cmml" xref="S4.F2.3.m1.1.2"><eq id="S4.F2.3.m1.1.2.1.cmml" xref="S4.F2.3.m1.1.2.1"></eq><apply id="S4.F2.3.m1.1.2.2.1.cmml" xref="S4.F2.3.m1.1.2.2.2"><abs id="S4.F2.3.m1.1.2.2.1.1.cmml" xref="S4.F2.3.m1.1.2.2.2.1"></abs><ci id="S4.F2.3.m1.1.1.cmml" xref="S4.F2.3.m1.1.1">𝐻</ci></apply><cn id="S4.F2.3.m1.1.2.3.cmml" type="integer" xref="S4.F2.3.m1.1.2.3">8</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.F2.3.m1.1d">|H|=8</annotation><annotation encoding="application/x-llamapun" id="S4.F2.3.m1.1e">| italic_H | = 8</annotation></semantics></math> and <math alttext="\beta=0.7" class="ltx_Math" display="inline" id="S4.F2.4.m2.1"><semantics id="S4.F2.4.m2.1b"><mrow id="S4.F2.4.m2.1.1" xref="S4.F2.4.m2.1.1.cmml"><mi id="S4.F2.4.m2.1.1.2" xref="S4.F2.4.m2.1.1.2.cmml">β</mi><mo id="S4.F2.4.m2.1.1.1" xref="S4.F2.4.m2.1.1.1.cmml">=</mo><mn id="S4.F2.4.m2.1.1.3" xref="S4.F2.4.m2.1.1.3.cmml">0.7</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.F2.4.m2.1c"><apply id="S4.F2.4.m2.1.1.cmml" xref="S4.F2.4.m2.1.1"><eq id="S4.F2.4.m2.1.1.1.cmml" xref="S4.F2.4.m2.1.1.1"></eq><ci id="S4.F2.4.m2.1.1.2.cmml" xref="S4.F2.4.m2.1.1.2">𝛽</ci><cn id="S4.F2.4.m2.1.1.3.cmml" type="float" xref="S4.F2.4.m2.1.1.3">0.7</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.F2.4.m2.1d">\beta=0.7</annotation><annotation encoding="application/x-llamapun" id="S4.F2.4.m2.1e">italic_β = 0.7</annotation></semantics></math>. DPO fine-tuning generalises beyond its fine-tuning set and yields improved reward margins on held-out data.</figcaption>
</figure>
<figure class="ltx_table" id="S4.T1">
<table class="ltx_tabular ltx_centering ltx_guessed_headers ltx_align_middle" id="S4.T1.6">
<tbody class="ltx_tbody">
<tr class="ltx_tr" id="S4.T1.6.7.1">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_tt" id="S4.T1.6.7.1.1" rowspan="2"><span class="ltx_text" id="S4.T1.6.7.1.1.1">#</span></th>
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_tt" id="S4.T1.6.7.1.2" rowspan="2"><span class="ltx_text" id="S4.T1.6.7.1.2.1">Model (Decoding)</span></th>
<td class="ltx_td ltx_align_center ltx_border_tt" colspan="2" id="S4.T1.6.7.1.3">WMT21</td>
<td class="ltx_td ltx_align_center ltx_border_tt" colspan="2" id="S4.T1.6.7.1.4">WMT22</td>
<td class="ltx_td ltx_align_center ltx_border_tt" colspan="2" id="S4.T1.6.7.1.5">IWSLT17</td>
</tr>
<tr class="ltx_tr" id="S4.T1.6.8.2">
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T1.6.8.2.1">zh-en</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T1.6.8.2.2">en-zh</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T1.6.8.2.3">zh-en</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T1.6.8.2.4">en-zh</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T1.6.8.2.5">fr-en</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T1.6.8.2.6">en-fr</td>
</tr>
<tr class="ltx_tr" id="S4.T1.6.9.3">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_t" id="S4.T1.6.9.3.1">1</th>
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t" id="S4.T1.6.9.3.2">BLOOMZ (Beam)</th>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T1.6.9.3.3">59.6 | 76.5</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T1.6.9.3.4">59.2 | 81.1</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T1.6.9.3.5">59.9 | 74.6</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T1.6.9.3.6">55.9 | 76.7</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T1.6.9.3.7">72.7 | 83.9</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T1.6.9.3.8">69.3 | 83.1</td>
</tr>
<tr class="ltx_tr" id="S4.T1.1.1">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row" id="S4.T1.1.1.2">2</th>
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="S4.T1.1.1.1">BLOOMZ (MBR <math alttext="|H|=8" class="ltx_Math" display="inline" id="S4.T1.1.1.1.m1.1"><semantics id="S4.T1.1.1.1.m1.1a"><mrow id="S4.T1.1.1.1.m1.1.2" xref="S4.T1.1.1.1.m1.1.2.cmml"><mrow id="S4.T1.1.1.1.m1.1.2.2.2" xref="S4.T1.1.1.1.m1.1.2.2.1.cmml"><mo id="S4.T1.1.1.1.m1.1.2.2.2.1" stretchy="false" xref="S4.T1.1.1.1.m1.1.2.2.1.1.cmml">|</mo><mi id="S4.T1.1.1.1.m1.1.1" xref="S4.T1.1.1.1.m1.1.1.cmml">H</mi><mo id="S4.T1.1.1.1.m1.1.2.2.2.2" stretchy="false" xref="S4.T1.1.1.1.m1.1.2.2.1.1.cmml">|</mo></mrow><mo id="S4.T1.1.1.1.m1.1.2.1" xref="S4.T1.1.1.1.m1.1.2.1.cmml">=</mo><mn id="S4.T1.1.1.1.m1.1.2.3" xref="S4.T1.1.1.1.m1.1.2.3.cmml">8</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.T1.1.1.1.m1.1b"><apply id="S4.T1.1.1.1.m1.1.2.cmml" xref="S4.T1.1.1.1.m1.1.2"><eq id="S4.T1.1.1.1.m1.1.2.1.cmml" xref="S4.T1.1.1.1.m1.1.2.1"></eq><apply id="S4.T1.1.1.1.m1.1.2.2.1.cmml" xref="S4.T1.1.1.1.m1.1.2.2.2"><abs id="S4.T1.1.1.1.m1.1.2.2.1.1.cmml" xref="S4.T1.1.1.1.m1.1.2.2.2.1"></abs><ci id="S4.T1.1.1.1.m1.1.1.cmml" xref="S4.T1.1.1.1.m1.1.1">𝐻</ci></apply><cn id="S4.T1.1.1.1.m1.1.2.3.cmml" type="integer" xref="S4.T1.1.1.1.m1.1.2.3">8</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.T1.1.1.1.m1.1c">|H|=8</annotation><annotation encoding="application/x-llamapun" id="S4.T1.1.1.1.m1.1d">| italic_H | = 8</annotation></semantics></math>)</th>
<td class="ltx_td ltx_align_center" id="S4.T1.1.1.3">60.0 | 76.4</td>
<td class="ltx_td ltx_align_center" id="S4.T1.1.1.4">62.5 | 82.3</td>
<td class="ltx_td ltx_align_center" id="S4.T1.1.1.5">62.1 | 75.8</td>
<td class="ltx_td ltx_align_center" id="S4.T1.1.1.6">62.7 | 80.0</td>
<td class="ltx_td ltx_align_center" id="S4.T1.1.1.7">73.6 | 84.2</td>
<td class="ltx_td ltx_align_center" id="S4.T1.1.1.8">70.4 | 83.3</td>
</tr>
<tr class="ltx_tr" id="S4.T1.2.2">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row" id="S4.T1.2.2.2">3</th>
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="S4.T1.2.2.1">BLOOMZ (MBR <math alttext="|H|=32" class="ltx_Math" display="inline" id="S4.T1.2.2.1.m1.1"><semantics id="S4.T1.2.2.1.m1.1a"><mrow id="S4.T1.2.2.1.m1.1.2" xref="S4.T1.2.2.1.m1.1.2.cmml"><mrow id="S4.T1.2.2.1.m1.1.2.2.2" xref="S4.T1.2.2.1.m1.1.2.2.1.cmml"><mo id="S4.T1.2.2.1.m1.1.2.2.2.1" stretchy="false" xref="S4.T1.2.2.1.m1.1.2.2.1.1.cmml">|</mo><mi id="S4.T1.2.2.1.m1.1.1" xref="S4.T1.2.2.1.m1.1.1.cmml">H</mi><mo id="S4.T1.2.2.1.m1.1.2.2.2.2" stretchy="false" xref="S4.T1.2.2.1.m1.1.2.2.1.1.cmml">|</mo></mrow><mo id="S4.T1.2.2.1.m1.1.2.1" xref="S4.T1.2.2.1.m1.1.2.1.cmml">=</mo><mn id="S4.T1.2.2.1.m1.1.2.3" xref="S4.T1.2.2.1.m1.1.2.3.cmml">32</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.T1.2.2.1.m1.1b"><apply id="S4.T1.2.2.1.m1.1.2.cmml" xref="S4.T1.2.2.1.m1.1.2"><eq id="S4.T1.2.2.1.m1.1.2.1.cmml" xref="S4.T1.2.2.1.m1.1.2.1"></eq><apply id="S4.T1.2.2.1.m1.1.2.2.1.cmml" xref="S4.T1.2.2.1.m1.1.2.2.2"><abs id="S4.T1.2.2.1.m1.1.2.2.1.1.cmml" xref="S4.T1.2.2.1.m1.1.2.2.2.1"></abs><ci id="S4.T1.2.2.1.m1.1.1.cmml" xref="S4.T1.2.2.1.m1.1.1">𝐻</ci></apply><cn id="S4.T1.2.2.1.m1.1.2.3.cmml" type="integer" xref="S4.T1.2.2.1.m1.1.2.3">32</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.T1.2.2.1.m1.1c">|H|=32</annotation><annotation encoding="application/x-llamapun" id="S4.T1.2.2.1.m1.1d">| italic_H | = 32</annotation></semantics></math>)</th>
<td class="ltx_td ltx_align_center" id="S4.T1.2.2.3">62.5 | 77.2</td>
<td class="ltx_td ltx_align_center" id="S4.T1.2.2.4">
<span class="ltx_text ltx_font_bold" id="S4.T1.2.2.4.1">64.7</span> | <span class="ltx_text ltx_font_bold" id="S4.T1.2.2.4.2">83.0</span>
</td>
<td class="ltx_td ltx_align_center" id="S4.T1.2.2.5">
<span class="ltx_text ltx_font_bold" id="S4.T1.2.2.5.1">64.0</span> | 76.4</td>
<td class="ltx_td ltx_align_center" id="S4.T1.2.2.6">
<span class="ltx_text ltx_font_bold" id="S4.T1.2.2.6.1">64.9</span> | 80.7</td>
<td class="ltx_td ltx_align_center" id="S4.T1.2.2.7">74.8 | 85.0</td>
<td class="ltx_td ltx_align_center" id="S4.T1.2.2.8">
<span class="ltx_text ltx_font_bold" id="S4.T1.2.2.8.1">72.6</span> | 84.3</td>
</tr>
<tr class="ltx_tr" id="S4.T1.6.10.4">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row" id="S4.T1.6.10.4.1">4</th>
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="S4.T1.6.10.4.2">
<span class="ltx_text ltx_font_bold" id="S4.T1.6.10.4.2.1">BLOOMZ-DPO-MBR</span> (Beam)</th>
<td class="ltx_td ltx_align_center" id="S4.T1.6.10.4.3">
<span class="ltx_text ltx_font_bold" id="S4.T1.6.10.4.3.1">62.3</span> | <span class="ltx_text ltx_font_bold" id="S4.T1.6.10.4.3.2">77.9</span>
</td>
<td class="ltx_td ltx_align_center" id="S4.T1.6.10.4.4">62.5 | 82.7</td>
<td class="ltx_td ltx_align_center" id="S4.T1.6.10.4.5">
<span class="ltx_text ltx_font_bold" id="S4.T1.6.10.4.5.1">64.0</span> | <span class="ltx_text ltx_font_bold" id="S4.T1.6.10.4.5.2">77.2</span>
</td>
<td class="ltx_td ltx_align_center" id="S4.T1.6.10.4.6">64.2 | <span class="ltx_text ltx_font_bold" id="S4.T1.6.10.4.6.1">82.0</span>
</td>
<td class="ltx_td ltx_align_center" id="S4.T1.6.10.4.7">
<span class="ltx_text ltx_font_bold" id="S4.T1.6.10.4.7.1">76.5</span> | <span class="ltx_text ltx_font_bold" id="S4.T1.6.10.4.7.2">86.9</span>
</td>
<td class="ltx_td ltx_align_center" id="S4.T1.6.10.4.8">72.2 | <span class="ltx_text ltx_font_bold" id="S4.T1.6.10.4.8.1">84.8</span>
</td>
</tr>
<tr class="ltx_tr" id="S4.T1.6.11.5">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_t" id="S4.T1.6.11.5.1">5</th>
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t" id="S4.T1.6.11.5.2">BLOOMZ-mt (Beam)</th>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T1.6.11.5.3">60.3 | 77.0</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T1.6.11.5.4">59.2 | 80.9</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T1.6.11.5.5">60.9 | 75.5</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T1.6.11.5.6">59.0 | 79.1</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T1.6.11.5.7">74.8 | 85.4</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T1.6.11.5.8">70.3 | 83.5</td>
</tr>
<tr class="ltx_tr" id="S4.T1.3.3">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row" id="S4.T1.3.3.2">6</th>
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="S4.T1.3.3.1">BLOOMZ-mt (MBR <math alttext="|H|=8" class="ltx_Math" display="inline" id="S4.T1.3.3.1.m1.1"><semantics id="S4.T1.3.3.1.m1.1a"><mrow id="S4.T1.3.3.1.m1.1.2" xref="S4.T1.3.3.1.m1.1.2.cmml"><mrow id="S4.T1.3.3.1.m1.1.2.2.2" xref="S4.T1.3.3.1.m1.1.2.2.1.cmml"><mo id="S4.T1.3.3.1.m1.1.2.2.2.1" stretchy="false" xref="S4.T1.3.3.1.m1.1.2.2.1.1.cmml">|</mo><mi id="S4.T1.3.3.1.m1.1.1" xref="S4.T1.3.3.1.m1.1.1.cmml">H</mi><mo id="S4.T1.3.3.1.m1.1.2.2.2.2" stretchy="false" xref="S4.T1.3.3.1.m1.1.2.2.1.1.cmml">|</mo></mrow><mo id="S4.T1.3.3.1.m1.1.2.1" xref="S4.T1.3.3.1.m1.1.2.1.cmml">=</mo><mn id="S4.T1.3.3.1.m1.1.2.3" xref="S4.T1.3.3.1.m1.1.2.3.cmml">8</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.T1.3.3.1.m1.1b"><apply id="S4.T1.3.3.1.m1.1.2.cmml" xref="S4.T1.3.3.1.m1.1.2"><eq id="S4.T1.3.3.1.m1.1.2.1.cmml" xref="S4.T1.3.3.1.m1.1.2.1"></eq><apply id="S4.T1.3.3.1.m1.1.2.2.1.cmml" xref="S4.T1.3.3.1.m1.1.2.2.2"><abs id="S4.T1.3.3.1.m1.1.2.2.1.1.cmml" xref="S4.T1.3.3.1.m1.1.2.2.2.1"></abs><ci id="S4.T1.3.3.1.m1.1.1.cmml" xref="S4.T1.3.3.1.m1.1.1">𝐻</ci></apply><cn id="S4.T1.3.3.1.m1.1.2.3.cmml" type="integer" xref="S4.T1.3.3.1.m1.1.2.3">8</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.T1.3.3.1.m1.1c">|H|=8</annotation><annotation encoding="application/x-llamapun" id="S4.T1.3.3.1.m1.1d">| italic_H | = 8</annotation></semantics></math>)</th>
<td class="ltx_td ltx_align_center" id="S4.T1.3.3.3">61.6 | 77.6</td>
<td class="ltx_td ltx_align_center" id="S4.T1.3.3.4">62.6 | 82.3</td>
<td class="ltx_td ltx_align_center" id="S4.T1.3.3.5">63.0 | 76.5</td>
<td class="ltx_td ltx_align_center" id="S4.T1.3.3.6">64.7 | 81.4</td>
<td class="ltx_td ltx_align_center" id="S4.T1.3.3.7">75.4 | 85.5</td>
<td class="ltx_td ltx_align_center" id="S4.T1.3.3.8">71.0 | 83.3</td>
</tr>
<tr class="ltx_tr" id="S4.T1.4.4">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row" id="S4.T1.4.4.2">7</th>
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="S4.T1.4.4.1">BLOOMZ-mt (MBR <math alttext="|H|=32" class="ltx_Math" display="inline" id="S4.T1.4.4.1.m1.1"><semantics id="S4.T1.4.4.1.m1.1a"><mrow id="S4.T1.4.4.1.m1.1.2" xref="S4.T1.4.4.1.m1.1.2.cmml"><mrow id="S4.T1.4.4.1.m1.1.2.2.2" xref="S4.T1.4.4.1.m1.1.2.2.1.cmml"><mo id="S4.T1.4.4.1.m1.1.2.2.2.1" stretchy="false" xref="S4.T1.4.4.1.m1.1.2.2.1.1.cmml">|</mo><mi id="S4.T1.4.4.1.m1.1.1" xref="S4.T1.4.4.1.m1.1.1.cmml">H</mi><mo id="S4.T1.4.4.1.m1.1.2.2.2.2" stretchy="false" xref="S4.T1.4.4.1.m1.1.2.2.1.1.cmml">|</mo></mrow><mo id="S4.T1.4.4.1.m1.1.2.1" xref="S4.T1.4.4.1.m1.1.2.1.cmml">=</mo><mn id="S4.T1.4.4.1.m1.1.2.3" xref="S4.T1.4.4.1.m1.1.2.3.cmml">32</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.T1.4.4.1.m1.1b"><apply id="S4.T1.4.4.1.m1.1.2.cmml" xref="S4.T1.4.4.1.m1.1.2"><eq id="S4.T1.4.4.1.m1.1.2.1.cmml" xref="S4.T1.4.4.1.m1.1.2.1"></eq><apply id="S4.T1.4.4.1.m1.1.2.2.1.cmml" xref="S4.T1.4.4.1.m1.1.2.2.2"><abs id="S4.T1.4.4.1.m1.1.2.2.1.1.cmml" xref="S4.T1.4.4.1.m1.1.2.2.2.1"></abs><ci id="S4.T1.4.4.1.m1.1.1.cmml" xref="S4.T1.4.4.1.m1.1.1">𝐻</ci></apply><cn id="S4.T1.4.4.1.m1.1.2.3.cmml" type="integer" xref="S4.T1.4.4.1.m1.1.2.3">32</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.T1.4.4.1.m1.1c">|H|=32</annotation><annotation encoding="application/x-llamapun" id="S4.T1.4.4.1.m1.1d">| italic_H | = 32</annotation></semantics></math>)</th>
<td class="ltx_td ltx_align_center" id="S4.T1.4.4.3">63.4 | 78.3</td>
<td class="ltx_td ltx_align_center" id="S4.T1.4.4.4">
<span class="ltx_text ltx_font_bold" id="S4.T1.4.4.4.1">64.9</span> | 82.9</td>
<td class="ltx_td ltx_align_center" id="S4.T1.4.4.5">64.8 | 77.2</td>
<td class="ltx_td ltx_align_center" id="S4.T1.4.4.6">66.8 | 82.1</td>
<td class="ltx_td ltx_align_center" id="S4.T1.4.4.7">76.3 | 86.0</td>
<td class="ltx_td ltx_align_center" id="S4.T1.4.4.8">
<span class="ltx_text ltx_font_bold" id="S4.T1.4.4.8.1">73.2</span> | 84.3</td>
</tr>
<tr class="ltx_tr" id="S4.T1.6.12.6">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row" id="S4.T1.6.12.6.1">8</th>
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="S4.T1.6.12.6.2">
<span class="ltx_text ltx_font_bold" id="S4.T1.6.12.6.2.1">BLOOMZ-mt-DPO-MBR</span> (Beam)</th>
<td class="ltx_td ltx_align_center" id="S4.T1.6.12.6.3">
<span class="ltx_text ltx_font_bold" id="S4.T1.6.12.6.3.1">63.9</span> | <span class="ltx_text ltx_font_bold" id="S4.T1.6.12.6.3.2">78.7</span>
</td>
<td class="ltx_td ltx_align_center" id="S4.T1.6.12.6.4">64.0 | <span class="ltx_text ltx_font_bold" id="S4.T1.6.12.6.4.1">83.6</span>
</td>
<td class="ltx_td ltx_align_center" id="S4.T1.6.12.6.5">
<span class="ltx_text ltx_font_bold" id="S4.T1.6.12.6.5.1">65.1</span> | <span class="ltx_text ltx_font_bold" id="S4.T1.6.12.6.5.2">77.9</span>
</td>
<td class="ltx_td ltx_align_center" id="S4.T1.6.12.6.6">
<span class="ltx_text ltx_font_bold" id="S4.T1.6.12.6.6.1">67.6</span> | <span class="ltx_text ltx_font_bold" id="S4.T1.6.12.6.6.2">83.7</span>
</td>
<td class="ltx_td ltx_align_center" id="S4.T1.6.12.6.7">
<span class="ltx_text ltx_font_bold" id="S4.T1.6.12.6.7.1">76.5</span> | <span class="ltx_text ltx_font_bold" id="S4.T1.6.12.6.7.2">86.8</span>
</td>
<td class="ltx_td ltx_align_center" id="S4.T1.6.12.6.8">71.9 | <span class="ltx_text ltx_font_bold" id="S4.T1.6.12.6.8.1">84.6</span>
</td>
</tr>
<tr class="ltx_tr" id="S4.T1.6.13.7">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_t" id="S4.T1.6.13.7.1">9</th>
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t" id="S4.T1.6.13.7.2">BLOOMZ-mt-sft (Beam)</th>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T1.6.13.7.3">64.3 | 79.4</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T1.6.13.7.4">62.6 | 83.0</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T1.6.13.7.5">62.6 | 76.5</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T1.6.13.7.6">65.6 | 83.1</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T1.6.13.7.7">76.9 | 86.6</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T1.6.13.7.8">71.2 | <span class="ltx_text ltx_font_bold" id="S4.T1.6.13.7.8.1">83.8</span>
</td>
</tr>
<tr class="ltx_tr" id="S4.T1.5.5">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row" id="S4.T1.5.5.2">10</th>
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="S4.T1.5.5.1">BLOOMZ-mt-sft (MBR <math alttext="|H|=8" class="ltx_Math" display="inline" id="S4.T1.5.5.1.m1.1"><semantics id="S4.T1.5.5.1.m1.1a"><mrow id="S4.T1.5.5.1.m1.1.2" xref="S4.T1.5.5.1.m1.1.2.cmml"><mrow id="S4.T1.5.5.1.m1.1.2.2.2" xref="S4.T1.5.5.1.m1.1.2.2.1.cmml"><mo id="S4.T1.5.5.1.m1.1.2.2.2.1" stretchy="false" xref="S4.T1.5.5.1.m1.1.2.2.1.1.cmml">|</mo><mi id="S4.T1.5.5.1.m1.1.1" xref="S4.T1.5.5.1.m1.1.1.cmml">H</mi><mo id="S4.T1.5.5.1.m1.1.2.2.2.2" stretchy="false" xref="S4.T1.5.5.1.m1.1.2.2.1.1.cmml">|</mo></mrow><mo id="S4.T1.5.5.1.m1.1.2.1" xref="S4.T1.5.5.1.m1.1.2.1.cmml">=</mo><mn id="S4.T1.5.5.1.m1.1.2.3" xref="S4.T1.5.5.1.m1.1.2.3.cmml">8</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.T1.5.5.1.m1.1b"><apply id="S4.T1.5.5.1.m1.1.2.cmml" xref="S4.T1.5.5.1.m1.1.2"><eq id="S4.T1.5.5.1.m1.1.2.1.cmml" xref="S4.T1.5.5.1.m1.1.2.1"></eq><apply id="S4.T1.5.5.1.m1.1.2.2.1.cmml" xref="S4.T1.5.5.1.m1.1.2.2.2"><abs id="S4.T1.5.5.1.m1.1.2.2.1.1.cmml" xref="S4.T1.5.5.1.m1.1.2.2.2.1"></abs><ci id="S4.T1.5.5.1.m1.1.1.cmml" xref="S4.T1.5.5.1.m1.1.1">𝐻</ci></apply><cn id="S4.T1.5.5.1.m1.1.2.3.cmml" type="integer" xref="S4.T1.5.5.1.m1.1.2.3">8</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.T1.5.5.1.m1.1c">|H|=8</annotation><annotation encoding="application/x-llamapun" id="S4.T1.5.5.1.m1.1d">| italic_H | = 8</annotation></semantics></math>)</th>
<td class="ltx_td ltx_align_center" id="S4.T1.5.5.3">65.3 | 79.8</td>
<td class="ltx_td ltx_align_center" id="S4.T1.5.5.4">64.8 | 83.9</td>
<td class="ltx_td ltx_align_center" id="S4.T1.5.5.5">65.4 | 78.2</td>
<td class="ltx_td ltx_align_center" id="S4.T1.5.5.6">69.1 | 84.2</td>
<td class="ltx_td ltx_align_center" id="S4.T1.5.5.7">77.3 | 86.7</td>
<td class="ltx_td ltx_align_center" id="S4.T1.5.5.8">72.6 | 83.6</td>
</tr>
<tr class="ltx_tr" id="S4.T1.6.6">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row" id="S4.T1.6.6.2">11</th>
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="S4.T1.6.6.1">BLOOMZ-mt-sft (MBR <math alttext="|H|=32" class="ltx_Math" display="inline" id="S4.T1.6.6.1.m1.1"><semantics id="S4.T1.6.6.1.m1.1a"><mrow id="S4.T1.6.6.1.m1.1.2" xref="S4.T1.6.6.1.m1.1.2.cmml"><mrow id="S4.T1.6.6.1.m1.1.2.2.2" xref="S4.T1.6.6.1.m1.1.2.2.1.cmml"><mo id="S4.T1.6.6.1.m1.1.2.2.2.1" stretchy="false" xref="S4.T1.6.6.1.m1.1.2.2.1.1.cmml">|</mo><mi id="S4.T1.6.6.1.m1.1.1" xref="S4.T1.6.6.1.m1.1.1.cmml">H</mi><mo id="S4.T1.6.6.1.m1.1.2.2.2.2" stretchy="false" xref="S4.T1.6.6.1.m1.1.2.2.1.1.cmml">|</mo></mrow><mo id="S4.T1.6.6.1.m1.1.2.1" xref="S4.T1.6.6.1.m1.1.2.1.cmml">=</mo><mn id="S4.T1.6.6.1.m1.1.2.3" xref="S4.T1.6.6.1.m1.1.2.3.cmml">32</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.T1.6.6.1.m1.1b"><apply id="S4.T1.6.6.1.m1.1.2.cmml" xref="S4.T1.6.6.1.m1.1.2"><eq id="S4.T1.6.6.1.m1.1.2.1.cmml" xref="S4.T1.6.6.1.m1.1.2.1"></eq><apply id="S4.T1.6.6.1.m1.1.2.2.1.cmml" xref="S4.T1.6.6.1.m1.1.2.2.2"><abs id="S4.T1.6.6.1.m1.1.2.2.1.1.cmml" xref="S4.T1.6.6.1.m1.1.2.2.2.1"></abs><ci id="S4.T1.6.6.1.m1.1.1.cmml" xref="S4.T1.6.6.1.m1.1.1">𝐻</ci></apply><cn id="S4.T1.6.6.1.m1.1.2.3.cmml" type="integer" xref="S4.T1.6.6.1.m1.1.2.3">32</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.T1.6.6.1.m1.1c">|H|=32</annotation><annotation encoding="application/x-llamapun" id="S4.T1.6.6.1.m1.1d">| italic_H | = 32</annotation></semantics></math>)</th>
<td class="ltx_td ltx_align_center" id="S4.T1.6.6.3">
<span class="ltx_text ltx_font_bold" id="S4.T1.6.6.3.1">66.8</span> | 80.4</td>
<td class="ltx_td ltx_align_center" id="S4.T1.6.6.4">
<span class="ltx_text ltx_font_bold" id="S4.T1.6.6.4.1">66.7</span> | <span class="ltx_text ltx_font_bold" id="S4.T1.6.6.4.2">84.4</span>
</td>
<td class="ltx_td ltx_align_center" id="S4.T1.6.6.5">
<span class="ltx_text ltx_font_bold" id="S4.T1.6.6.5.1">67.1</span> | 78.9</td>
<td class="ltx_td ltx_align_center" id="S4.T1.6.6.6">
<span class="ltx_text ltx_font_bold" id="S4.T1.6.6.6.1">71.0</span> | 85.1</td>
<td class="ltx_td ltx_align_center" id="S4.T1.6.6.7">
<span class="ltx_text ltx_font_bold" id="S4.T1.6.6.7.1">78.2</span> | <span class="ltx_text ltx_font_bold" id="S4.T1.6.6.7.2">86.9</span>
</td>
<td class="ltx_td ltx_align_center" id="S4.T1.6.6.8">
<span class="ltx_text ltx_font_bold" id="S4.T1.6.6.8.1">74.9</span> | 83.3</td>
</tr>
<tr class="ltx_tr" id="S4.T1.6.14.8">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_bb" id="S4.T1.6.14.8.1">12</th>
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_bb" id="S4.T1.6.14.8.2">
<span class="ltx_text ltx_font_bold" id="S4.T1.6.14.8.2.1">BLOOMZ-mt-sft-DPO-MBR</span> (Beam)</th>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S4.T1.6.14.8.3">66.0 | <span class="ltx_text ltx_font_bold" id="S4.T1.6.14.8.3.1">80.8</span>
</td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S4.T1.6.14.8.4">64.2 | 83.9</td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S4.T1.6.14.8.5">66.5 | <span class="ltx_text ltx_font_bold" id="S4.T1.6.14.8.5.1">79.6</span>
</td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S4.T1.6.14.8.6">69.5 | <span class="ltx_text ltx_font_bold" id="S4.T1.6.14.8.6.1">85.6</span>
</td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S4.T1.6.14.8.7">76.4 | 83.4</td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S4.T1.6.14.8.8">72.4 | <span class="ltx_text ltx_font_bold" id="S4.T1.6.14.8.8.1">83.8</span>
</td>
</tr>
</tbody>
</table>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table">Table 1: </span>Translation performance in BLEURT and COMET (BLEURT | COMET) for models with beam search (beam width of 4) and MBR decoding on two language pairs from WMT21 news translation test sets, WMT22 general translation test sets, and IWSLT 2017 test sets. DPO-MBR indicates our translation performance with our fine-tuning method. All the DPO MBR models were fine-tuned using the BMW strategy and <math alttext="\beta=0.7" class="ltx_Math" display="inline" id="S4.T1.11.m1.1"><semantics id="S4.T1.11.m1.1b"><mrow id="S4.T1.11.m1.1.1" xref="S4.T1.11.m1.1.1.cmml"><mi id="S4.T1.11.m1.1.1.2" xref="S4.T1.11.m1.1.1.2.cmml">β</mi><mo id="S4.T1.11.m1.1.1.1" xref="S4.T1.11.m1.1.1.1.cmml">=</mo><mn id="S4.T1.11.m1.1.1.3" xref="S4.T1.11.m1.1.1.3.cmml">0.7</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.T1.11.m1.1c"><apply id="S4.T1.11.m1.1.1.cmml" xref="S4.T1.11.m1.1.1"><eq id="S4.T1.11.m1.1.1.1.cmml" xref="S4.T1.11.m1.1.1.1"></eq><ci id="S4.T1.11.m1.1.1.2.cmml" xref="S4.T1.11.m1.1.1.2">𝛽</ci><cn id="S4.T1.11.m1.1.1.3.cmml" type="float" xref="S4.T1.11.m1.1.1.3">0.7</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.T1.11.m1.1d">\beta=0.7</annotation><annotation encoding="application/x-llamapun" id="S4.T1.11.m1.1e">italic_β = 0.7</annotation></semantics></math> except for BLOOMZ-mt-sft on IWSLT 2017, which used the BW strategy. We set <math alttext="|H|=32" class="ltx_Math" display="inline" id="S4.T1.12.m2.1"><semantics id="S4.T1.12.m2.1b"><mrow id="S4.T1.12.m2.1.2" xref="S4.T1.12.m2.1.2.cmml"><mrow id="S4.T1.12.m2.1.2.2.2" xref="S4.T1.12.m2.1.2.2.1.cmml"><mo id="S4.T1.12.m2.1.2.2.2.1" stretchy="false" xref="S4.T1.12.m2.1.2.2.1.1.cmml">|</mo><mi id="S4.T1.12.m2.1.1" xref="S4.T1.12.m2.1.1.cmml">H</mi><mo id="S4.T1.12.m2.1.2.2.2.2" stretchy="false" xref="S4.T1.12.m2.1.2.2.1.1.cmml">|</mo></mrow><mo id="S4.T1.12.m2.1.2.1" xref="S4.T1.12.m2.1.2.1.cmml">=</mo><mn id="S4.T1.12.m2.1.2.3" xref="S4.T1.12.m2.1.2.3.cmml">32</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.T1.12.m2.1c"><apply id="S4.T1.12.m2.1.2.cmml" xref="S4.T1.12.m2.1.2"><eq id="S4.T1.12.m2.1.2.1.cmml" xref="S4.T1.12.m2.1.2.1"></eq><apply id="S4.T1.12.m2.1.2.2.1.cmml" xref="S4.T1.12.m2.1.2.2.2"><abs id="S4.T1.12.m2.1.2.2.1.1.cmml" xref="S4.T1.12.m2.1.2.2.2.1"></abs><ci id="S4.T1.12.m2.1.1.cmml" xref="S4.T1.12.m2.1.1">𝐻</ci></apply><cn id="S4.T1.12.m2.1.2.3.cmml" type="integer" xref="S4.T1.12.m2.1.2.3">32</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.T1.12.m2.1d">|H|=32</annotation><annotation encoding="application/x-llamapun" id="S4.T1.12.m2.1e">| italic_H | = 32</annotation></semantics></math> to fine-tune BLOOMZ-mt-DPO-MBR on English-Chinese direction, <math alttext="|H|=16" class="ltx_Math" display="inline" id="S4.T1.13.m3.1"><semantics id="S4.T1.13.m3.1b"><mrow id="S4.T1.13.m3.1.2" xref="S4.T1.13.m3.1.2.cmml"><mrow id="S4.T1.13.m3.1.2.2.2" xref="S4.T1.13.m3.1.2.2.1.cmml"><mo id="S4.T1.13.m3.1.2.2.2.1" stretchy="false" xref="S4.T1.13.m3.1.2.2.1.1.cmml">|</mo><mi id="S4.T1.13.m3.1.1" xref="S4.T1.13.m3.1.1.cmml">H</mi><mo id="S4.T1.13.m3.1.2.2.2.2" stretchy="false" xref="S4.T1.13.m3.1.2.2.1.1.cmml">|</mo></mrow><mo id="S4.T1.13.m3.1.2.1" xref="S4.T1.13.m3.1.2.1.cmml">=</mo><mn id="S4.T1.13.m3.1.2.3" xref="S4.T1.13.m3.1.2.3.cmml">16</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.T1.13.m3.1c"><apply id="S4.T1.13.m3.1.2.cmml" xref="S4.T1.13.m3.1.2"><eq id="S4.T1.13.m3.1.2.1.cmml" xref="S4.T1.13.m3.1.2.1"></eq><apply id="S4.T1.13.m3.1.2.2.1.cmml" xref="S4.T1.13.m3.1.2.2.2"><abs id="S4.T1.13.m3.1.2.2.1.1.cmml" xref="S4.T1.13.m3.1.2.2.2.1"></abs><ci id="S4.T1.13.m3.1.1.cmml" xref="S4.T1.13.m3.1.1">𝐻</ci></apply><cn id="S4.T1.13.m3.1.2.3.cmml" type="integer" xref="S4.T1.13.m3.1.2.3">16</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.T1.13.m3.1d">|H|=16</annotation><annotation encoding="application/x-llamapun" id="S4.T1.13.m3.1e">| italic_H | = 16</annotation></semantics></math> on the French-English direction for BLOOMZ and BLOOMZ-mt, and set <math alttext="|H|=8" class="ltx_Math" display="inline" id="S4.T1.14.m4.1"><semantics id="S4.T1.14.m4.1b"><mrow id="S4.T1.14.m4.1.2" xref="S4.T1.14.m4.1.2.cmml"><mrow id="S4.T1.14.m4.1.2.2.2" xref="S4.T1.14.m4.1.2.2.1.cmml"><mo id="S4.T1.14.m4.1.2.2.2.1" stretchy="false" xref="S4.T1.14.m4.1.2.2.1.1.cmml">|</mo><mi id="S4.T1.14.m4.1.1" xref="S4.T1.14.m4.1.1.cmml">H</mi><mo id="S4.T1.14.m4.1.2.2.2.2" stretchy="false" xref="S4.T1.14.m4.1.2.2.1.1.cmml">|</mo></mrow><mo id="S4.T1.14.m4.1.2.1" xref="S4.T1.14.m4.1.2.1.cmml">=</mo><mn id="S4.T1.14.m4.1.2.3" xref="S4.T1.14.m4.1.2.3.cmml">8</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.T1.14.m4.1c"><apply id="S4.T1.14.m4.1.2.cmml" xref="S4.T1.14.m4.1.2"><eq id="S4.T1.14.m4.1.2.1.cmml" xref="S4.T1.14.m4.1.2.1"></eq><apply id="S4.T1.14.m4.1.2.2.1.cmml" xref="S4.T1.14.m4.1.2.2.2"><abs id="S4.T1.14.m4.1.2.2.1.1.cmml" xref="S4.T1.14.m4.1.2.2.2.1"></abs><ci id="S4.T1.14.m4.1.1.cmml" xref="S4.T1.14.m4.1.1">𝐻</ci></apply><cn id="S4.T1.14.m4.1.2.3.cmml" type="integer" xref="S4.T1.14.m4.1.2.3">8</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.T1.14.m4.1d">|H|=8</annotation><annotation encoding="application/x-llamapun" id="S4.T1.14.m4.1e">| italic_H | = 8</annotation></semantics></math> to fine-tune other DPO MBR models. DPO-MBR improves both BLEURT and COMET whenever MBR itself improves substantially over the baseline. </figcaption>
</figure>
<div class="ltx_para" id="S4.p5">
<p class="ltx_p" id="S4.p5.1">We investigate two questions:</p>
</div>
<div class="ltx_para" id="S4.p6">
<p class="ltx_p" id="S4.p6.1">(1) Can DPO teach MLLMs to learn their MBR translation preferences?</p>
</div>
<div class="ltx_para" id="S4.p7">
<p class="ltx_p" id="S4.p7.1">(2) Does preference learning with DPO lead to improved translation?</p>
</div>
<section class="ltx_subsection" id="S4.SS1">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.1 </span>DPO Fine-Tuning Teaches a MLLM to Learn Its MBR Preferences</h3>
<div class="ltx_para" id="S4.SS1.p1">
<p class="ltx_p" id="S4.SS1.p1.1">Figure <a class="ltx_ref" href="https://arxiv.org/html/2311.08380v2#S4.F1" title="Figure 1 ‣ 4 DPO MBR Fine-Tuning and MT ‣ Direct Preference Optimization for Neural Machine Translation with Minimum Bayes Risk Decoding"><span class="ltx_text ltx_ref_tag">1</span></a> shows that the reward margins remain positive and, with some fluctuations, increase as fine-tuning proceeds, for all three models. This suggests that DPO MBR fine-tuned models learn to put more probability mass on the winning hypotheses. The larger the margins, the more the models prefer the winning over the losing hypotheses.</p>
</div>
<div class="ltx_para" id="S4.SS1.p2">
<p class="ltx_p" id="S4.SS1.p2.1">To further investigate DPO MBR fine-tuning, we plot the distribution of reward margins on a held-out set, shown in Figure <a class="ltx_ref" href="https://arxiv.org/html/2311.08380v2#S4.F2" title="Figure 2 ‣ 4 DPO MBR Fine-Tuning and MT ‣ Direct Preference Optimization for Neural Machine Translation with Minimum Bayes Risk Decoding"><span class="ltx_text ltx_ref_tag">2</span></a>. The median of the distributions increase consistently as fine-tuning proceeds, indicating that the MBR preferences learned in fine-tuning also generalize to unseen data.</p>
</div>
</section>
<section class="ltx_subsection" id="S4.SS2">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.2 </span>DPO MBR Translation</h3>
<div class="ltx_para" id="S4.SS2.p1">
<p class="ltx_p" id="S4.SS2.p1.4">Table <a class="ltx_ref" href="https://arxiv.org/html/2311.08380v2#S4.T1" title="Table 1 ‣ 4 DPO MBR Fine-Tuning and MT ‣ Direct Preference Optimization for Neural Machine Translation with Minimum Bayes Risk Decoding"><span class="ltx_text ltx_ref_tag">1</span></a> gives our main translation results. Comparing Rows 3 &amp; 4, 7 &amp; 8, and 11 &amp; 12, we can see that DPO MBR fine-tuned models, when decoded with beam search, achieve similar performance in BLEURT and COMET as the base model decoded with MBR. The first two configurations (BLOOMZ-DPO-MBR and BLOOMZ-mt-DPO-MBR) outperform the base model’s beam search results by <math alttext="\approx 4" class="ltx_Math" display="inline" id="S4.SS2.p1.1.m1.1"><semantics id="S4.SS2.p1.1.m1.1a"><mrow id="S4.SS2.p1.1.m1.1.1" xref="S4.SS2.p1.1.m1.1.1.cmml"><mi id="S4.SS2.p1.1.m1.1.1.2" xref="S4.SS2.p1.1.m1.1.1.2.cmml"></mi><mo id="S4.SS2.p1.1.m1.1.1.1" xref="S4.SS2.p1.1.m1.1.1.1.cmml">≈</mo><mn id="S4.SS2.p1.1.m1.1.1.3" xref="S4.SS2.p1.1.m1.1.1.3.cmml">4</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.p1.1.m1.1b"><apply id="S4.SS2.p1.1.m1.1.1.cmml" xref="S4.SS2.p1.1.m1.1.1"><approx id="S4.SS2.p1.1.m1.1.1.1.cmml" xref="S4.SS2.p1.1.m1.1.1.1"></approx><csymbol cd="latexml" id="S4.SS2.p1.1.m1.1.1.2.cmml" xref="S4.SS2.p1.1.m1.1.1.2">absent</csymbol><cn id="S4.SS2.p1.1.m1.1.1.3.cmml" type="integer" xref="S4.SS2.p1.1.m1.1.1.3">4</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p1.1.m1.1c">\approx 4</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.p1.1.m1.1d">≈ 4</annotation></semantics></math> BLEURT and <math alttext="\approx 2" class="ltx_Math" display="inline" id="S4.SS2.p1.2.m2.1"><semantics id="S4.SS2.p1.2.m2.1a"><mrow id="S4.SS2.p1.2.m2.1.1" xref="S4.SS2.p1.2.m2.1.1.cmml"><mi id="S4.SS2.p1.2.m2.1.1.2" xref="S4.SS2.p1.2.m2.1.1.2.cmml"></mi><mo id="S4.SS2.p1.2.m2.1.1.1" xref="S4.SS2.p1.2.m2.1.1.1.cmml">≈</mo><mn id="S4.SS2.p1.2.m2.1.1.3" xref="S4.SS2.p1.2.m2.1.1.3.cmml">2</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.p1.2.m2.1b"><apply id="S4.SS2.p1.2.m2.1.1.cmml" xref="S4.SS2.p1.2.m2.1.1"><approx id="S4.SS2.p1.2.m2.1.1.1.cmml" xref="S4.SS2.p1.2.m2.1.1.1"></approx><csymbol cd="latexml" id="S4.SS2.p1.2.m2.1.1.2.cmml" xref="S4.SS2.p1.2.m2.1.1.2">absent</csymbol><cn id="S4.SS2.p1.2.m2.1.1.3.cmml" type="integer" xref="S4.SS2.p1.2.m2.1.1.3">2</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p1.2.m2.1c">\approx 2</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.p1.2.m2.1d">≈ 2</annotation></semantics></math> COMET scores, and the third configuration outperforms the base mode by <math alttext="\approx 3" class="ltx_Math" display="inline" id="S4.SS2.p1.3.m3.1"><semantics id="S4.SS2.p1.3.m3.1a"><mrow id="S4.SS2.p1.3.m3.1.1" xref="S4.SS2.p1.3.m3.1.1.cmml"><mi id="S4.SS2.p1.3.m3.1.1.2" xref="S4.SS2.p1.3.m3.1.1.2.cmml"></mi><mo id="S4.SS2.p1.3.m3.1.1.1" xref="S4.SS2.p1.3.m3.1.1.1.cmml">≈</mo><mn id="S4.SS2.p1.3.m3.1.1.3" xref="S4.SS2.p1.3.m3.1.1.3.cmml">3</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.p1.3.m3.1b"><apply id="S4.SS2.p1.3.m3.1.1.cmml" xref="S4.SS2.p1.3.m3.1.1"><approx id="S4.SS2.p1.3.m3.1.1.1.cmml" xref="S4.SS2.p1.3.m3.1.1.1"></approx><csymbol cd="latexml" id="S4.SS2.p1.3.m3.1.1.2.cmml" xref="S4.SS2.p1.3.m3.1.1.2">absent</csymbol><cn id="S4.SS2.p1.3.m3.1.1.3.cmml" type="integer" xref="S4.SS2.p1.3.m3.1.1.3">3</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p1.3.m3.1c">\approx 3</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.p1.3.m3.1d">≈ 3</annotation></semantics></math> BLEURT and <math alttext="\approx 2" class="ltx_Math" display="inline" id="S4.SS2.p1.4.m4.1"><semantics id="S4.SS2.p1.4.m4.1a"><mrow id="S4.SS2.p1.4.m4.1.1" xref="S4.SS2.p1.4.m4.1.1.cmml"><mi id="S4.SS2.p1.4.m4.1.1.2" xref="S4.SS2.p1.4.m4.1.1.2.cmml"></mi><mo id="S4.SS2.p1.4.m4.1.1.1" xref="S4.SS2.p1.4.m4.1.1.1.cmml">≈</mo><mn id="S4.SS2.p1.4.m4.1.1.3" xref="S4.SS2.p1.4.m4.1.1.3.cmml">2</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.p1.4.m4.1b"><apply id="S4.SS2.p1.4.m4.1.1.cmml" xref="S4.SS2.p1.4.m4.1.1"><approx id="S4.SS2.p1.4.m4.1.1.1.cmml" xref="S4.SS2.p1.4.m4.1.1.1"></approx><csymbol cd="latexml" id="S4.SS2.p1.4.m4.1.1.2.cmml" xref="S4.SS2.p1.4.m4.1.1.2">absent</csymbol><cn id="S4.SS2.p1.4.m4.1.1.3.cmml" type="integer" xref="S4.SS2.p1.4.m4.1.1.3">2</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p1.4.m4.1c">\approx 2</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.p1.4.m4.1d">≈ 2</annotation></semantics></math> COMET on four out of six test sets. DPO MBR improves the translation ability of BLOOMZ, BLOOMZ-mt across a range of test sets. BLOOMZ-mt shows a notable improvement after DPO MBR fine-tuning, achieving the best performance in BLEURT on four out of six test sets and the best performance in COMET on all six test sets. We note that MBR decoding does not yield consistent improvement on the BLOOMZ-mt-sft model for IWSLT2017, and therefore does not provide a strong signal for DPO fine-tuning. We provide translation performance in BLEU in Appendix <a class="ltx_ref" href="https://arxiv.org/html/2311.08380v2#A1" title="Appendix A Translation Performance in BLEU ‣ Direct Preference Optimization for Neural Machine Translation with Minimum Bayes Risk Decoding"><span class="ltx_text ltx_ref_tag">A</span></a> for reference.</p>
</div>
<figure class="ltx_table" id="S4.T2">
<table class="ltx_tabular ltx_centering ltx_guessed_headers ltx_align_middle" id="S4.T2.1">
<thead class="ltx_thead">
<tr class="ltx_tr" id="S4.T2.1.1">
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_th_row ltx_border_tt" id="S4.T2.1.1.2">#</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="S4.T2.1.1.1"><math alttext="\beta" class="ltx_Math" display="inline" id="S4.T2.1.1.1.m1.1"><semantics id="S4.T2.1.1.1.m1.1a"><mi id="S4.T2.1.1.1.m1.1.1" xref="S4.T2.1.1.1.m1.1.1.cmml">β</mi><annotation-xml encoding="MathML-Content" id="S4.T2.1.1.1.m1.1b"><ci id="S4.T2.1.1.1.m1.1.1.cmml" xref="S4.T2.1.1.1.m1.1.1">𝛽</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.T2.1.1.1.m1.1c">\beta</annotation><annotation encoding="application/x-llamapun" id="S4.T2.1.1.1.m1.1d">italic_β</annotation></semantics></math></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="S4.T2.1.1.3">BLEU</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="S4.T2.1.1.4">BLEURT</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="S4.T2.1.1.5">COMET</th>
</tr>
<tr class="ltx_tr" id="S4.T2.1.2.1">
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_th_row ltx_border_t" id="S4.T2.1.2.1.1">1</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" id="S4.T2.1.2.1.2">(Baseline)</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" id="S4.T2.1.2.1.3">16.4</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" id="S4.T2.1.2.1.4">60.3</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" id="S4.T2.1.2.1.5">77.0</th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr class="ltx_tr" id="S4.T2.1.3.1">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_t" id="S4.T2.1.3.1.1">2</th>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T2.1.3.1.2">0.1</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T2.1.3.1.3">9.9</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T2.1.3.1.4">64.5</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T2.1.3.1.5">71.3</td>
</tr>
<tr class="ltx_tr" id="S4.T2.1.4.2">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row" id="S4.T2.1.4.2.1">3</th>
<td class="ltx_td ltx_align_center" id="S4.T2.1.4.2.2">0.3</td>
<td class="ltx_td ltx_align_center" id="S4.T2.1.4.2.3">11.8</td>
<td class="ltx_td ltx_align_center" id="S4.T2.1.4.2.4">64.8</td>
<td class="ltx_td ltx_align_center" id="S4.T2.1.4.2.5">73.5</td>
</tr>
<tr class="ltx_tr" id="S4.T2.1.5.3">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row" id="S4.T2.1.5.3.1">4</th>
<td class="ltx_td ltx_align_center" id="S4.T2.1.5.3.2">0.5</td>
<td class="ltx_td ltx_align_center" id="S4.T2.1.5.3.3">14.3</td>
<td class="ltx_td ltx_align_center" id="S4.T2.1.5.3.4">64.0</td>
<td class="ltx_td ltx_align_center" id="S4.T2.1.5.3.5">76.1</td>
</tr>
<tr class="ltx_tr" id="S4.T2.1.6.4">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row" id="S4.T2.1.6.4.1">5</th>
<td class="ltx_td ltx_align_center" id="S4.T2.1.6.4.2">0.7</td>
<td class="ltx_td ltx_align_center" id="S4.T2.1.6.4.3">16.4</td>
<td class="ltx_td ltx_align_center" id="S4.T2.1.6.4.4">63.3</td>
<td class="ltx_td ltx_align_center" id="S4.T2.1.6.4.5">77.7</td>
</tr>
<tr class="ltx_tr" id="S4.T2.1.7.5">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_bb" id="S4.T2.1.7.5.1">6</th>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S4.T2.1.7.5.2">0.9</td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S4.T2.1.7.5.3">17.6</td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S4.T2.1.7.5.4">61.8</td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S4.T2.1.7.5.5">77.9</td>
</tr>
</tbody>
</table>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table">Table 2: </span>Effect of regularization parameter <math alttext="\beta" class="ltx_Math" display="inline" id="S4.T2.4.m1.1"><semantics id="S4.T2.4.m1.1b"><mi id="S4.T2.4.m1.1.1" xref="S4.T2.4.m1.1.1.cmml">β</mi><annotation-xml encoding="MathML-Content" id="S4.T2.4.m1.1c"><ci id="S4.T2.4.m1.1.1.cmml" xref="S4.T2.4.m1.1.1">𝛽</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.T2.4.m1.1d">\beta</annotation><annotation encoding="application/x-llamapun" id="S4.T2.4.m1.1e">italic_β</annotation></semantics></math> for DPO MBR fine-tuning of BLOOMZ-mt using CPS with <math alttext="|H|=8" class="ltx_Math" display="inline" id="S4.T2.5.m2.1"><semantics id="S4.T2.5.m2.1b"><mrow id="S4.T2.5.m2.1.2" xref="S4.T2.5.m2.1.2.cmml"><mrow id="S4.T2.5.m2.1.2.2.2" xref="S4.T2.5.m2.1.2.2.1.cmml"><mo id="S4.T2.5.m2.1.2.2.2.1" stretchy="false" xref="S4.T2.5.m2.1.2.2.1.1.cmml">|</mo><mi id="S4.T2.5.m2.1.1" xref="S4.T2.5.m2.1.1.cmml">H</mi><mo id="S4.T2.5.m2.1.2.2.2.2" stretchy="false" xref="S4.T2.5.m2.1.2.2.1.1.cmml">|</mo></mrow><mo id="S4.T2.5.m2.1.2.1" xref="S4.T2.5.m2.1.2.1.cmml">=</mo><mn id="S4.T2.5.m2.1.2.3" xref="S4.T2.5.m2.1.2.3.cmml">8</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.T2.5.m2.1c"><apply id="S4.T2.5.m2.1.2.cmml" xref="S4.T2.5.m2.1.2"><eq id="S4.T2.5.m2.1.2.1.cmml" xref="S4.T2.5.m2.1.2.1"></eq><apply id="S4.T2.5.m2.1.2.2.1.cmml" xref="S4.T2.5.m2.1.2.2.2"><abs id="S4.T2.5.m2.1.2.2.1.1.cmml" xref="S4.T2.5.m2.1.2.2.2.1"></abs><ci id="S4.T2.5.m2.1.1.cmml" xref="S4.T2.5.m2.1.1">𝐻</ci></apply><cn id="S4.T2.5.m2.1.2.3.cmml" type="integer" xref="S4.T2.5.m2.1.2.3">8</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.T2.5.m2.1d">|H|=8</annotation><annotation encoding="application/x-llamapun" id="S4.T2.5.m2.1e">| italic_H | = 8</annotation></semantics></math>. Models are fine-tuned on WMT20 zh-en and evaluated on WMT21 zh-en.</figcaption>
</figure>
<section class="ltx_subsubsection" id="S4.SS2.SSS1">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">4.2.1 </span>KL-Divergence Regularization</h4>
<div class="ltx_para" id="S4.SS2.SSS1.p1">
<p class="ltx_p" id="S4.SS2.SSS1.p1.3">We investigated the role of <math alttext="\beta" class="ltx_Math" display="inline" id="S4.SS2.SSS1.p1.1.m1.1"><semantics id="S4.SS2.SSS1.p1.1.m1.1a"><mi id="S4.SS2.SSS1.p1.1.m1.1.1" xref="S4.SS2.SSS1.p1.1.m1.1.1.cmml">β</mi><annotation-xml encoding="MathML-Content" id="S4.SS2.SSS1.p1.1.m1.1b"><ci id="S4.SS2.SSS1.p1.1.m1.1.1.cmml" xref="S4.SS2.SSS1.p1.1.m1.1.1">𝛽</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.SSS1.p1.1.m1.1c">\beta</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.SSS1.p1.1.m1.1d">italic_β</annotation></semantics></math>, the KL-divergence regularization factor, in DPO. Table <a class="ltx_ref" href="https://arxiv.org/html/2311.08380v2#S4.T2" title="Table 2 ‣ 4.2 DPO MBR Translation ‣ 4 DPO MBR Fine-Tuning and MT ‣ Direct Preference Optimization for Neural Machine Translation with Minimum Bayes Risk Decoding"><span class="ltx_text ltx_ref_tag">2</span></a> shows that fine-tuning with small <math alttext="\beta" class="ltx_Math" display="inline" id="S4.SS2.SSS1.p1.2.m2.1"><semantics id="S4.SS2.SSS1.p1.2.m2.1a"><mi id="S4.SS2.SSS1.p1.2.m2.1.1" xref="S4.SS2.SSS1.p1.2.m2.1.1.cmml">β</mi><annotation-xml encoding="MathML-Content" id="S4.SS2.SSS1.p1.2.m2.1b"><ci id="S4.SS2.SSS1.p1.2.m2.1.1.cmml" xref="S4.SS2.SSS1.p1.2.m2.1.1">𝛽</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.SSS1.p1.2.m2.1c">\beta</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.SSS1.p1.2.m2.1d">italic_β</annotation></semantics></math> values yields high BLEURT score (exceeding 64), but also a degradation in BLEU and COMET. Anecdotally, we find that small values of <math alttext="\beta" class="ltx_Math" display="inline" id="S4.SS2.SSS1.p1.3.m3.1"><semantics id="S4.SS2.SSS1.p1.3.m3.1a"><mi id="S4.SS2.SSS1.p1.3.m3.1.1" xref="S4.SS2.SSS1.p1.3.m3.1.1.cmml">β</mi><annotation-xml encoding="MathML-Content" id="S4.SS2.SSS1.p1.3.m3.1b"><ci id="S4.SS2.SSS1.p1.3.m3.1.1.cmml" xref="S4.SS2.SSS1.p1.3.m3.1.1">𝛽</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.SSS1.p1.3.m3.1c">\beta</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.SSS1.p1.3.m3.1d">italic_β</annotation></semantics></math> lead to repetitive outputs that are penalised heavily under BLEU and COMET.
Gains in BLEU, BLEURT, and COMET are readily found, but
we conclude that DPO MBR fine-tuning requires some care in regularization.</p>
</div>
<figure class="ltx_table" id="S4.T3">
<table class="ltx_tabular ltx_centering ltx_guessed_headers ltx_align_middle" id="S4.T3.1">
<thead class="ltx_thead">
<tr class="ltx_tr" id="S4.T3.1.1.1">
<th class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_th_row ltx_border_tt" id="S4.T3.1.1.1.1">Selection Strategy</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="S4.T3.1.1.1.2">|H|=8</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="S4.T3.1.1.1.3">|H|=16</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="S4.T3.1.1.1.4">|H|=32</th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr class="ltx_tr" id="S4.T3.1.2.1">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t" id="S4.T3.1.2.1.1">BW</th>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T3.1.2.1.2">63.3</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T3.1.2.1.3">63.9</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T3.1.2.1.4">63.9</td>
</tr>
<tr class="ltx_tr" id="S4.T3.1.3.2">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="S4.T3.1.3.2.1">BMW</th>
<td class="ltx_td ltx_align_center" id="S4.T3.1.3.2.2">63.9</td>
<td class="ltx_td ltx_align_center" id="S4.T3.1.3.2.3">64.2</td>
<td class="ltx_td ltx_align_center" id="S4.T3.1.3.2.4">63.6</td>
</tr>
<tr class="ltx_tr" id="S4.T3.1.4.3">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row" id="S4.T3.1.4.3.1">CP</th>
<td class="ltx_td ltx_align_center" id="S4.T3.1.4.3.2">62.5</td>
<td class="ltx_td ltx_align_center" id="S4.T3.1.4.3.3">62.4</td>
<td class="ltx_td ltx_align_center" id="S4.T3.1.4.3.4">60.4</td>
</tr>
<tr class="ltx_tr" id="S4.T3.1.5.4">
<th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_bb" id="S4.T3.1.5.4.1">CPS (strides of 2, 4, and 8)</th>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S4.T3.1.5.4.2">62.3</td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S4.T3.1.5.4.3">63.5</td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S4.T3.1.5.4.4">62.9</td>
</tr>
</tbody>
</table>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table">Table 3: </span>WMT21 Zh-En BLEURT scores for BLOOMZ with DPO MBR fine-tuning with different preference pair selection strategies and hypothesis set sizes. The CP strategy results in lower performance in BLEURT compared to other strategies.</figcaption>
</figure>
</section>
<section class="ltx_subsubsection" id="S4.SS2.SSS2">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">4.2.2 </span>Effects of Pair Selection Strategy</h4>
<div class="ltx_para" id="S4.SS2.SSS2.p1">
<p class="ltx_p" id="S4.SS2.SSS2.p1.1">Table <a class="ltx_ref" href="https://arxiv.org/html/2311.08380v2#S4.T3" title="Table 3 ‣ 4.2.1 KL-Divergence Regularization ‣ 4.2 DPO MBR Translation ‣ 4 DPO MBR Fine-Tuning and MT ‣ Direct Preference Optimization for Neural Machine Translation with Minimum Bayes Risk Decoding"><span class="ltx_text ltx_ref_tag">3</span></a> shows that models trained on preference datasets constructed with the BW, BMW, and CPS pair selection strategies achieve similar performance on WMT21 Zh-En, with BLEURT scores in the range 62.9-63.9. DPO MBR appears robust to the selection of preference pairs. In terms of training efficiency, the BW and BMW strategies require fewer preference pairs (1 and 2 per source sentence, resp.) compared to the CPS strategy. However, these results show that some selection strategy is necessary since simply including all the pairs as in the CP strategy leads to degradation.</p>
</div>
</section>
<section class="ltx_subsubsection" id="S4.SS2.SSS3">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">4.2.3 </span>Effects of Size of Hypothesis Set</h4>
<div class="ltx_para" id="S4.SS2.SSS3.p1">
<p class="ltx_p" id="S4.SS2.SSS3.p1.1">Table <a class="ltx_ref" href="https://arxiv.org/html/2311.08380v2#S4.T3" title="Table 3 ‣ 4.2.1 KL-Divergence Regularization ‣ 4.2 DPO MBR Translation ‣ 4 DPO MBR Fine-Tuning and MT ‣ Direct Preference Optimization for Neural Machine Translation with Minimum Bayes Risk Decoding"><span class="ltx_text ltx_ref_tag">3</span></a> shows that the number of hypotheses needed in the training preference dataset is less than that needed for MBR decoding (Rows 3 &amp; 7 in Table <a class="ltx_ref" href="https://arxiv.org/html/2311.08380v2#S4.T1" title="Table 1 ‣ 4 DPO MBR Fine-Tuning and MT ‣ Direct Preference Optimization for Neural Machine Translation with Minimum Bayes Risk Decoding"><span class="ltx_text ltx_ref_tag">1</span></a>). The best performance (BLEURT of 63.9) can be achieved with 16 hypotheses for the BW strategy and 8 hypotheses for the BMW strategy, an improvement over MBR decoding of the base model with <math alttext="|H|=8" class="ltx_Math" display="inline" id="S4.SS2.SSS3.p1.1.m1.1"><semantics id="S4.SS2.SSS3.p1.1.m1.1a"><mrow id="S4.SS2.SSS3.p1.1.m1.1.2" xref="S4.SS2.SSS3.p1.1.m1.1.2.cmml"><mrow id="S4.SS2.SSS3.p1.1.m1.1.2.2.2" xref="S4.SS2.SSS3.p1.1.m1.1.2.2.1.cmml"><mo id="S4.SS2.SSS3.p1.1.m1.1.2.2.2.1" stretchy="false" xref="S4.SS2.SSS3.p1.1.m1.1.2.2.1.1.cmml">|</mo><mi id="S4.SS2.SSS3.p1.1.m1.1.1" xref="S4.SS2.SSS3.p1.1.m1.1.1.cmml">H</mi><mo id="S4.SS2.SSS3.p1.1.m1.1.2.2.2.2" stretchy="false" xref="S4.SS2.SSS3.p1.1.m1.1.2.2.1.1.cmml">|</mo></mrow><mo id="S4.SS2.SSS3.p1.1.m1.1.2.1" xref="S4.SS2.SSS3.p1.1.m1.1.2.1.cmml">=</mo><mn id="S4.SS2.SSS3.p1.1.m1.1.2.3" xref="S4.SS2.SSS3.p1.1.m1.1.2.3.cmml">8</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.SSS3.p1.1.m1.1b"><apply id="S4.SS2.SSS3.p1.1.m1.1.2.cmml" xref="S4.SS2.SSS3.p1.1.m1.1.2"><eq id="S4.SS2.SSS3.p1.1.m1.1.2.1.cmml" xref="S4.SS2.SSS3.p1.1.m1.1.2.1"></eq><apply id="S4.SS2.SSS3.p1.1.m1.1.2.2.1.cmml" xref="S4.SS2.SSS3.p1.1.m1.1.2.2.2"><abs id="S4.SS2.SSS3.p1.1.m1.1.2.2.1.1.cmml" xref="S4.SS2.SSS3.p1.1.m1.1.2.2.2.1"></abs><ci id="S4.SS2.SSS3.p1.1.m1.1.1.cmml" xref="S4.SS2.SSS3.p1.1.m1.1.1">𝐻</ci></apply><cn id="S4.SS2.SSS3.p1.1.m1.1.2.3.cmml" type="integer" xref="S4.SS2.SSS3.p1.1.m1.1.2.3">8</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.SSS3.p1.1.m1.1c">|H|=8</annotation><annotation encoding="application/x-llamapun" id="S4.SS2.SSS3.p1.1.m1.1d">| italic_H | = 8</annotation></semantics></math> (Row 2 &amp; 6 in Table <a class="ltx_ref" href="https://arxiv.org/html/2311.08380v2#S4.T1" title="Table 1 ‣ 4 DPO MBR Fine-Tuning and MT ‣ Direct Preference Optimization for Neural Machine Translation with Minimum Bayes Risk Decoding"><span class="ltx_text ltx_ref_tag">1</span></a>).</p>
</div>
</section>
</section>
</section>
<section class="ltx_section" id="S5">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">5 </span>Conclusion</h2>
<div class="ltx_para" id="S5.p1">
<p class="ltx_p" id="S5.p1.1">We introduce DPO MBR fine-tuning, an unsupervised preference optimization algorithm that leverages the ranked lists from MBR decoding to teach MLLMs the preference of MBR decoding. Our method enables MLLMs to achieve significant performance improvement when decoded with beam search in one pass, on par with the performance gained from two-pass MBR decoding<span class="ltx_note ltx_role_footnote" id="footnote1"><sup class="ltx_note_mark">1</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">1</sup><span class="ltx_tag ltx_tag_note">1</span>Codes are available at <a class="ltx_ref ltx_url ltx_font_typewriter" href="https://github.com/BruceYg/DPO-MBR" title="">https://github.com/BruceYg/DPO-MBR</a></span></span></span>.</p>
</div>
</section>
<section class="ltx_section" id="S6">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">6 </span>Acknowledgement</h2>
<div class="ltx_para" id="S6.p1">
<p class="ltx_p" id="S6.p1.1">Jinghong Chen is supported by the Warwick Postgraduate Studentship from Christ’s College and the Huawei Hisilicon Studentship for the undertaking of the PhD in Engineering at the University of Cambridge.</p>
</div>
<div class="ltx_para" id="S6.p2">
<p class="ltx_p" id="S6.p2.1">Weizhe Lin was supported by a Research Studentship funded by Toyota Motor Europe (RG92562(24020)).</p>
</div>
<div class="ltx_para" id="S6.p3">
<p class="ltx_p" id="S6.p3.1">Prof. Bill Byrne holds concurrent appointments as a Professor of Information Engineering at Cambridge University and as an Amazon Scholar. This publication describes work performed at Cambridge University and is not associated with Amazon.</p>
</div>
<div class="ltx_para" id="S6.p4">
<p class="ltx_p" id="S6.p4.1">We would also like to thank all the reviewers for their knowledgeable reviews.</p>
</div>
</section>
<section class="ltx_section" id="S7">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">7 </span>Limitations</h2>
<div class="ltx_para" id="S7.p1">
<p class="ltx_p" id="S7.p1.1">Our method was evaluated on WMT 2021 and WMT 2022 and IWSLT 2017 test sets, with high-resource languages only (English, Chinese, and French). While our fine-tuned models performed well on these diverse test sets, behaviour may be different on medium-resource or low-resource languages or on other domains.</p>
</div>
<div class="ltx_para" id="S7.p2">
<p class="ltx_p" id="S7.p2.1">Our experiments focus on BLOOMZ and BLOOMZ-mt due to the ease of working with them and because BLOOMZ-mt is fine-tuned for translation. Other (M)LLMs may yield different results.</p>
</div>
<div class="ltx_para" id="S7.p3">
<p class="ltx_p" id="S7.p3.1">We report MBR results using simple ancestral sampling. Other work <cite class="ltx_cite ltx_citemacro_cite">Freitag et al. (<a class="ltx_ref" href="https://arxiv.org/html/2311.08380v2#bib.bib7" title="">2023</a>)</cite> has found that there may be advantages in using other sampling schemes, such as epsilon sampling, for MBR. Those other sampling methods potentially offer further gains beyond what we have already shown.</p>
</div>
<div class="ltx_para" id="S7.p4">
<p class="ltx_p" id="S7.p4.1">We do not report human assessments of translation quality to verify improvements, but we note that <cite class="ltx_cite ltx_citemacro_citet">Freitag et al. (<a class="ltx_ref" href="https://arxiv.org/html/2311.08380v2#bib.bib8" title="">2022</a>)</cite> have reported extensive results showing that MBR decoding under BLEURT leads to improvements in translation quality as assessed by human judges. We therefore take improvement in BLEURT as our main measurement of improved translation quality.</p>
</div>
</section>
<section class="ltx_section" id="S8">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">8 </span>Risks</h2>
<div class="ltx_para" id="S8.p1">
<p class="ltx_p" id="S8.p1.1">Our unsupervised fine-tuning technique could potentially amplify undesirable biases or language already present in the baseline systems. This could possibly happen if the MBR utility function, in our case BLEURT, somehow encourages consensus amongst similar translations that are also undesirable. Mitigation should be straightforward, in that any monitoring of the baseline models could also be applied after DPO MBR fine-tuning to reject fine-tuned models that exhibit any increase in bad behaviour. Although it is not a focus of this work, DPO MBR could possibly be used as a strategy for risk mitigation by penalizing undesirable behaviour through introduction of specific penalties into the MBR utility function.</p>
</div>
</section>
<section class="ltx_bibliography" id="bib">
<h2 class="ltx_title ltx_title_bibliography">References</h2>
<ul class="ltx_biblist">
<li class="ltx_bibitem" id="bib.bib1">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Akhbardeh et al. (2021)</span>
<span class="ltx_bibblock">
Farhad Akhbardeh, Arkady Arkhangorodsky, Magdalena Biesialska, Ondřej Bojar, Rajen Chatterjee, Vishrav Chaudhary, Marta R. Costa-jussa, Cristina España-Bonet, Angela Fan, Christian Federmann, Markus Freitag, Yvette Graham, Roman Grundkiewicz, Barry Haddow, Leonie Harter, Kenneth Heafield, Christopher Homan, Matthias Huck, Kwabena Amponsah-Kaakyire, Jungo Kasai, Daniel Khashabi, Kevin Knight, Tom Kocmi, Philipp Koehn, Nicholas Lourie, Christof Monz, Makoto Morishita, Masaaki Nagata, Ajay Nagesh, Toshiaki Nakazawa, Matteo Negri, Santanu Pal, Allahsera Auguste Tapo, Marco Turchi, Valentin Vydrin, and Marcos Zampieri. 2021.

</span>
<span class="ltx_bibblock"><a class="ltx_ref ltx_href" href="https://aclanthology.org/2021.wmt-1.1" title="">Findings of the 2021 conference on machine translation (WMT21)</a>.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib1.1.1">Proceedings of the Sixth Conference on Machine Translation</em>, pages 1–88, Online. Association for Computational Linguistics.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib2">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Barrault et al. (2020)</span>
<span class="ltx_bibblock">
Loïc Barrault, Magdalena Biesialska, Ondřej Bojar, Marta R. Costa-jussà, Christian Federmann, Yvette Graham, Roman Grundkiewicz, Barry Haddow, Matthias Huck, Eric Joanis, Tom Kocmi, Philipp Koehn, Chi-kiu Lo, Nikola Ljubešić, Christof Monz, Makoto Morishita, Masaaki Nagata, Toshiaki Nakazawa, Santanu Pal, Matt Post, and Marcos Zampieri. 2020.

</span>
<span class="ltx_bibblock"><a class="ltx_ref ltx_href" href="https://aclanthology.org/2020.wmt-1.1" title="">Findings of the 2020 conference on machine translation (WMT20)</a>.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib2.1.1">Proceedings of the Fifth Conference on Machine Translation</em>, pages 1–55, Online. Association for Computational Linguistics.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib3">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Cettolo et al. (2017)</span>
<span class="ltx_bibblock">
Mauro Cettolo, Marcello Federico, Luisa Bentivogli, Jan Niehues, Sebastian Stüker, Katsuhito Sudoh, Koichiro Yoshino, and Christian Federmann. 2017.

</span>
<span class="ltx_bibblock"><a class="ltx_ref ltx_href" href="https://aclanthology.org/2017.iwslt-1.1" title="">Overview of the IWSLT 2017 evaluation campaign</a>.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib3.1.1">Proceedings of the 14th International Conference on Spoken Language Translation</em>, pages 2–14, Tokyo, Japan. International Workshop on Spoken Language Translation.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib4">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Dong et al. (2023)</span>
<span class="ltx_bibblock">
Hanze Dong, Wei Xiong, Deepanshu Goyal, Yihan Zhang, Winnie Chow, Rui Pan, Shizhe Diao, Jipeng Zhang, Kashun Shum, and Tong Zhang. 2023.

</span>
<span class="ltx_bibblock"><a class="ltx_ref ltx_href" href="http://arxiv.org/abs/2304.06767" title="">RAFT: Reward ranked finetuning for generative foundation model alignment</a>.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib5">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Eikema and Aziz (2022)</span>
<span class="ltx_bibblock">
Bryan Eikema and Wilker Aziz. 2022.

</span>
<span class="ltx_bibblock"><a class="ltx_ref ltx_href" href="https://doi.org/10.18653/v1/2022.emnlp-main.754" title="">Sampling-based approximations to minimum Bayes risk decoding for neural machine translation</a>.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib5.1.1">Proceedings of the 2022 Conference on Empirical Methods in Natural Language Processing</em>, pages 10978–10993, Abu Dhabi, United Arab Emirates. Association for Computational Linguistics.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib6">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Finkelstein et al. (2023)</span>
<span class="ltx_bibblock">
Mara Finkelstein, Subhajit Naskar, Mehdi Mirzazadeh, Apurva Shah, and Markus Freitag. 2023.

</span>
<span class="ltx_bibblock"><a class="ltx_ref ltx_href" href="http://arxiv.org/abs/2309.10966" title="">MBR and QE finetuning: Training-time distillation of the best and most expensive decoding methods</a>.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib7">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Freitag et al. (2023)</span>
<span class="ltx_bibblock">
Markus Freitag, Behrooz Ghorbani, and Patrick Fernandes. 2023.

</span>
<span class="ltx_bibblock"><a class="ltx_ref ltx_href" href="http://arxiv.org/abs/2305.09860" title="">Epsilon sampling rocks: Investigating sampling strategies for minimum Bayes risk decoding for machine translation</a>.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib8">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Freitag et al. (2022)</span>
<span class="ltx_bibblock">
Markus Freitag, David Grangier, Qijun Tan, and Bowen Liang. 2022.

</span>
<span class="ltx_bibblock"><a class="ltx_ref ltx_href" href="https://doi.org/10.1162/tacl_a_00491" title="">High quality rather than high model probability: Minimum Bayes risk decoding with neural metrics</a>.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib8.1.1">Transactions of the Association for Computational Linguistics</em>, 10:811–825.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib9">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Garcia et al. (2023)</span>
<span class="ltx_bibblock">
Xavier Garcia, Yamini Bansal, Colin Cherry, George Foster, Maxim Krikun, Fangxiaoyu Feng, Melvin Johnson, and Orhan Firat. 2023.

</span>
<span class="ltx_bibblock"><a class="ltx_ref ltx_href" href="http://arxiv.org/abs/2302.01398" title="">The unreasonable effectiveness of few-shot learning for machine translation</a>.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib10">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Goel and Byrne (2000)</span>
<span class="ltx_bibblock">
Vaibhava Goel and William J Byrne. 2000.

</span>
<span class="ltx_bibblock"><a class="ltx_ref ltx_href" href="https://doi.org/https://doi.org/10.1006/csla.2000.0138" title="">Minimum Bayes-risk automatic speech recognition</a>.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib10.1.1">Computer Speech &amp; Language</em>, 14(2):115–135.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib11">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Gulcehre et al. (2023)</span>
<span class="ltx_bibblock">
Caglar Gulcehre, Tom Le Paine, Srivatsan Srinivasan, Ksenia Konyushkova, Lotte Weerts, Abhishek Sharma, Aditya Siddhant, Alex Ahern, Miaosen Wang, Chenjie Gu, Wolfgang Macherey, Arnaud Doucet, Orhan Firat, and Nando de Freitas. 2023.

</span>
<span class="ltx_bibblock"><a class="ltx_ref ltx_href" href="http://arxiv.org/abs/2308.08998" title="">Reinforced self-training (ReST) for language modeling</a>.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib12">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Kocmi et al. (2022)</span>
<span class="ltx_bibblock">
Tom Kocmi, Rachel Bawden, Ondřej Bojar, Anton Dvorkovich, Christian Federmann, Mark Fishel, Thamme Gowda, Yvette Graham, Roman Grundkiewicz, Barry Haddow, Rebecca Knowles, Philipp Koehn, Christof Monz, Makoto Morishita, Masaaki Nagata, Toshiaki Nakazawa, Michal Novák, Martin Popel, and Maja Popović. 2022.

</span>
<span class="ltx_bibblock"><a class="ltx_ref ltx_href" href="https://aclanthology.org/2022.wmt-1.1" title="">Findings of the 2022 conference on machine translation (WMT22)</a>.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib12.1.1">Proceedings of the Seventh Conference on Machine Translation (WMT)</em>, pages 1–45, Abu Dhabi, United Arab Emirates (Hybrid). Association for Computational Linguistics.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib13">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Kumar and Byrne (2004)</span>
<span class="ltx_bibblock">
Shankar Kumar and William Byrne. 2004.

</span>
<span class="ltx_bibblock"><a class="ltx_ref ltx_href" href="https://aclanthology.org/N04-1022" title="">Minimum Bayes-risk decoding for statistical machine translation</a>.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib13.1.1">Proceedings of the Human Language Technology Conference of the North American Chapter of the Association for Computational Linguistics: HLT-NAACL 2004</em>, pages 169–176, Boston, Massachusetts, USA. Association for Computational Linguistics.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib14">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Lin et al. (2022)</span>
<span class="ltx_bibblock">
Xi Victoria Lin, Todor Mihaylov, Mikel Artetxe, Tianlu Wang, Shuohui Chen, Daniel Simig, Myle Ott, Naman Goyal, Shruti Bhosale, Jingfei Du, Ramakanth Pasunuru, Sam Shleifer, Punit Singh Koura, Vishrav Chaudhary, Brian O’Horo, Jeff Wang, Luke Zettlemoyer, Zornitsa Kozareva, Mona Diab, Veselin Stoyanov, and Xian Li. 2022.

</span>
<span class="ltx_bibblock"><a class="ltx_ref ltx_href" href="https://doi.org/10.18653/v1/2022.emnlp-main.616" title="">Few-shot learning with multilingual generative language models</a>.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib14.1.1">Proceedings of the 2022 Conference on Empirical Methods in Natural Language Processing</em>, pages 9019–9052, Abu Dhabi, United Arab Emirates. Association for Computational Linguistics.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib15">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Muennighoff et al. (2023)</span>
<span class="ltx_bibblock">
Niklas Muennighoff, Thomas Wang, Lintang Sutawika, Adam Roberts, Stella Biderman, Teven Le Scao, M Saiful Bari, Sheng Shen, Zheng Xin Yong, Hailey Schoelkopf, Xiangru Tang, Dragomir Radev, Alham Fikri Aji, Khalid Almubarak, Samuel Albanie, Zaid Alyafeai, Albert Webson, Edward Raff, and Colin Raffel. 2023.

</span>
<span class="ltx_bibblock"><a class="ltx_ref ltx_href" href="https://doi.org/10.18653/v1/2023.acl-long.891" title="">Crosslingual generalization through multitask finetuning</a>.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib15.1.1">Proceedings of the 61st Annual Meeting of the Association for Computational Linguistics (Volume 1: Long Papers)</em>, pages 15991–16111, Toronto, Canada. Association for Computational Linguistics.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib16">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">NLLB Team et al. (2022)</span>
<span class="ltx_bibblock">
NLLB Team, Marta R. Costa-jussà, James Cross, Onur Çelebi, Maha Elbayad, Kenneth Heafield, Kevin Heffernan, Elahe Kalbassi, Janice Lam, Daniel Licht, Jean Maillard, Anna Sun, Skyler Wang, Guillaume Wenzek, Al Youngblood, Bapi Akula, Loic Barrault, Gabriel Mejia Gonzalez, Prangthip Hansanti, John Hoffman, Semarley Jarrett, Kaushik Ram Sadagopan, Dirk Rowe, Shannon Spruit, Chau Tran, Pierre Andrews, Necip Fazil Ayan, Shruti Bhosale, Sergey Edunov, Angela Fan, Cynthia Gao, Vedanuj Goswami, Francisco Guzmán, Philipp Koehn, Alexandre Mourachko, Christophe Ropers, Safiyyah Saleem, Holger Schwenk, and Jeff Wang. 2022.

</span>
<span class="ltx_bibblock"><a class="ltx_ref ltx_href" href="http://arxiv.org/abs/2207.04672" title="">No language left behind: Scaling human-centered machine translation</a>.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib17">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Papineni et al. (2002)</span>
<span class="ltx_bibblock">
Kishore Papineni, Salim Roukos, Todd Ward, and Wei-Jing Zhu. 2002.

</span>
<span class="ltx_bibblock"><a class="ltx_ref ltx_href" href="https://doi.org/10.3115/1073083.1073135" title="">Bleu: a method for automatic evaluation of machine translation</a>.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib17.1.1">Proceedings of the 40th Annual Meeting of the Association for Computational Linguistics</em>, pages 311–318, Philadelphia, Pennsylvania, USA. Association for Computational Linguistics.

</span>
<span class="ltx_bibblock">Implemented in SacreBLEU: <a class="ltx_ref ltx_url ltx_font_typewriter" href="https://github.com/mjpost/sacrebleu" title="">https://github.com/mjpost/sacrebleu</a>.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib18">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Rafailov et al. (2023)</span>
<span class="ltx_bibblock">
Rafael Rafailov, Archit Sharma, Eric Mitchell, Christopher D. Manning, Stefano Ermon, and Chelsea Finn. 2023.

</span>
<span class="ltx_bibblock"><a class="ltx_ref ltx_href" href="http://papers.nips.cc/paper_files/paper/2023/hash/a85b405ed65c6477a4fe8302b5e06ce7-Abstract-Conference.html" title="">Direct preference optimization: Your language model is secretly a reward model</a>.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib18.1.1">Advances in Neural Information Processing Systems 36: Annual Conference on Neural Information Processing Systems 2023, NeurIPS 2023, New Orleans, LA, USA, December 10 - 16, 2023</em>.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib19">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Rei et al. (2022)</span>
<span class="ltx_bibblock">
Ricardo Rei, José G. C. de Souza, Duarte Alves, Chrysoula Zerva, Ana C Farinha, Taisiya Glushkova, Alon Lavie, Luisa Coheur, and André F. T. Martins. 2022.

</span>
<span class="ltx_bibblock"><a class="ltx_ref ltx_href" href="https://aclanthology.org/2022.wmt-1.52" title="">COMET-22: Unbabel-IST 2022 submission for the metrics shared task</a>.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib19.1.1">Proceedings of the Seventh Conference on Machine Translation (WMT)</em>, pages 578–585, Abu Dhabi, United Arab Emirates (Hybrid). Association for Computational Linguistics.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib20">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Rei et al. (2020)</span>
<span class="ltx_bibblock">
Ricardo Rei, Craig Stewart, Ana C Farinha, and Alon Lavie. 2020.

</span>
<span class="ltx_bibblock"><a class="ltx_ref ltx_href" href="https://doi.org/10.18653/v1/2020.emnlp-main.213" title="">COMET: A neural framework for MT evaluation</a>.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib20.1.1">Proceedings of the 2020 Conference on Empirical Methods in Natural Language Processing (EMNLP)</em>, pages 2685–2702, Online. Association for Computational Linguistics.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib21">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Sellam et al. (2020)</span>
<span class="ltx_bibblock">
Thibault Sellam, Dipanjan Das, and Ankur Parikh. 2020.

</span>
<span class="ltx_bibblock"><a class="ltx_ref ltx_href" href="https://doi.org/10.18653/v1/2020.acl-main.704" title="">BLEURT: Learning robust metrics for text generation</a>.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib21.1.1">Proceedings of the 58th Annual Meeting of the Association for Computational Linguistics</em>, pages 7881–7892, Online. Association for Computational Linguistics.

</span>
<span class="ltx_bibblock">Implemented in <a class="ltx_ref ltx_url ltx_font_typewriter" href="https://github.com/google-research/bleurt" title="">https://github.com/google-research/bleurt</a>.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib22">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Suzgun et al. (2023)</span>
<span class="ltx_bibblock">
Mirac Suzgun, Luke Melas-Kyriazi, and Dan Jurafsky. 2023.

</span>
<span class="ltx_bibblock"><a class="ltx_ref ltx_href" href="https://doi.org/10.18653/v1/2023.findings-acl.262" title="">Follow the wisdom of the crowd: Effective text generation via minimum Bayes risk decoding</a>.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib22.1.1">Findings of the Association for Computational Linguistics: ACL 2023</em>, pages 4265–4293, Toronto, Canada. Association for Computational Linguistics.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib23">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Tiedemann (2020)</span>
<span class="ltx_bibblock">
Jörg Tiedemann. 2020.

</span>
<span class="ltx_bibblock"><a class="ltx_ref ltx_href" href="https://aclanthology.org/2020.wmt-1.139" title="">The Tatoeba Translation Challenge – Realistic data sets for low resource and multilingual MT</a>.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib23.1.1">Proceedings of the Fifth Conference on Machine Translation</em>, pages 1174–1182, Online. Association for Computational Linguistics.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib24">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Yang (2023)</span>
<span class="ltx_bibblock">
Guangyu Yang. 2023.

</span>
<span class="ltx_bibblock"><a class="ltx_ref ltx_href" href="https://www.mlmi.eng.cam.ac.uk/files/2022_-_2023_dissertations/multilingual_models_in_neural_machine_translation.pdf" title="">Multilingual models in neural machine translation</a>.

</span>
<span class="ltx_bibblock">Dissertation submitted for the MPhil in Machine Learning and Machine Intelligence, University of Cambridge.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib25">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Zeng et al. (2023a)</span>
<span class="ltx_bibblock">
Aohan Zeng, Xiao Liu, Zhengxiao Du, Zihan Wang, Hanyu Lai, Ming Ding, Zhuoyi Yang, Yifan Xu, Wendi Zheng, Xiao Xia, Weng Lam Tam, Zixuan Ma, Yufei Xue, Jidong Zhai, Wenguang Chen, Peng Zhang, Yuxiao Dong, and Jie Tang. 2023a.

</span>
<span class="ltx_bibblock"><a class="ltx_ref ltx_href" href="http://arxiv.org/abs/2210.02414" title="">GLM-130B: An open bilingual pre-trained model</a>.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib26">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Zeng et al. (2023b)</span>
<span class="ltx_bibblock">
Jiali Zeng, Fandong Meng, Yongjing Yin, and Jie Zhou. 2023b.

</span>
<span class="ltx_bibblock"><a class="ltx_ref ltx_href" href="http://arxiv.org/abs/2307.04408" title="">TIM: Teaching large language models to translate with comparison</a>.

</span>
</li>
</ul>
</section>
<figure class="ltx_table" id="S8.T4">
<table class="ltx_tabular ltx_centering ltx_guessed_headers ltx_align_middle" id="S8.T4.6">
<thead class="ltx_thead">
<tr class="ltx_tr" id="S8.T4.6.7.1">
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="S8.T4.6.7.1.1" rowspan="2"><span class="ltx_text" id="S8.T4.6.7.1.1.1">#</span></th>
<th class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_border_tt" id="S8.T4.6.7.1.2" rowspan="2"><span class="ltx_text" id="S8.T4.6.7.1.2.1">Model (Decoding)</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" colspan="2" id="S8.T4.6.7.1.3">WMT21</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" colspan="2" id="S8.T4.6.7.1.4">WMT22</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" colspan="2" id="S8.T4.6.7.1.5">IWSLT17</th>
</tr>
<tr class="ltx_tr" id="S8.T4.6.8.2">
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" id="S8.T4.6.8.2.1">zh-en</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" id="S8.T4.6.8.2.2">en-zh</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" id="S8.T4.6.8.2.3">zh-en</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" id="S8.T4.6.8.2.4">en-zh</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" id="S8.T4.6.8.2.5">fr-en</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" id="S8.T4.6.8.2.6">en-fr</th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr class="ltx_tr" id="S8.T4.6.9.1">
<td class="ltx_td ltx_align_center ltx_border_t" id="S8.T4.6.9.1.1">1</td>
<td class="ltx_td ltx_align_left ltx_border_t" id="S8.T4.6.9.1.2">BLOOMZ (Beam)</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S8.T4.6.9.1.3">15.8</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S8.T4.6.9.1.4">22.3</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S8.T4.6.9.1.5">14.0</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S8.T4.6.9.1.6">22.2</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S8.T4.6.9.1.7">38.1</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S8.T4.6.9.1.8">37.6</td>
</tr>
<tr class="ltx_tr" id="S8.T4.1.1">
<td class="ltx_td ltx_align_center" id="S8.T4.1.1.2">2</td>
<td class="ltx_td ltx_align_left" id="S8.T4.1.1.1">BLOOMZ (MBR <math alttext="|H|=8" class="ltx_Math" display="inline" id="S8.T4.1.1.1.m1.1"><semantics id="S8.T4.1.1.1.m1.1a"><mrow id="S8.T4.1.1.1.m1.1.2" xref="S8.T4.1.1.1.m1.1.2.cmml"><mrow id="S8.T4.1.1.1.m1.1.2.2.2" xref="S8.T4.1.1.1.m1.1.2.2.1.cmml"><mo id="S8.T4.1.1.1.m1.1.2.2.2.1" stretchy="false" xref="S8.T4.1.1.1.m1.1.2.2.1.1.cmml">|</mo><mi id="S8.T4.1.1.1.m1.1.1" xref="S8.T4.1.1.1.m1.1.1.cmml">H</mi><mo id="S8.T4.1.1.1.m1.1.2.2.2.2" stretchy="false" xref="S8.T4.1.1.1.m1.1.2.2.1.1.cmml">|</mo></mrow><mo id="S8.T4.1.1.1.m1.1.2.1" xref="S8.T4.1.1.1.m1.1.2.1.cmml">=</mo><mn id="S8.T4.1.1.1.m1.1.2.3" xref="S8.T4.1.1.1.m1.1.2.3.cmml">8</mn></mrow><annotation-xml encoding="MathML-Content" id="S8.T4.1.1.1.m1.1b"><apply id="S8.T4.1.1.1.m1.1.2.cmml" xref="S8.T4.1.1.1.m1.1.2"><eq id="S8.T4.1.1.1.m1.1.2.1.cmml" xref="S8.T4.1.1.1.m1.1.2.1"></eq><apply id="S8.T4.1.1.1.m1.1.2.2.1.cmml" xref="S8.T4.1.1.1.m1.1.2.2.2"><abs id="S8.T4.1.1.1.m1.1.2.2.1.1.cmml" xref="S8.T4.1.1.1.m1.1.2.2.2.1"></abs><ci id="S8.T4.1.1.1.m1.1.1.cmml" xref="S8.T4.1.1.1.m1.1.1">𝐻</ci></apply><cn id="S8.T4.1.1.1.m1.1.2.3.cmml" type="integer" xref="S8.T4.1.1.1.m1.1.2.3">8</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S8.T4.1.1.1.m1.1c">|H|=8</annotation><annotation encoding="application/x-llamapun" id="S8.T4.1.1.1.m1.1d">| italic_H | = 8</annotation></semantics></math>)</td>
<td class="ltx_td ltx_align_center" id="S8.T4.1.1.3">11.3</td>
<td class="ltx_td ltx_align_center" id="S8.T4.1.1.4">19.7</td>
<td class="ltx_td ltx_align_center" id="S8.T4.1.1.5">11.6</td>
<td class="ltx_td ltx_align_center" id="S8.T4.1.1.6">20.3</td>
<td class="ltx_td ltx_align_center" id="S8.T4.1.1.7">34.2</td>
<td class="ltx_td ltx_align_center" id="S8.T4.1.1.8">32.6</td>
</tr>
<tr class="ltx_tr" id="S8.T4.2.2">
<td class="ltx_td ltx_align_center" id="S8.T4.2.2.2">3</td>
<td class="ltx_td ltx_align_left" id="S8.T4.2.2.1">BLOOMZ (MBR <math alttext="|H|=32" class="ltx_Math" display="inline" id="S8.T4.2.2.1.m1.1"><semantics id="S8.T4.2.2.1.m1.1a"><mrow id="S8.T4.2.2.1.m1.1.2" xref="S8.T4.2.2.1.m1.1.2.cmml"><mrow id="S8.T4.2.2.1.m1.1.2.2.2" xref="S8.T4.2.2.1.m1.1.2.2.1.cmml"><mo id="S8.T4.2.2.1.m1.1.2.2.2.1" stretchy="false" xref="S8.T4.2.2.1.m1.1.2.2.1.1.cmml">|</mo><mi id="S8.T4.2.2.1.m1.1.1" xref="S8.T4.2.2.1.m1.1.1.cmml">H</mi><mo id="S8.T4.2.2.1.m1.1.2.2.2.2" stretchy="false" xref="S8.T4.2.2.1.m1.1.2.2.1.1.cmml">|</mo></mrow><mo id="S8.T4.2.2.1.m1.1.2.1" xref="S8.T4.2.2.1.m1.1.2.1.cmml">=</mo><mn id="S8.T4.2.2.1.m1.1.2.3" xref="S8.T4.2.2.1.m1.1.2.3.cmml">32</mn></mrow><annotation-xml encoding="MathML-Content" id="S8.T4.2.2.1.m1.1b"><apply id="S8.T4.2.2.1.m1.1.2.cmml" xref="S8.T4.2.2.1.m1.1.2"><eq id="S8.T4.2.2.1.m1.1.2.1.cmml" xref="S8.T4.2.2.1.m1.1.2.1"></eq><apply id="S8.T4.2.2.1.m1.1.2.2.1.cmml" xref="S8.T4.2.2.1.m1.1.2.2.2"><abs id="S8.T4.2.2.1.m1.1.2.2.1.1.cmml" xref="S8.T4.2.2.1.m1.1.2.2.2.1"></abs><ci id="S8.T4.2.2.1.m1.1.1.cmml" xref="S8.T4.2.2.1.m1.1.1">𝐻</ci></apply><cn id="S8.T4.2.2.1.m1.1.2.3.cmml" type="integer" xref="S8.T4.2.2.1.m1.1.2.3">32</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S8.T4.2.2.1.m1.1c">|H|=32</annotation><annotation encoding="application/x-llamapun" id="S8.T4.2.2.1.m1.1d">| italic_H | = 32</annotation></semantics></math>)</td>
<td class="ltx_td ltx_align_center" id="S8.T4.2.2.3">12.6</td>
<td class="ltx_td ltx_align_center" id="S8.T4.2.2.4">20.2</td>
<td class="ltx_td ltx_align_center" id="S8.T4.2.2.5">12.4</td>
<td class="ltx_td ltx_align_center" id="S8.T4.2.2.6">21.2</td>
<td class="ltx_td ltx_align_center" id="S8.T4.2.2.7">36.3</td>
<td class="ltx_td ltx_align_center" id="S8.T4.2.2.8">34.1</td>
</tr>
<tr class="ltx_tr" id="S8.T4.6.10.2">
<td class="ltx_td ltx_align_center" id="S8.T4.6.10.2.1">4</td>
<td class="ltx_td ltx_align_left" id="S8.T4.6.10.2.2">
<span class="ltx_text ltx_font_bold" id="S8.T4.6.10.2.2.1">BLOOMZ-DPO-MBR</span> (Beam)</td>
<td class="ltx_td ltx_align_center" id="S8.T4.6.10.2.3"><span class="ltx_text ltx_font_bold" id="S8.T4.6.10.2.3.1">17.2</span></td>
<td class="ltx_td ltx_align_center" id="S8.T4.6.10.2.4"><span class="ltx_text ltx_font_bold" id="S8.T4.6.10.2.4.1">23.7</span></td>
<td class="ltx_td ltx_align_center" id="S8.T4.6.10.2.5"><span class="ltx_text ltx_font_bold" id="S8.T4.6.10.2.5.1">15.6</span></td>
<td class="ltx_td ltx_align_center" id="S8.T4.6.10.2.6"><span class="ltx_text ltx_font_bold" id="S8.T4.6.10.2.6.1">26.5</span></td>
<td class="ltx_td ltx_align_center" id="S8.T4.6.10.2.7"><span class="ltx_text ltx_font_bold" id="S8.T4.6.10.2.7.1">40.6</span></td>
<td class="ltx_td ltx_align_center" id="S8.T4.6.10.2.8"><span class="ltx_text ltx_font_bold" id="S8.T4.6.10.2.8.1">38.9</span></td>
</tr>
<tr class="ltx_tr" id="S8.T4.6.11.3">
<td class="ltx_td ltx_align_center ltx_border_t" id="S8.T4.6.11.3.1">5</td>
<td class="ltx_td ltx_align_left ltx_border_t" id="S8.T4.6.11.3.2">BLOOMZ-mt (Beam)</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S8.T4.6.11.3.3">16.4</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S8.T4.6.11.3.4">22.5</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S8.T4.6.11.3.5">14.7</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S8.T4.6.11.3.6">26.2</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S8.T4.6.11.3.7">38.7</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S8.T4.6.11.3.8">37.8</td>
</tr>
<tr class="ltx_tr" id="S8.T4.3.3">
<td class="ltx_td ltx_align_center" id="S8.T4.3.3.2">6</td>
<td class="ltx_td ltx_align_left" id="S8.T4.3.3.1">BLOOMZ-mt (MBR <math alttext="|H|=8" class="ltx_Math" display="inline" id="S8.T4.3.3.1.m1.1"><semantics id="S8.T4.3.3.1.m1.1a"><mrow id="S8.T4.3.3.1.m1.1.2" xref="S8.T4.3.3.1.m1.1.2.cmml"><mrow id="S8.T4.3.3.1.m1.1.2.2.2" xref="S8.T4.3.3.1.m1.1.2.2.1.cmml"><mo id="S8.T4.3.3.1.m1.1.2.2.2.1" stretchy="false" xref="S8.T4.3.3.1.m1.1.2.2.1.1.cmml">|</mo><mi id="S8.T4.3.3.1.m1.1.1" xref="S8.T4.3.3.1.m1.1.1.cmml">H</mi><mo id="S8.T4.3.3.1.m1.1.2.2.2.2" stretchy="false" xref="S8.T4.3.3.1.m1.1.2.2.1.1.cmml">|</mo></mrow><mo id="S8.T4.3.3.1.m1.1.2.1" xref="S8.T4.3.3.1.m1.1.2.1.cmml">=</mo><mn id="S8.T4.3.3.1.m1.1.2.3" xref="S8.T4.3.3.1.m1.1.2.3.cmml">8</mn></mrow><annotation-xml encoding="MathML-Content" id="S8.T4.3.3.1.m1.1b"><apply id="S8.T4.3.3.1.m1.1.2.cmml" xref="S8.T4.3.3.1.m1.1.2"><eq id="S8.T4.3.3.1.m1.1.2.1.cmml" xref="S8.T4.3.3.1.m1.1.2.1"></eq><apply id="S8.T4.3.3.1.m1.1.2.2.1.cmml" xref="S8.T4.3.3.1.m1.1.2.2.2"><abs id="S8.T4.3.3.1.m1.1.2.2.1.1.cmml" xref="S8.T4.3.3.1.m1.1.2.2.2.1"></abs><ci id="S8.T4.3.3.1.m1.1.1.cmml" xref="S8.T4.3.3.1.m1.1.1">𝐻</ci></apply><cn id="S8.T4.3.3.1.m1.1.2.3.cmml" type="integer" xref="S8.T4.3.3.1.m1.1.2.3">8</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S8.T4.3.3.1.m1.1c">|H|=8</annotation><annotation encoding="application/x-llamapun" id="S8.T4.3.3.1.m1.1d">| italic_H | = 8</annotation></semantics></math>)</td>
<td class="ltx_td ltx_align_center" id="S8.T4.3.3.3">13.5</td>
<td class="ltx_td ltx_align_center" id="S8.T4.3.3.4">20.2</td>
<td class="ltx_td ltx_align_center" id="S8.T4.3.3.5">12.2</td>
<td class="ltx_td ltx_align_center" id="S8.T4.3.3.6">23.3</td>
<td class="ltx_td ltx_align_center" id="S8.T4.3.3.7">35.2</td>
<td class="ltx_td ltx_align_center" id="S8.T4.3.3.8">31.8</td>
</tr>
<tr class="ltx_tr" id="S8.T4.4.4">
<td class="ltx_td ltx_align_center" id="S8.T4.4.4.2">7</td>
<td class="ltx_td ltx_align_left" id="S8.T4.4.4.1">BLOOMZ-mt (MBR <math alttext="|H|=32" class="ltx_Math" display="inline" id="S8.T4.4.4.1.m1.1"><semantics id="S8.T4.4.4.1.m1.1a"><mrow id="S8.T4.4.4.1.m1.1.2" xref="S8.T4.4.4.1.m1.1.2.cmml"><mrow id="S8.T4.4.4.1.m1.1.2.2.2" xref="S8.T4.4.4.1.m1.1.2.2.1.cmml"><mo id="S8.T4.4.4.1.m1.1.2.2.2.1" stretchy="false" xref="S8.T4.4.4.1.m1.1.2.2.1.1.cmml">|</mo><mi id="S8.T4.4.4.1.m1.1.1" xref="S8.T4.4.4.1.m1.1.1.cmml">H</mi><mo id="S8.T4.4.4.1.m1.1.2.2.2.2" stretchy="false" xref="S8.T4.4.4.1.m1.1.2.2.1.1.cmml">|</mo></mrow><mo id="S8.T4.4.4.1.m1.1.2.1" xref="S8.T4.4.4.1.m1.1.2.1.cmml">=</mo><mn id="S8.T4.4.4.1.m1.1.2.3" xref="S8.T4.4.4.1.m1.1.2.3.cmml">32</mn></mrow><annotation-xml encoding="MathML-Content" id="S8.T4.4.4.1.m1.1b"><apply id="S8.T4.4.4.1.m1.1.2.cmml" xref="S8.T4.4.4.1.m1.1.2"><eq id="S8.T4.4.4.1.m1.1.2.1.cmml" xref="S8.T4.4.4.1.m1.1.2.1"></eq><apply id="S8.T4.4.4.1.m1.1.2.2.1.cmml" xref="S8.T4.4.4.1.m1.1.2.2.2"><abs id="S8.T4.4.4.1.m1.1.2.2.1.1.cmml" xref="S8.T4.4.4.1.m1.1.2.2.2.1"></abs><ci id="S8.T4.4.4.1.m1.1.1.cmml" xref="S8.T4.4.4.1.m1.1.1">𝐻</ci></apply><cn id="S8.T4.4.4.1.m1.1.2.3.cmml" type="integer" xref="S8.T4.4.4.1.m1.1.2.3">32</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S8.T4.4.4.1.m1.1c">|H|=32</annotation><annotation encoding="application/x-llamapun" id="S8.T4.4.4.1.m1.1d">| italic_H | = 32</annotation></semantics></math>)</td>
<td class="ltx_td ltx_align_center" id="S8.T4.4.4.3">14.3</td>
<td class="ltx_td ltx_align_center" id="S8.T4.4.4.4">20.8</td>
<td class="ltx_td ltx_align_center" id="S8.T4.4.4.5">13.0</td>
<td class="ltx_td ltx_align_center" id="S8.T4.4.4.6">24.0</td>
<td class="ltx_td ltx_align_center" id="S8.T4.4.4.7">36.9</td>
<td class="ltx_td ltx_align_center" id="S8.T4.4.4.8">33.8</td>
</tr>
<tr class="ltx_tr" id="S8.T4.6.12.4">
<td class="ltx_td ltx_align_center" id="S8.T4.6.12.4.1">8</td>
<td class="ltx_td ltx_align_left" id="S8.T4.6.12.4.2">
<span class="ltx_text ltx_font_bold" id="S8.T4.6.12.4.2.1">BLOOMZ-mt-DPO-MBR</span> (Beam)</td>
<td class="ltx_td ltx_align_center" id="S8.T4.6.12.4.3"><span class="ltx_text ltx_font_bold" id="S8.T4.6.12.4.3.1">18.0</span></td>
<td class="ltx_td ltx_align_center" id="S8.T4.6.12.4.4"><span class="ltx_text ltx_font_bold" id="S8.T4.6.12.4.4.1">22.7</span></td>
<td class="ltx_td ltx_align_center" id="S8.T4.6.12.4.5"><span class="ltx_text ltx_font_bold" id="S8.T4.6.12.4.5.1">15.9</span></td>
<td class="ltx_td ltx_align_center" id="S8.T4.6.12.4.6"><span class="ltx_text ltx_font_bold" id="S8.T4.6.12.4.6.1">26.9</span></td>
<td class="ltx_td ltx_align_center" id="S8.T4.6.12.4.7"><span class="ltx_text ltx_font_bold" id="S8.T4.6.12.4.7.1">40.4</span></td>
<td class="ltx_td ltx_align_center" id="S8.T4.6.12.4.8"><span class="ltx_text ltx_font_bold" id="S8.T4.6.12.4.8.1">38.3</span></td>
</tr>
<tr class="ltx_tr" id="S8.T4.6.13.5">
<td class="ltx_td ltx_align_center ltx_border_t" id="S8.T4.6.13.5.1">9</td>
<td class="ltx_td ltx_align_left ltx_border_t" id="S8.T4.6.13.5.2">BLOOMZ-mt-sft (Beam)</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S8.T4.6.13.5.3">23.5</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S8.T4.6.13.5.4"><span class="ltx_text ltx_font_bold" id="S8.T4.6.13.5.4.1">27.5</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S8.T4.6.13.5.5">19.7</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S8.T4.6.13.5.6">34.9</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S8.T4.6.13.5.7"><span class="ltx_text ltx_font_bold" id="S8.T4.6.13.5.7.1">44.2</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S8.T4.6.13.5.8"><span class="ltx_text ltx_font_bold" id="S8.T4.6.13.5.8.1">40.7</span></td>
</tr>
<tr class="ltx_tr" id="S8.T4.5.5">
<td class="ltx_td ltx_align_center" id="S8.T4.5.5.2">10</td>
<td class="ltx_td ltx_align_left" id="S8.T4.5.5.1">BLOOMZ-mt-sft (MBR <math alttext="|H|=8" class="ltx_Math" display="inline" id="S8.T4.5.5.1.m1.1"><semantics id="S8.T4.5.5.1.m1.1a"><mrow id="S8.T4.5.5.1.m1.1.2" xref="S8.T4.5.5.1.m1.1.2.cmml"><mrow id="S8.T4.5.5.1.m1.1.2.2.2" xref="S8.T4.5.5.1.m1.1.2.2.1.cmml"><mo id="S8.T4.5.5.1.m1.1.2.2.2.1" stretchy="false" xref="S8.T4.5.5.1.m1.1.2.2.1.1.cmml">|</mo><mi id="S8.T4.5.5.1.m1.1.1" xref="S8.T4.5.5.1.m1.1.1.cmml">H</mi><mo id="S8.T4.5.5.1.m1.1.2.2.2.2" stretchy="false" xref="S8.T4.5.5.1.m1.1.2.2.1.1.cmml">|</mo></mrow><mo id="S8.T4.5.5.1.m1.1.2.1" xref="S8.T4.5.5.1.m1.1.2.1.cmml">=</mo><mn id="S8.T4.5.5.1.m1.1.2.3" xref="S8.T4.5.5.1.m1.1.2.3.cmml">8</mn></mrow><annotation-xml encoding="MathML-Content" id="S8.T4.5.5.1.m1.1b"><apply id="S8.T4.5.5.1.m1.1.2.cmml" xref="S8.T4.5.5.1.m1.1.2"><eq id="S8.T4.5.5.1.m1.1.2.1.cmml" xref="S8.T4.5.5.1.m1.1.2.1"></eq><apply id="S8.T4.5.5.1.m1.1.2.2.1.cmml" xref="S8.T4.5.5.1.m1.1.2.2.2"><abs id="S8.T4.5.5.1.m1.1.2.2.1.1.cmml" xref="S8.T4.5.5.1.m1.1.2.2.2.1"></abs><ci id="S8.T4.5.5.1.m1.1.1.cmml" xref="S8.T4.5.5.1.m1.1.1">𝐻</ci></apply><cn id="S8.T4.5.5.1.m1.1.2.3.cmml" type="integer" xref="S8.T4.5.5.1.m1.1.2.3">8</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S8.T4.5.5.1.m1.1c">|H|=8</annotation><annotation encoding="application/x-llamapun" id="S8.T4.5.5.1.m1.1d">| italic_H | = 8</annotation></semantics></math>)</td>
<td class="ltx_td ltx_align_center" id="S8.T4.5.5.3">20.2</td>
<td class="ltx_td ltx_align_center" id="S8.T4.5.5.4">24.0</td>
<td class="ltx_td ltx_align_center" id="S8.T4.5.5.5">17.7</td>
<td class="ltx_td ltx_align_center" id="S8.T4.5.5.6">30.1</td>
<td class="ltx_td ltx_align_center" id="S8.T4.5.5.7">40.7</td>
<td class="ltx_td ltx_align_center" id="S8.T4.5.5.8">34.2</td>
</tr>
<tr class="ltx_tr" id="S8.T4.6.6">
<td class="ltx_td ltx_align_center" id="S8.T4.6.6.2">11</td>
<td class="ltx_td ltx_align_left" id="S8.T4.6.6.1">BLOOMZ-mt-sft (MBR <math alttext="|H|=32" class="ltx_Math" display="inline" id="S8.T4.6.6.1.m1.1"><semantics id="S8.T4.6.6.1.m1.1a"><mrow id="S8.T4.6.6.1.m1.1.2" xref="S8.T4.6.6.1.m1.1.2.cmml"><mrow id="S8.T4.6.6.1.m1.1.2.2.2" xref="S8.T4.6.6.1.m1.1.2.2.1.cmml"><mo id="S8.T4.6.6.1.m1.1.2.2.2.1" stretchy="false" xref="S8.T4.6.6.1.m1.1.2.2.1.1.cmml">|</mo><mi id="S8.T4.6.6.1.m1.1.1" xref="S8.T4.6.6.1.m1.1.1.cmml">H</mi><mo id="S8.T4.6.6.1.m1.1.2.2.2.2" stretchy="false" xref="S8.T4.6.6.1.m1.1.2.2.1.1.cmml">|</mo></mrow><mo id="S8.T4.6.6.1.m1.1.2.1" xref="S8.T4.6.6.1.m1.1.2.1.cmml">=</mo><mn id="S8.T4.6.6.1.m1.1.2.3" xref="S8.T4.6.6.1.m1.1.2.3.cmml">32</mn></mrow><annotation-xml encoding="MathML-Content" id="S8.T4.6.6.1.m1.1b"><apply id="S8.T4.6.6.1.m1.1.2.cmml" xref="S8.T4.6.6.1.m1.1.2"><eq id="S8.T4.6.6.1.m1.1.2.1.cmml" xref="S8.T4.6.6.1.m1.1.2.1"></eq><apply id="S8.T4.6.6.1.m1.1.2.2.1.cmml" xref="S8.T4.6.6.1.m1.1.2.2.2"><abs id="S8.T4.6.6.1.m1.1.2.2.1.1.cmml" xref="S8.T4.6.6.1.m1.1.2.2.2.1"></abs><ci id="S8.T4.6.6.1.m1.1.1.cmml" xref="S8.T4.6.6.1.m1.1.1">𝐻</ci></apply><cn id="S8.T4.6.6.1.m1.1.2.3.cmml" type="integer" xref="S8.T4.6.6.1.m1.1.2.3">32</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S8.T4.6.6.1.m1.1c">|H|=32</annotation><annotation encoding="application/x-llamapun" id="S8.T4.6.6.1.m1.1d">| italic_H | = 32</annotation></semantics></math>)</td>
<td class="ltx_td ltx_align_center" id="S8.T4.6.6.3">21.1</td>
<td class="ltx_td ltx_align_center" id="S8.T4.6.6.4">25.0</td>
<td class="ltx_td ltx_align_center" id="S8.T4.6.6.5">18.4</td>
<td class="ltx_td ltx_align_center" id="S8.T4.6.6.6">31.2</td>
<td class="ltx_td ltx_align_center" id="S8.T4.6.6.7">41.3</td>
<td class="ltx_td ltx_align_center" id="S8.T4.6.6.8">32.1</td>
</tr>
<tr class="ltx_tr" id="S8.T4.6.14.6">
<td class="ltx_td ltx_align_center ltx_border_bb" id="S8.T4.6.14.6.1">12</td>
<td class="ltx_td ltx_align_left ltx_border_bb" id="S8.T4.6.14.6.2">
<span class="ltx_text ltx_font_bold" id="S8.T4.6.14.6.2.1">BLOOMZ-mt-sft-DPO-MBR</span> (Beam)</td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S8.T4.6.14.6.3"><span class="ltx_text ltx_font_bold" id="S8.T4.6.14.6.3.1">23.8</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S8.T4.6.14.6.4">26.3</td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S8.T4.6.14.6.5"><span class="ltx_text ltx_font_bold" id="S8.T4.6.14.6.5.1">22.1</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S8.T4.6.14.6.6"><span class="ltx_text ltx_font_bold" id="S8.T4.6.14.6.6.1">35.4</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S8.T4.6.14.6.7">27.3</td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S8.T4.6.14.6.8">38.5</td>
</tr>
</tbody>
</table>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table">Table 4: </span>Translation performance in BLEU for models with beam search and MBR decoding on two language pairs from WMT21 news translation test sets, WMT22 general translation test sets, and IWSLT 2017 test sets. DPO-MBR indicates our translation performance with our fine-tuning method. All the DPO MBR models were fine-tuned using the BMW strategy and <math alttext="\beta=0.7" class="ltx_Math" display="inline" id="S8.T4.11.m1.1"><semantics id="S8.T4.11.m1.1b"><mrow id="S8.T4.11.m1.1.1" xref="S8.T4.11.m1.1.1.cmml"><mi id="S8.T4.11.m1.1.1.2" xref="S8.T4.11.m1.1.1.2.cmml">β</mi><mo id="S8.T4.11.m1.1.1.1" xref="S8.T4.11.m1.1.1.1.cmml">=</mo><mn id="S8.T4.11.m1.1.1.3" xref="S8.T4.11.m1.1.1.3.cmml">0.7</mn></mrow><annotation-xml encoding="MathML-Content" id="S8.T4.11.m1.1c"><apply id="S8.T4.11.m1.1.1.cmml" xref="S8.T4.11.m1.1.1"><eq id="S8.T4.11.m1.1.1.1.cmml" xref="S8.T4.11.m1.1.1.1"></eq><ci id="S8.T4.11.m1.1.1.2.cmml" xref="S8.T4.11.m1.1.1.2">𝛽</ci><cn id="S8.T4.11.m1.1.1.3.cmml" type="float" xref="S8.T4.11.m1.1.1.3">0.7</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S8.T4.11.m1.1d">\beta=0.7</annotation><annotation encoding="application/x-llamapun" id="S8.T4.11.m1.1e">italic_β = 0.7</annotation></semantics></math> except for BLOOMZ-mt-sft on IWSLT 2017, which used the BW strategy. We set <math alttext="|H|=32" class="ltx_Math" display="inline" id="S8.T4.12.m2.1"><semantics id="S8.T4.12.m2.1b"><mrow id="S8.T4.12.m2.1.2" xref="S8.T4.12.m2.1.2.cmml"><mrow id="S8.T4.12.m2.1.2.2.2" xref="S8.T4.12.m2.1.2.2.1.cmml"><mo id="S8.T4.12.m2.1.2.2.2.1" stretchy="false" xref="S8.T4.12.m2.1.2.2.1.1.cmml">|</mo><mi id="S8.T4.12.m2.1.1" xref="S8.T4.12.m2.1.1.cmml">H</mi><mo id="S8.T4.12.m2.1.2.2.2.2" stretchy="false" xref="S8.T4.12.m2.1.2.2.1.1.cmml">|</mo></mrow><mo id="S8.T4.12.m2.1.2.1" xref="S8.T4.12.m2.1.2.1.cmml">=</mo><mn id="S8.T4.12.m2.1.2.3" xref="S8.T4.12.m2.1.2.3.cmml">32</mn></mrow><annotation-xml encoding="MathML-Content" id="S8.T4.12.m2.1c"><apply id="S8.T4.12.m2.1.2.cmml" xref="S8.T4.12.m2.1.2"><eq id="S8.T4.12.m2.1.2.1.cmml" xref="S8.T4.12.m2.1.2.1"></eq><apply id="S8.T4.12.m2.1.2.2.1.cmml" xref="S8.T4.12.m2.1.2.2.2"><abs id="S8.T4.12.m2.1.2.2.1.1.cmml" xref="S8.T4.12.m2.1.2.2.2.1"></abs><ci id="S8.T4.12.m2.1.1.cmml" xref="S8.T4.12.m2.1.1">𝐻</ci></apply><cn id="S8.T4.12.m2.1.2.3.cmml" type="integer" xref="S8.T4.12.m2.1.2.3">32</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S8.T4.12.m2.1d">|H|=32</annotation><annotation encoding="application/x-llamapun" id="S8.T4.12.m2.1e">| italic_H | = 32</annotation></semantics></math> to fine-tune BLOOMZ-mt-DPO-MBR on English-Chinese direction, <math alttext="|H|=16" class="ltx_Math" display="inline" id="S8.T4.13.m3.1"><semantics id="S8.T4.13.m3.1b"><mrow id="S8.T4.13.m3.1.2" xref="S8.T4.13.m3.1.2.cmml"><mrow id="S8.T4.13.m3.1.2.2.2" xref="S8.T4.13.m3.1.2.2.1.cmml"><mo id="S8.T4.13.m3.1.2.2.2.1" stretchy="false" xref="S8.T4.13.m3.1.2.2.1.1.cmml">|</mo><mi id="S8.T4.13.m3.1.1" xref="S8.T4.13.m3.1.1.cmml">H</mi><mo id="S8.T4.13.m3.1.2.2.2.2" stretchy="false" xref="S8.T4.13.m3.1.2.2.1.1.cmml">|</mo></mrow><mo id="S8.T4.13.m3.1.2.1" xref="S8.T4.13.m3.1.2.1.cmml">=</mo><mn id="S8.T4.13.m3.1.2.3" xref="S8.T4.13.m3.1.2.3.cmml">16</mn></mrow><annotation-xml encoding="MathML-Content" id="S8.T4.13.m3.1c"><apply id="S8.T4.13.m3.1.2.cmml" xref="S8.T4.13.m3.1.2"><eq id="S8.T4.13.m3.1.2.1.cmml" xref="S8.T4.13.m3.1.2.1"></eq><apply id="S8.T4.13.m3.1.2.2.1.cmml" xref="S8.T4.13.m3.1.2.2.2"><abs id="S8.T4.13.m3.1.2.2.1.1.cmml" xref="S8.T4.13.m3.1.2.2.2.1"></abs><ci id="S8.T4.13.m3.1.1.cmml" xref="S8.T4.13.m3.1.1">𝐻</ci></apply><cn id="S8.T4.13.m3.1.2.3.cmml" type="integer" xref="S8.T4.13.m3.1.2.3">16</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S8.T4.13.m3.1d">|H|=16</annotation><annotation encoding="application/x-llamapun" id="S8.T4.13.m3.1e">| italic_H | = 16</annotation></semantics></math> on the French-English direction for BLOOMZ and BLOOMZ-mt, and set <math alttext="|H|=8" class="ltx_Math" display="inline" id="S8.T4.14.m4.1"><semantics id="S8.T4.14.m4.1b"><mrow id="S8.T4.14.m4.1.2" xref="S8.T4.14.m4.1.2.cmml"><mrow id="S8.T4.14.m4.1.2.2.2" xref="S8.T4.14.m4.1.2.2.1.cmml"><mo id="S8.T4.14.m4.1.2.2.2.1" stretchy="false" xref="S8.T4.14.m4.1.2.2.1.1.cmml">|</mo><mi id="S8.T4.14.m4.1.1" xref="S8.T4.14.m4.1.1.cmml">H</mi><mo id="S8.T4.14.m4.1.2.2.2.2" stretchy="false" xref="S8.T4.14.m4.1.2.2.1.1.cmml">|</mo></mrow><mo id="S8.T4.14.m4.1.2.1" xref="S8.T4.14.m4.1.2.1.cmml">=</mo><mn id="S8.T4.14.m4.1.2.3" xref="S8.T4.14.m4.1.2.3.cmml">8</mn></mrow><annotation-xml encoding="MathML-Content" id="S8.T4.14.m4.1c"><apply id="S8.T4.14.m4.1.2.cmml" xref="S8.T4.14.m4.1.2"><eq id="S8.T4.14.m4.1.2.1.cmml" xref="S8.T4.14.m4.1.2.1"></eq><apply id="S8.T4.14.m4.1.2.2.1.cmml" xref="S8.T4.14.m4.1.2.2.2"><abs id="S8.T4.14.m4.1.2.2.1.1.cmml" xref="S8.T4.14.m4.1.2.2.2.1"></abs><ci id="S8.T4.14.m4.1.1.cmml" xref="S8.T4.14.m4.1.1">𝐻</ci></apply><cn id="S8.T4.14.m4.1.2.3.cmml" type="integer" xref="S8.T4.14.m4.1.2.3">8</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S8.T4.14.m4.1d">|H|=8</annotation><annotation encoding="application/x-llamapun" id="S8.T4.14.m4.1e">| italic_H | = 8</annotation></semantics></math> to fine-tune other DPO MBR models.</figcaption>
</figure>
<div class="ltx_pagination ltx_role_newpage"></div>
<section class="ltx_appendix" id="A1">
<h2 class="ltx_title ltx_title_appendix">
<span class="ltx_tag ltx_tag_appendix">Appendix A </span>Translation Performance in BLEU</h2>
<div class="ltx_para" id="A1.p1">
<p class="ltx_p" id="A1.p1.1">In Table <a class="ltx_ref" href="https://arxiv.org/html/2311.08380v2#S8.T4" title="Table 4 ‣ Direct Preference Optimization for Neural Machine Translation with Minimum Bayes Risk Decoding"><span class="ltx_text ltx_ref_tag">4</span></a>, we provide the translation performance measured in BLEU score. The BLOOMZ-DPO-MBR and BLOOMZ-mt-DPO-MBR models achieve the best BLEU scores on all six test sets. The BLOOMZ-mt-sft model achieves lower BLEU score after DPO MBR fine-tuning on WMT21 English-to-Chinese, IWSLT17 French-to-English and English-to-French due to over-generation.</p>
</div>
</section>
<section class="ltx_appendix" id="A2">
<h2 class="ltx_title ltx_title_appendix">
<span class="ltx_tag ltx_tag_appendix">Appendix B </span>Training Details</h2>
<section class="ltx_subsection" id="A2.SS1">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">B.1 </span>DPO MBR Fine-tuning Details</h3>
<div class="ltx_para" id="A2.SS1.p1">
<p class="ltx_p" id="A2.SS1.p1.1">For DPO MBR fine-tuning, we trained each model for one epoch using the RMSProp optimizer. The learning rate is set to <math alttext="5e^{-7}" class="ltx_Math" display="inline" id="A2.SS1.p1.1.m1.1"><semantics id="A2.SS1.p1.1.m1.1a"><mrow id="A2.SS1.p1.1.m1.1.1" xref="A2.SS1.p1.1.m1.1.1.cmml"><mn id="A2.SS1.p1.1.m1.1.1.2" xref="A2.SS1.p1.1.m1.1.1.2.cmml">5</mn><mo id="A2.SS1.p1.1.m1.1.1.1" xref="A2.SS1.p1.1.m1.1.1.1.cmml">⁢</mo><msup id="A2.SS1.p1.1.m1.1.1.3" xref="A2.SS1.p1.1.m1.1.1.3.cmml"><mi id="A2.SS1.p1.1.m1.1.1.3.2" xref="A2.SS1.p1.1.m1.1.1.3.2.cmml">e</mi><mrow id="A2.SS1.p1.1.m1.1.1.3.3" xref="A2.SS1.p1.1.m1.1.1.3.3.cmml"><mo id="A2.SS1.p1.1.m1.1.1.3.3a" xref="A2.SS1.p1.1.m1.1.1.3.3.cmml">−</mo><mn id="A2.SS1.p1.1.m1.1.1.3.3.2" xref="A2.SS1.p1.1.m1.1.1.3.3.2.cmml">7</mn></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="A2.SS1.p1.1.m1.1b"><apply id="A2.SS1.p1.1.m1.1.1.cmml" xref="A2.SS1.p1.1.m1.1.1"><times id="A2.SS1.p1.1.m1.1.1.1.cmml" xref="A2.SS1.p1.1.m1.1.1.1"></times><cn id="A2.SS1.p1.1.m1.1.1.2.cmml" type="integer" xref="A2.SS1.p1.1.m1.1.1.2">5</cn><apply id="A2.SS1.p1.1.m1.1.1.3.cmml" xref="A2.SS1.p1.1.m1.1.1.3"><csymbol cd="ambiguous" id="A2.SS1.p1.1.m1.1.1.3.1.cmml" xref="A2.SS1.p1.1.m1.1.1.3">superscript</csymbol><ci id="A2.SS1.p1.1.m1.1.1.3.2.cmml" xref="A2.SS1.p1.1.m1.1.1.3.2">𝑒</ci><apply id="A2.SS1.p1.1.m1.1.1.3.3.cmml" xref="A2.SS1.p1.1.m1.1.1.3.3"><minus id="A2.SS1.p1.1.m1.1.1.3.3.1.cmml" xref="A2.SS1.p1.1.m1.1.1.3.3"></minus><cn id="A2.SS1.p1.1.m1.1.1.3.3.2.cmml" type="integer" xref="A2.SS1.p1.1.m1.1.1.3.3.2">7</cn></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A2.SS1.p1.1.m1.1c">5e^{-7}</annotation><annotation encoding="application/x-llamapun" id="A2.SS1.p1.1.m1.1d">5 italic_e start_POSTSUPERSCRIPT - 7 end_POSTSUPERSCRIPT</annotation></semantics></math> with 150 warmup steps. All fine-tuning experiments were done on two Nvidia A100-80G GPUs. We set the effective batch size to 4. We used FP32 and FP16 for the trained policy and the reference model in DPO fine-tuning, respectively.</p>
</div>
</section>
<section class="ltx_subsection" id="A2.SS2">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">B.2 </span>Supervised Fine-tuning</h3>
<div class="ltx_para" id="A2.SS2.p1">
<p class="ltx_p" id="A2.SS2.p1.1">We supervised fine-tuned the BLOOMZ-mt model on Chinese-to-English and English-to-Chinese directions for two epochs using previous WMT test sets. For French-to-English and English-to-French, we used the 20K translation pairs and trained for one epoch. Other hyper-parameters for SFT training are the same as DPO MBR fine-tuning.</p>
</div>
</section>
</section>
</article>
</div>
<footer class="ltx_page_footer">
<div class="ltx_page_logo">Generated  on Wed May  1 19:05:43 2024 by <a class="ltx_LaTeXML_logo" href="http://dlmf.nist.gov/LaTeXML/"><span style="letter-spacing:-0.2em; margin-right:0.1em;">L<span class="ltx_font_smallcaps" style="position:relative; bottom:2.2pt;">a</span>T<span class="ltx_font_smallcaps" style="font-size:120%;position:relative; bottom:-0.2ex;">e</span></span><span style="font-size:90%; position:relative; bottom:-0.2ex;">XML</span><img alt="Mascot Sammy" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAsAAAAOCAYAAAD5YeaVAAAAAXNSR0IArs4c6QAAAAZiS0dEAP8A/wD/oL2nkwAAAAlwSFlzAAALEwAACxMBAJqcGAAAAAd0SU1FB9wKExQZLWTEaOUAAAAddEVYdENvbW1lbnQAQ3JlYXRlZCB3aXRoIFRoZSBHSU1Q72QlbgAAAdpJREFUKM9tkL+L2nAARz9fPZNCKFapUn8kyI0e4iRHSR1Kb8ng0lJw6FYHFwv2LwhOpcWxTjeUunYqOmqd6hEoRDhtDWdA8ApRYsSUCDHNt5ul13vz4w0vWCgUnnEc975arX6ORqN3VqtVZbfbTQC4uEHANM3jSqXymFI6yWazP2KxWAXAL9zCUa1Wy2tXVxheKA9YNoR8Pt+aTqe4FVVVvz05O6MBhqUIBGk8Hn8HAOVy+T+XLJfLS4ZhTiRJgqIoVBRFIoric47jPnmeB1mW/9rr9ZpSSn3Lsmir1fJZlqWlUonKsvwWwD8ymc/nXwVBeLjf7xEKhdBut9Hr9WgmkyGEkJwsy5eHG5vN5g0AKIoCAEgkEkin0wQAfN9/cXPdheu6P33fBwB4ngcAcByHJpPJl+fn54mD3Gg0NrquXxeLRQAAwzAYj8cwTZPwPH9/sVg8PXweDAauqqr2cDjEer1GJBLBZDJBs9mE4zjwfZ85lAGg2+06hmGgXq+j3+/DsixYlgVN03a9Xu8jgCNCyIegIAgx13Vfd7vdu+FweG8YRkjXdWy329+dTgeSJD3ieZ7RNO0VAXAPwDEAO5VKndi2fWrb9jWl9Esul6PZbDY9Go1OZ7PZ9z/lyuD3OozU2wAAAABJRU5ErkJggg=="/></a>
</div></footer>
</div>
</body>
</html>
