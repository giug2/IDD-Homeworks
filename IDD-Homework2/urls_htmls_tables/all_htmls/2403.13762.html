<!DOCTYPE html><html lang="en">
<head>
<meta http-equiv="content-type" content="text/html; charset=UTF-8">
<title>[2403.13762] When Cars meet Drones: Hyperbolic Federated Learning for Source-Free Domain Adaptation in Adverse Weather</title><meta property="og:description" content="In  Federated Learning (FL), multiple clients collaboratively train a global model without sharing private data.
In semantic segmentation, the  Federated source Free Domain Adaptation (FFreeDA) setting is of particular…">
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="When Cars meet Drones: Hyperbolic Federated Learning for Source-Free Domain Adaptation in Adverse Weather">
<meta name="twitter:image:src" content="https://ar5iv.labs.arxiv.org/assets/ar5iv_card.png">
<meta name="twitter:image:alt" content="ar5iv logo">
<meta property="og:title" content="When Cars meet Drones: Hyperbolic Federated Learning for Source-Free Domain Adaptation in Adverse Weather">
<meta property="og:site_name" content="ar5iv">
<meta property="og:image" content="https://ar5iv.labs.arxiv.org/assets/ar5iv_card.png">
<meta property="og:type" content="article">
<meta property="og:url" content="https://ar5iv.labs.arxiv.org/html/2403.13762">

<!--Generated on Fri Apr  5 15:31:38 2024 by LaTeXML (version 0.8.8) http://dlmf.nist.gov/LaTeXML/.-->
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

<script>
  function detectColorScheme(){
    var theme="light";
    var current_theme = localStorage.getItem("ar5iv_theme");
    if(current_theme){
      if(current_theme == "dark"){
        theme = "dark";
      } }
    else if(!window.matchMedia) { return false; }
    else if(window.matchMedia("(prefers-color-scheme: dark)").matches) {
      theme = "dark"; }
    if (theme=="dark") {
      document.documentElement.setAttribute("data-theme", "dark");
    } else {
      document.documentElement.setAttribute("data-theme", "light"); } }

  detectColorScheme();

  function toggleColorScheme(){
    var current_theme = localStorage.getItem("ar5iv_theme");
    if (current_theme) {
      if (current_theme == "light") {
        localStorage.setItem("ar5iv_theme", "dark"); }
      else {
        localStorage.setItem("ar5iv_theme", "light"); } }
    else {
        localStorage.setItem("ar5iv_theme", "dark"); }
    detectColorScheme(); }
</script>
<link media="all" rel="stylesheet" href="/assets/ar5iv-fonts.0.8.0.min.css"><link media="all" rel="stylesheet" href="/assets/ar5iv.0.8.0.min.css"><link media="all" rel="stylesheet" href="/assets/ar5iv-site.0.2.2.css">
</head>
<body>
<div class="ltx_page_main">
<div class="ltx_page_content">
<article class="ltx_document ltx_authors_1line">
<div id="p1" class="ltx_para">
<p id="p1.1" class="ltx_p">(eccv)                Package eccv Warning: Package ‘hyperref’ is loaded with option ‘pagebackref’, which is *not* recommended for camera-ready version</p>
</div>
<span id="id1" class="ltx_note ltx_role_institutetext"><sup class="ltx_note_mark">1</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">1</sup><span class="ltx_note_type">institutetext: </span>University of Padova, Italy 
<br class="ltx_break"><span id="id1.1" class="ltx_note ltx_role_email"><sup class="ltx_note_mark">1</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">1</sup><span class="ltx_note_type">email: </span>firstname.lastname@dei.unipd.it</span></span></span>
<br class="ltx_break"></span></span></span>
<h1 class="ltx_title ltx_title_document">When Cars meet Drones: Hyperbolic Federated Learning for Source-Free Domain Adaptation in Adverse Weather</h1>
<div class="ltx_authors">
<span class="ltx_creator ltx_role_author">
<span class="ltx_personname">Giulia Rizzoli<sup id="id7.2.id1" class="ltx_sup">∗</sup>
</span><span class="ltx_author_notes">
<span class="ltx_contact ltx_role_orcid"><a target="_blank" href="https://orcid.org/0000-0002-1390-8419" title="ORCID identifier" class="ltx_ref">0000-0002-1390-8419</a></span>
University of Padova, Italy 
<br class="ltx_break"><span id="id8.3.id1" class="ltx_note ltx_role_email"><sup class="ltx_note_mark">1</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">1</sup><span class="ltx_note_type">email: </span>firstname.lastname@dei.unipd.it</span></span></span>
<br class="ltx_break"></span></span>
<span class="ltx_author_before">  </span><span class="ltx_creator ltx_role_author">
<span class="ltx_personname">Matteo Caligiuri<sup id="id9.2.id1" class="ltx_sup">∗</sup>
</span><span class="ltx_author_notes">
<span class="ltx_contact ltx_role_orcid"><a target="_blank" href="https://orcid.org/0009-0006-2928-1047" title="ORCID identifier" class="ltx_ref">0009-0006-2928-1047</a></span>
University of Padova, Italy 
<br class="ltx_break"><span id="id10.3.id1" class="ltx_note ltx_role_email"><sup class="ltx_note_mark">1</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">1</sup><span class="ltx_note_type">email: </span>firstname.lastname@dei.unipd.it</span></span></span>
<br class="ltx_break"></span></span>
<span class="ltx_author_before">  </span><span class="ltx_creator ltx_role_author">
<span class="ltx_personname">Donald Shenaj
</span><span class="ltx_author_notes">
<span class="ltx_contact ltx_role_orcid"><a target="_blank" href="https://orcid.org/0000-0002-6501-9437" title="ORCID identifier" class="ltx_ref">0000-0002-6501-9437</a></span>
University of Padova, Italy 
<br class="ltx_break"><span id="id11.1.id1" class="ltx_note ltx_role_email"><sup class="ltx_note_mark">1</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">1</sup><span class="ltx_note_type">email: </span>firstname.lastname@dei.unipd.it</span></span></span>
<br class="ltx_break"></span></span>
<span class="ltx_author_before">  </span><span class="ltx_creator ltx_role_author">
<span class="ltx_personname">Francesco Barbato
</span><span class="ltx_author_notes">
<span class="ltx_contact ltx_role_orcid"><a target="_blank" href="https://orcid.org/0000-0001-9893-5813" title="ORCID identifier" class="ltx_ref">0000-0001-9893-5813</a></span>
University of Padova, Italy 
<br class="ltx_break"><span id="id12.1.id1" class="ltx_note ltx_role_email"><sup class="ltx_note_mark">1</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">1</sup><span class="ltx_note_type">email: </span>firstname.lastname@dei.unipd.it</span></span></span>
<br class="ltx_break"></span></span>
<span class="ltx_author_before">  </span><span class="ltx_creator ltx_role_author">
<span class="ltx_personname">Pietro Zanuttigh
</span><span class="ltx_author_notes">
<span class="ltx_contact ltx_role_orcid"><a target="_blank" href="https://orcid.org/0000-0002-9502-2389" title="ORCID identifier" class="ltx_ref">0000-0002-9502-2389</a></span>

<span class="ltx_contact ltx_role_orcid"><a target="_blank" href="https://orcid.org/0000-0002-1390-8419" title="ORCID identifier" class="ltx_ref">0000-0002-1390-8419</a></span>

<span class="ltx_contact ltx_role_orcid"><a target="_blank" href="https://orcid.org/0009-0006-2928-1047" title="ORCID identifier" class="ltx_ref">0009-0006-2928-1047</a></span>

<span class="ltx_contact ltx_role_orcid"><a target="_blank" href="https://orcid.org/0000-0002-6501-9437" title="ORCID identifier" class="ltx_ref">0000-0002-6501-9437</a></span>

<span class="ltx_contact ltx_role_orcid"><a target="_blank" href="https://orcid.org/0000-0001-9893-5813" title="ORCID identifier" class="ltx_ref">0000-0001-9893-5813</a></span>

<span class="ltx_contact ltx_role_orcid"><a target="_blank" href="https://orcid.org/0000-0002-9502-2389" title="ORCID identifier" class="ltx_ref">0000-0002-9502-2389</a></span>
University of Padova, Italy 
<br class="ltx_break"><span id="id13.1.id1" class="ltx_note ltx_role_email"><sup class="ltx_note_mark">1</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">1</sup><span class="ltx_note_type">email: </span>firstname.lastname@dei.unipd.it</span></span></span>
<br class="ltx_break"></span></span>
</div>

<div class="ltx_abstract">
<h6 class="ltx_title ltx_title_abstract">Abstract</h6>
<p id="id14.id1" class="ltx_p">In  <a href="#id3.1.id1"><span href="#id3.1.id1" title="Federated Learning" class="ltx_glossaryref"><span class="ltx_text ltx_glossary_long">Federated Learning</span></span></a> (<a href="#id3.1.id1"><abbr href="#id3.1.id1" title="Federated Learning" class="ltx_glossaryref"><span class="ltx_text ltx_glossary_short">FL</span></abbr></a>), multiple clients collaboratively train a global model without sharing private data.
In semantic segmentation, the  <a href="#id4.2.id2"><span href="#id4.2.id2" title="Federated source Free Domain Adaptation" class="ltx_glossaryref"><span class="ltx_text ltx_glossary_long">Federated source Free Domain Adaptation</span></span></a> (<a href="#id4.2.id2"><abbr href="#id4.2.id2" title="Federated source Free Domain Adaptation" class="ltx_glossaryref"><span class="ltx_text ltx_glossary_short"><span class="ltx_text ltx_font_smallcaps">FFreeDA</span></span></abbr></a>) setting is of particular interest, where clients undergo unsupervised training after supervised pretraining at the server side.
While few recent works address <a href="#id3.1.id1"><abbr href="#id3.1.id1" title="Federated Learning" class="ltx_glossaryref"><span class="ltx_text ltx_glossary_short">FL</span></abbr></a> for autonomous vehicles, intrinsic real-world challenges such as the presence of adverse weather conditions and the existence of different autonomous agents are still unexplored. To bridge this gap, we address both problems and introduce a new federated semantic segmentation setting where both car and drone clients co-exist and collaborate.
Specifically, we propose a novel approach for this setting which exploits a batch-norm weather-aware strategy to dynamically adapt the model to the different weather conditions, while hyperbolic space prototypes are used to align the heterogeneous client representations.
Finally, we introduce FLYAWARE, the first semantic segmentation dataset with adverse weather data for aerial vehicles.</p>
</div>
<span id="footnotex1" class="ltx_note ltx_role_footnotetext"><sup class="ltx_note_mark">*</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">*</sup><span class="ltx_note_type">footnotetext: </span>These authors contributed equally to this work.</span></span></span>
<section id="id6" class="ltx_glossary ltx_acronym ltx_list_acronym">
<dl id="id6.4" class="ltx_glossarylist">
<dt id="id3.1.id1" class="ltx_glossaryentry">FL</dt>
<dd>Federated Learning</dd>
<dt id="id4.2.id2" class="ltx_glossaryentry"><span id="id4.2.id2.1.1" class="ltx_text ltx_font_smallcaps">FFreeDA</span></dt>
<dd>Federated source Free Domain Adaptation</dd>
<dt id="id5.3.id3" class="ltx_glossaryentry">GAN</dt>
<dd>Generative Adversarial Network</dd>
<dt id="id6.4.id4" class="ltx_glossaryentry">OD</dt>
<dd>Object Detection</dd>
</dl>
</section>
<section id="S1" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">1 </span>Introduction</h2>

<div id="S1.p1" class="ltx_para">
<p id="S1.p1.1" class="ltx_p">The field of autonomous driving has evolved significantly beyond the traditional concept of cars navigating city streets. In the contemporary landscape, autonomous navigation encompasses various perspectives, including drones and robots, serving a wide range of applications like autonomous delivery and surveillance. The demand for intelligent systems that can seamlessly generalize across these varying viewpoints is quickly increasing, to enhance safety, efficiency, and adaptability.
A key challenge lies in achieving this goal while preserving confidentiality and data security. The importance of robust privacy measures in developing autonomous systems cannot be overstated, as these systems often rely on substantial amounts of data to function effectively. The traditional method of gathering and analyzing data in a centralized manner raises relevant security concerns. Federated learning allows tackling this issue by introducing a cutting-edge paradigm that enables the collaborative training of machine learning models without sharing the private data of the participants (<em id="S1.p1.1.1" class="ltx_emph ltx_font_italic">i.e</em>.<span id="S1.p1.1.2" class="ltx_text"></span>, clients).
In this paper, we introduce a novel federated learning approach tailored to the specific challenges encountered in driving scenarios, where autonomous agents have different viewpoints, specifically the street-view vision for cars and the aerial for UAVs. Multi-viewpoint paradigms have been proven beneficial in various tasks among which localization and segmentation <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib35" title="" class="ltx_ref">35</a>, <a href="#bib.bib31" title="" class="ltx_ref">31</a>, <a href="#bib.bib18" title="" class="ltx_ref">18</a>]</cite>, where jointly training the model with images from different viewpoints improves the objective task. Consequently, we enhance our framework by integrating aerial data. Moreover, we exploit this strategy in combination with the recent federated learning paradigm proposed in <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib37" title="" class="ltx_ref">37</a>]</cite> that exploits a supervised server pretraining to enable unsupervised training on the client side.
Additionally, our approach not only enables knowledge sharing between clients with different identities - either cars or drones - but also dynamically adapts to ever-changing weather conditions, aligning with the real-world challenges in this dynamic field.
In this scenario (shown in <a href="#S1.F1" title="In 1 Introduction ‣ When Cars meet Drones: Hyperbolic Federated Learning for Source-Free Domain Adaptation in Adverse Weather" class="ltx_ref"><span class="ltx_text ltx_ref_tag">Fig.</span> <span class="ltx_text ltx_ref_tag">1</span></a>), several key challenges arise:</p>
</div>
<div id="S1.p2" class="ltx_para">
<ol id="S1.I1" class="ltx_enumerate">
<li id="S1.I1.i1" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">1.</span> 
<div id="S1.I1.i1.p1" class="ltx_para">
<p id="S1.I1.i1.p1.1" class="ltx_p">Clients operating without supervision tend to become overly confident in their predictions, causing the model to diverge.</p>
</div>
</li>
<li id="S1.I1.i2" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">2.</span> 
<div id="S1.I1.i2.p1" class="ltx_para">
<p id="S1.I1.i2.p1.1" class="ltx_p">Clients exhibit differing distributions, and varying weather conditions can significantly impact performance (i.e., clients are non-iid, <span id="S1.I1.i2.p1.1.1" class="ltx_text ltx_font_italic">heterogeneous</span>).</p>
</div>
</li>
<li id="S1.I1.i3" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">3.</span> 
<div id="S1.I1.i3.p1" class="ltx_para">
<p id="S1.I1.i3.p1.1" class="ltx_p">Clients are unbalanced, reflecting real-world scenarios where certain types of agents may be less common (e.g., fewer drones compared to cars).</p>
</div>
</li>
</ol>
</div>
<figure id="S1.F1" class="ltx_figure"><img src="/html/2403.13762/assets/x1.png" id="S1.F1.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="368" height="191" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span id="S1.F1.2.1.1" class="ltx_text" style="font-size:90%;">Figure 1</span>: </span><span id="S1.F1.3.2" class="ltx_text" style="font-size:90%;">Overview of the considered setting: after a supervised pretraining on synthetic data, a heterogeneous set of unsupervised clients collaboratively
optimize their model in a federated fashion. Notably, adapting the model also to varying weather conditions.
</span></figcaption>
</figure>
<div id="S1.p3" class="ltx_para ltx_noindent">
<p id="S1.p3.1" class="ltx_p">To address these challenges, we present several novel contributions:</p>
</div>
<div id="S1.p4" class="ltx_para">
<ul id="S1.I2" class="ltx_itemize">
<li id="S1.I2.i1" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="S1.I2.i1.p1" class="ltx_para">
<p id="S1.I2.i1.p1.1" class="ltx_p">We introduced an unsupervised federated learning system for autonomous cars that can benefit from aerial view integration and seamlessly switch between the two perspectives.</p>
</div>
</li>
<li id="S1.I2.i2" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="S1.I2.i2.p1" class="ltx_para">
<p id="S1.I2.i2.p1.1" class="ltx_p">We introduced HyperFLAW(Hyperbolic Federated Learning in Adverse Weather), which addresses domain shifts in diverse weather conditions using weather-aware batch normalization layers and integrates the first semantic segmentation dataset with adverse weather imagery for aerial vehicles.</p>
</div>
</li>
<li id="S1.I2.i3" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="S1.I2.i3.p1" class="ltx_para">
<p id="S1.I2.i3.p1.1" class="ltx_p">We exploited prototype-based learning in the hyperbolic space to ensure consistent training across the clients in this very challenging setting.</p>
</div>
</li>
</ul>
</div>
</section>
<section id="S2" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">2 </span>Related Work</h2>

<div id="S2.p1" class="ltx_para">
<p id="S2.p1.1" class="ltx_p"><span id="S2.p1.1.1" class="ltx_text ltx_font_bold">Domain Adaptation</span> (DA) primarily focuses on adapting a model from a source to a target domain, typically in scenarios where the target data lacks labels, referred to as Unsupervised Domain Adaptation (UDA) <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib36" title="" class="ltx_ref">36</a>, <a href="#bib.bib43" title="" class="ltx_ref">43</a>]</cite>.
Historically, DA methods aimed to bridge the gap by quantifying domain divergence <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib45" title="" class="ltx_ref">45</a>, <a href="#bib.bib33" title="" class="ltx_ref">33</a>]</cite>. Adversarial learning has also been widely used <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib44" title="" class="ltx_ref">44</a>, <a href="#bib.bib24" title="" class="ltx_ref">24</a>, <a href="#bib.bib30" title="" class="ltx_ref">30</a>]</cite>. In the contemporary landscape, advanced approaches <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib54" title="" class="ltx_ref">54</a>, <a href="#bib.bib15" title="" class="ltx_ref">15</a>, <a href="#bib.bib28" title="" class="ltx_ref">28</a>]</cite> leverage self-learning techniques. Several other approaches have been used to align the domains such as image-to-image translation <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib47" title="" class="ltx_ref">47</a>, <a href="#bib.bib1" title="" class="ltx_ref">1</a>, <a href="#bib.bib6" title="" class="ltx_ref">6</a>]</cite>, pseudo-label prototypes <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib51" title="" class="ltx_ref">51</a>, <a href="#bib.bib23" title="" class="ltx_ref">23</a>, <a href="#bib.bib50" title="" class="ltx_ref">50</a>]</cite>, and confidence thresholding <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib28" title="" class="ltx_ref">28</a>, <a href="#bib.bib54" title="" class="ltx_ref">54</a>]</cite>. Within the objective of adapting to adverse weather conditions, Bruggemann et al. <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib3" title="" class="ltx_ref">3</a>]</cite> propose a solution that requires sunny daytime references.
To tackle nighttime images, Xiao et al. <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib46" title="" class="ltx_ref">46</a>]</cite> employed a data augmentation method leveraging multiple modalities. Finally, Source Free Domain Adaptation (SFDA) presents a distinct advantage in addressing the performance gap by allowing adaptation without access to labeled source data
<cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib19" title="" class="ltx_ref">19</a>]</cite>.</p>
</div>
<div id="S2.p2" class="ltx_para ltx_noindent">
<p id="S2.p2.1" class="ltx_p"><span id="S2.p2.1.1" class="ltx_text ltx_font_bold">Federated Learning</span> has captured the interest of the research community due to its practical applicability in various real-world scenarios and its potential to manage sensitive data <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib27" title="" class="ltx_ref">27</a>]</cite>.
In literature, it has been applied to different vision tasks <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib38" title="" class="ltx_ref">38</a>]</cite>, initially with a large emphasis on classification <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib21" title="" class="ltx_ref">21</a>, <a href="#bib.bib20" title="" class="ltx_ref">20</a>]</cite>, but more recently also focusing on other tasks including semantic segmentation for Autonomous Driving <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib5" title="" class="ltx_ref">5</a>, <a href="#bib.bib11" title="" class="ltx_ref">11</a>, <a href="#bib.bib37" title="" class="ltx_ref">37</a>]</cite>.
Most existing works in FL assume labeled data on remote clients <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib5" title="" class="ltx_ref">5</a>]</cite>, which is an unrealistic assumption, especially in the driving scenario.
Notably, Shenaj et al. <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib37" title="" class="ltx_ref">37</a>]</cite> introduce the Federated source Free Domain Adaptation (<span id="S2.p2.1.2" class="ltx_text ltx_font_smallcaps">FFreeDA</span>) setting, where only the server accesses a labeled source dataset. We address this challenge by incorporating the management of diverse viewpoints, accommodating various client types, and dealing with the influence of adverse weather conditions.</p>
</div>
<div id="S2.p3" class="ltx_para ltx_noindent">
<p id="S2.p3.1" class="ltx_p"><span id="S2.p3.1.1" class="ltx_text ltx_font_bold">Hyperbolic Prototypical Learning. </span>
Working in Euclidean spaces, implicitly or explicitly assume that data is best represented on regular grids. While this model offers an intuitive and grounded underlying manifold, its properties may not be the most suitable for all types of data <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib29" title="" class="ltx_ref">29</a>]</cite>. Inspired by developments in other fields, deep learning in hyperbolic space has recently been exploited in computer vision using different isomorphic models, such as the Poincaré model.
Several works have proposed prototypes-based hyperbolic embeddings for few-shot learning for classification <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib17" title="" class="ltx_ref">17</a>, <a href="#bib.bib14" title="" class="ltx_ref">14</a>, <a href="#bib.bib26" title="" class="ltx_ref">26</a>]</cite>, where hyperbolic space offers advantages over the Euclidean one.
In particular, Khrulkov et al. <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib17" title="" class="ltx_ref">17</a>]</cite> demonstrated its competitiveness on simple ConvNets while Gao et al. <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib12" title="" class="ltx_ref">12</a>]</cite> show the benefits achievable with different curvatures.
Atigh et al. <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib2" title="" class="ltx_ref">2</a>]</cite> introduced approximations for faster computations tailored for use in semantic segmentation. Facing these insights, hyperbolic prototypical learning seems suitable for learning features robust to domain shift and varying weather conditions even when employing different curvatures and lightweight networks, as those used on clients in federated scenarios. Building upon these foundations, our approach exploits hyperbolic learning to align features from diverse viewpoints while reducing domain shift.</p>
</div>
</section>
<section id="S3" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">3 </span>Problem Formulation</h2>

<div id="S3.p1" class="ltx_para">
<p id="S3.p1.1" class="ltx_p">Most works in Federated Learning operate under the assumption of labeled data being available on remote clients <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib5" title="" class="ltx_ref">5</a>]</cite>. Providing semantic segmentation ground truth is extremely time-consuming and costly, thus it is quite unrealistic to expect labeled data on real-world clients, especially during the deployment phase.
Therefore, our objective is to develop a model that can seamlessly adapt from labeled synthetic data to unlabeled real-world images in a distributed paradigm.
For this reason, we chose to deploy our setting on top of the pre-existing <span id="S3.p1.1.1" class="ltx_text ltx_font_smallcaps">FFreeDA</span> scenario <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib37" title="" class="ltx_ref">37</a>]</cite>. Moreover, we discard the assumption that the clients are homogeneous in nature and consider a setting where different autonomous agents work cooperatively in fluctuating atmospheric conditions (<em id="S3.p1.1.2" class="ltx_emph ltx_font_italic">i.e</em>.<span id="S3.p1.1.3" class="ltx_text"></span>, clear sky, night, rain and fog).
In the following, we will first formalize the problem and then move to a detailed description of the methodologies proposed to tackle it in <a href="#S4" title="4 Training Procedure ‣ When Cars meet Drones: Hyperbolic Federated Learning for Source-Free Domain Adaptation in Adverse Weather" class="ltx_ref"><span class="ltx_text ltx_ref_tag">Sec.</span> <span class="ltx_text ltx_ref_tag">4</span></a>.
<br class="ltx_break"></p>
</div>
<div id="S3.p2" class="ltx_para ltx_noindent">
<p id="S3.p2.7" class="ltx_p"><span id="S3.p2.7.1" class="ltx_text ltx_font_bold">Source-Free Domain Adaptation (SFDA).</span>
Consider an image <math id="S3.p2.1.m1.1" class="ltx_Math" alttext="x\!\in\!\!\mathcal{X}\!\subset\!\!\mathbf{R}^{|\mathcal{I}|x3}" display="inline"><semantics id="S3.p2.1.m1.1a"><mrow id="S3.p2.1.m1.1.2" xref="S3.p2.1.m1.1.2.cmml"><mi id="S3.p2.1.m1.1.2.2" xref="S3.p2.1.m1.1.2.2.cmml">x</mi><mpadded width="0.615em"><mo lspace="0.108em" id="S3.p2.1.m1.1.2.3" xref="S3.p2.1.m1.1.2.3.cmml">∈</mo></mpadded><mi class="ltx_font_mathcaligraphic" id="S3.p2.1.m1.1.2.4" xref="S3.p2.1.m1.1.2.4.cmml">𝒳</mi><mpadded width="0.726em"><mo lspace="0.108em" id="S3.p2.1.m1.1.2.5" xref="S3.p2.1.m1.1.2.5.cmml">⊂</mo></mpadded><msup id="S3.p2.1.m1.1.2.6" xref="S3.p2.1.m1.1.2.6.cmml"><mi id="S3.p2.1.m1.1.2.6.2" xref="S3.p2.1.m1.1.2.6.2.cmml">𝐑</mi><mrow id="S3.p2.1.m1.1.1.1" xref="S3.p2.1.m1.1.1.1.cmml"><mrow id="S3.p2.1.m1.1.1.1.3.2" xref="S3.p2.1.m1.1.1.1.3.1.cmml"><mo stretchy="false" id="S3.p2.1.m1.1.1.1.3.2.1" xref="S3.p2.1.m1.1.1.1.3.1.1.cmml">|</mo><mi class="ltx_font_mathcaligraphic" id="S3.p2.1.m1.1.1.1.1" xref="S3.p2.1.m1.1.1.1.1.cmml">ℐ</mi><mo stretchy="false" id="S3.p2.1.m1.1.1.1.3.2.2" xref="S3.p2.1.m1.1.1.1.3.1.1.cmml">|</mo></mrow><mo lspace="0em" rspace="0em" id="S3.p2.1.m1.1.1.1.2" xref="S3.p2.1.m1.1.1.1.2.cmml">​</mo><mi id="S3.p2.1.m1.1.1.1.4" xref="S3.p2.1.m1.1.1.1.4.cmml">x</mi><mo lspace="0em" rspace="0em" id="S3.p2.1.m1.1.1.1.2a" xref="S3.p2.1.m1.1.1.1.2.cmml">​</mo><mn id="S3.p2.1.m1.1.1.1.5" xref="S3.p2.1.m1.1.1.1.5.cmml">3</mn></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S3.p2.1.m1.1b"><apply id="S3.p2.1.m1.1.2.cmml" xref="S3.p2.1.m1.1.2"><and id="S3.p2.1.m1.1.2a.cmml" xref="S3.p2.1.m1.1.2"></and><apply id="S3.p2.1.m1.1.2b.cmml" xref="S3.p2.1.m1.1.2"><in id="S3.p2.1.m1.1.2.3.cmml" xref="S3.p2.1.m1.1.2.3"></in><ci id="S3.p2.1.m1.1.2.2.cmml" xref="S3.p2.1.m1.1.2.2">𝑥</ci><ci id="S3.p2.1.m1.1.2.4.cmml" xref="S3.p2.1.m1.1.2.4">𝒳</ci></apply><apply id="S3.p2.1.m1.1.2c.cmml" xref="S3.p2.1.m1.1.2"><subset id="S3.p2.1.m1.1.2.5.cmml" xref="S3.p2.1.m1.1.2.5"></subset><share href="#S3.p2.1.m1.1.2.4.cmml" id="S3.p2.1.m1.1.2d.cmml" xref="S3.p2.1.m1.1.2"></share><apply id="S3.p2.1.m1.1.2.6.cmml" xref="S3.p2.1.m1.1.2.6"><csymbol cd="ambiguous" id="S3.p2.1.m1.1.2.6.1.cmml" xref="S3.p2.1.m1.1.2.6">superscript</csymbol><ci id="S3.p2.1.m1.1.2.6.2.cmml" xref="S3.p2.1.m1.1.2.6.2">𝐑</ci><apply id="S3.p2.1.m1.1.1.1.cmml" xref="S3.p2.1.m1.1.1.1"><times id="S3.p2.1.m1.1.1.1.2.cmml" xref="S3.p2.1.m1.1.1.1.2"></times><apply id="S3.p2.1.m1.1.1.1.3.1.cmml" xref="S3.p2.1.m1.1.1.1.3.2"><abs id="S3.p2.1.m1.1.1.1.3.1.1.cmml" xref="S3.p2.1.m1.1.1.1.3.2.1"></abs><ci id="S3.p2.1.m1.1.1.1.1.cmml" xref="S3.p2.1.m1.1.1.1.1">ℐ</ci></apply><ci id="S3.p2.1.m1.1.1.1.4.cmml" xref="S3.p2.1.m1.1.1.1.4">𝑥</ci><cn type="integer" id="S3.p2.1.m1.1.1.1.5.cmml" xref="S3.p2.1.m1.1.1.1.5">3</cn></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p2.1.m1.1c">x\!\in\!\!\mathcal{X}\!\subset\!\!\mathbf{R}^{|\mathcal{I}|x3}</annotation></semantics></math> and its corresponding label <math id="S3.p2.2.m2.1" class="ltx_Math" alttext="y\in\mathcal{Y}\subset\mathbf{R}^{C}" display="inline"><semantics id="S3.p2.2.m2.1a"><mrow id="S3.p2.2.m2.1.1" xref="S3.p2.2.m2.1.1.cmml"><mi id="S3.p2.2.m2.1.1.2" xref="S3.p2.2.m2.1.1.2.cmml">y</mi><mo id="S3.p2.2.m2.1.1.3" xref="S3.p2.2.m2.1.1.3.cmml">∈</mo><mi class="ltx_font_mathcaligraphic" id="S3.p2.2.m2.1.1.4" xref="S3.p2.2.m2.1.1.4.cmml">𝒴</mi><mo id="S3.p2.2.m2.1.1.5" xref="S3.p2.2.m2.1.1.5.cmml">⊂</mo><msup id="S3.p2.2.m2.1.1.6" xref="S3.p2.2.m2.1.1.6.cmml"><mi id="S3.p2.2.m2.1.1.6.2" xref="S3.p2.2.m2.1.1.6.2.cmml">𝐑</mi><mi id="S3.p2.2.m2.1.1.6.3" xref="S3.p2.2.m2.1.1.6.3.cmml">C</mi></msup></mrow><annotation-xml encoding="MathML-Content" id="S3.p2.2.m2.1b"><apply id="S3.p2.2.m2.1.1.cmml" xref="S3.p2.2.m2.1.1"><and id="S3.p2.2.m2.1.1a.cmml" xref="S3.p2.2.m2.1.1"></and><apply id="S3.p2.2.m2.1.1b.cmml" xref="S3.p2.2.m2.1.1"><in id="S3.p2.2.m2.1.1.3.cmml" xref="S3.p2.2.m2.1.1.3"></in><ci id="S3.p2.2.m2.1.1.2.cmml" xref="S3.p2.2.m2.1.1.2">𝑦</ci><ci id="S3.p2.2.m2.1.1.4.cmml" xref="S3.p2.2.m2.1.1.4">𝒴</ci></apply><apply id="S3.p2.2.m2.1.1c.cmml" xref="S3.p2.2.m2.1.1"><subset id="S3.p2.2.m2.1.1.5.cmml" xref="S3.p2.2.m2.1.1.5"></subset><share href="#S3.p2.2.m2.1.1.4.cmml" id="S3.p2.2.m2.1.1d.cmml" xref="S3.p2.2.m2.1.1"></share><apply id="S3.p2.2.m2.1.1.6.cmml" xref="S3.p2.2.m2.1.1.6"><csymbol cd="ambiguous" id="S3.p2.2.m2.1.1.6.1.cmml" xref="S3.p2.2.m2.1.1.6">superscript</csymbol><ci id="S3.p2.2.m2.1.1.6.2.cmml" xref="S3.p2.2.m2.1.1.6.2">𝐑</ci><ci id="S3.p2.2.m2.1.1.6.3.cmml" xref="S3.p2.2.m2.1.1.6.3">𝐶</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p2.2.m2.1c">y\in\mathcal{Y}\subset\mathbf{R}^{C}</annotation></semantics></math>, where <math id="S3.p2.3.m3.1" class="ltx_Math" alttext="|\mathcal{I}|=H\times W" display="inline"><semantics id="S3.p2.3.m3.1a"><mrow id="S3.p2.3.m3.1.2" xref="S3.p2.3.m3.1.2.cmml"><mrow id="S3.p2.3.m3.1.2.2.2" xref="S3.p2.3.m3.1.2.2.1.cmml"><mo stretchy="false" id="S3.p2.3.m3.1.2.2.2.1" xref="S3.p2.3.m3.1.2.2.1.1.cmml">|</mo><mi class="ltx_font_mathcaligraphic" id="S3.p2.3.m3.1.1" xref="S3.p2.3.m3.1.1.cmml">ℐ</mi><mo stretchy="false" id="S3.p2.3.m3.1.2.2.2.2" xref="S3.p2.3.m3.1.2.2.1.1.cmml">|</mo></mrow><mo id="S3.p2.3.m3.1.2.1" xref="S3.p2.3.m3.1.2.1.cmml">=</mo><mrow id="S3.p2.3.m3.1.2.3" xref="S3.p2.3.m3.1.2.3.cmml"><mi id="S3.p2.3.m3.1.2.3.2" xref="S3.p2.3.m3.1.2.3.2.cmml">H</mi><mo lspace="0.222em" rspace="0.222em" id="S3.p2.3.m3.1.2.3.1" xref="S3.p2.3.m3.1.2.3.1.cmml">×</mo><mi id="S3.p2.3.m3.1.2.3.3" xref="S3.p2.3.m3.1.2.3.3.cmml">W</mi></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.p2.3.m3.1b"><apply id="S3.p2.3.m3.1.2.cmml" xref="S3.p2.3.m3.1.2"><eq id="S3.p2.3.m3.1.2.1.cmml" xref="S3.p2.3.m3.1.2.1"></eq><apply id="S3.p2.3.m3.1.2.2.1.cmml" xref="S3.p2.3.m3.1.2.2.2"><abs id="S3.p2.3.m3.1.2.2.1.1.cmml" xref="S3.p2.3.m3.1.2.2.2.1"></abs><ci id="S3.p2.3.m3.1.1.cmml" xref="S3.p2.3.m3.1.1">ℐ</ci></apply><apply id="S3.p2.3.m3.1.2.3.cmml" xref="S3.p2.3.m3.1.2.3"><times id="S3.p2.3.m3.1.2.3.1.cmml" xref="S3.p2.3.m3.1.2.3.1"></times><ci id="S3.p2.3.m3.1.2.3.2.cmml" xref="S3.p2.3.m3.1.2.3.2">𝐻</ci><ci id="S3.p2.3.m3.1.2.3.3.cmml" xref="S3.p2.3.m3.1.2.3.3">𝑊</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p2.3.m3.1c">|\mathcal{I}|=H\times W</annotation></semantics></math> are the image dimensions and <math id="S3.p2.4.m4.1" class="ltx_Math" alttext="C" display="inline"><semantics id="S3.p2.4.m4.1a"><mi id="S3.p2.4.m4.1.1" xref="S3.p2.4.m4.1.1.cmml">C</mi><annotation-xml encoding="MathML-Content" id="S3.p2.4.m4.1b"><ci id="S3.p2.4.m4.1.1.cmml" xref="S3.p2.4.m4.1.1">𝐶</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.p2.4.m4.1c">C</annotation></semantics></math> is the number of classes.
SFDA entails a pretraining phase on a source dataset <math id="S3.p2.5.m5.1" class="ltx_Math" alttext="\mathcal{D}^{S}=\{(x^{s},y^{s})\}^{N^{s}}" display="inline"><semantics id="S3.p2.5.m5.1a"><mrow id="S3.p2.5.m5.1.1" xref="S3.p2.5.m5.1.1.cmml"><msup id="S3.p2.5.m5.1.1.3" xref="S3.p2.5.m5.1.1.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.p2.5.m5.1.1.3.2" xref="S3.p2.5.m5.1.1.3.2.cmml">𝒟</mi><mi id="S3.p2.5.m5.1.1.3.3" xref="S3.p2.5.m5.1.1.3.3.cmml">S</mi></msup><mo id="S3.p2.5.m5.1.1.2" xref="S3.p2.5.m5.1.1.2.cmml">=</mo><msup id="S3.p2.5.m5.1.1.1" xref="S3.p2.5.m5.1.1.1.cmml"><mrow id="S3.p2.5.m5.1.1.1.1.1" xref="S3.p2.5.m5.1.1.1.1.2.cmml"><mo stretchy="false" id="S3.p2.5.m5.1.1.1.1.1.2" xref="S3.p2.5.m5.1.1.1.1.2.cmml">{</mo><mrow id="S3.p2.5.m5.1.1.1.1.1.1.2" xref="S3.p2.5.m5.1.1.1.1.1.1.3.cmml"><mo stretchy="false" id="S3.p2.5.m5.1.1.1.1.1.1.2.3" xref="S3.p2.5.m5.1.1.1.1.1.1.3.cmml">(</mo><msup id="S3.p2.5.m5.1.1.1.1.1.1.1.1" xref="S3.p2.5.m5.1.1.1.1.1.1.1.1.cmml"><mi id="S3.p2.5.m5.1.1.1.1.1.1.1.1.2" xref="S3.p2.5.m5.1.1.1.1.1.1.1.1.2.cmml">x</mi><mi id="S3.p2.5.m5.1.1.1.1.1.1.1.1.3" xref="S3.p2.5.m5.1.1.1.1.1.1.1.1.3.cmml">s</mi></msup><mo id="S3.p2.5.m5.1.1.1.1.1.1.2.4" xref="S3.p2.5.m5.1.1.1.1.1.1.3.cmml">,</mo><msup id="S3.p2.5.m5.1.1.1.1.1.1.2.2" xref="S3.p2.5.m5.1.1.1.1.1.1.2.2.cmml"><mi id="S3.p2.5.m5.1.1.1.1.1.1.2.2.2" xref="S3.p2.5.m5.1.1.1.1.1.1.2.2.2.cmml">y</mi><mi id="S3.p2.5.m5.1.1.1.1.1.1.2.2.3" xref="S3.p2.5.m5.1.1.1.1.1.1.2.2.3.cmml">s</mi></msup><mo stretchy="false" id="S3.p2.5.m5.1.1.1.1.1.1.2.5" xref="S3.p2.5.m5.1.1.1.1.1.1.3.cmml">)</mo></mrow><mo stretchy="false" id="S3.p2.5.m5.1.1.1.1.1.3" xref="S3.p2.5.m5.1.1.1.1.2.cmml">}</mo></mrow><msup id="S3.p2.5.m5.1.1.1.3" xref="S3.p2.5.m5.1.1.1.3.cmml"><mi id="S3.p2.5.m5.1.1.1.3.2" xref="S3.p2.5.m5.1.1.1.3.2.cmml">N</mi><mi id="S3.p2.5.m5.1.1.1.3.3" xref="S3.p2.5.m5.1.1.1.3.3.cmml">s</mi></msup></msup></mrow><annotation-xml encoding="MathML-Content" id="S3.p2.5.m5.1b"><apply id="S3.p2.5.m5.1.1.cmml" xref="S3.p2.5.m5.1.1"><eq id="S3.p2.5.m5.1.1.2.cmml" xref="S3.p2.5.m5.1.1.2"></eq><apply id="S3.p2.5.m5.1.1.3.cmml" xref="S3.p2.5.m5.1.1.3"><csymbol cd="ambiguous" id="S3.p2.5.m5.1.1.3.1.cmml" xref="S3.p2.5.m5.1.1.3">superscript</csymbol><ci id="S3.p2.5.m5.1.1.3.2.cmml" xref="S3.p2.5.m5.1.1.3.2">𝒟</ci><ci id="S3.p2.5.m5.1.1.3.3.cmml" xref="S3.p2.5.m5.1.1.3.3">𝑆</ci></apply><apply id="S3.p2.5.m5.1.1.1.cmml" xref="S3.p2.5.m5.1.1.1"><csymbol cd="ambiguous" id="S3.p2.5.m5.1.1.1.2.cmml" xref="S3.p2.5.m5.1.1.1">superscript</csymbol><set id="S3.p2.5.m5.1.1.1.1.2.cmml" xref="S3.p2.5.m5.1.1.1.1.1"><interval closure="open" id="S3.p2.5.m5.1.1.1.1.1.1.3.cmml" xref="S3.p2.5.m5.1.1.1.1.1.1.2"><apply id="S3.p2.5.m5.1.1.1.1.1.1.1.1.cmml" xref="S3.p2.5.m5.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.p2.5.m5.1.1.1.1.1.1.1.1.1.cmml" xref="S3.p2.5.m5.1.1.1.1.1.1.1.1">superscript</csymbol><ci id="S3.p2.5.m5.1.1.1.1.1.1.1.1.2.cmml" xref="S3.p2.5.m5.1.1.1.1.1.1.1.1.2">𝑥</ci><ci id="S3.p2.5.m5.1.1.1.1.1.1.1.1.3.cmml" xref="S3.p2.5.m5.1.1.1.1.1.1.1.1.3">𝑠</ci></apply><apply id="S3.p2.5.m5.1.1.1.1.1.1.2.2.cmml" xref="S3.p2.5.m5.1.1.1.1.1.1.2.2"><csymbol cd="ambiguous" id="S3.p2.5.m5.1.1.1.1.1.1.2.2.1.cmml" xref="S3.p2.5.m5.1.1.1.1.1.1.2.2">superscript</csymbol><ci id="S3.p2.5.m5.1.1.1.1.1.1.2.2.2.cmml" xref="S3.p2.5.m5.1.1.1.1.1.1.2.2.2">𝑦</ci><ci id="S3.p2.5.m5.1.1.1.1.1.1.2.2.3.cmml" xref="S3.p2.5.m5.1.1.1.1.1.1.2.2.3">𝑠</ci></apply></interval></set><apply id="S3.p2.5.m5.1.1.1.3.cmml" xref="S3.p2.5.m5.1.1.1.3"><csymbol cd="ambiguous" id="S3.p2.5.m5.1.1.1.3.1.cmml" xref="S3.p2.5.m5.1.1.1.3">superscript</csymbol><ci id="S3.p2.5.m5.1.1.1.3.2.cmml" xref="S3.p2.5.m5.1.1.1.3.2">𝑁</ci><ci id="S3.p2.5.m5.1.1.1.3.3.cmml" xref="S3.p2.5.m5.1.1.1.3.3">𝑠</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p2.5.m5.1c">\mathcal{D}^{S}=\{(x^{s},y^{s})\}^{N^{s}}</annotation></semantics></math>, made of pairs of images and labels, and an adaptation stage on a target dataset <math id="S3.p2.6.m6.1" class="ltx_Math" alttext="\mathcal{D}^{T}=\{(x^{T})\}^{N^{T}}" display="inline"><semantics id="S3.p2.6.m6.1a"><mrow id="S3.p2.6.m6.1.1" xref="S3.p2.6.m6.1.1.cmml"><msup id="S3.p2.6.m6.1.1.3" xref="S3.p2.6.m6.1.1.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.p2.6.m6.1.1.3.2" xref="S3.p2.6.m6.1.1.3.2.cmml">𝒟</mi><mi id="S3.p2.6.m6.1.1.3.3" xref="S3.p2.6.m6.1.1.3.3.cmml">T</mi></msup><mo id="S3.p2.6.m6.1.1.2" xref="S3.p2.6.m6.1.1.2.cmml">=</mo><msup id="S3.p2.6.m6.1.1.1" xref="S3.p2.6.m6.1.1.1.cmml"><mrow id="S3.p2.6.m6.1.1.1.1.1" xref="S3.p2.6.m6.1.1.1.1.2.cmml"><mo stretchy="false" id="S3.p2.6.m6.1.1.1.1.1.2" xref="S3.p2.6.m6.1.1.1.1.2.cmml">{</mo><mrow id="S3.p2.6.m6.1.1.1.1.1.1.1" xref="S3.p2.6.m6.1.1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S3.p2.6.m6.1.1.1.1.1.1.1.2" xref="S3.p2.6.m6.1.1.1.1.1.1.1.1.cmml">(</mo><msup id="S3.p2.6.m6.1.1.1.1.1.1.1.1" xref="S3.p2.6.m6.1.1.1.1.1.1.1.1.cmml"><mi id="S3.p2.6.m6.1.1.1.1.1.1.1.1.2" xref="S3.p2.6.m6.1.1.1.1.1.1.1.1.2.cmml">x</mi><mi id="S3.p2.6.m6.1.1.1.1.1.1.1.1.3" xref="S3.p2.6.m6.1.1.1.1.1.1.1.1.3.cmml">T</mi></msup><mo stretchy="false" id="S3.p2.6.m6.1.1.1.1.1.1.1.3" xref="S3.p2.6.m6.1.1.1.1.1.1.1.1.cmml">)</mo></mrow><mo stretchy="false" id="S3.p2.6.m6.1.1.1.1.1.3" xref="S3.p2.6.m6.1.1.1.1.2.cmml">}</mo></mrow><msup id="S3.p2.6.m6.1.1.1.3" xref="S3.p2.6.m6.1.1.1.3.cmml"><mi id="S3.p2.6.m6.1.1.1.3.2" xref="S3.p2.6.m6.1.1.1.3.2.cmml">N</mi><mi id="S3.p2.6.m6.1.1.1.3.3" xref="S3.p2.6.m6.1.1.1.3.3.cmml">T</mi></msup></msup></mrow><annotation-xml encoding="MathML-Content" id="S3.p2.6.m6.1b"><apply id="S3.p2.6.m6.1.1.cmml" xref="S3.p2.6.m6.1.1"><eq id="S3.p2.6.m6.1.1.2.cmml" xref="S3.p2.6.m6.1.1.2"></eq><apply id="S3.p2.6.m6.1.1.3.cmml" xref="S3.p2.6.m6.1.1.3"><csymbol cd="ambiguous" id="S3.p2.6.m6.1.1.3.1.cmml" xref="S3.p2.6.m6.1.1.3">superscript</csymbol><ci id="S3.p2.6.m6.1.1.3.2.cmml" xref="S3.p2.6.m6.1.1.3.2">𝒟</ci><ci id="S3.p2.6.m6.1.1.3.3.cmml" xref="S3.p2.6.m6.1.1.3.3">𝑇</ci></apply><apply id="S3.p2.6.m6.1.1.1.cmml" xref="S3.p2.6.m6.1.1.1"><csymbol cd="ambiguous" id="S3.p2.6.m6.1.1.1.2.cmml" xref="S3.p2.6.m6.1.1.1">superscript</csymbol><set id="S3.p2.6.m6.1.1.1.1.2.cmml" xref="S3.p2.6.m6.1.1.1.1.1"><apply id="S3.p2.6.m6.1.1.1.1.1.1.1.1.cmml" xref="S3.p2.6.m6.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.p2.6.m6.1.1.1.1.1.1.1.1.1.cmml" xref="S3.p2.6.m6.1.1.1.1.1.1.1">superscript</csymbol><ci id="S3.p2.6.m6.1.1.1.1.1.1.1.1.2.cmml" xref="S3.p2.6.m6.1.1.1.1.1.1.1.1.2">𝑥</ci><ci id="S3.p2.6.m6.1.1.1.1.1.1.1.1.3.cmml" xref="S3.p2.6.m6.1.1.1.1.1.1.1.1.3">𝑇</ci></apply></set><apply id="S3.p2.6.m6.1.1.1.3.cmml" xref="S3.p2.6.m6.1.1.1.3"><csymbol cd="ambiguous" id="S3.p2.6.m6.1.1.1.3.1.cmml" xref="S3.p2.6.m6.1.1.1.3">superscript</csymbol><ci id="S3.p2.6.m6.1.1.1.3.2.cmml" xref="S3.p2.6.m6.1.1.1.3.2">𝑁</ci><ci id="S3.p2.6.m6.1.1.1.3.3.cmml" xref="S3.p2.6.m6.1.1.1.3.3">𝑇</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p2.6.m6.1c">\mathcal{D}^{T}=\{(x^{T})\}^{N^{T}}</annotation></semantics></math>, composed of unlabeled images. Specifically, compared to standard DA: 1) the two training phases are distinct; 2) <math id="S3.p2.7.m7.1" class="ltx_Math" alttext="\mathcal{D}^{S}" display="inline"><semantics id="S3.p2.7.m7.1a"><msup id="S3.p2.7.m7.1.1" xref="S3.p2.7.m7.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.p2.7.m7.1.1.2" xref="S3.p2.7.m7.1.1.2.cmml">𝒟</mi><mi id="S3.p2.7.m7.1.1.3" xref="S3.p2.7.m7.1.1.3.cmml">S</mi></msup><annotation-xml encoding="MathML-Content" id="S3.p2.7.m7.1b"><apply id="S3.p2.7.m7.1.1.cmml" xref="S3.p2.7.m7.1.1"><csymbol cd="ambiguous" id="S3.p2.7.m7.1.1.1.cmml" xref="S3.p2.7.m7.1.1">superscript</csymbol><ci id="S3.p2.7.m7.1.1.2.cmml" xref="S3.p2.7.m7.1.1.2">𝒟</ci><ci id="S3.p2.7.m7.1.1.3.cmml" xref="S3.p2.7.m7.1.1.3">𝑆</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p2.7.m7.1c">\mathcal{D}^{S}</annotation></semantics></math> is unavailable at the adaptation phase.</p>
</div>
<div id="S3.p3" class="ltx_para ltx_noindent">
<p id="S3.p3.11" class="ltx_p"><span id="S3.p3.11.1" class="ltx_text ltx_font_bold">Federated source-Free Domain Adaptation (<span id="S3.p3.11.1.1" class="ltx_text ltx_font_smallcaps">FFreeDA</span>).</span> This setting deals with a distributed setup comprising a central server and a set of clients <math id="S3.p3.1.m1.1" class="ltx_Math" alttext="\mathcal{K}" display="inline"><semantics id="S3.p3.1.m1.1a"><mi class="ltx_font_mathcaligraphic" id="S3.p3.1.m1.1.1" xref="S3.p3.1.m1.1.1.cmml">𝒦</mi><annotation-xml encoding="MathML-Content" id="S3.p3.1.m1.1b"><ci id="S3.p3.1.m1.1.1.cmml" xref="S3.p3.1.m1.1.1">𝒦</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.p3.1.m1.1c">\mathcal{K}</annotation></semantics></math> with <math id="S3.p3.2.m2.1" class="ltx_Math" alttext="\left|\mathcal{K}\right|=K" display="inline"><semantics id="S3.p3.2.m2.1a"><mrow id="S3.p3.2.m2.1.2" xref="S3.p3.2.m2.1.2.cmml"><mrow id="S3.p3.2.m2.1.2.2.2" xref="S3.p3.2.m2.1.2.2.1.cmml"><mo id="S3.p3.2.m2.1.2.2.2.1" xref="S3.p3.2.m2.1.2.2.1.1.cmml">|</mo><mi class="ltx_font_mathcaligraphic" id="S3.p3.2.m2.1.1" xref="S3.p3.2.m2.1.1.cmml">𝒦</mi><mo id="S3.p3.2.m2.1.2.2.2.2" xref="S3.p3.2.m2.1.2.2.1.1.cmml">|</mo></mrow><mo id="S3.p3.2.m2.1.2.1" xref="S3.p3.2.m2.1.2.1.cmml">=</mo><mi id="S3.p3.2.m2.1.2.3" xref="S3.p3.2.m2.1.2.3.cmml">K</mi></mrow><annotation-xml encoding="MathML-Content" id="S3.p3.2.m2.1b"><apply id="S3.p3.2.m2.1.2.cmml" xref="S3.p3.2.m2.1.2"><eq id="S3.p3.2.m2.1.2.1.cmml" xref="S3.p3.2.m2.1.2.1"></eq><apply id="S3.p3.2.m2.1.2.2.1.cmml" xref="S3.p3.2.m2.1.2.2.2"><abs id="S3.p3.2.m2.1.2.2.1.1.cmml" xref="S3.p3.2.m2.1.2.2.2.1"></abs><ci id="S3.p3.2.m2.1.1.cmml" xref="S3.p3.2.m2.1.1">𝒦</ci></apply><ci id="S3.p3.2.m2.1.2.3.cmml" xref="S3.p3.2.m2.1.2.3">𝐾</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p3.2.m2.1c">\left|\mathcal{K}\right|=K</annotation></semantics></math>.
The training datasets are organized as follows: the primary dataset <math id="S3.p3.3.m3.1" class="ltx_Math" alttext="\mathcal{D}^{S}" display="inline"><semantics id="S3.p3.3.m3.1a"><msup id="S3.p3.3.m3.1.1" xref="S3.p3.3.m3.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.p3.3.m3.1.1.2" xref="S3.p3.3.m3.1.1.2.cmml">𝒟</mi><mi id="S3.p3.3.m3.1.1.3" xref="S3.p3.3.m3.1.1.3.cmml">S</mi></msup><annotation-xml encoding="MathML-Content" id="S3.p3.3.m3.1b"><apply id="S3.p3.3.m3.1.1.cmml" xref="S3.p3.3.m3.1.1"><csymbol cd="ambiguous" id="S3.p3.3.m3.1.1.1.cmml" xref="S3.p3.3.m3.1.1">superscript</csymbol><ci id="S3.p3.3.m3.1.1.2.cmml" xref="S3.p3.3.m3.1.1.2">𝒟</ci><ci id="S3.p3.3.m3.1.1.3.cmml" xref="S3.p3.3.m3.1.1.3">𝑆</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p3.3.m3.1c">\mathcal{D}^{S}</annotation></semantics></math>, resides on the server side. Concurrently, each of the <math id="S3.p3.4.m4.1" class="ltx_Math" alttext="K" display="inline"><semantics id="S3.p3.4.m4.1a"><mi id="S3.p3.4.m4.1.1" xref="S3.p3.4.m4.1.1.cmml">K</mi><annotation-xml encoding="MathML-Content" id="S3.p3.4.m4.1b"><ci id="S3.p3.4.m4.1.1.cmml" xref="S3.p3.4.m4.1.1">𝐾</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.p3.4.m4.1c">K</annotation></semantics></math> client has a distinct training dataset denoted as <math id="S3.p3.5.m5.4" class="ltx_Math" alttext="\mathcal{D}^{T}_{k}=\{x_{k,i}^{T}\in\mathcal{X}:\forall i\in|\mathcal{D}^{T}_{k}|\}" display="inline"><semantics id="S3.p3.5.m5.4a"><mrow id="S3.p3.5.m5.4.4" xref="S3.p3.5.m5.4.4.cmml"><msubsup id="S3.p3.5.m5.4.4.4" xref="S3.p3.5.m5.4.4.4.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.p3.5.m5.4.4.4.2.2" xref="S3.p3.5.m5.4.4.4.2.2.cmml">𝒟</mi><mi id="S3.p3.5.m5.4.4.4.3" xref="S3.p3.5.m5.4.4.4.3.cmml">k</mi><mi id="S3.p3.5.m5.4.4.4.2.3" xref="S3.p3.5.m5.4.4.4.2.3.cmml">T</mi></msubsup><mo id="S3.p3.5.m5.4.4.3" xref="S3.p3.5.m5.4.4.3.cmml">=</mo><mrow id="S3.p3.5.m5.4.4.2.2" xref="S3.p3.5.m5.4.4.2.3.cmml"><mo stretchy="false" id="S3.p3.5.m5.4.4.2.2.3" xref="S3.p3.5.m5.4.4.2.3.1.cmml">{</mo><mrow id="S3.p3.5.m5.3.3.1.1.1" xref="S3.p3.5.m5.3.3.1.1.1.cmml"><msubsup id="S3.p3.5.m5.3.3.1.1.1.2" xref="S3.p3.5.m5.3.3.1.1.1.2.cmml"><mi id="S3.p3.5.m5.3.3.1.1.1.2.2.2" xref="S3.p3.5.m5.3.3.1.1.1.2.2.2.cmml">x</mi><mrow id="S3.p3.5.m5.2.2.2.4" xref="S3.p3.5.m5.2.2.2.3.cmml"><mi id="S3.p3.5.m5.1.1.1.1" xref="S3.p3.5.m5.1.1.1.1.cmml">k</mi><mo id="S3.p3.5.m5.2.2.2.4.1" xref="S3.p3.5.m5.2.2.2.3.cmml">,</mo><mi id="S3.p3.5.m5.2.2.2.2" xref="S3.p3.5.m5.2.2.2.2.cmml">i</mi></mrow><mi id="S3.p3.5.m5.3.3.1.1.1.2.3" xref="S3.p3.5.m5.3.3.1.1.1.2.3.cmml">T</mi></msubsup><mo id="S3.p3.5.m5.3.3.1.1.1.1" xref="S3.p3.5.m5.3.3.1.1.1.1.cmml">∈</mo><mi class="ltx_font_mathcaligraphic" id="S3.p3.5.m5.3.3.1.1.1.3" xref="S3.p3.5.m5.3.3.1.1.1.3.cmml">𝒳</mi></mrow><mo lspace="0.278em" rspace="0.278em" id="S3.p3.5.m5.4.4.2.2.4" xref="S3.p3.5.m5.4.4.2.3.1.cmml">:</mo><mrow id="S3.p3.5.m5.4.4.2.2.2" xref="S3.p3.5.m5.4.4.2.2.2.cmml"><mrow id="S3.p3.5.m5.4.4.2.2.2.3" xref="S3.p3.5.m5.4.4.2.2.2.3.cmml"><mo rspace="0.167em" id="S3.p3.5.m5.4.4.2.2.2.3.1" xref="S3.p3.5.m5.4.4.2.2.2.3.1.cmml">∀</mo><mi id="S3.p3.5.m5.4.4.2.2.2.3.2" xref="S3.p3.5.m5.4.4.2.2.2.3.2.cmml">i</mi></mrow><mo id="S3.p3.5.m5.4.4.2.2.2.2" xref="S3.p3.5.m5.4.4.2.2.2.2.cmml">∈</mo><mrow id="S3.p3.5.m5.4.4.2.2.2.1.1" xref="S3.p3.5.m5.4.4.2.2.2.1.2.cmml"><mo stretchy="false" id="S3.p3.5.m5.4.4.2.2.2.1.1.2" xref="S3.p3.5.m5.4.4.2.2.2.1.2.1.cmml">|</mo><msubsup id="S3.p3.5.m5.4.4.2.2.2.1.1.1" xref="S3.p3.5.m5.4.4.2.2.2.1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.p3.5.m5.4.4.2.2.2.1.1.1.2.2" xref="S3.p3.5.m5.4.4.2.2.2.1.1.1.2.2.cmml">𝒟</mi><mi id="S3.p3.5.m5.4.4.2.2.2.1.1.1.3" xref="S3.p3.5.m5.4.4.2.2.2.1.1.1.3.cmml">k</mi><mi id="S3.p3.5.m5.4.4.2.2.2.1.1.1.2.3" xref="S3.p3.5.m5.4.4.2.2.2.1.1.1.2.3.cmml">T</mi></msubsup><mo stretchy="false" id="S3.p3.5.m5.4.4.2.2.2.1.1.3" xref="S3.p3.5.m5.4.4.2.2.2.1.2.1.cmml">|</mo></mrow></mrow><mo stretchy="false" id="S3.p3.5.m5.4.4.2.2.5" xref="S3.p3.5.m5.4.4.2.3.1.cmml">}</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.p3.5.m5.4b"><apply id="S3.p3.5.m5.4.4.cmml" xref="S3.p3.5.m5.4.4"><eq id="S3.p3.5.m5.4.4.3.cmml" xref="S3.p3.5.m5.4.4.3"></eq><apply id="S3.p3.5.m5.4.4.4.cmml" xref="S3.p3.5.m5.4.4.4"><csymbol cd="ambiguous" id="S3.p3.5.m5.4.4.4.1.cmml" xref="S3.p3.5.m5.4.4.4">subscript</csymbol><apply id="S3.p3.5.m5.4.4.4.2.cmml" xref="S3.p3.5.m5.4.4.4"><csymbol cd="ambiguous" id="S3.p3.5.m5.4.4.4.2.1.cmml" xref="S3.p3.5.m5.4.4.4">superscript</csymbol><ci id="S3.p3.5.m5.4.4.4.2.2.cmml" xref="S3.p3.5.m5.4.4.4.2.2">𝒟</ci><ci id="S3.p3.5.m5.4.4.4.2.3.cmml" xref="S3.p3.5.m5.4.4.4.2.3">𝑇</ci></apply><ci id="S3.p3.5.m5.4.4.4.3.cmml" xref="S3.p3.5.m5.4.4.4.3">𝑘</ci></apply><apply id="S3.p3.5.m5.4.4.2.3.cmml" xref="S3.p3.5.m5.4.4.2.2"><csymbol cd="latexml" id="S3.p3.5.m5.4.4.2.3.1.cmml" xref="S3.p3.5.m5.4.4.2.2.3">conditional-set</csymbol><apply id="S3.p3.5.m5.3.3.1.1.1.cmml" xref="S3.p3.5.m5.3.3.1.1.1"><in id="S3.p3.5.m5.3.3.1.1.1.1.cmml" xref="S3.p3.5.m5.3.3.1.1.1.1"></in><apply id="S3.p3.5.m5.3.3.1.1.1.2.cmml" xref="S3.p3.5.m5.3.3.1.1.1.2"><csymbol cd="ambiguous" id="S3.p3.5.m5.3.3.1.1.1.2.1.cmml" xref="S3.p3.5.m5.3.3.1.1.1.2">superscript</csymbol><apply id="S3.p3.5.m5.3.3.1.1.1.2.2.cmml" xref="S3.p3.5.m5.3.3.1.1.1.2"><csymbol cd="ambiguous" id="S3.p3.5.m5.3.3.1.1.1.2.2.1.cmml" xref="S3.p3.5.m5.3.3.1.1.1.2">subscript</csymbol><ci id="S3.p3.5.m5.3.3.1.1.1.2.2.2.cmml" xref="S3.p3.5.m5.3.3.1.1.1.2.2.2">𝑥</ci><list id="S3.p3.5.m5.2.2.2.3.cmml" xref="S3.p3.5.m5.2.2.2.4"><ci id="S3.p3.5.m5.1.1.1.1.cmml" xref="S3.p3.5.m5.1.1.1.1">𝑘</ci><ci id="S3.p3.5.m5.2.2.2.2.cmml" xref="S3.p3.5.m5.2.2.2.2">𝑖</ci></list></apply><ci id="S3.p3.5.m5.3.3.1.1.1.2.3.cmml" xref="S3.p3.5.m5.3.3.1.1.1.2.3">𝑇</ci></apply><ci id="S3.p3.5.m5.3.3.1.1.1.3.cmml" xref="S3.p3.5.m5.3.3.1.1.1.3">𝒳</ci></apply><apply id="S3.p3.5.m5.4.4.2.2.2.cmml" xref="S3.p3.5.m5.4.4.2.2.2"><in id="S3.p3.5.m5.4.4.2.2.2.2.cmml" xref="S3.p3.5.m5.4.4.2.2.2.2"></in><apply id="S3.p3.5.m5.4.4.2.2.2.3.cmml" xref="S3.p3.5.m5.4.4.2.2.2.3"><csymbol cd="latexml" id="S3.p3.5.m5.4.4.2.2.2.3.1.cmml" xref="S3.p3.5.m5.4.4.2.2.2.3.1">for-all</csymbol><ci id="S3.p3.5.m5.4.4.2.2.2.3.2.cmml" xref="S3.p3.5.m5.4.4.2.2.2.3.2">𝑖</ci></apply><apply id="S3.p3.5.m5.4.4.2.2.2.1.2.cmml" xref="S3.p3.5.m5.4.4.2.2.2.1.1"><abs id="S3.p3.5.m5.4.4.2.2.2.1.2.1.cmml" xref="S3.p3.5.m5.4.4.2.2.2.1.1.2"></abs><apply id="S3.p3.5.m5.4.4.2.2.2.1.1.1.cmml" xref="S3.p3.5.m5.4.4.2.2.2.1.1.1"><csymbol cd="ambiguous" id="S3.p3.5.m5.4.4.2.2.2.1.1.1.1.cmml" xref="S3.p3.5.m5.4.4.2.2.2.1.1.1">subscript</csymbol><apply id="S3.p3.5.m5.4.4.2.2.2.1.1.1.2.cmml" xref="S3.p3.5.m5.4.4.2.2.2.1.1.1"><csymbol cd="ambiguous" id="S3.p3.5.m5.4.4.2.2.2.1.1.1.2.1.cmml" xref="S3.p3.5.m5.4.4.2.2.2.1.1.1">superscript</csymbol><ci id="S3.p3.5.m5.4.4.2.2.2.1.1.1.2.2.cmml" xref="S3.p3.5.m5.4.4.2.2.2.1.1.1.2.2">𝒟</ci><ci id="S3.p3.5.m5.4.4.2.2.2.1.1.1.2.3.cmml" xref="S3.p3.5.m5.4.4.2.2.2.1.1.1.2.3">𝑇</ci></apply><ci id="S3.p3.5.m5.4.4.2.2.2.1.1.1.3.cmml" xref="S3.p3.5.m5.4.4.2.2.2.1.1.1.3">𝑘</ci></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p3.5.m5.4c">\mathcal{D}^{T}_{k}=\{x_{k,i}^{T}\in\mathcal{X}:\forall i\in|\mathcal{D}^{T}_{k}|\}</annotation></semantics></math>. Notably, these client datasets are locally stored and managed, ensuring that <math id="S3.p3.6.m6.1" class="ltx_Math" alttext="\mathcal{D}^{T}_{1}\cap\mathcal{D}^{T}_{2}\cap\ldots\cap\mathcal{D}^{T}_{K}=\varnothing" display="inline"><semantics id="S3.p3.6.m6.1a"><mrow id="S3.p3.6.m6.1.1" xref="S3.p3.6.m6.1.1.cmml"><mrow id="S3.p3.6.m6.1.1.2" xref="S3.p3.6.m6.1.1.2.cmml"><msubsup id="S3.p3.6.m6.1.1.2.2" xref="S3.p3.6.m6.1.1.2.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.p3.6.m6.1.1.2.2.2.2" xref="S3.p3.6.m6.1.1.2.2.2.2.cmml">𝒟</mi><mn id="S3.p3.6.m6.1.1.2.2.3" xref="S3.p3.6.m6.1.1.2.2.3.cmml">1</mn><mi id="S3.p3.6.m6.1.1.2.2.2.3" xref="S3.p3.6.m6.1.1.2.2.2.3.cmml">T</mi></msubsup><mo id="S3.p3.6.m6.1.1.2.1" xref="S3.p3.6.m6.1.1.2.1.cmml">∩</mo><msubsup id="S3.p3.6.m6.1.1.2.3" xref="S3.p3.6.m6.1.1.2.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.p3.6.m6.1.1.2.3.2.2" xref="S3.p3.6.m6.1.1.2.3.2.2.cmml">𝒟</mi><mn id="S3.p3.6.m6.1.1.2.3.3" xref="S3.p3.6.m6.1.1.2.3.3.cmml">2</mn><mi id="S3.p3.6.m6.1.1.2.3.2.3" xref="S3.p3.6.m6.1.1.2.3.2.3.cmml">T</mi></msubsup><mo id="S3.p3.6.m6.1.1.2.1a" xref="S3.p3.6.m6.1.1.2.1.cmml">∩</mo><mi mathvariant="normal" id="S3.p3.6.m6.1.1.2.4" xref="S3.p3.6.m6.1.1.2.4.cmml">…</mi><mo id="S3.p3.6.m6.1.1.2.1b" xref="S3.p3.6.m6.1.1.2.1.cmml">∩</mo><msubsup id="S3.p3.6.m6.1.1.2.5" xref="S3.p3.6.m6.1.1.2.5.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.p3.6.m6.1.1.2.5.2.2" xref="S3.p3.6.m6.1.1.2.5.2.2.cmml">𝒟</mi><mi id="S3.p3.6.m6.1.1.2.5.3" xref="S3.p3.6.m6.1.1.2.5.3.cmml">K</mi><mi id="S3.p3.6.m6.1.1.2.5.2.3" xref="S3.p3.6.m6.1.1.2.5.2.3.cmml">T</mi></msubsup></mrow><mo id="S3.p3.6.m6.1.1.1" xref="S3.p3.6.m6.1.1.1.cmml">=</mo><mi mathvariant="normal" id="S3.p3.6.m6.1.1.3" xref="S3.p3.6.m6.1.1.3.cmml">∅</mi></mrow><annotation-xml encoding="MathML-Content" id="S3.p3.6.m6.1b"><apply id="S3.p3.6.m6.1.1.cmml" xref="S3.p3.6.m6.1.1"><eq id="S3.p3.6.m6.1.1.1.cmml" xref="S3.p3.6.m6.1.1.1"></eq><apply id="S3.p3.6.m6.1.1.2.cmml" xref="S3.p3.6.m6.1.1.2"><intersect id="S3.p3.6.m6.1.1.2.1.cmml" xref="S3.p3.6.m6.1.1.2.1"></intersect><apply id="S3.p3.6.m6.1.1.2.2.cmml" xref="S3.p3.6.m6.1.1.2.2"><csymbol cd="ambiguous" id="S3.p3.6.m6.1.1.2.2.1.cmml" xref="S3.p3.6.m6.1.1.2.2">subscript</csymbol><apply id="S3.p3.6.m6.1.1.2.2.2.cmml" xref="S3.p3.6.m6.1.1.2.2"><csymbol cd="ambiguous" id="S3.p3.6.m6.1.1.2.2.2.1.cmml" xref="S3.p3.6.m6.1.1.2.2">superscript</csymbol><ci id="S3.p3.6.m6.1.1.2.2.2.2.cmml" xref="S3.p3.6.m6.1.1.2.2.2.2">𝒟</ci><ci id="S3.p3.6.m6.1.1.2.2.2.3.cmml" xref="S3.p3.6.m6.1.1.2.2.2.3">𝑇</ci></apply><cn type="integer" id="S3.p3.6.m6.1.1.2.2.3.cmml" xref="S3.p3.6.m6.1.1.2.2.3">1</cn></apply><apply id="S3.p3.6.m6.1.1.2.3.cmml" xref="S3.p3.6.m6.1.1.2.3"><csymbol cd="ambiguous" id="S3.p3.6.m6.1.1.2.3.1.cmml" xref="S3.p3.6.m6.1.1.2.3">subscript</csymbol><apply id="S3.p3.6.m6.1.1.2.3.2.cmml" xref="S3.p3.6.m6.1.1.2.3"><csymbol cd="ambiguous" id="S3.p3.6.m6.1.1.2.3.2.1.cmml" xref="S3.p3.6.m6.1.1.2.3">superscript</csymbol><ci id="S3.p3.6.m6.1.1.2.3.2.2.cmml" xref="S3.p3.6.m6.1.1.2.3.2.2">𝒟</ci><ci id="S3.p3.6.m6.1.1.2.3.2.3.cmml" xref="S3.p3.6.m6.1.1.2.3.2.3">𝑇</ci></apply><cn type="integer" id="S3.p3.6.m6.1.1.2.3.3.cmml" xref="S3.p3.6.m6.1.1.2.3.3">2</cn></apply><ci id="S3.p3.6.m6.1.1.2.4.cmml" xref="S3.p3.6.m6.1.1.2.4">…</ci><apply id="S3.p3.6.m6.1.1.2.5.cmml" xref="S3.p3.6.m6.1.1.2.5"><csymbol cd="ambiguous" id="S3.p3.6.m6.1.1.2.5.1.cmml" xref="S3.p3.6.m6.1.1.2.5">subscript</csymbol><apply id="S3.p3.6.m6.1.1.2.5.2.cmml" xref="S3.p3.6.m6.1.1.2.5"><csymbol cd="ambiguous" id="S3.p3.6.m6.1.1.2.5.2.1.cmml" xref="S3.p3.6.m6.1.1.2.5">superscript</csymbol><ci id="S3.p3.6.m6.1.1.2.5.2.2.cmml" xref="S3.p3.6.m6.1.1.2.5.2.2">𝒟</ci><ci id="S3.p3.6.m6.1.1.2.5.2.3.cmml" xref="S3.p3.6.m6.1.1.2.5.2.3">𝑇</ci></apply><ci id="S3.p3.6.m6.1.1.2.5.3.cmml" xref="S3.p3.6.m6.1.1.2.5.3">𝐾</ci></apply></apply><emptyset id="S3.p3.6.m6.1.1.3.cmml" xref="S3.p3.6.m6.1.1.3"></emptyset></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p3.6.m6.1c">\mathcal{D}^{T}_{1}\cap\mathcal{D}^{T}_{2}\cap\ldots\cap\mathcal{D}^{T}_{K}=\varnothing</annotation></semantics></math>.
In distributed settings, the parameter <math id="S3.p3.7.m7.1" class="ltx_Math" alttext="K" display="inline"><semantics id="S3.p3.7.m7.1a"><mi id="S3.p3.7.m7.1.1" xref="S3.p3.7.m7.1.1.cmml">K</mi><annotation-xml encoding="MathML-Content" id="S3.p3.7.m7.1b"><ci id="S3.p3.7.m7.1.1.cmml" xref="S3.p3.7.m7.1.1">𝐾</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.p3.7.m7.1c">K</annotation></semantics></math> is reasonably large, and the local datasets vary in terms of statistics, <em id="S3.p3.11.2" class="ltx_emph ltx_font_italic">i.e</em>.<span id="S3.p3.11.3" class="ltx_text"></span> size and distribution. However, they typically possess a much smaller size compared to the source dataset (<math id="S3.p3.8.m8.1" class="ltx_Math" alttext="N^{S}\!\gg N^{T}" display="inline"><semantics id="S3.p3.8.m8.1a"><mrow id="S3.p3.8.m8.1.1" xref="S3.p3.8.m8.1.1.cmml"><msup id="S3.p3.8.m8.1.1.2" xref="S3.p3.8.m8.1.1.2.cmml"><mi id="S3.p3.8.m8.1.1.2.2" xref="S3.p3.8.m8.1.1.2.2.cmml">N</mi><mi id="S3.p3.8.m8.1.1.2.3" xref="S3.p3.8.m8.1.1.2.3.cmml">S</mi></msup><mo lspace="0.108em" id="S3.p3.8.m8.1.1.1" xref="S3.p3.8.m8.1.1.1.cmml">≫</mo><msup id="S3.p3.8.m8.1.1.3" xref="S3.p3.8.m8.1.1.3.cmml"><mi id="S3.p3.8.m8.1.1.3.2" xref="S3.p3.8.m8.1.1.3.2.cmml">N</mi><mi id="S3.p3.8.m8.1.1.3.3" xref="S3.p3.8.m8.1.1.3.3.cmml">T</mi></msup></mrow><annotation-xml encoding="MathML-Content" id="S3.p3.8.m8.1b"><apply id="S3.p3.8.m8.1.1.cmml" xref="S3.p3.8.m8.1.1"><csymbol cd="latexml" id="S3.p3.8.m8.1.1.1.cmml" xref="S3.p3.8.m8.1.1.1">much-greater-than</csymbol><apply id="S3.p3.8.m8.1.1.2.cmml" xref="S3.p3.8.m8.1.1.2"><csymbol cd="ambiguous" id="S3.p3.8.m8.1.1.2.1.cmml" xref="S3.p3.8.m8.1.1.2">superscript</csymbol><ci id="S3.p3.8.m8.1.1.2.2.cmml" xref="S3.p3.8.m8.1.1.2.2">𝑁</ci><ci id="S3.p3.8.m8.1.1.2.3.cmml" xref="S3.p3.8.m8.1.1.2.3">𝑆</ci></apply><apply id="S3.p3.8.m8.1.1.3.cmml" xref="S3.p3.8.m8.1.1.3"><csymbol cd="ambiguous" id="S3.p3.8.m8.1.1.3.1.cmml" xref="S3.p3.8.m8.1.1.3">superscript</csymbol><ci id="S3.p3.8.m8.1.1.3.2.cmml" xref="S3.p3.8.m8.1.1.3.2">𝑁</ci><ci id="S3.p3.8.m8.1.1.3.3.cmml" xref="S3.p3.8.m8.1.1.3.3">𝑇</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p3.8.m8.1c">N^{S}\!\gg N^{T}</annotation></semantics></math>). <span id="S3.p3.11.4" class="ltx_text ltx_font_smallcaps">FFreeDA</span> assumes that the local datasets are drawn from the same meta-distribution, meaning that <math id="S3.p3.9.m9.1" class="ltx_Math" alttext="\mathcal{D}_{k}^{T}" display="inline"><semantics id="S3.p3.9.m9.1a"><msubsup id="S3.p3.9.m9.1.1" xref="S3.p3.9.m9.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.p3.9.m9.1.1.2.2" xref="S3.p3.9.m9.1.1.2.2.cmml">𝒟</mi><mi id="S3.p3.9.m9.1.1.2.3" xref="S3.p3.9.m9.1.1.2.3.cmml">k</mi><mi id="S3.p3.9.m9.1.1.3" xref="S3.p3.9.m9.1.1.3.cmml">T</mi></msubsup><annotation-xml encoding="MathML-Content" id="S3.p3.9.m9.1b"><apply id="S3.p3.9.m9.1.1.cmml" xref="S3.p3.9.m9.1.1"><csymbol cd="ambiguous" id="S3.p3.9.m9.1.1.1.cmml" xref="S3.p3.9.m9.1.1">superscript</csymbol><apply id="S3.p3.9.m9.1.1.2.cmml" xref="S3.p3.9.m9.1.1"><csymbol cd="ambiguous" id="S3.p3.9.m9.1.1.2.1.cmml" xref="S3.p3.9.m9.1.1">subscript</csymbol><ci id="S3.p3.9.m9.1.1.2.2.cmml" xref="S3.p3.9.m9.1.1.2.2">𝒟</ci><ci id="S3.p3.9.m9.1.1.2.3.cmml" xref="S3.p3.9.m9.1.1.2.3">𝑘</ci></apply><ci id="S3.p3.9.m9.1.1.3.cmml" xref="S3.p3.9.m9.1.1.3">𝑇</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p3.9.m9.1c">\mathcal{D}_{k}^{T}</annotation></semantics></math> comprises images solely from one latent domain.
The objective is to achieve optimal segmentation performance on the target data distribution with the model <math id="S3.p3.10.m10.3" class="ltx_Math" alttext="M(\theta):\mathcal{X}\rightarrow\mathbf{R}^{|\mathcal{I}|\times|\mathcal{Y}|}" display="inline"><semantics id="S3.p3.10.m10.3a"><mrow id="S3.p3.10.m10.3.4" xref="S3.p3.10.m10.3.4.cmml"><mrow id="S3.p3.10.m10.3.4.2" xref="S3.p3.10.m10.3.4.2.cmml"><mi id="S3.p3.10.m10.3.4.2.2" xref="S3.p3.10.m10.3.4.2.2.cmml">M</mi><mo lspace="0em" rspace="0em" id="S3.p3.10.m10.3.4.2.1" xref="S3.p3.10.m10.3.4.2.1.cmml">​</mo><mrow id="S3.p3.10.m10.3.4.2.3.2" xref="S3.p3.10.m10.3.4.2.cmml"><mo stretchy="false" id="S3.p3.10.m10.3.4.2.3.2.1" xref="S3.p3.10.m10.3.4.2.cmml">(</mo><mi id="S3.p3.10.m10.3.3" xref="S3.p3.10.m10.3.3.cmml">θ</mi><mo rspace="0.278em" stretchy="false" id="S3.p3.10.m10.3.4.2.3.2.2" xref="S3.p3.10.m10.3.4.2.cmml">)</mo></mrow></mrow><mo rspace="0.278em" id="S3.p3.10.m10.3.4.1" xref="S3.p3.10.m10.3.4.1.cmml">:</mo><mrow id="S3.p3.10.m10.3.4.3" xref="S3.p3.10.m10.3.4.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.p3.10.m10.3.4.3.2" xref="S3.p3.10.m10.3.4.3.2.cmml">𝒳</mi><mo stretchy="false" id="S3.p3.10.m10.3.4.3.1" xref="S3.p3.10.m10.3.4.3.1.cmml">→</mo><msup id="S3.p3.10.m10.3.4.3.3" xref="S3.p3.10.m10.3.4.3.3.cmml"><mi id="S3.p3.10.m10.3.4.3.3.2" xref="S3.p3.10.m10.3.4.3.3.2.cmml">𝐑</mi><mrow id="S3.p3.10.m10.2.2.2" xref="S3.p3.10.m10.2.2.2.cmml"><mrow id="S3.p3.10.m10.2.2.2.4.2" xref="S3.p3.10.m10.2.2.2.4.1.cmml"><mo stretchy="false" id="S3.p3.10.m10.2.2.2.4.2.1" xref="S3.p3.10.m10.2.2.2.4.1.1.cmml">|</mo><mi class="ltx_font_mathcaligraphic" id="S3.p3.10.m10.1.1.1.1" xref="S3.p3.10.m10.1.1.1.1.cmml">ℐ</mi><mo rspace="0.055em" stretchy="false" id="S3.p3.10.m10.2.2.2.4.2.2" xref="S3.p3.10.m10.2.2.2.4.1.1.cmml">|</mo></mrow><mo rspace="0.222em" id="S3.p3.10.m10.2.2.2.3" xref="S3.p3.10.m10.2.2.2.3.cmml">×</mo><mrow id="S3.p3.10.m10.2.2.2.5.2" xref="S3.p3.10.m10.2.2.2.5.1.cmml"><mo stretchy="false" id="S3.p3.10.m10.2.2.2.5.2.1" xref="S3.p3.10.m10.2.2.2.5.1.1.cmml">|</mo><mi class="ltx_font_mathcaligraphic" id="S3.p3.10.m10.2.2.2.2" xref="S3.p3.10.m10.2.2.2.2.cmml">𝒴</mi><mo stretchy="false" id="S3.p3.10.m10.2.2.2.5.2.2" xref="S3.p3.10.m10.2.2.2.5.1.1.cmml">|</mo></mrow></mrow></msup></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.p3.10.m10.3b"><apply id="S3.p3.10.m10.3.4.cmml" xref="S3.p3.10.m10.3.4"><ci id="S3.p3.10.m10.3.4.1.cmml" xref="S3.p3.10.m10.3.4.1">:</ci><apply id="S3.p3.10.m10.3.4.2.cmml" xref="S3.p3.10.m10.3.4.2"><times id="S3.p3.10.m10.3.4.2.1.cmml" xref="S3.p3.10.m10.3.4.2.1"></times><ci id="S3.p3.10.m10.3.4.2.2.cmml" xref="S3.p3.10.m10.3.4.2.2">𝑀</ci><ci id="S3.p3.10.m10.3.3.cmml" xref="S3.p3.10.m10.3.3">𝜃</ci></apply><apply id="S3.p3.10.m10.3.4.3.cmml" xref="S3.p3.10.m10.3.4.3"><ci id="S3.p3.10.m10.3.4.3.1.cmml" xref="S3.p3.10.m10.3.4.3.1">→</ci><ci id="S3.p3.10.m10.3.4.3.2.cmml" xref="S3.p3.10.m10.3.4.3.2">𝒳</ci><apply id="S3.p3.10.m10.3.4.3.3.cmml" xref="S3.p3.10.m10.3.4.3.3"><csymbol cd="ambiguous" id="S3.p3.10.m10.3.4.3.3.1.cmml" xref="S3.p3.10.m10.3.4.3.3">superscript</csymbol><ci id="S3.p3.10.m10.3.4.3.3.2.cmml" xref="S3.p3.10.m10.3.4.3.3.2">𝐑</ci><apply id="S3.p3.10.m10.2.2.2.cmml" xref="S3.p3.10.m10.2.2.2"><times id="S3.p3.10.m10.2.2.2.3.cmml" xref="S3.p3.10.m10.2.2.2.3"></times><apply id="S3.p3.10.m10.2.2.2.4.1.cmml" xref="S3.p3.10.m10.2.2.2.4.2"><abs id="S3.p3.10.m10.2.2.2.4.1.1.cmml" xref="S3.p3.10.m10.2.2.2.4.2.1"></abs><ci id="S3.p3.10.m10.1.1.1.1.cmml" xref="S3.p3.10.m10.1.1.1.1">ℐ</ci></apply><apply id="S3.p3.10.m10.2.2.2.5.1.cmml" xref="S3.p3.10.m10.2.2.2.5.2"><abs id="S3.p3.10.m10.2.2.2.5.1.1.cmml" xref="S3.p3.10.m10.2.2.2.5.2.1"></abs><ci id="S3.p3.10.m10.2.2.2.2.cmml" xref="S3.p3.10.m10.2.2.2.2">𝒴</ci></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p3.10.m10.3c">M(\theta):\mathcal{X}\rightarrow\mathbf{R}^{|\mathcal{I}|\times|\mathcal{Y}|}</annotation></semantics></math>, parameterized by <math id="S3.p3.11.m11.1" class="ltx_Math" alttext="\theta" display="inline"><semantics id="S3.p3.11.m11.1a"><mi id="S3.p3.11.m11.1.1" xref="S3.p3.11.m11.1.1.cmml">θ</mi><annotation-xml encoding="MathML-Content" id="S3.p3.11.m11.1b"><ci id="S3.p3.11.m11.1.1.cmml" xref="S3.p3.11.m11.1.1">𝜃</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.p3.11.m11.1c">\theta</annotation></semantics></math>. This goal is pursued by minimizing an appropriate loss function, expressed as:</p>
<table id="S3.E1" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S3.E1.m1.4" class="ltx_Math" alttext="\theta^{*}=\arg\min_{\theta}\sum_{k\in[K]}\frac{|\mathcal{D}_{k}^{T}|}{|\mathcal{D}^{T}|}\mathcal{L}_{k}(\theta)" display="block"><semantics id="S3.E1.m1.4a"><mrow id="S3.E1.m1.4.5" xref="S3.E1.m1.4.5.cmml"><msup id="S3.E1.m1.4.5.2" xref="S3.E1.m1.4.5.2.cmml"><mi id="S3.E1.m1.4.5.2.2" xref="S3.E1.m1.4.5.2.2.cmml">θ</mi><mo id="S3.E1.m1.4.5.2.3" xref="S3.E1.m1.4.5.2.3.cmml">∗</mo></msup><mo id="S3.E1.m1.4.5.1" xref="S3.E1.m1.4.5.1.cmml">=</mo><mrow id="S3.E1.m1.4.5.3" xref="S3.E1.m1.4.5.3.cmml"><mrow id="S3.E1.m1.4.5.3.2" xref="S3.E1.m1.4.5.3.2.cmml"><mi id="S3.E1.m1.4.5.3.2.1" xref="S3.E1.m1.4.5.3.2.1.cmml">arg</mi><mo lspace="0.167em" id="S3.E1.m1.4.5.3.2a" xref="S3.E1.m1.4.5.3.2.cmml">⁡</mo><munder id="S3.E1.m1.4.5.3.2.2" xref="S3.E1.m1.4.5.3.2.2.cmml"><mi id="S3.E1.m1.4.5.3.2.2.2" xref="S3.E1.m1.4.5.3.2.2.2.cmml">min</mi><mi id="S3.E1.m1.4.5.3.2.2.3" xref="S3.E1.m1.4.5.3.2.2.3.cmml">θ</mi></munder></mrow><mo lspace="0em" rspace="0em" id="S3.E1.m1.4.5.3.1" xref="S3.E1.m1.4.5.3.1.cmml">​</mo><mrow id="S3.E1.m1.4.5.3.3" xref="S3.E1.m1.4.5.3.3.cmml"><munder id="S3.E1.m1.4.5.3.3.1" xref="S3.E1.m1.4.5.3.3.1.cmml"><mo movablelimits="false" id="S3.E1.m1.4.5.3.3.1.2" xref="S3.E1.m1.4.5.3.3.1.2.cmml">∑</mo><mrow id="S3.E1.m1.1.1.1" xref="S3.E1.m1.1.1.1.cmml"><mi id="S3.E1.m1.1.1.1.3" xref="S3.E1.m1.1.1.1.3.cmml">k</mi><mo id="S3.E1.m1.1.1.1.2" xref="S3.E1.m1.1.1.1.2.cmml">∈</mo><mrow id="S3.E1.m1.1.1.1.4.2" xref="S3.E1.m1.1.1.1.4.1.cmml"><mo stretchy="false" id="S3.E1.m1.1.1.1.4.2.1" xref="S3.E1.m1.1.1.1.4.1.1.cmml">[</mo><mi id="S3.E1.m1.1.1.1.1" xref="S3.E1.m1.1.1.1.1.cmml">K</mi><mo stretchy="false" id="S3.E1.m1.1.1.1.4.2.2" xref="S3.E1.m1.1.1.1.4.1.1.cmml">]</mo></mrow></mrow></munder><mrow id="S3.E1.m1.4.5.3.3.2" xref="S3.E1.m1.4.5.3.3.2.cmml"><mfrac id="S3.E1.m1.3.3" xref="S3.E1.m1.3.3.cmml"><mrow id="S3.E1.m1.2.2.1.1" xref="S3.E1.m1.2.2.1.2.cmml"><mo stretchy="false" id="S3.E1.m1.2.2.1.1.2" xref="S3.E1.m1.2.2.1.2.1.cmml">|</mo><msubsup id="S3.E1.m1.2.2.1.1.1" xref="S3.E1.m1.2.2.1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.E1.m1.2.2.1.1.1.2.2" xref="S3.E1.m1.2.2.1.1.1.2.2.cmml">𝒟</mi><mi id="S3.E1.m1.2.2.1.1.1.2.3" xref="S3.E1.m1.2.2.1.1.1.2.3.cmml">k</mi><mi id="S3.E1.m1.2.2.1.1.1.3" xref="S3.E1.m1.2.2.1.1.1.3.cmml">T</mi></msubsup><mo stretchy="false" id="S3.E1.m1.2.2.1.1.3" xref="S3.E1.m1.2.2.1.2.1.cmml">|</mo></mrow><mrow id="S3.E1.m1.3.3.2.1" xref="S3.E1.m1.3.3.2.2.cmml"><mo stretchy="false" id="S3.E1.m1.3.3.2.1.2" xref="S3.E1.m1.3.3.2.2.1.cmml">|</mo><msup id="S3.E1.m1.3.3.2.1.1" xref="S3.E1.m1.3.3.2.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.E1.m1.3.3.2.1.1.2" xref="S3.E1.m1.3.3.2.1.1.2.cmml">𝒟</mi><mi id="S3.E1.m1.3.3.2.1.1.3" xref="S3.E1.m1.3.3.2.1.1.3.cmml">T</mi></msup><mo stretchy="false" id="S3.E1.m1.3.3.2.1.3" xref="S3.E1.m1.3.3.2.2.1.cmml">|</mo></mrow></mfrac><mo lspace="0em" rspace="0em" id="S3.E1.m1.4.5.3.3.2.1" xref="S3.E1.m1.4.5.3.3.2.1.cmml">​</mo><msub id="S3.E1.m1.4.5.3.3.2.2" xref="S3.E1.m1.4.5.3.3.2.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.E1.m1.4.5.3.3.2.2.2" xref="S3.E1.m1.4.5.3.3.2.2.2.cmml">ℒ</mi><mi id="S3.E1.m1.4.5.3.3.2.2.3" xref="S3.E1.m1.4.5.3.3.2.2.3.cmml">k</mi></msub><mo lspace="0em" rspace="0em" id="S3.E1.m1.4.5.3.3.2.1a" xref="S3.E1.m1.4.5.3.3.2.1.cmml">​</mo><mrow id="S3.E1.m1.4.5.3.3.2.3.2" xref="S3.E1.m1.4.5.3.3.2.cmml"><mo stretchy="false" id="S3.E1.m1.4.5.3.3.2.3.2.1" xref="S3.E1.m1.4.5.3.3.2.cmml">(</mo><mi id="S3.E1.m1.4.4" xref="S3.E1.m1.4.4.cmml">θ</mi><mo stretchy="false" id="S3.E1.m1.4.5.3.3.2.3.2.2" xref="S3.E1.m1.4.5.3.3.2.cmml">)</mo></mrow></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.E1.m1.4b"><apply id="S3.E1.m1.4.5.cmml" xref="S3.E1.m1.4.5"><eq id="S3.E1.m1.4.5.1.cmml" xref="S3.E1.m1.4.5.1"></eq><apply id="S3.E1.m1.4.5.2.cmml" xref="S3.E1.m1.4.5.2"><csymbol cd="ambiguous" id="S3.E1.m1.4.5.2.1.cmml" xref="S3.E1.m1.4.5.2">superscript</csymbol><ci id="S3.E1.m1.4.5.2.2.cmml" xref="S3.E1.m1.4.5.2.2">𝜃</ci><times id="S3.E1.m1.4.5.2.3.cmml" xref="S3.E1.m1.4.5.2.3"></times></apply><apply id="S3.E1.m1.4.5.3.cmml" xref="S3.E1.m1.4.5.3"><times id="S3.E1.m1.4.5.3.1.cmml" xref="S3.E1.m1.4.5.3.1"></times><apply id="S3.E1.m1.4.5.3.2.cmml" xref="S3.E1.m1.4.5.3.2"><arg id="S3.E1.m1.4.5.3.2.1.cmml" xref="S3.E1.m1.4.5.3.2.1"></arg><apply id="S3.E1.m1.4.5.3.2.2.cmml" xref="S3.E1.m1.4.5.3.2.2"><csymbol cd="ambiguous" id="S3.E1.m1.4.5.3.2.2.1.cmml" xref="S3.E1.m1.4.5.3.2.2">subscript</csymbol><min id="S3.E1.m1.4.5.3.2.2.2.cmml" xref="S3.E1.m1.4.5.3.2.2.2"></min><ci id="S3.E1.m1.4.5.3.2.2.3.cmml" xref="S3.E1.m1.4.5.3.2.2.3">𝜃</ci></apply></apply><apply id="S3.E1.m1.4.5.3.3.cmml" xref="S3.E1.m1.4.5.3.3"><apply id="S3.E1.m1.4.5.3.3.1.cmml" xref="S3.E1.m1.4.5.3.3.1"><csymbol cd="ambiguous" id="S3.E1.m1.4.5.3.3.1.1.cmml" xref="S3.E1.m1.4.5.3.3.1">subscript</csymbol><sum id="S3.E1.m1.4.5.3.3.1.2.cmml" xref="S3.E1.m1.4.5.3.3.1.2"></sum><apply id="S3.E1.m1.1.1.1.cmml" xref="S3.E1.m1.1.1.1"><in id="S3.E1.m1.1.1.1.2.cmml" xref="S3.E1.m1.1.1.1.2"></in><ci id="S3.E1.m1.1.1.1.3.cmml" xref="S3.E1.m1.1.1.1.3">𝑘</ci><apply id="S3.E1.m1.1.1.1.4.1.cmml" xref="S3.E1.m1.1.1.1.4.2"><csymbol cd="latexml" id="S3.E1.m1.1.1.1.4.1.1.cmml" xref="S3.E1.m1.1.1.1.4.2.1">delimited-[]</csymbol><ci id="S3.E1.m1.1.1.1.1.cmml" xref="S3.E1.m1.1.1.1.1">𝐾</ci></apply></apply></apply><apply id="S3.E1.m1.4.5.3.3.2.cmml" xref="S3.E1.m1.4.5.3.3.2"><times id="S3.E1.m1.4.5.3.3.2.1.cmml" xref="S3.E1.m1.4.5.3.3.2.1"></times><apply id="S3.E1.m1.3.3.cmml" xref="S3.E1.m1.3.3"><divide id="S3.E1.m1.3.3.3.cmml" xref="S3.E1.m1.3.3"></divide><apply id="S3.E1.m1.2.2.1.2.cmml" xref="S3.E1.m1.2.2.1.1"><abs id="S3.E1.m1.2.2.1.2.1.cmml" xref="S3.E1.m1.2.2.1.1.2"></abs><apply id="S3.E1.m1.2.2.1.1.1.cmml" xref="S3.E1.m1.2.2.1.1.1"><csymbol cd="ambiguous" id="S3.E1.m1.2.2.1.1.1.1.cmml" xref="S3.E1.m1.2.2.1.1.1">superscript</csymbol><apply id="S3.E1.m1.2.2.1.1.1.2.cmml" xref="S3.E1.m1.2.2.1.1.1"><csymbol cd="ambiguous" id="S3.E1.m1.2.2.1.1.1.2.1.cmml" xref="S3.E1.m1.2.2.1.1.1">subscript</csymbol><ci id="S3.E1.m1.2.2.1.1.1.2.2.cmml" xref="S3.E1.m1.2.2.1.1.1.2.2">𝒟</ci><ci id="S3.E1.m1.2.2.1.1.1.2.3.cmml" xref="S3.E1.m1.2.2.1.1.1.2.3">𝑘</ci></apply><ci id="S3.E1.m1.2.2.1.1.1.3.cmml" xref="S3.E1.m1.2.2.1.1.1.3">𝑇</ci></apply></apply><apply id="S3.E1.m1.3.3.2.2.cmml" xref="S3.E1.m1.3.3.2.1"><abs id="S3.E1.m1.3.3.2.2.1.cmml" xref="S3.E1.m1.3.3.2.1.2"></abs><apply id="S3.E1.m1.3.3.2.1.1.cmml" xref="S3.E1.m1.3.3.2.1.1"><csymbol cd="ambiguous" id="S3.E1.m1.3.3.2.1.1.1.cmml" xref="S3.E1.m1.3.3.2.1.1">superscript</csymbol><ci id="S3.E1.m1.3.3.2.1.1.2.cmml" xref="S3.E1.m1.3.3.2.1.1.2">𝒟</ci><ci id="S3.E1.m1.3.3.2.1.1.3.cmml" xref="S3.E1.m1.3.3.2.1.1.3">𝑇</ci></apply></apply></apply><apply id="S3.E1.m1.4.5.3.3.2.2.cmml" xref="S3.E1.m1.4.5.3.3.2.2"><csymbol cd="ambiguous" id="S3.E1.m1.4.5.3.3.2.2.1.cmml" xref="S3.E1.m1.4.5.3.3.2.2">subscript</csymbol><ci id="S3.E1.m1.4.5.3.3.2.2.2.cmml" xref="S3.E1.m1.4.5.3.3.2.2.2">ℒ</ci><ci id="S3.E1.m1.4.5.3.3.2.2.3.cmml" xref="S3.E1.m1.4.5.3.3.2.2.3">𝑘</ci></apply><ci id="S3.E1.m1.4.4.cmml" xref="S3.E1.m1.4.4">𝜃</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E1.m1.4c">\theta^{*}=\arg\min_{\theta}\sum_{k\in[K]}\frac{|\mathcal{D}_{k}^{T}|}{|\mathcal{D}^{T}|}\mathcal{L}_{k}(\theta)</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(1)</span></td>
</tr></tbody>
</table>
<p id="S3.p3.13" class="ltx_p">where <math id="S3.p3.12.m1.1" class="ltx_Math" alttext="\mathcal{L}_{k}" display="inline"><semantics id="S3.p3.12.m1.1a"><msub id="S3.p3.12.m1.1.1" xref="S3.p3.12.m1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.p3.12.m1.1.1.2" xref="S3.p3.12.m1.1.1.2.cmml">ℒ</mi><mi id="S3.p3.12.m1.1.1.3" xref="S3.p3.12.m1.1.1.3.cmml">k</mi></msub><annotation-xml encoding="MathML-Content" id="S3.p3.12.m1.1b"><apply id="S3.p3.12.m1.1.1.cmml" xref="S3.p3.12.m1.1.1"><csymbol cd="ambiguous" id="S3.p3.12.m1.1.1.1.cmml" xref="S3.p3.12.m1.1.1">subscript</csymbol><ci id="S3.p3.12.m1.1.1.2.cmml" xref="S3.p3.12.m1.1.1.2">ℒ</ci><ci id="S3.p3.12.m1.1.1.3.cmml" xref="S3.p3.12.m1.1.1.3">𝑘</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p3.12.m1.1c">\mathcal{L}_{k}</annotation></semantics></math> represents the local loss function, and <math id="S3.p3.13.m2.1" class="ltx_Math" alttext="\mathcal{D}^{T}=\bigcup_{k\in\mathcal{K}}\mathcal{D}^{T}_{k}" display="inline"><semantics id="S3.p3.13.m2.1a"><mrow id="S3.p3.13.m2.1.1" xref="S3.p3.13.m2.1.1.cmml"><msup id="S3.p3.13.m2.1.1.2" xref="S3.p3.13.m2.1.1.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.p3.13.m2.1.1.2.2" xref="S3.p3.13.m2.1.1.2.2.cmml">𝒟</mi><mi id="S3.p3.13.m2.1.1.2.3" xref="S3.p3.13.m2.1.1.2.3.cmml">T</mi></msup><mo rspace="0.111em" id="S3.p3.13.m2.1.1.1" xref="S3.p3.13.m2.1.1.1.cmml">=</mo><mrow id="S3.p3.13.m2.1.1.3" xref="S3.p3.13.m2.1.1.3.cmml"><msub id="S3.p3.13.m2.1.1.3.1" xref="S3.p3.13.m2.1.1.3.1.cmml"><mo id="S3.p3.13.m2.1.1.3.1.2" xref="S3.p3.13.m2.1.1.3.1.2.cmml">⋃</mo><mrow id="S3.p3.13.m2.1.1.3.1.3" xref="S3.p3.13.m2.1.1.3.1.3.cmml"><mi id="S3.p3.13.m2.1.1.3.1.3.2" xref="S3.p3.13.m2.1.1.3.1.3.2.cmml">k</mi><mo id="S3.p3.13.m2.1.1.3.1.3.1" xref="S3.p3.13.m2.1.1.3.1.3.1.cmml">∈</mo><mi class="ltx_font_mathcaligraphic" id="S3.p3.13.m2.1.1.3.1.3.3" xref="S3.p3.13.m2.1.1.3.1.3.3.cmml">𝒦</mi></mrow></msub><msubsup id="S3.p3.13.m2.1.1.3.2" xref="S3.p3.13.m2.1.1.3.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.p3.13.m2.1.1.3.2.2.2" xref="S3.p3.13.m2.1.1.3.2.2.2.cmml">𝒟</mi><mi id="S3.p3.13.m2.1.1.3.2.3" xref="S3.p3.13.m2.1.1.3.2.3.cmml">k</mi><mi id="S3.p3.13.m2.1.1.3.2.2.3" xref="S3.p3.13.m2.1.1.3.2.2.3.cmml">T</mi></msubsup></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.p3.13.m2.1b"><apply id="S3.p3.13.m2.1.1.cmml" xref="S3.p3.13.m2.1.1"><eq id="S3.p3.13.m2.1.1.1.cmml" xref="S3.p3.13.m2.1.1.1"></eq><apply id="S3.p3.13.m2.1.1.2.cmml" xref="S3.p3.13.m2.1.1.2"><csymbol cd="ambiguous" id="S3.p3.13.m2.1.1.2.1.cmml" xref="S3.p3.13.m2.1.1.2">superscript</csymbol><ci id="S3.p3.13.m2.1.1.2.2.cmml" xref="S3.p3.13.m2.1.1.2.2">𝒟</ci><ci id="S3.p3.13.m2.1.1.2.3.cmml" xref="S3.p3.13.m2.1.1.2.3">𝑇</ci></apply><apply id="S3.p3.13.m2.1.1.3.cmml" xref="S3.p3.13.m2.1.1.3"><apply id="S3.p3.13.m2.1.1.3.1.cmml" xref="S3.p3.13.m2.1.1.3.1"><csymbol cd="ambiguous" id="S3.p3.13.m2.1.1.3.1.1.cmml" xref="S3.p3.13.m2.1.1.3.1">subscript</csymbol><union id="S3.p3.13.m2.1.1.3.1.2.cmml" xref="S3.p3.13.m2.1.1.3.1.2"></union><apply id="S3.p3.13.m2.1.1.3.1.3.cmml" xref="S3.p3.13.m2.1.1.3.1.3"><in id="S3.p3.13.m2.1.1.3.1.3.1.cmml" xref="S3.p3.13.m2.1.1.3.1.3.1"></in><ci id="S3.p3.13.m2.1.1.3.1.3.2.cmml" xref="S3.p3.13.m2.1.1.3.1.3.2">𝑘</ci><ci id="S3.p3.13.m2.1.1.3.1.3.3.cmml" xref="S3.p3.13.m2.1.1.3.1.3.3">𝒦</ci></apply></apply><apply id="S3.p3.13.m2.1.1.3.2.cmml" xref="S3.p3.13.m2.1.1.3.2"><csymbol cd="ambiguous" id="S3.p3.13.m2.1.1.3.2.1.cmml" xref="S3.p3.13.m2.1.1.3.2">subscript</csymbol><apply id="S3.p3.13.m2.1.1.3.2.2.cmml" xref="S3.p3.13.m2.1.1.3.2"><csymbol cd="ambiguous" id="S3.p3.13.m2.1.1.3.2.2.1.cmml" xref="S3.p3.13.m2.1.1.3.2">superscript</csymbol><ci id="S3.p3.13.m2.1.1.3.2.2.2.cmml" xref="S3.p3.13.m2.1.1.3.2.2.2">𝒟</ci><ci id="S3.p3.13.m2.1.1.3.2.2.3.cmml" xref="S3.p3.13.m2.1.1.3.2.2.3">𝑇</ci></apply><ci id="S3.p3.13.m2.1.1.3.2.3.cmml" xref="S3.p3.13.m2.1.1.3.2.3">𝑘</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p3.13.m2.1c">\mathcal{D}^{T}=\bigcup_{k\in\mathcal{K}}\mathcal{D}^{T}_{k}</annotation></semantics></math>.
<br class="ltx_break"></p>
</div>
<div id="S3.p4" class="ltx_para ltx_noindent">
<p id="S3.p4.11" class="ltx_p"><span id="S3.p4.11.1" class="ltx_text ltx_font_bold">Multi-viewpoint <span id="S3.p4.11.1.1" class="ltx_text ltx_font_smallcaps">FFreeDA</span> in Adverse Weather.</span> Aiming to assist agents lacking large training datasets or capabilities, such as drones, we consider a setting that enables scene understanding for unsupervised autonomous navigation robust to multiple viewpoints. First of all, we consider <math id="S3.p4.1.m1.1" class="ltx_Math" alttext="\mathcal{D}^{S}=\mathcal{D}^{S}_{car}\cup\mathcal{D}^{S}_{drone}" display="inline"><semantics id="S3.p4.1.m1.1a"><mrow id="S3.p4.1.m1.1.1" xref="S3.p4.1.m1.1.1.cmml"><msup id="S3.p4.1.m1.1.1.2" xref="S3.p4.1.m1.1.1.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.p4.1.m1.1.1.2.2" xref="S3.p4.1.m1.1.1.2.2.cmml">𝒟</mi><mi id="S3.p4.1.m1.1.1.2.3" xref="S3.p4.1.m1.1.1.2.3.cmml">S</mi></msup><mo id="S3.p4.1.m1.1.1.1" xref="S3.p4.1.m1.1.1.1.cmml">=</mo><mrow id="S3.p4.1.m1.1.1.3" xref="S3.p4.1.m1.1.1.3.cmml"><msubsup id="S3.p4.1.m1.1.1.3.2" xref="S3.p4.1.m1.1.1.3.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.p4.1.m1.1.1.3.2.2.2" xref="S3.p4.1.m1.1.1.3.2.2.2.cmml">𝒟</mi><mrow id="S3.p4.1.m1.1.1.3.2.3" xref="S3.p4.1.m1.1.1.3.2.3.cmml"><mi id="S3.p4.1.m1.1.1.3.2.3.2" xref="S3.p4.1.m1.1.1.3.2.3.2.cmml">c</mi><mo lspace="0em" rspace="0em" id="S3.p4.1.m1.1.1.3.2.3.1" xref="S3.p4.1.m1.1.1.3.2.3.1.cmml">​</mo><mi id="S3.p4.1.m1.1.1.3.2.3.3" xref="S3.p4.1.m1.1.1.3.2.3.3.cmml">a</mi><mo lspace="0em" rspace="0em" id="S3.p4.1.m1.1.1.3.2.3.1a" xref="S3.p4.1.m1.1.1.3.2.3.1.cmml">​</mo><mi id="S3.p4.1.m1.1.1.3.2.3.4" xref="S3.p4.1.m1.1.1.3.2.3.4.cmml">r</mi></mrow><mi id="S3.p4.1.m1.1.1.3.2.2.3" xref="S3.p4.1.m1.1.1.3.2.2.3.cmml">S</mi></msubsup><mo id="S3.p4.1.m1.1.1.3.1" xref="S3.p4.1.m1.1.1.3.1.cmml">∪</mo><msubsup id="S3.p4.1.m1.1.1.3.3" xref="S3.p4.1.m1.1.1.3.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.p4.1.m1.1.1.3.3.2.2" xref="S3.p4.1.m1.1.1.3.3.2.2.cmml">𝒟</mi><mrow id="S3.p4.1.m1.1.1.3.3.3" xref="S3.p4.1.m1.1.1.3.3.3.cmml"><mi id="S3.p4.1.m1.1.1.3.3.3.2" xref="S3.p4.1.m1.1.1.3.3.3.2.cmml">d</mi><mo lspace="0em" rspace="0em" id="S3.p4.1.m1.1.1.3.3.3.1" xref="S3.p4.1.m1.1.1.3.3.3.1.cmml">​</mo><mi id="S3.p4.1.m1.1.1.3.3.3.3" xref="S3.p4.1.m1.1.1.3.3.3.3.cmml">r</mi><mo lspace="0em" rspace="0em" id="S3.p4.1.m1.1.1.3.3.3.1a" xref="S3.p4.1.m1.1.1.3.3.3.1.cmml">​</mo><mi id="S3.p4.1.m1.1.1.3.3.3.4" xref="S3.p4.1.m1.1.1.3.3.3.4.cmml">o</mi><mo lspace="0em" rspace="0em" id="S3.p4.1.m1.1.1.3.3.3.1b" xref="S3.p4.1.m1.1.1.3.3.3.1.cmml">​</mo><mi id="S3.p4.1.m1.1.1.3.3.3.5" xref="S3.p4.1.m1.1.1.3.3.3.5.cmml">n</mi><mo lspace="0em" rspace="0em" id="S3.p4.1.m1.1.1.3.3.3.1c" xref="S3.p4.1.m1.1.1.3.3.3.1.cmml">​</mo><mi id="S3.p4.1.m1.1.1.3.3.3.6" xref="S3.p4.1.m1.1.1.3.3.3.6.cmml">e</mi></mrow><mi id="S3.p4.1.m1.1.1.3.3.2.3" xref="S3.p4.1.m1.1.1.3.3.2.3.cmml">S</mi></msubsup></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.p4.1.m1.1b"><apply id="S3.p4.1.m1.1.1.cmml" xref="S3.p4.1.m1.1.1"><eq id="S3.p4.1.m1.1.1.1.cmml" xref="S3.p4.1.m1.1.1.1"></eq><apply id="S3.p4.1.m1.1.1.2.cmml" xref="S3.p4.1.m1.1.1.2"><csymbol cd="ambiguous" id="S3.p4.1.m1.1.1.2.1.cmml" xref="S3.p4.1.m1.1.1.2">superscript</csymbol><ci id="S3.p4.1.m1.1.1.2.2.cmml" xref="S3.p4.1.m1.1.1.2.2">𝒟</ci><ci id="S3.p4.1.m1.1.1.2.3.cmml" xref="S3.p4.1.m1.1.1.2.3">𝑆</ci></apply><apply id="S3.p4.1.m1.1.1.3.cmml" xref="S3.p4.1.m1.1.1.3"><union id="S3.p4.1.m1.1.1.3.1.cmml" xref="S3.p4.1.m1.1.1.3.1"></union><apply id="S3.p4.1.m1.1.1.3.2.cmml" xref="S3.p4.1.m1.1.1.3.2"><csymbol cd="ambiguous" id="S3.p4.1.m1.1.1.3.2.1.cmml" xref="S3.p4.1.m1.1.1.3.2">subscript</csymbol><apply id="S3.p4.1.m1.1.1.3.2.2.cmml" xref="S3.p4.1.m1.1.1.3.2"><csymbol cd="ambiguous" id="S3.p4.1.m1.1.1.3.2.2.1.cmml" xref="S3.p4.1.m1.1.1.3.2">superscript</csymbol><ci id="S3.p4.1.m1.1.1.3.2.2.2.cmml" xref="S3.p4.1.m1.1.1.3.2.2.2">𝒟</ci><ci id="S3.p4.1.m1.1.1.3.2.2.3.cmml" xref="S3.p4.1.m1.1.1.3.2.2.3">𝑆</ci></apply><apply id="S3.p4.1.m1.1.1.3.2.3.cmml" xref="S3.p4.1.m1.1.1.3.2.3"><times id="S3.p4.1.m1.1.1.3.2.3.1.cmml" xref="S3.p4.1.m1.1.1.3.2.3.1"></times><ci id="S3.p4.1.m1.1.1.3.2.3.2.cmml" xref="S3.p4.1.m1.1.1.3.2.3.2">𝑐</ci><ci id="S3.p4.1.m1.1.1.3.2.3.3.cmml" xref="S3.p4.1.m1.1.1.3.2.3.3">𝑎</ci><ci id="S3.p4.1.m1.1.1.3.2.3.4.cmml" xref="S3.p4.1.m1.1.1.3.2.3.4">𝑟</ci></apply></apply><apply id="S3.p4.1.m1.1.1.3.3.cmml" xref="S3.p4.1.m1.1.1.3.3"><csymbol cd="ambiguous" id="S3.p4.1.m1.1.1.3.3.1.cmml" xref="S3.p4.1.m1.1.1.3.3">subscript</csymbol><apply id="S3.p4.1.m1.1.1.3.3.2.cmml" xref="S3.p4.1.m1.1.1.3.3"><csymbol cd="ambiguous" id="S3.p4.1.m1.1.1.3.3.2.1.cmml" xref="S3.p4.1.m1.1.1.3.3">superscript</csymbol><ci id="S3.p4.1.m1.1.1.3.3.2.2.cmml" xref="S3.p4.1.m1.1.1.3.3.2.2">𝒟</ci><ci id="S3.p4.1.m1.1.1.3.3.2.3.cmml" xref="S3.p4.1.m1.1.1.3.3.2.3">𝑆</ci></apply><apply id="S3.p4.1.m1.1.1.3.3.3.cmml" xref="S3.p4.1.m1.1.1.3.3.3"><times id="S3.p4.1.m1.1.1.3.3.3.1.cmml" xref="S3.p4.1.m1.1.1.3.3.3.1"></times><ci id="S3.p4.1.m1.1.1.3.3.3.2.cmml" xref="S3.p4.1.m1.1.1.3.3.3.2">𝑑</ci><ci id="S3.p4.1.m1.1.1.3.3.3.3.cmml" xref="S3.p4.1.m1.1.1.3.3.3.3">𝑟</ci><ci id="S3.p4.1.m1.1.1.3.3.3.4.cmml" xref="S3.p4.1.m1.1.1.3.3.3.4">𝑜</ci><ci id="S3.p4.1.m1.1.1.3.3.3.5.cmml" xref="S3.p4.1.m1.1.1.3.3.3.5">𝑛</ci><ci id="S3.p4.1.m1.1.1.3.3.3.6.cmml" xref="S3.p4.1.m1.1.1.3.3.3.6">𝑒</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p4.1.m1.1c">\mathcal{D}^{S}=\mathcal{D}^{S}_{car}\cup\mathcal{D}^{S}_{drone}</annotation></semantics></math>. Accounting for adverse weather as a heterogeneity factor, our dataset <math id="S3.p4.2.m2.1" class="ltx_Math" alttext="\mathcal{D}^{S}=\{(\mathbf{x}^{S},\mathbf{y}^{S},w^{S})\}^{N^{S}}" display="inline"><semantics id="S3.p4.2.m2.1a"><mrow id="S3.p4.2.m2.1.1" xref="S3.p4.2.m2.1.1.cmml"><msup id="S3.p4.2.m2.1.1.3" xref="S3.p4.2.m2.1.1.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.p4.2.m2.1.1.3.2" xref="S3.p4.2.m2.1.1.3.2.cmml">𝒟</mi><mi id="S3.p4.2.m2.1.1.3.3" xref="S3.p4.2.m2.1.1.3.3.cmml">S</mi></msup><mo id="S3.p4.2.m2.1.1.2" xref="S3.p4.2.m2.1.1.2.cmml">=</mo><msup id="S3.p4.2.m2.1.1.1" xref="S3.p4.2.m2.1.1.1.cmml"><mrow id="S3.p4.2.m2.1.1.1.1.1" xref="S3.p4.2.m2.1.1.1.1.2.cmml"><mo stretchy="false" id="S3.p4.2.m2.1.1.1.1.1.2" xref="S3.p4.2.m2.1.1.1.1.2.cmml">{</mo><mrow id="S3.p4.2.m2.1.1.1.1.1.1.3" xref="S3.p4.2.m2.1.1.1.1.1.1.4.cmml"><mo stretchy="false" id="S3.p4.2.m2.1.1.1.1.1.1.3.4" xref="S3.p4.2.m2.1.1.1.1.1.1.4.cmml">(</mo><msup id="S3.p4.2.m2.1.1.1.1.1.1.1.1" xref="S3.p4.2.m2.1.1.1.1.1.1.1.1.cmml"><mi id="S3.p4.2.m2.1.1.1.1.1.1.1.1.2" xref="S3.p4.2.m2.1.1.1.1.1.1.1.1.2.cmml">𝐱</mi><mi id="S3.p4.2.m2.1.1.1.1.1.1.1.1.3" xref="S3.p4.2.m2.1.1.1.1.1.1.1.1.3.cmml">S</mi></msup><mo id="S3.p4.2.m2.1.1.1.1.1.1.3.5" xref="S3.p4.2.m2.1.1.1.1.1.1.4.cmml">,</mo><msup id="S3.p4.2.m2.1.1.1.1.1.1.2.2" xref="S3.p4.2.m2.1.1.1.1.1.1.2.2.cmml"><mi id="S3.p4.2.m2.1.1.1.1.1.1.2.2.2" xref="S3.p4.2.m2.1.1.1.1.1.1.2.2.2.cmml">𝐲</mi><mi id="S3.p4.2.m2.1.1.1.1.1.1.2.2.3" xref="S3.p4.2.m2.1.1.1.1.1.1.2.2.3.cmml">S</mi></msup><mo id="S3.p4.2.m2.1.1.1.1.1.1.3.6" xref="S3.p4.2.m2.1.1.1.1.1.1.4.cmml">,</mo><msup id="S3.p4.2.m2.1.1.1.1.1.1.3.3" xref="S3.p4.2.m2.1.1.1.1.1.1.3.3.cmml"><mi id="S3.p4.2.m2.1.1.1.1.1.1.3.3.2" xref="S3.p4.2.m2.1.1.1.1.1.1.3.3.2.cmml">w</mi><mi id="S3.p4.2.m2.1.1.1.1.1.1.3.3.3" xref="S3.p4.2.m2.1.1.1.1.1.1.3.3.3.cmml">S</mi></msup><mo stretchy="false" id="S3.p4.2.m2.1.1.1.1.1.1.3.7" xref="S3.p4.2.m2.1.1.1.1.1.1.4.cmml">)</mo></mrow><mo stretchy="false" id="S3.p4.2.m2.1.1.1.1.1.3" xref="S3.p4.2.m2.1.1.1.1.2.cmml">}</mo></mrow><msup id="S3.p4.2.m2.1.1.1.3" xref="S3.p4.2.m2.1.1.1.3.cmml"><mi id="S3.p4.2.m2.1.1.1.3.2" xref="S3.p4.2.m2.1.1.1.3.2.cmml">N</mi><mi id="S3.p4.2.m2.1.1.1.3.3" xref="S3.p4.2.m2.1.1.1.3.3.cmml">S</mi></msup></msup></mrow><annotation-xml encoding="MathML-Content" id="S3.p4.2.m2.1b"><apply id="S3.p4.2.m2.1.1.cmml" xref="S3.p4.2.m2.1.1"><eq id="S3.p4.2.m2.1.1.2.cmml" xref="S3.p4.2.m2.1.1.2"></eq><apply id="S3.p4.2.m2.1.1.3.cmml" xref="S3.p4.2.m2.1.1.3"><csymbol cd="ambiguous" id="S3.p4.2.m2.1.1.3.1.cmml" xref="S3.p4.2.m2.1.1.3">superscript</csymbol><ci id="S3.p4.2.m2.1.1.3.2.cmml" xref="S3.p4.2.m2.1.1.3.2">𝒟</ci><ci id="S3.p4.2.m2.1.1.3.3.cmml" xref="S3.p4.2.m2.1.1.3.3">𝑆</ci></apply><apply id="S3.p4.2.m2.1.1.1.cmml" xref="S3.p4.2.m2.1.1.1"><csymbol cd="ambiguous" id="S3.p4.2.m2.1.1.1.2.cmml" xref="S3.p4.2.m2.1.1.1">superscript</csymbol><set id="S3.p4.2.m2.1.1.1.1.2.cmml" xref="S3.p4.2.m2.1.1.1.1.1"><vector id="S3.p4.2.m2.1.1.1.1.1.1.4.cmml" xref="S3.p4.2.m2.1.1.1.1.1.1.3"><apply id="S3.p4.2.m2.1.1.1.1.1.1.1.1.cmml" xref="S3.p4.2.m2.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.p4.2.m2.1.1.1.1.1.1.1.1.1.cmml" xref="S3.p4.2.m2.1.1.1.1.1.1.1.1">superscript</csymbol><ci id="S3.p4.2.m2.1.1.1.1.1.1.1.1.2.cmml" xref="S3.p4.2.m2.1.1.1.1.1.1.1.1.2">𝐱</ci><ci id="S3.p4.2.m2.1.1.1.1.1.1.1.1.3.cmml" xref="S3.p4.2.m2.1.1.1.1.1.1.1.1.3">𝑆</ci></apply><apply id="S3.p4.2.m2.1.1.1.1.1.1.2.2.cmml" xref="S3.p4.2.m2.1.1.1.1.1.1.2.2"><csymbol cd="ambiguous" id="S3.p4.2.m2.1.1.1.1.1.1.2.2.1.cmml" xref="S3.p4.2.m2.1.1.1.1.1.1.2.2">superscript</csymbol><ci id="S3.p4.2.m2.1.1.1.1.1.1.2.2.2.cmml" xref="S3.p4.2.m2.1.1.1.1.1.1.2.2.2">𝐲</ci><ci id="S3.p4.2.m2.1.1.1.1.1.1.2.2.3.cmml" xref="S3.p4.2.m2.1.1.1.1.1.1.2.2.3">𝑆</ci></apply><apply id="S3.p4.2.m2.1.1.1.1.1.1.3.3.cmml" xref="S3.p4.2.m2.1.1.1.1.1.1.3.3"><csymbol cd="ambiguous" id="S3.p4.2.m2.1.1.1.1.1.1.3.3.1.cmml" xref="S3.p4.2.m2.1.1.1.1.1.1.3.3">superscript</csymbol><ci id="S3.p4.2.m2.1.1.1.1.1.1.3.3.2.cmml" xref="S3.p4.2.m2.1.1.1.1.1.1.3.3.2">𝑤</ci><ci id="S3.p4.2.m2.1.1.1.1.1.1.3.3.3.cmml" xref="S3.p4.2.m2.1.1.1.1.1.1.3.3.3">𝑆</ci></apply></vector></set><apply id="S3.p4.2.m2.1.1.1.3.cmml" xref="S3.p4.2.m2.1.1.1.3"><csymbol cd="ambiguous" id="S3.p4.2.m2.1.1.1.3.1.cmml" xref="S3.p4.2.m2.1.1.1.3">superscript</csymbol><ci id="S3.p4.2.m2.1.1.1.3.2.cmml" xref="S3.p4.2.m2.1.1.1.3.2">𝑁</ci><ci id="S3.p4.2.m2.1.1.1.3.3.cmml" xref="S3.p4.2.m2.1.1.1.3.3">𝑆</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p4.2.m2.1c">\mathcal{D}^{S}=\{(\mathbf{x}^{S},\mathbf{y}^{S},w^{S})\}^{N^{S}}</annotation></semantics></math> also includes <math id="S3.p4.3.m3.1" class="ltx_Math" alttext="w^{S}" display="inline"><semantics id="S3.p4.3.m3.1a"><msup id="S3.p4.3.m3.1.1" xref="S3.p4.3.m3.1.1.cmml"><mi id="S3.p4.3.m3.1.1.2" xref="S3.p4.3.m3.1.1.2.cmml">w</mi><mi id="S3.p4.3.m3.1.1.3" xref="S3.p4.3.m3.1.1.3.cmml">S</mi></msup><annotation-xml encoding="MathML-Content" id="S3.p4.3.m3.1b"><apply id="S3.p4.3.m3.1.1.cmml" xref="S3.p4.3.m3.1.1"><csymbol cd="ambiguous" id="S3.p4.3.m3.1.1.1.cmml" xref="S3.p4.3.m3.1.1">superscript</csymbol><ci id="S3.p4.3.m3.1.1.2.cmml" xref="S3.p4.3.m3.1.1.2">𝑤</ci><ci id="S3.p4.3.m3.1.1.3.cmml" xref="S3.p4.3.m3.1.1.3">𝑆</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p4.3.m3.1c">w^{S}</annotation></semantics></math>, denoting the atmospheric condition for each frame, together with the color images <math id="S3.p4.4.m4.1" class="ltx_Math" alttext="\mathbf{x}^{S}" display="inline"><semantics id="S3.p4.4.m4.1a"><msup id="S3.p4.4.m4.1.1" xref="S3.p4.4.m4.1.1.cmml"><mi id="S3.p4.4.m4.1.1.2" xref="S3.p4.4.m4.1.1.2.cmml">𝐱</mi><mi id="S3.p4.4.m4.1.1.3" xref="S3.p4.4.m4.1.1.3.cmml">S</mi></msup><annotation-xml encoding="MathML-Content" id="S3.p4.4.m4.1b"><apply id="S3.p4.4.m4.1.1.cmml" xref="S3.p4.4.m4.1.1"><csymbol cd="ambiguous" id="S3.p4.4.m4.1.1.1.cmml" xref="S3.p4.4.m4.1.1">superscript</csymbol><ci id="S3.p4.4.m4.1.1.2.cmml" xref="S3.p4.4.m4.1.1.2">𝐱</ci><ci id="S3.p4.4.m4.1.1.3.cmml" xref="S3.p4.4.m4.1.1.3">𝑆</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p4.4.m4.1c">\mathbf{x}^{S}</annotation></semantics></math> and the ground truth segmentation maps <math id="S3.p4.5.m5.1" class="ltx_Math" alttext="\mathbf{y}^{S}" display="inline"><semantics id="S3.p4.5.m5.1a"><msup id="S3.p4.5.m5.1.1" xref="S3.p4.5.m5.1.1.cmml"><mi id="S3.p4.5.m5.1.1.2" xref="S3.p4.5.m5.1.1.2.cmml">𝐲</mi><mi id="S3.p4.5.m5.1.1.3" xref="S3.p4.5.m5.1.1.3.cmml">S</mi></msup><annotation-xml encoding="MathML-Content" id="S3.p4.5.m5.1b"><apply id="S3.p4.5.m5.1.1.cmml" xref="S3.p4.5.m5.1.1"><csymbol cd="ambiguous" id="S3.p4.5.m5.1.1.1.cmml" xref="S3.p4.5.m5.1.1">superscript</csymbol><ci id="S3.p4.5.m5.1.1.2.cmml" xref="S3.p4.5.m5.1.1.2">𝐲</ci><ci id="S3.p4.5.m5.1.1.3.cmml" xref="S3.p4.5.m5.1.1.3">𝑆</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p4.5.m5.1c">\mathbf{y}^{S}</annotation></semantics></math>.
Similarly, the client can accommodate either car or drone agents: <math id="S3.p4.6.m6.1" class="ltx_Math" alttext="\mathcal{D}^{T}=\mathcal{D}^{T}_{car}\cup\mathcal{D}^{T}_{drone}" display="inline"><semantics id="S3.p4.6.m6.1a"><mrow id="S3.p4.6.m6.1.1" xref="S3.p4.6.m6.1.1.cmml"><msup id="S3.p4.6.m6.1.1.2" xref="S3.p4.6.m6.1.1.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.p4.6.m6.1.1.2.2" xref="S3.p4.6.m6.1.1.2.2.cmml">𝒟</mi><mi id="S3.p4.6.m6.1.1.2.3" xref="S3.p4.6.m6.1.1.2.3.cmml">T</mi></msup><mo id="S3.p4.6.m6.1.1.1" xref="S3.p4.6.m6.1.1.1.cmml">=</mo><mrow id="S3.p4.6.m6.1.1.3" xref="S3.p4.6.m6.1.1.3.cmml"><msubsup id="S3.p4.6.m6.1.1.3.2" xref="S3.p4.6.m6.1.1.3.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.p4.6.m6.1.1.3.2.2.2" xref="S3.p4.6.m6.1.1.3.2.2.2.cmml">𝒟</mi><mrow id="S3.p4.6.m6.1.1.3.2.3" xref="S3.p4.6.m6.1.1.3.2.3.cmml"><mi id="S3.p4.6.m6.1.1.3.2.3.2" xref="S3.p4.6.m6.1.1.3.2.3.2.cmml">c</mi><mo lspace="0em" rspace="0em" id="S3.p4.6.m6.1.1.3.2.3.1" xref="S3.p4.6.m6.1.1.3.2.3.1.cmml">​</mo><mi id="S3.p4.6.m6.1.1.3.2.3.3" xref="S3.p4.6.m6.1.1.3.2.3.3.cmml">a</mi><mo lspace="0em" rspace="0em" id="S3.p4.6.m6.1.1.3.2.3.1a" xref="S3.p4.6.m6.1.1.3.2.3.1.cmml">​</mo><mi id="S3.p4.6.m6.1.1.3.2.3.4" xref="S3.p4.6.m6.1.1.3.2.3.4.cmml">r</mi></mrow><mi id="S3.p4.6.m6.1.1.3.2.2.3" xref="S3.p4.6.m6.1.1.3.2.2.3.cmml">T</mi></msubsup><mo id="S3.p4.6.m6.1.1.3.1" xref="S3.p4.6.m6.1.1.3.1.cmml">∪</mo><msubsup id="S3.p4.6.m6.1.1.3.3" xref="S3.p4.6.m6.1.1.3.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.p4.6.m6.1.1.3.3.2.2" xref="S3.p4.6.m6.1.1.3.3.2.2.cmml">𝒟</mi><mrow id="S3.p4.6.m6.1.1.3.3.3" xref="S3.p4.6.m6.1.1.3.3.3.cmml"><mi id="S3.p4.6.m6.1.1.3.3.3.2" xref="S3.p4.6.m6.1.1.3.3.3.2.cmml">d</mi><mo lspace="0em" rspace="0em" id="S3.p4.6.m6.1.1.3.3.3.1" xref="S3.p4.6.m6.1.1.3.3.3.1.cmml">​</mo><mi id="S3.p4.6.m6.1.1.3.3.3.3" xref="S3.p4.6.m6.1.1.3.3.3.3.cmml">r</mi><mo lspace="0em" rspace="0em" id="S3.p4.6.m6.1.1.3.3.3.1a" xref="S3.p4.6.m6.1.1.3.3.3.1.cmml">​</mo><mi id="S3.p4.6.m6.1.1.3.3.3.4" xref="S3.p4.6.m6.1.1.3.3.3.4.cmml">o</mi><mo lspace="0em" rspace="0em" id="S3.p4.6.m6.1.1.3.3.3.1b" xref="S3.p4.6.m6.1.1.3.3.3.1.cmml">​</mo><mi id="S3.p4.6.m6.1.1.3.3.3.5" xref="S3.p4.6.m6.1.1.3.3.3.5.cmml">n</mi><mo lspace="0em" rspace="0em" id="S3.p4.6.m6.1.1.3.3.3.1c" xref="S3.p4.6.m6.1.1.3.3.3.1.cmml">​</mo><mi id="S3.p4.6.m6.1.1.3.3.3.6" xref="S3.p4.6.m6.1.1.3.3.3.6.cmml">e</mi></mrow><mi id="S3.p4.6.m6.1.1.3.3.2.3" xref="S3.p4.6.m6.1.1.3.3.2.3.cmml">T</mi></msubsup></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.p4.6.m6.1b"><apply id="S3.p4.6.m6.1.1.cmml" xref="S3.p4.6.m6.1.1"><eq id="S3.p4.6.m6.1.1.1.cmml" xref="S3.p4.6.m6.1.1.1"></eq><apply id="S3.p4.6.m6.1.1.2.cmml" xref="S3.p4.6.m6.1.1.2"><csymbol cd="ambiguous" id="S3.p4.6.m6.1.1.2.1.cmml" xref="S3.p4.6.m6.1.1.2">superscript</csymbol><ci id="S3.p4.6.m6.1.1.2.2.cmml" xref="S3.p4.6.m6.1.1.2.2">𝒟</ci><ci id="S3.p4.6.m6.1.1.2.3.cmml" xref="S3.p4.6.m6.1.1.2.3">𝑇</ci></apply><apply id="S3.p4.6.m6.1.1.3.cmml" xref="S3.p4.6.m6.1.1.3"><union id="S3.p4.6.m6.1.1.3.1.cmml" xref="S3.p4.6.m6.1.1.3.1"></union><apply id="S3.p4.6.m6.1.1.3.2.cmml" xref="S3.p4.6.m6.1.1.3.2"><csymbol cd="ambiguous" id="S3.p4.6.m6.1.1.3.2.1.cmml" xref="S3.p4.6.m6.1.1.3.2">subscript</csymbol><apply id="S3.p4.6.m6.1.1.3.2.2.cmml" xref="S3.p4.6.m6.1.1.3.2"><csymbol cd="ambiguous" id="S3.p4.6.m6.1.1.3.2.2.1.cmml" xref="S3.p4.6.m6.1.1.3.2">superscript</csymbol><ci id="S3.p4.6.m6.1.1.3.2.2.2.cmml" xref="S3.p4.6.m6.1.1.3.2.2.2">𝒟</ci><ci id="S3.p4.6.m6.1.1.3.2.2.3.cmml" xref="S3.p4.6.m6.1.1.3.2.2.3">𝑇</ci></apply><apply id="S3.p4.6.m6.1.1.3.2.3.cmml" xref="S3.p4.6.m6.1.1.3.2.3"><times id="S3.p4.6.m6.1.1.3.2.3.1.cmml" xref="S3.p4.6.m6.1.1.3.2.3.1"></times><ci id="S3.p4.6.m6.1.1.3.2.3.2.cmml" xref="S3.p4.6.m6.1.1.3.2.3.2">𝑐</ci><ci id="S3.p4.6.m6.1.1.3.2.3.3.cmml" xref="S3.p4.6.m6.1.1.3.2.3.3">𝑎</ci><ci id="S3.p4.6.m6.1.1.3.2.3.4.cmml" xref="S3.p4.6.m6.1.1.3.2.3.4">𝑟</ci></apply></apply><apply id="S3.p4.6.m6.1.1.3.3.cmml" xref="S3.p4.6.m6.1.1.3.3"><csymbol cd="ambiguous" id="S3.p4.6.m6.1.1.3.3.1.cmml" xref="S3.p4.6.m6.1.1.3.3">subscript</csymbol><apply id="S3.p4.6.m6.1.1.3.3.2.cmml" xref="S3.p4.6.m6.1.1.3.3"><csymbol cd="ambiguous" id="S3.p4.6.m6.1.1.3.3.2.1.cmml" xref="S3.p4.6.m6.1.1.3.3">superscript</csymbol><ci id="S3.p4.6.m6.1.1.3.3.2.2.cmml" xref="S3.p4.6.m6.1.1.3.3.2.2">𝒟</ci><ci id="S3.p4.6.m6.1.1.3.3.2.3.cmml" xref="S3.p4.6.m6.1.1.3.3.2.3">𝑇</ci></apply><apply id="S3.p4.6.m6.1.1.3.3.3.cmml" xref="S3.p4.6.m6.1.1.3.3.3"><times id="S3.p4.6.m6.1.1.3.3.3.1.cmml" xref="S3.p4.6.m6.1.1.3.3.3.1"></times><ci id="S3.p4.6.m6.1.1.3.3.3.2.cmml" xref="S3.p4.6.m6.1.1.3.3.3.2">𝑑</ci><ci id="S3.p4.6.m6.1.1.3.3.3.3.cmml" xref="S3.p4.6.m6.1.1.3.3.3.3">𝑟</ci><ci id="S3.p4.6.m6.1.1.3.3.3.4.cmml" xref="S3.p4.6.m6.1.1.3.3.3.4">𝑜</ci><ci id="S3.p4.6.m6.1.1.3.3.3.5.cmml" xref="S3.p4.6.m6.1.1.3.3.3.5">𝑛</ci><ci id="S3.p4.6.m6.1.1.3.3.3.6.cmml" xref="S3.p4.6.m6.1.1.3.3.3.6">𝑒</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p4.6.m6.1c">\mathcal{D}^{T}=\mathcal{D}^{T}_{car}\cup\mathcal{D}^{T}_{drone}</annotation></semantics></math>, although clients datasets are still local and disjoint. As in the previous setting, each client <math id="S3.p4.7.m7.1" class="ltx_Math" alttext="k\in\mathcal{K}" display="inline"><semantics id="S3.p4.7.m7.1a"><mrow id="S3.p4.7.m7.1.1" xref="S3.p4.7.m7.1.1.cmml"><mi id="S3.p4.7.m7.1.1.2" xref="S3.p4.7.m7.1.1.2.cmml">k</mi><mo id="S3.p4.7.m7.1.1.1" xref="S3.p4.7.m7.1.1.1.cmml">∈</mo><mi class="ltx_font_mathcaligraphic" id="S3.p4.7.m7.1.1.3" xref="S3.p4.7.m7.1.1.3.cmml">𝒦</mi></mrow><annotation-xml encoding="MathML-Content" id="S3.p4.7.m7.1b"><apply id="S3.p4.7.m7.1.1.cmml" xref="S3.p4.7.m7.1.1"><in id="S3.p4.7.m7.1.1.1.cmml" xref="S3.p4.7.m7.1.1.1"></in><ci id="S3.p4.7.m7.1.1.2.cmml" xref="S3.p4.7.m7.1.1.2">𝑘</ci><ci id="S3.p4.7.m7.1.1.3.cmml" xref="S3.p4.7.m7.1.1.3">𝒦</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p4.7.m7.1c">k\in\mathcal{K}</annotation></semantics></math> have its own set of unsupervised images both in terms of semantics and weather: <math id="S3.p4.8.m8.1" class="ltx_Math" alttext="\mathcal{D}^{T}_{k}=\{(\mathbf{x}^{T}_{k})\}" display="inline"><semantics id="S3.p4.8.m8.1a"><mrow id="S3.p4.8.m8.1.1" xref="S3.p4.8.m8.1.1.cmml"><msubsup id="S3.p4.8.m8.1.1.3" xref="S3.p4.8.m8.1.1.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.p4.8.m8.1.1.3.2.2" xref="S3.p4.8.m8.1.1.3.2.2.cmml">𝒟</mi><mi id="S3.p4.8.m8.1.1.3.3" xref="S3.p4.8.m8.1.1.3.3.cmml">k</mi><mi id="S3.p4.8.m8.1.1.3.2.3" xref="S3.p4.8.m8.1.1.3.2.3.cmml">T</mi></msubsup><mo id="S3.p4.8.m8.1.1.2" xref="S3.p4.8.m8.1.1.2.cmml">=</mo><mrow id="S3.p4.8.m8.1.1.1.1" xref="S3.p4.8.m8.1.1.1.2.cmml"><mo stretchy="false" id="S3.p4.8.m8.1.1.1.1.2" xref="S3.p4.8.m8.1.1.1.2.cmml">{</mo><mrow id="S3.p4.8.m8.1.1.1.1.1.1" xref="S3.p4.8.m8.1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S3.p4.8.m8.1.1.1.1.1.1.2" xref="S3.p4.8.m8.1.1.1.1.1.1.1.cmml">(</mo><msubsup id="S3.p4.8.m8.1.1.1.1.1.1.1" xref="S3.p4.8.m8.1.1.1.1.1.1.1.cmml"><mi id="S3.p4.8.m8.1.1.1.1.1.1.1.2.2" xref="S3.p4.8.m8.1.1.1.1.1.1.1.2.2.cmml">𝐱</mi><mi id="S3.p4.8.m8.1.1.1.1.1.1.1.3" xref="S3.p4.8.m8.1.1.1.1.1.1.1.3.cmml">k</mi><mi id="S3.p4.8.m8.1.1.1.1.1.1.1.2.3" xref="S3.p4.8.m8.1.1.1.1.1.1.1.2.3.cmml">T</mi></msubsup><mo stretchy="false" id="S3.p4.8.m8.1.1.1.1.1.1.3" xref="S3.p4.8.m8.1.1.1.1.1.1.1.cmml">)</mo></mrow><mo stretchy="false" id="S3.p4.8.m8.1.1.1.1.3" xref="S3.p4.8.m8.1.1.1.2.cmml">}</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.p4.8.m8.1b"><apply id="S3.p4.8.m8.1.1.cmml" xref="S3.p4.8.m8.1.1"><eq id="S3.p4.8.m8.1.1.2.cmml" xref="S3.p4.8.m8.1.1.2"></eq><apply id="S3.p4.8.m8.1.1.3.cmml" xref="S3.p4.8.m8.1.1.3"><csymbol cd="ambiguous" id="S3.p4.8.m8.1.1.3.1.cmml" xref="S3.p4.8.m8.1.1.3">subscript</csymbol><apply id="S3.p4.8.m8.1.1.3.2.cmml" xref="S3.p4.8.m8.1.1.3"><csymbol cd="ambiguous" id="S3.p4.8.m8.1.1.3.2.1.cmml" xref="S3.p4.8.m8.1.1.3">superscript</csymbol><ci id="S3.p4.8.m8.1.1.3.2.2.cmml" xref="S3.p4.8.m8.1.1.3.2.2">𝒟</ci><ci id="S3.p4.8.m8.1.1.3.2.3.cmml" xref="S3.p4.8.m8.1.1.3.2.3">𝑇</ci></apply><ci id="S3.p4.8.m8.1.1.3.3.cmml" xref="S3.p4.8.m8.1.1.3.3">𝑘</ci></apply><set id="S3.p4.8.m8.1.1.1.2.cmml" xref="S3.p4.8.m8.1.1.1.1"><apply id="S3.p4.8.m8.1.1.1.1.1.1.1.cmml" xref="S3.p4.8.m8.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.p4.8.m8.1.1.1.1.1.1.1.1.cmml" xref="S3.p4.8.m8.1.1.1.1.1.1">subscript</csymbol><apply id="S3.p4.8.m8.1.1.1.1.1.1.1.2.cmml" xref="S3.p4.8.m8.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.p4.8.m8.1.1.1.1.1.1.1.2.1.cmml" xref="S3.p4.8.m8.1.1.1.1.1.1">superscript</csymbol><ci id="S3.p4.8.m8.1.1.1.1.1.1.1.2.2.cmml" xref="S3.p4.8.m8.1.1.1.1.1.1.1.2.2">𝐱</ci><ci id="S3.p4.8.m8.1.1.1.1.1.1.1.2.3.cmml" xref="S3.p4.8.m8.1.1.1.1.1.1.1.2.3">𝑇</ci></apply><ci id="S3.p4.8.m8.1.1.1.1.1.1.1.3.cmml" xref="S3.p4.8.m8.1.1.1.1.1.1.1.3">𝑘</ci></apply></set></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p4.8.m8.1c">\mathcal{D}^{T}_{k}=\{(\mathbf{x}^{T}_{k})\}</annotation></semantics></math>.
Notably, the number of samples of the drones’ target dataset (<math id="S3.p4.9.m9.1" class="ltx_Math" alttext="N^{T}_{drone}" display="inline"><semantics id="S3.p4.9.m9.1a"><msubsup id="S3.p4.9.m9.1.1" xref="S3.p4.9.m9.1.1.cmml"><mi id="S3.p4.9.m9.1.1.2.2" xref="S3.p4.9.m9.1.1.2.2.cmml">N</mi><mrow id="S3.p4.9.m9.1.1.3" xref="S3.p4.9.m9.1.1.3.cmml"><mi id="S3.p4.9.m9.1.1.3.2" xref="S3.p4.9.m9.1.1.3.2.cmml">d</mi><mo lspace="0em" rspace="0em" id="S3.p4.9.m9.1.1.3.1" xref="S3.p4.9.m9.1.1.3.1.cmml">​</mo><mi id="S3.p4.9.m9.1.1.3.3" xref="S3.p4.9.m9.1.1.3.3.cmml">r</mi><mo lspace="0em" rspace="0em" id="S3.p4.9.m9.1.1.3.1a" xref="S3.p4.9.m9.1.1.3.1.cmml">​</mo><mi id="S3.p4.9.m9.1.1.3.4" xref="S3.p4.9.m9.1.1.3.4.cmml">o</mi><mo lspace="0em" rspace="0em" id="S3.p4.9.m9.1.1.3.1b" xref="S3.p4.9.m9.1.1.3.1.cmml">​</mo><mi id="S3.p4.9.m9.1.1.3.5" xref="S3.p4.9.m9.1.1.3.5.cmml">n</mi><mo lspace="0em" rspace="0em" id="S3.p4.9.m9.1.1.3.1c" xref="S3.p4.9.m9.1.1.3.1.cmml">​</mo><mi id="S3.p4.9.m9.1.1.3.6" xref="S3.p4.9.m9.1.1.3.6.cmml">e</mi></mrow><mi id="S3.p4.9.m9.1.1.2.3" xref="S3.p4.9.m9.1.1.2.3.cmml">T</mi></msubsup><annotation-xml encoding="MathML-Content" id="S3.p4.9.m9.1b"><apply id="S3.p4.9.m9.1.1.cmml" xref="S3.p4.9.m9.1.1"><csymbol cd="ambiguous" id="S3.p4.9.m9.1.1.1.cmml" xref="S3.p4.9.m9.1.1">subscript</csymbol><apply id="S3.p4.9.m9.1.1.2.cmml" xref="S3.p4.9.m9.1.1"><csymbol cd="ambiguous" id="S3.p4.9.m9.1.1.2.1.cmml" xref="S3.p4.9.m9.1.1">superscript</csymbol><ci id="S3.p4.9.m9.1.1.2.2.cmml" xref="S3.p4.9.m9.1.1.2.2">𝑁</ci><ci id="S3.p4.9.m9.1.1.2.3.cmml" xref="S3.p4.9.m9.1.1.2.3">𝑇</ci></apply><apply id="S3.p4.9.m9.1.1.3.cmml" xref="S3.p4.9.m9.1.1.3"><times id="S3.p4.9.m9.1.1.3.1.cmml" xref="S3.p4.9.m9.1.1.3.1"></times><ci id="S3.p4.9.m9.1.1.3.2.cmml" xref="S3.p4.9.m9.1.1.3.2">𝑑</ci><ci id="S3.p4.9.m9.1.1.3.3.cmml" xref="S3.p4.9.m9.1.1.3.3">𝑟</ci><ci id="S3.p4.9.m9.1.1.3.4.cmml" xref="S3.p4.9.m9.1.1.3.4">𝑜</ci><ci id="S3.p4.9.m9.1.1.3.5.cmml" xref="S3.p4.9.m9.1.1.3.5">𝑛</ci><ci id="S3.p4.9.m9.1.1.3.6.cmml" xref="S3.p4.9.m9.1.1.3.6">𝑒</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p4.9.m9.1c">N^{T}_{drone}</annotation></semantics></math>) is typically lower than in the target datasets for cars (<math id="S3.p4.10.m10.1" class="ltx_Math" alttext="N^{T}_{car}" display="inline"><semantics id="S3.p4.10.m10.1a"><msubsup id="S3.p4.10.m10.1.1" xref="S3.p4.10.m10.1.1.cmml"><mi id="S3.p4.10.m10.1.1.2.2" xref="S3.p4.10.m10.1.1.2.2.cmml">N</mi><mrow id="S3.p4.10.m10.1.1.3" xref="S3.p4.10.m10.1.1.3.cmml"><mi id="S3.p4.10.m10.1.1.3.2" xref="S3.p4.10.m10.1.1.3.2.cmml">c</mi><mo lspace="0em" rspace="0em" id="S3.p4.10.m10.1.1.3.1" xref="S3.p4.10.m10.1.1.3.1.cmml">​</mo><mi id="S3.p4.10.m10.1.1.3.3" xref="S3.p4.10.m10.1.1.3.3.cmml">a</mi><mo lspace="0em" rspace="0em" id="S3.p4.10.m10.1.1.3.1a" xref="S3.p4.10.m10.1.1.3.1.cmml">​</mo><mi id="S3.p4.10.m10.1.1.3.4" xref="S3.p4.10.m10.1.1.3.4.cmml">r</mi></mrow><mi id="S3.p4.10.m10.1.1.2.3" xref="S3.p4.10.m10.1.1.2.3.cmml">T</mi></msubsup><annotation-xml encoding="MathML-Content" id="S3.p4.10.m10.1b"><apply id="S3.p4.10.m10.1.1.cmml" xref="S3.p4.10.m10.1.1"><csymbol cd="ambiguous" id="S3.p4.10.m10.1.1.1.cmml" xref="S3.p4.10.m10.1.1">subscript</csymbol><apply id="S3.p4.10.m10.1.1.2.cmml" xref="S3.p4.10.m10.1.1"><csymbol cd="ambiguous" id="S3.p4.10.m10.1.1.2.1.cmml" xref="S3.p4.10.m10.1.1">superscript</csymbol><ci id="S3.p4.10.m10.1.1.2.2.cmml" xref="S3.p4.10.m10.1.1.2.2">𝑁</ci><ci id="S3.p4.10.m10.1.1.2.3.cmml" xref="S3.p4.10.m10.1.1.2.3">𝑇</ci></apply><apply id="S3.p4.10.m10.1.1.3.cmml" xref="S3.p4.10.m10.1.1.3"><times id="S3.p4.10.m10.1.1.3.1.cmml" xref="S3.p4.10.m10.1.1.3.1"></times><ci id="S3.p4.10.m10.1.1.3.2.cmml" xref="S3.p4.10.m10.1.1.3.2">𝑐</ci><ci id="S3.p4.10.m10.1.1.3.3.cmml" xref="S3.p4.10.m10.1.1.3.3">𝑎</ci><ci id="S3.p4.10.m10.1.1.3.4.cmml" xref="S3.p4.10.m10.1.1.3.4">𝑟</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p4.10.m10.1c">N^{T}_{car}</annotation></semantics></math>). Furthermore, the set of semantic classes could differ between car and aerial vehicles datasets (in our case <math id="S3.p4.11.m11.1" class="ltx_Math" alttext="C_{drone}\subset C_{car}=C^{T}=C^{S}" display="inline"><semantics id="S3.p4.11.m11.1a"><mrow id="S3.p4.11.m11.1.1" xref="S3.p4.11.m11.1.1.cmml"><msub id="S3.p4.11.m11.1.1.2" xref="S3.p4.11.m11.1.1.2.cmml"><mi id="S3.p4.11.m11.1.1.2.2" xref="S3.p4.11.m11.1.1.2.2.cmml">C</mi><mrow id="S3.p4.11.m11.1.1.2.3" xref="S3.p4.11.m11.1.1.2.3.cmml"><mi id="S3.p4.11.m11.1.1.2.3.2" xref="S3.p4.11.m11.1.1.2.3.2.cmml">d</mi><mo lspace="0em" rspace="0em" id="S3.p4.11.m11.1.1.2.3.1" xref="S3.p4.11.m11.1.1.2.3.1.cmml">​</mo><mi id="S3.p4.11.m11.1.1.2.3.3" xref="S3.p4.11.m11.1.1.2.3.3.cmml">r</mi><mo lspace="0em" rspace="0em" id="S3.p4.11.m11.1.1.2.3.1a" xref="S3.p4.11.m11.1.1.2.3.1.cmml">​</mo><mi id="S3.p4.11.m11.1.1.2.3.4" xref="S3.p4.11.m11.1.1.2.3.4.cmml">o</mi><mo lspace="0em" rspace="0em" id="S3.p4.11.m11.1.1.2.3.1b" xref="S3.p4.11.m11.1.1.2.3.1.cmml">​</mo><mi id="S3.p4.11.m11.1.1.2.3.5" xref="S3.p4.11.m11.1.1.2.3.5.cmml">n</mi><mo lspace="0em" rspace="0em" id="S3.p4.11.m11.1.1.2.3.1c" xref="S3.p4.11.m11.1.1.2.3.1.cmml">​</mo><mi id="S3.p4.11.m11.1.1.2.3.6" xref="S3.p4.11.m11.1.1.2.3.6.cmml">e</mi></mrow></msub><mo id="S3.p4.11.m11.1.1.3" xref="S3.p4.11.m11.1.1.3.cmml">⊂</mo><msub id="S3.p4.11.m11.1.1.4" xref="S3.p4.11.m11.1.1.4.cmml"><mi id="S3.p4.11.m11.1.1.4.2" xref="S3.p4.11.m11.1.1.4.2.cmml">C</mi><mrow id="S3.p4.11.m11.1.1.4.3" xref="S3.p4.11.m11.1.1.4.3.cmml"><mi id="S3.p4.11.m11.1.1.4.3.2" xref="S3.p4.11.m11.1.1.4.3.2.cmml">c</mi><mo lspace="0em" rspace="0em" id="S3.p4.11.m11.1.1.4.3.1" xref="S3.p4.11.m11.1.1.4.3.1.cmml">​</mo><mi id="S3.p4.11.m11.1.1.4.3.3" xref="S3.p4.11.m11.1.1.4.3.3.cmml">a</mi><mo lspace="0em" rspace="0em" id="S3.p4.11.m11.1.1.4.3.1a" xref="S3.p4.11.m11.1.1.4.3.1.cmml">​</mo><mi id="S3.p4.11.m11.1.1.4.3.4" xref="S3.p4.11.m11.1.1.4.3.4.cmml">r</mi></mrow></msub><mo id="S3.p4.11.m11.1.1.5" xref="S3.p4.11.m11.1.1.5.cmml">=</mo><msup id="S3.p4.11.m11.1.1.6" xref="S3.p4.11.m11.1.1.6.cmml"><mi id="S3.p4.11.m11.1.1.6.2" xref="S3.p4.11.m11.1.1.6.2.cmml">C</mi><mi id="S3.p4.11.m11.1.1.6.3" xref="S3.p4.11.m11.1.1.6.3.cmml">T</mi></msup><mo id="S3.p4.11.m11.1.1.7" xref="S3.p4.11.m11.1.1.7.cmml">=</mo><msup id="S3.p4.11.m11.1.1.8" xref="S3.p4.11.m11.1.1.8.cmml"><mi id="S3.p4.11.m11.1.1.8.2" xref="S3.p4.11.m11.1.1.8.2.cmml">C</mi><mi id="S3.p4.11.m11.1.1.8.3" xref="S3.p4.11.m11.1.1.8.3.cmml">S</mi></msup></mrow><annotation-xml encoding="MathML-Content" id="S3.p4.11.m11.1b"><apply id="S3.p4.11.m11.1.1.cmml" xref="S3.p4.11.m11.1.1"><and id="S3.p4.11.m11.1.1a.cmml" xref="S3.p4.11.m11.1.1"></and><apply id="S3.p4.11.m11.1.1b.cmml" xref="S3.p4.11.m11.1.1"><subset id="S3.p4.11.m11.1.1.3.cmml" xref="S3.p4.11.m11.1.1.3"></subset><apply id="S3.p4.11.m11.1.1.2.cmml" xref="S3.p4.11.m11.1.1.2"><csymbol cd="ambiguous" id="S3.p4.11.m11.1.1.2.1.cmml" xref="S3.p4.11.m11.1.1.2">subscript</csymbol><ci id="S3.p4.11.m11.1.1.2.2.cmml" xref="S3.p4.11.m11.1.1.2.2">𝐶</ci><apply id="S3.p4.11.m11.1.1.2.3.cmml" xref="S3.p4.11.m11.1.1.2.3"><times id="S3.p4.11.m11.1.1.2.3.1.cmml" xref="S3.p4.11.m11.1.1.2.3.1"></times><ci id="S3.p4.11.m11.1.1.2.3.2.cmml" xref="S3.p4.11.m11.1.1.2.3.2">𝑑</ci><ci id="S3.p4.11.m11.1.1.2.3.3.cmml" xref="S3.p4.11.m11.1.1.2.3.3">𝑟</ci><ci id="S3.p4.11.m11.1.1.2.3.4.cmml" xref="S3.p4.11.m11.1.1.2.3.4">𝑜</ci><ci id="S3.p4.11.m11.1.1.2.3.5.cmml" xref="S3.p4.11.m11.1.1.2.3.5">𝑛</ci><ci id="S3.p4.11.m11.1.1.2.3.6.cmml" xref="S3.p4.11.m11.1.1.2.3.6">𝑒</ci></apply></apply><apply id="S3.p4.11.m11.1.1.4.cmml" xref="S3.p4.11.m11.1.1.4"><csymbol cd="ambiguous" id="S3.p4.11.m11.1.1.4.1.cmml" xref="S3.p4.11.m11.1.1.4">subscript</csymbol><ci id="S3.p4.11.m11.1.1.4.2.cmml" xref="S3.p4.11.m11.1.1.4.2">𝐶</ci><apply id="S3.p4.11.m11.1.1.4.3.cmml" xref="S3.p4.11.m11.1.1.4.3"><times id="S3.p4.11.m11.1.1.4.3.1.cmml" xref="S3.p4.11.m11.1.1.4.3.1"></times><ci id="S3.p4.11.m11.1.1.4.3.2.cmml" xref="S3.p4.11.m11.1.1.4.3.2">𝑐</ci><ci id="S3.p4.11.m11.1.1.4.3.3.cmml" xref="S3.p4.11.m11.1.1.4.3.3">𝑎</ci><ci id="S3.p4.11.m11.1.1.4.3.4.cmml" xref="S3.p4.11.m11.1.1.4.3.4">𝑟</ci></apply></apply></apply><apply id="S3.p4.11.m11.1.1c.cmml" xref="S3.p4.11.m11.1.1"><eq id="S3.p4.11.m11.1.1.5.cmml" xref="S3.p4.11.m11.1.1.5"></eq><share href="#S3.p4.11.m11.1.1.4.cmml" id="S3.p4.11.m11.1.1d.cmml" xref="S3.p4.11.m11.1.1"></share><apply id="S3.p4.11.m11.1.1.6.cmml" xref="S3.p4.11.m11.1.1.6"><csymbol cd="ambiguous" id="S3.p4.11.m11.1.1.6.1.cmml" xref="S3.p4.11.m11.1.1.6">superscript</csymbol><ci id="S3.p4.11.m11.1.1.6.2.cmml" xref="S3.p4.11.m11.1.1.6.2">𝐶</ci><ci id="S3.p4.11.m11.1.1.6.3.cmml" xref="S3.p4.11.m11.1.1.6.3">𝑇</ci></apply></apply><apply id="S3.p4.11.m11.1.1e.cmml" xref="S3.p4.11.m11.1.1"><eq id="S3.p4.11.m11.1.1.7.cmml" xref="S3.p4.11.m11.1.1.7"></eq><share href="#S3.p4.11.m11.1.1.6.cmml" id="S3.p4.11.m11.1.1f.cmml" xref="S3.p4.11.m11.1.1"></share><apply id="S3.p4.11.m11.1.1.8.cmml" xref="S3.p4.11.m11.1.1.8"><csymbol cd="ambiguous" id="S3.p4.11.m11.1.1.8.1.cmml" xref="S3.p4.11.m11.1.1.8">superscript</csymbol><ci id="S3.p4.11.m11.1.1.8.2.cmml" xref="S3.p4.11.m11.1.1.8.2">𝐶</ci><ci id="S3.p4.11.m11.1.1.8.3.cmml" xref="S3.p4.11.m11.1.1.8.3">𝑆</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p4.11.m11.1c">C_{drone}\subset C_{car}=C^{T}=C^{S}</annotation></semantics></math>).
The identity of each client is fixed, meaning it is designated as either a car or a drone and does not change during training, however, there is no such limitation on the weather conditions, which can change dynamically during the training process. The goal is to minimize the objective function of <a href="#S3.E1" title="In 3 Problem Formulation ‣ When Cars meet Drones: Hyperbolic Federated Learning for Source-Free Domain Adaptation in Adverse Weather" class="ltx_ref"><span class="ltx_text ltx_ref_tag">Eq.</span> <span class="ltx_text ltx_ref_tag">1</span></a>, where the target data distribution holds into its heterogeneity different viewpoints and weathers.
In <a href="#S4.F2" title="In 4 Training Procedure ‣ When Cars meet Drones: Hyperbolic Federated Learning for Source-Free Domain Adaptation in Adverse Weather" class="ltx_ref"><span class="ltx_text ltx_ref_tag">Fig.</span> <span class="ltx_text ltx_ref_tag">2</span></a> we present our approach, which will be detailed in <a href="#S4" title="4 Training Procedure ‣ When Cars meet Drones: Hyperbolic Federated Learning for Source-Free Domain Adaptation in Adverse Weather" class="ltx_ref"><span class="ltx_text ltx_ref_tag">Sec.</span> <span class="ltx_text ltx_ref_tag">4</span></a>.</p>
</div>
</section>
<section id="S4" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">4 </span>Training Procedure</h2>

<div id="S4.p1" class="ltx_para">
<p id="S4.p1.20" class="ltx_p">The training is organized in a set of rounds <math id="S4.p1.1.m1.3" class="ltx_Math" alttext="r=0,\ldots,R" display="inline"><semantics id="S4.p1.1.m1.3a"><mrow id="S4.p1.1.m1.3.4" xref="S4.p1.1.m1.3.4.cmml"><mi id="S4.p1.1.m1.3.4.2" xref="S4.p1.1.m1.3.4.2.cmml">r</mi><mo id="S4.p1.1.m1.3.4.1" xref="S4.p1.1.m1.3.4.1.cmml">=</mo><mrow id="S4.p1.1.m1.3.4.3.2" xref="S4.p1.1.m1.3.4.3.1.cmml"><mn id="S4.p1.1.m1.1.1" xref="S4.p1.1.m1.1.1.cmml">0</mn><mo id="S4.p1.1.m1.3.4.3.2.1" xref="S4.p1.1.m1.3.4.3.1.cmml">,</mo><mi mathvariant="normal" id="S4.p1.1.m1.2.2" xref="S4.p1.1.m1.2.2.cmml">…</mi><mo id="S4.p1.1.m1.3.4.3.2.2" xref="S4.p1.1.m1.3.4.3.1.cmml">,</mo><mi id="S4.p1.1.m1.3.3" xref="S4.p1.1.m1.3.3.cmml">R</mi></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.p1.1.m1.3b"><apply id="S4.p1.1.m1.3.4.cmml" xref="S4.p1.1.m1.3.4"><eq id="S4.p1.1.m1.3.4.1.cmml" xref="S4.p1.1.m1.3.4.1"></eq><ci id="S4.p1.1.m1.3.4.2.cmml" xref="S4.p1.1.m1.3.4.2">𝑟</ci><list id="S4.p1.1.m1.3.4.3.1.cmml" xref="S4.p1.1.m1.3.4.3.2"><cn type="integer" id="S4.p1.1.m1.1.1.cmml" xref="S4.p1.1.m1.1.1">0</cn><ci id="S4.p1.1.m1.2.2.cmml" xref="S4.p1.1.m1.2.2">…</ci><ci id="S4.p1.1.m1.3.3.cmml" xref="S4.p1.1.m1.3.3">𝑅</ci></list></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.p1.1.m1.3c">r=0,\ldots,R</annotation></semantics></math>, where <math id="S4.p1.2.m2.1" class="ltx_Math" alttext="r=0" display="inline"><semantics id="S4.p1.2.m2.1a"><mrow id="S4.p1.2.m2.1.1" xref="S4.p1.2.m2.1.1.cmml"><mi id="S4.p1.2.m2.1.1.2" xref="S4.p1.2.m2.1.1.2.cmml">r</mi><mo id="S4.p1.2.m2.1.1.1" xref="S4.p1.2.m2.1.1.1.cmml">=</mo><mn id="S4.p1.2.m2.1.1.3" xref="S4.p1.2.m2.1.1.3.cmml">0</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.p1.2.m2.1b"><apply id="S4.p1.2.m2.1.1.cmml" xref="S4.p1.2.m2.1.1"><eq id="S4.p1.2.m2.1.1.1.cmml" xref="S4.p1.2.m2.1.1.1"></eq><ci id="S4.p1.2.m2.1.1.2.cmml" xref="S4.p1.2.m2.1.1.2">𝑟</ci><cn type="integer" id="S4.p1.2.m2.1.1.3.cmml" xref="S4.p1.2.m2.1.1.3">0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.p1.2.m2.1c">r=0</annotation></semantics></math> corresponds to the pretraining phase. At each round <math id="S4.p1.3.m3.1" class="ltx_Math" alttext="r" display="inline"><semantics id="S4.p1.3.m3.1a"><mi id="S4.p1.3.m3.1.1" xref="S4.p1.3.m3.1.1.cmml">r</mi><annotation-xml encoding="MathML-Content" id="S4.p1.3.m3.1b"><ci id="S4.p1.3.m3.1.1.cmml" xref="S4.p1.3.m3.1.1">𝑟</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.p1.3.m3.1c">r</annotation></semantics></math>, we denote by <math id="S4.p1.4.m4.1" class="ltx_Math" alttext="M^{r}_{G}" display="inline"><semantics id="S4.p1.4.m4.1a"><msubsup id="S4.p1.4.m4.1.1" xref="S4.p1.4.m4.1.1.cmml"><mi id="S4.p1.4.m4.1.1.2.2" xref="S4.p1.4.m4.1.1.2.2.cmml">M</mi><mi id="S4.p1.4.m4.1.1.3" xref="S4.p1.4.m4.1.1.3.cmml">G</mi><mi id="S4.p1.4.m4.1.1.2.3" xref="S4.p1.4.m4.1.1.2.3.cmml">r</mi></msubsup><annotation-xml encoding="MathML-Content" id="S4.p1.4.m4.1b"><apply id="S4.p1.4.m4.1.1.cmml" xref="S4.p1.4.m4.1.1"><csymbol cd="ambiguous" id="S4.p1.4.m4.1.1.1.cmml" xref="S4.p1.4.m4.1.1">subscript</csymbol><apply id="S4.p1.4.m4.1.1.2.cmml" xref="S4.p1.4.m4.1.1"><csymbol cd="ambiguous" id="S4.p1.4.m4.1.1.2.1.cmml" xref="S4.p1.4.m4.1.1">superscript</csymbol><ci id="S4.p1.4.m4.1.1.2.2.cmml" xref="S4.p1.4.m4.1.1.2.2">𝑀</ci><ci id="S4.p1.4.m4.1.1.2.3.cmml" xref="S4.p1.4.m4.1.1.2.3">𝑟</ci></apply><ci id="S4.p1.4.m4.1.1.3.cmml" xref="S4.p1.4.m4.1.1.3">𝐺</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.p1.4.m4.1c">M^{r}_{G}</annotation></semantics></math> the global model at the server side, while we refer to <math id="S4.p1.5.m5.1" class="ltx_Math" alttext="M^{r}_{k}" display="inline"><semantics id="S4.p1.5.m5.1a"><msubsup id="S4.p1.5.m5.1.1" xref="S4.p1.5.m5.1.1.cmml"><mi id="S4.p1.5.m5.1.1.2.2" xref="S4.p1.5.m5.1.1.2.2.cmml">M</mi><mi id="S4.p1.5.m5.1.1.3" xref="S4.p1.5.m5.1.1.3.cmml">k</mi><mi id="S4.p1.5.m5.1.1.2.3" xref="S4.p1.5.m5.1.1.2.3.cmml">r</mi></msubsup><annotation-xml encoding="MathML-Content" id="S4.p1.5.m5.1b"><apply id="S4.p1.5.m5.1.1.cmml" xref="S4.p1.5.m5.1.1"><csymbol cd="ambiguous" id="S4.p1.5.m5.1.1.1.cmml" xref="S4.p1.5.m5.1.1">subscript</csymbol><apply id="S4.p1.5.m5.1.1.2.cmml" xref="S4.p1.5.m5.1.1"><csymbol cd="ambiguous" id="S4.p1.5.m5.1.1.2.1.cmml" xref="S4.p1.5.m5.1.1">superscript</csymbol><ci id="S4.p1.5.m5.1.1.2.2.cmml" xref="S4.p1.5.m5.1.1.2.2">𝑀</ci><ci id="S4.p1.5.m5.1.1.2.3.cmml" xref="S4.p1.5.m5.1.1.2.3">𝑟</ci></apply><ci id="S4.p1.5.m5.1.1.3.cmml" xref="S4.p1.5.m5.1.1.3">𝑘</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.p1.5.m5.1c">M^{r}_{k}</annotation></semantics></math> as the model of the <math id="S4.p1.6.m6.1" class="ltx_Math" alttext="k-th" display="inline"><semantics id="S4.p1.6.m6.1a"><mrow id="S4.p1.6.m6.1.1" xref="S4.p1.6.m6.1.1.cmml"><mi id="S4.p1.6.m6.1.1.2" xref="S4.p1.6.m6.1.1.2.cmml">k</mi><mo id="S4.p1.6.m6.1.1.1" xref="S4.p1.6.m6.1.1.1.cmml">−</mo><mrow id="S4.p1.6.m6.1.1.3" xref="S4.p1.6.m6.1.1.3.cmml"><mi id="S4.p1.6.m6.1.1.3.2" xref="S4.p1.6.m6.1.1.3.2.cmml">t</mi><mo lspace="0em" rspace="0em" id="S4.p1.6.m6.1.1.3.1" xref="S4.p1.6.m6.1.1.3.1.cmml">​</mo><mi id="S4.p1.6.m6.1.1.3.3" xref="S4.p1.6.m6.1.1.3.3.cmml">h</mi></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.p1.6.m6.1b"><apply id="S4.p1.6.m6.1.1.cmml" xref="S4.p1.6.m6.1.1"><minus id="S4.p1.6.m6.1.1.1.cmml" xref="S4.p1.6.m6.1.1.1"></minus><ci id="S4.p1.6.m6.1.1.2.cmml" xref="S4.p1.6.m6.1.1.2">𝑘</ci><apply id="S4.p1.6.m6.1.1.3.cmml" xref="S4.p1.6.m6.1.1.3"><times id="S4.p1.6.m6.1.1.3.1.cmml" xref="S4.p1.6.m6.1.1.3.1"></times><ci id="S4.p1.6.m6.1.1.3.2.cmml" xref="S4.p1.6.m6.1.1.3.2">𝑡</ci><ci id="S4.p1.6.m6.1.1.3.3.cmml" xref="S4.p1.6.m6.1.1.3.3">ℎ</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.p1.6.m6.1c">k-th</annotation></semantics></math> client.
<br class="ltx_break"><span id="S4.p1.20.1" class="ltx_text ltx_font_bold">Pretraining.</span> We train the initial model <math id="S4.p1.7.m7.1" class="ltx_Math" alttext="M^{0}_{G}" display="inline"><semantics id="S4.p1.7.m7.1a"><msubsup id="S4.p1.7.m7.1.1" xref="S4.p1.7.m7.1.1.cmml"><mi id="S4.p1.7.m7.1.1.2.2" xref="S4.p1.7.m7.1.1.2.2.cmml">M</mi><mi id="S4.p1.7.m7.1.1.3" xref="S4.p1.7.m7.1.1.3.cmml">G</mi><mn id="S4.p1.7.m7.1.1.2.3" xref="S4.p1.7.m7.1.1.2.3.cmml">0</mn></msubsup><annotation-xml encoding="MathML-Content" id="S4.p1.7.m7.1b"><apply id="S4.p1.7.m7.1.1.cmml" xref="S4.p1.7.m7.1.1"><csymbol cd="ambiguous" id="S4.p1.7.m7.1.1.1.cmml" xref="S4.p1.7.m7.1.1">subscript</csymbol><apply id="S4.p1.7.m7.1.1.2.cmml" xref="S4.p1.7.m7.1.1"><csymbol cd="ambiguous" id="S4.p1.7.m7.1.1.2.1.cmml" xref="S4.p1.7.m7.1.1">superscript</csymbol><ci id="S4.p1.7.m7.1.1.2.2.cmml" xref="S4.p1.7.m7.1.1.2.2">𝑀</ci><cn type="integer" id="S4.p1.7.m7.1.1.2.3.cmml" xref="S4.p1.7.m7.1.1.2.3">0</cn></apply><ci id="S4.p1.7.m7.1.1.3.cmml" xref="S4.p1.7.m7.1.1.3">𝐺</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.p1.7.m7.1c">M^{0}_{G}</annotation></semantics></math> on a large-scale source synthetic dataset <math id="S4.p1.8.m8.1" class="ltx_Math" alttext="\mathcal{D}^{S}" display="inline"><semantics id="S4.p1.8.m8.1a"><msup id="S4.p1.8.m8.1.1" xref="S4.p1.8.m8.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.p1.8.m8.1.1.2" xref="S4.p1.8.m8.1.1.2.cmml">𝒟</mi><mi id="S4.p1.8.m8.1.1.3" xref="S4.p1.8.m8.1.1.3.cmml">S</mi></msup><annotation-xml encoding="MathML-Content" id="S4.p1.8.m8.1b"><apply id="S4.p1.8.m8.1.1.cmml" xref="S4.p1.8.m8.1.1"><csymbol cd="ambiguous" id="S4.p1.8.m8.1.1.1.cmml" xref="S4.p1.8.m8.1.1">superscript</csymbol><ci id="S4.p1.8.m8.1.1.2.cmml" xref="S4.p1.8.m8.1.1.2">𝒟</ci><ci id="S4.p1.8.m8.1.1.3.cmml" xref="S4.p1.8.m8.1.1.3">𝑆</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.p1.8.m8.1c">\mathcal{D}^{S}</annotation></semantics></math>, taking advantage of the server’s computing capabilities. By sampling batches of cross-agent we maximize the standard cross entropy loss <math id="S4.p1.9.m9.2" class="ltx_Math" alttext="\mathcal{L}(y^{S},M_{G}^{0}(x^{S}))" display="inline"><semantics id="S4.p1.9.m9.2a"><mrow id="S4.p1.9.m9.2.2" xref="S4.p1.9.m9.2.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.p1.9.m9.2.2.4" xref="S4.p1.9.m9.2.2.4.cmml">ℒ</mi><mo lspace="0em" rspace="0em" id="S4.p1.9.m9.2.2.3" xref="S4.p1.9.m9.2.2.3.cmml">​</mo><mrow id="S4.p1.9.m9.2.2.2.2" xref="S4.p1.9.m9.2.2.2.3.cmml"><mo stretchy="false" id="S4.p1.9.m9.2.2.2.2.3" xref="S4.p1.9.m9.2.2.2.3.cmml">(</mo><msup id="S4.p1.9.m9.1.1.1.1.1" xref="S4.p1.9.m9.1.1.1.1.1.cmml"><mi id="S4.p1.9.m9.1.1.1.1.1.2" xref="S4.p1.9.m9.1.1.1.1.1.2.cmml">y</mi><mi id="S4.p1.9.m9.1.1.1.1.1.3" xref="S4.p1.9.m9.1.1.1.1.1.3.cmml">S</mi></msup><mo id="S4.p1.9.m9.2.2.2.2.4" xref="S4.p1.9.m9.2.2.2.3.cmml">,</mo><mrow id="S4.p1.9.m9.2.2.2.2.2" xref="S4.p1.9.m9.2.2.2.2.2.cmml"><msubsup id="S4.p1.9.m9.2.2.2.2.2.3" xref="S4.p1.9.m9.2.2.2.2.2.3.cmml"><mi id="S4.p1.9.m9.2.2.2.2.2.3.2.2" xref="S4.p1.9.m9.2.2.2.2.2.3.2.2.cmml">M</mi><mi id="S4.p1.9.m9.2.2.2.2.2.3.2.3" xref="S4.p1.9.m9.2.2.2.2.2.3.2.3.cmml">G</mi><mn id="S4.p1.9.m9.2.2.2.2.2.3.3" xref="S4.p1.9.m9.2.2.2.2.2.3.3.cmml">0</mn></msubsup><mo lspace="0em" rspace="0em" id="S4.p1.9.m9.2.2.2.2.2.2" xref="S4.p1.9.m9.2.2.2.2.2.2.cmml">​</mo><mrow id="S4.p1.9.m9.2.2.2.2.2.1.1" xref="S4.p1.9.m9.2.2.2.2.2.1.1.1.cmml"><mo stretchy="false" id="S4.p1.9.m9.2.2.2.2.2.1.1.2" xref="S4.p1.9.m9.2.2.2.2.2.1.1.1.cmml">(</mo><msup id="S4.p1.9.m9.2.2.2.2.2.1.1.1" xref="S4.p1.9.m9.2.2.2.2.2.1.1.1.cmml"><mi id="S4.p1.9.m9.2.2.2.2.2.1.1.1.2" xref="S4.p1.9.m9.2.2.2.2.2.1.1.1.2.cmml">x</mi><mi id="S4.p1.9.m9.2.2.2.2.2.1.1.1.3" xref="S4.p1.9.m9.2.2.2.2.2.1.1.1.3.cmml">S</mi></msup><mo stretchy="false" id="S4.p1.9.m9.2.2.2.2.2.1.1.3" xref="S4.p1.9.m9.2.2.2.2.2.1.1.1.cmml">)</mo></mrow></mrow><mo stretchy="false" id="S4.p1.9.m9.2.2.2.2.5" xref="S4.p1.9.m9.2.2.2.3.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.p1.9.m9.2b"><apply id="S4.p1.9.m9.2.2.cmml" xref="S4.p1.9.m9.2.2"><times id="S4.p1.9.m9.2.2.3.cmml" xref="S4.p1.9.m9.2.2.3"></times><ci id="S4.p1.9.m9.2.2.4.cmml" xref="S4.p1.9.m9.2.2.4">ℒ</ci><interval closure="open" id="S4.p1.9.m9.2.2.2.3.cmml" xref="S4.p1.9.m9.2.2.2.2"><apply id="S4.p1.9.m9.1.1.1.1.1.cmml" xref="S4.p1.9.m9.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.p1.9.m9.1.1.1.1.1.1.cmml" xref="S4.p1.9.m9.1.1.1.1.1">superscript</csymbol><ci id="S4.p1.9.m9.1.1.1.1.1.2.cmml" xref="S4.p1.9.m9.1.1.1.1.1.2">𝑦</ci><ci id="S4.p1.9.m9.1.1.1.1.1.3.cmml" xref="S4.p1.9.m9.1.1.1.1.1.3">𝑆</ci></apply><apply id="S4.p1.9.m9.2.2.2.2.2.cmml" xref="S4.p1.9.m9.2.2.2.2.2"><times id="S4.p1.9.m9.2.2.2.2.2.2.cmml" xref="S4.p1.9.m9.2.2.2.2.2.2"></times><apply id="S4.p1.9.m9.2.2.2.2.2.3.cmml" xref="S4.p1.9.m9.2.2.2.2.2.3"><csymbol cd="ambiguous" id="S4.p1.9.m9.2.2.2.2.2.3.1.cmml" xref="S4.p1.9.m9.2.2.2.2.2.3">superscript</csymbol><apply id="S4.p1.9.m9.2.2.2.2.2.3.2.cmml" xref="S4.p1.9.m9.2.2.2.2.2.3"><csymbol cd="ambiguous" id="S4.p1.9.m9.2.2.2.2.2.3.2.1.cmml" xref="S4.p1.9.m9.2.2.2.2.2.3">subscript</csymbol><ci id="S4.p1.9.m9.2.2.2.2.2.3.2.2.cmml" xref="S4.p1.9.m9.2.2.2.2.2.3.2.2">𝑀</ci><ci id="S4.p1.9.m9.2.2.2.2.2.3.2.3.cmml" xref="S4.p1.9.m9.2.2.2.2.2.3.2.3">𝐺</ci></apply><cn type="integer" id="S4.p1.9.m9.2.2.2.2.2.3.3.cmml" xref="S4.p1.9.m9.2.2.2.2.2.3.3">0</cn></apply><apply id="S4.p1.9.m9.2.2.2.2.2.1.1.1.cmml" xref="S4.p1.9.m9.2.2.2.2.2.1.1"><csymbol cd="ambiguous" id="S4.p1.9.m9.2.2.2.2.2.1.1.1.1.cmml" xref="S4.p1.9.m9.2.2.2.2.2.1.1">superscript</csymbol><ci id="S4.p1.9.m9.2.2.2.2.2.1.1.1.2.cmml" xref="S4.p1.9.m9.2.2.2.2.2.1.1.1.2">𝑥</ci><ci id="S4.p1.9.m9.2.2.2.2.2.1.1.1.3.cmml" xref="S4.p1.9.m9.2.2.2.2.2.1.1.1.3">𝑆</ci></apply></apply></interval></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.p1.9.m9.2c">\mathcal{L}(y^{S},M_{G}^{0}(x^{S}))</annotation></semantics></math>. Moreover, an additional component <math id="S4.p1.10.m10.1" class="ltx_Math" alttext="M_{W}" display="inline"><semantics id="S4.p1.10.m10.1a"><msub id="S4.p1.10.m10.1.1" xref="S4.p1.10.m10.1.1.cmml"><mi id="S4.p1.10.m10.1.1.2" xref="S4.p1.10.m10.1.1.2.cmml">M</mi><mi id="S4.p1.10.m10.1.1.3" xref="S4.p1.10.m10.1.1.3.cmml">W</mi></msub><annotation-xml encoding="MathML-Content" id="S4.p1.10.m10.1b"><apply id="S4.p1.10.m10.1.1.cmml" xref="S4.p1.10.m10.1.1"><csymbol cd="ambiguous" id="S4.p1.10.m10.1.1.1.cmml" xref="S4.p1.10.m10.1.1">subscript</csymbol><ci id="S4.p1.10.m10.1.1.2.cmml" xref="S4.p1.10.m10.1.1.2">𝑀</ci><ci id="S4.p1.10.m10.1.1.3.cmml" xref="S4.p1.10.m10.1.1.3">𝑊</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.p1.10.m10.1c">M_{W}</annotation></semantics></math> consisting of 3 convolutional layers is trained to recognize weather conditions by optimizing <math id="S4.p1.11.m11.2" class="ltx_Math" alttext="\mathcal{L}(w^{S},M_{W}(x^{S}))" display="inline"><semantics id="S4.p1.11.m11.2a"><mrow id="S4.p1.11.m11.2.2" xref="S4.p1.11.m11.2.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.p1.11.m11.2.2.4" xref="S4.p1.11.m11.2.2.4.cmml">ℒ</mi><mo lspace="0em" rspace="0em" id="S4.p1.11.m11.2.2.3" xref="S4.p1.11.m11.2.2.3.cmml">​</mo><mrow id="S4.p1.11.m11.2.2.2.2" xref="S4.p1.11.m11.2.2.2.3.cmml"><mo stretchy="false" id="S4.p1.11.m11.2.2.2.2.3" xref="S4.p1.11.m11.2.2.2.3.cmml">(</mo><msup id="S4.p1.11.m11.1.1.1.1.1" xref="S4.p1.11.m11.1.1.1.1.1.cmml"><mi id="S4.p1.11.m11.1.1.1.1.1.2" xref="S4.p1.11.m11.1.1.1.1.1.2.cmml">w</mi><mi id="S4.p1.11.m11.1.1.1.1.1.3" xref="S4.p1.11.m11.1.1.1.1.1.3.cmml">S</mi></msup><mo id="S4.p1.11.m11.2.2.2.2.4" xref="S4.p1.11.m11.2.2.2.3.cmml">,</mo><mrow id="S4.p1.11.m11.2.2.2.2.2" xref="S4.p1.11.m11.2.2.2.2.2.cmml"><msub id="S4.p1.11.m11.2.2.2.2.2.3" xref="S4.p1.11.m11.2.2.2.2.2.3.cmml"><mi id="S4.p1.11.m11.2.2.2.2.2.3.2" xref="S4.p1.11.m11.2.2.2.2.2.3.2.cmml">M</mi><mi id="S4.p1.11.m11.2.2.2.2.2.3.3" xref="S4.p1.11.m11.2.2.2.2.2.3.3.cmml">W</mi></msub><mo lspace="0em" rspace="0em" id="S4.p1.11.m11.2.2.2.2.2.2" xref="S4.p1.11.m11.2.2.2.2.2.2.cmml">​</mo><mrow id="S4.p1.11.m11.2.2.2.2.2.1.1" xref="S4.p1.11.m11.2.2.2.2.2.1.1.1.cmml"><mo stretchy="false" id="S4.p1.11.m11.2.2.2.2.2.1.1.2" xref="S4.p1.11.m11.2.2.2.2.2.1.1.1.cmml">(</mo><msup id="S4.p1.11.m11.2.2.2.2.2.1.1.1" xref="S4.p1.11.m11.2.2.2.2.2.1.1.1.cmml"><mi id="S4.p1.11.m11.2.2.2.2.2.1.1.1.2" xref="S4.p1.11.m11.2.2.2.2.2.1.1.1.2.cmml">x</mi><mi id="S4.p1.11.m11.2.2.2.2.2.1.1.1.3" xref="S4.p1.11.m11.2.2.2.2.2.1.1.1.3.cmml">S</mi></msup><mo stretchy="false" id="S4.p1.11.m11.2.2.2.2.2.1.1.3" xref="S4.p1.11.m11.2.2.2.2.2.1.1.1.cmml">)</mo></mrow></mrow><mo stretchy="false" id="S4.p1.11.m11.2.2.2.2.5" xref="S4.p1.11.m11.2.2.2.3.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.p1.11.m11.2b"><apply id="S4.p1.11.m11.2.2.cmml" xref="S4.p1.11.m11.2.2"><times id="S4.p1.11.m11.2.2.3.cmml" xref="S4.p1.11.m11.2.2.3"></times><ci id="S4.p1.11.m11.2.2.4.cmml" xref="S4.p1.11.m11.2.2.4">ℒ</ci><interval closure="open" id="S4.p1.11.m11.2.2.2.3.cmml" xref="S4.p1.11.m11.2.2.2.2"><apply id="S4.p1.11.m11.1.1.1.1.1.cmml" xref="S4.p1.11.m11.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.p1.11.m11.1.1.1.1.1.1.cmml" xref="S4.p1.11.m11.1.1.1.1.1">superscript</csymbol><ci id="S4.p1.11.m11.1.1.1.1.1.2.cmml" xref="S4.p1.11.m11.1.1.1.1.1.2">𝑤</ci><ci id="S4.p1.11.m11.1.1.1.1.1.3.cmml" xref="S4.p1.11.m11.1.1.1.1.1.3">𝑆</ci></apply><apply id="S4.p1.11.m11.2.2.2.2.2.cmml" xref="S4.p1.11.m11.2.2.2.2.2"><times id="S4.p1.11.m11.2.2.2.2.2.2.cmml" xref="S4.p1.11.m11.2.2.2.2.2.2"></times><apply id="S4.p1.11.m11.2.2.2.2.2.3.cmml" xref="S4.p1.11.m11.2.2.2.2.2.3"><csymbol cd="ambiguous" id="S4.p1.11.m11.2.2.2.2.2.3.1.cmml" xref="S4.p1.11.m11.2.2.2.2.2.3">subscript</csymbol><ci id="S4.p1.11.m11.2.2.2.2.2.3.2.cmml" xref="S4.p1.11.m11.2.2.2.2.2.3.2">𝑀</ci><ci id="S4.p1.11.m11.2.2.2.2.2.3.3.cmml" xref="S4.p1.11.m11.2.2.2.2.2.3.3">𝑊</ci></apply><apply id="S4.p1.11.m11.2.2.2.2.2.1.1.1.cmml" xref="S4.p1.11.m11.2.2.2.2.2.1.1"><csymbol cd="ambiguous" id="S4.p1.11.m11.2.2.2.2.2.1.1.1.1.cmml" xref="S4.p1.11.m11.2.2.2.2.2.1.1">superscript</csymbol><ci id="S4.p1.11.m11.2.2.2.2.2.1.1.1.2.cmml" xref="S4.p1.11.m11.2.2.2.2.2.1.1.1.2">𝑥</ci><ci id="S4.p1.11.m11.2.2.2.2.2.1.1.1.3.cmml" xref="S4.p1.11.m11.2.2.2.2.2.1.1.1.3">𝑆</ci></apply></apply></interval></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.p1.11.m11.2c">\mathcal{L}(w^{S},M_{W}(x^{S}))</annotation></semantics></math>. This classifier is a lightweight module intended to provide weather information for clients and it is not trained after this phase.
Differently from <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib37" title="" class="ltx_ref">37</a>]</cite>, we do not assume to have information on the clients’ distribution (i.e., in <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib37" title="" class="ltx_ref">37</a>]</cite> the average Fourier domain coefficients from <math id="S4.p1.12.m12.1" class="ltx_Math" alttext="\mathcal{D}^{T}" display="inline"><semantics id="S4.p1.12.m12.1a"><msup id="S4.p1.12.m12.1.1" xref="S4.p1.12.m12.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.p1.12.m12.1.1.2" xref="S4.p1.12.m12.1.1.2.cmml">𝒟</mi><mi id="S4.p1.12.m12.1.1.3" xref="S4.p1.12.m12.1.1.3.cmml">T</mi></msup><annotation-xml encoding="MathML-Content" id="S4.p1.12.m12.1b"><apply id="S4.p1.12.m12.1.1.cmml" xref="S4.p1.12.m12.1.1"><csymbol cd="ambiguous" id="S4.p1.12.m12.1.1.1.cmml" xref="S4.p1.12.m12.1.1">superscript</csymbol><ci id="S4.p1.12.m12.1.1.2.cmml" xref="S4.p1.12.m12.1.1.2">𝒟</ci><ci id="S4.p1.12.m12.1.1.3.cmml" xref="S4.p1.12.m12.1.1.3">𝑇</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.p1.12.m12.1c">\mathcal{D}^{T}</annotation></semantics></math> are used, requiring priors on clients’ data).
<br class="ltx_break"><span id="S4.p1.20.2" class="ltx_text ltx_font_bold">Adaptation.</span> At each round <math id="S4.p1.13.m13.1" class="ltx_Math" alttext="r" display="inline"><semantics id="S4.p1.13.m13.1a"><mi id="S4.p1.13.m13.1.1" xref="S4.p1.13.m13.1.1.cmml">r</mi><annotation-xml encoding="MathML-Content" id="S4.p1.13.m13.1b"><ci id="S4.p1.13.m13.1.1.cmml" xref="S4.p1.13.m13.1.1">𝑟</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.p1.13.m13.1c">r</annotation></semantics></math>, we consider that, among all the set of clients <math id="S4.p1.14.m14.1" class="ltx_Math" alttext="\mathcal{K}" display="inline"><semantics id="S4.p1.14.m14.1a"><mi class="ltx_font_mathcaligraphic" id="S4.p1.14.m14.1.1" xref="S4.p1.14.m14.1.1.cmml">𝒦</mi><annotation-xml encoding="MathML-Content" id="S4.p1.14.m14.1b"><ci id="S4.p1.14.m14.1.1.cmml" xref="S4.p1.14.m14.1.1">𝒦</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.p1.14.m14.1c">\mathcal{K}</annotation></semantics></math>, only a subset denoted as <math id="S4.p1.15.m15.1" class="ltx_Math" alttext="\mathcal{K}^{r}" display="inline"><semantics id="S4.p1.15.m15.1a"><msup id="S4.p1.15.m15.1.1" xref="S4.p1.15.m15.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.p1.15.m15.1.1.2" xref="S4.p1.15.m15.1.1.2.cmml">𝒦</mi><mi id="S4.p1.15.m15.1.1.3" xref="S4.p1.15.m15.1.1.3.cmml">r</mi></msup><annotation-xml encoding="MathML-Content" id="S4.p1.15.m15.1b"><apply id="S4.p1.15.m15.1.1.cmml" xref="S4.p1.15.m15.1.1"><csymbol cd="ambiguous" id="S4.p1.15.m15.1.1.1.cmml" xref="S4.p1.15.m15.1.1">superscript</csymbol><ci id="S4.p1.15.m15.1.1.2.cmml" xref="S4.p1.15.m15.1.1.2">𝒦</ci><ci id="S4.p1.15.m15.1.1.3.cmml" xref="S4.p1.15.m15.1.1.3">𝑟</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.p1.15.m15.1c">\mathcal{K}^{r}</annotation></semantics></math> participate in the training. This assumption is common in FL where not all the clients might be concurrently active and reflects well on our scenario (e.g. a car is parked). Then, the server transmits the global model from the previous round <math id="S4.p1.16.m16.1" class="ltx_Math" alttext="M_{G}^{r-1}" display="inline"><semantics id="S4.p1.16.m16.1a"><msubsup id="S4.p1.16.m16.1.1" xref="S4.p1.16.m16.1.1.cmml"><mi id="S4.p1.16.m16.1.1.2.2" xref="S4.p1.16.m16.1.1.2.2.cmml">M</mi><mi id="S4.p1.16.m16.1.1.2.3" xref="S4.p1.16.m16.1.1.2.3.cmml">G</mi><mrow id="S4.p1.16.m16.1.1.3" xref="S4.p1.16.m16.1.1.3.cmml"><mi id="S4.p1.16.m16.1.1.3.2" xref="S4.p1.16.m16.1.1.3.2.cmml">r</mi><mo id="S4.p1.16.m16.1.1.3.1" xref="S4.p1.16.m16.1.1.3.1.cmml">−</mo><mn id="S4.p1.16.m16.1.1.3.3" xref="S4.p1.16.m16.1.1.3.3.cmml">1</mn></mrow></msubsup><annotation-xml encoding="MathML-Content" id="S4.p1.16.m16.1b"><apply id="S4.p1.16.m16.1.1.cmml" xref="S4.p1.16.m16.1.1"><csymbol cd="ambiguous" id="S4.p1.16.m16.1.1.1.cmml" xref="S4.p1.16.m16.1.1">superscript</csymbol><apply id="S4.p1.16.m16.1.1.2.cmml" xref="S4.p1.16.m16.1.1"><csymbol cd="ambiguous" id="S4.p1.16.m16.1.1.2.1.cmml" xref="S4.p1.16.m16.1.1">subscript</csymbol><ci id="S4.p1.16.m16.1.1.2.2.cmml" xref="S4.p1.16.m16.1.1.2.2">𝑀</ci><ci id="S4.p1.16.m16.1.1.2.3.cmml" xref="S4.p1.16.m16.1.1.2.3">𝐺</ci></apply><apply id="S4.p1.16.m16.1.1.3.cmml" xref="S4.p1.16.m16.1.1.3"><minus id="S4.p1.16.m16.1.1.3.1.cmml" xref="S4.p1.16.m16.1.1.3.1"></minus><ci id="S4.p1.16.m16.1.1.3.2.cmml" xref="S4.p1.16.m16.1.1.3.2">𝑟</ci><cn type="integer" id="S4.p1.16.m16.1.1.3.3.cmml" xref="S4.p1.16.m16.1.1.3.3">1</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.p1.16.m16.1c">M_{G}^{r-1}</annotation></semantics></math>. Note that the weather classifier <math id="S4.p1.17.m17.1" class="ltx_Math" alttext="M_{W}" display="inline"><semantics id="S4.p1.17.m17.1a"><msub id="S4.p1.17.m17.1.1" xref="S4.p1.17.m17.1.1.cmml"><mi id="S4.p1.17.m17.1.1.2" xref="S4.p1.17.m17.1.1.2.cmml">M</mi><mi id="S4.p1.17.m17.1.1.3" xref="S4.p1.17.m17.1.1.3.cmml">W</mi></msub><annotation-xml encoding="MathML-Content" id="S4.p1.17.m17.1b"><apply id="S4.p1.17.m17.1.1.cmml" xref="S4.p1.17.m17.1.1"><csymbol cd="ambiguous" id="S4.p1.17.m17.1.1.1.cmml" xref="S4.p1.17.m17.1.1">subscript</csymbol><ci id="S4.p1.17.m17.1.1.2.cmml" xref="S4.p1.17.m17.1.1.2">𝑀</ci><ci id="S4.p1.17.m17.1.1.3.cmml" xref="S4.p1.17.m17.1.1.3">𝑊</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.p1.17.m17.1c">M_{W}</annotation></semantics></math> is only transmitted once as it is fixed. The training for the active clients will be performed separately on <math id="S4.p1.18.m18.2" class="ltx_Math" alttext="M_{k}^{r},k\in\mathcal{K}^{r}" display="inline"><semantics id="S4.p1.18.m18.2a"><mrow id="S4.p1.18.m18.2.2" xref="S4.p1.18.m18.2.2.cmml"><mrow id="S4.p1.18.m18.2.2.1.1" xref="S4.p1.18.m18.2.2.1.2.cmml"><msubsup id="S4.p1.18.m18.2.2.1.1.1" xref="S4.p1.18.m18.2.2.1.1.1.cmml"><mi id="S4.p1.18.m18.2.2.1.1.1.2.2" xref="S4.p1.18.m18.2.2.1.1.1.2.2.cmml">M</mi><mi id="S4.p1.18.m18.2.2.1.1.1.2.3" xref="S4.p1.18.m18.2.2.1.1.1.2.3.cmml">k</mi><mi id="S4.p1.18.m18.2.2.1.1.1.3" xref="S4.p1.18.m18.2.2.1.1.1.3.cmml">r</mi></msubsup><mo id="S4.p1.18.m18.2.2.1.1.2" xref="S4.p1.18.m18.2.2.1.2.cmml">,</mo><mi id="S4.p1.18.m18.1.1" xref="S4.p1.18.m18.1.1.cmml">k</mi></mrow><mo id="S4.p1.18.m18.2.2.2" xref="S4.p1.18.m18.2.2.2.cmml">∈</mo><msup id="S4.p1.18.m18.2.2.3" xref="S4.p1.18.m18.2.2.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.p1.18.m18.2.2.3.2" xref="S4.p1.18.m18.2.2.3.2.cmml">𝒦</mi><mi id="S4.p1.18.m18.2.2.3.3" xref="S4.p1.18.m18.2.2.3.3.cmml">r</mi></msup></mrow><annotation-xml encoding="MathML-Content" id="S4.p1.18.m18.2b"><apply id="S4.p1.18.m18.2.2.cmml" xref="S4.p1.18.m18.2.2"><in id="S4.p1.18.m18.2.2.2.cmml" xref="S4.p1.18.m18.2.2.2"></in><list id="S4.p1.18.m18.2.2.1.2.cmml" xref="S4.p1.18.m18.2.2.1.1"><apply id="S4.p1.18.m18.2.2.1.1.1.cmml" xref="S4.p1.18.m18.2.2.1.1.1"><csymbol cd="ambiguous" id="S4.p1.18.m18.2.2.1.1.1.1.cmml" xref="S4.p1.18.m18.2.2.1.1.1">superscript</csymbol><apply id="S4.p1.18.m18.2.2.1.1.1.2.cmml" xref="S4.p1.18.m18.2.2.1.1.1"><csymbol cd="ambiguous" id="S4.p1.18.m18.2.2.1.1.1.2.1.cmml" xref="S4.p1.18.m18.2.2.1.1.1">subscript</csymbol><ci id="S4.p1.18.m18.2.2.1.1.1.2.2.cmml" xref="S4.p1.18.m18.2.2.1.1.1.2.2">𝑀</ci><ci id="S4.p1.18.m18.2.2.1.1.1.2.3.cmml" xref="S4.p1.18.m18.2.2.1.1.1.2.3">𝑘</ci></apply><ci id="S4.p1.18.m18.2.2.1.1.1.3.cmml" xref="S4.p1.18.m18.2.2.1.1.1.3">𝑟</ci></apply><ci id="S4.p1.18.m18.1.1.cmml" xref="S4.p1.18.m18.1.1">𝑘</ci></list><apply id="S4.p1.18.m18.2.2.3.cmml" xref="S4.p1.18.m18.2.2.3"><csymbol cd="ambiguous" id="S4.p1.18.m18.2.2.3.1.cmml" xref="S4.p1.18.m18.2.2.3">superscript</csymbol><ci id="S4.p1.18.m18.2.2.3.2.cmml" xref="S4.p1.18.m18.2.2.3.2">𝒦</ci><ci id="S4.p1.18.m18.2.2.3.3.cmml" xref="S4.p1.18.m18.2.2.3.3">𝑟</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.p1.18.m18.2c">M_{k}^{r},k\in\mathcal{K}^{r}</annotation></semantics></math>.
Furthermore, a prototype representation <math id="S4.p1.19.m19.2" class="ltx_Math" alttext="\mathbf{p_{c,k}^{r}}" display="inline"><semantics id="S4.p1.19.m19.2a"><msubsup id="S4.p1.19.m19.2.3" xref="S4.p1.19.m19.2.3.cmml"><mi id="S4.p1.19.m19.2.3.2.2" xref="S4.p1.19.m19.2.3.2.2.cmml">𝐩</mi><mrow id="S4.p1.19.m19.2.2.2.4" xref="S4.p1.19.m19.2.2.2.3.cmml"><mi id="S4.p1.19.m19.1.1.1.1" xref="S4.p1.19.m19.1.1.1.1.cmml">𝐜</mi><mo id="S4.p1.19.m19.2.2.2.4.1" xref="S4.p1.19.m19.2.2.2.3.cmml">,</mo><mi id="S4.p1.19.m19.2.2.2.2" xref="S4.p1.19.m19.2.2.2.2.cmml">𝐤</mi></mrow><mi id="S4.p1.19.m19.2.3.3" xref="S4.p1.19.m19.2.3.3.cmml">𝐫</mi></msubsup><annotation-xml encoding="MathML-Content" id="S4.p1.19.m19.2b"><apply id="S4.p1.19.m19.2.3.cmml" xref="S4.p1.19.m19.2.3"><csymbol cd="ambiguous" id="S4.p1.19.m19.2.3.1.cmml" xref="S4.p1.19.m19.2.3">superscript</csymbol><apply id="S4.p1.19.m19.2.3.2.cmml" xref="S4.p1.19.m19.2.3"><csymbol cd="ambiguous" id="S4.p1.19.m19.2.3.2.1.cmml" xref="S4.p1.19.m19.2.3">subscript</csymbol><ci id="S4.p1.19.m19.2.3.2.2.cmml" xref="S4.p1.19.m19.2.3.2.2">𝐩</ci><list id="S4.p1.19.m19.2.2.2.3.cmml" xref="S4.p1.19.m19.2.2.2.4"><ci id="S4.p1.19.m19.1.1.1.1.cmml" xref="S4.p1.19.m19.1.1.1.1">𝐜</ci><ci id="S4.p1.19.m19.2.2.2.2.cmml" xref="S4.p1.19.m19.2.2.2.2">𝐤</ci></list></apply><ci id="S4.p1.19.m19.2.3.3.cmml" xref="S4.p1.19.m19.2.3.3">𝐫</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.p1.19.m19.2c">\mathbf{p_{c,k}^{r}}</annotation></semantics></math> for each class (i.e., the centroids of the class samples in feature space) is also built and transmitted to the server together with the manifold curvature <math id="S4.p1.20.m20.1" class="ltx_Math" alttext="\gamma_{k}" display="inline"><semantics id="S4.p1.20.m20.1a"><msub id="S4.p1.20.m20.1.1" xref="S4.p1.20.m20.1.1.cmml"><mi id="S4.p1.20.m20.1.1.2" xref="S4.p1.20.m20.1.1.2.cmml">γ</mi><mi id="S4.p1.20.m20.1.1.3" xref="S4.p1.20.m20.1.1.3.cmml">k</mi></msub><annotation-xml encoding="MathML-Content" id="S4.p1.20.m20.1b"><apply id="S4.p1.20.m20.1.1.cmml" xref="S4.p1.20.m20.1.1"><csymbol cd="ambiguous" id="S4.p1.20.m20.1.1.1.cmml" xref="S4.p1.20.m20.1.1">subscript</csymbol><ci id="S4.p1.20.m20.1.1.2.cmml" xref="S4.p1.20.m20.1.1.2">𝛾</ci><ci id="S4.p1.20.m20.1.1.3.cmml" xref="S4.p1.20.m20.1.1.3">𝑘</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.p1.20.m20.1c">\gamma_{k}</annotation></semantics></math> (refer to <a href="#S4.SS3" title="4.3 Prototypical Learning ‣ 4 Training Procedure ‣ When Cars meet Drones: Hyperbolic Federated Learning for Source-Free Domain Adaptation in Adverse Weather" class="ltx_ref"><span class="ltx_text ltx_ref_tag">Sec.</span> <span class="ltx_text ltx_ref_tag">4.3</span></a>).</p>
</div>
<figure id="S4.F2" class="ltx_figure"><img src="/html/2403.13762/assets/x2.png" id="S4.F2.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="461" height="218" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span id="S4.F2.2.1.1" class="ltx_text" style="font-size:90%;">Figure 2</span>: </span><span id="S4.F2.3.2" class="ltx_text" style="font-size:90%;">The two-step training process of HyperFLAW: server pretraining on synthetic data and client-side real-world adaptation. We highlight the active modeling of weather conditions using weather-aware batch norm layers and the use of hyperbolic space for feature alignment via prototypical learning, ensuring consistency in features extracted by car and drone agents across various atmospheric conditions.
At the server, the aggregation with the queue of previous global models reduces the instability introduced by aggregating unlabeled clients.
</span></figcaption>
</figure>
<div id="S4.p2" class="ltx_para">
<p id="S4.p2.2" class="ltx_p">Finally, the models are aggregated at the server side with the approach of <a href="#S4.SS4" title="4.4 Server Aggregation (AG) ‣ 4 Training Procedure ‣ When Cars meet Drones: Hyperbolic Federated Learning for Source-Free Domain Adaptation in Adverse Weather" class="ltx_ref"><span class="ltx_text ltx_ref_tag">Sec.</span> <span class="ltx_text ltx_ref_tag">4.4</span></a> obtaining the global model <math id="S4.p2.1.m1.1" class="ltx_Math" alttext="{M}_{G}^{r}" display="inline"><semantics id="S4.p2.1.m1.1a"><msubsup id="S4.p2.1.m1.1.1" xref="S4.p2.1.m1.1.1.cmml"><mi id="S4.p2.1.m1.1.1.2.2" xref="S4.p2.1.m1.1.1.2.2.cmml">M</mi><mi id="S4.p2.1.m1.1.1.2.3" xref="S4.p2.1.m1.1.1.2.3.cmml">G</mi><mi id="S4.p2.1.m1.1.1.3" xref="S4.p2.1.m1.1.1.3.cmml">r</mi></msubsup><annotation-xml encoding="MathML-Content" id="S4.p2.1.m1.1b"><apply id="S4.p2.1.m1.1.1.cmml" xref="S4.p2.1.m1.1.1"><csymbol cd="ambiguous" id="S4.p2.1.m1.1.1.1.cmml" xref="S4.p2.1.m1.1.1">superscript</csymbol><apply id="S4.p2.1.m1.1.1.2.cmml" xref="S4.p2.1.m1.1.1"><csymbol cd="ambiguous" id="S4.p2.1.m1.1.1.2.1.cmml" xref="S4.p2.1.m1.1.1">subscript</csymbol><ci id="S4.p2.1.m1.1.1.2.2.cmml" xref="S4.p2.1.m1.1.1.2.2">𝑀</ci><ci id="S4.p2.1.m1.1.1.2.3.cmml" xref="S4.p2.1.m1.1.1.2.3">𝐺</ci></apply><ci id="S4.p2.1.m1.1.1.3.cmml" xref="S4.p2.1.m1.1.1.3">𝑟</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.p2.1.m1.1c">{M}_{G}^{r}</annotation></semantics></math> that is used as input for the next step. Prototypical representations are also aggregated at the server side obtaining a set of global class prototypes <math id="S4.p2.2.m2.2" class="ltx_Math" alttext="\mathbf{p^{r}_{G,c}}" display="inline"><semantics id="S4.p2.2.m2.2a"><msubsup id="S4.p2.2.m2.2.3" xref="S4.p2.2.m2.2.3.cmml"><mi id="S4.p2.2.m2.2.3.2.2" xref="S4.p2.2.m2.2.3.2.2.cmml">𝐩</mi><mrow id="S4.p2.2.m2.2.2.2.4" xref="S4.p2.2.m2.2.2.2.3.cmml"><mi id="S4.p2.2.m2.1.1.1.1" xref="S4.p2.2.m2.1.1.1.1.cmml">𝐆</mi><mo id="S4.p2.2.m2.2.2.2.4.1" xref="S4.p2.2.m2.2.2.2.3.cmml">,</mo><mi id="S4.p2.2.m2.2.2.2.2" xref="S4.p2.2.m2.2.2.2.2.cmml">𝐜</mi></mrow><mi id="S4.p2.2.m2.2.3.2.3" xref="S4.p2.2.m2.2.3.2.3.cmml">𝐫</mi></msubsup><annotation-xml encoding="MathML-Content" id="S4.p2.2.m2.2b"><apply id="S4.p2.2.m2.2.3.cmml" xref="S4.p2.2.m2.2.3"><csymbol cd="ambiguous" id="S4.p2.2.m2.2.3.1.cmml" xref="S4.p2.2.m2.2.3">subscript</csymbol><apply id="S4.p2.2.m2.2.3.2.cmml" xref="S4.p2.2.m2.2.3"><csymbol cd="ambiguous" id="S4.p2.2.m2.2.3.2.1.cmml" xref="S4.p2.2.m2.2.3">superscript</csymbol><ci id="S4.p2.2.m2.2.3.2.2.cmml" xref="S4.p2.2.m2.2.3.2.2">𝐩</ci><ci id="S4.p2.2.m2.2.3.2.3.cmml" xref="S4.p2.2.m2.2.3.2.3">𝐫</ci></apply><list id="S4.p2.2.m2.2.2.2.3.cmml" xref="S4.p2.2.m2.2.2.2.4"><ci id="S4.p2.2.m2.1.1.1.1.cmml" xref="S4.p2.2.m2.1.1.1.1">𝐆</ci><ci id="S4.p2.2.m2.2.2.2.2.cmml" xref="S4.p2.2.m2.2.2.2.2">𝐜</ci></list></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.p2.2.m2.2c">\mathbf{p^{r}_{G,c}}</annotation></semantics></math>.</p>
</div>
<section id="S4.SS1" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.1 </span>Client Self-Training (ST)</h3>

<div id="S4.SS1.p1" class="ltx_para">
<p id="S4.SS1.p1.8" class="ltx_p">Self-training involves iteratively enhancing a model’s performance by using its own predictions.
In FL, the clients can rely on the server model as the teacher, as ideally, the server aggregates the global knowledge from the targets. In our framework, we update the teacher model after the round is over. This implies that the global model received by the clients at the beginning of each round <math id="S4.SS1.p1.1.m1.1" class="ltx_Math" alttext="r" display="inline"><semantics id="S4.SS1.p1.1.m1.1a"><mi id="S4.SS1.p1.1.m1.1.1" xref="S4.SS1.p1.1.m1.1.1.cmml">r</mi><annotation-xml encoding="MathML-Content" id="S4.SS1.p1.1.m1.1b"><ci id="S4.SS1.p1.1.m1.1.1.cmml" xref="S4.SS1.p1.1.m1.1.1">𝑟</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p1.1.m1.1c">r</annotation></semantics></math>, <math id="S4.SS1.p1.2.m2.1" class="ltx_Math" alttext="M_{G}^{r-1}" display="inline"><semantics id="S4.SS1.p1.2.m2.1a"><msubsup id="S4.SS1.p1.2.m2.1.1" xref="S4.SS1.p1.2.m2.1.1.cmml"><mi id="S4.SS1.p1.2.m2.1.1.2.2" xref="S4.SS1.p1.2.m2.1.1.2.2.cmml">M</mi><mi id="S4.SS1.p1.2.m2.1.1.2.3" xref="S4.SS1.p1.2.m2.1.1.2.3.cmml">G</mi><mrow id="S4.SS1.p1.2.m2.1.1.3" xref="S4.SS1.p1.2.m2.1.1.3.cmml"><mi id="S4.SS1.p1.2.m2.1.1.3.2" xref="S4.SS1.p1.2.m2.1.1.3.2.cmml">r</mi><mo id="S4.SS1.p1.2.m2.1.1.3.1" xref="S4.SS1.p1.2.m2.1.1.3.1.cmml">−</mo><mn id="S4.SS1.p1.2.m2.1.1.3.3" xref="S4.SS1.p1.2.m2.1.1.3.3.cmml">1</mn></mrow></msubsup><annotation-xml encoding="MathML-Content" id="S4.SS1.p1.2.m2.1b"><apply id="S4.SS1.p1.2.m2.1.1.cmml" xref="S4.SS1.p1.2.m2.1.1"><csymbol cd="ambiguous" id="S4.SS1.p1.2.m2.1.1.1.cmml" xref="S4.SS1.p1.2.m2.1.1">superscript</csymbol><apply id="S4.SS1.p1.2.m2.1.1.2.cmml" xref="S4.SS1.p1.2.m2.1.1"><csymbol cd="ambiguous" id="S4.SS1.p1.2.m2.1.1.2.1.cmml" xref="S4.SS1.p1.2.m2.1.1">subscript</csymbol><ci id="S4.SS1.p1.2.m2.1.1.2.2.cmml" xref="S4.SS1.p1.2.m2.1.1.2.2">𝑀</ci><ci id="S4.SS1.p1.2.m2.1.1.2.3.cmml" xref="S4.SS1.p1.2.m2.1.1.2.3">𝐺</ci></apply><apply id="S4.SS1.p1.2.m2.1.1.3.cmml" xref="S4.SS1.p1.2.m2.1.1.3"><minus id="S4.SS1.p1.2.m2.1.1.3.1.cmml" xref="S4.SS1.p1.2.m2.1.1.3.1"></minus><ci id="S4.SS1.p1.2.m2.1.1.3.2.cmml" xref="S4.SS1.p1.2.m2.1.1.3.2">𝑟</ci><cn type="integer" id="S4.SS1.p1.2.m2.1.1.3.3.cmml" xref="S4.SS1.p1.2.m2.1.1.3.3">1</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p1.2.m2.1c">M_{G}^{r-1}</annotation></semantics></math>, serves also as the current teacher. This approach offers the advantage of eliminating the necessity to transmit two models per round as in <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib37" title="" class="ltx_ref">37</a>]</cite> where also a model from <math id="S4.SS1.p1.3.m3.1" class="ltx_Math" alttext="R_{u}" display="inline"><semantics id="S4.SS1.p1.3.m3.1a"><msub id="S4.SS1.p1.3.m3.1.1" xref="S4.SS1.p1.3.m3.1.1.cmml"><mi id="S4.SS1.p1.3.m3.1.1.2" xref="S4.SS1.p1.3.m3.1.1.2.cmml">R</mi><mi id="S4.SS1.p1.3.m3.1.1.3" xref="S4.SS1.p1.3.m3.1.1.3.cmml">u</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS1.p1.3.m3.1b"><apply id="S4.SS1.p1.3.m3.1.1.cmml" xref="S4.SS1.p1.3.m3.1.1"><csymbol cd="ambiguous" id="S4.SS1.p1.3.m3.1.1.1.cmml" xref="S4.SS1.p1.3.m3.1.1">subscript</csymbol><ci id="S4.SS1.p1.3.m3.1.1.2.cmml" xref="S4.SS1.p1.3.m3.1.1.2">𝑅</ci><ci id="S4.SS1.p1.3.m3.1.1.3.cmml" xref="S4.SS1.p1.3.m3.1.1.3">𝑢</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p1.3.m3.1c">R_{u}</annotation></semantics></math> steps before was used, thus requiring only a single model transmission and avoiding the extra hyperparameter <math id="S4.SS1.p1.4.m4.1" class="ltx_Math" alttext="R_{u}" display="inline"><semantics id="S4.SS1.p1.4.m4.1a"><msub id="S4.SS1.p1.4.m4.1.1" xref="S4.SS1.p1.4.m4.1.1.cmml"><mi id="S4.SS1.p1.4.m4.1.1.2" xref="S4.SS1.p1.4.m4.1.1.2.cmml">R</mi><mi id="S4.SS1.p1.4.m4.1.1.3" xref="S4.SS1.p1.4.m4.1.1.3.cmml">u</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS1.p1.4.m4.1b"><apply id="S4.SS1.p1.4.m4.1.1.cmml" xref="S4.SS1.p1.4.m4.1.1"><csymbol cd="ambiguous" id="S4.SS1.p1.4.m4.1.1.1.cmml" xref="S4.SS1.p1.4.m4.1.1">subscript</csymbol><ci id="S4.SS1.p1.4.m4.1.1.2.cmml" xref="S4.SS1.p1.4.m4.1.1.2">𝑅</ci><ci id="S4.SS1.p1.4.m4.1.1.3.cmml" xref="S4.SS1.p1.4.m4.1.1.3">𝑢</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p1.4.m4.1c">R_{u}</annotation></semantics></math>.
The local model of the <math id="S4.SS1.p1.5.m5.1" class="ltx_Math" alttext="k-th" display="inline"><semantics id="S4.SS1.p1.5.m5.1a"><mrow id="S4.SS1.p1.5.m5.1.1" xref="S4.SS1.p1.5.m5.1.1.cmml"><mi id="S4.SS1.p1.5.m5.1.1.2" xref="S4.SS1.p1.5.m5.1.1.2.cmml">k</mi><mo id="S4.SS1.p1.5.m5.1.1.1" xref="S4.SS1.p1.5.m5.1.1.1.cmml">−</mo><mrow id="S4.SS1.p1.5.m5.1.1.3" xref="S4.SS1.p1.5.m5.1.1.3.cmml"><mi id="S4.SS1.p1.5.m5.1.1.3.2" xref="S4.SS1.p1.5.m5.1.1.3.2.cmml">t</mi><mo lspace="0em" rspace="0em" id="S4.SS1.p1.5.m5.1.1.3.1" xref="S4.SS1.p1.5.m5.1.1.3.1.cmml">​</mo><mi id="S4.SS1.p1.5.m5.1.1.3.3" xref="S4.SS1.p1.5.m5.1.1.3.3.cmml">h</mi></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.p1.5.m5.1b"><apply id="S4.SS1.p1.5.m5.1.1.cmml" xref="S4.SS1.p1.5.m5.1.1"><minus id="S4.SS1.p1.5.m5.1.1.1.cmml" xref="S4.SS1.p1.5.m5.1.1.1"></minus><ci id="S4.SS1.p1.5.m5.1.1.2.cmml" xref="S4.SS1.p1.5.m5.1.1.2">𝑘</ci><apply id="S4.SS1.p1.5.m5.1.1.3.cmml" xref="S4.SS1.p1.5.m5.1.1.3"><times id="S4.SS1.p1.5.m5.1.1.3.1.cmml" xref="S4.SS1.p1.5.m5.1.1.3.1"></times><ci id="S4.SS1.p1.5.m5.1.1.3.2.cmml" xref="S4.SS1.p1.5.m5.1.1.3.2">𝑡</ci><ci id="S4.SS1.p1.5.m5.1.1.3.3.cmml" xref="S4.SS1.p1.5.m5.1.1.3.3">ℎ</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p1.5.m5.1c">k-th</annotation></semantics></math> client is trained using the weak supervision of the pseudo-labels produced by the teacher model <math id="S4.SS1.p1.6.m6.1" class="ltx_Math" alttext="M_{G}^{r-1}" display="inline"><semantics id="S4.SS1.p1.6.m6.1a"><msubsup id="S4.SS1.p1.6.m6.1.1" xref="S4.SS1.p1.6.m6.1.1.cmml"><mi id="S4.SS1.p1.6.m6.1.1.2.2" xref="S4.SS1.p1.6.m6.1.1.2.2.cmml">M</mi><mi id="S4.SS1.p1.6.m6.1.1.2.3" xref="S4.SS1.p1.6.m6.1.1.2.3.cmml">G</mi><mrow id="S4.SS1.p1.6.m6.1.1.3" xref="S4.SS1.p1.6.m6.1.1.3.cmml"><mi id="S4.SS1.p1.6.m6.1.1.3.2" xref="S4.SS1.p1.6.m6.1.1.3.2.cmml">r</mi><mo id="S4.SS1.p1.6.m6.1.1.3.1" xref="S4.SS1.p1.6.m6.1.1.3.1.cmml">−</mo><mn id="S4.SS1.p1.6.m6.1.1.3.3" xref="S4.SS1.p1.6.m6.1.1.3.3.cmml">1</mn></mrow></msubsup><annotation-xml encoding="MathML-Content" id="S4.SS1.p1.6.m6.1b"><apply id="S4.SS1.p1.6.m6.1.1.cmml" xref="S4.SS1.p1.6.m6.1.1"><csymbol cd="ambiguous" id="S4.SS1.p1.6.m6.1.1.1.cmml" xref="S4.SS1.p1.6.m6.1.1">superscript</csymbol><apply id="S4.SS1.p1.6.m6.1.1.2.cmml" xref="S4.SS1.p1.6.m6.1.1"><csymbol cd="ambiguous" id="S4.SS1.p1.6.m6.1.1.2.1.cmml" xref="S4.SS1.p1.6.m6.1.1">subscript</csymbol><ci id="S4.SS1.p1.6.m6.1.1.2.2.cmml" xref="S4.SS1.p1.6.m6.1.1.2.2">𝑀</ci><ci id="S4.SS1.p1.6.m6.1.1.2.3.cmml" xref="S4.SS1.p1.6.m6.1.1.2.3">𝐺</ci></apply><apply id="S4.SS1.p1.6.m6.1.1.3.cmml" xref="S4.SS1.p1.6.m6.1.1.3"><minus id="S4.SS1.p1.6.m6.1.1.3.1.cmml" xref="S4.SS1.p1.6.m6.1.1.3.1"></minus><ci id="S4.SS1.p1.6.m6.1.1.3.2.cmml" xref="S4.SS1.p1.6.m6.1.1.3.2">𝑟</ci><cn type="integer" id="S4.SS1.p1.6.m6.1.1.3.3.cmml" xref="S4.SS1.p1.6.m6.1.1.3.3">1</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p1.6.m6.1c">M_{G}^{r-1}</annotation></semantics></math> and its local model prediction <math id="S4.SS1.p1.7.m7.1" class="ltx_Math" alttext="M^{r}_{k}" display="inline"><semantics id="S4.SS1.p1.7.m7.1a"><msubsup id="S4.SS1.p1.7.m7.1.1" xref="S4.SS1.p1.7.m7.1.1.cmml"><mi id="S4.SS1.p1.7.m7.1.1.2.2" xref="S4.SS1.p1.7.m7.1.1.2.2.cmml">M</mi><mi id="S4.SS1.p1.7.m7.1.1.3" xref="S4.SS1.p1.7.m7.1.1.3.cmml">k</mi><mi id="S4.SS1.p1.7.m7.1.1.2.3" xref="S4.SS1.p1.7.m7.1.1.2.3.cmml">r</mi></msubsup><annotation-xml encoding="MathML-Content" id="S4.SS1.p1.7.m7.1b"><apply id="S4.SS1.p1.7.m7.1.1.cmml" xref="S4.SS1.p1.7.m7.1.1"><csymbol cd="ambiguous" id="S4.SS1.p1.7.m7.1.1.1.cmml" xref="S4.SS1.p1.7.m7.1.1">subscript</csymbol><apply id="S4.SS1.p1.7.m7.1.1.2.cmml" xref="S4.SS1.p1.7.m7.1.1"><csymbol cd="ambiguous" id="S4.SS1.p1.7.m7.1.1.2.1.cmml" xref="S4.SS1.p1.7.m7.1.1">superscript</csymbol><ci id="S4.SS1.p1.7.m7.1.1.2.2.cmml" xref="S4.SS1.p1.7.m7.1.1.2.2">𝑀</ci><ci id="S4.SS1.p1.7.m7.1.1.2.3.cmml" xref="S4.SS1.p1.7.m7.1.1.2.3">𝑟</ci></apply><ci id="S4.SS1.p1.7.m7.1.1.3.cmml" xref="S4.SS1.p1.7.m7.1.1.3">𝑘</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p1.7.m7.1c">M^{r}_{k}</annotation></semantics></math> by optimizing the self-training loss obtained via cross-entropy as <math id="S4.SS1.p1.8.m8.2" class="ltx_Math" alttext="\mathcal{L}_{st}(M_{G}^{r-1}(x_{k}^{T}),M^{r}_{k}(x_{k}^{T}))" display="inline"><semantics id="S4.SS1.p1.8.m8.2a"><mrow id="S4.SS1.p1.8.m8.2.2" xref="S4.SS1.p1.8.m8.2.2.cmml"><msub id="S4.SS1.p1.8.m8.2.2.4" xref="S4.SS1.p1.8.m8.2.2.4.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.SS1.p1.8.m8.2.2.4.2" xref="S4.SS1.p1.8.m8.2.2.4.2.cmml">ℒ</mi><mrow id="S4.SS1.p1.8.m8.2.2.4.3" xref="S4.SS1.p1.8.m8.2.2.4.3.cmml"><mi id="S4.SS1.p1.8.m8.2.2.4.3.2" xref="S4.SS1.p1.8.m8.2.2.4.3.2.cmml">s</mi><mo lspace="0em" rspace="0em" id="S4.SS1.p1.8.m8.2.2.4.3.1" xref="S4.SS1.p1.8.m8.2.2.4.3.1.cmml">​</mo><mi id="S4.SS1.p1.8.m8.2.2.4.3.3" xref="S4.SS1.p1.8.m8.2.2.4.3.3.cmml">t</mi></mrow></msub><mo lspace="0em" rspace="0em" id="S4.SS1.p1.8.m8.2.2.3" xref="S4.SS1.p1.8.m8.2.2.3.cmml">​</mo><mrow id="S4.SS1.p1.8.m8.2.2.2.2" xref="S4.SS1.p1.8.m8.2.2.2.3.cmml"><mo stretchy="false" id="S4.SS1.p1.8.m8.2.2.2.2.3" xref="S4.SS1.p1.8.m8.2.2.2.3.cmml">(</mo><mrow id="S4.SS1.p1.8.m8.1.1.1.1.1" xref="S4.SS1.p1.8.m8.1.1.1.1.1.cmml"><msubsup id="S4.SS1.p1.8.m8.1.1.1.1.1.3" xref="S4.SS1.p1.8.m8.1.1.1.1.1.3.cmml"><mi id="S4.SS1.p1.8.m8.1.1.1.1.1.3.2.2" xref="S4.SS1.p1.8.m8.1.1.1.1.1.3.2.2.cmml">M</mi><mi id="S4.SS1.p1.8.m8.1.1.1.1.1.3.2.3" xref="S4.SS1.p1.8.m8.1.1.1.1.1.3.2.3.cmml">G</mi><mrow id="S4.SS1.p1.8.m8.1.1.1.1.1.3.3" xref="S4.SS1.p1.8.m8.1.1.1.1.1.3.3.cmml"><mi id="S4.SS1.p1.8.m8.1.1.1.1.1.3.3.2" xref="S4.SS1.p1.8.m8.1.1.1.1.1.3.3.2.cmml">r</mi><mo id="S4.SS1.p1.8.m8.1.1.1.1.1.3.3.1" xref="S4.SS1.p1.8.m8.1.1.1.1.1.3.3.1.cmml">−</mo><mn id="S4.SS1.p1.8.m8.1.1.1.1.1.3.3.3" xref="S4.SS1.p1.8.m8.1.1.1.1.1.3.3.3.cmml">1</mn></mrow></msubsup><mo lspace="0em" rspace="0em" id="S4.SS1.p1.8.m8.1.1.1.1.1.2" xref="S4.SS1.p1.8.m8.1.1.1.1.1.2.cmml">​</mo><mrow id="S4.SS1.p1.8.m8.1.1.1.1.1.1.1" xref="S4.SS1.p1.8.m8.1.1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S4.SS1.p1.8.m8.1.1.1.1.1.1.1.2" xref="S4.SS1.p1.8.m8.1.1.1.1.1.1.1.1.cmml">(</mo><msubsup id="S4.SS1.p1.8.m8.1.1.1.1.1.1.1.1" xref="S4.SS1.p1.8.m8.1.1.1.1.1.1.1.1.cmml"><mi id="S4.SS1.p1.8.m8.1.1.1.1.1.1.1.1.2.2" xref="S4.SS1.p1.8.m8.1.1.1.1.1.1.1.1.2.2.cmml">x</mi><mi id="S4.SS1.p1.8.m8.1.1.1.1.1.1.1.1.2.3" xref="S4.SS1.p1.8.m8.1.1.1.1.1.1.1.1.2.3.cmml">k</mi><mi id="S4.SS1.p1.8.m8.1.1.1.1.1.1.1.1.3" xref="S4.SS1.p1.8.m8.1.1.1.1.1.1.1.1.3.cmml">T</mi></msubsup><mo stretchy="false" id="S4.SS1.p1.8.m8.1.1.1.1.1.1.1.3" xref="S4.SS1.p1.8.m8.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S4.SS1.p1.8.m8.2.2.2.2.4" xref="S4.SS1.p1.8.m8.2.2.2.3.cmml">,</mo><mrow id="S4.SS1.p1.8.m8.2.2.2.2.2" xref="S4.SS1.p1.8.m8.2.2.2.2.2.cmml"><msubsup id="S4.SS1.p1.8.m8.2.2.2.2.2.3" xref="S4.SS1.p1.8.m8.2.2.2.2.2.3.cmml"><mi id="S4.SS1.p1.8.m8.2.2.2.2.2.3.2.2" xref="S4.SS1.p1.8.m8.2.2.2.2.2.3.2.2.cmml">M</mi><mi id="S4.SS1.p1.8.m8.2.2.2.2.2.3.3" xref="S4.SS1.p1.8.m8.2.2.2.2.2.3.3.cmml">k</mi><mi id="S4.SS1.p1.8.m8.2.2.2.2.2.3.2.3" xref="S4.SS1.p1.8.m8.2.2.2.2.2.3.2.3.cmml">r</mi></msubsup><mo lspace="0em" rspace="0em" id="S4.SS1.p1.8.m8.2.2.2.2.2.2" xref="S4.SS1.p1.8.m8.2.2.2.2.2.2.cmml">​</mo><mrow id="S4.SS1.p1.8.m8.2.2.2.2.2.1.1" xref="S4.SS1.p1.8.m8.2.2.2.2.2.1.1.1.cmml"><mo stretchy="false" id="S4.SS1.p1.8.m8.2.2.2.2.2.1.1.2" xref="S4.SS1.p1.8.m8.2.2.2.2.2.1.1.1.cmml">(</mo><msubsup id="S4.SS1.p1.8.m8.2.2.2.2.2.1.1.1" xref="S4.SS1.p1.8.m8.2.2.2.2.2.1.1.1.cmml"><mi id="S4.SS1.p1.8.m8.2.2.2.2.2.1.1.1.2.2" xref="S4.SS1.p1.8.m8.2.2.2.2.2.1.1.1.2.2.cmml">x</mi><mi id="S4.SS1.p1.8.m8.2.2.2.2.2.1.1.1.2.3" xref="S4.SS1.p1.8.m8.2.2.2.2.2.1.1.1.2.3.cmml">k</mi><mi id="S4.SS1.p1.8.m8.2.2.2.2.2.1.1.1.3" xref="S4.SS1.p1.8.m8.2.2.2.2.2.1.1.1.3.cmml">T</mi></msubsup><mo stretchy="false" id="S4.SS1.p1.8.m8.2.2.2.2.2.1.1.3" xref="S4.SS1.p1.8.m8.2.2.2.2.2.1.1.1.cmml">)</mo></mrow></mrow><mo stretchy="false" id="S4.SS1.p1.8.m8.2.2.2.2.5" xref="S4.SS1.p1.8.m8.2.2.2.3.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.p1.8.m8.2b"><apply id="S4.SS1.p1.8.m8.2.2.cmml" xref="S4.SS1.p1.8.m8.2.2"><times id="S4.SS1.p1.8.m8.2.2.3.cmml" xref="S4.SS1.p1.8.m8.2.2.3"></times><apply id="S4.SS1.p1.8.m8.2.2.4.cmml" xref="S4.SS1.p1.8.m8.2.2.4"><csymbol cd="ambiguous" id="S4.SS1.p1.8.m8.2.2.4.1.cmml" xref="S4.SS1.p1.8.m8.2.2.4">subscript</csymbol><ci id="S4.SS1.p1.8.m8.2.2.4.2.cmml" xref="S4.SS1.p1.8.m8.2.2.4.2">ℒ</ci><apply id="S4.SS1.p1.8.m8.2.2.4.3.cmml" xref="S4.SS1.p1.8.m8.2.2.4.3"><times id="S4.SS1.p1.8.m8.2.2.4.3.1.cmml" xref="S4.SS1.p1.8.m8.2.2.4.3.1"></times><ci id="S4.SS1.p1.8.m8.2.2.4.3.2.cmml" xref="S4.SS1.p1.8.m8.2.2.4.3.2">𝑠</ci><ci id="S4.SS1.p1.8.m8.2.2.4.3.3.cmml" xref="S4.SS1.p1.8.m8.2.2.4.3.3">𝑡</ci></apply></apply><interval closure="open" id="S4.SS1.p1.8.m8.2.2.2.3.cmml" xref="S4.SS1.p1.8.m8.2.2.2.2"><apply id="S4.SS1.p1.8.m8.1.1.1.1.1.cmml" xref="S4.SS1.p1.8.m8.1.1.1.1.1"><times id="S4.SS1.p1.8.m8.1.1.1.1.1.2.cmml" xref="S4.SS1.p1.8.m8.1.1.1.1.1.2"></times><apply id="S4.SS1.p1.8.m8.1.1.1.1.1.3.cmml" xref="S4.SS1.p1.8.m8.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S4.SS1.p1.8.m8.1.1.1.1.1.3.1.cmml" xref="S4.SS1.p1.8.m8.1.1.1.1.1.3">superscript</csymbol><apply id="S4.SS1.p1.8.m8.1.1.1.1.1.3.2.cmml" xref="S4.SS1.p1.8.m8.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S4.SS1.p1.8.m8.1.1.1.1.1.3.2.1.cmml" xref="S4.SS1.p1.8.m8.1.1.1.1.1.3">subscript</csymbol><ci id="S4.SS1.p1.8.m8.1.1.1.1.1.3.2.2.cmml" xref="S4.SS1.p1.8.m8.1.1.1.1.1.3.2.2">𝑀</ci><ci id="S4.SS1.p1.8.m8.1.1.1.1.1.3.2.3.cmml" xref="S4.SS1.p1.8.m8.1.1.1.1.1.3.2.3">𝐺</ci></apply><apply id="S4.SS1.p1.8.m8.1.1.1.1.1.3.3.cmml" xref="S4.SS1.p1.8.m8.1.1.1.1.1.3.3"><minus id="S4.SS1.p1.8.m8.1.1.1.1.1.3.3.1.cmml" xref="S4.SS1.p1.8.m8.1.1.1.1.1.3.3.1"></minus><ci id="S4.SS1.p1.8.m8.1.1.1.1.1.3.3.2.cmml" xref="S4.SS1.p1.8.m8.1.1.1.1.1.3.3.2">𝑟</ci><cn type="integer" id="S4.SS1.p1.8.m8.1.1.1.1.1.3.3.3.cmml" xref="S4.SS1.p1.8.m8.1.1.1.1.1.3.3.3">1</cn></apply></apply><apply id="S4.SS1.p1.8.m8.1.1.1.1.1.1.1.1.cmml" xref="S4.SS1.p1.8.m8.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.SS1.p1.8.m8.1.1.1.1.1.1.1.1.1.cmml" xref="S4.SS1.p1.8.m8.1.1.1.1.1.1.1">superscript</csymbol><apply id="S4.SS1.p1.8.m8.1.1.1.1.1.1.1.1.2.cmml" xref="S4.SS1.p1.8.m8.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.SS1.p1.8.m8.1.1.1.1.1.1.1.1.2.1.cmml" xref="S4.SS1.p1.8.m8.1.1.1.1.1.1.1">subscript</csymbol><ci id="S4.SS1.p1.8.m8.1.1.1.1.1.1.1.1.2.2.cmml" xref="S4.SS1.p1.8.m8.1.1.1.1.1.1.1.1.2.2">𝑥</ci><ci id="S4.SS1.p1.8.m8.1.1.1.1.1.1.1.1.2.3.cmml" xref="S4.SS1.p1.8.m8.1.1.1.1.1.1.1.1.2.3">𝑘</ci></apply><ci id="S4.SS1.p1.8.m8.1.1.1.1.1.1.1.1.3.cmml" xref="S4.SS1.p1.8.m8.1.1.1.1.1.1.1.1.3">𝑇</ci></apply></apply><apply id="S4.SS1.p1.8.m8.2.2.2.2.2.cmml" xref="S4.SS1.p1.8.m8.2.2.2.2.2"><times id="S4.SS1.p1.8.m8.2.2.2.2.2.2.cmml" xref="S4.SS1.p1.8.m8.2.2.2.2.2.2"></times><apply id="S4.SS1.p1.8.m8.2.2.2.2.2.3.cmml" xref="S4.SS1.p1.8.m8.2.2.2.2.2.3"><csymbol cd="ambiguous" id="S4.SS1.p1.8.m8.2.2.2.2.2.3.1.cmml" xref="S4.SS1.p1.8.m8.2.2.2.2.2.3">subscript</csymbol><apply id="S4.SS1.p1.8.m8.2.2.2.2.2.3.2.cmml" xref="S4.SS1.p1.8.m8.2.2.2.2.2.3"><csymbol cd="ambiguous" id="S4.SS1.p1.8.m8.2.2.2.2.2.3.2.1.cmml" xref="S4.SS1.p1.8.m8.2.2.2.2.2.3">superscript</csymbol><ci id="S4.SS1.p1.8.m8.2.2.2.2.2.3.2.2.cmml" xref="S4.SS1.p1.8.m8.2.2.2.2.2.3.2.2">𝑀</ci><ci id="S4.SS1.p1.8.m8.2.2.2.2.2.3.2.3.cmml" xref="S4.SS1.p1.8.m8.2.2.2.2.2.3.2.3">𝑟</ci></apply><ci id="S4.SS1.p1.8.m8.2.2.2.2.2.3.3.cmml" xref="S4.SS1.p1.8.m8.2.2.2.2.2.3.3">𝑘</ci></apply><apply id="S4.SS1.p1.8.m8.2.2.2.2.2.1.1.1.cmml" xref="S4.SS1.p1.8.m8.2.2.2.2.2.1.1"><csymbol cd="ambiguous" id="S4.SS1.p1.8.m8.2.2.2.2.2.1.1.1.1.cmml" xref="S4.SS1.p1.8.m8.2.2.2.2.2.1.1">superscript</csymbol><apply id="S4.SS1.p1.8.m8.2.2.2.2.2.1.1.1.2.cmml" xref="S4.SS1.p1.8.m8.2.2.2.2.2.1.1"><csymbol cd="ambiguous" id="S4.SS1.p1.8.m8.2.2.2.2.2.1.1.1.2.1.cmml" xref="S4.SS1.p1.8.m8.2.2.2.2.2.1.1">subscript</csymbol><ci id="S4.SS1.p1.8.m8.2.2.2.2.2.1.1.1.2.2.cmml" xref="S4.SS1.p1.8.m8.2.2.2.2.2.1.1.1.2.2">𝑥</ci><ci id="S4.SS1.p1.8.m8.2.2.2.2.2.1.1.1.2.3.cmml" xref="S4.SS1.p1.8.m8.2.2.2.2.2.1.1.1.2.3">𝑘</ci></apply><ci id="S4.SS1.p1.8.m8.2.2.2.2.2.1.1.1.3.cmml" xref="S4.SS1.p1.8.m8.2.2.2.2.2.1.1.1.3">𝑇</ci></apply></apply></interval></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p1.8.m8.2c">\mathcal{L}_{st}(M_{G}^{r-1}(x_{k}^{T}),M^{r}_{k}(x_{k}^{T}))</annotation></semantics></math>.
Moreover, to achieve a training that is consistent across the heterogeneous clients
and a model able to generalize to different types of agents and weather conditions the self-training loss is used in combination with the prototype-based one, i.e.,</p>
<table id="S4.E2" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S4.E2.m1.3" class="ltx_Math" alttext="\mathcal{L}_{k}(\theta)=\mathcal{L}_{st}(\theta)+\lambda_{cl}\mathcal{L}_{cl}(\theta)" display="block"><semantics id="S4.E2.m1.3a"><mrow id="S4.E2.m1.3.4" xref="S4.E2.m1.3.4.cmml"><mrow id="S4.E2.m1.3.4.2" xref="S4.E2.m1.3.4.2.cmml"><msub id="S4.E2.m1.3.4.2.2" xref="S4.E2.m1.3.4.2.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.E2.m1.3.4.2.2.2" xref="S4.E2.m1.3.4.2.2.2.cmml">ℒ</mi><mi id="S4.E2.m1.3.4.2.2.3" xref="S4.E2.m1.3.4.2.2.3.cmml">k</mi></msub><mo lspace="0em" rspace="0em" id="S4.E2.m1.3.4.2.1" xref="S4.E2.m1.3.4.2.1.cmml">​</mo><mrow id="S4.E2.m1.3.4.2.3.2" xref="S4.E2.m1.3.4.2.cmml"><mo stretchy="false" id="S4.E2.m1.3.4.2.3.2.1" xref="S4.E2.m1.3.4.2.cmml">(</mo><mi id="S4.E2.m1.1.1" xref="S4.E2.m1.1.1.cmml">θ</mi><mo stretchy="false" id="S4.E2.m1.3.4.2.3.2.2" xref="S4.E2.m1.3.4.2.cmml">)</mo></mrow></mrow><mo id="S4.E2.m1.3.4.1" xref="S4.E2.m1.3.4.1.cmml">=</mo><mrow id="S4.E2.m1.3.4.3" xref="S4.E2.m1.3.4.3.cmml"><mrow id="S4.E2.m1.3.4.3.2" xref="S4.E2.m1.3.4.3.2.cmml"><msub id="S4.E2.m1.3.4.3.2.2" xref="S4.E2.m1.3.4.3.2.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.E2.m1.3.4.3.2.2.2" xref="S4.E2.m1.3.4.3.2.2.2.cmml">ℒ</mi><mrow id="S4.E2.m1.3.4.3.2.2.3" xref="S4.E2.m1.3.4.3.2.2.3.cmml"><mi id="S4.E2.m1.3.4.3.2.2.3.2" xref="S4.E2.m1.3.4.3.2.2.3.2.cmml">s</mi><mo lspace="0em" rspace="0em" id="S4.E2.m1.3.4.3.2.2.3.1" xref="S4.E2.m1.3.4.3.2.2.3.1.cmml">​</mo><mi id="S4.E2.m1.3.4.3.2.2.3.3" xref="S4.E2.m1.3.4.3.2.2.3.3.cmml">t</mi></mrow></msub><mo lspace="0em" rspace="0em" id="S4.E2.m1.3.4.3.2.1" xref="S4.E2.m1.3.4.3.2.1.cmml">​</mo><mrow id="S4.E2.m1.3.4.3.2.3.2" xref="S4.E2.m1.3.4.3.2.cmml"><mo stretchy="false" id="S4.E2.m1.3.4.3.2.3.2.1" xref="S4.E2.m1.3.4.3.2.cmml">(</mo><mi id="S4.E2.m1.2.2" xref="S4.E2.m1.2.2.cmml">θ</mi><mo stretchy="false" id="S4.E2.m1.3.4.3.2.3.2.2" xref="S4.E2.m1.3.4.3.2.cmml">)</mo></mrow></mrow><mo id="S4.E2.m1.3.4.3.1" xref="S4.E2.m1.3.4.3.1.cmml">+</mo><mrow id="S4.E2.m1.3.4.3.3" xref="S4.E2.m1.3.4.3.3.cmml"><msub id="S4.E2.m1.3.4.3.3.2" xref="S4.E2.m1.3.4.3.3.2.cmml"><mi id="S4.E2.m1.3.4.3.3.2.2" xref="S4.E2.m1.3.4.3.3.2.2.cmml">λ</mi><mrow id="S4.E2.m1.3.4.3.3.2.3" xref="S4.E2.m1.3.4.3.3.2.3.cmml"><mi id="S4.E2.m1.3.4.3.3.2.3.2" xref="S4.E2.m1.3.4.3.3.2.3.2.cmml">c</mi><mo lspace="0em" rspace="0em" id="S4.E2.m1.3.4.3.3.2.3.1" xref="S4.E2.m1.3.4.3.3.2.3.1.cmml">​</mo><mi id="S4.E2.m1.3.4.3.3.2.3.3" xref="S4.E2.m1.3.4.3.3.2.3.3.cmml">l</mi></mrow></msub><mo lspace="0em" rspace="0em" id="S4.E2.m1.3.4.3.3.1" xref="S4.E2.m1.3.4.3.3.1.cmml">​</mo><msub id="S4.E2.m1.3.4.3.3.3" xref="S4.E2.m1.3.4.3.3.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.E2.m1.3.4.3.3.3.2" xref="S4.E2.m1.3.4.3.3.3.2.cmml">ℒ</mi><mrow id="S4.E2.m1.3.4.3.3.3.3" xref="S4.E2.m1.3.4.3.3.3.3.cmml"><mi id="S4.E2.m1.3.4.3.3.3.3.2" xref="S4.E2.m1.3.4.3.3.3.3.2.cmml">c</mi><mo lspace="0em" rspace="0em" id="S4.E2.m1.3.4.3.3.3.3.1" xref="S4.E2.m1.3.4.3.3.3.3.1.cmml">​</mo><mi id="S4.E2.m1.3.4.3.3.3.3.3" xref="S4.E2.m1.3.4.3.3.3.3.3.cmml">l</mi></mrow></msub><mo lspace="0em" rspace="0em" id="S4.E2.m1.3.4.3.3.1a" xref="S4.E2.m1.3.4.3.3.1.cmml">​</mo><mrow id="S4.E2.m1.3.4.3.3.4.2" xref="S4.E2.m1.3.4.3.3.cmml"><mo stretchy="false" id="S4.E2.m1.3.4.3.3.4.2.1" xref="S4.E2.m1.3.4.3.3.cmml">(</mo><mi id="S4.E2.m1.3.3" xref="S4.E2.m1.3.3.cmml">θ</mi><mo stretchy="false" id="S4.E2.m1.3.4.3.3.4.2.2" xref="S4.E2.m1.3.4.3.3.cmml">)</mo></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.E2.m1.3b"><apply id="S4.E2.m1.3.4.cmml" xref="S4.E2.m1.3.4"><eq id="S4.E2.m1.3.4.1.cmml" xref="S4.E2.m1.3.4.1"></eq><apply id="S4.E2.m1.3.4.2.cmml" xref="S4.E2.m1.3.4.2"><times id="S4.E2.m1.3.4.2.1.cmml" xref="S4.E2.m1.3.4.2.1"></times><apply id="S4.E2.m1.3.4.2.2.cmml" xref="S4.E2.m1.3.4.2.2"><csymbol cd="ambiguous" id="S4.E2.m1.3.4.2.2.1.cmml" xref="S4.E2.m1.3.4.2.2">subscript</csymbol><ci id="S4.E2.m1.3.4.2.2.2.cmml" xref="S4.E2.m1.3.4.2.2.2">ℒ</ci><ci id="S4.E2.m1.3.4.2.2.3.cmml" xref="S4.E2.m1.3.4.2.2.3">𝑘</ci></apply><ci id="S4.E2.m1.1.1.cmml" xref="S4.E2.m1.1.1">𝜃</ci></apply><apply id="S4.E2.m1.3.4.3.cmml" xref="S4.E2.m1.3.4.3"><plus id="S4.E2.m1.3.4.3.1.cmml" xref="S4.E2.m1.3.4.3.1"></plus><apply id="S4.E2.m1.3.4.3.2.cmml" xref="S4.E2.m1.3.4.3.2"><times id="S4.E2.m1.3.4.3.2.1.cmml" xref="S4.E2.m1.3.4.3.2.1"></times><apply id="S4.E2.m1.3.4.3.2.2.cmml" xref="S4.E2.m1.3.4.3.2.2"><csymbol cd="ambiguous" id="S4.E2.m1.3.4.3.2.2.1.cmml" xref="S4.E2.m1.3.4.3.2.2">subscript</csymbol><ci id="S4.E2.m1.3.4.3.2.2.2.cmml" xref="S4.E2.m1.3.4.3.2.2.2">ℒ</ci><apply id="S4.E2.m1.3.4.3.2.2.3.cmml" xref="S4.E2.m1.3.4.3.2.2.3"><times id="S4.E2.m1.3.4.3.2.2.3.1.cmml" xref="S4.E2.m1.3.4.3.2.2.3.1"></times><ci id="S4.E2.m1.3.4.3.2.2.3.2.cmml" xref="S4.E2.m1.3.4.3.2.2.3.2">𝑠</ci><ci id="S4.E2.m1.3.4.3.2.2.3.3.cmml" xref="S4.E2.m1.3.4.3.2.2.3.3">𝑡</ci></apply></apply><ci id="S4.E2.m1.2.2.cmml" xref="S4.E2.m1.2.2">𝜃</ci></apply><apply id="S4.E2.m1.3.4.3.3.cmml" xref="S4.E2.m1.3.4.3.3"><times id="S4.E2.m1.3.4.3.3.1.cmml" xref="S4.E2.m1.3.4.3.3.1"></times><apply id="S4.E2.m1.3.4.3.3.2.cmml" xref="S4.E2.m1.3.4.3.3.2"><csymbol cd="ambiguous" id="S4.E2.m1.3.4.3.3.2.1.cmml" xref="S4.E2.m1.3.4.3.3.2">subscript</csymbol><ci id="S4.E2.m1.3.4.3.3.2.2.cmml" xref="S4.E2.m1.3.4.3.3.2.2">𝜆</ci><apply id="S4.E2.m1.3.4.3.3.2.3.cmml" xref="S4.E2.m1.3.4.3.3.2.3"><times id="S4.E2.m1.3.4.3.3.2.3.1.cmml" xref="S4.E2.m1.3.4.3.3.2.3.1"></times><ci id="S4.E2.m1.3.4.3.3.2.3.2.cmml" xref="S4.E2.m1.3.4.3.3.2.3.2">𝑐</ci><ci id="S4.E2.m1.3.4.3.3.2.3.3.cmml" xref="S4.E2.m1.3.4.3.3.2.3.3">𝑙</ci></apply></apply><apply id="S4.E2.m1.3.4.3.3.3.cmml" xref="S4.E2.m1.3.4.3.3.3"><csymbol cd="ambiguous" id="S4.E2.m1.3.4.3.3.3.1.cmml" xref="S4.E2.m1.3.4.3.3.3">subscript</csymbol><ci id="S4.E2.m1.3.4.3.3.3.2.cmml" xref="S4.E2.m1.3.4.3.3.3.2">ℒ</ci><apply id="S4.E2.m1.3.4.3.3.3.3.cmml" xref="S4.E2.m1.3.4.3.3.3.3"><times id="S4.E2.m1.3.4.3.3.3.3.1.cmml" xref="S4.E2.m1.3.4.3.3.3.3.1"></times><ci id="S4.E2.m1.3.4.3.3.3.3.2.cmml" xref="S4.E2.m1.3.4.3.3.3.3.2">𝑐</ci><ci id="S4.E2.m1.3.4.3.3.3.3.3.cmml" xref="S4.E2.m1.3.4.3.3.3.3.3">𝑙</ci></apply></apply><ci id="S4.E2.m1.3.3.cmml" xref="S4.E2.m1.3.3">𝜃</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.E2.m1.3c">\mathcal{L}_{k}(\theta)=\mathcal{L}_{st}(\theta)+\lambda_{cl}\mathcal{L}_{cl}(\theta)</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(2)</span></td>
</tr></tbody>
</table>
<p id="S4.SS1.p1.11" class="ltx_p">where <math id="S4.SS1.p1.9.m1.1" class="ltx_Math" alttext="\theta" display="inline"><semantics id="S4.SS1.p1.9.m1.1a"><mi id="S4.SS1.p1.9.m1.1.1" xref="S4.SS1.p1.9.m1.1.1.cmml">θ</mi><annotation-xml encoding="MathML-Content" id="S4.SS1.p1.9.m1.1b"><ci id="S4.SS1.p1.9.m1.1.1.cmml" xref="S4.SS1.p1.9.m1.1.1">𝜃</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p1.9.m1.1c">\theta</annotation></semantics></math> are the model parameters, <math id="S4.SS1.p1.10.m2.1" class="ltx_Math" alttext="\mathcal{L}_{cl}" display="inline"><semantics id="S4.SS1.p1.10.m2.1a"><msub id="S4.SS1.p1.10.m2.1.1" xref="S4.SS1.p1.10.m2.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.SS1.p1.10.m2.1.1.2" xref="S4.SS1.p1.10.m2.1.1.2.cmml">ℒ</mi><mrow id="S4.SS1.p1.10.m2.1.1.3" xref="S4.SS1.p1.10.m2.1.1.3.cmml"><mi id="S4.SS1.p1.10.m2.1.1.3.2" xref="S4.SS1.p1.10.m2.1.1.3.2.cmml">c</mi><mo lspace="0em" rspace="0em" id="S4.SS1.p1.10.m2.1.1.3.1" xref="S4.SS1.p1.10.m2.1.1.3.1.cmml">​</mo><mi id="S4.SS1.p1.10.m2.1.1.3.3" xref="S4.SS1.p1.10.m2.1.1.3.3.cmml">l</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S4.SS1.p1.10.m2.1b"><apply id="S4.SS1.p1.10.m2.1.1.cmml" xref="S4.SS1.p1.10.m2.1.1"><csymbol cd="ambiguous" id="S4.SS1.p1.10.m2.1.1.1.cmml" xref="S4.SS1.p1.10.m2.1.1">subscript</csymbol><ci id="S4.SS1.p1.10.m2.1.1.2.cmml" xref="S4.SS1.p1.10.m2.1.1.2">ℒ</ci><apply id="S4.SS1.p1.10.m2.1.1.3.cmml" xref="S4.SS1.p1.10.m2.1.1.3"><times id="S4.SS1.p1.10.m2.1.1.3.1.cmml" xref="S4.SS1.p1.10.m2.1.1.3.1"></times><ci id="S4.SS1.p1.10.m2.1.1.3.2.cmml" xref="S4.SS1.p1.10.m2.1.1.3.2">𝑐</ci><ci id="S4.SS1.p1.10.m2.1.1.3.3.cmml" xref="S4.SS1.p1.10.m2.1.1.3.3">𝑙</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p1.10.m2.1c">\mathcal{L}_{cl}</annotation></semantics></math> is the clustering loss computed using prototypical representation (see <a href="#S4.SS3" title="4.3 Prototypical Learning ‣ 4 Training Procedure ‣ When Cars meet Drones: Hyperbolic Federated Learning for Source-Free Domain Adaptation in Adverse Weather" class="ltx_ref"><span class="ltx_text ltx_ref_tag">Sec.</span> <span class="ltx_text ltx_ref_tag">4.3</span></a>), and <math id="S4.SS1.p1.11.m3.1" class="ltx_Math" alttext="\lambda_{cl}" display="inline"><semantics id="S4.SS1.p1.11.m3.1a"><msub id="S4.SS1.p1.11.m3.1.1" xref="S4.SS1.p1.11.m3.1.1.cmml"><mi id="S4.SS1.p1.11.m3.1.1.2" xref="S4.SS1.p1.11.m3.1.1.2.cmml">λ</mi><mrow id="S4.SS1.p1.11.m3.1.1.3" xref="S4.SS1.p1.11.m3.1.1.3.cmml"><mi id="S4.SS1.p1.11.m3.1.1.3.2" xref="S4.SS1.p1.11.m3.1.1.3.2.cmml">c</mi><mo lspace="0em" rspace="0em" id="S4.SS1.p1.11.m3.1.1.3.1" xref="S4.SS1.p1.11.m3.1.1.3.1.cmml">​</mo><mi id="S4.SS1.p1.11.m3.1.1.3.3" xref="S4.SS1.p1.11.m3.1.1.3.3.cmml">l</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S4.SS1.p1.11.m3.1b"><apply id="S4.SS1.p1.11.m3.1.1.cmml" xref="S4.SS1.p1.11.m3.1.1"><csymbol cd="ambiguous" id="S4.SS1.p1.11.m3.1.1.1.cmml" xref="S4.SS1.p1.11.m3.1.1">subscript</csymbol><ci id="S4.SS1.p1.11.m3.1.1.2.cmml" xref="S4.SS1.p1.11.m3.1.1.2">𝜆</ci><apply id="S4.SS1.p1.11.m3.1.1.3.cmml" xref="S4.SS1.p1.11.m3.1.1.3"><times id="S4.SS1.p1.11.m3.1.1.3.1.cmml" xref="S4.SS1.p1.11.m3.1.1.3.1"></times><ci id="S4.SS1.p1.11.m3.1.1.3.2.cmml" xref="S4.SS1.p1.11.m3.1.1.3.2">𝑐</ci><ci id="S4.SS1.p1.11.m3.1.1.3.3.cmml" xref="S4.SS1.p1.11.m3.1.1.3.3">𝑙</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p1.11.m3.1c">\lambda_{cl}</annotation></semantics></math> balances the two losses.</p>
</div>
</section>
<section id="S4.SS2" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.2 </span>Weather Batch Normalization (BN)</h3>

<div id="S4.SS2.p1" class="ltx_para">
<p id="S4.SS2.p1.6" class="ltx_p">Inspired by <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib22" title="" class="ltx_ref">22</a>]</cite> where the update of the batch normalization layers is not synchronized within the global model, we personalize the training by considering a different set of batch-normalization (BN) parameters for each weather condition <math id="S4.SS2.p1.1.m1.1" class="ltx_Math" alttext="w" display="inline"><semantics id="S4.SS2.p1.1.m1.1a"><mi id="S4.SS2.p1.1.m1.1.1" xref="S4.SS2.p1.1.m1.1.1.cmml">w</mi><annotation-xml encoding="MathML-Content" id="S4.SS2.p1.1.m1.1b"><ci id="S4.SS2.p1.1.m1.1.1.cmml" xref="S4.SS2.p1.1.m1.1.1">𝑤</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p1.1.m1.1c">w</annotation></semantics></math>, defined as <math id="S4.SS2.p1.2.m2.1" class="ltx_Math" alttext="\{\theta^{BN}_{w}\}" display="inline"><semantics id="S4.SS2.p1.2.m2.1a"><mrow id="S4.SS2.p1.2.m2.1.1.1" xref="S4.SS2.p1.2.m2.1.1.2.cmml"><mo stretchy="false" id="S4.SS2.p1.2.m2.1.1.1.2" xref="S4.SS2.p1.2.m2.1.1.2.cmml">{</mo><msubsup id="S4.SS2.p1.2.m2.1.1.1.1" xref="S4.SS2.p1.2.m2.1.1.1.1.cmml"><mi id="S4.SS2.p1.2.m2.1.1.1.1.2.2" xref="S4.SS2.p1.2.m2.1.1.1.1.2.2.cmml">θ</mi><mi id="S4.SS2.p1.2.m2.1.1.1.1.3" xref="S4.SS2.p1.2.m2.1.1.1.1.3.cmml">w</mi><mrow id="S4.SS2.p1.2.m2.1.1.1.1.2.3" xref="S4.SS2.p1.2.m2.1.1.1.1.2.3.cmml"><mi id="S4.SS2.p1.2.m2.1.1.1.1.2.3.2" xref="S4.SS2.p1.2.m2.1.1.1.1.2.3.2.cmml">B</mi><mo lspace="0em" rspace="0em" id="S4.SS2.p1.2.m2.1.1.1.1.2.3.1" xref="S4.SS2.p1.2.m2.1.1.1.1.2.3.1.cmml">​</mo><mi id="S4.SS2.p1.2.m2.1.1.1.1.2.3.3" xref="S4.SS2.p1.2.m2.1.1.1.1.2.3.3.cmml">N</mi></mrow></msubsup><mo stretchy="false" id="S4.SS2.p1.2.m2.1.1.1.3" xref="S4.SS2.p1.2.m2.1.1.2.cmml">}</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.p1.2.m2.1b"><set id="S4.SS2.p1.2.m2.1.1.2.cmml" xref="S4.SS2.p1.2.m2.1.1.1"><apply id="S4.SS2.p1.2.m2.1.1.1.1.cmml" xref="S4.SS2.p1.2.m2.1.1.1.1"><csymbol cd="ambiguous" id="S4.SS2.p1.2.m2.1.1.1.1.1.cmml" xref="S4.SS2.p1.2.m2.1.1.1.1">subscript</csymbol><apply id="S4.SS2.p1.2.m2.1.1.1.1.2.cmml" xref="S4.SS2.p1.2.m2.1.1.1.1"><csymbol cd="ambiguous" id="S4.SS2.p1.2.m2.1.1.1.1.2.1.cmml" xref="S4.SS2.p1.2.m2.1.1.1.1">superscript</csymbol><ci id="S4.SS2.p1.2.m2.1.1.1.1.2.2.cmml" xref="S4.SS2.p1.2.m2.1.1.1.1.2.2">𝜃</ci><apply id="S4.SS2.p1.2.m2.1.1.1.1.2.3.cmml" xref="S4.SS2.p1.2.m2.1.1.1.1.2.3"><times id="S4.SS2.p1.2.m2.1.1.1.1.2.3.1.cmml" xref="S4.SS2.p1.2.m2.1.1.1.1.2.3.1"></times><ci id="S4.SS2.p1.2.m2.1.1.1.1.2.3.2.cmml" xref="S4.SS2.p1.2.m2.1.1.1.1.2.3.2">𝐵</ci><ci id="S4.SS2.p1.2.m2.1.1.1.1.2.3.3.cmml" xref="S4.SS2.p1.2.m2.1.1.1.1.2.3.3">𝑁</ci></apply></apply><ci id="S4.SS2.p1.2.m2.1.1.1.1.3.cmml" xref="S4.SS2.p1.2.m2.1.1.1.1.3">𝑤</ci></apply></set></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p1.2.m2.1c">\{\theta^{BN}_{w}\}</annotation></semantics></math>.
After the pretraining (<math id="S4.SS2.p1.3.m3.1" class="ltx_Math" alttext="r=0" display="inline"><semantics id="S4.SS2.p1.3.m3.1a"><mrow id="S4.SS2.p1.3.m3.1.1" xref="S4.SS2.p1.3.m3.1.1.cmml"><mi id="S4.SS2.p1.3.m3.1.1.2" xref="S4.SS2.p1.3.m3.1.1.2.cmml">r</mi><mo id="S4.SS2.p1.3.m3.1.1.1" xref="S4.SS2.p1.3.m3.1.1.1.cmml">=</mo><mn id="S4.SS2.p1.3.m3.1.1.3" xref="S4.SS2.p1.3.m3.1.1.3.cmml">0</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.p1.3.m3.1b"><apply id="S4.SS2.p1.3.m3.1.1.cmml" xref="S4.SS2.p1.3.m3.1.1"><eq id="S4.SS2.p1.3.m3.1.1.1.cmml" xref="S4.SS2.p1.3.m3.1.1.1"></eq><ci id="S4.SS2.p1.3.m3.1.1.2.cmml" xref="S4.SS2.p1.3.m3.1.1.2">𝑟</ci><cn type="integer" id="S4.SS2.p1.3.m3.1.1.3.cmml" xref="S4.SS2.p1.3.m3.1.1.3">0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p1.3.m3.1c">r=0</annotation></semantics></math>), all the weather-specific BNs inherit the global BN statistics <math id="S4.SS2.p1.4.m4.1" class="ltx_Math" alttext="\theta^{BN}" display="inline"><semantics id="S4.SS2.p1.4.m4.1a"><msup id="S4.SS2.p1.4.m4.1.1" xref="S4.SS2.p1.4.m4.1.1.cmml"><mi id="S4.SS2.p1.4.m4.1.1.2" xref="S4.SS2.p1.4.m4.1.1.2.cmml">θ</mi><mrow id="S4.SS2.p1.4.m4.1.1.3" xref="S4.SS2.p1.4.m4.1.1.3.cmml"><mi id="S4.SS2.p1.4.m4.1.1.3.2" xref="S4.SS2.p1.4.m4.1.1.3.2.cmml">B</mi><mo lspace="0em" rspace="0em" id="S4.SS2.p1.4.m4.1.1.3.1" xref="S4.SS2.p1.4.m4.1.1.3.1.cmml">​</mo><mi id="S4.SS2.p1.4.m4.1.1.3.3" xref="S4.SS2.p1.4.m4.1.1.3.3.cmml">N</mi></mrow></msup><annotation-xml encoding="MathML-Content" id="S4.SS2.p1.4.m4.1b"><apply id="S4.SS2.p1.4.m4.1.1.cmml" xref="S4.SS2.p1.4.m4.1.1"><csymbol cd="ambiguous" id="S4.SS2.p1.4.m4.1.1.1.cmml" xref="S4.SS2.p1.4.m4.1.1">superscript</csymbol><ci id="S4.SS2.p1.4.m4.1.1.2.cmml" xref="S4.SS2.p1.4.m4.1.1.2">𝜃</ci><apply id="S4.SS2.p1.4.m4.1.1.3.cmml" xref="S4.SS2.p1.4.m4.1.1.3"><times id="S4.SS2.p1.4.m4.1.1.3.1.cmml" xref="S4.SS2.p1.4.m4.1.1.3.1"></times><ci id="S4.SS2.p1.4.m4.1.1.3.2.cmml" xref="S4.SS2.p1.4.m4.1.1.3.2">𝐵</ci><ci id="S4.SS2.p1.4.m4.1.1.3.3.cmml" xref="S4.SS2.p1.4.m4.1.1.3.3">𝑁</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p1.4.m4.1c">\theta^{BN}</annotation></semantics></math>, while in each subsequent round, the statistics of the BNs are averaged only over those of the same weather condition.
Specifically, on the client side, after obtaining the prediction <math id="S4.SS2.p1.5.m5.1" class="ltx_Math" alttext="\bar{w}=M_{W}(x^{T})" display="inline"><semantics id="S4.SS2.p1.5.m5.1a"><mrow id="S4.SS2.p1.5.m5.1.1" xref="S4.SS2.p1.5.m5.1.1.cmml"><mover accent="true" id="S4.SS2.p1.5.m5.1.1.3" xref="S4.SS2.p1.5.m5.1.1.3.cmml"><mi id="S4.SS2.p1.5.m5.1.1.3.2" xref="S4.SS2.p1.5.m5.1.1.3.2.cmml">w</mi><mo id="S4.SS2.p1.5.m5.1.1.3.1" xref="S4.SS2.p1.5.m5.1.1.3.1.cmml">¯</mo></mover><mo id="S4.SS2.p1.5.m5.1.1.2" xref="S4.SS2.p1.5.m5.1.1.2.cmml">=</mo><mrow id="S4.SS2.p1.5.m5.1.1.1" xref="S4.SS2.p1.5.m5.1.1.1.cmml"><msub id="S4.SS2.p1.5.m5.1.1.1.3" xref="S4.SS2.p1.5.m5.1.1.1.3.cmml"><mi id="S4.SS2.p1.5.m5.1.1.1.3.2" xref="S4.SS2.p1.5.m5.1.1.1.3.2.cmml">M</mi><mi id="S4.SS2.p1.5.m5.1.1.1.3.3" xref="S4.SS2.p1.5.m5.1.1.1.3.3.cmml">W</mi></msub><mo lspace="0em" rspace="0em" id="S4.SS2.p1.5.m5.1.1.1.2" xref="S4.SS2.p1.5.m5.1.1.1.2.cmml">​</mo><mrow id="S4.SS2.p1.5.m5.1.1.1.1.1" xref="S4.SS2.p1.5.m5.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S4.SS2.p1.5.m5.1.1.1.1.1.2" xref="S4.SS2.p1.5.m5.1.1.1.1.1.1.cmml">(</mo><msup id="S4.SS2.p1.5.m5.1.1.1.1.1.1" xref="S4.SS2.p1.5.m5.1.1.1.1.1.1.cmml"><mi id="S4.SS2.p1.5.m5.1.1.1.1.1.1.2" xref="S4.SS2.p1.5.m5.1.1.1.1.1.1.2.cmml">x</mi><mi id="S4.SS2.p1.5.m5.1.1.1.1.1.1.3" xref="S4.SS2.p1.5.m5.1.1.1.1.1.1.3.cmml">T</mi></msup><mo stretchy="false" id="S4.SS2.p1.5.m5.1.1.1.1.1.3" xref="S4.SS2.p1.5.m5.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.p1.5.m5.1b"><apply id="S4.SS2.p1.5.m5.1.1.cmml" xref="S4.SS2.p1.5.m5.1.1"><eq id="S4.SS2.p1.5.m5.1.1.2.cmml" xref="S4.SS2.p1.5.m5.1.1.2"></eq><apply id="S4.SS2.p1.5.m5.1.1.3.cmml" xref="S4.SS2.p1.5.m5.1.1.3"><ci id="S4.SS2.p1.5.m5.1.1.3.1.cmml" xref="S4.SS2.p1.5.m5.1.1.3.1">¯</ci><ci id="S4.SS2.p1.5.m5.1.1.3.2.cmml" xref="S4.SS2.p1.5.m5.1.1.3.2">𝑤</ci></apply><apply id="S4.SS2.p1.5.m5.1.1.1.cmml" xref="S4.SS2.p1.5.m5.1.1.1"><times id="S4.SS2.p1.5.m5.1.1.1.2.cmml" xref="S4.SS2.p1.5.m5.1.1.1.2"></times><apply id="S4.SS2.p1.5.m5.1.1.1.3.cmml" xref="S4.SS2.p1.5.m5.1.1.1.3"><csymbol cd="ambiguous" id="S4.SS2.p1.5.m5.1.1.1.3.1.cmml" xref="S4.SS2.p1.5.m5.1.1.1.3">subscript</csymbol><ci id="S4.SS2.p1.5.m5.1.1.1.3.2.cmml" xref="S4.SS2.p1.5.m5.1.1.1.3.2">𝑀</ci><ci id="S4.SS2.p1.5.m5.1.1.1.3.3.cmml" xref="S4.SS2.p1.5.m5.1.1.1.3.3">𝑊</ci></apply><apply id="S4.SS2.p1.5.m5.1.1.1.1.1.1.cmml" xref="S4.SS2.p1.5.m5.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.SS2.p1.5.m5.1.1.1.1.1.1.1.cmml" xref="S4.SS2.p1.5.m5.1.1.1.1.1">superscript</csymbol><ci id="S4.SS2.p1.5.m5.1.1.1.1.1.1.2.cmml" xref="S4.SS2.p1.5.m5.1.1.1.1.1.1.2">𝑥</ci><ci id="S4.SS2.p1.5.m5.1.1.1.1.1.1.3.cmml" xref="S4.SS2.p1.5.m5.1.1.1.1.1.1.3">𝑇</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p1.5.m5.1c">\bar{w}=M_{W}(x^{T})</annotation></semantics></math> from the classifier, the client batch-norm parameters are optimized using Eq. <a href="#S4.E2" title="Equation 2 ‣ 4.1 Client Self-Training (ST) ‣ 4 Training Procedure ‣ When Cars meet Drones: Hyperbolic Federated Learning for Source-Free Domain Adaptation in Adverse Weather" class="ltx_ref"><span class="ltx_text ltx_ref_tag">2</span></a> only on the selected weather-BNs <math id="S4.SS2.p1.6.m6.1" class="ltx_Math" alttext="\theta^{BN}_{\bar{w}}" display="inline"><semantics id="S4.SS2.p1.6.m6.1a"><msubsup id="S4.SS2.p1.6.m6.1.1" xref="S4.SS2.p1.6.m6.1.1.cmml"><mi id="S4.SS2.p1.6.m6.1.1.2.2" xref="S4.SS2.p1.6.m6.1.1.2.2.cmml">θ</mi><mover accent="true" id="S4.SS2.p1.6.m6.1.1.3" xref="S4.SS2.p1.6.m6.1.1.3.cmml"><mi id="S4.SS2.p1.6.m6.1.1.3.2" xref="S4.SS2.p1.6.m6.1.1.3.2.cmml">w</mi><mo id="S4.SS2.p1.6.m6.1.1.3.1" xref="S4.SS2.p1.6.m6.1.1.3.1.cmml">¯</mo></mover><mrow id="S4.SS2.p1.6.m6.1.1.2.3" xref="S4.SS2.p1.6.m6.1.1.2.3.cmml"><mi id="S4.SS2.p1.6.m6.1.1.2.3.2" xref="S4.SS2.p1.6.m6.1.1.2.3.2.cmml">B</mi><mo lspace="0em" rspace="0em" id="S4.SS2.p1.6.m6.1.1.2.3.1" xref="S4.SS2.p1.6.m6.1.1.2.3.1.cmml">​</mo><mi id="S4.SS2.p1.6.m6.1.1.2.3.3" xref="S4.SS2.p1.6.m6.1.1.2.3.3.cmml">N</mi></mrow></msubsup><annotation-xml encoding="MathML-Content" id="S4.SS2.p1.6.m6.1b"><apply id="S4.SS2.p1.6.m6.1.1.cmml" xref="S4.SS2.p1.6.m6.1.1"><csymbol cd="ambiguous" id="S4.SS2.p1.6.m6.1.1.1.cmml" xref="S4.SS2.p1.6.m6.1.1">subscript</csymbol><apply id="S4.SS2.p1.6.m6.1.1.2.cmml" xref="S4.SS2.p1.6.m6.1.1"><csymbol cd="ambiguous" id="S4.SS2.p1.6.m6.1.1.2.1.cmml" xref="S4.SS2.p1.6.m6.1.1">superscript</csymbol><ci id="S4.SS2.p1.6.m6.1.1.2.2.cmml" xref="S4.SS2.p1.6.m6.1.1.2.2">𝜃</ci><apply id="S4.SS2.p1.6.m6.1.1.2.3.cmml" xref="S4.SS2.p1.6.m6.1.1.2.3"><times id="S4.SS2.p1.6.m6.1.1.2.3.1.cmml" xref="S4.SS2.p1.6.m6.1.1.2.3.1"></times><ci id="S4.SS2.p1.6.m6.1.1.2.3.2.cmml" xref="S4.SS2.p1.6.m6.1.1.2.3.2">𝐵</ci><ci id="S4.SS2.p1.6.m6.1.1.2.3.3.cmml" xref="S4.SS2.p1.6.m6.1.1.2.3.3">𝑁</ci></apply></apply><apply id="S4.SS2.p1.6.m6.1.1.3.cmml" xref="S4.SS2.p1.6.m6.1.1.3"><ci id="S4.SS2.p1.6.m6.1.1.3.1.cmml" xref="S4.SS2.p1.6.m6.1.1.3.1">¯</ci><ci id="S4.SS2.p1.6.m6.1.1.3.2.cmml" xref="S4.SS2.p1.6.m6.1.1.3.2">𝑤</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p1.6.m6.1c">\theta^{BN}_{\bar{w}}</annotation></semantics></math>.
This allows us to enforce a more general feature extraction from the convolutional layers while exploiting the domain-specific nuances of road scenes under different weather conditions.</p>
</div>
</section>
<section id="S4.SS3" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.3 </span>Prototypical Learning</h3>

<div id="S4.SS3.p1" class="ltx_para">
<p id="S4.SS3.p1.5" class="ltx_p">While the various devices explore road scenes, their distinct viewpoints force the local models to conform more closely to the features within each specific perspective.
In the pretraining phase, drone and car samples are provided jointly, however, this simultaneity does not apply to clients, thereby the network predictions could diverge, making the subsequent aggregation on the server side more challenging.
To ensure the ongoing alignment of features across the two data types, we propose the exploitation of joint class prototypes as a viable solution.
For each client, we compute a set of class prototypes <math id="S4.SS3.p1.1.m1.1" class="ltx_Math" alttext="\mathcal{P}" display="inline"><semantics id="S4.SS3.p1.1.m1.1a"><mi class="ltx_font_mathcaligraphic" id="S4.SS3.p1.1.m1.1.1" xref="S4.SS3.p1.1.m1.1.1.cmml">𝒫</mi><annotation-xml encoding="MathML-Content" id="S4.SS3.p1.1.m1.1b"><ci id="S4.SS3.p1.1.m1.1.1.cmml" xref="S4.SS3.p1.1.m1.1.1">𝒫</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p1.1.m1.1c">\mathcal{P}</annotation></semantics></math>, where each prototype <math id="S4.SS3.p1.2.m2.1" class="ltx_Math" alttext="\mathbf{p}_{c}\in\mathcal{P}" display="inline"><semantics id="S4.SS3.p1.2.m2.1a"><mrow id="S4.SS3.p1.2.m2.1.1" xref="S4.SS3.p1.2.m2.1.1.cmml"><msub id="S4.SS3.p1.2.m2.1.1.2" xref="S4.SS3.p1.2.m2.1.1.2.cmml"><mi id="S4.SS3.p1.2.m2.1.1.2.2" xref="S4.SS3.p1.2.m2.1.1.2.2.cmml">𝐩</mi><mi id="S4.SS3.p1.2.m2.1.1.2.3" xref="S4.SS3.p1.2.m2.1.1.2.3.cmml">c</mi></msub><mo id="S4.SS3.p1.2.m2.1.1.1" xref="S4.SS3.p1.2.m2.1.1.1.cmml">∈</mo><mi class="ltx_font_mathcaligraphic" id="S4.SS3.p1.2.m2.1.1.3" xref="S4.SS3.p1.2.m2.1.1.3.cmml">𝒫</mi></mrow><annotation-xml encoding="MathML-Content" id="S4.SS3.p1.2.m2.1b"><apply id="S4.SS3.p1.2.m2.1.1.cmml" xref="S4.SS3.p1.2.m2.1.1"><in id="S4.SS3.p1.2.m2.1.1.1.cmml" xref="S4.SS3.p1.2.m2.1.1.1"></in><apply id="S4.SS3.p1.2.m2.1.1.2.cmml" xref="S4.SS3.p1.2.m2.1.1.2"><csymbol cd="ambiguous" id="S4.SS3.p1.2.m2.1.1.2.1.cmml" xref="S4.SS3.p1.2.m2.1.1.2">subscript</csymbol><ci id="S4.SS3.p1.2.m2.1.1.2.2.cmml" xref="S4.SS3.p1.2.m2.1.1.2.2">𝐩</ci><ci id="S4.SS3.p1.2.m2.1.1.2.3.cmml" xref="S4.SS3.p1.2.m2.1.1.2.3">𝑐</ci></apply><ci id="S4.SS3.p1.2.m2.1.1.3.cmml" xref="S4.SS3.p1.2.m2.1.1.3">𝒫</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p1.2.m2.1c">\mathbf{p}_{c}\in\mathcal{P}</annotation></semantics></math> is defined as a function of the set <math id="S4.SS3.p1.3.m3.1" class="ltx_Math" alttext="\mathcal{F}_{c}" display="inline"><semantics id="S4.SS3.p1.3.m3.1a"><msub id="S4.SS3.p1.3.m3.1.1" xref="S4.SS3.p1.3.m3.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.SS3.p1.3.m3.1.1.2" xref="S4.SS3.p1.3.m3.1.1.2.cmml">ℱ</mi><mi id="S4.SS3.p1.3.m3.1.1.3" xref="S4.SS3.p1.3.m3.1.1.3.cmml">c</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS3.p1.3.m3.1b"><apply id="S4.SS3.p1.3.m3.1.1.cmml" xref="S4.SS3.p1.3.m3.1.1"><csymbol cd="ambiguous" id="S4.SS3.p1.3.m3.1.1.1.cmml" xref="S4.SS3.p1.3.m3.1.1">subscript</csymbol><ci id="S4.SS3.p1.3.m3.1.1.2.cmml" xref="S4.SS3.p1.3.m3.1.1.2">ℱ</ci><ci id="S4.SS3.p1.3.m3.1.1.3.cmml" xref="S4.SS3.p1.3.m3.1.1.3">𝑐</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p1.3.m3.1c">\mathcal{F}_{c}</annotation></semantics></math> of all feature vectors <math id="S4.SS3.p1.4.m4.1" class="ltx_Math" alttext="\textbf{f}_{c}" display="inline"><semantics id="S4.SS3.p1.4.m4.1a"><msub id="S4.SS3.p1.4.m4.1.1" xref="S4.SS3.p1.4.m4.1.1.cmml"><mtext class="ltx_mathvariant_bold" id="S4.SS3.p1.4.m4.1.1.2" xref="S4.SS3.p1.4.m4.1.1.2a.cmml">f</mtext><mi id="S4.SS3.p1.4.m4.1.1.3" xref="S4.SS3.p1.4.m4.1.1.3.cmml">c</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS3.p1.4.m4.1b"><apply id="S4.SS3.p1.4.m4.1.1.cmml" xref="S4.SS3.p1.4.m4.1.1"><csymbol cd="ambiguous" id="S4.SS3.p1.4.m4.1.1.1.cmml" xref="S4.SS3.p1.4.m4.1.1">subscript</csymbol><ci id="S4.SS3.p1.4.m4.1.1.2a.cmml" xref="S4.SS3.p1.4.m4.1.1.2"><mtext class="ltx_mathvariant_bold" id="S4.SS3.p1.4.m4.1.1.2.cmml" xref="S4.SS3.p1.4.m4.1.1.2">f</mtext></ci><ci id="S4.SS3.p1.4.m4.1.1.3.cmml" xref="S4.SS3.p1.4.m4.1.1.3">𝑐</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p1.4.m4.1c">\textbf{f}_{c}</annotation></semantics></math> from the encoder output that are associated to class <math id="S4.SS3.p1.5.m5.1" class="ltx_Math" alttext="c" display="inline"><semantics id="S4.SS3.p1.5.m5.1a"><mi id="S4.SS3.p1.5.m5.1.1" xref="S4.SS3.p1.5.m5.1.1.cmml">c</mi><annotation-xml encoding="MathML-Content" id="S4.SS3.p1.5.m5.1b"><ci id="S4.SS3.p1.5.m5.1.1.cmml" xref="S4.SS3.p1.5.m5.1.1">𝑐</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p1.5.m5.1c">c</annotation></semantics></math>:</p>
<table id="S4.E3" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S4.E3.m1.7" class="ltx_Math" alttext="\mathbf{p_{c}}=g(\mathcal{F}_{c}),\;\mathcal{F}_{c}\!=\ \{\mathbf{f}=E(\mathbf{x})(h,w):\;\hat{\mathbf{y}}(h,w)=c\}" display="block"><semantics id="S4.E3.m1.7a"><mrow id="S4.E3.m1.7.7.2" xref="S4.E3.m1.7.7.3.cmml"><mrow id="S4.E3.m1.6.6.1.1" xref="S4.E3.m1.6.6.1.1.cmml"><msub id="S4.E3.m1.6.6.1.1.3" xref="S4.E3.m1.6.6.1.1.3.cmml"><mi id="S4.E3.m1.6.6.1.1.3.2" xref="S4.E3.m1.6.6.1.1.3.2.cmml">𝐩</mi><mi id="S4.E3.m1.6.6.1.1.3.3" xref="S4.E3.m1.6.6.1.1.3.3.cmml">𝐜</mi></msub><mo id="S4.E3.m1.6.6.1.1.2" xref="S4.E3.m1.6.6.1.1.2.cmml">=</mo><mrow id="S4.E3.m1.6.6.1.1.1" xref="S4.E3.m1.6.6.1.1.1.cmml"><mi id="S4.E3.m1.6.6.1.1.1.3" xref="S4.E3.m1.6.6.1.1.1.3.cmml">g</mi><mo lspace="0em" rspace="0em" id="S4.E3.m1.6.6.1.1.1.2" xref="S4.E3.m1.6.6.1.1.1.2.cmml">​</mo><mrow id="S4.E3.m1.6.6.1.1.1.1.1" xref="S4.E3.m1.6.6.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S4.E3.m1.6.6.1.1.1.1.1.2" xref="S4.E3.m1.6.6.1.1.1.1.1.1.cmml">(</mo><msub id="S4.E3.m1.6.6.1.1.1.1.1.1" xref="S4.E3.m1.6.6.1.1.1.1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.E3.m1.6.6.1.1.1.1.1.1.2" xref="S4.E3.m1.6.6.1.1.1.1.1.1.2.cmml">ℱ</mi><mi id="S4.E3.m1.6.6.1.1.1.1.1.1.3" xref="S4.E3.m1.6.6.1.1.1.1.1.1.3.cmml">c</mi></msub><mo stretchy="false" id="S4.E3.m1.6.6.1.1.1.1.1.3" xref="S4.E3.m1.6.6.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><mo rspace="0.447em" id="S4.E3.m1.7.7.2.3" xref="S4.E3.m1.7.7.3a.cmml">,</mo><mrow id="S4.E3.m1.7.7.2.2" xref="S4.E3.m1.7.7.2.2.cmml"><msub id="S4.E3.m1.7.7.2.2.4" xref="S4.E3.m1.7.7.2.2.4.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.E3.m1.7.7.2.2.4.2" xref="S4.E3.m1.7.7.2.2.4.2.cmml">ℱ</mi><mi id="S4.E3.m1.7.7.2.2.4.3" xref="S4.E3.m1.7.7.2.2.4.3.cmml">c</mi></msub><mo rspace="0.778em" id="S4.E3.m1.7.7.2.2.3" xref="S4.E3.m1.7.7.2.2.3.cmml">=</mo><mrow id="S4.E3.m1.7.7.2.2.2.2" xref="S4.E3.m1.7.7.2.2.2.3.cmml"><mo stretchy="false" id="S4.E3.m1.7.7.2.2.2.2.3" xref="S4.E3.m1.7.7.2.2.2.3.1.cmml">{</mo><mrow id="S4.E3.m1.7.7.2.2.1.1.1" xref="S4.E3.m1.7.7.2.2.1.1.1.cmml"><mi id="S4.E3.m1.7.7.2.2.1.1.1.2" xref="S4.E3.m1.7.7.2.2.1.1.1.2.cmml">𝐟</mi><mo id="S4.E3.m1.7.7.2.2.1.1.1.1" xref="S4.E3.m1.7.7.2.2.1.1.1.1.cmml">=</mo><mrow id="S4.E3.m1.7.7.2.2.1.1.1.3" xref="S4.E3.m1.7.7.2.2.1.1.1.3.cmml"><mi id="S4.E3.m1.7.7.2.2.1.1.1.3.2" xref="S4.E3.m1.7.7.2.2.1.1.1.3.2.cmml">E</mi><mo lspace="0em" rspace="0em" id="S4.E3.m1.7.7.2.2.1.1.1.3.1" xref="S4.E3.m1.7.7.2.2.1.1.1.3.1.cmml">​</mo><mrow id="S4.E3.m1.7.7.2.2.1.1.1.3.3.2" xref="S4.E3.m1.7.7.2.2.1.1.1.3.cmml"><mo stretchy="false" id="S4.E3.m1.7.7.2.2.1.1.1.3.3.2.1" xref="S4.E3.m1.7.7.2.2.1.1.1.3.cmml">(</mo><mi id="S4.E3.m1.1.1" xref="S4.E3.m1.1.1.cmml">𝐱</mi><mo stretchy="false" id="S4.E3.m1.7.7.2.2.1.1.1.3.3.2.2" xref="S4.E3.m1.7.7.2.2.1.1.1.3.cmml">)</mo></mrow><mo lspace="0em" rspace="0em" id="S4.E3.m1.7.7.2.2.1.1.1.3.1a" xref="S4.E3.m1.7.7.2.2.1.1.1.3.1.cmml">​</mo><mrow id="S4.E3.m1.7.7.2.2.1.1.1.3.4.2" xref="S4.E3.m1.7.7.2.2.1.1.1.3.4.1.cmml"><mo stretchy="false" id="S4.E3.m1.7.7.2.2.1.1.1.3.4.2.1" xref="S4.E3.m1.7.7.2.2.1.1.1.3.4.1.cmml">(</mo><mi id="S4.E3.m1.2.2" xref="S4.E3.m1.2.2.cmml">h</mi><mo id="S4.E3.m1.7.7.2.2.1.1.1.3.4.2.2" xref="S4.E3.m1.7.7.2.2.1.1.1.3.4.1.cmml">,</mo><mi id="S4.E3.m1.3.3" xref="S4.E3.m1.3.3.cmml">w</mi><mo rspace="0.278em" stretchy="false" id="S4.E3.m1.7.7.2.2.1.1.1.3.4.2.3" xref="S4.E3.m1.7.7.2.2.1.1.1.3.4.1.cmml">)</mo></mrow></mrow></mrow><mo rspace="0.558em" id="S4.E3.m1.7.7.2.2.2.2.4" xref="S4.E3.m1.7.7.2.2.2.3.1.cmml">:</mo><mrow id="S4.E3.m1.7.7.2.2.2.2.2" xref="S4.E3.m1.7.7.2.2.2.2.2.cmml"><mrow id="S4.E3.m1.7.7.2.2.2.2.2.2" xref="S4.E3.m1.7.7.2.2.2.2.2.2.cmml"><mover accent="true" id="S4.E3.m1.7.7.2.2.2.2.2.2.2" xref="S4.E3.m1.7.7.2.2.2.2.2.2.2.cmml"><mi id="S4.E3.m1.7.7.2.2.2.2.2.2.2.2" xref="S4.E3.m1.7.7.2.2.2.2.2.2.2.2.cmml">𝐲</mi><mo id="S4.E3.m1.7.7.2.2.2.2.2.2.2.1" xref="S4.E3.m1.7.7.2.2.2.2.2.2.2.1.cmml">^</mo></mover><mo lspace="0em" rspace="0em" id="S4.E3.m1.7.7.2.2.2.2.2.2.1" xref="S4.E3.m1.7.7.2.2.2.2.2.2.1.cmml">​</mo><mrow id="S4.E3.m1.7.7.2.2.2.2.2.2.3.2" xref="S4.E3.m1.7.7.2.2.2.2.2.2.3.1.cmml"><mo stretchy="false" id="S4.E3.m1.7.7.2.2.2.2.2.2.3.2.1" xref="S4.E3.m1.7.7.2.2.2.2.2.2.3.1.cmml">(</mo><mi id="S4.E3.m1.4.4" xref="S4.E3.m1.4.4.cmml">h</mi><mo id="S4.E3.m1.7.7.2.2.2.2.2.2.3.2.2" xref="S4.E3.m1.7.7.2.2.2.2.2.2.3.1.cmml">,</mo><mi id="S4.E3.m1.5.5" xref="S4.E3.m1.5.5.cmml">w</mi><mo stretchy="false" id="S4.E3.m1.7.7.2.2.2.2.2.2.3.2.3" xref="S4.E3.m1.7.7.2.2.2.2.2.2.3.1.cmml">)</mo></mrow></mrow><mo id="S4.E3.m1.7.7.2.2.2.2.2.1" xref="S4.E3.m1.7.7.2.2.2.2.2.1.cmml">=</mo><mi id="S4.E3.m1.7.7.2.2.2.2.2.3" xref="S4.E3.m1.7.7.2.2.2.2.2.3.cmml">c</mi></mrow><mo stretchy="false" id="S4.E3.m1.7.7.2.2.2.2.5" xref="S4.E3.m1.7.7.2.2.2.3.1.cmml">}</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.E3.m1.7b"><apply id="S4.E3.m1.7.7.3.cmml" xref="S4.E3.m1.7.7.2"><csymbol cd="ambiguous" id="S4.E3.m1.7.7.3a.cmml" xref="S4.E3.m1.7.7.2.3">formulae-sequence</csymbol><apply id="S4.E3.m1.6.6.1.1.cmml" xref="S4.E3.m1.6.6.1.1"><eq id="S4.E3.m1.6.6.1.1.2.cmml" xref="S4.E3.m1.6.6.1.1.2"></eq><apply id="S4.E3.m1.6.6.1.1.3.cmml" xref="S4.E3.m1.6.6.1.1.3"><csymbol cd="ambiguous" id="S4.E3.m1.6.6.1.1.3.1.cmml" xref="S4.E3.m1.6.6.1.1.3">subscript</csymbol><ci id="S4.E3.m1.6.6.1.1.3.2.cmml" xref="S4.E3.m1.6.6.1.1.3.2">𝐩</ci><ci id="S4.E3.m1.6.6.1.1.3.3.cmml" xref="S4.E3.m1.6.6.1.1.3.3">𝐜</ci></apply><apply id="S4.E3.m1.6.6.1.1.1.cmml" xref="S4.E3.m1.6.6.1.1.1"><times id="S4.E3.m1.6.6.1.1.1.2.cmml" xref="S4.E3.m1.6.6.1.1.1.2"></times><ci id="S4.E3.m1.6.6.1.1.1.3.cmml" xref="S4.E3.m1.6.6.1.1.1.3">𝑔</ci><apply id="S4.E3.m1.6.6.1.1.1.1.1.1.cmml" xref="S4.E3.m1.6.6.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.E3.m1.6.6.1.1.1.1.1.1.1.cmml" xref="S4.E3.m1.6.6.1.1.1.1.1">subscript</csymbol><ci id="S4.E3.m1.6.6.1.1.1.1.1.1.2.cmml" xref="S4.E3.m1.6.6.1.1.1.1.1.1.2">ℱ</ci><ci id="S4.E3.m1.6.6.1.1.1.1.1.1.3.cmml" xref="S4.E3.m1.6.6.1.1.1.1.1.1.3">𝑐</ci></apply></apply></apply><apply id="S4.E3.m1.7.7.2.2.cmml" xref="S4.E3.m1.7.7.2.2"><eq id="S4.E3.m1.7.7.2.2.3.cmml" xref="S4.E3.m1.7.7.2.2.3"></eq><apply id="S4.E3.m1.7.7.2.2.4.cmml" xref="S4.E3.m1.7.7.2.2.4"><csymbol cd="ambiguous" id="S4.E3.m1.7.7.2.2.4.1.cmml" xref="S4.E3.m1.7.7.2.2.4">subscript</csymbol><ci id="S4.E3.m1.7.7.2.2.4.2.cmml" xref="S4.E3.m1.7.7.2.2.4.2">ℱ</ci><ci id="S4.E3.m1.7.7.2.2.4.3.cmml" xref="S4.E3.m1.7.7.2.2.4.3">𝑐</ci></apply><apply id="S4.E3.m1.7.7.2.2.2.3.cmml" xref="S4.E3.m1.7.7.2.2.2.2"><csymbol cd="latexml" id="S4.E3.m1.7.7.2.2.2.3.1.cmml" xref="S4.E3.m1.7.7.2.2.2.2.3">conditional-set</csymbol><apply id="S4.E3.m1.7.7.2.2.1.1.1.cmml" xref="S4.E3.m1.7.7.2.2.1.1.1"><eq id="S4.E3.m1.7.7.2.2.1.1.1.1.cmml" xref="S4.E3.m1.7.7.2.2.1.1.1.1"></eq><ci id="S4.E3.m1.7.7.2.2.1.1.1.2.cmml" xref="S4.E3.m1.7.7.2.2.1.1.1.2">𝐟</ci><apply id="S4.E3.m1.7.7.2.2.1.1.1.3.cmml" xref="S4.E3.m1.7.7.2.2.1.1.1.3"><times id="S4.E3.m1.7.7.2.2.1.1.1.3.1.cmml" xref="S4.E3.m1.7.7.2.2.1.1.1.3.1"></times><ci id="S4.E3.m1.7.7.2.2.1.1.1.3.2.cmml" xref="S4.E3.m1.7.7.2.2.1.1.1.3.2">𝐸</ci><ci id="S4.E3.m1.1.1.cmml" xref="S4.E3.m1.1.1">𝐱</ci><interval closure="open" id="S4.E3.m1.7.7.2.2.1.1.1.3.4.1.cmml" xref="S4.E3.m1.7.7.2.2.1.1.1.3.4.2"><ci id="S4.E3.m1.2.2.cmml" xref="S4.E3.m1.2.2">ℎ</ci><ci id="S4.E3.m1.3.3.cmml" xref="S4.E3.m1.3.3">𝑤</ci></interval></apply></apply><apply id="S4.E3.m1.7.7.2.2.2.2.2.cmml" xref="S4.E3.m1.7.7.2.2.2.2.2"><eq id="S4.E3.m1.7.7.2.2.2.2.2.1.cmml" xref="S4.E3.m1.7.7.2.2.2.2.2.1"></eq><apply id="S4.E3.m1.7.7.2.2.2.2.2.2.cmml" xref="S4.E3.m1.7.7.2.2.2.2.2.2"><times id="S4.E3.m1.7.7.2.2.2.2.2.2.1.cmml" xref="S4.E3.m1.7.7.2.2.2.2.2.2.1"></times><apply id="S4.E3.m1.7.7.2.2.2.2.2.2.2.cmml" xref="S4.E3.m1.7.7.2.2.2.2.2.2.2"><ci id="S4.E3.m1.7.7.2.2.2.2.2.2.2.1.cmml" xref="S4.E3.m1.7.7.2.2.2.2.2.2.2.1">^</ci><ci id="S4.E3.m1.7.7.2.2.2.2.2.2.2.2.cmml" xref="S4.E3.m1.7.7.2.2.2.2.2.2.2.2">𝐲</ci></apply><interval closure="open" id="S4.E3.m1.7.7.2.2.2.2.2.2.3.1.cmml" xref="S4.E3.m1.7.7.2.2.2.2.2.2.3.2"><ci id="S4.E3.m1.4.4.cmml" xref="S4.E3.m1.4.4">ℎ</ci><ci id="S4.E3.m1.5.5.cmml" xref="S4.E3.m1.5.5">𝑤</ci></interval></apply><ci id="S4.E3.m1.7.7.2.2.2.2.2.3.cmml" xref="S4.E3.m1.7.7.2.2.2.2.2.3">𝑐</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.E3.m1.7c">\mathbf{p_{c}}=g(\mathcal{F}_{c}),\;\mathcal{F}_{c}\!=\ \{\mathbf{f}=E(\mathbf{x})(h,w):\;\hat{\mathbf{y}}(h,w)=c\}</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(3)</span></td>
</tr></tbody>
</table>
<p id="S4.SS3.p1.7" class="ltx_p">where <math id="S4.SS3.p1.6.m1.1" class="ltx_Math" alttext="\hat{\mathbf{y}}" display="inline"><semantics id="S4.SS3.p1.6.m1.1a"><mover accent="true" id="S4.SS3.p1.6.m1.1.1" xref="S4.SS3.p1.6.m1.1.1.cmml"><mi id="S4.SS3.p1.6.m1.1.1.2" xref="S4.SS3.p1.6.m1.1.1.2.cmml">𝐲</mi><mo id="S4.SS3.p1.6.m1.1.1.1" xref="S4.SS3.p1.6.m1.1.1.1.cmml">^</mo></mover><annotation-xml encoding="MathML-Content" id="S4.SS3.p1.6.m1.1b"><apply id="S4.SS3.p1.6.m1.1.1.cmml" xref="S4.SS3.p1.6.m1.1.1"><ci id="S4.SS3.p1.6.m1.1.1.1.cmml" xref="S4.SS3.p1.6.m1.1.1.1">^</ci><ci id="S4.SS3.p1.6.m1.1.1.2.cmml" xref="S4.SS3.p1.6.m1.1.1.2">𝐲</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p1.6.m1.1c">\hat{\mathbf{y}}</annotation></semantics></math> are the teacher pseudo-labels subsampled at the feature space resolution and the function <math id="S4.SS3.p1.7.m2.1" class="ltx_Math" alttext="g" display="inline"><semantics id="S4.SS3.p1.7.m2.1a"><mi id="S4.SS3.p1.7.m2.1.1" xref="S4.SS3.p1.7.m2.1.1.cmml">g</mi><annotation-xml encoding="MathML-Content" id="S4.SS3.p1.7.m2.1b"><ci id="S4.SS3.p1.7.m2.1.1.cmml" xref="S4.SS3.p1.7.m2.1.1">𝑔</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p1.7.m2.1c">g</annotation></semantics></math> computes either the mean or the midpoint depending on the considered manifold: Euclidean or Poincaré Ball, respectively.</p>
</div>
<div id="S4.SS3.p2" class="ltx_para">
<p id="S4.SS3.p2.5" class="ltx_p">At the beginning of each round <math id="S4.SS3.p2.1.m1.1" class="ltx_Math" alttext="r" display="inline"><semantics id="S4.SS3.p2.1.m1.1a"><mi id="S4.SS3.p2.1.m1.1.1" xref="S4.SS3.p2.1.m1.1.1.cmml">r</mi><annotation-xml encoding="MathML-Content" id="S4.SS3.p2.1.m1.1b"><ci id="S4.SS3.p2.1.m1.1.1.cmml" xref="S4.SS3.p2.1.m1.1.1">𝑟</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p2.1.m1.1c">r</annotation></semantics></math>, a participating client <math id="S4.SS3.p2.2.m2.1" class="ltx_Math" alttext="k" display="inline"><semantics id="S4.SS3.p2.2.m2.1a"><mi id="S4.SS3.p2.2.m2.1.1" xref="S4.SS3.p2.2.m2.1.1.cmml">k</mi><annotation-xml encoding="MathML-Content" id="S4.SS3.p2.2.m2.1b"><ci id="S4.SS3.p2.2.m2.1.1.cmml" xref="S4.SS3.p2.2.m2.1.1">𝑘</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p2.2.m2.1c">k</annotation></semantics></math> initializes its local prototypes <math id="S4.SS3.p2.3.m3.2" class="ltx_Math" alttext="\mathbf{p_{k,c}^{r}}" display="inline"><semantics id="S4.SS3.p2.3.m3.2a"><msubsup id="S4.SS3.p2.3.m3.2.3" xref="S4.SS3.p2.3.m3.2.3.cmml"><mi id="S4.SS3.p2.3.m3.2.3.2.2" xref="S4.SS3.p2.3.m3.2.3.2.2.cmml">𝐩</mi><mrow id="S4.SS3.p2.3.m3.2.2.2.4" xref="S4.SS3.p2.3.m3.2.2.2.3.cmml"><mi id="S4.SS3.p2.3.m3.1.1.1.1" xref="S4.SS3.p2.3.m3.1.1.1.1.cmml">𝐤</mi><mo id="S4.SS3.p2.3.m3.2.2.2.4.1" xref="S4.SS3.p2.3.m3.2.2.2.3.cmml">,</mo><mi id="S4.SS3.p2.3.m3.2.2.2.2" xref="S4.SS3.p2.3.m3.2.2.2.2.cmml">𝐜</mi></mrow><mi id="S4.SS3.p2.3.m3.2.3.3" xref="S4.SS3.p2.3.m3.2.3.3.cmml">𝐫</mi></msubsup><annotation-xml encoding="MathML-Content" id="S4.SS3.p2.3.m3.2b"><apply id="S4.SS3.p2.3.m3.2.3.cmml" xref="S4.SS3.p2.3.m3.2.3"><csymbol cd="ambiguous" id="S4.SS3.p2.3.m3.2.3.1.cmml" xref="S4.SS3.p2.3.m3.2.3">superscript</csymbol><apply id="S4.SS3.p2.3.m3.2.3.2.cmml" xref="S4.SS3.p2.3.m3.2.3"><csymbol cd="ambiguous" id="S4.SS3.p2.3.m3.2.3.2.1.cmml" xref="S4.SS3.p2.3.m3.2.3">subscript</csymbol><ci id="S4.SS3.p2.3.m3.2.3.2.2.cmml" xref="S4.SS3.p2.3.m3.2.3.2.2">𝐩</ci><list id="S4.SS3.p2.3.m3.2.2.2.3.cmml" xref="S4.SS3.p2.3.m3.2.2.2.4"><ci id="S4.SS3.p2.3.m3.1.1.1.1.cmml" xref="S4.SS3.p2.3.m3.1.1.1.1">𝐤</ci><ci id="S4.SS3.p2.3.m3.2.2.2.2.cmml" xref="S4.SS3.p2.3.m3.2.2.2.2">𝐜</ci></list></apply><ci id="S4.SS3.p2.3.m3.2.3.3.cmml" xref="S4.SS3.p2.3.m3.2.3.3">𝐫</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p2.3.m3.2c">\mathbf{p_{k,c}^{r}}</annotation></semantics></math> using the previous round ones received from the server: <math id="S4.SS3.p2.4.m4.4" class="ltx_Math" alttext="\mathbf{p_{k,c}^{r}}=\mathbf{p_{G,c}^{r-1}}" display="inline"><semantics id="S4.SS3.p2.4.m4.4a"><mrow id="S4.SS3.p2.4.m4.4.5" xref="S4.SS3.p2.4.m4.4.5.cmml"><msubsup id="S4.SS3.p2.4.m4.4.5.2" xref="S4.SS3.p2.4.m4.4.5.2.cmml"><mi id="S4.SS3.p2.4.m4.4.5.2.2.2" xref="S4.SS3.p2.4.m4.4.5.2.2.2.cmml">𝐩</mi><mrow id="S4.SS3.p2.4.m4.2.2.2.4" xref="S4.SS3.p2.4.m4.2.2.2.3.cmml"><mi id="S4.SS3.p2.4.m4.1.1.1.1" xref="S4.SS3.p2.4.m4.1.1.1.1.cmml">𝐤</mi><mo id="S4.SS3.p2.4.m4.2.2.2.4.1" xref="S4.SS3.p2.4.m4.2.2.2.3.cmml">,</mo><mi id="S4.SS3.p2.4.m4.2.2.2.2" xref="S4.SS3.p2.4.m4.2.2.2.2.cmml">𝐜</mi></mrow><mi id="S4.SS3.p2.4.m4.4.5.2.3" xref="S4.SS3.p2.4.m4.4.5.2.3.cmml">𝐫</mi></msubsup><mo id="S4.SS3.p2.4.m4.4.5.1" xref="S4.SS3.p2.4.m4.4.5.1.cmml">=</mo><msubsup id="S4.SS3.p2.4.m4.4.5.3" xref="S4.SS3.p2.4.m4.4.5.3.cmml"><mi id="S4.SS3.p2.4.m4.4.5.3.2.2" xref="S4.SS3.p2.4.m4.4.5.3.2.2.cmml">𝐩</mi><mrow id="S4.SS3.p2.4.m4.4.4.2.4" xref="S4.SS3.p2.4.m4.4.4.2.3.cmml"><mi id="S4.SS3.p2.4.m4.3.3.1.1" xref="S4.SS3.p2.4.m4.3.3.1.1.cmml">𝐆</mi><mo id="S4.SS3.p2.4.m4.4.4.2.4.1" xref="S4.SS3.p2.4.m4.4.4.2.3.cmml">,</mo><mi id="S4.SS3.p2.4.m4.4.4.2.2" xref="S4.SS3.p2.4.m4.4.4.2.2.cmml">𝐜</mi></mrow><mrow id="S4.SS3.p2.4.m4.4.5.3.3" xref="S4.SS3.p2.4.m4.4.5.3.3.cmml"><mi id="S4.SS3.p2.4.m4.4.5.3.3.2" xref="S4.SS3.p2.4.m4.4.5.3.3.2.cmml">𝐫</mi><mo id="S4.SS3.p2.4.m4.4.5.3.3.1" xref="S4.SS3.p2.4.m4.4.5.3.3.1.cmml">−</mo><mn id="S4.SS3.p2.4.m4.4.5.3.3.3" xref="S4.SS3.p2.4.m4.4.5.3.3.3.cmml">𝟏</mn></mrow></msubsup></mrow><annotation-xml encoding="MathML-Content" id="S4.SS3.p2.4.m4.4b"><apply id="S4.SS3.p2.4.m4.4.5.cmml" xref="S4.SS3.p2.4.m4.4.5"><eq id="S4.SS3.p2.4.m4.4.5.1.cmml" xref="S4.SS3.p2.4.m4.4.5.1"></eq><apply id="S4.SS3.p2.4.m4.4.5.2.cmml" xref="S4.SS3.p2.4.m4.4.5.2"><csymbol cd="ambiguous" id="S4.SS3.p2.4.m4.4.5.2.1.cmml" xref="S4.SS3.p2.4.m4.4.5.2">superscript</csymbol><apply id="S4.SS3.p2.4.m4.4.5.2.2.cmml" xref="S4.SS3.p2.4.m4.4.5.2"><csymbol cd="ambiguous" id="S4.SS3.p2.4.m4.4.5.2.2.1.cmml" xref="S4.SS3.p2.4.m4.4.5.2">subscript</csymbol><ci id="S4.SS3.p2.4.m4.4.5.2.2.2.cmml" xref="S4.SS3.p2.4.m4.4.5.2.2.2">𝐩</ci><list id="S4.SS3.p2.4.m4.2.2.2.3.cmml" xref="S4.SS3.p2.4.m4.2.2.2.4"><ci id="S4.SS3.p2.4.m4.1.1.1.1.cmml" xref="S4.SS3.p2.4.m4.1.1.1.1">𝐤</ci><ci id="S4.SS3.p2.4.m4.2.2.2.2.cmml" xref="S4.SS3.p2.4.m4.2.2.2.2">𝐜</ci></list></apply><ci id="S4.SS3.p2.4.m4.4.5.2.3.cmml" xref="S4.SS3.p2.4.m4.4.5.2.3">𝐫</ci></apply><apply id="S4.SS3.p2.4.m4.4.5.3.cmml" xref="S4.SS3.p2.4.m4.4.5.3"><csymbol cd="ambiguous" id="S4.SS3.p2.4.m4.4.5.3.1.cmml" xref="S4.SS3.p2.4.m4.4.5.3">superscript</csymbol><apply id="S4.SS3.p2.4.m4.4.5.3.2.cmml" xref="S4.SS3.p2.4.m4.4.5.3"><csymbol cd="ambiguous" id="S4.SS3.p2.4.m4.4.5.3.2.1.cmml" xref="S4.SS3.p2.4.m4.4.5.3">subscript</csymbol><ci id="S4.SS3.p2.4.m4.4.5.3.2.2.cmml" xref="S4.SS3.p2.4.m4.4.5.3.2.2">𝐩</ci><list id="S4.SS3.p2.4.m4.4.4.2.3.cmml" xref="S4.SS3.p2.4.m4.4.4.2.4"><ci id="S4.SS3.p2.4.m4.3.3.1.1.cmml" xref="S4.SS3.p2.4.m4.3.3.1.1">𝐆</ci><ci id="S4.SS3.p2.4.m4.4.4.2.2.cmml" xref="S4.SS3.p2.4.m4.4.4.2.2">𝐜</ci></list></apply><apply id="S4.SS3.p2.4.m4.4.5.3.3.cmml" xref="S4.SS3.p2.4.m4.4.5.3.3"><minus id="S4.SS3.p2.4.m4.4.5.3.3.1.cmml" xref="S4.SS3.p2.4.m4.4.5.3.3.1"></minus><ci id="S4.SS3.p2.4.m4.4.5.3.3.2.cmml" xref="S4.SS3.p2.4.m4.4.5.3.3.2">𝐫</ci><cn type="integer" id="S4.SS3.p2.4.m4.4.5.3.3.3.cmml" xref="S4.SS3.p2.4.m4.4.5.3.3.3">1</cn></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p2.4.m4.4c">\mathbf{p_{k,c}^{r}}=\mathbf{p_{G,c}^{r-1}}</annotation></semantics></math> .
Then, the prototypes are updated at training time using exponential smoothing with rate <math id="S4.SS3.p2.5.m5.1" class="ltx_Math" alttext="\beta=0.85" display="inline"><semantics id="S4.SS3.p2.5.m5.1a"><mrow id="S4.SS3.p2.5.m5.1.1" xref="S4.SS3.p2.5.m5.1.1.cmml"><mi id="S4.SS3.p2.5.m5.1.1.2" xref="S4.SS3.p2.5.m5.1.1.2.cmml">β</mi><mo id="S4.SS3.p2.5.m5.1.1.1" xref="S4.SS3.p2.5.m5.1.1.1.cmml">=</mo><mn id="S4.SS3.p2.5.m5.1.1.3" xref="S4.SS3.p2.5.m5.1.1.3.cmml">0.85</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.SS3.p2.5.m5.1b"><apply id="S4.SS3.p2.5.m5.1.1.cmml" xref="S4.SS3.p2.5.m5.1.1"><eq id="S4.SS3.p2.5.m5.1.1.1.cmml" xref="S4.SS3.p2.5.m5.1.1.1"></eq><ci id="S4.SS3.p2.5.m5.1.1.2.cmml" xref="S4.SS3.p2.5.m5.1.1.2">𝛽</ci><cn type="float" id="S4.SS3.p2.5.m5.1.1.3.cmml" xref="S4.SS3.p2.5.m5.1.1.3">0.85</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p2.5.m5.1c">\beta=0.85</annotation></semantics></math> to stabilize their evolution as follows:</p>
<table id="S4.E4" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S4.E4.m1.1" class="ltx_Math" alttext="\mathbf{p_{c}}=\beta\;\mathbf{p^{\prime}_{c}}+(1-\beta)\;\mathbf{p_{c}}" display="block"><semantics id="S4.E4.m1.1a"><mrow id="S4.E4.m1.1.1" xref="S4.E4.m1.1.1.cmml"><msub id="S4.E4.m1.1.1.3" xref="S4.E4.m1.1.1.3.cmml"><mi id="S4.E4.m1.1.1.3.2" xref="S4.E4.m1.1.1.3.2.cmml">𝐩</mi><mi id="S4.E4.m1.1.1.3.3" xref="S4.E4.m1.1.1.3.3.cmml">𝐜</mi></msub><mo id="S4.E4.m1.1.1.2" xref="S4.E4.m1.1.1.2.cmml">=</mo><mrow id="S4.E4.m1.1.1.1" xref="S4.E4.m1.1.1.1.cmml"><mrow id="S4.E4.m1.1.1.1.3" xref="S4.E4.m1.1.1.1.3.cmml"><mi id="S4.E4.m1.1.1.1.3.2" xref="S4.E4.m1.1.1.1.3.2.cmml">β</mi><mo lspace="0.280em" rspace="0em" id="S4.E4.m1.1.1.1.3.1" xref="S4.E4.m1.1.1.1.3.1.cmml">​</mo><msubsup id="S4.E4.m1.1.1.1.3.3" xref="S4.E4.m1.1.1.1.3.3.cmml"><mi id="S4.E4.m1.1.1.1.3.3.2.2" xref="S4.E4.m1.1.1.1.3.3.2.2.cmml">𝐩</mi><mi id="S4.E4.m1.1.1.1.3.3.3" xref="S4.E4.m1.1.1.1.3.3.3.cmml">𝐜</mi><mo id="S4.E4.m1.1.1.1.3.3.2.3" xref="S4.E4.m1.1.1.1.3.3.2.3.cmml">′</mo></msubsup></mrow><mo id="S4.E4.m1.1.1.1.2" xref="S4.E4.m1.1.1.1.2.cmml">+</mo><mrow id="S4.E4.m1.1.1.1.1" xref="S4.E4.m1.1.1.1.1.cmml"><mrow id="S4.E4.m1.1.1.1.1.1.1" xref="S4.E4.m1.1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S4.E4.m1.1.1.1.1.1.1.2" xref="S4.E4.m1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="S4.E4.m1.1.1.1.1.1.1.1" xref="S4.E4.m1.1.1.1.1.1.1.1.cmml"><mn id="S4.E4.m1.1.1.1.1.1.1.1.2" xref="S4.E4.m1.1.1.1.1.1.1.1.2.cmml">1</mn><mo id="S4.E4.m1.1.1.1.1.1.1.1.1" xref="S4.E4.m1.1.1.1.1.1.1.1.1.cmml">−</mo><mi id="S4.E4.m1.1.1.1.1.1.1.1.3" xref="S4.E4.m1.1.1.1.1.1.1.1.3.cmml">β</mi></mrow><mo stretchy="false" id="S4.E4.m1.1.1.1.1.1.1.3" xref="S4.E4.m1.1.1.1.1.1.1.1.cmml">)</mo></mrow><mo lspace="0.280em" rspace="0em" id="S4.E4.m1.1.1.1.1.2" xref="S4.E4.m1.1.1.1.1.2.cmml">​</mo><msub id="S4.E4.m1.1.1.1.1.3" xref="S4.E4.m1.1.1.1.1.3.cmml"><mi id="S4.E4.m1.1.1.1.1.3.2" xref="S4.E4.m1.1.1.1.1.3.2.cmml">𝐩</mi><mi id="S4.E4.m1.1.1.1.1.3.3" xref="S4.E4.m1.1.1.1.1.3.3.cmml">𝐜</mi></msub></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.E4.m1.1b"><apply id="S4.E4.m1.1.1.cmml" xref="S4.E4.m1.1.1"><eq id="S4.E4.m1.1.1.2.cmml" xref="S4.E4.m1.1.1.2"></eq><apply id="S4.E4.m1.1.1.3.cmml" xref="S4.E4.m1.1.1.3"><csymbol cd="ambiguous" id="S4.E4.m1.1.1.3.1.cmml" xref="S4.E4.m1.1.1.3">subscript</csymbol><ci id="S4.E4.m1.1.1.3.2.cmml" xref="S4.E4.m1.1.1.3.2">𝐩</ci><ci id="S4.E4.m1.1.1.3.3.cmml" xref="S4.E4.m1.1.1.3.3">𝐜</ci></apply><apply id="S4.E4.m1.1.1.1.cmml" xref="S4.E4.m1.1.1.1"><plus id="S4.E4.m1.1.1.1.2.cmml" xref="S4.E4.m1.1.1.1.2"></plus><apply id="S4.E4.m1.1.1.1.3.cmml" xref="S4.E4.m1.1.1.1.3"><times id="S4.E4.m1.1.1.1.3.1.cmml" xref="S4.E4.m1.1.1.1.3.1"></times><ci id="S4.E4.m1.1.1.1.3.2.cmml" xref="S4.E4.m1.1.1.1.3.2">𝛽</ci><apply id="S4.E4.m1.1.1.1.3.3.cmml" xref="S4.E4.m1.1.1.1.3.3"><csymbol cd="ambiguous" id="S4.E4.m1.1.1.1.3.3.1.cmml" xref="S4.E4.m1.1.1.1.3.3">subscript</csymbol><apply id="S4.E4.m1.1.1.1.3.3.2.cmml" xref="S4.E4.m1.1.1.1.3.3"><csymbol cd="ambiguous" id="S4.E4.m1.1.1.1.3.3.2.1.cmml" xref="S4.E4.m1.1.1.1.3.3">superscript</csymbol><ci id="S4.E4.m1.1.1.1.3.3.2.2.cmml" xref="S4.E4.m1.1.1.1.3.3.2.2">𝐩</ci><ci id="S4.E4.m1.1.1.1.3.3.2.3.cmml" xref="S4.E4.m1.1.1.1.3.3.2.3">′</ci></apply><ci id="S4.E4.m1.1.1.1.3.3.3.cmml" xref="S4.E4.m1.1.1.1.3.3.3">𝐜</ci></apply></apply><apply id="S4.E4.m1.1.1.1.1.cmml" xref="S4.E4.m1.1.1.1.1"><times id="S4.E4.m1.1.1.1.1.2.cmml" xref="S4.E4.m1.1.1.1.1.2"></times><apply id="S4.E4.m1.1.1.1.1.1.1.1.cmml" xref="S4.E4.m1.1.1.1.1.1.1"><minus id="S4.E4.m1.1.1.1.1.1.1.1.1.cmml" xref="S4.E4.m1.1.1.1.1.1.1.1.1"></minus><cn type="integer" id="S4.E4.m1.1.1.1.1.1.1.1.2.cmml" xref="S4.E4.m1.1.1.1.1.1.1.1.2">1</cn><ci id="S4.E4.m1.1.1.1.1.1.1.1.3.cmml" xref="S4.E4.m1.1.1.1.1.1.1.1.3">𝛽</ci></apply><apply id="S4.E4.m1.1.1.1.1.3.cmml" xref="S4.E4.m1.1.1.1.1.3"><csymbol cd="ambiguous" id="S4.E4.m1.1.1.1.1.3.1.cmml" xref="S4.E4.m1.1.1.1.1.3">subscript</csymbol><ci id="S4.E4.m1.1.1.1.1.3.2.cmml" xref="S4.E4.m1.1.1.1.1.3.2">𝐩</ci><ci id="S4.E4.m1.1.1.1.1.3.3.cmml" xref="S4.E4.m1.1.1.1.1.3.3">𝐜</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.E4.m1.1c">\mathbf{p_{c}}=\beta\;\mathbf{p^{\prime}_{c}}+(1-\beta)\;\mathbf{p_{c}}</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(4)</span></td>
</tr></tbody>
</table>
<p id="S4.SS3.p2.7" class="ltx_p">where <math id="S4.SS3.p2.6.m1.1" class="ltx_Math" alttext="\mathbf{p^{\prime}_{c}}" display="inline"><semantics id="S4.SS3.p2.6.m1.1a"><msubsup id="S4.SS3.p2.6.m1.1.1" xref="S4.SS3.p2.6.m1.1.1.cmml"><mi id="S4.SS3.p2.6.m1.1.1.2.2" xref="S4.SS3.p2.6.m1.1.1.2.2.cmml">𝐩</mi><mi id="S4.SS3.p2.6.m1.1.1.3" xref="S4.SS3.p2.6.m1.1.1.3.cmml">𝐜</mi><mo id="S4.SS3.p2.6.m1.1.1.2.3" xref="S4.SS3.p2.6.m1.1.1.2.3.cmml">′</mo></msubsup><annotation-xml encoding="MathML-Content" id="S4.SS3.p2.6.m1.1b"><apply id="S4.SS3.p2.6.m1.1.1.cmml" xref="S4.SS3.p2.6.m1.1.1"><csymbol cd="ambiguous" id="S4.SS3.p2.6.m1.1.1.1.cmml" xref="S4.SS3.p2.6.m1.1.1">subscript</csymbol><apply id="S4.SS3.p2.6.m1.1.1.2.cmml" xref="S4.SS3.p2.6.m1.1.1"><csymbol cd="ambiguous" id="S4.SS3.p2.6.m1.1.1.2.1.cmml" xref="S4.SS3.p2.6.m1.1.1">superscript</csymbol><ci id="S4.SS3.p2.6.m1.1.1.2.2.cmml" xref="S4.SS3.p2.6.m1.1.1.2.2">𝐩</ci><ci id="S4.SS3.p2.6.m1.1.1.2.3.cmml" xref="S4.SS3.p2.6.m1.1.1.2.3">′</ci></apply><ci id="S4.SS3.p2.6.m1.1.1.3.cmml" xref="S4.SS3.p2.6.m1.1.1.3">𝐜</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p2.6.m1.1c">\mathbf{p^{\prime}_{c}}</annotation></semantics></math> is the prototype from the previous step.
After each round, prototypes <math id="S4.SS3.p2.7.m2.4" class="ltx_Math" alttext="\mathbf{p_{k,c}^{r}},\forall c\in\mathcal{C}" display="inline"><semantics id="S4.SS3.p2.7.m2.4a"><mrow id="S4.SS3.p2.7.m2.4.4" xref="S4.SS3.p2.7.m2.4.4.cmml"><mrow id="S4.SS3.p2.7.m2.4.4.2.2" xref="S4.SS3.p2.7.m2.4.4.2.3.cmml"><msubsup id="S4.SS3.p2.7.m2.3.3.1.1.1" xref="S4.SS3.p2.7.m2.3.3.1.1.1.cmml"><mi id="S4.SS3.p2.7.m2.3.3.1.1.1.2.2" xref="S4.SS3.p2.7.m2.3.3.1.1.1.2.2.cmml">𝐩</mi><mrow id="S4.SS3.p2.7.m2.2.2.2.4" xref="S4.SS3.p2.7.m2.2.2.2.3.cmml"><mi id="S4.SS3.p2.7.m2.1.1.1.1" xref="S4.SS3.p2.7.m2.1.1.1.1.cmml">𝐤</mi><mo id="S4.SS3.p2.7.m2.2.2.2.4.1" xref="S4.SS3.p2.7.m2.2.2.2.3.cmml">,</mo><mi id="S4.SS3.p2.7.m2.2.2.2.2" xref="S4.SS3.p2.7.m2.2.2.2.2.cmml">𝐜</mi></mrow><mi id="S4.SS3.p2.7.m2.3.3.1.1.1.3" xref="S4.SS3.p2.7.m2.3.3.1.1.1.3.cmml">𝐫</mi></msubsup><mo id="S4.SS3.p2.7.m2.4.4.2.2.3" xref="S4.SS3.p2.7.m2.4.4.2.3.cmml">,</mo><mrow id="S4.SS3.p2.7.m2.4.4.2.2.2" xref="S4.SS3.p2.7.m2.4.4.2.2.2.cmml"><mo rspace="0.167em" id="S4.SS3.p2.7.m2.4.4.2.2.2.1" xref="S4.SS3.p2.7.m2.4.4.2.2.2.1.cmml">∀</mo><mi id="S4.SS3.p2.7.m2.4.4.2.2.2.2" xref="S4.SS3.p2.7.m2.4.4.2.2.2.2.cmml">c</mi></mrow></mrow><mo id="S4.SS3.p2.7.m2.4.4.3" xref="S4.SS3.p2.7.m2.4.4.3.cmml">∈</mo><mi class="ltx_font_mathcaligraphic" id="S4.SS3.p2.7.m2.4.4.4" xref="S4.SS3.p2.7.m2.4.4.4.cmml">𝒞</mi></mrow><annotation-xml encoding="MathML-Content" id="S4.SS3.p2.7.m2.4b"><apply id="S4.SS3.p2.7.m2.4.4.cmml" xref="S4.SS3.p2.7.m2.4.4"><in id="S4.SS3.p2.7.m2.4.4.3.cmml" xref="S4.SS3.p2.7.m2.4.4.3"></in><list id="S4.SS3.p2.7.m2.4.4.2.3.cmml" xref="S4.SS3.p2.7.m2.4.4.2.2"><apply id="S4.SS3.p2.7.m2.3.3.1.1.1.cmml" xref="S4.SS3.p2.7.m2.3.3.1.1.1"><csymbol cd="ambiguous" id="S4.SS3.p2.7.m2.3.3.1.1.1.1.cmml" xref="S4.SS3.p2.7.m2.3.3.1.1.1">superscript</csymbol><apply id="S4.SS3.p2.7.m2.3.3.1.1.1.2.cmml" xref="S4.SS3.p2.7.m2.3.3.1.1.1"><csymbol cd="ambiguous" id="S4.SS3.p2.7.m2.3.3.1.1.1.2.1.cmml" xref="S4.SS3.p2.7.m2.3.3.1.1.1">subscript</csymbol><ci id="S4.SS3.p2.7.m2.3.3.1.1.1.2.2.cmml" xref="S4.SS3.p2.7.m2.3.3.1.1.1.2.2">𝐩</ci><list id="S4.SS3.p2.7.m2.2.2.2.3.cmml" xref="S4.SS3.p2.7.m2.2.2.2.4"><ci id="S4.SS3.p2.7.m2.1.1.1.1.cmml" xref="S4.SS3.p2.7.m2.1.1.1.1">𝐤</ci><ci id="S4.SS3.p2.7.m2.2.2.2.2.cmml" xref="S4.SS3.p2.7.m2.2.2.2.2">𝐜</ci></list></apply><ci id="S4.SS3.p2.7.m2.3.3.1.1.1.3.cmml" xref="S4.SS3.p2.7.m2.3.3.1.1.1.3">𝐫</ci></apply><apply id="S4.SS3.p2.7.m2.4.4.2.2.2.cmml" xref="S4.SS3.p2.7.m2.4.4.2.2.2"><csymbol cd="latexml" id="S4.SS3.p2.7.m2.4.4.2.2.2.1.cmml" xref="S4.SS3.p2.7.m2.4.4.2.2.2.1">for-all</csymbol><ci id="S4.SS3.p2.7.m2.4.4.2.2.2.2.cmml" xref="S4.SS3.p2.7.m2.4.4.2.2.2.2">𝑐</ci></apply></list><ci id="S4.SS3.p2.7.m2.4.4.4.cmml" xref="S4.SS3.p2.7.m2.4.4.4">𝒞</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p2.7.m2.4c">\mathbf{p_{k,c}^{r}},\forall c\in\mathcal{C}</annotation></semantics></math> computed by each client are sent back to the server for aggregation.</p>
</div>
<div id="S4.SS3.p3" class="ltx_para ltx_noindent">
<p id="S4.SS3.p3.2" class="ltx_p"><span id="S4.SS3.p3.2.1" class="ltx_text ltx_font_bold">Hyperbolic Protoypes.</span> As mentioned before, to further improve performance, we exploited the capacity of hyperbolic space - specifically of the Poincaré ball model - to fit complex feature geometries better and used it to embed the prototypes.
We refer to <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib29" title="" class="ltx_ref">29</a>, <a href="#bib.bib40" title="" class="ltx_ref">40</a>]</cite> for further discussion.
The hyperbolic space represented in Riemannian geometry, with dimension <math id="S4.SS3.p3.1.m1.1" class="ltx_Math" alttext="n" display="inline"><semantics id="S4.SS3.p3.1.m1.1a"><mi id="S4.SS3.p3.1.m1.1.1" xref="S4.SS3.p3.1.m1.1.1.cmml">n</mi><annotation-xml encoding="MathML-Content" id="S4.SS3.p3.1.m1.1b"><ci id="S4.SS3.p3.1.m1.1.1.cmml" xref="S4.SS3.p3.1.m1.1.1">𝑛</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p3.1.m1.1c">n</annotation></semantics></math> and constant negative curvature <math id="S4.SS3.p3.2.m2.1" class="ltx_Math" alttext="-\gamma" display="inline"><semantics id="S4.SS3.p3.2.m2.1a"><mrow id="S4.SS3.p3.2.m2.1.1" xref="S4.SS3.p3.2.m2.1.1.cmml"><mo id="S4.SS3.p3.2.m2.1.1a" xref="S4.SS3.p3.2.m2.1.1.cmml">−</mo><mi id="S4.SS3.p3.2.m2.1.1.2" xref="S4.SS3.p3.2.m2.1.1.2.cmml">γ</mi></mrow><annotation-xml encoding="MathML-Content" id="S4.SS3.p3.2.m2.1b"><apply id="S4.SS3.p3.2.m2.1.1.cmml" xref="S4.SS3.p3.2.m2.1.1"><minus id="S4.SS3.p3.2.m2.1.1.1.cmml" xref="S4.SS3.p3.2.m2.1.1"></minus><ci id="S4.SS3.p3.2.m2.1.1.2.cmml" xref="S4.SS3.p3.2.m2.1.1.2">𝛾</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p3.2.m2.1c">-\gamma</annotation></semantics></math> is expressed as:</p>
<table id="S4.E5" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S4.E5.m1.3" class="ltx_Math" alttext="\mathbb{B}_{\gamma}^{n}=\{\mathbf{x}\in\mathbb{R}^{n}:\|\mathbf{x}\|^{2}&lt;1/\gamma\}" display="block"><semantics id="S4.E5.m1.3a"><mrow id="S4.E5.m1.3.3" xref="S4.E5.m1.3.3.cmml"><msubsup id="S4.E5.m1.3.3.4" xref="S4.E5.m1.3.3.4.cmml"><mi id="S4.E5.m1.3.3.4.2.2" xref="S4.E5.m1.3.3.4.2.2.cmml">𝔹</mi><mi id="S4.E5.m1.3.3.4.2.3" xref="S4.E5.m1.3.3.4.2.3.cmml">γ</mi><mi id="S4.E5.m1.3.3.4.3" xref="S4.E5.m1.3.3.4.3.cmml">n</mi></msubsup><mo id="S4.E5.m1.3.3.3" xref="S4.E5.m1.3.3.3.cmml">=</mo><mrow id="S4.E5.m1.3.3.2.2" xref="S4.E5.m1.3.3.2.3.cmml"><mo stretchy="false" id="S4.E5.m1.3.3.2.2.3" xref="S4.E5.m1.3.3.2.3.1.cmml">{</mo><mrow id="S4.E5.m1.2.2.1.1.1" xref="S4.E5.m1.2.2.1.1.1.cmml"><mi id="S4.E5.m1.2.2.1.1.1.2" xref="S4.E5.m1.2.2.1.1.1.2.cmml">𝐱</mi><mo id="S4.E5.m1.2.2.1.1.1.1" xref="S4.E5.m1.2.2.1.1.1.1.cmml">∈</mo><msup id="S4.E5.m1.2.2.1.1.1.3" xref="S4.E5.m1.2.2.1.1.1.3.cmml"><mi id="S4.E5.m1.2.2.1.1.1.3.2" xref="S4.E5.m1.2.2.1.1.1.3.2.cmml">ℝ</mi><mi id="S4.E5.m1.2.2.1.1.1.3.3" xref="S4.E5.m1.2.2.1.1.1.3.3.cmml">n</mi></msup></mrow><mo lspace="0.278em" rspace="0.278em" id="S4.E5.m1.3.3.2.2.4" xref="S4.E5.m1.3.3.2.3.1.cmml">:</mo><mrow id="S4.E5.m1.3.3.2.2.2" xref="S4.E5.m1.3.3.2.2.2.cmml"><msup id="S4.E5.m1.3.3.2.2.2.2" xref="S4.E5.m1.3.3.2.2.2.2.cmml"><mrow id="S4.E5.m1.3.3.2.2.2.2.2.2" xref="S4.E5.m1.3.3.2.2.2.2.2.1.cmml"><mo stretchy="false" id="S4.E5.m1.3.3.2.2.2.2.2.2.1" xref="S4.E5.m1.3.3.2.2.2.2.2.1.1.cmml">‖</mo><mi id="S4.E5.m1.1.1" xref="S4.E5.m1.1.1.cmml">𝐱</mi><mo stretchy="false" id="S4.E5.m1.3.3.2.2.2.2.2.2.2" xref="S4.E5.m1.3.3.2.2.2.2.2.1.1.cmml">‖</mo></mrow><mn id="S4.E5.m1.3.3.2.2.2.2.3" xref="S4.E5.m1.3.3.2.2.2.2.3.cmml">2</mn></msup><mo id="S4.E5.m1.3.3.2.2.2.1" xref="S4.E5.m1.3.3.2.2.2.1.cmml">&lt;</mo><mrow id="S4.E5.m1.3.3.2.2.2.3" xref="S4.E5.m1.3.3.2.2.2.3.cmml"><mn id="S4.E5.m1.3.3.2.2.2.3.2" xref="S4.E5.m1.3.3.2.2.2.3.2.cmml">1</mn><mo id="S4.E5.m1.3.3.2.2.2.3.1" xref="S4.E5.m1.3.3.2.2.2.3.1.cmml">/</mo><mi id="S4.E5.m1.3.3.2.2.2.3.3" xref="S4.E5.m1.3.3.2.2.2.3.3.cmml">γ</mi></mrow></mrow><mo stretchy="false" id="S4.E5.m1.3.3.2.2.5" xref="S4.E5.m1.3.3.2.3.1.cmml">}</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.E5.m1.3b"><apply id="S4.E5.m1.3.3.cmml" xref="S4.E5.m1.3.3"><eq id="S4.E5.m1.3.3.3.cmml" xref="S4.E5.m1.3.3.3"></eq><apply id="S4.E5.m1.3.3.4.cmml" xref="S4.E5.m1.3.3.4"><csymbol cd="ambiguous" id="S4.E5.m1.3.3.4.1.cmml" xref="S4.E5.m1.3.3.4">superscript</csymbol><apply id="S4.E5.m1.3.3.4.2.cmml" xref="S4.E5.m1.3.3.4"><csymbol cd="ambiguous" id="S4.E5.m1.3.3.4.2.1.cmml" xref="S4.E5.m1.3.3.4">subscript</csymbol><ci id="S4.E5.m1.3.3.4.2.2.cmml" xref="S4.E5.m1.3.3.4.2.2">𝔹</ci><ci id="S4.E5.m1.3.3.4.2.3.cmml" xref="S4.E5.m1.3.3.4.2.3">𝛾</ci></apply><ci id="S4.E5.m1.3.3.4.3.cmml" xref="S4.E5.m1.3.3.4.3">𝑛</ci></apply><apply id="S4.E5.m1.3.3.2.3.cmml" xref="S4.E5.m1.3.3.2.2"><csymbol cd="latexml" id="S4.E5.m1.3.3.2.3.1.cmml" xref="S4.E5.m1.3.3.2.2.3">conditional-set</csymbol><apply id="S4.E5.m1.2.2.1.1.1.cmml" xref="S4.E5.m1.2.2.1.1.1"><in id="S4.E5.m1.2.2.1.1.1.1.cmml" xref="S4.E5.m1.2.2.1.1.1.1"></in><ci id="S4.E5.m1.2.2.1.1.1.2.cmml" xref="S4.E5.m1.2.2.1.1.1.2">𝐱</ci><apply id="S4.E5.m1.2.2.1.1.1.3.cmml" xref="S4.E5.m1.2.2.1.1.1.3"><csymbol cd="ambiguous" id="S4.E5.m1.2.2.1.1.1.3.1.cmml" xref="S4.E5.m1.2.2.1.1.1.3">superscript</csymbol><ci id="S4.E5.m1.2.2.1.1.1.3.2.cmml" xref="S4.E5.m1.2.2.1.1.1.3.2">ℝ</ci><ci id="S4.E5.m1.2.2.1.1.1.3.3.cmml" xref="S4.E5.m1.2.2.1.1.1.3.3">𝑛</ci></apply></apply><apply id="S4.E5.m1.3.3.2.2.2.cmml" xref="S4.E5.m1.3.3.2.2.2"><lt id="S4.E5.m1.3.3.2.2.2.1.cmml" xref="S4.E5.m1.3.3.2.2.2.1"></lt><apply id="S4.E5.m1.3.3.2.2.2.2.cmml" xref="S4.E5.m1.3.3.2.2.2.2"><csymbol cd="ambiguous" id="S4.E5.m1.3.3.2.2.2.2.1.cmml" xref="S4.E5.m1.3.3.2.2.2.2">superscript</csymbol><apply id="S4.E5.m1.3.3.2.2.2.2.2.1.cmml" xref="S4.E5.m1.3.3.2.2.2.2.2.2"><csymbol cd="latexml" id="S4.E5.m1.3.3.2.2.2.2.2.1.1.cmml" xref="S4.E5.m1.3.3.2.2.2.2.2.2.1">norm</csymbol><ci id="S4.E5.m1.1.1.cmml" xref="S4.E5.m1.1.1">𝐱</ci></apply><cn type="integer" id="S4.E5.m1.3.3.2.2.2.2.3.cmml" xref="S4.E5.m1.3.3.2.2.2.2.3">2</cn></apply><apply id="S4.E5.m1.3.3.2.2.2.3.cmml" xref="S4.E5.m1.3.3.2.2.2.3"><divide id="S4.E5.m1.3.3.2.2.2.3.1.cmml" xref="S4.E5.m1.3.3.2.2.2.3.1"></divide><cn type="integer" id="S4.E5.m1.3.3.2.2.2.3.2.cmml" xref="S4.E5.m1.3.3.2.2.2.3.2">1</cn><ci id="S4.E5.m1.3.3.2.2.2.3.3.cmml" xref="S4.E5.m1.3.3.2.2.2.3.3">𝛾</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.E5.m1.3c">\mathbb{B}_{\gamma}^{n}=\{\mathbf{x}\in\mathbb{R}^{n}:\|\mathbf{x}\|^{2}&lt;1/\gamma\}</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(5)</span></td>
</tr></tbody>
</table>
<p id="S4.SS3.p3.4" class="ltx_p">On such space, the distance between two points <math id="S4.SS3.p3.3.m1.1" class="ltx_Math" alttext="\mathbf{x}" display="inline"><semantics id="S4.SS3.p3.3.m1.1a"><mi id="S4.SS3.p3.3.m1.1.1" xref="S4.SS3.p3.3.m1.1.1.cmml">𝐱</mi><annotation-xml encoding="MathML-Content" id="S4.SS3.p3.3.m1.1b"><ci id="S4.SS3.p3.3.m1.1.1.cmml" xref="S4.SS3.p3.3.m1.1.1">𝐱</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p3.3.m1.1c">\mathbf{x}</annotation></semantics></math>, <math id="S4.SS3.p3.4.m2.1" class="ltx_Math" alttext="\mathbf{y}\in\mathbb{B}_{\gamma}^{n}" display="inline"><semantics id="S4.SS3.p3.4.m2.1a"><mrow id="S4.SS3.p3.4.m2.1.1" xref="S4.SS3.p3.4.m2.1.1.cmml"><mi id="S4.SS3.p3.4.m2.1.1.2" xref="S4.SS3.p3.4.m2.1.1.2.cmml">𝐲</mi><mo id="S4.SS3.p3.4.m2.1.1.1" xref="S4.SS3.p3.4.m2.1.1.1.cmml">∈</mo><msubsup id="S4.SS3.p3.4.m2.1.1.3" xref="S4.SS3.p3.4.m2.1.1.3.cmml"><mi id="S4.SS3.p3.4.m2.1.1.3.2.2" xref="S4.SS3.p3.4.m2.1.1.3.2.2.cmml">𝔹</mi><mi id="S4.SS3.p3.4.m2.1.1.3.2.3" xref="S4.SS3.p3.4.m2.1.1.3.2.3.cmml">γ</mi><mi id="S4.SS3.p3.4.m2.1.1.3.3" xref="S4.SS3.p3.4.m2.1.1.3.3.cmml">n</mi></msubsup></mrow><annotation-xml encoding="MathML-Content" id="S4.SS3.p3.4.m2.1b"><apply id="S4.SS3.p3.4.m2.1.1.cmml" xref="S4.SS3.p3.4.m2.1.1"><in id="S4.SS3.p3.4.m2.1.1.1.cmml" xref="S4.SS3.p3.4.m2.1.1.1"></in><ci id="S4.SS3.p3.4.m2.1.1.2.cmml" xref="S4.SS3.p3.4.m2.1.1.2">𝐲</ci><apply id="S4.SS3.p3.4.m2.1.1.3.cmml" xref="S4.SS3.p3.4.m2.1.1.3"><csymbol cd="ambiguous" id="S4.SS3.p3.4.m2.1.1.3.1.cmml" xref="S4.SS3.p3.4.m2.1.1.3">superscript</csymbol><apply id="S4.SS3.p3.4.m2.1.1.3.2.cmml" xref="S4.SS3.p3.4.m2.1.1.3"><csymbol cd="ambiguous" id="S4.SS3.p3.4.m2.1.1.3.2.1.cmml" xref="S4.SS3.p3.4.m2.1.1.3">subscript</csymbol><ci id="S4.SS3.p3.4.m2.1.1.3.2.2.cmml" xref="S4.SS3.p3.4.m2.1.1.3.2.2">𝔹</ci><ci id="S4.SS3.p3.4.m2.1.1.3.2.3.cmml" xref="S4.SS3.p3.4.m2.1.1.3.2.3">𝛾</ci></apply><ci id="S4.SS3.p3.4.m2.1.1.3.3.cmml" xref="S4.SS3.p3.4.m2.1.1.3.3">𝑛</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p3.4.m2.1c">\mathbf{y}\in\mathbb{B}_{\gamma}^{n}</annotation></semantics></math> can be computed as:</p>
<table id="S4.E6" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S4.E6.m1.5" class="ltx_Math" alttext="d_{\gamma}(\mathbf{x},\mathbf{y})=\left(\frac{2}{\sqrt{\gamma}}\right)\tanh^{-1}\left(\sqrt{\gamma}\|\mathbf{-x}\oplus_{\gamma}\mathbf{y}\|\right)" display="block"><semantics id="S4.E6.m1.5a"><mrow id="S4.E6.m1.5.5" xref="S4.E6.m1.5.5.cmml"><mrow id="S4.E6.m1.5.5.4" xref="S4.E6.m1.5.5.4.cmml"><msub id="S4.E6.m1.5.5.4.2" xref="S4.E6.m1.5.5.4.2.cmml"><mi id="S4.E6.m1.5.5.4.2.2" xref="S4.E6.m1.5.5.4.2.2.cmml">d</mi><mi id="S4.E6.m1.5.5.4.2.3" xref="S4.E6.m1.5.5.4.2.3.cmml">γ</mi></msub><mo lspace="0em" rspace="0em" id="S4.E6.m1.5.5.4.1" xref="S4.E6.m1.5.5.4.1.cmml">​</mo><mrow id="S4.E6.m1.5.5.4.3.2" xref="S4.E6.m1.5.5.4.3.1.cmml"><mo stretchy="false" id="S4.E6.m1.5.5.4.3.2.1" xref="S4.E6.m1.5.5.4.3.1.cmml">(</mo><mi id="S4.E6.m1.1.1" xref="S4.E6.m1.1.1.cmml">𝐱</mi><mo id="S4.E6.m1.5.5.4.3.2.2" xref="S4.E6.m1.5.5.4.3.1.cmml">,</mo><mi id="S4.E6.m1.2.2" xref="S4.E6.m1.2.2.cmml">𝐲</mi><mo stretchy="false" id="S4.E6.m1.5.5.4.3.2.3" xref="S4.E6.m1.5.5.4.3.1.cmml">)</mo></mrow></mrow><mo id="S4.E6.m1.5.5.3" xref="S4.E6.m1.5.5.3.cmml">=</mo><mrow id="S4.E6.m1.5.5.2" xref="S4.E6.m1.5.5.2.cmml"><mrow id="S4.E6.m1.5.5.2.4.2" xref="S4.E6.m1.3.3.cmml"><mo id="S4.E6.m1.5.5.2.4.2.1" xref="S4.E6.m1.3.3.cmml">(</mo><mfrac id="S4.E6.m1.3.3" xref="S4.E6.m1.3.3.cmml"><mn id="S4.E6.m1.3.3.2" xref="S4.E6.m1.3.3.2.cmml">2</mn><msqrt id="S4.E6.m1.3.3.3" xref="S4.E6.m1.3.3.3.cmml"><mi id="S4.E6.m1.3.3.3.2" xref="S4.E6.m1.3.3.3.2.cmml">γ</mi></msqrt></mfrac><mo id="S4.E6.m1.5.5.2.4.2.2" xref="S4.E6.m1.3.3.cmml">)</mo></mrow><mo lspace="0.167em" rspace="0em" id="S4.E6.m1.5.5.2.3" xref="S4.E6.m1.5.5.2.3.cmml">​</mo><mrow id="S4.E6.m1.5.5.2.2.2" xref="S4.E6.m1.5.5.2.2.3.cmml"><msup id="S4.E6.m1.4.4.1.1.1.1" xref="S4.E6.m1.4.4.1.1.1.1.cmml"><mi id="S4.E6.m1.4.4.1.1.1.1.2" xref="S4.E6.m1.4.4.1.1.1.1.2.cmml">tanh</mi><mrow id="S4.E6.m1.4.4.1.1.1.1.3" xref="S4.E6.m1.4.4.1.1.1.1.3.cmml"><mo id="S4.E6.m1.4.4.1.1.1.1.3a" xref="S4.E6.m1.4.4.1.1.1.1.3.cmml">−</mo><mn id="S4.E6.m1.4.4.1.1.1.1.3.2" xref="S4.E6.m1.4.4.1.1.1.1.3.2.cmml">1</mn></mrow></msup><mo id="S4.E6.m1.5.5.2.2.2a" xref="S4.E6.m1.5.5.2.2.3.cmml">⁡</mo><mrow id="S4.E6.m1.5.5.2.2.2.2" xref="S4.E6.m1.5.5.2.2.3.cmml"><mo id="S4.E6.m1.5.5.2.2.2.2.2" xref="S4.E6.m1.5.5.2.2.3.cmml">(</mo><mrow id="S4.E6.m1.5.5.2.2.2.2.1" xref="S4.E6.m1.5.5.2.2.2.2.1.cmml"><msqrt id="S4.E6.m1.5.5.2.2.2.2.1.3" xref="S4.E6.m1.5.5.2.2.2.2.1.3.cmml"><mi id="S4.E6.m1.5.5.2.2.2.2.1.3.2" xref="S4.E6.m1.5.5.2.2.2.2.1.3.2.cmml">γ</mi></msqrt><mo lspace="0em" rspace="0em" id="S4.E6.m1.5.5.2.2.2.2.1.2" xref="S4.E6.m1.5.5.2.2.2.2.1.2.cmml">​</mo><mrow id="S4.E6.m1.5.5.2.2.2.2.1.1.1" xref="S4.E6.m1.5.5.2.2.2.2.1.1.2.cmml"><mo stretchy="false" id="S4.E6.m1.5.5.2.2.2.2.1.1.1.2" xref="S4.E6.m1.5.5.2.2.2.2.1.1.2.1.cmml">‖</mo><mrow id="S4.E6.m1.5.5.2.2.2.2.1.1.1.1" xref="S4.E6.m1.5.5.2.2.2.2.1.1.1.1.cmml"><mrow id="S4.E6.m1.5.5.2.2.2.2.1.1.1.1.2" xref="S4.E6.m1.5.5.2.2.2.2.1.1.1.1.2.cmml"><mo id="S4.E6.m1.5.5.2.2.2.2.1.1.1.1.2a" xref="S4.E6.m1.5.5.2.2.2.2.1.1.1.1.2.cmml">−</mo><mi id="S4.E6.m1.5.5.2.2.2.2.1.1.1.1.2.2" xref="S4.E6.m1.5.5.2.2.2.2.1.1.1.1.2.2.cmml">𝐱</mi></mrow><msub id="S4.E6.m1.5.5.2.2.2.2.1.1.1.1.1" xref="S4.E6.m1.5.5.2.2.2.2.1.1.1.1.1.cmml"><mo id="S4.E6.m1.5.5.2.2.2.2.1.1.1.1.1.2" xref="S4.E6.m1.5.5.2.2.2.2.1.1.1.1.1.2.cmml">⊕</mo><mi id="S4.E6.m1.5.5.2.2.2.2.1.1.1.1.1.3" xref="S4.E6.m1.5.5.2.2.2.2.1.1.1.1.1.3.cmml">γ</mi></msub><mi id="S4.E6.m1.5.5.2.2.2.2.1.1.1.1.3" xref="S4.E6.m1.5.5.2.2.2.2.1.1.1.1.3.cmml">𝐲</mi></mrow><mo stretchy="false" id="S4.E6.m1.5.5.2.2.2.2.1.1.1.3" xref="S4.E6.m1.5.5.2.2.2.2.1.1.2.1.cmml">‖</mo></mrow></mrow><mo id="S4.E6.m1.5.5.2.2.2.2.3" xref="S4.E6.m1.5.5.2.2.3.cmml">)</mo></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.E6.m1.5b"><apply id="S4.E6.m1.5.5.cmml" xref="S4.E6.m1.5.5"><eq id="S4.E6.m1.5.5.3.cmml" xref="S4.E6.m1.5.5.3"></eq><apply id="S4.E6.m1.5.5.4.cmml" xref="S4.E6.m1.5.5.4"><times id="S4.E6.m1.5.5.4.1.cmml" xref="S4.E6.m1.5.5.4.1"></times><apply id="S4.E6.m1.5.5.4.2.cmml" xref="S4.E6.m1.5.5.4.2"><csymbol cd="ambiguous" id="S4.E6.m1.5.5.4.2.1.cmml" xref="S4.E6.m1.5.5.4.2">subscript</csymbol><ci id="S4.E6.m1.5.5.4.2.2.cmml" xref="S4.E6.m1.5.5.4.2.2">𝑑</ci><ci id="S4.E6.m1.5.5.4.2.3.cmml" xref="S4.E6.m1.5.5.4.2.3">𝛾</ci></apply><interval closure="open" id="S4.E6.m1.5.5.4.3.1.cmml" xref="S4.E6.m1.5.5.4.3.2"><ci id="S4.E6.m1.1.1.cmml" xref="S4.E6.m1.1.1">𝐱</ci><ci id="S4.E6.m1.2.2.cmml" xref="S4.E6.m1.2.2">𝐲</ci></interval></apply><apply id="S4.E6.m1.5.5.2.cmml" xref="S4.E6.m1.5.5.2"><times id="S4.E6.m1.5.5.2.3.cmml" xref="S4.E6.m1.5.5.2.3"></times><apply id="S4.E6.m1.3.3.cmml" xref="S4.E6.m1.5.5.2.4.2"><divide id="S4.E6.m1.3.3.1.cmml" xref="S4.E6.m1.5.5.2.4.2"></divide><cn type="integer" id="S4.E6.m1.3.3.2.cmml" xref="S4.E6.m1.3.3.2">2</cn><apply id="S4.E6.m1.3.3.3.cmml" xref="S4.E6.m1.3.3.3"><root id="S4.E6.m1.3.3.3a.cmml" xref="S4.E6.m1.3.3.3"></root><ci id="S4.E6.m1.3.3.3.2.cmml" xref="S4.E6.m1.3.3.3.2">𝛾</ci></apply></apply><apply id="S4.E6.m1.5.5.2.2.3.cmml" xref="S4.E6.m1.5.5.2.2.2"><apply id="S4.E6.m1.4.4.1.1.1.1.cmml" xref="S4.E6.m1.4.4.1.1.1.1"><csymbol cd="ambiguous" id="S4.E6.m1.4.4.1.1.1.1.1.cmml" xref="S4.E6.m1.4.4.1.1.1.1">superscript</csymbol><tanh id="S4.E6.m1.4.4.1.1.1.1.2.cmml" xref="S4.E6.m1.4.4.1.1.1.1.2"></tanh><apply id="S4.E6.m1.4.4.1.1.1.1.3.cmml" xref="S4.E6.m1.4.4.1.1.1.1.3"><minus id="S4.E6.m1.4.4.1.1.1.1.3.1.cmml" xref="S4.E6.m1.4.4.1.1.1.1.3"></minus><cn type="integer" id="S4.E6.m1.4.4.1.1.1.1.3.2.cmml" xref="S4.E6.m1.4.4.1.1.1.1.3.2">1</cn></apply></apply><apply id="S4.E6.m1.5.5.2.2.2.2.1.cmml" xref="S4.E6.m1.5.5.2.2.2.2.1"><times id="S4.E6.m1.5.5.2.2.2.2.1.2.cmml" xref="S4.E6.m1.5.5.2.2.2.2.1.2"></times><apply id="S4.E6.m1.5.5.2.2.2.2.1.3.cmml" xref="S4.E6.m1.5.5.2.2.2.2.1.3"><root id="S4.E6.m1.5.5.2.2.2.2.1.3a.cmml" xref="S4.E6.m1.5.5.2.2.2.2.1.3"></root><ci id="S4.E6.m1.5.5.2.2.2.2.1.3.2.cmml" xref="S4.E6.m1.5.5.2.2.2.2.1.3.2">𝛾</ci></apply><apply id="S4.E6.m1.5.5.2.2.2.2.1.1.2.cmml" xref="S4.E6.m1.5.5.2.2.2.2.1.1.1"><csymbol cd="latexml" id="S4.E6.m1.5.5.2.2.2.2.1.1.2.1.cmml" xref="S4.E6.m1.5.5.2.2.2.2.1.1.1.2">norm</csymbol><apply id="S4.E6.m1.5.5.2.2.2.2.1.1.1.1.cmml" xref="S4.E6.m1.5.5.2.2.2.2.1.1.1.1"><apply id="S4.E6.m1.5.5.2.2.2.2.1.1.1.1.1.cmml" xref="S4.E6.m1.5.5.2.2.2.2.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.E6.m1.5.5.2.2.2.2.1.1.1.1.1.1.cmml" xref="S4.E6.m1.5.5.2.2.2.2.1.1.1.1.1">subscript</csymbol><csymbol cd="latexml" id="S4.E6.m1.5.5.2.2.2.2.1.1.1.1.1.2.cmml" xref="S4.E6.m1.5.5.2.2.2.2.1.1.1.1.1.2">direct-sum</csymbol><ci id="S4.E6.m1.5.5.2.2.2.2.1.1.1.1.1.3.cmml" xref="S4.E6.m1.5.5.2.2.2.2.1.1.1.1.1.3">𝛾</ci></apply><apply id="S4.E6.m1.5.5.2.2.2.2.1.1.1.1.2.cmml" xref="S4.E6.m1.5.5.2.2.2.2.1.1.1.1.2"><minus id="S4.E6.m1.5.5.2.2.2.2.1.1.1.1.2.1.cmml" xref="S4.E6.m1.5.5.2.2.2.2.1.1.1.1.2"></minus><ci id="S4.E6.m1.5.5.2.2.2.2.1.1.1.1.2.2.cmml" xref="S4.E6.m1.5.5.2.2.2.2.1.1.1.1.2.2">𝐱</ci></apply><ci id="S4.E6.m1.5.5.2.2.2.2.1.1.1.1.3.cmml" xref="S4.E6.m1.5.5.2.2.2.2.1.1.1.1.3">𝐲</ci></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.E6.m1.5c">d_{\gamma}(\mathbf{x},\mathbf{y})=\left(\frac{2}{\sqrt{\gamma}}\right)\tanh^{-1}\left(\sqrt{\gamma}\|\mathbf{-x}\oplus_{\gamma}\mathbf{y}\|\right)</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(6)</span></td>
</tr></tbody>
</table>
<p id="S4.SS3.p3.5" class="ltx_p">where <math id="S4.SS3.p3.5.m1.1" class="ltx_Math" alttext="\mathbf{x}\oplus_{\gamma}\mathbf{y}" display="inline"><semantics id="S4.SS3.p3.5.m1.1a"><mrow id="S4.SS3.p3.5.m1.1.1" xref="S4.SS3.p3.5.m1.1.1.cmml"><mi id="S4.SS3.p3.5.m1.1.1.2" xref="S4.SS3.p3.5.m1.1.1.2.cmml">𝐱</mi><msub id="S4.SS3.p3.5.m1.1.1.1" xref="S4.SS3.p3.5.m1.1.1.1.cmml"><mo id="S4.SS3.p3.5.m1.1.1.1.2" xref="S4.SS3.p3.5.m1.1.1.1.2.cmml">⊕</mo><mi id="S4.SS3.p3.5.m1.1.1.1.3" xref="S4.SS3.p3.5.m1.1.1.1.3.cmml">γ</mi></msub><mi id="S4.SS3.p3.5.m1.1.1.3" xref="S4.SS3.p3.5.m1.1.1.3.cmml">𝐲</mi></mrow><annotation-xml encoding="MathML-Content" id="S4.SS3.p3.5.m1.1b"><apply id="S4.SS3.p3.5.m1.1.1.cmml" xref="S4.SS3.p3.5.m1.1.1"><apply id="S4.SS3.p3.5.m1.1.1.1.cmml" xref="S4.SS3.p3.5.m1.1.1.1"><csymbol cd="ambiguous" id="S4.SS3.p3.5.m1.1.1.1.1.cmml" xref="S4.SS3.p3.5.m1.1.1.1">subscript</csymbol><csymbol cd="latexml" id="S4.SS3.p3.5.m1.1.1.1.2.cmml" xref="S4.SS3.p3.5.m1.1.1.1.2">direct-sum</csymbol><ci id="S4.SS3.p3.5.m1.1.1.1.3.cmml" xref="S4.SS3.p3.5.m1.1.1.1.3">𝛾</ci></apply><ci id="S4.SS3.p3.5.m1.1.1.2.cmml" xref="S4.SS3.p3.5.m1.1.1.2">𝐱</ci><ci id="S4.SS3.p3.5.m1.1.1.3.cmml" xref="S4.SS3.p3.5.m1.1.1.3">𝐲</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p3.5.m1.1c">\mathbf{x}\oplus_{\gamma}\mathbf{y}</annotation></semantics></math> is the Möbius addition:</p>
<table id="S4.E7" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S4.E7.m1.10" class="ltx_Math" alttext="\mathbf{x}\oplus_{\gamma}\mathbf{y}=\frac{(1+2\gamma\langle\mathbf{x},\mathbf{y}\rangle+\gamma\|\mathbf{y}\|^{2})\mathbf{x}+(1-\gamma\|\mathbf{x}\|^{2})\mathbf{y}}{1+2\gamma\langle\mathbf{x},\mathbf{y}\rangle+\gamma^{2}\|\mathbf{x}\|^{2}\|\mathbf{y}\|^{2}}" display="block"><semantics id="S4.E7.m1.10a"><mrow id="S4.E7.m1.10.11" xref="S4.E7.m1.10.11.cmml"><mrow id="S4.E7.m1.10.11.2" xref="S4.E7.m1.10.11.2.cmml"><mi id="S4.E7.m1.10.11.2.2" xref="S4.E7.m1.10.11.2.2.cmml">𝐱</mi><msub id="S4.E7.m1.10.11.2.1" xref="S4.E7.m1.10.11.2.1.cmml"><mo id="S4.E7.m1.10.11.2.1.2" xref="S4.E7.m1.10.11.2.1.2.cmml">⊕</mo><mi id="S4.E7.m1.10.11.2.1.3" xref="S4.E7.m1.10.11.2.1.3.cmml">γ</mi></msub><mi id="S4.E7.m1.10.11.2.3" xref="S4.E7.m1.10.11.2.3.cmml">𝐲</mi></mrow><mo id="S4.E7.m1.10.11.1" xref="S4.E7.m1.10.11.1.cmml">=</mo><mfrac id="S4.E7.m1.10.10" xref="S4.E7.m1.10.10.cmml"><mrow id="S4.E7.m1.6.6.6" xref="S4.E7.m1.6.6.6.cmml"><mrow id="S4.E7.m1.5.5.5.5" xref="S4.E7.m1.5.5.5.5.cmml"><mrow id="S4.E7.m1.5.5.5.5.1.1" xref="S4.E7.m1.5.5.5.5.1.1.1.cmml"><mo stretchy="false" id="S4.E7.m1.5.5.5.5.1.1.2" xref="S4.E7.m1.5.5.5.5.1.1.1.cmml">(</mo><mrow id="S4.E7.m1.5.5.5.5.1.1.1" xref="S4.E7.m1.5.5.5.5.1.1.1.cmml"><mn id="S4.E7.m1.5.5.5.5.1.1.1.2" xref="S4.E7.m1.5.5.5.5.1.1.1.2.cmml">1</mn><mo id="S4.E7.m1.5.5.5.5.1.1.1.1" xref="S4.E7.m1.5.5.5.5.1.1.1.1.cmml">+</mo><mrow id="S4.E7.m1.5.5.5.5.1.1.1.3" xref="S4.E7.m1.5.5.5.5.1.1.1.3.cmml"><mn id="S4.E7.m1.5.5.5.5.1.1.1.3.2" xref="S4.E7.m1.5.5.5.5.1.1.1.3.2.cmml">2</mn><mo lspace="0em" rspace="0em" id="S4.E7.m1.5.5.5.5.1.1.1.3.1" xref="S4.E7.m1.5.5.5.5.1.1.1.3.1.cmml">​</mo><mi id="S4.E7.m1.5.5.5.5.1.1.1.3.3" xref="S4.E7.m1.5.5.5.5.1.1.1.3.3.cmml">γ</mi><mo lspace="0em" rspace="0em" id="S4.E7.m1.5.5.5.5.1.1.1.3.1a" xref="S4.E7.m1.5.5.5.5.1.1.1.3.1.cmml">​</mo><mrow id="S4.E7.m1.5.5.5.5.1.1.1.3.4.2" xref="S4.E7.m1.5.5.5.5.1.1.1.3.4.1.cmml"><mo stretchy="false" id="S4.E7.m1.5.5.5.5.1.1.1.3.4.2.1" xref="S4.E7.m1.5.5.5.5.1.1.1.3.4.1.cmml">⟨</mo><mi id="S4.E7.m1.1.1.1.1" xref="S4.E7.m1.1.1.1.1.cmml">𝐱</mi><mo id="S4.E7.m1.5.5.5.5.1.1.1.3.4.2.2" xref="S4.E7.m1.5.5.5.5.1.1.1.3.4.1.cmml">,</mo><mi id="S4.E7.m1.2.2.2.2" xref="S4.E7.m1.2.2.2.2.cmml">𝐲</mi><mo stretchy="false" id="S4.E7.m1.5.5.5.5.1.1.1.3.4.2.3" xref="S4.E7.m1.5.5.5.5.1.1.1.3.4.1.cmml">⟩</mo></mrow></mrow><mo id="S4.E7.m1.5.5.5.5.1.1.1.1a" xref="S4.E7.m1.5.5.5.5.1.1.1.1.cmml">+</mo><mrow id="S4.E7.m1.5.5.5.5.1.1.1.4" xref="S4.E7.m1.5.5.5.5.1.1.1.4.cmml"><mi id="S4.E7.m1.5.5.5.5.1.1.1.4.2" xref="S4.E7.m1.5.5.5.5.1.1.1.4.2.cmml">γ</mi><mo lspace="0em" rspace="0em" id="S4.E7.m1.5.5.5.5.1.1.1.4.1" xref="S4.E7.m1.5.5.5.5.1.1.1.4.1.cmml">​</mo><msup id="S4.E7.m1.5.5.5.5.1.1.1.4.3" xref="S4.E7.m1.5.5.5.5.1.1.1.4.3.cmml"><mrow id="S4.E7.m1.5.5.5.5.1.1.1.4.3.2.2" xref="S4.E7.m1.5.5.5.5.1.1.1.4.3.2.1.cmml"><mo stretchy="false" id="S4.E7.m1.5.5.5.5.1.1.1.4.3.2.2.1" xref="S4.E7.m1.5.5.5.5.1.1.1.4.3.2.1.1.cmml">‖</mo><mi id="S4.E7.m1.3.3.3.3" xref="S4.E7.m1.3.3.3.3.cmml">𝐲</mi><mo stretchy="false" id="S4.E7.m1.5.5.5.5.1.1.1.4.3.2.2.2" xref="S4.E7.m1.5.5.5.5.1.1.1.4.3.2.1.1.cmml">‖</mo></mrow><mn id="S4.E7.m1.5.5.5.5.1.1.1.4.3.3" xref="S4.E7.m1.5.5.5.5.1.1.1.4.3.3.cmml">2</mn></msup></mrow></mrow><mo stretchy="false" id="S4.E7.m1.5.5.5.5.1.1.3" xref="S4.E7.m1.5.5.5.5.1.1.1.cmml">)</mo></mrow><mo lspace="0em" rspace="0em" id="S4.E7.m1.5.5.5.5.2" xref="S4.E7.m1.5.5.5.5.2.cmml">​</mo><mi id="S4.E7.m1.5.5.5.5.3" xref="S4.E7.m1.5.5.5.5.3.cmml">𝐱</mi></mrow><mo id="S4.E7.m1.6.6.6.7" xref="S4.E7.m1.6.6.6.7.cmml">+</mo><mrow id="S4.E7.m1.6.6.6.6" xref="S4.E7.m1.6.6.6.6.cmml"><mrow id="S4.E7.m1.6.6.6.6.1.1" xref="S4.E7.m1.6.6.6.6.1.1.1.cmml"><mo stretchy="false" id="S4.E7.m1.6.6.6.6.1.1.2" xref="S4.E7.m1.6.6.6.6.1.1.1.cmml">(</mo><mrow id="S4.E7.m1.6.6.6.6.1.1.1" xref="S4.E7.m1.6.6.6.6.1.1.1.cmml"><mn id="S4.E7.m1.6.6.6.6.1.1.1.2" xref="S4.E7.m1.6.6.6.6.1.1.1.2.cmml">1</mn><mo id="S4.E7.m1.6.6.6.6.1.1.1.1" xref="S4.E7.m1.6.6.6.6.1.1.1.1.cmml">−</mo><mrow id="S4.E7.m1.6.6.6.6.1.1.1.3" xref="S4.E7.m1.6.6.6.6.1.1.1.3.cmml"><mi id="S4.E7.m1.6.6.6.6.1.1.1.3.2" xref="S4.E7.m1.6.6.6.6.1.1.1.3.2.cmml">γ</mi><mo lspace="0em" rspace="0em" id="S4.E7.m1.6.6.6.6.1.1.1.3.1" xref="S4.E7.m1.6.6.6.6.1.1.1.3.1.cmml">​</mo><msup id="S4.E7.m1.6.6.6.6.1.1.1.3.3" xref="S4.E7.m1.6.6.6.6.1.1.1.3.3.cmml"><mrow id="S4.E7.m1.6.6.6.6.1.1.1.3.3.2.2" xref="S4.E7.m1.6.6.6.6.1.1.1.3.3.2.1.cmml"><mo stretchy="false" id="S4.E7.m1.6.6.6.6.1.1.1.3.3.2.2.1" xref="S4.E7.m1.6.6.6.6.1.1.1.3.3.2.1.1.cmml">‖</mo><mi id="S4.E7.m1.4.4.4.4" xref="S4.E7.m1.4.4.4.4.cmml">𝐱</mi><mo stretchy="false" id="S4.E7.m1.6.6.6.6.1.1.1.3.3.2.2.2" xref="S4.E7.m1.6.6.6.6.1.1.1.3.3.2.1.1.cmml">‖</mo></mrow><mn id="S4.E7.m1.6.6.6.6.1.1.1.3.3.3" xref="S4.E7.m1.6.6.6.6.1.1.1.3.3.3.cmml">2</mn></msup></mrow></mrow><mo stretchy="false" id="S4.E7.m1.6.6.6.6.1.1.3" xref="S4.E7.m1.6.6.6.6.1.1.1.cmml">)</mo></mrow><mo lspace="0em" rspace="0em" id="S4.E7.m1.6.6.6.6.2" xref="S4.E7.m1.6.6.6.6.2.cmml">​</mo><mi id="S4.E7.m1.6.6.6.6.3" xref="S4.E7.m1.6.6.6.6.3.cmml">𝐲</mi></mrow></mrow><mrow id="S4.E7.m1.10.10.10" xref="S4.E7.m1.10.10.10.cmml"><mn id="S4.E7.m1.10.10.10.6" xref="S4.E7.m1.10.10.10.6.cmml">1</mn><mo id="S4.E7.m1.10.10.10.5" xref="S4.E7.m1.10.10.10.5.cmml">+</mo><mrow id="S4.E7.m1.10.10.10.7" xref="S4.E7.m1.10.10.10.7.cmml"><mn id="S4.E7.m1.10.10.10.7.2" xref="S4.E7.m1.10.10.10.7.2.cmml">2</mn><mo lspace="0em" rspace="0em" id="S4.E7.m1.10.10.10.7.1" xref="S4.E7.m1.10.10.10.7.1.cmml">​</mo><mi id="S4.E7.m1.10.10.10.7.3" xref="S4.E7.m1.10.10.10.7.3.cmml">γ</mi><mo lspace="0em" rspace="0em" id="S4.E7.m1.10.10.10.7.1a" xref="S4.E7.m1.10.10.10.7.1.cmml">​</mo><mrow id="S4.E7.m1.10.10.10.7.4.2" xref="S4.E7.m1.10.10.10.7.4.1.cmml"><mo stretchy="false" id="S4.E7.m1.10.10.10.7.4.2.1" xref="S4.E7.m1.10.10.10.7.4.1.cmml">⟨</mo><mi id="S4.E7.m1.7.7.7.1" xref="S4.E7.m1.7.7.7.1.cmml">𝐱</mi><mo id="S4.E7.m1.10.10.10.7.4.2.2" xref="S4.E7.m1.10.10.10.7.4.1.cmml">,</mo><mi id="S4.E7.m1.8.8.8.2" xref="S4.E7.m1.8.8.8.2.cmml">𝐲</mi><mo stretchy="false" id="S4.E7.m1.10.10.10.7.4.2.3" xref="S4.E7.m1.10.10.10.7.4.1.cmml">⟩</mo></mrow></mrow><mo id="S4.E7.m1.10.10.10.5a" xref="S4.E7.m1.10.10.10.5.cmml">+</mo><mrow id="S4.E7.m1.10.10.10.8" xref="S4.E7.m1.10.10.10.8.cmml"><msup id="S4.E7.m1.10.10.10.8.2" xref="S4.E7.m1.10.10.10.8.2.cmml"><mi id="S4.E7.m1.10.10.10.8.2.2" xref="S4.E7.m1.10.10.10.8.2.2.cmml">γ</mi><mn id="S4.E7.m1.10.10.10.8.2.3" xref="S4.E7.m1.10.10.10.8.2.3.cmml">2</mn></msup><mo lspace="0em" rspace="0em" id="S4.E7.m1.10.10.10.8.1" xref="S4.E7.m1.10.10.10.8.1.cmml">​</mo><msup id="S4.E7.m1.10.10.10.8.3" xref="S4.E7.m1.10.10.10.8.3.cmml"><mrow id="S4.E7.m1.10.10.10.8.3.2.2" xref="S4.E7.m1.10.10.10.8.3.2.1.cmml"><mo stretchy="false" id="S4.E7.m1.10.10.10.8.3.2.2.1" xref="S4.E7.m1.10.10.10.8.3.2.1.1.cmml">‖</mo><mi id="S4.E7.m1.9.9.9.3" xref="S4.E7.m1.9.9.9.3.cmml">𝐱</mi><mo stretchy="false" id="S4.E7.m1.10.10.10.8.3.2.2.2" xref="S4.E7.m1.10.10.10.8.3.2.1.1.cmml">‖</mo></mrow><mn id="S4.E7.m1.10.10.10.8.3.3" xref="S4.E7.m1.10.10.10.8.3.3.cmml">2</mn></msup><mo lspace="0em" rspace="0em" id="S4.E7.m1.10.10.10.8.1a" xref="S4.E7.m1.10.10.10.8.1.cmml">​</mo><msup id="S4.E7.m1.10.10.10.8.4" xref="S4.E7.m1.10.10.10.8.4.cmml"><mrow id="S4.E7.m1.10.10.10.8.4.2.2" xref="S4.E7.m1.10.10.10.8.4.2.1.cmml"><mo stretchy="false" id="S4.E7.m1.10.10.10.8.4.2.2.1" xref="S4.E7.m1.10.10.10.8.4.2.1.1.cmml">‖</mo><mi id="S4.E7.m1.10.10.10.4" xref="S4.E7.m1.10.10.10.4.cmml">𝐲</mi><mo stretchy="false" id="S4.E7.m1.10.10.10.8.4.2.2.2" xref="S4.E7.m1.10.10.10.8.4.2.1.1.cmml">‖</mo></mrow><mn id="S4.E7.m1.10.10.10.8.4.3" xref="S4.E7.m1.10.10.10.8.4.3.cmml">2</mn></msup></mrow></mrow></mfrac></mrow><annotation-xml encoding="MathML-Content" id="S4.E7.m1.10b"><apply id="S4.E7.m1.10.11.cmml" xref="S4.E7.m1.10.11"><eq id="S4.E7.m1.10.11.1.cmml" xref="S4.E7.m1.10.11.1"></eq><apply id="S4.E7.m1.10.11.2.cmml" xref="S4.E7.m1.10.11.2"><apply id="S4.E7.m1.10.11.2.1.cmml" xref="S4.E7.m1.10.11.2.1"><csymbol cd="ambiguous" id="S4.E7.m1.10.11.2.1.1.cmml" xref="S4.E7.m1.10.11.2.1">subscript</csymbol><csymbol cd="latexml" id="S4.E7.m1.10.11.2.1.2.cmml" xref="S4.E7.m1.10.11.2.1.2">direct-sum</csymbol><ci id="S4.E7.m1.10.11.2.1.3.cmml" xref="S4.E7.m1.10.11.2.1.3">𝛾</ci></apply><ci id="S4.E7.m1.10.11.2.2.cmml" xref="S4.E7.m1.10.11.2.2">𝐱</ci><ci id="S4.E7.m1.10.11.2.3.cmml" xref="S4.E7.m1.10.11.2.3">𝐲</ci></apply><apply id="S4.E7.m1.10.10.cmml" xref="S4.E7.m1.10.10"><divide id="S4.E7.m1.10.10.11.cmml" xref="S4.E7.m1.10.10"></divide><apply id="S4.E7.m1.6.6.6.cmml" xref="S4.E7.m1.6.6.6"><plus id="S4.E7.m1.6.6.6.7.cmml" xref="S4.E7.m1.6.6.6.7"></plus><apply id="S4.E7.m1.5.5.5.5.cmml" xref="S4.E7.m1.5.5.5.5"><times id="S4.E7.m1.5.5.5.5.2.cmml" xref="S4.E7.m1.5.5.5.5.2"></times><apply id="S4.E7.m1.5.5.5.5.1.1.1.cmml" xref="S4.E7.m1.5.5.5.5.1.1"><plus id="S4.E7.m1.5.5.5.5.1.1.1.1.cmml" xref="S4.E7.m1.5.5.5.5.1.1.1.1"></plus><cn type="integer" id="S4.E7.m1.5.5.5.5.1.1.1.2.cmml" xref="S4.E7.m1.5.5.5.5.1.1.1.2">1</cn><apply id="S4.E7.m1.5.5.5.5.1.1.1.3.cmml" xref="S4.E7.m1.5.5.5.5.1.1.1.3"><times id="S4.E7.m1.5.5.5.5.1.1.1.3.1.cmml" xref="S4.E7.m1.5.5.5.5.1.1.1.3.1"></times><cn type="integer" id="S4.E7.m1.5.5.5.5.1.1.1.3.2.cmml" xref="S4.E7.m1.5.5.5.5.1.1.1.3.2">2</cn><ci id="S4.E7.m1.5.5.5.5.1.1.1.3.3.cmml" xref="S4.E7.m1.5.5.5.5.1.1.1.3.3">𝛾</ci><list id="S4.E7.m1.5.5.5.5.1.1.1.3.4.1.cmml" xref="S4.E7.m1.5.5.5.5.1.1.1.3.4.2"><ci id="S4.E7.m1.1.1.1.1.cmml" xref="S4.E7.m1.1.1.1.1">𝐱</ci><ci id="S4.E7.m1.2.2.2.2.cmml" xref="S4.E7.m1.2.2.2.2">𝐲</ci></list></apply><apply id="S4.E7.m1.5.5.5.5.1.1.1.4.cmml" xref="S4.E7.m1.5.5.5.5.1.1.1.4"><times id="S4.E7.m1.5.5.5.5.1.1.1.4.1.cmml" xref="S4.E7.m1.5.5.5.5.1.1.1.4.1"></times><ci id="S4.E7.m1.5.5.5.5.1.1.1.4.2.cmml" xref="S4.E7.m1.5.5.5.5.1.1.1.4.2">𝛾</ci><apply id="S4.E7.m1.5.5.5.5.1.1.1.4.3.cmml" xref="S4.E7.m1.5.5.5.5.1.1.1.4.3"><csymbol cd="ambiguous" id="S4.E7.m1.5.5.5.5.1.1.1.4.3.1.cmml" xref="S4.E7.m1.5.5.5.5.1.1.1.4.3">superscript</csymbol><apply id="S4.E7.m1.5.5.5.5.1.1.1.4.3.2.1.cmml" xref="S4.E7.m1.5.5.5.5.1.1.1.4.3.2.2"><csymbol cd="latexml" id="S4.E7.m1.5.5.5.5.1.1.1.4.3.2.1.1.cmml" xref="S4.E7.m1.5.5.5.5.1.1.1.4.3.2.2.1">norm</csymbol><ci id="S4.E7.m1.3.3.3.3.cmml" xref="S4.E7.m1.3.3.3.3">𝐲</ci></apply><cn type="integer" id="S4.E7.m1.5.5.5.5.1.1.1.4.3.3.cmml" xref="S4.E7.m1.5.5.5.5.1.1.1.4.3.3">2</cn></apply></apply></apply><ci id="S4.E7.m1.5.5.5.5.3.cmml" xref="S4.E7.m1.5.5.5.5.3">𝐱</ci></apply><apply id="S4.E7.m1.6.6.6.6.cmml" xref="S4.E7.m1.6.6.6.6"><times id="S4.E7.m1.6.6.6.6.2.cmml" xref="S4.E7.m1.6.6.6.6.2"></times><apply id="S4.E7.m1.6.6.6.6.1.1.1.cmml" xref="S4.E7.m1.6.6.6.6.1.1"><minus id="S4.E7.m1.6.6.6.6.1.1.1.1.cmml" xref="S4.E7.m1.6.6.6.6.1.1.1.1"></minus><cn type="integer" id="S4.E7.m1.6.6.6.6.1.1.1.2.cmml" xref="S4.E7.m1.6.6.6.6.1.1.1.2">1</cn><apply id="S4.E7.m1.6.6.6.6.1.1.1.3.cmml" xref="S4.E7.m1.6.6.6.6.1.1.1.3"><times id="S4.E7.m1.6.6.6.6.1.1.1.3.1.cmml" xref="S4.E7.m1.6.6.6.6.1.1.1.3.1"></times><ci id="S4.E7.m1.6.6.6.6.1.1.1.3.2.cmml" xref="S4.E7.m1.6.6.6.6.1.1.1.3.2">𝛾</ci><apply id="S4.E7.m1.6.6.6.6.1.1.1.3.3.cmml" xref="S4.E7.m1.6.6.6.6.1.1.1.3.3"><csymbol cd="ambiguous" id="S4.E7.m1.6.6.6.6.1.1.1.3.3.1.cmml" xref="S4.E7.m1.6.6.6.6.1.1.1.3.3">superscript</csymbol><apply id="S4.E7.m1.6.6.6.6.1.1.1.3.3.2.1.cmml" xref="S4.E7.m1.6.6.6.6.1.1.1.3.3.2.2"><csymbol cd="latexml" id="S4.E7.m1.6.6.6.6.1.1.1.3.3.2.1.1.cmml" xref="S4.E7.m1.6.6.6.6.1.1.1.3.3.2.2.1">norm</csymbol><ci id="S4.E7.m1.4.4.4.4.cmml" xref="S4.E7.m1.4.4.4.4">𝐱</ci></apply><cn type="integer" id="S4.E7.m1.6.6.6.6.1.1.1.3.3.3.cmml" xref="S4.E7.m1.6.6.6.6.1.1.1.3.3.3">2</cn></apply></apply></apply><ci id="S4.E7.m1.6.6.6.6.3.cmml" xref="S4.E7.m1.6.6.6.6.3">𝐲</ci></apply></apply><apply id="S4.E7.m1.10.10.10.cmml" xref="S4.E7.m1.10.10.10"><plus id="S4.E7.m1.10.10.10.5.cmml" xref="S4.E7.m1.10.10.10.5"></plus><cn type="integer" id="S4.E7.m1.10.10.10.6.cmml" xref="S4.E7.m1.10.10.10.6">1</cn><apply id="S4.E7.m1.10.10.10.7.cmml" xref="S4.E7.m1.10.10.10.7"><times id="S4.E7.m1.10.10.10.7.1.cmml" xref="S4.E7.m1.10.10.10.7.1"></times><cn type="integer" id="S4.E7.m1.10.10.10.7.2.cmml" xref="S4.E7.m1.10.10.10.7.2">2</cn><ci id="S4.E7.m1.10.10.10.7.3.cmml" xref="S4.E7.m1.10.10.10.7.3">𝛾</ci><list id="S4.E7.m1.10.10.10.7.4.1.cmml" xref="S4.E7.m1.10.10.10.7.4.2"><ci id="S4.E7.m1.7.7.7.1.cmml" xref="S4.E7.m1.7.7.7.1">𝐱</ci><ci id="S4.E7.m1.8.8.8.2.cmml" xref="S4.E7.m1.8.8.8.2">𝐲</ci></list></apply><apply id="S4.E7.m1.10.10.10.8.cmml" xref="S4.E7.m1.10.10.10.8"><times id="S4.E7.m1.10.10.10.8.1.cmml" xref="S4.E7.m1.10.10.10.8.1"></times><apply id="S4.E7.m1.10.10.10.8.2.cmml" xref="S4.E7.m1.10.10.10.8.2"><csymbol cd="ambiguous" id="S4.E7.m1.10.10.10.8.2.1.cmml" xref="S4.E7.m1.10.10.10.8.2">superscript</csymbol><ci id="S4.E7.m1.10.10.10.8.2.2.cmml" xref="S4.E7.m1.10.10.10.8.2.2">𝛾</ci><cn type="integer" id="S4.E7.m1.10.10.10.8.2.3.cmml" xref="S4.E7.m1.10.10.10.8.2.3">2</cn></apply><apply id="S4.E7.m1.10.10.10.8.3.cmml" xref="S4.E7.m1.10.10.10.8.3"><csymbol cd="ambiguous" id="S4.E7.m1.10.10.10.8.3.1.cmml" xref="S4.E7.m1.10.10.10.8.3">superscript</csymbol><apply id="S4.E7.m1.10.10.10.8.3.2.1.cmml" xref="S4.E7.m1.10.10.10.8.3.2.2"><csymbol cd="latexml" id="S4.E7.m1.10.10.10.8.3.2.1.1.cmml" xref="S4.E7.m1.10.10.10.8.3.2.2.1">norm</csymbol><ci id="S4.E7.m1.9.9.9.3.cmml" xref="S4.E7.m1.9.9.9.3">𝐱</ci></apply><cn type="integer" id="S4.E7.m1.10.10.10.8.3.3.cmml" xref="S4.E7.m1.10.10.10.8.3.3">2</cn></apply><apply id="S4.E7.m1.10.10.10.8.4.cmml" xref="S4.E7.m1.10.10.10.8.4"><csymbol cd="ambiguous" id="S4.E7.m1.10.10.10.8.4.1.cmml" xref="S4.E7.m1.10.10.10.8.4">superscript</csymbol><apply id="S4.E7.m1.10.10.10.8.4.2.1.cmml" xref="S4.E7.m1.10.10.10.8.4.2.2"><csymbol cd="latexml" id="S4.E7.m1.10.10.10.8.4.2.1.1.cmml" xref="S4.E7.m1.10.10.10.8.4.2.2.1">norm</csymbol><ci id="S4.E7.m1.10.10.10.4.cmml" xref="S4.E7.m1.10.10.10.4">𝐲</ci></apply><cn type="integer" id="S4.E7.m1.10.10.10.8.4.3.cmml" xref="S4.E7.m1.10.10.10.8.4.3">2</cn></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.E7.m1.10c">\mathbf{x}\oplus_{\gamma}\mathbf{y}=\frac{(1+2\gamma\langle\mathbf{x},\mathbf{y}\rangle+\gamma\|\mathbf{y}\|^{2})\mathbf{x}+(1-\gamma\|\mathbf{x}\|^{2})\mathbf{y}}{1+2\gamma\langle\mathbf{x},\mathbf{y}\rangle+\gamma^{2}\|\mathbf{x}\|^{2}\|\mathbf{y}\|^{2}}</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(7)</span></td>
</tr></tbody>
</table>
<p id="S4.SS3.p3.6" class="ltx_p">The translation from the Euclidean to the hyperbolic space is obtained given the exponential mapping in the direction of a tangent vector <math id="S4.SS3.p3.6.m1.1" class="ltx_Math" alttext="\mathbf{v}\in\mathcal{T}\mathbb{B}_{\gamma}^{n}" display="inline"><semantics id="S4.SS3.p3.6.m1.1a"><mrow id="S4.SS3.p3.6.m1.1.1" xref="S4.SS3.p3.6.m1.1.1.cmml"><mi id="S4.SS3.p3.6.m1.1.1.2" xref="S4.SS3.p3.6.m1.1.1.2.cmml">𝐯</mi><mo id="S4.SS3.p3.6.m1.1.1.1" xref="S4.SS3.p3.6.m1.1.1.1.cmml">∈</mo><mrow id="S4.SS3.p3.6.m1.1.1.3" xref="S4.SS3.p3.6.m1.1.1.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.SS3.p3.6.m1.1.1.3.2" xref="S4.SS3.p3.6.m1.1.1.3.2.cmml">𝒯</mi><mo lspace="0em" rspace="0em" id="S4.SS3.p3.6.m1.1.1.3.1" xref="S4.SS3.p3.6.m1.1.1.3.1.cmml">​</mo><msubsup id="S4.SS3.p3.6.m1.1.1.3.3" xref="S4.SS3.p3.6.m1.1.1.3.3.cmml"><mi id="S4.SS3.p3.6.m1.1.1.3.3.2.2" xref="S4.SS3.p3.6.m1.1.1.3.3.2.2.cmml">𝔹</mi><mi id="S4.SS3.p3.6.m1.1.1.3.3.2.3" xref="S4.SS3.p3.6.m1.1.1.3.3.2.3.cmml">γ</mi><mi id="S4.SS3.p3.6.m1.1.1.3.3.3" xref="S4.SS3.p3.6.m1.1.1.3.3.3.cmml">n</mi></msubsup></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS3.p3.6.m1.1b"><apply id="S4.SS3.p3.6.m1.1.1.cmml" xref="S4.SS3.p3.6.m1.1.1"><in id="S4.SS3.p3.6.m1.1.1.1.cmml" xref="S4.SS3.p3.6.m1.1.1.1"></in><ci id="S4.SS3.p3.6.m1.1.1.2.cmml" xref="S4.SS3.p3.6.m1.1.1.2">𝐯</ci><apply id="S4.SS3.p3.6.m1.1.1.3.cmml" xref="S4.SS3.p3.6.m1.1.1.3"><times id="S4.SS3.p3.6.m1.1.1.3.1.cmml" xref="S4.SS3.p3.6.m1.1.1.3.1"></times><ci id="S4.SS3.p3.6.m1.1.1.3.2.cmml" xref="S4.SS3.p3.6.m1.1.1.3.2">𝒯</ci><apply id="S4.SS3.p3.6.m1.1.1.3.3.cmml" xref="S4.SS3.p3.6.m1.1.1.3.3"><csymbol cd="ambiguous" id="S4.SS3.p3.6.m1.1.1.3.3.1.cmml" xref="S4.SS3.p3.6.m1.1.1.3.3">superscript</csymbol><apply id="S4.SS3.p3.6.m1.1.1.3.3.2.cmml" xref="S4.SS3.p3.6.m1.1.1.3.3"><csymbol cd="ambiguous" id="S4.SS3.p3.6.m1.1.1.3.3.2.1.cmml" xref="S4.SS3.p3.6.m1.1.1.3.3">subscript</csymbol><ci id="S4.SS3.p3.6.m1.1.1.3.3.2.2.cmml" xref="S4.SS3.p3.6.m1.1.1.3.3.2.2">𝔹</ci><ci id="S4.SS3.p3.6.m1.1.1.3.3.2.3.cmml" xref="S4.SS3.p3.6.m1.1.1.3.3.2.3">𝛾</ci></apply><ci id="S4.SS3.p3.6.m1.1.1.3.3.3.cmml" xref="S4.SS3.p3.6.m1.1.1.3.3.3">𝑛</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p3.6.m1.1c">\mathbf{v}\in\mathcal{T}\mathbb{B}_{\gamma}^{n}</annotation></semantics></math>:</p>
<table id="S4.E8" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S4.E8.m1.7" class="ltx_Math" alttext="\exp_{\mathbf{x}}^{\gamma}(\mathbf{v})=\mathbf{x}\oplus_{\gamma}\left(\tanh\left(\frac{\sqrt{\gamma}\|\mathbf{v}\|}{1-\gamma\|\mathbf{v}\|^{2}}\right)\frac{\mathbf{v}}{\sqrt{\gamma}\|\mathbf{v}\|}\right)" display="block"><semantics id="S4.E8.m1.7a"><mrow id="S4.E8.m1.7.7" xref="S4.E8.m1.7.7.cmml"><mrow id="S4.E8.m1.6.6.1.1" xref="S4.E8.m1.6.6.1.2.cmml"><msubsup id="S4.E8.m1.6.6.1.1.1" xref="S4.E8.m1.6.6.1.1.1.cmml"><mi id="S4.E8.m1.6.6.1.1.1.2.2" xref="S4.E8.m1.6.6.1.1.1.2.2.cmml">exp</mi><mi id="S4.E8.m1.6.6.1.1.1.2.3" xref="S4.E8.m1.6.6.1.1.1.2.3.cmml">𝐱</mi><mi id="S4.E8.m1.6.6.1.1.1.3" xref="S4.E8.m1.6.6.1.1.1.3.cmml">γ</mi></msubsup><mo id="S4.E8.m1.6.6.1.1a" xref="S4.E8.m1.6.6.1.2.cmml">⁡</mo><mrow id="S4.E8.m1.6.6.1.1.2" xref="S4.E8.m1.6.6.1.2.cmml"><mo stretchy="false" id="S4.E8.m1.6.6.1.1.2.1" xref="S4.E8.m1.6.6.1.2.cmml">(</mo><mi id="S4.E8.m1.4.4" xref="S4.E8.m1.4.4.cmml">𝐯</mi><mo stretchy="false" id="S4.E8.m1.6.6.1.1.2.2" xref="S4.E8.m1.6.6.1.2.cmml">)</mo></mrow></mrow><mo id="S4.E8.m1.7.7.3" xref="S4.E8.m1.7.7.3.cmml">=</mo><mrow id="S4.E8.m1.7.7.2" xref="S4.E8.m1.7.7.2.cmml"><mi id="S4.E8.m1.7.7.2.3" xref="S4.E8.m1.7.7.2.3.cmml">𝐱</mi><msub id="S4.E8.m1.7.7.2.2" xref="S4.E8.m1.7.7.2.2.cmml"><mo id="S4.E8.m1.7.7.2.2.2" xref="S4.E8.m1.7.7.2.2.2.cmml">⊕</mo><mi id="S4.E8.m1.7.7.2.2.3" xref="S4.E8.m1.7.7.2.2.3.cmml">γ</mi></msub><mrow id="S4.E8.m1.7.7.2.1.1" xref="S4.E8.m1.7.7.2.1.1.1.cmml"><mo id="S4.E8.m1.7.7.2.1.1.2" xref="S4.E8.m1.7.7.2.1.1.1.cmml">(</mo><mrow id="S4.E8.m1.7.7.2.1.1.1" xref="S4.E8.m1.7.7.2.1.1.1.cmml"><mrow id="S4.E8.m1.7.7.2.1.1.1.2.2" xref="S4.E8.m1.7.7.2.1.1.1.2.1.cmml"><mi id="S4.E8.m1.5.5" xref="S4.E8.m1.5.5.cmml">tanh</mi><mo id="S4.E8.m1.7.7.2.1.1.1.2.2a" xref="S4.E8.m1.7.7.2.1.1.1.2.1.cmml">⁡</mo><mrow id="S4.E8.m1.7.7.2.1.1.1.2.2.1" xref="S4.E8.m1.7.7.2.1.1.1.2.1.cmml"><mo id="S4.E8.m1.7.7.2.1.1.1.2.2.1.1" xref="S4.E8.m1.7.7.2.1.1.1.2.1.cmml">(</mo><mfrac id="S4.E8.m1.2.2" xref="S4.E8.m1.2.2.cmml"><mrow id="S4.E8.m1.1.1.1" xref="S4.E8.m1.1.1.1.cmml"><msqrt id="S4.E8.m1.1.1.1.3" xref="S4.E8.m1.1.1.1.3.cmml"><mi id="S4.E8.m1.1.1.1.3.2" xref="S4.E8.m1.1.1.1.3.2.cmml">γ</mi></msqrt><mo lspace="0em" rspace="0em" id="S4.E8.m1.1.1.1.2" xref="S4.E8.m1.1.1.1.2.cmml">​</mo><mrow id="S4.E8.m1.1.1.1.4.2" xref="S4.E8.m1.1.1.1.4.1.cmml"><mo stretchy="false" id="S4.E8.m1.1.1.1.4.2.1" xref="S4.E8.m1.1.1.1.4.1.1.cmml">‖</mo><mi id="S4.E8.m1.1.1.1.1" xref="S4.E8.m1.1.1.1.1.cmml">𝐯</mi><mo stretchy="false" id="S4.E8.m1.1.1.1.4.2.2" xref="S4.E8.m1.1.1.1.4.1.1.cmml">‖</mo></mrow></mrow><mrow id="S4.E8.m1.2.2.2" xref="S4.E8.m1.2.2.2.cmml"><mn id="S4.E8.m1.2.2.2.3" xref="S4.E8.m1.2.2.2.3.cmml">1</mn><mo id="S4.E8.m1.2.2.2.2" xref="S4.E8.m1.2.2.2.2.cmml">−</mo><mrow id="S4.E8.m1.2.2.2.4" xref="S4.E8.m1.2.2.2.4.cmml"><mi id="S4.E8.m1.2.2.2.4.2" xref="S4.E8.m1.2.2.2.4.2.cmml">γ</mi><mo lspace="0em" rspace="0em" id="S4.E8.m1.2.2.2.4.1" xref="S4.E8.m1.2.2.2.4.1.cmml">​</mo><msup id="S4.E8.m1.2.2.2.4.3" xref="S4.E8.m1.2.2.2.4.3.cmml"><mrow id="S4.E8.m1.2.2.2.4.3.2.2" xref="S4.E8.m1.2.2.2.4.3.2.1.cmml"><mo stretchy="false" id="S4.E8.m1.2.2.2.4.3.2.2.1" xref="S4.E8.m1.2.2.2.4.3.2.1.1.cmml">‖</mo><mi id="S4.E8.m1.2.2.2.1" xref="S4.E8.m1.2.2.2.1.cmml">𝐯</mi><mo stretchy="false" id="S4.E8.m1.2.2.2.4.3.2.2.2" xref="S4.E8.m1.2.2.2.4.3.2.1.1.cmml">‖</mo></mrow><mn id="S4.E8.m1.2.2.2.4.3.3" xref="S4.E8.m1.2.2.2.4.3.3.cmml">2</mn></msup></mrow></mrow></mfrac><mo id="S4.E8.m1.7.7.2.1.1.1.2.2.1.2" xref="S4.E8.m1.7.7.2.1.1.1.2.1.cmml">)</mo></mrow></mrow><mo lspace="0em" rspace="0em" id="S4.E8.m1.7.7.2.1.1.1.1" xref="S4.E8.m1.7.7.2.1.1.1.1.cmml">​</mo><mfrac id="S4.E8.m1.3.3" xref="S4.E8.m1.3.3.cmml"><mi id="S4.E8.m1.3.3.3" xref="S4.E8.m1.3.3.3.cmml">𝐯</mi><mrow id="S4.E8.m1.3.3.1" xref="S4.E8.m1.3.3.1.cmml"><msqrt id="S4.E8.m1.3.3.1.3" xref="S4.E8.m1.3.3.1.3.cmml"><mi id="S4.E8.m1.3.3.1.3.2" xref="S4.E8.m1.3.3.1.3.2.cmml">γ</mi></msqrt><mo lspace="0em" rspace="0em" id="S4.E8.m1.3.3.1.2" xref="S4.E8.m1.3.3.1.2.cmml">​</mo><mrow id="S4.E8.m1.3.3.1.4.2" xref="S4.E8.m1.3.3.1.4.1.cmml"><mo stretchy="false" id="S4.E8.m1.3.3.1.4.2.1" xref="S4.E8.m1.3.3.1.4.1.1.cmml">‖</mo><mi id="S4.E8.m1.3.3.1.1" xref="S4.E8.m1.3.3.1.1.cmml">𝐯</mi><mo stretchy="false" id="S4.E8.m1.3.3.1.4.2.2" xref="S4.E8.m1.3.3.1.4.1.1.cmml">‖</mo></mrow></mrow></mfrac></mrow><mo id="S4.E8.m1.7.7.2.1.1.3" xref="S4.E8.m1.7.7.2.1.1.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.E8.m1.7b"><apply id="S4.E8.m1.7.7.cmml" xref="S4.E8.m1.7.7"><eq id="S4.E8.m1.7.7.3.cmml" xref="S4.E8.m1.7.7.3"></eq><apply id="S4.E8.m1.6.6.1.2.cmml" xref="S4.E8.m1.6.6.1.1"><apply id="S4.E8.m1.6.6.1.1.1.cmml" xref="S4.E8.m1.6.6.1.1.1"><csymbol cd="ambiguous" id="S4.E8.m1.6.6.1.1.1.1.cmml" xref="S4.E8.m1.6.6.1.1.1">superscript</csymbol><apply id="S4.E8.m1.6.6.1.1.1.2.cmml" xref="S4.E8.m1.6.6.1.1.1"><csymbol cd="ambiguous" id="S4.E8.m1.6.6.1.1.1.2.1.cmml" xref="S4.E8.m1.6.6.1.1.1">subscript</csymbol><exp id="S4.E8.m1.6.6.1.1.1.2.2.cmml" xref="S4.E8.m1.6.6.1.1.1.2.2"></exp><ci id="S4.E8.m1.6.6.1.1.1.2.3.cmml" xref="S4.E8.m1.6.6.1.1.1.2.3">𝐱</ci></apply><ci id="S4.E8.m1.6.6.1.1.1.3.cmml" xref="S4.E8.m1.6.6.1.1.1.3">𝛾</ci></apply><ci id="S4.E8.m1.4.4.cmml" xref="S4.E8.m1.4.4">𝐯</ci></apply><apply id="S4.E8.m1.7.7.2.cmml" xref="S4.E8.m1.7.7.2"><apply id="S4.E8.m1.7.7.2.2.cmml" xref="S4.E8.m1.7.7.2.2"><csymbol cd="ambiguous" id="S4.E8.m1.7.7.2.2.1.cmml" xref="S4.E8.m1.7.7.2.2">subscript</csymbol><csymbol cd="latexml" id="S4.E8.m1.7.7.2.2.2.cmml" xref="S4.E8.m1.7.7.2.2.2">direct-sum</csymbol><ci id="S4.E8.m1.7.7.2.2.3.cmml" xref="S4.E8.m1.7.7.2.2.3">𝛾</ci></apply><ci id="S4.E8.m1.7.7.2.3.cmml" xref="S4.E8.m1.7.7.2.3">𝐱</ci><apply id="S4.E8.m1.7.7.2.1.1.1.cmml" xref="S4.E8.m1.7.7.2.1.1"><times id="S4.E8.m1.7.7.2.1.1.1.1.cmml" xref="S4.E8.m1.7.7.2.1.1.1.1"></times><apply id="S4.E8.m1.7.7.2.1.1.1.2.1.cmml" xref="S4.E8.m1.7.7.2.1.1.1.2.2"><tanh id="S4.E8.m1.5.5.cmml" xref="S4.E8.m1.5.5"></tanh><apply id="S4.E8.m1.2.2.cmml" xref="S4.E8.m1.2.2"><divide id="S4.E8.m1.2.2.3.cmml" xref="S4.E8.m1.2.2"></divide><apply id="S4.E8.m1.1.1.1.cmml" xref="S4.E8.m1.1.1.1"><times id="S4.E8.m1.1.1.1.2.cmml" xref="S4.E8.m1.1.1.1.2"></times><apply id="S4.E8.m1.1.1.1.3.cmml" xref="S4.E8.m1.1.1.1.3"><root id="S4.E8.m1.1.1.1.3a.cmml" xref="S4.E8.m1.1.1.1.3"></root><ci id="S4.E8.m1.1.1.1.3.2.cmml" xref="S4.E8.m1.1.1.1.3.2">𝛾</ci></apply><apply id="S4.E8.m1.1.1.1.4.1.cmml" xref="S4.E8.m1.1.1.1.4.2"><csymbol cd="latexml" id="S4.E8.m1.1.1.1.4.1.1.cmml" xref="S4.E8.m1.1.1.1.4.2.1">norm</csymbol><ci id="S4.E8.m1.1.1.1.1.cmml" xref="S4.E8.m1.1.1.1.1">𝐯</ci></apply></apply><apply id="S4.E8.m1.2.2.2.cmml" xref="S4.E8.m1.2.2.2"><minus id="S4.E8.m1.2.2.2.2.cmml" xref="S4.E8.m1.2.2.2.2"></minus><cn type="integer" id="S4.E8.m1.2.2.2.3.cmml" xref="S4.E8.m1.2.2.2.3">1</cn><apply id="S4.E8.m1.2.2.2.4.cmml" xref="S4.E8.m1.2.2.2.4"><times id="S4.E8.m1.2.2.2.4.1.cmml" xref="S4.E8.m1.2.2.2.4.1"></times><ci id="S4.E8.m1.2.2.2.4.2.cmml" xref="S4.E8.m1.2.2.2.4.2">𝛾</ci><apply id="S4.E8.m1.2.2.2.4.3.cmml" xref="S4.E8.m1.2.2.2.4.3"><csymbol cd="ambiguous" id="S4.E8.m1.2.2.2.4.3.1.cmml" xref="S4.E8.m1.2.2.2.4.3">superscript</csymbol><apply id="S4.E8.m1.2.2.2.4.3.2.1.cmml" xref="S4.E8.m1.2.2.2.4.3.2.2"><csymbol cd="latexml" id="S4.E8.m1.2.2.2.4.3.2.1.1.cmml" xref="S4.E8.m1.2.2.2.4.3.2.2.1">norm</csymbol><ci id="S4.E8.m1.2.2.2.1.cmml" xref="S4.E8.m1.2.2.2.1">𝐯</ci></apply><cn type="integer" id="S4.E8.m1.2.2.2.4.3.3.cmml" xref="S4.E8.m1.2.2.2.4.3.3">2</cn></apply></apply></apply></apply></apply><apply id="S4.E8.m1.3.3.cmml" xref="S4.E8.m1.3.3"><divide id="S4.E8.m1.3.3.2.cmml" xref="S4.E8.m1.3.3"></divide><ci id="S4.E8.m1.3.3.3.cmml" xref="S4.E8.m1.3.3.3">𝐯</ci><apply id="S4.E8.m1.3.3.1.cmml" xref="S4.E8.m1.3.3.1"><times id="S4.E8.m1.3.3.1.2.cmml" xref="S4.E8.m1.3.3.1.2"></times><apply id="S4.E8.m1.3.3.1.3.cmml" xref="S4.E8.m1.3.3.1.3"><root id="S4.E8.m1.3.3.1.3a.cmml" xref="S4.E8.m1.3.3.1.3"></root><ci id="S4.E8.m1.3.3.1.3.2.cmml" xref="S4.E8.m1.3.3.1.3.2">𝛾</ci></apply><apply id="S4.E8.m1.3.3.1.4.1.cmml" xref="S4.E8.m1.3.3.1.4.2"><csymbol cd="latexml" id="S4.E8.m1.3.3.1.4.1.1.cmml" xref="S4.E8.m1.3.3.1.4.2.1">norm</csymbol><ci id="S4.E8.m1.3.3.1.1.cmml" xref="S4.E8.m1.3.3.1.1">𝐯</ci></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.E8.m1.7c">\exp_{\mathbf{x}}^{\gamma}(\mathbf{v})=\mathbf{x}\oplus_{\gamma}\left(\tanh\left(\frac{\sqrt{\gamma}\|\mathbf{v}\|}{1-\gamma\|\mathbf{v}\|^{2}}\right)\frac{\mathbf{v}}{\sqrt{\gamma}\|\mathbf{v}\|}\right)</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(8)</span></td>
</tr></tbody>
</table>
<p id="S4.SS3.p3.7" class="ltx_p">The prototypes are determined as the midpoints of the hyperbolic feature vectors <math id="S4.SS3.p3.7.m1.1" class="ltx_Math" alttext="\{\mathbf{f}_{i}:=\mathbf{f}^{hyp}_{i}\in\mathbb{B}_{c}^{n}\}" display="inline"><semantics id="S4.SS3.p3.7.m1.1a"><mrow id="S4.SS3.p3.7.m1.1.1.1" xref="S4.SS3.p3.7.m1.1.1.2.cmml"><mo stretchy="false" id="S4.SS3.p3.7.m1.1.1.1.2" xref="S4.SS3.p3.7.m1.1.1.2.cmml">{</mo><mrow id="S4.SS3.p3.7.m1.1.1.1.1" xref="S4.SS3.p3.7.m1.1.1.1.1.cmml"><msub id="S4.SS3.p3.7.m1.1.1.1.1.2" xref="S4.SS3.p3.7.m1.1.1.1.1.2.cmml"><mi id="S4.SS3.p3.7.m1.1.1.1.1.2.2" xref="S4.SS3.p3.7.m1.1.1.1.1.2.2.cmml">𝐟</mi><mi id="S4.SS3.p3.7.m1.1.1.1.1.2.3" xref="S4.SS3.p3.7.m1.1.1.1.1.2.3.cmml">i</mi></msub><mo lspace="0.278em" rspace="0.278em" id="S4.SS3.p3.7.m1.1.1.1.1.3" xref="S4.SS3.p3.7.m1.1.1.1.1.3.cmml">:=</mo><msubsup id="S4.SS3.p3.7.m1.1.1.1.1.4" xref="S4.SS3.p3.7.m1.1.1.1.1.4.cmml"><mi id="S4.SS3.p3.7.m1.1.1.1.1.4.2.2" xref="S4.SS3.p3.7.m1.1.1.1.1.4.2.2.cmml">𝐟</mi><mi id="S4.SS3.p3.7.m1.1.1.1.1.4.3" xref="S4.SS3.p3.7.m1.1.1.1.1.4.3.cmml">i</mi><mrow id="S4.SS3.p3.7.m1.1.1.1.1.4.2.3" xref="S4.SS3.p3.7.m1.1.1.1.1.4.2.3.cmml"><mi id="S4.SS3.p3.7.m1.1.1.1.1.4.2.3.2" xref="S4.SS3.p3.7.m1.1.1.1.1.4.2.3.2.cmml">h</mi><mo lspace="0em" rspace="0em" id="S4.SS3.p3.7.m1.1.1.1.1.4.2.3.1" xref="S4.SS3.p3.7.m1.1.1.1.1.4.2.3.1.cmml">​</mo><mi id="S4.SS3.p3.7.m1.1.1.1.1.4.2.3.3" xref="S4.SS3.p3.7.m1.1.1.1.1.4.2.3.3.cmml">y</mi><mo lspace="0em" rspace="0em" id="S4.SS3.p3.7.m1.1.1.1.1.4.2.3.1a" xref="S4.SS3.p3.7.m1.1.1.1.1.4.2.3.1.cmml">​</mo><mi id="S4.SS3.p3.7.m1.1.1.1.1.4.2.3.4" xref="S4.SS3.p3.7.m1.1.1.1.1.4.2.3.4.cmml">p</mi></mrow></msubsup><mo id="S4.SS3.p3.7.m1.1.1.1.1.5" xref="S4.SS3.p3.7.m1.1.1.1.1.5.cmml">∈</mo><msubsup id="S4.SS3.p3.7.m1.1.1.1.1.6" xref="S4.SS3.p3.7.m1.1.1.1.1.6.cmml"><mi id="S4.SS3.p3.7.m1.1.1.1.1.6.2.2" xref="S4.SS3.p3.7.m1.1.1.1.1.6.2.2.cmml">𝔹</mi><mi id="S4.SS3.p3.7.m1.1.1.1.1.6.2.3" xref="S4.SS3.p3.7.m1.1.1.1.1.6.2.3.cmml">c</mi><mi id="S4.SS3.p3.7.m1.1.1.1.1.6.3" xref="S4.SS3.p3.7.m1.1.1.1.1.6.3.cmml">n</mi></msubsup></mrow><mo stretchy="false" id="S4.SS3.p3.7.m1.1.1.1.3" xref="S4.SS3.p3.7.m1.1.1.2.cmml">}</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.SS3.p3.7.m1.1b"><set id="S4.SS3.p3.7.m1.1.1.2.cmml" xref="S4.SS3.p3.7.m1.1.1.1"><apply id="S4.SS3.p3.7.m1.1.1.1.1.cmml" xref="S4.SS3.p3.7.m1.1.1.1.1"><and id="S4.SS3.p3.7.m1.1.1.1.1a.cmml" xref="S4.SS3.p3.7.m1.1.1.1.1"></and><apply id="S4.SS3.p3.7.m1.1.1.1.1b.cmml" xref="S4.SS3.p3.7.m1.1.1.1.1"><csymbol cd="latexml" id="S4.SS3.p3.7.m1.1.1.1.1.3.cmml" xref="S4.SS3.p3.7.m1.1.1.1.1.3">assign</csymbol><apply id="S4.SS3.p3.7.m1.1.1.1.1.2.cmml" xref="S4.SS3.p3.7.m1.1.1.1.1.2"><csymbol cd="ambiguous" id="S4.SS3.p3.7.m1.1.1.1.1.2.1.cmml" xref="S4.SS3.p3.7.m1.1.1.1.1.2">subscript</csymbol><ci id="S4.SS3.p3.7.m1.1.1.1.1.2.2.cmml" xref="S4.SS3.p3.7.m1.1.1.1.1.2.2">𝐟</ci><ci id="S4.SS3.p3.7.m1.1.1.1.1.2.3.cmml" xref="S4.SS3.p3.7.m1.1.1.1.1.2.3">𝑖</ci></apply><apply id="S4.SS3.p3.7.m1.1.1.1.1.4.cmml" xref="S4.SS3.p3.7.m1.1.1.1.1.4"><csymbol cd="ambiguous" id="S4.SS3.p3.7.m1.1.1.1.1.4.1.cmml" xref="S4.SS3.p3.7.m1.1.1.1.1.4">subscript</csymbol><apply id="S4.SS3.p3.7.m1.1.1.1.1.4.2.cmml" xref="S4.SS3.p3.7.m1.1.1.1.1.4"><csymbol cd="ambiguous" id="S4.SS3.p3.7.m1.1.1.1.1.4.2.1.cmml" xref="S4.SS3.p3.7.m1.1.1.1.1.4">superscript</csymbol><ci id="S4.SS3.p3.7.m1.1.1.1.1.4.2.2.cmml" xref="S4.SS3.p3.7.m1.1.1.1.1.4.2.2">𝐟</ci><apply id="S4.SS3.p3.7.m1.1.1.1.1.4.2.3.cmml" xref="S4.SS3.p3.7.m1.1.1.1.1.4.2.3"><times id="S4.SS3.p3.7.m1.1.1.1.1.4.2.3.1.cmml" xref="S4.SS3.p3.7.m1.1.1.1.1.4.2.3.1"></times><ci id="S4.SS3.p3.7.m1.1.1.1.1.4.2.3.2.cmml" xref="S4.SS3.p3.7.m1.1.1.1.1.4.2.3.2">ℎ</ci><ci id="S4.SS3.p3.7.m1.1.1.1.1.4.2.3.3.cmml" xref="S4.SS3.p3.7.m1.1.1.1.1.4.2.3.3">𝑦</ci><ci id="S4.SS3.p3.7.m1.1.1.1.1.4.2.3.4.cmml" xref="S4.SS3.p3.7.m1.1.1.1.1.4.2.3.4">𝑝</ci></apply></apply><ci id="S4.SS3.p3.7.m1.1.1.1.1.4.3.cmml" xref="S4.SS3.p3.7.m1.1.1.1.1.4.3">𝑖</ci></apply></apply><apply id="S4.SS3.p3.7.m1.1.1.1.1c.cmml" xref="S4.SS3.p3.7.m1.1.1.1.1"><in id="S4.SS3.p3.7.m1.1.1.1.1.5.cmml" xref="S4.SS3.p3.7.m1.1.1.1.1.5"></in><share href="#S4.SS3.p3.7.m1.1.1.1.1.4.cmml" id="S4.SS3.p3.7.m1.1.1.1.1d.cmml" xref="S4.SS3.p3.7.m1.1.1.1.1"></share><apply id="S4.SS3.p3.7.m1.1.1.1.1.6.cmml" xref="S4.SS3.p3.7.m1.1.1.1.1.6"><csymbol cd="ambiguous" id="S4.SS3.p3.7.m1.1.1.1.1.6.1.cmml" xref="S4.SS3.p3.7.m1.1.1.1.1.6">superscript</csymbol><apply id="S4.SS3.p3.7.m1.1.1.1.1.6.2.cmml" xref="S4.SS3.p3.7.m1.1.1.1.1.6"><csymbol cd="ambiguous" id="S4.SS3.p3.7.m1.1.1.1.1.6.2.1.cmml" xref="S4.SS3.p3.7.m1.1.1.1.1.6">subscript</csymbol><ci id="S4.SS3.p3.7.m1.1.1.1.1.6.2.2.cmml" xref="S4.SS3.p3.7.m1.1.1.1.1.6.2.2">𝔹</ci><ci id="S4.SS3.p3.7.m1.1.1.1.1.6.2.3.cmml" xref="S4.SS3.p3.7.m1.1.1.1.1.6.2.3">𝑐</ci></apply><ci id="S4.SS3.p3.7.m1.1.1.1.1.6.3.cmml" xref="S4.SS3.p3.7.m1.1.1.1.1.6.3">𝑛</ci></apply></apply></apply></set></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p3.7.m1.1c">\{\mathbf{f}_{i}:=\mathbf{f}^{hyp}_{i}\in\mathbb{B}_{c}^{n}\}</annotation></semantics></math>, using an approximation of the Frechet mean:</p>
<table id="S4.E9" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S4.E9.m1.1" class="ltx_Math" alttext="\mathbf{p}=\frac{1}{2}\otimes_{\gamma}\frac{\sum_{\mathbf{f}\in\mathcal{F}}\lambda_{\mathbf{f}}^{\gamma}\mathbf{f}}{\sum_{\mathbf{f}\in\mathcal{F}}(\lambda_{\mathbf{f}}^{\gamma}-1)}" display="block"><semantics id="S4.E9.m1.1a"><mrow id="S4.E9.m1.1.2" xref="S4.E9.m1.1.2.cmml"><mi id="S4.E9.m1.1.2.2" xref="S4.E9.m1.1.2.2.cmml">𝐩</mi><mo id="S4.E9.m1.1.2.1" xref="S4.E9.m1.1.2.1.cmml">=</mo><mrow id="S4.E9.m1.1.2.3" xref="S4.E9.m1.1.2.3.cmml"><mfrac id="S4.E9.m1.1.2.3.2" xref="S4.E9.m1.1.2.3.2.cmml"><mn id="S4.E9.m1.1.2.3.2.2" xref="S4.E9.m1.1.2.3.2.2.cmml">1</mn><mn id="S4.E9.m1.1.2.3.2.3" xref="S4.E9.m1.1.2.3.2.3.cmml">2</mn></mfrac><msub id="S4.E9.m1.1.2.3.1" xref="S4.E9.m1.1.2.3.1.cmml"><mo lspace="0.222em" rspace="0.222em" id="S4.E9.m1.1.2.3.1.2" xref="S4.E9.m1.1.2.3.1.2.cmml">⊗</mo><mi id="S4.E9.m1.1.2.3.1.3" xref="S4.E9.m1.1.2.3.1.3.cmml">γ</mi></msub><mfrac id="S4.E9.m1.1.1" xref="S4.E9.m1.1.1.cmml"><mrow id="S4.E9.m1.1.1.3" xref="S4.E9.m1.1.1.3.cmml"><msub id="S4.E9.m1.1.1.3.1" xref="S4.E9.m1.1.1.3.1.cmml"><mo id="S4.E9.m1.1.1.3.1.2" xref="S4.E9.m1.1.1.3.1.2.cmml">∑</mo><mrow id="S4.E9.m1.1.1.3.1.3" xref="S4.E9.m1.1.1.3.1.3.cmml"><mi id="S4.E9.m1.1.1.3.1.3.2" xref="S4.E9.m1.1.1.3.1.3.2.cmml">𝐟</mi><mo id="S4.E9.m1.1.1.3.1.3.1" xref="S4.E9.m1.1.1.3.1.3.1.cmml">∈</mo><mi class="ltx_font_mathcaligraphic" id="S4.E9.m1.1.1.3.1.3.3" xref="S4.E9.m1.1.1.3.1.3.3.cmml">ℱ</mi></mrow></msub><mrow id="S4.E9.m1.1.1.3.2" xref="S4.E9.m1.1.1.3.2.cmml"><msubsup id="S4.E9.m1.1.1.3.2.2" xref="S4.E9.m1.1.1.3.2.2.cmml"><mi id="S4.E9.m1.1.1.3.2.2.2.2" xref="S4.E9.m1.1.1.3.2.2.2.2.cmml">λ</mi><mi id="S4.E9.m1.1.1.3.2.2.2.3" xref="S4.E9.m1.1.1.3.2.2.2.3.cmml">𝐟</mi><mi id="S4.E9.m1.1.1.3.2.2.3" xref="S4.E9.m1.1.1.3.2.2.3.cmml">γ</mi></msubsup><mo lspace="0em" rspace="0em" id="S4.E9.m1.1.1.3.2.1" xref="S4.E9.m1.1.1.3.2.1.cmml">​</mo><mi id="S4.E9.m1.1.1.3.2.3" xref="S4.E9.m1.1.1.3.2.3.cmml">𝐟</mi></mrow></mrow><mrow id="S4.E9.m1.1.1.1" xref="S4.E9.m1.1.1.1.cmml"><msub id="S4.E9.m1.1.1.1.2" xref="S4.E9.m1.1.1.1.2.cmml"><mo id="S4.E9.m1.1.1.1.2.2" xref="S4.E9.m1.1.1.1.2.2.cmml">∑</mo><mrow id="S4.E9.m1.1.1.1.2.3" xref="S4.E9.m1.1.1.1.2.3.cmml"><mi id="S4.E9.m1.1.1.1.2.3.2" xref="S4.E9.m1.1.1.1.2.3.2.cmml">𝐟</mi><mo id="S4.E9.m1.1.1.1.2.3.1" xref="S4.E9.m1.1.1.1.2.3.1.cmml">∈</mo><mi class="ltx_font_mathcaligraphic" id="S4.E9.m1.1.1.1.2.3.3" xref="S4.E9.m1.1.1.1.2.3.3.cmml">ℱ</mi></mrow></msub><mrow id="S4.E9.m1.1.1.1.1.1" xref="S4.E9.m1.1.1.1.1.1.1.cmml"><mo lspace="0em" stretchy="false" id="S4.E9.m1.1.1.1.1.1.2" xref="S4.E9.m1.1.1.1.1.1.1.cmml">(</mo><mrow id="S4.E9.m1.1.1.1.1.1.1" xref="S4.E9.m1.1.1.1.1.1.1.cmml"><msubsup id="S4.E9.m1.1.1.1.1.1.1.2" xref="S4.E9.m1.1.1.1.1.1.1.2.cmml"><mi id="S4.E9.m1.1.1.1.1.1.1.2.2.2" xref="S4.E9.m1.1.1.1.1.1.1.2.2.2.cmml">λ</mi><mi id="S4.E9.m1.1.1.1.1.1.1.2.2.3" xref="S4.E9.m1.1.1.1.1.1.1.2.2.3.cmml">𝐟</mi><mi id="S4.E9.m1.1.1.1.1.1.1.2.3" xref="S4.E9.m1.1.1.1.1.1.1.2.3.cmml">γ</mi></msubsup><mo id="S4.E9.m1.1.1.1.1.1.1.1" xref="S4.E9.m1.1.1.1.1.1.1.1.cmml">−</mo><mn id="S4.E9.m1.1.1.1.1.1.1.3" xref="S4.E9.m1.1.1.1.1.1.1.3.cmml">1</mn></mrow><mo stretchy="false" id="S4.E9.m1.1.1.1.1.1.3" xref="S4.E9.m1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mfrac></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.E9.m1.1b"><apply id="S4.E9.m1.1.2.cmml" xref="S4.E9.m1.1.2"><eq id="S4.E9.m1.1.2.1.cmml" xref="S4.E9.m1.1.2.1"></eq><ci id="S4.E9.m1.1.2.2.cmml" xref="S4.E9.m1.1.2.2">𝐩</ci><apply id="S4.E9.m1.1.2.3.cmml" xref="S4.E9.m1.1.2.3"><apply id="S4.E9.m1.1.2.3.1.cmml" xref="S4.E9.m1.1.2.3.1"><csymbol cd="ambiguous" id="S4.E9.m1.1.2.3.1.1.cmml" xref="S4.E9.m1.1.2.3.1">subscript</csymbol><csymbol cd="latexml" id="S4.E9.m1.1.2.3.1.2.cmml" xref="S4.E9.m1.1.2.3.1.2">tensor-product</csymbol><ci id="S4.E9.m1.1.2.3.1.3.cmml" xref="S4.E9.m1.1.2.3.1.3">𝛾</ci></apply><apply id="S4.E9.m1.1.2.3.2.cmml" xref="S4.E9.m1.1.2.3.2"><divide id="S4.E9.m1.1.2.3.2.1.cmml" xref="S4.E9.m1.1.2.3.2"></divide><cn type="integer" id="S4.E9.m1.1.2.3.2.2.cmml" xref="S4.E9.m1.1.2.3.2.2">1</cn><cn type="integer" id="S4.E9.m1.1.2.3.2.3.cmml" xref="S4.E9.m1.1.2.3.2.3">2</cn></apply><apply id="S4.E9.m1.1.1.cmml" xref="S4.E9.m1.1.1"><divide id="S4.E9.m1.1.1.2.cmml" xref="S4.E9.m1.1.1"></divide><apply id="S4.E9.m1.1.1.3.cmml" xref="S4.E9.m1.1.1.3"><apply id="S4.E9.m1.1.1.3.1.cmml" xref="S4.E9.m1.1.1.3.1"><csymbol cd="ambiguous" id="S4.E9.m1.1.1.3.1.1.cmml" xref="S4.E9.m1.1.1.3.1">subscript</csymbol><sum id="S4.E9.m1.1.1.3.1.2.cmml" xref="S4.E9.m1.1.1.3.1.2"></sum><apply id="S4.E9.m1.1.1.3.1.3.cmml" xref="S4.E9.m1.1.1.3.1.3"><in id="S4.E9.m1.1.1.3.1.3.1.cmml" xref="S4.E9.m1.1.1.3.1.3.1"></in><ci id="S4.E9.m1.1.1.3.1.3.2.cmml" xref="S4.E9.m1.1.1.3.1.3.2">𝐟</ci><ci id="S4.E9.m1.1.1.3.1.3.3.cmml" xref="S4.E9.m1.1.1.3.1.3.3">ℱ</ci></apply></apply><apply id="S4.E9.m1.1.1.3.2.cmml" xref="S4.E9.m1.1.1.3.2"><times id="S4.E9.m1.1.1.3.2.1.cmml" xref="S4.E9.m1.1.1.3.2.1"></times><apply id="S4.E9.m1.1.1.3.2.2.cmml" xref="S4.E9.m1.1.1.3.2.2"><csymbol cd="ambiguous" id="S4.E9.m1.1.1.3.2.2.1.cmml" xref="S4.E9.m1.1.1.3.2.2">superscript</csymbol><apply id="S4.E9.m1.1.1.3.2.2.2.cmml" xref="S4.E9.m1.1.1.3.2.2"><csymbol cd="ambiguous" id="S4.E9.m1.1.1.3.2.2.2.1.cmml" xref="S4.E9.m1.1.1.3.2.2">subscript</csymbol><ci id="S4.E9.m1.1.1.3.2.2.2.2.cmml" xref="S4.E9.m1.1.1.3.2.2.2.2">𝜆</ci><ci id="S4.E9.m1.1.1.3.2.2.2.3.cmml" xref="S4.E9.m1.1.1.3.2.2.2.3">𝐟</ci></apply><ci id="S4.E9.m1.1.1.3.2.2.3.cmml" xref="S4.E9.m1.1.1.3.2.2.3">𝛾</ci></apply><ci id="S4.E9.m1.1.1.3.2.3.cmml" xref="S4.E9.m1.1.1.3.2.3">𝐟</ci></apply></apply><apply id="S4.E9.m1.1.1.1.cmml" xref="S4.E9.m1.1.1.1"><apply id="S4.E9.m1.1.1.1.2.cmml" xref="S4.E9.m1.1.1.1.2"><csymbol cd="ambiguous" id="S4.E9.m1.1.1.1.2.1.cmml" xref="S4.E9.m1.1.1.1.2">subscript</csymbol><sum id="S4.E9.m1.1.1.1.2.2.cmml" xref="S4.E9.m1.1.1.1.2.2"></sum><apply id="S4.E9.m1.1.1.1.2.3.cmml" xref="S4.E9.m1.1.1.1.2.3"><in id="S4.E9.m1.1.1.1.2.3.1.cmml" xref="S4.E9.m1.1.1.1.2.3.1"></in><ci id="S4.E9.m1.1.1.1.2.3.2.cmml" xref="S4.E9.m1.1.1.1.2.3.2">𝐟</ci><ci id="S4.E9.m1.1.1.1.2.3.3.cmml" xref="S4.E9.m1.1.1.1.2.3.3">ℱ</ci></apply></apply><apply id="S4.E9.m1.1.1.1.1.1.1.cmml" xref="S4.E9.m1.1.1.1.1.1"><minus id="S4.E9.m1.1.1.1.1.1.1.1.cmml" xref="S4.E9.m1.1.1.1.1.1.1.1"></minus><apply id="S4.E9.m1.1.1.1.1.1.1.2.cmml" xref="S4.E9.m1.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S4.E9.m1.1.1.1.1.1.1.2.1.cmml" xref="S4.E9.m1.1.1.1.1.1.1.2">superscript</csymbol><apply id="S4.E9.m1.1.1.1.1.1.1.2.2.cmml" xref="S4.E9.m1.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S4.E9.m1.1.1.1.1.1.1.2.2.1.cmml" xref="S4.E9.m1.1.1.1.1.1.1.2">subscript</csymbol><ci id="S4.E9.m1.1.1.1.1.1.1.2.2.2.cmml" xref="S4.E9.m1.1.1.1.1.1.1.2.2.2">𝜆</ci><ci id="S4.E9.m1.1.1.1.1.1.1.2.2.3.cmml" xref="S4.E9.m1.1.1.1.1.1.1.2.2.3">𝐟</ci></apply><ci id="S4.E9.m1.1.1.1.1.1.1.2.3.cmml" xref="S4.E9.m1.1.1.1.1.1.1.2.3">𝛾</ci></apply><cn type="integer" id="S4.E9.m1.1.1.1.1.1.1.3.cmml" xref="S4.E9.m1.1.1.1.1.1.1.3">1</cn></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.E9.m1.1c">\mathbf{p}=\frac{1}{2}\otimes_{\gamma}\frac{\sum_{\mathbf{f}\in\mathcal{F}}\lambda_{\mathbf{f}}^{\gamma}\mathbf{f}}{\sum_{\mathbf{f}\in\mathcal{F}}(\lambda_{\mathbf{f}}^{\gamma}-1)}</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(9)</span></td>
</tr></tbody>
</table>
<p id="S4.SS3.p3.8" class="ltx_p">where the Möbius scalar multiplication is:</p>
<table id="S4.E10" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S4.E10.m1.4" class="ltx_Math" alttext="r\otimes_{\gamma}\mathbf{x}=\frac{1}{\sqrt{\gamma}}\tanh\left(r\tanh^{-1}(\sqrt{\gamma}\|\mathbf{x}\|)\right)\frac{\mathbf{x}}{\|\mathbf{x}\|}" display="block"><semantics id="S4.E10.m1.4a"><mrow id="S4.E10.m1.4.4" xref="S4.E10.m1.4.4.cmml"><mrow id="S4.E10.m1.4.4.3" xref="S4.E10.m1.4.4.3.cmml"><mi id="S4.E10.m1.4.4.3.2" xref="S4.E10.m1.4.4.3.2.cmml">r</mi><msub id="S4.E10.m1.4.4.3.1" xref="S4.E10.m1.4.4.3.1.cmml"><mo lspace="0.222em" rspace="0.222em" id="S4.E10.m1.4.4.3.1.2" xref="S4.E10.m1.4.4.3.1.2.cmml">⊗</mo><mi id="S4.E10.m1.4.4.3.1.3" xref="S4.E10.m1.4.4.3.1.3.cmml">γ</mi></msub><mi id="S4.E10.m1.4.4.3.3" xref="S4.E10.m1.4.4.3.3.cmml">𝐱</mi></mrow><mo id="S4.E10.m1.4.4.2" xref="S4.E10.m1.4.4.2.cmml">=</mo><mrow id="S4.E10.m1.4.4.1" xref="S4.E10.m1.4.4.1.cmml"><mfrac id="S4.E10.m1.4.4.1.3" xref="S4.E10.m1.4.4.1.3.cmml"><mn id="S4.E10.m1.4.4.1.3.2" xref="S4.E10.m1.4.4.1.3.2.cmml">1</mn><msqrt id="S4.E10.m1.4.4.1.3.3" xref="S4.E10.m1.4.4.1.3.3.cmml"><mi id="S4.E10.m1.4.4.1.3.3.2" xref="S4.E10.m1.4.4.1.3.3.2.cmml">γ</mi></msqrt></mfrac><mo lspace="0.167em" rspace="0em" id="S4.E10.m1.4.4.1.2" xref="S4.E10.m1.4.4.1.2.cmml">​</mo><mrow id="S4.E10.m1.4.4.1.1.1" xref="S4.E10.m1.4.4.1.1.2.cmml"><mi id="S4.E10.m1.3.3" xref="S4.E10.m1.3.3.cmml">tanh</mi><mo id="S4.E10.m1.4.4.1.1.1a" xref="S4.E10.m1.4.4.1.1.2.cmml">⁡</mo><mrow id="S4.E10.m1.4.4.1.1.1.1" xref="S4.E10.m1.4.4.1.1.2.cmml"><mo id="S4.E10.m1.4.4.1.1.1.1.2" xref="S4.E10.m1.4.4.1.1.2.cmml">(</mo><mrow id="S4.E10.m1.4.4.1.1.1.1.1" xref="S4.E10.m1.4.4.1.1.1.1.1.cmml"><mi id="S4.E10.m1.4.4.1.1.1.1.1.4" xref="S4.E10.m1.4.4.1.1.1.1.1.4.cmml">r</mi><mo lspace="0.167em" rspace="0em" id="S4.E10.m1.4.4.1.1.1.1.1.3" xref="S4.E10.m1.4.4.1.1.1.1.1.3.cmml">​</mo><mrow id="S4.E10.m1.4.4.1.1.1.1.1.2.2" xref="S4.E10.m1.4.4.1.1.1.1.1.2.3.cmml"><msup id="S4.E10.m1.4.4.1.1.1.1.1.1.1.1" xref="S4.E10.m1.4.4.1.1.1.1.1.1.1.1.cmml"><mi id="S4.E10.m1.4.4.1.1.1.1.1.1.1.1.2" xref="S4.E10.m1.4.4.1.1.1.1.1.1.1.1.2.cmml">tanh</mi><mrow id="S4.E10.m1.4.4.1.1.1.1.1.1.1.1.3" xref="S4.E10.m1.4.4.1.1.1.1.1.1.1.1.3.cmml"><mo id="S4.E10.m1.4.4.1.1.1.1.1.1.1.1.3a" xref="S4.E10.m1.4.4.1.1.1.1.1.1.1.1.3.cmml">−</mo><mn id="S4.E10.m1.4.4.1.1.1.1.1.1.1.1.3.2" xref="S4.E10.m1.4.4.1.1.1.1.1.1.1.1.3.2.cmml">1</mn></mrow></msup><mo id="S4.E10.m1.4.4.1.1.1.1.1.2.2a" xref="S4.E10.m1.4.4.1.1.1.1.1.2.3.cmml">⁡</mo><mrow id="S4.E10.m1.4.4.1.1.1.1.1.2.2.2" xref="S4.E10.m1.4.4.1.1.1.1.1.2.3.cmml"><mo stretchy="false" id="S4.E10.m1.4.4.1.1.1.1.1.2.2.2.2" xref="S4.E10.m1.4.4.1.1.1.1.1.2.3.cmml">(</mo><mrow id="S4.E10.m1.4.4.1.1.1.1.1.2.2.2.1" xref="S4.E10.m1.4.4.1.1.1.1.1.2.2.2.1.cmml"><msqrt id="S4.E10.m1.4.4.1.1.1.1.1.2.2.2.1.2" xref="S4.E10.m1.4.4.1.1.1.1.1.2.2.2.1.2.cmml"><mi id="S4.E10.m1.4.4.1.1.1.1.1.2.2.2.1.2.2" xref="S4.E10.m1.4.4.1.1.1.1.1.2.2.2.1.2.2.cmml">γ</mi></msqrt><mo lspace="0em" rspace="0em" id="S4.E10.m1.4.4.1.1.1.1.1.2.2.2.1.1" xref="S4.E10.m1.4.4.1.1.1.1.1.2.2.2.1.1.cmml">​</mo><mrow id="S4.E10.m1.4.4.1.1.1.1.1.2.2.2.1.3.2" xref="S4.E10.m1.4.4.1.1.1.1.1.2.2.2.1.3.1.cmml"><mo stretchy="false" id="S4.E10.m1.4.4.1.1.1.1.1.2.2.2.1.3.2.1" xref="S4.E10.m1.4.4.1.1.1.1.1.2.2.2.1.3.1.1.cmml">‖</mo><mi id="S4.E10.m1.2.2" xref="S4.E10.m1.2.2.cmml">𝐱</mi><mo stretchy="false" id="S4.E10.m1.4.4.1.1.1.1.1.2.2.2.1.3.2.2" xref="S4.E10.m1.4.4.1.1.1.1.1.2.2.2.1.3.1.1.cmml">‖</mo></mrow></mrow><mo stretchy="false" id="S4.E10.m1.4.4.1.1.1.1.1.2.2.2.3" xref="S4.E10.m1.4.4.1.1.1.1.1.2.3.cmml">)</mo></mrow></mrow></mrow><mo id="S4.E10.m1.4.4.1.1.1.1.3" xref="S4.E10.m1.4.4.1.1.2.cmml">)</mo></mrow></mrow><mo lspace="0em" rspace="0em" id="S4.E10.m1.4.4.1.2a" xref="S4.E10.m1.4.4.1.2.cmml">​</mo><mfrac id="S4.E10.m1.1.1" xref="S4.E10.m1.1.1.cmml"><mi id="S4.E10.m1.1.1.3" xref="S4.E10.m1.1.1.3.cmml">𝐱</mi><mrow id="S4.E10.m1.1.1.1.3" xref="S4.E10.m1.1.1.1.2.cmml"><mo stretchy="false" id="S4.E10.m1.1.1.1.3.1" xref="S4.E10.m1.1.1.1.2.1.cmml">‖</mo><mi id="S4.E10.m1.1.1.1.1" xref="S4.E10.m1.1.1.1.1.cmml">𝐱</mi><mo stretchy="false" id="S4.E10.m1.1.1.1.3.2" xref="S4.E10.m1.1.1.1.2.1.cmml">‖</mo></mrow></mfrac></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.E10.m1.4b"><apply id="S4.E10.m1.4.4.cmml" xref="S4.E10.m1.4.4"><eq id="S4.E10.m1.4.4.2.cmml" xref="S4.E10.m1.4.4.2"></eq><apply id="S4.E10.m1.4.4.3.cmml" xref="S4.E10.m1.4.4.3"><apply id="S4.E10.m1.4.4.3.1.cmml" xref="S4.E10.m1.4.4.3.1"><csymbol cd="ambiguous" id="S4.E10.m1.4.4.3.1.1.cmml" xref="S4.E10.m1.4.4.3.1">subscript</csymbol><csymbol cd="latexml" id="S4.E10.m1.4.4.3.1.2.cmml" xref="S4.E10.m1.4.4.3.1.2">tensor-product</csymbol><ci id="S4.E10.m1.4.4.3.1.3.cmml" xref="S4.E10.m1.4.4.3.1.3">𝛾</ci></apply><ci id="S4.E10.m1.4.4.3.2.cmml" xref="S4.E10.m1.4.4.3.2">𝑟</ci><ci id="S4.E10.m1.4.4.3.3.cmml" xref="S4.E10.m1.4.4.3.3">𝐱</ci></apply><apply id="S4.E10.m1.4.4.1.cmml" xref="S4.E10.m1.4.4.1"><times id="S4.E10.m1.4.4.1.2.cmml" xref="S4.E10.m1.4.4.1.2"></times><apply id="S4.E10.m1.4.4.1.3.cmml" xref="S4.E10.m1.4.4.1.3"><divide id="S4.E10.m1.4.4.1.3.1.cmml" xref="S4.E10.m1.4.4.1.3"></divide><cn type="integer" id="S4.E10.m1.4.4.1.3.2.cmml" xref="S4.E10.m1.4.4.1.3.2">1</cn><apply id="S4.E10.m1.4.4.1.3.3.cmml" xref="S4.E10.m1.4.4.1.3.3"><root id="S4.E10.m1.4.4.1.3.3a.cmml" xref="S4.E10.m1.4.4.1.3.3"></root><ci id="S4.E10.m1.4.4.1.3.3.2.cmml" xref="S4.E10.m1.4.4.1.3.3.2">𝛾</ci></apply></apply><apply id="S4.E10.m1.4.4.1.1.2.cmml" xref="S4.E10.m1.4.4.1.1.1"><tanh id="S4.E10.m1.3.3.cmml" xref="S4.E10.m1.3.3"></tanh><apply id="S4.E10.m1.4.4.1.1.1.1.1.cmml" xref="S4.E10.m1.4.4.1.1.1.1.1"><times id="S4.E10.m1.4.4.1.1.1.1.1.3.cmml" xref="S4.E10.m1.4.4.1.1.1.1.1.3"></times><ci id="S4.E10.m1.4.4.1.1.1.1.1.4.cmml" xref="S4.E10.m1.4.4.1.1.1.1.1.4">𝑟</ci><apply id="S4.E10.m1.4.4.1.1.1.1.1.2.3.cmml" xref="S4.E10.m1.4.4.1.1.1.1.1.2.2"><apply id="S4.E10.m1.4.4.1.1.1.1.1.1.1.1.cmml" xref="S4.E10.m1.4.4.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.E10.m1.4.4.1.1.1.1.1.1.1.1.1.cmml" xref="S4.E10.m1.4.4.1.1.1.1.1.1.1.1">superscript</csymbol><tanh id="S4.E10.m1.4.4.1.1.1.1.1.1.1.1.2.cmml" xref="S4.E10.m1.4.4.1.1.1.1.1.1.1.1.2"></tanh><apply id="S4.E10.m1.4.4.1.1.1.1.1.1.1.1.3.cmml" xref="S4.E10.m1.4.4.1.1.1.1.1.1.1.1.3"><minus id="S4.E10.m1.4.4.1.1.1.1.1.1.1.1.3.1.cmml" xref="S4.E10.m1.4.4.1.1.1.1.1.1.1.1.3"></minus><cn type="integer" id="S4.E10.m1.4.4.1.1.1.1.1.1.1.1.3.2.cmml" xref="S4.E10.m1.4.4.1.1.1.1.1.1.1.1.3.2">1</cn></apply></apply><apply id="S4.E10.m1.4.4.1.1.1.1.1.2.2.2.1.cmml" xref="S4.E10.m1.4.4.1.1.1.1.1.2.2.2.1"><times id="S4.E10.m1.4.4.1.1.1.1.1.2.2.2.1.1.cmml" xref="S4.E10.m1.4.4.1.1.1.1.1.2.2.2.1.1"></times><apply id="S4.E10.m1.4.4.1.1.1.1.1.2.2.2.1.2.cmml" xref="S4.E10.m1.4.4.1.1.1.1.1.2.2.2.1.2"><root id="S4.E10.m1.4.4.1.1.1.1.1.2.2.2.1.2a.cmml" xref="S4.E10.m1.4.4.1.1.1.1.1.2.2.2.1.2"></root><ci id="S4.E10.m1.4.4.1.1.1.1.1.2.2.2.1.2.2.cmml" xref="S4.E10.m1.4.4.1.1.1.1.1.2.2.2.1.2.2">𝛾</ci></apply><apply id="S4.E10.m1.4.4.1.1.1.1.1.2.2.2.1.3.1.cmml" xref="S4.E10.m1.4.4.1.1.1.1.1.2.2.2.1.3.2"><csymbol cd="latexml" id="S4.E10.m1.4.4.1.1.1.1.1.2.2.2.1.3.1.1.cmml" xref="S4.E10.m1.4.4.1.1.1.1.1.2.2.2.1.3.2.1">norm</csymbol><ci id="S4.E10.m1.2.2.cmml" xref="S4.E10.m1.2.2">𝐱</ci></apply></apply></apply></apply></apply><apply id="S4.E10.m1.1.1.cmml" xref="S4.E10.m1.1.1"><divide id="S4.E10.m1.1.1.2.cmml" xref="S4.E10.m1.1.1"></divide><ci id="S4.E10.m1.1.1.3.cmml" xref="S4.E10.m1.1.1.3">𝐱</ci><apply id="S4.E10.m1.1.1.1.2.cmml" xref="S4.E10.m1.1.1.1.3"><csymbol cd="latexml" id="S4.E10.m1.1.1.1.2.1.cmml" xref="S4.E10.m1.1.1.1.3.1">norm</csymbol><ci id="S4.E10.m1.1.1.1.1.cmml" xref="S4.E10.m1.1.1.1.1">𝐱</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.E10.m1.4c">r\otimes_{\gamma}\mathbf{x}=\frac{1}{\sqrt{\gamma}}\tanh\left(r\tanh^{-1}(\sqrt{\gamma}\|\mathbf{x}\|)\right)\frac{\mathbf{x}}{\|\mathbf{x}\|}</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(10)</span></td>
</tr></tbody>
</table>
</div>
<div id="S4.SS3.p4" class="ltx_para">
<p id="S4.SS3.p4.1" class="ltx_p">Since the curvature <math id="S4.SS3.p4.1.m1.1" class="ltx_Math" alttext="\gamma" display="inline"><semantics id="S4.SS3.p4.1.m1.1a"><mi id="S4.SS3.p4.1.m1.1.1" xref="S4.SS3.p4.1.m1.1.1.cmml">γ</mi><annotation-xml encoding="MathML-Content" id="S4.SS3.p4.1.m1.1b"><ci id="S4.SS3.p4.1.m1.1.1.cmml" xref="S4.SS3.p4.1.m1.1.1">𝛾</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p4.1.m1.1c">\gamma</annotation></semantics></math> is a scalar value, we can convert it to a learnable parameter of the network and optimize it during the training process <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib41" title="" class="ltx_ref">41</a>]</cite>. This is done on the client side using self-supervision and prototype loss, then,
at the end of each round, the curvature of the active clients is aggregated using <span id="S4.SS3.p4.1.1" class="ltx_text ltx_font_italic">FedAvg</span> algorithm, i.e., the average is weighted by the number of seen samples.</p>
</div>
<div id="S4.SS3.p5" class="ltx_para ltx_noindent">
<p id="S4.SS3.p5.2" class="ltx_p"><span id="S4.SS3.p5.2.1" class="ltx_text ltx_font_bold">Prototypical Loss.</span> Due to the distribution mismatch between source and target domains and the different viewpoints, feature vectors from these domains become misaligned, leading to inaccuracies in target representations and a subsequent decline in segmentation accuracy. To address this issue, we adopt a clustering objective in the latent space by leveraging prototypical representations:</p>
<table id="S4.E11" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S4.E11.m1.4" class="ltx_Math" alttext="\mathcal{L}_{cl}=\frac{1}{|\hat{\mathcal{C}}|}\sum_{c\in\hat{\mathcal{C}}}\frac{1}{|\mathcal{F}_{c}|}\sum_{\mathbf{f_{c}\in\mathcal{F}_{c}}}d(\mathbf{f}_{c},\mathbf{p}_{c})" display="block"><semantics id="S4.E11.m1.4a"><mrow id="S4.E11.m1.4.4" xref="S4.E11.m1.4.4.cmml"><msub id="S4.E11.m1.4.4.4" xref="S4.E11.m1.4.4.4.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.E11.m1.4.4.4.2" xref="S4.E11.m1.4.4.4.2.cmml">ℒ</mi><mrow id="S4.E11.m1.4.4.4.3" xref="S4.E11.m1.4.4.4.3.cmml"><mi id="S4.E11.m1.4.4.4.3.2" xref="S4.E11.m1.4.4.4.3.2.cmml">c</mi><mo lspace="0em" rspace="0em" id="S4.E11.m1.4.4.4.3.1" xref="S4.E11.m1.4.4.4.3.1.cmml">​</mo><mi id="S4.E11.m1.4.4.4.3.3" xref="S4.E11.m1.4.4.4.3.3.cmml">l</mi></mrow></msub><mo id="S4.E11.m1.4.4.3" xref="S4.E11.m1.4.4.3.cmml">=</mo><mrow id="S4.E11.m1.4.4.2" xref="S4.E11.m1.4.4.2.cmml"><mfrac id="S4.E11.m1.1.1" xref="S4.E11.m1.1.1.cmml"><mn id="S4.E11.m1.1.1.3" xref="S4.E11.m1.1.1.3.cmml">1</mn><mrow id="S4.E11.m1.1.1.1.3" xref="S4.E11.m1.1.1.1.2.cmml"><mo stretchy="false" id="S4.E11.m1.1.1.1.3.1" xref="S4.E11.m1.1.1.1.2.1.cmml">|</mo><mover accent="true" id="S4.E11.m1.1.1.1.1" xref="S4.E11.m1.1.1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.E11.m1.1.1.1.1.2" xref="S4.E11.m1.1.1.1.1.2.cmml">𝒞</mi><mo id="S4.E11.m1.1.1.1.1.1" xref="S4.E11.m1.1.1.1.1.1.cmml">^</mo></mover><mo stretchy="false" id="S4.E11.m1.1.1.1.3.2" xref="S4.E11.m1.1.1.1.2.1.cmml">|</mo></mrow></mfrac><mo lspace="0em" rspace="0em" id="S4.E11.m1.4.4.2.3" xref="S4.E11.m1.4.4.2.3.cmml">​</mo><mrow id="S4.E11.m1.4.4.2.2" xref="S4.E11.m1.4.4.2.2.cmml"><munder id="S4.E11.m1.4.4.2.2.3" xref="S4.E11.m1.4.4.2.2.3.cmml"><mo movablelimits="false" id="S4.E11.m1.4.4.2.2.3.2" xref="S4.E11.m1.4.4.2.2.3.2.cmml">∑</mo><mrow id="S4.E11.m1.4.4.2.2.3.3" xref="S4.E11.m1.4.4.2.2.3.3.cmml"><mi id="S4.E11.m1.4.4.2.2.3.3.2" xref="S4.E11.m1.4.4.2.2.3.3.2.cmml">c</mi><mo id="S4.E11.m1.4.4.2.2.3.3.1" xref="S4.E11.m1.4.4.2.2.3.3.1.cmml">∈</mo><mover accent="true" id="S4.E11.m1.4.4.2.2.3.3.3" xref="S4.E11.m1.4.4.2.2.3.3.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.E11.m1.4.4.2.2.3.3.3.2" xref="S4.E11.m1.4.4.2.2.3.3.3.2.cmml">𝒞</mi><mo id="S4.E11.m1.4.4.2.2.3.3.3.1" xref="S4.E11.m1.4.4.2.2.3.3.3.1.cmml">^</mo></mover></mrow></munder><mrow id="S4.E11.m1.4.4.2.2.2" xref="S4.E11.m1.4.4.2.2.2.cmml"><mfrac id="S4.E11.m1.2.2" xref="S4.E11.m1.2.2.cmml"><mn id="S4.E11.m1.2.2.3" xref="S4.E11.m1.2.2.3.cmml">1</mn><mrow id="S4.E11.m1.2.2.1.1" xref="S4.E11.m1.2.2.1.2.cmml"><mo stretchy="false" id="S4.E11.m1.2.2.1.1.2" xref="S4.E11.m1.2.2.1.2.1.cmml">|</mo><msub id="S4.E11.m1.2.2.1.1.1" xref="S4.E11.m1.2.2.1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.E11.m1.2.2.1.1.1.2" xref="S4.E11.m1.2.2.1.1.1.2.cmml">ℱ</mi><mi id="S4.E11.m1.2.2.1.1.1.3" xref="S4.E11.m1.2.2.1.1.1.3.cmml">c</mi></msub><mo stretchy="false" id="S4.E11.m1.2.2.1.1.3" xref="S4.E11.m1.2.2.1.2.1.cmml">|</mo></mrow></mfrac><mo lspace="0em" rspace="0em" id="S4.E11.m1.4.4.2.2.2.3" xref="S4.E11.m1.4.4.2.2.2.3.cmml">​</mo><mrow id="S4.E11.m1.4.4.2.2.2.2" xref="S4.E11.m1.4.4.2.2.2.2.cmml"><munder id="S4.E11.m1.4.4.2.2.2.2.3" xref="S4.E11.m1.4.4.2.2.2.2.3.cmml"><mo movablelimits="false" id="S4.E11.m1.4.4.2.2.2.2.3.2" xref="S4.E11.m1.4.4.2.2.2.2.3.2.cmml">∑</mo><mrow id="S4.E11.m1.4.4.2.2.2.2.3.3" xref="S4.E11.m1.4.4.2.2.2.2.3.3.cmml"><msub id="S4.E11.m1.4.4.2.2.2.2.3.3.2" xref="S4.E11.m1.4.4.2.2.2.2.3.3.2.cmml"><mi id="S4.E11.m1.4.4.2.2.2.2.3.3.2.2" xref="S4.E11.m1.4.4.2.2.2.2.3.3.2.2.cmml">𝐟</mi><mi id="S4.E11.m1.4.4.2.2.2.2.3.3.2.3" xref="S4.E11.m1.4.4.2.2.2.2.3.3.2.3.cmml">𝐜</mi></msub><mo id="S4.E11.m1.4.4.2.2.2.2.3.3.1" xref="S4.E11.m1.4.4.2.2.2.2.3.3.1.cmml">∈</mo><msub id="S4.E11.m1.4.4.2.2.2.2.3.3.3" xref="S4.E11.m1.4.4.2.2.2.2.3.3.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.E11.m1.4.4.2.2.2.2.3.3.3.2" xref="S4.E11.m1.4.4.2.2.2.2.3.3.3.2.cmml">ℱ</mi><mi id="S4.E11.m1.4.4.2.2.2.2.3.3.3.3" xref="S4.E11.m1.4.4.2.2.2.2.3.3.3.3.cmml">𝐜</mi></msub></mrow></munder><mrow id="S4.E11.m1.4.4.2.2.2.2.2" xref="S4.E11.m1.4.4.2.2.2.2.2.cmml"><mi id="S4.E11.m1.4.4.2.2.2.2.2.4" xref="S4.E11.m1.4.4.2.2.2.2.2.4.cmml">d</mi><mo lspace="0em" rspace="0em" id="S4.E11.m1.4.4.2.2.2.2.2.3" xref="S4.E11.m1.4.4.2.2.2.2.2.3.cmml">​</mo><mrow id="S4.E11.m1.4.4.2.2.2.2.2.2.2" xref="S4.E11.m1.4.4.2.2.2.2.2.2.3.cmml"><mo stretchy="false" id="S4.E11.m1.4.4.2.2.2.2.2.2.2.3" xref="S4.E11.m1.4.4.2.2.2.2.2.2.3.cmml">(</mo><msub id="S4.E11.m1.3.3.1.1.1.1.1.1.1.1" xref="S4.E11.m1.3.3.1.1.1.1.1.1.1.1.cmml"><mi id="S4.E11.m1.3.3.1.1.1.1.1.1.1.1.2" xref="S4.E11.m1.3.3.1.1.1.1.1.1.1.1.2.cmml">𝐟</mi><mi id="S4.E11.m1.3.3.1.1.1.1.1.1.1.1.3" xref="S4.E11.m1.3.3.1.1.1.1.1.1.1.1.3.cmml">c</mi></msub><mo id="S4.E11.m1.4.4.2.2.2.2.2.2.2.4" xref="S4.E11.m1.4.4.2.2.2.2.2.2.3.cmml">,</mo><msub id="S4.E11.m1.4.4.2.2.2.2.2.2.2.2" xref="S4.E11.m1.4.4.2.2.2.2.2.2.2.2.cmml"><mi id="S4.E11.m1.4.4.2.2.2.2.2.2.2.2.2" xref="S4.E11.m1.4.4.2.2.2.2.2.2.2.2.2.cmml">𝐩</mi><mi id="S4.E11.m1.4.4.2.2.2.2.2.2.2.2.3" xref="S4.E11.m1.4.4.2.2.2.2.2.2.2.2.3.cmml">c</mi></msub><mo stretchy="false" id="S4.E11.m1.4.4.2.2.2.2.2.2.2.5" xref="S4.E11.m1.4.4.2.2.2.2.2.2.3.cmml">)</mo></mrow></mrow></mrow></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.E11.m1.4b"><apply id="S4.E11.m1.4.4.cmml" xref="S4.E11.m1.4.4"><eq id="S4.E11.m1.4.4.3.cmml" xref="S4.E11.m1.4.4.3"></eq><apply id="S4.E11.m1.4.4.4.cmml" xref="S4.E11.m1.4.4.4"><csymbol cd="ambiguous" id="S4.E11.m1.4.4.4.1.cmml" xref="S4.E11.m1.4.4.4">subscript</csymbol><ci id="S4.E11.m1.4.4.4.2.cmml" xref="S4.E11.m1.4.4.4.2">ℒ</ci><apply id="S4.E11.m1.4.4.4.3.cmml" xref="S4.E11.m1.4.4.4.3"><times id="S4.E11.m1.4.4.4.3.1.cmml" xref="S4.E11.m1.4.4.4.3.1"></times><ci id="S4.E11.m1.4.4.4.3.2.cmml" xref="S4.E11.m1.4.4.4.3.2">𝑐</ci><ci id="S4.E11.m1.4.4.4.3.3.cmml" xref="S4.E11.m1.4.4.4.3.3">𝑙</ci></apply></apply><apply id="S4.E11.m1.4.4.2.cmml" xref="S4.E11.m1.4.4.2"><times id="S4.E11.m1.4.4.2.3.cmml" xref="S4.E11.m1.4.4.2.3"></times><apply id="S4.E11.m1.1.1.cmml" xref="S4.E11.m1.1.1"><divide id="S4.E11.m1.1.1.2.cmml" xref="S4.E11.m1.1.1"></divide><cn type="integer" id="S4.E11.m1.1.1.3.cmml" xref="S4.E11.m1.1.1.3">1</cn><apply id="S4.E11.m1.1.1.1.2.cmml" xref="S4.E11.m1.1.1.1.3"><abs id="S4.E11.m1.1.1.1.2.1.cmml" xref="S4.E11.m1.1.1.1.3.1"></abs><apply id="S4.E11.m1.1.1.1.1.cmml" xref="S4.E11.m1.1.1.1.1"><ci id="S4.E11.m1.1.1.1.1.1.cmml" xref="S4.E11.m1.1.1.1.1.1">^</ci><ci id="S4.E11.m1.1.1.1.1.2.cmml" xref="S4.E11.m1.1.1.1.1.2">𝒞</ci></apply></apply></apply><apply id="S4.E11.m1.4.4.2.2.cmml" xref="S4.E11.m1.4.4.2.2"><apply id="S4.E11.m1.4.4.2.2.3.cmml" xref="S4.E11.m1.4.4.2.2.3"><csymbol cd="ambiguous" id="S4.E11.m1.4.4.2.2.3.1.cmml" xref="S4.E11.m1.4.4.2.2.3">subscript</csymbol><sum id="S4.E11.m1.4.4.2.2.3.2.cmml" xref="S4.E11.m1.4.4.2.2.3.2"></sum><apply id="S4.E11.m1.4.4.2.2.3.3.cmml" xref="S4.E11.m1.4.4.2.2.3.3"><in id="S4.E11.m1.4.4.2.2.3.3.1.cmml" xref="S4.E11.m1.4.4.2.2.3.3.1"></in><ci id="S4.E11.m1.4.4.2.2.3.3.2.cmml" xref="S4.E11.m1.4.4.2.2.3.3.2">𝑐</ci><apply id="S4.E11.m1.4.4.2.2.3.3.3.cmml" xref="S4.E11.m1.4.4.2.2.3.3.3"><ci id="S4.E11.m1.4.4.2.2.3.3.3.1.cmml" xref="S4.E11.m1.4.4.2.2.3.3.3.1">^</ci><ci id="S4.E11.m1.4.4.2.2.3.3.3.2.cmml" xref="S4.E11.m1.4.4.2.2.3.3.3.2">𝒞</ci></apply></apply></apply><apply id="S4.E11.m1.4.4.2.2.2.cmml" xref="S4.E11.m1.4.4.2.2.2"><times id="S4.E11.m1.4.4.2.2.2.3.cmml" xref="S4.E11.m1.4.4.2.2.2.3"></times><apply id="S4.E11.m1.2.2.cmml" xref="S4.E11.m1.2.2"><divide id="S4.E11.m1.2.2.2.cmml" xref="S4.E11.m1.2.2"></divide><cn type="integer" id="S4.E11.m1.2.2.3.cmml" xref="S4.E11.m1.2.2.3">1</cn><apply id="S4.E11.m1.2.2.1.2.cmml" xref="S4.E11.m1.2.2.1.1"><abs id="S4.E11.m1.2.2.1.2.1.cmml" xref="S4.E11.m1.2.2.1.1.2"></abs><apply id="S4.E11.m1.2.2.1.1.1.cmml" xref="S4.E11.m1.2.2.1.1.1"><csymbol cd="ambiguous" id="S4.E11.m1.2.2.1.1.1.1.cmml" xref="S4.E11.m1.2.2.1.1.1">subscript</csymbol><ci id="S4.E11.m1.2.2.1.1.1.2.cmml" xref="S4.E11.m1.2.2.1.1.1.2">ℱ</ci><ci id="S4.E11.m1.2.2.1.1.1.3.cmml" xref="S4.E11.m1.2.2.1.1.1.3">𝑐</ci></apply></apply></apply><apply id="S4.E11.m1.4.4.2.2.2.2.cmml" xref="S4.E11.m1.4.4.2.2.2.2"><apply id="S4.E11.m1.4.4.2.2.2.2.3.cmml" xref="S4.E11.m1.4.4.2.2.2.2.3"><csymbol cd="ambiguous" id="S4.E11.m1.4.4.2.2.2.2.3.1.cmml" xref="S4.E11.m1.4.4.2.2.2.2.3">subscript</csymbol><sum id="S4.E11.m1.4.4.2.2.2.2.3.2.cmml" xref="S4.E11.m1.4.4.2.2.2.2.3.2"></sum><apply id="S4.E11.m1.4.4.2.2.2.2.3.3.cmml" xref="S4.E11.m1.4.4.2.2.2.2.3.3"><in id="S4.E11.m1.4.4.2.2.2.2.3.3.1.cmml" xref="S4.E11.m1.4.4.2.2.2.2.3.3.1"></in><apply id="S4.E11.m1.4.4.2.2.2.2.3.3.2.cmml" xref="S4.E11.m1.4.4.2.2.2.2.3.3.2"><csymbol cd="ambiguous" id="S4.E11.m1.4.4.2.2.2.2.3.3.2.1.cmml" xref="S4.E11.m1.4.4.2.2.2.2.3.3.2">subscript</csymbol><ci id="S4.E11.m1.4.4.2.2.2.2.3.3.2.2.cmml" xref="S4.E11.m1.4.4.2.2.2.2.3.3.2.2">𝐟</ci><ci id="S4.E11.m1.4.4.2.2.2.2.3.3.2.3.cmml" xref="S4.E11.m1.4.4.2.2.2.2.3.3.2.3">𝐜</ci></apply><apply id="S4.E11.m1.4.4.2.2.2.2.3.3.3.cmml" xref="S4.E11.m1.4.4.2.2.2.2.3.3.3"><csymbol cd="ambiguous" id="S4.E11.m1.4.4.2.2.2.2.3.3.3.1.cmml" xref="S4.E11.m1.4.4.2.2.2.2.3.3.3">subscript</csymbol><ci id="S4.E11.m1.4.4.2.2.2.2.3.3.3.2.cmml" xref="S4.E11.m1.4.4.2.2.2.2.3.3.3.2">ℱ</ci><ci id="S4.E11.m1.4.4.2.2.2.2.3.3.3.3.cmml" xref="S4.E11.m1.4.4.2.2.2.2.3.3.3.3">𝐜</ci></apply></apply></apply><apply id="S4.E11.m1.4.4.2.2.2.2.2.cmml" xref="S4.E11.m1.4.4.2.2.2.2.2"><times id="S4.E11.m1.4.4.2.2.2.2.2.3.cmml" xref="S4.E11.m1.4.4.2.2.2.2.2.3"></times><ci id="S4.E11.m1.4.4.2.2.2.2.2.4.cmml" xref="S4.E11.m1.4.4.2.2.2.2.2.4">𝑑</ci><interval closure="open" id="S4.E11.m1.4.4.2.2.2.2.2.2.3.cmml" xref="S4.E11.m1.4.4.2.2.2.2.2.2.2"><apply id="S4.E11.m1.3.3.1.1.1.1.1.1.1.1.cmml" xref="S4.E11.m1.3.3.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.E11.m1.3.3.1.1.1.1.1.1.1.1.1.cmml" xref="S4.E11.m1.3.3.1.1.1.1.1.1.1.1">subscript</csymbol><ci id="S4.E11.m1.3.3.1.1.1.1.1.1.1.1.2.cmml" xref="S4.E11.m1.3.3.1.1.1.1.1.1.1.1.2">𝐟</ci><ci id="S4.E11.m1.3.3.1.1.1.1.1.1.1.1.3.cmml" xref="S4.E11.m1.3.3.1.1.1.1.1.1.1.1.3">𝑐</ci></apply><apply id="S4.E11.m1.4.4.2.2.2.2.2.2.2.2.cmml" xref="S4.E11.m1.4.4.2.2.2.2.2.2.2.2"><csymbol cd="ambiguous" id="S4.E11.m1.4.4.2.2.2.2.2.2.2.2.1.cmml" xref="S4.E11.m1.4.4.2.2.2.2.2.2.2.2">subscript</csymbol><ci id="S4.E11.m1.4.4.2.2.2.2.2.2.2.2.2.cmml" xref="S4.E11.m1.4.4.2.2.2.2.2.2.2.2.2">𝐩</ci><ci id="S4.E11.m1.4.4.2.2.2.2.2.2.2.2.3.cmml" xref="S4.E11.m1.4.4.2.2.2.2.2.2.2.2.3">𝑐</ci></apply></interval></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.E11.m1.4c">\mathcal{L}_{cl}=\frac{1}{|\hat{\mathcal{C}}|}\sum_{c\in\hat{\mathcal{C}}}\frac{1}{|\mathcal{F}_{c}|}\sum_{\mathbf{f_{c}\in\mathcal{F}_{c}}}d(\mathbf{f}_{c},\mathbf{p}_{c})</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(11)</span></td>
</tr></tbody>
</table>
<p id="S4.SS3.p5.1" class="ltx_p">where <math id="S4.SS3.p5.1.m1.2" class="ltx_Math" alttext="\hat{\mathcal{C}}\;\coloneqq\;\{c\in\mathcal{C}:\;|\mathcal{F}_{c}|&gt;0\}" display="inline"><semantics id="S4.SS3.p5.1.m1.2a"><mrow id="S4.SS3.p5.1.m1.2.2" xref="S4.SS3.p5.1.m1.2.2.cmml"><mover accent="true" id="S4.SS3.p5.1.m1.2.2.4" xref="S4.SS3.p5.1.m1.2.2.4.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.SS3.p5.1.m1.2.2.4.2" xref="S4.SS3.p5.1.m1.2.2.4.2.cmml">𝒞</mi><mo id="S4.SS3.p5.1.m1.2.2.4.1" xref="S4.SS3.p5.1.m1.2.2.4.1.cmml">^</mo></mover><mo lspace="0.558em" rspace="0.558em" id="S4.SS3.p5.1.m1.2.2.3" xref="S4.SS3.p5.1.m1.2.2.3.cmml">≔</mo><mrow id="S4.SS3.p5.1.m1.2.2.2.2" xref="S4.SS3.p5.1.m1.2.2.2.3.cmml"><mo stretchy="false" id="S4.SS3.p5.1.m1.2.2.2.2.3" xref="S4.SS3.p5.1.m1.2.2.2.3.1.cmml">{</mo><mrow id="S4.SS3.p5.1.m1.1.1.1.1.1" xref="S4.SS3.p5.1.m1.1.1.1.1.1.cmml"><mi id="S4.SS3.p5.1.m1.1.1.1.1.1.2" xref="S4.SS3.p5.1.m1.1.1.1.1.1.2.cmml">c</mi><mo id="S4.SS3.p5.1.m1.1.1.1.1.1.1" xref="S4.SS3.p5.1.m1.1.1.1.1.1.1.cmml">∈</mo><mi class="ltx_font_mathcaligraphic" id="S4.SS3.p5.1.m1.1.1.1.1.1.3" xref="S4.SS3.p5.1.m1.1.1.1.1.1.3.cmml">𝒞</mi></mrow><mo lspace="0.278em" rspace="0.558em" id="S4.SS3.p5.1.m1.2.2.2.2.4" xref="S4.SS3.p5.1.m1.2.2.2.3.1.cmml">:</mo><mrow id="S4.SS3.p5.1.m1.2.2.2.2.2" xref="S4.SS3.p5.1.m1.2.2.2.2.2.cmml"><mrow id="S4.SS3.p5.1.m1.2.2.2.2.2.1.1" xref="S4.SS3.p5.1.m1.2.2.2.2.2.1.2.cmml"><mo stretchy="false" id="S4.SS3.p5.1.m1.2.2.2.2.2.1.1.2" xref="S4.SS3.p5.1.m1.2.2.2.2.2.1.2.1.cmml">|</mo><msub id="S4.SS3.p5.1.m1.2.2.2.2.2.1.1.1" xref="S4.SS3.p5.1.m1.2.2.2.2.2.1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.SS3.p5.1.m1.2.2.2.2.2.1.1.1.2" xref="S4.SS3.p5.1.m1.2.2.2.2.2.1.1.1.2.cmml">ℱ</mi><mi id="S4.SS3.p5.1.m1.2.2.2.2.2.1.1.1.3" xref="S4.SS3.p5.1.m1.2.2.2.2.2.1.1.1.3.cmml">c</mi></msub><mo stretchy="false" id="S4.SS3.p5.1.m1.2.2.2.2.2.1.1.3" xref="S4.SS3.p5.1.m1.2.2.2.2.2.1.2.1.cmml">|</mo></mrow><mo id="S4.SS3.p5.1.m1.2.2.2.2.2.2" xref="S4.SS3.p5.1.m1.2.2.2.2.2.2.cmml">&gt;</mo><mn id="S4.SS3.p5.1.m1.2.2.2.2.2.3" xref="S4.SS3.p5.1.m1.2.2.2.2.2.3.cmml">0</mn></mrow><mo stretchy="false" id="S4.SS3.p5.1.m1.2.2.2.2.5" xref="S4.SS3.p5.1.m1.2.2.2.3.1.cmml">}</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS3.p5.1.m1.2b"><apply id="S4.SS3.p5.1.m1.2.2.cmml" xref="S4.SS3.p5.1.m1.2.2"><ci id="S4.SS3.p5.1.m1.2.2.3.cmml" xref="S4.SS3.p5.1.m1.2.2.3">≔</ci><apply id="S4.SS3.p5.1.m1.2.2.4.cmml" xref="S4.SS3.p5.1.m1.2.2.4"><ci id="S4.SS3.p5.1.m1.2.2.4.1.cmml" xref="S4.SS3.p5.1.m1.2.2.4.1">^</ci><ci id="S4.SS3.p5.1.m1.2.2.4.2.cmml" xref="S4.SS3.p5.1.m1.2.2.4.2">𝒞</ci></apply><apply id="S4.SS3.p5.1.m1.2.2.2.3.cmml" xref="S4.SS3.p5.1.m1.2.2.2.2"><csymbol cd="latexml" id="S4.SS3.p5.1.m1.2.2.2.3.1.cmml" xref="S4.SS3.p5.1.m1.2.2.2.2.3">conditional-set</csymbol><apply id="S4.SS3.p5.1.m1.1.1.1.1.1.cmml" xref="S4.SS3.p5.1.m1.1.1.1.1.1"><in id="S4.SS3.p5.1.m1.1.1.1.1.1.1.cmml" xref="S4.SS3.p5.1.m1.1.1.1.1.1.1"></in><ci id="S4.SS3.p5.1.m1.1.1.1.1.1.2.cmml" xref="S4.SS3.p5.1.m1.1.1.1.1.1.2">𝑐</ci><ci id="S4.SS3.p5.1.m1.1.1.1.1.1.3.cmml" xref="S4.SS3.p5.1.m1.1.1.1.1.1.3">𝒞</ci></apply><apply id="S4.SS3.p5.1.m1.2.2.2.2.2.cmml" xref="S4.SS3.p5.1.m1.2.2.2.2.2"><gt id="S4.SS3.p5.1.m1.2.2.2.2.2.2.cmml" xref="S4.SS3.p5.1.m1.2.2.2.2.2.2"></gt><apply id="S4.SS3.p5.1.m1.2.2.2.2.2.1.2.cmml" xref="S4.SS3.p5.1.m1.2.2.2.2.2.1.1"><abs id="S4.SS3.p5.1.m1.2.2.2.2.2.1.2.1.cmml" xref="S4.SS3.p5.1.m1.2.2.2.2.2.1.1.2"></abs><apply id="S4.SS3.p5.1.m1.2.2.2.2.2.1.1.1.cmml" xref="S4.SS3.p5.1.m1.2.2.2.2.2.1.1.1"><csymbol cd="ambiguous" id="S4.SS3.p5.1.m1.2.2.2.2.2.1.1.1.1.cmml" xref="S4.SS3.p5.1.m1.2.2.2.2.2.1.1.1">subscript</csymbol><ci id="S4.SS3.p5.1.m1.2.2.2.2.2.1.1.1.2.cmml" xref="S4.SS3.p5.1.m1.2.2.2.2.2.1.1.1.2">ℱ</ci><ci id="S4.SS3.p5.1.m1.2.2.2.2.2.1.1.1.3.cmml" xref="S4.SS3.p5.1.m1.2.2.2.2.2.1.1.1.3">𝑐</ci></apply></apply><cn type="integer" id="S4.SS3.p5.1.m1.2.2.2.2.2.3.cmml" xref="S4.SS3.p5.1.m1.2.2.2.2.2.3">0</cn></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p5.1.m1.2c">\hat{\mathcal{C}}\;\coloneqq\;\{c\in\mathcal{C}:\;|\mathcal{F}_{c}|&gt;0\}</annotation></semantics></math> is the set of active classes in the current batch.</p>
</div>
</section>
<section id="S4.SS4" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.4 </span>Server Aggregation (AG)</h3>

<div id="S4.SS4.p1" class="ltx_para">
<p id="S4.SS4.p1.1" class="ltx_p"><span id="S4.SS4.p1.1.1" class="ltx_text ltx_font_bold">Regularization.</span> As mentioned earlier, the wide range of data variability across client devices, caused by various types of autonomous agents and changing weather conditions, makes aggregation at the server side challenging. Moreover, unrestricted self-training on the client side can lead to instability (see training curve when only <math id="S4.SS4.p1.1.m1.1" class="ltx_Math" alttext="\mathcal{L}_{st}" display="inline"><semantics id="S4.SS4.p1.1.m1.1a"><msub id="S4.SS4.p1.1.m1.1.1" xref="S4.SS4.p1.1.m1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.SS4.p1.1.m1.1.1.2" xref="S4.SS4.p1.1.m1.1.1.2.cmml">ℒ</mi><mrow id="S4.SS4.p1.1.m1.1.1.3" xref="S4.SS4.p1.1.m1.1.1.3.cmml"><mi id="S4.SS4.p1.1.m1.1.1.3.2" xref="S4.SS4.p1.1.m1.1.1.3.2.cmml">s</mi><mo lspace="0em" rspace="0em" id="S4.SS4.p1.1.m1.1.1.3.1" xref="S4.SS4.p1.1.m1.1.1.3.1.cmml">​</mo><mi id="S4.SS4.p1.1.m1.1.1.3.3" xref="S4.SS4.p1.1.m1.1.1.3.3.cmml">t</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S4.SS4.p1.1.m1.1b"><apply id="S4.SS4.p1.1.m1.1.1.cmml" xref="S4.SS4.p1.1.m1.1.1"><csymbol cd="ambiguous" id="S4.SS4.p1.1.m1.1.1.1.cmml" xref="S4.SS4.p1.1.m1.1.1">subscript</csymbol><ci id="S4.SS4.p1.1.m1.1.1.2.cmml" xref="S4.SS4.p1.1.m1.1.1.2">ℒ</ci><apply id="S4.SS4.p1.1.m1.1.1.3.cmml" xref="S4.SS4.p1.1.m1.1.1.3"><times id="S4.SS4.p1.1.m1.1.1.3.1.cmml" xref="S4.SS4.p1.1.m1.1.1.3.1"></times><ci id="S4.SS4.p1.1.m1.1.1.3.2.cmml" xref="S4.SS4.p1.1.m1.1.1.3.2">𝑠</ci><ci id="S4.SS4.p1.1.m1.1.1.3.3.cmml" xref="S4.SS4.p1.1.m1.1.1.3.3">𝑡</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS4.p1.1.m1.1c">\mathcal{L}_{st}</annotation></semantics></math> is active in
<a href="#S7.F5" title="In 7 Experimental Results ‣ When Cars meet Drones: Hyperbolic Federated Learning for Source-Free Domain Adaptation in Adverse Weather" class="ltx_ref"><span class="ltx_text ltx_ref_tag">Fig.</span> <span class="ltx_text ltx_ref_tag">5</span></a>)
and to a decrease in performance after several rounds.
To stabilize the results with respect to standard averaging <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib27" title="" class="ltx_ref">27</a>]</cite>, we used a combination of the models received from the clients with the global ones available at server side from previous steps. In this way, during the first rounds, there is a smoother adaptation from the pretrained model.
More in detail, the aggregated model on the server side is computed as:</p>
</div>
<div id="S4.SS4.p2" class="ltx_para">
<table id="S4.E12" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S4.E12.m1.1" class="ltx_Math" alttext="M_{G}^{r}=\frac{\frac{\sum_{k\in\mathcal{K}^{R}}M^{r}_{k}}{|\mathcal{K}^{R}|}+\sum_{j=1}^{Q}M_{G}^{r-j}}{Q+1}" display="block"><semantics id="S4.E12.m1.1a"><mrow id="S4.E12.m1.1.2" xref="S4.E12.m1.1.2.cmml"><msubsup id="S4.E12.m1.1.2.2" xref="S4.E12.m1.1.2.2.cmml"><mi id="S4.E12.m1.1.2.2.2.2" xref="S4.E12.m1.1.2.2.2.2.cmml">M</mi><mi id="S4.E12.m1.1.2.2.2.3" xref="S4.E12.m1.1.2.2.2.3.cmml">G</mi><mi id="S4.E12.m1.1.2.2.3" xref="S4.E12.m1.1.2.2.3.cmml">r</mi></msubsup><mo id="S4.E12.m1.1.2.1" xref="S4.E12.m1.1.2.1.cmml">=</mo><mfrac id="S4.E12.m1.1.1" xref="S4.E12.m1.1.1.cmml"><mrow id="S4.E12.m1.1.1.1" xref="S4.E12.m1.1.1.1.cmml"><mfrac id="S4.E12.m1.1.1.1.1" xref="S4.E12.m1.1.1.1.1.cmml"><mrow id="S4.E12.m1.1.1.1.1.3" xref="S4.E12.m1.1.1.1.1.3.cmml"><mstyle displaystyle="false" id="S4.E12.m1.1.1.1.1.3.1" xref="S4.E12.m1.1.1.1.1.3.1.cmml"><msub id="S4.E12.m1.1.1.1.1.3.1a" xref="S4.E12.m1.1.1.1.1.3.1.cmml"><mo id="S4.E12.m1.1.1.1.1.3.1.2" xref="S4.E12.m1.1.1.1.1.3.1.2.cmml">∑</mo><mrow id="S4.E12.m1.1.1.1.1.3.1.3" xref="S4.E12.m1.1.1.1.1.3.1.3.cmml"><mi id="S4.E12.m1.1.1.1.1.3.1.3.2" xref="S4.E12.m1.1.1.1.1.3.1.3.2.cmml">k</mi><mo id="S4.E12.m1.1.1.1.1.3.1.3.1" xref="S4.E12.m1.1.1.1.1.3.1.3.1.cmml">∈</mo><msup id="S4.E12.m1.1.1.1.1.3.1.3.3" xref="S4.E12.m1.1.1.1.1.3.1.3.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.E12.m1.1.1.1.1.3.1.3.3.2" xref="S4.E12.m1.1.1.1.1.3.1.3.3.2.cmml">𝒦</mi><mi id="S4.E12.m1.1.1.1.1.3.1.3.3.3" xref="S4.E12.m1.1.1.1.1.3.1.3.3.3.cmml">R</mi></msup></mrow></msub></mstyle><msubsup id="S4.E12.m1.1.1.1.1.3.2" xref="S4.E12.m1.1.1.1.1.3.2.cmml"><mi id="S4.E12.m1.1.1.1.1.3.2.2.2" xref="S4.E12.m1.1.1.1.1.3.2.2.2.cmml">M</mi><mi id="S4.E12.m1.1.1.1.1.3.2.3" xref="S4.E12.m1.1.1.1.1.3.2.3.cmml">k</mi><mi id="S4.E12.m1.1.1.1.1.3.2.2.3" xref="S4.E12.m1.1.1.1.1.3.2.2.3.cmml">r</mi></msubsup></mrow><mrow id="S4.E12.m1.1.1.1.1.1.1" xref="S4.E12.m1.1.1.1.1.1.2.cmml"><mo stretchy="false" id="S4.E12.m1.1.1.1.1.1.1.2" xref="S4.E12.m1.1.1.1.1.1.2.1.cmml">|</mo><msup id="S4.E12.m1.1.1.1.1.1.1.1" xref="S4.E12.m1.1.1.1.1.1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.E12.m1.1.1.1.1.1.1.1.2" xref="S4.E12.m1.1.1.1.1.1.1.1.2.cmml">𝒦</mi><mi id="S4.E12.m1.1.1.1.1.1.1.1.3" xref="S4.E12.m1.1.1.1.1.1.1.1.3.cmml">R</mi></msup><mo stretchy="false" id="S4.E12.m1.1.1.1.1.1.1.3" xref="S4.E12.m1.1.1.1.1.1.2.1.cmml">|</mo></mrow></mfrac><mo rspace="0.055em" id="S4.E12.m1.1.1.1.2" xref="S4.E12.m1.1.1.1.2.cmml">+</mo><mrow id="S4.E12.m1.1.1.1.3" xref="S4.E12.m1.1.1.1.3.cmml"><msubsup id="S4.E12.m1.1.1.1.3.1" xref="S4.E12.m1.1.1.1.3.1.cmml"><mo id="S4.E12.m1.1.1.1.3.1.2.2" xref="S4.E12.m1.1.1.1.3.1.2.2.cmml">∑</mo><mrow id="S4.E12.m1.1.1.1.3.1.2.3" xref="S4.E12.m1.1.1.1.3.1.2.3.cmml"><mi id="S4.E12.m1.1.1.1.3.1.2.3.2" xref="S4.E12.m1.1.1.1.3.1.2.3.2.cmml">j</mi><mo id="S4.E12.m1.1.1.1.3.1.2.3.1" xref="S4.E12.m1.1.1.1.3.1.2.3.1.cmml">=</mo><mn id="S4.E12.m1.1.1.1.3.1.2.3.3" xref="S4.E12.m1.1.1.1.3.1.2.3.3.cmml">1</mn></mrow><mi id="S4.E12.m1.1.1.1.3.1.3" xref="S4.E12.m1.1.1.1.3.1.3.cmml">Q</mi></msubsup><msubsup id="S4.E12.m1.1.1.1.3.2" xref="S4.E12.m1.1.1.1.3.2.cmml"><mi id="S4.E12.m1.1.1.1.3.2.2.2" xref="S4.E12.m1.1.1.1.3.2.2.2.cmml">M</mi><mi id="S4.E12.m1.1.1.1.3.2.2.3" xref="S4.E12.m1.1.1.1.3.2.2.3.cmml">G</mi><mrow id="S4.E12.m1.1.1.1.3.2.3" xref="S4.E12.m1.1.1.1.3.2.3.cmml"><mi id="S4.E12.m1.1.1.1.3.2.3.2" xref="S4.E12.m1.1.1.1.3.2.3.2.cmml">r</mi><mo id="S4.E12.m1.1.1.1.3.2.3.1" xref="S4.E12.m1.1.1.1.3.2.3.1.cmml">−</mo><mi id="S4.E12.m1.1.1.1.3.2.3.3" xref="S4.E12.m1.1.1.1.3.2.3.3.cmml">j</mi></mrow></msubsup></mrow></mrow><mrow id="S4.E12.m1.1.1.3" xref="S4.E12.m1.1.1.3.cmml"><mi id="S4.E12.m1.1.1.3.2" xref="S4.E12.m1.1.1.3.2.cmml">Q</mi><mo id="S4.E12.m1.1.1.3.1" xref="S4.E12.m1.1.1.3.1.cmml">+</mo><mn id="S4.E12.m1.1.1.3.3" xref="S4.E12.m1.1.1.3.3.cmml">1</mn></mrow></mfrac></mrow><annotation-xml encoding="MathML-Content" id="S4.E12.m1.1b"><apply id="S4.E12.m1.1.2.cmml" xref="S4.E12.m1.1.2"><eq id="S4.E12.m1.1.2.1.cmml" xref="S4.E12.m1.1.2.1"></eq><apply id="S4.E12.m1.1.2.2.cmml" xref="S4.E12.m1.1.2.2"><csymbol cd="ambiguous" id="S4.E12.m1.1.2.2.1.cmml" xref="S4.E12.m1.1.2.2">superscript</csymbol><apply id="S4.E12.m1.1.2.2.2.cmml" xref="S4.E12.m1.1.2.2"><csymbol cd="ambiguous" id="S4.E12.m1.1.2.2.2.1.cmml" xref="S4.E12.m1.1.2.2">subscript</csymbol><ci id="S4.E12.m1.1.2.2.2.2.cmml" xref="S4.E12.m1.1.2.2.2.2">𝑀</ci><ci id="S4.E12.m1.1.2.2.2.3.cmml" xref="S4.E12.m1.1.2.2.2.3">𝐺</ci></apply><ci id="S4.E12.m1.1.2.2.3.cmml" xref="S4.E12.m1.1.2.2.3">𝑟</ci></apply><apply id="S4.E12.m1.1.1.cmml" xref="S4.E12.m1.1.1"><divide id="S4.E12.m1.1.1.2.cmml" xref="S4.E12.m1.1.1"></divide><apply id="S4.E12.m1.1.1.1.cmml" xref="S4.E12.m1.1.1.1"><plus id="S4.E12.m1.1.1.1.2.cmml" xref="S4.E12.m1.1.1.1.2"></plus><apply id="S4.E12.m1.1.1.1.1.cmml" xref="S4.E12.m1.1.1.1.1"><divide id="S4.E12.m1.1.1.1.1.2.cmml" xref="S4.E12.m1.1.1.1.1"></divide><apply id="S4.E12.m1.1.1.1.1.3.cmml" xref="S4.E12.m1.1.1.1.1.3"><apply id="S4.E12.m1.1.1.1.1.3.1.cmml" xref="S4.E12.m1.1.1.1.1.3.1"><csymbol cd="ambiguous" id="S4.E12.m1.1.1.1.1.3.1.1.cmml" xref="S4.E12.m1.1.1.1.1.3.1">subscript</csymbol><sum id="S4.E12.m1.1.1.1.1.3.1.2.cmml" xref="S4.E12.m1.1.1.1.1.3.1.2"></sum><apply id="S4.E12.m1.1.1.1.1.3.1.3.cmml" xref="S4.E12.m1.1.1.1.1.3.1.3"><in id="S4.E12.m1.1.1.1.1.3.1.3.1.cmml" xref="S4.E12.m1.1.1.1.1.3.1.3.1"></in><ci id="S4.E12.m1.1.1.1.1.3.1.3.2.cmml" xref="S4.E12.m1.1.1.1.1.3.1.3.2">𝑘</ci><apply id="S4.E12.m1.1.1.1.1.3.1.3.3.cmml" xref="S4.E12.m1.1.1.1.1.3.1.3.3"><csymbol cd="ambiguous" id="S4.E12.m1.1.1.1.1.3.1.3.3.1.cmml" xref="S4.E12.m1.1.1.1.1.3.1.3.3">superscript</csymbol><ci id="S4.E12.m1.1.1.1.1.3.1.3.3.2.cmml" xref="S4.E12.m1.1.1.1.1.3.1.3.3.2">𝒦</ci><ci id="S4.E12.m1.1.1.1.1.3.1.3.3.3.cmml" xref="S4.E12.m1.1.1.1.1.3.1.3.3.3">𝑅</ci></apply></apply></apply><apply id="S4.E12.m1.1.1.1.1.3.2.cmml" xref="S4.E12.m1.1.1.1.1.3.2"><csymbol cd="ambiguous" id="S4.E12.m1.1.1.1.1.3.2.1.cmml" xref="S4.E12.m1.1.1.1.1.3.2">subscript</csymbol><apply id="S4.E12.m1.1.1.1.1.3.2.2.cmml" xref="S4.E12.m1.1.1.1.1.3.2"><csymbol cd="ambiguous" id="S4.E12.m1.1.1.1.1.3.2.2.1.cmml" xref="S4.E12.m1.1.1.1.1.3.2">superscript</csymbol><ci id="S4.E12.m1.1.1.1.1.3.2.2.2.cmml" xref="S4.E12.m1.1.1.1.1.3.2.2.2">𝑀</ci><ci id="S4.E12.m1.1.1.1.1.3.2.2.3.cmml" xref="S4.E12.m1.1.1.1.1.3.2.2.3">𝑟</ci></apply><ci id="S4.E12.m1.1.1.1.1.3.2.3.cmml" xref="S4.E12.m1.1.1.1.1.3.2.3">𝑘</ci></apply></apply><apply id="S4.E12.m1.1.1.1.1.1.2.cmml" xref="S4.E12.m1.1.1.1.1.1.1"><abs id="S4.E12.m1.1.1.1.1.1.2.1.cmml" xref="S4.E12.m1.1.1.1.1.1.1.2"></abs><apply id="S4.E12.m1.1.1.1.1.1.1.1.cmml" xref="S4.E12.m1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.E12.m1.1.1.1.1.1.1.1.1.cmml" xref="S4.E12.m1.1.1.1.1.1.1.1">superscript</csymbol><ci id="S4.E12.m1.1.1.1.1.1.1.1.2.cmml" xref="S4.E12.m1.1.1.1.1.1.1.1.2">𝒦</ci><ci id="S4.E12.m1.1.1.1.1.1.1.1.3.cmml" xref="S4.E12.m1.1.1.1.1.1.1.1.3">𝑅</ci></apply></apply></apply><apply id="S4.E12.m1.1.1.1.3.cmml" xref="S4.E12.m1.1.1.1.3"><apply id="S4.E12.m1.1.1.1.3.1.cmml" xref="S4.E12.m1.1.1.1.3.1"><csymbol cd="ambiguous" id="S4.E12.m1.1.1.1.3.1.1.cmml" xref="S4.E12.m1.1.1.1.3.1">superscript</csymbol><apply id="S4.E12.m1.1.1.1.3.1.2.cmml" xref="S4.E12.m1.1.1.1.3.1"><csymbol cd="ambiguous" id="S4.E12.m1.1.1.1.3.1.2.1.cmml" xref="S4.E12.m1.1.1.1.3.1">subscript</csymbol><sum id="S4.E12.m1.1.1.1.3.1.2.2.cmml" xref="S4.E12.m1.1.1.1.3.1.2.2"></sum><apply id="S4.E12.m1.1.1.1.3.1.2.3.cmml" xref="S4.E12.m1.1.1.1.3.1.2.3"><eq id="S4.E12.m1.1.1.1.3.1.2.3.1.cmml" xref="S4.E12.m1.1.1.1.3.1.2.3.1"></eq><ci id="S4.E12.m1.1.1.1.3.1.2.3.2.cmml" xref="S4.E12.m1.1.1.1.3.1.2.3.2">𝑗</ci><cn type="integer" id="S4.E12.m1.1.1.1.3.1.2.3.3.cmml" xref="S4.E12.m1.1.1.1.3.1.2.3.3">1</cn></apply></apply><ci id="S4.E12.m1.1.1.1.3.1.3.cmml" xref="S4.E12.m1.1.1.1.3.1.3">𝑄</ci></apply><apply id="S4.E12.m1.1.1.1.3.2.cmml" xref="S4.E12.m1.1.1.1.3.2"><csymbol cd="ambiguous" id="S4.E12.m1.1.1.1.3.2.1.cmml" xref="S4.E12.m1.1.1.1.3.2">superscript</csymbol><apply id="S4.E12.m1.1.1.1.3.2.2.cmml" xref="S4.E12.m1.1.1.1.3.2"><csymbol cd="ambiguous" id="S4.E12.m1.1.1.1.3.2.2.1.cmml" xref="S4.E12.m1.1.1.1.3.2">subscript</csymbol><ci id="S4.E12.m1.1.1.1.3.2.2.2.cmml" xref="S4.E12.m1.1.1.1.3.2.2.2">𝑀</ci><ci id="S4.E12.m1.1.1.1.3.2.2.3.cmml" xref="S4.E12.m1.1.1.1.3.2.2.3">𝐺</ci></apply><apply id="S4.E12.m1.1.1.1.3.2.3.cmml" xref="S4.E12.m1.1.1.1.3.2.3"><minus id="S4.E12.m1.1.1.1.3.2.3.1.cmml" xref="S4.E12.m1.1.1.1.3.2.3.1"></minus><ci id="S4.E12.m1.1.1.1.3.2.3.2.cmml" xref="S4.E12.m1.1.1.1.3.2.3.2">𝑟</ci><ci id="S4.E12.m1.1.1.1.3.2.3.3.cmml" xref="S4.E12.m1.1.1.1.3.2.3.3">𝑗</ci></apply></apply></apply></apply><apply id="S4.E12.m1.1.1.3.cmml" xref="S4.E12.m1.1.1.3"><plus id="S4.E12.m1.1.1.3.1.cmml" xref="S4.E12.m1.1.1.3.1"></plus><ci id="S4.E12.m1.1.1.3.2.cmml" xref="S4.E12.m1.1.1.3.2">𝑄</ci><cn type="integer" id="S4.E12.m1.1.1.3.3.cmml" xref="S4.E12.m1.1.1.3.3">1</cn></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.E12.m1.1c">M_{G}^{r}=\frac{\frac{\sum_{k\in\mathcal{K}^{R}}M^{r}_{k}}{|\mathcal{K}^{R}|}+\sum_{j=1}^{Q}M_{G}^{r-j}}{Q+1}</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(12)</span></td>
</tr></tbody>
</table>
<p id="S4.SS4.p2.4" class="ltx_p">i.e., we get the output of federated averaging and smooth it by averaging with the <math id="S4.SS4.p2.1.m1.1" class="ltx_Math" alttext="Q" display="inline"><semantics id="S4.SS4.p2.1.m1.1a"><mi id="S4.SS4.p2.1.m1.1.1" xref="S4.SS4.p2.1.m1.1.1.cmml">Q</mi><annotation-xml encoding="MathML-Content" id="S4.SS4.p2.1.m1.1b"><ci id="S4.SS4.p2.1.m1.1.1.cmml" xref="S4.SS4.p2.1.m1.1.1">𝑄</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS4.p2.1.m1.1c">Q</annotation></semantics></math> previous rounds, thus making the learning more stable <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib4" title="" class="ltx_ref">4</a>, <a href="#bib.bib39" title="" class="ltx_ref">39</a>]</cite>.
Other approaches <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib37" title="" class="ltx_ref">37</a>]</cite> tackle regularization by exploiting the global model from several snapshots ago, <em id="S4.SS4.p2.4.1" class="ltx_emph ltx_font_italic">i.e</em>.<span id="S4.SS4.p2.4.2" class="ltx_text"></span> <math id="S4.SS4.p2.2.m2.1" class="ltx_Math" alttext="M_{G}^{0}" display="inline"><semantics id="S4.SS4.p2.2.m2.1a"><msubsup id="S4.SS4.p2.2.m2.1.1" xref="S4.SS4.p2.2.m2.1.1.cmml"><mi id="S4.SS4.p2.2.m2.1.1.2.2" xref="S4.SS4.p2.2.m2.1.1.2.2.cmml">M</mi><mi id="S4.SS4.p2.2.m2.1.1.2.3" xref="S4.SS4.p2.2.m2.1.1.2.3.cmml">G</mi><mn id="S4.SS4.p2.2.m2.1.1.3" xref="S4.SS4.p2.2.m2.1.1.3.cmml">0</mn></msubsup><annotation-xml encoding="MathML-Content" id="S4.SS4.p2.2.m2.1b"><apply id="S4.SS4.p2.2.m2.1.1.cmml" xref="S4.SS4.p2.2.m2.1.1"><csymbol cd="ambiguous" id="S4.SS4.p2.2.m2.1.1.1.cmml" xref="S4.SS4.p2.2.m2.1.1">superscript</csymbol><apply id="S4.SS4.p2.2.m2.1.1.2.cmml" xref="S4.SS4.p2.2.m2.1.1"><csymbol cd="ambiguous" id="S4.SS4.p2.2.m2.1.1.2.1.cmml" xref="S4.SS4.p2.2.m2.1.1">subscript</csymbol><ci id="S4.SS4.p2.2.m2.1.1.2.2.cmml" xref="S4.SS4.p2.2.m2.1.1.2.2">𝑀</ci><ci id="S4.SS4.p2.2.m2.1.1.2.3.cmml" xref="S4.SS4.p2.2.m2.1.1.2.3">𝐺</ci></apply><cn type="integer" id="S4.SS4.p2.2.m2.1.1.3.cmml" xref="S4.SS4.p2.2.m2.1.1.3">0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS4.p2.2.m2.1c">M_{G}^{0}</annotation></semantics></math>. The idea behind this is to distill knowledge from past predictions, where the server has higher confidence. However, this introduces additional transmission requirements at each round or necessitates clients to allocate resources for storing <math id="S4.SS4.p2.3.m3.1" class="ltx_Math" alttext="M_{G}^{0}" display="inline"><semantics id="S4.SS4.p2.3.m3.1a"><msubsup id="S4.SS4.p2.3.m3.1.1" xref="S4.SS4.p2.3.m3.1.1.cmml"><mi id="S4.SS4.p2.3.m3.1.1.2.2" xref="S4.SS4.p2.3.m3.1.1.2.2.cmml">M</mi><mi id="S4.SS4.p2.3.m3.1.1.2.3" xref="S4.SS4.p2.3.m3.1.1.2.3.cmml">G</mi><mn id="S4.SS4.p2.3.m3.1.1.3" xref="S4.SS4.p2.3.m3.1.1.3.cmml">0</mn></msubsup><annotation-xml encoding="MathML-Content" id="S4.SS4.p2.3.m3.1b"><apply id="S4.SS4.p2.3.m3.1.1.cmml" xref="S4.SS4.p2.3.m3.1.1"><csymbol cd="ambiguous" id="S4.SS4.p2.3.m3.1.1.1.cmml" xref="S4.SS4.p2.3.m3.1.1">superscript</csymbol><apply id="S4.SS4.p2.3.m3.1.1.2.cmml" xref="S4.SS4.p2.3.m3.1.1"><csymbol cd="ambiguous" id="S4.SS4.p2.3.m3.1.1.2.1.cmml" xref="S4.SS4.p2.3.m3.1.1">subscript</csymbol><ci id="S4.SS4.p2.3.m3.1.1.2.2.cmml" xref="S4.SS4.p2.3.m3.1.1.2.2">𝑀</ci><ci id="S4.SS4.p2.3.m3.1.1.2.3.cmml" xref="S4.SS4.p2.3.m3.1.1.2.3">𝐺</ci></apply><cn type="integer" id="S4.SS4.p2.3.m3.1.1.3.cmml" xref="S4.SS4.p2.3.m3.1.1.3">0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS4.p2.3.m3.1c">M_{G}^{0}</annotation></semantics></math>. Moreover, clients must perform additional inference and computation for each image. We address these challenges by implementing a strategy that only requires effort from the server side, <em id="S4.SS4.p2.4.3" class="ltx_emph ltx_font_italic">i.e</em>.<span id="S4.SS4.p2.4.4" class="ltx_text"></span>, by maintaining a queue of previous model snapshots (<math id="S4.SS4.p2.4.m4.1" class="ltx_Math" alttext="Q" display="inline"><semantics id="S4.SS4.p2.4.m4.1a"><mi id="S4.SS4.p2.4.m4.1.1" xref="S4.SS4.p2.4.m4.1.1.cmml">Q</mi><annotation-xml encoding="MathML-Content" id="S4.SS4.p2.4.m4.1b"><ci id="S4.SS4.p2.4.m4.1.1.cmml" xref="S4.SS4.p2.4.m4.1.1">𝑄</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS4.p2.4.m4.1c">Q</annotation></semantics></math>). We ensure that the burden falls on the server, where memory and computational capabilities are less constrained. We will denote this aggregation strategy as AG in the results to distinguish it from standard FedAvg. 
<br class="ltx_break"><span id="S4.SS4.p2.4.5" class="ltx_text ltx_font_bold">Prototype aggregation.</span> Prototypes are also aggregated on the server side. To this aim, we used a combination of the previously computed prototypes and the ones received by the clients.
To determine the updates, we calculated a weighted average of the prototypes received by the clients and smoothed the result by considering the prototypes from the previous round:</p>
</div>
<div id="S4.SS4.p3" class="ltx_para">
<table id="S4.E13" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S4.E13.m1.9" class="ltx_Math" alttext="\mathbf{p}_{G,c}^{r+1}=\beta^{\prime}\mathbf{p}_{G,c}^{r-1}+(1-\beta^{\prime})\sum_{k\in\mathcal{K}^{r}}N_{k,c}^{r}\mathbf{p}_{k,c}^{r}" display="block"><semantics id="S4.E13.m1.9a"><mrow id="S4.E13.m1.9.9" xref="S4.E13.m1.9.9.cmml"><msubsup id="S4.E13.m1.9.9.3" xref="S4.E13.m1.9.9.3.cmml"><mi id="S4.E13.m1.9.9.3.2.2" xref="S4.E13.m1.9.9.3.2.2.cmml">𝐩</mi><mrow id="S4.E13.m1.2.2.2.4" xref="S4.E13.m1.2.2.2.3.cmml"><mi id="S4.E13.m1.1.1.1.1" xref="S4.E13.m1.1.1.1.1.cmml">G</mi><mo id="S4.E13.m1.2.2.2.4.1" xref="S4.E13.m1.2.2.2.3.cmml">,</mo><mi id="S4.E13.m1.2.2.2.2" xref="S4.E13.m1.2.2.2.2.cmml">c</mi></mrow><mrow id="S4.E13.m1.9.9.3.3" xref="S4.E13.m1.9.9.3.3.cmml"><mi id="S4.E13.m1.9.9.3.3.2" xref="S4.E13.m1.9.9.3.3.2.cmml">r</mi><mo id="S4.E13.m1.9.9.3.3.1" xref="S4.E13.m1.9.9.3.3.1.cmml">+</mo><mn id="S4.E13.m1.9.9.3.3.3" xref="S4.E13.m1.9.9.3.3.3.cmml">1</mn></mrow></msubsup><mo id="S4.E13.m1.9.9.2" xref="S4.E13.m1.9.9.2.cmml">=</mo><mrow id="S4.E13.m1.9.9.1" xref="S4.E13.m1.9.9.1.cmml"><mrow id="S4.E13.m1.9.9.1.3" xref="S4.E13.m1.9.9.1.3.cmml"><msup id="S4.E13.m1.9.9.1.3.2" xref="S4.E13.m1.9.9.1.3.2.cmml"><mi id="S4.E13.m1.9.9.1.3.2.2" xref="S4.E13.m1.9.9.1.3.2.2.cmml">β</mi><mo id="S4.E13.m1.9.9.1.3.2.3" xref="S4.E13.m1.9.9.1.3.2.3.cmml">′</mo></msup><mo lspace="0em" rspace="0em" id="S4.E13.m1.9.9.1.3.1" xref="S4.E13.m1.9.9.1.3.1.cmml">​</mo><msubsup id="S4.E13.m1.9.9.1.3.3" xref="S4.E13.m1.9.9.1.3.3.cmml"><mi id="S4.E13.m1.9.9.1.3.3.2.2" xref="S4.E13.m1.9.9.1.3.3.2.2.cmml">𝐩</mi><mrow id="S4.E13.m1.4.4.2.4" xref="S4.E13.m1.4.4.2.3.cmml"><mi id="S4.E13.m1.3.3.1.1" xref="S4.E13.m1.3.3.1.1.cmml">G</mi><mo id="S4.E13.m1.4.4.2.4.1" xref="S4.E13.m1.4.4.2.3.cmml">,</mo><mi id="S4.E13.m1.4.4.2.2" xref="S4.E13.m1.4.4.2.2.cmml">c</mi></mrow><mrow id="S4.E13.m1.9.9.1.3.3.3" xref="S4.E13.m1.9.9.1.3.3.3.cmml"><mi id="S4.E13.m1.9.9.1.3.3.3.2" xref="S4.E13.m1.9.9.1.3.3.3.2.cmml">r</mi><mo id="S4.E13.m1.9.9.1.3.3.3.1" xref="S4.E13.m1.9.9.1.3.3.3.1.cmml">−</mo><mn id="S4.E13.m1.9.9.1.3.3.3.3" xref="S4.E13.m1.9.9.1.3.3.3.3.cmml">1</mn></mrow></msubsup></mrow><mo id="S4.E13.m1.9.9.1.2" xref="S4.E13.m1.9.9.1.2.cmml">+</mo><mrow id="S4.E13.m1.9.9.1.1" xref="S4.E13.m1.9.9.1.1.cmml"><mrow id="S4.E13.m1.9.9.1.1.1.1" xref="S4.E13.m1.9.9.1.1.1.1.1.cmml"><mo stretchy="false" id="S4.E13.m1.9.9.1.1.1.1.2" xref="S4.E13.m1.9.9.1.1.1.1.1.cmml">(</mo><mrow id="S4.E13.m1.9.9.1.1.1.1.1" xref="S4.E13.m1.9.9.1.1.1.1.1.cmml"><mn id="S4.E13.m1.9.9.1.1.1.1.1.2" xref="S4.E13.m1.9.9.1.1.1.1.1.2.cmml">1</mn><mo id="S4.E13.m1.9.9.1.1.1.1.1.1" xref="S4.E13.m1.9.9.1.1.1.1.1.1.cmml">−</mo><msup id="S4.E13.m1.9.9.1.1.1.1.1.3" xref="S4.E13.m1.9.9.1.1.1.1.1.3.cmml"><mi id="S4.E13.m1.9.9.1.1.1.1.1.3.2" xref="S4.E13.m1.9.9.1.1.1.1.1.3.2.cmml">β</mi><mo id="S4.E13.m1.9.9.1.1.1.1.1.3.3" xref="S4.E13.m1.9.9.1.1.1.1.1.3.3.cmml">′</mo></msup></mrow><mo stretchy="false" id="S4.E13.m1.9.9.1.1.1.1.3" xref="S4.E13.m1.9.9.1.1.1.1.1.cmml">)</mo></mrow><mo lspace="0em" rspace="0em" id="S4.E13.m1.9.9.1.1.2" xref="S4.E13.m1.9.9.1.1.2.cmml">​</mo><mrow id="S4.E13.m1.9.9.1.1.3" xref="S4.E13.m1.9.9.1.1.3.cmml"><munder id="S4.E13.m1.9.9.1.1.3.1" xref="S4.E13.m1.9.9.1.1.3.1.cmml"><mo movablelimits="false" id="S4.E13.m1.9.9.1.1.3.1.2" xref="S4.E13.m1.9.9.1.1.3.1.2.cmml">∑</mo><mrow id="S4.E13.m1.9.9.1.1.3.1.3" xref="S4.E13.m1.9.9.1.1.3.1.3.cmml"><mi id="S4.E13.m1.9.9.1.1.3.1.3.2" xref="S4.E13.m1.9.9.1.1.3.1.3.2.cmml">k</mi><mo id="S4.E13.m1.9.9.1.1.3.1.3.1" xref="S4.E13.m1.9.9.1.1.3.1.3.1.cmml">∈</mo><msup id="S4.E13.m1.9.9.1.1.3.1.3.3" xref="S4.E13.m1.9.9.1.1.3.1.3.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.E13.m1.9.9.1.1.3.1.3.3.2" xref="S4.E13.m1.9.9.1.1.3.1.3.3.2.cmml">𝒦</mi><mi id="S4.E13.m1.9.9.1.1.3.1.3.3.3" xref="S4.E13.m1.9.9.1.1.3.1.3.3.3.cmml">r</mi></msup></mrow></munder><mrow id="S4.E13.m1.9.9.1.1.3.2" xref="S4.E13.m1.9.9.1.1.3.2.cmml"><msubsup id="S4.E13.m1.9.9.1.1.3.2.2" xref="S4.E13.m1.9.9.1.1.3.2.2.cmml"><mi id="S4.E13.m1.9.9.1.1.3.2.2.2.2" xref="S4.E13.m1.9.9.1.1.3.2.2.2.2.cmml">N</mi><mrow id="S4.E13.m1.6.6.2.4" xref="S4.E13.m1.6.6.2.3.cmml"><mi id="S4.E13.m1.5.5.1.1" xref="S4.E13.m1.5.5.1.1.cmml">k</mi><mo id="S4.E13.m1.6.6.2.4.1" xref="S4.E13.m1.6.6.2.3.cmml">,</mo><mi id="S4.E13.m1.6.6.2.2" xref="S4.E13.m1.6.6.2.2.cmml">c</mi></mrow><mi id="S4.E13.m1.9.9.1.1.3.2.2.3" xref="S4.E13.m1.9.9.1.1.3.2.2.3.cmml">r</mi></msubsup><mo lspace="0em" rspace="0em" id="S4.E13.m1.9.9.1.1.3.2.1" xref="S4.E13.m1.9.9.1.1.3.2.1.cmml">​</mo><msubsup id="S4.E13.m1.9.9.1.1.3.2.3" xref="S4.E13.m1.9.9.1.1.3.2.3.cmml"><mi id="S4.E13.m1.9.9.1.1.3.2.3.2.2" xref="S4.E13.m1.9.9.1.1.3.2.3.2.2.cmml">𝐩</mi><mrow id="S4.E13.m1.8.8.2.4" xref="S4.E13.m1.8.8.2.3.cmml"><mi id="S4.E13.m1.7.7.1.1" xref="S4.E13.m1.7.7.1.1.cmml">k</mi><mo id="S4.E13.m1.8.8.2.4.1" xref="S4.E13.m1.8.8.2.3.cmml">,</mo><mi id="S4.E13.m1.8.8.2.2" xref="S4.E13.m1.8.8.2.2.cmml">c</mi></mrow><mi id="S4.E13.m1.9.9.1.1.3.2.3.3" xref="S4.E13.m1.9.9.1.1.3.2.3.3.cmml">r</mi></msubsup></mrow></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.E13.m1.9b"><apply id="S4.E13.m1.9.9.cmml" xref="S4.E13.m1.9.9"><eq id="S4.E13.m1.9.9.2.cmml" xref="S4.E13.m1.9.9.2"></eq><apply id="S4.E13.m1.9.9.3.cmml" xref="S4.E13.m1.9.9.3"><csymbol cd="ambiguous" id="S4.E13.m1.9.9.3.1.cmml" xref="S4.E13.m1.9.9.3">superscript</csymbol><apply id="S4.E13.m1.9.9.3.2.cmml" xref="S4.E13.m1.9.9.3"><csymbol cd="ambiguous" id="S4.E13.m1.9.9.3.2.1.cmml" xref="S4.E13.m1.9.9.3">subscript</csymbol><ci id="S4.E13.m1.9.9.3.2.2.cmml" xref="S4.E13.m1.9.9.3.2.2">𝐩</ci><list id="S4.E13.m1.2.2.2.3.cmml" xref="S4.E13.m1.2.2.2.4"><ci id="S4.E13.m1.1.1.1.1.cmml" xref="S4.E13.m1.1.1.1.1">𝐺</ci><ci id="S4.E13.m1.2.2.2.2.cmml" xref="S4.E13.m1.2.2.2.2">𝑐</ci></list></apply><apply id="S4.E13.m1.9.9.3.3.cmml" xref="S4.E13.m1.9.9.3.3"><plus id="S4.E13.m1.9.9.3.3.1.cmml" xref="S4.E13.m1.9.9.3.3.1"></plus><ci id="S4.E13.m1.9.9.3.3.2.cmml" xref="S4.E13.m1.9.9.3.3.2">𝑟</ci><cn type="integer" id="S4.E13.m1.9.9.3.3.3.cmml" xref="S4.E13.m1.9.9.3.3.3">1</cn></apply></apply><apply id="S4.E13.m1.9.9.1.cmml" xref="S4.E13.m1.9.9.1"><plus id="S4.E13.m1.9.9.1.2.cmml" xref="S4.E13.m1.9.9.1.2"></plus><apply id="S4.E13.m1.9.9.1.3.cmml" xref="S4.E13.m1.9.9.1.3"><times id="S4.E13.m1.9.9.1.3.1.cmml" xref="S4.E13.m1.9.9.1.3.1"></times><apply id="S4.E13.m1.9.9.1.3.2.cmml" xref="S4.E13.m1.9.9.1.3.2"><csymbol cd="ambiguous" id="S4.E13.m1.9.9.1.3.2.1.cmml" xref="S4.E13.m1.9.9.1.3.2">superscript</csymbol><ci id="S4.E13.m1.9.9.1.3.2.2.cmml" xref="S4.E13.m1.9.9.1.3.2.2">𝛽</ci><ci id="S4.E13.m1.9.9.1.3.2.3.cmml" xref="S4.E13.m1.9.9.1.3.2.3">′</ci></apply><apply id="S4.E13.m1.9.9.1.3.3.cmml" xref="S4.E13.m1.9.9.1.3.3"><csymbol cd="ambiguous" id="S4.E13.m1.9.9.1.3.3.1.cmml" xref="S4.E13.m1.9.9.1.3.3">superscript</csymbol><apply id="S4.E13.m1.9.9.1.3.3.2.cmml" xref="S4.E13.m1.9.9.1.3.3"><csymbol cd="ambiguous" id="S4.E13.m1.9.9.1.3.3.2.1.cmml" xref="S4.E13.m1.9.9.1.3.3">subscript</csymbol><ci id="S4.E13.m1.9.9.1.3.3.2.2.cmml" xref="S4.E13.m1.9.9.1.3.3.2.2">𝐩</ci><list id="S4.E13.m1.4.4.2.3.cmml" xref="S4.E13.m1.4.4.2.4"><ci id="S4.E13.m1.3.3.1.1.cmml" xref="S4.E13.m1.3.3.1.1">𝐺</ci><ci id="S4.E13.m1.4.4.2.2.cmml" xref="S4.E13.m1.4.4.2.2">𝑐</ci></list></apply><apply id="S4.E13.m1.9.9.1.3.3.3.cmml" xref="S4.E13.m1.9.9.1.3.3.3"><minus id="S4.E13.m1.9.9.1.3.3.3.1.cmml" xref="S4.E13.m1.9.9.1.3.3.3.1"></minus><ci id="S4.E13.m1.9.9.1.3.3.3.2.cmml" xref="S4.E13.m1.9.9.1.3.3.3.2">𝑟</ci><cn type="integer" id="S4.E13.m1.9.9.1.3.3.3.3.cmml" xref="S4.E13.m1.9.9.1.3.3.3.3">1</cn></apply></apply></apply><apply id="S4.E13.m1.9.9.1.1.cmml" xref="S4.E13.m1.9.9.1.1"><times id="S4.E13.m1.9.9.1.1.2.cmml" xref="S4.E13.m1.9.9.1.1.2"></times><apply id="S4.E13.m1.9.9.1.1.1.1.1.cmml" xref="S4.E13.m1.9.9.1.1.1.1"><minus id="S4.E13.m1.9.9.1.1.1.1.1.1.cmml" xref="S4.E13.m1.9.9.1.1.1.1.1.1"></minus><cn type="integer" id="S4.E13.m1.9.9.1.1.1.1.1.2.cmml" xref="S4.E13.m1.9.9.1.1.1.1.1.2">1</cn><apply id="S4.E13.m1.9.9.1.1.1.1.1.3.cmml" xref="S4.E13.m1.9.9.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S4.E13.m1.9.9.1.1.1.1.1.3.1.cmml" xref="S4.E13.m1.9.9.1.1.1.1.1.3">superscript</csymbol><ci id="S4.E13.m1.9.9.1.1.1.1.1.3.2.cmml" xref="S4.E13.m1.9.9.1.1.1.1.1.3.2">𝛽</ci><ci id="S4.E13.m1.9.9.1.1.1.1.1.3.3.cmml" xref="S4.E13.m1.9.9.1.1.1.1.1.3.3">′</ci></apply></apply><apply id="S4.E13.m1.9.9.1.1.3.cmml" xref="S4.E13.m1.9.9.1.1.3"><apply id="S4.E13.m1.9.9.1.1.3.1.cmml" xref="S4.E13.m1.9.9.1.1.3.1"><csymbol cd="ambiguous" id="S4.E13.m1.9.9.1.1.3.1.1.cmml" xref="S4.E13.m1.9.9.1.1.3.1">subscript</csymbol><sum id="S4.E13.m1.9.9.1.1.3.1.2.cmml" xref="S4.E13.m1.9.9.1.1.3.1.2"></sum><apply id="S4.E13.m1.9.9.1.1.3.1.3.cmml" xref="S4.E13.m1.9.9.1.1.3.1.3"><in id="S4.E13.m1.9.9.1.1.3.1.3.1.cmml" xref="S4.E13.m1.9.9.1.1.3.1.3.1"></in><ci id="S4.E13.m1.9.9.1.1.3.1.3.2.cmml" xref="S4.E13.m1.9.9.1.1.3.1.3.2">𝑘</ci><apply id="S4.E13.m1.9.9.1.1.3.1.3.3.cmml" xref="S4.E13.m1.9.9.1.1.3.1.3.3"><csymbol cd="ambiguous" id="S4.E13.m1.9.9.1.1.3.1.3.3.1.cmml" xref="S4.E13.m1.9.9.1.1.3.1.3.3">superscript</csymbol><ci id="S4.E13.m1.9.9.1.1.3.1.3.3.2.cmml" xref="S4.E13.m1.9.9.1.1.3.1.3.3.2">𝒦</ci><ci id="S4.E13.m1.9.9.1.1.3.1.3.3.3.cmml" xref="S4.E13.m1.9.9.1.1.3.1.3.3.3">𝑟</ci></apply></apply></apply><apply id="S4.E13.m1.9.9.1.1.3.2.cmml" xref="S4.E13.m1.9.9.1.1.3.2"><times id="S4.E13.m1.9.9.1.1.3.2.1.cmml" xref="S4.E13.m1.9.9.1.1.3.2.1"></times><apply id="S4.E13.m1.9.9.1.1.3.2.2.cmml" xref="S4.E13.m1.9.9.1.1.3.2.2"><csymbol cd="ambiguous" id="S4.E13.m1.9.9.1.1.3.2.2.1.cmml" xref="S4.E13.m1.9.9.1.1.3.2.2">superscript</csymbol><apply id="S4.E13.m1.9.9.1.1.3.2.2.2.cmml" xref="S4.E13.m1.9.9.1.1.3.2.2"><csymbol cd="ambiguous" id="S4.E13.m1.9.9.1.1.3.2.2.2.1.cmml" xref="S4.E13.m1.9.9.1.1.3.2.2">subscript</csymbol><ci id="S4.E13.m1.9.9.1.1.3.2.2.2.2.cmml" xref="S4.E13.m1.9.9.1.1.3.2.2.2.2">𝑁</ci><list id="S4.E13.m1.6.6.2.3.cmml" xref="S4.E13.m1.6.6.2.4"><ci id="S4.E13.m1.5.5.1.1.cmml" xref="S4.E13.m1.5.5.1.1">𝑘</ci><ci id="S4.E13.m1.6.6.2.2.cmml" xref="S4.E13.m1.6.6.2.2">𝑐</ci></list></apply><ci id="S4.E13.m1.9.9.1.1.3.2.2.3.cmml" xref="S4.E13.m1.9.9.1.1.3.2.2.3">𝑟</ci></apply><apply id="S4.E13.m1.9.9.1.1.3.2.3.cmml" xref="S4.E13.m1.9.9.1.1.3.2.3"><csymbol cd="ambiguous" id="S4.E13.m1.9.9.1.1.3.2.3.1.cmml" xref="S4.E13.m1.9.9.1.1.3.2.3">superscript</csymbol><apply id="S4.E13.m1.9.9.1.1.3.2.3.2.cmml" xref="S4.E13.m1.9.9.1.1.3.2.3"><csymbol cd="ambiguous" id="S4.E13.m1.9.9.1.1.3.2.3.2.1.cmml" xref="S4.E13.m1.9.9.1.1.3.2.3">subscript</csymbol><ci id="S4.E13.m1.9.9.1.1.3.2.3.2.2.cmml" xref="S4.E13.m1.9.9.1.1.3.2.3.2.2">𝐩</ci><list id="S4.E13.m1.8.8.2.3.cmml" xref="S4.E13.m1.8.8.2.4"><ci id="S4.E13.m1.7.7.1.1.cmml" xref="S4.E13.m1.7.7.1.1">𝑘</ci><ci id="S4.E13.m1.8.8.2.2.cmml" xref="S4.E13.m1.8.8.2.2">𝑐</ci></list></apply><ci id="S4.E13.m1.9.9.1.1.3.2.3.3.cmml" xref="S4.E13.m1.9.9.1.1.3.2.3.3">𝑟</ci></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.E13.m1.9c">\mathbf{p}_{G,c}^{r+1}=\beta^{\prime}\mathbf{p}_{G,c}^{r-1}+(1-\beta^{\prime})\sum_{k\in\mathcal{K}^{r}}N_{k,c}^{r}\mathbf{p}_{k,c}^{r}</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(13)</span></td>
</tr></tbody>
</table>
<p id="S4.SS4.p3.4" class="ltx_p">where <math id="S4.SS4.p3.1.m1.5" class="ltx_Math" alttext="N_{k,c}^{r}=|\mathcal{F}_{k,c}|" display="inline"><semantics id="S4.SS4.p3.1.m1.5a"><mrow id="S4.SS4.p3.1.m1.5.5" xref="S4.SS4.p3.1.m1.5.5.cmml"><msubsup id="S4.SS4.p3.1.m1.5.5.3" xref="S4.SS4.p3.1.m1.5.5.3.cmml"><mi id="S4.SS4.p3.1.m1.5.5.3.2.2" xref="S4.SS4.p3.1.m1.5.5.3.2.2.cmml">N</mi><mrow id="S4.SS4.p3.1.m1.2.2.2.4" xref="S4.SS4.p3.1.m1.2.2.2.3.cmml"><mi id="S4.SS4.p3.1.m1.1.1.1.1" xref="S4.SS4.p3.1.m1.1.1.1.1.cmml">k</mi><mo id="S4.SS4.p3.1.m1.2.2.2.4.1" xref="S4.SS4.p3.1.m1.2.2.2.3.cmml">,</mo><mi id="S4.SS4.p3.1.m1.2.2.2.2" xref="S4.SS4.p3.1.m1.2.2.2.2.cmml">c</mi></mrow><mi id="S4.SS4.p3.1.m1.5.5.3.3" xref="S4.SS4.p3.1.m1.5.5.3.3.cmml">r</mi></msubsup><mo id="S4.SS4.p3.1.m1.5.5.2" xref="S4.SS4.p3.1.m1.5.5.2.cmml">=</mo><mrow id="S4.SS4.p3.1.m1.5.5.1.1" xref="S4.SS4.p3.1.m1.5.5.1.2.cmml"><mo stretchy="false" id="S4.SS4.p3.1.m1.5.5.1.1.2" xref="S4.SS4.p3.1.m1.5.5.1.2.1.cmml">|</mo><msub id="S4.SS4.p3.1.m1.5.5.1.1.1" xref="S4.SS4.p3.1.m1.5.5.1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.SS4.p3.1.m1.5.5.1.1.1.2" xref="S4.SS4.p3.1.m1.5.5.1.1.1.2.cmml">ℱ</mi><mrow id="S4.SS4.p3.1.m1.4.4.2.4" xref="S4.SS4.p3.1.m1.4.4.2.3.cmml"><mi id="S4.SS4.p3.1.m1.3.3.1.1" xref="S4.SS4.p3.1.m1.3.3.1.1.cmml">k</mi><mo id="S4.SS4.p3.1.m1.4.4.2.4.1" xref="S4.SS4.p3.1.m1.4.4.2.3.cmml">,</mo><mi id="S4.SS4.p3.1.m1.4.4.2.2" xref="S4.SS4.p3.1.m1.4.4.2.2.cmml">c</mi></mrow></msub><mo stretchy="false" id="S4.SS4.p3.1.m1.5.5.1.1.3" xref="S4.SS4.p3.1.m1.5.5.1.2.1.cmml">|</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS4.p3.1.m1.5b"><apply id="S4.SS4.p3.1.m1.5.5.cmml" xref="S4.SS4.p3.1.m1.5.5"><eq id="S4.SS4.p3.1.m1.5.5.2.cmml" xref="S4.SS4.p3.1.m1.5.5.2"></eq><apply id="S4.SS4.p3.1.m1.5.5.3.cmml" xref="S4.SS4.p3.1.m1.5.5.3"><csymbol cd="ambiguous" id="S4.SS4.p3.1.m1.5.5.3.1.cmml" xref="S4.SS4.p3.1.m1.5.5.3">superscript</csymbol><apply id="S4.SS4.p3.1.m1.5.5.3.2.cmml" xref="S4.SS4.p3.1.m1.5.5.3"><csymbol cd="ambiguous" id="S4.SS4.p3.1.m1.5.5.3.2.1.cmml" xref="S4.SS4.p3.1.m1.5.5.3">subscript</csymbol><ci id="S4.SS4.p3.1.m1.5.5.3.2.2.cmml" xref="S4.SS4.p3.1.m1.5.5.3.2.2">𝑁</ci><list id="S4.SS4.p3.1.m1.2.2.2.3.cmml" xref="S4.SS4.p3.1.m1.2.2.2.4"><ci id="S4.SS4.p3.1.m1.1.1.1.1.cmml" xref="S4.SS4.p3.1.m1.1.1.1.1">𝑘</ci><ci id="S4.SS4.p3.1.m1.2.2.2.2.cmml" xref="S4.SS4.p3.1.m1.2.2.2.2">𝑐</ci></list></apply><ci id="S4.SS4.p3.1.m1.5.5.3.3.cmml" xref="S4.SS4.p3.1.m1.5.5.3.3">𝑟</ci></apply><apply id="S4.SS4.p3.1.m1.5.5.1.2.cmml" xref="S4.SS4.p3.1.m1.5.5.1.1"><abs id="S4.SS4.p3.1.m1.5.5.1.2.1.cmml" xref="S4.SS4.p3.1.m1.5.5.1.1.2"></abs><apply id="S4.SS4.p3.1.m1.5.5.1.1.1.cmml" xref="S4.SS4.p3.1.m1.5.5.1.1.1"><csymbol cd="ambiguous" id="S4.SS4.p3.1.m1.5.5.1.1.1.1.cmml" xref="S4.SS4.p3.1.m1.5.5.1.1.1">subscript</csymbol><ci id="S4.SS4.p3.1.m1.5.5.1.1.1.2.cmml" xref="S4.SS4.p3.1.m1.5.5.1.1.1.2">ℱ</ci><list id="S4.SS4.p3.1.m1.4.4.2.3.cmml" xref="S4.SS4.p3.1.m1.4.4.2.4"><ci id="S4.SS4.p3.1.m1.3.3.1.1.cmml" xref="S4.SS4.p3.1.m1.3.3.1.1">𝑘</ci><ci id="S4.SS4.p3.1.m1.4.4.2.2.cmml" xref="S4.SS4.p3.1.m1.4.4.2.2">𝑐</ci></list></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS4.p3.1.m1.5c">N_{k,c}^{r}=|\mathcal{F}_{k,c}|</annotation></semantics></math> at round <math id="S4.SS4.p3.2.m2.1" class="ltx_Math" alttext="r" display="inline"><semantics id="S4.SS4.p3.2.m2.1a"><mi id="S4.SS4.p3.2.m2.1.1" xref="S4.SS4.p3.2.m2.1.1.cmml">r</mi><annotation-xml encoding="MathML-Content" id="S4.SS4.p3.2.m2.1b"><ci id="S4.SS4.p3.2.m2.1.1.cmml" xref="S4.SS4.p3.2.m2.1.1">𝑟</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS4.p3.2.m2.1c">r</annotation></semantics></math> and <math id="S4.SS4.p3.3.m3.4" class="ltx_Math" alttext="N_{c}^{r,tot}=\sum_{k\in\mathcal{K}}N_{k,c}" display="inline"><semantics id="S4.SS4.p3.3.m3.4a"><mrow id="S4.SS4.p3.3.m3.4.5" xref="S4.SS4.p3.3.m3.4.5.cmml"><msubsup id="S4.SS4.p3.3.m3.4.5.2" xref="S4.SS4.p3.3.m3.4.5.2.cmml"><mi id="S4.SS4.p3.3.m3.4.5.2.2.2" xref="S4.SS4.p3.3.m3.4.5.2.2.2.cmml">N</mi><mi id="S4.SS4.p3.3.m3.4.5.2.2.3" xref="S4.SS4.p3.3.m3.4.5.2.2.3.cmml">c</mi><mrow id="S4.SS4.p3.3.m3.2.2.2.2" xref="S4.SS4.p3.3.m3.2.2.2.3.cmml"><mi id="S4.SS4.p3.3.m3.1.1.1.1" xref="S4.SS4.p3.3.m3.1.1.1.1.cmml">r</mi><mo id="S4.SS4.p3.3.m3.2.2.2.2.2" xref="S4.SS4.p3.3.m3.2.2.2.3.cmml">,</mo><mrow id="S4.SS4.p3.3.m3.2.2.2.2.1" xref="S4.SS4.p3.3.m3.2.2.2.2.1.cmml"><mi id="S4.SS4.p3.3.m3.2.2.2.2.1.2" xref="S4.SS4.p3.3.m3.2.2.2.2.1.2.cmml">t</mi><mo lspace="0em" rspace="0em" id="S4.SS4.p3.3.m3.2.2.2.2.1.1" xref="S4.SS4.p3.3.m3.2.2.2.2.1.1.cmml">​</mo><mi id="S4.SS4.p3.3.m3.2.2.2.2.1.3" xref="S4.SS4.p3.3.m3.2.2.2.2.1.3.cmml">o</mi><mo lspace="0em" rspace="0em" id="S4.SS4.p3.3.m3.2.2.2.2.1.1a" xref="S4.SS4.p3.3.m3.2.2.2.2.1.1.cmml">​</mo><mi id="S4.SS4.p3.3.m3.2.2.2.2.1.4" xref="S4.SS4.p3.3.m3.2.2.2.2.1.4.cmml">t</mi></mrow></mrow></msubsup><mo rspace="0.111em" id="S4.SS4.p3.3.m3.4.5.1" xref="S4.SS4.p3.3.m3.4.5.1.cmml">=</mo><mrow id="S4.SS4.p3.3.m3.4.5.3" xref="S4.SS4.p3.3.m3.4.5.3.cmml"><msub id="S4.SS4.p3.3.m3.4.5.3.1" xref="S4.SS4.p3.3.m3.4.5.3.1.cmml"><mo id="S4.SS4.p3.3.m3.4.5.3.1.2" xref="S4.SS4.p3.3.m3.4.5.3.1.2.cmml">∑</mo><mrow id="S4.SS4.p3.3.m3.4.5.3.1.3" xref="S4.SS4.p3.3.m3.4.5.3.1.3.cmml"><mi id="S4.SS4.p3.3.m3.4.5.3.1.3.2" xref="S4.SS4.p3.3.m3.4.5.3.1.3.2.cmml">k</mi><mo id="S4.SS4.p3.3.m3.4.5.3.1.3.1" xref="S4.SS4.p3.3.m3.4.5.3.1.3.1.cmml">∈</mo><mi class="ltx_font_mathcaligraphic" id="S4.SS4.p3.3.m3.4.5.3.1.3.3" xref="S4.SS4.p3.3.m3.4.5.3.1.3.3.cmml">𝒦</mi></mrow></msub><msub id="S4.SS4.p3.3.m3.4.5.3.2" xref="S4.SS4.p3.3.m3.4.5.3.2.cmml"><mi id="S4.SS4.p3.3.m3.4.5.3.2.2" xref="S4.SS4.p3.3.m3.4.5.3.2.2.cmml">N</mi><mrow id="S4.SS4.p3.3.m3.4.4.2.4" xref="S4.SS4.p3.3.m3.4.4.2.3.cmml"><mi id="S4.SS4.p3.3.m3.3.3.1.1" xref="S4.SS4.p3.3.m3.3.3.1.1.cmml">k</mi><mo id="S4.SS4.p3.3.m3.4.4.2.4.1" xref="S4.SS4.p3.3.m3.4.4.2.3.cmml">,</mo><mi id="S4.SS4.p3.3.m3.4.4.2.2" xref="S4.SS4.p3.3.m3.4.4.2.2.cmml">c</mi></mrow></msub></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS4.p3.3.m3.4b"><apply id="S4.SS4.p3.3.m3.4.5.cmml" xref="S4.SS4.p3.3.m3.4.5"><eq id="S4.SS4.p3.3.m3.4.5.1.cmml" xref="S4.SS4.p3.3.m3.4.5.1"></eq><apply id="S4.SS4.p3.3.m3.4.5.2.cmml" xref="S4.SS4.p3.3.m3.4.5.2"><csymbol cd="ambiguous" id="S4.SS4.p3.3.m3.4.5.2.1.cmml" xref="S4.SS4.p3.3.m3.4.5.2">superscript</csymbol><apply id="S4.SS4.p3.3.m3.4.5.2.2.cmml" xref="S4.SS4.p3.3.m3.4.5.2"><csymbol cd="ambiguous" id="S4.SS4.p3.3.m3.4.5.2.2.1.cmml" xref="S4.SS4.p3.3.m3.4.5.2">subscript</csymbol><ci id="S4.SS4.p3.3.m3.4.5.2.2.2.cmml" xref="S4.SS4.p3.3.m3.4.5.2.2.2">𝑁</ci><ci id="S4.SS4.p3.3.m3.4.5.2.2.3.cmml" xref="S4.SS4.p3.3.m3.4.5.2.2.3">𝑐</ci></apply><list id="S4.SS4.p3.3.m3.2.2.2.3.cmml" xref="S4.SS4.p3.3.m3.2.2.2.2"><ci id="S4.SS4.p3.3.m3.1.1.1.1.cmml" xref="S4.SS4.p3.3.m3.1.1.1.1">𝑟</ci><apply id="S4.SS4.p3.3.m3.2.2.2.2.1.cmml" xref="S4.SS4.p3.3.m3.2.2.2.2.1"><times id="S4.SS4.p3.3.m3.2.2.2.2.1.1.cmml" xref="S4.SS4.p3.3.m3.2.2.2.2.1.1"></times><ci id="S4.SS4.p3.3.m3.2.2.2.2.1.2.cmml" xref="S4.SS4.p3.3.m3.2.2.2.2.1.2">𝑡</ci><ci id="S4.SS4.p3.3.m3.2.2.2.2.1.3.cmml" xref="S4.SS4.p3.3.m3.2.2.2.2.1.3">𝑜</ci><ci id="S4.SS4.p3.3.m3.2.2.2.2.1.4.cmml" xref="S4.SS4.p3.3.m3.2.2.2.2.1.4">𝑡</ci></apply></list></apply><apply id="S4.SS4.p3.3.m3.4.5.3.cmml" xref="S4.SS4.p3.3.m3.4.5.3"><apply id="S4.SS4.p3.3.m3.4.5.3.1.cmml" xref="S4.SS4.p3.3.m3.4.5.3.1"><csymbol cd="ambiguous" id="S4.SS4.p3.3.m3.4.5.3.1.1.cmml" xref="S4.SS4.p3.3.m3.4.5.3.1">subscript</csymbol><sum id="S4.SS4.p3.3.m3.4.5.3.1.2.cmml" xref="S4.SS4.p3.3.m3.4.5.3.1.2"></sum><apply id="S4.SS4.p3.3.m3.4.5.3.1.3.cmml" xref="S4.SS4.p3.3.m3.4.5.3.1.3"><in id="S4.SS4.p3.3.m3.4.5.3.1.3.1.cmml" xref="S4.SS4.p3.3.m3.4.5.3.1.3.1"></in><ci id="S4.SS4.p3.3.m3.4.5.3.1.3.2.cmml" xref="S4.SS4.p3.3.m3.4.5.3.1.3.2">𝑘</ci><ci id="S4.SS4.p3.3.m3.4.5.3.1.3.3.cmml" xref="S4.SS4.p3.3.m3.4.5.3.1.3.3">𝒦</ci></apply></apply><apply id="S4.SS4.p3.3.m3.4.5.3.2.cmml" xref="S4.SS4.p3.3.m3.4.5.3.2"><csymbol cd="ambiguous" id="S4.SS4.p3.3.m3.4.5.3.2.1.cmml" xref="S4.SS4.p3.3.m3.4.5.3.2">subscript</csymbol><ci id="S4.SS4.p3.3.m3.4.5.3.2.2.cmml" xref="S4.SS4.p3.3.m3.4.5.3.2.2">𝑁</ci><list id="S4.SS4.p3.3.m3.4.4.2.3.cmml" xref="S4.SS4.p3.3.m3.4.4.2.4"><ci id="S4.SS4.p3.3.m3.3.3.1.1.cmml" xref="S4.SS4.p3.3.m3.3.3.1.1">𝑘</ci><ci id="S4.SS4.p3.3.m3.4.4.2.2.cmml" xref="S4.SS4.p3.3.m3.4.4.2.2">𝑐</ci></list></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS4.p3.3.m3.4c">N_{c}^{r,tot}=\sum_{k\in\mathcal{K}}N_{k,c}</annotation></semantics></math>. We used the same smoothing parameter of <a href="#S4.E4" title="In 4.3 Prototypical Learning ‣ 4 Training Procedure ‣ When Cars meet Drones: Hyperbolic Federated Learning for Source-Free Domain Adaptation in Adverse Weather" class="ltx_ref"><span class="ltx_text ltx_ref_tag">Eq.</span> <span class="ltx_text ltx_ref_tag">4</span></a>, i.e., <math id="S4.SS4.p3.4.m4.1" class="ltx_Math" alttext="\beta^{\prime}=\beta=0.85" display="inline"><semantics id="S4.SS4.p3.4.m4.1a"><mrow id="S4.SS4.p3.4.m4.1.1" xref="S4.SS4.p3.4.m4.1.1.cmml"><msup id="S4.SS4.p3.4.m4.1.1.2" xref="S4.SS4.p3.4.m4.1.1.2.cmml"><mi id="S4.SS4.p3.4.m4.1.1.2.2" xref="S4.SS4.p3.4.m4.1.1.2.2.cmml">β</mi><mo id="S4.SS4.p3.4.m4.1.1.2.3" xref="S4.SS4.p3.4.m4.1.1.2.3.cmml">′</mo></msup><mo id="S4.SS4.p3.4.m4.1.1.3" xref="S4.SS4.p3.4.m4.1.1.3.cmml">=</mo><mi id="S4.SS4.p3.4.m4.1.1.4" xref="S4.SS4.p3.4.m4.1.1.4.cmml">β</mi><mo id="S4.SS4.p3.4.m4.1.1.5" xref="S4.SS4.p3.4.m4.1.1.5.cmml">=</mo><mn id="S4.SS4.p3.4.m4.1.1.6" xref="S4.SS4.p3.4.m4.1.1.6.cmml">0.85</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.SS4.p3.4.m4.1b"><apply id="S4.SS4.p3.4.m4.1.1.cmml" xref="S4.SS4.p3.4.m4.1.1"><and id="S4.SS4.p3.4.m4.1.1a.cmml" xref="S4.SS4.p3.4.m4.1.1"></and><apply id="S4.SS4.p3.4.m4.1.1b.cmml" xref="S4.SS4.p3.4.m4.1.1"><eq id="S4.SS4.p3.4.m4.1.1.3.cmml" xref="S4.SS4.p3.4.m4.1.1.3"></eq><apply id="S4.SS4.p3.4.m4.1.1.2.cmml" xref="S4.SS4.p3.4.m4.1.1.2"><csymbol cd="ambiguous" id="S4.SS4.p3.4.m4.1.1.2.1.cmml" xref="S4.SS4.p3.4.m4.1.1.2">superscript</csymbol><ci id="S4.SS4.p3.4.m4.1.1.2.2.cmml" xref="S4.SS4.p3.4.m4.1.1.2.2">𝛽</ci><ci id="S4.SS4.p3.4.m4.1.1.2.3.cmml" xref="S4.SS4.p3.4.m4.1.1.2.3">′</ci></apply><ci id="S4.SS4.p3.4.m4.1.1.4.cmml" xref="S4.SS4.p3.4.m4.1.1.4">𝛽</ci></apply><apply id="S4.SS4.p3.4.m4.1.1c.cmml" xref="S4.SS4.p3.4.m4.1.1"><eq id="S4.SS4.p3.4.m4.1.1.5.cmml" xref="S4.SS4.p3.4.m4.1.1.5"></eq><share href="#S4.SS4.p3.4.m4.1.1.4.cmml" id="S4.SS4.p3.4.m4.1.1d.cmml" xref="S4.SS4.p3.4.m4.1.1"></share><cn type="float" id="S4.SS4.p3.4.m4.1.1.6.cmml" xref="S4.SS4.p3.4.m4.1.1.6">0.85</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS4.p3.4.m4.1c">\beta^{\prime}=\beta=0.85</annotation></semantics></math>.
<br class="ltx_break"></p>
</div>
<figure id="S4.F4" class="ltx_figure">
<div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_2">
<figure id="S4.F4.1" class="ltx_figure ltx_figure_panel ltx_minipage ltx_align_center ltx_align_bottom" style="width:186.5pt;">
<div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_2">
<figure id="S4.T1" class="ltx_table ltx_figure_panel">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_table"><span id="S4.T1.4.2.1" class="ltx_text" style="font-size:90%;">Table 1</span>: </span><span id="S4.T1.2.1" class="ltx_text" style="font-size:90%;">Data distribution (<math id="S4.T1.2.1.m1.1" class="ltx_Math" alttext="\dagger" display="inline"><semantics id="S4.T1.2.1.m1.1b"><mo id="S4.T1.2.1.m1.1.1" xref="S4.T1.2.1.m1.1.1.cmml">†</mo><annotation-xml encoding="MathML-Content" id="S4.T1.2.1.m1.1c"><ci id="S4.T1.2.1.m1.1.1.cmml" xref="S4.T1.2.1.m1.1.1">†</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.T1.2.1.m1.1d">\dagger</annotation></semantics></math>: with Cityscapes as clear, see Suppl. Mat. )</span></figcaption>
</figure>
</div>
<div class="ltx_flex_cell ltx_flex_size_2">
<div id="S4.F4.1.1" class="ltx_inline-block ltx_figure_panel ltx_align_center ltx_transformed_outer" style="width:200.2pt;height:130.1pt;vertical-align:-0.0pt;"><span class="ltx_transformed_inner" style="transform:translate(-52.3pt,34.0pt) scale(0.657006620156645,0.657006620156645) ;">
<table id="S4.F4.1.1.1" class="ltx_tabular ltx_align_middle">
<tr id="S4.F4.1.1.1.2" class="ltx_tr">
<td id="S4.F4.1.1.1.2.1" class="ltx_td ltx_border_tt"></td>
<td id="S4.F4.1.1.1.2.2" class="ltx_td ltx_border_tt"></td>
<td id="S4.F4.1.1.1.2.3" class="ltx_td ltx_border_tt"></td>
<td id="S4.F4.1.1.1.2.4" class="ltx_td ltx_align_center ltx_border_tt"><span id="S4.F4.1.1.1.2.4.1" class="ltx_text ltx_font_bold">Clear</span></td>
<td id="S4.F4.1.1.1.2.5" class="ltx_td ltx_align_center ltx_border_tt"><span id="S4.F4.1.1.1.2.5.1" class="ltx_text ltx_font_bold">Night</span></td>
<td id="S4.F4.1.1.1.2.6" class="ltx_td ltx_align_center ltx_border_tt"><span id="S4.F4.1.1.1.2.6.1" class="ltx_text ltx_font_bold">Rain</span></td>
<td id="S4.F4.1.1.1.2.7" class="ltx_td ltx_align_center ltx_border_tt"><span id="S4.F4.1.1.1.2.7.1" class="ltx_text ltx_font_bold">Fog</span></td>
</tr>
<tr id="S4.F4.1.1.1.3" class="ltx_tr">
<td id="S4.F4.1.1.1.3.1" class="ltx_td ltx_align_center ltx_border_t" rowspan="4"><span id="S4.F4.1.1.1.3.1.1" class="ltx_text">
<span id="S4.F4.1.1.1.3.1.1.1" class="ltx_inline-block ltx_transformed_outer" style="width:6.8pt;height:35.3pt;vertical-align:-0.0pt;"><span class="ltx_transformed_inner" style="width:35.3pt;transform:translate(-14.22pt,-14.22pt) rotate(-90deg) ;">
<span id="S4.F4.1.1.1.3.1.1.1.1" class="ltx_p">SYNTH</span>
</span></span></span></td>
<td id="S4.F4.1.1.1.3.2" class="ltx_td ltx_align_center ltx_border_t" rowspan="2"><span id="S4.F4.1.1.1.3.2.1" class="ltx_text ltx_font_bold">SELMA</span></td>
<td id="S4.F4.1.1.1.3.3" class="ltx_td ltx_align_center ltx_border_t">Train</td>
<td id="S4.F4.1.1.1.3.4" class="ltx_td ltx_align_center ltx_border_t">24735</td>
<td id="S4.F4.1.1.1.3.5" class="ltx_td ltx_align_center ltx_border_t">24735</td>
<td id="S4.F4.1.1.1.3.6" class="ltx_td ltx_align_center ltx_border_t">24735</td>
<td id="S4.F4.1.1.1.3.7" class="ltx_td ltx_align_center ltx_border_t">24735</td>
</tr>
<tr id="S4.F4.1.1.1.4" class="ltx_tr">
<td id="S4.F4.1.1.1.4.1" class="ltx_td ltx_align_center">Test</td>
<td id="S4.F4.1.1.1.4.2" class="ltx_td ltx_align_center">3087</td>
<td id="S4.F4.1.1.1.4.3" class="ltx_td ltx_align_center">3087</td>
<td id="S4.F4.1.1.1.4.4" class="ltx_td ltx_align_center">3087</td>
<td id="S4.F4.1.1.1.4.5" class="ltx_td ltx_align_center">3087</td>
</tr>
<tr id="S4.F4.1.1.1.5" class="ltx_tr">
<td id="S4.F4.1.1.1.5.1" class="ltx_td ltx_align_center ltx_border_t" rowspan="2"><span id="S4.F4.1.1.1.5.1.1" class="ltx_text ltx_font_bold">FLYAWARE-S</span></td>
<td id="S4.F4.1.1.1.5.2" class="ltx_td ltx_align_center ltx_border_t">Train</td>
<td id="S4.F4.1.1.1.5.3" class="ltx_td ltx_align_center ltx_border_t">24771</td>
<td id="S4.F4.1.1.1.5.4" class="ltx_td ltx_align_center ltx_border_t">24731</td>
<td id="S4.F4.1.1.1.5.5" class="ltx_td ltx_align_center ltx_border_t">24808</td>
<td id="S4.F4.1.1.1.5.6" class="ltx_td ltx_align_center ltx_border_t">24631</td>
</tr>
<tr id="S4.F4.1.1.1.6" class="ltx_tr">
<td id="S4.F4.1.1.1.6.1" class="ltx_td ltx_align_center">Test</td>
<td id="S4.F4.1.1.1.6.2" class="ltx_td ltx_align_center">3147</td>
<td id="S4.F4.1.1.1.6.3" class="ltx_td ltx_align_center">3139</td>
<td id="S4.F4.1.1.1.6.4" class="ltx_td ltx_align_center">3128</td>
<td id="S4.F4.1.1.1.6.5" class="ltx_td ltx_align_center">2935</td>
</tr>
<tr id="S4.F4.1.1.1.1" class="ltx_tr">
<td id="S4.F4.1.1.1.1.2" class="ltx_td ltx_align_center ltx_border_bb ltx_border_t" rowspan="6"><span id="S4.F4.1.1.1.1.2.1" class="ltx_text">
<span id="S4.F4.1.1.1.1.2.1.1" class="ltx_inline-block ltx_transformed_outer" style="width:6.8pt;height:27.9pt;vertical-align:-0.0pt;"><span class="ltx_transformed_inner" style="width:27.9pt;transform:translate(-10.54pt,-10.54pt) rotate(-90deg) ;">
<span id="S4.F4.1.1.1.1.2.1.1.1" class="ltx_p">REAL</span>
</span></span></span></td>
<td id="S4.F4.1.1.1.1.1" class="ltx_td ltx_align_center ltx_border_t" rowspan="2"><span id="S4.F4.1.1.1.1.1.1" class="ltx_text ltx_font_bold">ACDC<sup id="S4.F4.1.1.1.1.1.1.2" class="ltx_sup"><span id="S4.F4.1.1.1.1.1.1.2.1" class="ltx_text ltx_font_medium">†</span></sup></span></td>
<td id="S4.F4.1.1.1.1.3" class="ltx_td ltx_align_center ltx_border_t">Train</td>
<td id="S4.F4.1.1.1.1.4" class="ltx_td ltx_align_center ltx_border_t">1060</td>
<td id="S4.F4.1.1.1.1.5" class="ltx_td ltx_align_center ltx_border_t">400</td>
<td id="S4.F4.1.1.1.1.6" class="ltx_td ltx_align_center ltx_border_t">400</td>
<td id="S4.F4.1.1.1.1.7" class="ltx_td ltx_align_center ltx_border_t">400</td>
</tr>
<tr id="S4.F4.1.1.1.7" class="ltx_tr">
<td id="S4.F4.1.1.1.7.1" class="ltx_td ltx_align_center">Test</td>
<td id="S4.F4.1.1.1.7.2" class="ltx_td ltx_align_center">214</td>
<td id="S4.F4.1.1.1.7.3" class="ltx_td ltx_align_center">100</td>
<td id="S4.F4.1.1.1.7.4" class="ltx_td ltx_align_center">100</td>
<td id="S4.F4.1.1.1.7.5" class="ltx_td ltx_align_center">100</td>
</tr>
<tr id="S4.F4.1.1.1.8" class="ltx_tr">
<td id="S4.F4.1.1.1.8.1" class="ltx_td ltx_align_center ltx_border_t" rowspan="2"><span id="S4.F4.1.1.1.8.1.1" class="ltx_text ltx_font_bold">FLYAWARE-R</span></td>
<td id="S4.F4.1.1.1.8.2" class="ltx_td ltx_align_center ltx_border_t">Train</td>
<td id="S4.F4.1.1.1.8.3" class="ltx_td ltx_align_center ltx_border_t">94</td>
<td id="S4.F4.1.1.1.8.4" class="ltx_td ltx_align_center ltx_border_t">35</td>
<td id="S4.F4.1.1.1.8.5" class="ltx_td ltx_align_center ltx_border_t">35</td>
<td id="S4.F4.1.1.1.8.6" class="ltx_td ltx_align_center ltx_border_t">35</td>
</tr>
<tr id="S4.F4.1.1.1.9" class="ltx_tr">
<td id="S4.F4.1.1.1.9.1" class="ltx_td ltx_align_center">Test</td>
<td id="S4.F4.1.1.1.9.2" class="ltx_td ltx_align_center">18</td>
<td id="S4.F4.1.1.1.9.3" class="ltx_td ltx_align_center">18</td>
<td id="S4.F4.1.1.1.9.4" class="ltx_td ltx_align_center">17</td>
<td id="S4.F4.1.1.1.9.5" class="ltx_td ltx_align_center">17</td>
</tr>
<tr id="S4.F4.1.1.1.10" class="ltx_tr">
<td id="S4.F4.1.1.1.10.1" class="ltx_td ltx_align_center ltx_border_bb" rowspan="2"><span id="S4.F4.1.1.1.10.1.1" class="ltx_text ltx_font_bold">FLYAWARE-R-XL</span></td>
<td id="S4.F4.1.1.1.10.2" class="ltx_td ltx_align_center">Train</td>
<td id="S4.F4.1.1.1.10.3" class="ltx_td ltx_align_center">565</td>
<td id="S4.F4.1.1.1.10.4" class="ltx_td ltx_align_center">565</td>
<td id="S4.F4.1.1.1.10.5" class="ltx_td ltx_align_center">565</td>
<td id="S4.F4.1.1.1.10.6" class="ltx_td ltx_align_center">565</td>
</tr>
<tr id="S4.F4.1.1.1.11" class="ltx_tr">
<td id="S4.F4.1.1.1.11.1" class="ltx_td ltx_align_center ltx_border_bb">Test</td>
<td id="S4.F4.1.1.1.11.2" class="ltx_td ltx_align_center ltx_border_bb">112</td>
<td id="S4.F4.1.1.1.11.3" class="ltx_td ltx_align_center ltx_border_bb">53</td>
<td id="S4.F4.1.1.1.11.4" class="ltx_td ltx_align_center ltx_border_bb">52</td>
<td id="S4.F4.1.1.1.11.5" class="ltx_td ltx_align_center ltx_border_bb">52</td>
</tr>
</table>
</span></div>
</div>
</div>
</figure>
</div>
<div class="ltx_flex_cell ltx_flex_size_2">
<figure id="S4.F4.9" class="ltx_figure ltx_figure_panel ltx_minipage ltx_align_center ltx_align_bottom" style="width:234.2pt;">
<div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_1">
<figure id="S4.F4.5.4" class="ltx_figure ltx_figure_panel">
<div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_4">
<div id="S4.F4.5.4.5" class="ltx_block ltx_figure_panel">
<div id="S4.F4.5.4.5.1" class="ltx_inline-block ltx_transformed_outer" style="width:3.4pt;height:14.2pt;vertical-align:-0.0pt;"><span class="ltx_transformed_inner" style="width:14.2pt;transform:translate(-5.41pt,-5.41pt) rotate(-90deg) ;">
<p id="S4.F4.5.4.5.1.1" class="ltx_p"><span id="S4.F4.5.4.5.1.1.1" class="ltx_text" style="font-size:50%;">FA-S</span></p>
</span></div>
<figure id="S4.F4.2.1.1" class="ltx_figure"><img src="/html/2403.13762/assets/figs/syndrone/day.jpg" id="S4.F4.2.1.1.g1" class="ltx_graphics ltx_img_landscape" width="598" height="337" alt="Refer to caption">
</figure>
</div>
</div>
<div class="ltx_flex_cell ltx_flex_size_4">
<figure id="S4.F4.3.2.2" class="ltx_figure ltx_figure_panel"><img src="/html/2403.13762/assets/figs/syndrone/night.jpg" id="S4.F4.3.2.2.g1" class="ltx_graphics ltx_img_landscape" width="598" height="337" alt="Refer to caption">
</figure>
</div>
<div class="ltx_flex_cell ltx_flex_size_4">
<figure id="S4.F4.4.3.3" class="ltx_figure ltx_figure_panel"><img src="/html/2403.13762/assets/figs/syndrone/rain.jpg" id="S4.F4.4.3.3.g1" class="ltx_graphics ltx_img_landscape" width="598" height="337" alt="Refer to caption">
</figure>
</div>
<div class="ltx_flex_cell ltx_flex_size_4">
<figure id="S4.F4.5.4.4" class="ltx_figure ltx_figure_panel"><img src="/html/2403.13762/assets/figs/syndrone/fog.jpg" id="S4.F4.5.4.4.g1" class="ltx_graphics ltx_img_landscape" width="598" height="337" alt="Refer to caption">
</figure>
</div>
</div>
</figure>
</div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_1">
<figure id="S4.F4.9.8" class="ltx_figure ltx_figure_panel ltx_align_center">
<div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_4">
<div id="S4.F4.9.8.5" class="ltx_block ltx_figure_panel">
<div id="S4.F4.9.8.5.1" class="ltx_inline-block ltx_transformed_outer" style="width:3.4pt;height:21.8pt;vertical-align:-0.0pt;"><span class="ltx_transformed_inner" style="width:21.8pt;transform:translate(-9.19pt,-9.19pt) rotate(-90deg) ;">
<p id="S4.F4.9.8.5.1.1" class="ltx_p"><span id="S4.F4.9.8.5.1.1.1" class="ltx_text" style="font-size:50%;">FA-R</span></p>
</span></div>
<figure id="S4.F4.6.5.1" class="ltx_figure"><img src="/html/2403.13762/assets/figs/uavid/day.jpg" id="S4.F4.6.5.1.g1" class="ltx_graphics ltx_img_landscape" width="598" height="337" alt="Refer to caption">
<figcaption class="ltx_caption">Day</figcaption>
</figure>
</div>
</div>
<div class="ltx_flex_cell ltx_flex_size_4">
<figure id="S4.F4.7.6.2" class="ltx_figure ltx_figure_panel"><img src="/html/2403.13762/assets/figs/uavid/night.jpg" id="S4.F4.7.6.2.g1" class="ltx_graphics ltx_img_landscape" width="598" height="337" alt="Refer to caption">
<figcaption class="ltx_caption">Night</figcaption>
</figure>
</div>
<div class="ltx_flex_cell ltx_flex_size_4">
<figure id="S4.F4.8.7.3" class="ltx_figure ltx_figure_panel"><img src="/html/2403.13762/assets/figs/uavid/rain.jpg" id="S4.F4.8.7.3.g1" class="ltx_graphics ltx_img_landscape" width="598" height="337" alt="Refer to caption">
<figcaption class="ltx_caption">Rain</figcaption>
</figure>
</div>
<div class="ltx_flex_cell ltx_flex_size_4">
<figure id="S4.F4.9.8.4" class="ltx_figure ltx_figure_panel"><img src="/html/2403.13762/assets/figs/uavid/fog.jpg" id="S4.F4.9.8.4.g1" class="ltx_graphics ltx_img_landscape" width="598" height="337" alt="Refer to caption">
<figcaption class="ltx_caption">Fog</figcaption>
</figure>
</div>
</div>
</figure>
</div>
</div>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span id="S4.F4.9.9.1.1" class="ltx_text" style="font-size:90%;">Figure 4</span>: </span><span id="S4.F4.9.10.2" class="ltx_text" style="font-size:90%;">Samples from different datasets under varying weather conditions.</span></figcaption>
</figure>
</div>
</div>
</figure>
</section>
</section>
<section id="S5" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">5 </span>The FLYAWARE Adverse Dataset</h2>

<div id="S5.p1" class="ltx_para">
<p id="S5.p1.2" class="ltx_p">In standard autonomous driving for semantic segmentation, there is a sufficient number of datasets providing a diversity of adverse conditions <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib42" title="" class="ltx_ref">42</a>, <a href="#bib.bib34" title="" class="ltx_ref">34</a>]</cite>. However, in the case of aerial viewpoints, a scarcity of such datasets is evident, thus making the development of a dataset of this type a priority to unlock further research on the topic.
To this aim, we introduce a new benchmark FLYAWARE - FLYing in Adverse Weather: Artificial and REal data. In the following section, we outline the structure of the synthetic and real aerial datasets, <math id="S5.p1.1.m1.1" class="ltx_Math" alttext="\mathcal{D}_{drone}^{S}" display="inline"><semantics id="S5.p1.1.m1.1a"><msubsup id="S5.p1.1.m1.1.1" xref="S5.p1.1.m1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S5.p1.1.m1.1.1.2.2" xref="S5.p1.1.m1.1.1.2.2.cmml">𝒟</mi><mrow id="S5.p1.1.m1.1.1.2.3" xref="S5.p1.1.m1.1.1.2.3.cmml"><mi id="S5.p1.1.m1.1.1.2.3.2" xref="S5.p1.1.m1.1.1.2.3.2.cmml">d</mi><mo lspace="0em" rspace="0em" id="S5.p1.1.m1.1.1.2.3.1" xref="S5.p1.1.m1.1.1.2.3.1.cmml">​</mo><mi id="S5.p1.1.m1.1.1.2.3.3" xref="S5.p1.1.m1.1.1.2.3.3.cmml">r</mi><mo lspace="0em" rspace="0em" id="S5.p1.1.m1.1.1.2.3.1a" xref="S5.p1.1.m1.1.1.2.3.1.cmml">​</mo><mi id="S5.p1.1.m1.1.1.2.3.4" xref="S5.p1.1.m1.1.1.2.3.4.cmml">o</mi><mo lspace="0em" rspace="0em" id="S5.p1.1.m1.1.1.2.3.1b" xref="S5.p1.1.m1.1.1.2.3.1.cmml">​</mo><mi id="S5.p1.1.m1.1.1.2.3.5" xref="S5.p1.1.m1.1.1.2.3.5.cmml">n</mi><mo lspace="0em" rspace="0em" id="S5.p1.1.m1.1.1.2.3.1c" xref="S5.p1.1.m1.1.1.2.3.1.cmml">​</mo><mi id="S5.p1.1.m1.1.1.2.3.6" xref="S5.p1.1.m1.1.1.2.3.6.cmml">e</mi></mrow><mi id="S5.p1.1.m1.1.1.3" xref="S5.p1.1.m1.1.1.3.cmml">S</mi></msubsup><annotation-xml encoding="MathML-Content" id="S5.p1.1.m1.1b"><apply id="S5.p1.1.m1.1.1.cmml" xref="S5.p1.1.m1.1.1"><csymbol cd="ambiguous" id="S5.p1.1.m1.1.1.1.cmml" xref="S5.p1.1.m1.1.1">superscript</csymbol><apply id="S5.p1.1.m1.1.1.2.cmml" xref="S5.p1.1.m1.1.1"><csymbol cd="ambiguous" id="S5.p1.1.m1.1.1.2.1.cmml" xref="S5.p1.1.m1.1.1">subscript</csymbol><ci id="S5.p1.1.m1.1.1.2.2.cmml" xref="S5.p1.1.m1.1.1.2.2">𝒟</ci><apply id="S5.p1.1.m1.1.1.2.3.cmml" xref="S5.p1.1.m1.1.1.2.3"><times id="S5.p1.1.m1.1.1.2.3.1.cmml" xref="S5.p1.1.m1.1.1.2.3.1"></times><ci id="S5.p1.1.m1.1.1.2.3.2.cmml" xref="S5.p1.1.m1.1.1.2.3.2">𝑑</ci><ci id="S5.p1.1.m1.1.1.2.3.3.cmml" xref="S5.p1.1.m1.1.1.2.3.3">𝑟</ci><ci id="S5.p1.1.m1.1.1.2.3.4.cmml" xref="S5.p1.1.m1.1.1.2.3.4">𝑜</ci><ci id="S5.p1.1.m1.1.1.2.3.5.cmml" xref="S5.p1.1.m1.1.1.2.3.5">𝑛</ci><ci id="S5.p1.1.m1.1.1.2.3.6.cmml" xref="S5.p1.1.m1.1.1.2.3.6">𝑒</ci></apply></apply><ci id="S5.p1.1.m1.1.1.3.cmml" xref="S5.p1.1.m1.1.1.3">𝑆</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.p1.1.m1.1c">\mathcal{D}_{drone}^{S}</annotation></semantics></math> and <math id="S5.p1.2.m2.1" class="ltx_Math" alttext="\mathcal{D}_{drone}^{T}" display="inline"><semantics id="S5.p1.2.m2.1a"><msubsup id="S5.p1.2.m2.1.1" xref="S5.p1.2.m2.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S5.p1.2.m2.1.1.2.2" xref="S5.p1.2.m2.1.1.2.2.cmml">𝒟</mi><mrow id="S5.p1.2.m2.1.1.2.3" xref="S5.p1.2.m2.1.1.2.3.cmml"><mi id="S5.p1.2.m2.1.1.2.3.2" xref="S5.p1.2.m2.1.1.2.3.2.cmml">d</mi><mo lspace="0em" rspace="0em" id="S5.p1.2.m2.1.1.2.3.1" xref="S5.p1.2.m2.1.1.2.3.1.cmml">​</mo><mi id="S5.p1.2.m2.1.1.2.3.3" xref="S5.p1.2.m2.1.1.2.3.3.cmml">r</mi><mo lspace="0em" rspace="0em" id="S5.p1.2.m2.1.1.2.3.1a" xref="S5.p1.2.m2.1.1.2.3.1.cmml">​</mo><mi id="S5.p1.2.m2.1.1.2.3.4" xref="S5.p1.2.m2.1.1.2.3.4.cmml">o</mi><mo lspace="0em" rspace="0em" id="S5.p1.2.m2.1.1.2.3.1b" xref="S5.p1.2.m2.1.1.2.3.1.cmml">​</mo><mi id="S5.p1.2.m2.1.1.2.3.5" xref="S5.p1.2.m2.1.1.2.3.5.cmml">n</mi><mo lspace="0em" rspace="0em" id="S5.p1.2.m2.1.1.2.3.1c" xref="S5.p1.2.m2.1.1.2.3.1.cmml">​</mo><mi id="S5.p1.2.m2.1.1.2.3.6" xref="S5.p1.2.m2.1.1.2.3.6.cmml">e</mi></mrow><mi id="S5.p1.2.m2.1.1.3" xref="S5.p1.2.m2.1.1.3.cmml">T</mi></msubsup><annotation-xml encoding="MathML-Content" id="S5.p1.2.m2.1b"><apply id="S5.p1.2.m2.1.1.cmml" xref="S5.p1.2.m2.1.1"><csymbol cd="ambiguous" id="S5.p1.2.m2.1.1.1.cmml" xref="S5.p1.2.m2.1.1">superscript</csymbol><apply id="S5.p1.2.m2.1.1.2.cmml" xref="S5.p1.2.m2.1.1"><csymbol cd="ambiguous" id="S5.p1.2.m2.1.1.2.1.cmml" xref="S5.p1.2.m2.1.1">subscript</csymbol><ci id="S5.p1.2.m2.1.1.2.2.cmml" xref="S5.p1.2.m2.1.1.2.2">𝒟</ci><apply id="S5.p1.2.m2.1.1.2.3.cmml" xref="S5.p1.2.m2.1.1.2.3"><times id="S5.p1.2.m2.1.1.2.3.1.cmml" xref="S5.p1.2.m2.1.1.2.3.1"></times><ci id="S5.p1.2.m2.1.1.2.3.2.cmml" xref="S5.p1.2.m2.1.1.2.3.2">𝑑</ci><ci id="S5.p1.2.m2.1.1.2.3.3.cmml" xref="S5.p1.2.m2.1.1.2.3.3">𝑟</ci><ci id="S5.p1.2.m2.1.1.2.3.4.cmml" xref="S5.p1.2.m2.1.1.2.3.4">𝑜</ci><ci id="S5.p1.2.m2.1.1.2.3.5.cmml" xref="S5.p1.2.m2.1.1.2.3.5">𝑛</ci><ci id="S5.p1.2.m2.1.1.2.3.6.cmml" xref="S5.p1.2.m2.1.1.2.3.6">𝑒</ci></apply></apply><ci id="S5.p1.2.m2.1.1.3.cmml" xref="S5.p1.2.m2.1.1.3">𝑇</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.p1.2.m2.1c">\mathcal{D}_{drone}^{T}</annotation></semantics></math>, respectively. They contain over 100K for which we contribute with 108180 generated images and 1287 domain-translated ones. In <a href="#S4.T1" title="In Figure 4 ‣ 4.4 Server Aggregation (AG) ‣ 4 Training Procedure ‣ When Cars meet Drones: Hyperbolic Federated Learning for Source-Free Domain Adaptation in Adverse Weather" class="ltx_ref"><span class="ltx_text ltx_ref_tag">Tab.</span> <span class="ltx_text ltx_ref_tag">1</span></a>, we present the datasets used in this study. For additional information regarding the datasets for autonomous cars, please consult the Suppl. Mat. 
<br class="ltx_break"></p>
</div>
<div id="S5.p2" class="ltx_para">
<p id="S5.p2.1" class="ltx_p"><span id="S5.p2.1.1" class="ltx_text ltx_font_bold">FLYAWARE-S: Adverse Synthetic Dataset.</span> 
Recently released, Syndrone <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib32" title="" class="ltx_ref">32</a>]</cite> is a synthetic dataset based on the CARLA simulator <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib8" title="" class="ltx_ref">8</a>]</cite>.
While the dataset is richly annotated with 28 semantic classes, it currently lacks imagery in different weather conditions.
We extended their work starting from the codebase provided in <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib32" title="" class="ltx_ref">32</a>]</cite> by generating images in 3 adverse weather conditions (<em id="S5.p2.1.2" class="ltx_emph ltx_font_italic">i.e</em>.<span id="S5.p2.1.3" class="ltx_text"></span>, rain, fog, and night), while maintaining the capability of the system to produce images from multiple viewpoints and heights. The dataset includes drone views at heights ranging from 20 to 80 meters and with angles varying from 30 to 90 degrees, all with a resolution of 1920x1080. Moreover, we also generated 3D data (depth maps and LiDAR) for future usage in multimodal architectures.
<br class="ltx_break"></p>
</div>
<div id="S5.p3" class="ltx_para">
<p id="S5.p3.1" class="ltx_p"><span id="S5.p3.1.1" class="ltx_text ltx_font_bold">FLYAWARE-R: Real Dataset Translation.</span>  Since no adverse weather dataset for aerial vehicles is available we opted for using image translation over standard drone datasets to build the adverse weather imagery.
Addressing the task of converting daytime images into adverse conditions requires the availability of images of clear weather samples like sunny or cloudy conditions, and of adverse samples occurring in specific conditions of interest, such as rainy weather.
Inspired by <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib13" title="" class="ltx_ref">13</a>]</cite> which performs adverse domain translations for autonomous driving in the context of depth estimation, we opted for the use of <a href="#id5.3.id3"><span href="#id5.3.id3" title="Generative Adversarial Network" class="ltx_glossaryref"><span class="ltx_text ltx_glossary_long-plural">Generative Adversarial Networks</span></span></a>. For the rain and night adverse conditions, we employed the ForkGAN model <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib52" title="" class="ltx_ref">52</a>]</cite> to translate clear-day training samples from the UAVid dataset <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib25" title="" class="ltx_ref">25</a>]</cite>. While for the fog samples, we
have used a combination of Omnidata <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib10" title="" class="ltx_ref">10</a>]</cite> and FoHIS <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib49" title="" class="ltx_ref">49</a>]</cite> methods. In the following, we will present an in-depth explanation of how we have performed the aforementioned conversion.</p>
</div>
<div id="S5.p4" class="ltx_para ltx_noindent">
<p id="S5.p4.2" class="ltx_p"><span id="S5.p4.2.1" class="ltx_text ltx_font_bold">Day2Night.</span> To convert daylight into nighttime, we trained ForkGAN over <math id="S5.p4.1.m1.1" class="ltx_Math" alttext="14K" display="inline"><semantics id="S5.p4.1.m1.1a"><mrow id="S5.p4.1.m1.1.1" xref="S5.p4.1.m1.1.1.cmml"><mn id="S5.p4.1.m1.1.1.2" xref="S5.p4.1.m1.1.1.2.cmml">14</mn><mo lspace="0em" rspace="0em" id="S5.p4.1.m1.1.1.1" xref="S5.p4.1.m1.1.1.1.cmml">​</mo><mi id="S5.p4.1.m1.1.1.3" xref="S5.p4.1.m1.1.1.3.cmml">K</mi></mrow><annotation-xml encoding="MathML-Content" id="S5.p4.1.m1.1b"><apply id="S5.p4.1.m1.1.1.cmml" xref="S5.p4.1.m1.1.1"><times id="S5.p4.1.m1.1.1.1.cmml" xref="S5.p4.1.m1.1.1.1"></times><cn type="integer" id="S5.p4.1.m1.1.1.2.cmml" xref="S5.p4.1.m1.1.1.2">14</cn><ci id="S5.p4.1.m1.1.1.3.cmml" xref="S5.p4.1.m1.1.1.3">𝐾</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.p4.1.m1.1c">14K</annotation></semantics></math> images, half of which represent daytime and the other half nighttime. All the used images were sampled from Visdrone <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib53" title="" class="ltx_ref">53</a>]</cite>, and UAVDT <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib9" title="" class="ltx_ref">9</a>]</cite>, two datasets designed for Object Detection. We have decided to sample the training data from different datasets to increase the overall number of nighttime images. This was necessary to ensure that the <a href="#id5.3.id3"><abbr href="#id5.3.id3" title="Generative Adversarial Network" class="ltx_glossaryref"><span class="ltx_text ltx_glossary_short">GAN</span></abbr></a> architecture reaches good enough reconstruction performance. The training phase lasted <math id="S5.p4.2.m2.1" class="ltx_Math" alttext="40" display="inline"><semantics id="S5.p4.2.m2.1a"><mn id="S5.p4.2.m2.1.1" xref="S5.p4.2.m2.1.1.cmml">40</mn><annotation-xml encoding="MathML-Content" id="S5.p4.2.m2.1b"><cn type="integer" id="S5.p4.2.m2.1.1.cmml" xref="S5.p4.2.m2.1.1">40</cn></annotation-xml><annotation encoding="application/x-tex" id="S5.p4.2.m2.1c">40</annotation></semantics></math> epochs. After the training, for all the nighttime samples in the UAVid dataset, we convert clear-day images into their nighttime counterparts using the pretrained model.</p>
</div>
<div id="S5.p5" class="ltx_para ltx_noindent">
<p id="S5.p5.2" class="ltx_p"><span id="S5.p5.2.1" class="ltx_text ltx_font_bold">Day2Rain.</span> Training the <a href="#id5.3.id3"><abbr href="#id5.3.id3" title="Generative Adversarial Network" class="ltx_glossaryref"><span class="ltx_text ltx_glossary_short">GAN</span></abbr></a> models directly on drone data proved advantageous as it helped to mitigate domain shifts. In the rain case however there are no available drone datasets - not even for other tasks as in the case of night images -,
therefore we had to train ForkGAN using diverse datasets that included adverse weather scenarios, like BDD100K <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib48" title="" class="ltx_ref">48</a>]</cite>, ACDC <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib34" title="" class="ltx_ref">34</a>]</cite> and RainCityscapes <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib16" title="" class="ltx_ref">16</a>]</cite> (which are datasets for automotive applications).
For daytime to rainy conversion, we followed the same strategy applied for the conversion to nighttime training the ForkGAN model over <math id="S5.p5.1.m1.1" class="ltx_Math" alttext="9K" display="inline"><semantics id="S5.p5.1.m1.1a"><mrow id="S5.p5.1.m1.1.1" xref="S5.p5.1.m1.1.1.cmml"><mn id="S5.p5.1.m1.1.1.2" xref="S5.p5.1.m1.1.1.2.cmml">9</mn><mo lspace="0em" rspace="0em" id="S5.p5.1.m1.1.1.1" xref="S5.p5.1.m1.1.1.1.cmml">​</mo><mi id="S5.p5.1.m1.1.1.3" xref="S5.p5.1.m1.1.1.3.cmml">K</mi></mrow><annotation-xml encoding="MathML-Content" id="S5.p5.1.m1.1b"><apply id="S5.p5.1.m1.1.1.cmml" xref="S5.p5.1.m1.1.1"><times id="S5.p5.1.m1.1.1.1.cmml" xref="S5.p5.1.m1.1.1.1"></times><cn type="integer" id="S5.p5.1.m1.1.1.2.cmml" xref="S5.p5.1.m1.1.1.2">9</cn><ci id="S5.p5.1.m1.1.1.3.cmml" xref="S5.p5.1.m1.1.1.3">𝐾</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.p5.1.m1.1c">9K</annotation></semantics></math> images for <math id="S5.p5.2.m2.1" class="ltx_Math" alttext="40" display="inline"><semantics id="S5.p5.2.m2.1a"><mn id="S5.p5.2.m2.1.1" xref="S5.p5.2.m2.1.1.cmml">40</mn><annotation-xml encoding="MathML-Content" id="S5.p5.2.m2.1b"><cn type="integer" id="S5.p5.2.m2.1.1.cmml" xref="S5.p5.2.m2.1.1">40</cn></annotation-xml><annotation encoding="application/x-tex" id="S5.p5.2.m2.1c">40</annotation></semantics></math> epochs and we applied the pretrained model to convert images into their rainy counterparts.</p>
</div>
<div id="S5.p6" class="ltx_para ltx_noindent">
<p id="S5.p6.1" class="ltx_p"><span id="S5.p6.1.1" class="ltx_text ltx_font_bold">Day2Fog.</span> To perform daytime to foggy conversion we first estimated a depth map for each image in the UAVid dataset using Omnidata <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib10" title="" class="ltx_ref">10</a>]</cite>, then, we exploited the estimated depth as input to the FoHIS method <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib49" title="" class="ltx_ref">49</a>]</cite> to apply fog.
<br class="ltx_break"></p>
</div>
<div id="S5.p7" class="ltx_para">
<p id="S5.p7.7" class="ltx_p"><span id="S5.p7.7.1" class="ltx_text ltx_font_bold">Federated Splits.</span> 
We consider two scenarios: the first is an unbalanced setup with <math id="S5.p7.1.m1.1" class="ltx_Math" alttext="40" display="inline"><semantics id="S5.p7.1.m1.1a"><mn id="S5.p7.1.m1.1.1" xref="S5.p7.1.m1.1.1.cmml">40</mn><annotation-xml encoding="MathML-Content" id="S5.p7.1.m1.1b"><cn type="integer" id="S5.p7.1.m1.1.1.cmml" xref="S5.p7.1.m1.1.1">40</cn></annotation-xml><annotation encoding="application/x-tex" id="S5.p7.1.m1.1c">40</annotation></semantics></math> clients, corresponding to <math id="S5.p7.2.m2.1" class="ltx_Math" alttext="32" display="inline"><semantics id="S5.p7.2.m2.1a"><mn id="S5.p7.2.m2.1.1" xref="S5.p7.2.m2.1.1.cmml">32</mn><annotation-xml encoding="MathML-Content" id="S5.p7.2.m2.1b"><cn type="integer" id="S5.p7.2.m2.1.1.cmml" xref="S5.p7.2.m2.1.1">32</cn></annotation-xml><annotation encoding="application/x-tex" id="S5.p7.2.m2.1c">32</annotation></semantics></math> automotive clients and <math id="S5.p7.3.m3.1" class="ltx_Math" alttext="8" display="inline"><semantics id="S5.p7.3.m3.1a"><mn id="S5.p7.3.m3.1.1" xref="S5.p7.3.m3.1.1.cmml">8</mn><annotation-xml encoding="MathML-Content" id="S5.p7.3.m3.1b"><cn type="integer" id="S5.p7.3.m3.1.1.cmml" xref="S5.p7.3.m3.1.1">8</cn></annotation-xml><annotation encoding="application/x-tex" id="S5.p7.3.m3.1c">8</annotation></semantics></math> drones; the second is more balanced having <math id="S5.p7.4.m4.1" class="ltx_Math" alttext="32" display="inline"><semantics id="S5.p7.4.m4.1a"><mn id="S5.p7.4.m4.1.1" xref="S5.p7.4.m4.1.1.cmml">32</mn><annotation-xml encoding="MathML-Content" id="S5.p7.4.m4.1b"><cn type="integer" id="S5.p7.4.m4.1.1.cmml" xref="S5.p7.4.m4.1.1">32</cn></annotation-xml><annotation encoding="application/x-tex" id="S5.p7.4.m4.1c">32</annotation></semantics></math> automotive clients and <math id="S5.p7.5.m5.1" class="ltx_Math" alttext="32" display="inline"><semantics id="S5.p7.5.m5.1a"><mn id="S5.p7.5.m5.1.1" xref="S5.p7.5.m5.1.1.cmml">32</mn><annotation-xml encoding="MathML-Content" id="S5.p7.5.m5.1b"><cn type="integer" id="S5.p7.5.m5.1.1.cmml" xref="S5.p7.5.m5.1.1">32</cn></annotation-xml><annotation encoding="application/x-tex" id="S5.p7.5.m5.1c">32</annotation></semantics></math> drones, however the training and test set of the drones come from two different domains. Aligned with previous works <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib37" title="" class="ltx_ref">37</a>]</cite>, the clients have a different number of samples associated with them, in particular, the number of samples in each client is in the range <math id="S5.p7.6.m6.2" class="ltx_Math" alttext="[69,72]" display="inline"><semantics id="S5.p7.6.m6.2a"><mrow id="S5.p7.6.m6.2.3.2" xref="S5.p7.6.m6.2.3.1.cmml"><mo stretchy="false" id="S5.p7.6.m6.2.3.2.1" xref="S5.p7.6.m6.2.3.1.cmml">[</mo><mn id="S5.p7.6.m6.1.1" xref="S5.p7.6.m6.1.1.cmml">69</mn><mo id="S5.p7.6.m6.2.3.2.2" xref="S5.p7.6.m6.2.3.1.cmml">,</mo><mn id="S5.p7.6.m6.2.2" xref="S5.p7.6.m6.2.2.cmml">72</mn><mo stretchy="false" id="S5.p7.6.m6.2.3.2.3" xref="S5.p7.6.m6.2.3.1.cmml">]</mo></mrow><annotation-xml encoding="MathML-Content" id="S5.p7.6.m6.2b"><interval closure="closed" id="S5.p7.6.m6.2.3.1.cmml" xref="S5.p7.6.m6.2.3.2"><cn type="integer" id="S5.p7.6.m6.1.1.cmml" xref="S5.p7.6.m6.1.1">69</cn><cn type="integer" id="S5.p7.6.m6.2.2.cmml" xref="S5.p7.6.m6.2.2">72</cn></interval></annotation-xml><annotation encoding="application/x-tex" id="S5.p7.6.m6.2c">[69,72]</annotation></semantics></math> for cars and <math id="S5.p7.7.m7.2" class="ltx_Math" alttext="[24,25]" display="inline"><semantics id="S5.p7.7.m7.2a"><mrow id="S5.p7.7.m7.2.3.2" xref="S5.p7.7.m7.2.3.1.cmml"><mo stretchy="false" id="S5.p7.7.m7.2.3.2.1" xref="S5.p7.7.m7.2.3.1.cmml">[</mo><mn id="S5.p7.7.m7.1.1" xref="S5.p7.7.m7.1.1.cmml">24</mn><mo id="S5.p7.7.m7.2.3.2.2" xref="S5.p7.7.m7.2.3.1.cmml">,</mo><mn id="S5.p7.7.m7.2.2" xref="S5.p7.7.m7.2.2.cmml">25</mn><mo stretchy="false" id="S5.p7.7.m7.2.3.2.3" xref="S5.p7.7.m7.2.3.1.cmml">]</mo></mrow><annotation-xml encoding="MathML-Content" id="S5.p7.7.m7.2b"><interval closure="closed" id="S5.p7.7.m7.2.3.1.cmml" xref="S5.p7.7.m7.2.3.2"><cn type="integer" id="S5.p7.7.m7.1.1.cmml" xref="S5.p7.7.m7.1.1">24</cn><cn type="integer" id="S5.p7.7.m7.2.2.cmml" xref="S5.p7.7.m7.2.2">25</cn></interval></annotation-xml><annotation encoding="application/x-tex" id="S5.p7.7.m7.2c">[24,25]</annotation></semantics></math> for drones.
To simulate real scenarios, we assumed that the most common weather would be clear daytime, while clients can have different combinations of adverse weather. Refer to the Suppl. Mat. for the weather distribution details on clients.</p>
</div>
</section>
<section id="S6" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">6 </span>Implementation Details</h2>

<div id="S6.p1" class="ltx_para ltx_noindent">
<p id="S6.p1.9" class="ltx_p"><span id="S6.p1.9.1" class="ltx_text ltx_font_bold">Datasets.</span>

In this study, we leveraged two synthetic driving datasets - one collected from cars and one from drones - each encompassing a range of challenging illumination and weather conditions: the driving dataset SELMA <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib42" title="" class="ltx_ref">42</a>]</cite> and the FLYAWARE-S dataset introduced in this work. Both datasets are based on the CARLA simulator <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib8" title="" class="ltx_ref">8</a>]</cite> for image generation, making them ideal choices for our research due to their shared framework.
Then, our method is adapted in a federated fashion to real-world datasets: for cars we selected the ACDC dataset, supplemented by Cityscapes <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib7" title="" class="ltx_ref">7</a>]</cite> for the clear samples as described in the Suppl. Mat. As the drone counterpart, we used our adverse-weather translated dataset FLYAWARE-R, which offers labeled frames captured from aerial views. Additionally, to enhance the robustness of our approach, we performed also tests using the VisDrone object detection dataset for clients’ training as training at client side is unsupervised.
In this setting the entire FLYAWARE-R dataset can be used for testing purposes (<em id="S6.p1.9.2" class="ltx_emph ltx_font_italic">i.e</em>.<span id="S6.p1.9.3" class="ltx_text"></span> XL) for more reliable results. The adverse translation of FLYAWARE-R is described in <a href="#S5" title="5 The FLYAWARE Adverse Dataset ‣ When Cars meet Drones: Hyperbolic Federated Learning for Source-Free Domain Adaptation in Adverse Weather" class="ltx_ref"><span class="ltx_text ltx_ref_tag">Sec.</span> <span class="ltx_text ltx_ref_tag">5</span></a>. All the extended datasets and splits are referenced in Fig. <a href="#S4.F4" title="Figure 4 ‣ 4.4 Server Aggregation (AG) ‣ 4 Training Procedure ‣ When Cars meet Drones: Hyperbolic Federated Learning for Source-Free Domain Adaptation in Adverse Weather" class="ltx_ref"><span class="ltx_text ltx_ref_tag">4</span></a> and will be available at the link: <span id="S6.p1.9.4" class="ltx_text" style="color:#0000FF;">[soon]</span> 
<br class="ltx_break"><span id="S6.p1.9.5" class="ltx_text ltx_font_bold">Server pretraining.</span>
We chose DeepLabV3 architecture with MobileNetV2 as in <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib37" title="" class="ltx_ref">37</a>]</cite>.
We trained our model on the source synthetic dataset using a decreasing power-law learning rate <math id="S6.p1.1.m1.1" class="ltx_Math" alttext="\eta" display="inline"><semantics id="S6.p1.1.m1.1a"><mi id="S6.p1.1.m1.1.1" xref="S6.p1.1.m1.1.1.cmml">η</mi><annotation-xml encoding="MathML-Content" id="S6.p1.1.m1.1b"><ci id="S6.p1.1.m1.1.1.cmml" xref="S6.p1.1.m1.1.1">𝜂</ci></annotation-xml><annotation encoding="application/x-tex" id="S6.p1.1.m1.1c">\eta</annotation></semantics></math>, starting at <math id="S6.p1.2.m2.1" class="ltx_Math" alttext="\eta=5e-3" display="inline"><semantics id="S6.p1.2.m2.1a"><mrow id="S6.p1.2.m2.1.1" xref="S6.p1.2.m2.1.1.cmml"><mi id="S6.p1.2.m2.1.1.2" xref="S6.p1.2.m2.1.1.2.cmml">η</mi><mo id="S6.p1.2.m2.1.1.1" xref="S6.p1.2.m2.1.1.1.cmml">=</mo><mrow id="S6.p1.2.m2.1.1.3" xref="S6.p1.2.m2.1.1.3.cmml"><mrow id="S6.p1.2.m2.1.1.3.2" xref="S6.p1.2.m2.1.1.3.2.cmml"><mn id="S6.p1.2.m2.1.1.3.2.2" xref="S6.p1.2.m2.1.1.3.2.2.cmml">5</mn><mo lspace="0em" rspace="0em" id="S6.p1.2.m2.1.1.3.2.1" xref="S6.p1.2.m2.1.1.3.2.1.cmml">​</mo><mi id="S6.p1.2.m2.1.1.3.2.3" xref="S6.p1.2.m2.1.1.3.2.3.cmml">e</mi></mrow><mo id="S6.p1.2.m2.1.1.3.1" xref="S6.p1.2.m2.1.1.3.1.cmml">−</mo><mn id="S6.p1.2.m2.1.1.3.3" xref="S6.p1.2.m2.1.1.3.3.cmml">3</mn></mrow></mrow><annotation-xml encoding="MathML-Content" id="S6.p1.2.m2.1b"><apply id="S6.p1.2.m2.1.1.cmml" xref="S6.p1.2.m2.1.1"><eq id="S6.p1.2.m2.1.1.1.cmml" xref="S6.p1.2.m2.1.1.1"></eq><ci id="S6.p1.2.m2.1.1.2.cmml" xref="S6.p1.2.m2.1.1.2">𝜂</ci><apply id="S6.p1.2.m2.1.1.3.cmml" xref="S6.p1.2.m2.1.1.3"><minus id="S6.p1.2.m2.1.1.3.1.cmml" xref="S6.p1.2.m2.1.1.3.1"></minus><apply id="S6.p1.2.m2.1.1.3.2.cmml" xref="S6.p1.2.m2.1.1.3.2"><times id="S6.p1.2.m2.1.1.3.2.1.cmml" xref="S6.p1.2.m2.1.1.3.2.1"></times><cn type="integer" id="S6.p1.2.m2.1.1.3.2.2.cmml" xref="S6.p1.2.m2.1.1.3.2.2">5</cn><ci id="S6.p1.2.m2.1.1.3.2.3.cmml" xref="S6.p1.2.m2.1.1.3.2.3">𝑒</ci></apply><cn type="integer" id="S6.p1.2.m2.1.1.3.3.cmml" xref="S6.p1.2.m2.1.1.3.3">3</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S6.p1.2.m2.1c">\eta=5e-3</annotation></semantics></math> with a power of 0.9. The optimization used SGD with momentum 0.9 and no weight decay, lasting for 5 epochs with batch size 16.
For the weather classifier, we trained a 3-layer ConvNet with batch size 88, 8 epochs and SGD optimizer with learning rate <math id="S6.p1.3.m3.1" class="ltx_Math" alttext="1e-4" display="inline"><semantics id="S6.p1.3.m3.1a"><mrow id="S6.p1.3.m3.1.1" xref="S6.p1.3.m3.1.1.cmml"><mrow id="S6.p1.3.m3.1.1.2" xref="S6.p1.3.m3.1.1.2.cmml"><mn id="S6.p1.3.m3.1.1.2.2" xref="S6.p1.3.m3.1.1.2.2.cmml">1</mn><mo lspace="0em" rspace="0em" id="S6.p1.3.m3.1.1.2.1" xref="S6.p1.3.m3.1.1.2.1.cmml">​</mo><mi id="S6.p1.3.m3.1.1.2.3" xref="S6.p1.3.m3.1.1.2.3.cmml">e</mi></mrow><mo id="S6.p1.3.m3.1.1.1" xref="S6.p1.3.m3.1.1.1.cmml">−</mo><mn id="S6.p1.3.m3.1.1.3" xref="S6.p1.3.m3.1.1.3.cmml">4</mn></mrow><annotation-xml encoding="MathML-Content" id="S6.p1.3.m3.1b"><apply id="S6.p1.3.m3.1.1.cmml" xref="S6.p1.3.m3.1.1"><minus id="S6.p1.3.m3.1.1.1.cmml" xref="S6.p1.3.m3.1.1.1"></minus><apply id="S6.p1.3.m3.1.1.2.cmml" xref="S6.p1.3.m3.1.1.2"><times id="S6.p1.3.m3.1.1.2.1.cmml" xref="S6.p1.3.m3.1.1.2.1"></times><cn type="integer" id="S6.p1.3.m3.1.1.2.2.cmml" xref="S6.p1.3.m3.1.1.2.2">1</cn><ci id="S6.p1.3.m3.1.1.2.3.cmml" xref="S6.p1.3.m3.1.1.2.3">𝑒</ci></apply><cn type="integer" id="S6.p1.3.m3.1.1.3.cmml" xref="S6.p1.3.m3.1.1.3">4</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S6.p1.3.m3.1c">1e-4</annotation></semantics></math>.
<br class="ltx_break"><span id="S6.p1.9.6" class="ltx_text ltx_font_bold">Clients Adaptation.</span>
For the target dataset, experiments were run with a fixed learning rate of <math id="S6.p1.4.m4.1" class="ltx_Math" alttext="\eta=1e-4" display="inline"><semantics id="S6.p1.4.m4.1a"><mrow id="S6.p1.4.m4.1.1" xref="S6.p1.4.m4.1.1.cmml"><mi id="S6.p1.4.m4.1.1.2" xref="S6.p1.4.m4.1.1.2.cmml">η</mi><mo id="S6.p1.4.m4.1.1.1" xref="S6.p1.4.m4.1.1.1.cmml">=</mo><mrow id="S6.p1.4.m4.1.1.3" xref="S6.p1.4.m4.1.1.3.cmml"><mrow id="S6.p1.4.m4.1.1.3.2" xref="S6.p1.4.m4.1.1.3.2.cmml"><mn id="S6.p1.4.m4.1.1.3.2.2" xref="S6.p1.4.m4.1.1.3.2.2.cmml">1</mn><mo lspace="0em" rspace="0em" id="S6.p1.4.m4.1.1.3.2.1" xref="S6.p1.4.m4.1.1.3.2.1.cmml">​</mo><mi id="S6.p1.4.m4.1.1.3.2.3" xref="S6.p1.4.m4.1.1.3.2.3.cmml">e</mi></mrow><mo id="S6.p1.4.m4.1.1.3.1" xref="S6.p1.4.m4.1.1.3.1.cmml">−</mo><mn id="S6.p1.4.m4.1.1.3.3" xref="S6.p1.4.m4.1.1.3.3.cmml">4</mn></mrow></mrow><annotation-xml encoding="MathML-Content" id="S6.p1.4.m4.1b"><apply id="S6.p1.4.m4.1.1.cmml" xref="S6.p1.4.m4.1.1"><eq id="S6.p1.4.m4.1.1.1.cmml" xref="S6.p1.4.m4.1.1.1"></eq><ci id="S6.p1.4.m4.1.1.2.cmml" xref="S6.p1.4.m4.1.1.2">𝜂</ci><apply id="S6.p1.4.m4.1.1.3.cmml" xref="S6.p1.4.m4.1.1.3"><minus id="S6.p1.4.m4.1.1.3.1.cmml" xref="S6.p1.4.m4.1.1.3.1"></minus><apply id="S6.p1.4.m4.1.1.3.2.cmml" xref="S6.p1.4.m4.1.1.3.2"><times id="S6.p1.4.m4.1.1.3.2.1.cmml" xref="S6.p1.4.m4.1.1.3.2.1"></times><cn type="integer" id="S6.p1.4.m4.1.1.3.2.2.cmml" xref="S6.p1.4.m4.1.1.3.2.2">1</cn><ci id="S6.p1.4.m4.1.1.3.2.3.cmml" xref="S6.p1.4.m4.1.1.3.2.3">𝑒</ci></apply><cn type="integer" id="S6.p1.4.m4.1.1.3.3.cmml" xref="S6.p1.4.m4.1.1.3.3">4</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S6.p1.4.m4.1c">\eta=1e-4</annotation></semantics></math> with SGD optimizer. The training involved 5 clients per round for a total of <math id="S6.p1.5.m5.1" class="ltx_Math" alttext="R=100" display="inline"><semantics id="S6.p1.5.m5.1a"><mrow id="S6.p1.5.m5.1.1" xref="S6.p1.5.m5.1.1.cmml"><mi id="S6.p1.5.m5.1.1.2" xref="S6.p1.5.m5.1.1.2.cmml">R</mi><mo id="S6.p1.5.m5.1.1.1" xref="S6.p1.5.m5.1.1.1.cmml">=</mo><mn id="S6.p1.5.m5.1.1.3" xref="S6.p1.5.m5.1.1.3.cmml">100</mn></mrow><annotation-xml encoding="MathML-Content" id="S6.p1.5.m5.1b"><apply id="S6.p1.5.m5.1.1.cmml" xref="S6.p1.5.m5.1.1"><eq id="S6.p1.5.m5.1.1.1.cmml" xref="S6.p1.5.m5.1.1.1"></eq><ci id="S6.p1.5.m5.1.1.2.cmml" xref="S6.p1.5.m5.1.1.2">𝑅</ci><cn type="integer" id="S6.p1.5.m5.1.1.3.cmml" xref="S6.p1.5.m5.1.1.3">100</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S6.p1.5.m5.1c">R=100</annotation></semantics></math> rounds, with <math id="S6.p1.6.m6.1" class="ltx_Math" alttext="\lambda_{cl}=140" display="inline"><semantics id="S6.p1.6.m6.1a"><mrow id="S6.p1.6.m6.1.1" xref="S6.p1.6.m6.1.1.cmml"><msub id="S6.p1.6.m6.1.1.2" xref="S6.p1.6.m6.1.1.2.cmml"><mi id="S6.p1.6.m6.1.1.2.2" xref="S6.p1.6.m6.1.1.2.2.cmml">λ</mi><mrow id="S6.p1.6.m6.1.1.2.3" xref="S6.p1.6.m6.1.1.2.3.cmml"><mi id="S6.p1.6.m6.1.1.2.3.2" xref="S6.p1.6.m6.1.1.2.3.2.cmml">c</mi><mo lspace="0em" rspace="0em" id="S6.p1.6.m6.1.1.2.3.1" xref="S6.p1.6.m6.1.1.2.3.1.cmml">​</mo><mi id="S6.p1.6.m6.1.1.2.3.3" xref="S6.p1.6.m6.1.1.2.3.3.cmml">l</mi></mrow></msub><mo id="S6.p1.6.m6.1.1.1" xref="S6.p1.6.m6.1.1.1.cmml">=</mo><mn id="S6.p1.6.m6.1.1.3" xref="S6.p1.6.m6.1.1.3.cmml">140</mn></mrow><annotation-xml encoding="MathML-Content" id="S6.p1.6.m6.1b"><apply id="S6.p1.6.m6.1.1.cmml" xref="S6.p1.6.m6.1.1"><eq id="S6.p1.6.m6.1.1.1.cmml" xref="S6.p1.6.m6.1.1.1"></eq><apply id="S6.p1.6.m6.1.1.2.cmml" xref="S6.p1.6.m6.1.1.2"><csymbol cd="ambiguous" id="S6.p1.6.m6.1.1.2.1.cmml" xref="S6.p1.6.m6.1.1.2">subscript</csymbol><ci id="S6.p1.6.m6.1.1.2.2.cmml" xref="S6.p1.6.m6.1.1.2.2">𝜆</ci><apply id="S6.p1.6.m6.1.1.2.3.cmml" xref="S6.p1.6.m6.1.1.2.3"><times id="S6.p1.6.m6.1.1.2.3.1.cmml" xref="S6.p1.6.m6.1.1.2.3.1"></times><ci id="S6.p1.6.m6.1.1.2.3.2.cmml" xref="S6.p1.6.m6.1.1.2.3.2">𝑐</ci><ci id="S6.p1.6.m6.1.1.2.3.3.cmml" xref="S6.p1.6.m6.1.1.2.3.3">𝑙</ci></apply></apply><cn type="integer" id="S6.p1.6.m6.1.1.3.cmml" xref="S6.p1.6.m6.1.1.3">140</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S6.p1.6.m6.1c">\lambda_{cl}=140</annotation></semantics></math>. The pseudo-label teacher model was updated at the end of each round.
For the optimizer of the manifolds, we use RiemmanianAdam as in <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib40" title="" class="ltx_ref">40</a>]</cite> with <math id="S6.p1.7.m7.1" class="ltx_Math" alttext="\gamma=0.1" display="inline"><semantics id="S6.p1.7.m7.1a"><mrow id="S6.p1.7.m7.1.1" xref="S6.p1.7.m7.1.1.cmml"><mi id="S6.p1.7.m7.1.1.2" xref="S6.p1.7.m7.1.1.2.cmml">γ</mi><mo id="S6.p1.7.m7.1.1.1" xref="S6.p1.7.m7.1.1.1.cmml">=</mo><mn id="S6.p1.7.m7.1.1.3" xref="S6.p1.7.m7.1.1.3.cmml">0.1</mn></mrow><annotation-xml encoding="MathML-Content" id="S6.p1.7.m7.1b"><apply id="S6.p1.7.m7.1.1.cmml" xref="S6.p1.7.m7.1.1"><eq id="S6.p1.7.m7.1.1.1.cmml" xref="S6.p1.7.m7.1.1.1"></eq><ci id="S6.p1.7.m7.1.1.2.cmml" xref="S6.p1.7.m7.1.1.2">𝛾</ci><cn type="float" id="S6.p1.7.m7.1.1.3.cmml" xref="S6.p1.7.m7.1.1.3">0.1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S6.p1.7.m7.1c">\gamma=0.1</annotation></semantics></math> as initialization, learning rate equal to <math id="S6.p1.8.m8.1" class="ltx_Math" alttext="1e-3" display="inline"><semantics id="S6.p1.8.m8.1a"><mrow id="S6.p1.8.m8.1.1" xref="S6.p1.8.m8.1.1.cmml"><mrow id="S6.p1.8.m8.1.1.2" xref="S6.p1.8.m8.1.1.2.cmml"><mn id="S6.p1.8.m8.1.1.2.2" xref="S6.p1.8.m8.1.1.2.2.cmml">1</mn><mo lspace="0em" rspace="0em" id="S6.p1.8.m8.1.1.2.1" xref="S6.p1.8.m8.1.1.2.1.cmml">​</mo><mi id="S6.p1.8.m8.1.1.2.3" xref="S6.p1.8.m8.1.1.2.3.cmml">e</mi></mrow><mo id="S6.p1.8.m8.1.1.1" xref="S6.p1.8.m8.1.1.1.cmml">−</mo><mn id="S6.p1.8.m8.1.1.3" xref="S6.p1.8.m8.1.1.3.cmml">3</mn></mrow><annotation-xml encoding="MathML-Content" id="S6.p1.8.m8.1b"><apply id="S6.p1.8.m8.1.1.cmml" xref="S6.p1.8.m8.1.1"><minus id="S6.p1.8.m8.1.1.1.cmml" xref="S6.p1.8.m8.1.1.1"></minus><apply id="S6.p1.8.m8.1.1.2.cmml" xref="S6.p1.8.m8.1.1.2"><times id="S6.p1.8.m8.1.1.2.1.cmml" xref="S6.p1.8.m8.1.1.2.1"></times><cn type="integer" id="S6.p1.8.m8.1.1.2.2.cmml" xref="S6.p1.8.m8.1.1.2.2">1</cn><ci id="S6.p1.8.m8.1.1.2.3.cmml" xref="S6.p1.8.m8.1.1.2.3">𝑒</ci></apply><cn type="integer" id="S6.p1.8.m8.1.1.3.cmml" xref="S6.p1.8.m8.1.1.3">3</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S6.p1.8.m8.1c">1e-3</annotation></semantics></math> and weight decay of <math id="S6.p1.9.m9.1" class="ltx_Math" alttext="4e-4" display="inline"><semantics id="S6.p1.9.m9.1a"><mrow id="S6.p1.9.m9.1.1" xref="S6.p1.9.m9.1.1.cmml"><mrow id="S6.p1.9.m9.1.1.2" xref="S6.p1.9.m9.1.1.2.cmml"><mn id="S6.p1.9.m9.1.1.2.2" xref="S6.p1.9.m9.1.1.2.2.cmml">4</mn><mo lspace="0em" rspace="0em" id="S6.p1.9.m9.1.1.2.1" xref="S6.p1.9.m9.1.1.2.1.cmml">​</mo><mi id="S6.p1.9.m9.1.1.2.3" xref="S6.p1.9.m9.1.1.2.3.cmml">e</mi></mrow><mo id="S6.p1.9.m9.1.1.1" xref="S6.p1.9.m9.1.1.1.cmml">−</mo><mn id="S6.p1.9.m9.1.1.3" xref="S6.p1.9.m9.1.1.3.cmml">4</mn></mrow><annotation-xml encoding="MathML-Content" id="S6.p1.9.m9.1b"><apply id="S6.p1.9.m9.1.1.cmml" xref="S6.p1.9.m9.1.1"><minus id="S6.p1.9.m9.1.1.1.cmml" xref="S6.p1.9.m9.1.1.1"></minus><apply id="S6.p1.9.m9.1.1.2.cmml" xref="S6.p1.9.m9.1.1.2"><times id="S6.p1.9.m9.1.1.2.1.cmml" xref="S6.p1.9.m9.1.1.2.1"></times><cn type="integer" id="S6.p1.9.m9.1.1.2.2.cmml" xref="S6.p1.9.m9.1.1.2.2">4</cn><ci id="S6.p1.9.m9.1.1.2.3.cmml" xref="S6.p1.9.m9.1.1.2.3">𝑒</ci></apply><cn type="integer" id="S6.p1.9.m9.1.1.3.cmml" xref="S6.p1.9.m9.1.1.3">4</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S6.p1.9.m9.1c">4e-4</annotation></semantics></math>.
<br class="ltx_break"></p>
</div>
<figure id="S6.T2" class="ltx_table">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_table"><span id="S6.T2.2.1.1" class="ltx_text" style="font-size:90%;">Table 2</span>: </span><span id="S6.T2.3.2" class="ltx_text" style="font-size:90%;">mIoU on the target datasets (ACDC and FLYAWARE-R (FA-R)).</span></figcaption>
<div id="S6.T2.4" class="ltx_inline-block ltx_align_center ltx_transformed_outer" style="width:346.9pt;height:138.7pt;vertical-align:-0.0pt;"><span class="ltx_transformed_inner" style="transform:translate(-74.2pt,29.7pt) scale(0.700329925094149,0.700329925094149) ;">
<table id="S6.T2.4.1" class="ltx_tabular ltx_align_middle">
<tr id="S6.T2.4.1.1" class="ltx_tr">
<td id="S6.T2.4.1.1.1" class="ltx_td ltx_align_left ltx_border_tt"><span id="S6.T2.4.1.1.1.1" class="ltx_text ltx_font_bold">Setting</span></td>
<td id="S6.T2.4.1.1.2" class="ltx_td ltx_align_left ltx_border_tt"><span id="S6.T2.4.1.1.2.1" class="ltx_text ltx_font_bold">Train</span></td>
<td id="S6.T2.4.1.1.3" class="ltx_td ltx_align_left ltx_border_tt"><span id="S6.T2.4.1.1.3.1" class="ltx_text ltx_font_bold">Test</span></td>
<td id="S6.T2.4.1.1.4" class="ltx_td ltx_align_left ltx_border_tt"><span id="S6.T2.4.1.1.4.1" class="ltx_text ltx_font_bold">Method</span></td>
<td id="S6.T2.4.1.1.5" class="ltx_td ltx_align_center ltx_border_tt"><span id="S6.T2.4.1.1.5.1" class="ltx_text ltx_font_bold">Car</span></td>
<td id="S6.T2.4.1.1.6" class="ltx_td ltx_align_center ltx_border_tt"><span id="S6.T2.4.1.1.6.1" class="ltx_text ltx_font_bold">Drone</span></td>
<td id="S6.T2.4.1.1.7" class="ltx_td ltx_align_center ltx_border_tt"><span id="S6.T2.4.1.1.7.1" class="ltx_text ltx_font_bold">All</span></td>
</tr>
<tr id="S6.T2.4.1.2" class="ltx_tr">
<td id="S6.T2.4.1.2.1" class="ltx_td ltx_align_left ltx_border_t">centralized</td>
<td id="S6.T2.4.1.2.2" class="ltx_td ltx_align_left ltx_border_t">FA-S+SELMA</td>
<td id="S6.T2.4.1.2.3" class="ltx_td ltx_align_left ltx_border_t">ACDC+FA-R</td>
<td id="S6.T2.4.1.2.4" class="ltx_td ltx_align_left ltx_border_t">Source Only</td>
<td id="S6.T2.4.1.2.5" class="ltx_td ltx_align_center ltx_border_t">19.96</td>
<td id="S6.T2.4.1.2.6" class="ltx_td ltx_align_center ltx_border_t">33.11</td>
<td id="S6.T2.4.1.2.7" class="ltx_td ltx_align_center ltx_border_t">22.70</td>
</tr>
<tr id="S6.T2.4.1.3" class="ltx_tr">
<td id="S6.T2.4.1.3.1" class="ltx_td ltx_align_left">centralized</td>
<td id="S6.T2.4.1.3.2" class="ltx_td ltx_align_left">ACDC+FA-R</td>
<td id="S6.T2.4.1.3.3" class="ltx_td ltx_align_left">ACDC+FA-R</td>
<td id="S6.T2.4.1.3.4" class="ltx_td ltx_align_left">Target Only</td>
<td id="S6.T2.4.1.3.5" class="ltx_td ltx_align_center">60.17</td>
<td id="S6.T2.4.1.3.6" class="ltx_td ltx_align_center">50.14</td>
<td id="S6.T2.4.1.3.7" class="ltx_td ltx_align_center">58.08</td>
</tr>
<tr id="S6.T2.4.1.4" class="ltx_tr">
<td id="S6.T2.4.1.4.1" class="ltx_td ltx_align_left">federated</td>
<td id="S6.T2.4.1.4.2" class="ltx_td ltx_align_left">ACDC+FA-R</td>
<td id="S6.T2.4.1.4.3" class="ltx_td ltx_align_left">ACDC+FA-R</td>
<td id="S6.T2.4.1.4.4" class="ltx_td ltx_align_left">Fine-Tuning</td>
<td id="S6.T2.4.1.4.5" class="ltx_td ltx_align_center">34.35</td>
<td id="S6.T2.4.1.4.6" class="ltx_td ltx_align_center">39.10</td>
<td id="S6.T2.4.1.4.7" class="ltx_td ltx_align_center">35.34</td>
</tr>
<tr id="S6.T2.4.1.5" class="ltx_tr">
<td id="S6.T2.4.1.5.1" class="ltx_td ltx_align_left ltx_border_t"><span id="S6.T2.4.1.5.1.1" class="ltx_text ltx_font_smallcaps">FFreeDA</span></td>
<td id="S6.T2.4.1.5.2" class="ltx_td ltx_align_left ltx_border_t">ACDC+FA-R</td>
<td id="S6.T2.4.1.5.3" class="ltx_td ltx_align_left ltx_border_t">ACDC+FA-R</td>
<td id="S6.T2.4.1.5.4" class="ltx_td ltx_align_left ltx_border_t">FedAvg <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib27" title="" class="ltx_ref">27</a>]</cite>+ST</td>
<td id="S6.T2.4.1.5.5" class="ltx_td ltx_align_center ltx_border_t">25.00</td>
<td id="S6.T2.4.1.5.6" class="ltx_td ltx_align_center ltx_border_t">30.25</td>
<td id="S6.T2.4.1.5.7" class="ltx_td ltx_align_center ltx_border_t">26.10</td>
</tr>
<tr id="S6.T2.4.1.6" class="ltx_tr">
<td id="S6.T2.4.1.6.1" class="ltx_td ltx_align_left"><span id="S6.T2.4.1.6.1.1" class="ltx_text ltx_font_smallcaps">FFreeDA</span></td>
<td id="S6.T2.4.1.6.2" class="ltx_td ltx_align_left">ACDC+FA-R</td>
<td id="S6.T2.4.1.6.3" class="ltx_td ltx_align_left">ACDC+FA-R</td>
<td id="S6.T2.4.1.6.4" class="ltx_td ltx_align_left">LADD <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib37" title="" class="ltx_ref">37</a>]</cite>
</td>
<td id="S6.T2.4.1.6.5" class="ltx_td ltx_align_center">25.95</td>
<td id="S6.T2.4.1.6.6" class="ltx_td ltx_align_center">30.79</td>
<td id="S6.T2.4.1.6.7" class="ltx_td ltx_align_center">26.96</td>
</tr>
<tr id="S6.T2.4.1.7" class="ltx_tr">
<td id="S6.T2.4.1.7.1" class="ltx_td ltx_align_left"><span id="S6.T2.4.1.7.1.1" class="ltx_text ltx_font_smallcaps">FFreeDA</span></td>
<td id="S6.T2.4.1.7.2" class="ltx_td ltx_align_left">ACDC+FA-R</td>
<td id="S6.T2.4.1.7.3" class="ltx_td ltx_align_left">ACDC+FA-R</td>
<td id="S6.T2.4.1.7.4" class="ltx_td ltx_align_left"><span id="S6.T2.4.1.7.4.1" class="ltx_text ltx_font_bold">HyperFLAW</span></td>
<td id="S6.T2.4.1.7.5" class="ltx_td ltx_align_center"><span id="S6.T2.4.1.7.5.1" class="ltx_text ltx_font_bold">27.45</span></td>
<td id="S6.T2.4.1.7.6" class="ltx_td ltx_align_center"><span id="S6.T2.4.1.7.6.1" class="ltx_text ltx_font_bold">34.69</span></td>
<td id="S6.T2.4.1.7.7" class="ltx_td ltx_align_center"><span id="S6.T2.4.1.7.7.1" class="ltx_text ltx_font_bold">28.96</span></td>
</tr>
<tr id="S6.T2.4.1.8" class="ltx_tr">
<td id="S6.T2.4.1.8.1" class="ltx_td ltx_align_left ltx_border_tt">centralized</td>
<td id="S6.T2.4.1.8.2" class="ltx_td ltx_align_left ltx_border_tt">FA-S+SELMA</td>
<td id="S6.T2.4.1.8.3" class="ltx_td ltx_align_left ltx_border_tt">ACDC+FA-R-XL</td>
<td id="S6.T2.4.1.8.4" class="ltx_td ltx_align_left ltx_border_tt">Source Only</td>
<td id="S6.T2.4.1.8.5" class="ltx_td ltx_align_center ltx_border_tt">19.96</td>
<td id="S6.T2.4.1.8.6" class="ltx_td ltx_align_center ltx_border_tt">32.61</td>
<td id="S6.T2.4.1.8.7" class="ltx_td ltx_align_center ltx_border_tt">22.61</td>
</tr>
<tr id="S6.T2.4.1.9" class="ltx_tr">
<td id="S6.T2.4.1.9.1" class="ltx_td ltx_align_left ltx_border_t"><span id="S6.T2.4.1.9.1.1" class="ltx_text ltx_font_smallcaps">FFreeDA</span></td>
<td id="S6.T2.4.1.9.2" class="ltx_td ltx_align_left ltx_border_t">ACDC+VisDrone</td>
<td id="S6.T2.4.1.9.3" class="ltx_td ltx_align_left ltx_border_t">ACDC+FA-R-XL</td>
<td id="S6.T2.4.1.9.4" class="ltx_td ltx_align_left ltx_border_t">FedAvg <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib27" title="" class="ltx_ref">27</a>]</cite>+ST</td>
<td id="S6.T2.4.1.9.5" class="ltx_td ltx_align_center ltx_border_t">22.76</td>
<td id="S6.T2.4.1.9.6" class="ltx_td ltx_align_center ltx_border_t">31.55</td>
<td id="S6.T2.4.1.9.7" class="ltx_td ltx_align_center ltx_border_t">24.59</td>
</tr>
<tr id="S6.T2.4.1.10" class="ltx_tr">
<td id="S6.T2.4.1.10.1" class="ltx_td ltx_align_left"><span id="S6.T2.4.1.10.1.1" class="ltx_text ltx_font_smallcaps">FFreeDA</span></td>
<td id="S6.T2.4.1.10.2" class="ltx_td ltx_align_left">ACDC+VisDrone</td>
<td id="S6.T2.4.1.10.3" class="ltx_td ltx_align_left">ACDC+FA-R-XL</td>
<td id="S6.T2.4.1.10.4" class="ltx_td ltx_align_left">LADD <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib37" title="" class="ltx_ref">37</a>]</cite>
</td>
<td id="S6.T2.4.1.10.5" class="ltx_td ltx_align_center">26.32</td>
<td id="S6.T2.4.1.10.6" class="ltx_td ltx_align_center">28.93</td>
<td id="S6.T2.4.1.10.7" class="ltx_td ltx_align_center">26.86</td>
</tr>
<tr id="S6.T2.4.1.11" class="ltx_tr">
<td id="S6.T2.4.1.11.1" class="ltx_td ltx_align_left ltx_border_bb"><span id="S6.T2.4.1.11.1.1" class="ltx_text ltx_font_smallcaps">FFreeDA</span></td>
<td id="S6.T2.4.1.11.2" class="ltx_td ltx_align_left ltx_border_bb">ACDC+VisDrone</td>
<td id="S6.T2.4.1.11.3" class="ltx_td ltx_align_left ltx_border_bb">ACDC+FA-R-XL</td>
<td id="S6.T2.4.1.11.4" class="ltx_td ltx_align_left ltx_border_bb"><span id="S6.T2.4.1.11.4.1" class="ltx_text ltx_font_bold">HyperFLAW</span></td>
<td id="S6.T2.4.1.11.5" class="ltx_td ltx_align_center ltx_border_bb"><span id="S6.T2.4.1.11.5.1" class="ltx_text ltx_font_bold">27.10</span></td>
<td id="S6.T2.4.1.11.6" class="ltx_td ltx_align_center ltx_border_bb"><span id="S6.T2.4.1.11.6.1" class="ltx_text ltx_font_bold">35.45</span></td>
<td id="S6.T2.4.1.11.7" class="ltx_td ltx_align_center ltx_border_bb"><span id="S6.T2.4.1.11.7.1" class="ltx_text ltx_font_bold">28.84</span></td>
</tr>
</table>
</span></div>
</figure>
</section>
<section id="S7" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">7 </span>Experimental Results</h2>

<div id="S7.p1" class="ltx_para">
<p id="S7.p1.3" class="ltx_p">The results are detailed in Tab. <a href="#S6.T2" title="Table 2 ‣ 6 Implementation Details ‣ When Cars meet Drones: Hyperbolic Federated Learning for Source-Free Domain Adaptation in Adverse Weather" class="ltx_ref"><span class="ltx_text ltx_ref_tag">2</span></a>, which reports the average mIoU for cars, drones and a combined score. The latter is computed using the average for the classes present in both datasets and the car mIoU otherwise. For comparison, we initially examined 3 supervised settings: 1) the source only approach, which relies exclusively on synthetic labeled data from the source domains for training; 2) the fully centralized approach, where all available data is used to train the network specifically on the target domain (<math id="S7.p1.1.m1.1" class="ltx_Math" alttext="250" display="inline"><semantics id="S7.p1.1.m1.1a"><mn id="S7.p1.1.m1.1.1" xref="S7.p1.1.m1.1.1.cmml">250</mn><annotation-xml encoding="MathML-Content" id="S7.p1.1.m1.1b"><cn type="integer" id="S7.p1.1.m1.1.1.cmml" xref="S7.p1.1.m1.1.1">250</cn></annotation-xml><annotation encoding="application/x-tex" id="S7.p1.1.m1.1c">250</annotation></semantics></math> epochs, <math id="S7.p1.2.m2.1" class="ltx_Math" alttext="lr=5e-3" display="inline"><semantics id="S7.p1.2.m2.1a"><mrow id="S7.p1.2.m2.1.1" xref="S7.p1.2.m2.1.1.cmml"><mrow id="S7.p1.2.m2.1.1.2" xref="S7.p1.2.m2.1.1.2.cmml"><mi id="S7.p1.2.m2.1.1.2.2" xref="S7.p1.2.m2.1.1.2.2.cmml">l</mi><mo lspace="0em" rspace="0em" id="S7.p1.2.m2.1.1.2.1" xref="S7.p1.2.m2.1.1.2.1.cmml">​</mo><mi id="S7.p1.2.m2.1.1.2.3" xref="S7.p1.2.m2.1.1.2.3.cmml">r</mi></mrow><mo id="S7.p1.2.m2.1.1.1" xref="S7.p1.2.m2.1.1.1.cmml">=</mo><mrow id="S7.p1.2.m2.1.1.3" xref="S7.p1.2.m2.1.1.3.cmml"><mrow id="S7.p1.2.m2.1.1.3.2" xref="S7.p1.2.m2.1.1.3.2.cmml"><mn id="S7.p1.2.m2.1.1.3.2.2" xref="S7.p1.2.m2.1.1.3.2.2.cmml">5</mn><mo lspace="0em" rspace="0em" id="S7.p1.2.m2.1.1.3.2.1" xref="S7.p1.2.m2.1.1.3.2.1.cmml">​</mo><mi id="S7.p1.2.m2.1.1.3.2.3" xref="S7.p1.2.m2.1.1.3.2.3.cmml">e</mi></mrow><mo id="S7.p1.2.m2.1.1.3.1" xref="S7.p1.2.m2.1.1.3.1.cmml">−</mo><mn id="S7.p1.2.m2.1.1.3.3" xref="S7.p1.2.m2.1.1.3.3.cmml">3</mn></mrow></mrow><annotation-xml encoding="MathML-Content" id="S7.p1.2.m2.1b"><apply id="S7.p1.2.m2.1.1.cmml" xref="S7.p1.2.m2.1.1"><eq id="S7.p1.2.m2.1.1.1.cmml" xref="S7.p1.2.m2.1.1.1"></eq><apply id="S7.p1.2.m2.1.1.2.cmml" xref="S7.p1.2.m2.1.1.2"><times id="S7.p1.2.m2.1.1.2.1.cmml" xref="S7.p1.2.m2.1.1.2.1"></times><ci id="S7.p1.2.m2.1.1.2.2.cmml" xref="S7.p1.2.m2.1.1.2.2">𝑙</ci><ci id="S7.p1.2.m2.1.1.2.3.cmml" xref="S7.p1.2.m2.1.1.2.3">𝑟</ci></apply><apply id="S7.p1.2.m2.1.1.3.cmml" xref="S7.p1.2.m2.1.1.3"><minus id="S7.p1.2.m2.1.1.3.1.cmml" xref="S7.p1.2.m2.1.1.3.1"></minus><apply id="S7.p1.2.m2.1.1.3.2.cmml" xref="S7.p1.2.m2.1.1.3.2"><times id="S7.p1.2.m2.1.1.3.2.1.cmml" xref="S7.p1.2.m2.1.1.3.2.1"></times><cn type="integer" id="S7.p1.2.m2.1.1.3.2.2.cmml" xref="S7.p1.2.m2.1.1.3.2.2">5</cn><ci id="S7.p1.2.m2.1.1.3.2.3.cmml" xref="S7.p1.2.m2.1.1.3.2.3">𝑒</ci></apply><cn type="integer" id="S7.p1.2.m2.1.1.3.3.cmml" xref="S7.p1.2.m2.1.1.3.3">3</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S7.p1.2.m2.1c">lr=5e-3</annotation></semantics></math>); 3) the upper limit scenario for the federated model, where it undergoes fine-tuning with full supervision on the clients (<math id="S7.p1.3.m3.1" class="ltx_Math" alttext="R=250" display="inline"><semantics id="S7.p1.3.m3.1a"><mrow id="S7.p1.3.m3.1.1" xref="S7.p1.3.m3.1.1.cmml"><mi id="S7.p1.3.m3.1.1.2" xref="S7.p1.3.m3.1.1.2.cmml">R</mi><mo id="S7.p1.3.m3.1.1.1" xref="S7.p1.3.m3.1.1.1.cmml">=</mo><mn id="S7.p1.3.m3.1.1.3" xref="S7.p1.3.m3.1.1.3.cmml">250</mn></mrow><annotation-xml encoding="MathML-Content" id="S7.p1.3.m3.1b"><apply id="S7.p1.3.m3.1.1.cmml" xref="S7.p1.3.m3.1.1"><eq id="S7.p1.3.m3.1.1.1.cmml" xref="S7.p1.3.m3.1.1.1"></eq><ci id="S7.p1.3.m3.1.1.2.cmml" xref="S7.p1.3.m3.1.1.2">𝑅</ci><cn type="integer" id="S7.p1.3.m3.1.1.3.cmml" xref="S7.p1.3.m3.1.1.3">250</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S7.p1.3.m3.1c">R=250</annotation></semantics></math>).
In the unsupervised setting, (i.e., in the context of <span id="S7.p1.3.1" class="ltx_text ltx_font_smallcaps">FFreeDA</span>), we explore two strategies: the standard FedAvg <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib27" title="" class="ltx_ref">27</a>]</cite> combined with our self-training approach, and the main competitor, LADD <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib37" title="" class="ltx_ref">37</a>]</cite>.</p>
</div>
<figure id="S7.tab1" class="ltx_table">

<figcaption class="ltx_caption"><span id="S7.tab1.1.1" class="ltx_text ltx_font_bold">Table <a href="#S7" title="7 Experimental Results ‣ When Cars meet Drones: Hyperbolic Federated Learning for Source-Free Domain Adaptation in Adverse Weather" class="ltx_ref"><span class="ltx_text ltx_ref_tag">7</span></a> and <a href="#S7" title="7 Experimental Results ‣ When Cars meet Drones: Hyperbolic Federated Learning for Source-Free Domain Adaptation in Adverse Weather" class="ltx_ref"><span class="ltx_text ltx_ref_tag">7</span></a>: </span> Motivation of our approach: viewpoints generalization (<a href="#S7" title="7 Experimental Results ‣ When Cars meet Drones: Hyperbolic Federated Learning for Source-Free Domain Adaptation in Adverse Weather" class="ltx_ref"><span class="ltx_text ltx_ref_tag">Sec.</span> <span class="ltx_text ltx_ref_tag">7</span></a>); generalization to different weather conditions (<a href="#S7" title="7 Experimental Results ‣ When Cars meet Drones: Hyperbolic Federated Learning for Source-Free Domain Adaptation in Adverse Weather" class="ltx_ref"><span class="ltx_text ltx_ref_tag">Sec.</span> <span class="ltx_text ltx_ref_tag">7</span></a>).</figcaption><div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_2">
<div id="S7.tab1.2" class="ltx_block ltx_figure_panel ltx_minipage ltx_align_center ltx_align_bottom" style="width:151.8pt;">
<span id="S7.tab1.2.1" class="ltx_ERROR undefined">\captionlistentry</span>
<div id="S7.tab1.2.2" class="ltx_inline-block ltx_align_center ltx_transformed_outer" style="width:433.6pt;height:177.9pt;vertical-align:-0.0pt;"><span class="ltx_transformed_inner" style="transform:translate(107.1pt,-43.9pt) scale(1.97648723470729,1.97648723470729) ;">
<table id="S7.tab1.2.2.1" class="ltx_tabular ltx_align_middle">
<tr id="S7.tab1.2.2.1.1" class="ltx_tr">
<td id="S7.tab1.2.2.1.1.1" class="ltx_td ltx_align_center ltx_border_tt" rowspan="2"><span id="S7.tab1.2.2.1.1.1.1" class="ltx_text">
<span id="S7.tab1.2.2.1.1.1.1.1" class="ltx_tabular ltx_align_middle">
<span id="S7.tab1.2.2.1.1.1.1.1.1" class="ltx_tr">
<span id="S7.tab1.2.2.1.1.1.1.1.1.1" class="ltx_td ltx_nopad_r ltx_align_center"><span id="S7.tab1.2.2.1.1.1.1.1.1.1.1" class="ltx_text ltx_font_bold">Pretrain</span></span></span>
<span id="S7.tab1.2.2.1.1.1.1.1.2" class="ltx_tr">
<span id="S7.tab1.2.2.1.1.1.1.1.2.1" class="ltx_td ltx_nopad_r ltx_align_center">on</span></span>
</span></span></td>
<td id="S7.tab1.2.2.1.1.2" class="ltx_td ltx_align_center ltx_border_tt" rowspan="2"><span id="S7.tab1.2.2.1.1.2.1" class="ltx_text">
<span id="S7.tab1.2.2.1.1.2.1.1" class="ltx_tabular ltx_align_middle">
<span id="S7.tab1.2.2.1.1.2.1.1.1" class="ltx_tr">
<span id="S7.tab1.2.2.1.1.2.1.1.1.1" class="ltx_td ltx_nopad_r ltx_align_center">Source</span></span>
<span id="S7.tab1.2.2.1.1.2.1.1.2" class="ltx_tr">
<span id="S7.tab1.2.2.1.1.2.1.1.2.1" class="ltx_td ltx_nopad_r ltx_align_center">Only</span></span>
</span></span></td>
<td id="S7.tab1.2.2.1.1.3" class="ltx_td ltx_align_center ltx_border_tt" colspan="2"><span id="S7.tab1.2.2.1.1.3.1" class="ltx_text ltx_font_bold">Adapted</span></td>
</tr>
<tr id="S7.tab1.2.2.1.2" class="ltx_tr">
<td id="S7.tab1.2.2.1.2.1" class="ltx_td ltx_align_center ltx_border_t">Separately</td>
<td id="S7.tab1.2.2.1.2.2" class="ltx_td ltx_align_center ltx_border_t">Jointly</td>
</tr>
<tr id="S7.tab1.2.2.1.3" class="ltx_tr">
<td id="S7.tab1.2.2.1.3.1" class="ltx_td ltx_align_center ltx_border_t">Car+Drone</td>
<td id="S7.tab1.2.2.1.3.2" class="ltx_td ltx_align_center ltx_border_t">22.70</td>
<td id="S7.tab1.2.2.1.3.3" class="ltx_td ltx_align_center ltx_border_t">28.95</td>
<td id="S7.tab1.2.2.1.3.4" class="ltx_td ltx_align_center ltx_border_t">28.96</td>
</tr>
<tr id="S7.tab1.2.2.1.4" class="ltx_tr">
<td id="S7.tab1.2.2.1.4.1" class="ltx_td ltx_align_center">Car only</td>
<td id="S7.tab1.2.2.1.4.2" class="ltx_td ltx_align_center">18.23</td>
<td id="S7.tab1.2.2.1.4.3" class="ltx_td ltx_align_center">25.17</td>
<td id="S7.tab1.2.2.1.4.4" class="ltx_td ltx_align_center">25.24</td>
</tr>
<tr id="S7.tab1.2.2.1.5" class="ltx_tr">
<td id="S7.tab1.2.2.1.5.1" class="ltx_td ltx_align_center ltx_border_bb">Drone only</td>
<td id="S7.tab1.2.2.1.5.2" class="ltx_td ltx_align_center ltx_border_bb">15.25</td>
<td id="S7.tab1.2.2.1.5.3" class="ltx_td ltx_align_center ltx_border_bb">14.37</td>
<td id="S7.tab1.2.2.1.5.4" class="ltx_td ltx_align_center ltx_border_bb">13.68</td>
</tr>
</table>
</span></div>
</div>
</div>
<div class="ltx_flex_cell ltx_flex_size_2">
<div id="S7.tab1.3" class="ltx_block ltx_figure_panel ltx_minipage ltx_align_center ltx_align_bottom" style="width:277.5pt;">
<span id="S7.tab1.3.1" class="ltx_ERROR undefined">\captionlistentry</span>
<div id="S7.tab1.3.2" class="ltx_inline-block ltx_align_center ltx_transformed_outer" style="width:303.5pt;height:143.1pt;vertical-align:-0.0pt;"><span class="ltx_transformed_inner" style="transform:translate(18.1pt,-8.5pt) scale(1.13564307304731,1.13564307304731) ;">
<table id="S7.tab1.3.2.1" class="ltx_tabular ltx_align_middle">
<tr id="S7.tab1.3.2.1.1" class="ltx_tr">
<td id="S7.tab1.3.2.1.1.1" class="ltx_td ltx_align_center ltx_border_tt"><span id="S7.tab1.3.2.1.1.1.1" class="ltx_text ltx_font_bold">Pretrain</span></td>
<td id="S7.tab1.3.2.1.1.2" class="ltx_td ltx_align_center ltx_border_tt"><span id="S7.tab1.3.2.1.1.2.1" class="ltx_text ltx_font_bold">Adapt</span></td>
<td id="S7.tab1.3.2.1.1.3" class="ltx_td ltx_align_center ltx_border_tt"><span id="S7.tab1.3.2.1.1.3.1" class="ltx_text ltx_font_bold">Clear</span></td>
<td id="S7.tab1.3.2.1.1.4" class="ltx_td ltx_align_center ltx_border_tt"><span id="S7.tab1.3.2.1.1.4.1" class="ltx_text ltx_font_bold">Night</span></td>
<td id="S7.tab1.3.2.1.1.5" class="ltx_td ltx_align_center ltx_border_tt"><span id="S7.tab1.3.2.1.1.5.1" class="ltx_text ltx_font_bold">Rain</span></td>
<td id="S7.tab1.3.2.1.1.6" class="ltx_td ltx_align_center ltx_border_tt"><span id="S7.tab1.3.2.1.1.6.1" class="ltx_text ltx_font_bold">Fog</span></td>
<td id="S7.tab1.3.2.1.1.7" class="ltx_td ltx_align_center ltx_border_tt"><span id="S7.tab1.3.2.1.1.7.1" class="ltx_text ltx_font_bold">All</span></td>
</tr>
<tr id="S7.tab1.3.2.1.2" class="ltx_tr">
<td id="S7.tab1.3.2.1.2.1" class="ltx_td ltx_align_center ltx_border_t">Clear</td>
<td id="S7.tab1.3.2.1.2.2" class="ltx_td ltx_align_center ltx_border_t">-</td>
<td id="S7.tab1.3.2.1.2.3" class="ltx_td ltx_align_center ltx_border_t">23.43</td>
<td id="S7.tab1.3.2.1.2.4" class="ltx_td ltx_align_center ltx_border_t">6.43</td>
<td id="S7.tab1.3.2.1.2.5" class="ltx_td ltx_align_center ltx_border_t">24.93</td>
<td id="S7.tab1.3.2.1.2.6" class="ltx_td ltx_align_center ltx_border_t">25.50</td>
<td id="S7.tab1.3.2.1.2.7" class="ltx_td ltx_align_center ltx_border_t">18.28</td>
</tr>
<tr id="S7.tab1.3.2.1.3" class="ltx_tr">
<td id="S7.tab1.3.2.1.3.1" class="ltx_td ltx_align_center">All</td>
<td id="S7.tab1.3.2.1.3.2" class="ltx_td ltx_align_center">-</td>
<td id="S7.tab1.3.2.1.3.3" class="ltx_td ltx_align_center">25.41</td>
<td id="S7.tab1.3.2.1.3.4" class="ltx_td ltx_align_center">13.62</td>
<td id="S7.tab1.3.2.1.3.5" class="ltx_td ltx_align_center">26.72</td>
<td id="S7.tab1.3.2.1.3.6" class="ltx_td ltx_align_center">26.08</td>
<td id="S7.tab1.3.2.1.3.7" class="ltx_td ltx_align_center">22.69</td>
</tr>
<tr id="S7.tab1.3.2.1.4" class="ltx_tr">
<td id="S7.tab1.3.2.1.4.1" class="ltx_td ltx_align_center ltx_border_t">Clear</td>
<td id="S7.tab1.3.2.1.4.2" class="ltx_td ltx_align_center ltx_border_t">Clear</td>
<td id="S7.tab1.3.2.1.4.3" class="ltx_td ltx_align_center ltx_border_t">26.87</td>
<td id="S7.tab1.3.2.1.4.4" class="ltx_td ltx_align_center ltx_border_t">1.02</td>
<td id="S7.tab1.3.2.1.4.5" class="ltx_td ltx_align_center ltx_border_t">8.02</td>
<td id="S7.tab1.3.2.1.4.6" class="ltx_td ltx_align_center ltx_border_t">9.86</td>
<td id="S7.tab1.3.2.1.4.7" class="ltx_td ltx_align_center ltx_border_t">14.36</td>
</tr>
<tr id="S7.tab1.3.2.1.5" class="ltx_tr">
<td id="S7.tab1.3.2.1.5.1" class="ltx_td ltx_align_center">Clear</td>
<td id="S7.tab1.3.2.1.5.2" class="ltx_td ltx_align_center">All</td>
<td id="S7.tab1.3.2.1.5.3" class="ltx_td ltx_align_center">25.97</td>
<td id="S7.tab1.3.2.1.5.4" class="ltx_td ltx_align_center">7.87</td>
<td id="S7.tab1.3.2.1.5.5" class="ltx_td ltx_align_center">25.70</td>
<td id="S7.tab1.3.2.1.5.6" class="ltx_td ltx_align_center">23.16</td>
<td id="S7.tab1.3.2.1.5.7" class="ltx_td ltx_align_center">18.11</td>
</tr>
<tr id="S7.tab1.3.2.1.6" class="ltx_tr">
<td id="S7.tab1.3.2.1.6.1" class="ltx_td ltx_align_center">All</td>
<td id="S7.tab1.3.2.1.6.2" class="ltx_td ltx_align_center">Clear</td>
<td id="S7.tab1.3.2.1.6.3" class="ltx_td ltx_align_center">30.96</td>
<td id="S7.tab1.3.2.1.6.4" class="ltx_td ltx_align_center">10.85</td>
<td id="S7.tab1.3.2.1.6.5" class="ltx_td ltx_align_center">22.22</td>
<td id="S7.tab1.3.2.1.6.6" class="ltx_td ltx_align_center">26.38</td>
<td id="S7.tab1.3.2.1.6.7" class="ltx_td ltx_align_center">25.03</td>
</tr>
<tr id="S7.tab1.3.2.1.7" class="ltx_tr">
<td id="S7.tab1.3.2.1.7.1" class="ltx_td ltx_align_center ltx_border_bb">All</td>
<td id="S7.tab1.3.2.1.7.2" class="ltx_td ltx_align_center ltx_border_bb">All</td>
<td id="S7.tab1.3.2.1.7.3" class="ltx_td ltx_align_center ltx_border_bb"><span id="S7.tab1.3.2.1.7.3.1" class="ltx_text ltx_font_bold">31.73</span></td>
<td id="S7.tab1.3.2.1.7.4" class="ltx_td ltx_align_center ltx_border_bb"><span id="S7.tab1.3.2.1.7.4.1" class="ltx_text ltx_font_bold">14.18</span></td>
<td id="S7.tab1.3.2.1.7.5" class="ltx_td ltx_align_center ltx_border_bb"><span id="S7.tab1.3.2.1.7.5.1" class="ltx_text ltx_font_bold">34.19</span></td>
<td id="S7.tab1.3.2.1.7.6" class="ltx_td ltx_align_center ltx_border_bb"><span id="S7.tab1.3.2.1.7.6.1" class="ltx_text ltx_font_bold">29.86</span></td>
<td id="S7.tab1.3.2.1.7.7" class="ltx_td ltx_align_center ltx_border_bb"><span id="S7.tab1.3.2.1.7.7.1" class="ltx_text ltx_font_bold">28.96</span></td>
</tr>
</table>
</span></div>
</div>
</div>
</div>
</figure>
<div id="S7.p2" class="ltx_para">
<p id="S7.p2.1" class="ltx_p">Notably, unlike our strategy, LADD conducts dataset stylization from the target domain, assuming prior knowledge of the client data distribution during pretraining. We pretrain LADD on our synthetic adverse weather dataset to ensure comparability, maintaining the target’s average style as outlined in <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib37" title="" class="ltx_ref">37</a>]</cite>.</p>
</div>
<div id="S7.p3" class="ltx_para">
<p id="S7.p3.7" class="ltx_p">The large domain shift between the source and target domains is clear from the mIoU of <math id="S7.p3.1.m1.1" class="ltx_Math" alttext="22.70\%" display="inline"><semantics id="S7.p3.1.m1.1a"><mrow id="S7.p3.1.m1.1.1" xref="S7.p3.1.m1.1.1.cmml"><mn id="S7.p3.1.m1.1.1.2" xref="S7.p3.1.m1.1.1.2.cmml">22.70</mn><mo id="S7.p3.1.m1.1.1.1" xref="S7.p3.1.m1.1.1.1.cmml">%</mo></mrow><annotation-xml encoding="MathML-Content" id="S7.p3.1.m1.1b"><apply id="S7.p3.1.m1.1.1.cmml" xref="S7.p3.1.m1.1.1"><csymbol cd="latexml" id="S7.p3.1.m1.1.1.1.cmml" xref="S7.p3.1.m1.1.1.1">percent</csymbol><cn type="float" id="S7.p3.1.m1.1.1.2.cmml" xref="S7.p3.1.m1.1.1.2">22.70</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S7.p3.1.m1.1c">22.70\%</annotation></semantics></math> achieved by the source only training compared to <math id="S7.p3.2.m2.1" class="ltx_Math" alttext="58.08\%" display="inline"><semantics id="S7.p3.2.m2.1a"><mrow id="S7.p3.2.m2.1.1" xref="S7.p3.2.m2.1.1.cmml"><mn id="S7.p3.2.m2.1.1.2" xref="S7.p3.2.m2.1.1.2.cmml">58.08</mn><mo id="S7.p3.2.m2.1.1.1" xref="S7.p3.2.m2.1.1.1.cmml">%</mo></mrow><annotation-xml encoding="MathML-Content" id="S7.p3.2.m2.1b"><apply id="S7.p3.2.m2.1.1.cmml" xref="S7.p3.2.m2.1.1"><csymbol cd="latexml" id="S7.p3.2.m2.1.1.1.cmml" xref="S7.p3.2.m2.1.1.1">percent</csymbol><cn type="float" id="S7.p3.2.m2.1.1.2.cmml" xref="S7.p3.2.m2.1.1.2">58.08</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S7.p3.2.m2.1c">58.08\%</annotation></semantics></math> of the target training.
Although the performance increases by almost <math id="S7.p3.3.m3.1" class="ltx_Math" alttext="13\%" display="inline"><semantics id="S7.p3.3.m3.1a"><mrow id="S7.p3.3.m3.1.1" xref="S7.p3.3.m3.1.1.cmml"><mn id="S7.p3.3.m3.1.1.2" xref="S7.p3.3.m3.1.1.2.cmml">13</mn><mo id="S7.p3.3.m3.1.1.1" xref="S7.p3.3.m3.1.1.1.cmml">%</mo></mrow><annotation-xml encoding="MathML-Content" id="S7.p3.3.m3.1b"><apply id="S7.p3.3.m3.1.1.cmml" xref="S7.p3.3.m3.1.1"><csymbol cd="latexml" id="S7.p3.3.m3.1.1.1.cmml" xref="S7.p3.3.m3.1.1.1">percent</csymbol><cn type="integer" id="S7.p3.3.m3.1.1.2.cmml" xref="S7.p3.3.m3.1.1.2">13</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S7.p3.3.m3.1c">13\%</annotation></semantics></math> by fine-tuning the source only pretraining, assuming labeled data on the client side is not very realistic. In the unsupervised scenario, the baseline approach of using self-teaching with pseudo-labels together with FedAvg leads to a score of <math id="S7.p3.4.m4.1" class="ltx_Math" alttext="26.10\%" display="inline"><semantics id="S7.p3.4.m4.1a"><mrow id="S7.p3.4.m4.1.1" xref="S7.p3.4.m4.1.1.cmml"><mn id="S7.p3.4.m4.1.1.2" xref="S7.p3.4.m4.1.1.2.cmml">26.10</mn><mo id="S7.p3.4.m4.1.1.1" xref="S7.p3.4.m4.1.1.1.cmml">%</mo></mrow><annotation-xml encoding="MathML-Content" id="S7.p3.4.m4.1b"><apply id="S7.p3.4.m4.1.1.cmml" xref="S7.p3.4.m4.1.1"><csymbol cd="latexml" id="S7.p3.4.m4.1.1.1.cmml" xref="S7.p3.4.m4.1.1.1">percent</csymbol><cn type="float" id="S7.p3.4.m4.1.1.2.cmml" xref="S7.p3.4.m4.1.1.2">26.10</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S7.p3.4.m4.1c">26.10\%</annotation></semantics></math>, with a relatively small improvement from the source only proving that simple FL strategies struggle in this challenging setting.
LADD <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib37" title="" class="ltx_ref">37</a>]</cite> allows to improve performances to <math id="S7.p3.5.m5.1" class="ltx_Math" alttext="26.96\%" display="inline"><semantics id="S7.p3.5.m5.1a"><mrow id="S7.p3.5.m5.1.1" xref="S7.p3.5.m5.1.1.cmml"><mn id="S7.p3.5.m5.1.1.2" xref="S7.p3.5.m5.1.1.2.cmml">26.96</mn><mo id="S7.p3.5.m5.1.1.1" xref="S7.p3.5.m5.1.1.1.cmml">%</mo></mrow><annotation-xml encoding="MathML-Content" id="S7.p3.5.m5.1b"><apply id="S7.p3.5.m5.1.1.cmml" xref="S7.p3.5.m5.1.1"><csymbol cd="latexml" id="S7.p3.5.m5.1.1.1.cmml" xref="S7.p3.5.m5.1.1.1">percent</csymbol><cn type="float" id="S7.p3.5.m5.1.1.2.cmml" xref="S7.p3.5.m5.1.1.2">26.96</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S7.p3.5.m5.1c">26.96\%</annotation></semantics></math>, an improvement of around <math id="S7.p3.6.m6.1" class="ltx_Math" alttext="1\%" display="inline"><semantics id="S7.p3.6.m6.1a"><mrow id="S7.p3.6.m6.1.1" xref="S7.p3.6.m6.1.1.cmml"><mn id="S7.p3.6.m6.1.1.2" xref="S7.p3.6.m6.1.1.2.cmml">1</mn><mo id="S7.p3.6.m6.1.1.1" xref="S7.p3.6.m6.1.1.1.cmml">%</mo></mrow><annotation-xml encoding="MathML-Content" id="S7.p3.6.m6.1b"><apply id="S7.p3.6.m6.1.1.cmml" xref="S7.p3.6.m6.1.1"><csymbol cd="latexml" id="S7.p3.6.m6.1.1.1.cmml" xref="S7.p3.6.m6.1.1.1">percent</csymbol><cn type="integer" id="S7.p3.6.m6.1.1.2.cmml" xref="S7.p3.6.m6.1.1.2">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S7.p3.6.m6.1c">1\%</annotation></semantics></math> compared to FedAvg. Our approach, in comparison to FedAvg and LADD, demonstrates a better improvement over the source only baseline reaching a mIoU of <math id="S7.p3.7.m7.1" class="ltx_Math" alttext="28.96\%" display="inline"><semantics id="S7.p3.7.m7.1a"><mrow id="S7.p3.7.m7.1.1" xref="S7.p3.7.m7.1.1.cmml"><mn id="S7.p3.7.m7.1.1.2" xref="S7.p3.7.m7.1.1.2.cmml">28.96</mn><mo id="S7.p3.7.m7.1.1.1" xref="S7.p3.7.m7.1.1.1.cmml">%</mo></mrow><annotation-xml encoding="MathML-Content" id="S7.p3.7.m7.1b"><apply id="S7.p3.7.m7.1.1.cmml" xref="S7.p3.7.m7.1.1"><csymbol cd="latexml" id="S7.p3.7.m7.1.1.1.cmml" xref="S7.p3.7.m7.1.1.1">percent</csymbol><cn type="float" id="S7.p3.7.m7.1.1.2.cmml" xref="S7.p3.7.m7.1.1.2">28.96</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S7.p3.7.m7.1c">28.96\%</annotation></semantics></math>. In particular notice how the gain is also well-distributed across car and drone agents, meaning that our strategy can effectively align with the intrinsic distribution shift that different viewpoints introduce. Notably, our approach is the only able to improve the source only results on both cars and drones, while competitors struggle with drone imagery since they are not able to generalize well to both and trade-off the better performances on cars with a reduction of the accuracy on drones.
Qualitative results are reported in the Suppl. Mat.</p>
</div>
<div id="S7.p4" class="ltx_para ltx_noindent">
<p id="S7.p4.2" class="ltx_p"><span id="S7.p4.2.1" class="ltx_text ltx_font_bold">Generalization capabilities of the proposed approach.</span> We perform further tests to evaluate the capability of our approach to adapt to different viewpoints and weather conditions.
Specifically, in <a href="#S7" title="7 Experimental Results ‣ When Cars meet Drones: Hyperbolic Federated Learning for Source-Free Domain Adaptation in Adverse Weather" class="ltx_ref"><span class="ltx_text ltx_ref_tag">Sec.</span> <span class="ltx_text ltx_ref_tag">7</span></a> we can underline the following: 1) Jointly pretraining on both car and drones improves the overall mIoU of <math id="S7.p4.1.m1.1" class="ltx_Math" alttext="4.47\%" display="inline"><semantics id="S7.p4.1.m1.1a"><mrow id="S7.p4.1.m1.1.1" xref="S7.p4.1.m1.1.1.cmml"><mn id="S7.p4.1.m1.1.1.2" xref="S7.p4.1.m1.1.1.2.cmml">4.47</mn><mo id="S7.p4.1.m1.1.1.1" xref="S7.p4.1.m1.1.1.1.cmml">%</mo></mrow><annotation-xml encoding="MathML-Content" id="S7.p4.1.m1.1b"><apply id="S7.p4.1.m1.1.1.cmml" xref="S7.p4.1.m1.1.1"><csymbol cd="latexml" id="S7.p4.1.m1.1.1.1.cmml" xref="S7.p4.1.m1.1.1.1">percent</csymbol><cn type="float" id="S7.p4.1.m1.1.1.2.cmml" xref="S7.p4.1.m1.1.1.2">4.47</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S7.p4.1.m1.1c">4.47\%</annotation></semantics></math> compared to car-only and <math id="S7.p4.2.m2.1" class="ltx_Math" alttext="7.45\%" display="inline"><semantics id="S7.p4.2.m2.1a"><mrow id="S7.p4.2.m2.1.1" xref="S7.p4.2.m2.1.1.cmml"><mn id="S7.p4.2.m2.1.1.2" xref="S7.p4.2.m2.1.1.2.cmml">7.45</mn><mo id="S7.p4.2.m2.1.1.1" xref="S7.p4.2.m2.1.1.1.cmml">%</mo></mrow><annotation-xml encoding="MathML-Content" id="S7.p4.2.m2.1b"><apply id="S7.p4.2.m2.1.1.cmml" xref="S7.p4.2.m2.1.1"><csymbol cd="latexml" id="S7.p4.2.m2.1.1.1.cmml" xref="S7.p4.2.m2.1.1.1">percent</csymbol><cn type="float" id="S7.p4.2.m2.1.1.2.cmml" xref="S7.p4.2.m2.1.1.2">7.45</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S7.p4.2.m2.1c">7.45\%</annotation></semantics></math> to drone-only; 2) Adapting to car and drones together leads to roughly the same performances of adapting separately two models (one for cars and one for drones), i.e., the model generalize well across the two agents even when only one viewpoint is provided; 3) In the drone-only setting, the limited number of clients results in poor generalization and overconfidence in predictions. In <a href="#S7" title="7 Experimental Results ‣ When Cars meet Drones: Hyperbolic Federated Learning for Source-Free Domain Adaptation in Adverse Weather" class="ltx_ref"><span class="ltx_text ltx_ref_tag">Sec.</span> <span class="ltx_text ltx_ref_tag">7</span></a>, we underline that: 1) When pretraining with synthetic data from all weather conditions the model improves on all, especially the night; moreover, adapting from clear weather only results in poor generalization when adapting to real data; 2) Although adapting with only clear weather data increases the mIoU on clear weather itself, it worsens the performance on almost all the other conditions.</p>
</div>
<figure id="S7.F5" class="ltx_figure">
<div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_2">
<figure id="S7.F5.2" class="ltx_figure ltx_figure_panel ltx_minipage ltx_align_center ltx_align_bottom" style="width:212.5pt;">
<div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_1">
<figure id="S7.T3" class="ltx_table ltx_figure_panel">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_table"><span id="S7.T3.2.1.1" class="ltx_text" style="font-size:90%;">Table 3</span>: </span><span id="S7.T3.3.2" class="ltx_text" style="font-size:90%;">Ablation of the proposed method components.</span></figcaption>
</figure>
</div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_1">
<div id="S7.F5.2.2" class="ltx_inline-block ltx_figure_panel ltx_align_center ltx_transformed_outer" style="width:433.6pt;height:228.5pt;vertical-align:-0.0pt;"><span class="ltx_transformed_inner" style="transform:translate(97.3pt,-51.2pt) scale(1.81343015946958,1.81343015946958) ;">
<table id="S7.F5.2.2.2" class="ltx_tabular ltx_align_middle">
<tr id="S7.F5.2.2.2.2" class="ltx_tr">
<td id="S7.F5.1.1.1.1.1" class="ltx_td ltx_align_center ltx_border_tt"><math id="S7.F5.1.1.1.1.1.m1.1" class="ltx_Math" alttext="\mathcal{L}_{st}" display="inline"><semantics id="S7.F5.1.1.1.1.1.m1.1a"><msub id="S7.F5.1.1.1.1.1.m1.1.1" xref="S7.F5.1.1.1.1.1.m1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S7.F5.1.1.1.1.1.m1.1.1.2" xref="S7.F5.1.1.1.1.1.m1.1.1.2.cmml">ℒ</mi><mrow id="S7.F5.1.1.1.1.1.m1.1.1.3" xref="S7.F5.1.1.1.1.1.m1.1.1.3.cmml"><mi id="S7.F5.1.1.1.1.1.m1.1.1.3.2" xref="S7.F5.1.1.1.1.1.m1.1.1.3.2.cmml">s</mi><mo lspace="0em" rspace="0em" id="S7.F5.1.1.1.1.1.m1.1.1.3.1" xref="S7.F5.1.1.1.1.1.m1.1.1.3.1.cmml">​</mo><mi id="S7.F5.1.1.1.1.1.m1.1.1.3.3" xref="S7.F5.1.1.1.1.1.m1.1.1.3.3.cmml">t</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S7.F5.1.1.1.1.1.m1.1b"><apply id="S7.F5.1.1.1.1.1.m1.1.1.cmml" xref="S7.F5.1.1.1.1.1.m1.1.1"><csymbol cd="ambiguous" id="S7.F5.1.1.1.1.1.m1.1.1.1.cmml" xref="S7.F5.1.1.1.1.1.m1.1.1">subscript</csymbol><ci id="S7.F5.1.1.1.1.1.m1.1.1.2.cmml" xref="S7.F5.1.1.1.1.1.m1.1.1.2">ℒ</ci><apply id="S7.F5.1.1.1.1.1.m1.1.1.3.cmml" xref="S7.F5.1.1.1.1.1.m1.1.1.3"><times id="S7.F5.1.1.1.1.1.m1.1.1.3.1.cmml" xref="S7.F5.1.1.1.1.1.m1.1.1.3.1"></times><ci id="S7.F5.1.1.1.1.1.m1.1.1.3.2.cmml" xref="S7.F5.1.1.1.1.1.m1.1.1.3.2">𝑠</ci><ci id="S7.F5.1.1.1.1.1.m1.1.1.3.3.cmml" xref="S7.F5.1.1.1.1.1.m1.1.1.3.3">𝑡</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S7.F5.1.1.1.1.1.m1.1c">\mathcal{L}_{st}</annotation></semantics></math></td>
<td id="S7.F5.2.2.2.2.3" class="ltx_td ltx_align_center ltx_border_tt"><span id="S7.F5.2.2.2.2.3.1" class="ltx_text ltx_font_bold">AG</span></td>
<td id="S7.F5.2.2.2.2.4" class="ltx_td ltx_border_tt"></td>
<td id="S7.F5.2.2.2.2.2" class="ltx_td ltx_align_center ltx_border_tt"><math id="S7.F5.2.2.2.2.2.m1.1" class="ltx_Math" alttext="\mathcal{L}_{cl}" display="inline"><semantics id="S7.F5.2.2.2.2.2.m1.1a"><msub id="S7.F5.2.2.2.2.2.m1.1.1" xref="S7.F5.2.2.2.2.2.m1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S7.F5.2.2.2.2.2.m1.1.1.2" xref="S7.F5.2.2.2.2.2.m1.1.1.2.cmml">ℒ</mi><mrow id="S7.F5.2.2.2.2.2.m1.1.1.3" xref="S7.F5.2.2.2.2.2.m1.1.1.3.cmml"><mi id="S7.F5.2.2.2.2.2.m1.1.1.3.2" xref="S7.F5.2.2.2.2.2.m1.1.1.3.2.cmml">c</mi><mo lspace="0em" rspace="0em" id="S7.F5.2.2.2.2.2.m1.1.1.3.1" xref="S7.F5.2.2.2.2.2.m1.1.1.3.1.cmml">​</mo><mi id="S7.F5.2.2.2.2.2.m1.1.1.3.3" xref="S7.F5.2.2.2.2.2.m1.1.1.3.3.cmml">l</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S7.F5.2.2.2.2.2.m1.1b"><apply id="S7.F5.2.2.2.2.2.m1.1.1.cmml" xref="S7.F5.2.2.2.2.2.m1.1.1"><csymbol cd="ambiguous" id="S7.F5.2.2.2.2.2.m1.1.1.1.cmml" xref="S7.F5.2.2.2.2.2.m1.1.1">subscript</csymbol><ci id="S7.F5.2.2.2.2.2.m1.1.1.2.cmml" xref="S7.F5.2.2.2.2.2.m1.1.1.2">ℒ</ci><apply id="S7.F5.2.2.2.2.2.m1.1.1.3.cmml" xref="S7.F5.2.2.2.2.2.m1.1.1.3"><times id="S7.F5.2.2.2.2.2.m1.1.1.3.1.cmml" xref="S7.F5.2.2.2.2.2.m1.1.1.3.1"></times><ci id="S7.F5.2.2.2.2.2.m1.1.1.3.2.cmml" xref="S7.F5.2.2.2.2.2.m1.1.1.3.2">𝑐</ci><ci id="S7.F5.2.2.2.2.2.m1.1.1.3.3.cmml" xref="S7.F5.2.2.2.2.2.m1.1.1.3.3">𝑙</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S7.F5.2.2.2.2.2.m1.1c">\mathcal{L}_{cl}</annotation></semantics></math></td>
<td id="S7.F5.2.2.2.2.5" class="ltx_td ltx_align_center ltx_border_tt"><span id="S7.F5.2.2.2.2.5.1" class="ltx_text ltx_font_bold">BN</span></td>
<td id="S7.F5.2.2.2.2.6" class="ltx_td ltx_align_center ltx_border_tt"><span id="S7.F5.2.2.2.2.6.1" class="ltx_text ltx_font_bold">Car</span></td>
<td id="S7.F5.2.2.2.2.7" class="ltx_td ltx_align_center ltx_border_tt"><span id="S7.F5.2.2.2.2.7.1" class="ltx_text ltx_font_bold">Drone</span></td>
<td id="S7.F5.2.2.2.2.8" class="ltx_td ltx_align_center ltx_border_tt"><span id="S7.F5.2.2.2.2.8.1" class="ltx_text ltx_font_bold">All</span></td>
</tr>
<tr id="S7.F5.2.2.2.3" class="ltx_tr">
<td id="S7.F5.2.2.2.3.1" class="ltx_td ltx_border_t"></td>
<td id="S7.F5.2.2.2.3.2" class="ltx_td ltx_border_t"></td>
<td id="S7.F5.2.2.2.3.3" class="ltx_td ltx_border_t"></td>
<td id="S7.F5.2.2.2.3.4" class="ltx_td ltx_border_t"></td>
<td id="S7.F5.2.2.2.3.5" class="ltx_td ltx_border_t"></td>
<td id="S7.F5.2.2.2.3.6" class="ltx_td ltx_align_center ltx_border_t">19.96</td>
<td id="S7.F5.2.2.2.3.7" class="ltx_td ltx_align_center ltx_border_t">33.11</td>
<td id="S7.F5.2.2.2.3.8" class="ltx_td ltx_align_center ltx_border_t">22.70</td>
</tr>
<tr id="S7.F5.2.2.2.4" class="ltx_tr">
<td id="S7.F5.2.2.2.4.1" class="ltx_td ltx_align_center">✓</td>
<td id="S7.F5.2.2.2.4.2" class="ltx_td"></td>
<td id="S7.F5.2.2.2.4.3" class="ltx_td"></td>
<td id="S7.F5.2.2.2.4.4" class="ltx_td"></td>
<td id="S7.F5.2.2.2.4.5" class="ltx_td"></td>
<td id="S7.F5.2.2.2.4.6" class="ltx_td ltx_align_center">25.00</td>
<td id="S7.F5.2.2.2.4.7" class="ltx_td ltx_align_center">30.25</td>
<td id="S7.F5.2.2.2.4.8" class="ltx_td ltx_align_center">26.10</td>
</tr>
<tr id="S7.F5.2.2.2.5" class="ltx_tr">
<td id="S7.F5.2.2.2.5.1" class="ltx_td ltx_align_center">✓</td>
<td id="S7.F5.2.2.2.5.2" class="ltx_td ltx_align_center">✓</td>
<td id="S7.F5.2.2.2.5.3" class="ltx_td"></td>
<td id="S7.F5.2.2.2.5.4" class="ltx_td"></td>
<td id="S7.F5.2.2.2.5.5" class="ltx_td"></td>
<td id="S7.F5.2.2.2.5.6" class="ltx_td ltx_align_center">24.75</td>
<td id="S7.F5.2.2.2.5.7" class="ltx_td ltx_align_center">33.49</td>
<td id="S7.F5.2.2.2.5.8" class="ltx_td ltx_align_center">26.57</td>
</tr>
<tr id="S7.F5.2.2.2.6" class="ltx_tr">
<td id="S7.F5.2.2.2.6.1" class="ltx_td ltx_align_center">✓</td>
<td id="S7.F5.2.2.2.6.2" class="ltx_td ltx_align_center">✓</td>
<td id="S7.F5.2.2.2.6.3" class="ltx_td"></td>
<td id="S7.F5.2.2.2.6.4" class="ltx_td"></td>
<td id="S7.F5.2.2.2.6.5" class="ltx_td ltx_align_center">✓</td>
<td id="S7.F5.2.2.2.6.6" class="ltx_td ltx_align_center">24.91</td>
<td id="S7.F5.2.2.2.6.7" class="ltx_td ltx_align_center">34.55</td>
<td id="S7.F5.2.2.2.6.8" class="ltx_td ltx_align_center">26.92</td>
</tr>
<tr id="S7.F5.2.2.2.7" class="ltx_tr">
<td id="S7.F5.2.2.2.7.1" class="ltx_td ltx_align_center">✓</td>
<td id="S7.F5.2.2.2.7.2" class="ltx_td ltx_align_center">✓</td>
<td id="S7.F5.2.2.2.7.3" class="ltx_td"></td>
<td id="S7.F5.2.2.2.7.4" class="ltx_td ltx_align_center">✓</td>
<td id="S7.F5.2.2.2.7.5" class="ltx_td"></td>
<td id="S7.F5.2.2.2.7.6" class="ltx_td ltx_align_center">27.17</td>
<td id="S7.F5.2.2.2.7.7" class="ltx_td ltx_align_center">33.60</td>
<td id="S7.F5.2.2.2.7.8" class="ltx_td ltx_align_center">28.51</td>
</tr>
<tr id="S7.F5.2.2.2.8" class="ltx_tr">
<td id="S7.F5.2.2.2.8.1" class="ltx_td ltx_align_center ltx_border_bb">✓</td>
<td id="S7.F5.2.2.2.8.2" class="ltx_td ltx_align_center ltx_border_bb">✓</td>
<td id="S7.F5.2.2.2.8.3" class="ltx_td ltx_border_bb"></td>
<td id="S7.F5.2.2.2.8.4" class="ltx_td ltx_align_center ltx_border_bb">✓</td>
<td id="S7.F5.2.2.2.8.5" class="ltx_td ltx_align_center ltx_border_bb">✓</td>
<td id="S7.F5.2.2.2.8.6" class="ltx_td ltx_align_center ltx_border_bb"><span id="S7.F5.2.2.2.8.6.1" class="ltx_text ltx_font_bold">27.45</span></td>
<td id="S7.F5.2.2.2.8.7" class="ltx_td ltx_align_center ltx_border_bb"><span id="S7.F5.2.2.2.8.7.1" class="ltx_text ltx_font_bold">34.69</span></td>
<td id="S7.F5.2.2.2.8.8" class="ltx_td ltx_align_center ltx_border_bb"><span id="S7.F5.2.2.2.8.8.1" class="ltx_text ltx_font_bold">28.96</span></td>
</tr>
</table>
</span></div>
</div>
</div>
</figure>
</div>
<div class="ltx_flex_cell ltx_flex_size_2">
<figure id="S7.F5.3" class="ltx_figure ltx_figure_panel ltx_minipage ltx_align_center ltx_align_bottom" style="width:216.8pt;"><img src="/html/2403.13762/assets/x3.png" id="S7.F5.3.g1" class="ltx_graphics ltx_img_landscape" width="368" height="276" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span id="S7.F5.3.1.1.1" class="ltx_text" style="font-size:90%;">Figure 5</span>: </span><span id="S7.F5.3.2.2" class="ltx_text" style="font-size:90%;">Training curves of the ablation.</span></figcaption>
</figure>
</div>
</div>
</figure>
<div id="S7.p5" class="ltx_para ltx_noindent">
<p id="S7.p5.4" class="ltx_p"><span id="S7.p5.4.1" class="ltx_text ltx_font_bold">Ablation studies.</span> <a href="#S7.T3" title="In Figure 5 ‣ 7 Experimental Results ‣ When Cars meet Drones: Hyperbolic Federated Learning for Source-Free Domain Adaptation in Adverse Weather" class="ltx_ref"><span class="ltx_text ltx_ref_tag">Tab.</span> <span class="ltx_text ltx_ref_tag">3</span></a> shows an extensive ablation of the various modules of the proposed approach together and <a href="#S7.F5" title="In 7 Experimental Results ‣ When Cars meet Drones: Hyperbolic Federated Learning for Source-Free Domain Adaptation in Adverse Weather" class="ltx_ref"><span class="ltx_text ltx_ref_tag">Fig.</span> <span class="ltx_text ltx_ref_tag">5</span></a> the corresponding training curves.
The aggregation strategy of Eq. (<a href="#S4.E12" title="Equation 12 ‣ 4.4 Server Aggregation (AG) ‣ 4 Training Procedure ‣ When Cars meet Drones: Hyperbolic Federated Learning for Source-Free Domain Adaptation in Adverse Weather" class="ltx_ref"><span class="ltx_text ltx_ref_tag">12</span></a>) stabilizes the self-training and avoids performance decrease on unbalanced clients (<em id="S7.p5.4.2" class="ltx_emph ltx_font_italic">i.e</em>.<span id="S7.p5.4.3" class="ltx_text"></span> drones).
The batch normalization effect is visible in cars and drones (<math id="S7.p5.1.m1.1" class="ltx_Math" alttext="+3.4\%" display="inline"><semantics id="S7.p5.1.m1.1a"><mrow id="S7.p5.1.m1.1.1" xref="S7.p5.1.m1.1.1.cmml"><mo id="S7.p5.1.m1.1.1a" xref="S7.p5.1.m1.1.1.cmml">+</mo><mrow id="S7.p5.1.m1.1.1.2" xref="S7.p5.1.m1.1.1.2.cmml"><mn id="S7.p5.1.m1.1.1.2.2" xref="S7.p5.1.m1.1.1.2.2.cmml">3.4</mn><mo id="S7.p5.1.m1.1.1.2.1" xref="S7.p5.1.m1.1.1.2.1.cmml">%</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S7.p5.1.m1.1b"><apply id="S7.p5.1.m1.1.1.cmml" xref="S7.p5.1.m1.1.1"><plus id="S7.p5.1.m1.1.1.1.cmml" xref="S7.p5.1.m1.1.1"></plus><apply id="S7.p5.1.m1.1.1.2.cmml" xref="S7.p5.1.m1.1.1.2"><csymbol cd="latexml" id="S7.p5.1.m1.1.1.2.1.cmml" xref="S7.p5.1.m1.1.1.2.1">percent</csymbol><cn type="float" id="S7.p5.1.m1.1.1.2.2.cmml" xref="S7.p5.1.m1.1.1.2.2">3.4</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S7.p5.1.m1.1c">+3.4\%</annotation></semantics></math> overall). Observe that the testing set of drones is more balanced in terms of weather categories (¼  each), making it more noticeable.
The hyperbolic prototypes allow for improving the generalization of the feature spaces compared to the baseline, achieving <math id="S7.p5.2.m2.1" class="ltx_Math" alttext="28.51\%" display="inline"><semantics id="S7.p5.2.m2.1a"><mrow id="S7.p5.2.m2.1.1" xref="S7.p5.2.m2.1.1.cmml"><mn id="S7.p5.2.m2.1.1.2" xref="S7.p5.2.m2.1.1.2.cmml">28.51</mn><mo id="S7.p5.2.m2.1.1.1" xref="S7.p5.2.m2.1.1.1.cmml">%</mo></mrow><annotation-xml encoding="MathML-Content" id="S7.p5.2.m2.1b"><apply id="S7.p5.2.m2.1.1.cmml" xref="S7.p5.2.m2.1.1"><csymbol cd="latexml" id="S7.p5.2.m2.1.1.1.cmml" xref="S7.p5.2.m2.1.1.1">percent</csymbol><cn type="float" id="S7.p5.2.m2.1.1.2.cmml" xref="S7.p5.2.m2.1.1.2">28.51</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S7.p5.2.m2.1c">28.51\%</annotation></semantics></math>. In Suppl. Mat. a comprehensive examination of the advantages over the standard Euclidean space is provided. Finally, adding each component leads to the final score of <math id="S7.p5.3.m3.1" class="ltx_Math" alttext="28.96\%" display="inline"><semantics id="S7.p5.3.m3.1a"><mrow id="S7.p5.3.m3.1.1" xref="S7.p5.3.m3.1.1.cmml"><mn id="S7.p5.3.m3.1.1.2" xref="S7.p5.3.m3.1.1.2.cmml">28.96</mn><mo id="S7.p5.3.m3.1.1.1" xref="S7.p5.3.m3.1.1.1.cmml">%</mo></mrow><annotation-xml encoding="MathML-Content" id="S7.p5.3.m3.1b"><apply id="S7.p5.3.m3.1.1.cmml" xref="S7.p5.3.m3.1.1"><csymbol cd="latexml" id="S7.p5.3.m3.1.1.1.cmml" xref="S7.p5.3.m3.1.1.1">percent</csymbol><cn type="float" id="S7.p5.3.m3.1.1.2.cmml" xref="S7.p5.3.m3.1.1.2">28.96</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S7.p5.3.m3.1c">28.96\%</annotation></semantics></math>. Overall, the contributions of all the components jointly produce a gain of over <math id="S7.p5.4.m4.1" class="ltx_Math" alttext="6.26\%" display="inline"><semantics id="S7.p5.4.m4.1a"><mrow id="S7.p5.4.m4.1.1" xref="S7.p5.4.m4.1.1.cmml"><mn id="S7.p5.4.m4.1.1.2" xref="S7.p5.4.m4.1.1.2.cmml">6.26</mn><mo id="S7.p5.4.m4.1.1.1" xref="S7.p5.4.m4.1.1.1.cmml">%</mo></mrow><annotation-xml encoding="MathML-Content" id="S7.p5.4.m4.1b"><apply id="S7.p5.4.m4.1.1.cmml" xref="S7.p5.4.m4.1.1"><csymbol cd="latexml" id="S7.p5.4.m4.1.1.1.cmml" xref="S7.p5.4.m4.1.1.1">percent</csymbol><cn type="float" id="S7.p5.4.m4.1.1.2.cmml" xref="S7.p5.4.m4.1.1.2">6.26</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S7.p5.4.m4.1c">6.26\%</annotation></semantics></math> of mIoU on the source only. Further ablation on the hyperparameters is in the Suppl. Mat.</p>
</div>
</section>
<section id="S8" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">8 </span>Conclusion</h2>

<div id="S8.p1" class="ltx_para">
<p id="S8.p1.1" class="ltx_p">In this paper we introduced a new federated learning scenario, addressing the challenges of heterogeneous autonomous agents in adverse weather conditions.
The contributions include a realistic federated setting where clients are unsupervised and a versatile model seamlessly integrating aerial views. To achieve these results, we introduced the FLYAWARE dataset for semantic segmentation in adverse weather.
The proposed method, HyperFLAW, employs weather-aware batch normalization layers to mitigate domain shifts across diverse weather conditions. Additionally, it leverages prototype-based learning in the hyperbolic space, contributing a novel method for consistent training in this challenging federated setting. By extending the scope to different types of vehicles and addressing real-world challenges such as adverse weather and privacy preservation, our contributions lay a foundation for future advancements in autonomous driving.
Further research will be devoted to the exploitation of multi-modal data and to more advanced ad-hoc adaptation strategies for adverse weather conditions.</p>
</div>
<section id="S8.SSx1" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">Acknowledgment</h3>

<div id="S8.SSx1.p1" class="ltx_para">
<p id="S8.SSx1.p1.1" class="ltx_p">This work was supported in part by the European Union through the Italian National Recovery and Resilience Plan (NRRP) of NextGenerationEU, a partnership on “Telecommunications of the Future” (Program “RESTART”) under Grant PE0000001.</p>
</div>
</section>
</section>
<section id="bib" class="ltx_bibliography">
<h2 class="ltx_title ltx_title_bibliography">References</h2>

<ul class="ltx_biblist">
<li id="bib.bib1" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[1]</span>
<span class="ltx_bibblock">
Araslanov, N., Roth, S.: Self-supervised augmentation consistency for adapting
semantic segmentation. In: Proceedings of the IEEE/CVF Conference on Computer
Vision and Pattern Recognition. pp. 15384–15394 (2021)

</span>
</li>
<li id="bib.bib2" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[2]</span>
<span class="ltx_bibblock">
Atigh, M.G., Schoep, J., Acar, E., Van Noord, N., Mettes, P.: Hyperbolic image
segmentation. In: Proceedings of the IEEE/CVF conference on computer vision
and pattern recognition. pp. 4453–4462 (2022)

</span>
</li>
<li id="bib.bib3" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[3]</span>
<span class="ltx_bibblock">
Brüggemann, D., Sakaridis, C., Truong, P., Van Gool, L.: Refign: Align and
refine for adaptation of semantic segmentation to adverse conditions. In:
Proceedings of the IEEE/CVF Winter Conference on Applications of Computer
Vision. pp. 3174–3184 (2023)

</span>
</li>
<li id="bib.bib4" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[4]</span>
<span class="ltx_bibblock">
Caldarola, D., Caputo, B., Ciccone, M.: Window-based model averaging improves
generalization in heterogeneous federated learning. In: Proceedings of the
IEEE/CVF International Conference on Computer Vision. pp. 2263–2271 (2023)

</span>
</li>
<li id="bib.bib5" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[5]</span>
<span class="ltx_bibblock">
Chellapandi, V.P., Yuan, L., Brinton, C.G., Żak, S.H., Wang, Z.: Federated
learning for connected and automated vehicles: A survey of existing
approaches and challenges. IEEE Transactions on Intelligent Vehicles (2023)

</span>
</li>
<li id="bib.bib6" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[6]</span>
<span class="ltx_bibblock">
Choi, J., Kim, T., Kim, C.: Self-ensembling with gan-based data augmentation
for domain adaptation in semantic segmentation. In: Proceedings of the
IEEE/CVF International Conference on Computer Vision. pp. 6830–6840 (2019)

</span>
</li>
<li id="bib.bib7" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[7]</span>
<span class="ltx_bibblock">
Cordts, M., Omran, M., Ramos, S., Rehfeld, T., Enzweiler, M., Benenson, R.,
Franke, U., Roth, S., Schiele, B.: The cityscapes dataset for semantic urban
scene understanding. In: Proceedings of the IEEE conference on computer
vision and pattern recognition. pp. 3213–3223 (2016)

</span>
</li>
<li id="bib.bib8" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[8]</span>
<span class="ltx_bibblock">
Dosovitskiy, A., Ros, G., Codevilla, F., Lopez, A., Koltun, V.: Carla: An open
urban driving simulator. In: Conference on robot learning. pp. 1–16. PMLR
(2017)

</span>
</li>
<li id="bib.bib9" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[9]</span>
<span class="ltx_bibblock">
Du, D., Qi, Y., Yu, H., Yang, Y., Duan, K., Li, G., Zhang, W., Huang, Q., Tian,
Q.: The unmanned aerial vehicle benchmark: Object detection and tracking. In:
Proceedings of the European conference on computer vision (ECCV). pp.
370–386 (2018)

</span>
</li>
<li id="bib.bib10" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[10]</span>
<span class="ltx_bibblock">
Eftekhar, A., Sax, A., Malik, J., Zamir, A.: Omnidata: A scalable pipeline for
making multi-task mid-level vision datasets from 3d scans. In: Proceedings of
the IEEE/CVF International Conference on Computer Vision. pp. 10786–10796
(2021)

</span>
</li>
<li id="bib.bib11" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[11]</span>
<span class="ltx_bibblock">
Fantauzzo, L., Fanì, E., Caldarola, D., Tavera, A., Cermelli, F., Ciccone,
M., Caputo, B.: Feddrive: Generalizing federated learning to semantic
segmentation in autonomous driving. In: 2022 IEEE/RSJ International
Conference on Intelligent Robots and Systems (IROS). pp. 11504–11511. IEEE
(2022)

</span>
</li>
<li id="bib.bib12" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[12]</span>
<span class="ltx_bibblock">
Gao, Z., Wu, Y., Jia, Y., Harandi, M.: Curvature generation in curved spaces
for few-shot learning. In: Proceedings of the IEEE/CVF international
conference on computer vision. pp. 8691–8700 (2021)

</span>
</li>
<li id="bib.bib13" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[13]</span>
<span class="ltx_bibblock">
Gasperini, S., Morbitzer, N., Jung, H., Navab, N., Tombari, F.: Robust
monocular depth estimation under challenging conditions. In: Proceedings of
the IEEE/CVF international conference on computer vision. pp. 8177–8186
(2023)

</span>
</li>
<li id="bib.bib14" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[14]</span>
<span class="ltx_bibblock">
Guo, Y., Wang, X., Chen, Y., Yu, S.X.: Clipped hyperbolic classifiers are
super-hyperbolic classifiers. In: Proceedings of the IEEE/CVF Conference on
Computer Vision and Pattern Recognition. pp. 11–20 (2022)

</span>
</li>
<li id="bib.bib15" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[15]</span>
<span class="ltx_bibblock">
Hoyer, L., Dai, D., Van Gool, L.: Daformer: Improving network architectures and
training strategies for domain-adaptive semantic segmentation. In:
Proceedings of the IEEE/CVF Conference on Computer Vision and Pattern
Recognition. pp. 9924–9935 (2022)

</span>
</li>
<li id="bib.bib16" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[16]</span>
<span class="ltx_bibblock">
Hu, X., Fu, C.W., Zhu, L., Heng, P.A.: Depth-attentional features for
single-image rain removal. In: Proceedings of the IEEE/CVF Conference on
computer vision and pattern recognition. pp. 8022–8031 (2019)

</span>
</li>
<li id="bib.bib17" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[17]</span>
<span class="ltx_bibblock">
Khrulkov, V., Mirvakhabova, L., Ustinova, E., Oseledets, I., Lempitsky, V.:
Hyperbolic image embeddings. In: Proceedings of the IEEE/CVF Conference on
Computer Vision and Pattern Recognition. pp. 6418–6428 (2020)

</span>
</li>
<li id="bib.bib18" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[18]</span>
<span class="ltx_bibblock">
Klinghoffer, T., Philion, J., Chen, W., Litany, O., Gojcic, Z., Joo, J.,
Raskar, R., Fidler, S., Alvarez, J.M.: Towards viewpoint robustness in bird’s
eye view segmentation. In: Proceedings of the IEEE/CVF International
Conference on Computer Vision. pp. 8515–8524 (2023)

</span>
</li>
<li id="bib.bib19" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[19]</span>
<span class="ltx_bibblock">
Li, J., Yu, Z., Du, Z., Zhu, L., Shen, H.T.: A comprehensive survey on
source-free domain adaptation. IEEE Transactions on Pattern Analysis and
Machine Intelligence (2024)

</span>
</li>
<li id="bib.bib20" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[20]</span>
<span class="ltx_bibblock">
Li, Q., He, B., Song, D.: Model-contrastive federated learning. In: Proceedings
of the IEEE/CVF conference on computer vision and pattern recognition. pp.
10713–10722 (2021)

</span>
</li>
<li id="bib.bib21" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[21]</span>
<span class="ltx_bibblock">
Li, T., Sahu, A.K., Zaheer, M., Sanjabi, M., Talwalkar, A., Smith, V.:
Federated optimization in heterogeneous networks. Proceedings of Machine
learning and systems <span id="bib.bib21.1.1" class="ltx_text ltx_font_bold">2</span>, 429–450 (2020)

</span>
</li>
<li id="bib.bib22" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[22]</span>
<span class="ltx_bibblock">
Li, X., Jiang, M., Zhang, X., Kamp, M., Dou, Q.: Fedbn: Federated learning on
non-iid features via local batch normalization. arXiv preprint
arXiv:2102.07623 (2021)

</span>
</li>
<li id="bib.bib23" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[23]</span>
<span class="ltx_bibblock">
Liu, Y., Deng, J., Gao, X., Li, W., Duan, L.: Bapa-net: Boundary adaptation and
prototype alignment for cross-domain semantic segmentation. In: Proceedings
of the IEEE/CVF international conference on computer vision. pp. 8801–8811
(2021)

</span>
</li>
<li id="bib.bib24" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[24]</span>
<span class="ltx_bibblock">
Luo, Y., Zheng, L., Guan, T., Yu, J., Yang, Y.: Taking a closer look at domain
shift: Category-level adversaries for semantics consistent domain adaptation.
In: Proceedings of the IEEE/CVF conference on computer vision and pattern
recognition. pp. 2507–2516 (2019)

</span>
</li>
<li id="bib.bib25" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[25]</span>
<span class="ltx_bibblock">
Lyu, Y., Vosselman, G., Xia, G.S., Yilmaz, A., Yang, M.Y.: Uavid: A semantic
segmentation dataset for uav imagery. ISPRS journal of photogrammetry and
remote sensing <span id="bib.bib25.1.1" class="ltx_text ltx_font_bold">165</span>, 108–119 (2020)

</span>
</li>
<li id="bib.bib26" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[26]</span>
<span class="ltx_bibblock">
Ma, R., Fang, P., Drummond, T., Harandi, M.: Adaptive poincaré point to set
distance for few-shot classification. In: Proceedings of the AAAI conference
on artificial intelligence. vol. 36, pp. 1926–1934 (2022)

</span>
</li>
<li id="bib.bib27" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[27]</span>
<span class="ltx_bibblock">
McMahan, B., Moore, E., Ramage, D., Hampson, S., y Arcas, B.A.:
Communication-efficient learning of deep networks from decentralized data.
In: Artificial Intelligence and Statistics (AISTATS). pp. 1273–1282. PMLR
(2017)

</span>
</li>
<li id="bib.bib28" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[28]</span>
<span class="ltx_bibblock">
Mei, K., Zhu, C., Zou, J., Zhang, S.: Instance adaptive self-training for
unsupervised domain adaptation. In: Computer Vision–ECCV 2020: 16th European
Conference, Glasgow, UK, August 23–28, 2020, Proceedings, Part XXVI 16. pp.
415–430. Springer (2020)

</span>
</li>
<li id="bib.bib29" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[29]</span>
<span class="ltx_bibblock">
Mettes, P., Atigh, M.G., Keller-Ressel, M., Gu, J., Yeung, S.: Hyperbolic deep
learning in computer vision: A survey. arXiv preprint arXiv:2305.06611
(2023)

</span>
</li>
<li id="bib.bib30" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[30]</span>
<span class="ltx_bibblock">
Michieli, U., Biasetton, M., Agresti, G., Zanuttigh, P.: Adversarial learning
and self-teaching techniques for domain adaptation in semantic segmentation.
IEEE Transactions on Intelligent Vehicles <span id="bib.bib30.1.1" class="ltx_text ltx_font_bold">5</span>(3), 508–518 (2020)

</span>
</li>
<li id="bib.bib31" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[31]</span>
<span class="ltx_bibblock">
Ren, H., Yang, Y., Wang, H., Shen, B., Fan, Q., Zheng, Y., Liu, C.K., Guibas,
L.J.: Adela: Automatic dense labeling with attention for viewpoint shift in
semantic segmentation. In: Proceedings of the IEEE/CVF Conference on Computer
Vision and Pattern Recognition. pp. 8079–8089 (2022)

</span>
</li>
<li id="bib.bib32" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[32]</span>
<span class="ltx_bibblock">
Rizzoli, G., Barbato, F., Caligiuri, M., Zanuttigh, P.: Syndrone-multi-modal
uav dataset for urban scenarios. In: Proceedings of the IEEE/CVF
International Conference on Computer Vision. pp. 2210–2220 (2023)

</span>
</li>
<li id="bib.bib33" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[33]</span>
<span class="ltx_bibblock">
Saito, K., Watanabe, K., Ushiku, Y., Harada, T.: Maximum classifier discrepancy
for unsupervised domain adaptation. In: Proceedings of the IEEE conference on
computer vision and pattern recognition. pp. 3723–3732 (2018)

</span>
</li>
<li id="bib.bib34" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[34]</span>
<span class="ltx_bibblock">
Sakaridis, C., Dai, D., Van Gool, L.: Acdc: The adverse conditions dataset with
correspondences for semantic driving scene understanding. In: Proceedings of
the IEEE/CVF International Conference on Computer Vision. pp. 10765–10775
(2021)

</span>
</li>
<li id="bib.bib35" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[35]</span>
<span class="ltx_bibblock">
Sarlin, P.E., Trulls, E., Pollefeys, M., Hosang, J., Lynen, S.: Snap:
Self-supervised neural maps for visual positioning and semantic
understanding. Advances in Neural Information Processing Systems <span id="bib.bib35.1.1" class="ltx_text ltx_font_bold">36</span>
(2024)

</span>
</li>
<li id="bib.bib36" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[36]</span>
<span class="ltx_bibblock">
Schwonberg, M., Niemeijer, J., Termöhlen, J.A., Schäfer, J.P., Schmidt, N.M.,
Gottschalk, H., Fingscheidt, T.: Survey on unsupervised domain adaptation for
semantic segmentation for visual perception in automated driving (2023)

</span>
</li>
<li id="bib.bib37" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[37]</span>
<span class="ltx_bibblock">
Shenaj, D., Fanì, E., Toldo, M., Caldarola, D., Tavera, A., Michieli, U.,
Ciccone, M., Zanuttigh, P., Caputo, B.: Learning across domains and devices:
Style-driven source-free domain adaptation in clustered federated learning.
In: Proceedings of the IEEE/CVF Winter Conference on Applications of Computer
Vision. pp. 444–454 (2023)

</span>
</li>
<li id="bib.bib38" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[38]</span>
<span class="ltx_bibblock">
Shenaj, D., Rizzoli, G., Zanuttigh, P.: Federated learning in computer vision.
IEEE Access (2023)

</span>
</li>
<li id="bib.bib39" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[39]</span>
<span class="ltx_bibblock">
Shenaj, D., Toldo, M., Rigon, A., Zanuttigh, P.: Asynchronous federated
continual learning. In: Proceedings of the IEEE/CVF Conference on Computer
Vision and Pattern Recognition. pp. 5054–5062 (2023)

</span>
</li>
<li id="bib.bib40" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[40]</span>
<span class="ltx_bibblock">
van Spengler, M., Berkhout, E., Mettes, P.: Poincare resnet. In: Proceedings of
the IEEE/CVF International Conference on Computer Vision. pp. 5419–5428
(October 2023)

</span>
</li>
<li id="bib.bib41" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[41]</span>
<span class="ltx_bibblock">
van Spengler, M., Wirth, P., Mettes, P.: Hypll: The hyperbolic learning
library. arXiv preprint arXiv:2306.06154 (2023)

</span>
</li>
<li id="bib.bib42" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[42]</span>
<span class="ltx_bibblock">
Testolina, P., Barbato, F., Michieli, U., Giordani, M., Zanuttigh, P., Zorzi,
M.: Selma: Semantic large-scale multimodal acquisitions in variable weather,
daytime and viewpoints. IEEE Transactions on Intelligent Transportation
Systems (2023)

</span>
</li>
<li id="bib.bib43" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[43]</span>
<span class="ltx_bibblock">
Toldo, M., Maracani, A., Michieli, U., Zanuttigh, P.: Unsupervised domain
adaptation in semantic segmentation: a review. Technologies <span id="bib.bib43.1.1" class="ltx_text ltx_font_bold">8</span>(2),
 35 (2020)

</span>
</li>
<li id="bib.bib44" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[44]</span>
<span class="ltx_bibblock">
Tsai, Y.H., Hung, W.C., Schulter, S., Sohn, K., Yang, M.H., Chandraker, M.:
Learning to adapt structured output space for semantic segmentation. In:
Proceedings of the IEEE conference on computer vision and pattern
recognition. pp. 7472–7481 (2018)

</span>
</li>
<li id="bib.bib45" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[45]</span>
<span class="ltx_bibblock">
Tzeng, E., Hoffman, J., Zhang, N., Saenko, K., Darrell, T.: Deep domain
confusion: Maximizing for domain invariance. arXiv preprint arXiv:1412.3474
(2014)

</span>
</li>
<li id="bib.bib46" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[46]</span>
<span class="ltx_bibblock">
Xia, R., Zhao, C., Zheng, M., Wu, Z., Sun, Q., Tang, Y.: Cmda: Cross-modality
domain adaptation for nighttime semantic segmentation. In: Proceedings of the
IEEE/CVF International Conference on Computer Vision. pp. 21572–21581 (2023)

</span>
</li>
<li id="bib.bib47" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[47]</span>
<span class="ltx_bibblock">
Yang, Y., Soatto, S.: Fda: Fourier domain adaptation for semantic segmentation.
In: Proceedings of the IEEE/CVF conference on computer vision and pattern
recognition. pp. 4085–4095 (2020)

</span>
</li>
<li id="bib.bib48" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[48]</span>
<span class="ltx_bibblock">
Yu, F., Chen, H., Wang, X., Xian, W., Chen, Y., Liu, F., Madhavan, V., Darrell,
T.: Bdd100k: A diverse driving dataset for heterogeneous multitask learning.
In: Proceedings of the IEEE/CVF conference on computer vision and pattern
recognition. pp. 2636–2645 (2020)

</span>
</li>
<li id="bib.bib49" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[49]</span>
<span class="ltx_bibblock">
Zhang, N., Zhang, L., Cheng, Z.: Towards simulating foggy and hazy images and
evaluating their authenticity. In: International Conference on Neural
Information Processing. pp. 405–415. Springer (2017)

</span>
</li>
<li id="bib.bib50" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[50]</span>
<span class="ltx_bibblock">
Zhang, P., Zhang, B., Zhang, T., Chen, D., Wang, Y., Wen, F.: Prototypical
pseudo label denoising and target structure learning for domain adaptive
semantic segmentation. In: Proceedings of the IEEE/CVF conference on computer
vision and pattern recognition. pp. 12414–12424 (2021)

</span>
</li>
<li id="bib.bib51" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[51]</span>
<span class="ltx_bibblock">
Zhang, Q., Zhang, J., Liu, W., Tao, D.: Category anchor-guided unsupervised
domain adaptation for semantic segmentation. Advances in neural information
processing systems <span id="bib.bib51.1.1" class="ltx_text ltx_font_bold">32</span> (2019)

</span>
</li>
<li id="bib.bib52" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[52]</span>
<span class="ltx_bibblock">
Zheng, Z., Wu, Y., Han, X., Shi, J.: Forkgan: Seeing into the rainy night. In:
Computer Vision–ECCV 2020: 16th European Conference, Glasgow, UK, August
23–28, 2020, Proceedings, Part III 16. pp. 155–170. Springer (2020)

</span>
</li>
<li id="bib.bib53" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[53]</span>
<span class="ltx_bibblock">
Zhu, P., Wen, L., Du, D., Bian, X., Fan, H., Hu, Q., Ling, H.: Detection and
tracking meet drones challenge. IEEE Transactions on Pattern Analysis and
Machine Intelligence <span id="bib.bib53.1.1" class="ltx_text ltx_font_bold">44</span>(11), 7380–7399 (2021)

</span>
</li>
<li id="bib.bib54" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[54]</span>
<span class="ltx_bibblock">
Zou, Y., Yu, Z., Kumar, B., Wang, J.: Unsupervised domain adaptation for
semantic segmentation via class-balanced self-training. In: Proceedings of
the European conference on computer vision (ECCV). pp. 289–305 (2018)

</span>
</li>
</ul>
</section>
<div class="ltx_pagination ltx_role_newpage"></div>
<div class="ltx_pagination ltx_role_newpage"></div>
<div id="p2" class="ltx_para">
<p id="p2.1" class="ltx_p"><span id="p2.1.1" class="ltx_text" style="font-size:120%;">When Cars meet Drones: Hyperbolic Federated Learning for Source-Free Domain Adaptation in Adverse Weather 
<br class="ltx_break"><span id="p2.1.1.1" class="ltx_text ltx_font_italic">Supplementary Material</span></span></p>
</div>
<div id="p3" class="ltx_para">
<p id="p3.1" class="ltx_p">Giulia Rizzoli* Matteo Caligiuri* Donald Shenaj Francesco Barbato Pietro Zanuttigh</p>
</div>
<span id="footnotex2" class="ltx_note ltx_role_footnotetext"><sup class="ltx_note_mark">*</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">*</sup><span class="ltx_note_type">footnotetext: </span>These authors contributed equally to this work.</span></span></span>
<div id="p4" class="ltx_para">
<p id="p4.1" class="ltx_p">This document contains the supplementary material for the paper <span id="p4.1.1" class="ltx_text ltx_font_italic">When Cars meet Drones: Hyperbolic Federated Learning for Source-Free Domain Adaptation in Adverse Weather</span>.
We start by introducing additional details on the employed datasets. We then proceed with ablations supporting the usage of the weather batch-normalization and of hyperbolic prototypes. Finally, we show further experimental data including per-class accuracy scores and qualitative results.</p>
</div>
<section id="S1a" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">S1 </span>Data Selection and Distribution</h2>

<div id="S1a.p1" class="ltx_para">
<p id="S1a.p1.1" class="ltx_p">In the main paper, we introduced the <span id="S1a.p1.1.1" class="ltx_text ltx_font_bold">FLYAWARE</span> aerial dataset since it is a novel contribution. Conversely, we offered fewer details for car driving datasets, as we relied on existing datasets. Here we will first describe the technical choices adopted to enable distributed learning on car agents in adverse weather. Then, some additional details on weather distribution among clients are provided.</p>
</div>
<section id="S1.SS1" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">S1.1 </span>Driving Datasets</h3>

<div id="S1.SS1.p1" class="ltx_para">
<p id="S1.SS1.p1.1" class="ltx_p">For the synthetic source dataset for cars, we used the <span id="S1.SS1.p1.1.1" class="ltx_text ltx_font_bold">SELMA</span> dataset <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib42" title="" class="ltx_ref">42</a>]</cite>.
It offers a comprehensive set of 27 weather and daytime conditions, resulting in a vast dataset of over 20M samples. To better align with the weather scenarios considered in real data <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib34" title="" class="ltx_ref">34</a>]</cite>, we opted not to use the standard SELMA split, but downloaded over 24k samples in the <span id="S1.SS1.p1.1.2" class="ltx_text ltx_font_italic">ClearNoon, ClearNight, HardRainNoon, MidFoggyNoon</span> splits.
In total, for this work, we employed almost 100k SELMA samples from the Desk Cam point of view that match the one used in the real-world dataset.
As the real counterpart, we used the <span id="S1.SS1.p1.1.3" class="ltx_text ltx_font_bold">ACDC</span> dataset, from which we selected the 3 domains — night, rain, and fog — that match our pretraining. As ACDC lacks images in clear weather, we supplemented it with daytime images coming from the Cityscapes dataset <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib7" title="" class="ltx_ref">7</a>]</cite>, which is the most similar to ACDC. Note that, the ACDC dataset has been built to create an adverse condition version of Cityscapes, and shares the same class-set.
Cityscapes provides more samples than those in the thematic splits by ACDC. Therefore, we subsampled its training set to match the sizes. Since the goal was to select clear weather conditions, we devised an automatic way of assigning a sunlit level (Eq. <a href="#S1.E1" title="Equation S1 ‣ S1.1 Driving Datasets ‣ S1 Data Selection and Distribution ‣ When Cars meet Drones: Hyperbolic Federated Learning for Source-Free Domain Adaptation in Adverse Weather" class="ltx_ref"><span class="ltx_text ltx_ref_tag">S1</span></a>) to each image and selected the needed images by sorting them according to this metric:</p>
<table id="S1.E1" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S1.E1.m1.7" class="ltx_Math" alttext="\text{sunlit}(\textbf{X})=\sum\limits_{c\in\{r,g,b\}}\frac{1}{HW}\sum\limits_{i=0}^{W}\sum\limits_{i=0}^{W}\textbf{X}[i,j,c]" display="block"><semantics id="S1.E1.m1.7a"><mrow id="S1.E1.m1.7.8" xref="S1.E1.m1.7.8.cmml"><mrow id="S1.E1.m1.7.8.2" xref="S1.E1.m1.7.8.2.cmml"><mtext id="S1.E1.m1.7.8.2.2" xref="S1.E1.m1.7.8.2.2a.cmml">sunlit</mtext><mo lspace="0em" rspace="0em" id="S1.E1.m1.7.8.2.1" xref="S1.E1.m1.7.8.2.1.cmml">​</mo><mrow id="S1.E1.m1.7.8.2.3.2" xref="S1.E1.m1.4.4a.cmml"><mo stretchy="false" id="S1.E1.m1.7.8.2.3.2.1" xref="S1.E1.m1.4.4a.cmml">(</mo><mtext class="ltx_mathvariant_bold" id="S1.E1.m1.4.4" xref="S1.E1.m1.4.4.cmml">X</mtext><mo stretchy="false" id="S1.E1.m1.7.8.2.3.2.2" xref="S1.E1.m1.4.4a.cmml">)</mo></mrow></mrow><mo rspace="0.111em" id="S1.E1.m1.7.8.1" xref="S1.E1.m1.7.8.1.cmml">=</mo><mrow id="S1.E1.m1.7.8.3" xref="S1.E1.m1.7.8.3.cmml"><munder id="S1.E1.m1.7.8.3.1" xref="S1.E1.m1.7.8.3.1.cmml"><mo movablelimits="false" id="S1.E1.m1.7.8.3.1.2" xref="S1.E1.m1.7.8.3.1.2.cmml">∑</mo><mrow id="S1.E1.m1.3.3.3" xref="S1.E1.m1.3.3.3.cmml"><mi id="S1.E1.m1.3.3.3.5" xref="S1.E1.m1.3.3.3.5.cmml">c</mi><mo id="S1.E1.m1.3.3.3.4" xref="S1.E1.m1.3.3.3.4.cmml">∈</mo><mrow id="S1.E1.m1.3.3.3.6.2" xref="S1.E1.m1.3.3.3.6.1.cmml"><mo stretchy="false" id="S1.E1.m1.3.3.3.6.2.1" xref="S1.E1.m1.3.3.3.6.1.cmml">{</mo><mi id="S1.E1.m1.1.1.1.1" xref="S1.E1.m1.1.1.1.1.cmml">r</mi><mo id="S1.E1.m1.3.3.3.6.2.2" xref="S1.E1.m1.3.3.3.6.1.cmml">,</mo><mi id="S1.E1.m1.2.2.2.2" xref="S1.E1.m1.2.2.2.2.cmml">g</mi><mo id="S1.E1.m1.3.3.3.6.2.3" xref="S1.E1.m1.3.3.3.6.1.cmml">,</mo><mi id="S1.E1.m1.3.3.3.3" xref="S1.E1.m1.3.3.3.3.cmml">b</mi><mo stretchy="false" id="S1.E1.m1.3.3.3.6.2.4" xref="S1.E1.m1.3.3.3.6.1.cmml">}</mo></mrow></mrow></munder><mrow id="S1.E1.m1.7.8.3.2" xref="S1.E1.m1.7.8.3.2.cmml"><mfrac id="S1.E1.m1.7.8.3.2.2" xref="S1.E1.m1.7.8.3.2.2.cmml"><mn id="S1.E1.m1.7.8.3.2.2.2" xref="S1.E1.m1.7.8.3.2.2.2.cmml">1</mn><mrow id="S1.E1.m1.7.8.3.2.2.3" xref="S1.E1.m1.7.8.3.2.2.3.cmml"><mi id="S1.E1.m1.7.8.3.2.2.3.2" xref="S1.E1.m1.7.8.3.2.2.3.2.cmml">H</mi><mo lspace="0em" rspace="0em" id="S1.E1.m1.7.8.3.2.2.3.1" xref="S1.E1.m1.7.8.3.2.2.3.1.cmml">​</mo><mi id="S1.E1.m1.7.8.3.2.2.3.3" xref="S1.E1.m1.7.8.3.2.2.3.3.cmml">W</mi></mrow></mfrac><mo lspace="0em" rspace="0em" id="S1.E1.m1.7.8.3.2.1" xref="S1.E1.m1.7.8.3.2.1.cmml">​</mo><mrow id="S1.E1.m1.7.8.3.2.3" xref="S1.E1.m1.7.8.3.2.3.cmml"><munderover id="S1.E1.m1.7.8.3.2.3.1" xref="S1.E1.m1.7.8.3.2.3.1.cmml"><mo movablelimits="false" rspace="0em" id="S1.E1.m1.7.8.3.2.3.1.2.2" xref="S1.E1.m1.7.8.3.2.3.1.2.2.cmml">∑</mo><mrow id="S1.E1.m1.7.8.3.2.3.1.2.3" xref="S1.E1.m1.7.8.3.2.3.1.2.3.cmml"><mi id="S1.E1.m1.7.8.3.2.3.1.2.3.2" xref="S1.E1.m1.7.8.3.2.3.1.2.3.2.cmml">i</mi><mo id="S1.E1.m1.7.8.3.2.3.1.2.3.1" xref="S1.E1.m1.7.8.3.2.3.1.2.3.1.cmml">=</mo><mn id="S1.E1.m1.7.8.3.2.3.1.2.3.3" xref="S1.E1.m1.7.8.3.2.3.1.2.3.3.cmml">0</mn></mrow><mi id="S1.E1.m1.7.8.3.2.3.1.3" xref="S1.E1.m1.7.8.3.2.3.1.3.cmml">W</mi></munderover><mrow id="S1.E1.m1.7.8.3.2.3.2" xref="S1.E1.m1.7.8.3.2.3.2.cmml"><munderover id="S1.E1.m1.7.8.3.2.3.2.1" xref="S1.E1.m1.7.8.3.2.3.2.1.cmml"><mo movablelimits="false" id="S1.E1.m1.7.8.3.2.3.2.1.2.2" xref="S1.E1.m1.7.8.3.2.3.2.1.2.2.cmml">∑</mo><mrow id="S1.E1.m1.7.8.3.2.3.2.1.2.3" xref="S1.E1.m1.7.8.3.2.3.2.1.2.3.cmml"><mi id="S1.E1.m1.7.8.3.2.3.2.1.2.3.2" xref="S1.E1.m1.7.8.3.2.3.2.1.2.3.2.cmml">i</mi><mo id="S1.E1.m1.7.8.3.2.3.2.1.2.3.1" xref="S1.E1.m1.7.8.3.2.3.2.1.2.3.1.cmml">=</mo><mn id="S1.E1.m1.7.8.3.2.3.2.1.2.3.3" xref="S1.E1.m1.7.8.3.2.3.2.1.2.3.3.cmml">0</mn></mrow><mi id="S1.E1.m1.7.8.3.2.3.2.1.3" xref="S1.E1.m1.7.8.3.2.3.2.1.3.cmml">W</mi></munderover><mrow id="S1.E1.m1.7.8.3.2.3.2.2" xref="S1.E1.m1.7.8.3.2.3.2.2.cmml"><mtext class="ltx_mathvariant_bold" id="S1.E1.m1.7.8.3.2.3.2.2.2" xref="S1.E1.m1.7.8.3.2.3.2.2.2a.cmml">X</mtext><mo lspace="0em" rspace="0em" id="S1.E1.m1.7.8.3.2.3.2.2.1" xref="S1.E1.m1.7.8.3.2.3.2.2.1.cmml">​</mo><mrow id="S1.E1.m1.7.8.3.2.3.2.2.3.2" xref="S1.E1.m1.7.8.3.2.3.2.2.3.1.cmml"><mo stretchy="false" id="S1.E1.m1.7.8.3.2.3.2.2.3.2.1" xref="S1.E1.m1.7.8.3.2.3.2.2.3.1.cmml">[</mo><mi id="S1.E1.m1.5.5" xref="S1.E1.m1.5.5.cmml">i</mi><mo id="S1.E1.m1.7.8.3.2.3.2.2.3.2.2" xref="S1.E1.m1.7.8.3.2.3.2.2.3.1.cmml">,</mo><mi id="S1.E1.m1.6.6" xref="S1.E1.m1.6.6.cmml">j</mi><mo id="S1.E1.m1.7.8.3.2.3.2.2.3.2.3" xref="S1.E1.m1.7.8.3.2.3.2.2.3.1.cmml">,</mo><mi id="S1.E1.m1.7.7" xref="S1.E1.m1.7.7.cmml">c</mi><mo stretchy="false" id="S1.E1.m1.7.8.3.2.3.2.2.3.2.4" xref="S1.E1.m1.7.8.3.2.3.2.2.3.1.cmml">]</mo></mrow></mrow></mrow></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S1.E1.m1.7b"><apply id="S1.E1.m1.7.8.cmml" xref="S1.E1.m1.7.8"><eq id="S1.E1.m1.7.8.1.cmml" xref="S1.E1.m1.7.8.1"></eq><apply id="S1.E1.m1.7.8.2.cmml" xref="S1.E1.m1.7.8.2"><times id="S1.E1.m1.7.8.2.1.cmml" xref="S1.E1.m1.7.8.2.1"></times><ci id="S1.E1.m1.7.8.2.2a.cmml" xref="S1.E1.m1.7.8.2.2"><mtext id="S1.E1.m1.7.8.2.2.cmml" xref="S1.E1.m1.7.8.2.2">sunlit</mtext></ci><ci id="S1.E1.m1.4.4a.cmml" xref="S1.E1.m1.7.8.2.3.2"><mtext class="ltx_mathvariant_bold" id="S1.E1.m1.4.4.cmml" xref="S1.E1.m1.4.4">X</mtext></ci></apply><apply id="S1.E1.m1.7.8.3.cmml" xref="S1.E1.m1.7.8.3"><apply id="S1.E1.m1.7.8.3.1.cmml" xref="S1.E1.m1.7.8.3.1"><csymbol cd="ambiguous" id="S1.E1.m1.7.8.3.1.1.cmml" xref="S1.E1.m1.7.8.3.1">subscript</csymbol><sum id="S1.E1.m1.7.8.3.1.2.cmml" xref="S1.E1.m1.7.8.3.1.2"></sum><apply id="S1.E1.m1.3.3.3.cmml" xref="S1.E1.m1.3.3.3"><in id="S1.E1.m1.3.3.3.4.cmml" xref="S1.E1.m1.3.3.3.4"></in><ci id="S1.E1.m1.3.3.3.5.cmml" xref="S1.E1.m1.3.3.3.5">𝑐</ci><set id="S1.E1.m1.3.3.3.6.1.cmml" xref="S1.E1.m1.3.3.3.6.2"><ci id="S1.E1.m1.1.1.1.1.cmml" xref="S1.E1.m1.1.1.1.1">𝑟</ci><ci id="S1.E1.m1.2.2.2.2.cmml" xref="S1.E1.m1.2.2.2.2">𝑔</ci><ci id="S1.E1.m1.3.3.3.3.cmml" xref="S1.E1.m1.3.3.3.3">𝑏</ci></set></apply></apply><apply id="S1.E1.m1.7.8.3.2.cmml" xref="S1.E1.m1.7.8.3.2"><times id="S1.E1.m1.7.8.3.2.1.cmml" xref="S1.E1.m1.7.8.3.2.1"></times><apply id="S1.E1.m1.7.8.3.2.2.cmml" xref="S1.E1.m1.7.8.3.2.2"><divide id="S1.E1.m1.7.8.3.2.2.1.cmml" xref="S1.E1.m1.7.8.3.2.2"></divide><cn type="integer" id="S1.E1.m1.7.8.3.2.2.2.cmml" xref="S1.E1.m1.7.8.3.2.2.2">1</cn><apply id="S1.E1.m1.7.8.3.2.2.3.cmml" xref="S1.E1.m1.7.8.3.2.2.3"><times id="S1.E1.m1.7.8.3.2.2.3.1.cmml" xref="S1.E1.m1.7.8.3.2.2.3.1"></times><ci id="S1.E1.m1.7.8.3.2.2.3.2.cmml" xref="S1.E1.m1.7.8.3.2.2.3.2">𝐻</ci><ci id="S1.E1.m1.7.8.3.2.2.3.3.cmml" xref="S1.E1.m1.7.8.3.2.2.3.3">𝑊</ci></apply></apply><apply id="S1.E1.m1.7.8.3.2.3.cmml" xref="S1.E1.m1.7.8.3.2.3"><apply id="S1.E1.m1.7.8.3.2.3.1.cmml" xref="S1.E1.m1.7.8.3.2.3.1"><csymbol cd="ambiguous" id="S1.E1.m1.7.8.3.2.3.1.1.cmml" xref="S1.E1.m1.7.8.3.2.3.1">superscript</csymbol><apply id="S1.E1.m1.7.8.3.2.3.1.2.cmml" xref="S1.E1.m1.7.8.3.2.3.1"><csymbol cd="ambiguous" id="S1.E1.m1.7.8.3.2.3.1.2.1.cmml" xref="S1.E1.m1.7.8.3.2.3.1">subscript</csymbol><sum id="S1.E1.m1.7.8.3.2.3.1.2.2.cmml" xref="S1.E1.m1.7.8.3.2.3.1.2.2"></sum><apply id="S1.E1.m1.7.8.3.2.3.1.2.3.cmml" xref="S1.E1.m1.7.8.3.2.3.1.2.3"><eq id="S1.E1.m1.7.8.3.2.3.1.2.3.1.cmml" xref="S1.E1.m1.7.8.3.2.3.1.2.3.1"></eq><ci id="S1.E1.m1.7.8.3.2.3.1.2.3.2.cmml" xref="S1.E1.m1.7.8.3.2.3.1.2.3.2">𝑖</ci><cn type="integer" id="S1.E1.m1.7.8.3.2.3.1.2.3.3.cmml" xref="S1.E1.m1.7.8.3.2.3.1.2.3.3">0</cn></apply></apply><ci id="S1.E1.m1.7.8.3.2.3.1.3.cmml" xref="S1.E1.m1.7.8.3.2.3.1.3">𝑊</ci></apply><apply id="S1.E1.m1.7.8.3.2.3.2.cmml" xref="S1.E1.m1.7.8.3.2.3.2"><apply id="S1.E1.m1.7.8.3.2.3.2.1.cmml" xref="S1.E1.m1.7.8.3.2.3.2.1"><csymbol cd="ambiguous" id="S1.E1.m1.7.8.3.2.3.2.1.1.cmml" xref="S1.E1.m1.7.8.3.2.3.2.1">superscript</csymbol><apply id="S1.E1.m1.7.8.3.2.3.2.1.2.cmml" xref="S1.E1.m1.7.8.3.2.3.2.1"><csymbol cd="ambiguous" id="S1.E1.m1.7.8.3.2.3.2.1.2.1.cmml" xref="S1.E1.m1.7.8.3.2.3.2.1">subscript</csymbol><sum id="S1.E1.m1.7.8.3.2.3.2.1.2.2.cmml" xref="S1.E1.m1.7.8.3.2.3.2.1.2.2"></sum><apply id="S1.E1.m1.7.8.3.2.3.2.1.2.3.cmml" xref="S1.E1.m1.7.8.3.2.3.2.1.2.3"><eq id="S1.E1.m1.7.8.3.2.3.2.1.2.3.1.cmml" xref="S1.E1.m1.7.8.3.2.3.2.1.2.3.1"></eq><ci id="S1.E1.m1.7.8.3.2.3.2.1.2.3.2.cmml" xref="S1.E1.m1.7.8.3.2.3.2.1.2.3.2">𝑖</ci><cn type="integer" id="S1.E1.m1.7.8.3.2.3.2.1.2.3.3.cmml" xref="S1.E1.m1.7.8.3.2.3.2.1.2.3.3">0</cn></apply></apply><ci id="S1.E1.m1.7.8.3.2.3.2.1.3.cmml" xref="S1.E1.m1.7.8.3.2.3.2.1.3">𝑊</ci></apply><apply id="S1.E1.m1.7.8.3.2.3.2.2.cmml" xref="S1.E1.m1.7.8.3.2.3.2.2"><times id="S1.E1.m1.7.8.3.2.3.2.2.1.cmml" xref="S1.E1.m1.7.8.3.2.3.2.2.1"></times><ci id="S1.E1.m1.7.8.3.2.3.2.2.2a.cmml" xref="S1.E1.m1.7.8.3.2.3.2.2.2"><mtext class="ltx_mathvariant_bold" id="S1.E1.m1.7.8.3.2.3.2.2.2.cmml" xref="S1.E1.m1.7.8.3.2.3.2.2.2">X</mtext></ci><list id="S1.E1.m1.7.8.3.2.3.2.2.3.1.cmml" xref="S1.E1.m1.7.8.3.2.3.2.2.3.2"><ci id="S1.E1.m1.5.5.cmml" xref="S1.E1.m1.5.5">𝑖</ci><ci id="S1.E1.m1.6.6.cmml" xref="S1.E1.m1.6.6">𝑗</ci><ci id="S1.E1.m1.7.7.cmml" xref="S1.E1.m1.7.7">𝑐</ci></list></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S1.E1.m1.7c">\text{sunlit}(\textbf{X})=\sum\limits_{c\in\{r,g,b\}}\frac{1}{HW}\sum\limits_{i=0}^{W}\sum\limits_{i=0}^{W}\textbf{X}[i,j,c]</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(S1)</span></td>
</tr></tbody>
</table>
<p id="S1.SS1.p1.2" class="ltx_p">As shown in <a href="#S4.T1" title="In Figure 4 ‣ 4.4 Server Aggregation (AG) ‣ 4 Training Procedure ‣ When Cars meet Drones: Hyperbolic Federated Learning for Source-Free Domain Adaptation in Adverse Weather" class="ltx_ref"><span class="ltx_text ltx_ref_tag">Tab.</span> <span class="ltx_text ltx_ref_tag">1</span></a> in the main paper, we selected a set of images to match the total count of all other conditions combined, aiming for a ratio of three clear sky images to one adverse condition. This decision was driven by the desire to retain “clear sky” as the most probable scenario in real-world contexts.
In <a href="#S1.F1a" title="In S1.1 Driving Datasets ‣ S1 Data Selection and Distribution ‣ When Cars meet Drones: Hyperbolic Federated Learning for Source-Free Domain Adaptation in Adverse Weather" class="ltx_ref"><span class="ltx_text ltx_ref_tag">Fig.</span> <span class="ltx_text ltx_ref_tag">S1</span></a> we report some examples of samples with their rating (a bright one, a dark one and a mid-range one).</p>
</div>
<figure id="S1.F1a" class="ltx_figure">
<div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_3">
<figure id="S1.F1a.1" class="ltx_figure ltx_figure_panel ltx_align_center"><img src="/html/2403.13762/assets/figs/city_sunny/bright.jpg" id="S1.F1a.1.g1" class="ltx_graphics ltx_img_landscape" width="598" height="299" alt="Refer to caption">
</figure>
</div>
<div class="ltx_flex_cell ltx_flex_size_3">
<figure id="S1.F1a.2" class="ltx_figure ltx_figure_panel ltx_align_center"><img src="/html/2403.13762/assets/figs/city_sunny/mid.jpg" id="S1.F1a.2.g1" class="ltx_graphics ltx_img_landscape" width="598" height="299" alt="Refer to caption">
</figure>
</div>
<div class="ltx_flex_cell ltx_flex_size_3">
<figure id="S1.F1a.3" class="ltx_figure ltx_figure_panel ltx_align_center"><img src="/html/2403.13762/assets/figs/city_sunny/dark.jpg" id="S1.F1a.3.g1" class="ltx_graphics ltx_img_landscape" width="598" height="299" alt="Refer to caption">
</figure>
</div>
</div>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span id="S1.F1a.8.2.1" class="ltx_text" style="font-size:90%;">Figure S1</span>: </span><span id="S1.F1a.5.1" class="ltx_text" style="font-size:90%;">Cityscapes samples and corresponding <span id="S1.F1a.5.1.1" class="ltx_text ltx_font_italic">sunlit</span> score. Decreasing from the left, high/mid/low-score (<math id="S1.F1a.5.1.m1.1" class="ltx_Math" alttext="\sim 300/200/100" display="inline"><semantics id="S1.F1a.5.1.m1.1b"><mrow id="S1.F1a.5.1.m1.1.1" xref="S1.F1a.5.1.m1.1.1.cmml"><mi id="S1.F1a.5.1.m1.1.1.2" xref="S1.F1a.5.1.m1.1.1.2.cmml"></mi><mo id="S1.F1a.5.1.m1.1.1.1" xref="S1.F1a.5.1.m1.1.1.1.cmml">∼</mo><mrow id="S1.F1a.5.1.m1.1.1.3" xref="S1.F1a.5.1.m1.1.1.3.cmml"><mn id="S1.F1a.5.1.m1.1.1.3.2" xref="S1.F1a.5.1.m1.1.1.3.2.cmml">300</mn><mo id="S1.F1a.5.1.m1.1.1.3.1" xref="S1.F1a.5.1.m1.1.1.3.1.cmml">/</mo><mn id="S1.F1a.5.1.m1.1.1.3.3" xref="S1.F1a.5.1.m1.1.1.3.3.cmml">200</mn><mo id="S1.F1a.5.1.m1.1.1.3.1b" xref="S1.F1a.5.1.m1.1.1.3.1.cmml">/</mo><mn id="S1.F1a.5.1.m1.1.1.3.4" xref="S1.F1a.5.1.m1.1.1.3.4.cmml">100</mn></mrow></mrow><annotation-xml encoding="MathML-Content" id="S1.F1a.5.1.m1.1c"><apply id="S1.F1a.5.1.m1.1.1.cmml" xref="S1.F1a.5.1.m1.1.1"><csymbol cd="latexml" id="S1.F1a.5.1.m1.1.1.1.cmml" xref="S1.F1a.5.1.m1.1.1.1">similar-to</csymbol><csymbol cd="latexml" id="S1.F1a.5.1.m1.1.1.2.cmml" xref="S1.F1a.5.1.m1.1.1.2">absent</csymbol><apply id="S1.F1a.5.1.m1.1.1.3.cmml" xref="S1.F1a.5.1.m1.1.1.3"><divide id="S1.F1a.5.1.m1.1.1.3.1.cmml" xref="S1.F1a.5.1.m1.1.1.3.1"></divide><cn type="integer" id="S1.F1a.5.1.m1.1.1.3.2.cmml" xref="S1.F1a.5.1.m1.1.1.3.2">300</cn><cn type="integer" id="S1.F1a.5.1.m1.1.1.3.3.cmml" xref="S1.F1a.5.1.m1.1.1.3.3">200</cn><cn type="integer" id="S1.F1a.5.1.m1.1.1.3.4.cmml" xref="S1.F1a.5.1.m1.1.1.3.4">100</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S1.F1a.5.1.m1.1d">\sim 300/200/100</annotation></semantics></math>).</span></figcaption>
</figure>
</section>
<section id="S1.SS2" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">S1.2 </span>Weather Heterogeneity</h3>

<div id="S1.SS2.p1" class="ltx_para">
<p id="S1.SS2.p1.1" class="ltx_p"><a href="#S1.F2" title="In S1.2 Weather Heterogeneity ‣ S1 Data Selection and Distribution ‣ When Cars meet Drones: Hyperbolic Federated Learning for Source-Free Domain Adaptation in Adverse Weather" class="ltx_ref"><span class="ltx_text ltx_ref_tag">Fig.</span> <span class="ltx_text ltx_ref_tag">S2</span></a> illustrates the weather distribution among clients in the configuration <span id="S1.SS2.p1.1.1" class="ltx_text ltx_font_bold">ACDC+</span> <span id="S1.SS2.p1.1.2" class="ltx_text ltx_font_bold">FLYAWARE-R</span>. We deliberately supplied clear day samples to each client to emulate a common scenario where clear daylight conditions prevail, with fewer instances of challenging weather conditions. This introduces an inherent challenge as adverse weather data samples are less prevalent. Additionally, the imbalance among clients further complicates the scenario.</p>
</div>
<figure id="S1.F2" class="ltx_figure"><img src="/html/2403.13762/assets/x4.png" id="S1.F2.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="229" height="76" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span id="S1.F2.2.1.1" class="ltx_text" style="font-size:90%;">Figure S2</span>: </span><span id="S1.F2.3.2" class="ltx_text" style="font-size:90%;">Distribution of weather conditions across clients (ACDC and FLYAWARE-R).</span></figcaption>
</figure>
<div id="S1.SS2.p2" class="ltx_para">
<p id="S1.SS2.p2.1" class="ltx_p"><a href="#S1.F3" title="In S1.2 Weather Heterogeneity ‣ S1 Data Selection and Distribution ‣ When Cars meet Drones: Hyperbolic Federated Learning for Source-Free Domain Adaptation in Adverse Weather" class="ltx_ref"><span class="ltx_text ltx_ref_tag">Fig.</span> <span class="ltx_text ltx_ref_tag">S3</span></a> shows the weather distribution for clients in the <span id="S1.SS2.p2.1.1" class="ltx_text ltx_font_bold">ACDC+FLYAWARE-R-XL</span> setup. While this configuration exhibits better data balance across clients, it introduces new complexities: some drone clients exclusively operate in adverse conditions, and the training and testing domains originate from different datasets (VisDrone <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib53" title="" class="ltx_ref">53</a>]</cite> and UAVid <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib25" title="" class="ltx_ref">25</a>]</cite>, respectively). Notably, VisDrone images offer real night data, whereas we utilized domain-translated images for fog and rain using the same strategies described in the main paper.</p>
</div>
<figure id="S1.F3" class="ltx_figure"><img src="/html/2403.13762/assets/x5.png" id="S1.F3.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="292" height="97" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span id="S1.F3.2.1.1" class="ltx_text" style="font-size:90%;">Figure S3</span>: </span><span id="S1.F3.3.2" class="ltx_text" style="font-size:90%;">Distribution of weather conditions across clients (ACDC and FLYAWARE-R-XL).</span></figcaption>
</figure>
</section>
</section>
<section id="S2a" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">S2 </span>Impact of Weather-Batch Normalization</h2>

<div id="S2a.p1" class="ltx_para">
<p id="S2a.p1.2" class="ltx_p">As shown in <a href="#S7.T3" title="In Figure 5 ‣ 7 Experimental Results ‣ When Cars meet Drones: Hyperbolic Federated Learning for Source-Free Domain Adaptation in Adverse Weather" class="ltx_ref"><span class="ltx_text ltx_ref_tag">Tab.</span> <span class="ltx_text ltx_ref_tag">3</span></a> of the main paper, the inclusion of ad-hoc batch norms (BNs) enhances performance in comparison to utilizing a non-personalized network.
First of all, in <a href="#S2.F4" title="In S2 Impact of Weather-Batch Normalization ‣ When Cars meet Drones: Hyperbolic Federated Learning for Source-Free Domain Adaptation in Adverse Weather" class="ltx_ref"><span class="ltx_text ltx_ref_tag">Fig.</span> <span class="ltx_text ltx_ref_tag">S4</span></a>, we show in detail the architecture of the weather classifier.
Although the classifier model is simple, it achieves an accuracy of <math id="S2a.p1.1.m1.1" class="ltx_Math" alttext="98.96\%" display="inline"><semantics id="S2a.p1.1.m1.1a"><mrow id="S2a.p1.1.m1.1.1" xref="S2a.p1.1.m1.1.1.cmml"><mn id="S2a.p1.1.m1.1.1.2" xref="S2a.p1.1.m1.1.1.2.cmml">98.96</mn><mo id="S2a.p1.1.m1.1.1.1" xref="S2a.p1.1.m1.1.1.1.cmml">%</mo></mrow><annotation-xml encoding="MathML-Content" id="S2a.p1.1.m1.1b"><apply id="S2a.p1.1.m1.1.1.cmml" xref="S2a.p1.1.m1.1.1"><csymbol cd="latexml" id="S2a.p1.1.m1.1.1.1.cmml" xref="S2a.p1.1.m1.1.1.1">percent</csymbol><cn type="float" id="S2a.p1.1.m1.1.1.2.cmml" xref="S2a.p1.1.m1.1.1.2">98.96</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S2a.p1.1.m1.1c">98.96\%</annotation></semantics></math> on the source synthetic datasets used to train it and of <math id="S2a.p1.2.m2.1" class="ltx_Math" alttext="72.37\%" display="inline"><semantics id="S2a.p1.2.m2.1a"><mrow id="S2a.p1.2.m2.1.1" xref="S2a.p1.2.m2.1.1.cmml"><mn id="S2a.p1.2.m2.1.1.2" xref="S2a.p1.2.m2.1.1.2.cmml">72.37</mn><mo id="S2a.p1.2.m2.1.1.1" xref="S2a.p1.2.m2.1.1.1.cmml">%</mo></mrow><annotation-xml encoding="MathML-Content" id="S2a.p1.2.m2.1b"><apply id="S2a.p1.2.m2.1.1.cmml" xref="S2a.p1.2.m2.1.1"><csymbol cd="latexml" id="S2a.p1.2.m2.1.1.1.cmml" xref="S2a.p1.2.m2.1.1.1">percent</csymbol><cn type="float" id="S2a.p1.2.m2.1.1.2.cmml" xref="S2a.p1.2.m2.1.1.2">72.37</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S2a.p1.2.m2.1c">72.37\%</annotation></semantics></math> on the real world target ones.</p>
</div>
<figure id="S2.F4" class="ltx_figure"><img src="/html/2403.13762/assets/x6.png" id="S2.F4.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="415" height="205" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span id="S2.F4.2.1.1" class="ltx_text" style="font-size:90%;">Figure S4</span>: </span><span id="S2.F4.3.2" class="ltx_text" style="font-size:90%;">Weather classifier architecture model.</span></figcaption>
</figure>
<figure id="S2.T1" class="ltx_table">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_table"><span id="S2.T1.2.1.1" class="ltx_text" style="font-size:90%;">Table S1</span>: </span><span id="S2.T1.3.2" class="ltx_text" style="font-size:90%;">Effect of the different modules on the weather.</span></figcaption>
<table id="S2.T1.4" class="ltx_tabular ltx_centering ltx_align_middle">
<tr id="S2.T1.4.1" class="ltx_tr">
<td id="S2.T1.4.1.1" class="ltx_td ltx_align_left ltx_border_tt"><span id="S2.T1.4.1.1.1" class="ltx_text ltx_font_bold">Modules</span></td>
<td id="S2.T1.4.1.2" class="ltx_td ltx_align_center ltx_border_tt"><span id="S2.T1.4.1.2.1" class="ltx_text ltx_font_bold">Clear</span></td>
<td id="S2.T1.4.1.3" class="ltx_td ltx_align_center ltx_border_tt"><span id="S2.T1.4.1.3.1" class="ltx_text ltx_font_bold">Night</span></td>
<td id="S2.T1.4.1.4" class="ltx_td ltx_align_center ltx_border_tt"><span id="S2.T1.4.1.4.1" class="ltx_text ltx_font_bold">Rain</span></td>
<td id="S2.T1.4.1.5" class="ltx_td ltx_align_center ltx_border_tt"><span id="S2.T1.4.1.5.1" class="ltx_text ltx_font_bold">Fog</span></td>
</tr>
<tr id="S2.T1.4.2" class="ltx_tr">
<td id="S2.T1.4.2.1" class="ltx_td ltx_align_left ltx_border_t">Pretrain</td>
<td id="S2.T1.4.2.2" class="ltx_td ltx_align_center ltx_border_t">25.41</td>
<td id="S2.T1.4.2.3" class="ltx_td ltx_align_center ltx_border_t">13.62</td>
<td id="S2.T1.4.2.4" class="ltx_td ltx_align_center ltx_border_t">26.72</td>
<td id="S2.T1.4.2.5" class="ltx_td ltx_align_center ltx_border_t">26.08</td>
</tr>
<tr id="S2.T1.4.3" class="ltx_tr">
<td id="S2.T1.4.3.1" class="ltx_td ltx_align_left">ST + AG w/o BN</td>
<td id="S2.T1.4.3.2" class="ltx_td ltx_align_center">29.27</td>
<td id="S2.T1.4.3.3" class="ltx_td ltx_align_center">13.47</td>
<td id="S2.T1.4.3.4" class="ltx_td ltx_align_center">29.47</td>
<td id="S2.T1.4.3.5" class="ltx_td ltx_align_center">27.86</td>
</tr>
<tr id="S2.T1.4.4" class="ltx_tr">
<td id="S2.T1.4.4.1" class="ltx_td ltx_align_left">ST + AG w BN</td>
<td id="S2.T1.4.4.2" class="ltx_td ltx_align_center">26.81</td>
<td id="S2.T1.4.4.3" class="ltx_td ltx_align_center">13.50</td>
<td id="S2.T1.4.4.4" class="ltx_td ltx_align_center">30.19</td>
<td id="S2.T1.4.4.5" class="ltx_td ltx_align_center">28.86</td>
</tr>
<tr id="S2.T1.4.5" class="ltx_tr">
<td id="S2.T1.4.5.1" class="ltx_td ltx_align_left">ALL w/o BN</td>
<td id="S2.T1.4.5.2" class="ltx_td ltx_align_center">31.58</td>
<td id="S2.T1.4.5.3" class="ltx_td ltx_align_center">14.04</td>
<td id="S2.T1.4.5.4" class="ltx_td ltx_align_center">30.53</td>
<td id="S2.T1.4.5.5" class="ltx_td ltx_align_center">28.93</td>
</tr>
<tr id="S2.T1.4.6" class="ltx_tr">
<td id="S2.T1.4.6.1" class="ltx_td ltx_align_left ltx_border_bb">ALL w BN</td>
<td id="S2.T1.4.6.2" class="ltx_td ltx_align_center ltx_border_bb">31.73</td>
<td id="S2.T1.4.6.3" class="ltx_td ltx_align_center ltx_border_bb">14.18</td>
<td id="S2.T1.4.6.4" class="ltx_td ltx_align_center ltx_border_bb">34.19</td>
<td id="S2.T1.4.6.5" class="ltx_td ltx_align_center ltx_border_bb">29.86</td>
</tr>
</table>
</figure>
<div id="S2a.p2" class="ltx_para">
<p id="S2a.p2.5" class="ltx_p">We further examine in <a href="#S2.T1" title="In S2 Impact of Weather-Batch Normalization ‣ When Cars meet Drones: Hyperbolic Federated Learning for Source-Free Domain Adaptation in Adverse Weather" class="ltx_ref"><span class="ltx_text ltx_ref_tag">Tab.</span> <span class="ltx_text ltx_ref_tag">S1</span></a> the advantage of adapting the system to accommodate different weather conditions as a remarkable feature for the decision-making of autonomous driving agents.
The basic self-training strategy, coupled with the proposed server-side aggregation scheme, has shown stability and an overall improvement over pretraining. However, due to the prevalence of clear-day images in most clients’ samples, the network tends to learn more about this weather condition.
Introducing the personalized weather BNs helps to mitigate this, improving performances in adverse weather conditions, with an mIoU increase of <math id="S2a.p2.1.m1.1" class="ltx_Math" alttext="3\%" display="inline"><semantics id="S2a.p2.1.m1.1a"><mrow id="S2a.p2.1.m1.1.1" xref="S2a.p2.1.m1.1.1.cmml"><mn id="S2a.p2.1.m1.1.1.2" xref="S2a.p2.1.m1.1.1.2.cmml">3</mn><mo id="S2a.p2.1.m1.1.1.1" xref="S2a.p2.1.m1.1.1.1.cmml">%</mo></mrow><annotation-xml encoding="MathML-Content" id="S2a.p2.1.m1.1b"><apply id="S2a.p2.1.m1.1.1.cmml" xref="S2a.p2.1.m1.1.1"><csymbol cd="latexml" id="S2a.p2.1.m1.1.1.1.cmml" xref="S2a.p2.1.m1.1.1.1">percent</csymbol><cn type="integer" id="S2a.p2.1.m1.1.1.2.cmml" xref="S2a.p2.1.m1.1.1.2">3</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S2a.p2.1.m1.1c">3\%</annotation></semantics></math> on Rain and <math id="S2a.p2.2.m2.1" class="ltx_Math" alttext="1.78\%" display="inline"><semantics id="S2a.p2.2.m2.1a"><mrow id="S2a.p2.2.m2.1.1" xref="S2a.p2.2.m2.1.1.cmml"><mn id="S2a.p2.2.m2.1.1.2" xref="S2a.p2.2.m2.1.1.2.cmml">1.78</mn><mo id="S2a.p2.2.m2.1.1.1" xref="S2a.p2.2.m2.1.1.1.cmml">%</mo></mrow><annotation-xml encoding="MathML-Content" id="S2a.p2.2.m2.1b"><apply id="S2a.p2.2.m2.1.1.cmml" xref="S2a.p2.2.m2.1.1"><csymbol cd="latexml" id="S2a.p2.2.m2.1.1.1.cmml" xref="S2a.p2.2.m2.1.1.1">percent</csymbol><cn type="float" id="S2a.p2.2.m2.1.1.2.cmml" xref="S2a.p2.2.m2.1.1.2">1.78</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S2a.p2.2.m2.1c">1.78\%</annotation></semantics></math> on Fog.
Similar results are evident when comparing the full method with and without the weather BNs, showcasing mIoU increases of <math id="S2a.p2.3.m3.1" class="ltx_Math" alttext="3.66\%" display="inline"><semantics id="S2a.p2.3.m3.1a"><mrow id="S2a.p2.3.m3.1.1" xref="S2a.p2.3.m3.1.1.cmml"><mn id="S2a.p2.3.m3.1.1.2" xref="S2a.p2.3.m3.1.1.2.cmml">3.66</mn><mo id="S2a.p2.3.m3.1.1.1" xref="S2a.p2.3.m3.1.1.1.cmml">%</mo></mrow><annotation-xml encoding="MathML-Content" id="S2a.p2.3.m3.1b"><apply id="S2a.p2.3.m3.1.1.cmml" xref="S2a.p2.3.m3.1.1"><csymbol cd="latexml" id="S2a.p2.3.m3.1.1.1.cmml" xref="S2a.p2.3.m3.1.1.1">percent</csymbol><cn type="float" id="S2a.p2.3.m3.1.1.2.cmml" xref="S2a.p2.3.m3.1.1.2">3.66</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S2a.p2.3.m3.1c">3.66\%</annotation></semantics></math> on Rain and <math id="S2a.p2.4.m4.1" class="ltx_Math" alttext="0.93\%" display="inline"><semantics id="S2a.p2.4.m4.1a"><mrow id="S2a.p2.4.m4.1.1" xref="S2a.p2.4.m4.1.1.cmml"><mn id="S2a.p2.4.m4.1.1.2" xref="S2a.p2.4.m4.1.1.2.cmml">0.93</mn><mo id="S2a.p2.4.m4.1.1.1" xref="S2a.p2.4.m4.1.1.1.cmml">%</mo></mrow><annotation-xml encoding="MathML-Content" id="S2a.p2.4.m4.1b"><apply id="S2a.p2.4.m4.1.1.cmml" xref="S2a.p2.4.m4.1.1"><csymbol cd="latexml" id="S2a.p2.4.m4.1.1.1.cmml" xref="S2a.p2.4.m4.1.1.1">percent</csymbol><cn type="float" id="S2a.p2.4.m4.1.1.2.cmml" xref="S2a.p2.4.m4.1.1.2">0.93</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S2a.p2.4.m4.1c">0.93\%</annotation></semantics></math> on Fog.
As a side note, the most difficult scenario remains the night where the improvement over the pretraining is just <math id="S2a.p2.5.m5.1" class="ltx_Math" alttext="0.56\%" display="inline"><semantics id="S2a.p2.5.m5.1a"><mrow id="S2a.p2.5.m5.1.1" xref="S2a.p2.5.m5.1.1.cmml"><mn id="S2a.p2.5.m5.1.1.2" xref="S2a.p2.5.m5.1.1.2.cmml">0.56</mn><mo id="S2a.p2.5.m5.1.1.1" xref="S2a.p2.5.m5.1.1.1.cmml">%</mo></mrow><annotation-xml encoding="MathML-Content" id="S2a.p2.5.m5.1b"><apply id="S2a.p2.5.m5.1.1.cmml" xref="S2a.p2.5.m5.1.1"><csymbol cd="latexml" id="S2a.p2.5.m5.1.1.1.cmml" xref="S2a.p2.5.m5.1.1.1">percent</csymbol><cn type="float" id="S2a.p2.5.m5.1.1.2.cmml" xref="S2a.p2.5.m5.1.1.2">0.56</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S2a.p2.5.m5.1c">0.56\%</annotation></semantics></math> of mIoU.
Overall, we remark on the significance of incorporating personalized weather BNs for mitigating bias towards clear day images and enhancing performance across various weather conditions.</p>
</div>
<div id="S2a.p3" class="ltx_para">
<p id="S2a.p3.1" class="ltx_p">As a final note, considering that modern vehicles often have access to real-time weather information through several sensors (e.g., automatic windshield wipers for rain detection, clock or optical light detection for night and fog), and the weather information might be directly obtained.</p>
</div>
</section>
<section id="S3a" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">S3 </span>Analysis of class prototypes effectiveness</h2>

<div id="S3a.p1" class="ltx_para">
<p id="S3a.p1.1" class="ltx_p"><span id="S3a.p1.1.1" class="ltx_text ltx_font_bold">Hyperbolic vs. Euclidean Prototypes
<br class="ltx_break"></span></p>
</div>
<figure id="S3.F5" class="ltx_figure ltx_align_floatright"><img src="/html/2403.13762/assets/x7.png" id="S3.F5.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="202" height="152" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span id="S3.F5.2.1.1" class="ltx_text" style="font-size:90%;">Figure S5</span>: </span><span id="S3.F5.3.2" class="ltx_text" style="font-size:90%;">Euclidean vs hyperbolic prototypes.</span></figcaption>
</figure>
<div id="S3a.p2" class="ltx_para">
<p id="S3a.p2.2" class="ltx_p">In Fig. <a href="#S3.F5" title="Figure S5 ‣ S3 Analysis of class prototypes effectiveness ‣ When Cars meet Drones: Hyperbolic Federated Learning for Source-Free Domain Adaptation in Adverse Weather" class="ltx_ref"><span class="ltx_text ltx_ref_tag">S5</span></a>, we show the training curves for both Euclidean prototypes and hyperbolic ones employing different values of the weighting parameter for the prototype loss <math id="S3a.p2.1.m1.1" class="ltx_Math" alttext="\lambda_{cl}" display="inline"><semantics id="S3a.p2.1.m1.1a"><msub id="S3a.p2.1.m1.1.1" xref="S3a.p2.1.m1.1.1.cmml"><mi id="S3a.p2.1.m1.1.1.2" xref="S3a.p2.1.m1.1.1.2.cmml">λ</mi><mrow id="S3a.p2.1.m1.1.1.3" xref="S3a.p2.1.m1.1.1.3.cmml"><mi id="S3a.p2.1.m1.1.1.3.2" xref="S3a.p2.1.m1.1.1.3.2.cmml">c</mi><mo lspace="0em" rspace="0em" id="S3a.p2.1.m1.1.1.3.1" xref="S3a.p2.1.m1.1.1.3.1.cmml">​</mo><mi id="S3a.p2.1.m1.1.1.3.3" xref="S3a.p2.1.m1.1.1.3.3.cmml">l</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S3a.p2.1.m1.1b"><apply id="S3a.p2.1.m1.1.1.cmml" xref="S3a.p2.1.m1.1.1"><csymbol cd="ambiguous" id="S3a.p2.1.m1.1.1.1.cmml" xref="S3a.p2.1.m1.1.1">subscript</csymbol><ci id="S3a.p2.1.m1.1.1.2.cmml" xref="S3a.p2.1.m1.1.1.2">𝜆</ci><apply id="S3a.p2.1.m1.1.1.3.cmml" xref="S3a.p2.1.m1.1.1.3"><times id="S3a.p2.1.m1.1.1.3.1.cmml" xref="S3a.p2.1.m1.1.1.3.1"></times><ci id="S3a.p2.1.m1.1.1.3.2.cmml" xref="S3a.p2.1.m1.1.1.3.2">𝑐</ci><ci id="S3a.p2.1.m1.1.1.3.3.cmml" xref="S3a.p2.1.m1.1.1.3.3">𝑙</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3a.p2.1.m1.1c">\lambda_{cl}</annotation></semantics></math>. Notably, hyperbolic space prototypes consistently allow for an increase in performances across different <math id="S3a.p2.2.m2.1" class="ltx_Math" alttext="\lambda_{cl}" display="inline"><semantics id="S3a.p2.2.m2.1a"><msub id="S3a.p2.2.m2.1.1" xref="S3a.p2.2.m2.1.1.cmml"><mi id="S3a.p2.2.m2.1.1.2" xref="S3a.p2.2.m2.1.1.2.cmml">λ</mi><mrow id="S3a.p2.2.m2.1.1.3" xref="S3a.p2.2.m2.1.1.3.cmml"><mi id="S3a.p2.2.m2.1.1.3.2" xref="S3a.p2.2.m2.1.1.3.2.cmml">c</mi><mo lspace="0em" rspace="0em" id="S3a.p2.2.m2.1.1.3.1" xref="S3a.p2.2.m2.1.1.3.1.cmml">​</mo><mi id="S3a.p2.2.m2.1.1.3.3" xref="S3a.p2.2.m2.1.1.3.3.cmml">l</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S3a.p2.2.m2.1b"><apply id="S3a.p2.2.m2.1.1.cmml" xref="S3a.p2.2.m2.1.1"><csymbol cd="ambiguous" id="S3a.p2.2.m2.1.1.1.cmml" xref="S3a.p2.2.m2.1.1">subscript</csymbol><ci id="S3a.p2.2.m2.1.1.2.cmml" xref="S3a.p2.2.m2.1.1.2">𝜆</ci><apply id="S3a.p2.2.m2.1.1.3.cmml" xref="S3a.p2.2.m2.1.1.3"><times id="S3a.p2.2.m2.1.1.3.1.cmml" xref="S3a.p2.2.m2.1.1.3.1"></times><ci id="S3a.p2.2.m2.1.1.3.2.cmml" xref="S3a.p2.2.m2.1.1.3.2">𝑐</ci><ci id="S3a.p2.2.m2.1.1.3.3.cmml" xref="S3a.p2.2.m2.1.1.3.3">𝑙</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3a.p2.2.m2.1c">\lambda_{cl}</annotation></semantics></math> values. The key strength of the hyperbolic space lies in its ability to effectively represent distances between feature vectors, a crucial factor in tasks like clustering where having a distance function capturing meaningful relationships among data points is essential.</p>
</div>
<div class="ltx_pagination ltx_role_newpage"></div>
<div id="S3a.p3" class="ltx_para ltx_noindent">
<p id="S3a.p3.2" class="ltx_p"><span id="S3a.p3.1.1" class="ltx_text ltx_font_bold">Setting of the <math id="S3a.p3.1.1.m1.1" class="ltx_Math" alttext="\lambda_{cl}" display="inline"><semantics id="S3a.p3.1.1.m1.1a"><msub id="S3a.p3.1.1.m1.1.1" xref="S3a.p3.1.1.m1.1.1.cmml"><mi id="S3a.p3.1.1.m1.1.1.2" xref="S3a.p3.1.1.m1.1.1.2.cmml">λ</mi><mrow id="S3a.p3.1.1.m1.1.1.3" xref="S3a.p3.1.1.m1.1.1.3.cmml"><mi id="S3a.p3.1.1.m1.1.1.3.2" xref="S3a.p3.1.1.m1.1.1.3.2.cmml">c</mi><mo lspace="0em" rspace="0em" id="S3a.p3.1.1.m1.1.1.3.1" xref="S3a.p3.1.1.m1.1.1.3.1.cmml">​</mo><mi id="S3a.p3.1.1.m1.1.1.3.3" xref="S3a.p3.1.1.m1.1.1.3.3.cmml">l</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S3a.p3.1.1.m1.1b"><apply id="S3a.p3.1.1.m1.1.1.cmml" xref="S3a.p3.1.1.m1.1.1"><csymbol cd="ambiguous" id="S3a.p3.1.1.m1.1.1.1.cmml" xref="S3a.p3.1.1.m1.1.1">subscript</csymbol><ci id="S3a.p3.1.1.m1.1.1.2.cmml" xref="S3a.p3.1.1.m1.1.1.2">𝜆</ci><apply id="S3a.p3.1.1.m1.1.1.3.cmml" xref="S3a.p3.1.1.m1.1.1.3"><times id="S3a.p3.1.1.m1.1.1.3.1.cmml" xref="S3a.p3.1.1.m1.1.1.3.1"></times><ci id="S3a.p3.1.1.m1.1.1.3.2.cmml" xref="S3a.p3.1.1.m1.1.1.3.2">𝑐</ci><ci id="S3a.p3.1.1.m1.1.1.3.3.cmml" xref="S3a.p3.1.1.m1.1.1.3.3">𝑙</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3a.p3.1.1.m1.1c">\lambda_{cl}</annotation></semantics></math> parameter</span>
Fig. <a href="#S3.F6" title="Figure S6 ‣ S3 Analysis of class prototypes effectiveness ‣ When Cars meet Drones: Hyperbolic Federated Learning for Source-Free Domain Adaptation in Adverse Weather" class="ltx_ref"><span class="ltx_text ltx_ref_tag">S6</span></a> shows the mIoU for different values of the <math id="S3a.p3.2.m1.1" class="ltx_Math" alttext="\lambda_{cl}" display="inline"><semantics id="S3a.p3.2.m1.1a"><msub id="S3a.p3.2.m1.1.1" xref="S3a.p3.2.m1.1.1.cmml"><mi id="S3a.p3.2.m1.1.1.2" xref="S3a.p3.2.m1.1.1.2.cmml">λ</mi><mrow id="S3a.p3.2.m1.1.1.3" xref="S3a.p3.2.m1.1.1.3.cmml"><mi id="S3a.p3.2.m1.1.1.3.2" xref="S3a.p3.2.m1.1.1.3.2.cmml">c</mi><mo lspace="0em" rspace="0em" id="S3a.p3.2.m1.1.1.3.1" xref="S3a.p3.2.m1.1.1.3.1.cmml">​</mo><mi id="S3a.p3.2.m1.1.1.3.3" xref="S3a.p3.2.m1.1.1.3.3.cmml">l</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S3a.p3.2.m1.1b"><apply id="S3a.p3.2.m1.1.1.cmml" xref="S3a.p3.2.m1.1.1"><csymbol cd="ambiguous" id="S3a.p3.2.m1.1.1.1.cmml" xref="S3a.p3.2.m1.1.1">subscript</csymbol><ci id="S3a.p3.2.m1.1.1.2.cmml" xref="S3a.p3.2.m1.1.1.2">𝜆</ci><apply id="S3a.p3.2.m1.1.1.3.cmml" xref="S3a.p3.2.m1.1.1.3"><times id="S3a.p3.2.m1.1.1.3.1.cmml" xref="S3a.p3.2.m1.1.1.3.1"></times><ci id="S3a.p3.2.m1.1.1.3.2.cmml" xref="S3a.p3.2.m1.1.1.3.2">𝑐</ci><ci id="S3a.p3.2.m1.1.1.3.3.cmml" xref="S3a.p3.2.m1.1.1.3.3">𝑙</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3a.p3.2.m1.1c">\lambda_{cl}</annotation></semantics></math> parameter. Best performances are achieved in the range 140-180, with a quite stable maxima.</p>
</div>
<figure id="S3.F6" class="ltx_figure"><img src="/html/2403.13762/assets/x8.png" id="S3.F6.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="276" height="207" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span id="S3.F6.4.2.1" class="ltx_text" style="font-size:90%;">Figure S6</span>: </span><span id="S3.F6.2.1" class="ltx_text" style="font-size:90%;">Tuning on <math id="S3.F6.2.1.m1.1" class="ltx_Math" alttext="\lambda_{cl}" display="inline"><semantics id="S3.F6.2.1.m1.1b"><msub id="S3.F6.2.1.m1.1.1" xref="S3.F6.2.1.m1.1.1.cmml"><mi id="S3.F6.2.1.m1.1.1.2" xref="S3.F6.2.1.m1.1.1.2.cmml">λ</mi><mrow id="S3.F6.2.1.m1.1.1.3" xref="S3.F6.2.1.m1.1.1.3.cmml"><mi id="S3.F6.2.1.m1.1.1.3.2" xref="S3.F6.2.1.m1.1.1.3.2.cmml">c</mi><mo lspace="0em" rspace="0em" id="S3.F6.2.1.m1.1.1.3.1" xref="S3.F6.2.1.m1.1.1.3.1.cmml">​</mo><mi id="S3.F6.2.1.m1.1.1.3.3" xref="S3.F6.2.1.m1.1.1.3.3.cmml">l</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S3.F6.2.1.m1.1c"><apply id="S3.F6.2.1.m1.1.1.cmml" xref="S3.F6.2.1.m1.1.1"><csymbol cd="ambiguous" id="S3.F6.2.1.m1.1.1.1.cmml" xref="S3.F6.2.1.m1.1.1">subscript</csymbol><ci id="S3.F6.2.1.m1.1.1.2.cmml" xref="S3.F6.2.1.m1.1.1.2">𝜆</ci><apply id="S3.F6.2.1.m1.1.1.3.cmml" xref="S3.F6.2.1.m1.1.1.3"><times id="S3.F6.2.1.m1.1.1.3.1.cmml" xref="S3.F6.2.1.m1.1.1.3.1"></times><ci id="S3.F6.2.1.m1.1.1.3.2.cmml" xref="S3.F6.2.1.m1.1.1.3.2">𝑐</ci><ci id="S3.F6.2.1.m1.1.1.3.3.cmml" xref="S3.F6.2.1.m1.1.1.3.3">𝑙</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.F6.2.1.m1.1d">\lambda_{cl}</annotation></semantics></math> weight.</span></figcaption>
</figure>
</section>
<section id="S4a" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">S4 </span>Per-class Results</h2>

<div id="S4a.p1" class="ltx_para">
<p id="S4a.p1.1" class="ltx_p">Tab. <a href="#S4.T2" title="Table S2 ‣ S4 Per-class Results ‣ When Cars meet Drones: Hyperbolic Federated Learning for Source-Free Domain Adaptation in Adverse Weather" class="ltx_ref"><span class="ltx_text ltx_ref_tag">S2</span></a> contains a more detailed version of the results in <a href="#S7.T3" title="In Figure 5 ‣ 7 Experimental Results ‣ When Cars meet Drones: Hyperbolic Federated Learning for Source-Free Domain Adaptation in Adverse Weather" class="ltx_ref"><span class="ltx_text ltx_ref_tag">Tab.</span> <span class="ltx_text ltx_ref_tag">3</span></a> of the main paper that shows also the class-by-class accuracy. As common on the employed datasets, the mIoU is higher in the common classes (e.g., road or building) and lower in the rare and more challenging ones. However, it can be seen that by adding the various components of the model, results tend to increase consistently in most classes, even if a few challenging ones remain hard to detect. Some classes like traffic sign, car or bicycle show impressive improvements.
On the other side, there are a few cases in which our approach does not improve the results on some under-represented classes such as terrain and rider.</p>
</div>
<figure id="S4.T2" class="ltx_table">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_table"><span id="S4.T2.2.1.1" class="ltx_text" style="font-size:90%;">Table S2</span>: </span><span id="S4.T2.3.2" class="ltx_text" style="font-size:90%;">Per class IoU for the proposed approach and its ablated versions. </span></figcaption>
<div id="S4.T2.4" class="ltx_inline-block ltx_transformed_outer" style="width:433.6pt;height:107pt;vertical-align:-0.0pt;"><span class="ltx_transformed_inner" style="transform:translate(-112.6pt,27.8pt) scale(0.658106824448356,0.658106824448356) ;">
<table id="S4.T2.4.1" class="ltx_tabular ltx_align_middle">
<tr id="S4.T2.4.1.1" class="ltx_tr">
<td id="S4.T2.4.1.1.1" class="ltx_td ltx_align_center ltx_border_tt">
<div id="S4.T2.4.1.1.1.1" class="ltx_inline-block ltx_transformed_outer" style="width:6.8pt;height:12.8pt;vertical-align:-0.0pt;"><span class="ltx_transformed_inner" style="width:12.8pt;transform:translate(-2.97pt,-2.97pt) rotate(-90deg) ;">
<p id="S4.T2.4.1.1.1.1.1" class="ltx_p"><span id="S4.T2.4.1.1.1.1.1.1" class="ltx_text ltx_font_bold">ST</span></p>
</span></div>
</td>
<td id="S4.T2.4.1.1.2" class="ltx_td ltx_align_center ltx_border_tt">
<div id="S4.T2.4.1.1.2.1" class="ltx_inline-block ltx_transformed_outer" style="width:6.8pt;height:15.1pt;vertical-align:-0.0pt;"><span class="ltx_transformed_inner" style="width:15.1pt;transform:translate(-4.12pt,-4.12pt) rotate(-90deg) ;">
<p id="S4.T2.4.1.1.2.1.1" class="ltx_p"><span id="S4.T2.4.1.1.2.1.1.1" class="ltx_text ltx_font_bold">AG</span></p>
</span></div>
</td>
<td id="S4.T2.4.1.1.3" class="ltx_td ltx_border_tt"></td>
<td id="S4.T2.4.1.1.4" class="ltx_td ltx_align_center ltx_border_tt">
<div id="S4.T2.4.1.1.4.1" class="ltx_inline-block ltx_transformed_outer" style="width:6.8pt;height:13.5pt;vertical-align:-0.0pt;"><span class="ltx_transformed_inner" style="width:13.5pt;transform:translate(-3.32pt,-3.32pt) rotate(-90deg) ;">
<p id="S4.T2.4.1.1.4.1.1" class="ltx_p"><span id="S4.T2.4.1.1.4.1.1.1" class="ltx_text ltx_font_bold">CL</span></p>
</span></div>
</td>
<td id="S4.T2.4.1.1.5" class="ltx_td ltx_align_center ltx_border_r ltx_border_tt">
<div id="S4.T2.4.1.1.5.1" class="ltx_inline-block ltx_transformed_outer" style="width:6.8pt;height:14.6pt;vertical-align:-0.0pt;"><span class="ltx_transformed_inner" style="width:14.6pt;transform:translate(-3.88pt,-3.88pt) rotate(-90deg) ;">
<p id="S4.T2.4.1.1.5.1.1" class="ltx_p"><span id="S4.T2.4.1.1.5.1.1.1" class="ltx_text ltx_font_bold">BN</span></p>
</span></div>
</td>
<td id="S4.T2.4.1.1.6" class="ltx_td ltx_align_center ltx_border_tt">
<div id="S4.T2.4.1.1.6.1" class="ltx_inline-block ltx_transformed_outer" style="width:6.9pt;height:19.5pt;vertical-align:-0.0pt;"><span class="ltx_transformed_inner" style="width:19.5pt;transform:translate(-6.26pt,-6.26pt) rotate(-90deg) ;">
<p id="S4.T2.4.1.1.6.1.1" class="ltx_p">road</p>
</span></div>
</td>
<td id="S4.T2.4.1.1.7" class="ltx_td ltx_align_center ltx_border_tt">
<div id="S4.T2.4.1.1.7.1" class="ltx_inline-block ltx_transformed_outer" style="width:6.9pt;height:36.7pt;vertical-align:-0.0pt;"><span class="ltx_transformed_inner" style="width:36.7pt;transform:translate(-14.89pt,-14.89pt) rotate(-90deg) ;">
<p id="S4.T2.4.1.1.7.1.1" class="ltx_p">sidewalk</p>
</span></div>
</td>
<td id="S4.T2.4.1.1.8" class="ltx_td ltx_align_center ltx_border_tt">
<div id="S4.T2.4.1.1.8.1" class="ltx_inline-block ltx_transformed_outer" style="width:8.9pt;height:35.6pt;vertical-align:-0.0pt;"><span class="ltx_transformed_inner" style="width:35.6pt;transform:translate(-13.33pt,-12.36pt) rotate(-90deg) ;">
<p id="S4.T2.4.1.1.8.1.1" class="ltx_p">building</p>
</span></div>
</td>
<td id="S4.T2.4.1.1.9" class="ltx_td ltx_align_center ltx_border_tt">
<div id="S4.T2.4.1.1.9.1" class="ltx_inline-block ltx_transformed_outer" style="width:6.9pt;height:17.5pt;vertical-align:-0.0pt;"><span class="ltx_transformed_inner" style="width:17.5pt;transform:translate(-5.28pt,-5.28pt) rotate(-90deg) ;">
<p id="S4.T2.4.1.1.9.1.1" class="ltx_p">wall</p>
</span></div>
</td>
<td id="S4.T2.4.1.1.10" class="ltx_td ltx_align_center ltx_border_tt">
<div id="S4.T2.4.1.1.10.1" class="ltx_inline-block ltx_transformed_outer" style="width:6.9pt;height:21.9pt;vertical-align:-0.0pt;"><span class="ltx_transformed_inner" style="width:21.9pt;transform:translate(-7.5pt,-7.5pt) rotate(-90deg) ;">
<p id="S4.T2.4.1.1.10.1.1" class="ltx_p">fence</p>
</span></div>
</td>
<td id="S4.T2.4.1.1.11" class="ltx_td ltx_align_center ltx_border_tt">
<div id="S4.T2.4.1.1.11.1" class="ltx_inline-block ltx_transformed_outer" style="width:8.9pt;height:18.1pt;vertical-align:-0.0pt;"><span class="ltx_transformed_inner" style="width:18.1pt;transform:translate(-4.58pt,-3.61pt) rotate(-90deg) ;">
<p id="S4.T2.4.1.1.11.1.1" class="ltx_p">pole</p>
</span></div>
</td>
<td id="S4.T2.4.1.1.12" class="ltx_td ltx_align_center ltx_border_tt">
<div id="S4.T2.4.1.1.12.1" class="ltx_inline-block ltx_transformed_outer" style="width:8.9pt;height:49.2pt;vertical-align:-0.0pt;"><span class="ltx_transformed_inner" style="width:49.2pt;transform:translate(-20.15pt,-19.18pt) rotate(-90deg) ;">
<p id="S4.T2.4.1.1.12.1.1" class="ltx_p">traffic light</p>
</span></div>
</td>
<td id="S4.T2.4.1.1.13" class="ltx_td ltx_align_center ltx_border_tt">
<div id="S4.T2.4.1.1.13.1" class="ltx_inline-block ltx_transformed_outer" style="width:8.9pt;height:46.8pt;vertical-align:-0.0pt;"><span class="ltx_transformed_inner" style="width:46.8pt;transform:translate(-18.93pt,-17.96pt) rotate(-90deg) ;">
<p id="S4.T2.4.1.1.13.1.1" class="ltx_p">traffic sign</p>
</span></div>
</td>
<td id="S4.T2.4.1.1.14" class="ltx_td ltx_align_center ltx_border_tt">
<div id="S4.T2.4.1.1.14.1" class="ltx_inline-block ltx_transformed_outer" style="width:8.6pt;height:45pt;vertical-align:-0.0pt;"><span class="ltx_transformed_inner" style="width:45.0pt;transform:translate(-18.19pt,-17.22pt) rotate(-90deg) ;">
<p id="S4.T2.4.1.1.14.1.1" class="ltx_p">vegetation</p>
</span></div>
</td>
<td id="S4.T2.4.1.1.15" class="ltx_td ltx_align_center ltx_border_tt">
<div id="S4.T2.4.1.1.15.1" class="ltx_inline-block ltx_transformed_outer" style="width:6.7pt;height:29.5pt;vertical-align:-0.0pt;"><span class="ltx_transformed_inner" style="width:29.5pt;transform:translate(-11.41pt,-11.41pt) rotate(-90deg) ;">
<p id="S4.T2.4.1.1.15.1.1" class="ltx_p">terrain</p>
</span></div>
</td>
<td id="S4.T2.4.1.1.16" class="ltx_td ltx_align_center ltx_border_tt">
<div id="S4.T2.4.1.1.16.1" class="ltx_inline-block ltx_transformed_outer" style="width:8.9pt;height:14.5pt;vertical-align:-0.0pt;"><span class="ltx_transformed_inner" style="width:14.5pt;transform:translate(-2.81pt,-1.83pt) rotate(-90deg) ;">
<p id="S4.T2.4.1.1.16.1.1" class="ltx_p">sky</p>
</span></div>
</td>
<td id="S4.T2.4.1.1.17" class="ltx_td ltx_align_center ltx_border_tt">
<div id="S4.T2.4.1.1.17.1" class="ltx_inline-block ltx_transformed_outer" style="width:6.2pt;height:28.7pt;vertical-align:-0.0pt;"><span class="ltx_transformed_inner" style="width:28.7pt;transform:translate(-11.22pt,-10.25pt) rotate(-90deg) ;">
<p id="S4.T2.4.1.1.17.1.1" class="ltx_p">person</p>
</span></div>
</td>
<td id="S4.T2.4.1.1.18" class="ltx_td ltx_align_center ltx_border_tt">
<div id="S4.T2.4.1.1.18.1" class="ltx_inline-block ltx_transformed_outer" style="width:6.9pt;height:20.6pt;vertical-align:-0.0pt;"><span class="ltx_transformed_inner" style="width:20.6pt;transform:translate(-6.83pt,-6.83pt) rotate(-90deg) ;">
<p id="S4.T2.4.1.1.18.1.1" class="ltx_p">rider</p>
</span></div>
</td>
<td id="S4.T2.4.1.1.19" class="ltx_td ltx_align_center ltx_border_tt">
<div id="S4.T2.4.1.1.19.1" class="ltx_inline-block ltx_transformed_outer" style="width:4.3pt;height:13.4pt;vertical-align:-0.0pt;"><span class="ltx_transformed_inner" style="width:13.4pt;transform:translate(-4.53pt,-4.53pt) rotate(-90deg) ;">
<p id="S4.T2.4.1.1.19.1.1" class="ltx_p">car</p>
</span></div>
</td>
<td id="S4.T2.4.1.1.20" class="ltx_td ltx_align_center ltx_border_tt">
<div id="S4.T2.4.1.1.20.1" class="ltx_inline-block ltx_transformed_outer" style="width:6.9pt;height:22.8pt;vertical-align:-0.0pt;"><span class="ltx_transformed_inner" style="width:22.8pt;transform:translate(-7.93pt,-7.93pt) rotate(-90deg) ;">
<p id="S4.T2.4.1.1.20.1.1" class="ltx_p">truck</p>
</span></div>
</td>
<td id="S4.T2.4.1.1.21" class="ltx_td ltx_align_center ltx_border_tt">
<div id="S4.T2.4.1.1.21.1" class="ltx_inline-block ltx_transformed_outer" style="width:6.9pt;height:15.1pt;vertical-align:-0.0pt;"><span class="ltx_transformed_inner" style="width:15.1pt;transform:translate(-4.06pt,-4.06pt) rotate(-90deg) ;">
<p id="S4.T2.4.1.1.21.1.1" class="ltx_p">bus</p>
</span></div>
</td>
<td id="S4.T2.4.1.1.22" class="ltx_td ltx_align_center ltx_border_tt">
<div id="S4.T2.4.1.1.22.1" class="ltx_inline-block ltx_transformed_outer" style="width:6.7pt;height:21.1pt;vertical-align:-0.0pt;"><span class="ltx_transformed_inner" style="width:21.1pt;transform:translate(-7.23pt,-7.23pt) rotate(-90deg) ;">
<p id="S4.T2.4.1.1.22.1.1" class="ltx_p">train</p>
</span></div>
</td>
<td id="S4.T2.4.1.1.23" class="ltx_td ltx_align_center ltx_border_tt">
<div id="S4.T2.4.1.1.23.1" class="ltx_inline-block ltx_transformed_outer" style="width:8.9pt;height:47.5pt;vertical-align:-0.0pt;"><span class="ltx_transformed_inner" style="width:47.5pt;transform:translate(-19.32pt,-18.35pt) rotate(-90deg) ;">
<p id="S4.T2.4.1.1.23.1.1" class="ltx_p">motorcycle</p>
</span></div>
</td>
<td id="S4.T2.4.1.1.24" class="ltx_td ltx_align_center ltx_border_r ltx_border_tt">
<div id="S4.T2.4.1.1.24.1" class="ltx_inline-block ltx_transformed_outer" style="width:8.9pt;height:29.7pt;vertical-align:-0.0pt;"><span class="ltx_transformed_inner" style="width:29.7pt;transform:translate(-10.42pt,-9.44pt) rotate(-90deg) ;">
<p id="S4.T2.4.1.1.24.1.1" class="ltx_p">bicycle</p>
</span></div>
</td>
<td id="S4.T2.4.1.1.25" class="ltx_td ltx_align_center ltx_border_tt">
<div id="S4.T2.4.1.1.25.1" class="ltx_inline-block ltx_transformed_outer" style="width:6.9pt;height:13.1pt;vertical-align:-0.0pt;"><span class="ltx_transformed_inner" style="width:13.1pt;transform:translate(-3.06pt,-3.06pt) rotate(-90deg) ;">
<p id="S4.T2.4.1.1.25.1.1" class="ltx_p">All</p>
</span></div>
</td>
</tr>
<tr id="S4.T2.4.1.2" class="ltx_tr">
<td id="S4.T2.4.1.2.1" class="ltx_td ltx_border_t"></td>
<td id="S4.T2.4.1.2.2" class="ltx_td ltx_border_t"></td>
<td id="S4.T2.4.1.2.3" class="ltx_td ltx_border_t"></td>
<td id="S4.T2.4.1.2.4" class="ltx_td ltx_border_t"></td>
<td id="S4.T2.4.1.2.5" class="ltx_td ltx_border_r ltx_border_t"></td>
<td id="S4.T2.4.1.2.6" class="ltx_td ltx_align_center ltx_border_t">35.4</td>
<td id="S4.T2.4.1.2.7" class="ltx_td ltx_align_center ltx_border_t">5.7</td>
<td id="S4.T2.4.1.2.8" class="ltx_td ltx_align_center ltx_border_t">55.8</td>
<td id="S4.T2.4.1.2.9" class="ltx_td ltx_align_center ltx_border_t">4.6</td>
<td id="S4.T2.4.1.2.10" class="ltx_td ltx_align_center ltx_border_t">4.2</td>
<td id="S4.T2.4.1.2.11" class="ltx_td ltx_align_center ltx_border_t">14.2</td>
<td id="S4.T2.4.1.2.12" class="ltx_td ltx_align_center ltx_border_t">13.3</td>
<td id="S4.T2.4.1.2.13" class="ltx_td ltx_align_center ltx_border_t">10.9</td>
<td id="S4.T2.4.1.2.14" class="ltx_td ltx_align_center ltx_border_t">61.9</td>
<td id="S4.T2.4.1.2.15" class="ltx_td ltx_align_center ltx_border_t">6.3</td>
<td id="S4.T2.4.1.2.16" class="ltx_td ltx_align_center ltx_border_t">43.7</td>
<td id="S4.T2.4.1.2.17" class="ltx_td ltx_align_center ltx_border_t">26.0</td>
<td id="S4.T2.4.1.2.18" class="ltx_td ltx_align_center ltx_border_t">17.2</td>
<td id="S4.T2.4.1.2.19" class="ltx_td ltx_align_center ltx_border_t">11.1</td>
<td id="S4.T2.4.1.2.20" class="ltx_td ltx_align_center ltx_border_t">3.3</td>
<td id="S4.T2.4.1.2.21" class="ltx_td ltx_align_center ltx_border_t">3.8</td>
<td id="S4.T2.4.1.2.22" class="ltx_td ltx_align_center ltx_border_t">1.4</td>
<td id="S4.T2.4.1.2.23" class="ltx_td ltx_align_center ltx_border_t">8.9</td>
<td id="S4.T2.4.1.2.24" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">10.7</td>
<td id="S4.T2.4.1.2.25" class="ltx_td ltx_align_center ltx_border_t">22.7</td>
</tr>
<tr id="S4.T2.4.1.3" class="ltx_tr">
<td id="S4.T2.4.1.3.1" class="ltx_td ltx_align_center">✓</td>
<td id="S4.T2.4.1.3.2" class="ltx_td"></td>
<td id="S4.T2.4.1.3.3" class="ltx_td"></td>
<td id="S4.T2.4.1.3.4" class="ltx_td"></td>
<td id="S4.T2.4.1.3.5" class="ltx_td ltx_border_r"></td>
<td id="S4.T2.4.1.3.6" class="ltx_td ltx_align_center">43.7</td>
<td id="S4.T2.4.1.3.7" class="ltx_td ltx_align_center">22.0</td>
<td id="S4.T2.4.1.3.8" class="ltx_td ltx_align_center">57.2</td>
<td id="S4.T2.4.1.3.9" class="ltx_td ltx_align_center">6.6</td>
<td id="S4.T2.4.1.3.10" class="ltx_td ltx_align_center">4.7</td>
<td id="S4.T2.4.1.3.11" class="ltx_td ltx_align_center">15.8</td>
<td id="S4.T2.4.1.3.12" class="ltx_td ltx_align_center">9.8</td>
<td id="S4.T2.4.1.3.13" class="ltx_td ltx_align_center">13.9</td>
<td id="S4.T2.4.1.3.14" class="ltx_td ltx_align_center">50.2</td>
<td id="S4.T2.4.1.3.15" class="ltx_td ltx_align_center">5.7</td>
<td id="S4.T2.4.1.3.16" class="ltx_td ltx_align_center">68.4</td>
<td id="S4.T2.4.1.3.17" class="ltx_td ltx_align_center">24.3</td>
<td id="S4.T2.4.1.3.18" class="ltx_td ltx_align_center">11.4</td>
<td id="S4.T2.4.1.3.19" class="ltx_td ltx_align_center">34.6</td>
<td id="S4.T2.4.1.3.20" class="ltx_td ltx_align_center">8.9</td>
<td id="S4.T2.4.1.3.21" class="ltx_td ltx_align_center">4.7</td>
<td id="S4.T2.4.1.3.22" class="ltx_td ltx_align_center">3.5</td>
<td id="S4.T2.4.1.3.23" class="ltx_td ltx_align_center">16.0</td>
<td id="S4.T2.4.1.3.24" class="ltx_td ltx_align_center ltx_border_r">14.9</td>
<td id="S4.T2.4.1.3.25" class="ltx_td ltx_align_center">26.1</td>
</tr>
<tr id="S4.T2.4.1.4" class="ltx_tr">
<td id="S4.T2.4.1.4.1" class="ltx_td ltx_align_center">✓</td>
<td id="S4.T2.4.1.4.2" class="ltx_td ltx_align_center">✓</td>
<td id="S4.T2.4.1.4.3" class="ltx_td"></td>
<td id="S4.T2.4.1.4.4" class="ltx_td"></td>
<td id="S4.T2.4.1.4.5" class="ltx_td ltx_border_r"></td>
<td id="S4.T2.4.1.4.6" class="ltx_td ltx_align_center">43.9</td>
<td id="S4.T2.4.1.4.7" class="ltx_td ltx_align_center">23.2</td>
<td id="S4.T2.4.1.4.8" class="ltx_td ltx_align_center">59.2</td>
<td id="S4.T2.4.1.4.9" class="ltx_td ltx_align_center">7.1</td>
<td id="S4.T2.4.1.4.10" class="ltx_td ltx_align_center">5.9</td>
<td id="S4.T2.4.1.4.11" class="ltx_td ltx_align_center">16.2</td>
<td id="S4.T2.4.1.4.12" class="ltx_td ltx_align_center">11.1</td>
<td id="S4.T2.4.1.4.13" class="ltx_td ltx_align_center">14.8</td>
<td id="S4.T2.4.1.4.14" class="ltx_td ltx_align_center">55.3</td>
<td id="S4.T2.4.1.4.15" class="ltx_td ltx_align_center">6.1</td>
<td id="S4.T2.4.1.4.16" class="ltx_td ltx_align_center">58.5</td>
<td id="S4.T2.4.1.4.17" class="ltx_td ltx_align_center">26.0</td>
<td id="S4.T2.4.1.4.18" class="ltx_td ltx_align_center">11.9</td>
<td id="S4.T2.4.1.4.19" class="ltx_td ltx_align_center">34.2</td>
<td id="S4.T2.4.1.4.20" class="ltx_td ltx_align_center">9.2</td>
<td id="S4.T2.4.1.4.21" class="ltx_td ltx_align_center">4.3</td>
<td id="S4.T2.4.1.4.22" class="ltx_td ltx_align_center">3.0</td>
<td id="S4.T2.4.1.4.23" class="ltx_td ltx_align_center">15.8</td>
<td id="S4.T2.4.1.4.24" class="ltx_td ltx_align_center ltx_border_r">13.5</td>
<td id="S4.T2.4.1.4.25" class="ltx_td ltx_align_center">26.6</td>
</tr>
<tr id="S4.T2.4.1.5" class="ltx_tr">
<td id="S4.T2.4.1.5.1" class="ltx_td ltx_align_center">✓</td>
<td id="S4.T2.4.1.5.2" class="ltx_td ltx_align_center">✓</td>
<td id="S4.T2.4.1.5.3" class="ltx_td"></td>
<td id="S4.T2.4.1.5.4" class="ltx_td"></td>
<td id="S4.T2.4.1.5.5" class="ltx_td ltx_align_center ltx_border_r">✓</td>
<td id="S4.T2.4.1.5.6" class="ltx_td ltx_align_center">43.8</td>
<td id="S4.T2.4.1.5.7" class="ltx_td ltx_align_center">23.6</td>
<td id="S4.T2.4.1.5.8" class="ltx_td ltx_align_center">59.7</td>
<td id="S4.T2.4.1.5.9" class="ltx_td ltx_align_center">6.9</td>
<td id="S4.T2.4.1.5.10" class="ltx_td ltx_align_center">5.9</td>
<td id="S4.T2.4.1.5.11" class="ltx_td ltx_align_center">15.9</td>
<td id="S4.T2.4.1.5.12" class="ltx_td ltx_align_center">10.7</td>
<td id="S4.T2.4.1.5.13" class="ltx_td ltx_align_center">14.8</td>
<td id="S4.T2.4.1.5.14" class="ltx_td ltx_align_center">56.5</td>
<td id="S4.T2.4.1.5.15" class="ltx_td ltx_align_center">5.1</td>
<td id="S4.T2.4.1.5.16" class="ltx_td ltx_align_center">60.6</td>
<td id="S4.T2.4.1.5.17" class="ltx_td ltx_align_center">25.4</td>
<td id="S4.T2.4.1.5.18" class="ltx_td ltx_align_center">11.9</td>
<td id="S4.T2.4.1.5.19" class="ltx_td ltx_align_center">37.7</td>
<td id="S4.T2.4.1.5.20" class="ltx_td ltx_align_center">9.0</td>
<td id="S4.T2.4.1.5.21" class="ltx_td ltx_align_center">4.5</td>
<td id="S4.T2.4.1.5.22" class="ltx_td ltx_align_center">2.8</td>
<td id="S4.T2.4.1.5.23" class="ltx_td ltx_align_center">15.1</td>
<td id="S4.T2.4.1.5.24" class="ltx_td ltx_align_center ltx_border_r">13.0</td>
<td id="S4.T2.4.1.5.25" class="ltx_td ltx_align_center">26.9</td>
</tr>
<tr id="S4.T2.4.1.6" class="ltx_tr">
<td id="S4.T2.4.1.6.1" class="ltx_td ltx_align_center">✓</td>
<td id="S4.T2.4.1.6.2" class="ltx_td ltx_align_center">✓</td>
<td id="S4.T2.4.1.6.3" class="ltx_td"></td>
<td id="S4.T2.4.1.6.4" class="ltx_td ltx_align_center">✓</td>
<td id="S4.T2.4.1.6.5" class="ltx_td ltx_border_r"></td>
<td id="S4.T2.4.1.6.6" class="ltx_td ltx_align_center">46.8</td>
<td id="S4.T2.4.1.6.7" class="ltx_td ltx_align_center">22.4</td>
<td id="S4.T2.4.1.6.8" class="ltx_td ltx_align_center">59.9</td>
<td id="S4.T2.4.1.6.9" class="ltx_td ltx_align_center">7.4</td>
<td id="S4.T2.4.1.6.10" class="ltx_td ltx_align_center">6.7</td>
<td id="S4.T2.4.1.6.11" class="ltx_td ltx_align_center">17.6</td>
<td id="S4.T2.4.1.6.12" class="ltx_td ltx_align_center">17.0</td>
<td id="S4.T2.4.1.6.13" class="ltx_td ltx_align_center">22.4</td>
<td id="S4.T2.4.1.6.14" class="ltx_td ltx_align_center">56.6</td>
<td id="S4.T2.4.1.6.15" class="ltx_td ltx_align_center">7.1</td>
<td id="S4.T2.4.1.6.16" class="ltx_td ltx_align_center">62.6</td>
<td id="S4.T2.4.1.6.17" class="ltx_td ltx_align_center">25.4</td>
<td id="S4.T2.4.1.6.18" class="ltx_td ltx_align_center">10.5</td>
<td id="S4.T2.4.1.6.19" class="ltx_td ltx_align_center">35.5</td>
<td id="S4.T2.4.1.6.20" class="ltx_td ltx_align_center">9.5</td>
<td id="S4.T2.4.1.6.21" class="ltx_td ltx_align_center">6.9</td>
<td id="S4.T2.4.1.6.22" class="ltx_td ltx_align_center">3.7</td>
<td id="S4.T2.4.1.6.23" class="ltx_td ltx_align_center">16.6</td>
<td id="S4.T2.4.1.6.24" class="ltx_td ltx_align_center ltx_border_r">25.7</td>
<td id="S4.T2.4.1.6.25" class="ltx_td ltx_align_center">28.5</td>
</tr>
<tr id="S4.T2.4.1.7" class="ltx_tr">
<td id="S4.T2.4.1.7.1" class="ltx_td ltx_align_center ltx_border_bb">✓</td>
<td id="S4.T2.4.1.7.2" class="ltx_td ltx_align_center ltx_border_bb">✓</td>
<td id="S4.T2.4.1.7.3" class="ltx_td ltx_border_bb"></td>
<td id="S4.T2.4.1.7.4" class="ltx_td ltx_align_center ltx_border_bb">✓</td>
<td id="S4.T2.4.1.7.5" class="ltx_td ltx_align_center ltx_border_bb ltx_border_r">✓</td>
<td id="S4.T2.4.1.7.6" class="ltx_td ltx_align_center ltx_border_bb">47.2</td>
<td id="S4.T2.4.1.7.7" class="ltx_td ltx_align_center ltx_border_bb">22.7</td>
<td id="S4.T2.4.1.7.8" class="ltx_td ltx_align_center ltx_border_bb">60.6</td>
<td id="S4.T2.4.1.7.9" class="ltx_td ltx_align_center ltx_border_bb">7.0</td>
<td id="S4.T2.4.1.7.10" class="ltx_td ltx_align_center ltx_border_bb">6.7</td>
<td id="S4.T2.4.1.7.11" class="ltx_td ltx_align_center ltx_border_bb">17.3</td>
<td id="S4.T2.4.1.7.12" class="ltx_td ltx_align_center ltx_border_bb">16.8</td>
<td id="S4.T2.4.1.7.13" class="ltx_td ltx_align_center ltx_border_bb">22.7</td>
<td id="S4.T2.4.1.7.14" class="ltx_td ltx_align_center ltx_border_bb">57.7</td>
<td id="S4.T2.4.1.7.15" class="ltx_td ltx_align_center ltx_border_bb">5.9</td>
<td id="S4.T2.4.1.7.16" class="ltx_td ltx_align_center ltx_border_bb">64.9</td>
<td id="S4.T2.4.1.7.17" class="ltx_td ltx_align_center ltx_border_bb">25.4</td>
<td id="S4.T2.4.1.7.18" class="ltx_td ltx_align_center ltx_border_bb">10.6</td>
<td id="S4.T2.4.1.7.19" class="ltx_td ltx_align_center ltx_border_bb">36.9</td>
<td id="S4.T2.4.1.7.20" class="ltx_td ltx_align_center ltx_border_bb">9.3</td>
<td id="S4.T2.4.1.7.21" class="ltx_td ltx_align_center ltx_border_bb">6.8</td>
<td id="S4.T2.4.1.7.22" class="ltx_td ltx_align_center ltx_border_bb">3.5</td>
<td id="S4.T2.4.1.7.23" class="ltx_td ltx_align_center ltx_border_bb">16.8</td>
<td id="S4.T2.4.1.7.24" class="ltx_td ltx_align_center ltx_border_bb ltx_border_r">25.5</td>
<td id="S4.T2.4.1.7.25" class="ltx_td ltx_align_center ltx_border_bb">29.0</td>
</tr>
</table>
</span></div>
</figure>
</section>
<section id="S5a" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">S5 </span>Qualitative Results</h2>

<div id="S5a.p1" class="ltx_para">
<p id="S5a.p1.1" class="ltx_p">Fig. <a href="#S5.F7" title="Figure S7 ‣ S5 Qualitative Results ‣ When Cars meet Drones: Hyperbolic Federated Learning for Source-Free Domain Adaptation in Adverse Weather" class="ltx_ref"><span class="ltx_text ltx_ref_tag">S7</span></a> shows some qualitative results for car and drone samples in both clear and adverse weather.
FedAvg <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib27" title="" class="ltx_ref">27</a>]</cite> and LADD <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib37" title="" class="ltx_ref">37</a>]</cite> appear to be overconfident on the road and car classes, respectively.
While our model adeptly captures the structure of the street better than other models in both adverse and non-adverse conditions, the adverse conditions images remain a challenging aspect. For drones, the discrepancies between the predicted classes and the ground truth arise also due to the fact that the network is trained on a superset of classes beyond those present in the drone dataset. Notice that sometimes the network assigns “fine” classes that share a semantic affiliation with the respective “coarse” classes, e.g., predict terrain instead of vegetation, but on the drone dataset labeling terrain is not present and terrain samples have ground truth set to vegetation.
The same thing happens for the sidewalk and road or rider and person.
For this reason, we remapped the 19 classes of the full set into the 5 drone ones using the mapping proposed in <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib32" title="" class="ltx_ref">32</a>]</cite>. The figure shows both the original prediction maps from the network and the ones obtained after remapping the 19 classes into the 5 of the drone datasets.
The comparison with the ground truth shows that some predictions not matching are just due to the different types of labeling in drone and car datasets.</p>
</div>
<figure id="S5.F7" class="ltx_figure">
<div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_1">
<div id="S5.F7.26" class="ltx_inline-block ltx_figure_panel ltx_align_center ltx_transformed_outer" style="width:433.6pt;height:224.7pt;vertical-align:-0.7pt;"><span class="ltx_transformed_inner" style="transform:translate(-78.4pt,40.5pt) scale(0.734372908406893,0.734372908406893) ;">
<table id="S5.F7.26.26" class="ltx_tabular ltx_align_middle">
<tr id="S5.F7.26.26.27" class="ltx_tr">
<td id="S5.F7.26.26.27.1" class="ltx_td"></td>
<td id="S5.F7.26.26.27.2" class="ltx_td ltx_align_center"><span id="S5.F7.26.26.27.2.1" class="ltx_text ltx_font_bold">RGB</span></td>
<td id="S5.F7.26.26.27.3" class="ltx_td ltx_align_center"><span id="S5.F7.26.26.27.3.1" class="ltx_text ltx_font_bold">GT</span></td>
<td id="S5.F7.26.26.27.4" class="ltx_td ltx_align_center"><span id="S5.F7.26.26.27.4.1" class="ltx_text ltx_font_bold">FedAvg<cite class="ltx_cite ltx_citemacro_cite"><span id="S5.F7.26.26.27.4.1.1.1" class="ltx_text ltx_font_medium">[</span><a href="#bib.bib27" title="" class="ltx_ref">27</a><span id="S5.F7.26.26.27.4.1.2.2" class="ltx_text ltx_font_medium">]</span></cite>+ST</span></td>
<td id="S5.F7.26.26.27.5" class="ltx_td ltx_align_center"><span id="S5.F7.26.26.27.5.1" class="ltx_text ltx_font_bold">LADD<cite class="ltx_cite ltx_citemacro_cite"><span id="S5.F7.26.26.27.5.1.1.1" class="ltx_text ltx_font_medium">[</span><a href="#bib.bib37" title="" class="ltx_ref">37</a><span id="S5.F7.26.26.27.5.1.2.2" class="ltx_text ltx_font_medium">]</span></cite></span></td>
<td id="S5.F7.26.26.27.6" class="ltx_td ltx_align_center"><span id="S5.F7.26.26.27.6.1" class="ltx_text ltx_font_bold">HyperFLAW</span></td>
</tr>
<tr id="S5.F7.5.5.5" class="ltx_tr">
<td id="S5.F7.5.5.5.6" class="ltx_td ltx_align_center">
<span id="S5.F7.5.5.5.6.1" class="ltx_text"></span> <span id="S5.F7.5.5.5.6.2" class="ltx_text">
<span id="S5.F7.5.5.5.6.2.1" class="ltx_tabular ltx_align_middle">
<span id="S5.F7.5.5.5.6.2.1.1" class="ltx_tr">
<span id="S5.F7.5.5.5.6.2.1.1.1" class="ltx_td ltx_nopad_r ltx_align_center"><span id="S5.F7.5.5.5.6.2.1.1.1.1" class="ltx_text ltx_font_bold">CAR</span></span></span>
<span id="S5.F7.5.5.5.6.2.1.2" class="ltx_tr">
<span id="S5.F7.5.5.5.6.2.1.2.1" class="ltx_td ltx_nopad_r ltx_align_center"><span id="S5.F7.5.5.5.6.2.1.2.1.1" class="ltx_text ltx_font_bold">CLEAR</span></span></span>
</span></span><span id="S5.F7.5.5.5.6.3" class="ltx_text"></span></td>
<td id="S5.F7.1.1.1.1" class="ltx_td ltx_align_center"><img src="/html/2403.13762/assets/figs/suppl/quali/car_clear_374_RGB.jpg" id="S5.F7.1.1.1.1.g1" class="ltx_graphics ltx_img_landscape" width="90" height="45" alt="Refer to caption"></td>
<td id="S5.F7.2.2.2.2" class="ltx_td ltx_align_center"><img src="/html/2403.13762/assets/figs/suppl/quali/car_clear_374_GT.png" id="S5.F7.2.2.2.2.g1" class="ltx_graphics ltx_img_landscape" width="90" height="45" alt="Refer to caption"></td>
<td id="S5.F7.3.3.3.3" class="ltx_td ltx_align_center"><img src="/html/2403.13762/assets/figs/suppl/quali/car_clear_374_PRED_FedAvg.png" id="S5.F7.3.3.3.3.g1" class="ltx_graphics ltx_img_landscape" width="90" height="45" alt="Refer to caption"></td>
<td id="S5.F7.4.4.4.4" class="ltx_td ltx_align_center"><img src="/html/2403.13762/assets/figs/suppl/quali/car_clear_374_PRED_LADD.png" id="S5.F7.4.4.4.4.g1" class="ltx_graphics ltx_img_landscape" width="90" height="45" alt="Refer to caption"></td>
<td id="S5.F7.5.5.5.5" class="ltx_td ltx_align_center"><img src="/html/2403.13762/assets/figs/suppl/quali/car_clear_374_PRED.png" id="S5.F7.5.5.5.5.g1" class="ltx_graphics ltx_img_landscape" width="90" height="45" alt="Refer to caption"></td>
</tr>
<tr id="S5.F7.10.10.10" class="ltx_tr">
<td id="S5.F7.10.10.10.6" class="ltx_td ltx_align_center">
<span id="S5.F7.10.10.10.6.1" class="ltx_text"></span> <span id="S5.F7.10.10.10.6.2" class="ltx_text">
<span id="S5.F7.10.10.10.6.2.1" class="ltx_tabular ltx_align_middle">
<span id="S5.F7.10.10.10.6.2.1.1" class="ltx_tr">
<span id="S5.F7.10.10.10.6.2.1.1.1" class="ltx_td ltx_nopad_r ltx_align_center"><span id="S5.F7.10.10.10.6.2.1.1.1.1" class="ltx_text ltx_font_bold">DRONE</span></span></span>
<span id="S5.F7.10.10.10.6.2.1.2" class="ltx_tr">
<span id="S5.F7.10.10.10.6.2.1.2.1" class="ltx_td ltx_nopad_r ltx_align_center"><span id="S5.F7.10.10.10.6.2.1.2.1.1" class="ltx_text ltx_font_bold">CLEAR</span></span></span>
</span></span><span id="S5.F7.10.10.10.6.3" class="ltx_text"></span></td>
<td id="S5.F7.6.6.6.1" class="ltx_td ltx_align_center ltx_align_middle" rowspan="2"><span id="S5.F7.6.6.6.1.1" class="ltx_text"><img src="/html/2403.13762/assets/x9.jpg" id="S5.F7.6.6.6.1.1.g1" class="ltx_graphics ltx_img_landscape" width="100" height="56" alt="Refer to caption"></span></td>
<td id="S5.F7.7.7.7.2" class="ltx_td ltx_align_center ltx_align_middle" rowspan="2"><span id="S5.F7.7.7.7.2.1" class="ltx_text"><img src="/html/2403.13762/assets/x10.png" id="S5.F7.7.7.7.2.1.g1" class="ltx_graphics ltx_img_landscape" width="100" height="56" alt="Refer to caption"></span></td>
<td id="S5.F7.8.8.8.3" class="ltx_td ltx_align_center"><img src="/html/2403.13762/assets/figs/suppl/quali/drone_clear_45_PRED_FedAvg.png" id="S5.F7.8.8.8.3.g1" class="ltx_graphics ltx_img_landscape" width="90" height="51" alt="Refer to caption"></td>
<td id="S5.F7.9.9.9.4" class="ltx_td ltx_align_center"><img src="/html/2403.13762/assets/figs/suppl/quali/drone_clear_45_PRED_LADD.png" id="S5.F7.9.9.9.4.g1" class="ltx_graphics ltx_img_landscape" width="90" height="51" alt="Refer to caption"></td>
<td id="S5.F7.10.10.10.5" class="ltx_td ltx_align_center"><img src="/html/2403.13762/assets/figs/suppl/quali/drone_clear_45_PRED.png" id="S5.F7.10.10.10.5.g1" class="ltx_graphics ltx_img_landscape" width="90" height="51" alt="Refer to caption"></td>
</tr>
<tr id="S5.F7.13.13.13" class="ltx_tr">
<td id="S5.F7.13.13.13.4" class="ltx_td ltx_align_center">
<span id="S5.F7.13.13.13.4.1" class="ltx_text"></span> <span id="S5.F7.13.13.13.4.2" class="ltx_text">
<span id="S5.F7.13.13.13.4.2.1" class="ltx_tabular ltx_align_middle">
<span id="S5.F7.13.13.13.4.2.1.1" class="ltx_tr">
<span id="S5.F7.13.13.13.4.2.1.1.1" class="ltx_td ltx_nopad_r ltx_align_center"><span id="S5.F7.13.13.13.4.2.1.1.1.1" class="ltx_text ltx_font_bold">DRONE</span></span></span>
<span id="S5.F7.13.13.13.4.2.1.2" class="ltx_tr">
<span id="S5.F7.13.13.13.4.2.1.2.1" class="ltx_td ltx_nopad_r ltx_align_center"><span id="S5.F7.13.13.13.4.2.1.2.1.1" class="ltx_text ltx_font_bold">CLEAR</span></span></span>
<span id="S5.F7.13.13.13.4.2.1.3" class="ltx_tr">
<span id="S5.F7.13.13.13.4.2.1.3.1" class="ltx_td ltx_nopad_r ltx_align_center">(remapped)</span></span>
</span></span><span id="S5.F7.13.13.13.4.3" class="ltx_text"></span></td>
<td id="S5.F7.11.11.11.1" class="ltx_td ltx_align_center"><img src="/html/2403.13762/assets/figs/suppl/quali/drone_clear_45_PRED_FedAvg_remapped.png" id="S5.F7.11.11.11.1.g1" class="ltx_graphics ltx_img_landscape" width="90" height="51" alt="Refer to caption"></td>
<td id="S5.F7.12.12.12.2" class="ltx_td ltx_align_center"><img src="/html/2403.13762/assets/figs/suppl/quali/drone_clear_45_PRED_LADD_remapped.png" id="S5.F7.12.12.12.2.g1" class="ltx_graphics ltx_img_landscape" width="90" height="51" alt="Refer to caption"></td>
<td id="S5.F7.13.13.13.3" class="ltx_td ltx_align_center"><img src="/html/2403.13762/assets/figs/suppl/quali/drone_clear_45_PRED_remapped.png" id="S5.F7.13.13.13.3.g1" class="ltx_graphics ltx_img_landscape" width="90" height="51" alt="Refer to caption"></td>
</tr>
<tr id="S5.F7.18.18.18" class="ltx_tr">
<td id="S5.F7.18.18.18.6" class="ltx_td ltx_align_center">
<span id="S5.F7.18.18.18.6.1" class="ltx_text"></span> <span id="S5.F7.18.18.18.6.2" class="ltx_text">
<span id="S5.F7.18.18.18.6.2.1" class="ltx_tabular ltx_align_middle">
<span id="S5.F7.18.18.18.6.2.1.1" class="ltx_tr">
<span id="S5.F7.18.18.18.6.2.1.1.1" class="ltx_td ltx_nopad_r ltx_align_center"><span id="S5.F7.18.18.18.6.2.1.1.1.1" class="ltx_text ltx_font_bold">CAR</span></span></span>
<span id="S5.F7.18.18.18.6.2.1.2" class="ltx_tr">
<span id="S5.F7.18.18.18.6.2.1.2.1" class="ltx_td ltx_nopad_r ltx_align_center"><span id="S5.F7.18.18.18.6.2.1.2.1.1" class="ltx_text ltx_font_bold">ADVERSE</span></span></span>
</span></span><span id="S5.F7.18.18.18.6.3" class="ltx_text"></span></td>
<td id="S5.F7.14.14.14.1" class="ltx_td ltx_align_center"><img src="/html/2403.13762/assets/figs/suppl/quali/car_rain_449_RGB.jpg" id="S5.F7.14.14.14.1.g1" class="ltx_graphics ltx_img_landscape" width="90" height="51" alt="Refer to caption"></td>
<td id="S5.F7.15.15.15.2" class="ltx_td ltx_align_center"><img src="/html/2403.13762/assets/figs/suppl/quali/car_rain_449_GT.png" id="S5.F7.15.15.15.2.g1" class="ltx_graphics ltx_img_landscape" width="90" height="51" alt="Refer to caption"></td>
<td id="S5.F7.16.16.16.3" class="ltx_td ltx_align_center"><img src="/html/2403.13762/assets/figs/suppl/quali/car_rain_449_PRED_FedAvg.png" id="S5.F7.16.16.16.3.g1" class="ltx_graphics ltx_img_landscape" width="90" height="51" alt="Refer to caption"></td>
<td id="S5.F7.17.17.17.4" class="ltx_td ltx_align_center"><img src="/html/2403.13762/assets/figs/suppl/quali/car_rain_449_PRED_LADD.png" id="S5.F7.17.17.17.4.g1" class="ltx_graphics ltx_img_landscape" width="90" height="51" alt="Refer to caption"></td>
<td id="S5.F7.18.18.18.5" class="ltx_td ltx_align_center"><img src="/html/2403.13762/assets/figs/suppl/quali/car_rain_449_PRED.png" id="S5.F7.18.18.18.5.g1" class="ltx_graphics ltx_img_landscape" width="90" height="51" alt="Refer to caption"></td>
</tr>
<tr id="S5.F7.23.23.23" class="ltx_tr">
<td id="S5.F7.23.23.23.6" class="ltx_td ltx_align_center">
<span id="S5.F7.23.23.23.6.1" class="ltx_text"></span> <span id="S5.F7.23.23.23.6.2" class="ltx_text">
<span id="S5.F7.23.23.23.6.2.1" class="ltx_tabular ltx_align_middle">
<span id="S5.F7.23.23.23.6.2.1.1" class="ltx_tr">
<span id="S5.F7.23.23.23.6.2.1.1.1" class="ltx_td ltx_nopad_r ltx_align_center"><span id="S5.F7.23.23.23.6.2.1.1.1.1" class="ltx_text ltx_font_bold">DRONE</span></span></span>
<span id="S5.F7.23.23.23.6.2.1.2" class="ltx_tr">
<span id="S5.F7.23.23.23.6.2.1.2.1" class="ltx_td ltx_nopad_r ltx_align_center"><span id="S5.F7.23.23.23.6.2.1.2.1.1" class="ltx_text ltx_font_bold">ADVERSE</span></span></span>
</span></span><span id="S5.F7.23.23.23.6.3" class="ltx_text"></span></td>
<td id="S5.F7.19.19.19.1" class="ltx_td ltx_align_center ltx_align_middle" rowspan="2"><span id="S5.F7.19.19.19.1.1" class="ltx_text"><img src="/html/2403.13762/assets/x11.jpg" id="S5.F7.19.19.19.1.1.g1" class="ltx_graphics ltx_img_landscape" width="100" height="56" alt="Refer to caption"></span></td>
<td id="S5.F7.20.20.20.2" class="ltx_td ltx_align_center ltx_align_middle" rowspan="2"><span id="S5.F7.20.20.20.2.1" class="ltx_text"><img src="/html/2403.13762/assets/x12.png" id="S5.F7.20.20.20.2.1.g1" class="ltx_graphics ltx_img_landscape" width="100" height="56" alt="Refer to caption"></span></td>
<td id="S5.F7.21.21.21.3" class="ltx_td ltx_align_center"><img src="/html/2403.13762/assets/figs/suppl/quali/drone_fog_0_PRED_FedAvg.png" id="S5.F7.21.21.21.3.g1" class="ltx_graphics ltx_img_landscape" width="90" height="51" alt="Refer to caption"></td>
<td id="S5.F7.22.22.22.4" class="ltx_td ltx_align_center"><img src="/html/2403.13762/assets/figs/suppl/quali/drone_fog_0_PRED_LADD.png" id="S5.F7.22.22.22.4.g1" class="ltx_graphics ltx_img_landscape" width="90" height="51" alt="Refer to caption"></td>
<td id="S5.F7.23.23.23.5" class="ltx_td ltx_align_center"><img src="/html/2403.13762/assets/figs/suppl/quali/drone_fog_0_PRED.png" id="S5.F7.23.23.23.5.g1" class="ltx_graphics ltx_img_landscape" width="90" height="51" alt="Refer to caption"></td>
</tr>
<tr id="S5.F7.26.26.26" class="ltx_tr">
<td id="S5.F7.26.26.26.4" class="ltx_td ltx_align_center">
<span id="S5.F7.26.26.26.4.1" class="ltx_text"></span> <span id="S5.F7.26.26.26.4.2" class="ltx_text">
<span id="S5.F7.26.26.26.4.2.1" class="ltx_tabular ltx_align_middle">
<span id="S5.F7.26.26.26.4.2.1.1" class="ltx_tr">
<span id="S5.F7.26.26.26.4.2.1.1.1" class="ltx_td ltx_nopad_r ltx_align_center"><span id="S5.F7.26.26.26.4.2.1.1.1.1" class="ltx_text ltx_font_bold">DRONE</span></span></span>
<span id="S5.F7.26.26.26.4.2.1.2" class="ltx_tr">
<span id="S5.F7.26.26.26.4.2.1.2.1" class="ltx_td ltx_nopad_r ltx_align_center"><span id="S5.F7.26.26.26.4.2.1.2.1.1" class="ltx_text ltx_font_bold">ADVERSE</span></span></span>
<span id="S5.F7.26.26.26.4.2.1.3" class="ltx_tr">
<span id="S5.F7.26.26.26.4.2.1.3.1" class="ltx_td ltx_nopad_r ltx_align_center">(remapped)</span></span>
</span></span><span id="S5.F7.26.26.26.4.3" class="ltx_text"></span></td>
<td id="S5.F7.24.24.24.1" class="ltx_td ltx_align_center"><img src="/html/2403.13762/assets/figs/suppl/quali/drone_fog_0_PRED_FedAvg_remapped.png" id="S5.F7.24.24.24.1.g1" class="ltx_graphics ltx_img_landscape" width="90" height="51" alt="Refer to caption"></td>
<td id="S5.F7.25.25.25.2" class="ltx_td ltx_align_center"><img src="/html/2403.13762/assets/figs/suppl/quali/drone_fog_0_PRED_LADD_remapped.png" id="S5.F7.25.25.25.2.g1" class="ltx_graphics ltx_img_landscape" width="90" height="51" alt="Refer to caption"></td>
<td id="S5.F7.26.26.26.3" class="ltx_td ltx_align_center"><img src="/html/2403.13762/assets/figs/suppl/quali/drone_fog_0_PRED_remapped.png" id="S5.F7.26.26.26.3.g1" class="ltx_graphics ltx_img_landscape" width="90" height="51" alt="Refer to caption"></td>
</tr>
</table>
</span></div>
</div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_1">
<div id="S5.F7.28" class="ltx_inline-block ltx_figure_panel ltx_align_center ltx_transformed_outer" style="width:433.6pt;height:32.9pt;vertical-align:-0.9pt;"><span class="ltx_transformed_inner" style="transform:translate(-27.0pt,2.0pt) scale(0.889374304083883,0.889374304083883) ;">
<table id="S5.F7.28.1" class="ltx_tabular ltx_align_middle">
<tr id="S5.F7.28.1.1" class="ltx_tr">
<td id="S5.F7.28.1.1.1" class="ltx_td ltx_align_center" style="background-color:#804080;"><span id="S5.F7.28.1.1.1.1" class="ltx_text" style="background-color:#804080;"><span id="S5.F7.28.1.1.1.1.1" class="ltx_text" style="color:#FFFFFF;">Road</span></span></td>
<td id="S5.F7.28.1.1.2" class="ltx_td ltx_align_center" style="background-color:#F423E8;"><span id="S5.F7.28.1.1.2.1" class="ltx_text" style="background-color:#F423E8;">Sidewalk</span></td>
<td id="S5.F7.28.1.1.3" class="ltx_td ltx_align_center" style="background-color:#464646;"><span id="S5.F7.28.1.1.3.1" class="ltx_text" style="background-color:#464646;"><span id="S5.F7.28.1.1.3.1.1" class="ltx_text" style="color:#FFFFFF;">Building</span></span></td>
<td id="S5.F7.28.1.1.4" class="ltx_td ltx_align_center" style="background-color:#66669C;"><span id="S5.F7.28.1.1.4.1" class="ltx_text" style="background-color:#66669C;"><span id="S5.F7.28.1.1.4.1.1" class="ltx_text" style="color:#FFFFFF;">Wall</span></span></td>
<td id="S5.F7.28.1.1.5" class="ltx_td ltx_align_center" style="background-color:#BE9999;"><span id="S5.F7.28.1.1.5.1" class="ltx_text" style="background-color:#BE9999;">Fence</span></td>
<td id="S5.F7.28.1.1.6" class="ltx_td ltx_align_center" style="background-color:#999999;"><span id="S5.F7.28.1.1.6.1" class="ltx_text" style="background-color:#999999;">Pole</span></td>
<td id="S5.F7.28.1.1.7" class="ltx_td ltx_align_center" style="background-color:#FAAA1E;"><span id="S5.F7.28.1.1.7.1" class="ltx_text" style="background-color:#FAAA1E;">T. Light</span></td>
<td id="S5.F7.28.1.1.8" class="ltx_td ltx_align_center" style="background-color:#DCDC00;"><span id="S5.F7.28.1.1.8.1" class="ltx_text" style="background-color:#DCDC00;">T. Sign</span></td>
<td id="S5.F7.28.1.1.9" class="ltx_td ltx_align_center" style="background-color:#6B8E23;"><span id="S5.F7.28.1.1.9.1" class="ltx_text" style="background-color:#6B8E23;"><span id="S5.F7.28.1.1.9.1.1" class="ltx_text" style="color:#FFFFFF;">Vegetation</span></span></td>
<td id="S5.F7.28.1.1.10" class="ltx_td ltx_align_center" style="background-color:#98FB98;"><span id="S5.F7.28.1.1.10.1" class="ltx_text" style="background-color:#98FB98;">Terrain</span></td>
</tr>
<tr id="S5.F7.28.1.2" class="ltx_tr">
<td id="S5.F7.28.1.2.1" class="ltx_td ltx_align_center" style="background-color:#0082B4;"><span id="S5.F7.28.1.2.1.1" class="ltx_text" style="background-color:#0082B4;">Sky</span></td>
<td id="S5.F7.28.1.2.2" class="ltx_td ltx_align_center" style="background-color:#DC143C;"><span id="S5.F7.28.1.2.2.1" class="ltx_text" style="background-color:#DC143C;"><span id="S5.F7.28.1.2.2.1.1" class="ltx_text" style="color:#FFFFFF;">Person</span></span></td>
<td id="S5.F7.28.1.2.3" class="ltx_td ltx_align_center" style="background-color:#FF0000;"><span id="S5.F7.28.1.2.3.1" class="ltx_text" style="background-color:#FF0000;"><span id="S5.F7.28.1.2.3.1.1" class="ltx_text" style="color:#FFFFFF;">Rider</span></span></td>
<td id="S5.F7.28.1.2.4" class="ltx_td ltx_align_center" style="background-color:#00008E;"><span id="S5.F7.28.1.2.4.1" class="ltx_text" style="background-color:#00008E;"><span id="S5.F7.28.1.2.4.1.1" class="ltx_text" style="color:#FFFFFF;">Car</span></span></td>
<td id="S5.F7.28.1.2.5" class="ltx_td ltx_align_center" style="background-color:#000046;"><span id="S5.F7.28.1.2.5.1" class="ltx_text" style="background-color:#000046;"><span id="S5.F7.28.1.2.5.1.1" class="ltx_text" style="color:#FFFFFF;">Truck</span></span></td>
<td id="S5.F7.28.1.2.6" class="ltx_td ltx_align_center" style="background-color:#003C64;"><span id="S5.F7.28.1.2.6.1" class="ltx_text" style="background-color:#003C64;"><span id="S5.F7.28.1.2.6.1.1" class="ltx_text" style="color:#FFFFFF;">Bus</span></span></td>
<td id="S5.F7.28.1.2.7" class="ltx_td ltx_align_center" style="background-color:#005064;"><span id="S5.F7.28.1.2.7.1" class="ltx_text" style="background-color:#005064;"><span id="S5.F7.28.1.2.7.1.1" class="ltx_text" style="color:#FFFFFF;">Train</span></span></td>
<td id="S5.F7.28.1.2.8" class="ltx_td ltx_align_center" style="background-color:#0000E6;"><span id="S5.F7.28.1.2.8.1" class="ltx_text" style="background-color:#0000E6;"><span id="S5.F7.28.1.2.8.1.1" class="ltx_text" style="color:#FFFFFF;">Motorbike</span></span></td>
<td id="S5.F7.28.1.2.9" class="ltx_td ltx_align_center" style="background-color:#770B20;"><span id="S5.F7.28.1.2.9.1" class="ltx_text" style="background-color:#770B20;"><span id="S5.F7.28.1.2.9.1.1" class="ltx_text" style="color:#FFFFFF;">Bicycle</span></span></td>
<td id="S5.F7.28.1.2.10" class="ltx_td ltx_align_center" style="background-color:#000000;"><span id="S5.F7.28.1.2.10.1" class="ltx_text" style="background-color:#000000;"><span id="S5.F7.28.1.2.10.1.1" class="ltx_text" style="color:#FFFFFF;">Unlabeled</span></span></td>
</tr>
</table>
</span></div>
</div>
</div>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span id="S5.F7.29.1.1" class="ltx_text" style="font-size:90%;">Figure S7</span>: </span><span id="S5.F7.30.2" class="ltx_text" style="font-size:90%;">Qualitative results.</span></figcaption>
</figure>
<div class="ltx_pagination ltx_role_newpage"></div>
</section>
</article>
</div>
<div class="ar5iv-footer"><a href="/html/2403.13761" class="ar5iv-nav-button ar5iv-nav-button-prev">◄</a>
    <a class="ar5iv-home-button" href="/"><img height="40" alt="ar5iv homepage" src="/assets/ar5iv.png"></a>
    <a href="/feeling_lucky" class="ar5iv-text-button">Feeling<br>lucky?</a>
    <a href="/log/2403.13762" class="ar5iv-text-button ar5iv-severity-error">Conversion<br>report</a>
    <a class="ar5iv-text-button" target="_blank" href="https://github.com/dginev/ar5iv/issues/new?template=improve-article--arxiv-id-.md&title=Improve+article+2403.13762">Report<br>an issue</a>
    <a href="https://arxiv.org/abs/2403.13762" class="ar5iv-text-button arxiv-ui-theme">View&nbsp;original<br>on&nbsp;arXiv</a><a href="/html/2403.13763" class="ar5iv-nav-button ar5iv-nav-button-next">►</a>
</div><footer class="ltx_page_footer">
<a class="ar5iv-toggle-color-scheme" href="javascript:toggleColorScheme()" title="Toggle ar5iv color scheme"><span class="color-scheme-icon"></span></a>
<a class="ar5iv-footer-button" href="https://arxiv.org/help/license" target="_blank">Copyright</a>
<a class="ar5iv-footer-button" href="https://arxiv.org/help/policies/privacy_policy" target="_blank">Privacy Policy</a>

<div class="ltx_page_logo">Generated  on Fri Apr  5 15:31:38 2024 by <a target="_blank" href="http://dlmf.nist.gov/LaTeXML/" class="ltx_LaTeXML_logo"><span style="letter-spacing:-0.2em; margin-right:0.1em;">L<span class="ltx_font_smallcaps" style="position:relative; bottom:2.2pt;">a</span>T<span class="ltx_font_smallcaps" style="font-size:120%;position:relative; bottom:-0.2ex;">e</span></span><span style="font-size:90%; position:relative; bottom:-0.2ex;">XML</span><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAsAAAAOCAYAAAD5YeaVAAAAAXNSR0IArs4c6QAAAAZiS0dEAP8A/wD/oL2nkwAAAAlwSFlzAAALEwAACxMBAJqcGAAAAAd0SU1FB9wKExQZLWTEaOUAAAAddEVYdENvbW1lbnQAQ3JlYXRlZCB3aXRoIFRoZSBHSU1Q72QlbgAAAdpJREFUKM9tkL+L2nAARz9fPZNCKFapUn8kyI0e4iRHSR1Kb8ng0lJw6FYHFwv2LwhOpcWxTjeUunYqOmqd6hEoRDhtDWdA8ApRYsSUCDHNt5ul13vz4w0vWCgUnnEc975arX6ORqN3VqtVZbfbTQC4uEHANM3jSqXymFI6yWazP2KxWAXAL9zCUa1Wy2tXVxheKA9YNoR8Pt+aTqe4FVVVvz05O6MBhqUIBGk8Hn8HAOVy+T+XLJfLS4ZhTiRJgqIoVBRFIoric47jPnmeB1mW/9rr9ZpSSn3Lsmir1fJZlqWlUonKsvwWwD8ymc/nXwVBeLjf7xEKhdBut9Hr9WgmkyGEkJwsy5eHG5vN5g0AKIoCAEgkEkin0wQAfN9/cXPdheu6P33fBwB4ngcAcByHJpPJl+fn54mD3Gg0NrquXxeLRQAAwzAYj8cwTZPwPH9/sVg8PXweDAauqqr2cDjEer1GJBLBZDJBs9mE4zjwfZ85lAGg2+06hmGgXq+j3+/DsixYlgVN03a9Xu8jgCNCyIegIAgx13Vfd7vdu+FweG8YRkjXdWy329+dTgeSJD3ieZ7RNO0VAXAPwDEAO5VKndi2fWrb9jWl9Esul6PZbDY9Go1OZ7PZ9z/lyuD3OozU2wAAAABJRU5ErkJggg==" alt="Mascot Sammy"></a>
</div></footer>
</div>

    <script>
      var canMathML = typeof(MathMLElement) == "function";
      if (!canMathML) {
        var body = document.querySelector("body");
        body.firstElementChild.setAttribute('style', 'opacity: 0;');
        var loading = document.createElement("div");
        loading.setAttribute("id", "mathjax-loading-spinner");
        var message = document.createElement("div");
        message.setAttribute("id", "mathjax-loading-message");
        message.innerText = "Typesetting Equations...";
        body.prepend(loading);
        body.prepend(message);

        var el = document.createElement("script");
        el.src = "https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js";
        document.querySelector("head").appendChild(el);

        window.MathJax = {
          startup: {
            pageReady: () => {
              return MathJax.startup.defaultPageReady().then(() => {
                body.removeChild(loading);
                body.removeChild(message);
                body.firstElementChild.removeAttribute('style');
              }); } } };
      }
    </script>
    <script>
    // Auxiliary function, building the preview feature when
    // an inline citation is clicked
    function clicked_cite(e) {
      e.preventDefault();
      let cite = this.closest('.ltx_cite');
      let next = cite.nextSibling;
      if (next && next.nodeType == Node.ELEMENT_NODE && next.getAttribute('class') == "ar5iv-bibitem-preview") {
        next.remove();
        return; }
      // Before adding a preview modal,
      // cleanup older previews, in case they're still open
      document.querySelectorAll('span.ar5iv-bibitem-preview').forEach(function(node) {
        node.remove();
      })

      // Create the preview
      preview = document.createElement('span');
      preview.setAttribute('class','ar5iv-bibitem-preview');
      let target = document.getElementById(this.getAttribute('href').slice(1));
      target.childNodes.forEach(function (child) {
        preview.append(child.cloneNode(true));
      });
      let close_x = document.createElement('button');
      close_x.setAttribute("aria-label","Close modal for bibliography item preview");
      close_x.textContent = "×";
      close_x.setAttribute('class', 'ar5iv-button-close-preview');
      close_x.setAttribute('onclick','this.parentNode.remove()');
      preview.append(close_x);
      preview.querySelectorAll('.ltx_tag_bibitem').forEach(function(node) {
        node.remove();
      });
      cite.parentNode.insertBefore(preview, cite.nextSibling);
      return;
    }
    // Global Document initialization:
    // - assign the preview feature to all inline citation links
    document.querySelectorAll(".ltx_cite .ltx_ref").forEach(function (link) {
      link.addEventListener("click", clicked_cite);
    });
    </script>
    </body>
</html>
