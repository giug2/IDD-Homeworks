<!DOCTYPE html><html lang="en">
<head>
<meta http-equiv="content-type" content="text/html; charset=UTF-8">
<title>[2301.10114] When does the student surpass the teacher? Federated Semi-supervised Learning with Teacher-Student EMA</title><meta property="og:description" content="Semi-Supervised Learning (SSL) has received extensive attention in the domain of computer vision, leading to development of promising approaches such as FixMatch. In scenarios where training data is decentralized and r…">
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="When does the student surpass the teacher? Federated Semi-supervised Learning with Teacher-Student EMA">
<meta name="twitter:image:src" content="https://ar5iv.labs.arxiv.org/assets/ar5iv_card.png">
<meta name="twitter:image:alt" content="ar5iv logo">
<meta property="og:title" content="When does the student surpass the teacher? Federated Semi-supervised Learning with Teacher-Student EMA">
<meta property="og:site_name" content="ar5iv">
<meta property="og:image" content="https://ar5iv.labs.arxiv.org/assets/ar5iv_card.png">
<meta property="og:type" content="article">
<meta property="og:url" content="https://ar5iv.labs.arxiv.org/html/2301.10114">

<!--Generated on Fri Mar  1 06:14:38 2024 by LaTeXML (version 0.8.8) http://dlmf.nist.gov/LaTeXML/.-->
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="keywords" lang="en" content="Semi-supervised Learning,  Federated Learning,  Pseudo-">

<script>
  function detectColorScheme(){
    var theme="light";
    var current_theme = localStorage.getItem("ar5iv_theme");
    if(current_theme){
      if(current_theme == "dark"){
        theme = "dark";
      } }
    else if(!window.matchMedia) { return false; }
    else if(window.matchMedia("(prefers-color-scheme: dark)").matches) {
      theme = "dark"; }
    if (theme=="dark") {
      document.documentElement.setAttribute("data-theme", "dark");
    } else {
      document.documentElement.setAttribute("data-theme", "light"); } }

  detectColorScheme();

  function toggleColorScheme(){
    var current_theme = localStorage.getItem("ar5iv_theme");
    if (current_theme) {
      if (current_theme == "light") {
        localStorage.setItem("ar5iv_theme", "dark"); }
      else {
        localStorage.setItem("ar5iv_theme", "light"); } }
    else {
        localStorage.setItem("ar5iv_theme", "dark"); }
    detectColorScheme(); }
</script>
<link media="all" rel="stylesheet" href="/assets/ar5iv-fonts.0.8.0.min.css"><link media="all" rel="stylesheet" href="/assets/ar5iv.0.8.0.min.css"><link media="all" rel="stylesheet" href="/assets/ar5iv-site.0.2.2.css">
</head>
<body>
<div class="ltx_page_main">
<div class="ltx_page_content">
<article class="ltx_document ltx_pruned_first">
<h1 class="ltx_title ltx_title_document">When does the student surpass the teacher? 
<br class="ltx_break">Federated Semi-supervised Learning with Teacher-Student EMA</h1>
<div class="ltx_authors">
<span class="ltx_creator ltx_role_author">
<span class="ltx_personname">Jessica Zhao
</span></span>
<span class="ltx_author_before">  </span><span class="ltx_creator ltx_role_author">
<span class="ltx_personname">Sayan Ghosh
</span></span>
<span class="ltx_author_before">  </span><span class="ltx_creator ltx_role_author">
<span class="ltx_personname">Akash Bharadwaj
</span></span>
<span class="ltx_author_before">  </span><span class="ltx_creator ltx_role_author">
<span class="ltx_personname">Chih-Yao Ma
</span></span>
</div>

<div class="ltx_abstract">
<h6 class="ltx_title ltx_title_abstract">Abstract</h6>
<p id="id1.id1" class="ltx_p">Semi-Supervised Learning (SSL) has received extensive attention in the domain of computer vision, leading to development of promising approaches such as FixMatch. In scenarios where training data is decentralized and resides on client devices, SSL must be integrated with privacy-aware training techniques such as Federated Learning. We consider the problem of federated image classification and study the performance and privacy challenges with existing federated SSL (FSSL) approaches.
Firstly, we note that even state-of-the-art FSSL algorithms can trivially compromise client privacy and other real-world constraints such as client statelessness and communication cost. Secondly, we observe that it is challenging to integrate EMA (Exponential Moving Average) updates into the federated setting, which comes at a trade-off between performance and communication cost.
We propose a novel approach <span id="id1.id1.1" class="ltx_text ltx_font_italic">FedSwitch</span>, that improves privacy as well as generalization performance through Exponential Moving Average (EMA) updates. <span id="id1.id1.2" class="ltx_text ltx_font_italic">FedSwitch</span> utilizes a federated semi-supervised teacher-student EMA framework with two features - <span id="id1.id1.3" class="ltx_text ltx_font_italic">local teacher adaptation</span> and <span id="id1.id1.4" class="ltx_text ltx_font_italic">adaptive switching between teacher and student for pseudo-label generation</span>. Our proposed approach outperforms the state-of-the-art on federated image classification, can be adapted to real-world constraints, and achieves good generalization performance with minimal communication cost overhead.</p>
</div>
<div class="ltx_keywords">Semi-supervised Learning, Federated Learning, Pseudo-
<br class="ltx_break">Labeling, teacher-student Models, Exponential Model Averaging
</div>
<div id="p2" class="ltx_para">
<br class="ltx_break">
</div>
<section id="S1" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">1 </span>Introduction</h2>

<div id="S1.p1" class="ltx_para">
<p id="S1.p1.1" class="ltx_p">Semi-supervised Learning (SSL) has been successfully applied to many machine learning applications such as image classification, where there is potential for leveraging large amounts of unlabeled data for training.
Motivated by privacy concerns, Federated Learning (FL) was proposed by McMahan et al. <cite class="ltx_cite ltx_citemacro_citep">(McMahan et al., <a href="#bib.bib25" title="" class="ltx_ref">2017</a>)</cite> to train machine learning models on data distributed across several client devices without moving data off-device. The FL setting presents unique challenges to machine learning applications, such as client non-IIDness, where clients’ data is sampled from different distributions <cite class="ltx_cite ltx_citemacro_citep">(Karimireddy et al., <a href="#bib.bib15" title="" class="ltx_ref">2020</a>)</cite>, scalability, and non-uniform selection of clients.</p>
</div>
<div id="S1.p2" class="ltx_para">
<p id="S1.p2.1" class="ltx_p">Federated Semi-Supervised Learning (FSSL) is an emerging area of research, which considers scenarios where unlabeled data is available client-side, such that one can apply existing SSL methods to leverage this data at the client devices to train and further improve the performance of the model.
Several FSSL approaches have been proposed, such as <span id="S1.p2.1.1" class="ltx_text ltx_font_italic">FedMatch</span> <cite class="ltx_cite ltx_citemacro_citep">(Jeong et al., <a href="#bib.bib13" title="" class="ltx_ref">2021</a>)</cite> and <span id="S1.p2.1.2" class="ltx_text ltx_font_italic">FedRGD</span> <cite class="ltx_cite ltx_citemacro_citep">(Zhang et al., <a href="#bib.bib39" title="" class="ltx_ref">2021</a>)</cite>, which leverage unlabeled data to train an image classifier in the federated setting.
Despite achieving good generalization performance on experimental settings when assuming IIDness, low number of clients etc.,
some existing work fails to satisfy the same client privacy guarantees as traditional FL methods or assumes stateful clients participating in each round.
For example, some of these approaches such as FedMatch <cite class="ltx_cite ltx_citemacro_citep">(Jeong et al., <a href="#bib.bib13" title="" class="ltx_ref">2021</a>)</cite> relax their design assumptions leading to trivial privacy compromises and sharing clients’ models with each other. These assumptions are critical in industrial deployments, where clients are stateless and subject to tight privacy controls.
These are both important considerations when designing practical FSSL algorithms <cite class="ltx_cite ltx_citemacro_citep">(Kairouz et al., <a href="#bib.bib14" title="" class="ltx_ref">2021</a>)</cite>, and we provide a detailed discussion focusing on <span id="S1.p2.1.3" class="ltx_text ltx_font_italic">privacy leakage</span> and <span id="S1.p2.1.4" class="ltx_text ltx_font_italic">client state</span> in Section <a href="#S3.SS1" title="3.1 Real-world considerations for practical FSSL ‣ 3 Preliminaries ‣ When does the student surpass the teacher? Federated Semi-supervised Learning with Teacher-Student EMA" class="ltx_ref"><span class="ltx_text ltx_ref_tag">3.1</span></a>.</p>
</div>
<div id="S1.p3" class="ltx_para">
<p id="S1.p3.1" class="ltx_p">Teacher-student EMA <cite class="ltx_cite ltx_citemacro_citep">(Tarvainen &amp; Valpola, <a href="#bib.bib32" title="" class="ltx_ref">2017</a>; Liu et al., <a href="#bib.bib22" title="" class="ltx_ref">2021</a>)</cite> is a popular paradigm in semi-supervised learning, where there is a teacher model generating pseudo-labels for unlabeled data, while being updated slowly through a exponential weighting mechanism. The advantage of this approach is that the teacher model is relatively robust to changes in the student model and can improve pseudo-label quality, which translates to better generalization performance. While there has been prior work on federated teacher-student approaches <cite class="ltx_cite ltx_citemacro_citep">(Long et al., <a href="#bib.bib23" title="" class="ltx_ref">2020</a>)</cite>, to the best of our knowledge, there has been no analysis of the design considerations and performance tradeoffs of such approaches applied to FSSL. In a centralized server setting, EMA updates occur after every batch and while slowly updating the teacher, keeps it synchronized with the student model. In federated learning, an implementation of this EMA update scheme would be non-trivial. For example, some key design decisions are the placement of the teacher and student models on the server and individual clients and how frequently student model weights are communicated to the teachers for EMA updates in addition to the standard FL updates. In this paper, we discuss potential approaches along with trade-offs between communication cost and generalization performance.</p>
</div>
<div id="S1.p4" class="ltx_para">
<p id="S1.p4.1" class="ltx_p">We find that depending on the setting and stage of training, the pseudo-labels generated by the teacher may be of higher quality than the pseudo-labels generated by the teacher.
We propose <span id="S1.p4.1.1" class="ltx_text ltx_font_italic">FedSwitch</span>—a novel variant on teacher-student EMA techniques for federated SSL, which dynamically switches between using the teacher and the student to generate pseudo-labels. Through extensive experimentation, we show that <span id="S1.p4.1.2" class="ltx_text ltx_font_italic">FedSwitch</span> achieves state-of-the-art performance
on the CIFAR-10 and Fashion MNIST datasets in a federated setting. The improved training properties of <span id="S1.p4.1.3" class="ltx_text ltx_font_italic">FedSwitch</span> are further manifested in a smoother convergence curve, as well as reduced model variance.
We plan to publicly release our code to facilitate future research. To summarize, our key contributions are as follows:</p>
</div>
<div id="S1.p5" class="ltx_para">
<ol id="S1.I1" class="ltx_enumerate">
<li id="S1.I1.i1" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">1.</span> 
<div id="S1.I1.i1.p1" class="ltx_para">
<p id="S1.I1.i1.p1.1" class="ltx_p">We study the limitations of current FSSL (Federated Semi-supervised Learning) techniques in practical environments and the complexities encountered when designing teacher-student EMA approaches in federated settings.</p>
</div>
</li>
<li id="S1.I1.i2" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">2.</span> 
<div id="S1.I1.i2.p1" class="ltx_para">
<p id="S1.I1.i2.p1.1" class="ltx_p">We propose <span id="S1.I1.i2.p1.1.1" class="ltx_text ltx_font_italic">FedSwitch</span>, a federated teacher-student EMA model with a novel mechanism, relying on local teacher adaptation and leveraging either the teacher or student model for pseudo-label generation based on a KL-Divergence metric.</p>
</div>
</li>
<li id="S1.I1.i3" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">3.</span> 
<div id="S1.I1.i3.p1" class="ltx_para">
<p id="S1.I1.i3.p1.1" class="ltx_p">We demonstrate that <span id="S1.I1.i3.p1.1.1" class="ltx_text ltx_font_italic">FedSwitch</span> achieves state-of-the-art generalization performance on the CIFAR-10 dataset and improves on existing approaches such as FedMatch <cite class="ltx_cite ltx_citemacro_citep">(Jeong et al., <a href="#bib.bib13" title="" class="ltx_ref">2021</a>)</cite>, FedRGD <cite class="ltx_cite ltx_citemacro_citep">(Zhang et al., <a href="#bib.bib39" title="" class="ltx_ref">2021</a>)</cite> and FedProx-FixMatch <cite class="ltx_cite ltx_citemacro_citep">(Sohn et al., <a href="#bib.bib30" title="" class="ltx_ref">2020</a>)</cite>.
</p>
</div>
</li>
</ol>
</div>
</section>
<section id="S2" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">2 </span>Related Work</h2>

<section id="S2.SS1" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">2.1 </span>Federated Learning</h3>

<div id="S2.SS1.p1" class="ltx_para">
<p id="S2.SS1.p1.1" class="ltx_p">Since the introduction of FedAvg <cite class="ltx_cite ltx_citemacro_citep">(McMahan et al., <a href="#bib.bib25" title="" class="ltx_ref">2017</a>)</cite>, which generalized SGD to the collaborative learning setting where data is distributed across multiple devices, several improvements <cite class="ltx_cite ltx_citemacro_citep">(Kairouz et al., <a href="#bib.bib14" title="" class="ltx_ref">2021</a>)</cite> have been proposed, such as FedProx <cite class="ltx_cite ltx_citemacro_citep">(Li et al., <a href="#bib.bib20" title="" class="ltx_ref">2020</a>)</cite>, which generalizes and improves upon FedAvg by adding a proximal term <math id="S2.SS1.p1.1.m1.1" class="ltx_Math" alttext="\mu" display="inline"><semantics id="S2.SS1.p1.1.m1.1a"><mi id="S2.SS1.p1.1.m1.1.1" xref="S2.SS1.p1.1.m1.1.1.cmml">μ</mi><annotation-xml encoding="MathML-Content" id="S2.SS1.p1.1.m1.1b"><ci id="S2.SS1.p1.1.m1.1.1.cmml" xref="S2.SS1.p1.1.m1.1.1">𝜇</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p1.1.m1.1c">\mu</annotation></semantics></math> to the local objective.
Furthermore, several methods have been proposed to address specific issues in federated learning, such as improving privacy via differentially private training <cite class="ltx_cite ltx_citemacro_citep">(Dwork et al., <a href="#bib.bib5" title="" class="ltx_ref">2014</a>; Wei et al., <a href="#bib.bib33" title="" class="ltx_ref">2020</a>)</cite> or reducing communication costs <cite class="ltx_cite ltx_citemacro_citep">(Konečnỳ et al., <a href="#bib.bib16" title="" class="ltx_ref">2016</a>)</cite>.</p>
</div>
</section>
<section id="S2.SS2" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">2.2 </span>Semi-Supervised Learning</h3>

<div id="S2.SS2.p1" class="ltx_para">
<p id="S2.SS2.p1.1" class="ltx_p">The majority of the recent SSL methods can be roughly categorized by their two main components: (1) input augmentations and perturbations, and (2) consistency regularization.
The main motivation of these methods is to regularize the model to be invariant and robust to data or feature augmentations, which they achieve by enforcing the output predictions from the original and augmented inputs to be consistent with each other.
For example, in image classification, existing approaches apply various data augmentation strategies that generate different transformations of semantically identical images <cite class="ltx_cite ltx_citemacro_citep">(Berthelot et al., <a href="#bib.bib1" title="" class="ltx_ref">2019</a>; Laine &amp; Aila, <a href="#bib.bib19" title="" class="ltx_ref">2017</a>; Sajjadi et al., <a href="#bib.bib27" title="" class="ltx_ref">2016</a>; Tarvainen &amp; Valpola, <a href="#bib.bib32" title="" class="ltx_ref">2017</a>)</cite>, perturb the input images along the adversarial direction <cite class="ltx_cite ltx_citemacro_citep">(Miyato et al., <a href="#bib.bib26" title="" class="ltx_ref">2018</a>; Yu et al., <a href="#bib.bib36" title="" class="ltx_ref">2019</a>)</cite>, mix input images to generate augmented training data and annotations <cite class="ltx_cite ltx_citemacro_citep">(Zhang et al., <a href="#bib.bib38" title="" class="ltx_ref">2018</a>; Yun et al., <a href="#bib.bib37" title="" class="ltx_ref">2019</a>; Guo et al., <a href="#bib.bib9" title="" class="ltx_ref">2019</a>; Hendrycks et al., <a href="#bib.bib11" title="" class="ltx_ref">2020</a>)</cite>, or learn augmented prototypes in feature space instead of image space <cite class="ltx_cite ltx_citemacro_citep">(Kuo et al., <a href="#bib.bib17" title="" class="ltx_ref">2020</a>)</cite>.</p>
</div>
</section>
<section id="S2.SS3" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">2.3 </span>Federated Semi-Supervised Learning</h3>

<div id="S2.SS3.p1" class="ltx_para">
<p id="S2.SS3.p1.1" class="ltx_p">FedMatch <cite class="ltx_cite ltx_citemacro_citep">(Jeong et al., <a href="#bib.bib13" title="" class="ltx_ref">2021</a>)</cite> is one of the very first works in FSSL, in which the authors improve over a naïve combination of FL and SSL
by introducing an inter-client consistency loss to regularize models learned at multiple clients to make similar predictions. However, this approach violates privacy constraints in practice. Another approach, FedRGD <cite class="ltx_cite ltx_citemacro_citep">(Zhang et al., <a href="#bib.bib39" title="" class="ltx_ref">2021</a>)</cite> proposes a grouping-based averaging of client updates in place of FedAvg-based averaging to reduce the gradient diversity of models and improve generalization performance.</p>
</div>
<figure id="S2.T1" class="ltx_table">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table">Table 1: </span>Properties of existing FSSL approaches in terms of providing privacy guarantees similar to standard supervised FL (as in FedAvg) and assumption of client statelessness in their design. Note that FedMatch does not adequately provide client privacy guarantees and FedSEAL/FedCon do not assume stateless clients. None of the existing FSSL approaches consider teacher-student EMA modeling to improve performance.
</figcaption>
<table id="S2.T1.7" class="ltx_tabular ltx_centering ltx_align_middle">
<tbody class="ltx_tbody">
<tr id="S2.T1.7.8.1" class="ltx_tr">
<td id="S2.T1.7.8.1.1" class="ltx_td ltx_border_t" style="padding-left:2.8pt;padding-right:2.8pt;"></td>
<td id="S2.T1.7.8.1.2" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:2.8pt;padding-right:2.8pt;">FedMatch</td>
<td id="S2.T1.7.8.1.3" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:2.8pt;padding-right:2.8pt;">FedRGD</td>
<td id="S2.T1.7.8.1.4" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:2.8pt;padding-right:2.8pt;">FedSEAL</td>
<td id="S2.T1.7.8.1.5" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:2.8pt;padding-right:2.8pt;">FedCon</td>
<td id="S2.T1.7.8.1.6" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:2.8pt;padding-right:2.8pt;"><span id="S2.T1.7.8.1.6.1" class="ltx_text ltx_font_italic">FedSwitch</span></td>
</tr>
<tr id="S2.T1.7.9.2" class="ltx_tr">
<td id="S2.T1.7.9.2.1" class="ltx_td" style="padding-left:2.8pt;padding-right:2.8pt;"></td>
<td id="S2.T1.7.9.2.2" class="ltx_td ltx_align_center" style="padding-left:2.8pt;padding-right:2.8pt;"><cite class="ltx_cite ltx_citemacro_citep">(Jeong et al., <a href="#bib.bib13" title="" class="ltx_ref">2021</a>)</cite></td>
<td id="S2.T1.7.9.2.3" class="ltx_td ltx_align_center" style="padding-left:2.8pt;padding-right:2.8pt;"><cite class="ltx_cite ltx_citemacro_citep">(Zhang et al., <a href="#bib.bib39" title="" class="ltx_ref">2021</a>)</cite></td>
<td id="S2.T1.7.9.2.4" class="ltx_td ltx_align_center" style="padding-left:2.8pt;padding-right:2.8pt;"><cite class="ltx_cite ltx_citemacro_citep">(Bian et al., <a href="#bib.bib2" title="" class="ltx_ref">2021</a>)</cite></td>
<td id="S2.T1.7.9.2.5" class="ltx_td ltx_align_center" style="padding-left:2.8pt;padding-right:2.8pt;"><cite class="ltx_cite ltx_citemacro_citep">(Long et al., <a href="#bib.bib24" title="" class="ltx_ref">2021</a>)</cite></td>
<td id="S2.T1.7.9.2.6" class="ltx_td ltx_align_center" style="padding-left:2.8pt;padding-right:2.8pt;">(ours)</td>
</tr>
<tr id="S2.T1.1.1" class="ltx_tr">
<td id="S2.T1.1.1.2" class="ltx_td ltx_align_left ltx_border_t" style="padding-left:2.8pt;padding-right:2.8pt;">Privacy</td>
<td id="S2.T1.1.1.1" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:2.8pt;padding-right:2.8pt;"><math id="S2.T1.1.1.1.m1.1" class="ltx_Math" alttext="\times" display="inline"><semantics id="S2.T1.1.1.1.m1.1a"><mo id="S2.T1.1.1.1.m1.1.1" xref="S2.T1.1.1.1.m1.1.1.cmml">×</mo><annotation-xml encoding="MathML-Content" id="S2.T1.1.1.1.m1.1b"><times id="S2.T1.1.1.1.m1.1.1.cmml" xref="S2.T1.1.1.1.m1.1.1"></times></annotation-xml><annotation encoding="application/x-tex" id="S2.T1.1.1.1.m1.1c">\times</annotation></semantics></math></td>
<td id="S2.T1.1.1.3" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:2.8pt;padding-right:2.8pt;">✓</td>
<td id="S2.T1.1.1.4" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:2.8pt;padding-right:2.8pt;">✓</td>
<td id="S2.T1.1.1.5" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:2.8pt;padding-right:2.8pt;">✓</td>
<td id="S2.T1.1.1.6" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:2.8pt;padding-right:2.8pt;">✓</td>
</tr>
<tr id="S2.T1.3.3" class="ltx_tr">
<td id="S2.T1.3.3.3" class="ltx_td ltx_align_left ltx_border_t" style="padding-left:2.8pt;padding-right:2.8pt;">Statelessness</td>
<td id="S2.T1.3.3.4" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:2.8pt;padding-right:2.8pt;">✓</td>
<td id="S2.T1.3.3.5" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:2.8pt;padding-right:2.8pt;">✓</td>
<td id="S2.T1.2.2.1" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:2.8pt;padding-right:2.8pt;"><math id="S2.T1.2.2.1.m1.1" class="ltx_Math" alttext="\times" display="inline"><semantics id="S2.T1.2.2.1.m1.1a"><mo id="S2.T1.2.2.1.m1.1.1" xref="S2.T1.2.2.1.m1.1.1.cmml">×</mo><annotation-xml encoding="MathML-Content" id="S2.T1.2.2.1.m1.1b"><times id="S2.T1.2.2.1.m1.1.1.cmml" xref="S2.T1.2.2.1.m1.1.1"></times></annotation-xml><annotation encoding="application/x-tex" id="S2.T1.2.2.1.m1.1c">\times</annotation></semantics></math></td>
<td id="S2.T1.3.3.2" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:2.8pt;padding-right:2.8pt;"><math id="S2.T1.3.3.2.m1.1" class="ltx_Math" alttext="\times" display="inline"><semantics id="S2.T1.3.3.2.m1.1a"><mo id="S2.T1.3.3.2.m1.1.1" xref="S2.T1.3.3.2.m1.1.1.cmml">×</mo><annotation-xml encoding="MathML-Content" id="S2.T1.3.3.2.m1.1b"><times id="S2.T1.3.3.2.m1.1.1.cmml" xref="S2.T1.3.3.2.m1.1.1"></times></annotation-xml><annotation encoding="application/x-tex" id="S2.T1.3.3.2.m1.1c">\times</annotation></semantics></math></td>
<td id="S2.T1.3.3.6" class="ltx_td ltx_align_center ltx_border_t" style="padding-left:2.8pt;padding-right:2.8pt;">✓</td>
</tr>
<tr id="S2.T1.7.7" class="ltx_tr">
<td id="S2.T1.7.7.5" class="ltx_td ltx_align_left ltx_border_b ltx_border_t" style="padding-left:2.8pt;padding-right:2.8pt;">EMA Smoothing</td>
<td id="S2.T1.4.4.1" class="ltx_td ltx_align_center ltx_border_b ltx_border_t" style="padding-left:2.8pt;padding-right:2.8pt;"><math id="S2.T1.4.4.1.m1.1" class="ltx_Math" alttext="\times" display="inline"><semantics id="S2.T1.4.4.1.m1.1a"><mo id="S2.T1.4.4.1.m1.1.1" xref="S2.T1.4.4.1.m1.1.1.cmml">×</mo><annotation-xml encoding="MathML-Content" id="S2.T1.4.4.1.m1.1b"><times id="S2.T1.4.4.1.m1.1.1.cmml" xref="S2.T1.4.4.1.m1.1.1"></times></annotation-xml><annotation encoding="application/x-tex" id="S2.T1.4.4.1.m1.1c">\times</annotation></semantics></math></td>
<td id="S2.T1.5.5.2" class="ltx_td ltx_align_center ltx_border_b ltx_border_t" style="padding-left:2.8pt;padding-right:2.8pt;"><math id="S2.T1.5.5.2.m1.1" class="ltx_Math" alttext="\times" display="inline"><semantics id="S2.T1.5.5.2.m1.1a"><mo id="S2.T1.5.5.2.m1.1.1" xref="S2.T1.5.5.2.m1.1.1.cmml">×</mo><annotation-xml encoding="MathML-Content" id="S2.T1.5.5.2.m1.1b"><times id="S2.T1.5.5.2.m1.1.1.cmml" xref="S2.T1.5.5.2.m1.1.1"></times></annotation-xml><annotation encoding="application/x-tex" id="S2.T1.5.5.2.m1.1c">\times</annotation></semantics></math></td>
<td id="S2.T1.6.6.3" class="ltx_td ltx_align_center ltx_border_b ltx_border_t" style="padding-left:2.8pt;padding-right:2.8pt;"><math id="S2.T1.6.6.3.m1.1" class="ltx_Math" alttext="\times" display="inline"><semantics id="S2.T1.6.6.3.m1.1a"><mo id="S2.T1.6.6.3.m1.1.1" xref="S2.T1.6.6.3.m1.1.1.cmml">×</mo><annotation-xml encoding="MathML-Content" id="S2.T1.6.6.3.m1.1b"><times id="S2.T1.6.6.3.m1.1.1.cmml" xref="S2.T1.6.6.3.m1.1.1"></times></annotation-xml><annotation encoding="application/x-tex" id="S2.T1.6.6.3.m1.1c">\times</annotation></semantics></math></td>
<td id="S2.T1.7.7.4" class="ltx_td ltx_align_center ltx_border_b ltx_border_t" style="padding-left:2.8pt;padding-right:2.8pt;"><math id="S2.T1.7.7.4.m1.1" class="ltx_Math" alttext="\times" display="inline"><semantics id="S2.T1.7.7.4.m1.1a"><mo id="S2.T1.7.7.4.m1.1.1" xref="S2.T1.7.7.4.m1.1.1.cmml">×</mo><annotation-xml encoding="MathML-Content" id="S2.T1.7.7.4.m1.1b"><times id="S2.T1.7.7.4.m1.1.1.cmml" xref="S2.T1.7.7.4.m1.1.1"></times></annotation-xml><annotation encoding="application/x-tex" id="S2.T1.7.7.4.m1.1c">\times</annotation></semantics></math></td>
<td id="S2.T1.7.7.6" class="ltx_td ltx_align_center ltx_border_b ltx_border_t" style="padding-left:2.8pt;padding-right:2.8pt;">✓</td>
</tr>
</tbody>
</table>
</figure>
</section>
</section>
<section id="S3" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">3 </span>Preliminaries</h2>

<section id="S3.SS1" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.1 </span>Real-world considerations for practical FSSL</h3>

<div id="S3.SS1.p1" class="ltx_para">
<p id="S3.SS1.p1.1" class="ltx_p">We describe some of the main considerations when designing practical FSSL systems, such as <span id="S3.SS1.p1.1.1" class="ltx_text ltx_font_italic">privacy leakage</span> and <span id="S3.SS1.p1.1.2" class="ltx_text ltx_font_italic">client state</span>. These are general issues for designing standard FL systems, and any semi-supervised approach also has to be cognizant of these to deploy in the real-world. There may exist a trade-off between satisfying these constraints and overall performance, and generalization performance may improve but at the cost of relaxing these considerations.</p>
</div>
<div id="S3.SS1.p2" class="ltx_para">
<p id="S3.SS1.p2.2" class="ltx_p"><span id="S3.SS1.p2.2.1" class="ltx_text ltx_font_bold">Privacy Leakage.</span> We guarantee the same degree of privacy as in standard federated learning <cite class="ltx_cite ltx_citemacro_citep">(McMahan et al., <a href="#bib.bib25" title="" class="ltx_ref">2017</a>)</cite> by ensuring that (1) there is no additional information provided to the server other than client updates (gradients), and (2) there is no communication between clients that involves sharing their updates or local model parameters.
Existing literature has shown that it is possible to launch attacks given access to model gradients/parameters both in the central learning setting, as in Shokri et al. <cite class="ltx_cite ltx_citemacro_citep">(Shokri et al., <a href="#bib.bib28" title="" class="ltx_ref">2017</a>)</cite> and Carlini et al. <cite class="ltx_cite ltx_citemacro_citep">(Carlini et al., <a href="#bib.bib3" title="" class="ltx_ref">2021</a>)</cite>; and in the federated learning setting, such as in Geiping et al. <cite class="ltx_cite ltx_citemacro_citep">(Geiping et al., <a href="#bib.bib6" title="" class="ltx_ref">2020</a>)</cite>.
Not all contemporary FSSL approaches are limited to these attacks. In FedMatch <cite class="ltx_cite ltx_citemacro_citep">(Jeong et al., <a href="#bib.bib13" title="" class="ltx_ref">2021</a>)</cite> for instance, the inter-client consistency loss requires the server to store all client models and send <math id="S3.SS1.p2.1.m1.1" class="ltx_Math" alttext="H" display="inline"><semantics id="S3.SS1.p2.1.m1.1a"><mi id="S3.SS1.p2.1.m1.1.1" xref="S3.SS1.p2.1.m1.1.1.cmml">H</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p2.1.m1.1b"><ci id="S3.SS1.p2.1.m1.1.1.cmml" xref="S3.SS1.p2.1.m1.1.1">𝐻</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p2.1.m1.1c">H</annotation></semantics></math> helper agents (the <math id="S3.SS1.p2.2.m2.1" class="ltx_Math" alttext="H" display="inline"><semantics id="S3.SS1.p2.2.m2.1a"><mi id="S3.SS1.p2.2.m2.1.1" xref="S3.SS1.p2.2.m2.1.1.cmml">H</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p2.2.m2.1b"><ci id="S3.SS1.p2.2.m2.1.1.cmml" xref="S3.SS1.p2.2.m2.1.1">𝐻</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p2.2.m2.1c">H</annotation></semantics></math> nearest client models) to each client. This poses an additional privacy vulnerability, as malicious clients could launch attacks when provided access to other client models, with the goal of impairing model training or inferring other clients’ data.</p>
</div>
<div id="S3.SS1.p3" class="ltx_para">
<p id="S3.SS1.p3.1" class="ltx_p"><span id="S3.SS1.p3.1.1" class="ltx_text ltx_font_bold">Client state.</span> In large-scale deployments of cross-device FL, most clients do not participate more than once during training, and thus the design of cross-device FSSL algorithms should be stateless. Concretely, stateless clients do not retain any information pertaining to previous rounds <cite class="ltx_cite ltx_citemacro_citep">(Kairouz et al., <a href="#bib.bib14" title="" class="ltx_ref">2021</a>; Singhal et al., <a href="#bib.bib29" title="" class="ltx_ref">2021</a>)</cite>. Not all previous algorithms satisfy this desideratum. For instance, FedCon <cite class="ltx_cite ltx_citemacro_citep">(Long et al., <a href="#bib.bib24" title="" class="ltx_ref">2021</a>)</cite> assumes that clients retain their projector network across multiple rounds, and in FedSEAL <cite class="ltx_cite ltx_citemacro_citep">(Bian et al., <a href="#bib.bib2" title="" class="ltx_ref">2021</a>)</cite> clients utilize historical information through self-ensembling across multiple rounds. These approaches assume stateful clients, which may be problematic in a real-world setting.</p>
</div>
<figure id="S3.F1" class="ltx_figure"><img src="/html/2301.10114/assets/figures/f2_2.png" id="S3.F1.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="568" height="194" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 1: </span>Overview of teacher-student EMA modeling for FSSL including transport of teacher/student models between clients and central server. We can reduce communication cost by sending only the student model from each client to the server.</figcaption>
</figure>
</section>
<section id="S3.SS2" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.2 </span>FSSL with teacher-student EMA models</h3>

<div id="S3.SS2.p1" class="ltx_para">
<p id="S3.SS2.p1.3" class="ltx_p"><span id="S3.SS2.p1.3.1" class="ltx_text ltx_font_bold">EMA teacher-student model.</span>
Inspired by Mean Teacher <cite class="ltx_cite ltx_citemacro_citep">(Tarvainen &amp; Valpola, <a href="#bib.bib32" title="" class="ltx_ref">2017</a>)</cite> and Unbiased Teacher <cite class="ltx_cite ltx_citemacro_citep">(Liu et al., <a href="#bib.bib22" title="" class="ltx_ref">2021</a>)</cite>, we leverage the EMA as a way to generate more stable pseudo-labels.
Unlike the FixMatch method <cite class="ltx_cite ltx_citemacro_citep">(Sohn et al., <a href="#bib.bib30" title="" class="ltx_ref">2020</a>)</cite>, where a single model both generates pseudo-labels and trains on them, in the teacher-student framework with EMA, we maintain two separate models, where <math id="S3.SS2.p1.1.m1.1" class="ltx_Math" alttext="\theta_{t}" display="inline"><semantics id="S3.SS2.p1.1.m1.1a"><msub id="S3.SS2.p1.1.m1.1.1" xref="S3.SS2.p1.1.m1.1.1.cmml"><mi id="S3.SS2.p1.1.m1.1.1.2" xref="S3.SS2.p1.1.m1.1.1.2.cmml">θ</mi><mi id="S3.SS2.p1.1.m1.1.1.3" xref="S3.SS2.p1.1.m1.1.1.3.cmml">t</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.1.m1.1b"><apply id="S3.SS2.p1.1.m1.1.1.cmml" xref="S3.SS2.p1.1.m1.1.1"><csymbol cd="ambiguous" id="S3.SS2.p1.1.m1.1.1.1.cmml" xref="S3.SS2.p1.1.m1.1.1">subscript</csymbol><ci id="S3.SS2.p1.1.m1.1.1.2.cmml" xref="S3.SS2.p1.1.m1.1.1.2">𝜃</ci><ci id="S3.SS2.p1.1.m1.1.1.3.cmml" xref="S3.SS2.p1.1.m1.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.1.m1.1c">\theta_{t}</annotation></semantics></math> and <math id="S3.SS2.p1.2.m2.1" class="ltx_Math" alttext="\theta_{s}" display="inline"><semantics id="S3.SS2.p1.2.m2.1a"><msub id="S3.SS2.p1.2.m2.1.1" xref="S3.SS2.p1.2.m2.1.1.cmml"><mi id="S3.SS2.p1.2.m2.1.1.2" xref="S3.SS2.p1.2.m2.1.1.2.cmml">θ</mi><mi id="S3.SS2.p1.2.m2.1.1.3" xref="S3.SS2.p1.2.m2.1.1.3.cmml">s</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.2.m2.1b"><apply id="S3.SS2.p1.2.m2.1.1.cmml" xref="S3.SS2.p1.2.m2.1.1"><csymbol cd="ambiguous" id="S3.SS2.p1.2.m2.1.1.1.cmml" xref="S3.SS2.p1.2.m2.1.1">subscript</csymbol><ci id="S3.SS2.p1.2.m2.1.1.2.cmml" xref="S3.SS2.p1.2.m2.1.1.2">𝜃</ci><ci id="S3.SS2.p1.2.m2.1.1.3.cmml" xref="S3.SS2.p1.2.m2.1.1.3">𝑠</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.2.m2.1c">\theta_{s}</annotation></semantics></math> are the learnable parameters of the teacher and the student model respectively. An EMA update is performed after each update of the (global) student model.
For simplicity, EMA update can be defined as (where <math id="S3.SS2.p1.3.m3.1" class="ltx_Math" alttext="\alpha" display="inline"><semantics id="S3.SS2.p1.3.m3.1a"><mi id="S3.SS2.p1.3.m3.1.1" xref="S3.SS2.p1.3.m3.1.1.cmml">α</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.3.m3.1b"><ci id="S3.SS2.p1.3.m3.1.1.cmml" xref="S3.SS2.p1.3.m3.1.1">𝛼</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.3.m3.1c">\alpha</annotation></semantics></math> is the EMA ratio.):</p>
<table id="S3.E1" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S3.E1.m1.1" class="ltx_Math" alttext="\theta_{t}\leftarrow\alpha\theta_{t}+(1-\alpha)\theta_{s}" display="block"><semantics id="S3.E1.m1.1a"><mrow id="S3.E1.m1.1.1" xref="S3.E1.m1.1.1.cmml"><msub id="S3.E1.m1.1.1.3" xref="S3.E1.m1.1.1.3.cmml"><mi id="S3.E1.m1.1.1.3.2" xref="S3.E1.m1.1.1.3.2.cmml">θ</mi><mi id="S3.E1.m1.1.1.3.3" xref="S3.E1.m1.1.1.3.3.cmml">t</mi></msub><mo stretchy="false" id="S3.E1.m1.1.1.2" xref="S3.E1.m1.1.1.2.cmml">←</mo><mrow id="S3.E1.m1.1.1.1" xref="S3.E1.m1.1.1.1.cmml"><mrow id="S3.E1.m1.1.1.1.3" xref="S3.E1.m1.1.1.1.3.cmml"><mi id="S3.E1.m1.1.1.1.3.2" xref="S3.E1.m1.1.1.1.3.2.cmml">α</mi><mo lspace="0em" rspace="0em" id="S3.E1.m1.1.1.1.3.1" xref="S3.E1.m1.1.1.1.3.1.cmml">​</mo><msub id="S3.E1.m1.1.1.1.3.3" xref="S3.E1.m1.1.1.1.3.3.cmml"><mi id="S3.E1.m1.1.1.1.3.3.2" xref="S3.E1.m1.1.1.1.3.3.2.cmml">θ</mi><mi id="S3.E1.m1.1.1.1.3.3.3" xref="S3.E1.m1.1.1.1.3.3.3.cmml">t</mi></msub></mrow><mo id="S3.E1.m1.1.1.1.2" xref="S3.E1.m1.1.1.1.2.cmml">+</mo><mrow id="S3.E1.m1.1.1.1.1" xref="S3.E1.m1.1.1.1.1.cmml"><mrow id="S3.E1.m1.1.1.1.1.1.1" xref="S3.E1.m1.1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S3.E1.m1.1.1.1.1.1.1.2" xref="S3.E1.m1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="S3.E1.m1.1.1.1.1.1.1.1" xref="S3.E1.m1.1.1.1.1.1.1.1.cmml"><mn id="S3.E1.m1.1.1.1.1.1.1.1.2" xref="S3.E1.m1.1.1.1.1.1.1.1.2.cmml">1</mn><mo id="S3.E1.m1.1.1.1.1.1.1.1.1" xref="S3.E1.m1.1.1.1.1.1.1.1.1.cmml">−</mo><mi id="S3.E1.m1.1.1.1.1.1.1.1.3" xref="S3.E1.m1.1.1.1.1.1.1.1.3.cmml">α</mi></mrow><mo stretchy="false" id="S3.E1.m1.1.1.1.1.1.1.3" xref="S3.E1.m1.1.1.1.1.1.1.1.cmml">)</mo></mrow><mo lspace="0em" rspace="0em" id="S3.E1.m1.1.1.1.1.2" xref="S3.E1.m1.1.1.1.1.2.cmml">​</mo><msub id="S3.E1.m1.1.1.1.1.3" xref="S3.E1.m1.1.1.1.1.3.cmml"><mi id="S3.E1.m1.1.1.1.1.3.2" xref="S3.E1.m1.1.1.1.1.3.2.cmml">θ</mi><mi id="S3.E1.m1.1.1.1.1.3.3" xref="S3.E1.m1.1.1.1.1.3.3.cmml">s</mi></msub></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.E1.m1.1b"><apply id="S3.E1.m1.1.1.cmml" xref="S3.E1.m1.1.1"><ci id="S3.E1.m1.1.1.2.cmml" xref="S3.E1.m1.1.1.2">←</ci><apply id="S3.E1.m1.1.1.3.cmml" xref="S3.E1.m1.1.1.3"><csymbol cd="ambiguous" id="S3.E1.m1.1.1.3.1.cmml" xref="S3.E1.m1.1.1.3">subscript</csymbol><ci id="S3.E1.m1.1.1.3.2.cmml" xref="S3.E1.m1.1.1.3.2">𝜃</ci><ci id="S3.E1.m1.1.1.3.3.cmml" xref="S3.E1.m1.1.1.3.3">𝑡</ci></apply><apply id="S3.E1.m1.1.1.1.cmml" xref="S3.E1.m1.1.1.1"><plus id="S3.E1.m1.1.1.1.2.cmml" xref="S3.E1.m1.1.1.1.2"></plus><apply id="S3.E1.m1.1.1.1.3.cmml" xref="S3.E1.m1.1.1.1.3"><times id="S3.E1.m1.1.1.1.3.1.cmml" xref="S3.E1.m1.1.1.1.3.1"></times><ci id="S3.E1.m1.1.1.1.3.2.cmml" xref="S3.E1.m1.1.1.1.3.2">𝛼</ci><apply id="S3.E1.m1.1.1.1.3.3.cmml" xref="S3.E1.m1.1.1.1.3.3"><csymbol cd="ambiguous" id="S3.E1.m1.1.1.1.3.3.1.cmml" xref="S3.E1.m1.1.1.1.3.3">subscript</csymbol><ci id="S3.E1.m1.1.1.1.3.3.2.cmml" xref="S3.E1.m1.1.1.1.3.3.2">𝜃</ci><ci id="S3.E1.m1.1.1.1.3.3.3.cmml" xref="S3.E1.m1.1.1.1.3.3.3">𝑡</ci></apply></apply><apply id="S3.E1.m1.1.1.1.1.cmml" xref="S3.E1.m1.1.1.1.1"><times id="S3.E1.m1.1.1.1.1.2.cmml" xref="S3.E1.m1.1.1.1.1.2"></times><apply id="S3.E1.m1.1.1.1.1.1.1.1.cmml" xref="S3.E1.m1.1.1.1.1.1.1"><minus id="S3.E1.m1.1.1.1.1.1.1.1.1.cmml" xref="S3.E1.m1.1.1.1.1.1.1.1.1"></minus><cn type="integer" id="S3.E1.m1.1.1.1.1.1.1.1.2.cmml" xref="S3.E1.m1.1.1.1.1.1.1.1.2">1</cn><ci id="S3.E1.m1.1.1.1.1.1.1.1.3.cmml" xref="S3.E1.m1.1.1.1.1.1.1.1.3">𝛼</ci></apply><apply id="S3.E1.m1.1.1.1.1.3.cmml" xref="S3.E1.m1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.E1.m1.1.1.1.1.3.1.cmml" xref="S3.E1.m1.1.1.1.1.3">subscript</csymbol><ci id="S3.E1.m1.1.1.1.1.3.2.cmml" xref="S3.E1.m1.1.1.1.1.3.2">𝜃</ci><ci id="S3.E1.m1.1.1.1.1.3.3.cmml" xref="S3.E1.m1.1.1.1.1.3.3">𝑠</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E1.m1.1c">\theta_{t}\leftarrow\alpha\theta_{t}+(1-\alpha)\theta_{s}</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(1)</span></td>
</tr></tbody>
</table>
</div>
<div id="S3.SS2.p2" class="ltx_para ltx_noindent">
<p id="S3.SS2.p2.1" class="ltx_p">EMA has found applications in the Semi-supervised <cite class="ltx_cite ltx_citemacro_citep">(Tarvainen &amp; Valpola, <a href="#bib.bib32" title="" class="ltx_ref">2017</a>; Liu et al., <a href="#bib.bib22" title="" class="ltx_ref">2021</a>)</cite> and Self-supervised learning settings <cite class="ltx_cite ltx_citemacro_citep">(He et al., <a href="#bib.bib10" title="" class="ltx_ref">2020</a>; Grill et al., <a href="#bib.bib7" title="" class="ltx_ref">2020</a>; Caron et al., <a href="#bib.bib4" title="" class="ltx_ref">2020</a>)</cite>.
In the semi-supervised learning
context, this is particularly useful, because the teacher model that is updated via EMA has been shown to generate stable and robust pseudo-labels, especially in real-life scenarios where pseudo-labels might be biased and imbalanced <cite class="ltx_cite ltx_citemacro_citep">(Liu et al., <a href="#bib.bib22" title="" class="ltx_ref">2021</a>)</cite>. While there has been success in using such a method, we, for the first time, demonstrate its effectiveness in the FSSL context.</p>
</div>
<div id="S3.SS2.p3" class="ltx_para">
<p id="S3.SS2.p3.2" class="ltx_p"><span id="S3.SS2.p3.2.1" class="ltx_text ltx_font_bold">Teacher student EMA models in FL settings</span>. During EMA updates in a non-federated setting, the teacher model is updated after every training batch and is able to stay synchronized with the student model, while being relatively more robust to fluctuations which could potentially affect its performance. In a federated setting training occurs on each client, and might also occur at the central server in addition to aggregation, particularly in the labels-at-server setting. This implies that we need to maintain a separate teacher model for each client device which we refer to as the local teacher models <math id="S3.SS2.p3.1.m1.2" class="ltx_Math" alttext="\{T^{k}_{t+1},k\in L_{t}\}" display="inline"><semantics id="S3.SS2.p3.1.m1.2a"><mrow id="S3.SS2.p3.1.m1.2.2.1" xref="S3.SS2.p3.1.m1.2.2.2.cmml"><mo stretchy="false" id="S3.SS2.p3.1.m1.2.2.1.2" xref="S3.SS2.p3.1.m1.2.2.2.cmml">{</mo><mrow id="S3.SS2.p3.1.m1.2.2.1.1" xref="S3.SS2.p3.1.m1.2.2.1.1.cmml"><mrow id="S3.SS2.p3.1.m1.2.2.1.1.1.1" xref="S3.SS2.p3.1.m1.2.2.1.1.1.2.cmml"><msubsup id="S3.SS2.p3.1.m1.2.2.1.1.1.1.1" xref="S3.SS2.p3.1.m1.2.2.1.1.1.1.1.cmml"><mi id="S3.SS2.p3.1.m1.2.2.1.1.1.1.1.2.2" xref="S3.SS2.p3.1.m1.2.2.1.1.1.1.1.2.2.cmml">T</mi><mrow id="S3.SS2.p3.1.m1.2.2.1.1.1.1.1.3" xref="S3.SS2.p3.1.m1.2.2.1.1.1.1.1.3.cmml"><mi id="S3.SS2.p3.1.m1.2.2.1.1.1.1.1.3.2" xref="S3.SS2.p3.1.m1.2.2.1.1.1.1.1.3.2.cmml">t</mi><mo id="S3.SS2.p3.1.m1.2.2.1.1.1.1.1.3.1" xref="S3.SS2.p3.1.m1.2.2.1.1.1.1.1.3.1.cmml">+</mo><mn id="S3.SS2.p3.1.m1.2.2.1.1.1.1.1.3.3" xref="S3.SS2.p3.1.m1.2.2.1.1.1.1.1.3.3.cmml">1</mn></mrow><mi id="S3.SS2.p3.1.m1.2.2.1.1.1.1.1.2.3" xref="S3.SS2.p3.1.m1.2.2.1.1.1.1.1.2.3.cmml">k</mi></msubsup><mo id="S3.SS2.p3.1.m1.2.2.1.1.1.1.2" xref="S3.SS2.p3.1.m1.2.2.1.1.1.2.cmml">,</mo><mi id="S3.SS2.p3.1.m1.1.1" xref="S3.SS2.p3.1.m1.1.1.cmml">k</mi></mrow><mo id="S3.SS2.p3.1.m1.2.2.1.1.2" xref="S3.SS2.p3.1.m1.2.2.1.1.2.cmml">∈</mo><msub id="S3.SS2.p3.1.m1.2.2.1.1.3" xref="S3.SS2.p3.1.m1.2.2.1.1.3.cmml"><mi id="S3.SS2.p3.1.m1.2.2.1.1.3.2" xref="S3.SS2.p3.1.m1.2.2.1.1.3.2.cmml">L</mi><mi id="S3.SS2.p3.1.m1.2.2.1.1.3.3" xref="S3.SS2.p3.1.m1.2.2.1.1.3.3.cmml">t</mi></msub></mrow><mo stretchy="false" id="S3.SS2.p3.1.m1.2.2.1.3" xref="S3.SS2.p3.1.m1.2.2.2.cmml">}</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p3.1.m1.2b"><set id="S3.SS2.p3.1.m1.2.2.2.cmml" xref="S3.SS2.p3.1.m1.2.2.1"><apply id="S3.SS2.p3.1.m1.2.2.1.1.cmml" xref="S3.SS2.p3.1.m1.2.2.1.1"><in id="S3.SS2.p3.1.m1.2.2.1.1.2.cmml" xref="S3.SS2.p3.1.m1.2.2.1.1.2"></in><list id="S3.SS2.p3.1.m1.2.2.1.1.1.2.cmml" xref="S3.SS2.p3.1.m1.2.2.1.1.1.1"><apply id="S3.SS2.p3.1.m1.2.2.1.1.1.1.1.cmml" xref="S3.SS2.p3.1.m1.2.2.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS2.p3.1.m1.2.2.1.1.1.1.1.1.cmml" xref="S3.SS2.p3.1.m1.2.2.1.1.1.1.1">subscript</csymbol><apply id="S3.SS2.p3.1.m1.2.2.1.1.1.1.1.2.cmml" xref="S3.SS2.p3.1.m1.2.2.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS2.p3.1.m1.2.2.1.1.1.1.1.2.1.cmml" xref="S3.SS2.p3.1.m1.2.2.1.1.1.1.1">superscript</csymbol><ci id="S3.SS2.p3.1.m1.2.2.1.1.1.1.1.2.2.cmml" xref="S3.SS2.p3.1.m1.2.2.1.1.1.1.1.2.2">𝑇</ci><ci id="S3.SS2.p3.1.m1.2.2.1.1.1.1.1.2.3.cmml" xref="S3.SS2.p3.1.m1.2.2.1.1.1.1.1.2.3">𝑘</ci></apply><apply id="S3.SS2.p3.1.m1.2.2.1.1.1.1.1.3.cmml" xref="S3.SS2.p3.1.m1.2.2.1.1.1.1.1.3"><plus id="S3.SS2.p3.1.m1.2.2.1.1.1.1.1.3.1.cmml" xref="S3.SS2.p3.1.m1.2.2.1.1.1.1.1.3.1"></plus><ci id="S3.SS2.p3.1.m1.2.2.1.1.1.1.1.3.2.cmml" xref="S3.SS2.p3.1.m1.2.2.1.1.1.1.1.3.2">𝑡</ci><cn type="integer" id="S3.SS2.p3.1.m1.2.2.1.1.1.1.1.3.3.cmml" xref="S3.SS2.p3.1.m1.2.2.1.1.1.1.1.3.3">1</cn></apply></apply><ci id="S3.SS2.p3.1.m1.1.1.cmml" xref="S3.SS2.p3.1.m1.1.1">𝑘</ci></list><apply id="S3.SS2.p3.1.m1.2.2.1.1.3.cmml" xref="S3.SS2.p3.1.m1.2.2.1.1.3"><csymbol cd="ambiguous" id="S3.SS2.p3.1.m1.2.2.1.1.3.1.cmml" xref="S3.SS2.p3.1.m1.2.2.1.1.3">subscript</csymbol><ci id="S3.SS2.p3.1.m1.2.2.1.1.3.2.cmml" xref="S3.SS2.p3.1.m1.2.2.1.1.3.2">𝐿</ci><ci id="S3.SS2.p3.1.m1.2.2.1.1.3.3.cmml" xref="S3.SS2.p3.1.m1.2.2.1.1.3.3">𝑡</ci></apply></apply></set></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p3.1.m1.2c">\{T^{k}_{t+1},k\in L_{t}\}</annotation></semantics></math>, in addition to the global teacher model <math id="S3.SS2.p3.2.m2.1" class="ltx_Math" alttext="T_{t}" display="inline"><semantics id="S3.SS2.p3.2.m2.1a"><msub id="S3.SS2.p3.2.m2.1.1" xref="S3.SS2.p3.2.m2.1.1.cmml"><mi id="S3.SS2.p3.2.m2.1.1.2" xref="S3.SS2.p3.2.m2.1.1.2.cmml">T</mi><mi id="S3.SS2.p3.2.m2.1.1.3" xref="S3.SS2.p3.2.m2.1.1.3.cmml">t</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.p3.2.m2.1b"><apply id="S3.SS2.p3.2.m2.1.1.cmml" xref="S3.SS2.p3.2.m2.1.1"><csymbol cd="ambiguous" id="S3.SS2.p3.2.m2.1.1.1.cmml" xref="S3.SS2.p3.2.m2.1.1">subscript</csymbol><ci id="S3.SS2.p3.2.m2.1.1.2.cmml" xref="S3.SS2.p3.2.m2.1.1.2">𝑇</ci><ci id="S3.SS2.p3.2.m2.1.1.3.cmml" xref="S3.SS2.p3.2.m2.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p3.2.m2.1c">T_{t}</annotation></semantics></math> which resides on the server.</p>
</div>
<div id="S3.SS2.p4" class="ltx_para">
<p id="S3.SS2.p4.8" class="ltx_p">Similar to the teacher, we maintain local student models <math id="S3.SS2.p4.1.m1.2" class="ltx_Math" alttext="\{S^{k}_{t+1},k\in L_{t}\}" display="inline"><semantics id="S3.SS2.p4.1.m1.2a"><mrow id="S3.SS2.p4.1.m1.2.2.1" xref="S3.SS2.p4.1.m1.2.2.2.cmml"><mo stretchy="false" id="S3.SS2.p4.1.m1.2.2.1.2" xref="S3.SS2.p4.1.m1.2.2.2.cmml">{</mo><mrow id="S3.SS2.p4.1.m1.2.2.1.1" xref="S3.SS2.p4.1.m1.2.2.1.1.cmml"><mrow id="S3.SS2.p4.1.m1.2.2.1.1.1.1" xref="S3.SS2.p4.1.m1.2.2.1.1.1.2.cmml"><msubsup id="S3.SS2.p4.1.m1.2.2.1.1.1.1.1" xref="S3.SS2.p4.1.m1.2.2.1.1.1.1.1.cmml"><mi id="S3.SS2.p4.1.m1.2.2.1.1.1.1.1.2.2" xref="S3.SS2.p4.1.m1.2.2.1.1.1.1.1.2.2.cmml">S</mi><mrow id="S3.SS2.p4.1.m1.2.2.1.1.1.1.1.3" xref="S3.SS2.p4.1.m1.2.2.1.1.1.1.1.3.cmml"><mi id="S3.SS2.p4.1.m1.2.2.1.1.1.1.1.3.2" xref="S3.SS2.p4.1.m1.2.2.1.1.1.1.1.3.2.cmml">t</mi><mo id="S3.SS2.p4.1.m1.2.2.1.1.1.1.1.3.1" xref="S3.SS2.p4.1.m1.2.2.1.1.1.1.1.3.1.cmml">+</mo><mn id="S3.SS2.p4.1.m1.2.2.1.1.1.1.1.3.3" xref="S3.SS2.p4.1.m1.2.2.1.1.1.1.1.3.3.cmml">1</mn></mrow><mi id="S3.SS2.p4.1.m1.2.2.1.1.1.1.1.2.3" xref="S3.SS2.p4.1.m1.2.2.1.1.1.1.1.2.3.cmml">k</mi></msubsup><mo id="S3.SS2.p4.1.m1.2.2.1.1.1.1.2" xref="S3.SS2.p4.1.m1.2.2.1.1.1.2.cmml">,</mo><mi id="S3.SS2.p4.1.m1.1.1" xref="S3.SS2.p4.1.m1.1.1.cmml">k</mi></mrow><mo id="S3.SS2.p4.1.m1.2.2.1.1.2" xref="S3.SS2.p4.1.m1.2.2.1.1.2.cmml">∈</mo><msub id="S3.SS2.p4.1.m1.2.2.1.1.3" xref="S3.SS2.p4.1.m1.2.2.1.1.3.cmml"><mi id="S3.SS2.p4.1.m1.2.2.1.1.3.2" xref="S3.SS2.p4.1.m1.2.2.1.1.3.2.cmml">L</mi><mi id="S3.SS2.p4.1.m1.2.2.1.1.3.3" xref="S3.SS2.p4.1.m1.2.2.1.1.3.3.cmml">t</mi></msub></mrow><mo stretchy="false" id="S3.SS2.p4.1.m1.2.2.1.3" xref="S3.SS2.p4.1.m1.2.2.2.cmml">}</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p4.1.m1.2b"><set id="S3.SS2.p4.1.m1.2.2.2.cmml" xref="S3.SS2.p4.1.m1.2.2.1"><apply id="S3.SS2.p4.1.m1.2.2.1.1.cmml" xref="S3.SS2.p4.1.m1.2.2.1.1"><in id="S3.SS2.p4.1.m1.2.2.1.1.2.cmml" xref="S3.SS2.p4.1.m1.2.2.1.1.2"></in><list id="S3.SS2.p4.1.m1.2.2.1.1.1.2.cmml" xref="S3.SS2.p4.1.m1.2.2.1.1.1.1"><apply id="S3.SS2.p4.1.m1.2.2.1.1.1.1.1.cmml" xref="S3.SS2.p4.1.m1.2.2.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS2.p4.1.m1.2.2.1.1.1.1.1.1.cmml" xref="S3.SS2.p4.1.m1.2.2.1.1.1.1.1">subscript</csymbol><apply id="S3.SS2.p4.1.m1.2.2.1.1.1.1.1.2.cmml" xref="S3.SS2.p4.1.m1.2.2.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS2.p4.1.m1.2.2.1.1.1.1.1.2.1.cmml" xref="S3.SS2.p4.1.m1.2.2.1.1.1.1.1">superscript</csymbol><ci id="S3.SS2.p4.1.m1.2.2.1.1.1.1.1.2.2.cmml" xref="S3.SS2.p4.1.m1.2.2.1.1.1.1.1.2.2">𝑆</ci><ci id="S3.SS2.p4.1.m1.2.2.1.1.1.1.1.2.3.cmml" xref="S3.SS2.p4.1.m1.2.2.1.1.1.1.1.2.3">𝑘</ci></apply><apply id="S3.SS2.p4.1.m1.2.2.1.1.1.1.1.3.cmml" xref="S3.SS2.p4.1.m1.2.2.1.1.1.1.1.3"><plus id="S3.SS2.p4.1.m1.2.2.1.1.1.1.1.3.1.cmml" xref="S3.SS2.p4.1.m1.2.2.1.1.1.1.1.3.1"></plus><ci id="S3.SS2.p4.1.m1.2.2.1.1.1.1.1.3.2.cmml" xref="S3.SS2.p4.1.m1.2.2.1.1.1.1.1.3.2">𝑡</ci><cn type="integer" id="S3.SS2.p4.1.m1.2.2.1.1.1.1.1.3.3.cmml" xref="S3.SS2.p4.1.m1.2.2.1.1.1.1.1.3.3">1</cn></apply></apply><ci id="S3.SS2.p4.1.m1.1.1.cmml" xref="S3.SS2.p4.1.m1.1.1">𝑘</ci></list><apply id="S3.SS2.p4.1.m1.2.2.1.1.3.cmml" xref="S3.SS2.p4.1.m1.2.2.1.1.3"><csymbol cd="ambiguous" id="S3.SS2.p4.1.m1.2.2.1.1.3.1.cmml" xref="S3.SS2.p4.1.m1.2.2.1.1.3">subscript</csymbol><ci id="S3.SS2.p4.1.m1.2.2.1.1.3.2.cmml" xref="S3.SS2.p4.1.m1.2.2.1.1.3.2">𝐿</ci><ci id="S3.SS2.p4.1.m1.2.2.1.1.3.3.cmml" xref="S3.SS2.p4.1.m1.2.2.1.1.3.3">𝑡</ci></apply></apply></set></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p4.1.m1.2c">\{S^{k}_{t+1},k\in L_{t}\}</annotation></semantics></math> as well as a global student model <math id="S3.SS2.p4.2.m2.1" class="ltx_Math" alttext="S_{t}" display="inline"><semantics id="S3.SS2.p4.2.m2.1a"><msub id="S3.SS2.p4.2.m2.1.1" xref="S3.SS2.p4.2.m2.1.1.cmml"><mi id="S3.SS2.p4.2.m2.1.1.2" xref="S3.SS2.p4.2.m2.1.1.2.cmml">S</mi><mi id="S3.SS2.p4.2.m2.1.1.3" xref="S3.SS2.p4.2.m2.1.1.3.cmml">t</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.p4.2.m2.1b"><apply id="S3.SS2.p4.2.m2.1.1.cmml" xref="S3.SS2.p4.2.m2.1.1"><csymbol cd="ambiguous" id="S3.SS2.p4.2.m2.1.1.1.cmml" xref="S3.SS2.p4.2.m2.1.1">subscript</csymbol><ci id="S3.SS2.p4.2.m2.1.1.2.cmml" xref="S3.SS2.p4.2.m2.1.1.2">𝑆</ci><ci id="S3.SS2.p4.2.m2.1.1.3.cmml" xref="S3.SS2.p4.2.m2.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p4.2.m2.1c">S_{t}</annotation></semantics></math>. For each client <math id="S3.SS2.p4.3.m3.1" class="ltx_Math" alttext="k" display="inline"><semantics id="S3.SS2.p4.3.m3.1a"><mi id="S3.SS2.p4.3.m3.1.1" xref="S3.SS2.p4.3.m3.1.1.cmml">k</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p4.3.m3.1b"><ci id="S3.SS2.p4.3.m3.1.1.cmml" xref="S3.SS2.p4.3.m3.1.1">𝑘</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p4.3.m3.1c">k</annotation></semantics></math>, the local teacher model <math id="S3.SS2.p4.4.m4.1" class="ltx_Math" alttext="T^{k}_{t}" display="inline"><semantics id="S3.SS2.p4.4.m4.1a"><msubsup id="S3.SS2.p4.4.m4.1.1" xref="S3.SS2.p4.4.m4.1.1.cmml"><mi id="S3.SS2.p4.4.m4.1.1.2.2" xref="S3.SS2.p4.4.m4.1.1.2.2.cmml">T</mi><mi id="S3.SS2.p4.4.m4.1.1.3" xref="S3.SS2.p4.4.m4.1.1.3.cmml">t</mi><mi id="S3.SS2.p4.4.m4.1.1.2.3" xref="S3.SS2.p4.4.m4.1.1.2.3.cmml">k</mi></msubsup><annotation-xml encoding="MathML-Content" id="S3.SS2.p4.4.m4.1b"><apply id="S3.SS2.p4.4.m4.1.1.cmml" xref="S3.SS2.p4.4.m4.1.1"><csymbol cd="ambiguous" id="S3.SS2.p4.4.m4.1.1.1.cmml" xref="S3.SS2.p4.4.m4.1.1">subscript</csymbol><apply id="S3.SS2.p4.4.m4.1.1.2.cmml" xref="S3.SS2.p4.4.m4.1.1"><csymbol cd="ambiguous" id="S3.SS2.p4.4.m4.1.1.2.1.cmml" xref="S3.SS2.p4.4.m4.1.1">superscript</csymbol><ci id="S3.SS2.p4.4.m4.1.1.2.2.cmml" xref="S3.SS2.p4.4.m4.1.1.2.2">𝑇</ci><ci id="S3.SS2.p4.4.m4.1.1.2.3.cmml" xref="S3.SS2.p4.4.m4.1.1.2.3">𝑘</ci></apply><ci id="S3.SS2.p4.4.m4.1.1.3.cmml" xref="S3.SS2.p4.4.m4.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p4.4.m4.1c">T^{k}_{t}</annotation></semantics></math> gets updated through EMA based on the local student model <math id="S3.SS2.p4.5.m5.1" class="ltx_Math" alttext="S^{k}_{t}" display="inline"><semantics id="S3.SS2.p4.5.m5.1a"><msubsup id="S3.SS2.p4.5.m5.1.1" xref="S3.SS2.p4.5.m5.1.1.cmml"><mi id="S3.SS2.p4.5.m5.1.1.2.2" xref="S3.SS2.p4.5.m5.1.1.2.2.cmml">S</mi><mi id="S3.SS2.p4.5.m5.1.1.3" xref="S3.SS2.p4.5.m5.1.1.3.cmml">t</mi><mi id="S3.SS2.p4.5.m5.1.1.2.3" xref="S3.SS2.p4.5.m5.1.1.2.3.cmml">k</mi></msubsup><annotation-xml encoding="MathML-Content" id="S3.SS2.p4.5.m5.1b"><apply id="S3.SS2.p4.5.m5.1.1.cmml" xref="S3.SS2.p4.5.m5.1.1"><csymbol cd="ambiguous" id="S3.SS2.p4.5.m5.1.1.1.cmml" xref="S3.SS2.p4.5.m5.1.1">subscript</csymbol><apply id="S3.SS2.p4.5.m5.1.1.2.cmml" xref="S3.SS2.p4.5.m5.1.1"><csymbol cd="ambiguous" id="S3.SS2.p4.5.m5.1.1.2.1.cmml" xref="S3.SS2.p4.5.m5.1.1">superscript</csymbol><ci id="S3.SS2.p4.5.m5.1.1.2.2.cmml" xref="S3.SS2.p4.5.m5.1.1.2.2">𝑆</ci><ci id="S3.SS2.p4.5.m5.1.1.2.3.cmml" xref="S3.SS2.p4.5.m5.1.1.2.3">𝑘</ci></apply><ci id="S3.SS2.p4.5.m5.1.1.3.cmml" xref="S3.SS2.p4.5.m5.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p4.5.m5.1c">S^{k}_{t}</annotation></semantics></math> which is located on the same device. The student models participate in the standard FL protocols, where they are trained using local client data and aggregated to form the server-side global student model. The global teacher <math id="S3.SS2.p4.6.m6.1" class="ltx_Math" alttext="T_{t}" display="inline"><semantics id="S3.SS2.p4.6.m6.1a"><msub id="S3.SS2.p4.6.m6.1.1" xref="S3.SS2.p4.6.m6.1.1.cmml"><mi id="S3.SS2.p4.6.m6.1.1.2" xref="S3.SS2.p4.6.m6.1.1.2.cmml">T</mi><mi id="S3.SS2.p4.6.m6.1.1.3" xref="S3.SS2.p4.6.m6.1.1.3.cmml">t</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.p4.6.m6.1b"><apply id="S3.SS2.p4.6.m6.1.1.cmml" xref="S3.SS2.p4.6.m6.1.1"><csymbol cd="ambiguous" id="S3.SS2.p4.6.m6.1.1.1.cmml" xref="S3.SS2.p4.6.m6.1.1">subscript</csymbol><ci id="S3.SS2.p4.6.m6.1.1.2.cmml" xref="S3.SS2.p4.6.m6.1.1.2">𝑇</ci><ci id="S3.SS2.p4.6.m6.1.1.3.cmml" xref="S3.SS2.p4.6.m6.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p4.6.m6.1c">T_{t}</annotation></semantics></math> is updated from the global student model <math id="S3.SS2.p4.7.m7.1" class="ltx_Math" alttext="S_{t}" display="inline"><semantics id="S3.SS2.p4.7.m7.1a"><msub id="S3.SS2.p4.7.m7.1.1" xref="S3.SS2.p4.7.m7.1.1.cmml"><mi id="S3.SS2.p4.7.m7.1.1.2" xref="S3.SS2.p4.7.m7.1.1.2.cmml">S</mi><mi id="S3.SS2.p4.7.m7.1.1.3" xref="S3.SS2.p4.7.m7.1.1.3.cmml">t</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.p4.7.m7.1b"><apply id="S3.SS2.p4.7.m7.1.1.cmml" xref="S3.SS2.p4.7.m7.1.1"><csymbol cd="ambiguous" id="S3.SS2.p4.7.m7.1.1.1.cmml" xref="S3.SS2.p4.7.m7.1.1">subscript</csymbol><ci id="S3.SS2.p4.7.m7.1.1.2.cmml" xref="S3.SS2.p4.7.m7.1.1.2">𝑆</ci><ci id="S3.SS2.p4.7.m7.1.1.3.cmml" xref="S3.SS2.p4.7.m7.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p4.7.m7.1c">S_{t}</annotation></semantics></math> through EMA as in Equation <a href="#S3.E1" title="Equation 1 ‣ 3.2 FSSL with teacher-student EMA models ‣ 3 Preliminaries ‣ When does the student surpass the teacher? Federated Semi-supervised Learning with Teacher-Student EMA" class="ltx_ref"><span class="ltx_text ltx_ref_tag">1</span></a> at the end of the <math id="S3.SS2.p4.8.m8.1" class="ltx_Math" alttext="t" display="inline"><semantics id="S3.SS2.p4.8.m8.1a"><mi id="S3.SS2.p4.8.m8.1.1" xref="S3.SS2.p4.8.m8.1.1.cmml">t</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p4.8.m8.1b"><ci id="S3.SS2.p4.8.m8.1.1.cmml" xref="S3.SS2.p4.8.m8.1.1">𝑡</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p4.8.m8.1c">t</annotation></semantics></math>-th round. The salient feature of this protocol is that we transmit the global teacher model to all clients at the end of each round to keep the global and local teachers synchronized. For the remainder of the paper, we refer to this approach as <span id="S3.SS2.p4.8.1" class="ltx_text ltx_font_italic">TS-Client EMA</span>.</p>
</div>
</section>
<section id="S3.SS3" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.3 </span>Practical challenges with EMA models in FL</h3>

<div id="S3.SS3.p1" class="ltx_para">
<p id="S3.SS3.p1.3" class="ltx_p">In Section <a href="#S3.SS2" title="3.2 FSSL with teacher-student EMA models ‣ 3 Preliminaries ‣ When does the student surpass the teacher? Federated Semi-supervised Learning with Teacher-Student EMA" class="ltx_ref"><span class="ltx_text ltx_ref_tag">3.2</span></a> we have described a potential approach to implementing teacher-student EMA models in a federated learning setting. This adaptation of EMA is the closest to the server-side (central) update mechanism - the teacher and student models are updated after every batch of data on their respective devices, and in every <math id="S3.SS3.p1.1.m1.1" class="ltx_Math" alttext="t" display="inline"><semantics id="S3.SS3.p1.1.m1.1a"><mi id="S3.SS3.p1.1.m1.1.1" xref="S3.SS3.p1.1.m1.1.1.cmml">t</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.p1.1.m1.1b"><ci id="S3.SS3.p1.1.m1.1.1.cmml" xref="S3.SS3.p1.1.m1.1.1">𝑡</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p1.1.m1.1c">t</annotation></semantics></math>-th communication round the updates from the local student models <math id="S3.SS3.p1.2.m2.1" class="ltx_Math" alttext="S^{k}_{t}" display="inline"><semantics id="S3.SS3.p1.2.m2.1a"><msubsup id="S3.SS3.p1.2.m2.1.1" xref="S3.SS3.p1.2.m2.1.1.cmml"><mi id="S3.SS3.p1.2.m2.1.1.2.2" xref="S3.SS3.p1.2.m2.1.1.2.2.cmml">S</mi><mi id="S3.SS3.p1.2.m2.1.1.3" xref="S3.SS3.p1.2.m2.1.1.3.cmml">t</mi><mi id="S3.SS3.p1.2.m2.1.1.2.3" xref="S3.SS3.p1.2.m2.1.1.2.3.cmml">k</mi></msubsup><annotation-xml encoding="MathML-Content" id="S3.SS3.p1.2.m2.1b"><apply id="S3.SS3.p1.2.m2.1.1.cmml" xref="S3.SS3.p1.2.m2.1.1"><csymbol cd="ambiguous" id="S3.SS3.p1.2.m2.1.1.1.cmml" xref="S3.SS3.p1.2.m2.1.1">subscript</csymbol><apply id="S3.SS3.p1.2.m2.1.1.2.cmml" xref="S3.SS3.p1.2.m2.1.1"><csymbol cd="ambiguous" id="S3.SS3.p1.2.m2.1.1.2.1.cmml" xref="S3.SS3.p1.2.m2.1.1">superscript</csymbol><ci id="S3.SS3.p1.2.m2.1.1.2.2.cmml" xref="S3.SS3.p1.2.m2.1.1.2.2">𝑆</ci><ci id="S3.SS3.p1.2.m2.1.1.2.3.cmml" xref="S3.SS3.p1.2.m2.1.1.2.3">𝑘</ci></apply><ci id="S3.SS3.p1.2.m2.1.1.3.cmml" xref="S3.SS3.p1.2.m2.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p1.2.m2.1c">S^{k}_{t}</annotation></semantics></math> on each <math id="S3.SS3.p1.3.m3.1" class="ltx_Math" alttext="k" display="inline"><semantics id="S3.SS3.p1.3.m3.1a"><mi id="S3.SS3.p1.3.m3.1.1" xref="S3.SS3.p1.3.m3.1.1.cmml">k</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.p1.3.m3.1b"><ci id="S3.SS3.p1.3.m3.1.1.cmml" xref="S3.SS3.p1.3.m3.1.1">𝑘</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p1.3.m3.1c">k</annotation></semantics></math>-th client are sent to the server along with the global teacher model being sent to each client for synchronization. This communication is in addition to the global student model being sent to the clients for local training, as well as local students being sent to the server for aggregation. Figure <a href="#S3.F1" title="Figure 1 ‣ 3.1 Real-world considerations for practical FSSL ‣ 3 Preliminaries ‣ When does the student surpass the teacher? Federated Semi-supervised Learning with Teacher-Student EMA" class="ltx_ref"><span class="ltx_text ltx_ref_tag">1</span></a> shows the teacher and student model transmission between clients and the server. The two-way additional communication overhead has the disadvantage of requiring a higher wall-clock time to reach a target performance in a production setting, due to the additional overhead of transmitting two models from the clients to the server, and in the other direction.</p>
</div>
<figure id="S3.F2" class="ltx_figure"><img src="/html/2301.10114/assets/figures/iidness_bar_labeled.png" id="S3.F2.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="598" height="107" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 2: </span>
Distribution of each client’s labeled examples over CIFAR-10 classes with increasing non-IIDness. Each row represents one client’s data and each color represents data from one class. At large <math id="S3.F2.4.m1.1" class="ltx_Math" alttext="\alpha" display="inline"><semantics id="S3.F2.4.m1.1b"><mi id="S3.F2.4.m1.1.1" xref="S3.F2.4.m1.1.1.cmml">α</mi><annotation-xml encoding="MathML-Content" id="S3.F2.4.m1.1c"><ci id="S3.F2.4.m1.1.1.cmml" xref="S3.F2.4.m1.1.1">𝛼</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.F2.4.m1.1d">\alpha</annotation></semantics></math>, data is mostly IID. As we decrease <math id="S3.F2.5.m2.1" class="ltx_Math" alttext="\alpha" display="inline"><semantics id="S3.F2.5.m2.1b"><mi id="S3.F2.5.m2.1.1" xref="S3.F2.5.m2.1.1.cmml">α</mi><annotation-xml encoding="MathML-Content" id="S3.F2.5.m2.1c"><ci id="S3.F2.5.m2.1.1.cmml" xref="S3.F2.5.m2.1.1">𝛼</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.F2.5.m2.1d">\alpha</annotation></semantics></math>, clients exhibit label skew, and at small <math id="S3.F2.6.m3.1" class="ltx_Math" alttext="\alpha" display="inline"><semantics id="S3.F2.6.m3.1b"><mi id="S3.F2.6.m3.1.1" xref="S3.F2.6.m3.1.1.cmml">α</mi><annotation-xml encoding="MathML-Content" id="S3.F2.6.m3.1c"><ci id="S3.F2.6.m3.1.1.cmml" xref="S3.F2.6.m3.1.1">𝛼</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.F2.6.m3.1d">\alpha</annotation></semantics></math>, each client only has data from 1-2 classes.</figcaption>
</figure>
<figure id="alg1" class="ltx_float ltx_float_algorithm ltx_framed ltx_framed_top">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_float"><span id="alg1.22.1.1" class="ltx_text ltx_font_bold">Algorithm 1</span> </span> 
<span id="alg1.23.2" class="ltx_text ltx_font_bold">Labels-at-Client.</span>
Client devices <math id="alg1.10.m1.3" class="ltx_Math" alttext="1,\dots,K" display="inline"><semantics id="alg1.10.m1.3b"><mrow id="alg1.10.m1.3.4.2" xref="alg1.10.m1.3.4.1.cmml"><mn id="alg1.10.m1.1.1" xref="alg1.10.m1.1.1.cmml">1</mn><mo id="alg1.10.m1.3.4.2.1" xref="alg1.10.m1.3.4.1.cmml">,</mo><mi mathvariant="normal" id="alg1.10.m1.2.2" xref="alg1.10.m1.2.2.cmml">…</mi><mo id="alg1.10.m1.3.4.2.2" xref="alg1.10.m1.3.4.1.cmml">,</mo><mi id="alg1.10.m1.3.3" xref="alg1.10.m1.3.3.cmml">K</mi></mrow><annotation-xml encoding="MathML-Content" id="alg1.10.m1.3c"><list id="alg1.10.m1.3.4.1.cmml" xref="alg1.10.m1.3.4.2"><cn type="integer" id="alg1.10.m1.1.1.cmml" xref="alg1.10.m1.1.1">1</cn><ci id="alg1.10.m1.2.2.cmml" xref="alg1.10.m1.2.2">…</ci><ci id="alg1.10.m1.3.3.cmml" xref="alg1.10.m1.3.3">𝐾</ci></list></annotation-xml><annotation encoding="application/x-tex" id="alg1.10.m1.3d">1,\dots,K</annotation></semantics></math>, participation rate <math id="alg1.11.m2.1" class="ltx_Math" alttext="C" display="inline"><semantics id="alg1.11.m2.1b"><mi id="alg1.11.m2.1.1" xref="alg1.11.m2.1.1.cmml">C</mi><annotation-xml encoding="MathML-Content" id="alg1.11.m2.1c"><ci id="alg1.11.m2.1.1.cmml" xref="alg1.11.m2.1.1">𝐶</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.11.m2.1d">C</annotation></semantics></math>, learning rate <math id="alg1.12.m3.1" class="ltx_Math" alttext="\eta" display="inline"><semantics id="alg1.12.m3.1b"><mi id="alg1.12.m3.1.1" xref="alg1.12.m3.1.1.cmml">η</mi><annotation-xml encoding="MathML-Content" id="alg1.12.m3.1c"><ci id="alg1.12.m3.1.1.cmml" xref="alg1.12.m3.1.1">𝜂</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.12.m3.1d">\eta</annotation></semantics></math>, number of local epochs <math id="alg1.13.m4.1" class="ltx_Math" alttext="E" display="inline"><semantics id="alg1.13.m4.1b"><mi id="alg1.13.m4.1.1" xref="alg1.13.m4.1.1.cmml">E</mi><annotation-xml encoding="MathML-Content" id="alg1.13.m4.1c"><ci id="alg1.13.m4.1.1.cmml" xref="alg1.13.m4.1.1">𝐸</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.13.m4.1d">E</annotation></semantics></math>, FixMatch parameter <math id="alg1.14.m5.1" class="ltx_Math" alttext="\lambda_{u}" display="inline"><semantics id="alg1.14.m5.1b"><msub id="alg1.14.m5.1.1" xref="alg1.14.m5.1.1.cmml"><mi id="alg1.14.m5.1.1.2" xref="alg1.14.m5.1.1.2.cmml">λ</mi><mi id="alg1.14.m5.1.1.3" xref="alg1.14.m5.1.1.3.cmml">u</mi></msub><annotation-xml encoding="MathML-Content" id="alg1.14.m5.1c"><apply id="alg1.14.m5.1.1.cmml" xref="alg1.14.m5.1.1"><csymbol cd="ambiguous" id="alg1.14.m5.1.1.1.cmml" xref="alg1.14.m5.1.1">subscript</csymbol><ci id="alg1.14.m5.1.1.2.cmml" xref="alg1.14.m5.1.1.2">𝜆</ci><ci id="alg1.14.m5.1.1.3.cmml" xref="alg1.14.m5.1.1.3">𝑢</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.14.m5.1d">\lambda_{u}</annotation></semantics></math>, FedProx parameter <math id="alg1.15.m6.1" class="ltx_Math" alttext="\mu" display="inline"><semantics id="alg1.15.m6.1b"><mi id="alg1.15.m6.1.1" xref="alg1.15.m6.1.1.cmml">μ</mi><annotation-xml encoding="MathML-Content" id="alg1.15.m6.1c"><ci id="alg1.15.m6.1.1.cmml" xref="alg1.15.m6.1.1">𝜇</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.15.m6.1d">\mu</annotation></semantics></math>, EMA ratio <math id="alg1.16.m7.1" class="ltx_Math" alttext="\alpha" display="inline"><semantics id="alg1.16.m7.1b"><mi id="alg1.16.m7.1.1" xref="alg1.16.m7.1.1.cmml">α</mi><annotation-xml encoding="MathML-Content" id="alg1.16.m7.1c"><ci id="alg1.16.m7.1.1.cmml" xref="alg1.16.m7.1.1">𝛼</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.16.m7.1d">\alpha</annotation></semantics></math>. In practice, <span id="alg1.24.3" class="ltx_text ltx_font_bold">ClientUpdate</span> returns the difference <math id="alg1.17.m8.1" class="ltx_Math" alttext="S-S^{s}" display="inline"><semantics id="alg1.17.m8.1b"><mrow id="alg1.17.m8.1.1" xref="alg1.17.m8.1.1.cmml"><mi id="alg1.17.m8.1.1.2" xref="alg1.17.m8.1.1.2.cmml">S</mi><mo id="alg1.17.m8.1.1.1" xref="alg1.17.m8.1.1.1.cmml">−</mo><msup id="alg1.17.m8.1.1.3" xref="alg1.17.m8.1.1.3.cmml"><mi id="alg1.17.m8.1.1.3.2" xref="alg1.17.m8.1.1.3.2.cmml">S</mi><mi id="alg1.17.m8.1.1.3.3" xref="alg1.17.m8.1.1.3.3.cmml">s</mi></msup></mrow><annotation-xml encoding="MathML-Content" id="alg1.17.m8.1c"><apply id="alg1.17.m8.1.1.cmml" xref="alg1.17.m8.1.1"><minus id="alg1.17.m8.1.1.1.cmml" xref="alg1.17.m8.1.1.1"></minus><ci id="alg1.17.m8.1.1.2.cmml" xref="alg1.17.m8.1.1.2">𝑆</ci><apply id="alg1.17.m8.1.1.3.cmml" xref="alg1.17.m8.1.1.3"><csymbol cd="ambiguous" id="alg1.17.m8.1.1.3.1.cmml" xref="alg1.17.m8.1.1.3">superscript</csymbol><ci id="alg1.17.m8.1.1.3.2.cmml" xref="alg1.17.m8.1.1.3.2">𝑆</ci><ci id="alg1.17.m8.1.1.3.3.cmml" xref="alg1.17.m8.1.1.3.3">𝑠</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.17.m8.1d">S-S^{s}</annotation></semantics></math> instead of <math id="alg1.18.m9.1" class="ltx_Math" alttext="S" display="inline"><semantics id="alg1.18.m9.1b"><mi id="alg1.18.m9.1.1" xref="alg1.18.m9.1.1.cmml">S</mi><annotation-xml encoding="MathML-Content" id="alg1.18.m9.1c"><ci id="alg1.18.m9.1.1.cmml" xref="alg1.18.m9.1.1">𝑆</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.18.m9.1d">S</annotation></semantics></math>.</figcaption>
<div id="alg1.25" class="ltx_listing ltx_listing">
<div id="alg1.l1" class="ltx_listingline">
<span id="alg1.l1.1" class="ltx_text" style="font-size:70%;"> </span><span id="alg1.l1.2" class="ltx_text ltx_font_bold" style="font-size:70%;">Server executes:</span><span id="alg1.l1.3" class="ltx_text" style="font-size:70%;">
</span>
</div>
<div id="alg1.l2" class="ltx_listingline">
<span id="alg1.l2.1" class="ltx_text" style="font-size:70%;"> initialize global
student model </span><math id="alg1.l2.m1.1" class="ltx_Math" alttext="S_{0}" display="inline"><semantics id="alg1.l2.m1.1a"><msub id="alg1.l2.m1.1.1" xref="alg1.l2.m1.1.1.cmml"><mi mathsize="70%" id="alg1.l2.m1.1.1.2" xref="alg1.l2.m1.1.1.2.cmml">S</mi><mn mathsize="70%" id="alg1.l2.m1.1.1.3" xref="alg1.l2.m1.1.1.3.cmml">0</mn></msub><annotation-xml encoding="MathML-Content" id="alg1.l2.m1.1b"><apply id="alg1.l2.m1.1.1.cmml" xref="alg1.l2.m1.1.1"><csymbol cd="ambiguous" id="alg1.l2.m1.1.1.1.cmml" xref="alg1.l2.m1.1.1">subscript</csymbol><ci id="alg1.l2.m1.1.1.2.cmml" xref="alg1.l2.m1.1.1.2">𝑆</ci><cn type="integer" id="alg1.l2.m1.1.1.3.cmml" xref="alg1.l2.m1.1.1.3">0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l2.m1.1c">S_{0}</annotation></semantics></math><span id="alg1.l2.2" class="ltx_text" style="font-size:70%;"> and teacher model </span><math id="alg1.l2.m2.1" class="ltx_Math" alttext="T_{0}" display="inline"><semantics id="alg1.l2.m2.1a"><msub id="alg1.l2.m2.1.1" xref="alg1.l2.m2.1.1.cmml"><mi mathsize="70%" id="alg1.l2.m2.1.1.2" xref="alg1.l2.m2.1.1.2.cmml">T</mi><mn mathsize="70%" id="alg1.l2.m2.1.1.3" xref="alg1.l2.m2.1.1.3.cmml">0</mn></msub><annotation-xml encoding="MathML-Content" id="alg1.l2.m2.1b"><apply id="alg1.l2.m2.1.1.cmml" xref="alg1.l2.m2.1.1"><csymbol cd="ambiguous" id="alg1.l2.m2.1.1.1.cmml" xref="alg1.l2.m2.1.1">subscript</csymbol><ci id="alg1.l2.m2.1.1.2.cmml" xref="alg1.l2.m2.1.1.2">𝑇</ci><cn type="integer" id="alg1.l2.m2.1.1.3.cmml" xref="alg1.l2.m2.1.1.3">0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l2.m2.1c">T_{0}</annotation></semantics></math><span id="alg1.l2.3" class="ltx_text" style="font-size:70%;">
</span>
</div>
<div id="alg1.l3" class="ltx_listingline">
<span id="alg1.l3.1" class="ltx_text" style="font-size:70%;"> </span><span id="alg1.l3.2" class="ltx_text ltx_font_bold" style="font-size:70%;">for</span><span id="alg1.l3.3" class="ltx_text" style="font-size:70%;"> each round </span><math id="alg1.l3.m1.3" class="ltx_Math" alttext="t=1,2,\dots" display="inline"><semantics id="alg1.l3.m1.3a"><mrow id="alg1.l3.m1.3.4" xref="alg1.l3.m1.3.4.cmml"><mi mathsize="70%" id="alg1.l3.m1.3.4.2" xref="alg1.l3.m1.3.4.2.cmml">t</mi><mo mathsize="70%" id="alg1.l3.m1.3.4.1" xref="alg1.l3.m1.3.4.1.cmml">=</mo><mrow id="alg1.l3.m1.3.4.3.2" xref="alg1.l3.m1.3.4.3.1.cmml"><mn mathsize="70%" id="alg1.l3.m1.1.1" xref="alg1.l3.m1.1.1.cmml">1</mn><mo mathsize="70%" id="alg1.l3.m1.3.4.3.2.1" xref="alg1.l3.m1.3.4.3.1.cmml">,</mo><mn mathsize="70%" id="alg1.l3.m1.2.2" xref="alg1.l3.m1.2.2.cmml">2</mn><mo mathsize="70%" id="alg1.l3.m1.3.4.3.2.2" xref="alg1.l3.m1.3.4.3.1.cmml">,</mo><mi mathsize="70%" mathvariant="normal" id="alg1.l3.m1.3.3" xref="alg1.l3.m1.3.3.cmml">…</mi></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l3.m1.3b"><apply id="alg1.l3.m1.3.4.cmml" xref="alg1.l3.m1.3.4"><eq id="alg1.l3.m1.3.4.1.cmml" xref="alg1.l3.m1.3.4.1"></eq><ci id="alg1.l3.m1.3.4.2.cmml" xref="alg1.l3.m1.3.4.2">𝑡</ci><list id="alg1.l3.m1.3.4.3.1.cmml" xref="alg1.l3.m1.3.4.3.2"><cn type="integer" id="alg1.l3.m1.1.1.cmml" xref="alg1.l3.m1.1.1">1</cn><cn type="integer" id="alg1.l3.m1.2.2.cmml" xref="alg1.l3.m1.2.2">2</cn><ci id="alg1.l3.m1.3.3.cmml" xref="alg1.l3.m1.3.3">…</ci></list></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l3.m1.3c">t=1,2,\dots</annotation></semantics></math><span id="alg1.l3.4" class="ltx_text" style="font-size:70%;"> </span><span id="alg1.l3.5" class="ltx_text ltx_font_bold" style="font-size:70%;">do</span><span id="alg1.l3.6" class="ltx_text" style="font-size:70%;">


</span>
</div>
<div id="alg1.l4" class="ltx_listingline">
<span id="alg1.l4.1" class="ltx_text" style="font-size:70%;">    </span><math id="alg1.l4.m1.3" class="ltx_Math" alttext="m\leftarrow\max(C\cdot K,1)" display="inline"><semantics id="alg1.l4.m1.3a"><mrow id="alg1.l4.m1.3.3" xref="alg1.l4.m1.3.3.cmml"><mi mathsize="70%" id="alg1.l4.m1.3.3.3" xref="alg1.l4.m1.3.3.3.cmml">m</mi><mo mathsize="70%" stretchy="false" id="alg1.l4.m1.3.3.2" xref="alg1.l4.m1.3.3.2.cmml">←</mo><mrow id="alg1.l4.m1.3.3.1.1" xref="alg1.l4.m1.3.3.1.2.cmml"><mi mathsize="70%" id="alg1.l4.m1.1.1" xref="alg1.l4.m1.1.1.cmml">max</mi><mo id="alg1.l4.m1.3.3.1.1a" xref="alg1.l4.m1.3.3.1.2.cmml">⁡</mo><mrow id="alg1.l4.m1.3.3.1.1.1" xref="alg1.l4.m1.3.3.1.2.cmml"><mo maxsize="70%" minsize="70%" id="alg1.l4.m1.3.3.1.1.1.2" xref="alg1.l4.m1.3.3.1.2.cmml">(</mo><mrow id="alg1.l4.m1.3.3.1.1.1.1" xref="alg1.l4.m1.3.3.1.1.1.1.cmml"><mi mathsize="70%" id="alg1.l4.m1.3.3.1.1.1.1.2" xref="alg1.l4.m1.3.3.1.1.1.1.2.cmml">C</mi><mo lspace="0.222em" mathsize="70%" rspace="0.222em" id="alg1.l4.m1.3.3.1.1.1.1.1" xref="alg1.l4.m1.3.3.1.1.1.1.1.cmml">⋅</mo><mi mathsize="70%" id="alg1.l4.m1.3.3.1.1.1.1.3" xref="alg1.l4.m1.3.3.1.1.1.1.3.cmml">K</mi></mrow><mo mathsize="70%" id="alg1.l4.m1.3.3.1.1.1.3" xref="alg1.l4.m1.3.3.1.2.cmml">,</mo><mn mathsize="70%" id="alg1.l4.m1.2.2" xref="alg1.l4.m1.2.2.cmml">1</mn><mo maxsize="70%" minsize="70%" id="alg1.l4.m1.3.3.1.1.1.4" xref="alg1.l4.m1.3.3.1.2.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l4.m1.3b"><apply id="alg1.l4.m1.3.3.cmml" xref="alg1.l4.m1.3.3"><ci id="alg1.l4.m1.3.3.2.cmml" xref="alg1.l4.m1.3.3.2">←</ci><ci id="alg1.l4.m1.3.3.3.cmml" xref="alg1.l4.m1.3.3.3">𝑚</ci><apply id="alg1.l4.m1.3.3.1.2.cmml" xref="alg1.l4.m1.3.3.1.1"><max id="alg1.l4.m1.1.1.cmml" xref="alg1.l4.m1.1.1"></max><apply id="alg1.l4.m1.3.3.1.1.1.1.cmml" xref="alg1.l4.m1.3.3.1.1.1.1"><ci id="alg1.l4.m1.3.3.1.1.1.1.1.cmml" xref="alg1.l4.m1.3.3.1.1.1.1.1">⋅</ci><ci id="alg1.l4.m1.3.3.1.1.1.1.2.cmml" xref="alg1.l4.m1.3.3.1.1.1.1.2">𝐶</ci><ci id="alg1.l4.m1.3.3.1.1.1.1.3.cmml" xref="alg1.l4.m1.3.3.1.1.1.1.3">𝐾</ci></apply><cn type="integer" id="alg1.l4.m1.2.2.cmml" xref="alg1.l4.m1.2.2">1</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l4.m1.3c">m\leftarrow\max(C\cdot K,1)</annotation></semantics></math><span id="alg1.l4.2" class="ltx_text" style="font-size:70%;">
</span>
</div>
<div id="alg1.l5" class="ltx_listingline">
<span id="alg1.l5.1" class="ltx_text" style="font-size:70%;">    </span><math id="alg1.l5.m1.1" class="ltx_Math" alttext="L_{t}\leftarrow" display="inline"><semantics id="alg1.l5.m1.1a"><mrow id="alg1.l5.m1.1.1" xref="alg1.l5.m1.1.1.cmml"><msub id="alg1.l5.m1.1.1.2" xref="alg1.l5.m1.1.1.2.cmml"><mi mathsize="70%" id="alg1.l5.m1.1.1.2.2" xref="alg1.l5.m1.1.1.2.2.cmml">L</mi><mi mathsize="70%" id="alg1.l5.m1.1.1.2.3" xref="alg1.l5.m1.1.1.2.3.cmml">t</mi></msub><mo mathsize="70%" stretchy="false" id="alg1.l5.m1.1.1.1" xref="alg1.l5.m1.1.1.1.cmml">←</mo><mi id="alg1.l5.m1.1.1.3" xref="alg1.l5.m1.1.1.3.cmml"></mi></mrow><annotation-xml encoding="MathML-Content" id="alg1.l5.m1.1b"><apply id="alg1.l5.m1.1.1.cmml" xref="alg1.l5.m1.1.1"><ci id="alg1.l5.m1.1.1.1.cmml" xref="alg1.l5.m1.1.1.1">←</ci><apply id="alg1.l5.m1.1.1.2.cmml" xref="alg1.l5.m1.1.1.2"><csymbol cd="ambiguous" id="alg1.l5.m1.1.1.2.1.cmml" xref="alg1.l5.m1.1.1.2">subscript</csymbol><ci id="alg1.l5.m1.1.1.2.2.cmml" xref="alg1.l5.m1.1.1.2.2">𝐿</ci><ci id="alg1.l5.m1.1.1.2.3.cmml" xref="alg1.l5.m1.1.1.2.3">𝑡</ci></apply><csymbol cd="latexml" id="alg1.l5.m1.1.1.3.cmml" xref="alg1.l5.m1.1.1.3">absent</csymbol></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l5.m1.1c">L_{t}\leftarrow</annotation></semantics></math><span id="alg1.l5.2" class="ltx_text" style="font-size:70%;"> (random set of </span><math id="alg1.l5.m2.1" class="ltx_Math" alttext="m" display="inline"><semantics id="alg1.l5.m2.1a"><mi mathsize="70%" id="alg1.l5.m2.1.1" xref="alg1.l5.m2.1.1.cmml">m</mi><annotation-xml encoding="MathML-Content" id="alg1.l5.m2.1b"><ci id="alg1.l5.m2.1.1.cmml" xref="alg1.l5.m2.1.1">𝑚</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.l5.m2.1c">m</annotation></semantics></math><span id="alg1.l5.3" class="ltx_text" style="font-size:70%;"> clients)
</span>
</div>
<div id="alg1.l6" class="ltx_listingline">
<span id="alg1.l6.1" class="ltx_text" style="font-size:70%;">    </span><span id="alg1.l6.2" class="ltx_text ltx_font_bold" style="font-size:70%;">if</span><span id="alg1.l6.3" class="ltx_text" style="font-size:70%;"> </span><math id="alg1.l6.m1.2" class="ltx_Math" alttext="|D_{\text{KL}}^{T}-\beta|&lt;|D_{\text{KL}}^{S}-\beta|" display="inline"><semantics id="alg1.l6.m1.2a"><mrow id="alg1.l6.m1.2.2" xref="alg1.l6.m1.2.2.cmml"><mrow id="alg1.l6.m1.1.1.1.1" xref="alg1.l6.m1.1.1.1.2.cmml"><mo maxsize="70%" minsize="70%" id="alg1.l6.m1.1.1.1.1.2" xref="alg1.l6.m1.1.1.1.2.1.cmml">|</mo><mrow id="alg1.l6.m1.1.1.1.1.1" xref="alg1.l6.m1.1.1.1.1.1.cmml"><msubsup id="alg1.l6.m1.1.1.1.1.1.2" xref="alg1.l6.m1.1.1.1.1.1.2.cmml"><mi mathsize="70%" id="alg1.l6.m1.1.1.1.1.1.2.2.2" xref="alg1.l6.m1.1.1.1.1.1.2.2.2.cmml">D</mi><mtext mathsize="70%" id="alg1.l6.m1.1.1.1.1.1.2.2.3" xref="alg1.l6.m1.1.1.1.1.1.2.2.3a.cmml">KL</mtext><mi mathsize="70%" id="alg1.l6.m1.1.1.1.1.1.2.3" xref="alg1.l6.m1.1.1.1.1.1.2.3.cmml">T</mi></msubsup><mo mathsize="70%" id="alg1.l6.m1.1.1.1.1.1.1" xref="alg1.l6.m1.1.1.1.1.1.1.cmml">−</mo><mi mathsize="70%" id="alg1.l6.m1.1.1.1.1.1.3" xref="alg1.l6.m1.1.1.1.1.1.3.cmml">β</mi></mrow><mo maxsize="70%" minsize="70%" id="alg1.l6.m1.1.1.1.1.3" xref="alg1.l6.m1.1.1.1.2.1.cmml">|</mo></mrow><mo mathsize="70%" id="alg1.l6.m1.2.2.3" xref="alg1.l6.m1.2.2.3.cmml">&lt;</mo><mrow id="alg1.l6.m1.2.2.2.1" xref="alg1.l6.m1.2.2.2.2.cmml"><mo maxsize="70%" minsize="70%" id="alg1.l6.m1.2.2.2.1.2" xref="alg1.l6.m1.2.2.2.2.1.cmml">|</mo><mrow id="alg1.l6.m1.2.2.2.1.1" xref="alg1.l6.m1.2.2.2.1.1.cmml"><msubsup id="alg1.l6.m1.2.2.2.1.1.2" xref="alg1.l6.m1.2.2.2.1.1.2.cmml"><mi mathsize="70%" id="alg1.l6.m1.2.2.2.1.1.2.2.2" xref="alg1.l6.m1.2.2.2.1.1.2.2.2.cmml">D</mi><mtext mathsize="70%" id="alg1.l6.m1.2.2.2.1.1.2.2.3" xref="alg1.l6.m1.2.2.2.1.1.2.2.3a.cmml">KL</mtext><mi mathsize="70%" id="alg1.l6.m1.2.2.2.1.1.2.3" xref="alg1.l6.m1.2.2.2.1.1.2.3.cmml">S</mi></msubsup><mo mathsize="70%" id="alg1.l6.m1.2.2.2.1.1.1" xref="alg1.l6.m1.2.2.2.1.1.1.cmml">−</mo><mi mathsize="70%" id="alg1.l6.m1.2.2.2.1.1.3" xref="alg1.l6.m1.2.2.2.1.1.3.cmml">β</mi></mrow><mo maxsize="70%" minsize="70%" id="alg1.l6.m1.2.2.2.1.3" xref="alg1.l6.m1.2.2.2.2.1.cmml">|</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l6.m1.2b"><apply id="alg1.l6.m1.2.2.cmml" xref="alg1.l6.m1.2.2"><lt id="alg1.l6.m1.2.2.3.cmml" xref="alg1.l6.m1.2.2.3"></lt><apply id="alg1.l6.m1.1.1.1.2.cmml" xref="alg1.l6.m1.1.1.1.1"><abs id="alg1.l6.m1.1.1.1.2.1.cmml" xref="alg1.l6.m1.1.1.1.1.2"></abs><apply id="alg1.l6.m1.1.1.1.1.1.cmml" xref="alg1.l6.m1.1.1.1.1.1"><minus id="alg1.l6.m1.1.1.1.1.1.1.cmml" xref="alg1.l6.m1.1.1.1.1.1.1"></minus><apply id="alg1.l6.m1.1.1.1.1.1.2.cmml" xref="alg1.l6.m1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="alg1.l6.m1.1.1.1.1.1.2.1.cmml" xref="alg1.l6.m1.1.1.1.1.1.2">superscript</csymbol><apply id="alg1.l6.m1.1.1.1.1.1.2.2.cmml" xref="alg1.l6.m1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="alg1.l6.m1.1.1.1.1.1.2.2.1.cmml" xref="alg1.l6.m1.1.1.1.1.1.2">subscript</csymbol><ci id="alg1.l6.m1.1.1.1.1.1.2.2.2.cmml" xref="alg1.l6.m1.1.1.1.1.1.2.2.2">𝐷</ci><ci id="alg1.l6.m1.1.1.1.1.1.2.2.3a.cmml" xref="alg1.l6.m1.1.1.1.1.1.2.2.3"><mtext mathsize="49%" id="alg1.l6.m1.1.1.1.1.1.2.2.3.cmml" xref="alg1.l6.m1.1.1.1.1.1.2.2.3">KL</mtext></ci></apply><ci id="alg1.l6.m1.1.1.1.1.1.2.3.cmml" xref="alg1.l6.m1.1.1.1.1.1.2.3">𝑇</ci></apply><ci id="alg1.l6.m1.1.1.1.1.1.3.cmml" xref="alg1.l6.m1.1.1.1.1.1.3">𝛽</ci></apply></apply><apply id="alg1.l6.m1.2.2.2.2.cmml" xref="alg1.l6.m1.2.2.2.1"><abs id="alg1.l6.m1.2.2.2.2.1.cmml" xref="alg1.l6.m1.2.2.2.1.2"></abs><apply id="alg1.l6.m1.2.2.2.1.1.cmml" xref="alg1.l6.m1.2.2.2.1.1"><minus id="alg1.l6.m1.2.2.2.1.1.1.cmml" xref="alg1.l6.m1.2.2.2.1.1.1"></minus><apply id="alg1.l6.m1.2.2.2.1.1.2.cmml" xref="alg1.l6.m1.2.2.2.1.1.2"><csymbol cd="ambiguous" id="alg1.l6.m1.2.2.2.1.1.2.1.cmml" xref="alg1.l6.m1.2.2.2.1.1.2">superscript</csymbol><apply id="alg1.l6.m1.2.2.2.1.1.2.2.cmml" xref="alg1.l6.m1.2.2.2.1.1.2"><csymbol cd="ambiguous" id="alg1.l6.m1.2.2.2.1.1.2.2.1.cmml" xref="alg1.l6.m1.2.2.2.1.1.2">subscript</csymbol><ci id="alg1.l6.m1.2.2.2.1.1.2.2.2.cmml" xref="alg1.l6.m1.2.2.2.1.1.2.2.2">𝐷</ci><ci id="alg1.l6.m1.2.2.2.1.1.2.2.3a.cmml" xref="alg1.l6.m1.2.2.2.1.1.2.2.3"><mtext mathsize="49%" id="alg1.l6.m1.2.2.2.1.1.2.2.3.cmml" xref="alg1.l6.m1.2.2.2.1.1.2.2.3">KL</mtext></ci></apply><ci id="alg1.l6.m1.2.2.2.1.1.2.3.cmml" xref="alg1.l6.m1.2.2.2.1.1.2.3">𝑆</ci></apply><ci id="alg1.l6.m1.2.2.2.1.1.3.cmml" xref="alg1.l6.m1.2.2.2.1.1.3">𝛽</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l6.m1.2c">|D_{\text{KL}}^{T}-\beta|&lt;|D_{\text{KL}}^{S}-\beta|</annotation></semantics></math><span id="alg1.l6.4" class="ltx_text" style="font-size:70%;"> </span><span id="alg1.l6.5" class="ltx_text ltx_font_bold" style="font-size:70%;">then</span><span id="alg1.l6.6" class="ltx_text" style="font-size:70%;">


</span>
</div>
<div id="alg1.l7" class="ltx_listingline">
<span id="alg1.l7.1" class="ltx_text" style="font-size:70%;">      </span><math id="alg1.l7.m1.1" class="ltx_Math" alttext="T_{t}^{\prime}\leftarrow\emptyset" display="inline"><semantics id="alg1.l7.m1.1a"><mrow id="alg1.l7.m1.1.1" xref="alg1.l7.m1.1.1.cmml"><msubsup id="alg1.l7.m1.1.1.2" xref="alg1.l7.m1.1.1.2.cmml"><mi mathsize="70%" id="alg1.l7.m1.1.1.2.2.2" xref="alg1.l7.m1.1.1.2.2.2.cmml">T</mi><mi mathsize="70%" id="alg1.l7.m1.1.1.2.2.3" xref="alg1.l7.m1.1.1.2.2.3.cmml">t</mi><mo mathsize="70%" id="alg1.l7.m1.1.1.2.3" xref="alg1.l7.m1.1.1.2.3.cmml">′</mo></msubsup><mo mathsize="70%" stretchy="false" id="alg1.l7.m1.1.1.1" xref="alg1.l7.m1.1.1.1.cmml">←</mo><mi mathsize="70%" mathvariant="normal" id="alg1.l7.m1.1.1.3" xref="alg1.l7.m1.1.1.3.cmml">∅</mi></mrow><annotation-xml encoding="MathML-Content" id="alg1.l7.m1.1b"><apply id="alg1.l7.m1.1.1.cmml" xref="alg1.l7.m1.1.1"><ci id="alg1.l7.m1.1.1.1.cmml" xref="alg1.l7.m1.1.1.1">←</ci><apply id="alg1.l7.m1.1.1.2.cmml" xref="alg1.l7.m1.1.1.2"><csymbol cd="ambiguous" id="alg1.l7.m1.1.1.2.1.cmml" xref="alg1.l7.m1.1.1.2">superscript</csymbol><apply id="alg1.l7.m1.1.1.2.2.cmml" xref="alg1.l7.m1.1.1.2"><csymbol cd="ambiguous" id="alg1.l7.m1.1.1.2.2.1.cmml" xref="alg1.l7.m1.1.1.2">subscript</csymbol><ci id="alg1.l7.m1.1.1.2.2.2.cmml" xref="alg1.l7.m1.1.1.2.2.2">𝑇</ci><ci id="alg1.l7.m1.1.1.2.2.3.cmml" xref="alg1.l7.m1.1.1.2.2.3">𝑡</ci></apply><ci id="alg1.l7.m1.1.1.2.3.cmml" xref="alg1.l7.m1.1.1.2.3">′</ci></apply><emptyset id="alg1.l7.m1.1.1.3.cmml" xref="alg1.l7.m1.1.1.3"></emptyset></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l7.m1.1c">T_{t}^{\prime}\leftarrow\emptyset</annotation></semantics></math><span id="alg1.l7.2" class="ltx_text" style="font-size:70%;">
</span>
</div>
<div id="alg1.l8" class="ltx_listingline">
<span id="alg1.l8.1" class="ltx_text" style="font-size:70%;">    </span><span id="alg1.l8.2" class="ltx_text ltx_font_bold" style="font-size:70%;">else</span><span id="alg1.l8.3" class="ltx_text" style="font-size:70%;">

</span>
</div>
<div id="alg1.l9" class="ltx_listingline">
<span id="alg1.l9.1" class="ltx_text" style="font-size:70%;">      </span><math id="alg1.l9.m1.1" class="ltx_Math" alttext="T_{t}^{\prime}\leftarrow T_{t}" display="inline"><semantics id="alg1.l9.m1.1a"><mrow id="alg1.l9.m1.1.1" xref="alg1.l9.m1.1.1.cmml"><msubsup id="alg1.l9.m1.1.1.2" xref="alg1.l9.m1.1.1.2.cmml"><mi mathsize="70%" id="alg1.l9.m1.1.1.2.2.2" xref="alg1.l9.m1.1.1.2.2.2.cmml">T</mi><mi mathsize="70%" id="alg1.l9.m1.1.1.2.2.3" xref="alg1.l9.m1.1.1.2.2.3.cmml">t</mi><mo mathsize="70%" id="alg1.l9.m1.1.1.2.3" xref="alg1.l9.m1.1.1.2.3.cmml">′</mo></msubsup><mo mathsize="70%" stretchy="false" id="alg1.l9.m1.1.1.1" xref="alg1.l9.m1.1.1.1.cmml">←</mo><msub id="alg1.l9.m1.1.1.3" xref="alg1.l9.m1.1.1.3.cmml"><mi mathsize="70%" id="alg1.l9.m1.1.1.3.2" xref="alg1.l9.m1.1.1.3.2.cmml">T</mi><mi mathsize="70%" id="alg1.l9.m1.1.1.3.3" xref="alg1.l9.m1.1.1.3.3.cmml">t</mi></msub></mrow><annotation-xml encoding="MathML-Content" id="alg1.l9.m1.1b"><apply id="alg1.l9.m1.1.1.cmml" xref="alg1.l9.m1.1.1"><ci id="alg1.l9.m1.1.1.1.cmml" xref="alg1.l9.m1.1.1.1">←</ci><apply id="alg1.l9.m1.1.1.2.cmml" xref="alg1.l9.m1.1.1.2"><csymbol cd="ambiguous" id="alg1.l9.m1.1.1.2.1.cmml" xref="alg1.l9.m1.1.1.2">superscript</csymbol><apply id="alg1.l9.m1.1.1.2.2.cmml" xref="alg1.l9.m1.1.1.2"><csymbol cd="ambiguous" id="alg1.l9.m1.1.1.2.2.1.cmml" xref="alg1.l9.m1.1.1.2">subscript</csymbol><ci id="alg1.l9.m1.1.1.2.2.2.cmml" xref="alg1.l9.m1.1.1.2.2.2">𝑇</ci><ci id="alg1.l9.m1.1.1.2.2.3.cmml" xref="alg1.l9.m1.1.1.2.2.3">𝑡</ci></apply><ci id="alg1.l9.m1.1.1.2.3.cmml" xref="alg1.l9.m1.1.1.2.3">′</ci></apply><apply id="alg1.l9.m1.1.1.3.cmml" xref="alg1.l9.m1.1.1.3"><csymbol cd="ambiguous" id="alg1.l9.m1.1.1.3.1.cmml" xref="alg1.l9.m1.1.1.3">subscript</csymbol><ci id="alg1.l9.m1.1.1.3.2.cmml" xref="alg1.l9.m1.1.1.3.2">𝑇</ci><ci id="alg1.l9.m1.1.1.3.3.cmml" xref="alg1.l9.m1.1.1.3.3">𝑡</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l9.m1.1c">T_{t}^{\prime}\leftarrow T_{t}</annotation></semantics></math><span id="alg1.l9.2" class="ltx_text" style="font-size:70%;">
</span>
</div>
<div id="alg1.l10" class="ltx_listingline">
<span id="alg1.l10.1" class="ltx_text" style="font-size:70%;">    </span><span id="alg1.l10.2" class="ltx_text ltx_font_bold" style="font-size:70%;">end</span><span id="alg1.l10.3" class="ltx_text" style="font-size:70%;"> </span><span id="alg1.l10.4" class="ltx_text ltx_font_bold" style="font-size:70%;">if</span>
</div>
<div id="alg1.l11" class="ltx_listingline">
<span id="alg1.l11.1" class="ltx_text" style="font-size:70%;">    </span><span id="alg1.l11.2" class="ltx_text ltx_font_bold" style="font-size:70%;">for</span><span id="alg1.l11.3" class="ltx_text" style="font-size:70%;"> each client </span><math id="alg1.l11.m1.1" class="ltx_Math" alttext="k\in L_{t}" display="inline"><semantics id="alg1.l11.m1.1a"><mrow id="alg1.l11.m1.1.1" xref="alg1.l11.m1.1.1.cmml"><mi mathsize="70%" id="alg1.l11.m1.1.1.2" xref="alg1.l11.m1.1.1.2.cmml">k</mi><mo mathsize="70%" id="alg1.l11.m1.1.1.1" xref="alg1.l11.m1.1.1.1.cmml">∈</mo><msub id="alg1.l11.m1.1.1.3" xref="alg1.l11.m1.1.1.3.cmml"><mi mathsize="70%" id="alg1.l11.m1.1.1.3.2" xref="alg1.l11.m1.1.1.3.2.cmml">L</mi><mi mathsize="70%" id="alg1.l11.m1.1.1.3.3" xref="alg1.l11.m1.1.1.3.3.cmml">t</mi></msub></mrow><annotation-xml encoding="MathML-Content" id="alg1.l11.m1.1b"><apply id="alg1.l11.m1.1.1.cmml" xref="alg1.l11.m1.1.1"><in id="alg1.l11.m1.1.1.1.cmml" xref="alg1.l11.m1.1.1.1"></in><ci id="alg1.l11.m1.1.1.2.cmml" xref="alg1.l11.m1.1.1.2">𝑘</ci><apply id="alg1.l11.m1.1.1.3.cmml" xref="alg1.l11.m1.1.1.3"><csymbol cd="ambiguous" id="alg1.l11.m1.1.1.3.1.cmml" xref="alg1.l11.m1.1.1.3">subscript</csymbol><ci id="alg1.l11.m1.1.1.3.2.cmml" xref="alg1.l11.m1.1.1.3.2">𝐿</ci><ci id="alg1.l11.m1.1.1.3.3.cmml" xref="alg1.l11.m1.1.1.3.3">𝑡</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l11.m1.1c">k\in L_{t}</annotation></semantics></math><span id="alg1.l11.4" class="ltx_text" style="font-size:70%;"> </span><span id="alg1.l11.5" class="ltx_text ltx_font_bold" style="font-size:70%;">in parallel</span><span id="alg1.l11.6" class="ltx_text" style="font-size:70%;"> </span><span id="alg1.l11.7" class="ltx_text ltx_font_bold" style="font-size:70%;">do</span><span id="alg1.l11.8" class="ltx_text" style="font-size:70%;">


</span>
</div>
<div id="alg1.l12" class="ltx_listingline">
<span id="alg1.l12.1" class="ltx_text" style="font-size:70%;">      </span><math id="alg1.l12.m1.1" class="ltx_Math" alttext="S_{t+1}^{k}" display="inline"><semantics id="alg1.l12.m1.1a"><msubsup id="alg1.l12.m1.1.1" xref="alg1.l12.m1.1.1.cmml"><mi mathsize="70%" id="alg1.l12.m1.1.1.2.2" xref="alg1.l12.m1.1.1.2.2.cmml">S</mi><mrow id="alg1.l12.m1.1.1.2.3" xref="alg1.l12.m1.1.1.2.3.cmml"><mi mathsize="70%" id="alg1.l12.m1.1.1.2.3.2" xref="alg1.l12.m1.1.1.2.3.2.cmml">t</mi><mo mathsize="70%" id="alg1.l12.m1.1.1.2.3.1" xref="alg1.l12.m1.1.1.2.3.1.cmml">+</mo><mn mathsize="70%" id="alg1.l12.m1.1.1.2.3.3" xref="alg1.l12.m1.1.1.2.3.3.cmml">1</mn></mrow><mi mathsize="70%" id="alg1.l12.m1.1.1.3" xref="alg1.l12.m1.1.1.3.cmml">k</mi></msubsup><annotation-xml encoding="MathML-Content" id="alg1.l12.m1.1b"><apply id="alg1.l12.m1.1.1.cmml" xref="alg1.l12.m1.1.1"><csymbol cd="ambiguous" id="alg1.l12.m1.1.1.1.cmml" xref="alg1.l12.m1.1.1">superscript</csymbol><apply id="alg1.l12.m1.1.1.2.cmml" xref="alg1.l12.m1.1.1"><csymbol cd="ambiguous" id="alg1.l12.m1.1.1.2.1.cmml" xref="alg1.l12.m1.1.1">subscript</csymbol><ci id="alg1.l12.m1.1.1.2.2.cmml" xref="alg1.l12.m1.1.1.2.2">𝑆</ci><apply id="alg1.l12.m1.1.1.2.3.cmml" xref="alg1.l12.m1.1.1.2.3"><plus id="alg1.l12.m1.1.1.2.3.1.cmml" xref="alg1.l12.m1.1.1.2.3.1"></plus><ci id="alg1.l12.m1.1.1.2.3.2.cmml" xref="alg1.l12.m1.1.1.2.3.2">𝑡</ci><cn type="integer" id="alg1.l12.m1.1.1.2.3.3.cmml" xref="alg1.l12.m1.1.1.2.3.3">1</cn></apply></apply><ci id="alg1.l12.m1.1.1.3.cmml" xref="alg1.l12.m1.1.1.3">𝑘</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l12.m1.1c">S_{t+1}^{k}</annotation></semantics></math><span id="alg1.l12.2" class="ltx_text" style="font-size:70%;">, </span><math id="alg1.l12.m2.1" class="ltx_Math" alttext="(D_{\text{KL}}^{T})^{k}" display="inline"><semantics id="alg1.l12.m2.1a"><msup id="alg1.l12.m2.1.1" xref="alg1.l12.m2.1.1.cmml"><mrow id="alg1.l12.m2.1.1.1.1" xref="alg1.l12.m2.1.1.1.1.1.cmml"><mo maxsize="70%" minsize="70%" id="alg1.l12.m2.1.1.1.1.2" xref="alg1.l12.m2.1.1.1.1.1.cmml">(</mo><msubsup id="alg1.l12.m2.1.1.1.1.1" xref="alg1.l12.m2.1.1.1.1.1.cmml"><mi mathsize="70%" id="alg1.l12.m2.1.1.1.1.1.2.2" xref="alg1.l12.m2.1.1.1.1.1.2.2.cmml">D</mi><mtext mathsize="70%" id="alg1.l12.m2.1.1.1.1.1.2.3" xref="alg1.l12.m2.1.1.1.1.1.2.3a.cmml">KL</mtext><mi mathsize="70%" id="alg1.l12.m2.1.1.1.1.1.3" xref="alg1.l12.m2.1.1.1.1.1.3.cmml">T</mi></msubsup><mo maxsize="70%" minsize="70%" id="alg1.l12.m2.1.1.1.1.3" xref="alg1.l12.m2.1.1.1.1.1.cmml">)</mo></mrow><mi mathsize="70%" id="alg1.l12.m2.1.1.3" xref="alg1.l12.m2.1.1.3.cmml">k</mi></msup><annotation-xml encoding="MathML-Content" id="alg1.l12.m2.1b"><apply id="alg1.l12.m2.1.1.cmml" xref="alg1.l12.m2.1.1"><csymbol cd="ambiguous" id="alg1.l12.m2.1.1.2.cmml" xref="alg1.l12.m2.1.1">superscript</csymbol><apply id="alg1.l12.m2.1.1.1.1.1.cmml" xref="alg1.l12.m2.1.1.1.1"><csymbol cd="ambiguous" id="alg1.l12.m2.1.1.1.1.1.1.cmml" xref="alg1.l12.m2.1.1.1.1">superscript</csymbol><apply id="alg1.l12.m2.1.1.1.1.1.2.cmml" xref="alg1.l12.m2.1.1.1.1"><csymbol cd="ambiguous" id="alg1.l12.m2.1.1.1.1.1.2.1.cmml" xref="alg1.l12.m2.1.1.1.1">subscript</csymbol><ci id="alg1.l12.m2.1.1.1.1.1.2.2.cmml" xref="alg1.l12.m2.1.1.1.1.1.2.2">𝐷</ci><ci id="alg1.l12.m2.1.1.1.1.1.2.3a.cmml" xref="alg1.l12.m2.1.1.1.1.1.2.3"><mtext mathsize="49%" id="alg1.l12.m2.1.1.1.1.1.2.3.cmml" xref="alg1.l12.m2.1.1.1.1.1.2.3">KL</mtext></ci></apply><ci id="alg1.l12.m2.1.1.1.1.1.3.cmml" xref="alg1.l12.m2.1.1.1.1.1.3">𝑇</ci></apply><ci id="alg1.l12.m2.1.1.3.cmml" xref="alg1.l12.m2.1.1.3">𝑘</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l12.m2.1c">(D_{\text{KL}}^{T})^{k}</annotation></semantics></math><span id="alg1.l12.3" class="ltx_text" style="font-size:70%;">, </span><math id="alg1.l12.m3.1" class="ltx_Math" alttext="(D_{\text{KL}}^{S})^{k}\leftarrow\textbf{ClientUpdate}" display="inline"><semantics id="alg1.l12.m3.1a"><mrow id="alg1.l12.m3.1.1" xref="alg1.l12.m3.1.1.cmml"><msup id="alg1.l12.m3.1.1.1" xref="alg1.l12.m3.1.1.1.cmml"><mrow id="alg1.l12.m3.1.1.1.1.1" xref="alg1.l12.m3.1.1.1.1.1.1.cmml"><mo maxsize="70%" minsize="70%" id="alg1.l12.m3.1.1.1.1.1.2" xref="alg1.l12.m3.1.1.1.1.1.1.cmml">(</mo><msubsup id="alg1.l12.m3.1.1.1.1.1.1" xref="alg1.l12.m3.1.1.1.1.1.1.cmml"><mi mathsize="70%" id="alg1.l12.m3.1.1.1.1.1.1.2.2" xref="alg1.l12.m3.1.1.1.1.1.1.2.2.cmml">D</mi><mtext mathsize="70%" id="alg1.l12.m3.1.1.1.1.1.1.2.3" xref="alg1.l12.m3.1.1.1.1.1.1.2.3a.cmml">KL</mtext><mi mathsize="70%" id="alg1.l12.m3.1.1.1.1.1.1.3" xref="alg1.l12.m3.1.1.1.1.1.1.3.cmml">S</mi></msubsup><mo maxsize="70%" minsize="70%" id="alg1.l12.m3.1.1.1.1.1.3" xref="alg1.l12.m3.1.1.1.1.1.1.cmml">)</mo></mrow><mi mathsize="70%" id="alg1.l12.m3.1.1.1.3" xref="alg1.l12.m3.1.1.1.3.cmml">k</mi></msup><mo mathsize="70%" stretchy="false" id="alg1.l12.m3.1.1.2" xref="alg1.l12.m3.1.1.2.cmml">←</mo><mtext class="ltx_mathvariant_bold" mathsize="70%" id="alg1.l12.m3.1.1.3" xref="alg1.l12.m3.1.1.3a.cmml">ClientUpdate</mtext></mrow><annotation-xml encoding="MathML-Content" id="alg1.l12.m3.1b"><apply id="alg1.l12.m3.1.1.cmml" xref="alg1.l12.m3.1.1"><ci id="alg1.l12.m3.1.1.2.cmml" xref="alg1.l12.m3.1.1.2">←</ci><apply id="alg1.l12.m3.1.1.1.cmml" xref="alg1.l12.m3.1.1.1"><csymbol cd="ambiguous" id="alg1.l12.m3.1.1.1.2.cmml" xref="alg1.l12.m3.1.1.1">superscript</csymbol><apply id="alg1.l12.m3.1.1.1.1.1.1.cmml" xref="alg1.l12.m3.1.1.1.1.1"><csymbol cd="ambiguous" id="alg1.l12.m3.1.1.1.1.1.1.1.cmml" xref="alg1.l12.m3.1.1.1.1.1">superscript</csymbol><apply id="alg1.l12.m3.1.1.1.1.1.1.2.cmml" xref="alg1.l12.m3.1.1.1.1.1"><csymbol cd="ambiguous" id="alg1.l12.m3.1.1.1.1.1.1.2.1.cmml" xref="alg1.l12.m3.1.1.1.1.1">subscript</csymbol><ci id="alg1.l12.m3.1.1.1.1.1.1.2.2.cmml" xref="alg1.l12.m3.1.1.1.1.1.1.2.2">𝐷</ci><ci id="alg1.l12.m3.1.1.1.1.1.1.2.3a.cmml" xref="alg1.l12.m3.1.1.1.1.1.1.2.3"><mtext mathsize="49%" id="alg1.l12.m3.1.1.1.1.1.1.2.3.cmml" xref="alg1.l12.m3.1.1.1.1.1.1.2.3">KL</mtext></ci></apply><ci id="alg1.l12.m3.1.1.1.1.1.1.3.cmml" xref="alg1.l12.m3.1.1.1.1.1.1.3">𝑆</ci></apply><ci id="alg1.l12.m3.1.1.1.3.cmml" xref="alg1.l12.m3.1.1.1.3">𝑘</ci></apply><ci id="alg1.l12.m3.1.1.3a.cmml" xref="alg1.l12.m3.1.1.3"><mtext class="ltx_mathvariant_bold" mathsize="70%" id="alg1.l12.m3.1.1.3.cmml" xref="alg1.l12.m3.1.1.3">ClientUpdate</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l12.m3.1c">(D_{\text{KL}}^{S})^{k}\leftarrow\textbf{ClientUpdate}</annotation></semantics></math><span id="alg1.l12.4" class="ltx_text" style="font-size:70%;">
</span><math id="alg1.l12.m4.3" class="ltx_Math" alttext="(k,S_{t},T_{t})" display="inline"><semantics id="alg1.l12.m4.3a"><mrow id="alg1.l12.m4.3.3.2" xref="alg1.l12.m4.3.3.3.cmml"><mo maxsize="70%" minsize="70%" id="alg1.l12.m4.3.3.2.3" xref="alg1.l12.m4.3.3.3.cmml">(</mo><mi mathsize="70%" id="alg1.l12.m4.1.1" xref="alg1.l12.m4.1.1.cmml">k</mi><mo mathsize="70%" id="alg1.l12.m4.3.3.2.4" xref="alg1.l12.m4.3.3.3.cmml">,</mo><msub id="alg1.l12.m4.2.2.1.1" xref="alg1.l12.m4.2.2.1.1.cmml"><mi mathsize="70%" id="alg1.l12.m4.2.2.1.1.2" xref="alg1.l12.m4.2.2.1.1.2.cmml">S</mi><mi mathsize="70%" id="alg1.l12.m4.2.2.1.1.3" xref="alg1.l12.m4.2.2.1.1.3.cmml">t</mi></msub><mo mathsize="70%" id="alg1.l12.m4.3.3.2.5" xref="alg1.l12.m4.3.3.3.cmml">,</mo><msub id="alg1.l12.m4.3.3.2.2" xref="alg1.l12.m4.3.3.2.2.cmml"><mi mathsize="70%" id="alg1.l12.m4.3.3.2.2.2" xref="alg1.l12.m4.3.3.2.2.2.cmml">T</mi><mi mathsize="70%" id="alg1.l12.m4.3.3.2.2.3" xref="alg1.l12.m4.3.3.2.2.3.cmml">t</mi></msub><mo maxsize="70%" minsize="70%" id="alg1.l12.m4.3.3.2.6" xref="alg1.l12.m4.3.3.3.cmml">)</mo></mrow><annotation-xml encoding="MathML-Content" id="alg1.l12.m4.3b"><vector id="alg1.l12.m4.3.3.3.cmml" xref="alg1.l12.m4.3.3.2"><ci id="alg1.l12.m4.1.1.cmml" xref="alg1.l12.m4.1.1">𝑘</ci><apply id="alg1.l12.m4.2.2.1.1.cmml" xref="alg1.l12.m4.2.2.1.1"><csymbol cd="ambiguous" id="alg1.l12.m4.2.2.1.1.1.cmml" xref="alg1.l12.m4.2.2.1.1">subscript</csymbol><ci id="alg1.l12.m4.2.2.1.1.2.cmml" xref="alg1.l12.m4.2.2.1.1.2">𝑆</ci><ci id="alg1.l12.m4.2.2.1.1.3.cmml" xref="alg1.l12.m4.2.2.1.1.3">𝑡</ci></apply><apply id="alg1.l12.m4.3.3.2.2.cmml" xref="alg1.l12.m4.3.3.2.2"><csymbol cd="ambiguous" id="alg1.l12.m4.3.3.2.2.1.cmml" xref="alg1.l12.m4.3.3.2.2">subscript</csymbol><ci id="alg1.l12.m4.3.3.2.2.2.cmml" xref="alg1.l12.m4.3.3.2.2.2">𝑇</ci><ci id="alg1.l12.m4.3.3.2.2.3.cmml" xref="alg1.l12.m4.3.3.2.2.3">𝑡</ci></apply></vector></annotation-xml><annotation encoding="application/x-tex" id="alg1.l12.m4.3c">(k,S_{t},T_{t})</annotation></semantics></math><span id="alg1.l12.5" class="ltx_text" style="font-size:70%;">
</span>
</div>
<div id="alg1.l13" class="ltx_listingline">
<span id="alg1.l13.1" class="ltx_text" style="font-size:70%;">    </span><span id="alg1.l13.2" class="ltx_text ltx_font_bold" style="font-size:70%;">end</span><span id="alg1.l13.3" class="ltx_text" style="font-size:70%;"> </span><span id="alg1.l13.4" class="ltx_text ltx_font_bold" style="font-size:70%;">for</span><span id="alg1.l13.5" class="ltx_text" style="font-size:70%;">


</span>
</div>
<div id="alg1.l14" class="ltx_listingline">
<span id="alg1.l14.1" class="ltx_text" style="font-size:70%;">    </span><math id="alg1.l14.m1.1" class="ltx_Math" alttext="S_{t+1}\leftarrow" display="inline"><semantics id="alg1.l14.m1.1a"><mrow id="alg1.l14.m1.1.1" xref="alg1.l14.m1.1.1.cmml"><msub id="alg1.l14.m1.1.1.2" xref="alg1.l14.m1.1.1.2.cmml"><mi mathsize="70%" id="alg1.l14.m1.1.1.2.2" xref="alg1.l14.m1.1.1.2.2.cmml">S</mi><mrow id="alg1.l14.m1.1.1.2.3" xref="alg1.l14.m1.1.1.2.3.cmml"><mi mathsize="70%" id="alg1.l14.m1.1.1.2.3.2" xref="alg1.l14.m1.1.1.2.3.2.cmml">t</mi><mo mathsize="70%" id="alg1.l14.m1.1.1.2.3.1" xref="alg1.l14.m1.1.1.2.3.1.cmml">+</mo><mn mathsize="70%" id="alg1.l14.m1.1.1.2.3.3" xref="alg1.l14.m1.1.1.2.3.3.cmml">1</mn></mrow></msub><mo mathsize="70%" stretchy="false" id="alg1.l14.m1.1.1.1" xref="alg1.l14.m1.1.1.1.cmml">←</mo><mi id="alg1.l14.m1.1.1.3" xref="alg1.l14.m1.1.1.3.cmml"></mi></mrow><annotation-xml encoding="MathML-Content" id="alg1.l14.m1.1b"><apply id="alg1.l14.m1.1.1.cmml" xref="alg1.l14.m1.1.1"><ci id="alg1.l14.m1.1.1.1.cmml" xref="alg1.l14.m1.1.1.1">←</ci><apply id="alg1.l14.m1.1.1.2.cmml" xref="alg1.l14.m1.1.1.2"><csymbol cd="ambiguous" id="alg1.l14.m1.1.1.2.1.cmml" xref="alg1.l14.m1.1.1.2">subscript</csymbol><ci id="alg1.l14.m1.1.1.2.2.cmml" xref="alg1.l14.m1.1.1.2.2">𝑆</ci><apply id="alg1.l14.m1.1.1.2.3.cmml" xref="alg1.l14.m1.1.1.2.3"><plus id="alg1.l14.m1.1.1.2.3.1.cmml" xref="alg1.l14.m1.1.1.2.3.1"></plus><ci id="alg1.l14.m1.1.1.2.3.2.cmml" xref="alg1.l14.m1.1.1.2.3.2">𝑡</ci><cn type="integer" id="alg1.l14.m1.1.1.2.3.3.cmml" xref="alg1.l14.m1.1.1.2.3.3">1</cn></apply></apply><csymbol cd="latexml" id="alg1.l14.m1.1.1.3.cmml" xref="alg1.l14.m1.1.1.3">absent</csymbol></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l14.m1.1c">S_{t+1}\leftarrow</annotation></semantics></math><span id="alg1.l14.2" class="ltx_text" style="font-size:70%;">



</span><math id="alg1.l14.m2.1" class="ltx_Math" alttext="\frac{1}{m}\sum_{k\in L_{t}}S_{t+1}^{k}" display="inline"><semantics id="alg1.l14.m2.1a"><mrow id="alg1.l14.m2.1.1" xref="alg1.l14.m2.1.1.cmml"><mfrac id="alg1.l14.m2.1.1.2" xref="alg1.l14.m2.1.1.2.cmml"><mn mathsize="70%" id="alg1.l14.m2.1.1.2.2" xref="alg1.l14.m2.1.1.2.2.cmml">1</mn><mi mathsize="70%" id="alg1.l14.m2.1.1.2.3" xref="alg1.l14.m2.1.1.2.3.cmml">m</mi></mfrac><mo lspace="0em" rspace="0em" id="alg1.l14.m2.1.1.1" xref="alg1.l14.m2.1.1.1.cmml">​</mo><mrow id="alg1.l14.m2.1.1.3" xref="alg1.l14.m2.1.1.3.cmml"><msub id="alg1.l14.m2.1.1.3.1" xref="alg1.l14.m2.1.1.3.1.cmml"><mo maxsize="70%" minsize="70%" stretchy="true" id="alg1.l14.m2.1.1.3.1.2" xref="alg1.l14.m2.1.1.3.1.2.cmml">∑</mo><mrow id="alg1.l14.m2.1.1.3.1.3" xref="alg1.l14.m2.1.1.3.1.3.cmml"><mi mathsize="70%" id="alg1.l14.m2.1.1.3.1.3.2" xref="alg1.l14.m2.1.1.3.1.3.2.cmml">k</mi><mo mathsize="70%" id="alg1.l14.m2.1.1.3.1.3.1" xref="alg1.l14.m2.1.1.3.1.3.1.cmml">∈</mo><msub id="alg1.l14.m2.1.1.3.1.3.3" xref="alg1.l14.m2.1.1.3.1.3.3.cmml"><mi mathsize="70%" id="alg1.l14.m2.1.1.3.1.3.3.2" xref="alg1.l14.m2.1.1.3.1.3.3.2.cmml">L</mi><mi mathsize="70%" id="alg1.l14.m2.1.1.3.1.3.3.3" xref="alg1.l14.m2.1.1.3.1.3.3.3.cmml">t</mi></msub></mrow></msub><msubsup id="alg1.l14.m2.1.1.3.2" xref="alg1.l14.m2.1.1.3.2.cmml"><mi mathsize="70%" id="alg1.l14.m2.1.1.3.2.2.2" xref="alg1.l14.m2.1.1.3.2.2.2.cmml">S</mi><mrow id="alg1.l14.m2.1.1.3.2.2.3" xref="alg1.l14.m2.1.1.3.2.2.3.cmml"><mi mathsize="70%" id="alg1.l14.m2.1.1.3.2.2.3.2" xref="alg1.l14.m2.1.1.3.2.2.3.2.cmml">t</mi><mo mathsize="70%" id="alg1.l14.m2.1.1.3.2.2.3.1" xref="alg1.l14.m2.1.1.3.2.2.3.1.cmml">+</mo><mn mathsize="70%" id="alg1.l14.m2.1.1.3.2.2.3.3" xref="alg1.l14.m2.1.1.3.2.2.3.3.cmml">1</mn></mrow><mi mathsize="70%" id="alg1.l14.m2.1.1.3.2.3" xref="alg1.l14.m2.1.1.3.2.3.cmml">k</mi></msubsup></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l14.m2.1b"><apply id="alg1.l14.m2.1.1.cmml" xref="alg1.l14.m2.1.1"><times id="alg1.l14.m2.1.1.1.cmml" xref="alg1.l14.m2.1.1.1"></times><apply id="alg1.l14.m2.1.1.2.cmml" xref="alg1.l14.m2.1.1.2"><divide id="alg1.l14.m2.1.1.2.1.cmml" xref="alg1.l14.m2.1.1.2"></divide><cn type="integer" id="alg1.l14.m2.1.1.2.2.cmml" xref="alg1.l14.m2.1.1.2.2">1</cn><ci id="alg1.l14.m2.1.1.2.3.cmml" xref="alg1.l14.m2.1.1.2.3">𝑚</ci></apply><apply id="alg1.l14.m2.1.1.3.cmml" xref="alg1.l14.m2.1.1.3"><apply id="alg1.l14.m2.1.1.3.1.cmml" xref="alg1.l14.m2.1.1.3.1"><csymbol cd="ambiguous" id="alg1.l14.m2.1.1.3.1.1.cmml" xref="alg1.l14.m2.1.1.3.1">subscript</csymbol><sum id="alg1.l14.m2.1.1.3.1.2.cmml" xref="alg1.l14.m2.1.1.3.1.2"></sum><apply id="alg1.l14.m2.1.1.3.1.3.cmml" xref="alg1.l14.m2.1.1.3.1.3"><in id="alg1.l14.m2.1.1.3.1.3.1.cmml" xref="alg1.l14.m2.1.1.3.1.3.1"></in><ci id="alg1.l14.m2.1.1.3.1.3.2.cmml" xref="alg1.l14.m2.1.1.3.1.3.2">𝑘</ci><apply id="alg1.l14.m2.1.1.3.1.3.3.cmml" xref="alg1.l14.m2.1.1.3.1.3.3"><csymbol cd="ambiguous" id="alg1.l14.m2.1.1.3.1.3.3.1.cmml" xref="alg1.l14.m2.1.1.3.1.3.3">subscript</csymbol><ci id="alg1.l14.m2.1.1.3.1.3.3.2.cmml" xref="alg1.l14.m2.1.1.3.1.3.3.2">𝐿</ci><ci id="alg1.l14.m2.1.1.3.1.3.3.3.cmml" xref="alg1.l14.m2.1.1.3.1.3.3.3">𝑡</ci></apply></apply></apply><apply id="alg1.l14.m2.1.1.3.2.cmml" xref="alg1.l14.m2.1.1.3.2"><csymbol cd="ambiguous" id="alg1.l14.m2.1.1.3.2.1.cmml" xref="alg1.l14.m2.1.1.3.2">superscript</csymbol><apply id="alg1.l14.m2.1.1.3.2.2.cmml" xref="alg1.l14.m2.1.1.3.2"><csymbol cd="ambiguous" id="alg1.l14.m2.1.1.3.2.2.1.cmml" xref="alg1.l14.m2.1.1.3.2">subscript</csymbol><ci id="alg1.l14.m2.1.1.3.2.2.2.cmml" xref="alg1.l14.m2.1.1.3.2.2.2">𝑆</ci><apply id="alg1.l14.m2.1.1.3.2.2.3.cmml" xref="alg1.l14.m2.1.1.3.2.2.3"><plus id="alg1.l14.m2.1.1.3.2.2.3.1.cmml" xref="alg1.l14.m2.1.1.3.2.2.3.1"></plus><ci id="alg1.l14.m2.1.1.3.2.2.3.2.cmml" xref="alg1.l14.m2.1.1.3.2.2.3.2">𝑡</ci><cn type="integer" id="alg1.l14.m2.1.1.3.2.2.3.3.cmml" xref="alg1.l14.m2.1.1.3.2.2.3.3">1</cn></apply></apply><ci id="alg1.l14.m2.1.1.3.2.3.cmml" xref="alg1.l14.m2.1.1.3.2.3">𝑘</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l14.m2.1c">\frac{1}{m}\sum_{k\in L_{t}}S_{t+1}^{k}</annotation></semantics></math><span id="alg1.l14.3" class="ltx_text" style="font-size:70%;">



</span>
</div>
<div id="alg1.l15" class="ltx_listingline">
<span id="alg1.l15.1" class="ltx_text" style="font-size:70%;">    </span><math id="alg1.l15.m1.1" class="ltx_Math" alttext="T_{t+1}\leftarrow\alpha T_{t}+(1-\alpha)S_{t+1}" display="inline"><semantics id="alg1.l15.m1.1a"><mrow id="alg1.l15.m1.1.1" xref="alg1.l15.m1.1.1.cmml"><msub id="alg1.l15.m1.1.1.3" xref="alg1.l15.m1.1.1.3.cmml"><mi mathsize="70%" id="alg1.l15.m1.1.1.3.2" xref="alg1.l15.m1.1.1.3.2.cmml">T</mi><mrow id="alg1.l15.m1.1.1.3.3" xref="alg1.l15.m1.1.1.3.3.cmml"><mi mathsize="70%" id="alg1.l15.m1.1.1.3.3.2" xref="alg1.l15.m1.1.1.3.3.2.cmml">t</mi><mo mathsize="70%" id="alg1.l15.m1.1.1.3.3.1" xref="alg1.l15.m1.1.1.3.3.1.cmml">+</mo><mn mathsize="70%" id="alg1.l15.m1.1.1.3.3.3" xref="alg1.l15.m1.1.1.3.3.3.cmml">1</mn></mrow></msub><mo mathsize="70%" stretchy="false" id="alg1.l15.m1.1.1.2" xref="alg1.l15.m1.1.1.2.cmml">←</mo><mrow id="alg1.l15.m1.1.1.1" xref="alg1.l15.m1.1.1.1.cmml"><mrow id="alg1.l15.m1.1.1.1.3" xref="alg1.l15.m1.1.1.1.3.cmml"><mi mathsize="70%" id="alg1.l15.m1.1.1.1.3.2" xref="alg1.l15.m1.1.1.1.3.2.cmml">α</mi><mo lspace="0em" rspace="0em" id="alg1.l15.m1.1.1.1.3.1" xref="alg1.l15.m1.1.1.1.3.1.cmml">​</mo><msub id="alg1.l15.m1.1.1.1.3.3" xref="alg1.l15.m1.1.1.1.3.3.cmml"><mi mathsize="70%" id="alg1.l15.m1.1.1.1.3.3.2" xref="alg1.l15.m1.1.1.1.3.3.2.cmml">T</mi><mi mathsize="70%" id="alg1.l15.m1.1.1.1.3.3.3" xref="alg1.l15.m1.1.1.1.3.3.3.cmml">t</mi></msub></mrow><mo mathsize="70%" id="alg1.l15.m1.1.1.1.2" xref="alg1.l15.m1.1.1.1.2.cmml">+</mo><mrow id="alg1.l15.m1.1.1.1.1" xref="alg1.l15.m1.1.1.1.1.cmml"><mrow id="alg1.l15.m1.1.1.1.1.1.1" xref="alg1.l15.m1.1.1.1.1.1.1.1.cmml"><mo maxsize="70%" minsize="70%" id="alg1.l15.m1.1.1.1.1.1.1.2" xref="alg1.l15.m1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="alg1.l15.m1.1.1.1.1.1.1.1" xref="alg1.l15.m1.1.1.1.1.1.1.1.cmml"><mn mathsize="70%" id="alg1.l15.m1.1.1.1.1.1.1.1.2" xref="alg1.l15.m1.1.1.1.1.1.1.1.2.cmml">1</mn><mo mathsize="70%" id="alg1.l15.m1.1.1.1.1.1.1.1.1" xref="alg1.l15.m1.1.1.1.1.1.1.1.1.cmml">−</mo><mi mathsize="70%" id="alg1.l15.m1.1.1.1.1.1.1.1.3" xref="alg1.l15.m1.1.1.1.1.1.1.1.3.cmml">α</mi></mrow><mo maxsize="70%" minsize="70%" id="alg1.l15.m1.1.1.1.1.1.1.3" xref="alg1.l15.m1.1.1.1.1.1.1.1.cmml">)</mo></mrow><mo lspace="0em" rspace="0em" id="alg1.l15.m1.1.1.1.1.2" xref="alg1.l15.m1.1.1.1.1.2.cmml">​</mo><msub id="alg1.l15.m1.1.1.1.1.3" xref="alg1.l15.m1.1.1.1.1.3.cmml"><mi mathsize="70%" id="alg1.l15.m1.1.1.1.1.3.2" xref="alg1.l15.m1.1.1.1.1.3.2.cmml">S</mi><mrow id="alg1.l15.m1.1.1.1.1.3.3" xref="alg1.l15.m1.1.1.1.1.3.3.cmml"><mi mathsize="70%" id="alg1.l15.m1.1.1.1.1.3.3.2" xref="alg1.l15.m1.1.1.1.1.3.3.2.cmml">t</mi><mo mathsize="70%" id="alg1.l15.m1.1.1.1.1.3.3.1" xref="alg1.l15.m1.1.1.1.1.3.3.1.cmml">+</mo><mn mathsize="70%" id="alg1.l15.m1.1.1.1.1.3.3.3" xref="alg1.l15.m1.1.1.1.1.3.3.3.cmml">1</mn></mrow></msub></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l15.m1.1b"><apply id="alg1.l15.m1.1.1.cmml" xref="alg1.l15.m1.1.1"><ci id="alg1.l15.m1.1.1.2.cmml" xref="alg1.l15.m1.1.1.2">←</ci><apply id="alg1.l15.m1.1.1.3.cmml" xref="alg1.l15.m1.1.1.3"><csymbol cd="ambiguous" id="alg1.l15.m1.1.1.3.1.cmml" xref="alg1.l15.m1.1.1.3">subscript</csymbol><ci id="alg1.l15.m1.1.1.3.2.cmml" xref="alg1.l15.m1.1.1.3.2">𝑇</ci><apply id="alg1.l15.m1.1.1.3.3.cmml" xref="alg1.l15.m1.1.1.3.3"><plus id="alg1.l15.m1.1.1.3.3.1.cmml" xref="alg1.l15.m1.1.1.3.3.1"></plus><ci id="alg1.l15.m1.1.1.3.3.2.cmml" xref="alg1.l15.m1.1.1.3.3.2">𝑡</ci><cn type="integer" id="alg1.l15.m1.1.1.3.3.3.cmml" xref="alg1.l15.m1.1.1.3.3.3">1</cn></apply></apply><apply id="alg1.l15.m1.1.1.1.cmml" xref="alg1.l15.m1.1.1.1"><plus id="alg1.l15.m1.1.1.1.2.cmml" xref="alg1.l15.m1.1.1.1.2"></plus><apply id="alg1.l15.m1.1.1.1.3.cmml" xref="alg1.l15.m1.1.1.1.3"><times id="alg1.l15.m1.1.1.1.3.1.cmml" xref="alg1.l15.m1.1.1.1.3.1"></times><ci id="alg1.l15.m1.1.1.1.3.2.cmml" xref="alg1.l15.m1.1.1.1.3.2">𝛼</ci><apply id="alg1.l15.m1.1.1.1.3.3.cmml" xref="alg1.l15.m1.1.1.1.3.3"><csymbol cd="ambiguous" id="alg1.l15.m1.1.1.1.3.3.1.cmml" xref="alg1.l15.m1.1.1.1.3.3">subscript</csymbol><ci id="alg1.l15.m1.1.1.1.3.3.2.cmml" xref="alg1.l15.m1.1.1.1.3.3.2">𝑇</ci><ci id="alg1.l15.m1.1.1.1.3.3.3.cmml" xref="alg1.l15.m1.1.1.1.3.3.3">𝑡</ci></apply></apply><apply id="alg1.l15.m1.1.1.1.1.cmml" xref="alg1.l15.m1.1.1.1.1"><times id="alg1.l15.m1.1.1.1.1.2.cmml" xref="alg1.l15.m1.1.1.1.1.2"></times><apply id="alg1.l15.m1.1.1.1.1.1.1.1.cmml" xref="alg1.l15.m1.1.1.1.1.1.1"><minus id="alg1.l15.m1.1.1.1.1.1.1.1.1.cmml" xref="alg1.l15.m1.1.1.1.1.1.1.1.1"></minus><cn type="integer" id="alg1.l15.m1.1.1.1.1.1.1.1.2.cmml" xref="alg1.l15.m1.1.1.1.1.1.1.1.2">1</cn><ci id="alg1.l15.m1.1.1.1.1.1.1.1.3.cmml" xref="alg1.l15.m1.1.1.1.1.1.1.1.3">𝛼</ci></apply><apply id="alg1.l15.m1.1.1.1.1.3.cmml" xref="alg1.l15.m1.1.1.1.1.3"><csymbol cd="ambiguous" id="alg1.l15.m1.1.1.1.1.3.1.cmml" xref="alg1.l15.m1.1.1.1.1.3">subscript</csymbol><ci id="alg1.l15.m1.1.1.1.1.3.2.cmml" xref="alg1.l15.m1.1.1.1.1.3.2">𝑆</ci><apply id="alg1.l15.m1.1.1.1.1.3.3.cmml" xref="alg1.l15.m1.1.1.1.1.3.3"><plus id="alg1.l15.m1.1.1.1.1.3.3.1.cmml" xref="alg1.l15.m1.1.1.1.1.3.3.1"></plus><ci id="alg1.l15.m1.1.1.1.1.3.3.2.cmml" xref="alg1.l15.m1.1.1.1.1.3.3.2">𝑡</ci><cn type="integer" id="alg1.l15.m1.1.1.1.1.3.3.3.cmml" xref="alg1.l15.m1.1.1.1.1.3.3.3">1</cn></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l15.m1.1c">T_{t+1}\leftarrow\alpha T_{t}+(1-\alpha)S_{t+1}</annotation></semantics></math><span id="alg1.l15.2" class="ltx_text" style="font-size:70%;">
</span>
</div>
<div id="alg1.l16" class="ltx_listingline">
<span id="alg1.l16.1" class="ltx_text" style="font-size:70%;">    </span><math id="alg1.l16.m1.1" class="ltx_Math" alttext="D_{\text{KL}}^{T}\leftarrow\frac{1}{m}\sum_{k\in L_{t}}(D_{\text{KL}}^{T})^{k}" display="inline"><semantics id="alg1.l16.m1.1a"><mrow id="alg1.l16.m1.1.1" xref="alg1.l16.m1.1.1.cmml"><msubsup id="alg1.l16.m1.1.1.3" xref="alg1.l16.m1.1.1.3.cmml"><mi mathsize="70%" id="alg1.l16.m1.1.1.3.2.2" xref="alg1.l16.m1.1.1.3.2.2.cmml">D</mi><mtext mathsize="70%" id="alg1.l16.m1.1.1.3.2.3" xref="alg1.l16.m1.1.1.3.2.3a.cmml">KL</mtext><mi mathsize="70%" id="alg1.l16.m1.1.1.3.3" xref="alg1.l16.m1.1.1.3.3.cmml">T</mi></msubsup><mo mathsize="70%" stretchy="false" id="alg1.l16.m1.1.1.2" xref="alg1.l16.m1.1.1.2.cmml">←</mo><mrow id="alg1.l16.m1.1.1.1" xref="alg1.l16.m1.1.1.1.cmml"><mfrac id="alg1.l16.m1.1.1.1.3" xref="alg1.l16.m1.1.1.1.3.cmml"><mn mathsize="70%" id="alg1.l16.m1.1.1.1.3.2" xref="alg1.l16.m1.1.1.1.3.2.cmml">1</mn><mi mathsize="70%" id="alg1.l16.m1.1.1.1.3.3" xref="alg1.l16.m1.1.1.1.3.3.cmml">m</mi></mfrac><mo lspace="0em" rspace="0em" id="alg1.l16.m1.1.1.1.2" xref="alg1.l16.m1.1.1.1.2.cmml">​</mo><mrow id="alg1.l16.m1.1.1.1.1" xref="alg1.l16.m1.1.1.1.1.cmml"><msub id="alg1.l16.m1.1.1.1.1.2" xref="alg1.l16.m1.1.1.1.1.2.cmml"><mo maxsize="70%" minsize="70%" rspace="0em" stretchy="true" id="alg1.l16.m1.1.1.1.1.2.2" xref="alg1.l16.m1.1.1.1.1.2.2.cmml">∑</mo><mrow id="alg1.l16.m1.1.1.1.1.2.3" xref="alg1.l16.m1.1.1.1.1.2.3.cmml"><mi mathsize="70%" id="alg1.l16.m1.1.1.1.1.2.3.2" xref="alg1.l16.m1.1.1.1.1.2.3.2.cmml">k</mi><mo mathsize="70%" id="alg1.l16.m1.1.1.1.1.2.3.1" xref="alg1.l16.m1.1.1.1.1.2.3.1.cmml">∈</mo><msub id="alg1.l16.m1.1.1.1.1.2.3.3" xref="alg1.l16.m1.1.1.1.1.2.3.3.cmml"><mi mathsize="70%" id="alg1.l16.m1.1.1.1.1.2.3.3.2" xref="alg1.l16.m1.1.1.1.1.2.3.3.2.cmml">L</mi><mi mathsize="70%" id="alg1.l16.m1.1.1.1.1.2.3.3.3" xref="alg1.l16.m1.1.1.1.1.2.3.3.3.cmml">t</mi></msub></mrow></msub><msup id="alg1.l16.m1.1.1.1.1.1" xref="alg1.l16.m1.1.1.1.1.1.cmml"><mrow id="alg1.l16.m1.1.1.1.1.1.1.1" xref="alg1.l16.m1.1.1.1.1.1.1.1.1.cmml"><mo maxsize="70%" minsize="70%" id="alg1.l16.m1.1.1.1.1.1.1.1.2" xref="alg1.l16.m1.1.1.1.1.1.1.1.1.cmml">(</mo><msubsup id="alg1.l16.m1.1.1.1.1.1.1.1.1" xref="alg1.l16.m1.1.1.1.1.1.1.1.1.cmml"><mi mathsize="70%" id="alg1.l16.m1.1.1.1.1.1.1.1.1.2.2" xref="alg1.l16.m1.1.1.1.1.1.1.1.1.2.2.cmml">D</mi><mtext mathsize="70%" id="alg1.l16.m1.1.1.1.1.1.1.1.1.2.3" xref="alg1.l16.m1.1.1.1.1.1.1.1.1.2.3a.cmml">KL</mtext><mi mathsize="70%" id="alg1.l16.m1.1.1.1.1.1.1.1.1.3" xref="alg1.l16.m1.1.1.1.1.1.1.1.1.3.cmml">T</mi></msubsup><mo maxsize="70%" minsize="70%" id="alg1.l16.m1.1.1.1.1.1.1.1.3" xref="alg1.l16.m1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow><mi mathsize="70%" id="alg1.l16.m1.1.1.1.1.1.3" xref="alg1.l16.m1.1.1.1.1.1.3.cmml">k</mi></msup></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l16.m1.1b"><apply id="alg1.l16.m1.1.1.cmml" xref="alg1.l16.m1.1.1"><ci id="alg1.l16.m1.1.1.2.cmml" xref="alg1.l16.m1.1.1.2">←</ci><apply id="alg1.l16.m1.1.1.3.cmml" xref="alg1.l16.m1.1.1.3"><csymbol cd="ambiguous" id="alg1.l16.m1.1.1.3.1.cmml" xref="alg1.l16.m1.1.1.3">superscript</csymbol><apply id="alg1.l16.m1.1.1.3.2.cmml" xref="alg1.l16.m1.1.1.3"><csymbol cd="ambiguous" id="alg1.l16.m1.1.1.3.2.1.cmml" xref="alg1.l16.m1.1.1.3">subscript</csymbol><ci id="alg1.l16.m1.1.1.3.2.2.cmml" xref="alg1.l16.m1.1.1.3.2.2">𝐷</ci><ci id="alg1.l16.m1.1.1.3.2.3a.cmml" xref="alg1.l16.m1.1.1.3.2.3"><mtext mathsize="49%" id="alg1.l16.m1.1.1.3.2.3.cmml" xref="alg1.l16.m1.1.1.3.2.3">KL</mtext></ci></apply><ci id="alg1.l16.m1.1.1.3.3.cmml" xref="alg1.l16.m1.1.1.3.3">𝑇</ci></apply><apply id="alg1.l16.m1.1.1.1.cmml" xref="alg1.l16.m1.1.1.1"><times id="alg1.l16.m1.1.1.1.2.cmml" xref="alg1.l16.m1.1.1.1.2"></times><apply id="alg1.l16.m1.1.1.1.3.cmml" xref="alg1.l16.m1.1.1.1.3"><divide id="alg1.l16.m1.1.1.1.3.1.cmml" xref="alg1.l16.m1.1.1.1.3"></divide><cn type="integer" id="alg1.l16.m1.1.1.1.3.2.cmml" xref="alg1.l16.m1.1.1.1.3.2">1</cn><ci id="alg1.l16.m1.1.1.1.3.3.cmml" xref="alg1.l16.m1.1.1.1.3.3">𝑚</ci></apply><apply id="alg1.l16.m1.1.1.1.1.cmml" xref="alg1.l16.m1.1.1.1.1"><apply id="alg1.l16.m1.1.1.1.1.2.cmml" xref="alg1.l16.m1.1.1.1.1.2"><csymbol cd="ambiguous" id="alg1.l16.m1.1.1.1.1.2.1.cmml" xref="alg1.l16.m1.1.1.1.1.2">subscript</csymbol><sum id="alg1.l16.m1.1.1.1.1.2.2.cmml" xref="alg1.l16.m1.1.1.1.1.2.2"></sum><apply id="alg1.l16.m1.1.1.1.1.2.3.cmml" xref="alg1.l16.m1.1.1.1.1.2.3"><in id="alg1.l16.m1.1.1.1.1.2.3.1.cmml" xref="alg1.l16.m1.1.1.1.1.2.3.1"></in><ci id="alg1.l16.m1.1.1.1.1.2.3.2.cmml" xref="alg1.l16.m1.1.1.1.1.2.3.2">𝑘</ci><apply id="alg1.l16.m1.1.1.1.1.2.3.3.cmml" xref="alg1.l16.m1.1.1.1.1.2.3.3"><csymbol cd="ambiguous" id="alg1.l16.m1.1.1.1.1.2.3.3.1.cmml" xref="alg1.l16.m1.1.1.1.1.2.3.3">subscript</csymbol><ci id="alg1.l16.m1.1.1.1.1.2.3.3.2.cmml" xref="alg1.l16.m1.1.1.1.1.2.3.3.2">𝐿</ci><ci id="alg1.l16.m1.1.1.1.1.2.3.3.3.cmml" xref="alg1.l16.m1.1.1.1.1.2.3.3.3">𝑡</ci></apply></apply></apply><apply id="alg1.l16.m1.1.1.1.1.1.cmml" xref="alg1.l16.m1.1.1.1.1.1"><csymbol cd="ambiguous" id="alg1.l16.m1.1.1.1.1.1.2.cmml" xref="alg1.l16.m1.1.1.1.1.1">superscript</csymbol><apply id="alg1.l16.m1.1.1.1.1.1.1.1.1.cmml" xref="alg1.l16.m1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="alg1.l16.m1.1.1.1.1.1.1.1.1.1.cmml" xref="alg1.l16.m1.1.1.1.1.1.1.1">superscript</csymbol><apply id="alg1.l16.m1.1.1.1.1.1.1.1.1.2.cmml" xref="alg1.l16.m1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="alg1.l16.m1.1.1.1.1.1.1.1.1.2.1.cmml" xref="alg1.l16.m1.1.1.1.1.1.1.1">subscript</csymbol><ci id="alg1.l16.m1.1.1.1.1.1.1.1.1.2.2.cmml" xref="alg1.l16.m1.1.1.1.1.1.1.1.1.2.2">𝐷</ci><ci id="alg1.l16.m1.1.1.1.1.1.1.1.1.2.3a.cmml" xref="alg1.l16.m1.1.1.1.1.1.1.1.1.2.3"><mtext mathsize="49%" id="alg1.l16.m1.1.1.1.1.1.1.1.1.2.3.cmml" xref="alg1.l16.m1.1.1.1.1.1.1.1.1.2.3">KL</mtext></ci></apply><ci id="alg1.l16.m1.1.1.1.1.1.1.1.1.3.cmml" xref="alg1.l16.m1.1.1.1.1.1.1.1.1.3">𝑇</ci></apply><ci id="alg1.l16.m1.1.1.1.1.1.3.cmml" xref="alg1.l16.m1.1.1.1.1.1.3">𝑘</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l16.m1.1c">D_{\text{KL}}^{T}\leftarrow\frac{1}{m}\sum_{k\in L_{t}}(D_{\text{KL}}^{T})^{k}</annotation></semantics></math><span id="alg1.l16.2" class="ltx_text" style="font-size:70%;">
</span>
</div>
<div id="alg1.l17" class="ltx_listingline">
<span id="alg1.l17.1" class="ltx_text" style="font-size:70%;">    </span><math id="alg1.l17.m1.1" class="ltx_Math" alttext="D_{\text{KL}}^{S}\leftarrow\frac{1}{m}\sum_{k\in L_{t}}(D_{\text{KL}}^{S})^{k}" display="inline"><semantics id="alg1.l17.m1.1a"><mrow id="alg1.l17.m1.1.1" xref="alg1.l17.m1.1.1.cmml"><msubsup id="alg1.l17.m1.1.1.3" xref="alg1.l17.m1.1.1.3.cmml"><mi mathsize="70%" id="alg1.l17.m1.1.1.3.2.2" xref="alg1.l17.m1.1.1.3.2.2.cmml">D</mi><mtext mathsize="70%" id="alg1.l17.m1.1.1.3.2.3" xref="alg1.l17.m1.1.1.3.2.3a.cmml">KL</mtext><mi mathsize="70%" id="alg1.l17.m1.1.1.3.3" xref="alg1.l17.m1.1.1.3.3.cmml">S</mi></msubsup><mo mathsize="70%" stretchy="false" id="alg1.l17.m1.1.1.2" xref="alg1.l17.m1.1.1.2.cmml">←</mo><mrow id="alg1.l17.m1.1.1.1" xref="alg1.l17.m1.1.1.1.cmml"><mfrac id="alg1.l17.m1.1.1.1.3" xref="alg1.l17.m1.1.1.1.3.cmml"><mn mathsize="70%" id="alg1.l17.m1.1.1.1.3.2" xref="alg1.l17.m1.1.1.1.3.2.cmml">1</mn><mi mathsize="70%" id="alg1.l17.m1.1.1.1.3.3" xref="alg1.l17.m1.1.1.1.3.3.cmml">m</mi></mfrac><mo lspace="0em" rspace="0em" id="alg1.l17.m1.1.1.1.2" xref="alg1.l17.m1.1.1.1.2.cmml">​</mo><mrow id="alg1.l17.m1.1.1.1.1" xref="alg1.l17.m1.1.1.1.1.cmml"><msub id="alg1.l17.m1.1.1.1.1.2" xref="alg1.l17.m1.1.1.1.1.2.cmml"><mo maxsize="70%" minsize="70%" rspace="0em" stretchy="true" id="alg1.l17.m1.1.1.1.1.2.2" xref="alg1.l17.m1.1.1.1.1.2.2.cmml">∑</mo><mrow id="alg1.l17.m1.1.1.1.1.2.3" xref="alg1.l17.m1.1.1.1.1.2.3.cmml"><mi mathsize="70%" id="alg1.l17.m1.1.1.1.1.2.3.2" xref="alg1.l17.m1.1.1.1.1.2.3.2.cmml">k</mi><mo mathsize="70%" id="alg1.l17.m1.1.1.1.1.2.3.1" xref="alg1.l17.m1.1.1.1.1.2.3.1.cmml">∈</mo><msub id="alg1.l17.m1.1.1.1.1.2.3.3" xref="alg1.l17.m1.1.1.1.1.2.3.3.cmml"><mi mathsize="70%" id="alg1.l17.m1.1.1.1.1.2.3.3.2" xref="alg1.l17.m1.1.1.1.1.2.3.3.2.cmml">L</mi><mi mathsize="70%" id="alg1.l17.m1.1.1.1.1.2.3.3.3" xref="alg1.l17.m1.1.1.1.1.2.3.3.3.cmml">t</mi></msub></mrow></msub><msup id="alg1.l17.m1.1.1.1.1.1" xref="alg1.l17.m1.1.1.1.1.1.cmml"><mrow id="alg1.l17.m1.1.1.1.1.1.1.1" xref="alg1.l17.m1.1.1.1.1.1.1.1.1.cmml"><mo maxsize="70%" minsize="70%" id="alg1.l17.m1.1.1.1.1.1.1.1.2" xref="alg1.l17.m1.1.1.1.1.1.1.1.1.cmml">(</mo><msubsup id="alg1.l17.m1.1.1.1.1.1.1.1.1" xref="alg1.l17.m1.1.1.1.1.1.1.1.1.cmml"><mi mathsize="70%" id="alg1.l17.m1.1.1.1.1.1.1.1.1.2.2" xref="alg1.l17.m1.1.1.1.1.1.1.1.1.2.2.cmml">D</mi><mtext mathsize="70%" id="alg1.l17.m1.1.1.1.1.1.1.1.1.2.3" xref="alg1.l17.m1.1.1.1.1.1.1.1.1.2.3a.cmml">KL</mtext><mi mathsize="70%" id="alg1.l17.m1.1.1.1.1.1.1.1.1.3" xref="alg1.l17.m1.1.1.1.1.1.1.1.1.3.cmml">S</mi></msubsup><mo maxsize="70%" minsize="70%" id="alg1.l17.m1.1.1.1.1.1.1.1.3" xref="alg1.l17.m1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow><mi mathsize="70%" id="alg1.l17.m1.1.1.1.1.1.3" xref="alg1.l17.m1.1.1.1.1.1.3.cmml">k</mi></msup></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l17.m1.1b"><apply id="alg1.l17.m1.1.1.cmml" xref="alg1.l17.m1.1.1"><ci id="alg1.l17.m1.1.1.2.cmml" xref="alg1.l17.m1.1.1.2">←</ci><apply id="alg1.l17.m1.1.1.3.cmml" xref="alg1.l17.m1.1.1.3"><csymbol cd="ambiguous" id="alg1.l17.m1.1.1.3.1.cmml" xref="alg1.l17.m1.1.1.3">superscript</csymbol><apply id="alg1.l17.m1.1.1.3.2.cmml" xref="alg1.l17.m1.1.1.3"><csymbol cd="ambiguous" id="alg1.l17.m1.1.1.3.2.1.cmml" xref="alg1.l17.m1.1.1.3">subscript</csymbol><ci id="alg1.l17.m1.1.1.3.2.2.cmml" xref="alg1.l17.m1.1.1.3.2.2">𝐷</ci><ci id="alg1.l17.m1.1.1.3.2.3a.cmml" xref="alg1.l17.m1.1.1.3.2.3"><mtext mathsize="49%" id="alg1.l17.m1.1.1.3.2.3.cmml" xref="alg1.l17.m1.1.1.3.2.3">KL</mtext></ci></apply><ci id="alg1.l17.m1.1.1.3.3.cmml" xref="alg1.l17.m1.1.1.3.3">𝑆</ci></apply><apply id="alg1.l17.m1.1.1.1.cmml" xref="alg1.l17.m1.1.1.1"><times id="alg1.l17.m1.1.1.1.2.cmml" xref="alg1.l17.m1.1.1.1.2"></times><apply id="alg1.l17.m1.1.1.1.3.cmml" xref="alg1.l17.m1.1.1.1.3"><divide id="alg1.l17.m1.1.1.1.3.1.cmml" xref="alg1.l17.m1.1.1.1.3"></divide><cn type="integer" id="alg1.l17.m1.1.1.1.3.2.cmml" xref="alg1.l17.m1.1.1.1.3.2">1</cn><ci id="alg1.l17.m1.1.1.1.3.3.cmml" xref="alg1.l17.m1.1.1.1.3.3">𝑚</ci></apply><apply id="alg1.l17.m1.1.1.1.1.cmml" xref="alg1.l17.m1.1.1.1.1"><apply id="alg1.l17.m1.1.1.1.1.2.cmml" xref="alg1.l17.m1.1.1.1.1.2"><csymbol cd="ambiguous" id="alg1.l17.m1.1.1.1.1.2.1.cmml" xref="alg1.l17.m1.1.1.1.1.2">subscript</csymbol><sum id="alg1.l17.m1.1.1.1.1.2.2.cmml" xref="alg1.l17.m1.1.1.1.1.2.2"></sum><apply id="alg1.l17.m1.1.1.1.1.2.3.cmml" xref="alg1.l17.m1.1.1.1.1.2.3"><in id="alg1.l17.m1.1.1.1.1.2.3.1.cmml" xref="alg1.l17.m1.1.1.1.1.2.3.1"></in><ci id="alg1.l17.m1.1.1.1.1.2.3.2.cmml" xref="alg1.l17.m1.1.1.1.1.2.3.2">𝑘</ci><apply id="alg1.l17.m1.1.1.1.1.2.3.3.cmml" xref="alg1.l17.m1.1.1.1.1.2.3.3"><csymbol cd="ambiguous" id="alg1.l17.m1.1.1.1.1.2.3.3.1.cmml" xref="alg1.l17.m1.1.1.1.1.2.3.3">subscript</csymbol><ci id="alg1.l17.m1.1.1.1.1.2.3.3.2.cmml" xref="alg1.l17.m1.1.1.1.1.2.3.3.2">𝐿</ci><ci id="alg1.l17.m1.1.1.1.1.2.3.3.3.cmml" xref="alg1.l17.m1.1.1.1.1.2.3.3.3">𝑡</ci></apply></apply></apply><apply id="alg1.l17.m1.1.1.1.1.1.cmml" xref="alg1.l17.m1.1.1.1.1.1"><csymbol cd="ambiguous" id="alg1.l17.m1.1.1.1.1.1.2.cmml" xref="alg1.l17.m1.1.1.1.1.1">superscript</csymbol><apply id="alg1.l17.m1.1.1.1.1.1.1.1.1.cmml" xref="alg1.l17.m1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="alg1.l17.m1.1.1.1.1.1.1.1.1.1.cmml" xref="alg1.l17.m1.1.1.1.1.1.1.1">superscript</csymbol><apply id="alg1.l17.m1.1.1.1.1.1.1.1.1.2.cmml" xref="alg1.l17.m1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="alg1.l17.m1.1.1.1.1.1.1.1.1.2.1.cmml" xref="alg1.l17.m1.1.1.1.1.1.1.1">subscript</csymbol><ci id="alg1.l17.m1.1.1.1.1.1.1.1.1.2.2.cmml" xref="alg1.l17.m1.1.1.1.1.1.1.1.1.2.2">𝐷</ci><ci id="alg1.l17.m1.1.1.1.1.1.1.1.1.2.3a.cmml" xref="alg1.l17.m1.1.1.1.1.1.1.1.1.2.3"><mtext mathsize="49%" id="alg1.l17.m1.1.1.1.1.1.1.1.1.2.3.cmml" xref="alg1.l17.m1.1.1.1.1.1.1.1.1.2.3">KL</mtext></ci></apply><ci id="alg1.l17.m1.1.1.1.1.1.1.1.1.3.cmml" xref="alg1.l17.m1.1.1.1.1.1.1.1.1.3">𝑆</ci></apply><ci id="alg1.l17.m1.1.1.1.1.1.3.cmml" xref="alg1.l17.m1.1.1.1.1.1.3">𝑘</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l17.m1.1c">D_{\text{KL}}^{S}\leftarrow\frac{1}{m}\sum_{k\in L_{t}}(D_{\text{KL}}^{S})^{k}</annotation></semantics></math><span id="alg1.l17.2" class="ltx_text" style="font-size:70%;">
</span>
</div>
<div id="alg1.l18" class="ltx_listingline">
<span id="alg1.l18.1" class="ltx_text" style="font-size:70%;"> </span><span id="alg1.l18.2" class="ltx_text ltx_font_bold" style="font-size:70%;">end</span><span id="alg1.l18.3" class="ltx_text" style="font-size:70%;"> </span><span id="alg1.l18.4" class="ltx_text ltx_font_bold" style="font-size:70%;">for</span><span id="alg1.l18.5" class="ltx_text" style="font-size:70%;">
</span>
</div>
<div id="alg1.l19" class="ltx_listingline">
<span id="alg1.l19.1" class="ltx_text" style="font-size:70%;"> </span>
</div>
<div id="alg1.l20" class="ltx_listingline">
<span id="alg1.l20.2" class="ltx_text" style="font-size:70%;"> </span><span id="alg1.l20.1" class="ltx_text ltx_font_bold" style="font-size:70%;">ClientUpdate<math id="alg1.l20.1.m1.3" class="ltx_Math" alttext="(k,S,T)" display="inline"><semantics id="alg1.l20.1.m1.3a"><mrow id="alg1.l20.1.m1.3.4.2" xref="alg1.l20.1.m1.3.4.1.cmml"><mo stretchy="false" id="alg1.l20.1.m1.3.4.2.1" xref="alg1.l20.1.m1.3.4.1.cmml">(</mo><mi id="alg1.l20.1.m1.1.1" xref="alg1.l20.1.m1.1.1.cmml">k</mi><mo id="alg1.l20.1.m1.3.4.2.2" xref="alg1.l20.1.m1.3.4.1.cmml">,</mo><mi id="alg1.l20.1.m1.2.2" xref="alg1.l20.1.m1.2.2.cmml">S</mi><mo id="alg1.l20.1.m1.3.4.2.3" xref="alg1.l20.1.m1.3.4.1.cmml">,</mo><mi id="alg1.l20.1.m1.3.3" xref="alg1.l20.1.m1.3.3.cmml">T</mi><mo stretchy="false" id="alg1.l20.1.m1.3.4.2.4" xref="alg1.l20.1.m1.3.4.1.cmml">)</mo></mrow><annotation-xml encoding="MathML-Content" id="alg1.l20.1.m1.3b"><vector id="alg1.l20.1.m1.3.4.1.cmml" xref="alg1.l20.1.m1.3.4.2"><ci id="alg1.l20.1.m1.1.1.cmml" xref="alg1.l20.1.m1.1.1">𝑘</ci><ci id="alg1.l20.1.m1.2.2.cmml" xref="alg1.l20.1.m1.2.2">𝑆</ci><ci id="alg1.l20.1.m1.3.3.cmml" xref="alg1.l20.1.m1.3.3">𝑇</ci></vector></annotation-xml><annotation encoding="application/x-tex" id="alg1.l20.1.m1.3c">(k,S,T)</annotation></semantics></math>:</span><span id="alg1.l20.3" class="ltx_text" style="font-size:70%;">
</span>
</div>
<div id="alg1.l21" class="ltx_listingline">
<span id="alg1.l21.1" class="ltx_text" style="font-size:70%;"> </span><math id="alg1.l21.m1.1" class="ltx_Math" alttext="D_{\text{KL}}^{T}\leftarrow 0" display="inline"><semantics id="alg1.l21.m1.1a"><mrow id="alg1.l21.m1.1.1" xref="alg1.l21.m1.1.1.cmml"><msubsup id="alg1.l21.m1.1.1.2" xref="alg1.l21.m1.1.1.2.cmml"><mi mathsize="70%" id="alg1.l21.m1.1.1.2.2.2" xref="alg1.l21.m1.1.1.2.2.2.cmml">D</mi><mtext mathsize="70%" id="alg1.l21.m1.1.1.2.2.3" xref="alg1.l21.m1.1.1.2.2.3a.cmml">KL</mtext><mi mathsize="70%" id="alg1.l21.m1.1.1.2.3" xref="alg1.l21.m1.1.1.2.3.cmml">T</mi></msubsup><mo mathsize="70%" stretchy="false" id="alg1.l21.m1.1.1.1" xref="alg1.l21.m1.1.1.1.cmml">←</mo><mn mathsize="70%" id="alg1.l21.m1.1.1.3" xref="alg1.l21.m1.1.1.3.cmml">0</mn></mrow><annotation-xml encoding="MathML-Content" id="alg1.l21.m1.1b"><apply id="alg1.l21.m1.1.1.cmml" xref="alg1.l21.m1.1.1"><ci id="alg1.l21.m1.1.1.1.cmml" xref="alg1.l21.m1.1.1.1">←</ci><apply id="alg1.l21.m1.1.1.2.cmml" xref="alg1.l21.m1.1.1.2"><csymbol cd="ambiguous" id="alg1.l21.m1.1.1.2.1.cmml" xref="alg1.l21.m1.1.1.2">superscript</csymbol><apply id="alg1.l21.m1.1.1.2.2.cmml" xref="alg1.l21.m1.1.1.2"><csymbol cd="ambiguous" id="alg1.l21.m1.1.1.2.2.1.cmml" xref="alg1.l21.m1.1.1.2">subscript</csymbol><ci id="alg1.l21.m1.1.1.2.2.2.cmml" xref="alg1.l21.m1.1.1.2.2.2">𝐷</ci><ci id="alg1.l21.m1.1.1.2.2.3a.cmml" xref="alg1.l21.m1.1.1.2.2.3"><mtext mathsize="49%" id="alg1.l21.m1.1.1.2.2.3.cmml" xref="alg1.l21.m1.1.1.2.2.3">KL</mtext></ci></apply><ci id="alg1.l21.m1.1.1.2.3.cmml" xref="alg1.l21.m1.1.1.2.3">𝑇</ci></apply><cn type="integer" id="alg1.l21.m1.1.1.3.cmml" xref="alg1.l21.m1.1.1.3">0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l21.m1.1c">D_{\text{KL}}^{T}\leftarrow 0</annotation></semantics></math><span id="alg1.l21.2" class="ltx_text" style="font-size:70%;">
</span>
</div>
<div id="alg1.l22" class="ltx_listingline">
<span id="alg1.l22.1" class="ltx_text" style="font-size:70%;"> </span><math id="alg1.l22.m1.1" class="ltx_Math" alttext="D_{\text{KL}}^{S}\leftarrow 0" display="inline"><semantics id="alg1.l22.m1.1a"><mrow id="alg1.l22.m1.1.1" xref="alg1.l22.m1.1.1.cmml"><msubsup id="alg1.l22.m1.1.1.2" xref="alg1.l22.m1.1.1.2.cmml"><mi mathsize="70%" id="alg1.l22.m1.1.1.2.2.2" xref="alg1.l22.m1.1.1.2.2.2.cmml">D</mi><mtext mathsize="70%" id="alg1.l22.m1.1.1.2.2.3" xref="alg1.l22.m1.1.1.2.2.3a.cmml">KL</mtext><mi mathsize="70%" id="alg1.l22.m1.1.1.2.3" xref="alg1.l22.m1.1.1.2.3.cmml">S</mi></msubsup><mo mathsize="70%" stretchy="false" id="alg1.l22.m1.1.1.1" xref="alg1.l22.m1.1.1.1.cmml">←</mo><mn mathsize="70%" id="alg1.l22.m1.1.1.3" xref="alg1.l22.m1.1.1.3.cmml">0</mn></mrow><annotation-xml encoding="MathML-Content" id="alg1.l22.m1.1b"><apply id="alg1.l22.m1.1.1.cmml" xref="alg1.l22.m1.1.1"><ci id="alg1.l22.m1.1.1.1.cmml" xref="alg1.l22.m1.1.1.1">←</ci><apply id="alg1.l22.m1.1.1.2.cmml" xref="alg1.l22.m1.1.1.2"><csymbol cd="ambiguous" id="alg1.l22.m1.1.1.2.1.cmml" xref="alg1.l22.m1.1.1.2">superscript</csymbol><apply id="alg1.l22.m1.1.1.2.2.cmml" xref="alg1.l22.m1.1.1.2"><csymbol cd="ambiguous" id="alg1.l22.m1.1.1.2.2.1.cmml" xref="alg1.l22.m1.1.1.2">subscript</csymbol><ci id="alg1.l22.m1.1.1.2.2.2.cmml" xref="alg1.l22.m1.1.1.2.2.2">𝐷</ci><ci id="alg1.l22.m1.1.1.2.2.3a.cmml" xref="alg1.l22.m1.1.1.2.2.3"><mtext mathsize="49%" id="alg1.l22.m1.1.1.2.2.3.cmml" xref="alg1.l22.m1.1.1.2.2.3">KL</mtext></ci></apply><ci id="alg1.l22.m1.1.1.2.3.cmml" xref="alg1.l22.m1.1.1.2.3">𝑆</ci></apply><cn type="integer" id="alg1.l22.m1.1.1.3.cmml" xref="alg1.l22.m1.1.1.3">0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l22.m1.1c">D_{\text{KL}}^{S}\leftarrow 0</annotation></semantics></math><span id="alg1.l22.2" class="ltx_text" style="font-size:70%;">
</span>
</div>
<div id="alg1.l23" class="ltx_listingline">
<span id="alg1.l23.1" class="ltx_text" style="font-size:70%;"> </span><span id="alg1.l23.2" class="ltx_text ltx_font_bold" style="font-size:70%;">for</span><span id="alg1.l23.3" class="ltx_text" style="font-size:70%;"> each local epoch </span><math id="alg1.l23.m1.4" class="ltx_Math" alttext="e=1,2,\dots,E_{c}" display="inline"><semantics id="alg1.l23.m1.4a"><mrow id="alg1.l23.m1.4.4" xref="alg1.l23.m1.4.4.cmml"><mi mathsize="70%" id="alg1.l23.m1.4.4.3" xref="alg1.l23.m1.4.4.3.cmml">e</mi><mo mathsize="70%" id="alg1.l23.m1.4.4.2" xref="alg1.l23.m1.4.4.2.cmml">=</mo><mrow id="alg1.l23.m1.4.4.1.1" xref="alg1.l23.m1.4.4.1.2.cmml"><mn mathsize="70%" id="alg1.l23.m1.1.1" xref="alg1.l23.m1.1.1.cmml">1</mn><mo mathsize="70%" id="alg1.l23.m1.4.4.1.1.2" xref="alg1.l23.m1.4.4.1.2.cmml">,</mo><mn mathsize="70%" id="alg1.l23.m1.2.2" xref="alg1.l23.m1.2.2.cmml">2</mn><mo mathsize="70%" id="alg1.l23.m1.4.4.1.1.3" xref="alg1.l23.m1.4.4.1.2.cmml">,</mo><mi mathsize="70%" mathvariant="normal" id="alg1.l23.m1.3.3" xref="alg1.l23.m1.3.3.cmml">…</mi><mo mathsize="70%" id="alg1.l23.m1.4.4.1.1.4" xref="alg1.l23.m1.4.4.1.2.cmml">,</mo><msub id="alg1.l23.m1.4.4.1.1.1" xref="alg1.l23.m1.4.4.1.1.1.cmml"><mi mathsize="70%" id="alg1.l23.m1.4.4.1.1.1.2" xref="alg1.l23.m1.4.4.1.1.1.2.cmml">E</mi><mi mathsize="70%" id="alg1.l23.m1.4.4.1.1.1.3" xref="alg1.l23.m1.4.4.1.1.1.3.cmml">c</mi></msub></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l23.m1.4b"><apply id="alg1.l23.m1.4.4.cmml" xref="alg1.l23.m1.4.4"><eq id="alg1.l23.m1.4.4.2.cmml" xref="alg1.l23.m1.4.4.2"></eq><ci id="alg1.l23.m1.4.4.3.cmml" xref="alg1.l23.m1.4.4.3">𝑒</ci><list id="alg1.l23.m1.4.4.1.2.cmml" xref="alg1.l23.m1.4.4.1.1"><cn type="integer" id="alg1.l23.m1.1.1.cmml" xref="alg1.l23.m1.1.1">1</cn><cn type="integer" id="alg1.l23.m1.2.2.cmml" xref="alg1.l23.m1.2.2">2</cn><ci id="alg1.l23.m1.3.3.cmml" xref="alg1.l23.m1.3.3">…</ci><apply id="alg1.l23.m1.4.4.1.1.1.cmml" xref="alg1.l23.m1.4.4.1.1.1"><csymbol cd="ambiguous" id="alg1.l23.m1.4.4.1.1.1.1.cmml" xref="alg1.l23.m1.4.4.1.1.1">subscript</csymbol><ci id="alg1.l23.m1.4.4.1.1.1.2.cmml" xref="alg1.l23.m1.4.4.1.1.1.2">𝐸</ci><ci id="alg1.l23.m1.4.4.1.1.1.3.cmml" xref="alg1.l23.m1.4.4.1.1.1.3">𝑐</ci></apply></list></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l23.m1.4c">e=1,2,\dots,E_{c}</annotation></semantics></math><span id="alg1.l23.4" class="ltx_text" style="font-size:70%;"> </span><span id="alg1.l23.5" class="ltx_text ltx_font_bold" style="font-size:70%;">do</span><span id="alg1.l23.6" class="ltx_text" style="font-size:70%;">


</span>
</div>
<div id="alg1.l24" class="ltx_listingline">
<span id="alg1.l24.1" class="ltx_text" style="font-size:70%;">    </span><span id="alg1.l24.2" class="ltx_text ltx_font_bold" style="font-size:70%;">for</span><span id="alg1.l24.3" class="ltx_text" style="font-size:70%;"> labeled batch </span><math id="alg1.l24.m1.1" class="ltx_Math" alttext="s\in D_{s}" display="inline"><semantics id="alg1.l24.m1.1a"><mrow id="alg1.l24.m1.1.1" xref="alg1.l24.m1.1.1.cmml"><mi mathsize="70%" id="alg1.l24.m1.1.1.2" xref="alg1.l24.m1.1.1.2.cmml">s</mi><mo mathsize="70%" id="alg1.l24.m1.1.1.1" xref="alg1.l24.m1.1.1.1.cmml">∈</mo><msub id="alg1.l24.m1.1.1.3" xref="alg1.l24.m1.1.1.3.cmml"><mi mathsize="70%" id="alg1.l24.m1.1.1.3.2" xref="alg1.l24.m1.1.1.3.2.cmml">D</mi><mi mathsize="70%" id="alg1.l24.m1.1.1.3.3" xref="alg1.l24.m1.1.1.3.3.cmml">s</mi></msub></mrow><annotation-xml encoding="MathML-Content" id="alg1.l24.m1.1b"><apply id="alg1.l24.m1.1.1.cmml" xref="alg1.l24.m1.1.1"><in id="alg1.l24.m1.1.1.1.cmml" xref="alg1.l24.m1.1.1.1"></in><ci id="alg1.l24.m1.1.1.2.cmml" xref="alg1.l24.m1.1.1.2">𝑠</ci><apply id="alg1.l24.m1.1.1.3.cmml" xref="alg1.l24.m1.1.1.3"><csymbol cd="ambiguous" id="alg1.l24.m1.1.1.3.1.cmml" xref="alg1.l24.m1.1.1.3">subscript</csymbol><ci id="alg1.l24.m1.1.1.3.2.cmml" xref="alg1.l24.m1.1.1.3.2">𝐷</ci><ci id="alg1.l24.m1.1.1.3.3.cmml" xref="alg1.l24.m1.1.1.3.3">𝑠</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l24.m1.1c">s\in D_{s}</annotation></semantics></math><span id="alg1.l24.4" class="ltx_text" style="font-size:70%;"> and unlabeled batch </span><math id="alg1.l24.m2.1" class="ltx_Math" alttext="u\in D_{u}" display="inline"><semantics id="alg1.l24.m2.1a"><mrow id="alg1.l24.m2.1.1" xref="alg1.l24.m2.1.1.cmml"><mi mathsize="70%" id="alg1.l24.m2.1.1.2" xref="alg1.l24.m2.1.1.2.cmml">u</mi><mo mathsize="70%" id="alg1.l24.m2.1.1.1" xref="alg1.l24.m2.1.1.1.cmml">∈</mo><msub id="alg1.l24.m2.1.1.3" xref="alg1.l24.m2.1.1.3.cmml"><mi mathsize="70%" id="alg1.l24.m2.1.1.3.2" xref="alg1.l24.m2.1.1.3.2.cmml">D</mi><mi mathsize="70%" id="alg1.l24.m2.1.1.3.3" xref="alg1.l24.m2.1.1.3.3.cmml">u</mi></msub></mrow><annotation-xml encoding="MathML-Content" id="alg1.l24.m2.1b"><apply id="alg1.l24.m2.1.1.cmml" xref="alg1.l24.m2.1.1"><in id="alg1.l24.m2.1.1.1.cmml" xref="alg1.l24.m2.1.1.1"></in><ci id="alg1.l24.m2.1.1.2.cmml" xref="alg1.l24.m2.1.1.2">𝑢</ci><apply id="alg1.l24.m2.1.1.3.cmml" xref="alg1.l24.m2.1.1.3"><csymbol cd="ambiguous" id="alg1.l24.m2.1.1.3.1.cmml" xref="alg1.l24.m2.1.1.3">subscript</csymbol><ci id="alg1.l24.m2.1.1.3.2.cmml" xref="alg1.l24.m2.1.1.3.2">𝐷</ci><ci id="alg1.l24.m2.1.1.3.3.cmml" xref="alg1.l24.m2.1.1.3.3">𝑢</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l24.m2.1c">u\in D_{u}</annotation></semantics></math><span id="alg1.l24.5" class="ltx_text" style="font-size:70%;">  </span><span id="alg1.l24.6" class="ltx_text ltx_font_bold" style="font-size:70%;">do</span><span id="alg1.l24.7" class="ltx_text" style="font-size:70%;">

 
</span>
</div>
<div id="alg1.l25" class="ltx_listingline">
<span id="alg1.l25.1" class="ltx_text" style="font-size:70%;">      </span><math id="alg1.l25.m1.7" class="ltx_Math" alttext="S\leftarrow S-\eta\cdot\nabla(\mathcal{L}_{s}(S;s)+\lambda_{u}(\mathcal{L}_{u}(S,T;u))+\frac{\mu}{2}||S-S^{s}||^{2})" display="inline"><semantics id="alg1.l25.m1.7a"><mrow id="alg1.l25.m1.7.7" xref="alg1.l25.m1.7.7.cmml"><mi mathsize="70%" id="alg1.l25.m1.7.7.3" xref="alg1.l25.m1.7.7.3.cmml">S</mi><mo mathsize="70%" stretchy="false" id="alg1.l25.m1.7.7.2" xref="alg1.l25.m1.7.7.2.cmml">←</mo><mrow id="alg1.l25.m1.7.7.1" xref="alg1.l25.m1.7.7.1.cmml"><mi mathsize="70%" id="alg1.l25.m1.7.7.1.3" xref="alg1.l25.m1.7.7.1.3.cmml">S</mi><mo mathsize="70%" id="alg1.l25.m1.7.7.1.2" xref="alg1.l25.m1.7.7.1.2.cmml">−</mo><mrow id="alg1.l25.m1.7.7.1.1" xref="alg1.l25.m1.7.7.1.1.cmml"><mi mathsize="70%" id="alg1.l25.m1.7.7.1.1.3" xref="alg1.l25.m1.7.7.1.1.3.cmml">η</mi><mo lspace="0.222em" mathsize="70%" rspace="0.222em" id="alg1.l25.m1.7.7.1.1.2" xref="alg1.l25.m1.7.7.1.1.2.cmml">⋅</mo><mrow id="alg1.l25.m1.7.7.1.1.1.1" xref="alg1.l25.m1.7.7.1.1.1.2.cmml"><mo mathsize="70%" id="alg1.l25.m1.6.6" xref="alg1.l25.m1.6.6.cmml">∇</mo><mrow id="alg1.l25.m1.7.7.1.1.1.1.1" xref="alg1.l25.m1.7.7.1.1.1.2.cmml"><mo maxsize="70%" minsize="70%" id="alg1.l25.m1.7.7.1.1.1.1.1.2" xref="alg1.l25.m1.7.7.1.1.1.2.cmml">(</mo><mrow id="alg1.l25.m1.7.7.1.1.1.1.1.1" xref="alg1.l25.m1.7.7.1.1.1.1.1.1.cmml"><mrow id="alg1.l25.m1.7.7.1.1.1.1.1.1.4" xref="alg1.l25.m1.7.7.1.1.1.1.1.1.4.cmml"><msub id="alg1.l25.m1.7.7.1.1.1.1.1.1.4.2" xref="alg1.l25.m1.7.7.1.1.1.1.1.1.4.2.cmml"><mi class="ltx_font_mathcaligraphic" mathsize="70%" id="alg1.l25.m1.7.7.1.1.1.1.1.1.4.2.2" xref="alg1.l25.m1.7.7.1.1.1.1.1.1.4.2.2.cmml">ℒ</mi><mi mathsize="70%" id="alg1.l25.m1.7.7.1.1.1.1.1.1.4.2.3" xref="alg1.l25.m1.7.7.1.1.1.1.1.1.4.2.3.cmml">s</mi></msub><mo lspace="0em" rspace="0em" id="alg1.l25.m1.7.7.1.1.1.1.1.1.4.1" xref="alg1.l25.m1.7.7.1.1.1.1.1.1.4.1.cmml">​</mo><mrow id="alg1.l25.m1.7.7.1.1.1.1.1.1.4.3.2" xref="alg1.l25.m1.7.7.1.1.1.1.1.1.4.3.1.cmml"><mo maxsize="70%" minsize="70%" id="alg1.l25.m1.7.7.1.1.1.1.1.1.4.3.2.1" xref="alg1.l25.m1.7.7.1.1.1.1.1.1.4.3.1.cmml">(</mo><mi mathsize="70%" id="alg1.l25.m1.1.1" xref="alg1.l25.m1.1.1.cmml">S</mi><mo mathsize="70%" id="alg1.l25.m1.7.7.1.1.1.1.1.1.4.3.2.2" xref="alg1.l25.m1.7.7.1.1.1.1.1.1.4.3.1.cmml">;</mo><mi mathsize="70%" id="alg1.l25.m1.2.2" xref="alg1.l25.m1.2.2.cmml">s</mi><mo maxsize="70%" minsize="70%" id="alg1.l25.m1.7.7.1.1.1.1.1.1.4.3.2.3" xref="alg1.l25.m1.7.7.1.1.1.1.1.1.4.3.1.cmml">)</mo></mrow></mrow><mo mathsize="70%" id="alg1.l25.m1.7.7.1.1.1.1.1.1.3" xref="alg1.l25.m1.7.7.1.1.1.1.1.1.3.cmml">+</mo><mrow id="alg1.l25.m1.7.7.1.1.1.1.1.1.1" xref="alg1.l25.m1.7.7.1.1.1.1.1.1.1.cmml"><msub id="alg1.l25.m1.7.7.1.1.1.1.1.1.1.3" xref="alg1.l25.m1.7.7.1.1.1.1.1.1.1.3.cmml"><mi mathsize="70%" id="alg1.l25.m1.7.7.1.1.1.1.1.1.1.3.2" xref="alg1.l25.m1.7.7.1.1.1.1.1.1.1.3.2.cmml">λ</mi><mi mathsize="70%" id="alg1.l25.m1.7.7.1.1.1.1.1.1.1.3.3" xref="alg1.l25.m1.7.7.1.1.1.1.1.1.1.3.3.cmml">u</mi></msub><mo lspace="0em" rspace="0em" id="alg1.l25.m1.7.7.1.1.1.1.1.1.1.2" xref="alg1.l25.m1.7.7.1.1.1.1.1.1.1.2.cmml">​</mo><mrow id="alg1.l25.m1.7.7.1.1.1.1.1.1.1.1.1" xref="alg1.l25.m1.7.7.1.1.1.1.1.1.1.1.1.1.cmml"><mo maxsize="70%" minsize="70%" id="alg1.l25.m1.7.7.1.1.1.1.1.1.1.1.1.2" xref="alg1.l25.m1.7.7.1.1.1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="alg1.l25.m1.7.7.1.1.1.1.1.1.1.1.1.1" xref="alg1.l25.m1.7.7.1.1.1.1.1.1.1.1.1.1.cmml"><msub id="alg1.l25.m1.7.7.1.1.1.1.1.1.1.1.1.1.2" xref="alg1.l25.m1.7.7.1.1.1.1.1.1.1.1.1.1.2.cmml"><mi class="ltx_font_mathcaligraphic" mathsize="70%" id="alg1.l25.m1.7.7.1.1.1.1.1.1.1.1.1.1.2.2" xref="alg1.l25.m1.7.7.1.1.1.1.1.1.1.1.1.1.2.2.cmml">ℒ</mi><mi mathsize="70%" id="alg1.l25.m1.7.7.1.1.1.1.1.1.1.1.1.1.2.3" xref="alg1.l25.m1.7.7.1.1.1.1.1.1.1.1.1.1.2.3.cmml">u</mi></msub><mo lspace="0em" rspace="0em" id="alg1.l25.m1.7.7.1.1.1.1.1.1.1.1.1.1.1" xref="alg1.l25.m1.7.7.1.1.1.1.1.1.1.1.1.1.1.cmml">​</mo><mrow id="alg1.l25.m1.7.7.1.1.1.1.1.1.1.1.1.1.3.2" xref="alg1.l25.m1.7.7.1.1.1.1.1.1.1.1.1.1.3.1.cmml"><mo maxsize="70%" minsize="70%" id="alg1.l25.m1.7.7.1.1.1.1.1.1.1.1.1.1.3.2.1" xref="alg1.l25.m1.7.7.1.1.1.1.1.1.1.1.1.1.3.1.cmml">(</mo><mi mathsize="70%" id="alg1.l25.m1.3.3" xref="alg1.l25.m1.3.3.cmml">S</mi><mo mathsize="70%" id="alg1.l25.m1.7.7.1.1.1.1.1.1.1.1.1.1.3.2.2" xref="alg1.l25.m1.7.7.1.1.1.1.1.1.1.1.1.1.3.1.cmml">,</mo><mi mathsize="70%" id="alg1.l25.m1.4.4" xref="alg1.l25.m1.4.4.cmml">T</mi><mo mathsize="70%" id="alg1.l25.m1.7.7.1.1.1.1.1.1.1.1.1.1.3.2.3" xref="alg1.l25.m1.7.7.1.1.1.1.1.1.1.1.1.1.3.1.cmml">;</mo><mi mathsize="70%" id="alg1.l25.m1.5.5" xref="alg1.l25.m1.5.5.cmml">u</mi><mo maxsize="70%" minsize="70%" id="alg1.l25.m1.7.7.1.1.1.1.1.1.1.1.1.1.3.2.4" xref="alg1.l25.m1.7.7.1.1.1.1.1.1.1.1.1.1.3.1.cmml">)</mo></mrow></mrow><mo maxsize="70%" minsize="70%" id="alg1.l25.m1.7.7.1.1.1.1.1.1.1.1.1.3" xref="alg1.l25.m1.7.7.1.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo mathsize="70%" id="alg1.l25.m1.7.7.1.1.1.1.1.1.3a" xref="alg1.l25.m1.7.7.1.1.1.1.1.1.3.cmml">+</mo><mrow id="alg1.l25.m1.7.7.1.1.1.1.1.1.2" xref="alg1.l25.m1.7.7.1.1.1.1.1.1.2.cmml"><mfrac id="alg1.l25.m1.7.7.1.1.1.1.1.1.2.3" xref="alg1.l25.m1.7.7.1.1.1.1.1.1.2.3.cmml"><mi mathsize="70%" id="alg1.l25.m1.7.7.1.1.1.1.1.1.2.3.2" xref="alg1.l25.m1.7.7.1.1.1.1.1.1.2.3.2.cmml">μ</mi><mn mathsize="70%" id="alg1.l25.m1.7.7.1.1.1.1.1.1.2.3.3" xref="alg1.l25.m1.7.7.1.1.1.1.1.1.2.3.3.cmml">2</mn></mfrac><mo lspace="0em" rspace="0em" id="alg1.l25.m1.7.7.1.1.1.1.1.1.2.2" xref="alg1.l25.m1.7.7.1.1.1.1.1.1.2.2.cmml">​</mo><msup id="alg1.l25.m1.7.7.1.1.1.1.1.1.2.1" xref="alg1.l25.m1.7.7.1.1.1.1.1.1.2.1.cmml"><mrow id="alg1.l25.m1.7.7.1.1.1.1.1.1.2.1.1.1" xref="alg1.l25.m1.7.7.1.1.1.1.1.1.2.1.1.2.cmml"><mo stretchy="false" id="alg1.l25.m1.7.7.1.1.1.1.1.1.2.1.1.1.2" xref="alg1.l25.m1.7.7.1.1.1.1.1.1.2.1.1.2.1.cmml">‖</mo><mrow id="alg1.l25.m1.7.7.1.1.1.1.1.1.2.1.1.1.1" xref="alg1.l25.m1.7.7.1.1.1.1.1.1.2.1.1.1.1.cmml"><mi mathsize="70%" id="alg1.l25.m1.7.7.1.1.1.1.1.1.2.1.1.1.1.2" xref="alg1.l25.m1.7.7.1.1.1.1.1.1.2.1.1.1.1.2.cmml">S</mi><mo mathsize="70%" id="alg1.l25.m1.7.7.1.1.1.1.1.1.2.1.1.1.1.1" xref="alg1.l25.m1.7.7.1.1.1.1.1.1.2.1.1.1.1.1.cmml">−</mo><msup id="alg1.l25.m1.7.7.1.1.1.1.1.1.2.1.1.1.1.3" xref="alg1.l25.m1.7.7.1.1.1.1.1.1.2.1.1.1.1.3.cmml"><mi mathsize="70%" id="alg1.l25.m1.7.7.1.1.1.1.1.1.2.1.1.1.1.3.2" xref="alg1.l25.m1.7.7.1.1.1.1.1.1.2.1.1.1.1.3.2.cmml">S</mi><mi mathsize="70%" id="alg1.l25.m1.7.7.1.1.1.1.1.1.2.1.1.1.1.3.3" xref="alg1.l25.m1.7.7.1.1.1.1.1.1.2.1.1.1.1.3.3.cmml">s</mi></msup></mrow><mo stretchy="false" id="alg1.l25.m1.7.7.1.1.1.1.1.1.2.1.1.1.3" xref="alg1.l25.m1.7.7.1.1.1.1.1.1.2.1.1.2.1.cmml">‖</mo></mrow><mn mathsize="70%" id="alg1.l25.m1.7.7.1.1.1.1.1.1.2.1.3" xref="alg1.l25.m1.7.7.1.1.1.1.1.1.2.1.3.cmml">2</mn></msup></mrow></mrow><mo maxsize="70%" minsize="70%" id="alg1.l25.m1.7.7.1.1.1.1.1.3" xref="alg1.l25.m1.7.7.1.1.1.2.cmml">)</mo></mrow></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l25.m1.7b"><apply id="alg1.l25.m1.7.7.cmml" xref="alg1.l25.m1.7.7"><ci id="alg1.l25.m1.7.7.2.cmml" xref="alg1.l25.m1.7.7.2">←</ci><ci id="alg1.l25.m1.7.7.3.cmml" xref="alg1.l25.m1.7.7.3">𝑆</ci><apply id="alg1.l25.m1.7.7.1.cmml" xref="alg1.l25.m1.7.7.1"><minus id="alg1.l25.m1.7.7.1.2.cmml" xref="alg1.l25.m1.7.7.1.2"></minus><ci id="alg1.l25.m1.7.7.1.3.cmml" xref="alg1.l25.m1.7.7.1.3">𝑆</ci><apply id="alg1.l25.m1.7.7.1.1.cmml" xref="alg1.l25.m1.7.7.1.1"><ci id="alg1.l25.m1.7.7.1.1.2.cmml" xref="alg1.l25.m1.7.7.1.1.2">⋅</ci><ci id="alg1.l25.m1.7.7.1.1.3.cmml" xref="alg1.l25.m1.7.7.1.1.3">𝜂</ci><apply id="alg1.l25.m1.7.7.1.1.1.2.cmml" xref="alg1.l25.m1.7.7.1.1.1.1"><ci id="alg1.l25.m1.6.6.cmml" xref="alg1.l25.m1.6.6">∇</ci><apply id="alg1.l25.m1.7.7.1.1.1.1.1.1.cmml" xref="alg1.l25.m1.7.7.1.1.1.1.1.1"><plus id="alg1.l25.m1.7.7.1.1.1.1.1.1.3.cmml" xref="alg1.l25.m1.7.7.1.1.1.1.1.1.3"></plus><apply id="alg1.l25.m1.7.7.1.1.1.1.1.1.4.cmml" xref="alg1.l25.m1.7.7.1.1.1.1.1.1.4"><times id="alg1.l25.m1.7.7.1.1.1.1.1.1.4.1.cmml" xref="alg1.l25.m1.7.7.1.1.1.1.1.1.4.1"></times><apply id="alg1.l25.m1.7.7.1.1.1.1.1.1.4.2.cmml" xref="alg1.l25.m1.7.7.1.1.1.1.1.1.4.2"><csymbol cd="ambiguous" id="alg1.l25.m1.7.7.1.1.1.1.1.1.4.2.1.cmml" xref="alg1.l25.m1.7.7.1.1.1.1.1.1.4.2">subscript</csymbol><ci id="alg1.l25.m1.7.7.1.1.1.1.1.1.4.2.2.cmml" xref="alg1.l25.m1.7.7.1.1.1.1.1.1.4.2.2">ℒ</ci><ci id="alg1.l25.m1.7.7.1.1.1.1.1.1.4.2.3.cmml" xref="alg1.l25.m1.7.7.1.1.1.1.1.1.4.2.3">𝑠</ci></apply><list id="alg1.l25.m1.7.7.1.1.1.1.1.1.4.3.1.cmml" xref="alg1.l25.m1.7.7.1.1.1.1.1.1.4.3.2"><ci id="alg1.l25.m1.1.1.cmml" xref="alg1.l25.m1.1.1">𝑆</ci><ci id="alg1.l25.m1.2.2.cmml" xref="alg1.l25.m1.2.2">𝑠</ci></list></apply><apply id="alg1.l25.m1.7.7.1.1.1.1.1.1.1.cmml" xref="alg1.l25.m1.7.7.1.1.1.1.1.1.1"><times id="alg1.l25.m1.7.7.1.1.1.1.1.1.1.2.cmml" xref="alg1.l25.m1.7.7.1.1.1.1.1.1.1.2"></times><apply id="alg1.l25.m1.7.7.1.1.1.1.1.1.1.3.cmml" xref="alg1.l25.m1.7.7.1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="alg1.l25.m1.7.7.1.1.1.1.1.1.1.3.1.cmml" xref="alg1.l25.m1.7.7.1.1.1.1.1.1.1.3">subscript</csymbol><ci id="alg1.l25.m1.7.7.1.1.1.1.1.1.1.3.2.cmml" xref="alg1.l25.m1.7.7.1.1.1.1.1.1.1.3.2">𝜆</ci><ci id="alg1.l25.m1.7.7.1.1.1.1.1.1.1.3.3.cmml" xref="alg1.l25.m1.7.7.1.1.1.1.1.1.1.3.3">𝑢</ci></apply><apply id="alg1.l25.m1.7.7.1.1.1.1.1.1.1.1.1.1.cmml" xref="alg1.l25.m1.7.7.1.1.1.1.1.1.1.1.1"><times id="alg1.l25.m1.7.7.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="alg1.l25.m1.7.7.1.1.1.1.1.1.1.1.1.1.1"></times><apply id="alg1.l25.m1.7.7.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="alg1.l25.m1.7.7.1.1.1.1.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="alg1.l25.m1.7.7.1.1.1.1.1.1.1.1.1.1.2.1.cmml" xref="alg1.l25.m1.7.7.1.1.1.1.1.1.1.1.1.1.2">subscript</csymbol><ci id="alg1.l25.m1.7.7.1.1.1.1.1.1.1.1.1.1.2.2.cmml" xref="alg1.l25.m1.7.7.1.1.1.1.1.1.1.1.1.1.2.2">ℒ</ci><ci id="alg1.l25.m1.7.7.1.1.1.1.1.1.1.1.1.1.2.3.cmml" xref="alg1.l25.m1.7.7.1.1.1.1.1.1.1.1.1.1.2.3">𝑢</ci></apply><vector id="alg1.l25.m1.7.7.1.1.1.1.1.1.1.1.1.1.3.1.cmml" xref="alg1.l25.m1.7.7.1.1.1.1.1.1.1.1.1.1.3.2"><ci id="alg1.l25.m1.3.3.cmml" xref="alg1.l25.m1.3.3">𝑆</ci><ci id="alg1.l25.m1.4.4.cmml" xref="alg1.l25.m1.4.4">𝑇</ci><ci id="alg1.l25.m1.5.5.cmml" xref="alg1.l25.m1.5.5">𝑢</ci></vector></apply></apply><apply id="alg1.l25.m1.7.7.1.1.1.1.1.1.2.cmml" xref="alg1.l25.m1.7.7.1.1.1.1.1.1.2"><times id="alg1.l25.m1.7.7.1.1.1.1.1.1.2.2.cmml" xref="alg1.l25.m1.7.7.1.1.1.1.1.1.2.2"></times><apply id="alg1.l25.m1.7.7.1.1.1.1.1.1.2.3.cmml" xref="alg1.l25.m1.7.7.1.1.1.1.1.1.2.3"><divide id="alg1.l25.m1.7.7.1.1.1.1.1.1.2.3.1.cmml" xref="alg1.l25.m1.7.7.1.1.1.1.1.1.2.3"></divide><ci id="alg1.l25.m1.7.7.1.1.1.1.1.1.2.3.2.cmml" xref="alg1.l25.m1.7.7.1.1.1.1.1.1.2.3.2">𝜇</ci><cn type="integer" id="alg1.l25.m1.7.7.1.1.1.1.1.1.2.3.3.cmml" xref="alg1.l25.m1.7.7.1.1.1.1.1.1.2.3.3">2</cn></apply><apply id="alg1.l25.m1.7.7.1.1.1.1.1.1.2.1.cmml" xref="alg1.l25.m1.7.7.1.1.1.1.1.1.2.1"><csymbol cd="ambiguous" id="alg1.l25.m1.7.7.1.1.1.1.1.1.2.1.2.cmml" xref="alg1.l25.m1.7.7.1.1.1.1.1.1.2.1">superscript</csymbol><apply id="alg1.l25.m1.7.7.1.1.1.1.1.1.2.1.1.2.cmml" xref="alg1.l25.m1.7.7.1.1.1.1.1.1.2.1.1.1"><csymbol cd="latexml" id="alg1.l25.m1.7.7.1.1.1.1.1.1.2.1.1.2.1.cmml" xref="alg1.l25.m1.7.7.1.1.1.1.1.1.2.1.1.1.2">norm</csymbol><apply id="alg1.l25.m1.7.7.1.1.1.1.1.1.2.1.1.1.1.cmml" xref="alg1.l25.m1.7.7.1.1.1.1.1.1.2.1.1.1.1"><minus id="alg1.l25.m1.7.7.1.1.1.1.1.1.2.1.1.1.1.1.cmml" xref="alg1.l25.m1.7.7.1.1.1.1.1.1.2.1.1.1.1.1"></minus><ci id="alg1.l25.m1.7.7.1.1.1.1.1.1.2.1.1.1.1.2.cmml" xref="alg1.l25.m1.7.7.1.1.1.1.1.1.2.1.1.1.1.2">𝑆</ci><apply id="alg1.l25.m1.7.7.1.1.1.1.1.1.2.1.1.1.1.3.cmml" xref="alg1.l25.m1.7.7.1.1.1.1.1.1.2.1.1.1.1.3"><csymbol cd="ambiguous" id="alg1.l25.m1.7.7.1.1.1.1.1.1.2.1.1.1.1.3.1.cmml" xref="alg1.l25.m1.7.7.1.1.1.1.1.1.2.1.1.1.1.3">superscript</csymbol><ci id="alg1.l25.m1.7.7.1.1.1.1.1.1.2.1.1.1.1.3.2.cmml" xref="alg1.l25.m1.7.7.1.1.1.1.1.1.2.1.1.1.1.3.2">𝑆</ci><ci id="alg1.l25.m1.7.7.1.1.1.1.1.1.2.1.1.1.1.3.3.cmml" xref="alg1.l25.m1.7.7.1.1.1.1.1.1.2.1.1.1.1.3.3">𝑠</ci></apply></apply></apply><cn type="integer" id="alg1.l25.m1.7.7.1.1.1.1.1.1.2.1.3.cmml" xref="alg1.l25.m1.7.7.1.1.1.1.1.1.2.1.3">2</cn></apply></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l25.m1.7c">S\leftarrow S-\eta\cdot\nabla(\mathcal{L}_{s}(S;s)+\lambda_{u}(\mathcal{L}_{u}(S,T;u))+\frac{\mu}{2}||S-S^{s}||^{2})</annotation></semantics></math><span id="alg1.l25.2" class="ltx_text" style="font-size:70%;">

</span>
</div>
<div id="alg1.l26" class="ltx_listingline">
<span id="alg1.l26.1" class="ltx_text" style="font-size:70%;">      </span><math id="alg1.l26.m1.1" class="ltx_Math" alttext="D_{\text{KL}}^{T}\leftarrow D_{\text{KL}}^{T}+D_{\text{KL}}^{T}(u)" display="inline"><semantics id="alg1.l26.m1.1a"><mrow id="alg1.l26.m1.1.2" xref="alg1.l26.m1.1.2.cmml"><msubsup id="alg1.l26.m1.1.2.2" xref="alg1.l26.m1.1.2.2.cmml"><mi mathsize="70%" id="alg1.l26.m1.1.2.2.2.2" xref="alg1.l26.m1.1.2.2.2.2.cmml">D</mi><mtext mathsize="70%" id="alg1.l26.m1.1.2.2.2.3" xref="alg1.l26.m1.1.2.2.2.3a.cmml">KL</mtext><mi mathsize="70%" id="alg1.l26.m1.1.2.2.3" xref="alg1.l26.m1.1.2.2.3.cmml">T</mi></msubsup><mo mathsize="70%" stretchy="false" id="alg1.l26.m1.1.2.1" xref="alg1.l26.m1.1.2.1.cmml">←</mo><mrow id="alg1.l26.m1.1.2.3" xref="alg1.l26.m1.1.2.3.cmml"><msubsup id="alg1.l26.m1.1.2.3.2" xref="alg1.l26.m1.1.2.3.2.cmml"><mi mathsize="70%" id="alg1.l26.m1.1.2.3.2.2.2" xref="alg1.l26.m1.1.2.3.2.2.2.cmml">D</mi><mtext mathsize="70%" id="alg1.l26.m1.1.2.3.2.2.3" xref="alg1.l26.m1.1.2.3.2.2.3a.cmml">KL</mtext><mi mathsize="70%" id="alg1.l26.m1.1.2.3.2.3" xref="alg1.l26.m1.1.2.3.2.3.cmml">T</mi></msubsup><mo mathsize="70%" id="alg1.l26.m1.1.2.3.1" xref="alg1.l26.m1.1.2.3.1.cmml">+</mo><mrow id="alg1.l26.m1.1.2.3.3" xref="alg1.l26.m1.1.2.3.3.cmml"><msubsup id="alg1.l26.m1.1.2.3.3.2" xref="alg1.l26.m1.1.2.3.3.2.cmml"><mi mathsize="70%" id="alg1.l26.m1.1.2.3.3.2.2.2" xref="alg1.l26.m1.1.2.3.3.2.2.2.cmml">D</mi><mtext mathsize="70%" id="alg1.l26.m1.1.2.3.3.2.2.3" xref="alg1.l26.m1.1.2.3.3.2.2.3a.cmml">KL</mtext><mi mathsize="70%" id="alg1.l26.m1.1.2.3.3.2.3" xref="alg1.l26.m1.1.2.3.3.2.3.cmml">T</mi></msubsup><mo lspace="0em" rspace="0em" id="alg1.l26.m1.1.2.3.3.1" xref="alg1.l26.m1.1.2.3.3.1.cmml">​</mo><mrow id="alg1.l26.m1.1.2.3.3.3.2" xref="alg1.l26.m1.1.2.3.3.cmml"><mo maxsize="70%" minsize="70%" id="alg1.l26.m1.1.2.3.3.3.2.1" xref="alg1.l26.m1.1.2.3.3.cmml">(</mo><mi mathsize="70%" id="alg1.l26.m1.1.1" xref="alg1.l26.m1.1.1.cmml">u</mi><mo maxsize="70%" minsize="70%" id="alg1.l26.m1.1.2.3.3.3.2.2" xref="alg1.l26.m1.1.2.3.3.cmml">)</mo></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l26.m1.1b"><apply id="alg1.l26.m1.1.2.cmml" xref="alg1.l26.m1.1.2"><ci id="alg1.l26.m1.1.2.1.cmml" xref="alg1.l26.m1.1.2.1">←</ci><apply id="alg1.l26.m1.1.2.2.cmml" xref="alg1.l26.m1.1.2.2"><csymbol cd="ambiguous" id="alg1.l26.m1.1.2.2.1.cmml" xref="alg1.l26.m1.1.2.2">superscript</csymbol><apply id="alg1.l26.m1.1.2.2.2.cmml" xref="alg1.l26.m1.1.2.2"><csymbol cd="ambiguous" id="alg1.l26.m1.1.2.2.2.1.cmml" xref="alg1.l26.m1.1.2.2">subscript</csymbol><ci id="alg1.l26.m1.1.2.2.2.2.cmml" xref="alg1.l26.m1.1.2.2.2.2">𝐷</ci><ci id="alg1.l26.m1.1.2.2.2.3a.cmml" xref="alg1.l26.m1.1.2.2.2.3"><mtext mathsize="49%" id="alg1.l26.m1.1.2.2.2.3.cmml" xref="alg1.l26.m1.1.2.2.2.3">KL</mtext></ci></apply><ci id="alg1.l26.m1.1.2.2.3.cmml" xref="alg1.l26.m1.1.2.2.3">𝑇</ci></apply><apply id="alg1.l26.m1.1.2.3.cmml" xref="alg1.l26.m1.1.2.3"><plus id="alg1.l26.m1.1.2.3.1.cmml" xref="alg1.l26.m1.1.2.3.1"></plus><apply id="alg1.l26.m1.1.2.3.2.cmml" xref="alg1.l26.m1.1.2.3.2"><csymbol cd="ambiguous" id="alg1.l26.m1.1.2.3.2.1.cmml" xref="alg1.l26.m1.1.2.3.2">superscript</csymbol><apply id="alg1.l26.m1.1.2.3.2.2.cmml" xref="alg1.l26.m1.1.2.3.2"><csymbol cd="ambiguous" id="alg1.l26.m1.1.2.3.2.2.1.cmml" xref="alg1.l26.m1.1.2.3.2">subscript</csymbol><ci id="alg1.l26.m1.1.2.3.2.2.2.cmml" xref="alg1.l26.m1.1.2.3.2.2.2">𝐷</ci><ci id="alg1.l26.m1.1.2.3.2.2.3a.cmml" xref="alg1.l26.m1.1.2.3.2.2.3"><mtext mathsize="49%" id="alg1.l26.m1.1.2.3.2.2.3.cmml" xref="alg1.l26.m1.1.2.3.2.2.3">KL</mtext></ci></apply><ci id="alg1.l26.m1.1.2.3.2.3.cmml" xref="alg1.l26.m1.1.2.3.2.3">𝑇</ci></apply><apply id="alg1.l26.m1.1.2.3.3.cmml" xref="alg1.l26.m1.1.2.3.3"><times id="alg1.l26.m1.1.2.3.3.1.cmml" xref="alg1.l26.m1.1.2.3.3.1"></times><apply id="alg1.l26.m1.1.2.3.3.2.cmml" xref="alg1.l26.m1.1.2.3.3.2"><csymbol cd="ambiguous" id="alg1.l26.m1.1.2.3.3.2.1.cmml" xref="alg1.l26.m1.1.2.3.3.2">superscript</csymbol><apply id="alg1.l26.m1.1.2.3.3.2.2.cmml" xref="alg1.l26.m1.1.2.3.3.2"><csymbol cd="ambiguous" id="alg1.l26.m1.1.2.3.3.2.2.1.cmml" xref="alg1.l26.m1.1.2.3.3.2">subscript</csymbol><ci id="alg1.l26.m1.1.2.3.3.2.2.2.cmml" xref="alg1.l26.m1.1.2.3.3.2.2.2">𝐷</ci><ci id="alg1.l26.m1.1.2.3.3.2.2.3a.cmml" xref="alg1.l26.m1.1.2.3.3.2.2.3"><mtext mathsize="49%" id="alg1.l26.m1.1.2.3.3.2.2.3.cmml" xref="alg1.l26.m1.1.2.3.3.2.2.3">KL</mtext></ci></apply><ci id="alg1.l26.m1.1.2.3.3.2.3.cmml" xref="alg1.l26.m1.1.2.3.3.2.3">𝑇</ci></apply><ci id="alg1.l26.m1.1.1.cmml" xref="alg1.l26.m1.1.1">𝑢</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l26.m1.1c">D_{\text{KL}}^{T}\leftarrow D_{\text{KL}}^{T}+D_{\text{KL}}^{T}(u)</annotation></semantics></math><span id="alg1.l26.2" class="ltx_text" style="font-size:70%;">
</span>
</div>
<div id="alg1.l27" class="ltx_listingline">
<span id="alg1.l27.1" class="ltx_text" style="font-size:70%;">      </span><math id="alg1.l27.m1.1" class="ltx_Math" alttext="D_{\text{KL}}^{S}\leftarrow D_{\text{KL}}^{S}+D_{\text{KL}}^{S}(u)" display="inline"><semantics id="alg1.l27.m1.1a"><mrow id="alg1.l27.m1.1.2" xref="alg1.l27.m1.1.2.cmml"><msubsup id="alg1.l27.m1.1.2.2" xref="alg1.l27.m1.1.2.2.cmml"><mi mathsize="70%" id="alg1.l27.m1.1.2.2.2.2" xref="alg1.l27.m1.1.2.2.2.2.cmml">D</mi><mtext mathsize="70%" id="alg1.l27.m1.1.2.2.2.3" xref="alg1.l27.m1.1.2.2.2.3a.cmml">KL</mtext><mi mathsize="70%" id="alg1.l27.m1.1.2.2.3" xref="alg1.l27.m1.1.2.2.3.cmml">S</mi></msubsup><mo mathsize="70%" stretchy="false" id="alg1.l27.m1.1.2.1" xref="alg1.l27.m1.1.2.1.cmml">←</mo><mrow id="alg1.l27.m1.1.2.3" xref="alg1.l27.m1.1.2.3.cmml"><msubsup id="alg1.l27.m1.1.2.3.2" xref="alg1.l27.m1.1.2.3.2.cmml"><mi mathsize="70%" id="alg1.l27.m1.1.2.3.2.2.2" xref="alg1.l27.m1.1.2.3.2.2.2.cmml">D</mi><mtext mathsize="70%" id="alg1.l27.m1.1.2.3.2.2.3" xref="alg1.l27.m1.1.2.3.2.2.3a.cmml">KL</mtext><mi mathsize="70%" id="alg1.l27.m1.1.2.3.2.3" xref="alg1.l27.m1.1.2.3.2.3.cmml">S</mi></msubsup><mo mathsize="70%" id="alg1.l27.m1.1.2.3.1" xref="alg1.l27.m1.1.2.3.1.cmml">+</mo><mrow id="alg1.l27.m1.1.2.3.3" xref="alg1.l27.m1.1.2.3.3.cmml"><msubsup id="alg1.l27.m1.1.2.3.3.2" xref="alg1.l27.m1.1.2.3.3.2.cmml"><mi mathsize="70%" id="alg1.l27.m1.1.2.3.3.2.2.2" xref="alg1.l27.m1.1.2.3.3.2.2.2.cmml">D</mi><mtext mathsize="70%" id="alg1.l27.m1.1.2.3.3.2.2.3" xref="alg1.l27.m1.1.2.3.3.2.2.3a.cmml">KL</mtext><mi mathsize="70%" id="alg1.l27.m1.1.2.3.3.2.3" xref="alg1.l27.m1.1.2.3.3.2.3.cmml">S</mi></msubsup><mo lspace="0em" rspace="0em" id="alg1.l27.m1.1.2.3.3.1" xref="alg1.l27.m1.1.2.3.3.1.cmml">​</mo><mrow id="alg1.l27.m1.1.2.3.3.3.2" xref="alg1.l27.m1.1.2.3.3.cmml"><mo maxsize="70%" minsize="70%" id="alg1.l27.m1.1.2.3.3.3.2.1" xref="alg1.l27.m1.1.2.3.3.cmml">(</mo><mi mathsize="70%" id="alg1.l27.m1.1.1" xref="alg1.l27.m1.1.1.cmml">u</mi><mo maxsize="70%" minsize="70%" id="alg1.l27.m1.1.2.3.3.3.2.2" xref="alg1.l27.m1.1.2.3.3.cmml">)</mo></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l27.m1.1b"><apply id="alg1.l27.m1.1.2.cmml" xref="alg1.l27.m1.1.2"><ci id="alg1.l27.m1.1.2.1.cmml" xref="alg1.l27.m1.1.2.1">←</ci><apply id="alg1.l27.m1.1.2.2.cmml" xref="alg1.l27.m1.1.2.2"><csymbol cd="ambiguous" id="alg1.l27.m1.1.2.2.1.cmml" xref="alg1.l27.m1.1.2.2">superscript</csymbol><apply id="alg1.l27.m1.1.2.2.2.cmml" xref="alg1.l27.m1.1.2.2"><csymbol cd="ambiguous" id="alg1.l27.m1.1.2.2.2.1.cmml" xref="alg1.l27.m1.1.2.2">subscript</csymbol><ci id="alg1.l27.m1.1.2.2.2.2.cmml" xref="alg1.l27.m1.1.2.2.2.2">𝐷</ci><ci id="alg1.l27.m1.1.2.2.2.3a.cmml" xref="alg1.l27.m1.1.2.2.2.3"><mtext mathsize="49%" id="alg1.l27.m1.1.2.2.2.3.cmml" xref="alg1.l27.m1.1.2.2.2.3">KL</mtext></ci></apply><ci id="alg1.l27.m1.1.2.2.3.cmml" xref="alg1.l27.m1.1.2.2.3">𝑆</ci></apply><apply id="alg1.l27.m1.1.2.3.cmml" xref="alg1.l27.m1.1.2.3"><plus id="alg1.l27.m1.1.2.3.1.cmml" xref="alg1.l27.m1.1.2.3.1"></plus><apply id="alg1.l27.m1.1.2.3.2.cmml" xref="alg1.l27.m1.1.2.3.2"><csymbol cd="ambiguous" id="alg1.l27.m1.1.2.3.2.1.cmml" xref="alg1.l27.m1.1.2.3.2">superscript</csymbol><apply id="alg1.l27.m1.1.2.3.2.2.cmml" xref="alg1.l27.m1.1.2.3.2"><csymbol cd="ambiguous" id="alg1.l27.m1.1.2.3.2.2.1.cmml" xref="alg1.l27.m1.1.2.3.2">subscript</csymbol><ci id="alg1.l27.m1.1.2.3.2.2.2.cmml" xref="alg1.l27.m1.1.2.3.2.2.2">𝐷</ci><ci id="alg1.l27.m1.1.2.3.2.2.3a.cmml" xref="alg1.l27.m1.1.2.3.2.2.3"><mtext mathsize="49%" id="alg1.l27.m1.1.2.3.2.2.3.cmml" xref="alg1.l27.m1.1.2.3.2.2.3">KL</mtext></ci></apply><ci id="alg1.l27.m1.1.2.3.2.3.cmml" xref="alg1.l27.m1.1.2.3.2.3">𝑆</ci></apply><apply id="alg1.l27.m1.1.2.3.3.cmml" xref="alg1.l27.m1.1.2.3.3"><times id="alg1.l27.m1.1.2.3.3.1.cmml" xref="alg1.l27.m1.1.2.3.3.1"></times><apply id="alg1.l27.m1.1.2.3.3.2.cmml" xref="alg1.l27.m1.1.2.3.3.2"><csymbol cd="ambiguous" id="alg1.l27.m1.1.2.3.3.2.1.cmml" xref="alg1.l27.m1.1.2.3.3.2">superscript</csymbol><apply id="alg1.l27.m1.1.2.3.3.2.2.cmml" xref="alg1.l27.m1.1.2.3.3.2"><csymbol cd="ambiguous" id="alg1.l27.m1.1.2.3.3.2.2.1.cmml" xref="alg1.l27.m1.1.2.3.3.2">subscript</csymbol><ci id="alg1.l27.m1.1.2.3.3.2.2.2.cmml" xref="alg1.l27.m1.1.2.3.3.2.2.2">𝐷</ci><ci id="alg1.l27.m1.1.2.3.3.2.2.3a.cmml" xref="alg1.l27.m1.1.2.3.3.2.2.3"><mtext mathsize="49%" id="alg1.l27.m1.1.2.3.3.2.2.3.cmml" xref="alg1.l27.m1.1.2.3.3.2.2.3">KL</mtext></ci></apply><ci id="alg1.l27.m1.1.2.3.3.2.3.cmml" xref="alg1.l27.m1.1.2.3.3.2.3">𝑆</ci></apply><ci id="alg1.l27.m1.1.1.cmml" xref="alg1.l27.m1.1.1">𝑢</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l27.m1.1c">D_{\text{KL}}^{S}\leftarrow D_{\text{KL}}^{S}+D_{\text{KL}}^{S}(u)</annotation></semantics></math><span id="alg1.l27.2" class="ltx_text" style="font-size:70%;">
</span>
</div>
<div id="alg1.l28" class="ltx_listingline">
<span id="alg1.l28.1" class="ltx_text" style="font-size:70%;">    </span><span id="alg1.l28.2" class="ltx_text ltx_font_bold" style="font-size:70%;">end</span><span id="alg1.l28.3" class="ltx_text" style="font-size:70%;"> </span><span id="alg1.l28.4" class="ltx_text ltx_font_bold" style="font-size:70%;">for</span>
</div>
<div id="alg1.l29" class="ltx_listingline">
<span id="alg1.l29.1" class="ltx_text" style="font-size:70%;"> </span><span id="alg1.l29.2" class="ltx_text ltx_font_bold" style="font-size:70%;">end</span><span id="alg1.l29.3" class="ltx_text" style="font-size:70%;"> </span><span id="alg1.l29.4" class="ltx_text ltx_font_bold" style="font-size:70%;">for</span>
</div>
<div id="alg1.l30" class="ltx_listingline">
<span id="alg1.l30.1" class="ltx_text" style="font-size:70%;"> return </span><math id="alg1.l30.m1.1" class="ltx_Math" alttext="S" display="inline"><semantics id="alg1.l30.m1.1a"><mi mathsize="70%" id="alg1.l30.m1.1.1" xref="alg1.l30.m1.1.1.cmml">S</mi><annotation-xml encoding="MathML-Content" id="alg1.l30.m1.1b"><ci id="alg1.l30.m1.1.1.cmml" xref="alg1.l30.m1.1.1">𝑆</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.l30.m1.1c">S</annotation></semantics></math><span id="alg1.l30.2" class="ltx_text" style="font-size:70%;">, </span><math id="alg1.l30.m2.1" class="ltx_Math" alttext="D_{\text{KL}}^{T}" display="inline"><semantics id="alg1.l30.m2.1a"><msubsup id="alg1.l30.m2.1.1" xref="alg1.l30.m2.1.1.cmml"><mi mathsize="70%" id="alg1.l30.m2.1.1.2.2" xref="alg1.l30.m2.1.1.2.2.cmml">D</mi><mtext mathsize="70%" id="alg1.l30.m2.1.1.2.3" xref="alg1.l30.m2.1.1.2.3a.cmml">KL</mtext><mi mathsize="70%" id="alg1.l30.m2.1.1.3" xref="alg1.l30.m2.1.1.3.cmml">T</mi></msubsup><annotation-xml encoding="MathML-Content" id="alg1.l30.m2.1b"><apply id="alg1.l30.m2.1.1.cmml" xref="alg1.l30.m2.1.1"><csymbol cd="ambiguous" id="alg1.l30.m2.1.1.1.cmml" xref="alg1.l30.m2.1.1">superscript</csymbol><apply id="alg1.l30.m2.1.1.2.cmml" xref="alg1.l30.m2.1.1"><csymbol cd="ambiguous" id="alg1.l30.m2.1.1.2.1.cmml" xref="alg1.l30.m2.1.1">subscript</csymbol><ci id="alg1.l30.m2.1.1.2.2.cmml" xref="alg1.l30.m2.1.1.2.2">𝐷</ci><ci id="alg1.l30.m2.1.1.2.3a.cmml" xref="alg1.l30.m2.1.1.2.3"><mtext mathsize="49%" id="alg1.l30.m2.1.1.2.3.cmml" xref="alg1.l30.m2.1.1.2.3">KL</mtext></ci></apply><ci id="alg1.l30.m2.1.1.3.cmml" xref="alg1.l30.m2.1.1.3">𝑇</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l30.m2.1c">D_{\text{KL}}^{T}</annotation></semantics></math><span id="alg1.l30.3" class="ltx_text" style="font-size:70%;">, </span><math id="alg1.l30.m3.1" class="ltx_Math" alttext="D_{\text{KL}}^{S}" display="inline"><semantics id="alg1.l30.m3.1a"><msubsup id="alg1.l30.m3.1.1" xref="alg1.l30.m3.1.1.cmml"><mi mathsize="70%" id="alg1.l30.m3.1.1.2.2" xref="alg1.l30.m3.1.1.2.2.cmml">D</mi><mtext mathsize="70%" id="alg1.l30.m3.1.1.2.3" xref="alg1.l30.m3.1.1.2.3a.cmml">KL</mtext><mi mathsize="70%" id="alg1.l30.m3.1.1.3" xref="alg1.l30.m3.1.1.3.cmml">S</mi></msubsup><annotation-xml encoding="MathML-Content" id="alg1.l30.m3.1b"><apply id="alg1.l30.m3.1.1.cmml" xref="alg1.l30.m3.1.1"><csymbol cd="ambiguous" id="alg1.l30.m3.1.1.1.cmml" xref="alg1.l30.m3.1.1">superscript</csymbol><apply id="alg1.l30.m3.1.1.2.cmml" xref="alg1.l30.m3.1.1"><csymbol cd="ambiguous" id="alg1.l30.m3.1.1.2.1.cmml" xref="alg1.l30.m3.1.1">subscript</csymbol><ci id="alg1.l30.m3.1.1.2.2.cmml" xref="alg1.l30.m3.1.1.2.2">𝐷</ci><ci id="alg1.l30.m3.1.1.2.3a.cmml" xref="alg1.l30.m3.1.1.2.3"><mtext mathsize="49%" id="alg1.l30.m3.1.1.2.3.cmml" xref="alg1.l30.m3.1.1.2.3">KL</mtext></ci></apply><ci id="alg1.l30.m3.1.1.3.cmml" xref="alg1.l30.m3.1.1.3">𝑆</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l30.m3.1c">D_{\text{KL}}^{S}</annotation></semantics></math><span id="alg1.l30.4" class="ltx_text" style="font-size:70%;"> to server
</span>
</div>
</div>
<br class="ltx_break ltx_break">
</figure>
<div id="S3.SS3.p2" class="ltx_para ltx_noindent">
<p id="S3.SS3.p2.6" class="ltx_p"><span id="S3.SS3.p2.6.1" class="ltx_text ltx_font_bold">Communication savings in teacher-student EMA.</span> We can reduce the communication cost of the EMA approach in a federated setting by not sending the local teacher model <math id="S3.SS3.p2.1.m1.1" class="ltx_Math" alttext="T^{k}_{t}" display="inline"><semantics id="S3.SS3.p2.1.m1.1a"><msubsup id="S3.SS3.p2.1.m1.1.1" xref="S3.SS3.p2.1.m1.1.1.cmml"><mi id="S3.SS3.p2.1.m1.1.1.2.2" xref="S3.SS3.p2.1.m1.1.1.2.2.cmml">T</mi><mi id="S3.SS3.p2.1.m1.1.1.3" xref="S3.SS3.p2.1.m1.1.1.3.cmml">t</mi><mi id="S3.SS3.p2.1.m1.1.1.2.3" xref="S3.SS3.p2.1.m1.1.1.2.3.cmml">k</mi></msubsup><annotation-xml encoding="MathML-Content" id="S3.SS3.p2.1.m1.1b"><apply id="S3.SS3.p2.1.m1.1.1.cmml" xref="S3.SS3.p2.1.m1.1.1"><csymbol cd="ambiguous" id="S3.SS3.p2.1.m1.1.1.1.cmml" xref="S3.SS3.p2.1.m1.1.1">subscript</csymbol><apply id="S3.SS3.p2.1.m1.1.1.2.cmml" xref="S3.SS3.p2.1.m1.1.1"><csymbol cd="ambiguous" id="S3.SS3.p2.1.m1.1.1.2.1.cmml" xref="S3.SS3.p2.1.m1.1.1">superscript</csymbol><ci id="S3.SS3.p2.1.m1.1.1.2.2.cmml" xref="S3.SS3.p2.1.m1.1.1.2.2">𝑇</ci><ci id="S3.SS3.p2.1.m1.1.1.2.3.cmml" xref="S3.SS3.p2.1.m1.1.1.2.3">𝑘</ci></apply><ci id="S3.SS3.p2.1.m1.1.1.3.cmml" xref="S3.SS3.p2.1.m1.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p2.1.m1.1c">T^{k}_{t}</annotation></semantics></math> from each client to the server after every round.
The student model at each client is updated by optimizing labeled and unlabeled losses through FixMatch <cite class="ltx_cite ltx_citemacro_citep">(Sohn et al., <a href="#bib.bib30" title="" class="ltx_ref">2020</a>)</cite> and an additional FedProx <cite class="ltx_cite ltx_citemacro_citep">(Li et al., <a href="#bib.bib20" title="" class="ltx_ref">2020</a>)</cite> loss term. The updated client student models <math id="S3.SS3.p2.2.m2.2" class="ltx_Math" alttext="\{S^{k}_{t+1},k\in L_{t}\}" display="inline"><semantics id="S3.SS3.p2.2.m2.2a"><mrow id="S3.SS3.p2.2.m2.2.2.1" xref="S3.SS3.p2.2.m2.2.2.2.cmml"><mo stretchy="false" id="S3.SS3.p2.2.m2.2.2.1.2" xref="S3.SS3.p2.2.m2.2.2.2.cmml">{</mo><mrow id="S3.SS3.p2.2.m2.2.2.1.1" xref="S3.SS3.p2.2.m2.2.2.1.1.cmml"><mrow id="S3.SS3.p2.2.m2.2.2.1.1.1.1" xref="S3.SS3.p2.2.m2.2.2.1.1.1.2.cmml"><msubsup id="S3.SS3.p2.2.m2.2.2.1.1.1.1.1" xref="S3.SS3.p2.2.m2.2.2.1.1.1.1.1.cmml"><mi id="S3.SS3.p2.2.m2.2.2.1.1.1.1.1.2.2" xref="S3.SS3.p2.2.m2.2.2.1.1.1.1.1.2.2.cmml">S</mi><mrow id="S3.SS3.p2.2.m2.2.2.1.1.1.1.1.3" xref="S3.SS3.p2.2.m2.2.2.1.1.1.1.1.3.cmml"><mi id="S3.SS3.p2.2.m2.2.2.1.1.1.1.1.3.2" xref="S3.SS3.p2.2.m2.2.2.1.1.1.1.1.3.2.cmml">t</mi><mo id="S3.SS3.p2.2.m2.2.2.1.1.1.1.1.3.1" xref="S3.SS3.p2.2.m2.2.2.1.1.1.1.1.3.1.cmml">+</mo><mn id="S3.SS3.p2.2.m2.2.2.1.1.1.1.1.3.3" xref="S3.SS3.p2.2.m2.2.2.1.1.1.1.1.3.3.cmml">1</mn></mrow><mi id="S3.SS3.p2.2.m2.2.2.1.1.1.1.1.2.3" xref="S3.SS3.p2.2.m2.2.2.1.1.1.1.1.2.3.cmml">k</mi></msubsup><mo id="S3.SS3.p2.2.m2.2.2.1.1.1.1.2" xref="S3.SS3.p2.2.m2.2.2.1.1.1.2.cmml">,</mo><mi id="S3.SS3.p2.2.m2.1.1" xref="S3.SS3.p2.2.m2.1.1.cmml">k</mi></mrow><mo id="S3.SS3.p2.2.m2.2.2.1.1.2" xref="S3.SS3.p2.2.m2.2.2.1.1.2.cmml">∈</mo><msub id="S3.SS3.p2.2.m2.2.2.1.1.3" xref="S3.SS3.p2.2.m2.2.2.1.1.3.cmml"><mi id="S3.SS3.p2.2.m2.2.2.1.1.3.2" xref="S3.SS3.p2.2.m2.2.2.1.1.3.2.cmml">L</mi><mi id="S3.SS3.p2.2.m2.2.2.1.1.3.3" xref="S3.SS3.p2.2.m2.2.2.1.1.3.3.cmml">t</mi></msub></mrow><mo stretchy="false" id="S3.SS3.p2.2.m2.2.2.1.3" xref="S3.SS3.p2.2.m2.2.2.2.cmml">}</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.p2.2.m2.2b"><set id="S3.SS3.p2.2.m2.2.2.2.cmml" xref="S3.SS3.p2.2.m2.2.2.1"><apply id="S3.SS3.p2.2.m2.2.2.1.1.cmml" xref="S3.SS3.p2.2.m2.2.2.1.1"><in id="S3.SS3.p2.2.m2.2.2.1.1.2.cmml" xref="S3.SS3.p2.2.m2.2.2.1.1.2"></in><list id="S3.SS3.p2.2.m2.2.2.1.1.1.2.cmml" xref="S3.SS3.p2.2.m2.2.2.1.1.1.1"><apply id="S3.SS3.p2.2.m2.2.2.1.1.1.1.1.cmml" xref="S3.SS3.p2.2.m2.2.2.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS3.p2.2.m2.2.2.1.1.1.1.1.1.cmml" xref="S3.SS3.p2.2.m2.2.2.1.1.1.1.1">subscript</csymbol><apply id="S3.SS3.p2.2.m2.2.2.1.1.1.1.1.2.cmml" xref="S3.SS3.p2.2.m2.2.2.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS3.p2.2.m2.2.2.1.1.1.1.1.2.1.cmml" xref="S3.SS3.p2.2.m2.2.2.1.1.1.1.1">superscript</csymbol><ci id="S3.SS3.p2.2.m2.2.2.1.1.1.1.1.2.2.cmml" xref="S3.SS3.p2.2.m2.2.2.1.1.1.1.1.2.2">𝑆</ci><ci id="S3.SS3.p2.2.m2.2.2.1.1.1.1.1.2.3.cmml" xref="S3.SS3.p2.2.m2.2.2.1.1.1.1.1.2.3">𝑘</ci></apply><apply id="S3.SS3.p2.2.m2.2.2.1.1.1.1.1.3.cmml" xref="S3.SS3.p2.2.m2.2.2.1.1.1.1.1.3"><plus id="S3.SS3.p2.2.m2.2.2.1.1.1.1.1.3.1.cmml" xref="S3.SS3.p2.2.m2.2.2.1.1.1.1.1.3.1"></plus><ci id="S3.SS3.p2.2.m2.2.2.1.1.1.1.1.3.2.cmml" xref="S3.SS3.p2.2.m2.2.2.1.1.1.1.1.3.2">𝑡</ci><cn type="integer" id="S3.SS3.p2.2.m2.2.2.1.1.1.1.1.3.3.cmml" xref="S3.SS3.p2.2.m2.2.2.1.1.1.1.1.3.3">1</cn></apply></apply><ci id="S3.SS3.p2.2.m2.1.1.cmml" xref="S3.SS3.p2.2.m2.1.1">𝑘</ci></list><apply id="S3.SS3.p2.2.m2.2.2.1.1.3.cmml" xref="S3.SS3.p2.2.m2.2.2.1.1.3"><csymbol cd="ambiguous" id="S3.SS3.p2.2.m2.2.2.1.1.3.1.cmml" xref="S3.SS3.p2.2.m2.2.2.1.1.3">subscript</csymbol><ci id="S3.SS3.p2.2.m2.2.2.1.1.3.2.cmml" xref="S3.SS3.p2.2.m2.2.2.1.1.3.2">𝐿</ci><ci id="S3.SS3.p2.2.m2.2.2.1.1.3.3.cmml" xref="S3.SS3.p2.2.m2.2.2.1.1.3.3">𝑡</ci></apply></apply></set></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p2.2.m2.2c">\{S^{k}_{t+1},k\in L_{t}\}</annotation></semantics></math> are aggregated at the server to obtain the global student model <math id="S3.SS3.p2.3.m3.1" class="ltx_Math" alttext="S_{t+1}" display="inline"><semantics id="S3.SS3.p2.3.m3.1a"><msub id="S3.SS3.p2.3.m3.1.1" xref="S3.SS3.p2.3.m3.1.1.cmml"><mi id="S3.SS3.p2.3.m3.1.1.2" xref="S3.SS3.p2.3.m3.1.1.2.cmml">S</mi><mrow id="S3.SS3.p2.3.m3.1.1.3" xref="S3.SS3.p2.3.m3.1.1.3.cmml"><mi id="S3.SS3.p2.3.m3.1.1.3.2" xref="S3.SS3.p2.3.m3.1.1.3.2.cmml">t</mi><mo id="S3.SS3.p2.3.m3.1.1.3.1" xref="S3.SS3.p2.3.m3.1.1.3.1.cmml">+</mo><mn id="S3.SS3.p2.3.m3.1.1.3.3" xref="S3.SS3.p2.3.m3.1.1.3.3.cmml">1</mn></mrow></msub><annotation-xml encoding="MathML-Content" id="S3.SS3.p2.3.m3.1b"><apply id="S3.SS3.p2.3.m3.1.1.cmml" xref="S3.SS3.p2.3.m3.1.1"><csymbol cd="ambiguous" id="S3.SS3.p2.3.m3.1.1.1.cmml" xref="S3.SS3.p2.3.m3.1.1">subscript</csymbol><ci id="S3.SS3.p2.3.m3.1.1.2.cmml" xref="S3.SS3.p2.3.m3.1.1.2">𝑆</ci><apply id="S3.SS3.p2.3.m3.1.1.3.cmml" xref="S3.SS3.p2.3.m3.1.1.3"><plus id="S3.SS3.p2.3.m3.1.1.3.1.cmml" xref="S3.SS3.p2.3.m3.1.1.3.1"></plus><ci id="S3.SS3.p2.3.m3.1.1.3.2.cmml" xref="S3.SS3.p2.3.m3.1.1.3.2">𝑡</ci><cn type="integer" id="S3.SS3.p2.3.m3.1.1.3.3.cmml" xref="S3.SS3.p2.3.m3.1.1.3.3">1</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p2.3.m3.1c">S_{t+1}</annotation></semantics></math>. The global teacher model is updated through EMA from the aggregated global student model, resulting in <math id="S3.SS3.p2.4.m4.1" class="ltx_Math" alttext="T_{t+1}" display="inline"><semantics id="S3.SS3.p2.4.m4.1a"><msub id="S3.SS3.p2.4.m4.1.1" xref="S3.SS3.p2.4.m4.1.1.cmml"><mi id="S3.SS3.p2.4.m4.1.1.2" xref="S3.SS3.p2.4.m4.1.1.2.cmml">T</mi><mrow id="S3.SS3.p2.4.m4.1.1.3" xref="S3.SS3.p2.4.m4.1.1.3.cmml"><mi id="S3.SS3.p2.4.m4.1.1.3.2" xref="S3.SS3.p2.4.m4.1.1.3.2.cmml">t</mi><mo id="S3.SS3.p2.4.m4.1.1.3.1" xref="S3.SS3.p2.4.m4.1.1.3.1.cmml">+</mo><mn id="S3.SS3.p2.4.m4.1.1.3.3" xref="S3.SS3.p2.4.m4.1.1.3.3.cmml">1</mn></mrow></msub><annotation-xml encoding="MathML-Content" id="S3.SS3.p2.4.m4.1b"><apply id="S3.SS3.p2.4.m4.1.1.cmml" xref="S3.SS3.p2.4.m4.1.1"><csymbol cd="ambiguous" id="S3.SS3.p2.4.m4.1.1.1.cmml" xref="S3.SS3.p2.4.m4.1.1">subscript</csymbol><ci id="S3.SS3.p2.4.m4.1.1.2.cmml" xref="S3.SS3.p2.4.m4.1.1.2">𝑇</ci><apply id="S3.SS3.p2.4.m4.1.1.3.cmml" xref="S3.SS3.p2.4.m4.1.1.3"><plus id="S3.SS3.p2.4.m4.1.1.3.1.cmml" xref="S3.SS3.p2.4.m4.1.1.3.1"></plus><ci id="S3.SS3.p2.4.m4.1.1.3.2.cmml" xref="S3.SS3.p2.4.m4.1.1.3.2">𝑡</ci><cn type="integer" id="S3.SS3.p2.4.m4.1.1.3.3.cmml" xref="S3.SS3.p2.4.m4.1.1.3.3">1</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p2.4.m4.1c">T_{t+1}</annotation></semantics></math>. Clients utilize their copy of the global teacher model <math id="S3.SS3.p2.5.m5.1" class="ltx_Math" alttext="T_{t}" display="inline"><semantics id="S3.SS3.p2.5.m5.1a"><msub id="S3.SS3.p2.5.m5.1.1" xref="S3.SS3.p2.5.m5.1.1.cmml"><mi id="S3.SS3.p2.5.m5.1.1.2" xref="S3.SS3.p2.5.m5.1.1.2.cmml">T</mi><mi id="S3.SS3.p2.5.m5.1.1.3" xref="S3.SS3.p2.5.m5.1.1.3.cmml">t</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS3.p2.5.m5.1b"><apply id="S3.SS3.p2.5.m5.1.1.cmml" xref="S3.SS3.p2.5.m5.1.1"><csymbol cd="ambiguous" id="S3.SS3.p2.5.m5.1.1.1.cmml" xref="S3.SS3.p2.5.m5.1.1">subscript</csymbol><ci id="S3.SS3.p2.5.m5.1.1.2.cmml" xref="S3.SS3.p2.5.m5.1.1.2">𝑇</ci><ci id="S3.SS3.p2.5.m5.1.1.3.cmml" xref="S3.SS3.p2.5.m5.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p2.5.m5.1c">T_{t}</annotation></semantics></math> to generate pseudo-labels in each round. The global teacher does not get updated during client training; nor is it sent to the server along with the local student model updates. We refer to this approach in the rest of the paper as <span id="S3.SS3.p2.6.2" class="ltx_text ltx_font_italic">TS-Server EMA</span>. Note that setting <math id="S3.SS3.p2.6.m6.1" class="ltx_Math" alttext="T=S" display="inline"><semantics id="S3.SS3.p2.6.m6.1a"><mrow id="S3.SS3.p2.6.m6.1.1" xref="S3.SS3.p2.6.m6.1.1.cmml"><mi id="S3.SS3.p2.6.m6.1.1.2" xref="S3.SS3.p2.6.m6.1.1.2.cmml">T</mi><mo id="S3.SS3.p2.6.m6.1.1.1" xref="S3.SS3.p2.6.m6.1.1.1.cmml">=</mo><mi id="S3.SS3.p2.6.m6.1.1.3" xref="S3.SS3.p2.6.m6.1.1.3.cmml">S</mi></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.p2.6.m6.1b"><apply id="S3.SS3.p2.6.m6.1.1.cmml" xref="S3.SS3.p2.6.m6.1.1"><eq id="S3.SS3.p2.6.m6.1.1.1.cmml" xref="S3.SS3.p2.6.m6.1.1.1"></eq><ci id="S3.SS3.p2.6.m6.1.1.2.cmml" xref="S3.SS3.p2.6.m6.1.1.2">𝑇</ci><ci id="S3.SS3.p2.6.m6.1.1.3.cmml" xref="S3.SS3.p2.6.m6.1.1.3">𝑆</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p2.6.m6.1c">T=S</annotation></semantics></math> and skipping the EMA update for the global teacher model would reduce to FedProx-FixMatch.</p>
</div>
<figure id="alg2" class="ltx_float ltx_float_algorithm ltx_framed ltx_framed_top">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_float"><span id="alg2.26.1.1" class="ltx_text ltx_font_bold">Algorithm 2</span> </span> <span id="alg2.27.2" class="ltx_text ltx_font_bold">Labels-at-Server
(sequential). 
</span>Client devices <math id="alg2.12.m1.3" class="ltx_Math" alttext="1,\dots,K" display="inline"><semantics id="alg2.12.m1.3b"><mrow id="alg2.12.m1.3.4.2" xref="alg2.12.m1.3.4.1.cmml"><mn id="alg2.12.m1.1.1" xref="alg2.12.m1.1.1.cmml">1</mn><mo id="alg2.12.m1.3.4.2.1" xref="alg2.12.m1.3.4.1.cmml">,</mo><mi mathvariant="normal" id="alg2.12.m1.2.2" xref="alg2.12.m1.2.2.cmml">…</mi><mo id="alg2.12.m1.3.4.2.2" xref="alg2.12.m1.3.4.1.cmml">,</mo><mi id="alg2.12.m1.3.3" xref="alg2.12.m1.3.3.cmml">K</mi></mrow><annotation-xml encoding="MathML-Content" id="alg2.12.m1.3c"><list id="alg2.12.m1.3.4.1.cmml" xref="alg2.12.m1.3.4.2"><cn type="integer" id="alg2.12.m1.1.1.cmml" xref="alg2.12.m1.1.1">1</cn><ci id="alg2.12.m1.2.2.cmml" xref="alg2.12.m1.2.2">…</ci><ci id="alg2.12.m1.3.3.cmml" xref="alg2.12.m1.3.3">𝐾</ci></list></annotation-xml><annotation encoding="application/x-tex" id="alg2.12.m1.3d">1,\dots,K</annotation></semantics></math>, participation rate <math id="alg2.13.m2.1" class="ltx_Math" alttext="C" display="inline"><semantics id="alg2.13.m2.1b"><mi id="alg2.13.m2.1.1" xref="alg2.13.m2.1.1.cmml">C</mi><annotation-xml encoding="MathML-Content" id="alg2.13.m2.1c"><ci id="alg2.13.m2.1.1.cmml" xref="alg2.13.m2.1.1">𝐶</ci></annotation-xml><annotation encoding="application/x-tex" id="alg2.13.m2.1d">C</annotation></semantics></math>, client learning rate <math id="alg2.14.m3.1" class="ltx_Math" alttext="\eta_{c}" display="inline"><semantics id="alg2.14.m3.1b"><msub id="alg2.14.m3.1.1" xref="alg2.14.m3.1.1.cmml"><mi id="alg2.14.m3.1.1.2" xref="alg2.14.m3.1.1.2.cmml">η</mi><mi id="alg2.14.m3.1.1.3" xref="alg2.14.m3.1.1.3.cmml">c</mi></msub><annotation-xml encoding="MathML-Content" id="alg2.14.m3.1c"><apply id="alg2.14.m3.1.1.cmml" xref="alg2.14.m3.1.1"><csymbol cd="ambiguous" id="alg2.14.m3.1.1.1.cmml" xref="alg2.14.m3.1.1">subscript</csymbol><ci id="alg2.14.m3.1.1.2.cmml" xref="alg2.14.m3.1.1.2">𝜂</ci><ci id="alg2.14.m3.1.1.3.cmml" xref="alg2.14.m3.1.1.3">𝑐</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.14.m3.1d">\eta_{c}</annotation></semantics></math>, server learning rate <math id="alg2.15.m4.1" class="ltx_Math" alttext="\eta_{s}" display="inline"><semantics id="alg2.15.m4.1b"><msub id="alg2.15.m4.1.1" xref="alg2.15.m4.1.1.cmml"><mi id="alg2.15.m4.1.1.2" xref="alg2.15.m4.1.1.2.cmml">η</mi><mi id="alg2.15.m4.1.1.3" xref="alg2.15.m4.1.1.3.cmml">s</mi></msub><annotation-xml encoding="MathML-Content" id="alg2.15.m4.1c"><apply id="alg2.15.m4.1.1.cmml" xref="alg2.15.m4.1.1"><csymbol cd="ambiguous" id="alg2.15.m4.1.1.1.cmml" xref="alg2.15.m4.1.1">subscript</csymbol><ci id="alg2.15.m4.1.1.2.cmml" xref="alg2.15.m4.1.1.2">𝜂</ci><ci id="alg2.15.m4.1.1.3.cmml" xref="alg2.15.m4.1.1.3">𝑠</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.15.m4.1d">\eta_{s}</annotation></semantics></math>, number of local client epochs <math id="alg2.16.m5.1" class="ltx_Math" alttext="E_{c}" display="inline"><semantics id="alg2.16.m5.1b"><msub id="alg2.16.m5.1.1" xref="alg2.16.m5.1.1.cmml"><mi id="alg2.16.m5.1.1.2" xref="alg2.16.m5.1.1.2.cmml">E</mi><mi id="alg2.16.m5.1.1.3" xref="alg2.16.m5.1.1.3.cmml">c</mi></msub><annotation-xml encoding="MathML-Content" id="alg2.16.m5.1c"><apply id="alg2.16.m5.1.1.cmml" xref="alg2.16.m5.1.1"><csymbol cd="ambiguous" id="alg2.16.m5.1.1.1.cmml" xref="alg2.16.m5.1.1">subscript</csymbol><ci id="alg2.16.m5.1.1.2.cmml" xref="alg2.16.m5.1.1.2">𝐸</ci><ci id="alg2.16.m5.1.1.3.cmml" xref="alg2.16.m5.1.1.3">𝑐</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.16.m5.1d">E_{c}</annotation></semantics></math>, number of local server epochs <math id="alg2.17.m6.1" class="ltx_Math" alttext="E_{s}" display="inline"><semantics id="alg2.17.m6.1b"><msub id="alg2.17.m6.1.1" xref="alg2.17.m6.1.1.cmml"><mi id="alg2.17.m6.1.1.2" xref="alg2.17.m6.1.1.2.cmml">E</mi><mi id="alg2.17.m6.1.1.3" xref="alg2.17.m6.1.1.3.cmml">s</mi></msub><annotation-xml encoding="MathML-Content" id="alg2.17.m6.1c"><apply id="alg2.17.m6.1.1.cmml" xref="alg2.17.m6.1.1"><csymbol cd="ambiguous" id="alg2.17.m6.1.1.1.cmml" xref="alg2.17.m6.1.1">subscript</csymbol><ci id="alg2.17.m6.1.1.2.cmml" xref="alg2.17.m6.1.1.2">𝐸</ci><ci id="alg2.17.m6.1.1.3.cmml" xref="alg2.17.m6.1.1.3">𝑠</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.17.m6.1d">E_{s}</annotation></semantics></math>, FixMatch parameter <math id="alg2.18.m7.1" class="ltx_Math" alttext="\lambda_{u}" display="inline"><semantics id="alg2.18.m7.1b"><msub id="alg2.18.m7.1.1" xref="alg2.18.m7.1.1.cmml"><mi id="alg2.18.m7.1.1.2" xref="alg2.18.m7.1.1.2.cmml">λ</mi><mi id="alg2.18.m7.1.1.3" xref="alg2.18.m7.1.1.3.cmml">u</mi></msub><annotation-xml encoding="MathML-Content" id="alg2.18.m7.1c"><apply id="alg2.18.m7.1.1.cmml" xref="alg2.18.m7.1.1"><csymbol cd="ambiguous" id="alg2.18.m7.1.1.1.cmml" xref="alg2.18.m7.1.1">subscript</csymbol><ci id="alg2.18.m7.1.1.2.cmml" xref="alg2.18.m7.1.1.2">𝜆</ci><ci id="alg2.18.m7.1.1.3.cmml" xref="alg2.18.m7.1.1.3">𝑢</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.18.m7.1d">\lambda_{u}</annotation></semantics></math>, FedProx parameter <math id="alg2.19.m8.1" class="ltx_Math" alttext="\mu" display="inline"><semantics id="alg2.19.m8.1b"><mi id="alg2.19.m8.1.1" xref="alg2.19.m8.1.1.cmml">μ</mi><annotation-xml encoding="MathML-Content" id="alg2.19.m8.1c"><ci id="alg2.19.m8.1.1.cmml" xref="alg2.19.m8.1.1">𝜇</ci></annotation-xml><annotation encoding="application/x-tex" id="alg2.19.m8.1d">\mu</annotation></semantics></math>, EMA ratio <math id="alg2.20.m9.1" class="ltx_Math" alttext="\alpha" display="inline"><semantics id="alg2.20.m9.1b"><mi id="alg2.20.m9.1.1" xref="alg2.20.m9.1.1.cmml">α</mi><annotation-xml encoding="MathML-Content" id="alg2.20.m9.1c"><ci id="alg2.20.m9.1.1.cmml" xref="alg2.20.m9.1.1">𝛼</ci></annotation-xml><annotation encoding="application/x-tex" id="alg2.20.m9.1d">\alpha</annotation></semantics></math>. In practice, <span id="alg2.28.3" class="ltx_text ltx_font_bold">ClientUpdate</span> returns the difference <math id="alg2.21.m10.1" class="ltx_Math" alttext="S-S^{s}" display="inline"><semantics id="alg2.21.m10.1b"><mrow id="alg2.21.m10.1.1" xref="alg2.21.m10.1.1.cmml"><mi id="alg2.21.m10.1.1.2" xref="alg2.21.m10.1.1.2.cmml">S</mi><mo id="alg2.21.m10.1.1.1" xref="alg2.21.m10.1.1.1.cmml">−</mo><msup id="alg2.21.m10.1.1.3" xref="alg2.21.m10.1.1.3.cmml"><mi id="alg2.21.m10.1.1.3.2" xref="alg2.21.m10.1.1.3.2.cmml">S</mi><mi id="alg2.21.m10.1.1.3.3" xref="alg2.21.m10.1.1.3.3.cmml">s</mi></msup></mrow><annotation-xml encoding="MathML-Content" id="alg2.21.m10.1c"><apply id="alg2.21.m10.1.1.cmml" xref="alg2.21.m10.1.1"><minus id="alg2.21.m10.1.1.1.cmml" xref="alg2.21.m10.1.1.1"></minus><ci id="alg2.21.m10.1.1.2.cmml" xref="alg2.21.m10.1.1.2">𝑆</ci><apply id="alg2.21.m10.1.1.3.cmml" xref="alg2.21.m10.1.1.3"><csymbol cd="ambiguous" id="alg2.21.m10.1.1.3.1.cmml" xref="alg2.21.m10.1.1.3">superscript</csymbol><ci id="alg2.21.m10.1.1.3.2.cmml" xref="alg2.21.m10.1.1.3.2">𝑆</ci><ci id="alg2.21.m10.1.1.3.3.cmml" xref="alg2.21.m10.1.1.3.3">𝑠</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.21.m10.1d">S-S^{s}</annotation></semantics></math> instead of <math id="alg2.22.m11.1" class="ltx_Math" alttext="S" display="inline"><semantics id="alg2.22.m11.1b"><mi id="alg2.22.m11.1.1" xref="alg2.22.m11.1.1.cmml">S</mi><annotation-xml encoding="MathML-Content" id="alg2.22.m11.1c"><ci id="alg2.22.m11.1.1.cmml" xref="alg2.22.m11.1.1">𝑆</ci></annotation-xml><annotation encoding="application/x-tex" id="alg2.22.m11.1d">S</annotation></semantics></math>.</figcaption>
<div id="alg2.29" class="ltx_listing ltx_listing">
<div id="alg2.l1" class="ltx_listingline">
<span id="alg2.l1.1" class="ltx_text" style="font-size:70%;"> </span><span id="alg2.l1.2" class="ltx_text ltx_font_bold" style="font-size:70%;">Server executes:</span><span id="alg2.l1.3" class="ltx_text" style="font-size:70%;">
</span>
</div>
<div id="alg2.l2" class="ltx_listingline">
<span id="alg2.l2.1" class="ltx_text" style="font-size:70%;"> initialize global
student model </span><math id="alg2.l2.m1.1" class="ltx_Math" alttext="S_{0}" display="inline"><semantics id="alg2.l2.m1.1a"><msub id="alg2.l2.m1.1.1" xref="alg2.l2.m1.1.1.cmml"><mi mathsize="70%" id="alg2.l2.m1.1.1.2" xref="alg2.l2.m1.1.1.2.cmml">S</mi><mn mathsize="70%" id="alg2.l2.m1.1.1.3" xref="alg2.l2.m1.1.1.3.cmml">0</mn></msub><annotation-xml encoding="MathML-Content" id="alg2.l2.m1.1b"><apply id="alg2.l2.m1.1.1.cmml" xref="alg2.l2.m1.1.1"><csymbol cd="ambiguous" id="alg2.l2.m1.1.1.1.cmml" xref="alg2.l2.m1.1.1">subscript</csymbol><ci id="alg2.l2.m1.1.1.2.cmml" xref="alg2.l2.m1.1.1.2">𝑆</ci><cn type="integer" id="alg2.l2.m1.1.1.3.cmml" xref="alg2.l2.m1.1.1.3">0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.l2.m1.1c">S_{0}</annotation></semantics></math><span id="alg2.l2.2" class="ltx_text" style="font-size:70%;"> and teacher model </span><math id="alg2.l2.m2.1" class="ltx_Math" alttext="T_{0}" display="inline"><semantics id="alg2.l2.m2.1a"><msub id="alg2.l2.m2.1.1" xref="alg2.l2.m2.1.1.cmml"><mi mathsize="70%" id="alg2.l2.m2.1.1.2" xref="alg2.l2.m2.1.1.2.cmml">T</mi><mn mathsize="70%" id="alg2.l2.m2.1.1.3" xref="alg2.l2.m2.1.1.3.cmml">0</mn></msub><annotation-xml encoding="MathML-Content" id="alg2.l2.m2.1b"><apply id="alg2.l2.m2.1.1.cmml" xref="alg2.l2.m2.1.1"><csymbol cd="ambiguous" id="alg2.l2.m2.1.1.1.cmml" xref="alg2.l2.m2.1.1">subscript</csymbol><ci id="alg2.l2.m2.1.1.2.cmml" xref="alg2.l2.m2.1.1.2">𝑇</ci><cn type="integer" id="alg2.l2.m2.1.1.3.cmml" xref="alg2.l2.m2.1.1.3">0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.l2.m2.1c">T_{0}</annotation></semantics></math><span id="alg2.l2.3" class="ltx_text" style="font-size:70%;">
</span>
</div>
<div id="alg2.l3" class="ltx_listingline">
<span id="alg2.l3.1" class="ltx_text" style="font-size:70%;"> </span><span id="alg2.l3.2" class="ltx_text ltx_font_bold" style="font-size:70%;">for</span><span id="alg2.l3.3" class="ltx_text" style="font-size:70%;"> each round </span><math id="alg2.l3.m1.3" class="ltx_Math" alttext="t=1,2,\dots" display="inline"><semantics id="alg2.l3.m1.3a"><mrow id="alg2.l3.m1.3.4" xref="alg2.l3.m1.3.4.cmml"><mi mathsize="70%" id="alg2.l3.m1.3.4.2" xref="alg2.l3.m1.3.4.2.cmml">t</mi><mo mathsize="70%" id="alg2.l3.m1.3.4.1" xref="alg2.l3.m1.3.4.1.cmml">=</mo><mrow id="alg2.l3.m1.3.4.3.2" xref="alg2.l3.m1.3.4.3.1.cmml"><mn mathsize="70%" id="alg2.l3.m1.1.1" xref="alg2.l3.m1.1.1.cmml">1</mn><mo mathsize="70%" id="alg2.l3.m1.3.4.3.2.1" xref="alg2.l3.m1.3.4.3.1.cmml">,</mo><mn mathsize="70%" id="alg2.l3.m1.2.2" xref="alg2.l3.m1.2.2.cmml">2</mn><mo mathsize="70%" id="alg2.l3.m1.3.4.3.2.2" xref="alg2.l3.m1.3.4.3.1.cmml">,</mo><mi mathsize="70%" mathvariant="normal" id="alg2.l3.m1.3.3" xref="alg2.l3.m1.3.3.cmml">…</mi></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg2.l3.m1.3b"><apply id="alg2.l3.m1.3.4.cmml" xref="alg2.l3.m1.3.4"><eq id="alg2.l3.m1.3.4.1.cmml" xref="alg2.l3.m1.3.4.1"></eq><ci id="alg2.l3.m1.3.4.2.cmml" xref="alg2.l3.m1.3.4.2">𝑡</ci><list id="alg2.l3.m1.3.4.3.1.cmml" xref="alg2.l3.m1.3.4.3.2"><cn type="integer" id="alg2.l3.m1.1.1.cmml" xref="alg2.l3.m1.1.1">1</cn><cn type="integer" id="alg2.l3.m1.2.2.cmml" xref="alg2.l3.m1.2.2">2</cn><ci id="alg2.l3.m1.3.3.cmml" xref="alg2.l3.m1.3.3">…</ci></list></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.l3.m1.3c">t=1,2,\dots</annotation></semantics></math><span id="alg2.l3.4" class="ltx_text" style="font-size:70%;"> </span><span id="alg2.l3.5" class="ltx_text ltx_font_bold" style="font-size:70%;">do</span><span id="alg2.l3.6" class="ltx_text" style="font-size:70%;">


</span>
</div>
<div id="alg2.l4" class="ltx_listingline">
<span id="alg2.l4.1" class="ltx_text" style="font-size:70%;">    </span><math id="alg2.l4.m1.3" class="ltx_Math" alttext="m\leftarrow\max(C\cdot K,1)" display="inline"><semantics id="alg2.l4.m1.3a"><mrow id="alg2.l4.m1.3.3" xref="alg2.l4.m1.3.3.cmml"><mi mathsize="70%" id="alg2.l4.m1.3.3.3" xref="alg2.l4.m1.3.3.3.cmml">m</mi><mo mathsize="70%" stretchy="false" id="alg2.l4.m1.3.3.2" xref="alg2.l4.m1.3.3.2.cmml">←</mo><mrow id="alg2.l4.m1.3.3.1.1" xref="alg2.l4.m1.3.3.1.2.cmml"><mi mathsize="70%" id="alg2.l4.m1.1.1" xref="alg2.l4.m1.1.1.cmml">max</mi><mo id="alg2.l4.m1.3.3.1.1a" xref="alg2.l4.m1.3.3.1.2.cmml">⁡</mo><mrow id="alg2.l4.m1.3.3.1.1.1" xref="alg2.l4.m1.3.3.1.2.cmml"><mo maxsize="70%" minsize="70%" id="alg2.l4.m1.3.3.1.1.1.2" xref="alg2.l4.m1.3.3.1.2.cmml">(</mo><mrow id="alg2.l4.m1.3.3.1.1.1.1" xref="alg2.l4.m1.3.3.1.1.1.1.cmml"><mi mathsize="70%" id="alg2.l4.m1.3.3.1.1.1.1.2" xref="alg2.l4.m1.3.3.1.1.1.1.2.cmml">C</mi><mo lspace="0.222em" mathsize="70%" rspace="0.222em" id="alg2.l4.m1.3.3.1.1.1.1.1" xref="alg2.l4.m1.3.3.1.1.1.1.1.cmml">⋅</mo><mi mathsize="70%" id="alg2.l4.m1.3.3.1.1.1.1.3" xref="alg2.l4.m1.3.3.1.1.1.1.3.cmml">K</mi></mrow><mo mathsize="70%" id="alg2.l4.m1.3.3.1.1.1.3" xref="alg2.l4.m1.3.3.1.2.cmml">,</mo><mn mathsize="70%" id="alg2.l4.m1.2.2" xref="alg2.l4.m1.2.2.cmml">1</mn><mo maxsize="70%" minsize="70%" id="alg2.l4.m1.3.3.1.1.1.4" xref="alg2.l4.m1.3.3.1.2.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg2.l4.m1.3b"><apply id="alg2.l4.m1.3.3.cmml" xref="alg2.l4.m1.3.3"><ci id="alg2.l4.m1.3.3.2.cmml" xref="alg2.l4.m1.3.3.2">←</ci><ci id="alg2.l4.m1.3.3.3.cmml" xref="alg2.l4.m1.3.3.3">𝑚</ci><apply id="alg2.l4.m1.3.3.1.2.cmml" xref="alg2.l4.m1.3.3.1.1"><max id="alg2.l4.m1.1.1.cmml" xref="alg2.l4.m1.1.1"></max><apply id="alg2.l4.m1.3.3.1.1.1.1.cmml" xref="alg2.l4.m1.3.3.1.1.1.1"><ci id="alg2.l4.m1.3.3.1.1.1.1.1.cmml" xref="alg2.l4.m1.3.3.1.1.1.1.1">⋅</ci><ci id="alg2.l4.m1.3.3.1.1.1.1.2.cmml" xref="alg2.l4.m1.3.3.1.1.1.1.2">𝐶</ci><ci id="alg2.l4.m1.3.3.1.1.1.1.3.cmml" xref="alg2.l4.m1.3.3.1.1.1.1.3">𝐾</ci></apply><cn type="integer" id="alg2.l4.m1.2.2.cmml" xref="alg2.l4.m1.2.2">1</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.l4.m1.3c">m\leftarrow\max(C\cdot K,1)</annotation></semantics></math><span id="alg2.l4.2" class="ltx_text" style="font-size:70%;">
</span>
</div>
<div id="alg2.l5" class="ltx_listingline">
<span id="alg2.l5.1" class="ltx_text" style="font-size:70%;">    </span><math id="alg2.l5.m1.1" class="ltx_Math" alttext="L_{t}\leftarrow" display="inline"><semantics id="alg2.l5.m1.1a"><mrow id="alg2.l5.m1.1.1" xref="alg2.l5.m1.1.1.cmml"><msub id="alg2.l5.m1.1.1.2" xref="alg2.l5.m1.1.1.2.cmml"><mi mathsize="70%" id="alg2.l5.m1.1.1.2.2" xref="alg2.l5.m1.1.1.2.2.cmml">L</mi><mi mathsize="70%" id="alg2.l5.m1.1.1.2.3" xref="alg2.l5.m1.1.1.2.3.cmml">t</mi></msub><mo mathsize="70%" stretchy="false" id="alg2.l5.m1.1.1.1" xref="alg2.l5.m1.1.1.1.cmml">←</mo><mi id="alg2.l5.m1.1.1.3" xref="alg2.l5.m1.1.1.3.cmml"></mi></mrow><annotation-xml encoding="MathML-Content" id="alg2.l5.m1.1b"><apply id="alg2.l5.m1.1.1.cmml" xref="alg2.l5.m1.1.1"><ci id="alg2.l5.m1.1.1.1.cmml" xref="alg2.l5.m1.1.1.1">←</ci><apply id="alg2.l5.m1.1.1.2.cmml" xref="alg2.l5.m1.1.1.2"><csymbol cd="ambiguous" id="alg2.l5.m1.1.1.2.1.cmml" xref="alg2.l5.m1.1.1.2">subscript</csymbol><ci id="alg2.l5.m1.1.1.2.2.cmml" xref="alg2.l5.m1.1.1.2.2">𝐿</ci><ci id="alg2.l5.m1.1.1.2.3.cmml" xref="alg2.l5.m1.1.1.2.3">𝑡</ci></apply><csymbol cd="latexml" id="alg2.l5.m1.1.1.3.cmml" xref="alg2.l5.m1.1.1.3">absent</csymbol></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.l5.m1.1c">L_{t}\leftarrow</annotation></semantics></math><span id="alg2.l5.2" class="ltx_text" style="font-size:70%;"> (random set of </span><math id="alg2.l5.m2.1" class="ltx_Math" alttext="m" display="inline"><semantics id="alg2.l5.m2.1a"><mi mathsize="70%" id="alg2.l5.m2.1.1" xref="alg2.l5.m2.1.1.cmml">m</mi><annotation-xml encoding="MathML-Content" id="alg2.l5.m2.1b"><ci id="alg2.l5.m2.1.1.cmml" xref="alg2.l5.m2.1.1">𝑚</ci></annotation-xml><annotation encoding="application/x-tex" id="alg2.l5.m2.1c">m</annotation></semantics></math><span id="alg2.l5.3" class="ltx_text" style="font-size:70%;"> clients)
</span>
</div>
<div id="alg2.l6" class="ltx_listingline">
<span id="alg2.l6.1" class="ltx_text" style="font-size:70%;">    </span><span id="alg2.l6.2" class="ltx_text ltx_font_bold" style="font-size:70%;">if</span><span id="alg2.l6.3" class="ltx_text" style="font-size:70%;"> </span><math id="alg2.l6.m1.2" class="ltx_Math" alttext="|D_{\text{KL}}^{T}-\beta|&lt;|D_{\text{KL}}^{S}-\beta|" display="inline"><semantics id="alg2.l6.m1.2a"><mrow id="alg2.l6.m1.2.2" xref="alg2.l6.m1.2.2.cmml"><mrow id="alg2.l6.m1.1.1.1.1" xref="alg2.l6.m1.1.1.1.2.cmml"><mo maxsize="70%" minsize="70%" id="alg2.l6.m1.1.1.1.1.2" xref="alg2.l6.m1.1.1.1.2.1.cmml">|</mo><mrow id="alg2.l6.m1.1.1.1.1.1" xref="alg2.l6.m1.1.1.1.1.1.cmml"><msubsup id="alg2.l6.m1.1.1.1.1.1.2" xref="alg2.l6.m1.1.1.1.1.1.2.cmml"><mi mathsize="70%" id="alg2.l6.m1.1.1.1.1.1.2.2.2" xref="alg2.l6.m1.1.1.1.1.1.2.2.2.cmml">D</mi><mtext mathsize="70%" id="alg2.l6.m1.1.1.1.1.1.2.2.3" xref="alg2.l6.m1.1.1.1.1.1.2.2.3a.cmml">KL</mtext><mi mathsize="70%" id="alg2.l6.m1.1.1.1.1.1.2.3" xref="alg2.l6.m1.1.1.1.1.1.2.3.cmml">T</mi></msubsup><mo mathsize="70%" id="alg2.l6.m1.1.1.1.1.1.1" xref="alg2.l6.m1.1.1.1.1.1.1.cmml">−</mo><mi mathsize="70%" id="alg2.l6.m1.1.1.1.1.1.3" xref="alg2.l6.m1.1.1.1.1.1.3.cmml">β</mi></mrow><mo maxsize="70%" minsize="70%" id="alg2.l6.m1.1.1.1.1.3" xref="alg2.l6.m1.1.1.1.2.1.cmml">|</mo></mrow><mo mathsize="70%" id="alg2.l6.m1.2.2.3" xref="alg2.l6.m1.2.2.3.cmml">&lt;</mo><mrow id="alg2.l6.m1.2.2.2.1" xref="alg2.l6.m1.2.2.2.2.cmml"><mo maxsize="70%" minsize="70%" id="alg2.l6.m1.2.2.2.1.2" xref="alg2.l6.m1.2.2.2.2.1.cmml">|</mo><mrow id="alg2.l6.m1.2.2.2.1.1" xref="alg2.l6.m1.2.2.2.1.1.cmml"><msubsup id="alg2.l6.m1.2.2.2.1.1.2" xref="alg2.l6.m1.2.2.2.1.1.2.cmml"><mi mathsize="70%" id="alg2.l6.m1.2.2.2.1.1.2.2.2" xref="alg2.l6.m1.2.2.2.1.1.2.2.2.cmml">D</mi><mtext mathsize="70%" id="alg2.l6.m1.2.2.2.1.1.2.2.3" xref="alg2.l6.m1.2.2.2.1.1.2.2.3a.cmml">KL</mtext><mi mathsize="70%" id="alg2.l6.m1.2.2.2.1.1.2.3" xref="alg2.l6.m1.2.2.2.1.1.2.3.cmml">S</mi></msubsup><mo mathsize="70%" id="alg2.l6.m1.2.2.2.1.1.1" xref="alg2.l6.m1.2.2.2.1.1.1.cmml">−</mo><mi mathsize="70%" id="alg2.l6.m1.2.2.2.1.1.3" xref="alg2.l6.m1.2.2.2.1.1.3.cmml">β</mi></mrow><mo maxsize="70%" minsize="70%" id="alg2.l6.m1.2.2.2.1.3" xref="alg2.l6.m1.2.2.2.2.1.cmml">|</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg2.l6.m1.2b"><apply id="alg2.l6.m1.2.2.cmml" xref="alg2.l6.m1.2.2"><lt id="alg2.l6.m1.2.2.3.cmml" xref="alg2.l6.m1.2.2.3"></lt><apply id="alg2.l6.m1.1.1.1.2.cmml" xref="alg2.l6.m1.1.1.1.1"><abs id="alg2.l6.m1.1.1.1.2.1.cmml" xref="alg2.l6.m1.1.1.1.1.2"></abs><apply id="alg2.l6.m1.1.1.1.1.1.cmml" xref="alg2.l6.m1.1.1.1.1.1"><minus id="alg2.l6.m1.1.1.1.1.1.1.cmml" xref="alg2.l6.m1.1.1.1.1.1.1"></minus><apply id="alg2.l6.m1.1.1.1.1.1.2.cmml" xref="alg2.l6.m1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="alg2.l6.m1.1.1.1.1.1.2.1.cmml" xref="alg2.l6.m1.1.1.1.1.1.2">superscript</csymbol><apply id="alg2.l6.m1.1.1.1.1.1.2.2.cmml" xref="alg2.l6.m1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="alg2.l6.m1.1.1.1.1.1.2.2.1.cmml" xref="alg2.l6.m1.1.1.1.1.1.2">subscript</csymbol><ci id="alg2.l6.m1.1.1.1.1.1.2.2.2.cmml" xref="alg2.l6.m1.1.1.1.1.1.2.2.2">𝐷</ci><ci id="alg2.l6.m1.1.1.1.1.1.2.2.3a.cmml" xref="alg2.l6.m1.1.1.1.1.1.2.2.3"><mtext mathsize="49%" id="alg2.l6.m1.1.1.1.1.1.2.2.3.cmml" xref="alg2.l6.m1.1.1.1.1.1.2.2.3">KL</mtext></ci></apply><ci id="alg2.l6.m1.1.1.1.1.1.2.3.cmml" xref="alg2.l6.m1.1.1.1.1.1.2.3">𝑇</ci></apply><ci id="alg2.l6.m1.1.1.1.1.1.3.cmml" xref="alg2.l6.m1.1.1.1.1.1.3">𝛽</ci></apply></apply><apply id="alg2.l6.m1.2.2.2.2.cmml" xref="alg2.l6.m1.2.2.2.1"><abs id="alg2.l6.m1.2.2.2.2.1.cmml" xref="alg2.l6.m1.2.2.2.1.2"></abs><apply id="alg2.l6.m1.2.2.2.1.1.cmml" xref="alg2.l6.m1.2.2.2.1.1"><minus id="alg2.l6.m1.2.2.2.1.1.1.cmml" xref="alg2.l6.m1.2.2.2.1.1.1"></minus><apply id="alg2.l6.m1.2.2.2.1.1.2.cmml" xref="alg2.l6.m1.2.2.2.1.1.2"><csymbol cd="ambiguous" id="alg2.l6.m1.2.2.2.1.1.2.1.cmml" xref="alg2.l6.m1.2.2.2.1.1.2">superscript</csymbol><apply id="alg2.l6.m1.2.2.2.1.1.2.2.cmml" xref="alg2.l6.m1.2.2.2.1.1.2"><csymbol cd="ambiguous" id="alg2.l6.m1.2.2.2.1.1.2.2.1.cmml" xref="alg2.l6.m1.2.2.2.1.1.2">subscript</csymbol><ci id="alg2.l6.m1.2.2.2.1.1.2.2.2.cmml" xref="alg2.l6.m1.2.2.2.1.1.2.2.2">𝐷</ci><ci id="alg2.l6.m1.2.2.2.1.1.2.2.3a.cmml" xref="alg2.l6.m1.2.2.2.1.1.2.2.3"><mtext mathsize="49%" id="alg2.l6.m1.2.2.2.1.1.2.2.3.cmml" xref="alg2.l6.m1.2.2.2.1.1.2.2.3">KL</mtext></ci></apply><ci id="alg2.l6.m1.2.2.2.1.1.2.3.cmml" xref="alg2.l6.m1.2.2.2.1.1.2.3">𝑆</ci></apply><ci id="alg2.l6.m1.2.2.2.1.1.3.cmml" xref="alg2.l6.m1.2.2.2.1.1.3">𝛽</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.l6.m1.2c">|D_{\text{KL}}^{T}-\beta|&lt;|D_{\text{KL}}^{S}-\beta|</annotation></semantics></math><span id="alg2.l6.4" class="ltx_text" style="font-size:70%;"> </span><span id="alg2.l6.5" class="ltx_text ltx_font_bold" style="font-size:70%;">then</span><span id="alg2.l6.6" class="ltx_text" style="font-size:70%;">


</span>
</div>
<div id="alg2.l7" class="ltx_listingline">
<span id="alg2.l7.1" class="ltx_text" style="font-size:70%;">      </span><math id="alg2.l7.m1.1" class="ltx_Math" alttext="T_{t}^{\prime}\leftarrow\emptyset" display="inline"><semantics id="alg2.l7.m1.1a"><mrow id="alg2.l7.m1.1.1" xref="alg2.l7.m1.1.1.cmml"><msubsup id="alg2.l7.m1.1.1.2" xref="alg2.l7.m1.1.1.2.cmml"><mi mathsize="70%" id="alg2.l7.m1.1.1.2.2.2" xref="alg2.l7.m1.1.1.2.2.2.cmml">T</mi><mi mathsize="70%" id="alg2.l7.m1.1.1.2.2.3" xref="alg2.l7.m1.1.1.2.2.3.cmml">t</mi><mo mathsize="70%" id="alg2.l7.m1.1.1.2.3" xref="alg2.l7.m1.1.1.2.3.cmml">′</mo></msubsup><mo mathsize="70%" stretchy="false" id="alg2.l7.m1.1.1.1" xref="alg2.l7.m1.1.1.1.cmml">←</mo><mi mathsize="70%" mathvariant="normal" id="alg2.l7.m1.1.1.3" xref="alg2.l7.m1.1.1.3.cmml">∅</mi></mrow><annotation-xml encoding="MathML-Content" id="alg2.l7.m1.1b"><apply id="alg2.l7.m1.1.1.cmml" xref="alg2.l7.m1.1.1"><ci id="alg2.l7.m1.1.1.1.cmml" xref="alg2.l7.m1.1.1.1">←</ci><apply id="alg2.l7.m1.1.1.2.cmml" xref="alg2.l7.m1.1.1.2"><csymbol cd="ambiguous" id="alg2.l7.m1.1.1.2.1.cmml" xref="alg2.l7.m1.1.1.2">superscript</csymbol><apply id="alg2.l7.m1.1.1.2.2.cmml" xref="alg2.l7.m1.1.1.2"><csymbol cd="ambiguous" id="alg2.l7.m1.1.1.2.2.1.cmml" xref="alg2.l7.m1.1.1.2">subscript</csymbol><ci id="alg2.l7.m1.1.1.2.2.2.cmml" xref="alg2.l7.m1.1.1.2.2.2">𝑇</ci><ci id="alg2.l7.m1.1.1.2.2.3.cmml" xref="alg2.l7.m1.1.1.2.2.3">𝑡</ci></apply><ci id="alg2.l7.m1.1.1.2.3.cmml" xref="alg2.l7.m1.1.1.2.3">′</ci></apply><emptyset id="alg2.l7.m1.1.1.3.cmml" xref="alg2.l7.m1.1.1.3"></emptyset></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.l7.m1.1c">T_{t}^{\prime}\leftarrow\emptyset</annotation></semantics></math><span id="alg2.l7.2" class="ltx_text" style="font-size:70%;">
</span>
</div>
<div id="alg2.l8" class="ltx_listingline">
<span id="alg2.l8.1" class="ltx_text" style="font-size:70%;">    </span><span id="alg2.l8.2" class="ltx_text ltx_font_bold" style="font-size:70%;">else</span><span id="alg2.l8.3" class="ltx_text" style="font-size:70%;">

</span>
</div>
<div id="alg2.l9" class="ltx_listingline">
<span id="alg2.l9.1" class="ltx_text" style="font-size:70%;">      </span><math id="alg2.l9.m1.1" class="ltx_Math" alttext="T_{t}^{\prime}\leftarrow T_{t}" display="inline"><semantics id="alg2.l9.m1.1a"><mrow id="alg2.l9.m1.1.1" xref="alg2.l9.m1.1.1.cmml"><msubsup id="alg2.l9.m1.1.1.2" xref="alg2.l9.m1.1.1.2.cmml"><mi mathsize="70%" id="alg2.l9.m1.1.1.2.2.2" xref="alg2.l9.m1.1.1.2.2.2.cmml">T</mi><mi mathsize="70%" id="alg2.l9.m1.1.1.2.2.3" xref="alg2.l9.m1.1.1.2.2.3.cmml">t</mi><mo mathsize="70%" id="alg2.l9.m1.1.1.2.3" xref="alg2.l9.m1.1.1.2.3.cmml">′</mo></msubsup><mo mathsize="70%" stretchy="false" id="alg2.l9.m1.1.1.1" xref="alg2.l9.m1.1.1.1.cmml">←</mo><msub id="alg2.l9.m1.1.1.3" xref="alg2.l9.m1.1.1.3.cmml"><mi mathsize="70%" id="alg2.l9.m1.1.1.3.2" xref="alg2.l9.m1.1.1.3.2.cmml">T</mi><mi mathsize="70%" id="alg2.l9.m1.1.1.3.3" xref="alg2.l9.m1.1.1.3.3.cmml">t</mi></msub></mrow><annotation-xml encoding="MathML-Content" id="alg2.l9.m1.1b"><apply id="alg2.l9.m1.1.1.cmml" xref="alg2.l9.m1.1.1"><ci id="alg2.l9.m1.1.1.1.cmml" xref="alg2.l9.m1.1.1.1">←</ci><apply id="alg2.l9.m1.1.1.2.cmml" xref="alg2.l9.m1.1.1.2"><csymbol cd="ambiguous" id="alg2.l9.m1.1.1.2.1.cmml" xref="alg2.l9.m1.1.1.2">superscript</csymbol><apply id="alg2.l9.m1.1.1.2.2.cmml" xref="alg2.l9.m1.1.1.2"><csymbol cd="ambiguous" id="alg2.l9.m1.1.1.2.2.1.cmml" xref="alg2.l9.m1.1.1.2">subscript</csymbol><ci id="alg2.l9.m1.1.1.2.2.2.cmml" xref="alg2.l9.m1.1.1.2.2.2">𝑇</ci><ci id="alg2.l9.m1.1.1.2.2.3.cmml" xref="alg2.l9.m1.1.1.2.2.3">𝑡</ci></apply><ci id="alg2.l9.m1.1.1.2.3.cmml" xref="alg2.l9.m1.1.1.2.3">′</ci></apply><apply id="alg2.l9.m1.1.1.3.cmml" xref="alg2.l9.m1.1.1.3"><csymbol cd="ambiguous" id="alg2.l9.m1.1.1.3.1.cmml" xref="alg2.l9.m1.1.1.3">subscript</csymbol><ci id="alg2.l9.m1.1.1.3.2.cmml" xref="alg2.l9.m1.1.1.3.2">𝑇</ci><ci id="alg2.l9.m1.1.1.3.3.cmml" xref="alg2.l9.m1.1.1.3.3">𝑡</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.l9.m1.1c">T_{t}^{\prime}\leftarrow T_{t}</annotation></semantics></math><span id="alg2.l9.2" class="ltx_text" style="font-size:70%;">
</span>
</div>
<div id="alg2.l10" class="ltx_listingline">
<span id="alg2.l10.1" class="ltx_text" style="font-size:70%;">    </span><span id="alg2.l10.2" class="ltx_text ltx_font_bold" style="font-size:70%;">end</span><span id="alg2.l10.3" class="ltx_text" style="font-size:70%;"> </span><span id="alg2.l10.4" class="ltx_text ltx_font_bold" style="font-size:70%;">if</span>
</div>
<div id="alg2.l11" class="ltx_listingline">
<span id="alg2.l11.1" class="ltx_text" style="font-size:70%;">    </span><span id="alg2.l11.2" class="ltx_text ltx_font_bold" style="font-size:70%;">for</span><span id="alg2.l11.3" class="ltx_text" style="font-size:70%;"> each client </span><math id="alg2.l11.m1.1" class="ltx_Math" alttext="k\in L_{t}" display="inline"><semantics id="alg2.l11.m1.1a"><mrow id="alg2.l11.m1.1.1" xref="alg2.l11.m1.1.1.cmml"><mi mathsize="70%" id="alg2.l11.m1.1.1.2" xref="alg2.l11.m1.1.1.2.cmml">k</mi><mo mathsize="70%" id="alg2.l11.m1.1.1.1" xref="alg2.l11.m1.1.1.1.cmml">∈</mo><msub id="alg2.l11.m1.1.1.3" xref="alg2.l11.m1.1.1.3.cmml"><mi mathsize="70%" id="alg2.l11.m1.1.1.3.2" xref="alg2.l11.m1.1.1.3.2.cmml">L</mi><mi mathsize="70%" id="alg2.l11.m1.1.1.3.3" xref="alg2.l11.m1.1.1.3.3.cmml">t</mi></msub></mrow><annotation-xml encoding="MathML-Content" id="alg2.l11.m1.1b"><apply id="alg2.l11.m1.1.1.cmml" xref="alg2.l11.m1.1.1"><in id="alg2.l11.m1.1.1.1.cmml" xref="alg2.l11.m1.1.1.1"></in><ci id="alg2.l11.m1.1.1.2.cmml" xref="alg2.l11.m1.1.1.2">𝑘</ci><apply id="alg2.l11.m1.1.1.3.cmml" xref="alg2.l11.m1.1.1.3"><csymbol cd="ambiguous" id="alg2.l11.m1.1.1.3.1.cmml" xref="alg2.l11.m1.1.1.3">subscript</csymbol><ci id="alg2.l11.m1.1.1.3.2.cmml" xref="alg2.l11.m1.1.1.3.2">𝐿</ci><ci id="alg2.l11.m1.1.1.3.3.cmml" xref="alg2.l11.m1.1.1.3.3">𝑡</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.l11.m1.1c">k\in L_{t}</annotation></semantics></math><span id="alg2.l11.4" class="ltx_text" style="font-size:70%;"> </span><span id="alg2.l11.5" class="ltx_text ltx_font_bold" style="font-size:70%;">in parallel</span><span id="alg2.l11.6" class="ltx_text" style="font-size:70%;"> </span><span id="alg2.l11.7" class="ltx_text ltx_font_bold" style="font-size:70%;">do</span><span id="alg2.l11.8" class="ltx_text" style="font-size:70%;">


</span>
</div>
<div id="alg2.l12" class="ltx_listingline">
<span id="alg2.l12.1" class="ltx_text" style="font-size:70%;">      </span><math id="alg2.l12.m1.1" class="ltx_Math" alttext="S_{t+1}^{k}" display="inline"><semantics id="alg2.l12.m1.1a"><msubsup id="alg2.l12.m1.1.1" xref="alg2.l12.m1.1.1.cmml"><mi mathsize="70%" id="alg2.l12.m1.1.1.2.2" xref="alg2.l12.m1.1.1.2.2.cmml">S</mi><mrow id="alg2.l12.m1.1.1.2.3" xref="alg2.l12.m1.1.1.2.3.cmml"><mi mathsize="70%" id="alg2.l12.m1.1.1.2.3.2" xref="alg2.l12.m1.1.1.2.3.2.cmml">t</mi><mo mathsize="70%" id="alg2.l12.m1.1.1.2.3.1" xref="alg2.l12.m1.1.1.2.3.1.cmml">+</mo><mn mathsize="70%" id="alg2.l12.m1.1.1.2.3.3" xref="alg2.l12.m1.1.1.2.3.3.cmml">1</mn></mrow><mi mathsize="70%" id="alg2.l12.m1.1.1.3" xref="alg2.l12.m1.1.1.3.cmml">k</mi></msubsup><annotation-xml encoding="MathML-Content" id="alg2.l12.m1.1b"><apply id="alg2.l12.m1.1.1.cmml" xref="alg2.l12.m1.1.1"><csymbol cd="ambiguous" id="alg2.l12.m1.1.1.1.cmml" xref="alg2.l12.m1.1.1">superscript</csymbol><apply id="alg2.l12.m1.1.1.2.cmml" xref="alg2.l12.m1.1.1"><csymbol cd="ambiguous" id="alg2.l12.m1.1.1.2.1.cmml" xref="alg2.l12.m1.1.1">subscript</csymbol><ci id="alg2.l12.m1.1.1.2.2.cmml" xref="alg2.l12.m1.1.1.2.2">𝑆</ci><apply id="alg2.l12.m1.1.1.2.3.cmml" xref="alg2.l12.m1.1.1.2.3"><plus id="alg2.l12.m1.1.1.2.3.1.cmml" xref="alg2.l12.m1.1.1.2.3.1"></plus><ci id="alg2.l12.m1.1.1.2.3.2.cmml" xref="alg2.l12.m1.1.1.2.3.2">𝑡</ci><cn type="integer" id="alg2.l12.m1.1.1.2.3.3.cmml" xref="alg2.l12.m1.1.1.2.3.3">1</cn></apply></apply><ci id="alg2.l12.m1.1.1.3.cmml" xref="alg2.l12.m1.1.1.3">𝑘</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.l12.m1.1c">S_{t+1}^{k}</annotation></semantics></math><span id="alg2.l12.2" class="ltx_text" style="font-size:70%;">, </span><math id="alg2.l12.m2.1" class="ltx_Math" alttext="(D_{\text{KL}}^{T})^{k}" display="inline"><semantics id="alg2.l12.m2.1a"><msup id="alg2.l12.m2.1.1" xref="alg2.l12.m2.1.1.cmml"><mrow id="alg2.l12.m2.1.1.1.1" xref="alg2.l12.m2.1.1.1.1.1.cmml"><mo maxsize="70%" minsize="70%" id="alg2.l12.m2.1.1.1.1.2" xref="alg2.l12.m2.1.1.1.1.1.cmml">(</mo><msubsup id="alg2.l12.m2.1.1.1.1.1" xref="alg2.l12.m2.1.1.1.1.1.cmml"><mi mathsize="70%" id="alg2.l12.m2.1.1.1.1.1.2.2" xref="alg2.l12.m2.1.1.1.1.1.2.2.cmml">D</mi><mtext mathsize="70%" id="alg2.l12.m2.1.1.1.1.1.2.3" xref="alg2.l12.m2.1.1.1.1.1.2.3a.cmml">KL</mtext><mi mathsize="70%" id="alg2.l12.m2.1.1.1.1.1.3" xref="alg2.l12.m2.1.1.1.1.1.3.cmml">T</mi></msubsup><mo maxsize="70%" minsize="70%" id="alg2.l12.m2.1.1.1.1.3" xref="alg2.l12.m2.1.1.1.1.1.cmml">)</mo></mrow><mi mathsize="70%" id="alg2.l12.m2.1.1.3" xref="alg2.l12.m2.1.1.3.cmml">k</mi></msup><annotation-xml encoding="MathML-Content" id="alg2.l12.m2.1b"><apply id="alg2.l12.m2.1.1.cmml" xref="alg2.l12.m2.1.1"><csymbol cd="ambiguous" id="alg2.l12.m2.1.1.2.cmml" xref="alg2.l12.m2.1.1">superscript</csymbol><apply id="alg2.l12.m2.1.1.1.1.1.cmml" xref="alg2.l12.m2.1.1.1.1"><csymbol cd="ambiguous" id="alg2.l12.m2.1.1.1.1.1.1.cmml" xref="alg2.l12.m2.1.1.1.1">superscript</csymbol><apply id="alg2.l12.m2.1.1.1.1.1.2.cmml" xref="alg2.l12.m2.1.1.1.1"><csymbol cd="ambiguous" id="alg2.l12.m2.1.1.1.1.1.2.1.cmml" xref="alg2.l12.m2.1.1.1.1">subscript</csymbol><ci id="alg2.l12.m2.1.1.1.1.1.2.2.cmml" xref="alg2.l12.m2.1.1.1.1.1.2.2">𝐷</ci><ci id="alg2.l12.m2.1.1.1.1.1.2.3a.cmml" xref="alg2.l12.m2.1.1.1.1.1.2.3"><mtext mathsize="49%" id="alg2.l12.m2.1.1.1.1.1.2.3.cmml" xref="alg2.l12.m2.1.1.1.1.1.2.3">KL</mtext></ci></apply><ci id="alg2.l12.m2.1.1.1.1.1.3.cmml" xref="alg2.l12.m2.1.1.1.1.1.3">𝑇</ci></apply><ci id="alg2.l12.m2.1.1.3.cmml" xref="alg2.l12.m2.1.1.3">𝑘</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.l12.m2.1c">(D_{\text{KL}}^{T})^{k}</annotation></semantics></math><span id="alg2.l12.3" class="ltx_text" style="font-size:70%;">, </span><math id="alg2.l12.m3.1" class="ltx_Math" alttext="(D_{\text{KL}}^{S})^{k}\leftarrow\textbf{ClientUpdate}" display="inline"><semantics id="alg2.l12.m3.1a"><mrow id="alg2.l12.m3.1.1" xref="alg2.l12.m3.1.1.cmml"><msup id="alg2.l12.m3.1.1.1" xref="alg2.l12.m3.1.1.1.cmml"><mrow id="alg2.l12.m3.1.1.1.1.1" xref="alg2.l12.m3.1.1.1.1.1.1.cmml"><mo maxsize="70%" minsize="70%" id="alg2.l12.m3.1.1.1.1.1.2" xref="alg2.l12.m3.1.1.1.1.1.1.cmml">(</mo><msubsup id="alg2.l12.m3.1.1.1.1.1.1" xref="alg2.l12.m3.1.1.1.1.1.1.cmml"><mi mathsize="70%" id="alg2.l12.m3.1.1.1.1.1.1.2.2" xref="alg2.l12.m3.1.1.1.1.1.1.2.2.cmml">D</mi><mtext mathsize="70%" id="alg2.l12.m3.1.1.1.1.1.1.2.3" xref="alg2.l12.m3.1.1.1.1.1.1.2.3a.cmml">KL</mtext><mi mathsize="70%" id="alg2.l12.m3.1.1.1.1.1.1.3" xref="alg2.l12.m3.1.1.1.1.1.1.3.cmml">S</mi></msubsup><mo maxsize="70%" minsize="70%" id="alg2.l12.m3.1.1.1.1.1.3" xref="alg2.l12.m3.1.1.1.1.1.1.cmml">)</mo></mrow><mi mathsize="70%" id="alg2.l12.m3.1.1.1.3" xref="alg2.l12.m3.1.1.1.3.cmml">k</mi></msup><mo mathsize="70%" stretchy="false" id="alg2.l12.m3.1.1.2" xref="alg2.l12.m3.1.1.2.cmml">←</mo><mtext class="ltx_mathvariant_bold" mathsize="70%" id="alg2.l12.m3.1.1.3" xref="alg2.l12.m3.1.1.3a.cmml">ClientUpdate</mtext></mrow><annotation-xml encoding="MathML-Content" id="alg2.l12.m3.1b"><apply id="alg2.l12.m3.1.1.cmml" xref="alg2.l12.m3.1.1"><ci id="alg2.l12.m3.1.1.2.cmml" xref="alg2.l12.m3.1.1.2">←</ci><apply id="alg2.l12.m3.1.1.1.cmml" xref="alg2.l12.m3.1.1.1"><csymbol cd="ambiguous" id="alg2.l12.m3.1.1.1.2.cmml" xref="alg2.l12.m3.1.1.1">superscript</csymbol><apply id="alg2.l12.m3.1.1.1.1.1.1.cmml" xref="alg2.l12.m3.1.1.1.1.1"><csymbol cd="ambiguous" id="alg2.l12.m3.1.1.1.1.1.1.1.cmml" xref="alg2.l12.m3.1.1.1.1.1">superscript</csymbol><apply id="alg2.l12.m3.1.1.1.1.1.1.2.cmml" xref="alg2.l12.m3.1.1.1.1.1"><csymbol cd="ambiguous" id="alg2.l12.m3.1.1.1.1.1.1.2.1.cmml" xref="alg2.l12.m3.1.1.1.1.1">subscript</csymbol><ci id="alg2.l12.m3.1.1.1.1.1.1.2.2.cmml" xref="alg2.l12.m3.1.1.1.1.1.1.2.2">𝐷</ci><ci id="alg2.l12.m3.1.1.1.1.1.1.2.3a.cmml" xref="alg2.l12.m3.1.1.1.1.1.1.2.3"><mtext mathsize="49%" id="alg2.l12.m3.1.1.1.1.1.1.2.3.cmml" xref="alg2.l12.m3.1.1.1.1.1.1.2.3">KL</mtext></ci></apply><ci id="alg2.l12.m3.1.1.1.1.1.1.3.cmml" xref="alg2.l12.m3.1.1.1.1.1.1.3">𝑆</ci></apply><ci id="alg2.l12.m3.1.1.1.3.cmml" xref="alg2.l12.m3.1.1.1.3">𝑘</ci></apply><ci id="alg2.l12.m3.1.1.3a.cmml" xref="alg2.l12.m3.1.1.3"><mtext class="ltx_mathvariant_bold" mathsize="70%" id="alg2.l12.m3.1.1.3.cmml" xref="alg2.l12.m3.1.1.3">ClientUpdate</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.l12.m3.1c">(D_{\text{KL}}^{S})^{k}\leftarrow\textbf{ClientUpdate}</annotation></semantics></math><span id="alg2.l12.4" class="ltx_text" style="font-size:70%;">
</span><math id="alg2.l12.m4.3" class="ltx_Math" alttext="(k,S_{t},T_{t})" display="inline"><semantics id="alg2.l12.m4.3a"><mrow id="alg2.l12.m4.3.3.2" xref="alg2.l12.m4.3.3.3.cmml"><mo maxsize="70%" minsize="70%" id="alg2.l12.m4.3.3.2.3" xref="alg2.l12.m4.3.3.3.cmml">(</mo><mi mathsize="70%" id="alg2.l12.m4.1.1" xref="alg2.l12.m4.1.1.cmml">k</mi><mo mathsize="70%" id="alg2.l12.m4.3.3.2.4" xref="alg2.l12.m4.3.3.3.cmml">,</mo><msub id="alg2.l12.m4.2.2.1.1" xref="alg2.l12.m4.2.2.1.1.cmml"><mi mathsize="70%" id="alg2.l12.m4.2.2.1.1.2" xref="alg2.l12.m4.2.2.1.1.2.cmml">S</mi><mi mathsize="70%" id="alg2.l12.m4.2.2.1.1.3" xref="alg2.l12.m4.2.2.1.1.3.cmml">t</mi></msub><mo mathsize="70%" id="alg2.l12.m4.3.3.2.5" xref="alg2.l12.m4.3.3.3.cmml">,</mo><msub id="alg2.l12.m4.3.3.2.2" xref="alg2.l12.m4.3.3.2.2.cmml"><mi mathsize="70%" id="alg2.l12.m4.3.3.2.2.2" xref="alg2.l12.m4.3.3.2.2.2.cmml">T</mi><mi mathsize="70%" id="alg2.l12.m4.3.3.2.2.3" xref="alg2.l12.m4.3.3.2.2.3.cmml">t</mi></msub><mo maxsize="70%" minsize="70%" id="alg2.l12.m4.3.3.2.6" xref="alg2.l12.m4.3.3.3.cmml">)</mo></mrow><annotation-xml encoding="MathML-Content" id="alg2.l12.m4.3b"><vector id="alg2.l12.m4.3.3.3.cmml" xref="alg2.l12.m4.3.3.2"><ci id="alg2.l12.m4.1.1.cmml" xref="alg2.l12.m4.1.1">𝑘</ci><apply id="alg2.l12.m4.2.2.1.1.cmml" xref="alg2.l12.m4.2.2.1.1"><csymbol cd="ambiguous" id="alg2.l12.m4.2.2.1.1.1.cmml" xref="alg2.l12.m4.2.2.1.1">subscript</csymbol><ci id="alg2.l12.m4.2.2.1.1.2.cmml" xref="alg2.l12.m4.2.2.1.1.2">𝑆</ci><ci id="alg2.l12.m4.2.2.1.1.3.cmml" xref="alg2.l12.m4.2.2.1.1.3">𝑡</ci></apply><apply id="alg2.l12.m4.3.3.2.2.cmml" xref="alg2.l12.m4.3.3.2.2"><csymbol cd="ambiguous" id="alg2.l12.m4.3.3.2.2.1.cmml" xref="alg2.l12.m4.3.3.2.2">subscript</csymbol><ci id="alg2.l12.m4.3.3.2.2.2.cmml" xref="alg2.l12.m4.3.3.2.2.2">𝑇</ci><ci id="alg2.l12.m4.3.3.2.2.3.cmml" xref="alg2.l12.m4.3.3.2.2.3">𝑡</ci></apply></vector></annotation-xml><annotation encoding="application/x-tex" id="alg2.l12.m4.3c">(k,S_{t},T_{t})</annotation></semantics></math><span id="alg2.l12.5" class="ltx_text" style="font-size:70%;">
</span>
</div>
<div id="alg2.l13" class="ltx_listingline">
<span id="alg2.l13.1" class="ltx_text" style="font-size:70%;">    </span><span id="alg2.l13.2" class="ltx_text ltx_font_bold" style="font-size:70%;">end</span><span id="alg2.l13.3" class="ltx_text" style="font-size:70%;"> </span><span id="alg2.l13.4" class="ltx_text ltx_font_bold" style="font-size:70%;">for</span><span id="alg2.l13.5" class="ltx_text" style="font-size:70%;">
 

</span>
</div>
<div id="alg2.l14" class="ltx_listingline">
<span id="alg2.l14.1" class="ltx_text" style="font-size:70%;">    </span><math id="alg2.l14.m1.1" class="ltx_Math" alttext="S_{t+1}\leftarrow" display="inline"><semantics id="alg2.l14.m1.1a"><mrow id="alg2.l14.m1.1.1" xref="alg2.l14.m1.1.1.cmml"><msub id="alg2.l14.m1.1.1.2" xref="alg2.l14.m1.1.1.2.cmml"><mi mathsize="70%" id="alg2.l14.m1.1.1.2.2" xref="alg2.l14.m1.1.1.2.2.cmml">S</mi><mrow id="alg2.l14.m1.1.1.2.3" xref="alg2.l14.m1.1.1.2.3.cmml"><mi mathsize="70%" id="alg2.l14.m1.1.1.2.3.2" xref="alg2.l14.m1.1.1.2.3.2.cmml">t</mi><mo mathsize="70%" id="alg2.l14.m1.1.1.2.3.1" xref="alg2.l14.m1.1.1.2.3.1.cmml">+</mo><mn mathsize="70%" id="alg2.l14.m1.1.1.2.3.3" xref="alg2.l14.m1.1.1.2.3.3.cmml">1</mn></mrow></msub><mo mathsize="70%" stretchy="false" id="alg2.l14.m1.1.1.1" xref="alg2.l14.m1.1.1.1.cmml">←</mo><mi id="alg2.l14.m1.1.1.3" xref="alg2.l14.m1.1.1.3.cmml"></mi></mrow><annotation-xml encoding="MathML-Content" id="alg2.l14.m1.1b"><apply id="alg2.l14.m1.1.1.cmml" xref="alg2.l14.m1.1.1"><ci id="alg2.l14.m1.1.1.1.cmml" xref="alg2.l14.m1.1.1.1">←</ci><apply id="alg2.l14.m1.1.1.2.cmml" xref="alg2.l14.m1.1.1.2"><csymbol cd="ambiguous" id="alg2.l14.m1.1.1.2.1.cmml" xref="alg2.l14.m1.1.1.2">subscript</csymbol><ci id="alg2.l14.m1.1.1.2.2.cmml" xref="alg2.l14.m1.1.1.2.2">𝑆</ci><apply id="alg2.l14.m1.1.1.2.3.cmml" xref="alg2.l14.m1.1.1.2.3"><plus id="alg2.l14.m1.1.1.2.3.1.cmml" xref="alg2.l14.m1.1.1.2.3.1"></plus><ci id="alg2.l14.m1.1.1.2.3.2.cmml" xref="alg2.l14.m1.1.1.2.3.2">𝑡</ci><cn type="integer" id="alg2.l14.m1.1.1.2.3.3.cmml" xref="alg2.l14.m1.1.1.2.3.3">1</cn></apply></apply><csymbol cd="latexml" id="alg2.l14.m1.1.1.3.cmml" xref="alg2.l14.m1.1.1.3">absent</csymbol></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.l14.m1.1c">S_{t+1}\leftarrow</annotation></semantics></math><span id="alg2.l14.2" class="ltx_text" style="font-size:70%;">

</span><math id="alg2.l14.m2.1" class="ltx_Math" alttext="\frac{1}{m}\sum_{k\in L_{t}}S_{t+1}^{k}" display="inline"><semantics id="alg2.l14.m2.1a"><mrow id="alg2.l14.m2.1.1" xref="alg2.l14.m2.1.1.cmml"><mfrac id="alg2.l14.m2.1.1.2" xref="alg2.l14.m2.1.1.2.cmml"><mn mathsize="70%" id="alg2.l14.m2.1.1.2.2" xref="alg2.l14.m2.1.1.2.2.cmml">1</mn><mi mathsize="70%" id="alg2.l14.m2.1.1.2.3" xref="alg2.l14.m2.1.1.2.3.cmml">m</mi></mfrac><mo lspace="0em" rspace="0em" id="alg2.l14.m2.1.1.1" xref="alg2.l14.m2.1.1.1.cmml">​</mo><mrow id="alg2.l14.m2.1.1.3" xref="alg2.l14.m2.1.1.3.cmml"><msub id="alg2.l14.m2.1.1.3.1" xref="alg2.l14.m2.1.1.3.1.cmml"><mo maxsize="70%" minsize="70%" stretchy="true" id="alg2.l14.m2.1.1.3.1.2" xref="alg2.l14.m2.1.1.3.1.2.cmml">∑</mo><mrow id="alg2.l14.m2.1.1.3.1.3" xref="alg2.l14.m2.1.1.3.1.3.cmml"><mi mathsize="70%" id="alg2.l14.m2.1.1.3.1.3.2" xref="alg2.l14.m2.1.1.3.1.3.2.cmml">k</mi><mo mathsize="70%" id="alg2.l14.m2.1.1.3.1.3.1" xref="alg2.l14.m2.1.1.3.1.3.1.cmml">∈</mo><msub id="alg2.l14.m2.1.1.3.1.3.3" xref="alg2.l14.m2.1.1.3.1.3.3.cmml"><mi mathsize="70%" id="alg2.l14.m2.1.1.3.1.3.3.2" xref="alg2.l14.m2.1.1.3.1.3.3.2.cmml">L</mi><mi mathsize="70%" id="alg2.l14.m2.1.1.3.1.3.3.3" xref="alg2.l14.m2.1.1.3.1.3.3.3.cmml">t</mi></msub></mrow></msub><msubsup id="alg2.l14.m2.1.1.3.2" xref="alg2.l14.m2.1.1.3.2.cmml"><mi mathsize="70%" id="alg2.l14.m2.1.1.3.2.2.2" xref="alg2.l14.m2.1.1.3.2.2.2.cmml">S</mi><mrow id="alg2.l14.m2.1.1.3.2.2.3" xref="alg2.l14.m2.1.1.3.2.2.3.cmml"><mi mathsize="70%" id="alg2.l14.m2.1.1.3.2.2.3.2" xref="alg2.l14.m2.1.1.3.2.2.3.2.cmml">t</mi><mo mathsize="70%" id="alg2.l14.m2.1.1.3.2.2.3.1" xref="alg2.l14.m2.1.1.3.2.2.3.1.cmml">+</mo><mn mathsize="70%" id="alg2.l14.m2.1.1.3.2.2.3.3" xref="alg2.l14.m2.1.1.3.2.2.3.3.cmml">1</mn></mrow><mi mathsize="70%" id="alg2.l14.m2.1.1.3.2.3" xref="alg2.l14.m2.1.1.3.2.3.cmml">k</mi></msubsup></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg2.l14.m2.1b"><apply id="alg2.l14.m2.1.1.cmml" xref="alg2.l14.m2.1.1"><times id="alg2.l14.m2.1.1.1.cmml" xref="alg2.l14.m2.1.1.1"></times><apply id="alg2.l14.m2.1.1.2.cmml" xref="alg2.l14.m2.1.1.2"><divide id="alg2.l14.m2.1.1.2.1.cmml" xref="alg2.l14.m2.1.1.2"></divide><cn type="integer" id="alg2.l14.m2.1.1.2.2.cmml" xref="alg2.l14.m2.1.1.2.2">1</cn><ci id="alg2.l14.m2.1.1.2.3.cmml" xref="alg2.l14.m2.1.1.2.3">𝑚</ci></apply><apply id="alg2.l14.m2.1.1.3.cmml" xref="alg2.l14.m2.1.1.3"><apply id="alg2.l14.m2.1.1.3.1.cmml" xref="alg2.l14.m2.1.1.3.1"><csymbol cd="ambiguous" id="alg2.l14.m2.1.1.3.1.1.cmml" xref="alg2.l14.m2.1.1.3.1">subscript</csymbol><sum id="alg2.l14.m2.1.1.3.1.2.cmml" xref="alg2.l14.m2.1.1.3.1.2"></sum><apply id="alg2.l14.m2.1.1.3.1.3.cmml" xref="alg2.l14.m2.1.1.3.1.3"><in id="alg2.l14.m2.1.1.3.1.3.1.cmml" xref="alg2.l14.m2.1.1.3.1.3.1"></in><ci id="alg2.l14.m2.1.1.3.1.3.2.cmml" xref="alg2.l14.m2.1.1.3.1.3.2">𝑘</ci><apply id="alg2.l14.m2.1.1.3.1.3.3.cmml" xref="alg2.l14.m2.1.1.3.1.3.3"><csymbol cd="ambiguous" id="alg2.l14.m2.1.1.3.1.3.3.1.cmml" xref="alg2.l14.m2.1.1.3.1.3.3">subscript</csymbol><ci id="alg2.l14.m2.1.1.3.1.3.3.2.cmml" xref="alg2.l14.m2.1.1.3.1.3.3.2">𝐿</ci><ci id="alg2.l14.m2.1.1.3.1.3.3.3.cmml" xref="alg2.l14.m2.1.1.3.1.3.3.3">𝑡</ci></apply></apply></apply><apply id="alg2.l14.m2.1.1.3.2.cmml" xref="alg2.l14.m2.1.1.3.2"><csymbol cd="ambiguous" id="alg2.l14.m2.1.1.3.2.1.cmml" xref="alg2.l14.m2.1.1.3.2">superscript</csymbol><apply id="alg2.l14.m2.1.1.3.2.2.cmml" xref="alg2.l14.m2.1.1.3.2"><csymbol cd="ambiguous" id="alg2.l14.m2.1.1.3.2.2.1.cmml" xref="alg2.l14.m2.1.1.3.2">subscript</csymbol><ci id="alg2.l14.m2.1.1.3.2.2.2.cmml" xref="alg2.l14.m2.1.1.3.2.2.2">𝑆</ci><apply id="alg2.l14.m2.1.1.3.2.2.3.cmml" xref="alg2.l14.m2.1.1.3.2.2.3"><plus id="alg2.l14.m2.1.1.3.2.2.3.1.cmml" xref="alg2.l14.m2.1.1.3.2.2.3.1"></plus><ci id="alg2.l14.m2.1.1.3.2.2.3.2.cmml" xref="alg2.l14.m2.1.1.3.2.2.3.2">𝑡</ci><cn type="integer" id="alg2.l14.m2.1.1.3.2.2.3.3.cmml" xref="alg2.l14.m2.1.1.3.2.2.3.3">1</cn></apply></apply><ci id="alg2.l14.m2.1.1.3.2.3.cmml" xref="alg2.l14.m2.1.1.3.2.3">𝑘</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.l14.m2.1c">\frac{1}{m}\sum_{k\in L_{t}}S_{t+1}^{k}</annotation></semantics></math><span id="alg2.l14.3" class="ltx_text" style="font-size:70%;"> 

 

</span>
</div>
<div id="alg2.l15" class="ltx_listingline">
<span id="alg2.l15.1" class="ltx_text" style="font-size:70%;">    </span><math id="alg2.l15.m1.1" class="ltx_Math" alttext="S_{t+1}\leftarrow\textbf{ServerUpdate}(S_{t+1})" display="inline"><semantics id="alg2.l15.m1.1a"><mrow id="alg2.l15.m1.1.1" xref="alg2.l15.m1.1.1.cmml"><msub id="alg2.l15.m1.1.1.3" xref="alg2.l15.m1.1.1.3.cmml"><mi mathsize="70%" id="alg2.l15.m1.1.1.3.2" xref="alg2.l15.m1.1.1.3.2.cmml">S</mi><mrow id="alg2.l15.m1.1.1.3.3" xref="alg2.l15.m1.1.1.3.3.cmml"><mi mathsize="70%" id="alg2.l15.m1.1.1.3.3.2" xref="alg2.l15.m1.1.1.3.3.2.cmml">t</mi><mo mathsize="70%" id="alg2.l15.m1.1.1.3.3.1" xref="alg2.l15.m1.1.1.3.3.1.cmml">+</mo><mn mathsize="70%" id="alg2.l15.m1.1.1.3.3.3" xref="alg2.l15.m1.1.1.3.3.3.cmml">1</mn></mrow></msub><mo mathsize="70%" stretchy="false" id="alg2.l15.m1.1.1.2" xref="alg2.l15.m1.1.1.2.cmml">←</mo><mrow id="alg2.l15.m1.1.1.1" xref="alg2.l15.m1.1.1.1.cmml"><mtext class="ltx_mathvariant_bold" mathsize="70%" id="alg2.l15.m1.1.1.1.3" xref="alg2.l15.m1.1.1.1.3a.cmml">ServerUpdate</mtext><mo lspace="0em" rspace="0em" id="alg2.l15.m1.1.1.1.2" xref="alg2.l15.m1.1.1.1.2.cmml">​</mo><mrow id="alg2.l15.m1.1.1.1.1.1" xref="alg2.l15.m1.1.1.1.1.1.1.cmml"><mo maxsize="70%" minsize="70%" id="alg2.l15.m1.1.1.1.1.1.2" xref="alg2.l15.m1.1.1.1.1.1.1.cmml">(</mo><msub id="alg2.l15.m1.1.1.1.1.1.1" xref="alg2.l15.m1.1.1.1.1.1.1.cmml"><mi mathsize="70%" id="alg2.l15.m1.1.1.1.1.1.1.2" xref="alg2.l15.m1.1.1.1.1.1.1.2.cmml">S</mi><mrow id="alg2.l15.m1.1.1.1.1.1.1.3" xref="alg2.l15.m1.1.1.1.1.1.1.3.cmml"><mi mathsize="70%" id="alg2.l15.m1.1.1.1.1.1.1.3.2" xref="alg2.l15.m1.1.1.1.1.1.1.3.2.cmml">t</mi><mo mathsize="70%" id="alg2.l15.m1.1.1.1.1.1.1.3.1" xref="alg2.l15.m1.1.1.1.1.1.1.3.1.cmml">+</mo><mn mathsize="70%" id="alg2.l15.m1.1.1.1.1.1.1.3.3" xref="alg2.l15.m1.1.1.1.1.1.1.3.3.cmml">1</mn></mrow></msub><mo maxsize="70%" minsize="70%" id="alg2.l15.m1.1.1.1.1.1.3" xref="alg2.l15.m1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg2.l15.m1.1b"><apply id="alg2.l15.m1.1.1.cmml" xref="alg2.l15.m1.1.1"><ci id="alg2.l15.m1.1.1.2.cmml" xref="alg2.l15.m1.1.1.2">←</ci><apply id="alg2.l15.m1.1.1.3.cmml" xref="alg2.l15.m1.1.1.3"><csymbol cd="ambiguous" id="alg2.l15.m1.1.1.3.1.cmml" xref="alg2.l15.m1.1.1.3">subscript</csymbol><ci id="alg2.l15.m1.1.1.3.2.cmml" xref="alg2.l15.m1.1.1.3.2">𝑆</ci><apply id="alg2.l15.m1.1.1.3.3.cmml" xref="alg2.l15.m1.1.1.3.3"><plus id="alg2.l15.m1.1.1.3.3.1.cmml" xref="alg2.l15.m1.1.1.3.3.1"></plus><ci id="alg2.l15.m1.1.1.3.3.2.cmml" xref="alg2.l15.m1.1.1.3.3.2">𝑡</ci><cn type="integer" id="alg2.l15.m1.1.1.3.3.3.cmml" xref="alg2.l15.m1.1.1.3.3.3">1</cn></apply></apply><apply id="alg2.l15.m1.1.1.1.cmml" xref="alg2.l15.m1.1.1.1"><times id="alg2.l15.m1.1.1.1.2.cmml" xref="alg2.l15.m1.1.1.1.2"></times><ci id="alg2.l15.m1.1.1.1.3a.cmml" xref="alg2.l15.m1.1.1.1.3"><mtext class="ltx_mathvariant_bold" mathsize="70%" id="alg2.l15.m1.1.1.1.3.cmml" xref="alg2.l15.m1.1.1.1.3">ServerUpdate</mtext></ci><apply id="alg2.l15.m1.1.1.1.1.1.1.cmml" xref="alg2.l15.m1.1.1.1.1.1"><csymbol cd="ambiguous" id="alg2.l15.m1.1.1.1.1.1.1.1.cmml" xref="alg2.l15.m1.1.1.1.1.1">subscript</csymbol><ci id="alg2.l15.m1.1.1.1.1.1.1.2.cmml" xref="alg2.l15.m1.1.1.1.1.1.1.2">𝑆</ci><apply id="alg2.l15.m1.1.1.1.1.1.1.3.cmml" xref="alg2.l15.m1.1.1.1.1.1.1.3"><plus id="alg2.l15.m1.1.1.1.1.1.1.3.1.cmml" xref="alg2.l15.m1.1.1.1.1.1.1.3.1"></plus><ci id="alg2.l15.m1.1.1.1.1.1.1.3.2.cmml" xref="alg2.l15.m1.1.1.1.1.1.1.3.2">𝑡</ci><cn type="integer" id="alg2.l15.m1.1.1.1.1.1.1.3.3.cmml" xref="alg2.l15.m1.1.1.1.1.1.1.3.3">1</cn></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.l15.m1.1c">S_{t+1}\leftarrow\textbf{ServerUpdate}(S_{t+1})</annotation></semantics></math><span id="alg2.l15.2" class="ltx_text" style="font-size:70%;"> 

</span>
</div>
<div id="alg2.l16" class="ltx_listingline">
<span id="alg2.l16.1" class="ltx_text" style="font-size:70%;">    </span><math id="alg2.l16.m1.1" class="ltx_Math" alttext="T_{t+1}\leftarrow\alpha T_{t}+(1-\alpha)S_{t+1}" display="inline"><semantics id="alg2.l16.m1.1a"><mrow id="alg2.l16.m1.1.1" xref="alg2.l16.m1.1.1.cmml"><msub id="alg2.l16.m1.1.1.3" xref="alg2.l16.m1.1.1.3.cmml"><mi mathsize="70%" id="alg2.l16.m1.1.1.3.2" xref="alg2.l16.m1.1.1.3.2.cmml">T</mi><mrow id="alg2.l16.m1.1.1.3.3" xref="alg2.l16.m1.1.1.3.3.cmml"><mi mathsize="70%" id="alg2.l16.m1.1.1.3.3.2" xref="alg2.l16.m1.1.1.3.3.2.cmml">t</mi><mo mathsize="70%" id="alg2.l16.m1.1.1.3.3.1" xref="alg2.l16.m1.1.1.3.3.1.cmml">+</mo><mn mathsize="70%" id="alg2.l16.m1.1.1.3.3.3" xref="alg2.l16.m1.1.1.3.3.3.cmml">1</mn></mrow></msub><mo mathsize="70%" stretchy="false" id="alg2.l16.m1.1.1.2" xref="alg2.l16.m1.1.1.2.cmml">←</mo><mrow id="alg2.l16.m1.1.1.1" xref="alg2.l16.m1.1.1.1.cmml"><mrow id="alg2.l16.m1.1.1.1.3" xref="alg2.l16.m1.1.1.1.3.cmml"><mi mathsize="70%" id="alg2.l16.m1.1.1.1.3.2" xref="alg2.l16.m1.1.1.1.3.2.cmml">α</mi><mo lspace="0em" rspace="0em" id="alg2.l16.m1.1.1.1.3.1" xref="alg2.l16.m1.1.1.1.3.1.cmml">​</mo><msub id="alg2.l16.m1.1.1.1.3.3" xref="alg2.l16.m1.1.1.1.3.3.cmml"><mi mathsize="70%" id="alg2.l16.m1.1.1.1.3.3.2" xref="alg2.l16.m1.1.1.1.3.3.2.cmml">T</mi><mi mathsize="70%" id="alg2.l16.m1.1.1.1.3.3.3" xref="alg2.l16.m1.1.1.1.3.3.3.cmml">t</mi></msub></mrow><mo mathsize="70%" id="alg2.l16.m1.1.1.1.2" xref="alg2.l16.m1.1.1.1.2.cmml">+</mo><mrow id="alg2.l16.m1.1.1.1.1" xref="alg2.l16.m1.1.1.1.1.cmml"><mrow id="alg2.l16.m1.1.1.1.1.1.1" xref="alg2.l16.m1.1.1.1.1.1.1.1.cmml"><mo maxsize="70%" minsize="70%" id="alg2.l16.m1.1.1.1.1.1.1.2" xref="alg2.l16.m1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="alg2.l16.m1.1.1.1.1.1.1.1" xref="alg2.l16.m1.1.1.1.1.1.1.1.cmml"><mn mathsize="70%" id="alg2.l16.m1.1.1.1.1.1.1.1.2" xref="alg2.l16.m1.1.1.1.1.1.1.1.2.cmml">1</mn><mo mathsize="70%" id="alg2.l16.m1.1.1.1.1.1.1.1.1" xref="alg2.l16.m1.1.1.1.1.1.1.1.1.cmml">−</mo><mi mathsize="70%" id="alg2.l16.m1.1.1.1.1.1.1.1.3" xref="alg2.l16.m1.1.1.1.1.1.1.1.3.cmml">α</mi></mrow><mo maxsize="70%" minsize="70%" id="alg2.l16.m1.1.1.1.1.1.1.3" xref="alg2.l16.m1.1.1.1.1.1.1.1.cmml">)</mo></mrow><mo lspace="0em" rspace="0em" id="alg2.l16.m1.1.1.1.1.2" xref="alg2.l16.m1.1.1.1.1.2.cmml">​</mo><msub id="alg2.l16.m1.1.1.1.1.3" xref="alg2.l16.m1.1.1.1.1.3.cmml"><mi mathsize="70%" id="alg2.l16.m1.1.1.1.1.3.2" xref="alg2.l16.m1.1.1.1.1.3.2.cmml">S</mi><mrow id="alg2.l16.m1.1.1.1.1.3.3" xref="alg2.l16.m1.1.1.1.1.3.3.cmml"><mi mathsize="70%" id="alg2.l16.m1.1.1.1.1.3.3.2" xref="alg2.l16.m1.1.1.1.1.3.3.2.cmml">t</mi><mo mathsize="70%" id="alg2.l16.m1.1.1.1.1.3.3.1" xref="alg2.l16.m1.1.1.1.1.3.3.1.cmml">+</mo><mn mathsize="70%" id="alg2.l16.m1.1.1.1.1.3.3.3" xref="alg2.l16.m1.1.1.1.1.3.3.3.cmml">1</mn></mrow></msub></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg2.l16.m1.1b"><apply id="alg2.l16.m1.1.1.cmml" xref="alg2.l16.m1.1.1"><ci id="alg2.l16.m1.1.1.2.cmml" xref="alg2.l16.m1.1.1.2">←</ci><apply id="alg2.l16.m1.1.1.3.cmml" xref="alg2.l16.m1.1.1.3"><csymbol cd="ambiguous" id="alg2.l16.m1.1.1.3.1.cmml" xref="alg2.l16.m1.1.1.3">subscript</csymbol><ci id="alg2.l16.m1.1.1.3.2.cmml" xref="alg2.l16.m1.1.1.3.2">𝑇</ci><apply id="alg2.l16.m1.1.1.3.3.cmml" xref="alg2.l16.m1.1.1.3.3"><plus id="alg2.l16.m1.1.1.3.3.1.cmml" xref="alg2.l16.m1.1.1.3.3.1"></plus><ci id="alg2.l16.m1.1.1.3.3.2.cmml" xref="alg2.l16.m1.1.1.3.3.2">𝑡</ci><cn type="integer" id="alg2.l16.m1.1.1.3.3.3.cmml" xref="alg2.l16.m1.1.1.3.3.3">1</cn></apply></apply><apply id="alg2.l16.m1.1.1.1.cmml" xref="alg2.l16.m1.1.1.1"><plus id="alg2.l16.m1.1.1.1.2.cmml" xref="alg2.l16.m1.1.1.1.2"></plus><apply id="alg2.l16.m1.1.1.1.3.cmml" xref="alg2.l16.m1.1.1.1.3"><times id="alg2.l16.m1.1.1.1.3.1.cmml" xref="alg2.l16.m1.1.1.1.3.1"></times><ci id="alg2.l16.m1.1.1.1.3.2.cmml" xref="alg2.l16.m1.1.1.1.3.2">𝛼</ci><apply id="alg2.l16.m1.1.1.1.3.3.cmml" xref="alg2.l16.m1.1.1.1.3.3"><csymbol cd="ambiguous" id="alg2.l16.m1.1.1.1.3.3.1.cmml" xref="alg2.l16.m1.1.1.1.3.3">subscript</csymbol><ci id="alg2.l16.m1.1.1.1.3.3.2.cmml" xref="alg2.l16.m1.1.1.1.3.3.2">𝑇</ci><ci id="alg2.l16.m1.1.1.1.3.3.3.cmml" xref="alg2.l16.m1.1.1.1.3.3.3">𝑡</ci></apply></apply><apply id="alg2.l16.m1.1.1.1.1.cmml" xref="alg2.l16.m1.1.1.1.1"><times id="alg2.l16.m1.1.1.1.1.2.cmml" xref="alg2.l16.m1.1.1.1.1.2"></times><apply id="alg2.l16.m1.1.1.1.1.1.1.1.cmml" xref="alg2.l16.m1.1.1.1.1.1.1"><minus id="alg2.l16.m1.1.1.1.1.1.1.1.1.cmml" xref="alg2.l16.m1.1.1.1.1.1.1.1.1"></minus><cn type="integer" id="alg2.l16.m1.1.1.1.1.1.1.1.2.cmml" xref="alg2.l16.m1.1.1.1.1.1.1.1.2">1</cn><ci id="alg2.l16.m1.1.1.1.1.1.1.1.3.cmml" xref="alg2.l16.m1.1.1.1.1.1.1.1.3">𝛼</ci></apply><apply id="alg2.l16.m1.1.1.1.1.3.cmml" xref="alg2.l16.m1.1.1.1.1.3"><csymbol cd="ambiguous" id="alg2.l16.m1.1.1.1.1.3.1.cmml" xref="alg2.l16.m1.1.1.1.1.3">subscript</csymbol><ci id="alg2.l16.m1.1.1.1.1.3.2.cmml" xref="alg2.l16.m1.1.1.1.1.3.2">𝑆</ci><apply id="alg2.l16.m1.1.1.1.1.3.3.cmml" xref="alg2.l16.m1.1.1.1.1.3.3"><plus id="alg2.l16.m1.1.1.1.1.3.3.1.cmml" xref="alg2.l16.m1.1.1.1.1.3.3.1"></plus><ci id="alg2.l16.m1.1.1.1.1.3.3.2.cmml" xref="alg2.l16.m1.1.1.1.1.3.3.2">𝑡</ci><cn type="integer" id="alg2.l16.m1.1.1.1.1.3.3.3.cmml" xref="alg2.l16.m1.1.1.1.1.3.3.3">1</cn></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.l16.m1.1c">T_{t+1}\leftarrow\alpha T_{t}+(1-\alpha)S_{t+1}</annotation></semantics></math><span id="alg2.l16.2" class="ltx_text" style="font-size:70%;">
</span>
</div>
<div id="alg2.l17" class="ltx_listingline">
<span id="alg2.l17.1" class="ltx_text" style="font-size:70%;">    </span><math id="alg2.l17.m1.1" class="ltx_Math" alttext="D_{\text{KL}}^{T}\leftarrow\frac{1}{m}\sum_{k\in L_{t}}(D_{\text{KL}}^{T})^{k}" display="inline"><semantics id="alg2.l17.m1.1a"><mrow id="alg2.l17.m1.1.1" xref="alg2.l17.m1.1.1.cmml"><msubsup id="alg2.l17.m1.1.1.3" xref="alg2.l17.m1.1.1.3.cmml"><mi mathsize="70%" id="alg2.l17.m1.1.1.3.2.2" xref="alg2.l17.m1.1.1.3.2.2.cmml">D</mi><mtext mathsize="70%" id="alg2.l17.m1.1.1.3.2.3" xref="alg2.l17.m1.1.1.3.2.3a.cmml">KL</mtext><mi mathsize="70%" id="alg2.l17.m1.1.1.3.3" xref="alg2.l17.m1.1.1.3.3.cmml">T</mi></msubsup><mo mathsize="70%" stretchy="false" id="alg2.l17.m1.1.1.2" xref="alg2.l17.m1.1.1.2.cmml">←</mo><mrow id="alg2.l17.m1.1.1.1" xref="alg2.l17.m1.1.1.1.cmml"><mfrac id="alg2.l17.m1.1.1.1.3" xref="alg2.l17.m1.1.1.1.3.cmml"><mn mathsize="70%" id="alg2.l17.m1.1.1.1.3.2" xref="alg2.l17.m1.1.1.1.3.2.cmml">1</mn><mi mathsize="70%" id="alg2.l17.m1.1.1.1.3.3" xref="alg2.l17.m1.1.1.1.3.3.cmml">m</mi></mfrac><mo lspace="0em" rspace="0em" id="alg2.l17.m1.1.1.1.2" xref="alg2.l17.m1.1.1.1.2.cmml">​</mo><mrow id="alg2.l17.m1.1.1.1.1" xref="alg2.l17.m1.1.1.1.1.cmml"><msub id="alg2.l17.m1.1.1.1.1.2" xref="alg2.l17.m1.1.1.1.1.2.cmml"><mo maxsize="70%" minsize="70%" rspace="0em" stretchy="true" id="alg2.l17.m1.1.1.1.1.2.2" xref="alg2.l17.m1.1.1.1.1.2.2.cmml">∑</mo><mrow id="alg2.l17.m1.1.1.1.1.2.3" xref="alg2.l17.m1.1.1.1.1.2.3.cmml"><mi mathsize="70%" id="alg2.l17.m1.1.1.1.1.2.3.2" xref="alg2.l17.m1.1.1.1.1.2.3.2.cmml">k</mi><mo mathsize="70%" id="alg2.l17.m1.1.1.1.1.2.3.1" xref="alg2.l17.m1.1.1.1.1.2.3.1.cmml">∈</mo><msub id="alg2.l17.m1.1.1.1.1.2.3.3" xref="alg2.l17.m1.1.1.1.1.2.3.3.cmml"><mi mathsize="70%" id="alg2.l17.m1.1.1.1.1.2.3.3.2" xref="alg2.l17.m1.1.1.1.1.2.3.3.2.cmml">L</mi><mi mathsize="70%" id="alg2.l17.m1.1.1.1.1.2.3.3.3" xref="alg2.l17.m1.1.1.1.1.2.3.3.3.cmml">t</mi></msub></mrow></msub><msup id="alg2.l17.m1.1.1.1.1.1" xref="alg2.l17.m1.1.1.1.1.1.cmml"><mrow id="alg2.l17.m1.1.1.1.1.1.1.1" xref="alg2.l17.m1.1.1.1.1.1.1.1.1.cmml"><mo maxsize="70%" minsize="70%" id="alg2.l17.m1.1.1.1.1.1.1.1.2" xref="alg2.l17.m1.1.1.1.1.1.1.1.1.cmml">(</mo><msubsup id="alg2.l17.m1.1.1.1.1.1.1.1.1" xref="alg2.l17.m1.1.1.1.1.1.1.1.1.cmml"><mi mathsize="70%" id="alg2.l17.m1.1.1.1.1.1.1.1.1.2.2" xref="alg2.l17.m1.1.1.1.1.1.1.1.1.2.2.cmml">D</mi><mtext mathsize="70%" id="alg2.l17.m1.1.1.1.1.1.1.1.1.2.3" xref="alg2.l17.m1.1.1.1.1.1.1.1.1.2.3a.cmml">KL</mtext><mi mathsize="70%" id="alg2.l17.m1.1.1.1.1.1.1.1.1.3" xref="alg2.l17.m1.1.1.1.1.1.1.1.1.3.cmml">T</mi></msubsup><mo maxsize="70%" minsize="70%" id="alg2.l17.m1.1.1.1.1.1.1.1.3" xref="alg2.l17.m1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow><mi mathsize="70%" id="alg2.l17.m1.1.1.1.1.1.3" xref="alg2.l17.m1.1.1.1.1.1.3.cmml">k</mi></msup></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg2.l17.m1.1b"><apply id="alg2.l17.m1.1.1.cmml" xref="alg2.l17.m1.1.1"><ci id="alg2.l17.m1.1.1.2.cmml" xref="alg2.l17.m1.1.1.2">←</ci><apply id="alg2.l17.m1.1.1.3.cmml" xref="alg2.l17.m1.1.1.3"><csymbol cd="ambiguous" id="alg2.l17.m1.1.1.3.1.cmml" xref="alg2.l17.m1.1.1.3">superscript</csymbol><apply id="alg2.l17.m1.1.1.3.2.cmml" xref="alg2.l17.m1.1.1.3"><csymbol cd="ambiguous" id="alg2.l17.m1.1.1.3.2.1.cmml" xref="alg2.l17.m1.1.1.3">subscript</csymbol><ci id="alg2.l17.m1.1.1.3.2.2.cmml" xref="alg2.l17.m1.1.1.3.2.2">𝐷</ci><ci id="alg2.l17.m1.1.1.3.2.3a.cmml" xref="alg2.l17.m1.1.1.3.2.3"><mtext mathsize="49%" id="alg2.l17.m1.1.1.3.2.3.cmml" xref="alg2.l17.m1.1.1.3.2.3">KL</mtext></ci></apply><ci id="alg2.l17.m1.1.1.3.3.cmml" xref="alg2.l17.m1.1.1.3.3">𝑇</ci></apply><apply id="alg2.l17.m1.1.1.1.cmml" xref="alg2.l17.m1.1.1.1"><times id="alg2.l17.m1.1.1.1.2.cmml" xref="alg2.l17.m1.1.1.1.2"></times><apply id="alg2.l17.m1.1.1.1.3.cmml" xref="alg2.l17.m1.1.1.1.3"><divide id="alg2.l17.m1.1.1.1.3.1.cmml" xref="alg2.l17.m1.1.1.1.3"></divide><cn type="integer" id="alg2.l17.m1.1.1.1.3.2.cmml" xref="alg2.l17.m1.1.1.1.3.2">1</cn><ci id="alg2.l17.m1.1.1.1.3.3.cmml" xref="alg2.l17.m1.1.1.1.3.3">𝑚</ci></apply><apply id="alg2.l17.m1.1.1.1.1.cmml" xref="alg2.l17.m1.1.1.1.1"><apply id="alg2.l17.m1.1.1.1.1.2.cmml" xref="alg2.l17.m1.1.1.1.1.2"><csymbol cd="ambiguous" id="alg2.l17.m1.1.1.1.1.2.1.cmml" xref="alg2.l17.m1.1.1.1.1.2">subscript</csymbol><sum id="alg2.l17.m1.1.1.1.1.2.2.cmml" xref="alg2.l17.m1.1.1.1.1.2.2"></sum><apply id="alg2.l17.m1.1.1.1.1.2.3.cmml" xref="alg2.l17.m1.1.1.1.1.2.3"><in id="alg2.l17.m1.1.1.1.1.2.3.1.cmml" xref="alg2.l17.m1.1.1.1.1.2.3.1"></in><ci id="alg2.l17.m1.1.1.1.1.2.3.2.cmml" xref="alg2.l17.m1.1.1.1.1.2.3.2">𝑘</ci><apply id="alg2.l17.m1.1.1.1.1.2.3.3.cmml" xref="alg2.l17.m1.1.1.1.1.2.3.3"><csymbol cd="ambiguous" id="alg2.l17.m1.1.1.1.1.2.3.3.1.cmml" xref="alg2.l17.m1.1.1.1.1.2.3.3">subscript</csymbol><ci id="alg2.l17.m1.1.1.1.1.2.3.3.2.cmml" xref="alg2.l17.m1.1.1.1.1.2.3.3.2">𝐿</ci><ci id="alg2.l17.m1.1.1.1.1.2.3.3.3.cmml" xref="alg2.l17.m1.1.1.1.1.2.3.3.3">𝑡</ci></apply></apply></apply><apply id="alg2.l17.m1.1.1.1.1.1.cmml" xref="alg2.l17.m1.1.1.1.1.1"><csymbol cd="ambiguous" id="alg2.l17.m1.1.1.1.1.1.2.cmml" xref="alg2.l17.m1.1.1.1.1.1">superscript</csymbol><apply id="alg2.l17.m1.1.1.1.1.1.1.1.1.cmml" xref="alg2.l17.m1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="alg2.l17.m1.1.1.1.1.1.1.1.1.1.cmml" xref="alg2.l17.m1.1.1.1.1.1.1.1">superscript</csymbol><apply id="alg2.l17.m1.1.1.1.1.1.1.1.1.2.cmml" xref="alg2.l17.m1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="alg2.l17.m1.1.1.1.1.1.1.1.1.2.1.cmml" xref="alg2.l17.m1.1.1.1.1.1.1.1">subscript</csymbol><ci id="alg2.l17.m1.1.1.1.1.1.1.1.1.2.2.cmml" xref="alg2.l17.m1.1.1.1.1.1.1.1.1.2.2">𝐷</ci><ci id="alg2.l17.m1.1.1.1.1.1.1.1.1.2.3a.cmml" xref="alg2.l17.m1.1.1.1.1.1.1.1.1.2.3"><mtext mathsize="49%" id="alg2.l17.m1.1.1.1.1.1.1.1.1.2.3.cmml" xref="alg2.l17.m1.1.1.1.1.1.1.1.1.2.3">KL</mtext></ci></apply><ci id="alg2.l17.m1.1.1.1.1.1.1.1.1.3.cmml" xref="alg2.l17.m1.1.1.1.1.1.1.1.1.3">𝑇</ci></apply><ci id="alg2.l17.m1.1.1.1.1.1.3.cmml" xref="alg2.l17.m1.1.1.1.1.1.3">𝑘</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.l17.m1.1c">D_{\text{KL}}^{T}\leftarrow\frac{1}{m}\sum_{k\in L_{t}}(D_{\text{KL}}^{T})^{k}</annotation></semantics></math><span id="alg2.l17.2" class="ltx_text" style="font-size:70%;">
</span>
</div>
<div id="alg2.l18" class="ltx_listingline">
<span id="alg2.l18.1" class="ltx_text" style="font-size:70%;">    </span><math id="alg2.l18.m1.1" class="ltx_Math" alttext="D_{\text{KL}}^{S}\leftarrow\frac{1}{m}\sum_{k\in L_{t}}(D_{\text{KL}}^{S})^{k}" display="inline"><semantics id="alg2.l18.m1.1a"><mrow id="alg2.l18.m1.1.1" xref="alg2.l18.m1.1.1.cmml"><msubsup id="alg2.l18.m1.1.1.3" xref="alg2.l18.m1.1.1.3.cmml"><mi mathsize="70%" id="alg2.l18.m1.1.1.3.2.2" xref="alg2.l18.m1.1.1.3.2.2.cmml">D</mi><mtext mathsize="70%" id="alg2.l18.m1.1.1.3.2.3" xref="alg2.l18.m1.1.1.3.2.3a.cmml">KL</mtext><mi mathsize="70%" id="alg2.l18.m1.1.1.3.3" xref="alg2.l18.m1.1.1.3.3.cmml">S</mi></msubsup><mo mathsize="70%" stretchy="false" id="alg2.l18.m1.1.1.2" xref="alg2.l18.m1.1.1.2.cmml">←</mo><mrow id="alg2.l18.m1.1.1.1" xref="alg2.l18.m1.1.1.1.cmml"><mfrac id="alg2.l18.m1.1.1.1.3" xref="alg2.l18.m1.1.1.1.3.cmml"><mn mathsize="70%" id="alg2.l18.m1.1.1.1.3.2" xref="alg2.l18.m1.1.1.1.3.2.cmml">1</mn><mi mathsize="70%" id="alg2.l18.m1.1.1.1.3.3" xref="alg2.l18.m1.1.1.1.3.3.cmml">m</mi></mfrac><mo lspace="0em" rspace="0em" id="alg2.l18.m1.1.1.1.2" xref="alg2.l18.m1.1.1.1.2.cmml">​</mo><mrow id="alg2.l18.m1.1.1.1.1" xref="alg2.l18.m1.1.1.1.1.cmml"><msub id="alg2.l18.m1.1.1.1.1.2" xref="alg2.l18.m1.1.1.1.1.2.cmml"><mo maxsize="70%" minsize="70%" rspace="0em" stretchy="true" id="alg2.l18.m1.1.1.1.1.2.2" xref="alg2.l18.m1.1.1.1.1.2.2.cmml">∑</mo><mrow id="alg2.l18.m1.1.1.1.1.2.3" xref="alg2.l18.m1.1.1.1.1.2.3.cmml"><mi mathsize="70%" id="alg2.l18.m1.1.1.1.1.2.3.2" xref="alg2.l18.m1.1.1.1.1.2.3.2.cmml">k</mi><mo mathsize="70%" id="alg2.l18.m1.1.1.1.1.2.3.1" xref="alg2.l18.m1.1.1.1.1.2.3.1.cmml">∈</mo><msub id="alg2.l18.m1.1.1.1.1.2.3.3" xref="alg2.l18.m1.1.1.1.1.2.3.3.cmml"><mi mathsize="70%" id="alg2.l18.m1.1.1.1.1.2.3.3.2" xref="alg2.l18.m1.1.1.1.1.2.3.3.2.cmml">L</mi><mi mathsize="70%" id="alg2.l18.m1.1.1.1.1.2.3.3.3" xref="alg2.l18.m1.1.1.1.1.2.3.3.3.cmml">t</mi></msub></mrow></msub><msup id="alg2.l18.m1.1.1.1.1.1" xref="alg2.l18.m1.1.1.1.1.1.cmml"><mrow id="alg2.l18.m1.1.1.1.1.1.1.1" xref="alg2.l18.m1.1.1.1.1.1.1.1.1.cmml"><mo maxsize="70%" minsize="70%" id="alg2.l18.m1.1.1.1.1.1.1.1.2" xref="alg2.l18.m1.1.1.1.1.1.1.1.1.cmml">(</mo><msubsup id="alg2.l18.m1.1.1.1.1.1.1.1.1" xref="alg2.l18.m1.1.1.1.1.1.1.1.1.cmml"><mi mathsize="70%" id="alg2.l18.m1.1.1.1.1.1.1.1.1.2.2" xref="alg2.l18.m1.1.1.1.1.1.1.1.1.2.2.cmml">D</mi><mtext mathsize="70%" id="alg2.l18.m1.1.1.1.1.1.1.1.1.2.3" xref="alg2.l18.m1.1.1.1.1.1.1.1.1.2.3a.cmml">KL</mtext><mi mathsize="70%" id="alg2.l18.m1.1.1.1.1.1.1.1.1.3" xref="alg2.l18.m1.1.1.1.1.1.1.1.1.3.cmml">S</mi></msubsup><mo maxsize="70%" minsize="70%" id="alg2.l18.m1.1.1.1.1.1.1.1.3" xref="alg2.l18.m1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow><mi mathsize="70%" id="alg2.l18.m1.1.1.1.1.1.3" xref="alg2.l18.m1.1.1.1.1.1.3.cmml">k</mi></msup></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg2.l18.m1.1b"><apply id="alg2.l18.m1.1.1.cmml" xref="alg2.l18.m1.1.1"><ci id="alg2.l18.m1.1.1.2.cmml" xref="alg2.l18.m1.1.1.2">←</ci><apply id="alg2.l18.m1.1.1.3.cmml" xref="alg2.l18.m1.1.1.3"><csymbol cd="ambiguous" id="alg2.l18.m1.1.1.3.1.cmml" xref="alg2.l18.m1.1.1.3">superscript</csymbol><apply id="alg2.l18.m1.1.1.3.2.cmml" xref="alg2.l18.m1.1.1.3"><csymbol cd="ambiguous" id="alg2.l18.m1.1.1.3.2.1.cmml" xref="alg2.l18.m1.1.1.3">subscript</csymbol><ci id="alg2.l18.m1.1.1.3.2.2.cmml" xref="alg2.l18.m1.1.1.3.2.2">𝐷</ci><ci id="alg2.l18.m1.1.1.3.2.3a.cmml" xref="alg2.l18.m1.1.1.3.2.3"><mtext mathsize="49%" id="alg2.l18.m1.1.1.3.2.3.cmml" xref="alg2.l18.m1.1.1.3.2.3">KL</mtext></ci></apply><ci id="alg2.l18.m1.1.1.3.3.cmml" xref="alg2.l18.m1.1.1.3.3">𝑆</ci></apply><apply id="alg2.l18.m1.1.1.1.cmml" xref="alg2.l18.m1.1.1.1"><times id="alg2.l18.m1.1.1.1.2.cmml" xref="alg2.l18.m1.1.1.1.2"></times><apply id="alg2.l18.m1.1.1.1.3.cmml" xref="alg2.l18.m1.1.1.1.3"><divide id="alg2.l18.m1.1.1.1.3.1.cmml" xref="alg2.l18.m1.1.1.1.3"></divide><cn type="integer" id="alg2.l18.m1.1.1.1.3.2.cmml" xref="alg2.l18.m1.1.1.1.3.2">1</cn><ci id="alg2.l18.m1.1.1.1.3.3.cmml" xref="alg2.l18.m1.1.1.1.3.3">𝑚</ci></apply><apply id="alg2.l18.m1.1.1.1.1.cmml" xref="alg2.l18.m1.1.1.1.1"><apply id="alg2.l18.m1.1.1.1.1.2.cmml" xref="alg2.l18.m1.1.1.1.1.2"><csymbol cd="ambiguous" id="alg2.l18.m1.1.1.1.1.2.1.cmml" xref="alg2.l18.m1.1.1.1.1.2">subscript</csymbol><sum id="alg2.l18.m1.1.1.1.1.2.2.cmml" xref="alg2.l18.m1.1.1.1.1.2.2"></sum><apply id="alg2.l18.m1.1.1.1.1.2.3.cmml" xref="alg2.l18.m1.1.1.1.1.2.3"><in id="alg2.l18.m1.1.1.1.1.2.3.1.cmml" xref="alg2.l18.m1.1.1.1.1.2.3.1"></in><ci id="alg2.l18.m1.1.1.1.1.2.3.2.cmml" xref="alg2.l18.m1.1.1.1.1.2.3.2">𝑘</ci><apply id="alg2.l18.m1.1.1.1.1.2.3.3.cmml" xref="alg2.l18.m1.1.1.1.1.2.3.3"><csymbol cd="ambiguous" id="alg2.l18.m1.1.1.1.1.2.3.3.1.cmml" xref="alg2.l18.m1.1.1.1.1.2.3.3">subscript</csymbol><ci id="alg2.l18.m1.1.1.1.1.2.3.3.2.cmml" xref="alg2.l18.m1.1.1.1.1.2.3.3.2">𝐿</ci><ci id="alg2.l18.m1.1.1.1.1.2.3.3.3.cmml" xref="alg2.l18.m1.1.1.1.1.2.3.3.3">𝑡</ci></apply></apply></apply><apply id="alg2.l18.m1.1.1.1.1.1.cmml" xref="alg2.l18.m1.1.1.1.1.1"><csymbol cd="ambiguous" id="alg2.l18.m1.1.1.1.1.1.2.cmml" xref="alg2.l18.m1.1.1.1.1.1">superscript</csymbol><apply id="alg2.l18.m1.1.1.1.1.1.1.1.1.cmml" xref="alg2.l18.m1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="alg2.l18.m1.1.1.1.1.1.1.1.1.1.cmml" xref="alg2.l18.m1.1.1.1.1.1.1.1">superscript</csymbol><apply id="alg2.l18.m1.1.1.1.1.1.1.1.1.2.cmml" xref="alg2.l18.m1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="alg2.l18.m1.1.1.1.1.1.1.1.1.2.1.cmml" xref="alg2.l18.m1.1.1.1.1.1.1.1">subscript</csymbol><ci id="alg2.l18.m1.1.1.1.1.1.1.1.1.2.2.cmml" xref="alg2.l18.m1.1.1.1.1.1.1.1.1.2.2">𝐷</ci><ci id="alg2.l18.m1.1.1.1.1.1.1.1.1.2.3a.cmml" xref="alg2.l18.m1.1.1.1.1.1.1.1.1.2.3"><mtext mathsize="49%" id="alg2.l18.m1.1.1.1.1.1.1.1.1.2.3.cmml" xref="alg2.l18.m1.1.1.1.1.1.1.1.1.2.3">KL</mtext></ci></apply><ci id="alg2.l18.m1.1.1.1.1.1.1.1.1.3.cmml" xref="alg2.l18.m1.1.1.1.1.1.1.1.1.3">𝑆</ci></apply><ci id="alg2.l18.m1.1.1.1.1.1.3.cmml" xref="alg2.l18.m1.1.1.1.1.1.3">𝑘</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.l18.m1.1c">D_{\text{KL}}^{S}\leftarrow\frac{1}{m}\sum_{k\in L_{t}}(D_{\text{KL}}^{S})^{k}</annotation></semantics></math><span id="alg2.l18.2" class="ltx_text" style="font-size:70%;">
</span>
</div>
<div id="alg2.l19" class="ltx_listingline">
<span id="alg2.l19.1" class="ltx_text" style="font-size:70%;"> </span><span id="alg2.l19.2" class="ltx_text ltx_font_bold" style="font-size:70%;">end</span><span id="alg2.l19.3" class="ltx_text" style="font-size:70%;"> </span><span id="alg2.l19.4" class="ltx_text ltx_font_bold" style="font-size:70%;">for</span><span id="alg2.l19.5" class="ltx_text" style="font-size:70%;">
</span>
</div>
<div id="alg2.l20" class="ltx_listingline">
<span id="alg2.l20.1" class="ltx_text" style="font-size:70%;"> </span>
</div>
<div id="alg2.l21" class="ltx_listingline">
<span id="alg2.l21.2" class="ltx_text" style="font-size:70%;"> </span><span id="alg2.l21.1" class="ltx_text ltx_font_bold" style="font-size:70%;">ServerUpdate<math id="alg2.l21.1.m1.1" class="ltx_Math" alttext="(S)" display="inline"><semantics id="alg2.l21.1.m1.1a"><mrow id="alg2.l21.1.m1.1.2.2"><mo stretchy="false" id="alg2.l21.1.m1.1.2.2.1">(</mo><mi id="alg2.l21.1.m1.1.1" xref="alg2.l21.1.m1.1.1.cmml">S</mi><mo stretchy="false" id="alg2.l21.1.m1.1.2.2.2">)</mo></mrow><annotation-xml encoding="MathML-Content" id="alg2.l21.1.m1.1b"><ci id="alg2.l21.1.m1.1.1.cmml" xref="alg2.l21.1.m1.1.1">𝑆</ci></annotation-xml><annotation encoding="application/x-tex" id="alg2.l21.1.m1.1c">(S)</annotation></semantics></math>:</span><span id="alg2.l21.3" class="ltx_text" style="font-size:70%;">
</span>
</div>
<div id="alg2.l22" class="ltx_listingline">
<span id="alg2.l22.1" class="ltx_text" style="font-size:70%;"> </span><span id="alg2.l22.2" class="ltx_text ltx_font_bold" style="font-size:70%;">for</span><span id="alg2.l22.3" class="ltx_text" style="font-size:70%;"> each local epoch </span><math id="alg2.l22.m1.3" class="ltx_Math" alttext="e=1,2,...E_{s}" display="inline"><semantics id="alg2.l22.m1.3a"><mrow id="alg2.l22.m1.3.3" xref="alg2.l22.m1.3.3.cmml"><mi mathsize="70%" id="alg2.l22.m1.3.3.3" xref="alg2.l22.m1.3.3.3.cmml">e</mi><mo mathsize="70%" id="alg2.l22.m1.3.3.2" xref="alg2.l22.m1.3.3.2.cmml">=</mo><mrow id="alg2.l22.m1.3.3.1.1" xref="alg2.l22.m1.3.3.1.2.cmml"><mn mathsize="70%" id="alg2.l22.m1.1.1" xref="alg2.l22.m1.1.1.cmml">1</mn><mo mathsize="70%" id="alg2.l22.m1.3.3.1.1.2" xref="alg2.l22.m1.3.3.1.2.cmml">,</mo><mn mathsize="70%" id="alg2.l22.m1.2.2" xref="alg2.l22.m1.2.2.cmml">2</mn><mo mathsize="70%" id="alg2.l22.m1.3.3.1.1.3" xref="alg2.l22.m1.3.3.1.2.cmml">,</mo><mrow id="alg2.l22.m1.3.3.1.1.1" xref="alg2.l22.m1.3.3.1.1.1.cmml"><mi mathsize="70%" mathvariant="normal" id="alg2.l22.m1.3.3.1.1.1.2" xref="alg2.l22.m1.3.3.1.1.1.2.cmml">…</mi><mo lspace="0em" rspace="0em" id="alg2.l22.m1.3.3.1.1.1.1" xref="alg2.l22.m1.3.3.1.1.1.1.cmml">​</mo><msub id="alg2.l22.m1.3.3.1.1.1.3" xref="alg2.l22.m1.3.3.1.1.1.3.cmml"><mi mathsize="70%" id="alg2.l22.m1.3.3.1.1.1.3.2" xref="alg2.l22.m1.3.3.1.1.1.3.2.cmml">E</mi><mi mathsize="70%" id="alg2.l22.m1.3.3.1.1.1.3.3" xref="alg2.l22.m1.3.3.1.1.1.3.3.cmml">s</mi></msub></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg2.l22.m1.3b"><apply id="alg2.l22.m1.3.3.cmml" xref="alg2.l22.m1.3.3"><eq id="alg2.l22.m1.3.3.2.cmml" xref="alg2.l22.m1.3.3.2"></eq><ci id="alg2.l22.m1.3.3.3.cmml" xref="alg2.l22.m1.3.3.3">𝑒</ci><list id="alg2.l22.m1.3.3.1.2.cmml" xref="alg2.l22.m1.3.3.1.1"><cn type="integer" id="alg2.l22.m1.1.1.cmml" xref="alg2.l22.m1.1.1">1</cn><cn type="integer" id="alg2.l22.m1.2.2.cmml" xref="alg2.l22.m1.2.2">2</cn><apply id="alg2.l22.m1.3.3.1.1.1.cmml" xref="alg2.l22.m1.3.3.1.1.1"><times id="alg2.l22.m1.3.3.1.1.1.1.cmml" xref="alg2.l22.m1.3.3.1.1.1.1"></times><ci id="alg2.l22.m1.3.3.1.1.1.2.cmml" xref="alg2.l22.m1.3.3.1.1.1.2">…</ci><apply id="alg2.l22.m1.3.3.1.1.1.3.cmml" xref="alg2.l22.m1.3.3.1.1.1.3"><csymbol cd="ambiguous" id="alg2.l22.m1.3.3.1.1.1.3.1.cmml" xref="alg2.l22.m1.3.3.1.1.1.3">subscript</csymbol><ci id="alg2.l22.m1.3.3.1.1.1.3.2.cmml" xref="alg2.l22.m1.3.3.1.1.1.3.2">𝐸</ci><ci id="alg2.l22.m1.3.3.1.1.1.3.3.cmml" xref="alg2.l22.m1.3.3.1.1.1.3.3">𝑠</ci></apply></apply></list></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.l22.m1.3c">e=1,2,...E_{s}</annotation></semantics></math><span id="alg2.l22.4" class="ltx_text" style="font-size:70%;"> </span><span id="alg2.l22.5" class="ltx_text ltx_font_bold" style="font-size:70%;">do</span><span id="alg2.l22.6" class="ltx_text" style="font-size:70%;">


</span>
</div>
<div id="alg2.l23" class="ltx_listingline">
<span id="alg2.l23.1" class="ltx_text" style="font-size:70%;">    </span><span id="alg2.l23.2" class="ltx_text ltx_font_bold" style="font-size:70%;">for</span><span id="alg2.l23.3" class="ltx_text" style="font-size:70%;"> labeled batch </span><math id="alg2.l23.m1.1" class="ltx_Math" alttext="s\in D" display="inline"><semantics id="alg2.l23.m1.1a"><mrow id="alg2.l23.m1.1.1" xref="alg2.l23.m1.1.1.cmml"><mi mathsize="70%" id="alg2.l23.m1.1.1.2" xref="alg2.l23.m1.1.1.2.cmml">s</mi><mo mathsize="70%" id="alg2.l23.m1.1.1.1" xref="alg2.l23.m1.1.1.1.cmml">∈</mo><mi mathsize="70%" id="alg2.l23.m1.1.1.3" xref="alg2.l23.m1.1.1.3.cmml">D</mi></mrow><annotation-xml encoding="MathML-Content" id="alg2.l23.m1.1b"><apply id="alg2.l23.m1.1.1.cmml" xref="alg2.l23.m1.1.1"><in id="alg2.l23.m1.1.1.1.cmml" xref="alg2.l23.m1.1.1.1"></in><ci id="alg2.l23.m1.1.1.2.cmml" xref="alg2.l23.m1.1.1.2">𝑠</ci><ci id="alg2.l23.m1.1.1.3.cmml" xref="alg2.l23.m1.1.1.3">𝐷</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.l23.m1.1c">s\in D</annotation></semantics></math><span id="alg2.l23.4" class="ltx_text" style="font-size:70%;"> </span><span id="alg2.l23.5" class="ltx_text ltx_font_bold" style="font-size:70%;">do</span><span id="alg2.l23.6" class="ltx_text" style="font-size:70%;">


</span>
</div>
<div id="alg2.l24" class="ltx_listingline">
<span id="alg2.l24.1" class="ltx_text" style="font-size:70%;">      </span><math id="alg2.l24.m1.2" class="ltx_Math" alttext="S\leftarrow S-\eta_{s}\cdot\nabla\mathcal{L}_{s}(S;s)" display="inline"><semantics id="alg2.l24.m1.2a"><mrow id="alg2.l24.m1.2.3" xref="alg2.l24.m1.2.3.cmml"><mi mathsize="70%" id="alg2.l24.m1.2.3.2" xref="alg2.l24.m1.2.3.2.cmml">S</mi><mo mathsize="70%" stretchy="false" id="alg2.l24.m1.2.3.1" xref="alg2.l24.m1.2.3.1.cmml">←</mo><mrow id="alg2.l24.m1.2.3.3" xref="alg2.l24.m1.2.3.3.cmml"><mi mathsize="70%" id="alg2.l24.m1.2.3.3.2" xref="alg2.l24.m1.2.3.3.2.cmml">S</mi><mo mathsize="70%" id="alg2.l24.m1.2.3.3.1" xref="alg2.l24.m1.2.3.3.1.cmml">−</mo><mrow id="alg2.l24.m1.2.3.3.3" xref="alg2.l24.m1.2.3.3.3.cmml"><mrow id="alg2.l24.m1.2.3.3.3.2" xref="alg2.l24.m1.2.3.3.3.2.cmml"><msub id="alg2.l24.m1.2.3.3.3.2.2" xref="alg2.l24.m1.2.3.3.3.2.2.cmml"><mi mathsize="70%" id="alg2.l24.m1.2.3.3.3.2.2.2" xref="alg2.l24.m1.2.3.3.3.2.2.2.cmml">η</mi><mi mathsize="70%" id="alg2.l24.m1.2.3.3.3.2.2.3" xref="alg2.l24.m1.2.3.3.3.2.2.3.cmml">s</mi></msub><mo lspace="0.222em" mathsize="70%" rspace="0.222em" id="alg2.l24.m1.2.3.3.3.2.1" xref="alg2.l24.m1.2.3.3.3.2.1.cmml">⋅</mo><mrow id="alg2.l24.m1.2.3.3.3.2.3" xref="alg2.l24.m1.2.3.3.3.2.3.cmml"><mo mathsize="70%" rspace="0.167em" id="alg2.l24.m1.2.3.3.3.2.3.1" xref="alg2.l24.m1.2.3.3.3.2.3.1.cmml">∇</mo><msub id="alg2.l24.m1.2.3.3.3.2.3.2" xref="alg2.l24.m1.2.3.3.3.2.3.2.cmml"><mi class="ltx_font_mathcaligraphic" mathsize="70%" id="alg2.l24.m1.2.3.3.3.2.3.2.2" xref="alg2.l24.m1.2.3.3.3.2.3.2.2.cmml">ℒ</mi><mi mathsize="70%" id="alg2.l24.m1.2.3.3.3.2.3.2.3" xref="alg2.l24.m1.2.3.3.3.2.3.2.3.cmml">s</mi></msub></mrow></mrow><mo lspace="0em" rspace="0em" id="alg2.l24.m1.2.3.3.3.1" xref="alg2.l24.m1.2.3.3.3.1.cmml">​</mo><mrow id="alg2.l24.m1.2.3.3.3.3.2" xref="alg2.l24.m1.2.3.3.3.3.1.cmml"><mo maxsize="70%" minsize="70%" id="alg2.l24.m1.2.3.3.3.3.2.1" xref="alg2.l24.m1.2.3.3.3.3.1.cmml">(</mo><mi mathsize="70%" id="alg2.l24.m1.1.1" xref="alg2.l24.m1.1.1.cmml">S</mi><mo mathsize="70%" id="alg2.l24.m1.2.3.3.3.3.2.2" xref="alg2.l24.m1.2.3.3.3.3.1.cmml">;</mo><mi mathsize="70%" id="alg2.l24.m1.2.2" xref="alg2.l24.m1.2.2.cmml">s</mi><mo maxsize="70%" minsize="70%" id="alg2.l24.m1.2.3.3.3.3.2.3" xref="alg2.l24.m1.2.3.3.3.3.1.cmml">)</mo></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg2.l24.m1.2b"><apply id="alg2.l24.m1.2.3.cmml" xref="alg2.l24.m1.2.3"><ci id="alg2.l24.m1.2.3.1.cmml" xref="alg2.l24.m1.2.3.1">←</ci><ci id="alg2.l24.m1.2.3.2.cmml" xref="alg2.l24.m1.2.3.2">𝑆</ci><apply id="alg2.l24.m1.2.3.3.cmml" xref="alg2.l24.m1.2.3.3"><minus id="alg2.l24.m1.2.3.3.1.cmml" xref="alg2.l24.m1.2.3.3.1"></minus><ci id="alg2.l24.m1.2.3.3.2.cmml" xref="alg2.l24.m1.2.3.3.2">𝑆</ci><apply id="alg2.l24.m1.2.3.3.3.cmml" xref="alg2.l24.m1.2.3.3.3"><times id="alg2.l24.m1.2.3.3.3.1.cmml" xref="alg2.l24.m1.2.3.3.3.1"></times><apply id="alg2.l24.m1.2.3.3.3.2.cmml" xref="alg2.l24.m1.2.3.3.3.2"><ci id="alg2.l24.m1.2.3.3.3.2.1.cmml" xref="alg2.l24.m1.2.3.3.3.2.1">⋅</ci><apply id="alg2.l24.m1.2.3.3.3.2.2.cmml" xref="alg2.l24.m1.2.3.3.3.2.2"><csymbol cd="ambiguous" id="alg2.l24.m1.2.3.3.3.2.2.1.cmml" xref="alg2.l24.m1.2.3.3.3.2.2">subscript</csymbol><ci id="alg2.l24.m1.2.3.3.3.2.2.2.cmml" xref="alg2.l24.m1.2.3.3.3.2.2.2">𝜂</ci><ci id="alg2.l24.m1.2.3.3.3.2.2.3.cmml" xref="alg2.l24.m1.2.3.3.3.2.2.3">𝑠</ci></apply><apply id="alg2.l24.m1.2.3.3.3.2.3.cmml" xref="alg2.l24.m1.2.3.3.3.2.3"><ci id="alg2.l24.m1.2.3.3.3.2.3.1.cmml" xref="alg2.l24.m1.2.3.3.3.2.3.1">∇</ci><apply id="alg2.l24.m1.2.3.3.3.2.3.2.cmml" xref="alg2.l24.m1.2.3.3.3.2.3.2"><csymbol cd="ambiguous" id="alg2.l24.m1.2.3.3.3.2.3.2.1.cmml" xref="alg2.l24.m1.2.3.3.3.2.3.2">subscript</csymbol><ci id="alg2.l24.m1.2.3.3.3.2.3.2.2.cmml" xref="alg2.l24.m1.2.3.3.3.2.3.2.2">ℒ</ci><ci id="alg2.l24.m1.2.3.3.3.2.3.2.3.cmml" xref="alg2.l24.m1.2.3.3.3.2.3.2.3">𝑠</ci></apply></apply></apply><list id="alg2.l24.m1.2.3.3.3.3.1.cmml" xref="alg2.l24.m1.2.3.3.3.3.2"><ci id="alg2.l24.m1.1.1.cmml" xref="alg2.l24.m1.1.1">𝑆</ci><ci id="alg2.l24.m1.2.2.cmml" xref="alg2.l24.m1.2.2">𝑠</ci></list></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.l24.m1.2c">S\leftarrow S-\eta_{s}\cdot\nabla\mathcal{L}_{s}(S;s)</annotation></semantics></math><span id="alg2.l24.2" class="ltx_text" style="font-size:70%;">
</span>
</div>
<div id="alg2.l25" class="ltx_listingline">
<span id="alg2.l25.1" class="ltx_text" style="font-size:70%;">    </span><span id="alg2.l25.2" class="ltx_text ltx_font_bold" style="font-size:70%;">end</span><span id="alg2.l25.3" class="ltx_text" style="font-size:70%;"> </span><span id="alg2.l25.4" class="ltx_text ltx_font_bold" style="font-size:70%;">for</span>
</div>
<div id="alg2.l26" class="ltx_listingline">
<span id="alg2.l26.1" class="ltx_text" style="font-size:70%;"> </span><span id="alg2.l26.2" class="ltx_text ltx_font_bold" style="font-size:70%;">end</span><span id="alg2.l26.3" class="ltx_text" style="font-size:70%;"> </span><span id="alg2.l26.4" class="ltx_text ltx_font_bold" style="font-size:70%;">for</span>
</div>
<div id="alg2.l27" class="ltx_listingline">
<span id="alg2.l27.1" class="ltx_text" style="font-size:70%;"> return </span><math id="alg2.l27.m1.1" class="ltx_Math" alttext="S" display="inline"><semantics id="alg2.l27.m1.1a"><mi mathsize="70%" id="alg2.l27.m1.1.1" xref="alg2.l27.m1.1.1.cmml">S</mi><annotation-xml encoding="MathML-Content" id="alg2.l27.m1.1b"><ci id="alg2.l27.m1.1.1.cmml" xref="alg2.l27.m1.1.1">𝑆</ci></annotation-xml><annotation encoding="application/x-tex" id="alg2.l27.m1.1c">S</annotation></semantics></math><span id="alg2.l27.2" class="ltx_text" style="font-size:70%;">
 
</span>
</div>
<div id="alg2.l28" class="ltx_listingline">
<span id="alg2.l28.1" class="ltx_text" style="font-size:70%;"> </span>
</div>
<div id="alg2.l29" class="ltx_listingline">
<span id="alg2.l29.2" class="ltx_text" style="font-size:70%;"> </span><span id="alg2.l29.1" class="ltx_text ltx_font_bold" style="font-size:70%;">ClientUpdate<math id="alg2.l29.1.m1.3" class="ltx_Math" alttext="(k,S,T)" display="inline"><semantics id="alg2.l29.1.m1.3a"><mrow id="alg2.l29.1.m1.3.4.2" xref="alg2.l29.1.m1.3.4.1.cmml"><mo stretchy="false" id="alg2.l29.1.m1.3.4.2.1" xref="alg2.l29.1.m1.3.4.1.cmml">(</mo><mi id="alg2.l29.1.m1.1.1" xref="alg2.l29.1.m1.1.1.cmml">k</mi><mo id="alg2.l29.1.m1.3.4.2.2" xref="alg2.l29.1.m1.3.4.1.cmml">,</mo><mi id="alg2.l29.1.m1.2.2" xref="alg2.l29.1.m1.2.2.cmml">S</mi><mo id="alg2.l29.1.m1.3.4.2.3" xref="alg2.l29.1.m1.3.4.1.cmml">,</mo><mi id="alg2.l29.1.m1.3.3" xref="alg2.l29.1.m1.3.3.cmml">T</mi><mo stretchy="false" id="alg2.l29.1.m1.3.4.2.4" xref="alg2.l29.1.m1.3.4.1.cmml">)</mo></mrow><annotation-xml encoding="MathML-Content" id="alg2.l29.1.m1.3b"><vector id="alg2.l29.1.m1.3.4.1.cmml" xref="alg2.l29.1.m1.3.4.2"><ci id="alg2.l29.1.m1.1.1.cmml" xref="alg2.l29.1.m1.1.1">𝑘</ci><ci id="alg2.l29.1.m1.2.2.cmml" xref="alg2.l29.1.m1.2.2">𝑆</ci><ci id="alg2.l29.1.m1.3.3.cmml" xref="alg2.l29.1.m1.3.3">𝑇</ci></vector></annotation-xml><annotation encoding="application/x-tex" id="alg2.l29.1.m1.3c">(k,S,T)</annotation></semantics></math>:</span><span id="alg2.l29.3" class="ltx_text" style="font-size:70%;">
</span>
</div>
<div id="alg2.l30" class="ltx_listingline">
<span id="alg2.l30.1" class="ltx_text" style="font-size:70%;"> </span><math id="alg2.l30.m1.1" class="ltx_Math" alttext="D_{\text{KL}}^{T}\leftarrow 0" display="inline"><semantics id="alg2.l30.m1.1a"><mrow id="alg2.l30.m1.1.1" xref="alg2.l30.m1.1.1.cmml"><msubsup id="alg2.l30.m1.1.1.2" xref="alg2.l30.m1.1.1.2.cmml"><mi mathsize="70%" id="alg2.l30.m1.1.1.2.2.2" xref="alg2.l30.m1.1.1.2.2.2.cmml">D</mi><mtext mathsize="70%" id="alg2.l30.m1.1.1.2.2.3" xref="alg2.l30.m1.1.1.2.2.3a.cmml">KL</mtext><mi mathsize="70%" id="alg2.l30.m1.1.1.2.3" xref="alg2.l30.m1.1.1.2.3.cmml">T</mi></msubsup><mo mathsize="70%" stretchy="false" id="alg2.l30.m1.1.1.1" xref="alg2.l30.m1.1.1.1.cmml">←</mo><mn mathsize="70%" id="alg2.l30.m1.1.1.3" xref="alg2.l30.m1.1.1.3.cmml">0</mn></mrow><annotation-xml encoding="MathML-Content" id="alg2.l30.m1.1b"><apply id="alg2.l30.m1.1.1.cmml" xref="alg2.l30.m1.1.1"><ci id="alg2.l30.m1.1.1.1.cmml" xref="alg2.l30.m1.1.1.1">←</ci><apply id="alg2.l30.m1.1.1.2.cmml" xref="alg2.l30.m1.1.1.2"><csymbol cd="ambiguous" id="alg2.l30.m1.1.1.2.1.cmml" xref="alg2.l30.m1.1.1.2">superscript</csymbol><apply id="alg2.l30.m1.1.1.2.2.cmml" xref="alg2.l30.m1.1.1.2"><csymbol cd="ambiguous" id="alg2.l30.m1.1.1.2.2.1.cmml" xref="alg2.l30.m1.1.1.2">subscript</csymbol><ci id="alg2.l30.m1.1.1.2.2.2.cmml" xref="alg2.l30.m1.1.1.2.2.2">𝐷</ci><ci id="alg2.l30.m1.1.1.2.2.3a.cmml" xref="alg2.l30.m1.1.1.2.2.3"><mtext mathsize="49%" id="alg2.l30.m1.1.1.2.2.3.cmml" xref="alg2.l30.m1.1.1.2.2.3">KL</mtext></ci></apply><ci id="alg2.l30.m1.1.1.2.3.cmml" xref="alg2.l30.m1.1.1.2.3">𝑇</ci></apply><cn type="integer" id="alg2.l30.m1.1.1.3.cmml" xref="alg2.l30.m1.1.1.3">0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.l30.m1.1c">D_{\text{KL}}^{T}\leftarrow 0</annotation></semantics></math><span id="alg2.l30.2" class="ltx_text" style="font-size:70%;">
</span>
</div>
<div id="alg2.l31" class="ltx_listingline">
<span id="alg2.l31.1" class="ltx_text" style="font-size:70%;"> </span><math id="alg2.l31.m1.1" class="ltx_Math" alttext="D_{\text{KL}}^{S}\leftarrow 0" display="inline"><semantics id="alg2.l31.m1.1a"><mrow id="alg2.l31.m1.1.1" xref="alg2.l31.m1.1.1.cmml"><msubsup id="alg2.l31.m1.1.1.2" xref="alg2.l31.m1.1.1.2.cmml"><mi mathsize="70%" id="alg2.l31.m1.1.1.2.2.2" xref="alg2.l31.m1.1.1.2.2.2.cmml">D</mi><mtext mathsize="70%" id="alg2.l31.m1.1.1.2.2.3" xref="alg2.l31.m1.1.1.2.2.3a.cmml">KL</mtext><mi mathsize="70%" id="alg2.l31.m1.1.1.2.3" xref="alg2.l31.m1.1.1.2.3.cmml">S</mi></msubsup><mo mathsize="70%" stretchy="false" id="alg2.l31.m1.1.1.1" xref="alg2.l31.m1.1.1.1.cmml">←</mo><mn mathsize="70%" id="alg2.l31.m1.1.1.3" xref="alg2.l31.m1.1.1.3.cmml">0</mn></mrow><annotation-xml encoding="MathML-Content" id="alg2.l31.m1.1b"><apply id="alg2.l31.m1.1.1.cmml" xref="alg2.l31.m1.1.1"><ci id="alg2.l31.m1.1.1.1.cmml" xref="alg2.l31.m1.1.1.1">←</ci><apply id="alg2.l31.m1.1.1.2.cmml" xref="alg2.l31.m1.1.1.2"><csymbol cd="ambiguous" id="alg2.l31.m1.1.1.2.1.cmml" xref="alg2.l31.m1.1.1.2">superscript</csymbol><apply id="alg2.l31.m1.1.1.2.2.cmml" xref="alg2.l31.m1.1.1.2"><csymbol cd="ambiguous" id="alg2.l31.m1.1.1.2.2.1.cmml" xref="alg2.l31.m1.1.1.2">subscript</csymbol><ci id="alg2.l31.m1.1.1.2.2.2.cmml" xref="alg2.l31.m1.1.1.2.2.2">𝐷</ci><ci id="alg2.l31.m1.1.1.2.2.3a.cmml" xref="alg2.l31.m1.1.1.2.2.3"><mtext mathsize="49%" id="alg2.l31.m1.1.1.2.2.3.cmml" xref="alg2.l31.m1.1.1.2.2.3">KL</mtext></ci></apply><ci id="alg2.l31.m1.1.1.2.3.cmml" xref="alg2.l31.m1.1.1.2.3">𝑆</ci></apply><cn type="integer" id="alg2.l31.m1.1.1.3.cmml" xref="alg2.l31.m1.1.1.3">0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.l31.m1.1c">D_{\text{KL}}^{S}\leftarrow 0</annotation></semantics></math><span id="alg2.l31.2" class="ltx_text" style="font-size:70%;">
</span>
</div>
<div id="alg2.l32" class="ltx_listingline">
<span id="alg2.l32.1" class="ltx_text" style="font-size:70%;"> </span><span id="alg2.l32.2" class="ltx_text ltx_font_bold" style="font-size:70%;">for</span><span id="alg2.l32.3" class="ltx_text" style="font-size:70%;"> each local epoch </span><math id="alg2.l32.m1.4" class="ltx_Math" alttext="e=1,2,\dots,E_{c}" display="inline"><semantics id="alg2.l32.m1.4a"><mrow id="alg2.l32.m1.4.4" xref="alg2.l32.m1.4.4.cmml"><mi mathsize="70%" id="alg2.l32.m1.4.4.3" xref="alg2.l32.m1.4.4.3.cmml">e</mi><mo mathsize="70%" id="alg2.l32.m1.4.4.2" xref="alg2.l32.m1.4.4.2.cmml">=</mo><mrow id="alg2.l32.m1.4.4.1.1" xref="alg2.l32.m1.4.4.1.2.cmml"><mn mathsize="70%" id="alg2.l32.m1.1.1" xref="alg2.l32.m1.1.1.cmml">1</mn><mo mathsize="70%" id="alg2.l32.m1.4.4.1.1.2" xref="alg2.l32.m1.4.4.1.2.cmml">,</mo><mn mathsize="70%" id="alg2.l32.m1.2.2" xref="alg2.l32.m1.2.2.cmml">2</mn><mo mathsize="70%" id="alg2.l32.m1.4.4.1.1.3" xref="alg2.l32.m1.4.4.1.2.cmml">,</mo><mi mathsize="70%" mathvariant="normal" id="alg2.l32.m1.3.3" xref="alg2.l32.m1.3.3.cmml">…</mi><mo mathsize="70%" id="alg2.l32.m1.4.4.1.1.4" xref="alg2.l32.m1.4.4.1.2.cmml">,</mo><msub id="alg2.l32.m1.4.4.1.1.1" xref="alg2.l32.m1.4.4.1.1.1.cmml"><mi mathsize="70%" id="alg2.l32.m1.4.4.1.1.1.2" xref="alg2.l32.m1.4.4.1.1.1.2.cmml">E</mi><mi mathsize="70%" id="alg2.l32.m1.4.4.1.1.1.3" xref="alg2.l32.m1.4.4.1.1.1.3.cmml">c</mi></msub></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg2.l32.m1.4b"><apply id="alg2.l32.m1.4.4.cmml" xref="alg2.l32.m1.4.4"><eq id="alg2.l32.m1.4.4.2.cmml" xref="alg2.l32.m1.4.4.2"></eq><ci id="alg2.l32.m1.4.4.3.cmml" xref="alg2.l32.m1.4.4.3">𝑒</ci><list id="alg2.l32.m1.4.4.1.2.cmml" xref="alg2.l32.m1.4.4.1.1"><cn type="integer" id="alg2.l32.m1.1.1.cmml" xref="alg2.l32.m1.1.1">1</cn><cn type="integer" id="alg2.l32.m1.2.2.cmml" xref="alg2.l32.m1.2.2">2</cn><ci id="alg2.l32.m1.3.3.cmml" xref="alg2.l32.m1.3.3">…</ci><apply id="alg2.l32.m1.4.4.1.1.1.cmml" xref="alg2.l32.m1.4.4.1.1.1"><csymbol cd="ambiguous" id="alg2.l32.m1.4.4.1.1.1.1.cmml" xref="alg2.l32.m1.4.4.1.1.1">subscript</csymbol><ci id="alg2.l32.m1.4.4.1.1.1.2.cmml" xref="alg2.l32.m1.4.4.1.1.1.2">𝐸</ci><ci id="alg2.l32.m1.4.4.1.1.1.3.cmml" xref="alg2.l32.m1.4.4.1.1.1.3">𝑐</ci></apply></list></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.l32.m1.4c">e=1,2,\dots,E_{c}</annotation></semantics></math><span id="alg2.l32.4" class="ltx_text" style="font-size:70%;"> </span><span id="alg2.l32.5" class="ltx_text ltx_font_bold" style="font-size:70%;">do</span><span id="alg2.l32.6" class="ltx_text" style="font-size:70%;">


</span>
</div>
<div id="alg2.l33" class="ltx_listingline">
<span id="alg2.l33.1" class="ltx_text" style="font-size:70%;">    </span><span id="alg2.l33.2" class="ltx_text ltx_font_bold" style="font-size:70%;">for</span><span id="alg2.l33.3" class="ltx_text" style="font-size:70%;"> unlabeled batch </span><math id="alg2.l33.m1.1" class="ltx_Math" alttext="u\in D" display="inline"><semantics id="alg2.l33.m1.1a"><mrow id="alg2.l33.m1.1.1" xref="alg2.l33.m1.1.1.cmml"><mi mathsize="70%" id="alg2.l33.m1.1.1.2" xref="alg2.l33.m1.1.1.2.cmml">u</mi><mo mathsize="70%" id="alg2.l33.m1.1.1.1" xref="alg2.l33.m1.1.1.1.cmml">∈</mo><mi mathsize="70%" id="alg2.l33.m1.1.1.3" xref="alg2.l33.m1.1.1.3.cmml">D</mi></mrow><annotation-xml encoding="MathML-Content" id="alg2.l33.m1.1b"><apply id="alg2.l33.m1.1.1.cmml" xref="alg2.l33.m1.1.1"><in id="alg2.l33.m1.1.1.1.cmml" xref="alg2.l33.m1.1.1.1"></in><ci id="alg2.l33.m1.1.1.2.cmml" xref="alg2.l33.m1.1.1.2">𝑢</ci><ci id="alg2.l33.m1.1.1.3.cmml" xref="alg2.l33.m1.1.1.3">𝐷</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.l33.m1.1c">u\in D</annotation></semantics></math><span id="alg2.l33.4" class="ltx_text" style="font-size:70%;">   </span><span id="alg2.l33.5" class="ltx_text ltx_font_bold" style="font-size:70%;">do</span><span id="alg2.l33.6" class="ltx_text" style="font-size:70%;">

 
</span>
</div>
<div id="alg2.l34" class="ltx_listingline">
<span id="alg2.l34.1" class="ltx_text" style="font-size:70%;">      </span><math id="alg2.l34.m1.1" class="ltx_math_unparsed" alttext="S\leftarrow S-\eta\cdot\nabla(\lambda_{u}(\mathcal{L}_{u}" display="inline"><semantics id="alg2.l34.m1.1a"><mrow id="alg2.l34.m1.1b"><mi mathsize="70%" id="alg2.l34.m1.1.1">S</mi><mo mathsize="70%" stretchy="false" id="alg2.l34.m1.1.2">←</mo><mi mathsize="70%" id="alg2.l34.m1.1.3">S</mi><mo mathsize="70%" id="alg2.l34.m1.1.4">−</mo><mi mathsize="70%" id="alg2.l34.m1.1.5">η</mi><mo lspace="0.222em" mathsize="70%" rspace="0.222em" id="alg2.l34.m1.1.6">⋅</mo><mo mathsize="70%" id="alg2.l34.m1.1.7">∇</mo><mrow id="alg2.l34.m1.1.8"><mo maxsize="70%" minsize="70%" id="alg2.l34.m1.1.8.1">(</mo><msub id="alg2.l34.m1.1.8.2"><mi mathsize="70%" id="alg2.l34.m1.1.8.2.2">λ</mi><mi mathsize="70%" id="alg2.l34.m1.1.8.2.3">u</mi></msub><mrow id="alg2.l34.m1.1.8.3"><mo maxsize="70%" minsize="70%" id="alg2.l34.m1.1.8.3.1">(</mo><msub id="alg2.l34.m1.1.8.3.2"><mi class="ltx_font_mathcaligraphic" mathsize="70%" id="alg2.l34.m1.1.8.3.2.2">ℒ</mi><mi mathsize="70%" id="alg2.l34.m1.1.8.3.2.3">u</mi></msub></mrow></mrow></mrow><annotation encoding="application/x-tex" id="alg2.l34.m1.1c">S\leftarrow S-\eta\cdot\nabla(\lambda_{u}(\mathcal{L}_{u}</annotation></semantics></math><span id="alg2.l34.2" class="ltx_text" style="font-size:70%;">
</span><math id="alg2.l34.m2.3" class="ltx_Math" alttext="(S,T;u)" display="inline"><semantics id="alg2.l34.m2.3a"><mrow id="alg2.l34.m2.3.4.2" xref="alg2.l34.m2.3.4.1.cmml"><mo maxsize="70%" minsize="70%" id="alg2.l34.m2.3.4.2.1" xref="alg2.l34.m2.3.4.1.cmml">(</mo><mi mathsize="70%" id="alg2.l34.m2.1.1" xref="alg2.l34.m2.1.1.cmml">S</mi><mo mathsize="70%" id="alg2.l34.m2.3.4.2.2" xref="alg2.l34.m2.3.4.1.cmml">,</mo><mi mathsize="70%" id="alg2.l34.m2.2.2" xref="alg2.l34.m2.2.2.cmml">T</mi><mo mathsize="70%" id="alg2.l34.m2.3.4.2.3" xref="alg2.l34.m2.3.4.1.cmml">;</mo><mi mathsize="70%" id="alg2.l34.m2.3.3" xref="alg2.l34.m2.3.3.cmml">u</mi><mo maxsize="70%" minsize="70%" id="alg2.l34.m2.3.4.2.4" xref="alg2.l34.m2.3.4.1.cmml">)</mo></mrow><annotation-xml encoding="MathML-Content" id="alg2.l34.m2.3b"><vector id="alg2.l34.m2.3.4.1.cmml" xref="alg2.l34.m2.3.4.2"><ci id="alg2.l34.m2.1.1.cmml" xref="alg2.l34.m2.1.1">𝑆</ci><ci id="alg2.l34.m2.2.2.cmml" xref="alg2.l34.m2.2.2">𝑇</ci><ci id="alg2.l34.m2.3.3.cmml" xref="alg2.l34.m2.3.3">𝑢</ci></vector></annotation-xml><annotation encoding="application/x-tex" id="alg2.l34.m2.3c">(S,T;u)</annotation></semantics></math><span id="alg2.l34.3" class="ltx_text" style="font-size:70%;">
</span><math id="alg2.l34.m3.1" class="ltx_math_unparsed" alttext=")+\frac{\mu}{2}||S-S^{s}||^{2})" display="inline"><semantics id="alg2.l34.m3.1a"><mrow id="alg2.l34.m3.1b"><mo maxsize="70%" minsize="70%" id="alg2.l34.m3.1.1">)</mo><mo mathsize="70%" id="alg2.l34.m3.1.2">+</mo><mfrac id="alg2.l34.m3.1.3"><mi mathsize="70%" id="alg2.l34.m3.1.3.2">μ</mi><mn mathsize="70%" id="alg2.l34.m3.1.3.3">2</mn></mfrac><mo fence="false" maxsize="70%" minsize="70%" rspace="0.167em" id="alg2.l34.m3.1.4">|</mo><mo fence="false" maxsize="70%" minsize="70%" rspace="0.167em" id="alg2.l34.m3.1.5">|</mo><mi mathsize="70%" id="alg2.l34.m3.1.6">S</mi><mo mathsize="70%" id="alg2.l34.m3.1.7">−</mo><msup id="alg2.l34.m3.1.8"><mi mathsize="70%" id="alg2.l34.m3.1.8.2">S</mi><mi mathsize="70%" id="alg2.l34.m3.1.8.3">s</mi></msup><mo fence="false" maxsize="70%" minsize="70%" rspace="0.167em" id="alg2.l34.m3.1.9">|</mo><msup id="alg2.l34.m3.1.10"><mo fence="false" maxsize="70%" minsize="70%" rspace="0.167em" id="alg2.l34.m3.1.10.2">|</mo><mn mathsize="70%" id="alg2.l34.m3.1.10.3">2</mn></msup><mo maxsize="70%" minsize="70%" id="alg2.l34.m3.1.11">)</mo></mrow><annotation encoding="application/x-tex" id="alg2.l34.m3.1c">)+\frac{\mu}{2}||S-S^{s}||^{2})</annotation></semantics></math><span id="alg2.l34.4" class="ltx_text" style="font-size:70%;">
 
</span>
</div>
<div id="alg2.l35" class="ltx_listingline">
<span id="alg2.l35.1" class="ltx_text" style="font-size:70%;">      </span><math id="alg2.l35.m1.1" class="ltx_Math" alttext="D_{\text{KL}}^{T}\leftarrow D_{\text{KL}}^{T}+D_{\text{KL}}^{T}(u)" display="inline"><semantics id="alg2.l35.m1.1a"><mrow id="alg2.l35.m1.1.2" xref="alg2.l35.m1.1.2.cmml"><msubsup id="alg2.l35.m1.1.2.2" xref="alg2.l35.m1.1.2.2.cmml"><mi mathsize="70%" id="alg2.l35.m1.1.2.2.2.2" xref="alg2.l35.m1.1.2.2.2.2.cmml">D</mi><mtext mathsize="70%" id="alg2.l35.m1.1.2.2.2.3" xref="alg2.l35.m1.1.2.2.2.3a.cmml">KL</mtext><mi mathsize="70%" id="alg2.l35.m1.1.2.2.3" xref="alg2.l35.m1.1.2.2.3.cmml">T</mi></msubsup><mo mathsize="70%" stretchy="false" id="alg2.l35.m1.1.2.1" xref="alg2.l35.m1.1.2.1.cmml">←</mo><mrow id="alg2.l35.m1.1.2.3" xref="alg2.l35.m1.1.2.3.cmml"><msubsup id="alg2.l35.m1.1.2.3.2" xref="alg2.l35.m1.1.2.3.2.cmml"><mi mathsize="70%" id="alg2.l35.m1.1.2.3.2.2.2" xref="alg2.l35.m1.1.2.3.2.2.2.cmml">D</mi><mtext mathsize="70%" id="alg2.l35.m1.1.2.3.2.2.3" xref="alg2.l35.m1.1.2.3.2.2.3a.cmml">KL</mtext><mi mathsize="70%" id="alg2.l35.m1.1.2.3.2.3" xref="alg2.l35.m1.1.2.3.2.3.cmml">T</mi></msubsup><mo mathsize="70%" id="alg2.l35.m1.1.2.3.1" xref="alg2.l35.m1.1.2.3.1.cmml">+</mo><mrow id="alg2.l35.m1.1.2.3.3" xref="alg2.l35.m1.1.2.3.3.cmml"><msubsup id="alg2.l35.m1.1.2.3.3.2" xref="alg2.l35.m1.1.2.3.3.2.cmml"><mi mathsize="70%" id="alg2.l35.m1.1.2.3.3.2.2.2" xref="alg2.l35.m1.1.2.3.3.2.2.2.cmml">D</mi><mtext mathsize="70%" id="alg2.l35.m1.1.2.3.3.2.2.3" xref="alg2.l35.m1.1.2.3.3.2.2.3a.cmml">KL</mtext><mi mathsize="70%" id="alg2.l35.m1.1.2.3.3.2.3" xref="alg2.l35.m1.1.2.3.3.2.3.cmml">T</mi></msubsup><mo lspace="0em" rspace="0em" id="alg2.l35.m1.1.2.3.3.1" xref="alg2.l35.m1.1.2.3.3.1.cmml">​</mo><mrow id="alg2.l35.m1.1.2.3.3.3.2" xref="alg2.l35.m1.1.2.3.3.cmml"><mo maxsize="70%" minsize="70%" id="alg2.l35.m1.1.2.3.3.3.2.1" xref="alg2.l35.m1.1.2.3.3.cmml">(</mo><mi mathsize="70%" id="alg2.l35.m1.1.1" xref="alg2.l35.m1.1.1.cmml">u</mi><mo maxsize="70%" minsize="70%" id="alg2.l35.m1.1.2.3.3.3.2.2" xref="alg2.l35.m1.1.2.3.3.cmml">)</mo></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg2.l35.m1.1b"><apply id="alg2.l35.m1.1.2.cmml" xref="alg2.l35.m1.1.2"><ci id="alg2.l35.m1.1.2.1.cmml" xref="alg2.l35.m1.1.2.1">←</ci><apply id="alg2.l35.m1.1.2.2.cmml" xref="alg2.l35.m1.1.2.2"><csymbol cd="ambiguous" id="alg2.l35.m1.1.2.2.1.cmml" xref="alg2.l35.m1.1.2.2">superscript</csymbol><apply id="alg2.l35.m1.1.2.2.2.cmml" xref="alg2.l35.m1.1.2.2"><csymbol cd="ambiguous" id="alg2.l35.m1.1.2.2.2.1.cmml" xref="alg2.l35.m1.1.2.2">subscript</csymbol><ci id="alg2.l35.m1.1.2.2.2.2.cmml" xref="alg2.l35.m1.1.2.2.2.2">𝐷</ci><ci id="alg2.l35.m1.1.2.2.2.3a.cmml" xref="alg2.l35.m1.1.2.2.2.3"><mtext mathsize="49%" id="alg2.l35.m1.1.2.2.2.3.cmml" xref="alg2.l35.m1.1.2.2.2.3">KL</mtext></ci></apply><ci id="alg2.l35.m1.1.2.2.3.cmml" xref="alg2.l35.m1.1.2.2.3">𝑇</ci></apply><apply id="alg2.l35.m1.1.2.3.cmml" xref="alg2.l35.m1.1.2.3"><plus id="alg2.l35.m1.1.2.3.1.cmml" xref="alg2.l35.m1.1.2.3.1"></plus><apply id="alg2.l35.m1.1.2.3.2.cmml" xref="alg2.l35.m1.1.2.3.2"><csymbol cd="ambiguous" id="alg2.l35.m1.1.2.3.2.1.cmml" xref="alg2.l35.m1.1.2.3.2">superscript</csymbol><apply id="alg2.l35.m1.1.2.3.2.2.cmml" xref="alg2.l35.m1.1.2.3.2"><csymbol cd="ambiguous" id="alg2.l35.m1.1.2.3.2.2.1.cmml" xref="alg2.l35.m1.1.2.3.2">subscript</csymbol><ci id="alg2.l35.m1.1.2.3.2.2.2.cmml" xref="alg2.l35.m1.1.2.3.2.2.2">𝐷</ci><ci id="alg2.l35.m1.1.2.3.2.2.3a.cmml" xref="alg2.l35.m1.1.2.3.2.2.3"><mtext mathsize="49%" id="alg2.l35.m1.1.2.3.2.2.3.cmml" xref="alg2.l35.m1.1.2.3.2.2.3">KL</mtext></ci></apply><ci id="alg2.l35.m1.1.2.3.2.3.cmml" xref="alg2.l35.m1.1.2.3.2.3">𝑇</ci></apply><apply id="alg2.l35.m1.1.2.3.3.cmml" xref="alg2.l35.m1.1.2.3.3"><times id="alg2.l35.m1.1.2.3.3.1.cmml" xref="alg2.l35.m1.1.2.3.3.1"></times><apply id="alg2.l35.m1.1.2.3.3.2.cmml" xref="alg2.l35.m1.1.2.3.3.2"><csymbol cd="ambiguous" id="alg2.l35.m1.1.2.3.3.2.1.cmml" xref="alg2.l35.m1.1.2.3.3.2">superscript</csymbol><apply id="alg2.l35.m1.1.2.3.3.2.2.cmml" xref="alg2.l35.m1.1.2.3.3.2"><csymbol cd="ambiguous" id="alg2.l35.m1.1.2.3.3.2.2.1.cmml" xref="alg2.l35.m1.1.2.3.3.2">subscript</csymbol><ci id="alg2.l35.m1.1.2.3.3.2.2.2.cmml" xref="alg2.l35.m1.1.2.3.3.2.2.2">𝐷</ci><ci id="alg2.l35.m1.1.2.3.3.2.2.3a.cmml" xref="alg2.l35.m1.1.2.3.3.2.2.3"><mtext mathsize="49%" id="alg2.l35.m1.1.2.3.3.2.2.3.cmml" xref="alg2.l35.m1.1.2.3.3.2.2.3">KL</mtext></ci></apply><ci id="alg2.l35.m1.1.2.3.3.2.3.cmml" xref="alg2.l35.m1.1.2.3.3.2.3">𝑇</ci></apply><ci id="alg2.l35.m1.1.1.cmml" xref="alg2.l35.m1.1.1">𝑢</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.l35.m1.1c">D_{\text{KL}}^{T}\leftarrow D_{\text{KL}}^{T}+D_{\text{KL}}^{T}(u)</annotation></semantics></math><span id="alg2.l35.2" class="ltx_text" style="font-size:70%;">
</span>
</div>
<div id="alg2.l36" class="ltx_listingline">
<span id="alg2.l36.1" class="ltx_text" style="font-size:70%;">      </span><math id="alg2.l36.m1.1" class="ltx_Math" alttext="D_{\text{KL}}^{S}\leftarrow D_{\text{KL}}^{S}+D_{\text{KL}}^{S}(u)" display="inline"><semantics id="alg2.l36.m1.1a"><mrow id="alg2.l36.m1.1.2" xref="alg2.l36.m1.1.2.cmml"><msubsup id="alg2.l36.m1.1.2.2" xref="alg2.l36.m1.1.2.2.cmml"><mi mathsize="70%" id="alg2.l36.m1.1.2.2.2.2" xref="alg2.l36.m1.1.2.2.2.2.cmml">D</mi><mtext mathsize="70%" id="alg2.l36.m1.1.2.2.2.3" xref="alg2.l36.m1.1.2.2.2.3a.cmml">KL</mtext><mi mathsize="70%" id="alg2.l36.m1.1.2.2.3" xref="alg2.l36.m1.1.2.2.3.cmml">S</mi></msubsup><mo mathsize="70%" stretchy="false" id="alg2.l36.m1.1.2.1" xref="alg2.l36.m1.1.2.1.cmml">←</mo><mrow id="alg2.l36.m1.1.2.3" xref="alg2.l36.m1.1.2.3.cmml"><msubsup id="alg2.l36.m1.1.2.3.2" xref="alg2.l36.m1.1.2.3.2.cmml"><mi mathsize="70%" id="alg2.l36.m1.1.2.3.2.2.2" xref="alg2.l36.m1.1.2.3.2.2.2.cmml">D</mi><mtext mathsize="70%" id="alg2.l36.m1.1.2.3.2.2.3" xref="alg2.l36.m1.1.2.3.2.2.3a.cmml">KL</mtext><mi mathsize="70%" id="alg2.l36.m1.1.2.3.2.3" xref="alg2.l36.m1.1.2.3.2.3.cmml">S</mi></msubsup><mo mathsize="70%" id="alg2.l36.m1.1.2.3.1" xref="alg2.l36.m1.1.2.3.1.cmml">+</mo><mrow id="alg2.l36.m1.1.2.3.3" xref="alg2.l36.m1.1.2.3.3.cmml"><msubsup id="alg2.l36.m1.1.2.3.3.2" xref="alg2.l36.m1.1.2.3.3.2.cmml"><mi mathsize="70%" id="alg2.l36.m1.1.2.3.3.2.2.2" xref="alg2.l36.m1.1.2.3.3.2.2.2.cmml">D</mi><mtext mathsize="70%" id="alg2.l36.m1.1.2.3.3.2.2.3" xref="alg2.l36.m1.1.2.3.3.2.2.3a.cmml">KL</mtext><mi mathsize="70%" id="alg2.l36.m1.1.2.3.3.2.3" xref="alg2.l36.m1.1.2.3.3.2.3.cmml">S</mi></msubsup><mo lspace="0em" rspace="0em" id="alg2.l36.m1.1.2.3.3.1" xref="alg2.l36.m1.1.2.3.3.1.cmml">​</mo><mrow id="alg2.l36.m1.1.2.3.3.3.2" xref="alg2.l36.m1.1.2.3.3.cmml"><mo maxsize="70%" minsize="70%" id="alg2.l36.m1.1.2.3.3.3.2.1" xref="alg2.l36.m1.1.2.3.3.cmml">(</mo><mi mathsize="70%" id="alg2.l36.m1.1.1" xref="alg2.l36.m1.1.1.cmml">u</mi><mo maxsize="70%" minsize="70%" id="alg2.l36.m1.1.2.3.3.3.2.2" xref="alg2.l36.m1.1.2.3.3.cmml">)</mo></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg2.l36.m1.1b"><apply id="alg2.l36.m1.1.2.cmml" xref="alg2.l36.m1.1.2"><ci id="alg2.l36.m1.1.2.1.cmml" xref="alg2.l36.m1.1.2.1">←</ci><apply id="alg2.l36.m1.1.2.2.cmml" xref="alg2.l36.m1.1.2.2"><csymbol cd="ambiguous" id="alg2.l36.m1.1.2.2.1.cmml" xref="alg2.l36.m1.1.2.2">superscript</csymbol><apply id="alg2.l36.m1.1.2.2.2.cmml" xref="alg2.l36.m1.1.2.2"><csymbol cd="ambiguous" id="alg2.l36.m1.1.2.2.2.1.cmml" xref="alg2.l36.m1.1.2.2">subscript</csymbol><ci id="alg2.l36.m1.1.2.2.2.2.cmml" xref="alg2.l36.m1.1.2.2.2.2">𝐷</ci><ci id="alg2.l36.m1.1.2.2.2.3a.cmml" xref="alg2.l36.m1.1.2.2.2.3"><mtext mathsize="49%" id="alg2.l36.m1.1.2.2.2.3.cmml" xref="alg2.l36.m1.1.2.2.2.3">KL</mtext></ci></apply><ci id="alg2.l36.m1.1.2.2.3.cmml" xref="alg2.l36.m1.1.2.2.3">𝑆</ci></apply><apply id="alg2.l36.m1.1.2.3.cmml" xref="alg2.l36.m1.1.2.3"><plus id="alg2.l36.m1.1.2.3.1.cmml" xref="alg2.l36.m1.1.2.3.1"></plus><apply id="alg2.l36.m1.1.2.3.2.cmml" xref="alg2.l36.m1.1.2.3.2"><csymbol cd="ambiguous" id="alg2.l36.m1.1.2.3.2.1.cmml" xref="alg2.l36.m1.1.2.3.2">superscript</csymbol><apply id="alg2.l36.m1.1.2.3.2.2.cmml" xref="alg2.l36.m1.1.2.3.2"><csymbol cd="ambiguous" id="alg2.l36.m1.1.2.3.2.2.1.cmml" xref="alg2.l36.m1.1.2.3.2">subscript</csymbol><ci id="alg2.l36.m1.1.2.3.2.2.2.cmml" xref="alg2.l36.m1.1.2.3.2.2.2">𝐷</ci><ci id="alg2.l36.m1.1.2.3.2.2.3a.cmml" xref="alg2.l36.m1.1.2.3.2.2.3"><mtext mathsize="49%" id="alg2.l36.m1.1.2.3.2.2.3.cmml" xref="alg2.l36.m1.1.2.3.2.2.3">KL</mtext></ci></apply><ci id="alg2.l36.m1.1.2.3.2.3.cmml" xref="alg2.l36.m1.1.2.3.2.3">𝑆</ci></apply><apply id="alg2.l36.m1.1.2.3.3.cmml" xref="alg2.l36.m1.1.2.3.3"><times id="alg2.l36.m1.1.2.3.3.1.cmml" xref="alg2.l36.m1.1.2.3.3.1"></times><apply id="alg2.l36.m1.1.2.3.3.2.cmml" xref="alg2.l36.m1.1.2.3.3.2"><csymbol cd="ambiguous" id="alg2.l36.m1.1.2.3.3.2.1.cmml" xref="alg2.l36.m1.1.2.3.3.2">superscript</csymbol><apply id="alg2.l36.m1.1.2.3.3.2.2.cmml" xref="alg2.l36.m1.1.2.3.3.2"><csymbol cd="ambiguous" id="alg2.l36.m1.1.2.3.3.2.2.1.cmml" xref="alg2.l36.m1.1.2.3.3.2">subscript</csymbol><ci id="alg2.l36.m1.1.2.3.3.2.2.2.cmml" xref="alg2.l36.m1.1.2.3.3.2.2.2">𝐷</ci><ci id="alg2.l36.m1.1.2.3.3.2.2.3a.cmml" xref="alg2.l36.m1.1.2.3.3.2.2.3"><mtext mathsize="49%" id="alg2.l36.m1.1.2.3.3.2.2.3.cmml" xref="alg2.l36.m1.1.2.3.3.2.2.3">KL</mtext></ci></apply><ci id="alg2.l36.m1.1.2.3.3.2.3.cmml" xref="alg2.l36.m1.1.2.3.3.2.3">𝑆</ci></apply><ci id="alg2.l36.m1.1.1.cmml" xref="alg2.l36.m1.1.1">𝑢</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.l36.m1.1c">D_{\text{KL}}^{S}\leftarrow D_{\text{KL}}^{S}+D_{\text{KL}}^{S}(u)</annotation></semantics></math><span id="alg2.l36.2" class="ltx_text" style="font-size:70%;">
</span>
</div>
<div id="alg2.l37" class="ltx_listingline">
<span id="alg2.l37.1" class="ltx_text" style="font-size:70%;">    </span><span id="alg2.l37.2" class="ltx_text ltx_font_bold" style="font-size:70%;">end</span><span id="alg2.l37.3" class="ltx_text" style="font-size:70%;"> </span><span id="alg2.l37.4" class="ltx_text ltx_font_bold" style="font-size:70%;">for</span>
</div>
<div id="alg2.l38" class="ltx_listingline">
<span id="alg2.l38.1" class="ltx_text" style="font-size:70%;"> </span><span id="alg2.l38.2" class="ltx_text ltx_font_bold" style="font-size:70%;">end</span><span id="alg2.l38.3" class="ltx_text" style="font-size:70%;"> </span><span id="alg2.l38.4" class="ltx_text ltx_font_bold" style="font-size:70%;">for</span>
</div>
<div id="alg2.l39" class="ltx_listingline">
<span id="alg2.l39.1" class="ltx_text" style="font-size:70%;"> return </span><math id="alg2.l39.m1.1" class="ltx_Math" alttext="S" display="inline"><semantics id="alg2.l39.m1.1a"><mi mathsize="70%" id="alg2.l39.m1.1.1" xref="alg2.l39.m1.1.1.cmml">S</mi><annotation-xml encoding="MathML-Content" id="alg2.l39.m1.1b"><ci id="alg2.l39.m1.1.1.cmml" xref="alg2.l39.m1.1.1">𝑆</ci></annotation-xml><annotation encoding="application/x-tex" id="alg2.l39.m1.1c">S</annotation></semantics></math><span id="alg2.l39.2" class="ltx_text" style="font-size:70%;">, </span><math id="alg2.l39.m2.1" class="ltx_Math" alttext="D_{\text{KL}}^{T}" display="inline"><semantics id="alg2.l39.m2.1a"><msubsup id="alg2.l39.m2.1.1" xref="alg2.l39.m2.1.1.cmml"><mi mathsize="70%" id="alg2.l39.m2.1.1.2.2" xref="alg2.l39.m2.1.1.2.2.cmml">D</mi><mtext mathsize="70%" id="alg2.l39.m2.1.1.2.3" xref="alg2.l39.m2.1.1.2.3a.cmml">KL</mtext><mi mathsize="70%" id="alg2.l39.m2.1.1.3" xref="alg2.l39.m2.1.1.3.cmml">T</mi></msubsup><annotation-xml encoding="MathML-Content" id="alg2.l39.m2.1b"><apply id="alg2.l39.m2.1.1.cmml" xref="alg2.l39.m2.1.1"><csymbol cd="ambiguous" id="alg2.l39.m2.1.1.1.cmml" xref="alg2.l39.m2.1.1">superscript</csymbol><apply id="alg2.l39.m2.1.1.2.cmml" xref="alg2.l39.m2.1.1"><csymbol cd="ambiguous" id="alg2.l39.m2.1.1.2.1.cmml" xref="alg2.l39.m2.1.1">subscript</csymbol><ci id="alg2.l39.m2.1.1.2.2.cmml" xref="alg2.l39.m2.1.1.2.2">𝐷</ci><ci id="alg2.l39.m2.1.1.2.3a.cmml" xref="alg2.l39.m2.1.1.2.3"><mtext mathsize="49%" id="alg2.l39.m2.1.1.2.3.cmml" xref="alg2.l39.m2.1.1.2.3">KL</mtext></ci></apply><ci id="alg2.l39.m2.1.1.3.cmml" xref="alg2.l39.m2.1.1.3">𝑇</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.l39.m2.1c">D_{\text{KL}}^{T}</annotation></semantics></math><span id="alg2.l39.3" class="ltx_text" style="font-size:70%;">, </span><math id="alg2.l39.m3.1" class="ltx_Math" alttext="D_{\text{KL}}^{S}" display="inline"><semantics id="alg2.l39.m3.1a"><msubsup id="alg2.l39.m3.1.1" xref="alg2.l39.m3.1.1.cmml"><mi mathsize="70%" id="alg2.l39.m3.1.1.2.2" xref="alg2.l39.m3.1.1.2.2.cmml">D</mi><mtext mathsize="70%" id="alg2.l39.m3.1.1.2.3" xref="alg2.l39.m3.1.1.2.3a.cmml">KL</mtext><mi mathsize="70%" id="alg2.l39.m3.1.1.3" xref="alg2.l39.m3.1.1.3.cmml">S</mi></msubsup><annotation-xml encoding="MathML-Content" id="alg2.l39.m3.1b"><apply id="alg2.l39.m3.1.1.cmml" xref="alg2.l39.m3.1.1"><csymbol cd="ambiguous" id="alg2.l39.m3.1.1.1.cmml" xref="alg2.l39.m3.1.1">superscript</csymbol><apply id="alg2.l39.m3.1.1.2.cmml" xref="alg2.l39.m3.1.1"><csymbol cd="ambiguous" id="alg2.l39.m3.1.1.2.1.cmml" xref="alg2.l39.m3.1.1">subscript</csymbol><ci id="alg2.l39.m3.1.1.2.2.cmml" xref="alg2.l39.m3.1.1.2.2">𝐷</ci><ci id="alg2.l39.m3.1.1.2.3a.cmml" xref="alg2.l39.m3.1.1.2.3"><mtext mathsize="49%" id="alg2.l39.m3.1.1.2.3.cmml" xref="alg2.l39.m3.1.1.2.3">KL</mtext></ci></apply><ci id="alg2.l39.m3.1.1.3.cmml" xref="alg2.l39.m3.1.1.3">𝑆</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.l39.m3.1c">D_{\text{KL}}^{S}</annotation></semantics></math><span id="alg2.l39.4" class="ltx_text" style="font-size:70%;"> to server
</span>
</div>
</div>
<br class="ltx_break ltx_break">
</figure>
</section>
</section>
<section id="S4" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">4 </span>Proposed Method: <span id="S4.1.1" class="ltx_text ltx_font_italic">FedSwitch</span>
</h2>

<div id="S4.p1" class="ltx_para">
<p id="S4.p1.1" class="ltx_p">In this section we describe the proposed <span id="S4.p1.1.1" class="ltx_text ltx_font_italic">FedSwitch</span> approach, which has two main modifications to the TS-Server EMA approach described in Section <a href="#S3.SS3" title="3.3 Practical challenges with EMA models in FL ‣ 3 Preliminaries ‣ When does the student surpass the teacher? Federated Semi-supervised Learning with Teacher-Student EMA" class="ltx_ref"><span class="ltx_text ltx_ref_tag">3.3</span></a>: <span id="S4.p1.1.2" class="ltx_text ltx_font_italic">local teacher adaptation</span> and <span id="S4.p1.1.3" class="ltx_text ltx_font_italic">adaptive switching between teacher and student</span>. We also motivate these modifications and conduct ablation studies to evaluate how these modifications impact generalization performance.</p>
</div>
<div id="S4.p2" class="ltx_para">
<p id="S4.p2.4" class="ltx_p"><span id="S4.p2.4.1" class="ltx_text ltx_font_bold">Local Teacher Adaptation.</span> The TS-Server EMA approach is communication efficient as it does not send two model updates to the server from the <math id="S4.p2.1.m1.1" class="ltx_Math" alttext="k" display="inline"><semantics id="S4.p2.1.m1.1a"><mi id="S4.p2.1.m1.1.1" xref="S4.p2.1.m1.1.1.cmml">k</mi><annotation-xml encoding="MathML-Content" id="S4.p2.1.m1.1b"><ci id="S4.p2.1.m1.1.1.cmml" xref="S4.p2.1.m1.1.1">𝑘</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.p2.1.m1.1c">k</annotation></semantics></math>-th client unlike TS-Client EMA. However the local teacher model <math id="S4.p2.2.m2.1" class="ltx_Math" alttext="T^{k}_{t}" display="inline"><semantics id="S4.p2.2.m2.1a"><msubsup id="S4.p2.2.m2.1.1" xref="S4.p2.2.m2.1.1.cmml"><mi id="S4.p2.2.m2.1.1.2.2" xref="S4.p2.2.m2.1.1.2.2.cmml">T</mi><mi id="S4.p2.2.m2.1.1.3" xref="S4.p2.2.m2.1.1.3.cmml">t</mi><mi id="S4.p2.2.m2.1.1.2.3" xref="S4.p2.2.m2.1.1.2.3.cmml">k</mi></msubsup><annotation-xml encoding="MathML-Content" id="S4.p2.2.m2.1b"><apply id="S4.p2.2.m2.1.1.cmml" xref="S4.p2.2.m2.1.1"><csymbol cd="ambiguous" id="S4.p2.2.m2.1.1.1.cmml" xref="S4.p2.2.m2.1.1">subscript</csymbol><apply id="S4.p2.2.m2.1.1.2.cmml" xref="S4.p2.2.m2.1.1"><csymbol cd="ambiguous" id="S4.p2.2.m2.1.1.2.1.cmml" xref="S4.p2.2.m2.1.1">superscript</csymbol><ci id="S4.p2.2.m2.1.1.2.2.cmml" xref="S4.p2.2.m2.1.1.2.2">𝑇</ci><ci id="S4.p2.2.m2.1.1.2.3.cmml" xref="S4.p2.2.m2.1.1.2.3">𝑘</ci></apply><ci id="S4.p2.2.m2.1.1.3.cmml" xref="S4.p2.2.m2.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.p2.2.m2.1c">T^{k}_{t}</annotation></semantics></math> at each <math id="S4.p2.3.m3.1" class="ltx_Math" alttext="k" display="inline"><semantics id="S4.p2.3.m3.1a"><mi id="S4.p2.3.m3.1.1" xref="S4.p2.3.m3.1.1.cmml">k</mi><annotation-xml encoding="MathML-Content" id="S4.p2.3.m3.1b"><ci id="S4.p2.3.m3.1.1.cmml" xref="S4.p2.3.m3.1.1">𝑘</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.p2.3.m3.1c">k</annotation></semantics></math>-th client is not updated through EMA as the local student model <math id="S4.p2.4.m4.1" class="ltx_Math" alttext="S^{k}_{t}" display="inline"><semantics id="S4.p2.4.m4.1a"><msubsup id="S4.p2.4.m4.1.1" xref="S4.p2.4.m4.1.1.cmml"><mi id="S4.p2.4.m4.1.1.2.2" xref="S4.p2.4.m4.1.1.2.2.cmml">S</mi><mi id="S4.p2.4.m4.1.1.3" xref="S4.p2.4.m4.1.1.3.cmml">t</mi><mi id="S4.p2.4.m4.1.1.2.3" xref="S4.p2.4.m4.1.1.2.3.cmml">k</mi></msubsup><annotation-xml encoding="MathML-Content" id="S4.p2.4.m4.1b"><apply id="S4.p2.4.m4.1.1.cmml" xref="S4.p2.4.m4.1.1"><csymbol cd="ambiguous" id="S4.p2.4.m4.1.1.1.cmml" xref="S4.p2.4.m4.1.1">subscript</csymbol><apply id="S4.p2.4.m4.1.1.2.cmml" xref="S4.p2.4.m4.1.1"><csymbol cd="ambiguous" id="S4.p2.4.m4.1.1.2.1.cmml" xref="S4.p2.4.m4.1.1">superscript</csymbol><ci id="S4.p2.4.m4.1.1.2.2.cmml" xref="S4.p2.4.m4.1.1.2.2">𝑆</ci><ci id="S4.p2.4.m4.1.1.2.3.cmml" xref="S4.p2.4.m4.1.1.2.3">𝑘</ci></apply><ci id="S4.p2.4.m4.1.1.3.cmml" xref="S4.p2.4.m4.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.p2.4.m4.1c">S^{k}_{t}</annotation></semantics></math> is trained on batches of client data. This results in sub-optimal performance, particularly when the prediction distribution of the local teacher differs from the true underlying label distribution on the client. In <span id="S4.p2.4.2" class="ltx_text ltx_font_italic">FedSwitch</span>, we do not send the local teacher updates to the server but continue to update it from the local student with every batch through an EMA update. This enables the teacher model to reap the benefits of EMA smoothing while not increasing the client to server transport cost.</p>
</div>
<div id="S4.p3" class="ltx_para">
<p id="S4.p3.1" class="ltx_p"><span id="S4.p3.1.1" class="ltx_text ltx_font_bold">Adaptive Switching.</span> Practical federated learning settings are often non-IID where the client devices differ from each other in label distribution. The client non-IIDness property is perhaps the best-studied of all constraints <cite class="ltx_cite ltx_citemacro_citep">(Zhu et al., <a href="#bib.bib40" title="" class="ltx_ref">2021</a>)</cite>. Traditional teacher-student methods train the student model on unlabeled data by generating pseudo-labels with the teacher model. The teacher is updated via EMA and can be considered a temporal ensemble of student models, thereby stabilizing and maintaining the quality of the pseudo-labels. However, solely using the teacher to generate pseudo-labels is often sub-optimal in non-IID FL settings.</p>
</div>
<div id="S4.p4" class="ltx_para">
<p id="S4.p4.3" class="ltx_p">In addition to reducing communication costs by only sending the model updates from the student back to the server, in each round, <span id="S4.p4.3.1" class="ltx_text ltx_font_italic">FedSwitch</span> dynamically chooses between using the local teacher or student model to generate pseudo-labels based on an IIDness prior <math id="S4.p4.1.m1.1" class="ltx_Math" alttext="\beta" display="inline"><semantics id="S4.p4.1.m1.1a"><mi id="S4.p4.1.m1.1.1" xref="S4.p4.1.m1.1.1.cmml">β</mi><annotation-xml encoding="MathML-Content" id="S4.p4.1.m1.1b"><ci id="S4.p4.1.m1.1.1.cmml" xref="S4.p4.1.m1.1.1">𝛽</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.p4.1.m1.1c">\beta</annotation></semantics></math>, which is a hyper-parameter that represents the amount of expected imbalance in the client’s unlabeled data. For each unlabeled batch, we calculate the KL-divergence between the generated pseudo-label predictions and an uniform distribution for both the teacher and student model. At the end of each round, the server aggregates the divergences from all participating clients into a global KL-divergence for the teacher and student model respectively. If the teacher’s mean KL-divergence is closer to <math id="S4.p4.2.m2.1" class="ltx_Math" alttext="\beta" display="inline"><semantics id="S4.p4.2.m2.1a"><mi id="S4.p4.2.m2.1.1" xref="S4.p4.2.m2.1.1.cmml">β</mi><annotation-xml encoding="MathML-Content" id="S4.p4.2.m2.1b"><ci id="S4.p4.2.m2.1.1.cmml" xref="S4.p4.2.m2.1.1">𝛽</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.p4.2.m2.1c">\beta</annotation></semantics></math>, both the teacher and student model are sent to clients in the next round, and clients use the teacher model to generate pseudo-labels. If the student’s mean KL-divergence is closer to <math id="S4.p4.3.m3.1" class="ltx_Math" alttext="\beta" display="inline"><semantics id="S4.p4.3.m3.1a"><mi id="S4.p4.3.m3.1.1" xref="S4.p4.3.m3.1.1.cmml">β</mi><annotation-xml encoding="MathML-Content" id="S4.p4.3.m3.1b"><ci id="S4.p4.3.m3.1.1.cmml" xref="S4.p4.3.m3.1.1">𝛽</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.p4.3.m3.1c">\beta</annotation></semantics></math>, only the student model is sent to clients in the next round, and clients use the student model to generate pseudo-labels similar to FedProx-FixMatch. We are using the KL-divergence as a proxy metric for pseudo-label quality.</p>
</div>
<div id="S4.p5" class="ltx_para">
<p id="S4.p5.9" class="ltx_p">We refer to the KL-divergence between probability distribution <math id="S4.p5.1.m1.1" class="ltx_Math" alttext="P" display="inline"><semantics id="S4.p5.1.m1.1a"><mi id="S4.p5.1.m1.1.1" xref="S4.p5.1.m1.1.1.cmml">P</mi><annotation-xml encoding="MathML-Content" id="S4.p5.1.m1.1b"><ci id="S4.p5.1.m1.1.1.cmml" xref="S4.p5.1.m1.1.1">𝑃</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.p5.1.m1.1c">P</annotation></semantics></math> and the discrete uniform distribution <math id="S4.p5.2.m2.1" class="ltx_Math" alttext="\mathcal{U}" display="inline"><semantics id="S4.p5.2.m2.1a"><mi class="ltx_font_mathcaligraphic" id="S4.p5.2.m2.1.1" xref="S4.p5.2.m2.1.1.cmml">𝒰</mi><annotation-xml encoding="MathML-Content" id="S4.p5.2.m2.1b"><ci id="S4.p5.2.m2.1.1.cmml" xref="S4.p5.2.m2.1.1">𝒰</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.p5.2.m2.1c">\mathcal{U}</annotation></semantics></math> over <math id="S4.p5.3.m3.1" class="ltx_Math" alttext="L" display="inline"><semantics id="S4.p5.3.m3.1a"><mi id="S4.p5.3.m3.1.1" xref="S4.p5.3.m3.1.1.cmml">L</mi><annotation-xml encoding="MathML-Content" id="S4.p5.3.m3.1b"><ci id="S4.p5.3.m3.1.1.cmml" xref="S4.p5.3.m3.1.1">𝐿</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.p5.3.m3.1c">L</annotation></semantics></math> labels as <math id="S4.p5.4.m4.1" class="ltx_Math" alttext="D_{KL}(P\parallel\mathcal{U})" display="inline"><semantics id="S4.p5.4.m4.1a"><mrow id="S4.p5.4.m4.1.1" xref="S4.p5.4.m4.1.1.cmml"><msub id="S4.p5.4.m4.1.1.3" xref="S4.p5.4.m4.1.1.3.cmml"><mi id="S4.p5.4.m4.1.1.3.2" xref="S4.p5.4.m4.1.1.3.2.cmml">D</mi><mrow id="S4.p5.4.m4.1.1.3.3" xref="S4.p5.4.m4.1.1.3.3.cmml"><mi id="S4.p5.4.m4.1.1.3.3.2" xref="S4.p5.4.m4.1.1.3.3.2.cmml">K</mi><mo lspace="0em" rspace="0em" id="S4.p5.4.m4.1.1.3.3.1" xref="S4.p5.4.m4.1.1.3.3.1.cmml">​</mo><mi id="S4.p5.4.m4.1.1.3.3.3" xref="S4.p5.4.m4.1.1.3.3.3.cmml">L</mi></mrow></msub><mo lspace="0em" rspace="0em" id="S4.p5.4.m4.1.1.2" xref="S4.p5.4.m4.1.1.2.cmml">​</mo><mrow id="S4.p5.4.m4.1.1.1.1" xref="S4.p5.4.m4.1.1.1.1.1.cmml"><mo stretchy="false" id="S4.p5.4.m4.1.1.1.1.2" xref="S4.p5.4.m4.1.1.1.1.1.cmml">(</mo><mrow id="S4.p5.4.m4.1.1.1.1.1" xref="S4.p5.4.m4.1.1.1.1.1.cmml"><mi id="S4.p5.4.m4.1.1.1.1.1.2" xref="S4.p5.4.m4.1.1.1.1.1.2.cmml">P</mi><mo id="S4.p5.4.m4.1.1.1.1.1.1" xref="S4.p5.4.m4.1.1.1.1.1.1.cmml">∥</mo><mi class="ltx_font_mathcaligraphic" id="S4.p5.4.m4.1.1.1.1.1.3" xref="S4.p5.4.m4.1.1.1.1.1.3.cmml">𝒰</mi></mrow><mo stretchy="false" id="S4.p5.4.m4.1.1.1.1.3" xref="S4.p5.4.m4.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.p5.4.m4.1b"><apply id="S4.p5.4.m4.1.1.cmml" xref="S4.p5.4.m4.1.1"><times id="S4.p5.4.m4.1.1.2.cmml" xref="S4.p5.4.m4.1.1.2"></times><apply id="S4.p5.4.m4.1.1.3.cmml" xref="S4.p5.4.m4.1.1.3"><csymbol cd="ambiguous" id="S4.p5.4.m4.1.1.3.1.cmml" xref="S4.p5.4.m4.1.1.3">subscript</csymbol><ci id="S4.p5.4.m4.1.1.3.2.cmml" xref="S4.p5.4.m4.1.1.3.2">𝐷</ci><apply id="S4.p5.4.m4.1.1.3.3.cmml" xref="S4.p5.4.m4.1.1.3.3"><times id="S4.p5.4.m4.1.1.3.3.1.cmml" xref="S4.p5.4.m4.1.1.3.3.1"></times><ci id="S4.p5.4.m4.1.1.3.3.2.cmml" xref="S4.p5.4.m4.1.1.3.3.2">𝐾</ci><ci id="S4.p5.4.m4.1.1.3.3.3.cmml" xref="S4.p5.4.m4.1.1.3.3.3">𝐿</ci></apply></apply><apply id="S4.p5.4.m4.1.1.1.1.1.cmml" xref="S4.p5.4.m4.1.1.1.1"><csymbol cd="latexml" id="S4.p5.4.m4.1.1.1.1.1.1.cmml" xref="S4.p5.4.m4.1.1.1.1.1.1">conditional</csymbol><ci id="S4.p5.4.m4.1.1.1.1.1.2.cmml" xref="S4.p5.4.m4.1.1.1.1.1.2">𝑃</ci><ci id="S4.p5.4.m4.1.1.1.1.1.3.cmml" xref="S4.p5.4.m4.1.1.1.1.1.3">𝒰</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.p5.4.m4.1c">D_{KL}(P\parallel\mathcal{U})</annotation></semantics></math>. When each client’s <math id="S4.p5.5.m5.1" class="ltx_Math" alttext="l" display="inline"><semantics id="S4.p5.5.m5.1a"><mi id="S4.p5.5.m5.1.1" xref="S4.p5.5.m5.1.1.cmml">l</mi><annotation-xml encoding="MathML-Content" id="S4.p5.5.m5.1b"><ci id="S4.p5.5.m5.1.1.cmml" xref="S4.p5.5.m5.1.1">𝑙</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.p5.5.m5.1c">l</annotation></semantics></math>-th unlabeled batch <math id="S4.p5.6.m6.4" class="ltx_Math" alttext="B_{l}=\{x^{u}_{0},x^{u}_{1},...,x^{u}_{N}\}" display="inline"><semantics id="S4.p5.6.m6.4a"><mrow id="S4.p5.6.m6.4.4" xref="S4.p5.6.m6.4.4.cmml"><msub id="S4.p5.6.m6.4.4.5" xref="S4.p5.6.m6.4.4.5.cmml"><mi id="S4.p5.6.m6.4.4.5.2" xref="S4.p5.6.m6.4.4.5.2.cmml">B</mi><mi id="S4.p5.6.m6.4.4.5.3" xref="S4.p5.6.m6.4.4.5.3.cmml">l</mi></msub><mo id="S4.p5.6.m6.4.4.4" xref="S4.p5.6.m6.4.4.4.cmml">=</mo><mrow id="S4.p5.6.m6.4.4.3.3" xref="S4.p5.6.m6.4.4.3.4.cmml"><mo stretchy="false" id="S4.p5.6.m6.4.4.3.3.4" xref="S4.p5.6.m6.4.4.3.4.cmml">{</mo><msubsup id="S4.p5.6.m6.2.2.1.1.1" xref="S4.p5.6.m6.2.2.1.1.1.cmml"><mi id="S4.p5.6.m6.2.2.1.1.1.2.2" xref="S4.p5.6.m6.2.2.1.1.1.2.2.cmml">x</mi><mn id="S4.p5.6.m6.2.2.1.1.1.3" xref="S4.p5.6.m6.2.2.1.1.1.3.cmml">0</mn><mi id="S4.p5.6.m6.2.2.1.1.1.2.3" xref="S4.p5.6.m6.2.2.1.1.1.2.3.cmml">u</mi></msubsup><mo id="S4.p5.6.m6.4.4.3.3.5" xref="S4.p5.6.m6.4.4.3.4.cmml">,</mo><msubsup id="S4.p5.6.m6.3.3.2.2.2" xref="S4.p5.6.m6.3.3.2.2.2.cmml"><mi id="S4.p5.6.m6.3.3.2.2.2.2.2" xref="S4.p5.6.m6.3.3.2.2.2.2.2.cmml">x</mi><mn id="S4.p5.6.m6.3.3.2.2.2.3" xref="S4.p5.6.m6.3.3.2.2.2.3.cmml">1</mn><mi id="S4.p5.6.m6.3.3.2.2.2.2.3" xref="S4.p5.6.m6.3.3.2.2.2.2.3.cmml">u</mi></msubsup><mo id="S4.p5.6.m6.4.4.3.3.6" xref="S4.p5.6.m6.4.4.3.4.cmml">,</mo><mi mathvariant="normal" id="S4.p5.6.m6.1.1" xref="S4.p5.6.m6.1.1.cmml">…</mi><mo id="S4.p5.6.m6.4.4.3.3.7" xref="S4.p5.6.m6.4.4.3.4.cmml">,</mo><msubsup id="S4.p5.6.m6.4.4.3.3.3" xref="S4.p5.6.m6.4.4.3.3.3.cmml"><mi id="S4.p5.6.m6.4.4.3.3.3.2.2" xref="S4.p5.6.m6.4.4.3.3.3.2.2.cmml">x</mi><mi id="S4.p5.6.m6.4.4.3.3.3.3" xref="S4.p5.6.m6.4.4.3.3.3.3.cmml">N</mi><mi id="S4.p5.6.m6.4.4.3.3.3.2.3" xref="S4.p5.6.m6.4.4.3.3.3.2.3.cmml">u</mi></msubsup><mo stretchy="false" id="S4.p5.6.m6.4.4.3.3.8" xref="S4.p5.6.m6.4.4.3.4.cmml">}</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.p5.6.m6.4b"><apply id="S4.p5.6.m6.4.4.cmml" xref="S4.p5.6.m6.4.4"><eq id="S4.p5.6.m6.4.4.4.cmml" xref="S4.p5.6.m6.4.4.4"></eq><apply id="S4.p5.6.m6.4.4.5.cmml" xref="S4.p5.6.m6.4.4.5"><csymbol cd="ambiguous" id="S4.p5.6.m6.4.4.5.1.cmml" xref="S4.p5.6.m6.4.4.5">subscript</csymbol><ci id="S4.p5.6.m6.4.4.5.2.cmml" xref="S4.p5.6.m6.4.4.5.2">𝐵</ci><ci id="S4.p5.6.m6.4.4.5.3.cmml" xref="S4.p5.6.m6.4.4.5.3">𝑙</ci></apply><set id="S4.p5.6.m6.4.4.3.4.cmml" xref="S4.p5.6.m6.4.4.3.3"><apply id="S4.p5.6.m6.2.2.1.1.1.cmml" xref="S4.p5.6.m6.2.2.1.1.1"><csymbol cd="ambiguous" id="S4.p5.6.m6.2.2.1.1.1.1.cmml" xref="S4.p5.6.m6.2.2.1.1.1">subscript</csymbol><apply id="S4.p5.6.m6.2.2.1.1.1.2.cmml" xref="S4.p5.6.m6.2.2.1.1.1"><csymbol cd="ambiguous" id="S4.p5.6.m6.2.2.1.1.1.2.1.cmml" xref="S4.p5.6.m6.2.2.1.1.1">superscript</csymbol><ci id="S4.p5.6.m6.2.2.1.1.1.2.2.cmml" xref="S4.p5.6.m6.2.2.1.1.1.2.2">𝑥</ci><ci id="S4.p5.6.m6.2.2.1.1.1.2.3.cmml" xref="S4.p5.6.m6.2.2.1.1.1.2.3">𝑢</ci></apply><cn type="integer" id="S4.p5.6.m6.2.2.1.1.1.3.cmml" xref="S4.p5.6.m6.2.2.1.1.1.3">0</cn></apply><apply id="S4.p5.6.m6.3.3.2.2.2.cmml" xref="S4.p5.6.m6.3.3.2.2.2"><csymbol cd="ambiguous" id="S4.p5.6.m6.3.3.2.2.2.1.cmml" xref="S4.p5.6.m6.3.3.2.2.2">subscript</csymbol><apply id="S4.p5.6.m6.3.3.2.2.2.2.cmml" xref="S4.p5.6.m6.3.3.2.2.2"><csymbol cd="ambiguous" id="S4.p5.6.m6.3.3.2.2.2.2.1.cmml" xref="S4.p5.6.m6.3.3.2.2.2">superscript</csymbol><ci id="S4.p5.6.m6.3.3.2.2.2.2.2.cmml" xref="S4.p5.6.m6.3.3.2.2.2.2.2">𝑥</ci><ci id="S4.p5.6.m6.3.3.2.2.2.2.3.cmml" xref="S4.p5.6.m6.3.3.2.2.2.2.3">𝑢</ci></apply><cn type="integer" id="S4.p5.6.m6.3.3.2.2.2.3.cmml" xref="S4.p5.6.m6.3.3.2.2.2.3">1</cn></apply><ci id="S4.p5.6.m6.1.1.cmml" xref="S4.p5.6.m6.1.1">…</ci><apply id="S4.p5.6.m6.4.4.3.3.3.cmml" xref="S4.p5.6.m6.4.4.3.3.3"><csymbol cd="ambiguous" id="S4.p5.6.m6.4.4.3.3.3.1.cmml" xref="S4.p5.6.m6.4.4.3.3.3">subscript</csymbol><apply id="S4.p5.6.m6.4.4.3.3.3.2.cmml" xref="S4.p5.6.m6.4.4.3.3.3"><csymbol cd="ambiguous" id="S4.p5.6.m6.4.4.3.3.3.2.1.cmml" xref="S4.p5.6.m6.4.4.3.3.3">superscript</csymbol><ci id="S4.p5.6.m6.4.4.3.3.3.2.2.cmml" xref="S4.p5.6.m6.4.4.3.3.3.2.2">𝑥</ci><ci id="S4.p5.6.m6.4.4.3.3.3.2.3.cmml" xref="S4.p5.6.m6.4.4.3.3.3.2.3">𝑢</ci></apply><ci id="S4.p5.6.m6.4.4.3.3.3.3.cmml" xref="S4.p5.6.m6.4.4.3.3.3.3">𝑁</ci></apply></set></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.p5.6.m6.4c">B_{l}=\{x^{u}_{0},x^{u}_{1},...,x^{u}_{N}\}</annotation></semantics></math> contains <math id="S4.p5.7.m7.1" class="ltx_Math" alttext="N" display="inline"><semantics id="S4.p5.7.m7.1a"><mi id="S4.p5.7.m7.1.1" xref="S4.p5.7.m7.1.1.cmml">N</mi><annotation-xml encoding="MathML-Content" id="S4.p5.7.m7.1b"><ci id="S4.p5.7.m7.1.1.cmml" xref="S4.p5.7.m7.1.1">𝑁</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.p5.7.m7.1c">N</annotation></semantics></math> examples, we calculate the KL-divergence of both the teacher’s prediction distribution <math id="S4.p5.8.m8.1" class="ltx_Math" alttext="\hat{Y}^{T}_{l}" display="inline"><semantics id="S4.p5.8.m8.1a"><msubsup id="S4.p5.8.m8.1.1" xref="S4.p5.8.m8.1.1.cmml"><mover accent="true" id="S4.p5.8.m8.1.1.2.2" xref="S4.p5.8.m8.1.1.2.2.cmml"><mi id="S4.p5.8.m8.1.1.2.2.2" xref="S4.p5.8.m8.1.1.2.2.2.cmml">Y</mi><mo id="S4.p5.8.m8.1.1.2.2.1" xref="S4.p5.8.m8.1.1.2.2.1.cmml">^</mo></mover><mi id="S4.p5.8.m8.1.1.3" xref="S4.p5.8.m8.1.1.3.cmml">l</mi><mi id="S4.p5.8.m8.1.1.2.3" xref="S4.p5.8.m8.1.1.2.3.cmml">T</mi></msubsup><annotation-xml encoding="MathML-Content" id="S4.p5.8.m8.1b"><apply id="S4.p5.8.m8.1.1.cmml" xref="S4.p5.8.m8.1.1"><csymbol cd="ambiguous" id="S4.p5.8.m8.1.1.1.cmml" xref="S4.p5.8.m8.1.1">subscript</csymbol><apply id="S4.p5.8.m8.1.1.2.cmml" xref="S4.p5.8.m8.1.1"><csymbol cd="ambiguous" id="S4.p5.8.m8.1.1.2.1.cmml" xref="S4.p5.8.m8.1.1">superscript</csymbol><apply id="S4.p5.8.m8.1.1.2.2.cmml" xref="S4.p5.8.m8.1.1.2.2"><ci id="S4.p5.8.m8.1.1.2.2.1.cmml" xref="S4.p5.8.m8.1.1.2.2.1">^</ci><ci id="S4.p5.8.m8.1.1.2.2.2.cmml" xref="S4.p5.8.m8.1.1.2.2.2">𝑌</ci></apply><ci id="S4.p5.8.m8.1.1.2.3.cmml" xref="S4.p5.8.m8.1.1.2.3">𝑇</ci></apply><ci id="S4.p5.8.m8.1.1.3.cmml" xref="S4.p5.8.m8.1.1.3">𝑙</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.p5.8.m8.1c">\hat{Y}^{T}_{l}</annotation></semantics></math> on weakly augmented data and the student’s prediction distribution <math id="S4.p5.9.m9.1" class="ltx_Math" alttext="\hat{Y}^{S}_{l}" display="inline"><semantics id="S4.p5.9.m9.1a"><msubsup id="S4.p5.9.m9.1.1" xref="S4.p5.9.m9.1.1.cmml"><mover accent="true" id="S4.p5.9.m9.1.1.2.2" xref="S4.p5.9.m9.1.1.2.2.cmml"><mi id="S4.p5.9.m9.1.1.2.2.2" xref="S4.p5.9.m9.1.1.2.2.2.cmml">Y</mi><mo id="S4.p5.9.m9.1.1.2.2.1" xref="S4.p5.9.m9.1.1.2.2.1.cmml">^</mo></mover><mi id="S4.p5.9.m9.1.1.3" xref="S4.p5.9.m9.1.1.3.cmml">l</mi><mi id="S4.p5.9.m9.1.1.2.3" xref="S4.p5.9.m9.1.1.2.3.cmml">S</mi></msubsup><annotation-xml encoding="MathML-Content" id="S4.p5.9.m9.1b"><apply id="S4.p5.9.m9.1.1.cmml" xref="S4.p5.9.m9.1.1"><csymbol cd="ambiguous" id="S4.p5.9.m9.1.1.1.cmml" xref="S4.p5.9.m9.1.1">subscript</csymbol><apply id="S4.p5.9.m9.1.1.2.cmml" xref="S4.p5.9.m9.1.1"><csymbol cd="ambiguous" id="S4.p5.9.m9.1.1.2.1.cmml" xref="S4.p5.9.m9.1.1">superscript</csymbol><apply id="S4.p5.9.m9.1.1.2.2.cmml" xref="S4.p5.9.m9.1.1.2.2"><ci id="S4.p5.9.m9.1.1.2.2.1.cmml" xref="S4.p5.9.m9.1.1.2.2.1">^</ci><ci id="S4.p5.9.m9.1.1.2.2.2.cmml" xref="S4.p5.9.m9.1.1.2.2.2">𝑌</ci></apply><ci id="S4.p5.9.m9.1.1.2.3.cmml" xref="S4.p5.9.m9.1.1.2.3">𝑆</ci></apply><ci id="S4.p5.9.m9.1.1.3.cmml" xref="S4.p5.9.m9.1.1.3">𝑙</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.p5.9.m9.1c">\hat{Y}^{S}_{l}</annotation></semantics></math> on strongly augmented data.</p>
<table id="S7.EGx1" class="ltx_equationgroup ltx_eqn_align ltx_eqn_table">

<tbody id="S4.E2"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math id="S4.E2.m1.1" class="ltx_Math" alttext="\displaystyle D_{\text{KL}}^{m}" display="inline"><semantics id="S4.E2.m1.1a"><msubsup id="S4.E2.m1.1.1" xref="S4.E2.m1.1.1.cmml"><mi id="S4.E2.m1.1.1.2.2" xref="S4.E2.m1.1.1.2.2.cmml">D</mi><mtext id="S4.E2.m1.1.1.2.3" xref="S4.E2.m1.1.1.2.3a.cmml">KL</mtext><mi id="S4.E2.m1.1.1.3" xref="S4.E2.m1.1.1.3.cmml">m</mi></msubsup><annotation-xml encoding="MathML-Content" id="S4.E2.m1.1b"><apply id="S4.E2.m1.1.1.cmml" xref="S4.E2.m1.1.1"><csymbol cd="ambiguous" id="S4.E2.m1.1.1.1.cmml" xref="S4.E2.m1.1.1">superscript</csymbol><apply id="S4.E2.m1.1.1.2.cmml" xref="S4.E2.m1.1.1"><csymbol cd="ambiguous" id="S4.E2.m1.1.1.2.1.cmml" xref="S4.E2.m1.1.1">subscript</csymbol><ci id="S4.E2.m1.1.1.2.2.cmml" xref="S4.E2.m1.1.1.2.2">𝐷</ci><ci id="S4.E2.m1.1.1.2.3a.cmml" xref="S4.E2.m1.1.1.2.3"><mtext mathsize="70%" id="S4.E2.m1.1.1.2.3.cmml" xref="S4.E2.m1.1.1.2.3">KL</mtext></ci></apply><ci id="S4.E2.m1.1.1.3.cmml" xref="S4.E2.m1.1.1.3">𝑚</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.E2.m1.1c">\displaystyle D_{\text{KL}}^{m}</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math id="S4.E2.m2.1" class="ltx_Math" alttext="\displaystyle=\frac{1}{L}\sum_{l}D_{\text{KL}}(\hat{Y}^{m}_{l}\parallel\mathcal{U})" display="inline"><semantics id="S4.E2.m2.1a"><mrow id="S4.E2.m2.1.1" xref="S4.E2.m2.1.1.cmml"><mi id="S4.E2.m2.1.1.3" xref="S4.E2.m2.1.1.3.cmml"></mi><mo id="S4.E2.m2.1.1.2" xref="S4.E2.m2.1.1.2.cmml">=</mo><mrow id="S4.E2.m2.1.1.1" xref="S4.E2.m2.1.1.1.cmml"><mstyle displaystyle="true" id="S4.E2.m2.1.1.1.3" xref="S4.E2.m2.1.1.1.3.cmml"><mfrac id="S4.E2.m2.1.1.1.3a" xref="S4.E2.m2.1.1.1.3.cmml"><mn id="S4.E2.m2.1.1.1.3.2" xref="S4.E2.m2.1.1.1.3.2.cmml">1</mn><mi id="S4.E2.m2.1.1.1.3.3" xref="S4.E2.m2.1.1.1.3.3.cmml">L</mi></mfrac></mstyle><mo lspace="0em" rspace="0em" id="S4.E2.m2.1.1.1.2" xref="S4.E2.m2.1.1.1.2.cmml">​</mo><mrow id="S4.E2.m2.1.1.1.1" xref="S4.E2.m2.1.1.1.1.cmml"><mstyle displaystyle="true" id="S4.E2.m2.1.1.1.1.2" xref="S4.E2.m2.1.1.1.1.2.cmml"><munder id="S4.E2.m2.1.1.1.1.2a" xref="S4.E2.m2.1.1.1.1.2.cmml"><mo movablelimits="false" id="S4.E2.m2.1.1.1.1.2.2" xref="S4.E2.m2.1.1.1.1.2.2.cmml">∑</mo><mi id="S4.E2.m2.1.1.1.1.2.3" xref="S4.E2.m2.1.1.1.1.2.3.cmml">l</mi></munder></mstyle><mrow id="S4.E2.m2.1.1.1.1.1" xref="S4.E2.m2.1.1.1.1.1.cmml"><msub id="S4.E2.m2.1.1.1.1.1.3" xref="S4.E2.m2.1.1.1.1.1.3.cmml"><mi id="S4.E2.m2.1.1.1.1.1.3.2" xref="S4.E2.m2.1.1.1.1.1.3.2.cmml">D</mi><mtext id="S4.E2.m2.1.1.1.1.1.3.3" xref="S4.E2.m2.1.1.1.1.1.3.3a.cmml">KL</mtext></msub><mo lspace="0em" rspace="0em" id="S4.E2.m2.1.1.1.1.1.2" xref="S4.E2.m2.1.1.1.1.1.2.cmml">​</mo><mrow id="S4.E2.m2.1.1.1.1.1.1.1" xref="S4.E2.m2.1.1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S4.E2.m2.1.1.1.1.1.1.1.2" xref="S4.E2.m2.1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="S4.E2.m2.1.1.1.1.1.1.1.1" xref="S4.E2.m2.1.1.1.1.1.1.1.1.cmml"><msubsup id="S4.E2.m2.1.1.1.1.1.1.1.1.2" xref="S4.E2.m2.1.1.1.1.1.1.1.1.2.cmml"><mover accent="true" id="S4.E2.m2.1.1.1.1.1.1.1.1.2.2.2" xref="S4.E2.m2.1.1.1.1.1.1.1.1.2.2.2.cmml"><mi id="S4.E2.m2.1.1.1.1.1.1.1.1.2.2.2.2" xref="S4.E2.m2.1.1.1.1.1.1.1.1.2.2.2.2.cmml">Y</mi><mo id="S4.E2.m2.1.1.1.1.1.1.1.1.2.2.2.1" xref="S4.E2.m2.1.1.1.1.1.1.1.1.2.2.2.1.cmml">^</mo></mover><mi id="S4.E2.m2.1.1.1.1.1.1.1.1.2.3" xref="S4.E2.m2.1.1.1.1.1.1.1.1.2.3.cmml">l</mi><mi id="S4.E2.m2.1.1.1.1.1.1.1.1.2.2.3" xref="S4.E2.m2.1.1.1.1.1.1.1.1.2.2.3.cmml">m</mi></msubsup><mo id="S4.E2.m2.1.1.1.1.1.1.1.1.1" xref="S4.E2.m2.1.1.1.1.1.1.1.1.1.cmml">∥</mo><mi class="ltx_font_mathcaligraphic" id="S4.E2.m2.1.1.1.1.1.1.1.1.3" xref="S4.E2.m2.1.1.1.1.1.1.1.1.3.cmml">𝒰</mi></mrow><mo stretchy="false" id="S4.E2.m2.1.1.1.1.1.1.1.3" xref="S4.E2.m2.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.E2.m2.1b"><apply id="S4.E2.m2.1.1.cmml" xref="S4.E2.m2.1.1"><eq id="S4.E2.m2.1.1.2.cmml" xref="S4.E2.m2.1.1.2"></eq><csymbol cd="latexml" id="S4.E2.m2.1.1.3.cmml" xref="S4.E2.m2.1.1.3">absent</csymbol><apply id="S4.E2.m2.1.1.1.cmml" xref="S4.E2.m2.1.1.1"><times id="S4.E2.m2.1.1.1.2.cmml" xref="S4.E2.m2.1.1.1.2"></times><apply id="S4.E2.m2.1.1.1.3.cmml" xref="S4.E2.m2.1.1.1.3"><divide id="S4.E2.m2.1.1.1.3.1.cmml" xref="S4.E2.m2.1.1.1.3"></divide><cn type="integer" id="S4.E2.m2.1.1.1.3.2.cmml" xref="S4.E2.m2.1.1.1.3.2">1</cn><ci id="S4.E2.m2.1.1.1.3.3.cmml" xref="S4.E2.m2.1.1.1.3.3">𝐿</ci></apply><apply id="S4.E2.m2.1.1.1.1.cmml" xref="S4.E2.m2.1.1.1.1"><apply id="S4.E2.m2.1.1.1.1.2.cmml" xref="S4.E2.m2.1.1.1.1.2"><csymbol cd="ambiguous" id="S4.E2.m2.1.1.1.1.2.1.cmml" xref="S4.E2.m2.1.1.1.1.2">subscript</csymbol><sum id="S4.E2.m2.1.1.1.1.2.2.cmml" xref="S4.E2.m2.1.1.1.1.2.2"></sum><ci id="S4.E2.m2.1.1.1.1.2.3.cmml" xref="S4.E2.m2.1.1.1.1.2.3">𝑙</ci></apply><apply id="S4.E2.m2.1.1.1.1.1.cmml" xref="S4.E2.m2.1.1.1.1.1"><times id="S4.E2.m2.1.1.1.1.1.2.cmml" xref="S4.E2.m2.1.1.1.1.1.2"></times><apply id="S4.E2.m2.1.1.1.1.1.3.cmml" xref="S4.E2.m2.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S4.E2.m2.1.1.1.1.1.3.1.cmml" xref="S4.E2.m2.1.1.1.1.1.3">subscript</csymbol><ci id="S4.E2.m2.1.1.1.1.1.3.2.cmml" xref="S4.E2.m2.1.1.1.1.1.3.2">𝐷</ci><ci id="S4.E2.m2.1.1.1.1.1.3.3a.cmml" xref="S4.E2.m2.1.1.1.1.1.3.3"><mtext mathsize="70%" id="S4.E2.m2.1.1.1.1.1.3.3.cmml" xref="S4.E2.m2.1.1.1.1.1.3.3">KL</mtext></ci></apply><apply id="S4.E2.m2.1.1.1.1.1.1.1.1.cmml" xref="S4.E2.m2.1.1.1.1.1.1.1"><csymbol cd="latexml" id="S4.E2.m2.1.1.1.1.1.1.1.1.1.cmml" xref="S4.E2.m2.1.1.1.1.1.1.1.1.1">conditional</csymbol><apply id="S4.E2.m2.1.1.1.1.1.1.1.1.2.cmml" xref="S4.E2.m2.1.1.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S4.E2.m2.1.1.1.1.1.1.1.1.2.1.cmml" xref="S4.E2.m2.1.1.1.1.1.1.1.1.2">subscript</csymbol><apply id="S4.E2.m2.1.1.1.1.1.1.1.1.2.2.cmml" xref="S4.E2.m2.1.1.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S4.E2.m2.1.1.1.1.1.1.1.1.2.2.1.cmml" xref="S4.E2.m2.1.1.1.1.1.1.1.1.2">superscript</csymbol><apply id="S4.E2.m2.1.1.1.1.1.1.1.1.2.2.2.cmml" xref="S4.E2.m2.1.1.1.1.1.1.1.1.2.2.2"><ci id="S4.E2.m2.1.1.1.1.1.1.1.1.2.2.2.1.cmml" xref="S4.E2.m2.1.1.1.1.1.1.1.1.2.2.2.1">^</ci><ci id="S4.E2.m2.1.1.1.1.1.1.1.1.2.2.2.2.cmml" xref="S4.E2.m2.1.1.1.1.1.1.1.1.2.2.2.2">𝑌</ci></apply><ci id="S4.E2.m2.1.1.1.1.1.1.1.1.2.2.3.cmml" xref="S4.E2.m2.1.1.1.1.1.1.1.1.2.2.3">𝑚</ci></apply><ci id="S4.E2.m2.1.1.1.1.1.1.1.1.2.3.cmml" xref="S4.E2.m2.1.1.1.1.1.1.1.1.2.3">𝑙</ci></apply><ci id="S4.E2.m2.1.1.1.1.1.1.1.1.3.cmml" xref="S4.E2.m2.1.1.1.1.1.1.1.1.3">𝒰</ci></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.E2.m2.1c">\displaystyle=\frac{1}{L}\sum_{l}D_{\text{KL}}(\hat{Y}^{m}_{l}\parallel\mathcal{U})</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(2)</span></td>
</tr></tbody>
</table>
<p id="S4.p5.14" class="ltx_p">where <math id="S4.p5.10.m1.2" class="ltx_Math" alttext="m\in\{T,S\}" display="inline"><semantics id="S4.p5.10.m1.2a"><mrow id="S4.p5.10.m1.2.3" xref="S4.p5.10.m1.2.3.cmml"><mi id="S4.p5.10.m1.2.3.2" xref="S4.p5.10.m1.2.3.2.cmml">m</mi><mo id="S4.p5.10.m1.2.3.1" xref="S4.p5.10.m1.2.3.1.cmml">∈</mo><mrow id="S4.p5.10.m1.2.3.3.2" xref="S4.p5.10.m1.2.3.3.1.cmml"><mo stretchy="false" id="S4.p5.10.m1.2.3.3.2.1" xref="S4.p5.10.m1.2.3.3.1.cmml">{</mo><mi id="S4.p5.10.m1.1.1" xref="S4.p5.10.m1.1.1.cmml">T</mi><mo id="S4.p5.10.m1.2.3.3.2.2" xref="S4.p5.10.m1.2.3.3.1.cmml">,</mo><mi id="S4.p5.10.m1.2.2" xref="S4.p5.10.m1.2.2.cmml">S</mi><mo stretchy="false" id="S4.p5.10.m1.2.3.3.2.3" xref="S4.p5.10.m1.2.3.3.1.cmml">}</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.p5.10.m1.2b"><apply id="S4.p5.10.m1.2.3.cmml" xref="S4.p5.10.m1.2.3"><in id="S4.p5.10.m1.2.3.1.cmml" xref="S4.p5.10.m1.2.3.1"></in><ci id="S4.p5.10.m1.2.3.2.cmml" xref="S4.p5.10.m1.2.3.2">𝑚</ci><set id="S4.p5.10.m1.2.3.3.1.cmml" xref="S4.p5.10.m1.2.3.3.2"><ci id="S4.p5.10.m1.1.1.cmml" xref="S4.p5.10.m1.1.1">𝑇</ci><ci id="S4.p5.10.m1.2.2.cmml" xref="S4.p5.10.m1.2.2">𝑆</ci></set></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.p5.10.m1.2c">m\in\{T,S\}</annotation></semantics></math>, <math id="S4.p5.11.m2.1" class="ltx_Math" alttext="\hat{Y}^{m}_{l}" display="inline"><semantics id="S4.p5.11.m2.1a"><msubsup id="S4.p5.11.m2.1.1" xref="S4.p5.11.m2.1.1.cmml"><mover accent="true" id="S4.p5.11.m2.1.1.2.2" xref="S4.p5.11.m2.1.1.2.2.cmml"><mi id="S4.p5.11.m2.1.1.2.2.2" xref="S4.p5.11.m2.1.1.2.2.2.cmml">Y</mi><mo id="S4.p5.11.m2.1.1.2.2.1" xref="S4.p5.11.m2.1.1.2.2.1.cmml">^</mo></mover><mi id="S4.p5.11.m2.1.1.3" xref="S4.p5.11.m2.1.1.3.cmml">l</mi><mi id="S4.p5.11.m2.1.1.2.3" xref="S4.p5.11.m2.1.1.2.3.cmml">m</mi></msubsup><annotation-xml encoding="MathML-Content" id="S4.p5.11.m2.1b"><apply id="S4.p5.11.m2.1.1.cmml" xref="S4.p5.11.m2.1.1"><csymbol cd="ambiguous" id="S4.p5.11.m2.1.1.1.cmml" xref="S4.p5.11.m2.1.1">subscript</csymbol><apply id="S4.p5.11.m2.1.1.2.cmml" xref="S4.p5.11.m2.1.1"><csymbol cd="ambiguous" id="S4.p5.11.m2.1.1.2.1.cmml" xref="S4.p5.11.m2.1.1">superscript</csymbol><apply id="S4.p5.11.m2.1.1.2.2.cmml" xref="S4.p5.11.m2.1.1.2.2"><ci id="S4.p5.11.m2.1.1.2.2.1.cmml" xref="S4.p5.11.m2.1.1.2.2.1">^</ci><ci id="S4.p5.11.m2.1.1.2.2.2.cmml" xref="S4.p5.11.m2.1.1.2.2.2">𝑌</ci></apply><ci id="S4.p5.11.m2.1.1.2.3.cmml" xref="S4.p5.11.m2.1.1.2.3">𝑚</ci></apply><ci id="S4.p5.11.m2.1.1.3.cmml" xref="S4.p5.11.m2.1.1.3">𝑙</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.p5.11.m2.1c">\hat{Y}^{m}_{l}</annotation></semantics></math> is the distribution of predictions generated via model <math id="S4.p5.12.m3.1" class="ltx_Math" alttext="m" display="inline"><semantics id="S4.p5.12.m3.1a"><mi id="S4.p5.12.m3.1.1" xref="S4.p5.12.m3.1.1.cmml">m</mi><annotation-xml encoding="MathML-Content" id="S4.p5.12.m3.1b"><ci id="S4.p5.12.m3.1.1.cmml" xref="S4.p5.12.m3.1.1">𝑚</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.p5.12.m3.1c">m</annotation></semantics></math> on batch <math id="S4.p5.13.m4.1" class="ltx_Math" alttext="B_{l}" display="inline"><semantics id="S4.p5.13.m4.1a"><msub id="S4.p5.13.m4.1.1" xref="S4.p5.13.m4.1.1.cmml"><mi id="S4.p5.13.m4.1.1.2" xref="S4.p5.13.m4.1.1.2.cmml">B</mi><mi id="S4.p5.13.m4.1.1.3" xref="S4.p5.13.m4.1.1.3.cmml">l</mi></msub><annotation-xml encoding="MathML-Content" id="S4.p5.13.m4.1b"><apply id="S4.p5.13.m4.1.1.cmml" xref="S4.p5.13.m4.1.1"><csymbol cd="ambiguous" id="S4.p5.13.m4.1.1.1.cmml" xref="S4.p5.13.m4.1.1">subscript</csymbol><ci id="S4.p5.13.m4.1.1.2.cmml" xref="S4.p5.13.m4.1.1.2">𝐵</ci><ci id="S4.p5.13.m4.1.1.3.cmml" xref="S4.p5.13.m4.1.1.3">𝑙</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.p5.13.m4.1c">B_{l}</annotation></semantics></math> of unlabeled data. <math id="S4.p5.14.m5.1" class="ltx_Math" alttext="L" display="inline"><semantics id="S4.p5.14.m5.1a"><mi id="S4.p5.14.m5.1.1" xref="S4.p5.14.m5.1.1.cmml">L</mi><annotation-xml encoding="MathML-Content" id="S4.p5.14.m5.1b"><ci id="S4.p5.14.m5.1.1.cmml" xref="S4.p5.14.m5.1.1">𝐿</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.p5.14.m5.1c">L</annotation></semantics></math> denotes the number of unlabeled batches on the client.</p>
</div>
<div id="S4.p6" class="ltx_para">
<p id="S4.p6.3" class="ltx_p">Based on the current round’s averaged <math id="S4.p6.1.m1.1" class="ltx_Math" alttext="D_{\text{KL}}^{T}" display="inline"><semantics id="S4.p6.1.m1.1a"><msubsup id="S4.p6.1.m1.1.1" xref="S4.p6.1.m1.1.1.cmml"><mi id="S4.p6.1.m1.1.1.2.2" xref="S4.p6.1.m1.1.1.2.2.cmml">D</mi><mtext id="S4.p6.1.m1.1.1.2.3" xref="S4.p6.1.m1.1.1.2.3a.cmml">KL</mtext><mi id="S4.p6.1.m1.1.1.3" xref="S4.p6.1.m1.1.1.3.cmml">T</mi></msubsup><annotation-xml encoding="MathML-Content" id="S4.p6.1.m1.1b"><apply id="S4.p6.1.m1.1.1.cmml" xref="S4.p6.1.m1.1.1"><csymbol cd="ambiguous" id="S4.p6.1.m1.1.1.1.cmml" xref="S4.p6.1.m1.1.1">superscript</csymbol><apply id="S4.p6.1.m1.1.1.2.cmml" xref="S4.p6.1.m1.1.1"><csymbol cd="ambiguous" id="S4.p6.1.m1.1.1.2.1.cmml" xref="S4.p6.1.m1.1.1">subscript</csymbol><ci id="S4.p6.1.m1.1.1.2.2.cmml" xref="S4.p6.1.m1.1.1.2.2">𝐷</ci><ci id="S4.p6.1.m1.1.1.2.3a.cmml" xref="S4.p6.1.m1.1.1.2.3"><mtext mathsize="70%" id="S4.p6.1.m1.1.1.2.3.cmml" xref="S4.p6.1.m1.1.1.2.3">KL</mtext></ci></apply><ci id="S4.p6.1.m1.1.1.3.cmml" xref="S4.p6.1.m1.1.1.3">𝑇</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.p6.1.m1.1c">D_{\text{KL}}^{T}</annotation></semantics></math>, <math id="S4.p6.2.m2.1" class="ltx_Math" alttext="D_{\text{KL}}^{S}" display="inline"><semantics id="S4.p6.2.m2.1a"><msubsup id="S4.p6.2.m2.1.1" xref="S4.p6.2.m2.1.1.cmml"><mi id="S4.p6.2.m2.1.1.2.2" xref="S4.p6.2.m2.1.1.2.2.cmml">D</mi><mtext id="S4.p6.2.m2.1.1.2.3" xref="S4.p6.2.m2.1.1.2.3a.cmml">KL</mtext><mi id="S4.p6.2.m2.1.1.3" xref="S4.p6.2.m2.1.1.3.cmml">S</mi></msubsup><annotation-xml encoding="MathML-Content" id="S4.p6.2.m2.1b"><apply id="S4.p6.2.m2.1.1.cmml" xref="S4.p6.2.m2.1.1"><csymbol cd="ambiguous" id="S4.p6.2.m2.1.1.1.cmml" xref="S4.p6.2.m2.1.1">superscript</csymbol><apply id="S4.p6.2.m2.1.1.2.cmml" xref="S4.p6.2.m2.1.1"><csymbol cd="ambiguous" id="S4.p6.2.m2.1.1.2.1.cmml" xref="S4.p6.2.m2.1.1">subscript</csymbol><ci id="S4.p6.2.m2.1.1.2.2.cmml" xref="S4.p6.2.m2.1.1.2.2">𝐷</ci><ci id="S4.p6.2.m2.1.1.2.3a.cmml" xref="S4.p6.2.m2.1.1.2.3"><mtext mathsize="70%" id="S4.p6.2.m2.1.1.2.3.cmml" xref="S4.p6.2.m2.1.1.2.3">KL</mtext></ci></apply><ci id="S4.p6.2.m2.1.1.3.cmml" xref="S4.p6.2.m2.1.1.3">𝑆</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.p6.2.m2.1c">D_{\text{KL}}^{S}</annotation></semantics></math>, and the hyper-parameter <math id="S4.p6.3.m3.1" class="ltx_Math" alttext="\beta" display="inline"><semantics id="S4.p6.3.m3.1a"><mi id="S4.p6.3.m3.1.1" xref="S4.p6.3.m3.1.1.cmml">β</mi><annotation-xml encoding="MathML-Content" id="S4.p6.3.m3.1b"><ci id="S4.p6.3.m3.1.1.cmml" xref="S4.p6.3.m3.1.1">𝛽</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.p6.3.m3.1c">\beta</annotation></semantics></math>, the server decides whether to send the teacher model to the clients participating in the next round:</p>
<table id="S7.EGx2" class="ltx_equationgroup ltx_eqn_align ltx_eqn_table">

<tbody id="S4.E3"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math id="S4.E3.m1.1" class="ltx_Math" alttext="\displaystyle T^{\prime}" display="inline"><semantics id="S4.E3.m1.1a"><msup id="S4.E3.m1.1.1" xref="S4.E3.m1.1.1.cmml"><mi id="S4.E3.m1.1.1.2" xref="S4.E3.m1.1.1.2.cmml">T</mi><mo id="S4.E3.m1.1.1.3" xref="S4.E3.m1.1.1.3.cmml">′</mo></msup><annotation-xml encoding="MathML-Content" id="S4.E3.m1.1b"><apply id="S4.E3.m1.1.1.cmml" xref="S4.E3.m1.1.1"><csymbol cd="ambiguous" id="S4.E3.m1.1.1.1.cmml" xref="S4.E3.m1.1.1">superscript</csymbol><ci id="S4.E3.m1.1.1.2.cmml" xref="S4.E3.m1.1.1.2">𝑇</ci><ci id="S4.E3.m1.1.1.3.cmml" xref="S4.E3.m1.1.1.3">′</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.E3.m1.1c">\displaystyle T^{\prime}</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math id="S4.E3.m2.4" class="ltx_Math" alttext="\displaystyle=\begin{cases}T&amp;\text{if }|D_{\text{KL}}^{T}-\beta|&lt;|D_{\text{KL}}^{S}-\beta|\\
\emptyset&amp;\text{otherwise}\end{cases}" display="inline"><semantics id="S4.E3.m2.4a"><mrow id="S4.E3.m2.4.5" xref="S4.E3.m2.4.5.cmml"><mi id="S4.E3.m2.4.5.2" xref="S4.E3.m2.4.5.2.cmml"></mi><mo id="S4.E3.m2.4.5.1" xref="S4.E3.m2.4.5.1.cmml">=</mo><mrow id="S4.E3.m2.4.4a" xref="S4.E3.m2.4.5.3.1.cmml"><mo id="S4.E3.m2.4.4a.5" xref="S4.E3.m2.4.5.3.1.1.cmml">{</mo><mtable columnspacing="5pt" rowspacing="0pt" id="S4.E3.m2.4.4.4a" xref="S4.E3.m2.4.5.3.1.cmml"><mtr id="S4.E3.m2.4.4.4aa" xref="S4.E3.m2.4.5.3.1.cmml"><mtd class="ltx_align_left" columnalign="left" id="S4.E3.m2.4.4.4ab" xref="S4.E3.m2.4.5.3.1.cmml"><mi id="S4.E3.m2.1.1.1.1.1.1" xref="S4.E3.m2.1.1.1.1.1.1.cmml">T</mi></mtd><mtd class="ltx_align_left" columnalign="left" id="S4.E3.m2.4.4.4ac" xref="S4.E3.m2.4.5.3.1.cmml"><mrow id="S4.E3.m2.2.2.2.2.2.1" xref="S4.E3.m2.2.2.2.2.2.1.cmml"><mrow id="S4.E3.m2.2.2.2.2.2.1.1" xref="S4.E3.m2.2.2.2.2.2.1.1.cmml"><mtext id="S4.E3.m2.2.2.2.2.2.1.1.3" xref="S4.E3.m2.2.2.2.2.2.1.1.3a.cmml">if </mtext><mo lspace="0em" rspace="0em" id="S4.E3.m2.2.2.2.2.2.1.1.2" xref="S4.E3.m2.2.2.2.2.2.1.1.2.cmml">​</mo><mrow id="S4.E3.m2.2.2.2.2.2.1.1.1.1" xref="S4.E3.m2.2.2.2.2.2.1.1.1.2.cmml"><mo stretchy="false" id="S4.E3.m2.2.2.2.2.2.1.1.1.1.2" xref="S4.E3.m2.2.2.2.2.2.1.1.1.2.1.cmml">|</mo><mrow id="S4.E3.m2.2.2.2.2.2.1.1.1.1.1" xref="S4.E3.m2.2.2.2.2.2.1.1.1.1.1.cmml"><msubsup id="S4.E3.m2.2.2.2.2.2.1.1.1.1.1.2" xref="S4.E3.m2.2.2.2.2.2.1.1.1.1.1.2.cmml"><mi id="S4.E3.m2.2.2.2.2.2.1.1.1.1.1.2.2.2" xref="S4.E3.m2.2.2.2.2.2.1.1.1.1.1.2.2.2.cmml">D</mi><mtext id="S4.E3.m2.2.2.2.2.2.1.1.1.1.1.2.2.3" xref="S4.E3.m2.2.2.2.2.2.1.1.1.1.1.2.2.3a.cmml">KL</mtext><mi id="S4.E3.m2.2.2.2.2.2.1.1.1.1.1.2.3" xref="S4.E3.m2.2.2.2.2.2.1.1.1.1.1.2.3.cmml">T</mi></msubsup><mo id="S4.E3.m2.2.2.2.2.2.1.1.1.1.1.1" xref="S4.E3.m2.2.2.2.2.2.1.1.1.1.1.1.cmml">−</mo><mi id="S4.E3.m2.2.2.2.2.2.1.1.1.1.1.3" xref="S4.E3.m2.2.2.2.2.2.1.1.1.1.1.3.cmml">β</mi></mrow><mo stretchy="false" id="S4.E3.m2.2.2.2.2.2.1.1.1.1.3" xref="S4.E3.m2.2.2.2.2.2.1.1.1.2.1.cmml">|</mo></mrow></mrow><mo id="S4.E3.m2.2.2.2.2.2.1.3" xref="S4.E3.m2.2.2.2.2.2.1.3.cmml">&lt;</mo><mrow id="S4.E3.m2.2.2.2.2.2.1.2.1" xref="S4.E3.m2.2.2.2.2.2.1.2.2.cmml"><mo stretchy="false" id="S4.E3.m2.2.2.2.2.2.1.2.1.2" xref="S4.E3.m2.2.2.2.2.2.1.2.2.1.cmml">|</mo><mrow id="S4.E3.m2.2.2.2.2.2.1.2.1.1" xref="S4.E3.m2.2.2.2.2.2.1.2.1.1.cmml"><msubsup id="S4.E3.m2.2.2.2.2.2.1.2.1.1.2" xref="S4.E3.m2.2.2.2.2.2.1.2.1.1.2.cmml"><mi id="S4.E3.m2.2.2.2.2.2.1.2.1.1.2.2.2" xref="S4.E3.m2.2.2.2.2.2.1.2.1.1.2.2.2.cmml">D</mi><mtext id="S4.E3.m2.2.2.2.2.2.1.2.1.1.2.2.3" xref="S4.E3.m2.2.2.2.2.2.1.2.1.1.2.2.3a.cmml">KL</mtext><mi id="S4.E3.m2.2.2.2.2.2.1.2.1.1.2.3" xref="S4.E3.m2.2.2.2.2.2.1.2.1.1.2.3.cmml">S</mi></msubsup><mo id="S4.E3.m2.2.2.2.2.2.1.2.1.1.1" xref="S4.E3.m2.2.2.2.2.2.1.2.1.1.1.cmml">−</mo><mi id="S4.E3.m2.2.2.2.2.2.1.2.1.1.3" xref="S4.E3.m2.2.2.2.2.2.1.2.1.1.3.cmml">β</mi></mrow><mo stretchy="false" id="S4.E3.m2.2.2.2.2.2.1.2.1.3" xref="S4.E3.m2.2.2.2.2.2.1.2.2.1.cmml">|</mo></mrow></mrow></mtd></mtr><mtr id="S4.E3.m2.4.4.4ad" xref="S4.E3.m2.4.5.3.1.cmml"><mtd class="ltx_align_left" columnalign="left" id="S4.E3.m2.4.4.4ae" xref="S4.E3.m2.4.5.3.1.cmml"><mi mathvariant="normal" id="S4.E3.m2.3.3.3.3.1.1" xref="S4.E3.m2.3.3.3.3.1.1.cmml">∅</mi></mtd><mtd class="ltx_align_left" columnalign="left" id="S4.E3.m2.4.4.4af" xref="S4.E3.m2.4.5.3.1.cmml"><mtext id="S4.E3.m2.4.4.4.4.2.1" xref="S4.E3.m2.4.4.4.4.2.1a.cmml">otherwise</mtext></mtd></mtr></mtable></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.E3.m2.4b"><apply id="S4.E3.m2.4.5.cmml" xref="S4.E3.m2.4.5"><eq id="S4.E3.m2.4.5.1.cmml" xref="S4.E3.m2.4.5.1"></eq><csymbol cd="latexml" id="S4.E3.m2.4.5.2.cmml" xref="S4.E3.m2.4.5.2">absent</csymbol><apply id="S4.E3.m2.4.5.3.1.cmml" xref="S4.E3.m2.4.4a"><csymbol cd="latexml" id="S4.E3.m2.4.5.3.1.1.cmml" xref="S4.E3.m2.4.4a.5">cases</csymbol><ci id="S4.E3.m2.1.1.1.1.1.1.cmml" xref="S4.E3.m2.1.1.1.1.1.1">𝑇</ci><apply id="S4.E3.m2.2.2.2.2.2.1.cmml" xref="S4.E3.m2.2.2.2.2.2.1"><lt id="S4.E3.m2.2.2.2.2.2.1.3.cmml" xref="S4.E3.m2.2.2.2.2.2.1.3"></lt><apply id="S4.E3.m2.2.2.2.2.2.1.1.cmml" xref="S4.E3.m2.2.2.2.2.2.1.1"><times id="S4.E3.m2.2.2.2.2.2.1.1.2.cmml" xref="S4.E3.m2.2.2.2.2.2.1.1.2"></times><ci id="S4.E3.m2.2.2.2.2.2.1.1.3a.cmml" xref="S4.E3.m2.2.2.2.2.2.1.1.3"><mtext id="S4.E3.m2.2.2.2.2.2.1.1.3.cmml" xref="S4.E3.m2.2.2.2.2.2.1.1.3">if </mtext></ci><apply id="S4.E3.m2.2.2.2.2.2.1.1.1.2.cmml" xref="S4.E3.m2.2.2.2.2.2.1.1.1.1"><abs id="S4.E3.m2.2.2.2.2.2.1.1.1.2.1.cmml" xref="S4.E3.m2.2.2.2.2.2.1.1.1.1.2"></abs><apply id="S4.E3.m2.2.2.2.2.2.1.1.1.1.1.cmml" xref="S4.E3.m2.2.2.2.2.2.1.1.1.1.1"><minus id="S4.E3.m2.2.2.2.2.2.1.1.1.1.1.1.cmml" xref="S4.E3.m2.2.2.2.2.2.1.1.1.1.1.1"></minus><apply id="S4.E3.m2.2.2.2.2.2.1.1.1.1.1.2.cmml" xref="S4.E3.m2.2.2.2.2.2.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S4.E3.m2.2.2.2.2.2.1.1.1.1.1.2.1.cmml" xref="S4.E3.m2.2.2.2.2.2.1.1.1.1.1.2">superscript</csymbol><apply id="S4.E3.m2.2.2.2.2.2.1.1.1.1.1.2.2.cmml" xref="S4.E3.m2.2.2.2.2.2.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S4.E3.m2.2.2.2.2.2.1.1.1.1.1.2.2.1.cmml" xref="S4.E3.m2.2.2.2.2.2.1.1.1.1.1.2">subscript</csymbol><ci id="S4.E3.m2.2.2.2.2.2.1.1.1.1.1.2.2.2.cmml" xref="S4.E3.m2.2.2.2.2.2.1.1.1.1.1.2.2.2">𝐷</ci><ci id="S4.E3.m2.2.2.2.2.2.1.1.1.1.1.2.2.3a.cmml" xref="S4.E3.m2.2.2.2.2.2.1.1.1.1.1.2.2.3"><mtext mathsize="70%" id="S4.E3.m2.2.2.2.2.2.1.1.1.1.1.2.2.3.cmml" xref="S4.E3.m2.2.2.2.2.2.1.1.1.1.1.2.2.3">KL</mtext></ci></apply><ci id="S4.E3.m2.2.2.2.2.2.1.1.1.1.1.2.3.cmml" xref="S4.E3.m2.2.2.2.2.2.1.1.1.1.1.2.3">𝑇</ci></apply><ci id="S4.E3.m2.2.2.2.2.2.1.1.1.1.1.3.cmml" xref="S4.E3.m2.2.2.2.2.2.1.1.1.1.1.3">𝛽</ci></apply></apply></apply><apply id="S4.E3.m2.2.2.2.2.2.1.2.2.cmml" xref="S4.E3.m2.2.2.2.2.2.1.2.1"><abs id="S4.E3.m2.2.2.2.2.2.1.2.2.1.cmml" xref="S4.E3.m2.2.2.2.2.2.1.2.1.2"></abs><apply id="S4.E3.m2.2.2.2.2.2.1.2.1.1.cmml" xref="S4.E3.m2.2.2.2.2.2.1.2.1.1"><minus id="S4.E3.m2.2.2.2.2.2.1.2.1.1.1.cmml" xref="S4.E3.m2.2.2.2.2.2.1.2.1.1.1"></minus><apply id="S4.E3.m2.2.2.2.2.2.1.2.1.1.2.cmml" xref="S4.E3.m2.2.2.2.2.2.1.2.1.1.2"><csymbol cd="ambiguous" id="S4.E3.m2.2.2.2.2.2.1.2.1.1.2.1.cmml" xref="S4.E3.m2.2.2.2.2.2.1.2.1.1.2">superscript</csymbol><apply id="S4.E3.m2.2.2.2.2.2.1.2.1.1.2.2.cmml" xref="S4.E3.m2.2.2.2.2.2.1.2.1.1.2"><csymbol cd="ambiguous" id="S4.E3.m2.2.2.2.2.2.1.2.1.1.2.2.1.cmml" xref="S4.E3.m2.2.2.2.2.2.1.2.1.1.2">subscript</csymbol><ci id="S4.E3.m2.2.2.2.2.2.1.2.1.1.2.2.2.cmml" xref="S4.E3.m2.2.2.2.2.2.1.2.1.1.2.2.2">𝐷</ci><ci id="S4.E3.m2.2.2.2.2.2.1.2.1.1.2.2.3a.cmml" xref="S4.E3.m2.2.2.2.2.2.1.2.1.1.2.2.3"><mtext mathsize="70%" id="S4.E3.m2.2.2.2.2.2.1.2.1.1.2.2.3.cmml" xref="S4.E3.m2.2.2.2.2.2.1.2.1.1.2.2.3">KL</mtext></ci></apply><ci id="S4.E3.m2.2.2.2.2.2.1.2.1.1.2.3.cmml" xref="S4.E3.m2.2.2.2.2.2.1.2.1.1.2.3">𝑆</ci></apply><ci id="S4.E3.m2.2.2.2.2.2.1.2.1.1.3.cmml" xref="S4.E3.m2.2.2.2.2.2.1.2.1.1.3">𝛽</ci></apply></apply></apply><emptyset id="S4.E3.m2.3.3.3.3.1.1.cmml" xref="S4.E3.m2.3.3.3.3.1.1"></emptyset><ci id="S4.E3.m2.4.4.4.4.2.1a.cmml" xref="S4.E3.m2.4.4.4.4.2.1"><mtext id="S4.E3.m2.4.4.4.4.2.1.cmml" xref="S4.E3.m2.4.4.4.4.2.1">otherwise</mtext></ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.E3.m2.4c">\displaystyle=\begin{cases}T&amp;\text{if }|D_{\text{KL}}^{T}-\beta|&lt;|D_{\text{KL}}^{S}-\beta|\\
\emptyset&amp;\text{otherwise}\end{cases}</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(3)</span></td>
</tr></tbody>
</table>
</div>
<div id="S4.p7" class="ltx_para">
<p id="S4.p7.4" class="ltx_p">We can express supervised loss <math id="S4.p7.1.m1.1" class="ltx_Math" alttext="\mathcal{L}_{s}" display="inline"><semantics id="S4.p7.1.m1.1a"><msub id="S4.p7.1.m1.1.1" xref="S4.p7.1.m1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.p7.1.m1.1.1.2" xref="S4.p7.1.m1.1.1.2.cmml">ℒ</mi><mi id="S4.p7.1.m1.1.1.3" xref="S4.p7.1.m1.1.1.3.cmml">s</mi></msub><annotation-xml encoding="MathML-Content" id="S4.p7.1.m1.1b"><apply id="S4.p7.1.m1.1.1.cmml" xref="S4.p7.1.m1.1.1"><csymbol cd="ambiguous" id="S4.p7.1.m1.1.1.1.cmml" xref="S4.p7.1.m1.1.1">subscript</csymbol><ci id="S4.p7.1.m1.1.1.2.cmml" xref="S4.p7.1.m1.1.1.2">ℒ</ci><ci id="S4.p7.1.m1.1.1.3.cmml" xref="S4.p7.1.m1.1.1.3">𝑠</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.p7.1.m1.1c">\mathcal{L}_{s}</annotation></semantics></math> and unsupervised loss <math id="S4.p7.2.m2.1" class="ltx_Math" alttext="\mathcal{L}_{u}" display="inline"><semantics id="S4.p7.2.m2.1a"><msub id="S4.p7.2.m2.1.1" xref="S4.p7.2.m2.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.p7.2.m2.1.1.2" xref="S4.p7.2.m2.1.1.2.cmml">ℒ</mi><mi id="S4.p7.2.m2.1.1.3" xref="S4.p7.2.m2.1.1.3.cmml">u</mi></msub><annotation-xml encoding="MathML-Content" id="S4.p7.2.m2.1b"><apply id="S4.p7.2.m2.1.1.cmml" xref="S4.p7.2.m2.1.1"><csymbol cd="ambiguous" id="S4.p7.2.m2.1.1.1.cmml" xref="S4.p7.2.m2.1.1">subscript</csymbol><ci id="S4.p7.2.m2.1.1.2.cmml" xref="S4.p7.2.m2.1.1.2">ℒ</ci><ci id="S4.p7.2.m2.1.1.3.cmml" xref="S4.p7.2.m2.1.1.3">𝑢</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.p7.2.m2.1c">\mathcal{L}_{u}</annotation></semantics></math> based on <math id="S4.p7.3.m3.1" class="ltx_Math" alttext="S" display="inline"><semantics id="S4.p7.3.m3.1a"><mi id="S4.p7.3.m3.1.1" xref="S4.p7.3.m3.1.1.cmml">S</mi><annotation-xml encoding="MathML-Content" id="S4.p7.3.m3.1b"><ci id="S4.p7.3.m3.1.1.cmml" xref="S4.p7.3.m3.1.1">𝑆</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.p7.3.m3.1c">S</annotation></semantics></math> and <math id="S4.p7.4.m4.1" class="ltx_Math" alttext="T^{\prime}" display="inline"><semantics id="S4.p7.4.m4.1a"><msup id="S4.p7.4.m4.1.1" xref="S4.p7.4.m4.1.1.cmml"><mi id="S4.p7.4.m4.1.1.2" xref="S4.p7.4.m4.1.1.2.cmml">T</mi><mo id="S4.p7.4.m4.1.1.3" xref="S4.p7.4.m4.1.1.3.cmml">′</mo></msup><annotation-xml encoding="MathML-Content" id="S4.p7.4.m4.1b"><apply id="S4.p7.4.m4.1.1.cmml" xref="S4.p7.4.m4.1.1"><csymbol cd="ambiguous" id="S4.p7.4.m4.1.1.1.cmml" xref="S4.p7.4.m4.1.1">superscript</csymbol><ci id="S4.p7.4.m4.1.1.2.cmml" xref="S4.p7.4.m4.1.1.2">𝑇</ci><ci id="S4.p7.4.m4.1.1.3.cmml" xref="S4.p7.4.m4.1.1.3">′</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.p7.4.m4.1c">T^{\prime}</annotation></semantics></math> as follows:</p>
<table id="S7.EGx3" class="ltx_equationgroup ltx_eqn_align ltx_eqn_table">

<tbody id="S4.E4"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math id="S4.E4.m1.2" class="ltx_Math" alttext="\displaystyle\mathcal{L}_{s}(S;s)" display="inline"><semantics id="S4.E4.m1.2a"><mrow id="S4.E4.m1.2.3" xref="S4.E4.m1.2.3.cmml"><msub id="S4.E4.m1.2.3.2" xref="S4.E4.m1.2.3.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.E4.m1.2.3.2.2" xref="S4.E4.m1.2.3.2.2.cmml">ℒ</mi><mi id="S4.E4.m1.2.3.2.3" xref="S4.E4.m1.2.3.2.3.cmml">s</mi></msub><mo lspace="0em" rspace="0em" id="S4.E4.m1.2.3.1" xref="S4.E4.m1.2.3.1.cmml">​</mo><mrow id="S4.E4.m1.2.3.3.2" xref="S4.E4.m1.2.3.3.1.cmml"><mo stretchy="false" id="S4.E4.m1.2.3.3.2.1" xref="S4.E4.m1.2.3.3.1.cmml">(</mo><mi id="S4.E4.m1.1.1" xref="S4.E4.m1.1.1.cmml">S</mi><mo id="S4.E4.m1.2.3.3.2.2" xref="S4.E4.m1.2.3.3.1.cmml">;</mo><mi id="S4.E4.m1.2.2" xref="S4.E4.m1.2.2.cmml">s</mi><mo stretchy="false" id="S4.E4.m1.2.3.3.2.3" xref="S4.E4.m1.2.3.3.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.E4.m1.2b"><apply id="S4.E4.m1.2.3.cmml" xref="S4.E4.m1.2.3"><times id="S4.E4.m1.2.3.1.cmml" xref="S4.E4.m1.2.3.1"></times><apply id="S4.E4.m1.2.3.2.cmml" xref="S4.E4.m1.2.3.2"><csymbol cd="ambiguous" id="S4.E4.m1.2.3.2.1.cmml" xref="S4.E4.m1.2.3.2">subscript</csymbol><ci id="S4.E4.m1.2.3.2.2.cmml" xref="S4.E4.m1.2.3.2.2">ℒ</ci><ci id="S4.E4.m1.2.3.2.3.cmml" xref="S4.E4.m1.2.3.2.3">𝑠</ci></apply><list id="S4.E4.m1.2.3.3.1.cmml" xref="S4.E4.m1.2.3.3.2"><ci id="S4.E4.m1.1.1.cmml" xref="S4.E4.m1.1.1">𝑆</ci><ci id="S4.E4.m1.2.2.cmml" xref="S4.E4.m1.2.2">𝑠</ci></list></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.E4.m1.2c">\displaystyle\mathcal{L}_{s}(S;s)</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math id="S4.E4.m2.2" class="ltx_Math" alttext="\displaystyle=\sum_{i}\mathcal{L}(x^{s}_{i},y_{i})" display="inline"><semantics id="S4.E4.m2.2a"><mrow id="S4.E4.m2.2.2" xref="S4.E4.m2.2.2.cmml"><mi id="S4.E4.m2.2.2.4" xref="S4.E4.m2.2.2.4.cmml"></mi><mo id="S4.E4.m2.2.2.3" xref="S4.E4.m2.2.2.3.cmml">=</mo><mrow id="S4.E4.m2.2.2.2" xref="S4.E4.m2.2.2.2.cmml"><mstyle displaystyle="true" id="S4.E4.m2.2.2.2.3" xref="S4.E4.m2.2.2.2.3.cmml"><munder id="S4.E4.m2.2.2.2.3a" xref="S4.E4.m2.2.2.2.3.cmml"><mo movablelimits="false" id="S4.E4.m2.2.2.2.3.2" xref="S4.E4.m2.2.2.2.3.2.cmml">∑</mo><mi id="S4.E4.m2.2.2.2.3.3" xref="S4.E4.m2.2.2.2.3.3.cmml">i</mi></munder></mstyle><mrow id="S4.E4.m2.2.2.2.2" xref="S4.E4.m2.2.2.2.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.E4.m2.2.2.2.2.4" xref="S4.E4.m2.2.2.2.2.4.cmml">ℒ</mi><mo lspace="0em" rspace="0em" id="S4.E4.m2.2.2.2.2.3" xref="S4.E4.m2.2.2.2.2.3.cmml">​</mo><mrow id="S4.E4.m2.2.2.2.2.2.2" xref="S4.E4.m2.2.2.2.2.2.3.cmml"><mo stretchy="false" id="S4.E4.m2.2.2.2.2.2.2.3" xref="S4.E4.m2.2.2.2.2.2.3.cmml">(</mo><msubsup id="S4.E4.m2.1.1.1.1.1.1.1" xref="S4.E4.m2.1.1.1.1.1.1.1.cmml"><mi id="S4.E4.m2.1.1.1.1.1.1.1.2.2" xref="S4.E4.m2.1.1.1.1.1.1.1.2.2.cmml">x</mi><mi id="S4.E4.m2.1.1.1.1.1.1.1.3" xref="S4.E4.m2.1.1.1.1.1.1.1.3.cmml">i</mi><mi id="S4.E4.m2.1.1.1.1.1.1.1.2.3" xref="S4.E4.m2.1.1.1.1.1.1.1.2.3.cmml">s</mi></msubsup><mo id="S4.E4.m2.2.2.2.2.2.2.4" xref="S4.E4.m2.2.2.2.2.2.3.cmml">,</mo><msub id="S4.E4.m2.2.2.2.2.2.2.2" xref="S4.E4.m2.2.2.2.2.2.2.2.cmml"><mi id="S4.E4.m2.2.2.2.2.2.2.2.2" xref="S4.E4.m2.2.2.2.2.2.2.2.2.cmml">y</mi><mi id="S4.E4.m2.2.2.2.2.2.2.2.3" xref="S4.E4.m2.2.2.2.2.2.2.2.3.cmml">i</mi></msub><mo stretchy="false" id="S4.E4.m2.2.2.2.2.2.2.5" xref="S4.E4.m2.2.2.2.2.2.3.cmml">)</mo></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.E4.m2.2b"><apply id="S4.E4.m2.2.2.cmml" xref="S4.E4.m2.2.2"><eq id="S4.E4.m2.2.2.3.cmml" xref="S4.E4.m2.2.2.3"></eq><csymbol cd="latexml" id="S4.E4.m2.2.2.4.cmml" xref="S4.E4.m2.2.2.4">absent</csymbol><apply id="S4.E4.m2.2.2.2.cmml" xref="S4.E4.m2.2.2.2"><apply id="S4.E4.m2.2.2.2.3.cmml" xref="S4.E4.m2.2.2.2.3"><csymbol cd="ambiguous" id="S4.E4.m2.2.2.2.3.1.cmml" xref="S4.E4.m2.2.2.2.3">subscript</csymbol><sum id="S4.E4.m2.2.2.2.3.2.cmml" xref="S4.E4.m2.2.2.2.3.2"></sum><ci id="S4.E4.m2.2.2.2.3.3.cmml" xref="S4.E4.m2.2.2.2.3.3">𝑖</ci></apply><apply id="S4.E4.m2.2.2.2.2.cmml" xref="S4.E4.m2.2.2.2.2"><times id="S4.E4.m2.2.2.2.2.3.cmml" xref="S4.E4.m2.2.2.2.2.3"></times><ci id="S4.E4.m2.2.2.2.2.4.cmml" xref="S4.E4.m2.2.2.2.2.4">ℒ</ci><interval closure="open" id="S4.E4.m2.2.2.2.2.2.3.cmml" xref="S4.E4.m2.2.2.2.2.2.2"><apply id="S4.E4.m2.1.1.1.1.1.1.1.cmml" xref="S4.E4.m2.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.E4.m2.1.1.1.1.1.1.1.1.cmml" xref="S4.E4.m2.1.1.1.1.1.1.1">subscript</csymbol><apply id="S4.E4.m2.1.1.1.1.1.1.1.2.cmml" xref="S4.E4.m2.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.E4.m2.1.1.1.1.1.1.1.2.1.cmml" xref="S4.E4.m2.1.1.1.1.1.1.1">superscript</csymbol><ci id="S4.E4.m2.1.1.1.1.1.1.1.2.2.cmml" xref="S4.E4.m2.1.1.1.1.1.1.1.2.2">𝑥</ci><ci id="S4.E4.m2.1.1.1.1.1.1.1.2.3.cmml" xref="S4.E4.m2.1.1.1.1.1.1.1.2.3">𝑠</ci></apply><ci id="S4.E4.m2.1.1.1.1.1.1.1.3.cmml" xref="S4.E4.m2.1.1.1.1.1.1.1.3">𝑖</ci></apply><apply id="S4.E4.m2.2.2.2.2.2.2.2.cmml" xref="S4.E4.m2.2.2.2.2.2.2.2"><csymbol cd="ambiguous" id="S4.E4.m2.2.2.2.2.2.2.2.1.cmml" xref="S4.E4.m2.2.2.2.2.2.2.2">subscript</csymbol><ci id="S4.E4.m2.2.2.2.2.2.2.2.2.cmml" xref="S4.E4.m2.2.2.2.2.2.2.2.2">𝑦</ci><ci id="S4.E4.m2.2.2.2.2.2.2.2.3.cmml" xref="S4.E4.m2.2.2.2.2.2.2.2.3">𝑖</ci></apply></interval></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.E4.m2.2c">\displaystyle=\sum_{i}\mathcal{L}(x^{s}_{i},y_{i})</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(4)</span></td>
</tr></tbody>
<tbody id="S4.E5"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math id="S4.E5.m1.3" class="ltx_Math" alttext="\displaystyle\mathcal{L}_{u}(S,T^{\prime};u)" display="inline"><semantics id="S4.E5.m1.3a"><mrow id="S4.E5.m1.3.3" xref="S4.E5.m1.3.3.cmml"><msub id="S4.E5.m1.3.3.3" xref="S4.E5.m1.3.3.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.E5.m1.3.3.3.2" xref="S4.E5.m1.3.3.3.2.cmml">ℒ</mi><mi id="S4.E5.m1.3.3.3.3" xref="S4.E5.m1.3.3.3.3.cmml">u</mi></msub><mo lspace="0em" rspace="0em" id="S4.E5.m1.3.3.2" xref="S4.E5.m1.3.3.2.cmml">​</mo><mrow id="S4.E5.m1.3.3.1.1" xref="S4.E5.m1.3.3.1.2.cmml"><mo stretchy="false" id="S4.E5.m1.3.3.1.1.2" xref="S4.E5.m1.3.3.1.2.cmml">(</mo><mi id="S4.E5.m1.1.1" xref="S4.E5.m1.1.1.cmml">S</mi><mo id="S4.E5.m1.3.3.1.1.3" xref="S4.E5.m1.3.3.1.2.cmml">,</mo><msup id="S4.E5.m1.3.3.1.1.1" xref="S4.E5.m1.3.3.1.1.1.cmml"><mi id="S4.E5.m1.3.3.1.1.1.2" xref="S4.E5.m1.3.3.1.1.1.2.cmml">T</mi><mo id="S4.E5.m1.3.3.1.1.1.3" xref="S4.E5.m1.3.3.1.1.1.3.cmml">′</mo></msup><mo id="S4.E5.m1.3.3.1.1.4" xref="S4.E5.m1.3.3.1.2.cmml">;</mo><mi id="S4.E5.m1.2.2" xref="S4.E5.m1.2.2.cmml">u</mi><mo stretchy="false" id="S4.E5.m1.3.3.1.1.5" xref="S4.E5.m1.3.3.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.E5.m1.3b"><apply id="S4.E5.m1.3.3.cmml" xref="S4.E5.m1.3.3"><times id="S4.E5.m1.3.3.2.cmml" xref="S4.E5.m1.3.3.2"></times><apply id="S4.E5.m1.3.3.3.cmml" xref="S4.E5.m1.3.3.3"><csymbol cd="ambiguous" id="S4.E5.m1.3.3.3.1.cmml" xref="S4.E5.m1.3.3.3">subscript</csymbol><ci id="S4.E5.m1.3.3.3.2.cmml" xref="S4.E5.m1.3.3.3.2">ℒ</ci><ci id="S4.E5.m1.3.3.3.3.cmml" xref="S4.E5.m1.3.3.3.3">𝑢</ci></apply><vector id="S4.E5.m1.3.3.1.2.cmml" xref="S4.E5.m1.3.3.1.1"><ci id="S4.E5.m1.1.1.cmml" xref="S4.E5.m1.1.1">𝑆</ci><apply id="S4.E5.m1.3.3.1.1.1.cmml" xref="S4.E5.m1.3.3.1.1.1"><csymbol cd="ambiguous" id="S4.E5.m1.3.3.1.1.1.1.cmml" xref="S4.E5.m1.3.3.1.1.1">superscript</csymbol><ci id="S4.E5.m1.3.3.1.1.1.2.cmml" xref="S4.E5.m1.3.3.1.1.1.2">𝑇</ci><ci id="S4.E5.m1.3.3.1.1.1.3.cmml" xref="S4.E5.m1.3.3.1.1.1.3">′</ci></apply><ci id="S4.E5.m1.2.2.cmml" xref="S4.E5.m1.2.2">𝑢</ci></vector></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.E5.m1.3c">\displaystyle\mathcal{L}_{u}(S,T^{\prime};u)</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math id="S4.E5.m2.4" class="ltx_Math" alttext="\displaystyle=\begin{cases}\sum_{i}\mathcal{L}(x^{u}_{i},y^{T^{\prime}}_{i})&amp;\text{if }T^{\prime}\neq\emptyset\\
\sum_{i}\mathcal{L}(x^{u}_{i},y^{S}_{i})&amp;\text{otherwise}\end{cases}" display="inline"><semantics id="S4.E5.m2.4a"><mrow id="S4.E5.m2.4.5" xref="S4.E5.m2.4.5.cmml"><mi id="S4.E5.m2.4.5.2" xref="S4.E5.m2.4.5.2.cmml"></mi><mo id="S4.E5.m2.4.5.1" xref="S4.E5.m2.4.5.1.cmml">=</mo><mrow id="S4.E5.m2.4.4a" xref="S4.E5.m2.4.5.3.1.cmml"><mo id="S4.E5.m2.4.4a.5" xref="S4.E5.m2.4.5.3.1.1.cmml">{</mo><mtable columnspacing="5pt" rowspacing="0pt" id="S4.E5.m2.4.4.4a" xref="S4.E5.m2.4.5.3.1.cmml"><mtr id="S4.E5.m2.4.4.4aa" xref="S4.E5.m2.4.5.3.1.cmml"><mtd class="ltx_align_left" columnalign="left" id="S4.E5.m2.4.4.4ab" xref="S4.E5.m2.4.5.3.1.cmml"><mrow id="S4.E5.m2.1.1.1.1.1.1" xref="S4.E5.m2.1.1.1.1.1.1.cmml"><msub id="S4.E5.m2.1.1.1.1.1.1.3" xref="S4.E5.m2.1.1.1.1.1.1.3.cmml"><mo id="S4.E5.m2.1.1.1.1.1.1.3.2" xref="S4.E5.m2.1.1.1.1.1.1.3.2.cmml">∑</mo><mi id="S4.E5.m2.1.1.1.1.1.1.3.3" xref="S4.E5.m2.1.1.1.1.1.1.3.3.cmml">i</mi></msub><mrow id="S4.E5.m2.1.1.1.1.1.1.2" xref="S4.E5.m2.1.1.1.1.1.1.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.E5.m2.1.1.1.1.1.1.2.4" xref="S4.E5.m2.1.1.1.1.1.1.2.4.cmml">ℒ</mi><mo lspace="0em" rspace="0em" id="S4.E5.m2.1.1.1.1.1.1.2.3" xref="S4.E5.m2.1.1.1.1.1.1.2.3.cmml">​</mo><mrow id="S4.E5.m2.1.1.1.1.1.1.2.2.2" xref="S4.E5.m2.1.1.1.1.1.1.2.2.3.cmml"><mo stretchy="false" id="S4.E5.m2.1.1.1.1.1.1.2.2.2.3" xref="S4.E5.m2.1.1.1.1.1.1.2.2.3.cmml">(</mo><msubsup id="S4.E5.m2.1.1.1.1.1.1.1.1.1.1" xref="S4.E5.m2.1.1.1.1.1.1.1.1.1.1.cmml"><mi id="S4.E5.m2.1.1.1.1.1.1.1.1.1.1.2.2" xref="S4.E5.m2.1.1.1.1.1.1.1.1.1.1.2.2.cmml">x</mi><mi id="S4.E5.m2.1.1.1.1.1.1.1.1.1.1.3" xref="S4.E5.m2.1.1.1.1.1.1.1.1.1.1.3.cmml">i</mi><mi id="S4.E5.m2.1.1.1.1.1.1.1.1.1.1.2.3" xref="S4.E5.m2.1.1.1.1.1.1.1.1.1.1.2.3.cmml">u</mi></msubsup><mo id="S4.E5.m2.1.1.1.1.1.1.2.2.2.4" xref="S4.E5.m2.1.1.1.1.1.1.2.2.3.cmml">,</mo><msubsup id="S4.E5.m2.1.1.1.1.1.1.2.2.2.2" xref="S4.E5.m2.1.1.1.1.1.1.2.2.2.2.cmml"><mi id="S4.E5.m2.1.1.1.1.1.1.2.2.2.2.2.2" xref="S4.E5.m2.1.1.1.1.1.1.2.2.2.2.2.2.cmml">y</mi><mi id="S4.E5.m2.1.1.1.1.1.1.2.2.2.2.3" xref="S4.E5.m2.1.1.1.1.1.1.2.2.2.2.3.cmml">i</mi><msup id="S4.E5.m2.1.1.1.1.1.1.2.2.2.2.2.3" xref="S4.E5.m2.1.1.1.1.1.1.2.2.2.2.2.3.cmml"><mi id="S4.E5.m2.1.1.1.1.1.1.2.2.2.2.2.3.2" xref="S4.E5.m2.1.1.1.1.1.1.2.2.2.2.2.3.2.cmml">T</mi><mo id="S4.E5.m2.1.1.1.1.1.1.2.2.2.2.2.3.3" xref="S4.E5.m2.1.1.1.1.1.1.2.2.2.2.2.3.3.cmml">′</mo></msup></msubsup><mo stretchy="false" id="S4.E5.m2.1.1.1.1.1.1.2.2.2.5" xref="S4.E5.m2.1.1.1.1.1.1.2.2.3.cmml">)</mo></mrow></mrow></mrow></mtd><mtd class="ltx_align_left" columnalign="left" id="S4.E5.m2.4.4.4ac" xref="S4.E5.m2.4.5.3.1.cmml"><mrow id="S4.E5.m2.2.2.2.2.2.1" xref="S4.E5.m2.2.2.2.2.2.1.cmml"><mrow id="S4.E5.m2.2.2.2.2.2.1.2" xref="S4.E5.m2.2.2.2.2.2.1.2.cmml"><mtext id="S4.E5.m2.2.2.2.2.2.1.2.2" xref="S4.E5.m2.2.2.2.2.2.1.2.2a.cmml">if </mtext><mo lspace="0em" rspace="0em" id="S4.E5.m2.2.2.2.2.2.1.2.1" xref="S4.E5.m2.2.2.2.2.2.1.2.1.cmml">​</mo><msup id="S4.E5.m2.2.2.2.2.2.1.2.3" xref="S4.E5.m2.2.2.2.2.2.1.2.3.cmml"><mi id="S4.E5.m2.2.2.2.2.2.1.2.3.2" xref="S4.E5.m2.2.2.2.2.2.1.2.3.2.cmml">T</mi><mo id="S4.E5.m2.2.2.2.2.2.1.2.3.3" xref="S4.E5.m2.2.2.2.2.2.1.2.3.3.cmml">′</mo></msup></mrow><mo id="S4.E5.m2.2.2.2.2.2.1.1" xref="S4.E5.m2.2.2.2.2.2.1.1.cmml">≠</mo><mi mathvariant="normal" id="S4.E5.m2.2.2.2.2.2.1.3" xref="S4.E5.m2.2.2.2.2.2.1.3.cmml">∅</mi></mrow></mtd></mtr><mtr id="S4.E5.m2.4.4.4ad" xref="S4.E5.m2.4.5.3.1.cmml"><mtd class="ltx_align_left" columnalign="left" id="S4.E5.m2.4.4.4ae" xref="S4.E5.m2.4.5.3.1.cmml"><mrow id="S4.E5.m2.3.3.3.3.1.1" xref="S4.E5.m2.3.3.3.3.1.1.cmml"><msub id="S4.E5.m2.3.3.3.3.1.1.3" xref="S4.E5.m2.3.3.3.3.1.1.3.cmml"><mo id="S4.E5.m2.3.3.3.3.1.1.3.2" xref="S4.E5.m2.3.3.3.3.1.1.3.2.cmml">∑</mo><mi id="S4.E5.m2.3.3.3.3.1.1.3.3" xref="S4.E5.m2.3.3.3.3.1.1.3.3.cmml">i</mi></msub><mrow id="S4.E5.m2.3.3.3.3.1.1.2" xref="S4.E5.m2.3.3.3.3.1.1.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.E5.m2.3.3.3.3.1.1.2.4" xref="S4.E5.m2.3.3.3.3.1.1.2.4.cmml">ℒ</mi><mo lspace="0em" rspace="0em" id="S4.E5.m2.3.3.3.3.1.1.2.3" xref="S4.E5.m2.3.3.3.3.1.1.2.3.cmml">​</mo><mrow id="S4.E5.m2.3.3.3.3.1.1.2.2.2" xref="S4.E5.m2.3.3.3.3.1.1.2.2.3.cmml"><mo stretchy="false" id="S4.E5.m2.3.3.3.3.1.1.2.2.2.3" xref="S4.E5.m2.3.3.3.3.1.1.2.2.3.cmml">(</mo><msubsup id="S4.E5.m2.3.3.3.3.1.1.1.1.1.1" xref="S4.E5.m2.3.3.3.3.1.1.1.1.1.1.cmml"><mi id="S4.E5.m2.3.3.3.3.1.1.1.1.1.1.2.2" xref="S4.E5.m2.3.3.3.3.1.1.1.1.1.1.2.2.cmml">x</mi><mi id="S4.E5.m2.3.3.3.3.1.1.1.1.1.1.3" xref="S4.E5.m2.3.3.3.3.1.1.1.1.1.1.3.cmml">i</mi><mi id="S4.E5.m2.3.3.3.3.1.1.1.1.1.1.2.3" xref="S4.E5.m2.3.3.3.3.1.1.1.1.1.1.2.3.cmml">u</mi></msubsup><mo id="S4.E5.m2.3.3.3.3.1.1.2.2.2.4" xref="S4.E5.m2.3.3.3.3.1.1.2.2.3.cmml">,</mo><msubsup id="S4.E5.m2.3.3.3.3.1.1.2.2.2.2" xref="S4.E5.m2.3.3.3.3.1.1.2.2.2.2.cmml"><mi id="S4.E5.m2.3.3.3.3.1.1.2.2.2.2.2.2" xref="S4.E5.m2.3.3.3.3.1.1.2.2.2.2.2.2.cmml">y</mi><mi id="S4.E5.m2.3.3.3.3.1.1.2.2.2.2.3" xref="S4.E5.m2.3.3.3.3.1.1.2.2.2.2.3.cmml">i</mi><mi id="S4.E5.m2.3.3.3.3.1.1.2.2.2.2.2.3" xref="S4.E5.m2.3.3.3.3.1.1.2.2.2.2.2.3.cmml">S</mi></msubsup><mo stretchy="false" id="S4.E5.m2.3.3.3.3.1.1.2.2.2.5" xref="S4.E5.m2.3.3.3.3.1.1.2.2.3.cmml">)</mo></mrow></mrow></mrow></mtd><mtd class="ltx_align_left" columnalign="left" id="S4.E5.m2.4.4.4af" xref="S4.E5.m2.4.5.3.1.cmml"><mtext id="S4.E5.m2.4.4.4.4.2.1" xref="S4.E5.m2.4.4.4.4.2.1a.cmml">otherwise</mtext></mtd></mtr></mtable></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.E5.m2.4b"><apply id="S4.E5.m2.4.5.cmml" xref="S4.E5.m2.4.5"><eq id="S4.E5.m2.4.5.1.cmml" xref="S4.E5.m2.4.5.1"></eq><csymbol cd="latexml" id="S4.E5.m2.4.5.2.cmml" xref="S4.E5.m2.4.5.2">absent</csymbol><apply id="S4.E5.m2.4.5.3.1.cmml" xref="S4.E5.m2.4.4a"><csymbol cd="latexml" id="S4.E5.m2.4.5.3.1.1.cmml" xref="S4.E5.m2.4.4a.5">cases</csymbol><apply id="S4.E5.m2.1.1.1.1.1.1.cmml" xref="S4.E5.m2.1.1.1.1.1.1"><apply id="S4.E5.m2.1.1.1.1.1.1.3.cmml" xref="S4.E5.m2.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S4.E5.m2.1.1.1.1.1.1.3.1.cmml" xref="S4.E5.m2.1.1.1.1.1.1.3">subscript</csymbol><sum id="S4.E5.m2.1.1.1.1.1.1.3.2.cmml" xref="S4.E5.m2.1.1.1.1.1.1.3.2"></sum><ci id="S4.E5.m2.1.1.1.1.1.1.3.3.cmml" xref="S4.E5.m2.1.1.1.1.1.1.3.3">𝑖</ci></apply><apply id="S4.E5.m2.1.1.1.1.1.1.2.cmml" xref="S4.E5.m2.1.1.1.1.1.1.2"><times id="S4.E5.m2.1.1.1.1.1.1.2.3.cmml" xref="S4.E5.m2.1.1.1.1.1.1.2.3"></times><ci id="S4.E5.m2.1.1.1.1.1.1.2.4.cmml" xref="S4.E5.m2.1.1.1.1.1.1.2.4">ℒ</ci><interval closure="open" id="S4.E5.m2.1.1.1.1.1.1.2.2.3.cmml" xref="S4.E5.m2.1.1.1.1.1.1.2.2.2"><apply id="S4.E5.m2.1.1.1.1.1.1.1.1.1.1.cmml" xref="S4.E5.m2.1.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.E5.m2.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S4.E5.m2.1.1.1.1.1.1.1.1.1.1">subscript</csymbol><apply id="S4.E5.m2.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S4.E5.m2.1.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.E5.m2.1.1.1.1.1.1.1.1.1.1.2.1.cmml" xref="S4.E5.m2.1.1.1.1.1.1.1.1.1.1">superscript</csymbol><ci id="S4.E5.m2.1.1.1.1.1.1.1.1.1.1.2.2.cmml" xref="S4.E5.m2.1.1.1.1.1.1.1.1.1.1.2.2">𝑥</ci><ci id="S4.E5.m2.1.1.1.1.1.1.1.1.1.1.2.3.cmml" xref="S4.E5.m2.1.1.1.1.1.1.1.1.1.1.2.3">𝑢</ci></apply><ci id="S4.E5.m2.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="S4.E5.m2.1.1.1.1.1.1.1.1.1.1.3">𝑖</ci></apply><apply id="S4.E5.m2.1.1.1.1.1.1.2.2.2.2.cmml" xref="S4.E5.m2.1.1.1.1.1.1.2.2.2.2"><csymbol cd="ambiguous" id="S4.E5.m2.1.1.1.1.1.1.2.2.2.2.1.cmml" xref="S4.E5.m2.1.1.1.1.1.1.2.2.2.2">subscript</csymbol><apply id="S4.E5.m2.1.1.1.1.1.1.2.2.2.2.2.cmml" xref="S4.E5.m2.1.1.1.1.1.1.2.2.2.2"><csymbol cd="ambiguous" id="S4.E5.m2.1.1.1.1.1.1.2.2.2.2.2.1.cmml" xref="S4.E5.m2.1.1.1.1.1.1.2.2.2.2">superscript</csymbol><ci id="S4.E5.m2.1.1.1.1.1.1.2.2.2.2.2.2.cmml" xref="S4.E5.m2.1.1.1.1.1.1.2.2.2.2.2.2">𝑦</ci><apply id="S4.E5.m2.1.1.1.1.1.1.2.2.2.2.2.3.cmml" xref="S4.E5.m2.1.1.1.1.1.1.2.2.2.2.2.3"><csymbol cd="ambiguous" id="S4.E5.m2.1.1.1.1.1.1.2.2.2.2.2.3.1.cmml" xref="S4.E5.m2.1.1.1.1.1.1.2.2.2.2.2.3">superscript</csymbol><ci id="S4.E5.m2.1.1.1.1.1.1.2.2.2.2.2.3.2.cmml" xref="S4.E5.m2.1.1.1.1.1.1.2.2.2.2.2.3.2">𝑇</ci><ci id="S4.E5.m2.1.1.1.1.1.1.2.2.2.2.2.3.3.cmml" xref="S4.E5.m2.1.1.1.1.1.1.2.2.2.2.2.3.3">′</ci></apply></apply><ci id="S4.E5.m2.1.1.1.1.1.1.2.2.2.2.3.cmml" xref="S4.E5.m2.1.1.1.1.1.1.2.2.2.2.3">𝑖</ci></apply></interval></apply></apply><apply id="S4.E5.m2.2.2.2.2.2.1.cmml" xref="S4.E5.m2.2.2.2.2.2.1"><neq id="S4.E5.m2.2.2.2.2.2.1.1.cmml" xref="S4.E5.m2.2.2.2.2.2.1.1"></neq><apply id="S4.E5.m2.2.2.2.2.2.1.2.cmml" xref="S4.E5.m2.2.2.2.2.2.1.2"><times id="S4.E5.m2.2.2.2.2.2.1.2.1.cmml" xref="S4.E5.m2.2.2.2.2.2.1.2.1"></times><ci id="S4.E5.m2.2.2.2.2.2.1.2.2a.cmml" xref="S4.E5.m2.2.2.2.2.2.1.2.2"><mtext id="S4.E5.m2.2.2.2.2.2.1.2.2.cmml" xref="S4.E5.m2.2.2.2.2.2.1.2.2">if </mtext></ci><apply id="S4.E5.m2.2.2.2.2.2.1.2.3.cmml" xref="S4.E5.m2.2.2.2.2.2.1.2.3"><csymbol cd="ambiguous" id="S4.E5.m2.2.2.2.2.2.1.2.3.1.cmml" xref="S4.E5.m2.2.2.2.2.2.1.2.3">superscript</csymbol><ci id="S4.E5.m2.2.2.2.2.2.1.2.3.2.cmml" xref="S4.E5.m2.2.2.2.2.2.1.2.3.2">𝑇</ci><ci id="S4.E5.m2.2.2.2.2.2.1.2.3.3.cmml" xref="S4.E5.m2.2.2.2.2.2.1.2.3.3">′</ci></apply></apply><emptyset id="S4.E5.m2.2.2.2.2.2.1.3.cmml" xref="S4.E5.m2.2.2.2.2.2.1.3"></emptyset></apply><apply id="S4.E5.m2.3.3.3.3.1.1.cmml" xref="S4.E5.m2.3.3.3.3.1.1"><apply id="S4.E5.m2.3.3.3.3.1.1.3.cmml" xref="S4.E5.m2.3.3.3.3.1.1.3"><csymbol cd="ambiguous" id="S4.E5.m2.3.3.3.3.1.1.3.1.cmml" xref="S4.E5.m2.3.3.3.3.1.1.3">subscript</csymbol><sum id="S4.E5.m2.3.3.3.3.1.1.3.2.cmml" xref="S4.E5.m2.3.3.3.3.1.1.3.2"></sum><ci id="S4.E5.m2.3.3.3.3.1.1.3.3.cmml" xref="S4.E5.m2.3.3.3.3.1.1.3.3">𝑖</ci></apply><apply id="S4.E5.m2.3.3.3.3.1.1.2.cmml" xref="S4.E5.m2.3.3.3.3.1.1.2"><times id="S4.E5.m2.3.3.3.3.1.1.2.3.cmml" xref="S4.E5.m2.3.3.3.3.1.1.2.3"></times><ci id="S4.E5.m2.3.3.3.3.1.1.2.4.cmml" xref="S4.E5.m2.3.3.3.3.1.1.2.4">ℒ</ci><interval closure="open" id="S4.E5.m2.3.3.3.3.1.1.2.2.3.cmml" xref="S4.E5.m2.3.3.3.3.1.1.2.2.2"><apply id="S4.E5.m2.3.3.3.3.1.1.1.1.1.1.cmml" xref="S4.E5.m2.3.3.3.3.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.E5.m2.3.3.3.3.1.1.1.1.1.1.1.cmml" xref="S4.E5.m2.3.3.3.3.1.1.1.1.1.1">subscript</csymbol><apply id="S4.E5.m2.3.3.3.3.1.1.1.1.1.1.2.cmml" xref="S4.E5.m2.3.3.3.3.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.E5.m2.3.3.3.3.1.1.1.1.1.1.2.1.cmml" xref="S4.E5.m2.3.3.3.3.1.1.1.1.1.1">superscript</csymbol><ci id="S4.E5.m2.3.3.3.3.1.1.1.1.1.1.2.2.cmml" xref="S4.E5.m2.3.3.3.3.1.1.1.1.1.1.2.2">𝑥</ci><ci id="S4.E5.m2.3.3.3.3.1.1.1.1.1.1.2.3.cmml" xref="S4.E5.m2.3.3.3.3.1.1.1.1.1.1.2.3">𝑢</ci></apply><ci id="S4.E5.m2.3.3.3.3.1.1.1.1.1.1.3.cmml" xref="S4.E5.m2.3.3.3.3.1.1.1.1.1.1.3">𝑖</ci></apply><apply id="S4.E5.m2.3.3.3.3.1.1.2.2.2.2.cmml" xref="S4.E5.m2.3.3.3.3.1.1.2.2.2.2"><csymbol cd="ambiguous" id="S4.E5.m2.3.3.3.3.1.1.2.2.2.2.1.cmml" xref="S4.E5.m2.3.3.3.3.1.1.2.2.2.2">subscript</csymbol><apply id="S4.E5.m2.3.3.3.3.1.1.2.2.2.2.2.cmml" xref="S4.E5.m2.3.3.3.3.1.1.2.2.2.2"><csymbol cd="ambiguous" id="S4.E5.m2.3.3.3.3.1.1.2.2.2.2.2.1.cmml" xref="S4.E5.m2.3.3.3.3.1.1.2.2.2.2">superscript</csymbol><ci id="S4.E5.m2.3.3.3.3.1.1.2.2.2.2.2.2.cmml" xref="S4.E5.m2.3.3.3.3.1.1.2.2.2.2.2.2">𝑦</ci><ci id="S4.E5.m2.3.3.3.3.1.1.2.2.2.2.2.3.cmml" xref="S4.E5.m2.3.3.3.3.1.1.2.2.2.2.2.3">𝑆</ci></apply><ci id="S4.E5.m2.3.3.3.3.1.1.2.2.2.2.3.cmml" xref="S4.E5.m2.3.3.3.3.1.1.2.2.2.2.3">𝑖</ci></apply></interval></apply></apply><ci id="S4.E5.m2.4.4.4.4.2.1a.cmml" xref="S4.E5.m2.4.4.4.4.2.1"><mtext id="S4.E5.m2.4.4.4.4.2.1.cmml" xref="S4.E5.m2.4.4.4.4.2.1">otherwise</mtext></ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.E5.m2.4c">\displaystyle=\begin{cases}\sum_{i}\mathcal{L}(x^{u}_{i},y^{T^{\prime}}_{i})&amp;\text{if }T^{\prime}\neq\emptyset\\
\sum_{i}\mathcal{L}(x^{u}_{i},y^{S}_{i})&amp;\text{otherwise}\end{cases}</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(5)</span></td>
</tr></tbody>
</table>
<p id="S4.p7.8" class="ltx_p">where <math id="S4.p7.5.m1.1" class="ltx_Math" alttext="y^{T}_{i}" display="inline"><semantics id="S4.p7.5.m1.1a"><msubsup id="S4.p7.5.m1.1.1" xref="S4.p7.5.m1.1.1.cmml"><mi id="S4.p7.5.m1.1.1.2.2" xref="S4.p7.5.m1.1.1.2.2.cmml">y</mi><mi id="S4.p7.5.m1.1.1.3" xref="S4.p7.5.m1.1.1.3.cmml">i</mi><mi id="S4.p7.5.m1.1.1.2.3" xref="S4.p7.5.m1.1.1.2.3.cmml">T</mi></msubsup><annotation-xml encoding="MathML-Content" id="S4.p7.5.m1.1b"><apply id="S4.p7.5.m1.1.1.cmml" xref="S4.p7.5.m1.1.1"><csymbol cd="ambiguous" id="S4.p7.5.m1.1.1.1.cmml" xref="S4.p7.5.m1.1.1">subscript</csymbol><apply id="S4.p7.5.m1.1.1.2.cmml" xref="S4.p7.5.m1.1.1"><csymbol cd="ambiguous" id="S4.p7.5.m1.1.1.2.1.cmml" xref="S4.p7.5.m1.1.1">superscript</csymbol><ci id="S4.p7.5.m1.1.1.2.2.cmml" xref="S4.p7.5.m1.1.1.2.2">𝑦</ci><ci id="S4.p7.5.m1.1.1.2.3.cmml" xref="S4.p7.5.m1.1.1.2.3">𝑇</ci></apply><ci id="S4.p7.5.m1.1.1.3.cmml" xref="S4.p7.5.m1.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.p7.5.m1.1c">y^{T}_{i}</annotation></semantics></math> and <math id="S4.p7.6.m2.1" class="ltx_Math" alttext="y^{S}_{i}" display="inline"><semantics id="S4.p7.6.m2.1a"><msubsup id="S4.p7.6.m2.1.1" xref="S4.p7.6.m2.1.1.cmml"><mi id="S4.p7.6.m2.1.1.2.2" xref="S4.p7.6.m2.1.1.2.2.cmml">y</mi><mi id="S4.p7.6.m2.1.1.3" xref="S4.p7.6.m2.1.1.3.cmml">i</mi><mi id="S4.p7.6.m2.1.1.2.3" xref="S4.p7.6.m2.1.1.2.3.cmml">S</mi></msubsup><annotation-xml encoding="MathML-Content" id="S4.p7.6.m2.1b"><apply id="S4.p7.6.m2.1.1.cmml" xref="S4.p7.6.m2.1.1"><csymbol cd="ambiguous" id="S4.p7.6.m2.1.1.1.cmml" xref="S4.p7.6.m2.1.1">subscript</csymbol><apply id="S4.p7.6.m2.1.1.2.cmml" xref="S4.p7.6.m2.1.1"><csymbol cd="ambiguous" id="S4.p7.6.m2.1.1.2.1.cmml" xref="S4.p7.6.m2.1.1">superscript</csymbol><ci id="S4.p7.6.m2.1.1.2.2.cmml" xref="S4.p7.6.m2.1.1.2.2">𝑦</ci><ci id="S4.p7.6.m2.1.1.2.3.cmml" xref="S4.p7.6.m2.1.1.2.3">𝑆</ci></apply><ci id="S4.p7.6.m2.1.1.3.cmml" xref="S4.p7.6.m2.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.p7.6.m2.1c">y^{S}_{i}</annotation></semantics></math> are the pseudo-labels generated via the teacher and student model on the weakly augmented version of the <math id="S4.p7.7.m3.1" class="ltx_Math" alttext="i" display="inline"><semantics id="S4.p7.7.m3.1a"><mi id="S4.p7.7.m3.1.1" xref="S4.p7.7.m3.1.1.cmml">i</mi><annotation-xml encoding="MathML-Content" id="S4.p7.7.m3.1b"><ci id="S4.p7.7.m3.1.1.cmml" xref="S4.p7.7.m3.1.1">𝑖</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.p7.7.m3.1c">i</annotation></semantics></math>-th unlabeled example <math id="S4.p7.8.m4.1" class="ltx_Math" alttext="x^{u}_{i}" display="inline"><semantics id="S4.p7.8.m4.1a"><msubsup id="S4.p7.8.m4.1.1" xref="S4.p7.8.m4.1.1.cmml"><mi id="S4.p7.8.m4.1.1.2.2" xref="S4.p7.8.m4.1.1.2.2.cmml">x</mi><mi id="S4.p7.8.m4.1.1.3" xref="S4.p7.8.m4.1.1.3.cmml">i</mi><mi id="S4.p7.8.m4.1.1.2.3" xref="S4.p7.8.m4.1.1.2.3.cmml">u</mi></msubsup><annotation-xml encoding="MathML-Content" id="S4.p7.8.m4.1b"><apply id="S4.p7.8.m4.1.1.cmml" xref="S4.p7.8.m4.1.1"><csymbol cd="ambiguous" id="S4.p7.8.m4.1.1.1.cmml" xref="S4.p7.8.m4.1.1">subscript</csymbol><apply id="S4.p7.8.m4.1.1.2.cmml" xref="S4.p7.8.m4.1.1"><csymbol cd="ambiguous" id="S4.p7.8.m4.1.1.2.1.cmml" xref="S4.p7.8.m4.1.1">superscript</csymbol><ci id="S4.p7.8.m4.1.1.2.2.cmml" xref="S4.p7.8.m4.1.1.2.2">𝑥</ci><ci id="S4.p7.8.m4.1.1.2.3.cmml" xref="S4.p7.8.m4.1.1.2.3">𝑢</ci></apply><ci id="S4.p7.8.m4.1.1.3.cmml" xref="S4.p7.8.m4.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.p7.8.m4.1c">x^{u}_{i}</annotation></semantics></math> respectively.</p>
</div>
</section>
<section id="S5" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">5 </span>Experiments</h2>

<section id="S5.SS1" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">5.1 </span>Datasets</h3>

<div id="S5.SS1.p1" class="ltx_para">
<p id="S5.SS1.p1.1" class="ltx_p">We conduct experiments and report results on the CIFAR-10 and Fashion MNIST datasets. We follow a similar dataset configuration as the FedMatch <cite class="ltx_cite ltx_citemacro_citep">(Jeong et al., <a href="#bib.bib13" title="" class="ltx_ref">2021</a>)</cite> paper under both the labels-at-client and labels-at-server configuration.</p>
</div>
<div id="S5.SS1.p2" class="ltx_para">
<p id="S5.SS1.p2.1" class="ltx_p"><span id="S5.SS1.p2.1.1" class="ltx_text ltx_font_bold">CIFAR-10.</span> We follow FedMatch’s custom split of the full dataset into 2,000 validation, 2,000 test, and 56,000 training images<span id="footnote1" class="ltx_note ltx_role_footnote"><sup class="ltx_note_mark">1</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">1</sup><span class="ltx_tag ltx_tag_note">1</span>While the FedMatch paper <cite class="ltx_cite ltx_citemacro_citep">(Jeong et al., <a href="#bib.bib13" title="" class="ltx_ref">2021</a>)</cite> states that they split the data into 3,000 validation, 3,000 test, and 54,000 training images, we chose to follow the split in their code at <a target="_blank" href="https://github.com/wyjeong/FedMatch/blob/main/config.py#L53-L54" title="" class="ltx_ref ltx_url ltx_font_typewriter">https://github.com/wyjeong/FedMatch/blob/main/config.py#L53-L54</a></span></span></span>. This is a common configuration followed by existing literature for comparison with state-of-the-art approaches. The configurations support 10 target classes and 100 clients with batch-IID and batch-nonIID splits under both labels-at-client and labels-at-server settings, which results in four scenarios. Under labels-at-client, each client has 5 labeled instances per class, while under labels-at-server, the labeled data (5000 instances) resides at the server with completely unlabeled data at the clients.</p>
</div>
<div id="S5.SS1.p3" class="ltx_para">
<p id="S5.SS1.p3.1" class="ltx_p"><span id="S5.SS1.p3.1.1" class="ltx_text ltx_font_bold">Fashion MNIST.</span> Similar to CIFAR-10, we also implement the same data configuration for the Fashion MNIST dataset as provided in the FedMatch <cite class="ltx_cite ltx_citemacro_citep">(Jeong et al., <a href="#bib.bib13" title="" class="ltx_ref">2021</a>)</cite> paper. The authors however have not released their Fashion MNIST code, so we have resorted to a self-implementation of their streaming non-IID setting which follows the paper as closely as possible. The entire dataset of 70000 images is split into 63000 training, 3500 validation and 3500 testing images. We assume that the unlabeled data on each client is imbalanced and streams in at every round when the client is selected, which is the same setting as <span id="S5.SS1.p3.1.2" class="ltx_text ltx_font_italic">Streaming-NonIID</span> as in the FedMatch implementation. For this dataset, we assume two cases - labels-at-client, where the labeled and unlabeled instances reside at the client, and labels-at-server, where the unlabeled instances reside at the client, with labeled data at the server.</p>
</div>
</section>
<section id="S5.SS2" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">5.2 </span>Experimental setup</h3>

<div id="S5.SS2.p1" class="ltx_para ltx_noindent">
<p id="S5.SS2.p1.1" class="ltx_p"><span id="S5.SS2.p1.1.1" class="ltx_text ltx_font_bold">CIFAR-10.</span> For experiments on the CIFAR-10 dataset, all training runs use 100 clients in total, 5 clients per round, and 1 local client epoch per round. For ease of comparison with baseline approaches, we follow FedMatch settings in our implementation. Data is distributed evenly across 100 clients for labels-at-client, i.e. we have 5 labels per class per client for a total of 5,000 labeled examples. The remaining training data is unlabeled, and split either evenly (batch-IID) or with class-imbalance (batch-nonIID) across clients. The setup for labels-at-server setting assumes 100 labeled instances per class on the server, and 550 unlabeled training images per client.</p>
</div>
<div id="S5.SS2.p2" class="ltx_para">
<p id="S5.SS2.p2.1" class="ltx_p"><span id="S5.SS2.p2.1.1" class="ltx_text ltx_font_bold">Fashion MNIST.</span> FSSL training on Fashion MNIST considers 10 clients and 1 local epoch per round, with all clients participating per round. The <span id="S5.SS2.p2.1.2" class="ltx_text ltx_font_italic">Streaming-NonIID</span> setting assumes the unlabeled data on each client is split into the number of streaming steps (which is 10), with each split being used for training every round. In all experiments, we use weakly augmented images with flip-and-shift in contrast to FedMatch’s approach, where they utilize original images. We have observed this to lead to improved training stability and generalization performance, particularly under labels-at-server setting.</p>
</div>
</section>
<section id="S5.SS3" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">5.3 </span>Hyper-parameters</h3>

<div id="S5.SS3.p1" class="ltx_para">
<p id="S5.SS3.p1.1" class="ltx_p">For our FedProx-FixMatch, EMA baselines, and <span id="S5.SS3.p1.1.1" class="ltx_text ltx_font_italic">FedSwitch</span> implementations,
we tuned the learning rate, pseudo-label threshold, weight of the unlabeled loss, weight decay, optimizer momentum, and EMA decay (where applicable).
For each method, the best performing hyper-parameters are utilized to run five trial training runs, where each trial has a different seed corresponding to the user selector, model initialization and dataset sharding. For each method, we record the average over five trials along with the standard deviation.
</p>
</div>
</section>
<section id="S5.SS4" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">5.4 </span>Performance under increasing non-IIDness</h3>

<div id="S5.SS4.p1" class="ltx_para ltx_noindent">
<p id="S5.SS4.p1.5" class="ltx_p">Practical federated learning settings are often non-IID, where the client devices differ from each other in label distribution. The client non-IIDness property is perhaps the best-studied of all constraints <cite class="ltx_cite ltx_citemacro_citep">(Zhu et al., <a href="#bib.bib40" title="" class="ltx_ref">2021</a>)</cite>, and we follow Dirichlet sampling to simulate non-IIDness of both labeled and unlabeled data, as done in Hsu et al. <cite class="ltx_cite ltx_citemacro_citep">(Hsu et al., <a href="#bib.bib12" title="" class="ltx_ref">2019</a>)</cite>. The Dirichlet alpha <math id="S5.SS4.p1.1.m1.1" class="ltx_Math" alttext="\alpha" display="inline"><semantics id="S5.SS4.p1.1.m1.1a"><mi id="S5.SS4.p1.1.m1.1.1" xref="S5.SS4.p1.1.m1.1.1.cmml">α</mi><annotation-xml encoding="MathML-Content" id="S5.SS4.p1.1.m1.1b"><ci id="S5.SS4.p1.1.m1.1.1.cmml" xref="S5.SS4.p1.1.m1.1.1">𝛼</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.SS4.p1.1.m1.1c">\alpha</annotation></semantics></math> controls the level of non-IIDness. For extremely non-IID setting <math id="S5.SS4.p1.2.m2.1" class="ltx_Math" alttext="\alpha" display="inline"><semantics id="S5.SS4.p1.2.m2.1a"><mi id="S5.SS4.p1.2.m2.1.1" xref="S5.SS4.p1.2.m2.1.1.cmml">α</mi><annotation-xml encoding="MathML-Content" id="S5.SS4.p1.2.m2.1b"><ci id="S5.SS4.p1.2.m2.1.1.cmml" xref="S5.SS4.p1.2.m2.1.1">𝛼</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.SS4.p1.2.m2.1c">\alpha</annotation></semantics></math> is low, as <math id="S5.SS4.p1.3.m3.1" class="ltx_Math" alttext="\alpha" display="inline"><semantics id="S5.SS4.p1.3.m3.1a"><mi id="S5.SS4.p1.3.m3.1.1" xref="S5.SS4.p1.3.m3.1.1.cmml">α</mi><annotation-xml encoding="MathML-Content" id="S5.SS4.p1.3.m3.1b"><ci id="S5.SS4.p1.3.m3.1.1.cmml" xref="S5.SS4.p1.3.m3.1.1">𝛼</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.SS4.p1.3.m3.1c">\alpha</annotation></semantics></math> increases, samples are sharded more uniformly across clients. See Figure <a href="#S3.F2" title="Figure 2 ‣ 3.3 Practical challenges with EMA models in FL ‣ 3 Preliminaries ‣ When does the student surpass the teacher? Federated Semi-supervised Learning with Teacher-Student EMA" class="ltx_ref"><span class="ltx_text ltx_ref_tag">2</span></a> for a visualization of samples on each clients under various degrees of non-IIDness (<math id="S5.SS4.p1.4.m4.1" class="ltx_Math" alttext="\alpha" display="inline"><semantics id="S5.SS4.p1.4.m4.1a"><mi id="S5.SS4.p1.4.m4.1.1" xref="S5.SS4.p1.4.m4.1.1.cmml">α</mi><annotation-xml encoding="MathML-Content" id="S5.SS4.p1.4.m4.1b"><ci id="S5.SS4.p1.4.m4.1.1.cmml" xref="S5.SS4.p1.4.m4.1.1">𝛼</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.SS4.p1.4.m4.1c">\alpha</annotation></semantics></math>). We choose <math id="S5.SS4.p1.5.m5.6" class="ltx_Math" alttext="\alpha\in\{0.01,0.05,0.1,1.0,10.0,100.0\}" display="inline"><semantics id="S5.SS4.p1.5.m5.6a"><mrow id="S5.SS4.p1.5.m5.6.7" xref="S5.SS4.p1.5.m5.6.7.cmml"><mi id="S5.SS4.p1.5.m5.6.7.2" xref="S5.SS4.p1.5.m5.6.7.2.cmml">α</mi><mo id="S5.SS4.p1.5.m5.6.7.1" xref="S5.SS4.p1.5.m5.6.7.1.cmml">∈</mo><mrow id="S5.SS4.p1.5.m5.6.7.3.2" xref="S5.SS4.p1.5.m5.6.7.3.1.cmml"><mo stretchy="false" id="S5.SS4.p1.5.m5.6.7.3.2.1" xref="S5.SS4.p1.5.m5.6.7.3.1.cmml">{</mo><mn id="S5.SS4.p1.5.m5.1.1" xref="S5.SS4.p1.5.m5.1.1.cmml">0.01</mn><mo id="S5.SS4.p1.5.m5.6.7.3.2.2" xref="S5.SS4.p1.5.m5.6.7.3.1.cmml">,</mo><mn id="S5.SS4.p1.5.m5.2.2" xref="S5.SS4.p1.5.m5.2.2.cmml">0.05</mn><mo id="S5.SS4.p1.5.m5.6.7.3.2.3" xref="S5.SS4.p1.5.m5.6.7.3.1.cmml">,</mo><mn id="S5.SS4.p1.5.m5.3.3" xref="S5.SS4.p1.5.m5.3.3.cmml">0.1</mn><mo id="S5.SS4.p1.5.m5.6.7.3.2.4" xref="S5.SS4.p1.5.m5.6.7.3.1.cmml">,</mo><mn id="S5.SS4.p1.5.m5.4.4" xref="S5.SS4.p1.5.m5.4.4.cmml">1.0</mn><mo id="S5.SS4.p1.5.m5.6.7.3.2.5" xref="S5.SS4.p1.5.m5.6.7.3.1.cmml">,</mo><mn id="S5.SS4.p1.5.m5.5.5" xref="S5.SS4.p1.5.m5.5.5.cmml">10.0</mn><mo id="S5.SS4.p1.5.m5.6.7.3.2.6" xref="S5.SS4.p1.5.m5.6.7.3.1.cmml">,</mo><mn id="S5.SS4.p1.5.m5.6.6" xref="S5.SS4.p1.5.m5.6.6.cmml">100.0</mn><mo stretchy="false" id="S5.SS4.p1.5.m5.6.7.3.2.7" xref="S5.SS4.p1.5.m5.6.7.3.1.cmml">}</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S5.SS4.p1.5.m5.6b"><apply id="S5.SS4.p1.5.m5.6.7.cmml" xref="S5.SS4.p1.5.m5.6.7"><in id="S5.SS4.p1.5.m5.6.7.1.cmml" xref="S5.SS4.p1.5.m5.6.7.1"></in><ci id="S5.SS4.p1.5.m5.6.7.2.cmml" xref="S5.SS4.p1.5.m5.6.7.2">𝛼</ci><set id="S5.SS4.p1.5.m5.6.7.3.1.cmml" xref="S5.SS4.p1.5.m5.6.7.3.2"><cn type="float" id="S5.SS4.p1.5.m5.1.1.cmml" xref="S5.SS4.p1.5.m5.1.1">0.01</cn><cn type="float" id="S5.SS4.p1.5.m5.2.2.cmml" xref="S5.SS4.p1.5.m5.2.2">0.05</cn><cn type="float" id="S5.SS4.p1.5.m5.3.3.cmml" xref="S5.SS4.p1.5.m5.3.3">0.1</cn><cn type="float" id="S5.SS4.p1.5.m5.4.4.cmml" xref="S5.SS4.p1.5.m5.4.4">1.0</cn><cn type="float" id="S5.SS4.p1.5.m5.5.5.cmml" xref="S5.SS4.p1.5.m5.5.5">10.0</cn><cn type="float" id="S5.SS4.p1.5.m5.6.6.cmml" xref="S5.SS4.p1.5.m5.6.6">100.0</cn></set></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS4.p1.5.m5.6c">\alpha\in\{0.01,0.05,0.1,1.0,10.0,100.0\}</annotation></semantics></math> to cover the entire range of non-IIDness adequately. We expect that as non-IIDness increases, performance should decrease as reported in literature <cite class="ltx_cite ltx_citemacro_citep">(McMahan et al., <a href="#bib.bib25" title="" class="ltx_ref">2017</a>)</cite>.</p>
</div>
<div id="S5.SS4.p2" class="ltx_para">
<p id="S5.SS4.p2.1" class="ltx_p">We measure the KL-Divergence (with an uniform distribution as a reference similar to that described in Section <a href="#S4" title="4 Proposed Method: FedSwitch ‣ When does the student surpass the teacher? Federated Semi-supervised Learning with Teacher-Student EMA" class="ltx_ref"><span class="ltx_text ltx_ref_tag">4</span></a>) of the ground truth label distribution and the teacher-generated pseudo-label distribution for each client and compute the average over all participating clients within each round. For our baseline EMA approaches we conduct a further analysis by
measuring the ratio of the pseudo-label KL divergence to the ground truth label KL divergence at steady state convergence and comparing different approaches based on this metric.</p>
</div>
<figure id="S5.F3" class="ltx_figure">
<div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_2"><img src="/html/2301.10114/assets/figures/f3_ema_las_sequential_2000.png" id="S5.F3.g1" class="ltx_graphics ltx_centering ltx_figure_panel ltx_img_landscape" width="281" height="155" alt="Refer to caption"></div>
<div class="ltx_flex_cell ltx_flex_size_2"><img src="/html/2301.10114/assets/figures/f3_las_sequential.png" id="S5.F3.g2" class="ltx_graphics ltx_centering ltx_figure_panel ltx_img_landscape" width="281" height="156" alt="Refer to caption"></div>
</div>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 3: </span>Left: KL divergence of the predictions generated by TS-Server EMA against a uniform distribution throughout training for various degrees of non-IIDness (alpha). Dotted lines are the KL divergence of the labels against a uniform distribution (ground truth). Right: KL divergence of the predictions generated by <span id="S5.F3.2.1" class="ltx_text ltx_font_italic">FedSwitch</span> divided by the KL divergence of the labels for the last 100 epochs of training (after training has stabilized).
</figcaption>
</figure>
<figure id="S5.T2" class="ltx_table">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_table">Table 2: </span>Performance of all competing approaches on the CIFAR-10 dataset. For each approach, we report the mean performance, along with standard deviation over five trials and 800 epochs. The best configuration for each approach is obtained through a hyper-parameter search. Results are reported for both Batch-IID and Batch-NonIID settings under labels-at-client and labels-at-server configurations.* refers to existing work that cuts off training at 200 rounds when not yet fully converged.</figcaption>
<table id="S5.T2.24" class="ltx_tabular ltx_centering ltx_guessed_headers ltx_align_middle">
<tbody class="ltx_tbody">
<tr id="S5.T2.24.25.1" class="ltx_tr">
<th id="S5.T2.24.25.1.1" class="ltx_td ltx_th ltx_th_row ltx_border_r ltx_border_t"></th>
<td id="S5.T2.24.25.1.2" class="ltx_td ltx_align_center ltx_border_t" colspan="4">Client/Server Configuration</td>
</tr>
<tr id="S5.T2.24.26.2" class="ltx_tr">
<th id="S5.T2.24.26.2.1" class="ltx_td ltx_th ltx_th_row ltx_border_r ltx_border_t"></th>
<td id="S5.T2.24.26.2.2" class="ltx_td ltx_align_center ltx_border_t" colspan="2">Labels at Client</td>
<td id="S5.T2.24.26.2.3" class="ltx_td ltx_align_center ltx_border_t" colspan="2">Labels at Server</td>
</tr>
<tr id="S5.T2.24.27.3" class="ltx_tr">
<th id="S5.T2.24.27.3.1" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r ltx_border_t">Approach</th>
<td id="S5.T2.24.27.3.2" class="ltx_td ltx_align_center ltx_border_t">Batch-IID</td>
<td id="S5.T2.24.27.3.3" class="ltx_td ltx_align_center ltx_border_t">Batch-NonIID</td>
<td id="S5.T2.24.27.3.4" class="ltx_td ltx_align_center ltx_border_t">Batch-IID</td>
<td id="S5.T2.24.27.3.5" class="ltx_td ltx_align_center ltx_border_t">Batch-NonIID</td>
</tr>
<tr id="S5.T2.24.28.4" class="ltx_tr">
<th id="S5.T2.24.28.4.1" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r ltx_border_t">FedRGD</th>
<td id="S5.T2.24.28.4.2" class="ltx_td ltx_align_center ltx_border_t">71.61</td>
<td id="S5.T2.24.28.4.3" class="ltx_td ltx_align_center ltx_border_t">69.05</td>
<td id="S5.T2.24.28.4.4" class="ltx_td ltx_align_center ltx_border_t">63.32</td>
<td id="S5.T2.24.28.4.5" class="ltx_td ltx_align_center ltx_border_t">63.24</td>
</tr>
<tr id="S5.T2.4.4" class="ltx_tr">
<th id="S5.T2.4.4.5" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r">FedMatch*</th>
<td id="S5.T2.1.1.1" class="ltx_td ltx_align_center">52.13<math id="S5.T2.1.1.1.m1.1" class="ltx_Math" alttext="\pm" display="inline"><semantics id="S5.T2.1.1.1.m1.1a"><mo id="S5.T2.1.1.1.m1.1.1" xref="S5.T2.1.1.1.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S5.T2.1.1.1.m1.1b"><csymbol cd="latexml" id="S5.T2.1.1.1.m1.1.1.cmml" xref="S5.T2.1.1.1.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S5.T2.1.1.1.m1.1c">\pm</annotation></semantics></math>0.34</td>
<td id="S5.T2.2.2.2" class="ltx_td ltx_align_center">52.25<math id="S5.T2.2.2.2.m1.1" class="ltx_Math" alttext="\pm" display="inline"><semantics id="S5.T2.2.2.2.m1.1a"><mo id="S5.T2.2.2.2.m1.1.1" xref="S5.T2.2.2.2.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S5.T2.2.2.2.m1.1b"><csymbol cd="latexml" id="S5.T2.2.2.2.m1.1.1.cmml" xref="S5.T2.2.2.2.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S5.T2.2.2.2.m1.1c">\pm</annotation></semantics></math>0.81</td>
<td id="S5.T2.3.3.3" class="ltx_td ltx_align_center">44.95<math id="S5.T2.3.3.3.m1.1" class="ltx_Math" alttext="\pm" display="inline"><semantics id="S5.T2.3.3.3.m1.1a"><mo id="S5.T2.3.3.3.m1.1.1" xref="S5.T2.3.3.3.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S5.T2.3.3.3.m1.1b"><csymbol cd="latexml" id="S5.T2.3.3.3.m1.1.1.cmml" xref="S5.T2.3.3.3.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S5.T2.3.3.3.m1.1c">\pm</annotation></semantics></math>0.49</td>
<td id="S5.T2.4.4.4" class="ltx_td ltx_align_center">44.17<math id="S5.T2.4.4.4.m1.1" class="ltx_Math" alttext="\pm" display="inline"><semantics id="S5.T2.4.4.4.m1.1a"><mo id="S5.T2.4.4.4.m1.1.1" xref="S5.T2.4.4.4.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S5.T2.4.4.4.m1.1b"><csymbol cd="latexml" id="S5.T2.4.4.4.m1.1.1.cmml" xref="S5.T2.4.4.4.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S5.T2.4.4.4.m1.1c">\pm</annotation></semantics></math>0.19</td>
</tr>
<tr id="S5.T2.8.8" class="ltx_tr">
<th id="S5.T2.8.8.5" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r">FedProx-FixMatch*</th>
<td id="S5.T2.5.5.1" class="ltx_td ltx_align_center">47.20 <math id="S5.T2.5.5.1.m1.1" class="ltx_Math" alttext="\pm" display="inline"><semantics id="S5.T2.5.5.1.m1.1a"><mo id="S5.T2.5.5.1.m1.1.1" xref="S5.T2.5.5.1.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S5.T2.5.5.1.m1.1b"><csymbol cd="latexml" id="S5.T2.5.5.1.m1.1.1.cmml" xref="S5.T2.5.5.1.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S5.T2.5.5.1.m1.1c">\pm</annotation></semantics></math> 0.12</td>
<td id="S5.T2.6.6.2" class="ltx_td ltx_align_center">45.55 <math id="S5.T2.6.6.2.m1.1" class="ltx_Math" alttext="\pm" display="inline"><semantics id="S5.T2.6.6.2.m1.1a"><mo id="S5.T2.6.6.2.m1.1.1" xref="S5.T2.6.6.2.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S5.T2.6.6.2.m1.1b"><csymbol cd="latexml" id="S5.T2.6.6.2.m1.1.1.cmml" xref="S5.T2.6.6.2.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S5.T2.6.6.2.m1.1c">\pm</annotation></semantics></math> 0.63</td>
<td id="S5.T2.7.7.3" class="ltx_td ltx_align_center">25.61<math id="S5.T2.7.7.3.m1.1" class="ltx_Math" alttext="\pm" display="inline"><semantics id="S5.T2.7.7.3.m1.1a"><mo id="S5.T2.7.7.3.m1.1.1" xref="S5.T2.7.7.3.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S5.T2.7.7.3.m1.1b"><csymbol cd="latexml" id="S5.T2.7.7.3.m1.1.1.cmml" xref="S5.T2.7.7.3.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S5.T2.7.7.3.m1.1c">\pm</annotation></semantics></math>0.32</td>
<td id="S5.T2.8.8.4" class="ltx_td ltx_align_center">9.21<math id="S5.T2.8.8.4.m1.1" class="ltx_Math" alttext="\pm" display="inline"><semantics id="S5.T2.8.8.4.m1.1a"><mo id="S5.T2.8.8.4.m1.1.1" xref="S5.T2.8.8.4.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S5.T2.8.8.4.m1.1b"><csymbol cd="latexml" id="S5.T2.8.8.4.m1.1.1.cmml" xref="S5.T2.8.8.4.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S5.T2.8.8.4.m1.1c">\pm</annotation></semantics></math>0.24</td>
</tr>
<tr id="S5.T2.12.12" class="ltx_tr">
<th id="S5.T2.12.12.5" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r">FedProx-FixMatch (ours)</th>
<td id="S5.T2.9.9.1" class="ltx_td ltx_align_center">90.02<math id="S5.T2.9.9.1.m1.1" class="ltx_Math" alttext="\pm" display="inline"><semantics id="S5.T2.9.9.1.m1.1a"><mo id="S5.T2.9.9.1.m1.1.1" xref="S5.T2.9.9.1.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S5.T2.9.9.1.m1.1b"><csymbol cd="latexml" id="S5.T2.9.9.1.m1.1.1.cmml" xref="S5.T2.9.9.1.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S5.T2.9.9.1.m1.1c">\pm</annotation></semantics></math>0.4</td>
<td id="S5.T2.10.10.2" class="ltx_td ltx_align_center">89.54<math id="S5.T2.10.10.2.m1.1" class="ltx_Math" alttext="\pm" display="inline"><semantics id="S5.T2.10.10.2.m1.1a"><mo id="S5.T2.10.10.2.m1.1.1" xref="S5.T2.10.10.2.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S5.T2.10.10.2.m1.1b"><csymbol cd="latexml" id="S5.T2.10.10.2.m1.1.1.cmml" xref="S5.T2.10.10.2.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S5.T2.10.10.2.m1.1c">\pm</annotation></semantics></math>0.82</td>
<td id="S5.T2.11.11.3" class="ltx_td ltx_align_center">89.8<math id="S5.T2.11.11.3.m1.1" class="ltx_Math" alttext="\pm" display="inline"><semantics id="S5.T2.11.11.3.m1.1a"><mo id="S5.T2.11.11.3.m1.1.1" xref="S5.T2.11.11.3.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S5.T2.11.11.3.m1.1b"><csymbol cd="latexml" id="S5.T2.11.11.3.m1.1.1.cmml" xref="S5.T2.11.11.3.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S5.T2.11.11.3.m1.1c">\pm</annotation></semantics></math>0.72</td>
<td id="S5.T2.12.12.4" class="ltx_td ltx_align_center">88.19<math id="S5.T2.12.12.4.m1.1" class="ltx_Math" alttext="\pm" display="inline"><semantics id="S5.T2.12.12.4.m1.1a"><mo id="S5.T2.12.12.4.m1.1.1" xref="S5.T2.12.12.4.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S5.T2.12.12.4.m1.1b"><csymbol cd="latexml" id="S5.T2.12.12.4.m1.1.1.cmml" xref="S5.T2.12.12.4.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S5.T2.12.12.4.m1.1c">\pm</annotation></semantics></math>1.10</td>
</tr>
<tr id="S5.T2.16.16" class="ltx_tr">
<th id="S5.T2.16.16.5" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r">TS-Server EMA</th>
<td id="S5.T2.13.13.1" class="ltx_td ltx_align_center">89.43<math id="S5.T2.13.13.1.m1.1" class="ltx_Math" alttext="\pm" display="inline"><semantics id="S5.T2.13.13.1.m1.1a"><mo id="S5.T2.13.13.1.m1.1.1" xref="S5.T2.13.13.1.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S5.T2.13.13.1.m1.1b"><csymbol cd="latexml" id="S5.T2.13.13.1.m1.1.1.cmml" xref="S5.T2.13.13.1.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S5.T2.13.13.1.m1.1c">\pm</annotation></semantics></math>0.60</td>
<td id="S5.T2.14.14.2" class="ltx_td ltx_align_center">85.43<math id="S5.T2.14.14.2.m1.1" class="ltx_Math" alttext="\pm" display="inline"><semantics id="S5.T2.14.14.2.m1.1a"><mo id="S5.T2.14.14.2.m1.1.1" xref="S5.T2.14.14.2.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S5.T2.14.14.2.m1.1b"><csymbol cd="latexml" id="S5.T2.14.14.2.m1.1.1.cmml" xref="S5.T2.14.14.2.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S5.T2.14.14.2.m1.1c">\pm</annotation></semantics></math>0.87</td>
<td id="S5.T2.15.15.3" class="ltx_td ltx_align_center">89.15<math id="S5.T2.15.15.3.m1.1" class="ltx_Math" alttext="\pm" display="inline"><semantics id="S5.T2.15.15.3.m1.1a"><mo id="S5.T2.15.15.3.m1.1.1" xref="S5.T2.15.15.3.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S5.T2.15.15.3.m1.1b"><csymbol cd="latexml" id="S5.T2.15.15.3.m1.1.1.cmml" xref="S5.T2.15.15.3.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S5.T2.15.15.3.m1.1c">\pm</annotation></semantics></math>0.95</td>
<td id="S5.T2.16.16.4" class="ltx_td ltx_align_center">73.26<math id="S5.T2.16.16.4.m1.1" class="ltx_Math" alttext="\pm" display="inline"><semantics id="S5.T2.16.16.4.m1.1a"><mo id="S5.T2.16.16.4.m1.1.1" xref="S5.T2.16.16.4.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S5.T2.16.16.4.m1.1b"><csymbol cd="latexml" id="S5.T2.16.16.4.m1.1.1.cmml" xref="S5.T2.16.16.4.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S5.T2.16.16.4.m1.1c">\pm</annotation></semantics></math>0.98</td>
</tr>
<tr id="S5.T2.20.20" class="ltx_tr">
<th id="S5.T2.20.20.5" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r">TS-Client EMA</th>
<td id="S5.T2.17.17.1" class="ltx_td ltx_align_center">89.94<math id="S5.T2.17.17.1.m1.1" class="ltx_Math" alttext="\pm" display="inline"><semantics id="S5.T2.17.17.1.m1.1a"><mo id="S5.T2.17.17.1.m1.1.1" xref="S5.T2.17.17.1.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S5.T2.17.17.1.m1.1b"><csymbol cd="latexml" id="S5.T2.17.17.1.m1.1.1.cmml" xref="S5.T2.17.17.1.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S5.T2.17.17.1.m1.1c">\pm</annotation></semantics></math>0.91</td>
<td id="S5.T2.18.18.2" class="ltx_td ltx_align_center">87.41<math id="S5.T2.18.18.2.m1.1" class="ltx_Math" alttext="\pm" display="inline"><semantics id="S5.T2.18.18.2.m1.1a"><mo id="S5.T2.18.18.2.m1.1.1" xref="S5.T2.18.18.2.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S5.T2.18.18.2.m1.1b"><csymbol cd="latexml" id="S5.T2.18.18.2.m1.1.1.cmml" xref="S5.T2.18.18.2.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S5.T2.18.18.2.m1.1c">\pm</annotation></semantics></math>0.61</td>
<td id="S5.T2.19.19.3" class="ltx_td ltx_align_center">89.29<math id="S5.T2.19.19.3.m1.1" class="ltx_Math" alttext="\pm" display="inline"><semantics id="S5.T2.19.19.3.m1.1a"><mo id="S5.T2.19.19.3.m1.1.1" xref="S5.T2.19.19.3.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S5.T2.19.19.3.m1.1b"><csymbol cd="latexml" id="S5.T2.19.19.3.m1.1.1.cmml" xref="S5.T2.19.19.3.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S5.T2.19.19.3.m1.1c">\pm</annotation></semantics></math>0.63</td>
<td id="S5.T2.20.20.4" class="ltx_td ltx_align_center">78.43<math id="S5.T2.20.20.4.m1.1" class="ltx_Math" alttext="\pm" display="inline"><semantics id="S5.T2.20.20.4.m1.1a"><mo id="S5.T2.20.20.4.m1.1.1" xref="S5.T2.20.20.4.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S5.T2.20.20.4.m1.1b"><csymbol cd="latexml" id="S5.T2.20.20.4.m1.1.1.cmml" xref="S5.T2.20.20.4.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S5.T2.20.20.4.m1.1c">\pm</annotation></semantics></math>1.63</td>
</tr>
<tr id="S5.T2.24.24" class="ltx_tr">
<th id="S5.T2.24.24.5" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_b ltx_border_r"><span id="S5.T2.24.24.5.1" class="ltx_text ltx_font_italic">FedSwitch</span></th>
<td id="S5.T2.21.21.1" class="ltx_td ltx_align_center ltx_border_b"><span id="S5.T2.21.21.1.1" class="ltx_text ltx_font_bold">90.24<math id="S5.T2.21.21.1.1.m1.1" class="ltx_Math" alttext="\pm" display="inline"><semantics id="S5.T2.21.21.1.1.m1.1a"><mo id="S5.T2.21.21.1.1.m1.1.1" xref="S5.T2.21.21.1.1.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S5.T2.21.21.1.1.m1.1b"><csymbol cd="latexml" id="S5.T2.21.21.1.1.m1.1.1.cmml" xref="S5.T2.21.21.1.1.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S5.T2.21.21.1.1.m1.1c">\pm</annotation></semantics></math>0.60</span></td>
<td id="S5.T2.22.22.2" class="ltx_td ltx_align_center ltx_border_b"><span id="S5.T2.22.22.2.1" class="ltx_text ltx_font_bold">89.57<math id="S5.T2.22.22.2.1.m1.1" class="ltx_Math" alttext="\pm" display="inline"><semantics id="S5.T2.22.22.2.1.m1.1a"><mo id="S5.T2.22.22.2.1.m1.1.1" xref="S5.T2.22.22.2.1.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S5.T2.22.22.2.1.m1.1b"><csymbol cd="latexml" id="S5.T2.22.22.2.1.m1.1.1.cmml" xref="S5.T2.22.22.2.1.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S5.T2.22.22.2.1.m1.1c">\pm</annotation></semantics></math>0.55</span></td>
<td id="S5.T2.23.23.3" class="ltx_td ltx_align_center ltx_border_b"><span id="S5.T2.23.23.3.1" class="ltx_text ltx_font_bold">90.22<math id="S5.T2.23.23.3.1.m1.1" class="ltx_Math" alttext="\pm" display="inline"><semantics id="S5.T2.23.23.3.1.m1.1a"><mo id="S5.T2.23.23.3.1.m1.1.1" xref="S5.T2.23.23.3.1.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S5.T2.23.23.3.1.m1.1b"><csymbol cd="latexml" id="S5.T2.23.23.3.1.m1.1.1.cmml" xref="S5.T2.23.23.3.1.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S5.T2.23.23.3.1.m1.1c">\pm</annotation></semantics></math>0.49</span></td>
<td id="S5.T2.24.24.4" class="ltx_td ltx_align_center ltx_border_b"><span id="S5.T2.24.24.4.1" class="ltx_text ltx_font_bold">88.91<math id="S5.T2.24.24.4.1.m1.1" class="ltx_Math" alttext="\pm" display="inline"><semantics id="S5.T2.24.24.4.1.m1.1a"><mo id="S5.T2.24.24.4.1.m1.1.1" xref="S5.T2.24.24.4.1.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S5.T2.24.24.4.1.m1.1b"><csymbol cd="latexml" id="S5.T2.24.24.4.1.m1.1.1.cmml" xref="S5.T2.24.24.4.1.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S5.T2.24.24.4.1.m1.1c">\pm</annotation></semantics></math>0.50</span></td>
</tr>
</tbody>
</table>
</figure>
</section>
</section>
<section id="S6" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">6 </span>Experimental Results</h2>

<div id="S6.p1" class="ltx_para ltx_noindent">
<p id="S6.p1.1" class="ltx_p">We have described our experimental setup in Section <a href="#S5" title="5 Experiments ‣ When does the student surpass the teacher? Federated Semi-supervised Learning with Teacher-Student EMA" class="ltx_ref"><span class="ltx_text ltx_ref_tag">5</span></a>, which not only includes a comparison of the proposed method <span id="S6.p1.1.1" class="ltx_text ltx_font_italic">FedSwitch</span> with the state-of-the-art approaches such as FedMatch and FedRGD, but also baseline teacher-student EMA approaches. The experiments also include an analysis of generalization performance under increasing client non-IIDness, and demonstrate that <span id="S6.p1.1.2" class="ltx_text ltx_font_italic">FedSwitch</span> is relatively more robust compared to baseline approaches when the data distribution on each client is more imbalanced.</p>
</div>
<section id="S6.SS1" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">6.1 </span>Results on CIFAR-10 Dataset</h3>

<div id="S6.SS1.p1" class="ltx_para">
<p id="S6.SS1.p1.1" class="ltx_p">We benchmark our proposed method <span id="S6.SS1.p1.1.1" class="ltx_text ltx_font_italic">FedSwitch</span> against state-of-the-art methods as well as similar approaches, namely FedProx-FixMatch, FedMatch <cite class="ltx_cite ltx_citemacro_citep">(Jeong et al., <a href="#bib.bib13" title="" class="ltx_ref">2021</a>)</cite>, FedRGD <cite class="ltx_cite ltx_citemacro_citep">(Zhang et al., <a href="#bib.bib39" title="" class="ltx_ref">2021</a>)</cite>, and the EMA baselines (TS-Server EMA and TS-Client EMA).
Within the scope of this paper, we reproduce the FedProx-FixMatch that was originally discussed in FedMatch <cite class="ltx_cite ltx_citemacro_citep">(Jeong et al., <a href="#bib.bib13" title="" class="ltx_ref">2021</a>)</cite>, but instead of cutting off the training at 10 global epochs (200 training rounds) without reaching convergence, we let the method run until convergence (800 epochs, equals 16000 rounds). We ran each experimental setting under both labels-at-client and labels-at-server settings five times with various random dataset seeds and report the average performance and standard deviation. We present results on the CIFAR-10 dataset in Table <a href="#S6.SS1" title="6.1 Results on CIFAR-10 Dataset ‣ 6 Experimental Results ‣ When does the student surpass the teacher? Federated Semi-supervised Learning with Teacher-Student EMA" class="ltx_ref"><span class="ltx_text ltx_ref_tag">6.1</span></a>. <span id="S6.SS1.p1.1.2" class="ltx_text ltx_font_italic">FedSwitch</span> outperforms the state-of-the-art approaches, FedMatch and FedRGD, along with the baseline EMA variants we have implemented, namely TS-Server EMA and TS-Client EMA.</p>
</div>
<div id="S6.SS1.p2" class="ltx_para">
<p id="S6.SS1.p2.1" class="ltx_p">We also observe that the generalization performance is generally higher for batch-IID splits of the data than for batch-nonIID for almost all methods except FedMatch. Our implementation of FedProx-FixMatch, as well as the EMA variants also does significantly better than the state-of-the-art approaches, FedMatch <cite class="ltx_cite ltx_citemacro_citep">(Jeong et al., <a href="#bib.bib13" title="" class="ltx_ref">2021</a>)</cite> and FedRGD <cite class="ltx_cite ltx_citemacro_citep">(Zhang et al., <a href="#bib.bib39" title="" class="ltx_ref">2021</a>)</cite>. Particularly under labels-at-server, we avoid model collapse/premature convergence by utilizing weak augmentations of the unlabeled data unlike FedMatch.</p>
</div>
<figure id="S6.T3" class="ltx_table">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_table">Table 3: </span>Performance of all competing approaches on the Fashion-MNIST dataset. For each approach, we report the mean performance, along with standard deviation over five trials and 800 epochs. The best configuration for each approach is obtained through a hyper-parameter search. Results are reported for the Streaming-NonIID settings under both labels-at-client and labels-at-server configurations.</figcaption>
<table id="S6.T3.12" class="ltx_tabular ltx_centering ltx_guessed_headers ltx_align_middle">
<tbody class="ltx_tbody">
<tr id="S6.T3.12.13.1" class="ltx_tr">
<th id="S6.T3.12.13.1.1" class="ltx_td ltx_nopad_l ltx_nopad_r ltx_th ltx_th_row ltx_border_r ltx_border_t" style="padding-left:1.5pt;padding-right:1.5pt;"></th>
<td id="S6.T3.12.13.1.2" class="ltx_td ltx_nopad_l ltx_align_center ltx_border_t" style="padding-left:1.5pt;padding-right:1.5pt;" colspan="2">Client/Server Configuration</td>
</tr>
<tr id="S6.T3.12.14.2" class="ltx_tr">
<th id="S6.T3.12.14.2.1" class="ltx_td ltx_nopad_l ltx_nopad_r ltx_th ltx_th_row ltx_border_r ltx_border_t" style="padding-left:1.5pt;padding-right:1.5pt;"></th>
<td id="S6.T3.12.14.2.2" class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center ltx_border_t" style="padding-left:1.5pt;padding-right:1.5pt;">Labels at Client</td>
<td id="S6.T3.12.14.2.3" class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center ltx_border_t" style="padding-left:1.5pt;padding-right:1.5pt;">Labels at Server</td>
</tr>
<tr id="S6.T3.12.15.3" class="ltx_tr">
<th id="S6.T3.12.15.3.1" class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center ltx_th ltx_th_row ltx_border_r ltx_border_t" style="padding-left:1.5pt;padding-right:1.5pt;">Approach</th>
<td id="S6.T3.12.15.3.2" class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center ltx_border_t" style="padding-left:1.5pt;padding-right:1.5pt;">Streaming-NonIID</td>
<td id="S6.T3.12.15.3.3" class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center ltx_border_t" style="padding-left:1.5pt;padding-right:1.5pt;">Streaming-NonIID</td>
</tr>
<tr id="S6.T3.2.2" class="ltx_tr">
<th id="S6.T3.2.2.3" class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center ltx_th ltx_th_row ltx_border_r ltx_border_t" style="padding-left:1.5pt;padding-right:1.5pt;">FedMatch</th>
<td id="S6.T3.1.1.1" class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center ltx_border_t" style="padding-left:1.5pt;padding-right:1.5pt;">77.95<math id="S6.T3.1.1.1.m1.1" class="ltx_Math" alttext="\pm" display="inline"><semantics id="S6.T3.1.1.1.m1.1a"><mo id="S6.T3.1.1.1.m1.1.1" xref="S6.T3.1.1.1.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S6.T3.1.1.1.m1.1b"><csymbol cd="latexml" id="S6.T3.1.1.1.m1.1.1.cmml" xref="S6.T3.1.1.1.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S6.T3.1.1.1.m1.1c">\pm</annotation></semantics></math>0.14</td>
<td id="S6.T3.2.2.2" class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center ltx_border_t" style="padding-left:1.5pt;padding-right:1.5pt;"><span id="S6.T3.2.2.2.1" class="ltx_text ltx_font_bold">84.15<math id="S6.T3.2.2.2.1.m1.1" class="ltx_Math" alttext="\pm" display="inline"><semantics id="S6.T3.2.2.2.1.m1.1a"><mo id="S6.T3.2.2.2.1.m1.1.1" xref="S6.T3.2.2.2.1.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S6.T3.2.2.2.1.m1.1b"><csymbol cd="latexml" id="S6.T3.2.2.2.1.m1.1.1.cmml" xref="S6.T3.2.2.2.1.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S6.T3.2.2.2.1.m1.1c">\pm</annotation></semantics></math>0.31</span></td>
</tr>
<tr id="S6.T3.4.4" class="ltx_tr">
<th id="S6.T3.4.4.3" class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center ltx_th ltx_th_row ltx_border_r" style="padding-left:1.5pt;padding-right:1.5pt;">FedProx-FixMatch</th>
<td id="S6.T3.3.3.1" class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" style="padding-left:1.5pt;padding-right:1.5pt;">62.40<math id="S6.T3.3.3.1.m1.1" class="ltx_Math" alttext="\pm" display="inline"><semantics id="S6.T3.3.3.1.m1.1a"><mo id="S6.T3.3.3.1.m1.1.1" xref="S6.T3.3.3.1.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S6.T3.3.3.1.m1.1b"><csymbol cd="latexml" id="S6.T3.3.3.1.m1.1.1.cmml" xref="S6.T3.3.3.1.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S6.T3.3.3.1.m1.1c">\pm</annotation></semantics></math>0.43</td>
<td id="S6.T3.4.4.2" class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" style="padding-left:1.5pt;padding-right:1.5pt;">73.71<math id="S6.T3.4.4.2.m1.1" class="ltx_Math" alttext="\pm" display="inline"><semantics id="S6.T3.4.4.2.m1.1a"><mo id="S6.T3.4.4.2.m1.1.1" xref="S6.T3.4.4.2.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S6.T3.4.4.2.m1.1b"><csymbol cd="latexml" id="S6.T3.4.4.2.m1.1.1.cmml" xref="S6.T3.4.4.2.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S6.T3.4.4.2.m1.1c">\pm</annotation></semantics></math>0.32</td>
</tr>
<tr id="S6.T3.6.6" class="ltx_tr">
<th id="S6.T3.6.6.3" class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center ltx_th ltx_th_row ltx_border_r" style="padding-left:1.5pt;padding-right:1.5pt;">FedProx-FixMatch(o)</th>
<td id="S6.T3.5.5.1" class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" style="padding-left:1.5pt;padding-right:1.5pt;">86.51<math id="S6.T3.5.5.1.m1.1" class="ltx_Math" alttext="\pm" display="inline"><semantics id="S6.T3.5.5.1.m1.1a"><mo id="S6.T3.5.5.1.m1.1.1" xref="S6.T3.5.5.1.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S6.T3.5.5.1.m1.1b"><csymbol cd="latexml" id="S6.T3.5.5.1.m1.1.1.cmml" xref="S6.T3.5.5.1.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S6.T3.5.5.1.m1.1c">\pm</annotation></semantics></math>1.05</td>
<td id="S6.T3.6.6.2" class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" style="padding-left:1.5pt;padding-right:1.5pt;">82.77<math id="S6.T3.6.6.2.m1.1" class="ltx_Math" alttext="\pm" display="inline"><semantics id="S6.T3.6.6.2.m1.1a"><mo id="S6.T3.6.6.2.m1.1.1" xref="S6.T3.6.6.2.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S6.T3.6.6.2.m1.1b"><csymbol cd="latexml" id="S6.T3.6.6.2.m1.1.1.cmml" xref="S6.T3.6.6.2.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S6.T3.6.6.2.m1.1c">\pm</annotation></semantics></math>1.04</td>
</tr>
<tr id="S6.T3.8.8" class="ltx_tr">
<th id="S6.T3.8.8.3" class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center ltx_th ltx_th_row ltx_border_r" style="padding-left:1.5pt;padding-right:1.5pt;">TS-Server EMA</th>
<td id="S6.T3.7.7.1" class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" style="padding-left:1.5pt;padding-right:1.5pt;">82.70<math id="S6.T3.7.7.1.m1.1" class="ltx_Math" alttext="\pm" display="inline"><semantics id="S6.T3.7.7.1.m1.1a"><mo id="S6.T3.7.7.1.m1.1.1" xref="S6.T3.7.7.1.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S6.T3.7.7.1.m1.1b"><csymbol cd="latexml" id="S6.T3.7.7.1.m1.1.1.cmml" xref="S6.T3.7.7.1.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S6.T3.7.7.1.m1.1c">\pm</annotation></semantics></math>0.67</td>
<td id="S6.T3.8.8.2" class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" style="padding-left:1.5pt;padding-right:1.5pt;">77.49<math id="S6.T3.8.8.2.m1.1" class="ltx_Math" alttext="\pm" display="inline"><semantics id="S6.T3.8.8.2.m1.1a"><mo id="S6.T3.8.8.2.m1.1.1" xref="S6.T3.8.8.2.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S6.T3.8.8.2.m1.1b"><csymbol cd="latexml" id="S6.T3.8.8.2.m1.1.1.cmml" xref="S6.T3.8.8.2.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S6.T3.8.8.2.m1.1c">\pm</annotation></semantics></math>5.66</td>
</tr>
<tr id="S6.T3.10.10" class="ltx_tr">
<th id="S6.T3.10.10.3" class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center ltx_th ltx_th_row ltx_border_r" style="padding-left:1.5pt;padding-right:1.5pt;"><span id="S6.T3.10.10.3.1" class="ltx_text ltx_font_italic">FedSwitch</span></th>
<td id="S6.T3.9.9.1" class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" style="padding-left:1.5pt;padding-right:1.5pt;"><span id="S6.T3.9.9.1.1" class="ltx_text ltx_font_bold">88.94<math id="S6.T3.9.9.1.1.m1.1" class="ltx_Math" alttext="\pm" display="inline"><semantics id="S6.T3.9.9.1.1.m1.1a"><mo id="S6.T3.9.9.1.1.m1.1.1" xref="S6.T3.9.9.1.1.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S6.T3.9.9.1.1.m1.1b"><csymbol cd="latexml" id="S6.T3.9.9.1.1.m1.1.1.cmml" xref="S6.T3.9.9.1.1.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S6.T3.9.9.1.1.m1.1c">\pm</annotation></semantics></math>0.52</span></td>
<td id="S6.T3.10.10.2" class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center" style="padding-left:1.5pt;padding-right:1.5pt;">81.72<math id="S6.T3.10.10.2.m1.1" class="ltx_Math" alttext="\pm" display="inline"><semantics id="S6.T3.10.10.2.m1.1a"><mo id="S6.T3.10.10.2.m1.1.1" xref="S6.T3.10.10.2.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S6.T3.10.10.2.m1.1b"><csymbol cd="latexml" id="S6.T3.10.10.2.m1.1.1.cmml" xref="S6.T3.10.10.2.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S6.T3.10.10.2.m1.1c">\pm</annotation></semantics></math>2.48</td>
</tr>
<tr id="S6.T3.12.12" class="ltx_tr">
<th id="S6.T3.12.12.3" class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center ltx_th ltx_th_row ltx_border_b ltx_border_r" style="padding-left:1.5pt;padding-right:1.5pt;">TS-Client EMA</th>
<td id="S6.T3.11.11.1" class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center ltx_border_b" style="padding-left:1.5pt;padding-right:1.5pt;">86.48<math id="S6.T3.11.11.1.m1.1" class="ltx_Math" alttext="\pm" display="inline"><semantics id="S6.T3.11.11.1.m1.1a"><mo id="S6.T3.11.11.1.m1.1.1" xref="S6.T3.11.11.1.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S6.T3.11.11.1.m1.1b"><csymbol cd="latexml" id="S6.T3.11.11.1.m1.1.1.cmml" xref="S6.T3.11.11.1.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S6.T3.11.11.1.m1.1c">\pm</annotation></semantics></math>0.98</td>
<td id="S6.T3.12.12.2" class="ltx_td ltx_nopad_l ltx_nopad_r ltx_align_center ltx_border_b" style="padding-left:1.5pt;padding-right:1.5pt;">81.15<math id="S6.T3.12.12.2.m1.1" class="ltx_Math" alttext="\pm" display="inline"><semantics id="S6.T3.12.12.2.m1.1a"><mo id="S6.T3.12.12.2.m1.1.1" xref="S6.T3.12.12.2.m1.1.1.cmml">±</mo><annotation-xml encoding="MathML-Content" id="S6.T3.12.12.2.m1.1b"><csymbol cd="latexml" id="S6.T3.12.12.2.m1.1.1.cmml" xref="S6.T3.12.12.2.m1.1.1">plus-or-minus</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S6.T3.12.12.2.m1.1c">\pm</annotation></semantics></math>3.93</td>
</tr>
</tbody>
</table>
</figure>
</section>
<section id="S6.SS2" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">6.2 </span>Results on Fashion MNIST Dataset</h3>

<div id="S6.SS2.p1" class="ltx_para">
<p id="S6.SS2.p1.1" class="ltx_p">We compare the performance of <span id="S6.SS2.p1.1.1" class="ltx_text ltx_font_italic">FedSwitch</span> on the Fashion MNIST dataset with state-of-the-art approaches such as FedMatch, FedRGD as well as other EMA variants. Table <a href="#S6.T3" title="Table 3 ‣ 6.1 Results on CIFAR-10 Dataset ‣ 6 Experimental Results ‣ When does the student surpass the teacher? Federated Semi-supervised Learning with Teacher-Student EMA" class="ltx_ref"><span class="ltx_text ltx_ref_tag">3</span></a> shows the average accuracy along with standard deviation over 5 trials for each streaming-nonIID data configuration, such as labels-at-client and labels-at-server. Figure <a href="#S6.F5" title="Figure 5 ‣ 6.3 Analysis of performance under Non-IIDness ‣ 6 Experimental Results ‣ When does the student surpass the teacher? Federated Semi-supervised Learning with Teacher-Student EMA" class="ltx_ref"><span class="ltx_text ltx_ref_tag">5</span></a>(b) demonstrates the inherent noisiness of this dataset compared to CIFAR-10, which is attributable to not only a non-IID client data setting, but also the temporal nature of the unlabeled data with new samples streaming in on every participating client at each round. The EMA variants are not only able to smoothen the training, but also generalize better at higher epochs since the teacher’s pseudo-labels remain relatively robust to temporal variations in the unlabeled data. In Table <a href="#S6.T3" title="Table 3 ‣ 6.1 Results on CIFAR-10 Dataset ‣ 6 Experimental Results ‣ When does the student surpass the teacher? Federated Semi-supervised Learning with Teacher-Student EMA" class="ltx_ref"><span class="ltx_text ltx_ref_tag">3</span></a> we present the test performance of <span id="S6.SS2.p1.1.2" class="ltx_text ltx_font_italic">FedSwitch</span> along with the baseline approaches. <span id="S6.SS2.p1.1.3" class="ltx_text ltx_font_italic">FedSwitch</span> obtains an improvement of 11% accuracy under the Labels-at-Client setting for streaming non-IID data compared to FedMatch, and also outperforms FedProx-FixMatch, both as reported in the FedMatch paper <cite class="ltx_cite ltx_citemacro_citep">(Jeong et al., <a href="#bib.bib13" title="" class="ltx_ref">2021</a>)</cite>, as well as our implementation. Under the Labels-at-Server setting, we also improve on FedProx-FixMatch
by 2% test accuracy. Similar to the observations for CIFAR-10, the TS-Client EMA approach does better than TS-Server EMA since we have increased communication as well as increased ability for the local teacher model on the clients to get updated with every batch of data.</p>
</div>
<figure id="S6.F4" class="ltx_figure"><img src="/html/2301.10114/assets/figures/f4_las_sequential.png" id="S6.F4.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="598" height="347" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 4: </span>CIFAR-10 generalization performance of our proposed method <span id="S6.F4.3.1" class="ltx_text ltx_font_italic">FedSwitch</span> along with baseline approaches at increasing levels of client non-IIDness for Labels at Server (sequential). We note that <span id="S6.F4.4.2" class="ltx_text ltx_font_italic">FedSwitch</span> is relatively more robust to high levels of client non-IIDness compared to other approaches.</figcaption>
</figure>
</section>
<section id="S6.SS3" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">6.3 </span>Analysis of performance under Non-IIDness</h3>

<div id="S6.SS3.p1" class="ltx_para">
<p id="S6.SS3.p1.1" class="ltx_p">We have described in Section <a href="#S5.SS4" title="5.4 Performance under increasing non-IIDness ‣ 5 Experiments ‣ When does the student surpass the teacher? Federated Semi-supervised Learning with Teacher-Student EMA" class="ltx_ref"><span class="ltx_text ltx_ref_tag">5.4</span></a> our experimental setup for comparing the proposed method <span id="S6.SS3.p1.1.1" class="ltx_text ltx_font_italic">FedSwitch</span> along with other teacher-student EMA approaches at different levels of client non-IIDness. Figure <a href="#S3.F1" title="Figure 1 ‣ 3.1 Real-world considerations for practical FSSL ‣ 3 Preliminaries ‣ When does the student surpass the teacher? Federated Semi-supervised Learning with Teacher-Student EMA" class="ltx_ref"><span class="ltx_text ltx_ref_tag">1</span></a> shows the evaluation accuracy on CIFAR-10 for different approaches (FedProx-Fedmatch, TS-Server EMA, TS-Client EMA and <span id="S6.SS3.p1.1.2" class="ltx_text ltx_font_italic">FedSwitch</span>) with increasing values of client non-IIDness parameterized by the Dirichlet <math id="S6.SS3.p1.1.m1.1" class="ltx_Math" alttext="\alpha" display="inline"><semantics id="S6.SS3.p1.1.m1.1a"><mi id="S6.SS3.p1.1.m1.1.1" xref="S6.SS3.p1.1.m1.1.1.cmml">α</mi><annotation-xml encoding="MathML-Content" id="S6.SS3.p1.1.m1.1b"><ci id="S6.SS3.p1.1.m1.1.1.cmml" xref="S6.SS3.p1.1.m1.1.1">𝛼</ci></annotation-xml><annotation encoding="application/x-tex" id="S6.SS3.p1.1.m1.1c">\alpha</annotation></semantics></math>. We note how TS-Server EMA and TS-Client EMA approaches are susceptible to label imbalance on the clients. This happens as even though each client is imbalanced, the global teacher model is obtained through an aggregation of local teacher models and is biased towards generating pseudo-labels which are relatively more uniform that the true distribution on each client.</p>
</div>
<div id="S6.SS3.p2" class="ltx_para">
<p id="S6.SS3.p2.3" class="ltx_p">Figure <a href="#S5.F3" title="Figure 3 ‣ 5.4 Performance under increasing non-IIDness ‣ 5 Experiments ‣ When does the student surpass the teacher? Federated Semi-supervised Learning with Teacher-Student EMA" class="ltx_ref"><span class="ltx_text ltx_ref_tag">3</span></a> shows how this manifests for different values of Dirichlet <math id="S6.SS3.p2.1.m1.1" class="ltx_Math" alttext="\alpha" display="inline"><semantics id="S6.SS3.p2.1.m1.1a"><mi id="S6.SS3.p2.1.m1.1.1" xref="S6.SS3.p2.1.m1.1.1.cmml">α</mi><annotation-xml encoding="MathML-Content" id="S6.SS3.p2.1.m1.1b"><ci id="S6.SS3.p2.1.m1.1.1.cmml" xref="S6.SS3.p2.1.m1.1.1">𝛼</ci></annotation-xml><annotation encoding="application/x-tex" id="S6.SS3.p2.1.m1.1c">\alpha</annotation></semantics></math>. In Figure <a href="#S5.F3" title="Figure 3 ‣ 5.4 Performance under increasing non-IIDness ‣ 5 Experiments ‣ When does the student surpass the teacher? Federated Semi-supervised Learning with Teacher-Student EMA" class="ltx_ref"><span class="ltx_text ltx_ref_tag">3</span></a>(a) we plot the variation of the average KL-Divergence between each client’s pseudo-label distribution and the uniform distribution with each round as training progresses for the TS-Server EMA approach. When we have perfect IIDness (balanced labels) on each client, the ground-truth divergence is zero; and on the other extremity ie. each client has samples only from a single class the divergence is <math id="S6.SS3.p2.2.m2.1" class="ltx_Math" alttext="ln(10)=2.302" display="inline"><semantics id="S6.SS3.p2.2.m2.1a"><mrow id="S6.SS3.p2.2.m2.1.2" xref="S6.SS3.p2.2.m2.1.2.cmml"><mrow id="S6.SS3.p2.2.m2.1.2.2" xref="S6.SS3.p2.2.m2.1.2.2.cmml"><mi id="S6.SS3.p2.2.m2.1.2.2.2" xref="S6.SS3.p2.2.m2.1.2.2.2.cmml">l</mi><mo lspace="0em" rspace="0em" id="S6.SS3.p2.2.m2.1.2.2.1" xref="S6.SS3.p2.2.m2.1.2.2.1.cmml">​</mo><mi id="S6.SS3.p2.2.m2.1.2.2.3" xref="S6.SS3.p2.2.m2.1.2.2.3.cmml">n</mi><mo lspace="0em" rspace="0em" id="S6.SS3.p2.2.m2.1.2.2.1a" xref="S6.SS3.p2.2.m2.1.2.2.1.cmml">​</mo><mrow id="S6.SS3.p2.2.m2.1.2.2.4.2" xref="S6.SS3.p2.2.m2.1.2.2.cmml"><mo stretchy="false" id="S6.SS3.p2.2.m2.1.2.2.4.2.1" xref="S6.SS3.p2.2.m2.1.2.2.cmml">(</mo><mn id="S6.SS3.p2.2.m2.1.1" xref="S6.SS3.p2.2.m2.1.1.cmml">10</mn><mo stretchy="false" id="S6.SS3.p2.2.m2.1.2.2.4.2.2" xref="S6.SS3.p2.2.m2.1.2.2.cmml">)</mo></mrow></mrow><mo id="S6.SS3.p2.2.m2.1.2.1" xref="S6.SS3.p2.2.m2.1.2.1.cmml">=</mo><mn id="S6.SS3.p2.2.m2.1.2.3" xref="S6.SS3.p2.2.m2.1.2.3.cmml">2.302</mn></mrow><annotation-xml encoding="MathML-Content" id="S6.SS3.p2.2.m2.1b"><apply id="S6.SS3.p2.2.m2.1.2.cmml" xref="S6.SS3.p2.2.m2.1.2"><eq id="S6.SS3.p2.2.m2.1.2.1.cmml" xref="S6.SS3.p2.2.m2.1.2.1"></eq><apply id="S6.SS3.p2.2.m2.1.2.2.cmml" xref="S6.SS3.p2.2.m2.1.2.2"><times id="S6.SS3.p2.2.m2.1.2.2.1.cmml" xref="S6.SS3.p2.2.m2.1.2.2.1"></times><ci id="S6.SS3.p2.2.m2.1.2.2.2.cmml" xref="S6.SS3.p2.2.m2.1.2.2.2">𝑙</ci><ci id="S6.SS3.p2.2.m2.1.2.2.3.cmml" xref="S6.SS3.p2.2.m2.1.2.2.3">𝑛</ci><cn type="integer" id="S6.SS3.p2.2.m2.1.1.cmml" xref="S6.SS3.p2.2.m2.1.1">10</cn></apply><cn type="float" id="S6.SS3.p2.2.m2.1.2.3.cmml" xref="S6.SS3.p2.2.m2.1.2.3">2.302</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S6.SS3.p2.2.m2.1c">ln(10)=2.302</annotation></semantics></math>.
When the client data is IID, we observe that the teacher can predict pseudo-labels which are uniformly distributed and hence close to the ground truth. However as <math id="S6.SS3.p2.3.m3.1" class="ltx_Math" alttext="\alpha" display="inline"><semantics id="S6.SS3.p2.3.m3.1a"><mi id="S6.SS3.p2.3.m3.1.1" xref="S6.SS3.p2.3.m3.1.1.cmml">α</mi><annotation-xml encoding="MathML-Content" id="S6.SS3.p2.3.m3.1b"><ci id="S6.SS3.p2.3.m3.1.1.cmml" xref="S6.SS3.p2.3.m3.1.1">𝛼</ci></annotation-xml><annotation encoding="application/x-tex" id="S6.SS3.p2.3.m3.1c">\alpha</annotation></semantics></math> decreases, and the data becomes more imbalanced the KL Divergence saturates around 0.75, and the generated pseudo-labels are biased towards an uniform distribution, being unable to match the relatively higher-levels of non-IIDness on the clients.</p>
</div>
<div id="S6.SS3.p3" class="ltx_para">
<p id="S6.SS3.p3.1" class="ltx_p">A comparison of how different teacher-student EMA approaches mitigate this issue is presented in Figure <a href="#S5.F3" title="Figure 3 ‣ 5.4 Performance under increasing non-IIDness ‣ 5 Experiments ‣ When does the student surpass the teacher? Federated Semi-supervised Learning with Teacher-Student EMA" class="ltx_ref"><span class="ltx_text ltx_ref_tag">3</span></a>(b). For FedProx-FixMatch the ratio of ground truth KL-divergences to the pseudo-label KL-Divergences is close to 1.0 which indicates that we have good quality of predictions. The TS-Server EMA approach performs the worst, with no adaptation of the local student or teacher model to the client data. When we increase the communication cost (TS-Client EMA), we perform relatively better than TS-Server EMA due to improved ability of the local teacher model on each client to track variation of the student models. <span id="S6.SS3.p3.1.1" class="ltx_text ltx_font_italic">FedSwitch</span> performs similar to FedProx-FixMatch and is relatively unaffected by non-IIDness. The reasons for this are two-fold - firstly, the local student is adapted to the client data which also enables us to update the local teacher model; and secondly, depending on the switching criterion the model being used for pseudo-label generation can adaptively switch between the teacher and the student on each client. This enables the pseudo-labels to match the true client distribution, even under increasing levels of non-IIDness.</p>
</div>
<figure id="S6.F5" class="ltx_figure">
<div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_1"><img src="/html/2301.10114/assets/figures/f5_cifar.png" id="S6.F5.g1" class="ltx_graphics ltx_centering ltx_figure_panel ltx_img_landscape" width="598" height="330" alt="Refer to caption"></div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_1"><img src="/html/2301.10114/assets/figures/f5_fmnist.png" id="S6.F5.g2" class="ltx_graphics ltx_centering ltx_figure_panel ltx_img_landscape" width="598" height="330" alt="Refer to caption"></div>
</div>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 5: </span>Variation of evaluation accuracy with number of global rounds for FedSwitch and FedProx-FixMatch approaches on the CIFAR-10 dataset (batched nonIID) and on Fashion MNIST dataset (streaming nonIID) under labels-at-client settings. <span id="S6.F5.2.1" class="ltx_text ltx_font_italic">FedSwitch</span> achieves better performance compared to the baseline approaches at fewer rounds, while being more stable during training.
</figcaption>
</figure>
</section>
</section>
<section id="S7" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">7 </span>Conclusion</h2>

<div id="S7.p1" class="ltx_para ltx_noindent">
<p id="S7.p1.1" class="ltx_p">In this paper we have proposed <span id="S7.p1.1.1" class="ltx_text ltx_font_italic">FedSwitch</span>, a novel teacher-student EMA framework for semi-supervised learning in a federated setting. We show that the problem of integrating EMA updates when data resides on different client devices is non-trivial, and requires synchronization between global student/teacher models, and local ones residing on each client. When evaluated on two datasets, CIFAR-10 and Fashion MNIST for the federated image classification task, <span id="S7.p1.1.2" class="ltx_text ltx_font_italic">FedSwitch</span> obtains performance superior to existing state-of-the-art approaches while utilizing teacher student EMA updates with a tractable communication cost. Unlike existing approaches such as FedMatch, our proposed method also satisfies the necessary requirements such as privacy and client statelessness for deployment to practical federated settings. In future work, we plan to extend <span id="S7.p1.1.3" class="ltx_text ltx_font_italic">FedSwitch</span> to incorporate techniques such as Test-Time Adaptation with applications to other federated computer vision tasks, such as image segmentation and instance-level object detection.</p>
</div>
</section>
<section id="bib" class="ltx_bibliography">
<h2 class="ltx_title ltx_title_bibliography">References</h2>

<ul class="ltx_biblist">
<li id="bib.bib1" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Berthelot et al. (2019)</span>
<span class="ltx_bibblock">
Berthelot, D., Carlini, N., Goodfellow, I., Papernot, N., Oliver, A., and
Raffel, C. A.

</span>
<span class="ltx_bibblock">Mixmatch: A holistic approach to semi-supervised learning.

</span>
<span class="ltx_bibblock">In <em id="bib.bib1.1.1" class="ltx_emph ltx_font_italic">NeurIPS</em>, pp.  5049–5059, 2019.

</span>
</li>
<li id="bib.bib2" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Bian et al. (2021)</span>
<span class="ltx_bibblock">
Bian, J., Fu, Z., and Xu, J.

</span>
<span class="ltx_bibblock">Fedseal: Semi-supervised federated learning with self-ensemble
learning and negative learning.

</span>
<span class="ltx_bibblock"><em id="bib.bib2.1.1" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:2110.07829</em>, 2021.

</span>
</li>
<li id="bib.bib3" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Carlini et al. (2021)</span>
<span class="ltx_bibblock">
Carlini, N., Chien, S., Nasr, M., Song, S., Terzis, A., and Tramer, F.

</span>
<span class="ltx_bibblock">Membership inference attacks from first principles.

</span>
<span class="ltx_bibblock"><em id="bib.bib3.1.1" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:2112.03570</em>, 2021.

</span>
</li>
<li id="bib.bib4" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Caron et al. (2020)</span>
<span class="ltx_bibblock">
Caron, M., Misra, I., Mairal, J., Goyal, P., Bojanowski, P., and Joulin, A.

</span>
<span class="ltx_bibblock">Unsupervised learning of visual features by contrasting cluster
assignments.

</span>
<span class="ltx_bibblock"><em id="bib.bib4.1.1" class="ltx_emph ltx_font_italic">Advances in Neural Information Processing Systems</em>,
33:9912–9924, 2020.

</span>
</li>
<li id="bib.bib5" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Dwork et al. (2014)</span>
<span class="ltx_bibblock">
Dwork, C., Roth, A., et al.

</span>
<span class="ltx_bibblock">The algorithmic foundations of differential privacy.

</span>
<span class="ltx_bibblock"><em id="bib.bib5.1.1" class="ltx_emph ltx_font_italic">Found. Trends Theor. Comput. Sci.</em>, 9(3-4):211–407, 2014.

</span>
</li>
<li id="bib.bib6" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Geiping et al. (2020)</span>
<span class="ltx_bibblock">
Geiping, J., Bauermeister, H., Dröge, H., and Moeller, M.

</span>
<span class="ltx_bibblock">Inverting gradients—how easy is it to break privacy in federated
learning?

</span>
<span class="ltx_bibblock"><em id="bib.bib6.1.1" class="ltx_emph ltx_font_italic">Advances in Neural Information Processing Systems</em>,
33:16937–16947, 2020.

</span>
</li>
<li id="bib.bib7" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Grill et al. (2020)</span>
<span class="ltx_bibblock">
Grill, J.-B., Strub, F., Altché, F., Tallec, C., Richemond, P. H.,
Buchatskaya, E., Doersch, C., Pires, B. A., Guo, Z. D., Azar, M. G., et al.

</span>
<span class="ltx_bibblock">Bootstrap your own latent: A new approach to self-supervised
learning.

</span>
<span class="ltx_bibblock"><em id="bib.bib7.1.1" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:2006.07733</em>, 2020.

</span>
</li>
<li id="bib.bib8" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Guillaumin et al. (2010)</span>
<span class="ltx_bibblock">
Guillaumin, M., Verbeek, J., and Schmid, C.

</span>
<span class="ltx_bibblock">Multimodal semi-supervised learning for image classification.

</span>
<span class="ltx_bibblock">In <em id="bib.bib8.1.1" class="ltx_emph ltx_font_italic">2010 IEEE Computer society conference on computer vision and
pattern recognition</em>, pp.  902–909. IEEE, 2010.

</span>
</li>
<li id="bib.bib9" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Guo et al. (2019)</span>
<span class="ltx_bibblock">
Guo, H., Mao, Y., and Zhang, R.

</span>
<span class="ltx_bibblock">Mixup as locally linear out-of-manifold regularization.

</span>
<span class="ltx_bibblock">In <em id="bib.bib9.1.1" class="ltx_emph ltx_font_italic">Proceedings of the AAAI Conference on Artificial
Intelligence (AAAI)</em>, volume 33, pp.  3714–3722, 2019.

</span>
</li>
<li id="bib.bib10" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">He et al. (2020)</span>
<span class="ltx_bibblock">
He, K., Fan, H., Wu, Y., Xie, S., and Girshick, R.

</span>
<span class="ltx_bibblock">Momentum contrast for unsupervised visual representation learning.

</span>
<span class="ltx_bibblock">In <em id="bib.bib10.1.1" class="ltx_emph ltx_font_italic">Proceedings of the IEEE/CVF Conference on Computer Vision
and Pattern Recognition (CVPR)</em>, pp.  9729–9738, 2020.

</span>
</li>
<li id="bib.bib11" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Hendrycks et al. (2020)</span>
<span class="ltx_bibblock">
Hendrycks, D., Mu, N., Cubuk, E. D., Zoph, B., Gilmer, J., and
Lakshminarayanan, B.

</span>
<span class="ltx_bibblock">AugMix: A simple data processing method to improve robustness and
uncertainty.

</span>
<span class="ltx_bibblock"><em id="bib.bib11.1.1" class="ltx_emph ltx_font_italic">Proceedings of the International Conference on Learning
Representations (ICLR)</em>, 2020.

</span>
</li>
<li id="bib.bib12" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Hsu et al. (2019)</span>
<span class="ltx_bibblock">
Hsu, T.-M. H., Qi, H., and Brown, M.

</span>
<span class="ltx_bibblock">Measuring the effects of non-identical data distribution for
federated visual classification.

</span>
<span class="ltx_bibblock"><em id="bib.bib12.1.1" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:1909.06335</em>, 2019.

</span>
</li>
<li id="bib.bib13" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Jeong et al. (2021)</span>
<span class="ltx_bibblock">
Jeong, W., Yoon, J., Yang, E., and Hwang, S. J.

</span>
<span class="ltx_bibblock">Federated semi-supervised learning with inter-client consistency &amp;
disjoint learning.

</span>
<span class="ltx_bibblock">In <em id="bib.bib13.1.1" class="ltx_emph ltx_font_italic">International Conference on Learning Representations</em>, 2021.

</span>
<span class="ltx_bibblock">URL <a target="_blank" href="https://openreview.net/forum?id=ce6CFXBh30h" title="" class="ltx_ref ltx_url ltx_font_typewriter">https://openreview.net/forum?id=ce6CFXBh30h</a>.

</span>
</li>
<li id="bib.bib14" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Kairouz et al. (2021)</span>
<span class="ltx_bibblock">
Kairouz, P., McMahan, H. B., Avent, B., Bellet, A., Bennis, M., Bhagoji, A. N.,
Bonawitz, K., Charles, Z., Cormode, G., Cummings, R., et al.

</span>
<span class="ltx_bibblock">Advances and open problems in federated learning.

</span>
<span class="ltx_bibblock"><em id="bib.bib14.1.1" class="ltx_emph ltx_font_italic">Foundations and Trends® in Machine Learning</em>,
14(1–2):1–210, 2021.

</span>
</li>
<li id="bib.bib15" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Karimireddy et al. (2020)</span>
<span class="ltx_bibblock">
Karimireddy, S. P., Kale, S., Mohri, M., Reddi, S., Stich, S., and Suresh,
A. T.

</span>
<span class="ltx_bibblock">Scaffold: Stochastic controlled averaging for federated learning.

</span>
<span class="ltx_bibblock">In <em id="bib.bib15.1.1" class="ltx_emph ltx_font_italic">International Conference on Machine Learning</em>, pp. 5132–5143. PMLR, 2020.

</span>
</li>
<li id="bib.bib16" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Konečnỳ et al. (2016)</span>
<span class="ltx_bibblock">
Konečnỳ, J., McMahan, H. B., Yu, F. X., Richtárik, P., Suresh,
A. T., and Bacon, D.

</span>
<span class="ltx_bibblock">Federated learning: Strategies for improving communication
efficiency.

</span>
<span class="ltx_bibblock"><em id="bib.bib16.1.1" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:1610.05492</em>, 2016.

</span>
</li>
<li id="bib.bib17" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Kuo et al. (2020)</span>
<span class="ltx_bibblock">
Kuo, C.-W., Ma, C.-Y., Huang, J.-B., and Kira, Z.

</span>
<span class="ltx_bibblock">Featmatch: Feature-based augmentation for semi-supervised learning.

</span>
<span class="ltx_bibblock">In <em id="bib.bib17.1.1" class="ltx_emph ltx_font_italic">Proceedings of the European Conference on Computer Vision
(ECCV)</em>, 2020.

</span>
</li>
<li id="bib.bib18" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Kuznetsova et al. (2020)</span>
<span class="ltx_bibblock">
Kuznetsova, A., Rom, H., Alldrin, N., Uijlings, J., Krasin, I., Pont-Tuset, J.,
Kamali, S., Popov, S., Malloci, M., Kolesnikov, A., et al.

</span>
<span class="ltx_bibblock">The open images dataset v4.

</span>
<span class="ltx_bibblock"><em id="bib.bib18.1.1" class="ltx_emph ltx_font_italic">International Journal of Computer Vision</em>, 128(7):1956–1981, 2020.

</span>
</li>
<li id="bib.bib19" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Laine &amp; Aila (2017)</span>
<span class="ltx_bibblock">
Laine, S. and Aila, T.

</span>
<span class="ltx_bibblock">Temporal ensembling for semi-supervised learning.

</span>
<span class="ltx_bibblock">In <em id="bib.bib19.1.1" class="ltx_emph ltx_font_italic">ICLR</em>, 2017.

</span>
</li>
<li id="bib.bib20" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Li et al. (2020)</span>
<span class="ltx_bibblock">
Li, T., Sahu, A. K., Zaheer, M., Sanjabi, M., Talwalkar, A., and Smith, V.

</span>
<span class="ltx_bibblock">Federated optimization in heterogeneous networks.

</span>
<span class="ltx_bibblock"><em id="bib.bib20.1.1" class="ltx_emph ltx_font_italic">Proceedings of Machine Learning and Systems</em>, 2:429–450, 2020.

</span>
</li>
<li id="bib.bib21" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Lin et al. (2014)</span>
<span class="ltx_bibblock">
Lin, T.-Y., Maire, M., Belongie, S., Hays, J., Perona, P., Ramanan, D.,
Dollár, P., and Zitnick, C. L.

</span>
<span class="ltx_bibblock">Microsoft coco: Common objects in context.

</span>
<span class="ltx_bibblock">In <em id="bib.bib21.1.1" class="ltx_emph ltx_font_italic">ECCV</em>, 2014.

</span>
</li>
<li id="bib.bib22" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Liu et al. (2021)</span>
<span class="ltx_bibblock">
Liu, Y.-C., Ma, C.-Y., He, Z., Kuo, C.-W., Chen, K., Zhang, P., Wu, B., Kira,
Z., and Vajda, P.

</span>
<span class="ltx_bibblock">Unbiased teacher for semi-supervised object detection.

</span>
<span class="ltx_bibblock">In <em id="bib.bib22.1.1" class="ltx_emph ltx_font_italic">Proceedings of the International Conference on Learning
Representations (ICLR)</em>, 2021.

</span>
</li>
<li id="bib.bib23" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Long et al. (2020)</span>
<span class="ltx_bibblock">
Long, Z., Che, L., Wang, Y., Ye, M., Luo, J., Wu, J., Xiao, H., and Ma, F.

</span>
<span class="ltx_bibblock">Fedsemi: An adaptive federated semi-supervised learning framework.

</span>
<span class="ltx_bibblock"><em id="bib.bib23.1.1" class="ltx_emph ltx_font_italic">CoRR</em>, abs/2012.03292, 2020.

</span>
<span class="ltx_bibblock">URL <a target="_blank" href="https://arxiv.org/abs/2012.03292" title="" class="ltx_ref ltx_url ltx_font_typewriter">https://arxiv.org/abs/2012.03292</a>.

</span>
</li>
<li id="bib.bib24" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Long et al. (2021)</span>
<span class="ltx_bibblock">
Long, Z., Wang, J., Wang, Y., Xiao, H., and Ma, F.

</span>
<span class="ltx_bibblock">Fedcon: A contrastive framework for federated semi-supervised
learning.

</span>
<span class="ltx_bibblock"><em id="bib.bib24.1.1" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:2109.04533</em>, 2021.

</span>
</li>
<li id="bib.bib25" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">McMahan et al. (2017)</span>
<span class="ltx_bibblock">
McMahan, H. B., Moore, E., Ramage, D., Hampson, S., and Aguera y Arcas, B.

</span>
<span class="ltx_bibblock">Communication-efficient learning of deep networks from decentralized
data.

</span>
<span class="ltx_bibblock">In <em id="bib.bib25.1.1" class="ltx_emph ltx_font_italic">Proceedings of the 20th International Conference on
Artificial Intelligence and Statistics (AISTATS)</em>, 2017.

</span>
</li>
<li id="bib.bib26" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Miyato et al. (2018)</span>
<span class="ltx_bibblock">
Miyato, T., Maeda, S.-i., Koyama, M., and Ishii, S.

</span>
<span class="ltx_bibblock">Virtual adversarial training: a regularization method for supervised
and semi-supervised learning.

</span>
<span class="ltx_bibblock"><em id="bib.bib26.1.1" class="ltx_emph ltx_font_italic">IEEE transactions on pattern analysis and machine intelligence
(PAMI)</em>, 41(8):1979–1993, 2018.

</span>
</li>
<li id="bib.bib27" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Sajjadi et al. (2016)</span>
<span class="ltx_bibblock">
Sajjadi, M., Javanmardi, M., and Tasdizen, T.

</span>
<span class="ltx_bibblock">Regularization with stochastic transformations and perturbations for
deep semi-supervised learning.

</span>
<span class="ltx_bibblock">In <em id="bib.bib27.1.1" class="ltx_emph ltx_font_italic">Advances in Neural Information Processing Systems
(NeurIPS)</em>, pp.  1163–1171, 2016.

</span>
</li>
<li id="bib.bib28" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Shokri et al. (2017)</span>
<span class="ltx_bibblock">
Shokri, R., Stronati, M., Song, C., and Shmatikov, V.

</span>
<span class="ltx_bibblock">Membership inference attacks against machine learning models.

</span>
<span class="ltx_bibblock">In <em id="bib.bib28.1.1" class="ltx_emph ltx_font_italic">2017 IEEE symposium on security and privacy (SP)</em>, pp. 3–18. IEEE, 2017.

</span>
</li>
<li id="bib.bib29" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Singhal et al. (2021)</span>
<span class="ltx_bibblock">
Singhal, K., Sidahmed, H., Garrett, Z., Wu, S., Rush, J., and Prakash, S.

</span>
<span class="ltx_bibblock">Federated reconstruction: Partially local federated learning.

</span>
<span class="ltx_bibblock"><em id="bib.bib29.1.1" class="ltx_emph ltx_font_italic">Advances in Neural Information Processing Systems</em>, 34, 2021.

</span>
</li>
<li id="bib.bib30" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Sohn et al. (2020)</span>
<span class="ltx_bibblock">
Sohn, K., Berthelot, D., Li, C.-L., Zhang, Z., Carlini, N., Cubuk, E. D.,
Kurakin, A., Zhang, H., and Raffel, C.

</span>
<span class="ltx_bibblock">Fixmatch: Simplifying semi-supervised learning with consistency and
confidence.

</span>
<span class="ltx_bibblock">In <em id="bib.bib30.1.1" class="ltx_emph ltx_font_italic">NeurIPS</em>, 2020.

</span>
</li>
<li id="bib.bib31" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Sorokin &amp; Forsyth (2008)</span>
<span class="ltx_bibblock">
Sorokin, A. and Forsyth, D.

</span>
<span class="ltx_bibblock">Utility data annotation with amazon mechanical turk.

</span>
<span class="ltx_bibblock">In <em id="bib.bib31.1.1" class="ltx_emph ltx_font_italic">2008 IEEE Computer Society Conference on Computer Vision and
Pattern Recognition Workshops</em>, pp.  1–8, 2008.

</span>
<span class="ltx_bibblock">doi: <span class="ltx_ref ltx_nolink ltx_Url ltx_ref_self">10.1109/CVPRW.2008.4562953</span>.

</span>
</li>
<li id="bib.bib32" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Tarvainen &amp; Valpola (2017)</span>
<span class="ltx_bibblock">
Tarvainen, A. and Valpola, H.

</span>
<span class="ltx_bibblock">Mean teachers are better role models: Weight-averaged consistency
targets improve semi-supervised deep learning results.

</span>
<span class="ltx_bibblock">In <em id="bib.bib32.1.1" class="ltx_emph ltx_font_italic">Advances in neural information processing systems
(NeurIPS)</em>, pp.  1195–1204, 2017.

</span>
</li>
<li id="bib.bib33" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Wei et al. (2020)</span>
<span class="ltx_bibblock">
Wei, K., Li, J., Ding, M., Ma, C., Yang, H. H., Farokhi, F., Jin, S., Quek,
T. Q., and Poor, H. V.

</span>
<span class="ltx_bibblock">Federated learning with differential privacy: Algorithms and
performance analysis.

</span>
<span class="ltx_bibblock"><em id="bib.bib33.1.1" class="ltx_emph ltx_font_italic">IEEE Transactions on Information Forensics and Security</em>,
15:3454–3469, 2020.

</span>
</li>
<li id="bib.bib34" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Xie et al. (2020)</span>
<span class="ltx_bibblock">
Xie, Q., Luong, M.-T., Hovy, E., and Le, Q. V.

</span>
<span class="ltx_bibblock">Self-training with noisy student improves imagenet classification.

</span>
<span class="ltx_bibblock">In <em id="bib.bib34.1.1" class="ltx_emph ltx_font_italic">CVPR</em>, 2020.

</span>
</li>
<li id="bib.bib35" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Xu et al. (2021)</span>
<span class="ltx_bibblock">
Xu, M., Zhang, Z., Hu, H., Wang, J., Wang, L., Wei, F., Bai, X., and Liu, Z.

</span>
<span class="ltx_bibblock">End-to-end semi-supervised object detection with soft teacher.

</span>
<span class="ltx_bibblock"><em id="bib.bib35.1.1" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:2106.09018</em>, 2021.

</span>
</li>
<li id="bib.bib36" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Yu et al. (2019)</span>
<span class="ltx_bibblock">
Yu, B., Wu, J., Ma, J., and Zhu, Z.

</span>
<span class="ltx_bibblock">Tangent-normal adversarial regularization for semi-supervised
learning.

</span>
<span class="ltx_bibblock">In <em id="bib.bib36.1.1" class="ltx_emph ltx_font_italic">Proceedings of the IEEE Conference on Computer Vision and
Pattern Recognition (CVPR)</em>, pp.  10676–10684, 2019.

</span>
</li>
<li id="bib.bib37" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Yun et al. (2019)</span>
<span class="ltx_bibblock">
Yun, S., Han, D., Oh, S. J., Chun, S., Choe, J., and Yoo, Y.

</span>
<span class="ltx_bibblock">Cutmix: Regularization strategy to train strong classifiers with
localizable features.

</span>
<span class="ltx_bibblock">In <em id="bib.bib37.1.1" class="ltx_emph ltx_font_italic">Proceedings of the IEEE International Conference on Computer
Vision (ICCV)</em>, pp.  6023–6032, 2019.

</span>
</li>
<li id="bib.bib38" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Zhang et al. (2018)</span>
<span class="ltx_bibblock">
Zhang, H., Cisse, M., Dauphin, Y. N., and Lopez-Paz, D.

</span>
<span class="ltx_bibblock">mixup: Beyond empirical risk minimization.

</span>
<span class="ltx_bibblock">In <em id="bib.bib38.1.1" class="ltx_emph ltx_font_italic">Proc. International Conference on Learning Representations
(ICLR)</em>, 2018.

</span>
</li>
<li id="bib.bib39" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Zhang et al. (2021)</span>
<span class="ltx_bibblock">
Zhang, Z., Yang, Y., Yao, Z., Yan, Y., Gonzalez, J. E., Ramchandran, K., and
Mahoney, M. W.

</span>
<span class="ltx_bibblock">Improving semi-supervised federated learning by reducing the gradient
diversity of models.

</span>
<span class="ltx_bibblock"><em id="bib.bib39.1.1" class="ltx_emph ltx_font_italic">IEEE International Conference on Big Data (Big Data)</em>, 2021.

</span>
</li>
<li id="bib.bib40" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Zhu et al. (2021)</span>
<span class="ltx_bibblock">
Zhu, H., Xu, J., Liu, S., and Jin, Y.

</span>
<span class="ltx_bibblock">Federated learning on non-iid data: A survey.

</span>
<span class="ltx_bibblock"><em id="bib.bib40.1.1" class="ltx_emph ltx_font_italic">Neurocomputing</em>, 465:371–390, 2021.

</span>
</li>
</ul>
</section>
<div class="ltx_pagination ltx_role_newpage"></div>
</article>
</div>
<div class="ar5iv-footer"><a href="/html/2301.10113" class="ar5iv-nav-button ar5iv-nav-button-prev">◄</a>
    <a class="ar5iv-home-button" href="/"><img height="40" alt="ar5iv homepage" src="/assets/ar5iv.png"></a>
    <a href="/feeling_lucky" class="ar5iv-text-button">Feeling<br>lucky?</a>
    <a href="/log/2301.10114" class="ar5iv-text-button ar5iv-severity-warning">Conversion<br>report</a>
    <a class="ar5iv-text-button" target="_blank" href="https://github.com/dginev/ar5iv/issues/new?template=improve-article--arxiv-id-.md&title=Improve+article+2301.10114">Report<br>an issue</a>
    <a href="https://arxiv.org/abs/2301.10114" class="ar5iv-text-button arxiv-ui-theme">View&nbsp;original<br>on&nbsp;arXiv</a><a href="/html/2301.10115" class="ar5iv-nav-button ar5iv-nav-button-next">►</a>
</div><footer class="ltx_page_footer">
<a class="ar5iv-toggle-color-scheme" href="javascript:toggleColorScheme()" title="Toggle ar5iv color scheme"><span class="color-scheme-icon"></span></a>
<a class="ar5iv-footer-button" href="https://arxiv.org/help/license" target="_blank">Copyright</a>
<a class="ar5iv-footer-button" href="https://arxiv.org/help/policies/privacy_policy" target="_blank">Privacy Policy</a>

<div class="ltx_page_logo">Generated  on Fri Mar  1 06:14:38 2024 by <a target="_blank" href="http://dlmf.nist.gov/LaTeXML/" class="ltx_LaTeXML_logo"><span style="letter-spacing:-0.2em; margin-right:0.1em;">L<span class="ltx_font_smallcaps" style="position:relative; bottom:2.2pt;">a</span>T<span class="ltx_font_smallcaps" style="font-size:120%;position:relative; bottom:-0.2ex;">e</span></span><span style="font-size:90%; position:relative; bottom:-0.2ex;">XML</span><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAsAAAAOCAYAAAD5YeaVAAAAAXNSR0IArs4c6QAAAAZiS0dEAP8A/wD/oL2nkwAAAAlwSFlzAAALEwAACxMBAJqcGAAAAAd0SU1FB9wKExQZLWTEaOUAAAAddEVYdENvbW1lbnQAQ3JlYXRlZCB3aXRoIFRoZSBHSU1Q72QlbgAAAdpJREFUKM9tkL+L2nAARz9fPZNCKFapUn8kyI0e4iRHSR1Kb8ng0lJw6FYHFwv2LwhOpcWxTjeUunYqOmqd6hEoRDhtDWdA8ApRYsSUCDHNt5ul13vz4w0vWCgUnnEc975arX6ORqN3VqtVZbfbTQC4uEHANM3jSqXymFI6yWazP2KxWAXAL9zCUa1Wy2tXVxheKA9YNoR8Pt+aTqe4FVVVvz05O6MBhqUIBGk8Hn8HAOVy+T+XLJfLS4ZhTiRJgqIoVBRFIoric47jPnmeB1mW/9rr9ZpSSn3Lsmir1fJZlqWlUonKsvwWwD8ymc/nXwVBeLjf7xEKhdBut9Hr9WgmkyGEkJwsy5eHG5vN5g0AKIoCAEgkEkin0wQAfN9/cXPdheu6P33fBwB4ngcAcByHJpPJl+fn54mD3Gg0NrquXxeLRQAAwzAYj8cwTZPwPH9/sVg8PXweDAauqqr2cDjEer1GJBLBZDJBs9mE4zjwfZ85lAGg2+06hmGgXq+j3+/DsixYlgVN03a9Xu8jgCNCyIegIAgx13Vfd7vdu+FweG8YRkjXdWy329+dTgeSJD3ieZ7RNO0VAXAPwDEAO5VKndi2fWrb9jWl9Esul6PZbDY9Go1OZ7PZ9z/lyuD3OozU2wAAAABJRU5ErkJggg==" alt="Mascot Sammy"></a>
</div></footer>
</div>

    <script>
      var canMathML = typeof(MathMLElement) == "function";
      if (!canMathML) {
        var body = document.querySelector("body");
        body.firstElementChild.setAttribute('style', 'opacity: 0;');
        var loading = document.createElement("div");
        loading.setAttribute("id", "mathjax-loading-spinner");
        var message = document.createElement("div");
        message.setAttribute("id", "mathjax-loading-message");
        message.innerText = "Typesetting Equations...";
        body.prepend(loading);
        body.prepend(message);

        var el = document.createElement("script");
        el.src = "https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js";
        document.querySelector("head").appendChild(el);

        window.MathJax = {
          startup: {
            pageReady: () => {
              return MathJax.startup.defaultPageReady().then(() => {
                body.removeChild(loading);
                body.removeChild(message);
                body.firstElementChild.removeAttribute('style');
              }); } } };
      }
    </script>
    <script>
    // Auxiliary function, building the preview feature when
    // an inline citation is clicked
    function clicked_cite(e) {
      e.preventDefault();
      let cite = this.closest('.ltx_cite');
      let next = cite.nextSibling;
      if (next && next.nodeType == Node.ELEMENT_NODE && next.getAttribute('class') == "ar5iv-bibitem-preview") {
        next.remove();
        return; }
      // Before adding a preview modal,
      // cleanup older previews, in case they're still open
      document.querySelectorAll('span.ar5iv-bibitem-preview').forEach(function(node) {
        node.remove();
      })

      // Create the preview
      preview = document.createElement('span');
      preview.setAttribute('class','ar5iv-bibitem-preview');
      let target = document.getElementById(this.getAttribute('href').slice(1));
      target.childNodes.forEach(function (child) {
        preview.append(child.cloneNode(true));
      });
      let close_x = document.createElement('button');
      close_x.setAttribute("aria-label","Close modal for bibliography item preview");
      close_x.textContent = "×";
      close_x.setAttribute('class', 'ar5iv-button-close-preview');
      close_x.setAttribute('onclick','this.parentNode.remove()');
      preview.append(close_x);
      preview.querySelectorAll('.ltx_tag_bibitem').forEach(function(node) {
        node.remove();
      });
      cite.parentNode.insertBefore(preview, cite.nextSibling);
      return;
    }
    // Global Document initialization:
    // - assign the preview feature to all inline citation links
    document.querySelectorAll(".ltx_cite .ltx_ref").forEach(function (link) {
      link.addEventListener("click", clicked_cite);
    });
    </script>
    </body>
</html>
