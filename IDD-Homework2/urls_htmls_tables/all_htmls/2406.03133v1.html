<!DOCTYPE html>
<html lang="en">
<head>
<meta content="text/html; charset=utf-8" http-equiv="content-type"/>
<title>The Harder You Try, The Harder You Fail: The KeyTrap Denial-of-Service Algorithmic Complexity Attacks on DNSSEC</title>
<!--Generated on Wed Jun  5 10:26:21 2024 by LaTeXML (version 0.8.8) http://dlmf.nist.gov/LaTeXML/.-->
<meta content="width=device-width, initial-scale=1, shrink-to-fit=no" name="viewport"/>
<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet" type="text/css"/>
<link href="/static/browse/0.3.4/css/ar5iv.0.7.9.min.css" rel="stylesheet" type="text/css"/>
<link href="/static/browse/0.3.4/css/ar5iv-fonts.0.7.9.min.css" rel="stylesheet" type="text/css"/>
<link href="/static/browse/0.3.4/css/latexml_styles.css" rel="stylesheet" type="text/css"/>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.3.3/html2canvas.min.js"></script>
<script src="/static/browse/0.3.4/js/addons_new.js"></script>
<script src="/static/browse/0.3.4/js/feedbackOverlay.js"></script>
<base href="/html/2406.03133v1/"/></head>
<body>
<nav class="ltx_page_navbar">
<nav class="ltx_TOC">
<ol class="ltx_toclist">
<li class="ltx_tocentry ltx_tocentry_section"><a class="ltx_ref" href="https://arxiv.org/html/2406.03133v1#S1" title="In The Harder You Try, The Harder You Fail: The KeyTrap Denial-of-Service Algorithmic Complexity Attacks on DNSSEC"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">1 </span>Introduction</span></a></li>
<li class="ltx_tocentry ltx_tocentry_section"><a class="ltx_ref" href="https://arxiv.org/html/2406.03133v1#S2" title="In The Harder You Try, The Harder You Fail: The KeyTrap Denial-of-Service Algorithmic Complexity Attacks on DNSSEC"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">2 </span>Related Work</span></a></li>
<li class="ltx_tocentry ltx_tocentry_section"><a class="ltx_ref" href="https://arxiv.org/html/2406.03133v1#S3" title="In The Harder You Try, The Harder You Fail: The KeyTrap Denial-of-Service Algorithmic Complexity Attacks on DNSSEC"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3 </span>Overview of DNSSEC</span></a></li>
<li class="ltx_tocentry ltx_tocentry_section"><a class="ltx_ref" href="https://arxiv.org/html/2406.03133v1#S4" title="In The Harder You Try, The Harder You Fail: The KeyTrap Denial-of-Service Algorithmic Complexity Attacks on DNSSEC"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">4 </span>Analysis of DNSSEC Specification</span></a></li>
<li class="ltx_tocentry ltx_tocentry_section">
<a class="ltx_ref" href="https://arxiv.org/html/2406.03133v1#S5" title="In The Harder You Try, The Harder You Fail: The KeyTrap Denial-of-Service Algorithmic Complexity Attacks on DNSSEC"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">5 </span>Resource Exhaustion Attacks</span></a>
<ol class="ltx_toclist ltx_toclist_section">
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2406.03133v1#S5.SS1" title="In 5. Resource Exhaustion Attacks ‣ The Harder You Try, The Harder You Fail: The KeyTrap Denial-of-Service Algorithmic Complexity Attacks on DNSSEC"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">5.1 </span>Threat Model</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2406.03133v1#S5.SS2" title="In 5. Resource Exhaustion Attacks ‣ The Harder You Try, The Harder You Fail: The KeyTrap Denial-of-Service Algorithmic Complexity Attacks on DNSSEC"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">5.2 </span>DNSSEC Setup</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2406.03133v1#S5.SS3" title="In 5. Resource Exhaustion Attacks ‣ The Harder You Try, The Harder You Fail: The KeyTrap Denial-of-Service Algorithmic Complexity Attacks on DNSSEC"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">5.3 </span>SigJam (One Key x Many Signatures)</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2406.03133v1#S5.SS4" title="In 5. Resource Exhaustion Attacks ‣ The Harder You Try, The Harder You Fail: The KeyTrap Denial-of-Service Algorithmic Complexity Attacks on DNSSEC"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">5.4 </span>LockCram (Many Keys x One Signature)</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2406.03133v1#S5.SS5" title="In 5. Resource Exhaustion Attacks ‣ The Harder You Try, The Harder You Fail: The KeyTrap Denial-of-Service Algorithmic Complexity Attacks on DNSSEC"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">5.5 </span>KeySigTrap (Many Keys x Many Signatures)</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2406.03133v1#S5.SS6" title="In 5. Resource Exhaustion Attacks ‣ The Harder You Try, The Harder You Fail: The KeyTrap Denial-of-Service Algorithmic Complexity Attacks on DNSSEC"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">5.6 </span>HashTrap (Many Keys x Many Hashes)</span></a></li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_section">
<a class="ltx_ref" href="https://arxiv.org/html/2406.03133v1#S6" title="In The Harder You Try, The Harder You Fail: The KeyTrap Denial-of-Service Algorithmic Complexity Attacks on DNSSEC"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">6 </span>Evaluation of the Attacks</span></a>
<ol class="ltx_toclist ltx_toclist_section">
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2406.03133v1#S6.SS1" title="In 6. Evaluation of the Attacks ‣ The Harder You Try, The Harder You Fail: The KeyTrap Denial-of-Service Algorithmic Complexity Attacks on DNSSEC"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">6.1 </span>Setup</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2406.03133v1#S6.SS2" title="In 6. Evaluation of the Attacks ‣ The Harder You Try, The Harder You Fail: The KeyTrap Denial-of-Service Algorithmic Complexity Attacks on DNSSEC"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">6.2 </span>Identifying the Optimal Cipher for Attacks</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2406.03133v1#S6.SS3" title="In 6. Evaluation of the Attacks ‣ The Harder You Try, The Harder You Fail: The KeyTrap Denial-of-Service Algorithmic Complexity Attacks on DNSSEC"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">6.3 </span>Effectiveness of the Attacks</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2406.03133v1#S6.SS4" title="In 6. Evaluation of the Attacks ‣ The Harder You Try, The Harder You Fail: The KeyTrap Denial-of-Service Algorithmic Complexity Attacks on DNSSEC"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">6.4 </span>Effect on Inbound/Pending DNS Packets</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2406.03133v1#S6.SS5" title="In 6. Evaluation of the Attacks ‣ The Harder You Try, The Harder You Fail: The KeyTrap Denial-of-Service Algorithmic Complexity Attacks on DNSSEC"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">6.5 </span>Effect on Clients</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2406.03133v1#S6.SS6" title="In 6. Evaluation of the Attacks ‣ The Harder You Try, The Harder You Fail: The KeyTrap Denial-of-Service Algorithmic Complexity Attacks on DNSSEC"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">6.6 </span>Multi-Threading</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2406.03133v1#S6.SS7" title="In 6. Evaluation of the Attacks ‣ The Harder You Try, The Harder You Fail: The KeyTrap Denial-of-Service Algorithmic Complexity Attacks on DNSSEC"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">6.7 </span>Cached Entries</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2406.03133v1#S6.SS8" title="In 6. Evaluation of the Attacks ‣ The Harder You Try, The Harder You Fail: The KeyTrap Denial-of-Service Algorithmic Complexity Attacks on DNSSEC"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">6.8 </span>Continuous KeySigTrap Attack</span></a></li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_section">
<a class="ltx_ref" href="https://arxiv.org/html/2406.03133v1#S7" title="In The Harder You Try, The Harder You Fail: The KeyTrap Denial-of-Service Algorithmic Complexity Attacks on DNSSEC"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">7 </span>The Path to Mitigations</span></a>
<ol class="ltx_toclist ltx_toclist_section">
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2406.03133v1#S7.SS1" title="In 7. The Path to Mitigations ‣ The Harder You Try, The Harder You Fail: The KeyTrap Denial-of-Service Algorithmic Complexity Attacks on DNSSEC"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">7.1 </span>Patch-Break-Fix DNSSEC</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2406.03133v1#S7.SS2" title="In 7. The Path to Mitigations ‣ The Harder You Try, The Harder You Fail: The KeyTrap Denial-of-Service Algorithmic Complexity Attacks on DNSSEC"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">7.2 </span>Improving Resilience of Architecture</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2406.03133v1#S7.SS3" title="In 7. The Path to Mitigations ‣ The Harder You Try, The Harder You Fail: The KeyTrap Denial-of-Service Algorithmic Complexity Attacks on DNSSEC"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">7.3 </span>Implementation Challenges</span></a></li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_section"><a class="ltx_ref" href="https://arxiv.org/html/2406.03133v1#S8" title="In The Harder You Try, The Harder You Fail: The KeyTrap Denial-of-Service Algorithmic Complexity Attacks on DNSSEC"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">8 </span>Ethical Considerations</span></a></li>
<li class="ltx_tocentry ltx_tocentry_section"><a class="ltx_ref" href="https://arxiv.org/html/2406.03133v1#S9" title="In The Harder You Try, The Harder You Fail: The KeyTrap Denial-of-Service Algorithmic Complexity Attacks on DNSSEC"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">9 </span>Conclusions</span></a></li>
</ol></nav>
</nav>
<div class="ltx_page_main">
<div class="ltx_page_content">
<article class="ltx_document ltx_authors_1line ltx_leqno">
<div class="ltx_para" id="p1">
<span class="ltx_ERROR undefined" id="p1.1">\NewEnviron</span>
<p class="ltx_p" id="p1.2">delenv
</p>
</div>
<h1 class="ltx_title ltx_title_document">The Harder You Try, The Harder You Fail:
<br class="ltx_break"/>The KeyTrap Denial-of-Service Algorithmic Complexity Attacks on DNSSEC</h1>
<div class="ltx_authors">
<span class="ltx_creator ltx_role_author">
<span class="ltx_personname">Elias Heftrig, Haya Schulmann, Niklas Vogel, Michael Waidner
</span></span>
</div>
<div class="ltx_dates">(2024)</div>
<div class="ltx_abstract">
<h6 class="ltx_title ltx_title_abstract">Abstract.</h6>
<p class="ltx_p" id="id1.id1">Availability is a major concern in the design of DNSSEC. To ensure availability, DNSSEC follows Postel’s Law [RFC1123]: <span class="ltx_text ltx_font_italic" id="id1.id1.1">”Be liberal in what you accept, and conservative in what you send.”</span>
Hence, nameservers should send not just one matching key for a record set, but all the relevant cryptographic material, e.g., all the keys for all the ciphers that they support and all the corresponding signatures. This ensures that validation succeeds, and hence availability, even if some of the DNSSEC keys are misconfigured, incorrect or correspond to unsupported ciphers.</p>
<p class="ltx_p" id="id2.id2">We show that this design of DNSSEC is flawed. Exploiting vulnerable recommendations in the DNSSEC standards, we develop a new class of DNSSEC-based algorithmic complexity attacks on DNS, we dub KeyTrap attacks. All popular DNS implementations and services are vulnerable. With just a single DNS packet, the KeyTrap attacks lead to a 2.000.000x spike in CPU instruction count in vulnerable DNS resolvers, stalling some for as long as 16 hours. This devastating effect prompted major DNS vendors to refer to KeyTrap as “<span class="ltx_text ltx_font_italic" id="id2.id2.1">the worst attack on DNS ever discovered</span>”. Exploiting KeyTrap, an attacker could effectively disable Internet access in any system utilizing a DNSSEC-validating resolver.</p>
<p class="ltx_p" id="id3.id3">We disclosed KeyTrap to vendors and operators on November 2, 2023, confidentially reporting the vulnerabilities to a closed group of DNS experts, operators and developers from the industry. Since then we have been working with all major vendors to mitigate <span class="ltx_text" id="id3.id3.1">KeyTrap</span>, repeatedly discovering and assisting in closing weaknesses in proposed patches.
<span class="ltx_text" id="id3.id3.2" style="color:#000000;">Following our disclosure, the industry-wide umbrella CVE-2023-50387 has been assigned, covering the DNSSEC protocol vulnerabilities we present in this work.</span></p>
</div>
<span class="ltx_note ltx_note_frontmatter ltx_role_copyright" id="id1"><sup class="ltx_note_mark">†</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">†</sup><span class="ltx_note_type">copyright: </span>none</span></span></span><span class="ltx_note ltx_note_frontmatter ltx_role_journalyear" id="id2"><sup class="ltx_note_mark">†</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">†</sup><span class="ltx_note_type">journalyear: </span>2024</span></span></span><span class="ltx_note ltx_note_frontmatter ltx_role_copyright" id="id3"><sup class="ltx_note_mark">†</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">†</sup><span class="ltx_note_type">copyright: </span>none</span></span></span><span class="ltx_note ltx_note_frontmatter ltx_role_conference" id="id4"><sup class="ltx_note_mark">†</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">†</sup><span class="ltx_note_type">conference: </span>ACM Conference on Computer and Communications Security; October 14-18, 2024; Salt Lake City, USA</span></span></span><span class="ltx_note ltx_note_frontmatter ltx_role_conference" id="id5"><sup class="ltx_note_mark">†</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">†</sup><span class="ltx_note_type">conference: </span>ACM Conference on Computer and Communications Security; October 14-18, 2024; Salt Lake City, USA</span></span></span>
<section class="ltx_section" id="S1">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">1. </span>Introduction</h2>
<div class="ltx_para" id="S1.p1">
<p class="ltx_p" id="S1.p1.1">The impact of the cryptographic requirements on the availability of DNS was a major concern in the design of DNSSEC [RFC4033-RFC4035]. Strict DNSSEC validation rules could impact DNS availability, hence, DNSSEC standard opted to limit strict requirements to the necessary minimum that suffices to ensure cryptographic security while maintaining availability of DNS, aiming at a trade-off between security, performance, and backward-compatibility. The standard requirements for DNSSEC were designed so that the DNS resolvers do not fail on the first cryptographic error. As long as a resolver can verify the provided information with any available DNSSEC material, the validation will succeed.</p>
</div>
<div class="ltx_para" id="S1.p2">
<p class="ltx_p" id="S1.p2.1"><span class="ltx_text ltx_font_italic" id="S1.p2.1.1">”Be liberal in what you accept, and conservative in what you send”</span><span class="ltx_text ltx_font_bold" id="S1.p2.1.2"> [RFC1123].</span> The core DNSSEC specification mandates validating DNS resolvers to try all possible keys when validating a resource record set (RRset) [RFC4035], and also strongly endorses to try all possible signatures covering it [RFC6840]. These DNSSEC requirements follow Postel’s Law [RFC1123]: <span class="ltx_text ltx_font_italic" id="S1.p2.1.3">the nameservers should send all the available cryptographic material, and the resolvers should use any of the cryptographic material they receive until the validation is successful</span>. This ensures availability even if some of the DNSSEC material cannot be used to validate authenticity of the DNS records, e.g., if the keys are misconfigured, incorrect or outdated.
We perform experimental evaluations and code analysis and find that these protocol requirements are supported by all major DNS resolver implementations.</p>
</div>
<div class="ltx_para" id="S1.p3">
<p class="ltx_p" id="S1.p3.1"><span class="ltx_text ltx_font_bold" id="S1.p3.1.1">DNSSEC algorithmic-complexity attacks.</span> In this work, we discover that the design philosophy of DNSSEC is flawed. We exploit the flaws in the DNSSEC standard and develop the first DNSSEC-based algorithmic complexity attacks against DNS. We demonstrate experimentally that our attacks are detrimental to availability of the affected DNS resolvers, leading to Denial of Service (DoS) on basic DNS functionalities, such as providing cached responses, or processing inbound or pending DNS packets. We show experimentally that an adversary using a single DNSSEC signed DNS response can DoS resolvers leading to a spike of 2.000.000x in CPU instruction count. The stalling period of the victim resolver depends on the resolver implementation, and can be up to 16 hours, see Table <a class="ltx_ref" href="https://arxiv.org/html/2406.03133v1#S6.T4" title="Table 4 ‣ 6.3. Effectiveness of the Attacks ‣ 6. Evaluation of the Attacks ‣ The Harder You Try, The Harder You Fail: The KeyTrap Denial-of-Service Algorithmic Complexity Attacks on DNSSEC"><span class="ltx_text ltx_ref_tag">4</span></a>. For comparison, a recently proposed NRDelegation attack <cite class="ltx_cite ltx_citemacro_citep">(<a class="ltx_ref" href="https://arxiv.org/html/2406.03133v1#bib.bib2" title="">afek2023nrdelegationattack, </a>)</cite> which exploited vulnerabilities in DNS to create multiple referral requests, would require 1569 DNS packets to cause a comparable increase in CPU instruction count, which our attacks achieve with a single packet.
We find that all DNSSEC validating DNS software, DNS libraries and public DNS services on our dataset are vulnerable to our attacks; see list in Table <a class="ltx_ref" href="https://arxiv.org/html/2406.03133v1#S6.T1" title="Table 1 ‣ 6. Evaluation of the Attacks ‣ The Harder You Try, The Harder You Fail: The KeyTrap Denial-of-Service Algorithmic Complexity Attacks on DNSSEC"><span class="ltx_text ltx_ref_tag">1</span></a>.</p>
</div>
<div class="ltx_para" id="S1.p4">
<p class="ltx_p" id="S1.p4.1"><span class="ltx_text ltx_font_bold" id="S1.p4.1.1">Flaws in DNSSEC.</span> We find that the flaws in DNSSEC specification are rooted in the interaction of a number of recommendations that in combination can be exploited as a powerful attack vector:</p>
</div>
<div class="ltx_para" id="S1.p5">
<p class="ltx_p" id="S1.p5.1"><span class="ltx_text ltx_font_italic" id="S1.p5.1.1">Key tag collisions:</span> First, DNSSEC allows for multiple keys in a given DNS zone, for example during key rollover or for multi-algorithm support [RFC6781].
Consequently, when validating DNSSEC, DNS resolvers are required to identify a suitable cryptographic key to use for signature verification.
DNSSEC uses key tag values to differentiate between the keys, even if they are of the same zone and use the same cryptographic algorithm. The triple of <span class="ltx_text ltx_font_italic" id="S1.p5.1.2">(zone name, algorithm, key tag)</span> is added to each respective signature to ensure efficiency in key-signature matching. When validating a signature, resolvers check the signature header and select the key with the matching triple for validation. However, the triple is not necessarily unique: multiple different DNS keys can have an identical triple. This can be explained by the calculation of the values in the triple. The algorithm identifier results directly from the cipher used to create the signature and is identical for all keys generated with a given algorithm. DNSSEC mandates all keys used for validating signatures in a zone to be identified by the zone name. Consequently, all DNSSEC keys that may be considered for validation trivially share the same name. Since the collisions in algorithm id and key name pairs are common, the key tag is calculated with a pseudo-random arithmetic function over the key bits to provide a means to distinguish same-algorithm, same-name keys. Using an arithmetic function instead of a manually chosen identifier eases distributed key management for multiple parties in the same DNS zone; instead of coordinating key tags to ensure uniqueness, the key tag is automatically calculated.
However, the space of potential tags is limited by the 16 bits in the key tag field. Key tag collisions, while unlikely, can thus naturally occur in DNSSEC. This is explicitly stated in [RFC4034]<span class="ltx_note ltx_role_footnote" id="footnote1"><sup class="ltx_note_mark">1</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">1</sup><span class="ltx_tag ltx_tag_note">1</span><span class="ltx_ref ltx_nolink ltx_path ltx_font_typewriter ltx_ref_self">https://datatracker.ietf.org/doc/html/rfc4035#section-5.3.1</span>,<span class="ltx_ref ltx_nolink ltx_path ltx_font_typewriter ltx_ref_self">https://datatracker.ietf.org/doc/html/rfc4034#appendix-B</span></span></span></span>, emphasizing that key tags are not unique identifiers. As we show, colliding key tags can be exploited to cause a resolver not to be able to identify a suitable key efficiently but to have to perform validations with all the available keys, inflicting computational effort during signature validation.</p>
</div>
<div class="ltx_para" id="S1.p6">
<p class="ltx_p" id="S1.p6.1"><span class="ltx_text ltx_font_italic" id="S1.p6.1.1">Multiple keys:</span> Second, the DNSSEC specification mandates that a resolver must try all colliding keys until it finds a key that successfully validates the signature or all keys have been tried. This requirement is meant to ensure availability. Even if colliding keys occur, such that some keys may result in failed validation, the resolver has to try validating with all the keys until a key is found that results in a successful validation, ensuring the signed record remains valid and the corresponding resource therefore available. However, this ”eager validation” can lead to heavy computational effort for the validating resolver, since the number of validations grows linearly with the amount of colliding keys. For example, if a signature has ten colliding keys, all with identical algorithm identifier, key tag and all invalid, the resolver must conduct ten signature validations before concluding the signature is invalid. While colliding keys are rare in real-world operation, we show that records with multiple colliding keys can be efficiently crafted by an adversary, imposing heavy computation on a victim resolver.</p>
</div>
<div class="ltx_para" id="S1.p7">
<p class="ltx_p" id="S1.p7.1"><span class="ltx_text ltx_font_italic" id="S1.p7.1.1">Multiple signatures:</span> A philosophy, of trying all the cryptographic material available to ensure that the validation succeeds, also applies to the validation of signatures. Creating multiple signatures for a given DNS record can happen, e.g., during a key rollover. The DNS server adds a signature with the new key, while retaining the old signature to ensure the signature remains valid for all resolvers until the new key has propagated. Thus, parallel to the case of colliding keys, the RFCs specify that in the case of multiple signatures on the same record, a resolver must try all the signatures it received until it finds a valid signature or until all signatures have been tried.</p>
</div>
<div class="ltx_para" id="S1.p8">
<p class="ltx_p" id="S1.p8.1"><span class="ltx_text ltx_font_italic" id="S1.p8.1.1">“The worst vulnerability ever found in DNS”:</span> We combine these requirements for the eager validation of signatures and of keys, along with the colliding key tags to develop powerful DNSSEC-based algorithmic complexity attacks on validating DNS resolvers. Our attacks allow a low-resource adversary to fully DoS a DNS resolver for up to 16h with a single DNS request. The task force with <math alttext="31" class="ltx_Math" display="inline" id="S1.p8.1.m1.1"><semantics id="S1.p8.1.m1.1a"><mn id="S1.p8.1.m1.1.1" xref="S1.p8.1.m1.1.1.cmml">31</mn><annotation-xml encoding="MathML-Content" id="S1.p8.1.m1.1b"><cn id="S1.p8.1.m1.1.1.cmml" type="integer" xref="S1.p8.1.m1.1.1">31</cn></annotation-xml><annotation encoding="application/x-tex" id="S1.p8.1.m1.1c">31</annotation><annotation encoding="application/x-llamapun" id="S1.p8.1.m1.1d">31</annotation></semantics></math> participants from the major operators, vendors and developers of DNS/DNSSEC, to which we disclosed our research, dubbed our attack: <span class="ltx_text ltx_font_italic" id="S1.p8.1.2">the most devastating vulnerability ever found in DNSSEC</span>.
<span class="ltx_text ltx_font_bold" id="S1.p8.1.3">Complex vulnerabilities are challenging to find.</span> Surprisingly the flaws are not recent. The requirement<span class="ltx_note ltx_role_footnote" id="footnote2"><sup class="ltx_note_mark">2</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">2</sup><span class="ltx_tag ltx_tag_note">2</span><span class="ltx_ref ltx_nolink ltx_path ltx_font_typewriter ltx_ref_self">https://datatracker.ietf.org/doc/html/rfc2535#page-46</span></span></span></span> to try all keys was present already in the obsoleted [RFC2535] from 1999. <span class="ltx_text" id="S1.p8.1.4" style="color:#000000;">This requirement, to try all the keys, was carried over to the current specification [RFC4035]. In 2013 the issue was further exacerbated by [RFC6840] recommending validators to also try all the signatures.</span></p>
</div>
<div class="ltx_para" id="S1.p9">
<p class="ltx_p" id="S1.p9.1">The vulnerabilities have been in the wild since at least August 2000 in Bind9 DNS resolver<span class="ltx_note ltx_role_footnote" id="footnote3"><sup class="ltx_note_mark">3</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">3</sup><span class="ltx_tag ltx_tag_note">3</span><span class="ltx_ref ltx_nolink ltx_path ltx_font_typewriter ltx_ref_self">https://github.com/isc-projects/bind9/commit/6f17d90364f01c3e81073a9ffb40b0093878c8e2</span></span></span></span> and were introduced into the code<span class="ltx_note ltx_role_footnote" id="footnote4"><sup class="ltx_note_mark">4</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">4</sup><span class="ltx_tag ltx_tag_note">4</span><a class="ltx_ref ltx_url ltx_font_typewriter" href="https://github.com/NLnetLabs/unbound/commit/8f58908f45d69178f8a30125d8ebcedf3c6f6761" title="">https://github.com/NLnetLabs/unbound/commit/8f58908f45d69178f8a30125d8ebcedf3c6f6761</a></span></span></span> of Unbound DNS resolver in August 2007.
Using the code of Unbound as an example, the vulnerable code performs loops over keys and signatures:</p>
</div>
<div class="ltx_para" id="S1.p10">
<pre class="ltx_verbatim ltx_font_typewriter" id="S1.p10.1" style="font-size:70%;">
//loop over all the keys                     //loop over all the signatures
for(i=0; i&lt;num; i++) {                       for(i=0; i&lt;num; i++) {
   /* see if key matches keytag and algo */      sec = dnskeyset_verify_rrset_sig
   if(algo != dnskey_get_algo(dnskey, i) ||          (env, ve, rrset, dnskey, i);
      tag != dnskey_calc_keytag(dnskey, i))      if(sec == sec_status_secure)
      continue;                                      return sec;
   numchecked ++;                              }
   /* see if key verifies */
   sec = dnskey_verify_rrset_sig
        (env, ve, rrset, dnskey, i, sig_idx);
   if(sec == sec_status_secure)
        return sec;
}
</pre>
</div>
<div class="ltx_para" id="S1.p11">
<p class="ltx_p" id="S1.p11.1">Although the vulnerabilities have existed in the standard for about 25 years and in the wild for 24 years, they have not been noticed by the community. This is not surprising since the complexity of the DNSSEC validation requirements made it challenging to identify the flaws. The exploit requires a combination of a number of requirements, which made it not trivial even for DNS experts to notice. The security community made similar experiences with much simpler vulnerabilities, such as Heartbleed or Log4j <cite class="ltx_cite ltx_citemacro_citep">(<a class="ltx_ref" href="https://arxiv.org/html/2406.03133v1#bib.bib5" title="">heartbleed, </a>; <a class="ltx_ref" href="https://arxiv.org/html/2406.03133v1#bib.bib7" title="">log4j, </a>)</cite> which were there but no one could see them, and they took years to notice and fix. Unfortunately, in contrast to these vulnerabilities, the vulnerabilities we find in this work are not simple to resolve, since they are fundamentally rooted in the design philosophy of DNSSEC, and are not just mere software implementation bugs.</p>
</div>
<div class="ltx_para" id="S1.p12">
<p class="ltx_p" id="S1.p12.1"><span class="ltx_text ltx_font_bold" id="S1.p12.1.1">Flaws are challenging to mitigate.</span> The flaws in DNSSEC validation are not simple to solve. There are legitimate situations in which nameservers may return multiple keys, e.g., to account for potential failures. For instance, some domains may be experimenting with new ciphers, not yet supported by all the resolvers and there are keys-rollover. To avoid failures the nameservers should return all the cryptographic material. Similarly, to ensure successful validation, the resolvers should not fail on the first unsuccessful validation, but should try all the material until validation succeeds. Indeed, the experience we made since we have started working on the patches with the developers shows that these flaws can be substantially mitigated, but cannot be completely solved. Attacks against the final patch still result in heavy CPU load caused by high attacker traffic, but at least DNS packet loss is prevented.
Solving these issues fundamentally requires to reconsider the basics of the design philosophy of the Internet.</p>
</div>
<div class="ltx_para" id="S1.p13">
<p class="ltx_p" id="S1.p13.1"><span class="ltx_text ltx_font_bold" id="S1.p13.1.1">The importance of understanding and weaponizing vulnerabilities.</span> While there were concerns in the community that key tag collisions could introduce a weakness<span class="ltx_note ltx_role_footnote" id="footnote5"><sup class="ltx_note_mark">5</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">5</sup><span class="ltx_tag ltx_tag_note">5</span><a class="ltx_ref ltx_url ltx_font_typewriter" href="https://ripe78.ripe.net/presentations/5-20190520-RIPE-78-DNS-wg-Keytags.pdf" title="">https://ripe78.ripe.net/presentations/5-20190520-RIPE-78-DNS-wg-Keytags.pdf</a></span></span></span> and even a bachelor project attempted to find an attack<span class="ltx_note ltx_role_footnote" id="footnote6"><sup class="ltx_note_mark">6</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">6</sup><span class="ltx_tag ltx_tag_note">6</span><a class="ltx_ref ltx_url ltx_font_typewriter" href="https://essay.utwente.nl/78777/1/Research_paper.pdf" title="">https://essay.utwente.nl/78777/1/Research_paper.pdf</a></span></span></span>, no compelling method to weaponize the key tag and demonstrate an attack was found. Therefore, the collisions were not regarded as a practical threat and vendors did not issue patches. Understanding how to exploit and weaponize a vulnerability and the ability to demonstrate it to the community is critical. There are numerous examples where the ability to understand and realize a threat led to improvements in the security landscape. One such example in DNS is that of port randomization. Initially the DNS resolvers were using predictable or fixed source ports for their requests, until a security expert Kaminsky found a way to weaponize and demonstrated a practical DNS cache poisoning attack <cite class="ltx_cite ltx_citemacro_citep">(<a class="ltx_ref" href="https://arxiv.org/html/2406.03133v1#bib.bib10" title="">kaminsky:dns, </a>)</cite>. Although predictable DNS source ports were seen by many experts in the community as a threat, this was not fixed until a practical attack was demonstrated<span class="ltx_note ltx_role_footnote" id="footnote7"><sup class="ltx_note_mark">7</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">7</sup><span class="ltx_tag ltx_tag_note">7</span><a class="ltx_ref ltx_url ltx_font_typewriter" href="https://makezine.com/article/technology/djbdns-dns-exploits-bernstein/" title="">https://makezine.com/article/technology/djbdns-dns-exploits-bernstein/</a></span></span></span>. Prior to Kaminsky’s demonstration, despite the concerns, the vendors did not consider this a practical threat. Following Kaminsky’s attack, all the vendors quickly patched their DNS resolvers to send DNS requests from unpredictable ports. This and other examples show that to improve security a deep understanding of the problem at hand is required, in order to find a way to weaponize it, so that it then becomes an attack. This was also the case with key trap, after we found a way to demonstrate for the first time that key trap was a practical threat, all the vendors immediately issued patches.</p>
</div>
<div class="ltx_para" id="S1.p14">
<p class="ltx_p" id="S1.p14.1"><span class="ltx_text ltx_font_bold" id="S1.p14.1.1">Contributions.</span> We make the following contributions:</p>
</div>
<div class="ltx_para" id="S1.p15">
<p class="ltx_p" id="S1.p15.1"><math alttext="\bullet" class="ltx_Math" display="inline" id="S1.p15.1.m1.1"><semantics id="S1.p15.1.m1.1a"><mo id="S1.p15.1.m1.1.1" xref="S1.p15.1.m1.1.1.cmml">∙</mo><annotation-xml encoding="MathML-Content" id="S1.p15.1.m1.1b"><ci id="S1.p15.1.m1.1.1.cmml" xref="S1.p15.1.m1.1.1">∙</ci></annotation-xml><annotation encoding="application/x-tex" id="S1.p15.1.m1.1c">\bullet</annotation><annotation encoding="application/x-llamapun" id="S1.p15.1.m1.1d">∙</annotation></semantics></math> Conceptually, we find that the aim to ensure validation at any cost in DNSSEC standard exposes the DNS resolvers to attacks. We analyze the DNSSEC standards in §<a class="ltx_ref" href="https://arxiv.org/html/2406.03133v1#S4" title="4. Analysis of DNSSEC Specification ‣ The Harder You Try, The Harder You Fail: The KeyTrap Denial-of-Service Algorithmic Complexity Attacks on DNSSEC"><span class="ltx_text ltx_ref_tag">4</span></a>, and identify flaws in the DNSSEC standards which enable complexity attacks.</p>
</div>
<div class="ltx_para" id="S1.p16">
<p class="ltx_p" id="S1.p16.1"><math alttext="\bullet" class="ltx_Math" display="inline" id="S1.p16.1.m1.1"><semantics id="S1.p16.1.m1.1a"><mo id="S1.p16.1.m1.1.1" xref="S1.p16.1.m1.1.1.cmml">∙</mo><annotation-xml encoding="MathML-Content" id="S1.p16.1.m1.1b"><ci id="S1.p16.1.m1.1.1.cmml" xref="S1.p16.1.m1.1.1">∙</ci></annotation-xml><annotation encoding="application/x-tex" id="S1.p16.1.m1.1c">\bullet</annotation><annotation encoding="application/x-llamapun" id="S1.p16.1.m1.1d">∙</annotation></semantics></math> We combine the flaws in the RFCs to develop the first algorithmic complexity attacks that exploit vulnerabilities in DNSSEC. We find experimentally that all standard-compliant DNS implementations support the flawed recommendations and hence are vulnerable to our attacks.</p>
</div>
<div class="ltx_para" id="S1.p17">
<p class="ltx_p" id="S1.p17.1"><math alttext="\bullet" class="ltx_Math" display="inline" id="S1.p17.1.m1.1"><semantics id="S1.p17.1.m1.1a"><mo id="S1.p17.1.m1.1.1" xref="S1.p17.1.m1.1.1.cmml">∙</mo><annotation-xml encoding="MathML-Content" id="S1.p17.1.m1.1b"><ci id="S1.p17.1.m1.1.1.cmml" xref="S1.p17.1.m1.1.1">∙</ci></annotation-xml><annotation encoding="application/x-tex" id="S1.p17.1.m1.1c">\bullet</annotation><annotation encoding="application/x-llamapun" id="S1.p17.1.m1.1d">∙</annotation></semantics></math> We analyze the code of popular DNS implementations to identify the effects of the stalling on, e.g., caching, pending DNS requests or inbound/pending DNS packets. We use our observations to provide recommendations for adapting the architecture of the resolvers to improve the robustness to failures and attacks.</p>
</div>
<div class="ltx_para" id="S1.p18">
<p class="ltx_p" id="S1.p18.1"><math alttext="\bullet" class="ltx_Math" display="inline" id="S1.p18.1.m1.1"><semantics id="S1.p18.1.m1.1a"><mo id="S1.p18.1.m1.1.1" xref="S1.p18.1.m1.1.1.cmml">∙</mo><annotation-xml encoding="MathML-Content" id="S1.p18.1.m1.1b"><ci id="S1.p18.1.m1.1.1.cmml" xref="S1.p18.1.m1.1.1">∙</ci></annotation-xml><annotation encoding="application/x-tex" id="S1.p18.1.m1.1c">\bullet</annotation><annotation encoding="application/x-llamapun" id="S1.p18.1.m1.1d">∙</annotation></semantics></math> We performed ethical disclosure of our vulnerabilities to the major DNS vendors, DNS/CDN/cloud operators and standardizers on November 2, 2023. Since then, we have been intensively working with this group on developing patches and regularly communicating with the developers within a closed chat group. We provided to the developers our attack vectors encoded in DNS zonefiles and set up a test environment for evaluation of vulnerabilities in DNSSEC, which alleviates the need for manual setup and enables quick evaluation of the attacks against the proposed patches. We provide a timeline for disclosure and of the patches development process.
<span class="ltx_text" id="S1.p18.1.1" style="color:#000000;">Our discovered vulnerabilities were assigned an umbrella CVE in December 2023.</span></p>
</div>
<div class="ltx_para" id="S1.p19">
<p class="ltx_p" id="S1.p19.1"><span class="ltx_text ltx_font_bold" id="S1.p19.1.1">Organization.</span> We compare our research to related work in §<a class="ltx_ref" href="https://arxiv.org/html/2406.03133v1#S2" title="2. Related Work ‣ The Harder You Try, The Harder You Fail: The KeyTrap Denial-of-Service Algorithmic Complexity Attacks on DNSSEC"><span class="ltx_text ltx_ref_tag">2</span></a>. We provide an overview of DNS and DNSSEC in §<a class="ltx_ref" href="https://arxiv.org/html/2406.03133v1#S3" title="3. Overview of DNSSEC ‣ The Harder You Try, The Harder You Fail: The KeyTrap Denial-of-Service Algorithmic Complexity Attacks on DNSSEC"><span class="ltx_text ltx_ref_tag">3</span></a>. We analyze the recommendations in the DNS standard specification in §<a class="ltx_ref" href="https://arxiv.org/html/2406.03133v1#S4" title="4. Analysis of DNSSEC Specification ‣ The Harder You Try, The Harder You Fail: The KeyTrap Denial-of-Service Algorithmic Complexity Attacks on DNSSEC"><span class="ltx_text ltx_ref_tag">4</span></a>. We construct the attacks in §<a class="ltx_ref" href="https://arxiv.org/html/2406.03133v1#S5" title="5. Resource Exhaustion Attacks ‣ The Harder You Try, The Harder You Fail: The KeyTrap Denial-of-Service Algorithmic Complexity Attacks on DNSSEC"><span class="ltx_text ltx_ref_tag">5</span></a> and evaluate them against major DNS implementations and services in §<a class="ltx_ref" href="https://arxiv.org/html/2406.03133v1#S6" title="6. Evaluation of the Attacks ‣ The Harder You Try, The Harder You Fail: The KeyTrap Denial-of-Service Algorithmic Complexity Attacks on DNSSEC"><span class="ltx_text ltx_ref_tag">6</span></a>. Disclosure and the process of developing mitigations are in §<a class="ltx_ref" href="https://arxiv.org/html/2406.03133v1#S7" title="7. The Path to Mitigations ‣ The Harder You Try, The Harder You Fail: The KeyTrap Denial-of-Service Algorithmic Complexity Attacks on DNSSEC"><span class="ltx_text ltx_ref_tag">7</span></a>. We <span class="ltx_text" id="S1.p19.1.2" style="color:#000000;">discuss ethical considerations in §<a class="ltx_ref" href="https://arxiv.org/html/2406.03133v1#S8" title="8. Ethical Considerations ‣ The Harder You Try, The Harder You Fail: The KeyTrap Denial-of-Service Algorithmic Complexity Attacks on DNSSEC"><span class="ltx_text ltx_ref_tag">8</span></a> and</span> conclude in §<a class="ltx_ref" href="https://arxiv.org/html/2406.03133v1#S9" title="9. Conclusions ‣ The Harder You Try, The Harder You Fail: The KeyTrap Denial-of-Service Algorithmic Complexity Attacks on DNSSEC"><span class="ltx_text ltx_ref_tag">9</span></a>.</p>
</div>
</section>
<section class="ltx_section" id="S2">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">2. </span>Related Work</h2>
<div class="ltx_para" id="S2.p1">
<p class="ltx_p" id="S2.p1.1">In Distributed Denial of Service (DDoS) attacks adversaries flood a victim resource, e.g., a network bandwidth or a buffer, with a large volume of packets loading the target victim beyond its available capacity and causing packet loss <cite class="ltx_cite ltx_citemacro_citep">(<a class="ltx_ref" href="https://arxiv.org/html/2406.03133v1#bib.bib12" title="">kuhrer2014exit, </a>)</cite>. DNS is often a victim of DDoS, either as a target or as a reflector to flood other victims. Since DNS responses are larger than DNS requests, reflected DNS responses amplify the load generated by the attacker’s requests. The amplification factor is exacerbated with DNSSEC, whose signatures and keys further increase the sizes of DNS responses <cite class="ltx_cite ltx_citemacro_citep">(<a class="ltx_ref" href="https://arxiv.org/html/2406.03133v1#bib.bib16" title="">van2014dnssec, </a>)</cite>.
An amplification effect can also be achieved by exploiting vulnerabilities in protocol implementations or vulnerabilities in the processing of DNS records <cite class="ltx_cite ltx_citemacro_citep">(<a class="ltx_ref" href="https://arxiv.org/html/2406.03133v1#bib.bib4" title="">bushart2018dns, </a>; <a class="ltx_ref" href="https://arxiv.org/html/2406.03133v1#bib.bib14" title="">DBLP:conf/imc/MouraCHWH20, </a>)</cite>.
NXNSAttack <cite class="ltx_cite ltx_citemacro_citep">(<a class="ltx_ref" href="https://arxiv.org/html/2406.03133v1#bib.bib1" title="">afek2020nxnsattack, </a>)</cite> exploited a vulnerability that generated a flood of queries between the recursive resolver and the authoritative server creating a load on them both. Recently, <cite class="ltx_cite ltx_citemacro_citep">(<a class="ltx_ref" href="https://arxiv.org/html/2406.03133v1#bib.bib2" title="">afek2023nrdelegationattack, </a>)</cite> demonstrated a complexity attack on DNS which causes a victim resolver to issue multiple queries, following delegation responses by a malicious authoritative server. The victim resolver issues the queries to nameservers which do not respond, eventually exhausting its resources.</p>
</div>
<div class="ltx_para" id="S2.p2">
<p class="ltx_p" id="S2.p2.1">The NRDelegation attack in <cite class="ltx_cite ltx_citemacro_citep">(<a class="ltx_ref" href="https://arxiv.org/html/2406.03133v1#bib.bib2" title="">afek2023nrdelegationattack, </a>)</cite> is shown to achieve a 5600x increase in CPU instructions between the attack requests and benign DNS requests. In contrast, our KeyTrap attack in this work achieves a 2000000x increase in CPU instruction count.</p>
</div>
<div class="ltx_para" id="S2.p3">
<p class="ltx_p" id="S2.p3.1">To compare the impact between both attacks on the CPU instruction count, we set up a benign and a malicious signed domains.
We set up an Unbound resolver in an isolated environment and run Linux perf to measure CPU instruction count. We first measure the CPU instruction count of a request to a benign DNSSEC signed domain.
To ensure reliability we average out the instruction count over five measurements. Further, we set up the attack domain on the same DNS server. The measurements are conducted on Ubuntu 22.04 LTS with Unbound 1.19.0 DNS software. In our test setup, we find that a benign request on a signed DNSSEC domain requires approx. <span class="ltx_text ltx_font_bold" id="S2.p3.1.1">811.500 CPU instructions</span> on Unbound. In contrast, we find a significantly higher instruction count for the resolution of the KeyTrap attack domain. To resolve and validate the domain, Unbound takes approximately <span class="ltx_text ltx_font_bold" id="S2.p3.1.2">1.725.000.000.000 CPU instructions</span>. Comparing to the benign request, the attack thus leads to a 2.000.000x increase in CPU instruction count, compared to the 5600x increase in NR delegation. Directly comparing the CPU instructions count of <cite class="ltx_cite ltx_citemacro_citep">(<a class="ltx_ref" href="https://arxiv.org/html/2406.03133v1#bib.bib2" title="">afek2023nrdelegationattack, </a>)</cite>, we find that NR delegation attack requires 1569 queries to result in the same increase in CPU instruction count as a single request with our KeyTrap attack. Hence, a KeyTrap request leads to the same load as approx. 2 million benign requests.</p>
</div>
<div class="ltx_para" id="S2.p4">
<p class="ltx_p" id="S2.p4.2">Van Rijswijk-Deij et al. <cite class="ltx_cite ltx_citemacro_citep">(<a class="ltx_ref" href="https://arxiv.org/html/2406.03133v1#bib.bib15" title="">van2016performance, </a>)</cite> explored the performance of ECC vs RSA on Bind9 and Unbound.
They evaluated the load on the Bind9 and Unbound resolvers when sending multiple signatures and found that the ECC algorithms do not impose too much additional CPU load on the two resolvers in contrast to RSA.
To create load the authors made the resolver request a large number of non-existent records (NSEC3), causing many DNS responses, each carrying up to three NSEC3 records plus one SOA, with one signature validation per record. In effect, the victim resolver was validating four RRSIG records per response.
While the responses sent by <cite class="ltx_cite ltx_citemacro_citep">(<a class="ltx_ref" href="https://arxiv.org/html/2406.03133v1#bib.bib15" title="">van2016performance, </a>)</cite> caused the resolver to perform 4 validations, equivalent to the number of signatures their nameserver returned (an order of <math alttext="\mathcal{O}(n)" class="ltx_Math" display="inline" id="S2.p4.1.m1.1"><semantics id="S2.p4.1.m1.1a"><mrow id="S2.p4.1.m1.1.2" xref="S2.p4.1.m1.1.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S2.p4.1.m1.1.2.2" xref="S2.p4.1.m1.1.2.2.cmml">𝒪</mi><mo id="S2.p4.1.m1.1.2.1" xref="S2.p4.1.m1.1.2.1.cmml">⁢</mo><mrow id="S2.p4.1.m1.1.2.3.2" xref="S2.p4.1.m1.1.2.cmml"><mo id="S2.p4.1.m1.1.2.3.2.1" stretchy="false" xref="S2.p4.1.m1.1.2.cmml">(</mo><mi id="S2.p4.1.m1.1.1" xref="S2.p4.1.m1.1.1.cmml">n</mi><mo id="S2.p4.1.m1.1.2.3.2.2" stretchy="false" xref="S2.p4.1.m1.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.p4.1.m1.1b"><apply id="S2.p4.1.m1.1.2.cmml" xref="S2.p4.1.m1.1.2"><times id="S2.p4.1.m1.1.2.1.cmml" xref="S2.p4.1.m1.1.2.1"></times><ci id="S2.p4.1.m1.1.2.2.cmml" xref="S2.p4.1.m1.1.2.2">𝒪</ci><ci id="S2.p4.1.m1.1.1.cmml" xref="S2.p4.1.m1.1.1">𝑛</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.p4.1.m1.1c">\mathcal{O}(n)</annotation><annotation encoding="application/x-llamapun" id="S2.p4.1.m1.1d">caligraphic_O ( italic_n )</annotation></semantics></math>), our specially crafted records trigger more than 500K validations per DNS response (an order of <math alttext="\mathcal{O}(n^{2})" class="ltx_Math" display="inline" id="S2.p4.2.m2.1"><semantics id="S2.p4.2.m2.1a"><mrow id="S2.p4.2.m2.1.1" xref="S2.p4.2.m2.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S2.p4.2.m2.1.1.3" xref="S2.p4.2.m2.1.1.3.cmml">𝒪</mi><mo id="S2.p4.2.m2.1.1.2" xref="S2.p4.2.m2.1.1.2.cmml">⁢</mo><mrow id="S2.p4.2.m2.1.1.1.1" xref="S2.p4.2.m2.1.1.1.1.1.cmml"><mo id="S2.p4.2.m2.1.1.1.1.2" stretchy="false" xref="S2.p4.2.m2.1.1.1.1.1.cmml">(</mo><msup id="S2.p4.2.m2.1.1.1.1.1" xref="S2.p4.2.m2.1.1.1.1.1.cmml"><mi id="S2.p4.2.m2.1.1.1.1.1.2" xref="S2.p4.2.m2.1.1.1.1.1.2.cmml">n</mi><mn id="S2.p4.2.m2.1.1.1.1.1.3" xref="S2.p4.2.m2.1.1.1.1.1.3.cmml">2</mn></msup><mo id="S2.p4.2.m2.1.1.1.1.3" stretchy="false" xref="S2.p4.2.m2.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.p4.2.m2.1b"><apply id="S2.p4.2.m2.1.1.cmml" xref="S2.p4.2.m2.1.1"><times id="S2.p4.2.m2.1.1.2.cmml" xref="S2.p4.2.m2.1.1.2"></times><ci id="S2.p4.2.m2.1.1.3.cmml" xref="S2.p4.2.m2.1.1.3">𝒪</ci><apply id="S2.p4.2.m2.1.1.1.1.1.cmml" xref="S2.p4.2.m2.1.1.1.1"><csymbol cd="ambiguous" id="S2.p4.2.m2.1.1.1.1.1.1.cmml" xref="S2.p4.2.m2.1.1.1.1">superscript</csymbol><ci id="S2.p4.2.m2.1.1.1.1.1.2.cmml" xref="S2.p4.2.m2.1.1.1.1.1.2">𝑛</ci><cn id="S2.p4.2.m2.1.1.1.1.1.3.cmml" type="integer" xref="S2.p4.2.m2.1.1.1.1.1.3">2</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.p4.2.m2.1c">\mathcal{O}(n^{2})</annotation><annotation encoding="application/x-llamapun" id="S2.p4.2.m2.1d">caligraphic_O ( italic_n start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT )</annotation></semantics></math>). Our attack scales quadratically with the number of keys returned to the resolver.</p>
</div>
<div class="ltx_para" id="S2.p5">
<p class="ltx_p" id="S2.p5.1">In contrast to previous work our KeyTrap attacks do not require multiple packets, instead we exploit algorithmic complexity vulnerabilities in the DNSSEC validation in DNS resolvers as a building block to develop CPU based DoS attacks. Our complexity attacks are triggered by feeding the DNS resolvers with specially crafted DNSSEC records, which are constructed in a way that exploits validation vulnerabilities in cryptographic validation logic.
When the DNS resolvers attempt to validate the DNSSEC records they receive from our nameserver, they get stalled.
Our attacks are extremely stealthy, being able to stall resolvers between 170 seconds and 16 hours (depending on the resolver software) with a single DNS response packet. All the resolvers we tested were found vulnerable to our attacks. We evaluate how DNS implementations react to the load created by the attack and find that certain design choices can enable faster recovery from our DoS attacks.</p>
</div>
<div class="ltx_para" id="S2.p6">
<p class="ltx_p" id="S2.p6.1">Our work is also related to downgrade attacks against DNSSEC, DNSSEC <cite class="ltx_cite ltx_citemacro_citep">(<a class="ltx_ref" href="https://arxiv.org/html/2406.03133v1#bib.bib9" title="">heftrig2023downgrading, </a>)</cite>. The DNSSEC-downgrade attacks however focus on disabling DNSSEC validation, but do not have adverse effects on the availability of the victim resolvers.</p>
</div>
</section>
<section class="ltx_section" id="S3">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">3. </span>Overview of DNSSEC</h2>
<div class="ltx_para" id="S3.p1">
<p class="ltx_p" id="S3.p1.1">DNSSEC [RFC4033-4035] ensures origin authenticity and data integrity in DNS. To gain security benefits the domain owners should digitally sign the records in their domains, and should upgrade the nameservers to serve DNSSEC-signed DNS responses. The DNS resolvers should validate the received DNS records against the digital signatures. To validate the public keys the resolvers should construct a validation path from the root zone to the target domain. If validation fails, the resolver must not deliver the bogus records to the client and instead signal an error by sending a <span class="ltx_text ltx_font_typewriter" id="S3.p1.1.1">SERVFAIL</span> response. If DNSSEC validation is successful, the resolver should return the requested records to the client and cache them.</p>
</div>
<div class="ltx_para" id="S3.p2">
<p class="ltx_p" id="S3.p2.1">DNSSEC signatures are conveyed in RRSIG-type DNS records. An RRSIG record is associated with the set of records (RRset) it covers by name, class, and the record type indicated by an RRSIG-specific record field. The public keys used to validate the signatures are sent in DNSKEY-type records.
</p>
</div>
<div class="ltx_para" id="S3.p3">
<p class="ltx_p" id="S3.p3.1">There are two types of keys: Zone-Signing-Key (ZSK) and Key-Signing-Key (KSK).
The ZSKs are used to sign records in the zone and are authenticated with a KSK.
<span class="ltx_text" id="S3.p3.1.1" style="color:#000000;">DNSKEY records contain multiple fields, including usage-indicating flags, the protocol and algorithm specifiers, and the key bytes.
From these record data the key tag can be calculated. The KSKs and all ZSKs of a zone are included into a DNSKEY set which is signed by at least one KSK. Signature records covering the DNSKEY set need to reference the key tag of a KSK. Only after the DNSKEY set is validated can the ZSK be used to validate signatures covering other records (RRs). To support simple DNSSEC setups, KSK and ZSK can be identical.</span></p>
</div>
<div class="ltx_para" id="S3.p4">
<p class="ltx_p" id="S3.p4.1">DS records from a parent zone are used to authenticate individual KSK type DNSKEY records in a child zone. This is done to delegate trust from a parent zone public key to a child zone public key. DS records use the same triple <span class="ltx_text ltx_font_italic" id="S3.p4.1.1">(zone name, algorithm, key tag)</span> as RRSIGs to identify a subset of candidate DNSKEYs.</p>
</div>
<div class="ltx_para" id="S3.p5">
<p class="ltx_p" id="S3.p5.1">DNS records contain mappings from DNS names to resources. In this work, we use the DNS A record in the evaluations of our attacks. The A record contains the mapping of a domain name in the zone to an IPv4 address. The A record includes a TTL value, which specifies the validity period for caching. The A-type record is queried by a resolver when resolving a domain name. For instance, an A record may map the domain <span class="ltx_text ltx_font_italic" id="S3.p5.1.1">www-x.attack.er</span> to the IP address 6.6.6.6. We explain the functionality of DNS and DNSSEC with concrete examples in §<a class="ltx_ref" href="https://arxiv.org/html/2406.03133v1#S5" title="5. Resource Exhaustion Attacks ‣ The Harder You Try, The Harder You Fail: The KeyTrap Denial-of-Service Algorithmic Complexity Attacks on DNSSEC"><span class="ltx_text ltx_ref_tag">5</span></a>.</p>
</div>
</section>
<section class="ltx_section" id="S4">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">4. </span>Analysis of DNSSEC Specification</h2>
<div class="ltx_para" id="S4.p1">
<p class="ltx_p" id="S4.p1.1">In the following, we illustrate the validation recommendations in the DNSSEC standard relevant to the KeyTrap attacks.</p>
</div>
<div class="ltx_para" id="S4.p2">
<p class="ltx_p" id="S4.p2.1"><span class="ltx_text ltx_font_bold" id="S4.p2.1.1">Associating keys with signatures.</span> A domain can use multiple different keys, see [RFC6840, §6.2]. This is required for instance to support new stronger cryptographic ciphers but also to offer weaker ciphers for other non-supporting resolvers, or to support stronger and weaker keys of same cipher, or during key rollover.</p>
</div>
<div class="ltx_para" id="S4.p3">
<p class="ltx_p" id="S4.p3.1">In such a situation the DNS records are signed with all those keys and the resolver receives the keys and signatures in a DNS response.</p>
</div>
<div class="ltx_para" id="S4.p4">
<p class="ltx_p" id="S4.p4.1">To authenticate an RRset the RRSIG covering it needs to be associated with the DNSKEY record carrying the corresponding public key. This is done by matching the <span class="ltx_text ltx_font_typewriter" id="S4.p4.1.1">Signer’s Name</span> in the RRSIG record data field with the name of the DNSKEY record and the algorithm fields.
Additionally, the value of the <span class="ltx_text ltx_font_typewriter" id="S4.p4.1.2">Key Tag</span> field in the RRSIG must match the key tag value of the DNSKEY.
Note that the DNSKEY record data format does not specify a <span class="ltx_text ltx_font_typewriter" id="S4.p4.1.3">Key Tag</span> field. Instead, the key tag value is calculated by resolvers as an unsigned 16-bit integer sum over all two-octet words in the DNSKEY record data (ignoring carry and allowing overflow).
As highlighted by [RFC4034, §B], the key tag is not a unique identifier, but a mechanism to efficiently identify a subset of DNSKEYs possibly matching the RRSIG to be validated.
In consequence, to successfully authenticate an RRset covered by an RRSIG, the resolver <span class="ltx_text ltx_font_sansserif" id="S4.p4.1.4">MUST</span> try all DNSKEYs in this subset until it succeeds to validate the signature using one of the candidate public keys or runs out of keys to try [RFC4035, §5.3.1].</p>
</div>
<div class="ltx_para" id="S4.p5">
<p class="ltx_p" id="S4.p5.1">Moreover, the DNSSEC key tag is not a crytographic fingerprint of the public key. Representing an unsigned integer sum over the record data the key tag does not provide a cryptographic collision resistance. In §<a class="ltx_ref" href="https://arxiv.org/html/2406.03133v1#S5" title="5. Resource Exhaustion Attacks ‣ The Harder You Try, The Harder You Fail: The KeyTrap Denial-of-Service Algorithmic Complexity Attacks on DNSSEC"><span class="ltx_text ltx_ref_tag">5</span></a> we develop an attack <span class="ltx_text ltx_font_italic" id="S4.p5.1.1">LockCram</span> which exploits the requirement to associate keys with signatures.</p>
</div>
<div class="ltx_para" id="S4.p6">
<p class="ltx_p" id="S4.p6.1"><span class="ltx_text ltx_font_bold" id="S4.p6.1.1">Resolvers are endorsed to try all signatures.</span>
To support a variety of domain-side key and algorithm roll-over schemes, as well as to increase robustness against cache-induced inconsistencies in the Internet-wide DNS state, resolvers must be tolerant in case individual signatures do not validate.
Besides ignoring any RRSIGs, which do not match any authenticated DNSKEY, resolvers are endorsed by specification (<span class="ltx_text ltx_font_sansserif" id="S4.p6.1.2">SHOULD</span>) to try all RRSIGs covering an RRset until a valid one is found. Only if all signatures fail to authenticate the RRset should the resolver mark it invalid. When multiple RRSIGs cover a given RRset, [RFC6840, §5.4] suggests that a resolver <span class="ltx_text ltx_font_sansserif" id="S4.p6.1.3">SHOULD</span> accept any valid RRSIG as sufficient, and only determine that an RRset is bogus if all RRSIGs fail validation.</p>
</div>
<div class="ltx_para" id="S4.p7">
<p class="ltx_p" id="S4.p7.1">The explanation is that if a resolver adopts a more restrictive policy, there is a danger that properly signed data might unnecessarily fail validation. .
Furthermore, certain zone management techniques, like the Double Signature Zone Signing Key Rollover method described in [RFC6781, §4.1.1], will not work reliably.</p>
</div>
<div class="ltx_para" id="S4.p8">
<p class="ltx_p" id="S4.p8.1"><span class="ltx_text ltx_font_bold" id="S4.p8.1.1">Resolvers try to authenticate all DNSKEYs with all DS hashes.</span> The DNSSEC standard is not clear on the requirement of DS hashes authentication. This vagueness left it for developers to decide how to implement the DS validation. We experimentally find that all the resolvers in our dataset validate all the DS hashes.</p>
</div>
<div class="ltx_para" id="S4.p9">
<p class="ltx_p" id="S4.p9.6"><span class="ltx_text ltx_font_bold" id="S4.p9.6.1">RFC-compliant resolvers are vulnerable.</span> We find experimentally that all the resolvers in our dataset adhere to RFC specifications, validating all signatures with all DNSSEC keys they received from the attack server and validate all DS hashes against all the DNSKEY records. For examples, see the the validation routines in Unbound<span class="ltx_note ltx_role_footnote" id="footnote8"><sup class="ltx_note_mark">8</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">8</sup><span class="ltx_tag ltx_tag_note">8</span><a class="ltx_ref ltx_url ltx_font_typewriter" href="https://github.com/NLnetLabs/unbound/blob/master/validator/val_sigcrypt.c" title="">https://github.com/NLnetLabs/unbound/blob/master/validator/val_sigcrypt.c</a>
<br class="ltx_break"/>lines <math alttext="641" class="ltx_Math" display="inline" id="footnote8.m1.1"><semantics id="footnote8.m1.1b"><mn id="footnote8.m1.1.1" xref="footnote8.m1.1.1.cmml">641</mn><annotation-xml encoding="MathML-Content" id="footnote8.m1.1c"><cn id="footnote8.m1.1.1.cmml" type="integer" xref="footnote8.m1.1.1">641</cn></annotation-xml><annotation encoding="application/x-tex" id="footnote8.m1.1d">641</annotation><annotation encoding="application/x-llamapun" id="footnote8.m1.1e">641</annotation></semantics></math> and <math alttext="704" class="ltx_Math" display="inline" id="footnote8.m2.1"><semantics id="footnote8.m2.1b"><mn id="footnote8.m2.1.1" xref="footnote8.m2.1.1.cmml">704</mn><annotation-xml encoding="MathML-Content" id="footnote8.m2.1c"><cn id="footnote8.m2.1.1.cmml" type="integer" xref="footnote8.m2.1.1">704</cn></annotation-xml><annotation encoding="application/x-tex" id="footnote8.m2.1d">704</annotation><annotation encoding="application/x-llamapun" id="footnote8.m2.1e">704</annotation></semantics></math>.</span></span></span>.
In this work we show that these requirements are vulnerable.
We develop KeyTrap algorithmic complexity attacks that exploit the specification weaknesses in the association process described above to forge a DNSKEY set of cardinality <math alttext="k" class="ltx_Math" display="inline" id="S4.p9.1.m1.1"><semantics id="S4.p9.1.m1.1a"><mi id="S4.p9.1.m1.1.1" xref="S4.p9.1.m1.1.1.cmml">k</mi><annotation-xml encoding="MathML-Content" id="S4.p9.1.m1.1b"><ci id="S4.p9.1.m1.1.1.cmml" xref="S4.p9.1.m1.1.1">𝑘</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.p9.1.m1.1c">k</annotation><annotation encoding="application/x-llamapun" id="S4.p9.1.m1.1d">italic_k</annotation></semantics></math>, conforming to a single key tag <math alttext="t_{k}" class="ltx_Math" display="inline" id="S4.p9.2.m2.1"><semantics id="S4.p9.2.m2.1a"><msub id="S4.p9.2.m2.1.1" xref="S4.p9.2.m2.1.1.cmml"><mi id="S4.p9.2.m2.1.1.2" xref="S4.p9.2.m2.1.1.2.cmml">t</mi><mi id="S4.p9.2.m2.1.1.3" xref="S4.p9.2.m2.1.1.3.cmml">k</mi></msub><annotation-xml encoding="MathML-Content" id="S4.p9.2.m2.1b"><apply id="S4.p9.2.m2.1.1.cmml" xref="S4.p9.2.m2.1.1"><csymbol cd="ambiguous" id="S4.p9.2.m2.1.1.1.cmml" xref="S4.p9.2.m2.1.1">subscript</csymbol><ci id="S4.p9.2.m2.1.1.2.cmml" xref="S4.p9.2.m2.1.1.2">𝑡</ci><ci id="S4.p9.2.m2.1.1.3.cmml" xref="S4.p9.2.m2.1.1.3">𝑘</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.p9.2.m2.1c">t_{k}</annotation><annotation encoding="application/x-llamapun" id="S4.p9.2.m2.1d">italic_t start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT</annotation></semantics></math>, and to create a large number <math alttext="s" class="ltx_Math" display="inline" id="S4.p9.3.m3.1"><semantics id="S4.p9.3.m3.1a"><mi id="S4.p9.3.m3.1.1" xref="S4.p9.3.m3.1.1.cmml">s</mi><annotation-xml encoding="MathML-Content" id="S4.p9.3.m3.1b"><ci id="S4.p9.3.m3.1.1.cmml" xref="S4.p9.3.m3.1.1">𝑠</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.p9.3.m3.1c">s</annotation><annotation encoding="application/x-llamapun" id="S4.p9.3.m3.1d">italic_s</annotation></semantics></math> of invalid RRSIG records, which all reference these DNSKEYs. In consequence, the resolver needs to check all <math alttext="s" class="ltx_Math" display="inline" id="S4.p9.4.m4.1"><semantics id="S4.p9.4.m4.1a"><mi id="S4.p9.4.m4.1.1" xref="S4.p9.4.m4.1.1.cmml">s</mi><annotation-xml encoding="MathML-Content" id="S4.p9.4.m4.1b"><ci id="S4.p9.4.m4.1.1.cmml" xref="S4.p9.4.m4.1.1">𝑠</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.p9.4.m4.1c">s</annotation><annotation encoding="application/x-llamapun" id="S4.p9.4.m4.1d">italic_s</annotation></semantics></math> signatures against all <math alttext="k" class="ltx_Math" display="inline" id="S4.p9.5.m5.1"><semantics id="S4.p9.5.m5.1a"><mi id="S4.p9.5.m5.1.1" xref="S4.p9.5.m5.1.1.cmml">k</mi><annotation-xml encoding="MathML-Content" id="S4.p9.5.m5.1b"><ci id="S4.p9.5.m5.1.1.cmml" xref="S4.p9.5.m5.1.1">𝑘</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.p9.5.m5.1c">k</annotation><annotation encoding="application/x-llamapun" id="S4.p9.5.m5.1d">italic_k</annotation></semantics></math> keys – a procedure with asymptotic complexity in <math alttext="\mathcal{O}(n^{2})" class="ltx_Math" display="inline" id="S4.p9.6.m6.1"><semantics id="S4.p9.6.m6.1a"><mrow id="S4.p9.6.m6.1.1" xref="S4.p9.6.m6.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.p9.6.m6.1.1.3" xref="S4.p9.6.m6.1.1.3.cmml">𝒪</mi><mo id="S4.p9.6.m6.1.1.2" xref="S4.p9.6.m6.1.1.2.cmml">⁢</mo><mrow id="S4.p9.6.m6.1.1.1.1" xref="S4.p9.6.m6.1.1.1.1.1.cmml"><mo id="S4.p9.6.m6.1.1.1.1.2" stretchy="false" xref="S4.p9.6.m6.1.1.1.1.1.cmml">(</mo><msup id="S4.p9.6.m6.1.1.1.1.1" xref="S4.p9.6.m6.1.1.1.1.1.cmml"><mi id="S4.p9.6.m6.1.1.1.1.1.2" xref="S4.p9.6.m6.1.1.1.1.1.2.cmml">n</mi><mn id="S4.p9.6.m6.1.1.1.1.1.3" xref="S4.p9.6.m6.1.1.1.1.1.3.cmml">2</mn></msup><mo id="S4.p9.6.m6.1.1.1.1.3" stretchy="false" xref="S4.p9.6.m6.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.p9.6.m6.1b"><apply id="S4.p9.6.m6.1.1.cmml" xref="S4.p9.6.m6.1.1"><times id="S4.p9.6.m6.1.1.2.cmml" xref="S4.p9.6.m6.1.1.2"></times><ci id="S4.p9.6.m6.1.1.3.cmml" xref="S4.p9.6.m6.1.1.3">𝒪</ci><apply id="S4.p9.6.m6.1.1.1.1.1.cmml" xref="S4.p9.6.m6.1.1.1.1"><csymbol cd="ambiguous" id="S4.p9.6.m6.1.1.1.1.1.1.cmml" xref="S4.p9.6.m6.1.1.1.1">superscript</csymbol><ci id="S4.p9.6.m6.1.1.1.1.1.2.cmml" xref="S4.p9.6.m6.1.1.1.1.1.2">𝑛</ci><cn id="S4.p9.6.m6.1.1.1.1.1.3.cmml" type="integer" xref="S4.p9.6.m6.1.1.1.1.1.3">2</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.p9.6.m6.1c">\mathcal{O}(n^{2})</annotation><annotation encoding="application/x-llamapun" id="S4.p9.6.m6.1d">caligraphic_O ( italic_n start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT )</annotation></semantics></math>.</p>
</div>
</section>
<section class="ltx_section" id="S5">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">5. </span>Resource Exhaustion Attacks</h2>
<div class="ltx_para" id="S5.p1">
<p class="ltx_p" id="S5.p1.1">Our attacks consist of a module for sending queries to the target resolver, malicious nameservers and the zonefiles that encode the KeyTrap attack vectors.
We exploit algorithmic complexity vulnerabilities in standard requirements to develop different variants of KeyTrap resource exhaustion attacks: KeySigTrap, SigJam, LockCram, and HashTrap. To initiate the attacks our adversary causes the victim resolver to look up a record in its malicious domain. The attacker’s nameserver responds to the DNS queries with malicious record sets (RRsets), according to the specific attack vector and zone configuration.</p>
</div>
<section class="ltx_subsection" id="S5.SS1">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">5.1. </span>Threat Model</h3>
<div class="ltx_para" id="S5.SS1.p1">
<p class="ltx_p" id="S5.SS1.p1.1"><span class="ltx_text" id="S5.SS1.p1.1.1" style="color:#000000;">In our work we consider a low-resource attacker who is capable of hosting a DNSSEC-signed domain with a secure delegation and who can attract a victim to resolve a name in this domain.
Hosting a signed domain with a secure delegation is a straightforward, field-proven administrative process: It can be achieved simply by renting the domain, setting up the delegation as well as an open-source authoritative DNS server, and configuring it with the zone files following the outline in this section.
To attract the victim resolver the attacker can take various approaches, e.g., by embedding image URLs in HTML documents and distributing them via e-mail or ad network, or by sending bogus e-mail to an SMTP server configured to deliver bounce messages [RFC5321].
The specific approach taken is out of scope of this document.
The resources required by the attacker are generally low.
Specifically, the attacker does not require any potent hardware, since the attacks utilize only a limited number of network transactions (the most potent one requiring only a single attack packet).
Fruthermore, the cryptographic material, which the victim resolver will be busy validating, is invalid by design, rendering it computationally trivial to generate.</span></p>
</div>
</section>
<section class="ltx_subsection" id="S5.SS2">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">5.2. </span>DNSSEC Setup</h3>
<div class="ltx_para" id="S5.SS2.p1">
<p class="ltx_p" id="S5.SS2.p1.1">The attack vectors are encoded in a zonefile in the domain controlled by the adversary. For the attack to be effective, the adversary needs to register a domain under a signed parent.</p>
</div>
<div class="ltx_para" id="S5.SS2.p2">
<p class="ltx_p" id="S5.SS2.p2.1"><span class="ltx_text ltx_font_bold" id="S5.SS2.p2.1.1">Zonefile.</span>
The attack vectors are encoded in the zonefiles in Figure <a class="ltx_ref" href="https://arxiv.org/html/2406.03133v1#S5.F1" title="Figure 1 ‣ 5.3. SigJam (One Key x Many Signatures) ‣ 5. Resource Exhaustion Attacks ‣ The Harder You Try, The Harder You Fail: The KeyTrap Denial-of-Service Algorithmic Complexity Attacks on DNSSEC"><span class="ltx_text ltx_ref_tag">1</span></a>. In addition to the DNSSEC records, the zones also feature DNS records.</p>
</div>
<div class="ltx_para" id="S5.SS2.p3">
<p class="ltx_p" id="S5.SS2.p3.1"><span class="ltx_text ltx_font_bold" id="S5.SS2.p3.1.1">Chain of trust.</span> Although there is no explicit requirement in the DNSSEC standard how validation of signed DNS records should proceed, the standard specification suggests that it should be done top down. The validator should construct the chain of trust top down [RFC4033, §3.1], and is required to authenticate the DNSKEY before using it to validate signatures, see [RFC4035, §5.3.1].</p>
</div>
</section>
<section class="ltx_subsection" id="S5.SS3">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">5.3. </span>SigJam (One Key x Many Signatures)</h3>
<div class="ltx_para" id="S5.SS3.p1">
<p class="ltx_p" id="S5.SS3.p1.6">The RFC advises that a resolver should try all signatures until a signature is found that can be validated with the DNSKEY(s). To exploit this recommendation we construct an adversarial zone illustrated in Figure <a class="ltx_ref" href="https://arxiv.org/html/2406.03133v1#S5.F1.sf1" title="In Figure 1 ‣ 5.3. SigJam (One Key x Many Signatures) ‣ 5. Resource Exhaustion Attacks ‣ The Harder You Try, The Harder You Fail: The KeyTrap Denial-of-Service Algorithmic Complexity Attacks on DNSSEC"><span class="ltx_text ltx_ref_tag">1(a)</span></a>. The parent zonefile contains a signed DS record  <svg class="ltx_picture" height="14.86" id="S5.SS3.p1.1.pic1" overflow="visible" version="1.1" width="14.86"><g transform="translate(0,14.86) matrix(1 0 0 -1 0 0) translate(7.43,0) translate(0,7.43)"><g fill="#000000" stroke="#000000" stroke-width="0.6pt"><path d="M 7.01 0 C 7.01 3.87 3.87 7.01 0 7.01 C -3.87 7.01 -7.01 3.87 -7.01 0 C -7.01 -3.87 -3.87 -7.01 0 -7.01 C 3.87 -7.01 7.01 -3.87 7.01 0 Z M 0 0" style="fill:none"></path></g><g fill="#000000" stroke="#000000" stroke-width="0.6pt" transform="matrix(1.0 0.0 0.0 1.0 -3.11 -4.01)"><foreignobject height="8.03" overflow="visible" transform="matrix(1 0 0 -1 0 16.6)" width="6.23"><span class="ltx_text" id="S5.SS3.p1.1.pic1.1.1.1.1.1" style="font-size:90%;">1</span></foreignobject></g></g></svg> that authenticates the KSK (key tag 56012) of the child  <svg class="ltx_picture" height="14.86" id="S5.SS3.p1.2.pic2" overflow="visible" version="1.1" width="14.86"><g transform="translate(0,14.86) matrix(1 0 0 -1 0 0) translate(7.43,0) translate(0,7.43)"><g fill="#000000" stroke="#000000" stroke-width="0.6pt"><path d="M 7.01 0 C 7.01 3.87 3.87 7.01 0 7.01 C -3.87 7.01 -7.01 3.87 -7.01 0 C -7.01 -3.87 -3.87 -7.01 0 -7.01 C 3.87 -7.01 7.01 -3.87 7.01 0 Z M 0 0" style="fill:none"></path></g><g fill="#000000" stroke="#000000" stroke-width="0.6pt" transform="matrix(1.0 0.0 0.0 1.0 -3.11 -4.01)"><foreignobject height="8.03" overflow="visible" transform="matrix(1 0 0 -1 0 16.6)" width="6.23"><span class="ltx_text" id="S5.SS3.p1.2.pic2.1.1.1.1.1" style="font-size:90%;">2</span></foreignobject></g></g></svg>. The zonefile of the child contains a ZSK (key tag 5353)  <svg class="ltx_picture" height="14.86" id="S5.SS3.p1.3.pic3" overflow="visible" version="1.1" width="14.86"><g transform="translate(0,14.86) matrix(1 0 0 -1 0 0) translate(7.43,0) translate(0,7.43)"><g fill="#000000" stroke="#000000" stroke-width="0.6pt"><path d="M 7.01 0 C 7.01 3.87 3.87 7.01 0 7.01 C -3.87 7.01 -7.01 3.87 -7.01 0 C -7.01 -3.87 -3.87 -7.01 0 -7.01 C 3.87 -7.01 7.01 -3.87 7.01 0 Z M 0 0" style="fill:none"></path></g><g fill="#000000" stroke="#000000" stroke-width="0.6pt" transform="matrix(1.0 0.0 0.0 1.0 -3.11 -4.01)"><foreignobject height="8.03" overflow="visible" transform="matrix(1 0 0 -1 0 16.6)" width="6.23"><span class="ltx_text" id="S5.SS3.p1.3.pic3.1.1.1.1.1" style="font-size:90%;">3</span></foreignobject></g></g></svg> signed with the KSK (key tag 56012)  <svg class="ltx_picture" height="14.86" id="S5.SS3.p1.4.pic4" overflow="visible" version="1.1" width="14.86"><g transform="translate(0,14.86) matrix(1 0 0 -1 0 0) translate(7.43,0) translate(0,7.43)"><g fill="#000000" stroke="#000000" stroke-width="0.6pt"><path d="M 7.01 0 C 7.01 3.87 3.87 7.01 0 7.01 C -3.87 7.01 -7.01 3.87 -7.01 0 C -7.01 -3.87 -3.87 -7.01 0 -7.01 C 3.87 -7.01 7.01 -3.87 7.01 0 Z M 0 0" style="fill:none"></path></g><g fill="#000000" stroke="#000000" stroke-width="0.6pt" transform="matrix(1.0 0.0 0.0 1.0 -3.11 -4.01)"><foreignobject height="8.03" overflow="visible" transform="matrix(1 0 0 -1 0 16.6)" width="6.23"><span class="ltx_text" id="S5.SS3.p1.4.pic4.1.1.1.1.1" style="font-size:90%;">4</span></foreignobject></g></g></svg>. Finally the ZSK is used to sign the A record  <svg class="ltx_picture" height="14.86" id="S5.SS3.p1.5.pic5" overflow="visible" version="1.1" width="14.86"><g transform="translate(0,14.86) matrix(1 0 0 -1 0 0) translate(7.43,0) translate(0,7.43)"><g fill="#000000" stroke="#000000" stroke-width="0.6pt"><path d="M 7.01 0 C 7.01 3.87 3.87 7.01 0 7.01 C -3.87 7.01 -7.01 3.87 -7.01 0 C -7.01 -3.87 -3.87 -7.01 0 -7.01 C 3.87 -7.01 7.01 -3.87 7.01 0 Z M 0 0" style="fill:none"></path></g><g fill="#000000" stroke="#000000" stroke-width="0.6pt" transform="matrix(1.0 0.0 0.0 1.0 -3.11 -4.01)"><foreignobject height="8.03" overflow="visible" transform="matrix(1 0 0 -1 0 16.6)" width="6.23"><span class="ltx_text" id="S5.SS3.p1.5.pic5.1.1.1.1.1" style="font-size:90%;">5</span></foreignobject></g></g></svg> with multiple (invalid) signatures all of which refer to the same ZSK DNSKEY record  <svg class="ltx_picture" height="14.86" id="S5.SS3.p1.6.pic6" overflow="visible" version="1.1" width="14.86"><g transform="translate(0,14.86) matrix(1 0 0 -1 0 0) translate(7.43,0) translate(0,7.43)"><g fill="#000000" stroke="#000000" stroke-width="0.6pt"><path d="M 7.01 0 C 7.01 3.87 3.87 7.01 0 7.01 C -3.87 7.01 -7.01 3.87 -7.01 0 C -7.01 -3.87 -3.87 -7.01 0 -7.01 C 3.87 -7.01 7.01 -3.87 7.01 0 Z M 0 0" style="fill:none"></path></g><g fill="#000000" stroke="#000000" stroke-width="0.6pt" transform="matrix(1.0 0.0 0.0 1.0 -3.11 -4.01)"><foreignobject height="8.03" overflow="visible" transform="matrix(1 0 0 -1 0 16.6)" width="6.23"><span class="ltx_text" id="S5.SS3.p1.6.pic6.1.1.1.1.1" style="font-size:90%;">6</span></foreignobject></g></g></svg>.</p>
</div>
<div class="ltx_para" id="S5.SS3.p2">
<p class="ltx_p" id="S5.SS3.p2.1">The RFC-compliant resolver should try all the signatures with the key until one validates or no signature is left to try. Mapping between the key and the signatures is done by matching the triple signer name (attack.er), algorithm (14), and key tag (5353). The resolver only tries the key(s) where this triple matches. However, since none of the three values needs to be unique, collisions can occur, i.e., where multiple signatures fit the same DNSSEC key.
As indicated in the example zone by <span class="ltx_text ltx_font_italic" id="S5.SS3.p2.1.1">[…]</span>, the attacker adds many invalid signatures, all matching the triple of the ZSK.
The resolver tries all the signatures. Since none validates, the resolver concludes that the record cannot be validated and returns a SERVFAIL error to the client, that requested the A record. The SigJam attack is thus constructed by leading the resolver to validate many invalid signatures on an A record using one ZSK.</p>
</div>
<figure class="ltx_figure" id="S5.F1">
<div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_2">
<figure class="ltx_figure ltx_figure_panel ltx_align_center" id="S5.F1.sf1"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_square" height="598" id="S5.F1.sf1.g1" src="extracted/5645199/figures/sigjam_zone.png" width="598"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span class="ltx_text" id="S5.F1.sf1.2.1.1" style="font-size:90%;">(a)</span> </span><span class="ltx_text" id="S5.F1.sf1.3.2" style="font-size:90%;">Zonefile for SigJam attack.</span></figcaption>
</figure>
</div>
<div class="ltx_flex_cell ltx_flex_size_2">
<figure class="ltx_figure ltx_figure_panel ltx_align_center" id="S5.F1.sf2"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_square" height="598" id="S5.F1.sf2.g1" src="extracted/5645199/figures/lockcram_zone.png" width="598"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span class="ltx_text" id="S5.F1.sf2.2.1.1" style="font-size:90%;">(b)</span> </span><span class="ltx_text" id="S5.F1.sf2.3.2" style="font-size:90%;">Zonefile for LockCram attack.</span></figcaption>
</figure>
</div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_2">
<figure class="ltx_figure ltx_figure_panel ltx_align_center" id="S5.F1.sf3"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_square" height="598" id="S5.F1.sf3.g1" src="extracted/5645199/figures/keytrap_zone.png" width="598"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span class="ltx_text" id="S5.F1.sf3.2.1.1" style="font-size:90%;">(c)</span> </span><span class="ltx_text" id="S5.F1.sf3.3.2" style="font-size:90%;">Zonefile for KeySigTrap attack.</span></figcaption>
</figure>
</div>
<div class="ltx_flex_cell ltx_flex_size_2">
<figure class="ltx_figure ltx_figure_panel ltx_align_center" id="S5.F1.sf4"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_square" height="598" id="S5.F1.sf4.g1" src="extracted/5645199/figures/hashtrap_zone.png" width="598"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span class="ltx_text" id="S5.F1.sf4.2.1.1" style="font-size:90%;">(d)</span> </span><span class="ltx_text" id="S5.F1.sf4.3.2" style="font-size:90%;">Zonefile for HashTrap attack.</span></figcaption>
</figure>
</div>
</div>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span class="ltx_text" id="S5.F1.2.1.1" style="font-size:90%;">Figure 1</span>. </span><span class="ltx_text" id="S5.F1.3.2" style="font-size:90%;">Zonefiles of the KeyTrap algorithmic complexity attacks.</span></figcaption>
</figure>
</section>
<section class="ltx_subsection" id="S5.SS4">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">5.4. </span>LockCram (Many Keys x One Signature)</h3>
<div class="ltx_para" id="S5.SS4.p1">
<p class="ltx_p" id="S5.SS4.p1.1">Following the design of SigJam, we develop an attack vector, we dub LockCram, that exploits the fact that resolvers are mandated to try all keys [RFC4035] available for a signature until one validates or all have been tried. The LockCram attack is thus constructed by leading a resolver to validate one signature over a DNS record using many ZSK DNSSEC keys. The zonefile for the LockCram attack is illustrated in Figure <a class="ltx_ref" href="https://arxiv.org/html/2406.03133v1#S5.F1.sf2" title="In Figure 1 ‣ 5.3. SigJam (One Key x Many Signatures) ‣ 5. Resource Exhaustion Attacks ‣ The Harder You Try, The Harder You Fail: The KeyTrap Denial-of-Service Algorithmic Complexity Attacks on DNSSEC"><span class="ltx_text ltx_ref_tag">1(b)</span></a>. Since the zone has multiple similarities to the SigJam zone, in the following we highlight the differences.</p>
</div>
<div class="ltx_para" id="S5.SS4.p2">
<p class="ltx_p" id="S5.SS4.p2.2">The zonefile contains multiple ZSK keys in a key resource set  <svg class="ltx_picture" height="14.86" id="S5.SS4.p2.1.pic1" overflow="visible" version="1.1" width="14.86"><g transform="translate(0,14.86) matrix(1 0 0 -1 0 0) translate(7.43,0) translate(0,7.43)"><g fill="#000000" stroke="#000000" stroke-width="0.6pt"><path d="M 7.01 0 C 7.01 3.87 3.87 7.01 0 7.01 C -3.87 7.01 -7.01 3.87 -7.01 0 C -7.01 -3.87 -3.87 -7.01 0 -7.01 C 3.87 -7.01 7.01 -3.87 7.01 0 Z M 0 0" style="fill:none"></path></g><g fill="#000000" stroke="#000000" stroke-width="0.6pt" transform="matrix(1.0 0.0 0.0 1.0 -3.11 -4.01)"><foreignobject height="8.03" overflow="visible" transform="matrix(1 0 0 -1 0 16.6)" width="6.23"><span class="ltx_text" id="S5.SS4.p2.1.pic1.1.1.1.1.1" style="font-size:90%;">1</span></foreignobject></g></g></svg>, an A record and an (invalid) signature over an A record  <svg class="ltx_picture" height="14.86" id="S5.SS4.p2.2.pic2" overflow="visible" version="1.1" width="14.86"><g transform="translate(0,14.86) matrix(1 0 0 -1 0 0) translate(7.43,0) translate(0,7.43)"><g fill="#000000" stroke="#000000" stroke-width="0.6pt"><path d="M 7.01 0 C 7.01 3.87 3.87 7.01 0 7.01 C -3.87 7.01 -7.01 3.87 -7.01 0 C -7.01 -3.87 -3.87 -7.01 0 -7.01 C 3.87 -7.01 7.01 -3.87 7.01 0 Z M 0 0" style="fill:none"></path></g><g fill="#000000" stroke="#000000" stroke-width="0.6pt" transform="matrix(1.0 0.0 0.0 1.0 -3.11 -4.01)"><foreignobject height="8.03" overflow="visible" transform="matrix(1 0 0 -1 0 16.6)" width="6.23"><span class="ltx_text" id="S5.SS4.p2.2.pic2.1.1.1.1.1" style="font-size:90%;">2</span></foreignobject></g></g></svg>. The keys can be validated by a single KSK of the zone (key tag 56012).
The attacker needs to ensure that all the ZSKs match in signer name, algorithm and key tag. While matching signer name and algorithm is trivial, matching the key tag is not straightforward, as the key tag is not explicitly stated in a key field, but instead calculated over the record data of the key. Further, the attacker cannot simply add the exact same key multiple times, allowing identical key tags, as resolvers de-duplicate identical entries. However, the attacker can brute-force the creation of colliding keys, i.e., keys with identical key tags and differing key bits: The adversary continuously creates new DNSSEC keys with the desired algorithm, calculates the key tag and only stores keys with the desired tag until the target number of colliding keys has been collected. In the example the attacker needs to create many DNSSEC keys with algorithm 14 and the key tag 5353. All of these keys are added to the zone.</p>
</div>
<div class="ltx_para" id="S5.SS4.p3">
<p class="ltx_p" id="S5.SS4.p3.1">A resolver that queries the A record attempts to validate the signature. To do that the resolver identifies all the DNSSEC keys for validating the signature, which in this example are all the ZSKs, as all have a matching triple of signer name (attack.er), algorithm (14), and key tag (5353). An RFC-compliant resolver must try all the keys on the invalid signature until concluding the signature is invalid, leading to multiple validations in the resolver.</p>
</div>
</section>
<section class="ltx_subsection" id="S5.SS5">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">5.5. </span>KeySigTrap (Many Keys x Many Signatures)</h3>
<div class="ltx_para" id="S5.SS5.p1">
<p class="ltx_p" id="S5.SS5.p1.1">The KeySigTrap attack combines the many signatures of SigJam with the many colliding DNSKEYs of LockCram, creating an attack that leads to <span class="ltx_text" id="S5.SS5.p1.1.1" style="color:#000000;">quadratic complexity of validations, while the other two attacks scale linearly with the number of abused records</span>. Figure <a class="ltx_ref" href="https://arxiv.org/html/2406.03133v1#S5.F1.sf3" title="In Figure 1 ‣ 5.3. SigJam (One Key x Many Signatures) ‣ 5. Resource Exhaustion Attacks ‣ The Harder You Try, The Harder You Fail: The KeyTrap Denial-of-Service Algorithmic Complexity Attacks on DNSSEC"><span class="ltx_text ltx_ref_tag">1(c)</span></a> illustrates how the KeySigTrap attack zonefile can be constructed. We highlight the differences to the previous zones.</p>
</div>
<div class="ltx_para" id="S5.SS5.p2">
<p class="ltx_p" id="S5.SS5.p2.2">The construction of the DNSKEY set in the KeySigTrap attack is identical to the set in the LockCram attack. The attacker creates a set of ZSKs in step  <svg class="ltx_picture" height="14.86" id="S5.SS5.p2.1.pic1" overflow="visible" version="1.1" width="14.86"><g transform="translate(0,14.86) matrix(1 0 0 -1 0 0) translate(7.43,0) translate(0,7.43)"><g fill="#000000" stroke="#000000" stroke-width="0.6pt"><path d="M 7.01 0 C 7.01 3.87 3.87 7.01 0 7.01 C -3.87 7.01 -7.01 3.87 -7.01 0 C -7.01 -3.87 -3.87 -7.01 0 -7.01 C 3.87 -7.01 7.01 -3.87 7.01 0 Z M 0 0" style="fill:none"></path></g><g fill="#000000" stroke="#000000" stroke-width="0.6pt" transform="matrix(1.0 0.0 0.0 1.0 -3.11 -4.01)"><foreignobject height="8.03" overflow="visible" transform="matrix(1 0 0 -1 0 16.6)" width="6.23"><span class="ltx_text" id="S5.SS5.p2.1.pic1.1.1.1.1.1" style="font-size:90%;">1</span></foreignobject></g></g></svg>, all with the same key tag (5353). With a large amount of keys, the attacker ensures that each signature validation requires as many validations as there are colliding ZSKs in the zone.
The attacker additionally uses the idea of SigJam to put many signatures with the same key tag into the zone in step  <svg class="ltx_picture" height="14.86" id="S5.SS5.p2.2.pic2" overflow="visible" version="1.1" width="14.86"><g transform="translate(0,14.86) matrix(1 0 0 -1 0 0) translate(7.43,0) translate(0,7.43)"><g fill="#000000" stroke="#000000" stroke-width="0.6pt"><path d="M 7.01 0 C 7.01 3.87 3.87 7.01 0 7.01 C -3.87 7.01 -7.01 3.87 -7.01 0 C -7.01 -3.87 -3.87 -7.01 0 -7.01 C 3.87 -7.01 7.01 -3.87 7.01 0 Z M 0 0" style="fill:none"></path></g><g fill="#000000" stroke="#000000" stroke-width="0.6pt" transform="matrix(1.0 0.0 0.0 1.0 -3.11 -4.01)"><foreignobject height="8.03" overflow="visible" transform="matrix(1 0 0 -1 0 16.6)" width="6.23"><span class="ltx_text" id="S5.SS5.p2.2.pic2.1.1.1.1.1" style="font-size:90%;">2</span></foreignobject></g></g></svg>, which need to be validated to authenticate a DNS record, in this example an A record. This ensures that a resolver querying the A record for <span class="ltx_text ltx_font_italic" id="S5.SS5.p2.2.1">www-X.attack.er</span> must validate a large number of signatures.</p>
</div>
<div class="ltx_para" id="S5.SS5.p3">
<p class="ltx_p" id="S5.SS5.p3.1">The attacker zone therefore contains many signatures over the requested hostname, and each of these signatures refers to many different ZSKs. Following the RFCs, the resolvers <span class="ltx_text ltx_font_sansserif" id="S5.SS5.p3.1.1">SHOULD</span> try all the signatures. For each signature the resolver tries, it <span class="ltx_text ltx_font_sansserif" id="S5.SS5.p3.1.2">MUST</span> try all the matching ZSKs in the zone. In the example zone the resolver thus tries to validate every signature with every ZSK, leading to an immense amount of signature validations, until the resolver concludes that the DNS record could not be authenticated.</p>
</div>
</section>
<section class="ltx_subsection" id="S5.SS6">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">5.6. </span>HashTrap (Many Keys x Many Hashes)</h3>
<div class="ltx_para" id="S5.SS6.p1">
<p class="ltx_p" id="S5.SS6.p1.1"><span class="ltx_text" id="S5.SS6.p1.1.1" style="color:#000000;">While mitigations may be introduced to limit signature validations, it is important to note that complexity attacks can also be achieved through hash computations.</span>
The concept of the attack, we dub HashTrap, is illustrated in the example zone in Figure <a class="ltx_ref" href="https://arxiv.org/html/2406.03133v1#S5.F1.sf4" title="In Figure 1 ‣ 5.3. SigJam (One Key x Many Signatures) ‣ 5. Resource Exhaustion Attacks ‣ The Harder You Try, The Harder You Fail: The KeyTrap Denial-of-Service Algorithmic Complexity Attacks on DNSSEC"><span class="ltx_text ltx_ref_tag">1(d)</span></a>.
In DNSSEC, DS records from a parent zone are used to authenticate individual DNSKEY records in a child zone. This is done to delegate trust from a parent zone public key to a child zone public key. DS records use the same triple (owner name, algorithm, key tag) as RRSIGs do to identify a subset of candidate DNSKEYs. Only by validating that the hash in the DS record matches the digest of the DNSKEY can the resolver determine that a pair of DS and DNSKEY records actually belong together, which is an operation with worst-case <span class="ltx_text" id="S5.SS6.p1.1.2" style="color:#000000;">quadratic increase in validation complexity</span>, similar to the algorithm exploited in <a class="ltx_ref" href="https://arxiv.org/html/2406.03133v1#S5.SS5" title="5.5. KeySigTrap (Many Keys x Many Signatures) ‣ 5. Resource Exhaustion Attacks ‣ The Harder You Try, The Harder You Fail: The KeyTrap Denial-of-Service Algorithmic Complexity Attacks on DNSSEC"><span class="ltx_text ltx_ref_tag">5.5</span></a>. We construct a CPU resource consumption attack, which abuses this DNSSEC protocol inefficiency.
The attacker creates additional child zones of the attacker zone, represented as <span class="ltx_text ltx_font_italic" id="S5.SS6.p1.1.3">sub-x.attack.er</span> in Figure <a class="ltx_ref" href="https://arxiv.org/html/2406.03133v1#S5.F1.sf4" title="In Figure 1 ‣ 5.3. SigJam (One Key x Many Signatures) ‣ 5. Resource Exhaustion Attacks ‣ The Harder You Try, The Harder You Fail: The KeyTrap Denial-of-Service Algorithmic Complexity Attacks on DNSSEC"><span class="ltx_text ltx_ref_tag">1(d)</span></a>.
For each of these sub-zones, in step  <svg class="ltx_picture" height="14.86" id="S5.SS6.p1.1.pic1" overflow="visible" version="1.1" width="14.86"><g transform="translate(0,14.86) matrix(1 0 0 -1 0 0) translate(7.43,0) translate(0,7.43)"><g fill="#000000" stroke="#000000" stroke-width="0.6pt"><path d="M 7.01 0 C 7.01 3.87 3.87 7.01 0 7.01 C -3.87 7.01 -7.01 3.87 -7.01 0 C -7.01 -3.87 -3.87 -7.01 0 -7.01 C 3.87 -7.01 7.01 -3.87 7.01 0 Z M 0 0" style="fill:none"></path></g><g fill="#000000" stroke="#000000" stroke-width="0.6pt" transform="matrix(1.0 0.0 0.0 1.0 -3.11 -4.01)"><foreignobject height="8.03" overflow="visible" transform="matrix(1 0 0 -1 0 16.6)" width="6.23"><span class="ltx_text" id="S5.SS6.p1.1.pic1.1.1.1.1.1" style="font-size:90%;">1</span></foreignobject></g></g></svg> the attacker provides numerous DS records referring to the same key tag (5353), algorithm and signer name of the DNSKEYs in the child. Our attacker utilizes unique digest values to ensure the DS records in the record set are not de-duplicated at the resolver. Since these hashes are purposefully invalid, the attacker can select arbitrary values. The record set containing all the hashes is signed with a single signature by a ZSK of the <span class="ltx_text ltx_font_italic" id="S5.SS6.p1.1.4">attack.er</span> zone.</p>
</div>
<div class="ltx_para" id="S5.SS6.p2">
<p class="ltx_p" id="S5.SS6.p2.3">The resolver needs to authenticate the DNSKEY records before using the keys to validate the signatures [RFC4035].
Before authenticating the signature over the DNSKEY set the resolver first needs to find the DNSKEY that matches a DS record from <span class="ltx_text ltx_font_italic" id="S5.SS6.p2.3.1">attack.er</span>.
This is exploited in the attack. The attacker creates many unique DNSKEYs  <svg class="ltx_picture" height="14.86" id="S5.SS6.p2.1.pic1" overflow="visible" version="1.1" width="14.86"><g transform="translate(0,14.86) matrix(1 0 0 -1 0 0) translate(7.43,0) translate(0,7.43)"><g fill="#000000" stroke="#000000" stroke-width="0.6pt"><path d="M 7.01 0 C 7.01 3.87 3.87 7.01 0 7.01 C -3.87 7.01 -7.01 3.87 -7.01 0 C -7.01 -3.87 -3.87 -7.01 0 -7.01 C 3.87 -7.01 7.01 -3.87 7.01 0 Z M 0 0" style="fill:none"></path></g><g fill="#000000" stroke="#000000" stroke-width="0.6pt" transform="matrix(1.0 0.0 0.0 1.0 -3.11 -4.01)"><foreignobject height="8.03" overflow="visible" transform="matrix(1 0 0 -1 0 16.6)" width="6.23"><span class="ltx_text" id="S5.SS6.p2.1.pic1.1.1.1.1.1" style="font-size:90%;">2</span></foreignobject></g></g></svg>, all with the identical name, algorithm, and key tag (5353).
To find the correct key to validate with a given DS hash in the parent zone, the resolver has to iterate over all colliding keys, calculate the hash and compare it to the hash in the DS record.
This is repeated with all DS hashes in the parent zone and all DNSKEYs in the child zone, which is an operation with worst-case asymptotic complexity in <math alttext="\mathcal{O}(n^{2})" class="ltx_Math" display="inline" id="S5.SS6.p2.2.m1.1"><semantics id="S5.SS6.p2.2.m1.1a"><mrow id="S5.SS6.p2.2.m1.1.1" xref="S5.SS6.p2.2.m1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S5.SS6.p2.2.m1.1.1.3" xref="S5.SS6.p2.2.m1.1.1.3.cmml">𝒪</mi><mo id="S5.SS6.p2.2.m1.1.1.2" xref="S5.SS6.p2.2.m1.1.1.2.cmml">⁢</mo><mrow id="S5.SS6.p2.2.m1.1.1.1.1" xref="S5.SS6.p2.2.m1.1.1.1.1.1.cmml"><mo id="S5.SS6.p2.2.m1.1.1.1.1.2" stretchy="false" xref="S5.SS6.p2.2.m1.1.1.1.1.1.cmml">(</mo><msup id="S5.SS6.p2.2.m1.1.1.1.1.1" xref="S5.SS6.p2.2.m1.1.1.1.1.1.cmml"><mi id="S5.SS6.p2.2.m1.1.1.1.1.1.2" xref="S5.SS6.p2.2.m1.1.1.1.1.1.2.cmml">n</mi><mn id="S5.SS6.p2.2.m1.1.1.1.1.1.3" xref="S5.SS6.p2.2.m1.1.1.1.1.1.3.cmml">2</mn></msup><mo id="S5.SS6.p2.2.m1.1.1.1.1.3" stretchy="false" xref="S5.SS6.p2.2.m1.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S5.SS6.p2.2.m1.1b"><apply id="S5.SS6.p2.2.m1.1.1.cmml" xref="S5.SS6.p2.2.m1.1.1"><times id="S5.SS6.p2.2.m1.1.1.2.cmml" xref="S5.SS6.p2.2.m1.1.1.2"></times><ci id="S5.SS6.p2.2.m1.1.1.3.cmml" xref="S5.SS6.p2.2.m1.1.1.3">𝒪</ci><apply id="S5.SS6.p2.2.m1.1.1.1.1.1.cmml" xref="S5.SS6.p2.2.m1.1.1.1.1"><csymbol cd="ambiguous" id="S5.SS6.p2.2.m1.1.1.1.1.1.1.cmml" xref="S5.SS6.p2.2.m1.1.1.1.1">superscript</csymbol><ci id="S5.SS6.p2.2.m1.1.1.1.1.1.2.cmml" xref="S5.SS6.p2.2.m1.1.1.1.1.1.2">𝑛</ci><cn id="S5.SS6.p2.2.m1.1.1.1.1.1.3.cmml" type="integer" xref="S5.SS6.p2.2.m1.1.1.1.1.1.3">2</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS6.p2.2.m1.1c">\mathcal{O}(n^{2})</annotation><annotation encoding="application/x-llamapun" id="S5.SS6.p2.2.m1.1d">caligraphic_O ( italic_n start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT )</annotation></semantics></math>, leading to a substantial amount of hash calculations that mount severe computational load on the resolver. The resolver can only conclude that none of the DNSKEYs can be used to authenticate the signature  <svg class="ltx_picture" height="14.86" id="S5.SS6.p2.3.pic2" overflow="visible" version="1.1" width="14.86"><g transform="translate(0,14.86) matrix(1 0 0 -1 0 0) translate(7.43,0) translate(0,7.43)"><g fill="#000000" stroke="#000000" stroke-width="0.6pt"><path d="M 7.01 0 C 7.01 3.87 3.87 7.01 0 7.01 C -3.87 7.01 -7.01 3.87 -7.01 0 C -7.01 -3.87 -3.87 -7.01 0 -7.01 C 3.87 -7.01 7.01 -3.87 7.01 0 Z M 0 0" style="fill:none"></path></g><g fill="#000000" stroke="#000000" stroke-width="0.6pt" transform="matrix(1.0 0.0 0.0 1.0 -3.11 -4.01)"><foreignobject height="8.03" overflow="visible" transform="matrix(1 0 0 -1 0 16.6)" width="6.23"><span class="ltx_text" id="S5.SS6.p2.3.pic2.1.1.1.1.1" style="font-size:90%;">3</span></foreignobject></g></g></svg> after all the hashes were calculated.
Our experimental evaluations show that, by means of exploiting of this attack vector, hash computation is sufficiently resource intensive to inflict excessive load on a resolver.</p>
</div>
<div class="ltx_para" id="S5.SS6.p3">
<p class="ltx_p" id="S5.SS6.p3.1">The HashTrap attack is thus constructed by leading the resolver to calculate many hashes for validating many colliding DNSKEYs against many DS hash records. Notice that attack variants, similar to SigJam and LockCram, can also be constructed with the DS hashes instead of signatures. However, hashes are less effective, reducing adversary’s motivation to do that.</p>
</div>
</section>
</section>
<section class="ltx_section" id="S6">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">6. </span>Evaluation of the Attacks</h2>
<div class="ltx_para" id="S6.p1">
<p class="ltx_p" id="S6.p1.1">Through experimental evaluations we found all the major DNS implementations on our dataset to be vulnerable to KeyTrap attacks. The stalling interval caused by the attacks depends on the specific resolver implementation. Our list of DNS software includes recursive DNS resolvers, public resolvers<span class="ltx_note ltx_role_footnote" id="footnote9"><sup class="ltx_note_mark">9</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">9</sup><span class="ltx_tag ltx_tag_note">9</span>Tested against an instance set up by the operator for this purpose</span></span></span>, DNS tooling, and DNS libraries; see details in Table <a class="ltx_ref" href="https://arxiv.org/html/2406.03133v1#S6.T1" title="Table 1 ‣ 6. Evaluation of the Attacks ‣ The Harder You Try, The Harder You Fail: The KeyTrap Denial-of-Service Algorithmic Complexity Attacks on DNSSEC"><span class="ltx_text ltx_ref_tag">1</span></a>.
We consider a resolver vulnerable if we achieve full DoS with traffic ¡10 req/s.
<span class="ltx_text" id="S6.p1.1.1" style="color:#000000;">All evaluations were conducted on an Intel Core i7-8650U quad-core processor with up to 4.2 GHz single core frequency.</span>
We describe the setup, our test methodology, and the cryptographic ciphers we use in our research zonefiles. We then evaluate the effectiveness and the impact of the attacks.
An overview over the different DNS resolver components relevant to the attack is given in Table <a class="ltx_ref" href="https://arxiv.org/html/2406.03133v1#S6.T5" title="Table 5 ‣ 6.5. Effect on Clients ‣ 6. Evaluation of the Attacks ‣ The Harder You Try, The Harder You Fail: The KeyTrap Denial-of-Service Algorithmic Complexity Attacks on DNSSEC"><span class="ltx_text ltx_ref_tag">5</span></a>.
<span class="ltx_text" id="S6.p1.1.2" style="color:#000000;">Note that Knot, unwind, and dnsmasq have tight response buffer size limitations, unintentionally reducing the impact of the attack. In fact, this side effect was recognized as a bug in Knot and fixed in the patched version of the resolver <span class="ltx_note ltx_role_footnote" id="footnote10"><sup class="ltx_note_mark">10</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">10</sup><span class="ltx_tag ltx_tag_note"><span class="ltx_text" id="footnote10.1.1.1" style="color:#000000;">10</span></span><span class="ltx_text" id="footnote10.5" style="color:#000000;">https://github.com/CZ-NIC/knot-resolver/commit/</span>
<br class="ltx_break"/><span class="ltx_text" id="footnote10.6" style="color:#000000;">0b8012c2d68b7d59a55a0dca1d3f0c3042016ae9</span></span></span></span>.</span></p>
</div>
<figure class="ltx_table" id="S6.T1">
<table class="ltx_tabular ltx_centering ltx_align_middle" id="S6.T1.2">
<tr class="ltx_tr" id="S6.T1.2.1">
<td class="ltx_td ltx_border_l ltx_border_r ltx_border_t" id="S6.T1.2.1.1" style="padding-top:-1.05pt;padding-bottom:-1.05pt;"></td>
<td class="ltx_td ltx_align_left ltx_border_r ltx_border_t" id="S6.T1.2.1.2" style="padding-top:-1.05pt;padding-bottom:-1.05pt;"><span class="ltx_text ltx_font_bold" id="S6.T1.2.1.2.1" style="font-size:70%;">Name</span></td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S6.T1.2.1.3" style="padding-top:-1.05pt;padding-bottom:-1.05pt;"><span class="ltx_text ltx_font_bold" id="S6.T1.2.1.3.1" style="font-size:70%;">Vuln.</span></td>
<td class="ltx_td ltx_align_justify ltx_align_top ltx_border_r ltx_border_t" id="S6.T1.2.1.4" style="padding-top:-1.05pt;padding-bottom:-1.05pt;">
<span class="ltx_inline-block ltx_align_top" id="S6.T1.2.1.4.1">
<span class="ltx_p" id="S6.T1.2.1.4.1.1" style="width:85.4pt;"><span class="ltx_text ltx_font_bold" id="S6.T1.2.1.4.1.1.1" style="font-size:70%;">Comment</span></span>
</span>
</td>
</tr>
<tr class="ltx_tr" id="S6.T1.2.2">
<td class="ltx_td ltx_align_right ltx_border_l ltx_border_r ltx_border_t" id="S6.T1.2.2.1" rowspan="11" style="padding-top:-1.05pt;padding-bottom:-1.05pt;"><span class="ltx_text" id="S6.T1.2.2.1.1" style="font-size:70%;">
<span class="ltx_inline-block ltx_transformed_outer" id="S6.T1.2.2.1.1.1" style="width:4.9pt;height:57pt;vertical-align:-26.1pt;"><span class="ltx_transformed_inner" style="width:57.0pt;transform:translate(-26.08pt,0pt) rotate(-90deg) ;">
<span class="ltx_p" id="S6.T1.2.2.1.1.1.1"><span class="ltx_text ltx_font_bold" id="S6.T1.2.2.1.1.1.1.1">Server Software</span></span>
</span></span></span></td>
<td class="ltx_td ltx_align_left ltx_border_r ltx_border_t" id="S6.T1.2.2.2" style="padding-top:-1.05pt;padding-bottom:-1.05pt;"><span class="ltx_text" id="S6.T1.2.2.2.1" style="font-size:70%;">Akamai CacheServe</span></td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S6.T1.2.2.3" style="padding-top:-1.05pt;padding-bottom:-1.05pt;"><span class="ltx_text" id="S6.T1.2.2.3.1" style="font-size:70%;">●</span></td>
<td class="ltx_td ltx_align_justify ltx_align_top ltx_border_r ltx_border_t" id="S6.T1.2.2.4" style="padding-top:-1.05pt;padding-bottom:-1.05pt;">
<span class="ltx_inline-block ltx_align_top" id="S6.T1.2.2.4.1">
<span class="ltx_p" id="S6.T1.2.2.4.1.1" style="width:85.4pt;"><span class="ltx_text" id="S6.T1.2.2.4.1.1.1" style="font-size:70%;">DoS 186s</span></span>
</span>
</td>
</tr>
<tr class="ltx_tr" id="S6.T1.2.3">
<td class="ltx_td ltx_align_left ltx_border_r" id="S6.T1.2.3.1" style="padding-top:-1.05pt;padding-bottom:-1.05pt;"><span class="ltx_text" id="S6.T1.2.3.1.1" style="font-size:70%;">BIND9</span></td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S6.T1.2.3.2" style="padding-top:-1.05pt;padding-bottom:-1.05pt;"><span class="ltx_text" id="S6.T1.2.3.2.1" style="font-size:70%;">●</span></td>
<td class="ltx_td ltx_align_justify ltx_align_top ltx_border_r" id="S6.T1.2.3.3" style="padding-top:-1.05pt;padding-bottom:-1.05pt;">
<span class="ltx_inline-block ltx_align_top" id="S6.T1.2.3.3.1">
<span class="ltx_p" id="S6.T1.2.3.3.1.1" style="width:85.4pt;"><span class="ltx_text" id="S6.T1.2.3.3.1.1.1" style="font-size:70%;">DoS 58632s</span></span>
</span>
</td>
</tr>
<tr class="ltx_tr" id="S6.T1.2.4">
<td class="ltx_td ltx_align_left ltx_border_r" id="S6.T1.2.4.1" style="padding-top:-1.05pt;padding-bottom:-1.05pt;"><span class="ltx_text" id="S6.T1.2.4.1.1" style="font-size:70%;">Knot Resolver</span></td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S6.T1.2.4.2" style="padding-top:-1.05pt;padding-bottom:-1.05pt;"><span class="ltx_text" id="S6.T1.2.4.2.1" style="font-size:70%;">●</span></td>
<td class="ltx_td ltx_align_justify ltx_align_top ltx_border_r" id="S6.T1.2.4.3" style="padding-top:-1.05pt;padding-bottom:-1.05pt;">
<span class="ltx_inline-block ltx_align_top" id="S6.T1.2.4.3.1">
<span class="ltx_p" id="S6.T1.2.4.3.1.1" style="width:85.4pt;"><span class="ltx_text" id="S6.T1.2.4.3.1.1.1" style="font-size:70%;">DoS 51s (Limited DNS key buffer size)</span></span>
</span>
</td>
</tr>
<tr class="ltx_tr" id="S6.T1.2.5">
<td class="ltx_td ltx_align_left ltx_border_r" id="S6.T1.2.5.1" style="padding-top:-1.05pt;padding-bottom:-1.05pt;"><span class="ltx_text" id="S6.T1.2.5.1.1" style="font-size:70%;">PowerDNS Recursor</span></td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S6.T1.2.5.2" style="padding-top:-1.05pt;padding-bottom:-1.05pt;"><span class="ltx_text" id="S6.T1.2.5.2.1" style="font-size:70%;">●</span></td>
<td class="ltx_td ltx_align_justify ltx_align_top ltx_border_r" id="S6.T1.2.5.3" style="padding-top:-1.05pt;padding-bottom:-1.05pt;">
<span class="ltx_inline-block ltx_align_top" id="S6.T1.2.5.3.1">
<span class="ltx_p" id="S6.T1.2.5.3.1.1" style="width:85.4pt;"><span class="ltx_text" id="S6.T1.2.5.3.1.1.1" style="font-size:70%;">DoS 177s</span></span>
</span>
</td>
</tr>
<tr class="ltx_tr" id="S6.T1.2.6">
<td class="ltx_td ltx_align_left ltx_border_r" id="S6.T1.2.6.1" style="padding-top:-1.05pt;padding-bottom:-1.05pt;"><span class="ltx_text" id="S6.T1.2.6.1.1" style="font-size:70%;">Unbound</span></td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S6.T1.2.6.2" style="padding-top:-1.05pt;padding-bottom:-1.05pt;"><span class="ltx_text" id="S6.T1.2.6.2.1" style="font-size:70%;">●</span></td>
<td class="ltx_td ltx_align_justify ltx_align_top ltx_border_r" id="S6.T1.2.6.3" style="padding-top:-1.05pt;padding-bottom:-1.05pt;">
<span class="ltx_inline-block ltx_align_top" id="S6.T1.2.6.3.1">
<span class="ltx_p" id="S6.T1.2.6.3.1.1" style="width:85.4pt;"><span class="ltx_text" id="S6.T1.2.6.3.1.1.1" style="font-size:70%;">DoS 1014s (Retries increase duration)</span></span>
</span>
</td>
</tr>
<tr class="ltx_tr" id="S6.T1.2.7">
<td class="ltx_td ltx_align_left ltx_border_r" id="S6.T1.2.7.1" style="padding-top:-1.05pt;padding-bottom:-1.05pt;"><span class="ltx_text" id="S6.T1.2.7.1.1" style="font-size:70%;">Windows Server 2022</span></td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S6.T1.2.7.2" style="padding-top:-1.05pt;padding-bottom:-1.05pt;"><span class="ltx_text" id="S6.T1.2.7.2.1" style="font-size:70%;">●</span></td>
<td class="ltx_td ltx_align_justify ltx_align_top ltx_border_r" id="S6.T1.2.7.3" style="padding-top:-1.05pt;padding-bottom:-1.05pt;">
<span class="ltx_inline-block ltx_align_top" id="S6.T1.2.7.3.1">
<span class="ltx_p" id="S6.T1.2.7.3.1.1" style="width:85.4pt;"><span class="ltx_text" id="S6.T1.2.7.3.1.1.1" style="font-size:70%;">DoS 131s</span></span>
</span>
</td>
</tr>
<tr class="ltx_tr" id="S6.T1.2.8">
<td class="ltx_td ltx_align_left ltx_border_r" id="S6.T1.2.8.1" style="padding-top:-1.05pt;padding-bottom:-1.05pt;"><span class="ltx_text" id="S6.T1.2.8.1.1" style="font-size:70%;">Windows Server 2019</span></td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S6.T1.2.8.2" style="padding-top:-1.05pt;padding-bottom:-1.05pt;"><span class="ltx_text" id="S6.T1.2.8.2.1" style="font-size:70%;">●</span></td>
<td class="ltx_td ltx_align_justify ltx_align_top ltx_border_r" id="S6.T1.2.8.3" style="padding-top:-1.05pt;padding-bottom:-1.05pt;">
<span class="ltx_inline-block ltx_align_top" id="S6.T1.2.8.3.1">
<span class="ltx_p" id="S6.T1.2.8.3.1.1" style="width:85.4pt;"><span class="ltx_text" id="S6.T1.2.8.3.1.1.1" style="font-size:70%;">DoS 134s</span></span>
</span>
</td>
</tr>
<tr class="ltx_tr" id="S6.T1.2.9">
<td class="ltx_td ltx_align_left ltx_border_r" id="S6.T1.2.9.1" style="padding-top:-1.05pt;padding-bottom:-1.05pt;"><span class="ltx_text" id="S6.T1.2.9.1.1" style="font-size:70%;">unwind (from OpenBSD7.3)</span></td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S6.T1.2.9.2" style="padding-top:-1.05pt;padding-bottom:-1.05pt;"><span class="ltx_text" id="S6.T1.2.9.2.1" style="font-size:70%;">●</span></td>
<td class="ltx_td ltx_align_justify ltx_align_top ltx_border_r" id="S6.T1.2.9.3" style="padding-top:-1.05pt;padding-bottom:-1.05pt;">
<span class="ltx_inline-block ltx_align_top" id="S6.T1.2.9.3.1">
<span class="ltx_p" id="S6.T1.2.9.3.1.1" style="width:85.4pt;"><span class="ltx_text" id="S6.T1.2.9.3.1.1.1" style="font-size:70%;">DoS 29s (Limited msg-buffer size)</span></span>
</span>
</td>
</tr>
<tr class="ltx_tr" id="S6.T1.2.10">
<td class="ltx_td ltx_align_left ltx_border_r" id="S6.T1.2.10.1" style="padding-top:-1.05pt;padding-bottom:-1.05pt;"><span class="ltx_text" id="S6.T1.2.10.1.1" style="font-size:70%;">Technitium</span></td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S6.T1.2.10.2" style="padding-top:-1.05pt;padding-bottom:-1.05pt;"><span class="ltx_text" id="S6.T1.2.10.2.1" style="font-size:70%;">●</span></td>
<td class="ltx_td ltx_align_justify ltx_align_top ltx_border_r" id="S6.T1.2.10.3" style="padding-top:-1.05pt;padding-bottom:-1.05pt;">
<span class="ltx_inline-block ltx_align_top" id="S6.T1.2.10.3.1">
<span class="ltx_p" id="S6.T1.2.10.3.1.1" style="width:85.4pt;"><span class="ltx_text" id="S6.T1.2.10.3.1.1.1" style="font-size:70%;">DoS 411s</span></span>
</span>
</td>
</tr>
<tr class="ltx_tr" id="S6.T1.2.11">
<td class="ltx_td ltx_align_left ltx_border_r" id="S6.T1.2.11.1" style="padding-top:-1.05pt;padding-bottom:-1.05pt;"><span class="ltx_text" id="S6.T1.2.11.1.1" style="font-size:70%;">dnsmasq 2.80</span></td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S6.T1.2.11.2" style="padding-top:-1.05pt;padding-bottom:-1.05pt;"><span class="ltx_text" id="S6.T1.2.11.2.1" style="font-size:70%;">●</span></td>
<td class="ltx_td ltx_align_justify ltx_align_top ltx_border_r" id="S6.T1.2.11.3" style="padding-top:-1.05pt;padding-bottom:-1.05pt;">
<span class="ltx_inline-block ltx_align_top" id="S6.T1.2.11.3.1">
<span class="ltx_p" id="S6.T1.2.11.3.1.1" style="width:85.4pt;"><span class="ltx_text" id="S6.T1.2.11.3.1.1.1" style="font-size:70%;">DoS 2s (Limited msg-buffer size)</span></span>
</span>
</td>
</tr>
<tr class="ltx_tr" id="S6.T1.2.12">
<td class="ltx_td ltx_align_left ltx_border_r" id="S6.T1.2.12.1" style="padding-top:-1.05pt;padding-bottom:-1.05pt;"><span class="ltx_text" id="S6.T1.2.12.1.1" style="font-size:70%;">stubby 0.4.3</span></td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S6.T1.2.12.2" style="padding-top:-1.05pt;padding-bottom:-1.05pt;"><span class="ltx_text" id="S6.T1.2.12.2.1" style="font-size:70%;">●</span></td>
<td class="ltx_td ltx_align_justify ltx_align_top ltx_border_r" id="S6.T1.2.12.3" style="padding-top:-1.05pt;padding-bottom:-1.05pt;">
<span class="ltx_inline-block ltx_align_top" id="S6.T1.2.12.3.1">
<span class="ltx_p" id="S6.T1.2.12.3.1.1" style="width:85.4pt;"><span class="ltx_text" id="S6.T1.2.12.3.1.1.1" style="font-size:70%;">DoS 184s</span></span>
</span>
</td>
</tr>
<tr class="ltx_tr" id="S6.T1.2.13">
<td class="ltx_td ltx_align_right ltx_border_l ltx_border_r ltx_border_t" id="S6.T1.2.13.1" rowspan="4" style="padding-top:-1.05pt;padding-bottom:-1.05pt;"><span class="ltx_text" id="S6.T1.2.13.1.1" style="font-size:70%;">
<span class="ltx_inline-block ltx_transformed_outer" id="S6.T1.2.13.1.1.1" style="width:4.8pt;height:31pt;vertical-align:-13.1pt;"><span class="ltx_transformed_inner" style="width:30.9pt;transform:translate(-13.07pt,0pt) rotate(-90deg) ;">
<span class="ltx_p" id="S6.T1.2.13.1.1.1.1"><span class="ltx_text ltx_font_bold" id="S6.T1.2.13.1.1.1.1.1">Service</span></span>
</span></span></span></td>
<td class="ltx_td ltx_align_left ltx_border_r ltx_border_t" id="S6.T1.2.13.2" style="padding-top:-1.05pt;padding-bottom:-1.05pt;"><span class="ltx_text" id="S6.T1.2.13.2.1" style="font-size:70%;">Cloudflare</span></td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S6.T1.2.13.3" style="padding-top:-1.05pt;padding-bottom:-1.05pt;"><span class="ltx_text" id="S6.T1.2.13.3.1" style="font-size:70%;">●</span></td>
<td class="ltx_td ltx_align_justify ltx_align_top ltx_border_r ltx_border_t" id="S6.T1.2.13.4" style="padding-top:-1.05pt;padding-bottom:-1.05pt;">
<span class="ltx_inline-block ltx_align_top" id="S6.T1.2.13.4.1">
<span class="ltx_p" id="S6.T1.2.13.4.1.1" style="width:85.4pt;"><span class="ltx_text" id="S6.T1.2.13.4.1.1.1" style="font-size:70%;">Confirmed by Developers</span></span>
</span>
</td>
</tr>
<tr class="ltx_tr" id="S6.T1.2.14">
<td class="ltx_td ltx_align_left ltx_border_r" id="S6.T1.2.14.1" style="padding-top:-1.05pt;padding-bottom:-1.05pt;"><span class="ltx_text" id="S6.T1.2.14.1.1" style="font-size:70%;">Google</span></td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S6.T1.2.14.2" style="padding-top:-1.05pt;padding-bottom:-1.05pt;"><span class="ltx_text" id="S6.T1.2.14.2.1" style="font-size:70%;">●</span></td>
<td class="ltx_td ltx_align_justify ltx_align_top ltx_border_r" id="S6.T1.2.14.3" style="padding-top:-1.05pt;padding-bottom:-1.05pt;">
<span class="ltx_inline-block ltx_align_top" id="S6.T1.2.14.3.1">
<span class="ltx_p" id="S6.T1.2.14.3.1.1" style="width:85.4pt;"><span class="ltx_text" id="S6.T1.2.14.3.1.1.1" style="font-size:70%;">Confirmed by Developers</span></span>
</span>
</td>
</tr>
<tr class="ltx_tr" id="S6.T1.2.15">
<td class="ltx_td ltx_align_left ltx_border_r" id="S6.T1.2.15.1" style="padding-top:-1.05pt;padding-bottom:-1.05pt;"><span class="ltx_text" id="S6.T1.2.15.1.1" style="font-size:70%;">OpenDNS</span></td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S6.T1.2.15.2" style="padding-top:-1.05pt;padding-bottom:-1.05pt;"><span class="ltx_text" id="S6.T1.2.15.2.1" style="font-size:70%;">●</span></td>
<td class="ltx_td ltx_align_justify ltx_align_top ltx_border_r" id="S6.T1.2.15.3" style="padding-top:-1.05pt;padding-bottom:-1.05pt;">
<span class="ltx_inline-block ltx_align_top" id="S6.T1.2.15.3.1">
<span class="ltx_p" id="S6.T1.2.15.3.1.1" style="width:85.4pt;"><span class="ltx_text" id="S6.T1.2.15.3.1.1.1" style="font-size:70%;">Confirmed by Developers</span></span>
</span>
</td>
</tr>
<tr class="ltx_tr" id="S6.T1.2.16">
<td class="ltx_td ltx_align_left ltx_border_r" id="S6.T1.2.16.1" style="padding-top:-1.05pt;padding-bottom:-1.05pt;"><span class="ltx_text" id="S6.T1.2.16.1.1" style="font-size:70%;">Quad9</span></td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S6.T1.2.16.2" style="padding-top:-1.05pt;padding-bottom:-1.05pt;"><span class="ltx_text" id="S6.T1.2.16.2.1" style="font-size:70%;">●</span></td>
<td class="ltx_td ltx_align_justify ltx_align_top ltx_border_r" id="S6.T1.2.16.3" style="padding-top:-1.05pt;padding-bottom:-1.05pt;">
<span class="ltx_inline-block ltx_align_top" id="S6.T1.2.16.3.1">
<span class="ltx_p" id="S6.T1.2.16.3.1.1" style="width:85.4pt;"><span class="ltx_text" id="S6.T1.2.16.3.1.1.1" style="font-size:70%;">Confirmed by Developers</span></span>
</span>
</td>
</tr>
<tr class="ltx_tr" id="S6.T1.2.17">
<td class="ltx_td ltx_align_right ltx_border_l ltx_border_r ltx_border_t" id="S6.T1.2.17.1" rowspan="7" style="padding-top:-1.05pt;padding-bottom:-1.05pt;"><span class="ltx_text" id="S6.T1.2.17.1.1" style="font-size:70%;">
<span class="ltx_inline-block ltx_transformed_outer" id="S6.T1.2.17.1.1.1" style="width:4.9pt;height:22.9pt;vertical-align:-9.0pt;"><span class="ltx_transformed_inner" style="width:22.9pt;transform:translate(-9.04pt,0pt) rotate(-90deg) ;">
<span class="ltx_p" id="S6.T1.2.17.1.1.1.1"><span class="ltx_text ltx_font_bold" id="S6.T1.2.17.1.1.1.1.1">Tool</span></span>
</span></span></span></td>
<td class="ltx_td ltx_align_left ltx_border_r ltx_border_t" id="S6.T1.2.17.2" style="padding-top:-1.05pt;padding-bottom:-1.05pt;"><span class="ltx_text" id="S6.T1.2.17.2.1" style="font-size:70%;">dig 9.16.1</span></td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S6.T1.2.17.3" style="padding-top:-1.05pt;padding-bottom:-1.05pt;"><span class="ltx_text" id="S6.T1.2.17.3.1" style="font-size:70%;">○</span></td>
<td class="ltx_td ltx_align_justify ltx_align_top ltx_border_r ltx_border_t" id="S6.T1.2.17.4" style="padding-top:-1.05pt;padding-bottom:-1.05pt;">
<span class="ltx_inline-block ltx_align_top" id="S6.T1.2.17.4.1">
<span class="ltx_p" id="S6.T1.2.17.4.1.1" style="width:85.4pt;"><span class="ltx_text" id="S6.T1.2.17.4.1.1.1" style="font-size:70%;">No DNSSEC validation</span></span>
</span>
</td>
</tr>
<tr class="ltx_tr" id="S6.T1.2.18">
<td class="ltx_td ltx_align_left ltx_border_r" id="S6.T1.2.18.1" style="padding-top:-1.05pt;padding-bottom:-1.05pt;"><span class="ltx_text" id="S6.T1.2.18.1.1" style="font-size:70%;">kdig 2.7.8</span></td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S6.T1.2.18.2" style="padding-top:-1.05pt;padding-bottom:-1.05pt;"><span class="ltx_text" id="S6.T1.2.18.2.1" style="font-size:70%;">○</span></td>
<td class="ltx_td ltx_align_justify ltx_align_top ltx_border_r" id="S6.T1.2.18.3" style="padding-top:-1.05pt;padding-bottom:-1.05pt;">
<span class="ltx_inline-block ltx_align_top" id="S6.T1.2.18.3.1">
<span class="ltx_p" id="S6.T1.2.18.3.1.1" style="width:85.4pt;"><span class="ltx_text" id="S6.T1.2.18.3.1.1.1" style="font-size:70%;">No DNSSEC validation</span></span>
</span>
</td>
</tr>
<tr class="ltx_tr" id="S6.T1.2.19">
<td class="ltx_td ltx_align_left ltx_border_r" id="S6.T1.2.19.1" style="padding-top:-1.05pt;padding-bottom:-1.05pt;"><span class="ltx_text" id="S6.T1.2.19.1.1" style="font-size:70%;">delv 9.16.1</span></td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S6.T1.2.19.2" style="padding-top:-1.05pt;padding-bottom:-1.05pt;"><span class="ltx_text" id="S6.T1.2.19.2.1" style="font-size:70%;">●</span></td>
<td class="ltx_td ltx_align_justify ltx_align_top ltx_border_r" id="S6.T1.2.19.3" style="padding-top:-1.05pt;padding-bottom:-1.05pt;">
<span class="ltx_inline-block ltx_align_top" id="S6.T1.2.19.3.1">
<span class="ltx_p" id="S6.T1.2.19.3.1.1" style="width:85.4pt;"><span class="ltx_text" id="S6.T1.2.19.3.1.1.1" style="font-size:70%;">Validation logic from Bind9</span></span>
</span>
</td>
</tr>
<tr class="ltx_tr" id="S6.T1.2.20">
<td class="ltx_td ltx_align_left ltx_border_r" id="S6.T1.2.20.1" style="padding-top:-1.05pt;padding-bottom:-1.05pt;"><span class="ltx_text" id="S6.T1.2.20.1.1" style="font-size:70%;">DNSViz 0.9.4 (latest)</span></td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S6.T1.2.20.2" style="padding-top:-1.05pt;padding-bottom:-1.05pt;"><span class="ltx_text" id="S6.T1.2.20.2.1" style="font-size:70%;">●</span></td>
<td class="ltx_td ltx_align_justify ltx_align_top ltx_border_r" id="S6.T1.2.20.3" style="padding-top:-1.05pt;padding-bottom:-1.05pt;">
<span class="ltx_inline-block ltx_align_top" id="S6.T1.2.20.3.1">
<span class="ltx_p" id="S6.T1.2.20.3.1.1" style="width:85.4pt;"><span class="ltx_text" id="S6.T1.2.20.3.1.1.1" style="font-size:70%;">Crashes with exception after attack</span></span>
</span>
</td>
</tr>
<tr class="ltx_tr" id="S6.T1.2.21">
<td class="ltx_td ltx_align_left ltx_border_r" id="S6.T1.2.21.1" style="padding-top:-1.05pt;padding-bottom:-1.05pt;"><span class="ltx_text" id="S6.T1.2.21.1.1" style="font-size:70%;">ldns-verify-zone</span></td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S6.T1.2.21.2" style="padding-top:-1.05pt;padding-bottom:-1.05pt;"><span class="ltx_text" id="S6.T1.2.21.2.1" style="font-size:70%;">●</span></td>
<td class="ltx_td ltx_align_justify ltx_align_top ltx_border_r" id="S6.T1.2.21.3" style="padding-top:-1.05pt;padding-bottom:-1.05pt;">
<span class="ltx_inline-block ltx_align_top" id="S6.T1.2.21.3.1">
<span class="ltx_p" id="S6.T1.2.21.3.1.1" style="width:85.4pt;"><span class="ltx_text" id="S6.T1.2.21.3.1.1.1" style="font-size:70%;">uses vulnerable ldns library</span></span>
</span>
</td>
</tr>
<tr class="ltx_tr" id="S6.T1.2.22">
<td class="ltx_td ltx_align_left ltx_border_r" id="S6.T1.2.22.1" style="padding-top:-1.05pt;padding-bottom:-1.05pt;"><span class="ltx_text" id="S6.T1.2.22.1.1" style="font-size:70%;">kzonechek</span></td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S6.T1.2.22.2" style="padding-top:-1.05pt;padding-bottom:-1.05pt;"><span class="ltx_text" id="S6.T1.2.22.2.1" style="font-size:70%;">●</span></td>
<td class="ltx_td ltx_align_justify ltx_align_top ltx_border_r" id="S6.T1.2.22.3" style="padding-top:-1.05pt;padding-bottom:-1.05pt;">
<span class="ltx_inline-block ltx_align_top" id="S6.T1.2.22.3.1">
<span class="ltx_p" id="S6.T1.2.22.3.1.1" style="width:85.4pt;"><span class="ltx_text" id="S6.T1.2.22.3.1.1.1" style="font-size:70%;">shipped with Knot DNS authoritative server</span></span>
</span>
</td>
</tr>
<tr class="ltx_tr" id="S6.T1.2.23">
<td class="ltx_td ltx_align_left ltx_border_r" id="S6.T1.2.23.1" style="padding-top:-1.05pt;padding-bottom:-1.05pt;"><span class="ltx_text" id="S6.T1.2.23.1.1" style="font-size:70%;">named-checkzone</span></td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S6.T1.2.23.2" style="padding-top:-1.05pt;padding-bottom:-1.05pt;"><span class="ltx_text" id="S6.T1.2.23.2.1" style="font-size:70%;">○</span></td>
<td class="ltx_td ltx_align_justify ltx_align_top ltx_border_r" id="S6.T1.2.23.3" style="padding-top:-1.05pt;padding-bottom:-1.05pt;">
<span class="ltx_inline-block ltx_align_top" id="S6.T1.2.23.3.1">
<span class="ltx_p" id="S6.T1.2.23.3.1.1" style="width:85.4pt;"><span class="ltx_text" id="S6.T1.2.23.3.1.1.1" style="font-size:70%;">does not validate signatures</span></span>
</span>
</td>
</tr>
<tr class="ltx_tr" id="S6.T1.2.24">
<td class="ltx_td ltx_align_right ltx_border_b ltx_border_l ltx_border_r ltx_border_t" id="S6.T1.2.24.1" rowspan="4" style="padding-top:-1.05pt;padding-bottom:-1.05pt;"><span class="ltx_text" id="S6.T1.2.24.1.1" style="font-size:70%;">
<span class="ltx_inline-block ltx_transformed_outer" id="S6.T1.2.24.1.1.1" style="width:4.9pt;height:22.3pt;vertical-align:-8.7pt;"><span class="ltx_transformed_inner" style="width:22.3pt;transform:translate(-8.72pt,0pt) rotate(-90deg) ;">
<span class="ltx_p" id="S6.T1.2.24.1.1.1.1"><span class="ltx_text ltx_font_bold" id="S6.T1.2.24.1.1.1.1.1">Libs</span></span>
</span></span></span></td>
<td class="ltx_td ltx_align_left ltx_border_r ltx_border_t" id="S6.T1.2.24.2" style="padding-top:-1.05pt;padding-bottom:-1.05pt;"><span class="ltx_text" id="S6.T1.2.24.2.1" style="font-size:70%;">dnspython</span></td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S6.T1.2.24.3" style="padding-top:-1.05pt;padding-bottom:-1.05pt;"><span class="ltx_text" id="S6.T1.2.24.3.1" style="font-size:70%;">●</span></td>
<td class="ltx_td ltx_align_justify ltx_align_top ltx_border_r ltx_border_t" id="S6.T1.2.24.4" style="padding-top:-1.05pt;padding-bottom:-1.05pt;">
<span class="ltx_inline-block ltx_align_top" id="S6.T1.2.24.4.1">
<span class="ltx_p" id="S6.T1.2.24.4.1.1" style="width:85.4pt;"><span class="ltx_text" id="S6.T1.2.24.4.1.1.1" style="font-size:70%;">-</span></span>
</span>
</td>
</tr>
<tr class="ltx_tr" id="S6.T1.2.25">
<td class="ltx_td ltx_align_left ltx_border_r" id="S6.T1.2.25.1" style="padding-top:-1.05pt;padding-bottom:-1.05pt;"><span class="ltx_text" id="S6.T1.2.25.1.1" style="font-size:70%;">getdns</span></td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S6.T1.2.25.2" style="padding-top:-1.05pt;padding-bottom:-1.05pt;"><span class="ltx_text" id="S6.T1.2.25.2.1" style="font-size:70%;">●</span></td>
<td class="ltx_td ltx_align_justify ltx_align_top ltx_border_r" id="S6.T1.2.25.3" style="padding-top:-1.05pt;padding-bottom:-1.05pt;">
<span class="ltx_inline-block ltx_align_top" id="S6.T1.2.25.3.1">
<span class="ltx_p" id="S6.T1.2.25.3.1.1" style="width:85.4pt;"><span class="ltx_text" id="S6.T1.2.25.3.1.1.1" style="font-size:70%;">used by stubby</span></span>
</span>
</td>
</tr>
<tr class="ltx_tr" id="S6.T1.2.26">
<td class="ltx_td ltx_align_left ltx_border_r" id="S6.T1.2.26.1" style="padding-top:-1.05pt;padding-bottom:-1.05pt;"><span class="ltx_text" id="S6.T1.2.26.1.1" style="font-size:70%;">ldns</span></td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S6.T1.2.26.2" style="padding-top:-1.05pt;padding-bottom:-1.05pt;"><span class="ltx_text" id="S6.T1.2.26.2.1" style="font-size:70%;">●</span></td>
<td class="ltx_td ltx_align_justify ltx_align_top ltx_border_r" id="S6.T1.2.26.3" style="padding-top:-1.05pt;padding-bottom:-1.05pt;">
<span class="ltx_inline-block ltx_align_top" id="S6.T1.2.26.3.1">
<span class="ltx_p" id="S6.T1.2.26.3.1.1" style="width:85.4pt;"><span class="ltx_text" id="S6.T1.2.26.3.1.1.1" style="font-size:70%;">-</span></span>
</span>
</td>
</tr>
<tr class="ltx_tr" id="S6.T1.2.27">
<td class="ltx_td ltx_align_left ltx_border_b ltx_border_r" id="S6.T1.2.27.1" style="padding-top:-1.05pt;padding-bottom:-1.05pt;"><span class="ltx_text" id="S6.T1.2.27.1.1" style="font-size:70%;">libunbound</span></td>
<td class="ltx_td ltx_align_center ltx_border_b ltx_border_r" id="S6.T1.2.27.2" style="padding-top:-1.05pt;padding-bottom:-1.05pt;"><span class="ltx_text" id="S6.T1.2.27.2.1" style="font-size:70%;">●</span></td>
<td class="ltx_td ltx_align_justify ltx_align_top ltx_border_b ltx_border_r" id="S6.T1.2.27.3" style="padding-top:-1.05pt;padding-bottom:-1.05pt;">
<span class="ltx_inline-block ltx_align_top" id="S6.T1.2.27.3.1">
<span class="ltx_p" id="S6.T1.2.27.3.1.1" style="width:85.4pt;"><span class="ltx_text" id="S6.T1.2.27.3.1.1.1" style="font-size:70%;">used by Unbound</span></span>
</span>
</td>
</tr>
</table>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table"><span class="ltx_text" id="S6.T1.3.1.1" style="font-size:90%;">Table 1</span>. </span><span class="ltx_text" id="S6.T1.4.2" style="font-size:90%;">Vulnerable DNS implementations.</span></figcaption>
</figure>
<section class="ltx_subsection" id="S6.SS1">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">6.1. </span>Setup</h3>
<div class="ltx_para" id="S6.SS1.p1">
<p class="ltx_p" id="S6.SS1.p1.1">Unless mentioned otherwise, all evaluations are run on a single CPU core. This allows us to compare between different resolvers with various multi-threading standard configurations. We set up a test environment with a number of components.</p>
</div>
<div class="ltx_para" id="S6.SS1.p2">
<p class="ltx_p" id="S6.SS1.p2.1"><span class="ltx_text ltx_font_bold" id="S6.SS1.p2.1.1">Components.</span>
We set up resolvers and DNS servers in an isolated environment. This ensures that attack requests are not propagated to validating upstream DNS resolvers.
We develop scripts for automated dynamic generation of zonefiles and records upon each query, and scripts for automated construction of the DNSSEC chain of trust.
Generating the zonefiles dynamically enables us to use a virtually infinite number of zones and records required for testing the attacks, which would have otherwise quickly cluttered the zone files and hampered investigations.
The nameservers host the domains used for testing the resolvers and exchanges DNS messages with them according to protocol specifications and specific test semantics. Each test is hosted in a separate subdomain consisting of one or multiple zones. This prevents cache-induced interference between consecutive executions of tests and reduces implementation complexity of the investigations. Test configurations are pre-generated from configuration templates, which we define using a small domain-specific language.
This allows efficient variations over the signature algorithms or the specific number of RRSIGs and DNSKEYs in responses, which are provisioned for attacking validation routines.
We conduct tests by sending queries to the resolvers, causing them to interact with our nameservers according to the test configurations. When a nameserver receives a query it parses it, matches it against a pre-defined set of rules and generates a response. The rule set is loaded from a configuration file upon startup, and determines which tests can be conducted, as well as the specific test semantics. A ”test” specifies, e.g., a set of domains with specific DNSSEC algorithms, numbers of DNSKEYs and signatures over records to validate against these DNSKEYs.</p>
</div>
<div class="ltx_para" id="S6.SS1.p3">
<p class="ltx_p" id="S6.SS1.p3.1"><span class="ltx_text ltx_font_bold" id="S6.SS1.p3.1.1">Transport protocol.</span> DNS responses are typically delivered over UDP. When DNS responses are too large, e.g., exceeding the EDNS size in EDNS(0) OPT header, the nameservers fall back to TCP to avoid fragmentation.
Our attacks can be implemented either over UDP or TCP. We implement TCP as the transport protocol between the resolvers and our nameservers. The maximum size of a DNS message sent over TCP is dictated by [RFC1035], stating that a DNS message over TCP must have a length value prefixed to the message with 2-octets size. Resulting from the size limitation of this field, DNS payload sent in a response from the nameserver to the resolver can have a maximum
size of <math alttext="2^{16}-1" class="ltx_Math" display="inline" id="S6.SS1.p3.1.m1.1"><semantics id="S6.SS1.p3.1.m1.1a"><mrow id="S6.SS1.p3.1.m1.1.1" xref="S6.SS1.p3.1.m1.1.1.cmml"><msup id="S6.SS1.p3.1.m1.1.1.2" xref="S6.SS1.p3.1.m1.1.1.2.cmml"><mn id="S6.SS1.p3.1.m1.1.1.2.2" xref="S6.SS1.p3.1.m1.1.1.2.2.cmml">2</mn><mn id="S6.SS1.p3.1.m1.1.1.2.3" xref="S6.SS1.p3.1.m1.1.1.2.3.cmml">16</mn></msup><mo id="S6.SS1.p3.1.m1.1.1.1" xref="S6.SS1.p3.1.m1.1.1.1.cmml">−</mo><mn id="S6.SS1.p3.1.m1.1.1.3" xref="S6.SS1.p3.1.m1.1.1.3.cmml">1</mn></mrow><annotation-xml encoding="MathML-Content" id="S6.SS1.p3.1.m1.1b"><apply id="S6.SS1.p3.1.m1.1.1.cmml" xref="S6.SS1.p3.1.m1.1.1"><minus id="S6.SS1.p3.1.m1.1.1.1.cmml" xref="S6.SS1.p3.1.m1.1.1.1"></minus><apply id="S6.SS1.p3.1.m1.1.1.2.cmml" xref="S6.SS1.p3.1.m1.1.1.2"><csymbol cd="ambiguous" id="S6.SS1.p3.1.m1.1.1.2.1.cmml" xref="S6.SS1.p3.1.m1.1.1.2">superscript</csymbol><cn id="S6.SS1.p3.1.m1.1.1.2.2.cmml" type="integer" xref="S6.SS1.p3.1.m1.1.1.2.2">2</cn><cn id="S6.SS1.p3.1.m1.1.1.2.3.cmml" type="integer" xref="S6.SS1.p3.1.m1.1.1.2.3">16</cn></apply><cn id="S6.SS1.p3.1.m1.1.1.3.cmml" type="integer" xref="S6.SS1.p3.1.m1.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S6.SS1.p3.1.m1.1c">2^{16}-1</annotation><annotation encoding="application/x-llamapun" id="S6.SS1.p3.1.m1.1d">2 start_POSTSUPERSCRIPT 16 end_POSTSUPERSCRIPT - 1</annotation></semantics></math> = 65535 bytes.
Depending on the Maximal Transmission Unit (MTU), this payload will be sent in one or more TCP segments.
Therefore, the attack payload (i.e., DNS/DNSSEC records) in a DNS response is limited to 65K bytes.</p>
</div>
</section>
<section class="ltx_subsection" id="S6.SS2">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">6.2. </span>Identifying the Optimal Cipher for Attacks</h3>
<div class="ltx_para" id="S6.SS2.p1">
<p class="ltx_p" id="S6.SS2.p1.1">Different DNSSEC algorithms vary in the mathematical computation logic and the complexity of mathematical operations. Therefore, the computation of DNSSEC validation for different algorithms differs in the amount of computation time.
This means that the load created by our attacks is determined also by the cryptographic ciphers the adversarial domain uses. DNSSEC generally supports two different algorithm suites<span class="ltx_note ltx_role_footnote" id="footnote11"><sup class="ltx_note_mark">11</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">11</sup><span class="ltx_tag ltx_tag_note">11</span><span class="ltx_ref ltx_nolink ltx_path ltx_font_typewriter ltx_ref_self">https://www.iana.org/assignments/dns-sec-alg-numbers/dns-sec-alg-numbers.xhtml</span></span></span></span>: RSA based and Elliptic Curve Cryptography (ECC) based cryptographic algorithms. We evaluate both suites and find that the ECC based cryptographic algorithms exhibit a significantly higher load than RSA based algorithms and surpass RSA by over an order of magnitude, <span class="ltx_text" id="S6.SS2.p1.1.1" style="color:#000000;">even when considering RSA keys with the most inefficient selection of exponents allowed by the DNSSEC specification.</span>
This is consistent with previous work <cite class="ltx_cite ltx_citemacro_citep">(<a class="ltx_ref" href="https://arxiv.org/html/2406.03133v1#bib.bib15" title="">van2016performance, </a>)</cite>. ECC-based algorithms are thus better suited to maximize the impact of our attacks on resolvers. We therefore focus on ECC-based algorithms in the following evaluations of the attacks.</p>
</div>
<figure class="ltx_table" id="S6.T2">
<table class="ltx_tabular ltx_align_middle" id="S6.T2.2">
<tr class="ltx_tr" id="S6.T2.2.1">
<td class="ltx_td ltx_border_r ltx_border_tt" id="S6.T2.2.1.1" style="padding-top:-1.05pt;padding-bottom:-1.05pt;"></td>
<td class="ltx_td ltx_align_right ltx_border_tt" id="S6.T2.2.1.2" style="padding-top:-1.05pt;padding-bottom:-1.05pt;"><span class="ltx_text" id="S6.T2.2.1.2.1" style="font-size:70%;">Keys</span></td>
<td class="ltx_td ltx_align_right ltx_border_tt" id="S6.T2.2.1.3" style="padding-top:-1.05pt;padding-bottom:-1.05pt;"><span class="ltx_text" id="S6.T2.2.1.3.1" style="font-size:70%;">Signatures</span></td>
<td class="ltx_td ltx_align_right ltx_border_tt" id="S6.T2.2.1.4" style="padding-top:-1.05pt;padding-bottom:-1.05pt;"><span class="ltx_text" id="S6.T2.2.1.4.1" style="font-size:70%;">Validations</span></td>
</tr>
<tr class="ltx_tr" id="S6.T2.2.2">
<td class="ltx_td ltx_align_left ltx_border_r" id="S6.T2.2.2.1" style="padding-top:-1.05pt;padding-bottom:-1.05pt;"><span class="ltx_text" id="S6.T2.2.2.1.1" style="font-size:70%;">Cipher</span></td>
<td class="ltx_td" id="S6.T2.2.2.2" style="padding-top:-1.05pt;padding-bottom:-1.05pt;"></td>
<td class="ltx_td" id="S6.T2.2.2.3" style="padding-top:-1.05pt;padding-bottom:-1.05pt;"></td>
<td class="ltx_td" id="S6.T2.2.2.4" style="padding-top:-1.05pt;padding-bottom:-1.05pt;"></td>
</tr>
<tr class="ltx_tr" id="S6.T2.2.3">
<td class="ltx_td ltx_align_left ltx_border_r ltx_border_t" id="S6.T2.2.3.1" style="padding-top:-1.05pt;padding-bottom:-1.05pt;"><span class="ltx_text" id="S6.T2.2.3.1.1" style="font-size:70%;">ED448</span></td>
<td class="ltx_td ltx_align_right ltx_border_t" id="S6.T2.2.3.2" style="padding-top:-1.05pt;padding-bottom:-1.05pt;"><span class="ltx_text" id="S6.T2.2.3.2.1" style="font-size:70%;">907</span></td>
<td class="ltx_td ltx_align_right ltx_border_t" id="S6.T2.2.3.3" style="padding-top:-1.05pt;padding-bottom:-1.05pt;"><span class="ltx_text" id="S6.T2.2.3.3.1" style="font-size:70%;">454</span></td>
<td class="ltx_td ltx_align_right ltx_border_t" id="S6.T2.2.3.4" style="padding-top:-1.05pt;padding-bottom:-1.05pt;"><span class="ltx_text" id="S6.T2.2.3.4.1" style="font-size:70%;">411 778</span></td>
</tr>
<tr class="ltx_tr" id="S6.T2.2.4">
<td class="ltx_td ltx_align_left ltx_border_r" id="S6.T2.2.4.1" style="padding-top:-1.05pt;padding-bottom:-1.05pt;"><span class="ltx_text" id="S6.T2.2.4.1.1" style="font-size:70%;">ED25519</span></td>
<td class="ltx_td ltx_align_right" id="S6.T2.2.4.2" style="padding-top:-1.05pt;padding-bottom:-1.05pt;"><span class="ltx_text" id="S6.T2.2.4.2.1" style="font-size:70%;">1 391</span></td>
<td class="ltx_td ltx_align_right" id="S6.T2.2.4.3" style="padding-top:-1.05pt;padding-bottom:-1.05pt;"><span class="ltx_text" id="S6.T2.2.4.3.1" style="font-size:70%;">696</span></td>
<td class="ltx_td ltx_align_right" id="S6.T2.2.4.4" style="padding-top:-1.05pt;padding-bottom:-1.05pt;"><span class="ltx_text" id="S6.T2.2.4.4.1" style="font-size:70%;">968 136</span></td>
</tr>
<tr class="ltx_tr" id="S6.T2.2.5">
<td class="ltx_td ltx_align_left ltx_border_r" id="S6.T2.2.5.1" style="padding-top:-1.05pt;padding-bottom:-1.05pt;"><span class="ltx_text" id="S6.T2.2.5.1.1" style="font-size:70%;">ECDSAP384SHA384</span></td>
<td class="ltx_td ltx_align_right" id="S6.T2.2.5.2" style="padding-top:-1.05pt;padding-bottom:-1.05pt;"><span class="ltx_text" id="S6.T2.2.5.2.1" style="font-size:70%;">589</span></td>
<td class="ltx_td ltx_align_right" id="S6.T2.2.5.3" style="padding-top:-1.05pt;padding-bottom:-1.05pt;"><span class="ltx_text" id="S6.T2.2.5.3.1" style="font-size:70%;">519</span></td>
<td class="ltx_td ltx_align_right" id="S6.T2.2.5.4" style="padding-top:-1.05pt;padding-bottom:-1.05pt;"><span class="ltx_text" id="S6.T2.2.5.4.1" style="font-size:70%;">305 691</span></td>
</tr>
<tr class="ltx_tr" id="S6.T2.2.6">
<td class="ltx_td ltx_align_left ltx_border_r" id="S6.T2.2.6.1" style="padding-top:-1.05pt;padding-bottom:-1.05pt;"><span class="ltx_text" id="S6.T2.2.6.1.1" style="font-size:70%;">ECDSAP256SHA256</span></td>
<td class="ltx_td ltx_align_right" id="S6.T2.2.6.2" style="padding-top:-1.05pt;padding-bottom:-1.05pt;"><span class="ltx_text" id="S6.T2.2.6.2.1" style="font-size:70%;">828</span></td>
<td class="ltx_td ltx_align_right" id="S6.T2.2.6.3" style="padding-top:-1.05pt;padding-bottom:-1.05pt;"><span class="ltx_text" id="S6.T2.2.6.3.1" style="font-size:70%;">696</span></td>
<td class="ltx_td ltx_align_right" id="S6.T2.2.6.4" style="padding-top:-1.05pt;padding-bottom:-1.05pt;"><span class="ltx_text" id="S6.T2.2.6.4.1" style="font-size:70%;">576 288</span></td>
</tr>
<tr class="ltx_tr" id="S6.T2.2.7">
<td class="ltx_td ltx_align_left ltx_border_r" id="S6.T2.2.7.1" style="padding-top:-1.05pt;padding-bottom:-1.05pt;"><span class="ltx_text" id="S6.T2.2.7.1.1" style="font-size:70%;">RSA-512</span></td>
<td class="ltx_td ltx_align_right" id="S6.T2.2.7.2" style="padding-top:-1.05pt;padding-bottom:-1.05pt;"><span class="ltx_text" id="S6.T2.2.7.2.1" style="font-size:70%;">788</span></td>
<td class="ltx_td ltx_align_right" id="S6.T2.2.7.3" style="padding-top:-1.05pt;padding-bottom:-1.05pt;"><span class="ltx_text" id="S6.T2.2.7.3.1" style="font-size:70%;">696</span></td>
<td class="ltx_td ltx_align_right" id="S6.T2.2.7.4" style="padding-top:-1.05pt;padding-bottom:-1.05pt;"><span class="ltx_text" id="S6.T2.2.7.4.1" style="font-size:70%;">548 448</span></td>
</tr>
<tr class="ltx_tr" id="S6.T2.2.8">
<td class="ltx_td ltx_align_left ltx_border_r" id="S6.T2.2.8.1" style="padding-top:-1.05pt;padding-bottom:-1.05pt;"><span class="ltx_text" id="S6.T2.2.8.1.1" style="font-size:70%;">RSA-1024</span></td>
<td class="ltx_td ltx_align_right" id="S6.T2.2.8.2" style="padding-top:-1.05pt;padding-bottom:-1.05pt;"><span class="ltx_text" id="S6.T2.2.8.2.1" style="font-size:70%;">444</span></td>
<td class="ltx_td ltx_align_right" id="S6.T2.2.8.3" style="padding-top:-1.05pt;padding-bottom:-1.05pt;"><span class="ltx_text" id="S6.T2.2.8.3.1" style="font-size:70%;">413</span></td>
<td class="ltx_td ltx_align_right" id="S6.T2.2.8.4" style="padding-top:-1.05pt;padding-bottom:-1.05pt;"><span class="ltx_text" id="S6.T2.2.8.4.1" style="font-size:70%;">183 372</span></td>
</tr>
<tr class="ltx_tr" id="S6.T2.2.9">
<td class="ltx_td ltx_align_left ltx_border_r" id="S6.T2.2.9.1" style="padding-top:-1.05pt;padding-bottom:-1.05pt;"><span class="ltx_text" id="S6.T2.2.9.1.1" style="font-size:70%;">RSA-2048</span></td>
<td class="ltx_td ltx_align_right" id="S6.T2.2.9.2" style="padding-top:-1.05pt;padding-bottom:-1.05pt;"><span class="ltx_text" id="S6.T2.2.9.2.1" style="font-size:70%;">237</span></td>
<td class="ltx_td ltx_align_right" id="S6.T2.2.9.3" style="padding-top:-1.05pt;padding-bottom:-1.05pt;"><span class="ltx_text" id="S6.T2.2.9.3.1" style="font-size:70%;">228</span></td>
<td class="ltx_td ltx_align_right" id="S6.T2.2.9.4" style="padding-top:-1.05pt;padding-bottom:-1.05pt;"><span class="ltx_text" id="S6.T2.2.9.4.1" style="font-size:70%;">54 036</span></td>
</tr>
<tr class="ltx_tr" id="S6.T2.2.10">
<td class="ltx_td ltx_align_left ltx_border_bb ltx_border_r" id="S6.T2.2.10.1" style="padding-top:-1.05pt;padding-bottom:-1.05pt;"><span class="ltx_text" id="S6.T2.2.10.1.1" style="font-size:70%;">RSA-4096</span></td>
<td class="ltx_td ltx_align_right ltx_border_bb" id="S6.T2.2.10.2" style="padding-top:-1.05pt;padding-bottom:-1.05pt;"><span class="ltx_text" id="S6.T2.2.10.2.1" style="font-size:70%;">122</span></td>
<td class="ltx_td ltx_align_right ltx_border_bb" id="S6.T2.2.10.3" style="padding-top:-1.05pt;padding-bottom:-1.05pt;"><span class="ltx_text" id="S6.T2.2.10.3.1" style="font-size:70%;">119</span></td>
<td class="ltx_td ltx_align_right ltx_border_bb" id="S6.T2.2.10.4" style="padding-top:-1.05pt;padding-bottom:-1.05pt;"><span class="ltx_text" id="S6.T2.2.10.4.1" style="font-size:70%;">14 518</span></td>
</tr>
</table>
<figcaption class="ltx_caption" style="font-size:70%;"><span class="ltx_tag ltx_tag_table"><span class="ltx_text" id="S6.T2.5.1.1" style="font-size:129%;">Table 2</span>. </span><span class="ltx_text" id="S6.T2.6.2" style="font-size:129%;">Max. DNSKEYs, RRSIGs, and validations per response.</span></figcaption>
</figure>
<div class="ltx_para" id="S6.SS2.p2">
<p class="ltx_p" id="S6.SS2.p2.1"><span class="ltx_text ltx_font_bold" id="S6.SS2.p2.1.1">Comparison of computation load of ECC algorithms.</span>
We evaluate if validation of different ECC algorithms results in different processing times on different DNS resolvers. For the evaluation, we set up all major DNS resolvers (see Table <a class="ltx_ref" href="https://arxiv.org/html/2406.03133v1#S6.T3" title="Table 3 ‣ 6.2. Identifying the Optimal Cipher for Attacks ‣ 6. Evaluation of the Attacks ‣ The Harder You Try, The Harder You Fail: The KeyTrap Denial-of-Service Algorithmic Complexity Attacks on DNSSEC"><span class="ltx_text ltx_ref_tag">3</span></a>) on an identical hardware machine. We evaluated all resolvers by running a full resolution with 2500 validations. Times were average over 10 attempts to ensure consistency. Measuring the validation time of the message instead of only measuring the validation procedure allows a more accurate view of the behavior of the resolvers for different algorithms, as overall processing times might also be influenced by components outside the validation procedure. The measurements illustrate different processing times between resolvers, indicating differing efficiencies of the implementation. Some efficiency divergence is expected, as a large amount of signature validations on a single RRset is not an expected use-case for resolvers and thus, it is expected that resolvers are not optimized for it. This is clearly visible in the validation times of Bind9, which supersede the other resolvers due to an inefficient implementation of key selection in the case of colliding keys.</p>
</div>
<div class="ltx_para" id="S6.SS2.p3">
<p class="ltx_p" id="S6.SS2.p3.1">The table illustrates that all resolvers take the longest validation time for signature created with algorithm 14, <span class="ltx_text" id="S6.SS2.p3.1.1" style="color:#000000;">which is</span> ECDSA Curve P-384/SHA-384.
Thus, algorithm 14 is the most suited for the attacks on all resolvers, achieving maximum impact with the available maximum buffer size. Using the 384bit key size of algorithm 14, and constructing the theoretical minimal size DNS message transporting the keys, an attacker could fit up to <span class="ltx_text ltx_font_bold" id="S6.SS2.p3.1.2">589 colliding DNS keys into a single DNS message</span>. Similarly, using minimal DNS overhead, an attacker could fit up to a maximum of <span class="ltx_text ltx_font_bold" id="S6.SS2.p3.1.3">519 signatures into a single DNS message</span>. Thus, with one resolution request with algorithm 14, an attacker could theoretically trigger <span class="ltx_text ltx_font_bold" id="S6.SS2.p3.1.4">589*519 = 305691 signature validations</span> in the DNS resolver, leading to significant processing effort on the resolver. Table <a class="ltx_ref" href="https://arxiv.org/html/2406.03133v1#S6.T2" title="Table 2 ‣ 6.2. Identifying the Optimal Cipher for Attacks ‣ 6. Evaluation of the Attacks ‣ The Harder You Try, The Harder You Fail: The KeyTrap Denial-of-Service Algorithmic Complexity Attacks on DNSSEC"><span class="ltx_text ltx_ref_tag">2</span></a> shows the theoretical maximum values for all commonly supported DNSSEC algorithm. Theoretical maxima are calculated by choosing the minimal possible size for all fields in the DNS message. In practice, the exact value of signatures and keys that can fit into a single message is limited by the attacker setup. DNSSEC messages contain additional information besides the raw bytes of the signature or key, like the signer name, leading to the lower number of entries in real-world attack setup. In our evaluation setup, we make a conservative approximation on the practical size of the fields in the messages, using 582 DNSKEYs per message and 340 signatures per message.</p>
</div>
<figure class="ltx_table" id="S6.T3">
<table class="ltx_tabular ltx_centering ltx_align_middle" id="S6.T3.4">
<tr class="ltx_tr" id="S6.T3.4.1">
<td class="ltx_td ltx_align_left ltx_border_l ltx_border_r ltx_border_t" id="S6.T3.4.1.1" style="padding-top:-1.05pt;padding-bottom:-1.05pt;"><span class="ltx_text" id="S6.T3.4.1.1.1" style="font-size:70%;">Name</span></td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S6.T3.4.1.2" style="padding-top:-1.05pt;padding-bottom:-1.05pt;"><span class="ltx_text" id="S6.T3.4.1.2.1" style="font-size:70%;">Alg 13</span></td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S6.T3.4.1.3" style="padding-top:-1.05pt;padding-bottom:-1.05pt;"><span class="ltx_text" id="S6.T3.4.1.3.1" style="font-size:70%;">Alg 14</span></td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S6.T3.4.1.4" style="padding-top:-1.05pt;padding-bottom:-1.05pt;"><span class="ltx_text" id="S6.T3.4.1.4.1" style="font-size:70%;">Alg 15</span></td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S6.T3.4.1.5" style="padding-top:-1.05pt;padding-bottom:-1.05pt;"><span class="ltx_text" id="S6.T3.4.1.5.1" style="font-size:70%;">Alg 16</span></td>
</tr>
<tr class="ltx_tr" id="S6.T3.4.2">
<td class="ltx_td ltx_align_left ltx_border_l ltx_border_r ltx_border_t" id="S6.T3.4.2.1" style="padding-top:-1.05pt;padding-bottom:-1.05pt;"><span class="ltx_text" id="S6.T3.4.2.1.1" style="font-size:70%;">Unbound</span></td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S6.T3.4.2.2" style="padding-top:-1.05pt;padding-bottom:-1.05pt;"><span class="ltx_text" id="S6.T3.4.2.2.1" style="font-size:70%;">172</span></td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S6.T3.4.2.3" style="padding-top:-1.05pt;padding-bottom:-1.05pt;"><span class="ltx_text ltx_font_bold" id="S6.T3.4.2.3.1" style="font-size:70%;">996</span></td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S6.T3.4.2.4" style="padding-top:-1.05pt;padding-bottom:-1.05pt;"><span class="ltx_text" id="S6.T3.4.2.4.1" style="font-size:70%;">880</span></td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S6.T3.4.2.5" style="padding-top:-1.05pt;padding-bottom:-1.05pt;"><span class="ltx_text" id="S6.T3.4.2.5.1" style="font-size:70%;">364</span></td>
</tr>
<tr class="ltx_tr" id="S6.T3.4.3">
<td class="ltx_td ltx_align_left ltx_border_l ltx_border_r" id="S6.T3.4.3.1" style="padding-top:-1.05pt;padding-bottom:-1.05pt;"><span class="ltx_text" id="S6.T3.4.3.1.1" style="font-size:70%;">Bind9</span></td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S6.T3.4.3.2" style="padding-top:-1.05pt;padding-bottom:-1.05pt;"><span class="ltx_text" id="S6.T3.4.3.2.1" style="font-size:70%;">888</span></td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S6.T3.4.3.3" style="padding-top:-1.05pt;padding-bottom:-1.05pt;"><span class="ltx_text ltx_font_bold" id="S6.T3.4.3.3.1" style="font-size:70%;">2448</span></td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S6.T3.4.3.4" style="padding-top:-1.05pt;padding-bottom:-1.05pt;"><span class="ltx_text" id="S6.T3.4.3.4.1" style="font-size:70%;">460</span></td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S6.T3.4.3.5" style="padding-top:-1.05pt;padding-bottom:-1.05pt;"><span class="ltx_text" id="S6.T3.4.3.5.1" style="font-size:70%;">628</span></td>
</tr>
<tr class="ltx_tr" id="S6.T3.4.4">
<td class="ltx_td ltx_align_left ltx_border_l ltx_border_r" id="S6.T3.4.4.1" style="padding-top:-1.05pt;padding-bottom:-1.05pt;"><span class="ltx_text" id="S6.T3.4.4.1.1" style="font-size:70%;">Knot</span></td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S6.T3.4.4.2" style="padding-top:-1.05pt;padding-bottom:-1.05pt;"><span class="ltx_text" id="S6.T3.4.4.2.1" style="font-size:70%;">232</span></td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S6.T3.4.4.3" style="padding-top:-1.05pt;padding-bottom:-1.05pt;"><span class="ltx_text ltx_font_bold" id="S6.T3.4.4.3.1" style="font-size:70%;">496</span></td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S6.T3.4.4.4" style="padding-top:-1.05pt;padding-bottom:-1.05pt;"><span class="ltx_text" id="S6.T3.4.4.4.1" style="font-size:70%;">164</span></td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S6.T3.4.4.5" style="padding-top:-1.05pt;padding-bottom:-1.05pt;"><span class="ltx_text" id="S6.T3.4.4.5.1" style="font-size:70%;">456</span></td>
</tr>
<tr class="ltx_tr" id="S6.T3.4.5">
<td class="ltx_td ltx_align_left ltx_border_l ltx_border_r" id="S6.T3.4.5.1" style="padding-top:-1.05pt;padding-bottom:-1.05pt;"><span class="ltx_text" id="S6.T3.4.5.1.1" style="font-size:70%;">Akamai</span></td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S6.T3.4.5.2" style="padding-top:-1.05pt;padding-bottom:-1.05pt;"><span class="ltx_text" id="S6.T3.4.5.2.1" style="font-size:70%;">219</span></td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S6.T3.4.5.3" style="padding-top:-1.05pt;padding-bottom:-1.05pt;"><span class="ltx_text ltx_font_bold" id="S6.T3.4.5.3.1" style="font-size:70%;">976</span></td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S6.T3.4.5.4" style="padding-top:-1.05pt;padding-bottom:-1.05pt;"><span class="ltx_text" id="S6.T3.4.5.4.1" style="font-size:70%;">209</span></td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S6.T3.4.5.5" style="padding-top:-1.05pt;padding-bottom:-1.05pt;"><span class="ltx_text" id="S6.T3.4.5.5.1" style="font-size:70%;">392</span></td>
</tr>
<tr class="ltx_tr" id="S6.T3.4.6">
<td class="ltx_td ltx_align_left ltx_border_b ltx_border_l ltx_border_r" id="S6.T3.4.6.1" style="padding-top:-1.05pt;padding-bottom:-1.05pt;"><span class="ltx_text" id="S6.T3.4.6.1.1" style="font-size:70%;">PowerDNS</span></td>
<td class="ltx_td ltx_align_center ltx_border_b ltx_border_r" id="S6.T3.4.6.2" style="padding-top:-1.05pt;padding-bottom:-1.05pt;"><span class="ltx_text" id="S6.T3.4.6.2.1" style="font-size:70%;">153</span></td>
<td class="ltx_td ltx_align_center ltx_border_b ltx_border_r" id="S6.T3.4.6.3" style="padding-top:-1.05pt;padding-bottom:-1.05pt;"><span class="ltx_text ltx_font_bold" id="S6.T3.4.6.3.1" style="font-size:70%;">924</span></td>
<td class="ltx_td ltx_align_center ltx_border_b ltx_border_r" id="S6.T3.4.6.4" style="padding-top:-1.05pt;padding-bottom:-1.05pt;"><span class="ltx_text" id="S6.T3.4.6.4.1" style="font-size:70%;">840</span></td>
<td class="ltx_td ltx_align_center ltx_border_b ltx_border_r" id="S6.T3.4.6.5" style="padding-top:-1.05pt;padding-bottom:-1.05pt;"><span class="ltx_text" id="S6.T3.4.6.5.1" style="font-size:70%;">628</span></td>
</tr>
</table>
<figcaption class="ltx_caption ltx_centering" style="font-size:70%;"><span class="ltx_tag ltx_tag_table"><span class="ltx_text" id="S6.T3.8.2.1" style="font-size:129%;">Table 3</span>. </span><span class="ltx_text" id="S6.T3.2.1" style="font-size:129%;">Validation time per signature in <math alttext="\mu" class="ltx_Math" display="inline" id="S6.T3.2.1.m1.1"><semantics id="S6.T3.2.1.m1.1b"><mi id="S6.T3.2.1.m1.1.1" xref="S6.T3.2.1.m1.1.1.cmml">μ</mi><annotation-xml encoding="MathML-Content" id="S6.T3.2.1.m1.1c"><ci id="S6.T3.2.1.m1.1.1.cmml" xref="S6.T3.2.1.m1.1.1">𝜇</ci></annotation-xml><annotation encoding="application/x-tex" id="S6.T3.2.1.m1.1d">\mu</annotation><annotation encoding="application/x-llamapun" id="S6.T3.2.1.m1.1e">italic_μ</annotation></semantics></math>s.</span></figcaption>
</figure>
</section>
<section class="ltx_subsection" id="S6.SS3">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">6.3. </span>Effectiveness of the Attacks</h3>
<div class="ltx_para" id="S6.SS3.p1">
<p class="ltx_p" id="S6.SS3.p1.1">To evaluate the attacks, we setup all the resolvers to query a malicious domain signed with algorithm 14.
During the evaluations, we use a benign DNS client that requests ten unique DNS entries per second from the investigated resolver and logs received replies. We choose a 5s timeout for benign requests, i.e., benign requests to the resolver that are not answered after 5s are considered to have no value to the benign user and are therefore considered lost. This timeout is consistent with DNS tooling like dig (5s) <span class="ltx_note ltx_role_footnote" id="footnote12"><sup class="ltx_note_mark">12</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">12</sup><span class="ltx_tag ltx_tag_note">12</span>https://linux.die.net/man/1/dig</span></span></span>, Windows DNS tools (1s-4s), and glibc (5s) <span class="ltx_note ltx_role_footnote" id="footnote13"><sup class="ltx_note_mark">13</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">13</sup><span class="ltx_tag ltx_tag_note">13</span>https://linux.die.net/man/5/resolv.conf</span></span></span>.</p>
</div>
<figure class="ltx_figure" id="S6.F2"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="135" id="S6.F2.g1" src="extracted/5645199/figures/unbound_hpoc_updated.png" width="538"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span class="ltx_text" id="S6.F2.2.1.1" style="font-size:90%;">Figure 2</span>. </span><span class="ltx_text" id="S6.F2.3.2" style="font-size:90%;">KeySigTrap attack on Unbound with single request.</span></figcaption>
</figure>
<div class="ltx_para" id="S6.SS3.p2">
<p class="ltx_p" id="S6.SS3.p2.1"><span class="ltx_text ltx_font_bold" id="S6.SS3.p2.1.1">KeySigTrap.</span> Evaluating KeySigTrap, we set up a zonefile with 582 colliding DNSSEC keys and 340 signatures.
We illustrate the impact of the attack on Unbound in Figure <a class="ltx_ref" href="https://arxiv.org/html/2406.03133v1#S6.F2" title="Figure 2 ‣ 6.3. Effectiveness of the Attacks ‣ 6. Evaluation of the Attacks ‣ The Harder You Try, The Harder You Fail: The KeyTrap Denial-of-Service Algorithmic Complexity Attacks on DNSSEC"><span class="ltx_text ltx_ref_tag">2</span></a>. As can be seen in the plot, once the attacker triggers a single DNS request, the KeySigTrap attack payload in the DNS response causes the CPU usage on the resolver to increase to 100% due to a large load in validating the signatures. While busy validating signatures, the resolver does not answer any benign requests, leading to 100% lost benign requests until the resolver finishes the validation, which takes about 1014s. Thus, a single attacker request causes a 1014 seconds long complete DoS of the resolver. We measured all investigated DNS resolvers on an identical setup. The results in Table <a class="ltx_ref" href="https://arxiv.org/html/2406.03133v1#S6.T4" title="Table 4 ‣ 6.3. Effectiveness of the Attacks ‣ 6. Evaluation of the Attacks ‣ The Harder You Try, The Harder You Fail: The KeyTrap Denial-of-Service Algorithmic Complexity Attacks on DNSSEC"><span class="ltx_text ltx_ref_tag">4</span></a> show that all resolvers are heavily affected by a single request and stalled for a substantial amount of time. However, the stalling duration differs significantly between resolvers. Akamai, PowerDNS and Stubby all take about 3 minutes to validate the signatures. The reason is that they use similar cryptographic implementations, validating through all key-signature pairs until they return a SERVFAIL to the client. <span class="ltx_text" id="S6.SS3.p2.1.2" style="color:#000000;">We find that on average, a KeySigTrap request causes 2.000.000x load compared to benign requests, reducing resolver throughput to 0 in any tested resolver.</span>
However, we observed three notable outliers in the DoS duration of the attack.</p>
</div>
<div class="ltx_para" id="S6.SS3.p3">
<p class="ltx_p" id="S6.SS3.p3.1"><span class="ltx_text ltx_font_italic" id="S6.SS3.p3.1.1">Unbound</span> is DoSed approximately six times longer than the other resolvers. The reason is the default re-query behavior of Unbound. In a default configuration, Unbound attempts to re-query the nameserver five times after failed validation of all signatures. Therefore, Unbound validates all attacker signatures six times before returning SERVFAIL to the client. This explains the extended DoS of Unbound compared to the other resolvers. Disabling default re-queries, we find Unbound is DoSed for 176s on a single KeyTrap request.</p>
</div>
<div class="ltx_para" id="S6.SS3.p4">
<p class="ltx_p" id="S6.SS3.p4.1"><span class="ltx_text ltx_font_italic" id="S6.SS3.p4.1.1">Bind9</span> is the second major outlier. The resolver is stalled for over 16h with a single attacker request. Investigating the cause for this observation, we identified an inefficiency in the code, triggered by a large amount of colliding DNSSEC keys. The routine responsible for identifying the next DNSSEC key to try on a signature does not implement an efficient algorithm to select the next key from the remaining keys. Instead, it parses all keys again until it finds a key that has not been tried yet. The algorithm does not lead to inefficiencies in normal operation with a small amount of colliding keys. But when many keys collide, the resolver spends a large amount of time parsing the keys and selecting the next key, extending the duration of the DoS to 16h.</p>
</div>
<div class="ltx_para" id="S6.SS3.p5">
<p class="ltx_p" id="S6.SS3.p5.1"><span class="ltx_text ltx_font_italic" id="S6.SS3.p5.1.1">Knot</span> is slightly less affected by the attack than the other resolvers. Evaluating the attack on Knot shows that the resolver has a limited buffer size for DNSSEC keys, limiting the number of keys per request to 126 keys. This results in a shorter DoS duration on Knot. However, the impact of the attack on Knot is still substantial with a 56s DoS from a single attack request.</p>
</div>
<div class="ltx_para" id="S6.SS3.p6">
<p class="ltx_p" id="S6.SS3.p6.1">In the following, we will show the impact of SigJam, LockCram, and HashTrap on the resolvers, illustrating how to similarly achieve maximum DoS of the resolver.</p>
</div>
<div class="ltx_para" id="S6.SS3.p7">
<p class="ltx_p" id="S6.SS3.p7.1"><span class="ltx_text ltx_font_bold" id="S6.SS3.p7.1.1">SigJam.</span>
Achieving full DoS with any attack other than KeySigTrap requires more than a single attacker request. To evaluate SigJam, we send 1 attack response per second to the resolver, containing the (maximum number of) 340 signatures in one DNS response.
Using 340 signatures per request, we steadily increase the amount of attacker’s requests until we observe no increase in lost benign queries. As illustrated in Figure <a class="ltx_ref" href="https://arxiv.org/html/2406.03133v1#S6.F3" title="Figure 3 ‣ 6.3. Effectiveness of the Attacks ‣ 6. Evaluation of the Attacks ‣ The Harder You Try, The Harder You Fail: The KeyTrap Denial-of-Service Algorithmic Complexity Attacks on DNSSEC"><span class="ltx_text ltx_ref_tag">3</span></a>, 10 req/s cause a severe load on the resolver, leading to 75% lost benign traffic. The reason for intermediate responses to benign queries is I/O when the resolvers wait for new signatures. <span class="ltx_text" id="S6.SS3.p7.1.2" style="color:#000000;">We find that on average, a SigJam request is able to displace 773 benign requests, i.e. a SigJam request causes 773x load compared to begin traffic. For a resolver capable of handling 1000 requests in real-time, the throughput is reduced to 227 req/s with a single SigJam request per second.</span>
This also explains why we do not see improvement in effectiveness of the attack with more malicious requests. The resolver still needs to conduct I/O operations, hence intermediate requests get processed.</p>
</div>
<figure class="ltx_figure" id="S6.F3"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="135" id="S6.F3.g1" src="extracted/5645199/figures/unbound_sigjam_updated.png" width="538"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span class="ltx_text" id="S6.F3.2.1.1" style="font-size:90%;">Figure 3</span>. </span><span class="ltx_text" id="S6.F3.3.2" style="font-size:90%;">SigJam attack with 10 req/s.</span></figcaption>
</figure>
<figure class="ltx_figure" id="S6.F4"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="135" id="S6.F4.g1" src="extracted/5645199/figures/ds_hashing_unbound_new.png" width="538"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span class="ltx_text" id="S6.F4.2.1.1" style="font-size:90%;">Figure 4</span>. </span><span class="ltx_text" id="S6.F4.3.2" style="font-size:90%;">HashTrap attack with two requests per second.</span></figcaption>
</figure>
<div class="ltx_para" id="S6.SS3.p8">
<p class="ltx_p" id="S6.SS3.p8.1"><span class="ltx_text ltx_font_bold" id="S6.SS3.p8.1.1">LockCram.</span> We evaluate the LockCram attack using 582 keys of algorithm 14 on Unbound.
The attack starts with 1 attacker request per second. We increase the rate of attack until we see no increase in lost benign requests.
At 10 attack req/s, we achieve full DoS of the resolver, with ¿ 99% loss of benign requests, see Figure <a class="ltx_ref" href="https://arxiv.org/html/2406.03133v1#S6.F5" title="Figure 5 ‣ 6.3. Effectiveness of the Attacks ‣ 6. Evaluation of the Attacks ‣ The Harder You Try, The Harder You Fail: The KeyTrap Denial-of-Service Algorithmic Complexity Attacks on DNSSEC"><span class="ltx_text ltx_ref_tag">5</span></a>.
The figure illustrates that the validation of the signature against all colliding keys results in 100% utilization of the CPU.
In contrast to SigJam, we do not see intermediate replies while the attack is running. The reason is that LockCram attack requires much lower I/O effort than SigJam. In the first attack request of the evaluation, the resolver needs to download and validate the RRSet containing all colliding keys. In subsequent requests, the resolver already has the keys cached and only needs to download one signature. Thus, the resolver spends much less time idling during the attack, preventing it from answering benign requests while waiting for attack I/O. <span class="ltx_text" id="S6.SS3.p8.1.2" style="color:#000000;">On average, a LockCram request is able to displace 815 benign requests, i.e. a LockCram request causes 815x load compared to benign requests.</span></p>
</div>
<figure class="ltx_figure" id="S6.F5"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="135" id="S6.F5.g1" src="extracted/5645199/figures/unbound_lockcram_updated.png" width="538"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span class="ltx_text" id="S6.F5.2.1.1" style="font-size:90%;">Figure 5</span>. </span><span class="ltx_text" id="S6.F5.3.2" style="font-size:90%;">LockCram attack with 10 req/s.</span></figcaption>
</figure>
<div class="ltx_para" id="S6.SS3.p9">
<p class="ltx_p" id="S6.SS3.p9.1"><span class="ltx_text ltx_font_bold" id="S6.SS3.p9.1.1">HashTrap.</span> We evaluate the HashTrap attack using digests of type 2 (SHA256) as it requires the largest amount of time to compute on a 64-bit system.
Since the calculation time of the hashes does not depend on the key size, we chose the smallest possible DNSSEC keys, fitting as many keys as possible in one DNS message and thereby maximizing the number of hash calculations. The smallest key size of common DNSSEC algorithms is given by algorithm 15, using 256-bit keys.
Using 256-bit keys allows us to fit 1357 DS records, and 1357 DNSKEYs in one attack request, resulting in 1357 * 1357 = 1.841.449 hash calculations per request.</p>
</div>
<div class="ltx_para" id="S6.SS3.p10">
<p class="ltx_p" id="S6.SS3.p10.1">We start the evaluation with 1 attack request per second and increase the rate until we observe no further increase in lost benign requests at 2 attack requests per second. As can be seen in Figure <a class="ltx_ref" href="https://arxiv.org/html/2406.03133v1#S6.F4" title="Figure 4 ‣ 6.3. Effectiveness of the Attacks ‣ 6. Evaluation of the Attacks ‣ The Harder You Try, The Harder You Fail: The KeyTrap Denial-of-Service Algorithmic Complexity Attacks on DNSSEC"><span class="ltx_text ltx_ref_tag">4</span></a> the attack leads to 98% lost benign request. The 2% queries still answered are again caused by I/O operations of the resolver, allowing it to answer some benign queries. <span class="ltx_text" id="S6.SS3.p10.1.1" style="color:#000000;">We find a greater impact on maximum throughput, with one HashTrap request displacing 1254 benign requests.</span></p>
</div>
<figure class="ltx_table" id="S6.T4">
<div class="ltx_flex_figure ltx_flex_table">
<div class="ltx_flex_cell ltx_flex_size_1">
<table class="ltx_tabular ltx_centering ltx_figure_panel ltx_align_middle" id="S6.T4.2">
<tr class="ltx_tr" id="S6.T4.2.1">
<td class="ltx_td ltx_align_left ltx_border_l ltx_border_r ltx_border_t" id="S6.T4.2.1.1" style="padding-top:-1.05pt;padding-bottom:-1.05pt;"><span class="ltx_text" id="S6.T4.2.1.1.1" style="font-size:70%;">Name</span></td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S6.T4.2.1.2" style="padding-top:-1.05pt;padding-bottom:-1.05pt;"><span class="ltx_text" id="S6.T4.2.1.2.1" style="font-size:70%;">DoS Duration</span></td>
</tr>
<tr class="ltx_tr" id="S6.T4.2.2">
<td class="ltx_td ltx_align_left ltx_border_l ltx_border_r ltx_border_t" id="S6.T4.2.2.1" style="padding-top:-1.05pt;padding-bottom:-1.05pt;"><span class="ltx_text" id="S6.T4.2.2.1.1" style="font-size:70%;">Unbound</span></td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S6.T4.2.2.2" style="padding-top:-1.05pt;padding-bottom:-1.05pt;"><span class="ltx_text" id="S6.T4.2.2.2.1" style="font-size:70%;">1014s</span></td>
</tr>
<tr class="ltx_tr" id="S6.T4.2.3">
<td class="ltx_td ltx_align_left ltx_border_l ltx_border_r" id="S6.T4.2.3.1" style="padding-top:-1.05pt;padding-bottom:-1.05pt;"><span class="ltx_text" id="S6.T4.2.3.1.1" style="font-size:70%;">Bind9</span></td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S6.T4.2.3.2" style="padding-top:-1.05pt;padding-bottom:-1.05pt;"><span class="ltx_text" id="S6.T4.2.3.2.1" style="font-size:70%;">58632s</span></td>
</tr>
<tr class="ltx_tr" id="S6.T4.2.4">
<td class="ltx_td ltx_align_left ltx_border_l ltx_border_r" id="S6.T4.2.4.1" style="padding-top:-1.05pt;padding-bottom:-1.05pt;"><span class="ltx_text" id="S6.T4.2.4.1.1" style="font-size:70%;">Knot</span></td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S6.T4.2.4.2" style="padding-top:-1.05pt;padding-bottom:-1.05pt;"><span class="ltx_text" id="S6.T4.2.4.2.1" style="font-size:70%;">51s*</span></td>
</tr>
<tr class="ltx_tr" id="S6.T4.2.5">
<td class="ltx_td ltx_align_left ltx_border_l ltx_border_r" id="S6.T4.2.5.1" style="padding-top:-1.05pt;padding-bottom:-1.05pt;"><span class="ltx_text" id="S6.T4.2.5.1.1" style="font-size:70%;">Akamai</span></td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S6.T4.2.5.2" style="padding-top:-1.05pt;padding-bottom:-1.05pt;"><span class="ltx_text" id="S6.T4.2.5.2.1" style="font-size:70%;">186s</span></td>
</tr>
<tr class="ltx_tr" id="S6.T4.2.6">
<td class="ltx_td ltx_align_left ltx_border_l ltx_border_r" id="S6.T4.2.6.1" style="padding-top:-1.05pt;padding-bottom:-1.05pt;"><span class="ltx_text" id="S6.T4.2.6.1.1" style="font-size:70%;">PowerDNS</span></td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S6.T4.2.6.2" style="padding-top:-1.05pt;padding-bottom:-1.05pt;"><span class="ltx_text" id="S6.T4.2.6.2.1" style="font-size:70%;">170s</span></td>
</tr>
<tr class="ltx_tr" id="S6.T4.2.7">
<td class="ltx_td ltx_align_left ltx_border_b ltx_border_l ltx_border_r" id="S6.T4.2.7.1" style="padding-top:-1.05pt;padding-bottom:-1.05pt;"><span class="ltx_text" id="S6.T4.2.7.1.1" style="font-size:70%;">Stubby</span></td>
<td class="ltx_td ltx_align_center ltx_border_b ltx_border_r" id="S6.T4.2.7.2" style="padding-top:-1.05pt;padding-bottom:-1.05pt;"><span class="ltx_text" id="S6.T4.2.7.2.1" style="font-size:70%;">184s</span></td>
</tr>
</table>
</div>
</div>
<figcaption class="ltx_caption ltx_centering" style="font-size:70%;"><span class="ltx_tag ltx_tag_table"><span class="ltx_text" id="S6.T4.5.1.1" style="font-size:129%;">Table 4</span>. </span><span class="ltx_text" id="S6.T4.6.2" style="font-size:129%;">DoS duration with single attack request.</span></figcaption><div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_1">
<p class="ltx_p ltx_figure_panel ltx_align_center" id="S6.T4.7"><span class="ltx_text" id="S6.T4.7.1" style="font-size:70%;">*Knot has a limited buffer for DNSSEC keys (126 keys), allowing for a smaller attack payload.</span></p>
</div>
</div>
</figure>
</section>
<section class="ltx_subsection" id="S6.SS4">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">6.4. </span>Effect on Inbound/Pending DNS Packets</h3>
<div class="ltx_para" id="S6.SS4.p1">
<p class="ltx_p" id="S6.SS4.p1.1">When resolvers are stalled from our attacks, they can neither process pending requests nor respond to clients queries, even for records that could otherwise be responded from the cache.
We find that a query that arrives during the time that a resolver is stalled is generally not discarded but is placed in a buffer for later processing. In normal operation, the resolver continuously reads requests from the buffer and processes them, either by replying from cache or with a recursive DNS resolution. During a KeyTrap attack, resolvers are stalled in validation and do not process new requests. The requests are stored in the OS buffer, which eventually fills, resulting in loss of subsequent inbound packets.</p>
</div>
<div class="ltx_para" id="S6.SS4.p2">
<p class="ltx_p" id="S6.SS4.p2.1">Note that packets may also get lost even if the buffer is not full. We find that PowerDNS discards old packets by default. When depleting the OS UDP buffer after the attack is over, PowerDNS discards any packets older than 2s.
This means that during the KeyTrap attack, any benign request arriving at PowerDNS earlier than 2s before the end of the attack does not get answered. If the OS buffer fills up more than 2s before the attack is over, the OS drops the packets that PowerDNS would still answer to, resulting in PowerDNS not sending out any replies to benign requests after the attack is over.</p>
</div>
</section>
<section class="ltx_subsection" id="S6.SS5">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">6.5. </span>Effect on Clients</h3>
<div class="ltx_para" id="S6.SS5.p1">
<p class="ltx_p" id="S6.SS5.p1.1">We also monitor the responses sent by the resolver to a benign DNS client during the attack. The client continuously requests unique un-cached records from the tested resolver and logs when it receives an answer. With this setup, we can evaluate if the resolver still answers to benign requests while busy validating the signatures from the attack request.</p>
</div>
<div class="ltx_para" id="S6.SS5.p2">
<p class="ltx_p" id="S6.SS5.p2.1">The impact is illustrated in Figure <a class="ltx_ref" href="https://arxiv.org/html/2406.03133v1#S6.F7" title="Figure 7 ‣ 6.6. Multi-Threading ‣ 6. Evaluation of the Attacks ‣ The Harder You Try, The Harder You Fail: The KeyTrap Denial-of-Service Algorithmic Complexity Attacks on DNSSEC"><span class="ltx_text ltx_ref_tag">7</span></a>. In Unbound as well as in all other resolvers we investigated, the resolver does not answer to client requests while busy validating the signatures of the attacker request. This can be seen in the graph, showing the amount of answers the client receives over time. Once the attack request is sent at two seconds, the resolver stops answering to any benign requests. Only after it finishes processing the attacker request, the resolver again answers to benign queries at around 25s. The graph illustrates that the impact of the attack is severe, as it results in a full DoS of the resolver while the attack is running.</p>
</div>
<figure class="ltx_table" id="S6.T5">
<div class="ltx_flex_figure ltx_flex_table">
<div class="ltx_flex_cell ltx_flex_size_1">
<table class="ltx_tabular ltx_centering ltx_figure_panel ltx_align_middle" id="S6.T5.2">
<tr class="ltx_tr" id="S6.T5.2.1">
<td class="ltx_td ltx_align_center ltx_border_l ltx_border_r ltx_border_t" id="S6.T5.2.1.1" style="padding-top:-1.05pt;padding-bottom:-1.05pt;"><span class="ltx_text" id="S6.T5.2.1.1.1" style="font-size:70%;">Resolver</span></td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S6.T5.2.1.2" style="padding-top:-1.05pt;padding-bottom:-1.05pt;"><span class="ltx_text" id="S6.T5.2.1.2.1" style="font-size:70%;">OS Buffer</span></td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S6.T5.2.1.3" style="padding-top:-1.05pt;padding-bottom:-1.05pt;"><span class="ltx_text" id="S6.T5.2.1.3.1" style="font-size:70%;">Discard</span></td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S6.T5.2.1.4" style="padding-top:-1.05pt;padding-bottom:-1.05pt;"><span class="ltx_text" id="S6.T5.2.1.4.1" style="font-size:70%;">Reply</span></td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S6.T5.2.1.5" style="padding-top:-1.05pt;padding-bottom:-1.05pt;"><span class="ltx_text" id="S6.T5.2.1.5.1" style="font-size:70%;">Retries</span></td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S6.T5.2.1.6" style="padding-top:-1.05pt;padding-bottom:-1.05pt;"><span class="ltx_text" id="S6.T5.2.1.6.1" style="font-size:70%;">Processing</span></td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S6.T5.2.1.7" style="padding-top:-1.05pt;padding-bottom:-1.05pt;"><span class="ltx_text" id="S6.T5.2.1.7.1" style="font-size:70%;">Multithreading</span></td>
</tr>
<tr class="ltx_tr" id="S6.T5.2.2">
<td class="ltx_td ltx_border_l ltx_border_r" id="S6.T5.2.2.1" style="padding-top:-1.05pt;padding-bottom:-1.05pt;"></td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S6.T5.2.2.2" style="padding-top:-1.05pt;padding-bottom:-1.05pt;"><span class="ltx_text" id="S6.T5.2.2.2.1" style="font-size:70%;">Fills</span></td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S6.T5.2.2.3" style="padding-top:-1.05pt;padding-bottom:-1.05pt;"><span class="ltx_text" id="S6.T5.2.2.3.1" style="font-size:70%;">old packets</span></td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S6.T5.2.2.4" style="padding-top:-1.05pt;padding-bottom:-1.05pt;"><span class="ltx_text" id="S6.T5.2.2.4.1" style="font-size:70%;">to cached</span></td>
<td class="ltx_td ltx_border_r" id="S6.T5.2.2.5" style="padding-top:-1.05pt;padding-bottom:-1.05pt;"></td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S6.T5.2.2.6" style="padding-top:-1.05pt;padding-bottom:-1.05pt;"><span class="ltx_text" id="S6.T5.2.2.6.1" style="font-size:70%;">Order</span></td>
<td class="ltx_td ltx_border_r" id="S6.T5.2.2.7" style="padding-top:-1.05pt;padding-bottom:-1.05pt;"></td>
</tr>
<tr class="ltx_tr" id="S6.T5.2.3">
<td class="ltx_td ltx_align_center ltx_border_l ltx_border_r ltx_border_t" id="S6.T5.2.3.1" style="padding-top:-1.05pt;padding-bottom:-1.05pt;"><span class="ltx_text" id="S6.T5.2.3.1.1" style="font-size:70%;">Unbound</span></td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S6.T5.2.3.2" style="padding-top:-1.05pt;padding-bottom:-1.05pt;"><span class="ltx_text" id="S6.T5.2.3.2.1" style="font-size:70%;">Y</span></td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S6.T5.2.3.3" style="padding-top:-1.05pt;padding-bottom:-1.05pt;"><span class="ltx_text" id="S6.T5.2.3.3.1" style="font-size:70%;">N</span></td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S6.T5.2.3.4" style="padding-top:-1.05pt;padding-bottom:-1.05pt;"><span class="ltx_text" id="S6.T5.2.3.4.1" style="font-size:70%;">N</span></td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S6.T5.2.3.5" style="padding-top:-1.05pt;padding-bottom:-1.05pt;"><span class="ltx_text" id="S6.T5.2.3.5.1" style="font-size:70%;">5</span></td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S6.T5.2.3.6" style="padding-top:-1.05pt;padding-bottom:-1.05pt;"><span class="ltx_text" id="S6.T5.2.3.6.1" style="font-size:70%;">Mesh</span></td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S6.T5.2.3.7" style="padding-top:-1.05pt;padding-bottom:-1.05pt;"><span class="ltx_text" id="S6.T5.2.3.7.1" style="font-size:70%;">Internal (L/I)</span></td>
</tr>
<tr class="ltx_tr" id="S6.T5.2.4">
<td class="ltx_td ltx_align_center ltx_border_l ltx_border_r" id="S6.T5.2.4.1" style="padding-top:-1.05pt;padding-bottom:-1.05pt;"><span class="ltx_text" id="S6.T5.2.4.1.1" style="font-size:70%;">Bind9</span></td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S6.T5.2.4.2" style="padding-top:-1.05pt;padding-bottom:-1.05pt;"><span class="ltx_text" id="S6.T5.2.4.2.1" style="font-size:70%;">Y</span></td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S6.T5.2.4.3" style="padding-top:-1.05pt;padding-bottom:-1.05pt;"><span class="ltx_text" id="S6.T5.2.4.3.1" style="font-size:70%;">N</span></td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S6.T5.2.4.4" style="padding-top:-1.05pt;padding-bottom:-1.05pt;"><span class="ltx_text" id="S6.T5.2.4.4.1" style="font-size:70%;">N</span></td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S6.T5.2.4.5" style="padding-top:-1.05pt;padding-bottom:-1.05pt;"><span class="ltx_text" id="S6.T5.2.4.5.1" style="font-size:70%;">0</span></td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S6.T5.2.4.6" style="padding-top:-1.05pt;padding-bottom:-1.05pt;"><span class="ltx_text" id="S6.T5.2.4.6.1" style="font-size:70%;">Mesh</span></td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S6.T5.2.4.7" style="padding-top:-1.05pt;padding-bottom:-1.05pt;"><span class="ltx_text" id="S6.T5.2.4.7.1" style="font-size:70%;">Internal (L/I)</span></td>
</tr>
<tr class="ltx_tr" id="S6.T5.2.5">
<td class="ltx_td ltx_align_center ltx_border_l ltx_border_r" id="S6.T5.2.5.1" style="padding-top:-1.05pt;padding-bottom:-1.05pt;"><span class="ltx_text" id="S6.T5.2.5.1.1" style="font-size:70%;">PowerDNS</span></td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S6.T5.2.5.2" style="padding-top:-1.05pt;padding-bottom:-1.05pt;"><span class="ltx_text" id="S6.T5.2.5.2.1" style="font-size:70%;">Y</span></td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S6.T5.2.5.3" style="padding-top:-1.05pt;padding-bottom:-1.05pt;"><span class="ltx_text" id="S6.T5.2.5.3.1" style="font-size:70%;">Y</span></td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S6.T5.2.5.4" style="padding-top:-1.05pt;padding-bottom:-1.05pt;"><span class="ltx_text" id="S6.T5.2.5.4.1" style="font-size:70%;">N</span></td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S6.T5.2.5.5" style="padding-top:-1.05pt;padding-bottom:-1.05pt;"><span class="ltx_text" id="S6.T5.2.5.5.1" style="font-size:70%;">0</span></td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S6.T5.2.5.6" style="padding-top:-1.05pt;padding-bottom:-1.05pt;"><span class="ltx_text" id="S6.T5.2.5.6.1" style="font-size:70%;">Mesh</span></td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S6.T5.2.5.7" style="padding-top:-1.05pt;padding-bottom:-1.05pt;"><span class="ltx_text" id="S6.T5.2.5.7.1" style="font-size:70%;">Internal (L/I)</span></td>
</tr>
<tr class="ltx_tr" id="S6.T5.2.6">
<td class="ltx_td ltx_align_center ltx_border_l ltx_border_r" id="S6.T5.2.6.1" style="padding-top:-1.05pt;padding-bottom:-1.05pt;"><span class="ltx_text" id="S6.T5.2.6.1.1" style="font-size:70%;">Knot</span></td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S6.T5.2.6.2" style="padding-top:-1.05pt;padding-bottom:-1.05pt;"><span class="ltx_text" id="S6.T5.2.6.2.1" style="font-size:70%;">Y</span></td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S6.T5.2.6.3" style="padding-top:-1.05pt;padding-bottom:-1.05pt;"><span class="ltx_text" id="S6.T5.2.6.3.1" style="font-size:70%;">N</span></td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S6.T5.2.6.4" style="padding-top:-1.05pt;padding-bottom:-1.05pt;"><span class="ltx_text" id="S6.T5.2.6.4.1" style="font-size:70%;">N</span></td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S6.T5.2.6.5" style="padding-top:-1.05pt;padding-bottom:-1.05pt;"><span class="ltx_text" id="S6.T5.2.6.5.1" style="font-size:70%;">0</span></td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S6.T5.2.6.6" style="padding-top:-1.05pt;padding-bottom:-1.05pt;"><span class="ltx_text" id="S6.T5.2.6.6.1" style="font-size:70%;">Seq.</span></td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S6.T5.2.6.7" style="padding-top:-1.05pt;padding-bottom:-1.05pt;"><span class="ltx_text" id="S6.T5.2.6.7.1" style="font-size:70%;">OS (L/I)</span></td>
</tr>
<tr class="ltx_tr" id="S6.T5.2.7">
<td class="ltx_td ltx_align_center ltx_border_l ltx_border_r" id="S6.T5.2.7.1" style="padding-top:-1.05pt;padding-bottom:-1.05pt;"><span class="ltx_text" id="S6.T5.2.7.1.1" style="font-size:70%;">Stubby</span></td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S6.T5.2.7.2" style="padding-top:-1.05pt;padding-bottom:-1.05pt;"><span class="ltx_text" id="S6.T5.2.7.2.1" style="font-size:70%;">Y</span></td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S6.T5.2.7.3" style="padding-top:-1.05pt;padding-bottom:-1.05pt;"><span class="ltx_text" id="S6.T5.2.7.3.1" style="font-size:70%;">N</span></td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S6.T5.2.7.4" style="padding-top:-1.05pt;padding-bottom:-1.05pt;"><span class="ltx_text" id="S6.T5.2.7.4.1" style="font-size:70%;">N</span></td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S6.T5.2.7.5" style="padding-top:-1.05pt;padding-bottom:-1.05pt;"><span class="ltx_text" id="S6.T5.2.7.5.1" style="font-size:70%;">0</span></td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S6.T5.2.7.6" style="padding-top:-1.05pt;padding-bottom:-1.05pt;"><span class="ltx_text" id="S6.T5.2.7.6.1" style="font-size:70%;">Mesh</span></td>
<td class="ltx_td ltx_align_center ltx_border_r" id="S6.T5.2.7.7" style="padding-top:-1.05pt;padding-bottom:-1.05pt;"><span class="ltx_text" id="S6.T5.2.7.7.1" style="font-size:70%;">OS (L/I)</span></td>
</tr>
<tr class="ltx_tr" id="S6.T5.2.8">
<td class="ltx_td ltx_align_center ltx_border_b ltx_border_l ltx_border_r" id="S6.T5.2.8.1" style="padding-top:-1.05pt;padding-bottom:-1.05pt;"><span class="ltx_text" id="S6.T5.2.8.1.1" style="font-size:70%;">Akamai</span></td>
<td class="ltx_td ltx_align_center ltx_border_b ltx_border_r" id="S6.T5.2.8.2" style="padding-top:-1.05pt;padding-bottom:-1.05pt;"><span class="ltx_text" id="S6.T5.2.8.2.1" style="font-size:70%;">N</span></td>
<td class="ltx_td ltx_align_center ltx_border_b ltx_border_r" id="S6.T5.2.8.3" style="padding-top:-1.05pt;padding-bottom:-1.05pt;"><span class="ltx_text" id="S6.T5.2.8.3.1" style="font-size:70%;">N</span></td>
<td class="ltx_td ltx_align_center ltx_border_b ltx_border_r" id="S6.T5.2.8.4" style="padding-top:-1.05pt;padding-bottom:-1.05pt;"><span class="ltx_text" id="S6.T5.2.8.4.1" style="font-size:70%;">Y</span></td>
<td class="ltx_td ltx_align_center ltx_border_b ltx_border_r" id="S6.T5.2.8.5" style="padding-top:-1.05pt;padding-bottom:-1.05pt;"><span class="ltx_text" id="S6.T5.2.8.5.1" style="font-size:70%;">0</span></td>
<td class="ltx_td ltx_align_center ltx_border_b ltx_border_r" id="S6.T5.2.8.6" style="padding-top:-1.05pt;padding-bottom:-1.05pt;"><span class="ltx_text" id="S6.T5.2.8.6.1" style="font-size:70%;">Mesh</span></td>
<td class="ltx_td ltx_align_center ltx_border_b ltx_border_r" id="S6.T5.2.8.7" style="padding-top:-1.05pt;padding-bottom:-1.05pt;"><span class="ltx_text" id="S6.T5.2.8.7.1" style="font-size:70%;">Internal (L/D)</span></td>
</tr>
</table>
</div>
</div>
<figcaption class="ltx_caption ltx_centering" style="font-size:70%;"><span class="ltx_tag ltx_tag_table"><span class="ltx_text" id="S6.T5.5.1.1" style="font-size:129%;">Table 5</span>. </span><span class="ltx_text" id="S6.T5.6.2" style="font-size:129%;">Components in resolvers.</span></figcaption><div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_1">
<p class="ltx_p ltx_figure_panel ltx_align_center" id="S6.T5.7"><span class="ltx_text" id="S6.T5.7.1" style="font-size:70%;">L/I: Load-Independent, L/D: Load-Dependent</span></p>
</div>
</div>
</figure>
</section>
<section class="ltx_subsection" id="S6.SS6">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">6.6. </span>Multi-Threading</h3>
<div class="ltx_para" id="S6.SS6.p1">
<p class="ltx_p" id="S6.SS6.p1.1">Multi-threading is supported by all major DNS resolvers and influences how KeyTrap attacks affects their response behavior. To investigate the influence of multi-threading, we set up all resolvers with multi-threading enabled. Figure <a class="ltx_ref" href="https://arxiv.org/html/2406.03133v1#S6.F6" title="Figure 6 ‣ 6.6. Multi-Threading ‣ 6. Evaluation of the Attacks ‣ The Harder You Try, The Harder You Fail: The KeyTrap Denial-of-Service Algorithmic Complexity Attacks on DNSSEC"><span class="ltx_text ltx_ref_tag">6</span></a> illustrates the influence of multi-threading on the attack. When using additional threads, the resolver is still able to answer to some benign requests, even while busy validating the signatures. Code review shows that the resolvers do not consider the load on a thread for scheduling, which explains why approximately half of the requests are still scheduled on a thread that is busy validating signatures. These requests are lost. Answering benign requests while validating signatures extends the duration that the resolver takes to complete validation by a short amount, in the case of Unbound by about 20s. Note that due to inherent pseudo-randomness in the scheduling of requests to the threads, and the scheduling of different threads to run by the OS, a small fluctuation of the percentage of lost requests can be observed in the graph. We observe similar fluctuations in all resolvers. We find one resolver, Cacheserve by Akamai, that does not lose parts of its traffic when multi-threading is deployed. The reason is that it considers thread load in the allocation of new requests to worker threads, leading to no lost benign requests while Cacheserve has open threads not busy validating attack signatures.</p>
</div>
<div class="ltx_para" id="S6.SS6.p2">
<p class="ltx_p" id="S6.SS6.p2.1">The attacker can circumvent the supposed protection from multi-threading by sending multiple requests to the resolver. In the case of Akamai, the scheduling algorithm that considers the load of threads still allows the attacker to fill all threads with the attack. Since every new attacker request will be scheduled to a free thread, the attacker only needs to send as many attacker requests as there are threads in Cacheserve. No request will be scheduled to an already busy thread. In contrast, for all other resolvers, the success of the attack is influenced by the pseudo-random scheduling algorithm. Since allocation of requests to threads is not known to the attacker, the attacker needs to send more requests than there are threads in victim resolver to ensure all threads are hit, even if the scheduling algorithm, by chance, schedules multiple attack requests to the same thread. In the case of fully random scheduling, the average amount of attack requests needed to fill all victim threads can be calculated by
<math alttext="E=n\times\sum_{i=1}^{n}\frac{1}{i}" class="ltx_Math" display="inline" id="S6.SS6.p2.1.m1.1"><semantics id="S6.SS6.p2.1.m1.1a"><mrow id="S6.SS6.p2.1.m1.1.1" xref="S6.SS6.p2.1.m1.1.1.cmml"><mi id="S6.SS6.p2.1.m1.1.1.2" xref="S6.SS6.p2.1.m1.1.1.2.cmml">E</mi><mo id="S6.SS6.p2.1.m1.1.1.1" xref="S6.SS6.p2.1.m1.1.1.1.cmml">=</mo><mrow id="S6.SS6.p2.1.m1.1.1.3" xref="S6.SS6.p2.1.m1.1.1.3.cmml"><mi id="S6.SS6.p2.1.m1.1.1.3.2" xref="S6.SS6.p2.1.m1.1.1.3.2.cmml">n</mi><mo id="S6.SS6.p2.1.m1.1.1.3.1" lspace="0.222em" rspace="0.055em" xref="S6.SS6.p2.1.m1.1.1.3.1.cmml">×</mo><mrow id="S6.SS6.p2.1.m1.1.1.3.3" xref="S6.SS6.p2.1.m1.1.1.3.3.cmml"><msubsup id="S6.SS6.p2.1.m1.1.1.3.3.1" xref="S6.SS6.p2.1.m1.1.1.3.3.1.cmml"><mo id="S6.SS6.p2.1.m1.1.1.3.3.1.2.2" xref="S6.SS6.p2.1.m1.1.1.3.3.1.2.2.cmml">∑</mo><mrow id="S6.SS6.p2.1.m1.1.1.3.3.1.2.3" xref="S6.SS6.p2.1.m1.1.1.3.3.1.2.3.cmml"><mi id="S6.SS6.p2.1.m1.1.1.3.3.1.2.3.2" xref="S6.SS6.p2.1.m1.1.1.3.3.1.2.3.2.cmml">i</mi><mo id="S6.SS6.p2.1.m1.1.1.3.3.1.2.3.1" xref="S6.SS6.p2.1.m1.1.1.3.3.1.2.3.1.cmml">=</mo><mn id="S6.SS6.p2.1.m1.1.1.3.3.1.2.3.3" xref="S6.SS6.p2.1.m1.1.1.3.3.1.2.3.3.cmml">1</mn></mrow><mi id="S6.SS6.p2.1.m1.1.1.3.3.1.3" xref="S6.SS6.p2.1.m1.1.1.3.3.1.3.cmml">n</mi></msubsup><mfrac id="S6.SS6.p2.1.m1.1.1.3.3.2" xref="S6.SS6.p2.1.m1.1.1.3.3.2.cmml"><mn id="S6.SS6.p2.1.m1.1.1.3.3.2.2" xref="S6.SS6.p2.1.m1.1.1.3.3.2.2.cmml">1</mn><mi id="S6.SS6.p2.1.m1.1.1.3.3.2.3" xref="S6.SS6.p2.1.m1.1.1.3.3.2.3.cmml">i</mi></mfrac></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S6.SS6.p2.1.m1.1b"><apply id="S6.SS6.p2.1.m1.1.1.cmml" xref="S6.SS6.p2.1.m1.1.1"><eq id="S6.SS6.p2.1.m1.1.1.1.cmml" xref="S6.SS6.p2.1.m1.1.1.1"></eq><ci id="S6.SS6.p2.1.m1.1.1.2.cmml" xref="S6.SS6.p2.1.m1.1.1.2">𝐸</ci><apply id="S6.SS6.p2.1.m1.1.1.3.cmml" xref="S6.SS6.p2.1.m1.1.1.3"><times id="S6.SS6.p2.1.m1.1.1.3.1.cmml" xref="S6.SS6.p2.1.m1.1.1.3.1"></times><ci id="S6.SS6.p2.1.m1.1.1.3.2.cmml" xref="S6.SS6.p2.1.m1.1.1.3.2">𝑛</ci><apply id="S6.SS6.p2.1.m1.1.1.3.3.cmml" xref="S6.SS6.p2.1.m1.1.1.3.3"><apply id="S6.SS6.p2.1.m1.1.1.3.3.1.cmml" xref="S6.SS6.p2.1.m1.1.1.3.3.1"><csymbol cd="ambiguous" id="S6.SS6.p2.1.m1.1.1.3.3.1.1.cmml" xref="S6.SS6.p2.1.m1.1.1.3.3.1">superscript</csymbol><apply id="S6.SS6.p2.1.m1.1.1.3.3.1.2.cmml" xref="S6.SS6.p2.1.m1.1.1.3.3.1"><csymbol cd="ambiguous" id="S6.SS6.p2.1.m1.1.1.3.3.1.2.1.cmml" xref="S6.SS6.p2.1.m1.1.1.3.3.1">subscript</csymbol><sum id="S6.SS6.p2.1.m1.1.1.3.3.1.2.2.cmml" xref="S6.SS6.p2.1.m1.1.1.3.3.1.2.2"></sum><apply id="S6.SS6.p2.1.m1.1.1.3.3.1.2.3.cmml" xref="S6.SS6.p2.1.m1.1.1.3.3.1.2.3"><eq id="S6.SS6.p2.1.m1.1.1.3.3.1.2.3.1.cmml" xref="S6.SS6.p2.1.m1.1.1.3.3.1.2.3.1"></eq><ci id="S6.SS6.p2.1.m1.1.1.3.3.1.2.3.2.cmml" xref="S6.SS6.p2.1.m1.1.1.3.3.1.2.3.2">𝑖</ci><cn id="S6.SS6.p2.1.m1.1.1.3.3.1.2.3.3.cmml" type="integer" xref="S6.SS6.p2.1.m1.1.1.3.3.1.2.3.3">1</cn></apply></apply><ci id="S6.SS6.p2.1.m1.1.1.3.3.1.3.cmml" xref="S6.SS6.p2.1.m1.1.1.3.3.1.3">𝑛</ci></apply><apply id="S6.SS6.p2.1.m1.1.1.3.3.2.cmml" xref="S6.SS6.p2.1.m1.1.1.3.3.2"><divide id="S6.SS6.p2.1.m1.1.1.3.3.2.1.cmml" xref="S6.SS6.p2.1.m1.1.1.3.3.2"></divide><cn id="S6.SS6.p2.1.m1.1.1.3.3.2.2.cmml" type="integer" xref="S6.SS6.p2.1.m1.1.1.3.3.2.2">1</cn><ci id="S6.SS6.p2.1.m1.1.1.3.3.2.3.cmml" xref="S6.SS6.p2.1.m1.1.1.3.3.2.3">𝑖</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S6.SS6.p2.1.m1.1c">E=n\times\sum_{i=1}^{n}\frac{1}{i}</annotation><annotation encoding="application/x-llamapun" id="S6.SS6.p2.1.m1.1d">italic_E = italic_n × ∑ start_POSTSUBSCRIPT italic_i = 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_n end_POSTSUPERSCRIPT divide start_ARG 1 end_ARG start_ARG italic_i end_ARG</annotation></semantics></math> where n is the number of threads in the resolver. Since schedulers are usually optimized to distribute systematically to the threads, the real world average number of requests required to hit all threads will generally be lower than the random value. The effect of sending multiple queries can be seen in Figure <a class="ltx_ref" href="https://arxiv.org/html/2406.03133v1#S6.F8" title="Figure 8 ‣ 6.6. Multi-Threading ‣ 6. Evaluation of the Attacks ‣ The Harder You Try, The Harder You Fail: The KeyTrap Denial-of-Service Algorithmic Complexity Attacks on DNSSEC"><span class="ltx_text ltx_ref_tag">8</span></a>. The graph shows a scenario where the attacker sends five attacker requests to an instance of Unbound running with five worker threads on five CPU cores. As seen in the graph, the five requests do not suffice to saturate the threads, as one threads remains active in replying to benign queries, leading to approximately 80% lost requests. The fact that two attacker requests were scheduled to the same thread can be observed in the second half of the plot. While the validation finishes in three threads, reducing the rate of lost requests by 60%, one thread continues validating signatures for almost twice as long, indicating that two requests were scheduled to a single thread.</p>
</div>
<div class="ltx_para" id="S6.SS6.p3">
<p class="ltx_p" id="S6.SS6.p3.1">These observations show that multi-threading is no sufficient protection against the attack, as the attacker, when sending a sufficient amount of attack requests, can hit all threads of the resolver, leading to a comprehensive DoS of the resolver. It also illustrates that one attack request is not sufficient for a complete DoS of the resolver when multi-threading is used.</p>
</div>
<figure class="ltx_figure" id="S6.F6"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="135" id="S6.F6.g1" src="extracted/5645199/figures/multithreading_unbound_updated.png" width="538"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span class="ltx_text" id="S6.F6.2.1.1" style="font-size:90%;">Figure 6</span>. </span><span class="ltx_text" id="S6.F6.3.2" style="font-size:90%;">KeyTrap attack on Unbound with 1 request and 2 threads.</span></figcaption>
</figure>
<figure class="ltx_figure" id="S6.F7"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="135" id="S6.F7.g1" src="extracted/5645199/figures/unbound_lost_req_updated.png" width="538"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span class="ltx_text" id="S6.F7.2.1.1" style="font-size:90%;">Figure 7</span>. </span><span class="ltx_text" id="S6.F7.3.2" style="font-size:90%;">Impact on benign requests in Unbound under attack.</span></figcaption>
</figure>
<figure class="ltx_figure" id="S6.F8"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="135" id="S6.F8.g1" src="extracted/5645199/figures/unbound_mt_5_updated.png" width="538"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span class="ltx_text" id="S6.F8.2.1.1" style="font-size:90%;">Figure 8</span>. </span><span class="ltx_text" id="S6.F8.3.2" style="font-size:90%;">KeyTrap attack on Unbound with 5 requests and 5 threads.</span></figcaption>
</figure>
</section>
<section class="ltx_subsection" id="S6.SS7">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">6.7. </span>Cached Entries</h3>
<div class="ltx_para" id="S6.SS7.p1">
<p class="ltx_p" id="S6.SS7.p1.1">DNS resolvers implement a cache to answer recently requested entries without recursive resolution. This greatly improves efficiency of the resolver, as certain domains are requested more frequently, like domains of commonly used websites. However, since all the resolvers, except CacheServe, handle replies to cached entries on the same thread as recursive resolution and validation, caching does not mitigate the attack.
In contrast, since CacheServe implements a separate thread for answering cached entries, the effect of the attack is partially mitigated.</p>
</div>
</section>
<section class="ltx_subsection" id="S6.SS8">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">6.8. </span>Continuous KeySigTrap Attack</h3>
<div class="ltx_para" id="S6.SS8.p1">
<p class="ltx_p" id="S6.SS8.p1.1">Using the insights gained from the previous sections, we construct a continuous attack on resolvers. In the initial phase of the attack, the attacker sends multiple KeySigTrap requests simultaneously. Sending multiple requests ensures that the resolver gets stalled for a substantial amount of time and, in the case of multi-threading, all threads get hit with an attack and are busy validating signatures. The DNS implementations we tested in this work use 2-6 resolution threads, depending on the resolver and the size of the deployment. Creating a real-world scenario, we thus evaluate our continuous attack on an Unbound instance running with 4 resolution threads.</p>
</div>
<div class="ltx_para" id="S6.SS8.p2">
<p class="ltx_p" id="S6.SS8.p2.1">The requests should be timed in such a way that new requests are always already in the buffer once a request from the previous batch finishes. Using the validation time of a single attack request in Unbound, not considering re-tries, we find a single request approximately stalls a thread for about 176s (see Table <a class="ltx_ref" href="https://arxiv.org/html/2406.03133v1#S6.T4" title="Table 4 ‣ 6.3. Effectiveness of the Attacks ‣ 6. Evaluation of the Attacks ‣ The Harder You Try, The Harder You Fail: The KeyTrap Denial-of-Service Algorithmic Complexity Attacks on DNSSEC"><span class="ltx_text ltx_ref_tag">4</span></a>). We choose an interval half of this duration. We further send 12, three requests per thread of the resolver, to ensure all validation threads are hit with the attack.
The attack uses the following steps:</p>
</div>
<div class="ltx_para" id="S6.SS8.p3">
<pre class="ltx_verbatim ltx_font_typewriter" id="S6.SS8.p3.1" style="font-size:70%;">
1. Send a batch of 12 initial attack requests
2. Wait 1s to ensure the batch has been read
3. Send a batch of 12 follow-up attack request + a buffer filler
4. Wait 90s
5. Go back to 3.
</pre>
</div>
<div class="ltx_para" id="S6.SS8.p4">
<p class="ltx_p" id="S6.SS8.p4.1">The result of this attack is plotted in Figure <a class="ltx_ref" href="https://arxiv.org/html/2406.03133v1#S6.F9" title="Figure 9 ‣ 6.8. Continuous KeySigTrap Attack ‣ 6. Evaluation of the Attacks ‣ The Harder You Try, The Harder You Fail: The KeyTrap Denial-of-Service Algorithmic Complexity Attacks on DNSSEC"><span class="ltx_text ltx_ref_tag">9</span></a>. The attack achieves a complete DoS of the resolver for the entire 2h measurement duration, with 99.999% of benign requests lost. All 4 processor cores continuously run on 100% CPU utilization, validating the signatures. The attacker only requires traffic of 13 request per 90s, i.e., on average one request every 6.9s. This attack rate is low enough to prevent any rate-limiting mechanisms from blocking follow up attacker requests in a real-world setting.</p>
</div>
<div class="ltx_para" id="S6.SS8.p5">
<p class="ltx_p" id="S6.SS8.p5.1">This evaluation demonstrates that KeySigTrap is a practical attack, achieving a continuous DoS even on a multi-threaded resolver. Even a small-scale attacker can exploit KeySigTrap to fully stall DNS resolution in the resolver for other clients for an indefinite amount of time.</p>
</div>
<figure class="ltx_figure" id="S6.F9"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="114" id="S6.F9.g1" src="extracted/5645199/figures/unbound_2h.png" width="419"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span class="ltx_text" id="S6.F9.2.1.1" style="font-size:90%;">Figure 9</span>. </span><span class="ltx_text" id="S6.F9.3.2" style="font-size:90%;">Continuous KeyTrap attack on 4-threaded Unbound.</span></figcaption>
</figure>
</section>
</section>
<section class="ltx_section" id="S7">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">7. </span>The Path to Mitigations</h2>
<div class="ltx_para" id="S7.p1">
<p class="ltx_p" id="S7.p1.1">The detrimental impact of KeyTrap attacks if exploited in the wild on vulnerable resolvers necessitated patches before the flaws and our attack methodologies become public. We have thus been closely working with the developers of DNS resolvers since November 2, 2023 on developing mitigations against our attacks. We initiated the disclosure process on November 2. 2023, following which a group was formed of 31 participants, consisting of vendors of DNS software, operators of DNS/Cloud/CDN, and IETF experts. The group communicates over a closed DNS OARC channel established for disclosure and mitigations of our attacks. We describe the timeline of disclosure and mitigations in Figure <a class="ltx_ref" href="https://arxiv.org/html/2406.03133v1#S7.F10" title="Figure 10 ‣ 7. The Path to Mitigations ‣ The Harder You Try, The Harder You Fail: The KeyTrap Denial-of-Service Algorithmic Complexity Attacks on DNSSEC"><span class="ltx_text ltx_ref_tag">10</span></a>.</p>
</div>
<div class="ltx_para" id="S7.p2">
<p class="ltx_p" id="S7.p2.1">The immediate short-term recommendations to mitigate an ongoing attack are to disable DNSSEC or to serve stale data. Serving stale data to improve DNS resiliency was proposed in [RFC8767]. Vendors that decide to implement this should make sure to return stale data from a separate thread, not the one that also does the DNSSEC validation, otherwise the resolvers remain stalled. Disabling DNSSEC validation in resolvers would help remediate an ongoing attack.
However, this would also expose clients and resolvers to threats from DNS cache poisoning. Worse, an adversary could abuse this fallback to insecure mode as means to downgrade the DNSSEC protection.</p>
</div>
<div class="ltx_para" id="S7.p3">
<p class="ltx_p" id="S7.p3.1">We worked with the DNS developers to integrate systematic mitigations into their software. In the following, we describe the succession of proposed patches, showing how we evaluated and circumvented their protection against KeyTrap. The process illustrates the challenges in mitigating such powerful attacks as KeyTrap attacks and variants of it. We also present the first working solution that will be published, in variations, as patches for all major DNS resolvers. The operators of the open DNS resolvers have already deployed patches. The releases of patches for DNS software have been scheduled by the different vendors to be deployed between end of January and beginning of February. It is important to note that these patches all disobey the Internet standard in certain aspects, including the number of validations they are willing to do, to protected against the flaws within the standard.</p>
</div>
<figure class="ltx_figure" id="S7.F10"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="314" id="S7.F10.g1" src="extracted/5645199/figures/timeline_updated.jpg" width="598"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span class="ltx_text" id="S7.F10.2.1.1" style="font-size:90%;">Figure 10</span>. </span><span class="ltx_text" id="S7.F10.3.2" style="font-size:90%;">Disclosure and patch/break/fix timeline.</span></figcaption>
</figure>
<section class="ltx_subsection" id="S7.SS1">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">7.1. </span>Patch-Break-Fix DNSSEC</h3>
<div class="ltx_para" id="S7.SS1.p1">
<p class="ltx_p" id="S7.SS1.p1.1">Agreeing on which patches to deploy required a number of iterations. The developers did not want to make substantial changes, and rather aimed at patches that would mitigate the attacks with minimal changes. This is understandable, since complex patches required more extensive testing over longer time periods to confirm that they do not introduce new flaws, are interoperable with other mechanisms, and do not incur failures in the wild. Nevertheless, developing quick patches turned into a lengthy iterative process, during which the vendors developed patches that we broke, which were subsequently fixed, following with new patches. We illustrate the timeline of the disclosure and the patch-break-fix iterations with the vendors in Figure <a class="ltx_ref" href="https://arxiv.org/html/2406.03133v1#S7.F10" title="Figure 10 ‣ 7. The Path to Mitigations ‣ The Harder You Try, The Harder You Fail: The KeyTrap Denial-of-Service Algorithmic Complexity Attacks on DNSSEC"><span class="ltx_text ltx_ref_tag">10</span></a>. We next explain the patches and our attacks against them.</p>
</div>
<div class="ltx_para" id="S7.SS1.p2">
<p class="ltx_p" id="S7.SS1.p2.1"><span class="ltx_text ltx_font_bold" id="S7.SS1.p2.1.1">Limiting failures.</span> The initial “immediate” mitigation was to limit the maximum amount of validation failures per resolution. It was first implemented by Akamai, with a limit of 32 on the number of failed validations, then Bind9, which limited the failures to 0 and Unbound, with a limit of 16 failures. We found the limitation not to be an effective mitigation against our attacks. If each query is limited in the number of failures it is allowed to result in, the failures can be spread across multiple queries. To demonstrate this, we extended the KeyTrap attack (presented in §<a class="ltx_ref" href="https://arxiv.org/html/2406.03133v1#S5.SS5" title="5.5. KeySigTrap (Many Keys x Many Signatures) ‣ 5. Resource Exhaustion Attacks ‣ The Harder You Try, The Harder You Fail: The KeyTrap Denial-of-Service Algorithmic Complexity Attacks on DNSSEC"><span class="ltx_text ltx_ref_tag">5.5</span></a>) so that the signature validations are distributed across multiple queries, such that each query causes the resolver to perform 32 signature validations. Thus instead of creating multiple validations with a single query we sent multiple queries. In a setup with Akamai DNS resolver instance, 150 requests per second cause the CPU to get stalled. This showed that the limit of 32 was not strict enough.</p>
</div>
<div class="ltx_para" id="S7.SS1.p3">
<p class="ltx_p" id="S7.SS1.p3.1"><span class="ltx_text ltx_font_bold" id="S7.SS1.p3.1.1">Zero failures.</span> The strictest patch on the cryptographic failures was implemented by Bind9, returning SERVFAIL after a single cryptographic failure, hence removing the need to check for collisions at all. Although allowing 0 failed validations prevents the KeyTrap attack, it does not mitigate hash collision attack with HashTrap (§<a class="ltx_ref" href="https://arxiv.org/html/2406.03133v1#S5.SS6" title="5.6. HashTrap (Many Keys x Many Hashes) ‣ 5. Resource Exhaustion Attacks ‣ The Harder You Try, The Harder You Fail: The KeyTrap Denial-of-Service Algorithmic Complexity Attacks on DNSSEC"><span class="ltx_text ltx_ref_tag">5.6</span></a>).
HashTrap causes the resolver to perform a very large amount of hash calculations. Experimentally, using 10 requests per second, we showed that HashTrap inflicts DoS on the patched instance of Bind9 resolver. The evaluation is plotted in Figure <a class="ltx_ref" href="https://arxiv.org/html/2406.03133v1#S7.F11" title="Figure 11 ‣ 7.1. Patch-Break-Fix DNSSEC ‣ 7. The Path to Mitigations ‣ The Harder You Try, The Harder You Fail: The KeyTrap Denial-of-Service Algorithmic Complexity Attacks on DNSSEC"><span class="ltx_text ltx_ref_tag">11</span></a>: As can be seen, during the attack against the patched Bind9 instance more than 72% of benign requests are lost. We observe that most benign requests get dropped.
This variant of the attack shows that merely limiting the amount of signature validation failures is not a resilient mitigation against our DoS attacks.</p>
</div>
<figure class="ltx_figure" id="S7.F11"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="135" id="S7.F11.g1" src="extracted/5645199/figures/ds_bind_0_crypto_updated.png" width="538"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span class="ltx_text" id="S7.F11.2.1.1" style="font-size:90%;">Figure 11</span>. </span><span class="ltx_text" id="S7.F11.3.2" style="font-size:90%;">HashTrap attack on patched Bind9 with 10req/s.</span></figcaption>
</figure>
<div class="ltx_para" id="S7.SS1.p4">
<p class="ltx_p" id="S7.SS1.p4.1"><span class="ltx_text ltx_font_bold" id="S7.SS1.p4.1.1">Limiting key collisions.</span>
A patch by Akamai, in addition to limiting the signature validation failures, also limited the key tag collisions in DNS responses to contain at most 4 keys with colliding tags. We find that limiting key tag collisions to 4 will not impact normal operation of the resolver. Using data from the Tranco Top1M domains, we find experimentally that only two zones have colliding DNSKEYS, with no zone using more than two colliding keys.</p>
</div>
<div class="ltx_para" id="S7.SS1.p5">
<p class="ltx_p" id="S7.SS1.p5.1">Limiting key tag collisions proved successful in protecting against HashTrap.
The combination of both patches was nevertheless still vulnerable to a variant of the SigJam attack (§<a class="ltx_ref" href="https://arxiv.org/html/2406.03133v1#S5.SS3" title="5.3. SigJam (One Key x Many Signatures) ‣ 5. Resource Exhaustion Attacks ‣ The Harder You Try, The Harder You Fail: The KeyTrap Denial-of-Service Algorithmic Complexity Attacks on DNSSEC"><span class="ltx_text ltx_ref_tag">5.3</span></a>). The attack works with a single DNSSEC key and many signatures, but requires no signature validation failures, thereby circumventing the protection offered by the patch.
We use ANY type responses, which contain many different record sets, each signed with a different signature.
We can create arbitrary numbers of different record sets, so that on the one hand the number of signatures is maximized, and on the other hand, the response still fits into one DNS packet.
<span class="ltx_text" id="S7.SS1.p5.1.1" style="color:#000000;">We vary over the type number field on an A-type record to create a large number of small, unallocated-type record sets, each covered by an individual, valid signature.
In our tests with standard DNS software, we created DNS responses with 313 different record sets.
Following [RFC6840] §4.2 the resolver <span class="ltx_text ltx_font_sansserif" id="S7.SS1.p5.1.1.1">MUST</span> validate the signatures on all the record sets.</span>
Since all signatures are valid, the resolver does not fail from the imposed limit on validation failures and instead continues the validation until all signatures on the unallocated-type records have been checked. We found this attack to be effective against all patches that limit cryptographic failures. The success of the attack on a patched Akamai is illustrated in Figure <a class="ltx_ref" href="https://arxiv.org/html/2406.03133v1#S7.F12" title="Figure 12 ‣ 7.1. Patch-Break-Fix DNSSEC ‣ 7. The Path to Mitigations ‣ The Harder You Try, The Harder You Fail: The KeyTrap Denial-of-Service Algorithmic Complexity Attacks on DNSSEC"><span class="ltx_text ltx_ref_tag">12</span></a>. In the evaluation, the attacker sends 4 ANY type requests per second, a rate at which the attacker is able to completely DoS the resolver after a few seconds. Running the attack for 60s, we were able to achieve over 90% lost benign queries. The attack can thus DoS the resolver, circumventing the patch. The attack that exploits ANY type records illustrates that limiting only the cryptographic failures is not a sufficient mitigation against the complexity attacks.</p>
</div>
<figure class="ltx_figure" id="S7.F12"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="135" id="S7.F12.g1" src="extracted/5645199/figures/any_type_cacheserve_updated.png" width="538"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span class="ltx_text" id="S7.F12.2.1.1" style="font-size:90%;">Figure 12</span>. </span><span class="ltx_text" id="S7.F12.3.2" style="font-size:90%;">ANY-type derivation of SigJam on Akamai.</span></figcaption>
</figure>
<div class="ltx_para" id="S7.SS1.p6">
<p class="ltx_p" id="S7.SS1.p6.1"><span class="ltx_text ltx_font_bold" id="S7.SS1.p6.1.1">Limiting all validations.</span>
The first working patch capable of protecting against all variants of our attack was implemented by Akamai. Additionally to limiting key collisions to 4, and limiting cryptographic failures to 16, the patch also limits total validations in ANY requests to 8. Evaluating the efficacy of the patch, we find the patched resolver does not lose any benign request even under attack with ¿ 10 requests per second. Illustrated in Figure <a class="ltx_ref" href="https://arxiv.org/html/2406.03133v1#S7.F13" title="Figure 13 ‣ 7.1. Patch-Break-Fix DNSSEC ‣ 7. The Path to Mitigations ‣ The Harder You Try, The Harder You Fail: The KeyTrap Denial-of-Service Algorithmic Complexity Attacks on DNSSEC"><span class="ltx_text ltx_ref_tag">13</span></a>, the load on the resolver does not increase to problematic levels under the ANY type attack with 10 req/s, and the resolver does not lose any benign traffic. It thus appears that the patch successfully protects against all variations of KeyTrap attacks. Nevertheless, although these patches prevent packet loss, they still do not fully mitigate the increase in CPU instruction load during the attack.
The reason that the mitigations do not fully prevent the effects of the KeyTrap attacks is rooted in the design philosophy of DNSSEC. <span class="ltx_text" id="S7.SS1.p6.1.2" style="color:#000000;">For example, we find that in a patched Unbound, an attacker request can still displace the processing equivalent of 8 benign requests under full load.</span> Notice however that we are still closely working with the developers on testing the patches and their performance during attack and during normal operation.</p>
</div>
<figure class="ltx_figure" id="S7.F13"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="135" id="S7.F13.g1" src="extracted/5645199/figures/cacheserver_mitigation_updated.png" width="538"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span class="ltx_text" id="S7.F13.2.1.1" style="font-size:90%;">Figure 13</span>. </span><span class="ltx_text" id="S7.F13.3.2" style="font-size:90%;">ANY type attack with 10req/s on patched Akamai.</span></figcaption>
</figure>
</section>
<section class="ltx_subsection" id="S7.SS2">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">7.2. </span>Improving Resilience of Architecture</h3>
<div class="ltx_para" id="S7.SS2.p1">
<p class="ltx_p" id="S7.SS2.p1.1">To understand the impact of the attacks on various DNS functionality, including caching, pending DNS requests or inbound DNS packets from the clients as well as from the nameservers, we perform code analysis and evaluations. Our observations from the analyses can be used to enhance the robustness to failures and attacks of implementations:</p>
</div>
<div class="ltx_para" id="S7.SS2.p2">
<p class="ltx_p" id="S7.SS2.p2.1"><span class="ltx_text ltx_font_bold" id="S7.SS2.p2.1.1">Multi-threading.</span> Using code analysis and experimental evaluation of the multi-threading architecture of the DNS implementations, we find that load of processes is generally not considered in scheduling new DNS requests, leading to substantial loss of requests even if not all threads of a resolver are busy. Further, we find resolvers do not consider the computational effort of a given request, leading to loss of benign requests, if a single request creates a large load on the resolver. We contribute the architectural recommendation that resolvers should de-prioritize DNS requests that cause substantial computational load, allowing the resolver to still answer benign clients even under attacks. <span class="ltx_text" id="S7.SS2.p2.1.2" style="color:#000000;">This de-prioritization is in line with previous work recommendations on mitigations of complexity attacks, like presented by Atre et al. <cite class="ltx_cite ltx_citemacro_citep">(<a class="ltx_ref" href="https://arxiv.org/html/2406.03133v1#bib.bib3" title="">atre2022surgeprotector, </a>)</cite>.</span></p>
</div>
<div class="ltx_para" id="S7.SS2.p3">
<p class="ltx_p" id="S7.SS2.p3.1"><span class="ltx_text ltx_font_bold" id="S7.SS2.p3.1.1">OS buffers.</span> We find that the resolvers generally only deplete the OS UDP buffer after a batch of tasks has been finished. This causes the buffer to fill up when the resolver is busy, leading to lost benign requests. We recommend to adapt the architecture of resolvers to allocate a separate thread for reading from the OS buffer and placing pending requests in a dynamic internal buffer.</p>
</div>
<div class="ltx_para" id="S7.SS2.p4">
<p class="ltx_p" id="S7.SS2.p4.1"><span class="ltx_text ltx_font_bold" id="S7.SS2.p4.1.1">Thread for cached records.</span> Further, since many benign queries by users can be answered from cache, additionally allocating a separate thread for answering to cached entries can reduce the impact of stalling of resolution threads.</p>
</div>
</section>
<section class="ltx_subsection" id="S7.SS3">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">7.3. </span>Implementation Challenges</h3>
<div class="ltx_para" id="S7.SS3.p1">
<p class="ltx_p" id="S7.SS3.p1.1">The experience we made working with the developers on designing and evaluating the patches showed that the vulnerabilities we found were challenging to patch. We not only showed that patches could be circumvented with different variants of our attack, but also discovered problems in the implementations themselves.
We provide here examples from two major implementations: Knot and Bind9. During the evaluations we found that a patch for Knot, that was supposed to limit requests to 32 failed validations per resolution, was not working as intended. While the patch reduced the number of validations resulting from a single attacker request, it did not sufficiently protect against an attacker sending multiple requests in a short time frame. With 10 attacker requests per second, the patched Knot implementation dropped over 60% of benign queries, as shown in Figure <a class="ltx_ref" href="https://arxiv.org/html/2406.03133v1#S7.F14" title="Figure 14 ‣ 7.3. Implementation Challenges ‣ 7. The Path to Mitigations ‣ The Harder You Try, The Harder You Fail: The KeyTrap Denial-of-Service Algorithmic Complexity Attacks on DNSSEC"><span class="ltx_text ltx_ref_tag">14</span></a>. We traced the bug to be a broken binding, which the developers fixed in the subsequent iterations of patches.</p>
</div>
<div class="ltx_para" id="S7.SS3.p2">
<p class="ltx_p" id="S7.SS3.p2.1">The second example is a problematic patch in Bind9. While evaluating the patch with 10 requests per second to the patched resolver, we found that after about 70s the resolver would consistently crash, causing 100% loss of benign queries. This bug was also communicated to developers and fixed in later patches.</p>
</div>
<figure class="ltx_figure" id="S7.F14"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="135" id="S7.F14.g1" src="extracted/5645199/figures/kresd_patched_hpoc_updated.png" width="538"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span class="ltx_text" id="S7.F14.2.1.1" style="font-size:90%;">Figure 14</span>. </span><span class="ltx_text" id="S7.F14.3.2" style="font-size:90%;">KeyTrap against patched Knot.</span></figcaption>
</figure>
</section>
</section>
<section class="ltx_section" id="S8">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">8. </span>Ethical Considerations</h2>
<div class="ltx_para" id="S8.p1">
<p class="ltx_p" id="S8.p1.1"><span class="ltx_text" id="S8.p1.1.1" style="color:#000000;">Due to the potentially severe impact of KeyTrap, we limited all our evaluations to a local test setup without testing the KeyTrap attack on any open, publicly accessible resolver. We disclosed the vulnerabilities we found to a closed group of experts over 3 months before they were made public through open-source patches and accompanying posts by the developers. Operators were notified about the imminent important patches with sufficient preparation time and patches were delivered to large operators ahead of time, before the vulnerability became public. We ensured quality of developed patches by continuously working with the developers, improving their patches and closing discovered flaws. From the practical perspective, current patches sufficiently protect against the impact of the attacks.</span></p>
</div>
</section>
<section class="ltx_section" id="S9">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">9. </span>Conclusions</h2>
<div class="ltx_para" id="S9.p1">
<p class="ltx_p" id="S9.p1.1">Our work revealed a fundamental design problem with DNS and DNSSEC: Strictly applying Postel’s Law to the design of DNSSEC introduced a major and devastating vulnerability in virtually all DNS implementations. With just one maliciously crafted DNS packet an attacker could stall almost any resolver, e.g., the most popular one, Bind9, for as long as 16 hours.</p>
</div>
<div class="ltx_para" id="S9.p2">
<p class="ltx_p" id="S9.p2.1">The impact of KeyTrap is far reaching. DNS evolved into a fundamental system in the Internet that underlies a wide range of applications and facilitates new and emerging technologies. Measurements by APNIC<span class="ltx_note ltx_role_footnote" id="footnote14"><sup class="ltx_note_mark">14</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">14</sup><span class="ltx_tag ltx_tag_note">14</span><a class="ltx_ref ltx_url ltx_font_typewriter" href="https://stats.labs.apnic.net/dnssec/XA" title="">https://stats.labs.apnic.net/dnssec/XA</a></span></span></span> show that in December 2023, <math alttext="31.47\%" class="ltx_Math" display="inline" id="S9.p2.1.m1.1"><semantics id="S9.p2.1.m1.1a"><mrow id="S9.p2.1.m1.1.1" xref="S9.p2.1.m1.1.1.cmml"><mn id="S9.p2.1.m1.1.1.2" xref="S9.p2.1.m1.1.1.2.cmml">31.47</mn><mo id="S9.p2.1.m1.1.1.1" xref="S9.p2.1.m1.1.1.1.cmml">%</mo></mrow><annotation-xml encoding="MathML-Content" id="S9.p2.1.m1.1b"><apply id="S9.p2.1.m1.1.1.cmml" xref="S9.p2.1.m1.1.1"><csymbol cd="latexml" id="S9.p2.1.m1.1.1.1.cmml" xref="S9.p2.1.m1.1.1.1">percent</csymbol><cn id="S9.p2.1.m1.1.1.2.cmml" type="float" xref="S9.p2.1.m1.1.1.2">31.47</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S9.p2.1.m1.1c">31.47\%</annotation><annotation encoding="application/x-llamapun" id="S9.p2.1.m1.1d">31.47 %</annotation></semantics></math> of the web clients worldwide used DNSSEC-validating resolvers.
Therefore, our KeyTrap attacks have effects not only on DNS but also on any application using it. An unavailability of DNS may not only prevent access to content but risks also disabling security mechanisms, like anti-spam defenses, Public Key Infrastructure (PKI), or even inter-domain routing security like RPKI or rover <cite class="ltx_cite ltx_citemacro_citep">(<a class="ltx_ref" href="https://arxiv.org/html/2406.03133v1#bib.bib11" title="">karim2019comprehensive, </a>; <a class="ltx_ref" href="https://arxiv.org/html/2406.03133v1#bib.bib13" title="">maurer1996modelling, </a>; <a class="ltx_ref" href="https://arxiv.org/html/2406.03133v1#bib.bib6" title="">chung2019rpki, </a>; <a class="ltx_ref" href="https://arxiv.org/html/2406.03133v1#bib.bib8" title="">gersch2013rover, </a>)</cite>.</p>
</div>
<div class="ltx_para" id="S9.p3">
<p class="ltx_p" id="S9.p3.1">Since the initial disclosure of the vulnerabilities, we have been working with all major vendors on mitigating the problems in their implementations, but it seems that completely preventing the attacks requires to fundamentally reconsider the underlying design philosophy of DNSSEC, i.e., to revise the DNSSEC standards.</p>
</div>
</section>
<section class="ltx_section" id="Sx1">
<h2 class="ltx_title ltx_title_section">Acknowledgements</h2>
<div class="ltx_para" id="Sx1.p1">
<p class="ltx_p" id="Sx1.p1.1">This work has been co-funded by the German Federal Ministry of Education and Research and the Hessen State Ministry for Higher Education, Research and Arts within their joint support of the National Research Center for Applied Cybersecurity ATHENE and by the Deutsche Forschungsgemeinschaft (DFG, German Research Foundation) SFB 1119.</p>
</div>
</section>
<section class="ltx_bibliography" id="bib">
<h2 class="ltx_title ltx_title_bibliography">References</h2>
<ul class="ltx_biblist">
<li class="ltx_bibitem" id="bib.bib1">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[1]</span>
<span class="ltx_bibblock">
Yehuda Afek, Anat Bremler-Barr, and Lior Shafir.

</span>
<span class="ltx_bibblock"><math alttext="\{" class="ltx_Math" display="inline" id="bib.bib1.1.m1.1"><semantics id="bib.bib1.1.m1.1a"><mo id="bib.bib1.1.m1.1.1" stretchy="false" xref="bib.bib1.1.m1.1.1.cmml">{</mo><annotation-xml encoding="MathML-Content" id="bib.bib1.1.m1.1b"><ci id="bib.bib1.1.m1.1.1.cmml" xref="bib.bib1.1.m1.1.1">{</ci></annotation-xml><annotation encoding="application/x-tex" id="bib.bib1.1.m1.1c">\{</annotation><annotation encoding="application/x-llamapun" id="bib.bib1.1.m1.1d">{</annotation></semantics></math>NXNSAttack<math alttext="\}" class="ltx_Math" display="inline" id="bib.bib1.2.m2.1"><semantics id="bib.bib1.2.m2.1a"><mo id="bib.bib1.2.m2.1.1" stretchy="false" xref="bib.bib1.2.m2.1.1.cmml">}</mo><annotation-xml encoding="MathML-Content" id="bib.bib1.2.m2.1b"><ci id="bib.bib1.2.m2.1.1.cmml" xref="bib.bib1.2.m2.1.1">}</ci></annotation-xml><annotation encoding="application/x-tex" id="bib.bib1.2.m2.1c">\}</annotation><annotation encoding="application/x-llamapun" id="bib.bib1.2.m2.1d">}</annotation></semantics></math>: Recursive <math alttext="\{" class="ltx_Math" display="inline" id="bib.bib1.3.m3.1"><semantics id="bib.bib1.3.m3.1a"><mo id="bib.bib1.3.m3.1.1" stretchy="false" xref="bib.bib1.3.m3.1.1.cmml">{</mo><annotation-xml encoding="MathML-Content" id="bib.bib1.3.m3.1b"><ci id="bib.bib1.3.m3.1.1.cmml" xref="bib.bib1.3.m3.1.1">{</ci></annotation-xml><annotation encoding="application/x-tex" id="bib.bib1.3.m3.1c">\{</annotation><annotation encoding="application/x-llamapun" id="bib.bib1.3.m3.1d">{</annotation></semantics></math>DNS<math alttext="\}" class="ltx_Math" display="inline" id="bib.bib1.4.m4.1"><semantics id="bib.bib1.4.m4.1a"><mo id="bib.bib1.4.m4.1.1" stretchy="false" xref="bib.bib1.4.m4.1.1.cmml">}</mo><annotation-xml encoding="MathML-Content" id="bib.bib1.4.m4.1b"><ci id="bib.bib1.4.m4.1.1.cmml" xref="bib.bib1.4.m4.1.1">}</ci></annotation-xml><annotation encoding="application/x-tex" id="bib.bib1.4.m4.1c">\}</annotation><annotation encoding="application/x-llamapun" id="bib.bib1.4.m4.1d">}</annotation></semantics></math> inefficiencies and
vulnerabilities.

</span>
<span class="ltx_bibblock">In <span class="ltx_text ltx_font_italic" id="bib.bib1.5.1">29th USENIX Security Symposium (USENIX Security 20)</span>, pages
631–648, 2020.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib2">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[2]</span>
<span class="ltx_bibblock">
Yehuda Afek, Anat Bremler-Barr, and Shani Stajnrod.

</span>
<span class="ltx_bibblock"><math alttext="\{" class="ltx_Math" display="inline" id="bib.bib2.1.m1.1"><semantics id="bib.bib2.1.m1.1a"><mo id="bib.bib2.1.m1.1.1" stretchy="false" xref="bib.bib2.1.m1.1.1.cmml">{</mo><annotation-xml encoding="MathML-Content" id="bib.bib2.1.m1.1b"><ci id="bib.bib2.1.m1.1.1.cmml" xref="bib.bib2.1.m1.1.1">{</ci></annotation-xml><annotation encoding="application/x-tex" id="bib.bib2.1.m1.1c">\{</annotation><annotation encoding="application/x-llamapun" id="bib.bib2.1.m1.1d">{</annotation></semantics></math>NRDelegationAttack<math alttext="\}" class="ltx_Math" display="inline" id="bib.bib2.2.m2.1"><semantics id="bib.bib2.2.m2.1a"><mo id="bib.bib2.2.m2.1.1" stretchy="false" xref="bib.bib2.2.m2.1.1.cmml">}</mo><annotation-xml encoding="MathML-Content" id="bib.bib2.2.m2.1b"><ci id="bib.bib2.2.m2.1.1.cmml" xref="bib.bib2.2.m2.1.1">}</ci></annotation-xml><annotation encoding="application/x-tex" id="bib.bib2.2.m2.1c">\}</annotation><annotation encoding="application/x-llamapun" id="bib.bib2.2.m2.1d">}</annotation></semantics></math>: Complexity <math alttext="\{" class="ltx_Math" display="inline" id="bib.bib2.3.m3.1"><semantics id="bib.bib2.3.m3.1a"><mo id="bib.bib2.3.m3.1.1" stretchy="false" xref="bib.bib2.3.m3.1.1.cmml">{</mo><annotation-xml encoding="MathML-Content" id="bib.bib2.3.m3.1b"><ci id="bib.bib2.3.m3.1.1.cmml" xref="bib.bib2.3.m3.1.1">{</ci></annotation-xml><annotation encoding="application/x-tex" id="bib.bib2.3.m3.1c">\{</annotation><annotation encoding="application/x-llamapun" id="bib.bib2.3.m3.1d">{</annotation></semantics></math>DDoS<math alttext="\}" class="ltx_Math" display="inline" id="bib.bib2.4.m4.1"><semantics id="bib.bib2.4.m4.1a"><mo id="bib.bib2.4.m4.1.1" stretchy="false" xref="bib.bib2.4.m4.1.1.cmml">}</mo><annotation-xml encoding="MathML-Content" id="bib.bib2.4.m4.1b"><ci id="bib.bib2.4.m4.1.1.cmml" xref="bib.bib2.4.m4.1.1">}</ci></annotation-xml><annotation encoding="application/x-tex" id="bib.bib2.4.m4.1c">\}</annotation><annotation encoding="application/x-llamapun" id="bib.bib2.4.m4.1d">}</annotation></semantics></math> attack on
<math alttext="\{" class="ltx_Math" display="inline" id="bib.bib2.5.m5.1"><semantics id="bib.bib2.5.m5.1a"><mo id="bib.bib2.5.m5.1.1" stretchy="false" xref="bib.bib2.5.m5.1.1.cmml">{</mo><annotation-xml encoding="MathML-Content" id="bib.bib2.5.m5.1b"><ci id="bib.bib2.5.m5.1.1.cmml" xref="bib.bib2.5.m5.1.1">{</ci></annotation-xml><annotation encoding="application/x-tex" id="bib.bib2.5.m5.1c">\{</annotation><annotation encoding="application/x-llamapun" id="bib.bib2.5.m5.1d">{</annotation></semantics></math>DNS<math alttext="\}" class="ltx_Math" display="inline" id="bib.bib2.6.m6.1"><semantics id="bib.bib2.6.m6.1a"><mo id="bib.bib2.6.m6.1.1" stretchy="false" xref="bib.bib2.6.m6.1.1.cmml">}</mo><annotation-xml encoding="MathML-Content" id="bib.bib2.6.m6.1b"><ci id="bib.bib2.6.m6.1.1.cmml" xref="bib.bib2.6.m6.1.1">}</ci></annotation-xml><annotation encoding="application/x-tex" id="bib.bib2.6.m6.1c">\}</annotation><annotation encoding="application/x-llamapun" id="bib.bib2.6.m6.1d">}</annotation></semantics></math> recursive resolvers.

</span>
<span class="ltx_bibblock">In <span class="ltx_text ltx_font_italic" id="bib.bib2.7.1">32nd USENIX Security Symposium (USENIX Security 23)</span>, pages
3187–3204, 2023.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib3">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[3]</span>
<span class="ltx_bibblock">
Nirav Atre, Hugo Sadok, Erica Chiang, Weina Wang, and Justine Sherry.

</span>
<span class="ltx_bibblock">Surgeprotector: Mitigating temporal algorithmic complexity attacks
using adversarial scheduling.

</span>
<span class="ltx_bibblock">In <span class="ltx_text ltx_font_italic" id="bib.bib3.1.1">Proceedings of the ACM SIGCOMM 2022 Conference</span>, pages
723–738, 2022.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib4">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[4]</span>
<span class="ltx_bibblock">
Jonas Bushart and Christian Rossow.

</span>
<span class="ltx_bibblock">Dns unchained: amplified application-layer dos attacks against dns
authoritatives.

</span>
<span class="ltx_bibblock">In <span class="ltx_text ltx_font_italic" id="bib.bib4.1.1">Research in Attacks, Intrusions, and Defenses: 21st
International Symposium, RAID 2018, Heraklion, Crete, Greece, September
10-12, 2018, Proceedings 21</span>, pages 139–160. Springer, 2018.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib5">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[5]</span>
<span class="ltx_bibblock">
Marco Carvalho, Jared DeMott, Richard Ford, and David A Wheeler.

</span>
<span class="ltx_bibblock">Heartbleed 101.

</span>
<span class="ltx_bibblock"><span class="ltx_text ltx_font_italic" id="bib.bib5.1.1">IEEE security &amp; privacy</span>, 12(4):63–67, 2014.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib6">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[6]</span>
<span class="ltx_bibblock">
Taejoong Chung, Emile Aben, Tim Bruijnzeels, Balakrishnan Chandrasekaran, David
Choffnes, Dave Levin, Bruce M Maggs, Alan Mislove, Roland van Rijswijk-Deij,
John Rula, et al.

</span>
<span class="ltx_bibblock">Rpki is coming of age: A longitudinal study of rpki deployment and
invalid route origins.

</span>
<span class="ltx_bibblock">In <span class="ltx_text ltx_font_italic" id="bib.bib6.1.1">Proceedings of the Internet Measurement Conference</span>, pages
406–419, 2019.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib7">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[7]</span>
<span class="ltx_bibblock">
Douglas Everson, Long Cheng, and Zhenkai Zhang.

</span>
<span class="ltx_bibblock">Log4shell: Redefining the web attack surface.

</span>
<span class="ltx_bibblock">In <span class="ltx_text ltx_font_italic" id="bib.bib7.1.1">Workshop on Measurements, Attacks, and Defenses for the Web
(MADWeb) 2022</span>, 2022.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib8">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[8]</span>
<span class="ltx_bibblock">
Joseph Gersch and Dan Massey.

</span>
<span class="ltx_bibblock">Rover: Route origin verification using dns.

</span>
<span class="ltx_bibblock">In <span class="ltx_text ltx_font_italic" id="bib.bib8.1.1">2013 22nd International Conference on Computer Communication
and Networks (ICCCN)</span>, pages 1–9. IEEE, 2013.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib9">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[9]</span>
<span class="ltx_bibblock">
Elias Heftrig, Haya Shulman, and Michael Waidner.

</span>
<span class="ltx_bibblock">Downgrading DNSSEC: How to Exploit Crypto Agility for Hijacking
Signed Zones.

</span>
<span class="ltx_bibblock">In <span class="ltx_text ltx_font_italic" id="bib.bib9.1.1">32nd USENIX Security Symposium (USENIX Security 23)</span>, pages
7429–7444, 2023.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib10">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[10]</span>
<span class="ltx_bibblock">
Dan Kaminsky.

</span>
<span class="ltx_bibblock">It’s the End of the Cache As We Know It.

</span>
<span class="ltx_bibblock">In <span class="ltx_text ltx_font_italic" id="bib.bib10.1.1">Black Hat conference</span>, August 2008.

</span>
<span class="ltx_bibblock"><a class="ltx_ref ltx_url ltx_font_typewriter" href="http://www.blackhat.com/presentations/bh-jp-08/bh-jp-08-Kaminsky/BlackHat-Japan-08-Kaminsky-DNS08-BlackOps.pdf" title="">http://www.blackhat.com/presentations/bh-jp-08/bh-jp-08-Kaminsky/BlackHat-Japan-08-Kaminsky-DNS08-BlackOps.pdf</a>.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib11">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[11]</span>
<span class="ltx_bibblock">
Asif Karim, Sami Azam, Bharanidharan Shanmugam, Krishnan Kannoorpatti, and
Mamoun Alazab.

</span>
<span class="ltx_bibblock">A comprehensive survey for intelligent spam email detection.

</span>
<span class="ltx_bibblock"><span class="ltx_text ltx_font_italic" id="bib.bib11.1.1">IEEE Access</span>, 7:168261–168295, 2019.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib12">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[12]</span>
<span class="ltx_bibblock">
Marc Kührer, Thomas Hupperich, Christian Rossow, and Thorsten Holz.

</span>
<span class="ltx_bibblock">Exit from hell? reducing the impact of
<math alttext="\{" class="ltx_Math" display="inline" id="bib.bib12.1.m1.1"><semantics id="bib.bib12.1.m1.1a"><mo id="bib.bib12.1.m1.1.1" stretchy="false" xref="bib.bib12.1.m1.1.1.cmml">{</mo><annotation-xml encoding="MathML-Content" id="bib.bib12.1.m1.1b"><ci id="bib.bib12.1.m1.1.1.cmml" xref="bib.bib12.1.m1.1.1">{</ci></annotation-xml><annotation encoding="application/x-tex" id="bib.bib12.1.m1.1c">\{</annotation><annotation encoding="application/x-llamapun" id="bib.bib12.1.m1.1d">{</annotation></semantics></math>Amplification<math alttext="\}" class="ltx_Math" display="inline" id="bib.bib12.2.m2.1"><semantics id="bib.bib12.2.m2.1a"><mo id="bib.bib12.2.m2.1.1" stretchy="false" xref="bib.bib12.2.m2.1.1.cmml">}</mo><annotation-xml encoding="MathML-Content" id="bib.bib12.2.m2.1b"><ci id="bib.bib12.2.m2.1.1.cmml" xref="bib.bib12.2.m2.1.1">}</ci></annotation-xml><annotation encoding="application/x-tex" id="bib.bib12.2.m2.1c">\}</annotation><annotation encoding="application/x-llamapun" id="bib.bib12.2.m2.1d">}</annotation></semantics></math><math alttext="\{" class="ltx_Math" display="inline" id="bib.bib12.3.m3.1"><semantics id="bib.bib12.3.m3.1a"><mo id="bib.bib12.3.m3.1.1" stretchy="false" xref="bib.bib12.3.m3.1.1.cmml">{</mo><annotation-xml encoding="MathML-Content" id="bib.bib12.3.m3.1b"><ci id="bib.bib12.3.m3.1.1.cmml" xref="bib.bib12.3.m3.1.1">{</ci></annotation-xml><annotation encoding="application/x-tex" id="bib.bib12.3.m3.1c">\{</annotation><annotation encoding="application/x-llamapun" id="bib.bib12.3.m3.1d">{</annotation></semantics></math>DDoS<math alttext="\}" class="ltx_Math" display="inline" id="bib.bib12.4.m4.1"><semantics id="bib.bib12.4.m4.1a"><mo id="bib.bib12.4.m4.1.1" stretchy="false" xref="bib.bib12.4.m4.1.1.cmml">}</mo><annotation-xml encoding="MathML-Content" id="bib.bib12.4.m4.1b"><ci id="bib.bib12.4.m4.1.1.cmml" xref="bib.bib12.4.m4.1.1">}</ci></annotation-xml><annotation encoding="application/x-tex" id="bib.bib12.4.m4.1c">\}</annotation><annotation encoding="application/x-llamapun" id="bib.bib12.4.m4.1d">}</annotation></semantics></math> attacks.

</span>
<span class="ltx_bibblock">In <span class="ltx_text ltx_font_italic" id="bib.bib12.5.1">23rd USENIX security symposium (USENIX security 14)</span>, pages
111–125, 2014.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib13">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[13]</span>
<span class="ltx_bibblock">
Ueli Maurer.

</span>
<span class="ltx_bibblock">Modelling a public-key infrastructure.

</span>
<span class="ltx_bibblock">In <span class="ltx_text ltx_font_italic" id="bib.bib13.1.1">Computer Security—ESORICS 96: 4th European Symposium on
Research in Computer Security Rome, Italy, September 25–27, 1996 Proceedings
4</span>, pages 325–350. Springer, 1996.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib14">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[14]</span>
<span class="ltx_bibblock">
Giovane C. M. Moura, Sebastian Castro, Wes Hardaker, Maarten Wullink, and
Cristian Hesselman.

</span>
<span class="ltx_bibblock">Clouding up the internet: how centralized is DNS traffic becoming?

</span>
<span class="ltx_bibblock">In <span class="ltx_text ltx_font_italic" id="bib.bib14.1.1">Internet Measurement Conference</span>, pages 42–49. ACM, 2020.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib15">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[15]</span>
<span class="ltx_bibblock">
Roland van Rijswijk-Deij, Kaspar Hageman, Anna Sperotto, and Aiko Pras.

</span>
<span class="ltx_bibblock">The performance impact of elliptic curve cryptography on dnssec
validation.

</span>
<span class="ltx_bibblock"><span class="ltx_text ltx_font_italic" id="bib.bib15.1.1">IEEE/ACM transactions on networking</span>, 25(2):738–750, 2016.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib16">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[16]</span>
<span class="ltx_bibblock">
Roland van Rijswijk-Deij, Anna Sperotto, and Aiko Pras.

</span>
<span class="ltx_bibblock">Dnssec and its potential for ddos attacks: a comprehensive
measurement study.

</span>
<span class="ltx_bibblock">In <span class="ltx_text ltx_font_italic" id="bib.bib16.1.1">Proceedings of the 2014 Conference on Internet Measurement
Conference</span>, pages 449–460, 2014.

</span>
</li>
</ul>
</section>
<div class="ltx_pagination ltx_role_newpage"></div>
</article>
</div>
<footer class="ltx_page_footer">
<div class="ltx_page_logo">Generated  on Wed Jun  5 10:26:21 2024 by <a class="ltx_LaTeXML_logo" href="http://dlmf.nist.gov/LaTeXML/"><span style="letter-spacing:-0.2em; margin-right:0.1em;">L<span class="ltx_font_smallcaps" style="position:relative; bottom:2.2pt;">a</span>T<span class="ltx_font_smallcaps" style="font-size:120%;position:relative; bottom:-0.2ex;">e</span></span><span style="font-size:90%; position:relative; bottom:-0.2ex;">XML</span><img alt="Mascot Sammy" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAsAAAAOCAYAAAD5YeaVAAAAAXNSR0IArs4c6QAAAAZiS0dEAP8A/wD/oL2nkwAAAAlwSFlzAAALEwAACxMBAJqcGAAAAAd0SU1FB9wKExQZLWTEaOUAAAAddEVYdENvbW1lbnQAQ3JlYXRlZCB3aXRoIFRoZSBHSU1Q72QlbgAAAdpJREFUKM9tkL+L2nAARz9fPZNCKFapUn8kyI0e4iRHSR1Kb8ng0lJw6FYHFwv2LwhOpcWxTjeUunYqOmqd6hEoRDhtDWdA8ApRYsSUCDHNt5ul13vz4w0vWCgUnnEc975arX6ORqN3VqtVZbfbTQC4uEHANM3jSqXymFI6yWazP2KxWAXAL9zCUa1Wy2tXVxheKA9YNoR8Pt+aTqe4FVVVvz05O6MBhqUIBGk8Hn8HAOVy+T+XLJfLS4ZhTiRJgqIoVBRFIoric47jPnmeB1mW/9rr9ZpSSn3Lsmir1fJZlqWlUonKsvwWwD8ymc/nXwVBeLjf7xEKhdBut9Hr9WgmkyGEkJwsy5eHG5vN5g0AKIoCAEgkEkin0wQAfN9/cXPdheu6P33fBwB4ngcAcByHJpPJl+fn54mD3Gg0NrquXxeLRQAAwzAYj8cwTZPwPH9/sVg8PXweDAauqqr2cDjEer1GJBLBZDJBs9mE4zjwfZ85lAGg2+06hmGgXq+j3+/DsixYlgVN03a9Xu8jgCNCyIegIAgx13Vfd7vdu+FweG8YRkjXdWy329+dTgeSJD3ieZ7RNO0VAXAPwDEAO5VKndi2fWrb9jWl9Esul6PZbDY9Go1OZ7PZ9z/lyuD3OozU2wAAAABJRU5ErkJggg=="/></a>
</div></footer>
</div>
</body>
</html>
