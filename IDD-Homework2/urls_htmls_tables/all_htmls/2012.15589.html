<!DOCTYPE html><html lang="en">
<head>
<meta http-equiv="content-type" content="text/html; charset=UTF-8">
<title>[2012.15589] PFL-MoE: Personalized Federated Learning Based on Mixture of Experts</title><meta property="og:description" content="Federated learning (FL) is an emerging distributed machine learning paradigm that avoids data sharing among training nodes so as to protect data privacy. Under coordination of the FL server, each client conducts model …">
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="PFL-MoE: Personalized Federated Learning Based on Mixture of Experts">
<meta name="twitter:image:src" content="https://ar5iv.labs.arxiv.org/assets/ar5iv_card.png">
<meta name="twitter:image:alt" content="ar5iv logo">
<meta property="og:title" content="PFL-MoE: Personalized Federated Learning Based on Mixture of Experts">
<meta property="og:site_name" content="ar5iv">
<meta property="og:image" content="https://ar5iv.labs.arxiv.org/assets/ar5iv_card.png">
<meta property="og:type" content="article">
<meta property="og:url" content="https://ar5iv.labs.arxiv.org/html/2012.15589">

<!--Generated on Fri Mar  1 14:02:13 2024 by LaTeXML (version 0.8.8) http://dlmf.nist.gov/LaTeXML/.-->
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="keywords" lang="en" content="
Federated Learning,  Personalization,  Mixture of Experts,  Fine-tuning,  Distributed Machine Learning
">

<script>
  function detectColorScheme(){
    var theme="light";
    var current_theme = localStorage.getItem("ar5iv_theme");
    if(current_theme){
      if(current_theme == "dark"){
        theme = "dark";
      } }
    else if(!window.matchMedia) { return false; }
    else if(window.matchMedia("(prefers-color-scheme: dark)").matches) {
      theme = "dark"; }
    if (theme=="dark") {
      document.documentElement.setAttribute("data-theme", "dark");
    } else {
      document.documentElement.setAttribute("data-theme", "light"); } }

  detectColorScheme();

  function toggleColorScheme(){
    var current_theme = localStorage.getItem("ar5iv_theme");
    if (current_theme) {
      if (current_theme == "light") {
        localStorage.setItem("ar5iv_theme", "dark"); }
      else {
        localStorage.setItem("ar5iv_theme", "light"); } }
    else {
        localStorage.setItem("ar5iv_theme", "dark"); }
    detectColorScheme(); }
</script>
<link media="all" rel="stylesheet" href="/assets/ar5iv-fonts.0.8.0.min.css"><link media="all" rel="stylesheet" href="/assets/ar5iv.0.8.0.min.css"><link media="all" rel="stylesheet" href="/assets/ar5iv-site.0.2.2.css">
</head>
<body>
<div class="ltx_page_main">
<div class="ltx_page_content">
<article class="ltx_document ltx_authors_1line">
<h1 class="ltx_title ltx_title_document">PFL-MoE: Personalized Federated Learning Based on Mixture of Experts
</h1>
<div class="ltx_authors">
<span class="ltx_creator ltx_role_author">
<span class="ltx_personname">
1<sup id="id1.1.id1" class="ltx_sup">st</sup> Binbin Guo


<br class="ltx_break">4<sup id="id2.2.id2" class="ltx_sup">th</sup> Weigang Wu
</span><span class="ltx_author_notes">
<span class="ltx_contact ltx_role_affiliation"><span id="id3.3.id1" class="ltx_text ltx_font_italic">School of Comp. Sci. &amp; Eng.</span>
<br class="ltx_break"><span id="id4.4.id2" class="ltx_text ltx_font_italic">Sun Yat-sen University
<br class="ltx_break"></span>Guang Zhou, China 
<br class="ltx_break">guobb5@mail2.sysu.edu.cn
</span>
<span class="ltx_contact ltx_role_affiliation"><span id="id5.5.id1" class="ltx_text ltx_font_italic">School of Comp. Sci. &amp; Eng.</span>
<br class="ltx_break"><span id="id6.6.id2" class="ltx_text ltx_font_italic">Sun Yat-sen University
<br class="ltx_break"></span>Guang Zhou, China 
<br class="ltx_break">wuweig@mail.sysu.edu.cn
</span></span></span>
<span class="ltx_author_before">  </span><span class="ltx_creator ltx_role_author">
<span class="ltx_personname">2<sup id="id7.1.id1" class="ltx_sup">nd</sup> Yuan Mei


<br class="ltx_break">5<sup id="id8.2.id2" class="ltx_sup">th</sup>Ye Yin
</span><span class="ltx_author_notes">
<span class="ltx_contact ltx_role_affiliation"><span id="id9.3.id1" class="ltx_text ltx_font_italic">School of Comp. Sci. &amp; Eng.</span>
<br class="ltx_break"><span id="id10.4.id2" class="ltx_text ltx_font_italic">Sun Yat-sen University
<br class="ltx_break"></span>Guang Zhou, China 
<br class="ltx_break">meiy7@mail2.sysu.edu.cn
</span>
<span class="ltx_contact ltx_role_affiliation"><span id="id11.5.id1" class="ltx_text ltx_font_italic">Interactive Entertainment Group</span>
<br class="ltx_break"><span id="id12.6.id2" class="ltx_text ltx_font_italic">Tencent Inc.
<br class="ltx_break"></span>Shenzhen, China 
<br class="ltx_break">dbyin@tencent.com
</span></span></span>
<span class="ltx_author_before">  </span><span class="ltx_creator ltx_role_author">
<span class="ltx_personname">3<sup id="id13.1.id1" class="ltx_sup">rd</sup>Danyang Xiao 


<br class="ltx_break">6<sup id="id14.2.id2" class="ltx_sup">th</sup>Hongli Chang
</span><span class="ltx_author_notes">
<span class="ltx_contact ltx_role_affiliation"><span id="id15.3.id1" class="ltx_text ltx_font_italic">School of Comp. Sci. &amp; Eng.</span>
<br class="ltx_break"><span id="id16.4.id2" class="ltx_text ltx_font_italic">Sun Yat-sen University
<br class="ltx_break"></span>Guang Zhou, China 
<br class="ltx_break">xiaody@mail2.sysu.edu.cn
</span>
<span class="ltx_contact ltx_role_affiliation"><span id="id17.5.id1" class="ltx_text ltx_font_italic">Interactive Entertainment Group</span>
<br class="ltx_break"><span id="id18.6.id2" class="ltx_text ltx_font_italic">Tencent Inc.
<br class="ltx_break"></span>Shenzhen, China 
<br class="ltx_break">honglichang@tencent.com
</span></span></span>
</div>

<div class="ltx_abstract">
<h6 class="ltx_title ltx_title_abstract">Abstract</h6>
<p id="id19.id1" class="ltx_p">Federated learning (FL) is an emerging distributed machine learning paradigm that avoids data sharing among training nodes so as to protect data privacy. Under coordination of the FL server, each client conducts model training using its own computing resource and private data set. The global model can be created by aggregating the training results of clients. To cope with highly non-IID data distributions, personalized federated learning (PFL) has been proposed to improve overall performance by allowing each client to learn a personalized model.
However, one major drawback of a personalized model is the loss of generalization.
To achieve model personalization while maintaining generalization, in this paper, we propose a new approach, named PFL-MoE, which mixes outputs of the personalized model and global model via the MoE architecture.
PFL-MoE is a generic approach and can be instantiated by integrating existing PFL algorithms. Particularly, we propose the PFL-MF algorithm which is an instance of PFL-MoE based on the freeze-base PFL algorithm. We further improve PFL-MF by enhancing the decision-making ability of MoE gating network and propose a variant algorithm PFL-MFE. We demonstrate the effectiveness of PFL-MoE by training the LeNet-5 and VGG-16 models on the Fashion-MNIST and CIFAR-10 datasets with non-IID partitions.</p>
</div>
<div class="ltx_keywords">
<h6 class="ltx_title ltx_title_keywords">Index Terms: </h6>
Federated Learning, Personalization, Mixture of Experts, Fine-tuning, Distributed Machine Learning

</div>
<section id="S1" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">I </span><span id="S1.1.1" class="ltx_text ltx_font_smallcaps">Introduction</span>
</h2>

<div id="S1.p1" class="ltx_para">
<p id="S1.p1.1" class="ltx_p">In the past few years, we have witnessed the rapid development of deep learning in artificial intelligence (AI) applications, such as computer vision, natural language processing, and recommendation systems.
As is known to all, the success of deep learning technologies relies on massive data set which are usually the collections of data from different organizations, devices, or users.
And distributed machine learning (DML) <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib1" title="" class="ltx_ref">1</a>]</cite>, which may employ a large number of worker nodes to collaboratively conduct training, has been widely used nowadays to train large scale neural network models on large volume data set.
However, in many scenarios, data is in fact distributed among different clients (owned by different users) and is sensitive to privacy. Such data cannot be collected and shared with any other nodes.
On the other hand, as the storage and computational capabilities of edge devices grow, it is becoming increasingly attractive to perform learning directly on the edge <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib2" title="" class="ltx_ref">2</a>]</cite>.
Unfortunately, it is difficult for a client to learn an effective model using only its own data, because the data set at a single client is usually not large enough.
Federated Learning (FL) allows a large number of clients (e.g., mobile phones and IoT devices) to learn a global model together without data sharing. The global model is created by repeatedly averaging model updates from small subsets of clients.
More specifically, each round of FL includes three basic phases: (1) the FL server delivers the global model to each participating client; (2) the clients conduct training based on its private data and return the updated models to the server; and (3) the FL server gets the latest global model by aggregating the uploaded models.
As the training converges, the final global model can achieve performance similar to the model trained via pooled and shared data.
</p>
</div>
<div id="S1.p2" class="ltx_para">
<p id="S1.p2.1" class="ltx_p">One of major challenges of FL is the statistical diversity among data owned by different clients.
The distribution of data across clients is natural inconsistency and non-IID (IID, independent and identically distributed), and the amount of data is also highly biased.
The non-IID characteristic may largely affect the convergence behaviors of the global model trained, because non-IID data may cause the model parameters fluctuates largely and delay or even destroy the convergence.
It will be even worse if privacy-preserving mechanisms, e.g., differential privacy <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib3" title="" class="ltx_ref">3</a>]</cite>, are taken into consideration.
Besides, different clients have great accuracy differences under the same global model. In some clients, the global model is even worse than the locally trained model.</p>
</div>
<div id="S1.p3" class="ltx_para">
<p id="S1.p3.1" class="ltx_p">Personalization of the global model is necessary to handle the statistic heterogeneity of the distributed data.
In personalized federated learning (PFL), each client learns a personalized model suitable for its own data distribution, which is more flexible than a single global model.
Yu et al. <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib4" title="" class="ltx_ref">4</a>]</cite> has investigated various technologies for adapting the federated global model to an individual client, including fine-tuning <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib5" title="" class="ltx_ref">5</a>]</cite>, multi-task learning <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib6" title="" class="ltx_ref">6</a>]</cite>, and knowledge distillation <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib7" title="" class="ltx_ref">7</a>]</cite>.
These PFL algorithms can effectively improve the model performance for individual participants. Almost all personalized models outperform the corresponding locally trained models, which greatly motivates clients to participate in federated learning.
However, personalization is always accompanied by the loss of generalization, which is manifested in the increases of generalization error of personalized model.
For example, a client has only a small amount of data, and the personalized model is likely to overfit the local data.
How to balance personalization and generalization is the current research focus of personalized federated learning.
</p>
</div>
<div id="S1.p4" class="ltx_para">
<p id="S1.p4.1" class="ltx_p">Most of existing PFL algorithms attempt to find a single model that is both personalized and generalized.
Alternatively, FL+DE <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib8" title="" class="ltx_ref">8</a>]</cite> combines two models to improve accuracy based on the mixture of experts (MoE) <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib9" title="" class="ltx_ref">9</a>]</cite>.
MoE is one of the most popular combining methods. It is established based on the divide-and-conquer principle in which the problem space is divided between a few neural network experts, supervised by a gating network <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib10" title="" class="ltx_ref">10</a>]</cite>.
In FL+DE, all clients collaborate to build a general global model, but maintain private, domain-adapted expert models. In each client, the global model and the private model are regarded as global expert and domain expert respectively and their outputs are mixed by the gating network.
The predictions of the two models are much more accurate than those of the single global model.</p>
</div>
<div id="S1.p5" class="ltx_para">
<p id="S1.p5.1" class="ltx_p">Inspired by FL+DE, we propose a personalized federated learning approach PFL-MoE that considers the personalized model as local expert and combines it with the federated global model through MoE architecture.
PFL-MoE is a generic approach and can be instantiated by existing PFL algorithms.
Particularly, we propose PFL-MF algorithm, which is an instance of PFL-MoE based on the freeze-based PFL (PFL-FB) algorithm <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib4" title="" class="ltx_ref">4</a>]</cite>.
PFL-FB is an effective algorithm adapting the federated global model to an individual client.</p>
</div>
<div id="S1.p6" class="ltx_para">
<p id="S1.p6.1" class="ltx_p">Moreover, we find that the MoE architecture cannot work well with complex input data, such as the color images, because it is difficult for the gating network to extract useful features from high-dimensional input data for decision-making.
To enhance the decision-making ability of MoE gating network, we modify the model structure of PFL-MF and propose an extended algorithm PFL-MFE.
More precisely, PFL-MFE uses abstract features extracted by the base layer as the input of MoE gating network.
</p>
</div>
<div id="S1.p7" class="ltx_para">
<p id="S1.p7.1" class="ltx_p">We conduct extensive experiments to evaluate the performance of our algorithms and compare them with existing ones. We use three combinations of dataset and model: Fashion-MNIST + LeNet-5, CIFAR10 + LeNet-5, and CIFAR-10 + VGG-16. In various non-IID experimental settings, the proposed algorithms achieve higher global accuracy while the same or even better local test accuracy than PFL-FB.
The results show our approach combines the advantages of the personalized model and the global model.</p>
</div>
<div id="S1.p8" class="ltx_para">
<p id="S1.p8.1" class="ltx_p"><span id="S1.p8.1.1" class="ltx_text ltx_font_bold">Contributions:</span></p>
<ul id="S1.I1" class="ltx_itemize">
<li id="S1.I1.i1" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="S1.I1.i1.p1" class="ltx_para">
<p id="S1.I1.i1.p1.1" class="ltx_p">We propose a novel PFL approach, namely, PFL-MoE, that can achieve both personalization and generalization. PFL-MoE is generic and can be instantiated using existing FL algorithms.
</p>
</div>
</li>
<li id="S1.I1.i2" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="S1.I1.i2.p1" class="ltx_para">
<p id="S1.I1.i2.p1.1" class="ltx_p">Based on our PFL-MoE approach, we propose the PFL-MF algorithm and its extension, the PFL-MFE algorithm. The former is an instance of PFL-MoE and the later improves PFL-MF by modifying the MoE architecture so as to achieve better decision-making ability.</p>
</div>
</li>
<li id="S1.I1.i3" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="S1.I1.i3.p1" class="ltx_para">
<p id="S1.I1.i3.p1.1" class="ltx_p">We conduct experiments to evaluate our approach. An overall evaluation of PFL-MF and PFL-MFE algorithms is provided. The experiment results confirm the advantage of our design.</p>
</div>
</li>
</ul>
</div>
<div id="S1.p9" class="ltx_para">
<p id="S1.p9.1" class="ltx_p">The rest of the paper is organized as follows.
Section <a href="#S2" title="II Related Works ‣ PFL-MoE: Personalized Federated Learning Based on Mixture of Experts" class="ltx_ref"><span class="ltx_text ltx_ref_tag">II</span></a> reviews related works on personalization techniques for federated learning. Section <a href="#S3" title="III PFL-MoE ‣ PFL-MoE: Personalized Federated Learning Based on Mixture of Experts" class="ltx_ref"><span class="ltx_text ltx_ref_tag">III</span></a> describes the detailed design of the PFL-MoE approach, and the instance algorithms PFL-MF and PFL-MFE are presented in Section <a href="#S4" title="IV PFL-MF and PFL-MFE ‣ PFL-MoE: Personalized Federated Learning Based on Mixture of Experts" class="ltx_ref"><span class="ltx_text ltx_ref_tag">IV</span></a>. Section <a href="#S5" title="V Experimental Evaluation ‣ PFL-MoE: Personalized Federated Learning Based on Mixture of Experts" class="ltx_ref"><span class="ltx_text ltx_ref_tag">V</span></a> reports the performance evaluation results. Finally, Section <a href="#S6" title="VI Conclusion and Future work ‣ PFL-MoE: Personalized Federated Learning Based on Mixture of Experts" class="ltx_ref"><span class="ltx_text ltx_ref_tag">VI</span></a> concludes the paper.</p>
</div>
</section>
<section id="S2" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">II </span><span id="S2.1.1" class="ltx_text ltx_font_smallcaps">Related Works</span>
</h2>

<section id="S2.SS1" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection"><span id="S2.SS1.5.1.1" class="ltx_text">II-A</span> </span><span id="S2.SS1.6.2" class="ltx_text ltx_font_italic">Classical Federated Learning</span>
</h3>

<div id="S2.SS1.p1" class="ltx_para">
<p id="S2.SS1.p1.1" class="ltx_p">The first FL system is developed by Google <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib11" title="" class="ltx_ref">11</a>, <a href="#bib.bib12" title="" class="ltx_ref">12</a>]</cite>, which selects a sample of available smartphones to update the language prediction model based on the edge server architecture, and has got a good result.
However, there are still many challenges in federated learning, including privacy concerns, communication cost, systems heterogeneity and statistical heterogeneity <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib13" title="" class="ltx_ref">13</a>, <a href="#bib.bib14" title="" class="ltx_ref">14</a>]</cite>.
Although federated learning only communicates model parameters,
studies have shown that monitoring model updates can reversely derive data, making privacy protection an important issue <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib15" title="" class="ltx_ref">15</a>]</cite>.
A considerable amount of literature has been published on privacy leakage risks and protection methods <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib16" title="" class="ltx_ref">16</a>]</cite>.
The FL server coordinates the participants to iterative training a global model, where uploading and downloading model parameters require a lot of communication overhead. Some studies aim to reduce communication costs in FL <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib12" title="" class="ltx_ref">12</a>]</cite>.
In federated settings, all edge devices can be clients. In most cases, these devices have fewer network resources and cannot keep online all the time <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib12" title="" class="ltx_ref">12</a>]</cite>.
Moreover,
the software and hardware resources and computing power of each client vary greatly. These issues requires the federated learning framework to coordinate and allocate the clients effectively <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib17" title="" class="ltx_ref">17</a>]</cite>.</p>
</div>
</section>
<section id="S2.SS2" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection"><span id="S2.SS2.5.1.1" class="ltx_text">II-B</span> </span><span id="S2.SS2.6.2" class="ltx_text ltx_font_italic">Handling Non-IID and Personalization</span>
</h3>

<div id="S2.SS2.p1" class="ltx_para">
<p id="S2.SS2.p1.1" class="ltx_p">Given the distributed nature of the clients, the statistics of the data across them are likely to differ significantly,
which is another big challenge for FL <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib14" title="" class="ltx_ref">14</a>]</cite>.
A large number of experiments have evaluated the impact of non-IID on FL <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib18" title="" class="ltx_ref">18</a>]</cite>.
Simultaneously, various non-IID data construction methods <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib18" title="" class="ltx_ref">18</a>]</cite> and the non-IID datasets from the real world <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib19" title="" class="ltx_ref">19</a>]</cite> are emerging.
Li et al. <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib20" title="" class="ltx_ref">20</a>]</cite> provided the first proof of the convergence of FedAvg<cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib11" title="" class="ltx_ref">11</a>]</cite>, widely used in federated learning, under non-IID data distributions.
Zhao et al. <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib21" title="" class="ltx_ref">21</a>]</cite> proposed a method of sharing part of the global data to alleviate
data dissimilarity among the clients, so as to improve the convergence rate and performance of the global model.
In FedProx <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib17" title="" class="ltx_ref">17</a>]</cite>, the proximal term was added to each client’s optimization goal to limit the drift of its update so that the algorithm has better robustness and convergence stability than FedAvg.</p>
</div>
<div id="S2.SS2.p2" class="ltx_para">
<p id="S2.SS2.p2.1" class="ltx_p">Alternatively, personalized federated learning <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib22" title="" class="ltx_ref">22</a>]</cite> starts from the incentive of the clients participating in federated learning, and turns the goal to improve the accuracy of the personalized models of the clients with non-IID data distributions, which improves the overall performance effectively. A large and growing body of literature has investigated to achieve personalization through various methods:</p>
</div>
<section id="S2.SS2.SSS0.Px1" class="ltx_paragraph">
<h5 class="ltx_title ltx_title_paragraph">Fine-turning and meta-learning</h5>

<div id="S2.SS2.SSS0.Px1.p1" class="ltx_para">
<p id="S2.SS2.SSS0.Px1.p1.1" class="ltx_p">In Wang et al.’s work <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib5" title="" class="ltx_ref">5</a>]</cite>, on each client, the personalized model was fine-tuned from the federated global model (PFL-FT), but the used of the model is depends on whether or not it outperforms the global model. In his image classification experiment, most clients can get a better personalized model, and the rest of the clients continue to use the global model. Jiang et al. <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib23" title="" class="ltx_ref">23</a>]</cite> observed that the FedAvg algorithm can be interpreted as a meta learning algorithm (MAML) <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib24" title="" class="ltx_ref">24</a>]</cite>. This provides a good explanation for fine-tuning can achieve good personalization that FedAvg can get a good initial model for the clients which achieve high precision with only a little local training.
Also based on the MAML algorithm, Fallah et al. proposed a variant of FedAvg named Per-FedAvg <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib24" title="" class="ltx_ref">24</a>]</cite> which turns the goal into learning a better initial model for each client and provides theoretical guarantees.
Furthermore, pFedMe <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib25" title="" class="ltx_ref">25</a>]</cite> updates both the personalized and global models by solving the bi-level optimization problem instead of using the global model as initialization, which is more flexible than Per-FedAvg.</p>
</div>
</section>
<section id="S2.SS2.SSS0.Px2" class="ltx_paragraph">
<h5 class="ltx_title ltx_title_paragraph">Multi-task</h5>

<div id="S2.SS2.SSS0.Px2.p1" class="ltx_para">
<p id="S2.SS2.SSS0.Px2.p1.1" class="ltx_p">Smith et al. <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib6" title="" class="ltx_ref">6</a>]</cite> observed that multi-task learning is naturally suitable for federated learning. They treated each client as a individual task in multi-task learning literature, and investigated a system-aware approach called MOECHA that takes into account communication costs, straggles, and fault tolerance. Not limited to convex models, Corinzia et al. <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib26" title="" class="ltx_ref">26</a>]</cite> proposed the VIRTUAL algorithm to solve generic non-convex models for federated multi-task learning in the scenarios where the data is highly Non-IID.</p>
</div>
</section>
<section id="S2.SS2.SSS0.Px3" class="ltx_paragraph">
<h5 class="ltx_title ltx_title_paragraph">Knowledge distillation</h5>

<div id="S2.SS2.SSS0.Px3.p1" class="ltx_para">
<p id="S2.SS2.SSS0.Px3.p1.1" class="ltx_p">A new federated learning framework FedMD <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib7" title="" class="ltx_ref">7</a>]</cite> was proposed, allowing participants to independently design their own models. FedMD achieves the knowledge transmission between each client through transfer learning and knowledge distillation.</p>
</div>
</section>
<section id="S2.SS2.SSS0.Px4" class="ltx_paragraph">
<h5 class="ltx_title ltx_title_paragraph">Mixing models</h5>

<div id="S2.SS2.SSS0.Px4.p1" class="ltx_para">
<p id="S2.SS2.SSS0.Px4.p1.4" class="ltx_p">In Hanzely et al.’s work <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib27" title="" class="ltx_ref">27</a>]</cite>, a new federated learning optimization goal was defined to seek a mixture of global and local models. The method controls the mixing degree of the local and global models through <math id="S2.SS2.SSS0.Px4.p1.1.m1.1" class="ltx_Math" alttext="\lambda" display="inline"><semantics id="S2.SS2.SSS0.Px4.p1.1.m1.1a"><mi id="S2.SS2.SSS0.Px4.p1.1.m1.1.1" xref="S2.SS2.SSS0.Px4.p1.1.m1.1.1.cmml">λ</mi><annotation-xml encoding="MathML-Content" id="S2.SS2.SSS0.Px4.p1.1.m1.1b"><ci id="S2.SS2.SSS0.Px4.p1.1.m1.1.1.cmml" xref="S2.SS2.SSS0.Px4.p1.1.m1.1.1">𝜆</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.SSS0.Px4.p1.1.m1.1c">\lambda</annotation></semantics></math>. When <math id="S2.SS2.SSS0.Px4.p1.2.m2.1" class="ltx_Math" alttext="\lambda=0" display="inline"><semantics id="S2.SS2.SSS0.Px4.p1.2.m2.1a"><mrow id="S2.SS2.SSS0.Px4.p1.2.m2.1.1" xref="S2.SS2.SSS0.Px4.p1.2.m2.1.1.cmml"><mi id="S2.SS2.SSS0.Px4.p1.2.m2.1.1.2" xref="S2.SS2.SSS0.Px4.p1.2.m2.1.1.2.cmml">λ</mi><mo id="S2.SS2.SSS0.Px4.p1.2.m2.1.1.1" xref="S2.SS2.SSS0.Px4.p1.2.m2.1.1.1.cmml">=</mo><mn id="S2.SS2.SSS0.Px4.p1.2.m2.1.1.3" xref="S2.SS2.SSS0.Px4.p1.2.m2.1.1.3.cmml">0</mn></mrow><annotation-xml encoding="MathML-Content" id="S2.SS2.SSS0.Px4.p1.2.m2.1b"><apply id="S2.SS2.SSS0.Px4.p1.2.m2.1.1.cmml" xref="S2.SS2.SSS0.Px4.p1.2.m2.1.1"><eq id="S2.SS2.SSS0.Px4.p1.2.m2.1.1.1.cmml" xref="S2.SS2.SSS0.Px4.p1.2.m2.1.1.1"></eq><ci id="S2.SS2.SSS0.Px4.p1.2.m2.1.1.2.cmml" xref="S2.SS2.SSS0.Px4.p1.2.m2.1.1.2">𝜆</ci><cn type="integer" id="S2.SS2.SSS0.Px4.p1.2.m2.1.1.3.cmml" xref="S2.SS2.SSS0.Px4.p1.2.m2.1.1.3">0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.SSS0.Px4.p1.2.m2.1c">\lambda=0</annotation></semantics></math>, it means each client is trained locally, and when <math id="S2.SS2.SSS0.Px4.p1.3.m3.1" class="ltx_Math" alttext="\lambda=\infty" display="inline"><semantics id="S2.SS2.SSS0.Px4.p1.3.m3.1a"><mrow id="S2.SS2.SSS0.Px4.p1.3.m3.1.1" xref="S2.SS2.SSS0.Px4.p1.3.m3.1.1.cmml"><mi id="S2.SS2.SSS0.Px4.p1.3.m3.1.1.2" xref="S2.SS2.SSS0.Px4.p1.3.m3.1.1.2.cmml">λ</mi><mo id="S2.SS2.SSS0.Px4.p1.3.m3.1.1.1" xref="S2.SS2.SSS0.Px4.p1.3.m3.1.1.1.cmml">=</mo><mi mathvariant="normal" id="S2.SS2.SSS0.Px4.p1.3.m3.1.1.3" xref="S2.SS2.SSS0.Px4.p1.3.m3.1.1.3.cmml">∞</mi></mrow><annotation-xml encoding="MathML-Content" id="S2.SS2.SSS0.Px4.p1.3.m3.1b"><apply id="S2.SS2.SSS0.Px4.p1.3.m3.1.1.cmml" xref="S2.SS2.SSS0.Px4.p1.3.m3.1.1"><eq id="S2.SS2.SSS0.Px4.p1.3.m3.1.1.1.cmml" xref="S2.SS2.SSS0.Px4.p1.3.m3.1.1.1"></eq><ci id="S2.SS2.SSS0.Px4.p1.3.m3.1.1.2.cmml" xref="S2.SS2.SSS0.Px4.p1.3.m3.1.1.2">𝜆</ci><infinity id="S2.SS2.SSS0.Px4.p1.3.m3.1.1.3.cmml" xref="S2.SS2.SSS0.Px4.p1.3.m3.1.1.3"></infinity></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.SSS0.Px4.p1.3.m3.1c">\lambda=\infty</annotation></semantics></math>, it is equivalent to FedAvg algorithm. When taking <math id="S2.SS2.SSS0.Px4.p1.4.m4.1" class="ltx_Math" alttext="\lambda&gt;0" display="inline"><semantics id="S2.SS2.SSS0.Px4.p1.4.m4.1a"><mrow id="S2.SS2.SSS0.Px4.p1.4.m4.1.1" xref="S2.SS2.SSS0.Px4.p1.4.m4.1.1.cmml"><mi id="S2.SS2.SSS0.Px4.p1.4.m4.1.1.2" xref="S2.SS2.SSS0.Px4.p1.4.m4.1.1.2.cmml">λ</mi><mo id="S2.SS2.SSS0.Px4.p1.4.m4.1.1.1" xref="S2.SS2.SSS0.Px4.p1.4.m4.1.1.1.cmml">&gt;</mo><mn id="S2.SS2.SSS0.Px4.p1.4.m4.1.1.3" xref="S2.SS2.SSS0.Px4.p1.4.m4.1.1.3.cmml">0</mn></mrow><annotation-xml encoding="MathML-Content" id="S2.SS2.SSS0.Px4.p1.4.m4.1b"><apply id="S2.SS2.SSS0.Px4.p1.4.m4.1.1.cmml" xref="S2.SS2.SSS0.Px4.p1.4.m4.1.1"><gt id="S2.SS2.SSS0.Px4.p1.4.m4.1.1.1.cmml" xref="S2.SS2.SSS0.Px4.p1.4.m4.1.1.1"></gt><ci id="S2.SS2.SSS0.Px4.p1.4.m4.1.1.2.cmml" xref="S2.SS2.SSS0.Px4.p1.4.m4.1.1.2">𝜆</ci><cn type="integer" id="S2.SS2.SSS0.Px4.p1.4.m4.1.1.3.cmml" xref="S2.SS2.SSS0.Px4.p1.4.m4.1.1.3">0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.SSS0.Px4.p1.4.m4.1c">\lambda&gt;0</annotation></semantics></math>, it means personalization is encouraged. They further theorize about the definition and come up with an algorithmic independent theory. Furthermore, APFL <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib28" title="" class="ltx_ref">28</a>]</cite> determines each client’s contribution through optimization, with each client contributing to the global model while training its own local model.
APFL is also a communication-effective algorithm.
It is proved that the mixing of the local model and global model can reduce the generalization error.
Google researchers studied a systematic, individualized learning theory and analyzes three kinds of individualized methods <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib29" title="" class="ltx_ref">29</a>]</cite>, including user clustering, data interpolation, and model interpolation. Model interpolation is obtained from the weighted average of parameter of the local model and global model, and its performance is proved by theory and experiment.
FL+DE <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib8" title="" class="ltx_ref">8</a>]</cite> uses privacy-preserving FL to train a generic model and mixes it with each user’s private domain model using the MoE architecture.</p>
</div>
</section>
</section>
</section>
<section id="S3" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">III </span><span id="S3.1.1" class="ltx_text ltx_font_smallcaps">PFL-MoE</span>
</h2>

<div id="S3.p1" class="ltx_para">
<p id="S3.p1.1" class="ltx_p">PFL-MoE is a generic approach for personalization, which mainly contains the following three stages:</p>
</div>
<div id="S3.p2" class="ltx_para">
<ul id="S3.I1" class="ltx_itemize">
<li id="S3.I1.i1" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="S3.I1.i1.p1" class="ltx_para">
<p id="S3.I1.i1.p1.1" class="ltx_p"><span id="S3.I1.i1.p1.1.1" class="ltx_text ltx_font_italic">Federated Learning Stage:</span> Following the traditional FL framework, each client participates in FL training.
The global model is created by repeatedly aggregating model updates from small subsets of clients.
This stage is agnostic about the aggregation methods or privacy-preserving techniques of federated learning. It only needs the final global model for the next personalization.
</p>
</div>
</li>
<li id="S3.I1.i2" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="S3.I1.i2.p1" class="ltx_para">
<p id="S3.I1.i2.p1.1" class="ltx_p"><span id="S3.I1.i2.p1.1.1" class="ltx_text ltx_font_italic">Personalization Stage:</span> Each client downloads the latest global model from the FL server, and then conducts local adaption to get a personalized model based on the global model and local data.
</p>
</div>
</li>
<li id="S3.I1.i3" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="S3.I1.i3.p1" class="ltx_para">
<p id="S3.I1.i3.p1.1" class="ltx_p"><span id="S3.I1.i3.p1.1.1" class="ltx_text ltx_font_italic">Mixing Stage:</span> Via the previous two stages, the client gets two models, one is the personalized model, and the other is the global model. Based on the MoE architecture, the parameters of the gating network are trained to combine the models and make them work together.</p>
</div>
</li>
</ul>
</div>
<section id="S3.SS1" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection"><span id="S3.SS1.5.1.1" class="ltx_text">III-A</span> </span><span id="S3.SS1.6.2" class="ltx_text ltx_font_italic">Federated Learning</span>
</h3>

<div id="S3.SS1.p1" class="ltx_para">
<p id="S3.SS1.p1.6" class="ltx_p">In federated learning, we consider that the number of clients participating in training is N. We define the model structure of the global model as <math id="S3.SS1.p1.1.m1.1" class="ltx_Math" alttext="M_{G}" display="inline"><semantics id="S3.SS1.p1.1.m1.1a"><msub id="S3.SS1.p1.1.m1.1.1" xref="S3.SS1.p1.1.m1.1.1.cmml"><mi id="S3.SS1.p1.1.m1.1.1.2" xref="S3.SS1.p1.1.m1.1.1.2.cmml">M</mi><mi id="S3.SS1.p1.1.m1.1.1.3" xref="S3.SS1.p1.1.m1.1.1.3.cmml">G</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.1.m1.1b"><apply id="S3.SS1.p1.1.m1.1.1.cmml" xref="S3.SS1.p1.1.m1.1.1"><csymbol cd="ambiguous" id="S3.SS1.p1.1.m1.1.1.1.cmml" xref="S3.SS1.p1.1.m1.1.1">subscript</csymbol><ci id="S3.SS1.p1.1.m1.1.1.2.cmml" xref="S3.SS1.p1.1.m1.1.1.2">𝑀</ci><ci id="S3.SS1.p1.1.m1.1.1.3.cmml" xref="S3.SS1.p1.1.m1.1.1.3">𝐺</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.1.m1.1c">M_{G}</annotation></semantics></math>, and define the parameter of the global model as <math id="S3.SS1.p1.2.m2.1" class="ltx_Math" alttext="\theta" display="inline"><semantics id="S3.SS1.p1.2.m2.1a"><mi id="S3.SS1.p1.2.m2.1.1" xref="S3.SS1.p1.2.m2.1.1.cmml">θ</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.2.m2.1b"><ci id="S3.SS1.p1.2.m2.1.1.cmml" xref="S3.SS1.p1.2.m2.1.1">𝜃</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.2.m2.1c">\theta</annotation></semantics></math> (<math id="S3.SS1.p1.3.m3.1" class="ltx_Math" alttext="d_{1}" display="inline"><semantics id="S3.SS1.p1.3.m3.1a"><msub id="S3.SS1.p1.3.m3.1.1" xref="S3.SS1.p1.3.m3.1.1.cmml"><mi id="S3.SS1.p1.3.m3.1.1.2" xref="S3.SS1.p1.3.m3.1.1.2.cmml">d</mi><mn id="S3.SS1.p1.3.m3.1.1.3" xref="S3.SS1.p1.3.m3.1.1.3.cmml">1</mn></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.3.m3.1b"><apply id="S3.SS1.p1.3.m3.1.1.cmml" xref="S3.SS1.p1.3.m3.1.1"><csymbol cd="ambiguous" id="S3.SS1.p1.3.m3.1.1.1.cmml" xref="S3.SS1.p1.3.m3.1.1">subscript</csymbol><ci id="S3.SS1.p1.3.m3.1.1.2.cmml" xref="S3.SS1.p1.3.m3.1.1.2">𝑑</ci><cn type="integer" id="S3.SS1.p1.3.m3.1.1.3.cmml" xref="S3.SS1.p1.3.m3.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.3.m3.1c">d_{1}</annotation></semantics></math>-dimensional vector). At the beginning of training, the global model structure <math id="S3.SS1.p1.4.m4.1" class="ltx_Math" alttext="M_{G}" display="inline"><semantics id="S3.SS1.p1.4.m4.1a"><msub id="S3.SS1.p1.4.m4.1.1" xref="S3.SS1.p1.4.m4.1.1.cmml"><mi id="S3.SS1.p1.4.m4.1.1.2" xref="S3.SS1.p1.4.m4.1.1.2.cmml">M</mi><mi id="S3.SS1.p1.4.m4.1.1.3" xref="S3.SS1.p1.4.m4.1.1.3.cmml">G</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.4.m4.1b"><apply id="S3.SS1.p1.4.m4.1.1.cmml" xref="S3.SS1.p1.4.m4.1.1"><csymbol cd="ambiguous" id="S3.SS1.p1.4.m4.1.1.1.cmml" xref="S3.SS1.p1.4.m4.1.1">subscript</csymbol><ci id="S3.SS1.p1.4.m4.1.1.2.cmml" xref="S3.SS1.p1.4.m4.1.1.2">𝑀</ci><ci id="S3.SS1.p1.4.m4.1.1.3.cmml" xref="S3.SS1.p1.4.m4.1.1.3">𝐺</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.4.m4.1c">M_{G}</annotation></semantics></math> has been determined by the central FL server. The goal of federated learning is to find a <math id="S3.SS1.p1.5.m5.1" class="ltx_Math" alttext="\theta\in\mathbb{R}^{d_{1}}" display="inline"><semantics id="S3.SS1.p1.5.m5.1a"><mrow id="S3.SS1.p1.5.m5.1.1" xref="S3.SS1.p1.5.m5.1.1.cmml"><mi id="S3.SS1.p1.5.m5.1.1.2" xref="S3.SS1.p1.5.m5.1.1.2.cmml">θ</mi><mo id="S3.SS1.p1.5.m5.1.1.1" xref="S3.SS1.p1.5.m5.1.1.1.cmml">∈</mo><msup id="S3.SS1.p1.5.m5.1.1.3" xref="S3.SS1.p1.5.m5.1.1.3.cmml"><mi id="S3.SS1.p1.5.m5.1.1.3.2" xref="S3.SS1.p1.5.m5.1.1.3.2.cmml">ℝ</mi><msub id="S3.SS1.p1.5.m5.1.1.3.3" xref="S3.SS1.p1.5.m5.1.1.3.3.cmml"><mi id="S3.SS1.p1.5.m5.1.1.3.3.2" xref="S3.SS1.p1.5.m5.1.1.3.3.2.cmml">d</mi><mn id="S3.SS1.p1.5.m5.1.1.3.3.3" xref="S3.SS1.p1.5.m5.1.1.3.3.3.cmml">1</mn></msub></msup></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.5.m5.1b"><apply id="S3.SS1.p1.5.m5.1.1.cmml" xref="S3.SS1.p1.5.m5.1.1"><in id="S3.SS1.p1.5.m5.1.1.1.cmml" xref="S3.SS1.p1.5.m5.1.1.1"></in><ci id="S3.SS1.p1.5.m5.1.1.2.cmml" xref="S3.SS1.p1.5.m5.1.1.2">𝜃</ci><apply id="S3.SS1.p1.5.m5.1.1.3.cmml" xref="S3.SS1.p1.5.m5.1.1.3"><csymbol cd="ambiguous" id="S3.SS1.p1.5.m5.1.1.3.1.cmml" xref="S3.SS1.p1.5.m5.1.1.3">superscript</csymbol><ci id="S3.SS1.p1.5.m5.1.1.3.2.cmml" xref="S3.SS1.p1.5.m5.1.1.3.2">ℝ</ci><apply id="S3.SS1.p1.5.m5.1.1.3.3.cmml" xref="S3.SS1.p1.5.m5.1.1.3.3"><csymbol cd="ambiguous" id="S3.SS1.p1.5.m5.1.1.3.3.1.cmml" xref="S3.SS1.p1.5.m5.1.1.3.3">subscript</csymbol><ci id="S3.SS1.p1.5.m5.1.1.3.3.2.cmml" xref="S3.SS1.p1.5.m5.1.1.3.3.2">𝑑</ci><cn type="integer" id="S3.SS1.p1.5.m5.1.1.3.3.3.cmml" xref="S3.SS1.p1.5.m5.1.1.3.3.3">1</cn></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.5.m5.1c">\theta\in\mathbb{R}^{d_{1}}</annotation></semantics></math> that makes the average expected loss of all clients minimal.
We define <math id="S3.SS1.p1.6.m6.1" class="ltx_Math" alttext="F:\mathbb{R}^{d_{1}}\rightarrow\mathbb{R}" display="inline"><semantics id="S3.SS1.p1.6.m6.1a"><mrow id="S3.SS1.p1.6.m6.1.1" xref="S3.SS1.p1.6.m6.1.1.cmml"><mi id="S3.SS1.p1.6.m6.1.1.2" xref="S3.SS1.p1.6.m6.1.1.2.cmml">F</mi><mo lspace="0.278em" rspace="0.278em" id="S3.SS1.p1.6.m6.1.1.1" xref="S3.SS1.p1.6.m6.1.1.1.cmml">:</mo><mrow id="S3.SS1.p1.6.m6.1.1.3" xref="S3.SS1.p1.6.m6.1.1.3.cmml"><msup id="S3.SS1.p1.6.m6.1.1.3.2" xref="S3.SS1.p1.6.m6.1.1.3.2.cmml"><mi id="S3.SS1.p1.6.m6.1.1.3.2.2" xref="S3.SS1.p1.6.m6.1.1.3.2.2.cmml">ℝ</mi><msub id="S3.SS1.p1.6.m6.1.1.3.2.3" xref="S3.SS1.p1.6.m6.1.1.3.2.3.cmml"><mi id="S3.SS1.p1.6.m6.1.1.3.2.3.2" xref="S3.SS1.p1.6.m6.1.1.3.2.3.2.cmml">d</mi><mn id="S3.SS1.p1.6.m6.1.1.3.2.3.3" xref="S3.SS1.p1.6.m6.1.1.3.2.3.3.cmml">1</mn></msub></msup><mo stretchy="false" id="S3.SS1.p1.6.m6.1.1.3.1" xref="S3.SS1.p1.6.m6.1.1.3.1.cmml">→</mo><mi id="S3.SS1.p1.6.m6.1.1.3.3" xref="S3.SS1.p1.6.m6.1.1.3.3.cmml">ℝ</mi></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.6.m6.1b"><apply id="S3.SS1.p1.6.m6.1.1.cmml" xref="S3.SS1.p1.6.m6.1.1"><ci id="S3.SS1.p1.6.m6.1.1.1.cmml" xref="S3.SS1.p1.6.m6.1.1.1">:</ci><ci id="S3.SS1.p1.6.m6.1.1.2.cmml" xref="S3.SS1.p1.6.m6.1.1.2">𝐹</ci><apply id="S3.SS1.p1.6.m6.1.1.3.cmml" xref="S3.SS1.p1.6.m6.1.1.3"><ci id="S3.SS1.p1.6.m6.1.1.3.1.cmml" xref="S3.SS1.p1.6.m6.1.1.3.1">→</ci><apply id="S3.SS1.p1.6.m6.1.1.3.2.cmml" xref="S3.SS1.p1.6.m6.1.1.3.2"><csymbol cd="ambiguous" id="S3.SS1.p1.6.m6.1.1.3.2.1.cmml" xref="S3.SS1.p1.6.m6.1.1.3.2">superscript</csymbol><ci id="S3.SS1.p1.6.m6.1.1.3.2.2.cmml" xref="S3.SS1.p1.6.m6.1.1.3.2.2">ℝ</ci><apply id="S3.SS1.p1.6.m6.1.1.3.2.3.cmml" xref="S3.SS1.p1.6.m6.1.1.3.2.3"><csymbol cd="ambiguous" id="S3.SS1.p1.6.m6.1.1.3.2.3.1.cmml" xref="S3.SS1.p1.6.m6.1.1.3.2.3">subscript</csymbol><ci id="S3.SS1.p1.6.m6.1.1.3.2.3.2.cmml" xref="S3.SS1.p1.6.m6.1.1.3.2.3.2">𝑑</ci><cn type="integer" id="S3.SS1.p1.6.m6.1.1.3.2.3.3.cmml" xref="S3.SS1.p1.6.m6.1.1.3.2.3.3">1</cn></apply></apply><ci id="S3.SS1.p1.6.m6.1.1.3.3.cmml" xref="S3.SS1.p1.6.m6.1.1.3.3">ℝ</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.6.m6.1c">F:\mathbb{R}^{d_{1}}\rightarrow\mathbb{R}</annotation></semantics></math> as the global loss of FL, so the learning goal of FL is the following formula:</p>
<table id="S3.E1" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S3.E1.m1.2" class="ltx_Math" alttext="\min_{\theta\in\mathbb{R}^{d_{1}}}F(\theta)=\frac{1}{N}\sum_{i=1}^{N}f_{i}(\theta)" display="block"><semantics id="S3.E1.m1.2a"><mrow id="S3.E1.m1.2.3" xref="S3.E1.m1.2.3.cmml"><mrow id="S3.E1.m1.2.3.2" xref="S3.E1.m1.2.3.2.cmml"><mrow id="S3.E1.m1.2.3.2.2" xref="S3.E1.m1.2.3.2.2.cmml"><munder id="S3.E1.m1.2.3.2.2.1" xref="S3.E1.m1.2.3.2.2.1.cmml"><mi id="S3.E1.m1.2.3.2.2.1.2" xref="S3.E1.m1.2.3.2.2.1.2.cmml">min</mi><mrow id="S3.E1.m1.2.3.2.2.1.3" xref="S3.E1.m1.2.3.2.2.1.3.cmml"><mi id="S3.E1.m1.2.3.2.2.1.3.2" xref="S3.E1.m1.2.3.2.2.1.3.2.cmml">θ</mi><mo id="S3.E1.m1.2.3.2.2.1.3.1" xref="S3.E1.m1.2.3.2.2.1.3.1.cmml">∈</mo><msup id="S3.E1.m1.2.3.2.2.1.3.3" xref="S3.E1.m1.2.3.2.2.1.3.3.cmml"><mi id="S3.E1.m1.2.3.2.2.1.3.3.2" xref="S3.E1.m1.2.3.2.2.1.3.3.2.cmml">ℝ</mi><msub id="S3.E1.m1.2.3.2.2.1.3.3.3" xref="S3.E1.m1.2.3.2.2.1.3.3.3.cmml"><mi id="S3.E1.m1.2.3.2.2.1.3.3.3.2" xref="S3.E1.m1.2.3.2.2.1.3.3.3.2.cmml">d</mi><mn id="S3.E1.m1.2.3.2.2.1.3.3.3.3" xref="S3.E1.m1.2.3.2.2.1.3.3.3.3.cmml">1</mn></msub></msup></mrow></munder><mo lspace="0.167em" id="S3.E1.m1.2.3.2.2a" xref="S3.E1.m1.2.3.2.2.cmml">⁡</mo><mi id="S3.E1.m1.2.3.2.2.2" xref="S3.E1.m1.2.3.2.2.2.cmml">F</mi></mrow><mo lspace="0em" rspace="0em" id="S3.E1.m1.2.3.2.1" xref="S3.E1.m1.2.3.2.1.cmml">​</mo><mrow id="S3.E1.m1.2.3.2.3.2" xref="S3.E1.m1.2.3.2.cmml"><mo stretchy="false" id="S3.E1.m1.2.3.2.3.2.1" xref="S3.E1.m1.2.3.2.cmml">(</mo><mi id="S3.E1.m1.1.1" xref="S3.E1.m1.1.1.cmml">θ</mi><mo stretchy="false" id="S3.E1.m1.2.3.2.3.2.2" xref="S3.E1.m1.2.3.2.cmml">)</mo></mrow></mrow><mo id="S3.E1.m1.2.3.1" xref="S3.E1.m1.2.3.1.cmml">=</mo><mrow id="S3.E1.m1.2.3.3" xref="S3.E1.m1.2.3.3.cmml"><mfrac id="S3.E1.m1.2.3.3.2" xref="S3.E1.m1.2.3.3.2.cmml"><mn id="S3.E1.m1.2.3.3.2.2" xref="S3.E1.m1.2.3.3.2.2.cmml">1</mn><mi id="S3.E1.m1.2.3.3.2.3" xref="S3.E1.m1.2.3.3.2.3.cmml">N</mi></mfrac><mo lspace="0em" rspace="0em" id="S3.E1.m1.2.3.3.1" xref="S3.E1.m1.2.3.3.1.cmml">​</mo><mrow id="S3.E1.m1.2.3.3.3" xref="S3.E1.m1.2.3.3.3.cmml"><munderover id="S3.E1.m1.2.3.3.3.1" xref="S3.E1.m1.2.3.3.3.1.cmml"><mo movablelimits="false" id="S3.E1.m1.2.3.3.3.1.2.2" xref="S3.E1.m1.2.3.3.3.1.2.2.cmml">∑</mo><mrow id="S3.E1.m1.2.3.3.3.1.2.3" xref="S3.E1.m1.2.3.3.3.1.2.3.cmml"><mi id="S3.E1.m1.2.3.3.3.1.2.3.2" xref="S3.E1.m1.2.3.3.3.1.2.3.2.cmml">i</mi><mo id="S3.E1.m1.2.3.3.3.1.2.3.1" xref="S3.E1.m1.2.3.3.3.1.2.3.1.cmml">=</mo><mn id="S3.E1.m1.2.3.3.3.1.2.3.3" xref="S3.E1.m1.2.3.3.3.1.2.3.3.cmml">1</mn></mrow><mi id="S3.E1.m1.2.3.3.3.1.3" xref="S3.E1.m1.2.3.3.3.1.3.cmml">N</mi></munderover><mrow id="S3.E1.m1.2.3.3.3.2" xref="S3.E1.m1.2.3.3.3.2.cmml"><msub id="S3.E1.m1.2.3.3.3.2.2" xref="S3.E1.m1.2.3.3.3.2.2.cmml"><mi id="S3.E1.m1.2.3.3.3.2.2.2" xref="S3.E1.m1.2.3.3.3.2.2.2.cmml">f</mi><mi id="S3.E1.m1.2.3.3.3.2.2.3" xref="S3.E1.m1.2.3.3.3.2.2.3.cmml">i</mi></msub><mo lspace="0em" rspace="0em" id="S3.E1.m1.2.3.3.3.2.1" xref="S3.E1.m1.2.3.3.3.2.1.cmml">​</mo><mrow id="S3.E1.m1.2.3.3.3.2.3.2" xref="S3.E1.m1.2.3.3.3.2.cmml"><mo stretchy="false" id="S3.E1.m1.2.3.3.3.2.3.2.1" xref="S3.E1.m1.2.3.3.3.2.cmml">(</mo><mi id="S3.E1.m1.2.2" xref="S3.E1.m1.2.2.cmml">θ</mi><mo stretchy="false" id="S3.E1.m1.2.3.3.3.2.3.2.2" xref="S3.E1.m1.2.3.3.3.2.cmml">)</mo></mrow></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.E1.m1.2b"><apply id="S3.E1.m1.2.3.cmml" xref="S3.E1.m1.2.3"><eq id="S3.E1.m1.2.3.1.cmml" xref="S3.E1.m1.2.3.1"></eq><apply id="S3.E1.m1.2.3.2.cmml" xref="S3.E1.m1.2.3.2"><times id="S3.E1.m1.2.3.2.1.cmml" xref="S3.E1.m1.2.3.2.1"></times><apply id="S3.E1.m1.2.3.2.2.cmml" xref="S3.E1.m1.2.3.2.2"><apply id="S3.E1.m1.2.3.2.2.1.cmml" xref="S3.E1.m1.2.3.2.2.1"><csymbol cd="ambiguous" id="S3.E1.m1.2.3.2.2.1.1.cmml" xref="S3.E1.m1.2.3.2.2.1">subscript</csymbol><min id="S3.E1.m1.2.3.2.2.1.2.cmml" xref="S3.E1.m1.2.3.2.2.1.2"></min><apply id="S3.E1.m1.2.3.2.2.1.3.cmml" xref="S3.E1.m1.2.3.2.2.1.3"><in id="S3.E1.m1.2.3.2.2.1.3.1.cmml" xref="S3.E1.m1.2.3.2.2.1.3.1"></in><ci id="S3.E1.m1.2.3.2.2.1.3.2.cmml" xref="S3.E1.m1.2.3.2.2.1.3.2">𝜃</ci><apply id="S3.E1.m1.2.3.2.2.1.3.3.cmml" xref="S3.E1.m1.2.3.2.2.1.3.3"><csymbol cd="ambiguous" id="S3.E1.m1.2.3.2.2.1.3.3.1.cmml" xref="S3.E1.m1.2.3.2.2.1.3.3">superscript</csymbol><ci id="S3.E1.m1.2.3.2.2.1.3.3.2.cmml" xref="S3.E1.m1.2.3.2.2.1.3.3.2">ℝ</ci><apply id="S3.E1.m1.2.3.2.2.1.3.3.3.cmml" xref="S3.E1.m1.2.3.2.2.1.3.3.3"><csymbol cd="ambiguous" id="S3.E1.m1.2.3.2.2.1.3.3.3.1.cmml" xref="S3.E1.m1.2.3.2.2.1.3.3.3">subscript</csymbol><ci id="S3.E1.m1.2.3.2.2.1.3.3.3.2.cmml" xref="S3.E1.m1.2.3.2.2.1.3.3.3.2">𝑑</ci><cn type="integer" id="S3.E1.m1.2.3.2.2.1.3.3.3.3.cmml" xref="S3.E1.m1.2.3.2.2.1.3.3.3.3">1</cn></apply></apply></apply></apply><ci id="S3.E1.m1.2.3.2.2.2.cmml" xref="S3.E1.m1.2.3.2.2.2">𝐹</ci></apply><ci id="S3.E1.m1.1.1.cmml" xref="S3.E1.m1.1.1">𝜃</ci></apply><apply id="S3.E1.m1.2.3.3.cmml" xref="S3.E1.m1.2.3.3"><times id="S3.E1.m1.2.3.3.1.cmml" xref="S3.E1.m1.2.3.3.1"></times><apply id="S3.E1.m1.2.3.3.2.cmml" xref="S3.E1.m1.2.3.3.2"><divide id="S3.E1.m1.2.3.3.2.1.cmml" xref="S3.E1.m1.2.3.3.2"></divide><cn type="integer" id="S3.E1.m1.2.3.3.2.2.cmml" xref="S3.E1.m1.2.3.3.2.2">1</cn><ci id="S3.E1.m1.2.3.3.2.3.cmml" xref="S3.E1.m1.2.3.3.2.3">𝑁</ci></apply><apply id="S3.E1.m1.2.3.3.3.cmml" xref="S3.E1.m1.2.3.3.3"><apply id="S3.E1.m1.2.3.3.3.1.cmml" xref="S3.E1.m1.2.3.3.3.1"><csymbol cd="ambiguous" id="S3.E1.m1.2.3.3.3.1.1.cmml" xref="S3.E1.m1.2.3.3.3.1">superscript</csymbol><apply id="S3.E1.m1.2.3.3.3.1.2.cmml" xref="S3.E1.m1.2.3.3.3.1"><csymbol cd="ambiguous" id="S3.E1.m1.2.3.3.3.1.2.1.cmml" xref="S3.E1.m1.2.3.3.3.1">subscript</csymbol><sum id="S3.E1.m1.2.3.3.3.1.2.2.cmml" xref="S3.E1.m1.2.3.3.3.1.2.2"></sum><apply id="S3.E1.m1.2.3.3.3.1.2.3.cmml" xref="S3.E1.m1.2.3.3.3.1.2.3"><eq id="S3.E1.m1.2.3.3.3.1.2.3.1.cmml" xref="S3.E1.m1.2.3.3.3.1.2.3.1"></eq><ci id="S3.E1.m1.2.3.3.3.1.2.3.2.cmml" xref="S3.E1.m1.2.3.3.3.1.2.3.2">𝑖</ci><cn type="integer" id="S3.E1.m1.2.3.3.3.1.2.3.3.cmml" xref="S3.E1.m1.2.3.3.3.1.2.3.3">1</cn></apply></apply><ci id="S3.E1.m1.2.3.3.3.1.3.cmml" xref="S3.E1.m1.2.3.3.3.1.3">𝑁</ci></apply><apply id="S3.E1.m1.2.3.3.3.2.cmml" xref="S3.E1.m1.2.3.3.3.2"><times id="S3.E1.m1.2.3.3.3.2.1.cmml" xref="S3.E1.m1.2.3.3.3.2.1"></times><apply id="S3.E1.m1.2.3.3.3.2.2.cmml" xref="S3.E1.m1.2.3.3.3.2.2"><csymbol cd="ambiguous" id="S3.E1.m1.2.3.3.3.2.2.1.cmml" xref="S3.E1.m1.2.3.3.3.2.2">subscript</csymbol><ci id="S3.E1.m1.2.3.3.3.2.2.2.cmml" xref="S3.E1.m1.2.3.3.3.2.2.2">𝑓</ci><ci id="S3.E1.m1.2.3.3.3.2.2.3.cmml" xref="S3.E1.m1.2.3.3.3.2.2.3">𝑖</ci></apply><ci id="S3.E1.m1.2.2.cmml" xref="S3.E1.m1.2.2">𝜃</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E1.m1.2c">\min_{\theta\in\mathbb{R}^{d_{1}}}F(\theta)=\frac{1}{N}\sum_{i=1}^{N}f_{i}(\theta)</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(1)</span></td>
</tr></tbody>
</table>
<p id="S3.SS1.p1.12" class="ltx_p">Since the data of each client follow a different distribution, we define the data distribution of the client <math id="S3.SS1.p1.7.m1.1" class="ltx_Math" alttext="i" display="inline"><semantics id="S3.SS1.p1.7.m1.1a"><mi id="S3.SS1.p1.7.m1.1.1" xref="S3.SS1.p1.7.m1.1.1.cmml">i</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.7.m1.1b"><ci id="S3.SS1.p1.7.m1.1.1.cmml" xref="S3.SS1.p1.7.m1.1.1">𝑖</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.7.m1.1c">i</annotation></semantics></math> as <math id="S3.SS1.p1.8.m2.1" class="ltx_Math" alttext="\mathcal{D}_{i}" display="inline"><semantics id="S3.SS1.p1.8.m2.1a"><msub id="S3.SS1.p1.8.m2.1.1" xref="S3.SS1.p1.8.m2.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS1.p1.8.m2.1.1.2" xref="S3.SS1.p1.8.m2.1.1.2.cmml">𝒟</mi><mi id="S3.SS1.p1.8.m2.1.1.3" xref="S3.SS1.p1.8.m2.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.8.m2.1b"><apply id="S3.SS1.p1.8.m2.1.1.cmml" xref="S3.SS1.p1.8.m2.1.1"><csymbol cd="ambiguous" id="S3.SS1.p1.8.m2.1.1.1.cmml" xref="S3.SS1.p1.8.m2.1.1">subscript</csymbol><ci id="S3.SS1.p1.8.m2.1.1.2.cmml" xref="S3.SS1.p1.8.m2.1.1.2">𝒟</ci><ci id="S3.SS1.p1.8.m2.1.1.3.cmml" xref="S3.SS1.p1.8.m2.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.8.m2.1c">\mathcal{D}_{i}</annotation></semantics></math>. We define the expected loss over <math id="S3.SS1.p1.9.m3.1" class="ltx_Math" alttext="\mathcal{D}_{i}" display="inline"><semantics id="S3.SS1.p1.9.m3.1a"><msub id="S3.SS1.p1.9.m3.1.1" xref="S3.SS1.p1.9.m3.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS1.p1.9.m3.1.1.2" xref="S3.SS1.p1.9.m3.1.1.2.cmml">𝒟</mi><mi id="S3.SS1.p1.9.m3.1.1.3" xref="S3.SS1.p1.9.m3.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.9.m3.1b"><apply id="S3.SS1.p1.9.m3.1.1.cmml" xref="S3.SS1.p1.9.m3.1.1"><csymbol cd="ambiguous" id="S3.SS1.p1.9.m3.1.1.1.cmml" xref="S3.SS1.p1.9.m3.1.1">subscript</csymbol><ci id="S3.SS1.p1.9.m3.1.1.2.cmml" xref="S3.SS1.p1.9.m3.1.1.2">𝒟</ci><ci id="S3.SS1.p1.9.m3.1.1.3.cmml" xref="S3.SS1.p1.9.m3.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.9.m3.1c">\mathcal{D}_{i}</annotation></semantics></math> of the client <math id="S3.SS1.p1.10.m4.1" class="ltx_Math" alttext="i" display="inline"><semantics id="S3.SS1.p1.10.m4.1a"><mi id="S3.SS1.p1.10.m4.1.1" xref="S3.SS1.p1.10.m4.1.1.cmml">i</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.10.m4.1b"><ci id="S3.SS1.p1.10.m4.1.1.cmml" xref="S3.SS1.p1.10.m4.1.1">𝑖</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.10.m4.1c">i</annotation></semantics></math> as <math id="S3.SS1.p1.11.m5.1" class="ltx_Math" alttext="f_{i}" display="inline"><semantics id="S3.SS1.p1.11.m5.1a"><msub id="S3.SS1.p1.11.m5.1.1" xref="S3.SS1.p1.11.m5.1.1.cmml"><mi id="S3.SS1.p1.11.m5.1.1.2" xref="S3.SS1.p1.11.m5.1.1.2.cmml">f</mi><mi id="S3.SS1.p1.11.m5.1.1.3" xref="S3.SS1.p1.11.m5.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.11.m5.1b"><apply id="S3.SS1.p1.11.m5.1.1.cmml" xref="S3.SS1.p1.11.m5.1.1"><csymbol cd="ambiguous" id="S3.SS1.p1.11.m5.1.1.1.cmml" xref="S3.SS1.p1.11.m5.1.1">subscript</csymbol><ci id="S3.SS1.p1.11.m5.1.1.2.cmml" xref="S3.SS1.p1.11.m5.1.1.2">𝑓</ci><ci id="S3.SS1.p1.11.m5.1.1.3.cmml" xref="S3.SS1.p1.11.m5.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.11.m5.1c">f_{i}</annotation></semantics></math>. In particular, we assume that the learning is a supervised learning task. At this time, <math id="S3.SS1.p1.12.m6.1" class="ltx_Math" alttext="f_{i}" display="inline"><semantics id="S3.SS1.p1.12.m6.1a"><msub id="S3.SS1.p1.12.m6.1.1" xref="S3.SS1.p1.12.m6.1.1.cmml"><mi id="S3.SS1.p1.12.m6.1.1.2" xref="S3.SS1.p1.12.m6.1.1.2.cmml">f</mi><mi id="S3.SS1.p1.12.m6.1.1.3" xref="S3.SS1.p1.12.m6.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.12.m6.1b"><apply id="S3.SS1.p1.12.m6.1.1.cmml" xref="S3.SS1.p1.12.m6.1.1"><csymbol cd="ambiguous" id="S3.SS1.p1.12.m6.1.1.1.cmml" xref="S3.SS1.p1.12.m6.1.1">subscript</csymbol><ci id="S3.SS1.p1.12.m6.1.1.2.cmml" xref="S3.SS1.p1.12.m6.1.1.2">𝑓</ci><ci id="S3.SS1.p1.12.m6.1.1.3.cmml" xref="S3.SS1.p1.12.m6.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.12.m6.1c">f_{i}</annotation></semantics></math> can be written as:</p>
</div>
<div id="S3.SS1.p2" class="ltx_para">
<table id="S3.E2" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S3.E2.m1.7" class="ltx_Math" alttext="f_{i}(\theta)=\mathbb{E}_{(x,y)\sim\mathcal{D}_{i}}[L_{i}(M_{G}(\theta;x),y)]" display="block"><semantics id="S3.E2.m1.7a"><mrow id="S3.E2.m1.7.7" xref="S3.E2.m1.7.7.cmml"><mrow id="S3.E2.m1.7.7.3" xref="S3.E2.m1.7.7.3.cmml"><msub id="S3.E2.m1.7.7.3.2" xref="S3.E2.m1.7.7.3.2.cmml"><mi id="S3.E2.m1.7.7.3.2.2" xref="S3.E2.m1.7.7.3.2.2.cmml">f</mi><mi id="S3.E2.m1.7.7.3.2.3" xref="S3.E2.m1.7.7.3.2.3.cmml">i</mi></msub><mo lspace="0em" rspace="0em" id="S3.E2.m1.7.7.3.1" xref="S3.E2.m1.7.7.3.1.cmml">​</mo><mrow id="S3.E2.m1.7.7.3.3.2" xref="S3.E2.m1.7.7.3.cmml"><mo stretchy="false" id="S3.E2.m1.7.7.3.3.2.1" xref="S3.E2.m1.7.7.3.cmml">(</mo><mi id="S3.E2.m1.3.3" xref="S3.E2.m1.3.3.cmml">θ</mi><mo stretchy="false" id="S3.E2.m1.7.7.3.3.2.2" xref="S3.E2.m1.7.7.3.cmml">)</mo></mrow></mrow><mo id="S3.E2.m1.7.7.2" xref="S3.E2.m1.7.7.2.cmml">=</mo><mrow id="S3.E2.m1.7.7.1" xref="S3.E2.m1.7.7.1.cmml"><msub id="S3.E2.m1.7.7.1.3" xref="S3.E2.m1.7.7.1.3.cmml"><mi id="S3.E2.m1.7.7.1.3.2" xref="S3.E2.m1.7.7.1.3.2.cmml">𝔼</mi><mrow id="S3.E2.m1.2.2.2" xref="S3.E2.m1.2.2.2.cmml"><mrow id="S3.E2.m1.2.2.2.4.2" xref="S3.E2.m1.2.2.2.4.1.cmml"><mo stretchy="false" id="S3.E2.m1.2.2.2.4.2.1" xref="S3.E2.m1.2.2.2.4.1.cmml">(</mo><mi id="S3.E2.m1.1.1.1.1" xref="S3.E2.m1.1.1.1.1.cmml">x</mi><mo id="S3.E2.m1.2.2.2.4.2.2" xref="S3.E2.m1.2.2.2.4.1.cmml">,</mo><mi id="S3.E2.m1.2.2.2.2" xref="S3.E2.m1.2.2.2.2.cmml">y</mi><mo stretchy="false" id="S3.E2.m1.2.2.2.4.2.3" xref="S3.E2.m1.2.2.2.4.1.cmml">)</mo></mrow><mo id="S3.E2.m1.2.2.2.3" xref="S3.E2.m1.2.2.2.3.cmml">∼</mo><msub id="S3.E2.m1.2.2.2.5" xref="S3.E2.m1.2.2.2.5.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.E2.m1.2.2.2.5.2" xref="S3.E2.m1.2.2.2.5.2.cmml">𝒟</mi><mi id="S3.E2.m1.2.2.2.5.3" xref="S3.E2.m1.2.2.2.5.3.cmml">i</mi></msub></mrow></msub><mo lspace="0em" rspace="0em" id="S3.E2.m1.7.7.1.2" xref="S3.E2.m1.7.7.1.2.cmml">​</mo><mrow id="S3.E2.m1.7.7.1.1.1" xref="S3.E2.m1.7.7.1.1.2.cmml"><mo stretchy="false" id="S3.E2.m1.7.7.1.1.1.2" xref="S3.E2.m1.7.7.1.1.2.1.cmml">[</mo><mrow id="S3.E2.m1.7.7.1.1.1.1" xref="S3.E2.m1.7.7.1.1.1.1.cmml"><msub id="S3.E2.m1.7.7.1.1.1.1.3" xref="S3.E2.m1.7.7.1.1.1.1.3.cmml"><mi id="S3.E2.m1.7.7.1.1.1.1.3.2" xref="S3.E2.m1.7.7.1.1.1.1.3.2.cmml">L</mi><mi id="S3.E2.m1.7.7.1.1.1.1.3.3" xref="S3.E2.m1.7.7.1.1.1.1.3.3.cmml">i</mi></msub><mo lspace="0em" rspace="0em" id="S3.E2.m1.7.7.1.1.1.1.2" xref="S3.E2.m1.7.7.1.1.1.1.2.cmml">​</mo><mrow id="S3.E2.m1.7.7.1.1.1.1.1.1" xref="S3.E2.m1.7.7.1.1.1.1.1.2.cmml"><mo stretchy="false" id="S3.E2.m1.7.7.1.1.1.1.1.1.2" xref="S3.E2.m1.7.7.1.1.1.1.1.2.cmml">(</mo><mrow id="S3.E2.m1.7.7.1.1.1.1.1.1.1" xref="S3.E2.m1.7.7.1.1.1.1.1.1.1.cmml"><msub id="S3.E2.m1.7.7.1.1.1.1.1.1.1.2" xref="S3.E2.m1.7.7.1.1.1.1.1.1.1.2.cmml"><mi id="S3.E2.m1.7.7.1.1.1.1.1.1.1.2.2" xref="S3.E2.m1.7.7.1.1.1.1.1.1.1.2.2.cmml">M</mi><mi id="S3.E2.m1.7.7.1.1.1.1.1.1.1.2.3" xref="S3.E2.m1.7.7.1.1.1.1.1.1.1.2.3.cmml">G</mi></msub><mo lspace="0em" rspace="0em" id="S3.E2.m1.7.7.1.1.1.1.1.1.1.1" xref="S3.E2.m1.7.7.1.1.1.1.1.1.1.1.cmml">​</mo><mrow id="S3.E2.m1.7.7.1.1.1.1.1.1.1.3.2" xref="S3.E2.m1.7.7.1.1.1.1.1.1.1.3.1.cmml"><mo stretchy="false" id="S3.E2.m1.7.7.1.1.1.1.1.1.1.3.2.1" xref="S3.E2.m1.7.7.1.1.1.1.1.1.1.3.1.cmml">(</mo><mi id="S3.E2.m1.4.4" xref="S3.E2.m1.4.4.cmml">θ</mi><mo id="S3.E2.m1.7.7.1.1.1.1.1.1.1.3.2.2" xref="S3.E2.m1.7.7.1.1.1.1.1.1.1.3.1.cmml">;</mo><mi id="S3.E2.m1.5.5" xref="S3.E2.m1.5.5.cmml">x</mi><mo stretchy="false" id="S3.E2.m1.7.7.1.1.1.1.1.1.1.3.2.3" xref="S3.E2.m1.7.7.1.1.1.1.1.1.1.3.1.cmml">)</mo></mrow></mrow><mo id="S3.E2.m1.7.7.1.1.1.1.1.1.3" xref="S3.E2.m1.7.7.1.1.1.1.1.2.cmml">,</mo><mi id="S3.E2.m1.6.6" xref="S3.E2.m1.6.6.cmml">y</mi><mo stretchy="false" id="S3.E2.m1.7.7.1.1.1.1.1.1.4" xref="S3.E2.m1.7.7.1.1.1.1.1.2.cmml">)</mo></mrow></mrow><mo stretchy="false" id="S3.E2.m1.7.7.1.1.1.3" xref="S3.E2.m1.7.7.1.1.2.1.cmml">]</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.E2.m1.7b"><apply id="S3.E2.m1.7.7.cmml" xref="S3.E2.m1.7.7"><eq id="S3.E2.m1.7.7.2.cmml" xref="S3.E2.m1.7.7.2"></eq><apply id="S3.E2.m1.7.7.3.cmml" xref="S3.E2.m1.7.7.3"><times id="S3.E2.m1.7.7.3.1.cmml" xref="S3.E2.m1.7.7.3.1"></times><apply id="S3.E2.m1.7.7.3.2.cmml" xref="S3.E2.m1.7.7.3.2"><csymbol cd="ambiguous" id="S3.E2.m1.7.7.3.2.1.cmml" xref="S3.E2.m1.7.7.3.2">subscript</csymbol><ci id="S3.E2.m1.7.7.3.2.2.cmml" xref="S3.E2.m1.7.7.3.2.2">𝑓</ci><ci id="S3.E2.m1.7.7.3.2.3.cmml" xref="S3.E2.m1.7.7.3.2.3">𝑖</ci></apply><ci id="S3.E2.m1.3.3.cmml" xref="S3.E2.m1.3.3">𝜃</ci></apply><apply id="S3.E2.m1.7.7.1.cmml" xref="S3.E2.m1.7.7.1"><times id="S3.E2.m1.7.7.1.2.cmml" xref="S3.E2.m1.7.7.1.2"></times><apply id="S3.E2.m1.7.7.1.3.cmml" xref="S3.E2.m1.7.7.1.3"><csymbol cd="ambiguous" id="S3.E2.m1.7.7.1.3.1.cmml" xref="S3.E2.m1.7.7.1.3">subscript</csymbol><ci id="S3.E2.m1.7.7.1.3.2.cmml" xref="S3.E2.m1.7.7.1.3.2">𝔼</ci><apply id="S3.E2.m1.2.2.2.cmml" xref="S3.E2.m1.2.2.2"><csymbol cd="latexml" id="S3.E2.m1.2.2.2.3.cmml" xref="S3.E2.m1.2.2.2.3">similar-to</csymbol><interval closure="open" id="S3.E2.m1.2.2.2.4.1.cmml" xref="S3.E2.m1.2.2.2.4.2"><ci id="S3.E2.m1.1.1.1.1.cmml" xref="S3.E2.m1.1.1.1.1">𝑥</ci><ci id="S3.E2.m1.2.2.2.2.cmml" xref="S3.E2.m1.2.2.2.2">𝑦</ci></interval><apply id="S3.E2.m1.2.2.2.5.cmml" xref="S3.E2.m1.2.2.2.5"><csymbol cd="ambiguous" id="S3.E2.m1.2.2.2.5.1.cmml" xref="S3.E2.m1.2.2.2.5">subscript</csymbol><ci id="S3.E2.m1.2.2.2.5.2.cmml" xref="S3.E2.m1.2.2.2.5.2">𝒟</ci><ci id="S3.E2.m1.2.2.2.5.3.cmml" xref="S3.E2.m1.2.2.2.5.3">𝑖</ci></apply></apply></apply><apply id="S3.E2.m1.7.7.1.1.2.cmml" xref="S3.E2.m1.7.7.1.1.1"><csymbol cd="latexml" id="S3.E2.m1.7.7.1.1.2.1.cmml" xref="S3.E2.m1.7.7.1.1.1.2">delimited-[]</csymbol><apply id="S3.E2.m1.7.7.1.1.1.1.cmml" xref="S3.E2.m1.7.7.1.1.1.1"><times id="S3.E2.m1.7.7.1.1.1.1.2.cmml" xref="S3.E2.m1.7.7.1.1.1.1.2"></times><apply id="S3.E2.m1.7.7.1.1.1.1.3.cmml" xref="S3.E2.m1.7.7.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.E2.m1.7.7.1.1.1.1.3.1.cmml" xref="S3.E2.m1.7.7.1.1.1.1.3">subscript</csymbol><ci id="S3.E2.m1.7.7.1.1.1.1.3.2.cmml" xref="S3.E2.m1.7.7.1.1.1.1.3.2">𝐿</ci><ci id="S3.E2.m1.7.7.1.1.1.1.3.3.cmml" xref="S3.E2.m1.7.7.1.1.1.1.3.3">𝑖</ci></apply><interval closure="open" id="S3.E2.m1.7.7.1.1.1.1.1.2.cmml" xref="S3.E2.m1.7.7.1.1.1.1.1.1"><apply id="S3.E2.m1.7.7.1.1.1.1.1.1.1.cmml" xref="S3.E2.m1.7.7.1.1.1.1.1.1.1"><times id="S3.E2.m1.7.7.1.1.1.1.1.1.1.1.cmml" xref="S3.E2.m1.7.7.1.1.1.1.1.1.1.1"></times><apply id="S3.E2.m1.7.7.1.1.1.1.1.1.1.2.cmml" xref="S3.E2.m1.7.7.1.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.E2.m1.7.7.1.1.1.1.1.1.1.2.1.cmml" xref="S3.E2.m1.7.7.1.1.1.1.1.1.1.2">subscript</csymbol><ci id="S3.E2.m1.7.7.1.1.1.1.1.1.1.2.2.cmml" xref="S3.E2.m1.7.7.1.1.1.1.1.1.1.2.2">𝑀</ci><ci id="S3.E2.m1.7.7.1.1.1.1.1.1.1.2.3.cmml" xref="S3.E2.m1.7.7.1.1.1.1.1.1.1.2.3">𝐺</ci></apply><list id="S3.E2.m1.7.7.1.1.1.1.1.1.1.3.1.cmml" xref="S3.E2.m1.7.7.1.1.1.1.1.1.1.3.2"><ci id="S3.E2.m1.4.4.cmml" xref="S3.E2.m1.4.4">𝜃</ci><ci id="S3.E2.m1.5.5.cmml" xref="S3.E2.m1.5.5">𝑥</ci></list></apply><ci id="S3.E2.m1.6.6.cmml" xref="S3.E2.m1.6.6">𝑦</ci></interval></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E2.m1.7c">f_{i}(\theta)=\mathbb{E}_{(x,y)\sim\mathcal{D}_{i}}[L_{i}(M_{G}(\theta;x),y)]</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(2)</span></td>
</tr></tbody>
</table>
<p id="S3.SS1.p2.4" class="ltx_p">where <math id="S3.SS1.p2.1.m1.2" class="ltx_Math" alttext="(x,y)" display="inline"><semantics id="S3.SS1.p2.1.m1.2a"><mrow id="S3.SS1.p2.1.m1.2.3.2" xref="S3.SS1.p2.1.m1.2.3.1.cmml"><mo stretchy="false" id="S3.SS1.p2.1.m1.2.3.2.1" xref="S3.SS1.p2.1.m1.2.3.1.cmml">(</mo><mi id="S3.SS1.p2.1.m1.1.1" xref="S3.SS1.p2.1.m1.1.1.cmml">x</mi><mo id="S3.SS1.p2.1.m1.2.3.2.2" xref="S3.SS1.p2.1.m1.2.3.1.cmml">,</mo><mi id="S3.SS1.p2.1.m1.2.2" xref="S3.SS1.p2.1.m1.2.2.cmml">y</mi><mo stretchy="false" id="S3.SS1.p2.1.m1.2.3.2.3" xref="S3.SS1.p2.1.m1.2.3.1.cmml">)</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p2.1.m1.2b"><interval closure="open" id="S3.SS1.p2.1.m1.2.3.1.cmml" xref="S3.SS1.p2.1.m1.2.3.2"><ci id="S3.SS1.p2.1.m1.1.1.cmml" xref="S3.SS1.p2.1.m1.1.1">𝑥</ci><ci id="S3.SS1.p2.1.m1.2.2.cmml" xref="S3.SS1.p2.1.m1.2.2">𝑦</ci></interval></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p2.1.m1.2c">(x,y)</annotation></semantics></math> is a pair of data composed of the input and the corresponding label, following the distribution <math id="S3.SS1.p2.2.m2.1" class="ltx_Math" alttext="\mathcal{D}_{i}" display="inline"><semantics id="S3.SS1.p2.2.m2.1a"><msub id="S3.SS1.p2.2.m2.1.1" xref="S3.SS1.p2.2.m2.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS1.p2.2.m2.1.1.2" xref="S3.SS1.p2.2.m2.1.1.2.cmml">𝒟</mi><mi id="S3.SS1.p2.2.m2.1.1.3" xref="S3.SS1.p2.2.m2.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.p2.2.m2.1b"><apply id="S3.SS1.p2.2.m2.1.1.cmml" xref="S3.SS1.p2.2.m2.1.1"><csymbol cd="ambiguous" id="S3.SS1.p2.2.m2.1.1.1.cmml" xref="S3.SS1.p2.2.m2.1.1">subscript</csymbol><ci id="S3.SS1.p2.2.m2.1.1.2.cmml" xref="S3.SS1.p2.2.m2.1.1.2">𝒟</ci><ci id="S3.SS1.p2.2.m2.1.1.3.cmml" xref="S3.SS1.p2.2.m2.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p2.2.m2.1c">\mathcal{D}_{i}</annotation></semantics></math>. <math id="S3.SS1.p2.3.m3.1" class="ltx_Math" alttext="L_{i}" display="inline"><semantics id="S3.SS1.p2.3.m3.1a"><msub id="S3.SS1.p2.3.m3.1.1" xref="S3.SS1.p2.3.m3.1.1.cmml"><mi id="S3.SS1.p2.3.m3.1.1.2" xref="S3.SS1.p2.3.m3.1.1.2.cmml">L</mi><mi id="S3.SS1.p2.3.m3.1.1.3" xref="S3.SS1.p2.3.m3.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.p2.3.m3.1b"><apply id="S3.SS1.p2.3.m3.1.1.cmml" xref="S3.SS1.p2.3.m3.1.1"><csymbol cd="ambiguous" id="S3.SS1.p2.3.m3.1.1.1.cmml" xref="S3.SS1.p2.3.m3.1.1">subscript</csymbol><ci id="S3.SS1.p2.3.m3.1.1.2.cmml" xref="S3.SS1.p2.3.m3.1.1.2">𝐿</ci><ci id="S3.SS1.p2.3.m3.1.1.3.cmml" xref="S3.SS1.p2.3.m3.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p2.3.m3.1c">L_{i}</annotation></semantics></math> is the loss function of the client <math id="S3.SS1.p2.4.m4.1" class="ltx_Math" alttext="i" display="inline"><semantics id="S3.SS1.p2.4.m4.1a"><mi id="S3.SS1.p2.4.m4.1.1" xref="S3.SS1.p2.4.m4.1.1.cmml">i</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p2.4.m4.1b"><ci id="S3.SS1.p2.4.m4.1.1.cmml" xref="S3.SS1.p2.4.m4.1.1">𝑖</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p2.4.m4.1c">i</annotation></semantics></math>, usually, it is uniform in each client. E.g., in a classification task using a neural network, it is the cross entropy loss function.</p>
</div>
</section>
<section id="S3.SS2" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection"><span id="S3.SS2.5.1.1" class="ltx_text">III-B</span> </span><span id="S3.SS2.6.2" class="ltx_text ltx_font_italic">Personalization</span>
</h3>

<div id="S3.SS2.p1" class="ltx_para">
<p id="S3.SS2.p1.1" class="ltx_p">In PFL, the optimization goal is the same as individual learning. However, in individual learning, due to the insufficient local data, it is difficult for a client to estimate its local data distribution, which leads to a large generalization error.
Based on the federated global model,
it is easier for individuals to obtain models with better generalization capabilities than individual learning.
In particular, we chose PFL-FT, a local adaptation PFL algorithm based on fine-tuning, to formally describe the details of the personalization stage.
The goal is to find a good model parameter for each client and we define <math id="S3.SS2.p1.1.m1.1" class="ltx_Math" alttext="F:\mathbb{R}^{Nd1}\rightarrow\mathbb{R}" display="inline"><semantics id="S3.SS2.p1.1.m1.1a"><mrow id="S3.SS2.p1.1.m1.1.1" xref="S3.SS2.p1.1.m1.1.1.cmml"><mi id="S3.SS2.p1.1.m1.1.1.2" xref="S3.SS2.p1.1.m1.1.1.2.cmml">F</mi><mo lspace="0.278em" rspace="0.278em" id="S3.SS2.p1.1.m1.1.1.1" xref="S3.SS2.p1.1.m1.1.1.1.cmml">:</mo><mrow id="S3.SS2.p1.1.m1.1.1.3" xref="S3.SS2.p1.1.m1.1.1.3.cmml"><msup id="S3.SS2.p1.1.m1.1.1.3.2" xref="S3.SS2.p1.1.m1.1.1.3.2.cmml"><mi id="S3.SS2.p1.1.m1.1.1.3.2.2" xref="S3.SS2.p1.1.m1.1.1.3.2.2.cmml">ℝ</mi><mrow id="S3.SS2.p1.1.m1.1.1.3.2.3" xref="S3.SS2.p1.1.m1.1.1.3.2.3.cmml"><mi id="S3.SS2.p1.1.m1.1.1.3.2.3.2" xref="S3.SS2.p1.1.m1.1.1.3.2.3.2.cmml">N</mi><mo lspace="0em" rspace="0em" id="S3.SS2.p1.1.m1.1.1.3.2.3.1" xref="S3.SS2.p1.1.m1.1.1.3.2.3.1.cmml">​</mo><mi id="S3.SS2.p1.1.m1.1.1.3.2.3.3" xref="S3.SS2.p1.1.m1.1.1.3.2.3.3.cmml">d</mi><mo lspace="0em" rspace="0em" id="S3.SS2.p1.1.m1.1.1.3.2.3.1a" xref="S3.SS2.p1.1.m1.1.1.3.2.3.1.cmml">​</mo><mn id="S3.SS2.p1.1.m1.1.1.3.2.3.4" xref="S3.SS2.p1.1.m1.1.1.3.2.3.4.cmml">1</mn></mrow></msup><mo stretchy="false" id="S3.SS2.p1.1.m1.1.1.3.1" xref="S3.SS2.p1.1.m1.1.1.3.1.cmml">→</mo><mi id="S3.SS2.p1.1.m1.1.1.3.3" xref="S3.SS2.p1.1.m1.1.1.3.3.cmml">ℝ</mi></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.1.m1.1b"><apply id="S3.SS2.p1.1.m1.1.1.cmml" xref="S3.SS2.p1.1.m1.1.1"><ci id="S3.SS2.p1.1.m1.1.1.1.cmml" xref="S3.SS2.p1.1.m1.1.1.1">:</ci><ci id="S3.SS2.p1.1.m1.1.1.2.cmml" xref="S3.SS2.p1.1.m1.1.1.2">𝐹</ci><apply id="S3.SS2.p1.1.m1.1.1.3.cmml" xref="S3.SS2.p1.1.m1.1.1.3"><ci id="S3.SS2.p1.1.m1.1.1.3.1.cmml" xref="S3.SS2.p1.1.m1.1.1.3.1">→</ci><apply id="S3.SS2.p1.1.m1.1.1.3.2.cmml" xref="S3.SS2.p1.1.m1.1.1.3.2"><csymbol cd="ambiguous" id="S3.SS2.p1.1.m1.1.1.3.2.1.cmml" xref="S3.SS2.p1.1.m1.1.1.3.2">superscript</csymbol><ci id="S3.SS2.p1.1.m1.1.1.3.2.2.cmml" xref="S3.SS2.p1.1.m1.1.1.3.2.2">ℝ</ci><apply id="S3.SS2.p1.1.m1.1.1.3.2.3.cmml" xref="S3.SS2.p1.1.m1.1.1.3.2.3"><times id="S3.SS2.p1.1.m1.1.1.3.2.3.1.cmml" xref="S3.SS2.p1.1.m1.1.1.3.2.3.1"></times><ci id="S3.SS2.p1.1.m1.1.1.3.2.3.2.cmml" xref="S3.SS2.p1.1.m1.1.1.3.2.3.2">𝑁</ci><ci id="S3.SS2.p1.1.m1.1.1.3.2.3.3.cmml" xref="S3.SS2.p1.1.m1.1.1.3.2.3.3">𝑑</ci><cn type="integer" id="S3.SS2.p1.1.m1.1.1.3.2.3.4.cmml" xref="S3.SS2.p1.1.m1.1.1.3.2.3.4">1</cn></apply></apply><ci id="S3.SS2.p1.1.m1.1.1.3.3.cmml" xref="S3.SS2.p1.1.m1.1.1.3.3">ℝ</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.1.m1.1c">F:\mathbb{R}^{Nd1}\rightarrow\mathbb{R}</annotation></semantics></math> as the global loss:</p>
</div>
<div id="S3.SS2.p2" class="ltx_para">
<table id="S3.E3" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S3.E3.m1.9" class="ltx_Math" alttext="\min_{\theta_{1},\theta_{2},...,\theta_{N}\in\mathbb{R}^{d_{1}}}F(\theta_{1},\theta_{2},...,\theta_{N})=\frac{1}{N}\sum_{i=1}^{N}f_{i}(\theta_{i})" display="block"><semantics id="S3.E3.m1.9a"><mrow id="S3.E3.m1.9.9" xref="S3.E3.m1.9.9.cmml"><mrow id="S3.E3.m1.8.8.3" xref="S3.E3.m1.8.8.3.cmml"><mrow id="S3.E3.m1.8.8.3.5" xref="S3.E3.m1.8.8.3.5.cmml"><munder id="S3.E3.m1.8.8.3.5.1" xref="S3.E3.m1.8.8.3.5.1.cmml"><mi id="S3.E3.m1.8.8.3.5.1.2" xref="S3.E3.m1.8.8.3.5.1.2.cmml">min</mi><mrow id="S3.E3.m1.4.4.4" xref="S3.E3.m1.4.4.4.cmml"><mrow id="S3.E3.m1.4.4.4.4.3" xref="S3.E3.m1.4.4.4.4.4.cmml"><msub id="S3.E3.m1.2.2.2.2.1.1" xref="S3.E3.m1.2.2.2.2.1.1.cmml"><mi id="S3.E3.m1.2.2.2.2.1.1.2" xref="S3.E3.m1.2.2.2.2.1.1.2.cmml">θ</mi><mn id="S3.E3.m1.2.2.2.2.1.1.3" xref="S3.E3.m1.2.2.2.2.1.1.3.cmml">1</mn></msub><mo id="S3.E3.m1.4.4.4.4.3.4" xref="S3.E3.m1.4.4.4.4.4.cmml">,</mo><msub id="S3.E3.m1.3.3.3.3.2.2" xref="S3.E3.m1.3.3.3.3.2.2.cmml"><mi id="S3.E3.m1.3.3.3.3.2.2.2" xref="S3.E3.m1.3.3.3.3.2.2.2.cmml">θ</mi><mn id="S3.E3.m1.3.3.3.3.2.2.3" xref="S3.E3.m1.3.3.3.3.2.2.3.cmml">2</mn></msub><mo id="S3.E3.m1.4.4.4.4.3.5" xref="S3.E3.m1.4.4.4.4.4.cmml">,</mo><mi mathvariant="normal" id="S3.E3.m1.1.1.1.1" xref="S3.E3.m1.1.1.1.1.cmml">…</mi><mo id="S3.E3.m1.4.4.4.4.3.6" xref="S3.E3.m1.4.4.4.4.4.cmml">,</mo><msub id="S3.E3.m1.4.4.4.4.3.3" xref="S3.E3.m1.4.4.4.4.3.3.cmml"><mi id="S3.E3.m1.4.4.4.4.3.3.2" xref="S3.E3.m1.4.4.4.4.3.3.2.cmml">θ</mi><mi id="S3.E3.m1.4.4.4.4.3.3.3" xref="S3.E3.m1.4.4.4.4.3.3.3.cmml">N</mi></msub></mrow><mo id="S3.E3.m1.4.4.4.5" xref="S3.E3.m1.4.4.4.5.cmml">∈</mo><msup id="S3.E3.m1.4.4.4.6" xref="S3.E3.m1.4.4.4.6.cmml"><mi id="S3.E3.m1.4.4.4.6.2" xref="S3.E3.m1.4.4.4.6.2.cmml">ℝ</mi><msub id="S3.E3.m1.4.4.4.6.3" xref="S3.E3.m1.4.4.4.6.3.cmml"><mi id="S3.E3.m1.4.4.4.6.3.2" xref="S3.E3.m1.4.4.4.6.3.2.cmml">d</mi><mn id="S3.E3.m1.4.4.4.6.3.3" xref="S3.E3.m1.4.4.4.6.3.3.cmml">1</mn></msub></msup></mrow></munder><mo lspace="0.167em" id="S3.E3.m1.8.8.3.5a" xref="S3.E3.m1.8.8.3.5.cmml">⁡</mo><mi id="S3.E3.m1.8.8.3.5.2" xref="S3.E3.m1.8.8.3.5.2.cmml">F</mi></mrow><mo lspace="0em" rspace="0em" id="S3.E3.m1.8.8.3.4" xref="S3.E3.m1.8.8.3.4.cmml">​</mo><mrow id="S3.E3.m1.8.8.3.3.3" xref="S3.E3.m1.8.8.3.3.4.cmml"><mo stretchy="false" id="S3.E3.m1.8.8.3.3.3.4" xref="S3.E3.m1.8.8.3.3.4.cmml">(</mo><msub id="S3.E3.m1.6.6.1.1.1.1" xref="S3.E3.m1.6.6.1.1.1.1.cmml"><mi id="S3.E3.m1.6.6.1.1.1.1.2" xref="S3.E3.m1.6.6.1.1.1.1.2.cmml">θ</mi><mn id="S3.E3.m1.6.6.1.1.1.1.3" xref="S3.E3.m1.6.6.1.1.1.1.3.cmml">1</mn></msub><mo id="S3.E3.m1.8.8.3.3.3.5" xref="S3.E3.m1.8.8.3.3.4.cmml">,</mo><msub id="S3.E3.m1.7.7.2.2.2.2" xref="S3.E3.m1.7.7.2.2.2.2.cmml"><mi id="S3.E3.m1.7.7.2.2.2.2.2" xref="S3.E3.m1.7.7.2.2.2.2.2.cmml">θ</mi><mn id="S3.E3.m1.7.7.2.2.2.2.3" xref="S3.E3.m1.7.7.2.2.2.2.3.cmml">2</mn></msub><mo id="S3.E3.m1.8.8.3.3.3.6" xref="S3.E3.m1.8.8.3.3.4.cmml">,</mo><mi mathvariant="normal" id="S3.E3.m1.5.5" xref="S3.E3.m1.5.5.cmml">…</mi><mo id="S3.E3.m1.8.8.3.3.3.7" xref="S3.E3.m1.8.8.3.3.4.cmml">,</mo><msub id="S3.E3.m1.8.8.3.3.3.3" xref="S3.E3.m1.8.8.3.3.3.3.cmml"><mi id="S3.E3.m1.8.8.3.3.3.3.2" xref="S3.E3.m1.8.8.3.3.3.3.2.cmml">θ</mi><mi id="S3.E3.m1.8.8.3.3.3.3.3" xref="S3.E3.m1.8.8.3.3.3.3.3.cmml">N</mi></msub><mo stretchy="false" id="S3.E3.m1.8.8.3.3.3.8" xref="S3.E3.m1.8.8.3.3.4.cmml">)</mo></mrow></mrow><mo id="S3.E3.m1.9.9.5" xref="S3.E3.m1.9.9.5.cmml">=</mo><mrow id="S3.E3.m1.9.9.4" xref="S3.E3.m1.9.9.4.cmml"><mfrac id="S3.E3.m1.9.9.4.3" xref="S3.E3.m1.9.9.4.3.cmml"><mn id="S3.E3.m1.9.9.4.3.2" xref="S3.E3.m1.9.9.4.3.2.cmml">1</mn><mi id="S3.E3.m1.9.9.4.3.3" xref="S3.E3.m1.9.9.4.3.3.cmml">N</mi></mfrac><mo lspace="0em" rspace="0em" id="S3.E3.m1.9.9.4.2" xref="S3.E3.m1.9.9.4.2.cmml">​</mo><mrow id="S3.E3.m1.9.9.4.1" xref="S3.E3.m1.9.9.4.1.cmml"><munderover id="S3.E3.m1.9.9.4.1.2" xref="S3.E3.m1.9.9.4.1.2.cmml"><mo movablelimits="false" id="S3.E3.m1.9.9.4.1.2.2.2" xref="S3.E3.m1.9.9.4.1.2.2.2.cmml">∑</mo><mrow id="S3.E3.m1.9.9.4.1.2.2.3" xref="S3.E3.m1.9.9.4.1.2.2.3.cmml"><mi id="S3.E3.m1.9.9.4.1.2.2.3.2" xref="S3.E3.m1.9.9.4.1.2.2.3.2.cmml">i</mi><mo id="S3.E3.m1.9.9.4.1.2.2.3.1" xref="S3.E3.m1.9.9.4.1.2.2.3.1.cmml">=</mo><mn id="S3.E3.m1.9.9.4.1.2.2.3.3" xref="S3.E3.m1.9.9.4.1.2.2.3.3.cmml">1</mn></mrow><mi id="S3.E3.m1.9.9.4.1.2.3" xref="S3.E3.m1.9.9.4.1.2.3.cmml">N</mi></munderover><mrow id="S3.E3.m1.9.9.4.1.1" xref="S3.E3.m1.9.9.4.1.1.cmml"><msub id="S3.E3.m1.9.9.4.1.1.3" xref="S3.E3.m1.9.9.4.1.1.3.cmml"><mi id="S3.E3.m1.9.9.4.1.1.3.2" xref="S3.E3.m1.9.9.4.1.1.3.2.cmml">f</mi><mi id="S3.E3.m1.9.9.4.1.1.3.3" xref="S3.E3.m1.9.9.4.1.1.3.3.cmml">i</mi></msub><mo lspace="0em" rspace="0em" id="S3.E3.m1.9.9.4.1.1.2" xref="S3.E3.m1.9.9.4.1.1.2.cmml">​</mo><mrow id="S3.E3.m1.9.9.4.1.1.1.1" xref="S3.E3.m1.9.9.4.1.1.1.1.1.cmml"><mo stretchy="false" id="S3.E3.m1.9.9.4.1.1.1.1.2" xref="S3.E3.m1.9.9.4.1.1.1.1.1.cmml">(</mo><msub id="S3.E3.m1.9.9.4.1.1.1.1.1" xref="S3.E3.m1.9.9.4.1.1.1.1.1.cmml"><mi id="S3.E3.m1.9.9.4.1.1.1.1.1.2" xref="S3.E3.m1.9.9.4.1.1.1.1.1.2.cmml">θ</mi><mi id="S3.E3.m1.9.9.4.1.1.1.1.1.3" xref="S3.E3.m1.9.9.4.1.1.1.1.1.3.cmml">i</mi></msub><mo stretchy="false" id="S3.E3.m1.9.9.4.1.1.1.1.3" xref="S3.E3.m1.9.9.4.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.E3.m1.9b"><apply id="S3.E3.m1.9.9.cmml" xref="S3.E3.m1.9.9"><eq id="S3.E3.m1.9.9.5.cmml" xref="S3.E3.m1.9.9.5"></eq><apply id="S3.E3.m1.8.8.3.cmml" xref="S3.E3.m1.8.8.3"><times id="S3.E3.m1.8.8.3.4.cmml" xref="S3.E3.m1.8.8.3.4"></times><apply id="S3.E3.m1.8.8.3.5.cmml" xref="S3.E3.m1.8.8.3.5"><apply id="S3.E3.m1.8.8.3.5.1.cmml" xref="S3.E3.m1.8.8.3.5.1"><csymbol cd="ambiguous" id="S3.E3.m1.8.8.3.5.1.1.cmml" xref="S3.E3.m1.8.8.3.5.1">subscript</csymbol><min id="S3.E3.m1.8.8.3.5.1.2.cmml" xref="S3.E3.m1.8.8.3.5.1.2"></min><apply id="S3.E3.m1.4.4.4.cmml" xref="S3.E3.m1.4.4.4"><in id="S3.E3.m1.4.4.4.5.cmml" xref="S3.E3.m1.4.4.4.5"></in><list id="S3.E3.m1.4.4.4.4.4.cmml" xref="S3.E3.m1.4.4.4.4.3"><apply id="S3.E3.m1.2.2.2.2.1.1.cmml" xref="S3.E3.m1.2.2.2.2.1.1"><csymbol cd="ambiguous" id="S3.E3.m1.2.2.2.2.1.1.1.cmml" xref="S3.E3.m1.2.2.2.2.1.1">subscript</csymbol><ci id="S3.E3.m1.2.2.2.2.1.1.2.cmml" xref="S3.E3.m1.2.2.2.2.1.1.2">𝜃</ci><cn type="integer" id="S3.E3.m1.2.2.2.2.1.1.3.cmml" xref="S3.E3.m1.2.2.2.2.1.1.3">1</cn></apply><apply id="S3.E3.m1.3.3.3.3.2.2.cmml" xref="S3.E3.m1.3.3.3.3.2.2"><csymbol cd="ambiguous" id="S3.E3.m1.3.3.3.3.2.2.1.cmml" xref="S3.E3.m1.3.3.3.3.2.2">subscript</csymbol><ci id="S3.E3.m1.3.3.3.3.2.2.2.cmml" xref="S3.E3.m1.3.3.3.3.2.2.2">𝜃</ci><cn type="integer" id="S3.E3.m1.3.3.3.3.2.2.3.cmml" xref="S3.E3.m1.3.3.3.3.2.2.3">2</cn></apply><ci id="S3.E3.m1.1.1.1.1.cmml" xref="S3.E3.m1.1.1.1.1">…</ci><apply id="S3.E3.m1.4.4.4.4.3.3.cmml" xref="S3.E3.m1.4.4.4.4.3.3"><csymbol cd="ambiguous" id="S3.E3.m1.4.4.4.4.3.3.1.cmml" xref="S3.E3.m1.4.4.4.4.3.3">subscript</csymbol><ci id="S3.E3.m1.4.4.4.4.3.3.2.cmml" xref="S3.E3.m1.4.4.4.4.3.3.2">𝜃</ci><ci id="S3.E3.m1.4.4.4.4.3.3.3.cmml" xref="S3.E3.m1.4.4.4.4.3.3.3">𝑁</ci></apply></list><apply id="S3.E3.m1.4.4.4.6.cmml" xref="S3.E3.m1.4.4.4.6"><csymbol cd="ambiguous" id="S3.E3.m1.4.4.4.6.1.cmml" xref="S3.E3.m1.4.4.4.6">superscript</csymbol><ci id="S3.E3.m1.4.4.4.6.2.cmml" xref="S3.E3.m1.4.4.4.6.2">ℝ</ci><apply id="S3.E3.m1.4.4.4.6.3.cmml" xref="S3.E3.m1.4.4.4.6.3"><csymbol cd="ambiguous" id="S3.E3.m1.4.4.4.6.3.1.cmml" xref="S3.E3.m1.4.4.4.6.3">subscript</csymbol><ci id="S3.E3.m1.4.4.4.6.3.2.cmml" xref="S3.E3.m1.4.4.4.6.3.2">𝑑</ci><cn type="integer" id="S3.E3.m1.4.4.4.6.3.3.cmml" xref="S3.E3.m1.4.4.4.6.3.3">1</cn></apply></apply></apply></apply><ci id="S3.E3.m1.8.8.3.5.2.cmml" xref="S3.E3.m1.8.8.3.5.2">𝐹</ci></apply><vector id="S3.E3.m1.8.8.3.3.4.cmml" xref="S3.E3.m1.8.8.3.3.3"><apply id="S3.E3.m1.6.6.1.1.1.1.cmml" xref="S3.E3.m1.6.6.1.1.1.1"><csymbol cd="ambiguous" id="S3.E3.m1.6.6.1.1.1.1.1.cmml" xref="S3.E3.m1.6.6.1.1.1.1">subscript</csymbol><ci id="S3.E3.m1.6.6.1.1.1.1.2.cmml" xref="S3.E3.m1.6.6.1.1.1.1.2">𝜃</ci><cn type="integer" id="S3.E3.m1.6.6.1.1.1.1.3.cmml" xref="S3.E3.m1.6.6.1.1.1.1.3">1</cn></apply><apply id="S3.E3.m1.7.7.2.2.2.2.cmml" xref="S3.E3.m1.7.7.2.2.2.2"><csymbol cd="ambiguous" id="S3.E3.m1.7.7.2.2.2.2.1.cmml" xref="S3.E3.m1.7.7.2.2.2.2">subscript</csymbol><ci id="S3.E3.m1.7.7.2.2.2.2.2.cmml" xref="S3.E3.m1.7.7.2.2.2.2.2">𝜃</ci><cn type="integer" id="S3.E3.m1.7.7.2.2.2.2.3.cmml" xref="S3.E3.m1.7.7.2.2.2.2.3">2</cn></apply><ci id="S3.E3.m1.5.5.cmml" xref="S3.E3.m1.5.5">…</ci><apply id="S3.E3.m1.8.8.3.3.3.3.cmml" xref="S3.E3.m1.8.8.3.3.3.3"><csymbol cd="ambiguous" id="S3.E3.m1.8.8.3.3.3.3.1.cmml" xref="S3.E3.m1.8.8.3.3.3.3">subscript</csymbol><ci id="S3.E3.m1.8.8.3.3.3.3.2.cmml" xref="S3.E3.m1.8.8.3.3.3.3.2">𝜃</ci><ci id="S3.E3.m1.8.8.3.3.3.3.3.cmml" xref="S3.E3.m1.8.8.3.3.3.3.3">𝑁</ci></apply></vector></apply><apply id="S3.E3.m1.9.9.4.cmml" xref="S3.E3.m1.9.9.4"><times id="S3.E3.m1.9.9.4.2.cmml" xref="S3.E3.m1.9.9.4.2"></times><apply id="S3.E3.m1.9.9.4.3.cmml" xref="S3.E3.m1.9.9.4.3"><divide id="S3.E3.m1.9.9.4.3.1.cmml" xref="S3.E3.m1.9.9.4.3"></divide><cn type="integer" id="S3.E3.m1.9.9.4.3.2.cmml" xref="S3.E3.m1.9.9.4.3.2">1</cn><ci id="S3.E3.m1.9.9.4.3.3.cmml" xref="S3.E3.m1.9.9.4.3.3">𝑁</ci></apply><apply id="S3.E3.m1.9.9.4.1.cmml" xref="S3.E3.m1.9.9.4.1"><apply id="S3.E3.m1.9.9.4.1.2.cmml" xref="S3.E3.m1.9.9.4.1.2"><csymbol cd="ambiguous" id="S3.E3.m1.9.9.4.1.2.1.cmml" xref="S3.E3.m1.9.9.4.1.2">superscript</csymbol><apply id="S3.E3.m1.9.9.4.1.2.2.cmml" xref="S3.E3.m1.9.9.4.1.2"><csymbol cd="ambiguous" id="S3.E3.m1.9.9.4.1.2.2.1.cmml" xref="S3.E3.m1.9.9.4.1.2">subscript</csymbol><sum id="S3.E3.m1.9.9.4.1.2.2.2.cmml" xref="S3.E3.m1.9.9.4.1.2.2.2"></sum><apply id="S3.E3.m1.9.9.4.1.2.2.3.cmml" xref="S3.E3.m1.9.9.4.1.2.2.3"><eq id="S3.E3.m1.9.9.4.1.2.2.3.1.cmml" xref="S3.E3.m1.9.9.4.1.2.2.3.1"></eq><ci id="S3.E3.m1.9.9.4.1.2.2.3.2.cmml" xref="S3.E3.m1.9.9.4.1.2.2.3.2">𝑖</ci><cn type="integer" id="S3.E3.m1.9.9.4.1.2.2.3.3.cmml" xref="S3.E3.m1.9.9.4.1.2.2.3.3">1</cn></apply></apply><ci id="S3.E3.m1.9.9.4.1.2.3.cmml" xref="S3.E3.m1.9.9.4.1.2.3">𝑁</ci></apply><apply id="S3.E3.m1.9.9.4.1.1.cmml" xref="S3.E3.m1.9.9.4.1.1"><times id="S3.E3.m1.9.9.4.1.1.2.cmml" xref="S3.E3.m1.9.9.4.1.1.2"></times><apply id="S3.E3.m1.9.9.4.1.1.3.cmml" xref="S3.E3.m1.9.9.4.1.1.3"><csymbol cd="ambiguous" id="S3.E3.m1.9.9.4.1.1.3.1.cmml" xref="S3.E3.m1.9.9.4.1.1.3">subscript</csymbol><ci id="S3.E3.m1.9.9.4.1.1.3.2.cmml" xref="S3.E3.m1.9.9.4.1.1.3.2">𝑓</ci><ci id="S3.E3.m1.9.9.4.1.1.3.3.cmml" xref="S3.E3.m1.9.9.4.1.1.3.3">𝑖</ci></apply><apply id="S3.E3.m1.9.9.4.1.1.1.1.1.cmml" xref="S3.E3.m1.9.9.4.1.1.1.1"><csymbol cd="ambiguous" id="S3.E3.m1.9.9.4.1.1.1.1.1.1.cmml" xref="S3.E3.m1.9.9.4.1.1.1.1">subscript</csymbol><ci id="S3.E3.m1.9.9.4.1.1.1.1.1.2.cmml" xref="S3.E3.m1.9.9.4.1.1.1.1.1.2">𝜃</ci><ci id="S3.E3.m1.9.9.4.1.1.1.1.1.3.cmml" xref="S3.E3.m1.9.9.4.1.1.1.1.1.3">𝑖</ci></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E3.m1.9c">\min_{\theta_{1},\theta_{2},...,\theta_{N}\in\mathbb{R}^{d_{1}}}F(\theta_{1},\theta_{2},...,\theta_{N})=\frac{1}{N}\sum_{i=1}^{N}f_{i}(\theta_{i})</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(3)</span></td>
</tr></tbody>
</table>
</div>
<div id="S3.SS2.p3" class="ltx_para">
<table id="S3.E4" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S3.E4.m1.6" class="ltx_Math" alttext="f_{i}(\theta_{i})=\mathbb{E}_{(x,y)\sim\mathcal{D}_{i}}[L_{i}(\widehat{y},y)]" display="block"><semantics id="S3.E4.m1.6a"><mrow id="S3.E4.m1.6.6" xref="S3.E4.m1.6.6.cmml"><mrow id="S3.E4.m1.5.5.1" xref="S3.E4.m1.5.5.1.cmml"><msub id="S3.E4.m1.5.5.1.3" xref="S3.E4.m1.5.5.1.3.cmml"><mi id="S3.E4.m1.5.5.1.3.2" xref="S3.E4.m1.5.5.1.3.2.cmml">f</mi><mi id="S3.E4.m1.5.5.1.3.3" xref="S3.E4.m1.5.5.1.3.3.cmml">i</mi></msub><mo lspace="0em" rspace="0em" id="S3.E4.m1.5.5.1.2" xref="S3.E4.m1.5.5.1.2.cmml">​</mo><mrow id="S3.E4.m1.5.5.1.1.1" xref="S3.E4.m1.5.5.1.1.1.1.cmml"><mo stretchy="false" id="S3.E4.m1.5.5.1.1.1.2" xref="S3.E4.m1.5.5.1.1.1.1.cmml">(</mo><msub id="S3.E4.m1.5.5.1.1.1.1" xref="S3.E4.m1.5.5.1.1.1.1.cmml"><mi id="S3.E4.m1.5.5.1.1.1.1.2" xref="S3.E4.m1.5.5.1.1.1.1.2.cmml">θ</mi><mi id="S3.E4.m1.5.5.1.1.1.1.3" xref="S3.E4.m1.5.5.1.1.1.1.3.cmml">i</mi></msub><mo stretchy="false" id="S3.E4.m1.5.5.1.1.1.3" xref="S3.E4.m1.5.5.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S3.E4.m1.6.6.3" xref="S3.E4.m1.6.6.3.cmml">=</mo><mrow id="S3.E4.m1.6.6.2" xref="S3.E4.m1.6.6.2.cmml"><msub id="S3.E4.m1.6.6.2.3" xref="S3.E4.m1.6.6.2.3.cmml"><mi id="S3.E4.m1.6.6.2.3.2" xref="S3.E4.m1.6.6.2.3.2.cmml">𝔼</mi><mrow id="S3.E4.m1.2.2.2" xref="S3.E4.m1.2.2.2.cmml"><mrow id="S3.E4.m1.2.2.2.4.2" xref="S3.E4.m1.2.2.2.4.1.cmml"><mo stretchy="false" id="S3.E4.m1.2.2.2.4.2.1" xref="S3.E4.m1.2.2.2.4.1.cmml">(</mo><mi id="S3.E4.m1.1.1.1.1" xref="S3.E4.m1.1.1.1.1.cmml">x</mi><mo id="S3.E4.m1.2.2.2.4.2.2" xref="S3.E4.m1.2.2.2.4.1.cmml">,</mo><mi id="S3.E4.m1.2.2.2.2" xref="S3.E4.m1.2.2.2.2.cmml">y</mi><mo stretchy="false" id="S3.E4.m1.2.2.2.4.2.3" xref="S3.E4.m1.2.2.2.4.1.cmml">)</mo></mrow><mo id="S3.E4.m1.2.2.2.3" xref="S3.E4.m1.2.2.2.3.cmml">∼</mo><msub id="S3.E4.m1.2.2.2.5" xref="S3.E4.m1.2.2.2.5.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.E4.m1.2.2.2.5.2" xref="S3.E4.m1.2.2.2.5.2.cmml">𝒟</mi><mi id="S3.E4.m1.2.2.2.5.3" xref="S3.E4.m1.2.2.2.5.3.cmml">i</mi></msub></mrow></msub><mo lspace="0em" rspace="0em" id="S3.E4.m1.6.6.2.2" xref="S3.E4.m1.6.6.2.2.cmml">​</mo><mrow id="S3.E4.m1.6.6.2.1.1" xref="S3.E4.m1.6.6.2.1.2.cmml"><mo stretchy="false" id="S3.E4.m1.6.6.2.1.1.2" xref="S3.E4.m1.6.6.2.1.2.1.cmml">[</mo><mrow id="S3.E4.m1.6.6.2.1.1.1" xref="S3.E4.m1.6.6.2.1.1.1.cmml"><msub id="S3.E4.m1.6.6.2.1.1.1.2" xref="S3.E4.m1.6.6.2.1.1.1.2.cmml"><mi id="S3.E4.m1.6.6.2.1.1.1.2.2" xref="S3.E4.m1.6.6.2.1.1.1.2.2.cmml">L</mi><mi id="S3.E4.m1.6.6.2.1.1.1.2.3" xref="S3.E4.m1.6.6.2.1.1.1.2.3.cmml">i</mi></msub><mo lspace="0em" rspace="0em" id="S3.E4.m1.6.6.2.1.1.1.1" xref="S3.E4.m1.6.6.2.1.1.1.1.cmml">​</mo><mrow id="S3.E4.m1.6.6.2.1.1.1.3.2" xref="S3.E4.m1.6.6.2.1.1.1.3.1.cmml"><mo stretchy="false" id="S3.E4.m1.6.6.2.1.1.1.3.2.1" xref="S3.E4.m1.6.6.2.1.1.1.3.1.cmml">(</mo><mover accent="true" id="S3.E4.m1.3.3" xref="S3.E4.m1.3.3.cmml"><mi id="S3.E4.m1.3.3.2" xref="S3.E4.m1.3.3.2.cmml">y</mi><mo id="S3.E4.m1.3.3.1" xref="S3.E4.m1.3.3.1.cmml">^</mo></mover><mo id="S3.E4.m1.6.6.2.1.1.1.3.2.2" xref="S3.E4.m1.6.6.2.1.1.1.3.1.cmml">,</mo><mi id="S3.E4.m1.4.4" xref="S3.E4.m1.4.4.cmml">y</mi><mo stretchy="false" id="S3.E4.m1.6.6.2.1.1.1.3.2.3" xref="S3.E4.m1.6.6.2.1.1.1.3.1.cmml">)</mo></mrow></mrow><mo stretchy="false" id="S3.E4.m1.6.6.2.1.1.3" xref="S3.E4.m1.6.6.2.1.2.1.cmml">]</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.E4.m1.6b"><apply id="S3.E4.m1.6.6.cmml" xref="S3.E4.m1.6.6"><eq id="S3.E4.m1.6.6.3.cmml" xref="S3.E4.m1.6.6.3"></eq><apply id="S3.E4.m1.5.5.1.cmml" xref="S3.E4.m1.5.5.1"><times id="S3.E4.m1.5.5.1.2.cmml" xref="S3.E4.m1.5.5.1.2"></times><apply id="S3.E4.m1.5.5.1.3.cmml" xref="S3.E4.m1.5.5.1.3"><csymbol cd="ambiguous" id="S3.E4.m1.5.5.1.3.1.cmml" xref="S3.E4.m1.5.5.1.3">subscript</csymbol><ci id="S3.E4.m1.5.5.1.3.2.cmml" xref="S3.E4.m1.5.5.1.3.2">𝑓</ci><ci id="S3.E4.m1.5.5.1.3.3.cmml" xref="S3.E4.m1.5.5.1.3.3">𝑖</ci></apply><apply id="S3.E4.m1.5.5.1.1.1.1.cmml" xref="S3.E4.m1.5.5.1.1.1"><csymbol cd="ambiguous" id="S3.E4.m1.5.5.1.1.1.1.1.cmml" xref="S3.E4.m1.5.5.1.1.1">subscript</csymbol><ci id="S3.E4.m1.5.5.1.1.1.1.2.cmml" xref="S3.E4.m1.5.5.1.1.1.1.2">𝜃</ci><ci id="S3.E4.m1.5.5.1.1.1.1.3.cmml" xref="S3.E4.m1.5.5.1.1.1.1.3">𝑖</ci></apply></apply><apply id="S3.E4.m1.6.6.2.cmml" xref="S3.E4.m1.6.6.2"><times id="S3.E4.m1.6.6.2.2.cmml" xref="S3.E4.m1.6.6.2.2"></times><apply id="S3.E4.m1.6.6.2.3.cmml" xref="S3.E4.m1.6.6.2.3"><csymbol cd="ambiguous" id="S3.E4.m1.6.6.2.3.1.cmml" xref="S3.E4.m1.6.6.2.3">subscript</csymbol><ci id="S3.E4.m1.6.6.2.3.2.cmml" xref="S3.E4.m1.6.6.2.3.2">𝔼</ci><apply id="S3.E4.m1.2.2.2.cmml" xref="S3.E4.m1.2.2.2"><csymbol cd="latexml" id="S3.E4.m1.2.2.2.3.cmml" xref="S3.E4.m1.2.2.2.3">similar-to</csymbol><interval closure="open" id="S3.E4.m1.2.2.2.4.1.cmml" xref="S3.E4.m1.2.2.2.4.2"><ci id="S3.E4.m1.1.1.1.1.cmml" xref="S3.E4.m1.1.1.1.1">𝑥</ci><ci id="S3.E4.m1.2.2.2.2.cmml" xref="S3.E4.m1.2.2.2.2">𝑦</ci></interval><apply id="S3.E4.m1.2.2.2.5.cmml" xref="S3.E4.m1.2.2.2.5"><csymbol cd="ambiguous" id="S3.E4.m1.2.2.2.5.1.cmml" xref="S3.E4.m1.2.2.2.5">subscript</csymbol><ci id="S3.E4.m1.2.2.2.5.2.cmml" xref="S3.E4.m1.2.2.2.5.2">𝒟</ci><ci id="S3.E4.m1.2.2.2.5.3.cmml" xref="S3.E4.m1.2.2.2.5.3">𝑖</ci></apply></apply></apply><apply id="S3.E4.m1.6.6.2.1.2.cmml" xref="S3.E4.m1.6.6.2.1.1"><csymbol cd="latexml" id="S3.E4.m1.6.6.2.1.2.1.cmml" xref="S3.E4.m1.6.6.2.1.1.2">delimited-[]</csymbol><apply id="S3.E4.m1.6.6.2.1.1.1.cmml" xref="S3.E4.m1.6.6.2.1.1.1"><times id="S3.E4.m1.6.6.2.1.1.1.1.cmml" xref="S3.E4.m1.6.6.2.1.1.1.1"></times><apply id="S3.E4.m1.6.6.2.1.1.1.2.cmml" xref="S3.E4.m1.6.6.2.1.1.1.2"><csymbol cd="ambiguous" id="S3.E4.m1.6.6.2.1.1.1.2.1.cmml" xref="S3.E4.m1.6.6.2.1.1.1.2">subscript</csymbol><ci id="S3.E4.m1.6.6.2.1.1.1.2.2.cmml" xref="S3.E4.m1.6.6.2.1.1.1.2.2">𝐿</ci><ci id="S3.E4.m1.6.6.2.1.1.1.2.3.cmml" xref="S3.E4.m1.6.6.2.1.1.1.2.3">𝑖</ci></apply><interval closure="open" id="S3.E4.m1.6.6.2.1.1.1.3.1.cmml" xref="S3.E4.m1.6.6.2.1.1.1.3.2"><apply id="S3.E4.m1.3.3.cmml" xref="S3.E4.m1.3.3"><ci id="S3.E4.m1.3.3.1.cmml" xref="S3.E4.m1.3.3.1">^</ci><ci id="S3.E4.m1.3.3.2.cmml" xref="S3.E4.m1.3.3.2">𝑦</ci></apply><ci id="S3.E4.m1.4.4.cmml" xref="S3.E4.m1.4.4">𝑦</ci></interval></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E4.m1.6c">f_{i}(\theta_{i})=\mathbb{E}_{(x,y)\sim\mathcal{D}_{i}}[L_{i}(\widehat{y},y)]</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(4)</span></td>
</tr></tbody>
</table>
</div>
<div id="S3.SS2.p4" class="ltx_para">
<table id="S3.E5" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S3.E5.m1.2" class="ltx_Math" alttext="\widehat{y}=M_{G}(\theta_{i};x)" display="block"><semantics id="S3.E5.m1.2a"><mrow id="S3.E5.m1.2.2" xref="S3.E5.m1.2.2.cmml"><mover accent="true" id="S3.E5.m1.2.2.3" xref="S3.E5.m1.2.2.3.cmml"><mi id="S3.E5.m1.2.2.3.2" xref="S3.E5.m1.2.2.3.2.cmml">y</mi><mo id="S3.E5.m1.2.2.3.1" xref="S3.E5.m1.2.2.3.1.cmml">^</mo></mover><mo id="S3.E5.m1.2.2.2" xref="S3.E5.m1.2.2.2.cmml">=</mo><mrow id="S3.E5.m1.2.2.1" xref="S3.E5.m1.2.2.1.cmml"><msub id="S3.E5.m1.2.2.1.3" xref="S3.E5.m1.2.2.1.3.cmml"><mi id="S3.E5.m1.2.2.1.3.2" xref="S3.E5.m1.2.2.1.3.2.cmml">M</mi><mi id="S3.E5.m1.2.2.1.3.3" xref="S3.E5.m1.2.2.1.3.3.cmml">G</mi></msub><mo lspace="0em" rspace="0em" id="S3.E5.m1.2.2.1.2" xref="S3.E5.m1.2.2.1.2.cmml">​</mo><mrow id="S3.E5.m1.2.2.1.1.1" xref="S3.E5.m1.2.2.1.1.2.cmml"><mo stretchy="false" id="S3.E5.m1.2.2.1.1.1.2" xref="S3.E5.m1.2.2.1.1.2.cmml">(</mo><msub id="S3.E5.m1.2.2.1.1.1.1" xref="S3.E5.m1.2.2.1.1.1.1.cmml"><mi id="S3.E5.m1.2.2.1.1.1.1.2" xref="S3.E5.m1.2.2.1.1.1.1.2.cmml">θ</mi><mi id="S3.E5.m1.2.2.1.1.1.1.3" xref="S3.E5.m1.2.2.1.1.1.1.3.cmml">i</mi></msub><mo id="S3.E5.m1.2.2.1.1.1.3" xref="S3.E5.m1.2.2.1.1.2.cmml">;</mo><mi id="S3.E5.m1.1.1" xref="S3.E5.m1.1.1.cmml">x</mi><mo stretchy="false" id="S3.E5.m1.2.2.1.1.1.4" xref="S3.E5.m1.2.2.1.1.2.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.E5.m1.2b"><apply id="S3.E5.m1.2.2.cmml" xref="S3.E5.m1.2.2"><eq id="S3.E5.m1.2.2.2.cmml" xref="S3.E5.m1.2.2.2"></eq><apply id="S3.E5.m1.2.2.3.cmml" xref="S3.E5.m1.2.2.3"><ci id="S3.E5.m1.2.2.3.1.cmml" xref="S3.E5.m1.2.2.3.1">^</ci><ci id="S3.E5.m1.2.2.3.2.cmml" xref="S3.E5.m1.2.2.3.2">𝑦</ci></apply><apply id="S3.E5.m1.2.2.1.cmml" xref="S3.E5.m1.2.2.1"><times id="S3.E5.m1.2.2.1.2.cmml" xref="S3.E5.m1.2.2.1.2"></times><apply id="S3.E5.m1.2.2.1.3.cmml" xref="S3.E5.m1.2.2.1.3"><csymbol cd="ambiguous" id="S3.E5.m1.2.2.1.3.1.cmml" xref="S3.E5.m1.2.2.1.3">subscript</csymbol><ci id="S3.E5.m1.2.2.1.3.2.cmml" xref="S3.E5.m1.2.2.1.3.2">𝑀</ci><ci id="S3.E5.m1.2.2.1.3.3.cmml" xref="S3.E5.m1.2.2.1.3.3">𝐺</ci></apply><list id="S3.E5.m1.2.2.1.1.2.cmml" xref="S3.E5.m1.2.2.1.1.1"><apply id="S3.E5.m1.2.2.1.1.1.1.cmml" xref="S3.E5.m1.2.2.1.1.1.1"><csymbol cd="ambiguous" id="S3.E5.m1.2.2.1.1.1.1.1.cmml" xref="S3.E5.m1.2.2.1.1.1.1">subscript</csymbol><ci id="S3.E5.m1.2.2.1.1.1.1.2.cmml" xref="S3.E5.m1.2.2.1.1.1.1.2">𝜃</ci><ci id="S3.E5.m1.2.2.1.1.1.1.3.cmml" xref="S3.E5.m1.2.2.1.1.1.1.3">𝑖</ci></apply><ci id="S3.E5.m1.1.1.cmml" xref="S3.E5.m1.1.1">𝑥</ci></list></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E5.m1.2c">\widehat{y}=M_{G}(\theta_{i};x)</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(5)</span></td>
</tr></tbody>
</table>
<p id="S3.SS2.p4.3" class="ltx_p">where the <math id="S3.SS2.p4.1.m1.1" class="ltx_Math" alttext="\theta_{i}" display="inline"><semantics id="S3.SS2.p4.1.m1.1a"><msub id="S3.SS2.p4.1.m1.1.1" xref="S3.SS2.p4.1.m1.1.1.cmml"><mi id="S3.SS2.p4.1.m1.1.1.2" xref="S3.SS2.p4.1.m1.1.1.2.cmml">θ</mi><mi id="S3.SS2.p4.1.m1.1.1.3" xref="S3.SS2.p4.1.m1.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.p4.1.m1.1b"><apply id="S3.SS2.p4.1.m1.1.1.cmml" xref="S3.SS2.p4.1.m1.1.1"><csymbol cd="ambiguous" id="S3.SS2.p4.1.m1.1.1.1.cmml" xref="S3.SS2.p4.1.m1.1.1">subscript</csymbol><ci id="S3.SS2.p4.1.m1.1.1.2.cmml" xref="S3.SS2.p4.1.m1.1.1.2">𝜃</ci><ci id="S3.SS2.p4.1.m1.1.1.3.cmml" xref="S3.SS2.p4.1.m1.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p4.1.m1.1c">\theta_{i}</annotation></semantics></math> is what we want for the client <math id="S3.SS2.p4.2.m2.1" class="ltx_Math" alttext="i" display="inline"><semantics id="S3.SS2.p4.2.m2.1a"><mi id="S3.SS2.p4.2.m2.1.1" xref="S3.SS2.p4.2.m2.1.1.cmml">i</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p4.2.m2.1b"><ci id="S3.SS2.p4.2.m2.1.1.cmml" xref="S3.SS2.p4.2.m2.1.1">𝑖</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p4.2.m2.1c">i</annotation></semantics></math> through PFL, and the <math id="S3.SS2.p4.3.m3.1" class="ltx_Math" alttext="\widehat{y}" display="inline"><semantics id="S3.SS2.p4.3.m3.1a"><mover accent="true" id="S3.SS2.p4.3.m3.1.1" xref="S3.SS2.p4.3.m3.1.1.cmml"><mi id="S3.SS2.p4.3.m3.1.1.2" xref="S3.SS2.p4.3.m3.1.1.2.cmml">y</mi><mo id="S3.SS2.p4.3.m3.1.1.1" xref="S3.SS2.p4.3.m3.1.1.1.cmml">^</mo></mover><annotation-xml encoding="MathML-Content" id="S3.SS2.p4.3.m3.1b"><apply id="S3.SS2.p4.3.m3.1.1.cmml" xref="S3.SS2.p4.3.m3.1.1"><ci id="S3.SS2.p4.3.m3.1.1.1.cmml" xref="S3.SS2.p4.3.m3.1.1.1">^</ci><ci id="S3.SS2.p4.3.m3.1.1.2.cmml" xref="S3.SS2.p4.3.m3.1.1.2">𝑦</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p4.3.m3.1c">\widehat{y}</annotation></semantics></math> is the output pseudo label corresponding to x.</p>
</div>
<div id="S3.SS2.p5" class="ltx_para">
<p id="S3.SS2.p5.3" class="ltx_p">In PFL-FT, the initial value of <math id="S3.SS2.p5.1.m1.1" class="ltx_Math" alttext="\theta_{i}" display="inline"><semantics id="S3.SS2.p5.1.m1.1a"><msub id="S3.SS2.p5.1.m1.1.1" xref="S3.SS2.p5.1.m1.1.1.cmml"><mi id="S3.SS2.p5.1.m1.1.1.2" xref="S3.SS2.p5.1.m1.1.1.2.cmml">θ</mi><mi id="S3.SS2.p5.1.m1.1.1.3" xref="S3.SS2.p5.1.m1.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.p5.1.m1.1b"><apply id="S3.SS2.p5.1.m1.1.1.cmml" xref="S3.SS2.p5.1.m1.1.1"><csymbol cd="ambiguous" id="S3.SS2.p5.1.m1.1.1.1.cmml" xref="S3.SS2.p5.1.m1.1.1">subscript</csymbol><ci id="S3.SS2.p5.1.m1.1.1.2.cmml" xref="S3.SS2.p5.1.m1.1.1.2">𝜃</ci><ci id="S3.SS2.p5.1.m1.1.1.3.cmml" xref="S3.SS2.p5.1.m1.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p5.1.m1.1c">\theta_{i}</annotation></semantics></math> is the global model parameter <math id="S3.SS2.p5.2.m2.1" class="ltx_Math" alttext="\theta" display="inline"><semantics id="S3.SS2.p5.2.m2.1a"><mi id="S3.SS2.p5.2.m2.1.1" xref="S3.SS2.p5.2.m2.1.1.cmml">θ</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p5.2.m2.1b"><ci id="S3.SS2.p5.2.m2.1.1.cmml" xref="S3.SS2.p5.2.m2.1.1">𝜃</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p5.2.m2.1c">\theta</annotation></semantics></math>, and the <math id="S3.SS2.p5.3.m3.1" class="ltx_Math" alttext="\theta_{i}" display="inline"><semantics id="S3.SS2.p5.3.m3.1a"><msub id="S3.SS2.p5.3.m3.1.1" xref="S3.SS2.p5.3.m3.1.1.cmml"><mi id="S3.SS2.p5.3.m3.1.1.2" xref="S3.SS2.p5.3.m3.1.1.2.cmml">θ</mi><mi id="S3.SS2.p5.3.m3.1.1.3" xref="S3.SS2.p5.3.m3.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.p5.3.m3.1b"><apply id="S3.SS2.p5.3.m3.1.1.cmml" xref="S3.SS2.p5.3.m3.1.1"><csymbol cd="ambiguous" id="S3.SS2.p5.3.m3.1.1.1.cmml" xref="S3.SS2.p5.3.m3.1.1">subscript</csymbol><ci id="S3.SS2.p5.3.m3.1.1.2.cmml" xref="S3.SS2.p5.3.m3.1.1.2">𝜃</ci><ci id="S3.SS2.p5.3.m3.1.1.3.cmml" xref="S3.SS2.p5.3.m3.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p5.3.m3.1c">\theta_{i}</annotation></semantics></math> is updated by stochastic gradient descent (SGD) with a relatively small learning rate:</p>
<table id="S3.E6" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S3.E6.m1.1" class="ltx_Math" alttext="\theta_{i}=\theta_{i}-\alpha\cdot\triangledown{f_{i}(\theta_{i})}" display="block"><semantics id="S3.E6.m1.1a"><mrow id="S3.E6.m1.1.1" xref="S3.E6.m1.1.1.cmml"><msub id="S3.E6.m1.1.1.3" xref="S3.E6.m1.1.1.3.cmml"><mi id="S3.E6.m1.1.1.3.2" xref="S3.E6.m1.1.1.3.2.cmml">θ</mi><mi id="S3.E6.m1.1.1.3.3" xref="S3.E6.m1.1.1.3.3.cmml">i</mi></msub><mo id="S3.E6.m1.1.1.2" xref="S3.E6.m1.1.1.2.cmml">=</mo><mrow id="S3.E6.m1.1.1.1" xref="S3.E6.m1.1.1.1.cmml"><msub id="S3.E6.m1.1.1.1.3" xref="S3.E6.m1.1.1.1.3.cmml"><mi id="S3.E6.m1.1.1.1.3.2" xref="S3.E6.m1.1.1.1.3.2.cmml">θ</mi><mi id="S3.E6.m1.1.1.1.3.3" xref="S3.E6.m1.1.1.1.3.3.cmml">i</mi></msub><mo id="S3.E6.m1.1.1.1.2" xref="S3.E6.m1.1.1.1.2.cmml">−</mo><mrow id="S3.E6.m1.1.1.1.1" xref="S3.E6.m1.1.1.1.1.cmml"><mrow id="S3.E6.m1.1.1.1.1.3" xref="S3.E6.m1.1.1.1.1.3.cmml"><mi id="S3.E6.m1.1.1.1.1.3.2" xref="S3.E6.m1.1.1.1.1.3.2.cmml">α</mi><mo lspace="0.222em" rspace="0.222em" id="S3.E6.m1.1.1.1.1.3.1" xref="S3.E6.m1.1.1.1.1.3.1.cmml">⋅</mo><mi mathvariant="normal" id="S3.E6.m1.1.1.1.1.3.3" xref="S3.E6.m1.1.1.1.1.3.3.cmml">▽</mi></mrow><mo lspace="0em" rspace="0em" id="S3.E6.m1.1.1.1.1.2" xref="S3.E6.m1.1.1.1.1.2.cmml">​</mo><msub id="S3.E6.m1.1.1.1.1.4" xref="S3.E6.m1.1.1.1.1.4.cmml"><mi id="S3.E6.m1.1.1.1.1.4.2" xref="S3.E6.m1.1.1.1.1.4.2.cmml">f</mi><mi id="S3.E6.m1.1.1.1.1.4.3" xref="S3.E6.m1.1.1.1.1.4.3.cmml">i</mi></msub><mo lspace="0em" rspace="0em" id="S3.E6.m1.1.1.1.1.2a" xref="S3.E6.m1.1.1.1.1.2.cmml">​</mo><mrow id="S3.E6.m1.1.1.1.1.1.1" xref="S3.E6.m1.1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S3.E6.m1.1.1.1.1.1.1.2" xref="S3.E6.m1.1.1.1.1.1.1.1.cmml">(</mo><msub id="S3.E6.m1.1.1.1.1.1.1.1" xref="S3.E6.m1.1.1.1.1.1.1.1.cmml"><mi id="S3.E6.m1.1.1.1.1.1.1.1.2" xref="S3.E6.m1.1.1.1.1.1.1.1.2.cmml">θ</mi><mi id="S3.E6.m1.1.1.1.1.1.1.1.3" xref="S3.E6.m1.1.1.1.1.1.1.1.3.cmml">i</mi></msub><mo stretchy="false" id="S3.E6.m1.1.1.1.1.1.1.3" xref="S3.E6.m1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.E6.m1.1b"><apply id="S3.E6.m1.1.1.cmml" xref="S3.E6.m1.1.1"><eq id="S3.E6.m1.1.1.2.cmml" xref="S3.E6.m1.1.1.2"></eq><apply id="S3.E6.m1.1.1.3.cmml" xref="S3.E6.m1.1.1.3"><csymbol cd="ambiguous" id="S3.E6.m1.1.1.3.1.cmml" xref="S3.E6.m1.1.1.3">subscript</csymbol><ci id="S3.E6.m1.1.1.3.2.cmml" xref="S3.E6.m1.1.1.3.2">𝜃</ci><ci id="S3.E6.m1.1.1.3.3.cmml" xref="S3.E6.m1.1.1.3.3">𝑖</ci></apply><apply id="S3.E6.m1.1.1.1.cmml" xref="S3.E6.m1.1.1.1"><minus id="S3.E6.m1.1.1.1.2.cmml" xref="S3.E6.m1.1.1.1.2"></minus><apply id="S3.E6.m1.1.1.1.3.cmml" xref="S3.E6.m1.1.1.1.3"><csymbol cd="ambiguous" id="S3.E6.m1.1.1.1.3.1.cmml" xref="S3.E6.m1.1.1.1.3">subscript</csymbol><ci id="S3.E6.m1.1.1.1.3.2.cmml" xref="S3.E6.m1.1.1.1.3.2">𝜃</ci><ci id="S3.E6.m1.1.1.1.3.3.cmml" xref="S3.E6.m1.1.1.1.3.3">𝑖</ci></apply><apply id="S3.E6.m1.1.1.1.1.cmml" xref="S3.E6.m1.1.1.1.1"><times id="S3.E6.m1.1.1.1.1.2.cmml" xref="S3.E6.m1.1.1.1.1.2"></times><apply id="S3.E6.m1.1.1.1.1.3.cmml" xref="S3.E6.m1.1.1.1.1.3"><ci id="S3.E6.m1.1.1.1.1.3.1.cmml" xref="S3.E6.m1.1.1.1.1.3.1">⋅</ci><ci id="S3.E6.m1.1.1.1.1.3.2.cmml" xref="S3.E6.m1.1.1.1.1.3.2">𝛼</ci><ci id="S3.E6.m1.1.1.1.1.3.3.cmml" xref="S3.E6.m1.1.1.1.1.3.3">▽</ci></apply><apply id="S3.E6.m1.1.1.1.1.4.cmml" xref="S3.E6.m1.1.1.1.1.4"><csymbol cd="ambiguous" id="S3.E6.m1.1.1.1.1.4.1.cmml" xref="S3.E6.m1.1.1.1.1.4">subscript</csymbol><ci id="S3.E6.m1.1.1.1.1.4.2.cmml" xref="S3.E6.m1.1.1.1.1.4.2">𝑓</ci><ci id="S3.E6.m1.1.1.1.1.4.3.cmml" xref="S3.E6.m1.1.1.1.1.4.3">𝑖</ci></apply><apply id="S3.E6.m1.1.1.1.1.1.1.1.cmml" xref="S3.E6.m1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E6.m1.1.1.1.1.1.1.1.1.cmml" xref="S3.E6.m1.1.1.1.1.1.1">subscript</csymbol><ci id="S3.E6.m1.1.1.1.1.1.1.1.2.cmml" xref="S3.E6.m1.1.1.1.1.1.1.1.2">𝜃</ci><ci id="S3.E6.m1.1.1.1.1.1.1.1.3.cmml" xref="S3.E6.m1.1.1.1.1.1.1.1.3">𝑖</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E6.m1.1c">\theta_{i}=\theta_{i}-\alpha\cdot\triangledown{f_{i}(\theta_{i})}</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(6)</span></td>
</tr></tbody>
</table>
<p id="S3.SS2.p5.5" class="ltx_p">where <math id="S3.SS2.p5.4.m1.1" class="ltx_Math" alttext="\alpha" display="inline"><semantics id="S3.SS2.p5.4.m1.1a"><mi id="S3.SS2.p5.4.m1.1.1" xref="S3.SS2.p5.4.m1.1.1.cmml">α</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p5.4.m1.1b"><ci id="S3.SS2.p5.4.m1.1.1.cmml" xref="S3.SS2.p5.4.m1.1.1">𝛼</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p5.4.m1.1c">\alpha</annotation></semantics></math> is the learning rate of the <math id="S3.SS2.p5.5.m2.1" class="ltx_Math" alttext="\theta_{i}" display="inline"><semantics id="S3.SS2.p5.5.m2.1a"><msub id="S3.SS2.p5.5.m2.1.1" xref="S3.SS2.p5.5.m2.1.1.cmml"><mi id="S3.SS2.p5.5.m2.1.1.2" xref="S3.SS2.p5.5.m2.1.1.2.cmml">θ</mi><mi id="S3.SS2.p5.5.m2.1.1.3" xref="S3.SS2.p5.5.m2.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.p5.5.m2.1b"><apply id="S3.SS2.p5.5.m2.1.1.cmml" xref="S3.SS2.p5.5.m2.1.1"><csymbol cd="ambiguous" id="S3.SS2.p5.5.m2.1.1.1.cmml" xref="S3.SS2.p5.5.m2.1.1">subscript</csymbol><ci id="S3.SS2.p5.5.m2.1.1.2.cmml" xref="S3.SS2.p5.5.m2.1.1.2">𝜃</ci><ci id="S3.SS2.p5.5.m2.1.1.3.cmml" xref="S3.SS2.p5.5.m2.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p5.5.m2.1c">\theta_{i}</annotation></semantics></math>.</p>
</div>
</section>
<section id="S3.SS3" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection"><span id="S3.SS3.5.1.1" class="ltx_text">III-C</span> </span><span id="S3.SS3.6.2" class="ltx_text ltx_font_italic">Mixing</span>
</h3>

<div id="S3.SS3.p1" class="ltx_para">
<p id="S3.SS3.p1.1" class="ltx_p">The proposed PFL-MoE mixes the output of the personalized model and the global model using MoE architecture. MoE architecture is a method of ensemble learning. Different from the typical ensemble learning methods, the individual learners of MoE are trained for different subtasks, so its diversity can be guaranteed. In the MoE architecture, experts are independent on each other, and there is no limit that each expert must have the same mode structure <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib8" title="" class="ltx_ref">8</a>]</cite>.</p>
</div>
<figure id="alg1" class="ltx_float ltx_float_algorithm ltx_framed ltx_framed_top">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_float"><span id="alg1.2.1.1" class="ltx_text ltx_font_bold">Algorithm 1</span> </span> PFL-MoE</figcaption>
<div id="alg1.3" class="ltx_listing ltx_listing">
<div id="alg1.l0" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg1.l0.1.1.1" class="ltx_text" style="font-size:80%;">0:</span></span>  global model structure <math id="alg1.l0.m1.1" class="ltx_Math" alttext="M_{G}" display="inline"><semantics id="alg1.l0.m1.1a"><msub id="alg1.l0.m1.1.1" xref="alg1.l0.m1.1.1.cmml"><mi id="alg1.l0.m1.1.1.2" xref="alg1.l0.m1.1.1.2.cmml">M</mi><mi id="alg1.l0.m1.1.1.3" xref="alg1.l0.m1.1.1.3.cmml">G</mi></msub><annotation-xml encoding="MathML-Content" id="alg1.l0.m1.1b"><apply id="alg1.l0.m1.1.1.cmml" xref="alg1.l0.m1.1.1"><csymbol cd="ambiguous" id="alg1.l0.m1.1.1.1.cmml" xref="alg1.l0.m1.1.1">subscript</csymbol><ci id="alg1.l0.m1.1.1.2.cmml" xref="alg1.l0.m1.1.1.2">𝑀</ci><ci id="alg1.l0.m1.1.1.3.cmml" xref="alg1.l0.m1.1.1.3">𝐺</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l0.m1.1c">M_{G}</annotation></semantics></math>, and latest global model parameter <math id="alg1.l0.m2.1" class="ltx_Math" alttext="\theta" display="inline"><semantics id="alg1.l0.m2.1a"><mi id="alg1.l0.m2.1.1" xref="alg1.l0.m2.1.1.cmml">θ</mi><annotation-xml encoding="MathML-Content" id="alg1.l0.m2.1b"><ci id="alg1.l0.m2.1.1.cmml" xref="alg1.l0.m2.1.1">𝜃</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.l0.m2.1c">\theta</annotation></semantics></math>, client’s data <math id="alg1.l0.m3.1" class="ltx_Math" alttext="D_{i}" display="inline"><semantics id="alg1.l0.m3.1a"><msub id="alg1.l0.m3.1.1" xref="alg1.l0.m3.1.1.cmml"><mi id="alg1.l0.m3.1.1.2" xref="alg1.l0.m3.1.1.2.cmml">D</mi><mi id="alg1.l0.m3.1.1.3" xref="alg1.l0.m3.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="alg1.l0.m3.1b"><apply id="alg1.l0.m3.1.1.cmml" xref="alg1.l0.m3.1.1"><csymbol cd="ambiguous" id="alg1.l0.m3.1.1.1.cmml" xref="alg1.l0.m3.1.1">subscript</csymbol><ci id="alg1.l0.m3.1.1.2.cmml" xref="alg1.l0.m3.1.1.2">𝐷</ci><ci id="alg1.l0.m3.1.1.3.cmml" xref="alg1.l0.m3.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l0.m3.1c">D_{i}</annotation></semantics></math>, <math id="alg1.l0.m4.1" class="ltx_Math" alttext="\theta_{i}" display="inline"><semantics id="alg1.l0.m4.1a"><msub id="alg1.l0.m4.1.1" xref="alg1.l0.m4.1.1.cmml"><mi id="alg1.l0.m4.1.1.2" xref="alg1.l0.m4.1.1.2.cmml">θ</mi><mi id="alg1.l0.m4.1.1.3" xref="alg1.l0.m4.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="alg1.l0.m4.1b"><apply id="alg1.l0.m4.1.1.cmml" xref="alg1.l0.m4.1.1"><csymbol cd="ambiguous" id="alg1.l0.m4.1.1.1.cmml" xref="alg1.l0.m4.1.1">subscript</csymbol><ci id="alg1.l0.m4.1.1.2.cmml" xref="alg1.l0.m4.1.1.2">𝜃</ci><ci id="alg1.l0.m4.1.1.3.cmml" xref="alg1.l0.m4.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l0.m4.1c">\theta_{i}</annotation></semantics></math>’s learning rate <math id="alg1.l0.m5.1" class="ltx_Math" alttext="\alpha" display="inline"><semantics id="alg1.l0.m5.1a"><mi id="alg1.l0.m5.1.1" xref="alg1.l0.m5.1.1.cmml">α</mi><annotation-xml encoding="MathML-Content" id="alg1.l0.m5.1b"><ci id="alg1.l0.m5.1.1.cmml" xref="alg1.l0.m5.1.1">𝛼</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.l0.m5.1c">\alpha</annotation></semantics></math>, <math id="alg1.l0.m6.1" class="ltx_Math" alttext="w_{i}" display="inline"><semantics id="alg1.l0.m6.1a"><msub id="alg1.l0.m6.1.1" xref="alg1.l0.m6.1.1.cmml"><mi id="alg1.l0.m6.1.1.2" xref="alg1.l0.m6.1.1.2.cmml">w</mi><mi id="alg1.l0.m6.1.1.3" xref="alg1.l0.m6.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="alg1.l0.m6.1b"><apply id="alg1.l0.m6.1.1.cmml" xref="alg1.l0.m6.1.1"><csymbol cd="ambiguous" id="alg1.l0.m6.1.1.1.cmml" xref="alg1.l0.m6.1.1">subscript</csymbol><ci id="alg1.l0.m6.1.1.2.cmml" xref="alg1.l0.m6.1.1.2">𝑤</ci><ci id="alg1.l0.m6.1.1.3.cmml" xref="alg1.l0.m6.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l0.m6.1c">w_{i}</annotation></semantics></math>’s learning rate <math id="alg1.l0.m7.1" class="ltx_Math" alttext="\beta" display="inline"><semantics id="alg1.l0.m7.1a"><mi id="alg1.l0.m7.1.1" xref="alg1.l0.m7.1.1.cmml">β</mi><annotation-xml encoding="MathML-Content" id="alg1.l0.m7.1b"><ci id="alg1.l0.m7.1.1.cmml" xref="alg1.l0.m7.1.1">𝛽</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.l0.m7.1c">\beta</annotation></semantics></math>, local adaptation epochs <math id="alg1.l0.m8.1" class="ltx_Math" alttext="E" display="inline"><semantics id="alg1.l0.m8.1a"><mi id="alg1.l0.m8.1.1" xref="alg1.l0.m8.1.1.cmml">E</mi><annotation-xml encoding="MathML-Content" id="alg1.l0.m8.1b"><ci id="alg1.l0.m8.1.1.cmml" xref="alg1.l0.m8.1.1">𝐸</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.l0.m8.1c">E</annotation></semantics></math>, loss function <math id="alg1.l0.m9.1" class="ltx_Math" alttext="L" display="inline"><semantics id="alg1.l0.m9.1a"><mi id="alg1.l0.m9.1.1" xref="alg1.l0.m9.1.1.cmml">L</mi><annotation-xml encoding="MathML-Content" id="alg1.l0.m9.1b"><ci id="alg1.l0.m9.1.1.cmml" xref="alg1.l0.m9.1.1">𝐿</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.l0.m9.1c">L</annotation></semantics></math>

</div>
<div id="alg1.l0a" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg1.l0a.1.1.1" class="ltx_text" style="font-size:80%;">0:</span></span>  personalized model parameter <math id="alg1.l0a.m1.1" class="ltx_Math" alttext="\theta_{i}" display="inline"><semantics id="alg1.l0a.m1.1a"><msub id="alg1.l0a.m1.1.1" xref="alg1.l0a.m1.1.1.cmml"><mi id="alg1.l0a.m1.1.1.2" xref="alg1.l0a.m1.1.1.2.cmml">θ</mi><mi id="alg1.l0a.m1.1.1.3" xref="alg1.l0a.m1.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="alg1.l0a.m1.1b"><apply id="alg1.l0a.m1.1.1.cmml" xref="alg1.l0a.m1.1.1"><csymbol cd="ambiguous" id="alg1.l0a.m1.1.1.1.cmml" xref="alg1.l0a.m1.1.1">subscript</csymbol><ci id="alg1.l0a.m1.1.1.2.cmml" xref="alg1.l0a.m1.1.1.2">𝜃</ci><ci id="alg1.l0a.m1.1.1.3.cmml" xref="alg1.l0a.m1.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l0a.m1.1c">\theta_{i}</annotation></semantics></math>, gating network parameter <math id="alg1.l0a.m2.1" class="ltx_Math" alttext="w_{i}" display="inline"><semantics id="alg1.l0a.m2.1a"><msub id="alg1.l0a.m2.1.1" xref="alg1.l0a.m2.1.1.cmml"><mi id="alg1.l0a.m2.1.1.2" xref="alg1.l0a.m2.1.1.2.cmml">w</mi><mi id="alg1.l0a.m2.1.1.3" xref="alg1.l0a.m2.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="alg1.l0a.m2.1b"><apply id="alg1.l0a.m2.1.1.cmml" xref="alg1.l0a.m2.1.1"><csymbol cd="ambiguous" id="alg1.l0a.m2.1.1.1.cmml" xref="alg1.l0a.m2.1.1">subscript</csymbol><ci id="alg1.l0a.m2.1.1.2.cmml" xref="alg1.l0a.m2.1.1.2">𝑤</ci><ci id="alg1.l0a.m2.1.1.3.cmml" xref="alg1.l0a.m2.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l0a.m2.1c">w_{i}</annotation></semantics></math>

</div>
<div id="alg1.l1" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg1.l1.3.1.1" class="ltx_text" style="font-size:80%;">1:</span></span>  <span id="alg1.l1.2" class="ltx_text ltx_font_italic"># Initialize client’s personalized model parameter <math id="alg1.l1.1.m1.1" class="ltx_Math" alttext="\theta_{i}" display="inline"><semantics id="alg1.l1.1.m1.1a"><msub id="alg1.l1.1.m1.1.1" xref="alg1.l1.1.m1.1.1.cmml"><mi id="alg1.l1.1.m1.1.1.2" xref="alg1.l1.1.m1.1.1.2.cmml">θ</mi><mi id="alg1.l1.1.m1.1.1.3" xref="alg1.l1.1.m1.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="alg1.l1.1.m1.1b"><apply id="alg1.l1.1.m1.1.1.cmml" xref="alg1.l1.1.m1.1.1"><csymbol cd="ambiguous" id="alg1.l1.1.m1.1.1.1.cmml" xref="alg1.l1.1.m1.1.1">subscript</csymbol><ci id="alg1.l1.1.m1.1.1.2.cmml" xref="alg1.l1.1.m1.1.1.2">𝜃</ci><ci id="alg1.l1.1.m1.1.1.3.cmml" xref="alg1.l1.1.m1.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l1.1.m1.1c">\theta_{i}</annotation></semantics></math> with global <math id="alg1.l1.2.m2.1" class="ltx_Math" alttext="\theta" display="inline"><semantics id="alg1.l1.2.m2.1a"><mi id="alg1.l1.2.m2.1.1" xref="alg1.l1.2.m2.1.1.cmml">θ</mi><annotation-xml encoding="MathML-Content" id="alg1.l1.2.m2.1b"><ci id="alg1.l1.2.m2.1.1.cmml" xref="alg1.l1.2.m2.1.1">𝜃</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.l1.2.m2.1c">\theta</annotation></semantics></math></span>

</div>
<div id="alg1.l2" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg1.l2.1.1.1" class="ltx_text" style="font-size:80%;">2:</span></span>  <math id="alg1.l2.m1.1" class="ltx_Math" alttext="\theta_{i}\leftarrow\theta" display="inline"><semantics id="alg1.l2.m1.1a"><mrow id="alg1.l2.m1.1.1" xref="alg1.l2.m1.1.1.cmml"><msub id="alg1.l2.m1.1.1.2" xref="alg1.l2.m1.1.1.2.cmml"><mi id="alg1.l2.m1.1.1.2.2" xref="alg1.l2.m1.1.1.2.2.cmml">θ</mi><mi id="alg1.l2.m1.1.1.2.3" xref="alg1.l2.m1.1.1.2.3.cmml">i</mi></msub><mo stretchy="false" id="alg1.l2.m1.1.1.1" xref="alg1.l2.m1.1.1.1.cmml">←</mo><mi id="alg1.l2.m1.1.1.3" xref="alg1.l2.m1.1.1.3.cmml">θ</mi></mrow><annotation-xml encoding="MathML-Content" id="alg1.l2.m1.1b"><apply id="alg1.l2.m1.1.1.cmml" xref="alg1.l2.m1.1.1"><ci id="alg1.l2.m1.1.1.1.cmml" xref="alg1.l2.m1.1.1.1">←</ci><apply id="alg1.l2.m1.1.1.2.cmml" xref="alg1.l2.m1.1.1.2"><csymbol cd="ambiguous" id="alg1.l2.m1.1.1.2.1.cmml" xref="alg1.l2.m1.1.1.2">subscript</csymbol><ci id="alg1.l2.m1.1.1.2.2.cmml" xref="alg1.l2.m1.1.1.2.2">𝜃</ci><ci id="alg1.l2.m1.1.1.2.3.cmml" xref="alg1.l2.m1.1.1.2.3">𝑖</ci></apply><ci id="alg1.l2.m1.1.1.3.cmml" xref="alg1.l2.m1.1.1.3">𝜃</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l2.m1.1c">\theta_{i}\leftarrow\theta</annotation></semantics></math>

</div>
<div id="alg1.l3" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg1.l3.1.1.1" class="ltx_text" style="font-size:80%;">3:</span></span>  divide <math id="alg1.l3.m1.1" class="ltx_Math" alttext="D_{i}" display="inline"><semantics id="alg1.l3.m1.1a"><msub id="alg1.l3.m1.1.1" xref="alg1.l3.m1.1.1.cmml"><mi id="alg1.l3.m1.1.1.2" xref="alg1.l3.m1.1.1.2.cmml">D</mi><mi id="alg1.l3.m1.1.1.3" xref="alg1.l3.m1.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="alg1.l3.m1.1b"><apply id="alg1.l3.m1.1.1.cmml" xref="alg1.l3.m1.1.1"><csymbol cd="ambiguous" id="alg1.l3.m1.1.1.1.cmml" xref="alg1.l3.m1.1.1">subscript</csymbol><ci id="alg1.l3.m1.1.1.2.cmml" xref="alg1.l3.m1.1.1.2">𝐷</ci><ci id="alg1.l3.m1.1.1.3.cmml" xref="alg1.l3.m1.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l3.m1.1c">D_{i}</annotation></semantics></math> to <math id="alg1.l3.m2.1" class="ltx_Math" alttext="D_{i}^{per}" display="inline"><semantics id="alg1.l3.m2.1a"><msubsup id="alg1.l3.m2.1.1" xref="alg1.l3.m2.1.1.cmml"><mi id="alg1.l3.m2.1.1.2.2" xref="alg1.l3.m2.1.1.2.2.cmml">D</mi><mi id="alg1.l3.m2.1.1.2.3" xref="alg1.l3.m2.1.1.2.3.cmml">i</mi><mrow id="alg1.l3.m2.1.1.3" xref="alg1.l3.m2.1.1.3.cmml"><mi id="alg1.l3.m2.1.1.3.2" xref="alg1.l3.m2.1.1.3.2.cmml">p</mi><mo lspace="0em" rspace="0em" id="alg1.l3.m2.1.1.3.1" xref="alg1.l3.m2.1.1.3.1.cmml">​</mo><mi id="alg1.l3.m2.1.1.3.3" xref="alg1.l3.m2.1.1.3.3.cmml">e</mi><mo lspace="0em" rspace="0em" id="alg1.l3.m2.1.1.3.1a" xref="alg1.l3.m2.1.1.3.1.cmml">​</mo><mi id="alg1.l3.m2.1.1.3.4" xref="alg1.l3.m2.1.1.3.4.cmml">r</mi></mrow></msubsup><annotation-xml encoding="MathML-Content" id="alg1.l3.m2.1b"><apply id="alg1.l3.m2.1.1.cmml" xref="alg1.l3.m2.1.1"><csymbol cd="ambiguous" id="alg1.l3.m2.1.1.1.cmml" xref="alg1.l3.m2.1.1">superscript</csymbol><apply id="alg1.l3.m2.1.1.2.cmml" xref="alg1.l3.m2.1.1"><csymbol cd="ambiguous" id="alg1.l3.m2.1.1.2.1.cmml" xref="alg1.l3.m2.1.1">subscript</csymbol><ci id="alg1.l3.m2.1.1.2.2.cmml" xref="alg1.l3.m2.1.1.2.2">𝐷</ci><ci id="alg1.l3.m2.1.1.2.3.cmml" xref="alg1.l3.m2.1.1.2.3">𝑖</ci></apply><apply id="alg1.l3.m2.1.1.3.cmml" xref="alg1.l3.m2.1.1.3"><times id="alg1.l3.m2.1.1.3.1.cmml" xref="alg1.l3.m2.1.1.3.1"></times><ci id="alg1.l3.m2.1.1.3.2.cmml" xref="alg1.l3.m2.1.1.3.2">𝑝</ci><ci id="alg1.l3.m2.1.1.3.3.cmml" xref="alg1.l3.m2.1.1.3.3">𝑒</ci><ci id="alg1.l3.m2.1.1.3.4.cmml" xref="alg1.l3.m2.1.1.3.4">𝑟</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l3.m2.1c">D_{i}^{per}</annotation></semantics></math>, <math id="alg1.l3.m3.1" class="ltx_Math" alttext="D_{i}^{gate}" display="inline"><semantics id="alg1.l3.m3.1a"><msubsup id="alg1.l3.m3.1.1" xref="alg1.l3.m3.1.1.cmml"><mi id="alg1.l3.m3.1.1.2.2" xref="alg1.l3.m3.1.1.2.2.cmml">D</mi><mi id="alg1.l3.m3.1.1.2.3" xref="alg1.l3.m3.1.1.2.3.cmml">i</mi><mrow id="alg1.l3.m3.1.1.3" xref="alg1.l3.m3.1.1.3.cmml"><mi id="alg1.l3.m3.1.1.3.2" xref="alg1.l3.m3.1.1.3.2.cmml">g</mi><mo lspace="0em" rspace="0em" id="alg1.l3.m3.1.1.3.1" xref="alg1.l3.m3.1.1.3.1.cmml">​</mo><mi id="alg1.l3.m3.1.1.3.3" xref="alg1.l3.m3.1.1.3.3.cmml">a</mi><mo lspace="0em" rspace="0em" id="alg1.l3.m3.1.1.3.1a" xref="alg1.l3.m3.1.1.3.1.cmml">​</mo><mi id="alg1.l3.m3.1.1.3.4" xref="alg1.l3.m3.1.1.3.4.cmml">t</mi><mo lspace="0em" rspace="0em" id="alg1.l3.m3.1.1.3.1b" xref="alg1.l3.m3.1.1.3.1.cmml">​</mo><mi id="alg1.l3.m3.1.1.3.5" xref="alg1.l3.m3.1.1.3.5.cmml">e</mi></mrow></msubsup><annotation-xml encoding="MathML-Content" id="alg1.l3.m3.1b"><apply id="alg1.l3.m3.1.1.cmml" xref="alg1.l3.m3.1.1"><csymbol cd="ambiguous" id="alg1.l3.m3.1.1.1.cmml" xref="alg1.l3.m3.1.1">superscript</csymbol><apply id="alg1.l3.m3.1.1.2.cmml" xref="alg1.l3.m3.1.1"><csymbol cd="ambiguous" id="alg1.l3.m3.1.1.2.1.cmml" xref="alg1.l3.m3.1.1">subscript</csymbol><ci id="alg1.l3.m3.1.1.2.2.cmml" xref="alg1.l3.m3.1.1.2.2">𝐷</ci><ci id="alg1.l3.m3.1.1.2.3.cmml" xref="alg1.l3.m3.1.1.2.3">𝑖</ci></apply><apply id="alg1.l3.m3.1.1.3.cmml" xref="alg1.l3.m3.1.1.3"><times id="alg1.l3.m3.1.1.3.1.cmml" xref="alg1.l3.m3.1.1.3.1"></times><ci id="alg1.l3.m3.1.1.3.2.cmml" xref="alg1.l3.m3.1.1.3.2">𝑔</ci><ci id="alg1.l3.m3.1.1.3.3.cmml" xref="alg1.l3.m3.1.1.3.3">𝑎</ci><ci id="alg1.l3.m3.1.1.3.4.cmml" xref="alg1.l3.m3.1.1.3.4">𝑡</ci><ci id="alg1.l3.m3.1.1.3.5.cmml" xref="alg1.l3.m3.1.1.3.5">𝑒</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l3.m3.1c">D_{i}^{gate}</annotation></semantics></math>

</div>
<div id="alg1.l4" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg1.l4.1.1.1" class="ltx_text" style="font-size:80%;">4:</span></span>  <span id="alg1.l4.2" class="ltx_text ltx_font_bold">for</span> epoch <math id="alg1.l4.m1.1" class="ltx_Math" alttext="e=1" display="inline"><semantics id="alg1.l4.m1.1a"><mrow id="alg1.l4.m1.1.1" xref="alg1.l4.m1.1.1.cmml"><mi id="alg1.l4.m1.1.1.2" xref="alg1.l4.m1.1.1.2.cmml">e</mi><mo id="alg1.l4.m1.1.1.1" xref="alg1.l4.m1.1.1.1.cmml">=</mo><mn id="alg1.l4.m1.1.1.3" xref="alg1.l4.m1.1.1.3.cmml">1</mn></mrow><annotation-xml encoding="MathML-Content" id="alg1.l4.m1.1b"><apply id="alg1.l4.m1.1.1.cmml" xref="alg1.l4.m1.1.1"><eq id="alg1.l4.m1.1.1.1.cmml" xref="alg1.l4.m1.1.1.1"></eq><ci id="alg1.l4.m1.1.1.2.cmml" xref="alg1.l4.m1.1.1.2">𝑒</ci><cn type="integer" id="alg1.l4.m1.1.1.3.cmml" xref="alg1.l4.m1.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l4.m1.1c">e=1</annotation></semantics></math> to <math id="alg1.l4.m2.1" class="ltx_Math" alttext="E" display="inline"><semantics id="alg1.l4.m2.1a"><mi id="alg1.l4.m2.1.1" xref="alg1.l4.m2.1.1.cmml">E</mi><annotation-xml encoding="MathML-Content" id="alg1.l4.m2.1b"><ci id="alg1.l4.m2.1.1.cmml" xref="alg1.l4.m2.1.1">𝐸</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.l4.m2.1c">E</annotation></semantics></math>  <span id="alg1.l4.3" class="ltx_text ltx_font_bold">do</span>



</div>
<div id="alg1.l5" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg1.l5.1.1.1" class="ltx_text" style="font-size:80%;">5:</span></span>     <span id="alg1.l5.2" class="ltx_text ltx_font_italic"># Local adaptation</span>

</div>
<div id="alg1.l6" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg1.l6.1.1.1" class="ltx_text" style="font-size:80%;">6:</span></span>     <span id="alg1.l6.2" class="ltx_text ltx_font_bold">for</span> batch <math id="alg1.l6.m1.2" class="ltx_Math" alttext="(x,y)\subset D_{i}^{per}" display="inline"><semantics id="alg1.l6.m1.2a"><mrow id="alg1.l6.m1.2.3" xref="alg1.l6.m1.2.3.cmml"><mrow id="alg1.l6.m1.2.3.2.2" xref="alg1.l6.m1.2.3.2.1.cmml"><mo stretchy="false" id="alg1.l6.m1.2.3.2.2.1" xref="alg1.l6.m1.2.3.2.1.cmml">(</mo><mi id="alg1.l6.m1.1.1" xref="alg1.l6.m1.1.1.cmml">x</mi><mo id="alg1.l6.m1.2.3.2.2.2" xref="alg1.l6.m1.2.3.2.1.cmml">,</mo><mi id="alg1.l6.m1.2.2" xref="alg1.l6.m1.2.2.cmml">y</mi><mo stretchy="false" id="alg1.l6.m1.2.3.2.2.3" xref="alg1.l6.m1.2.3.2.1.cmml">)</mo></mrow><mo id="alg1.l6.m1.2.3.1" xref="alg1.l6.m1.2.3.1.cmml">⊂</mo><msubsup id="alg1.l6.m1.2.3.3" xref="alg1.l6.m1.2.3.3.cmml"><mi id="alg1.l6.m1.2.3.3.2.2" xref="alg1.l6.m1.2.3.3.2.2.cmml">D</mi><mi id="alg1.l6.m1.2.3.3.2.3" xref="alg1.l6.m1.2.3.3.2.3.cmml">i</mi><mrow id="alg1.l6.m1.2.3.3.3" xref="alg1.l6.m1.2.3.3.3.cmml"><mi id="alg1.l6.m1.2.3.3.3.2" xref="alg1.l6.m1.2.3.3.3.2.cmml">p</mi><mo lspace="0em" rspace="0em" id="alg1.l6.m1.2.3.3.3.1" xref="alg1.l6.m1.2.3.3.3.1.cmml">​</mo><mi id="alg1.l6.m1.2.3.3.3.3" xref="alg1.l6.m1.2.3.3.3.3.cmml">e</mi><mo lspace="0em" rspace="0em" id="alg1.l6.m1.2.3.3.3.1a" xref="alg1.l6.m1.2.3.3.3.1.cmml">​</mo><mi id="alg1.l6.m1.2.3.3.3.4" xref="alg1.l6.m1.2.3.3.3.4.cmml">r</mi></mrow></msubsup></mrow><annotation-xml encoding="MathML-Content" id="alg1.l6.m1.2b"><apply id="alg1.l6.m1.2.3.cmml" xref="alg1.l6.m1.2.3"><subset id="alg1.l6.m1.2.3.1.cmml" xref="alg1.l6.m1.2.3.1"></subset><interval closure="open" id="alg1.l6.m1.2.3.2.1.cmml" xref="alg1.l6.m1.2.3.2.2"><ci id="alg1.l6.m1.1.1.cmml" xref="alg1.l6.m1.1.1">𝑥</ci><ci id="alg1.l6.m1.2.2.cmml" xref="alg1.l6.m1.2.2">𝑦</ci></interval><apply id="alg1.l6.m1.2.3.3.cmml" xref="alg1.l6.m1.2.3.3"><csymbol cd="ambiguous" id="alg1.l6.m1.2.3.3.1.cmml" xref="alg1.l6.m1.2.3.3">superscript</csymbol><apply id="alg1.l6.m1.2.3.3.2.cmml" xref="alg1.l6.m1.2.3.3"><csymbol cd="ambiguous" id="alg1.l6.m1.2.3.3.2.1.cmml" xref="alg1.l6.m1.2.3.3">subscript</csymbol><ci id="alg1.l6.m1.2.3.3.2.2.cmml" xref="alg1.l6.m1.2.3.3.2.2">𝐷</ci><ci id="alg1.l6.m1.2.3.3.2.3.cmml" xref="alg1.l6.m1.2.3.3.2.3">𝑖</ci></apply><apply id="alg1.l6.m1.2.3.3.3.cmml" xref="alg1.l6.m1.2.3.3.3"><times id="alg1.l6.m1.2.3.3.3.1.cmml" xref="alg1.l6.m1.2.3.3.3.1"></times><ci id="alg1.l6.m1.2.3.3.3.2.cmml" xref="alg1.l6.m1.2.3.3.3.2">𝑝</ci><ci id="alg1.l6.m1.2.3.3.3.3.cmml" xref="alg1.l6.m1.2.3.3.3.3">𝑒</ci><ci id="alg1.l6.m1.2.3.3.3.4.cmml" xref="alg1.l6.m1.2.3.3.3.4">𝑟</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l6.m1.2c">(x,y)\subset D_{i}^{per}</annotation></semantics></math>  <span id="alg1.l6.3" class="ltx_text ltx_font_bold">do</span>



</div>
<div id="alg1.l7" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg1.l7.1.1.1" class="ltx_text" style="font-size:80%;">7:</span></span>        <math id="alg1.l7.m1.2" class="ltx_Math" alttext="\widehat{y}\leftarrow M_{C}(\theta_{i};x)" display="inline"><semantics id="alg1.l7.m1.2a"><mrow id="alg1.l7.m1.2.2" xref="alg1.l7.m1.2.2.cmml"><mover accent="true" id="alg1.l7.m1.2.2.3" xref="alg1.l7.m1.2.2.3.cmml"><mi id="alg1.l7.m1.2.2.3.2" xref="alg1.l7.m1.2.2.3.2.cmml">y</mi><mo id="alg1.l7.m1.2.2.3.1" xref="alg1.l7.m1.2.2.3.1.cmml">^</mo></mover><mo stretchy="false" id="alg1.l7.m1.2.2.2" xref="alg1.l7.m1.2.2.2.cmml">←</mo><mrow id="alg1.l7.m1.2.2.1" xref="alg1.l7.m1.2.2.1.cmml"><msub id="alg1.l7.m1.2.2.1.3" xref="alg1.l7.m1.2.2.1.3.cmml"><mi id="alg1.l7.m1.2.2.1.3.2" xref="alg1.l7.m1.2.2.1.3.2.cmml">M</mi><mi id="alg1.l7.m1.2.2.1.3.3" xref="alg1.l7.m1.2.2.1.3.3.cmml">C</mi></msub><mo lspace="0em" rspace="0em" id="alg1.l7.m1.2.2.1.2" xref="alg1.l7.m1.2.2.1.2.cmml">​</mo><mrow id="alg1.l7.m1.2.2.1.1.1" xref="alg1.l7.m1.2.2.1.1.2.cmml"><mo stretchy="false" id="alg1.l7.m1.2.2.1.1.1.2" xref="alg1.l7.m1.2.2.1.1.2.cmml">(</mo><msub id="alg1.l7.m1.2.2.1.1.1.1" xref="alg1.l7.m1.2.2.1.1.1.1.cmml"><mi id="alg1.l7.m1.2.2.1.1.1.1.2" xref="alg1.l7.m1.2.2.1.1.1.1.2.cmml">θ</mi><mi id="alg1.l7.m1.2.2.1.1.1.1.3" xref="alg1.l7.m1.2.2.1.1.1.1.3.cmml">i</mi></msub><mo id="alg1.l7.m1.2.2.1.1.1.3" xref="alg1.l7.m1.2.2.1.1.2.cmml">;</mo><mi id="alg1.l7.m1.1.1" xref="alg1.l7.m1.1.1.cmml">x</mi><mo stretchy="false" id="alg1.l7.m1.2.2.1.1.1.4" xref="alg1.l7.m1.2.2.1.1.2.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l7.m1.2b"><apply id="alg1.l7.m1.2.2.cmml" xref="alg1.l7.m1.2.2"><ci id="alg1.l7.m1.2.2.2.cmml" xref="alg1.l7.m1.2.2.2">←</ci><apply id="alg1.l7.m1.2.2.3.cmml" xref="alg1.l7.m1.2.2.3"><ci id="alg1.l7.m1.2.2.3.1.cmml" xref="alg1.l7.m1.2.2.3.1">^</ci><ci id="alg1.l7.m1.2.2.3.2.cmml" xref="alg1.l7.m1.2.2.3.2">𝑦</ci></apply><apply id="alg1.l7.m1.2.2.1.cmml" xref="alg1.l7.m1.2.2.1"><times id="alg1.l7.m1.2.2.1.2.cmml" xref="alg1.l7.m1.2.2.1.2"></times><apply id="alg1.l7.m1.2.2.1.3.cmml" xref="alg1.l7.m1.2.2.1.3"><csymbol cd="ambiguous" id="alg1.l7.m1.2.2.1.3.1.cmml" xref="alg1.l7.m1.2.2.1.3">subscript</csymbol><ci id="alg1.l7.m1.2.2.1.3.2.cmml" xref="alg1.l7.m1.2.2.1.3.2">𝑀</ci><ci id="alg1.l7.m1.2.2.1.3.3.cmml" xref="alg1.l7.m1.2.2.1.3.3">𝐶</ci></apply><list id="alg1.l7.m1.2.2.1.1.2.cmml" xref="alg1.l7.m1.2.2.1.1.1"><apply id="alg1.l7.m1.2.2.1.1.1.1.cmml" xref="alg1.l7.m1.2.2.1.1.1.1"><csymbol cd="ambiguous" id="alg1.l7.m1.2.2.1.1.1.1.1.cmml" xref="alg1.l7.m1.2.2.1.1.1.1">subscript</csymbol><ci id="alg1.l7.m1.2.2.1.1.1.1.2.cmml" xref="alg1.l7.m1.2.2.1.1.1.1.2">𝜃</ci><ci id="alg1.l7.m1.2.2.1.1.1.1.3.cmml" xref="alg1.l7.m1.2.2.1.1.1.1.3">𝑖</ci></apply><ci id="alg1.l7.m1.1.1.cmml" xref="alg1.l7.m1.1.1">𝑥</ci></list></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l7.m1.2c">\widehat{y}\leftarrow M_{C}(\theta_{i};x)</annotation></semantics></math>

</div>
<div id="alg1.l8" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg1.l8.1.1.1" class="ltx_text" style="font-size:80%;">8:</span></span>        <math id="alg1.l8.m1.2" class="ltx_Math" alttext="\theta_{i}\leftarrow\theta_{i}-\alpha\cdot\triangledown_{\theta_{i}}{L(\widehat{y},y)}" display="inline"><semantics id="alg1.l8.m1.2a"><mrow id="alg1.l8.m1.2.3" xref="alg1.l8.m1.2.3.cmml"><msub id="alg1.l8.m1.2.3.2" xref="alg1.l8.m1.2.3.2.cmml"><mi id="alg1.l8.m1.2.3.2.2" xref="alg1.l8.m1.2.3.2.2.cmml">θ</mi><mi id="alg1.l8.m1.2.3.2.3" xref="alg1.l8.m1.2.3.2.3.cmml">i</mi></msub><mo stretchy="false" id="alg1.l8.m1.2.3.1" xref="alg1.l8.m1.2.3.1.cmml">←</mo><mrow id="alg1.l8.m1.2.3.3" xref="alg1.l8.m1.2.3.3.cmml"><msub id="alg1.l8.m1.2.3.3.2" xref="alg1.l8.m1.2.3.3.2.cmml"><mi id="alg1.l8.m1.2.3.3.2.2" xref="alg1.l8.m1.2.3.3.2.2.cmml">θ</mi><mi id="alg1.l8.m1.2.3.3.2.3" xref="alg1.l8.m1.2.3.3.2.3.cmml">i</mi></msub><mo id="alg1.l8.m1.2.3.3.1" xref="alg1.l8.m1.2.3.3.1.cmml">−</mo><mrow id="alg1.l8.m1.2.3.3.3" xref="alg1.l8.m1.2.3.3.3.cmml"><mrow id="alg1.l8.m1.2.3.3.3.2" xref="alg1.l8.m1.2.3.3.3.2.cmml"><mi id="alg1.l8.m1.2.3.3.3.2.2" xref="alg1.l8.m1.2.3.3.3.2.2.cmml">α</mi><mo lspace="0.222em" rspace="0.222em" id="alg1.l8.m1.2.3.3.3.2.1" xref="alg1.l8.m1.2.3.3.3.2.1.cmml">⋅</mo><msub id="alg1.l8.m1.2.3.3.3.2.3" xref="alg1.l8.m1.2.3.3.3.2.3.cmml"><mi mathvariant="normal" id="alg1.l8.m1.2.3.3.3.2.3.2" xref="alg1.l8.m1.2.3.3.3.2.3.2.cmml">▽</mi><msub id="alg1.l8.m1.2.3.3.3.2.3.3" xref="alg1.l8.m1.2.3.3.3.2.3.3.cmml"><mi id="alg1.l8.m1.2.3.3.3.2.3.3.2" xref="alg1.l8.m1.2.3.3.3.2.3.3.2.cmml">θ</mi><mi id="alg1.l8.m1.2.3.3.3.2.3.3.3" xref="alg1.l8.m1.2.3.3.3.2.3.3.3.cmml">i</mi></msub></msub></mrow><mo lspace="0em" rspace="0em" id="alg1.l8.m1.2.3.3.3.1" xref="alg1.l8.m1.2.3.3.3.1.cmml">​</mo><mi id="alg1.l8.m1.2.3.3.3.3" xref="alg1.l8.m1.2.3.3.3.3.cmml">L</mi><mo lspace="0em" rspace="0em" id="alg1.l8.m1.2.3.3.3.1a" xref="alg1.l8.m1.2.3.3.3.1.cmml">​</mo><mrow id="alg1.l8.m1.2.3.3.3.4.2" xref="alg1.l8.m1.2.3.3.3.4.1.cmml"><mo stretchy="false" id="alg1.l8.m1.2.3.3.3.4.2.1" xref="alg1.l8.m1.2.3.3.3.4.1.cmml">(</mo><mover accent="true" id="alg1.l8.m1.1.1" xref="alg1.l8.m1.1.1.cmml"><mi id="alg1.l8.m1.1.1.2" xref="alg1.l8.m1.1.1.2.cmml">y</mi><mo id="alg1.l8.m1.1.1.1" xref="alg1.l8.m1.1.1.1.cmml">^</mo></mover><mo id="alg1.l8.m1.2.3.3.3.4.2.2" xref="alg1.l8.m1.2.3.3.3.4.1.cmml">,</mo><mi id="alg1.l8.m1.2.2" xref="alg1.l8.m1.2.2.cmml">y</mi><mo stretchy="false" id="alg1.l8.m1.2.3.3.3.4.2.3" xref="alg1.l8.m1.2.3.3.3.4.1.cmml">)</mo></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l8.m1.2b"><apply id="alg1.l8.m1.2.3.cmml" xref="alg1.l8.m1.2.3"><ci id="alg1.l8.m1.2.3.1.cmml" xref="alg1.l8.m1.2.3.1">←</ci><apply id="alg1.l8.m1.2.3.2.cmml" xref="alg1.l8.m1.2.3.2"><csymbol cd="ambiguous" id="alg1.l8.m1.2.3.2.1.cmml" xref="alg1.l8.m1.2.3.2">subscript</csymbol><ci id="alg1.l8.m1.2.3.2.2.cmml" xref="alg1.l8.m1.2.3.2.2">𝜃</ci><ci id="alg1.l8.m1.2.3.2.3.cmml" xref="alg1.l8.m1.2.3.2.3">𝑖</ci></apply><apply id="alg1.l8.m1.2.3.3.cmml" xref="alg1.l8.m1.2.3.3"><minus id="alg1.l8.m1.2.3.3.1.cmml" xref="alg1.l8.m1.2.3.3.1"></minus><apply id="alg1.l8.m1.2.3.3.2.cmml" xref="alg1.l8.m1.2.3.3.2"><csymbol cd="ambiguous" id="alg1.l8.m1.2.3.3.2.1.cmml" xref="alg1.l8.m1.2.3.3.2">subscript</csymbol><ci id="alg1.l8.m1.2.3.3.2.2.cmml" xref="alg1.l8.m1.2.3.3.2.2">𝜃</ci><ci id="alg1.l8.m1.2.3.3.2.3.cmml" xref="alg1.l8.m1.2.3.3.2.3">𝑖</ci></apply><apply id="alg1.l8.m1.2.3.3.3.cmml" xref="alg1.l8.m1.2.3.3.3"><times id="alg1.l8.m1.2.3.3.3.1.cmml" xref="alg1.l8.m1.2.3.3.3.1"></times><apply id="alg1.l8.m1.2.3.3.3.2.cmml" xref="alg1.l8.m1.2.3.3.3.2"><ci id="alg1.l8.m1.2.3.3.3.2.1.cmml" xref="alg1.l8.m1.2.3.3.3.2.1">⋅</ci><ci id="alg1.l8.m1.2.3.3.3.2.2.cmml" xref="alg1.l8.m1.2.3.3.3.2.2">𝛼</ci><apply id="alg1.l8.m1.2.3.3.3.2.3.cmml" xref="alg1.l8.m1.2.3.3.3.2.3"><csymbol cd="ambiguous" id="alg1.l8.m1.2.3.3.3.2.3.1.cmml" xref="alg1.l8.m1.2.3.3.3.2.3">subscript</csymbol><ci id="alg1.l8.m1.2.3.3.3.2.3.2.cmml" xref="alg1.l8.m1.2.3.3.3.2.3.2">▽</ci><apply id="alg1.l8.m1.2.3.3.3.2.3.3.cmml" xref="alg1.l8.m1.2.3.3.3.2.3.3"><csymbol cd="ambiguous" id="alg1.l8.m1.2.3.3.3.2.3.3.1.cmml" xref="alg1.l8.m1.2.3.3.3.2.3.3">subscript</csymbol><ci id="alg1.l8.m1.2.3.3.3.2.3.3.2.cmml" xref="alg1.l8.m1.2.3.3.3.2.3.3.2">𝜃</ci><ci id="alg1.l8.m1.2.3.3.3.2.3.3.3.cmml" xref="alg1.l8.m1.2.3.3.3.2.3.3.3">𝑖</ci></apply></apply></apply><ci id="alg1.l8.m1.2.3.3.3.3.cmml" xref="alg1.l8.m1.2.3.3.3.3">𝐿</ci><interval closure="open" id="alg1.l8.m1.2.3.3.3.4.1.cmml" xref="alg1.l8.m1.2.3.3.3.4.2"><apply id="alg1.l8.m1.1.1.cmml" xref="alg1.l8.m1.1.1"><ci id="alg1.l8.m1.1.1.1.cmml" xref="alg1.l8.m1.1.1.1">^</ci><ci id="alg1.l8.m1.1.1.2.cmml" xref="alg1.l8.m1.1.1.2">𝑦</ci></apply><ci id="alg1.l8.m1.2.2.cmml" xref="alg1.l8.m1.2.2">𝑦</ci></interval></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l8.m1.2c">\theta_{i}\leftarrow\theta_{i}-\alpha\cdot\triangledown_{\theta_{i}}{L(\widehat{y},y)}</annotation></semantics></math> <span id="alg1.l8.2" class="ltx_text ltx_font_italic"># if using fine-tuning</span>

</div>
<div id="alg1.l9" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg1.l9.1.1.1" class="ltx_text" style="font-size:80%;">9:</span></span>     <span id="alg1.l9.2" class="ltx_text ltx_font_bold">end</span> <span id="alg1.l9.3" class="ltx_text ltx_font_bold">for</span>
</div>
<div id="alg1.l10" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg1.l10.1.1.1" class="ltx_text" style="font-size:80%;">10:</span></span>     <span id="alg1.l10.2" class="ltx_text ltx_font_italic"># Mixing two experts</span>

</div>
<div id="alg1.l11" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg1.l11.1.1.1" class="ltx_text" style="font-size:80%;">11:</span></span>     <span id="alg1.l11.2" class="ltx_text ltx_font_bold">for</span> batch <math id="alg1.l11.m1.2" class="ltx_Math" alttext="(x,y)\subset D_{i}^{gate}" display="inline"><semantics id="alg1.l11.m1.2a"><mrow id="alg1.l11.m1.2.3" xref="alg1.l11.m1.2.3.cmml"><mrow id="alg1.l11.m1.2.3.2.2" xref="alg1.l11.m1.2.3.2.1.cmml"><mo stretchy="false" id="alg1.l11.m1.2.3.2.2.1" xref="alg1.l11.m1.2.3.2.1.cmml">(</mo><mi id="alg1.l11.m1.1.1" xref="alg1.l11.m1.1.1.cmml">x</mi><mo id="alg1.l11.m1.2.3.2.2.2" xref="alg1.l11.m1.2.3.2.1.cmml">,</mo><mi id="alg1.l11.m1.2.2" xref="alg1.l11.m1.2.2.cmml">y</mi><mo stretchy="false" id="alg1.l11.m1.2.3.2.2.3" xref="alg1.l11.m1.2.3.2.1.cmml">)</mo></mrow><mo id="alg1.l11.m1.2.3.1" xref="alg1.l11.m1.2.3.1.cmml">⊂</mo><msubsup id="alg1.l11.m1.2.3.3" xref="alg1.l11.m1.2.3.3.cmml"><mi id="alg1.l11.m1.2.3.3.2.2" xref="alg1.l11.m1.2.3.3.2.2.cmml">D</mi><mi id="alg1.l11.m1.2.3.3.2.3" xref="alg1.l11.m1.2.3.3.2.3.cmml">i</mi><mrow id="alg1.l11.m1.2.3.3.3" xref="alg1.l11.m1.2.3.3.3.cmml"><mi id="alg1.l11.m1.2.3.3.3.2" xref="alg1.l11.m1.2.3.3.3.2.cmml">g</mi><mo lspace="0em" rspace="0em" id="alg1.l11.m1.2.3.3.3.1" xref="alg1.l11.m1.2.3.3.3.1.cmml">​</mo><mi id="alg1.l11.m1.2.3.3.3.3" xref="alg1.l11.m1.2.3.3.3.3.cmml">a</mi><mo lspace="0em" rspace="0em" id="alg1.l11.m1.2.3.3.3.1a" xref="alg1.l11.m1.2.3.3.3.1.cmml">​</mo><mi id="alg1.l11.m1.2.3.3.3.4" xref="alg1.l11.m1.2.3.3.3.4.cmml">t</mi><mo lspace="0em" rspace="0em" id="alg1.l11.m1.2.3.3.3.1b" xref="alg1.l11.m1.2.3.3.3.1.cmml">​</mo><mi id="alg1.l11.m1.2.3.3.3.5" xref="alg1.l11.m1.2.3.3.3.5.cmml">e</mi></mrow></msubsup></mrow><annotation-xml encoding="MathML-Content" id="alg1.l11.m1.2b"><apply id="alg1.l11.m1.2.3.cmml" xref="alg1.l11.m1.2.3"><subset id="alg1.l11.m1.2.3.1.cmml" xref="alg1.l11.m1.2.3.1"></subset><interval closure="open" id="alg1.l11.m1.2.3.2.1.cmml" xref="alg1.l11.m1.2.3.2.2"><ci id="alg1.l11.m1.1.1.cmml" xref="alg1.l11.m1.1.1">𝑥</ci><ci id="alg1.l11.m1.2.2.cmml" xref="alg1.l11.m1.2.2">𝑦</ci></interval><apply id="alg1.l11.m1.2.3.3.cmml" xref="alg1.l11.m1.2.3.3"><csymbol cd="ambiguous" id="alg1.l11.m1.2.3.3.1.cmml" xref="alg1.l11.m1.2.3.3">superscript</csymbol><apply id="alg1.l11.m1.2.3.3.2.cmml" xref="alg1.l11.m1.2.3.3"><csymbol cd="ambiguous" id="alg1.l11.m1.2.3.3.2.1.cmml" xref="alg1.l11.m1.2.3.3">subscript</csymbol><ci id="alg1.l11.m1.2.3.3.2.2.cmml" xref="alg1.l11.m1.2.3.3.2.2">𝐷</ci><ci id="alg1.l11.m1.2.3.3.2.3.cmml" xref="alg1.l11.m1.2.3.3.2.3">𝑖</ci></apply><apply id="alg1.l11.m1.2.3.3.3.cmml" xref="alg1.l11.m1.2.3.3.3"><times id="alg1.l11.m1.2.3.3.3.1.cmml" xref="alg1.l11.m1.2.3.3.3.1"></times><ci id="alg1.l11.m1.2.3.3.3.2.cmml" xref="alg1.l11.m1.2.3.3.3.2">𝑔</ci><ci id="alg1.l11.m1.2.3.3.3.3.cmml" xref="alg1.l11.m1.2.3.3.3.3">𝑎</ci><ci id="alg1.l11.m1.2.3.3.3.4.cmml" xref="alg1.l11.m1.2.3.3.3.4">𝑡</ci><ci id="alg1.l11.m1.2.3.3.3.5.cmml" xref="alg1.l11.m1.2.3.3.3.5">𝑒</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l11.m1.2c">(x,y)\subset D_{i}^{gate}</annotation></semantics></math> <span id="alg1.l11.3" class="ltx_text ltx_font_bold">do</span>



</div>
<div id="alg1.l12" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg1.l12.1.1.1" class="ltx_text" style="font-size:80%;">12:</span></span>        <math id="alg1.l12.m1.2" class="ltx_Math" alttext="g\leftarrow sigmoid(G(w_{i};x))" display="inline"><semantics id="alg1.l12.m1.2a"><mrow id="alg1.l12.m1.2.2" xref="alg1.l12.m1.2.2.cmml"><mi id="alg1.l12.m1.2.2.3" xref="alg1.l12.m1.2.2.3.cmml">g</mi><mo stretchy="false" id="alg1.l12.m1.2.2.2" xref="alg1.l12.m1.2.2.2.cmml">←</mo><mrow id="alg1.l12.m1.2.2.1" xref="alg1.l12.m1.2.2.1.cmml"><mi id="alg1.l12.m1.2.2.1.3" xref="alg1.l12.m1.2.2.1.3.cmml">s</mi><mo lspace="0em" rspace="0em" id="alg1.l12.m1.2.2.1.2" xref="alg1.l12.m1.2.2.1.2.cmml">​</mo><mi id="alg1.l12.m1.2.2.1.4" xref="alg1.l12.m1.2.2.1.4.cmml">i</mi><mo lspace="0em" rspace="0em" id="alg1.l12.m1.2.2.1.2a" xref="alg1.l12.m1.2.2.1.2.cmml">​</mo><mi id="alg1.l12.m1.2.2.1.5" xref="alg1.l12.m1.2.2.1.5.cmml">g</mi><mo lspace="0em" rspace="0em" id="alg1.l12.m1.2.2.1.2b" xref="alg1.l12.m1.2.2.1.2.cmml">​</mo><mi id="alg1.l12.m1.2.2.1.6" xref="alg1.l12.m1.2.2.1.6.cmml">m</mi><mo lspace="0em" rspace="0em" id="alg1.l12.m1.2.2.1.2c" xref="alg1.l12.m1.2.2.1.2.cmml">​</mo><mi id="alg1.l12.m1.2.2.1.7" xref="alg1.l12.m1.2.2.1.7.cmml">o</mi><mo lspace="0em" rspace="0em" id="alg1.l12.m1.2.2.1.2d" xref="alg1.l12.m1.2.2.1.2.cmml">​</mo><mi id="alg1.l12.m1.2.2.1.8" xref="alg1.l12.m1.2.2.1.8.cmml">i</mi><mo lspace="0em" rspace="0em" id="alg1.l12.m1.2.2.1.2e" xref="alg1.l12.m1.2.2.1.2.cmml">​</mo><mi id="alg1.l12.m1.2.2.1.9" xref="alg1.l12.m1.2.2.1.9.cmml">d</mi><mo lspace="0em" rspace="0em" id="alg1.l12.m1.2.2.1.2f" xref="alg1.l12.m1.2.2.1.2.cmml">​</mo><mrow id="alg1.l12.m1.2.2.1.1.1" xref="alg1.l12.m1.2.2.1.1.1.1.cmml"><mo stretchy="false" id="alg1.l12.m1.2.2.1.1.1.2" xref="alg1.l12.m1.2.2.1.1.1.1.cmml">(</mo><mrow id="alg1.l12.m1.2.2.1.1.1.1" xref="alg1.l12.m1.2.2.1.1.1.1.cmml"><mi id="alg1.l12.m1.2.2.1.1.1.1.3" xref="alg1.l12.m1.2.2.1.1.1.1.3.cmml">G</mi><mo lspace="0em" rspace="0em" id="alg1.l12.m1.2.2.1.1.1.1.2" xref="alg1.l12.m1.2.2.1.1.1.1.2.cmml">​</mo><mrow id="alg1.l12.m1.2.2.1.1.1.1.1.1" xref="alg1.l12.m1.2.2.1.1.1.1.1.2.cmml"><mo stretchy="false" id="alg1.l12.m1.2.2.1.1.1.1.1.1.2" xref="alg1.l12.m1.2.2.1.1.1.1.1.2.cmml">(</mo><msub id="alg1.l12.m1.2.2.1.1.1.1.1.1.1" xref="alg1.l12.m1.2.2.1.1.1.1.1.1.1.cmml"><mi id="alg1.l12.m1.2.2.1.1.1.1.1.1.1.2" xref="alg1.l12.m1.2.2.1.1.1.1.1.1.1.2.cmml">w</mi><mi id="alg1.l12.m1.2.2.1.1.1.1.1.1.1.3" xref="alg1.l12.m1.2.2.1.1.1.1.1.1.1.3.cmml">i</mi></msub><mo id="alg1.l12.m1.2.2.1.1.1.1.1.1.3" xref="alg1.l12.m1.2.2.1.1.1.1.1.2.cmml">;</mo><mi id="alg1.l12.m1.1.1" xref="alg1.l12.m1.1.1.cmml">x</mi><mo stretchy="false" id="alg1.l12.m1.2.2.1.1.1.1.1.1.4" xref="alg1.l12.m1.2.2.1.1.1.1.1.2.cmml">)</mo></mrow></mrow><mo stretchy="false" id="alg1.l12.m1.2.2.1.1.1.3" xref="alg1.l12.m1.2.2.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l12.m1.2b"><apply id="alg1.l12.m1.2.2.cmml" xref="alg1.l12.m1.2.2"><ci id="alg1.l12.m1.2.2.2.cmml" xref="alg1.l12.m1.2.2.2">←</ci><ci id="alg1.l12.m1.2.2.3.cmml" xref="alg1.l12.m1.2.2.3">𝑔</ci><apply id="alg1.l12.m1.2.2.1.cmml" xref="alg1.l12.m1.2.2.1"><times id="alg1.l12.m1.2.2.1.2.cmml" xref="alg1.l12.m1.2.2.1.2"></times><ci id="alg1.l12.m1.2.2.1.3.cmml" xref="alg1.l12.m1.2.2.1.3">𝑠</ci><ci id="alg1.l12.m1.2.2.1.4.cmml" xref="alg1.l12.m1.2.2.1.4">𝑖</ci><ci id="alg1.l12.m1.2.2.1.5.cmml" xref="alg1.l12.m1.2.2.1.5">𝑔</ci><ci id="alg1.l12.m1.2.2.1.6.cmml" xref="alg1.l12.m1.2.2.1.6">𝑚</ci><ci id="alg1.l12.m1.2.2.1.7.cmml" xref="alg1.l12.m1.2.2.1.7">𝑜</ci><ci id="alg1.l12.m1.2.2.1.8.cmml" xref="alg1.l12.m1.2.2.1.8">𝑖</ci><ci id="alg1.l12.m1.2.2.1.9.cmml" xref="alg1.l12.m1.2.2.1.9">𝑑</ci><apply id="alg1.l12.m1.2.2.1.1.1.1.cmml" xref="alg1.l12.m1.2.2.1.1.1"><times id="alg1.l12.m1.2.2.1.1.1.1.2.cmml" xref="alg1.l12.m1.2.2.1.1.1.1.2"></times><ci id="alg1.l12.m1.2.2.1.1.1.1.3.cmml" xref="alg1.l12.m1.2.2.1.1.1.1.3">𝐺</ci><list id="alg1.l12.m1.2.2.1.1.1.1.1.2.cmml" xref="alg1.l12.m1.2.2.1.1.1.1.1.1"><apply id="alg1.l12.m1.2.2.1.1.1.1.1.1.1.cmml" xref="alg1.l12.m1.2.2.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="alg1.l12.m1.2.2.1.1.1.1.1.1.1.1.cmml" xref="alg1.l12.m1.2.2.1.1.1.1.1.1.1">subscript</csymbol><ci id="alg1.l12.m1.2.2.1.1.1.1.1.1.1.2.cmml" xref="alg1.l12.m1.2.2.1.1.1.1.1.1.1.2">𝑤</ci><ci id="alg1.l12.m1.2.2.1.1.1.1.1.1.1.3.cmml" xref="alg1.l12.m1.2.2.1.1.1.1.1.1.1.3">𝑖</ci></apply><ci id="alg1.l12.m1.1.1.cmml" xref="alg1.l12.m1.1.1">𝑥</ci></list></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l12.m1.2c">g\leftarrow sigmoid(G(w_{i};x))</annotation></semantics></math>

</div>
<div id="alg1.l13" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg1.l13.1.1.1" class="ltx_text" style="font-size:80%;">13:</span></span>        <math id="alg1.l13.m1.5" class="ltx_Math" alttext="\tilde{y}\leftarrow g\cdot M_{G}(\theta;x)+(1-g)\cdot M_{G}(\theta_{i};x)" display="inline"><semantics id="alg1.l13.m1.5a"><mrow id="alg1.l13.m1.5.5" xref="alg1.l13.m1.5.5.cmml"><mover accent="true" id="alg1.l13.m1.5.5.4" xref="alg1.l13.m1.5.5.4.cmml"><mi id="alg1.l13.m1.5.5.4.2" xref="alg1.l13.m1.5.5.4.2.cmml">y</mi><mo id="alg1.l13.m1.5.5.4.1" xref="alg1.l13.m1.5.5.4.1.cmml">~</mo></mover><mo stretchy="false" id="alg1.l13.m1.5.5.3" xref="alg1.l13.m1.5.5.3.cmml">←</mo><mrow id="alg1.l13.m1.5.5.2" xref="alg1.l13.m1.5.5.2.cmml"><mrow id="alg1.l13.m1.5.5.2.4" xref="alg1.l13.m1.5.5.2.4.cmml"><mrow id="alg1.l13.m1.5.5.2.4.2" xref="alg1.l13.m1.5.5.2.4.2.cmml"><mi id="alg1.l13.m1.5.5.2.4.2.2" xref="alg1.l13.m1.5.5.2.4.2.2.cmml">g</mi><mo lspace="0.222em" rspace="0.222em" id="alg1.l13.m1.5.5.2.4.2.1" xref="alg1.l13.m1.5.5.2.4.2.1.cmml">⋅</mo><msub id="alg1.l13.m1.5.5.2.4.2.3" xref="alg1.l13.m1.5.5.2.4.2.3.cmml"><mi id="alg1.l13.m1.5.5.2.4.2.3.2" xref="alg1.l13.m1.5.5.2.4.2.3.2.cmml">M</mi><mi id="alg1.l13.m1.5.5.2.4.2.3.3" xref="alg1.l13.m1.5.5.2.4.2.3.3.cmml">G</mi></msub></mrow><mo lspace="0em" rspace="0em" id="alg1.l13.m1.5.5.2.4.1" xref="alg1.l13.m1.5.5.2.4.1.cmml">​</mo><mrow id="alg1.l13.m1.5.5.2.4.3.2" xref="alg1.l13.m1.5.5.2.4.3.1.cmml"><mo stretchy="false" id="alg1.l13.m1.5.5.2.4.3.2.1" xref="alg1.l13.m1.5.5.2.4.3.1.cmml">(</mo><mi id="alg1.l13.m1.1.1" xref="alg1.l13.m1.1.1.cmml">θ</mi><mo id="alg1.l13.m1.5.5.2.4.3.2.2" xref="alg1.l13.m1.5.5.2.4.3.1.cmml">;</mo><mi id="alg1.l13.m1.2.2" xref="alg1.l13.m1.2.2.cmml">x</mi><mo stretchy="false" id="alg1.l13.m1.5.5.2.4.3.2.3" xref="alg1.l13.m1.5.5.2.4.3.1.cmml">)</mo></mrow></mrow><mo id="alg1.l13.m1.5.5.2.3" xref="alg1.l13.m1.5.5.2.3.cmml">+</mo><mrow id="alg1.l13.m1.5.5.2.2" xref="alg1.l13.m1.5.5.2.2.cmml"><mrow id="alg1.l13.m1.4.4.1.1.1" xref="alg1.l13.m1.4.4.1.1.1.cmml"><mrow id="alg1.l13.m1.4.4.1.1.1.1.1" xref="alg1.l13.m1.4.4.1.1.1.1.1.1.cmml"><mo stretchy="false" id="alg1.l13.m1.4.4.1.1.1.1.1.2" xref="alg1.l13.m1.4.4.1.1.1.1.1.1.cmml">(</mo><mrow id="alg1.l13.m1.4.4.1.1.1.1.1.1" xref="alg1.l13.m1.4.4.1.1.1.1.1.1.cmml"><mn id="alg1.l13.m1.4.4.1.1.1.1.1.1.2" xref="alg1.l13.m1.4.4.1.1.1.1.1.1.2.cmml">1</mn><mo id="alg1.l13.m1.4.4.1.1.1.1.1.1.1" xref="alg1.l13.m1.4.4.1.1.1.1.1.1.1.cmml">−</mo><mi id="alg1.l13.m1.4.4.1.1.1.1.1.1.3" xref="alg1.l13.m1.4.4.1.1.1.1.1.1.3.cmml">g</mi></mrow><mo rspace="0.055em" stretchy="false" id="alg1.l13.m1.4.4.1.1.1.1.1.3" xref="alg1.l13.m1.4.4.1.1.1.1.1.1.cmml">)</mo></mrow><mo rspace="0.222em" id="alg1.l13.m1.4.4.1.1.1.2" xref="alg1.l13.m1.4.4.1.1.1.2.cmml">⋅</mo><msub id="alg1.l13.m1.4.4.1.1.1.3" xref="alg1.l13.m1.4.4.1.1.1.3.cmml"><mi id="alg1.l13.m1.4.4.1.1.1.3.2" xref="alg1.l13.m1.4.4.1.1.1.3.2.cmml">M</mi><mi id="alg1.l13.m1.4.4.1.1.1.3.3" xref="alg1.l13.m1.4.4.1.1.1.3.3.cmml">G</mi></msub></mrow><mo lspace="0em" rspace="0em" id="alg1.l13.m1.5.5.2.2.3" xref="alg1.l13.m1.5.5.2.2.3.cmml">​</mo><mrow id="alg1.l13.m1.5.5.2.2.2.1" xref="alg1.l13.m1.5.5.2.2.2.2.cmml"><mo stretchy="false" id="alg1.l13.m1.5.5.2.2.2.1.2" xref="alg1.l13.m1.5.5.2.2.2.2.cmml">(</mo><msub id="alg1.l13.m1.5.5.2.2.2.1.1" xref="alg1.l13.m1.5.5.2.2.2.1.1.cmml"><mi id="alg1.l13.m1.5.5.2.2.2.1.1.2" xref="alg1.l13.m1.5.5.2.2.2.1.1.2.cmml">θ</mi><mi id="alg1.l13.m1.5.5.2.2.2.1.1.3" xref="alg1.l13.m1.5.5.2.2.2.1.1.3.cmml">i</mi></msub><mo id="alg1.l13.m1.5.5.2.2.2.1.3" xref="alg1.l13.m1.5.5.2.2.2.2.cmml">;</mo><mi id="alg1.l13.m1.3.3" xref="alg1.l13.m1.3.3.cmml">x</mi><mo stretchy="false" id="alg1.l13.m1.5.5.2.2.2.1.4" xref="alg1.l13.m1.5.5.2.2.2.2.cmml">)</mo></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l13.m1.5b"><apply id="alg1.l13.m1.5.5.cmml" xref="alg1.l13.m1.5.5"><ci id="alg1.l13.m1.5.5.3.cmml" xref="alg1.l13.m1.5.5.3">←</ci><apply id="alg1.l13.m1.5.5.4.cmml" xref="alg1.l13.m1.5.5.4"><ci id="alg1.l13.m1.5.5.4.1.cmml" xref="alg1.l13.m1.5.5.4.1">~</ci><ci id="alg1.l13.m1.5.5.4.2.cmml" xref="alg1.l13.m1.5.5.4.2">𝑦</ci></apply><apply id="alg1.l13.m1.5.5.2.cmml" xref="alg1.l13.m1.5.5.2"><plus id="alg1.l13.m1.5.5.2.3.cmml" xref="alg1.l13.m1.5.5.2.3"></plus><apply id="alg1.l13.m1.5.5.2.4.cmml" xref="alg1.l13.m1.5.5.2.4"><times id="alg1.l13.m1.5.5.2.4.1.cmml" xref="alg1.l13.m1.5.5.2.4.1"></times><apply id="alg1.l13.m1.5.5.2.4.2.cmml" xref="alg1.l13.m1.5.5.2.4.2"><ci id="alg1.l13.m1.5.5.2.4.2.1.cmml" xref="alg1.l13.m1.5.5.2.4.2.1">⋅</ci><ci id="alg1.l13.m1.5.5.2.4.2.2.cmml" xref="alg1.l13.m1.5.5.2.4.2.2">𝑔</ci><apply id="alg1.l13.m1.5.5.2.4.2.3.cmml" xref="alg1.l13.m1.5.5.2.4.2.3"><csymbol cd="ambiguous" id="alg1.l13.m1.5.5.2.4.2.3.1.cmml" xref="alg1.l13.m1.5.5.2.4.2.3">subscript</csymbol><ci id="alg1.l13.m1.5.5.2.4.2.3.2.cmml" xref="alg1.l13.m1.5.5.2.4.2.3.2">𝑀</ci><ci id="alg1.l13.m1.5.5.2.4.2.3.3.cmml" xref="alg1.l13.m1.5.5.2.4.2.3.3">𝐺</ci></apply></apply><list id="alg1.l13.m1.5.5.2.4.3.1.cmml" xref="alg1.l13.m1.5.5.2.4.3.2"><ci id="alg1.l13.m1.1.1.cmml" xref="alg1.l13.m1.1.1">𝜃</ci><ci id="alg1.l13.m1.2.2.cmml" xref="alg1.l13.m1.2.2">𝑥</ci></list></apply><apply id="alg1.l13.m1.5.5.2.2.cmml" xref="alg1.l13.m1.5.5.2.2"><times id="alg1.l13.m1.5.5.2.2.3.cmml" xref="alg1.l13.m1.5.5.2.2.3"></times><apply id="alg1.l13.m1.4.4.1.1.1.cmml" xref="alg1.l13.m1.4.4.1.1.1"><ci id="alg1.l13.m1.4.4.1.1.1.2.cmml" xref="alg1.l13.m1.4.4.1.1.1.2">⋅</ci><apply id="alg1.l13.m1.4.4.1.1.1.1.1.1.cmml" xref="alg1.l13.m1.4.4.1.1.1.1.1"><minus id="alg1.l13.m1.4.4.1.1.1.1.1.1.1.cmml" xref="alg1.l13.m1.4.4.1.1.1.1.1.1.1"></minus><cn type="integer" id="alg1.l13.m1.4.4.1.1.1.1.1.1.2.cmml" xref="alg1.l13.m1.4.4.1.1.1.1.1.1.2">1</cn><ci id="alg1.l13.m1.4.4.1.1.1.1.1.1.3.cmml" xref="alg1.l13.m1.4.4.1.1.1.1.1.1.3">𝑔</ci></apply><apply id="alg1.l13.m1.4.4.1.1.1.3.cmml" xref="alg1.l13.m1.4.4.1.1.1.3"><csymbol cd="ambiguous" id="alg1.l13.m1.4.4.1.1.1.3.1.cmml" xref="alg1.l13.m1.4.4.1.1.1.3">subscript</csymbol><ci id="alg1.l13.m1.4.4.1.1.1.3.2.cmml" xref="alg1.l13.m1.4.4.1.1.1.3.2">𝑀</ci><ci id="alg1.l13.m1.4.4.1.1.1.3.3.cmml" xref="alg1.l13.m1.4.4.1.1.1.3.3">𝐺</ci></apply></apply><list id="alg1.l13.m1.5.5.2.2.2.2.cmml" xref="alg1.l13.m1.5.5.2.2.2.1"><apply id="alg1.l13.m1.5.5.2.2.2.1.1.cmml" xref="alg1.l13.m1.5.5.2.2.2.1.1"><csymbol cd="ambiguous" id="alg1.l13.m1.5.5.2.2.2.1.1.1.cmml" xref="alg1.l13.m1.5.5.2.2.2.1.1">subscript</csymbol><ci id="alg1.l13.m1.5.5.2.2.2.1.1.2.cmml" xref="alg1.l13.m1.5.5.2.2.2.1.1.2">𝜃</ci><ci id="alg1.l13.m1.5.5.2.2.2.1.1.3.cmml" xref="alg1.l13.m1.5.5.2.2.2.1.1.3">𝑖</ci></apply><ci id="alg1.l13.m1.3.3.cmml" xref="alg1.l13.m1.3.3">𝑥</ci></list></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l13.m1.5c">\tilde{y}\leftarrow g\cdot M_{G}(\theta;x)+(1-g)\cdot M_{G}(\theta_{i};x)</annotation></semantics></math>

</div>
<div id="alg1.l14" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg1.l14.1.1.1" class="ltx_text" style="font-size:80%;">14:</span></span>        <math id="alg1.l14.m1.2" class="ltx_Math" alttext="w_{i}\leftarrow w_{i}-\beta\cdot\triangledown_{w_{i}}{L(\tilde{y},y)}" display="inline"><semantics id="alg1.l14.m1.2a"><mrow id="alg1.l14.m1.2.3" xref="alg1.l14.m1.2.3.cmml"><msub id="alg1.l14.m1.2.3.2" xref="alg1.l14.m1.2.3.2.cmml"><mi id="alg1.l14.m1.2.3.2.2" xref="alg1.l14.m1.2.3.2.2.cmml">w</mi><mi id="alg1.l14.m1.2.3.2.3" xref="alg1.l14.m1.2.3.2.3.cmml">i</mi></msub><mo stretchy="false" id="alg1.l14.m1.2.3.1" xref="alg1.l14.m1.2.3.1.cmml">←</mo><mrow id="alg1.l14.m1.2.3.3" xref="alg1.l14.m1.2.3.3.cmml"><msub id="alg1.l14.m1.2.3.3.2" xref="alg1.l14.m1.2.3.3.2.cmml"><mi id="alg1.l14.m1.2.3.3.2.2" xref="alg1.l14.m1.2.3.3.2.2.cmml">w</mi><mi id="alg1.l14.m1.2.3.3.2.3" xref="alg1.l14.m1.2.3.3.2.3.cmml">i</mi></msub><mo id="alg1.l14.m1.2.3.3.1" xref="alg1.l14.m1.2.3.3.1.cmml">−</mo><mrow id="alg1.l14.m1.2.3.3.3" xref="alg1.l14.m1.2.3.3.3.cmml"><mrow id="alg1.l14.m1.2.3.3.3.2" xref="alg1.l14.m1.2.3.3.3.2.cmml"><mi id="alg1.l14.m1.2.3.3.3.2.2" xref="alg1.l14.m1.2.3.3.3.2.2.cmml">β</mi><mo lspace="0.222em" rspace="0.222em" id="alg1.l14.m1.2.3.3.3.2.1" xref="alg1.l14.m1.2.3.3.3.2.1.cmml">⋅</mo><msub id="alg1.l14.m1.2.3.3.3.2.3" xref="alg1.l14.m1.2.3.3.3.2.3.cmml"><mi mathvariant="normal" id="alg1.l14.m1.2.3.3.3.2.3.2" xref="alg1.l14.m1.2.3.3.3.2.3.2.cmml">▽</mi><msub id="alg1.l14.m1.2.3.3.3.2.3.3" xref="alg1.l14.m1.2.3.3.3.2.3.3.cmml"><mi id="alg1.l14.m1.2.3.3.3.2.3.3.2" xref="alg1.l14.m1.2.3.3.3.2.3.3.2.cmml">w</mi><mi id="alg1.l14.m1.2.3.3.3.2.3.3.3" xref="alg1.l14.m1.2.3.3.3.2.3.3.3.cmml">i</mi></msub></msub></mrow><mo lspace="0em" rspace="0em" id="alg1.l14.m1.2.3.3.3.1" xref="alg1.l14.m1.2.3.3.3.1.cmml">​</mo><mi id="alg1.l14.m1.2.3.3.3.3" xref="alg1.l14.m1.2.3.3.3.3.cmml">L</mi><mo lspace="0em" rspace="0em" id="alg1.l14.m1.2.3.3.3.1a" xref="alg1.l14.m1.2.3.3.3.1.cmml">​</mo><mrow id="alg1.l14.m1.2.3.3.3.4.2" xref="alg1.l14.m1.2.3.3.3.4.1.cmml"><mo stretchy="false" id="alg1.l14.m1.2.3.3.3.4.2.1" xref="alg1.l14.m1.2.3.3.3.4.1.cmml">(</mo><mover accent="true" id="alg1.l14.m1.1.1" xref="alg1.l14.m1.1.1.cmml"><mi id="alg1.l14.m1.1.1.2" xref="alg1.l14.m1.1.1.2.cmml">y</mi><mo id="alg1.l14.m1.1.1.1" xref="alg1.l14.m1.1.1.1.cmml">~</mo></mover><mo id="alg1.l14.m1.2.3.3.3.4.2.2" xref="alg1.l14.m1.2.3.3.3.4.1.cmml">,</mo><mi id="alg1.l14.m1.2.2" xref="alg1.l14.m1.2.2.cmml">y</mi><mo stretchy="false" id="alg1.l14.m1.2.3.3.3.4.2.3" xref="alg1.l14.m1.2.3.3.3.4.1.cmml">)</mo></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l14.m1.2b"><apply id="alg1.l14.m1.2.3.cmml" xref="alg1.l14.m1.2.3"><ci id="alg1.l14.m1.2.3.1.cmml" xref="alg1.l14.m1.2.3.1">←</ci><apply id="alg1.l14.m1.2.3.2.cmml" xref="alg1.l14.m1.2.3.2"><csymbol cd="ambiguous" id="alg1.l14.m1.2.3.2.1.cmml" xref="alg1.l14.m1.2.3.2">subscript</csymbol><ci id="alg1.l14.m1.2.3.2.2.cmml" xref="alg1.l14.m1.2.3.2.2">𝑤</ci><ci id="alg1.l14.m1.2.3.2.3.cmml" xref="alg1.l14.m1.2.3.2.3">𝑖</ci></apply><apply id="alg1.l14.m1.2.3.3.cmml" xref="alg1.l14.m1.2.3.3"><minus id="alg1.l14.m1.2.3.3.1.cmml" xref="alg1.l14.m1.2.3.3.1"></minus><apply id="alg1.l14.m1.2.3.3.2.cmml" xref="alg1.l14.m1.2.3.3.2"><csymbol cd="ambiguous" id="alg1.l14.m1.2.3.3.2.1.cmml" xref="alg1.l14.m1.2.3.3.2">subscript</csymbol><ci id="alg1.l14.m1.2.3.3.2.2.cmml" xref="alg1.l14.m1.2.3.3.2.2">𝑤</ci><ci id="alg1.l14.m1.2.3.3.2.3.cmml" xref="alg1.l14.m1.2.3.3.2.3">𝑖</ci></apply><apply id="alg1.l14.m1.2.3.3.3.cmml" xref="alg1.l14.m1.2.3.3.3"><times id="alg1.l14.m1.2.3.3.3.1.cmml" xref="alg1.l14.m1.2.3.3.3.1"></times><apply id="alg1.l14.m1.2.3.3.3.2.cmml" xref="alg1.l14.m1.2.3.3.3.2"><ci id="alg1.l14.m1.2.3.3.3.2.1.cmml" xref="alg1.l14.m1.2.3.3.3.2.1">⋅</ci><ci id="alg1.l14.m1.2.3.3.3.2.2.cmml" xref="alg1.l14.m1.2.3.3.3.2.2">𝛽</ci><apply id="alg1.l14.m1.2.3.3.3.2.3.cmml" xref="alg1.l14.m1.2.3.3.3.2.3"><csymbol cd="ambiguous" id="alg1.l14.m1.2.3.3.3.2.3.1.cmml" xref="alg1.l14.m1.2.3.3.3.2.3">subscript</csymbol><ci id="alg1.l14.m1.2.3.3.3.2.3.2.cmml" xref="alg1.l14.m1.2.3.3.3.2.3.2">▽</ci><apply id="alg1.l14.m1.2.3.3.3.2.3.3.cmml" xref="alg1.l14.m1.2.3.3.3.2.3.3"><csymbol cd="ambiguous" id="alg1.l14.m1.2.3.3.3.2.3.3.1.cmml" xref="alg1.l14.m1.2.3.3.3.2.3.3">subscript</csymbol><ci id="alg1.l14.m1.2.3.3.3.2.3.3.2.cmml" xref="alg1.l14.m1.2.3.3.3.2.3.3.2">𝑤</ci><ci id="alg1.l14.m1.2.3.3.3.2.3.3.3.cmml" xref="alg1.l14.m1.2.3.3.3.2.3.3.3">𝑖</ci></apply></apply></apply><ci id="alg1.l14.m1.2.3.3.3.3.cmml" xref="alg1.l14.m1.2.3.3.3.3">𝐿</ci><interval closure="open" id="alg1.l14.m1.2.3.3.3.4.1.cmml" xref="alg1.l14.m1.2.3.3.3.4.2"><apply id="alg1.l14.m1.1.1.cmml" xref="alg1.l14.m1.1.1"><ci id="alg1.l14.m1.1.1.1.cmml" xref="alg1.l14.m1.1.1.1">~</ci><ci id="alg1.l14.m1.1.1.2.cmml" xref="alg1.l14.m1.1.1.2">𝑦</ci></apply><ci id="alg1.l14.m1.2.2.cmml" xref="alg1.l14.m1.2.2">𝑦</ci></interval></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l14.m1.2c">w_{i}\leftarrow w_{i}-\beta\cdot\triangledown_{w_{i}}{L(\tilde{y},y)}</annotation></semantics></math>

</div>
<div id="alg1.l15" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg1.l15.1.1.1" class="ltx_text" style="font-size:80%;">15:</span></span>     <span id="alg1.l15.2" class="ltx_text ltx_font_bold">end</span> <span id="alg1.l15.3" class="ltx_text ltx_font_bold">for</span>
</div>
<div id="alg1.l16" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg1.l16.1.1.1" class="ltx_text" style="font-size:80%;">16:</span></span>  <span id="alg1.l16.2" class="ltx_text ltx_font_bold">end</span> <span id="alg1.l16.3" class="ltx_text ltx_font_bold">for</span>
</div>
</div>
</figure>
<div id="S3.SS3.p2" class="ltx_para">
<p id="S3.SS3.p2.7" class="ltx_p">More formally, in MoE architecture, the mxied output <math id="S3.SS3.p2.1.m1.2" class="ltx_Math" alttext="\tilde{y}=\sum_{i=1}^{n}G(x)_{i}\cdot M_{i}(x)" display="inline"><semantics id="S3.SS3.p2.1.m1.2a"><mrow id="S3.SS3.p2.1.m1.2.3" xref="S3.SS3.p2.1.m1.2.3.cmml"><mover accent="true" id="S3.SS3.p2.1.m1.2.3.2" xref="S3.SS3.p2.1.m1.2.3.2.cmml"><mi id="S3.SS3.p2.1.m1.2.3.2.2" xref="S3.SS3.p2.1.m1.2.3.2.2.cmml">y</mi><mo id="S3.SS3.p2.1.m1.2.3.2.1" xref="S3.SS3.p2.1.m1.2.3.2.1.cmml">~</mo></mover><mo rspace="0.111em" id="S3.SS3.p2.1.m1.2.3.1" xref="S3.SS3.p2.1.m1.2.3.1.cmml">=</mo><mrow id="S3.SS3.p2.1.m1.2.3.3" xref="S3.SS3.p2.1.m1.2.3.3.cmml"><msubsup id="S3.SS3.p2.1.m1.2.3.3.1" xref="S3.SS3.p2.1.m1.2.3.3.1.cmml"><mo id="S3.SS3.p2.1.m1.2.3.3.1.2.2" xref="S3.SS3.p2.1.m1.2.3.3.1.2.2.cmml">∑</mo><mrow id="S3.SS3.p2.1.m1.2.3.3.1.2.3" xref="S3.SS3.p2.1.m1.2.3.3.1.2.3.cmml"><mi id="S3.SS3.p2.1.m1.2.3.3.1.2.3.2" xref="S3.SS3.p2.1.m1.2.3.3.1.2.3.2.cmml">i</mi><mo id="S3.SS3.p2.1.m1.2.3.3.1.2.3.1" xref="S3.SS3.p2.1.m1.2.3.3.1.2.3.1.cmml">=</mo><mn id="S3.SS3.p2.1.m1.2.3.3.1.2.3.3" xref="S3.SS3.p2.1.m1.2.3.3.1.2.3.3.cmml">1</mn></mrow><mi id="S3.SS3.p2.1.m1.2.3.3.1.3" xref="S3.SS3.p2.1.m1.2.3.3.1.3.cmml">n</mi></msubsup><mrow id="S3.SS3.p2.1.m1.2.3.3.2" xref="S3.SS3.p2.1.m1.2.3.3.2.cmml"><mrow id="S3.SS3.p2.1.m1.2.3.3.2.2" xref="S3.SS3.p2.1.m1.2.3.3.2.2.cmml"><mrow id="S3.SS3.p2.1.m1.2.3.3.2.2.2" xref="S3.SS3.p2.1.m1.2.3.3.2.2.2.cmml"><mi id="S3.SS3.p2.1.m1.2.3.3.2.2.2.2" xref="S3.SS3.p2.1.m1.2.3.3.2.2.2.2.cmml">G</mi><mo lspace="0em" rspace="0em" id="S3.SS3.p2.1.m1.2.3.3.2.2.2.1" xref="S3.SS3.p2.1.m1.2.3.3.2.2.2.1.cmml">​</mo><msub id="S3.SS3.p2.1.m1.2.3.3.2.2.2.3" xref="S3.SS3.p2.1.m1.2.3.3.2.2.2.3.cmml"><mrow id="S3.SS3.p2.1.m1.2.3.3.2.2.2.3.2.2" xref="S3.SS3.p2.1.m1.2.3.3.2.2.2.3.cmml"><mo stretchy="false" id="S3.SS3.p2.1.m1.2.3.3.2.2.2.3.2.2.1" xref="S3.SS3.p2.1.m1.2.3.3.2.2.2.3.cmml">(</mo><mi id="S3.SS3.p2.1.m1.1.1" xref="S3.SS3.p2.1.m1.1.1.cmml">x</mi><mo rspace="0.055em" stretchy="false" id="S3.SS3.p2.1.m1.2.3.3.2.2.2.3.2.2.2" xref="S3.SS3.p2.1.m1.2.3.3.2.2.2.3.cmml">)</mo></mrow><mi id="S3.SS3.p2.1.m1.2.3.3.2.2.2.3.3" xref="S3.SS3.p2.1.m1.2.3.3.2.2.2.3.3.cmml">i</mi></msub></mrow><mo rspace="0.222em" id="S3.SS3.p2.1.m1.2.3.3.2.2.1" xref="S3.SS3.p2.1.m1.2.3.3.2.2.1.cmml">⋅</mo><msub id="S3.SS3.p2.1.m1.2.3.3.2.2.3" xref="S3.SS3.p2.1.m1.2.3.3.2.2.3.cmml"><mi id="S3.SS3.p2.1.m1.2.3.3.2.2.3.2" xref="S3.SS3.p2.1.m1.2.3.3.2.2.3.2.cmml">M</mi><mi id="S3.SS3.p2.1.m1.2.3.3.2.2.3.3" xref="S3.SS3.p2.1.m1.2.3.3.2.2.3.3.cmml">i</mi></msub></mrow><mo lspace="0em" rspace="0em" id="S3.SS3.p2.1.m1.2.3.3.2.1" xref="S3.SS3.p2.1.m1.2.3.3.2.1.cmml">​</mo><mrow id="S3.SS3.p2.1.m1.2.3.3.2.3.2" xref="S3.SS3.p2.1.m1.2.3.3.2.cmml"><mo stretchy="false" id="S3.SS3.p2.1.m1.2.3.3.2.3.2.1" xref="S3.SS3.p2.1.m1.2.3.3.2.cmml">(</mo><mi id="S3.SS3.p2.1.m1.2.2" xref="S3.SS3.p2.1.m1.2.2.cmml">x</mi><mo stretchy="false" id="S3.SS3.p2.1.m1.2.3.3.2.3.2.2" xref="S3.SS3.p2.1.m1.2.3.3.2.cmml">)</mo></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.p2.1.m1.2b"><apply id="S3.SS3.p2.1.m1.2.3.cmml" xref="S3.SS3.p2.1.m1.2.3"><eq id="S3.SS3.p2.1.m1.2.3.1.cmml" xref="S3.SS3.p2.1.m1.2.3.1"></eq><apply id="S3.SS3.p2.1.m1.2.3.2.cmml" xref="S3.SS3.p2.1.m1.2.3.2"><ci id="S3.SS3.p2.1.m1.2.3.2.1.cmml" xref="S3.SS3.p2.1.m1.2.3.2.1">~</ci><ci id="S3.SS3.p2.1.m1.2.3.2.2.cmml" xref="S3.SS3.p2.1.m1.2.3.2.2">𝑦</ci></apply><apply id="S3.SS3.p2.1.m1.2.3.3.cmml" xref="S3.SS3.p2.1.m1.2.3.3"><apply id="S3.SS3.p2.1.m1.2.3.3.1.cmml" xref="S3.SS3.p2.1.m1.2.3.3.1"><csymbol cd="ambiguous" id="S3.SS3.p2.1.m1.2.3.3.1.1.cmml" xref="S3.SS3.p2.1.m1.2.3.3.1">superscript</csymbol><apply id="S3.SS3.p2.1.m1.2.3.3.1.2.cmml" xref="S3.SS3.p2.1.m1.2.3.3.1"><csymbol cd="ambiguous" id="S3.SS3.p2.1.m1.2.3.3.1.2.1.cmml" xref="S3.SS3.p2.1.m1.2.3.3.1">subscript</csymbol><sum id="S3.SS3.p2.1.m1.2.3.3.1.2.2.cmml" xref="S3.SS3.p2.1.m1.2.3.3.1.2.2"></sum><apply id="S3.SS3.p2.1.m1.2.3.3.1.2.3.cmml" xref="S3.SS3.p2.1.m1.2.3.3.1.2.3"><eq id="S3.SS3.p2.1.m1.2.3.3.1.2.3.1.cmml" xref="S3.SS3.p2.1.m1.2.3.3.1.2.3.1"></eq><ci id="S3.SS3.p2.1.m1.2.3.3.1.2.3.2.cmml" xref="S3.SS3.p2.1.m1.2.3.3.1.2.3.2">𝑖</ci><cn type="integer" id="S3.SS3.p2.1.m1.2.3.3.1.2.3.3.cmml" xref="S3.SS3.p2.1.m1.2.3.3.1.2.3.3">1</cn></apply></apply><ci id="S3.SS3.p2.1.m1.2.3.3.1.3.cmml" xref="S3.SS3.p2.1.m1.2.3.3.1.3">𝑛</ci></apply><apply id="S3.SS3.p2.1.m1.2.3.3.2.cmml" xref="S3.SS3.p2.1.m1.2.3.3.2"><times id="S3.SS3.p2.1.m1.2.3.3.2.1.cmml" xref="S3.SS3.p2.1.m1.2.3.3.2.1"></times><apply id="S3.SS3.p2.1.m1.2.3.3.2.2.cmml" xref="S3.SS3.p2.1.m1.2.3.3.2.2"><ci id="S3.SS3.p2.1.m1.2.3.3.2.2.1.cmml" xref="S3.SS3.p2.1.m1.2.3.3.2.2.1">⋅</ci><apply id="S3.SS3.p2.1.m1.2.3.3.2.2.2.cmml" xref="S3.SS3.p2.1.m1.2.3.3.2.2.2"><times id="S3.SS3.p2.1.m1.2.3.3.2.2.2.1.cmml" xref="S3.SS3.p2.1.m1.2.3.3.2.2.2.1"></times><ci id="S3.SS3.p2.1.m1.2.3.3.2.2.2.2.cmml" xref="S3.SS3.p2.1.m1.2.3.3.2.2.2.2">𝐺</ci><apply id="S3.SS3.p2.1.m1.2.3.3.2.2.2.3.cmml" xref="S3.SS3.p2.1.m1.2.3.3.2.2.2.3"><csymbol cd="ambiguous" id="S3.SS3.p2.1.m1.2.3.3.2.2.2.3.1.cmml" xref="S3.SS3.p2.1.m1.2.3.3.2.2.2.3">subscript</csymbol><ci id="S3.SS3.p2.1.m1.1.1.cmml" xref="S3.SS3.p2.1.m1.1.1">𝑥</ci><ci id="S3.SS3.p2.1.m1.2.3.3.2.2.2.3.3.cmml" xref="S3.SS3.p2.1.m1.2.3.3.2.2.2.3.3">𝑖</ci></apply></apply><apply id="S3.SS3.p2.1.m1.2.3.3.2.2.3.cmml" xref="S3.SS3.p2.1.m1.2.3.3.2.2.3"><csymbol cd="ambiguous" id="S3.SS3.p2.1.m1.2.3.3.2.2.3.1.cmml" xref="S3.SS3.p2.1.m1.2.3.3.2.2.3">subscript</csymbol><ci id="S3.SS3.p2.1.m1.2.3.3.2.2.3.2.cmml" xref="S3.SS3.p2.1.m1.2.3.3.2.2.3.2">𝑀</ci><ci id="S3.SS3.p2.1.m1.2.3.3.2.2.3.3.cmml" xref="S3.SS3.p2.1.m1.2.3.3.2.2.3.3">𝑖</ci></apply></apply><ci id="S3.SS3.p2.1.m1.2.2.cmml" xref="S3.SS3.p2.1.m1.2.2">𝑥</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p2.1.m1.2c">\tilde{y}=\sum_{i=1}^{n}G(x)_{i}\cdot M_{i}(x)</annotation></semantics></math>, where <math id="S3.SS3.p2.2.m2.1" class="ltx_Math" alttext="\sum_{i=1}^{n}G(x)_{i}=1" display="inline"><semantics id="S3.SS3.p2.2.m2.1a"><mrow id="S3.SS3.p2.2.m2.1.2" xref="S3.SS3.p2.2.m2.1.2.cmml"><mrow id="S3.SS3.p2.2.m2.1.2.2" xref="S3.SS3.p2.2.m2.1.2.2.cmml"><msubsup id="S3.SS3.p2.2.m2.1.2.2.1" xref="S3.SS3.p2.2.m2.1.2.2.1.cmml"><mo id="S3.SS3.p2.2.m2.1.2.2.1.2.2" xref="S3.SS3.p2.2.m2.1.2.2.1.2.2.cmml">∑</mo><mrow id="S3.SS3.p2.2.m2.1.2.2.1.2.3" xref="S3.SS3.p2.2.m2.1.2.2.1.2.3.cmml"><mi id="S3.SS3.p2.2.m2.1.2.2.1.2.3.2" xref="S3.SS3.p2.2.m2.1.2.2.1.2.3.2.cmml">i</mi><mo id="S3.SS3.p2.2.m2.1.2.2.1.2.3.1" xref="S3.SS3.p2.2.m2.1.2.2.1.2.3.1.cmml">=</mo><mn id="S3.SS3.p2.2.m2.1.2.2.1.2.3.3" xref="S3.SS3.p2.2.m2.1.2.2.1.2.3.3.cmml">1</mn></mrow><mi id="S3.SS3.p2.2.m2.1.2.2.1.3" xref="S3.SS3.p2.2.m2.1.2.2.1.3.cmml">n</mi></msubsup><mrow id="S3.SS3.p2.2.m2.1.2.2.2" xref="S3.SS3.p2.2.m2.1.2.2.2.cmml"><mi id="S3.SS3.p2.2.m2.1.2.2.2.2" xref="S3.SS3.p2.2.m2.1.2.2.2.2.cmml">G</mi><mo lspace="0em" rspace="0em" id="S3.SS3.p2.2.m2.1.2.2.2.1" xref="S3.SS3.p2.2.m2.1.2.2.2.1.cmml">​</mo><msub id="S3.SS3.p2.2.m2.1.2.2.2.3" xref="S3.SS3.p2.2.m2.1.2.2.2.3.cmml"><mrow id="S3.SS3.p2.2.m2.1.2.2.2.3.2.2" xref="S3.SS3.p2.2.m2.1.2.2.2.3.cmml"><mo stretchy="false" id="S3.SS3.p2.2.m2.1.2.2.2.3.2.2.1" xref="S3.SS3.p2.2.m2.1.2.2.2.3.cmml">(</mo><mi id="S3.SS3.p2.2.m2.1.1" xref="S3.SS3.p2.2.m2.1.1.cmml">x</mi><mo stretchy="false" id="S3.SS3.p2.2.m2.1.2.2.2.3.2.2.2" xref="S3.SS3.p2.2.m2.1.2.2.2.3.cmml">)</mo></mrow><mi id="S3.SS3.p2.2.m2.1.2.2.2.3.3" xref="S3.SS3.p2.2.m2.1.2.2.2.3.3.cmml">i</mi></msub></mrow></mrow><mo id="S3.SS3.p2.2.m2.1.2.1" xref="S3.SS3.p2.2.m2.1.2.1.cmml">=</mo><mn id="S3.SS3.p2.2.m2.1.2.3" xref="S3.SS3.p2.2.m2.1.2.3.cmml">1</mn></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.p2.2.m2.1b"><apply id="S3.SS3.p2.2.m2.1.2.cmml" xref="S3.SS3.p2.2.m2.1.2"><eq id="S3.SS3.p2.2.m2.1.2.1.cmml" xref="S3.SS3.p2.2.m2.1.2.1"></eq><apply id="S3.SS3.p2.2.m2.1.2.2.cmml" xref="S3.SS3.p2.2.m2.1.2.2"><apply id="S3.SS3.p2.2.m2.1.2.2.1.cmml" xref="S3.SS3.p2.2.m2.1.2.2.1"><csymbol cd="ambiguous" id="S3.SS3.p2.2.m2.1.2.2.1.1.cmml" xref="S3.SS3.p2.2.m2.1.2.2.1">superscript</csymbol><apply id="S3.SS3.p2.2.m2.1.2.2.1.2.cmml" xref="S3.SS3.p2.2.m2.1.2.2.1"><csymbol cd="ambiguous" id="S3.SS3.p2.2.m2.1.2.2.1.2.1.cmml" xref="S3.SS3.p2.2.m2.1.2.2.1">subscript</csymbol><sum id="S3.SS3.p2.2.m2.1.2.2.1.2.2.cmml" xref="S3.SS3.p2.2.m2.1.2.2.1.2.2"></sum><apply id="S3.SS3.p2.2.m2.1.2.2.1.2.3.cmml" xref="S3.SS3.p2.2.m2.1.2.2.1.2.3"><eq id="S3.SS3.p2.2.m2.1.2.2.1.2.3.1.cmml" xref="S3.SS3.p2.2.m2.1.2.2.1.2.3.1"></eq><ci id="S3.SS3.p2.2.m2.1.2.2.1.2.3.2.cmml" xref="S3.SS3.p2.2.m2.1.2.2.1.2.3.2">𝑖</ci><cn type="integer" id="S3.SS3.p2.2.m2.1.2.2.1.2.3.3.cmml" xref="S3.SS3.p2.2.m2.1.2.2.1.2.3.3">1</cn></apply></apply><ci id="S3.SS3.p2.2.m2.1.2.2.1.3.cmml" xref="S3.SS3.p2.2.m2.1.2.2.1.3">𝑛</ci></apply><apply id="S3.SS3.p2.2.m2.1.2.2.2.cmml" xref="S3.SS3.p2.2.m2.1.2.2.2"><times id="S3.SS3.p2.2.m2.1.2.2.2.1.cmml" xref="S3.SS3.p2.2.m2.1.2.2.2.1"></times><ci id="S3.SS3.p2.2.m2.1.2.2.2.2.cmml" xref="S3.SS3.p2.2.m2.1.2.2.2.2">𝐺</ci><apply id="S3.SS3.p2.2.m2.1.2.2.2.3.cmml" xref="S3.SS3.p2.2.m2.1.2.2.2.3"><csymbol cd="ambiguous" id="S3.SS3.p2.2.m2.1.2.2.2.3.1.cmml" xref="S3.SS3.p2.2.m2.1.2.2.2.3">subscript</csymbol><ci id="S3.SS3.p2.2.m2.1.1.cmml" xref="S3.SS3.p2.2.m2.1.1">𝑥</ci><ci id="S3.SS3.p2.2.m2.1.2.2.2.3.3.cmml" xref="S3.SS3.p2.2.m2.1.2.2.2.3.3">𝑖</ci></apply></apply></apply><cn type="integer" id="S3.SS3.p2.2.m2.1.2.3.cmml" xref="S3.SS3.p2.2.m2.1.2.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p2.2.m2.1c">\sum_{i=1}^{n}G(x)_{i}=1</annotation></semantics></math> and <math id="S3.SS3.p2.3.m3.5" class="ltx_Math" alttext="M_{i},i=1,...,n" display="inline"><semantics id="S3.SS3.p2.3.m3.5a"><mrow id="S3.SS3.p2.3.m3.5.5.2" xref="S3.SS3.p2.3.m3.5.5.3.cmml"><mrow id="S3.SS3.p2.3.m3.4.4.1.1" xref="S3.SS3.p2.3.m3.4.4.1.1.cmml"><mrow id="S3.SS3.p2.3.m3.4.4.1.1.1.1" xref="S3.SS3.p2.3.m3.4.4.1.1.1.2.cmml"><msub id="S3.SS3.p2.3.m3.4.4.1.1.1.1.1" xref="S3.SS3.p2.3.m3.4.4.1.1.1.1.1.cmml"><mi id="S3.SS3.p2.3.m3.4.4.1.1.1.1.1.2" xref="S3.SS3.p2.3.m3.4.4.1.1.1.1.1.2.cmml">M</mi><mi id="S3.SS3.p2.3.m3.4.4.1.1.1.1.1.3" xref="S3.SS3.p2.3.m3.4.4.1.1.1.1.1.3.cmml">i</mi></msub><mo id="S3.SS3.p2.3.m3.4.4.1.1.1.1.2" xref="S3.SS3.p2.3.m3.4.4.1.1.1.2.cmml">,</mo><mi id="S3.SS3.p2.3.m3.1.1" xref="S3.SS3.p2.3.m3.1.1.cmml">i</mi></mrow><mo id="S3.SS3.p2.3.m3.4.4.1.1.2" xref="S3.SS3.p2.3.m3.4.4.1.1.2.cmml">=</mo><mn id="S3.SS3.p2.3.m3.4.4.1.1.3" xref="S3.SS3.p2.3.m3.4.4.1.1.3.cmml">1</mn></mrow><mo id="S3.SS3.p2.3.m3.5.5.2.3" xref="S3.SS3.p2.3.m3.5.5.3a.cmml">,</mo><mrow id="S3.SS3.p2.3.m3.5.5.2.2.2" xref="S3.SS3.p2.3.m3.5.5.2.2.1.cmml"><mi mathvariant="normal" id="S3.SS3.p2.3.m3.2.2" xref="S3.SS3.p2.3.m3.2.2.cmml">…</mi><mo id="S3.SS3.p2.3.m3.5.5.2.2.2.1" xref="S3.SS3.p2.3.m3.5.5.2.2.1.cmml">,</mo><mi id="S3.SS3.p2.3.m3.3.3" xref="S3.SS3.p2.3.m3.3.3.cmml">n</mi></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.p2.3.m3.5b"><apply id="S3.SS3.p2.3.m3.5.5.3.cmml" xref="S3.SS3.p2.3.m3.5.5.2"><csymbol cd="ambiguous" id="S3.SS3.p2.3.m3.5.5.3a.cmml" xref="S3.SS3.p2.3.m3.5.5.2.3">formulae-sequence</csymbol><apply id="S3.SS3.p2.3.m3.4.4.1.1.cmml" xref="S3.SS3.p2.3.m3.4.4.1.1"><eq id="S3.SS3.p2.3.m3.4.4.1.1.2.cmml" xref="S3.SS3.p2.3.m3.4.4.1.1.2"></eq><list id="S3.SS3.p2.3.m3.4.4.1.1.1.2.cmml" xref="S3.SS3.p2.3.m3.4.4.1.1.1.1"><apply id="S3.SS3.p2.3.m3.4.4.1.1.1.1.1.cmml" xref="S3.SS3.p2.3.m3.4.4.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS3.p2.3.m3.4.4.1.1.1.1.1.1.cmml" xref="S3.SS3.p2.3.m3.4.4.1.1.1.1.1">subscript</csymbol><ci id="S3.SS3.p2.3.m3.4.4.1.1.1.1.1.2.cmml" xref="S3.SS3.p2.3.m3.4.4.1.1.1.1.1.2">𝑀</ci><ci id="S3.SS3.p2.3.m3.4.4.1.1.1.1.1.3.cmml" xref="S3.SS3.p2.3.m3.4.4.1.1.1.1.1.3">𝑖</ci></apply><ci id="S3.SS3.p2.3.m3.1.1.cmml" xref="S3.SS3.p2.3.m3.1.1">𝑖</ci></list><cn type="integer" id="S3.SS3.p2.3.m3.4.4.1.1.3.cmml" xref="S3.SS3.p2.3.m3.4.4.1.1.3">1</cn></apply><list id="S3.SS3.p2.3.m3.5.5.2.2.1.cmml" xref="S3.SS3.p2.3.m3.5.5.2.2.2"><ci id="S3.SS3.p2.3.m3.2.2.cmml" xref="S3.SS3.p2.3.m3.2.2">…</ci><ci id="S3.SS3.p2.3.m3.3.3.cmml" xref="S3.SS3.p2.3.m3.3.3">𝑛</ci></list></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p2.3.m3.5c">M_{i},i=1,...,n</annotation></semantics></math> are <math id="S3.SS3.p2.4.m4.1" class="ltx_Math" alttext="n" display="inline"><semantics id="S3.SS3.p2.4.m4.1a"><mi id="S3.SS3.p2.4.m4.1.1" xref="S3.SS3.p2.4.m4.1.1.cmml">n</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.p2.4.m4.1b"><ci id="S3.SS3.p2.4.m4.1.1.cmml" xref="S3.SS3.p2.4.m4.1.1">𝑛</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p2.4.m4.1c">n</annotation></semantics></math> experts (neural networks). Specifically, the gating network <math id="S3.SS3.p2.5.m5.1" class="ltx_Math" alttext="G" display="inline"><semantics id="S3.SS3.p2.5.m5.1a"><mi id="S3.SS3.p2.5.m5.1.1" xref="S3.SS3.p2.5.m5.1.1.cmml">G</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.p2.5.m5.1b"><ci id="S3.SS3.p2.5.m5.1.1.cmml" xref="S3.SS3.p2.5.m5.1.1">𝐺</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p2.5.m5.1c">G</annotation></semantics></math> produces a probability distribution on <math id="S3.SS3.p2.6.m6.1" class="ltx_Math" alttext="n" display="inline"><semantics id="S3.SS3.p2.6.m6.1a"><mi id="S3.SS3.p2.6.m6.1.1" xref="S3.SS3.p2.6.m6.1.1.cmml">n</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.p2.6.m6.1b"><ci id="S3.SS3.p2.6.m6.1.1.cmml" xref="S3.SS3.p2.6.m6.1.1">𝑛</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p2.6.m6.1c">n</annotation></semantics></math> experts, and the final output is the weighted sum of all experts.
In our method, there are <math id="S3.SS3.p2.7.m7.1" class="ltx_Math" alttext="n=2" display="inline"><semantics id="S3.SS3.p2.7.m7.1a"><mrow id="S3.SS3.p2.7.m7.1.1" xref="S3.SS3.p2.7.m7.1.1.cmml"><mi id="S3.SS3.p2.7.m7.1.1.2" xref="S3.SS3.p2.7.m7.1.1.2.cmml">n</mi><mo id="S3.SS3.p2.7.m7.1.1.1" xref="S3.SS3.p2.7.m7.1.1.1.cmml">=</mo><mn id="S3.SS3.p2.7.m7.1.1.3" xref="S3.SS3.p2.7.m7.1.1.3.cmml">2</mn></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.p2.7.m7.1b"><apply id="S3.SS3.p2.7.m7.1.1.cmml" xref="S3.SS3.p2.7.m7.1.1"><eq id="S3.SS3.p2.7.m7.1.1.1.cmml" xref="S3.SS3.p2.7.m7.1.1.1"></eq><ci id="S3.SS3.p2.7.m7.1.1.2.cmml" xref="S3.SS3.p2.7.m7.1.1.2">𝑛</ci><cn type="integer" id="S3.SS3.p2.7.m7.1.1.3.cmml" xref="S3.SS3.p2.7.m7.1.1.3">2</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p2.7.m7.1c">n=2</annotation></semantics></math> experts: the personalized model is viewed as the local expert, while the global model is viewed as the global expert. Their outputs are mixed by the gating network. The gating is a linear neural network, and can also be trained with SGD.</p>
</div>
<div id="S3.SS3.p3" class="ltx_para">
<p id="S3.SS3.p3.6" class="ltx_p">We define the gating network as <math id="S3.SS3.p3.1.m1.1" class="ltx_Math" alttext="G" display="inline"><semantics id="S3.SS3.p3.1.m1.1a"><mi id="S3.SS3.p3.1.m1.1.1" xref="S3.SS3.p3.1.m1.1.1.cmml">G</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.p3.1.m1.1b"><ci id="S3.SS3.p3.1.m1.1.1.cmml" xref="S3.SS3.p3.1.m1.1.1">𝐺</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p3.1.m1.1c">G</annotation></semantics></math>. For client <math id="S3.SS3.p3.2.m2.1" class="ltx_Math" alttext="i" display="inline"><semantics id="S3.SS3.p3.2.m2.1a"><mi id="S3.SS3.p3.2.m2.1.1" xref="S3.SS3.p3.2.m2.1.1.cmml">i</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.p3.2.m2.1b"><ci id="S3.SS3.p3.2.m2.1.1.cmml" xref="S3.SS3.p3.2.m2.1.1">𝑖</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p3.2.m2.1c">i</annotation></semantics></math>, we define its parameter of <math id="S3.SS3.p3.3.m3.1" class="ltx_Math" alttext="G" display="inline"><semantics id="S3.SS3.p3.3.m3.1a"><mi id="S3.SS3.p3.3.m3.1.1" xref="S3.SS3.p3.3.m3.1.1.cmml">G</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.p3.3.m3.1b"><ci id="S3.SS3.p3.3.m3.1.1.cmml" xref="S3.SS3.p3.3.m3.1.1">𝐺</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p3.3.m3.1c">G</annotation></semantics></math> as <math id="S3.SS3.p3.4.m4.1" class="ltx_Math" alttext="w_{i}" display="inline"><semantics id="S3.SS3.p3.4.m4.1a"><msub id="S3.SS3.p3.4.m4.1.1" xref="S3.SS3.p3.4.m4.1.1.cmml"><mi id="S3.SS3.p3.4.m4.1.1.2" xref="S3.SS3.p3.4.m4.1.1.2.cmml">w</mi><mi id="S3.SS3.p3.4.m4.1.1.3" xref="S3.SS3.p3.4.m4.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS3.p3.4.m4.1b"><apply id="S3.SS3.p3.4.m4.1.1.cmml" xref="S3.SS3.p3.4.m4.1.1"><csymbol cd="ambiguous" id="S3.SS3.p3.4.m4.1.1.1.cmml" xref="S3.SS3.p3.4.m4.1.1">subscript</csymbol><ci id="S3.SS3.p3.4.m4.1.1.2.cmml" xref="S3.SS3.p3.4.m4.1.1.2">𝑤</ci><ci id="S3.SS3.p3.4.m4.1.1.3.cmml" xref="S3.SS3.p3.4.m4.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p3.4.m4.1c">w_{i}</annotation></semantics></math> (<math id="S3.SS3.p3.5.m5.1" class="ltx_Math" alttext="d_{2}" display="inline"><semantics id="S3.SS3.p3.5.m5.1a"><msub id="S3.SS3.p3.5.m5.1.1" xref="S3.SS3.p3.5.m5.1.1.cmml"><mi id="S3.SS3.p3.5.m5.1.1.2" xref="S3.SS3.p3.5.m5.1.1.2.cmml">d</mi><mn id="S3.SS3.p3.5.m5.1.1.3" xref="S3.SS3.p3.5.m5.1.1.3.cmml">2</mn></msub><annotation-xml encoding="MathML-Content" id="S3.SS3.p3.5.m5.1b"><apply id="S3.SS3.p3.5.m5.1.1.cmml" xref="S3.SS3.p3.5.m5.1.1"><csymbol cd="ambiguous" id="S3.SS3.p3.5.m5.1.1.1.cmml" xref="S3.SS3.p3.5.m5.1.1">subscript</csymbol><ci id="S3.SS3.p3.5.m5.1.1.2.cmml" xref="S3.SS3.p3.5.m5.1.1.2">𝑑</ci><cn type="integer" id="S3.SS3.p3.5.m5.1.1.3.cmml" xref="S3.SS3.p3.5.m5.1.1.3">2</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p3.5.m5.1c">d_{2}</annotation></semantics></math>-dimensional vector), and the loss function of gating <math id="S3.SS3.p3.6.m6.1" class="ltx_Math" alttext="p_{i}" display="inline"><semantics id="S3.SS3.p3.6.m6.1a"><msub id="S3.SS3.p3.6.m6.1.1" xref="S3.SS3.p3.6.m6.1.1.cmml"><mi id="S3.SS3.p3.6.m6.1.1.2" xref="S3.SS3.p3.6.m6.1.1.2.cmml">p</mi><mi id="S3.SS3.p3.6.m6.1.1.3" xref="S3.SS3.p3.6.m6.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS3.p3.6.m6.1b"><apply id="S3.SS3.p3.6.m6.1.1.cmml" xref="S3.SS3.p3.6.m6.1.1"><csymbol cd="ambiguous" id="S3.SS3.p3.6.m6.1.1.1.cmml" xref="S3.SS3.p3.6.m6.1.1">subscript</csymbol><ci id="S3.SS3.p3.6.m6.1.1.2.cmml" xref="S3.SS3.p3.6.m6.1.1.2">𝑝</ci><ci id="S3.SS3.p3.6.m6.1.1.3.cmml" xref="S3.SS3.p3.6.m6.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p3.6.m6.1c">p_{i}</annotation></semantics></math> is given by Eq. <a href="#S3.E7" title="In III-C Mixing ‣ III PFL-MoE ‣ PFL-MoE: Personalized Federated Learning Based on Mixture of Experts" class="ltx_ref"><span class="ltx_text ltx_ref_tag">7</span></a>:</p>
<table id="S3.E7" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S3.E7.m1.6" class="ltx_Math" alttext="p_{i}(w_{i})=\mathbb{E}_{(x,y)\sim\mathcal{D}_{i}}[L_{i}(\tilde{y},y)]" display="block"><semantics id="S3.E7.m1.6a"><mrow id="S3.E7.m1.6.6" xref="S3.E7.m1.6.6.cmml"><mrow id="S3.E7.m1.5.5.1" xref="S3.E7.m1.5.5.1.cmml"><msub id="S3.E7.m1.5.5.1.3" xref="S3.E7.m1.5.5.1.3.cmml"><mi id="S3.E7.m1.5.5.1.3.2" xref="S3.E7.m1.5.5.1.3.2.cmml">p</mi><mi id="S3.E7.m1.5.5.1.3.3" xref="S3.E7.m1.5.5.1.3.3.cmml">i</mi></msub><mo lspace="0em" rspace="0em" id="S3.E7.m1.5.5.1.2" xref="S3.E7.m1.5.5.1.2.cmml">​</mo><mrow id="S3.E7.m1.5.5.1.1.1" xref="S3.E7.m1.5.5.1.1.1.1.cmml"><mo stretchy="false" id="S3.E7.m1.5.5.1.1.1.2" xref="S3.E7.m1.5.5.1.1.1.1.cmml">(</mo><msub id="S3.E7.m1.5.5.1.1.1.1" xref="S3.E7.m1.5.5.1.1.1.1.cmml"><mi id="S3.E7.m1.5.5.1.1.1.1.2" xref="S3.E7.m1.5.5.1.1.1.1.2.cmml">w</mi><mi id="S3.E7.m1.5.5.1.1.1.1.3" xref="S3.E7.m1.5.5.1.1.1.1.3.cmml">i</mi></msub><mo stretchy="false" id="S3.E7.m1.5.5.1.1.1.3" xref="S3.E7.m1.5.5.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S3.E7.m1.6.6.3" xref="S3.E7.m1.6.6.3.cmml">=</mo><mrow id="S3.E7.m1.6.6.2" xref="S3.E7.m1.6.6.2.cmml"><msub id="S3.E7.m1.6.6.2.3" xref="S3.E7.m1.6.6.2.3.cmml"><mi id="S3.E7.m1.6.6.2.3.2" xref="S3.E7.m1.6.6.2.3.2.cmml">𝔼</mi><mrow id="S3.E7.m1.2.2.2" xref="S3.E7.m1.2.2.2.cmml"><mrow id="S3.E7.m1.2.2.2.4.2" xref="S3.E7.m1.2.2.2.4.1.cmml"><mo stretchy="false" id="S3.E7.m1.2.2.2.4.2.1" xref="S3.E7.m1.2.2.2.4.1.cmml">(</mo><mi id="S3.E7.m1.1.1.1.1" xref="S3.E7.m1.1.1.1.1.cmml">x</mi><mo id="S3.E7.m1.2.2.2.4.2.2" xref="S3.E7.m1.2.2.2.4.1.cmml">,</mo><mi id="S3.E7.m1.2.2.2.2" xref="S3.E7.m1.2.2.2.2.cmml">y</mi><mo stretchy="false" id="S3.E7.m1.2.2.2.4.2.3" xref="S3.E7.m1.2.2.2.4.1.cmml">)</mo></mrow><mo id="S3.E7.m1.2.2.2.3" xref="S3.E7.m1.2.2.2.3.cmml">∼</mo><msub id="S3.E7.m1.2.2.2.5" xref="S3.E7.m1.2.2.2.5.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.E7.m1.2.2.2.5.2" xref="S3.E7.m1.2.2.2.5.2.cmml">𝒟</mi><mi id="S3.E7.m1.2.2.2.5.3" xref="S3.E7.m1.2.2.2.5.3.cmml">i</mi></msub></mrow></msub><mo lspace="0em" rspace="0em" id="S3.E7.m1.6.6.2.2" xref="S3.E7.m1.6.6.2.2.cmml">​</mo><mrow id="S3.E7.m1.6.6.2.1.1" xref="S3.E7.m1.6.6.2.1.2.cmml"><mo stretchy="false" id="S3.E7.m1.6.6.2.1.1.2" xref="S3.E7.m1.6.6.2.1.2.1.cmml">[</mo><mrow id="S3.E7.m1.6.6.2.1.1.1" xref="S3.E7.m1.6.6.2.1.1.1.cmml"><msub id="S3.E7.m1.6.6.2.1.1.1.2" xref="S3.E7.m1.6.6.2.1.1.1.2.cmml"><mi id="S3.E7.m1.6.6.2.1.1.1.2.2" xref="S3.E7.m1.6.6.2.1.1.1.2.2.cmml">L</mi><mi id="S3.E7.m1.6.6.2.1.1.1.2.3" xref="S3.E7.m1.6.6.2.1.1.1.2.3.cmml">i</mi></msub><mo lspace="0em" rspace="0em" id="S3.E7.m1.6.6.2.1.1.1.1" xref="S3.E7.m1.6.6.2.1.1.1.1.cmml">​</mo><mrow id="S3.E7.m1.6.6.2.1.1.1.3.2" xref="S3.E7.m1.6.6.2.1.1.1.3.1.cmml"><mo stretchy="false" id="S3.E7.m1.6.6.2.1.1.1.3.2.1" xref="S3.E7.m1.6.6.2.1.1.1.3.1.cmml">(</mo><mover accent="true" id="S3.E7.m1.3.3" xref="S3.E7.m1.3.3.cmml"><mi id="S3.E7.m1.3.3.2" xref="S3.E7.m1.3.3.2.cmml">y</mi><mo id="S3.E7.m1.3.3.1" xref="S3.E7.m1.3.3.1.cmml">~</mo></mover><mo id="S3.E7.m1.6.6.2.1.1.1.3.2.2" xref="S3.E7.m1.6.6.2.1.1.1.3.1.cmml">,</mo><mi id="S3.E7.m1.4.4" xref="S3.E7.m1.4.4.cmml">y</mi><mo stretchy="false" id="S3.E7.m1.6.6.2.1.1.1.3.2.3" xref="S3.E7.m1.6.6.2.1.1.1.3.1.cmml">)</mo></mrow></mrow><mo stretchy="false" id="S3.E7.m1.6.6.2.1.1.3" xref="S3.E7.m1.6.6.2.1.2.1.cmml">]</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.E7.m1.6b"><apply id="S3.E7.m1.6.6.cmml" xref="S3.E7.m1.6.6"><eq id="S3.E7.m1.6.6.3.cmml" xref="S3.E7.m1.6.6.3"></eq><apply id="S3.E7.m1.5.5.1.cmml" xref="S3.E7.m1.5.5.1"><times id="S3.E7.m1.5.5.1.2.cmml" xref="S3.E7.m1.5.5.1.2"></times><apply id="S3.E7.m1.5.5.1.3.cmml" xref="S3.E7.m1.5.5.1.3"><csymbol cd="ambiguous" id="S3.E7.m1.5.5.1.3.1.cmml" xref="S3.E7.m1.5.5.1.3">subscript</csymbol><ci id="S3.E7.m1.5.5.1.3.2.cmml" xref="S3.E7.m1.5.5.1.3.2">𝑝</ci><ci id="S3.E7.m1.5.5.1.3.3.cmml" xref="S3.E7.m1.5.5.1.3.3">𝑖</ci></apply><apply id="S3.E7.m1.5.5.1.1.1.1.cmml" xref="S3.E7.m1.5.5.1.1.1"><csymbol cd="ambiguous" id="S3.E7.m1.5.5.1.1.1.1.1.cmml" xref="S3.E7.m1.5.5.1.1.1">subscript</csymbol><ci id="S3.E7.m1.5.5.1.1.1.1.2.cmml" xref="S3.E7.m1.5.5.1.1.1.1.2">𝑤</ci><ci id="S3.E7.m1.5.5.1.1.1.1.3.cmml" xref="S3.E7.m1.5.5.1.1.1.1.3">𝑖</ci></apply></apply><apply id="S3.E7.m1.6.6.2.cmml" xref="S3.E7.m1.6.6.2"><times id="S3.E7.m1.6.6.2.2.cmml" xref="S3.E7.m1.6.6.2.2"></times><apply id="S3.E7.m1.6.6.2.3.cmml" xref="S3.E7.m1.6.6.2.3"><csymbol cd="ambiguous" id="S3.E7.m1.6.6.2.3.1.cmml" xref="S3.E7.m1.6.6.2.3">subscript</csymbol><ci id="S3.E7.m1.6.6.2.3.2.cmml" xref="S3.E7.m1.6.6.2.3.2">𝔼</ci><apply id="S3.E7.m1.2.2.2.cmml" xref="S3.E7.m1.2.2.2"><csymbol cd="latexml" id="S3.E7.m1.2.2.2.3.cmml" xref="S3.E7.m1.2.2.2.3">similar-to</csymbol><interval closure="open" id="S3.E7.m1.2.2.2.4.1.cmml" xref="S3.E7.m1.2.2.2.4.2"><ci id="S3.E7.m1.1.1.1.1.cmml" xref="S3.E7.m1.1.1.1.1">𝑥</ci><ci id="S3.E7.m1.2.2.2.2.cmml" xref="S3.E7.m1.2.2.2.2">𝑦</ci></interval><apply id="S3.E7.m1.2.2.2.5.cmml" xref="S3.E7.m1.2.2.2.5"><csymbol cd="ambiguous" id="S3.E7.m1.2.2.2.5.1.cmml" xref="S3.E7.m1.2.2.2.5">subscript</csymbol><ci id="S3.E7.m1.2.2.2.5.2.cmml" xref="S3.E7.m1.2.2.2.5.2">𝒟</ci><ci id="S3.E7.m1.2.2.2.5.3.cmml" xref="S3.E7.m1.2.2.2.5.3">𝑖</ci></apply></apply></apply><apply id="S3.E7.m1.6.6.2.1.2.cmml" xref="S3.E7.m1.6.6.2.1.1"><csymbol cd="latexml" id="S3.E7.m1.6.6.2.1.2.1.cmml" xref="S3.E7.m1.6.6.2.1.1.2">delimited-[]</csymbol><apply id="S3.E7.m1.6.6.2.1.1.1.cmml" xref="S3.E7.m1.6.6.2.1.1.1"><times id="S3.E7.m1.6.6.2.1.1.1.1.cmml" xref="S3.E7.m1.6.6.2.1.1.1.1"></times><apply id="S3.E7.m1.6.6.2.1.1.1.2.cmml" xref="S3.E7.m1.6.6.2.1.1.1.2"><csymbol cd="ambiguous" id="S3.E7.m1.6.6.2.1.1.1.2.1.cmml" xref="S3.E7.m1.6.6.2.1.1.1.2">subscript</csymbol><ci id="S3.E7.m1.6.6.2.1.1.1.2.2.cmml" xref="S3.E7.m1.6.6.2.1.1.1.2.2">𝐿</ci><ci id="S3.E7.m1.6.6.2.1.1.1.2.3.cmml" xref="S3.E7.m1.6.6.2.1.1.1.2.3">𝑖</ci></apply><interval closure="open" id="S3.E7.m1.6.6.2.1.1.1.3.1.cmml" xref="S3.E7.m1.6.6.2.1.1.1.3.2"><apply id="S3.E7.m1.3.3.cmml" xref="S3.E7.m1.3.3"><ci id="S3.E7.m1.3.3.1.cmml" xref="S3.E7.m1.3.3.1">~</ci><ci id="S3.E7.m1.3.3.2.cmml" xref="S3.E7.m1.3.3.2">𝑦</ci></apply><ci id="S3.E7.m1.4.4.cmml" xref="S3.E7.m1.4.4">𝑦</ci></interval></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E7.m1.6c">p_{i}(w_{i})=\mathbb{E}_{(x,y)\sim\mathcal{D}_{i}}[L_{i}(\tilde{y},y)]</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(7)</span></td>
</tr></tbody>
</table>
<p id="S3.SS3.p3.9" class="ltx_p">where <math id="S3.SS3.p3.7.m1.1" class="ltx_Math" alttext="p_{i}:\mathbb{R}^{d_{2}}\rightarrow\mathbb{R}" display="inline"><semantics id="S3.SS3.p3.7.m1.1a"><mrow id="S3.SS3.p3.7.m1.1.1" xref="S3.SS3.p3.7.m1.1.1.cmml"><msub id="S3.SS3.p3.7.m1.1.1.2" xref="S3.SS3.p3.7.m1.1.1.2.cmml"><mi id="S3.SS3.p3.7.m1.1.1.2.2" xref="S3.SS3.p3.7.m1.1.1.2.2.cmml">p</mi><mi id="S3.SS3.p3.7.m1.1.1.2.3" xref="S3.SS3.p3.7.m1.1.1.2.3.cmml">i</mi></msub><mo lspace="0.278em" rspace="0.278em" id="S3.SS3.p3.7.m1.1.1.1" xref="S3.SS3.p3.7.m1.1.1.1.cmml">:</mo><mrow id="S3.SS3.p3.7.m1.1.1.3" xref="S3.SS3.p3.7.m1.1.1.3.cmml"><msup id="S3.SS3.p3.7.m1.1.1.3.2" xref="S3.SS3.p3.7.m1.1.1.3.2.cmml"><mi id="S3.SS3.p3.7.m1.1.1.3.2.2" xref="S3.SS3.p3.7.m1.1.1.3.2.2.cmml">ℝ</mi><msub id="S3.SS3.p3.7.m1.1.1.3.2.3" xref="S3.SS3.p3.7.m1.1.1.3.2.3.cmml"><mi id="S3.SS3.p3.7.m1.1.1.3.2.3.2" xref="S3.SS3.p3.7.m1.1.1.3.2.3.2.cmml">d</mi><mn id="S3.SS3.p3.7.m1.1.1.3.2.3.3" xref="S3.SS3.p3.7.m1.1.1.3.2.3.3.cmml">2</mn></msub></msup><mo stretchy="false" id="S3.SS3.p3.7.m1.1.1.3.1" xref="S3.SS3.p3.7.m1.1.1.3.1.cmml">→</mo><mi id="S3.SS3.p3.7.m1.1.1.3.3" xref="S3.SS3.p3.7.m1.1.1.3.3.cmml">ℝ</mi></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.p3.7.m1.1b"><apply id="S3.SS3.p3.7.m1.1.1.cmml" xref="S3.SS3.p3.7.m1.1.1"><ci id="S3.SS3.p3.7.m1.1.1.1.cmml" xref="S3.SS3.p3.7.m1.1.1.1">:</ci><apply id="S3.SS3.p3.7.m1.1.1.2.cmml" xref="S3.SS3.p3.7.m1.1.1.2"><csymbol cd="ambiguous" id="S3.SS3.p3.7.m1.1.1.2.1.cmml" xref="S3.SS3.p3.7.m1.1.1.2">subscript</csymbol><ci id="S3.SS3.p3.7.m1.1.1.2.2.cmml" xref="S3.SS3.p3.7.m1.1.1.2.2">𝑝</ci><ci id="S3.SS3.p3.7.m1.1.1.2.3.cmml" xref="S3.SS3.p3.7.m1.1.1.2.3">𝑖</ci></apply><apply id="S3.SS3.p3.7.m1.1.1.3.cmml" xref="S3.SS3.p3.7.m1.1.1.3"><ci id="S3.SS3.p3.7.m1.1.1.3.1.cmml" xref="S3.SS3.p3.7.m1.1.1.3.1">→</ci><apply id="S3.SS3.p3.7.m1.1.1.3.2.cmml" xref="S3.SS3.p3.7.m1.1.1.3.2"><csymbol cd="ambiguous" id="S3.SS3.p3.7.m1.1.1.3.2.1.cmml" xref="S3.SS3.p3.7.m1.1.1.3.2">superscript</csymbol><ci id="S3.SS3.p3.7.m1.1.1.3.2.2.cmml" xref="S3.SS3.p3.7.m1.1.1.3.2.2">ℝ</ci><apply id="S3.SS3.p3.7.m1.1.1.3.2.3.cmml" xref="S3.SS3.p3.7.m1.1.1.3.2.3"><csymbol cd="ambiguous" id="S3.SS3.p3.7.m1.1.1.3.2.3.1.cmml" xref="S3.SS3.p3.7.m1.1.1.3.2.3">subscript</csymbol><ci id="S3.SS3.p3.7.m1.1.1.3.2.3.2.cmml" xref="S3.SS3.p3.7.m1.1.1.3.2.3.2">𝑑</ci><cn type="integer" id="S3.SS3.p3.7.m1.1.1.3.2.3.3.cmml" xref="S3.SS3.p3.7.m1.1.1.3.2.3.3">2</cn></apply></apply><ci id="S3.SS3.p3.7.m1.1.1.3.3.cmml" xref="S3.SS3.p3.7.m1.1.1.3.3">ℝ</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p3.7.m1.1c">p_{i}:\mathbb{R}^{d_{2}}\rightarrow\mathbb{R}</annotation></semantics></math>, and the mixed pseudo label <math id="S3.SS3.p3.8.m2.1" class="ltx_Math" alttext="\tilde{y}" display="inline"><semantics id="S3.SS3.p3.8.m2.1a"><mover accent="true" id="S3.SS3.p3.8.m2.1.1" xref="S3.SS3.p3.8.m2.1.1.cmml"><mi id="S3.SS3.p3.8.m2.1.1.2" xref="S3.SS3.p3.8.m2.1.1.2.cmml">y</mi><mo id="S3.SS3.p3.8.m2.1.1.1" xref="S3.SS3.p3.8.m2.1.1.1.cmml">~</mo></mover><annotation-xml encoding="MathML-Content" id="S3.SS3.p3.8.m2.1b"><apply id="S3.SS3.p3.8.m2.1.1.cmml" xref="S3.SS3.p3.8.m2.1.1"><ci id="S3.SS3.p3.8.m2.1.1.1.cmml" xref="S3.SS3.p3.8.m2.1.1.1">~</ci><ci id="S3.SS3.p3.8.m2.1.1.2.cmml" xref="S3.SS3.p3.8.m2.1.1.2">𝑦</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p3.8.m2.1c">\tilde{y}</annotation></semantics></math> is given by Eq. <a href="#S3.E8" title="In III-C Mixing ‣ III PFL-MoE ‣ PFL-MoE: Personalized Federated Learning Based on Mixture of Experts" class="ltx_ref"><span class="ltx_text ltx_ref_tag">8</span></a> and Eq. <a href="#S3.E9" title="In III-C Mixing ‣ III PFL-MoE ‣ PFL-MoE: Personalized Federated Learning Based on Mixture of Experts" class="ltx_ref"><span class="ltx_text ltx_ref_tag">9</span></a> when the input is <math id="S3.SS3.p3.9.m3.1" class="ltx_Math" alttext="x" display="inline"><semantics id="S3.SS3.p3.9.m3.1a"><mi id="S3.SS3.p3.9.m3.1.1" xref="S3.SS3.p3.9.m3.1.1.cmml">x</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.p3.9.m3.1b"><ci id="S3.SS3.p3.9.m3.1.1.cmml" xref="S3.SS3.p3.9.m3.1.1">𝑥</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p3.9.m3.1c">x</annotation></semantics></math>:</p>
<table id="S3.E8" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S3.E8.m1.2" class="ltx_Math" alttext="g=sigmoid(G(w_{i};x))" display="block"><semantics id="S3.E8.m1.2a"><mrow id="S3.E8.m1.2.2" xref="S3.E8.m1.2.2.cmml"><mi id="S3.E8.m1.2.2.3" xref="S3.E8.m1.2.2.3.cmml">g</mi><mo id="S3.E8.m1.2.2.2" xref="S3.E8.m1.2.2.2.cmml">=</mo><mrow id="S3.E8.m1.2.2.1" xref="S3.E8.m1.2.2.1.cmml"><mi id="S3.E8.m1.2.2.1.3" xref="S3.E8.m1.2.2.1.3.cmml">s</mi><mo lspace="0em" rspace="0em" id="S3.E8.m1.2.2.1.2" xref="S3.E8.m1.2.2.1.2.cmml">​</mo><mi id="S3.E8.m1.2.2.1.4" xref="S3.E8.m1.2.2.1.4.cmml">i</mi><mo lspace="0em" rspace="0em" id="S3.E8.m1.2.2.1.2a" xref="S3.E8.m1.2.2.1.2.cmml">​</mo><mi id="S3.E8.m1.2.2.1.5" xref="S3.E8.m1.2.2.1.5.cmml">g</mi><mo lspace="0em" rspace="0em" id="S3.E8.m1.2.2.1.2b" xref="S3.E8.m1.2.2.1.2.cmml">​</mo><mi id="S3.E8.m1.2.2.1.6" xref="S3.E8.m1.2.2.1.6.cmml">m</mi><mo lspace="0em" rspace="0em" id="S3.E8.m1.2.2.1.2c" xref="S3.E8.m1.2.2.1.2.cmml">​</mo><mi id="S3.E8.m1.2.2.1.7" xref="S3.E8.m1.2.2.1.7.cmml">o</mi><mo lspace="0em" rspace="0em" id="S3.E8.m1.2.2.1.2d" xref="S3.E8.m1.2.2.1.2.cmml">​</mo><mi id="S3.E8.m1.2.2.1.8" xref="S3.E8.m1.2.2.1.8.cmml">i</mi><mo lspace="0em" rspace="0em" id="S3.E8.m1.2.2.1.2e" xref="S3.E8.m1.2.2.1.2.cmml">​</mo><mi id="S3.E8.m1.2.2.1.9" xref="S3.E8.m1.2.2.1.9.cmml">d</mi><mo lspace="0em" rspace="0em" id="S3.E8.m1.2.2.1.2f" xref="S3.E8.m1.2.2.1.2.cmml">​</mo><mrow id="S3.E8.m1.2.2.1.1.1" xref="S3.E8.m1.2.2.1.1.1.1.cmml"><mo stretchy="false" id="S3.E8.m1.2.2.1.1.1.2" xref="S3.E8.m1.2.2.1.1.1.1.cmml">(</mo><mrow id="S3.E8.m1.2.2.1.1.1.1" xref="S3.E8.m1.2.2.1.1.1.1.cmml"><mi id="S3.E8.m1.2.2.1.1.1.1.3" xref="S3.E8.m1.2.2.1.1.1.1.3.cmml">G</mi><mo lspace="0em" rspace="0em" id="S3.E8.m1.2.2.1.1.1.1.2" xref="S3.E8.m1.2.2.1.1.1.1.2.cmml">​</mo><mrow id="S3.E8.m1.2.2.1.1.1.1.1.1" xref="S3.E8.m1.2.2.1.1.1.1.1.2.cmml"><mo stretchy="false" id="S3.E8.m1.2.2.1.1.1.1.1.1.2" xref="S3.E8.m1.2.2.1.1.1.1.1.2.cmml">(</mo><msub id="S3.E8.m1.2.2.1.1.1.1.1.1.1" xref="S3.E8.m1.2.2.1.1.1.1.1.1.1.cmml"><mi id="S3.E8.m1.2.2.1.1.1.1.1.1.1.2" xref="S3.E8.m1.2.2.1.1.1.1.1.1.1.2.cmml">w</mi><mi id="S3.E8.m1.2.2.1.1.1.1.1.1.1.3" xref="S3.E8.m1.2.2.1.1.1.1.1.1.1.3.cmml">i</mi></msub><mo id="S3.E8.m1.2.2.1.1.1.1.1.1.3" xref="S3.E8.m1.2.2.1.1.1.1.1.2.cmml">;</mo><mi id="S3.E8.m1.1.1" xref="S3.E8.m1.1.1.cmml">x</mi><mo stretchy="false" id="S3.E8.m1.2.2.1.1.1.1.1.1.4" xref="S3.E8.m1.2.2.1.1.1.1.1.2.cmml">)</mo></mrow></mrow><mo stretchy="false" id="S3.E8.m1.2.2.1.1.1.3" xref="S3.E8.m1.2.2.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.E8.m1.2b"><apply id="S3.E8.m1.2.2.cmml" xref="S3.E8.m1.2.2"><eq id="S3.E8.m1.2.2.2.cmml" xref="S3.E8.m1.2.2.2"></eq><ci id="S3.E8.m1.2.2.3.cmml" xref="S3.E8.m1.2.2.3">𝑔</ci><apply id="S3.E8.m1.2.2.1.cmml" xref="S3.E8.m1.2.2.1"><times id="S3.E8.m1.2.2.1.2.cmml" xref="S3.E8.m1.2.2.1.2"></times><ci id="S3.E8.m1.2.2.1.3.cmml" xref="S3.E8.m1.2.2.1.3">𝑠</ci><ci id="S3.E8.m1.2.2.1.4.cmml" xref="S3.E8.m1.2.2.1.4">𝑖</ci><ci id="S3.E8.m1.2.2.1.5.cmml" xref="S3.E8.m1.2.2.1.5">𝑔</ci><ci id="S3.E8.m1.2.2.1.6.cmml" xref="S3.E8.m1.2.2.1.6">𝑚</ci><ci id="S3.E8.m1.2.2.1.7.cmml" xref="S3.E8.m1.2.2.1.7">𝑜</ci><ci id="S3.E8.m1.2.2.1.8.cmml" xref="S3.E8.m1.2.2.1.8">𝑖</ci><ci id="S3.E8.m1.2.2.1.9.cmml" xref="S3.E8.m1.2.2.1.9">𝑑</ci><apply id="S3.E8.m1.2.2.1.1.1.1.cmml" xref="S3.E8.m1.2.2.1.1.1"><times id="S3.E8.m1.2.2.1.1.1.1.2.cmml" xref="S3.E8.m1.2.2.1.1.1.1.2"></times><ci id="S3.E8.m1.2.2.1.1.1.1.3.cmml" xref="S3.E8.m1.2.2.1.1.1.1.3">𝐺</ci><list id="S3.E8.m1.2.2.1.1.1.1.1.2.cmml" xref="S3.E8.m1.2.2.1.1.1.1.1.1"><apply id="S3.E8.m1.2.2.1.1.1.1.1.1.1.cmml" xref="S3.E8.m1.2.2.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E8.m1.2.2.1.1.1.1.1.1.1.1.cmml" xref="S3.E8.m1.2.2.1.1.1.1.1.1.1">subscript</csymbol><ci id="S3.E8.m1.2.2.1.1.1.1.1.1.1.2.cmml" xref="S3.E8.m1.2.2.1.1.1.1.1.1.1.2">𝑤</ci><ci id="S3.E8.m1.2.2.1.1.1.1.1.1.1.3.cmml" xref="S3.E8.m1.2.2.1.1.1.1.1.1.1.3">𝑖</ci></apply><ci id="S3.E8.m1.1.1.cmml" xref="S3.E8.m1.1.1">𝑥</ci></list></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E8.m1.2c">g=sigmoid(G(w_{i};x))</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(8)</span></td>
</tr></tbody>
</table>
</div>
<div id="S3.SS3.p4" class="ltx_para">
<table id="S3.E9" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S3.E9.m1.5" class="ltx_Math" alttext="\tilde{y}=g\cdot M_{G}(\theta;x)+(1-g)\cdot M_{G}(\theta_{i};x)" display="block"><semantics id="S3.E9.m1.5a"><mrow id="S3.E9.m1.5.5" xref="S3.E9.m1.5.5.cmml"><mover accent="true" id="S3.E9.m1.5.5.4" xref="S3.E9.m1.5.5.4.cmml"><mi id="S3.E9.m1.5.5.4.2" xref="S3.E9.m1.5.5.4.2.cmml">y</mi><mo id="S3.E9.m1.5.5.4.1" xref="S3.E9.m1.5.5.4.1.cmml">~</mo></mover><mo id="S3.E9.m1.5.5.3" xref="S3.E9.m1.5.5.3.cmml">=</mo><mrow id="S3.E9.m1.5.5.2" xref="S3.E9.m1.5.5.2.cmml"><mrow id="S3.E9.m1.5.5.2.4" xref="S3.E9.m1.5.5.2.4.cmml"><mrow id="S3.E9.m1.5.5.2.4.2" xref="S3.E9.m1.5.5.2.4.2.cmml"><mi id="S3.E9.m1.5.5.2.4.2.2" xref="S3.E9.m1.5.5.2.4.2.2.cmml">g</mi><mo lspace="0.222em" rspace="0.222em" id="S3.E9.m1.5.5.2.4.2.1" xref="S3.E9.m1.5.5.2.4.2.1.cmml">⋅</mo><msub id="S3.E9.m1.5.5.2.4.2.3" xref="S3.E9.m1.5.5.2.4.2.3.cmml"><mi id="S3.E9.m1.5.5.2.4.2.3.2" xref="S3.E9.m1.5.5.2.4.2.3.2.cmml">M</mi><mi id="S3.E9.m1.5.5.2.4.2.3.3" xref="S3.E9.m1.5.5.2.4.2.3.3.cmml">G</mi></msub></mrow><mo lspace="0em" rspace="0em" id="S3.E9.m1.5.5.2.4.1" xref="S3.E9.m1.5.5.2.4.1.cmml">​</mo><mrow id="S3.E9.m1.5.5.2.4.3.2" xref="S3.E9.m1.5.5.2.4.3.1.cmml"><mo stretchy="false" id="S3.E9.m1.5.5.2.4.3.2.1" xref="S3.E9.m1.5.5.2.4.3.1.cmml">(</mo><mi id="S3.E9.m1.1.1" xref="S3.E9.m1.1.1.cmml">θ</mi><mo id="S3.E9.m1.5.5.2.4.3.2.2" xref="S3.E9.m1.5.5.2.4.3.1.cmml">;</mo><mi id="S3.E9.m1.2.2" xref="S3.E9.m1.2.2.cmml">x</mi><mo stretchy="false" id="S3.E9.m1.5.5.2.4.3.2.3" xref="S3.E9.m1.5.5.2.4.3.1.cmml">)</mo></mrow></mrow><mo id="S3.E9.m1.5.5.2.3" xref="S3.E9.m1.5.5.2.3.cmml">+</mo><mrow id="S3.E9.m1.5.5.2.2" xref="S3.E9.m1.5.5.2.2.cmml"><mrow id="S3.E9.m1.4.4.1.1.1" xref="S3.E9.m1.4.4.1.1.1.cmml"><mrow id="S3.E9.m1.4.4.1.1.1.1.1" xref="S3.E9.m1.4.4.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S3.E9.m1.4.4.1.1.1.1.1.2" xref="S3.E9.m1.4.4.1.1.1.1.1.1.cmml">(</mo><mrow id="S3.E9.m1.4.4.1.1.1.1.1.1" xref="S3.E9.m1.4.4.1.1.1.1.1.1.cmml"><mn id="S3.E9.m1.4.4.1.1.1.1.1.1.2" xref="S3.E9.m1.4.4.1.1.1.1.1.1.2.cmml">1</mn><mo id="S3.E9.m1.4.4.1.1.1.1.1.1.1" xref="S3.E9.m1.4.4.1.1.1.1.1.1.1.cmml">−</mo><mi id="S3.E9.m1.4.4.1.1.1.1.1.1.3" xref="S3.E9.m1.4.4.1.1.1.1.1.1.3.cmml">g</mi></mrow><mo rspace="0.055em" stretchy="false" id="S3.E9.m1.4.4.1.1.1.1.1.3" xref="S3.E9.m1.4.4.1.1.1.1.1.1.cmml">)</mo></mrow><mo rspace="0.222em" id="S3.E9.m1.4.4.1.1.1.2" xref="S3.E9.m1.4.4.1.1.1.2.cmml">⋅</mo><msub id="S3.E9.m1.4.4.1.1.1.3" xref="S3.E9.m1.4.4.1.1.1.3.cmml"><mi id="S3.E9.m1.4.4.1.1.1.3.2" xref="S3.E9.m1.4.4.1.1.1.3.2.cmml">M</mi><mi id="S3.E9.m1.4.4.1.1.1.3.3" xref="S3.E9.m1.4.4.1.1.1.3.3.cmml">G</mi></msub></mrow><mo lspace="0em" rspace="0em" id="S3.E9.m1.5.5.2.2.3" xref="S3.E9.m1.5.5.2.2.3.cmml">​</mo><mrow id="S3.E9.m1.5.5.2.2.2.1" xref="S3.E9.m1.5.5.2.2.2.2.cmml"><mo stretchy="false" id="S3.E9.m1.5.5.2.2.2.1.2" xref="S3.E9.m1.5.5.2.2.2.2.cmml">(</mo><msub id="S3.E9.m1.5.5.2.2.2.1.1" xref="S3.E9.m1.5.5.2.2.2.1.1.cmml"><mi id="S3.E9.m1.5.5.2.2.2.1.1.2" xref="S3.E9.m1.5.5.2.2.2.1.1.2.cmml">θ</mi><mi id="S3.E9.m1.5.5.2.2.2.1.1.3" xref="S3.E9.m1.5.5.2.2.2.1.1.3.cmml">i</mi></msub><mo id="S3.E9.m1.5.5.2.2.2.1.3" xref="S3.E9.m1.5.5.2.2.2.2.cmml">;</mo><mi id="S3.E9.m1.3.3" xref="S3.E9.m1.3.3.cmml">x</mi><mo stretchy="false" id="S3.E9.m1.5.5.2.2.2.1.4" xref="S3.E9.m1.5.5.2.2.2.2.cmml">)</mo></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.E9.m1.5b"><apply id="S3.E9.m1.5.5.cmml" xref="S3.E9.m1.5.5"><eq id="S3.E9.m1.5.5.3.cmml" xref="S3.E9.m1.5.5.3"></eq><apply id="S3.E9.m1.5.5.4.cmml" xref="S3.E9.m1.5.5.4"><ci id="S3.E9.m1.5.5.4.1.cmml" xref="S3.E9.m1.5.5.4.1">~</ci><ci id="S3.E9.m1.5.5.4.2.cmml" xref="S3.E9.m1.5.5.4.2">𝑦</ci></apply><apply id="S3.E9.m1.5.5.2.cmml" xref="S3.E9.m1.5.5.2"><plus id="S3.E9.m1.5.5.2.3.cmml" xref="S3.E9.m1.5.5.2.3"></plus><apply id="S3.E9.m1.5.5.2.4.cmml" xref="S3.E9.m1.5.5.2.4"><times id="S3.E9.m1.5.5.2.4.1.cmml" xref="S3.E9.m1.5.5.2.4.1"></times><apply id="S3.E9.m1.5.5.2.4.2.cmml" xref="S3.E9.m1.5.5.2.4.2"><ci id="S3.E9.m1.5.5.2.4.2.1.cmml" xref="S3.E9.m1.5.5.2.4.2.1">⋅</ci><ci id="S3.E9.m1.5.5.2.4.2.2.cmml" xref="S3.E9.m1.5.5.2.4.2.2">𝑔</ci><apply id="S3.E9.m1.5.5.2.4.2.3.cmml" xref="S3.E9.m1.5.5.2.4.2.3"><csymbol cd="ambiguous" id="S3.E9.m1.5.5.2.4.2.3.1.cmml" xref="S3.E9.m1.5.5.2.4.2.3">subscript</csymbol><ci id="S3.E9.m1.5.5.2.4.2.3.2.cmml" xref="S3.E9.m1.5.5.2.4.2.3.2">𝑀</ci><ci id="S3.E9.m1.5.5.2.4.2.3.3.cmml" xref="S3.E9.m1.5.5.2.4.2.3.3">𝐺</ci></apply></apply><list id="S3.E9.m1.5.5.2.4.3.1.cmml" xref="S3.E9.m1.5.5.2.4.3.2"><ci id="S3.E9.m1.1.1.cmml" xref="S3.E9.m1.1.1">𝜃</ci><ci id="S3.E9.m1.2.2.cmml" xref="S3.E9.m1.2.2">𝑥</ci></list></apply><apply id="S3.E9.m1.5.5.2.2.cmml" xref="S3.E9.m1.5.5.2.2"><times id="S3.E9.m1.5.5.2.2.3.cmml" xref="S3.E9.m1.5.5.2.2.3"></times><apply id="S3.E9.m1.4.4.1.1.1.cmml" xref="S3.E9.m1.4.4.1.1.1"><ci id="S3.E9.m1.4.4.1.1.1.2.cmml" xref="S3.E9.m1.4.4.1.1.1.2">⋅</ci><apply id="S3.E9.m1.4.4.1.1.1.1.1.1.cmml" xref="S3.E9.m1.4.4.1.1.1.1.1"><minus id="S3.E9.m1.4.4.1.1.1.1.1.1.1.cmml" xref="S3.E9.m1.4.4.1.1.1.1.1.1.1"></minus><cn type="integer" id="S3.E9.m1.4.4.1.1.1.1.1.1.2.cmml" xref="S3.E9.m1.4.4.1.1.1.1.1.1.2">1</cn><ci id="S3.E9.m1.4.4.1.1.1.1.1.1.3.cmml" xref="S3.E9.m1.4.4.1.1.1.1.1.1.3">𝑔</ci></apply><apply id="S3.E9.m1.4.4.1.1.1.3.cmml" xref="S3.E9.m1.4.4.1.1.1.3"><csymbol cd="ambiguous" id="S3.E9.m1.4.4.1.1.1.3.1.cmml" xref="S3.E9.m1.4.4.1.1.1.3">subscript</csymbol><ci id="S3.E9.m1.4.4.1.1.1.3.2.cmml" xref="S3.E9.m1.4.4.1.1.1.3.2">𝑀</ci><ci id="S3.E9.m1.4.4.1.1.1.3.3.cmml" xref="S3.E9.m1.4.4.1.1.1.3.3">𝐺</ci></apply></apply><list id="S3.E9.m1.5.5.2.2.2.2.cmml" xref="S3.E9.m1.5.5.2.2.2.1"><apply id="S3.E9.m1.5.5.2.2.2.1.1.cmml" xref="S3.E9.m1.5.5.2.2.2.1.1"><csymbol cd="ambiguous" id="S3.E9.m1.5.5.2.2.2.1.1.1.cmml" xref="S3.E9.m1.5.5.2.2.2.1.1">subscript</csymbol><ci id="S3.E9.m1.5.5.2.2.2.1.1.2.cmml" xref="S3.E9.m1.5.5.2.2.2.1.1.2">𝜃</ci><ci id="S3.E9.m1.5.5.2.2.2.1.1.3.cmml" xref="S3.E9.m1.5.5.2.2.2.1.1.3">𝑖</ci></apply><ci id="S3.E9.m1.3.3.cmml" xref="S3.E9.m1.3.3">𝑥</ci></list></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E9.m1.5c">\tilde{y}=g\cdot M_{G}(\theta;x)+(1-g)\cdot M_{G}(\theta_{i};x)</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(9)</span></td>
</tr></tbody>
</table>
<p id="S3.SS3.p4.13" class="ltx_p">where the <math id="S3.SS3.p4.1.m1.1" class="ltx_Math" alttext="G" display="inline"><semantics id="S3.SS3.p4.1.m1.1a"><mi id="S3.SS3.p4.1.m1.1.1" xref="S3.SS3.p4.1.m1.1.1.cmml">G</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.p4.1.m1.1b"><ci id="S3.SS3.p4.1.m1.1.1.cmml" xref="S3.SS3.p4.1.m1.1.1">𝐺</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p4.1.m1.1c">G</annotation></semantics></math> is a linear neural network. <math id="S3.SS3.p4.2.m2.1" class="ltx_Math" alttext="sigmoid" display="inline"><semantics id="S3.SS3.p4.2.m2.1a"><mrow id="S3.SS3.p4.2.m2.1.1" xref="S3.SS3.p4.2.m2.1.1.cmml"><mi id="S3.SS3.p4.2.m2.1.1.2" xref="S3.SS3.p4.2.m2.1.1.2.cmml">s</mi><mo lspace="0em" rspace="0em" id="S3.SS3.p4.2.m2.1.1.1" xref="S3.SS3.p4.2.m2.1.1.1.cmml">​</mo><mi id="S3.SS3.p4.2.m2.1.1.3" xref="S3.SS3.p4.2.m2.1.1.3.cmml">i</mi><mo lspace="0em" rspace="0em" id="S3.SS3.p4.2.m2.1.1.1a" xref="S3.SS3.p4.2.m2.1.1.1.cmml">​</mo><mi id="S3.SS3.p4.2.m2.1.1.4" xref="S3.SS3.p4.2.m2.1.1.4.cmml">g</mi><mo lspace="0em" rspace="0em" id="S3.SS3.p4.2.m2.1.1.1b" xref="S3.SS3.p4.2.m2.1.1.1.cmml">​</mo><mi id="S3.SS3.p4.2.m2.1.1.5" xref="S3.SS3.p4.2.m2.1.1.5.cmml">m</mi><mo lspace="0em" rspace="0em" id="S3.SS3.p4.2.m2.1.1.1c" xref="S3.SS3.p4.2.m2.1.1.1.cmml">​</mo><mi id="S3.SS3.p4.2.m2.1.1.6" xref="S3.SS3.p4.2.m2.1.1.6.cmml">o</mi><mo lspace="0em" rspace="0em" id="S3.SS3.p4.2.m2.1.1.1d" xref="S3.SS3.p4.2.m2.1.1.1.cmml">​</mo><mi id="S3.SS3.p4.2.m2.1.1.7" xref="S3.SS3.p4.2.m2.1.1.7.cmml">i</mi><mo lspace="0em" rspace="0em" id="S3.SS3.p4.2.m2.1.1.1e" xref="S3.SS3.p4.2.m2.1.1.1.cmml">​</mo><mi id="S3.SS3.p4.2.m2.1.1.8" xref="S3.SS3.p4.2.m2.1.1.8.cmml">d</mi></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.p4.2.m2.1b"><apply id="S3.SS3.p4.2.m2.1.1.cmml" xref="S3.SS3.p4.2.m2.1.1"><times id="S3.SS3.p4.2.m2.1.1.1.cmml" xref="S3.SS3.p4.2.m2.1.1.1"></times><ci id="S3.SS3.p4.2.m2.1.1.2.cmml" xref="S3.SS3.p4.2.m2.1.1.2">𝑠</ci><ci id="S3.SS3.p4.2.m2.1.1.3.cmml" xref="S3.SS3.p4.2.m2.1.1.3">𝑖</ci><ci id="S3.SS3.p4.2.m2.1.1.4.cmml" xref="S3.SS3.p4.2.m2.1.1.4">𝑔</ci><ci id="S3.SS3.p4.2.m2.1.1.5.cmml" xref="S3.SS3.p4.2.m2.1.1.5">𝑚</ci><ci id="S3.SS3.p4.2.m2.1.1.6.cmml" xref="S3.SS3.p4.2.m2.1.1.6">𝑜</ci><ci id="S3.SS3.p4.2.m2.1.1.7.cmml" xref="S3.SS3.p4.2.m2.1.1.7">𝑖</ci><ci id="S3.SS3.p4.2.m2.1.1.8.cmml" xref="S3.SS3.p4.2.m2.1.1.8">𝑑</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p4.2.m2.1c">sigmoid</annotation></semantics></math> is the activation function of the model output, and the term <math id="S3.SS3.p4.3.m3.1" class="ltx_Math" alttext="g" display="inline"><semantics id="S3.SS3.p4.3.m3.1a"><mi id="S3.SS3.p4.3.m3.1.1" xref="S3.SS3.p4.3.m3.1.1.cmml">g</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.p4.3.m3.1b"><ci id="S3.SS3.p4.3.m3.1.1.cmml" xref="S3.SS3.p4.3.m3.1.1">𝑔</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p4.3.m3.1c">g</annotation></semantics></math> represents the mixing ratio of the expert models.
For details, the number of the input neurons of <math id="S3.SS3.p4.4.m4.1" class="ltx_Math" alttext="G" display="inline"><semantics id="S3.SS3.p4.4.m4.1a"><mi id="S3.SS3.p4.4.m4.1.1" xref="S3.SS3.p4.4.m4.1.1.cmml">G</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.p4.4.m4.1b"><ci id="S3.SS3.p4.4.m4.1.1.cmml" xref="S3.SS3.p4.4.m4.1.1">𝐺</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p4.4.m4.1c">G</annotation></semantics></math> is equal to the dimension of <math id="S3.SS3.p4.5.m5.1" class="ltx_Math" alttext="x" display="inline"><semantics id="S3.SS3.p4.5.m5.1a"><mi id="S3.SS3.p4.5.m5.1.1" xref="S3.SS3.p4.5.m5.1.1.cmml">x</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.p4.5.m5.1b"><ci id="S3.SS3.p4.5.m5.1.1.cmml" xref="S3.SS3.p4.5.m5.1.1">𝑥</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p4.5.m5.1c">x</annotation></semantics></math>, while the number of the output neurons of <math id="S3.SS3.p4.6.m6.1" class="ltx_Math" alttext="G" display="inline"><semantics id="S3.SS3.p4.6.m6.1a"><mi id="S3.SS3.p4.6.m6.1.1" xref="S3.SS3.p4.6.m6.1.1.cmml">G</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.p4.6.m6.1b"><ci id="S3.SS3.p4.6.m6.1.1.cmml" xref="S3.SS3.p4.6.m6.1.1">𝐺</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p4.6.m6.1c">G</annotation></semantics></math> is equal to the number of experts. Particularly, similar to Peterson et al. <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib8" title="" class="ltx_ref">8</a>]</cite>, we set the number of output neurons of <math id="S3.SS3.p4.7.m7.1" class="ltx_Math" alttext="G" display="inline"><semantics id="S3.SS3.p4.7.m7.1a"><mi id="S3.SS3.p4.7.m7.1.1" xref="S3.SS3.p4.7.m7.1.1.cmml">G</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.p4.7.m7.1b"><ci id="S3.SS3.p4.7.m7.1.1.cmml" xref="S3.SS3.p4.7.m7.1.1">𝐺</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p4.7.m7.1c">G</annotation></semantics></math> to 1, so that <math id="S3.SS3.p4.8.m8.1" class="ltx_Math" alttext="g" display="inline"><semantics id="S3.SS3.p4.8.m8.1a"><mi id="S3.SS3.p4.8.m8.1.1" xref="S3.SS3.p4.8.m8.1.1.cmml">g</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.p4.8.m8.1b"><ci id="S3.SS3.p4.8.m8.1.1.cmml" xref="S3.SS3.p4.8.m8.1.1">𝑔</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p4.8.m8.1c">g</annotation></semantics></math> is a 1-dimensional vector. At this setting, <math id="S3.SS3.p4.9.m9.1" class="ltx_Math" alttext="g" display="inline"><semantics id="S3.SS3.p4.9.m9.1a"><mi id="S3.SS3.p4.9.m9.1.1" xref="S3.SS3.p4.9.m9.1.1.cmml">g</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.p4.9.m9.1b"><ci id="S3.SS3.p4.9.m9.1.1.cmml" xref="S3.SS3.p4.9.m9.1.1">𝑔</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p4.9.m9.1c">g</annotation></semantics></math> is the weight of the global expert, while <math id="S3.SS3.p4.10.m10.1" class="ltx_Math" alttext="1-g" display="inline"><semantics id="S3.SS3.p4.10.m10.1a"><mrow id="S3.SS3.p4.10.m10.1.1" xref="S3.SS3.p4.10.m10.1.1.cmml"><mn id="S3.SS3.p4.10.m10.1.1.2" xref="S3.SS3.p4.10.m10.1.1.2.cmml">1</mn><mo id="S3.SS3.p4.10.m10.1.1.1" xref="S3.SS3.p4.10.m10.1.1.1.cmml">−</mo><mi id="S3.SS3.p4.10.m10.1.1.3" xref="S3.SS3.p4.10.m10.1.1.3.cmml">g</mi></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.p4.10.m10.1b"><apply id="S3.SS3.p4.10.m10.1.1.cmml" xref="S3.SS3.p4.10.m10.1.1"><minus id="S3.SS3.p4.10.m10.1.1.1.cmml" xref="S3.SS3.p4.10.m10.1.1.1"></minus><cn type="integer" id="S3.SS3.p4.10.m10.1.1.2.cmml" xref="S3.SS3.p4.10.m10.1.1.2">1</cn><ci id="S3.SS3.p4.10.m10.1.1.3.cmml" xref="S3.SS3.p4.10.m10.1.1.3">𝑔</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p4.10.m10.1c">1-g</annotation></semantics></math> is that of local expert. For the client <math id="S3.SS3.p4.11.m11.1" class="ltx_Math" alttext="i" display="inline"><semantics id="S3.SS3.p4.11.m11.1a"><mi id="S3.SS3.p4.11.m11.1.1" xref="S3.SS3.p4.11.m11.1.1.cmml">i</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.p4.11.m11.1b"><ci id="S3.SS3.p4.11.m11.1.1.cmml" xref="S3.SS3.p4.11.m11.1.1">𝑖</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p4.11.m11.1c">i</annotation></semantics></math>, to minimize <math id="S3.SS3.p4.12.m12.1" class="ltx_Math" alttext="p_{i}(w_{i})" display="inline"><semantics id="S3.SS3.p4.12.m12.1a"><mrow id="S3.SS3.p4.12.m12.1.1" xref="S3.SS3.p4.12.m12.1.1.cmml"><msub id="S3.SS3.p4.12.m12.1.1.3" xref="S3.SS3.p4.12.m12.1.1.3.cmml"><mi id="S3.SS3.p4.12.m12.1.1.3.2" xref="S3.SS3.p4.12.m12.1.1.3.2.cmml">p</mi><mi id="S3.SS3.p4.12.m12.1.1.3.3" xref="S3.SS3.p4.12.m12.1.1.3.3.cmml">i</mi></msub><mo lspace="0em" rspace="0em" id="S3.SS3.p4.12.m12.1.1.2" xref="S3.SS3.p4.12.m12.1.1.2.cmml">​</mo><mrow id="S3.SS3.p4.12.m12.1.1.1.1" xref="S3.SS3.p4.12.m12.1.1.1.1.1.cmml"><mo stretchy="false" id="S3.SS3.p4.12.m12.1.1.1.1.2" xref="S3.SS3.p4.12.m12.1.1.1.1.1.cmml">(</mo><msub id="S3.SS3.p4.12.m12.1.1.1.1.1" xref="S3.SS3.p4.12.m12.1.1.1.1.1.cmml"><mi id="S3.SS3.p4.12.m12.1.1.1.1.1.2" xref="S3.SS3.p4.12.m12.1.1.1.1.1.2.cmml">w</mi><mi id="S3.SS3.p4.12.m12.1.1.1.1.1.3" xref="S3.SS3.p4.12.m12.1.1.1.1.1.3.cmml">i</mi></msub><mo stretchy="false" id="S3.SS3.p4.12.m12.1.1.1.1.3" xref="S3.SS3.p4.12.m12.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.p4.12.m12.1b"><apply id="S3.SS3.p4.12.m12.1.1.cmml" xref="S3.SS3.p4.12.m12.1.1"><times id="S3.SS3.p4.12.m12.1.1.2.cmml" xref="S3.SS3.p4.12.m12.1.1.2"></times><apply id="S3.SS3.p4.12.m12.1.1.3.cmml" xref="S3.SS3.p4.12.m12.1.1.3"><csymbol cd="ambiguous" id="S3.SS3.p4.12.m12.1.1.3.1.cmml" xref="S3.SS3.p4.12.m12.1.1.3">subscript</csymbol><ci id="S3.SS3.p4.12.m12.1.1.3.2.cmml" xref="S3.SS3.p4.12.m12.1.1.3.2">𝑝</ci><ci id="S3.SS3.p4.12.m12.1.1.3.3.cmml" xref="S3.SS3.p4.12.m12.1.1.3.3">𝑖</ci></apply><apply id="S3.SS3.p4.12.m12.1.1.1.1.1.cmml" xref="S3.SS3.p4.12.m12.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS3.p4.12.m12.1.1.1.1.1.1.cmml" xref="S3.SS3.p4.12.m12.1.1.1.1">subscript</csymbol><ci id="S3.SS3.p4.12.m12.1.1.1.1.1.2.cmml" xref="S3.SS3.p4.12.m12.1.1.1.1.1.2">𝑤</ci><ci id="S3.SS3.p4.12.m12.1.1.1.1.1.3.cmml" xref="S3.SS3.p4.12.m12.1.1.1.1.1.3">𝑖</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p4.12.m12.1c">p_{i}(w_{i})</annotation></semantics></math>, the gating parameter <math id="S3.SS3.p4.13.m13.1" class="ltx_Math" alttext="w_{i}" display="inline"><semantics id="S3.SS3.p4.13.m13.1a"><msub id="S3.SS3.p4.13.m13.1.1" xref="S3.SS3.p4.13.m13.1.1.cmml"><mi id="S3.SS3.p4.13.m13.1.1.2" xref="S3.SS3.p4.13.m13.1.1.2.cmml">w</mi><mi id="S3.SS3.p4.13.m13.1.1.3" xref="S3.SS3.p4.13.m13.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS3.p4.13.m13.1b"><apply id="S3.SS3.p4.13.m13.1.1.cmml" xref="S3.SS3.p4.13.m13.1.1"><csymbol cd="ambiguous" id="S3.SS3.p4.13.m13.1.1.1.cmml" xref="S3.SS3.p4.13.m13.1.1">subscript</csymbol><ci id="S3.SS3.p4.13.m13.1.1.2.cmml" xref="S3.SS3.p4.13.m13.1.1.2">𝑤</ci><ci id="S3.SS3.p4.13.m13.1.1.3.cmml" xref="S3.SS3.p4.13.m13.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p4.13.m13.1c">w_{i}</annotation></semantics></math> can be updated using SGD:</p>
<table id="S3.E10" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S3.E10.m1.1" class="ltx_Math" alttext="w_{i}=w_{i}-\beta\cdot\triangledown{p_{i}(w_{i})}" display="block"><semantics id="S3.E10.m1.1a"><mrow id="S3.E10.m1.1.1" xref="S3.E10.m1.1.1.cmml"><msub id="S3.E10.m1.1.1.3" xref="S3.E10.m1.1.1.3.cmml"><mi id="S3.E10.m1.1.1.3.2" xref="S3.E10.m1.1.1.3.2.cmml">w</mi><mi id="S3.E10.m1.1.1.3.3" xref="S3.E10.m1.1.1.3.3.cmml">i</mi></msub><mo id="S3.E10.m1.1.1.2" xref="S3.E10.m1.1.1.2.cmml">=</mo><mrow id="S3.E10.m1.1.1.1" xref="S3.E10.m1.1.1.1.cmml"><msub id="S3.E10.m1.1.1.1.3" xref="S3.E10.m1.1.1.1.3.cmml"><mi id="S3.E10.m1.1.1.1.3.2" xref="S3.E10.m1.1.1.1.3.2.cmml">w</mi><mi id="S3.E10.m1.1.1.1.3.3" xref="S3.E10.m1.1.1.1.3.3.cmml">i</mi></msub><mo id="S3.E10.m1.1.1.1.2" xref="S3.E10.m1.1.1.1.2.cmml">−</mo><mrow id="S3.E10.m1.1.1.1.1" xref="S3.E10.m1.1.1.1.1.cmml"><mrow id="S3.E10.m1.1.1.1.1.3" xref="S3.E10.m1.1.1.1.1.3.cmml"><mi id="S3.E10.m1.1.1.1.1.3.2" xref="S3.E10.m1.1.1.1.1.3.2.cmml">β</mi><mo lspace="0.222em" rspace="0.222em" id="S3.E10.m1.1.1.1.1.3.1" xref="S3.E10.m1.1.1.1.1.3.1.cmml">⋅</mo><mi mathvariant="normal" id="S3.E10.m1.1.1.1.1.3.3" xref="S3.E10.m1.1.1.1.1.3.3.cmml">▽</mi></mrow><mo lspace="0em" rspace="0em" id="S3.E10.m1.1.1.1.1.2" xref="S3.E10.m1.1.1.1.1.2.cmml">​</mo><msub id="S3.E10.m1.1.1.1.1.4" xref="S3.E10.m1.1.1.1.1.4.cmml"><mi id="S3.E10.m1.1.1.1.1.4.2" xref="S3.E10.m1.1.1.1.1.4.2.cmml">p</mi><mi id="S3.E10.m1.1.1.1.1.4.3" xref="S3.E10.m1.1.1.1.1.4.3.cmml">i</mi></msub><mo lspace="0em" rspace="0em" id="S3.E10.m1.1.1.1.1.2a" xref="S3.E10.m1.1.1.1.1.2.cmml">​</mo><mrow id="S3.E10.m1.1.1.1.1.1.1" xref="S3.E10.m1.1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S3.E10.m1.1.1.1.1.1.1.2" xref="S3.E10.m1.1.1.1.1.1.1.1.cmml">(</mo><msub id="S3.E10.m1.1.1.1.1.1.1.1" xref="S3.E10.m1.1.1.1.1.1.1.1.cmml"><mi id="S3.E10.m1.1.1.1.1.1.1.1.2" xref="S3.E10.m1.1.1.1.1.1.1.1.2.cmml">w</mi><mi id="S3.E10.m1.1.1.1.1.1.1.1.3" xref="S3.E10.m1.1.1.1.1.1.1.1.3.cmml">i</mi></msub><mo stretchy="false" id="S3.E10.m1.1.1.1.1.1.1.3" xref="S3.E10.m1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.E10.m1.1b"><apply id="S3.E10.m1.1.1.cmml" xref="S3.E10.m1.1.1"><eq id="S3.E10.m1.1.1.2.cmml" xref="S3.E10.m1.1.1.2"></eq><apply id="S3.E10.m1.1.1.3.cmml" xref="S3.E10.m1.1.1.3"><csymbol cd="ambiguous" id="S3.E10.m1.1.1.3.1.cmml" xref="S3.E10.m1.1.1.3">subscript</csymbol><ci id="S3.E10.m1.1.1.3.2.cmml" xref="S3.E10.m1.1.1.3.2">𝑤</ci><ci id="S3.E10.m1.1.1.3.3.cmml" xref="S3.E10.m1.1.1.3.3">𝑖</ci></apply><apply id="S3.E10.m1.1.1.1.cmml" xref="S3.E10.m1.1.1.1"><minus id="S3.E10.m1.1.1.1.2.cmml" xref="S3.E10.m1.1.1.1.2"></minus><apply id="S3.E10.m1.1.1.1.3.cmml" xref="S3.E10.m1.1.1.1.3"><csymbol cd="ambiguous" id="S3.E10.m1.1.1.1.3.1.cmml" xref="S3.E10.m1.1.1.1.3">subscript</csymbol><ci id="S3.E10.m1.1.1.1.3.2.cmml" xref="S3.E10.m1.1.1.1.3.2">𝑤</ci><ci id="S3.E10.m1.1.1.1.3.3.cmml" xref="S3.E10.m1.1.1.1.3.3">𝑖</ci></apply><apply id="S3.E10.m1.1.1.1.1.cmml" xref="S3.E10.m1.1.1.1.1"><times id="S3.E10.m1.1.1.1.1.2.cmml" xref="S3.E10.m1.1.1.1.1.2"></times><apply id="S3.E10.m1.1.1.1.1.3.cmml" xref="S3.E10.m1.1.1.1.1.3"><ci id="S3.E10.m1.1.1.1.1.3.1.cmml" xref="S3.E10.m1.1.1.1.1.3.1">⋅</ci><ci id="S3.E10.m1.1.1.1.1.3.2.cmml" xref="S3.E10.m1.1.1.1.1.3.2">𝛽</ci><ci id="S3.E10.m1.1.1.1.1.3.3.cmml" xref="S3.E10.m1.1.1.1.1.3.3">▽</ci></apply><apply id="S3.E10.m1.1.1.1.1.4.cmml" xref="S3.E10.m1.1.1.1.1.4"><csymbol cd="ambiguous" id="S3.E10.m1.1.1.1.1.4.1.cmml" xref="S3.E10.m1.1.1.1.1.4">subscript</csymbol><ci id="S3.E10.m1.1.1.1.1.4.2.cmml" xref="S3.E10.m1.1.1.1.1.4.2">𝑝</ci><ci id="S3.E10.m1.1.1.1.1.4.3.cmml" xref="S3.E10.m1.1.1.1.1.4.3">𝑖</ci></apply><apply id="S3.E10.m1.1.1.1.1.1.1.1.cmml" xref="S3.E10.m1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E10.m1.1.1.1.1.1.1.1.1.cmml" xref="S3.E10.m1.1.1.1.1.1.1">subscript</csymbol><ci id="S3.E10.m1.1.1.1.1.1.1.1.2.cmml" xref="S3.E10.m1.1.1.1.1.1.1.1.2">𝑤</ci><ci id="S3.E10.m1.1.1.1.1.1.1.1.3.cmml" xref="S3.E10.m1.1.1.1.1.1.1.1.3">𝑖</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E10.m1.1c">w_{i}=w_{i}-\beta\cdot\triangledown{p_{i}(w_{i})}</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(10)</span></td>
</tr></tbody>
</table>
<p id="S3.SS3.p4.15" class="ltx_p">where the term <math id="S3.SS3.p4.14.m1.1" class="ltx_Math" alttext="\beta" display="inline"><semantics id="S3.SS3.p4.14.m1.1a"><mi id="S3.SS3.p4.14.m1.1.1" xref="S3.SS3.p4.14.m1.1.1.cmml">β</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.p4.14.m1.1b"><ci id="S3.SS3.p4.14.m1.1.1.cmml" xref="S3.SS3.p4.14.m1.1.1">𝛽</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p4.14.m1.1c">\beta</annotation></semantics></math> refers to the learning rate of <math id="S3.SS3.p4.15.m2.1" class="ltx_Math" alttext="w_{i}" display="inline"><semantics id="S3.SS3.p4.15.m2.1a"><msub id="S3.SS3.p4.15.m2.1.1" xref="S3.SS3.p4.15.m2.1.1.cmml"><mi id="S3.SS3.p4.15.m2.1.1.2" xref="S3.SS3.p4.15.m2.1.1.2.cmml">w</mi><mi id="S3.SS3.p4.15.m2.1.1.3" xref="S3.SS3.p4.15.m2.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS3.p4.15.m2.1b"><apply id="S3.SS3.p4.15.m2.1.1.cmml" xref="S3.SS3.p4.15.m2.1.1"><csymbol cd="ambiguous" id="S3.SS3.p4.15.m2.1.1.1.cmml" xref="S3.SS3.p4.15.m2.1.1">subscript</csymbol><ci id="S3.SS3.p4.15.m2.1.1.2.cmml" xref="S3.SS3.p4.15.m2.1.1.2">𝑤</ci><ci id="S3.SS3.p4.15.m2.1.1.3.cmml" xref="S3.SS3.p4.15.m2.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p4.15.m2.1c">w_{i}</annotation></semantics></math>. Alg.<a href="#alg1" title="Algorithm 1 ‣ III-C Mixing ‣ III PFL-MoE ‣ PFL-MoE: Personalized Federated Learning Based on Mixture of Experts" class="ltx_ref"><span class="ltx_text ltx_ref_tag">1</span></a> shows the details of the PFL-MoE.</p>
</div>
</section>
</section>
<section id="S4" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">IV </span><span id="S4.1.1" class="ltx_text ltx_font_smallcaps">PFL-MF and PFL-MFE</span>
</h2>

<div id="S4.p1" class="ltx_para">
<p id="S4.p1.1" class="ltx_p">PFL-FB <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib4" title="" class="ltx_ref">4</a>]</cite> is a local adaption PFL algorithm based on freeze-base that freezes the base layer of the federated model and fine-tunes only the top layers. PFL-FB has the most significant personalization effect on the comparison of several methods for adapting federated global model to individual client.</p>
</div>
<div id="S4.p2" class="ltx_para">
<p id="S4.p2.14" class="ltx_p">Following the three steps of PFL-MoE, we propose the PFL-MF algorithm by using the local expert generated by the PFL-FB algorithm.
PFL-FB is a variant of PFL-FT <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib5" title="" class="ltx_ref">5</a>]</cite>, where the global model structure <math id="S4.p2.1.m1.1" class="ltx_Math" alttext="M_{G}" display="inline"><semantics id="S4.p2.1.m1.1a"><msub id="S4.p2.1.m1.1.1" xref="S4.p2.1.m1.1.1.cmml"><mi id="S4.p2.1.m1.1.1.2" xref="S4.p2.1.m1.1.1.2.cmml">M</mi><mi id="S4.p2.1.m1.1.1.3" xref="S4.p2.1.m1.1.1.3.cmml">G</mi></msub><annotation-xml encoding="MathML-Content" id="S4.p2.1.m1.1b"><apply id="S4.p2.1.m1.1.1.cmml" xref="S4.p2.1.m1.1.1"><csymbol cd="ambiguous" id="S4.p2.1.m1.1.1.1.cmml" xref="S4.p2.1.m1.1.1">subscript</csymbol><ci id="S4.p2.1.m1.1.1.2.cmml" xref="S4.p2.1.m1.1.1.2">𝑀</ci><ci id="S4.p2.1.m1.1.1.3.cmml" xref="S4.p2.1.m1.1.1.3">𝐺</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.p2.1.m1.1c">M_{G}</annotation></semantics></math> is divided into two parts: feature extractor <math id="S4.p2.2.m2.1" class="ltx_Math" alttext="M_{E}" display="inline"><semantics id="S4.p2.2.m2.1a"><msub id="S4.p2.2.m2.1.1" xref="S4.p2.2.m2.1.1.cmml"><mi id="S4.p2.2.m2.1.1.2" xref="S4.p2.2.m2.1.1.2.cmml">M</mi><mi id="S4.p2.2.m2.1.1.3" xref="S4.p2.2.m2.1.1.3.cmml">E</mi></msub><annotation-xml encoding="MathML-Content" id="S4.p2.2.m2.1b"><apply id="S4.p2.2.m2.1.1.cmml" xref="S4.p2.2.m2.1.1"><csymbol cd="ambiguous" id="S4.p2.2.m2.1.1.1.cmml" xref="S4.p2.2.m2.1.1">subscript</csymbol><ci id="S4.p2.2.m2.1.1.2.cmml" xref="S4.p2.2.m2.1.1.2">𝑀</ci><ci id="S4.p2.2.m2.1.1.3.cmml" xref="S4.p2.2.m2.1.1.3">𝐸</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.p2.2.m2.1c">M_{E}</annotation></semantics></math> and classifier <math id="S4.p2.3.m3.1" class="ltx_Math" alttext="M_{C}" display="inline"><semantics id="S4.p2.3.m3.1a"><msub id="S4.p2.3.m3.1.1" xref="S4.p2.3.m3.1.1.cmml"><mi id="S4.p2.3.m3.1.1.2" xref="S4.p2.3.m3.1.1.2.cmml">M</mi><mi id="S4.p2.3.m3.1.1.3" xref="S4.p2.3.m3.1.1.3.cmml">C</mi></msub><annotation-xml encoding="MathML-Content" id="S4.p2.3.m3.1b"><apply id="S4.p2.3.m3.1.1.cmml" xref="S4.p2.3.m3.1.1"><csymbol cd="ambiguous" id="S4.p2.3.m3.1.1.1.cmml" xref="S4.p2.3.m3.1.1">subscript</csymbol><ci id="S4.p2.3.m3.1.1.2.cmml" xref="S4.p2.3.m3.1.1.2">𝑀</ci><ci id="S4.p2.3.m3.1.1.3.cmml" xref="S4.p2.3.m3.1.1.3">𝐶</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.p2.3.m3.1c">M_{C}</annotation></semantics></math>.
We define <math id="S4.p2.4.m4.1" class="ltx_Math" alttext="\theta_{E}" display="inline"><semantics id="S4.p2.4.m4.1a"><msub id="S4.p2.4.m4.1.1" xref="S4.p2.4.m4.1.1.cmml"><mi id="S4.p2.4.m4.1.1.2" xref="S4.p2.4.m4.1.1.2.cmml">θ</mi><mi id="S4.p2.4.m4.1.1.3" xref="S4.p2.4.m4.1.1.3.cmml">E</mi></msub><annotation-xml encoding="MathML-Content" id="S4.p2.4.m4.1b"><apply id="S4.p2.4.m4.1.1.cmml" xref="S4.p2.4.m4.1.1"><csymbol cd="ambiguous" id="S4.p2.4.m4.1.1.1.cmml" xref="S4.p2.4.m4.1.1">subscript</csymbol><ci id="S4.p2.4.m4.1.1.2.cmml" xref="S4.p2.4.m4.1.1.2">𝜃</ci><ci id="S4.p2.4.m4.1.1.3.cmml" xref="S4.p2.4.m4.1.1.3">𝐸</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.p2.4.m4.1c">\theta_{E}</annotation></semantics></math> and <math id="S4.p2.5.m5.1" class="ltx_Math" alttext="\theta_{C}" display="inline"><semantics id="S4.p2.5.m5.1a"><msub id="S4.p2.5.m5.1.1" xref="S4.p2.5.m5.1.1.cmml"><mi id="S4.p2.5.m5.1.1.2" xref="S4.p2.5.m5.1.1.2.cmml">θ</mi><mi id="S4.p2.5.m5.1.1.3" xref="S4.p2.5.m5.1.1.3.cmml">C</mi></msub><annotation-xml encoding="MathML-Content" id="S4.p2.5.m5.1b"><apply id="S4.p2.5.m5.1.1.cmml" xref="S4.p2.5.m5.1.1"><csymbol cd="ambiguous" id="S4.p2.5.m5.1.1.1.cmml" xref="S4.p2.5.m5.1.1">subscript</csymbol><ci id="S4.p2.5.m5.1.1.2.cmml" xref="S4.p2.5.m5.1.1.2">𝜃</ci><ci id="S4.p2.5.m5.1.1.3.cmml" xref="S4.p2.5.m5.1.1.3">𝐶</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.p2.5.m5.1c">\theta_{C}</annotation></semantics></math> as the parameter of <math id="S4.p2.6.m6.1" class="ltx_Math" alttext="M_{E}" display="inline"><semantics id="S4.p2.6.m6.1a"><msub id="S4.p2.6.m6.1.1" xref="S4.p2.6.m6.1.1.cmml"><mi id="S4.p2.6.m6.1.1.2" xref="S4.p2.6.m6.1.1.2.cmml">M</mi><mi id="S4.p2.6.m6.1.1.3" xref="S4.p2.6.m6.1.1.3.cmml">E</mi></msub><annotation-xml encoding="MathML-Content" id="S4.p2.6.m6.1b"><apply id="S4.p2.6.m6.1.1.cmml" xref="S4.p2.6.m6.1.1"><csymbol cd="ambiguous" id="S4.p2.6.m6.1.1.1.cmml" xref="S4.p2.6.m6.1.1">subscript</csymbol><ci id="S4.p2.6.m6.1.1.2.cmml" xref="S4.p2.6.m6.1.1.2">𝑀</ci><ci id="S4.p2.6.m6.1.1.3.cmml" xref="S4.p2.6.m6.1.1.3">𝐸</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.p2.6.m6.1c">M_{E}</annotation></semantics></math> and <math id="S4.p2.7.m7.1" class="ltx_Math" alttext="M_{C}" display="inline"><semantics id="S4.p2.7.m7.1a"><msub id="S4.p2.7.m7.1.1" xref="S4.p2.7.m7.1.1.cmml"><mi id="S4.p2.7.m7.1.1.2" xref="S4.p2.7.m7.1.1.2.cmml">M</mi><mi id="S4.p2.7.m7.1.1.3" xref="S4.p2.7.m7.1.1.3.cmml">C</mi></msub><annotation-xml encoding="MathML-Content" id="S4.p2.7.m7.1b"><apply id="S4.p2.7.m7.1.1.cmml" xref="S4.p2.7.m7.1.1"><csymbol cd="ambiguous" id="S4.p2.7.m7.1.1.1.cmml" xref="S4.p2.7.m7.1.1">subscript</csymbol><ci id="S4.p2.7.m7.1.1.2.cmml" xref="S4.p2.7.m7.1.1.2">𝑀</ci><ci id="S4.p2.7.m7.1.1.3.cmml" xref="S4.p2.7.m7.1.1.3">𝐶</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.p2.7.m7.1c">M_{C}</annotation></semantics></math> respectively. In PFL-MF, assume that the <math id="S4.p2.8.m8.1" class="ltx_Math" alttext="\theta" display="inline"><semantics id="S4.p2.8.m8.1a"><mi id="S4.p2.8.m8.1.1" xref="S4.p2.8.m8.1.1.cmml">θ</mi><annotation-xml encoding="MathML-Content" id="S4.p2.8.m8.1b"><ci id="S4.p2.8.m8.1.1.cmml" xref="S4.p2.8.m8.1.1">𝜃</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.p2.8.m8.1c">\theta</annotation></semantics></math> is the parameter of global model, for client <math id="S4.p2.9.m9.1" class="ltx_Math" alttext="i" display="inline"><semantics id="S4.p2.9.m9.1a"><mi id="S4.p2.9.m9.1.1" xref="S4.p2.9.m9.1.1.cmml">i</mi><annotation-xml encoding="MathML-Content" id="S4.p2.9.m9.1b"><ci id="S4.p2.9.m9.1.1.cmml" xref="S4.p2.9.m9.1.1">𝑖</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.p2.9.m9.1c">i</annotation></semantics></math>, <math id="S4.p2.10.m10.2" class="ltx_Math" alttext="(\theta_{E},\theta_{C_{i}})" display="inline"><semantics id="S4.p2.10.m10.2a"><mrow id="S4.p2.10.m10.2.2.2" xref="S4.p2.10.m10.2.2.3.cmml"><mo stretchy="false" id="S4.p2.10.m10.2.2.2.3" xref="S4.p2.10.m10.2.2.3.cmml">(</mo><msub id="S4.p2.10.m10.1.1.1.1" xref="S4.p2.10.m10.1.1.1.1.cmml"><mi id="S4.p2.10.m10.1.1.1.1.2" xref="S4.p2.10.m10.1.1.1.1.2.cmml">θ</mi><mi id="S4.p2.10.m10.1.1.1.1.3" xref="S4.p2.10.m10.1.1.1.1.3.cmml">E</mi></msub><mo id="S4.p2.10.m10.2.2.2.4" xref="S4.p2.10.m10.2.2.3.cmml">,</mo><msub id="S4.p2.10.m10.2.2.2.2" xref="S4.p2.10.m10.2.2.2.2.cmml"><mi id="S4.p2.10.m10.2.2.2.2.2" xref="S4.p2.10.m10.2.2.2.2.2.cmml">θ</mi><msub id="S4.p2.10.m10.2.2.2.2.3" xref="S4.p2.10.m10.2.2.2.2.3.cmml"><mi id="S4.p2.10.m10.2.2.2.2.3.2" xref="S4.p2.10.m10.2.2.2.2.3.2.cmml">C</mi><mi id="S4.p2.10.m10.2.2.2.2.3.3" xref="S4.p2.10.m10.2.2.2.2.3.3.cmml">i</mi></msub></msub><mo stretchy="false" id="S4.p2.10.m10.2.2.2.5" xref="S4.p2.10.m10.2.2.3.cmml">)</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.p2.10.m10.2b"><interval closure="open" id="S4.p2.10.m10.2.2.3.cmml" xref="S4.p2.10.m10.2.2.2"><apply id="S4.p2.10.m10.1.1.1.1.cmml" xref="S4.p2.10.m10.1.1.1.1"><csymbol cd="ambiguous" id="S4.p2.10.m10.1.1.1.1.1.cmml" xref="S4.p2.10.m10.1.1.1.1">subscript</csymbol><ci id="S4.p2.10.m10.1.1.1.1.2.cmml" xref="S4.p2.10.m10.1.1.1.1.2">𝜃</ci><ci id="S4.p2.10.m10.1.1.1.1.3.cmml" xref="S4.p2.10.m10.1.1.1.1.3">𝐸</ci></apply><apply id="S4.p2.10.m10.2.2.2.2.cmml" xref="S4.p2.10.m10.2.2.2.2"><csymbol cd="ambiguous" id="S4.p2.10.m10.2.2.2.2.1.cmml" xref="S4.p2.10.m10.2.2.2.2">subscript</csymbol><ci id="S4.p2.10.m10.2.2.2.2.2.cmml" xref="S4.p2.10.m10.2.2.2.2.2">𝜃</ci><apply id="S4.p2.10.m10.2.2.2.2.3.cmml" xref="S4.p2.10.m10.2.2.2.2.3"><csymbol cd="ambiguous" id="S4.p2.10.m10.2.2.2.2.3.1.cmml" xref="S4.p2.10.m10.2.2.2.2.3">subscript</csymbol><ci id="S4.p2.10.m10.2.2.2.2.3.2.cmml" xref="S4.p2.10.m10.2.2.2.2.3.2">𝐶</ci><ci id="S4.p2.10.m10.2.2.2.2.3.3.cmml" xref="S4.p2.10.m10.2.2.2.2.3.3">𝑖</ci></apply></apply></interval></annotation-xml><annotation encoding="application/x-tex" id="S4.p2.10.m10.2c">(\theta_{E},\theta_{C_{i}})</annotation></semantics></math> is initialized with <math id="S4.p2.11.m11.1" class="ltx_Math" alttext="\theta" display="inline"><semantics id="S4.p2.11.m11.1a"><mi id="S4.p2.11.m11.1.1" xref="S4.p2.11.m11.1.1.cmml">θ</mi><annotation-xml encoding="MathML-Content" id="S4.p2.11.m11.1b"><ci id="S4.p2.11.m11.1.1.cmml" xref="S4.p2.11.m11.1.1">𝜃</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.p2.11.m11.1c">\theta</annotation></semantics></math>, where the term <math id="S4.p2.12.m12.1" class="ltx_Math" alttext="\theta_{C_{i}}" display="inline"><semantics id="S4.p2.12.m12.1a"><msub id="S4.p2.12.m12.1.1" xref="S4.p2.12.m12.1.1.cmml"><mi id="S4.p2.12.m12.1.1.2" xref="S4.p2.12.m12.1.1.2.cmml">θ</mi><msub id="S4.p2.12.m12.1.1.3" xref="S4.p2.12.m12.1.1.3.cmml"><mi id="S4.p2.12.m12.1.1.3.2" xref="S4.p2.12.m12.1.1.3.2.cmml">C</mi><mi id="S4.p2.12.m12.1.1.3.3" xref="S4.p2.12.m12.1.1.3.3.cmml">i</mi></msub></msub><annotation-xml encoding="MathML-Content" id="S4.p2.12.m12.1b"><apply id="S4.p2.12.m12.1.1.cmml" xref="S4.p2.12.m12.1.1"><csymbol cd="ambiguous" id="S4.p2.12.m12.1.1.1.cmml" xref="S4.p2.12.m12.1.1">subscript</csymbol><ci id="S4.p2.12.m12.1.1.2.cmml" xref="S4.p2.12.m12.1.1.2">𝜃</ci><apply id="S4.p2.12.m12.1.1.3.cmml" xref="S4.p2.12.m12.1.1.3"><csymbol cd="ambiguous" id="S4.p2.12.m12.1.1.3.1.cmml" xref="S4.p2.12.m12.1.1.3">subscript</csymbol><ci id="S4.p2.12.m12.1.1.3.2.cmml" xref="S4.p2.12.m12.1.1.3.2">𝐶</ci><ci id="S4.p2.12.m12.1.1.3.3.cmml" xref="S4.p2.12.m12.1.1.3.3">𝑖</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.p2.12.m12.1c">\theta_{C_{i}}</annotation></semantics></math> is the personalized classifier parameter of the client and the <math id="S4.p2.13.m13.1" class="ltx_Math" alttext="\theta_{E}" display="inline"><semantics id="S4.p2.13.m13.1a"><msub id="S4.p2.13.m13.1.1" xref="S4.p2.13.m13.1.1.cmml"><mi id="S4.p2.13.m13.1.1.2" xref="S4.p2.13.m13.1.1.2.cmml">θ</mi><mi id="S4.p2.13.m13.1.1.3" xref="S4.p2.13.m13.1.1.3.cmml">E</mi></msub><annotation-xml encoding="MathML-Content" id="S4.p2.13.m13.1b"><apply id="S4.p2.13.m13.1.1.cmml" xref="S4.p2.13.m13.1.1"><csymbol cd="ambiguous" id="S4.p2.13.m13.1.1.1.cmml" xref="S4.p2.13.m13.1.1">subscript</csymbol><ci id="S4.p2.13.m13.1.1.2.cmml" xref="S4.p2.13.m13.1.1.2">𝜃</ci><ci id="S4.p2.13.m13.1.1.3.cmml" xref="S4.p2.13.m13.1.1.3">𝐸</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.p2.13.m13.1c">\theta_{E}</annotation></semantics></math> is shared to all clients.
In personalization stage, the <math id="S4.p2.14.m14.1" class="ltx_Math" alttext="\theta_{C_{i}}" display="inline"><semantics id="S4.p2.14.m14.1a"><msub id="S4.p2.14.m14.1.1" xref="S4.p2.14.m14.1.1.cmml"><mi id="S4.p2.14.m14.1.1.2" xref="S4.p2.14.m14.1.1.2.cmml">θ</mi><msub id="S4.p2.14.m14.1.1.3" xref="S4.p2.14.m14.1.1.3.cmml"><mi id="S4.p2.14.m14.1.1.3.2" xref="S4.p2.14.m14.1.1.3.2.cmml">C</mi><mi id="S4.p2.14.m14.1.1.3.3" xref="S4.p2.14.m14.1.1.3.3.cmml">i</mi></msub></msub><annotation-xml encoding="MathML-Content" id="S4.p2.14.m14.1b"><apply id="S4.p2.14.m14.1.1.cmml" xref="S4.p2.14.m14.1.1"><csymbol cd="ambiguous" id="S4.p2.14.m14.1.1.1.cmml" xref="S4.p2.14.m14.1.1">subscript</csymbol><ci id="S4.p2.14.m14.1.1.2.cmml" xref="S4.p2.14.m14.1.1.2">𝜃</ci><apply id="S4.p2.14.m14.1.1.3.cmml" xref="S4.p2.14.m14.1.1.3"><csymbol cd="ambiguous" id="S4.p2.14.m14.1.1.3.1.cmml" xref="S4.p2.14.m14.1.1.3">subscript</csymbol><ci id="S4.p2.14.m14.1.1.3.2.cmml" xref="S4.p2.14.m14.1.1.3.2">𝐶</ci><ci id="S4.p2.14.m14.1.1.3.3.cmml" xref="S4.p2.14.m14.1.1.3.3">𝑖</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.p2.14.m14.1c">\theta_{C_{i}}</annotation></semantics></math> is updated by:</p>
</div>
<div id="S4.p3" class="ltx_para">
<table id="S4.E11" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S4.E11.m1.2" class="ltx_Math" alttext="\theta_{C_{i}}=\theta_{C_{i}}-\alpha\cdot\triangledown{f_{i}(\theta_{E},\theta_{C_{i}})}" display="block"><semantics id="S4.E11.m1.2a"><mrow id="S4.E11.m1.2.2" xref="S4.E11.m1.2.2.cmml"><msub id="S4.E11.m1.2.2.4" xref="S4.E11.m1.2.2.4.cmml"><mi id="S4.E11.m1.2.2.4.2" xref="S4.E11.m1.2.2.4.2.cmml">θ</mi><msub id="S4.E11.m1.2.2.4.3" xref="S4.E11.m1.2.2.4.3.cmml"><mi id="S4.E11.m1.2.2.4.3.2" xref="S4.E11.m1.2.2.4.3.2.cmml">C</mi><mi id="S4.E11.m1.2.2.4.3.3" xref="S4.E11.m1.2.2.4.3.3.cmml">i</mi></msub></msub><mo id="S4.E11.m1.2.2.3" xref="S4.E11.m1.2.2.3.cmml">=</mo><mrow id="S4.E11.m1.2.2.2" xref="S4.E11.m1.2.2.2.cmml"><msub id="S4.E11.m1.2.2.2.4" xref="S4.E11.m1.2.2.2.4.cmml"><mi id="S4.E11.m1.2.2.2.4.2" xref="S4.E11.m1.2.2.2.4.2.cmml">θ</mi><msub id="S4.E11.m1.2.2.2.4.3" xref="S4.E11.m1.2.2.2.4.3.cmml"><mi id="S4.E11.m1.2.2.2.4.3.2" xref="S4.E11.m1.2.2.2.4.3.2.cmml">C</mi><mi id="S4.E11.m1.2.2.2.4.3.3" xref="S4.E11.m1.2.2.2.4.3.3.cmml">i</mi></msub></msub><mo id="S4.E11.m1.2.2.2.3" xref="S4.E11.m1.2.2.2.3.cmml">−</mo><mrow id="S4.E11.m1.2.2.2.2" xref="S4.E11.m1.2.2.2.2.cmml"><mrow id="S4.E11.m1.2.2.2.2.4" xref="S4.E11.m1.2.2.2.2.4.cmml"><mi id="S4.E11.m1.2.2.2.2.4.2" xref="S4.E11.m1.2.2.2.2.4.2.cmml">α</mi><mo lspace="0.222em" rspace="0.222em" id="S4.E11.m1.2.2.2.2.4.1" xref="S4.E11.m1.2.2.2.2.4.1.cmml">⋅</mo><mi mathvariant="normal" id="S4.E11.m1.2.2.2.2.4.3" xref="S4.E11.m1.2.2.2.2.4.3.cmml">▽</mi></mrow><mo lspace="0em" rspace="0em" id="S4.E11.m1.2.2.2.2.3" xref="S4.E11.m1.2.2.2.2.3.cmml">​</mo><msub id="S4.E11.m1.2.2.2.2.5" xref="S4.E11.m1.2.2.2.2.5.cmml"><mi id="S4.E11.m1.2.2.2.2.5.2" xref="S4.E11.m1.2.2.2.2.5.2.cmml">f</mi><mi id="S4.E11.m1.2.2.2.2.5.3" xref="S4.E11.m1.2.2.2.2.5.3.cmml">i</mi></msub><mo lspace="0em" rspace="0em" id="S4.E11.m1.2.2.2.2.3a" xref="S4.E11.m1.2.2.2.2.3.cmml">​</mo><mrow id="S4.E11.m1.2.2.2.2.2.2" xref="S4.E11.m1.2.2.2.2.2.3.cmml"><mo stretchy="false" id="S4.E11.m1.2.2.2.2.2.2.3" xref="S4.E11.m1.2.2.2.2.2.3.cmml">(</mo><msub id="S4.E11.m1.1.1.1.1.1.1.1" xref="S4.E11.m1.1.1.1.1.1.1.1.cmml"><mi id="S4.E11.m1.1.1.1.1.1.1.1.2" xref="S4.E11.m1.1.1.1.1.1.1.1.2.cmml">θ</mi><mi id="S4.E11.m1.1.1.1.1.1.1.1.3" xref="S4.E11.m1.1.1.1.1.1.1.1.3.cmml">E</mi></msub><mo id="S4.E11.m1.2.2.2.2.2.2.4" xref="S4.E11.m1.2.2.2.2.2.3.cmml">,</mo><msub id="S4.E11.m1.2.2.2.2.2.2.2" xref="S4.E11.m1.2.2.2.2.2.2.2.cmml"><mi id="S4.E11.m1.2.2.2.2.2.2.2.2" xref="S4.E11.m1.2.2.2.2.2.2.2.2.cmml">θ</mi><msub id="S4.E11.m1.2.2.2.2.2.2.2.3" xref="S4.E11.m1.2.2.2.2.2.2.2.3.cmml"><mi id="S4.E11.m1.2.2.2.2.2.2.2.3.2" xref="S4.E11.m1.2.2.2.2.2.2.2.3.2.cmml">C</mi><mi id="S4.E11.m1.2.2.2.2.2.2.2.3.3" xref="S4.E11.m1.2.2.2.2.2.2.2.3.3.cmml">i</mi></msub></msub><mo stretchy="false" id="S4.E11.m1.2.2.2.2.2.2.5" xref="S4.E11.m1.2.2.2.2.2.3.cmml">)</mo></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.E11.m1.2b"><apply id="S4.E11.m1.2.2.cmml" xref="S4.E11.m1.2.2"><eq id="S4.E11.m1.2.2.3.cmml" xref="S4.E11.m1.2.2.3"></eq><apply id="S4.E11.m1.2.2.4.cmml" xref="S4.E11.m1.2.2.4"><csymbol cd="ambiguous" id="S4.E11.m1.2.2.4.1.cmml" xref="S4.E11.m1.2.2.4">subscript</csymbol><ci id="S4.E11.m1.2.2.4.2.cmml" xref="S4.E11.m1.2.2.4.2">𝜃</ci><apply id="S4.E11.m1.2.2.4.3.cmml" xref="S4.E11.m1.2.2.4.3"><csymbol cd="ambiguous" id="S4.E11.m1.2.2.4.3.1.cmml" xref="S4.E11.m1.2.2.4.3">subscript</csymbol><ci id="S4.E11.m1.2.2.4.3.2.cmml" xref="S4.E11.m1.2.2.4.3.2">𝐶</ci><ci id="S4.E11.m1.2.2.4.3.3.cmml" xref="S4.E11.m1.2.2.4.3.3">𝑖</ci></apply></apply><apply id="S4.E11.m1.2.2.2.cmml" xref="S4.E11.m1.2.2.2"><minus id="S4.E11.m1.2.2.2.3.cmml" xref="S4.E11.m1.2.2.2.3"></minus><apply id="S4.E11.m1.2.2.2.4.cmml" xref="S4.E11.m1.2.2.2.4"><csymbol cd="ambiguous" id="S4.E11.m1.2.2.2.4.1.cmml" xref="S4.E11.m1.2.2.2.4">subscript</csymbol><ci id="S4.E11.m1.2.2.2.4.2.cmml" xref="S4.E11.m1.2.2.2.4.2">𝜃</ci><apply id="S4.E11.m1.2.2.2.4.3.cmml" xref="S4.E11.m1.2.2.2.4.3"><csymbol cd="ambiguous" id="S4.E11.m1.2.2.2.4.3.1.cmml" xref="S4.E11.m1.2.2.2.4.3">subscript</csymbol><ci id="S4.E11.m1.2.2.2.4.3.2.cmml" xref="S4.E11.m1.2.2.2.4.3.2">𝐶</ci><ci id="S4.E11.m1.2.2.2.4.3.3.cmml" xref="S4.E11.m1.2.2.2.4.3.3">𝑖</ci></apply></apply><apply id="S4.E11.m1.2.2.2.2.cmml" xref="S4.E11.m1.2.2.2.2"><times id="S4.E11.m1.2.2.2.2.3.cmml" xref="S4.E11.m1.2.2.2.2.3"></times><apply id="S4.E11.m1.2.2.2.2.4.cmml" xref="S4.E11.m1.2.2.2.2.4"><ci id="S4.E11.m1.2.2.2.2.4.1.cmml" xref="S4.E11.m1.2.2.2.2.4.1">⋅</ci><ci id="S4.E11.m1.2.2.2.2.4.2.cmml" xref="S4.E11.m1.2.2.2.2.4.2">𝛼</ci><ci id="S4.E11.m1.2.2.2.2.4.3.cmml" xref="S4.E11.m1.2.2.2.2.4.3">▽</ci></apply><apply id="S4.E11.m1.2.2.2.2.5.cmml" xref="S4.E11.m1.2.2.2.2.5"><csymbol cd="ambiguous" id="S4.E11.m1.2.2.2.2.5.1.cmml" xref="S4.E11.m1.2.2.2.2.5">subscript</csymbol><ci id="S4.E11.m1.2.2.2.2.5.2.cmml" xref="S4.E11.m1.2.2.2.2.5.2">𝑓</ci><ci id="S4.E11.m1.2.2.2.2.5.3.cmml" xref="S4.E11.m1.2.2.2.2.5.3">𝑖</ci></apply><interval closure="open" id="S4.E11.m1.2.2.2.2.2.3.cmml" xref="S4.E11.m1.2.2.2.2.2.2"><apply id="S4.E11.m1.1.1.1.1.1.1.1.cmml" xref="S4.E11.m1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.E11.m1.1.1.1.1.1.1.1.1.cmml" xref="S4.E11.m1.1.1.1.1.1.1.1">subscript</csymbol><ci id="S4.E11.m1.1.1.1.1.1.1.1.2.cmml" xref="S4.E11.m1.1.1.1.1.1.1.1.2">𝜃</ci><ci id="S4.E11.m1.1.1.1.1.1.1.1.3.cmml" xref="S4.E11.m1.1.1.1.1.1.1.1.3">𝐸</ci></apply><apply id="S4.E11.m1.2.2.2.2.2.2.2.cmml" xref="S4.E11.m1.2.2.2.2.2.2.2"><csymbol cd="ambiguous" id="S4.E11.m1.2.2.2.2.2.2.2.1.cmml" xref="S4.E11.m1.2.2.2.2.2.2.2">subscript</csymbol><ci id="S4.E11.m1.2.2.2.2.2.2.2.2.cmml" xref="S4.E11.m1.2.2.2.2.2.2.2.2">𝜃</ci><apply id="S4.E11.m1.2.2.2.2.2.2.2.3.cmml" xref="S4.E11.m1.2.2.2.2.2.2.2.3"><csymbol cd="ambiguous" id="S4.E11.m1.2.2.2.2.2.2.2.3.1.cmml" xref="S4.E11.m1.2.2.2.2.2.2.2.3">subscript</csymbol><ci id="S4.E11.m1.2.2.2.2.2.2.2.3.2.cmml" xref="S4.E11.m1.2.2.2.2.2.2.2.3.2">𝐶</ci><ci id="S4.E11.m1.2.2.2.2.2.2.2.3.3.cmml" xref="S4.E11.m1.2.2.2.2.2.2.2.3.3">𝑖</ci></apply></apply></interval></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.E11.m1.2c">\theta_{C_{i}}=\theta_{C_{i}}-\alpha\cdot\triangledown{f_{i}(\theta_{E},\theta_{C_{i}})}</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(11)</span></td>
</tr></tbody>
</table>
</div>
<div id="S4.p4" class="ltx_para">
<table id="S4.E12" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S4.E12.m1.7" class="ltx_Math" alttext="f_{i}(\theta_{E},\theta_{C_{i}})=\mathbb{E}_{(x,y)\sim\mathcal{D}_{i}}[L_{i}(\widehat{y},y)]" display="block"><semantics id="S4.E12.m1.7a"><mrow id="S4.E12.m1.7.7" xref="S4.E12.m1.7.7.cmml"><mrow id="S4.E12.m1.6.6.2" xref="S4.E12.m1.6.6.2.cmml"><msub id="S4.E12.m1.6.6.2.4" xref="S4.E12.m1.6.6.2.4.cmml"><mi id="S4.E12.m1.6.6.2.4.2" xref="S4.E12.m1.6.6.2.4.2.cmml">f</mi><mi id="S4.E12.m1.6.6.2.4.3" xref="S4.E12.m1.6.6.2.4.3.cmml">i</mi></msub><mo lspace="0em" rspace="0em" id="S4.E12.m1.6.6.2.3" xref="S4.E12.m1.6.6.2.3.cmml">​</mo><mrow id="S4.E12.m1.6.6.2.2.2" xref="S4.E12.m1.6.6.2.2.3.cmml"><mo stretchy="false" id="S4.E12.m1.6.6.2.2.2.3" xref="S4.E12.m1.6.6.2.2.3.cmml">(</mo><msub id="S4.E12.m1.5.5.1.1.1.1" xref="S4.E12.m1.5.5.1.1.1.1.cmml"><mi id="S4.E12.m1.5.5.1.1.1.1.2" xref="S4.E12.m1.5.5.1.1.1.1.2.cmml">θ</mi><mi id="S4.E12.m1.5.5.1.1.1.1.3" xref="S4.E12.m1.5.5.1.1.1.1.3.cmml">E</mi></msub><mo id="S4.E12.m1.6.6.2.2.2.4" xref="S4.E12.m1.6.6.2.2.3.cmml">,</mo><msub id="S4.E12.m1.6.6.2.2.2.2" xref="S4.E12.m1.6.6.2.2.2.2.cmml"><mi id="S4.E12.m1.6.6.2.2.2.2.2" xref="S4.E12.m1.6.6.2.2.2.2.2.cmml">θ</mi><msub id="S4.E12.m1.6.6.2.2.2.2.3" xref="S4.E12.m1.6.6.2.2.2.2.3.cmml"><mi id="S4.E12.m1.6.6.2.2.2.2.3.2" xref="S4.E12.m1.6.6.2.2.2.2.3.2.cmml">C</mi><mi id="S4.E12.m1.6.6.2.2.2.2.3.3" xref="S4.E12.m1.6.6.2.2.2.2.3.3.cmml">i</mi></msub></msub><mo stretchy="false" id="S4.E12.m1.6.6.2.2.2.5" xref="S4.E12.m1.6.6.2.2.3.cmml">)</mo></mrow></mrow><mo id="S4.E12.m1.7.7.4" xref="S4.E12.m1.7.7.4.cmml">=</mo><mrow id="S4.E12.m1.7.7.3" xref="S4.E12.m1.7.7.3.cmml"><msub id="S4.E12.m1.7.7.3.3" xref="S4.E12.m1.7.7.3.3.cmml"><mi id="S4.E12.m1.7.7.3.3.2" xref="S4.E12.m1.7.7.3.3.2.cmml">𝔼</mi><mrow id="S4.E12.m1.2.2.2" xref="S4.E12.m1.2.2.2.cmml"><mrow id="S4.E12.m1.2.2.2.4.2" xref="S4.E12.m1.2.2.2.4.1.cmml"><mo stretchy="false" id="S4.E12.m1.2.2.2.4.2.1" xref="S4.E12.m1.2.2.2.4.1.cmml">(</mo><mi id="S4.E12.m1.1.1.1.1" xref="S4.E12.m1.1.1.1.1.cmml">x</mi><mo id="S4.E12.m1.2.2.2.4.2.2" xref="S4.E12.m1.2.2.2.4.1.cmml">,</mo><mi id="S4.E12.m1.2.2.2.2" xref="S4.E12.m1.2.2.2.2.cmml">y</mi><mo stretchy="false" id="S4.E12.m1.2.2.2.4.2.3" xref="S4.E12.m1.2.2.2.4.1.cmml">)</mo></mrow><mo id="S4.E12.m1.2.2.2.3" xref="S4.E12.m1.2.2.2.3.cmml">∼</mo><msub id="S4.E12.m1.2.2.2.5" xref="S4.E12.m1.2.2.2.5.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.E12.m1.2.2.2.5.2" xref="S4.E12.m1.2.2.2.5.2.cmml">𝒟</mi><mi id="S4.E12.m1.2.2.2.5.3" xref="S4.E12.m1.2.2.2.5.3.cmml">i</mi></msub></mrow></msub><mo lspace="0em" rspace="0em" id="S4.E12.m1.7.7.3.2" xref="S4.E12.m1.7.7.3.2.cmml">​</mo><mrow id="S4.E12.m1.7.7.3.1.1" xref="S4.E12.m1.7.7.3.1.2.cmml"><mo stretchy="false" id="S4.E12.m1.7.7.3.1.1.2" xref="S4.E12.m1.7.7.3.1.2.1.cmml">[</mo><mrow id="S4.E12.m1.7.7.3.1.1.1" xref="S4.E12.m1.7.7.3.1.1.1.cmml"><msub id="S4.E12.m1.7.7.3.1.1.1.2" xref="S4.E12.m1.7.7.3.1.1.1.2.cmml"><mi id="S4.E12.m1.7.7.3.1.1.1.2.2" xref="S4.E12.m1.7.7.3.1.1.1.2.2.cmml">L</mi><mi id="S4.E12.m1.7.7.3.1.1.1.2.3" xref="S4.E12.m1.7.7.3.1.1.1.2.3.cmml">i</mi></msub><mo lspace="0em" rspace="0em" id="S4.E12.m1.7.7.3.1.1.1.1" xref="S4.E12.m1.7.7.3.1.1.1.1.cmml">​</mo><mrow id="S4.E12.m1.7.7.3.1.1.1.3.2" xref="S4.E12.m1.7.7.3.1.1.1.3.1.cmml"><mo stretchy="false" id="S4.E12.m1.7.7.3.1.1.1.3.2.1" xref="S4.E12.m1.7.7.3.1.1.1.3.1.cmml">(</mo><mover accent="true" id="S4.E12.m1.3.3" xref="S4.E12.m1.3.3.cmml"><mi id="S4.E12.m1.3.3.2" xref="S4.E12.m1.3.3.2.cmml">y</mi><mo id="S4.E12.m1.3.3.1" xref="S4.E12.m1.3.3.1.cmml">^</mo></mover><mo id="S4.E12.m1.7.7.3.1.1.1.3.2.2" xref="S4.E12.m1.7.7.3.1.1.1.3.1.cmml">,</mo><mi id="S4.E12.m1.4.4" xref="S4.E12.m1.4.4.cmml">y</mi><mo stretchy="false" id="S4.E12.m1.7.7.3.1.1.1.3.2.3" xref="S4.E12.m1.7.7.3.1.1.1.3.1.cmml">)</mo></mrow></mrow><mo stretchy="false" id="S4.E12.m1.7.7.3.1.1.3" xref="S4.E12.m1.7.7.3.1.2.1.cmml">]</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.E12.m1.7b"><apply id="S4.E12.m1.7.7.cmml" xref="S4.E12.m1.7.7"><eq id="S4.E12.m1.7.7.4.cmml" xref="S4.E12.m1.7.7.4"></eq><apply id="S4.E12.m1.6.6.2.cmml" xref="S4.E12.m1.6.6.2"><times id="S4.E12.m1.6.6.2.3.cmml" xref="S4.E12.m1.6.6.2.3"></times><apply id="S4.E12.m1.6.6.2.4.cmml" xref="S4.E12.m1.6.6.2.4"><csymbol cd="ambiguous" id="S4.E12.m1.6.6.2.4.1.cmml" xref="S4.E12.m1.6.6.2.4">subscript</csymbol><ci id="S4.E12.m1.6.6.2.4.2.cmml" xref="S4.E12.m1.6.6.2.4.2">𝑓</ci><ci id="S4.E12.m1.6.6.2.4.3.cmml" xref="S4.E12.m1.6.6.2.4.3">𝑖</ci></apply><interval closure="open" id="S4.E12.m1.6.6.2.2.3.cmml" xref="S4.E12.m1.6.6.2.2.2"><apply id="S4.E12.m1.5.5.1.1.1.1.cmml" xref="S4.E12.m1.5.5.1.1.1.1"><csymbol cd="ambiguous" id="S4.E12.m1.5.5.1.1.1.1.1.cmml" xref="S4.E12.m1.5.5.1.1.1.1">subscript</csymbol><ci id="S4.E12.m1.5.5.1.1.1.1.2.cmml" xref="S4.E12.m1.5.5.1.1.1.1.2">𝜃</ci><ci id="S4.E12.m1.5.5.1.1.1.1.3.cmml" xref="S4.E12.m1.5.5.1.1.1.1.3">𝐸</ci></apply><apply id="S4.E12.m1.6.6.2.2.2.2.cmml" xref="S4.E12.m1.6.6.2.2.2.2"><csymbol cd="ambiguous" id="S4.E12.m1.6.6.2.2.2.2.1.cmml" xref="S4.E12.m1.6.6.2.2.2.2">subscript</csymbol><ci id="S4.E12.m1.6.6.2.2.2.2.2.cmml" xref="S4.E12.m1.6.6.2.2.2.2.2">𝜃</ci><apply id="S4.E12.m1.6.6.2.2.2.2.3.cmml" xref="S4.E12.m1.6.6.2.2.2.2.3"><csymbol cd="ambiguous" id="S4.E12.m1.6.6.2.2.2.2.3.1.cmml" xref="S4.E12.m1.6.6.2.2.2.2.3">subscript</csymbol><ci id="S4.E12.m1.6.6.2.2.2.2.3.2.cmml" xref="S4.E12.m1.6.6.2.2.2.2.3.2">𝐶</ci><ci id="S4.E12.m1.6.6.2.2.2.2.3.3.cmml" xref="S4.E12.m1.6.6.2.2.2.2.3.3">𝑖</ci></apply></apply></interval></apply><apply id="S4.E12.m1.7.7.3.cmml" xref="S4.E12.m1.7.7.3"><times id="S4.E12.m1.7.7.3.2.cmml" xref="S4.E12.m1.7.7.3.2"></times><apply id="S4.E12.m1.7.7.3.3.cmml" xref="S4.E12.m1.7.7.3.3"><csymbol cd="ambiguous" id="S4.E12.m1.7.7.3.3.1.cmml" xref="S4.E12.m1.7.7.3.3">subscript</csymbol><ci id="S4.E12.m1.7.7.3.3.2.cmml" xref="S4.E12.m1.7.7.3.3.2">𝔼</ci><apply id="S4.E12.m1.2.2.2.cmml" xref="S4.E12.m1.2.2.2"><csymbol cd="latexml" id="S4.E12.m1.2.2.2.3.cmml" xref="S4.E12.m1.2.2.2.3">similar-to</csymbol><interval closure="open" id="S4.E12.m1.2.2.2.4.1.cmml" xref="S4.E12.m1.2.2.2.4.2"><ci id="S4.E12.m1.1.1.1.1.cmml" xref="S4.E12.m1.1.1.1.1">𝑥</ci><ci id="S4.E12.m1.2.2.2.2.cmml" xref="S4.E12.m1.2.2.2.2">𝑦</ci></interval><apply id="S4.E12.m1.2.2.2.5.cmml" xref="S4.E12.m1.2.2.2.5"><csymbol cd="ambiguous" id="S4.E12.m1.2.2.2.5.1.cmml" xref="S4.E12.m1.2.2.2.5">subscript</csymbol><ci id="S4.E12.m1.2.2.2.5.2.cmml" xref="S4.E12.m1.2.2.2.5.2">𝒟</ci><ci id="S4.E12.m1.2.2.2.5.3.cmml" xref="S4.E12.m1.2.2.2.5.3">𝑖</ci></apply></apply></apply><apply id="S4.E12.m1.7.7.3.1.2.cmml" xref="S4.E12.m1.7.7.3.1.1"><csymbol cd="latexml" id="S4.E12.m1.7.7.3.1.2.1.cmml" xref="S4.E12.m1.7.7.3.1.1.2">delimited-[]</csymbol><apply id="S4.E12.m1.7.7.3.1.1.1.cmml" xref="S4.E12.m1.7.7.3.1.1.1"><times id="S4.E12.m1.7.7.3.1.1.1.1.cmml" xref="S4.E12.m1.7.7.3.1.1.1.1"></times><apply id="S4.E12.m1.7.7.3.1.1.1.2.cmml" xref="S4.E12.m1.7.7.3.1.1.1.2"><csymbol cd="ambiguous" id="S4.E12.m1.7.7.3.1.1.1.2.1.cmml" xref="S4.E12.m1.7.7.3.1.1.1.2">subscript</csymbol><ci id="S4.E12.m1.7.7.3.1.1.1.2.2.cmml" xref="S4.E12.m1.7.7.3.1.1.1.2.2">𝐿</ci><ci id="S4.E12.m1.7.7.3.1.1.1.2.3.cmml" xref="S4.E12.m1.7.7.3.1.1.1.2.3">𝑖</ci></apply><interval closure="open" id="S4.E12.m1.7.7.3.1.1.1.3.1.cmml" xref="S4.E12.m1.7.7.3.1.1.1.3.2"><apply id="S4.E12.m1.3.3.cmml" xref="S4.E12.m1.3.3"><ci id="S4.E12.m1.3.3.1.cmml" xref="S4.E12.m1.3.3.1">^</ci><ci id="S4.E12.m1.3.3.2.cmml" xref="S4.E12.m1.3.3.2">𝑦</ci></apply><ci id="S4.E12.m1.4.4.cmml" xref="S4.E12.m1.4.4">𝑦</ci></interval></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.E12.m1.7c">f_{i}(\theta_{E},\theta_{C_{i}})=\mathbb{E}_{(x,y)\sim\mathcal{D}_{i}}[L_{i}(\widehat{y},y)]</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(12)</span></td>
</tr></tbody>
</table>
<p id="S4.p4.1" class="ltx_p">where the pseudo label <math id="S4.p4.1.m1.1" class="ltx_Math" alttext="\widehat{y}" display="inline"><semantics id="S4.p4.1.m1.1a"><mover accent="true" id="S4.p4.1.m1.1.1" xref="S4.p4.1.m1.1.1.cmml"><mi id="S4.p4.1.m1.1.1.2" xref="S4.p4.1.m1.1.1.2.cmml">y</mi><mo id="S4.p4.1.m1.1.1.1" xref="S4.p4.1.m1.1.1.1.cmml">^</mo></mover><annotation-xml encoding="MathML-Content" id="S4.p4.1.m1.1b"><apply id="S4.p4.1.m1.1.1.cmml" xref="S4.p4.1.m1.1.1"><ci id="S4.p4.1.m1.1.1.1.cmml" xref="S4.p4.1.m1.1.1.1">^</ci><ci id="S4.p4.1.m1.1.1.2.cmml" xref="S4.p4.1.m1.1.1.2">𝑦</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.p4.1.m1.1c">\widehat{y}</annotation></semantics></math> corresponding to x is given by:</p>
<table id="S4.E13" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S4.E13.m1.2" class="ltx_Math" alttext="a=M_{E}(\theta_{E},x)" display="block"><semantics id="S4.E13.m1.2a"><mrow id="S4.E13.m1.2.2" xref="S4.E13.m1.2.2.cmml"><mi id="S4.E13.m1.2.2.3" xref="S4.E13.m1.2.2.3.cmml">a</mi><mo id="S4.E13.m1.2.2.2" xref="S4.E13.m1.2.2.2.cmml">=</mo><mrow id="S4.E13.m1.2.2.1" xref="S4.E13.m1.2.2.1.cmml"><msub id="S4.E13.m1.2.2.1.3" xref="S4.E13.m1.2.2.1.3.cmml"><mi id="S4.E13.m1.2.2.1.3.2" xref="S4.E13.m1.2.2.1.3.2.cmml">M</mi><mi id="S4.E13.m1.2.2.1.3.3" xref="S4.E13.m1.2.2.1.3.3.cmml">E</mi></msub><mo lspace="0em" rspace="0em" id="S4.E13.m1.2.2.1.2" xref="S4.E13.m1.2.2.1.2.cmml">​</mo><mrow id="S4.E13.m1.2.2.1.1.1" xref="S4.E13.m1.2.2.1.1.2.cmml"><mo stretchy="false" id="S4.E13.m1.2.2.1.1.1.2" xref="S4.E13.m1.2.2.1.1.2.cmml">(</mo><msub id="S4.E13.m1.2.2.1.1.1.1" xref="S4.E13.m1.2.2.1.1.1.1.cmml"><mi id="S4.E13.m1.2.2.1.1.1.1.2" xref="S4.E13.m1.2.2.1.1.1.1.2.cmml">θ</mi><mi id="S4.E13.m1.2.2.1.1.1.1.3" xref="S4.E13.m1.2.2.1.1.1.1.3.cmml">E</mi></msub><mo id="S4.E13.m1.2.2.1.1.1.3" xref="S4.E13.m1.2.2.1.1.2.cmml">,</mo><mi id="S4.E13.m1.1.1" xref="S4.E13.m1.1.1.cmml">x</mi><mo stretchy="false" id="S4.E13.m1.2.2.1.1.1.4" xref="S4.E13.m1.2.2.1.1.2.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.E13.m1.2b"><apply id="S4.E13.m1.2.2.cmml" xref="S4.E13.m1.2.2"><eq id="S4.E13.m1.2.2.2.cmml" xref="S4.E13.m1.2.2.2"></eq><ci id="S4.E13.m1.2.2.3.cmml" xref="S4.E13.m1.2.2.3">𝑎</ci><apply id="S4.E13.m1.2.2.1.cmml" xref="S4.E13.m1.2.2.1"><times id="S4.E13.m1.2.2.1.2.cmml" xref="S4.E13.m1.2.2.1.2"></times><apply id="S4.E13.m1.2.2.1.3.cmml" xref="S4.E13.m1.2.2.1.3"><csymbol cd="ambiguous" id="S4.E13.m1.2.2.1.3.1.cmml" xref="S4.E13.m1.2.2.1.3">subscript</csymbol><ci id="S4.E13.m1.2.2.1.3.2.cmml" xref="S4.E13.m1.2.2.1.3.2">𝑀</ci><ci id="S4.E13.m1.2.2.1.3.3.cmml" xref="S4.E13.m1.2.2.1.3.3">𝐸</ci></apply><interval closure="open" id="S4.E13.m1.2.2.1.1.2.cmml" xref="S4.E13.m1.2.2.1.1.1"><apply id="S4.E13.m1.2.2.1.1.1.1.cmml" xref="S4.E13.m1.2.2.1.1.1.1"><csymbol cd="ambiguous" id="S4.E13.m1.2.2.1.1.1.1.1.cmml" xref="S4.E13.m1.2.2.1.1.1.1">subscript</csymbol><ci id="S4.E13.m1.2.2.1.1.1.1.2.cmml" xref="S4.E13.m1.2.2.1.1.1.1.2">𝜃</ci><ci id="S4.E13.m1.2.2.1.1.1.1.3.cmml" xref="S4.E13.m1.2.2.1.1.1.1.3">𝐸</ci></apply><ci id="S4.E13.m1.1.1.cmml" xref="S4.E13.m1.1.1">𝑥</ci></interval></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.E13.m1.2c">a=M_{E}(\theta_{E},x)</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(13)</span></td>
</tr></tbody>
</table>
</div>
<div id="S4.p5" class="ltx_para">
<table id="S4.E14" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S4.E14.m1.2" class="ltx_Math" alttext="\widehat{y}=M_{C}(\theta_{C};a)" display="block"><semantics id="S4.E14.m1.2a"><mrow id="S4.E14.m1.2.2" xref="S4.E14.m1.2.2.cmml"><mover accent="true" id="S4.E14.m1.2.2.3" xref="S4.E14.m1.2.2.3.cmml"><mi id="S4.E14.m1.2.2.3.2" xref="S4.E14.m1.2.2.3.2.cmml">y</mi><mo id="S4.E14.m1.2.2.3.1" xref="S4.E14.m1.2.2.3.1.cmml">^</mo></mover><mo id="S4.E14.m1.2.2.2" xref="S4.E14.m1.2.2.2.cmml">=</mo><mrow id="S4.E14.m1.2.2.1" xref="S4.E14.m1.2.2.1.cmml"><msub id="S4.E14.m1.2.2.1.3" xref="S4.E14.m1.2.2.1.3.cmml"><mi id="S4.E14.m1.2.2.1.3.2" xref="S4.E14.m1.2.2.1.3.2.cmml">M</mi><mi id="S4.E14.m1.2.2.1.3.3" xref="S4.E14.m1.2.2.1.3.3.cmml">C</mi></msub><mo lspace="0em" rspace="0em" id="S4.E14.m1.2.2.1.2" xref="S4.E14.m1.2.2.1.2.cmml">​</mo><mrow id="S4.E14.m1.2.2.1.1.1" xref="S4.E14.m1.2.2.1.1.2.cmml"><mo stretchy="false" id="S4.E14.m1.2.2.1.1.1.2" xref="S4.E14.m1.2.2.1.1.2.cmml">(</mo><msub id="S4.E14.m1.2.2.1.1.1.1" xref="S4.E14.m1.2.2.1.1.1.1.cmml"><mi id="S4.E14.m1.2.2.1.1.1.1.2" xref="S4.E14.m1.2.2.1.1.1.1.2.cmml">θ</mi><mi id="S4.E14.m1.2.2.1.1.1.1.3" xref="S4.E14.m1.2.2.1.1.1.1.3.cmml">C</mi></msub><mo id="S4.E14.m1.2.2.1.1.1.3" xref="S4.E14.m1.2.2.1.1.2.cmml">;</mo><mi id="S4.E14.m1.1.1" xref="S4.E14.m1.1.1.cmml">a</mi><mo stretchy="false" id="S4.E14.m1.2.2.1.1.1.4" xref="S4.E14.m1.2.2.1.1.2.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.E14.m1.2b"><apply id="S4.E14.m1.2.2.cmml" xref="S4.E14.m1.2.2"><eq id="S4.E14.m1.2.2.2.cmml" xref="S4.E14.m1.2.2.2"></eq><apply id="S4.E14.m1.2.2.3.cmml" xref="S4.E14.m1.2.2.3"><ci id="S4.E14.m1.2.2.3.1.cmml" xref="S4.E14.m1.2.2.3.1">^</ci><ci id="S4.E14.m1.2.2.3.2.cmml" xref="S4.E14.m1.2.2.3.2">𝑦</ci></apply><apply id="S4.E14.m1.2.2.1.cmml" xref="S4.E14.m1.2.2.1"><times id="S4.E14.m1.2.2.1.2.cmml" xref="S4.E14.m1.2.2.1.2"></times><apply id="S4.E14.m1.2.2.1.3.cmml" xref="S4.E14.m1.2.2.1.3"><csymbol cd="ambiguous" id="S4.E14.m1.2.2.1.3.1.cmml" xref="S4.E14.m1.2.2.1.3">subscript</csymbol><ci id="S4.E14.m1.2.2.1.3.2.cmml" xref="S4.E14.m1.2.2.1.3.2">𝑀</ci><ci id="S4.E14.m1.2.2.1.3.3.cmml" xref="S4.E14.m1.2.2.1.3.3">𝐶</ci></apply><list id="S4.E14.m1.2.2.1.1.2.cmml" xref="S4.E14.m1.2.2.1.1.1"><apply id="S4.E14.m1.2.2.1.1.1.1.cmml" xref="S4.E14.m1.2.2.1.1.1.1"><csymbol cd="ambiguous" id="S4.E14.m1.2.2.1.1.1.1.1.cmml" xref="S4.E14.m1.2.2.1.1.1.1">subscript</csymbol><ci id="S4.E14.m1.2.2.1.1.1.1.2.cmml" xref="S4.E14.m1.2.2.1.1.1.1.2">𝜃</ci><ci id="S4.E14.m1.2.2.1.1.1.1.3.cmml" xref="S4.E14.m1.2.2.1.1.1.1.3">𝐶</ci></apply><ci id="S4.E14.m1.1.1.cmml" xref="S4.E14.m1.1.1">𝑎</ci></list></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.E14.m1.2c">\widehat{y}=M_{C}(\theta_{C};a)</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(14)</span></td>
</tr></tbody>
</table>
<p id="S4.p5.3" class="ltx_p">where <math id="S4.p5.1.m1.1" class="ltx_Math" alttext="a" display="inline"><semantics id="S4.p5.1.m1.1a"><mi id="S4.p5.1.m1.1.1" xref="S4.p5.1.m1.1.1.cmml">a</mi><annotation-xml encoding="MathML-Content" id="S4.p5.1.m1.1b"><ci id="S4.p5.1.m1.1.1.cmml" xref="S4.p5.1.m1.1.1">𝑎</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.p5.1.m1.1c">a</annotation></semantics></math> is the activations between <math id="S4.p5.2.m2.1" class="ltx_Math" alttext="M_{E}" display="inline"><semantics id="S4.p5.2.m2.1a"><msub id="S4.p5.2.m2.1.1" xref="S4.p5.2.m2.1.1.cmml"><mi id="S4.p5.2.m2.1.1.2" xref="S4.p5.2.m2.1.1.2.cmml">M</mi><mi id="S4.p5.2.m2.1.1.3" xref="S4.p5.2.m2.1.1.3.cmml">E</mi></msub><annotation-xml encoding="MathML-Content" id="S4.p5.2.m2.1b"><apply id="S4.p5.2.m2.1.1.cmml" xref="S4.p5.2.m2.1.1"><csymbol cd="ambiguous" id="S4.p5.2.m2.1.1.1.cmml" xref="S4.p5.2.m2.1.1">subscript</csymbol><ci id="S4.p5.2.m2.1.1.2.cmml" xref="S4.p5.2.m2.1.1.2">𝑀</ci><ci id="S4.p5.2.m2.1.1.3.cmml" xref="S4.p5.2.m2.1.1.3">𝐸</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.p5.2.m2.1c">M_{E}</annotation></semantics></math> and <math id="S4.p5.3.m3.1" class="ltx_Math" alttext="M_{C}" display="inline"><semantics id="S4.p5.3.m3.1a"><msub id="S4.p5.3.m3.1.1" xref="S4.p5.3.m3.1.1.cmml"><mi id="S4.p5.3.m3.1.1.2" xref="S4.p5.3.m3.1.1.2.cmml">M</mi><mi id="S4.p5.3.m3.1.1.3" xref="S4.p5.3.m3.1.1.3.cmml">C</mi></msub><annotation-xml encoding="MathML-Content" id="S4.p5.3.m3.1b"><apply id="S4.p5.3.m3.1.1.cmml" xref="S4.p5.3.m3.1.1"><csymbol cd="ambiguous" id="S4.p5.3.m3.1.1.1.cmml" xref="S4.p5.3.m3.1.1">subscript</csymbol><ci id="S4.p5.3.m3.1.1.2.cmml" xref="S4.p5.3.m3.1.1.2">𝑀</ci><ci id="S4.p5.3.m3.1.1.3.cmml" xref="S4.p5.3.m3.1.1.3">𝐶</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.p5.3.m3.1c">M_{C}</annotation></semantics></math>.</p>
</div>
<div id="S4.p6" class="ltx_para">
<p id="S4.p6.4" class="ltx_p">In the mixing stage, <math id="S4.p6.1.m1.1" class="ltx_Math" alttext="w_{i}" display="inline"><semantics id="S4.p6.1.m1.1a"><msub id="S4.p6.1.m1.1.1" xref="S4.p6.1.m1.1.1.cmml"><mi id="S4.p6.1.m1.1.1.2" xref="S4.p6.1.m1.1.1.2.cmml">w</mi><mi id="S4.p6.1.m1.1.1.3" xref="S4.p6.1.m1.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S4.p6.1.m1.1b"><apply id="S4.p6.1.m1.1.1.cmml" xref="S4.p6.1.m1.1.1"><csymbol cd="ambiguous" id="S4.p6.1.m1.1.1.1.cmml" xref="S4.p6.1.m1.1.1">subscript</csymbol><ci id="S4.p6.1.m1.1.1.2.cmml" xref="S4.p6.1.m1.1.1.2">𝑤</ci><ci id="S4.p6.1.m1.1.1.3.cmml" xref="S4.p6.1.m1.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.p6.1.m1.1c">w_{i}</annotation></semantics></math> is updated by Eq. <a href="#S3.E10" title="In III-C Mixing ‣ III PFL-MoE ‣ PFL-MoE: Personalized Federated Learning Based on Mixture of Experts" class="ltx_ref"><span class="ltx_text ltx_ref_tag">10</span></a>, and the gating loss <math id="S4.p6.2.m2.1" class="ltx_Math" alttext="p_{i}(w_{i})" display="inline"><semantics id="S4.p6.2.m2.1a"><mrow id="S4.p6.2.m2.1.1" xref="S4.p6.2.m2.1.1.cmml"><msub id="S4.p6.2.m2.1.1.3" xref="S4.p6.2.m2.1.1.3.cmml"><mi id="S4.p6.2.m2.1.1.3.2" xref="S4.p6.2.m2.1.1.3.2.cmml">p</mi><mi id="S4.p6.2.m2.1.1.3.3" xref="S4.p6.2.m2.1.1.3.3.cmml">i</mi></msub><mo lspace="0em" rspace="0em" id="S4.p6.2.m2.1.1.2" xref="S4.p6.2.m2.1.1.2.cmml">​</mo><mrow id="S4.p6.2.m2.1.1.1.1" xref="S4.p6.2.m2.1.1.1.1.1.cmml"><mo stretchy="false" id="S4.p6.2.m2.1.1.1.1.2" xref="S4.p6.2.m2.1.1.1.1.1.cmml">(</mo><msub id="S4.p6.2.m2.1.1.1.1.1" xref="S4.p6.2.m2.1.1.1.1.1.cmml"><mi id="S4.p6.2.m2.1.1.1.1.1.2" xref="S4.p6.2.m2.1.1.1.1.1.2.cmml">w</mi><mi id="S4.p6.2.m2.1.1.1.1.1.3" xref="S4.p6.2.m2.1.1.1.1.1.3.cmml">i</mi></msub><mo stretchy="false" id="S4.p6.2.m2.1.1.1.1.3" xref="S4.p6.2.m2.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.p6.2.m2.1b"><apply id="S4.p6.2.m2.1.1.cmml" xref="S4.p6.2.m2.1.1"><times id="S4.p6.2.m2.1.1.2.cmml" xref="S4.p6.2.m2.1.1.2"></times><apply id="S4.p6.2.m2.1.1.3.cmml" xref="S4.p6.2.m2.1.1.3"><csymbol cd="ambiguous" id="S4.p6.2.m2.1.1.3.1.cmml" xref="S4.p6.2.m2.1.1.3">subscript</csymbol><ci id="S4.p6.2.m2.1.1.3.2.cmml" xref="S4.p6.2.m2.1.1.3.2">𝑝</ci><ci id="S4.p6.2.m2.1.1.3.3.cmml" xref="S4.p6.2.m2.1.1.3.3">𝑖</ci></apply><apply id="S4.p6.2.m2.1.1.1.1.1.cmml" xref="S4.p6.2.m2.1.1.1.1"><csymbol cd="ambiguous" id="S4.p6.2.m2.1.1.1.1.1.1.cmml" xref="S4.p6.2.m2.1.1.1.1">subscript</csymbol><ci id="S4.p6.2.m2.1.1.1.1.1.2.cmml" xref="S4.p6.2.m2.1.1.1.1.1.2">𝑤</ci><ci id="S4.p6.2.m2.1.1.1.1.1.3.cmml" xref="S4.p6.2.m2.1.1.1.1.1.3">𝑖</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.p6.2.m2.1c">p_{i}(w_{i})</annotation></semantics></math> is defined in Eq. <a href="#S3.E7" title="In III-C Mixing ‣ III PFL-MoE ‣ PFL-MoE: Personalized Federated Learning Based on Mixture of Experts" class="ltx_ref"><span class="ltx_text ltx_ref_tag">7</span></a>. In the PFL-MF algorithm, different from Eq. <a href="#S3.E9" title="In III-C Mixing ‣ III PFL-MoE ‣ PFL-MoE: Personalized Federated Learning Based on Mixture of Experts" class="ltx_ref"><span class="ltx_text ltx_ref_tag">9</span></a>, the mixed pseudo label <math id="S4.p6.3.m3.1" class="ltx_Math" alttext="\tilde{y}" display="inline"><semantics id="S4.p6.3.m3.1a"><mover accent="true" id="S4.p6.3.m3.1.1" xref="S4.p6.3.m3.1.1.cmml"><mi id="S4.p6.3.m3.1.1.2" xref="S4.p6.3.m3.1.1.2.cmml">y</mi><mo id="S4.p6.3.m3.1.1.1" xref="S4.p6.3.m3.1.1.1.cmml">~</mo></mover><annotation-xml encoding="MathML-Content" id="S4.p6.3.m3.1b"><apply id="S4.p6.3.m3.1.1.cmml" xref="S4.p6.3.m3.1.1"><ci id="S4.p6.3.m3.1.1.1.cmml" xref="S4.p6.3.m3.1.1.1">~</ci><ci id="S4.p6.3.m3.1.1.2.cmml" xref="S4.p6.3.m3.1.1.2">𝑦</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.p6.3.m3.1c">\tilde{y}</annotation></semantics></math> corresponding to <math id="S4.p6.4.m4.1" class="ltx_Math" alttext="x" display="inline"><semantics id="S4.p6.4.m4.1a"><mi id="S4.p6.4.m4.1.1" xref="S4.p6.4.m4.1.1.cmml">x</mi><annotation-xml encoding="MathML-Content" id="S4.p6.4.m4.1b"><ci id="S4.p6.4.m4.1.1.cmml" xref="S4.p6.4.m4.1.1">𝑥</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.p6.4.m4.1c">x</annotation></semantics></math> is written as:</p>
</div>
<div id="S4.p7" class="ltx_para">
<table id="S4.E15" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S4.E15.m1.5" class="ltx_Math" alttext="\tilde{y}=g\cdot M_{C}(\theta_{C};a)+(1-g)\cdot M_{C}(\theta_{C_{i}};a)" display="block"><semantics id="S4.E15.m1.5a"><mrow id="S4.E15.m1.5.5" xref="S4.E15.m1.5.5.cmml"><mover accent="true" id="S4.E15.m1.5.5.5" xref="S4.E15.m1.5.5.5.cmml"><mi id="S4.E15.m1.5.5.5.2" xref="S4.E15.m1.5.5.5.2.cmml">y</mi><mo id="S4.E15.m1.5.5.5.1" xref="S4.E15.m1.5.5.5.1.cmml">~</mo></mover><mo id="S4.E15.m1.5.5.4" xref="S4.E15.m1.5.5.4.cmml">=</mo><mrow id="S4.E15.m1.5.5.3" xref="S4.E15.m1.5.5.3.cmml"><mrow id="S4.E15.m1.3.3.1.1" xref="S4.E15.m1.3.3.1.1.cmml"><mrow id="S4.E15.m1.3.3.1.1.3" xref="S4.E15.m1.3.3.1.1.3.cmml"><mi id="S4.E15.m1.3.3.1.1.3.2" xref="S4.E15.m1.3.3.1.1.3.2.cmml">g</mi><mo lspace="0.222em" rspace="0.222em" id="S4.E15.m1.3.3.1.1.3.1" xref="S4.E15.m1.3.3.1.1.3.1.cmml">⋅</mo><msub id="S4.E15.m1.3.3.1.1.3.3" xref="S4.E15.m1.3.3.1.1.3.3.cmml"><mi id="S4.E15.m1.3.3.1.1.3.3.2" xref="S4.E15.m1.3.3.1.1.3.3.2.cmml">M</mi><mi id="S4.E15.m1.3.3.1.1.3.3.3" xref="S4.E15.m1.3.3.1.1.3.3.3.cmml">C</mi></msub></mrow><mo lspace="0em" rspace="0em" id="S4.E15.m1.3.3.1.1.2" xref="S4.E15.m1.3.3.1.1.2.cmml">​</mo><mrow id="S4.E15.m1.3.3.1.1.1.1" xref="S4.E15.m1.3.3.1.1.1.2.cmml"><mo stretchy="false" id="S4.E15.m1.3.3.1.1.1.1.2" xref="S4.E15.m1.3.3.1.1.1.2.cmml">(</mo><msub id="S4.E15.m1.3.3.1.1.1.1.1" xref="S4.E15.m1.3.3.1.1.1.1.1.cmml"><mi id="S4.E15.m1.3.3.1.1.1.1.1.2" xref="S4.E15.m1.3.3.1.1.1.1.1.2.cmml">θ</mi><mi id="S4.E15.m1.3.3.1.1.1.1.1.3" xref="S4.E15.m1.3.3.1.1.1.1.1.3.cmml">C</mi></msub><mo id="S4.E15.m1.3.3.1.1.1.1.3" xref="S4.E15.m1.3.3.1.1.1.2.cmml">;</mo><mi id="S4.E15.m1.1.1" xref="S4.E15.m1.1.1.cmml">a</mi><mo stretchy="false" id="S4.E15.m1.3.3.1.1.1.1.4" xref="S4.E15.m1.3.3.1.1.1.2.cmml">)</mo></mrow></mrow><mo id="S4.E15.m1.5.5.3.4" xref="S4.E15.m1.5.5.3.4.cmml">+</mo><mrow id="S4.E15.m1.5.5.3.3" xref="S4.E15.m1.5.5.3.3.cmml"><mrow id="S4.E15.m1.4.4.2.2.1" xref="S4.E15.m1.4.4.2.2.1.cmml"><mrow id="S4.E15.m1.4.4.2.2.1.1.1" xref="S4.E15.m1.4.4.2.2.1.1.1.1.cmml"><mo stretchy="false" id="S4.E15.m1.4.4.2.2.1.1.1.2" xref="S4.E15.m1.4.4.2.2.1.1.1.1.cmml">(</mo><mrow id="S4.E15.m1.4.4.2.2.1.1.1.1" xref="S4.E15.m1.4.4.2.2.1.1.1.1.cmml"><mn id="S4.E15.m1.4.4.2.2.1.1.1.1.2" xref="S4.E15.m1.4.4.2.2.1.1.1.1.2.cmml">1</mn><mo id="S4.E15.m1.4.4.2.2.1.1.1.1.1" xref="S4.E15.m1.4.4.2.2.1.1.1.1.1.cmml">−</mo><mi id="S4.E15.m1.4.4.2.2.1.1.1.1.3" xref="S4.E15.m1.4.4.2.2.1.1.1.1.3.cmml">g</mi></mrow><mo rspace="0.055em" stretchy="false" id="S4.E15.m1.4.4.2.2.1.1.1.3" xref="S4.E15.m1.4.4.2.2.1.1.1.1.cmml">)</mo></mrow><mo rspace="0.222em" id="S4.E15.m1.4.4.2.2.1.2" xref="S4.E15.m1.4.4.2.2.1.2.cmml">⋅</mo><msub id="S4.E15.m1.4.4.2.2.1.3" xref="S4.E15.m1.4.4.2.2.1.3.cmml"><mi id="S4.E15.m1.4.4.2.2.1.3.2" xref="S4.E15.m1.4.4.2.2.1.3.2.cmml">M</mi><mi id="S4.E15.m1.4.4.2.2.1.3.3" xref="S4.E15.m1.4.4.2.2.1.3.3.cmml">C</mi></msub></mrow><mo lspace="0em" rspace="0em" id="S4.E15.m1.5.5.3.3.3" xref="S4.E15.m1.5.5.3.3.3.cmml">​</mo><mrow id="S4.E15.m1.5.5.3.3.2.1" xref="S4.E15.m1.5.5.3.3.2.2.cmml"><mo stretchy="false" id="S4.E15.m1.5.5.3.3.2.1.2" xref="S4.E15.m1.5.5.3.3.2.2.cmml">(</mo><msub id="S4.E15.m1.5.5.3.3.2.1.1" xref="S4.E15.m1.5.5.3.3.2.1.1.cmml"><mi id="S4.E15.m1.5.5.3.3.2.1.1.2" xref="S4.E15.m1.5.5.3.3.2.1.1.2.cmml">θ</mi><msub id="S4.E15.m1.5.5.3.3.2.1.1.3" xref="S4.E15.m1.5.5.3.3.2.1.1.3.cmml"><mi id="S4.E15.m1.5.5.3.3.2.1.1.3.2" xref="S4.E15.m1.5.5.3.3.2.1.1.3.2.cmml">C</mi><mi id="S4.E15.m1.5.5.3.3.2.1.1.3.3" xref="S4.E15.m1.5.5.3.3.2.1.1.3.3.cmml">i</mi></msub></msub><mo id="S4.E15.m1.5.5.3.3.2.1.3" xref="S4.E15.m1.5.5.3.3.2.2.cmml">;</mo><mi id="S4.E15.m1.2.2" xref="S4.E15.m1.2.2.cmml">a</mi><mo stretchy="false" id="S4.E15.m1.5.5.3.3.2.1.4" xref="S4.E15.m1.5.5.3.3.2.2.cmml">)</mo></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.E15.m1.5b"><apply id="S4.E15.m1.5.5.cmml" xref="S4.E15.m1.5.5"><eq id="S4.E15.m1.5.5.4.cmml" xref="S4.E15.m1.5.5.4"></eq><apply id="S4.E15.m1.5.5.5.cmml" xref="S4.E15.m1.5.5.5"><ci id="S4.E15.m1.5.5.5.1.cmml" xref="S4.E15.m1.5.5.5.1">~</ci><ci id="S4.E15.m1.5.5.5.2.cmml" xref="S4.E15.m1.5.5.5.2">𝑦</ci></apply><apply id="S4.E15.m1.5.5.3.cmml" xref="S4.E15.m1.5.5.3"><plus id="S4.E15.m1.5.5.3.4.cmml" xref="S4.E15.m1.5.5.3.4"></plus><apply id="S4.E15.m1.3.3.1.1.cmml" xref="S4.E15.m1.3.3.1.1"><times id="S4.E15.m1.3.3.1.1.2.cmml" xref="S4.E15.m1.3.3.1.1.2"></times><apply id="S4.E15.m1.3.3.1.1.3.cmml" xref="S4.E15.m1.3.3.1.1.3"><ci id="S4.E15.m1.3.3.1.1.3.1.cmml" xref="S4.E15.m1.3.3.1.1.3.1">⋅</ci><ci id="S4.E15.m1.3.3.1.1.3.2.cmml" xref="S4.E15.m1.3.3.1.1.3.2">𝑔</ci><apply id="S4.E15.m1.3.3.1.1.3.3.cmml" xref="S4.E15.m1.3.3.1.1.3.3"><csymbol cd="ambiguous" id="S4.E15.m1.3.3.1.1.3.3.1.cmml" xref="S4.E15.m1.3.3.1.1.3.3">subscript</csymbol><ci id="S4.E15.m1.3.3.1.1.3.3.2.cmml" xref="S4.E15.m1.3.3.1.1.3.3.2">𝑀</ci><ci id="S4.E15.m1.3.3.1.1.3.3.3.cmml" xref="S4.E15.m1.3.3.1.1.3.3.3">𝐶</ci></apply></apply><list id="S4.E15.m1.3.3.1.1.1.2.cmml" xref="S4.E15.m1.3.3.1.1.1.1"><apply id="S4.E15.m1.3.3.1.1.1.1.1.cmml" xref="S4.E15.m1.3.3.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.E15.m1.3.3.1.1.1.1.1.1.cmml" xref="S4.E15.m1.3.3.1.1.1.1.1">subscript</csymbol><ci id="S4.E15.m1.3.3.1.1.1.1.1.2.cmml" xref="S4.E15.m1.3.3.1.1.1.1.1.2">𝜃</ci><ci id="S4.E15.m1.3.3.1.1.1.1.1.3.cmml" xref="S4.E15.m1.3.3.1.1.1.1.1.3">𝐶</ci></apply><ci id="S4.E15.m1.1.1.cmml" xref="S4.E15.m1.1.1">𝑎</ci></list></apply><apply id="S4.E15.m1.5.5.3.3.cmml" xref="S4.E15.m1.5.5.3.3"><times id="S4.E15.m1.5.5.3.3.3.cmml" xref="S4.E15.m1.5.5.3.3.3"></times><apply id="S4.E15.m1.4.4.2.2.1.cmml" xref="S4.E15.m1.4.4.2.2.1"><ci id="S4.E15.m1.4.4.2.2.1.2.cmml" xref="S4.E15.m1.4.4.2.2.1.2">⋅</ci><apply id="S4.E15.m1.4.4.2.2.1.1.1.1.cmml" xref="S4.E15.m1.4.4.2.2.1.1.1"><minus id="S4.E15.m1.4.4.2.2.1.1.1.1.1.cmml" xref="S4.E15.m1.4.4.2.2.1.1.1.1.1"></minus><cn type="integer" id="S4.E15.m1.4.4.2.2.1.1.1.1.2.cmml" xref="S4.E15.m1.4.4.2.2.1.1.1.1.2">1</cn><ci id="S4.E15.m1.4.4.2.2.1.1.1.1.3.cmml" xref="S4.E15.m1.4.4.2.2.1.1.1.1.3">𝑔</ci></apply><apply id="S4.E15.m1.4.4.2.2.1.3.cmml" xref="S4.E15.m1.4.4.2.2.1.3"><csymbol cd="ambiguous" id="S4.E15.m1.4.4.2.2.1.3.1.cmml" xref="S4.E15.m1.4.4.2.2.1.3">subscript</csymbol><ci id="S4.E15.m1.4.4.2.2.1.3.2.cmml" xref="S4.E15.m1.4.4.2.2.1.3.2">𝑀</ci><ci id="S4.E15.m1.4.4.2.2.1.3.3.cmml" xref="S4.E15.m1.4.4.2.2.1.3.3">𝐶</ci></apply></apply><list id="S4.E15.m1.5.5.3.3.2.2.cmml" xref="S4.E15.m1.5.5.3.3.2.1"><apply id="S4.E15.m1.5.5.3.3.2.1.1.cmml" xref="S4.E15.m1.5.5.3.3.2.1.1"><csymbol cd="ambiguous" id="S4.E15.m1.5.5.3.3.2.1.1.1.cmml" xref="S4.E15.m1.5.5.3.3.2.1.1">subscript</csymbol><ci id="S4.E15.m1.5.5.3.3.2.1.1.2.cmml" xref="S4.E15.m1.5.5.3.3.2.1.1.2">𝜃</ci><apply id="S4.E15.m1.5.5.3.3.2.1.1.3.cmml" xref="S4.E15.m1.5.5.3.3.2.1.1.3"><csymbol cd="ambiguous" id="S4.E15.m1.5.5.3.3.2.1.1.3.1.cmml" xref="S4.E15.m1.5.5.3.3.2.1.1.3">subscript</csymbol><ci id="S4.E15.m1.5.5.3.3.2.1.1.3.2.cmml" xref="S4.E15.m1.5.5.3.3.2.1.1.3.2">𝐶</ci><ci id="S4.E15.m1.5.5.3.3.2.1.1.3.3.cmml" xref="S4.E15.m1.5.5.3.3.2.1.1.3.3">𝑖</ci></apply></apply><ci id="S4.E15.m1.2.2.cmml" xref="S4.E15.m1.2.2">𝑎</ci></list></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.E15.m1.5c">\tilde{y}=g\cdot M_{C}(\theta_{C};a)+(1-g)\cdot M_{C}(\theta_{C_{i}};a)</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(15)</span></td>
</tr></tbody>
</table>
</div>
<div id="S4.p8" class="ltx_para">
<p id="S4.p8.1" class="ltx_p">Through experiments on the Fashion-MNIST dataset, we observe that PFL-MF can achieve good personalization and maintain good generalization capability.
However, due to the limitation of the simple linear network, the gating works not well when the input is more complex high-dimensional data.</p>
</div>
<div id="S4.p9" class="ltx_para">
<p id="S4.p9.1" class="ltx_p">To address this issue, we propose PFL-MFE algorithm that using features as the input of gating.
In convolutional neural networks, it is recognized that the base layer is responsible for capturing general features, while the deeper part is responsible for classification.
Intuitively, the features are a better choice for the gating input compared to raw data. Based on this idea, in the PFL-MFE algorithm, we modify the model structure of the PFL-MF algorithm, and use the activations <math id="S4.p9.1.m1.1" class="ltx_Math" alttext="a" display="inline"><semantics id="S4.p9.1.m1.1a"><mi id="S4.p9.1.m1.1.1" xref="S4.p9.1.m1.1.1.cmml">a</mi><annotation-xml encoding="MathML-Content" id="S4.p9.1.m1.1b"><ci id="S4.p9.1.m1.1.1.cmml" xref="S4.p9.1.m1.1.1">𝑎</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.p9.1.m1.1c">a</annotation></semantics></math> as the gating input:</p>
<table id="S4.E16" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S4.E16.m1.2" class="ltx_Math" alttext="g=sigmoid(G(w_{i};a))" display="block"><semantics id="S4.E16.m1.2a"><mrow id="S4.E16.m1.2.2" xref="S4.E16.m1.2.2.cmml"><mi id="S4.E16.m1.2.2.3" xref="S4.E16.m1.2.2.3.cmml">g</mi><mo id="S4.E16.m1.2.2.2" xref="S4.E16.m1.2.2.2.cmml">=</mo><mrow id="S4.E16.m1.2.2.1" xref="S4.E16.m1.2.2.1.cmml"><mi id="S4.E16.m1.2.2.1.3" xref="S4.E16.m1.2.2.1.3.cmml">s</mi><mo lspace="0em" rspace="0em" id="S4.E16.m1.2.2.1.2" xref="S4.E16.m1.2.2.1.2.cmml">​</mo><mi id="S4.E16.m1.2.2.1.4" xref="S4.E16.m1.2.2.1.4.cmml">i</mi><mo lspace="0em" rspace="0em" id="S4.E16.m1.2.2.1.2a" xref="S4.E16.m1.2.2.1.2.cmml">​</mo><mi id="S4.E16.m1.2.2.1.5" xref="S4.E16.m1.2.2.1.5.cmml">g</mi><mo lspace="0em" rspace="0em" id="S4.E16.m1.2.2.1.2b" xref="S4.E16.m1.2.2.1.2.cmml">​</mo><mi id="S4.E16.m1.2.2.1.6" xref="S4.E16.m1.2.2.1.6.cmml">m</mi><mo lspace="0em" rspace="0em" id="S4.E16.m1.2.2.1.2c" xref="S4.E16.m1.2.2.1.2.cmml">​</mo><mi id="S4.E16.m1.2.2.1.7" xref="S4.E16.m1.2.2.1.7.cmml">o</mi><mo lspace="0em" rspace="0em" id="S4.E16.m1.2.2.1.2d" xref="S4.E16.m1.2.2.1.2.cmml">​</mo><mi id="S4.E16.m1.2.2.1.8" xref="S4.E16.m1.2.2.1.8.cmml">i</mi><mo lspace="0em" rspace="0em" id="S4.E16.m1.2.2.1.2e" xref="S4.E16.m1.2.2.1.2.cmml">​</mo><mi id="S4.E16.m1.2.2.1.9" xref="S4.E16.m1.2.2.1.9.cmml">d</mi><mo lspace="0em" rspace="0em" id="S4.E16.m1.2.2.1.2f" xref="S4.E16.m1.2.2.1.2.cmml">​</mo><mrow id="S4.E16.m1.2.2.1.1.1" xref="S4.E16.m1.2.2.1.1.1.1.cmml"><mo stretchy="false" id="S4.E16.m1.2.2.1.1.1.2" xref="S4.E16.m1.2.2.1.1.1.1.cmml">(</mo><mrow id="S4.E16.m1.2.2.1.1.1.1" xref="S4.E16.m1.2.2.1.1.1.1.cmml"><mi id="S4.E16.m1.2.2.1.1.1.1.3" xref="S4.E16.m1.2.2.1.1.1.1.3.cmml">G</mi><mo lspace="0em" rspace="0em" id="S4.E16.m1.2.2.1.1.1.1.2" xref="S4.E16.m1.2.2.1.1.1.1.2.cmml">​</mo><mrow id="S4.E16.m1.2.2.1.1.1.1.1.1" xref="S4.E16.m1.2.2.1.1.1.1.1.2.cmml"><mo stretchy="false" id="S4.E16.m1.2.2.1.1.1.1.1.1.2" xref="S4.E16.m1.2.2.1.1.1.1.1.2.cmml">(</mo><msub id="S4.E16.m1.2.2.1.1.1.1.1.1.1" xref="S4.E16.m1.2.2.1.1.1.1.1.1.1.cmml"><mi id="S4.E16.m1.2.2.1.1.1.1.1.1.1.2" xref="S4.E16.m1.2.2.1.1.1.1.1.1.1.2.cmml">w</mi><mi id="S4.E16.m1.2.2.1.1.1.1.1.1.1.3" xref="S4.E16.m1.2.2.1.1.1.1.1.1.1.3.cmml">i</mi></msub><mo id="S4.E16.m1.2.2.1.1.1.1.1.1.3" xref="S4.E16.m1.2.2.1.1.1.1.1.2.cmml">;</mo><mi id="S4.E16.m1.1.1" xref="S4.E16.m1.1.1.cmml">a</mi><mo stretchy="false" id="S4.E16.m1.2.2.1.1.1.1.1.1.4" xref="S4.E16.m1.2.2.1.1.1.1.1.2.cmml">)</mo></mrow></mrow><mo stretchy="false" id="S4.E16.m1.2.2.1.1.1.3" xref="S4.E16.m1.2.2.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.E16.m1.2b"><apply id="S4.E16.m1.2.2.cmml" xref="S4.E16.m1.2.2"><eq id="S4.E16.m1.2.2.2.cmml" xref="S4.E16.m1.2.2.2"></eq><ci id="S4.E16.m1.2.2.3.cmml" xref="S4.E16.m1.2.2.3">𝑔</ci><apply id="S4.E16.m1.2.2.1.cmml" xref="S4.E16.m1.2.2.1"><times id="S4.E16.m1.2.2.1.2.cmml" xref="S4.E16.m1.2.2.1.2"></times><ci id="S4.E16.m1.2.2.1.3.cmml" xref="S4.E16.m1.2.2.1.3">𝑠</ci><ci id="S4.E16.m1.2.2.1.4.cmml" xref="S4.E16.m1.2.2.1.4">𝑖</ci><ci id="S4.E16.m1.2.2.1.5.cmml" xref="S4.E16.m1.2.2.1.5">𝑔</ci><ci id="S4.E16.m1.2.2.1.6.cmml" xref="S4.E16.m1.2.2.1.6">𝑚</ci><ci id="S4.E16.m1.2.2.1.7.cmml" xref="S4.E16.m1.2.2.1.7">𝑜</ci><ci id="S4.E16.m1.2.2.1.8.cmml" xref="S4.E16.m1.2.2.1.8">𝑖</ci><ci id="S4.E16.m1.2.2.1.9.cmml" xref="S4.E16.m1.2.2.1.9">𝑑</ci><apply id="S4.E16.m1.2.2.1.1.1.1.cmml" xref="S4.E16.m1.2.2.1.1.1"><times id="S4.E16.m1.2.2.1.1.1.1.2.cmml" xref="S4.E16.m1.2.2.1.1.1.1.2"></times><ci id="S4.E16.m1.2.2.1.1.1.1.3.cmml" xref="S4.E16.m1.2.2.1.1.1.1.3">𝐺</ci><list id="S4.E16.m1.2.2.1.1.1.1.1.2.cmml" xref="S4.E16.m1.2.2.1.1.1.1.1.1"><apply id="S4.E16.m1.2.2.1.1.1.1.1.1.1.cmml" xref="S4.E16.m1.2.2.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.E16.m1.2.2.1.1.1.1.1.1.1.1.cmml" xref="S4.E16.m1.2.2.1.1.1.1.1.1.1">subscript</csymbol><ci id="S4.E16.m1.2.2.1.1.1.1.1.1.1.2.cmml" xref="S4.E16.m1.2.2.1.1.1.1.1.1.1.2">𝑤</ci><ci id="S4.E16.m1.2.2.1.1.1.1.1.1.1.3.cmml" xref="S4.E16.m1.2.2.1.1.1.1.1.1.1.3">𝑖</ci></apply><ci id="S4.E16.m1.1.1.cmml" xref="S4.E16.m1.1.1">𝑎</ci></list></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.E16.m1.2c">g=sigmoid(G(w_{i};a))</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(16)</span></td>
</tr></tbody>
</table>
<p id="S4.p9.5" class="ltx_p">at this time, the number of the input neurons of <math id="S4.p9.2.m1.1" class="ltx_Math" alttext="G" display="inline"><semantics id="S4.p9.2.m1.1a"><mi id="S4.p9.2.m1.1.1" xref="S4.p9.2.m1.1.1.cmml">G</mi><annotation-xml encoding="MathML-Content" id="S4.p9.2.m1.1b"><ci id="S4.p9.2.m1.1.1.cmml" xref="S4.p9.2.m1.1.1">𝐺</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.p9.2.m1.1c">G</annotation></semantics></math> is equal to the dimension of <math id="S4.p9.3.m2.1" class="ltx_Math" alttext="a" display="inline"><semantics id="S4.p9.3.m2.1a"><mi id="S4.p9.3.m2.1.1" xref="S4.p9.3.m2.1.1.cmml">a</mi><annotation-xml encoding="MathML-Content" id="S4.p9.3.m2.1b"><ci id="S4.p9.3.m2.1.1.cmml" xref="S4.p9.3.m2.1.1">𝑎</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.p9.3.m2.1c">a</annotation></semantics></math> instead of <math id="S4.p9.4.m3.1" class="ltx_Math" alttext="x" display="inline"><semantics id="S4.p9.4.m3.1a"><mi id="S4.p9.4.m3.1.1" xref="S4.p9.4.m3.1.1.cmml">x</mi><annotation-xml encoding="MathML-Content" id="S4.p9.4.m3.1b"><ci id="S4.p9.4.m3.1.1.cmml" xref="S4.p9.4.m3.1.1">𝑥</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.p9.4.m3.1c">x</annotation></semantics></math>.
Alg. <a href="#alg2" title="Algorithm 2 ‣ IV PFL-MF and PFL-MFE ‣ PFL-MoE: Personalized Federated Learning Based on Mixture of Experts" class="ltx_ref"><span class="ltx_text ltx_ref_tag">2</span></a> describes the implementation details of the PFL-MF and PFL-MFE algorithms for client <math id="S4.p9.5.m4.1" class="ltx_Math" alttext="i" display="inline"><semantics id="S4.p9.5.m4.1a"><mi id="S4.p9.5.m4.1.1" xref="S4.p9.5.m4.1.1.cmml">i</mi><annotation-xml encoding="MathML-Content" id="S4.p9.5.m4.1b"><ci id="S4.p9.5.m4.1.1.cmml" xref="S4.p9.5.m4.1.1">𝑖</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.p9.5.m4.1c">i</annotation></semantics></math>.</p>
</div>
<figure id="alg2" class="ltx_float ltx_float_algorithm ltx_framed ltx_framed_top">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_float"><span id="alg2.2.1.1" class="ltx_text ltx_font_bold">Algorithm 2</span> </span> PFL-MF(E) Algorithm</figcaption>
<div id="alg2.3" class="ltx_listing ltx_listing">
<div id="alg2.l0" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg2.l0.1.1.1" class="ltx_text" style="font-size:80%;">0:</span></span>  global extractor model structure <math id="alg2.l0.m1.1" class="ltx_Math" alttext="M_{E}" display="inline"><semantics id="alg2.l0.m1.1a"><msub id="alg2.l0.m1.1.1" xref="alg2.l0.m1.1.1.cmml"><mi id="alg2.l0.m1.1.1.2" xref="alg2.l0.m1.1.1.2.cmml">M</mi><mi id="alg2.l0.m1.1.1.3" xref="alg2.l0.m1.1.1.3.cmml">E</mi></msub><annotation-xml encoding="MathML-Content" id="alg2.l0.m1.1b"><apply id="alg2.l0.m1.1.1.cmml" xref="alg2.l0.m1.1.1"><csymbol cd="ambiguous" id="alg2.l0.m1.1.1.1.cmml" xref="alg2.l0.m1.1.1">subscript</csymbol><ci id="alg2.l0.m1.1.1.2.cmml" xref="alg2.l0.m1.1.1.2">𝑀</ci><ci id="alg2.l0.m1.1.1.3.cmml" xref="alg2.l0.m1.1.1.3">𝐸</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.l0.m1.1c">M_{E}</annotation></semantics></math> and its parameter <math id="alg2.l0.m2.1" class="ltx_Math" alttext="\theta_{E}" display="inline"><semantics id="alg2.l0.m2.1a"><msub id="alg2.l0.m2.1.1" xref="alg2.l0.m2.1.1.cmml"><mi id="alg2.l0.m2.1.1.2" xref="alg2.l0.m2.1.1.2.cmml">θ</mi><mi id="alg2.l0.m2.1.1.3" xref="alg2.l0.m2.1.1.3.cmml">E</mi></msub><annotation-xml encoding="MathML-Content" id="alg2.l0.m2.1b"><apply id="alg2.l0.m2.1.1.cmml" xref="alg2.l0.m2.1.1"><csymbol cd="ambiguous" id="alg2.l0.m2.1.1.1.cmml" xref="alg2.l0.m2.1.1">subscript</csymbol><ci id="alg2.l0.m2.1.1.2.cmml" xref="alg2.l0.m2.1.1.2">𝜃</ci><ci id="alg2.l0.m2.1.1.3.cmml" xref="alg2.l0.m2.1.1.3">𝐸</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.l0.m2.1c">\theta_{E}</annotation></semantics></math>, global classifier model structure <math id="alg2.l0.m3.1" class="ltx_Math" alttext="M_{C}" display="inline"><semantics id="alg2.l0.m3.1a"><msub id="alg2.l0.m3.1.1" xref="alg2.l0.m3.1.1.cmml"><mi id="alg2.l0.m3.1.1.2" xref="alg2.l0.m3.1.1.2.cmml">M</mi><mi id="alg2.l0.m3.1.1.3" xref="alg2.l0.m3.1.1.3.cmml">C</mi></msub><annotation-xml encoding="MathML-Content" id="alg2.l0.m3.1b"><apply id="alg2.l0.m3.1.1.cmml" xref="alg2.l0.m3.1.1"><csymbol cd="ambiguous" id="alg2.l0.m3.1.1.1.cmml" xref="alg2.l0.m3.1.1">subscript</csymbol><ci id="alg2.l0.m3.1.1.2.cmml" xref="alg2.l0.m3.1.1.2">𝑀</ci><ci id="alg2.l0.m3.1.1.3.cmml" xref="alg2.l0.m3.1.1.3">𝐶</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.l0.m3.1c">M_{C}</annotation></semantics></math> and its parameter <math id="alg2.l0.m4.1" class="ltx_Math" alttext="\theta_{C}" display="inline"><semantics id="alg2.l0.m4.1a"><msub id="alg2.l0.m4.1.1" xref="alg2.l0.m4.1.1.cmml"><mi id="alg2.l0.m4.1.1.2" xref="alg2.l0.m4.1.1.2.cmml">θ</mi><mi id="alg2.l0.m4.1.1.3" xref="alg2.l0.m4.1.1.3.cmml">C</mi></msub><annotation-xml encoding="MathML-Content" id="alg2.l0.m4.1b"><apply id="alg2.l0.m4.1.1.cmml" xref="alg2.l0.m4.1.1"><csymbol cd="ambiguous" id="alg2.l0.m4.1.1.1.cmml" xref="alg2.l0.m4.1.1">subscript</csymbol><ci id="alg2.l0.m4.1.1.2.cmml" xref="alg2.l0.m4.1.1.2">𝜃</ci><ci id="alg2.l0.m4.1.1.3.cmml" xref="alg2.l0.m4.1.1.3">𝐶</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.l0.m4.1c">\theta_{C}</annotation></semantics></math>, client’s data <math id="alg2.l0.m5.1" class="ltx_Math" alttext="D_{i}" display="inline"><semantics id="alg2.l0.m5.1a"><msub id="alg2.l0.m5.1.1" xref="alg2.l0.m5.1.1.cmml"><mi id="alg2.l0.m5.1.1.2" xref="alg2.l0.m5.1.1.2.cmml">D</mi><mi id="alg2.l0.m5.1.1.3" xref="alg2.l0.m5.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="alg2.l0.m5.1b"><apply id="alg2.l0.m5.1.1.cmml" xref="alg2.l0.m5.1.1"><csymbol cd="ambiguous" id="alg2.l0.m5.1.1.1.cmml" xref="alg2.l0.m5.1.1">subscript</csymbol><ci id="alg2.l0.m5.1.1.2.cmml" xref="alg2.l0.m5.1.1.2">𝐷</ci><ci id="alg2.l0.m5.1.1.3.cmml" xref="alg2.l0.m5.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.l0.m5.1c">D_{i}</annotation></semantics></math>, <math id="alg2.l0.m6.1" class="ltx_Math" alttext="\theta_{C_{i}}" display="inline"><semantics id="alg2.l0.m6.1a"><msub id="alg2.l0.m6.1.1" xref="alg2.l0.m6.1.1.cmml"><mi id="alg2.l0.m6.1.1.2" xref="alg2.l0.m6.1.1.2.cmml">θ</mi><msub id="alg2.l0.m6.1.1.3" xref="alg2.l0.m6.1.1.3.cmml"><mi id="alg2.l0.m6.1.1.3.2" xref="alg2.l0.m6.1.1.3.2.cmml">C</mi><mi id="alg2.l0.m6.1.1.3.3" xref="alg2.l0.m6.1.1.3.3.cmml">i</mi></msub></msub><annotation-xml encoding="MathML-Content" id="alg2.l0.m6.1b"><apply id="alg2.l0.m6.1.1.cmml" xref="alg2.l0.m6.1.1"><csymbol cd="ambiguous" id="alg2.l0.m6.1.1.1.cmml" xref="alg2.l0.m6.1.1">subscript</csymbol><ci id="alg2.l0.m6.1.1.2.cmml" xref="alg2.l0.m6.1.1.2">𝜃</ci><apply id="alg2.l0.m6.1.1.3.cmml" xref="alg2.l0.m6.1.1.3"><csymbol cd="ambiguous" id="alg2.l0.m6.1.1.3.1.cmml" xref="alg2.l0.m6.1.1.3">subscript</csymbol><ci id="alg2.l0.m6.1.1.3.2.cmml" xref="alg2.l0.m6.1.1.3.2">𝐶</ci><ci id="alg2.l0.m6.1.1.3.3.cmml" xref="alg2.l0.m6.1.1.3.3">𝑖</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.l0.m6.1c">\theta_{C_{i}}</annotation></semantics></math>’s learning rate <math id="alg2.l0.m7.1" class="ltx_Math" alttext="\alpha" display="inline"><semantics id="alg2.l0.m7.1a"><mi id="alg2.l0.m7.1.1" xref="alg2.l0.m7.1.1.cmml">α</mi><annotation-xml encoding="MathML-Content" id="alg2.l0.m7.1b"><ci id="alg2.l0.m7.1.1.cmml" xref="alg2.l0.m7.1.1">𝛼</ci></annotation-xml><annotation encoding="application/x-tex" id="alg2.l0.m7.1c">\alpha</annotation></semantics></math>, <math id="alg2.l0.m8.1" class="ltx_Math" alttext="w_{i}" display="inline"><semantics id="alg2.l0.m8.1a"><msub id="alg2.l0.m8.1.1" xref="alg2.l0.m8.1.1.cmml"><mi id="alg2.l0.m8.1.1.2" xref="alg2.l0.m8.1.1.2.cmml">w</mi><mi id="alg2.l0.m8.1.1.3" xref="alg2.l0.m8.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="alg2.l0.m8.1b"><apply id="alg2.l0.m8.1.1.cmml" xref="alg2.l0.m8.1.1"><csymbol cd="ambiguous" id="alg2.l0.m8.1.1.1.cmml" xref="alg2.l0.m8.1.1">subscript</csymbol><ci id="alg2.l0.m8.1.1.2.cmml" xref="alg2.l0.m8.1.1.2">𝑤</ci><ci id="alg2.l0.m8.1.1.3.cmml" xref="alg2.l0.m8.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.l0.m8.1c">w_{i}</annotation></semantics></math>’s learning rate <math id="alg2.l0.m9.1" class="ltx_Math" alttext="\beta" display="inline"><semantics id="alg2.l0.m9.1a"><mi id="alg2.l0.m9.1.1" xref="alg2.l0.m9.1.1.cmml">β</mi><annotation-xml encoding="MathML-Content" id="alg2.l0.m9.1b"><ci id="alg2.l0.m9.1.1.cmml" xref="alg2.l0.m9.1.1">𝛽</ci></annotation-xml><annotation encoding="application/x-tex" id="alg2.l0.m9.1c">\beta</annotation></semantics></math>, local adaptation epochs <math id="alg2.l0.m10.1" class="ltx_Math" alttext="E" display="inline"><semantics id="alg2.l0.m10.1a"><mi id="alg2.l0.m10.1.1" xref="alg2.l0.m10.1.1.cmml">E</mi><annotation-xml encoding="MathML-Content" id="alg2.l0.m10.1b"><ci id="alg2.l0.m10.1.1.cmml" xref="alg2.l0.m10.1.1">𝐸</ci></annotation-xml><annotation encoding="application/x-tex" id="alg2.l0.m10.1c">E</annotation></semantics></math>, loss function <math id="alg2.l0.m11.1" class="ltx_Math" alttext="L" display="inline"><semantics id="alg2.l0.m11.1a"><mi id="alg2.l0.m11.1.1" xref="alg2.l0.m11.1.1.cmml">L</mi><annotation-xml encoding="MathML-Content" id="alg2.l0.m11.1b"><ci id="alg2.l0.m11.1.1.cmml" xref="alg2.l0.m11.1.1">𝐿</ci></annotation-xml><annotation encoding="application/x-tex" id="alg2.l0.m11.1c">L</annotation></semantics></math>, if variant flag <math id="alg2.l0.m12.1" class="ltx_Math" alttext="v" display="inline"><semantics id="alg2.l0.m12.1a"><mi id="alg2.l0.m12.1.1" xref="alg2.l0.m12.1.1.cmml">v</mi><annotation-xml encoding="MathML-Content" id="alg2.l0.m12.1b"><ci id="alg2.l0.m12.1.1.cmml" xref="alg2.l0.m12.1.1">𝑣</ci></annotation-xml><annotation encoding="application/x-tex" id="alg2.l0.m12.1c">v</annotation></semantics></math>

</div>
<div id="alg2.l0a" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg2.l0a.1.1.1" class="ltx_text" style="font-size:80%;">0:</span></span>  personalized classifier parameter <math id="alg2.l0a.m1.1" class="ltx_Math" alttext="\theta_{C_{i}}" display="inline"><semantics id="alg2.l0a.m1.1a"><msub id="alg2.l0a.m1.1.1" xref="alg2.l0a.m1.1.1.cmml"><mi id="alg2.l0a.m1.1.1.2" xref="alg2.l0a.m1.1.1.2.cmml">θ</mi><msub id="alg2.l0a.m1.1.1.3" xref="alg2.l0a.m1.1.1.3.cmml"><mi id="alg2.l0a.m1.1.1.3.2" xref="alg2.l0a.m1.1.1.3.2.cmml">C</mi><mi id="alg2.l0a.m1.1.1.3.3" xref="alg2.l0a.m1.1.1.3.3.cmml">i</mi></msub></msub><annotation-xml encoding="MathML-Content" id="alg2.l0a.m1.1b"><apply id="alg2.l0a.m1.1.1.cmml" xref="alg2.l0a.m1.1.1"><csymbol cd="ambiguous" id="alg2.l0a.m1.1.1.1.cmml" xref="alg2.l0a.m1.1.1">subscript</csymbol><ci id="alg2.l0a.m1.1.1.2.cmml" xref="alg2.l0a.m1.1.1.2">𝜃</ci><apply id="alg2.l0a.m1.1.1.3.cmml" xref="alg2.l0a.m1.1.1.3"><csymbol cd="ambiguous" id="alg2.l0a.m1.1.1.3.1.cmml" xref="alg2.l0a.m1.1.1.3">subscript</csymbol><ci id="alg2.l0a.m1.1.1.3.2.cmml" xref="alg2.l0a.m1.1.1.3.2">𝐶</ci><ci id="alg2.l0a.m1.1.1.3.3.cmml" xref="alg2.l0a.m1.1.1.3.3">𝑖</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.l0a.m1.1c">\theta_{C_{i}}</annotation></semantics></math>, gating network parameter <math id="alg2.l0a.m2.1" class="ltx_Math" alttext="w_{i}" display="inline"><semantics id="alg2.l0a.m2.1a"><msub id="alg2.l0a.m2.1.1" xref="alg2.l0a.m2.1.1.cmml"><mi id="alg2.l0a.m2.1.1.2" xref="alg2.l0a.m2.1.1.2.cmml">w</mi><mi id="alg2.l0a.m2.1.1.3" xref="alg2.l0a.m2.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="alg2.l0a.m2.1b"><apply id="alg2.l0a.m2.1.1.cmml" xref="alg2.l0a.m2.1.1"><csymbol cd="ambiguous" id="alg2.l0a.m2.1.1.1.cmml" xref="alg2.l0a.m2.1.1">subscript</csymbol><ci id="alg2.l0a.m2.1.1.2.cmml" xref="alg2.l0a.m2.1.1.2">𝑤</ci><ci id="alg2.l0a.m2.1.1.3.cmml" xref="alg2.l0a.m2.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.l0a.m2.1c">w_{i}</annotation></semantics></math>

</div>
<div id="alg2.l1" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg2.l1.3.1.1" class="ltx_text" style="font-size:80%;">1:</span></span>  <span id="alg2.l1.2" class="ltx_text ltx_font_italic"># Initialize client’s personalized classifier parameter <math id="alg2.l1.1.m1.1" class="ltx_Math" alttext="\theta_{C_{i}}" display="inline"><semantics id="alg2.l1.1.m1.1a"><msub id="alg2.l1.1.m1.1.1" xref="alg2.l1.1.m1.1.1.cmml"><mi id="alg2.l1.1.m1.1.1.2" xref="alg2.l1.1.m1.1.1.2.cmml">θ</mi><msub id="alg2.l1.1.m1.1.1.3" xref="alg2.l1.1.m1.1.1.3.cmml"><mi id="alg2.l1.1.m1.1.1.3.2" xref="alg2.l1.1.m1.1.1.3.2.cmml">C</mi><mi id="alg2.l1.1.m1.1.1.3.3" xref="alg2.l1.1.m1.1.1.3.3.cmml">i</mi></msub></msub><annotation-xml encoding="MathML-Content" id="alg2.l1.1.m1.1b"><apply id="alg2.l1.1.m1.1.1.cmml" xref="alg2.l1.1.m1.1.1"><csymbol cd="ambiguous" id="alg2.l1.1.m1.1.1.1.cmml" xref="alg2.l1.1.m1.1.1">subscript</csymbol><ci id="alg2.l1.1.m1.1.1.2.cmml" xref="alg2.l1.1.m1.1.1.2">𝜃</ci><apply id="alg2.l1.1.m1.1.1.3.cmml" xref="alg2.l1.1.m1.1.1.3"><csymbol cd="ambiguous" id="alg2.l1.1.m1.1.1.3.1.cmml" xref="alg2.l1.1.m1.1.1.3">subscript</csymbol><ci id="alg2.l1.1.m1.1.1.3.2.cmml" xref="alg2.l1.1.m1.1.1.3.2">𝐶</ci><ci id="alg2.l1.1.m1.1.1.3.3.cmml" xref="alg2.l1.1.m1.1.1.3.3">𝑖</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.l1.1.m1.1c">\theta_{C_{i}}</annotation></semantics></math> with global <math id="alg2.l1.2.m2.1" class="ltx_Math" alttext="\theta_{C}" display="inline"><semantics id="alg2.l1.2.m2.1a"><msub id="alg2.l1.2.m2.1.1" xref="alg2.l1.2.m2.1.1.cmml"><mi id="alg2.l1.2.m2.1.1.2" xref="alg2.l1.2.m2.1.1.2.cmml">θ</mi><mi id="alg2.l1.2.m2.1.1.3" xref="alg2.l1.2.m2.1.1.3.cmml">C</mi></msub><annotation-xml encoding="MathML-Content" id="alg2.l1.2.m2.1b"><apply id="alg2.l1.2.m2.1.1.cmml" xref="alg2.l1.2.m2.1.1"><csymbol cd="ambiguous" id="alg2.l1.2.m2.1.1.1.cmml" xref="alg2.l1.2.m2.1.1">subscript</csymbol><ci id="alg2.l1.2.m2.1.1.2.cmml" xref="alg2.l1.2.m2.1.1.2">𝜃</ci><ci id="alg2.l1.2.m2.1.1.3.cmml" xref="alg2.l1.2.m2.1.1.3">𝐶</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.l1.2.m2.1c">\theta_{C}</annotation></semantics></math></span>

</div>
<div id="alg2.l2" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg2.l2.1.1.1" class="ltx_text" style="font-size:80%;">2:</span></span>  <math id="alg2.l2.m1.1" class="ltx_Math" alttext="\theta_{C_{i}}\leftarrow\theta_{C}" display="inline"><semantics id="alg2.l2.m1.1a"><mrow id="alg2.l2.m1.1.1" xref="alg2.l2.m1.1.1.cmml"><msub id="alg2.l2.m1.1.1.2" xref="alg2.l2.m1.1.1.2.cmml"><mi id="alg2.l2.m1.1.1.2.2" xref="alg2.l2.m1.1.1.2.2.cmml">θ</mi><msub id="alg2.l2.m1.1.1.2.3" xref="alg2.l2.m1.1.1.2.3.cmml"><mi id="alg2.l2.m1.1.1.2.3.2" xref="alg2.l2.m1.1.1.2.3.2.cmml">C</mi><mi id="alg2.l2.m1.1.1.2.3.3" xref="alg2.l2.m1.1.1.2.3.3.cmml">i</mi></msub></msub><mo stretchy="false" id="alg2.l2.m1.1.1.1" xref="alg2.l2.m1.1.1.1.cmml">←</mo><msub id="alg2.l2.m1.1.1.3" xref="alg2.l2.m1.1.1.3.cmml"><mi id="alg2.l2.m1.1.1.3.2" xref="alg2.l2.m1.1.1.3.2.cmml">θ</mi><mi id="alg2.l2.m1.1.1.3.3" xref="alg2.l2.m1.1.1.3.3.cmml">C</mi></msub></mrow><annotation-xml encoding="MathML-Content" id="alg2.l2.m1.1b"><apply id="alg2.l2.m1.1.1.cmml" xref="alg2.l2.m1.1.1"><ci id="alg2.l2.m1.1.1.1.cmml" xref="alg2.l2.m1.1.1.1">←</ci><apply id="alg2.l2.m1.1.1.2.cmml" xref="alg2.l2.m1.1.1.2"><csymbol cd="ambiguous" id="alg2.l2.m1.1.1.2.1.cmml" xref="alg2.l2.m1.1.1.2">subscript</csymbol><ci id="alg2.l2.m1.1.1.2.2.cmml" xref="alg2.l2.m1.1.1.2.2">𝜃</ci><apply id="alg2.l2.m1.1.1.2.3.cmml" xref="alg2.l2.m1.1.1.2.3"><csymbol cd="ambiguous" id="alg2.l2.m1.1.1.2.3.1.cmml" xref="alg2.l2.m1.1.1.2.3">subscript</csymbol><ci id="alg2.l2.m1.1.1.2.3.2.cmml" xref="alg2.l2.m1.1.1.2.3.2">𝐶</ci><ci id="alg2.l2.m1.1.1.2.3.3.cmml" xref="alg2.l2.m1.1.1.2.3.3">𝑖</ci></apply></apply><apply id="alg2.l2.m1.1.1.3.cmml" xref="alg2.l2.m1.1.1.3"><csymbol cd="ambiguous" id="alg2.l2.m1.1.1.3.1.cmml" xref="alg2.l2.m1.1.1.3">subscript</csymbol><ci id="alg2.l2.m1.1.1.3.2.cmml" xref="alg2.l2.m1.1.1.3.2">𝜃</ci><ci id="alg2.l2.m1.1.1.3.3.cmml" xref="alg2.l2.m1.1.1.3.3">𝐶</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.l2.m1.1c">\theta_{C_{i}}\leftarrow\theta_{C}</annotation></semantics></math>

</div>
<div id="alg2.l3" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg2.l3.1.1.1" class="ltx_text" style="font-size:80%;">3:</span></span>  divide <math id="alg2.l3.m1.1" class="ltx_Math" alttext="D_{i}" display="inline"><semantics id="alg2.l3.m1.1a"><msub id="alg2.l3.m1.1.1" xref="alg2.l3.m1.1.1.cmml"><mi id="alg2.l3.m1.1.1.2" xref="alg2.l3.m1.1.1.2.cmml">D</mi><mi id="alg2.l3.m1.1.1.3" xref="alg2.l3.m1.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="alg2.l3.m1.1b"><apply id="alg2.l3.m1.1.1.cmml" xref="alg2.l3.m1.1.1"><csymbol cd="ambiguous" id="alg2.l3.m1.1.1.1.cmml" xref="alg2.l3.m1.1.1">subscript</csymbol><ci id="alg2.l3.m1.1.1.2.cmml" xref="alg2.l3.m1.1.1.2">𝐷</ci><ci id="alg2.l3.m1.1.1.3.cmml" xref="alg2.l3.m1.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.l3.m1.1c">D_{i}</annotation></semantics></math> to <math id="alg2.l3.m2.1" class="ltx_Math" alttext="D_{i}^{per}" display="inline"><semantics id="alg2.l3.m2.1a"><msubsup id="alg2.l3.m2.1.1" xref="alg2.l3.m2.1.1.cmml"><mi id="alg2.l3.m2.1.1.2.2" xref="alg2.l3.m2.1.1.2.2.cmml">D</mi><mi id="alg2.l3.m2.1.1.2.3" xref="alg2.l3.m2.1.1.2.3.cmml">i</mi><mrow id="alg2.l3.m2.1.1.3" xref="alg2.l3.m2.1.1.3.cmml"><mi id="alg2.l3.m2.1.1.3.2" xref="alg2.l3.m2.1.1.3.2.cmml">p</mi><mo lspace="0em" rspace="0em" id="alg2.l3.m2.1.1.3.1" xref="alg2.l3.m2.1.1.3.1.cmml">​</mo><mi id="alg2.l3.m2.1.1.3.3" xref="alg2.l3.m2.1.1.3.3.cmml">e</mi><mo lspace="0em" rspace="0em" id="alg2.l3.m2.1.1.3.1a" xref="alg2.l3.m2.1.1.3.1.cmml">​</mo><mi id="alg2.l3.m2.1.1.3.4" xref="alg2.l3.m2.1.1.3.4.cmml">r</mi></mrow></msubsup><annotation-xml encoding="MathML-Content" id="alg2.l3.m2.1b"><apply id="alg2.l3.m2.1.1.cmml" xref="alg2.l3.m2.1.1"><csymbol cd="ambiguous" id="alg2.l3.m2.1.1.1.cmml" xref="alg2.l3.m2.1.1">superscript</csymbol><apply id="alg2.l3.m2.1.1.2.cmml" xref="alg2.l3.m2.1.1"><csymbol cd="ambiguous" id="alg2.l3.m2.1.1.2.1.cmml" xref="alg2.l3.m2.1.1">subscript</csymbol><ci id="alg2.l3.m2.1.1.2.2.cmml" xref="alg2.l3.m2.1.1.2.2">𝐷</ci><ci id="alg2.l3.m2.1.1.2.3.cmml" xref="alg2.l3.m2.1.1.2.3">𝑖</ci></apply><apply id="alg2.l3.m2.1.1.3.cmml" xref="alg2.l3.m2.1.1.3"><times id="alg2.l3.m2.1.1.3.1.cmml" xref="alg2.l3.m2.1.1.3.1"></times><ci id="alg2.l3.m2.1.1.3.2.cmml" xref="alg2.l3.m2.1.1.3.2">𝑝</ci><ci id="alg2.l3.m2.1.1.3.3.cmml" xref="alg2.l3.m2.1.1.3.3">𝑒</ci><ci id="alg2.l3.m2.1.1.3.4.cmml" xref="alg2.l3.m2.1.1.3.4">𝑟</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.l3.m2.1c">D_{i}^{per}</annotation></semantics></math>, <math id="alg2.l3.m3.1" class="ltx_Math" alttext="D_{i}^{gate}" display="inline"><semantics id="alg2.l3.m3.1a"><msubsup id="alg2.l3.m3.1.1" xref="alg2.l3.m3.1.1.cmml"><mi id="alg2.l3.m3.1.1.2.2" xref="alg2.l3.m3.1.1.2.2.cmml">D</mi><mi id="alg2.l3.m3.1.1.2.3" xref="alg2.l3.m3.1.1.2.3.cmml">i</mi><mrow id="alg2.l3.m3.1.1.3" xref="alg2.l3.m3.1.1.3.cmml"><mi id="alg2.l3.m3.1.1.3.2" xref="alg2.l3.m3.1.1.3.2.cmml">g</mi><mo lspace="0em" rspace="0em" id="alg2.l3.m3.1.1.3.1" xref="alg2.l3.m3.1.1.3.1.cmml">​</mo><mi id="alg2.l3.m3.1.1.3.3" xref="alg2.l3.m3.1.1.3.3.cmml">a</mi><mo lspace="0em" rspace="0em" id="alg2.l3.m3.1.1.3.1a" xref="alg2.l3.m3.1.1.3.1.cmml">​</mo><mi id="alg2.l3.m3.1.1.3.4" xref="alg2.l3.m3.1.1.3.4.cmml">t</mi><mo lspace="0em" rspace="0em" id="alg2.l3.m3.1.1.3.1b" xref="alg2.l3.m3.1.1.3.1.cmml">​</mo><mi id="alg2.l3.m3.1.1.3.5" xref="alg2.l3.m3.1.1.3.5.cmml">e</mi></mrow></msubsup><annotation-xml encoding="MathML-Content" id="alg2.l3.m3.1b"><apply id="alg2.l3.m3.1.1.cmml" xref="alg2.l3.m3.1.1"><csymbol cd="ambiguous" id="alg2.l3.m3.1.1.1.cmml" xref="alg2.l3.m3.1.1">superscript</csymbol><apply id="alg2.l3.m3.1.1.2.cmml" xref="alg2.l3.m3.1.1"><csymbol cd="ambiguous" id="alg2.l3.m3.1.1.2.1.cmml" xref="alg2.l3.m3.1.1">subscript</csymbol><ci id="alg2.l3.m3.1.1.2.2.cmml" xref="alg2.l3.m3.1.1.2.2">𝐷</ci><ci id="alg2.l3.m3.1.1.2.3.cmml" xref="alg2.l3.m3.1.1.2.3">𝑖</ci></apply><apply id="alg2.l3.m3.1.1.3.cmml" xref="alg2.l3.m3.1.1.3"><times id="alg2.l3.m3.1.1.3.1.cmml" xref="alg2.l3.m3.1.1.3.1"></times><ci id="alg2.l3.m3.1.1.3.2.cmml" xref="alg2.l3.m3.1.1.3.2">𝑔</ci><ci id="alg2.l3.m3.1.1.3.3.cmml" xref="alg2.l3.m3.1.1.3.3">𝑎</ci><ci id="alg2.l3.m3.1.1.3.4.cmml" xref="alg2.l3.m3.1.1.3.4">𝑡</ci><ci id="alg2.l3.m3.1.1.3.5.cmml" xref="alg2.l3.m3.1.1.3.5">𝑒</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.l3.m3.1c">D_{i}^{gate}</annotation></semantics></math>

</div>
<div id="alg2.l4" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg2.l4.1.1.1" class="ltx_text" style="font-size:80%;">4:</span></span>  <span id="alg2.l4.2" class="ltx_text ltx_font_bold">for</span> epoch <math id="alg2.l4.m1.1" class="ltx_Math" alttext="e=1" display="inline"><semantics id="alg2.l4.m1.1a"><mrow id="alg2.l4.m1.1.1" xref="alg2.l4.m1.1.1.cmml"><mi id="alg2.l4.m1.1.1.2" xref="alg2.l4.m1.1.1.2.cmml">e</mi><mo id="alg2.l4.m1.1.1.1" xref="alg2.l4.m1.1.1.1.cmml">=</mo><mn id="alg2.l4.m1.1.1.3" xref="alg2.l4.m1.1.1.3.cmml">1</mn></mrow><annotation-xml encoding="MathML-Content" id="alg2.l4.m1.1b"><apply id="alg2.l4.m1.1.1.cmml" xref="alg2.l4.m1.1.1"><eq id="alg2.l4.m1.1.1.1.cmml" xref="alg2.l4.m1.1.1.1"></eq><ci id="alg2.l4.m1.1.1.2.cmml" xref="alg2.l4.m1.1.1.2">𝑒</ci><cn type="integer" id="alg2.l4.m1.1.1.3.cmml" xref="alg2.l4.m1.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.l4.m1.1c">e=1</annotation></semantics></math> to <math id="alg2.l4.m2.1" class="ltx_Math" alttext="E" display="inline"><semantics id="alg2.l4.m2.1a"><mi id="alg2.l4.m2.1.1" xref="alg2.l4.m2.1.1.cmml">E</mi><annotation-xml encoding="MathML-Content" id="alg2.l4.m2.1b"><ci id="alg2.l4.m2.1.1.cmml" xref="alg2.l4.m2.1.1">𝐸</ci></annotation-xml><annotation encoding="application/x-tex" id="alg2.l4.m2.1c">E</annotation></semantics></math>  <span id="alg2.l4.3" class="ltx_text ltx_font_bold">do</span>



</div>
<div id="alg2.l5" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg2.l5.1.1.1" class="ltx_text" style="font-size:80%;">5:</span></span>     <span id="alg2.l5.2" class="ltx_text ltx_font_italic"># Local adaptation</span>

</div>
<div id="alg2.l6" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg2.l6.1.1.1" class="ltx_text" style="font-size:80%;">6:</span></span>     <span id="alg2.l6.2" class="ltx_text ltx_font_bold">for</span> batch <math id="alg2.l6.m1.2" class="ltx_Math" alttext="(x,y)\subset D_{i}^{per}" display="inline"><semantics id="alg2.l6.m1.2a"><mrow id="alg2.l6.m1.2.3" xref="alg2.l6.m1.2.3.cmml"><mrow id="alg2.l6.m1.2.3.2.2" xref="alg2.l6.m1.2.3.2.1.cmml"><mo stretchy="false" id="alg2.l6.m1.2.3.2.2.1" xref="alg2.l6.m1.2.3.2.1.cmml">(</mo><mi id="alg2.l6.m1.1.1" xref="alg2.l6.m1.1.1.cmml">x</mi><mo id="alg2.l6.m1.2.3.2.2.2" xref="alg2.l6.m1.2.3.2.1.cmml">,</mo><mi id="alg2.l6.m1.2.2" xref="alg2.l6.m1.2.2.cmml">y</mi><mo stretchy="false" id="alg2.l6.m1.2.3.2.2.3" xref="alg2.l6.m1.2.3.2.1.cmml">)</mo></mrow><mo id="alg2.l6.m1.2.3.1" xref="alg2.l6.m1.2.3.1.cmml">⊂</mo><msubsup id="alg2.l6.m1.2.3.3" xref="alg2.l6.m1.2.3.3.cmml"><mi id="alg2.l6.m1.2.3.3.2.2" xref="alg2.l6.m1.2.3.3.2.2.cmml">D</mi><mi id="alg2.l6.m1.2.3.3.2.3" xref="alg2.l6.m1.2.3.3.2.3.cmml">i</mi><mrow id="alg2.l6.m1.2.3.3.3" xref="alg2.l6.m1.2.3.3.3.cmml"><mi id="alg2.l6.m1.2.3.3.3.2" xref="alg2.l6.m1.2.3.3.3.2.cmml">p</mi><mo lspace="0em" rspace="0em" id="alg2.l6.m1.2.3.3.3.1" xref="alg2.l6.m1.2.3.3.3.1.cmml">​</mo><mi id="alg2.l6.m1.2.3.3.3.3" xref="alg2.l6.m1.2.3.3.3.3.cmml">e</mi><mo lspace="0em" rspace="0em" id="alg2.l6.m1.2.3.3.3.1a" xref="alg2.l6.m1.2.3.3.3.1.cmml">​</mo><mi id="alg2.l6.m1.2.3.3.3.4" xref="alg2.l6.m1.2.3.3.3.4.cmml">r</mi></mrow></msubsup></mrow><annotation-xml encoding="MathML-Content" id="alg2.l6.m1.2b"><apply id="alg2.l6.m1.2.3.cmml" xref="alg2.l6.m1.2.3"><subset id="alg2.l6.m1.2.3.1.cmml" xref="alg2.l6.m1.2.3.1"></subset><interval closure="open" id="alg2.l6.m1.2.3.2.1.cmml" xref="alg2.l6.m1.2.3.2.2"><ci id="alg2.l6.m1.1.1.cmml" xref="alg2.l6.m1.1.1">𝑥</ci><ci id="alg2.l6.m1.2.2.cmml" xref="alg2.l6.m1.2.2">𝑦</ci></interval><apply id="alg2.l6.m1.2.3.3.cmml" xref="alg2.l6.m1.2.3.3"><csymbol cd="ambiguous" id="alg2.l6.m1.2.3.3.1.cmml" xref="alg2.l6.m1.2.3.3">superscript</csymbol><apply id="alg2.l6.m1.2.3.3.2.cmml" xref="alg2.l6.m1.2.3.3"><csymbol cd="ambiguous" id="alg2.l6.m1.2.3.3.2.1.cmml" xref="alg2.l6.m1.2.3.3">subscript</csymbol><ci id="alg2.l6.m1.2.3.3.2.2.cmml" xref="alg2.l6.m1.2.3.3.2.2">𝐷</ci><ci id="alg2.l6.m1.2.3.3.2.3.cmml" xref="alg2.l6.m1.2.3.3.2.3">𝑖</ci></apply><apply id="alg2.l6.m1.2.3.3.3.cmml" xref="alg2.l6.m1.2.3.3.3"><times id="alg2.l6.m1.2.3.3.3.1.cmml" xref="alg2.l6.m1.2.3.3.3.1"></times><ci id="alg2.l6.m1.2.3.3.3.2.cmml" xref="alg2.l6.m1.2.3.3.3.2">𝑝</ci><ci id="alg2.l6.m1.2.3.3.3.3.cmml" xref="alg2.l6.m1.2.3.3.3.3">𝑒</ci><ci id="alg2.l6.m1.2.3.3.3.4.cmml" xref="alg2.l6.m1.2.3.3.3.4">𝑟</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.l6.m1.2c">(x,y)\subset D_{i}^{per}</annotation></semantics></math>  <span id="alg2.l6.3" class="ltx_text ltx_font_bold">do</span>



</div>
<div id="alg2.l7" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg2.l7.1.1.1" class="ltx_text" style="font-size:80%;">7:</span></span>        <math id="alg2.l7.m1.3" class="ltx_Math" alttext="\widehat{y}\leftarrow M_{C}(\theta_{C};M_{E}(\theta_{E};x))" display="inline"><semantics id="alg2.l7.m1.3a"><mrow id="alg2.l7.m1.3.3" xref="alg2.l7.m1.3.3.cmml"><mover accent="true" id="alg2.l7.m1.3.3.4" xref="alg2.l7.m1.3.3.4.cmml"><mi id="alg2.l7.m1.3.3.4.2" xref="alg2.l7.m1.3.3.4.2.cmml">y</mi><mo id="alg2.l7.m1.3.3.4.1" xref="alg2.l7.m1.3.3.4.1.cmml">^</mo></mover><mo stretchy="false" id="alg2.l7.m1.3.3.3" xref="alg2.l7.m1.3.3.3.cmml">←</mo><mrow id="alg2.l7.m1.3.3.2" xref="alg2.l7.m1.3.3.2.cmml"><msub id="alg2.l7.m1.3.3.2.4" xref="alg2.l7.m1.3.3.2.4.cmml"><mi id="alg2.l7.m1.3.3.2.4.2" xref="alg2.l7.m1.3.3.2.4.2.cmml">M</mi><mi id="alg2.l7.m1.3.3.2.4.3" xref="alg2.l7.m1.3.3.2.4.3.cmml">C</mi></msub><mo lspace="0em" rspace="0em" id="alg2.l7.m1.3.3.2.3" xref="alg2.l7.m1.3.3.2.3.cmml">​</mo><mrow id="alg2.l7.m1.3.3.2.2.2" xref="alg2.l7.m1.3.3.2.2.3.cmml"><mo stretchy="false" id="alg2.l7.m1.3.3.2.2.2.3" xref="alg2.l7.m1.3.3.2.2.3.cmml">(</mo><msub id="alg2.l7.m1.2.2.1.1.1.1" xref="alg2.l7.m1.2.2.1.1.1.1.cmml"><mi id="alg2.l7.m1.2.2.1.1.1.1.2" xref="alg2.l7.m1.2.2.1.1.1.1.2.cmml">θ</mi><mi id="alg2.l7.m1.2.2.1.1.1.1.3" xref="alg2.l7.m1.2.2.1.1.1.1.3.cmml">C</mi></msub><mo id="alg2.l7.m1.3.3.2.2.2.4" xref="alg2.l7.m1.3.3.2.2.3.cmml">;</mo><mrow id="alg2.l7.m1.3.3.2.2.2.2" xref="alg2.l7.m1.3.3.2.2.2.2.cmml"><msub id="alg2.l7.m1.3.3.2.2.2.2.3" xref="alg2.l7.m1.3.3.2.2.2.2.3.cmml"><mi id="alg2.l7.m1.3.3.2.2.2.2.3.2" xref="alg2.l7.m1.3.3.2.2.2.2.3.2.cmml">M</mi><mi id="alg2.l7.m1.3.3.2.2.2.2.3.3" xref="alg2.l7.m1.3.3.2.2.2.2.3.3.cmml">E</mi></msub><mo lspace="0em" rspace="0em" id="alg2.l7.m1.3.3.2.2.2.2.2" xref="alg2.l7.m1.3.3.2.2.2.2.2.cmml">​</mo><mrow id="alg2.l7.m1.3.3.2.2.2.2.1.1" xref="alg2.l7.m1.3.3.2.2.2.2.1.2.cmml"><mo stretchy="false" id="alg2.l7.m1.3.3.2.2.2.2.1.1.2" xref="alg2.l7.m1.3.3.2.2.2.2.1.2.cmml">(</mo><msub id="alg2.l7.m1.3.3.2.2.2.2.1.1.1" xref="alg2.l7.m1.3.3.2.2.2.2.1.1.1.cmml"><mi id="alg2.l7.m1.3.3.2.2.2.2.1.1.1.2" xref="alg2.l7.m1.3.3.2.2.2.2.1.1.1.2.cmml">θ</mi><mi id="alg2.l7.m1.3.3.2.2.2.2.1.1.1.3" xref="alg2.l7.m1.3.3.2.2.2.2.1.1.1.3.cmml">E</mi></msub><mo id="alg2.l7.m1.3.3.2.2.2.2.1.1.3" xref="alg2.l7.m1.3.3.2.2.2.2.1.2.cmml">;</mo><mi id="alg2.l7.m1.1.1" xref="alg2.l7.m1.1.1.cmml">x</mi><mo stretchy="false" id="alg2.l7.m1.3.3.2.2.2.2.1.1.4" xref="alg2.l7.m1.3.3.2.2.2.2.1.2.cmml">)</mo></mrow></mrow><mo stretchy="false" id="alg2.l7.m1.3.3.2.2.2.5" xref="alg2.l7.m1.3.3.2.2.3.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg2.l7.m1.3b"><apply id="alg2.l7.m1.3.3.cmml" xref="alg2.l7.m1.3.3"><ci id="alg2.l7.m1.3.3.3.cmml" xref="alg2.l7.m1.3.3.3">←</ci><apply id="alg2.l7.m1.3.3.4.cmml" xref="alg2.l7.m1.3.3.4"><ci id="alg2.l7.m1.3.3.4.1.cmml" xref="alg2.l7.m1.3.3.4.1">^</ci><ci id="alg2.l7.m1.3.3.4.2.cmml" xref="alg2.l7.m1.3.3.4.2">𝑦</ci></apply><apply id="alg2.l7.m1.3.3.2.cmml" xref="alg2.l7.m1.3.3.2"><times id="alg2.l7.m1.3.3.2.3.cmml" xref="alg2.l7.m1.3.3.2.3"></times><apply id="alg2.l7.m1.3.3.2.4.cmml" xref="alg2.l7.m1.3.3.2.4"><csymbol cd="ambiguous" id="alg2.l7.m1.3.3.2.4.1.cmml" xref="alg2.l7.m1.3.3.2.4">subscript</csymbol><ci id="alg2.l7.m1.3.3.2.4.2.cmml" xref="alg2.l7.m1.3.3.2.4.2">𝑀</ci><ci id="alg2.l7.m1.3.3.2.4.3.cmml" xref="alg2.l7.m1.3.3.2.4.3">𝐶</ci></apply><list id="alg2.l7.m1.3.3.2.2.3.cmml" xref="alg2.l7.m1.3.3.2.2.2"><apply id="alg2.l7.m1.2.2.1.1.1.1.cmml" xref="alg2.l7.m1.2.2.1.1.1.1"><csymbol cd="ambiguous" id="alg2.l7.m1.2.2.1.1.1.1.1.cmml" xref="alg2.l7.m1.2.2.1.1.1.1">subscript</csymbol><ci id="alg2.l7.m1.2.2.1.1.1.1.2.cmml" xref="alg2.l7.m1.2.2.1.1.1.1.2">𝜃</ci><ci id="alg2.l7.m1.2.2.1.1.1.1.3.cmml" xref="alg2.l7.m1.2.2.1.1.1.1.3">𝐶</ci></apply><apply id="alg2.l7.m1.3.3.2.2.2.2.cmml" xref="alg2.l7.m1.3.3.2.2.2.2"><times id="alg2.l7.m1.3.3.2.2.2.2.2.cmml" xref="alg2.l7.m1.3.3.2.2.2.2.2"></times><apply id="alg2.l7.m1.3.3.2.2.2.2.3.cmml" xref="alg2.l7.m1.3.3.2.2.2.2.3"><csymbol cd="ambiguous" id="alg2.l7.m1.3.3.2.2.2.2.3.1.cmml" xref="alg2.l7.m1.3.3.2.2.2.2.3">subscript</csymbol><ci id="alg2.l7.m1.3.3.2.2.2.2.3.2.cmml" xref="alg2.l7.m1.3.3.2.2.2.2.3.2">𝑀</ci><ci id="alg2.l7.m1.3.3.2.2.2.2.3.3.cmml" xref="alg2.l7.m1.3.3.2.2.2.2.3.3">𝐸</ci></apply><list id="alg2.l7.m1.3.3.2.2.2.2.1.2.cmml" xref="alg2.l7.m1.3.3.2.2.2.2.1.1"><apply id="alg2.l7.m1.3.3.2.2.2.2.1.1.1.cmml" xref="alg2.l7.m1.3.3.2.2.2.2.1.1.1"><csymbol cd="ambiguous" id="alg2.l7.m1.3.3.2.2.2.2.1.1.1.1.cmml" xref="alg2.l7.m1.3.3.2.2.2.2.1.1.1">subscript</csymbol><ci id="alg2.l7.m1.3.3.2.2.2.2.1.1.1.2.cmml" xref="alg2.l7.m1.3.3.2.2.2.2.1.1.1.2">𝜃</ci><ci id="alg2.l7.m1.3.3.2.2.2.2.1.1.1.3.cmml" xref="alg2.l7.m1.3.3.2.2.2.2.1.1.1.3">𝐸</ci></apply><ci id="alg2.l7.m1.1.1.cmml" xref="alg2.l7.m1.1.1">𝑥</ci></list></apply></list></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.l7.m1.3c">\widehat{y}\leftarrow M_{C}(\theta_{C};M_{E}(\theta_{E};x))</annotation></semantics></math>

</div>
<div id="alg2.l8" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg2.l8.1.1.1" class="ltx_text" style="font-size:80%;">8:</span></span>        <math id="alg2.l8.m1.2" class="ltx_Math" alttext="\theta_{C_{i}}\leftarrow\theta_{C_{i}}-\alpha\cdot\triangledown_{\theta_{C_{i}}}{L(\widehat{y},y)}" display="inline"><semantics id="alg2.l8.m1.2a"><mrow id="alg2.l8.m1.2.3" xref="alg2.l8.m1.2.3.cmml"><msub id="alg2.l8.m1.2.3.2" xref="alg2.l8.m1.2.3.2.cmml"><mi id="alg2.l8.m1.2.3.2.2" xref="alg2.l8.m1.2.3.2.2.cmml">θ</mi><msub id="alg2.l8.m1.2.3.2.3" xref="alg2.l8.m1.2.3.2.3.cmml"><mi id="alg2.l8.m1.2.3.2.3.2" xref="alg2.l8.m1.2.3.2.3.2.cmml">C</mi><mi id="alg2.l8.m1.2.3.2.3.3" xref="alg2.l8.m1.2.3.2.3.3.cmml">i</mi></msub></msub><mo stretchy="false" id="alg2.l8.m1.2.3.1" xref="alg2.l8.m1.2.3.1.cmml">←</mo><mrow id="alg2.l8.m1.2.3.3" xref="alg2.l8.m1.2.3.3.cmml"><msub id="alg2.l8.m1.2.3.3.2" xref="alg2.l8.m1.2.3.3.2.cmml"><mi id="alg2.l8.m1.2.3.3.2.2" xref="alg2.l8.m1.2.3.3.2.2.cmml">θ</mi><msub id="alg2.l8.m1.2.3.3.2.3" xref="alg2.l8.m1.2.3.3.2.3.cmml"><mi id="alg2.l8.m1.2.3.3.2.3.2" xref="alg2.l8.m1.2.3.3.2.3.2.cmml">C</mi><mi id="alg2.l8.m1.2.3.3.2.3.3" xref="alg2.l8.m1.2.3.3.2.3.3.cmml">i</mi></msub></msub><mo id="alg2.l8.m1.2.3.3.1" xref="alg2.l8.m1.2.3.3.1.cmml">−</mo><mrow id="alg2.l8.m1.2.3.3.3" xref="alg2.l8.m1.2.3.3.3.cmml"><mrow id="alg2.l8.m1.2.3.3.3.2" xref="alg2.l8.m1.2.3.3.3.2.cmml"><mi id="alg2.l8.m1.2.3.3.3.2.2" xref="alg2.l8.m1.2.3.3.3.2.2.cmml">α</mi><mo lspace="0.222em" rspace="0.222em" id="alg2.l8.m1.2.3.3.3.2.1" xref="alg2.l8.m1.2.3.3.3.2.1.cmml">⋅</mo><msub id="alg2.l8.m1.2.3.3.3.2.3" xref="alg2.l8.m1.2.3.3.3.2.3.cmml"><mi mathvariant="normal" id="alg2.l8.m1.2.3.3.3.2.3.2" xref="alg2.l8.m1.2.3.3.3.2.3.2.cmml">▽</mi><msub id="alg2.l8.m1.2.3.3.3.2.3.3" xref="alg2.l8.m1.2.3.3.3.2.3.3.cmml"><mi id="alg2.l8.m1.2.3.3.3.2.3.3.2" xref="alg2.l8.m1.2.3.3.3.2.3.3.2.cmml">θ</mi><msub id="alg2.l8.m1.2.3.3.3.2.3.3.3" xref="alg2.l8.m1.2.3.3.3.2.3.3.3.cmml"><mi id="alg2.l8.m1.2.3.3.3.2.3.3.3.2" xref="alg2.l8.m1.2.3.3.3.2.3.3.3.2.cmml">C</mi><mi id="alg2.l8.m1.2.3.3.3.2.3.3.3.3" xref="alg2.l8.m1.2.3.3.3.2.3.3.3.3.cmml">i</mi></msub></msub></msub></mrow><mo lspace="0em" rspace="0em" id="alg2.l8.m1.2.3.3.3.1" xref="alg2.l8.m1.2.3.3.3.1.cmml">​</mo><mi id="alg2.l8.m1.2.3.3.3.3" xref="alg2.l8.m1.2.3.3.3.3.cmml">L</mi><mo lspace="0em" rspace="0em" id="alg2.l8.m1.2.3.3.3.1a" xref="alg2.l8.m1.2.3.3.3.1.cmml">​</mo><mrow id="alg2.l8.m1.2.3.3.3.4.2" xref="alg2.l8.m1.2.3.3.3.4.1.cmml"><mo stretchy="false" id="alg2.l8.m1.2.3.3.3.4.2.1" xref="alg2.l8.m1.2.3.3.3.4.1.cmml">(</mo><mover accent="true" id="alg2.l8.m1.1.1" xref="alg2.l8.m1.1.1.cmml"><mi id="alg2.l8.m1.1.1.2" xref="alg2.l8.m1.1.1.2.cmml">y</mi><mo id="alg2.l8.m1.1.1.1" xref="alg2.l8.m1.1.1.1.cmml">^</mo></mover><mo id="alg2.l8.m1.2.3.3.3.4.2.2" xref="alg2.l8.m1.2.3.3.3.4.1.cmml">,</mo><mi id="alg2.l8.m1.2.2" xref="alg2.l8.m1.2.2.cmml">y</mi><mo stretchy="false" id="alg2.l8.m1.2.3.3.3.4.2.3" xref="alg2.l8.m1.2.3.3.3.4.1.cmml">)</mo></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg2.l8.m1.2b"><apply id="alg2.l8.m1.2.3.cmml" xref="alg2.l8.m1.2.3"><ci id="alg2.l8.m1.2.3.1.cmml" xref="alg2.l8.m1.2.3.1">←</ci><apply id="alg2.l8.m1.2.3.2.cmml" xref="alg2.l8.m1.2.3.2"><csymbol cd="ambiguous" id="alg2.l8.m1.2.3.2.1.cmml" xref="alg2.l8.m1.2.3.2">subscript</csymbol><ci id="alg2.l8.m1.2.3.2.2.cmml" xref="alg2.l8.m1.2.3.2.2">𝜃</ci><apply id="alg2.l8.m1.2.3.2.3.cmml" xref="alg2.l8.m1.2.3.2.3"><csymbol cd="ambiguous" id="alg2.l8.m1.2.3.2.3.1.cmml" xref="alg2.l8.m1.2.3.2.3">subscript</csymbol><ci id="alg2.l8.m1.2.3.2.3.2.cmml" xref="alg2.l8.m1.2.3.2.3.2">𝐶</ci><ci id="alg2.l8.m1.2.3.2.3.3.cmml" xref="alg2.l8.m1.2.3.2.3.3">𝑖</ci></apply></apply><apply id="alg2.l8.m1.2.3.3.cmml" xref="alg2.l8.m1.2.3.3"><minus id="alg2.l8.m1.2.3.3.1.cmml" xref="alg2.l8.m1.2.3.3.1"></minus><apply id="alg2.l8.m1.2.3.3.2.cmml" xref="alg2.l8.m1.2.3.3.2"><csymbol cd="ambiguous" id="alg2.l8.m1.2.3.3.2.1.cmml" xref="alg2.l8.m1.2.3.3.2">subscript</csymbol><ci id="alg2.l8.m1.2.3.3.2.2.cmml" xref="alg2.l8.m1.2.3.3.2.2">𝜃</ci><apply id="alg2.l8.m1.2.3.3.2.3.cmml" xref="alg2.l8.m1.2.3.3.2.3"><csymbol cd="ambiguous" id="alg2.l8.m1.2.3.3.2.3.1.cmml" xref="alg2.l8.m1.2.3.3.2.3">subscript</csymbol><ci id="alg2.l8.m1.2.3.3.2.3.2.cmml" xref="alg2.l8.m1.2.3.3.2.3.2">𝐶</ci><ci id="alg2.l8.m1.2.3.3.2.3.3.cmml" xref="alg2.l8.m1.2.3.3.2.3.3">𝑖</ci></apply></apply><apply id="alg2.l8.m1.2.3.3.3.cmml" xref="alg2.l8.m1.2.3.3.3"><times id="alg2.l8.m1.2.3.3.3.1.cmml" xref="alg2.l8.m1.2.3.3.3.1"></times><apply id="alg2.l8.m1.2.3.3.3.2.cmml" xref="alg2.l8.m1.2.3.3.3.2"><ci id="alg2.l8.m1.2.3.3.3.2.1.cmml" xref="alg2.l8.m1.2.3.3.3.2.1">⋅</ci><ci id="alg2.l8.m1.2.3.3.3.2.2.cmml" xref="alg2.l8.m1.2.3.3.3.2.2">𝛼</ci><apply id="alg2.l8.m1.2.3.3.3.2.3.cmml" xref="alg2.l8.m1.2.3.3.3.2.3"><csymbol cd="ambiguous" id="alg2.l8.m1.2.3.3.3.2.3.1.cmml" xref="alg2.l8.m1.2.3.3.3.2.3">subscript</csymbol><ci id="alg2.l8.m1.2.3.3.3.2.3.2.cmml" xref="alg2.l8.m1.2.3.3.3.2.3.2">▽</ci><apply id="alg2.l8.m1.2.3.3.3.2.3.3.cmml" xref="alg2.l8.m1.2.3.3.3.2.3.3"><csymbol cd="ambiguous" id="alg2.l8.m1.2.3.3.3.2.3.3.1.cmml" xref="alg2.l8.m1.2.3.3.3.2.3.3">subscript</csymbol><ci id="alg2.l8.m1.2.3.3.3.2.3.3.2.cmml" xref="alg2.l8.m1.2.3.3.3.2.3.3.2">𝜃</ci><apply id="alg2.l8.m1.2.3.3.3.2.3.3.3.cmml" xref="alg2.l8.m1.2.3.3.3.2.3.3.3"><csymbol cd="ambiguous" id="alg2.l8.m1.2.3.3.3.2.3.3.3.1.cmml" xref="alg2.l8.m1.2.3.3.3.2.3.3.3">subscript</csymbol><ci id="alg2.l8.m1.2.3.3.3.2.3.3.3.2.cmml" xref="alg2.l8.m1.2.3.3.3.2.3.3.3.2">𝐶</ci><ci id="alg2.l8.m1.2.3.3.3.2.3.3.3.3.cmml" xref="alg2.l8.m1.2.3.3.3.2.3.3.3.3">𝑖</ci></apply></apply></apply></apply><ci id="alg2.l8.m1.2.3.3.3.3.cmml" xref="alg2.l8.m1.2.3.3.3.3">𝐿</ci><interval closure="open" id="alg2.l8.m1.2.3.3.3.4.1.cmml" xref="alg2.l8.m1.2.3.3.3.4.2"><apply id="alg2.l8.m1.1.1.cmml" xref="alg2.l8.m1.1.1"><ci id="alg2.l8.m1.1.1.1.cmml" xref="alg2.l8.m1.1.1.1">^</ci><ci id="alg2.l8.m1.1.1.2.cmml" xref="alg2.l8.m1.1.1.2">𝑦</ci></apply><ci id="alg2.l8.m1.2.2.cmml" xref="alg2.l8.m1.2.2">𝑦</ci></interval></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.l8.m1.2c">\theta_{C_{i}}\leftarrow\theta_{C_{i}}-\alpha\cdot\triangledown_{\theta_{C_{i}}}{L(\widehat{y},y)}</annotation></semantics></math>

</div>
<div id="alg2.l9" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg2.l9.1.1.1" class="ltx_text" style="font-size:80%;">9:</span></span>     <span id="alg2.l9.2" class="ltx_text ltx_font_bold">end</span> <span id="alg2.l9.3" class="ltx_text ltx_font_bold">for</span>
</div>
<div id="alg2.l10" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg2.l10.1.1.1" class="ltx_text" style="font-size:80%;">10:</span></span>     <span id="alg2.l10.2" class="ltx_text ltx_font_italic"># Mixing two experts</span>

</div>
<div id="alg2.l11" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg2.l11.1.1.1" class="ltx_text" style="font-size:80%;">11:</span></span>     <span id="alg2.l11.2" class="ltx_text ltx_font_bold">for</span> batch <math id="alg2.l11.m1.2" class="ltx_Math" alttext="(x,y)\subset D_{i}^{gate}" display="inline"><semantics id="alg2.l11.m1.2a"><mrow id="alg2.l11.m1.2.3" xref="alg2.l11.m1.2.3.cmml"><mrow id="alg2.l11.m1.2.3.2.2" xref="alg2.l11.m1.2.3.2.1.cmml"><mo stretchy="false" id="alg2.l11.m1.2.3.2.2.1" xref="alg2.l11.m1.2.3.2.1.cmml">(</mo><mi id="alg2.l11.m1.1.1" xref="alg2.l11.m1.1.1.cmml">x</mi><mo id="alg2.l11.m1.2.3.2.2.2" xref="alg2.l11.m1.2.3.2.1.cmml">,</mo><mi id="alg2.l11.m1.2.2" xref="alg2.l11.m1.2.2.cmml">y</mi><mo stretchy="false" id="alg2.l11.m1.2.3.2.2.3" xref="alg2.l11.m1.2.3.2.1.cmml">)</mo></mrow><mo id="alg2.l11.m1.2.3.1" xref="alg2.l11.m1.2.3.1.cmml">⊂</mo><msubsup id="alg2.l11.m1.2.3.3" xref="alg2.l11.m1.2.3.3.cmml"><mi id="alg2.l11.m1.2.3.3.2.2" xref="alg2.l11.m1.2.3.3.2.2.cmml">D</mi><mi id="alg2.l11.m1.2.3.3.2.3" xref="alg2.l11.m1.2.3.3.2.3.cmml">i</mi><mrow id="alg2.l11.m1.2.3.3.3" xref="alg2.l11.m1.2.3.3.3.cmml"><mi id="alg2.l11.m1.2.3.3.3.2" xref="alg2.l11.m1.2.3.3.3.2.cmml">g</mi><mo lspace="0em" rspace="0em" id="alg2.l11.m1.2.3.3.3.1" xref="alg2.l11.m1.2.3.3.3.1.cmml">​</mo><mi id="alg2.l11.m1.2.3.3.3.3" xref="alg2.l11.m1.2.3.3.3.3.cmml">a</mi><mo lspace="0em" rspace="0em" id="alg2.l11.m1.2.3.3.3.1a" xref="alg2.l11.m1.2.3.3.3.1.cmml">​</mo><mi id="alg2.l11.m1.2.3.3.3.4" xref="alg2.l11.m1.2.3.3.3.4.cmml">t</mi><mo lspace="0em" rspace="0em" id="alg2.l11.m1.2.3.3.3.1b" xref="alg2.l11.m1.2.3.3.3.1.cmml">​</mo><mi id="alg2.l11.m1.2.3.3.3.5" xref="alg2.l11.m1.2.3.3.3.5.cmml">e</mi></mrow></msubsup></mrow><annotation-xml encoding="MathML-Content" id="alg2.l11.m1.2b"><apply id="alg2.l11.m1.2.3.cmml" xref="alg2.l11.m1.2.3"><subset id="alg2.l11.m1.2.3.1.cmml" xref="alg2.l11.m1.2.3.1"></subset><interval closure="open" id="alg2.l11.m1.2.3.2.1.cmml" xref="alg2.l11.m1.2.3.2.2"><ci id="alg2.l11.m1.1.1.cmml" xref="alg2.l11.m1.1.1">𝑥</ci><ci id="alg2.l11.m1.2.2.cmml" xref="alg2.l11.m1.2.2">𝑦</ci></interval><apply id="alg2.l11.m1.2.3.3.cmml" xref="alg2.l11.m1.2.3.3"><csymbol cd="ambiguous" id="alg2.l11.m1.2.3.3.1.cmml" xref="alg2.l11.m1.2.3.3">superscript</csymbol><apply id="alg2.l11.m1.2.3.3.2.cmml" xref="alg2.l11.m1.2.3.3"><csymbol cd="ambiguous" id="alg2.l11.m1.2.3.3.2.1.cmml" xref="alg2.l11.m1.2.3.3">subscript</csymbol><ci id="alg2.l11.m1.2.3.3.2.2.cmml" xref="alg2.l11.m1.2.3.3.2.2">𝐷</ci><ci id="alg2.l11.m1.2.3.3.2.3.cmml" xref="alg2.l11.m1.2.3.3.2.3">𝑖</ci></apply><apply id="alg2.l11.m1.2.3.3.3.cmml" xref="alg2.l11.m1.2.3.3.3"><times id="alg2.l11.m1.2.3.3.3.1.cmml" xref="alg2.l11.m1.2.3.3.3.1"></times><ci id="alg2.l11.m1.2.3.3.3.2.cmml" xref="alg2.l11.m1.2.3.3.3.2">𝑔</ci><ci id="alg2.l11.m1.2.3.3.3.3.cmml" xref="alg2.l11.m1.2.3.3.3.3">𝑎</ci><ci id="alg2.l11.m1.2.3.3.3.4.cmml" xref="alg2.l11.m1.2.3.3.3.4">𝑡</ci><ci id="alg2.l11.m1.2.3.3.3.5.cmml" xref="alg2.l11.m1.2.3.3.3.5">𝑒</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.l11.m1.2c">(x,y)\subset D_{i}^{gate}</annotation></semantics></math>  <span id="alg2.l11.3" class="ltx_text ltx_font_bold">do</span>



</div>
<div id="alg2.l12" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg2.l12.1.1.1" class="ltx_text" style="font-size:80%;">12:</span></span>        <math id="alg2.l12.m1.2" class="ltx_Math" alttext="a\leftarrow M_{E}(\theta_{E};x)" display="inline"><semantics id="alg2.l12.m1.2a"><mrow id="alg2.l12.m1.2.2" xref="alg2.l12.m1.2.2.cmml"><mi id="alg2.l12.m1.2.2.3" xref="alg2.l12.m1.2.2.3.cmml">a</mi><mo stretchy="false" id="alg2.l12.m1.2.2.2" xref="alg2.l12.m1.2.2.2.cmml">←</mo><mrow id="alg2.l12.m1.2.2.1" xref="alg2.l12.m1.2.2.1.cmml"><msub id="alg2.l12.m1.2.2.1.3" xref="alg2.l12.m1.2.2.1.3.cmml"><mi id="alg2.l12.m1.2.2.1.3.2" xref="alg2.l12.m1.2.2.1.3.2.cmml">M</mi><mi id="alg2.l12.m1.2.2.1.3.3" xref="alg2.l12.m1.2.2.1.3.3.cmml">E</mi></msub><mo lspace="0em" rspace="0em" id="alg2.l12.m1.2.2.1.2" xref="alg2.l12.m1.2.2.1.2.cmml">​</mo><mrow id="alg2.l12.m1.2.2.1.1.1" xref="alg2.l12.m1.2.2.1.1.2.cmml"><mo stretchy="false" id="alg2.l12.m1.2.2.1.1.1.2" xref="alg2.l12.m1.2.2.1.1.2.cmml">(</mo><msub id="alg2.l12.m1.2.2.1.1.1.1" xref="alg2.l12.m1.2.2.1.1.1.1.cmml"><mi id="alg2.l12.m1.2.2.1.1.1.1.2" xref="alg2.l12.m1.2.2.1.1.1.1.2.cmml">θ</mi><mi id="alg2.l12.m1.2.2.1.1.1.1.3" xref="alg2.l12.m1.2.2.1.1.1.1.3.cmml">E</mi></msub><mo id="alg2.l12.m1.2.2.1.1.1.3" xref="alg2.l12.m1.2.2.1.1.2.cmml">;</mo><mi id="alg2.l12.m1.1.1" xref="alg2.l12.m1.1.1.cmml">x</mi><mo stretchy="false" id="alg2.l12.m1.2.2.1.1.1.4" xref="alg2.l12.m1.2.2.1.1.2.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg2.l12.m1.2b"><apply id="alg2.l12.m1.2.2.cmml" xref="alg2.l12.m1.2.2"><ci id="alg2.l12.m1.2.2.2.cmml" xref="alg2.l12.m1.2.2.2">←</ci><ci id="alg2.l12.m1.2.2.3.cmml" xref="alg2.l12.m1.2.2.3">𝑎</ci><apply id="alg2.l12.m1.2.2.1.cmml" xref="alg2.l12.m1.2.2.1"><times id="alg2.l12.m1.2.2.1.2.cmml" xref="alg2.l12.m1.2.2.1.2"></times><apply id="alg2.l12.m1.2.2.1.3.cmml" xref="alg2.l12.m1.2.2.1.3"><csymbol cd="ambiguous" id="alg2.l12.m1.2.2.1.3.1.cmml" xref="alg2.l12.m1.2.2.1.3">subscript</csymbol><ci id="alg2.l12.m1.2.2.1.3.2.cmml" xref="alg2.l12.m1.2.2.1.3.2">𝑀</ci><ci id="alg2.l12.m1.2.2.1.3.3.cmml" xref="alg2.l12.m1.2.2.1.3.3">𝐸</ci></apply><list id="alg2.l12.m1.2.2.1.1.2.cmml" xref="alg2.l12.m1.2.2.1.1.1"><apply id="alg2.l12.m1.2.2.1.1.1.1.cmml" xref="alg2.l12.m1.2.2.1.1.1.1"><csymbol cd="ambiguous" id="alg2.l12.m1.2.2.1.1.1.1.1.cmml" xref="alg2.l12.m1.2.2.1.1.1.1">subscript</csymbol><ci id="alg2.l12.m1.2.2.1.1.1.1.2.cmml" xref="alg2.l12.m1.2.2.1.1.1.1.2">𝜃</ci><ci id="alg2.l12.m1.2.2.1.1.1.1.3.cmml" xref="alg2.l12.m1.2.2.1.1.1.1.3">𝐸</ci></apply><ci id="alg2.l12.m1.1.1.cmml" xref="alg2.l12.m1.1.1">𝑥</ci></list></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.l12.m1.2c">a\leftarrow M_{E}(\theta_{E};x)</annotation></semantics></math>

</div>
<div id="alg2.l13" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg2.l13.1.1.1" class="ltx_text" style="font-size:80%;">13:</span></span>        <span id="alg2.l13.2" class="ltx_text ltx_font_bold">if</span>  <math id="alg2.l13.m1.1" class="ltx_Math" alttext="v" display="inline"><semantics id="alg2.l13.m1.1a"><mi id="alg2.l13.m1.1.1" xref="alg2.l13.m1.1.1.cmml">v</mi><annotation-xml encoding="MathML-Content" id="alg2.l13.m1.1b"><ci id="alg2.l13.m1.1.1.cmml" xref="alg2.l13.m1.1.1">𝑣</ci></annotation-xml><annotation encoding="application/x-tex" id="alg2.l13.m1.1c">v</annotation></semantics></math>  <span id="alg2.l13.3" class="ltx_text ltx_font_bold">then</span>



</div>
<div id="alg2.l14" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg2.l14.1.1.1" class="ltx_text" style="font-size:80%;">14:</span></span>           <math id="alg2.l14.m1.2" class="ltx_Math" alttext="g\leftarrow sigmoid(G(w_{i};a))" display="inline"><semantics id="alg2.l14.m1.2a"><mrow id="alg2.l14.m1.2.2" xref="alg2.l14.m1.2.2.cmml"><mi id="alg2.l14.m1.2.2.3" xref="alg2.l14.m1.2.2.3.cmml">g</mi><mo stretchy="false" id="alg2.l14.m1.2.2.2" xref="alg2.l14.m1.2.2.2.cmml">←</mo><mrow id="alg2.l14.m1.2.2.1" xref="alg2.l14.m1.2.2.1.cmml"><mi id="alg2.l14.m1.2.2.1.3" xref="alg2.l14.m1.2.2.1.3.cmml">s</mi><mo lspace="0em" rspace="0em" id="alg2.l14.m1.2.2.1.2" xref="alg2.l14.m1.2.2.1.2.cmml">​</mo><mi id="alg2.l14.m1.2.2.1.4" xref="alg2.l14.m1.2.2.1.4.cmml">i</mi><mo lspace="0em" rspace="0em" id="alg2.l14.m1.2.2.1.2a" xref="alg2.l14.m1.2.2.1.2.cmml">​</mo><mi id="alg2.l14.m1.2.2.1.5" xref="alg2.l14.m1.2.2.1.5.cmml">g</mi><mo lspace="0em" rspace="0em" id="alg2.l14.m1.2.2.1.2b" xref="alg2.l14.m1.2.2.1.2.cmml">​</mo><mi id="alg2.l14.m1.2.2.1.6" xref="alg2.l14.m1.2.2.1.6.cmml">m</mi><mo lspace="0em" rspace="0em" id="alg2.l14.m1.2.2.1.2c" xref="alg2.l14.m1.2.2.1.2.cmml">​</mo><mi id="alg2.l14.m1.2.2.1.7" xref="alg2.l14.m1.2.2.1.7.cmml">o</mi><mo lspace="0em" rspace="0em" id="alg2.l14.m1.2.2.1.2d" xref="alg2.l14.m1.2.2.1.2.cmml">​</mo><mi id="alg2.l14.m1.2.2.1.8" xref="alg2.l14.m1.2.2.1.8.cmml">i</mi><mo lspace="0em" rspace="0em" id="alg2.l14.m1.2.2.1.2e" xref="alg2.l14.m1.2.2.1.2.cmml">​</mo><mi id="alg2.l14.m1.2.2.1.9" xref="alg2.l14.m1.2.2.1.9.cmml">d</mi><mo lspace="0em" rspace="0em" id="alg2.l14.m1.2.2.1.2f" xref="alg2.l14.m1.2.2.1.2.cmml">​</mo><mrow id="alg2.l14.m1.2.2.1.1.1" xref="alg2.l14.m1.2.2.1.1.1.1.cmml"><mo stretchy="false" id="alg2.l14.m1.2.2.1.1.1.2" xref="alg2.l14.m1.2.2.1.1.1.1.cmml">(</mo><mrow id="alg2.l14.m1.2.2.1.1.1.1" xref="alg2.l14.m1.2.2.1.1.1.1.cmml"><mi id="alg2.l14.m1.2.2.1.1.1.1.3" xref="alg2.l14.m1.2.2.1.1.1.1.3.cmml">G</mi><mo lspace="0em" rspace="0em" id="alg2.l14.m1.2.2.1.1.1.1.2" xref="alg2.l14.m1.2.2.1.1.1.1.2.cmml">​</mo><mrow id="alg2.l14.m1.2.2.1.1.1.1.1.1" xref="alg2.l14.m1.2.2.1.1.1.1.1.2.cmml"><mo stretchy="false" id="alg2.l14.m1.2.2.1.1.1.1.1.1.2" xref="alg2.l14.m1.2.2.1.1.1.1.1.2.cmml">(</mo><msub id="alg2.l14.m1.2.2.1.1.1.1.1.1.1" xref="alg2.l14.m1.2.2.1.1.1.1.1.1.1.cmml"><mi id="alg2.l14.m1.2.2.1.1.1.1.1.1.1.2" xref="alg2.l14.m1.2.2.1.1.1.1.1.1.1.2.cmml">w</mi><mi id="alg2.l14.m1.2.2.1.1.1.1.1.1.1.3" xref="alg2.l14.m1.2.2.1.1.1.1.1.1.1.3.cmml">i</mi></msub><mo id="alg2.l14.m1.2.2.1.1.1.1.1.1.3" xref="alg2.l14.m1.2.2.1.1.1.1.1.2.cmml">;</mo><mi id="alg2.l14.m1.1.1" xref="alg2.l14.m1.1.1.cmml">a</mi><mo stretchy="false" id="alg2.l14.m1.2.2.1.1.1.1.1.1.4" xref="alg2.l14.m1.2.2.1.1.1.1.1.2.cmml">)</mo></mrow></mrow><mo stretchy="false" id="alg2.l14.m1.2.2.1.1.1.3" xref="alg2.l14.m1.2.2.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg2.l14.m1.2b"><apply id="alg2.l14.m1.2.2.cmml" xref="alg2.l14.m1.2.2"><ci id="alg2.l14.m1.2.2.2.cmml" xref="alg2.l14.m1.2.2.2">←</ci><ci id="alg2.l14.m1.2.2.3.cmml" xref="alg2.l14.m1.2.2.3">𝑔</ci><apply id="alg2.l14.m1.2.2.1.cmml" xref="alg2.l14.m1.2.2.1"><times id="alg2.l14.m1.2.2.1.2.cmml" xref="alg2.l14.m1.2.2.1.2"></times><ci id="alg2.l14.m1.2.2.1.3.cmml" xref="alg2.l14.m1.2.2.1.3">𝑠</ci><ci id="alg2.l14.m1.2.2.1.4.cmml" xref="alg2.l14.m1.2.2.1.4">𝑖</ci><ci id="alg2.l14.m1.2.2.1.5.cmml" xref="alg2.l14.m1.2.2.1.5">𝑔</ci><ci id="alg2.l14.m1.2.2.1.6.cmml" xref="alg2.l14.m1.2.2.1.6">𝑚</ci><ci id="alg2.l14.m1.2.2.1.7.cmml" xref="alg2.l14.m1.2.2.1.7">𝑜</ci><ci id="alg2.l14.m1.2.2.1.8.cmml" xref="alg2.l14.m1.2.2.1.8">𝑖</ci><ci id="alg2.l14.m1.2.2.1.9.cmml" xref="alg2.l14.m1.2.2.1.9">𝑑</ci><apply id="alg2.l14.m1.2.2.1.1.1.1.cmml" xref="alg2.l14.m1.2.2.1.1.1"><times id="alg2.l14.m1.2.2.1.1.1.1.2.cmml" xref="alg2.l14.m1.2.2.1.1.1.1.2"></times><ci id="alg2.l14.m1.2.2.1.1.1.1.3.cmml" xref="alg2.l14.m1.2.2.1.1.1.1.3">𝐺</ci><list id="alg2.l14.m1.2.2.1.1.1.1.1.2.cmml" xref="alg2.l14.m1.2.2.1.1.1.1.1.1"><apply id="alg2.l14.m1.2.2.1.1.1.1.1.1.1.cmml" xref="alg2.l14.m1.2.2.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="alg2.l14.m1.2.2.1.1.1.1.1.1.1.1.cmml" xref="alg2.l14.m1.2.2.1.1.1.1.1.1.1">subscript</csymbol><ci id="alg2.l14.m1.2.2.1.1.1.1.1.1.1.2.cmml" xref="alg2.l14.m1.2.2.1.1.1.1.1.1.1.2">𝑤</ci><ci id="alg2.l14.m1.2.2.1.1.1.1.1.1.1.3.cmml" xref="alg2.l14.m1.2.2.1.1.1.1.1.1.1.3">𝑖</ci></apply><ci id="alg2.l14.m1.1.1.cmml" xref="alg2.l14.m1.1.1">𝑎</ci></list></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.l14.m1.2c">g\leftarrow sigmoid(G(w_{i};a))</annotation></semantics></math> <span id="alg2.l14.2" class="ltx_text ltx_font_italic"># PFL-MFE</span>

</div>
<div id="alg2.l15" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg2.l15.1.1.1" class="ltx_text" style="font-size:80%;">15:</span></span>        <span id="alg2.l15.2" class="ltx_text ltx_font_bold">else</span>


</div>
<div id="alg2.l16" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg2.l16.1.1.1" class="ltx_text" style="font-size:80%;">16:</span></span>           <math id="alg2.l16.m1.2" class="ltx_Math" alttext="g\leftarrow sigmoid(G(w_{i};x))" display="inline"><semantics id="alg2.l16.m1.2a"><mrow id="alg2.l16.m1.2.2" xref="alg2.l16.m1.2.2.cmml"><mi id="alg2.l16.m1.2.2.3" xref="alg2.l16.m1.2.2.3.cmml">g</mi><mo stretchy="false" id="alg2.l16.m1.2.2.2" xref="alg2.l16.m1.2.2.2.cmml">←</mo><mrow id="alg2.l16.m1.2.2.1" xref="alg2.l16.m1.2.2.1.cmml"><mi id="alg2.l16.m1.2.2.1.3" xref="alg2.l16.m1.2.2.1.3.cmml">s</mi><mo lspace="0em" rspace="0em" id="alg2.l16.m1.2.2.1.2" xref="alg2.l16.m1.2.2.1.2.cmml">​</mo><mi id="alg2.l16.m1.2.2.1.4" xref="alg2.l16.m1.2.2.1.4.cmml">i</mi><mo lspace="0em" rspace="0em" id="alg2.l16.m1.2.2.1.2a" xref="alg2.l16.m1.2.2.1.2.cmml">​</mo><mi id="alg2.l16.m1.2.2.1.5" xref="alg2.l16.m1.2.2.1.5.cmml">g</mi><mo lspace="0em" rspace="0em" id="alg2.l16.m1.2.2.1.2b" xref="alg2.l16.m1.2.2.1.2.cmml">​</mo><mi id="alg2.l16.m1.2.2.1.6" xref="alg2.l16.m1.2.2.1.6.cmml">m</mi><mo lspace="0em" rspace="0em" id="alg2.l16.m1.2.2.1.2c" xref="alg2.l16.m1.2.2.1.2.cmml">​</mo><mi id="alg2.l16.m1.2.2.1.7" xref="alg2.l16.m1.2.2.1.7.cmml">o</mi><mo lspace="0em" rspace="0em" id="alg2.l16.m1.2.2.1.2d" xref="alg2.l16.m1.2.2.1.2.cmml">​</mo><mi id="alg2.l16.m1.2.2.1.8" xref="alg2.l16.m1.2.2.1.8.cmml">i</mi><mo lspace="0em" rspace="0em" id="alg2.l16.m1.2.2.1.2e" xref="alg2.l16.m1.2.2.1.2.cmml">​</mo><mi id="alg2.l16.m1.2.2.1.9" xref="alg2.l16.m1.2.2.1.9.cmml">d</mi><mo lspace="0em" rspace="0em" id="alg2.l16.m1.2.2.1.2f" xref="alg2.l16.m1.2.2.1.2.cmml">​</mo><mrow id="alg2.l16.m1.2.2.1.1.1" xref="alg2.l16.m1.2.2.1.1.1.1.cmml"><mo stretchy="false" id="alg2.l16.m1.2.2.1.1.1.2" xref="alg2.l16.m1.2.2.1.1.1.1.cmml">(</mo><mrow id="alg2.l16.m1.2.2.1.1.1.1" xref="alg2.l16.m1.2.2.1.1.1.1.cmml"><mi id="alg2.l16.m1.2.2.1.1.1.1.3" xref="alg2.l16.m1.2.2.1.1.1.1.3.cmml">G</mi><mo lspace="0em" rspace="0em" id="alg2.l16.m1.2.2.1.1.1.1.2" xref="alg2.l16.m1.2.2.1.1.1.1.2.cmml">​</mo><mrow id="alg2.l16.m1.2.2.1.1.1.1.1.1" xref="alg2.l16.m1.2.2.1.1.1.1.1.2.cmml"><mo stretchy="false" id="alg2.l16.m1.2.2.1.1.1.1.1.1.2" xref="alg2.l16.m1.2.2.1.1.1.1.1.2.cmml">(</mo><msub id="alg2.l16.m1.2.2.1.1.1.1.1.1.1" xref="alg2.l16.m1.2.2.1.1.1.1.1.1.1.cmml"><mi id="alg2.l16.m1.2.2.1.1.1.1.1.1.1.2" xref="alg2.l16.m1.2.2.1.1.1.1.1.1.1.2.cmml">w</mi><mi id="alg2.l16.m1.2.2.1.1.1.1.1.1.1.3" xref="alg2.l16.m1.2.2.1.1.1.1.1.1.1.3.cmml">i</mi></msub><mo id="alg2.l16.m1.2.2.1.1.1.1.1.1.3" xref="alg2.l16.m1.2.2.1.1.1.1.1.2.cmml">;</mo><mi id="alg2.l16.m1.1.1" xref="alg2.l16.m1.1.1.cmml">x</mi><mo stretchy="false" id="alg2.l16.m1.2.2.1.1.1.1.1.1.4" xref="alg2.l16.m1.2.2.1.1.1.1.1.2.cmml">)</mo></mrow></mrow><mo stretchy="false" id="alg2.l16.m1.2.2.1.1.1.3" xref="alg2.l16.m1.2.2.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg2.l16.m1.2b"><apply id="alg2.l16.m1.2.2.cmml" xref="alg2.l16.m1.2.2"><ci id="alg2.l16.m1.2.2.2.cmml" xref="alg2.l16.m1.2.2.2">←</ci><ci id="alg2.l16.m1.2.2.3.cmml" xref="alg2.l16.m1.2.2.3">𝑔</ci><apply id="alg2.l16.m1.2.2.1.cmml" xref="alg2.l16.m1.2.2.1"><times id="alg2.l16.m1.2.2.1.2.cmml" xref="alg2.l16.m1.2.2.1.2"></times><ci id="alg2.l16.m1.2.2.1.3.cmml" xref="alg2.l16.m1.2.2.1.3">𝑠</ci><ci id="alg2.l16.m1.2.2.1.4.cmml" xref="alg2.l16.m1.2.2.1.4">𝑖</ci><ci id="alg2.l16.m1.2.2.1.5.cmml" xref="alg2.l16.m1.2.2.1.5">𝑔</ci><ci id="alg2.l16.m1.2.2.1.6.cmml" xref="alg2.l16.m1.2.2.1.6">𝑚</ci><ci id="alg2.l16.m1.2.2.1.7.cmml" xref="alg2.l16.m1.2.2.1.7">𝑜</ci><ci id="alg2.l16.m1.2.2.1.8.cmml" xref="alg2.l16.m1.2.2.1.8">𝑖</ci><ci id="alg2.l16.m1.2.2.1.9.cmml" xref="alg2.l16.m1.2.2.1.9">𝑑</ci><apply id="alg2.l16.m1.2.2.1.1.1.1.cmml" xref="alg2.l16.m1.2.2.1.1.1"><times id="alg2.l16.m1.2.2.1.1.1.1.2.cmml" xref="alg2.l16.m1.2.2.1.1.1.1.2"></times><ci id="alg2.l16.m1.2.2.1.1.1.1.3.cmml" xref="alg2.l16.m1.2.2.1.1.1.1.3">𝐺</ci><list id="alg2.l16.m1.2.2.1.1.1.1.1.2.cmml" xref="alg2.l16.m1.2.2.1.1.1.1.1.1"><apply id="alg2.l16.m1.2.2.1.1.1.1.1.1.1.cmml" xref="alg2.l16.m1.2.2.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="alg2.l16.m1.2.2.1.1.1.1.1.1.1.1.cmml" xref="alg2.l16.m1.2.2.1.1.1.1.1.1.1">subscript</csymbol><ci id="alg2.l16.m1.2.2.1.1.1.1.1.1.1.2.cmml" xref="alg2.l16.m1.2.2.1.1.1.1.1.1.1.2">𝑤</ci><ci id="alg2.l16.m1.2.2.1.1.1.1.1.1.1.3.cmml" xref="alg2.l16.m1.2.2.1.1.1.1.1.1.1.3">𝑖</ci></apply><ci id="alg2.l16.m1.1.1.cmml" xref="alg2.l16.m1.1.1">𝑥</ci></list></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.l16.m1.2c">g\leftarrow sigmoid(G(w_{i};x))</annotation></semantics></math> <span id="alg2.l16.2" class="ltx_text ltx_font_italic"># PFL-MF</span>

</div>
<div id="alg2.l17" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg2.l17.1.1.1" class="ltx_text" style="font-size:80%;">17:</span></span>        <span id="alg2.l17.2" class="ltx_text ltx_font_bold">end</span> <span id="alg2.l17.3" class="ltx_text ltx_font_bold">if</span>
</div>
<div id="alg2.l18" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg2.l18.1.1.1" class="ltx_text" style="font-size:80%;">18:</span></span>        <math id="alg2.l18.m1.5" class="ltx_Math" alttext="\tilde{y}\leftarrow g\cdot M_{C}(\theta_{C};a)+(1-g)\cdot M_{C}(\theta_{C_{i}};a)" display="inline"><semantics id="alg2.l18.m1.5a"><mrow id="alg2.l18.m1.5.5" xref="alg2.l18.m1.5.5.cmml"><mover accent="true" id="alg2.l18.m1.5.5.5" xref="alg2.l18.m1.5.5.5.cmml"><mi id="alg2.l18.m1.5.5.5.2" xref="alg2.l18.m1.5.5.5.2.cmml">y</mi><mo id="alg2.l18.m1.5.5.5.1" xref="alg2.l18.m1.5.5.5.1.cmml">~</mo></mover><mo stretchy="false" id="alg2.l18.m1.5.5.4" xref="alg2.l18.m1.5.5.4.cmml">←</mo><mrow id="alg2.l18.m1.5.5.3" xref="alg2.l18.m1.5.5.3.cmml"><mrow id="alg2.l18.m1.3.3.1.1" xref="alg2.l18.m1.3.3.1.1.cmml"><mrow id="alg2.l18.m1.3.3.1.1.3" xref="alg2.l18.m1.3.3.1.1.3.cmml"><mi id="alg2.l18.m1.3.3.1.1.3.2" xref="alg2.l18.m1.3.3.1.1.3.2.cmml">g</mi><mo lspace="0.222em" rspace="0.222em" id="alg2.l18.m1.3.3.1.1.3.1" xref="alg2.l18.m1.3.3.1.1.3.1.cmml">⋅</mo><msub id="alg2.l18.m1.3.3.1.1.3.3" xref="alg2.l18.m1.3.3.1.1.3.3.cmml"><mi id="alg2.l18.m1.3.3.1.1.3.3.2" xref="alg2.l18.m1.3.3.1.1.3.3.2.cmml">M</mi><mi id="alg2.l18.m1.3.3.1.1.3.3.3" xref="alg2.l18.m1.3.3.1.1.3.3.3.cmml">C</mi></msub></mrow><mo lspace="0em" rspace="0em" id="alg2.l18.m1.3.3.1.1.2" xref="alg2.l18.m1.3.3.1.1.2.cmml">​</mo><mrow id="alg2.l18.m1.3.3.1.1.1.1" xref="alg2.l18.m1.3.3.1.1.1.2.cmml"><mo stretchy="false" id="alg2.l18.m1.3.3.1.1.1.1.2" xref="alg2.l18.m1.3.3.1.1.1.2.cmml">(</mo><msub id="alg2.l18.m1.3.3.1.1.1.1.1" xref="alg2.l18.m1.3.3.1.1.1.1.1.cmml"><mi id="alg2.l18.m1.3.3.1.1.1.1.1.2" xref="alg2.l18.m1.3.3.1.1.1.1.1.2.cmml">θ</mi><mi id="alg2.l18.m1.3.3.1.1.1.1.1.3" xref="alg2.l18.m1.3.3.1.1.1.1.1.3.cmml">C</mi></msub><mo id="alg2.l18.m1.3.3.1.1.1.1.3" xref="alg2.l18.m1.3.3.1.1.1.2.cmml">;</mo><mi id="alg2.l18.m1.1.1" xref="alg2.l18.m1.1.1.cmml">a</mi><mo stretchy="false" id="alg2.l18.m1.3.3.1.1.1.1.4" xref="alg2.l18.m1.3.3.1.1.1.2.cmml">)</mo></mrow></mrow><mo id="alg2.l18.m1.5.5.3.4" xref="alg2.l18.m1.5.5.3.4.cmml">+</mo><mrow id="alg2.l18.m1.5.5.3.3" xref="alg2.l18.m1.5.5.3.3.cmml"><mrow id="alg2.l18.m1.4.4.2.2.1" xref="alg2.l18.m1.4.4.2.2.1.cmml"><mrow id="alg2.l18.m1.4.4.2.2.1.1.1" xref="alg2.l18.m1.4.4.2.2.1.1.1.1.cmml"><mo stretchy="false" id="alg2.l18.m1.4.4.2.2.1.1.1.2" xref="alg2.l18.m1.4.4.2.2.1.1.1.1.cmml">(</mo><mrow id="alg2.l18.m1.4.4.2.2.1.1.1.1" xref="alg2.l18.m1.4.4.2.2.1.1.1.1.cmml"><mn id="alg2.l18.m1.4.4.2.2.1.1.1.1.2" xref="alg2.l18.m1.4.4.2.2.1.1.1.1.2.cmml">1</mn><mo id="alg2.l18.m1.4.4.2.2.1.1.1.1.1" xref="alg2.l18.m1.4.4.2.2.1.1.1.1.1.cmml">−</mo><mi id="alg2.l18.m1.4.4.2.2.1.1.1.1.3" xref="alg2.l18.m1.4.4.2.2.1.1.1.1.3.cmml">g</mi></mrow><mo rspace="0.055em" stretchy="false" id="alg2.l18.m1.4.4.2.2.1.1.1.3" xref="alg2.l18.m1.4.4.2.2.1.1.1.1.cmml">)</mo></mrow><mo rspace="0.222em" id="alg2.l18.m1.4.4.2.2.1.2" xref="alg2.l18.m1.4.4.2.2.1.2.cmml">⋅</mo><msub id="alg2.l18.m1.4.4.2.2.1.3" xref="alg2.l18.m1.4.4.2.2.1.3.cmml"><mi id="alg2.l18.m1.4.4.2.2.1.3.2" xref="alg2.l18.m1.4.4.2.2.1.3.2.cmml">M</mi><mi id="alg2.l18.m1.4.4.2.2.1.3.3" xref="alg2.l18.m1.4.4.2.2.1.3.3.cmml">C</mi></msub></mrow><mo lspace="0em" rspace="0em" id="alg2.l18.m1.5.5.3.3.3" xref="alg2.l18.m1.5.5.3.3.3.cmml">​</mo><mrow id="alg2.l18.m1.5.5.3.3.2.1" xref="alg2.l18.m1.5.5.3.3.2.2.cmml"><mo stretchy="false" id="alg2.l18.m1.5.5.3.3.2.1.2" xref="alg2.l18.m1.5.5.3.3.2.2.cmml">(</mo><msub id="alg2.l18.m1.5.5.3.3.2.1.1" xref="alg2.l18.m1.5.5.3.3.2.1.1.cmml"><mi id="alg2.l18.m1.5.5.3.3.2.1.1.2" xref="alg2.l18.m1.5.5.3.3.2.1.1.2.cmml">θ</mi><msub id="alg2.l18.m1.5.5.3.3.2.1.1.3" xref="alg2.l18.m1.5.5.3.3.2.1.1.3.cmml"><mi id="alg2.l18.m1.5.5.3.3.2.1.1.3.2" xref="alg2.l18.m1.5.5.3.3.2.1.1.3.2.cmml">C</mi><mi id="alg2.l18.m1.5.5.3.3.2.1.1.3.3" xref="alg2.l18.m1.5.5.3.3.2.1.1.3.3.cmml">i</mi></msub></msub><mo id="alg2.l18.m1.5.5.3.3.2.1.3" xref="alg2.l18.m1.5.5.3.3.2.2.cmml">;</mo><mi id="alg2.l18.m1.2.2" xref="alg2.l18.m1.2.2.cmml">a</mi><mo stretchy="false" id="alg2.l18.m1.5.5.3.3.2.1.4" xref="alg2.l18.m1.5.5.3.3.2.2.cmml">)</mo></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg2.l18.m1.5b"><apply id="alg2.l18.m1.5.5.cmml" xref="alg2.l18.m1.5.5"><ci id="alg2.l18.m1.5.5.4.cmml" xref="alg2.l18.m1.5.5.4">←</ci><apply id="alg2.l18.m1.5.5.5.cmml" xref="alg2.l18.m1.5.5.5"><ci id="alg2.l18.m1.5.5.5.1.cmml" xref="alg2.l18.m1.5.5.5.1">~</ci><ci id="alg2.l18.m1.5.5.5.2.cmml" xref="alg2.l18.m1.5.5.5.2">𝑦</ci></apply><apply id="alg2.l18.m1.5.5.3.cmml" xref="alg2.l18.m1.5.5.3"><plus id="alg2.l18.m1.5.5.3.4.cmml" xref="alg2.l18.m1.5.5.3.4"></plus><apply id="alg2.l18.m1.3.3.1.1.cmml" xref="alg2.l18.m1.3.3.1.1"><times id="alg2.l18.m1.3.3.1.1.2.cmml" xref="alg2.l18.m1.3.3.1.1.2"></times><apply id="alg2.l18.m1.3.3.1.1.3.cmml" xref="alg2.l18.m1.3.3.1.1.3"><ci id="alg2.l18.m1.3.3.1.1.3.1.cmml" xref="alg2.l18.m1.3.3.1.1.3.1">⋅</ci><ci id="alg2.l18.m1.3.3.1.1.3.2.cmml" xref="alg2.l18.m1.3.3.1.1.3.2">𝑔</ci><apply id="alg2.l18.m1.3.3.1.1.3.3.cmml" xref="alg2.l18.m1.3.3.1.1.3.3"><csymbol cd="ambiguous" id="alg2.l18.m1.3.3.1.1.3.3.1.cmml" xref="alg2.l18.m1.3.3.1.1.3.3">subscript</csymbol><ci id="alg2.l18.m1.3.3.1.1.3.3.2.cmml" xref="alg2.l18.m1.3.3.1.1.3.3.2">𝑀</ci><ci id="alg2.l18.m1.3.3.1.1.3.3.3.cmml" xref="alg2.l18.m1.3.3.1.1.3.3.3">𝐶</ci></apply></apply><list id="alg2.l18.m1.3.3.1.1.1.2.cmml" xref="alg2.l18.m1.3.3.1.1.1.1"><apply id="alg2.l18.m1.3.3.1.1.1.1.1.cmml" xref="alg2.l18.m1.3.3.1.1.1.1.1"><csymbol cd="ambiguous" id="alg2.l18.m1.3.3.1.1.1.1.1.1.cmml" xref="alg2.l18.m1.3.3.1.1.1.1.1">subscript</csymbol><ci id="alg2.l18.m1.3.3.1.1.1.1.1.2.cmml" xref="alg2.l18.m1.3.3.1.1.1.1.1.2">𝜃</ci><ci id="alg2.l18.m1.3.3.1.1.1.1.1.3.cmml" xref="alg2.l18.m1.3.3.1.1.1.1.1.3">𝐶</ci></apply><ci id="alg2.l18.m1.1.1.cmml" xref="alg2.l18.m1.1.1">𝑎</ci></list></apply><apply id="alg2.l18.m1.5.5.3.3.cmml" xref="alg2.l18.m1.5.5.3.3"><times id="alg2.l18.m1.5.5.3.3.3.cmml" xref="alg2.l18.m1.5.5.3.3.3"></times><apply id="alg2.l18.m1.4.4.2.2.1.cmml" xref="alg2.l18.m1.4.4.2.2.1"><ci id="alg2.l18.m1.4.4.2.2.1.2.cmml" xref="alg2.l18.m1.4.4.2.2.1.2">⋅</ci><apply id="alg2.l18.m1.4.4.2.2.1.1.1.1.cmml" xref="alg2.l18.m1.4.4.2.2.1.1.1"><minus id="alg2.l18.m1.4.4.2.2.1.1.1.1.1.cmml" xref="alg2.l18.m1.4.4.2.2.1.1.1.1.1"></minus><cn type="integer" id="alg2.l18.m1.4.4.2.2.1.1.1.1.2.cmml" xref="alg2.l18.m1.4.4.2.2.1.1.1.1.2">1</cn><ci id="alg2.l18.m1.4.4.2.2.1.1.1.1.3.cmml" xref="alg2.l18.m1.4.4.2.2.1.1.1.1.3">𝑔</ci></apply><apply id="alg2.l18.m1.4.4.2.2.1.3.cmml" xref="alg2.l18.m1.4.4.2.2.1.3"><csymbol cd="ambiguous" id="alg2.l18.m1.4.4.2.2.1.3.1.cmml" xref="alg2.l18.m1.4.4.2.2.1.3">subscript</csymbol><ci id="alg2.l18.m1.4.4.2.2.1.3.2.cmml" xref="alg2.l18.m1.4.4.2.2.1.3.2">𝑀</ci><ci id="alg2.l18.m1.4.4.2.2.1.3.3.cmml" xref="alg2.l18.m1.4.4.2.2.1.3.3">𝐶</ci></apply></apply><list id="alg2.l18.m1.5.5.3.3.2.2.cmml" xref="alg2.l18.m1.5.5.3.3.2.1"><apply id="alg2.l18.m1.5.5.3.3.2.1.1.cmml" xref="alg2.l18.m1.5.5.3.3.2.1.1"><csymbol cd="ambiguous" id="alg2.l18.m1.5.5.3.3.2.1.1.1.cmml" xref="alg2.l18.m1.5.5.3.3.2.1.1">subscript</csymbol><ci id="alg2.l18.m1.5.5.3.3.2.1.1.2.cmml" xref="alg2.l18.m1.5.5.3.3.2.1.1.2">𝜃</ci><apply id="alg2.l18.m1.5.5.3.3.2.1.1.3.cmml" xref="alg2.l18.m1.5.5.3.3.2.1.1.3"><csymbol cd="ambiguous" id="alg2.l18.m1.5.5.3.3.2.1.1.3.1.cmml" xref="alg2.l18.m1.5.5.3.3.2.1.1.3">subscript</csymbol><ci id="alg2.l18.m1.5.5.3.3.2.1.1.3.2.cmml" xref="alg2.l18.m1.5.5.3.3.2.1.1.3.2">𝐶</ci><ci id="alg2.l18.m1.5.5.3.3.2.1.1.3.3.cmml" xref="alg2.l18.m1.5.5.3.3.2.1.1.3.3">𝑖</ci></apply></apply><ci id="alg2.l18.m1.2.2.cmml" xref="alg2.l18.m1.2.2">𝑎</ci></list></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.l18.m1.5c">\tilde{y}\leftarrow g\cdot M_{C}(\theta_{C};a)+(1-g)\cdot M_{C}(\theta_{C_{i}};a)</annotation></semantics></math>

</div>
<div id="alg2.l19" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg2.l19.1.1.1" class="ltx_text" style="font-size:80%;">19:</span></span>        <math id="alg2.l19.m1.2" class="ltx_Math" alttext="w_{i}\leftarrow w_{i}-\beta\cdot\triangledown_{w_{i}}{L(\tilde{y},y)}" display="inline"><semantics id="alg2.l19.m1.2a"><mrow id="alg2.l19.m1.2.3" xref="alg2.l19.m1.2.3.cmml"><msub id="alg2.l19.m1.2.3.2" xref="alg2.l19.m1.2.3.2.cmml"><mi id="alg2.l19.m1.2.3.2.2" xref="alg2.l19.m1.2.3.2.2.cmml">w</mi><mi id="alg2.l19.m1.2.3.2.3" xref="alg2.l19.m1.2.3.2.3.cmml">i</mi></msub><mo stretchy="false" id="alg2.l19.m1.2.3.1" xref="alg2.l19.m1.2.3.1.cmml">←</mo><mrow id="alg2.l19.m1.2.3.3" xref="alg2.l19.m1.2.3.3.cmml"><msub id="alg2.l19.m1.2.3.3.2" xref="alg2.l19.m1.2.3.3.2.cmml"><mi id="alg2.l19.m1.2.3.3.2.2" xref="alg2.l19.m1.2.3.3.2.2.cmml">w</mi><mi id="alg2.l19.m1.2.3.3.2.3" xref="alg2.l19.m1.2.3.3.2.3.cmml">i</mi></msub><mo id="alg2.l19.m1.2.3.3.1" xref="alg2.l19.m1.2.3.3.1.cmml">−</mo><mrow id="alg2.l19.m1.2.3.3.3" xref="alg2.l19.m1.2.3.3.3.cmml"><mrow id="alg2.l19.m1.2.3.3.3.2" xref="alg2.l19.m1.2.3.3.3.2.cmml"><mi id="alg2.l19.m1.2.3.3.3.2.2" xref="alg2.l19.m1.2.3.3.3.2.2.cmml">β</mi><mo lspace="0.222em" rspace="0.222em" id="alg2.l19.m1.2.3.3.3.2.1" xref="alg2.l19.m1.2.3.3.3.2.1.cmml">⋅</mo><msub id="alg2.l19.m1.2.3.3.3.2.3" xref="alg2.l19.m1.2.3.3.3.2.3.cmml"><mi mathvariant="normal" id="alg2.l19.m1.2.3.3.3.2.3.2" xref="alg2.l19.m1.2.3.3.3.2.3.2.cmml">▽</mi><msub id="alg2.l19.m1.2.3.3.3.2.3.3" xref="alg2.l19.m1.2.3.3.3.2.3.3.cmml"><mi id="alg2.l19.m1.2.3.3.3.2.3.3.2" xref="alg2.l19.m1.2.3.3.3.2.3.3.2.cmml">w</mi><mi id="alg2.l19.m1.2.3.3.3.2.3.3.3" xref="alg2.l19.m1.2.3.3.3.2.3.3.3.cmml">i</mi></msub></msub></mrow><mo lspace="0em" rspace="0em" id="alg2.l19.m1.2.3.3.3.1" xref="alg2.l19.m1.2.3.3.3.1.cmml">​</mo><mi id="alg2.l19.m1.2.3.3.3.3" xref="alg2.l19.m1.2.3.3.3.3.cmml">L</mi><mo lspace="0em" rspace="0em" id="alg2.l19.m1.2.3.3.3.1a" xref="alg2.l19.m1.2.3.3.3.1.cmml">​</mo><mrow id="alg2.l19.m1.2.3.3.3.4.2" xref="alg2.l19.m1.2.3.3.3.4.1.cmml"><mo stretchy="false" id="alg2.l19.m1.2.3.3.3.4.2.1" xref="alg2.l19.m1.2.3.3.3.4.1.cmml">(</mo><mover accent="true" id="alg2.l19.m1.1.1" xref="alg2.l19.m1.1.1.cmml"><mi id="alg2.l19.m1.1.1.2" xref="alg2.l19.m1.1.1.2.cmml">y</mi><mo id="alg2.l19.m1.1.1.1" xref="alg2.l19.m1.1.1.1.cmml">~</mo></mover><mo id="alg2.l19.m1.2.3.3.3.4.2.2" xref="alg2.l19.m1.2.3.3.3.4.1.cmml">,</mo><mi id="alg2.l19.m1.2.2" xref="alg2.l19.m1.2.2.cmml">y</mi><mo stretchy="false" id="alg2.l19.m1.2.3.3.3.4.2.3" xref="alg2.l19.m1.2.3.3.3.4.1.cmml">)</mo></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg2.l19.m1.2b"><apply id="alg2.l19.m1.2.3.cmml" xref="alg2.l19.m1.2.3"><ci id="alg2.l19.m1.2.3.1.cmml" xref="alg2.l19.m1.2.3.1">←</ci><apply id="alg2.l19.m1.2.3.2.cmml" xref="alg2.l19.m1.2.3.2"><csymbol cd="ambiguous" id="alg2.l19.m1.2.3.2.1.cmml" xref="alg2.l19.m1.2.3.2">subscript</csymbol><ci id="alg2.l19.m1.2.3.2.2.cmml" xref="alg2.l19.m1.2.3.2.2">𝑤</ci><ci id="alg2.l19.m1.2.3.2.3.cmml" xref="alg2.l19.m1.2.3.2.3">𝑖</ci></apply><apply id="alg2.l19.m1.2.3.3.cmml" xref="alg2.l19.m1.2.3.3"><minus id="alg2.l19.m1.2.3.3.1.cmml" xref="alg2.l19.m1.2.3.3.1"></minus><apply id="alg2.l19.m1.2.3.3.2.cmml" xref="alg2.l19.m1.2.3.3.2"><csymbol cd="ambiguous" id="alg2.l19.m1.2.3.3.2.1.cmml" xref="alg2.l19.m1.2.3.3.2">subscript</csymbol><ci id="alg2.l19.m1.2.3.3.2.2.cmml" xref="alg2.l19.m1.2.3.3.2.2">𝑤</ci><ci id="alg2.l19.m1.2.3.3.2.3.cmml" xref="alg2.l19.m1.2.3.3.2.3">𝑖</ci></apply><apply id="alg2.l19.m1.2.3.3.3.cmml" xref="alg2.l19.m1.2.3.3.3"><times id="alg2.l19.m1.2.3.3.3.1.cmml" xref="alg2.l19.m1.2.3.3.3.1"></times><apply id="alg2.l19.m1.2.3.3.3.2.cmml" xref="alg2.l19.m1.2.3.3.3.2"><ci id="alg2.l19.m1.2.3.3.3.2.1.cmml" xref="alg2.l19.m1.2.3.3.3.2.1">⋅</ci><ci id="alg2.l19.m1.2.3.3.3.2.2.cmml" xref="alg2.l19.m1.2.3.3.3.2.2">𝛽</ci><apply id="alg2.l19.m1.2.3.3.3.2.3.cmml" xref="alg2.l19.m1.2.3.3.3.2.3"><csymbol cd="ambiguous" id="alg2.l19.m1.2.3.3.3.2.3.1.cmml" xref="alg2.l19.m1.2.3.3.3.2.3">subscript</csymbol><ci id="alg2.l19.m1.2.3.3.3.2.3.2.cmml" xref="alg2.l19.m1.2.3.3.3.2.3.2">▽</ci><apply id="alg2.l19.m1.2.3.3.3.2.3.3.cmml" xref="alg2.l19.m1.2.3.3.3.2.3.3"><csymbol cd="ambiguous" id="alg2.l19.m1.2.3.3.3.2.3.3.1.cmml" xref="alg2.l19.m1.2.3.3.3.2.3.3">subscript</csymbol><ci id="alg2.l19.m1.2.3.3.3.2.3.3.2.cmml" xref="alg2.l19.m1.2.3.3.3.2.3.3.2">𝑤</ci><ci id="alg2.l19.m1.2.3.3.3.2.3.3.3.cmml" xref="alg2.l19.m1.2.3.3.3.2.3.3.3">𝑖</ci></apply></apply></apply><ci id="alg2.l19.m1.2.3.3.3.3.cmml" xref="alg2.l19.m1.2.3.3.3.3">𝐿</ci><interval closure="open" id="alg2.l19.m1.2.3.3.3.4.1.cmml" xref="alg2.l19.m1.2.3.3.3.4.2"><apply id="alg2.l19.m1.1.1.cmml" xref="alg2.l19.m1.1.1"><ci id="alg2.l19.m1.1.1.1.cmml" xref="alg2.l19.m1.1.1.1">~</ci><ci id="alg2.l19.m1.1.1.2.cmml" xref="alg2.l19.m1.1.1.2">𝑦</ci></apply><ci id="alg2.l19.m1.2.2.cmml" xref="alg2.l19.m1.2.2">𝑦</ci></interval></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.l19.m1.2c">w_{i}\leftarrow w_{i}-\beta\cdot\triangledown_{w_{i}}{L(\tilde{y},y)}</annotation></semantics></math>

</div>
<div id="alg2.l20" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg2.l20.1.1.1" class="ltx_text" style="font-size:80%;">20:</span></span>     <span id="alg2.l20.2" class="ltx_text ltx_font_bold">end</span> <span id="alg2.l20.3" class="ltx_text ltx_font_bold">for</span>
</div>
<div id="alg2.l21" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg2.l21.1.1.1" class="ltx_text" style="font-size:80%;">21:</span></span>  <span id="alg2.l21.2" class="ltx_text ltx_font_bold">end</span> <span id="alg2.l21.3" class="ltx_text ltx_font_bold">for</span>
</div>
</div>
<br class="ltx_break ltx_break">
</figure>
<figure id="S4.F1" class="ltx_figure">
<p id="S4.F1.1" class="ltx_p ltx_align_center"><span id="S4.F1.1.1" class="ltx_text"><img src="/html/2012.15589/assets/x1.png" id="S4.F1.1.1.g1" class="ltx_graphics ltx_img_landscape" width="461" height="135" alt="Refer to caption"></span></p>
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure">Figure 1: </span>The local test accuracy and global test accuracy in Local for 100 clients. Each box contains 100 test accuracy of 100 clients for each specific <math id="S4.F1.3.m1.1" class="ltx_Math" alttext="\alpha" display="inline"><semantics id="S4.F1.3.m1.1b"><mi id="S4.F1.3.m1.1.1" xref="S4.F1.3.m1.1.1.cmml">α</mi><annotation-xml encoding="MathML-Content" id="S4.F1.3.m1.1c"><ci id="S4.F1.3.m1.1.1.cmml" xref="S4.F1.3.m1.1.1">𝛼</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.F1.3.m1.1d">\alpha</annotation></semantics></math>.
</figcaption>
</figure>
</section>
<section id="S5" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">V </span><span id="S5.1.1" class="ltx_text ltx_font_smallcaps">Experimental Evaluation</span>
</h2>

<section id="S5.SS1" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection"><span id="S5.SS1.5.1.1" class="ltx_text">V-A</span> </span><span id="S5.SS1.6.2" class="ltx_text ltx_font_italic">Experimental Setup</span>
</h3>

<section id="S5.SS1.SSS1" class="ltx_subsubsection">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection"><span id="S5.SS1.SSS1.5.1.1" class="ltx_text">V-A</span>1 </span>Datasets and models</h4>

<div id="S5.SS1.SSS1.p1" class="ltx_para">
<p id="S5.SS1.SSS1.p1.3" class="ltx_p">In our experiments<span id="footnote1" class="ltx_note ltx_role_footnote"><sup class="ltx_note_mark">1</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">1</sup><span class="ltx_tag ltx_tag_note">1</span>All code and results can be found at <a target="_blank" href="https://github.com/guobbin/PFL-MoE" title="" class="ltx_ref ltx_url ltx_font_typewriter">https://github.com/guobbin/PFL-MoE</a>.</span></span></span>, we use two image recognition datasets to
conduct model training: Fashion-MNIST <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib30" title="" class="ltx_ref">30</a>]</cite> and CIFAR-10 <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib31" title="" class="ltx_ref">31</a>]</cite>. With two network models trained, we have three combinations: Fashion-MNIST + LeNet-5 <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib32" title="" class="ltx_ref">32</a>]</cite>, CIFAR-10 + LeNet-5, and CIFAR-10 + VGG-16 <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib33" title="" class="ltx_ref">33</a>]</cite>.
Fashion-MNIST is an alternative dataset of MNIST. It contains 28<math id="S5.SS1.SSS1.p1.1.m1.1" class="ltx_Math" alttext="\times" display="inline"><semantics id="S5.SS1.SSS1.p1.1.m1.1a"><mo id="S5.SS1.SSS1.p1.1.m1.1.1" xref="S5.SS1.SSS1.p1.1.m1.1.1.cmml">×</mo><annotation-xml encoding="MathML-Content" id="S5.SS1.SSS1.p1.1.m1.1b"><times id="S5.SS1.SSS1.p1.1.m1.1.1.cmml" xref="S5.SS1.SSS1.p1.1.m1.1.1"></times></annotation-xml><annotation encoding="application/x-tex" id="S5.SS1.SSS1.p1.1.m1.1c">\times</annotation></semantics></math>28 grayscale images of the front side of 70,000 different products in 10 categories, divided into 60000/10000 training/testing datasets. CIFAR-10 is a dataset of <math id="S5.SS1.SSS1.p1.2.m2.1" class="ltx_Math" alttext="32\times 32" display="inline"><semantics id="S5.SS1.SSS1.p1.2.m2.1a"><mrow id="S5.SS1.SSS1.p1.2.m2.1.1" xref="S5.SS1.SSS1.p1.2.m2.1.1.cmml"><mn id="S5.SS1.SSS1.p1.2.m2.1.1.2" xref="S5.SS1.SSS1.p1.2.m2.1.1.2.cmml">32</mn><mo lspace="0.222em" rspace="0.222em" id="S5.SS1.SSS1.p1.2.m2.1.1.1" xref="S5.SS1.SSS1.p1.2.m2.1.1.1.cmml">×</mo><mn id="S5.SS1.SSS1.p1.2.m2.1.1.3" xref="S5.SS1.SSS1.p1.2.m2.1.1.3.cmml">32</mn></mrow><annotation-xml encoding="MathML-Content" id="S5.SS1.SSS1.p1.2.m2.1b"><apply id="S5.SS1.SSS1.p1.2.m2.1.1.cmml" xref="S5.SS1.SSS1.p1.2.m2.1.1"><times id="S5.SS1.SSS1.p1.2.m2.1.1.1.cmml" xref="S5.SS1.SSS1.p1.2.m2.1.1.1"></times><cn type="integer" id="S5.SS1.SSS1.p1.2.m2.1.1.2.cmml" xref="S5.SS1.SSS1.p1.2.m2.1.1.2">32</cn><cn type="integer" id="S5.SS1.SSS1.p1.2.m2.1.1.3.cmml" xref="S5.SS1.SSS1.p1.2.m2.1.1.3">32</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS1.SSS1.p1.2.m2.1c">32\times 32</annotation></semantics></math> color images closer to universal objects, with 3 channels and a training/testing dataset division of 50000/10000. LeNet-5 contains two convolutional layers and three fully connected layers. We resize the images of the datasets to <math id="S5.SS1.SSS1.p1.3.m3.1" class="ltx_Math" alttext="32\times 32" display="inline"><semantics id="S5.SS1.SSS1.p1.3.m3.1a"><mrow id="S5.SS1.SSS1.p1.3.m3.1.1" xref="S5.SS1.SSS1.p1.3.m3.1.1.cmml"><mn id="S5.SS1.SSS1.p1.3.m3.1.1.2" xref="S5.SS1.SSS1.p1.3.m3.1.1.2.cmml">32</mn><mo lspace="0.222em" rspace="0.222em" id="S5.SS1.SSS1.p1.3.m3.1.1.1" xref="S5.SS1.SSS1.p1.3.m3.1.1.1.cmml">×</mo><mn id="S5.SS1.SSS1.p1.3.m3.1.1.3" xref="S5.SS1.SSS1.p1.3.m3.1.1.3.cmml">32</mn></mrow><annotation-xml encoding="MathML-Content" id="S5.SS1.SSS1.p1.3.m3.1b"><apply id="S5.SS1.SSS1.p1.3.m3.1.1.cmml" xref="S5.SS1.SSS1.p1.3.m3.1.1"><times id="S5.SS1.SSS1.p1.3.m3.1.1.1.cmml" xref="S5.SS1.SSS1.p1.3.m3.1.1.1"></times><cn type="integer" id="S5.SS1.SSS1.p1.3.m3.1.1.2.cmml" xref="S5.SS1.SSS1.p1.3.m3.1.1.2">32</cn><cn type="integer" id="S5.SS1.SSS1.p1.3.m3.1.1.3.cmml" xref="S5.SS1.SSS1.p1.3.m3.1.1.3">32</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS1.SSS1.p1.3.m3.1c">32\times 32</annotation></semantics></math> uniformly, and due to the difference in the number of image channels, the corresponding number of the LeNet-5 model parameters are 61706 and 62006, respectively. VGG-16 is a relatively deep neural network, including 13 convolutional layers and 3 fully connected layers, with a total of 15,245,130 parameters.</p>
</div>
</section>
<section id="S5.SS1.SSS2" class="ltx_subsubsection">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection"><span id="S5.SS1.SSS2.5.1.1" class="ltx_text">V-A</span>2 </span>Non-IID Data</h4>

<div id="S5.SS1.SSS2.p1" class="ltx_para">
<p id="S5.SS1.SSS2.p1.5" class="ltx_p">Similar to Hsu et al. <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib18" title="" class="ltx_ref">18</a>]</cite>, we use Dirichlet distribution with <math id="S5.SS1.SSS2.p1.1.m1.1" class="ltx_Math" alttext="\alpha" display="inline"><semantics id="S5.SS1.SSS2.p1.1.m1.1a"><mi id="S5.SS1.SSS2.p1.1.m1.1.1" xref="S5.SS1.SSS2.p1.1.m1.1.1.cmml">α</mi><annotation-xml encoding="MathML-Content" id="S5.SS1.SSS2.p1.1.m1.1b"><ci id="S5.SS1.SSS2.p1.1.m1.1.1.cmml" xref="S5.SS1.SSS2.p1.1.m1.1.1">𝛼</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.SS1.SSS2.p1.1.m1.1c">\alpha</annotation></semantics></math> to simulate the non-IID data distributions. <math id="S5.SS1.SSS2.p1.2.m2.1" class="ltx_Math" alttext="\alpha&gt;0" display="inline"><semantics id="S5.SS1.SSS2.p1.2.m2.1a"><mrow id="S5.SS1.SSS2.p1.2.m2.1.1" xref="S5.SS1.SSS2.p1.2.m2.1.1.cmml"><mi id="S5.SS1.SSS2.p1.2.m2.1.1.2" xref="S5.SS1.SSS2.p1.2.m2.1.1.2.cmml">α</mi><mo id="S5.SS1.SSS2.p1.2.m2.1.1.1" xref="S5.SS1.SSS2.p1.2.m2.1.1.1.cmml">&gt;</mo><mn id="S5.SS1.SSS2.p1.2.m2.1.1.3" xref="S5.SS1.SSS2.p1.2.m2.1.1.3.cmml">0</mn></mrow><annotation-xml encoding="MathML-Content" id="S5.SS1.SSS2.p1.2.m2.1b"><apply id="S5.SS1.SSS2.p1.2.m2.1.1.cmml" xref="S5.SS1.SSS2.p1.2.m2.1.1"><gt id="S5.SS1.SSS2.p1.2.m2.1.1.1.cmml" xref="S5.SS1.SSS2.p1.2.m2.1.1.1"></gt><ci id="S5.SS1.SSS2.p1.2.m2.1.1.2.cmml" xref="S5.SS1.SSS2.p1.2.m2.1.1.2">𝛼</ci><cn type="integer" id="S5.SS1.SSS2.p1.2.m2.1.1.3.cmml" xref="S5.SS1.SSS2.p1.2.m2.1.1.3">0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS1.SSS2.p1.2.m2.1c">\alpha&gt;0</annotation></semantics></math> is a concentration parameter controlling the identicalness among clients. <span id="S5.SS1.SSS2.p1.3.1" class="ltx_text ltx_font_bold">The larger the <math id="S5.SS1.SSS2.p1.3.1.m1.1" class="ltx_Math" alttext="\alpha" display="inline"><semantics id="S5.SS1.SSS2.p1.3.1.m1.1a"><mi id="S5.SS1.SSS2.p1.3.1.m1.1.1" xref="S5.SS1.SSS2.p1.3.1.m1.1.1.cmml">α</mi><annotation-xml encoding="MathML-Content" id="S5.SS1.SSS2.p1.3.1.m1.1b"><ci id="S5.SS1.SSS2.p1.3.1.m1.1.1.cmml" xref="S5.SS1.SSS2.p1.3.1.m1.1.1">𝛼</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.SS1.SSS2.p1.3.1.m1.1c">\alpha</annotation></semantics></math>, the higher the similarity between the distributions</span>, and we chose <math id="S5.SS1.SSS2.p1.4.m3.3" class="ltx_Math" alttext="\alpha=[0.5,0.9,2]" display="inline"><semantics id="S5.SS1.SSS2.p1.4.m3.3a"><mrow id="S5.SS1.SSS2.p1.4.m3.3.4" xref="S5.SS1.SSS2.p1.4.m3.3.4.cmml"><mi id="S5.SS1.SSS2.p1.4.m3.3.4.2" xref="S5.SS1.SSS2.p1.4.m3.3.4.2.cmml">α</mi><mo id="S5.SS1.SSS2.p1.4.m3.3.4.1" xref="S5.SS1.SSS2.p1.4.m3.3.4.1.cmml">=</mo><mrow id="S5.SS1.SSS2.p1.4.m3.3.4.3.2" xref="S5.SS1.SSS2.p1.4.m3.3.4.3.1.cmml"><mo stretchy="false" id="S5.SS1.SSS2.p1.4.m3.3.4.3.2.1" xref="S5.SS1.SSS2.p1.4.m3.3.4.3.1.cmml">[</mo><mn id="S5.SS1.SSS2.p1.4.m3.1.1" xref="S5.SS1.SSS2.p1.4.m3.1.1.cmml">0.5</mn><mo id="S5.SS1.SSS2.p1.4.m3.3.4.3.2.2" xref="S5.SS1.SSS2.p1.4.m3.3.4.3.1.cmml">,</mo><mn id="S5.SS1.SSS2.p1.4.m3.2.2" xref="S5.SS1.SSS2.p1.4.m3.2.2.cmml">0.9</mn><mo id="S5.SS1.SSS2.p1.4.m3.3.4.3.2.3" xref="S5.SS1.SSS2.p1.4.m3.3.4.3.1.cmml">,</mo><mn id="S5.SS1.SSS2.p1.4.m3.3.3" xref="S5.SS1.SSS2.p1.4.m3.3.3.cmml">2</mn><mo stretchy="false" id="S5.SS1.SSS2.p1.4.m3.3.4.3.2.4" xref="S5.SS1.SSS2.p1.4.m3.3.4.3.1.cmml">]</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S5.SS1.SSS2.p1.4.m3.3b"><apply id="S5.SS1.SSS2.p1.4.m3.3.4.cmml" xref="S5.SS1.SSS2.p1.4.m3.3.4"><eq id="S5.SS1.SSS2.p1.4.m3.3.4.1.cmml" xref="S5.SS1.SSS2.p1.4.m3.3.4.1"></eq><ci id="S5.SS1.SSS2.p1.4.m3.3.4.2.cmml" xref="S5.SS1.SSS2.p1.4.m3.3.4.2">𝛼</ci><list id="S5.SS1.SSS2.p1.4.m3.3.4.3.1.cmml" xref="S5.SS1.SSS2.p1.4.m3.3.4.3.2"><cn type="float" id="S5.SS1.SSS2.p1.4.m3.1.1.cmml" xref="S5.SS1.SSS2.p1.4.m3.1.1">0.5</cn><cn type="float" id="S5.SS1.SSS2.p1.4.m3.2.2.cmml" xref="S5.SS1.SSS2.p1.4.m3.2.2">0.9</cn><cn type="integer" id="S5.SS1.SSS2.p1.4.m3.3.3.cmml" xref="S5.SS1.SSS2.p1.4.m3.3.3">2</cn></list></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS1.SSS2.p1.4.m3.3c">\alpha=[0.5,0.9,2]</annotation></semantics></math> to generate three non-IID data distributions for experiments. For each <math id="S5.SS1.SSS2.p1.5.m4.1" class="ltx_Math" alttext="\alpha" display="inline"><semantics id="S5.SS1.SSS2.p1.5.m4.1a"><mi id="S5.SS1.SSS2.p1.5.m4.1.1" xref="S5.SS1.SSS2.p1.5.m4.1.1.cmml">α</mi><annotation-xml encoding="MathML-Content" id="S5.SS1.SSS2.p1.5.m4.1b"><ci id="S5.SS1.SSS2.p1.5.m4.1.1.cmml" xref="S5.SS1.SSS2.p1.5.m4.1.1">𝛼</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.SS1.SSS2.p1.5.m4.1c">\alpha</annotation></semantics></math>, we split the training set and allocate images from each class to 100 clients.</p>
</div>
</section>
<section id="S5.SS1.SSS3" class="ltx_subsubsection">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection"><span id="S5.SS1.SSS3.5.1.1" class="ltx_text">V-A</span>3 </span>Testing</h4>

<div id="S5.SS1.SSS3.p1" class="ltx_para">
<p id="S5.SS1.SSS3.p1.1" class="ltx_p">Each client has two types of tests, including local test and global test. Local test uses the test set of the same distribution as the training set of the same client. In contrast, global test uses the global test set (10000 test images).
Following the local test method of Yu et al. <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib4" title="" class="ltx_ref">4</a>]</cite>, for each client, we calculate the client’s per-class accuracy on the global test set, multiply it by the corresponding class’s ratio in the training set of the client, and sum up the resulting values. The accuracy of the local test and global test is used as a measure of personalization and generalization.</p>
</div>
</section>
<section id="S5.SS1.SSS4" class="ltx_subsubsection">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection"><span id="S5.SS1.SSS4.5.1.1" class="ltx_text">V-A</span>4 </span>Baselines and PFL-MoE</h4>

<div id="S5.SS1.SSS4.p1" class="ltx_para">
<p id="S5.SS1.SSS4.p1.1" class="ltx_p">To verify the effectiveness of the proposed personalization algorithms PFL-MF and PFL-MFE, we compare them with three baselines: Local, FedAvg, and PFL-FB.
The detailed settings of each algorithm are as follows:
</p>
</div>
<figure id="S5.T1" class="ltx_table">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table">TABLE I: </span>The average value of <span id="S5.T1.3.1" class="ltx_text ltx_font_bold">local test</span> accuracy of all clients in three baselines and proposed algorithms. Bold means the best in all methods.
</figcaption>
<table id="S5.T1.1" class="ltx_tabular ltx_centering ltx_guessed_headers ltx_align_middle">
<thead class="ltx_thead">
<tr id="S5.T1.1.1" class="ltx_tr">
<th id="S5.T1.1.1.2" class="ltx_td ltx_th ltx_th_row ltx_border_tt"></th>
<th id="S5.T1.1.1.1" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_th_row ltx_border_tt">non-IID <math id="S5.T1.1.1.1.m1.1" class="ltx_Math" alttext="\alpha" display="inline"><semantics id="S5.T1.1.1.1.m1.1a"><mi id="S5.T1.1.1.1.m1.1.1" xref="S5.T1.1.1.1.m1.1.1.cmml">α</mi><annotation-xml encoding="MathML-Content" id="S5.T1.1.1.1.m1.1b"><ci id="S5.T1.1.1.1.m1.1.1.cmml" xref="S5.T1.1.1.1.m1.1.1">𝛼</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.T1.1.1.1.m1.1c">\alpha</annotation></semantics></math>
</th>
<th id="S5.T1.1.1.3" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt">Local(%)</th>
<th id="S5.T1.1.1.4" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt">FedAvg(%)</th>
<th id="S5.T1.1.1.5" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt">PFL-FB(%)</th>
<th id="S5.T1.1.1.6" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt">PFL-MF(%)</th>
<th id="S5.T1.1.1.7" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt">PFL-MFE(%)</th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr id="S5.T1.1.2.1" class="ltx_tr">
<th id="S5.T1.1.2.1.1" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_t" rowspan="3"><span id="S5.T1.1.2.1.1.1" class="ltx_text">
<span id="S5.T1.1.2.1.1.1.1" class="ltx_tabular ltx_align_middle">
<span id="S5.T1.1.2.1.1.1.1.1" class="ltx_tr">
<span id="S5.T1.1.2.1.1.1.1.1.1" class="ltx_td ltx_nopad_r ltx_align_center">Fashion-MNIST &amp;</span></span>
<span id="S5.T1.1.2.1.1.1.1.2" class="ltx_tr">
<span id="S5.T1.1.2.1.1.1.1.2.1" class="ltx_td ltx_nopad_r ltx_align_center">LeNet5</span></span>
</span></span></th>
<th id="S5.T1.1.2.1.2" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_t">0.5</th>
<td id="S5.T1.1.2.1.3" class="ltx_td ltx_align_center ltx_border_t">84.87</td>
<td id="S5.T1.1.2.1.4" class="ltx_td ltx_align_center ltx_border_t">90</td>
<td id="S5.T1.1.2.1.5" class="ltx_td ltx_align_center ltx_border_t">92.84</td>
<td id="S5.T1.1.2.1.6" class="ltx_td ltx_align_center ltx_border_t">92.85</td>
<td id="S5.T1.1.2.1.7" class="ltx_td ltx_align_center ltx_border_t"><span id="S5.T1.1.2.1.7.1" class="ltx_text ltx_font_bold">92.89</span></td>
</tr>
<tr id="S5.T1.1.3.2" class="ltx_tr">
<th id="S5.T1.1.3.2.1" class="ltx_td ltx_align_center ltx_th ltx_th_row">0.9</th>
<td id="S5.T1.1.3.2.2" class="ltx_td ltx_align_center">82.23</td>
<td id="S5.T1.1.3.2.3" class="ltx_td ltx_align_center">90.31</td>
<td id="S5.T1.1.3.2.4" class="ltx_td ltx_align_center">91.84</td>
<td id="S5.T1.1.3.2.5" class="ltx_td ltx_align_center"><span id="S5.T1.1.3.2.5.1" class="ltx_text ltx_font_bold">92.02</span></td>
<td id="S5.T1.1.3.2.6" class="ltx_td ltx_align_center">92.01</td>
</tr>
<tr id="S5.T1.1.4.3" class="ltx_tr">
<th id="S5.T1.1.4.3.1" class="ltx_td ltx_align_center ltx_th ltx_th_row">2</th>
<td id="S5.T1.1.4.3.2" class="ltx_td ltx_align_center">78.63</td>
<td id="S5.T1.1.4.3.3" class="ltx_td ltx_align_center">90.5</td>
<td id="S5.T1.1.4.3.4" class="ltx_td ltx_align_center">90.47</td>
<td id="S5.T1.1.4.3.5" class="ltx_td ltx_align_center"><span id="S5.T1.1.4.3.5.1" class="ltx_text ltx_font_bold">90.97</span></td>
<td id="S5.T1.1.4.3.6" class="ltx_td ltx_align_center">90.93</td>
</tr>
<tr id="S5.T1.1.5.4" class="ltx_tr">
<th id="S5.T1.1.5.4.1" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_t" rowspan="3"><span id="S5.T1.1.5.4.1.1" class="ltx_text">
<span id="S5.T1.1.5.4.1.1.1" class="ltx_tabular ltx_align_middle">
<span id="S5.T1.1.5.4.1.1.1.1" class="ltx_tr">
<span id="S5.T1.1.5.4.1.1.1.1.1" class="ltx_td ltx_nopad_r ltx_align_center">CIFAR-10 &amp;</span></span>
<span id="S5.T1.1.5.4.1.1.1.2" class="ltx_tr">
<span id="S5.T1.1.5.4.1.1.1.2.1" class="ltx_td ltx_nopad_r ltx_align_center">LeNet5</span></span>
</span></span></th>
<th id="S5.T1.1.5.4.2" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_t">0.5</th>
<td id="S5.T1.1.5.4.3" class="ltx_td ltx_align_center ltx_border_t">65.58</td>
<td id="S5.T1.1.5.4.4" class="ltx_td ltx_align_center ltx_border_t">68.92</td>
<td id="S5.T1.1.5.4.5" class="ltx_td ltx_align_center ltx_border_t"><span id="S5.T1.1.5.4.5.1" class="ltx_text ltx_font_bold">77.46</span></td>
<td id="S5.T1.1.5.4.6" class="ltx_td ltx_align_center ltx_border_t">75.49</td>
<td id="S5.T1.1.5.4.7" class="ltx_td ltx_align_center ltx_border_t">77.23</td>
</tr>
<tr id="S5.T1.1.6.5" class="ltx_tr">
<th id="S5.T1.1.6.5.1" class="ltx_td ltx_align_center ltx_th ltx_th_row">0.9</th>
<td id="S5.T1.1.6.5.2" class="ltx_td ltx_align_center">61.49</td>
<td id="S5.T1.1.6.5.3" class="ltx_td ltx_align_center">70.7</td>
<td id="S5.T1.1.6.5.4" class="ltx_td ltx_align_center">74.7</td>
<td id="S5.T1.1.6.5.5" class="ltx_td ltx_align_center">74.1</td>
<td id="S5.T1.1.6.5.6" class="ltx_td ltx_align_center"><span id="S5.T1.1.6.5.6.1" class="ltx_text ltx_font_bold">74.74</span></td>
</tr>
<tr id="S5.T1.1.7.6" class="ltx_tr">
<th id="S5.T1.1.7.6.1" class="ltx_td ltx_align_center ltx_th ltx_th_row">2</th>
<td id="S5.T1.1.7.6.2" class="ltx_td ltx_align_center">55.8</td>
<td id="S5.T1.1.7.6.3" class="ltx_td ltx_align_center">72.69</td>
<td id="S5.T1.1.7.6.4" class="ltx_td ltx_align_center">72.5</td>
<td id="S5.T1.1.7.6.5" class="ltx_td ltx_align_center">73.24</td>
<td id="S5.T1.1.7.6.6" class="ltx_td ltx_align_center"><span id="S5.T1.1.7.6.6.1" class="ltx_text ltx_font_bold">73.44</span></td>
</tr>
<tr id="S5.T1.1.8.7" class="ltx_tr">
<th id="S5.T1.1.8.7.1" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_bb ltx_border_t" rowspan="3"><span id="S5.T1.1.8.7.1.1" class="ltx_text">
<span id="S5.T1.1.8.7.1.1.1" class="ltx_tabular ltx_align_middle">
<span id="S5.T1.1.8.7.1.1.1.1" class="ltx_tr">
<span id="S5.T1.1.8.7.1.1.1.1.1" class="ltx_td ltx_nopad_r ltx_align_center">CIFAR-10 &amp;</span></span>
<span id="S5.T1.1.8.7.1.1.1.2" class="ltx_tr">
<span id="S5.T1.1.8.7.1.1.1.2.1" class="ltx_td ltx_nopad_r ltx_align_center">VGG-16</span></span>
</span></span></th>
<th id="S5.T1.1.8.7.2" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_t">0.5</th>
<td id="S5.T1.1.8.7.3" class="ltx_td ltx_align_center ltx_border_t">52.77</td>
<td id="S5.T1.1.8.7.4" class="ltx_td ltx_align_center ltx_border_t">88.16</td>
<td id="S5.T1.1.8.7.5" class="ltx_td ltx_align_center ltx_border_t"><span id="S5.T1.1.8.7.5.1" class="ltx_text ltx_font_bold">91.92</span></td>
<td id="S5.T1.1.8.7.6" class="ltx_td ltx_align_center ltx_border_t">90.63</td>
<td id="S5.T1.1.8.7.7" class="ltx_td ltx_align_center ltx_border_t">91.71</td>
</tr>
<tr id="S5.T1.1.9.8" class="ltx_tr">
<th id="S5.T1.1.9.8.1" class="ltx_td ltx_align_center ltx_th ltx_th_row">0.9</th>
<td id="S5.T1.1.9.8.2" class="ltx_td ltx_align_center">45.24</td>
<td id="S5.T1.1.9.8.3" class="ltx_td ltx_align_center">88.45</td>
<td id="S5.T1.1.9.8.4" class="ltx_td ltx_align_center"><span id="S5.T1.1.9.8.4.1" class="ltx_text ltx_font_bold">91.34</span></td>
<td id="S5.T1.1.9.8.5" class="ltx_td ltx_align_center">90.63</td>
<td id="S5.T1.1.9.8.6" class="ltx_td ltx_align_center">91.18</td>
</tr>
<tr id="S5.T1.1.10.9" class="ltx_tr">
<th id="S5.T1.1.10.9.1" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_bb">2</th>
<td id="S5.T1.1.10.9.2" class="ltx_td ltx_align_center ltx_border_bb">34.2</td>
<td id="S5.T1.1.10.9.3" class="ltx_td ltx_align_center ltx_border_bb">89.17</td>
<td id="S5.T1.1.10.9.4" class="ltx_td ltx_align_center ltx_border_bb"><span id="S5.T1.1.10.9.4.1" class="ltx_text ltx_font_bold">90.4</span></td>
<td id="S5.T1.1.10.9.5" class="ltx_td ltx_align_center ltx_border_bb">90.15</td>
<td id="S5.T1.1.10.9.6" class="ltx_td ltx_align_center ltx_border_bb"><span id="S5.T1.1.10.9.6.1" class="ltx_text ltx_font_bold">90.4</span></td>
</tr>
</tbody>
</table>
</figure>
<figure id="S5.T2" class="ltx_table">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table">TABLE II: </span>The average value of <span id="S5.T2.3.1" class="ltx_text ltx_font_bold">global test</span> accuracy of all clients. Bold means the best in all personalization algorithms. For FedAvg, all clients have the same global model, and they use the same global test set for the global test, so their global test accuracy is the same. The value is exactly the average local test accuracy of above local test, due to the sum of the proportions of each category of all clients is the same as the global test set.
<br class="ltx_break"></figcaption>
<table id="S5.T2.1" class="ltx_tabular ltx_centering ltx_guessed_headers ltx_align_middle">
<thead class="ltx_thead">
<tr id="S5.T2.1.1" class="ltx_tr">
<th id="S5.T2.1.1.2" class="ltx_td ltx_th ltx_th_row ltx_border_tt"></th>
<th id="S5.T2.1.1.1" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_th_row ltx_border_tt">non-IID <math id="S5.T2.1.1.1.m1.1" class="ltx_Math" alttext="\alpha" display="inline"><semantics id="S5.T2.1.1.1.m1.1a"><mi id="S5.T2.1.1.1.m1.1.1" xref="S5.T2.1.1.1.m1.1.1.cmml">α</mi><annotation-xml encoding="MathML-Content" id="S5.T2.1.1.1.m1.1b"><ci id="S5.T2.1.1.1.m1.1.1.cmml" xref="S5.T2.1.1.1.m1.1.1">𝛼</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.T2.1.1.1.m1.1c">\alpha</annotation></semantics></math>
</th>
<th id="S5.T2.1.1.3" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt">Local(%)</th>
<th id="S5.T2.1.1.4" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt">FedAvg(%)</th>
<th id="S5.T2.1.1.5" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt">PFL-FB(%)</th>
<th id="S5.T2.1.1.6" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt">PFL-MF(%)</th>
<th id="S5.T2.1.1.7" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt">PFL-MFE(%)</th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr id="S5.T2.1.2.1" class="ltx_tr">
<th id="S5.T2.1.2.1.1" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_t" rowspan="3"><span id="S5.T2.1.2.1.1.1" class="ltx_text">
<span id="S5.T2.1.2.1.1.1.1" class="ltx_tabular ltx_align_middle">
<span id="S5.T2.1.2.1.1.1.1.1" class="ltx_tr">
<span id="S5.T2.1.2.1.1.1.1.1.1" class="ltx_td ltx_nopad_r ltx_align_center">Fashion-MNIST &amp;</span></span>
<span id="S5.T2.1.2.1.1.1.1.2" class="ltx_tr">
<span id="S5.T2.1.2.1.1.1.1.2.1" class="ltx_td ltx_nopad_r ltx_align_center">LeNet5</span></span>
</span></span></th>
<th id="S5.T2.1.2.1.2" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_t">0.5</th>
<td id="S5.T2.1.2.1.3" class="ltx_td ltx_align_center ltx_border_t">57.77</td>
<td id="S5.T2.1.2.1.4" class="ltx_td ltx_align_center ltx_border_t">90</td>
<td id="S5.T2.1.2.1.5" class="ltx_td ltx_align_center ltx_border_t">83.35</td>
<td id="S5.T2.1.2.1.6" class="ltx_td ltx_align_center ltx_border_t"><span id="S5.T2.1.2.1.6.1" class="ltx_text ltx_font_bold">85.45</span></td>
<td id="S5.T2.1.2.1.7" class="ltx_td ltx_align_center ltx_border_t">85.3</td>
</tr>
<tr id="S5.T2.1.3.2" class="ltx_tr">
<th id="S5.T2.1.3.2.1" class="ltx_td ltx_align_center ltx_th ltx_th_row">0.9</th>
<td id="S5.T2.1.3.2.2" class="ltx_td ltx_align_center">65.28</td>
<td id="S5.T2.1.3.2.3" class="ltx_td ltx_align_center">90.31</td>
<td id="S5.T2.1.3.2.4" class="ltx_td ltx_align_center">85.91</td>
<td id="S5.T2.1.3.2.5" class="ltx_td ltx_align_center"><span id="S5.T2.1.3.2.5.1" class="ltx_text ltx_font_bold">87.69</span></td>
<td id="S5.T2.1.3.2.6" class="ltx_td ltx_align_center">87.67</td>
</tr>
<tr id="S5.T2.1.4.3" class="ltx_tr">
<th id="S5.T2.1.4.3.1" class="ltx_td ltx_align_center ltx_th ltx_th_row">2</th>
<td id="S5.T2.1.4.3.2" class="ltx_td ltx_align_center">71.06</td>
<td id="S5.T2.1.4.3.3" class="ltx_td ltx_align_center">90.5</td>
<td id="S5.T2.1.4.3.4" class="ltx_td ltx_align_center">87.77</td>
<td id="S5.T2.1.4.3.5" class="ltx_td ltx_align_center"><span id="S5.T2.1.4.3.5.1" class="ltx_text ltx_font_bold">89.37</span></td>
<td id="S5.T2.1.4.3.6" class="ltx_td ltx_align_center">89.18</td>
</tr>
<tr id="S5.T2.1.5.4" class="ltx_tr">
<th id="S5.T2.1.5.4.1" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_t" rowspan="3"><span id="S5.T2.1.5.4.1.1" class="ltx_text">
<span id="S5.T2.1.5.4.1.1.1" class="ltx_tabular ltx_align_middle">
<span id="S5.T2.1.5.4.1.1.1.1" class="ltx_tr">
<span id="S5.T2.1.5.4.1.1.1.1.1" class="ltx_td ltx_nopad_r ltx_align_center">CIFAR-10 &amp;</span></span>
<span id="S5.T2.1.5.4.1.1.1.2" class="ltx_tr">
<span id="S5.T2.1.5.4.1.1.1.2.1" class="ltx_td ltx_nopad_r ltx_align_center">LeNet5</span></span>
</span></span></th>
<th id="S5.T2.1.5.4.2" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_t">0.5</th>
<td id="S5.T2.1.5.4.3" class="ltx_td ltx_align_center ltx_border_t">28.89</td>
<td id="S5.T2.1.5.4.4" class="ltx_td ltx_align_center ltx_border_t">68.92</td>
<td id="S5.T2.1.5.4.5" class="ltx_td ltx_align_center ltx_border_t">54.28</td>
<td id="S5.T2.1.5.4.6" class="ltx_td ltx_align_center ltx_border_t"><span id="S5.T2.1.5.4.6.1" class="ltx_text ltx_font_bold">62.33</span></td>
<td id="S5.T2.1.5.4.7" class="ltx_td ltx_align_center ltx_border_t">58.27</td>
</tr>
<tr id="S5.T2.1.6.5" class="ltx_tr">
<th id="S5.T2.1.6.5.1" class="ltx_td ltx_align_center ltx_th ltx_th_row">0.9</th>
<td id="S5.T2.1.6.5.2" class="ltx_td ltx_align_center">32.1</td>
<td id="S5.T2.1.6.5.3" class="ltx_td ltx_align_center">70.7</td>
<td id="S5.T2.1.6.5.4" class="ltx_td ltx_align_center">59.93</td>
<td id="S5.T2.1.6.5.5" class="ltx_td ltx_align_center"><span id="S5.T2.1.6.5.5.1" class="ltx_text ltx_font_bold">65.78</span></td>
<td id="S5.T2.1.6.5.6" class="ltx_td ltx_align_center">64.13</td>
</tr>
<tr id="S5.T2.1.7.6" class="ltx_tr">
<th id="S5.T2.1.7.6.1" class="ltx_td ltx_align_center ltx_th ltx_th_row">2</th>
<td id="S5.T2.1.7.6.2" class="ltx_td ltx_align_center">35.32</td>
<td id="S5.T2.1.7.6.3" class="ltx_td ltx_align_center">72.69</td>
<td id="S5.T2.1.7.6.4" class="ltx_td ltx_align_center">66.06</td>
<td id="S5.T2.1.7.6.5" class="ltx_td ltx_align_center"><span id="S5.T2.1.7.6.5.1" class="ltx_text ltx_font_bold">69.79</span></td>
<td id="S5.T2.1.7.6.6" class="ltx_td ltx_align_center">69.78</td>
</tr>
<tr id="S5.T2.1.8.7" class="ltx_tr">
<th id="S5.T2.1.8.7.1" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_bb ltx_border_t" rowspan="3"><span id="S5.T2.1.8.7.1.1" class="ltx_text">
<span id="S5.T2.1.8.7.1.1.1" class="ltx_tabular ltx_align_middle">
<span id="S5.T2.1.8.7.1.1.1.1" class="ltx_tr">
<span id="S5.T2.1.8.7.1.1.1.1.1" class="ltx_td ltx_nopad_r ltx_align_center">CIFAR-10 &amp;</span></span>
<span id="S5.T2.1.8.7.1.1.1.2" class="ltx_tr">
<span id="S5.T2.1.8.7.1.1.1.2.1" class="ltx_td ltx_nopad_r ltx_align_center">VGG-16</span></span>
</span></span></th>
<th id="S5.T2.1.8.7.2" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_t">0.5</th>
<td id="S5.T2.1.8.7.3" class="ltx_td ltx_align_center ltx_border_t">21.53</td>
<td id="S5.T2.1.8.7.4" class="ltx_td ltx_align_center ltx_border_t">88.16</td>
<td id="S5.T2.1.8.7.5" class="ltx_td ltx_align_center ltx_border_t">82.39</td>
<td id="S5.T2.1.8.7.6" class="ltx_td ltx_align_center ltx_border_t"><span id="S5.T2.1.8.7.6.1" class="ltx_text ltx_font_bold">85.81</span></td>
<td id="S5.T2.1.8.7.7" class="ltx_td ltx_align_center ltx_border_t">84.05</td>
</tr>
<tr id="S5.T2.1.9.8" class="ltx_tr">
<th id="S5.T2.1.9.8.1" class="ltx_td ltx_align_center ltx_th ltx_th_row">0.9</th>
<td id="S5.T2.1.9.8.2" class="ltx_td ltx_align_center">22.45</td>
<td id="S5.T2.1.9.8.3" class="ltx_td ltx_align_center">88.45</td>
<td id="S5.T2.1.9.8.4" class="ltx_td ltx_align_center">82.62</td>
<td id="S5.T2.1.9.8.5" class="ltx_td ltx_align_center"><span id="S5.T2.1.9.8.5.1" class="ltx_text ltx_font_bold">88.15</span></td>
<td id="S5.T2.1.9.8.6" class="ltx_td ltx_align_center">87.9</td>
</tr>
<tr id="S5.T2.1.10.9" class="ltx_tr">
<th id="S5.T2.1.10.9.1" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_bb">2</th>
<td id="S5.T2.1.10.9.2" class="ltx_td ltx_align_center ltx_border_bb">21.27</td>
<td id="S5.T2.1.10.9.3" class="ltx_td ltx_align_center ltx_border_bb">89.17</td>
<td id="S5.T2.1.10.9.4" class="ltx_td ltx_align_center ltx_border_bb">88.77</td>
<td id="S5.T2.1.10.9.5" class="ltx_td ltx_align_center ltx_border_bb"><span id="S5.T2.1.10.9.5.1" class="ltx_text ltx_font_bold">89.3</span></td>
<td id="S5.T2.1.10.9.6" class="ltx_td ltx_align_center ltx_border_bb"><span id="S5.T2.1.10.9.6.1" class="ltx_text ltx_font_bold">89.3</span></td>
</tr>
</tbody>
</table>
</figure>
<section id="S5.SS1.SSS4.Px1" class="ltx_paragraph">
<h5 class="ltx_title ltx_title_paragraph">Local</h5>

<div id="S5.SS1.SSS4.Px1.p1" class="ltx_para">
<p id="S5.SS1.SSS4.Px1.p1.5" class="ltx_p">Each client’s local model was trained with its local training set for 300 epochs with the regularization factor <math id="S5.SS1.SSS4.Px1.p1.1.m1.1" class="ltx_Math" alttext="\lambda=0.0005" display="inline"><semantics id="S5.SS1.SSS4.Px1.p1.1.m1.1a"><mrow id="S5.SS1.SSS4.Px1.p1.1.m1.1.1" xref="S5.SS1.SSS4.Px1.p1.1.m1.1.1.cmml"><mi id="S5.SS1.SSS4.Px1.p1.1.m1.1.1.2" xref="S5.SS1.SSS4.Px1.p1.1.m1.1.1.2.cmml">λ</mi><mo id="S5.SS1.SSS4.Px1.p1.1.m1.1.1.1" xref="S5.SS1.SSS4.Px1.p1.1.m1.1.1.1.cmml">=</mo><mn id="S5.SS1.SSS4.Px1.p1.1.m1.1.1.3" xref="S5.SS1.SSS4.Px1.p1.1.m1.1.1.3.cmml">0.0005</mn></mrow><annotation-xml encoding="MathML-Content" id="S5.SS1.SSS4.Px1.p1.1.m1.1b"><apply id="S5.SS1.SSS4.Px1.p1.1.m1.1.1.cmml" xref="S5.SS1.SSS4.Px1.p1.1.m1.1.1"><eq id="S5.SS1.SSS4.Px1.p1.1.m1.1.1.1.cmml" xref="S5.SS1.SSS4.Px1.p1.1.m1.1.1.1"></eq><ci id="S5.SS1.SSS4.Px1.p1.1.m1.1.1.2.cmml" xref="S5.SS1.SSS4.Px1.p1.1.m1.1.1.2">𝜆</ci><cn type="float" id="S5.SS1.SSS4.Px1.p1.1.m1.1.1.3.cmml" xref="S5.SS1.SSS4.Px1.p1.1.m1.1.1.3">0.0005</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS1.SSS4.Px1.p1.1.m1.1c">\lambda=0.0005</annotation></semantics></math>, batch size <math id="S5.SS1.SSS4.Px1.p1.2.m2.1" class="ltx_Math" alttext="B=64" display="inline"><semantics id="S5.SS1.SSS4.Px1.p1.2.m2.1a"><mrow id="S5.SS1.SSS4.Px1.p1.2.m2.1.1" xref="S5.SS1.SSS4.Px1.p1.2.m2.1.1.cmml"><mi id="S5.SS1.SSS4.Px1.p1.2.m2.1.1.2" xref="S5.SS1.SSS4.Px1.p1.2.m2.1.1.2.cmml">B</mi><mo id="S5.SS1.SSS4.Px1.p1.2.m2.1.1.1" xref="S5.SS1.SSS4.Px1.p1.2.m2.1.1.1.cmml">=</mo><mn id="S5.SS1.SSS4.Px1.p1.2.m2.1.1.3" xref="S5.SS1.SSS4.Px1.p1.2.m2.1.1.3.cmml">64</mn></mrow><annotation-xml encoding="MathML-Content" id="S5.SS1.SSS4.Px1.p1.2.m2.1b"><apply id="S5.SS1.SSS4.Px1.p1.2.m2.1.1.cmml" xref="S5.SS1.SSS4.Px1.p1.2.m2.1.1"><eq id="S5.SS1.SSS4.Px1.p1.2.m2.1.1.1.cmml" xref="S5.SS1.SSS4.Px1.p1.2.m2.1.1.1"></eq><ci id="S5.SS1.SSS4.Px1.p1.2.m2.1.1.2.cmml" xref="S5.SS1.SSS4.Px1.p1.2.m2.1.1.2">𝐵</ci><cn type="integer" id="S5.SS1.SSS4.Px1.p1.2.m2.1.1.3.cmml" xref="S5.SS1.SSS4.Px1.p1.2.m2.1.1.3">64</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS1.SSS4.Px1.p1.2.m2.1c">B=64</annotation></semantics></math>. The optimizer is SGD with the momentum <math id="S5.SS1.SSS4.Px1.p1.3.m3.1" class="ltx_Math" alttext="m=0.9" display="inline"><semantics id="S5.SS1.SSS4.Px1.p1.3.m3.1a"><mrow id="S5.SS1.SSS4.Px1.p1.3.m3.1.1" xref="S5.SS1.SSS4.Px1.p1.3.m3.1.1.cmml"><mi id="S5.SS1.SSS4.Px1.p1.3.m3.1.1.2" xref="S5.SS1.SSS4.Px1.p1.3.m3.1.1.2.cmml">m</mi><mo id="S5.SS1.SSS4.Px1.p1.3.m3.1.1.1" xref="S5.SS1.SSS4.Px1.p1.3.m3.1.1.1.cmml">=</mo><mn id="S5.SS1.SSS4.Px1.p1.3.m3.1.1.3" xref="S5.SS1.SSS4.Px1.p1.3.m3.1.1.3.cmml">0.9</mn></mrow><annotation-xml encoding="MathML-Content" id="S5.SS1.SSS4.Px1.p1.3.m3.1b"><apply id="S5.SS1.SSS4.Px1.p1.3.m3.1.1.cmml" xref="S5.SS1.SSS4.Px1.p1.3.m3.1.1"><eq id="S5.SS1.SSS4.Px1.p1.3.m3.1.1.1.cmml" xref="S5.SS1.SSS4.Px1.p1.3.m3.1.1.1"></eq><ci id="S5.SS1.SSS4.Px1.p1.3.m3.1.1.2.cmml" xref="S5.SS1.SSS4.Px1.p1.3.m3.1.1.2">𝑚</ci><cn type="float" id="S5.SS1.SSS4.Px1.p1.3.m3.1.1.3.cmml" xref="S5.SS1.SSS4.Px1.p1.3.m3.1.1.3">0.9</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS1.SSS4.Px1.p1.3.m3.1c">m=0.9</annotation></semantics></math>, learning rate <math id="S5.SS1.SSS4.Px1.p1.4.m4.1" class="ltx_Math" alttext="\eta=0.1" display="inline"><semantics id="S5.SS1.SSS4.Px1.p1.4.m4.1a"><mrow id="S5.SS1.SSS4.Px1.p1.4.m4.1.1" xref="S5.SS1.SSS4.Px1.p1.4.m4.1.1.cmml"><mi id="S5.SS1.SSS4.Px1.p1.4.m4.1.1.2" xref="S5.SS1.SSS4.Px1.p1.4.m4.1.1.2.cmml">η</mi><mo id="S5.SS1.SSS4.Px1.p1.4.m4.1.1.1" xref="S5.SS1.SSS4.Px1.p1.4.m4.1.1.1.cmml">=</mo><mn id="S5.SS1.SSS4.Px1.p1.4.m4.1.1.3" xref="S5.SS1.SSS4.Px1.p1.4.m4.1.1.3.cmml">0.1</mn></mrow><annotation-xml encoding="MathML-Content" id="S5.SS1.SSS4.Px1.p1.4.m4.1b"><apply id="S5.SS1.SSS4.Px1.p1.4.m4.1.1.cmml" xref="S5.SS1.SSS4.Px1.p1.4.m4.1.1"><eq id="S5.SS1.SSS4.Px1.p1.4.m4.1.1.1.cmml" xref="S5.SS1.SSS4.Px1.p1.4.m4.1.1.1"></eq><ci id="S5.SS1.SSS4.Px1.p1.4.m4.1.1.2.cmml" xref="S5.SS1.SSS4.Px1.p1.4.m4.1.1.2">𝜂</ci><cn type="float" id="S5.SS1.SSS4.Px1.p1.4.m4.1.1.3.cmml" xref="S5.SS1.SSS4.Px1.p1.4.m4.1.1.3">0.1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS1.SSS4.Px1.p1.4.m4.1c">\eta=0.1</annotation></semantics></math>, and learning rate decay <math id="S5.SS1.SSS4.Px1.p1.5.m5.1" class="ltx_Math" alttext="\gamma=0.1" display="inline"><semantics id="S5.SS1.SSS4.Px1.p1.5.m5.1a"><mrow id="S5.SS1.SSS4.Px1.p1.5.m5.1.1" xref="S5.SS1.SSS4.Px1.p1.5.m5.1.1.cmml"><mi id="S5.SS1.SSS4.Px1.p1.5.m5.1.1.2" xref="S5.SS1.SSS4.Px1.p1.5.m5.1.1.2.cmml">γ</mi><mo id="S5.SS1.SSS4.Px1.p1.5.m5.1.1.1" xref="S5.SS1.SSS4.Px1.p1.5.m5.1.1.1.cmml">=</mo><mn id="S5.SS1.SSS4.Px1.p1.5.m5.1.1.3" xref="S5.SS1.SSS4.Px1.p1.5.m5.1.1.3.cmml">0.1</mn></mrow><annotation-xml encoding="MathML-Content" id="S5.SS1.SSS4.Px1.p1.5.m5.1b"><apply id="S5.SS1.SSS4.Px1.p1.5.m5.1.1.cmml" xref="S5.SS1.SSS4.Px1.p1.5.m5.1.1"><eq id="S5.SS1.SSS4.Px1.p1.5.m5.1.1.1.cmml" xref="S5.SS1.SSS4.Px1.p1.5.m5.1.1.1"></eq><ci id="S5.SS1.SSS4.Px1.p1.5.m5.1.1.2.cmml" xref="S5.SS1.SSS4.Px1.p1.5.m5.1.1.2">𝛾</ci><cn type="float" id="S5.SS1.SSS4.Px1.p1.5.m5.1.1.3.cmml" xref="S5.SS1.SSS4.Px1.p1.5.m5.1.1.3">0.1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS1.SSS4.Px1.p1.5.m5.1c">\gamma=0.1</annotation></semantics></math> every 100 epochs or Adam. Each Local experiment chose the better one as the final experimental result. The results of the Local are shown in Fig. <a href="#S4.F1" title="Figure 1 ‣ IV PFL-MF and PFL-MFE ‣ PFL-MoE: Personalized Federated Learning Based on Mixture of Experts" class="ltx_ref"><span class="ltx_text ltx_ref_tag">1</span></a>.</p>
</div>
</section>
<section id="S5.SS1.SSS4.Px2" class="ltx_paragraph">
<h5 class="ltx_title ltx_title_paragraph">FedAvg</h5>

<div id="S5.SS1.SSS4.Px2.p1" class="ltx_para">
<p id="S5.SS1.SSS4.Px2.p1.5" class="ltx_p">We trained the global model for 1000 rounds, following McMahan et al. <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib11" title="" class="ltx_ref">11</a>]</cite>, each round randomly selected <math id="S5.SS1.SSS4.Px2.p1.1.m1.1" class="ltx_Math" alttext="c=0.1" display="inline"><semantics id="S5.SS1.SSS4.Px2.p1.1.m1.1a"><mrow id="S5.SS1.SSS4.Px2.p1.1.m1.1.1" xref="S5.SS1.SSS4.Px2.p1.1.m1.1.1.cmml"><mi id="S5.SS1.SSS4.Px2.p1.1.m1.1.1.2" xref="S5.SS1.SSS4.Px2.p1.1.m1.1.1.2.cmml">c</mi><mo id="S5.SS1.SSS4.Px2.p1.1.m1.1.1.1" xref="S5.SS1.SSS4.Px2.p1.1.m1.1.1.1.cmml">=</mo><mn id="S5.SS1.SSS4.Px2.p1.1.m1.1.1.3" xref="S5.SS1.SSS4.Px2.p1.1.m1.1.1.3.cmml">0.1</mn></mrow><annotation-xml encoding="MathML-Content" id="S5.SS1.SSS4.Px2.p1.1.m1.1b"><apply id="S5.SS1.SSS4.Px2.p1.1.m1.1.1.cmml" xref="S5.SS1.SSS4.Px2.p1.1.m1.1.1"><eq id="S5.SS1.SSS4.Px2.p1.1.m1.1.1.1.cmml" xref="S5.SS1.SSS4.Px2.p1.1.m1.1.1.1"></eq><ci id="S5.SS1.SSS4.Px2.p1.1.m1.1.1.2.cmml" xref="S5.SS1.SSS4.Px2.p1.1.m1.1.1.2">𝑐</ci><cn type="float" id="S5.SS1.SSS4.Px2.p1.1.m1.1.1.3.cmml" xref="S5.SS1.SSS4.Px2.p1.1.m1.1.1.3">0.1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS1.SSS4.Px2.p1.1.m1.1c">c=0.1</annotation></semantics></math> rate of the clients for training with the learning rate <math id="S5.SS1.SSS4.Px2.p1.2.m2.1" class="ltx_Math" alttext="\eta=0.01" display="inline"><semantics id="S5.SS1.SSS4.Px2.p1.2.m2.1a"><mrow id="S5.SS1.SSS4.Px2.p1.2.m2.1.1" xref="S5.SS1.SSS4.Px2.p1.2.m2.1.1.cmml"><mi id="S5.SS1.SSS4.Px2.p1.2.m2.1.1.2" xref="S5.SS1.SSS4.Px2.p1.2.m2.1.1.2.cmml">η</mi><mo id="S5.SS1.SSS4.Px2.p1.2.m2.1.1.1" xref="S5.SS1.SSS4.Px2.p1.2.m2.1.1.1.cmml">=</mo><mn id="S5.SS1.SSS4.Px2.p1.2.m2.1.1.3" xref="S5.SS1.SSS4.Px2.p1.2.m2.1.1.3.cmml">0.01</mn></mrow><annotation-xml encoding="MathML-Content" id="S5.SS1.SSS4.Px2.p1.2.m2.1b"><apply id="S5.SS1.SSS4.Px2.p1.2.m2.1.1.cmml" xref="S5.SS1.SSS4.Px2.p1.2.m2.1.1"><eq id="S5.SS1.SSS4.Px2.p1.2.m2.1.1.1.cmml" xref="S5.SS1.SSS4.Px2.p1.2.m2.1.1.1"></eq><ci id="S5.SS1.SSS4.Px2.p1.2.m2.1.1.2.cmml" xref="S5.SS1.SSS4.Px2.p1.2.m2.1.1.2">𝜂</ci><cn type="float" id="S5.SS1.SSS4.Px2.p1.2.m2.1.1.3.cmml" xref="S5.SS1.SSS4.Px2.p1.2.m2.1.1.3">0.01</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS1.SSS4.Px2.p1.2.m2.1c">\eta=0.01</annotation></semantics></math>, momentum <math id="S5.SS1.SSS4.Px2.p1.3.m3.1" class="ltx_Math" alttext="m=0.5" display="inline"><semantics id="S5.SS1.SSS4.Px2.p1.3.m3.1a"><mrow id="S5.SS1.SSS4.Px2.p1.3.m3.1.1" xref="S5.SS1.SSS4.Px2.p1.3.m3.1.1.cmml"><mi id="S5.SS1.SSS4.Px2.p1.3.m3.1.1.2" xref="S5.SS1.SSS4.Px2.p1.3.m3.1.1.2.cmml">m</mi><mo id="S5.SS1.SSS4.Px2.p1.3.m3.1.1.1" xref="S5.SS1.SSS4.Px2.p1.3.m3.1.1.1.cmml">=</mo><mn id="S5.SS1.SSS4.Px2.p1.3.m3.1.1.3" xref="S5.SS1.SSS4.Px2.p1.3.m3.1.1.3.cmml">0.5</mn></mrow><annotation-xml encoding="MathML-Content" id="S5.SS1.SSS4.Px2.p1.3.m3.1b"><apply id="S5.SS1.SSS4.Px2.p1.3.m3.1.1.cmml" xref="S5.SS1.SSS4.Px2.p1.3.m3.1.1"><eq id="S5.SS1.SSS4.Px2.p1.3.m3.1.1.1.cmml" xref="S5.SS1.SSS4.Px2.p1.3.m3.1.1.1"></eq><ci id="S5.SS1.SSS4.Px2.p1.3.m3.1.1.2.cmml" xref="S5.SS1.SSS4.Px2.p1.3.m3.1.1.2">𝑚</ci><cn type="float" id="S5.SS1.SSS4.Px2.p1.3.m3.1.1.3.cmml" xref="S5.SS1.SSS4.Px2.p1.3.m3.1.1.3">0.5</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS1.SSS4.Px2.p1.3.m3.1c">m=0.5</annotation></semantics></math>, local batch size <math id="S5.SS1.SSS4.Px2.p1.4.m4.1" class="ltx_Math" alttext="b=10" display="inline"><semantics id="S5.SS1.SSS4.Px2.p1.4.m4.1a"><mrow id="S5.SS1.SSS4.Px2.p1.4.m4.1.1" xref="S5.SS1.SSS4.Px2.p1.4.m4.1.1.cmml"><mi id="S5.SS1.SSS4.Px2.p1.4.m4.1.1.2" xref="S5.SS1.SSS4.Px2.p1.4.m4.1.1.2.cmml">b</mi><mo id="S5.SS1.SSS4.Px2.p1.4.m4.1.1.1" xref="S5.SS1.SSS4.Px2.p1.4.m4.1.1.1.cmml">=</mo><mn id="S5.SS1.SSS4.Px2.p1.4.m4.1.1.3" xref="S5.SS1.SSS4.Px2.p1.4.m4.1.1.3.cmml">10</mn></mrow><annotation-xml encoding="MathML-Content" id="S5.SS1.SSS4.Px2.p1.4.m4.1b"><apply id="S5.SS1.SSS4.Px2.p1.4.m4.1.1.cmml" xref="S5.SS1.SSS4.Px2.p1.4.m4.1.1"><eq id="S5.SS1.SSS4.Px2.p1.4.m4.1.1.1.cmml" xref="S5.SS1.SSS4.Px2.p1.4.m4.1.1.1"></eq><ci id="S5.SS1.SSS4.Px2.p1.4.m4.1.1.2.cmml" xref="S5.SS1.SSS4.Px2.p1.4.m4.1.1.2">𝑏</ci><cn type="integer" id="S5.SS1.SSS4.Px2.p1.4.m4.1.1.3.cmml" xref="S5.SS1.SSS4.Px2.p1.4.m4.1.1.3">10</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS1.SSS4.Px2.p1.4.m4.1c">b=10</annotation></semantics></math>, and local epoch <math id="S5.SS1.SSS4.Px2.p1.5.m5.1" class="ltx_Math" alttext="e=5" display="inline"><semantics id="S5.SS1.SSS4.Px2.p1.5.m5.1a"><mrow id="S5.SS1.SSS4.Px2.p1.5.m5.1.1" xref="S5.SS1.SSS4.Px2.p1.5.m5.1.1.cmml"><mi id="S5.SS1.SSS4.Px2.p1.5.m5.1.1.2" xref="S5.SS1.SSS4.Px2.p1.5.m5.1.1.2.cmml">e</mi><mo id="S5.SS1.SSS4.Px2.p1.5.m5.1.1.1" xref="S5.SS1.SSS4.Px2.p1.5.m5.1.1.1.cmml">=</mo><mn id="S5.SS1.SSS4.Px2.p1.5.m5.1.1.3" xref="S5.SS1.SSS4.Px2.p1.5.m5.1.1.3.cmml">5</mn></mrow><annotation-xml encoding="MathML-Content" id="S5.SS1.SSS4.Px2.p1.5.m5.1b"><apply id="S5.SS1.SSS4.Px2.p1.5.m5.1.1.cmml" xref="S5.SS1.SSS4.Px2.p1.5.m5.1.1"><eq id="S5.SS1.SSS4.Px2.p1.5.m5.1.1.1.cmml" xref="S5.SS1.SSS4.Px2.p1.5.m5.1.1.1"></eq><ci id="S5.SS1.SSS4.Px2.p1.5.m5.1.1.2.cmml" xref="S5.SS1.SSS4.Px2.p1.5.m5.1.1.2">𝑒</ci><cn type="integer" id="S5.SS1.SSS4.Px2.p1.5.m5.1.1.3.cmml" xref="S5.SS1.SSS4.Px2.p1.5.m5.1.1.3">5</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS1.SSS4.Px2.p1.5.m5.1c">e=5</annotation></semantics></math>. We saved the model parameters that performed best on the global test set in these 1,000 rounds for the local adaptation of the following personalization algorithms. The results of FedAvg algorithm are shown in Fig.<a href="#S5.F2" title="Figure 2 ‣ FedAvg ‣ V-A4 Baselines and PFL-MoE ‣ V-A Experimental Setup ‣ V Experimental Evaluation ‣ PFL-MoE: Personalized Federated Learning Based on Mixture of Experts" class="ltx_ref"><span class="ltx_text ltx_ref_tag">2</span></a>.</p>
</div>
<figure id="S5.F2" class="ltx_figure">
<p id="S5.F2.1" class="ltx_p ltx_align_center"><span id="S5.F2.1.1" class="ltx_text"><img src="/html/2012.15589/assets/x2.png" id="S5.F2.1.1.g1" class="ltx_graphics ltx_img_landscape" width="230" height="182" alt="Refer to caption"></span></p>
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure">Figure 2: </span>Global test accuracy of FedAvg, 1000 rounds, participate rate 0.1, 100 clients.</figcaption>
</figure>
</section>
<section id="S5.SS1.SSS4.Px3" class="ltx_paragraph">
<h5 class="ltx_title ltx_title_paragraph">Personalization algorithms</h5>

<div id="S5.SS1.SSS4.Px3.p1" class="ltx_para">
<p id="S5.SS1.SSS4.Px3.p1.5" class="ltx_p">Each client trained 200 epochs for local adaption using the same SGD optimizer as the Local baseline. In PFL-FB experiments, the convolutional layers of LeNet-5 and VGG-16 were fixed, and the top layers were trained with the learning rate <math id="S5.SS1.SSS4.Px3.p1.1.m1.1" class="ltx_Math" alttext="\alpha=0.001" display="inline"><semantics id="S5.SS1.SSS4.Px3.p1.1.m1.1a"><mrow id="S5.SS1.SSS4.Px3.p1.1.m1.1.1" xref="S5.SS1.SSS4.Px3.p1.1.m1.1.1.cmml"><mi id="S5.SS1.SSS4.Px3.p1.1.m1.1.1.2" xref="S5.SS1.SSS4.Px3.p1.1.m1.1.1.2.cmml">α</mi><mo id="S5.SS1.SSS4.Px3.p1.1.m1.1.1.1" xref="S5.SS1.SSS4.Px3.p1.1.m1.1.1.1.cmml">=</mo><mn id="S5.SS1.SSS4.Px3.p1.1.m1.1.1.3" xref="S5.SS1.SSS4.Px3.p1.1.m1.1.1.3.cmml">0.001</mn></mrow><annotation-xml encoding="MathML-Content" id="S5.SS1.SSS4.Px3.p1.1.m1.1b"><apply id="S5.SS1.SSS4.Px3.p1.1.m1.1.1.cmml" xref="S5.SS1.SSS4.Px3.p1.1.m1.1.1"><eq id="S5.SS1.SSS4.Px3.p1.1.m1.1.1.1.cmml" xref="S5.SS1.SSS4.Px3.p1.1.m1.1.1.1"></eq><ci id="S5.SS1.SSS4.Px3.p1.1.m1.1.1.2.cmml" xref="S5.SS1.SSS4.Px3.p1.1.m1.1.1.2">𝛼</ci><cn type="float" id="S5.SS1.SSS4.Px3.p1.1.m1.1.1.3.cmml" xref="S5.SS1.SSS4.Px3.p1.1.m1.1.1.3">0.001</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS1.SSS4.Px3.p1.1.m1.1c">\alpha=0.001</annotation></semantics></math> and <math id="S5.SS1.SSS4.Px3.p1.2.m2.1" class="ltx_Math" alttext="\alpha=0.005" display="inline"><semantics id="S5.SS1.SSS4.Px3.p1.2.m2.1a"><mrow id="S5.SS1.SSS4.Px3.p1.2.m2.1.1" xref="S5.SS1.SSS4.Px3.p1.2.m2.1.1.cmml"><mi id="S5.SS1.SSS4.Px3.p1.2.m2.1.1.2" xref="S5.SS1.SSS4.Px3.p1.2.m2.1.1.2.cmml">α</mi><mo id="S5.SS1.SSS4.Px3.p1.2.m2.1.1.1" xref="S5.SS1.SSS4.Px3.p1.2.m2.1.1.1.cmml">=</mo><mn id="S5.SS1.SSS4.Px3.p1.2.m2.1.1.3" xref="S5.SS1.SSS4.Px3.p1.2.m2.1.1.3.cmml">0.005</mn></mrow><annotation-xml encoding="MathML-Content" id="S5.SS1.SSS4.Px3.p1.2.m2.1b"><apply id="S5.SS1.SSS4.Px3.p1.2.m2.1.1.cmml" xref="S5.SS1.SSS4.Px3.p1.2.m2.1.1"><eq id="S5.SS1.SSS4.Px3.p1.2.m2.1.1.1.cmml" xref="S5.SS1.SSS4.Px3.p1.2.m2.1.1.1"></eq><ci id="S5.SS1.SSS4.Px3.p1.2.m2.1.1.2.cmml" xref="S5.SS1.SSS4.Px3.p1.2.m2.1.1.2">𝛼</ci><cn type="float" id="S5.SS1.SSS4.Px3.p1.2.m2.1.1.3.cmml" xref="S5.SS1.SSS4.Px3.p1.2.m2.1.1.3">0.005</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS1.SSS4.Px3.p1.2.m2.1c">\alpha=0.005</annotation></semantics></math>, respectively. In PFL-MF experiments, the optimizer of gating network was SGD with the learning rate <math id="S5.SS1.SSS4.Px3.p1.3.m3.1" class="ltx_Math" alttext="\beta=0.001" display="inline"><semantics id="S5.SS1.SSS4.Px3.p1.3.m3.1a"><mrow id="S5.SS1.SSS4.Px3.p1.3.m3.1.1" xref="S5.SS1.SSS4.Px3.p1.3.m3.1.1.cmml"><mi id="S5.SS1.SSS4.Px3.p1.3.m3.1.1.2" xref="S5.SS1.SSS4.Px3.p1.3.m3.1.1.2.cmml">β</mi><mo id="S5.SS1.SSS4.Px3.p1.3.m3.1.1.1" xref="S5.SS1.SSS4.Px3.p1.3.m3.1.1.1.cmml">=</mo><mn id="S5.SS1.SSS4.Px3.p1.3.m3.1.1.3" xref="S5.SS1.SSS4.Px3.p1.3.m3.1.1.3.cmml">0.001</mn></mrow><annotation-xml encoding="MathML-Content" id="S5.SS1.SSS4.Px3.p1.3.m3.1b"><apply id="S5.SS1.SSS4.Px3.p1.3.m3.1.1.cmml" xref="S5.SS1.SSS4.Px3.p1.3.m3.1.1"><eq id="S5.SS1.SSS4.Px3.p1.3.m3.1.1.1.cmml" xref="S5.SS1.SSS4.Px3.p1.3.m3.1.1.1"></eq><ci id="S5.SS1.SSS4.Px3.p1.3.m3.1.1.2.cmml" xref="S5.SS1.SSS4.Px3.p1.3.m3.1.1.2">𝛽</ci><cn type="float" id="S5.SS1.SSS4.Px3.p1.3.m3.1.1.3.cmml" xref="S5.SS1.SSS4.Px3.p1.3.m3.1.1.3">0.001</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS1.SSS4.Px3.p1.3.m3.1c">\beta=0.001</annotation></semantics></math>. The input layer of gating network has <math id="S5.SS1.SSS4.Px3.p1.4.m4.1" class="ltx_Math" alttext="32\times 32\times 1=1024" display="inline"><semantics id="S5.SS1.SSS4.Px3.p1.4.m4.1a"><mrow id="S5.SS1.SSS4.Px3.p1.4.m4.1.1" xref="S5.SS1.SSS4.Px3.p1.4.m4.1.1.cmml"><mrow id="S5.SS1.SSS4.Px3.p1.4.m4.1.1.2" xref="S5.SS1.SSS4.Px3.p1.4.m4.1.1.2.cmml"><mn id="S5.SS1.SSS4.Px3.p1.4.m4.1.1.2.2" xref="S5.SS1.SSS4.Px3.p1.4.m4.1.1.2.2.cmml">32</mn><mo lspace="0.222em" rspace="0.222em" id="S5.SS1.SSS4.Px3.p1.4.m4.1.1.2.1" xref="S5.SS1.SSS4.Px3.p1.4.m4.1.1.2.1.cmml">×</mo><mn id="S5.SS1.SSS4.Px3.p1.4.m4.1.1.2.3" xref="S5.SS1.SSS4.Px3.p1.4.m4.1.1.2.3.cmml">32</mn><mo lspace="0.222em" rspace="0.222em" id="S5.SS1.SSS4.Px3.p1.4.m4.1.1.2.1a" xref="S5.SS1.SSS4.Px3.p1.4.m4.1.1.2.1.cmml">×</mo><mn id="S5.SS1.SSS4.Px3.p1.4.m4.1.1.2.4" xref="S5.SS1.SSS4.Px3.p1.4.m4.1.1.2.4.cmml">1</mn></mrow><mo id="S5.SS1.SSS4.Px3.p1.4.m4.1.1.1" xref="S5.SS1.SSS4.Px3.p1.4.m4.1.1.1.cmml">=</mo><mn id="S5.SS1.SSS4.Px3.p1.4.m4.1.1.3" xref="S5.SS1.SSS4.Px3.p1.4.m4.1.1.3.cmml">1024</mn></mrow><annotation-xml encoding="MathML-Content" id="S5.SS1.SSS4.Px3.p1.4.m4.1b"><apply id="S5.SS1.SSS4.Px3.p1.4.m4.1.1.cmml" xref="S5.SS1.SSS4.Px3.p1.4.m4.1.1"><eq id="S5.SS1.SSS4.Px3.p1.4.m4.1.1.1.cmml" xref="S5.SS1.SSS4.Px3.p1.4.m4.1.1.1"></eq><apply id="S5.SS1.SSS4.Px3.p1.4.m4.1.1.2.cmml" xref="S5.SS1.SSS4.Px3.p1.4.m4.1.1.2"><times id="S5.SS1.SSS4.Px3.p1.4.m4.1.1.2.1.cmml" xref="S5.SS1.SSS4.Px3.p1.4.m4.1.1.2.1"></times><cn type="integer" id="S5.SS1.SSS4.Px3.p1.4.m4.1.1.2.2.cmml" xref="S5.SS1.SSS4.Px3.p1.4.m4.1.1.2.2">32</cn><cn type="integer" id="S5.SS1.SSS4.Px3.p1.4.m4.1.1.2.3.cmml" xref="S5.SS1.SSS4.Px3.p1.4.m4.1.1.2.3">32</cn><cn type="integer" id="S5.SS1.SSS4.Px3.p1.4.m4.1.1.2.4.cmml" xref="S5.SS1.SSS4.Px3.p1.4.m4.1.1.2.4">1</cn></apply><cn type="integer" id="S5.SS1.SSS4.Px3.p1.4.m4.1.1.3.cmml" xref="S5.SS1.SSS4.Px3.p1.4.m4.1.1.3">1024</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS1.SSS4.Px3.p1.4.m4.1c">32\times 32\times 1=1024</annotation></semantics></math> and <math id="S5.SS1.SSS4.Px3.p1.5.m5.1" class="ltx_Math" alttext="32\times 32\times 3=3072" display="inline"><semantics id="S5.SS1.SSS4.Px3.p1.5.m5.1a"><mrow id="S5.SS1.SSS4.Px3.p1.5.m5.1.1" xref="S5.SS1.SSS4.Px3.p1.5.m5.1.1.cmml"><mrow id="S5.SS1.SSS4.Px3.p1.5.m5.1.1.2" xref="S5.SS1.SSS4.Px3.p1.5.m5.1.1.2.cmml"><mn id="S5.SS1.SSS4.Px3.p1.5.m5.1.1.2.2" xref="S5.SS1.SSS4.Px3.p1.5.m5.1.1.2.2.cmml">32</mn><mo lspace="0.222em" rspace="0.222em" id="S5.SS1.SSS4.Px3.p1.5.m5.1.1.2.1" xref="S5.SS1.SSS4.Px3.p1.5.m5.1.1.2.1.cmml">×</mo><mn id="S5.SS1.SSS4.Px3.p1.5.m5.1.1.2.3" xref="S5.SS1.SSS4.Px3.p1.5.m5.1.1.2.3.cmml">32</mn><mo lspace="0.222em" rspace="0.222em" id="S5.SS1.SSS4.Px3.p1.5.m5.1.1.2.1a" xref="S5.SS1.SSS4.Px3.p1.5.m5.1.1.2.1.cmml">×</mo><mn id="S5.SS1.SSS4.Px3.p1.5.m5.1.1.2.4" xref="S5.SS1.SSS4.Px3.p1.5.m5.1.1.2.4.cmml">3</mn></mrow><mo id="S5.SS1.SSS4.Px3.p1.5.m5.1.1.1" xref="S5.SS1.SSS4.Px3.p1.5.m5.1.1.1.cmml">=</mo><mn id="S5.SS1.SSS4.Px3.p1.5.m5.1.1.3" xref="S5.SS1.SSS4.Px3.p1.5.m5.1.1.3.cmml">3072</mn></mrow><annotation-xml encoding="MathML-Content" id="S5.SS1.SSS4.Px3.p1.5.m5.1b"><apply id="S5.SS1.SSS4.Px3.p1.5.m5.1.1.cmml" xref="S5.SS1.SSS4.Px3.p1.5.m5.1.1"><eq id="S5.SS1.SSS4.Px3.p1.5.m5.1.1.1.cmml" xref="S5.SS1.SSS4.Px3.p1.5.m5.1.1.1"></eq><apply id="S5.SS1.SSS4.Px3.p1.5.m5.1.1.2.cmml" xref="S5.SS1.SSS4.Px3.p1.5.m5.1.1.2"><times id="S5.SS1.SSS4.Px3.p1.5.m5.1.1.2.1.cmml" xref="S5.SS1.SSS4.Px3.p1.5.m5.1.1.2.1"></times><cn type="integer" id="S5.SS1.SSS4.Px3.p1.5.m5.1.1.2.2.cmml" xref="S5.SS1.SSS4.Px3.p1.5.m5.1.1.2.2">32</cn><cn type="integer" id="S5.SS1.SSS4.Px3.p1.5.m5.1.1.2.3.cmml" xref="S5.SS1.SSS4.Px3.p1.5.m5.1.1.2.3">32</cn><cn type="integer" id="S5.SS1.SSS4.Px3.p1.5.m5.1.1.2.4.cmml" xref="S5.SS1.SSS4.Px3.p1.5.m5.1.1.2.4">3</cn></apply><cn type="integer" id="S5.SS1.SSS4.Px3.p1.5.m5.1.1.3.cmml" xref="S5.SS1.SSS4.Px3.p1.5.m5.1.1.3">3072</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS1.SSS4.Px3.p1.5.m5.1c">32\times 32\times 3=3072</annotation></semantics></math> neurons for Fashion-MNIST and CIFAR-10, respectively. But in PFL-MFE, it changes to 400 and 512 for LeNet-5 and VGG-16.</p>
</div>
</section>
</section>
</section>
<section id="S5.SS2" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection"><span id="S5.SS2.5.1.1" class="ltx_text">V-B</span> </span><span id="S5.SS2.6.2" class="ltx_text ltx_font_italic">Effect of non-IID</span>
</h3>

<div id="S5.SS2.p1" class="ltx_para">
<p id="S5.SS2.p1.1" class="ltx_p">Fig. <a href="#S4.F1" title="Figure 1 ‣ IV PFL-MF and PFL-MFE ‣ PFL-MoE: Personalized Federated Learning Based on Mixture of Experts" class="ltx_ref"><span class="ltx_text ltx_ref_tag">1</span></a> shows that <span id="S5.SS2.p1.1.1" class="ltx_text ltx_font_bold">as the degree of non-IID increases (<math id="S5.SS2.p1.1.1.m1.1" class="ltx_Math" alttext="\alpha" display="inline"><semantics id="S5.SS2.p1.1.1.m1.1a"><mi id="S5.SS2.p1.1.1.m1.1.1" xref="S5.SS2.p1.1.1.m1.1.1.cmml">α</mi><annotation-xml encoding="MathML-Content" id="S5.SS2.p1.1.1.m1.1b"><ci id="S5.SS2.p1.1.1.m1.1.1.cmml" xref="S5.SS2.p1.1.1.m1.1.1">𝛼</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.SS2.p1.1.1.m1.1c">\alpha</annotation></semantics></math> get smaller), the local test accuracy of the Local also increases.</span> It consistent with our intuition: the more skewed the client’s data distribution, the easier it is to get high local test accuracy (e.g., in a client, a few categories account for a large proportion while only a small amount of data belongs to other categories, or the client has only one category at all). However, The model in Local is not necessarily a good model because the categories with only a small amount of data may be discarded, so that it never really distinguishes the difference between each category. The conjecture is confirmed from the global test of the Local in Fig. <a href="#S4.F1" title="Figure 1 ‣ IV PFL-MF and PFL-MFE ‣ PFL-MoE: Personalized Federated Learning Based on Mixture of Experts" class="ltx_ref"><span class="ltx_text ltx_ref_tag">1</span></a> and Tab. <a href="#S5.T2" title="TABLE II ‣ V-A4 Baselines and PFL-MoE ‣ V-A Experimental Setup ‣ V Experimental Evaluation ‣ PFL-MoE: Personalized Federated Learning Based on Mixture of Experts" class="ltx_ref"><span class="ltx_text ltx_ref_tag">II</span></a>., in all experiment, the global test accuracy of all clients is particularly low.
The highly non-IID skewed local data leads to the limitation of the stand-alone trained model.</p>
</div>
<div id="S5.SS2.p2" class="ltx_para">
<p id="S5.SS2.p2.1" class="ltx_p">From Tab. <a href="#S5.T1" title="TABLE I ‣ V-A4 Baselines and PFL-MoE ‣ V-A Experimental Setup ‣ V Experimental Evaluation ‣ PFL-MoE: Personalized Federated Learning Based on Mixture of Experts" class="ltx_ref"><span class="ltx_text ltx_ref_tag">I</span></a> and Tab. <a href="#S5.T2" title="TABLE II ‣ V-A4 Baselines and PFL-MoE ‣ V-A Experimental Setup ‣ V Experimental Evaluation ‣ PFL-MoE: Personalized Federated Learning Based on Mixture of Experts" class="ltx_ref"><span class="ltx_text ltx_ref_tag">II</span></a>, in all experiments, <span id="S5.SS2.p2.1.1" class="ltx_text ltx_font_bold">the accuracy of Local is lower than FedAvg’s in both local test and global test</span>, whether it is a large model VGG-16 or a small model LeNet-5.
In the CIFAR-10 experiments of Local,
<span id="S5.SS2.p2.1.2" class="ltx_text ltx_font_bold">the accuracy of the larger model VGG-16 is particularly low, which is significantly lower than the smaller model LeNet-5</span>. Generally speaking, the deeper the model, the higher the limitation of its capabilities, but more data is required for training.
Although the simple model performs relatively well in Local, its limitation gives the client a stronger incentive to participate in federated learning to train a more powerful model. Fig. <a href="#S5.F2" title="Figure 2 ‣ FedAvg ‣ V-A4 Baselines and PFL-MoE ‣ V-A Experimental Setup ‣ V Experimental Evaluation ‣ PFL-MoE: Personalized Federated Learning Based on Mixture of Experts" class="ltx_ref"><span class="ltx_text ltx_ref_tag">2</span></a> shows that VGG-16 achieves nearly 90% test accuracy by FedAvg algorithm. Large model can be adequately trained through federated learning, which greatly improves model accuracy compared to Local.</p>
</div>
<div id="S5.SS2.p3" class="ltx_para">
<p id="S5.SS2.p3.3" class="ltx_p">The column FedAvg in Tab. <a href="#S5.T1" title="TABLE I ‣ V-A4 Baselines and PFL-MoE ‣ V-A Experimental Setup ‣ V Experimental Evaluation ‣ PFL-MoE: Personalized Federated Learning Based on Mixture of Experts" class="ltx_ref"><span class="ltx_text ltx_ref_tag">I</span></a> (1000th round in Fig. <a href="#S5.F2" title="Figure 2 ‣ FedAvg ‣ V-A4 Baselines and PFL-MoE ‣ V-A Experimental Setup ‣ V Experimental Evaluation ‣ PFL-MoE: Personalized Federated Learning Based on Mixture of Experts" class="ltx_ref"><span class="ltx_text ltx_ref_tag">2</span></a>) presents the test accuracy of the global model of the FedAvg, where all three groups of experiments have the same results: <span id="S5.SS2.p3.1.1" class="ltx_text ltx_font_bold">the smaller the <math id="S5.SS2.p3.1.1.m1.1" class="ltx_Math" alttext="\alpha" display="inline"><semantics id="S5.SS2.p3.1.1.m1.1a"><mi id="S5.SS2.p3.1.1.m1.1.1" xref="S5.SS2.p3.1.1.m1.1.1.cmml">α</mi><annotation-xml encoding="MathML-Content" id="S5.SS2.p3.1.1.m1.1b"><ci id="S5.SS2.p3.1.1.m1.1.1.cmml" xref="S5.SS2.p3.1.1.m1.1.1">𝛼</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.SS2.p3.1.1.m1.1c">\alpha</annotation></semantics></math>, the worse the performance of FedAvg.</span>
On the contrary, Tab. <a href="#S5.T1" title="TABLE I ‣ V-A4 Baselines and PFL-MoE ‣ V-A Experimental Setup ‣ V Experimental Evaluation ‣ PFL-MoE: Personalized Federated Learning Based on Mixture of Experts" class="ltx_ref"><span class="ltx_text ltx_ref_tag">I</span></a> shows that <span id="S5.SS2.p3.2.2" class="ltx_text ltx_font_bold">as <math id="S5.SS2.p3.2.2.m1.1" class="ltx_Math" alttext="\alpha" display="inline"><semantics id="S5.SS2.p3.2.2.m1.1a"><mi id="S5.SS2.p3.2.2.m1.1.1" xref="S5.SS2.p3.2.2.m1.1.1.cmml">α</mi><annotation-xml encoding="MathML-Content" id="S5.SS2.p3.2.2.m1.1b"><ci id="S5.SS2.p3.2.2.m1.1.1.cmml" xref="S5.SS2.p3.2.2.m1.1.1">𝛼</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.SS2.p3.2.2.m1.1c">\alpha</annotation></semantics></math> gets smaller, the potential for personalization is growing</span>.
In DML, the convergence relies on the assumption that data are IID among workers. In line with the theoretical analysis <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib20" title="" class="ltx_ref">20</a>]</cite>, a smaller <math id="S5.SS2.p3.3.m1.1" class="ltx_Math" alttext="\alpha" display="inline"><semantics id="S5.SS2.p3.3.m1.1a"><mi id="S5.SS2.p3.3.m1.1.1" xref="S5.SS2.p3.3.m1.1.1.cmml">α</mi><annotation-xml encoding="MathML-Content" id="S5.SS2.p3.3.m1.1b"><ci id="S5.SS2.p3.3.m1.1.1.cmml" xref="S5.SS2.p3.3.m1.1.1">𝛼</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.SS2.p3.3.m1.1c">\alpha</annotation></semantics></math> means more deviation from the IID assumption, which hurts convergence rate and final model performance of FedAvg.
But this also makes us think: <span id="S5.SS2.p3.3.3" class="ltx_text ltx_font_italic">Why use the same global model for clients with heterogenous data.</span>
We further show that federated personalized learning is naturally suitable for the non-IID data distribution, and can effectively improve overall performance.</p>
</div>
<figure id="S5.F3" class="ltx_figure">
<p id="S5.F3.1" class="ltx_p ltx_align_center"><span id="S5.F3.1.1" class="ltx_text"><img src="/html/2012.15589/assets/x3.png" id="S5.F3.1.1.g1" class="ltx_graphics ltx_img_square" width="231" height="231" alt="Refer to caption"></span></p>
<br class="ltx_break ltx_break">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure">Figure 3: </span>Fashion-MNIST + LeNet-5, <math id="S5.F3.7.m1.1" class="ltx_Math" alttext="\alpha=0.9" display="inline"><semantics id="S5.F3.7.m1.1b"><mrow id="S5.F3.7.m1.1.1" xref="S5.F3.7.m1.1.1.cmml"><mi id="S5.F3.7.m1.1.1.2" xref="S5.F3.7.m1.1.1.2.cmml">α</mi><mo id="S5.F3.7.m1.1.1.1" xref="S5.F3.7.m1.1.1.1.cmml">=</mo><mn id="S5.F3.7.m1.1.1.3" xref="S5.F3.7.m1.1.1.3.cmml">0.9</mn></mrow><annotation-xml encoding="MathML-Content" id="S5.F3.7.m1.1c"><apply id="S5.F3.7.m1.1.1.cmml" xref="S5.F3.7.m1.1.1"><eq id="S5.F3.7.m1.1.1.1.cmml" xref="S5.F3.7.m1.1.1.1"></eq><ci id="S5.F3.7.m1.1.1.2.cmml" xref="S5.F3.7.m1.1.1.2">𝛼</ci><cn type="float" id="S5.F3.7.m1.1.1.3.cmml" xref="S5.F3.7.m1.1.1.3">0.9</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.F3.7.m1.1d">\alpha=0.9</annotation></semantics></math>, 100 clients. The global test accuracy and local test accuracy of all client of PFL-FB, PFL-MF, and PFL-MFE algorithms. All x-axis are FedAvg local test accuracy of each client (can be regarded as client index). Each point represents a test accuracy comparison between a PFL algorithm and FedAvg for a particular client. <span id="S5.F3.13.1" class="ltx_text ltx_font_bold">Compared with PFL-FB baseline, the more red triangles, the better our algorithms.</span> Fig. <a href="#S5.F3" title="Figure 3 ‣ V-B Effect of non-IID ‣ V Experimental Evaluation ‣ PFL-MoE: Personalized Federated Learning Based on Mixture of Experts" class="ltx_ref"><span class="ltx_text ltx_ref_tag">3</span></a><math id="S5.F3.8.m2.1" class="ltx_Math" alttext="(a)" display="inline"><semantics id="S5.F3.8.m2.1b"><mrow id="S5.F3.8.m2.1.2.2"><mo stretchy="false" id="S5.F3.8.m2.1.2.2.1">(</mo><mi id="S5.F3.8.m2.1.1" xref="S5.F3.8.m2.1.1.cmml">a</mi><mo stretchy="false" id="S5.F3.8.m2.1.2.2.2">)</mo></mrow><annotation-xml encoding="MathML-Content" id="S5.F3.8.m2.1c"><ci id="S5.F3.8.m2.1.1.cmml" xref="S5.F3.8.m2.1.1">𝑎</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.F3.8.m2.1d">(a)</annotation></semantics></math> and Fig. <a href="#S5.F3" title="Figure 3 ‣ V-B Effect of non-IID ‣ V Experimental Evaluation ‣ PFL-MoE: Personalized Federated Learning Based on Mixture of Experts" class="ltx_ref"><span class="ltx_text ltx_ref_tag">3</span></a><math id="S5.F3.9.m3.1" class="ltx_Math" alttext="(b)" display="inline"><semantics id="S5.F3.9.m3.1b"><mrow id="S5.F3.9.m3.1.2.2"><mo stretchy="false" id="S5.F3.9.m3.1.2.2.1">(</mo><mi id="S5.F3.9.m3.1.1" xref="S5.F3.9.m3.1.1.cmml">b</mi><mo stretchy="false" id="S5.F3.9.m3.1.2.2.2">)</mo></mrow><annotation-xml encoding="MathML-Content" id="S5.F3.9.m3.1c"><ci id="S5.F3.9.m3.1.1.cmml" xref="S5.F3.9.m3.1.1">𝑏</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.F3.9.m3.1d">(b)</annotation></semantics></math> compare the local test accuracy of the four algorithms for each client, while Fig. <a href="#S5.F3" title="Figure 3 ‣ V-B Effect of non-IID ‣ V Experimental Evaluation ‣ PFL-MoE: Personalized Federated Learning Based on Mixture of Experts" class="ltx_ref"><span class="ltx_text ltx_ref_tag">3</span></a><math id="S5.F3.10.m4.1" class="ltx_Math" alttext="(c)" display="inline"><semantics id="S5.F3.10.m4.1b"><mrow id="S5.F3.10.m4.1.2.2"><mo stretchy="false" id="S5.F3.10.m4.1.2.2.1">(</mo><mi id="S5.F3.10.m4.1.1" xref="S5.F3.10.m4.1.1.cmml">c</mi><mo stretchy="false" id="S5.F3.10.m4.1.2.2.2">)</mo></mrow><annotation-xml encoding="MathML-Content" id="S5.F3.10.m4.1c"><ci id="S5.F3.10.m4.1.1.cmml" xref="S5.F3.10.m4.1.1">𝑐</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.F3.10.m4.1d">(c)</annotation></semantics></math> and Fig <a href="#S5.F3" title="Figure 3 ‣ V-B Effect of non-IID ‣ V Experimental Evaluation ‣ PFL-MoE: Personalized Federated Learning Based on Mixture of Experts" class="ltx_ref"><span class="ltx_text ltx_ref_tag">3</span></a><math id="S5.F3.11.m5.1" class="ltx_Math" alttext="(d)" display="inline"><semantics id="S5.F3.11.m5.1b"><mrow id="S5.F3.11.m5.1.2.2"><mo stretchy="false" id="S5.F3.11.m5.1.2.2.1">(</mo><mi id="S5.F3.11.m5.1.1" xref="S5.F3.11.m5.1.1.cmml">d</mi><mo stretchy="false" id="S5.F3.11.m5.1.2.2.2">)</mo></mrow><annotation-xml encoding="MathML-Content" id="S5.F3.11.m5.1c"><ci id="S5.F3.11.m5.1.1.cmml" xref="S5.F3.11.m5.1.1">𝑑</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.F3.11.m5.1d">(d)</annotation></semantics></math> compare the global test accuracy of them for each client.
Fig.<a href="#S6.F4" title="Figure 4 ‣ VI Conclusion and Future work ‣ PFL-MoE: Personalized Federated Learning Based on Mixture of Experts" class="ltx_ref"><span class="ltx_text ltx_ref_tag">4</span></a> and Fig.<a href="#S6.F4" title="Figure 4 ‣ VI Conclusion and Future work ‣ PFL-MoE: Personalized Federated Learning Based on Mixture of Experts" class="ltx_ref"><span class="ltx_text ltx_ref_tag">4</span></a> have the same meaning but with different dataset+model.
</figcaption>
</figure>
</section>
<section id="S5.SS3" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection"><span id="S5.SS3.5.1.1" class="ltx_text">V-C</span> </span><span id="S5.SS3.6.2" class="ltx_text ltx_font_italic">Personalization of PFL-FB and PFL-MF</span>
</h3>

<div id="S5.SS3.p1" class="ltx_para">
<p id="S5.SS3.p1.3" class="ltx_p">Tab. <a href="#S5.T2" title="TABLE II ‣ V-A4 Baselines and PFL-MoE ‣ V-A Experimental Setup ‣ V Experimental Evaluation ‣ PFL-MoE: Personalized Federated Learning Based on Mixture of Experts" class="ltx_ref"><span class="ltx_text ltx_ref_tag">II</span></a> shows that the average global test accuracy of these three personalization algorithms are higher than that of Local, which means that personalized federated learning can effectively improve the generalization ability of the model on client.
Tab. <a href="#S4.F1" title="Figure 1 ‣ IV PFL-MF and PFL-MFE ‣ PFL-MoE: Personalized Federated Learning Based on Mixture of Experts" class="ltx_ref"><span class="ltx_text ltx_ref_tag">1</span></a> shows that the average local test accuracy of these three personalization algorithms are 2% <math id="S5.SS3.p1.1.m1.1" class="ltx_Math" alttext="\sim" display="inline"><semantics id="S5.SS3.p1.1.m1.1a"><mo id="S5.SS3.p1.1.m1.1.1" xref="S5.SS3.p1.1.m1.1.1.cmml">∼</mo><annotation-xml encoding="MathML-Content" id="S5.SS3.p1.1.m1.1b"><csymbol cd="latexml" id="S5.SS3.p1.1.m1.1.1.cmml" xref="S5.SS3.p1.1.m1.1.1">similar-to</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S5.SS3.p1.1.m1.1c">\sim</annotation></semantics></math> 10% higher than that of FedAvg at <math id="S5.SS3.p1.2.m2.1" class="ltx_Math" alttext="\alpha=0.5" display="inline"><semantics id="S5.SS3.p1.2.m2.1a"><mrow id="S5.SS3.p1.2.m2.1.1" xref="S5.SS3.p1.2.m2.1.1.cmml"><mi id="S5.SS3.p1.2.m2.1.1.2" xref="S5.SS3.p1.2.m2.1.1.2.cmml">α</mi><mo id="S5.SS3.p1.2.m2.1.1.1" xref="S5.SS3.p1.2.m2.1.1.1.cmml">=</mo><mn id="S5.SS3.p1.2.m2.1.1.3" xref="S5.SS3.p1.2.m2.1.1.3.cmml">0.5</mn></mrow><annotation-xml encoding="MathML-Content" id="S5.SS3.p1.2.m2.1b"><apply id="S5.SS3.p1.2.m2.1.1.cmml" xref="S5.SS3.p1.2.m2.1.1"><eq id="S5.SS3.p1.2.m2.1.1.1.cmml" xref="S5.SS3.p1.2.m2.1.1.1"></eq><ci id="S5.SS3.p1.2.m2.1.1.2.cmml" xref="S5.SS3.p1.2.m2.1.1.2">𝛼</ci><cn type="float" id="S5.SS3.p1.2.m2.1.1.3.cmml" xref="S5.SS3.p1.2.m2.1.1.3">0.5</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS3.p1.2.m2.1c">\alpha=0.5</annotation></semantics></math>.
However, <span id="S5.SS3.p1.3.1" class="ltx_text ltx_font_bold">PFL-FB is more likely to cause overfitting</span>. When <math id="S5.SS3.p1.3.m3.1" class="ltx_Math" alttext="\alpha" display="inline"><semantics id="S5.SS3.p1.3.m3.1a"><mi id="S5.SS3.p1.3.m3.1.1" xref="S5.SS3.p1.3.m3.1.1.cmml">α</mi><annotation-xml encoding="MathML-Content" id="S5.SS3.p1.3.m3.1b"><ci id="S5.SS3.p1.3.m3.1.1.cmml" xref="S5.SS3.p1.3.m3.1.1">𝛼</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.SS3.p1.3.m3.1c">\alpha</annotation></semantics></math> is relatively large,
PFL-FB is more likely to overfit local data, which makes the personalized model worse than the global model. In the proposed algorithm PFL-MF, if the personalized model deteriorates, it will be directly discarded by the gating network. Moreover, the gating network has learned which data is appropriate to use the personalized model and which data needs to be weighted more toward the global model. Consequently, PFL-MF is more stable, and its local test accuracy is always higher than FedAvg.</p>
</div>
<div id="S5.SS3.p2" class="ltx_para">
<p id="S5.SS3.p2.1" class="ltx_p">Comparing PFL-FB with PFL-MF in Tab. <a href="#S5.T1" title="TABLE I ‣ V-A4 Baselines and PFL-MoE ‣ V-A Experimental Setup ‣ V Experimental Evaluation ‣ PFL-MoE: Personalized Federated Learning Based on Mixture of Experts" class="ltx_ref"><span class="ltx_text ltx_ref_tag">I</span></a> and Tab. <a href="#S5.T2" title="TABLE II ‣ V-A4 Baselines and PFL-MoE ‣ V-A Experimental Setup ‣ V Experimental Evaluation ‣ PFL-MoE: Personalized Federated Learning Based on Mixture of Experts" class="ltx_ref"><span class="ltx_text ltx_ref_tag">II</span></a>, for each client,
<span id="S5.SS3.p2.1.1" class="ltx_text ltx_font_bold">the increase of the local test accuracy of PFL-FB comes at the cost of a significant drop in global test accuracy.</span>
For example, in the CIFAR-10 + LeNet-5 experiment, the average global test accuracy of PFL-FB dropped by 15%, from 68.92% to 54.28%. PFL-MF achieves the average global test accuracy with 1% <math id="S5.SS3.p2.1.m1.1" class="ltx_Math" alttext="\sim" display="inline"><semantics id="S5.SS3.p2.1.m1.1a"><mo id="S5.SS3.p2.1.m1.1.1" xref="S5.SS3.p2.1.m1.1.1.cmml">∼</mo><annotation-xml encoding="MathML-Content" id="S5.SS3.p2.1.m1.1b"><csymbol cd="latexml" id="S5.SS3.p2.1.m1.1.1.cmml" xref="S5.SS3.p2.1.m1.1.1">similar-to</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S5.SS3.p2.1.m1.1c">\sim</annotation></semantics></math> 8% higher than that of PFL-FB in all experiments.
The main incentive for clients participating in federated learning is to obtain a better model that is both personalized and generalized.
However, for a single model, the two capabilities are often contradictory. The algorithm based on our PFL-MoE makes it possible to get both capabilities at the same time.</p>
</div>
<div id="S5.SS3.p3" class="ltx_para">
<p id="S5.SS3.p3.7" class="ltx_p">As shown in Tab. <a href="#S5.T1" title="TABLE I ‣ V-A4 Baselines and PFL-MoE ‣ V-A Experimental Setup ‣ V Experimental Evaluation ‣ PFL-MoE: Personalized Federated Learning Based on Mixture of Experts" class="ltx_ref"><span class="ltx_text ltx_ref_tag">I</span></a> and Tab. <a href="#S5.T2" title="TABLE II ‣ V-A4 Baselines and PFL-MoE ‣ V-A Experimental Setup ‣ V Experimental Evaluation ‣ PFL-MoE: Personalized Federated Learning Based on Mixture of Experts" class="ltx_ref"><span class="ltx_text ltx_ref_tag">II</span></a>, in experiments on Fashion-MNIST, the proposed PFL-MF algorithm performs better than PFL-FB on the two tests, which indicates that
<span id="S5.SS3.p3.7.1" class="ltx_text ltx_font_bold">PFL-MF achieves better personalization and better generalization than PFL-FB.</span> However, in experiments on CIFAR-10, the average local test accuracy of PFL-MF is lower than that of PFL-FB, except in the LeNet-5 experiment with <math id="S5.SS3.p3.1.m1.1" class="ltx_Math" alttext="\alpha=2" display="inline"><semantics id="S5.SS3.p3.1.m1.1a"><mrow id="S5.SS3.p3.1.m1.1.1" xref="S5.SS3.p3.1.m1.1.1.cmml"><mi id="S5.SS3.p3.1.m1.1.1.2" xref="S5.SS3.p3.1.m1.1.1.2.cmml">α</mi><mo id="S5.SS3.p3.1.m1.1.1.1" xref="S5.SS3.p3.1.m1.1.1.1.cmml">=</mo><mn id="S5.SS3.p3.1.m1.1.1.3" xref="S5.SS3.p3.1.m1.1.1.3.cmml">2</mn></mrow><annotation-xml encoding="MathML-Content" id="S5.SS3.p3.1.m1.1b"><apply id="S5.SS3.p3.1.m1.1.1.cmml" xref="S5.SS3.p3.1.m1.1.1"><eq id="S5.SS3.p3.1.m1.1.1.1.cmml" xref="S5.SS3.p3.1.m1.1.1.1"></eq><ci id="S5.SS3.p3.1.m1.1.1.2.cmml" xref="S5.SS3.p3.1.m1.1.1.2">𝛼</ci><cn type="integer" id="S5.SS3.p3.1.m1.1.1.3.cmml" xref="S5.SS3.p3.1.m1.1.1.3">2</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS3.p3.1.m1.1c">\alpha=2</annotation></semantics></math>. It can be observed more obviously from Fig. <a href="#S5.F3" title="Figure 3 ‣ V-B Effect of non-IID ‣ V Experimental Evaluation ‣ PFL-MoE: Personalized Federated Learning Based on Mixture of Experts" class="ltx_ref"><span class="ltx_text ltx_ref_tag">3</span></a><math id="S5.SS3.p3.2.m2.1" class="ltx_Math" alttext="(a)" display="inline"><semantics id="S5.SS3.p3.2.m2.1a"><mrow id="S5.SS3.p3.2.m2.1.2.2"><mo stretchy="false" id="S5.SS3.p3.2.m2.1.2.2.1">(</mo><mi id="S5.SS3.p3.2.m2.1.1" xref="S5.SS3.p3.2.m2.1.1.cmml">a</mi><mo stretchy="false" id="S5.SS3.p3.2.m2.1.2.2.2">)</mo></mrow><annotation-xml encoding="MathML-Content" id="S5.SS3.p3.2.m2.1b"><ci id="S5.SS3.p3.2.m2.1.1.cmml" xref="S5.SS3.p3.2.m2.1.1">𝑎</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.SS3.p3.2.m2.1c">(a)</annotation></semantics></math>, Fig. <a href="#S6.F4" title="Figure 4 ‣ VI Conclusion and Future work ‣ PFL-MoE: Personalized Federated Learning Based on Mixture of Experts" class="ltx_ref"><span class="ltx_text ltx_ref_tag">4</span></a><math id="S5.SS3.p3.3.m3.1" class="ltx_Math" alttext="(a)" display="inline"><semantics id="S5.SS3.p3.3.m3.1a"><mrow id="S5.SS3.p3.3.m3.1.2.2"><mo stretchy="false" id="S5.SS3.p3.3.m3.1.2.2.1">(</mo><mi id="S5.SS3.p3.3.m3.1.1" xref="S5.SS3.p3.3.m3.1.1.cmml">a</mi><mo stretchy="false" id="S5.SS3.p3.3.m3.1.2.2.2">)</mo></mrow><annotation-xml encoding="MathML-Content" id="S5.SS3.p3.3.m3.1b"><ci id="S5.SS3.p3.3.m3.1.1.cmml" xref="S5.SS3.p3.3.m3.1.1">𝑎</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.SS3.p3.3.m3.1c">(a)</annotation></semantics></math>, and Fig. <a href="#S6.F5" title="Figure 5 ‣ VI Conclusion and Future work ‣ PFL-MoE: Personalized Federated Learning Based on Mixture of Experts" class="ltx_ref"><span class="ltx_text ltx_ref_tag">5</span></a><math id="S5.SS3.p3.4.m4.1" class="ltx_Math" alttext="(a)" display="inline"><semantics id="S5.SS3.p3.4.m4.1a"><mrow id="S5.SS3.p3.4.m4.1.2.2"><mo stretchy="false" id="S5.SS3.p3.4.m4.1.2.2.1">(</mo><mi id="S5.SS3.p3.4.m4.1.1" xref="S5.SS3.p3.4.m4.1.1.cmml">a</mi><mo stretchy="false" id="S5.SS3.p3.4.m4.1.2.2.2">)</mo></mrow><annotation-xml encoding="MathML-Content" id="S5.SS3.p3.4.m4.1b"><ci id="S5.SS3.p3.4.m4.1.1.cmml" xref="S5.SS3.p3.4.m4.1.1">𝑎</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.SS3.p3.4.m4.1c">(a)</annotation></semantics></math>. In Fig. <a href="#S5.F3" title="Figure 3 ‣ V-B Effect of non-IID ‣ V Experimental Evaluation ‣ PFL-MoE: Personalized Federated Learning Based on Mixture of Experts" class="ltx_ref"><span class="ltx_text ltx_ref_tag">3</span></a><math id="S5.SS3.p3.5.m5.1" class="ltx_Math" alttext="(a)" display="inline"><semantics id="S5.SS3.p3.5.m5.1a"><mrow id="S5.SS3.p3.5.m5.1.2.2"><mo stretchy="false" id="S5.SS3.p3.5.m5.1.2.2.1">(</mo><mi id="S5.SS3.p3.5.m5.1.1" xref="S5.SS3.p3.5.m5.1.1.cmml">a</mi><mo stretchy="false" id="S5.SS3.p3.5.m5.1.2.2.2">)</mo></mrow><annotation-xml encoding="MathML-Content" id="S5.SS3.p3.5.m5.1b"><ci id="S5.SS3.p3.5.m5.1.1.cmml" xref="S5.SS3.p3.5.m5.1.1">𝑎</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.SS3.p3.5.m5.1c">(a)</annotation></semantics></math>, red is the majority, while in Fig. <a href="#S6.F4" title="Figure 4 ‣ VI Conclusion and Future work ‣ PFL-MoE: Personalized Federated Learning Based on Mixture of Experts" class="ltx_ref"><span class="ltx_text ltx_ref_tag">4</span></a><math id="S5.SS3.p3.6.m6.1" class="ltx_Math" alttext="(a)" display="inline"><semantics id="S5.SS3.p3.6.m6.1a"><mrow id="S5.SS3.p3.6.m6.1.2.2"><mo stretchy="false" id="S5.SS3.p3.6.m6.1.2.2.1">(</mo><mi id="S5.SS3.p3.6.m6.1.1" xref="S5.SS3.p3.6.m6.1.1.cmml">a</mi><mo stretchy="false" id="S5.SS3.p3.6.m6.1.2.2.2">)</mo></mrow><annotation-xml encoding="MathML-Content" id="S5.SS3.p3.6.m6.1b"><ci id="S5.SS3.p3.6.m6.1.1.cmml" xref="S5.SS3.p3.6.m6.1.1">𝑎</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.SS3.p3.6.m6.1c">(a)</annotation></semantics></math> and Fig. <a href="#S6.F5" title="Figure 5 ‣ VI Conclusion and Future work ‣ PFL-MoE: Personalized Federated Learning Based on Mixture of Experts" class="ltx_ref"><span class="ltx_text ltx_ref_tag">5</span></a><math id="S5.SS3.p3.7.m7.1" class="ltx_Math" alttext="(a)" display="inline"><semantics id="S5.SS3.p3.7.m7.1a"><mrow id="S5.SS3.p3.7.m7.1.2.2"><mo stretchy="false" id="S5.SS3.p3.7.m7.1.2.2.1">(</mo><mi id="S5.SS3.p3.7.m7.1.1" xref="S5.SS3.p3.7.m7.1.1.cmml">a</mi><mo stretchy="false" id="S5.SS3.p3.7.m7.1.2.2.2">)</mo></mrow><annotation-xml encoding="MathML-Content" id="S5.SS3.p3.7.m7.1b"><ci id="S5.SS3.p3.7.m7.1.1.cmml" xref="S5.SS3.p3.7.m7.1.1">𝑎</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.SS3.p3.7.m7.1c">(a)</annotation></semantics></math>, green is the majority.
In PFL-FM, the gating network can only recognize and make the decisions for simple data, such as the Fashion-MNIST dataset. But for the more complex color image dataset CIFAR-10, the gating network needs to be improved.
‘
</p>
</div>
</section>
<section id="S5.SS4" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection"><span id="S5.SS4.5.1.1" class="ltx_text">V-D</span> </span><span id="S5.SS4.6.2" class="ltx_text ltx_font_italic">Effect of PFL-MFE</span>
</h3>

<div id="S5.SS4.p1" class="ltx_para">
<p id="S5.SS4.p1.10" class="ltx_p">From Tab. <a href="#S5.T1" title="TABLE I ‣ V-A4 Baselines and PFL-MoE ‣ V-A Experimental Setup ‣ V Experimental Evaluation ‣ PFL-MoE: Personalized Federated Learning Based on Mixture of Experts" class="ltx_ref"><span class="ltx_text ltx_ref_tag">I</span></a>, in the experiments on CIFAR-10, the average local test of PFL-MFE is 0.3% <math id="S5.SS4.p1.1.m1.1" class="ltx_Math" alttext="\sim" display="inline"><semantics id="S5.SS4.p1.1.m1.1a"><mo id="S5.SS4.p1.1.m1.1.1" xref="S5.SS4.p1.1.m1.1.1.cmml">∼</mo><annotation-xml encoding="MathML-Content" id="S5.SS4.p1.1.m1.1b"><csymbol cd="latexml" id="S5.SS4.p1.1.m1.1.1.cmml" xref="S5.SS4.p1.1.m1.1.1">similar-to</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S5.SS4.p1.1.m1.1c">\sim</annotation></semantics></math> 1.7% higher than that of PFL-MF.
Although the average global test accuracy of PFL-MFE is slightly lower than that of PFL-MF, it is still higher than that of PFL-FB.
Comparing Fig. <a href="#S6.F4" title="Figure 4 ‣ VI Conclusion and Future work ‣ PFL-MoE: Personalized Federated Learning Based on Mixture of Experts" class="ltx_ref"><span class="ltx_text ltx_ref_tag">4</span></a><math id="S5.SS4.p1.2.m2.1" class="ltx_Math" alttext="(a)" display="inline"><semantics id="S5.SS4.p1.2.m2.1a"><mrow id="S5.SS4.p1.2.m2.1.2.2"><mo stretchy="false" id="S5.SS4.p1.2.m2.1.2.2.1">(</mo><mi id="S5.SS4.p1.2.m2.1.1" xref="S5.SS4.p1.2.m2.1.1.cmml">a</mi><mo stretchy="false" id="S5.SS4.p1.2.m2.1.2.2.2">)</mo></mrow><annotation-xml encoding="MathML-Content" id="S5.SS4.p1.2.m2.1b"><ci id="S5.SS4.p1.2.m2.1.1.cmml" xref="S5.SS4.p1.2.m2.1.1">𝑎</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.SS4.p1.2.m2.1c">(a)</annotation></semantics></math> with Fig. <a href="#S6.F4" title="Figure 4 ‣ VI Conclusion and Future work ‣ PFL-MoE: Personalized Federated Learning Based on Mixture of Experts" class="ltx_ref"><span class="ltx_text ltx_ref_tag">4</span></a><math id="S5.SS4.p1.3.m3.1" class="ltx_Math" alttext="(b)" display="inline"><semantics id="S5.SS4.p1.3.m3.1a"><mrow id="S5.SS4.p1.3.m3.1.2.2"><mo stretchy="false" id="S5.SS4.p1.3.m3.1.2.2.1">(</mo><mi id="S5.SS4.p1.3.m3.1.1" xref="S5.SS4.p1.3.m3.1.1.cmml">b</mi><mo stretchy="false" id="S5.SS4.p1.3.m3.1.2.2.2">)</mo></mrow><annotation-xml encoding="MathML-Content" id="S5.SS4.p1.3.m3.1b"><ci id="S5.SS4.p1.3.m3.1.1.cmml" xref="S5.SS4.p1.3.m3.1.1">𝑏</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.SS4.p1.3.m3.1c">(b)</annotation></semantics></math>, we can see that, lots of green triangles in Fig. <a href="#S6.F4" title="Figure 4 ‣ VI Conclusion and Future work ‣ PFL-MoE: Personalized Federated Learning Based on Mixture of Experts" class="ltx_ref"><span class="ltx_text ltx_ref_tag">4</span></a><math id="S5.SS4.p1.4.m4.1" class="ltx_Math" alttext="(a)" display="inline"><semantics id="S5.SS4.p1.4.m4.1a"><mrow id="S5.SS4.p1.4.m4.1.2.2"><mo stretchy="false" id="S5.SS4.p1.4.m4.1.2.2.1">(</mo><mi id="S5.SS4.p1.4.m4.1.1" xref="S5.SS4.p1.4.m4.1.1.cmml">a</mi><mo stretchy="false" id="S5.SS4.p1.4.m4.1.2.2.2">)</mo></mrow><annotation-xml encoding="MathML-Content" id="S5.SS4.p1.4.m4.1b"><ci id="S5.SS4.p1.4.m4.1.1.cmml" xref="S5.SS4.p1.4.m4.1.1">𝑎</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.SS4.p1.4.m4.1c">(a)</annotation></semantics></math> increase and turn to red in Fig. <a href="#S6.F4" title="Figure 4 ‣ VI Conclusion and Future work ‣ PFL-MoE: Personalized Federated Learning Based on Mixture of Experts" class="ltx_ref"><span class="ltx_text ltx_ref_tag">4</span></a><math id="S5.SS4.p1.5.m5.1" class="ltx_Math" alttext="(b)" display="inline"><semantics id="S5.SS4.p1.5.m5.1a"><mrow id="S5.SS4.p1.5.m5.1.2.2"><mo stretchy="false" id="S5.SS4.p1.5.m5.1.2.2.1">(</mo><mi id="S5.SS4.p1.5.m5.1.1" xref="S5.SS4.p1.5.m5.1.1.cmml">b</mi><mo stretchy="false" id="S5.SS4.p1.5.m5.1.2.2.2">)</mo></mrow><annotation-xml encoding="MathML-Content" id="S5.SS4.p1.5.m5.1b"><ci id="S5.SS4.p1.5.m5.1.1.cmml" xref="S5.SS4.p1.5.m5.1.1">𝑏</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.SS4.p1.5.m5.1c">(b)</annotation></semantics></math> while the triangles in Fig. <a href="#S6.F4" title="Figure 4 ‣ VI Conclusion and Future work ‣ PFL-MoE: Personalized Federated Learning Based on Mixture of Experts" class="ltx_ref"><span class="ltx_text ltx_ref_tag">4</span></a><math id="S5.SS4.p1.6.m6.1" class="ltx_Math" alttext="(c)" display="inline"><semantics id="S5.SS4.p1.6.m6.1a"><mrow id="S5.SS4.p1.6.m6.1.2.2"><mo stretchy="false" id="S5.SS4.p1.6.m6.1.2.2.1">(</mo><mi id="S5.SS4.p1.6.m6.1.1" xref="S5.SS4.p1.6.m6.1.1.cmml">c</mi><mo stretchy="false" id="S5.SS4.p1.6.m6.1.2.2.2">)</mo></mrow><annotation-xml encoding="MathML-Content" id="S5.SS4.p1.6.m6.1b"><ci id="S5.SS4.p1.6.m6.1.1.cmml" xref="S5.SS4.p1.6.m6.1.1">𝑐</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.SS4.p1.6.m6.1c">(c)</annotation></semantics></math> and Fig. <a href="#S6.F4" title="Figure 4 ‣ VI Conclusion and Future work ‣ PFL-MoE: Personalized Federated Learning Based on Mixture of Experts" class="ltx_ref"><span class="ltx_text ltx_ref_tag">4</span></a><math id="S5.SS4.p1.7.m7.1" class="ltx_Math" alttext="(d)" display="inline"><semantics id="S5.SS4.p1.7.m7.1a"><mrow id="S5.SS4.p1.7.m7.1.2.2"><mo stretchy="false" id="S5.SS4.p1.7.m7.1.2.2.1">(</mo><mi id="S5.SS4.p1.7.m7.1.1" xref="S5.SS4.p1.7.m7.1.1.cmml">d</mi><mo stretchy="false" id="S5.SS4.p1.7.m7.1.2.2.2">)</mo></mrow><annotation-xml encoding="MathML-Content" id="S5.SS4.p1.7.m7.1b"><ci id="S5.SS4.p1.7.m7.1.1.cmml" xref="S5.SS4.p1.7.m7.1.1">𝑑</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.SS4.p1.7.m7.1c">(d)</annotation></semantics></math> are always red. In Fig. <a href="#S6.F5" title="Figure 5 ‣ VI Conclusion and Future work ‣ PFL-MoE: Personalized Federated Learning Based on Mixture of Experts" class="ltx_ref"><span class="ltx_text ltx_ref_tag">5</span></a>, we have the same observation as in Fig. <a href="#S6.F4" title="Figure 4 ‣ VI Conclusion and Future work ‣ PFL-MoE: Personalized Federated Learning Based on Mixture of Experts" class="ltx_ref"><span class="ltx_text ltx_ref_tag">4</span></a>.
In the experiments on Fashion-MNIST, although PFL-MFE outperforms PFL-MF in local test only when <math id="S5.SS4.p1.8.m8.1" class="ltx_Math" alttext="\alpha=0.5" display="inline"><semantics id="S5.SS4.p1.8.m8.1a"><mrow id="S5.SS4.p1.8.m8.1.1" xref="S5.SS4.p1.8.m8.1.1.cmml"><mi id="S5.SS4.p1.8.m8.1.1.2" xref="S5.SS4.p1.8.m8.1.1.2.cmml">α</mi><mo id="S5.SS4.p1.8.m8.1.1.1" xref="S5.SS4.p1.8.m8.1.1.1.cmml">=</mo><mn id="S5.SS4.p1.8.m8.1.1.3" xref="S5.SS4.p1.8.m8.1.1.3.cmml">0.5</mn></mrow><annotation-xml encoding="MathML-Content" id="S5.SS4.p1.8.m8.1b"><apply id="S5.SS4.p1.8.m8.1.1.cmml" xref="S5.SS4.p1.8.m8.1.1"><eq id="S5.SS4.p1.8.m8.1.1.1.cmml" xref="S5.SS4.p1.8.m8.1.1.1"></eq><ci id="S5.SS4.p1.8.m8.1.1.2.cmml" xref="S5.SS4.p1.8.m8.1.1.2">𝛼</ci><cn type="float" id="S5.SS4.p1.8.m8.1.1.3.cmml" xref="S5.SS4.p1.8.m8.1.1.3">0.5</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS4.p1.8.m8.1c">\alpha=0.5</annotation></semantics></math>, it is very close to PFL-MF at other <math id="S5.SS4.p1.9.m9.1" class="ltx_Math" alttext="\alpha" display="inline"><semantics id="S5.SS4.p1.9.m9.1a"><mi id="S5.SS4.p1.9.m9.1.1" xref="S5.SS4.p1.9.m9.1.1.cmml">α</mi><annotation-xml encoding="MathML-Content" id="S5.SS4.p1.9.m9.1b"><ci id="S5.SS4.p1.9.m9.1.1.cmml" xref="S5.SS4.p1.9.m9.1.1">𝛼</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.SS4.p1.9.m9.1c">\alpha</annotation></semantics></math> values.
PFL-MFE and PFL-MF are both 0.05% <math id="S5.SS4.p1.10.m10.1" class="ltx_Math" alttext="\sim" display="inline"><semantics id="S5.SS4.p1.10.m10.1a"><mo id="S5.SS4.p1.10.m10.1.1" xref="S5.SS4.p1.10.m10.1.1.cmml">∼</mo><annotation-xml encoding="MathML-Content" id="S5.SS4.p1.10.m10.1b"><csymbol cd="latexml" id="S5.SS4.p1.10.m10.1.1.cmml" xref="S5.SS4.p1.10.m10.1.1">similar-to</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S5.SS4.p1.10.m10.1c">\sim</annotation></semantics></math> 0.5% higher than PFL-FB in average local test accuracy.</p>
</div>
<div id="S5.SS4.p2" class="ltx_para">
<p id="S5.SS4.p2.1" class="ltx_p">In the experiments on CIFAR-10, PFL-MFE is more effective than PFL-MF, because the gating network can make better decisions indirectly by using the abstract features. For the simple Fashion-MNIST dataset, PFL-MF is enough.
<span id="S5.SS4.p2.1.1" class="ltx_text ltx_font_bold">PFL-MFE can better recognize complex input data while maintaining the advantages of PFL-MF.</span>
As shown in Tab. <a href="#S5.T1" title="TABLE I ‣ V-A4 Baselines and PFL-MoE ‣ V-A Experimental Setup ‣ V Experimental Evaluation ‣ PFL-MoE: Personalized Federated Learning Based on Mixture of Experts" class="ltx_ref"><span class="ltx_text ltx_ref_tag">I</span></a> and Tab. <a href="#S5.T2" title="TABLE II ‣ V-A4 Baselines and PFL-MoE ‣ V-A Experimental Setup ‣ V Experimental Evaluation ‣ PFL-MoE: Personalized Federated Learning Based on Mixture of Experts" class="ltx_ref"><span class="ltx_text ltx_ref_tag">II</span></a>, in all experiments, overall, PFL-MFE achieves the best average local test accuracy among three personalization algorithms, and it is much better than PFL-FB in the average global test accuracy. In a word, the proposed PFL-MFE algorithm can realize personalization more effectively while maintaining better generalization.</p>
</div>
</section>
</section>
<section id="S6" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">VI </span><span id="S6.1.1" class="ltx_text ltx_font_smallcaps">Conclusion and Future work</span>
</h2>

<div id="S6.p1" class="ltx_para">
<p id="S6.p1.1" class="ltx_p">We propose PFL-MoE, an MoE based approach for personalized federated learning. PFL-MoE can combine advantages of the personalized model and the global model and achieve both better personalization and better generalization.
PFL-MF, an instance of PFL-MoE, performs better than existing algorithm PFL-FB in both local test and global test. We also show that PFL-MFE strengthens the decision-making ability of the MoE gating network and can be effective when processing more complex data.
In the future, we will explore the instance of PFL-MoE of other personalized federated learning algorithms and compare their overall performance.</p>
</div>
<figure id="S6.F4" class="ltx_figure">
<p id="S6.F4.1" class="ltx_p ltx_align_center ltx_align_center"><span id="S6.F4.1.1" class="ltx_text"><img src="/html/2012.15589/assets/x4.png" id="S6.F4.1.1.g1" class="ltx_graphics ltx_img_square" width="231" height="231" alt="Refer to caption"></span></p>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 4: </span>CIFAR-10 + LeNet-5, <math id="S6.F4.8.m1.1" class="ltx_Math" alttext="\alpha=0.9" display="inline"><semantics id="S6.F4.8.m1.1b"><mrow id="S6.F4.8.m1.1.1" xref="S6.F4.8.m1.1.1.cmml"><mi id="S6.F4.8.m1.1.1.2" xref="S6.F4.8.m1.1.1.2.cmml">α</mi><mo id="S6.F4.8.m1.1.1.1" xref="S6.F4.8.m1.1.1.1.cmml">=</mo><mn id="S6.F4.8.m1.1.1.3" xref="S6.F4.8.m1.1.1.3.cmml">0.9</mn></mrow><annotation-xml encoding="MathML-Content" id="S6.F4.8.m1.1c"><apply id="S6.F4.8.m1.1.1.cmml" xref="S6.F4.8.m1.1.1"><eq id="S6.F4.8.m1.1.1.1.cmml" xref="S6.F4.8.m1.1.1.1"></eq><ci id="S6.F4.8.m1.1.1.2.cmml" xref="S6.F4.8.m1.1.1.2">𝛼</ci><cn type="float" id="S6.F4.8.m1.1.1.3.cmml" xref="S6.F4.8.m1.1.1.3">0.9</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S6.F4.8.m1.1d">\alpha=0.9</annotation></semantics></math>, 100 clients. Comparing Fig. <a href="#S6.F4" title="Figure 4 ‣ VI Conclusion and Future work ‣ PFL-MoE: Personalized Federated Learning Based on Mixture of Experts" class="ltx_ref"><span class="ltx_text ltx_ref_tag">4</span></a><math id="S6.F4.9.m2.1" class="ltx_Math" alttext="(a)" display="inline"><semantics id="S6.F4.9.m2.1b"><mrow id="S6.F4.9.m2.1.2.2"><mo stretchy="false" id="S6.F4.9.m2.1.2.2.1">(</mo><mi id="S6.F4.9.m2.1.1" xref="S6.F4.9.m2.1.1.cmml">a</mi><mo stretchy="false" id="S6.F4.9.m2.1.2.2.2">)</mo></mrow><annotation-xml encoding="MathML-Content" id="S6.F4.9.m2.1c"><ci id="S6.F4.9.m2.1.1.cmml" xref="S6.F4.9.m2.1.1">𝑎</ci></annotation-xml><annotation encoding="application/x-tex" id="S6.F4.9.m2.1d">(a)</annotation></semantics></math> with Fig. <a href="#S6.F4" title="Figure 4 ‣ VI Conclusion and Future work ‣ PFL-MoE: Personalized Federated Learning Based on Mixture of Experts" class="ltx_ref"><span class="ltx_text ltx_ref_tag">4</span></a><math id="S6.F4.10.m3.1" class="ltx_Math" alttext="(b)" display="inline"><semantics id="S6.F4.10.m3.1b"><mrow id="S6.F4.10.m3.1.2.2"><mo stretchy="false" id="S6.F4.10.m3.1.2.2.1">(</mo><mi id="S6.F4.10.m3.1.1" xref="S6.F4.10.m3.1.1.cmml">b</mi><mo stretchy="false" id="S6.F4.10.m3.1.2.2.2">)</mo></mrow><annotation-xml encoding="MathML-Content" id="S6.F4.10.m3.1c"><ci id="S6.F4.10.m3.1.1.cmml" xref="S6.F4.10.m3.1.1">𝑏</ci></annotation-xml><annotation encoding="application/x-tex" id="S6.F4.10.m3.1d">(b)</annotation></semantics></math>, the same in Fig. <a href="#S5.F3" title="Figure 3 ‣ V-B Effect of non-IID ‣ V Experimental Evaluation ‣ PFL-MoE: Personalized Federated Learning Based on Mixture of Experts" class="ltx_ref"><span class="ltx_text ltx_ref_tag">3</span></a>, the points with <math id="S6.F4.11.m4.1" class="ltx_Math" alttext="y&gt;0" display="inline"><semantics id="S6.F4.11.m4.1b"><mrow id="S6.F4.11.m4.1.1" xref="S6.F4.11.m4.1.1.cmml"><mi id="S6.F4.11.m4.1.1.2" xref="S6.F4.11.m4.1.1.2.cmml">y</mi><mo id="S6.F4.11.m4.1.1.1" xref="S6.F4.11.m4.1.1.1.cmml">&gt;</mo><mn id="S6.F4.11.m4.1.1.3" xref="S6.F4.11.m4.1.1.3.cmml">0</mn></mrow><annotation-xml encoding="MathML-Content" id="S6.F4.11.m4.1c"><apply id="S6.F4.11.m4.1.1.cmml" xref="S6.F4.11.m4.1.1"><gt id="S6.F4.11.m4.1.1.1.cmml" xref="S6.F4.11.m4.1.1.1"></gt><ci id="S6.F4.11.m4.1.1.2.cmml" xref="S6.F4.11.m4.1.1.2">𝑦</ci><cn type="integer" id="S6.F4.11.m4.1.1.3.cmml" xref="S6.F4.11.m4.1.1.3">0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S6.F4.11.m4.1d">y&gt;0</annotation></semantics></math> in the triangle points are more than that in round points. But in Fig. <a href="#S6.F4" title="Figure 4 ‣ VI Conclusion and Future work ‣ PFL-MoE: Personalized Federated Learning Based on Mixture of Experts" class="ltx_ref"><span class="ltx_text ltx_ref_tag">4</span></a><math id="S6.F4.12.m5.1" class="ltx_Math" alttext="(a)" display="inline"><semantics id="S6.F4.12.m5.1b"><mrow id="S6.F4.12.m5.1.2.2"><mo stretchy="false" id="S6.F4.12.m5.1.2.2.1">(</mo><mi id="S6.F4.12.m5.1.1" xref="S6.F4.12.m5.1.1.cmml">a</mi><mo stretchy="false" id="S6.F4.12.m5.1.2.2.2">)</mo></mrow><annotation-xml encoding="MathML-Content" id="S6.F4.12.m5.1c"><ci id="S6.F4.12.m5.1.1.cmml" xref="S6.F4.12.m5.1.1">𝑎</ci></annotation-xml><annotation encoding="application/x-tex" id="S6.F4.12.m5.1d">(a)</annotation></semantics></math>, there are a large number of green triangles which means that the personalization effect of PFL-MF is not better as that of PFL-FB. But from Fig. <a href="#S6.F4" title="Figure 4 ‣ VI Conclusion and Future work ‣ PFL-MoE: Personalized Federated Learning Based on Mixture of Experts" class="ltx_ref"><span class="ltx_text ltx_ref_tag">4</span></a><math id="S6.F4.13.m6.1" class="ltx_Math" alttext="(b)" display="inline"><semantics id="S6.F4.13.m6.1b"><mrow id="S6.F4.13.m6.1.2.2"><mo stretchy="false" id="S6.F4.13.m6.1.2.2.1">(</mo><mi id="S6.F4.13.m6.1.1" xref="S6.F4.13.m6.1.1.cmml">b</mi><mo stretchy="false" id="S6.F4.13.m6.1.2.2.2">)</mo></mrow><annotation-xml encoding="MathML-Content" id="S6.F4.13.m6.1c"><ci id="S6.F4.13.m6.1.1.cmml" xref="S6.F4.13.m6.1.1">𝑏</ci></annotation-xml><annotation encoding="application/x-tex" id="S6.F4.13.m6.1d">(b)</annotation></semantics></math>, the extension algorithm FL-MFE works better than PFL-FB.</figcaption>
</figure>
<figure id="S6.F5" class="ltx_figure">
<p id="S6.F5.1" class="ltx_p ltx_align_center ltx_align_center"><span id="S6.F5.1.1" class="ltx_text"><img src="/html/2012.15589/assets/x5.png" id="S6.F5.1.1.g1" class="ltx_graphics ltx_img_square" width="230" height="231" alt="Refer to caption"></span></p>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 5: </span>CIFAR-10 + VGG-16, <math id="S6.F5.5.m1.1" class="ltx_Math" alttext="\alpha=2.0" display="inline"><semantics id="S6.F5.5.m1.1b"><mrow id="S6.F5.5.m1.1.1" xref="S6.F5.5.m1.1.1.cmml"><mi id="S6.F5.5.m1.1.1.2" xref="S6.F5.5.m1.1.1.2.cmml">α</mi><mo id="S6.F5.5.m1.1.1.1" xref="S6.F5.5.m1.1.1.1.cmml">=</mo><mn id="S6.F5.5.m1.1.1.3" xref="S6.F5.5.m1.1.1.3.cmml">2.0</mn></mrow><annotation-xml encoding="MathML-Content" id="S6.F5.5.m1.1c"><apply id="S6.F5.5.m1.1.1.cmml" xref="S6.F5.5.m1.1.1"><eq id="S6.F5.5.m1.1.1.1.cmml" xref="S6.F5.5.m1.1.1.1"></eq><ci id="S6.F5.5.m1.1.1.2.cmml" xref="S6.F5.5.m1.1.1.2">𝛼</ci><cn type="float" id="S6.F5.5.m1.1.1.3.cmml" xref="S6.F5.5.m1.1.1.3">2.0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S6.F5.5.m1.1d">\alpha=2.0</annotation></semantics></math>, 100 clients. Just like Fig. <a href="#S6.F4" title="Figure 4 ‣ VI Conclusion and Future work ‣ PFL-MoE: Personalized Federated Learning Based on Mixture of Experts" class="ltx_ref"><span class="ltx_text ltx_ref_tag">4</span></a>, PFL-MFE shows its advantage on the CIFAR-10 dataset. Comparing Fig. <a href="#S6.F5" title="Figure 5 ‣ VI Conclusion and Future work ‣ PFL-MoE: Personalized Federated Learning Based on Mixture of Experts" class="ltx_ref"><span class="ltx_text ltx_ref_tag">5</span></a><math id="S6.F5.6.m2.1" class="ltx_Math" alttext="(c)" display="inline"><semantics id="S6.F5.6.m2.1b"><mrow id="S6.F5.6.m2.1.2.2"><mo stretchy="false" id="S6.F5.6.m2.1.2.2.1">(</mo><mi id="S6.F5.6.m2.1.1" xref="S6.F5.6.m2.1.1.cmml">c</mi><mo stretchy="false" id="S6.F5.6.m2.1.2.2.2">)</mo></mrow><annotation-xml encoding="MathML-Content" id="S6.F5.6.m2.1c"><ci id="S6.F5.6.m2.1.1.cmml" xref="S6.F5.6.m2.1.1">𝑐</ci></annotation-xml><annotation encoding="application/x-tex" id="S6.F5.6.m2.1d">(c)</annotation></semantics></math> with Fig. <a href="#S6.F5" title="Figure 5 ‣ VI Conclusion and Future work ‣ PFL-MoE: Personalized Federated Learning Based on Mixture of Experts" class="ltx_ref"><span class="ltx_text ltx_ref_tag">5</span></a><math id="S6.F5.7.m3.1" class="ltx_Math" alttext="(d)" display="inline"><semantics id="S6.F5.7.m3.1b"><mrow id="S6.F5.7.m3.1.2.2"><mo stretchy="false" id="S6.F5.7.m3.1.2.2.1">(</mo><mi id="S6.F5.7.m3.1.1" xref="S6.F5.7.m3.1.1.cmml">d</mi><mo stretchy="false" id="S6.F5.7.m3.1.2.2.2">)</mo></mrow><annotation-xml encoding="MathML-Content" id="S6.F5.7.m3.1c"><ci id="S6.F5.7.m3.1.1.cmml" xref="S6.F5.7.m3.1.1">𝑑</ci></annotation-xml><annotation encoding="application/x-tex" id="S6.F5.7.m3.1d">(d)</annotation></semantics></math>, almost all triangles are red, which is also shown in Fig. <a href="#S5.F3" title="Figure 3 ‣ V-B Effect of non-IID ‣ V Experimental Evaluation ‣ PFL-MoE: Personalized Federated Learning Based on Mixture of Experts" class="ltx_ref"><span class="ltx_text ltx_ref_tag">3</span></a> and Fig. <a href="#S6.F4" title="Figure 4 ‣ VI Conclusion and Future work ‣ PFL-MoE: Personalized Federated Learning Based on Mixture of Experts" class="ltx_ref"><span class="ltx_text ltx_ref_tag">4</span></a>, indicating that our algorithms are always superior to PFL-FB in the global test.</figcaption>
</figure>
</section>
<section id="bib" class="ltx_bibliography">
<h2 class="ltx_title ltx_title_bibliography">References</h2>

<ul class="ltx_biblist">
<li id="bib.bib1" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[1]</span>
<span class="ltx_bibblock">
T. Ben-Nun and T. Hoefler, “Demystifying parallel and distributed deep
learning: An in-depth concurrency analysis,” <em id="bib.bib1.1.1" class="ltx_emph ltx_font_italic">ACM Computing Surveys
(CSUR)</em>, vol. 52, no. 4, pp. 1–43, 2019.

</span>
</li>
<li id="bib.bib2" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[2]</span>
<span class="ltx_bibblock">
X. Wang, Y. Han, C. Wang, Q. Zhao, and M. Chen, “In-edge ai: Intelligentizing
mobile edge computing, caching and communication by federated learning,”
<em id="bib.bib2.1.1" class="ltx_emph ltx_font_italic">IEEE Network</em>, vol. PP, no. 99, pp. 1–10, 2019.

</span>
</li>
<li id="bib.bib3" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[3]</span>
<span class="ltx_bibblock">
B. McMahan, D. Ramage, K. Talwar, and L. Zhang, “Learning differentially
private recurrent language models,” in <em id="bib.bib3.1.1" class="ltx_emph ltx_font_italic">International Conference on
Learning Representations (ICLR)</em>, 2018. [Online]. Available:
<a target="_blank" href="https://openreview.net/pdf?id=BJ0hF1Z0b" title="" class="ltx_ref ltx_url ltx_font_typewriter">https://openreview.net/pdf?id=BJ0hF1Z0b</a>

</span>
</li>
<li id="bib.bib4" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[4]</span>
<span class="ltx_bibblock">
T. Yu, E. Bagdasaryan, and V. Shmatikov, “Salvaging federated learning by
local adaptation,” <em id="bib.bib4.1.1" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:2002.04758</em>, 2020.

</span>
</li>
<li id="bib.bib5" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[5]</span>
<span class="ltx_bibblock">
K. Wang, R. Mathews, C. Kiddon, H. Eichner, F. Beaufays, and D. Ramage,
“Federated evaluation of on-device personalization,” <em id="bib.bib5.1.1" class="ltx_emph ltx_font_italic">arXiv preprint
arXiv:1910.10252</em>, 2019.

</span>
</li>
<li id="bib.bib6" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[6]</span>
<span class="ltx_bibblock">
V. Smith, C.-K. Chiang, M. Sanjabi, and A. S. Talwalkar, “Federated multi-task
learning,” in <em id="bib.bib6.1.1" class="ltx_emph ltx_font_italic">Advances in Neural Information Processing Systems</em>,
2017, pp. 4424–4434.

</span>
</li>
<li id="bib.bib7" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[7]</span>
<span class="ltx_bibblock">
D. Li and J. Wang, “Fedmd: Heterogenous federated learning via model
distillation,” <em id="bib.bib7.1.1" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:1910.03581</em>, 2019.

</span>
</li>
<li id="bib.bib8" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[8]</span>
<span class="ltx_bibblock">
D. Peterson, P. Kanani, and V. J. Marathe, “Private federated learning with
domain adaptation,” <em id="bib.bib8.1.1" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:1912.06733</em>, 2019.

</span>
</li>
<li id="bib.bib9" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[9]</span>
<span class="ltx_bibblock">
R. A. Jacobs, M. I. Jordan, S. J. Nowlan, and G. E. Hinton, “Adaptive mixtures
of local experts,” <em id="bib.bib9.1.1" class="ltx_emph ltx_font_italic">Neural computation</em>, vol. 3, no. 1, pp. 79–87,
1991.

</span>
</li>
<li id="bib.bib10" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[10]</span>
<span class="ltx_bibblock">
S. Masoudnia and R. Ebrahimpour, “Mixture of experts: a literature survey,”
<em id="bib.bib10.1.1" class="ltx_emph ltx_font_italic">Artificial Intelligence Review</em>, vol. 42, no. 2, pp. 275–293, 2014.

</span>
</li>
<li id="bib.bib11" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[11]</span>
<span class="ltx_bibblock">
B. McMahan, E. Moore, D. Ramage, S. Hampson, and B. A. y Arcas,
“Communication-efficient learning of deep networks from decentralized
data,” in <em id="bib.bib11.1.1" class="ltx_emph ltx_font_italic">Artificial Intelligence and Statistics</em>.   PMLR, 2017, pp. 1273–1282.

</span>
</li>
<li id="bib.bib12" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[12]</span>
<span class="ltx_bibblock">
J. Konečný, H. B. McMahan, F. X. Yu, P. Richtarik, A. T. Suresh, and
D. Bacon, “Federated learning: Strategies for improving communication
efficiency,” in <em id="bib.bib12.1.1" class="ltx_emph ltx_font_italic">NIPS Workshop on Private Multi-Party Machine
Learning</em>, 2016. [Online]. Available: <a target="_blank" href="https://arxiv.org/abs/1610.05492" title="" class="ltx_ref ltx_url ltx_font_typewriter">https://arxiv.org/abs/1610.05492</a>

</span>
</li>
<li id="bib.bib13" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[13]</span>
<span class="ltx_bibblock">
T. Li, A. K. Sahu, A. Talwalkar, and V. Smith, “Federated learning:
Challenges, methods, and future directions,” <em id="bib.bib13.1.1" class="ltx_emph ltx_font_italic">IEEE Signal Processing
Magazine</em>, vol. 37, no. 3, pp. 50–60, 2020.

</span>
</li>
<li id="bib.bib14" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[14]</span>
<span class="ltx_bibblock">
P. Kairouz, H. B. McMahan, B. Avent, A. Bellet, M. Bennis, A. N. Bhagoji,
K. Bonawitz, Z. Charles, G. Cormode, R. Cummings <em id="bib.bib14.1.1" class="ltx_emph ltx_font_italic">et al.</em>, “Advances
and open problems in federated learning,” <em id="bib.bib14.2.2" class="ltx_emph ltx_font_italic">arXiv preprint
arXiv:1912.04977</em>, 2019.

</span>
</li>
<li id="bib.bib15" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[15]</span>
<span class="ltx_bibblock">
L. Melis, C. Song, E. De Cristofaro, and V. Shmatikov, “Exploiting unintended
feature leakage in collaborative learning,” in <em id="bib.bib15.1.1" class="ltx_emph ltx_font_italic">2019 IEEE Symposium on
Security and Privacy (SP)</em>.   IEEE,
2019, pp. 691–706.

</span>
</li>
<li id="bib.bib16" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[16]</span>
<span class="ltx_bibblock">
L. Lyu, H. Yu, and Q. Yang, “Threats to federated learning: A survey,”
<em id="bib.bib16.1.1" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:2003.02133</em>, 2020.

</span>
</li>
<li id="bib.bib17" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[17]</span>
<span class="ltx_bibblock">
T. Li, A. K. Sahu, M. Zaheer, M. Sanjabi, A. Talwalkar, and V. Smith,
“Federated optimization in heterogeneous networks,” in <em id="bib.bib17.1.1" class="ltx_emph ltx_font_italic">Proceedings of
Machine Learning and Systems 2020, MLSys 2020, Austin, TX, USA, March 2-4,
2020</em>, I. S. Dhillon, D. S. Papailiopoulos, and V. Sze, Eds.   mlsys.org, 2020. [Online]. Available:
<a target="_blank" href="https://proceedings.mlsys.org/book/316.pdf" title="" class="ltx_ref ltx_url ltx_font_typewriter">https://proceedings.mlsys.org/book/316.pdf</a>

</span>
</li>
<li id="bib.bib18" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[18]</span>
<span class="ltx_bibblock">
H. Hsu, H. Qi, and M. Brown, “Measuring the effects of non-identical data
distribution for federated visual classification,” 2019. [Online].
Available: <a target="_blank" href="https://arxiv.org/abs/1909.06335" title="" class="ltx_ref ltx_url ltx_font_typewriter">https://arxiv.org/abs/1909.06335</a>

</span>
</li>
<li id="bib.bib19" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[19]</span>
<span class="ltx_bibblock">
S. Caldas, S. M. K. Duddu, P. Wu, T. Li, J. Konečnỳ, H. B. McMahan,
V. Smith, and A. Talwalkar, “Leaf: A benchmark for federated settings,”
<em id="bib.bib19.1.1" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:1812.01097</em>, 2018.

</span>
</li>
<li id="bib.bib20" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[20]</span>
<span class="ltx_bibblock">
X. Li, K. Huang, W. Yang, S. Wang, and Z. Zhang, “On the convergence of fedavg
on non-iid data,” in <em id="bib.bib20.1.1" class="ltx_emph ltx_font_italic">8th International Conference on Learning
Representations, ICLR 2020, Addis Ababa, Ethiopia, April 26-30,
2020</em>.   OpenReview.net, 2020. [Online].
Available: <a target="_blank" href="https://openreview.net/forum?id=HJxNAnVtDS" title="" class="ltx_ref ltx_url ltx_font_typewriter">https://openreview.net/forum?id=HJxNAnVtDS</a>

</span>
</li>
<li id="bib.bib21" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[21]</span>
<span class="ltx_bibblock">
Y. Zhao, M. Li, L. Lai, N. Suda, D. Civin, and V. Chandra, “Federated learning
with non-iid data,” <em id="bib.bib21.1.1" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:1806.00582</em>, 2018.

</span>
</li>
<li id="bib.bib22" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[22]</span>
<span class="ltx_bibblock">
V. Kulkarni, M. Kulkarni, and A. Pant, “Survey of personalization techniques
for federated learning,” <em id="bib.bib22.1.1" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:2003.08673</em>, 2020.

</span>
</li>
<li id="bib.bib23" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[23]</span>
<span class="ltx_bibblock">
Y. Jiang, J. Konečnỳ, K. Rush, and S. Kannan, “Improving federated
learning personalization via model agnostic meta learning,” <em id="bib.bib23.1.1" class="ltx_emph ltx_font_italic">In
Proceedings of the 34th International Conference on Machine Learning- Volume
70, pp. 1126–1135. JMLR.</em>, 2017.

</span>
</li>
<li id="bib.bib24" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[24]</span>
<span class="ltx_bibblock">
C. Finn, P. Abbeel, and S. Levine, “Model-agnostic meta-learning for fast
adaptation of deep networks,” in <em id="bib.bib24.1.1" class="ltx_emph ltx_font_italic">Proceedings of the 34th International
Conference on Machine Learning, ICML 2017, Sydney, NSW, Australia, 6-11
August 2017</em>, ser. Proceedings of Machine Learning Research, D. Precup and
Y. W. Teh, Eds., vol. 70.   PMLR,
2017, pp. 1126–1135. [Online]. Available:
<a target="_blank" href="http://proceedings.mlr.press/v70/finn17a.html" title="" class="ltx_ref ltx_url ltx_font_typewriter">http://proceedings.mlr.press/v70/finn17a.html</a>

</span>
</li>
<li id="bib.bib25" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[25]</span>
<span class="ltx_bibblock">
C. T Dinh, N. Tran, and T. D. Nguyen, “Personalized federated learning with
moreau envelopes,” <em id="bib.bib25.1.1" class="ltx_emph ltx_font_italic">Advances in Neural Information Processing Systems</em>,
vol. 33, 2020.

</span>
</li>
<li id="bib.bib26" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[26]</span>
<span class="ltx_bibblock">
L. Corinzia and J. M. Buhmann, “Variational federated multi-task learning,”
<em id="bib.bib26.1.1" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:1906.06268</em>, 2019.

</span>
</li>
<li id="bib.bib27" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[27]</span>
<span class="ltx_bibblock">
F. Hanzely and P. Richtárik, “Federated learning of a mixture of global
and local models,” <em id="bib.bib27.1.1" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:2002.05516</em>, 2020.

</span>
</li>
<li id="bib.bib28" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[28]</span>
<span class="ltx_bibblock">
Y. Deng, M. M. Kamani, and M. Mahdavi, “Adaptive personalized federated
learning,” <em id="bib.bib28.1.1" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:2003.13461</em>, 2020.

</span>
</li>
<li id="bib.bib29" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[29]</span>
<span class="ltx_bibblock">
Y. Mansour, M. Mohri, J. Ro, and A. T. Suresh, “Three approaches for
personalization with applications to federated learning,” <em id="bib.bib29.1.1" class="ltx_emph ltx_font_italic">arXiv
preprint arXiv:2002.10619</em>, 2020.

</span>
</li>
<li id="bib.bib30" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[30]</span>
<span class="ltx_bibblock">
H. Xiao, K. Rasul, and R. Vollgraf. (2017) Fashion-mnist: a novel image dataset
for benchmarking machine learning algorithms.

</span>
</li>
<li id="bib.bib31" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[31]</span>
<span class="ltx_bibblock">
A. Krizhevsky, G. Hinton <em id="bib.bib31.1.1" class="ltx_emph ltx_font_italic">et al.</em>, “Learning multiple layers of features
from tiny images,” 2009.

</span>
</li>
<li id="bib.bib32" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[32]</span>
<span class="ltx_bibblock">
Y. LeCun, L. Bottou, Y. Bengio, and P. Haffner, “Gradient-based learning
applied to document recognition,” <em id="bib.bib32.1.1" class="ltx_emph ltx_font_italic">Proceedings of the IEEE</em>, vol. 86,
no. 11, pp. 2278–2324, 1998.

</span>
</li>
<li id="bib.bib33" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[33]</span>
<span class="ltx_bibblock">
K. Simonyan and A. Zisserman, “Very deep convolutional networks for
large-scale image recognition,” <em id="bib.bib33.1.1" class="ltx_emph ltx_font_italic">Computer ence</em>, 2014.

</span>
</li>
</ul>
</section>
</article>
</div>
<div class="ar5iv-footer"><a href="/html/2012.15588" class="ar5iv-nav-button ar5iv-nav-button-prev">◄</a>
    <a class="ar5iv-home-button" href="/"><img height="40" alt="ar5iv homepage" src="/assets/ar5iv.png"></a>
    <a href="/feeling_lucky" class="ar5iv-text-button">Feeling<br>lucky?</a>
    <a href="/log/2012.15589" class="ar5iv-text-button ar5iv-severity-ok">Conversion<br>report</a>
    <a class="ar5iv-text-button" target="_blank" href="https://github.com/dginev/ar5iv/issues/new?template=improve-article--arxiv-id-.md&title=Improve+article+2012.15589">Report<br>an issue</a>
    <a href="https://arxiv.org/abs/2012.15589" class="ar5iv-text-button arxiv-ui-theme">View&nbsp;original<br>on&nbsp;arXiv</a><a href="/html/2012.15590" class="ar5iv-nav-button ar5iv-nav-button-next">►</a>
</div><footer class="ltx_page_footer">
<a class="ar5iv-toggle-color-scheme" href="javascript:toggleColorScheme()" title="Toggle ar5iv color scheme"><span class="color-scheme-icon"></span></a>
<a class="ar5iv-footer-button" href="https://arxiv.org/help/license" target="_blank">Copyright</a>
<a class="ar5iv-footer-button" href="https://arxiv.org/help/policies/privacy_policy" target="_blank">Privacy Policy</a>

<div class="ltx_page_logo">Generated  on Fri Mar  1 14:02:13 2024 by <a target="_blank" href="http://dlmf.nist.gov/LaTeXML/" class="ltx_LaTeXML_logo"><span style="letter-spacing:-0.2em; margin-right:0.1em;">L<span class="ltx_font_smallcaps" style="position:relative; bottom:2.2pt;">a</span>T<span class="ltx_font_smallcaps" style="font-size:120%;position:relative; bottom:-0.2ex;">e</span></span><span style="font-size:90%; position:relative; bottom:-0.2ex;">XML</span><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAsAAAAOCAYAAAD5YeaVAAAAAXNSR0IArs4c6QAAAAZiS0dEAP8A/wD/oL2nkwAAAAlwSFlzAAALEwAACxMBAJqcGAAAAAd0SU1FB9wKExQZLWTEaOUAAAAddEVYdENvbW1lbnQAQ3JlYXRlZCB3aXRoIFRoZSBHSU1Q72QlbgAAAdpJREFUKM9tkL+L2nAARz9fPZNCKFapUn8kyI0e4iRHSR1Kb8ng0lJw6FYHFwv2LwhOpcWxTjeUunYqOmqd6hEoRDhtDWdA8ApRYsSUCDHNt5ul13vz4w0vWCgUnnEc975arX6ORqN3VqtVZbfbTQC4uEHANM3jSqXymFI6yWazP2KxWAXAL9zCUa1Wy2tXVxheKA9YNoR8Pt+aTqe4FVVVvz05O6MBhqUIBGk8Hn8HAOVy+T+XLJfLS4ZhTiRJgqIoVBRFIoric47jPnmeB1mW/9rr9ZpSSn3Lsmir1fJZlqWlUonKsvwWwD8ymc/nXwVBeLjf7xEKhdBut9Hr9WgmkyGEkJwsy5eHG5vN5g0AKIoCAEgkEkin0wQAfN9/cXPdheu6P33fBwB4ngcAcByHJpPJl+fn54mD3Gg0NrquXxeLRQAAwzAYj8cwTZPwPH9/sVg8PXweDAauqqr2cDjEer1GJBLBZDJBs9mE4zjwfZ85lAGg2+06hmGgXq+j3+/DsixYlgVN03a9Xu8jgCNCyIegIAgx13Vfd7vdu+FweG8YRkjXdWy329+dTgeSJD3ieZ7RNO0VAXAPwDEAO5VKndi2fWrb9jWl9Esul6PZbDY9Go1OZ7PZ9z/lyuD3OozU2wAAAABJRU5ErkJggg==" alt="Mascot Sammy"></a>
</div></footer>
</div>

    <script>
      var canMathML = typeof(MathMLElement) == "function";
      if (!canMathML) {
        var body = document.querySelector("body");
        body.firstElementChild.setAttribute('style', 'opacity: 0;');
        var loading = document.createElement("div");
        loading.setAttribute("id", "mathjax-loading-spinner");
        var message = document.createElement("div");
        message.setAttribute("id", "mathjax-loading-message");
        message.innerText = "Typesetting Equations...";
        body.prepend(loading);
        body.prepend(message);

        var el = document.createElement("script");
        el.src = "https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js";
        document.querySelector("head").appendChild(el);

        window.MathJax = {
          startup: {
            pageReady: () => {
              return MathJax.startup.defaultPageReady().then(() => {
                body.removeChild(loading);
                body.removeChild(message);
                body.firstElementChild.removeAttribute('style');
              }); } } };
      }
    </script>
    <script>
    // Auxiliary function, building the preview feature when
    // an inline citation is clicked
    function clicked_cite(e) {
      e.preventDefault();
      let cite = this.closest('.ltx_cite');
      let next = cite.nextSibling;
      if (next && next.nodeType == Node.ELEMENT_NODE && next.getAttribute('class') == "ar5iv-bibitem-preview") {
        next.remove();
        return; }
      // Before adding a preview modal,
      // cleanup older previews, in case they're still open
      document.querySelectorAll('span.ar5iv-bibitem-preview').forEach(function(node) {
        node.remove();
      })

      // Create the preview
      preview = document.createElement('span');
      preview.setAttribute('class','ar5iv-bibitem-preview');
      let target = document.getElementById(this.getAttribute('href').slice(1));
      target.childNodes.forEach(function (child) {
        preview.append(child.cloneNode(true));
      });
      let close_x = document.createElement('button');
      close_x.setAttribute("aria-label","Close modal for bibliography item preview");
      close_x.textContent = "×";
      close_x.setAttribute('class', 'ar5iv-button-close-preview');
      close_x.setAttribute('onclick','this.parentNode.remove()');
      preview.append(close_x);
      preview.querySelectorAll('.ltx_tag_bibitem').forEach(function(node) {
        node.remove();
      });
      cite.parentNode.insertBefore(preview, cite.nextSibling);
      return;
    }
    // Global Document initialization:
    // - assign the preview feature to all inline citation links
    document.querySelectorAll(".ltx_cite .ltx_ref").forEach(function (link) {
      link.addEventListener("click", clicked_cite);
    });
    </script>
    </body>
</html>
