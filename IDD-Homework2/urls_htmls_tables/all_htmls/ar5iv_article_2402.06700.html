<article class="ltx_document ltx_pruned_first">
 <h1 class="ltx_title ltx_title_document">
  Entropy-Regularized Token-Level Policy Optimization
  <br class="ltx_break"/>
  for Large Language Models
 </h1>
 <div class="ltx_authors">
  <span class="ltx_creator ltx_role_author">
   <span class="ltx_personname">
    Muning Wen
   </span>
  </span>
  <span class="ltx_author_before">
  </span>
  <span class="ltx_creator ltx_role_author">
   <span class="ltx_personname">
    Cheng Deng
   </span>
  </span>
  <span class="ltx_author_before">
  </span>
  <span class="ltx_creator ltx_role_author">
   <span class="ltx_personname">
    Jun Wang
   </span>
  </span>
  <span class="ltx_author_before">
  </span>
  <span class="ltx_creator ltx_role_author">
   <span class="ltx_personname">
    Weinan Zhang
   </span>
  </span>
  <span class="ltx_author_before">
  </span>
  <span class="ltx_creator ltx_role_author">
   <span class="ltx_personname">
    Ying Wen
   </span>
  </span>
 </div>
 <div class="ltx_abstract">
  <h6 class="ltx_title ltx_title_abstract">
   Abstract
  </h6>
  <p class="ltx_p" id="id1.id1">
   Large Language Models (LLMs) have shown promise as intelligent agents in interactive decision-making tasks. Traditional approaches often depend on meticulously designed prompts, high-quality examples, or additional reward models for in-context learning, supervised fine-tuning, or RLHF. Reinforcement learning (RL) presents a dynamic alternative for LLMs to overcome these dependencies by engaging directly with task-specific environments. Nonetheless, it faces significant hurdles: 1) instability stemming from the exponentially vast action space requiring exploration; 2) challenges in assigning token-level credit based on action-level reward signals, resulting in discord between maximizing rewards and accurately modeling corpus data. In response to these challenges, we introduce Entropy-Regularized Token-level Policy Optimization (ETPO), an entropy-augmented RL method tailored for optimizing LLMs at the token level. At the heart of ETPO is our novel per-token soft Bellman update, designed to harmonize the RL process with the principles of language modeling. This methodology decomposes the Q-function update from a coarse action-level view to a more granular token-level perspective, backed by theoretical proof of optimization consistency. Crucially, this decomposition renders linear time complexity in action exploration. We assess the effectiveness of ETPO within a simulated environment that models data science code generation as a series of multi-step interactive tasks; results show that ETPO achieves effective performance improvement on the CodeLlama-7B model and surpasses a variant PPO baseline inherited from RLHF. This underlines ETPO’s potential as a robust method for refining the interactive decision-making capabilities of LLMs.
  </p>
 </div>
 <div class="ltx_keywords">
  Machine Learning, ICML
 </div>
 <div class="ltx_para" id="p2">
  <br class="ltx_break"/>
 </div>
 <section class="ltx_section" id="S1">
  <h2 class="ltx_title ltx_title_section">
   <span class="ltx_tag ltx_tag_section">
    1
   </span>
   Introduction
  </h2>
  <div class="ltx_para" id="S1.p1">
   <p class="ltx_p" id="S1.p1.1">
    The capability of large language models (LLMs) to function as intelligent agents has been showcased across various domains, such as mathematical research
    <cite class="ltx_cite ltx_citemacro_citep">
     (Romera-Paredes et al.,
     <a class="ltx_ref" href="#bib.bib33" title="">
      2023
     </a>
     )
    </cite>
    , data science
    <cite class="ltx_cite ltx_citemacro_citep">
     (Hollmann et al.,
     <a class="ltx_ref" href="#bib.bib12" title="">
      2023
     </a>
     )
    </cite>
    , software engineering
    <cite class="ltx_cite ltx_citemacro_citep">
     (Qian et al.,
     <a class="ltx_ref" href="#bib.bib30" title="">
      2023
     </a>
     )
    </cite>
    , and geoscience
    <cite class="ltx_cite ltx_citemacro_citep">
     (Deng et al.,
     <a class="ltx_ref" href="#bib.bib5" title="">
      2023
     </a>
     ; Lin et al.,
     <a class="ltx_ref" href="#bib.bib22" title="">
      2023
     </a>
     )
    </cite>
    . Given these developments, there is an increasing interest in enhancing their functionality in interactive decision-making contexts
    <cite class="ltx_cite ltx_citemacro_citep">
     (Shridhar et al.,
     <a class="ltx_ref" href="#bib.bib38" title="">
      2020
     </a>
     )
    </cite>
    .
Historically, the enhancement of LLMs has relied heavily on the crafting of precise prompts and the provision of high-quality examples for in-context learning or supervised fine-tuning (SFT)
    <cite class="ltx_cite ltx_citemacro_citep">
     (Yao et al.,
     <a class="ltx_ref" href="#bib.bib47" title="">
      2022
     </a>
     ; Shinn et al.,
     <a class="ltx_ref" href="#bib.bib37" title="">
      2023
     </a>
     ; Radford et al.,
     <a class="ltx_ref" href="#bib.bib31" title="">
      2018
     </a>
     )
    </cite>
    Fortunately, employing reinforcement learning (RL)
    <cite class="ltx_cite ltx_citemacro_citep">
     (Sutton &amp; Barto,
     <a class="ltx_ref" href="#bib.bib39" title="">
      2018
     </a>
     )
    </cite>
    offers a dynamic approach for LLMs to actively participate and progressively refine their performance in task-specific environments through a process of exploration and feedback. This shift towards RL allows for a reduction in dependency on manually prepared examples and prompts, paving the way for more autonomous and adaptive learning capabilities in LLMs.
   </p>
  </div>
  <div class="ltx_para" id="S1.p2">
   <p class="ltx_p" id="S1.p2.1">
    Although RL is inherently designed for tackling problems in interactive environments, its direct application
    <cite class="ltx_cite ltx_citemacro_citep">
     (Carta et al.,
     <a class="ltx_ref" href="#bib.bib2" title="">
      2023
     </a>
     ; Ramamurthy et al.,
     <a class="ltx_ref" href="#bib.bib32" title="">
      2022
     </a>
     ; Ouyang et al.,
     <a class="ltx_ref" href="#bib.bib26" title="">
      2022
     </a>
     )
    </cite>
    for fine-tuning language models encounters two significant gaps. The first pertains to a pronounced misalignment in learning objectives. Specifically, while the goal of language modeling is to approximate the probability distribution of tokens in the corpus, RL focuses on the maximization of quantified rewards (which in return has optimal state-action distribution, a.k.a. occupancy measure or policy, with maximized long-term discounted return).
Such a focus, however, predisposes the model to overfitting risks
    <cite class="ltx_cite ltx_citemacro_citep">
     (Zhang et al.,
     <a class="ltx_ref" href="#bib.bib49" title="">
      2018
     </a>
     )
    </cite>
    . This fundamental divergence undermines the preservation of the original token distribution in language models, a critical aspect for maintaining linguistic coherence and diversity
    <cite class="ltx_cite ltx_citemacro_citep">
     (Ziegler et al.,
     <a class="ltx_ref" href="#bib.bib51" title="">
      2019
     </a>
     )
    </cite>
    .
   </p>
  </div>
  <div class="ltx_para" id="S1.p3">
   <p class="ltx_p" id="S1.p3.1">
    The emergence of a second gap is attributed to the variations in optimization granularity. RL typically focuses on optimizing at the action level, whereas language modeling targets optimization at the token level. This discrepancy leads to two primary issues: 1) The action space for LLMs, consisting of sequences of tokens, is exponentially vast, leading to increased instability and convergence difficulties during the RL fine-tuning process
    <cite class="ltx_cite ltx_citemacro_citep">
     (Shinn et al.,
     <a class="ltx_ref" href="#bib.bib37" title="">
      2023
     </a>
     )
    </cite>
    . 2) The reward signals at the action level are overly sparse for sequences of tokens, complicating the provision of precise, fine-grained supervision for complex tasks. This results in obstacles in assigning credit to individual tokens and misalignment between token generation and action performance
    <cite class="ltx_cite ltx_citemacro_citep">
     (Carta et al.,
     <a class="ltx_ref" href="#bib.bib2" title="">
      2023
     </a>
     ; Chen et al.,
     <a class="ltx_ref" href="#bib.bib4" title="">
      2024
     </a>
     )
    </cite>
    .
For instance, RLHF
    <cite class="ltx_cite ltx_citemacro_citep">
     (Ziegler et al.,
     <a class="ltx_ref" href="#bib.bib51" title="">
      2019
     </a>
     )
    </cite>
    seeks to bridge the first gap by integrating a KL divergence term within the reward signal. However, the effectiveness of this approach is heavily dependent on an additional reward model that delivers dense token-level reward signals. Despite this, applying RLHF with action-level rewards still encounters the aforementioned difficulties, which are elaborately analyzed in Section
    <a class="ltx_ref" href="#S5.SS3" title="5.3 Convergence ‣ 5 Experiments ‣ Entropy-Regularized Token-Level Policy Optimization for Large Language Models">
     <span class="ltx_text ltx_ref_tag">
      5.3
     </span>
    </a>
    . Moreover, RLHF conceptualizes token sequences as temporal relations, which hinders its utility in multi-step interactive settings. This limitation stems from a confusion between assigning credit within a single action and across multiple actions.
   </p>
  </div>
  <div class="ltx_para" id="S1.p4">
   <p class="ltx_p" id="S1.p4.1">
    In this paper, we take several steps to bridge these gaps between RL and language modeling.
Initially, to mitigate the risk of the LLM policy diverging excessively during RL fine-tuning, we incorporate interactive tasks within the entropy-regularized reinforcement learning (ERL) framework, which reinterprets the RL problems through the lens of probability theory and constrains the policy update with a given distribution
    <cite class="ltx_cite ltx_citemacro_citep">
     (Schulman et al.,
     <a class="ltx_ref" href="#bib.bib35" title="">
      2017a
     </a>
     ; Levine,
     <a class="ltx_ref" href="#bib.bib20" title="">
      2018
     </a>
     )
    </cite>
    . Thus we can naturally bridge the first gap in learning objectives, i.e. aligning the demand for improving task-specific performance with the objectives of language modeling. Then, to address the second gap concerning optimization granularity, we propose the
    <span class="ltx_text ltx_font_italic" id="S1.p4.1.1">
     per-token soft Bellman update
    </span>
    and
    <span class="ltx_text ltx_font_italic" id="S1.p4.1.2">
     per-token policy update
    </span>
    . They decompose the Q function
    <cite class="ltx_cite ltx_citemacro_citep">
     (Sutton &amp; Barto,
     <a class="ltx_ref" href="#bib.bib39" title="">
      2018
     </a>
     )
    </cite>
    and policy optimization within ERL from the action level to the token level, backed by theoretical proof affirming their consistency in optimization. This decomposition reduces the complexity growth of action space exploration as context length from multiplicative to additive, thus stabilizing the learning process. Besides, it provides fine-grained credit assignment, further ensuring that each token generation is directly correlated with action performance. Unlike RLHF, our method distinctly maintains the separation between intra-action and inter-action credit assignments during token-level policy updates, enhancing its effectiveness in multi-step interactions.
   </p>
  </div>
  <div class="ltx_para" id="S1.p5">
   <p class="ltx_p" id="S1.p5.1">
    As a natural outcome of our findings, we propose
    <span class="ltx_text ltx_font_italic" id="S1.p5.1.1">
     Entropy-regularized Token-level Policy Optimization (ETPO)
    </span>
    , a concrete RL algorithm that leverages the per-token soft Bellman update and policy update to enhance LLM agents’ capabilities within interactive environments. Our experiments confirm the effectiveness of ETPO in narrowing the gaps in both learning objectives and optimization granularity. We justify such a claim by evaluating ETPO in an environment that simulates data science code generation as multi-step interactive tasks; results show that ETPO achieves effective performance improvement on the CodeLlama-7B model
    <cite class="ltx_cite ltx_citemacro_citep">
     (Touvron et al.,
     <a class="ltx_ref" href="#bib.bib42" title="">
      2023
     </a>
     )
    </cite>
    and surpasses a variant PPO
    <cite class="ltx_cite ltx_citemacro_citep">
     (Schulman et al.,
     <a class="ltx_ref" href="#bib.bib36" title="">
      2017b
     </a>
     )
    </cite>
    baseline inherited from RLHF.
   </p>
  </div>
  <figure class="ltx_figure" id="S1.F1">
   <figure class="ltx_float ltx_lstlisting ltx_align_center" id="S1.F1.tab1">
    <div class="ltx_listing ltx_lst_language_diff2 ltx_lstlisting ltx_listing" id="S1.F1.tab1.1">
     <div class="ltx_listing_data">
      <a download="code_iter.txt" href="data:text/plain;base64,IyBFbnZpcm9ubWVudCBTdGVwPTEsIFJld2FyZD0wLjc0NjMKbW9kZWwgPSBSYW5kb21Gb3Jlc3RDbGFzc2lmaWVyKCkKCiMgRW52aXJvbm1lbnQgU3RlcD0xNiwgUmV3YXJkPTAuODcxNgptb2RlbCA9IFBpcGVsaW5lKFsKICAgICgnc2NhbGVyJywgU3RhbmRhcmRTY2FsZXIoKSksIAogICAgKCdsb2dpc3RpY19yZWdyZXNzaW9uJywgTG9naXN0aWNSZWdyZXNzaW9uKCkpXSkKCiMgRW52aXJvbm1lbnQgU3RlcD0yMjQsIFJld2FyZD0wLjg5NjgKcGlwZWxpbmUgPSBQaXBlbGluZShbCiAgICAoJ3NjYWxlcicsIFN0YW5kYXJkU2NhbGVyKCkpLAogICAgKCdtb2RlbCcsIE1MUENsYXNzaWZpZXIoKSldKQoKIyBFbnZpcm9ubWVudCBTdGVwPTQ5NiwgUmV3YXJkPTAuOTI4OQpwaXBlbGluZSA9IFBpcGVsaW5lKFsKICAgICgnc2NhbGVyJywgU3RhbmRhcmRTY2FsZXIoKSksCiAgICAoJ21vZGVsJywgTUxQQ2xhc3NpZmllcigKICAgICAgICBzb2x2ZXI9J2xiZmdzJywgYmF0Y2hfc2l6ZT0xMDAsCiAgICAgICAgLi4uLi4uKSldKQ==">
       ⬇
      </a>
     </div>
     <div class="ltx_listingline" id="lstnumberx1">
      <span class="ltx_text ltx_font_typewriter" id="lstnumberx1.1" style="font-size:80%;">
       #
      </span>
      <span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx1.2" style="font-size:80%;">
      </span>
      <span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx1.3" style="font-size:80%;">
       Environment
      </span>
      <span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx1.4" style="font-size:80%;">
      </span>
      <span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx1.5" style="font-size:80%;">
       Step
      </span>
      <span class="ltx_text ltx_font_typewriter" id="lstnumberx1.6" style="font-size:80%;">
       =1,
      </span>
      <span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx1.7" style="font-size:80%;">
      </span>
      <span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx1.8" style="font-size:80%;">
       Reward
      </span>
      <span class="ltx_text ltx_font_typewriter" id="lstnumberx1.9" style="font-size:80%;">
       =0.7463
      </span>
     </div>
     <div class="ltx_listingline" id="lstnumberx2">
      <span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx2.1" style="font-size:80%;">
       model
      </span>
      <span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx2.2" style="font-size:80%;">
      </span>
      <span class="ltx_text ltx_font_typewriter" id="lstnumberx2.3" style="font-size:80%;">
       =
      </span>
      <span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx2.4" style="font-size:80%;">
      </span>
      <span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx2.5" style="font-size:80%;">
       RandomForestClassifier
      </span>
      <span class="ltx_text ltx_font_typewriter" id="lstnumberx2.6" style="font-size:80%;">
       ()
      </span>
     </div>
     <div class="ltx_listingline" id="lstnumberx3">
     </div>
     <div class="ltx_listingline" id="lstnumberx4">
      <span class="ltx_text ltx_font_typewriter" id="lstnumberx4.1" style="font-size:80%;">
       #
      </span>
      <span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx4.2" style="font-size:80%;">
      </span>
      <span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx4.3" style="font-size:80%;">
       Environment
      </span>
      <span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx4.4" style="font-size:80%;">
      </span>
      <span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx4.5" style="font-size:80%;">
       Step
      </span>
      <span class="ltx_text ltx_font_typewriter" id="lstnumberx4.6" style="font-size:80%;">
       =16,
      </span>
      <span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx4.7" style="font-size:80%;">
      </span>
      <span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx4.8" style="font-size:80%;">
       Reward
      </span>
      <span class="ltx_text ltx_font_typewriter" id="lstnumberx4.9" style="font-size:80%;">
       =0.8716
      </span>
     </div>
     <div class="ltx_listingline" id="lstnumberx5">
      <span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx5.1" style="font-size:80%;">
       model
      </span>
      <span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx5.2" style="font-size:80%;">
      </span>
      <span class="ltx_text ltx_font_typewriter" id="lstnumberx5.3" style="font-size:80%;">
       =
      </span>
      <span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx5.4" style="font-size:80%;">
      </span>
      <span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx5.5" style="font-size:80%;">
       Pipeline
      </span>
      <span class="ltx_text ltx_font_typewriter" id="lstnumberx5.6" style="font-size:80%;">
       ([
      </span>
     </div>
     <div class="ltx_listingline" id="lstnumberx6">
      <span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx6.1" style="font-size:80%;">
      </span>
      <span class="ltx_text ltx_font_typewriter" id="lstnumberx6.2" style="font-size:80%;">
       (’
      </span>
      <span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx6.3" style="font-size:80%;">
       scaler
      </span>
      <span class="ltx_text ltx_font_typewriter" id="lstnumberx6.4" style="font-size:80%;">
       ’,
      </span>
      <span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx6.5" style="font-size:80%;">
      </span>
      <span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx6.6" style="font-size:80%;">
       StandardScaler
      </span>
      <span class="ltx_text ltx_font_typewriter" id="lstnumberx6.7" style="font-size:80%;">
       ()),
      </span>
     </div>
     <div class="ltx_listingline" id="lstnumberx7">
      <span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx7.1" style="font-size:80%;">
      </span>
      <span class="ltx_text ltx_font_typewriter" id="lstnumberx7.2" style="font-size:80%;">
       (’
      </span>
      <span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx7.3" style="font-size:80%;">
       logistic_regression
      </span>
      <span class="ltx_text ltx_font_typewriter" id="lstnumberx7.4" style="font-size:80%;">
       ’,
      </span>
      <span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx7.5" style="font-size:80%;">
      </span>
      <span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx7.6" style="font-size:80%;">
       LogisticRegression
      </span>
      <span class="ltx_text ltx_font_typewriter" id="lstnumberx7.7" style="font-size:80%;">
       ())])
      </span>
     </div>
     <div class="ltx_listingline" id="lstnumberx8">
     </div>
     <div class="ltx_listingline" id="lstnumberx9">
      <span class="ltx_text ltx_font_typewriter" id="lstnumberx9.1" style="font-size:80%;">
       #
      </span>
      <span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx9.2" style="font-size:80%;">
      </span>
      <span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx9.3" style="font-size:80%;">
       Environment
      </span>
      <span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx9.4" style="font-size:80%;">
      </span>
      <span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx9.5" style="font-size:80%;">
       Step
      </span>
      <span class="ltx_text ltx_font_typewriter" id="lstnumberx9.6" style="font-size:80%;">
       =224,
      </span>
      <span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx9.7" style="font-size:80%;">
      </span>
      <span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx9.8" style="font-size:80%;">
       Reward
      </span>
      <span class="ltx_text ltx_font_typewriter" id="lstnumberx9.9" style="font-size:80%;">
       =0.8968
      </span>
     </div>
     <div class="ltx_listingline" id="lstnumberx10">
      <span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx10.1" style="font-size:80%;">
       pipeline
      </span>
      <span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx10.2" style="font-size:80%;">
      </span>
      <span class="ltx_text ltx_font_typewriter" id="lstnumberx10.3" style="font-size:80%;">
       =
      </span>
      <span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx10.4" style="font-size:80%;">
      </span>
      <span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx10.5" style="font-size:80%;">
       Pipeline
      </span>
      <span class="ltx_text ltx_font_typewriter" id="lstnumberx10.6" style="font-size:80%;">
       ([
      </span>
     </div>
     <div class="ltx_listingline" id="lstnumberx11">
      <span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx11.1" style="font-size:80%;">
      </span>
      <span class="ltx_text ltx_font_typewriter" id="lstnumberx11.2" style="font-size:80%;">
       (’
      </span>
      <span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx11.3" style="font-size:80%;">
       scaler
      </span>
      <span class="ltx_text ltx_font_typewriter" id="lstnumberx11.4" style="font-size:80%;">
       ’,
      </span>
      <span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx11.5" style="font-size:80%;">
      </span>
      <span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx11.6" style="font-size:80%;">
       StandardScaler
      </span>
      <span class="ltx_text ltx_font_typewriter" id="lstnumberx11.7" style="font-size:80%;">
       ()),
      </span>
     </div>
     <div class="ltx_listingline" id="lstnumberx12">
      <span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx12.1" style="font-size:80%;">
      </span>
      <span class="ltx_text ltx_font_typewriter" id="lstnumberx12.2" style="font-size:80%;">
       (’
      </span>
      <span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx12.3" style="font-size:80%;">
       model
      </span>
      <span class="ltx_text ltx_font_typewriter" id="lstnumberx12.4" style="font-size:80%;">
       ’,
      </span>
      <span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx12.5" style="font-size:80%;">
      </span>
      <span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx12.6" style="font-size:80%;">
       MLPClassifier
      </span>
      <span class="ltx_text ltx_font_typewriter" id="lstnumberx12.7" style="font-size:80%;">
       ())])
      </span>
     </div>
     <div class="ltx_listingline" id="lstnumberx13">
     </div>
     <div class="ltx_listingline" id="lstnumberx14">
      <span class="ltx_text ltx_font_typewriter" id="lstnumberx14.1" style="font-size:80%;">
       #
      </span>
      <span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx14.2" style="font-size:80%;">
      </span>
      <span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx14.3" style="font-size:80%;">
       Environment
      </span>
      <span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx14.4" style="font-size:80%;">
      </span>
      <span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx14.5" style="font-size:80%;">
       Step
      </span>
      <span class="ltx_text ltx_font_typewriter" id="lstnumberx14.6" style="font-size:80%;">
       =496,
      </span>
      <span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx14.7" style="font-size:80%;">
      </span>
      <span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx14.8" style="font-size:80%;">
       Reward
      </span>
      <span class="ltx_text ltx_font_typewriter" id="lstnumberx14.9" style="font-size:80%;">
       =0.9289
      </span>
     </div>
     <div class="ltx_listingline" id="lstnumberx15">
      <span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx15.1" style="font-size:80%;">
       pipeline
      </span>
      <span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx15.2" style="font-size:80%;">
      </span>
      <span class="ltx_text ltx_font_typewriter" id="lstnumberx15.3" style="font-size:80%;">
       =
      </span>
      <span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx15.4" style="font-size:80%;">
      </span>
      <span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx15.5" style="font-size:80%;">
       Pipeline
      </span>
      <span class="ltx_text ltx_font_typewriter" id="lstnumberx15.6" style="font-size:80%;">
       ([
      </span>
     </div>
     <div class="ltx_listingline" id="lstnumberx16">
      <span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx16.1" style="font-size:80%;">
      </span>
      <span class="ltx_text ltx_font_typewriter" id="lstnumberx16.2" style="font-size:80%;">
       (’
      </span>
      <span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx16.3" style="font-size:80%;">
       scaler
      </span>
      <span class="ltx_text ltx_font_typewriter" id="lstnumberx16.4" style="font-size:80%;">
       ’,
      </span>
      <span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx16.5" style="font-size:80%;">
      </span>
      <span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx16.6" style="font-size:80%;">
       StandardScaler
      </span>
      <span class="ltx_text ltx_font_typewriter" id="lstnumberx16.7" style="font-size:80%;">
       ()),
      </span>
     </div>
     <div class="ltx_listingline" id="lstnumberx17">
      <span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx17.1" style="font-size:80%;">
      </span>
      <span class="ltx_text ltx_font_typewriter" id="lstnumberx17.2" style="font-size:80%;">
       (’
      </span>
      <span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx17.3" style="font-size:80%;">
       model
      </span>
      <span class="ltx_text ltx_font_typewriter" id="lstnumberx17.4" style="font-size:80%;">
       ’,
      </span>
      <span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx17.5" style="font-size:80%;">
      </span>
      <span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx17.6" style="font-size:80%;">
       MLPClassifier
      </span>
      <span class="ltx_text ltx_font_typewriter" id="lstnumberx17.7" style="font-size:80%;">
       (
      </span>
     </div>
     <div class="ltx_listingline" id="lstnumberx18">
      <span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx18.1" style="font-size:80%;">
      </span>
      <span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx18.2" style="font-size:80%;">
       solver
      </span>
      <span class="ltx_text ltx_font_typewriter" id="lstnumberx18.3" style="font-size:80%;">
       =’
      </span>
      <span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx18.4" style="font-size:80%;">
       lbfgs
      </span>
      <span class="ltx_text ltx_font_typewriter" id="lstnumberx18.5" style="font-size:80%;">
       ’,
      </span>
      <span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx18.6" style="font-size:80%;">
      </span>
      <span class="ltx_text ltx_lst_identifier ltx_font_typewriter" id="lstnumberx18.7" style="font-size:80%;">
       batch_size
      </span>
      <span class="ltx_text ltx_font_typewriter" id="lstnumberx18.8" style="font-size:80%;">
       =100,
      </span>
     </div>
     <div class="ltx_listingline" id="lstnumberx19">
      <span class="ltx_text ltx_lst_space ltx_font_typewriter" id="lstnumberx19.1" style="font-size:80%;">
      </span>
      <span class="ltx_text ltx_font_typewriter" id="lstnumberx19.2" style="font-size:80%;">
       ......))])
      </span>
     </div>
    </div>
   </figure>
   <figcaption class="ltx_caption ltx_centering">
    <span class="ltx_tag ltx_tag_figure">
     Figure 1:
    </span>
    Exemplary run of ETPO on the Balance Scale dataset. This figure illustrates the evolution of code generated by CodeLlama-7B during the experiment where the environment step means the number of interactions. We’ve highlighted the positive changes that resulted in performance improvements in each iteration, e.g. finding better models or hyper-parameters. This investigation implies that ETPO can guide models for the emergence of complex yet more effective behaviors.
   </figcaption>
  </figure>
 </section>
 <section class="ltx_section" id="S2">
  <h2 class="ltx_title ltx_title_section">
   <span class="ltx_tag ltx_tag_section">
    2
   </span>
   Related Works
  </h2>
  <section class="ltx_subsection" id="S2.SS1">
   <h3 class="ltx_title ltx_title_subsection">
    <span class="ltx_tag ltx_tag_subsection">
     2.1
    </span>
    LLMs for Interactive Tasks
   </h3>
   <div class="ltx_para" id="S2.SS1.p1">
    <p class="ltx_p" id="S2.SS1.p1.1">
     In many works like Self-Refine
     <cite class="ltx_cite ltx_citemacro_citep">
      (Madaan et al.,
      <a class="ltx_ref" href="#bib.bib23" title="">
       2023
      </a>
      )
     </cite>
     , ReAct, Reflexion, or ProTeGi
     <cite class="ltx_cite ltx_citemacro_citep">
      (Pryzant et al.,
      <a class="ltx_ref" href="#bib.bib29" title="">
       2023
      </a>
      )
     </cite>
     , they ”verbally” tell the model how to iteratively improve the quality of what they generated. Reasoning via Planning (RAP)
     <cite class="ltx_cite ltx_citemacro_citep">
      (Hao et al.,
      <a class="ltx_ref" href="#bib.bib11" title="">
       2023
      </a>
      )
     </cite>
     combines the Monte Carlo Tree Search (MCTS) with LLMs’ self-evaluation mechanism, to balance the exploration and exploitation in the vast reasoning space. Self-Rewarding
     <cite class="ltx_cite ltx_citemacro_citep">
      (Yuan et al.,
      <a class="ltx_ref" href="#bib.bib48" title="">
       2024
      </a>
      )
     </cite>
     allows LLMs to prompt themselves to provide rewards during training.
These works excel in numerous tasks, yet their success hinges on the foundational models possessing robust inherent capabilities
     <cite class="ltx_cite ltx_citemacro_citep">
      (Feng et al.,
      <a class="ltx_ref" href="#bib.bib6" title="">
       2023
      </a>
      )
     </cite>
     .
    </p>
   </div>
   <div class="ltx_para" id="S2.SS1.p2">
    <p class="ltx_p" id="S2.SS1.p2.1">
     RL4LMs
     <cite class="ltx_cite ltx_citemacro_citep">
      (Ramamurthy et al.,
      <a class="ltx_ref" href="#bib.bib32" title="">
       2022
      </a>
      )
     </cite>
     build an open-source framework for optimizing language generators interactively with RL algorithms. CodeRL
     <cite class="ltx_cite ltx_citemacro_citep">
      (Le et al.,
      <a class="ltx_ref" href="#bib.bib19" title="">
       2022
      </a>
      )
     </cite>
     generates code as actions and optimizes in an RL framework using an actor-critic setup to debug programs given feedback from the runtime environment. To align the objective of token-level optimization with action-level optimization, GLAM
     <cite class="ltx_cite ltx_citemacro_citep">
      (Carta et al.,
      <a class="ltx_ref" href="#bib.bib2" title="">
       2023
      </a>
      )
     </cite>
     estimates the probability of possible actions with the conditional probability of tokens composing the actions, and updates the action as a whole with the PPO algorithm.
Nevertheless, the effectiveness of these reinforcement learning-based approaches is constrained by the excessively large action space encountered during exploration and the lack of fine-grained supervision
     <cite class="ltx_cite ltx_citemacro_citep">
      (Shinn et al.,
      <a class="ltx_ref" href="#bib.bib37" title="">
       2023
      </a>
      ; Chen et al.,
      <a class="ltx_ref" href="#bib.bib4" title="">
       2024
      </a>
      )
     </cite>
     .
    </p>
   </div>
  </section>
  <section class="ltx_subsection" id="S2.SS2">
   <h3 class="ltx_title ltx_title_subsection">
    <span class="ltx_tag ltx_tag_subsection">
     2.2
    </span>
    Entropy-Regularized Reinforcement Learning
   </h3>
   <div class="ltx_para" id="S2.SS2.p1">
    <p class="ltx_p" id="S2.SS2.p1.1">
     Entropy-regularized reinforcement learning (ERL) methods
     <cite class="ltx_cite ltx_citemacro_citep">
      (Schulman et al.,
      <a class="ltx_ref" href="#bib.bib35" title="">
       2017a
      </a>
      ; Ziebart,
      <a class="ltx_ref" href="#bib.bib50" title="">
       2010
      </a>
      ; Fox et al.,
      <a class="ltx_ref" href="#bib.bib7" title="">
       2015
      </a>
      ; Haarnoja et al.,
      <a class="ltx_ref" href="#bib.bib8" title="">
       2017
      </a>
      ; Nachum et al.,
      <a class="ltx_ref" href="#bib.bib24" title="">
       2017
      </a>
      )
     </cite>
     are a subset of reinforcement learning that aims to search for the optimal stochastic policy under the constraints of a given distribution. ERL constrains the learned policy from deviating too far from a reference distribution by adding an entropy-regularized term to the reward function and optimizing with soft Bellman update
     <cite class="ltx_cite ltx_citemacro_citep">
      (Schulman et al.,
      <a class="ltx_ref" href="#bib.bib35" title="">
       2017a
      </a>
      )
     </cite>
     . A concrete instance of ERL is the Soft Actor-Critic
     <cite class="ltx_cite ltx_citemacro_citep">
      (Haarnoja et al.,
      <a class="ltx_ref" href="#bib.bib9" title="">
       2018a
      </a>
      ,
      <a class="ltx_ref" href="#bib.bib10" title="">
       b
      </a>
      )
     </cite>
     algorithm, which defines the
     <math alttext="\bar{\pi}" class="ltx_Math" display="inline" id="S2.SS2.p1.1.m1.1">
      <semantics id="S2.SS2.p1.1.m1.1a">
       <mover accent="true" id="S2.SS2.p1.1.m1.1.1" xref="S2.SS2.p1.1.m1.1.1.cmml">
        <mi id="S2.SS2.p1.1.m1.1.1.2" xref="S2.SS2.p1.1.m1.1.1.2.cmml">
         π
        </mi>
        <mo id="S2.SS2.p1.1.m1.1.1.1" xref="S2.SS2.p1.1.m1.1.1.1.cmml">
         ¯
        </mo>
       </mover>
       <annotation-xml encoding="MathML-Content" id="S2.SS2.p1.1.m1.1b">
        <apply id="S2.SS2.p1.1.m1.1.1.cmml" xref="S2.SS2.p1.1.m1.1.1">
         <ci id="S2.SS2.p1.1.m1.1.1.1.cmml" xref="S2.SS2.p1.1.m1.1.1.1">
          ¯
         </ci>
         <ci id="S2.SS2.p1.1.m1.1.1.2.cmml" xref="S2.SS2.p1.1.m1.1.1.2">
          𝜋
         </ci>
        </apply>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="S2.SS2.p1.1.m1.1c">
        \bar{\pi}
       </annotation>
      </semantics>
     </math>
     to be a uniform distribution to balance the trade-off between exploration (entropy maximization) and exploitation (reward maximization). While PPO and some other Actor-Critic methods
     <cite class="ltx_cite ltx_citemacro_citep">
      (Konda &amp; Tsitsiklis,
      <a class="ltx_ref" href="#bib.bib18" title="">
       1999
      </a>
      )
     </cite>
     also encourage exploration by adding an entropy term as a penalty to the loss function, this penalty only takes effect in the current time step. RLHF
     <cite class="ltx_cite ltx_citemacro_citep">
      (Ziegler et al.,
      <a class="ltx_ref" href="#bib.bib51" title="">
       2019
      </a>
      )
     </cite>
     that adopts a variant of PPO with a KL term added to its reward function could also be seen as an approximation to ERL.
    </p>
   </div>
  </section>
 </section>
 <section class="ltx_section" id="S3">
  <h2 class="ltx_title ltx_title_section">
   <span class="ltx_tag ltx_tag_section">
    3
   </span>
   Preliminaries
  </h2>
  <section class="ltx_subsection" id="S3.SS1">
   <h3 class="ltx_title ltx_title_subsection">
    <span class="ltx_tag ltx_tag_subsection">
     3.1
    </span>
    Language-Augmented Sequential Decision-Making
   </h3>
   <div class="ltx_para" id="S3.SS1.p1">
    <p class="ltx_p" id="S3.SS1.p1.8">
     Sequential decision-making problems with linguistic inputs and outputs can be framed as a language-augmented Markov Decision Process (MDP)
     <cite class="ltx_cite ltx_citemacro_citep">
      (Van Otterlo &amp; Wiering,
      <a class="ltx_ref" href="#bib.bib43" title="">
       2012
      </a>
      )
     </cite>
     <math alttext="\mathcal{M}=(\mathcal{V},\mathcal{S},\mathcal{A},\mathcal{T},r,\gamma)" class="ltx_Math" display="inline" id="S3.SS1.p1.1.m1.6">
      <semantics id="S3.SS1.p1.1.m1.6a">
       <mrow id="S3.SS1.p1.1.m1.6.7" xref="S3.SS1.p1.1.m1.6.7.cmml">
        <mi class="ltx_font_mathcaligraphic" id="S3.SS1.p1.1.m1.6.7.2" xref="S3.SS1.p1.1.m1.6.7.2.cmml">
         ℳ
        </mi>
        <mo id="S3.SS1.p1.1.m1.6.7.1" xref="S3.SS1.p1.1.m1.6.7.1.cmml">
         =
        </mo>
        <mrow id="S3.SS1.p1.1.m1.6.7.3.2" xref="S3.SS1.p1.1.m1.6.7.3.1.cmml">
         <mo id="S3.SS1.p1.1.m1.6.7.3.2.1" stretchy="false" xref="S3.SS1.p1.1.m1.6.7.3.1.cmml">
          (
         </mo>
         <mi class="ltx_font_mathcaligraphic" id="S3.SS1.p1.1.m1.1.1" xref="S3.SS1.p1.1.m1.1.1.cmml">
          𝒱
         </mi>
         <mo id="S3.SS1.p1.1.m1.6.7.3.2.2" xref="S3.SS1.p1.1.m1.6.7.3.1.cmml">
          ,
         </mo>
         <mi class="ltx_font_mathcaligraphic" id="S3.SS1.p1.1.m1.2.2" xref="S3.SS1.p1.1.m1.2.2.cmml">
          𝒮
         </mi>
         <mo id="S3.SS1.p1.1.m1.6.7.3.2.3" xref="S3.SS1.p1.1.m1.6.7.3.1.cmml">
          ,
         </mo>
         <mi class="ltx_font_mathcaligraphic" id="S3.SS1.p1.1.m1.3.3" xref="S3.SS1.p1.1.m1.3.3.cmml">
          𝒜
         </mi>
         <mo id="S3.SS1.p1.1.m1.6.7.3.2.4" xref="S3.SS1.p1.1.m1.6.7.3.1.cmml">
          ,
         </mo>
         <mi class="ltx_font_mathcaligraphic" id="S3.SS1.p1.1.m1.4.4" xref="S3.SS1.p1.1.m1.4.4.cmml">
          𝒯
         </mi>
         <mo id="S3.SS1.p1.1.m1.6.7.3.2.5" xref="S3.SS1.p1.1.m1.6.7.3.1.cmml">
          ,
         </mo>
         <mi id="S3.SS1.p1.1.m1.5.5" xref="S3.SS1.p1.1.m1.5.5.cmml">
          r
         </mi>
         <mo id="S3.SS1.p1.1.m1.6.7.3.2.6" xref="S3.SS1.p1.1.m1.6.7.3.1.cmml">
          ,
         </mo>
         <mi id="S3.SS1.p1.1.m1.6.6" xref="S3.SS1.p1.1.m1.6.6.cmml">
          γ
         </mi>
         <mo id="S3.SS1.p1.1.m1.6.7.3.2.7" stretchy="false" xref="S3.SS1.p1.1.m1.6.7.3.1.cmml">
          )
         </mo>
        </mrow>
       </mrow>
       <annotation-xml encoding="MathML-Content" id="S3.SS1.p1.1.m1.6b">
        <apply id="S3.SS1.p1.1.m1.6.7.cmml" xref="S3.SS1.p1.1.m1.6.7">
         <eq id="S3.SS1.p1.1.m1.6.7.1.cmml" xref="S3.SS1.p1.1.m1.6.7.1">
         </eq>
         <ci id="S3.SS1.p1.1.m1.6.7.2.cmml" xref="S3.SS1.p1.1.m1.6.7.2">
          ℳ
         </ci>
         <vector id="S3.SS1.p1.1.m1.6.7.3.1.cmml" xref="S3.SS1.p1.1.m1.6.7.3.2">
          <ci id="S3.SS1.p1.1.m1.1.1.cmml" xref="S3.SS1.p1.1.m1.1.1">
           𝒱
          </ci>
          <ci id="S3.SS1.p1.1.m1.2.2.cmml" xref="S3.SS1.p1.1.m1.2.2">
           𝒮
          </ci>
          <ci id="S3.SS1.p1.1.m1.3.3.cmml" xref="S3.SS1.p1.1.m1.3.3">
           𝒜
          </ci>
          <ci id="S3.SS1.p1.1.m1.4.4.cmml" xref="S3.SS1.p1.1.m1.4.4">
           𝒯
          </ci>
          <ci id="S3.SS1.p1.1.m1.5.5.cmml" xref="S3.SS1.p1.1.m1.5.5">
           𝑟
          </ci>
          <ci id="S3.SS1.p1.1.m1.6.6.cmml" xref="S3.SS1.p1.1.m1.6.6">
           𝛾
          </ci>
         </vector>
        </apply>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="S3.SS1.p1.1.m1.6c">
        \mathcal{M}=(\mathcal{V},\mathcal{S},\mathcal{A},\mathcal{T},r,\gamma)
       </annotation>
      </semantics>
     </math>
     <span class="ltx_note ltx_role_footnote" id="footnote1">
      <sup class="ltx_note_mark">
       1
      </sup>
      <span class="ltx_note_outer">
       <span class="ltx_note_content">
        <sup class="ltx_note_mark">
         1
        </sup>
        <span class="ltx_tag ltx_tag_note">
         1
        </span>
        For notation convenience, we omit the partial observability and thus the observation functions that take a global state as an input and outputs a local observation.
       </span>
      </span>
     </span>
     . Given a vocabulary
     <math alttext="\mathcal{V}" class="ltx_Math" display="inline" id="S3.SS1.p1.2.m2.1">
      <semantics id="S3.SS1.p1.2.m2.1a">
       <mi class="ltx_font_mathcaligraphic" id="S3.SS1.p1.2.m2.1.1" xref="S3.SS1.p1.2.m2.1.1.cmml">
        𝒱
       </mi>
       <annotation-xml encoding="MathML-Content" id="S3.SS1.p1.2.m2.1b">
        <ci id="S3.SS1.p1.2.m2.1.1.cmml" xref="S3.SS1.p1.2.m2.1.1">
         𝒱
        </ci>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="S3.SS1.p1.2.m2.1c">
        \mathcal{V}
       </annotation>
      </semantics>
     </math>
     and tokens
     <math alttext="w\in\mathcal{V}" class="ltx_Math" display="inline" id="S3.SS1.p1.3.m3.1">
      <semantics id="S3.SS1.p1.3.m3.1a">
       <mrow id="S3.SS1.p1.3.m3.1.1" xref="S3.SS1.p1.3.m3.1.1.cmml">
        <mi id="S3.SS1.p1.3.m3.1.1.2" xref="S3.SS1.p1.3.m3.1.1.2.cmml">
         w
        </mi>
        <mo id="S3.SS1.p1.3.m3.1.1.1" xref="S3.SS1.p1.3.m3.1.1.1.cmml">
         ∈
        </mo>
        <mi class="ltx_font_mathcaligraphic" id="S3.SS1.p1.3.m3.1.1.3" xref="S3.SS1.p1.3.m3.1.1.3.cmml">
         𝒱
        </mi>
       </mrow>
       <annotation-xml encoding="MathML-Content" id="S3.SS1.p1.3.m3.1b">
        <apply id="S3.SS1.p1.3.m3.1.1.cmml" xref="S3.SS1.p1.3.m3.1.1">
         <in id="S3.SS1.p1.3.m3.1.1.1.cmml" xref="S3.SS1.p1.3.m3.1.1.1">
         </in>
         <ci id="S3.SS1.p1.3.m3.1.1.2.cmml" xref="S3.SS1.p1.3.m3.1.1.2">
          𝑤
         </ci>
         <ci id="S3.SS1.p1.3.m3.1.1.3.cmml" xref="S3.SS1.p1.3.m3.1.1.3">
          𝒱
         </ci>
        </apply>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="S3.SS1.p1.3.m3.1c">
        w\in\mathcal{V}
       </annotation>
      </semantics>
     </math>
     ,
     <math alttext="\mathcal{S}\subset\mathcal{V}^{N}" class="ltx_Math" display="inline" id="S3.SS1.p1.4.m4.1">
      <semantics id="S3.SS1.p1.4.m4.1a">
       <mrow id="S3.SS1.p1.4.m4.1.1" xref="S3.SS1.p1.4.m4.1.1.cmml">
        <mi class="ltx_font_mathcaligraphic" id="S3.SS1.p1.4.m4.1.1.2" xref="S3.SS1.p1.4.m4.1.1.2.cmml">
         𝒮
        </mi>
        <mo id="S3.SS1.p1.4.m4.1.1.1" xref="S3.SS1.p1.4.m4.1.1.1.cmml">
         ⊂
        </mo>
        <msup id="S3.SS1.p1.4.m4.1.1.3" xref="S3.SS1.p1.4.m4.1.1.3.cmml">
         <mi class="ltx_font_mathcaligraphic" id="S3.SS1.p1.4.m4.1.1.3.2" xref="S3.SS1.p1.4.m4.1.1.3.2.cmml">
          𝒱
         </mi>
         <mi id="S3.SS1.p1.4.m4.1.1.3.3" xref="S3.SS1.p1.4.m4.1.1.3.3.cmml">
          N
         </mi>
        </msup>
       </mrow>
       <annotation-xml encoding="MathML-Content" id="S3.SS1.p1.4.m4.1b">
        <apply id="S3.SS1.p1.4.m4.1.1.cmml" xref="S3.SS1.p1.4.m4.1.1">
         <subset id="S3.SS1.p1.4.m4.1.1.1.cmml" xref="S3.SS1.p1.4.m4.1.1.1">
         </subset>
         <ci id="S3.SS1.p1.4.m4.1.1.2.cmml" xref="S3.SS1.p1.4.m4.1.1.2">
          𝒮
         </ci>
         <apply id="S3.SS1.p1.4.m4.1.1.3.cmml" xref="S3.SS1.p1.4.m4.1.1.3">
          <csymbol cd="ambiguous" id="S3.SS1.p1.4.m4.1.1.3.1.cmml" xref="S3.SS1.p1.4.m4.1.1.3">
           superscript
          </csymbol>
          <ci id="S3.SS1.p1.4.m4.1.1.3.2.cmml" xref="S3.SS1.p1.4.m4.1.1.3.2">
           𝒱
          </ci>
          <ci id="S3.SS1.p1.4.m4.1.1.3.3.cmml" xref="S3.SS1.p1.4.m4.1.1.3.3">
           𝑁
          </ci>
         </apply>
        </apply>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="S3.SS1.p1.4.m4.1c">
        \mathcal{S}\subset\mathcal{V}^{N}
       </annotation>
      </semantics>
     </math>
     ,
     <math alttext="\mathcal{A}\subset\mathcal{V}^{N}" class="ltx_Math" display="inline" id="S3.SS1.p1.5.m5.1">
      <semantics id="S3.SS1.p1.5.m5.1a">
       <mrow id="S3.SS1.p1.5.m5.1.1" xref="S3.SS1.p1.5.m5.1.1.cmml">
        <mi class="ltx_font_mathcaligraphic" id="S3.SS1.p1.5.m5.1.1.2" xref="S3.SS1.p1.5.m5.1.1.2.cmml">
         𝒜
        </mi>
        <mo id="S3.SS1.p1.5.m5.1.1.1" xref="S3.SS1.p1.5.m5.1.1.1.cmml">
         ⊂
        </mo>
        <msup id="S3.SS1.p1.5.m5.1.1.3" xref="S3.SS1.p1.5.m5.1.1.3.cmml">
         <mi class="ltx_font_mathcaligraphic" id="S3.SS1.p1.5.m5.1.1.3.2" xref="S3.SS1.p1.5.m5.1.1.3.2.cmml">
          𝒱
         </mi>
         <mi id="S3.SS1.p1.5.m5.1.1.3.3" xref="S3.SS1.p1.5.m5.1.1.3.3.cmml">
          N
         </mi>
        </msup>
       </mrow>
       <annotation-xml encoding="MathML-Content" id="S3.SS1.p1.5.m5.1b">
        <apply id="S3.SS1.p1.5.m5.1.1.cmml" xref="S3.SS1.p1.5.m5.1.1">
         <subset id="S3.SS1.p1.5.m5.1.1.1.cmml" xref="S3.SS1.p1.5.m5.1.1.1">
         </subset>
         <ci id="S3.SS1.p1.5.m5.1.1.2.cmml" xref="S3.SS1.p1.5.m5.1.1.2">
          𝒜
         </ci>
         <apply id="S3.SS1.p1.5.m5.1.1.3.cmml" xref="S3.SS1.p1.5.m5.1.1.3">
          <csymbol cd="ambiguous" id="S3.SS1.p1.5.m5.1.1.3.1.cmml" xref="S3.SS1.p1.5.m5.1.1.3">
           superscript
          </csymbol>
          <ci id="S3.SS1.p1.5.m5.1.1.3.2.cmml" xref="S3.SS1.p1.5.m5.1.1.3.2">
           𝒱
          </ci>
          <ci id="S3.SS1.p1.5.m5.1.1.3.3.cmml" xref="S3.SS1.p1.5.m5.1.1.3.3">
           𝑁
          </ci>
         </apply>
        </apply>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="S3.SS1.p1.5.m5.1c">
        \mathcal{A}\subset\mathcal{V}^{N}
       </annotation>
      </semantics>
     </math>
     are the state space and action space respectively, which all consist of sequences of tokens.
     <math alttext="\mathcal{T}:\mathcal{S}\times\mathcal{A}\mapsto\mathcal{S}" class="ltx_Math" display="inline" id="S3.SS1.p1.6.m6.1">
      <semantics id="S3.SS1.p1.6.m6.1a">
       <mrow id="S3.SS1.p1.6.m6.1.1" xref="S3.SS1.p1.6.m6.1.1.cmml">
        <mi class="ltx_font_mathcaligraphic" id="S3.SS1.p1.6.m6.1.1.2" xref="S3.SS1.p1.6.m6.1.1.2.cmml">
         𝒯
        </mi>
        <mo id="S3.SS1.p1.6.m6.1.1.1" lspace="0.278em" rspace="0.278em" xref="S3.SS1.p1.6.m6.1.1.1.cmml">
         :
        </mo>
        <mrow id="S3.SS1.p1.6.m6.1.1.3" xref="S3.SS1.p1.6.m6.1.1.3.cmml">
         <mrow id="S3.SS1.p1.6.m6.1.1.3.2" xref="S3.SS1.p1.6.m6.1.1.3.2.cmml">
          <mi class="ltx_font_mathcaligraphic" id="S3.SS1.p1.6.m6.1.1.3.2.2" xref="S3.SS1.p1.6.m6.1.1.3.2.2.cmml">
           𝒮
          </mi>
          <mo id="S3.SS1.p1.6.m6.1.1.3.2.1" lspace="0.222em" rspace="0.222em" xref="S3.SS1.p1.6.m6.1.1.3.2.1.cmml">
           ×
          </mo>
          <mi class="ltx_font_mathcaligraphic" id="S3.SS1.p1.6.m6.1.1.3.2.3" xref="S3.SS1.p1.6.m6.1.1.3.2.3.cmml">
           𝒜
          </mi>
         </mrow>
         <mo id="S3.SS1.p1.6.m6.1.1.3.1" stretchy="false" xref="S3.SS1.p1.6.m6.1.1.3.1.cmml">
          ↦
         </mo>
         <mi class="ltx_font_mathcaligraphic" id="S3.SS1.p1.6.m6.1.1.3.3" xref="S3.SS1.p1.6.m6.1.1.3.3.cmml">
          𝒮
         </mi>
        </mrow>
       </mrow>
       <annotation-xml encoding="MathML-Content" id="S3.SS1.p1.6.m6.1b">
        <apply id="S3.SS1.p1.6.m6.1.1.cmml" xref="S3.SS1.p1.6.m6.1.1">
         <ci id="S3.SS1.p1.6.m6.1.1.1.cmml" xref="S3.SS1.p1.6.m6.1.1.1">
          :
         </ci>
         <ci id="S3.SS1.p1.6.m6.1.1.2.cmml" xref="S3.SS1.p1.6.m6.1.1.2">
          𝒯
         </ci>
         <apply id="S3.SS1.p1.6.m6.1.1.3.cmml" xref="S3.SS1.p1.6.m6.1.1.3">
          <csymbol cd="latexml" id="S3.SS1.p1.6.m6.1.1.3.1.cmml" xref="S3.SS1.p1.6.m6.1.1.3.1">
           maps-to
          </csymbol>
          <apply id="S3.SS1.p1.6.m6.1.1.3.2.cmml" xref="S3.SS1.p1.6.m6.1.1.3.2">
           <times id="S3.SS1.p1.6.m6.1.1.3.2.1.cmml" xref="S3.SS1.p1.6.m6.1.1.3.2.1">
           </times>
           <ci id="S3.SS1.p1.6.m6.1.1.3.2.2.cmml" xref="S3.SS1.p1.6.m6.1.1.3.2.2">
            𝒮
           </ci>
           <ci id="S3.SS1.p1.6.m6.1.1.3.2.3.cmml" xref="S3.SS1.p1.6.m6.1.1.3.2.3">
            𝒜
           </ci>
          </apply>
          <ci id="S3.SS1.p1.6.m6.1.1.3.3.cmml" xref="S3.SS1.p1.6.m6.1.1.3.3">
           𝒮
          </ci>
         </apply>
        </apply>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="S3.SS1.p1.6.m6.1c">
        \mathcal{T}:\mathcal{S}\times\mathcal{A}\mapsto\mathcal{S}
       </annotation>
      </semantics>
     </math>
     is the state transition function.
     <math alttext="r:\mathcal{S}\times\mathcal{A}\mapsto\mathbb{R}" class="ltx_Math" display="inline" id="S3.SS1.p1.7.m7.1">
      <semantics id="S3.SS1.p1.7.m7.1a">
       <mrow id="S3.SS1.p1.7.m7.1.1" xref="S3.SS1.p1.7.m7.1.1.cmml">
        <mi id="S3.SS1.p1.7.m7.1.1.2" xref="S3.SS1.p1.7.m7.1.1.2.cmml">
         r
        </mi>
        <mo id="S3.SS1.p1.7.m7.1.1.1" lspace="0.278em" rspace="0.278em" xref="S3.SS1.p1.7.m7.1.1.1.cmml">
         :
        </mo>
        <mrow id="S3.SS1.p1.7.m7.1.1.3" xref="S3.SS1.p1.7.m7.1.1.3.cmml">
         <mrow id="S3.SS1.p1.7.m7.1.1.3.2" xref="S3.SS1.p1.7.m7.1.1.3.2.cmml">
          <mi class="ltx_font_mathcaligraphic" id="S3.SS1.p1.7.m7.1.1.3.2.2" xref="S3.SS1.p1.7.m7.1.1.3.2.2.cmml">
           𝒮
          </mi>
          <mo id="S3.SS1.p1.7.m7.1.1.3.2.1" lspace="0.222em" rspace="0.222em" xref="S3.SS1.p1.7.m7.1.1.3.2.1.cmml">
           ×
          </mo>
          <mi class="ltx_font_mathcaligraphic" id="S3.SS1.p1.7.m7.1.1.3.2.3" xref="S3.SS1.p1.7.m7.1.1.3.2.3.cmml">
           𝒜
          </mi>
         </mrow>
         <mo id="S3.SS1.p1.7.m7.1.1.3.1" stretchy="false" xref="S3.SS1.p1.7.m7.1.1.3.1.cmml">
          ↦
         </mo>
         <mi id="S3.SS1.p1.7.m7.1.1.3.3" xref="S3.SS1.p1.7.m7.1.1.3.3.cmml">
          ℝ
         </mi>
        </mrow>
       </mrow>
       <annotation-xml encoding="MathML-Content" id="S3.SS1.p1.7.m7.1b">
        <apply id="S3.SS1.p1.7.m7.1.1.cmml" xref="S3.SS1.p1.7.m7.1.1">
         <ci id="S3.SS1.p1.7.m7.1.1.1.cmml" xref="S3.SS1.p1.7.m7.1.1.1">
          :
         </ci>
         <ci id="S3.SS1.p1.7.m7.1.1.2.cmml" xref="S3.SS1.p1.7.m7.1.1.2">
          𝑟
         </ci>
         <apply id="S3.SS1.p1.7.m7.1.1.3.cmml" xref="S3.SS1.p1.7.m7.1.1.3">
          <csymbol cd="latexml" id="S3.SS1.p1.7.m7.1.1.3.1.cmml" xref="S3.SS1.p1.7.m7.1.1.3.1">
           maps-to
          </csymbol>
          <apply id="S3.SS1.p1.7.m7.1.1.3.2.cmml" xref="S3.SS1.p1.7.m7.1.1.3.2">
           <times id="S3.SS1.p1.7.m7.1.1.3.2.1.cmml" xref="S3.SS1.p1.7.m7.1.1.3.2.1">
           </times>
           <ci id="S3.SS1.p1.7.m7.1.1.3.2.2.cmml" xref="S3.SS1.p1.7.m7.1.1.3.2.2">
            𝒮
           </ci>
           <ci id="S3.SS1.p1.7.m7.1.1.3.2.3.cmml" xref="S3.SS1.p1.7.m7.1.1.3.2.3">
            𝒜
           </ci>
          </apply>
          <ci id="S3.SS1.p1.7.m7.1.1.3.3.cmml" xref="S3.SS1.p1.7.m7.1.1.3.3">
           ℝ
          </ci>
         </apply>
        </apply>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="S3.SS1.p1.7.m7.1c">
        r:\mathcal{S}\times\mathcal{A}\mapsto\mathbb{R}
       </annotation>
      </semantics>
     </math>
     is the reward function and
     <math alttext="\gamma" class="ltx_Math" display="inline" id="S3.SS1.p1.8.m8.1">
      <semantics id="S3.SS1.p1.8.m8.1a">
       <mi id="S3.SS1.p1.8.m8.1.1" xref="S3.SS1.p1.8.m8.1.1.cmml">
        γ
       </mi>
       <annotation-xml encoding="MathML-Content" id="S3.SS1.p1.8.m8.1b">
        <ci id="S3.SS1.p1.8.m8.1.1.cmml" xref="S3.SS1.p1.8.m8.1.1">
         𝛾
        </ci>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="S3.SS1.p1.8.m8.1c">
        \gamma
       </annotation>
      </semantics>
     </math>
     is the discounted factor.
    </p>
   </div>
   <div class="ltx_para" id="S3.SS1.p2">
    <p class="ltx_p" id="S3.SS1.p2.11">
     When we introduce an LLM as policy
     <math alttext="\pi" class="ltx_Math" display="inline" id="S3.SS1.p2.1.m1.1">
      <semantics id="S3.SS1.p2.1.m1.1a">
       <mi id="S3.SS1.p2.1.m1.1.1" xref="S3.SS1.p2.1.m1.1.1.cmml">
        π
       </mi>
       <annotation-xml encoding="MathML-Content" id="S3.SS1.p2.1.m1.1b">
        <ci id="S3.SS1.p2.1.m1.1.1.cmml" xref="S3.SS1.p2.1.m1.1.1">
         𝜋
        </ci>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="S3.SS1.p2.1.m1.1c">
        \pi
       </annotation>
      </semantics>
     </math>
     , at time step
     <math alttext="t\in\mathbb{N}" class="ltx_Math" display="inline" id="S3.SS1.p2.2.m2.1">
      <semantics id="S3.SS1.p2.2.m2.1a">
       <mrow id="S3.SS1.p2.2.m2.1.1" xref="S3.SS1.p2.2.m2.1.1.cmml">
        <mi id="S3.SS1.p2.2.m2.1.1.2" xref="S3.SS1.p2.2.m2.1.1.2.cmml">
         t
        </mi>
        <mo id="S3.SS1.p2.2.m2.1.1.1" xref="S3.SS1.p2.2.m2.1.1.1.cmml">
         ∈
        </mo>
        <mi id="S3.SS1.p2.2.m2.1.1.3" xref="S3.SS1.p2.2.m2.1.1.3.cmml">
         ℕ
        </mi>
       </mrow>
       <annotation-xml encoding="MathML-Content" id="S3.SS1.p2.2.m2.1b">
        <apply id="S3.SS1.p2.2.m2.1.1.cmml" xref="S3.SS1.p2.2.m2.1.1">
         <in id="S3.SS1.p2.2.m2.1.1.1.cmml" xref="S3.SS1.p2.2.m2.1.1.1">
         </in>
         <ci id="S3.SS1.p2.2.m2.1.1.2.cmml" xref="S3.SS1.p2.2.m2.1.1.2">
          𝑡
         </ci>
         <ci id="S3.SS1.p2.2.m2.1.1.3.cmml" xref="S3.SS1.p2.2.m2.1.1.3">
          ℕ
         </ci>
        </apply>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="S3.SS1.p2.2.m2.1c">
        t\in\mathbb{N}
       </annotation>
      </semantics>
     </math>
     ,
     <math alttext="\pi" class="ltx_Math" display="inline" id="S3.SS1.p2.3.m3.1">
      <semantics id="S3.SS1.p2.3.m3.1a">
       <mi id="S3.SS1.p2.3.m3.1.1" xref="S3.SS1.p2.3.m3.1.1.cmml">
        π
       </mi>
       <annotation-xml encoding="MathML-Content" id="S3.SS1.p2.3.m3.1b">
        <ci id="S3.SS1.p2.3.m3.1.1.cmml" xref="S3.SS1.p2.3.m3.1.1">
         𝜋
        </ci>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="S3.SS1.p2.3.m3.1c">
        \pi
       </annotation>
      </semantics>
     </math>
     receives a textual state
     <math alttext="s_{t}\in\mathcal{S}" class="ltx_Math" display="inline" id="S3.SS1.p2.4.m4.1">
      <semantics id="S3.SS1.p2.4.m4.1a">
       <mrow id="S3.SS1.p2.4.m4.1.1" xref="S3.SS1.p2.4.m4.1.1.cmml">
        <msub id="S3.SS1.p2.4.m4.1.1.2" xref="S3.SS1.p2.4.m4.1.1.2.cmml">
         <mi id="S3.SS1.p2.4.m4.1.1.2.2" xref="S3.SS1.p2.4.m4.1.1.2.2.cmml">
          s
         </mi>
         <mi id="S3.SS1.p2.4.m4.1.1.2.3" xref="S3.SS1.p2.4.m4.1.1.2.3.cmml">
          t
         </mi>
        </msub>
        <mo id="S3.SS1.p2.4.m4.1.1.1" xref="S3.SS1.p2.4.m4.1.1.1.cmml">
         ∈
        </mo>
        <mi class="ltx_font_mathcaligraphic" id="S3.SS1.p2.4.m4.1.1.3" xref="S3.SS1.p2.4.m4.1.1.3.cmml">
         𝒮
        </mi>
       </mrow>
       <annotation-xml encoding="MathML-Content" id="S3.SS1.p2.4.m4.1b">
        <apply id="S3.SS1.p2.4.m4.1.1.cmml" xref="S3.SS1.p2.4.m4.1.1">
         <in id="S3.SS1.p2.4.m4.1.1.1.cmml" xref="S3.SS1.p2.4.m4.1.1.1">
         </in>
         <apply id="S3.SS1.p2.4.m4.1.1.2.cmml" xref="S3.SS1.p2.4.m4.1.1.2">
          <csymbol cd="ambiguous" id="S3.SS1.p2.4.m4.1.1.2.1.cmml" xref="S3.SS1.p2.4.m4.1.1.2">
           subscript
          </csymbol>
          <ci id="S3.SS1.p2.4.m4.1.1.2.2.cmml" xref="S3.SS1.p2.4.m4.1.1.2.2">
           𝑠
          </ci>
          <ci id="S3.SS1.p2.4.m4.1.1.2.3.cmml" xref="S3.SS1.p2.4.m4.1.1.2.3">
           𝑡
          </ci>
         </apply>
         <ci id="S3.SS1.p2.4.m4.1.1.3.cmml" xref="S3.SS1.p2.4.m4.1.1.3">
          𝒮
         </ci>
        </apply>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="S3.SS1.p2.4.m4.1c">
        s_{t}\in\mathcal{S}
       </annotation>
      </semantics>
     </math>
     from the environment as input and generates an action
     <math alttext="a_{t}\in\mathcal{A}" class="ltx_Math" display="inline" id="S3.SS1.p2.5.m5.1">
      <semantics id="S3.SS1.p2.5.m5.1a">
       <mrow id="S3.SS1.p2.5.m5.1.1" xref="S3.SS1.p2.5.m5.1.1.cmml">
        <msub id="S3.SS1.p2.5.m5.1.1.2" xref="S3.SS1.p2.5.m5.1.1.2.cmml">
         <mi id="S3.SS1.p2.5.m5.1.1.2.2" xref="S3.SS1.p2.5.m5.1.1.2.2.cmml">
          a
         </mi>
         <mi id="S3.SS1.p2.5.m5.1.1.2.3" xref="S3.SS1.p2.5.m5.1.1.2.3.cmml">
          t
         </mi>
        </msub>
        <mo id="S3.SS1.p2.5.m5.1.1.1" xref="S3.SS1.p2.5.m5.1.1.1.cmml">
         ∈
        </mo>
        <mi class="ltx_font_mathcaligraphic" id="S3.SS1.p2.5.m5.1.1.3" xref="S3.SS1.p2.5.m5.1.1.3.cmml">
         𝒜
        </mi>
       </mrow>
       <annotation-xml encoding="MathML-Content" id="S3.SS1.p2.5.m5.1b">
        <apply id="S3.SS1.p2.5.m5.1.1.cmml" xref="S3.SS1.p2.5.m5.1.1">
         <in id="S3.SS1.p2.5.m5.1.1.1.cmml" xref="S3.SS1.p2.5.m5.1.1.1">
         </in>
         <apply id="S3.SS1.p2.5.m5.1.1.2.cmml" xref="S3.SS1.p2.5.m5.1.1.2">
          <csymbol cd="ambiguous" id="S3.SS1.p2.5.m5.1.1.2.1.cmml" xref="S3.SS1.p2.5.m5.1.1.2">
           subscript
          </csymbol>
          <ci id="S3.SS1.p2.5.m5.1.1.2.2.cmml" xref="S3.SS1.p2.5.m5.1.1.2.2">
           𝑎
          </ci>
          <ci id="S3.SS1.p2.5.m5.1.1.2.3.cmml" xref="S3.SS1.p2.5.m5.1.1.2.3">
           𝑡
          </ci>
         </apply>
         <ci id="S3.SS1.p2.5.m5.1.1.3.cmml" xref="S3.SS1.p2.5.m5.1.1.3">
          𝒜
         </ci>
        </apply>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="S3.SS1.p2.5.m5.1c">
        a_{t}\in\mathcal{A}
       </annotation>
      </semantics>
     </math>
     . The action
     <math alttext="a_{t}" class="ltx_Math" display="inline" id="S3.SS1.p2.6.m6.1">
      <semantics id="S3.SS1.p2.6.m6.1a">
       <msub id="S3.SS1.p2.6.m6.1.1" xref="S3.SS1.p2.6.m6.1.1.cmml">
        <mi id="S3.SS1.p2.6.m6.1.1.2" xref="S3.SS1.p2.6.m6.1.1.2.cmml">
         a
        </mi>
        <mi id="S3.SS1.p2.6.m6.1.1.3" xref="S3.SS1.p2.6.m6.1.1.3.cmml">
         t
        </mi>
       </msub>
       <annotation-xml encoding="MathML-Content" id="S3.SS1.p2.6.m6.1b">
        <apply id="S3.SS1.p2.6.m6.1.1.cmml" xref="S3.SS1.p2.6.m6.1.1">
         <csymbol cd="ambiguous" id="S3.SS1.p2.6.m6.1.1.1.cmml" xref="S3.SS1.p2.6.m6.1.1">
          subscript
         </csymbol>
         <ci id="S3.SS1.p2.6.m6.1.1.2.cmml" xref="S3.SS1.p2.6.m6.1.1.2">
          𝑎
         </ci>
         <ci id="S3.SS1.p2.6.m6.1.1.3.cmml" xref="S3.SS1.p2.6.m6.1.1.3">
          𝑡
         </ci>
        </apply>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="S3.SS1.p2.6.m6.1c">
        a_{t}
       </annotation>
      </semantics>
     </math>
     is normally a sentence or phrase that consists of a sequence of token
     <math alttext="a_{t}=(w_{t}^{1},\dots,w_{t}^{|a_{t}|})" class="ltx_Math" display="inline" id="S3.SS1.p2.7.m7.4">
      <semantics id="S3.SS1.p2.7.m7.4a">
       <mrow id="S3.SS1.p2.7.m7.4.4" xref="S3.SS1.p2.7.m7.4.4.cmml">
        <msub id="S3.SS1.p2.7.m7.4.4.4" xref="S3.SS1.p2.7.m7.4.4.4.cmml">
         <mi id="S3.SS1.p2.7.m7.4.4.4.2" xref="S3.SS1.p2.7.m7.4.4.4.2.cmml">
          a
         </mi>
         <mi id="S3.SS1.p2.7.m7.4.4.4.3" xref="S3.SS1.p2.7.m7.4.4.4.3.cmml">
          t
         </mi>
        </msub>
        <mo id="S3.SS1.p2.7.m7.4.4.3" xref="S3.SS1.p2.7.m7.4.4.3.cmml">
         =
        </mo>
        <mrow id="S3.SS1.p2.7.m7.4.4.2.2" xref="S3.SS1.p2.7.m7.4.4.2.3.cmml">
         <mo id="S3.SS1.p2.7.m7.4.4.2.2.3" stretchy="false" xref="S3.SS1.p2.7.m7.4.4.2.3.cmml">
          (
         </mo>
         <msubsup id="S3.SS1.p2.7.m7.3.3.1.1.1" xref="S3.SS1.p2.7.m7.3.3.1.1.1.cmml">
          <mi id="S3.SS1.p2.7.m7.3.3.1.1.1.2.2" xref="S3.SS1.p2.7.m7.3.3.1.1.1.2.2.cmml">
           w
          </mi>
          <mi id="S3.SS1.p2.7.m7.3.3.1.1.1.2.3" xref="S3.SS1.p2.7.m7.3.3.1.1.1.2.3.cmml">
           t
          </mi>
          <mn id="S3.SS1.p2.7.m7.3.3.1.1.1.3" xref="S3.SS1.p2.7.m7.3.3.1.1.1.3.cmml">
           1
          </mn>
         </msubsup>
         <mo id="S3.SS1.p2.7.m7.4.4.2.2.4" xref="S3.SS1.p2.7.m7.4.4.2.3.cmml">
          ,
         </mo>
         <mi id="S3.SS1.p2.7.m7.2.2" mathvariant="normal" xref="S3.SS1.p2.7.m7.2.2.cmml">
          …
         </mi>
         <mo id="S3.SS1.p2.7.m7.4.4.2.2.5" xref="S3.SS1.p2.7.m7.4.4.2.3.cmml">
          ,
         </mo>
         <msubsup id="S3.SS1.p2.7.m7.4.4.2.2.2" xref="S3.SS1.p2.7.m7.4.4.2.2.2.cmml">
          <mi id="S3.SS1.p2.7.m7.4.4.2.2.2.2.2" xref="S3.SS1.p2.7.m7.4.4.2.2.2.2.2.cmml">
           w
          </mi>
          <mi id="S3.SS1.p2.7.m7.4.4.2.2.2.2.3" xref="S3.SS1.p2.7.m7.4.4.2.2.2.2.3.cmml">
           t
          </mi>
          <mrow id="S3.SS1.p2.7.m7.1.1.1.1" xref="S3.SS1.p2.7.m7.1.1.1.2.cmml">
           <mo id="S3.SS1.p2.7.m7.1.1.1.1.2" stretchy="false" xref="S3.SS1.p2.7.m7.1.1.1.2.1.cmml">
            |
           </mo>
           <msub id="S3.SS1.p2.7.m7.1.1.1.1.1" xref="S3.SS1.p2.7.m7.1.1.1.1.1.cmml">
            <mi id="S3.SS1.p2.7.m7.1.1.1.1.1.2" xref="S3.SS1.p2.7.m7.1.1.1.1.1.2.cmml">
             a
            </mi>
            <mi id="S3.SS1.p2.7.m7.1.1.1.1.1.3" xref="S3.SS1.p2.7.m7.1.1.1.1.1.3.cmml">
             t
            </mi>
           </msub>
           <mo id="S3.SS1.p2.7.m7.1.1.1.1.3" stretchy="false" xref="S3.SS1.p2.7.m7.1.1.1.2.1.cmml">
            |
           </mo>
          </mrow>
         </msubsup>
         <mo id="S3.SS1.p2.7.m7.4.4.2.2.6" stretchy="false" xref="S3.SS1.p2.7.m7.4.4.2.3.cmml">
          )
         </mo>
        </mrow>
       </mrow>
       <annotation-xml encoding="MathML-Content" id="S3.SS1.p2.7.m7.4b">
        <apply id="S3.SS1.p2.7.m7.4.4.cmml" xref="S3.SS1.p2.7.m7.4.4">
         <eq id="S3.SS1.p2.7.m7.4.4.3.cmml" xref="S3.SS1.p2.7.m7.4.4.3">
         </eq>
         <apply id="S3.SS1.p2.7.m7.4.4.4.cmml" xref="S3.SS1.p2.7.m7.4.4.4">
          <csymbol cd="ambiguous" id="S3.SS1.p2.7.m7.4.4.4.1.cmml" xref="S3.SS1.p2.7.m7.4.4.4">
           subscript
          </csymbol>
          <ci id="S3.SS1.p2.7.m7.4.4.4.2.cmml" xref="S3.SS1.p2.7.m7.4.4.4.2">
           𝑎
          </ci>
          <ci id="S3.SS1.p2.7.m7.4.4.4.3.cmml" xref="S3.SS1.p2.7.m7.4.4.4.3">
           𝑡
          </ci>
         </apply>
         <vector id="S3.SS1.p2.7.m7.4.4.2.3.cmml" xref="S3.SS1.p2.7.m7.4.4.2.2">
          <apply id="S3.SS1.p2.7.m7.3.3.1.1.1.cmml" xref="S3.SS1.p2.7.m7.3.3.1.1.1">
           <csymbol cd="ambiguous" id="S3.SS1.p2.7.m7.3.3.1.1.1.1.cmml" xref="S3.SS1.p2.7.m7.3.3.1.1.1">
            superscript
           </csymbol>
           <apply id="S3.SS1.p2.7.m7.3.3.1.1.1.2.cmml" xref="S3.SS1.p2.7.m7.3.3.1.1.1">
            <csymbol cd="ambiguous" id="S3.SS1.p2.7.m7.3.3.1.1.1.2.1.cmml" xref="S3.SS1.p2.7.m7.3.3.1.1.1">
             subscript
            </csymbol>
            <ci id="S3.SS1.p2.7.m7.3.3.1.1.1.2.2.cmml" xref="S3.SS1.p2.7.m7.3.3.1.1.1.2.2">
             𝑤
            </ci>
            <ci id="S3.SS1.p2.7.m7.3.3.1.1.1.2.3.cmml" xref="S3.SS1.p2.7.m7.3.3.1.1.1.2.3">
             𝑡
            </ci>
           </apply>
           <cn id="S3.SS1.p2.7.m7.3.3.1.1.1.3.cmml" type="integer" xref="S3.SS1.p2.7.m7.3.3.1.1.1.3">
            1
           </cn>
          </apply>
          <ci id="S3.SS1.p2.7.m7.2.2.cmml" xref="S3.SS1.p2.7.m7.2.2">
           …
          </ci>
          <apply id="S3.SS1.p2.7.m7.4.4.2.2.2.cmml" xref="S3.SS1.p2.7.m7.4.4.2.2.2">
           <csymbol cd="ambiguous" id="S3.SS1.p2.7.m7.4.4.2.2.2.1.cmml" xref="S3.SS1.p2.7.m7.4.4.2.2.2">
            superscript
           </csymbol>
           <apply id="S3.SS1.p2.7.m7.4.4.2.2.2.2.cmml" xref="S3.SS1.p2.7.m7.4.4.2.2.2">
            <csymbol cd="ambiguous" id="S3.SS1.p2.7.m7.4.4.2.2.2.2.1.cmml" xref="S3.SS1.p2.7.m7.4.4.2.2.2">
             subscript
            </csymbol>
            <ci id="S3.SS1.p2.7.m7.4.4.2.2.2.2.2.cmml" xref="S3.SS1.p2.7.m7.4.4.2.2.2.2.2">
             𝑤
            </ci>
            <ci id="S3.SS1.p2.7.m7.4.4.2.2.2.2.3.cmml" xref="S3.SS1.p2.7.m7.4.4.2.2.2.2.3">
             𝑡
            </ci>
           </apply>
           <apply id="S3.SS1.p2.7.m7.1.1.1.2.cmml" xref="S3.SS1.p2.7.m7.1.1.1.1">
            <abs id="S3.SS1.p2.7.m7.1.1.1.2.1.cmml" xref="S3.SS1.p2.7.m7.1.1.1.1.2">
            </abs>
            <apply id="S3.SS1.p2.7.m7.1.1.1.1.1.cmml" xref="S3.SS1.p2.7.m7.1.1.1.1.1">
             <csymbol cd="ambiguous" id="S3.SS1.p2.7.m7.1.1.1.1.1.1.cmml" xref="S3.SS1.p2.7.m7.1.1.1.1.1">
              subscript
             </csymbol>
             <ci id="S3.SS1.p2.7.m7.1.1.1.1.1.2.cmml" xref="S3.SS1.p2.7.m7.1.1.1.1.1.2">
              𝑎
             </ci>
             <ci id="S3.SS1.p2.7.m7.1.1.1.1.1.3.cmml" xref="S3.SS1.p2.7.m7.1.1.1.1.1.3">
              𝑡
             </ci>
            </apply>
           </apply>
          </apply>
         </vector>
        </apply>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="S3.SS1.p2.7.m7.4c">
        a_{t}=(w_{t}^{1},\dots,w_{t}^{|a_{t}|})
       </annotation>
      </semantics>
     </math>
     and generated in an auto-regressive manner token-by-token. Then, the generated textual action
     <math alttext="a_{t}" class="ltx_Math" display="inline" id="S3.SS1.p2.8.m8.1">
      <semantics id="S3.SS1.p2.8.m8.1a">
       <msub id="S3.SS1.p2.8.m8.1.1" xref="S3.SS1.p2.8.m8.1.1.cmml">
        <mi id="S3.SS1.p2.8.m8.1.1.2" xref="S3.SS1.p2.8.m8.1.1.2.cmml">
         a
        </mi>
        <mi id="S3.SS1.p2.8.m8.1.1.3" xref="S3.SS1.p2.8.m8.1.1.3.cmml">
         t
        </mi>
       </msub>
       <annotation-xml encoding="MathML-Content" id="S3.SS1.p2.8.m8.1b">
        <apply id="S3.SS1.p2.8.m8.1.1.cmml" xref="S3.SS1.p2.8.m8.1.1">
         <csymbol cd="ambiguous" id="S3.SS1.p2.8.m8.1.1.1.cmml" xref="S3.SS1.p2.8.m8.1.1">
          subscript
         </csymbol>
         <ci id="S3.SS1.p2.8.m8.1.1.2.cmml" xref="S3.SS1.p2.8.m8.1.1.2">
          𝑎
         </ci>
         <ci id="S3.SS1.p2.8.m8.1.1.3.cmml" xref="S3.SS1.p2.8.m8.1.1.3">
          𝑡
         </ci>
        </apply>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="S3.SS1.p2.8.m8.1c">
        a_{t}
       </annotation>
      </semantics>
     </math>
     will be mapped to the specific API call or command and executed in an interactive environment
     <cite class="ltx_cite ltx_citemacro_citep">
      (Schick et al.,
      <a class="ltx_ref" href="#bib.bib34" title="">
       2023
      </a>
      )
     </cite>
     . After execution, the environment returns a reward signal
     <math alttext="r(s_{t},a_{t})" class="ltx_Math" display="inline" id="S3.SS1.p2.9.m9.2">
      <semantics id="S3.SS1.p2.9.m9.2a">
       <mrow id="S3.SS1.p2.9.m9.2.2" xref="S3.SS1.p2.9.m9.2.2.cmml">
        <mi id="S3.SS1.p2.9.m9.2.2.4" xref="S3.SS1.p2.9.m9.2.2.4.cmml">
         r
        </mi>
        <mo id="S3.SS1.p2.9.m9.2.2.3" lspace="0em" rspace="0em" xref="S3.SS1.p2.9.m9.2.2.3.cmml">
         ​
        </mo>
        <mrow id="S3.SS1.p2.9.m9.2.2.2.2" xref="S3.SS1.p2.9.m9.2.2.2.3.cmml">
         <mo id="S3.SS1.p2.9.m9.2.2.2.2.3" stretchy="false" xref="S3.SS1.p2.9.m9.2.2.2.3.cmml">
          (
         </mo>
         <msub id="S3.SS1.p2.9.m9.1.1.1.1.1" xref="S3.SS1.p2.9.m9.1.1.1.1.1.cmml">
          <mi id="S3.SS1.p2.9.m9.1.1.1.1.1.2" xref="S3.SS1.p2.9.m9.1.1.1.1.1.2.cmml">
           s
          </mi>
          <mi id="S3.SS1.p2.9.m9.1.1.1.1.1.3" xref="S3.SS1.p2.9.m9.1.1.1.1.1.3.cmml">
           t
          </mi>
         </msub>
         <mo id="S3.SS1.p2.9.m9.2.2.2.2.4" xref="S3.SS1.p2.9.m9.2.2.2.3.cmml">
          ,
         </mo>
         <msub id="S3.SS1.p2.9.m9.2.2.2.2.2" xref="S3.SS1.p2.9.m9.2.2.2.2.2.cmml">
          <mi id="S3.SS1.p2.9.m9.2.2.2.2.2.2" xref="S3.SS1.p2.9.m9.2.2.2.2.2.2.cmml">
           a
          </mi>
          <mi id="S3.SS1.p2.9.m9.2.2.2.2.2.3" xref="S3.SS1.p2.9.m9.2.2.2.2.2.3.cmml">
           t
          </mi>
         </msub>
         <mo id="S3.SS1.p2.9.m9.2.2.2.2.5" stretchy="false" xref="S3.SS1.p2.9.m9.2.2.2.3.cmml">
          )
         </mo>
        </mrow>
       </mrow>
       <annotation-xml encoding="MathML-Content" id="S3.SS1.p2.9.m9.2b">
        <apply id="S3.SS1.p2.9.m9.2.2.cmml" xref="S3.SS1.p2.9.m9.2.2">
         <times id="S3.SS1.p2.9.m9.2.2.3.cmml" xref="S3.SS1.p2.9.m9.2.2.3">
         </times>
         <ci id="S3.SS1.p2.9.m9.2.2.4.cmml" xref="S3.SS1.p2.9.m9.2.2.4">
          𝑟
         </ci>
         <interval closure="open" id="S3.SS1.p2.9.m9.2.2.2.3.cmml" xref="S3.SS1.p2.9.m9.2.2.2.2">
          <apply id="S3.SS1.p2.9.m9.1.1.1.1.1.cmml" xref="S3.SS1.p2.9.m9.1.1.1.1.1">
           <csymbol cd="ambiguous" id="S3.SS1.p2.9.m9.1.1.1.1.1.1.cmml" xref="S3.SS1.p2.9.m9.1.1.1.1.1">
            subscript
           </csymbol>
           <ci id="S3.SS1.p2.9.m9.1.1.1.1.1.2.cmml" xref="S3.SS1.p2.9.m9.1.1.1.1.1.2">
            𝑠
           </ci>
           <ci id="S3.SS1.p2.9.m9.1.1.1.1.1.3.cmml" xref="S3.SS1.p2.9.m9.1.1.1.1.1.3">
            𝑡
           </ci>
          </apply>
          <apply id="S3.SS1.p2.9.m9.2.2.2.2.2.cmml" xref="S3.SS1.p2.9.m9.2.2.2.2.2">
           <csymbol cd="ambiguous" id="S3.SS1.p2.9.m9.2.2.2.2.2.1.cmml" xref="S3.SS1.p2.9.m9.2.2.2.2.2">
            subscript
           </csymbol>
           <ci id="S3.SS1.p2.9.m9.2.2.2.2.2.2.cmml" xref="S3.SS1.p2.9.m9.2.2.2.2.2.2">
            𝑎
           </ci>
           <ci id="S3.SS1.p2.9.m9.2.2.2.2.2.3.cmml" xref="S3.SS1.p2.9.m9.2.2.2.2.2.3">
            𝑡
           </ci>
          </apply>
         </interval>
        </apply>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="S3.SS1.p2.9.m9.2c">
        r(s_{t},a_{t})
       </annotation>
      </semantics>
     </math>
     along with the next state
     <math alttext="s_{t+1}" class="ltx_Math" display="inline" id="S3.SS1.p2.10.m10.1">
      <semantics id="S3.SS1.p2.10.m10.1a">
       <msub id="S3.SS1.p2.10.m10.1.1" xref="S3.SS1.p2.10.m10.1.1.cmml">
        <mi id="S3.SS1.p2.10.m10.1.1.2" xref="S3.SS1.p2.10.m10.1.1.2.cmml">
         s
        </mi>
        <mrow id="S3.SS1.p2.10.m10.1.1.3" xref="S3.SS1.p2.10.m10.1.1.3.cmml">
         <mi id="S3.SS1.p2.10.m10.1.1.3.2" xref="S3.SS1.p2.10.m10.1.1.3.2.cmml">
          t
         </mi>
         <mo id="S3.SS1.p2.10.m10.1.1.3.1" xref="S3.SS1.p2.10.m10.1.1.3.1.cmml">
          +
         </mo>
         <mn id="S3.SS1.p2.10.m10.1.1.3.3" xref="S3.SS1.p2.10.m10.1.1.3.3.cmml">
          1
         </mn>
        </mrow>
       </msub>
       <annotation-xml encoding="MathML-Content" id="S3.SS1.p2.10.m10.1b">
        <apply id="S3.SS1.p2.10.m10.1.1.cmml" xref="S3.SS1.p2.10.m10.1.1">
         <csymbol cd="ambiguous" id="S3.SS1.p2.10.m10.1.1.1.cmml" xref="S3.SS1.p2.10.m10.1.1">
          subscript
         </csymbol>
         <ci id="S3.SS1.p2.10.m10.1.1.2.cmml" xref="S3.SS1.p2.10.m10.1.1.2">
          𝑠
         </ci>
         <apply id="S3.SS1.p2.10.m10.1.1.3.cmml" xref="S3.SS1.p2.10.m10.1.1.3">
          <plus id="S3.SS1.p2.10.m10.1.1.3.1.cmml" xref="S3.SS1.p2.10.m10.1.1.3.1">
          </plus>
          <ci id="S3.SS1.p2.10.m10.1.1.3.2.cmml" xref="S3.SS1.p2.10.m10.1.1.3.2">
           𝑡
          </ci>
          <cn id="S3.SS1.p2.10.m10.1.1.3.3.cmml" type="integer" xref="S3.SS1.p2.10.m10.1.1.3.3">
           1
          </cn>
         </apply>
        </apply>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="S3.SS1.p2.10.m10.1c">
        s_{t+1}
       </annotation>
      </semantics>
     </math>
     , according to the transition
     <math alttext="\mathcal{T}" class="ltx_Math" display="inline" id="S3.SS1.p2.11.m11.1">
      <semantics id="S3.SS1.p2.11.m11.1a">
       <mi class="ltx_font_mathcaligraphic" id="S3.SS1.p2.11.m11.1.1" xref="S3.SS1.p2.11.m11.1.1.cmml">
        𝒯
       </mi>
       <annotation-xml encoding="MathML-Content" id="S3.SS1.p2.11.m11.1b">
        <ci id="S3.SS1.p2.11.m11.1.1.cmml" xref="S3.SS1.p2.11.m11.1.1">
         𝒯
        </ci>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="S3.SS1.p2.11.m11.1c">
        \mathcal{T}
       </annotation>
      </semantics>
     </math>
     .
    </p>
   </div>
  </section>
  <section class="ltx_subsection" id="S3.SS2">
   <h3 class="ltx_title ltx_title_subsection">
    <span class="ltx_tag ltx_tag_subsection">
     3.2
    </span>
    Entropy-Regularized Reinforcement Learning
   </h3>
   <div class="ltx_para" id="S3.SS2.p1">
    <p class="ltx_p" id="S3.SS2.p1.1">
     One gap between RL and language modeling is that they hold different learning objectives. While LLMs aim to model the probability distribution of tokens within a corpus
     <cite class="ltx_cite ltx_citemacro_citep">
      (Koller &amp; Friedman,
      <a class="ltx_ref" href="#bib.bib17" title="">
       2009
      </a>
      )
     </cite>
     , traditional RL focuses on maximizing the discounted cumulative return:
    </p>
    <table class="ltx_equationgroup ltx_eqn_align ltx_eqn_table" id="A7.EGx1">
     <tbody id="S3.E1">
      <tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
       <td class="ltx_eqn_cell ltx_eqn_center_padleft">
       </td>
       <td class="ltx_td ltx_align_right ltx_eqn_cell">
        <math alttext="\displaystyle\mathcal{G}^{\prime}(\pi)=\mathbb{E}_{a\sim\pi}\Big{[}\sum_{t=0}^{\infty}\gamma^{t}(r(s_{t},a_{t})\Big{]}," class="ltx_math_unparsed" display="inline" id="S3.E1.m1.1">
         <semantics id="S3.E1.m1.1a">
          <mrow id="S3.E1.m1.1b">
           <msup id="S3.E1.m1.1.2">
            <mi class="ltx_font_mathcaligraphic" id="S3.E1.m1.1.2.2">
             𝒢
            </mi>
            <mo id="S3.E1.m1.1.2.3">
             ′
            </mo>
           </msup>
           <mrow id="S3.E1.m1.1.3">
            <mo id="S3.E1.m1.1.3.1" stretchy="false">
             (
            </mo>
            <mi id="S3.E1.m1.1.1">
             π
            </mi>
            <mo id="S3.E1.m1.1.3.2" stretchy="false">
             )
            </mo>
           </mrow>
           <mo id="S3.E1.m1.1.4">
            =
           </mo>
           <msub id="S3.E1.m1.1.5">
            <mi id="S3.E1.m1.1.5.2">
             𝔼
            </mi>
            <mrow id="S3.E1.m1.1.5.3">
             <mi id="S3.E1.m1.1.5.3.2">
              a
             </mi>
             <mo id="S3.E1.m1.1.5.3.1">
              ∼
             </mo>
             <mi id="S3.E1.m1.1.5.3.3">
              π
             </mi>
            </mrow>
           </msub>
           <mrow id="S3.E1.m1.1.6">
            <mo id="S3.E1.m1.1.6.1" maxsize="160%" minsize="160%">
             [
            </mo>
            <mstyle displaystyle="true" id="S3.E1.m1.1.6.2">
             <munderover id="S3.E1.m1.1.6.2a">
              <mo id="S3.E1.m1.1.6.2.2.2" movablelimits="false">
               ∑
              </mo>
              <mrow id="S3.E1.m1.1.6.2.2.3">
               <mi id="S3.E1.m1.1.6.2.2.3.2">
                t
               </mi>
               <mo id="S3.E1.m1.1.6.2.2.3.1">
                =
               </mo>
               <mn id="S3.E1.m1.1.6.2.2.3.3">
                0
               </mn>
              </mrow>
              <mi id="S3.E1.m1.1.6.2.3" mathvariant="normal">
               ∞
              </mi>
             </munderover>
            </mstyle>
            <msup id="S3.E1.m1.1.6.3">
             <mi id="S3.E1.m1.1.6.3.2">
              γ
             </mi>
             <mi id="S3.E1.m1.1.6.3.3">
              t
             </mi>
            </msup>
            <mrow id="S3.E1.m1.1.6.4">
             <mo id="S3.E1.m1.1.6.4.1" stretchy="false">
              (
             </mo>
             <mi id="S3.E1.m1.1.6.4.2">
              r
             </mi>
             <mrow id="S3.E1.m1.1.6.4.3">
              <mo id="S3.E1.m1.1.6.4.3.1" stretchy="false">
               (
              </mo>
              <msub id="S3.E1.m1.1.6.4.3.2">
               <mi id="S3.E1.m1.1.6.4.3.2.2">
                s
               </mi>
               <mi id="S3.E1.m1.1.6.4.3.2.3">
                t
               </mi>
              </msub>
              <mo id="S3.E1.m1.1.6.4.3.3">
               ,
              </mo>
              <msub id="S3.E1.m1.1.6.4.3.4">
               <mi id="S3.E1.m1.1.6.4.3.4.2">
                a
               </mi>
               <mi id="S3.E1.m1.1.6.4.3.4.3">
                t
               </mi>
              </msub>
              <mo id="S3.E1.m1.1.6.4.3.5" stretchy="false">
               )
              </mo>
             </mrow>
             <mo id="S3.E1.m1.1.6.4.4" maxsize="160%" minsize="160%">
              ]
             </mo>
            </mrow>
            <mo id="S3.E1.m1.1.6.5">
             ,
            </mo>
           </mrow>
          </mrow>
          <annotation encoding="application/x-tex" id="S3.E1.m1.1c">
           \displaystyle\mathcal{G}^{\prime}(\pi)=\mathbb{E}_{a\sim\pi}\Big{[}\sum_{t=0}^{\infty}\gamma^{t}(r(s_{t},a_{t})\Big{]},
          </annotation>
         </semantics>
        </math>
       </td>
       <td class="ltx_eqn_cell ltx_eqn_center_padright">
       </td>
       <td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1">
        <span class="ltx_tag ltx_tag_equation ltx_align_right">
         (1)
        </span>
       </td>
      </tr>
     </tbody>
    </table>
    <p class="ltx_p" id="S3.SS2.p1.2">
     which is prone to overfitting
     <cite class="ltx_cite ltx_citemacro_citep">
      (Zhang et al.,
      <a class="ltx_ref" href="#bib.bib49" title="">
       2018
      </a>
      )
     </cite>
     .
Directly applying RL to LLMs poses significant risks of disrupting the well-calibrated token distribution of LLMs and thus impairs the diversity and readability of language expressions that are essential for language models.
    </p>
   </div>
   <div class="ltx_para" id="S3.SS2.p2">
    <p class="ltx_p" id="S3.SS2.p2.8">
     Fortunately, there have been many studies
     <cite class="ltx_cite ltx_citemacro_citep">
      (Todorov,
      <a class="ltx_ref" href="#bib.bib40" title="">
       2008
      </a>
      ; Kappen et al.,
      <a class="ltx_ref" href="#bib.bib16" title="">
       2012
      </a>
      ; Kappen,
      <a class="ltx_ref" href="#bib.bib15" title="">
       2011
      </a>
      ; Ziebart,
      <a class="ltx_ref" href="#bib.bib50" title="">
       2010
      </a>
      ; Toussaint,
      <a class="ltx_ref" href="#bib.bib41" title="">
       2009
      </a>
      ; Levine,
      <a class="ltx_ref" href="#bib.bib20" title="">
       2018
      </a>
      )
     </cite>
     trying to couch the RL problem in the parlance of probability theory and develop a set of ERL methods. The expected entropy-regularized return which ERL targets to maximize is:
    </p>
    <table class="ltx_equationgroup ltx_eqn_align ltx_eqn_table" id="A7.EGx2">
     <tbody id="S3.E2">
      <tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
       <td class="ltx_eqn_cell ltx_eqn_center_padleft">
       </td>
       <td class="ltx_td ltx_align_right ltx_eqn_cell">
        <math alttext="\displaystyle\mathcal{G}(\pi)=\mathbb{E}_{a\sim\pi}\Big{[}\sum_{t=0}^{\infty}\gamma^{t}(r(s_{t},a_{t})-\beta D_{KL}[\pi||\bar{\pi}](s_{t})\Big{]}," class="ltx_math_unparsed" display="inline" id="S3.E2.m1.1">
         <semantics id="S3.E2.m1.1a">
          <mrow id="S3.E2.m1.1b">
           <mi class="ltx_font_mathcaligraphic" id="S3.E2.m1.1.2">
            𝒢
           </mi>
           <mrow id="S3.E2.m1.1.3">
            <mo id="S3.E2.m1.1.3.1" stretchy="false">
             (
            </mo>
            <mi id="S3.E2.m1.1.1">
             π
            </mi>
            <mo id="S3.E2.m1.1.3.2" stretchy="false">
             )
            </mo>
           </mrow>
           <mo id="S3.E2.m1.1.4">
            =
           </mo>
           <msub id="S3.E2.m1.1.5">
            <mi id="S3.E2.m1.1.5.2">
             𝔼
            </mi>
            <mrow id="S3.E2.m1.1.5.3">
             <mi id="S3.E2.m1.1.5.3.2">
              a
             </mi>
             <mo id="S3.E2.m1.1.5.3.1">
              ∼
             </mo>
             <mi id="S3.E2.m1.1.5.3.3">
              π
             </mi>
            </mrow>
           </msub>
           <mrow id="S3.E2.m1.1.6">
            <mo id="S3.E2.m1.1.6.1" maxsize="160%" minsize="160%">
             [
            </mo>
            <mstyle displaystyle="true" id="S3.E2.m1.1.6.2">
             <munderover id="S3.E2.m1.1.6.2a">
              <mo id="S3.E2.m1.1.6.2.2.2" movablelimits="false">
               ∑
              </mo>
              <mrow id="S3.E2.m1.1.6.2.2.3">
               <mi id="S3.E2.m1.1.6.2.2.3.2">
                t
               </mi>
               <mo id="S3.E2.m1.1.6.2.2.3.1">
                =
               </mo>
               <mn id="S3.E2.m1.1.6.2.2.3.3">
                0
               </mn>
              </mrow>
              <mi id="S3.E2.m1.1.6.2.3" mathvariant="normal">
               ∞
              </mi>
             </munderover>
            </mstyle>
            <msup id="S3.E2.m1.1.6.3">
             <mi id="S3.E2.m1.1.6.3.2">
              γ
             </mi>
             <mi id="S3.E2.m1.1.6.3.3">
              t
             </mi>
            </msup>
            <mrow id="S3.E2.m1.1.6.4">
             <mo id="S3.E2.m1.1.6.4.1" stretchy="false">
              (
             </mo>
             <mi id="S3.E2.m1.1.6.4.2">
              r
             </mi>
             <mrow id="S3.E2.m1.1.6.4.3">
              <mo id="S3.E2.m1.1.6.4.3.1" stretchy="false">
               (
              </mo>
              <msub id="S3.E2.m1.1.6.4.3.2">
               <mi id="S3.E2.m1.1.6.4.3.2.2">
                s
               </mi>
               <mi id="S3.E2.m1.1.6.4.3.2.3">
                t
               </mi>
              </msub>
              <mo id="S3.E2.m1.1.6.4.3.3">
               ,
              </mo>
              <msub id="S3.E2.m1.1.6.4.3.4">
               <mi id="S3.E2.m1.1.6.4.3.4.2">
                a
               </mi>
               <mi id="S3.E2.m1.1.6.4.3.4.3">
                t
               </mi>
              </msub>
              <mo id="S3.E2.m1.1.6.4.3.5" stretchy="false">
               )
              </mo>
             </mrow>
             <mo id="S3.E2.m1.1.6.4.4">
              −
             </mo>
             <mi id="S3.E2.m1.1.6.4.5">
              β
             </mi>
             <msub id="S3.E2.m1.1.6.4.6">
              <mi id="S3.E2.m1.1.6.4.6.2">
               D
              </mi>
              <mrow id="S3.E2.m1.1.6.4.6.3">
               <mi id="S3.E2.m1.1.6.4.6.3.2">
                K
               </mi>
               <mo id="S3.E2.m1.1.6.4.6.3.1" lspace="0em" rspace="0em">
                ​
               </mo>
               <mi id="S3.E2.m1.1.6.4.6.3.3">
                L
               </mi>
              </mrow>
             </msub>
             <mrow id="S3.E2.m1.1.6.4.7">
              <mo id="S3.E2.m1.1.6.4.7.1" stretchy="false">
               [
              </mo>
              <mi id="S3.E2.m1.1.6.4.7.2">
               π
              </mi>
              <mo fence="false" id="S3.E2.m1.1.6.4.7.3" rspace="0.167em" stretchy="false">
               |
              </mo>
              <mo fence="false" id="S3.E2.m1.1.6.4.7.4" rspace="0.167em" stretchy="false">
               |
              </mo>
              <mover accent="true" id="S3.E2.m1.1.6.4.7.5">
               <mi id="S3.E2.m1.1.6.4.7.5.2">
                π
               </mi>
               <mo id="S3.E2.m1.1.6.4.7.5.1">
                ¯
               </mo>
              </mover>
              <mo id="S3.E2.m1.1.6.4.7.6" stretchy="false">
               ]
              </mo>
             </mrow>
             <mrow id="S3.E2.m1.1.6.4.8">
              <mo id="S3.E2.m1.1.6.4.8.1" stretchy="false">
               (
              </mo>
              <msub id="S3.E2.m1.1.6.4.8.2">
               <mi id="S3.E2.m1.1.6.4.8.2.2">
                s
               </mi>
               <mi id="S3.E2.m1.1.6.4.8.2.3">
                t
               </mi>
              </msub>
              <mo id="S3.E2.m1.1.6.4.8.3" stretchy="false">
               )
              </mo>
             </mrow>
             <mo id="S3.E2.m1.1.6.4.9" maxsize="160%" minsize="160%">
              ]
             </mo>
            </mrow>
            <mo id="S3.E2.m1.1.6.5">
             ,
            </mo>
           </mrow>
          </mrow>
          <annotation encoding="application/x-tex" id="S3.E2.m1.1c">
           \displaystyle\mathcal{G}(\pi)=\mathbb{E}_{a\sim\pi}\Big{[}\sum_{t=0}^{\infty}\gamma^{t}(r(s_{t},a_{t})-\beta D_{KL}[\pi||\bar{\pi}](s_{t})\Big{]},
          </annotation>
         </semantics>
        </math>
       </td>
       <td class="ltx_eqn_cell ltx_eqn_center_padright">
       </td>
       <td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1">
        <span class="ltx_tag ltx_tag_equation ltx_align_right">
         (2)
        </span>
       </td>
      </tr>
     </tbody>
    </table>
    <p class="ltx_p" id="S3.SS2.p2.4">
     where
     <math alttext="D_{KL}[\pi||\bar{\pi}](s_{t})=D_{KL}[\pi(\cdot|s_{t})||\bar{\pi}(\cdot|s_{t})]" class="ltx_math_unparsed" display="inline" id="S3.SS2.p2.1.m1.1">
      <semantics id="S3.SS2.p2.1.m1.1a">
       <mrow id="S3.SS2.p2.1.m1.1b">
        <msub id="S3.SS2.p2.1.m1.1.1">
         <mi id="S3.SS2.p2.1.m1.1.1.2">
          D
         </mi>
         <mrow id="S3.SS2.p2.1.m1.1.1.3">
          <mi id="S3.SS2.p2.1.m1.1.1.3.2">
           K
          </mi>
          <mo id="S3.SS2.p2.1.m1.1.1.3.1" lspace="0em" rspace="0em">
           ​
          </mo>
          <mi id="S3.SS2.p2.1.m1.1.1.3.3">
           L
          </mi>
         </mrow>
        </msub>
        <mrow id="S3.SS2.p2.1.m1.1.2">
         <mo id="S3.SS2.p2.1.m1.1.2.1" stretchy="false">
          [
         </mo>
         <mi id="S3.SS2.p2.1.m1.1.2.2">
          π
         </mi>
         <mo fence="false" id="S3.SS2.p2.1.m1.1.2.3" rspace="0.167em" stretchy="false">
          |
         </mo>
         <mo fence="false" id="S3.SS2.p2.1.m1.1.2.4" rspace="0.167em" stretchy="false">
          |
         </mo>
         <mover accent="true" id="S3.SS2.p2.1.m1.1.2.5">
          <mi id="S3.SS2.p2.1.m1.1.2.5.2">
           π
          </mi>
          <mo id="S3.SS2.p2.1.m1.1.2.5.1">
           ¯
          </mo>
         </mover>
         <mo id="S3.SS2.p2.1.m1.1.2.6" stretchy="false">
          ]
         </mo>
        </mrow>
        <mrow id="S3.SS2.p2.1.m1.1.3">
         <mo id="S3.SS2.p2.1.m1.1.3.1" stretchy="false">
          (
         </mo>
         <msub id="S3.SS2.p2.1.m1.1.3.2">
          <mi id="S3.SS2.p2.1.m1.1.3.2.2">
           s
          </mi>
          <mi id="S3.SS2.p2.1.m1.1.3.2.3">
           t
          </mi>
         </msub>
         <mo id="S3.SS2.p2.1.m1.1.3.3" stretchy="false">
          )
         </mo>
        </mrow>
        <mo id="S3.SS2.p2.1.m1.1.4">
         =
        </mo>
        <msub id="S3.SS2.p2.1.m1.1.5">
         <mi id="S3.SS2.p2.1.m1.1.5.2">
          D
         </mi>
         <mrow id="S3.SS2.p2.1.m1.1.5.3">
          <mi id="S3.SS2.p2.1.m1.1.5.3.2">
           K
          </mi>
          <mo id="S3.SS2.p2.1.m1.1.5.3.1" lspace="0em" rspace="0em">
           ​
          </mo>
          <mi id="S3.SS2.p2.1.m1.1.5.3.3">
           L
          </mi>
         </mrow>
        </msub>
        <mrow id="S3.SS2.p2.1.m1.1.6">
         <mo id="S3.SS2.p2.1.m1.1.6.1" stretchy="false">
          [
         </mo>
         <mi id="S3.SS2.p2.1.m1.1.6.2">
          π
         </mi>
         <mrow id="S3.SS2.p2.1.m1.1.6.3">
          <mo id="S3.SS2.p2.1.m1.1.6.3.1" stretchy="false">
           (
          </mo>
          <mo id="S3.SS2.p2.1.m1.1.6.3.2" lspace="0em" rspace="0em">
           ⋅
          </mo>
          <mo fence="false" id="S3.SS2.p2.1.m1.1.6.3.3" rspace="0.167em" stretchy="false">
           |
          </mo>
          <msub id="S3.SS2.p2.1.m1.1.6.3.4">
           <mi id="S3.SS2.p2.1.m1.1.6.3.4.2">
            s
           </mi>
           <mi id="S3.SS2.p2.1.m1.1.6.3.4.3">
            t
           </mi>
          </msub>
          <mo id="S3.SS2.p2.1.m1.1.6.3.5" stretchy="false">
           )
          </mo>
         </mrow>
         <mo fence="false" id="S3.SS2.p2.1.m1.1.6.4" rspace="0.167em" stretchy="false">
          |
         </mo>
         <mo fence="false" id="S3.SS2.p2.1.m1.1.6.5" rspace="0.167em" stretchy="false">
          |
         </mo>
         <mover accent="true" id="S3.SS2.p2.1.m1.1.6.6">
          <mi id="S3.SS2.p2.1.m1.1.6.6.2">
           π
          </mi>
          <mo id="S3.SS2.p2.1.m1.1.6.6.1">
           ¯
          </mo>
         </mover>
         <mrow id="S3.SS2.p2.1.m1.1.6.7">
          <mo id="S3.SS2.p2.1.m1.1.6.7.1" stretchy="false">
           (
          </mo>
          <mo id="S3.SS2.p2.1.m1.1.6.7.2" lspace="0em" rspace="0em">
           ⋅
          </mo>
          <mo fence="false" id="S3.SS2.p2.1.m1.1.6.7.3" rspace="0.167em" stretchy="false">
           |
          </mo>
          <msub id="S3.SS2.p2.1.m1.1.6.7.4">
           <mi id="S3.SS2.p2.1.m1.1.6.7.4.2">
            s
           </mi>
           <mi id="S3.SS2.p2.1.m1.1.6.7.4.3">
            t
           </mi>
          </msub>
          <mo id="S3.SS2.p2.1.m1.1.6.7.5" stretchy="false">
           )
          </mo>
         </mrow>
         <mo id="S3.SS2.p2.1.m1.1.6.8" stretchy="false">
          ]
         </mo>
        </mrow>
       </mrow>
       <annotation encoding="application/x-tex" id="S3.SS2.p2.1.m1.1c">
        D_{KL}[\pi||\bar{\pi}](s_{t})=D_{KL}[\pi(\cdot|s_{t})||\bar{\pi}(\cdot|s_{t})]
       </annotation>
      </semantics>
     </math>
     is the KL divergence between the learning policy
     <math alttext="\pi" class="ltx_Math" display="inline" id="S3.SS2.p2.2.m2.1">
      <semantics id="S3.SS2.p2.2.m2.1a">
       <mi id="S3.SS2.p2.2.m2.1.1" xref="S3.SS2.p2.2.m2.1.1.cmml">
        π
       </mi>
       <annotation-xml encoding="MathML-Content" id="S3.SS2.p2.2.m2.1b">
        <ci id="S3.SS2.p2.2.m2.1.1.cmml" xref="S3.SS2.p2.2.m2.1.1">
         𝜋
        </ci>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="S3.SS2.p2.2.m2.1c">
        \pi
       </annotation>
      </semantics>
     </math>
     and reference policy
     <math alttext="\bar{\pi}" class="ltx_Math" display="inline" id="S3.SS2.p2.3.m3.1">
      <semantics id="S3.SS2.p2.3.m3.1a">
       <mover accent="true" id="S3.SS2.p2.3.m3.1.1" xref="S3.SS2.p2.3.m3.1.1.cmml">
        <mi id="S3.SS2.p2.3.m3.1.1.2" xref="S3.SS2.p2.3.m3.1.1.2.cmml">
         π
        </mi>
        <mo id="S3.SS2.p2.3.m3.1.1.1" xref="S3.SS2.p2.3.m3.1.1.1.cmml">
         ¯
        </mo>
       </mover>
       <annotation-xml encoding="MathML-Content" id="S3.SS2.p2.3.m3.1b">
        <apply id="S3.SS2.p2.3.m3.1.1.cmml" xref="S3.SS2.p2.3.m3.1.1">
         <ci id="S3.SS2.p2.3.m3.1.1.1.cmml" xref="S3.SS2.p2.3.m3.1.1.1">
          ¯
         </ci>
         <ci id="S3.SS2.p2.3.m3.1.1.2.cmml" xref="S3.SS2.p2.3.m3.1.1.2">
          𝜋
         </ci>
        </apply>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="S3.SS2.p2.3.m3.1c">
        \bar{\pi}
       </annotation>
      </semantics>
     </math>
     ,
     <math alttext="\beta" class="ltx_Math" display="inline" id="S3.SS2.p2.4.m4.1">
      <semantics id="S3.SS2.p2.4.m4.1a">
       <mi id="S3.SS2.p2.4.m4.1.1" xref="S3.SS2.p2.4.m4.1.1.cmml">
        β
       </mi>
       <annotation-xml encoding="MathML-Content" id="S3.SS2.p2.4.m4.1b">
        <ci id="S3.SS2.p2.4.m4.1.1.cmml" xref="S3.SS2.p2.4.m4.1.1">
         𝛽
        </ci>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="S3.SS2.p2.4.m4.1c">
        \beta
       </annotation>
      </semantics>
     </math>
     is a scalar coefficient to balance the influence between reward signals and KL divergence. The corresponding soft Bellman update for the Q function is:
    </p>
    <table class="ltx_equationgroup ltx_eqn_align ltx_eqn_table" id="A7.EGx3">
     <tbody id="S3.Ex1">
      <tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
       <td class="ltx_eqn_cell ltx_eqn_center_padleft">
       </td>
       <td class="ltx_td ltx_align_right ltx_eqn_cell">
        <math alttext="\displaystyle Q(s_{t},a_{t})\leftarrow" class="ltx_Math" display="inline" id="S3.Ex1.m1.2">
         <semantics id="S3.Ex1.m1.2a">
          <mrow id="S3.Ex1.m1.2.2" xref="S3.Ex1.m1.2.2.cmml">
           <mrow id="S3.Ex1.m1.2.2.2" xref="S3.Ex1.m1.2.2.2.cmml">
            <mi id="S3.Ex1.m1.2.2.2.4" xref="S3.Ex1.m1.2.2.2.4.cmml">
             Q
            </mi>
            <mo id="S3.Ex1.m1.2.2.2.3" lspace="0em" rspace="0em" xref="S3.Ex1.m1.2.2.2.3.cmml">
             ​
            </mo>
            <mrow id="S3.Ex1.m1.2.2.2.2.2" xref="S3.Ex1.m1.2.2.2.2.3.cmml">
             <mo id="S3.Ex1.m1.2.2.2.2.2.3" stretchy="false" xref="S3.Ex1.m1.2.2.2.2.3.cmml">
              (
             </mo>
             <msub id="S3.Ex1.m1.1.1.1.1.1.1" xref="S3.Ex1.m1.1.1.1.1.1.1.cmml">
              <mi id="S3.Ex1.m1.1.1.1.1.1.1.2" xref="S3.Ex1.m1.1.1.1.1.1.1.2.cmml">
               s
              </mi>
              <mi id="S3.Ex1.m1.1.1.1.1.1.1.3" xref="S3.Ex1.m1.1.1.1.1.1.1.3.cmml">
               t
              </mi>
             </msub>
             <mo id="S3.Ex1.m1.2.2.2.2.2.4" xref="S3.Ex1.m1.2.2.2.2.3.cmml">
              ,
             </mo>
             <msub id="S3.Ex1.m1.2.2.2.2.2.2" xref="S3.Ex1.m1.2.2.2.2.2.2.cmml">
              <mi id="S3.Ex1.m1.2.2.2.2.2.2.2" xref="S3.Ex1.m1.2.2.2.2.2.2.2.cmml">
               a
              </mi>
              <mi id="S3.Ex1.m1.2.2.2.2.2.2.3" xref="S3.Ex1.m1.2.2.2.2.2.2.3.cmml">
               t
              </mi>
             </msub>
             <mo id="S3.Ex1.m1.2.2.2.2.2.5" stretchy="false" xref="S3.Ex1.m1.2.2.2.2.3.cmml">
              )
             </mo>
            </mrow>
           </mrow>
           <mo id="S3.Ex1.m1.2.2.3" stretchy="false" xref="S3.Ex1.m1.2.2.3.cmml">
            ←
           </mo>
           <mi id="S3.Ex1.m1.2.2.4" xref="S3.Ex1.m1.2.2.4.cmml">
           </mi>
          </mrow>
          <annotation-xml encoding="MathML-Content" id="S3.Ex1.m1.2b">
           <apply id="S3.Ex1.m1.2.2.cmml" xref="S3.Ex1.m1.2.2">
            <ci id="S3.Ex1.m1.2.2.3.cmml" xref="S3.Ex1.m1.2.2.3">
             ←
            </ci>
            <apply id="S3.Ex1.m1.2.2.2.cmml" xref="S3.Ex1.m1.2.2.2">
             <times id="S3.Ex1.m1.2.2.2.3.cmml" xref="S3.Ex1.m1.2.2.2.3">
             </times>
             <ci id="S3.Ex1.m1.2.2.2.4.cmml" xref="S3.Ex1.m1.2.2.2.4">
              𝑄
             </ci>
             <interval closure="open" id="S3.Ex1.m1.2.2.2.2.3.cmml" xref="S3.Ex1.m1.2.2.2.2.2">
              <apply id="S3.Ex1.m1.1.1.1.1.1.1.cmml" xref="S3.Ex1.m1.1.1.1.1.1.1">
               <csymbol cd="ambiguous" id="S3.Ex1.m1.1.1.1.1.1.1.1.cmml" xref="S3.Ex1.m1.1.1.1.1.1.1">
                subscript
               </csymbol>
               <ci id="S3.Ex1.m1.1.1.1.1.1.1.2.cmml" xref="S3.Ex1.m1.1.1.1.1.1.1.2">
                𝑠
               </ci>
               <ci id="S3.Ex1.m1.1.1.1.1.1.1.3.cmml" xref="S3.Ex1.m1.1.1.1.1.1.1.3">
                𝑡
               </ci>
              </apply>
              <apply id="S3.Ex1.m1.2.2.2.2.2.2.cmml" xref="S3.Ex1.m1.2.2.2.2.2.2">
               <csymbol cd="ambiguous" id="S3.Ex1.m1.2.2.2.2.2.2.1.cmml" xref="S3.Ex1.m1.2.2.2.2.2.2">
                subscript
               </csymbol>
               <ci id="S3.Ex1.m1.2.2.2.2.2.2.2.cmml" xref="S3.Ex1.m1.2.2.2.2.2.2.2">
                𝑎
               </ci>
               <ci id="S3.Ex1.m1.2.2.2.2.2.2.3.cmml" xref="S3.Ex1.m1.2.2.2.2.2.2.3">
                𝑡
               </ci>
              </apply>
             </interval>
            </apply>
            <csymbol cd="latexml" id="S3.Ex1.m1.2.2.4.cmml" xref="S3.Ex1.m1.2.2.4">
             absent
            </csymbol>
           </apply>
          </annotation-xml>
          <annotation encoding="application/x-tex" id="S3.Ex1.m1.2c">
           \displaystyle Q(s_{t},a_{t})\leftarrow
          </annotation>
         </semantics>
        </math>
       </td>
       <td class="ltx_td ltx_align_left ltx_eqn_cell">
        <math alttext="\displaystyle~{}r(s_{t},a_{t})+\gamma(\mathbb{E}_{a_{t+1}\sim\pi}[Q(s_{t+1},a_{t+1})]" class="ltx_math_unparsed" display="inline" id="S3.Ex1.m2.1">
         <semantics id="S3.Ex1.m2.1a">
          <mrow id="S3.Ex1.m2.1b">
           <mi id="S3.Ex1.m2.1.1">
            r
           </mi>
           <mrow id="S3.Ex1.m2.1.2">
            <mo id="S3.Ex1.m2.1.2.1" stretchy="false">
             (
            </mo>
            <msub id="S3.Ex1.m2.1.2.2">
             <mi id="S3.Ex1.m2.1.2.2.2">
              s
             </mi>
             <mi id="S3.Ex1.m2.1.2.2.3">
              t
             </mi>
            </msub>
            <mo id="S3.Ex1.m2.1.2.3">
             ,
            </mo>
            <msub id="S3.Ex1.m2.1.2.4">
             <mi id="S3.Ex1.m2.1.2.4.2">
              a
             </mi>
             <mi id="S3.Ex1.m2.1.2.4.3">
              t
             </mi>
            </msub>
            <mo id="S3.Ex1.m2.1.2.5" stretchy="false">
             )
            </mo>
           </mrow>
           <mo id="S3.Ex1.m2.1.3">
            +
           </mo>
           <mi id="S3.Ex1.m2.1.4">
            γ
           </mi>
           <mrow id="S3.Ex1.m2.1.5">
            <mo id="S3.Ex1.m2.1.5.1" stretchy="false">
             (
            </mo>
            <msub id="S3.Ex1.m2.1.5.2">
             <mi id="S3.Ex1.m2.1.5.2.2">
              𝔼
             </mi>
             <mrow id="S3.Ex1.m2.1.5.2.3">
              <msub id="S3.Ex1.m2.1.5.2.3.2">
               <mi id="S3.Ex1.m2.1.5.2.3.2.2">
                a
               </mi>
               <mrow id="S3.Ex1.m2.1.5.2.3.2.3">
                <mi id="S3.Ex1.m2.1.5.2.3.2.3.2">
                 t
                </mi>
                <mo id="S3.Ex1.m2.1.5.2.3.2.3.1">
                 +
                </mo>
                <mn id="S3.Ex1.m2.1.5.2.3.2.3.3">
                 1
                </mn>
               </mrow>
              </msub>
              <mo id="S3.Ex1.m2.1.5.2.3.1">
               ∼
              </mo>
              <mi id="S3.Ex1.m2.1.5.2.3.3">
               π
              </mi>
             </mrow>
            </msub>
            <mrow id="S3.Ex1.m2.1.5.3">
             <mo id="S3.Ex1.m2.1.5.3.1" stretchy="false">
              [
             </mo>
             <mi id="S3.Ex1.m2.1.5.3.2">
              Q
             </mi>
             <mrow id="S3.Ex1.m2.1.5.3.3">
              <mo id="S3.Ex1.m2.1.5.3.3.1" stretchy="false">
               (
              </mo>
              <msub id="S3.Ex1.m2.1.5.3.3.2">
               <mi id="S3.Ex1.m2.1.5.3.3.2.2">
                s
               </mi>
               <mrow id="S3.Ex1.m2.1.5.3.3.2.3">
                <mi id="S3.Ex1.m2.1.5.3.3.2.3.2">
                 t
                </mi>
                <mo id="S3.Ex1.m2.1.5.3.3.2.3.1">
                 +
                </mo>
                <mn id="S3.Ex1.m2.1.5.3.3.2.3.3">
                 1
                </mn>
               </mrow>
              </msub>
              <mo id="S3.Ex1.m2.1.5.3.3.3">
               ,
              </mo>
              <msub id="S3.Ex1.m2.1.5.3.3.4">
               <mi id="S3.Ex1.m2.1.5.3.3.4.2">
                a
               </mi>
               <mrow id="S3.Ex1.m2.1.5.3.3.4.3">
                <mi id="S3.Ex1.m2.1.5.3.3.4.3.2">
                 t
                </mi>
                <mo id="S3.Ex1.m2.1.5.3.3.4.3.1">
                 +
                </mo>
                <mn id="S3.Ex1.m2.1.5.3.3.4.3.3">
                 1
                </mn>
               </mrow>
              </msub>
              <mo id="S3.Ex1.m2.1.5.3.3.5" stretchy="false">
               )
              </mo>
             </mrow>
             <mo id="S3.Ex1.m2.1.5.3.4" stretchy="false">
              ]
             </mo>
            </mrow>
           </mrow>
          </mrow>
          <annotation encoding="application/x-tex" id="S3.Ex1.m2.1c">
           \displaystyle~{}r(s_{t},a_{t})+\gamma(\mathbb{E}_{a_{t+1}\sim\pi}[Q(s_{t+1},a_{t+1})]
          </annotation>
         </semantics>
        </math>
       </td>
       <td class="ltx_eqn_cell ltx_eqn_center_padright">
       </td>
      </tr>
     </tbody>
     <tbody id="S3.E3">
      <tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
       <td class="ltx_eqn_cell ltx_eqn_center_padleft">
       </td>
       <td class="ltx_td ltx_eqn_cell">
       </td>
       <td class="ltx_td ltx_align_left ltx_eqn_cell">
        <math alttext="\displaystyle-\beta D_{KL}[\pi||\bar{\pi}](s_{t}))." class="ltx_math_unparsed" display="inline" id="S3.E3.m1.1">
         <semantics id="S3.E3.m1.1a">
          <mrow id="S3.E3.m1.1b">
           <mo id="S3.E3.m1.1.1">
            −
           </mo>
           <mi id="S3.E3.m1.1.2">
            β
           </mi>
           <msub id="S3.E3.m1.1.3">
            <mi id="S3.E3.m1.1.3.2">
             D
            </mi>
            <mrow id="S3.E3.m1.1.3.3">
             <mi id="S3.E3.m1.1.3.3.2">
              K
             </mi>
             <mo id="S3.E3.m1.1.3.3.1" lspace="0em" rspace="0em">
              ​
             </mo>
             <mi id="S3.E3.m1.1.3.3.3">
              L
             </mi>
            </mrow>
           </msub>
           <mrow id="S3.E3.m1.1.4">
            <mo id="S3.E3.m1.1.4.1" stretchy="false">
             [
            </mo>
            <mi id="S3.E3.m1.1.4.2">
             π
            </mi>
            <mo fence="false" id="S3.E3.m1.1.4.3" rspace="0.167em" stretchy="false">
             |
            </mo>
            <mo fence="false" id="S3.E3.m1.1.4.4" rspace="0.167em" stretchy="false">
             |
            </mo>
            <mover accent="true" id="S3.E3.m1.1.4.5">
             <mi id="S3.E3.m1.1.4.5.2">
              π
             </mi>
             <mo id="S3.E3.m1.1.4.5.1">
              ¯
             </mo>
            </mover>
            <mo id="S3.E3.m1.1.4.6" stretchy="false">
             ]
            </mo>
           </mrow>
           <mrow id="S3.E3.m1.1.5">
            <mo id="S3.E3.m1.1.5.1" stretchy="false">
             (
            </mo>
            <msub id="S3.E3.m1.1.5.2">
             <mi id="S3.E3.m1.1.5.2.2">
              s
             </mi>
             <mi id="S3.E3.m1.1.5.2.3">
              t
             </mi>
            </msub>
            <mo id="S3.E3.m1.1.5.3" stretchy="false">
             )
            </mo>
           </mrow>
           <mo id="S3.E3.m1.1.6" stretchy="false">
            )
           </mo>
           <mo id="S3.E3.m1.1.7" lspace="0em">
            .
           </mo>
          </mrow>
          <annotation encoding="application/x-tex" id="S3.E3.m1.1c">
           \displaystyle-\beta D_{KL}[\pi||\bar{\pi}](s_{t})).
          </annotation>
         </semantics>
        </math>
       </td>
       <td class="ltx_eqn_cell ltx_eqn_center_padright">
       </td>
       <td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1">
        <span class="ltx_tag ltx_tag_equation ltx_align_right">
         (3)
        </span>
       </td>
      </tr>
     </tbody>
    </table>
    <p class="ltx_p" id="S3.SS2.p2.7">
     Equation
     <a class="ltx_ref" href="#S3.E2" title="Equation 2 ‣ 3.2 Entropy-Regularized Reinforcement Learning ‣ 3 Preliminaries ‣ Entropy-Regularized Token-Level Policy Optimization for Large Language Models">
      <span class="ltx_text ltx_ref_tag">
       2
      </span>
     </a>
     indicates that the objective of ERL is constrained with a given probability distribution
     <math alttext="\bar{\pi}" class="ltx_Math" display="inline" id="S3.SS2.p2.5.m1.1">
      <semantics id="S3.SS2.p2.5.m1.1a">
       <mover accent="true" id="S3.SS2.p2.5.m1.1.1" xref="S3.SS2.p2.5.m1.1.1.cmml">
        <mi id="S3.SS2.p2.5.m1.1.1.2" xref="S3.SS2.p2.5.m1.1.1.2.cmml">
         π
        </mi>
        <mo id="S3.SS2.p2.5.m1.1.1.1" xref="S3.SS2.p2.5.m1.1.1.1.cmml">
         ¯
        </mo>
       </mover>
       <annotation-xml encoding="MathML-Content" id="S3.SS2.p2.5.m1.1b">
        <apply id="S3.SS2.p2.5.m1.1.1.cmml" xref="S3.SS2.p2.5.m1.1.1">
         <ci id="S3.SS2.p2.5.m1.1.1.1.cmml" xref="S3.SS2.p2.5.m1.1.1.1">
          ¯
         </ci>
         <ci id="S3.SS2.p2.5.m1.1.1.2.cmml" xref="S3.SS2.p2.5.m1.1.1.2">
          𝜋
         </ci>
        </apply>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="S3.SS2.p2.5.m1.1c">
        \bar{\pi}
       </annotation>
      </semantics>
     </math>
     . Thus, by assigning the
     <math alttext="\bar{\pi}" class="ltx_Math" display="inline" id="S3.SS2.p2.6.m2.1">
      <semantics id="S3.SS2.p2.6.m2.1a">
       <mover accent="true" id="S3.SS2.p2.6.m2.1.1" xref="S3.SS2.p2.6.m2.1.1.cmml">
        <mi id="S3.SS2.p2.6.m2.1.1.2" xref="S3.SS2.p2.6.m2.1.1.2.cmml">
         π
        </mi>
        <mo id="S3.SS2.p2.6.m2.1.1.1" xref="S3.SS2.p2.6.m2.1.1.1.cmml">
         ¯
        </mo>
       </mover>
       <annotation-xml encoding="MathML-Content" id="S3.SS2.p2.6.m2.1b">
        <apply id="S3.SS2.p2.6.m2.1.1.cmml" xref="S3.SS2.p2.6.m2.1.1">
         <ci id="S3.SS2.p2.6.m2.1.1.1.cmml" xref="S3.SS2.p2.6.m2.1.1.1">
          ¯
         </ci>
         <ci id="S3.SS2.p2.6.m2.1.1.2.cmml" xref="S3.SS2.p2.6.m2.1.1.2">
          𝜋
         </ci>
        </apply>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="S3.SS2.p2.6.m2.1c">
        \bar{\pi}
       </annotation>
      </semantics>
     </math>
     with an original LLM
     <math alttext="\rho" class="ltx_Math" display="inline" id="S3.SS2.p2.7.m3.1">
      <semantics id="S3.SS2.p2.7.m3.1a">
       <mi id="S3.SS2.p2.7.m3.1.1" xref="S3.SS2.p2.7.m3.1.1.cmml">
        ρ
       </mi>
       <annotation-xml encoding="MathML-Content" id="S3.SS2.p2.7.m3.1b">
        <ci id="S3.SS2.p2.7.m3.1.1.cmml" xref="S3.SS2.p2.7.m3.1.1">
         𝜌
        </ci>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="S3.SS2.p2.7.m3.1c">
        \rho
       </annotation>
      </semantics>
     </math>
     in Equation
     <a class="ltx_ref" href="#S3.Ex1" title="3.2 Entropy-Regularized Reinforcement Learning ‣ 3 Preliminaries ‣ Entropy-Regularized Token-Level Policy Optimization for Large Language Models">
      <span class="ltx_text ltx_ref_tag">
       3.2
      </span>
     </a>
     , we can smoothly bridge the gap in learning objectives between RL and language modeling, i.e. maximizing the cumulative return while maintaining the original token distribution as much as possible.
    </p>
   </div>
  </section>
  <section class="ltx_subsection" id="S3.SS3">
   <h3 class="ltx_title ltx_title_subsection">
    <span class="ltx_tag ltx_tag_subsection">
     3.3
    </span>
    Action-Level and Token-Level Policy Optimization
   </h3>
   <div class="ltx_para" id="S3.SS3.p1">
    <p class="ltx_p" id="S3.SS3.p1.9">
     Another gap between RL and language modeling is the differences in the granularity of optimization.
In most traditional reinforcement learning scenarios with discrete action spaces, actions are typically inseparable, thus rendering the action space
     <math alttext="\mathcal{|A^{\prime}|}=O(d)" class="ltx_Math" display="inline" id="S3.SS3.p1.1.m1.2">
      <semantics id="S3.SS3.p1.1.m1.2a">
       <mrow id="S3.SS3.p1.1.m1.2.2" xref="S3.SS3.p1.1.m1.2.2.cmml">
        <mrow id="S3.SS3.p1.1.m1.2.2.1.1" xref="S3.SS3.p1.1.m1.2.2.1.2.cmml">
         <mo id="S3.SS3.p1.1.m1.2.2.1.1.2" stretchy="false" xref="S3.SS3.p1.1.m1.2.2.1.2.1.cmml">
          |
         </mo>
         <msup id="S3.SS3.p1.1.m1.2.2.1.1.1" xref="S3.SS3.p1.1.m1.2.2.1.1.1.cmml">
          <mi class="ltx_font_mathcaligraphic" id="S3.SS3.p1.1.m1.2.2.1.1.1.2" xref="S3.SS3.p1.1.m1.2.2.1.1.1.2.cmml">
           𝒜
          </mi>
          <mo id="S3.SS3.p1.1.m1.2.2.1.1.1.3" xref="S3.SS3.p1.1.m1.2.2.1.1.1.3.cmml">
           ′
          </mo>
         </msup>
         <mo id="S3.SS3.p1.1.m1.2.2.1.1.3" stretchy="false" xref="S3.SS3.p1.1.m1.2.2.1.2.1.cmml">
          |
         </mo>
        </mrow>
        <mo id="S3.SS3.p1.1.m1.2.2.2" xref="S3.SS3.p1.1.m1.2.2.2.cmml">
         =
        </mo>
        <mrow id="S3.SS3.p1.1.m1.2.2.3" xref="S3.SS3.p1.1.m1.2.2.3.cmml">
         <mi id="S3.SS3.p1.1.m1.2.2.3.2" xref="S3.SS3.p1.1.m1.2.2.3.2.cmml">
          O
         </mi>
         <mo id="S3.SS3.p1.1.m1.2.2.3.1" lspace="0em" rspace="0em" xref="S3.SS3.p1.1.m1.2.2.3.1.cmml">
          ​
         </mo>
         <mrow id="S3.SS3.p1.1.m1.2.2.3.3.2" xref="S3.SS3.p1.1.m1.2.2.3.cmml">
          <mo id="S3.SS3.p1.1.m1.2.2.3.3.2.1" stretchy="false" xref="S3.SS3.p1.1.m1.2.2.3.cmml">
           (
          </mo>
          <mi id="S3.SS3.p1.1.m1.1.1" xref="S3.SS3.p1.1.m1.1.1.cmml">
           d
          </mi>
          <mo id="S3.SS3.p1.1.m1.2.2.3.3.2.2" stretchy="false" xref="S3.SS3.p1.1.m1.2.2.3.cmml">
           )
          </mo>
         </mrow>
        </mrow>
       </mrow>
       <annotation-xml encoding="MathML-Content" id="S3.SS3.p1.1.m1.2b">
        <apply id="S3.SS3.p1.1.m1.2.2.cmml" xref="S3.SS3.p1.1.m1.2.2">
         <eq id="S3.SS3.p1.1.m1.2.2.2.cmml" xref="S3.SS3.p1.1.m1.2.2.2">
         </eq>
         <apply id="S3.SS3.p1.1.m1.2.2.1.2.cmml" xref="S3.SS3.p1.1.m1.2.2.1.1">
          <abs id="S3.SS3.p1.1.m1.2.2.1.2.1.cmml" xref="S3.SS3.p1.1.m1.2.2.1.1.2">
          </abs>
          <apply id="S3.SS3.p1.1.m1.2.2.1.1.1.cmml" xref="S3.SS3.p1.1.m1.2.2.1.1.1">
           <csymbol cd="ambiguous" id="S3.SS3.p1.1.m1.2.2.1.1.1.1.cmml" xref="S3.SS3.p1.1.m1.2.2.1.1.1">
            superscript
           </csymbol>
           <ci id="S3.SS3.p1.1.m1.2.2.1.1.1.2.cmml" xref="S3.SS3.p1.1.m1.2.2.1.1.1.2">
            𝒜
           </ci>
           <ci id="S3.SS3.p1.1.m1.2.2.1.1.1.3.cmml" xref="S3.SS3.p1.1.m1.2.2.1.1.1.3">
            ′
           </ci>
          </apply>
         </apply>
         <apply id="S3.SS3.p1.1.m1.2.2.3.cmml" xref="S3.SS3.p1.1.m1.2.2.3">
          <times id="S3.SS3.p1.1.m1.2.2.3.1.cmml" xref="S3.SS3.p1.1.m1.2.2.3.1">
          </times>
          <ci id="S3.SS3.p1.1.m1.2.2.3.2.cmml" xref="S3.SS3.p1.1.m1.2.2.3.2">
           𝑂
          </ci>
          <ci id="S3.SS3.p1.1.m1.1.1.cmml" xref="S3.SS3.p1.1.m1.1.1">
           𝑑
          </ci>
         </apply>
        </apply>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="S3.SS3.p1.1.m1.2c">
        \mathcal{|A^{\prime}|}=O(d)
       </annotation>
      </semantics>
     </math>
     , where
     <math alttext="d" class="ltx_Math" display="inline" id="S3.SS3.p1.2.m2.1">
      <semantics id="S3.SS3.p1.2.m2.1a">
       <mi id="S3.SS3.p1.2.m2.1.1" xref="S3.SS3.p1.2.m2.1.1.cmml">
        d
       </mi>
       <annotation-xml encoding="MathML-Content" id="S3.SS3.p1.2.m2.1b">
        <ci id="S3.SS3.p1.2.m2.1.1.cmml" xref="S3.SS3.p1.2.m2.1.1">
         𝑑
        </ci>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="S3.SS3.p1.2.m2.1c">
        d
       </annotation>
      </semantics>
     </math>
     is the number of available actions. However, as described in Section
     <a class="ltx_ref" href="#S3.SS1" title="3.1 Language-Augmented Sequential Decision-Making ‣ 3 Preliminaries ‣ Entropy-Regularized Token-Level Policy Optimization for Large Language Models">
      <span class="ltx_text ltx_ref_tag">
       3.1
      </span>
     </a>
     , when we introduce LLMs as policies, an action
     <math alttext="a" class="ltx_Math" display="inline" id="S3.SS3.p1.3.m3.1">
      <semantics id="S3.SS3.p1.3.m3.1a">
       <mi id="S3.SS3.p1.3.m3.1.1" xref="S3.SS3.p1.3.m3.1.1.cmml">
        a
       </mi>
       <annotation-xml encoding="MathML-Content" id="S3.SS3.p1.3.m3.1b">
        <ci id="S3.SS3.p1.3.m3.1.1.cmml" xref="S3.SS3.p1.3.m3.1.1">
         𝑎
        </ci>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="S3.SS3.p1.3.m3.1c">
        a
       </annotation>
      </semantics>
     </math>
     consists of a sequence of tokens
     <math alttext="a=(w^{1},\dots,w^{|a|})" class="ltx_Math" display="inline" id="S3.SS3.p1.4.m4.4">
      <semantics id="S3.SS3.p1.4.m4.4a">
       <mrow id="S3.SS3.p1.4.m4.4.4" xref="S3.SS3.p1.4.m4.4.4.cmml">
        <mi id="S3.SS3.p1.4.m4.4.4.4" xref="S3.SS3.p1.4.m4.4.4.4.cmml">
         a
        </mi>
        <mo id="S3.SS3.p1.4.m4.4.4.3" xref="S3.SS3.p1.4.m4.4.4.3.cmml">
         =
        </mo>
        <mrow id="S3.SS3.p1.4.m4.4.4.2.2" xref="S3.SS3.p1.4.m4.4.4.2.3.cmml">
         <mo id="S3.SS3.p1.4.m4.4.4.2.2.3" stretchy="false" xref="S3.SS3.p1.4.m4.4.4.2.3.cmml">
          (
         </mo>
         <msup id="S3.SS3.p1.4.m4.3.3.1.1.1" xref="S3.SS3.p1.4.m4.3.3.1.1.1.cmml">
          <mi id="S3.SS3.p1.4.m4.3.3.1.1.1.2" xref="S3.SS3.p1.4.m4.3.3.1.1.1.2.cmml">
           w
          </mi>
          <mn id="S3.SS3.p1.4.m4.3.3.1.1.1.3" xref="S3.SS3.p1.4.m4.3.3.1.1.1.3.cmml">
           1
          </mn>
         </msup>
         <mo id="S3.SS3.p1.4.m4.4.4.2.2.4" xref="S3.SS3.p1.4.m4.4.4.2.3.cmml">
          ,
         </mo>
         <mi id="S3.SS3.p1.4.m4.2.2" mathvariant="normal" xref="S3.SS3.p1.4.m4.2.2.cmml">
          …
         </mi>
         <mo id="S3.SS3.p1.4.m4.4.4.2.2.5" xref="S3.SS3.p1.4.m4.4.4.2.3.cmml">
          ,
         </mo>
         <msup id="S3.SS3.p1.4.m4.4.4.2.2.2" xref="S3.SS3.p1.4.m4.4.4.2.2.2.cmml">
          <mi id="S3.SS3.p1.4.m4.4.4.2.2.2.2" xref="S3.SS3.p1.4.m4.4.4.2.2.2.2.cmml">
           w
          </mi>
          <mrow id="S3.SS3.p1.4.m4.1.1.1.3" xref="S3.SS3.p1.4.m4.1.1.1.2.cmml">
           <mo id="S3.SS3.p1.4.m4.1.1.1.3.1" stretchy="false" xref="S3.SS3.p1.4.m4.1.1.1.2.1.cmml">
            |
           </mo>
           <mi id="S3.SS3.p1.4.m4.1.1.1.1" xref="S3.SS3.p1.4.m4.1.1.1.1.cmml">
            a
           </mi>
           <mo id="S3.SS3.p1.4.m4.1.1.1.3.2" stretchy="false" xref="S3.SS3.p1.4.m4.1.1.1.2.1.cmml">
            |
           </mo>
          </mrow>
         </msup>
         <mo id="S3.SS3.p1.4.m4.4.4.2.2.6" stretchy="false" xref="S3.SS3.p1.4.m4.4.4.2.3.cmml">
          )
         </mo>
        </mrow>
       </mrow>
       <annotation-xml encoding="MathML-Content" id="S3.SS3.p1.4.m4.4b">
        <apply id="S3.SS3.p1.4.m4.4.4.cmml" xref="S3.SS3.p1.4.m4.4.4">
         <eq id="S3.SS3.p1.4.m4.4.4.3.cmml" xref="S3.SS3.p1.4.m4.4.4.3">
         </eq>
         <ci id="S3.SS3.p1.4.m4.4.4.4.cmml" xref="S3.SS3.p1.4.m4.4.4.4">
          𝑎
         </ci>
         <vector id="S3.SS3.p1.4.m4.4.4.2.3.cmml" xref="S3.SS3.p1.4.m4.4.4.2.2">
          <apply id="S3.SS3.p1.4.m4.3.3.1.1.1.cmml" xref="S3.SS3.p1.4.m4.3.3.1.1.1">
           <csymbol cd="ambiguous" id="S3.SS3.p1.4.m4.3.3.1.1.1.1.cmml" xref="S3.SS3.p1.4.m4.3.3.1.1.1">
            superscript
           </csymbol>
           <ci id="S3.SS3.p1.4.m4.3.3.1.1.1.2.cmml" xref="S3.SS3.p1.4.m4.3.3.1.1.1.2">
            𝑤
           </ci>
           <cn id="S3.SS3.p1.4.m4.3.3.1.1.1.3.cmml" type="integer" xref="S3.SS3.p1.4.m4.3.3.1.1.1.3">
            1
           </cn>
          </apply>
          <ci id="S3.SS3.p1.4.m4.2.2.cmml" xref="S3.SS3.p1.4.m4.2.2">
           …
          </ci>
          <apply id="S3.SS3.p1.4.m4.4.4.2.2.2.cmml" xref="S3.SS3.p1.4.m4.4.4.2.2.2">
           <csymbol cd="ambiguous" id="S3.SS3.p1.4.m4.4.4.2.2.2.1.cmml" xref="S3.SS3.p1.4.m4.4.4.2.2.2">
            superscript
           </csymbol>
           <ci id="S3.SS3.p1.4.m4.4.4.2.2.2.2.cmml" xref="S3.SS3.p1.4.m4.4.4.2.2.2.2">
            𝑤
           </ci>
           <apply id="S3.SS3.p1.4.m4.1.1.1.2.cmml" xref="S3.SS3.p1.4.m4.1.1.1.3">
            <abs id="S3.SS3.p1.4.m4.1.1.1.2.1.cmml" xref="S3.SS3.p1.4.m4.1.1.1.3.1">
            </abs>
            <ci id="S3.SS3.p1.4.m4.1.1.1.1.cmml" xref="S3.SS3.p1.4.m4.1.1.1.1">
             𝑎
            </ci>
           </apply>
          </apply>
         </vector>
        </apply>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="S3.SS3.p1.4.m4.4c">
        a=(w^{1},\dots,w^{|a|})
       </annotation>
      </semantics>
     </math>
     generated by the LLM. In this case, since each token has an independent search space with vocabulary size
     <math alttext="O(|\mathcal{V}|)" class="ltx_Math" display="inline" id="S3.SS3.p1.5.m5.2">
      <semantics id="S3.SS3.p1.5.m5.2a">
       <mrow id="S3.SS3.p1.5.m5.2.2" xref="S3.SS3.p1.5.m5.2.2.cmml">
        <mi id="S3.SS3.p1.5.m5.2.2.3" xref="S3.SS3.p1.5.m5.2.2.3.cmml">
         O
        </mi>
        <mo id="S3.SS3.p1.5.m5.2.2.2" lspace="0em" rspace="0em" xref="S3.SS3.p1.5.m5.2.2.2.cmml">
         ​
        </mo>
        <mrow id="S3.SS3.p1.5.m5.2.2.1.1" xref="S3.SS3.p1.5.m5.2.2.cmml">
         <mo id="S3.SS3.p1.5.m5.2.2.1.1.2" stretchy="false" xref="S3.SS3.p1.5.m5.2.2.cmml">
          (
         </mo>
         <mrow id="S3.SS3.p1.5.m5.2.2.1.1.1.2" xref="S3.SS3.p1.5.m5.2.2.1.1.1.1.cmml">
          <mo id="S3.SS3.p1.5.m5.2.2.1.1.1.2.1" stretchy="false" xref="S3.SS3.p1.5.m5.2.2.1.1.1.1.1.cmml">
           |
          </mo>
          <mi class="ltx_font_mathcaligraphic" id="S3.SS3.p1.5.m5.1.1" xref="S3.SS3.p1.5.m5.1.1.cmml">
           𝒱
          </mi>
          <mo id="S3.SS3.p1.5.m5.2.2.1.1.1.2.2" stretchy="false" xref="S3.SS3.p1.5.m5.2.2.1.1.1.1.1.cmml">
           |
          </mo>
         </mrow>
         <mo id="S3.SS3.p1.5.m5.2.2.1.1.3" stretchy="false" xref="S3.SS3.p1.5.m5.2.2.cmml">
          )
         </mo>
        </mrow>
       </mrow>
       <annotation-xml encoding="MathML-Content" id="S3.SS3.p1.5.m5.2b">
        <apply id="S3.SS3.p1.5.m5.2.2.cmml" xref="S3.SS3.p1.5.m5.2.2">
         <times id="S3.SS3.p1.5.m5.2.2.2.cmml" xref="S3.SS3.p1.5.m5.2.2.2">
         </times>
         <ci id="S3.SS3.p1.5.m5.2.2.3.cmml" xref="S3.SS3.p1.5.m5.2.2.3">
          𝑂
         </ci>
         <apply id="S3.SS3.p1.5.m5.2.2.1.1.1.1.cmml" xref="S3.SS3.p1.5.m5.2.2.1.1.1.2">
          <abs id="S3.SS3.p1.5.m5.2.2.1.1.1.1.1.cmml" xref="S3.SS3.p1.5.m5.2.2.1.1.1.2.1">
          </abs>
          <ci id="S3.SS3.p1.5.m5.1.1.cmml" xref="S3.SS3.p1.5.m5.1.1">
           𝒱
          </ci>
         </apply>
        </apply>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="S3.SS3.p1.5.m5.2c">
        O(|\mathcal{V}|)
       </annotation>
      </semantics>
     </math>
     , the action space will experience an exponential explosion as the length of the context increases:
     <math alttext="\mathcal{|A|}=O(|\mathcal{V}|^{l})" class="ltx_Math" display="inline" id="S3.SS3.p1.6.m6.3">
      <semantics id="S3.SS3.p1.6.m6.3a">
       <mrow id="S3.SS3.p1.6.m6.3.3" xref="S3.SS3.p1.6.m6.3.3.cmml">
        <mrow id="S3.SS3.p1.6.m6.3.3.3.2" xref="S3.SS3.p1.6.m6.3.3.3.1.cmml">
         <mo id="S3.SS3.p1.6.m6.3.3.3.2.1" stretchy="false" xref="S3.SS3.p1.6.m6.3.3.3.1.1.cmml">
          |
         </mo>
         <mi class="ltx_font_mathcaligraphic" id="S3.SS3.p1.6.m6.1.1" xref="S3.SS3.p1.6.m6.1.1.cmml">
          𝒜
         </mi>
         <mo id="S3.SS3.p1.6.m6.3.3.3.2.2" stretchy="false" xref="S3.SS3.p1.6.m6.3.3.3.1.1.cmml">
          |
         </mo>
        </mrow>
        <mo id="S3.SS3.p1.6.m6.3.3.2" xref="S3.SS3.p1.6.m6.3.3.2.cmml">
         =
        </mo>
        <mrow id="S3.SS3.p1.6.m6.3.3.1" xref="S3.SS3.p1.6.m6.3.3.1.cmml">
         <mi id="S3.SS3.p1.6.m6.3.3.1.3" xref="S3.SS3.p1.6.m6.3.3.1.3.cmml">
          O
         </mi>
         <mo id="S3.SS3.p1.6.m6.3.3.1.2" lspace="0em" rspace="0em" xref="S3.SS3.p1.6.m6.3.3.1.2.cmml">
          ​
         </mo>
         <mrow id="S3.SS3.p1.6.m6.3.3.1.1.1" xref="S3.SS3.p1.6.m6.3.3.1.1.1.1.cmml">
          <mo id="S3.SS3.p1.6.m6.3.3.1.1.1.2" stretchy="false" xref="S3.SS3.p1.6.m6.3.3.1.1.1.1.cmml">
           (
          </mo>
          <msup id="S3.SS3.p1.6.m6.3.3.1.1.1.1" xref="S3.SS3.p1.6.m6.3.3.1.1.1.1.cmml">
           <mrow id="S3.SS3.p1.6.m6.3.3.1.1.1.1.2.2" xref="S3.SS3.p1.6.m6.3.3.1.1.1.1.2.1.cmml">
            <mo id="S3.SS3.p1.6.m6.3.3.1.1.1.1.2.2.1" stretchy="false" xref="S3.SS3.p1.6.m6.3.3.1.1.1.1.2.1.1.cmml">
             |
            </mo>
            <mi class="ltx_font_mathcaligraphic" id="S3.SS3.p1.6.m6.2.2" xref="S3.SS3.p1.6.m6.2.2.cmml">
             𝒱
            </mi>
            <mo id="S3.SS3.p1.6.m6.3.3.1.1.1.1.2.2.2" stretchy="false" xref="S3.SS3.p1.6.m6.3.3.1.1.1.1.2.1.1.cmml">
             |
            </mo>
           </mrow>
           <mi id="S3.SS3.p1.6.m6.3.3.1.1.1.1.3" xref="S3.SS3.p1.6.m6.3.3.1.1.1.1.3.cmml">
            l
           </mi>
          </msup>
          <mo id="S3.SS3.p1.6.m6.3.3.1.1.1.3" stretchy="false" xref="S3.SS3.p1.6.m6.3.3.1.1.1.1.cmml">
           )
          </mo>
         </mrow>
        </mrow>
       </mrow>
       <annotation-xml encoding="MathML-Content" id="S3.SS3.p1.6.m6.3b">
        <apply id="S3.SS3.p1.6.m6.3.3.cmml" xref="S3.SS3.p1.6.m6.3.3">
         <eq id="S3.SS3.p1.6.m6.3.3.2.cmml" xref="S3.SS3.p1.6.m6.3.3.2">
         </eq>
         <apply id="S3.SS3.p1.6.m6.3.3.3.1.cmml" xref="S3.SS3.p1.6.m6.3.3.3.2">
          <abs id="S3.SS3.p1.6.m6.3.3.3.1.1.cmml" xref="S3.SS3.p1.6.m6.3.3.3.2.1">
          </abs>
          <ci id="S3.SS3.p1.6.m6.1.1.cmml" xref="S3.SS3.p1.6.m6.1.1">
           𝒜
          </ci>
         </apply>
         <apply id="S3.SS3.p1.6.m6.3.3.1.cmml" xref="S3.SS3.p1.6.m6.3.3.1">
          <times id="S3.SS3.p1.6.m6.3.3.1.2.cmml" xref="S3.SS3.p1.6.m6.3.3.1.2">
          </times>
          <ci id="S3.SS3.p1.6.m6.3.3.1.3.cmml" xref="S3.SS3.p1.6.m6.3.3.1.3">
           𝑂
          </ci>
          <apply id="S3.SS3.p1.6.m6.3.3.1.1.1.1.cmml" xref="S3.SS3.p1.6.m6.3.3.1.1.1">
           <csymbol cd="ambiguous" id="S3.SS3.p1.6.m6.3.3.1.1.1.1.1.cmml" xref="S3.SS3.p1.6.m6.3.3.1.1.1">
            superscript
           </csymbol>
           <apply id="S3.SS3.p1.6.m6.3.3.1.1.1.1.2.1.cmml" xref="S3.SS3.p1.6.m6.3.3.1.1.1.1.2.2">
            <abs id="S3.SS3.p1.6.m6.3.3.1.1.1.1.2.1.1.cmml" xref="S3.SS3.p1.6.m6.3.3.1.1.1.1.2.2.1">
            </abs>
            <ci id="S3.SS3.p1.6.m6.2.2.cmml" xref="S3.SS3.p1.6.m6.2.2">
             𝒱
            </ci>
           </apply>
           <ci id="S3.SS3.p1.6.m6.3.3.1.1.1.1.3.cmml" xref="S3.SS3.p1.6.m6.3.3.1.1.1.1.3">
            𝑙
           </ci>
          </apply>
         </apply>
        </apply>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="S3.SS3.p1.6.m6.3c">
        \mathcal{|A|}=O(|\mathcal{V}|^{l})
       </annotation>
      </semantics>
     </math>
     , where
     <math alttext="l" class="ltx_Math" display="inline" id="S3.SS3.p1.7.m7.1">
      <semantics id="S3.SS3.p1.7.m7.1a">
       <mi id="S3.SS3.p1.7.m7.1.1" xref="S3.SS3.p1.7.m7.1.1.cmml">
        l
       </mi>
       <annotation-xml encoding="MathML-Content" id="S3.SS3.p1.7.m7.1b">
        <ci id="S3.SS3.p1.7.m7.1.1.cmml" xref="S3.SS3.p1.7.m7.1.1">
         𝑙
        </ci>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="S3.SS3.p1.7.m7.1c">
        l
       </annotation>
      </semantics>
     </math>
     is the context length. Thus, directly optimizing for the entire action shown in Equation
     <a class="ltx_ref" href="#S3.E4" title="Equation 4 ‣ 3.3 Action-Level and Token-Level Policy Optimization ‣ 3 Preliminaries ‣ Entropy-Regularized Token-Level Policy Optimization for Large Language Models">
      <span class="ltx_text ltx_ref_tag">
       4
      </span>
     </a>
     needs to explore an enormous action space, e.g.
     <math alttext="|\mathcal{V}|=32016" class="ltx_Math" display="inline" id="S3.SS3.p1.8.m8.1">
      <semantics id="S3.SS3.p1.8.m8.1a">
       <mrow id="S3.SS3.p1.8.m8.1.2" xref="S3.SS3.p1.8.m8.1.2.cmml">
        <mrow id="S3.SS3.p1.8.m8.1.2.2.2" xref="S3.SS3.p1.8.m8.1.2.2.1.cmml">
         <mo id="S3.SS3.p1.8.m8.1.2.2.2.1" stretchy="false" xref="S3.SS3.p1.8.m8.1.2.2.1.1.cmml">
          |
         </mo>
         <mi class="ltx_font_mathcaligraphic" id="S3.SS3.p1.8.m8.1.1" xref="S3.SS3.p1.8.m8.1.1.cmml">
          𝒱
         </mi>
         <mo id="S3.SS3.p1.8.m8.1.2.2.2.2" stretchy="false" xref="S3.SS3.p1.8.m8.1.2.2.1.1.cmml">
          |
         </mo>
        </mrow>
        <mo id="S3.SS3.p1.8.m8.1.2.1" xref="S3.SS3.p1.8.m8.1.2.1.cmml">
         =
        </mo>
        <mn id="S3.SS3.p1.8.m8.1.2.3" xref="S3.SS3.p1.8.m8.1.2.3.cmml">
         32016
        </mn>
       </mrow>
       <annotation-xml encoding="MathML-Content" id="S3.SS3.p1.8.m8.1b">
        <apply id="S3.SS3.p1.8.m8.1.2.cmml" xref="S3.SS3.p1.8.m8.1.2">
         <eq id="S3.SS3.p1.8.m8.1.2.1.cmml" xref="S3.SS3.p1.8.m8.1.2.1">
         </eq>
         <apply id="S3.SS3.p1.8.m8.1.2.2.1.cmml" xref="S3.SS3.p1.8.m8.1.2.2.2">
          <abs id="S3.SS3.p1.8.m8.1.2.2.1.1.cmml" xref="S3.SS3.p1.8.m8.1.2.2.2.1">
          </abs>
          <ci id="S3.SS3.p1.8.m8.1.1.cmml" xref="S3.SS3.p1.8.m8.1.1">
           𝒱
          </ci>
         </apply>
         <cn id="S3.SS3.p1.8.m8.1.2.3.cmml" type="integer" xref="S3.SS3.p1.8.m8.1.2.3">
          32016
         </cn>
        </apply>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="S3.SS3.p1.8.m8.1c">
        |\mathcal{V}|=32016
       </annotation>
      </semantics>
     </math>
     and
     <math alttext="l=256" class="ltx_Math" display="inline" id="S3.SS3.p1.9.m9.1">
      <semantics id="S3.SS3.p1.9.m9.1a">
       <mrow id="S3.SS3.p1.9.m9.1.1" xref="S3.SS3.p1.9.m9.1.1.cmml">
        <mi id="S3.SS3.p1.9.m9.1.1.2" xref="S3.SS3.p1.9.m9.1.1.2.cmml">
         l
        </mi>
        <mo id="S3.SS3.p1.9.m9.1.1.1" xref="S3.SS3.p1.9.m9.1.1.1.cmml">
         =
        </mo>
        <mn id="S3.SS3.p1.9.m9.1.1.3" xref="S3.SS3.p1.9.m9.1.1.3.cmml">
         256
        </mn>
       </mrow>
       <annotation-xml encoding="MathML-Content" id="S3.SS3.p1.9.m9.1b">
        <apply id="S3.SS3.p1.9.m9.1.1.cmml" xref="S3.SS3.p1.9.m9.1.1">
         <eq id="S3.SS3.p1.9.m9.1.1.1.cmml" xref="S3.SS3.p1.9.m9.1.1.1">
         </eq>
         <ci id="S3.SS3.p1.9.m9.1.1.2.cmml" xref="S3.SS3.p1.9.m9.1.1.2">
          𝑙
         </ci>
         <cn id="S3.SS3.p1.9.m9.1.1.3.cmml" type="integer" xref="S3.SS3.p1.9.m9.1.1.3">
          256
         </cn>
        </apply>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="S3.SS3.p1.9.m9.1c">
        l=256
       </annotation>
      </semantics>
     </math>
     in our experimental setting, and thus suffer from instability and difficulty in converging during RL fine-tuning.
    </p>
    <table class="ltx_equationgroup ltx_eqn_align ltx_eqn_table" id="A7.EGx4">
     <tbody id="S3.E4">
      <tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
       <td class="ltx_eqn_cell ltx_eqn_center_padleft">
       </td>
       <td class="ltx_td ltx_align_right ltx_eqn_cell">
        <math alttext="\displaystyle\pi(a|s)=\prod_{j=1}^{n}\pi\left(w^{j}\mid w^{1},w^{2},\ldots,w^{j-1}\right)." class="ltx_Math" display="inline" id="S3.E4.m1.2">
         <semantics id="S3.E4.m1.2a">
          <mrow id="S3.E4.m1.2.2.1" xref="S3.E4.m1.2.2.1.1.cmml">
           <mrow id="S3.E4.m1.2.2.1.1" xref="S3.E4.m1.2.2.1.1.cmml">
            <mrow id="S3.E4.m1.2.2.1.1.1" xref="S3.E4.m1.2.2.1.1.1.cmml">
             <mi id="S3.E4.m1.2.2.1.1.1.3" xref="S3.E4.m1.2.2.1.1.1.3.cmml">
              π
             </mi>
             <mo id="S3.E4.m1.2.2.1.1.1.2" lspace="0em" rspace="0em" xref="S3.E4.m1.2.2.1.1.1.2.cmml">
              ​
             </mo>
             <mrow id="S3.E4.m1.2.2.1.1.1.1.1" xref="S3.E4.m1.2.2.1.1.1.1.1.1.cmml">
              <mo id="S3.E4.m1.2.2.1.1.1.1.1.2" stretchy="false" xref="S3.E4.m1.2.2.1.1.1.1.1.1.cmml">
               (
              </mo>
              <mrow id="S3.E4.m1.2.2.1.1.1.1.1.1" xref="S3.E4.m1.2.2.1.1.1.1.1.1.cmml">
               <mi id="S3.E4.m1.2.2.1.1.1.1.1.1.2" xref="S3.E4.m1.2.2.1.1.1.1.1.1.2.cmml">
                a
               </mi>
               <mo fence="false" id="S3.E4.m1.2.2.1.1.1.1.1.1.1" xref="S3.E4.m1.2.2.1.1.1.1.1.1.1.cmml">
                |
               </mo>
               <mi id="S3.E4.m1.2.2.1.1.1.1.1.1.3" xref="S3.E4.m1.2.2.1.1.1.1.1.1.3.cmml">
                s
               </mi>
              </mrow>
              <mo id="S3.E4.m1.2.2.1.1.1.1.1.3" stretchy="false" xref="S3.E4.m1.2.2.1.1.1.1.1.1.cmml">
               )
              </mo>
             </mrow>
            </mrow>
            <mo id="S3.E4.m1.2.2.1.1.3" xref="S3.E4.m1.2.2.1.1.3.cmml">
             =
            </mo>
            <mrow id="S3.E4.m1.2.2.1.1.2" xref="S3.E4.m1.2.2.1.1.2.cmml">
             <mstyle displaystyle="true" id="S3.E4.m1.2.2.1.1.2.2" xref="S3.E4.m1.2.2.1.1.2.2.cmml">
              <munderover id="S3.E4.m1.2.2.1.1.2.2a" xref="S3.E4.m1.2.2.1.1.2.2.cmml">
               <mo id="S3.E4.m1.2.2.1.1.2.2.2.2" movablelimits="false" xref="S3.E4.m1.2.2.1.1.2.2.2.2.cmml">
                ∏
               </mo>
               <mrow id="S3.E4.m1.2.2.1.1.2.2.2.3" xref="S3.E4.m1.2.2.1.1.2.2.2.3.cmml">
                <mi id="S3.E4.m1.2.2.1.1.2.2.2.3.2" xref="S3.E4.m1.2.2.1.1.2.2.2.3.2.cmml">
                 j
                </mi>
                <mo id="S3.E4.m1.2.2.1.1.2.2.2.3.1" xref="S3.E4.m1.2.2.1.1.2.2.2.3.1.cmml">
                 =
                </mo>
                <mn id="S3.E4.m1.2.2.1.1.2.2.2.3.3" xref="S3.E4.m1.2.2.1.1.2.2.2.3.3.cmml">
                 1
                </mn>
               </mrow>
               <mi id="S3.E4.m1.2.2.1.1.2.2.3" xref="S3.E4.m1.2.2.1.1.2.2.3.cmml">
                n
               </mi>
              </munderover>
             </mstyle>
             <mrow id="S3.E4.m1.2.2.1.1.2.1" xref="S3.E4.m1.2.2.1.1.2.1.cmml">
              <mi id="S3.E4.m1.2.2.1.1.2.1.3" xref="S3.E4.m1.2.2.1.1.2.1.3.cmml">
               π
              </mi>
              <mo id="S3.E4.m1.2.2.1.1.2.1.2" lspace="0em" rspace="0em" xref="S3.E4.m1.2.2.1.1.2.1.2.cmml">
               ​
              </mo>
              <mrow id="S3.E4.m1.2.2.1.1.2.1.1.1" xref="S3.E4.m1.2.2.1.1.2.1.1.1.1.cmml">
               <mo id="S3.E4.m1.2.2.1.1.2.1.1.1.2" xref="S3.E4.m1.2.2.1.1.2.1.1.1.1.cmml">
                (
               </mo>
               <mrow id="S3.E4.m1.2.2.1.1.2.1.1.1.1" xref="S3.E4.m1.2.2.1.1.2.1.1.1.1.cmml">
                <msup id="S3.E4.m1.2.2.1.1.2.1.1.1.1.5" xref="S3.E4.m1.2.2.1.1.2.1.1.1.1.5.cmml">
                 <mi id="S3.E4.m1.2.2.1.1.2.1.1.1.1.5.2" xref="S3.E4.m1.2.2.1.1.2.1.1.1.1.5.2.cmml">
                  w
                 </mi>
                 <mi id="S3.E4.m1.2.2.1.1.2.1.1.1.1.5.3" xref="S3.E4.m1.2.2.1.1.2.1.1.1.1.5.3.cmml">
                  j
                 </mi>
                </msup>
                <mo id="S3.E4.m1.2.2.1.1.2.1.1.1.1.4" xref="S3.E4.m1.2.2.1.1.2.1.1.1.1.4.cmml">
                 ∣
                </mo>
                <mrow id="S3.E4.m1.2.2.1.1.2.1.1.1.1.3.3" xref="S3.E4.m1.2.2.1.1.2.1.1.1.1.3.4.cmml">
                 <msup id="S3.E4.m1.2.2.1.1.2.1.1.1.1.1.1.1" xref="S3.E4.m1.2.2.1.1.2.1.1.1.1.1.1.1.cmml">
                  <mi id="S3.E4.m1.2.2.1.1.2.1.1.1.1.1.1.1.2" xref="S3.E4.m1.2.2.1.1.2.1.1.1.1.1.1.1.2.cmml">
                   w
                  </mi>
                  <mn id="S3.E4.m1.2.2.1.1.2.1.1.1.1.1.1.1.3" xref="S3.E4.m1.2.2.1.1.2.1.1.1.1.1.1.1.3.cmml">
                   1
                  </mn>
                 </msup>
                 <mo id="S3.E4.m1.2.2.1.1.2.1.1.1.1.3.3.4" xref="S3.E4.m1.2.2.1.1.2.1.1.1.1.3.4.cmml">
                  ,
                 </mo>
                 <msup id="S3.E4.m1.2.2.1.1.2.1.1.1.1.2.2.2" xref="S3.E4.m1.2.2.1.1.2.1.1.1.1.2.2.2.cmml">
                  <mi id="S3.E4.m1.2.2.1.1.2.1.1.1.1.2.2.2.2" xref="S3.E4.m1.2.2.1.1.2.1.1.1.1.2.2.2.2.cmml">
                   w
                  </mi>
                  <mn id="S3.E4.m1.2.2.1.1.2.1.1.1.1.2.2.2.3" xref="S3.E4.m1.2.2.1.1.2.1.1.1.1.2.2.2.3.cmml">
                   2
                  </mn>
                 </msup>
                 <mo id="S3.E4.m1.2.2.1.1.2.1.1.1.1.3.3.5" xref="S3.E4.m1.2.2.1.1.2.1.1.1.1.3.4.cmml">
                  ,
                 </mo>
                 <mi id="S3.E4.m1.1.1" mathvariant="normal" xref="S3.E4.m1.1.1.cmml">
                  …
                 </mi>
                 <mo id="S3.E4.m1.2.2.1.1.2.1.1.1.1.3.3.6" xref="S3.E4.m1.2.2.1.1.2.1.1.1.1.3.4.cmml">
                  ,
                 </mo>
                 <msup id="S3.E4.m1.2.2.1.1.2.1.1.1.1.3.3.3" xref="S3.E4.m1.2.2.1.1.2.1.1.1.1.3.3.3.cmml">
                  <mi id="S3.E4.m1.2.2.1.1.2.1.1.1.1.3.3.3.2" xref="S3.E4.m1.2.2.1.1.2.1.1.1.1.3.3.3.2.cmml">
                   w
                  </mi>
                  <mrow id="S3.E4.m1.2.2.1.1.2.1.1.1.1.3.3.3.3" xref="S3.E4.m1.2.2.1.1.2.1.1.1.1.3.3.3.3.cmml">
                   <mi id="S3.E4.m1.2.2.1.1.2.1.1.1.1.3.3.3.3.2" xref="S3.E4.m1.2.2.1.1.2.1.1.1.1.3.3.3.3.2.cmml">
                    j
                   </mi>
                   <mo id="S3.E4.m1.2.2.1.1.2.1.1.1.1.3.3.3.3.1" xref="S3.E4.m1.2.2.1.1.2.1.1.1.1.3.3.3.3.1.cmml">
                    −
                   </mo>
                   <mn id="S3.E4.m1.2.2.1.1.2.1.1.1.1.3.3.3.3.3" xref="S3.E4.m1.2.2.1.1.2.1.1.1.1.3.3.3.3.3.cmml">
                    1
                   </mn>
                  </mrow>
                 </msup>
                </mrow>
               </mrow>
               <mo id="S3.E4.m1.2.2.1.1.2.1.1.1.3" xref="S3.E4.m1.2.2.1.1.2.1.1.1.1.cmml">
                )
               </mo>
              </mrow>
             </mrow>
            </mrow>
           </mrow>
           <mo id="S3.E4.m1.2.2.1.2" lspace="0em" xref="S3.E4.m1.2.2.1.1.cmml">
            .
           </mo>
          </mrow>
          <annotation-xml encoding="MathML-Content" id="S3.E4.m1.2b">
           <apply id="S3.E4.m1.2.2.1.1.cmml" xref="S3.E4.m1.2.2.1">
            <eq id="S3.E4.m1.2.2.1.1.3.cmml" xref="S3.E4.m1.2.2.1.1.3">
            </eq>
            <apply id="S3.E4.m1.2.2.1.1.1.cmml" xref="S3.E4.m1.2.2.1.1.1">
             <times id="S3.E4.m1.2.2.1.1.1.2.cmml" xref="S3.E4.m1.2.2.1.1.1.2">
             </times>
             <ci id="S3.E4.m1.2.2.1.1.1.3.cmml" xref="S3.E4.m1.2.2.1.1.1.3">
              𝜋
             </ci>
             <apply id="S3.E4.m1.2.2.1.1.1.1.1.1.cmml" xref="S3.E4.m1.2.2.1.1.1.1.1">
              <csymbol cd="latexml" id="S3.E4.m1.2.2.1.1.1.1.1.1.1.cmml" xref="S3.E4.m1.2.2.1.1.1.1.1.1.1">
               conditional
              </csymbol>
              <ci id="S3.E4.m1.2.2.1.1.1.1.1.1.2.cmml" xref="S3.E4.m1.2.2.1.1.1.1.1.1.2">
               𝑎
              </ci>
              <ci id="S3.E4.m1.2.2.1.1.1.1.1.1.3.cmml" xref="S3.E4.m1.2.2.1.1.1.1.1.1.3">
               𝑠
              </ci>
             </apply>
            </apply>
            <apply id="S3.E4.m1.2.2.1.1.2.cmml" xref="S3.E4.m1.2.2.1.1.2">
             <apply id="S3.E4.m1.2.2.1.1.2.2.cmml" xref="S3.E4.m1.2.2.1.1.2.2">
              <csymbol cd="ambiguous" id="S3.E4.m1.2.2.1.1.2.2.1.cmml" xref="S3.E4.m1.2.2.1.1.2.2">
               superscript
              </csymbol>
              <apply id="S3.E4.m1.2.2.1.1.2.2.2.cmml" xref="S3.E4.m1.2.2.1.1.2.2">
               <csymbol cd="ambiguous" id="S3.E4.m1.2.2.1.1.2.2.2.1.cmml" xref="S3.E4.m1.2.2.1.1.2.2">
                subscript
               </csymbol>
               <csymbol cd="latexml" id="S3.E4.m1.2.2.1.1.2.2.2.2.cmml" xref="S3.E4.m1.2.2.1.1.2.2.2.2">
                product
               </csymbol>
               <apply id="S3.E4.m1.2.2.1.1.2.2.2.3.cmml" xref="S3.E4.m1.2.2.1.1.2.2.2.3">
                <eq id="S3.E4.m1.2.2.1.1.2.2.2.3.1.cmml" xref="S3.E4.m1.2.2.1.1.2.2.2.3.1">
                </eq>
                <ci id="S3.E4.m1.2.2.1.1.2.2.2.3.2.cmml" xref="S3.E4.m1.2.2.1.1.2.2.2.3.2">
                 𝑗
                </ci>
                <cn id="S3.E4.m1.2.2.1.1.2.2.2.3.3.cmml" type="integer" xref="S3.E4.m1.2.2.1.1.2.2.2.3.3">
                 1
                </cn>
               </apply>
              </apply>
              <ci id="S3.E4.m1.2.2.1.1.2.2.3.cmml" xref="S3.E4.m1.2.2.1.1.2.2.3">
               𝑛
              </ci>
             </apply>
             <apply id="S3.E4.m1.2.2.1.1.2.1.cmml" xref="S3.E4.m1.2.2.1.1.2.1">
              <times id="S3.E4.m1.2.2.1.1.2.1.2.cmml" xref="S3.E4.m1.2.2.1.1.2.1.2">
              </times>
              <ci id="S3.E4.m1.2.2.1.1.2.1.3.cmml" xref="S3.E4.m1.2.2.1.1.2.1.3">
               𝜋
              </ci>
              <apply id="S3.E4.m1.2.2.1.1.2.1.1.1.1.cmml" xref="S3.E4.m1.2.2.1.1.2.1.1.1">
               <csymbol cd="latexml" id="S3.E4.m1.2.2.1.1.2.1.1.1.1.4.cmml" xref="S3.E4.m1.2.2.1.1.2.1.1.1.1.4">
                conditional
               </csymbol>
               <apply id="S3.E4.m1.2.2.1.1.2.1.1.1.1.5.cmml" xref="S3.E4.m1.2.2.1.1.2.1.1.1.1.5">
                <csymbol cd="ambiguous" id="S3.E4.m1.2.2.1.1.2.1.1.1.1.5.1.cmml" xref="S3.E4.m1.2.2.1.1.2.1.1.1.1.5">
                 superscript
                </csymbol>
                <ci id="S3.E4.m1.2.2.1.1.2.1.1.1.1.5.2.cmml" xref="S3.E4.m1.2.2.1.1.2.1.1.1.1.5.2">
                 𝑤
                </ci>
                <ci id="S3.E4.m1.2.2.1.1.2.1.1.1.1.5.3.cmml" xref="S3.E4.m1.2.2.1.1.2.1.1.1.1.5.3">
                 𝑗
                </ci>
               </apply>
               <list id="S3.E4.m1.2.2.1.1.2.1.1.1.1.3.4.cmml" xref="S3.E4.m1.2.2.1.1.2.1.1.1.1.3.3">
                <apply id="S3.E4.m1.2.2.1.1.2.1.1.1.1.1.1.1.cmml" xref="S3.E4.m1.2.2.1.1.2.1.1.1.1.1.1.1">
                 <csymbol cd="ambiguous" id="S3.E4.m1.2.2.1.1.2.1.1.1.1.1.1.1.1.cmml" xref="S3.E4.m1.2.2.1.1.2.1.1.1.1.1.1.1">
                  superscript
                 </csymbol>
                 <ci id="S3.E4.m1.2.2.1.1.2.1.1.1.1.1.1.1.2.cmml" xref="S3.E4.m1.2.2.1.1.2.1.1.1.1.1.1.1.2">
                  𝑤
                 </ci>
                 <cn id="S3.E4.m1.2.2.1.1.2.1.1.1.1.1.1.1.3.cmml" type="integer" xref="S3.E4.m1.2.2.1.1.2.1.1.1.1.1.1.1.3">
                  1
                 </cn>
                </apply>
                <apply id="S3.E4.m1.2.2.1.1.2.1.1.1.1.2.2.2.cmml" xref="S3.E4.m1.2.2.1.1.2.1.1.1.1.2.2.2">
                 <csymbol cd="ambiguous" id="S3.E4.m1.2.2.1.1.2.1.1.1.1.2.2.2.1.cmml" xref="S3.E4.m1.2.2.1.1.2.1.1.1.1.2.2.2">
                  superscript
                 </csymbol>
                 <ci id="S3.E4.m1.2.2.1.1.2.1.1.1.1.2.2.2.2.cmml" xref="S3.E4.m1.2.2.1.1.2.1.1.1.1.2.2.2.2">
                  𝑤
                 </ci>
                 <cn id="S3.E4.m1.2.2.1.1.2.1.1.1.1.2.2.2.3.cmml" type="integer" xref="S3.E4.m1.2.2.1.1.2.1.1.1.1.2.2.2.3">
                  2
                 </cn>
                </apply>
                <ci id="S3.E4.m1.1.1.cmml" xref="S3.E4.m1.1.1">
                 …
                </ci>
                <apply id="S3.E4.m1.2.2.1.1.2.1.1.1.1.3.3.3.cmml" xref="S3.E4.m1.2.2.1.1.2.1.1.1.1.3.3.3">
                 <csymbol cd="ambiguous" id="S3.E4.m1.2.2.1.1.2.1.1.1.1.3.3.3.1.cmml" xref="S3.E4.m1.2.2.1.1.2.1.1.1.1.3.3.3">
                  superscript
                 </csymbol>
                 <ci id="S3.E4.m1.2.2.1.1.2.1.1.1.1.3.3.3.2.cmml" xref="S3.E4.m1.2.2.1.1.2.1.1.1.1.3.3.3.2">
                  𝑤
                 </ci>
                 <apply id="S3.E4.m1.2.2.1.1.2.1.1.1.1.3.3.3.3.cmml" xref="S3.E4.m1.2.2.1.1.2.1.1.1.1.3.3.3.3">
                  <minus id="S3.E4.m1.2.2.1.1.2.1.1.1.1.3.3.3.3.1.cmml" xref="S3.E4.m1.2.2.1.1.2.1.1.1.1.3.3.3.3.1">
                  </minus>
                  <ci id="S3.E4.m1.2.2.1.1.2.1.1.1.1.3.3.3.3.2.cmml" xref="S3.E4.m1.2.2.1.1.2.1.1.1.1.3.3.3.3.2">
                   𝑗
                  </ci>
                  <cn id="S3.E4.m1.2.2.1.1.2.1.1.1.1.3.3.3.3.3.cmml" type="integer" xref="S3.E4.m1.2.2.1.1.2.1.1.1.1.3.3.3.3.3">
                   1
                  </cn>
                 </apply>
                </apply>
               </list>
              </apply>
             </apply>
            </apply>
           </apply>
          </annotation-xml>
          <annotation encoding="application/x-tex" id="S3.E4.m1.2c">
           \displaystyle\pi(a|s)=\prod_{j=1}^{n}\pi\left(w^{j}\mid w^{1},w^{2},\ldots,w^{j-1}\right).
          </annotation>
         </semantics>
        </math>
       </td>
       <td class="ltx_eqn_cell ltx_eqn_center_padright">
       </td>
       <td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1">
        <span class="ltx_tag ltx_tag_equation ltx_align_right">
         (4)
        </span>
       </td>
      </tr>
     </tbody>
    </table>
    <p class="ltx_p" id="S3.SS3.p1.10">
     Besides, a reward signal is obtained after executing a complete action, which is too sparse to provide fine-grained supervision for each token. Applying it to all tokens within an action as Equation
     <a class="ltx_ref" href="#S3.E5" title="Equation 5 ‣ 3.3 Action-Level and Token-Level Policy Optimization ‣ 3 Preliminaries ‣ Entropy-Regularized Token-Level Policy Optimization for Large Language Models">
      <span class="ltx_text ltx_ref_tag">
       5
      </span>
     </a>
     might lead to a misalignment between token generation and action performance, where each token holds different importance in expressing the overall meaning and effectiveness of an action
     <cite class="ltx_cite ltx_citemacro_citep">
      (Chen et al.,
      <a class="ltx_ref" href="#bib.bib4" title="">
       2024
      </a>
      )
     </cite>
     .
    </p>
    <table class="ltx_equationgroup ltx_eqn_align ltx_eqn_table" id="A7.EGx5">
     <tbody id="S3.E5">
      <tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
       <td class="ltx_eqn_cell ltx_eqn_center_padleft">
       </td>
       <td class="ltx_td ltx_align_right ltx_eqn_cell">
        <math alttext="\displaystyle Q(s_{t},w_{t}^{1:j-1},w_{t}^{j})\leftarrow Q(s_{t},a_{t}),~{}\forall j=1,\dots,|a_{t}|." class="ltx_Math" display="inline" id="S3.E5.m1.3">
         <semantics id="S3.E5.m1.3a">
          <mrow id="S3.E5.m1.3.3.1">
           <mrow id="S3.E5.m1.3.3.1.1.2" xref="S3.E5.m1.3.3.1.1.3.cmml">
            <mrow id="S3.E5.m1.3.3.1.1.1.1" xref="S3.E5.m1.3.3.1.1.1.1.cmml">
             <mrow id="S3.E5.m1.3.3.1.1.1.1.3" xref="S3.E5.m1.3.3.1.1.1.1.3.cmml">
              <mi id="S3.E5.m1.3.3.1.1.1.1.3.5" xref="S3.E5.m1.3.3.1.1.1.1.3.5.cmml">
               Q
              </mi>
              <mo id="S3.E5.m1.3.3.1.1.1.1.3.4" lspace="0em" rspace="0em" xref="S3.E5.m1.3.3.1.1.1.1.3.4.cmml">
               ​
              </mo>
              <mrow id="S3.E5.m1.3.3.1.1.1.1.3.3.3" xref="S3.E5.m1.3.3.1.1.1.1.3.3.4.cmml">
               <mo id="S3.E5.m1.3.3.1.1.1.1.3.3.3.4" stretchy="false" xref="S3.E5.m1.3.3.1.1.1.1.3.3.4.cmml">
                (
               </mo>
               <msub id="S3.E5.m1.3.3.1.1.1.1.1.1.1.1" xref="S3.E5.m1.3.3.1.1.1.1.1.1.1.1.cmml">
                <mi id="S3.E5.m1.3.3.1.1.1.1.1.1.1.1.2" xref="S3.E5.m1.3.3.1.1.1.1.1.1.1.1.2.cmml">
                 s
                </mi>
                <mi id="S3.E5.m1.3.3.1.1.1.1.1.1.1.1.3" xref="S3.E5.m1.3.3.1.1.1.1.1.1.1.1.3.cmml">
                 t
                </mi>
               </msub>
               <mo id="S3.E5.m1.3.3.1.1.1.1.3.3.3.5" xref="S3.E5.m1.3.3.1.1.1.1.3.3.4.cmml">
                ,
               </mo>
               <msubsup id="S3.E5.m1.3.3.1.1.1.1.2.2.2.2" xref="S3.E5.m1.3.3.1.1.1.1.2.2.2.2.cmml">
                <mi id="S3.E5.m1.3.3.1.1.1.1.2.2.2.2.2.2" xref="S3.E5.m1.3.3.1.1.1.1.2.2.2.2.2.2.cmml">
                 w
                </mi>
                <mi id="S3.E5.m1.3.3.1.1.1.1.2.2.2.2.2.3" xref="S3.E5.m1.3.3.1.1.1.1.2.2.2.2.2.3.cmml">
                 t
                </mi>
                <mrow id="S3.E5.m1.3.3.1.1.1.1.2.2.2.2.3" xref="S3.E5.m1.3.3.1.1.1.1.2.2.2.2.3.cmml">
                 <mn id="S3.E5.m1.3.3.1.1.1.1.2.2.2.2.3.2" xref="S3.E5.m1.3.3.1.1.1.1.2.2.2.2.3.2.cmml">
                  1
                 </mn>
                 <mo id="S3.E5.m1.3.3.1.1.1.1.2.2.2.2.3.1" lspace="0.278em" rspace="0.278em" xref="S3.E5.m1.3.3.1.1.1.1.2.2.2.2.3.1.cmml">
                  :
                 </mo>
                 <mrow id="S3.E5.m1.3.3.1.1.1.1.2.2.2.2.3.3" xref="S3.E5.m1.3.3.1.1.1.1.2.2.2.2.3.3.cmml">
                  <mi id="S3.E5.m1.3.3.1.1.1.1.2.2.2.2.3.3.2" xref="S3.E5.m1.3.3.1.1.1.1.2.2.2.2.3.3.2.cmml">
                   j
                  </mi>
                  <mo id="S3.E5.m1.3.3.1.1.1.1.2.2.2.2.3.3.1" xref="S3.E5.m1.3.3.1.1.1.1.2.2.2.2.3.3.1.cmml">
                   −
                  </mo>
                  <mn id="S3.E5.m1.3.3.1.1.1.1.2.2.2.2.3.3.3" xref="S3.E5.m1.3.3.1.1.1.1.2.2.2.2.3.3.3.cmml">
                   1
                  </mn>
                 </mrow>
                </mrow>
               </msubsup>
               <mo id="S3.E5.m1.3.3.1.1.1.1.3.3.3.6" xref="S3.E5.m1.3.3.1.1.1.1.3.3.4.cmml">
                ,
               </mo>
               <msubsup id="S3.E5.m1.3.3.1.1.1.1.3.3.3.3" xref="S3.E5.m1.3.3.1.1.1.1.3.3.3.3.cmml">
                <mi id="S3.E5.m1.3.3.1.1.1.1.3.3.3.3.2.2" xref="S3.E5.m1.3.3.1.1.1.1.3.3.3.3.2.2.cmml">
                 w
                </mi>
                <mi id="S3.E5.m1.3.3.1.1.1.1.3.3.3.3.2.3" xref="S3.E5.m1.3.3.1.1.1.1.3.3.3.3.2.3.cmml">
                 t
                </mi>
                <mi id="S3.E5.m1.3.3.1.1.1.1.3.3.3.3.3" xref="S3.E5.m1.3.3.1.1.1.1.3.3.3.3.3.cmml">
                 j
                </mi>
               </msubsup>
               <mo id="S3.E5.m1.3.3.1.1.1.1.3.3.3.7" stretchy="false" xref="S3.E5.m1.3.3.1.1.1.1.3.3.4.cmml">
                )
               </mo>
              </mrow>
             </mrow>
             <mo id="S3.E5.m1.3.3.1.1.1.1.6" stretchy="false" xref="S3.E5.m1.3.3.1.1.1.1.6.cmml">
              ←
             </mo>
             <mrow id="S3.E5.m1.3.3.1.1.1.1.5" xref="S3.E5.m1.3.3.1.1.1.1.5.cmml">
              <mi id="S3.E5.m1.3.3.1.1.1.1.5.4" xref="S3.E5.m1.3.3.1.1.1.1.5.4.cmml">
               Q
              </mi>
              <mo id="S3.E5.m1.3.3.1.1.1.1.5.3" lspace="0em" rspace="0em" xref="S3.E5.m1.3.3.1.1.1.1.5.3.cmml">
               ​
              </mo>
              <mrow id="S3.E5.m1.3.3.1.1.1.1.5.2.2" xref="S3.E5.m1.3.3.1.1.1.1.5.2.3.cmml">
               <mo id="S3.E5.m1.3.3.1.1.1.1.5.2.2.3" stretchy="false" xref="S3.E5.m1.3.3.1.1.1.1.5.2.3.cmml">
                (
               </mo>
               <msub id="S3.E5.m1.3.3.1.1.1.1.4.1.1.1" xref="S3.E5.m1.3.3.1.1.1.1.4.1.1.1.cmml">
                <mi id="S3.E5.m1.3.3.1.1.1.1.4.1.1.1.2" xref="S3.E5.m1.3.3.1.1.1.1.4.1.1.1.2.cmml">
                 s
                </mi>
                <mi id="S3.E5.m1.3.3.1.1.1.1.4.1.1.1.3" xref="S3.E5.m1.3.3.1.1.1.1.4.1.1.1.3.cmml">
                 t
                </mi>
               </msub>
               <mo id="S3.E5.m1.3.3.1.1.1.1.5.2.2.4" xref="S3.E5.m1.3.3.1.1.1.1.5.2.3.cmml">
                ,
               </mo>
               <msub id="S3.E5.m1.3.3.1.1.1.1.5.2.2.2" xref="S3.E5.m1.3.3.1.1.1.1.5.2.2.2.cmml">
                <mi id="S3.E5.m1.3.3.1.1.1.1.5.2.2.2.2" xref="S3.E5.m1.3.3.1.1.1.1.5.2.2.2.2.cmml">
                 a
                </mi>
                <mi id="S3.E5.m1.3.3.1.1.1.1.5.2.2.2.3" xref="S3.E5.m1.3.3.1.1.1.1.5.2.2.2.3.cmml">
                 t
                </mi>
               </msub>
               <mo id="S3.E5.m1.3.3.1.1.1.1.5.2.2.5" stretchy="false" xref="S3.E5.m1.3.3.1.1.1.1.5.2.3.cmml">
                )
               </mo>
              </mrow>
             </mrow>
            </mrow>
            <mo id="S3.E5.m1.3.3.1.1.2.3" rspace="0.497em" xref="S3.E5.m1.3.3.1.1.3a.cmml">
             ,
            </mo>
            <mrow id="S3.E5.m1.3.3.1.1.2.2" xref="S3.E5.m1.3.3.1.1.2.2.cmml">
             <mrow id="S3.E5.m1.3.3.1.1.2.2.3" xref="S3.E5.m1.3.3.1.1.2.2.3.cmml">
              <mo id="S3.E5.m1.3.3.1.1.2.2.3.1" rspace="0.167em" xref="S3.E5.m1.3.3.1.1.2.2.3.1.cmml">
               ∀
              </mo>
              <mi id="S3.E5.m1.3.3.1.1.2.2.3.2" xref="S3.E5.m1.3.3.1.1.2.2.3.2.cmml">
               j
              </mi>
             </mrow>
             <mo id="S3.E5.m1.3.3.1.1.2.2.2" xref="S3.E5.m1.3.3.1.1.2.2.2.cmml">
              =
             </mo>
             <mrow id="S3.E5.m1.3.3.1.1.2.2.1.1" xref="S3.E5.m1.3.3.1.1.2.2.1.2.cmml">
              <mn id="S3.E5.m1.1.1" xref="S3.E5.m1.1.1.cmml">
               1
              </mn>
              <mo id="S3.E5.m1.3.3.1.1.2.2.1.1.2" xref="S3.E5.m1.3.3.1.1.2.2.1.2.cmml">
               ,
              </mo>
              <mi id="S3.E5.m1.2.2" mathvariant="normal" xref="S3.E5.m1.2.2.cmml">
               …
              </mi>
              <mo id="S3.E5.m1.3.3.1.1.2.2.1.1.3" xref="S3.E5.m1.3.3.1.1.2.2.1.2.cmml">
               ,
              </mo>
              <mrow id="S3.E5.m1.3.3.1.1.2.2.1.1.1.1" xref="S3.E5.m1.3.3.1.1.2.2.1.1.1.2.cmml">
               <mo id="S3.E5.m1.3.3.1.1.2.2.1.1.1.1.2" stretchy="false" xref="S3.E5.m1.3.3.1.1.2.2.1.1.1.2.1.cmml">
                |
               </mo>
               <msub id="S3.E5.m1.3.3.1.1.2.2.1.1.1.1.1" xref="S3.E5.m1.3.3.1.1.2.2.1.1.1.1.1.cmml">
                <mi id="S3.E5.m1.3.3.1.1.2.2.1.1.1.1.1.2" xref="S3.E5.m1.3.3.1.1.2.2.1.1.1.1.1.2.cmml">
                 a
                </mi>
                <mi id="S3.E5.m1.3.3.1.1.2.2.1.1.1.1.1.3" xref="S3.E5.m1.3.3.1.1.2.2.1.1.1.1.1.3.cmml">
                 t
                </mi>
               </msub>
               <mo id="S3.E5.m1.3.3.1.1.2.2.1.1.1.1.3" stretchy="false" xref="S3.E5.m1.3.3.1.1.2.2.1.1.1.2.1.cmml">
                |
               </mo>
              </mrow>
             </mrow>
            </mrow>
           </mrow>
           <mo id="S3.E5.m1.3.3.1.2" lspace="0em">
            .
           </mo>
          </mrow>
          <annotation-xml encoding="MathML-Content" id="S3.E5.m1.3b">
           <apply id="S3.E5.m1.3.3.1.1.3.cmml" xref="S3.E5.m1.3.3.1.1.2">
            <csymbol cd="ambiguous" id="S3.E5.m1.3.3.1.1.3a.cmml" xref="S3.E5.m1.3.3.1.1.2.3">
             formulae-sequence
            </csymbol>
            <apply id="S3.E5.m1.3.3.1.1.1.1.cmml" xref="S3.E5.m1.3.3.1.1.1.1">
             <ci id="S3.E5.m1.3.3.1.1.1.1.6.cmml" xref="S3.E5.m1.3.3.1.1.1.1.6">
              ←
             </ci>
             <apply id="S3.E5.m1.3.3.1.1.1.1.3.cmml" xref="S3.E5.m1.3.3.1.1.1.1.3">
              <times id="S3.E5.m1.3.3.1.1.1.1.3.4.cmml" xref="S3.E5.m1.3.3.1.1.1.1.3.4">
              </times>
              <ci id="S3.E5.m1.3.3.1.1.1.1.3.5.cmml" xref="S3.E5.m1.3.3.1.1.1.1.3.5">
               𝑄
              </ci>
              <vector id="S3.E5.m1.3.3.1.1.1.1.3.3.4.cmml" xref="S3.E5.m1.3.3.1.1.1.1.3.3.3">
               <apply id="S3.E5.m1.3.3.1.1.1.1.1.1.1.1.cmml" xref="S3.E5.m1.3.3.1.1.1.1.1.1.1.1">
                <csymbol cd="ambiguous" id="S3.E5.m1.3.3.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E5.m1.3.3.1.1.1.1.1.1.1.1">
                 subscript
                </csymbol>
                <ci id="S3.E5.m1.3.3.1.1.1.1.1.1.1.1.2.cmml" xref="S3.E5.m1.3.3.1.1.1.1.1.1.1.1.2">
                 𝑠
                </ci>
                <ci id="S3.E5.m1.3.3.1.1.1.1.1.1.1.1.3.cmml" xref="S3.E5.m1.3.3.1.1.1.1.1.1.1.1.3">
                 𝑡
                </ci>
               </apply>
               <apply id="S3.E5.m1.3.3.1.1.1.1.2.2.2.2.cmml" xref="S3.E5.m1.3.3.1.1.1.1.2.2.2.2">
                <csymbol cd="ambiguous" id="S3.E5.m1.3.3.1.1.1.1.2.2.2.2.1.cmml" xref="S3.E5.m1.3.3.1.1.1.1.2.2.2.2">
                 superscript
                </csymbol>
                <apply id="S3.E5.m1.3.3.1.1.1.1.2.2.2.2.2.cmml" xref="S3.E5.m1.3.3.1.1.1.1.2.2.2.2">
                 <csymbol cd="ambiguous" id="S3.E5.m1.3.3.1.1.1.1.2.2.2.2.2.1.cmml" xref="S3.E5.m1.3.3.1.1.1.1.2.2.2.2">
                  subscript
                 </csymbol>
                 <ci id="S3.E5.m1.3.3.1.1.1.1.2.2.2.2.2.2.cmml" xref="S3.E5.m1.3.3.1.1.1.1.2.2.2.2.2.2">
                  𝑤
                 </ci>
                 <ci id="S3.E5.m1.3.3.1.1.1.1.2.2.2.2.2.3.cmml" xref="S3.E5.m1.3.3.1.1.1.1.2.2.2.2.2.3">
                  𝑡
                 </ci>
                </apply>
                <apply id="S3.E5.m1.3.3.1.1.1.1.2.2.2.2.3.cmml" xref="S3.E5.m1.3.3.1.1.1.1.2.2.2.2.3">
                 <ci id="S3.E5.m1.3.3.1.1.1.1.2.2.2.2.3.1.cmml" xref="S3.E5.m1.3.3.1.1.1.1.2.2.2.2.3.1">
                  :
                 </ci>
                 <cn id="S3.E5.m1.3.3.1.1.1.1.2.2.2.2.3.2.cmml" type="integer" xref="S3.E5.m1.3.3.1.1.1.1.2.2.2.2.3.2">
                  1
                 </cn>
                 <apply id="S3.E5.m1.3.3.1.1.1.1.2.2.2.2.3.3.cmml" xref="S3.E5.m1.3.3.1.1.1.1.2.2.2.2.3.3">
                  <minus id="S3.E5.m1.3.3.1.1.1.1.2.2.2.2.3.3.1.cmml" xref="S3.E5.m1.3.3.1.1.1.1.2.2.2.2.3.3.1">
                  </minus>
                  <ci id="S3.E5.m1.3.3.1.1.1.1.2.2.2.2.3.3.2.cmml" xref="S3.E5.m1.3.3.1.1.1.1.2.2.2.2.3.3.2">
                   𝑗
                  </ci>
                  <cn id="S3.E5.m1.3.3.1.1.1.1.2.2.2.2.3.3.3.cmml" type="integer" xref="S3.E5.m1.3.3.1.1.1.1.2.2.2.2.3.3.3">
                   1
                  </cn>
                 </apply>
                </apply>
               </apply>
               <apply id="S3.E5.m1.3.3.1.1.1.1.3.3.3.3.cmml" xref="S3.E5.m1.3.3.1.1.1.1.3.3.3.3">
                <csymbol cd="ambiguous" id="S3.E5.m1.3.3.1.1.1.1.3.3.3.3.1.cmml" xref="S3.E5.m1.3.3.1.1.1.1.3.3.3.3">
                 superscript
                </csymbol>
                <apply id="S3.E5.m1.3.3.1.1.1.1.3.3.3.3.2.cmml" xref="S3.E5.m1.3.3.1.1.1.1.3.3.3.3">
                 <csymbol cd="ambiguous" id="S3.E5.m1.3.3.1.1.1.1.3.3.3.3.2.1.cmml" xref="S3.E5.m1.3.3.1.1.1.1.3.3.3.3">
                  subscript
                 </csymbol>
                 <ci id="S3.E5.m1.3.3.1.1.1.1.3.3.3.3.2.2.cmml" xref="S3.E5.m1.3.3.1.1.1.1.3.3.3.3.2.2">
                  𝑤
                 </ci>
                 <ci id="S3.E5.m1.3.3.1.1.1.1.3.3.3.3.2.3.cmml" xref="S3.E5.m1.3.3.1.1.1.1.3.3.3.3.2.3">
                  𝑡
                 </ci>
                </apply>
                <ci id="S3.E5.m1.3.3.1.1.1.1.3.3.3.3.3.cmml" xref="S3.E5.m1.3.3.1.1.1.1.3.3.3.3.3">
                 𝑗
                </ci>
               </apply>
              </vector>
             </apply>
             <apply id="S3.E5.m1.3.3.1.1.1.1.5.cmml" xref="S3.E5.m1.3.3.1.1.1.1.5">
              <times id="S3.E5.m1.3.3.1.1.1.1.5.3.cmml" xref="S3.E5.m1.3.3.1.1.1.1.5.3">
              </times>
              <ci id="S3.E5.m1.3.3.1.1.1.1.5.4.cmml" xref="S3.E5.m1.3.3.1.1.1.1.5.4">
               𝑄
              </ci>
              <interval closure="open" id="S3.E5.m1.3.3.1.1.1.1.5.2.3.cmml" xref="S3.E5.m1.3.3.1.1.1.1.5.2.2">
               <apply id="S3.E5.m1.3.3.1.1.1.1.4.1.1.1.cmml" xref="S3.E5.m1.3.3.1.1.1.1.4.1.1.1">
                <csymbol cd="ambiguous" id="S3.E5.m1.3.3.1.1.1.1.4.1.1.1.1.cmml" xref="S3.E5.m1.3.3.1.1.1.1.4.1.1.1">
                 subscript
                </csymbol>
                <ci id="S3.E5.m1.3.3.1.1.1.1.4.1.1.1.2.cmml" xref="S3.E5.m1.3.3.1.1.1.1.4.1.1.1.2">
                 𝑠
                </ci>
                <ci id="S3.E5.m1.3.3.1.1.1.1.4.1.1.1.3.cmml" xref="S3.E5.m1.3.3.1.1.1.1.4.1.1.1.3">
                 𝑡
                </ci>
               </apply>
               <apply id="S3.E5.m1.3.3.1.1.1.1.5.2.2.2.cmml" xref="S3.E5.m1.3.3.1.1.1.1.5.2.2.2">
                <csymbol cd="ambiguous" id="S3.E5.m1.3.3.1.1.1.1.5.2.2.2.1.cmml" xref="S3.E5.m1.3.3.1.1.1.1.5.2.2.2">
                 subscript
                </csymbol>
                <ci id="S3.E5.m1.3.3.1.1.1.1.5.2.2.2.2.cmml" xref="S3.E5.m1.3.3.1.1.1.1.5.2.2.2.2">
                 𝑎
                </ci>
                <ci id="S3.E5.m1.3.3.1.1.1.1.5.2.2.2.3.cmml" xref="S3.E5.m1.3.3.1.1.1.1.5.2.2.2.3">
                 𝑡
                </ci>
               </apply>
              </interval>
             </apply>
            </apply>
            <apply id="S3.E5.m1.3.3.1.1.2.2.cmml" xref="S3.E5.m1.3.3.1.1.2.2">
             <eq id="S3.E5.m1.3.3.1.1.2.2.2.cmml" xref="S3.E5.m1.3.3.1.1.2.2.2">
             </eq>
             <apply id="S3.E5.m1.3.3.1.1.2.2.3.cmml" xref="S3.E5.m1.3.3.1.1.2.2.3">
              <csymbol cd="latexml" id="S3.E5.m1.3.3.1.1.2.2.3.1.cmml" xref="S3.E5.m1.3.3.1.1.2.2.3.1">
               for-all
              </csymbol>
              <ci id="S3.E5.m1.3.3.1.1.2.2.3.2.cmml" xref="S3.E5.m1.3.3.1.1.2.2.3.2">
               𝑗
              </ci>
             </apply>
             <list id="S3.E5.m1.3.3.1.1.2.2.1.2.cmml" xref="S3.E5.m1.3.3.1.1.2.2.1.1">
              <cn id="S3.E5.m1.1.1.cmml" type="integer" xref="S3.E5.m1.1.1">
               1
              </cn>
              <ci id="S3.E5.m1.2.2.cmml" xref="S3.E5.m1.2.2">
               …
              </ci>
              <apply id="S3.E5.m1.3.3.1.1.2.2.1.1.1.2.cmml" xref="S3.E5.m1.3.3.1.1.2.2.1.1.1.1">
               <abs id="S3.E5.m1.3.3.1.1.2.2.1.1.1.2.1.cmml" xref="S3.E5.m1.3.3.1.1.2.2.1.1.1.1.2">
               </abs>
               <apply id="S3.E5.m1.3.3.1.1.2.2.1.1.1.1.1.cmml" xref="S3.E5.m1.3.3.1.1.2.2.1.1.1.1.1">
                <csymbol cd="ambiguous" id="S3.E5.m1.3.3.1.1.2.2.1.1.1.1.1.1.cmml" xref="S3.E5.m1.3.3.1.1.2.2.1.1.1.1.1">
                 subscript
                </csymbol>
                <ci id="S3.E5.m1.3.3.1.1.2.2.1.1.1.1.1.2.cmml" xref="S3.E5.m1.3.3.1.1.2.2.1.1.1.1.1.2">
                 𝑎
                </ci>
                <ci id="S3.E5.m1.3.3.1.1.2.2.1.1.1.1.1.3.cmml" xref="S3.E5.m1.3.3.1.1.2.2.1.1.1.1.1.3">
                 𝑡
                </ci>
               </apply>
              </apply>
             </list>
            </apply>
           </apply>
          </annotation-xml>
          <annotation encoding="application/x-tex" id="S3.E5.m1.3c">
           \displaystyle Q(s_{t},w_{t}^{1:j-1},w_{t}^{j})\leftarrow Q(s_{t},a_{t}),~{}\forall j=1,\dots,|a_{t}|.
          </annotation>
         </semantics>
        </math>
       </td>
       <td class="ltx_eqn_cell ltx_eqn_center_padright">
       </td>
       <td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1">
        <span class="ltx_tag ltx_tag_equation ltx_align_right">
         (5)
        </span>
       </td>
      </tr>
     </tbody>
    </table>
    <p class="ltx_p" id="S3.SS3.p1.11">
     For instance, while a language model-generated code yielding positive returns doesn’t imply that each line is beneficial, discarding certain useless or harmful segments could enhance overall outcomes, provided the algorithm identifies them during optimization.
    </p>
   </div>
   <div class="ltx_para" id="S3.SS3.p2">
    <p class="ltx_p" id="S3.SS3.p2.2">
     Inspired by the decomposition for high-dimensional continuous actions or multi-agent joint actions
     <cite class="ltx_cite ltx_citemacro_citep">
      (Chebotar et al.,
      <a class="ltx_ref" href="#bib.bib3" title="">
       2023
      </a>
      ; Wen et al.,
      <a class="ltx_ref" href="#bib.bib45" title="">
       2022
      </a>
      )
     </cite>
     , we can consider sequentially decomposing the optimization from the action level into the token level as well. While reducing the growth of action space as the length of token sequence from
     <math alttext="O(|\mathcal{V}|^{l})" class="ltx_Math" display="inline" id="S3.SS3.p2.1.m1.2">
      <semantics id="S3.SS3.p2.1.m1.2a">
       <mrow id="S3.SS3.p2.1.m1.2.2" xref="S3.SS3.p2.1.m1.2.2.cmml">
        <mi id="S3.SS3.p2.1.m1.2.2.3" xref="S3.SS3.p2.1.m1.2.2.3.cmml">
         O
        </mi>
        <mo id="S3.SS3.p2.1.m1.2.2.2" lspace="0em" rspace="0em" xref="S3.SS3.p2.1.m1.2.2.2.cmml">
         ​
        </mo>
        <mrow id="S3.SS3.p2.1.m1.2.2.1.1" xref="S3.SS3.p2.1.m1.2.2.1.1.1.cmml">
         <mo id="S3.SS3.p2.1.m1.2.2.1.1.2" stretchy="false" xref="S3.SS3.p2.1.m1.2.2.1.1.1.cmml">
          (
         </mo>
         <msup id="S3.SS3.p2.1.m1.2.2.1.1.1" xref="S3.SS3.p2.1.m1.2.2.1.1.1.cmml">
          <mrow id="S3.SS3.p2.1.m1.2.2.1.1.1.2.2" xref="S3.SS3.p2.1.m1.2.2.1.1.1.2.1.cmml">
           <mo id="S3.SS3.p2.1.m1.2.2.1.1.1.2.2.1" stretchy="false" xref="S3.SS3.p2.1.m1.2.2.1.1.1.2.1.1.cmml">
            |
           </mo>
           <mi class="ltx_font_mathcaligraphic" id="S3.SS3.p2.1.m1.1.1" xref="S3.SS3.p2.1.m1.1.1.cmml">
            𝒱
           </mi>
           <mo id="S3.SS3.p2.1.m1.2.2.1.1.1.2.2.2" stretchy="false" xref="S3.SS3.p2.1.m1.2.2.1.1.1.2.1.1.cmml">
            |
           </mo>
          </mrow>
          <mi id="S3.SS3.p2.1.m1.2.2.1.1.1.3" xref="S3.SS3.p2.1.m1.2.2.1.1.1.3.cmml">
           l
          </mi>
         </msup>
         <mo id="S3.SS3.p2.1.m1.2.2.1.1.3" stretchy="false" xref="S3.SS3.p2.1.m1.2.2.1.1.1.cmml">
          )
         </mo>
        </mrow>
       </mrow>
       <annotation-xml encoding="MathML-Content" id="S3.SS3.p2.1.m1.2b">
        <apply id="S3.SS3.p2.1.m1.2.2.cmml" xref="S3.SS3.p2.1.m1.2.2">
         <times id="S3.SS3.p2.1.m1.2.2.2.cmml" xref="S3.SS3.p2.1.m1.2.2.2">
         </times>
         <ci id="S3.SS3.p2.1.m1.2.2.3.cmml" xref="S3.SS3.p2.1.m1.2.2.3">
          𝑂
         </ci>
         <apply id="S3.SS3.p2.1.m1.2.2.1.1.1.cmml" xref="S3.SS3.p2.1.m1.2.2.1.1">
          <csymbol cd="ambiguous" id="S3.SS3.p2.1.m1.2.2.1.1.1.1.cmml" xref="S3.SS3.p2.1.m1.2.2.1.1">
           superscript
          </csymbol>
          <apply id="S3.SS3.p2.1.m1.2.2.1.1.1.2.1.cmml" xref="S3.SS3.p2.1.m1.2.2.1.1.1.2.2">
           <abs id="S3.SS3.p2.1.m1.2.2.1.1.1.2.1.1.cmml" xref="S3.SS3.p2.1.m1.2.2.1.1.1.2.2.1">
           </abs>
           <ci id="S3.SS3.p2.1.m1.1.1.cmml" xref="S3.SS3.p2.1.m1.1.1">
            𝒱
           </ci>
          </apply>
          <ci id="S3.SS3.p2.1.m1.2.2.1.1.1.3.cmml" xref="S3.SS3.p2.1.m1.2.2.1.1.1.3">
           𝑙
          </ci>
         </apply>
        </apply>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="S3.SS3.p2.1.m1.2c">
        O(|\mathcal{V}|^{l})
       </annotation>
      </semantics>
     </math>
     to
     <math alttext="O(|\mathcal{V}|\times l)" class="ltx_Math" display="inline" id="S3.SS3.p2.2.m2.2">
      <semantics id="S3.SS3.p2.2.m2.2a">
       <mrow id="S3.SS3.p2.2.m2.2.2" xref="S3.SS3.p2.2.m2.2.2.cmml">
        <mi id="S3.SS3.p2.2.m2.2.2.3" xref="S3.SS3.p2.2.m2.2.2.3.cmml">
         O
        </mi>
        <mo id="S3.SS3.p2.2.m2.2.2.2" lspace="0em" rspace="0em" xref="S3.SS3.p2.2.m2.2.2.2.cmml">
         ​
        </mo>
        <mrow id="S3.SS3.p2.2.m2.2.2.1.1" xref="S3.SS3.p2.2.m2.2.2.1.1.1.cmml">
         <mo id="S3.SS3.p2.2.m2.2.2.1.1.2" stretchy="false" xref="S3.SS3.p2.2.m2.2.2.1.1.1.cmml">
          (
         </mo>
         <mrow id="S3.SS3.p2.2.m2.2.2.1.1.1" xref="S3.SS3.p2.2.m2.2.2.1.1.1.cmml">
          <mrow id="S3.SS3.p2.2.m2.2.2.1.1.1.2.2" xref="S3.SS3.p2.2.m2.2.2.1.1.1.2.1.cmml">
           <mo id="S3.SS3.p2.2.m2.2.2.1.1.1.2.2.1" stretchy="false" xref="S3.SS3.p2.2.m2.2.2.1.1.1.2.1.1.cmml">
            |
           </mo>
           <mi class="ltx_font_mathcaligraphic" id="S3.SS3.p2.2.m2.1.1" xref="S3.SS3.p2.2.m2.1.1.cmml">
            𝒱
           </mi>
           <mo id="S3.SS3.p2.2.m2.2.2.1.1.1.2.2.2" rspace="0.055em" stretchy="false" xref="S3.SS3.p2.2.m2.2.2.1.1.1.2.1.1.cmml">
            |
           </mo>
          </mrow>
          <mo id="S3.SS3.p2.2.m2.2.2.1.1.1.1" rspace="0.222em" xref="S3.SS3.p2.2.m2.2.2.1.1.1.1.cmml">
           ×
          </mo>
          <mi id="S3.SS3.p2.2.m2.2.2.1.1.1.3" xref="S3.SS3.p2.2.m2.2.2.1.1.1.3.cmml">
           l
          </mi>
         </mrow>
         <mo id="S3.SS3.p2.2.m2.2.2.1.1.3" stretchy="false" xref="S3.SS3.p2.2.m2.2.2.1.1.1.cmml">
          )
         </mo>
        </mrow>
       </mrow>
       <annotation-xml encoding="MathML-Content" id="S3.SS3.p2.2.m2.2b">
        <apply id="S3.SS3.p2.2.m2.2.2.cmml" xref="S3.SS3.p2.2.m2.2.2">
         <times id="S3.SS3.p2.2.m2.2.2.2.cmml" xref="S3.SS3.p2.2.m2.2.2.2">
         </times>
         <ci id="S3.SS3.p2.2.m2.2.2.3.cmml" xref="S3.SS3.p2.2.m2.2.2.3">
          𝑂
         </ci>
         <apply id="S3.SS3.p2.2.m2.2.2.1.1.1.cmml" xref="S3.SS3.p2.2.m2.2.2.1.1">
          <times id="S3.SS3.p2.2.m2.2.2.1.1.1.1.cmml" xref="S3.SS3.p2.2.m2.2.2.1.1.1.1">
          </times>
          <apply id="S3.SS3.p2.2.m2.2.2.1.1.1.2.1.cmml" xref="S3.SS3.p2.2.m2.2.2.1.1.1.2.2">
           <abs id="S3.SS3.p2.2.m2.2.2.1.1.1.2.1.1.cmml" xref="S3.SS3.p2.2.m2.2.2.1.1.1.2.2.1">
           </abs>
           <ci id="S3.SS3.p2.2.m2.1.1.cmml" xref="S3.SS3.p2.2.m2.1.1">
            𝒱
           </ci>
          </apply>
          <ci id="S3.SS3.p2.2.m2.2.2.1.1.1.3.cmml" xref="S3.SS3.p2.2.m2.2.2.1.1.1.3">
           𝑙
          </ci>
         </apply>
        </apply>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="S3.SS3.p2.2.m2.2c">
        O(|\mathcal{V}|\times l)
       </annotation>
      </semantics>
     </math>
     and enabling fine-grained credit assignment, we should ensure the consistency in the optimization process before and after decomposition.
    </p>
   </div>
  </section>
 </section>
 <section class="ltx_section" id="S4">
  <h2 class="ltx_title ltx_title_section">
   <span class="ltx_tag ltx_tag_section">
    4
   </span>
   Entropy-Regularized Token-Level Policy Optimization
  </h2>
  <figure class="ltx_figure" id="S4.F2">
   <p class="ltx_p ltx_align_center ltx_align_center" id="S4.F2.1.1">
    <span class="ltx_text" id="S4.F2.1.1.1">
     <img alt="Refer to caption" class="ltx_graphics ltx_img_landscape" height="172" id="S4.F2.1.1.1.g1" src="/html/2402.06700/assets/x1.png" width="415"/>
    </span>
   </p>
   <figcaption class="ltx_caption ltx_centering">
    <span class="ltx_tag ltx_tag_figure">
     Figure 2:
    </span>
    The overall pipeline of ETPO. In each time step, the LLM agent receives a state from the interactive environment. Then it generates an action token-by-token until the action is ready and being executed, i.e.
    <math alttext="j=|a|" class="ltx_Math" display="inline" id="S4.F2.5.5.m1.1">
     <semantics id="S4.F2.5.5.m1.1b">
      <mrow id="S4.F2.5.5.m1.1.2" xref="S4.F2.5.5.m1.1.2.cmml">
       <mi id="S4.F2.5.5.m1.1.2.2" xref="S4.F2.5.5.m1.1.2.2.cmml">
        j
       </mi>
       <mo id="S4.F2.5.5.m1.1.2.1" xref="S4.F2.5.5.m1.1.2.1.cmml">
        =
       </mo>
       <mrow id="S4.F2.5.5.m1.1.2.3.2" xref="S4.F2.5.5.m1.1.2.3.1.cmml">
        <mo id="S4.F2.5.5.m1.1.2.3.2.1" stretchy="false" xref="S4.F2.5.5.m1.1.2.3.1.1.cmml">
         |
        </mo>
        <mi id="S4.F2.5.5.m1.1.1" xref="S4.F2.5.5.m1.1.1.cmml">
         a
        </mi>
        <mo id="S4.F2.5.5.m1.1.2.3.2.2" stretchy="false" xref="S4.F2.5.5.m1.1.2.3.1.1.cmml">
         |
        </mo>
       </mrow>
      </mrow>
      <annotation-xml encoding="MathML-Content" id="S4.F2.5.5.m1.1c">
       <apply id="S4.F2.5.5.m1.1.2.cmml" xref="S4.F2.5.5.m1.1.2">
        <eq id="S4.F2.5.5.m1.1.2.1.cmml" xref="S4.F2.5.5.m1.1.2.1">
        </eq>
        <ci id="S4.F2.5.5.m1.1.2.2.cmml" xref="S4.F2.5.5.m1.1.2.2">
         𝑗
        </ci>
        <apply id="S4.F2.5.5.m1.1.2.3.1.cmml" xref="S4.F2.5.5.m1.1.2.3.2">
         <abs id="S4.F2.5.5.m1.1.2.3.1.1.cmml" xref="S4.F2.5.5.m1.1.2.3.2.1">
         </abs>
         <ci id="S4.F2.5.5.m1.1.1.cmml" xref="S4.F2.5.5.m1.1.1">
          𝑎
         </ci>
        </apply>
       </apply>
      </annotation-xml>
      <annotation encoding="application/x-tex" id="S4.F2.5.5.m1.1d">
       j=|a|
      </annotation>
     </semantics>
    </math>
    . Then the action will be separated into a sequence of tokens and their Q values will be updated following the per-token soft Bellman update scheme, where the
    <math alttext="\mathbb{E}[\cdot]-\beta D_{KL}" class="ltx_Math" display="inline" id="S4.F2.6.6.m2.1">
     <semantics id="S4.F2.6.6.m2.1b">
      <mrow id="S4.F2.6.6.m2.1.2" xref="S4.F2.6.6.m2.1.2.cmml">
       <mrow id="S4.F2.6.6.m2.1.2.2" xref="S4.F2.6.6.m2.1.2.2.cmml">
        <mi id="S4.F2.6.6.m2.1.2.2.2" xref="S4.F2.6.6.m2.1.2.2.2.cmml">
         𝔼
        </mi>
        <mo id="S4.F2.6.6.m2.1.2.2.1" lspace="0em" rspace="0em" xref="S4.F2.6.6.m2.1.2.2.1.cmml">
         ​
        </mo>
        <mrow id="S4.F2.6.6.m2.1.2.2.3.2" xref="S4.F2.6.6.m2.1.2.2.3.1.cmml">
         <mo id="S4.F2.6.6.m2.1.2.2.3.2.1" stretchy="false" xref="S4.F2.6.6.m2.1.2.2.3.1.1.cmml">
          [
         </mo>
         <mo id="S4.F2.6.6.m2.1.1" lspace="0em" rspace="0em" xref="S4.F2.6.6.m2.1.1.cmml">
          ⋅
         </mo>
         <mo id="S4.F2.6.6.m2.1.2.2.3.2.2" stretchy="false" xref="S4.F2.6.6.m2.1.2.2.3.1.1.cmml">
          ]
         </mo>
        </mrow>
       </mrow>
       <mo id="S4.F2.6.6.m2.1.2.1" xref="S4.F2.6.6.m2.1.2.1.cmml">
        −
       </mo>
       <mrow id="S4.F2.6.6.m2.1.2.3" xref="S4.F2.6.6.m2.1.2.3.cmml">
        <mi id="S4.F2.6.6.m2.1.2.3.2" xref="S4.F2.6.6.m2.1.2.3.2.cmml">
         β
        </mi>
        <mo id="S4.F2.6.6.m2.1.2.3.1" lspace="0em" rspace="0em" xref="S4.F2.6.6.m2.1.2.3.1.cmml">
         ​
        </mo>
        <msub id="S4.F2.6.6.m2.1.2.3.3" xref="S4.F2.6.6.m2.1.2.3.3.cmml">
         <mi id="S4.F2.6.6.m2.1.2.3.3.2" xref="S4.F2.6.6.m2.1.2.3.3.2.cmml">
          D
         </mi>
         <mrow id="S4.F2.6.6.m2.1.2.3.3.3" xref="S4.F2.6.6.m2.1.2.3.3.3.cmml">
          <mi id="S4.F2.6.6.m2.1.2.3.3.3.2" xref="S4.F2.6.6.m2.1.2.3.3.3.2.cmml">
           K
          </mi>
          <mo id="S4.F2.6.6.m2.1.2.3.3.3.1" lspace="0em" rspace="0em" xref="S4.F2.6.6.m2.1.2.3.3.3.1.cmml">
           ​
          </mo>
          <mi id="S4.F2.6.6.m2.1.2.3.3.3.3" xref="S4.F2.6.6.m2.1.2.3.3.3.3.cmml">
           L
          </mi>
         </mrow>
        </msub>
       </mrow>
      </mrow>
      <annotation-xml encoding="MathML-Content" id="S4.F2.6.6.m2.1c">
       <apply id="S4.F2.6.6.m2.1.2.cmml" xref="S4.F2.6.6.m2.1.2">
        <minus id="S4.F2.6.6.m2.1.2.1.cmml" xref="S4.F2.6.6.m2.1.2.1">
        </minus>
        <apply id="S4.F2.6.6.m2.1.2.2.cmml" xref="S4.F2.6.6.m2.1.2.2">
         <times id="S4.F2.6.6.m2.1.2.2.1.cmml" xref="S4.F2.6.6.m2.1.2.2.1">
         </times>
         <ci id="S4.F2.6.6.m2.1.2.2.2.cmml" xref="S4.F2.6.6.m2.1.2.2.2">
          𝔼
         </ci>
         <apply id="S4.F2.6.6.m2.1.2.2.3.1.cmml" xref="S4.F2.6.6.m2.1.2.2.3.2">
          <csymbol cd="latexml" id="S4.F2.6.6.m2.1.2.2.3.1.1.cmml" xref="S4.F2.6.6.m2.1.2.2.3.2.1">
           delimited-[]
          </csymbol>
          <ci id="S4.F2.6.6.m2.1.1.cmml" xref="S4.F2.6.6.m2.1.1">
           ⋅
          </ci>
         </apply>
        </apply>
        <apply id="S4.F2.6.6.m2.1.2.3.cmml" xref="S4.F2.6.6.m2.1.2.3">
         <times id="S4.F2.6.6.m2.1.2.3.1.cmml" xref="S4.F2.6.6.m2.1.2.3.1">
         </times>
         <ci id="S4.F2.6.6.m2.1.2.3.2.cmml" xref="S4.F2.6.6.m2.1.2.3.2">
          𝛽
         </ci>
         <apply id="S4.F2.6.6.m2.1.2.3.3.cmml" xref="S4.F2.6.6.m2.1.2.3.3">
          <csymbol cd="ambiguous" id="S4.F2.6.6.m2.1.2.3.3.1.cmml" xref="S4.F2.6.6.m2.1.2.3.3">
           subscript
          </csymbol>
          <ci id="S4.F2.6.6.m2.1.2.3.3.2.cmml" xref="S4.F2.6.6.m2.1.2.3.3.2">
           𝐷
          </ci>
          <apply id="S4.F2.6.6.m2.1.2.3.3.3.cmml" xref="S4.F2.6.6.m2.1.2.3.3.3">
           <times id="S4.F2.6.6.m2.1.2.3.3.3.1.cmml" xref="S4.F2.6.6.m2.1.2.3.3.3.1">
           </times>
           <ci id="S4.F2.6.6.m2.1.2.3.3.3.2.cmml" xref="S4.F2.6.6.m2.1.2.3.3.3.2">
            𝐾
           </ci>
           <ci id="S4.F2.6.6.m2.1.2.3.3.3.3.cmml" xref="S4.F2.6.6.m2.1.2.3.3.3.3">
            𝐿
           </ci>
          </apply>
         </apply>
        </apply>
       </apply>
      </annotation-xml>
      <annotation encoding="application/x-tex" id="S4.F2.6.6.m2.1d">
       \mathbb{E}[\cdot]-\beta D_{KL}
      </annotation>
     </semantics>
    </math>
    and
    <math alttext="r+\gamma(\mathbb{E}[\cdot]-\beta D_{KL})" class="ltx_Math" display="inline" id="S4.F2.7.7.m3.2">
     <semantics id="S4.F2.7.7.m3.2b">
      <mrow id="S4.F2.7.7.m3.2.2" xref="S4.F2.7.7.m3.2.2.cmml">
       <mi id="S4.F2.7.7.m3.2.2.3" xref="S4.F2.7.7.m3.2.2.3.cmml">
        r
       </mi>
       <mo id="S4.F2.7.7.m3.2.2.2" xref="S4.F2.7.7.m3.2.2.2.cmml">
        +
       </mo>
       <mrow id="S4.F2.7.7.m3.2.2.1" xref="S4.F2.7.7.m3.2.2.1.cmml">
        <mi id="S4.F2.7.7.m3.2.2.1.3" xref="S4.F2.7.7.m3.2.2.1.3.cmml">
         γ
        </mi>
        <mo id="S4.F2.7.7.m3.2.2.1.2" lspace="0em" rspace="0em" xref="S4.F2.7.7.m3.2.2.1.2.cmml">
         ​
        </mo>
        <mrow id="S4.F2.7.7.m3.2.2.1.1.1" xref="S4.F2.7.7.m3.2.2.1.1.1.1.cmml">
         <mo id="S4.F2.7.7.m3.2.2.1.1.1.2" stretchy="false" xref="S4.F2.7.7.m3.2.2.1.1.1.1.cmml">
          (
         </mo>
         <mrow id="S4.F2.7.7.m3.2.2.1.1.1.1" xref="S4.F2.7.7.m3.2.2.1.1.1.1.cmml">
          <mrow id="S4.F2.7.7.m3.2.2.1.1.1.1.2" xref="S4.F2.7.7.m3.2.2.1.1.1.1.2.cmml">
           <mi id="S4.F2.7.7.m3.2.2.1.1.1.1.2.2" xref="S4.F2.7.7.m3.2.2.1.1.1.1.2.2.cmml">
            𝔼
           </mi>
           <mo id="S4.F2.7.7.m3.2.2.1.1.1.1.2.1" lspace="0em" rspace="0em" xref="S4.F2.7.7.m3.2.2.1.1.1.1.2.1.cmml">
            ​
           </mo>
           <mrow id="S4.F2.7.7.m3.2.2.1.1.1.1.2.3.2" xref="S4.F2.7.7.m3.2.2.1.1.1.1.2.3.1.cmml">
            <mo id="S4.F2.7.7.m3.2.2.1.1.1.1.2.3.2.1" stretchy="false" xref="S4.F2.7.7.m3.2.2.1.1.1.1.2.3.1.1.cmml">
             [
            </mo>
            <mo id="S4.F2.7.7.m3.1.1" lspace="0em" rspace="0em" xref="S4.F2.7.7.m3.1.1.cmml">
             ⋅
            </mo>
            <mo id="S4.F2.7.7.m3.2.2.1.1.1.1.2.3.2.2" stretchy="false" xref="S4.F2.7.7.m3.2.2.1.1.1.1.2.3.1.1.cmml">
             ]
            </mo>
           </mrow>
          </mrow>
          <mo id="S4.F2.7.7.m3.2.2.1.1.1.1.1" xref="S4.F2.7.7.m3.2.2.1.1.1.1.1.cmml">
           −
          </mo>
          <mrow id="S4.F2.7.7.m3.2.2.1.1.1.1.3" xref="S4.F2.7.7.m3.2.2.1.1.1.1.3.cmml">
           <mi id="S4.F2.7.7.m3.2.2.1.1.1.1.3.2" xref="S4.F2.7.7.m3.2.2.1.1.1.1.3.2.cmml">
            β
           </mi>
           <mo id="S4.F2.7.7.m3.2.2.1.1.1.1.3.1" lspace="0em" rspace="0em" xref="S4.F2.7.7.m3.2.2.1.1.1.1.3.1.cmml">
            ​
           </mo>
           <msub id="S4.F2.7.7.m3.2.2.1.1.1.1.3.3" xref="S4.F2.7.7.m3.2.2.1.1.1.1.3.3.cmml">
            <mi id="S4.F2.7.7.m3.2.2.1.1.1.1.3.3.2" xref="S4.F2.7.7.m3.2.2.1.1.1.1.3.3.2.cmml">
             D
            </mi>
            <mrow id="S4.F2.7.7.m3.2.2.1.1.1.1.3.3.3" xref="S4.F2.7.7.m3.2.2.1.1.1.1.3.3.3.cmml">
             <mi id="S4.F2.7.7.m3.2.2.1.1.1.1.3.3.3.2" xref="S4.F2.7.7.m3.2.2.1.1.1.1.3.3.3.2.cmml">
              K
             </mi>
             <mo id="S4.F2.7.7.m3.2.2.1.1.1.1.3.3.3.1" lspace="0em" rspace="0em" xref="S4.F2.7.7.m3.2.2.1.1.1.1.3.3.3.1.cmml">
              ​
             </mo>
             <mi id="S4.F2.7.7.m3.2.2.1.1.1.1.3.3.3.3" xref="S4.F2.7.7.m3.2.2.1.1.1.1.3.3.3.3.cmml">
              L
             </mi>
            </mrow>
           </msub>
          </mrow>
         </mrow>
         <mo id="S4.F2.7.7.m3.2.2.1.1.1.3" stretchy="false" xref="S4.F2.7.7.m3.2.2.1.1.1.1.cmml">
          )
         </mo>
        </mrow>
       </mrow>
      </mrow>
      <annotation-xml encoding="MathML-Content" id="S4.F2.7.7.m3.2c">
       <apply id="S4.F2.7.7.m3.2.2.cmml" xref="S4.F2.7.7.m3.2.2">
        <plus id="S4.F2.7.7.m3.2.2.2.cmml" xref="S4.F2.7.7.m3.2.2.2">
        </plus>
        <ci id="S4.F2.7.7.m3.2.2.3.cmml" xref="S4.F2.7.7.m3.2.2.3">
         𝑟
        </ci>
        <apply id="S4.F2.7.7.m3.2.2.1.cmml" xref="S4.F2.7.7.m3.2.2.1">
         <times id="S4.F2.7.7.m3.2.2.1.2.cmml" xref="S4.F2.7.7.m3.2.2.1.2">
         </times>
         <ci id="S4.F2.7.7.m3.2.2.1.3.cmml" xref="S4.F2.7.7.m3.2.2.1.3">
          𝛾
         </ci>
         <apply id="S4.F2.7.7.m3.2.2.1.1.1.1.cmml" xref="S4.F2.7.7.m3.2.2.1.1.1">
          <minus id="S4.F2.7.7.m3.2.2.1.1.1.1.1.cmml" xref="S4.F2.7.7.m3.2.2.1.1.1.1.1">
          </minus>
          <apply id="S4.F2.7.7.m3.2.2.1.1.1.1.2.cmml" xref="S4.F2.7.7.m3.2.2.1.1.1.1.2">
           <times id="S4.F2.7.7.m3.2.2.1.1.1.1.2.1.cmml" xref="S4.F2.7.7.m3.2.2.1.1.1.1.2.1">
           </times>
           <ci id="S4.F2.7.7.m3.2.2.1.1.1.1.2.2.cmml" xref="S4.F2.7.7.m3.2.2.1.1.1.1.2.2">
            𝔼
           </ci>
           <apply id="S4.F2.7.7.m3.2.2.1.1.1.1.2.3.1.cmml" xref="S4.F2.7.7.m3.2.2.1.1.1.1.2.3.2">
            <csymbol cd="latexml" id="S4.F2.7.7.m3.2.2.1.1.1.1.2.3.1.1.cmml" xref="S4.F2.7.7.m3.2.2.1.1.1.1.2.3.2.1">
             delimited-[]
            </csymbol>
            <ci id="S4.F2.7.7.m3.1.1.cmml" xref="S4.F2.7.7.m3.1.1">
             ⋅
            </ci>
           </apply>
          </apply>
          <apply id="S4.F2.7.7.m3.2.2.1.1.1.1.3.cmml" xref="S4.F2.7.7.m3.2.2.1.1.1.1.3">
           <times id="S4.F2.7.7.m3.2.2.1.1.1.1.3.1.cmml" xref="S4.F2.7.7.m3.2.2.1.1.1.1.3.1">
           </times>
           <ci id="S4.F2.7.7.m3.2.2.1.1.1.1.3.2.cmml" xref="S4.F2.7.7.m3.2.2.1.1.1.1.3.2">
            𝛽
           </ci>
           <apply id="S4.F2.7.7.m3.2.2.1.1.1.1.3.3.cmml" xref="S4.F2.7.7.m3.2.2.1.1.1.1.3.3">
            <csymbol cd="ambiguous" id="S4.F2.7.7.m3.2.2.1.1.1.1.3.3.1.cmml" xref="S4.F2.7.7.m3.2.2.1.1.1.1.3.3">
             subscript
            </csymbol>
            <ci id="S4.F2.7.7.m3.2.2.1.1.1.1.3.3.2.cmml" xref="S4.F2.7.7.m3.2.2.1.1.1.1.3.3.2">
             𝐷
            </ci>
            <apply id="S4.F2.7.7.m3.2.2.1.1.1.1.3.3.3.cmml" xref="S4.F2.7.7.m3.2.2.1.1.1.1.3.3.3">
             <times id="S4.F2.7.7.m3.2.2.1.1.1.1.3.3.3.1.cmml" xref="S4.F2.7.7.m3.2.2.1.1.1.1.3.3.3.1">
             </times>
             <ci id="S4.F2.7.7.m3.2.2.1.1.1.1.3.3.3.2.cmml" xref="S4.F2.7.7.m3.2.2.1.1.1.1.3.3.3.2">
              𝐾
             </ci>
             <ci id="S4.F2.7.7.m3.2.2.1.1.1.1.3.3.3.3.cmml" xref="S4.F2.7.7.m3.2.2.1.1.1.1.3.3.3.3">
              𝐿
             </ci>
            </apply>
           </apply>
          </apply>
         </apply>
        </apply>
       </apply>
      </annotation-xml>
      <annotation encoding="application/x-tex" id="S4.F2.7.7.m3.2d">
       r+\gamma(\mathbb{E}[\cdot]-\beta D_{KL})
      </annotation>
     </semantics>
    </math>
    are respectively corresponding to the different cases in Equation
    <a class="ltx_ref" href="#S4.E6" title="Equation 6 ‣ 4 Entropy-Regularized Token-Level Policy Optimization ‣ Entropy-Regularized Token-Level Policy Optimization for Large Language Models">
     <span class="ltx_text ltx_ref_tag">
      6
     </span>
    </a>
    . The LLM policy will also be updated toward minimizing the KL divergence between it and the soft Q-network.
   </figcaption>
  </figure>
  <div class="ltx_para" id="S4.p1">
   <p class="ltx_p" id="S4.p1.2">
    Based on the motivation discussed in Sections
    <a class="ltx_ref" href="#S3.SS2" title="3.2 Entropy-Regularized Reinforcement Learning ‣ 3 Preliminaries ‣ Entropy-Regularized Token-Level Policy Optimization for Large Language Models">
     <span class="ltx_text ltx_ref_tag">
      3.2
     </span>
    </a>
    and
    <a class="ltx_ref" href="#S3.SS3" title="3.3 Action-Level and Token-Level Policy Optimization ‣ 3 Preliminaries ‣ Entropy-Regularized Token-Level Policy Optimization for Large Language Models">
     <span class="ltx_text ltx_ref_tag">
      3.3
     </span>
    </a>
    , we propose a concrete token-level ERL algorithm that yields the highest expected entropy-augmented return, i.e. the Equation
    <a class="ltx_ref" href="#S3.E2" title="Equation 2 ‣ 3.2 Entropy-Regularized Reinforcement Learning ‣ 3 Preliminaries ‣ Entropy-Regularized Token-Level Policy Optimization for Large Language Models">
     <span class="ltx_text ltx_ref_tag">
      2
     </span>
    </a>
    . The intuition behind our method is to decompose a textual action into a sequence of tokens and backpropagate proper credit for each token with a variant of soft Bellman update, i.e. the per-token soft Bellman update in Equation
    <a class="ltx_ref" href="#S4.E6" title="Equation 6 ‣ 4 Entropy-Regularized Token-Level Policy Optimization ‣ Entropy-Regularized Token-Level Policy Optimization for Large Language Models">
     <span class="ltx_text ltx_ref_tag">
      6
     </span>
    </a>
    . That way, we can learn a token-level soft Q-function, bypassing the requirement to calculate a precise
    <math alttext="\mathbb{E}_{a_{t+1}\sim\pi}[Q(s_{t+1},a_{t+1})]" class="ltx_Math" display="inline" id="S4.p1.1.m1.1">
     <semantics id="S4.p1.1.m1.1a">
      <mrow id="S4.p1.1.m1.1.1" xref="S4.p1.1.m1.1.1.cmml">
       <msub id="S4.p1.1.m1.1.1.3" xref="S4.p1.1.m1.1.1.3.cmml">
        <mi id="S4.p1.1.m1.1.1.3.2" xref="S4.p1.1.m1.1.1.3.2.cmml">
         𝔼
        </mi>
        <mrow id="S4.p1.1.m1.1.1.3.3" xref="S4.p1.1.m1.1.1.3.3.cmml">
         <msub id="S4.p1.1.m1.1.1.3.3.2" xref="S4.p1.1.m1.1.1.3.3.2.cmml">
          <mi id="S4.p1.1.m1.1.1.3.3.2.2" xref="S4.p1.1.m1.1.1.3.3.2.2.cmml">
           a
          </mi>
          <mrow id="S4.p1.1.m1.1.1.3.3.2.3" xref="S4.p1.1.m1.1.1.3.3.2.3.cmml">
           <mi id="S4.p1.1.m1.1.1.3.3.2.3.2" xref="S4.p1.1.m1.1.1.3.3.2.3.2.cmml">
            t
           </mi>
           <mo id="S4.p1.1.m1.1.1.3.3.2.3.1" xref="S4.p1.1.m1.1.1.3.3.2.3.1.cmml">
            +
           </mo>
           <mn id="S4.p1.1.m1.1.1.3.3.2.3.3" xref="S4.p1.1.m1.1.1.3.3.2.3.3.cmml">
            1
           </mn>
          </mrow>
         </msub>
         <mo id="S4.p1.1.m1.1.1.3.3.1" xref="S4.p1.1.m1.1.1.3.3.1.cmml">
          ∼
         </mo>
         <mi id="S4.p1.1.m1.1.1.3.3.3" xref="S4.p1.1.m1.1.1.3.3.3.cmml">
          π
         </mi>
        </mrow>
       </msub>
       <mo id="S4.p1.1.m1.1.1.2" lspace="0em" rspace="0em" xref="S4.p1.1.m1.1.1.2.cmml">
        ​
       </mo>
       <mrow id="S4.p1.1.m1.1.1.1.1" xref="S4.p1.1.m1.1.1.1.2.cmml">
        <mo id="S4.p1.1.m1.1.1.1.1.2" stretchy="false" xref="S4.p1.1.m1.1.1.1.2.1.cmml">
         [
        </mo>
        <mrow id="S4.p1.1.m1.1.1.1.1.1" xref="S4.p1.1.m1.1.1.1.1.1.cmml">
         <mi id="S4.p1.1.m1.1.1.1.1.1.4" xref="S4.p1.1.m1.1.1.1.1.1.4.cmml">
          Q
         </mi>
         <mo id="S4.p1.1.m1.1.1.1.1.1.3" lspace="0em" rspace="0em" xref="S4.p1.1.m1.1.1.1.1.1.3.cmml">
          ​
         </mo>
         <mrow id="S4.p1.1.m1.1.1.1.1.1.2.2" xref="S4.p1.1.m1.1.1.1.1.1.2.3.cmml">
          <mo id="S4.p1.1.m1.1.1.1.1.1.2.2.3" stretchy="false" xref="S4.p1.1.m1.1.1.1.1.1.2.3.cmml">
           (
          </mo>
          <msub id="S4.p1.1.m1.1.1.1.1.1.1.1.1" xref="S4.p1.1.m1.1.1.1.1.1.1.1.1.cmml">
           <mi id="S4.p1.1.m1.1.1.1.1.1.1.1.1.2" xref="S4.p1.1.m1.1.1.1.1.1.1.1.1.2.cmml">
            s
           </mi>
           <mrow id="S4.p1.1.m1.1.1.1.1.1.1.1.1.3" xref="S4.p1.1.m1.1.1.1.1.1.1.1.1.3.cmml">
            <mi id="S4.p1.1.m1.1.1.1.1.1.1.1.1.3.2" xref="S4.p1.1.m1.1.1.1.1.1.1.1.1.3.2.cmml">
             t
            </mi>
            <mo id="S4.p1.1.m1.1.1.1.1.1.1.1.1.3.1" xref="S4.p1.1.m1.1.1.1.1.1.1.1.1.3.1.cmml">
             +
            </mo>
            <mn id="S4.p1.1.m1.1.1.1.1.1.1.1.1.3.3" xref="S4.p1.1.m1.1.1.1.1.1.1.1.1.3.3.cmml">
             1
            </mn>
           </mrow>
          </msub>
          <mo id="S4.p1.1.m1.1.1.1.1.1.2.2.4" xref="S4.p1.1.m1.1.1.1.1.1.2.3.cmml">
           ,
          </mo>
          <msub id="S4.p1.1.m1.1.1.1.1.1.2.2.2" xref="S4.p1.1.m1.1.1.1.1.1.2.2.2.cmml">
           <mi id="S4.p1.1.m1.1.1.1.1.1.2.2.2.2" xref="S4.p1.1.m1.1.1.1.1.1.2.2.2.2.cmml">
            a
           </mi>
           <mrow id="S4.p1.1.m1.1.1.1.1.1.2.2.2.3" xref="S4.p1.1.m1.1.1.1.1.1.2.2.2.3.cmml">
            <mi id="S4.p1.1.m1.1.1.1.1.1.2.2.2.3.2" xref="S4.p1.1.m1.1.1.1.1.1.2.2.2.3.2.cmml">
             t
            </mi>
            <mo id="S4.p1.1.m1.1.1.1.1.1.2.2.2.3.1" xref="S4.p1.1.m1.1.1.1.1.1.2.2.2.3.1.cmml">
             +
            </mo>
            <mn id="S4.p1.1.m1.1.1.1.1.1.2.2.2.3.3" xref="S4.p1.1.m1.1.1.1.1.1.2.2.2.3.3.cmml">
             1
            </mn>
           </mrow>
          </msub>
          <mo id="S4.p1.1.m1.1.1.1.1.1.2.2.5" stretchy="false" xref="S4.p1.1.m1.1.1.1.1.1.2.3.cmml">
           )
          </mo>
         </mrow>
        </mrow>
        <mo id="S4.p1.1.m1.1.1.1.1.3" stretchy="false" xref="S4.p1.1.m1.1.1.1.2.1.cmml">
         ]
        </mo>
       </mrow>
      </mrow>
      <annotation-xml encoding="MathML-Content" id="S4.p1.1.m1.1b">
       <apply id="S4.p1.1.m1.1.1.cmml" xref="S4.p1.1.m1.1.1">
        <times id="S4.p1.1.m1.1.1.2.cmml" xref="S4.p1.1.m1.1.1.2">
        </times>
        <apply id="S4.p1.1.m1.1.1.3.cmml" xref="S4.p1.1.m1.1.1.3">
         <csymbol cd="ambiguous" id="S4.p1.1.m1.1.1.3.1.cmml" xref="S4.p1.1.m1.1.1.3">
          subscript
         </csymbol>
         <ci id="S4.p1.1.m1.1.1.3.2.cmml" xref="S4.p1.1.m1.1.1.3.2">
          𝔼
         </ci>
         <apply id="S4.p1.1.m1.1.1.3.3.cmml" xref="S4.p1.1.m1.1.1.3.3">
          <csymbol cd="latexml" id="S4.p1.1.m1.1.1.3.3.1.cmml" xref="S4.p1.1.m1.1.1.3.3.1">
           similar-to
          </csymbol>
          <apply id="S4.p1.1.m1.1.1.3.3.2.cmml" xref="S4.p1.1.m1.1.1.3.3.2">
           <csymbol cd="ambiguous" id="S4.p1.1.m1.1.1.3.3.2.1.cmml" xref="S4.p1.1.m1.1.1.3.3.2">
            subscript
           </csymbol>
           <ci id="S4.p1.1.m1.1.1.3.3.2.2.cmml" xref="S4.p1.1.m1.1.1.3.3.2.2">
            𝑎
           </ci>
           <apply id="S4.p1.1.m1.1.1.3.3.2.3.cmml" xref="S4.p1.1.m1.1.1.3.3.2.3">
            <plus id="S4.p1.1.m1.1.1.3.3.2.3.1.cmml" xref="S4.p1.1.m1.1.1.3.3.2.3.1">
            </plus>
            <ci id="S4.p1.1.m1.1.1.3.3.2.3.2.cmml" xref="S4.p1.1.m1.1.1.3.3.2.3.2">
             𝑡
            </ci>
            <cn id="S4.p1.1.m1.1.1.3.3.2.3.3.cmml" type="integer" xref="S4.p1.1.m1.1.1.3.3.2.3.3">
             1
            </cn>
           </apply>
          </apply>
          <ci id="S4.p1.1.m1.1.1.3.3.3.cmml" xref="S4.p1.1.m1.1.1.3.3.3">
           𝜋
          </ci>
         </apply>
        </apply>
        <apply id="S4.p1.1.m1.1.1.1.2.cmml" xref="S4.p1.1.m1.1.1.1.1">
         <csymbol cd="latexml" id="S4.p1.1.m1.1.1.1.2.1.cmml" xref="S4.p1.1.m1.1.1.1.1.2">
          delimited-[]
         </csymbol>
         <apply id="S4.p1.1.m1.1.1.1.1.1.cmml" xref="S4.p1.1.m1.1.1.1.1.1">
          <times id="S4.p1.1.m1.1.1.1.1.1.3.cmml" xref="S4.p1.1.m1.1.1.1.1.1.3">
          </times>
          <ci id="S4.p1.1.m1.1.1.1.1.1.4.cmml" xref="S4.p1.1.m1.1.1.1.1.1.4">
           𝑄
          </ci>
          <interval closure="open" id="S4.p1.1.m1.1.1.1.1.1.2.3.cmml" xref="S4.p1.1.m1.1.1.1.1.1.2.2">
           <apply id="S4.p1.1.m1.1.1.1.1.1.1.1.1.cmml" xref="S4.p1.1.m1.1.1.1.1.1.1.1.1">
            <csymbol cd="ambiguous" id="S4.p1.1.m1.1.1.1.1.1.1.1.1.1.cmml" xref="S4.p1.1.m1.1.1.1.1.1.1.1.1">
             subscript
            </csymbol>
            <ci id="S4.p1.1.m1.1.1.1.1.1.1.1.1.2.cmml" xref="S4.p1.1.m1.1.1.1.1.1.1.1.1.2">
             𝑠
            </ci>
            <apply id="S4.p1.1.m1.1.1.1.1.1.1.1.1.3.cmml" xref="S4.p1.1.m1.1.1.1.1.1.1.1.1.3">
             <plus id="S4.p1.1.m1.1.1.1.1.1.1.1.1.3.1.cmml" xref="S4.p1.1.m1.1.1.1.1.1.1.1.1.3.1">
             </plus>
             <ci id="S4.p1.1.m1.1.1.1.1.1.1.1.1.3.2.cmml" xref="S4.p1.1.m1.1.1.1.1.1.1.1.1.3.2">
              𝑡
             </ci>
             <cn id="S4.p1.1.m1.1.1.1.1.1.1.1.1.3.3.cmml" type="integer" xref="S4.p1.1.m1.1.1.1.1.1.1.1.1.3.3">
              1
             </cn>
            </apply>
           </apply>
           <apply id="S4.p1.1.m1.1.1.1.1.1.2.2.2.cmml" xref="S4.p1.1.m1.1.1.1.1.1.2.2.2">
            <csymbol cd="ambiguous" id="S4.p1.1.m1.1.1.1.1.1.2.2.2.1.cmml" xref="S4.p1.1.m1.1.1.1.1.1.2.2.2">
             subscript
            </csymbol>
            <ci id="S4.p1.1.m1.1.1.1.1.1.2.2.2.2.cmml" xref="S4.p1.1.m1.1.1.1.1.1.2.2.2.2">
             𝑎
            </ci>
            <apply id="S4.p1.1.m1.1.1.1.1.1.2.2.2.3.cmml" xref="S4.p1.1.m1.1.1.1.1.1.2.2.2.3">
             <plus id="S4.p1.1.m1.1.1.1.1.1.2.2.2.3.1.cmml" xref="S4.p1.1.m1.1.1.1.1.1.2.2.2.3.1">
             </plus>
             <ci id="S4.p1.1.m1.1.1.1.1.1.2.2.2.3.2.cmml" xref="S4.p1.1.m1.1.1.1.1.1.2.2.2.3.2">
              𝑡
             </ci>
             <cn id="S4.p1.1.m1.1.1.1.1.1.2.2.2.3.3.cmml" type="integer" xref="S4.p1.1.m1.1.1.1.1.1.2.2.2.3.3">
              1
             </cn>
            </apply>
           </apply>
          </interval>
         </apply>
        </apply>
       </apply>
      </annotation-xml>
      <annotation encoding="application/x-tex" id="S4.p1.1.m1.1c">
       \mathbb{E}_{a_{t+1}\sim\pi}[Q(s_{t+1},a_{t+1})]
      </annotation>
     </semantics>
    </math>
    . After learning the soft Q-function, we can update policy
    <math alttext="\pi" class="ltx_Math" display="inline" id="S4.p1.2.m2.1">
     <semantics id="S4.p1.2.m2.1a">
      <mi id="S4.p1.2.m2.1.1" xref="S4.p1.2.m2.1.1.cmml">
       π
      </mi>
      <annotation-xml encoding="MathML-Content" id="S4.p1.2.m2.1b">
       <ci id="S4.p1.2.m2.1.1.cmml" xref="S4.p1.2.m2.1.1">
        𝜋
       </ci>
      </annotation-xml>
      <annotation encoding="application/x-tex" id="S4.p1.2.m2.1c">
       \pi
      </annotation>
     </semantics>
    </math>
    by minimizing the KL divergence between it and the exponent of the learned soft Q-function, the per-token policy update in Equation
    <a class="ltx_ref" href="#S4.E7" title="Equation 7 ‣ 4 Entropy-Regularized Token-Level Policy Optimization ‣ Entropy-Regularized Token-Level Policy Optimization for Large Language Models">
     <span class="ltx_text ltx_ref_tag">
      7
     </span>
    </a>
    . Figure
    <a class="ltx_ref" href="#S4.F2" title="Figure 2 ‣ 4 Entropy-Regularized Token-Level Policy Optimization ‣ Entropy-Regularized Token-Level Policy Optimization for Large Language Models">
     <span class="ltx_text ltx_ref_tag">
      2
     </span>
    </a>
    illustrates the workflow of our proposed method.
   </p>
  </div>
  <figure class="ltx_figure" id="S4.fig1">
   <div class="ltx_flex_figure">
    <div class="ltx_flex_cell ltx_flex_size_1">
     <table class="ltx_equationgroup ltx_eqn_align ltx_figure_panel ltx_eqn_table" id="A7.EGx6">
      <tbody id="S4.E6">
       <tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
        <td class="ltx_eqn_cell ltx_eqn_center_padleft">
        </td>
        <td class="ltx_td ltx_align_right ltx_eqn_cell">
         <math alttext="\displaystyle Q(s_{t},w_{t}^{1:j-1},w_{t}^{j})=\begin{cases}\mathbb{E}_{w_{t}^{j+1}\sim\pi(s_{t},w_{t}^{1:j})}[Q(s_{t},w_{t}^{1:j},w_{t}^{j+1})]-\beta D_{KL}[\pi||\bar{\pi}](s_{t},w_{t}^{1:j}),&amp;\mbox{if }j&lt;|a_{t}|\\
r(s_{t},a_{t})+\gamma(\mathbb{E}_{w_{t+1}^{1}\sim\pi(s_{t+1})}[Q(s_{t+1},w_{t+1}^{1})]-\beta D_{KL}[\pi||\bar{\pi}](s_{t+1}),&amp;\mbox{if }j=|a_{t}|\end{cases}" class="ltx_math_unparsed" display="inline" id="S4.E6.m1.7">
          <semantics id="S4.E6.m1.7a">
           <mrow id="S4.E6.m1.7.7">
            <mrow id="S4.E6.m1.7.7.3">
             <mi id="S4.E6.m1.7.7.3.5">
              Q
             </mi>
             <mo id="S4.E6.m1.7.7.3.4" lspace="0em" rspace="0em">
              ​
             </mo>
             <mrow id="S4.E6.m1.7.7.3.3.3">
              <mo id="S4.E6.m1.7.7.3.3.3.4" stretchy="false">
               (
              </mo>
              <msub id="S4.E6.m1.5.5.1.1.1.1">
               <mi id="S4.E6.m1.5.5.1.1.1.1.2">
                s
               </mi>
               <mi id="S4.E6.m1.5.5.1.1.1.1.3">
                t
               </mi>
              </msub>
              <mo id="S4.E6.m1.7.7.3.3.3.5">
               ,
              </mo>
              <msubsup id="S4.E6.m1.6.6.2.2.2.2">
               <mi id="S4.E6.m1.6.6.2.2.2.2.2.2">
                w
               </mi>
               <mi id="S4.E6.m1.6.6.2.2.2.2.2.3">
                t
               </mi>
               <mrow id="S4.E6.m1.6.6.2.2.2.2.3">
                <mn id="S4.E6.m1.6.6.2.2.2.2.3.2">
                 1
                </mn>
                <mo id="S4.E6.m1.6.6.2.2.2.2.3.1" lspace="0.278em" rspace="0.278em">
                 :
                </mo>
                <mrow id="S4.E6.m1.6.6.2.2.2.2.3.3">
                 <mi id="S4.E6.m1.6.6.2.2.2.2.3.3.2">
                  j
                 </mi>
                 <mo id="S4.E6.m1.6.6.2.2.2.2.3.3.1">
                  −
                 </mo>
                 <mn id="S4.E6.m1.6.6.2.2.2.2.3.3.3">
                  1
                 </mn>
                </mrow>
               </mrow>
              </msubsup>
              <mo id="S4.E6.m1.7.7.3.3.3.6">
               ,
              </mo>
              <msubsup id="S4.E6.m1.7.7.3.3.3.3">
               <mi id="S4.E6.m1.7.7.3.3.3.3.2.2">
                w
               </mi>
               <mi id="S4.E6.m1.7.7.3.3.3.3.2.3">
                t
               </mi>
               <mi id="S4.E6.m1.7.7.3.3.3.3.3">
                j
               </mi>
              </msubsup>
              <mo id="S4.E6.m1.7.7.3.3.3.7" stretchy="false">
               )
              </mo>
             </mrow>
            </mrow>
            <mo id="S4.E6.m1.7.7.4">
             =
            </mo>
            <mrow id="S4.E6.m1.4.4a">
             <mo id="S4.E6.m1.4.4a.5">
              {
             </mo>
             <mtable columnspacing="5pt" id="S4.E6.m1.4.4.4a" rowspacing="0pt">
              <mtr id="S4.E6.m1.4.4.4aa">
               <mtd class="ltx_align_left" columnalign="left" id="S4.E6.m1.4.4.4ab">
                <mrow id="S4.E6.m1.1.1.1.1.1.1">
                 <msub id="S4.E6.m1.1.1.1.1.1.1.3">
                  <mi id="S4.E6.m1.1.1.1.1.1.1.3.2">
                   𝔼
                  </mi>
                  <mrow id="S4.E6.m1.1.1.1.1.1.1.2.2">
                   <msubsup id="S4.E6.m1.1.1.1.1.1.1.2.2.4">
                    <mi id="S4.E6.m1.1.1.1.1.1.1.2.2.4.2.2">
                     w
                    </mi>
                    <mi id="S4.E6.m1.1.1.1.1.1.1.2.2.4.2.3">
                     t
                    </mi>
                    <mrow id="S4.E6.m1.1.1.1.1.1.1.2.2.4.3">
                     <mi id="S4.E6.m1.1.1.1.1.1.1.2.2.4.3.2">
                      j
                     </mi>
                     <mo id="S4.E6.m1.1.1.1.1.1.1.2.2.4.3.1">
                      +
                     </mo>
                     <mn id="S4.E6.m1.1.1.1.1.1.1.2.2.4.3.3">
                      1
                     </mn>
                    </mrow>
                   </msubsup>
                   <mo id="S4.E6.m1.1.1.1.1.1.1.2.2.3">
                    ∼
                   </mo>
                   <mrow id="S4.E6.m1.1.1.1.1.1.1.2.2.2">
                    <mi id="S4.E6.m1.1.1.1.1.1.1.2.2.2.4">
                     π
                    </mi>
                    <mo id="S4.E6.m1.1.1.1.1.1.1.2.2.2.3" lspace="0em" rspace="0em">
                     ​
                    </mo>
                    <mrow id="S4.E6.m1.1.1.1.1.1.1.2.2.2.2.2">
                     <mo id="S4.E6.m1.1.1.1.1.1.1.2.2.2.2.2.3" stretchy="false">
                      (
                     </mo>
                     <msub id="S4.E6.m1.1.1.1.1.1.1.1.1.1.1.1.1">
                      <mi id="S4.E6.m1.1.1.1.1.1.1.1.1.1.1.1.1.2">
                       s
                      </mi>
                      <mi id="S4.E6.m1.1.1.1.1.1.1.1.1.1.1.1.1.3">
                       t
                      </mi>
                     </msub>
                     <mo id="S4.E6.m1.1.1.1.1.1.1.2.2.2.2.2.4">
                      ,
                     </mo>
                     <msubsup id="S4.E6.m1.1.1.1.1.1.1.2.2.2.2.2.2">
                      <mi id="S4.E6.m1.1.1.1.1.1.1.2.2.2.2.2.2.2.2">
                       w
                      </mi>
                      <mi id="S4.E6.m1.1.1.1.1.1.1.2.2.2.2.2.2.2.3">
                       t
                      </mi>
                      <mrow id="S4.E6.m1.1.1.1.1.1.1.2.2.2.2.2.2.3">
                       <mn id="S4.E6.m1.1.1.1.1.1.1.2.2.2.2.2.2.3.2">
                        1
                       </mn>
                       <mo id="S4.E6.m1.1.1.1.1.1.1.2.2.2.2.2.2.3.1" lspace="0.278em" rspace="0.278em">
                        :
                       </mo>
                       <mi id="S4.E6.m1.1.1.1.1.1.1.2.2.2.2.2.2.3.3">
                        j
                       </mi>
                      </mrow>
                     </msubsup>
                     <mo id="S4.E6.m1.1.1.1.1.1.1.2.2.2.2.2.5" stretchy="false">
                      )
                     </mo>
                    </mrow>
                   </mrow>
                  </mrow>
                 </msub>
                 <mrow id="S4.E6.m1.1.1.1.1.1.1.4">
                  <mo id="S4.E6.m1.1.1.1.1.1.1.4.1" stretchy="false">
                   [
                  </mo>
                  <mi id="S4.E6.m1.1.1.1.1.1.1.4.2">
                   Q
                  </mi>
                  <mrow id="S4.E6.m1.1.1.1.1.1.1.4.3">
                   <mo id="S4.E6.m1.1.1.1.1.1.1.4.3.1" stretchy="false">
                    (
                   </mo>
                   <msub id="S4.E6.m1.1.1.1.1.1.1.4.3.2">
                    <mi id="S4.E6.m1.1.1.1.1.1.1.4.3.2.2">
                     s
                    </mi>
                    <mi id="S4.E6.m1.1.1.1.1.1.1.4.3.2.3">
                     t
                    </mi>
                   </msub>
                   <mo id="S4.E6.m1.1.1.1.1.1.1.4.3.3">
                    ,
                   </mo>
                   <msubsup id="S4.E6.m1.1.1.1.1.1.1.4.3.4">
                    <mi id="S4.E6.m1.1.1.1.1.1.1.4.3.4.2.2">
                     w
                    </mi>
                    <mi id="S4.E6.m1.1.1.1.1.1.1.4.3.4.2.3">
                     t
                    </mi>
                    <mrow id="S4.E6.m1.1.1.1.1.1.1.4.3.4.3">
                     <mn id="S4.E6.m1.1.1.1.1.1.1.4.3.4.3.2">
                      1
                     </mn>
                     <mo id="S4.E6.m1.1.1.1.1.1.1.4.3.4.3.1" lspace="0.278em" rspace="0.278em">
                      :
                     </mo>
                     <mi id="S4.E6.m1.1.1.1.1.1.1.4.3.4.3.3">
                      j
                     </mi>
                    </mrow>
                   </msubsup>
                   <mo id="S4.E6.m1.1.1.1.1.1.1.4.3.5">
                    ,
                   </mo>
                   <msubsup id="S4.E6.m1.1.1.1.1.1.1.4.3.6">
                    <mi id="S4.E6.m1.1.1.1.1.1.1.4.3.6.2.2">
                     w
                    </mi>
                    <mi id="S4.E6.m1.1.1.1.1.1.1.4.3.6.2.3">
                     t
                    </mi>
                    <mrow id="S4.E6.m1.1.1.1.1.1.1.4.3.6.3">
                     <mi id="S4.E6.m1.1.1.1.1.1.1.4.3.6.3.2">
                      j
                     </mi>
                     <mo id="S4.E6.m1.1.1.1.1.1.1.4.3.6.3.1">
                      +
                     </mo>
                     <mn id="S4.E6.m1.1.1.1.1.1.1.4.3.6.3.3">
                      1
                     </mn>
                    </mrow>
                   </msubsup>
                   <mo id="S4.E6.m1.1.1.1.1.1.1.4.3.7" stretchy="false">
                    )
                   </mo>
                  </mrow>
                  <mo id="S4.E6.m1.1.1.1.1.1.1.4.4" stretchy="false">
                   ]
                  </mo>
                 </mrow>
                 <mo id="S4.E6.m1.1.1.1.1.1.1.5">
                  −
                 </mo>
                 <mi id="S4.E6.m1.1.1.1.1.1.1.6">
                  β
                 </mi>
                 <msub id="S4.E6.m1.1.1.1.1.1.1.7">
                  <mi id="S4.E6.m1.1.1.1.1.1.1.7.2">
                   D
                  </mi>
                  <mrow id="S4.E6.m1.1.1.1.1.1.1.7.3">
                   <mi id="S4.E6.m1.1.1.1.1.1.1.7.3.2">
                    K
                   </mi>
                   <mo id="S4.E6.m1.1.1.1.1.1.1.7.3.1" lspace="0em" rspace="0em">
                    ​
                   </mo>
                   <mi id="S4.E6.m1.1.1.1.1.1.1.7.3.3">
                    L
                   </mi>
                  </mrow>
                 </msub>
                 <mrow id="S4.E6.m1.1.1.1.1.1.1.8">
                  <mo id="S4.E6.m1.1.1.1.1.1.1.8.1" stretchy="false">
                   [
                  </mo>
                  <mi id="S4.E6.m1.1.1.1.1.1.1.8.2">
                   π
                  </mi>
                  <mo fence="false" id="S4.E6.m1.1.1.1.1.1.1.8.3" rspace="0.167em" stretchy="false">
                   |
                  </mo>
                  <mo fence="false" id="S4.E6.m1.1.1.1.1.1.1.8.4" rspace="0.167em" stretchy="false">
                   |
                  </mo>
                  <mover accent="true" id="S4.E6.m1.1.1.1.1.1.1.8.5">
                   <mi id="S4.E6.m1.1.1.1.1.1.1.8.5.2">
                    π
                   </mi>
                   <mo id="S4.E6.m1.1.1.1.1.1.1.8.5.1">
                    ¯
                   </mo>
                  </mover>
                  <mo id="S4.E6.m1.1.1.1.1.1.1.8.6" stretchy="false">
                   ]
                  </mo>
                 </mrow>
                 <mrow id="S4.E6.m1.1.1.1.1.1.1.9">
                  <mo id="S4.E6.m1.1.1.1.1.1.1.9.1" stretchy="false">
                   (
                  </mo>
                  <msub id="S4.E6.m1.1.1.1.1.1.1.9.2">
                   <mi id="S4.E6.m1.1.1.1.1.1.1.9.2.2">
                    s
                   </mi>
                   <mi id="S4.E6.m1.1.1.1.1.1.1.9.2.3">
                    t
                   </mi>
                  </msub>
                  <mo id="S4.E6.m1.1.1.1.1.1.1.9.3">
                   ,
                  </mo>
                  <msubsup id="S4.E6.m1.1.1.1.1.1.1.9.4">
                   <mi id="S4.E6.m1.1.1.1.1.1.1.9.4.2.2">
                    w
                   </mi>
                   <mi id="S4.E6.m1.1.1.1.1.1.1.9.4.2.3">
                    t
                   </mi>
                   <mrow id="S4.E6.m1.1.1.1.1.1.1.9.4.3">
                    <mn id="S4.E6.m1.1.1.1.1.1.1.9.4.3.2">
                     1
                    </mn>
                    <mo id="S4.E6.m1.1.1.1.1.1.1.9.4.3.1" lspace="0.278em" rspace="0.278em">
                     :
                    </mo>
                    <mi id="S4.E6.m1.1.1.1.1.1.1.9.4.3.3">
                     j
                    </mi>
                   </mrow>
                  </msubsup>
                  <mo id="S4.E6.m1.1.1.1.1.1.1.9.5" stretchy="false">
                   )
                  </mo>
                 </mrow>
                 <mo id="S4.E6.m1.1.1.1.1.1.1.10">
                  ,
                 </mo>
                </mrow>
               </mtd>
               <mtd class="ltx_align_left" columnalign="left" id="S4.E6.m1.4.4.4ac">
                <mrow id="S4.E6.m1.2.2.2.2.2.1">
                 <mrow id="S4.E6.m1.2.2.2.2.2.1.3">
                  <mtext id="S4.E6.m1.2.2.2.2.2.1.3.2">
                   if
                  </mtext>
                  <mo id="S4.E6.m1.2.2.2.2.2.1.3.1" lspace="0em" rspace="0em">
                   ​
                  </mo>
                  <mi id="S4.E6.m1.2.2.2.2.2.1.3.3">
                   j
                  </mi>
                 </mrow>
                 <mo id="S4.E6.m1.2.2.2.2.2.1.2">
                  &lt;
                 </mo>
                 <mrow id="S4.E6.m1.2.2.2.2.2.1.1.1">
                  <mo id="S4.E6.m1.2.2.2.2.2.1.1.1.2" stretchy="false">
                   |
                  </mo>
                  <msub id="S4.E6.m1.2.2.2.2.2.1.1.1.1">
                   <mi id="S4.E6.m1.2.2.2.2.2.1.1.1.1.2">
                    a
                   </mi>
                   <mi id="S4.E6.m1.2.2.2.2.2.1.1.1.1.3">
                    t
                   </mi>
                  </msub>
                  <mo id="S4.E6.m1.2.2.2.2.2.1.1.1.3" stretchy="false">
                   |
                  </mo>
                 </mrow>
                </mrow>
               </mtd>
              </mtr>
              <mtr id="S4.E6.m1.4.4.4ad">
               <mtd class="ltx_align_left" columnalign="left" id="S4.E6.m1.4.4.4ae">
                <mrow id="S4.E6.m1.3.3.3.3.1.1">
                 <mi id="S4.E6.m1.3.3.3.3.1.1.2">
                  r
                 </mi>
                 <mrow id="S4.E6.m1.3.3.3.3.1.1.3">
                  <mo id="S4.E6.m1.3.3.3.3.1.1.3.1" stretchy="false">
                   (
                  </mo>
                  <msub id="S4.E6.m1.3.3.3.3.1.1.3.2">
                   <mi id="S4.E6.m1.3.3.3.3.1.1.3.2.2">
                    s
                   </mi>
                   <mi id="S4.E6.m1.3.3.3.3.1.1.3.2.3">
                    t
                   </mi>
                  </msub>
                  <mo id="S4.E6.m1.3.3.3.3.1.1.3.3">
                   ,
                  </mo>
                  <msub id="S4.E6.m1.3.3.3.3.1.1.3.4">
                   <mi id="S4.E6.m1.3.3.3.3.1.1.3.4.2">
                    a
                   </mi>
                   <mi id="S4.E6.m1.3.3.3.3.1.1.3.4.3">
                    t
                   </mi>
                  </msub>
                  <mo id="S4.E6.m1.3.3.3.3.1.1.3.5" stretchy="false">
                   )
                  </mo>
                 </mrow>
                 <mo id="S4.E6.m1.3.3.3.3.1.1.4">
                  +
                 </mo>
                 <mi id="S4.E6.m1.3.3.3.3.1.1.5">
                  γ
                 </mi>
                 <mrow id="S4.E6.m1.3.3.3.3.1.1.6">
                  <mo id="S4.E6.m1.3.3.3.3.1.1.6.1" stretchy="false">
                   (
                  </mo>
                  <msub id="S4.E6.m1.3.3.3.3.1.1.6.2">
                   <mi id="S4.E6.m1.3.3.3.3.1.1.6.2.2">
                    𝔼
                   </mi>
                   <mrow id="S4.E6.m1.3.3.3.3.1.1.1.1">
                    <msubsup id="S4.E6.m1.3.3.3.3.1.1.1.1.3">
                     <mi id="S4.E6.m1.3.3.3.3.1.1.1.1.3.2.2">
                      w
                     </mi>
                     <mrow id="S4.E6.m1.3.3.3.3.1.1.1.1.3.2.3">
                      <mi id="S4.E6.m1.3.3.3.3.1.1.1.1.3.2.3.2">
                       t
                      </mi>
                      <mo id="S4.E6.m1.3.3.3.3.1.1.1.1.3.2.3.1">
                       +
                      </mo>
                      <mn id="S4.E6.m1.3.3.3.3.1.1.1.1.3.2.3.3">
                       1
                      </mn>
                     </mrow>
                     <mn id="S4.E6.m1.3.3.3.3.1.1.1.1.3.3">
                      1
                     </mn>
                    </msubsup>
                    <mo id="S4.E6.m1.3.3.3.3.1.1.1.1.2">
                     ∼
                    </mo>
                    <mrow id="S4.E6.m1.3.3.3.3.1.1.1.1.1">
                     <mi id="S4.E6.m1.3.3.3.3.1.1.1.1.1.3">
                      π
                     </mi>
                     <mo id="S4.E6.m1.3.3.3.3.1.1.1.1.1.2" lspace="0em" rspace="0em">
                      ​
                     </mo>
                     <mrow id="S4.E6.m1.3.3.3.3.1.1.1.1.1.1.1">
                      <mo id="S4.E6.m1.3.3.3.3.1.1.1.1.1.1.1.2" stretchy="false">
                       (
                      </mo>
                      <msub id="S4.E6.m1.3.3.3.3.1.1.1.1.1.1.1.1">
                       <mi id="S4.E6.m1.3.3.3.3.1.1.1.1.1.1.1.1.2">
                        s
                       </mi>
                       <mrow id="S4.E6.m1.3.3.3.3.1.1.1.1.1.1.1.1.3">
                        <mi id="S4.E6.m1.3.3.3.3.1.1.1.1.1.1.1.1.3.2">
                         t
                        </mi>
                        <mo id="S4.E6.m1.3.3.3.3.1.1.1.1.1.1.1.1.3.1">
                         +
                        </mo>
                        <mn id="S4.E6.m1.3.3.3.3.1.1.1.1.1.1.1.1.3.3">
                         1
                        </mn>
                       </mrow>
                      </msub>
                      <mo id="S4.E6.m1.3.3.3.3.1.1.1.1.1.1.1.3" stretchy="false">
                       )
                      </mo>
                     </mrow>
                    </mrow>
                   </mrow>
                  </msub>
                  <mrow id="S4.E6.m1.3.3.3.3.1.1.6.3">
                   <mo id="S4.E6.m1.3.3.3.3.1.1.6.3.1" stretchy="false">
                    [
                   </mo>
                   <mi id="S4.E6.m1.3.3.3.3.1.1.6.3.2">
                    Q
                   </mi>
                   <mrow id="S4.E6.m1.3.3.3.3.1.1.6.3.3">
                    <mo id="S4.E6.m1.3.3.3.3.1.1.6.3.3.1" stretchy="false">
                     (
                    </mo>
                    <msub id="S4.E6.m1.3.3.3.3.1.1.6.3.3.2">
                     <mi id="S4.E6.m1.3.3.3.3.1.1.6.3.3.2.2">
                      s
                     </mi>
                     <mrow id="S4.E6.m1.3.3.3.3.1.1.6.3.3.2.3">
                      <mi id="S4.E6.m1.3.3.3.3.1.1.6.3.3.2.3.2">
                       t
                      </mi>
                      <mo id="S4.E6.m1.3.3.3.3.1.1.6.3.3.2.3.1">
                       +
                      </mo>
                      <mn id="S4.E6.m1.3.3.3.3.1.1.6.3.3.2.3.3">
                       1
                      </mn>
                     </mrow>
                    </msub>
                    <mo id="S4.E6.m1.3.3.3.3.1.1.6.3.3.3">
                     ,
                    </mo>
                    <msubsup id="S4.E6.m1.3.3.3.3.1.1.6.3.3.4">
                     <mi id="S4.E6.m1.3.3.3.3.1.1.6.3.3.4.2.2">
                      w
                     </mi>
                     <mrow id="S4.E6.m1.3.3.3.3.1.1.6.3.3.4.2.3">
                      <mi id="S4.E6.m1.3.3.3.3.1.1.6.3.3.4.2.3.2">
                       t
                      </mi>
                      <mo id="S4.E6.m1.3.3.3.3.1.1.6.3.3.4.2.3.1">
                       +
                      </mo>
                      <mn id="S4.E6.m1.3.3.3.3.1.1.6.3.3.4.2.3.3">
                       1
                      </mn>
                     </mrow>
                     <mn id="S4.E6.m1.3.3.3.3.1.1.6.3.3.4.3">
                      1
                     </mn>
                    </msubsup>
                    <mo id="S4.E6.m1.3.3.3.3.1.1.6.3.3.5" stretchy="false">
                     )
                    </mo>
                   </mrow>
                   <mo id="S4.E6.m1.3.3.3.3.1.1.6.3.4" stretchy="false">
                    ]
                   </mo>
                  </mrow>
                  <mo id="S4.E6.m1.3.3.3.3.1.1.6.4">
                   −
                  </mo>
                  <mi id="S4.E6.m1.3.3.3.3.1.1.6.5">
                   β
                  </mi>
                  <msub id="S4.E6.m1.3.3.3.3.1.1.6.6">
                   <mi id="S4.E6.m1.3.3.3.3.1.1.6.6.2">
                    D
                   </mi>
                   <mrow id="S4.E6.m1.3.3.3.3.1.1.6.6.3">
                    <mi id="S4.E6.m1.3.3.3.3.1.1.6.6.3.2">
                     K
                    </mi>
                    <mo id="S4.E6.m1.3.3.3.3.1.1.6.6.3.1" lspace="0em" rspace="0em">
                     ​
                    </mo>
                    <mi id="S4.E6.m1.3.3.3.3.1.1.6.6.3.3">
                     L
                    </mi>
                   </mrow>
                  </msub>
                  <mrow id="S4.E6.m1.3.3.3.3.1.1.6.7">
                   <mo id="S4.E6.m1.3.3.3.3.1.1.6.7.1" stretchy="false">
                    [
                   </mo>
                   <mi id="S4.E6.m1.3.3.3.3.1.1.6.7.2">
                    π
                   </mi>
                   <mo fence="false" id="S4.E6.m1.3.3.3.3.1.1.6.7.3" rspace="0.167em" stretchy="false">
                    |
                   </mo>
                   <mo fence="false" id="S4.E6.m1.3.3.3.3.1.1.6.7.4" rspace="0.167em" stretchy="false">
                    |
                   </mo>
                   <mover accent="true" id="S4.E6.m1.3.3.3.3.1.1.6.7.5">
                    <mi id="S4.E6.m1.3.3.3.3.1.1.6.7.5.2">
                     π
                    </mi>
                    <mo id="S4.E6.m1.3.3.3.3.1.1.6.7.5.1">
                     ¯
                    </mo>
                   </mover>
                   <mo id="S4.E6.m1.3.3.3.3.1.1.6.7.6" stretchy="false">
                    ]
                   </mo>
                  </mrow>
                  <mrow id="S4.E6.m1.3.3.3.3.1.1.6.8">
                   <mo id="S4.E6.m1.3.3.3.3.1.1.6.8.1" stretchy="false">
                    (
                   </mo>
                   <msub id="S4.E6.m1.3.3.3.3.1.1.6.8.2">
                    <mi id="S4.E6.m1.3.3.3.3.1.1.6.8.2.2">
                     s
                    </mi>
                    <mrow id="S4.E6.m1.3.3.3.3.1.1.6.8.2.3">
                     <mi id="S4.E6.m1.3.3.3.3.1.1.6.8.2.3.2">
                      t
                     </mi>
                     <mo id="S4.E6.m1.3.3.3.3.1.1.6.8.2.3.1">
                      +
                     </mo>
                     <mn id="S4.E6.m1.3.3.3.3.1.1.6.8.2.3.3">
                      1
                     </mn>
                    </mrow>
                   </msub>
                   <mo id="S4.E6.m1.3.3.3.3.1.1.6.8.3" stretchy="false">
                    )
                   </mo>
                  </mrow>
                  <mo id="S4.E6.m1.3.3.3.3.1.1.6.9">
                   ,
                  </mo>
                 </mrow>
                </mrow>
               </mtd>
               <mtd class="ltx_align_left" columnalign="left" id="S4.E6.m1.4.4.4af">
                <mrow id="S4.E6.m1.4.4.4.4.2.1">
                 <mrow id="S4.E6.m1.4.4.4.4.2.1.3">
                  <mtext id="S4.E6.m1.4.4.4.4.2.1.3.2">
                   if
                  </mtext>
                  <mo id="S4.E6.m1.4.4.4.4.2.1.3.1" lspace="0em" rspace="0em">
                   ​
                  </mo>
                  <mi id="S4.E6.m1.4.4.4.4.2.1.3.3">
                   j
                  </mi>
                 </mrow>
                 <mo id="S4.E6.m1.4.4.4.4.2.1.2">
                  =
                 </mo>
                 <mrow id="S4.E6.m1.4.4.4.4.2.1.1.1">
                  <mo id="S4.E6.m1.4.4.4.4.2.1.1.1.2" stretchy="false">
                   |
                  </mo>
                  <msub id="S4.E6.m1.4.4.4.4.2.1.1.1.1">
                   <mi id="S4.E6.m1.4.4.4.4.2.1.1.1.1.2">
                    a
                   </mi>
                   <mi id="S4.E6.m1.4.4.4.4.2.1.1.1.1.3">
                    t
                   </mi>
                  </msub>
                  <mo id="S4.E6.m1.4.4.4.4.2.1.1.1.3" stretchy="false">
                   |
                  </mo>
                 </mrow>
                </mrow>
               </mtd>
              </mtr>
             </mtable>
            </mrow>
           </mrow>
           <annotation encoding="application/x-tex" id="S4.E6.m1.7b">
            \displaystyle Q(s_{t},w_{t}^{1:j-1},w_{t}^{j})=\begin{cases}\mathbb{E}_{w_{t}^{j+1}\sim\pi(s_{t},w_{t}^{1:j})}[Q(s_{t},w_{t}^{1:j},w_{t}^{j+1})]-\beta D_{KL}[\pi||\bar{\pi}](s_{t},w_{t}^{1:j}),&amp;\mbox{if }j&lt;|a_{t}|\\
r(s_{t},a_{t})+\gamma(\mathbb{E}_{w_{t+1}^{1}\sim\pi(s_{t+1})}[Q(s_{t+1},w_{t+1}^{1})]-\beta D_{KL}[\pi||\bar{\pi}](s_{t+1}),&amp;\mbox{if }j=|a_{t}|\end{cases}
           </annotation>
          </semantics>
         </math>
        </td>
        <td class="ltx_eqn_cell ltx_eqn_center_padright">
        </td>
        <td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1">
         <span class="ltx_tag ltx_tag_equation ltx_align_right">
          (6)
         </span>
        </td>
       </tr>
      </tbody>
     </table>
    </div>
    <div class="ltx_flex_break">
    </div>
    <div class="ltx_flex_cell ltx_flex_size_1">
     <table class="ltx_equationgroup ltx_centering ltx_eqn_align ltx_figure_panel ltx_eqn_table" id="A7.EGx7">
      <tbody id="S4.E7">
       <tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
        <td class="ltx_eqn_cell ltx_eqn_center_padleft">
        </td>
        <td class="ltx_td ltx_align_right ltx_eqn_cell">
         <math alttext="\displaystyle\pi_{new}=\arg\min_{\pi}\mathcal{J}_{Q}(\pi)=\arg\min_{\pi}D_{KL}\Big{[}\pi(\cdot|s_{t},w_{t}^{1:j-1})||\exp(Q(s_{t},w_{t}^{1:j-1},\cdot)/\beta)\Big{]}." class="ltx_math_unparsed" display="inline" id="S4.E7.m1.1">
          <semantics id="S4.E7.m1.1a">
           <mrow id="S4.E7.m1.1b">
            <msub id="S4.E7.m1.1.2">
             <mi id="S4.E7.m1.1.2.2">
              π
             </mi>
             <mrow id="S4.E7.m1.1.2.3">
              <mi id="S4.E7.m1.1.2.3.2">
               n
              </mi>
              <mo id="S4.E7.m1.1.2.3.1" lspace="0em" rspace="0em">
               ​
              </mo>
              <mi id="S4.E7.m1.1.2.3.3">
               e
              </mi>
              <mo id="S4.E7.m1.1.2.3.1a" lspace="0em" rspace="0em">
               ​
              </mo>
              <mi id="S4.E7.m1.1.2.3.4">
               w
              </mi>
             </mrow>
            </msub>
            <mo id="S4.E7.m1.1.3">
             =
            </mo>
            <mi id="S4.E7.m1.1.4">
             arg
            </mi>
            <munder id="S4.E7.m1.1.5">
             <mi id="S4.E7.m1.1.5.2">
              min
             </mi>
             <mi id="S4.E7.m1.1.5.3">
              π
             </mi>
            </munder>
            <msub id="S4.E7.m1.1.6">
             <mi class="ltx_font_mathcaligraphic" id="S4.E7.m1.1.6.2">
              𝒥
             </mi>
             <mi id="S4.E7.m1.1.6.3">
              Q
             </mi>
            </msub>
            <mrow id="S4.E7.m1.1.7">
             <mo id="S4.E7.m1.1.7.1" stretchy="false">
              (
             </mo>
             <mi id="S4.E7.m1.1.1">
              π
             </mi>
             <mo id="S4.E7.m1.1.7.2" stretchy="false">
              )
             </mo>
            </mrow>
            <mo id="S4.E7.m1.1.8">
             =
            </mo>
            <mi id="S4.E7.m1.1.9">
             arg
            </mi>
            <munder id="S4.E7.m1.1.10">
             <mi id="S4.E7.m1.1.10.2">
              min
             </mi>
             <mi id="S4.E7.m1.1.10.3">
              π
             </mi>
            </munder>
            <msub id="S4.E7.m1.1.11">
             <mi id="S4.E7.m1.1.11.2">
              D
             </mi>
             <mrow id="S4.E7.m1.1.11.3">
              <mi id="S4.E7.m1.1.11.3.2">
               K
              </mi>
              <mo id="S4.E7.m1.1.11.3.1" lspace="0em" rspace="0em">
               ​
              </mo>
              <mi id="S4.E7.m1.1.11.3.3">
               L
              </mi>
             </mrow>
            </msub>
            <mrow id="S4.E7.m1.1.12">
             <mo id="S4.E7.m1.1.12.1" maxsize="160%" minsize="160%">
              [
             </mo>
             <mi id="S4.E7.m1.1.12.2">
              π
             </mi>
             <mrow id="S4.E7.m1.1.12.3">
              <mo id="S4.E7.m1.1.12.3.1" stretchy="false">
               (
              </mo>
              <mo id="S4.E7.m1.1.12.3.2" lspace="0em" rspace="0em">
               ⋅
              </mo>
              <mo fence="false" id="S4.E7.m1.1.12.3.3" rspace="0.167em" stretchy="false">
               |
              </mo>
              <msub id="S4.E7.m1.1.12.3.4">
               <mi id="S4.E7.m1.1.12.3.4.2">
                s
               </mi>
               <mi id="S4.E7.m1.1.12.3.4.3">
                t
               </mi>
              </msub>
              <mo id="S4.E7.m1.1.12.3.5">
               ,
              </mo>
              <msubsup id="S4.E7.m1.1.12.3.6">
               <mi id="S4.E7.m1.1.12.3.6.2.2">
                w
               </mi>
               <mi id="S4.E7.m1.1.12.3.6.2.3">
                t
               </mi>
               <mrow id="S4.E7.m1.1.12.3.6.3">
                <mn id="S4.E7.m1.1.12.3.6.3.2">
                 1
                </mn>
                <mo id="S4.E7.m1.1.12.3.6.3.1" lspace="0.278em" rspace="0.278em">
                 :
                </mo>
                <mrow id="S4.E7.m1.1.12.3.6.3.3">
                 <mi id="S4.E7.m1.1.12.3.6.3.3.2">
                  j
                 </mi>
                 <mo id="S4.E7.m1.1.12.3.6.3.3.1">
                  −
                 </mo>
                 <mn id="S4.E7.m1.1.12.3.6.3.3.3">
                  1
                 </mn>
                </mrow>
               </mrow>
              </msubsup>
              <mo id="S4.E7.m1.1.12.3.7" stretchy="false">
               )
              </mo>
             </mrow>
             <mo fence="false" id="S4.E7.m1.1.12.4" rspace="0.167em" stretchy="false">
              |
             </mo>
             <mo fence="false" id="S4.E7.m1.1.12.5" rspace="0.167em" stretchy="false">
              |
             </mo>
             <mi id="S4.E7.m1.1.12.6">
              exp
             </mi>
             <mrow id="S4.E7.m1.1.12.7">
              <mo id="S4.E7.m1.1.12.7.1" stretchy="false">
               (
              </mo>
              <mi id="S4.E7.m1.1.12.7.2">
               Q
              </mi>
              <mrow id="S4.E7.m1.1.12.7.3">
               <mo id="S4.E7.m1.1.12.7.3.1" stretchy="false">
                (
               </mo>
               <msub id="S4.E7.m1.1.12.7.3.2">
                <mi id="S4.E7.m1.1.12.7.3.2.2">
                 s
                </mi>
                <mi id="S4.E7.m1.1.12.7.3.2.3">
                 t
                </mi>
               </msub>
               <mo id="S4.E7.m1.1.12.7.3.3">
                ,
               </mo>
               <msubsup id="S4.E7.m1.1.12.7.3.4">
                <mi id="S4.E7.m1.1.12.7.3.4.2.2">
                 w
                </mi>
                <mi id="S4.E7.m1.1.12.7.3.4.2.3">
                 t
                </mi>
                <mrow id="S4.E7.m1.1.12.7.3.4.3">
                 <mn id="S4.E7.m1.1.12.7.3.4.3.2">
                  1
                 </mn>
                 <mo id="S4.E7.m1.1.12.7.3.4.3.1" lspace="0.278em" rspace="0.278em">
                  :
                 </mo>
                 <mrow id="S4.E7.m1.1.12.7.3.4.3.3">
                  <mi id="S4.E7.m1.1.12.7.3.4.3.3.2">
                   j
                  </mi>
                  <mo id="S4.E7.m1.1.12.7.3.4.3.3.1">
                   −
                  </mo>
                  <mn id="S4.E7.m1.1.12.7.3.4.3.3.3">
                   1
                  </mn>
                 </mrow>
                </mrow>
               </msubsup>
               <mo id="S4.E7.m1.1.12.7.3.5" rspace="0em">
                ,
               </mo>
               <mo id="S4.E7.m1.1.12.7.3.6" lspace="0em" rspace="0em">
                ⋅
               </mo>
               <mo id="S4.E7.m1.1.12.7.3.7" stretchy="false">
                )
               </mo>
              </mrow>
              <mo id="S4.E7.m1.1.12.7.4">
               /
              </mo>
              <mi id="S4.E7.m1.1.12.7.5">
               β
              </mi>
              <mo id="S4.E7.m1.1.12.7.6" stretchy="false">
               )
              </mo>
             </mrow>
             <mo id="S4.E7.m1.1.12.8" maxsize="160%" minsize="160%">
              ]
             </mo>
            </mrow>
            <mo id="S4.E7.m1.1.13" lspace="0em">
             .
            </mo>
           </mrow>
           <annotation encoding="application/x-tex" id="S4.E7.m1.1c">
            \displaystyle\pi_{new}=\arg\min_{\pi}\mathcal{J}_{Q}(\pi)=\arg\min_{\pi}D_{KL}\Big{[}\pi(\cdot|s_{t},w_{t}^{1:j-1})||\exp(Q(s_{t},w_{t}^{1:j-1},\cdot)/\beta)\Big{]}.
           </annotation>
          </semantics>
         </math>
        </td>
        <td class="ltx_eqn_cell ltx_eqn_center_padright">
        </td>
        <td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1">
         <span class="ltx_tag ltx_tag_equation ltx_align_right">
          (7)
         </span>
        </td>
       </tr>
      </tbody>
     </table>
    </div>
    <div class="ltx_flex_break">
    </div>
   </div>
  </figure>
  <section class="ltx_subsection" id="S4.SS1">
   <h3 class="ltx_title ltx_title_subsection">
    <span class="ltx_tag ltx_tag_subsection">
     4.1
    </span>
    Per-Token Soft Bellman Updates
   </h3>
   <div class="ltx_para" id="S4.SS1.p1">
    <p class="ltx_p" id="S4.SS1.p1.19">
     Decomposing an action into a sequence of tokens,
     <math alttext="a=(w^{1},\dots,w^{|a|})" class="ltx_Math" display="inline" id="S4.SS1.p1.1.m1.4">
      <semantics id="S4.SS1.p1.1.m1.4a">
       <mrow id="S4.SS1.p1.1.m1.4.4" xref="S4.SS1.p1.1.m1.4.4.cmml">
        <mi id="S4.SS1.p1.1.m1.4.4.4" xref="S4.SS1.p1.1.m1.4.4.4.cmml">
         a
        </mi>
        <mo id="S4.SS1.p1.1.m1.4.4.3" xref="S4.SS1.p1.1.m1.4.4.3.cmml">
         =
        </mo>
        <mrow id="S4.SS1.p1.1.m1.4.4.2.2" xref="S4.SS1.p1.1.m1.4.4.2.3.cmml">
         <mo id="S4.SS1.p1.1.m1.4.4.2.2.3" stretchy="false" xref="S4.SS1.p1.1.m1.4.4.2.3.cmml">
          (
         </mo>
         <msup id="S4.SS1.p1.1.m1.3.3.1.1.1" xref="S4.SS1.p1.1.m1.3.3.1.1.1.cmml">
          <mi id="S4.SS1.p1.1.m1.3.3.1.1.1.2" xref="S4.SS1.p1.1.m1.3.3.1.1.1.2.cmml">
           w
          </mi>
          <mn id="S4.SS1.p1.1.m1.3.3.1.1.1.3" xref="S4.SS1.p1.1.m1.3.3.1.1.1.3.cmml">
           1
          </mn>
         </msup>
         <mo id="S4.SS1.p1.1.m1.4.4.2.2.4" xref="S4.SS1.p1.1.m1.4.4.2.3.cmml">
          ,
         </mo>
         <mi id="S4.SS1.p1.1.m1.2.2" mathvariant="normal" xref="S4.SS1.p1.1.m1.2.2.cmml">
          …
         </mi>
         <mo id="S4.SS1.p1.1.m1.4.4.2.2.5" xref="S4.SS1.p1.1.m1.4.4.2.3.cmml">
          ,
         </mo>
         <msup id="S4.SS1.p1.1.m1.4.4.2.2.2" xref="S4.SS1.p1.1.m1.4.4.2.2.2.cmml">
          <mi id="S4.SS1.p1.1.m1.4.4.2.2.2.2" xref="S4.SS1.p1.1.m1.4.4.2.2.2.2.cmml">
           w
          </mi>
          <mrow id="S4.SS1.p1.1.m1.1.1.1.3" xref="S4.SS1.p1.1.m1.1.1.1.2.cmml">
           <mo id="S4.SS1.p1.1.m1.1.1.1.3.1" stretchy="false" xref="S4.SS1.p1.1.m1.1.1.1.2.1.cmml">
            |
           </mo>
           <mi id="S4.SS1.p1.1.m1.1.1.1.1" xref="S4.SS1.p1.1.m1.1.1.1.1.cmml">
            a
           </mi>
           <mo id="S4.SS1.p1.1.m1.1.1.1.3.2" stretchy="false" xref="S4.SS1.p1.1.m1.1.1.1.2.1.cmml">
            |
           </mo>
          </mrow>
         </msup>
         <mo id="S4.SS1.p1.1.m1.4.4.2.2.6" stretchy="false" xref="S4.SS1.p1.1.m1.4.4.2.3.cmml">
          )
         </mo>
        </mrow>
       </mrow>
       <annotation-xml encoding="MathML-Content" id="S4.SS1.p1.1.m1.4b">
        <apply id="S4.SS1.p1.1.m1.4.4.cmml" xref="S4.SS1.p1.1.m1.4.4">
         <eq id="S4.SS1.p1.1.m1.4.4.3.cmml" xref="S4.SS1.p1.1.m1.4.4.3">
         </eq>
         <ci id="S4.SS1.p1.1.m1.4.4.4.cmml" xref="S4.SS1.p1.1.m1.4.4.4">
          𝑎
         </ci>
         <vector id="S4.SS1.p1.1.m1.4.4.2.3.cmml" xref="S4.SS1.p1.1.m1.4.4.2.2">
          <apply id="S4.SS1.p1.1.m1.3.3.1.1.1.cmml" xref="S4.SS1.p1.1.m1.3.3.1.1.1">
           <csymbol cd="ambiguous" id="S4.SS1.p1.1.m1.3.3.1.1.1.1.cmml" xref="S4.SS1.p1.1.m1.3.3.1.1.1">
            superscript
           </csymbol>
           <ci id="S4.SS1.p1.1.m1.3.3.1.1.1.2.cmml" xref="S4.SS1.p1.1.m1.3.3.1.1.1.2">
            𝑤
           </ci>
           <cn id="S4.SS1.p1.1.m1.3.3.1.1.1.3.cmml" type="integer" xref="S4.SS1.p1.1.m1.3.3.1.1.1.3">
            1
           </cn>
          </apply>
          <ci id="S4.SS1.p1.1.m1.2.2.cmml" xref="S4.SS1.p1.1.m1.2.2">
           …
          </ci>
          <apply id="S4.SS1.p1.1.m1.4.4.2.2.2.cmml" xref="S4.SS1.p1.1.m1.4.4.2.2.2">
           <csymbol cd="ambiguous" id="S4.SS1.p1.1.m1.4.4.2.2.2.1.cmml" xref="S4.SS1.p1.1.m1.4.4.2.2.2">
            superscript
           </csymbol>
           <ci id="S4.SS1.p1.1.m1.4.4.2.2.2.2.cmml" xref="S4.SS1.p1.1.m1.4.4.2.2.2.2">
            𝑤
           </ci>
           <apply id="S4.SS1.p1.1.m1.1.1.1.2.cmml" xref="S4.SS1.p1.1.m1.1.1.1.3">
            <abs id="S4.SS1.p1.1.m1.1.1.1.2.1.cmml" xref="S4.SS1.p1.1.m1.1.1.1.3.1">
            </abs>
            <ci id="S4.SS1.p1.1.m1.1.1.1.1.cmml" xref="S4.SS1.p1.1.m1.1.1.1.1">
             𝑎
            </ci>
           </apply>
          </apply>
         </vector>
        </apply>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="S4.SS1.p1.1.m1.4c">
        a=(w^{1},\dots,w^{|a|})
       </annotation>
      </semantics>
     </math>
     , where
     <math alttext="w\in\mathcal{V}" class="ltx_Math" display="inline" id="S4.SS1.p1.2.m2.1">
      <semantics id="S4.SS1.p1.2.m2.1a">
       <mrow id="S4.SS1.p1.2.m2.1.1" xref="S4.SS1.p1.2.m2.1.1.cmml">
        <mi id="S4.SS1.p1.2.m2.1.1.2" xref="S4.SS1.p1.2.m2.1.1.2.cmml">
         w
        </mi>
        <mo id="S4.SS1.p1.2.m2.1.1.1" xref="S4.SS1.p1.2.m2.1.1.1.cmml">
         ∈
        </mo>
        <mi class="ltx_font_mathcaligraphic" id="S4.SS1.p1.2.m2.1.1.3" xref="S4.SS1.p1.2.m2.1.1.3.cmml">
         𝒱
        </mi>
       </mrow>
       <annotation-xml encoding="MathML-Content" id="S4.SS1.p1.2.m2.1b">
        <apply id="S4.SS1.p1.2.m2.1.1.cmml" xref="S4.SS1.p1.2.m2.1.1">
         <in id="S4.SS1.p1.2.m2.1.1.1.cmml" xref="S4.SS1.p1.2.m2.1.1.1">
         </in>
         <ci id="S4.SS1.p1.2.m2.1.1.2.cmml" xref="S4.SS1.p1.2.m2.1.1.2">
          𝑤
         </ci>
         <ci id="S4.SS1.p1.2.m2.1.1.3.cmml" xref="S4.SS1.p1.2.m2.1.1.3">
          𝒱
         </ci>
        </apply>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="S4.SS1.p1.2.m2.1c">
        w\in\mathcal{V}
       </annotation>
      </semantics>
     </math>
     is the tokens and
     <math alttext="|a|" class="ltx_Math" display="inline" id="S4.SS1.p1.3.m3.1">
      <semantics id="S4.SS1.p1.3.m3.1a">
       <mrow id="S4.SS1.p1.3.m3.1.2.2" xref="S4.SS1.p1.3.m3.1.2.1.cmml">
        <mo id="S4.SS1.p1.3.m3.1.2.2.1" stretchy="false" xref="S4.SS1.p1.3.m3.1.2.1.1.cmml">
         |
        </mo>
        <mi id="S4.SS1.p1.3.m3.1.1" xref="S4.SS1.p1.3.m3.1.1.cmml">
         a
        </mi>
        <mo id="S4.SS1.p1.3.m3.1.2.2.2" stretchy="false" xref="S4.SS1.p1.3.m3.1.2.1.1.cmml">
         |
        </mo>
       </mrow>
       <annotation-xml encoding="MathML-Content" id="S4.SS1.p1.3.m3.1b">
        <apply id="S4.SS1.p1.3.m3.1.2.1.cmml" xref="S4.SS1.p1.3.m3.1.2.2">
         <abs id="S4.SS1.p1.3.m3.1.2.1.1.cmml" xref="S4.SS1.p1.3.m3.1.2.2.1">
         </abs>
         <ci id="S4.SS1.p1.3.m3.1.1.cmml" xref="S4.SS1.p1.3.m3.1.1">
          𝑎
         </ci>
        </apply>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="S4.SS1.p1.3.m3.1c">
        |a|
       </annotation>
      </semantics>
     </math>
     is the length of the sequence, we extend the soft Bellman update in Equation
     <a class="ltx_ref" href="#S3.Ex1" title="3.2 Entropy-Regularized Reinforcement Learning ‣ 3 Preliminaries ‣ Entropy-Regularized Token-Level Policy Optimization for Large Language Models">
      <span class="ltx_text ltx_ref_tag">
       3.2
      </span>
     </a>
     to a per-token view of actions, and define a per-token soft Bellman update in Equation
     <a class="ltx_ref" href="#S4.E6" title="Equation 6 ‣ 4 Entropy-Regularized Token-Level Policy Optimization ‣ Entropy-Regularized Token-Level Policy Optimization for Large Language Models">
      <span class="ltx_text ltx_ref_tag">
       6
      </span>
     </a>
     . For a time step
     <math alttext="t" class="ltx_Math" display="inline" id="S4.SS1.p1.4.m4.1">
      <semantics id="S4.SS1.p1.4.m4.1a">
       <mi id="S4.SS1.p1.4.m4.1.1" xref="S4.SS1.p1.4.m4.1.1.cmml">
        t
       </mi>
       <annotation-xml encoding="MathML-Content" id="S4.SS1.p1.4.m4.1b">
        <ci id="S4.SS1.p1.4.m4.1.1.cmml" xref="S4.SS1.p1.4.m4.1.1">
         𝑡
        </ci>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="S4.SS1.p1.4.m4.1c">
        t
       </annotation>
      </semantics>
     </math>
     ,
     <math alttext="w_{t}^{1:j}" class="ltx_Math" display="inline" id="S4.SS1.p1.5.m5.1">
      <semantics id="S4.SS1.p1.5.m5.1a">
       <msubsup id="S4.SS1.p1.5.m5.1.1" xref="S4.SS1.p1.5.m5.1.1.cmml">
        <mi id="S4.SS1.p1.5.m5.1.1.2.2" xref="S4.SS1.p1.5.m5.1.1.2.2.cmml">
         w
        </mi>
        <mi id="S4.SS1.p1.5.m5.1.1.2.3" xref="S4.SS1.p1.5.m5.1.1.2.3.cmml">
         t
        </mi>
        <mrow id="S4.SS1.p1.5.m5.1.1.3" xref="S4.SS1.p1.5.m5.1.1.3.cmml">
         <mn id="S4.SS1.p1.5.m5.1.1.3.2" xref="S4.SS1.p1.5.m5.1.1.3.2.cmml">
          1
         </mn>
         <mo id="S4.SS1.p1.5.m5.1.1.3.1" lspace="0.278em" rspace="0.278em" xref="S4.SS1.p1.5.m5.1.1.3.1.cmml">
          :
         </mo>
         <mi id="S4.SS1.p1.5.m5.1.1.3.3" xref="S4.SS1.p1.5.m5.1.1.3.3.cmml">
          j
         </mi>
        </mrow>
       </msubsup>
       <annotation-xml encoding="MathML-Content" id="S4.SS1.p1.5.m5.1b">
        <apply id="S4.SS1.p1.5.m5.1.1.cmml" xref="S4.SS1.p1.5.m5.1.1">
         <csymbol cd="ambiguous" id="S4.SS1.p1.5.m5.1.1.1.cmml" xref="S4.SS1.p1.5.m5.1.1">
          superscript
         </csymbol>
         <apply id="S4.SS1.p1.5.m5.1.1.2.cmml" xref="S4.SS1.p1.5.m5.1.1">
          <csymbol cd="ambiguous" id="S4.SS1.p1.5.m5.1.1.2.1.cmml" xref="S4.SS1.p1.5.m5.1.1">
           subscript
          </csymbol>
          <ci id="S4.SS1.p1.5.m5.1.1.2.2.cmml" xref="S4.SS1.p1.5.m5.1.1.2.2">
           𝑤
          </ci>
          <ci id="S4.SS1.p1.5.m5.1.1.2.3.cmml" xref="S4.SS1.p1.5.m5.1.1.2.3">
           𝑡
          </ci>
         </apply>
         <apply id="S4.SS1.p1.5.m5.1.1.3.cmml" xref="S4.SS1.p1.5.m5.1.1.3">
          <ci id="S4.SS1.p1.5.m5.1.1.3.1.cmml" xref="S4.SS1.p1.5.m5.1.1.3.1">
           :
          </ci>
          <cn id="S4.SS1.p1.5.m5.1.1.3.2.cmml" type="integer" xref="S4.SS1.p1.5.m5.1.1.3.2">
           1
          </cn>
          <ci id="S4.SS1.p1.5.m5.1.1.3.3.cmml" xref="S4.SS1.p1.5.m5.1.1.3.3">
           𝑗
          </ci>
         </apply>
        </apply>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="S4.SS1.p1.5.m5.1c">
        w_{t}^{1:j}
       </annotation>
      </semantics>
     </math>
     denotes the sequence of tokens in action
     <math alttext="a_{t}" class="ltx_Math" display="inline" id="S4.SS1.p1.6.m6.1">
      <semantics id="S4.SS1.p1.6.m6.1a">
       <msub id="S4.SS1.p1.6.m6.1.1" xref="S4.SS1.p1.6.m6.1.1.cmml">
        <mi id="S4.SS1.p1.6.m6.1.1.2" xref="S4.SS1.p1.6.m6.1.1.2.cmml">
         a
        </mi>
        <mi id="S4.SS1.p1.6.m6.1.1.3" xref="S4.SS1.p1.6.m6.1.1.3.cmml">
         t
        </mi>
       </msub>
       <annotation-xml encoding="MathML-Content" id="S4.SS1.p1.6.m6.1b">
        <apply id="S4.SS1.p1.6.m6.1.1.cmml" xref="S4.SS1.p1.6.m6.1.1">
         <csymbol cd="ambiguous" id="S4.SS1.p1.6.m6.1.1.1.cmml" xref="S4.SS1.p1.6.m6.1.1">
          subscript
         </csymbol>
         <ci id="S4.SS1.p1.6.m6.1.1.2.cmml" xref="S4.SS1.p1.6.m6.1.1.2">
          𝑎
         </ci>
         <ci id="S4.SS1.p1.6.m6.1.1.3.cmml" xref="S4.SS1.p1.6.m6.1.1.3">
          𝑡
         </ci>
        </apply>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="S4.SS1.p1.6.m6.1c">
        a_{t}
       </annotation>
      </semantics>
     </math>
     from the first token
     <math alttext="w_{t}^{1}" class="ltx_Math" display="inline" id="S4.SS1.p1.7.m7.1">
      <semantics id="S4.SS1.p1.7.m7.1a">
       <msubsup id="S4.SS1.p1.7.m7.1.1" xref="S4.SS1.p1.7.m7.1.1.cmml">
        <mi id="S4.SS1.p1.7.m7.1.1.2.2" xref="S4.SS1.p1.7.m7.1.1.2.2.cmml">
         w
        </mi>
        <mi id="S4.SS1.p1.7.m7.1.1.2.3" xref="S4.SS1.p1.7.m7.1.1.2.3.cmml">
         t
        </mi>
        <mn id="S4.SS1.p1.7.m7.1.1.3" xref="S4.SS1.p1.7.m7.1.1.3.cmml">
         1
        </mn>
       </msubsup>
       <annotation-xml encoding="MathML-Content" id="S4.SS1.p1.7.m7.1b">
        <apply id="S4.SS1.p1.7.m7.1.1.cmml" xref="S4.SS1.p1.7.m7.1.1">
         <csymbol cd="ambiguous" id="S4.SS1.p1.7.m7.1.1.1.cmml" xref="S4.SS1.p1.7.m7.1.1">
          superscript
         </csymbol>
         <apply id="S4.SS1.p1.7.m7.1.1.2.cmml" xref="S4.SS1.p1.7.m7.1.1">
          <csymbol cd="ambiguous" id="S4.SS1.p1.7.m7.1.1.2.1.cmml" xref="S4.SS1.p1.7.m7.1.1">
           subscript
          </csymbol>
          <ci id="S4.SS1.p1.7.m7.1.1.2.2.cmml" xref="S4.SS1.p1.7.m7.1.1.2.2">
           𝑤
          </ci>
          <ci id="S4.SS1.p1.7.m7.1.1.2.3.cmml" xref="S4.SS1.p1.7.m7.1.1.2.3">
           𝑡
          </ci>
         </apply>
         <cn id="S4.SS1.p1.7.m7.1.1.3.cmml" type="integer" xref="S4.SS1.p1.7.m7.1.1.3">
          1
         </cn>
        </apply>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="S4.SS1.p1.7.m7.1c">
        w_{t}^{1}
       </annotation>
      </semantics>
     </math>
     to the
     <math alttext="j" class="ltx_Math" display="inline" id="S4.SS1.p1.8.m8.1">
      <semantics id="S4.SS1.p1.8.m8.1a">
       <mi id="S4.SS1.p1.8.m8.1.1" xref="S4.SS1.p1.8.m8.1.1.cmml">
        j
       </mi>
       <annotation-xml encoding="MathML-Content" id="S4.SS1.p1.8.m8.1b">
        <ci id="S4.SS1.p1.8.m8.1.1.cmml" xref="S4.SS1.p1.8.m8.1.1">
         𝑗
        </ci>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="S4.SS1.p1.8.m8.1c">
        j
       </annotation>
      </semantics>
     </math>
     -th token
     <math alttext="w_{t}^{j}" class="ltx_Math" display="inline" id="S4.SS1.p1.9.m9.1">
      <semantics id="S4.SS1.p1.9.m9.1a">
       <msubsup id="S4.SS1.p1.9.m9.1.1" xref="S4.SS1.p1.9.m9.1.1.cmml">
        <mi id="S4.SS1.p1.9.m9.1.1.2.2" xref="S4.SS1.p1.9.m9.1.1.2.2.cmml">
         w
        </mi>
        <mi id="S4.SS1.p1.9.m9.1.1.2.3" xref="S4.SS1.p1.9.m9.1.1.2.3.cmml">
         t
        </mi>
        <mi id="S4.SS1.p1.9.m9.1.1.3" xref="S4.SS1.p1.9.m9.1.1.3.cmml">
         j
        </mi>
       </msubsup>
       <annotation-xml encoding="MathML-Content" id="S4.SS1.p1.9.m9.1b">
        <apply id="S4.SS1.p1.9.m9.1.1.cmml" xref="S4.SS1.p1.9.m9.1.1">
         <csymbol cd="ambiguous" id="S4.SS1.p1.9.m9.1.1.1.cmml" xref="S4.SS1.p1.9.m9.1.1">
          superscript
         </csymbol>
         <apply id="S4.SS1.p1.9.m9.1.1.2.cmml" xref="S4.SS1.p1.9.m9.1.1">
          <csymbol cd="ambiguous" id="S4.SS1.p1.9.m9.1.1.2.1.cmml" xref="S4.SS1.p1.9.m9.1.1">
           subscript
          </csymbol>
          <ci id="S4.SS1.p1.9.m9.1.1.2.2.cmml" xref="S4.SS1.p1.9.m9.1.1.2.2">
           𝑤
          </ci>
          <ci id="S4.SS1.p1.9.m9.1.1.2.3.cmml" xref="S4.SS1.p1.9.m9.1.1.2.3">
           𝑡
          </ci>
         </apply>
         <ci id="S4.SS1.p1.9.m9.1.1.3.cmml" xref="S4.SS1.p1.9.m9.1.1.3">
          𝑗
         </ci>
        </apply>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="S4.SS1.p1.9.m9.1c">
        w_{t}^{j}
       </annotation>
      </semantics>
     </math>
     , i.e.
     <math alttext="w_{t}^{1:j}=(w_{t}^{1},\dots,w_{t}^{j})" class="ltx_Math" display="inline" id="S4.SS1.p1.10.m10.3">
      <semantics id="S4.SS1.p1.10.m10.3a">
       <mrow id="S4.SS1.p1.10.m10.3.3" xref="S4.SS1.p1.10.m10.3.3.cmml">
        <msubsup id="S4.SS1.p1.10.m10.3.3.4" xref="S4.SS1.p1.10.m10.3.3.4.cmml">
         <mi id="S4.SS1.p1.10.m10.3.3.4.2.2" xref="S4.SS1.p1.10.m10.3.3.4.2.2.cmml">
          w
         </mi>
         <mi id="S4.SS1.p1.10.m10.3.3.4.2.3" xref="S4.SS1.p1.10.m10.3.3.4.2.3.cmml">
          t
         </mi>
         <mrow id="S4.SS1.p1.10.m10.3.3.4.3" xref="S4.SS1.p1.10.m10.3.3.4.3.cmml">
          <mn id="S4.SS1.p1.10.m10.3.3.4.3.2" xref="S4.SS1.p1.10.m10.3.3.4.3.2.cmml">
           1
          </mn>
          <mo id="S4.SS1.p1.10.m10.3.3.4.3.1" lspace="0.278em" rspace="0.278em" xref="S4.SS1.p1.10.m10.3.3.4.3.1.cmml">
           :
          </mo>
          <mi id="S4.SS1.p1.10.m10.3.3.4.3.3" xref="S4.SS1.p1.10.m10.3.3.4.3.3.cmml">
           j
          </mi>
         </mrow>
        </msubsup>
        <mo id="S4.SS1.p1.10.m10.3.3.3" xref="S4.SS1.p1.10.m10.3.3.3.cmml">
         =
        </mo>
        <mrow id="S4.SS1.p1.10.m10.3.3.2.2" xref="S4.SS1.p1.10.m10.3.3.2.3.cmml">
         <mo id="S4.SS1.p1.10.m10.3.3.2.2.3" stretchy="false" xref="S4.SS1.p1.10.m10.3.3.2.3.cmml">
          (
         </mo>
         <msubsup id="S4.SS1.p1.10.m10.2.2.1.1.1" xref="S4.SS1.p1.10.m10.2.2.1.1.1.cmml">
          <mi id="S4.SS1.p1.10.m10.2.2.1.1.1.2.2" xref="S4.SS1.p1.10.m10.2.2.1.1.1.2.2.cmml">
           w
          </mi>
          <mi id="S4.SS1.p1.10.m10.2.2.1.1.1.2.3" xref="S4.SS1.p1.10.m10.2.2.1.1.1.2.3.cmml">
           t
          </mi>
          <mn id="S4.SS1.p1.10.m10.2.2.1.1.1.3" xref="S4.SS1.p1.10.m10.2.2.1.1.1.3.cmml">
           1
          </mn>
         </msubsup>
         <mo id="S4.SS1.p1.10.m10.3.3.2.2.4" xref="S4.SS1.p1.10.m10.3.3.2.3.cmml">
          ,
         </mo>
         <mi id="S4.SS1.p1.10.m10.1.1" mathvariant="normal" xref="S4.SS1.p1.10.m10.1.1.cmml">
          …
         </mi>
         <mo id="S4.SS1.p1.10.m10.3.3.2.2.5" xref="S4.SS1.p1.10.m10.3.3.2.3.cmml">
          ,
         </mo>
         <msubsup id="S4.SS1.p1.10.m10.3.3.2.2.2" xref="S4.SS1.p1.10.m10.3.3.2.2.2.cmml">
          <mi id="S4.SS1.p1.10.m10.3.3.2.2.2.2.2" xref="S4.SS1.p1.10.m10.3.3.2.2.2.2.2.cmml">
           w
          </mi>
          <mi id="S4.SS1.p1.10.m10.3.3.2.2.2.2.3" xref="S4.SS1.p1.10.m10.3.3.2.2.2.2.3.cmml">
           t
          </mi>
          <mi id="S4.SS1.p1.10.m10.3.3.2.2.2.3" xref="S4.SS1.p1.10.m10.3.3.2.2.2.3.cmml">
           j
          </mi>
         </msubsup>
         <mo id="S4.SS1.p1.10.m10.3.3.2.2.6" stretchy="false" xref="S4.SS1.p1.10.m10.3.3.2.3.cmml">
          )
         </mo>
        </mrow>
       </mrow>
       <annotation-xml encoding="MathML-Content" id="S4.SS1.p1.10.m10.3b">
        <apply id="S4.SS1.p1.10.m10.3.3.cmml" xref="S4.SS1.p1.10.m10.3.3">
         <eq id="S4.SS1.p1.10.m10.3.3.3.cmml" xref="S4.SS1.p1.10.m10.3.3.3">
         </eq>
         <apply id="S4.SS1.p1.10.m10.3.3.4.cmml" xref="S4.SS1.p1.10.m10.3.3.4">
          <csymbol cd="ambiguous" id="S4.SS1.p1.10.m10.3.3.4.1.cmml" xref="S4.SS1.p1.10.m10.3.3.4">
           superscript
          </csymbol>
          <apply id="S4.SS1.p1.10.m10.3.3.4.2.cmml" xref="S4.SS1.p1.10.m10.3.3.4">
           <csymbol cd="ambiguous" id="S4.SS1.p1.10.m10.3.3.4.2.1.cmml" xref="S4.SS1.p1.10.m10.3.3.4">
            subscript
           </csymbol>
           <ci id="S4.SS1.p1.10.m10.3.3.4.2.2.cmml" xref="S4.SS1.p1.10.m10.3.3.4.2.2">
            𝑤
           </ci>
           <ci id="S4.SS1.p1.10.m10.3.3.4.2.3.cmml" xref="S4.SS1.p1.10.m10.3.3.4.2.3">
            𝑡
           </ci>
          </apply>
          <apply id="S4.SS1.p1.10.m10.3.3.4.3.cmml" xref="S4.SS1.p1.10.m10.3.3.4.3">
           <ci id="S4.SS1.p1.10.m10.3.3.4.3.1.cmml" xref="S4.SS1.p1.10.m10.3.3.4.3.1">
            :
           </ci>
           <cn id="S4.SS1.p1.10.m10.3.3.4.3.2.cmml" type="integer" xref="S4.SS1.p1.10.m10.3.3.4.3.2">
            1
           </cn>
           <ci id="S4.SS1.p1.10.m10.3.3.4.3.3.cmml" xref="S4.SS1.p1.10.m10.3.3.4.3.3">
            𝑗
           </ci>
          </apply>
         </apply>
         <vector id="S4.SS1.p1.10.m10.3.3.2.3.cmml" xref="S4.SS1.p1.10.m10.3.3.2.2">
          <apply id="S4.SS1.p1.10.m10.2.2.1.1.1.cmml" xref="S4.SS1.p1.10.m10.2.2.1.1.1">
           <csymbol cd="ambiguous" id="S4.SS1.p1.10.m10.2.2.1.1.1.1.cmml" xref="S4.SS1.p1.10.m10.2.2.1.1.1">
            superscript
           </csymbol>
           <apply id="S4.SS1.p1.10.m10.2.2.1.1.1.2.cmml" xref="S4.SS1.p1.10.m10.2.2.1.1.1">
            <csymbol cd="ambiguous" id="S4.SS1.p1.10.m10.2.2.1.1.1.2.1.cmml" xref="S4.SS1.p1.10.m10.2.2.1.1.1">
             subscript
            </csymbol>
            <ci id="S4.SS1.p1.10.m10.2.2.1.1.1.2.2.cmml" xref="S4.SS1.p1.10.m10.2.2.1.1.1.2.2">
             𝑤
            </ci>
            <ci id="S4.SS1.p1.10.m10.2.2.1.1.1.2.3.cmml" xref="S4.SS1.p1.10.m10.2.2.1.1.1.2.3">
             𝑡
            </ci>
           </apply>
           <cn id="S4.SS1.p1.10.m10.2.2.1.1.1.3.cmml" type="integer" xref="S4.SS1.p1.10.m10.2.2.1.1.1.3">
            1
           </cn>
          </apply>
          <ci id="S4.SS1.p1.10.m10.1.1.cmml" xref="S4.SS1.p1.10.m10.1.1">
           …
          </ci>
          <apply id="S4.SS1.p1.10.m10.3.3.2.2.2.cmml" xref="S4.SS1.p1.10.m10.3.3.2.2.2">
           <csymbol cd="ambiguous" id="S4.SS1.p1.10.m10.3.3.2.2.2.1.cmml" xref="S4.SS1.p1.10.m10.3.3.2.2.2">
            superscript
           </csymbol>
           <apply id="S4.SS1.p1.10.m10.3.3.2.2.2.2.cmml" xref="S4.SS1.p1.10.m10.3.3.2.2.2">
            <csymbol cd="ambiguous" id="S4.SS1.p1.10.m10.3.3.2.2.2.2.1.cmml" xref="S4.SS1.p1.10.m10.3.3.2.2.2">
             subscript
            </csymbol>
            <ci id="S4.SS1.p1.10.m10.3.3.2.2.2.2.2.cmml" xref="S4.SS1.p1.10.m10.3.3.2.2.2.2.2">
             𝑤
            </ci>
            <ci id="S4.SS1.p1.10.m10.3.3.2.2.2.2.3.cmml" xref="S4.SS1.p1.10.m10.3.3.2.2.2.2.3">
             𝑡
            </ci>
           </apply>
           <ci id="S4.SS1.p1.10.m10.3.3.2.2.2.3.cmml" xref="S4.SS1.p1.10.m10.3.3.2.2.2.3">
            𝑗
           </ci>
          </apply>
         </vector>
        </apply>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="S4.SS1.p1.10.m10.3c">
        w_{t}^{1:j}=(w_{t}^{1},\dots,w_{t}^{j})
       </annotation>
      </semantics>
     </math>
     . Then we define the soft Q-value of the
     <math alttext="j" class="ltx_Math" display="inline" id="S4.SS1.p1.11.m11.1">
      <semantics id="S4.SS1.p1.11.m11.1a">
       <mi id="S4.SS1.p1.11.m11.1.1" xref="S4.SS1.p1.11.m11.1.1.cmml">
        j
       </mi>
       <annotation-xml encoding="MathML-Content" id="S4.SS1.p1.11.m11.1b">
        <ci id="S4.SS1.p1.11.m11.1.1.cmml" xref="S4.SS1.p1.11.m11.1.1">
         𝑗
        </ci>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="S4.SS1.p1.11.m11.1c">
        j
       </annotation>
      </semantics>
     </math>
     -th token
     <math alttext="w_{t}^{j}" class="ltx_Math" display="inline" id="S4.SS1.p1.12.m12.1">
      <semantics id="S4.SS1.p1.12.m12.1a">
       <msubsup id="S4.SS1.p1.12.m12.1.1" xref="S4.SS1.p1.12.m12.1.1.cmml">
        <mi id="S4.SS1.p1.12.m12.1.1.2.2" xref="S4.SS1.p1.12.m12.1.1.2.2.cmml">
         w
        </mi>
        <mi id="S4.SS1.p1.12.m12.1.1.2.3" xref="S4.SS1.p1.12.m12.1.1.2.3.cmml">
         t
        </mi>
        <mi id="S4.SS1.p1.12.m12.1.1.3" xref="S4.SS1.p1.12.m12.1.1.3.cmml">
         j
        </mi>
       </msubsup>
       <annotation-xml encoding="MathML-Content" id="S4.SS1.p1.12.m12.1b">
        <apply id="S4.SS1.p1.12.m12.1.1.cmml" xref="S4.SS1.p1.12.m12.1.1">
         <csymbol cd="ambiguous" id="S4.SS1.p1.12.m12.1.1.1.cmml" xref="S4.SS1.p1.12.m12.1.1">
          superscript
         </csymbol>
         <apply id="S4.SS1.p1.12.m12.1.1.2.cmml" xref="S4.SS1.p1.12.m12.1.1">
          <csymbol cd="ambiguous" id="S4.SS1.p1.12.m12.1.1.2.1.cmml" xref="S4.SS1.p1.12.m12.1.1">
           subscript
          </csymbol>
          <ci id="S4.SS1.p1.12.m12.1.1.2.2.cmml" xref="S4.SS1.p1.12.m12.1.1.2.2">
           𝑤
          </ci>
          <ci id="S4.SS1.p1.12.m12.1.1.2.3.cmml" xref="S4.SS1.p1.12.m12.1.1.2.3">
           𝑡
          </ci>
         </apply>
         <ci id="S4.SS1.p1.12.m12.1.1.3.cmml" xref="S4.SS1.p1.12.m12.1.1.3">
          𝑗
         </ci>
        </apply>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="S4.SS1.p1.12.m12.1c">
        w_{t}^{j}
       </annotation>
      </semantics>
     </math>
     conditioned on the textual state
     <math alttext="s_{t}" class="ltx_Math" display="inline" id="S4.SS1.p1.13.m13.1">
      <semantics id="S4.SS1.p1.13.m13.1a">
       <msub id="S4.SS1.p1.13.m13.1.1" xref="S4.SS1.p1.13.m13.1.1.cmml">
        <mi id="S4.SS1.p1.13.m13.1.1.2" xref="S4.SS1.p1.13.m13.1.1.2.cmml">
         s
        </mi>
        <mi id="S4.SS1.p1.13.m13.1.1.3" xref="S4.SS1.p1.13.m13.1.1.3.cmml">
         t
        </mi>
       </msub>
       <annotation-xml encoding="MathML-Content" id="S4.SS1.p1.13.m13.1b">
        <apply id="S4.SS1.p1.13.m13.1.1.cmml" xref="S4.SS1.p1.13.m13.1.1">
         <csymbol cd="ambiguous" id="S4.SS1.p1.13.m13.1.1.1.cmml" xref="S4.SS1.p1.13.m13.1.1">
          subscript
         </csymbol>
         <ci id="S4.SS1.p1.13.m13.1.1.2.cmml" xref="S4.SS1.p1.13.m13.1.1.2">
          𝑠
         </ci>
         <ci id="S4.SS1.p1.13.m13.1.1.3.cmml" xref="S4.SS1.p1.13.m13.1.1.3">
          𝑡
         </ci>
        </apply>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="S4.SS1.p1.13.m13.1c">
        s_{t}
       </annotation>
      </semantics>
     </math>
     and previous action tokens
     <math alttext="w_{t}^{1:j-1}" class="ltx_Math" display="inline" id="S4.SS1.p1.14.m14.1">
      <semantics id="S4.SS1.p1.14.m14.1a">
       <msubsup id="S4.SS1.p1.14.m14.1.1" xref="S4.SS1.p1.14.m14.1.1.cmml">
        <mi id="S4.SS1.p1.14.m14.1.1.2.2" xref="S4.SS1.p1.14.m14.1.1.2.2.cmml">
         w
        </mi>
        <mi id="S4.SS1.p1.14.m14.1.1.2.3" xref="S4.SS1.p1.14.m14.1.1.2.3.cmml">
         t
        </mi>
        <mrow id="S4.SS1.p1.14.m14.1.1.3" xref="S4.SS1.p1.14.m14.1.1.3.cmml">
         <mn id="S4.SS1.p1.14.m14.1.1.3.2" xref="S4.SS1.p1.14.m14.1.1.3.2.cmml">
          1
         </mn>
         <mo id="S4.SS1.p1.14.m14.1.1.3.1" lspace="0.278em" rspace="0.278em" xref="S4.SS1.p1.14.m14.1.1.3.1.cmml">
          :
         </mo>
         <mrow id="S4.SS1.p1.14.m14.1.1.3.3" xref="S4.SS1.p1.14.m14.1.1.3.3.cmml">
          <mi id="S4.SS1.p1.14.m14.1.1.3.3.2" xref="S4.SS1.p1.14.m14.1.1.3.3.2.cmml">
           j
          </mi>
          <mo id="S4.SS1.p1.14.m14.1.1.3.3.1" xref="S4.SS1.p1.14.m14.1.1.3.3.1.cmml">
           −
          </mo>
          <mn id="S4.SS1.p1.14.m14.1.1.3.3.3" xref="S4.SS1.p1.14.m14.1.1.3.3.3.cmml">
           1
          </mn>
         </mrow>
        </mrow>
       </msubsup>
       <annotation-xml encoding="MathML-Content" id="S4.SS1.p1.14.m14.1b">
        <apply id="S4.SS1.p1.14.m14.1.1.cmml" xref="S4.SS1.p1.14.m14.1.1">
         <csymbol cd="ambiguous" id="S4.SS1.p1.14.m14.1.1.1.cmml" xref="S4.SS1.p1.14.m14.1.1">
          superscript
         </csymbol>
         <apply id="S4.SS1.p1.14.m14.1.1.2.cmml" xref="S4.SS1.p1.14.m14.1.1">
          <csymbol cd="ambiguous" id="S4.SS1.p1.14.m14.1.1.2.1.cmml" xref="S4.SS1.p1.14.m14.1.1">
           subscript
          </csymbol>
          <ci id="S4.SS1.p1.14.m14.1.1.2.2.cmml" xref="S4.SS1.p1.14.m14.1.1.2.2">
           𝑤
          </ci>
          <ci id="S4.SS1.p1.14.m14.1.1.2.3.cmml" xref="S4.SS1.p1.14.m14.1.1.2.3">
           𝑡
          </ci>
         </apply>
         <apply id="S4.SS1.p1.14.m14.1.1.3.cmml" xref="S4.SS1.p1.14.m14.1.1.3">
          <ci id="S4.SS1.p1.14.m14.1.1.3.1.cmml" xref="S4.SS1.p1.14.m14.1.1.3.1">
           :
          </ci>
          <cn id="S4.SS1.p1.14.m14.1.1.3.2.cmml" type="integer" xref="S4.SS1.p1.14.m14.1.1.3.2">
           1
          </cn>
          <apply id="S4.SS1.p1.14.m14.1.1.3.3.cmml" xref="S4.SS1.p1.14.m14.1.1.3.3">
           <minus id="S4.SS1.p1.14.m14.1.1.3.3.1.cmml" xref="S4.SS1.p1.14.m14.1.1.3.3.1">
           </minus>
           <ci id="S4.SS1.p1.14.m14.1.1.3.3.2.cmml" xref="S4.SS1.p1.14.m14.1.1.3.3.2">
            𝑗
           </ci>
           <cn id="S4.SS1.p1.14.m14.1.1.3.3.3.cmml" type="integer" xref="S4.SS1.p1.14.m14.1.1.3.3.3">
            1
           </cn>
          </apply>
         </apply>
        </apply>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="S4.SS1.p1.14.m14.1c">
        w_{t}^{1:j-1}
       </annotation>
      </semantics>
     </math>
     in an auto-regressive manner, without discount when
     <math alttext="j&lt;|a_{t}|" class="ltx_Math" display="inline" id="S4.SS1.p1.15.m15.1">
      <semantics id="S4.SS1.p1.15.m15.1a">
       <mrow id="S4.SS1.p1.15.m15.1.1" xref="S4.SS1.p1.15.m15.1.1.cmml">
        <mi id="S4.SS1.p1.15.m15.1.1.3" xref="S4.SS1.p1.15.m15.1.1.3.cmml">
         j
        </mi>
        <mo id="S4.SS1.p1.15.m15.1.1.2" xref="S4.SS1.p1.15.m15.1.1.2.cmml">
         &lt;
        </mo>
        <mrow id="S4.SS1.p1.15.m15.1.1.1.1" xref="S4.SS1.p1.15.m15.1.1.1.2.cmml">
         <mo id="S4.SS1.p1.15.m15.1.1.1.1.2" stretchy="false" xref="S4.SS1.p1.15.m15.1.1.1.2.1.cmml">
          |
         </mo>
         <msub id="S4.SS1.p1.15.m15.1.1.1.1.1" xref="S4.SS1.p1.15.m15.1.1.1.1.1.cmml">
          <mi id="S4.SS1.p1.15.m15.1.1.1.1.1.2" xref="S4.SS1.p1.15.m15.1.1.1.1.1.2.cmml">
           a
          </mi>
          <mi id="S4.SS1.p1.15.m15.1.1.1.1.1.3" xref="S4.SS1.p1.15.m15.1.1.1.1.1.3.cmml">
           t
          </mi>
         </msub>
         <mo id="S4.SS1.p1.15.m15.1.1.1.1.3" stretchy="false" xref="S4.SS1.p1.15.m15.1.1.1.2.1.cmml">
          |
         </mo>
        </mrow>
       </mrow>
       <annotation-xml encoding="MathML-Content" id="S4.SS1.p1.15.m15.1b">
        <apply id="S4.SS1.p1.15.m15.1.1.cmml" xref="S4.SS1.p1.15.m15.1.1">
         <lt id="S4.SS1.p1.15.m15.1.1.2.cmml" xref="S4.SS1.p1.15.m15.1.1.2">
         </lt>
         <ci id="S4.SS1.p1.15.m15.1.1.3.cmml" xref="S4.SS1.p1.15.m15.1.1.3">
          𝑗
         </ci>
         <apply id="S4.SS1.p1.15.m15.1.1.1.2.cmml" xref="S4.SS1.p1.15.m15.1.1.1.1">
          <abs id="S4.SS1.p1.15.m15.1.1.1.2.1.cmml" xref="S4.SS1.p1.15.m15.1.1.1.1.2">
          </abs>
          <apply id="S4.SS1.p1.15.m15.1.1.1.1.1.cmml" xref="S4.SS1.p1.15.m15.1.1.1.1.1">
           <csymbol cd="ambiguous" id="S4.SS1.p1.15.m15.1.1.1.1.1.1.cmml" xref="S4.SS1.p1.15.m15.1.1.1.1.1">
            subscript
           </csymbol>
           <ci id="S4.SS1.p1.15.m15.1.1.1.1.1.2.cmml" xref="S4.SS1.p1.15.m15.1.1.1.1.1.2">
            𝑎
           </ci>
           <ci id="S4.SS1.p1.15.m15.1.1.1.1.1.3.cmml" xref="S4.SS1.p1.15.m15.1.1.1.1.1.3">
            𝑡
           </ci>
          </apply>
         </apply>
        </apply>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="S4.SS1.p1.15.m15.1c">
        j&lt;|a_{t}|
       </annotation>
      </semantics>
     </math>
     (first line in the equation). When
     <math alttext="j=|a_{t}|" class="ltx_Math" display="inline" id="S4.SS1.p1.16.m16.1">
      <semantics id="S4.SS1.p1.16.m16.1a">
       <mrow id="S4.SS1.p1.16.m16.1.1" xref="S4.SS1.p1.16.m16.1.1.cmml">
        <mi id="S4.SS1.p1.16.m16.1.1.3" xref="S4.SS1.p1.16.m16.1.1.3.cmml">
         j
        </mi>
        <mo id="S4.SS1.p1.16.m16.1.1.2" xref="S4.SS1.p1.16.m16.1.1.2.cmml">
         =
        </mo>
        <mrow id="S4.SS1.p1.16.m16.1.1.1.1" xref="S4.SS1.p1.16.m16.1.1.1.2.cmml">
         <mo id="S4.SS1.p1.16.m16.1.1.1.1.2" stretchy="false" xref="S4.SS1.p1.16.m16.1.1.1.2.1.cmml">
          |
         </mo>
         <msub id="S4.SS1.p1.16.m16.1.1.1.1.1" xref="S4.SS1.p1.16.m16.1.1.1.1.1.cmml">
          <mi id="S4.SS1.p1.16.m16.1.1.1.1.1.2" xref="S4.SS1.p1.16.m16.1.1.1.1.1.2.cmml">
           a
          </mi>
          <mi id="S4.SS1.p1.16.m16.1.1.1.1.1.3" xref="S4.SS1.p1.16.m16.1.1.1.1.1.3.cmml">
           t
          </mi>
         </msub>
         <mo id="S4.SS1.p1.16.m16.1.1.1.1.3" stretchy="false" xref="S4.SS1.p1.16.m16.1.1.1.2.1.cmml">
          |
         </mo>
        </mrow>
       </mrow>
       <annotation-xml encoding="MathML-Content" id="S4.SS1.p1.16.m16.1b">
        <apply id="S4.SS1.p1.16.m16.1.1.cmml" xref="S4.SS1.p1.16.m16.1.1">
         <eq id="S4.SS1.p1.16.m16.1.1.2.cmml" xref="S4.SS1.p1.16.m16.1.1.2">
         </eq>
         <ci id="S4.SS1.p1.16.m16.1.1.3.cmml" xref="S4.SS1.p1.16.m16.1.1.3">
          𝑗
         </ci>
         <apply id="S4.SS1.p1.16.m16.1.1.1.2.cmml" xref="S4.SS1.p1.16.m16.1.1.1.1">
          <abs id="S4.SS1.p1.16.m16.1.1.1.2.1.cmml" xref="S4.SS1.p1.16.m16.1.1.1.1.2">
          </abs>
          <apply id="S4.SS1.p1.16.m16.1.1.1.1.1.cmml" xref="S4.SS1.p1.16.m16.1.1.1.1.1">
           <csymbol cd="ambiguous" id="S4.SS1.p1.16.m16.1.1.1.1.1.1.cmml" xref="S4.SS1.p1.16.m16.1.1.1.1.1">
            subscript
           </csymbol>
           <ci id="S4.SS1.p1.16.m16.1.1.1.1.1.2.cmml" xref="S4.SS1.p1.16.m16.1.1.1.1.1.2">
            𝑎
           </ci>
           <ci id="S4.SS1.p1.16.m16.1.1.1.1.1.3.cmml" xref="S4.SS1.p1.16.m16.1.1.1.1.1.3">
            𝑡
           </ci>
          </apply>
         </apply>
        </apply>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="S4.SS1.p1.16.m16.1c">
        j=|a_{t}|
       </annotation>
      </semantics>
     </math>
     , The reward
     <math alttext="r(s_{t},a_{t})" class="ltx_Math" display="inline" id="S4.SS1.p1.17.m17.2">
      <semantics id="S4.SS1.p1.17.m17.2a">
       <mrow id="S4.SS1.p1.17.m17.2.2" xref="S4.SS1.p1.17.m17.2.2.cmml">
        <mi id="S4.SS1.p1.17.m17.2.2.4" xref="S4.SS1.p1.17.m17.2.2.4.cmml">
         r
        </mi>
        <mo id="S4.SS1.p1.17.m17.2.2.3" lspace="0em" rspace="0em" xref="S4.SS1.p1.17.m17.2.2.3.cmml">
         ​
        </mo>
        <mrow id="S4.SS1.p1.17.m17.2.2.2.2" xref="S4.SS1.p1.17.m17.2.2.2.3.cmml">
         <mo id="S4.SS1.p1.17.m17.2.2.2.2.3" stretchy="false" xref="S4.SS1.p1.17.m17.2.2.2.3.cmml">
          (
         </mo>
         <msub id="S4.SS1.p1.17.m17.1.1.1.1.1" xref="S4.SS1.p1.17.m17.1.1.1.1.1.cmml">
          <mi id="S4.SS1.p1.17.m17.1.1.1.1.1.2" xref="S4.SS1.p1.17.m17.1.1.1.1.1.2.cmml">
           s
          </mi>
          <mi id="S4.SS1.p1.17.m17.1.1.1.1.1.3" xref="S4.SS1.p1.17.m17.1.1.1.1.1.3.cmml">
           t
          </mi>
         </msub>
         <mo id="S4.SS1.p1.17.m17.2.2.2.2.4" xref="S4.SS1.p1.17.m17.2.2.2.3.cmml">
          ,
         </mo>
         <msub id="S4.SS1.p1.17.m17.2.2.2.2.2" xref="S4.SS1.p1.17.m17.2.2.2.2.2.cmml">
          <mi id="S4.SS1.p1.17.m17.2.2.2.2.2.2" xref="S4.SS1.p1.17.m17.2.2.2.2.2.2.cmml">
           a
          </mi>
          <mi id="S4.SS1.p1.17.m17.2.2.2.2.2.3" xref="S4.SS1.p1.17.m17.2.2.2.2.2.3.cmml">
           t
          </mi>
         </msub>
         <mo id="S4.SS1.p1.17.m17.2.2.2.2.5" stretchy="false" xref="S4.SS1.p1.17.m17.2.2.2.3.cmml">
          )
         </mo>
        </mrow>
       </mrow>
       <annotation-xml encoding="MathML-Content" id="S4.SS1.p1.17.m17.2b">
        <apply id="S4.SS1.p1.17.m17.2.2.cmml" xref="S4.SS1.p1.17.m17.2.2">
         <times id="S4.SS1.p1.17.m17.2.2.3.cmml" xref="S4.SS1.p1.17.m17.2.2.3">
         </times>
         <ci id="S4.SS1.p1.17.m17.2.2.4.cmml" xref="S4.SS1.p1.17.m17.2.2.4">
          𝑟
         </ci>
         <interval closure="open" id="S4.SS1.p1.17.m17.2.2.2.3.cmml" xref="S4.SS1.p1.17.m17.2.2.2.2">
          <apply id="S4.SS1.p1.17.m17.1.1.1.1.1.cmml" xref="S4.SS1.p1.17.m17.1.1.1.1.1">
           <csymbol cd="ambiguous" id="S4.SS1.p1.17.m17.1.1.1.1.1.1.cmml" xref="S4.SS1.p1.17.m17.1.1.1.1.1">
            subscript
           </csymbol>
           <ci id="S4.SS1.p1.17.m17.1.1.1.1.1.2.cmml" xref="S4.SS1.p1.17.m17.1.1.1.1.1.2">
            𝑠
           </ci>
           <ci id="S4.SS1.p1.17.m17.1.1.1.1.1.3.cmml" xref="S4.SS1.p1.17.m17.1.1.1.1.1.3">
            𝑡
           </ci>
          </apply>
          <apply id="S4.SS1.p1.17.m17.2.2.2.2.2.cmml" xref="S4.SS1.p1.17.m17.2.2.2.2.2">
           <csymbol cd="ambiguous" id="S4.SS1.p1.17.m17.2.2.2.2.2.1.cmml" xref="S4.SS1.p1.17.m17.2.2.2.2.2">
            subscript
           </csymbol>
           <ci id="S4.SS1.p1.17.m17.2.2.2.2.2.2.cmml" xref="S4.SS1.p1.17.m17.2.2.2.2.2.2">
            𝑎
           </ci>
           <ci id="S4.SS1.p1.17.m17.2.2.2.2.2.3.cmml" xref="S4.SS1.p1.17.m17.2.2.2.2.2.3">
            𝑡
           </ci>
          </apply>
         </interval>
        </apply>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="S4.SS1.p1.17.m17.2c">
        r(s_{t},a_{t})
       </annotation>
      </semantics>
     </math>
     is applied to the last token (second line in the equation), as we do not receive any reward before executing the whole action. Besides, we discount the expected Q-value and KL-divergence which are conditioned on the next state
     <math alttext="s_{t+1}" class="ltx_Math" display="inline" id="S4.SS1.p1.18.m18.1">
      <semantics id="S4.SS1.p1.18.m18.1a">
       <msub id="S4.SS1.p1.18.m18.1.1" xref="S4.SS1.p1.18.m18.1.1.cmml">
        <mi id="S4.SS1.p1.18.m18.1.1.2" xref="S4.SS1.p1.18.m18.1.1.2.cmml">
         s
        </mi>
        <mrow id="S4.SS1.p1.18.m18.1.1.3" xref="S4.SS1.p1.18.m18.1.1.3.cmml">
         <mi id="S4.SS1.p1.18.m18.1.1.3.2" xref="S4.SS1.p1.18.m18.1.1.3.2.cmml">
          t
         </mi>
         <mo id="S4.SS1.p1.18.m18.1.1.3.1" xref="S4.SS1.p1.18.m18.1.1.3.1.cmml">
          +
         </mo>
         <mn id="S4.SS1.p1.18.m18.1.1.3.3" xref="S4.SS1.p1.18.m18.1.1.3.3.cmml">
          1
         </mn>
        </mrow>
       </msub>
       <annotation-xml encoding="MathML-Content" id="S4.SS1.p1.18.m18.1b">
        <apply id="S4.SS1.p1.18.m18.1.1.cmml" xref="S4.SS1.p1.18.m18.1.1">
         <csymbol cd="ambiguous" id="S4.SS1.p1.18.m18.1.1.1.cmml" xref="S4.SS1.p1.18.m18.1.1">
          subscript
         </csymbol>
         <ci id="S4.SS1.p1.18.m18.1.1.2.cmml" xref="S4.SS1.p1.18.m18.1.1.2">
          𝑠
         </ci>
         <apply id="S4.SS1.p1.18.m18.1.1.3.cmml" xref="S4.SS1.p1.18.m18.1.1.3">
          <plus id="S4.SS1.p1.18.m18.1.1.3.1.cmml" xref="S4.SS1.p1.18.m18.1.1.3.1">
          </plus>
          <ci id="S4.SS1.p1.18.m18.1.1.3.2.cmml" xref="S4.SS1.p1.18.m18.1.1.3.2">
           𝑡
          </ci>
          <cn id="S4.SS1.p1.18.m18.1.1.3.3.cmml" type="integer" xref="S4.SS1.p1.18.m18.1.1.3.3">
           1
          </cn>
         </apply>
        </apply>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="S4.SS1.p1.18.m18.1c">
        s_{t+1}
       </annotation>
      </semantics>
     </math>
     and the corresponding first token
     <math alttext="w_{t+1}^{1}" class="ltx_Math" display="inline" id="S4.SS1.p1.19.m19.1">
      <semantics id="S4.SS1.p1.19.m19.1a">
       <msubsup id="S4.SS1.p1.19.m19.1.1" xref="S4.SS1.p1.19.m19.1.1.cmml">
        <mi id="S4.SS1.p1.19.m19.1.1.2.2" xref="S4.SS1.p1.19.m19.1.1.2.2.cmml">
         w
        </mi>
        <mrow id="S4.SS1.p1.19.m19.1.1.2.3" xref="S4.SS1.p1.19.m19.1.1.2.3.cmml">
         <mi id="S4.SS1.p1.19.m19.1.1.2.3.2" xref="S4.SS1.p1.19.m19.1.1.2.3.2.cmml">
          t
         </mi>
         <mo id="S4.SS1.p1.19.m19.1.1.2.3.1" xref="S4.SS1.p1.19.m19.1.1.2.3.1.cmml">
          +
         </mo>
         <mn id="S4.SS1.p1.19.m19.1.1.2.3.3" xref="S4.SS1.p1.19.m19.1.1.2.3.3.cmml">
          1
         </mn>
        </mrow>
        <mn id="S4.SS1.p1.19.m19.1.1.3" xref="S4.SS1.p1.19.m19.1.1.3.cmml">
         1
        </mn>
       </msubsup>
       <annotation-xml encoding="MathML-Content" id="S4.SS1.p1.19.m19.1b">
        <apply id="S4.SS1.p1.19.m19.1.1.cmml" xref="S4.SS1.p1.19.m19.1.1">
         <csymbol cd="ambiguous" id="S4.SS1.p1.19.m19.1.1.1.cmml" xref="S4.SS1.p1.19.m19.1.1">
          superscript
         </csymbol>
         <apply id="S4.SS1.p1.19.m19.1.1.2.cmml" xref="S4.SS1.p1.19.m19.1.1">
          <csymbol cd="ambiguous" id="S4.SS1.p1.19.m19.1.1.2.1.cmml" xref="S4.SS1.p1.19.m19.1.1">
           subscript
          </csymbol>
          <ci id="S4.SS1.p1.19.m19.1.1.2.2.cmml" xref="S4.SS1.p1.19.m19.1.1.2.2">
           𝑤
          </ci>
          <apply id="S4.SS1.p1.19.m19.1.1.2.3.cmml" xref="S4.SS1.p1.19.m19.1.1.2.3">
           <plus id="S4.SS1.p1.19.m19.1.1.2.3.1.cmml" xref="S4.SS1.p1.19.m19.1.1.2.3.1">
           </plus>
           <ci id="S4.SS1.p1.19.m19.1.1.2.3.2.cmml" xref="S4.SS1.p1.19.m19.1.1.2.3.2">
            𝑡
           </ci>
           <cn id="S4.SS1.p1.19.m19.1.1.2.3.3.cmml" type="integer" xref="S4.SS1.p1.19.m19.1.1.2.3.3">
            1
           </cn>
          </apply>
         </apply>
         <cn id="S4.SS1.p1.19.m19.1.1.3.cmml" type="integer" xref="S4.SS1.p1.19.m19.1.1.3">
          1
         </cn>
        </apply>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="S4.SS1.p1.19.m19.1c">
        w_{t+1}^{1}
       </annotation>
      </semantics>
     </math>
     . In short, we only discount Q-values between the time steps and keep the discounted factor at 1.0 for all but the last token within actions in each time step.
    </p>
   </div>
   <div class="ltx_para" id="S4.SS1.p2">
    <p class="ltx_p" id="S4.SS1.p2.1">
     After this decomposition, The most important thing is to make sure whether it will disturb the alignment between token generation and action selection. By decomposing each action into a sequence of tokens for the soft Bellman update following the Equation
     <a class="ltx_ref" href="#S4.E6" title="Equation 6 ‣ 4 Entropy-Regularized Token-Level Policy Optimization ‣ Entropy-Regularized Token-Level Policy Optimization for Large Language Models">
      <span class="ltx_text ltx_ref_tag">
       6
      </span>
     </a>
     , we do not change the general optimization properties and the principle of the Bellman optimality still holds for a given MDP. We theoretically maintain the consistency between the objective of token-level optimization and action-level optimization, where the proof is left in Appendix
     <a class="ltx_ref" href="#A1" title="Appendix A Proof of Optimization Consistency ‣ Entropy-Regularized Token-Level Policy Optimization for Large Language Models">
      <span class="ltx_text ltx_ref_tag">
       A
      </span>
     </a>
     .
    </p>
   </div>
   <div class="ltx_para" id="S4.SS1.p3">
    <p class="ltx_p" id="S4.SS1.p3.5">
     With this per-token soft Bellman update, we can ensure the generation process for each token toward maximizing the expected cumulative return, that is, predicting the next token is directly incentivized to solve the decision-making problem in an interactive environment currently. Additionally, we can bypass the calculation for precise
     <math alttext="\mathbb{E}_{a_{t+1}\sim\pi}[Q(s_{t+1},a_{t+1})]" class="ltx_Math" display="inline" id="S4.SS1.p3.1.m1.1">
      <semantics id="S4.SS1.p3.1.m1.1a">
       <mrow id="S4.SS1.p3.1.m1.1.1" xref="S4.SS1.p3.1.m1.1.1.cmml">
        <msub id="S4.SS1.p3.1.m1.1.1.3" xref="S4.SS1.p3.1.m1.1.1.3.cmml">
         <mi id="S4.SS1.p3.1.m1.1.1.3.2" xref="S4.SS1.p3.1.m1.1.1.3.2.cmml">
          𝔼
         </mi>
         <mrow id="S4.SS1.p3.1.m1.1.1.3.3" xref="S4.SS1.p3.1.m1.1.1.3.3.cmml">
          <msub id="S4.SS1.p3.1.m1.1.1.3.3.2" xref="S4.SS1.p3.1.m1.1.1.3.3.2.cmml">
           <mi id="S4.SS1.p3.1.m1.1.1.3.3.2.2" xref="S4.SS1.p3.1.m1.1.1.3.3.2.2.cmml">
            a
           </mi>
           <mrow id="S4.SS1.p3.1.m1.1.1.3.3.2.3" xref="S4.SS1.p3.1.m1.1.1.3.3.2.3.cmml">
            <mi id="S4.SS1.p3.1.m1.1.1.3.3.2.3.2" xref="S4.SS1.p3.1.m1.1.1.3.3.2.3.2.cmml">
             t
            </mi>
            <mo id="S4.SS1.p3.1.m1.1.1.3.3.2.3.1" xref="S4.SS1.p3.1.m1.1.1.3.3.2.3.1.cmml">
             +
            </mo>
            <mn id="S4.SS1.p3.1.m1.1.1.3.3.2.3.3" xref="S4.SS1.p3.1.m1.1.1.3.3.2.3.3.cmml">
             1
            </mn>
           </mrow>
          </msub>
          <mo id="S4.SS1.p3.1.m1.1.1.3.3.1" xref="S4.SS1.p3.1.m1.1.1.3.3.1.cmml">
           ∼
          </mo>
          <mi id="S4.SS1.p3.1.m1.1.1.3.3.3" xref="S4.SS1.p3.1.m1.1.1.3.3.3.cmml">
           π
          </mi>
         </mrow>
        </msub>
        <mo id="S4.SS1.p3.1.m1.1.1.2" lspace="0em" rspace="0em" xref="S4.SS1.p3.1.m1.1.1.2.cmml">
         ​
        </mo>
        <mrow id="S4.SS1.p3.1.m1.1.1.1.1" xref="S4.SS1.p3.1.m1.1.1.1.2.cmml">
         <mo id="S4.SS1.p3.1.m1.1.1.1.1.2" stretchy="false" xref="S4.SS1.p3.1.m1.1.1.1.2.1.cmml">
          [
         </mo>
         <mrow id="S4.SS1.p3.1.m1.1.1.1.1.1" xref="S4.SS1.p3.1.m1.1.1.1.1.1.cmml">
          <mi id="S4.SS1.p3.1.m1.1.1.1.1.1.4" xref="S4.SS1.p3.1.m1.1.1.1.1.1.4.cmml">
           Q
          </mi>
          <mo id="S4.SS1.p3.1.m1.1.1.1.1.1.3" lspace="0em" rspace="0em" xref="S4.SS1.p3.1.m1.1.1.1.1.1.3.cmml">
           ​
          </mo>
          <mrow id="S4.SS1.p3.1.m1.1.1.1.1.1.2.2" xref="S4.SS1.p3.1.m1.1.1.1.1.1.2.3.cmml">
           <mo id="S4.SS1.p3.1.m1.1.1.1.1.1.2.2.3" stretchy="false" xref="S4.SS1.p3.1.m1.1.1.1.1.1.2.3.cmml">
            (
           </mo>
           <msub id="S4.SS1.p3.1.m1.1.1.1.1.1.1.1.1" xref="S4.SS1.p3.1.m1.1.1.1.1.1.1.1.1.cmml">
            <mi id="S4.SS1.p3.1.m1.1.1.1.1.1.1.1.1.2" xref="S4.SS1.p3.1.m1.1.1.1.1.1.1.1.1.2.cmml">
             s
            </mi>
            <mrow id="S4.SS1.p3.1.m1.1.1.1.1.1.1.1.1.3" xref="S4.SS1.p3.1.m1.1.1.1.1.1.1.1.1.3.cmml">
             <mi id="S4.SS1.p3.1.m1.1.1.1.1.1.1.1.1.3.2" xref="S4.SS1.p3.1.m1.1.1.1.1.1.1.1.1.3.2.cmml">
              t
             </mi>
             <mo id="S4.SS1.p3.1.m1.1.1.1.1.1.1.1.1.3.1" xref="S4.SS1.p3.1.m1.1.1.1.1.1.1.1.1.3.1.cmml">
              +
             </mo>
             <mn id="S4.SS1.p3.1.m1.1.1.1.1.1.1.1.1.3.3" xref="S4.SS1.p3.1.m1.1.1.1.1.1.1.1.1.3.3.cmml">
              1
             </mn>
            </mrow>
           </msub>
           <mo id="S4.SS1.p3.1.m1.1.1.1.1.1.2.2.4" xref="S4.SS1.p3.1.m1.1.1.1.1.1.2.3.cmml">
            ,
           </mo>
           <msub id="S4.SS1.p3.1.m1.1.1.1.1.1.2.2.2" xref="S4.SS1.p3.1.m1.1.1.1.1.1.2.2.2.cmml">
            <mi id="S4.SS1.p3.1.m1.1.1.1.1.1.2.2.2.2" xref="S4.SS1.p3.1.m1.1.1.1.1.1.2.2.2.2.cmml">
             a
            </mi>
            <mrow id="S4.SS1.p3.1.m1.1.1.1.1.1.2.2.2.3" xref="S4.SS1.p3.1.m1.1.1.1.1.1.2.2.2.3.cmml">
             <mi id="S4.SS1.p3.1.m1.1.1.1.1.1.2.2.2.3.2" xref="S4.SS1.p3.1.m1.1.1.1.1.1.2.2.2.3.2.cmml">
              t
             </mi>
             <mo id="S4.SS1.p3.1.m1.1.1.1.1.1.2.2.2.3.1" xref="S4.SS1.p3.1.m1.1.1.1.1.1.2.2.2.3.1.cmml">
              +
             </mo>
             <mn id="S4.SS1.p3.1.m1.1.1.1.1.1.2.2.2.3.3" xref="S4.SS1.p3.1.m1.1.1.1.1.1.2.2.2.3.3.cmml">
              1
             </mn>
            </mrow>
           </msub>
           <mo id="S4.SS1.p3.1.m1.1.1.1.1.1.2.2.5" stretchy="false" xref="S4.SS1.p3.1.m1.1.1.1.1.1.2.3.cmml">
            )
           </mo>
          </mrow>
         </mrow>
         <mo id="S4.SS1.p3.1.m1.1.1.1.1.3" stretchy="false" xref="S4.SS1.p3.1.m1.1.1.1.2.1.cmml">
          ]
         </mo>
        </mrow>
       </mrow>
       <annotation-xml encoding="MathML-Content" id="S4.SS1.p3.1.m1.1b">
        <apply id="S4.SS1.p3.1.m1.1.1.cmml" xref="S4.SS1.p3.1.m1.1.1">
         <times id="S4.SS1.p3.1.m1.1.1.2.cmml" xref="S4.SS1.p3.1.m1.1.1.2">
         </times>
         <apply id="S4.SS1.p3.1.m1.1.1.3.cmml" xref="S4.SS1.p3.1.m1.1.1.3">
          <csymbol cd="ambiguous" id="S4.SS1.p3.1.m1.1.1.3.1.cmml" xref="S4.SS1.p3.1.m1.1.1.3">
           subscript
          </csymbol>
          <ci id="S4.SS1.p3.1.m1.1.1.3.2.cmml" xref="S4.SS1.p3.1.m1.1.1.3.2">
           𝔼
          </ci>
          <apply id="S4.SS1.p3.1.m1.1.1.3.3.cmml" xref="S4.SS1.p3.1.m1.1.1.3.3">
           <csymbol cd="latexml" id="S4.SS1.p3.1.m1.1.1.3.3.1.cmml" xref="S4.SS1.p3.1.m1.1.1.3.3.1">
            similar-to
           </csymbol>
           <apply id="S4.SS1.p3.1.m1.1.1.3.3.2.cmml" xref="S4.SS1.p3.1.m1.1.1.3.3.2">
            <csymbol cd="ambiguous" id="S4.SS1.p3.1.m1.1.1.3.3.2.1.cmml" xref="S4.SS1.p3.1.m1.1.1.3.3.2">
             subscript
            </csymbol>
            <ci id="S4.SS1.p3.1.m1.1.1.3.3.2.2.cmml" xref="S4.SS1.p3.1.m1.1.1.3.3.2.2">
             𝑎
            </ci>
            <apply id="S4.SS1.p3.1.m1.1.1.3.3.2.3.cmml" xref="S4.SS1.p3.1.m1.1.1.3.3.2.3">
             <plus id="S4.SS1.p3.1.m1.1.1.3.3.2.3.1.cmml" xref="S4.SS1.p3.1.m1.1.1.3.3.2.3.1">
             </plus>
             <ci id="S4.SS1.p3.1.m1.1.1.3.3.2.3.2.cmml" xref="S4.SS1.p3.1.m1.1.1.3.3.2.3.2">
              𝑡
             </ci>
             <cn id="S4.SS1.p3.1.m1.1.1.3.3.2.3.3.cmml" type="integer" xref="S4.SS1.p3.1.m1.1.1.3.3.2.3.3">
              1
             </cn>
            </apply>
           </apply>
           <ci id="S4.SS1.p3.1.m1.1.1.3.3.3.cmml" xref="S4.SS1.p3.1.m1.1.1.3.3.3">
            𝜋
           </ci>
          </apply>
         </apply>
         <apply id="S4.SS1.p3.1.m1.1.1.1.2.cmml" xref="S4.SS1.p3.1.m1.1.1.1.1">
          <csymbol cd="latexml" id="S4.SS1.p3.1.m1.1.1.1.2.1.cmml" xref="S4.SS1.p3.1.m1.1.1.1.1.2">
           delimited-[]
          </csymbol>
          <apply id="S4.SS1.p3.1.m1.1.1.1.1.1.cmml" xref="S4.SS1.p3.1.m1.1.1.1.1.1">
           <times id="S4.SS1.p3.1.m1.1.1.1.1.1.3.cmml" xref="S4.SS1.p3.1.m1.1.1.1.1.1.3">
           </times>
           <ci id="S4.SS1.p3.1.m1.1.1.1.1.1.4.cmml" xref="S4.SS1.p3.1.m1.1.1.1.1.1.4">
            𝑄
           </ci>
           <interval closure="open" id="S4.SS1.p3.1.m1.1.1.1.1.1.2.3.cmml" xref="S4.SS1.p3.1.m1.1.1.1.1.1.2.2">
            <apply id="S4.SS1.p3.1.m1.1.1.1.1.1.1.1.1.cmml" xref="S4.SS1.p3.1.m1.1.1.1.1.1.1.1.1">
             <csymbol cd="ambiguous" id="S4.SS1.p3.1.m1.1.1.1.1.1.1.1.1.1.cmml" xref="S4.SS1.p3.1.m1.1.1.1.1.1.1.1.1">
              subscript
             </csymbol>
             <ci id="S4.SS1.p3.1.m1.1.1.1.1.1.1.1.1.2.cmml" xref="S4.SS1.p3.1.m1.1.1.1.1.1.1.1.1.2">
              𝑠
             </ci>
             <apply id="S4.SS1.p3.1.m1.1.1.1.1.1.1.1.1.3.cmml" xref="S4.SS1.p3.1.m1.1.1.1.1.1.1.1.1.3">
              <plus id="S4.SS1.p3.1.m1.1.1.1.1.1.1.1.1.3.1.cmml" xref="S4.SS1.p3.1.m1.1.1.1.1.1.1.1.1.3.1">
              </plus>
              <ci id="S4.SS1.p3.1.m1.1.1.1.1.1.1.1.1.3.2.cmml" xref="S4.SS1.p3.1.m1.1.1.1.1.1.1.1.1.3.2">
               𝑡
              </ci>
              <cn id="S4.SS1.p3.1.m1.1.1.1.1.1.1.1.1.3.3.cmml" type="integer" xref="S4.SS1.p3.1.m1.1.1.1.1.1.1.1.1.3.3">
               1
              </cn>
             </apply>
            </apply>
            <apply id="S4.SS1.p3.1.m1.1.1.1.1.1.2.2.2.cmml" xref="S4.SS1.p3.1.m1.1.1.1.1.1.2.2.2">
             <csymbol cd="ambiguous" id="S4.SS1.p3.1.m1.1.1.1.1.1.2.2.2.1.cmml" xref="S4.SS1.p3.1.m1.1.1.1.1.1.2.2.2">
              subscript
             </csymbol>
             <ci id="S4.SS1.p3.1.m1.1.1.1.1.1.2.2.2.2.cmml" xref="S4.SS1.p3.1.m1.1.1.1.1.1.2.2.2.2">
              𝑎
             </ci>
             <apply id="S4.SS1.p3.1.m1.1.1.1.1.1.2.2.2.3.cmml" xref="S4.SS1.p3.1.m1.1.1.1.1.1.2.2.2.3">
              <plus id="S4.SS1.p3.1.m1.1.1.1.1.1.2.2.2.3.1.cmml" xref="S4.SS1.p3.1.m1.1.1.1.1.1.2.2.2.3.1">
              </plus>
              <ci id="S4.SS1.p3.1.m1.1.1.1.1.1.2.2.2.3.2.cmml" xref="S4.SS1.p3.1.m1.1.1.1.1.1.2.2.2.3.2">
               𝑡
              </ci>
              <cn id="S4.SS1.p3.1.m1.1.1.1.1.1.2.2.2.3.3.cmml" type="integer" xref="S4.SS1.p3.1.m1.1.1.1.1.1.2.2.2.3.3">
               1
              </cn>
             </apply>
            </apply>
           </interval>
          </apply>
         </apply>
        </apply>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="S4.SS1.p3.1.m1.1c">
        \mathbb{E}_{a_{t+1}\sim\pi}[Q(s_{t+1},a_{t+1})]
       </annotation>
      </semantics>
     </math>
     that suffers from an unmanageable computational complexity of
     <math alttext="O(d^{N})" class="ltx_Math" display="inline" id="S4.SS1.p3.2.m2.1">
      <semantics id="S4.SS1.p3.2.m2.1a">
       <mrow id="S4.SS1.p3.2.m2.1.1" xref="S4.SS1.p3.2.m2.1.1.cmml">
        <mi id="S4.SS1.p3.2.m2.1.1.3" xref="S4.SS1.p3.2.m2.1.1.3.cmml">
         O
        </mi>
        <mo id="S4.SS1.p3.2.m2.1.1.2" lspace="0em" rspace="0em" xref="S4.SS1.p3.2.m2.1.1.2.cmml">
         ​
        </mo>
        <mrow id="S4.SS1.p3.2.m2.1.1.1.1" xref="S4.SS1.p3.2.m2.1.1.1.1.1.cmml">
         <mo id="S4.SS1.p3.2.m2.1.1.1.1.2" stretchy="false" xref="S4.SS1.p3.2.m2.1.1.1.1.1.cmml">
          (
         </mo>
         <msup id="S4.SS1.p3.2.m2.1.1.1.1.1" xref="S4.SS1.p3.2.m2.1.1.1.1.1.cmml">
          <mi id="S4.SS1.p3.2.m2.1.1.1.1.1.2" xref="S4.SS1.p3.2.m2.1.1.1.1.1.2.cmml">
           d
          </mi>
          <mi id="S4.SS1.p3.2.m2.1.1.1.1.1.3" xref="S4.SS1.p3.2.m2.1.1.1.1.1.3.cmml">
           N
          </mi>
         </msup>
         <mo id="S4.SS1.p3.2.m2.1.1.1.1.3" stretchy="false" xref="S4.SS1.p3.2.m2.1.1.1.1.1.cmml">
          )
         </mo>
        </mrow>
       </mrow>
       <annotation-xml encoding="MathML-Content" id="S4.SS1.p3.2.m2.1b">
        <apply id="S4.SS1.p3.2.m2.1.1.cmml" xref="S4.SS1.p3.2.m2.1.1">
         <times id="S4.SS1.p3.2.m2.1.1.2.cmml" xref="S4.SS1.p3.2.m2.1.1.2">
         </times>
         <ci id="S4.SS1.p3.2.m2.1.1.3.cmml" xref="S4.SS1.p3.2.m2.1.1.3">
          𝑂
         </ci>
         <apply id="S4.SS1.p3.2.m2.1.1.1.1.1.cmml" xref="S4.SS1.p3.2.m2.1.1.1.1">
          <csymbol cd="ambiguous" id="S4.SS1.p3.2.m2.1.1.1.1.1.1.cmml" xref="S4.SS1.p3.2.m2.1.1.1.1">
           superscript
          </csymbol>
          <ci id="S4.SS1.p3.2.m2.1.1.1.1.1.2.cmml" xref="S4.SS1.p3.2.m2.1.1.1.1.1.2">
           𝑑
          </ci>
          <ci id="S4.SS1.p3.2.m2.1.1.1.1.1.3.cmml" xref="S4.SS1.p3.2.m2.1.1.1.1.1.3">
           𝑁
          </ci>
         </apply>
        </apply>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="S4.SS1.p3.2.m2.1c">
        O(d^{N})
       </annotation>
      </semantics>
     </math>
     , instead, we just need to calculate
     <math alttext="|a_{t+1}|" class="ltx_Math" display="inline" id="S4.SS1.p3.3.m3.1">
      <semantics id="S4.SS1.p3.3.m3.1a">
       <mrow id="S4.SS1.p3.3.m3.1.1.1" xref="S4.SS1.p3.3.m3.1.1.2.cmml">
        <mo id="S4.SS1.p3.3.m3.1.1.1.2" stretchy="false" xref="S4.SS1.p3.3.m3.1.1.2.1.cmml">
         |
        </mo>
        <msub id="S4.SS1.p3.3.m3.1.1.1.1" xref="S4.SS1.p3.3.m3.1.1.1.1.cmml">
         <mi id="S4.SS1.p3.3.m3.1.1.1.1.2" xref="S4.SS1.p3.3.m3.1.1.1.1.2.cmml">
          a
         </mi>
         <mrow id="S4.SS1.p3.3.m3.1.1.1.1.3" xref="S4.SS1.p3.3.m3.1.1.1.1.3.cmml">
          <mi id="S4.SS1.p3.3.m3.1.1.1.1.3.2" xref="S4.SS1.p3.3.m3.1.1.1.1.3.2.cmml">
           t
          </mi>
          <mo id="S4.SS1.p3.3.m3.1.1.1.1.3.1" xref="S4.SS1.p3.3.m3.1.1.1.1.3.1.cmml">
           +
          </mo>
          <mn id="S4.SS1.p3.3.m3.1.1.1.1.3.3" xref="S4.SS1.p3.3.m3.1.1.1.1.3.3.cmml">
           1
          </mn>
         </mrow>
        </msub>
        <mo id="S4.SS1.p3.3.m3.1.1.1.3" stretchy="false" xref="S4.SS1.p3.3.m3.1.1.2.1.cmml">
         |
        </mo>
       </mrow>
       <annotation-xml encoding="MathML-Content" id="S4.SS1.p3.3.m3.1b">
        <apply id="S4.SS1.p3.3.m3.1.1.2.cmml" xref="S4.SS1.p3.3.m3.1.1.1">
         <abs id="S4.SS1.p3.3.m3.1.1.2.1.cmml" xref="S4.SS1.p3.3.m3.1.1.1.2">
         </abs>
         <apply id="S4.SS1.p3.3.m3.1.1.1.1.cmml" xref="S4.SS1.p3.3.m3.1.1.1.1">
          <csymbol cd="ambiguous" id="S4.SS1.p3.3.m3.1.1.1.1.1.cmml" xref="S4.SS1.p3.3.m3.1.1.1.1">
           subscript
          </csymbol>
          <ci id="S4.SS1.p3.3.m3.1.1.1.1.2.cmml" xref="S4.SS1.p3.3.m3.1.1.1.1.2">
           𝑎
          </ci>
          <apply id="S4.SS1.p3.3.m3.1.1.1.1.3.cmml" xref="S4.SS1.p3.3.m3.1.1.1.1.3">
           <plus id="S4.SS1.p3.3.m3.1.1.1.1.3.1.cmml" xref="S4.SS1.p3.3.m3.1.1.1.1.3.1">
           </plus>
           <ci id="S4.SS1.p3.3.m3.1.1.1.1.3.2.cmml" xref="S4.SS1.p3.3.m3.1.1.1.1.3.2">
            𝑡
           </ci>
           <cn id="S4.SS1.p3.3.m3.1.1.1.1.3.3.cmml" type="integer" xref="S4.SS1.p3.3.m3.1.1.1.1.3.3">
            1
           </cn>
          </apply>
         </apply>
        </apply>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="S4.SS1.p3.3.m3.1c">
        |a_{t+1}|
       </annotation>
      </semantics>
     </math>
     token-level expected values
     <math alttext="\mathbb{E}_{w_{t}^{j+1}\sim\pi(s_{t},w_{t}^{1:j})}[Q(s_{t},w_{t}^{1:j},w_{t}^{j+1})]" class="ltx_Math" display="inline" id="S4.SS1.p3.4.m4.3">
      <semantics id="S4.SS1.p3.4.m4.3a">
       <mrow id="S4.SS1.p3.4.m4.3.3" xref="S4.SS1.p3.4.m4.3.3.cmml">
        <msub id="S4.SS1.p3.4.m4.3.3.3" xref="S4.SS1.p3.4.m4.3.3.3.cmml">
         <mi id="S4.SS1.p3.4.m4.3.3.3.2" xref="S4.SS1.p3.4.m4.3.3.3.2.cmml">
          𝔼
         </mi>
         <mrow id="S4.SS1.p3.4.m4.2.2.2" xref="S4.SS1.p3.4.m4.2.2.2.cmml">
          <msubsup id="S4.SS1.p3.4.m4.2.2.2.4" xref="S4.SS1.p3.4.m4.2.2.2.4.cmml">
           <mi id="S4.SS1.p3.4.m4.2.2.2.4.2.2" xref="S4.SS1.p3.4.m4.2.2.2.4.2.2.cmml">
            w
           </mi>
           <mi id="S4.SS1.p3.4.m4.2.2.2.4.2.3" xref="S4.SS1.p3.4.m4.2.2.2.4.2.3.cmml">
            t
           </mi>
           <mrow id="S4.SS1.p3.4.m4.2.2.2.4.3" xref="S4.SS1.p3.4.m4.2.2.2.4.3.cmml">
            <mi id="S4.SS1.p3.4.m4.2.2.2.4.3.2" xref="S4.SS1.p3.4.m4.2.2.2.4.3.2.cmml">
             j
            </mi>
            <mo id="S4.SS1.p3.4.m4.2.2.2.4.3.1" xref="S4.SS1.p3.4.m4.2.2.2.4.3.1.cmml">
             +
            </mo>
            <mn id="S4.SS1.p3.4.m4.2.2.2.4.3.3" xref="S4.SS1.p3.4.m4.2.2.2.4.3.3.cmml">
             1
            </mn>
           </mrow>
          </msubsup>
          <mo id="S4.SS1.p3.4.m4.2.2.2.3" xref="S4.SS1.p3.4.m4.2.2.2.3.cmml">
           ∼
          </mo>
          <mrow id="S4.SS1.p3.4.m4.2.2.2.2" xref="S4.SS1.p3.4.m4.2.2.2.2.cmml">
           <mi id="S4.SS1.p3.4.m4.2.2.2.2.4" xref="S4.SS1.p3.4.m4.2.2.2.2.4.cmml">
            π
           </mi>
           <mo id="S4.SS1.p3.4.m4.2.2.2.2.3" lspace="0em" rspace="0em" xref="S4.SS1.p3.4.m4.2.2.2.2.3.cmml">
            ​
           </mo>
           <mrow id="S4.SS1.p3.4.m4.2.2.2.2.2.2" xref="S4.SS1.p3.4.m4.2.2.2.2.2.3.cmml">
            <mo id="S4.SS1.p3.4.m4.2.2.2.2.2.2.3" stretchy="false" xref="S4.SS1.p3.4.m4.2.2.2.2.2.3.cmml">
             (
            </mo>
            <msub id="S4.SS1.p3.4.m4.1.1.1.1.1.1.1" xref="S4.SS1.p3.4.m4.1.1.1.1.1.1.1.cmml">
             <mi id="S4.SS1.p3.4.m4.1.1.1.1.1.1.1.2" xref="S4.SS1.p3.4.m4.1.1.1.1.1.1.1.2.cmml">
              s
             </mi>
             <mi id="S4.SS1.p3.4.m4.1.1.1.1.1.1.1.3" xref="S4.SS1.p3.4.m4.1.1.1.1.1.1.1.3.cmml">
              t
             </mi>
            </msub>
            <mo id="S4.SS1.p3.4.m4.2.2.2.2.2.2.4" xref="S4.SS1.p3.4.m4.2.2.2.2.2.3.cmml">
             ,
            </mo>
            <msubsup id="S4.SS1.p3.4.m4.2.2.2.2.2.2.2" xref="S4.SS1.p3.4.m4.2.2.2.2.2.2.2.cmml">
             <mi id="S4.SS1.p3.4.m4.2.2.2.2.2.2.2.2.2" xref="S4.SS1.p3.4.m4.2.2.2.2.2.2.2.2.2.cmml">
              w
             </mi>
             <mi id="S4.SS1.p3.4.m4.2.2.2.2.2.2.2.2.3" xref="S4.SS1.p3.4.m4.2.2.2.2.2.2.2.2.3.cmml">
              t
             </mi>
             <mrow id="S4.SS1.p3.4.m4.2.2.2.2.2.2.2.3" xref="S4.SS1.p3.4.m4.2.2.2.2.2.2.2.3.cmml">
              <mn id="S4.SS1.p3.4.m4.2.2.2.2.2.2.2.3.2" xref="S4.SS1.p3.4.m4.2.2.2.2.2.2.2.3.2.cmml">
               1
              </mn>
              <mo id="S4.SS1.p3.4.m4.2.2.2.2.2.2.2.3.1" lspace="0.278em" rspace="0.278em" xref="S4.SS1.p3.4.m4.2.2.2.2.2.2.2.3.1.cmml">
               :
              </mo>
              <mi id="S4.SS1.p3.4.m4.2.2.2.2.2.2.2.3.3" xref="S4.SS1.p3.4.m4.2.2.2.2.2.2.2.3.3.cmml">
               j
              </mi>
             </mrow>
            </msubsup>
            <mo id="S4.SS1.p3.4.m4.2.2.2.2.2.2.5" stretchy="false" xref="S4.SS1.p3.4.m4.2.2.2.2.2.3.cmml">
             )
            </mo>
           </mrow>
          </mrow>
         </mrow>
        </msub>
        <mo id="S4.SS1.p3.4.m4.3.3.2" lspace="0em" rspace="0em" xref="S4.SS1.p3.4.m4.3.3.2.cmml">
         ​
        </mo>
        <mrow id="S4.SS1.p3.4.m4.3.3.1.1" xref="S4.SS1.p3.4.m4.3.3.1.2.cmml">
         <mo id="S4.SS1.p3.4.m4.3.3.1.1.2" stretchy="false" xref="S4.SS1.p3.4.m4.3.3.1.2.1.cmml">
          [
         </mo>
         <mrow id="S4.SS1.p3.4.m4.3.3.1.1.1" xref="S4.SS1.p3.4.m4.3.3.1.1.1.cmml">
          <mi id="S4.SS1.p3.4.m4.3.3.1.1.1.5" xref="S4.SS1.p3.4.m4.3.3.1.1.1.5.cmml">
           Q
          </mi>
          <mo id="S4.SS1.p3.4.m4.3.3.1.1.1.4" lspace="0em" rspace="0em" xref="S4.SS1.p3.4.m4.3.3.1.1.1.4.cmml">
           ​
          </mo>
          <mrow id="S4.SS1.p3.4.m4.3.3.1.1.1.3.3" xref="S4.SS1.p3.4.m4.3.3.1.1.1.3.4.cmml">
           <mo id="S4.SS1.p3.4.m4.3.3.1.1.1.3.3.4" stretchy="false" xref="S4.SS1.p3.4.m4.3.3.1.1.1.3.4.cmml">
            (
           </mo>
           <msub id="S4.SS1.p3.4.m4.3.3.1.1.1.1.1.1" xref="S4.SS1.p3.4.m4.3.3.1.1.1.1.1.1.cmml">
            <mi id="S4.SS1.p3.4.m4.3.3.1.1.1.1.1.1.2" xref="S4.SS1.p3.4.m4.3.3.1.1.1.1.1.1.2.cmml">
             s
            </mi>
            <mi id="S4.SS1.p3.4.m4.3.3.1.1.1.1.1.1.3" xref="S4.SS1.p3.4.m4.3.3.1.1.1.1.1.1.3.cmml">
             t
            </mi>
           </msub>
           <mo id="S4.SS1.p3.4.m4.3.3.1.1.1.3.3.5" xref="S4.SS1.p3.4.m4.3.3.1.1.1.3.4.cmml">
            ,
           </mo>
           <msubsup id="S4.SS1.p3.4.m4.3.3.1.1.1.2.2.2" xref="S4.SS1.p3.4.m4.3.3.1.1.1.2.2.2.cmml">
            <mi id="S4.SS1.p3.4.m4.3.3.1.1.1.2.2.2.2.2" xref="S4.SS1.p3.4.m4.3.3.1.1.1.2.2.2.2.2.cmml">
             w
            </mi>
            <mi id="S4.SS1.p3.4.m4.3.3.1.1.1.2.2.2.2.3" xref="S4.SS1.p3.4.m4.3.3.1.1.1.2.2.2.2.3.cmml">
             t
            </mi>
            <mrow id="S4.SS1.p3.4.m4.3.3.1.1.1.2.2.2.3" xref="S4.SS1.p3.4.m4.3.3.1.1.1.2.2.2.3.cmml">
             <mn id="S4.SS1.p3.4.m4.3.3.1.1.1.2.2.2.3.2" xref="S4.SS1.p3.4.m4.3.3.1.1.1.2.2.2.3.2.cmml">
              1
             </mn>
             <mo id="S4.SS1.p3.4.m4.3.3.1.1.1.2.2.2.3.1" lspace="0.278em" rspace="0.278em" xref="S4.SS1.p3.4.m4.3.3.1.1.1.2.2.2.3.1.cmml">
              :
             </mo>
             <mi id="S4.SS1.p3.4.m4.3.3.1.1.1.2.2.2.3.3" xref="S4.SS1.p3.4.m4.3.3.1.1.1.2.2.2.3.3.cmml">
              j
             </mi>
            </mrow>
           </msubsup>
           <mo id="S4.SS1.p3.4.m4.3.3.1.1.1.3.3.6" xref="S4.SS1.p3.4.m4.3.3.1.1.1.3.4.cmml">
            ,
           </mo>
           <msubsup id="S4.SS1.p3.4.m4.3.3.1.1.1.3.3.3" xref="S4.SS1.p3.4.m4.3.3.1.1.1.3.3.3.cmml">
            <mi id="S4.SS1.p3.4.m4.3.3.1.1.1.3.3.3.2.2" xref="S4.SS1.p3.4.m4.3.3.1.1.1.3.3.3.2.2.cmml">
             w
            </mi>
            <mi id="S4.SS1.p3.4.m4.3.3.1.1.1.3.3.3.2.3" xref="S4.SS1.p3.4.m4.3.3.1.1.1.3.3.3.2.3.cmml">
             t
            </mi>
            <mrow id="S4.SS1.p3.4.m4.3.3.1.1.1.3.3.3.3" xref="S4.SS1.p3.4.m4.3.3.1.1.1.3.3.3.3.cmml">
             <mi id="S4.SS1.p3.4.m4.3.3.1.1.1.3.3.3.3.2" xref="S4.SS1.p3.4.m4.3.3.1.1.1.3.3.3.3.2.cmml">
              j
             </mi>
             <mo id="S4.SS1.p3.4.m4.3.3.1.1.1.3.3.3.3.1" xref="S4.SS1.p3.4.m4.3.3.1.1.1.3.3.3.3.1.cmml">
              +
             </mo>
             <mn id="S4.SS1.p3.4.m4.3.3.1.1.1.3.3.3.3.3" xref="S4.SS1.p3.4.m4.3.3.1.1.1.3.3.3.3.3.cmml">
              1
             </mn>
            </mrow>
           </msubsup>
           <mo id="S4.SS1.p3.4.m4.3.3.1.1.1.3.3.7" stretchy="false" xref="S4.SS1.p3.4.m4.3.3.1.1.1.3.4.cmml">
            )
           </mo>
          </mrow>
         </mrow>
         <mo id="S4.SS1.p3.4.m4.3.3.1.1.3" stretchy="false" xref="S4.SS1.p3.4.m4.3.3.1.2.1.cmml">
          ]
         </mo>
        </mrow>
       </mrow>
       <annotation-xml encoding="MathML-Content" id="S4.SS1.p3.4.m4.3b">
        <apply id="S4.SS1.p3.4.m4.3.3.cmml" xref="S4.SS1.p3.4.m4.3.3">
         <times id="S4.SS1.p3.4.m4.3.3.2.cmml" xref="S4.SS1.p3.4.m4.3.3.2">
         </times>
         <apply id="S4.SS1.p3.4.m4.3.3.3.cmml" xref="S4.SS1.p3.4.m4.3.3.3">
          <csymbol cd="ambiguous" id="S4.SS1.p3.4.m4.3.3.3.1.cmml" xref="S4.SS1.p3.4.m4.3.3.3">
           subscript
          </csymbol>
          <ci id="S4.SS1.p3.4.m4.3.3.3.2.cmml" xref="S4.SS1.p3.4.m4.3.3.3.2">
           𝔼
          </ci>
          <apply id="S4.SS1.p3.4.m4.2.2.2.cmml" xref="S4.SS1.p3.4.m4.2.2.2">
           <csymbol cd="latexml" id="S4.SS1.p3.4.m4.2.2.2.3.cmml" xref="S4.SS1.p3.4.m4.2.2.2.3">
            similar-to
           </csymbol>
           <apply id="S4.SS1.p3.4.m4.2.2.2.4.cmml" xref="S4.SS1.p3.4.m4.2.2.2.4">
            <csymbol cd="ambiguous" id="S4.SS1.p3.4.m4.2.2.2.4.1.cmml" xref="S4.SS1.p3.4.m4.2.2.2.4">
             superscript
            </csymbol>
            <apply id="S4.SS1.p3.4.m4.2.2.2.4.2.cmml" xref="S4.SS1.p3.4.m4.2.2.2.4">
             <csymbol cd="ambiguous" id="S4.SS1.p3.4.m4.2.2.2.4.2.1.cmml" xref="S4.SS1.p3.4.m4.2.2.2.4">
              subscript
             </csymbol>
             <ci id="S4.SS1.p3.4.m4.2.2.2.4.2.2.cmml" xref="S4.SS1.p3.4.m4.2.2.2.4.2.2">
              𝑤
             </ci>
             <ci id="S4.SS1.p3.4.m4.2.2.2.4.2.3.cmml" xref="S4.SS1.p3.4.m4.2.2.2.4.2.3">
              𝑡
             </ci>
            </apply>
            <apply id="S4.SS1.p3.4.m4.2.2.2.4.3.cmml" xref="S4.SS1.p3.4.m4.2.2.2.4.3">
             <plus id="S4.SS1.p3.4.m4.2.2.2.4.3.1.cmml" xref="S4.SS1.p3.4.m4.2.2.2.4.3.1">
             </plus>
             <ci id="S4.SS1.p3.4.m4.2.2.2.4.3.2.cmml" xref="S4.SS1.p3.4.m4.2.2.2.4.3.2">
              𝑗
             </ci>
             <cn id="S4.SS1.p3.4.m4.2.2.2.4.3.3.cmml" type="integer" xref="S4.SS1.p3.4.m4.2.2.2.4.3.3">
              1
             </cn>
            </apply>
           </apply>
           <apply id="S4.SS1.p3.4.m4.2.2.2.2.cmml" xref="S4.SS1.p3.4.m4.2.2.2.2">
            <times id="S4.SS1.p3.4.m4.2.2.2.2.3.cmml" xref="S4.SS1.p3.4.m4.2.2.2.2.3">
            </times>
            <ci id="S4.SS1.p3.4.m4.2.2.2.2.4.cmml" xref="S4.SS1.p3.4.m4.2.2.2.2.4">
             𝜋
            </ci>
            <interval closure="open" id="S4.SS1.p3.4.m4.2.2.2.2.2.3.cmml" xref="S4.SS1.p3.4.m4.2.2.2.2.2.2">
             <apply id="S4.SS1.p3.4.m4.1.1.1.1.1.1.1.cmml" xref="S4.SS1.p3.4.m4.1.1.1.1.1.1.1">
              <csymbol cd="ambiguous" id="S4.SS1.p3.4.m4.1.1.1.1.1.1.1.1.cmml" xref="S4.SS1.p3.4.m4.1.1.1.1.1.1.1">
               subscript
              </csymbol>
              <ci id="S4.SS1.p3.4.m4.1.1.1.1.1.1.1.2.cmml" xref="S4.SS1.p3.4.m4.1.1.1.1.1.1.1.2">
               𝑠
              </ci>
              <ci id="S4.SS1.p3.4.m4.1.1.1.1.1.1.1.3.cmml" xref="S4.SS1.p3.4.m4.1.1.1.1.1.1.1.3">
               𝑡
              </ci>
             </apply>
             <apply id="S4.SS1.p3.4.m4.2.2.2.2.2.2.2.cmml" xref="S4.SS1.p3.4.m4.2.2.2.2.2.2.2">
              <csymbol cd="ambiguous" id="S4.SS1.p3.4.m4.2.2.2.2.2.2.2.1.cmml" xref="S4.SS1.p3.4.m4.2.2.2.2.2.2.2">
               superscript
              </csymbol>
              <apply id="S4.SS1.p3.4.m4.2.2.2.2.2.2.2.2.cmml" xref="S4.SS1.p3.4.m4.2.2.2.2.2.2.2">
               <csymbol cd="ambiguous" id="S4.SS1.p3.4.m4.2.2.2.2.2.2.2.2.1.cmml" xref="S4.SS1.p3.4.m4.2.2.2.2.2.2.2">
                subscript
               </csymbol>
               <ci id="S4.SS1.p3.4.m4.2.2.2.2.2.2.2.2.2.cmml" xref="S4.SS1.p3.4.m4.2.2.2.2.2.2.2.2.2">
                𝑤
               </ci>
               <ci id="S4.SS1.p3.4.m4.2.2.2.2.2.2.2.2.3.cmml" xref="S4.SS1.p3.4.m4.2.2.2.2.2.2.2.2.3">
                𝑡
               </ci>
              </apply>
              <apply id="S4.SS1.p3.4.m4.2.2.2.2.2.2.2.3.cmml" xref="S4.SS1.p3.4.m4.2.2.2.2.2.2.2.3">
               <ci id="S4.SS1.p3.4.m4.2.2.2.2.2.2.2.3.1.cmml" xref="S4.SS1.p3.4.m4.2.2.2.2.2.2.2.3.1">
                :
               </ci>
               <cn id="S4.SS1.p3.4.m4.2.2.2.2.2.2.2.3.2.cmml" type="integer" xref="S4.SS1.p3.4.m4.2.2.2.2.2.2.2.3.2">
                1
               </cn>
               <ci id="S4.SS1.p3.4.m4.2.2.2.2.2.2.2.3.3.cmml" xref="S4.SS1.p3.4.m4.2.2.2.2.2.2.2.3.3">
                𝑗
               </ci>
              </apply>
             </apply>
            </interval>
           </apply>
          </apply>
         </apply>
         <apply id="S4.SS1.p3.4.m4.3.3.1.2.cmml" xref="S4.SS1.p3.4.m4.3.3.1.1">
          <csymbol cd="latexml" id="S4.SS1.p3.4.m4.3.3.1.2.1.cmml" xref="S4.SS1.p3.4.m4.3.3.1.1.2">
           delimited-[]
          </csymbol>
          <apply id="S4.SS1.p3.4.m4.3.3.1.1.1.cmml" xref="S4.SS1.p3.4.m4.3.3.1.1.1">
           <times id="S4.SS1.p3.4.m4.3.3.1.1.1.4.cmml" xref="S4.SS1.p3.4.m4.3.3.1.1.1.4">
           </times>
           <ci id="S4.SS1.p3.4.m4.3.3.1.1.1.5.cmml" xref="S4.SS1.p3.4.m4.3.3.1.1.1.5">
            𝑄
           </ci>
           <vector id="S4.SS1.p3.4.m4.3.3.1.1.1.3.4.cmml" xref="S4.SS1.p3.4.m4.3.3.1.1.1.3.3">
            <apply id="S4.SS1.p3.4.m4.3.3.1.1.1.1.1.1.cmml" xref="S4.SS1.p3.4.m4.3.3.1.1.1.1.1.1">
             <csymbol cd="ambiguous" id="S4.SS1.p3.4.m4.3.3.1.1.1.1.1.1.1.cmml" xref="S4.SS1.p3.4.m4.3.3.1.1.1.1.1.1">
              subscript
             </csymbol>
             <ci id="S4.SS1.p3.4.m4.3.3.1.1.1.1.1.1.2.cmml" xref="S4.SS1.p3.4.m4.3.3.1.1.1.1.1.1.2">
              𝑠
             </ci>
             <ci id="S4.SS1.p3.4.m4.3.3.1.1.1.1.1.1.3.cmml" xref="S4.SS1.p3.4.m4.3.3.1.1.1.1.1.1.3">
              𝑡
             </ci>
            </apply>
            <apply id="S4.SS1.p3.4.m4.3.3.1.1.1.2.2.2.cmml" xref="S4.SS1.p3.4.m4.3.3.1.1.1.2.2.2">
             <csymbol cd="ambiguous" id="S4.SS1.p3.4.m4.3.3.1.1.1.2.2.2.1.cmml" xref="S4.SS1.p3.4.m4.3.3.1.1.1.2.2.2">
              superscript
             </csymbol>
             <apply id="S4.SS1.p3.4.m4.3.3.1.1.1.2.2.2.2.cmml" xref="S4.SS1.p3.4.m4.3.3.1.1.1.2.2.2">
              <csymbol cd="ambiguous" id="S4.SS1.p3.4.m4.3.3.1.1.1.2.2.2.2.1.cmml" xref="S4.SS1.p3.4.m4.3.3.1.1.1.2.2.2">
               subscript
              </csymbol>
              <ci id="S4.SS1.p3.4.m4.3.3.1.1.1.2.2.2.2.2.cmml" xref="S4.SS1.p3.4.m4.3.3.1.1.1.2.2.2.2.2">
               𝑤
              </ci>
              <ci id="S4.SS1.p3.4.m4.3.3.1.1.1.2.2.2.2.3.cmml" xref="S4.SS1.p3.4.m4.3.3.1.1.1.2.2.2.2.3">
               𝑡
              </ci>
             </apply>
             <apply id="S4.SS1.p3.4.m4.3.3.1.1.1.2.2.2.3.cmml" xref="S4.SS1.p3.4.m4.3.3.1.1.1.2.2.2.3">
              <ci id="S4.SS1.p3.4.m4.3.3.1.1.1.2.2.2.3.1.cmml" xref="S4.SS1.p3.4.m4.3.3.1.1.1.2.2.2.3.1">
               :
              </ci>
              <cn id="S4.SS1.p3.4.m4.3.3.1.1.1.2.2.2.3.2.cmml" type="integer" xref="S4.SS1.p3.4.m4.3.3.1.1.1.2.2.2.3.2">
               1
              </cn>
              <ci id="S4.SS1.p3.4.m4.3.3.1.1.1.2.2.2.3.3.cmml" xref="S4.SS1.p3.4.m4.3.3.1.1.1.2.2.2.3.3">
               𝑗
              </ci>
             </apply>
            </apply>
            <apply id="S4.SS1.p3.4.m4.3.3.1.1.1.3.3.3.cmml" xref="S4.SS1.p3.4.m4.3.3.1.1.1.3.3.3">
             <csymbol cd="ambiguous" id="S4.SS1.p3.4.m4.3.3.1.1.1.3.3.3.1.cmml" xref="S4.SS1.p3.4.m4.3.3.1.1.1.3.3.3">
              superscript
             </csymbol>
             <apply id="S4.SS1.p3.4.m4.3.3.1.1.1.3.3.3.2.cmml" xref="S4.SS1.p3.4.m4.3.3.1.1.1.3.3.3">
              <csymbol cd="ambiguous" id="S4.SS1.p3.4.m4.3.3.1.1.1.3.3.3.2.1.cmml" xref="S4.SS1.p3.4.m4.3.3.1.1.1.3.3.3">
               subscript
              </csymbol>
              <ci id="S4.SS1.p3.4.m4.3.3.1.1.1.3.3.3.2.2.cmml" xref="S4.SS1.p3.4.m4.3.3.1.1.1.3.3.3.2.2">
               𝑤
              </ci>
              <ci id="S4.SS1.p3.4.m4.3.3.1.1.1.3.3.3.2.3.cmml" xref="S4.SS1.p3.4.m4.3.3.1.1.1.3.3.3.2.3">
               𝑡
              </ci>
             </apply>
             <apply id="S4.SS1.p3.4.m4.3.3.1.1.1.3.3.3.3.cmml" xref="S4.SS1.p3.4.m4.3.3.1.1.1.3.3.3.3">
              <plus id="S4.SS1.p3.4.m4.3.3.1.1.1.3.3.3.3.1.cmml" xref="S4.SS1.p3.4.m4.3.3.1.1.1.3.3.3.3.1">
              </plus>
              <ci id="S4.SS1.p3.4.m4.3.3.1.1.1.3.3.3.3.2.cmml" xref="S4.SS1.p3.4.m4.3.3.1.1.1.3.3.3.3.2">
               𝑗
              </ci>
              <cn id="S4.SS1.p3.4.m4.3.3.1.1.1.3.3.3.3.3.cmml" type="integer" xref="S4.SS1.p3.4.m4.3.3.1.1.1.3.3.3.3.3">
               1
              </cn>
             </apply>
            </apply>
           </vector>
          </apply>
         </apply>
        </apply>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="S4.SS1.p3.4.m4.3c">
        \mathbb{E}_{w_{t}^{j+1}\sim\pi(s_{t},w_{t}^{1:j})}[Q(s_{t},w_{t}^{1:j},w_{t}^{j+1})]
       </annotation>
      </semantics>
     </math>
     , which enjoys a tractable complexity of
     <math alttext="O(d\times|a_{t+1}|)" class="ltx_Math" display="inline" id="S4.SS1.p3.5.m5.1">
      <semantics id="S4.SS1.p3.5.m5.1a">
       <mrow id="S4.SS1.p3.5.m5.1.1" xref="S4.SS1.p3.5.m5.1.1.cmml">
        <mi id="S4.SS1.p3.5.m5.1.1.3" xref="S4.SS1.p3.5.m5.1.1.3.cmml">
         O
        </mi>
        <mo id="S4.SS1.p3.5.m5.1.1.2" lspace="0em" rspace="0em" xref="S4.SS1.p3.5.m5.1.1.2.cmml">
         ​
        </mo>
        <mrow id="S4.SS1.p3.5.m5.1.1.1.1" xref="S4.SS1.p3.5.m5.1.1.1.1.1.cmml">
         <mo id="S4.SS1.p3.5.m5.1.1.1.1.2" stretchy="false" xref="S4.SS1.p3.5.m5.1.1.1.1.1.cmml">
          (
         </mo>
         <mrow id="S4.SS1.p3.5.m5.1.1.1.1.1" xref="S4.SS1.p3.5.m5.1.1.1.1.1.cmml">
          <mi id="S4.SS1.p3.5.m5.1.1.1.1.1.3" xref="S4.SS1.p3.5.m5.1.1.1.1.1.3.cmml">
           d
          </mi>
          <mo id="S4.SS1.p3.5.m5.1.1.1.1.1.2" lspace="0.222em" rspace="0.222em" xref="S4.SS1.p3.5.m5.1.1.1.1.1.2.cmml">
           ×
          </mo>
          <mrow id="S4.SS1.p3.5.m5.1.1.1.1.1.1.1" xref="S4.SS1.p3.5.m5.1.1.1.1.1.1.2.cmml">
           <mo id="S4.SS1.p3.5.m5.1.1.1.1.1.1.1.2" stretchy="false" xref="S4.SS1.p3.5.m5.1.1.1.1.1.1.2.1.cmml">
            |
           </mo>
           <msub id="S4.SS1.p3.5.m5.1.1.1.1.1.1.1.1" xref="S4.SS1.p3.5.m5.1.1.1.1.1.1.1.1.cmml">
            <mi id="S4.SS1.p3.5.m5.1.1.1.1.1.1.1.1.2" xref="S4.SS1.p3.5.m5.1.1.1.1.1.1.1.1.2.cmml">
             a
            </mi>
            <mrow id="S4.SS1.p3.5.m5.1.1.1.1.1.1.1.1.3" xref="S4.SS1.p3.5.m5.1.1.1.1.1.1.1.1.3.cmml">
             <mi id="S4.SS1.p3.5.m5.1.1.1.1.1.1.1.1.3.2" xref="S4.SS1.p3.5.m5.1.1.1.1.1.1.1.1.3.2.cmml">
              t
             </mi>
             <mo id="S4.SS1.p3.5.m5.1.1.1.1.1.1.1.1.3.1" xref="S4.SS1.p3.5.m5.1.1.1.1.1.1.1.1.3.1.cmml">
              +
             </mo>
             <mn id="S4.SS1.p3.5.m5.1.1.1.1.1.1.1.1.3.3" xref="S4.SS1.p3.5.m5.1.1.1.1.1.1.1.1.3.3.cmml">
              1
             </mn>
            </mrow>
           </msub>
           <mo id="S4.SS1.p3.5.m5.1.1.1.1.1.1.1.3" stretchy="false" xref="S4.SS1.p3.5.m5.1.1.1.1.1.1.2.1.cmml">
            |
           </mo>
          </mrow>
         </mrow>
         <mo id="S4.SS1.p3.5.m5.1.1.1.1.3" stretchy="false" xref="S4.SS1.p3.5.m5.1.1.1.1.1.cmml">
          )
         </mo>
        </mrow>
       </mrow>
       <annotation-xml encoding="MathML-Content" id="S4.SS1.p3.5.m5.1b">
        <apply id="S4.SS1.p3.5.m5.1.1.cmml" xref="S4.SS1.p3.5.m5.1.1">
         <times id="S4.SS1.p3.5.m5.1.1.2.cmml" xref="S4.SS1.p3.5.m5.1.1.2">
         </times>
         <ci id="S4.SS1.p3.5.m5.1.1.3.cmml" xref="S4.SS1.p3.5.m5.1.1.3">
          𝑂
         </ci>
         <apply id="S4.SS1.p3.5.m5.1.1.1.1.1.cmml" xref="S4.SS1.p3.5.m5.1.1.1.1">
          <times id="S4.SS1.p3.5.m5.1.1.1.1.1.2.cmml" xref="S4.SS1.p3.5.m5.1.1.1.1.1.2">
          </times>
          <ci id="S4.SS1.p3.5.m5.1.1.1.1.1.3.cmml" xref="S4.SS1.p3.5.m5.1.1.1.1.1.3">
           𝑑
          </ci>
          <apply id="S4.SS1.p3.5.m5.1.1.1.1.1.1.2.cmml" xref="S4.SS1.p3.5.m5.1.1.1.1.1.1.1">
           <abs id="S4.SS1.p3.5.m5.1.1.1.1.1.1.2.1.cmml" xref="S4.SS1.p3.5.m5.1.1.1.1.1.1.1.2">
           </abs>
           <apply id="S4.SS1.p3.5.m5.1.1.1.1.1.1.1.1.cmml" xref="S4.SS1.p3.5.m5.1.1.1.1.1.1.1.1">
            <csymbol cd="ambiguous" id="S4.SS1.p3.5.m5.1.1.1.1.1.1.1.1.1.cmml" xref="S4.SS1.p3.5.m5.1.1.1.1.1.1.1.1">
             subscript
            </csymbol>
            <ci id="S4.SS1.p3.5.m5.1.1.1.1.1.1.1.1.2.cmml" xref="S4.SS1.p3.5.m5.1.1.1.1.1.1.1.1.2">
             𝑎
            </ci>
            <apply id="S4.SS1.p3.5.m5.1.1.1.1.1.1.1.1.3.cmml" xref="S4.SS1.p3.5.m5.1.1.1.1.1.1.1.1.3">
             <plus id="S4.SS1.p3.5.m5.1.1.1.1.1.1.1.1.3.1.cmml" xref="S4.SS1.p3.5.m5.1.1.1.1.1.1.1.1.3.1">
             </plus>
             <ci id="S4.SS1.p3.5.m5.1.1.1.1.1.1.1.1.3.2.cmml" xref="S4.SS1.p3.5.m5.1.1.1.1.1.1.1.1.3.2">
              𝑡
             </ci>
             <cn id="S4.SS1.p3.5.m5.1.1.1.1.1.1.1.1.3.3.cmml" type="integer" xref="S4.SS1.p3.5.m5.1.1.1.1.1.1.1.1.3.3">
              1
             </cn>
            </apply>
           </apply>
          </apply>
         </apply>
        </apply>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="S4.SS1.p3.5.m5.1c">
        O(d\times|a_{t+1}|)
       </annotation>
      </semantics>
     </math>
     .
    </p>
   </div>
  </section>
  <section class="ltx_subsection" id="S4.SS2">
   <h3 class="ltx_title ltx_title_subsection">
    <span class="ltx_tag ltx_tag_subsection">
     4.2
    </span>
    Per-Token Policy Update
   </h3>
   <div class="ltx_para" id="S4.SS2.p1">
    <p class="ltx_p" id="S4.SS2.p1.1">
     After defining the soft Bellman backup, we develop an approach for the policy update, i.e. the per-token policy update. According to the definition of ERL
     <cite class="ltx_cite ltx_citemacro_citep">
      (Schulman et al.,
      <a class="ltx_ref" href="#bib.bib35" title="">
       2017a
      </a>
      )
     </cite>
     , an optimal stochastic policy that refers to
     <math alttext="\bar{\pi}" class="ltx_Math" display="inline" id="S4.SS2.p1.1.m1.1">
      <semantics id="S4.SS2.p1.1.m1.1a">
       <mover accent="true" id="S4.SS2.p1.1.m1.1.1" xref="S4.SS2.p1.1.m1.1.1.cmml">
        <mi id="S4.SS2.p1.1.m1.1.1.2" xref="S4.SS2.p1.1.m1.1.1.2.cmml">
         π
        </mi>
        <mo id="S4.SS2.p1.1.m1.1.1.1" xref="S4.SS2.p1.1.m1.1.1.1.cmml">
         ¯
        </mo>
       </mover>
       <annotation-xml encoding="MathML-Content" id="S4.SS2.p1.1.m1.1b">
        <apply id="S4.SS2.p1.1.m1.1.1.cmml" xref="S4.SS2.p1.1.m1.1.1">
         <ci id="S4.SS2.p1.1.m1.1.1.1.cmml" xref="S4.SS2.p1.1.m1.1.1.1">
          ¯
         </ci>
         <ci id="S4.SS2.p1.1.m1.1.1.2.cmml" xref="S4.SS2.p1.1.m1.1.1.2">
          𝜋
         </ci>
        </apply>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="S4.SS2.p1.1.m1.1c">
        \bar{\pi}
       </annotation>
      </semantics>
     </math>
     and the Q-function could be presented as:
     <span class="ltx_text" id="S4.SS2.p1.1.1" style="font-size:90%;">
     </span>
    </p>
    <table class="ltx_equationgroup ltx_eqn_align ltx_eqn_table" id="A7.EGx8">
     <tbody id="S4.Ex2">
      <tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
       <td class="ltx_eqn_cell ltx_eqn_center_padleft">
       </td>
       <td class="ltx_td ltx_align_right ltx_eqn_cell">
        <math alttext="\displaystyle\pi^{*}(\cdot|s_{t})" class="ltx_math_unparsed" display="inline" id="S4.Ex2.m1.1">
         <semantics id="S4.Ex2.m1.1a">
          <mrow id="S4.Ex2.m1.1b">
           <msup id="S4.Ex2.m1.1.1">
            <mi id="S4.Ex2.m1.1.1.2" mathsize="90%">
             π
            </mi>
            <mo id="S4.Ex2.m1.1.1.3" mathsize="90%">
             ∗
            </mo>
           </msup>
           <mrow id="S4.Ex2.m1.1.2">
            <mo id="S4.Ex2.m1.1.2.1" maxsize="90%" minsize="90%">
             (
            </mo>
            <mo id="S4.Ex2.m1.1.2.2" lspace="0em" mathsize="90%" rspace="0em">
             ⋅
            </mo>
            <mo fence="false" id="S4.Ex2.m1.1.2.3" maxsize="90%" minsize="90%" rspace="0.167em">
             |
            </mo>
            <msub id="S4.Ex2.m1.1.2.4">
             <mi id="S4.Ex2.m1.1.2.4.2" mathsize="90%">
              s
             </mi>
             <mi id="S4.Ex2.m1.1.2.4.3" mathsize="90%">
              t
             </mi>
            </msub>
            <mo id="S4.Ex2.m1.1.2.5" maxsize="90%" minsize="90%">
             )
            </mo>
           </mrow>
          </mrow>
          <annotation encoding="application/x-tex" id="S4.Ex2.m1.1c">
           \displaystyle\pi^{*}(\cdot|s_{t})
          </annotation>
         </semantics>
        </math>
       </td>
       <td class="ltx_td ltx_align_left ltx_eqn_cell">
        <math alttext="\displaystyle=\arg\max_{\pi}\Big{\{}\mathbb{E}_{a_{t}\sim\pi}[Q(s_{t},a_{t})]-\beta D_{KL}[\pi||\bar{\pi}](s_{t})\Big{\}}" class="ltx_math_unparsed" display="inline" id="S4.Ex2.m2.1">
         <semantics id="S4.Ex2.m2.1a">
          <mrow id="S4.Ex2.m2.1b">
           <mo id="S4.Ex2.m2.1.1" mathsize="90%">
            =
           </mo>
           <mi id="S4.Ex2.m2.1.2" mathsize="90%">
            arg
           </mi>
           <munder id="S4.Ex2.m2.1.3">
            <mi id="S4.Ex2.m2.1.3.2" mathsize="90%">
             max
            </mi>
            <mi id="S4.Ex2.m2.1.3.3" mathsize="90%">
             π
            </mi>
           </munder>
           <mrow id="S4.Ex2.m2.1.4">
            <mo id="S4.Ex2.m2.1.4.1" maxsize="160%" minsize="160%">
             {
            </mo>
            <msub id="S4.Ex2.m2.1.4.2">
             <mi id="S4.Ex2.m2.1.4.2.2" mathsize="90%">
              𝔼
             </mi>
             <mrow id="S4.Ex2.m2.1.4.2.3">
              <msub id="S4.Ex2.m2.1.4.2.3.2">
               <mi id="S4.Ex2.m2.1.4.2.3.2.2" mathsize="90%">
                a
               </mi>
               <mi id="S4.Ex2.m2.1.4.2.3.2.3" mathsize="90%">
                t
               </mi>
              </msub>
              <mo id="S4.Ex2.m2.1.4.2.3.1" mathsize="90%">
               ∼
              </mo>
              <mi id="S4.Ex2.m2.1.4.2.3.3" mathsize="90%">
               π
              </mi>
             </mrow>
            </msub>
            <mrow id="S4.Ex2.m2.1.4.3">
             <mo id="S4.Ex2.m2.1.4.3.1" maxsize="90%" minsize="90%">
              [
             </mo>
             <mi id="S4.Ex2.m2.1.4.3.2" mathsize="90%">
              Q
             </mi>
             <mrow id="S4.Ex2.m2.1.4.3.3">
              <mo id="S4.Ex2.m2.1.4.3.3.1" maxsize="90%" minsize="90%">
               (
              </mo>
              <msub id="S4.Ex2.m2.1.4.3.3.2">
               <mi id="S4.Ex2.m2.1.4.3.3.2.2" mathsize="90%">
                s
               </mi>
               <mi id="S4.Ex2.m2.1.4.3.3.2.3" mathsize="90%">
                t
               </mi>
              </msub>
              <mo id="S4.Ex2.m2.1.4.3.3.3" mathsize="90%">
               ,
              </mo>
              <msub id="S4.Ex2.m2.1.4.3.3.4">
               <mi id="S4.Ex2.m2.1.4.3.3.4.2" mathsize="90%">
                a
               </mi>
               <mi id="S4.Ex2.m2.1.4.3.3.4.3" mathsize="90%">
                t
               </mi>
              </msub>
              <mo id="S4.Ex2.m2.1.4.3.3.5" maxsize="90%" minsize="90%">
               )
              </mo>
             </mrow>
             <mo id="S4.Ex2.m2.1.4.3.4" maxsize="90%" minsize="90%">
              ]
             </mo>
            </mrow>
            <mo id="S4.Ex2.m2.1.4.4" mathsize="90%">
             −
            </mo>
            <mi id="S4.Ex2.m2.1.4.5" mathsize="90%">
             β
            </mi>
            <msub id="S4.Ex2.m2.1.4.6">
             <mi id="S4.Ex2.m2.1.4.6.2" mathsize="90%">
              D
             </mi>
             <mrow id="S4.Ex2.m2.1.4.6.3">
              <mi id="S4.Ex2.m2.1.4.6.3.2" mathsize="90%">
               K
              </mi>
              <mo id="S4.Ex2.m2.1.4.6.3.1" lspace="0em" rspace="0em">
               ​
              </mo>
              <mi id="S4.Ex2.m2.1.4.6.3.3" mathsize="90%">
               L
              </mi>
             </mrow>
            </msub>
            <mrow id="S4.Ex2.m2.1.4.7">
             <mo id="S4.Ex2.m2.1.4.7.1" maxsize="90%" minsize="90%">
              [
             </mo>
             <mi id="S4.Ex2.m2.1.4.7.2" mathsize="90%">
              π
             </mi>
             <mo fence="false" id="S4.Ex2.m2.1.4.7.3" maxsize="90%" minsize="90%" rspace="0.167em">
              |
             </mo>
             <mo fence="false" id="S4.Ex2.m2.1.4.7.4" maxsize="90%" minsize="90%" rspace="0.167em">
              |
             </mo>
             <mover accent="true" id="S4.Ex2.m2.1.4.7.5">
              <mi id="S4.Ex2.m2.1.4.7.5.2" mathsize="90%">
               π
              </mi>
              <mo id="S4.Ex2.m2.1.4.7.5.1" mathsize="90%">
               ¯
              </mo>
             </mover>
             <mo id="S4.Ex2.m2.1.4.7.6" maxsize="90%" minsize="90%">
              ]
             </mo>
            </mrow>
            <mrow id="S4.Ex2.m2.1.4.8">
             <mo id="S4.Ex2.m2.1.4.8.1" maxsize="90%" minsize="90%">
              (
             </mo>
             <msub id="S4.Ex2.m2.1.4.8.2">
              <mi id="S4.Ex2.m2.1.4.8.2.2" mathsize="90%">
               s
              </mi>
              <mi id="S4.Ex2.m2.1.4.8.2.3" mathsize="90%">
               t
              </mi>
             </msub>
             <mo id="S4.Ex2.m2.1.4.8.3" maxsize="90%" minsize="90%">
              )
             </mo>
            </mrow>
            <mo id="S4.Ex2.m2.1.4.9" maxsize="160%" minsize="160%">
             }
            </mo>
           </mrow>
          </mrow>
          <annotation encoding="application/x-tex" id="S4.Ex2.m2.1c">
           \displaystyle=\arg\max_{\pi}\Big{\{}\mathbb{E}_{a_{t}\sim\pi}[Q(s_{t},a_{t})]-\beta D_{KL}[\pi||\bar{\pi}](s_{t})\Big{\}}
          </annotation>
         </semantics>
        </math>
       </td>
       <td class="ltx_eqn_cell ltx_eqn_center_padright">
       </td>
      </tr>
     </tbody>
     <tbody id="S4.E8">
      <tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
       <td class="ltx_eqn_cell ltx_eqn_center_padleft">
       </td>
       <td class="ltx_td ltx_eqn_cell">
       </td>
       <td class="ltx_td ltx_align_left ltx_eqn_cell">
        <math alttext="\displaystyle=\frac{\bar{\pi}(a_{t}|s_{t})\exp(Q(s_{t},a_{t})/\beta)}{\mathbb{E}_{\bar{a}_{t}\sim\bar{\pi}(s_{t})}[\exp(Q(s_{t},\bar{a}_{t})/\beta)]}." class="ltx_Math" display="inline" id="S4.E8.m1.7">
         <semantics id="S4.E8.m1.7a">
          <mrow id="S4.E8.m1.7.7.1" xref="S4.E8.m1.7.7.1.1.cmml">
           <mrow id="S4.E8.m1.7.7.1.1" xref="S4.E8.m1.7.7.1.1.cmml">
            <mi id="S4.E8.m1.7.7.1.1.2" xref="S4.E8.m1.7.7.1.1.2.cmml">
            </mi>
            <mo id="S4.E8.m1.7.7.1.1.1" mathsize="90%" xref="S4.E8.m1.7.7.1.1.1.cmml">
             =
            </mo>
            <mstyle displaystyle="true" id="S4.E8.m1.6.6" xref="S4.E8.m1.6.6.cmml">
             <mfrac id="S4.E8.m1.6.6a" xref="S4.E8.m1.6.6.cmml">
              <mrow id="S4.E8.m1.3.3.3" xref="S4.E8.m1.3.3.3.cmml">
               <mover accent="true" id="S4.E8.m1.3.3.3.5" xref="S4.E8.m1.3.3.3.5.cmml">
                <mi id="S4.E8.m1.3.3.3.5.2" mathsize="90%" xref="S4.E8.m1.3.3.3.5.2.cmml">
                 π
                </mi>
                <mo id="S4.E8.m1.3.3.3.5.1" mathsize="90%" xref="S4.E8.m1.3.3.3.5.1.cmml">
                 ¯
                </mo>
               </mover>
               <mo id="S4.E8.m1.3.3.3.4" lspace="0em" rspace="0em" xref="S4.E8.m1.3.3.3.4.cmml">
                ​
               </mo>
               <mrow id="S4.E8.m1.2.2.2.2.1" xref="S4.E8.m1.2.2.2.2.1.1.cmml">
                <mo id="S4.E8.m1.2.2.2.2.1.2" maxsize="90%" minsize="90%" xref="S4.E8.m1.2.2.2.2.1.1.cmml">
                 (
                </mo>
                <mrow id="S4.E8.m1.2.2.2.2.1.1" xref="S4.E8.m1.2.2.2.2.1.1.cmml">
                 <msub id="S4.E8.m1.2.2.2.2.1.1.2" xref="S4.E8.m1.2.2.2.2.1.1.2.cmml">
                  <mi id="S4.E8.m1.2.2.2.2.1.1.2.2" mathsize="90%" xref="S4.E8.m1.2.2.2.2.1.1.2.2.cmml">
                   a
                  </mi>
                  <mi id="S4.E8.m1.2.2.2.2.1.1.2.3" mathsize="90%" xref="S4.E8.m1.2.2.2.2.1.1.2.3.cmml">
                   t
                  </mi>
                 </msub>
                 <mo fence="false" id="S4.E8.m1.2.2.2.2.1.1.1" mathsize="90%" xref="S4.E8.m1.2.2.2.2.1.1.1.cmml">
                  |
                 </mo>
                 <msub id="S4.E8.m1.2.2.2.2.1.1.3" xref="S4.E8.m1.2.2.2.2.1.1.3.cmml">
                  <mi id="S4.E8.m1.2.2.2.2.1.1.3.2" mathsize="90%" xref="S4.E8.m1.2.2.2.2.1.1.3.2.cmml">
                   s
                  </mi>
                  <mi id="S4.E8.m1.2.2.2.2.1.1.3.3" mathsize="90%" xref="S4.E8.m1.2.2.2.2.1.1.3.3.cmml">
                   t
                  </mi>
                 </msub>
                </mrow>
                <mo id="S4.E8.m1.2.2.2.2.1.3" maxsize="90%" minsize="90%" xref="S4.E8.m1.2.2.2.2.1.1.cmml">
                 )
                </mo>
               </mrow>
               <mo id="S4.E8.m1.3.3.3.4a" lspace="0.167em" rspace="0em" xref="S4.E8.m1.3.3.3.4.cmml">
                ​
               </mo>
               <mrow id="S4.E8.m1.3.3.3.3.1" xref="S4.E8.m1.3.3.3.3.2.cmml">
                <mi id="S4.E8.m1.1.1.1.1" mathsize="90%" xref="S4.E8.m1.1.1.1.1.cmml">
                 exp
                </mi>
                <mo id="S4.E8.m1.3.3.3.3.1a" xref="S4.E8.m1.3.3.3.3.2.cmml">
                 ⁡
                </mo>
                <mrow id="S4.E8.m1.3.3.3.3.1.1" xref="S4.E8.m1.3.3.3.3.2.cmml">
                 <mo id="S4.E8.m1.3.3.3.3.1.1.2" maxsize="90%" minsize="90%" xref="S4.E8.m1.3.3.3.3.2.cmml">
                  (
                 </mo>
                 <mrow id="S4.E8.m1.3.3.3.3.1.1.1" xref="S4.E8.m1.3.3.3.3.1.1.1.cmml">
                  <mrow id="S4.E8.m1.3.3.3.3.1.1.1.2" xref="S4.E8.m1.3.3.3.3.1.1.1.2.cmml">
                   <mi id="S4.E8.m1.3.3.3.3.1.1.1.2.4" mathsize="90%" xref="S4.E8.m1.3.3.3.3.1.1.1.2.4.cmml">
                    Q
                   </mi>
                   <mo id="S4.E8.m1.3.3.3.3.1.1.1.2.3" lspace="0em" rspace="0em" xref="S4.E8.m1.3.3.3.3.1.1.1.2.3.cmml">
                    ​
                   </mo>
                   <mrow id="S4.E8.m1.3.3.3.3.1.1.1.2.2.2" xref="S4.E8.m1.3.3.3.3.1.1.1.2.2.3.cmml">
                    <mo id="S4.E8.m1.3.3.3.3.1.1.1.2.2.2.3" maxsize="90%" minsize="90%" xref="S4.E8.m1.3.3.3.3.1.1.1.2.2.3.cmml">
                     (
                    </mo>
                    <msub id="S4.E8.m1.3.3.3.3.1.1.1.1.1.1.1" xref="S4.E8.m1.3.3.3.3.1.1.1.1.1.1.1.cmml">
                     <mi id="S4.E8.m1.3.3.3.3.1.1.1.1.1.1.1.2" mathsize="90%" xref="S4.E8.m1.3.3.3.3.1.1.1.1.1.1.1.2.cmml">
                      s
                     </mi>
                     <mi id="S4.E8.m1.3.3.3.3.1.1.1.1.1.1.1.3" mathsize="90%" xref="S4.E8.m1.3.3.3.3.1.1.1.1.1.1.1.3.cmml">
                      t
                     </mi>
                    </msub>
                    <mo id="S4.E8.m1.3.3.3.3.1.1.1.2.2.2.4" mathsize="90%" xref="S4.E8.m1.3.3.3.3.1.1.1.2.2.3.cmml">
                     ,
                    </mo>
                    <msub id="S4.E8.m1.3.3.3.3.1.1.1.2.2.2.2" xref="S4.E8.m1.3.3.3.3.1.1.1.2.2.2.2.cmml">
                     <mi id="S4.E8.m1.3.3.3.3.1.1.1.2.2.2.2.2" mathsize="90%" xref="S4.E8.m1.3.3.3.3.1.1.1.2.2.2.2.2.cmml">
                      a
                     </mi>
                     <mi id="S4.E8.m1.3.3.3.3.1.1.1.2.2.2.2.3" mathsize="90%" xref="S4.E8.m1.3.3.3.3.1.1.1.2.2.2.2.3.cmml">
                      t
                     </mi>
                    </msub>
                    <mo id="S4.E8.m1.3.3.3.3.1.1.1.2.2.2.5" maxsize="90%" minsize="90%" xref="S4.E8.m1.3.3.3.3.1.1.1.2.2.3.cmml">
                     )
                    </mo>
                   </mrow>
                  </mrow>
                  <mo id="S4.E8.m1.3.3.3.3.1.1.1.3" maxsize="90%" minsize="90%" stretchy="true" symmetric="true" xref="S4.E8.m1.3.3.3.3.1.1.1.3.cmml">
                   /
                  </mo>
                  <mi id="S4.E8.m1.3.3.3.3.1.1.1.4" mathsize="90%" xref="S4.E8.m1.3.3.3.3.1.1.1.4.cmml">
                   β
                  </mi>
                 </mrow>
                 <mo id="S4.E8.m1.3.3.3.3.1.1.3" maxsize="90%" minsize="90%" xref="S4.E8.m1.3.3.3.3.2.cmml">
                  )
                 </mo>
                </mrow>
               </mrow>
              </mrow>
              <mrow id="S4.E8.m1.6.6.6" xref="S4.E8.m1.6.6.6.cmml">
               <msub id="S4.E8.m1.6.6.6.5" xref="S4.E8.m1.6.6.6.5.cmml">
                <mi id="S4.E8.m1.6.6.6.5.2" mathsize="90%" xref="S4.E8.m1.6.6.6.5.2.cmml">
                 𝔼
                </mi>
                <mrow id="S4.E8.m1.4.4.4.1.1" xref="S4.E8.m1.4.4.4.1.1.cmml">
                 <msub id="S4.E8.m1.4.4.4.1.1.3" xref="S4.E8.m1.4.4.4.1.1.3.cmml">
                  <mover accent="true" id="S4.E8.m1.4.4.4.1.1.3.2" xref="S4.E8.m1.4.4.4.1.1.3.2.cmml">
                   <mi id="S4.E8.m1.4.4.4.1.1.3.2.2" mathsize="90%" xref="S4.E8.m1.4.4.4.1.1.3.2.2.cmml">
                    a
                   </mi>
                   <mo id="S4.E8.m1.4.4.4.1.1.3.2.1" mathsize="90%" xref="S4.E8.m1.4.4.4.1.1.3.2.1.cmml">
                    ¯
                   </mo>
                  </mover>
                  <mi id="S4.E8.m1.4.4.4.1.1.3.3" mathsize="90%" xref="S4.E8.m1.4.4.4.1.1.3.3.cmml">
                   t
                  </mi>
                 </msub>
                 <mo id="S4.E8.m1.4.4.4.1.1.2" mathsize="90%" xref="S4.E8.m1.4.4.4.1.1.2.cmml">
                  ∼
                 </mo>
                 <mrow id="S4.E8.m1.4.4.4.1.1.1" xref="S4.E8.m1.4.4.4.1.1.1.cmml">
                  <mover accent="true" id="S4.E8.m1.4.4.4.1.1.1.3" xref="S4.E8.m1.4.4.4.1.1.1.3.cmml">
                   <mi id="S4.E8.m1.4.4.4.1.1.1.3.2" mathsize="90%" xref="S4.E8.m1.4.4.4.1.1.1.3.2.cmml">
                    π
                   </mi>
                   <mo id="S4.E8.m1.4.4.4.1.1.1.3.1" mathsize="90%" xref="S4.E8.m1.4.4.4.1.1.1.3.1.cmml">
                    ¯
                   </mo>
                  </mover>
                  <mo id="S4.E8.m1.4.4.4.1.1.1.2" lspace="0em" rspace="0em" xref="S4.E8.m1.4.4.4.1.1.1.2.cmml">
                   ​
                  </mo>
                  <mrow id="S4.E8.m1.4.4.4.1.1.1.1.1" xref="S4.E8.m1.4.4.4.1.1.1.1.1.1.cmml">
                   <mo id="S4.E8.m1.4.4.4.1.1.1.1.1.2" maxsize="90%" minsize="90%" xref="S4.E8.m1.4.4.4.1.1.1.1.1.1.cmml">
                    (
                   </mo>
                   <msub id="S4.E8.m1.4.4.4.1.1.1.1.1.1" xref="S4.E8.m1.4.4.4.1.1.1.1.1.1.cmml">
                    <mi id="S4.E8.m1.4.4.4.1.1.1.1.1.1.2" mathsize="90%" xref="S4.E8.m1.4.4.4.1.1.1.1.1.1.2.cmml">
                     s
                    </mi>
                    <mi id="S4.E8.m1.4.4.4.1.1.1.1.1.1.3" mathsize="90%" xref="S4.E8.m1.4.4.4.1.1.1.1.1.1.3.cmml">
                     t
                    </mi>
                   </msub>
                   <mo id="S4.E8.m1.4.4.4.1.1.1.1.1.3" maxsize="90%" minsize="90%" xref="S4.E8.m1.4.4.4.1.1.1.1.1.1.cmml">
                    )
                   </mo>
                  </mrow>
                 </mrow>
                </mrow>
               </msub>
               <mo id="S4.E8.m1.6.6.6.4" lspace="0em" rspace="0em" xref="S4.E8.m1.6.6.6.4.cmml">
                ​
               </mo>
               <mrow id="S4.E8.m1.6.6.6.3.1" xref="S4.E8.m1.6.6.6.3.2.cmml">
                <mo id="S4.E8.m1.6.6.6.3.1.2" maxsize="90%" minsize="90%" xref="S4.E8.m1.6.6.6.3.2.1.cmml">
                 [
                </mo>
                <mrow id="S4.E8.m1.6.6.6.3.1.1.1" xref="S4.E8.m1.6.6.6.3.1.1.2.cmml">
                 <mi id="S4.E8.m1.5.5.5.2" mathsize="90%" xref="S4.E8.m1.5.5.5.2.cmml">
                  exp
                 </mi>
                 <mo id="S4.E8.m1.6.6.6.3.1.1.1a" xref="S4.E8.m1.6.6.6.3.1.1.2.cmml">
                  ⁡
                 </mo>
                 <mrow id="S4.E8.m1.6.6.6.3.1.1.1.1" xref="S4.E8.m1.6.6.6.3.1.1.2.cmml">
                  <mo id="S4.E8.m1.6.6.6.3.1.1.1.1.2" maxsize="90%" minsize="90%" xref="S4.E8.m1.6.6.6.3.1.1.2.cmml">
                   (
                  </mo>
                  <mrow id="S4.E8.m1.6.6.6.3.1.1.1.1.1" xref="S4.E8.m1.6.6.6.3.1.1.1.1.1.cmml">
                   <mrow id="S4.E8.m1.6.6.6.3.1.1.1.1.1.2" xref="S4.E8.m1.6.6.6.3.1.1.1.1.1.2.cmml">
                    <mi id="S4.E8.m1.6.6.6.3.1.1.1.1.1.2.4" mathsize="90%" xref="S4.E8.m1.6.6.6.3.1.1.1.1.1.2.4.cmml">
                     Q
                    </mi>
                    <mo id="S4.E8.m1.6.6.6.3.1.1.1.1.1.2.3" lspace="0em" rspace="0em" xref="S4.E8.m1.6.6.6.3.1.1.1.1.1.2.3.cmml">
                     ​
                    </mo>
                    <mrow id="S4.E8.m1.6.6.6.3.1.1.1.1.1.2.2.2" xref="S4.E8.m1.6.6.6.3.1.1.1.1.1.2.2.3.cmml">
                     <mo id="S4.E8.m1.6.6.6.3.1.1.1.1.1.2.2.2.3" maxsize="90%" minsize="90%" xref="S4.E8.m1.6.6.6.3.1.1.1.1.1.2.2.3.cmml">
                      (
                     </mo>
                     <msub id="S4.E8.m1.6.6.6.3.1.1.1.1.1.1.1.1.1" xref="S4.E8.m1.6.6.6.3.1.1.1.1.1.1.1.1.1.cmml">
                      <mi id="S4.E8.m1.6.6.6.3.1.1.1.1.1.1.1.1.1.2" mathsize="90%" xref="S4.E8.m1.6.6.6.3.1.1.1.1.1.1.1.1.1.2.cmml">
                       s
                      </mi>
                      <mi id="S4.E8.m1.6.6.6.3.1.1.1.1.1.1.1.1.1.3" mathsize="90%" xref="S4.E8.m1.6.6.6.3.1.1.1.1.1.1.1.1.1.3.cmml">
                       t
                      </mi>
                     </msub>
                     <mo id="S4.E8.m1.6.6.6.3.1.1.1.1.1.2.2.2.4" mathsize="90%" xref="S4.E8.m1.6.6.6.3.1.1.1.1.1.2.2.3.cmml">
                      ,
                     </mo>
                     <msub id="S4.E8.m1.6.6.6.3.1.1.1.1.1.2.2.2.2" xref="S4.E8.m1.6.6.6.3.1.1.1.1.1.2.2.2.2.cmml">
                      <mover accent="true" id="S4.E8.m1.6.6.6.3.1.1.1.1.1.2.2.2.2.2" xref="S4.E8.m1.6.6.6.3.1.1.1.1.1.2.2.2.2.2.cmml">
                       <mi id="S4.E8.m1.6.6.6.3.1.1.1.1.1.2.2.2.2.2.2" mathsize="90%" xref="S4.E8.m1.6.6.6.3.1.1.1.1.1.2.2.2.2.2.2.cmml">
                        a
                       </mi>
                       <mo id="S4.E8.m1.6.6.6.3.1.1.1.1.1.2.2.2.2.2.1" mathsize="90%" xref="S4.E8.m1.6.6.6.3.1.1.1.1.1.2.2.2.2.2.1.cmml">
                        ¯
                       </mo>
                      </mover>
                      <mi id="S4.E8.m1.6.6.6.3.1.1.1.1.1.2.2.2.2.3" mathsize="90%" xref="S4.E8.m1.6.6.6.3.1.1.1.1.1.2.2.2.2.3.cmml">
                       t
                      </mi>
                     </msub>
                     <mo id="S4.E8.m1.6.6.6.3.1.1.1.1.1.2.2.2.5" maxsize="90%" minsize="90%" xref="S4.E8.m1.6.6.6.3.1.1.1.1.1.2.2.3.cmml">
                      )
                     </mo>
                    </mrow>
                   </mrow>
                   <mo id="S4.E8.m1.6.6.6.3.1.1.1.1.1.3" maxsize="90%" minsize="90%" stretchy="true" symmetric="true" xref="S4.E8.m1.6.6.6.3.1.1.1.1.1.3.cmml">
                    /
                   </mo>
                   <mi id="S4.E8.m1.6.6.6.3.1.1.1.1.1.4" mathsize="90%" xref="S4.E8.m1.6.6.6.3.1.1.1.1.1.4.cmml">
                    β
                   </mi>
                  </mrow>
                  <mo id="S4.E8.m1.6.6.6.3.1.1.1.1.3" maxsize="90%" minsize="90%" xref="S4.E8.m1.6.6.6.3.1.1.2.cmml">
                   )
                  </mo>
                 </mrow>
                </mrow>
                <mo id="S4.E8.m1.6.6.6.3.1.3" maxsize="90%" minsize="90%" xref="S4.E8.m1.6.6.6.3.2.1.cmml">
                 ]
                </mo>
               </mrow>
              </mrow>
             </mfrac>
            </mstyle>
           </mrow>
           <mo id="S4.E8.m1.7.7.1.2" lspace="0em" mathsize="90%" xref="S4.E8.m1.7.7.1.1.cmml">
            .
           </mo>
          </mrow>
          <annotation-xml encoding="MathML-Content" id="S4.E8.m1.7b">
           <apply id="S4.E8.m1.7.7.1.1.cmml" xref="S4.E8.m1.7.7.1">
            <eq id="S4.E8.m1.7.7.1.1.1.cmml" xref="S4.E8.m1.7.7.1.1.1">
            </eq>
            <csymbol cd="latexml" id="S4.E8.m1.7.7.1.1.2.cmml" xref="S4.E8.m1.7.7.1.1.2">
             absent
            </csymbol>
            <apply id="S4.E8.m1.6.6.cmml" xref="S4.E8.m1.6.6">
             <divide id="S4.E8.m1.6.6.7.cmml" xref="S4.E8.m1.6.6">
             </divide>
             <apply id="S4.E8.m1.3.3.3.cmml" xref="S4.E8.m1.3.3.3">
              <times id="S4.E8.m1.3.3.3.4.cmml" xref="S4.E8.m1.3.3.3.4">
              </times>
              <apply id="S4.E8.m1.3.3.3.5.cmml" xref="S4.E8.m1.3.3.3.5">
               <ci id="S4.E8.m1.3.3.3.5.1.cmml" xref="S4.E8.m1.3.3.3.5.1">
                ¯
               </ci>
               <ci id="S4.E8.m1.3.3.3.5.2.cmml" xref="S4.E8.m1.3.3.3.5.2">
                𝜋
               </ci>
              </apply>
              <apply id="S4.E8.m1.2.2.2.2.1.1.cmml" xref="S4.E8.m1.2.2.2.2.1">
               <csymbol cd="latexml" id="S4.E8.m1.2.2.2.2.1.1.1.cmml" xref="S4.E8.m1.2.2.2.2.1.1.1">
                conditional
               </csymbol>
               <apply id="S4.E8.m1.2.2.2.2.1.1.2.cmml" xref="S4.E8.m1.2.2.2.2.1.1.2">
                <csymbol cd="ambiguous" id="S4.E8.m1.2.2.2.2.1.1.2.1.cmml" xref="S4.E8.m1.2.2.2.2.1.1.2">
                 subscript
                </csymbol>
                <ci id="S4.E8.m1.2.2.2.2.1.1.2.2.cmml" xref="S4.E8.m1.2.2.2.2.1.1.2.2">
                 𝑎
                </ci>
                <ci id="S4.E8.m1.2.2.2.2.1.1.2.3.cmml" xref="S4.E8.m1.2.2.2.2.1.1.2.3">
                 𝑡
                </ci>
               </apply>
               <apply id="S4.E8.m1.2.2.2.2.1.1.3.cmml" xref="S4.E8.m1.2.2.2.2.1.1.3">
                <csymbol cd="ambiguous" id="S4.E8.m1.2.2.2.2.1.1.3.1.cmml" xref="S4.E8.m1.2.2.2.2.1.1.3">
                 subscript
                </csymbol>
                <ci id="S4.E8.m1.2.2.2.2.1.1.3.2.cmml" xref="S4.E8.m1.2.2.2.2.1.1.3.2">
                 𝑠
                </ci>
                <ci id="S4.E8.m1.2.2.2.2.1.1.3.3.cmml" xref="S4.E8.m1.2.2.2.2.1.1.3.3">
                 𝑡
                </ci>
               </apply>
              </apply>
              <apply id="S4.E8.m1.3.3.3.3.2.cmml" xref="S4.E8.m1.3.3.3.3.1">
               <exp id="S4.E8.m1.1.1.1.1.cmml" xref="S4.E8.m1.1.1.1.1">
               </exp>
               <apply id="S4.E8.m1.3.3.3.3.1.1.1.cmml" xref="S4.E8.m1.3.3.3.3.1.1.1">
                <divide id="S4.E8.m1.3.3.3.3.1.1.1.3.cmml" xref="S4.E8.m1.3.3.3.3.1.1.1.3">
                </divide>
                <apply id="S4.E8.m1.3.3.3.3.1.1.1.2.cmml" xref="S4.E8.m1.3.3.3.3.1.1.1.2">
                 <times id="S4.E8.m1.3.3.3.3.1.1.1.2.3.cmml" xref="S4.E8.m1.3.3.3.3.1.1.1.2.3">
                 </times>
                 <ci id="S4.E8.m1.3.3.3.3.1.1.1.2.4.cmml" xref="S4.E8.m1.3.3.3.3.1.1.1.2.4">
                  𝑄
                 </ci>
                 <interval closure="open" id="S4.E8.m1.3.3.3.3.1.1.1.2.2.3.cmml" xref="S4.E8.m1.3.3.3.3.1.1.1.2.2.2">
                  <apply id="S4.E8.m1.3.3.3.3.1.1.1.1.1.1.1.cmml" xref="S4.E8.m1.3.3.3.3.1.1.1.1.1.1.1">
                   <csymbol cd="ambiguous" id="S4.E8.m1.3.3.3.3.1.1.1.1.1.1.1.1.cmml" xref="S4.E8.m1.3.3.3.3.1.1.1.1.1.1.1">
                    subscript
                   </csymbol>
                   <ci id="S4.E8.m1.3.3.3.3.1.1.1.1.1.1.1.2.cmml" xref="S4.E8.m1.3.3.3.3.1.1.1.1.1.1.1.2">
                    𝑠
                   </ci>
                   <ci id="S4.E8.m1.3.3.3.3.1.1.1.1.1.1.1.3.cmml" xref="S4.E8.m1.3.3.3.3.1.1.1.1.1.1.1.3">
                    𝑡
                   </ci>
                  </apply>
                  <apply id="S4.E8.m1.3.3.3.3.1.1.1.2.2.2.2.cmml" xref="S4.E8.m1.3.3.3.3.1.1.1.2.2.2.2">
                   <csymbol cd="ambiguous" id="S4.E8.m1.3.3.3.3.1.1.1.2.2.2.2.1.cmml" xref="S4.E8.m1.3.3.3.3.1.1.1.2.2.2.2">
                    subscript
                   </csymbol>
                   <ci id="S4.E8.m1.3.3.3.3.1.1.1.2.2.2.2.2.cmml" xref="S4.E8.m1.3.3.3.3.1.1.1.2.2.2.2.2">
                    𝑎
                   </ci>
                   <ci id="S4.E8.m1.3.3.3.3.1.1.1.2.2.2.2.3.cmml" xref="S4.E8.m1.3.3.3.3.1.1.1.2.2.2.2.3">
                    𝑡
                   </ci>
                  </apply>
                 </interval>
                </apply>
                <ci id="S4.E8.m1.3.3.3.3.1.1.1.4.cmml" xref="S4.E8.m1.3.3.3.3.1.1.1.4">
                 𝛽
                </ci>
               </apply>
              </apply>
             </apply>
             <apply id="S4.E8.m1.6.6.6.cmml" xref="S4.E8.m1.6.6.6">
              <times id="S4.E8.m1.6.6.6.4.cmml" xref="S4.E8.m1.6.6.6.4">
              </times>
              <apply id="S4.E8.m1.6.6.6.5.cmml" xref="S4.E8.m1.6.6.6.5">
               <csymbol cd="ambiguous" id="S4.E8.m1.6.6.6.5.1.cmml" xref="S4.E8.m1.6.6.6.5">
                subscript
               </csymbol>
               <ci id="S4.E8.m1.6.6.6.5.2.cmml" xref="S4.E8.m1.6.6.6.5.2">
                𝔼
               </ci>
               <apply id="S4.E8.m1.4.4.4.1.1.cmml" xref="S4.E8.m1.4.4.4.1.1">
                <csymbol cd="latexml" id="S4.E8.m1.4.4.4.1.1.2.cmml" xref="S4.E8.m1.4.4.4.1.1.2">
                 similar-to
                </csymbol>
                <apply id="S4.E8.m1.4.4.4.1.1.3.cmml" xref="S4.E8.m1.4.4.4.1.1.3">
                 <csymbol cd="ambiguous" id="S4.E8.m1.4.4.4.1.1.3.1.cmml" xref="S4.E8.m1.4.4.4.1.1.3">
                  subscript
                 </csymbol>
                 <apply id="S4.E8.m1.4.4.4.1.1.3.2.cmml" xref="S4.E8.m1.4.4.4.1.1.3.2">
                  <ci id="S4.E8.m1.4.4.4.1.1.3.2.1.cmml" xref="S4.E8.m1.4.4.4.1.1.3.2.1">
                   ¯
                  </ci>
                  <ci id="S4.E8.m1.4.4.4.1.1.3.2.2.cmml" xref="S4.E8.m1.4.4.4.1.1.3.2.2">
                   𝑎
                  </ci>
                 </apply>
                 <ci id="S4.E8.m1.4.4.4.1.1.3.3.cmml" xref="S4.E8.m1.4.4.4.1.1.3.3">
                  𝑡
                 </ci>
                </apply>
                <apply id="S4.E8.m1.4.4.4.1.1.1.cmml" xref="S4.E8.m1.4.4.4.1.1.1">
                 <times id="S4.E8.m1.4.4.4.1.1.1.2.cmml" xref="S4.E8.m1.4.4.4.1.1.1.2">
                 </times>
                 <apply id="S4.E8.m1.4.4.4.1.1.1.3.cmml" xref="S4.E8.m1.4.4.4.1.1.1.3">
                  <ci id="S4.E8.m1.4.4.4.1.1.1.3.1.cmml" xref="S4.E8.m1.4.4.4.1.1.1.3.1">
                   ¯
                  </ci>
                  <ci id="S4.E8.m1.4.4.4.1.1.1.3.2.cmml" xref="S4.E8.m1.4.4.4.1.1.1.3.2">
                   𝜋
                  </ci>
                 </apply>
                 <apply id="S4.E8.m1.4.4.4.1.1.1.1.1.1.cmml" xref="S4.E8.m1.4.4.4.1.1.1.1.1">
                  <csymbol cd="ambiguous" id="S4.E8.m1.4.4.4.1.1.1.1.1.1.1.cmml" xref="S4.E8.m1.4.4.4.1.1.1.1.1">
                   subscript
                  </csymbol>
                  <ci id="S4.E8.m1.4.4.4.1.1.1.1.1.1.2.cmml" xref="S4.E8.m1.4.4.4.1.1.1.1.1.1.2">
                   𝑠
                  </ci>
                  <ci id="S4.E8.m1.4.4.4.1.1.1.1.1.1.3.cmml" xref="S4.E8.m1.4.4.4.1.1.1.1.1.1.3">
                   𝑡
                  </ci>
                 </apply>
                </apply>
               </apply>
              </apply>
              <apply id="S4.E8.m1.6.6.6.3.2.cmml" xref="S4.E8.m1.6.6.6.3.1">
               <csymbol cd="latexml" id="S4.E8.m1.6.6.6.3.2.1.cmml" xref="S4.E8.m1.6.6.6.3.1.2">
                delimited-[]
               </csymbol>
               <apply id="S4.E8.m1.6.6.6.3.1.1.2.cmml" xref="S4.E8.m1.6.6.6.3.1.1.1">
                <exp id="S4.E8.m1.5.5.5.2.cmml" xref="S4.E8.m1.5.5.5.2">
                </exp>
                <apply id="S4.E8.m1.6.6.6.3.1.1.1.1.1.cmml" xref="S4.E8.m1.6.6.6.3.1.1.1.1.1">
                 <divide id="S4.E8.m1.6.6.6.3.1.1.1.1.1.3.cmml" xref="S4.E8.m1.6.6.6.3.1.1.1.1.1.3">
                 </divide>
                 <apply id="S4.E8.m1.6.6.6.3.1.1.1.1.1.2.cmml" xref="S4.E8.m1.6.6.6.3.1.1.1.1.1.2">
                  <times id="S4.E8.m1.6.6.6.3.1.1.1.1.1.2.3.cmml" xref="S4.E8.m1.6.6.6.3.1.1.1.1.1.2.3">
                  </times>
                  <ci id="S4.E8.m1.6.6.6.3.1.1.1.1.1.2.4.cmml" xref="S4.E8.m1.6.6.6.3.1.1.1.1.1.2.4">
                   𝑄
                  </ci>
                  <interval closure="open" id="S4.E8.m1.6.6.6.3.1.1.1.1.1.2.2.3.cmml" xref="S4.E8.m1.6.6.6.3.1.1.1.1.1.2.2.2">
                   <apply id="S4.E8.m1.6.6.6.3.1.1.1.1.1.1.1.1.1.cmml" xref="S4.E8.m1.6.6.6.3.1.1.1.1.1.1.1.1.1">
                    <csymbol cd="ambiguous" id="S4.E8.m1.6.6.6.3.1.1.1.1.1.1.1.1.1.1.cmml" xref="S4.E8.m1.6.6.6.3.1.1.1.1.1.1.1.1.1">
                     subscript
                    </csymbol>
                    <ci id="S4.E8.m1.6.6.6.3.1.1.1.1.1.1.1.1.1.2.cmml" xref="S4.E8.m1.6.6.6.3.1.1.1.1.1.1.1.1.1.2">
                     𝑠
                    </ci>
                    <ci id="S4.E8.m1.6.6.6.3.1.1.1.1.1.1.1.1.1.3.cmml" xref="S4.E8.m1.6.6.6.3.1.1.1.1.1.1.1.1.1.3">
                     𝑡
                    </ci>
                   </apply>
                   <apply id="S4.E8.m1.6.6.6.3.1.1.1.1.1.2.2.2.2.cmml" xref="S4.E8.m1.6.6.6.3.1.1.1.1.1.2.2.2.2">
                    <csymbol cd="ambiguous" id="S4.E8.m1.6.6.6.3.1.1.1.1.1.2.2.2.2.1.cmml" xref="S4.E8.m1.6.6.6.3.1.1.1.1.1.2.2.2.2">
                     subscript
                    </csymbol>
                    <apply id="S4.E8.m1.6.6.6.3.1.1.1.1.1.2.2.2.2.2.cmml" xref="S4.E8.m1.6.6.6.3.1.1.1.1.1.2.2.2.2.2">
                     <ci id="S4.E8.m1.6.6.6.3.1.1.1.1.1.2.2.2.2.2.1.cmml" xref="S4.E8.m1.6.6.6.3.1.1.1.1.1.2.2.2.2.2.1">
                      ¯
                     </ci>
                     <ci id="S4.E8.m1.6.6.6.3.1.1.1.1.1.2.2.2.2.2.2.cmml" xref="S4.E8.m1.6.6.6.3.1.1.1.1.1.2.2.2.2.2.2">
                      𝑎
                     </ci>
                    </apply>
                    <ci id="S4.E8.m1.6.6.6.3.1.1.1.1.1.2.2.2.2.3.cmml" xref="S4.E8.m1.6.6.6.3.1.1.1.1.1.2.2.2.2.3">
                     𝑡
                    </ci>
                   </apply>
                  </interval>
                 </apply>
                 <ci id="S4.E8.m1.6.6.6.3.1.1.1.1.1.4.cmml" xref="S4.E8.m1.6.6.6.3.1.1.1.1.1.4">
                  𝛽
                 </ci>
                </apply>
               </apply>
              </apply>
             </apply>
            </apply>
           </apply>
          </annotation-xml>
          <annotation encoding="application/x-tex" id="S4.E8.m1.7c">
           \displaystyle=\frac{\bar{\pi}(a_{t}|s_{t})\exp(Q(s_{t},a_{t})/\beta)}{\mathbb{E}_{\bar{a}_{t}\sim\bar{\pi}(s_{t})}[\exp(Q(s_{t},\bar{a}_{t})/\beta)]}.
          </annotation>
         </semantics>
        </math>
       </td>
       <td class="ltx_eqn_cell ltx_eqn_center_padright">
       </td>
       <td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1">
        <span class="ltx_tag ltx_tag_equation ltx_align_right">
         (8)
        </span>
       </td>
      </tr>
     </tbody>
    </table>
    <p class="ltx_p" id="S4.SS2.p1.7">
     <span class="ltx_text" id="S4.SS2.p1.7.1" style="font-size:90%;">
      Recall the Equation
      <a class="ltx_ref" href="#A1.E13" title="Equation 13 ‣ Appendix A Proof of Optimization Consistency ‣ Entropy-Regularized Token-Level Policy Optimization for Large Language Models">
       <span class="ltx_text ltx_ref_tag">
        13
       </span>
      </a>
      , we rewrite this optimal policy at the token level:
     </span>
    </p>
    <table class="ltx_equationgroup ltx_eqn_align ltx_eqn_table" id="A7.EGx9">
     <tbody id="S4.E9">
      <tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
       <td class="ltx_eqn_cell ltx_eqn_center_padleft">
       </td>
       <td class="ltx_td ltx_align_right ltx_eqn_cell">
        <math alttext="\displaystyle\pi^{*}(\cdot|s_{t},w_{t}^{1:j-1})=\frac{\bar{\pi}(w_{t}^{j}|s_{t},w_{t}^{1:j-1})\exp(Q(s_{t},w_{t}^{1:j-1},w_{t}^{j})/\beta)}{\mathbb{E}_{\bar{w}_{t}^{j}\sim\bar{\pi}}[\exp(Q(s_{t},w_{t}^{1:j-1},\bar{w}_{t}^{j})/\beta)]}." class="ltx_math_unparsed" display="inline" id="S4.E9.m1.5">
         <semantics id="S4.E9.m1.5a">
          <mrow id="S4.E9.m1.5b">
           <msup id="S4.E9.m1.5.6">
            <mi id="S4.E9.m1.5.6.2" mathsize="90%">
             π
            </mi>
            <mo id="S4.E9.m1.5.6.3" mathsize="90%">
             ∗
            </mo>
           </msup>
           <mrow id="S4.E9.m1.5.7">
            <mo id="S4.E9.m1.5.7.1" maxsize="90%" minsize="90%">
             (
            </mo>
            <mo id="S4.E9.m1.5.7.2" lspace="0em" mathsize="90%" rspace="0em">
             ⋅
            </mo>
            <mo fence="false" id="S4.E9.m1.5.7.3" maxsize="90%" minsize="90%" rspace="0.167em">
             |
            </mo>
            <msub id="S4.E9.m1.5.7.4">
             <mi id="S4.E9.m1.5.7.4.2" mathsize="90%">
              s
             </mi>
             <mi id="S4.E9.m1.5.7.4.3" mathsize="90%">
              t
             </mi>
            </msub>
            <mo id="S4.E9.m1.5.7.5" mathsize="90%">
             ,
            </mo>
            <msubsup id="S4.E9.m1.5.7.6">
             <mi id="S4.E9.m1.5.7.6.2.2" mathsize="90%">
              w
             </mi>
             <mi id="S4.E9.m1.5.7.6.2.3" mathsize="90%">
              t
             </mi>
             <mrow id="S4.E9.m1.5.7.6.3">
              <mn id="S4.E9.m1.5.7.6.3.2" mathsize="90%">
               1
              </mn>
              <mo id="S4.E9.m1.5.7.6.3.1" lspace="0.278em" mathsize="90%" rspace="0.278em">
               :
              </mo>
              <mrow id="S4.E9.m1.5.7.6.3.3">
               <mi id="S4.E9.m1.5.7.6.3.3.2" mathsize="90%">
                j
               </mi>
               <mo id="S4.E9.m1.5.7.6.3.3.1" mathsize="90%">
                −
               </mo>
               <mn id="S4.E9.m1.5.7.6.3.3.3" mathsize="90%">
                1
               </mn>
              </mrow>
             </mrow>
            </msubsup>
            <mo id="S4.E9.m1.5.7.7" maxsize="90%" minsize="90%">
             )
            </mo>
           </mrow>
           <mo id="S4.E9.m1.5.8" mathsize="90%">
            =
           </mo>
           <mstyle displaystyle="true" id="S4.E9.m1.5.5">
            <mfrac id="S4.E9.m1.5.5a">
             <mrow id="S4.E9.m1.3.3.3">
              <mover accent="true" id="S4.E9.m1.3.3.3.5">
               <mi id="S4.E9.m1.3.3.3.5.2" mathsize="90%">
                π
               </mi>
               <mo id="S4.E9.m1.3.3.3.5.1" mathsize="90%">
                ¯
               </mo>
              </mover>
              <mo id="S4.E9.m1.3.3.3.4" lspace="0em" rspace="0em">
               ​
              </mo>
              <mrow id="S4.E9.m1.2.2.2.2.1">
               <mo id="S4.E9.m1.2.2.2.2.1.2" maxsize="90%" minsize="90%">
                (
               </mo>
               <mrow id="S4.E9.m1.2.2.2.2.1.1">
                <msubsup id="S4.E9.m1.2.2.2.2.1.1.4">
                 <mi id="S4.E9.m1.2.2.2.2.1.1.4.2.2" mathsize="90%">
                  w
                 </mi>
                 <mi id="S4.E9.m1.2.2.2.2.1.1.4.2.3" mathsize="90%">
                  t
                 </mi>
                 <mi id="S4.E9.m1.2.2.2.2.1.1.4.3" mathsize="90%">
                  j
                 </mi>
                </msubsup>
                <mo fence="false" id="S4.E9.m1.2.2.2.2.1.1.3" mathsize="90%">
                 |
                </mo>
                <mrow id="S4.E9.m1.2.2.2.2.1.1.2.2">
                 <msub id="S4.E9.m1.2.2.2.2.1.1.1.1.1">
                  <mi id="S4.E9.m1.2.2.2.2.1.1.1.1.1.2" mathsize="90%">
                   s
                  </mi>
                  <mi id="S4.E9.m1.2.2.2.2.1.1.1.1.1.3" mathsize="90%">
                   t
                  </mi>
                 </msub>
                 <mo id="S4.E9.m1.2.2.2.2.1.1.2.2.3" mathsize="90%">
                  ,
                 </mo>
                 <msubsup id="S4.E9.m1.2.2.2.2.1.1.2.2.2">
                  <mi id="S4.E9.m1.2.2.2.2.1.1.2.2.2.2.2" mathsize="90%">
                   w
                  </mi>
                  <mi id="S4.E9.m1.2.2.2.2.1.1.2.2.2.2.3" mathsize="90%">
                   t
                  </mi>
                  <mrow id="S4.E9.m1.2.2.2.2.1.1.2.2.2.3">
                   <mn id="S4.E9.m1.2.2.2.2.1.1.2.2.2.3.2" mathsize="90%">
                    1
                   </mn>
                   <mo id="S4.E9.m1.2.2.2.2.1.1.2.2.2.3.1" lspace="0.278em" mathsize="90%" rspace="0.278em">
                    :
                   </mo>
                   <mrow id="S4.E9.m1.2.2.2.2.1.1.2.2.2.3.3">
                    <mi id="S4.E9.m1.2.2.2.2.1.1.2.2.2.3.3.2" mathsize="90%">
                     j
                    </mi>
                    <mo id="S4.E9.m1.2.2.2.2.1.1.2.2.2.3.3.1" mathsize="90%">
                     −
                    </mo>
                    <mn id="S4.E9.m1.2.2.2.2.1.1.2.2.2.3.3.3" mathsize="90%">
                     1
                    </mn>
                   </mrow>
                  </mrow>
                 </msubsup>
                </mrow>
               </mrow>
               <mo id="S4.E9.m1.2.2.2.2.1.3" maxsize="90%" minsize="90%">
                )
               </mo>
              </mrow>
              <mo id="S4.E9.m1.3.3.3.4a" lspace="0.167em" rspace="0em">
               ​
              </mo>
              <mrow id="S4.E9.m1.3.3.3.3.1">
               <mi id="S4.E9.m1.1.1.1.1" mathsize="90%">
                exp
               </mi>
               <mo id="S4.E9.m1.3.3.3.3.1a">
                ⁡
               </mo>
               <mrow id="S4.E9.m1.3.3.3.3.1.1">
                <mo id="S4.E9.m1.3.3.3.3.1.1.2" maxsize="90%" minsize="90%">
                 (
                </mo>
                <mrow id="S4.E9.m1.3.3.3.3.1.1.1">
                 <mrow id="S4.E9.m1.3.3.3.3.1.1.1.3">
                  <mi id="S4.E9.m1.3.3.3.3.1.1.1.3.5" mathsize="90%">
                   Q
                  </mi>
                  <mo id="S4.E9.m1.3.3.3.3.1.1.1.3.4" lspace="0em" rspace="0em">
                   ​
                  </mo>
                  <mrow id="S4.E9.m1.3.3.3.3.1.1.1.3.3.3">
                   <mo id="S4.E9.m1.3.3.3.3.1.1.1.3.3.3.4" maxsize="90%" minsize="90%">
                    (
                   </mo>
                   <msub id="S4.E9.m1.3.3.3.3.1.1.1.1.1.1.1">
                    <mi id="S4.E9.m1.3.3.3.3.1.1.1.1.1.1.1.2" mathsize="90%">
                     s
                    </mi>
                    <mi id="S4.E9.m1.3.3.3.3.1.1.1.1.1.1.1.3" mathsize="90%">
                     t
                    </mi>
                   </msub>
                   <mo id="S4.E9.m1.3.3.3.3.1.1.1.3.3.3.5" mathsize="90%">
                    ,
                   </mo>
                   <msubsup id="S4.E9.m1.3.3.3.3.1.1.1.2.2.2.2">
                    <mi id="S4.E9.m1.3.3.3.3.1.1.1.2.2.2.2.2.2" mathsize="90%">
                     w
                    </mi>
                    <mi id="S4.E9.m1.3.3.3.3.1.1.1.2.2.2.2.2.3" mathsize="90%">
                     t
                    </mi>
                    <mrow id="S4.E9.m1.3.3.3.3.1.1.1.2.2.2.2.3">
                     <mn id="S4.E9.m1.3.3.3.3.1.1.1.2.2.2.2.3.2" mathsize="90%">
                      1
                     </mn>
                     <mo id="S4.E9.m1.3.3.3.3.1.1.1.2.2.2.2.3.1" lspace="0.278em" mathsize="90%" rspace="0.278em">
                      :
                     </mo>
                     <mrow id="S4.E9.m1.3.3.3.3.1.1.1.2.2.2.2.3.3">
                      <mi id="S4.E9.m1.3.3.3.3.1.1.1.2.2.2.2.3.3.2" mathsize="90%">
                       j
                      </mi>
                      <mo id="S4.E9.m1.3.3.3.3.1.1.1.2.2.2.2.3.3.1" mathsize="90%">
                       −
                      </mo>
                      <mn id="S4.E9.m1.3.3.3.3.1.1.1.2.2.2.2.3.3.3" mathsize="90%">
                       1
                      </mn>
                     </mrow>
                    </mrow>
                   </msubsup>
                   <mo id="S4.E9.m1.3.3.3.3.1.1.1.3.3.3.6" mathsize="90%">
                    ,
                   </mo>
                   <msubsup id="S4.E9.m1.3.3.3.3.1.1.1.3.3.3.3">
                    <mi id="S4.E9.m1.3.3.3.3.1.1.1.3.3.3.3.2.2" mathsize="90%">
                     w
                    </mi>
                    <mi id="S4.E9.m1.3.3.3.3.1.1.1.3.3.3.3.2.3" mathsize="90%">
                     t
                    </mi>
                    <mi id="S4.E9.m1.3.3.3.3.1.1.1.3.3.3.3.3" mathsize="90%">
                     j
                    </mi>
                   </msubsup>
                   <mo id="S4.E9.m1.3.3.3.3.1.1.1.3.3.3.7" maxsize="90%" minsize="90%">
                    )
                   </mo>
                  </mrow>
                 </mrow>
                 <mo id="S4.E9.m1.3.3.3.3.1.1.1.4" maxsize="90%" minsize="90%" stretchy="true" symmetric="true">
                  /
                 </mo>
                 <mi id="S4.E9.m1.3.3.3.3.1.1.1.5" mathsize="90%">
                  β
                 </mi>
                </mrow>
                <mo id="S4.E9.m1.3.3.3.3.1.1.3" maxsize="90%" minsize="90%">
                 )
                </mo>
               </mrow>
              </mrow>
             </mrow>
             <mrow id="S4.E9.m1.5.5.5">
              <msub id="S4.E9.m1.5.5.5.4">
               <mi id="S4.E9.m1.5.5.5.4.2" mathsize="90%">
                𝔼
               </mi>
               <mrow id="S4.E9.m1.5.5.5.4.3">
                <msubsup id="S4.E9.m1.5.5.5.4.3.2">
                 <mover accent="true" id="S4.E9.m1.5.5.5.4.3.2.2.2">
                  <mi id="S4.E9.m1.5.5.5.4.3.2.2.2.2" mathsize="90%">
                   w
                  </mi>
                  <mo id="S4.E9.m1.5.5.5.4.3.2.2.2.1" mathsize="90%">
                   ¯
                  </mo>
                 </mover>
                 <mi id="S4.E9.m1.5.5.5.4.3.2.2.3" mathsize="90%">
                  t
                 </mi>
                 <mi id="S4.E9.m1.5.5.5.4.3.2.3" mathsize="90%">
                  j
                 </mi>
                </msubsup>
                <mo id="S4.E9.m1.5.5.5.4.3.1" mathsize="90%">
                 ∼
                </mo>
                <mover accent="true" id="S4.E9.m1.5.5.5.4.3.3">
                 <mi id="S4.E9.m1.5.5.5.4.3.3.2" mathsize="90%">
                  π
                 </mi>
                 <mo id="S4.E9.m1.5.5.5.4.3.3.1" mathsize="90%">
                  ¯
                 </mo>
                </mover>
               </mrow>
              </msub>
              <mo id="S4.E9.m1.5.5.5.3" lspace="0em" rspace="0em">
               ​
              </mo>
              <mrow id="S4.E9.m1.5.5.5.2.1">
               <mo id="S4.E9.m1.5.5.5.2.1.2" maxsize="90%" minsize="90%">
                [
               </mo>
               <mrow id="S4.E9.m1.5.5.5.2.1.1.1">
                <mi id="S4.E9.m1.4.4.4.1" mathsize="90%">
                 exp
                </mi>
                <mo id="S4.E9.m1.5.5.5.2.1.1.1a">
                 ⁡
                </mo>
                <mrow id="S4.E9.m1.5.5.5.2.1.1.1.1">
                 <mo id="S4.E9.m1.5.5.5.2.1.1.1.1.2" maxsize="90%" minsize="90%">
                  (
                 </mo>
                 <mrow id="S4.E9.m1.5.5.5.2.1.1.1.1.1">
                  <mrow id="S4.E9.m1.5.5.5.2.1.1.1.1.1.3">
                   <mi id="S4.E9.m1.5.5.5.2.1.1.1.1.1.3.5" mathsize="90%">
                    Q
                   </mi>
                   <mo id="S4.E9.m1.5.5.5.2.1.1.1.1.1.3.4" lspace="0em" rspace="0em">
                    ​
                   </mo>
                   <mrow id="S4.E9.m1.5.5.5.2.1.1.1.1.1.3.3.3">
                    <mo id="S4.E9.m1.5.5.5.2.1.1.1.1.1.3.3.3.4" maxsize="90%" minsize="90%">
                     (
                    </mo>
                    <msub id="S4.E9.m1.5.5.5.2.1.1.1.1.1.1.1.1.1">
                     <mi id="S4.E9.m1.5.5.5.2.1.1.1.1.1.1.1.1.1.2" mathsize="90%">
                      s
                     </mi>
                     <mi id="S4.E9.m1.5.5.5.2.1.1.1.1.1.1.1.1.1.3" mathsize="90%">
                      t
                     </mi>
                    </msub>
                    <mo id="S4.E9.m1.5.5.5.2.1.1.1.1.1.3.3.3.5" mathsize="90%">
                     ,
                    </mo>
                    <msubsup id="S4.E9.m1.5.5.5.2.1.1.1.1.1.2.2.2.2">
                     <mi id="S4.E9.m1.5.5.5.2.1.1.1.1.1.2.2.2.2.2.2" mathsize="90%">
                      w
                     </mi>
                     <mi id="S4.E9.m1.5.5.5.2.1.1.1.1.1.2.2.2.2.2.3" mathsize="90%">
                      t
                     </mi>
                     <mrow id="S4.E9.m1.5.5.5.2.1.1.1.1.1.2.2.2.2.3">
                      <mn id="S4.E9.m1.5.5.5.2.1.1.1.1.1.2.2.2.2.3.2" mathsize="90%">
                       1
                      </mn>
                      <mo id="S4.E9.m1.5.5.5.2.1.1.1.1.1.2.2.2.2.3.1" lspace="0.278em" mathsize="90%" rspace="0.278em">
                       :
                      </mo>
                      <mrow id="S4.E9.m1.5.5.5.2.1.1.1.1.1.2.2.2.2.3.3">
                       <mi id="S4.E9.m1.5.5.5.2.1.1.1.1.1.2.2.2.2.3.3.2" mathsize="90%">
                        j
                       </mi>
                       <mo id="S4.E9.m1.5.5.5.2.1.1.1.1.1.2.2.2.2.3.3.1" mathsize="90%">
                        −
                       </mo>
                       <mn id="S4.E9.m1.5.5.5.2.1.1.1.1.1.2.2.2.2.3.3.3" mathsize="90%">
                        1
                       </mn>
                      </mrow>
                     </mrow>
                    </msubsup>
                    <mo id="S4.E9.m1.5.5.5.2.1.1.1.1.1.3.3.3.6" mathsize="90%">
                     ,
                    </mo>
                    <msubsup id="S4.E9.m1.5.5.5.2.1.1.1.1.1.3.3.3.3">
                     <mover accent="true" id="S4.E9.m1.5.5.5.2.1.1.1.1.1.3.3.3.3.2.2">
                      <mi id="S4.E9.m1.5.5.5.2.1.1.1.1.1.3.3.3.3.2.2.2" mathsize="90%">
                       w
                      </mi>
                      <mo id="S4.E9.m1.5.5.5.2.1.1.1.1.1.3.3.3.3.2.2.1" mathsize="90%">
                       ¯
                      </mo>
                     </mover>
                     <mi id="S4.E9.m1.5.5.5.2.1.1.1.1.1.3.3.3.3.2.3" mathsize="90%">
                      t
                     </mi>
                     <mi id="S4.E9.m1.5.5.5.2.1.1.1.1.1.3.3.3.3.3" mathsize="90%">
                      j
                     </mi>
                    </msubsup>
                    <mo id="S4.E9.m1.5.5.5.2.1.1.1.1.1.3.3.3.7" maxsize="90%" minsize="90%">
                     )
                    </mo>
                   </mrow>
                  </mrow>
                  <mo id="S4.E9.m1.5.5.5.2.1.1.1.1.1.4" maxsize="90%" minsize="90%" stretchy="true" symmetric="true">
                   /
                  </mo>
                  <mi id="S4.E9.m1.5.5.5.2.1.1.1.1.1.5" mathsize="90%">
                   β
                  </mi>
                 </mrow>
                 <mo id="S4.E9.m1.5.5.5.2.1.1.1.1.3" maxsize="90%" minsize="90%">
                  )
                 </mo>
                </mrow>
               </mrow>
               <mo id="S4.E9.m1.5.5.5.2.1.3" maxsize="90%" minsize="90%">
                ]
               </mo>
              </mrow>
             </mrow>
            </mfrac>
           </mstyle>
           <mo id="S4.E9.m1.5.9" lspace="0em" mathsize="90%">
            .
           </mo>
          </mrow>
          <annotation encoding="application/x-tex" id="S4.E9.m1.5c">
           \displaystyle\pi^{*}(\cdot|s_{t},w_{t}^{1:j-1})=\frac{\bar{\pi}(w_{t}^{j}|s_{t},w_{t}^{1:j-1})\exp(Q(s_{t},w_{t}^{1:j-1},w_{t}^{j})/\beta)}{\mathbb{E}_{\bar{w}_{t}^{j}\sim\bar{\pi}}[\exp(Q(s_{t},w_{t}^{1:j-1},\bar{w}_{t}^{j})/\beta)]}.
          </annotation>
         </semantics>
        </math>
       </td>
       <td class="ltx_eqn_cell ltx_eqn_center_padright">
       </td>
       <td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1">
        <span class="ltx_tag ltx_tag_equation ltx_align_right">
         (9)
        </span>
       </td>
      </tr>
     </tbody>
    </table>
    <p class="ltx_p" id="S4.SS2.p1.6">
     Since
     <math alttext="\bar{\pi}(w_{t}^{j}|s_{t},w_{t}^{1:j-1})/\mathbb{E}_{\bar{w}_{t}^{j}\sim\bar{\pi}}[\exp(Q(s_{t},w_{t}^{1:j-1},\bar{w}_{t}^{j})/\beta)]" class="ltx_Math" display="inline" id="S4.SS2.p1.2.m1.3">
      <semantics id="S4.SS2.p1.2.m1.3a">
       <mrow id="S4.SS2.p1.2.m1.3.3" xref="S4.SS2.p1.2.m1.3.3.cmml">
        <mrow id="S4.SS2.p1.2.m1.2.2.1" xref="S4.SS2.p1.2.m1.2.2.1.cmml">
         <mrow id="S4.SS2.p1.2.m1.2.2.1.1" xref="S4.SS2.p1.2.m1.2.2.1.1.cmml">
          <mover accent="true" id="S4.SS2.p1.2.m1.2.2.1.1.3" xref="S4.SS2.p1.2.m1.2.2.1.1.3.cmml">
           <mi id="S4.SS2.p1.2.m1.2.2.1.1.3.2" xref="S4.SS2.p1.2.m1.2.2.1.1.3.2.cmml">
            π
           </mi>
           <mo id="S4.SS2.p1.2.m1.2.2.1.1.3.1" xref="S4.SS2.p1.2.m1.2.2.1.1.3.1.cmml">
            ¯
           </mo>
          </mover>
          <mo id="S4.SS2.p1.2.m1.2.2.1.1.2" lspace="0em" rspace="0em" xref="S4.SS2.p1.2.m1.2.2.1.1.2.cmml">
           ​
          </mo>
          <mrow id="S4.SS2.p1.2.m1.2.2.1.1.1.1" xref="S4.SS2.p1.2.m1.2.2.1.1.1.1.1.cmml">
           <mo id="S4.SS2.p1.2.m1.2.2.1.1.1.1.2" stretchy="false" xref="S4.SS2.p1.2.m1.2.2.1.1.1.1.1.cmml">
            (
           </mo>
           <mrow id="S4.SS2.p1.2.m1.2.2.1.1.1.1.1" xref="S4.SS2.p1.2.m1.2.2.1.1.1.1.1.cmml">
            <msubsup id="S4.SS2.p1.2.m1.2.2.1.1.1.1.1.4" xref="S4.SS2.p1.2.m1.2.2.1.1.1.1.1.4.cmml">
             <mi id="S4.SS2.p1.2.m1.2.2.1.1.1.1.1.4.2.2" xref="S4.SS2.p1.2.m1.2.2.1.1.1.1.1.4.2.2.cmml">
              w
             </mi>
             <mi id="S4.SS2.p1.2.m1.2.2.1.1.1.1.1.4.2.3" xref="S4.SS2.p1.2.m1.2.2.1.1.1.1.1.4.2.3.cmml">
              t
             </mi>
             <mi id="S4.SS2.p1.2.m1.2.2.1.1.1.1.1.4.3" xref="S4.SS2.p1.2.m1.2.2.1.1.1.1.1.4.3.cmml">
              j
             </mi>
            </msubsup>
            <mo fence="false" id="S4.SS2.p1.2.m1.2.2.1.1.1.1.1.3" xref="S4.SS2.p1.2.m1.2.2.1.1.1.1.1.3.cmml">
             |
            </mo>
            <mrow id="S4.SS2.p1.2.m1.2.2.1.1.1.1.1.2.2" xref="S4.SS2.p1.2.m1.2.2.1.1.1.1.1.2.3.cmml">
             <msub id="S4.SS2.p1.2.m1.2.2.1.1.1.1.1.1.1.1" xref="S4.SS2.p1.2.m1.2.2.1.1.1.1.1.1.1.1.cmml">
              <mi id="S4.SS2.p1.2.m1.2.2.1.1.1.1.1.1.1.1.2" xref="S4.SS2.p1.2.m1.2.2.1.1.1.1.1.1.1.1.2.cmml">
               s
              </mi>
              <mi id="S4.SS2.p1.2.m1.2.2.1.1.1.1.1.1.1.1.3" xref="S4.SS2.p1.2.m1.2.2.1.1.1.1.1.1.1.1.3.cmml">
               t
              </mi>
             </msub>
             <mo id="S4.SS2.p1.2.m1.2.2.1.1.1.1.1.2.2.3" xref="S4.SS2.p1.2.m1.2.2.1.1.1.1.1.2.3.cmml">
              ,
             </mo>
             <msubsup id="S4.SS2.p1.2.m1.2.2.1.1.1.1.1.2.2.2" xref="S4.SS2.p1.2.m1.2.2.1.1.1.1.1.2.2.2.cmml">
              <mi id="S4.SS2.p1.2.m1.2.2.1.1.1.1.1.2.2.2.2.2" xref="S4.SS2.p1.2.m1.2.2.1.1.1.1.1.2.2.2.2.2.cmml">
               w
              </mi>
              <mi id="S4.SS2.p1.2.m1.2.2.1.1.1.1.1.2.2.2.2.3" xref="S4.SS2.p1.2.m1.2.2.1.1.1.1.1.2.2.2.2.3.cmml">
               t
              </mi>
              <mrow id="S4.SS2.p1.2.m1.2.2.1.1.1.1.1.2.2.2.3" xref="S4.SS2.p1.2.m1.2.2.1.1.1.1.1.2.2.2.3.cmml">
               <mn id="S4.SS2.p1.2.m1.2.2.1.1.1.1.1.2.2.2.3.2" xref="S4.SS2.p1.2.m1.2.2.1.1.1.1.1.2.2.2.3.2.cmml">
                1
               </mn>
               <mo id="S4.SS2.p1.2.m1.2.2.1.1.1.1.1.2.2.2.3.1" lspace="0.278em" rspace="0.278em" xref="S4.SS2.p1.2.m1.2.2.1.1.1.1.1.2.2.2.3.1.cmml">
                :
               </mo>
               <mrow id="S4.SS2.p1.2.m1.2.2.1.1.1.1.1.2.2.2.3.3" xref="S4.SS2.p1.2.m1.2.2.1.1.1.1.1.2.2.2.3.3.cmml">
                <mi id="S4.SS2.p1.2.m1.2.2.1.1.1.1.1.2.2.2.3.3.2" xref="S4.SS2.p1.2.m1.2.2.1.1.1.1.1.2.2.2.3.3.2.cmml">
                 j
                </mi>
                <mo id="S4.SS2.p1.2.m1.2.2.1.1.1.1.1.2.2.2.3.3.1" xref="S4.SS2.p1.2.m1.2.2.1.1.1.1.1.2.2.2.3.3.1.cmml">
                 −
                </mo>
                <mn id="S4.SS2.p1.2.m1.2.2.1.1.1.1.1.2.2.2.3.3.3" xref="S4.SS2.p1.2.m1.2.2.1.1.1.1.1.2.2.2.3.3.3.cmml">
                 1
                </mn>
               </mrow>
              </mrow>
             </msubsup>
            </mrow>
           </mrow>
           <mo id="S4.SS2.p1.2.m1.2.2.1.1.1.1.3" stretchy="false" xref="S4.SS2.p1.2.m1.2.2.1.1.1.1.1.cmml">
            )
           </mo>
          </mrow>
         </mrow>
         <mo id="S4.SS2.p1.2.m1.2.2.1.2" xref="S4.SS2.p1.2.m1.2.2.1.2.cmml">
          /
         </mo>
         <msub id="S4.SS2.p1.2.m1.2.2.1.3" xref="S4.SS2.p1.2.m1.2.2.1.3.cmml">
          <mi id="S4.SS2.p1.2.m1.2.2.1.3.2" xref="S4.SS2.p1.2.m1.2.2.1.3.2.cmml">
           𝔼
          </mi>
          <mrow id="S4.SS2.p1.2.m1.2.2.1.3.3" xref="S4.SS2.p1.2.m1.2.2.1.3.3.cmml">
           <msubsup id="S4.SS2.p1.2.m1.2.2.1.3.3.2" xref="S4.SS2.p1.2.m1.2.2.1.3.3.2.cmml">
            <mover accent="true" id="S4.SS2.p1.2.m1.2.2.1.3.3.2.2.2" xref="S4.SS2.p1.2.m1.2.2.1.3.3.2.2.2.cmml">
             <mi id="S4.SS2.p1.2.m1.2.2.1.3.3.2.2.2.2" xref="S4.SS2.p1.2.m1.2.2.1.3.3.2.2.2.2.cmml">
              w
             </mi>
             <mo id="S4.SS2.p1.2.m1.2.2.1.3.3.2.2.2.1" xref="S4.SS2.p1.2.m1.2.2.1.3.3.2.2.2.1.cmml">
              ¯
             </mo>
            </mover>
            <mi id="S4.SS2.p1.2.m1.2.2.1.3.3.2.2.3" xref="S4.SS2.p1.2.m1.2.2.1.3.3.2.2.3.cmml">
             t
            </mi>
            <mi id="S4.SS2.p1.2.m1.2.2.1.3.3.2.3" xref="S4.SS2.p1.2.m1.2.2.1.3.3.2.3.cmml">
             j
            </mi>
           </msubsup>
           <mo id="S4.SS2.p1.2.m1.2.2.1.3.3.1" xref="S4.SS2.p1.2.m1.2.2.1.3.3.1.cmml">
            ∼
           </mo>
           <mover accent="true" id="S4.SS2.p1.2.m1.2.2.1.3.3.3" xref="S4.SS2.p1.2.m1.2.2.1.3.3.3.cmml">
            <mi id="S4.SS2.p1.2.m1.2.2.1.3.3.3.2" xref="S4.SS2.p1.2.m1.2.2.1.3.3.3.2.cmml">
             π
            </mi>
            <mo id="S4.SS2.p1.2.m1.2.2.1.3.3.3.1" xref="S4.SS2.p1.2.m1.2.2.1.3.3.3.1.cmml">
             ¯
            </mo>
           </mover>
          </mrow>
         </msub>
        </mrow>
        <mo id="S4.SS2.p1.2.m1.3.3.3" lspace="0em" rspace="0em" xref="S4.SS2.p1.2.m1.3.3.3.cmml">
         ​
        </mo>
        <mrow id="S4.SS2.p1.2.m1.3.3.2.1" xref="S4.SS2.p1.2.m1.3.3.2.2.cmml">
         <mo id="S4.SS2.p1.2.m1.3.3.2.1.2" stretchy="false" xref="S4.SS2.p1.2.m1.3.3.2.2.1.cmml">
          [
         </mo>
         <mrow id="S4.SS2.p1.2.m1.3.3.2.1.1.1" xref="S4.SS2.p1.2.m1.3.3.2.1.1.2.cmml">
          <mi id="S4.SS2.p1.2.m1.1.1" xref="S4.SS2.p1.2.m1.1.1.cmml">
           exp
          </mi>
          <mo id="S4.SS2.p1.2.m1.3.3.2.1.1.1a" xref="S4.SS2.p1.2.m1.3.3.2.1.1.2.cmml">
           ⁡
          </mo>
          <mrow id="S4.SS2.p1.2.m1.3.3.2.1.1.1.1" xref="S4.SS2.p1.2.m1.3.3.2.1.1.2.cmml">
           <mo id="S4.SS2.p1.2.m1.3.3.2.1.1.1.1.2" stretchy="false" xref="S4.SS2.p1.2.m1.3.3.2.1.1.2.cmml">
            (
           </mo>
           <mrow id="S4.SS2.p1.2.m1.3.3.2.1.1.1.1.1" xref="S4.SS2.p1.2.m1.3.3.2.1.1.1.1.1.cmml">
            <mrow id="S4.SS2.p1.2.m1.3.3.2.1.1.1.1.1.3" xref="S4.SS2.p1.2.m1.3.3.2.1.1.1.1.1.3.cmml">
             <mi id="S4.SS2.p1.2.m1.3.3.2.1.1.1.1.1.3.5" xref="S4.SS2.p1.2.m1.3.3.2.1.1.1.1.1.3.5.cmml">
              Q
             </mi>
             <mo id="S4.SS2.p1.2.m1.3.3.2.1.1.1.1.1.3.4" lspace="0em" rspace="0em" xref="S4.SS2.p1.2.m1.3.3.2.1.1.1.1.1.3.4.cmml">
              ​
             </mo>
             <mrow id="S4.SS2.p1.2.m1.3.3.2.1.1.1.1.1.3.3.3" xref="S4.SS2.p1.2.m1.3.3.2.1.1.1.1.1.3.3.4.cmml">
              <mo id="S4.SS2.p1.2.m1.3.3.2.1.1.1.1.1.3.3.3.4" stretchy="false" xref="S4.SS2.p1.2.m1.3.3.2.1.1.1.1.1.3.3.4.cmml">
               (
              </mo>
              <msub id="S4.SS2.p1.2.m1.3.3.2.1.1.1.1.1.1.1.1.1" xref="S4.SS2.p1.2.m1.3.3.2.1.1.1.1.1.1.1.1.1.cmml">
               <mi id="S4.SS2.p1.2.m1.3.3.2.1.1.1.1.1.1.1.1.1.2" xref="S4.SS2.p1.2.m1.3.3.2.1.1.1.1.1.1.1.1.1.2.cmml">
                s
               </mi>
               <mi id="S4.SS2.p1.2.m1.3.3.2.1.1.1.1.1.1.1.1.1.3" xref="S4.SS2.p1.2.m1.3.3.2.1.1.1.1.1.1.1.1.1.3.cmml">
                t
               </mi>
              </msub>
              <mo id="S4.SS2.p1.2.m1.3.3.2.1.1.1.1.1.3.3.3.5" xref="S4.SS2.p1.2.m1.3.3.2.1.1.1.1.1.3.3.4.cmml">
               ,
              </mo>
              <msubsup id="S4.SS2.p1.2.m1.3.3.2.1.1.1.1.1.2.2.2.2" xref="S4.SS2.p1.2.m1.3.3.2.1.1.1.1.1.2.2.2.2.cmml">
               <mi id="S4.SS2.p1.2.m1.3.3.2.1.1.1.1.1.2.2.2.2.2.2" xref="S4.SS2.p1.2.m1.3.3.2.1.1.1.1.1.2.2.2.2.2.2.cmml">
                w
               </mi>
               <mi id="S4.SS2.p1.2.m1.3.3.2.1.1.1.1.1.2.2.2.2.2.3" xref="S4.SS2.p1.2.m1.3.3.2.1.1.1.1.1.2.2.2.2.2.3.cmml">
                t
               </mi>
               <mrow id="S4.SS2.p1.2.m1.3.3.2.1.1.1.1.1.2.2.2.2.3" xref="S4.SS2.p1.2.m1.3.3.2.1.1.1.1.1.2.2.2.2.3.cmml">
                <mn id="S4.SS2.p1.2.m1.3.3.2.1.1.1.1.1.2.2.2.2.3.2" xref="S4.SS2.p1.2.m1.3.3.2.1.1.1.1.1.2.2.2.2.3.2.cmml">
                 1
                </mn>
                <mo id="S4.SS2.p1.2.m1.3.3.2.1.1.1.1.1.2.2.2.2.3.1" lspace="0.278em" rspace="0.278em" xref="S4.SS2.p1.2.m1.3.3.2.1.1.1.1.1.2.2.2.2.3.1.cmml">
                 :
                </mo>
                <mrow id="S4.SS2.p1.2.m1.3.3.2.1.1.1.1.1.2.2.2.2.3.3" xref="S4.SS2.p1.2.m1.3.3.2.1.1.1.1.1.2.2.2.2.3.3.cmml">
                 <mi id="S4.SS2.p1.2.m1.3.3.2.1.1.1.1.1.2.2.2.2.3.3.2" xref="S4.SS2.p1.2.m1.3.3.2.1.1.1.1.1.2.2.2.2.3.3.2.cmml">
                  j
                 </mi>
                 <mo id="S4.SS2.p1.2.m1.3.3.2.1.1.1.1.1.2.2.2.2.3.3.1" xref="S4.SS2.p1.2.m1.3.3.2.1.1.1.1.1.2.2.2.2.3.3.1.cmml">
                  −
                 </mo>
                 <mn id="S4.SS2.p1.2.m1.3.3.2.1.1.1.1.1.2.2.2.2.3.3.3" xref="S4.SS2.p1.2.m1.3.3.2.1.1.1.1.1.2.2.2.2.3.3.3.cmml">
                  1
                 </mn>
                </mrow>
               </mrow>
              </msubsup>
              <mo id="S4.SS2.p1.2.m1.3.3.2.1.1.1.1.1.3.3.3.6" xref="S4.SS2.p1.2.m1.3.3.2.1.1.1.1.1.3.3.4.cmml">
               ,
              </mo>
              <msubsup id="S4.SS2.p1.2.m1.3.3.2.1.1.1.1.1.3.3.3.3" xref="S4.SS2.p1.2.m1.3.3.2.1.1.1.1.1.3.3.3.3.cmml">
               <mover accent="true" id="S4.SS2.p1.2.m1.3.3.2.1.1.1.1.1.3.3.3.3.2.2" xref="S4.SS2.p1.2.m1.3.3.2.1.1.1.1.1.3.3.3.3.2.2.cmml">
                <mi id="S4.SS2.p1.2.m1.3.3.2.1.1.1.1.1.3.3.3.3.2.2.2" xref="S4.SS2.p1.2.m1.3.3.2.1.1.1.1.1.3.3.3.3.2.2.2.cmml">
                 w
                </mi>
                <mo id="S4.SS2.p1.2.m1.3.3.2.1.1.1.1.1.3.3.3.3.2.2.1" xref="S4.SS2.p1.2.m1.3.3.2.1.1.1.1.1.3.3.3.3.2.2.1.cmml">
                 ¯
                </mo>
               </mover>
               <mi id="S4.SS2.p1.2.m1.3.3.2.1.1.1.1.1.3.3.3.3.2.3" xref="S4.SS2.p1.2.m1.3.3.2.1.1.1.1.1.3.3.3.3.2.3.cmml">
                t
               </mi>
               <mi id="S4.SS2.p1.2.m1.3.3.2.1.1.1.1.1.3.3.3.3.3" xref="S4.SS2.p1.2.m1.3.3.2.1.1.1.1.1.3.3.3.3.3.cmml">
                j
               </mi>
              </msubsup>
              <mo id="S4.SS2.p1.2.m1.3.3.2.1.1.1.1.1.3.3.3.7" stretchy="false" xref="S4.SS2.p1.2.m1.3.3.2.1.1.1.1.1.3.3.4.cmml">
               )
              </mo>
             </mrow>
            </mrow>
            <mo id="S4.SS2.p1.2.m1.3.3.2.1.1.1.1.1.4" xref="S4.SS2.p1.2.m1.3.3.2.1.1.1.1.1.4.cmml">
             /
            </mo>
            <mi id="S4.SS2.p1.2.m1.3.3.2.1.1.1.1.1.5" xref="S4.SS2.p1.2.m1.3.3.2.1.1.1.1.1.5.cmml">
             β
            </mi>
           </mrow>
           <mo id="S4.SS2.p1.2.m1.3.3.2.1.1.1.1.3" stretchy="false" xref="S4.SS2.p1.2.m1.3.3.2.1.1.2.cmml">
            )
           </mo>
          </mrow>
         </mrow>
         <mo id="S4.SS2.p1.2.m1.3.3.2.1.3" stretchy="false" xref="S4.SS2.p1.2.m1.3.3.2.2.1.cmml">
          ]
         </mo>
        </mrow>
       </mrow>
       <annotation-xml encoding="MathML-Content" id="S4.SS2.p1.2.m1.3b">
        <apply id="S4.SS2.p1.2.m1.3.3.cmml" xref="S4.SS2.p1.2.m1.3.3">
         <times id="S4.SS2.p1.2.m1.3.3.3.cmml" xref="S4.SS2.p1.2.m1.3.3.3">
         </times>
         <apply id="S4.SS2.p1.2.m1.2.2.1.cmml" xref="S4.SS2.p1.2.m1.2.2.1">
          <divide id="S4.SS2.p1.2.m1.2.2.1.2.cmml" xref="S4.SS2.p1.2.m1.2.2.1.2">
          </divide>
          <apply id="S4.SS2.p1.2.m1.2.2.1.1.cmml" xref="S4.SS2.p1.2.m1.2.2.1.1">
           <times id="S4.SS2.p1.2.m1.2.2.1.1.2.cmml" xref="S4.SS2.p1.2.m1.2.2.1.1.2">
           </times>
           <apply id="S4.SS2.p1.2.m1.2.2.1.1.3.cmml" xref="S4.SS2.p1.2.m1.2.2.1.1.3">
            <ci id="S4.SS2.p1.2.m1.2.2.1.1.3.1.cmml" xref="S4.SS2.p1.2.m1.2.2.1.1.3.1">
             ¯
            </ci>
            <ci id="S4.SS2.p1.2.m1.2.2.1.1.3.2.cmml" xref="S4.SS2.p1.2.m1.2.2.1.1.3.2">
             𝜋
            </ci>
           </apply>
           <apply id="S4.SS2.p1.2.m1.2.2.1.1.1.1.1.cmml" xref="S4.SS2.p1.2.m1.2.2.1.1.1.1">
            <csymbol cd="latexml" id="S4.SS2.p1.2.m1.2.2.1.1.1.1.1.3.cmml" xref="S4.SS2.p1.2.m1.2.2.1.1.1.1.1.3">
             conditional
            </csymbol>
            <apply id="S4.SS2.p1.2.m1.2.2.1.1.1.1.1.4.cmml" xref="S4.SS2.p1.2.m1.2.2.1.1.1.1.1.4">
             <csymbol cd="ambiguous" id="S4.SS2.p1.2.m1.2.2.1.1.1.1.1.4.1.cmml" xref="S4.SS2.p1.2.m1.2.2.1.1.1.1.1.4">
              superscript
             </csymbol>
             <apply id="S4.SS2.p1.2.m1.2.2.1.1.1.1.1.4.2.cmml" xref="S4.SS2.p1.2.m1.2.2.1.1.1.1.1.4">
              <csymbol cd="ambiguous" id="S4.SS2.p1.2.m1.2.2.1.1.1.1.1.4.2.1.cmml" xref="S4.SS2.p1.2.m1.2.2.1.1.1.1.1.4">
               subscript
              </csymbol>
              <ci id="S4.SS2.p1.2.m1.2.2.1.1.1.1.1.4.2.2.cmml" xref="S4.SS2.p1.2.m1.2.2.1.1.1.1.1.4.2.2">
               𝑤
              </ci>
              <ci id="S4.SS2.p1.2.m1.2.2.1.1.1.1.1.4.2.3.cmml" xref="S4.SS2.p1.2.m1.2.2.1.1.1.1.1.4.2.3">
               𝑡
              </ci>
             </apply>
             <ci id="S4.SS2.p1.2.m1.2.2.1.1.1.1.1.4.3.cmml" xref="S4.SS2.p1.2.m1.2.2.1.1.1.1.1.4.3">
              𝑗
             </ci>
            </apply>
            <list id="S4.SS2.p1.2.m1.2.2.1.1.1.1.1.2.3.cmml" xref="S4.SS2.p1.2.m1.2.2.1.1.1.1.1.2.2">
             <apply id="S4.SS2.p1.2.m1.2.2.1.1.1.1.1.1.1.1.cmml" xref="S4.SS2.p1.2.m1.2.2.1.1.1.1.1.1.1.1">
              <csymbol cd="ambiguous" id="S4.SS2.p1.2.m1.2.2.1.1.1.1.1.1.1.1.1.cmml" xref="S4.SS2.p1.2.m1.2.2.1.1.1.1.1.1.1.1">
               subscript
              </csymbol>
              <ci id="S4.SS2.p1.2.m1.2.2.1.1.1.1.1.1.1.1.2.cmml" xref="S4.SS2.p1.2.m1.2.2.1.1.1.1.1.1.1.1.2">
               𝑠
              </ci>
              <ci id="S4.SS2.p1.2.m1.2.2.1.1.1.1.1.1.1.1.3.cmml" xref="S4.SS2.p1.2.m1.2.2.1.1.1.1.1.1.1.1.3">
               𝑡
              </ci>
             </apply>
             <apply id="S4.SS2.p1.2.m1.2.2.1.1.1.1.1.2.2.2.cmml" xref="S4.SS2.p1.2.m1.2.2.1.1.1.1.1.2.2.2">
              <csymbol cd="ambiguous" id="S4.SS2.p1.2.m1.2.2.1.1.1.1.1.2.2.2.1.cmml" xref="S4.SS2.p1.2.m1.2.2.1.1.1.1.1.2.2.2">
               superscript
              </csymbol>
              <apply id="S4.SS2.p1.2.m1.2.2.1.1.1.1.1.2.2.2.2.cmml" xref="S4.SS2.p1.2.m1.2.2.1.1.1.1.1.2.2.2">
               <csymbol cd="ambiguous" id="S4.SS2.p1.2.m1.2.2.1.1.1.1.1.2.2.2.2.1.cmml" xref="S4.SS2.p1.2.m1.2.2.1.1.1.1.1.2.2.2">
                subscript
               </csymbol>
               <ci id="S4.SS2.p1.2.m1.2.2.1.1.1.1.1.2.2.2.2.2.cmml" xref="S4.SS2.p1.2.m1.2.2.1.1.1.1.1.2.2.2.2.2">
                𝑤
               </ci>
               <ci id="S4.SS2.p1.2.m1.2.2.1.1.1.1.1.2.2.2.2.3.cmml" xref="S4.SS2.p1.2.m1.2.2.1.1.1.1.1.2.2.2.2.3">
                𝑡
               </ci>
              </apply>
              <apply id="S4.SS2.p1.2.m1.2.2.1.1.1.1.1.2.2.2.3.cmml" xref="S4.SS2.p1.2.m1.2.2.1.1.1.1.1.2.2.2.3">
               <ci id="S4.SS2.p1.2.m1.2.2.1.1.1.1.1.2.2.2.3.1.cmml" xref="S4.SS2.p1.2.m1.2.2.1.1.1.1.1.2.2.2.3.1">
                :
               </ci>
               <cn id="S4.SS2.p1.2.m1.2.2.1.1.1.1.1.2.2.2.3.2.cmml" type="integer" xref="S4.SS2.p1.2.m1.2.2.1.1.1.1.1.2.2.2.3.2">
                1
               </cn>
               <apply id="S4.SS2.p1.2.m1.2.2.1.1.1.1.1.2.2.2.3.3.cmml" xref="S4.SS2.p1.2.m1.2.2.1.1.1.1.1.2.2.2.3.3">
                <minus id="S4.SS2.p1.2.m1.2.2.1.1.1.1.1.2.2.2.3.3.1.cmml" xref="S4.SS2.p1.2.m1.2.2.1.1.1.1.1.2.2.2.3.3.1">
                </minus>
                <ci id="S4.SS2.p1.2.m1.2.2.1.1.1.1.1.2.2.2.3.3.2.cmml" xref="S4.SS2.p1.2.m1.2.2.1.1.1.1.1.2.2.2.3.3.2">
                 𝑗
                </ci>
                <cn id="S4.SS2.p1.2.m1.2.2.1.1.1.1.1.2.2.2.3.3.3.cmml" type="integer" xref="S4.SS2.p1.2.m1.2.2.1.1.1.1.1.2.2.2.3.3.3">
                 1
                </cn>
               </apply>
              </apply>
             </apply>
            </list>
           </apply>
          </apply>
          <apply id="S4.SS2.p1.2.m1.2.2.1.3.cmml" xref="S4.SS2.p1.2.m1.2.2.1.3">
           <csymbol cd="ambiguous" id="S4.SS2.p1.2.m1.2.2.1.3.1.cmml" xref="S4.SS2.p1.2.m1.2.2.1.3">
            subscript
           </csymbol>
           <ci id="S4.SS2.p1.2.m1.2.2.1.3.2.cmml" xref="S4.SS2.p1.2.m1.2.2.1.3.2">
            𝔼
           </ci>
           <apply id="S4.SS2.p1.2.m1.2.2.1.3.3.cmml" xref="S4.SS2.p1.2.m1.2.2.1.3.3">
            <csymbol cd="latexml" id="S4.SS2.p1.2.m1.2.2.1.3.3.1.cmml" xref="S4.SS2.p1.2.m1.2.2.1.3.3.1">
             similar-to
            </csymbol>
            <apply id="S4.SS2.p1.2.m1.2.2.1.3.3.2.cmml" xref="S4.SS2.p1.2.m1.2.2.1.3.3.2">
             <csymbol cd="ambiguous" id="S4.SS2.p1.2.m1.2.2.1.3.3.2.1.cmml" xref="S4.SS2.p1.2.m1.2.2.1.3.3.2">
              superscript
             </csymbol>
             <apply id="S4.SS2.p1.2.m1.2.2.1.3.3.2.2.cmml" xref="S4.SS2.p1.2.m1.2.2.1.3.3.2">
              <csymbol cd="ambiguous" id="S4.SS2.p1.2.m1.2.2.1.3.3.2.2.1.cmml" xref="S4.SS2.p1.2.m1.2.2.1.3.3.2">
               subscript
              </csymbol>
              <apply id="S4.SS2.p1.2.m1.2.2.1.3.3.2.2.2.cmml" xref="S4.SS2.p1.2.m1.2.2.1.3.3.2.2.2">
               <ci id="S4.SS2.p1.2.m1.2.2.1.3.3.2.2.2.1.cmml" xref="S4.SS2.p1.2.m1.2.2.1.3.3.2.2.2.1">
                ¯
               </ci>
               <ci id="S4.SS2.p1.2.m1.2.2.1.3.3.2.2.2.2.cmml" xref="S4.SS2.p1.2.m1.2.2.1.3.3.2.2.2.2">
                𝑤
               </ci>
              </apply>
              <ci id="S4.SS2.p1.2.m1.2.2.1.3.3.2.2.3.cmml" xref="S4.SS2.p1.2.m1.2.2.1.3.3.2.2.3">
               𝑡
              </ci>
             </apply>
             <ci id="S4.SS2.p1.2.m1.2.2.1.3.3.2.3.cmml" xref="S4.SS2.p1.2.m1.2.2.1.3.3.2.3">
              𝑗
             </ci>
            </apply>
            <apply id="S4.SS2.p1.2.m1.2.2.1.3.3.3.cmml" xref="S4.SS2.p1.2.m1.2.2.1.3.3.3">
             <ci id="S4.SS2.p1.2.m1.2.2.1.3.3.3.1.cmml" xref="S4.SS2.p1.2.m1.2.2.1.3.3.3.1">
              ¯
             </ci>
             <ci id="S4.SS2.p1.2.m1.2.2.1.3.3.3.2.cmml" xref="S4.SS2.p1.2.m1.2.2.1.3.3.3.2">
              𝜋
             </ci>
            </apply>
           </apply>
          </apply>
         </apply>
         <apply id="S4.SS2.p1.2.m1.3.3.2.2.cmml" xref="S4.SS2.p1.2.m1.3.3.2.1">
          <csymbol cd="latexml" id="S4.SS2.p1.2.m1.3.3.2.2.1.cmml" xref="S4.SS2.p1.2.m1.3.3.2.1.2">
           delimited-[]
          </csymbol>
          <apply id="S4.SS2.p1.2.m1.3.3.2.1.1.2.cmml" xref="S4.SS2.p1.2.m1.3.3.2.1.1.1">
           <exp id="S4.SS2.p1.2.m1.1.1.cmml" xref="S4.SS2.p1.2.m1.1.1">
           </exp>
           <apply id="S4.SS2.p1.2.m1.3.3.2.1.1.1.1.1.cmml" xref="S4.SS2.p1.2.m1.3.3.2.1.1.1.1.1">
            <divide id="S4.SS2.p1.2.m1.3.3.2.1.1.1.1.1.4.cmml" xref="S4.SS2.p1.2.m1.3.3.2.1.1.1.1.1.4">
            </divide>
            <apply id="S4.SS2.p1.2.m1.3.3.2.1.1.1.1.1.3.cmml" xref="S4.SS2.p1.2.m1.3.3.2.1.1.1.1.1.3">
             <times id="S4.SS2.p1.2.m1.3.3.2.1.1.1.1.1.3.4.cmml" xref="S4.SS2.p1.2.m1.3.3.2.1.1.1.1.1.3.4">
             </times>
             <ci id="S4.SS2.p1.2.m1.3.3.2.1.1.1.1.1.3.5.cmml" xref="S4.SS2.p1.2.m1.3.3.2.1.1.1.1.1.3.5">
              𝑄
             </ci>
             <vector id="S4.SS2.p1.2.m1.3.3.2.1.1.1.1.1.3.3.4.cmml" xref="S4.SS2.p1.2.m1.3.3.2.1.1.1.1.1.3.3.3">
              <apply id="S4.SS2.p1.2.m1.3.3.2.1.1.1.1.1.1.1.1.1.cmml" xref="S4.SS2.p1.2.m1.3.3.2.1.1.1.1.1.1.1.1.1">
               <csymbol cd="ambiguous" id="S4.SS2.p1.2.m1.3.3.2.1.1.1.1.1.1.1.1.1.1.cmml" xref="S4.SS2.p1.2.m1.3.3.2.1.1.1.1.1.1.1.1.1">
                subscript
               </csymbol>
               <ci id="S4.SS2.p1.2.m1.3.3.2.1.1.1.1.1.1.1.1.1.2.cmml" xref="S4.SS2.p1.2.m1.3.3.2.1.1.1.1.1.1.1.1.1.2">
                𝑠
               </ci>
               <ci id="S4.SS2.p1.2.m1.3.3.2.1.1.1.1.1.1.1.1.1.3.cmml" xref="S4.SS2.p1.2.m1.3.3.2.1.1.1.1.1.1.1.1.1.3">
                𝑡
               </ci>
              </apply>
              <apply id="S4.SS2.p1.2.m1.3.3.2.1.1.1.1.1.2.2.2.2.cmml" xref="S4.SS2.p1.2.m1.3.3.2.1.1.1.1.1.2.2.2.2">
               <csymbol cd="ambiguous" id="S4.SS2.p1.2.m1.3.3.2.1.1.1.1.1.2.2.2.2.1.cmml" xref="S4.SS2.p1.2.m1.3.3.2.1.1.1.1.1.2.2.2.2">
                superscript
               </csymbol>
               <apply id="S4.SS2.p1.2.m1.3.3.2.1.1.1.1.1.2.2.2.2.2.cmml" xref="S4.SS2.p1.2.m1.3.3.2.1.1.1.1.1.2.2.2.2">
                <csymbol cd="ambiguous" id="S4.SS2.p1.2.m1.3.3.2.1.1.1.1.1.2.2.2.2.2.1.cmml" xref="S4.SS2.p1.2.m1.3.3.2.1.1.1.1.1.2.2.2.2">
                 subscript
                </csymbol>
                <ci id="S4.SS2.p1.2.m1.3.3.2.1.1.1.1.1.2.2.2.2.2.2.cmml" xref="S4.SS2.p1.2.m1.3.3.2.1.1.1.1.1.2.2.2.2.2.2">
                 𝑤
                </ci>
                <ci id="S4.SS2.p1.2.m1.3.3.2.1.1.1.1.1.2.2.2.2.2.3.cmml" xref="S4.SS2.p1.2.m1.3.3.2.1.1.1.1.1.2.2.2.2.2.3">
                 𝑡
                </ci>
               </apply>
               <apply id="S4.SS2.p1.2.m1.3.3.2.1.1.1.1.1.2.2.2.2.3.cmml" xref="S4.SS2.p1.2.m1.3.3.2.1.1.1.1.1.2.2.2.2.3">
                <ci id="S4.SS2.p1.2.m1.3.3.2.1.1.1.1.1.2.2.2.2.3.1.cmml" xref="S4.SS2.p1.2.m1.3.3.2.1.1.1.1.1.2.2.2.2.3.1">
                 :
                </ci>
                <cn id="S4.SS2.p1.2.m1.3.3.2.1.1.1.1.1.2.2.2.2.3.2.cmml" type="integer" xref="S4.SS2.p1.2.m1.3.3.2.1.1.1.1.1.2.2.2.2.3.2">
                 1
                </cn>
                <apply id="S4.SS2.p1.2.m1.3.3.2.1.1.1.1.1.2.2.2.2.3.3.cmml" xref="S4.SS2.p1.2.m1.3.3.2.1.1.1.1.1.2.2.2.2.3.3">
                 <minus id="S4.SS2.p1.2.m1.3.3.2.1.1.1.1.1.2.2.2.2.3.3.1.cmml" xref="S4.SS2.p1.2.m1.3.3.2.1.1.1.1.1.2.2.2.2.3.3.1">
                 </minus>
                 <ci id="S4.SS2.p1.2.m1.3.3.2.1.1.1.1.1.2.2.2.2.3.3.2.cmml" xref="S4.SS2.p1.2.m1.3.3.2.1.1.1.1.1.2.2.2.2.3.3.2">
                  𝑗
                 </ci>
                 <cn id="S4.SS2.p1.2.m1.3.3.2.1.1.1.1.1.2.2.2.2.3.3.3.cmml" type="integer" xref="S4.SS2.p1.2.m1.3.3.2.1.1.1.1.1.2.2.2.2.3.3.3">
                  1
                 </cn>
                </apply>
               </apply>
              </apply>
              <apply id="S4.SS2.p1.2.m1.3.3.2.1.1.1.1.1.3.3.3.3.cmml" xref="S4.SS2.p1.2.m1.3.3.2.1.1.1.1.1.3.3.3.3">
               <csymbol cd="ambiguous" id="S4.SS2.p1.2.m1.3.3.2.1.1.1.1.1.3.3.3.3.1.cmml" xref="S4.SS2.p1.2.m1.3.3.2.1.1.1.1.1.3.3.3.3">
                superscript
               </csymbol>
               <apply id="S4.SS2.p1.2.m1.3.3.2.1.1.1.1.1.3.3.3.3.2.cmml" xref="S4.SS2.p1.2.m1.3.3.2.1.1.1.1.1.3.3.3.3">
                <csymbol cd="ambiguous" id="S4.SS2.p1.2.m1.3.3.2.1.1.1.1.1.3.3.3.3.2.1.cmml" xref="S4.SS2.p1.2.m1.3.3.2.1.1.1.1.1.3.3.3.3">
                 subscript
                </csymbol>
                <apply id="S4.SS2.p1.2.m1.3.3.2.1.1.1.1.1.3.3.3.3.2.2.cmml" xref="S4.SS2.p1.2.m1.3.3.2.1.1.1.1.1.3.3.3.3.2.2">
                 <ci id="S4.SS2.p1.2.m1.3.3.2.1.1.1.1.1.3.3.3.3.2.2.1.cmml" xref="S4.SS2.p1.2.m1.3.3.2.1.1.1.1.1.3.3.3.3.2.2.1">
                  ¯
                 </ci>
                 <ci id="S4.SS2.p1.2.m1.3.3.2.1.1.1.1.1.3.3.3.3.2.2.2.cmml" xref="S4.SS2.p1.2.m1.3.3.2.1.1.1.1.1.3.3.3.3.2.2.2">
                  𝑤
                 </ci>
                </apply>
                <ci id="S4.SS2.p1.2.m1.3.3.2.1.1.1.1.1.3.3.3.3.2.3.cmml" xref="S4.SS2.p1.2.m1.3.3.2.1.1.1.1.1.3.3.3.3.2.3">
                 𝑡
                </ci>
               </apply>
               <ci id="S4.SS2.p1.2.m1.3.3.2.1.1.1.1.1.3.3.3.3.3.cmml" xref="S4.SS2.p1.2.m1.3.3.2.1.1.1.1.1.3.3.3.3.3">
                𝑗
               </ci>
              </apply>
             </vector>
            </apply>
            <ci id="S4.SS2.p1.2.m1.3.3.2.1.1.1.1.1.5.cmml" xref="S4.SS2.p1.2.m1.3.3.2.1.1.1.1.1.5">
             𝛽
            </ci>
           </apply>
          </apply>
         </apply>
        </apply>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="S4.SS2.p1.2.m1.3c">
        \bar{\pi}(w_{t}^{j}|s_{t},w_{t}^{1:j-1})/\mathbb{E}_{\bar{w}_{t}^{j}\sim\bar{\pi}}[\exp(Q(s_{t},w_{t}^{1:j-1},\bar{w}_{t}^{j})/\beta)]
       </annotation>
      </semantics>
     </math>
     is a normalizing constant that does not contribute to the gradient concerning the new policy and can thus be ignored
     <cite class="ltx_cite ltx_citemacro_citep">
      (Haarnoja et al.,
      <a class="ltx_ref" href="#bib.bib10" title="">
       2018b
      </a>
      )
     </cite>
     , we have
     <math alttext="\pi^{*}(w_{t}^{j}|s_{t},w_{t}^{1:j-1})\propto\exp(Q(s_{t},w_{t}^{1:j-1},w_{t}^{j})/\beta)" class="ltx_Math" display="inline" id="S4.SS2.p1.3.m2.3">
      <semantics id="S4.SS2.p1.3.m2.3a">
       <mrow id="S4.SS2.p1.3.m2.3.3" xref="S4.SS2.p1.3.m2.3.3.cmml">
        <mrow id="S4.SS2.p1.3.m2.2.2.1" xref="S4.SS2.p1.3.m2.2.2.1.cmml">
         <msup id="S4.SS2.p1.3.m2.2.2.1.3" xref="S4.SS2.p1.3.m2.2.2.1.3.cmml">
          <mi id="S4.SS2.p1.3.m2.2.2.1.3.2" xref="S4.SS2.p1.3.m2.2.2.1.3.2.cmml">
           π
          </mi>
          <mo id="S4.SS2.p1.3.m2.2.2.1.3.3" xref="S4.SS2.p1.3.m2.2.2.1.3.3.cmml">
           ∗
          </mo>
         </msup>
         <mo id="S4.SS2.p1.3.m2.2.2.1.2" lspace="0em" rspace="0em" xref="S4.SS2.p1.3.m2.2.2.1.2.cmml">
          ​
         </mo>
         <mrow id="S4.SS2.p1.3.m2.2.2.1.1.1" xref="S4.SS2.p1.3.m2.2.2.1.1.1.1.cmml">
          <mo id="S4.SS2.p1.3.m2.2.2.1.1.1.2" stretchy="false" xref="S4.SS2.p1.3.m2.2.2.1.1.1.1.cmml">
           (
          </mo>
          <mrow id="S4.SS2.p1.3.m2.2.2.1.1.1.1" xref="S4.SS2.p1.3.m2.2.2.1.1.1.1.cmml">
           <msubsup id="S4.SS2.p1.3.m2.2.2.1.1.1.1.4" xref="S4.SS2.p1.3.m2.2.2.1.1.1.1.4.cmml">
            <mi id="S4.SS2.p1.3.m2.2.2.1.1.1.1.4.2.2" xref="S4.SS2.p1.3.m2.2.2.1.1.1.1.4.2.2.cmml">
             w
            </mi>
            <mi id="S4.SS2.p1.3.m2.2.2.1.1.1.1.4.2.3" xref="S4.SS2.p1.3.m2.2.2.1.1.1.1.4.2.3.cmml">
             t
            </mi>
            <mi id="S4.SS2.p1.3.m2.2.2.1.1.1.1.4.3" xref="S4.SS2.p1.3.m2.2.2.1.1.1.1.4.3.cmml">
             j
            </mi>
           </msubsup>
           <mo fence="false" id="S4.SS2.p1.3.m2.2.2.1.1.1.1.3" xref="S4.SS2.p1.3.m2.2.2.1.1.1.1.3.cmml">
            |
           </mo>
           <mrow id="S4.SS2.p1.3.m2.2.2.1.1.1.1.2.2" xref="S4.SS2.p1.3.m2.2.2.1.1.1.1.2.3.cmml">
            <msub id="S4.SS2.p1.3.m2.2.2.1.1.1.1.1.1.1" xref="S4.SS2.p1.3.m2.2.2.1.1.1.1.1.1.1.cmml">
             <mi id="S4.SS2.p1.3.m2.2.2.1.1.1.1.1.1.1.2" xref="S4.SS2.p1.3.m2.2.2.1.1.1.1.1.1.1.2.cmml">
              s
             </mi>
             <mi id="S4.SS2.p1.3.m2.2.2.1.1.1.1.1.1.1.3" xref="S4.SS2.p1.3.m2.2.2.1.1.1.1.1.1.1.3.cmml">
              t
             </mi>
            </msub>
            <mo id="S4.SS2.p1.3.m2.2.2.1.1.1.1.2.2.3" xref="S4.SS2.p1.3.m2.2.2.1.1.1.1.2.3.cmml">
             ,
            </mo>
            <msubsup id="S4.SS2.p1.3.m2.2.2.1.1.1.1.2.2.2" xref="S4.SS2.p1.3.m2.2.2.1.1.1.1.2.2.2.cmml">
             <mi id="S4.SS2.p1.3.m2.2.2.1.1.1.1.2.2.2.2.2" xref="S4.SS2.p1.3.m2.2.2.1.1.1.1.2.2.2.2.2.cmml">
              w
             </mi>
             <mi id="S4.SS2.p1.3.m2.2.2.1.1.1.1.2.2.2.2.3" xref="S4.SS2.p1.3.m2.2.2.1.1.1.1.2.2.2.2.3.cmml">
              t
             </mi>
             <mrow id="S4.SS2.p1.3.m2.2.2.1.1.1.1.2.2.2.3" xref="S4.SS2.p1.3.m2.2.2.1.1.1.1.2.2.2.3.cmml">
              <mn id="S4.SS2.p1.3.m2.2.2.1.1.1.1.2.2.2.3.2" xref="S4.SS2.p1.3.m2.2.2.1.1.1.1.2.2.2.3.2.cmml">
               1
              </mn>
              <mo id="S4.SS2.p1.3.m2.2.2.1.1.1.1.2.2.2.3.1" lspace="0.278em" rspace="0.278em" xref="S4.SS2.p1.3.m2.2.2.1.1.1.1.2.2.2.3.1.cmml">
               :
              </mo>
              <mrow id="S4.SS2.p1.3.m2.2.2.1.1.1.1.2.2.2.3.3" xref="S4.SS2.p1.3.m2.2.2.1.1.1.1.2.2.2.3.3.cmml">
               <mi id="S4.SS2.p1.3.m2.2.2.1.1.1.1.2.2.2.3.3.2" xref="S4.SS2.p1.3.m2.2.2.1.1.1.1.2.2.2.3.3.2.cmml">
                j
               </mi>
               <mo id="S4.SS2.p1.3.m2.2.2.1.1.1.1.2.2.2.3.3.1" xref="S4.SS2.p1.3.m2.2.2.1.1.1.1.2.2.2.3.3.1.cmml">
                −
               </mo>
               <mn id="S4.SS2.p1.3.m2.2.2.1.1.1.1.2.2.2.3.3.3" xref="S4.SS2.p1.3.m2.2.2.1.1.1.1.2.2.2.3.3.3.cmml">
                1
               </mn>
              </mrow>
             </mrow>
            </msubsup>
           </mrow>
          </mrow>
          <mo id="S4.SS2.p1.3.m2.2.2.1.1.1.3" stretchy="false" xref="S4.SS2.p1.3.m2.2.2.1.1.1.1.cmml">
           )
          </mo>
         </mrow>
        </mrow>
        <mo id="S4.SS2.p1.3.m2.3.3.3" xref="S4.SS2.p1.3.m2.3.3.3.cmml">
         ∝
        </mo>
        <mrow id="S4.SS2.p1.3.m2.3.3.2.1" xref="S4.SS2.p1.3.m2.3.3.2.2.cmml">
         <mi id="S4.SS2.p1.3.m2.1.1" xref="S4.SS2.p1.3.m2.1.1.cmml">
          exp
         </mi>
         <mo id="S4.SS2.p1.3.m2.3.3.2.1a" xref="S4.SS2.p1.3.m2.3.3.2.2.cmml">
          ⁡
         </mo>
         <mrow id="S4.SS2.p1.3.m2.3.3.2.1.1" xref="S4.SS2.p1.3.m2.3.3.2.2.cmml">
          <mo id="S4.SS2.p1.3.m2.3.3.2.1.1.2" stretchy="false" xref="S4.SS2.p1.3.m2.3.3.2.2.cmml">
           (
          </mo>
          <mrow id="S4.SS2.p1.3.m2.3.3.2.1.1.1" xref="S4.SS2.p1.3.m2.3.3.2.1.1.1.cmml">
           <mrow id="S4.SS2.p1.3.m2.3.3.2.1.1.1.3" xref="S4.SS2.p1.3.m2.3.3.2.1.1.1.3.cmml">
            <mi id="S4.SS2.p1.3.m2.3.3.2.1.1.1.3.5" xref="S4.SS2.p1.3.m2.3.3.2.1.1.1.3.5.cmml">
             Q
            </mi>
            <mo id="S4.SS2.p1.3.m2.3.3.2.1.1.1.3.4" lspace="0em" rspace="0em" xref="S4.SS2.p1.3.m2.3.3.2.1.1.1.3.4.cmml">
             ​
            </mo>
            <mrow id="S4.SS2.p1.3.m2.3.3.2.1.1.1.3.3.3" xref="S4.SS2.p1.3.m2.3.3.2.1.1.1.3.3.4.cmml">
             <mo id="S4.SS2.p1.3.m2.3.3.2.1.1.1.3.3.3.4" stretchy="false" xref="S4.SS2.p1.3.m2.3.3.2.1.1.1.3.3.4.cmml">
              (
             </mo>
             <msub id="S4.SS2.p1.3.m2.3.3.2.1.1.1.1.1.1.1" xref="S4.SS2.p1.3.m2.3.3.2.1.1.1.1.1.1.1.cmml">
              <mi id="S4.SS2.p1.3.m2.3.3.2.1.1.1.1.1.1.1.2" xref="S4.SS2.p1.3.m2.3.3.2.1.1.1.1.1.1.1.2.cmml">
               s
              </mi>
              <mi id="S4.SS2.p1.3.m2.3.3.2.1.1.1.1.1.1.1.3" xref="S4.SS2.p1.3.m2.3.3.2.1.1.1.1.1.1.1.3.cmml">
               t
              </mi>
             </msub>
             <mo id="S4.SS2.p1.3.m2.3.3.2.1.1.1.3.3.3.5" xref="S4.SS2.p1.3.m2.3.3.2.1.1.1.3.3.4.cmml">
              ,
             </mo>
             <msubsup id="S4.SS2.p1.3.m2.3.3.2.1.1.1.2.2.2.2" xref="S4.SS2.p1.3.m2.3.3.2.1.1.1.2.2.2.2.cmml">
              <mi id="S4.SS2.p1.3.m2.3.3.2.1.1.1.2.2.2.2.2.2" xref="S4.SS2.p1.3.m2.3.3.2.1.1.1.2.2.2.2.2.2.cmml">
               w
              </mi>
              <mi id="S4.SS2.p1.3.m2.3.3.2.1.1.1.2.2.2.2.2.3" xref="S4.SS2.p1.3.m2.3.3.2.1.1.1.2.2.2.2.2.3.cmml">
               t
              </mi>
              <mrow id="S4.SS2.p1.3.m2.3.3.2.1.1.1.2.2.2.2.3" xref="S4.SS2.p1.3.m2.3.3.2.1.1.1.2.2.2.2.3.cmml">
               <mn id="S4.SS2.p1.3.m2.3.3.2.1.1.1.2.2.2.2.3.2" xref="S4.SS2.p1.3.m2.3.3.2.1.1.1.2.2.2.2.3.2.cmml">
                1
               </mn>
               <mo id="S4.SS2.p1.3.m2.3.3.2.1.1.1.2.2.2.2.3.1" lspace="0.278em" rspace="0.278em" xref="S4.SS2.p1.3.m2.3.3.2.1.1.1.2.2.2.2.3.1.cmml">
                :
               </mo>
               <mrow id="S4.SS2.p1.3.m2.3.3.2.1.1.1.2.2.2.2.3.3" xref="S4.SS2.p1.3.m2.3.3.2.1.1.1.2.2.2.2.3.3.cmml">
                <mi id="S4.SS2.p1.3.m2.3.3.2.1.1.1.2.2.2.2.3.3.2" xref="S4.SS2.p1.3.m2.3.3.2.1.1.1.2.2.2.2.3.3.2.cmml">
                 j
                </mi>
                <mo id="S4.SS2.p1.3.m2.3.3.2.1.1.1.2.2.2.2.3.3.1" xref="S4.SS2.p1.3.m2.3.3.2.1.1.1.2.2.2.2.3.3.1.cmml">
                 −
                </mo>
                <mn id="S4.SS2.p1.3.m2.3.3.2.1.1.1.2.2.2.2.3.3.3" xref="S4.SS2.p1.3.m2.3.3.2.1.1.1.2.2.2.2.3.3.3.cmml">
                 1
                </mn>
               </mrow>
              </mrow>
             </msubsup>
             <mo id="S4.SS2.p1.3.m2.3.3.2.1.1.1.3.3.3.6" xref="S4.SS2.p1.3.m2.3.3.2.1.1.1.3.3.4.cmml">
              ,
             </mo>
             <msubsup id="S4.SS2.p1.3.m2.3.3.2.1.1.1.3.3.3.3" xref="S4.SS2.p1.3.m2.3.3.2.1.1.1.3.3.3.3.cmml">
              <mi id="S4.SS2.p1.3.m2.3.3.2.1.1.1.3.3.3.3.2.2" xref="S4.SS2.p1.3.m2.3.3.2.1.1.1.3.3.3.3.2.2.cmml">
               w
              </mi>
              <mi id="S4.SS2.p1.3.m2.3.3.2.1.1.1.3.3.3.3.2.3" xref="S4.SS2.p1.3.m2.3.3.2.1.1.1.3.3.3.3.2.3.cmml">
               t
              </mi>
              <mi id="S4.SS2.p1.3.m2.3.3.2.1.1.1.3.3.3.3.3" xref="S4.SS2.p1.3.m2.3.3.2.1.1.1.3.3.3.3.3.cmml">
               j
              </mi>
             </msubsup>
             <mo id="S4.SS2.p1.3.m2.3.3.2.1.1.1.3.3.3.7" stretchy="false" xref="S4.SS2.p1.3.m2.3.3.2.1.1.1.3.3.4.cmml">
              )
             </mo>
            </mrow>
           </mrow>
           <mo id="S4.SS2.p1.3.m2.3.3.2.1.1.1.4" xref="S4.SS2.p1.3.m2.3.3.2.1.1.1.4.cmml">
            /
           </mo>
           <mi id="S4.SS2.p1.3.m2.3.3.2.1.1.1.5" xref="S4.SS2.p1.3.m2.3.3.2.1.1.1.5.cmml">
            β
           </mi>
          </mrow>
          <mo id="S4.SS2.p1.3.m2.3.3.2.1.1.3" stretchy="false" xref="S4.SS2.p1.3.m2.3.3.2.2.cmml">
           )
          </mo>
         </mrow>
        </mrow>
       </mrow>
       <annotation-xml encoding="MathML-Content" id="S4.SS2.p1.3.m2.3b">
        <apply id="S4.SS2.p1.3.m2.3.3.cmml" xref="S4.SS2.p1.3.m2.3.3">
         <csymbol cd="latexml" id="S4.SS2.p1.3.m2.3.3.3.cmml" xref="S4.SS2.p1.3.m2.3.3.3">
          proportional-to
         </csymbol>
         <apply id="S4.SS2.p1.3.m2.2.2.1.cmml" xref="S4.SS2.p1.3.m2.2.2.1">
          <times id="S4.SS2.p1.3.m2.2.2.1.2.cmml" xref="S4.SS2.p1.3.m2.2.2.1.2">
          </times>
          <apply id="S4.SS2.p1.3.m2.2.2.1.3.cmml" xref="S4.SS2.p1.3.m2.2.2.1.3">
           <csymbol cd="ambiguous" id="S4.SS2.p1.3.m2.2.2.1.3.1.cmml" xref="S4.SS2.p1.3.m2.2.2.1.3">
            superscript
           </csymbol>
           <ci id="S4.SS2.p1.3.m2.2.2.1.3.2.cmml" xref="S4.SS2.p1.3.m2.2.2.1.3.2">
            𝜋
           </ci>
           <times id="S4.SS2.p1.3.m2.2.2.1.3.3.cmml" xref="S4.SS2.p1.3.m2.2.2.1.3.3">
           </times>
          </apply>
          <apply id="S4.SS2.p1.3.m2.2.2.1.1.1.1.cmml" xref="S4.SS2.p1.3.m2.2.2.1.1.1">
           <csymbol cd="latexml" id="S4.SS2.p1.3.m2.2.2.1.1.1.1.3.cmml" xref="S4.SS2.p1.3.m2.2.2.1.1.1.1.3">
            conditional
           </csymbol>
           <apply id="S4.SS2.p1.3.m2.2.2.1.1.1.1.4.cmml" xref="S4.SS2.p1.3.m2.2.2.1.1.1.1.4">
            <csymbol cd="ambiguous" id="S4.SS2.p1.3.m2.2.2.1.1.1.1.4.1.cmml" xref="S4.SS2.p1.3.m2.2.2.1.1.1.1.4">
             superscript
            </csymbol>
            <apply id="S4.SS2.p1.3.m2.2.2.1.1.1.1.4.2.cmml" xref="S4.SS2.p1.3.m2.2.2.1.1.1.1.4">
             <csymbol cd="ambiguous" id="S4.SS2.p1.3.m2.2.2.1.1.1.1.4.2.1.cmml" xref="S4.SS2.p1.3.m2.2.2.1.1.1.1.4">
              subscript
             </csymbol>
             <ci id="S4.SS2.p1.3.m2.2.2.1.1.1.1.4.2.2.cmml" xref="S4.SS2.p1.3.m2.2.2.1.1.1.1.4.2.2">
              𝑤
             </ci>
             <ci id="S4.SS2.p1.3.m2.2.2.1.1.1.1.4.2.3.cmml" xref="S4.SS2.p1.3.m2.2.2.1.1.1.1.4.2.3">
              𝑡
             </ci>
            </apply>
            <ci id="S4.SS2.p1.3.m2.2.2.1.1.1.1.4.3.cmml" xref="S4.SS2.p1.3.m2.2.2.1.1.1.1.4.3">
             𝑗
            </ci>
           </apply>
           <list id="S4.SS2.p1.3.m2.2.2.1.1.1.1.2.3.cmml" xref="S4.SS2.p1.3.m2.2.2.1.1.1.1.2.2">
            <apply id="S4.SS2.p1.3.m2.2.2.1.1.1.1.1.1.1.cmml" xref="S4.SS2.p1.3.m2.2.2.1.1.1.1.1.1.1">
             <csymbol cd="ambiguous" id="S4.SS2.p1.3.m2.2.2.1.1.1.1.1.1.1.1.cmml" xref="S4.SS2.p1.3.m2.2.2.1.1.1.1.1.1.1">
              subscript
             </csymbol>
             <ci id="S4.SS2.p1.3.m2.2.2.1.1.1.1.1.1.1.2.cmml" xref="S4.SS2.p1.3.m2.2.2.1.1.1.1.1.1.1.2">
              𝑠
             </ci>
             <ci id="S4.SS2.p1.3.m2.2.2.1.1.1.1.1.1.1.3.cmml" xref="S4.SS2.p1.3.m2.2.2.1.1.1.1.1.1.1.3">
              𝑡
             </ci>
            </apply>
            <apply id="S4.SS2.p1.3.m2.2.2.1.1.1.1.2.2.2.cmml" xref="S4.SS2.p1.3.m2.2.2.1.1.1.1.2.2.2">
             <csymbol cd="ambiguous" id="S4.SS2.p1.3.m2.2.2.1.1.1.1.2.2.2.1.cmml" xref="S4.SS2.p1.3.m2.2.2.1.1.1.1.2.2.2">
              superscript
             </csymbol>
             <apply id="S4.SS2.p1.3.m2.2.2.1.1.1.1.2.2.2.2.cmml" xref="S4.SS2.p1.3.m2.2.2.1.1.1.1.2.2.2">
              <csymbol cd="ambiguous" id="S4.SS2.p1.3.m2.2.2.1.1.1.1.2.2.2.2.1.cmml" xref="S4.SS2.p1.3.m2.2.2.1.1.1.1.2.2.2">
               subscript
              </csymbol>
              <ci id="S4.SS2.p1.3.m2.2.2.1.1.1.1.2.2.2.2.2.cmml" xref="S4.SS2.p1.3.m2.2.2.1.1.1.1.2.2.2.2.2">
               𝑤
              </ci>
              <ci id="S4.SS2.p1.3.m2.2.2.1.1.1.1.2.2.2.2.3.cmml" xref="S4.SS2.p1.3.m2.2.2.1.1.1.1.2.2.2.2.3">
               𝑡
              </ci>
             </apply>
             <apply id="S4.SS2.p1.3.m2.2.2.1.1.1.1.2.2.2.3.cmml" xref="S4.SS2.p1.3.m2.2.2.1.1.1.1.2.2.2.3">
              <ci id="S4.SS2.p1.3.m2.2.2.1.1.1.1.2.2.2.3.1.cmml" xref="S4.SS2.p1.3.m2.2.2.1.1.1.1.2.2.2.3.1">
               :
              </ci>
              <cn id="S4.SS2.p1.3.m2.2.2.1.1.1.1.2.2.2.3.2.cmml" type="integer" xref="S4.SS2.p1.3.m2.2.2.1.1.1.1.2.2.2.3.2">
               1
              </cn>
              <apply id="S4.SS2.p1.3.m2.2.2.1.1.1.1.2.2.2.3.3.cmml" xref="S4.SS2.p1.3.m2.2.2.1.1.1.1.2.2.2.3.3">
               <minus id="S4.SS2.p1.3.m2.2.2.1.1.1.1.2.2.2.3.3.1.cmml" xref="S4.SS2.p1.3.m2.2.2.1.1.1.1.2.2.2.3.3.1">
               </minus>
               <ci id="S4.SS2.p1.3.m2.2.2.1.1.1.1.2.2.2.3.3.2.cmml" xref="S4.SS2.p1.3.m2.2.2.1.1.1.1.2.2.2.3.3.2">
                𝑗
               </ci>
               <cn id="S4.SS2.p1.3.m2.2.2.1.1.1.1.2.2.2.3.3.3.cmml" type="integer" xref="S4.SS2.p1.3.m2.2.2.1.1.1.1.2.2.2.3.3.3">
                1
               </cn>
              </apply>
             </apply>
            </apply>
           </list>
          </apply>
         </apply>
         <apply id="S4.SS2.p1.3.m2.3.3.2.2.cmml" xref="S4.SS2.p1.3.m2.3.3.2.1">
          <exp id="S4.SS2.p1.3.m2.1.1.cmml" xref="S4.SS2.p1.3.m2.1.1">
          </exp>
          <apply id="S4.SS2.p1.3.m2.3.3.2.1.1.1.cmml" xref="S4.SS2.p1.3.m2.3.3.2.1.1.1">
           <divide id="S4.SS2.p1.3.m2.3.3.2.1.1.1.4.cmml" xref="S4.SS2.p1.3.m2.3.3.2.1.1.1.4">
           </divide>
           <apply id="S4.SS2.p1.3.m2.3.3.2.1.1.1.3.cmml" xref="S4.SS2.p1.3.m2.3.3.2.1.1.1.3">
            <times id="S4.SS2.p1.3.m2.3.3.2.1.1.1.3.4.cmml" xref="S4.SS2.p1.3.m2.3.3.2.1.1.1.3.4">
            </times>
            <ci id="S4.SS2.p1.3.m2.3.3.2.1.1.1.3.5.cmml" xref="S4.SS2.p1.3.m2.3.3.2.1.1.1.3.5">
             𝑄
            </ci>
            <vector id="S4.SS2.p1.3.m2.3.3.2.1.1.1.3.3.4.cmml" xref="S4.SS2.p1.3.m2.3.3.2.1.1.1.3.3.3">
             <apply id="S4.SS2.p1.3.m2.3.3.2.1.1.1.1.1.1.1.cmml" xref="S4.SS2.p1.3.m2.3.3.2.1.1.1.1.1.1.1">
              <csymbol cd="ambiguous" id="S4.SS2.p1.3.m2.3.3.2.1.1.1.1.1.1.1.1.cmml" xref="S4.SS2.p1.3.m2.3.3.2.1.1.1.1.1.1.1">
               subscript
              </csymbol>
              <ci id="S4.SS2.p1.3.m2.3.3.2.1.1.1.1.1.1.1.2.cmml" xref="S4.SS2.p1.3.m2.3.3.2.1.1.1.1.1.1.1.2">
               𝑠
              </ci>
              <ci id="S4.SS2.p1.3.m2.3.3.2.1.1.1.1.1.1.1.3.cmml" xref="S4.SS2.p1.3.m2.3.3.2.1.1.1.1.1.1.1.3">
               𝑡
              </ci>
             </apply>
             <apply id="S4.SS2.p1.3.m2.3.3.2.1.1.1.2.2.2.2.cmml" xref="S4.SS2.p1.3.m2.3.3.2.1.1.1.2.2.2.2">
              <csymbol cd="ambiguous" id="S4.SS2.p1.3.m2.3.3.2.1.1.1.2.2.2.2.1.cmml" xref="S4.SS2.p1.3.m2.3.3.2.1.1.1.2.2.2.2">
               superscript
              </csymbol>
              <apply id="S4.SS2.p1.3.m2.3.3.2.1.1.1.2.2.2.2.2.cmml" xref="S4.SS2.p1.3.m2.3.3.2.1.1.1.2.2.2.2">
               <csymbol cd="ambiguous" id="S4.SS2.p1.3.m2.3.3.2.1.1.1.2.2.2.2.2.1.cmml" xref="S4.SS2.p1.3.m2.3.3.2.1.1.1.2.2.2.2">
                subscript
               </csymbol>
               <ci id="S4.SS2.p1.3.m2.3.3.2.1.1.1.2.2.2.2.2.2.cmml" xref="S4.SS2.p1.3.m2.3.3.2.1.1.1.2.2.2.2.2.2">
                𝑤
               </ci>
               <ci id="S4.SS2.p1.3.m2.3.3.2.1.1.1.2.2.2.2.2.3.cmml" xref="S4.SS2.p1.3.m2.3.3.2.1.1.1.2.2.2.2.2.3">
                𝑡
               </ci>
              </apply>
              <apply id="S4.SS2.p1.3.m2.3.3.2.1.1.1.2.2.2.2.3.cmml" xref="S4.SS2.p1.3.m2.3.3.2.1.1.1.2.2.2.2.3">
               <ci id="S4.SS2.p1.3.m2.3.3.2.1.1.1.2.2.2.2.3.1.cmml" xref="S4.SS2.p1.3.m2.3.3.2.1.1.1.2.2.2.2.3.1">
                :
               </ci>
               <cn id="S4.SS2.p1.3.m2.3.3.2.1.1.1.2.2.2.2.3.2.cmml" type="integer" xref="S4.SS2.p1.3.m2.3.3.2.1.1.1.2.2.2.2.3.2">
                1
               </cn>
               <apply id="S4.SS2.p1.3.m2.3.3.2.1.1.1.2.2.2.2.3.3.cmml" xref="S4.SS2.p1.3.m2.3.3.2.1.1.1.2.2.2.2.3.3">
                <minus id="S4.SS2.p1.3.m2.3.3.2.1.1.1.2.2.2.2.3.3.1.cmml" xref="S4.SS2.p1.3.m2.3.3.2.1.1.1.2.2.2.2.3.3.1">
                </minus>
                <ci id="S4.SS2.p1.3.m2.3.3.2.1.1.1.2.2.2.2.3.3.2.cmml" xref="S4.SS2.p1.3.m2.3.3.2.1.1.1.2.2.2.2.3.3.2">
                 𝑗
                </ci>
                <cn id="S4.SS2.p1.3.m2.3.3.2.1.1.1.2.2.2.2.3.3.3.cmml" type="integer" xref="S4.SS2.p1.3.m2.3.3.2.1.1.1.2.2.2.2.3.3.3">
                 1
                </cn>
               </apply>
              </apply>
             </apply>
             <apply id="S4.SS2.p1.3.m2.3.3.2.1.1.1.3.3.3.3.cmml" xref="S4.SS2.p1.3.m2.3.3.2.1.1.1.3.3.3.3">
              <csymbol cd="ambiguous" id="S4.SS2.p1.3.m2.3.3.2.1.1.1.3.3.3.3.1.cmml" xref="S4.SS2.p1.3.m2.3.3.2.1.1.1.3.3.3.3">
               superscript
              </csymbol>
              <apply id="S4.SS2.p1.3.m2.3.3.2.1.1.1.3.3.3.3.2.cmml" xref="S4.SS2.p1.3.m2.3.3.2.1.1.1.3.3.3.3">
               <csymbol cd="ambiguous" id="S4.SS2.p1.3.m2.3.3.2.1.1.1.3.3.3.3.2.1.cmml" xref="S4.SS2.p1.3.m2.3.3.2.1.1.1.3.3.3.3">
                subscript
               </csymbol>
               <ci id="S4.SS2.p1.3.m2.3.3.2.1.1.1.3.3.3.3.2.2.cmml" xref="S4.SS2.p1.3.m2.3.3.2.1.1.1.3.3.3.3.2.2">
                𝑤
               </ci>
               <ci id="S4.SS2.p1.3.m2.3.3.2.1.1.1.3.3.3.3.2.3.cmml" xref="S4.SS2.p1.3.m2.3.3.2.1.1.1.3.3.3.3.2.3">
                𝑡
               </ci>
              </apply>
              <ci id="S4.SS2.p1.3.m2.3.3.2.1.1.1.3.3.3.3.3.cmml" xref="S4.SS2.p1.3.m2.3.3.2.1.1.1.3.3.3.3.3">
               𝑗
              </ci>
             </apply>
            </vector>
           </apply>
           <ci id="S4.SS2.p1.3.m2.3.3.2.1.1.1.5.cmml" xref="S4.SS2.p1.3.m2.3.3.2.1.1.1.5">
            𝛽
           </ci>
          </apply>
         </apply>
        </apply>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="S4.SS2.p1.3.m2.3c">
        \pi^{*}(w_{t}^{j}|s_{t},w_{t}^{1:j-1})\propto\exp(Q(s_{t},w_{t}^{1:j-1},w_{t}^{j})/\beta)
       </annotation>
      </semantics>
     </math>
     and can thus update the policy toward minimizing the KL-divergence between
     <math alttext="\pi(w_{t}^{j}|s_{t},w_{t}^{1:j-1})" class="ltx_Math" display="inline" id="S4.SS2.p1.4.m3.1">
      <semantics id="S4.SS2.p1.4.m3.1a">
       <mrow id="S4.SS2.p1.4.m3.1.1" xref="S4.SS2.p1.4.m3.1.1.cmml">
        <mi id="S4.SS2.p1.4.m3.1.1.3" xref="S4.SS2.p1.4.m3.1.1.3.cmml">
         π
        </mi>
        <mo id="S4.SS2.p1.4.m3.1.1.2" lspace="0em" rspace="0em" xref="S4.SS2.p1.4.m3.1.1.2.cmml">
         ​
        </mo>
        <mrow id="S4.SS2.p1.4.m3.1.1.1.1" xref="S4.SS2.p1.4.m3.1.1.1.1.1.cmml">
         <mo id="S4.SS2.p1.4.m3.1.1.1.1.2" stretchy="false" xref="S4.SS2.p1.4.m3.1.1.1.1.1.cmml">
          (
         </mo>
         <mrow id="S4.SS2.p1.4.m3.1.1.1.1.1" xref="S4.SS2.p1.4.m3.1.1.1.1.1.cmml">
          <msubsup id="S4.SS2.p1.4.m3.1.1.1.1.1.4" xref="S4.SS2.p1.4.m3.1.1.1.1.1.4.cmml">
           <mi id="S4.SS2.p1.4.m3.1.1.1.1.1.4.2.2" xref="S4.SS2.p1.4.m3.1.1.1.1.1.4.2.2.cmml">
            w
           </mi>
           <mi id="S4.SS2.p1.4.m3.1.1.1.1.1.4.2.3" xref="S4.SS2.p1.4.m3.1.1.1.1.1.4.2.3.cmml">
            t
           </mi>
           <mi id="S4.SS2.p1.4.m3.1.1.1.1.1.4.3" xref="S4.SS2.p1.4.m3.1.1.1.1.1.4.3.cmml">
            j
           </mi>
          </msubsup>
          <mo fence="false" id="S4.SS2.p1.4.m3.1.1.1.1.1.3" xref="S4.SS2.p1.4.m3.1.1.1.1.1.3.cmml">
           |
          </mo>
          <mrow id="S4.SS2.p1.4.m3.1.1.1.1.1.2.2" xref="S4.SS2.p1.4.m3.1.1.1.1.1.2.3.cmml">
           <msub id="S4.SS2.p1.4.m3.1.1.1.1.1.1.1.1" xref="S4.SS2.p1.4.m3.1.1.1.1.1.1.1.1.cmml">
            <mi id="S4.SS2.p1.4.m3.1.1.1.1.1.1.1.1.2" xref="S4.SS2.p1.4.m3.1.1.1.1.1.1.1.1.2.cmml">
             s
            </mi>
            <mi id="S4.SS2.p1.4.m3.1.1.1.1.1.1.1.1.3" xref="S4.SS2.p1.4.m3.1.1.1.1.1.1.1.1.3.cmml">
             t
            </mi>
           </msub>
           <mo id="S4.SS2.p1.4.m3.1.1.1.1.1.2.2.3" xref="S4.SS2.p1.4.m3.1.1.1.1.1.2.3.cmml">
            ,
           </mo>
           <msubsup id="S4.SS2.p1.4.m3.1.1.1.1.1.2.2.2" xref="S4.SS2.p1.4.m3.1.1.1.1.1.2.2.2.cmml">
            <mi id="S4.SS2.p1.4.m3.1.1.1.1.1.2.2.2.2.2" xref="S4.SS2.p1.4.m3.1.1.1.1.1.2.2.2.2.2.cmml">
             w
            </mi>
            <mi id="S4.SS2.p1.4.m3.1.1.1.1.1.2.2.2.2.3" xref="S4.SS2.p1.4.m3.1.1.1.1.1.2.2.2.2.3.cmml">
             t
            </mi>
            <mrow id="S4.SS2.p1.4.m3.1.1.1.1.1.2.2.2.3" xref="S4.SS2.p1.4.m3.1.1.1.1.1.2.2.2.3.cmml">
             <mn id="S4.SS2.p1.4.m3.1.1.1.1.1.2.2.2.3.2" xref="S4.SS2.p1.4.m3.1.1.1.1.1.2.2.2.3.2.cmml">
              1
             </mn>
             <mo id="S4.SS2.p1.4.m3.1.1.1.1.1.2.2.2.3.1" lspace="0.278em" rspace="0.278em" xref="S4.SS2.p1.4.m3.1.1.1.1.1.2.2.2.3.1.cmml">
              :
             </mo>
             <mrow id="S4.SS2.p1.4.m3.1.1.1.1.1.2.2.2.3.3" xref="S4.SS2.p1.4.m3.1.1.1.1.1.2.2.2.3.3.cmml">
              <mi id="S4.SS2.p1.4.m3.1.1.1.1.1.2.2.2.3.3.2" xref="S4.SS2.p1.4.m3.1.1.1.1.1.2.2.2.3.3.2.cmml">
               j
              </mi>
              <mo id="S4.SS2.p1.4.m3.1.1.1.1.1.2.2.2.3.3.1" xref="S4.SS2.p1.4.m3.1.1.1.1.1.2.2.2.3.3.1.cmml">
               −
              </mo>
              <mn id="S4.SS2.p1.4.m3.1.1.1.1.1.2.2.2.3.3.3" xref="S4.SS2.p1.4.m3.1.1.1.1.1.2.2.2.3.3.3.cmml">
               1
              </mn>
             </mrow>
            </mrow>
           </msubsup>
          </mrow>
         </mrow>
         <mo id="S4.SS2.p1.4.m3.1.1.1.1.3" stretchy="false" xref="S4.SS2.p1.4.m3.1.1.1.1.1.cmml">
          )
         </mo>
        </mrow>
       </mrow>
       <annotation-xml encoding="MathML-Content" id="S4.SS2.p1.4.m3.1b">
        <apply id="S4.SS2.p1.4.m3.1.1.cmml" xref="S4.SS2.p1.4.m3.1.1">
         <times id="S4.SS2.p1.4.m3.1.1.2.cmml" xref="S4.SS2.p1.4.m3.1.1.2">
         </times>
         <ci id="S4.SS2.p1.4.m3.1.1.3.cmml" xref="S4.SS2.p1.4.m3.1.1.3">
          𝜋
         </ci>
         <apply id="S4.SS2.p1.4.m3.1.1.1.1.1.cmml" xref="S4.SS2.p1.4.m3.1.1.1.1">
          <csymbol cd="latexml" id="S4.SS2.p1.4.m3.1.1.1.1.1.3.cmml" xref="S4.SS2.p1.4.m3.1.1.1.1.1.3">
           conditional
          </csymbol>
          <apply id="S4.SS2.p1.4.m3.1.1.1.1.1.4.cmml" xref="S4.SS2.p1.4.m3.1.1.1.1.1.4">
           <csymbol cd="ambiguous" id="S4.SS2.p1.4.m3.1.1.1.1.1.4.1.cmml" xref="S4.SS2.p1.4.m3.1.1.1.1.1.4">
            superscript
           </csymbol>
           <apply id="S4.SS2.p1.4.m3.1.1.1.1.1.4.2.cmml" xref="S4.SS2.p1.4.m3.1.1.1.1.1.4">
            <csymbol cd="ambiguous" id="S4.SS2.p1.4.m3.1.1.1.1.1.4.2.1.cmml" xref="S4.SS2.p1.4.m3.1.1.1.1.1.4">
             subscript
            </csymbol>
            <ci id="S4.SS2.p1.4.m3.1.1.1.1.1.4.2.2.cmml" xref="S4.SS2.p1.4.m3.1.1.1.1.1.4.2.2">
             𝑤
            </ci>
            <ci id="S4.SS2.p1.4.m3.1.1.1.1.1.4.2.3.cmml" xref="S4.SS2.p1.4.m3.1.1.1.1.1.4.2.3">
             𝑡
            </ci>
           </apply>
           <ci id="S4.SS2.p1.4.m3.1.1.1.1.1.4.3.cmml" xref="S4.SS2.p1.4.m3.1.1.1.1.1.4.3">
            𝑗
           </ci>
          </apply>
          <list id="S4.SS2.p1.4.m3.1.1.1.1.1.2.3.cmml" xref="S4.SS2.p1.4.m3.1.1.1.1.1.2.2">
           <apply id="S4.SS2.p1.4.m3.1.1.1.1.1.1.1.1.cmml" xref="S4.SS2.p1.4.m3.1.1.1.1.1.1.1.1">
            <csymbol cd="ambiguous" id="S4.SS2.p1.4.m3.1.1.1.1.1.1.1.1.1.cmml" xref="S4.SS2.p1.4.m3.1.1.1.1.1.1.1.1">
             subscript
            </csymbol>
            <ci id="S4.SS2.p1.4.m3.1.1.1.1.1.1.1.1.2.cmml" xref="S4.SS2.p1.4.m3.1.1.1.1.1.1.1.1.2">
             𝑠
            </ci>
            <ci id="S4.SS2.p1.4.m3.1.1.1.1.1.1.1.1.3.cmml" xref="S4.SS2.p1.4.m3.1.1.1.1.1.1.1.1.3">
             𝑡
            </ci>
           </apply>
           <apply id="S4.SS2.p1.4.m3.1.1.1.1.1.2.2.2.cmml" xref="S4.SS2.p1.4.m3.1.1.1.1.1.2.2.2">
            <csymbol cd="ambiguous" id="S4.SS2.p1.4.m3.1.1.1.1.1.2.2.2.1.cmml" xref="S4.SS2.p1.4.m3.1.1.1.1.1.2.2.2">
             superscript
            </csymbol>
            <apply id="S4.SS2.p1.4.m3.1.1.1.1.1.2.2.2.2.cmml" xref="S4.SS2.p1.4.m3.1.1.1.1.1.2.2.2">
             <csymbol cd="ambiguous" id="S4.SS2.p1.4.m3.1.1.1.1.1.2.2.2.2.1.cmml" xref="S4.SS2.p1.4.m3.1.1.1.1.1.2.2.2">
              subscript
             </csymbol>
             <ci id="S4.SS2.p1.4.m3.1.1.1.1.1.2.2.2.2.2.cmml" xref="S4.SS2.p1.4.m3.1.1.1.1.1.2.2.2.2.2">
              𝑤
             </ci>
             <ci id="S4.SS2.p1.4.m3.1.1.1.1.1.2.2.2.2.3.cmml" xref="S4.SS2.p1.4.m3.1.1.1.1.1.2.2.2.2.3">
              𝑡
             </ci>
            </apply>
            <apply id="S4.SS2.p1.4.m3.1.1.1.1.1.2.2.2.3.cmml" xref="S4.SS2.p1.4.m3.1.1.1.1.1.2.2.2.3">
             <ci id="S4.SS2.p1.4.m3.1.1.1.1.1.2.2.2.3.1.cmml" xref="S4.SS2.p1.4.m3.1.1.1.1.1.2.2.2.3.1">
              :
             </ci>
             <cn id="S4.SS2.p1.4.m3.1.1.1.1.1.2.2.2.3.2.cmml" type="integer" xref="S4.SS2.p1.4.m3.1.1.1.1.1.2.2.2.3.2">
              1
             </cn>
             <apply id="S4.SS2.p1.4.m3.1.1.1.1.1.2.2.2.3.3.cmml" xref="S4.SS2.p1.4.m3.1.1.1.1.1.2.2.2.3.3">
              <minus id="S4.SS2.p1.4.m3.1.1.1.1.1.2.2.2.3.3.1.cmml" xref="S4.SS2.p1.4.m3.1.1.1.1.1.2.2.2.3.3.1">
              </minus>
              <ci id="S4.SS2.p1.4.m3.1.1.1.1.1.2.2.2.3.3.2.cmml" xref="S4.SS2.p1.4.m3.1.1.1.1.1.2.2.2.3.3.2">
               𝑗
              </ci>
              <cn id="S4.SS2.p1.4.m3.1.1.1.1.1.2.2.2.3.3.3.cmml" type="integer" xref="S4.SS2.p1.4.m3.1.1.1.1.1.2.2.2.3.3.3">
               1
              </cn>
             </apply>
            </apply>
           </apply>
          </list>
         </apply>
        </apply>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="S4.SS2.p1.4.m3.1c">
        \pi(w_{t}^{j}|s_{t},w_{t}^{1:j-1})
       </annotation>
      </semantics>
     </math>
     and
     <math alttext="\exp(Q(s_{t},w_{t}^{1:j-1},w_{t}^{j})/\beta)" class="ltx_Math" display="inline" id="S4.SS2.p1.5.m4.2">
      <semantics id="S4.SS2.p1.5.m4.2a">
       <mrow id="S4.SS2.p1.5.m4.2.2.1" xref="S4.SS2.p1.5.m4.2.2.2.cmml">
        <mi id="S4.SS2.p1.5.m4.1.1" xref="S4.SS2.p1.5.m4.1.1.cmml">
         exp
        </mi>
        <mo id="S4.SS2.p1.5.m4.2.2.1a" xref="S4.SS2.p1.5.m4.2.2.2.cmml">
         ⁡
        </mo>
        <mrow id="S4.SS2.p1.5.m4.2.2.1.1" xref="S4.SS2.p1.5.m4.2.2.2.cmml">
         <mo id="S4.SS2.p1.5.m4.2.2.1.1.2" stretchy="false" xref="S4.SS2.p1.5.m4.2.2.2.cmml">
          (
         </mo>
         <mrow id="S4.SS2.p1.5.m4.2.2.1.1.1" xref="S4.SS2.p1.5.m4.2.2.1.1.1.cmml">
          <mrow id="S4.SS2.p1.5.m4.2.2.1.1.1.3" xref="S4.SS2.p1.5.m4.2.2.1.1.1.3.cmml">
           <mi id="S4.SS2.p1.5.m4.2.2.1.1.1.3.5" xref="S4.SS2.p1.5.m4.2.2.1.1.1.3.5.cmml">
            Q
           </mi>
           <mo id="S4.SS2.p1.5.m4.2.2.1.1.1.3.4" lspace="0em" rspace="0em" xref="S4.SS2.p1.5.m4.2.2.1.1.1.3.4.cmml">
            ​
           </mo>
           <mrow id="S4.SS2.p1.5.m4.2.2.1.1.1.3.3.3" xref="S4.SS2.p1.5.m4.2.2.1.1.1.3.3.4.cmml">
            <mo id="S4.SS2.p1.5.m4.2.2.1.1.1.3.3.3.4" stretchy="false" xref="S4.SS2.p1.5.m4.2.2.1.1.1.3.3.4.cmml">
             (
            </mo>
            <msub id="S4.SS2.p1.5.m4.2.2.1.1.1.1.1.1.1" xref="S4.SS2.p1.5.m4.2.2.1.1.1.1.1.1.1.cmml">
             <mi id="S4.SS2.p1.5.m4.2.2.1.1.1.1.1.1.1.2" xref="S4.SS2.p1.5.m4.2.2.1.1.1.1.1.1.1.2.cmml">
              s
             </mi>
             <mi id="S4.SS2.p1.5.m4.2.2.1.1.1.1.1.1.1.3" xref="S4.SS2.p1.5.m4.2.2.1.1.1.1.1.1.1.3.cmml">
              t
             </mi>
            </msub>
            <mo id="S4.SS2.p1.5.m4.2.2.1.1.1.3.3.3.5" xref="S4.SS2.p1.5.m4.2.2.1.1.1.3.3.4.cmml">
             ,
            </mo>
            <msubsup id="S4.SS2.p1.5.m4.2.2.1.1.1.2.2.2.2" xref="S4.SS2.p1.5.m4.2.2.1.1.1.2.2.2.2.cmml">
             <mi id="S4.SS2.p1.5.m4.2.2.1.1.1.2.2.2.2.2.2" xref="S4.SS2.p1.5.m4.2.2.1.1.1.2.2.2.2.2.2.cmml">
              w
             </mi>
             <mi id="S4.SS2.p1.5.m4.2.2.1.1.1.2.2.2.2.2.3" xref="S4.SS2.p1.5.m4.2.2.1.1.1.2.2.2.2.2.3.cmml">
              t
             </mi>
             <mrow id="S4.SS2.p1.5.m4.2.2.1.1.1.2.2.2.2.3" xref="S4.SS2.p1.5.m4.2.2.1.1.1.2.2.2.2.3.cmml">
              <mn id="S4.SS2.p1.5.m4.2.2.1.1.1.2.2.2.2.3.2" xref="S4.SS2.p1.5.m4.2.2.1.1.1.2.2.2.2.3.2.cmml">
               1
              </mn>
              <mo id="S4.SS2.p1.5.m4.2.2.1.1.1.2.2.2.2.3.1" lspace="0.278em" rspace="0.278em" xref="S4.SS2.p1.5.m4.2.2.1.1.1.2.2.2.2.3.1.cmml">
               :
              </mo>
              <mrow id="S4.SS2.p1.5.m4.2.2.1.1.1.2.2.2.2.3.3" xref="S4.SS2.p1.5.m4.2.2.1.1.1.2.2.2.2.3.3.cmml">
               <mi id="S4.SS2.p1.5.m4.2.2.1.1.1.2.2.2.2.3.3.2" xref="S4.SS2.p1.5.m4.2.2.1.1.1.2.2.2.2.3.3.2.cmml">
                j
               </mi>
               <mo id="S4.SS2.p1.5.m4.2.2.1.1.1.2.2.2.2.3.3.1" xref="S4.SS2.p1.5.m4.2.2.1.1.1.2.2.2.2.3.3.1.cmml">
                −
               </mo>
               <mn id="S4.SS2.p1.5.m4.2.2.1.1.1.2.2.2.2.3.3.3" xref="S4.SS2.p1.5.m4.2.2.1.1.1.2.2.2.2.3.3.3.cmml">
                1
               </mn>
              </mrow>
             </mrow>
            </msubsup>
            <mo id="S4.SS2.p1.5.m4.2.2.1.1.1.3.3.3.6" xref="S4.SS2.p1.5.m4.2.2.1.1.1.3.3.4.cmml">
             ,
            </mo>
            <msubsup id="S4.SS2.p1.5.m4.2.2.1.1.1.3.3.3.3" xref="S4.SS2.p1.5.m4.2.2.1.1.1.3.3.3.3.cmml">
             <mi id="S4.SS2.p1.5.m4.2.2.1.1.1.3.3.3.3.2.2" xref="S4.SS2.p1.5.m4.2.2.1.1.1.3.3.3.3.2.2.cmml">
              w
             </mi>
             <mi id="S4.SS2.p1.5.m4.2.2.1.1.1.3.3.3.3.2.3" xref="S4.SS2.p1.5.m4.2.2.1.1.1.3.3.3.3.2.3.cmml">
              t
             </mi>
             <mi id="S4.SS2.p1.5.m4.2.2.1.1.1.3.3.3.3.3" xref="S4.SS2.p1.5.m4.2.2.1.1.1.3.3.3.3.3.cmml">
              j
             </mi>
            </msubsup>
            <mo id="S4.SS2.p1.5.m4.2.2.1.1.1.3.3.3.7" stretchy="false" xref="S4.SS2.p1.5.m4.2.2.1.1.1.3.3.4.cmml">
             )
            </mo>
           </mrow>
          </mrow>
          <mo id="S4.SS2.p1.5.m4.2.2.1.1.1.4" xref="S4.SS2.p1.5.m4.2.2.1.1.1.4.cmml">
           /
          </mo>
          <mi id="S4.SS2.p1.5.m4.2.2.1.1.1.5" xref="S4.SS2.p1.5.m4.2.2.1.1.1.5.cmml">
           β
          </mi>
         </mrow>
         <mo id="S4.SS2.p1.5.m4.2.2.1.1.3" stretchy="false" xref="S4.SS2.p1.5.m4.2.2.2.cmml">
          )
         </mo>
        </mrow>
       </mrow>
       <annotation-xml encoding="MathML-Content" id="S4.SS2.p1.5.m4.2b">
        <apply id="S4.SS2.p1.5.m4.2.2.2.cmml" xref="S4.SS2.p1.5.m4.2.2.1">
         <exp id="S4.SS2.p1.5.m4.1.1.cmml" xref="S4.SS2.p1.5.m4.1.1">
         </exp>
         <apply id="S4.SS2.p1.5.m4.2.2.1.1.1.cmml" xref="S4.SS2.p1.5.m4.2.2.1.1.1">
          <divide id="S4.SS2.p1.5.m4.2.2.1.1.1.4.cmml" xref="S4.SS2.p1.5.m4.2.2.1.1.1.4">
          </divide>
          <apply id="S4.SS2.p1.5.m4.2.2.1.1.1.3.cmml" xref="S4.SS2.p1.5.m4.2.2.1.1.1.3">
           <times id="S4.SS2.p1.5.m4.2.2.1.1.1.3.4.cmml" xref="S4.SS2.p1.5.m4.2.2.1.1.1.3.4">
           </times>
           <ci id="S4.SS2.p1.5.m4.2.2.1.1.1.3.5.cmml" xref="S4.SS2.p1.5.m4.2.2.1.1.1.3.5">
            𝑄
           </ci>
           <vector id="S4.SS2.p1.5.m4.2.2.1.1.1.3.3.4.cmml" xref="S4.SS2.p1.5.m4.2.2.1.1.1.3.3.3">
            <apply id="S4.SS2.p1.5.m4.2.2.1.1.1.1.1.1.1.cmml" xref="S4.SS2.p1.5.m4.2.2.1.1.1.1.1.1.1">
             <csymbol cd="ambiguous" id="S4.SS2.p1.5.m4.2.2.1.1.1.1.1.1.1.1.cmml" xref="S4.SS2.p1.5.m4.2.2.1.1.1.1.1.1.1">
              subscript
             </csymbol>
             <ci id="S4.SS2.p1.5.m4.2.2.1.1.1.1.1.1.1.2.cmml" xref="S4.SS2.p1.5.m4.2.2.1.1.1.1.1.1.1.2">
              𝑠
             </ci>
             <ci id="S4.SS2.p1.5.m4.2.2.1.1.1.1.1.1.1.3.cmml" xref="S4.SS2.p1.5.m4.2.2.1.1.1.1.1.1.1.3">
              𝑡
             </ci>
            </apply>
            <apply id="S4.SS2.p1.5.m4.2.2.1.1.1.2.2.2.2.cmml" xref="S4.SS2.p1.5.m4.2.2.1.1.1.2.2.2.2">
             <csymbol cd="ambiguous" id="S4.SS2.p1.5.m4.2.2.1.1.1.2.2.2.2.1.cmml" xref="S4.SS2.p1.5.m4.2.2.1.1.1.2.2.2.2">
              superscript
             </csymbol>
             <apply id="S4.SS2.p1.5.m4.2.2.1.1.1.2.2.2.2.2.cmml" xref="S4.SS2.p1.5.m4.2.2.1.1.1.2.2.2.2">
              <csymbol cd="ambiguous" id="S4.SS2.p1.5.m4.2.2.1.1.1.2.2.2.2.2.1.cmml" xref="S4.SS2.p1.5.m4.2.2.1.1.1.2.2.2.2">
               subscript
              </csymbol>
              <ci id="S4.SS2.p1.5.m4.2.2.1.1.1.2.2.2.2.2.2.cmml" xref="S4.SS2.p1.5.m4.2.2.1.1.1.2.2.2.2.2.2">
               𝑤
              </ci>
              <ci id="S4.SS2.p1.5.m4.2.2.1.1.1.2.2.2.2.2.3.cmml" xref="S4.SS2.p1.5.m4.2.2.1.1.1.2.2.2.2.2.3">
               𝑡
              </ci>
             </apply>
             <apply id="S4.SS2.p1.5.m4.2.2.1.1.1.2.2.2.2.3.cmml" xref="S4.SS2.p1.5.m4.2.2.1.1.1.2.2.2.2.3">
              <ci id="S4.SS2.p1.5.m4.2.2.1.1.1.2.2.2.2.3.1.cmml" xref="S4.SS2.p1.5.m4.2.2.1.1.1.2.2.2.2.3.1">
               :
              </ci>
              <cn id="S4.SS2.p1.5.m4.2.2.1.1.1.2.2.2.2.3.2.cmml" type="integer" xref="S4.SS2.p1.5.m4.2.2.1.1.1.2.2.2.2.3.2">
               1
              </cn>
              <apply id="S4.SS2.p1.5.m4.2.2.1.1.1.2.2.2.2.3.3.cmml" xref="S4.SS2.p1.5.m4.2.2.1.1.1.2.2.2.2.3.3">
               <minus id="S4.SS2.p1.5.m4.2.2.1.1.1.2.2.2.2.3.3.1.cmml" xref="S4.SS2.p1.5.m4.2.2.1.1.1.2.2.2.2.3.3.1">
               </minus>
               <ci id="S4.SS2.p1.5.m4.2.2.1.1.1.2.2.2.2.3.3.2.cmml" xref="S4.SS2.p1.5.m4.2.2.1.1.1.2.2.2.2.3.3.2">
                𝑗
               </ci>
               <cn id="S4.SS2.p1.5.m4.2.2.1.1.1.2.2.2.2.3.3.3.cmml" type="integer" xref="S4.SS2.p1.5.m4.2.2.1.1.1.2.2.2.2.3.3.3">
                1
               </cn>
              </apply>
             </apply>
            </apply>
            <apply id="S4.SS2.p1.5.m4.2.2.1.1.1.3.3.3.3.cmml" xref="S4.SS2.p1.5.m4.2.2.1.1.1.3.3.3.3">
             <csymbol cd="ambiguous" id="S4.SS2.p1.5.m4.2.2.1.1.1.3.3.3.3.1.cmml" xref="S4.SS2.p1.5.m4.2.2.1.1.1.3.3.3.3">
              superscript
             </csymbol>
             <apply id="S4.SS2.p1.5.m4.2.2.1.1.1.3.3.3.3.2.cmml" xref="S4.SS2.p1.5.m4.2.2.1.1.1.3.3.3.3">
              <csymbol cd="ambiguous" id="S4.SS2.p1.5.m4.2.2.1.1.1.3.3.3.3.2.1.cmml" xref="S4.SS2.p1.5.m4.2.2.1.1.1.3.3.3.3">
               subscript
              </csymbol>
              <ci id="S4.SS2.p1.5.m4.2.2.1.1.1.3.3.3.3.2.2.cmml" xref="S4.SS2.p1.5.m4.2.2.1.1.1.3.3.3.3.2.2">
               𝑤
              </ci>
              <ci id="S4.SS2.p1.5.m4.2.2.1.1.1.3.3.3.3.2.3.cmml" xref="S4.SS2.p1.5.m4.2.2.1.1.1.3.3.3.3.2.3">
               𝑡
              </ci>
             </apply>
             <ci id="S4.SS2.p1.5.m4.2.2.1.1.1.3.3.3.3.3.cmml" xref="S4.SS2.p1.5.m4.2.2.1.1.1.3.3.3.3.3">
              𝑗
             </ci>
            </apply>
           </vector>
          </apply>
          <ci id="S4.SS2.p1.5.m4.2.2.1.1.1.5.cmml" xref="S4.SS2.p1.5.m4.2.2.1.1.1.5">
           𝛽
          </ci>
         </apply>
        </apply>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="S4.SS2.p1.5.m4.2c">
        \exp(Q(s_{t},w_{t}^{1:j-1},w_{t}^{j})/\beta)
       </annotation>
      </semantics>
     </math>
     , which is somewhat similar to the policy update process in SAC. Our per-token policy update scheme is to minimize the objective
     <math alttext="\mathcal{J}_{Q}(\pi)" class="ltx_Math" display="inline" id="S4.SS2.p1.6.m5.1">
      <semantics id="S4.SS2.p1.6.m5.1a">
       <mrow id="S4.SS2.p1.6.m5.1.2" xref="S4.SS2.p1.6.m5.1.2.cmml">
        <msub id="S4.SS2.p1.6.m5.1.2.2" xref="S4.SS2.p1.6.m5.1.2.2.cmml">
         <mi class="ltx_font_mathcaligraphic" id="S4.SS2.p1.6.m5.1.2.2.2" xref="S4.SS2.p1.6.m5.1.2.2.2.cmml">
          𝒥
         </mi>
         <mi id="S4.SS2.p1.6.m5.1.2.2.3" xref="S4.SS2.p1.6.m5.1.2.2.3.cmml">
          Q
         </mi>
        </msub>
        <mo id="S4.SS2.p1.6.m5.1.2.1" lspace="0em" rspace="0em" xref="S4.SS2.p1.6.m5.1.2.1.cmml">
         ​
        </mo>
        <mrow id="S4.SS2.p1.6.m5.1.2.3.2" xref="S4.SS2.p1.6.m5.1.2.cmml">
         <mo id="S4.SS2.p1.6.m5.1.2.3.2.1" stretchy="false" xref="S4.SS2.p1.6.m5.1.2.cmml">
          (
         </mo>
         <mi id="S4.SS2.p1.6.m5.1.1" xref="S4.SS2.p1.6.m5.1.1.cmml">
          π
         </mi>
         <mo id="S4.SS2.p1.6.m5.1.2.3.2.2" stretchy="false" xref="S4.SS2.p1.6.m5.1.2.cmml">
          )
         </mo>
        </mrow>
       </mrow>
       <annotation-xml encoding="MathML-Content" id="S4.SS2.p1.6.m5.1b">
        <apply id="S4.SS2.p1.6.m5.1.2.cmml" xref="S4.SS2.p1.6.m5.1.2">
         <times id="S4.SS2.p1.6.m5.1.2.1.cmml" xref="S4.SS2.p1.6.m5.1.2.1">
         </times>
         <apply id="S4.SS2.p1.6.m5.1.2.2.cmml" xref="S4.SS2.p1.6.m5.1.2.2">
          <csymbol cd="ambiguous" id="S4.SS2.p1.6.m5.1.2.2.1.cmml" xref="S4.SS2.p1.6.m5.1.2.2">
           subscript
          </csymbol>
          <ci id="S4.SS2.p1.6.m5.1.2.2.2.cmml" xref="S4.SS2.p1.6.m5.1.2.2.2">
           𝒥
          </ci>
          <ci id="S4.SS2.p1.6.m5.1.2.2.3.cmml" xref="S4.SS2.p1.6.m5.1.2.2.3">
           𝑄
          </ci>
         </apply>
         <ci id="S4.SS2.p1.6.m5.1.1.cmml" xref="S4.SS2.p1.6.m5.1.1">
          𝜋
         </ci>
        </apply>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="S4.SS2.p1.6.m5.1c">
        \mathcal{J}_{Q}(\pi)
       </annotation>
      </semantics>
     </math>
     in Equation
     <a class="ltx_ref" href="#S4.E7" title="Equation 7 ‣ 4 Entropy-Regularized Token-Level Policy Optimization ‣ Entropy-Regularized Token-Level Policy Optimization for Large Language Models">
      <span class="ltx_text ltx_ref_tag">
       7
      </span>
     </a>
     .
    </p>
   </div>
  </section>
  <section class="ltx_subsection" id="S4.SS3">
   <h3 class="ltx_title ltx_title_subsection">
    <span class="ltx_tag ltx_tag_subsection">
     4.3
    </span>
    A Practical Algorithm
   </h3>
   <div class="ltx_para" id="S4.SS3.p1">
    <p class="ltx_p" id="S4.SS3.p1.5">
     In practice, we draw a concrete algorithm of ETPO with pseudo-code shown in the Algorithm
     <a class="ltx_ref" href="#alg1" title="Algorithm 1 ‣ 4.3 A Practical Algorithm ‣ 4 Entropy-Regularized Token-Level Policy Optimization ‣ Entropy-Regularized Token-Level Policy Optimization for Large Language Models">
      <span class="ltx_text ltx_ref_tag">
       1
      </span>
     </a>
     . Since we don’t want the learned strategy to deviate too far from the original LLM, we constraint the distribution to the original language model
     <math alttext="\rho" class="ltx_Math" display="inline" id="S4.SS3.p1.1.m1.1">
      <semantics id="S4.SS3.p1.1.m1.1a">
       <mi id="S4.SS3.p1.1.m1.1.1" xref="S4.SS3.p1.1.m1.1.1.cmml">
        ρ
       </mi>
       <annotation-xml encoding="MathML-Content" id="S4.SS3.p1.1.m1.1b">
        <ci id="S4.SS3.p1.1.m1.1.1.cmml" xref="S4.SS3.p1.1.m1.1.1">
         𝜌
        </ci>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="S4.SS3.p1.1.m1.1c">
        \rho
       </annotation>
      </semantics>
     </math>
     by setting the reference policy
     <math alttext="\bar{\pi}=\rho" class="ltx_Math" display="inline" id="S4.SS3.p1.2.m2.1">
      <semantics id="S4.SS3.p1.2.m2.1a">
       <mrow id="S4.SS3.p1.2.m2.1.1" xref="S4.SS3.p1.2.m2.1.1.cmml">
        <mover accent="true" id="S4.SS3.p1.2.m2.1.1.2" xref="S4.SS3.p1.2.m2.1.1.2.cmml">
         <mi id="S4.SS3.p1.2.m2.1.1.2.2" xref="S4.SS3.p1.2.m2.1.1.2.2.cmml">
          π
         </mi>
         <mo id="S4.SS3.p1.2.m2.1.1.2.1" xref="S4.SS3.p1.2.m2.1.1.2.1.cmml">
          ¯
         </mo>
        </mover>
        <mo id="S4.SS3.p1.2.m2.1.1.1" xref="S4.SS3.p1.2.m2.1.1.1.cmml">
         =
        </mo>
        <mi id="S4.SS3.p1.2.m2.1.1.3" xref="S4.SS3.p1.2.m2.1.1.3.cmml">
         ρ
        </mi>
       </mrow>
       <annotation-xml encoding="MathML-Content" id="S4.SS3.p1.2.m2.1b">
        <apply id="S4.SS3.p1.2.m2.1.1.cmml" xref="S4.SS3.p1.2.m2.1.1">
         <eq id="S4.SS3.p1.2.m2.1.1.1.cmml" xref="S4.SS3.p1.2.m2.1.1.1">
         </eq>
         <apply id="S4.SS3.p1.2.m2.1.1.2.cmml" xref="S4.SS3.p1.2.m2.1.1.2">
          <ci id="S4.SS3.p1.2.m2.1.1.2.1.cmml" xref="S4.SS3.p1.2.m2.1.1.2.1">
           ¯
          </ci>
          <ci id="S4.SS3.p1.2.m2.1.1.2.2.cmml" xref="S4.SS3.p1.2.m2.1.1.2.2">
           𝜋
          </ci>
         </apply>
         <ci id="S4.SS3.p1.2.m2.1.1.3.cmml" xref="S4.SS3.p1.2.m2.1.1.3">
          𝜌
         </ci>
        </apply>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="S4.SS3.p1.2.m2.1c">
        \bar{\pi}=\rho
       </annotation>
      </semantics>
     </math>
     . As for pre-trained LLMs, their output distribution implies their preference for each token, thus the soft Q-network
     <math alttext="Q_{\theta}" class="ltx_Math" display="inline" id="S4.SS3.p1.3.m3.1">
      <semantics id="S4.SS3.p1.3.m3.1a">
       <msub id="S4.SS3.p1.3.m3.1.1" xref="S4.SS3.p1.3.m3.1.1.cmml">
        <mi id="S4.SS3.p1.3.m3.1.1.2" xref="S4.SS3.p1.3.m3.1.1.2.cmml">
         Q
        </mi>
        <mi id="S4.SS3.p1.3.m3.1.1.3" xref="S4.SS3.p1.3.m3.1.1.3.cmml">
         θ
        </mi>
       </msub>
       <annotation-xml encoding="MathML-Content" id="S4.SS3.p1.3.m3.1b">
        <apply id="S4.SS3.p1.3.m3.1.1.cmml" xref="S4.SS3.p1.3.m3.1.1">
         <csymbol cd="ambiguous" id="S4.SS3.p1.3.m3.1.1.1.cmml" xref="S4.SS3.p1.3.m3.1.1">
          subscript
         </csymbol>
         <ci id="S4.SS3.p1.3.m3.1.1.2.cmml" xref="S4.SS3.p1.3.m3.1.1.2">
          𝑄
         </ci>
         <ci id="S4.SS3.p1.3.m3.1.1.3.cmml" xref="S4.SS3.p1.3.m3.1.1.3">
          𝜃
         </ci>
        </apply>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="S4.SS3.p1.3.m3.1c">
        Q_{\theta}
       </annotation>
      </semantics>
     </math>
     is initialized with
     <math alttext="\rho" class="ltx_Math" display="inline" id="S4.SS3.p1.4.m4.1">
      <semantics id="S4.SS3.p1.4.m4.1a">
       <mi id="S4.SS3.p1.4.m4.1.1" xref="S4.SS3.p1.4.m4.1.1.cmml">
        ρ
       </mi>
       <annotation-xml encoding="MathML-Content" id="S4.SS3.p1.4.m4.1b">
        <ci id="S4.SS3.p1.4.m4.1.1.cmml" xref="S4.SS3.p1.4.m4.1.1">
         𝜌
        </ci>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="S4.SS3.p1.4.m4.1c">
        \rho
       </annotation>
      </semantics>
     </math>
     as well. Besides, Our algorithm makes use of a target soft Q-network
     <math alttext="Q_{\bar{\theta}}" class="ltx_Math" display="inline" id="S4.SS3.p1.5.m5.1">
      <semantics id="S4.SS3.p1.5.m5.1a">
       <msub id="S4.SS3.p1.5.m5.1.1" xref="S4.SS3.p1.5.m5.1.1.cmml">
        <mi id="S4.SS3.p1.5.m5.1.1.2" xref="S4.SS3.p1.5.m5.1.1.2.cmml">
         Q
        </mi>
        <mover accent="true" id="S4.SS3.p1.5.m5.1.1.3" xref="S4.SS3.p1.5.m5.1.1.3.cmml">
         <mi id="S4.SS3.p1.5.m5.1.1.3.2" xref="S4.SS3.p1.5.m5.1.1.3.2.cmml">
          θ
         </mi>
         <mo id="S4.SS3.p1.5.m5.1.1.3.1" xref="S4.SS3.p1.5.m5.1.1.3.1.cmml">
          ¯
         </mo>
        </mover>
       </msub>
       <annotation-xml encoding="MathML-Content" id="S4.SS3.p1.5.m5.1b">
        <apply id="S4.SS3.p1.5.m5.1.1.cmml" xref="S4.SS3.p1.5.m5.1.1">
         <csymbol cd="ambiguous" id="S4.SS3.p1.5.m5.1.1.1.cmml" xref="S4.SS3.p1.5.m5.1.1">
          subscript
         </csymbol>
         <ci id="S4.SS3.p1.5.m5.1.1.2.cmml" xref="S4.SS3.p1.5.m5.1.1.2">
          𝑄
         </ci>
         <apply id="S4.SS3.p1.5.m5.1.1.3.cmml" xref="S4.SS3.p1.5.m5.1.1.3">
          <ci id="S4.SS3.p1.5.m5.1.1.3.1.cmml" xref="S4.SS3.p1.5.m5.1.1.3.1">
           ¯
          </ci>
          <ci id="S4.SS3.p1.5.m5.1.1.3.2.cmml" xref="S4.SS3.p1.5.m5.1.1.3.2">
           𝜃
          </ci>
         </apply>
        </apply>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="S4.SS3.p1.5.m5.1c">
        Q_{\bar{\theta}}
       </annotation>
      </semantics>
     </math>
     to facilitate a stable learning process, whose parameters are updated softly.
    </p>
   </div>
   <figure class="ltx_float ltx_float_algorithm ltx_framed ltx_framed_top" id="alg1">
    <figcaption class="ltx_caption">
     <span class="ltx_tag ltx_tag_float">
      <span class="ltx_text ltx_font_bold" id="alg1.2.1.1">
       Algorithm 1
      </span>
     </span>
     ETPO Algorithm.
    </figcaption>
    <div class="ltx_listing ltx_listing" id="alg1.3">
     <div class="ltx_listingline" id="alg1.l1">
      <span class="ltx_text ltx_font_bold" id="alg1.l1.1">
       Input:
      </span>
      LLM
      <math alttext="\rho" class="ltx_Math" display="inline" id="alg1.l1.m1.1">
       <semantics id="alg1.l1.m1.1a">
        <mi id="alg1.l1.m1.1.1" xref="alg1.l1.m1.1.1.cmml">
         ρ
        </mi>
        <annotation-xml encoding="MathML-Content" id="alg1.l1.m1.1b">
         <ci id="alg1.l1.m1.1.1.cmml" xref="alg1.l1.m1.1.1">
          𝜌
         </ci>
        </annotation-xml>
        <annotation encoding="application/x-tex" id="alg1.l1.m1.1c">
         \rho
        </annotation>
       </semantics>
      </math>
      , Learning rate
      <math alttext="\alpha" class="ltx_Math" display="inline" id="alg1.l1.m2.1">
       <semantics id="alg1.l1.m2.1a">
        <mi id="alg1.l1.m2.1.1" xref="alg1.l1.m2.1.1.cmml">
         α
        </mi>
        <annotation-xml encoding="MathML-Content" id="alg1.l1.m2.1b">
         <ci id="alg1.l1.m2.1.1.cmml" xref="alg1.l1.m2.1.1">
          𝛼
         </ci>
        </annotation-xml>
        <annotation encoding="application/x-tex" id="alg1.l1.m2.1c">
         \alpha
        </annotation>
       </semantics>
      </math>
      , Polyak coefficient
      <math alttext="\lambda" class="ltx_Math" display="inline" id="alg1.l1.m3.1">
       <semantics id="alg1.l1.m3.1a">
        <mi id="alg1.l1.m3.1.1" xref="alg1.l1.m3.1.1.cmml">
         λ
        </mi>
        <annotation-xml encoding="MathML-Content" id="alg1.l1.m3.1b">
         <ci id="alg1.l1.m3.1.1.cmml" xref="alg1.l1.m3.1.1">
          𝜆
         </ci>
        </annotation-xml>
        <annotation encoding="application/x-tex" id="alg1.l1.m3.1c">
         \lambda
        </annotation>
       </semantics>
      </math>
     </div>
     <div class="ltx_listingline" id="alg1.l2">
      <span class="ltx_text ltx_font_bold" id="alg1.l2.1">
       Initialize:
      </span>
      <math alttext="\pi_{\phi}\leftarrow\rho,\bar{\pi}_{\bar{\phi}}\leftarrow\rho,Q_{\theta}\leftarrow\rho,Q_{\bar{\theta}}\leftarrow\rho" class="ltx_Math" display="inline" id="alg1.l2.m1.2">
       <semantics id="alg1.l2.m1.2a">
        <mrow id="alg1.l2.m1.2.2.2" xref="alg1.l2.m1.2.2.3.cmml">
         <mrow id="alg1.l2.m1.1.1.1.1" xref="alg1.l2.m1.1.1.1.1.cmml">
          <msub id="alg1.l2.m1.1.1.1.1.2" xref="alg1.l2.m1.1.1.1.1.2.cmml">
           <mi id="alg1.l2.m1.1.1.1.1.2.2" xref="alg1.l2.m1.1.1.1.1.2.2.cmml">
            π
           </mi>
           <mi id="alg1.l2.m1.1.1.1.1.2.3" xref="alg1.l2.m1.1.1.1.1.2.3.cmml">
            ϕ
           </mi>
          </msub>
          <mo id="alg1.l2.m1.1.1.1.1.1" stretchy="false" xref="alg1.l2.m1.1.1.1.1.1.cmml">
           ←
          </mo>
          <mi id="alg1.l2.m1.1.1.1.1.3" xref="alg1.l2.m1.1.1.1.1.3.cmml">
           ρ
          </mi>
         </mrow>
         <mo id="alg1.l2.m1.2.2.2.3" xref="alg1.l2.m1.2.2.3a.cmml">
          ,
         </mo>
         <mrow id="alg1.l2.m1.2.2.2.2.2" xref="alg1.l2.m1.2.2.2.2.3.cmml">
          <mrow id="alg1.l2.m1.2.2.2.2.1.1" xref="alg1.l2.m1.2.2.2.2.1.1.cmml">
           <msub id="alg1.l2.m1.2.2.2.2.1.1.2" xref="alg1.l2.m1.2.2.2.2.1.1.2.cmml">
            <mover accent="true" id="alg1.l2.m1.2.2.2.2.1.1.2.2" xref="alg1.l2.m1.2.2.2.2.1.1.2.2.cmml">
             <mi id="alg1.l2.m1.2.2.2.2.1.1.2.2.2" xref="alg1.l2.m1.2.2.2.2.1.1.2.2.2.cmml">
              π
             </mi>
             <mo id="alg1.l2.m1.2.2.2.2.1.1.2.2.1" xref="alg1.l2.m1.2.2.2.2.1.1.2.2.1.cmml">
              ¯
             </mo>
            </mover>
            <mover accent="true" id="alg1.l2.m1.2.2.2.2.1.1.2.3" xref="alg1.l2.m1.2.2.2.2.1.1.2.3.cmml">
             <mi id="alg1.l2.m1.2.2.2.2.1.1.2.3.2" xref="alg1.l2.m1.2.2.2.2.1.1.2.3.2.cmml">
              ϕ
             </mi>
             <mo id="alg1.l2.m1.2.2.2.2.1.1.2.3.1" xref="alg1.l2.m1.2.2.2.2.1.1.2.3.1.cmml">
              ¯
             </mo>
            </mover>
           </msub>
           <mo id="alg1.l2.m1.2.2.2.2.1.1.1" stretchy="false" xref="alg1.l2.m1.2.2.2.2.1.1.1.cmml">
            ←
           </mo>
           <mi id="alg1.l2.m1.2.2.2.2.1.1.3" xref="alg1.l2.m1.2.2.2.2.1.1.3.cmml">
            ρ
           </mi>
          </mrow>
          <mo id="alg1.l2.m1.2.2.2.2.2.3" xref="alg1.l2.m1.2.2.2.2.3a.cmml">
           ,
          </mo>
          <mrow id="alg1.l2.m1.2.2.2.2.2.2.2" xref="alg1.l2.m1.2.2.2.2.2.2.3.cmml">
           <mrow id="alg1.l2.m1.2.2.2.2.2.2.1.1" xref="alg1.l2.m1.2.2.2.2.2.2.1.1.cmml">
            <msub id="alg1.l2.m1.2.2.2.2.2.2.1.1.2" xref="alg1.l2.m1.2.2.2.2.2.2.1.1.2.cmml">
             <mi id="alg1.l2.m1.2.2.2.2.2.2.1.1.2.2" xref="alg1.l2.m1.2.2.2.2.2.2.1.1.2.2.cmml">
              Q
             </mi>
             <mi id="alg1.l2.m1.2.2.2.2.2.2.1.1.2.3" xref="alg1.l2.m1.2.2.2.2.2.2.1.1.2.3.cmml">
              θ
             </mi>
            </msub>
            <mo id="alg1.l2.m1.2.2.2.2.2.2.1.1.1" stretchy="false" xref="alg1.l2.m1.2.2.2.2.2.2.1.1.1.cmml">
             ←
            </mo>
            <mi id="alg1.l2.m1.2.2.2.2.2.2.1.1.3" xref="alg1.l2.m1.2.2.2.2.2.2.1.1.3.cmml">
             ρ
            </mi>
           </mrow>
           <mo id="alg1.l2.m1.2.2.2.2.2.2.2.3" xref="alg1.l2.m1.2.2.2.2.2.2.3a.cmml">
            ,
           </mo>
           <mrow id="alg1.l2.m1.2.2.2.2.2.2.2.2" xref="alg1.l2.m1.2.2.2.2.2.2.2.2.cmml">
            <msub id="alg1.l2.m1.2.2.2.2.2.2.2.2.2" xref="alg1.l2.m1.2.2.2.2.2.2.2.2.2.cmml">
             <mi id="alg1.l2.m1.2.2.2.2.2.2.2.2.2.2" xref="alg1.l2.m1.2.2.2.2.2.2.2.2.2.2.cmml">
              Q
             </mi>
             <mover accent="true" id="alg1.l2.m1.2.2.2.2.2.2.2.2.2.3" xref="alg1.l2.m1.2.2.2.2.2.2.2.2.2.3.cmml">
              <mi id="alg1.l2.m1.2.2.2.2.2.2.2.2.2.3.2" xref="alg1.l2.m1.2.2.2.2.2.2.2.2.2.3.2.cmml">
               θ
              </mi>
              <mo id="alg1.l2.m1.2.2.2.2.2.2.2.2.2.3.1" xref="alg1.l2.m1.2.2.2.2.2.2.2.2.2.3.1.cmml">
               ¯
              </mo>
             </mover>
            </msub>
            <mo id="alg1.l2.m1.2.2.2.2.2.2.2.2.1" stretchy="false" xref="alg1.l2.m1.2.2.2.2.2.2.2.2.1.cmml">
             ←
            </mo>
            <mi id="alg1.l2.m1.2.2.2.2.2.2.2.2.3" xref="alg1.l2.m1.2.2.2.2.2.2.2.2.3.cmml">
             ρ
            </mi>
           </mrow>
          </mrow>
         </mrow>
        </mrow>
        <annotation-xml encoding="MathML-Content" id="alg1.l2.m1.2b">
         <apply id="alg1.l2.m1.2.2.3.cmml" xref="alg1.l2.m1.2.2.2">
          <csymbol cd="ambiguous" id="alg1.l2.m1.2.2.3a.cmml" xref="alg1.l2.m1.2.2.2.3">
           formulae-sequence
          </csymbol>
          <apply id="alg1.l2.m1.1.1.1.1.cmml" xref="alg1.l2.m1.1.1.1.1">
           <ci id="alg1.l2.m1.1.1.1.1.1.cmml" xref="alg1.l2.m1.1.1.1.1.1">
            ←
           </ci>
           <apply id="alg1.l2.m1.1.1.1.1.2.cmml" xref="alg1.l2.m1.1.1.1.1.2">
            <csymbol cd="ambiguous" id="alg1.l2.m1.1.1.1.1.2.1.cmml" xref="alg1.l2.m1.1.1.1.1.2">
             subscript
            </csymbol>
            <ci id="alg1.l2.m1.1.1.1.1.2.2.cmml" xref="alg1.l2.m1.1.1.1.1.2.2">
             𝜋
            </ci>
            <ci id="alg1.l2.m1.1.1.1.1.2.3.cmml" xref="alg1.l2.m1.1.1.1.1.2.3">
             italic-ϕ
            </ci>
           </apply>
           <ci id="alg1.l2.m1.1.1.1.1.3.cmml" xref="alg1.l2.m1.1.1.1.1.3">
            𝜌
           </ci>
          </apply>
          <apply id="alg1.l2.m1.2.2.2.2.3.cmml" xref="alg1.l2.m1.2.2.2.2.2">
           <csymbol cd="ambiguous" id="alg1.l2.m1.2.2.2.2.3a.cmml" xref="alg1.l2.m1.2.2.2.2.2.3">
            formulae-sequence
           </csymbol>
           <apply id="alg1.l2.m1.2.2.2.2.1.1.cmml" xref="alg1.l2.m1.2.2.2.2.1.1">
            <ci id="alg1.l2.m1.2.2.2.2.1.1.1.cmml" xref="alg1.l2.m1.2.2.2.2.1.1.1">
             ←
            </ci>
            <apply id="alg1.l2.m1.2.2.2.2.1.1.2.cmml" xref="alg1.l2.m1.2.2.2.2.1.1.2">
             <csymbol cd="ambiguous" id="alg1.l2.m1.2.2.2.2.1.1.2.1.cmml" xref="alg1.l2.m1.2.2.2.2.1.1.2">
              subscript
             </csymbol>
             <apply id="alg1.l2.m1.2.2.2.2.1.1.2.2.cmml" xref="alg1.l2.m1.2.2.2.2.1.1.2.2">
              <ci id="alg1.l2.m1.2.2.2.2.1.1.2.2.1.cmml" xref="alg1.l2.m1.2.2.2.2.1.1.2.2.1">
               ¯
              </ci>
              <ci id="alg1.l2.m1.2.2.2.2.1.1.2.2.2.cmml" xref="alg1.l2.m1.2.2.2.2.1.1.2.2.2">
               𝜋
              </ci>
             </apply>
             <apply id="alg1.l2.m1.2.2.2.2.1.1.2.3.cmml" xref="alg1.l2.m1.2.2.2.2.1.1.2.3">
              <ci id="alg1.l2.m1.2.2.2.2.1.1.2.3.1.cmml" xref="alg1.l2.m1.2.2.2.2.1.1.2.3.1">
               ¯
              </ci>
              <ci id="alg1.l2.m1.2.2.2.2.1.1.2.3.2.cmml" xref="alg1.l2.m1.2.2.2.2.1.1.2.3.2">
               italic-ϕ
              </ci>
             </apply>
            </apply>
            <ci id="alg1.l2.m1.2.2.2.2.1.1.3.cmml" xref="alg1.l2.m1.2.2.2.2.1.1.3">
             𝜌
            </ci>
           </apply>
           <apply id="alg1.l2.m1.2.2.2.2.2.2.3.cmml" xref="alg1.l2.m1.2.2.2.2.2.2.2">
            <csymbol cd="ambiguous" id="alg1.l2.m1.2.2.2.2.2.2.3a.cmml" xref="alg1.l2.m1.2.2.2.2.2.2.2.3">
             formulae-sequence
            </csymbol>
            <apply id="alg1.l2.m1.2.2.2.2.2.2.1.1.cmml" xref="alg1.l2.m1.2.2.2.2.2.2.1.1">
             <ci id="alg1.l2.m1.2.2.2.2.2.2.1.1.1.cmml" xref="alg1.l2.m1.2.2.2.2.2.2.1.1.1">
              ←
             </ci>
             <apply id="alg1.l2.m1.2.2.2.2.2.2.1.1.2.cmml" xref="alg1.l2.m1.2.2.2.2.2.2.1.1.2">
              <csymbol cd="ambiguous" id="alg1.l2.m1.2.2.2.2.2.2.1.1.2.1.cmml" xref="alg1.l2.m1.2.2.2.2.2.2.1.1.2">
               subscript
              </csymbol>
              <ci id="alg1.l2.m1.2.2.2.2.2.2.1.1.2.2.cmml" xref="alg1.l2.m1.2.2.2.2.2.2.1.1.2.2">
               𝑄
              </ci>
              <ci id="alg1.l2.m1.2.2.2.2.2.2.1.1.2.3.cmml" xref="alg1.l2.m1.2.2.2.2.2.2.1.1.2.3">
               𝜃
              </ci>
             </apply>
             <ci id="alg1.l2.m1.2.2.2.2.2.2.1.1.3.cmml" xref="alg1.l2.m1.2.2.2.2.2.2.1.1.3">
              𝜌
             </ci>
            </apply>
            <apply id="alg1.l2.m1.2.2.2.2.2.2.2.2.cmml" xref="alg1.l2.m1.2.2.2.2.2.2.2.2">
             <ci id="alg1.l2.m1.2.2.2.2.2.2.2.2.1.cmml" xref="alg1.l2.m1.2.2.2.2.2.2.2.2.1">
              ←
             </ci>
             <apply id="alg1.l2.m1.2.2.2.2.2.2.2.2.2.cmml" xref="alg1.l2.m1.2.2.2.2.2.2.2.2.2">
              <csymbol cd="ambiguous" id="alg1.l2.m1.2.2.2.2.2.2.2.2.2.1.cmml" xref="alg1.l2.m1.2.2.2.2.2.2.2.2.2">
               subscript
              </csymbol>
              <ci id="alg1.l2.m1.2.2.2.2.2.2.2.2.2.2.cmml" xref="alg1.l2.m1.2.2.2.2.2.2.2.2.2.2">
               𝑄
              </ci>
              <apply id="alg1.l2.m1.2.2.2.2.2.2.2.2.2.3.cmml" xref="alg1.l2.m1.2.2.2.2.2.2.2.2.2.3">
               <ci id="alg1.l2.m1.2.2.2.2.2.2.2.2.2.3.1.cmml" xref="alg1.l2.m1.2.2.2.2.2.2.2.2.2.3.1">
                ¯
               </ci>
               <ci id="alg1.l2.m1.2.2.2.2.2.2.2.2.2.3.2.cmml" xref="alg1.l2.m1.2.2.2.2.2.2.2.2.2.3.2">
                𝜃
               </ci>
              </apply>
             </apply>
             <ci id="alg1.l2.m1.2.2.2.2.2.2.2.2.3.cmml" xref="alg1.l2.m1.2.2.2.2.2.2.2.2.3">
              𝜌
             </ci>
            </apply>
           </apply>
          </apply>
         </apply>
        </annotation-xml>
        <annotation encoding="application/x-tex" id="alg1.l2.m1.2c">
         \pi_{\phi}\leftarrow\rho,\bar{\pi}_{\bar{\phi}}\leftarrow\rho,Q_{\theta}\leftarrow\rho,Q_{\bar{\theta}}\leftarrow\rho
        </annotation>
       </semantics>
      </math>
     </div>
     <div class="ltx_listingline" id="alg1.l3">
      <span class="ltx_text ltx_font_bold" id="alg1.l3.1">
       Initialize:
      </span>
      Data buffer
      <math alttext="\mathcal{D}\leftarrow\emptyset" class="ltx_Math" display="inline" id="alg1.l3.m1.1">
       <semantics id="alg1.l3.m1.1a">
        <mrow id="alg1.l3.m1.1.1" xref="alg1.l3.m1.1.1.cmml">
         <mi class="ltx_font_mathcaligraphic" id="alg1.l3.m1.1.1.2" xref="alg1.l3.m1.1.1.2.cmml">
          𝒟
         </mi>
         <mo id="alg1.l3.m1.1.1.1" stretchy="false" xref="alg1.l3.m1.1.1.1.cmml">
          ←
         </mo>
         <mi id="alg1.l3.m1.1.1.3" mathvariant="normal" xref="alg1.l3.m1.1.1.3.cmml">
          ∅
         </mi>
        </mrow>
        <annotation-xml encoding="MathML-Content" id="alg1.l3.m1.1b">
         <apply id="alg1.l3.m1.1.1.cmml" xref="alg1.l3.m1.1.1">
          <ci id="alg1.l3.m1.1.1.1.cmml" xref="alg1.l3.m1.1.1.1">
           ←
          </ci>
          <ci id="alg1.l3.m1.1.1.2.cmml" xref="alg1.l3.m1.1.1.2">
           𝒟
          </ci>
          <emptyset id="alg1.l3.m1.1.1.3.cmml" xref="alg1.l3.m1.1.1.3">
          </emptyset>
         </apply>
        </annotation-xml>
        <annotation encoding="application/x-tex" id="alg1.l3.m1.1c">
         \mathcal{D}\leftarrow\emptyset
        </annotation>
       </semantics>
      </math>
     </div>
     <div class="ltx_listingline" id="alg1.l4">
      <span class="ltx_text ltx_font_bold" id="alg1.l4.1">
       for
      </span>
      each epoch
      <span class="ltx_text ltx_font_bold" id="alg1.l4.2">
       do
      </span>
     </div>
     <div class="ltx_listingline" id="alg1.l5">
      <span class="ltx_text ltx_font_bold" id="alg1.l5.1">
       for
      </span>
      <math alttext="t=0" class="ltx_Math" display="inline" id="alg1.l5.m1.1">
       <semantics id="alg1.l5.m1.1a">
        <mrow id="alg1.l5.m1.1.1" xref="alg1.l5.m1.1.1.cmml">
         <mi id="alg1.l5.m1.1.1.2" xref="alg1.l5.m1.1.1.2.cmml">
          t
         </mi>
         <mo id="alg1.l5.m1.1.1.1" xref="alg1.l5.m1.1.1.1.cmml">
          =
         </mo>
         <mn id="alg1.l5.m1.1.1.3" xref="alg1.l5.m1.1.1.3.cmml">
          0
         </mn>
        </mrow>
        <annotation-xml encoding="MathML-Content" id="alg1.l5.m1.1b">
         <apply id="alg1.l5.m1.1.1.cmml" xref="alg1.l5.m1.1.1">
          <eq id="alg1.l5.m1.1.1.1.cmml" xref="alg1.l5.m1.1.1.1">
          </eq>
          <ci id="alg1.l5.m1.1.1.2.cmml" xref="alg1.l5.m1.1.1.2">
           𝑡
          </ci>
          <cn id="alg1.l5.m1.1.1.3.cmml" type="integer" xref="alg1.l5.m1.1.1.3">
           0
          </cn>
         </apply>
        </annotation-xml>
        <annotation encoding="application/x-tex" id="alg1.l5.m1.1c">
         t=0
        </annotation>
       </semantics>
      </math>
      <span class="ltx_text ltx_font_bold" id="alg1.l5.2">
       to
      </span>
      <math alttext="T-1" class="ltx_Math" display="inline" id="alg1.l5.m2.1">
       <semantics id="alg1.l5.m2.1a">
        <mrow id="alg1.l5.m2.1.1" xref="alg1.l5.m2.1.1.cmml">
         <mi id="alg1.l5.m2.1.1.2" xref="alg1.l5.m2.1.1.2.cmml">
          T
         </mi>
         <mo id="alg1.l5.m2.1.1.1" xref="alg1.l5.m2.1.1.1.cmml">
          −
         </mo>
         <mn id="alg1.l5.m2.1.1.3" xref="alg1.l5.m2.1.1.3.cmml">
          1
         </mn>
        </mrow>
        <annotation-xml encoding="MathML-Content" id="alg1.l5.m2.1b">
         <apply id="alg1.l5.m2.1.1.cmml" xref="alg1.l5.m2.1.1">
          <minus id="alg1.l5.m2.1.1.1.cmml" xref="alg1.l5.m2.1.1.1">
          </minus>
          <ci id="alg1.l5.m2.1.1.2.cmml" xref="alg1.l5.m2.1.1.2">
           𝑇
          </ci>
          <cn id="alg1.l5.m2.1.1.3.cmml" type="integer" xref="alg1.l5.m2.1.1.3">
           1
          </cn>
         </apply>
        </annotation-xml>
        <annotation encoding="application/x-tex" id="alg1.l5.m2.1c">
         T-1
        </annotation>
       </semantics>
      </math>
      <span class="ltx_text ltx_font_bold" id="alg1.l5.3">
       do
      </span>
     </div>
     <div class="ltx_listingline" id="alg1.l6">
      Collect
      <math alttext="s_{t}" class="ltx_Math" display="inline" id="alg1.l6.m1.1">
       <semantics id="alg1.l6.m1.1a">
        <msub id="alg1.l6.m1.1.1" xref="alg1.l6.m1.1.1.cmml">
         <mi id="alg1.l6.m1.1.1.2" xref="alg1.l6.m1.1.1.2.cmml">
          s
         </mi>
         <mi id="alg1.l6.m1.1.1.3" xref="alg1.l6.m1.1.1.3.cmml">
          t
         </mi>
        </msub>
        <annotation-xml encoding="MathML-Content" id="alg1.l6.m1.1b">
         <apply id="alg1.l6.m1.1.1.cmml" xref="alg1.l6.m1.1.1">
          <csymbol cd="ambiguous" id="alg1.l6.m1.1.1.1.cmml" xref="alg1.l6.m1.1.1">
           subscript
          </csymbol>
          <ci id="alg1.l6.m1.1.1.2.cmml" xref="alg1.l6.m1.1.1.2">
           𝑠
          </ci>
          <ci id="alg1.l6.m1.1.1.3.cmml" xref="alg1.l6.m1.1.1.3">
           𝑡
          </ci>
         </apply>
        </annotation-xml>
        <annotation encoding="application/x-tex" id="alg1.l6.m1.1c">
         s_{t}
        </annotation>
       </semantics>
      </math>
      .
     </div>
     <div class="ltx_listingline" id="alg1.l7">
      <math alttext="a_{t}\sim\pi_{\phi}(a_{t}|s_{t})" class="ltx_Math" display="inline" id="alg1.l7.m1.1">
       <semantics id="alg1.l7.m1.1a">
        <mrow id="alg1.l7.m1.1.1" xref="alg1.l7.m1.1.1.cmml">
         <msub id="alg1.l7.m1.1.1.3" xref="alg1.l7.m1.1.1.3.cmml">
          <mi id="alg1.l7.m1.1.1.3.2" xref="alg1.l7.m1.1.1.3.2.cmml">
           a
          </mi>
          <mi id="alg1.l7.m1.1.1.3.3" xref="alg1.l7.m1.1.1.3.3.cmml">
           t
          </mi>
         </msub>
         <mo id="alg1.l7.m1.1.1.2" xref="alg1.l7.m1.1.1.2.cmml">
          ∼
         </mo>
         <mrow id="alg1.l7.m1.1.1.1" xref="alg1.l7.m1.1.1.1.cmml">
          <msub id="alg1.l7.m1.1.1.1.3" xref="alg1.l7.m1.1.1.1.3.cmml">
           <mi id="alg1.l7.m1.1.1.1.3.2" xref="alg1.l7.m1.1.1.1.3.2.cmml">
            π
           </mi>
           <mi id="alg1.l7.m1.1.1.1.3.3" xref="alg1.l7.m1.1.1.1.3.3.cmml">
            ϕ
           </mi>
          </msub>
          <mo id="alg1.l7.m1.1.1.1.2" lspace="0em" rspace="0em" xref="alg1.l7.m1.1.1.1.2.cmml">
           ​
          </mo>
          <mrow id="alg1.l7.m1.1.1.1.1.1" xref="alg1.l7.m1.1.1.1.1.1.1.cmml">
           <mo id="alg1.l7.m1.1.1.1.1.1.2" stretchy="false" xref="alg1.l7.m1.1.1.1.1.1.1.cmml">
            (
           </mo>
           <mrow id="alg1.l7.m1.1.1.1.1.1.1" xref="alg1.l7.m1.1.1.1.1.1.1.cmml">
            <msub id="alg1.l7.m1.1.1.1.1.1.1.2" xref="alg1.l7.m1.1.1.1.1.1.1.2.cmml">
             <mi id="alg1.l7.m1.1.1.1.1.1.1.2.2" xref="alg1.l7.m1.1.1.1.1.1.1.2.2.cmml">
              a
             </mi>
             <mi id="alg1.l7.m1.1.1.1.1.1.1.2.3" xref="alg1.l7.m1.1.1.1.1.1.1.2.3.cmml">
              t
             </mi>
            </msub>
            <mo fence="false" id="alg1.l7.m1.1.1.1.1.1.1.1" xref="alg1.l7.m1.1.1.1.1.1.1.1.cmml">
             |
            </mo>
            <msub id="alg1.l7.m1.1.1.1.1.1.1.3" xref="alg1.l7.m1.1.1.1.1.1.1.3.cmml">
             <mi id="alg1.l7.m1.1.1.1.1.1.1.3.2" xref="alg1.l7.m1.1.1.1.1.1.1.3.2.cmml">
              s
             </mi>
             <mi id="alg1.l7.m1.1.1.1.1.1.1.3.3" xref="alg1.l7.m1.1.1.1.1.1.1.3.3.cmml">
              t
             </mi>
            </msub>
           </mrow>
           <mo id="alg1.l7.m1.1.1.1.1.1.3" stretchy="false" xref="alg1.l7.m1.1.1.1.1.1.1.cmml">
            )
           </mo>
          </mrow>
         </mrow>
        </mrow>
        <annotation-xml encoding="MathML-Content" id="alg1.l7.m1.1b">
         <apply id="alg1.l7.m1.1.1.cmml" xref="alg1.l7.m1.1.1">
          <csymbol cd="latexml" id="alg1.l7.m1.1.1.2.cmml" xref="alg1.l7.m1.1.1.2">
           similar-to
          </csymbol>
          <apply id="alg1.l7.m1.1.1.3.cmml" xref="alg1.l7.m1.1.1.3">
           <csymbol cd="ambiguous" id="alg1.l7.m1.1.1.3.1.cmml" xref="alg1.l7.m1.1.1.3">
            subscript
           </csymbol>
           <ci id="alg1.l7.m1.1.1.3.2.cmml" xref="alg1.l7.m1.1.1.3.2">
            𝑎
           </ci>
           <ci id="alg1.l7.m1.1.1.3.3.cmml" xref="alg1.l7.m1.1.1.3.3">
            𝑡
           </ci>
          </apply>
          <apply id="alg1.l7.m1.1.1.1.cmml" xref="alg1.l7.m1.1.1.1">
           <times id="alg1.l7.m1.1.1.1.2.cmml" xref="alg1.l7.m1.1.1.1.2">
           </times>
           <apply id="alg1.l7.m1.1.1.1.3.cmml" xref="alg1.l7.m1.1.1.1.3">
            <csymbol cd="ambiguous" id="alg1.l7.m1.1.1.1.3.1.cmml" xref="alg1.l7.m1.1.1.1.3">
             subscript
            </csymbol>
            <ci id="alg1.l7.m1.1.1.1.3.2.cmml" xref="alg1.l7.m1.1.1.1.3.2">
             𝜋
            </ci>
            <ci id="alg1.l7.m1.1.1.1.3.3.cmml" xref="alg1.l7.m1.1.1.1.3.3">
             italic-ϕ
            </ci>
           </apply>
           <apply id="alg1.l7.m1.1.1.1.1.1.1.cmml" xref="alg1.l7.m1.1.1.1.1.1">
            <csymbol cd="latexml" id="alg1.l7.m1.1.1.1.1.1.1.1.cmml" xref="alg1.l7.m1.1.1.1.1.1.1.1">
             conditional
            </csymbol>
            <apply id="alg1.l7.m1.1.1.1.1.1.1.2.cmml" xref="alg1.l7.m1.1.1.1.1.1.1.2">
             <csymbol cd="ambiguous" id="alg1.l7.m1.1.1.1.1.1.1.2.1.cmml" xref="alg1.l7.m1.1.1.1.1.1.1.2">
              subscript
             </csymbol>
             <ci id="alg1.l7.m1.1.1.1.1.1.1.2.2.cmml" xref="alg1.l7.m1.1.1.1.1.1.1.2.2">
              𝑎
             </ci>
             <ci id="alg1.l7.m1.1.1.1.1.1.1.2.3.cmml" xref="alg1.l7.m1.1.1.1.1.1.1.2.3">
              𝑡
             </ci>
            </apply>
            <apply id="alg1.l7.m1.1.1.1.1.1.1.3.cmml" xref="alg1.l7.m1.1.1.1.1.1.1.3">
             <csymbol cd="ambiguous" id="alg1.l7.m1.1.1.1.1.1.1.3.1.cmml" xref="alg1.l7.m1.1.1.1.1.1.1.3">
              subscript
             </csymbol>
             <ci id="alg1.l7.m1.1.1.1.1.1.1.3.2.cmml" xref="alg1.l7.m1.1.1.1.1.1.1.3.2">
              𝑠
             </ci>
             <ci id="alg1.l7.m1.1.1.1.1.1.1.3.3.cmml" xref="alg1.l7.m1.1.1.1.1.1.1.3.3">
              𝑡
             </ci>
            </apply>
           </apply>
          </apply>
         </apply>
        </annotation-xml>
        <annotation encoding="application/x-tex" id="alg1.l7.m1.1c">
         a_{t}\sim\pi_{\phi}(a_{t}|s_{t})
        </annotation>
       </semantics>
      </math>
      .
     </div>
     <div class="ltx_listingline" id="alg1.l8">
      <math alttext="a_{t+1}\sim\mathcal{T}(a_{t+1}|s_{t},a_{t})" class="ltx_Math" display="inline" id="alg1.l8.m1.1">
       <semantics id="alg1.l8.m1.1a">
        <mrow id="alg1.l8.m1.1.1" xref="alg1.l8.m1.1.1.cmml">
         <msub id="alg1.l8.m1.1.1.3" xref="alg1.l8.m1.1.1.3.cmml">
          <mi id="alg1.l8.m1.1.1.3.2" xref="alg1.l8.m1.1.1.3.2.cmml">
           a
          </mi>
          <mrow id="alg1.l8.m1.1.1.3.3" xref="alg1.l8.m1.1.1.3.3.cmml">
           <mi id="alg1.l8.m1.1.1.3.3.2" xref="alg1.l8.m1.1.1.3.3.2.cmml">
            t
           </mi>
           <mo id="alg1.l8.m1.1.1.3.3.1" xref="alg1.l8.m1.1.1.3.3.1.cmml">
            +
           </mo>
           <mn id="alg1.l8.m1.1.1.3.3.3" xref="alg1.l8.m1.1.1.3.3.3.cmml">
            1
           </mn>
          </mrow>
         </msub>
         <mo id="alg1.l8.m1.1.1.2" xref="alg1.l8.m1.1.1.2.cmml">
          ∼
         </mo>
         <mrow id="alg1.l8.m1.1.1.1" xref="alg1.l8.m1.1.1.1.cmml">
          <mi class="ltx_font_mathcaligraphic" id="alg1.l8.m1.1.1.1.3" xref="alg1.l8.m1.1.1.1.3.cmml">
           𝒯
          </mi>
          <mo id="alg1.l8.m1.1.1.1.2" lspace="0em" rspace="0em" xref="alg1.l8.m1.1.1.1.2.cmml">
           ​
          </mo>
          <mrow id="alg1.l8.m1.1.1.1.1.1" xref="alg1.l8.m1.1.1.1.1.1.1.cmml">
           <mo id="alg1.l8.m1.1.1.1.1.1.2" stretchy="false" xref="alg1.l8.m1.1.1.1.1.1.1.cmml">
            (
           </mo>
           <mrow id="alg1.l8.m1.1.1.1.1.1.1" xref="alg1.l8.m1.1.1.1.1.1.1.cmml">
            <msub id="alg1.l8.m1.1.1.1.1.1.1.4" xref="alg1.l8.m1.1.1.1.1.1.1.4.cmml">
             <mi id="alg1.l8.m1.1.1.1.1.1.1.4.2" xref="alg1.l8.m1.1.1.1.1.1.1.4.2.cmml">
              a
             </mi>
             <mrow id="alg1.l8.m1.1.1.1.1.1.1.4.3" xref="alg1.l8.m1.1.1.1.1.1.1.4.3.cmml">
              <mi id="alg1.l8.m1.1.1.1.1.1.1.4.3.2" xref="alg1.l8.m1.1.1.1.1.1.1.4.3.2.cmml">
               t
              </mi>
              <mo id="alg1.l8.m1.1.1.1.1.1.1.4.3.1" xref="alg1.l8.m1.1.1.1.1.1.1.4.3.1.cmml">
               +
              </mo>
              <mn id="alg1.l8.m1.1.1.1.1.1.1.4.3.3" xref="alg1.l8.m1.1.1.1.1.1.1.4.3.3.cmml">
               1
              </mn>
             </mrow>
            </msub>
            <mo fence="false" id="alg1.l8.m1.1.1.1.1.1.1.3" xref="alg1.l8.m1.1.1.1.1.1.1.3.cmml">
             |
            </mo>
            <mrow id="alg1.l8.m1.1.1.1.1.1.1.2.2" xref="alg1.l8.m1.1.1.1.1.1.1.2.3.cmml">
             <msub id="alg1.l8.m1.1.1.1.1.1.1.1.1.1" xref="alg1.l8.m1.1.1.1.1.1.1.1.1.1.cmml">
              <mi id="alg1.l8.m1.1.1.1.1.1.1.1.1.1.2" xref="alg1.l8.m1.1.1.1.1.1.1.1.1.1.2.cmml">
               s
              </mi>
              <mi id="alg1.l8.m1.1.1.1.1.1.1.1.1.1.3" xref="alg1.l8.m1.1.1.1.1.1.1.1.1.1.3.cmml">
               t
              </mi>
             </msub>
             <mo id="alg1.l8.m1.1.1.1.1.1.1.2.2.3" xref="alg1.l8.m1.1.1.1.1.1.1.2.3.cmml">
              ,
             </mo>
             <msub id="alg1.l8.m1.1.1.1.1.1.1.2.2.2" xref="alg1.l8.m1.1.1.1.1.1.1.2.2.2.cmml">
              <mi id="alg1.l8.m1.1.1.1.1.1.1.2.2.2.2" xref="alg1.l8.m1.1.1.1.1.1.1.2.2.2.2.cmml">
               a
              </mi>
              <mi id="alg1.l8.m1.1.1.1.1.1.1.2.2.2.3" xref="alg1.l8.m1.1.1.1.1.1.1.2.2.2.3.cmml">
               t
              </mi>
             </msub>
            </mrow>
           </mrow>
           <mo id="alg1.l8.m1.1.1.1.1.1.3" stretchy="false" xref="alg1.l8.m1.1.1.1.1.1.1.cmml">
            )
           </mo>
          </mrow>
         </mrow>
        </mrow>
        <annotation-xml encoding="MathML-Content" id="alg1.l8.m1.1b">
         <apply id="alg1.l8.m1.1.1.cmml" xref="alg1.l8.m1.1.1">
          <csymbol cd="latexml" id="alg1.l8.m1.1.1.2.cmml" xref="alg1.l8.m1.1.1.2">
           similar-to
          </csymbol>
          <apply id="alg1.l8.m1.1.1.3.cmml" xref="alg1.l8.m1.1.1.3">
           <csymbol cd="ambiguous" id="alg1.l8.m1.1.1.3.1.cmml" xref="alg1.l8.m1.1.1.3">
            subscript
           </csymbol>
           <ci id="alg1.l8.m1.1.1.3.2.cmml" xref="alg1.l8.m1.1.1.3.2">
            𝑎
           </ci>
           <apply id="alg1.l8.m1.1.1.3.3.cmml" xref="alg1.l8.m1.1.1.3.3">
            <plus id="alg1.l8.m1.1.1.3.3.1.cmml" xref="alg1.l8.m1.1.1.3.3.1">
            </plus>
            <ci id="alg1.l8.m1.1.1.3.3.2.cmml" xref="alg1.l8.m1.1.1.3.3.2">
             𝑡
            </ci>
            <cn id="alg1.l8.m1.1.1.3.3.3.cmml" type="integer" xref="alg1.l8.m1.1.1.3.3.3">
             1
            </cn>
           </apply>
          </apply>
          <apply id="alg1.l8.m1.1.1.1.cmml" xref="alg1.l8.m1.1.1.1">
           <times id="alg1.l8.m1.1.1.1.2.cmml" xref="alg1.l8.m1.1.1.1.2">
           </times>
           <ci id="alg1.l8.m1.1.1.1.3.cmml" xref="alg1.l8.m1.1.1.1.3">
            𝒯
           </ci>
           <apply id="alg1.l8.m1.1.1.1.1.1.1.cmml" xref="alg1.l8.m1.1.1.1.1.1">
            <csymbol cd="latexml" id="alg1.l8.m1.1.1.1.1.1.1.3.cmml" xref="alg1.l8.m1.1.1.1.1.1.1.3">
             conditional
            </csymbol>
            <apply id="alg1.l8.m1.1.1.1.1.1.1.4.cmml" xref="alg1.l8.m1.1.1.1.1.1.1.4">
             <csymbol cd="ambiguous" id="alg1.l8.m1.1.1.1.1.1.1.4.1.cmml" xref="alg1.l8.m1.1.1.1.1.1.1.4">
              subscript
             </csymbol>
             <ci id="alg1.l8.m1.1.1.1.1.1.1.4.2.cmml" xref="alg1.l8.m1.1.1.1.1.1.1.4.2">
              𝑎
             </ci>
             <apply id="alg1.l8.m1.1.1.1.1.1.1.4.3.cmml" xref="alg1.l8.m1.1.1.1.1.1.1.4.3">
              <plus id="alg1.l8.m1.1.1.1.1.1.1.4.3.1.cmml" xref="alg1.l8.m1.1.1.1.1.1.1.4.3.1">
              </plus>
              <ci id="alg1.l8.m1.1.1.1.1.1.1.4.3.2.cmml" xref="alg1.l8.m1.1.1.1.1.1.1.4.3.2">
               𝑡
              </ci>
              <cn id="alg1.l8.m1.1.1.1.1.1.1.4.3.3.cmml" type="integer" xref="alg1.l8.m1.1.1.1.1.1.1.4.3.3">
               1
              </cn>
             </apply>
            </apply>
            <list id="alg1.l8.m1.1.1.1.1.1.1.2.3.cmml" xref="alg1.l8.m1.1.1.1.1.1.1.2.2">
             <apply id="alg1.l8.m1.1.1.1.1.1.1.1.1.1.cmml" xref="alg1.l8.m1.1.1.1.1.1.1.1.1.1">
              <csymbol cd="ambiguous" id="alg1.l8.m1.1.1.1.1.1.1.1.1.1.1.cmml" xref="alg1.l8.m1.1.1.1.1.1.1.1.1.1">
               subscript
              </csymbol>
              <ci id="alg1.l8.m1.1.1.1.1.1.1.1.1.1.2.cmml" xref="alg1.l8.m1.1.1.1.1.1.1.1.1.1.2">
               𝑠
              </ci>
              <ci id="alg1.l8.m1.1.1.1.1.1.1.1.1.1.3.cmml" xref="alg1.l8.m1.1.1.1.1.1.1.1.1.1.3">
               𝑡
              </ci>
             </apply>
             <apply id="alg1.l8.m1.1.1.1.1.1.1.2.2.2.cmml" xref="alg1.l8.m1.1.1.1.1.1.1.2.2.2">
              <csymbol cd="ambiguous" id="alg1.l8.m1.1.1.1.1.1.1.2.2.2.1.cmml" xref="alg1.l8.m1.1.1.1.1.1.1.2.2.2">
               subscript
              </csymbol>
              <ci id="alg1.l8.m1.1.1.1.1.1.1.2.2.2.2.cmml" xref="alg1.l8.m1.1.1.1.1.1.1.2.2.2.2">
               𝑎
              </ci>
              <ci id="alg1.l8.m1.1.1.1.1.1.1.2.2.2.3.cmml" xref="alg1.l8.m1.1.1.1.1.1.1.2.2.2.3">
               𝑡
              </ci>
             </apply>
            </list>
           </apply>
          </apply>
         </apply>
        </annotation-xml>
        <annotation encoding="application/x-tex" id="alg1.l8.m1.1c">
         a_{t+1}\sim\mathcal{T}(a_{t+1}|s_{t},a_{t})
        </annotation>
       </semantics>
      </math>
      .
     </div>
     <div class="ltx_listingline" id="alg1.l9">
      <math alttext="\mathcal{D}\leftarrow\mathcal{D}\cup\{(s_{t},a_{t},r(s_{t},a_{t}),s_{t+1})\}" class="ltx_Math" display="inline" id="alg1.l9.m1.1">
       <semantics id="alg1.l9.m1.1a">
        <mrow id="alg1.l9.m1.1.1" xref="alg1.l9.m1.1.1.cmml">
         <mi class="ltx_font_mathcaligraphic" id="alg1.l9.m1.1.1.3" xref="alg1.l9.m1.1.1.3.cmml">
          𝒟
         </mi>
         <mo id="alg1.l9.m1.1.1.2" stretchy="false" xref="alg1.l9.m1.1.1.2.cmml">
          ←
         </mo>
         <mrow id="alg1.l9.m1.1.1.1" xref="alg1.l9.m1.1.1.1.cmml">
          <mi class="ltx_font_mathcaligraphic" id="alg1.l9.m1.1.1.1.3" xref="alg1.l9.m1.1.1.1.3.cmml">
           𝒟
          </mi>
          <mo id="alg1.l9.m1.1.1.1.2" xref="alg1.l9.m1.1.1.1.2.cmml">
           ∪
          </mo>
          <mrow id="alg1.l9.m1.1.1.1.1.1" xref="alg1.l9.m1.1.1.1.1.2.cmml">
           <mo id="alg1.l9.m1.1.1.1.1.1.2" stretchy="false" xref="alg1.l9.m1.1.1.1.1.2.cmml">
            {
           </mo>
           <mrow id="alg1.l9.m1.1.1.1.1.1.1.4" xref="alg1.l9.m1.1.1.1.1.1.1.5.cmml">
            <mo id="alg1.l9.m1.1.1.1.1.1.1.4.5" stretchy="false" xref="alg1.l9.m1.1.1.1.1.1.1.5.cmml">
             (
            </mo>
            <msub id="alg1.l9.m1.1.1.1.1.1.1.1.1" xref="alg1.l9.m1.1.1.1.1.1.1.1.1.cmml">
             <mi id="alg1.l9.m1.1.1.1.1.1.1.1.1.2" xref="alg1.l9.m1.1.1.1.1.1.1.1.1.2.cmml">
              s
             </mi>
             <mi id="alg1.l9.m1.1.1.1.1.1.1.1.1.3" xref="alg1.l9.m1.1.1.1.1.1.1.1.1.3.cmml">
              t
             </mi>
            </msub>
            <mo id="alg1.l9.m1.1.1.1.1.1.1.4.6" xref="alg1.l9.m1.1.1.1.1.1.1.5.cmml">
             ,
            </mo>
            <msub id="alg1.l9.m1.1.1.1.1.1.1.2.2" xref="alg1.l9.m1.1.1.1.1.1.1.2.2.cmml">
             <mi id="alg1.l9.m1.1.1.1.1.1.1.2.2.2" xref="alg1.l9.m1.1.1.1.1.1.1.2.2.2.cmml">
              a
             </mi>
             <mi id="alg1.l9.m1.1.1.1.1.1.1.2.2.3" xref="alg1.l9.m1.1.1.1.1.1.1.2.2.3.cmml">
              t
             </mi>
            </msub>
            <mo id="alg1.l9.m1.1.1.1.1.1.1.4.7" xref="alg1.l9.m1.1.1.1.1.1.1.5.cmml">
             ,
            </mo>
            <mrow id="alg1.l9.m1.1.1.1.1.1.1.3.3" xref="alg1.l9.m1.1.1.1.1.1.1.3.3.cmml">
             <mi id="alg1.l9.m1.1.1.1.1.1.1.3.3.4" xref="alg1.l9.m1.1.1.1.1.1.1.3.3.4.cmml">
              r
             </mi>
             <mo id="alg1.l9.m1.1.1.1.1.1.1.3.3.3" lspace="0em" rspace="0em" xref="alg1.l9.m1.1.1.1.1.1.1.3.3.3.cmml">
              ​
             </mo>
             <mrow id="alg1.l9.m1.1.1.1.1.1.1.3.3.2.2" xref="alg1.l9.m1.1.1.1.1.1.1.3.3.2.3.cmml">
              <mo id="alg1.l9.m1.1.1.1.1.1.1.3.3.2.2.3" stretchy="false" xref="alg1.l9.m1.1.1.1.1.1.1.3.3.2.3.cmml">
               (
              </mo>
              <msub id="alg1.l9.m1.1.1.1.1.1.1.3.3.1.1.1" xref="alg1.l9.m1.1.1.1.1.1.1.3.3.1.1.1.cmml">
               <mi id="alg1.l9.m1.1.1.1.1.1.1.3.3.1.1.1.2" xref="alg1.l9.m1.1.1.1.1.1.1.3.3.1.1.1.2.cmml">
                s
               </mi>
               <mi id="alg1.l9.m1.1.1.1.1.1.1.3.3.1.1.1.3" xref="alg1.l9.m1.1.1.1.1.1.1.3.3.1.1.1.3.cmml">
                t
               </mi>
              </msub>
              <mo id="alg1.l9.m1.1.1.1.1.1.1.3.3.2.2.4" xref="alg1.l9.m1.1.1.1.1.1.1.3.3.2.3.cmml">
               ,
              </mo>
              <msub id="alg1.l9.m1.1.1.1.1.1.1.3.3.2.2.2" xref="alg1.l9.m1.1.1.1.1.1.1.3.3.2.2.2.cmml">
               <mi id="alg1.l9.m1.1.1.1.1.1.1.3.3.2.2.2.2" xref="alg1.l9.m1.1.1.1.1.1.1.3.3.2.2.2.2.cmml">
                a
               </mi>
               <mi id="alg1.l9.m1.1.1.1.1.1.1.3.3.2.2.2.3" xref="alg1.l9.m1.1.1.1.1.1.1.3.3.2.2.2.3.cmml">
                t
               </mi>
              </msub>
              <mo id="alg1.l9.m1.1.1.1.1.1.1.3.3.2.2.5" stretchy="false" xref="alg1.l9.m1.1.1.1.1.1.1.3.3.2.3.cmml">
               )
              </mo>
             </mrow>
            </mrow>
            <mo id="alg1.l9.m1.1.1.1.1.1.1.4.8" xref="alg1.l9.m1.1.1.1.1.1.1.5.cmml">
             ,
            </mo>
            <msub id="alg1.l9.m1.1.1.1.1.1.1.4.4" xref="alg1.l9.m1.1.1.1.1.1.1.4.4.cmml">
             <mi id="alg1.l9.m1.1.1.1.1.1.1.4.4.2" xref="alg1.l9.m1.1.1.1.1.1.1.4.4.2.cmml">
              s
             </mi>
             <mrow id="alg1.l9.m1.1.1.1.1.1.1.4.4.3" xref="alg1.l9.m1.1.1.1.1.1.1.4.4.3.cmml">
              <mi id="alg1.l9.m1.1.1.1.1.1.1.4.4.3.2" xref="alg1.l9.m1.1.1.1.1.1.1.4.4.3.2.cmml">
               t
              </mi>
              <mo id="alg1.l9.m1.1.1.1.1.1.1.4.4.3.1" xref="alg1.l9.m1.1.1.1.1.1.1.4.4.3.1.cmml">
               +
              </mo>
              <mn id="alg1.l9.m1.1.1.1.1.1.1.4.4.3.3" xref="alg1.l9.m1.1.1.1.1.1.1.4.4.3.3.cmml">
               1
              </mn>
             </mrow>
            </msub>
            <mo id="alg1.l9.m1.1.1.1.1.1.1.4.9" stretchy="false" xref="alg1.l9.m1.1.1.1.1.1.1.5.cmml">
             )
            </mo>
           </mrow>
           <mo id="alg1.l9.m1.1.1.1.1.1.3" stretchy="false" xref="alg1.l9.m1.1.1.1.1.2.cmml">
            }
           </mo>
          </mrow>
         </mrow>
        </mrow>
        <annotation-xml encoding="MathML-Content" id="alg1.l9.m1.1b">
         <apply id="alg1.l9.m1.1.1.cmml" xref="alg1.l9.m1.1.1">
          <ci id="alg1.l9.m1.1.1.2.cmml" xref="alg1.l9.m1.1.1.2">
           ←
          </ci>
          <ci id="alg1.l9.m1.1.1.3.cmml" xref="alg1.l9.m1.1.1.3">
           𝒟
          </ci>
          <apply id="alg1.l9.m1.1.1.1.cmml" xref="alg1.l9.m1.1.1.1">
           <union id="alg1.l9.m1.1.1.1.2.cmml" xref="alg1.l9.m1.1.1.1.2">
           </union>
           <ci id="alg1.l9.m1.1.1.1.3.cmml" xref="alg1.l9.m1.1.1.1.3">
            𝒟
           </ci>
           <set id="alg1.l9.m1.1.1.1.1.2.cmml" xref="alg1.l9.m1.1.1.1.1.1">
            <vector id="alg1.l9.m1.1.1.1.1.1.1.5.cmml" xref="alg1.l9.m1.1.1.1.1.1.1.4">
             <apply id="alg1.l9.m1.1.1.1.1.1.1.1.1.cmml" xref="alg1.l9.m1.1.1.1.1.1.1.1.1">
              <csymbol cd="ambiguous" id="alg1.l9.m1.1.1.1.1.1.1.1.1.1.cmml" xref="alg1.l9.m1.1.1.1.1.1.1.1.1">
               subscript
              </csymbol>
              <ci id="alg1.l9.m1.1.1.1.1.1.1.1.1.2.cmml" xref="alg1.l9.m1.1.1.1.1.1.1.1.1.2">
               𝑠
              </ci>
              <ci id="alg1.l9.m1.1.1.1.1.1.1.1.1.3.cmml" xref="alg1.l9.m1.1.1.1.1.1.1.1.1.3">
               𝑡
              </ci>
             </apply>
             <apply id="alg1.l9.m1.1.1.1.1.1.1.2.2.cmml" xref="alg1.l9.m1.1.1.1.1.1.1.2.2">
              <csymbol cd="ambiguous" id="alg1.l9.m1.1.1.1.1.1.1.2.2.1.cmml" xref="alg1.l9.m1.1.1.1.1.1.1.2.2">
               subscript
              </csymbol>
              <ci id="alg1.l9.m1.1.1.1.1.1.1.2.2.2.cmml" xref="alg1.l9.m1.1.1.1.1.1.1.2.2.2">
               𝑎
              </ci>
              <ci id="alg1.l9.m1.1.1.1.1.1.1.2.2.3.cmml" xref="alg1.l9.m1.1.1.1.1.1.1.2.2.3">
               𝑡
              </ci>
             </apply>
             <apply id="alg1.l9.m1.1.1.1.1.1.1.3.3.cmml" xref="alg1.l9.m1.1.1.1.1.1.1.3.3">
              <times id="alg1.l9.m1.1.1.1.1.1.1.3.3.3.cmml" xref="alg1.l9.m1.1.1.1.1.1.1.3.3.3">
              </times>
              <ci id="alg1.l9.m1.1.1.1.1.1.1.3.3.4.cmml" xref="alg1.l9.m1.1.1.1.1.1.1.3.3.4">
               𝑟
              </ci>
              <interval closure="open" id="alg1.l9.m1.1.1.1.1.1.1.3.3.2.3.cmml" xref="alg1.l9.m1.1.1.1.1.1.1.3.3.2.2">
               <apply id="alg1.l9.m1.1.1.1.1.1.1.3.3.1.1.1.cmml" xref="alg1.l9.m1.1.1.1.1.1.1.3.3.1.1.1">
                <csymbol cd="ambiguous" id="alg1.l9.m1.1.1.1.1.1.1.3.3.1.1.1.1.cmml" xref="alg1.l9.m1.1.1.1.1.1.1.3.3.1.1.1">
                 subscript
                </csymbol>
                <ci id="alg1.l9.m1.1.1.1.1.1.1.3.3.1.1.1.2.cmml" xref="alg1.l9.m1.1.1.1.1.1.1.3.3.1.1.1.2">
                 𝑠
                </ci>
                <ci id="alg1.l9.m1.1.1.1.1.1.1.3.3.1.1.1.3.cmml" xref="alg1.l9.m1.1.1.1.1.1.1.3.3.1.1.1.3">
                 𝑡
                </ci>
               </apply>
               <apply id="alg1.l9.m1.1.1.1.1.1.1.3.3.2.2.2.cmml" xref="alg1.l9.m1.1.1.1.1.1.1.3.3.2.2.2">
                <csymbol cd="ambiguous" id="alg1.l9.m1.1.1.1.1.1.1.3.3.2.2.2.1.cmml" xref="alg1.l9.m1.1.1.1.1.1.1.3.3.2.2.2">
                 subscript
                </csymbol>
                <ci id="alg1.l9.m1.1.1.1.1.1.1.3.3.2.2.2.2.cmml" xref="alg1.l9.m1.1.1.1.1.1.1.3.3.2.2.2.2">
                 𝑎
                </ci>
                <ci id="alg1.l9.m1.1.1.1.1.1.1.3.3.2.2.2.3.cmml" xref="alg1.l9.m1.1.1.1.1.1.1.3.3.2.2.2.3">
                 𝑡
                </ci>
               </apply>
              </interval>
             </apply>
             <apply id="alg1.l9.m1.1.1.1.1.1.1.4.4.cmml" xref="alg1.l9.m1.1.1.1.1.1.1.4.4">
              <csymbol cd="ambiguous" id="alg1.l9.m1.1.1.1.1.1.1.4.4.1.cmml" xref="alg1.l9.m1.1.1.1.1.1.1.4.4">
               subscript
              </csymbol>
              <ci id="alg1.l9.m1.1.1.1.1.1.1.4.4.2.cmml" xref="alg1.l9.m1.1.1.1.1.1.1.4.4.2">
               𝑠
              </ci>
              <apply id="alg1.l9.m1.1.1.1.1.1.1.4.4.3.cmml" xref="alg1.l9.m1.1.1.1.1.1.1.4.4.3">
               <plus id="alg1.l9.m1.1.1.1.1.1.1.4.4.3.1.cmml" xref="alg1.l9.m1.1.1.1.1.1.1.4.4.3.1">
               </plus>
               <ci id="alg1.l9.m1.1.1.1.1.1.1.4.4.3.2.cmml" xref="alg1.l9.m1.1.1.1.1.1.1.4.4.3.2">
                𝑡
               </ci>
               <cn id="alg1.l9.m1.1.1.1.1.1.1.4.4.3.3.cmml" type="integer" xref="alg1.l9.m1.1.1.1.1.1.1.4.4.3.3">
                1
               </cn>
              </apply>
             </apply>
            </vector>
           </set>
          </apply>
         </apply>
        </annotation-xml>
        <annotation encoding="application/x-tex" id="alg1.l9.m1.1c">
         \mathcal{D}\leftarrow\mathcal{D}\cup\{(s_{t},a_{t},r(s_{t},a_{t}),s_{t+1})\}
        </annotation>
       </semantics>
      </math>
      .
     </div>
     <div class="ltx_listingline" id="alg1.l10">
      <span class="ltx_text ltx_font_bold" id="alg1.l10.1">
       end
      </span>
      <span class="ltx_text ltx_font_bold" id="alg1.l10.2">
       for
      </span>
     </div>
     <div class="ltx_listingline" id="alg1.l11">
      Sample a mini-batch
      <math alttext="\mathcal{B}" class="ltx_Math" display="inline" id="alg1.l11.m1.1">
       <semantics id="alg1.l11.m1.1a">
        <mi class="ltx_font_mathcaligraphic" id="alg1.l11.m1.1.1" xref="alg1.l11.m1.1.1.cmml">
         ℬ
        </mi>
        <annotation-xml encoding="MathML-Content" id="alg1.l11.m1.1b">
         <ci id="alg1.l11.m1.1.1.cmml" xref="alg1.l11.m1.1.1">
          ℬ
         </ci>
        </annotation-xml>
        <annotation encoding="application/x-tex" id="alg1.l11.m1.1c">
         \mathcal{B}
        </annotation>
       </semantics>
      </math>
      from
      <math alttext="\mathcal{D}" class="ltx_Math" display="inline" id="alg1.l11.m2.1">
       <semantics id="alg1.l11.m2.1a">
        <mi class="ltx_font_mathcaligraphic" id="alg1.l11.m2.1.1" xref="alg1.l11.m2.1.1.cmml">
         𝒟
        </mi>
        <annotation-xml encoding="MathML-Content" id="alg1.l11.m2.1b">
         <ci id="alg1.l11.m2.1.1.cmml" xref="alg1.l11.m2.1.1">
          𝒟
         </ci>
        </annotation-xml>
        <annotation encoding="application/x-tex" id="alg1.l11.m2.1c">
         \mathcal{D}
        </annotation>
       </semantics>
      </math>
      .
     </div>
     <div class="ltx_listingline" id="alg1.l12">
      <span class="ltx_text ltx_font_bold" id="alg1.l12.1">
       for
      </span>
      each time step
      <math alttext="t" class="ltx_Math" display="inline" id="alg1.l12.m1.1">
       <semantics id="alg1.l12.m1.1a">
        <mi id="alg1.l12.m1.1.1" xref="alg1.l12.m1.1.1.cmml">
         t
        </mi>
        <annotation-xml encoding="MathML-Content" id="alg1.l12.m1.1b">
         <ci id="alg1.l12.m1.1.1.cmml" xref="alg1.l12.m1.1.1">
          𝑡
         </ci>
        </annotation-xml>
        <annotation encoding="application/x-tex" id="alg1.l12.m1.1c">
         t
        </annotation>
       </semantics>
      </math>
      in
      <math alttext="\mathcal{B}" class="ltx_Math" display="inline" id="alg1.l12.m2.1">
       <semantics id="alg1.l12.m2.1a">
        <mi class="ltx_font_mathcaligraphic" id="alg1.l12.m2.1.1" xref="alg1.l12.m2.1.1.cmml">
         ℬ
        </mi>
        <annotation-xml encoding="MathML-Content" id="alg1.l12.m2.1b">
         <ci id="alg1.l12.m2.1.1.cmml" xref="alg1.l12.m2.1.1">
          ℬ
         </ci>
        </annotation-xml>
        <annotation encoding="application/x-tex" id="alg1.l12.m2.1c">
         \mathcal{B}
        </annotation>
       </semantics>
      </math>
      <span class="ltx_text ltx_font_bold" id="alg1.l12.2">
       do
      </span>
     </div>
     <div class="ltx_listingline" id="alg1.l13">
      <span class="ltx_text ltx_font_bold" id="alg1.l13.1">
       for
      </span>
      each token
      <math alttext="j" class="ltx_Math" display="inline" id="alg1.l13.m1.1">
       <semantics id="alg1.l13.m1.1a">
        <mi id="alg1.l13.m1.1.1" xref="alg1.l13.m1.1.1.cmml">
         j
        </mi>
        <annotation-xml encoding="MathML-Content" id="alg1.l13.m1.1b">
         <ci id="alg1.l13.m1.1.1.cmml" xref="alg1.l13.m1.1.1">
          𝑗
         </ci>
        </annotation-xml>
        <annotation encoding="application/x-tex" id="alg1.l13.m1.1c">
         j
        </annotation>
       </semantics>
      </math>
      in
      <math alttext="a_{t}" class="ltx_Math" display="inline" id="alg1.l13.m2.1">
       <semantics id="alg1.l13.m2.1a">
        <msub id="alg1.l13.m2.1.1" xref="alg1.l13.m2.1.1.cmml">
         <mi id="alg1.l13.m2.1.1.2" xref="alg1.l13.m2.1.1.2.cmml">
          a
         </mi>
         <mi id="alg1.l13.m2.1.1.3" xref="alg1.l13.m2.1.1.3.cmml">
          t
         </mi>
        </msub>
        <annotation-xml encoding="MathML-Content" id="alg1.l13.m2.1b">
         <apply id="alg1.l13.m2.1.1.cmml" xref="alg1.l13.m2.1.1">
          <csymbol cd="ambiguous" id="alg1.l13.m2.1.1.1.cmml" xref="alg1.l13.m2.1.1">
           subscript
          </csymbol>
          <ci id="alg1.l13.m2.1.1.2.cmml" xref="alg1.l13.m2.1.1.2">
           𝑎
          </ci>
          <ci id="alg1.l13.m2.1.1.3.cmml" xref="alg1.l13.m2.1.1.3">
           𝑡
          </ci>
         </apply>
        </annotation-xml>
        <annotation encoding="application/x-tex" id="alg1.l13.m2.1c">
         a_{t}
        </annotation>
       </semantics>
      </math>
      <span class="ltx_text ltx_font_bold" id="alg1.l13.2">
       do
      </span>
     </div>
     <div class="ltx_listingline" id="alg1.l14">
      <math alttext="q\leftarrow Q_{\theta}(s_{t},w_{t}^{1:j-1},w_{t}^{j})" class="ltx_Math" display="inline" id="alg1.l14.m1.3">
       <semantics id="alg1.l14.m1.3a">
        <mrow id="alg1.l14.m1.3.3" xref="alg1.l14.m1.3.3.cmml">
         <mi id="alg1.l14.m1.3.3.5" xref="alg1.l14.m1.3.3.5.cmml">
          q
         </mi>
         <mo id="alg1.l14.m1.3.3.4" stretchy="false" xref="alg1.l14.m1.3.3.4.cmml">
          ←
         </mo>
         <mrow id="alg1.l14.m1.3.3.3" xref="alg1.l14.m1.3.3.3.cmml">
          <msub id="alg1.l14.m1.3.3.3.5" xref="alg1.l14.m1.3.3.3.5.cmml">
           <mi id="alg1.l14.m1.3.3.3.5.2" xref="alg1.l14.m1.3.3.3.5.2.cmml">
            Q
           </mi>
           <mi id="alg1.l14.m1.3.3.3.5.3" xref="alg1.l14.m1.3.3.3.5.3.cmml">
            θ
           </mi>
          </msub>
          <mo id="alg1.l14.m1.3.3.3.4" lspace="0em" rspace="0em" xref="alg1.l14.m1.3.3.3.4.cmml">
           ​
          </mo>
          <mrow id="alg1.l14.m1.3.3.3.3.3" xref="alg1.l14.m1.3.3.3.3.4.cmml">
           <mo id="alg1.l14.m1.3.3.3.3.3.4" stretchy="false" xref="alg1.l14.m1.3.3.3.3.4.cmml">
            (
           </mo>
           <msub id="alg1.l14.m1.1.1.1.1.1.1" xref="alg1.l14.m1.1.1.1.1.1.1.cmml">
            <mi id="alg1.l14.m1.1.1.1.1.1.1.2" xref="alg1.l14.m1.1.1.1.1.1.1.2.cmml">
             s
            </mi>
            <mi id="alg1.l14.m1.1.1.1.1.1.1.3" xref="alg1.l14.m1.1.1.1.1.1.1.3.cmml">
             t
            </mi>
           </msub>
           <mo id="alg1.l14.m1.3.3.3.3.3.5" xref="alg1.l14.m1.3.3.3.3.4.cmml">
            ,
           </mo>
           <msubsup id="alg1.l14.m1.2.2.2.2.2.2" xref="alg1.l14.m1.2.2.2.2.2.2.cmml">
            <mi id="alg1.l14.m1.2.2.2.2.2.2.2.2" xref="alg1.l14.m1.2.2.2.2.2.2.2.2.cmml">
             w
            </mi>
            <mi id="alg1.l14.m1.2.2.2.2.2.2.2.3" xref="alg1.l14.m1.2.2.2.2.2.2.2.3.cmml">
             t
            </mi>
            <mrow id="alg1.l14.m1.2.2.2.2.2.2.3" xref="alg1.l14.m1.2.2.2.2.2.2.3.cmml">
             <mn id="alg1.l14.m1.2.2.2.2.2.2.3.2" xref="alg1.l14.m1.2.2.2.2.2.2.3.2.cmml">
              1
             </mn>
             <mo id="alg1.l14.m1.2.2.2.2.2.2.3.1" lspace="0.278em" rspace="0.278em" xref="alg1.l14.m1.2.2.2.2.2.2.3.1.cmml">
              :
             </mo>
             <mrow id="alg1.l14.m1.2.2.2.2.2.2.3.3" xref="alg1.l14.m1.2.2.2.2.2.2.3.3.cmml">
              <mi id="alg1.l14.m1.2.2.2.2.2.2.3.3.2" xref="alg1.l14.m1.2.2.2.2.2.2.3.3.2.cmml">
               j
              </mi>
              <mo id="alg1.l14.m1.2.2.2.2.2.2.3.3.1" xref="alg1.l14.m1.2.2.2.2.2.2.3.3.1.cmml">
               −
              </mo>
              <mn id="alg1.l14.m1.2.2.2.2.2.2.3.3.3" xref="alg1.l14.m1.2.2.2.2.2.2.3.3.3.cmml">
               1
              </mn>
             </mrow>
            </mrow>
           </msubsup>
           <mo id="alg1.l14.m1.3.3.3.3.3.6" xref="alg1.l14.m1.3.3.3.3.4.cmml">
            ,
           </mo>
           <msubsup id="alg1.l14.m1.3.3.3.3.3.3" xref="alg1.l14.m1.3.3.3.3.3.3.cmml">
            <mi id="alg1.l14.m1.3.3.3.3.3.3.2.2" xref="alg1.l14.m1.3.3.3.3.3.3.2.2.cmml">
             w
            </mi>
            <mi id="alg1.l14.m1.3.3.3.3.3.3.2.3" xref="alg1.l14.m1.3.3.3.3.3.3.2.3.cmml">
             t
            </mi>
            <mi id="alg1.l14.m1.3.3.3.3.3.3.3" xref="alg1.l14.m1.3.3.3.3.3.3.3.cmml">
             j
            </mi>
           </msubsup>
           <mo id="alg1.l14.m1.3.3.3.3.3.7" stretchy="false" xref="alg1.l14.m1.3.3.3.3.4.cmml">
            )
           </mo>
          </mrow>
         </mrow>
        </mrow>
        <annotation-xml encoding="MathML-Content" id="alg1.l14.m1.3b">
         <apply id="alg1.l14.m1.3.3.cmml" xref="alg1.l14.m1.3.3">
          <ci id="alg1.l14.m1.3.3.4.cmml" xref="alg1.l14.m1.3.3.4">
           ←
          </ci>
          <ci id="alg1.l14.m1.3.3.5.cmml" xref="alg1.l14.m1.3.3.5">
           𝑞
          </ci>
          <apply id="alg1.l14.m1.3.3.3.cmml" xref="alg1.l14.m1.3.3.3">
           <times id="alg1.l14.m1.3.3.3.4.cmml" xref="alg1.l14.m1.3.3.3.4">
           </times>
           <apply id="alg1.l14.m1.3.3.3.5.cmml" xref="alg1.l14.m1.3.3.3.5">
            <csymbol cd="ambiguous" id="alg1.l14.m1.3.3.3.5.1.cmml" xref="alg1.l14.m1.3.3.3.5">
             subscript
            </csymbol>
            <ci id="alg1.l14.m1.3.3.3.5.2.cmml" xref="alg1.l14.m1.3.3.3.5.2">
             𝑄
            </ci>
            <ci id="alg1.l14.m1.3.3.3.5.3.cmml" xref="alg1.l14.m1.3.3.3.5.3">
             𝜃
            </ci>
           </apply>
           <vector id="alg1.l14.m1.3.3.3.3.4.cmml" xref="alg1.l14.m1.3.3.3.3.3">
            <apply id="alg1.l14.m1.1.1.1.1.1.1.cmml" xref="alg1.l14.m1.1.1.1.1.1.1">
             <csymbol cd="ambiguous" id="alg1.l14.m1.1.1.1.1.1.1.1.cmml" xref="alg1.l14.m1.1.1.1.1.1.1">
              subscript
             </csymbol>
             <ci id="alg1.l14.m1.1.1.1.1.1.1.2.cmml" xref="alg1.l14.m1.1.1.1.1.1.1.2">
              𝑠
             </ci>
             <ci id="alg1.l14.m1.1.1.1.1.1.1.3.cmml" xref="alg1.l14.m1.1.1.1.1.1.1.3">
              𝑡
             </ci>
            </apply>
            <apply id="alg1.l14.m1.2.2.2.2.2.2.cmml" xref="alg1.l14.m1.2.2.2.2.2.2">
             <csymbol cd="ambiguous" id="alg1.l14.m1.2.2.2.2.2.2.1.cmml" xref="alg1.l14.m1.2.2.2.2.2.2">
              superscript
             </csymbol>
             <apply id="alg1.l14.m1.2.2.2.2.2.2.2.cmml" xref="alg1.l14.m1.2.2.2.2.2.2">
              <csymbol cd="ambiguous" id="alg1.l14.m1.2.2.2.2.2.2.2.1.cmml" xref="alg1.l14.m1.2.2.2.2.2.2">
               subscript
              </csymbol>
              <ci id="alg1.l14.m1.2.2.2.2.2.2.2.2.cmml" xref="alg1.l14.m1.2.2.2.2.2.2.2.2">
               𝑤
              </ci>
              <ci id="alg1.l14.m1.2.2.2.2.2.2.2.3.cmml" xref="alg1.l14.m1.2.2.2.2.2.2.2.3">
               𝑡
              </ci>
             </apply>
             <apply id="alg1.l14.m1.2.2.2.2.2.2.3.cmml" xref="alg1.l14.m1.2.2.2.2.2.2.3">
              <ci id="alg1.l14.m1.2.2.2.2.2.2.3.1.cmml" xref="alg1.l14.m1.2.2.2.2.2.2.3.1">
               :
              </ci>
              <cn id="alg1.l14.m1.2.2.2.2.2.2.3.2.cmml" type="integer" xref="alg1.l14.m1.2.2.2.2.2.2.3.2">
               1
              </cn>
              <apply id="alg1.l14.m1.2.2.2.2.2.2.3.3.cmml" xref="alg1.l14.m1.2.2.2.2.2.2.3.3">
               <minus id="alg1.l14.m1.2.2.2.2.2.2.3.3.1.cmml" xref="alg1.l14.m1.2.2.2.2.2.2.3.3.1">
               </minus>
               <ci id="alg1.l14.m1.2.2.2.2.2.2.3.3.2.cmml" xref="alg1.l14.m1.2.2.2.2.2.2.3.3.2">
                𝑗
               </ci>
               <cn id="alg1.l14.m1.2.2.2.2.2.2.3.3.3.cmml" type="integer" xref="alg1.l14.m1.2.2.2.2.2.2.3.3.3">
                1
               </cn>
              </apply>
             </apply>
            </apply>
            <apply id="alg1.l14.m1.3.3.3.3.3.3.cmml" xref="alg1.l14.m1.3.3.3.3.3.3">
             <csymbol cd="ambiguous" id="alg1.l14.m1.3.3.3.3.3.3.1.cmml" xref="alg1.l14.m1.3.3.3.3.3.3">
              superscript
             </csymbol>
             <apply id="alg1.l14.m1.3.3.3.3.3.3.2.cmml" xref="alg1.l14.m1.3.3.3.3.3.3">
              <csymbol cd="ambiguous" id="alg1.l14.m1.3.3.3.3.3.3.2.1.cmml" xref="alg1.l14.m1.3.3.3.3.3.3">
               subscript
              </csymbol>
              <ci id="alg1.l14.m1.3.3.3.3.3.3.2.2.cmml" xref="alg1.l14.m1.3.3.3.3.3.3.2.2">
               𝑤
              </ci>
              <ci id="alg1.l14.m1.3.3.3.3.3.3.2.3.cmml" xref="alg1.l14.m1.3.3.3.3.3.3.2.3">
               𝑡
              </ci>
             </apply>
             <ci id="alg1.l14.m1.3.3.3.3.3.3.3.cmml" xref="alg1.l14.m1.3.3.3.3.3.3.3">
              𝑗
             </ci>
            </apply>
           </vector>
          </apply>
         </apply>
        </annotation-xml>
        <annotation encoding="application/x-tex" id="alg1.l14.m1.3c">
         q\leftarrow Q_{\theta}(s_{t},w_{t}^{1:j-1},w_{t}^{j})
        </annotation>
       </semantics>
      </math>
     </div>
     <div class="ltx_listingline" id="alg1.l15">
      <span class="ltx_text ltx_font_bold" id="alg1.l15.1">
       if
      </span>
      <math alttext="j&lt;|a_{t}|" class="ltx_Math" display="inline" id="alg1.l15.m1.1">
       <semantics id="alg1.l15.m1.1a">
        <mrow id="alg1.l15.m1.1.1" xref="alg1.l15.m1.1.1.cmml">
         <mi id="alg1.l15.m1.1.1.3" xref="alg1.l15.m1.1.1.3.cmml">
          j
         </mi>
         <mo id="alg1.l15.m1.1.1.2" xref="alg1.l15.m1.1.1.2.cmml">
          &lt;
         </mo>
         <mrow id="alg1.l15.m1.1.1.1.1" xref="alg1.l15.m1.1.1.1.2.cmml">
          <mo id="alg1.l15.m1.1.1.1.1.2" stretchy="false" xref="alg1.l15.m1.1.1.1.2.1.cmml">
           |
          </mo>
          <msub id="alg1.l15.m1.1.1.1.1.1" xref="alg1.l15.m1.1.1.1.1.1.cmml">
           <mi id="alg1.l15.m1.1.1.1.1.1.2" xref="alg1.l15.m1.1.1.1.1.1.2.cmml">
            a
           </mi>
           <mi id="alg1.l15.m1.1.1.1.1.1.3" xref="alg1.l15.m1.1.1.1.1.1.3.cmml">
            t
           </mi>
          </msub>
          <mo id="alg1.l15.m1.1.1.1.1.3" stretchy="false" xref="alg1.l15.m1.1.1.1.2.1.cmml">
           |
          </mo>
         </mrow>
        </mrow>
        <annotation-xml encoding="MathML-Content" id="alg1.l15.m1.1b">
         <apply id="alg1.l15.m1.1.1.cmml" xref="alg1.l15.m1.1.1">
          <lt id="alg1.l15.m1.1.1.2.cmml" xref="alg1.l15.m1.1.1.2">
          </lt>
          <ci id="alg1.l15.m1.1.1.3.cmml" xref="alg1.l15.m1.1.1.3">
           𝑗
          </ci>
          <apply id="alg1.l15.m1.1.1.1.2.cmml" xref="alg1.l15.m1.1.1.1.1">
           <abs id="alg1.l15.m1.1.1.1.2.1.cmml" xref="alg1.l15.m1.1.1.1.1.2">
           </abs>
           <apply id="alg1.l15.m1.1.1.1.1.1.cmml" xref="alg1.l15.m1.1.1.1.1.1">
            <csymbol cd="ambiguous" id="alg1.l15.m1.1.1.1.1.1.1.cmml" xref="alg1.l15.m1.1.1.1.1.1">
             subscript
            </csymbol>
            <ci id="alg1.l15.m1.1.1.1.1.1.2.cmml" xref="alg1.l15.m1.1.1.1.1.1.2">
             𝑎
            </ci>
            <ci id="alg1.l15.m1.1.1.1.1.1.3.cmml" xref="alg1.l15.m1.1.1.1.1.1.3">
             𝑡
            </ci>
           </apply>
          </apply>
         </apply>
        </annotation-xml>
        <annotation encoding="application/x-tex" id="alg1.l15.m1.1c">
         j&lt;|a_{t}|
        </annotation>
       </semantics>
      </math>
      <span class="ltx_text ltx_font_bold" id="alg1.l15.2">
       then
      </span>
     </div>
     <div class="ltx_listingline" id="alg1.l16">
      <math alttext="q_{targ}\leftarrow\mathbb{E}_{w_{t}^{j+1}\sim\pi_{\phi}(s_{t},w_{t}^{1:j})}[Q_{\bar{\theta}}(s_{t},w_{t}^{1:j},w_{t}^{j+1})]" class="ltx_Math" display="inline" id="alg1.l16.m1.3">
       <semantics id="alg1.l16.m1.3a">
        <mrow id="alg1.l16.m1.3.3" xref="alg1.l16.m1.3.3.cmml">
         <msub id="alg1.l16.m1.3.3.3" xref="alg1.l16.m1.3.3.3.cmml">
          <mi id="alg1.l16.m1.3.3.3.2" xref="alg1.l16.m1.3.3.3.2.cmml">
           q
          </mi>
          <mrow id="alg1.l16.m1.3.3.3.3" xref="alg1.l16.m1.3.3.3.3.cmml">
           <mi id="alg1.l16.m1.3.3.3.3.2" xref="alg1.l16.m1.3.3.3.3.2.cmml">
            t
           </mi>
           <mo id="alg1.l16.m1.3.3.3.3.1" lspace="0em" rspace="0em" xref="alg1.l16.m1.3.3.3.3.1.cmml">
            ​
           </mo>
           <mi id="alg1.l16.m1.3.3.3.3.3" xref="alg1.l16.m1.3.3.3.3.3.cmml">
            a
           </mi>
           <mo id="alg1.l16.m1.3.3.3.3.1a" lspace="0em" rspace="0em" xref="alg1.l16.m1.3.3.3.3.1.cmml">
            ​
           </mo>
           <mi id="alg1.l16.m1.3.3.3.3.4" xref="alg1.l16.m1.3.3.3.3.4.cmml">
            r
           </mi>
           <mo id="alg1.l16.m1.3.3.3.3.1b" lspace="0em" rspace="0em" xref="alg1.l16.m1.3.3.3.3.1.cmml">
            ​
           </mo>
           <mi id="alg1.l16.m1.3.3.3.3.5" xref="alg1.l16.m1.3.3.3.3.5.cmml">
            g
           </mi>
          </mrow>
         </msub>
         <mo id="alg1.l16.m1.3.3.2" stretchy="false" xref="alg1.l16.m1.3.3.2.cmml">
          ←
         </mo>
         <mrow id="alg1.l16.m1.3.3.1" xref="alg1.l16.m1.3.3.1.cmml">
          <msub id="alg1.l16.m1.3.3.1.3" xref="alg1.l16.m1.3.3.1.3.cmml">
           <mi id="alg1.l16.m1.3.3.1.3.2" xref="alg1.l16.m1.3.3.1.3.2.cmml">
            𝔼
           </mi>
           <mrow id="alg1.l16.m1.2.2.2" xref="alg1.l16.m1.2.2.2.cmml">
            <msubsup id="alg1.l16.m1.2.2.2.4" xref="alg1.l16.m1.2.2.2.4.cmml">
             <mi id="alg1.l16.m1.2.2.2.4.2.2" xref="alg1.l16.m1.2.2.2.4.2.2.cmml">
              w
             </mi>
             <mi id="alg1.l16.m1.2.2.2.4.2.3" xref="alg1.l16.m1.2.2.2.4.2.3.cmml">
              t
             </mi>
             <mrow id="alg1.l16.m1.2.2.2.4.3" xref="alg1.l16.m1.2.2.2.4.3.cmml">
              <mi id="alg1.l16.m1.2.2.2.4.3.2" xref="alg1.l16.m1.2.2.2.4.3.2.cmml">
               j
              </mi>
              <mo id="alg1.l16.m1.2.2.2.4.3.1" xref="alg1.l16.m1.2.2.2.4.3.1.cmml">
               +
              </mo>
              <mn id="alg1.l16.m1.2.2.2.4.3.3" xref="alg1.l16.m1.2.2.2.4.3.3.cmml">
               1
              </mn>
             </mrow>
            </msubsup>
            <mo id="alg1.l16.m1.2.2.2.3" xref="alg1.l16.m1.2.2.2.3.cmml">
             ∼
            </mo>
            <mrow id="alg1.l16.m1.2.2.2.2" xref="alg1.l16.m1.2.2.2.2.cmml">
             <msub id="alg1.l16.m1.2.2.2.2.4" xref="alg1.l16.m1.2.2.2.2.4.cmml">
              <mi id="alg1.l16.m1.2.2.2.2.4.2" xref="alg1.l16.m1.2.2.2.2.4.2.cmml">
               π
              </mi>
              <mi id="alg1.l16.m1.2.2.2.2.4.3" xref="alg1.l16.m1.2.2.2.2.4.3.cmml">
               ϕ
              </mi>
             </msub>
             <mo id="alg1.l16.m1.2.2.2.2.3" lspace="0em" rspace="0em" xref="alg1.l16.m1.2.2.2.2.3.cmml">
              ​
             </mo>
             <mrow id="alg1.l16.m1.2.2.2.2.2.2" xref="alg1.l16.m1.2.2.2.2.2.3.cmml">
              <mo id="alg1.l16.m1.2.2.2.2.2.2.3" stretchy="false" xref="alg1.l16.m1.2.2.2.2.2.3.cmml">
               (
              </mo>
              <msub id="alg1.l16.m1.1.1.1.1.1.1.1" xref="alg1.l16.m1.1.1.1.1.1.1.1.cmml">
               <mi id="alg1.l16.m1.1.1.1.1.1.1.1.2" xref="alg1.l16.m1.1.1.1.1.1.1.1.2.cmml">
                s
               </mi>
               <mi id="alg1.l16.m1.1.1.1.1.1.1.1.3" xref="alg1.l16.m1.1.1.1.1.1.1.1.3.cmml">
                t
               </mi>
              </msub>
              <mo id="alg1.l16.m1.2.2.2.2.2.2.4" xref="alg1.l16.m1.2.2.2.2.2.3.cmml">
               ,
              </mo>
              <msubsup id="alg1.l16.m1.2.2.2.2.2.2.2" xref="alg1.l16.m1.2.2.2.2.2.2.2.cmml">
               <mi id="alg1.l16.m1.2.2.2.2.2.2.2.2.2" xref="alg1.l16.m1.2.2.2.2.2.2.2.2.2.cmml">
                w
               </mi>
               <mi id="alg1.l16.m1.2.2.2.2.2.2.2.2.3" xref="alg1.l16.m1.2.2.2.2.2.2.2.2.3.cmml">
                t
               </mi>
               <mrow id="alg1.l16.m1.2.2.2.2.2.2.2.3" xref="alg1.l16.m1.2.2.2.2.2.2.2.3.cmml">
                <mn id="alg1.l16.m1.2.2.2.2.2.2.2.3.2" xref="alg1.l16.m1.2.2.2.2.2.2.2.3.2.cmml">
                 1
                </mn>
                <mo id="alg1.l16.m1.2.2.2.2.2.2.2.3.1" lspace="0.278em" rspace="0.278em" xref="alg1.l16.m1.2.2.2.2.2.2.2.3.1.cmml">
                 :
                </mo>
                <mi id="alg1.l16.m1.2.2.2.2.2.2.2.3.3" xref="alg1.l16.m1.2.2.2.2.2.2.2.3.3.cmml">
                 j
                </mi>
               </mrow>
              </msubsup>
              <mo id="alg1.l16.m1.2.2.2.2.2.2.5" stretchy="false" xref="alg1.l16.m1.2.2.2.2.2.3.cmml">
               )
              </mo>
             </mrow>
            </mrow>
           </mrow>
          </msub>
          <mo id="alg1.l16.m1.3.3.1.2" lspace="0em" rspace="0em" xref="alg1.l16.m1.3.3.1.2.cmml">
           ​
          </mo>
          <mrow id="alg1.l16.m1.3.3.1.1.1" xref="alg1.l16.m1.3.3.1.1.2.cmml">
           <mo id="alg1.l16.m1.3.3.1.1.1.2" stretchy="false" xref="alg1.l16.m1.3.3.1.1.2.1.cmml">
            [
           </mo>
           <mrow id="alg1.l16.m1.3.3.1.1.1.1" xref="alg1.l16.m1.3.3.1.1.1.1.cmml">
            <msub id="alg1.l16.m1.3.3.1.1.1.1.5" xref="alg1.l16.m1.3.3.1.1.1.1.5.cmml">
             <mi id="alg1.l16.m1.3.3.1.1.1.1.5.2" xref="alg1.l16.m1.3.3.1.1.1.1.5.2.cmml">
              Q
             </mi>
             <mover accent="true" id="alg1.l16.m1.3.3.1.1.1.1.5.3" xref="alg1.l16.m1.3.3.1.1.1.1.5.3.cmml">
              <mi id="alg1.l16.m1.3.3.1.1.1.1.5.3.2" xref="alg1.l16.m1.3.3.1.1.1.1.5.3.2.cmml">
               θ
              </mi>
              <mo id="alg1.l16.m1.3.3.1.1.1.1.5.3.1" xref="alg1.l16.m1.3.3.1.1.1.1.5.3.1.cmml">
               ¯
              </mo>
             </mover>
            </msub>
            <mo id="alg1.l16.m1.3.3.1.1.1.1.4" lspace="0em" rspace="0em" xref="alg1.l16.m1.3.3.1.1.1.1.4.cmml">
             ​
            </mo>
            <mrow id="alg1.l16.m1.3.3.1.1.1.1.3.3" xref="alg1.l16.m1.3.3.1.1.1.1.3.4.cmml">
             <mo id="alg1.l16.m1.3.3.1.1.1.1.3.3.4" stretchy="false" xref="alg1.l16.m1.3.3.1.1.1.1.3.4.cmml">
              (
             </mo>
             <msub id="alg1.l16.m1.3.3.1.1.1.1.1.1.1" xref="alg1.l16.m1.3.3.1.1.1.1.1.1.1.cmml">
              <mi id="alg1.l16.m1.3.3.1.1.1.1.1.1.1.2" xref="alg1.l16.m1.3.3.1.1.1.1.1.1.1.2.cmml">
               s
              </mi>
              <mi id="alg1.l16.m1.3.3.1.1.1.1.1.1.1.3" xref="alg1.l16.m1.3.3.1.1.1.1.1.1.1.3.cmml">
               t
              </mi>
             </msub>
             <mo id="alg1.l16.m1.3.3.1.1.1.1.3.3.5" xref="alg1.l16.m1.3.3.1.1.1.1.3.4.cmml">
              ,
             </mo>
             <msubsup id="alg1.l16.m1.3.3.1.1.1.1.2.2.2" xref="alg1.l16.m1.3.3.1.1.1.1.2.2.2.cmml">
              <mi id="alg1.l16.m1.3.3.1.1.1.1.2.2.2.2.2" xref="alg1.l16.m1.3.3.1.1.1.1.2.2.2.2.2.cmml">
               w
              </mi>
              <mi id="alg1.l16.m1.3.3.1.1.1.1.2.2.2.2.3" xref="alg1.l16.m1.3.3.1.1.1.1.2.2.2.2.3.cmml">
               t
              </mi>
              <mrow id="alg1.l16.m1.3.3.1.1.1.1.2.2.2.3" xref="alg1.l16.m1.3.3.1.1.1.1.2.2.2.3.cmml">
               <mn id="alg1.l16.m1.3.3.1.1.1.1.2.2.2.3.2" xref="alg1.l16.m1.3.3.1.1.1.1.2.2.2.3.2.cmml">
                1
               </mn>
               <mo id="alg1.l16.m1.3.3.1.1.1.1.2.2.2.3.1" lspace="0.278em" rspace="0.278em" xref="alg1.l16.m1.3.3.1.1.1.1.2.2.2.3.1.cmml">
                :
               </mo>
               <mi id="alg1.l16.m1.3.3.1.1.1.1.2.2.2.3.3" xref="alg1.l16.m1.3.3.1.1.1.1.2.2.2.3.3.cmml">
                j
               </mi>
              </mrow>
             </msubsup>
             <mo id="alg1.l16.m1.3.3.1.1.1.1.3.3.6" xref="alg1.l16.m1.3.3.1.1.1.1.3.4.cmml">
              ,
             </mo>
             <msubsup id="alg1.l16.m1.3.3.1.1.1.1.3.3.3" xref="alg1.l16.m1.3.3.1.1.1.1.3.3.3.cmml">
              <mi id="alg1.l16.m1.3.3.1.1.1.1.3.3.3.2.2" xref="alg1.l16.m1.3.3.1.1.1.1.3.3.3.2.2.cmml">
               w
              </mi>
              <mi id="alg1.l16.m1.3.3.1.1.1.1.3.3.3.2.3" xref="alg1.l16.m1.3.3.1.1.1.1.3.3.3.2.3.cmml">
               t
              </mi>
              <mrow id="alg1.l16.m1.3.3.1.1.1.1.3.3.3.3" xref="alg1.l16.m1.3.3.1.1.1.1.3.3.3.3.cmml">
               <mi id="alg1.l16.m1.3.3.1.1.1.1.3.3.3.3.2" xref="alg1.l16.m1.3.3.1.1.1.1.3.3.3.3.2.cmml">
                j
               </mi>
               <mo id="alg1.l16.m1.3.3.1.1.1.1.3.3.3.3.1" xref="alg1.l16.m1.3.3.1.1.1.1.3.3.3.3.1.cmml">
                +
               </mo>
               <mn id="alg1.l16.m1.3.3.1.1.1.1.3.3.3.3.3" xref="alg1.l16.m1.3.3.1.1.1.1.3.3.3.3.3.cmml">
                1
               </mn>
              </mrow>
             </msubsup>
             <mo id="alg1.l16.m1.3.3.1.1.1.1.3.3.7" stretchy="false" xref="alg1.l16.m1.3.3.1.1.1.1.3.4.cmml">
              )
             </mo>
            </mrow>
           </mrow>
           <mo id="alg1.l16.m1.3.3.1.1.1.3" stretchy="false" xref="alg1.l16.m1.3.3.1.1.2.1.cmml">
            ]
           </mo>
          </mrow>
         </mrow>
        </mrow>
        <annotation-xml encoding="MathML-Content" id="alg1.l16.m1.3b">
         <apply id="alg1.l16.m1.3.3.cmml" xref="alg1.l16.m1.3.3">
          <ci id="alg1.l16.m1.3.3.2.cmml" xref="alg1.l16.m1.3.3.2">
           ←
          </ci>
          <apply id="alg1.l16.m1.3.3.3.cmml" xref="alg1.l16.m1.3.3.3">
           <csymbol cd="ambiguous" id="alg1.l16.m1.3.3.3.1.cmml" xref="alg1.l16.m1.3.3.3">
            subscript
           </csymbol>
           <ci id="alg1.l16.m1.3.3.3.2.cmml" xref="alg1.l16.m1.3.3.3.2">
            𝑞
           </ci>
           <apply id="alg1.l16.m1.3.3.3.3.cmml" xref="alg1.l16.m1.3.3.3.3">
            <times id="alg1.l16.m1.3.3.3.3.1.cmml" xref="alg1.l16.m1.3.3.3.3.1">
            </times>
            <ci id="alg1.l16.m1.3.3.3.3.2.cmml" xref="alg1.l16.m1.3.3.3.3.2">
             𝑡
            </ci>
            <ci id="alg1.l16.m1.3.3.3.3.3.cmml" xref="alg1.l16.m1.3.3.3.3.3">
             𝑎
            </ci>
            <ci id="alg1.l16.m1.3.3.3.3.4.cmml" xref="alg1.l16.m1.3.3.3.3.4">
             𝑟
            </ci>
            <ci id="alg1.l16.m1.3.3.3.3.5.cmml" xref="alg1.l16.m1.3.3.3.3.5">
             𝑔
            </ci>
           </apply>
          </apply>
          <apply id="alg1.l16.m1.3.3.1.cmml" xref="alg1.l16.m1.3.3.1">
           <times id="alg1.l16.m1.3.3.1.2.cmml" xref="alg1.l16.m1.3.3.1.2">
           </times>
           <apply id="alg1.l16.m1.3.3.1.3.cmml" xref="alg1.l16.m1.3.3.1.3">
            <csymbol cd="ambiguous" id="alg1.l16.m1.3.3.1.3.1.cmml" xref="alg1.l16.m1.3.3.1.3">
             subscript
            </csymbol>
            <ci id="alg1.l16.m1.3.3.1.3.2.cmml" xref="alg1.l16.m1.3.3.1.3.2">
             𝔼
            </ci>
            <apply id="alg1.l16.m1.2.2.2.cmml" xref="alg1.l16.m1.2.2.2">
             <csymbol cd="latexml" id="alg1.l16.m1.2.2.2.3.cmml" xref="alg1.l16.m1.2.2.2.3">
              similar-to
             </csymbol>
             <apply id="alg1.l16.m1.2.2.2.4.cmml" xref="alg1.l16.m1.2.2.2.4">
              <csymbol cd="ambiguous" id="alg1.l16.m1.2.2.2.4.1.cmml" xref="alg1.l16.m1.2.2.2.4">
               superscript
              </csymbol>
              <apply id="alg1.l16.m1.2.2.2.4.2.cmml" xref="alg1.l16.m1.2.2.2.4">
               <csymbol cd="ambiguous" id="alg1.l16.m1.2.2.2.4.2.1.cmml" xref="alg1.l16.m1.2.2.2.4">
                subscript
               </csymbol>
               <ci id="alg1.l16.m1.2.2.2.4.2.2.cmml" xref="alg1.l16.m1.2.2.2.4.2.2">
                𝑤
               </ci>
               <ci id="alg1.l16.m1.2.2.2.4.2.3.cmml" xref="alg1.l16.m1.2.2.2.4.2.3">
                𝑡
               </ci>
              </apply>
              <apply id="alg1.l16.m1.2.2.2.4.3.cmml" xref="alg1.l16.m1.2.2.2.4.3">
               <plus id="alg1.l16.m1.2.2.2.4.3.1.cmml" xref="alg1.l16.m1.2.2.2.4.3.1">
               </plus>
               <ci id="alg1.l16.m1.2.2.2.4.3.2.cmml" xref="alg1.l16.m1.2.2.2.4.3.2">
                𝑗
               </ci>
               <cn id="alg1.l16.m1.2.2.2.4.3.3.cmml" type="integer" xref="alg1.l16.m1.2.2.2.4.3.3">
                1
               </cn>
              </apply>
             </apply>
             <apply id="alg1.l16.m1.2.2.2.2.cmml" xref="alg1.l16.m1.2.2.2.2">
              <times id="alg1.l16.m1.2.2.2.2.3.cmml" xref="alg1.l16.m1.2.2.2.2.3">
              </times>
              <apply id="alg1.l16.m1.2.2.2.2.4.cmml" xref="alg1.l16.m1.2.2.2.2.4">
               <csymbol cd="ambiguous" id="alg1.l16.m1.2.2.2.2.4.1.cmml" xref="alg1.l16.m1.2.2.2.2.4">
                subscript
               </csymbol>
               <ci id="alg1.l16.m1.2.2.2.2.4.2.cmml" xref="alg1.l16.m1.2.2.2.2.4.2">
                𝜋
               </ci>
               <ci id="alg1.l16.m1.2.2.2.2.4.3.cmml" xref="alg1.l16.m1.2.2.2.2.4.3">
                italic-ϕ
               </ci>
              </apply>
              <interval closure="open" id="alg1.l16.m1.2.2.2.2.2.3.cmml" xref="alg1.l16.m1.2.2.2.2.2.2">
               <apply id="alg1.l16.m1.1.1.1.1.1.1.1.cmml" xref="alg1.l16.m1.1.1.1.1.1.1.1">
                <csymbol cd="ambiguous" id="alg1.l16.m1.1.1.1.1.1.1.1.1.cmml" xref="alg1.l16.m1.1.1.1.1.1.1.1">
                 subscript
                </csymbol>
                <ci id="alg1.l16.m1.1.1.1.1.1.1.1.2.cmml" xref="alg1.l16.m1.1.1.1.1.1.1.1.2">
                 𝑠
                </ci>
                <ci id="alg1.l16.m1.1.1.1.1.1.1.1.3.cmml" xref="alg1.l16.m1.1.1.1.1.1.1.1.3">
                 𝑡
                </ci>
               </apply>
               <apply id="alg1.l16.m1.2.2.2.2.2.2.2.cmml" xref="alg1.l16.m1.2.2.2.2.2.2.2">
                <csymbol cd="ambiguous" id="alg1.l16.m1.2.2.2.2.2.2.2.1.cmml" xref="alg1.l16.m1.2.2.2.2.2.2.2">
                 superscript
                </csymbol>
                <apply id="alg1.l16.m1.2.2.2.2.2.2.2.2.cmml" xref="alg1.l16.m1.2.2.2.2.2.2.2">
                 <csymbol cd="ambiguous" id="alg1.l16.m1.2.2.2.2.2.2.2.2.1.cmml" xref="alg1.l16.m1.2.2.2.2.2.2.2">
                  subscript
                 </csymbol>
                 <ci id="alg1.l16.m1.2.2.2.2.2.2.2.2.2.cmml" xref="alg1.l16.m1.2.2.2.2.2.2.2.2.2">
                  𝑤
                 </ci>
                 <ci id="alg1.l16.m1.2.2.2.2.2.2.2.2.3.cmml" xref="alg1.l16.m1.2.2.2.2.2.2.2.2.3">
                  𝑡
                 </ci>
                </apply>
                <apply id="alg1.l16.m1.2.2.2.2.2.2.2.3.cmml" xref="alg1.l16.m1.2.2.2.2.2.2.2.3">
                 <ci id="alg1.l16.m1.2.2.2.2.2.2.2.3.1.cmml" xref="alg1.l16.m1.2.2.2.2.2.2.2.3.1">
                  :
                 </ci>
                 <cn id="alg1.l16.m1.2.2.2.2.2.2.2.3.2.cmml" type="integer" xref="alg1.l16.m1.2.2.2.2.2.2.2.3.2">
                  1
                 </cn>
                 <ci id="alg1.l16.m1.2.2.2.2.2.2.2.3.3.cmml" xref="alg1.l16.m1.2.2.2.2.2.2.2.3.3">
                  𝑗
                 </ci>
                </apply>
               </apply>
              </interval>
             </apply>
            </apply>
           </apply>
           <apply id="alg1.l16.m1.3.3.1.1.2.cmml" xref="alg1.l16.m1.3.3.1.1.1">
            <csymbol cd="latexml" id="alg1.l16.m1.3.3.1.1.2.1.cmml" xref="alg1.l16.m1.3.3.1.1.1.2">
             delimited-[]
            </csymbol>
            <apply id="alg1.l16.m1.3.3.1.1.1.1.cmml" xref="alg1.l16.m1.3.3.1.1.1.1">
             <times id="alg1.l16.m1.3.3.1.1.1.1.4.cmml" xref="alg1.l16.m1.3.3.1.1.1.1.4">
             </times>
             <apply id="alg1.l16.m1.3.3.1.1.1.1.5.cmml" xref="alg1.l16.m1.3.3.1.1.1.1.5">
              <csymbol cd="ambiguous" id="alg1.l16.m1.3.3.1.1.1.1.5.1.cmml" xref="alg1.l16.m1.3.3.1.1.1.1.5">
               subscript
              </csymbol>
              <ci id="alg1.l16.m1.3.3.1.1.1.1.5.2.cmml" xref="alg1.l16.m1.3.3.1.1.1.1.5.2">
               𝑄
              </ci>
              <apply id="alg1.l16.m1.3.3.1.1.1.1.5.3.cmml" xref="alg1.l16.m1.3.3.1.1.1.1.5.3">
               <ci id="alg1.l16.m1.3.3.1.1.1.1.5.3.1.cmml" xref="alg1.l16.m1.3.3.1.1.1.1.5.3.1">
                ¯
               </ci>
               <ci id="alg1.l16.m1.3.3.1.1.1.1.5.3.2.cmml" xref="alg1.l16.m1.3.3.1.1.1.1.5.3.2">
                𝜃
               </ci>
              </apply>
             </apply>
             <vector id="alg1.l16.m1.3.3.1.1.1.1.3.4.cmml" xref="alg1.l16.m1.3.3.1.1.1.1.3.3">
              <apply id="alg1.l16.m1.3.3.1.1.1.1.1.1.1.cmml" xref="alg1.l16.m1.3.3.1.1.1.1.1.1.1">
               <csymbol cd="ambiguous" id="alg1.l16.m1.3.3.1.1.1.1.1.1.1.1.cmml" xref="alg1.l16.m1.3.3.1.1.1.1.1.1.1">
                subscript
               </csymbol>
               <ci id="alg1.l16.m1.3.3.1.1.1.1.1.1.1.2.cmml" xref="alg1.l16.m1.3.3.1.1.1.1.1.1.1.2">
                𝑠
               </ci>
               <ci id="alg1.l16.m1.3.3.1.1.1.1.1.1.1.3.cmml" xref="alg1.l16.m1.3.3.1.1.1.1.1.1.1.3">
                𝑡
               </ci>
              </apply>
              <apply id="alg1.l16.m1.3.3.1.1.1.1.2.2.2.cmml" xref="alg1.l16.m1.3.3.1.1.1.1.2.2.2">
               <csymbol cd="ambiguous" id="alg1.l16.m1.3.3.1.1.1.1.2.2.2.1.cmml" xref="alg1.l16.m1.3.3.1.1.1.1.2.2.2">
                superscript
               </csymbol>
               <apply id="alg1.l16.m1.3.3.1.1.1.1.2.2.2.2.cmml" xref="alg1.l16.m1.3.3.1.1.1.1.2.2.2">
                <csymbol cd="ambiguous" id="alg1.l16.m1.3.3.1.1.1.1.2.2.2.2.1.cmml" xref="alg1.l16.m1.3.3.1.1.1.1.2.2.2">
                 subscript
                </csymbol>
                <ci id="alg1.l16.m1.3.3.1.1.1.1.2.2.2.2.2.cmml" xref="alg1.l16.m1.3.3.1.1.1.1.2.2.2.2.2">
                 𝑤
                </ci>
                <ci id="alg1.l16.m1.3.3.1.1.1.1.2.2.2.2.3.cmml" xref="alg1.l16.m1.3.3.1.1.1.1.2.2.2.2.3">
                 𝑡
                </ci>
               </apply>
               <apply id="alg1.l16.m1.3.3.1.1.1.1.2.2.2.3.cmml" xref="alg1.l16.m1.3.3.1.1.1.1.2.2.2.3">
                <ci id="alg1.l16.m1.3.3.1.1.1.1.2.2.2.3.1.cmml" xref="alg1.l16.m1.3.3.1.1.1.1.2.2.2.3.1">
                 :
                </ci>
                <cn id="alg1.l16.m1.3.3.1.1.1.1.2.2.2.3.2.cmml" type="integer" xref="alg1.l16.m1.3.3.1.1.1.1.2.2.2.3.2">
                 1
                </cn>
                <ci id="alg1.l16.m1.3.3.1.1.1.1.2.2.2.3.3.cmml" xref="alg1.l16.m1.3.3.1.1.1.1.2.2.2.3.3">
                 𝑗
                </ci>
               </apply>
              </apply>
              <apply id="alg1.l16.m1.3.3.1.1.1.1.3.3.3.cmml" xref="alg1.l16.m1.3.3.1.1.1.1.3.3.3">
               <csymbol cd="ambiguous" id="alg1.l16.m1.3.3.1.1.1.1.3.3.3.1.cmml" xref="alg1.l16.m1.3.3.1.1.1.1.3.3.3">
                superscript
               </csymbol>
               <apply id="alg1.l16.m1.3.3.1.1.1.1.3.3.3.2.cmml" xref="alg1.l16.m1.3.3.1.1.1.1.3.3.3">
                <csymbol cd="ambiguous" id="alg1.l16.m1.3.3.1.1.1.1.3.3.3.2.1.cmml" xref="alg1.l16.m1.3.3.1.1.1.1.3.3.3">
                 subscript
                </csymbol>
                <ci id="alg1.l16.m1.3.3.1.1.1.1.3.3.3.2.2.cmml" xref="alg1.l16.m1.3.3.1.1.1.1.3.3.3.2.2">
                 𝑤
                </ci>
                <ci id="alg1.l16.m1.3.3.1.1.1.1.3.3.3.2.3.cmml" xref="alg1.l16.m1.3.3.1.1.1.1.3.3.3.2.3">
                 𝑡
                </ci>
               </apply>
               <apply id="alg1.l16.m1.3.3.1.1.1.1.3.3.3.3.cmml" xref="alg1.l16.m1.3.3.1.1.1.1.3.3.3.3">
                <plus id="alg1.l16.m1.3.3.1.1.1.1.3.3.3.3.1.cmml" xref="alg1.l16.m1.3.3.1.1.1.1.3.3.3.3.1">
                </plus>
                <ci id="alg1.l16.m1.3.3.1.1.1.1.3.3.3.3.2.cmml" xref="alg1.l16.m1.3.3.1.1.1.1.3.3.3.3.2">
                 𝑗
                </ci>
                <cn id="alg1.l16.m1.3.3.1.1.1.1.3.3.3.3.3.cmml" type="integer" xref="alg1.l16.m1.3.3.1.1.1.1.3.3.3.3.3">
                 1
                </cn>
               </apply>
              </apply>
             </vector>
            </apply>
           </apply>
          </apply>
         </apply>
        </annotation-xml>
        <annotation encoding="application/x-tex" id="alg1.l16.m1.3c">
         q_{targ}\leftarrow\mathbb{E}_{w_{t}^{j+1}\sim\pi_{\phi}(s_{t},w_{t}^{1:j})}[Q_{\bar{\theta}}(s_{t},w_{t}^{1:j},w_{t}^{j+1})]
        </annotation>
       </semantics>
      </math>
     </div>
     <div class="ltx_listingline" id="alg1.l17">
      <math alttext="-\beta D_{KL}[\pi_{\phi}||\bar{\pi}_{\bar{\phi}}](s_{t},w_{t}^{1:j})" class="ltx_math_unparsed" display="inline" id="alg1.l17.m1.1">
       <semantics id="alg1.l17.m1.1a">
        <mrow id="alg1.l17.m1.1b">
         <mo id="alg1.l17.m1.1.1">
          −
         </mo>
         <mi id="alg1.l17.m1.1.2">
          β
         </mi>
         <msub id="alg1.l17.m1.1.3">
          <mi id="alg1.l17.m1.1.3.2">
           D
          </mi>
          <mrow id="alg1.l17.m1.1.3.3">
           <mi id="alg1.l17.m1.1.3.3.2">
            K
           </mi>
           <mo id="alg1.l17.m1.1.3.3.1" lspace="0em" rspace="0em">
            ​
           </mo>
           <mi id="alg1.l17.m1.1.3.3.3">
            L
           </mi>
          </mrow>
         </msub>
         <mrow id="alg1.l17.m1.1.4">
          <mo id="alg1.l17.m1.1.4.1" stretchy="false">
           [
          </mo>
          <msub id="alg1.l17.m1.1.4.2">
           <mi id="alg1.l17.m1.1.4.2.2">
            π
           </mi>
           <mi id="alg1.l17.m1.1.4.2.3">
            ϕ
           </mi>
          </msub>
          <mo fence="false" id="alg1.l17.m1.1.4.3" rspace="0.167em" stretchy="false">
           |
          </mo>
          <mo fence="false" id="alg1.l17.m1.1.4.4" rspace="0.167em" stretchy="false">
           |
          </mo>
          <msub id="alg1.l17.m1.1.4.5">
           <mover accent="true" id="alg1.l17.m1.1.4.5.2">
            <mi id="alg1.l17.m1.1.4.5.2.2">
             π
            </mi>
            <mo id="alg1.l17.m1.1.4.5.2.1">
             ¯
            </mo>
           </mover>
           <mover accent="true" id="alg1.l17.m1.1.4.5.3">
            <mi id="alg1.l17.m1.1.4.5.3.2">
             ϕ
            </mi>
            <mo id="alg1.l17.m1.1.4.5.3.1">
             ¯
            </mo>
           </mover>
          </msub>
          <mo id="alg1.l17.m1.1.4.6" stretchy="false">
           ]
          </mo>
         </mrow>
         <mrow id="alg1.l17.m1.1.5">
          <mo id="alg1.l17.m1.1.5.1" stretchy="false">
           (
          </mo>
          <msub id="alg1.l17.m1.1.5.2">
           <mi id="alg1.l17.m1.1.5.2.2">
            s
           </mi>
           <mi id="alg1.l17.m1.1.5.2.3">
            t
           </mi>
          </msub>
          <mo id="alg1.l17.m1.1.5.3">
           ,
          </mo>
          <msubsup id="alg1.l17.m1.1.5.4">
           <mi id="alg1.l17.m1.1.5.4.2.2">
            w
           </mi>
           <mi id="alg1.l17.m1.1.5.4.2.3">
            t
           </mi>
           <mrow id="alg1.l17.m1.1.5.4.3">
            <mn id="alg1.l17.m1.1.5.4.3.2">
             1
            </mn>
            <mo id="alg1.l17.m1.1.5.4.3.1" lspace="0.278em" rspace="0.278em">
             :
            </mo>
            <mi id="alg1.l17.m1.1.5.4.3.3">
             j
            </mi>
           </mrow>
          </msubsup>
          <mo id="alg1.l17.m1.1.5.5" stretchy="false">
           )
          </mo>
         </mrow>
        </mrow>
        <annotation encoding="application/x-tex" id="alg1.l17.m1.1c">
         -\beta D_{KL}[\pi_{\phi}||\bar{\pi}_{\bar{\phi}}](s_{t},w_{t}^{1:j})
        </annotation>
       </semantics>
      </math>
     </div>
     <div class="ltx_listingline" id="alg1.l18">
      <span class="ltx_text ltx_font_bold" id="alg1.l18.1">
       else
      </span>
      <span class="ltx_text ltx_font_bold" id="alg1.l18.2">
       if
      </span>
      <math alttext="j=|a_{t}|" class="ltx_Math" display="inline" id="alg1.l18.m1.1">
       <semantics id="alg1.l18.m1.1a">
        <mrow id="alg1.l18.m1.1.1" xref="alg1.l18.m1.1.1.cmml">
         <mi id="alg1.l18.m1.1.1.3" xref="alg1.l18.m1.1.1.3.cmml">
          j
         </mi>
         <mo id="alg1.l18.m1.1.1.2" xref="alg1.l18.m1.1.1.2.cmml">
          =
         </mo>
         <mrow id="alg1.l18.m1.1.1.1.1" xref="alg1.l18.m1.1.1.1.2.cmml">
          <mo id="alg1.l18.m1.1.1.1.1.2" stretchy="false" xref="alg1.l18.m1.1.1.1.2.1.cmml">
           |
          </mo>
          <msub id="alg1.l18.m1.1.1.1.1.1" xref="alg1.l18.m1.1.1.1.1.1.cmml">
           <mi id="alg1.l18.m1.1.1.1.1.1.2" xref="alg1.l18.m1.1.1.1.1.1.2.cmml">
            a
           </mi>
           <mi id="alg1.l18.m1.1.1.1.1.1.3" xref="alg1.l18.m1.1.1.1.1.1.3.cmml">
            t
           </mi>
          </msub>
          <mo id="alg1.l18.m1.1.1.1.1.3" stretchy="false" xref="alg1.l18.m1.1.1.1.2.1.cmml">
           |
          </mo>
         </mrow>
        </mrow>
        <annotation-xml encoding="MathML-Content" id="alg1.l18.m1.1b">
         <apply id="alg1.l18.m1.1.1.cmml" xref="alg1.l18.m1.1.1">
          <eq id="alg1.l18.m1.1.1.2.cmml" xref="alg1.l18.m1.1.1.2">
          </eq>
          <ci id="alg1.l18.m1.1.1.3.cmml" xref="alg1.l18.m1.1.1.3">
           𝑗
          </ci>
          <apply id="alg1.l18.m1.1.1.1.2.cmml" xref="alg1.l18.m1.1.1.1.1">
           <abs id="alg1.l18.m1.1.1.1.2.1.cmml" xref="alg1.l18.m1.1.1.1.1.2">
           </abs>
           <apply id="alg1.l18.m1.1.1.1.1.1.cmml" xref="alg1.l18.m1.1.1.1.1.1">
            <csymbol cd="ambiguous" id="alg1.l18.m1.1.1.1.1.1.1.cmml" xref="alg1.l18.m1.1.1.1.1.1">
             subscript
            </csymbol>
            <ci id="alg1.l18.m1.1.1.1.1.1.2.cmml" xref="alg1.l18.m1.1.1.1.1.1.2">
             𝑎
            </ci>
            <ci id="alg1.l18.m1.1.1.1.1.1.3.cmml" xref="alg1.l18.m1.1.1.1.1.1.3">
             𝑡
            </ci>
           </apply>
          </apply>
         </apply>
        </annotation-xml>
        <annotation encoding="application/x-tex" id="alg1.l18.m1.1c">
         j=|a_{t}|
        </annotation>
       </semantics>
      </math>
      <span class="ltx_text ltx_font_bold" id="alg1.l18.3">
       then
      </span>
     </div>
     <div class="ltx_listingline" id="alg1.l19">
      <math alttext="q_{targ}\leftarrow r(s_{t},a_{t})" class="ltx_Math" display="inline" id="alg1.l19.m1.2">
       <semantics id="alg1.l19.m1.2a">
        <mrow id="alg1.l19.m1.2.2" xref="alg1.l19.m1.2.2.cmml">
         <msub id="alg1.l19.m1.2.2.4" xref="alg1.l19.m1.2.2.4.cmml">
          <mi id="alg1.l19.m1.2.2.4.2" xref="alg1.l19.m1.2.2.4.2.cmml">
           q
          </mi>
          <mrow id="alg1.l19.m1.2.2.4.3" xref="alg1.l19.m1.2.2.4.3.cmml">
           <mi id="alg1.l19.m1.2.2.4.3.2" xref="alg1.l19.m1.2.2.4.3.2.cmml">
            t
           </mi>
           <mo id="alg1.l19.m1.2.2.4.3.1" lspace="0em" rspace="0em" xref="alg1.l19.m1.2.2.4.3.1.cmml">
            ​
           </mo>
           <mi id="alg1.l19.m1.2.2.4.3.3" xref="alg1.l19.m1.2.2.4.3.3.cmml">
            a
           </mi>
           <mo id="alg1.l19.m1.2.2.4.3.1a" lspace="0em" rspace="0em" xref="alg1.l19.m1.2.2.4.3.1.cmml">
            ​
           </mo>
           <mi id="alg1.l19.m1.2.2.4.3.4" xref="alg1.l19.m1.2.2.4.3.4.cmml">
            r
           </mi>
           <mo id="alg1.l19.m1.2.2.4.3.1b" lspace="0em" rspace="0em" xref="alg1.l19.m1.2.2.4.3.1.cmml">
            ​
           </mo>
           <mi id="alg1.l19.m1.2.2.4.3.5" xref="alg1.l19.m1.2.2.4.3.5.cmml">
            g
           </mi>
          </mrow>
         </msub>
         <mo id="alg1.l19.m1.2.2.3" stretchy="false" xref="alg1.l19.m1.2.2.3.cmml">
          ←
         </mo>
         <mrow id="alg1.l19.m1.2.2.2" xref="alg1.l19.m1.2.2.2.cmml">
          <mi id="alg1.l19.m1.2.2.2.4" xref="alg1.l19.m1.2.2.2.4.cmml">
           r
          </mi>
          <mo id="alg1.l19.m1.2.2.2.3" lspace="0em" rspace="0em" xref="alg1.l19.m1.2.2.2.3.cmml">
           ​
          </mo>
          <mrow id="alg1.l19.m1.2.2.2.2.2" xref="alg1.l19.m1.2.2.2.2.3.cmml">
           <mo id="alg1.l19.m1.2.2.2.2.2.3" stretchy="false" xref="alg1.l19.m1.2.2.2.2.3.cmml">
            (
           </mo>
           <msub id="alg1.l19.m1.1.1.1.1.1.1" xref="alg1.l19.m1.1.1.1.1.1.1.cmml">
            <mi id="alg1.l19.m1.1.1.1.1.1.1.2" xref="alg1.l19.m1.1.1.1.1.1.1.2.cmml">
             s
            </mi>
            <mi id="alg1.l19.m1.1.1.1.1.1.1.3" xref="alg1.l19.m1.1.1.1.1.1.1.3.cmml">
             t
            </mi>
           </msub>
           <mo id="alg1.l19.m1.2.2.2.2.2.4" xref="alg1.l19.m1.2.2.2.2.3.cmml">
            ,
           </mo>
           <msub id="alg1.l19.m1.2.2.2.2.2.2" xref="alg1.l19.m1.2.2.2.2.2.2.cmml">
            <mi id="alg1.l19.m1.2.2.2.2.2.2.2" xref="alg1.l19.m1.2.2.2.2.2.2.2.cmml">
             a
            </mi>
            <mi id="alg1.l19.m1.2.2.2.2.2.2.3" xref="alg1.l19.m1.2.2.2.2.2.2.3.cmml">
             t
            </mi>
           </msub>
           <mo id="alg1.l19.m1.2.2.2.2.2.5" stretchy="false" xref="alg1.l19.m1.2.2.2.2.3.cmml">
            )
           </mo>
          </mrow>
         </mrow>
        </mrow>
        <annotation-xml encoding="MathML-Content" id="alg1.l19.m1.2b">
         <apply id="alg1.l19.m1.2.2.cmml" xref="alg1.l19.m1.2.2">
          <ci id="alg1.l19.m1.2.2.3.cmml" xref="alg1.l19.m1.2.2.3">
           ←
          </ci>
          <apply id="alg1.l19.m1.2.2.4.cmml" xref="alg1.l19.m1.2.2.4">
           <csymbol cd="ambiguous" id="alg1.l19.m1.2.2.4.1.cmml" xref="alg1.l19.m1.2.2.4">
            subscript
           </csymbol>
           <ci id="alg1.l19.m1.2.2.4.2.cmml" xref="alg1.l19.m1.2.2.4.2">
            𝑞
           </ci>
           <apply id="alg1.l19.m1.2.2.4.3.cmml" xref="alg1.l19.m1.2.2.4.3">
            <times id="alg1.l19.m1.2.2.4.3.1.cmml" xref="alg1.l19.m1.2.2.4.3.1">
            </times>
            <ci id="alg1.l19.m1.2.2.4.3.2.cmml" xref="alg1.l19.m1.2.2.4.3.2">
             𝑡
            </ci>
            <ci id="alg1.l19.m1.2.2.4.3.3.cmml" xref="alg1.l19.m1.2.2.4.3.3">
             𝑎
            </ci>
            <ci id="alg1.l19.m1.2.2.4.3.4.cmml" xref="alg1.l19.m1.2.2.4.3.4">
             𝑟
            </ci>
            <ci id="alg1.l19.m1.2.2.4.3.5.cmml" xref="alg1.l19.m1.2.2.4.3.5">
             𝑔
            </ci>
           </apply>
          </apply>
          <apply id="alg1.l19.m1.2.2.2.cmml" xref="alg1.l19.m1.2.2.2">
           <times id="alg1.l19.m1.2.2.2.3.cmml" xref="alg1.l19.m1.2.2.2.3">
           </times>
           <ci id="alg1.l19.m1.2.2.2.4.cmml" xref="alg1.l19.m1.2.2.2.4">
            𝑟
           </ci>
           <interval closure="open" id="alg1.l19.m1.2.2.2.2.3.cmml" xref="alg1.l19.m1.2.2.2.2.2">
            <apply id="alg1.l19.m1.1.1.1.1.1.1.cmml" xref="alg1.l19.m1.1.1.1.1.1.1">
             <csymbol cd="ambiguous" id="alg1.l19.m1.1.1.1.1.1.1.1.cmml" xref="alg1.l19.m1.1.1.1.1.1.1">
              subscript
             </csymbol>
             <ci id="alg1.l19.m1.1.1.1.1.1.1.2.cmml" xref="alg1.l19.m1.1.1.1.1.1.1.2">
              𝑠
             </ci>
             <ci id="alg1.l19.m1.1.1.1.1.1.1.3.cmml" xref="alg1.l19.m1.1.1.1.1.1.1.3">
              𝑡
             </ci>
            </apply>
            <apply id="alg1.l19.m1.2.2.2.2.2.2.cmml" xref="alg1.l19.m1.2.2.2.2.2.2">
             <csymbol cd="ambiguous" id="alg1.l19.m1.2.2.2.2.2.2.1.cmml" xref="alg1.l19.m1.2.2.2.2.2.2">
              subscript
             </csymbol>
             <ci id="alg1.l19.m1.2.2.2.2.2.2.2.cmml" xref="alg1.l19.m1.2.2.2.2.2.2.2">
              𝑎
             </ci>
             <ci id="alg1.l19.m1.2.2.2.2.2.2.3.cmml" xref="alg1.l19.m1.2.2.2.2.2.2.3">
              𝑡
             </ci>
            </apply>
           </interval>
          </apply>
         </apply>
        </annotation-xml>
        <annotation encoding="application/x-tex" id="alg1.l19.m1.2c">
         q_{targ}\leftarrow r(s_{t},a_{t})
        </annotation>
       </semantics>
      </math>
     </div>
     <div class="ltx_listingline" id="alg1.l20">
      <math alttext="+\gamma(\mathbb{E}_{w_{t+1}^{1}\sim\pi_{\phi}(s_{t+1})}[Q_{\bar{\theta}}(s_{t+1},w_{t+1}^{1})]" class="ltx_math_unparsed" display="inline" id="alg1.l20.m1.1">
       <semantics id="alg1.l20.m1.1a">
        <mrow id="alg1.l20.m1.1b">
         <mo id="alg1.l20.m1.1.2">
          +
         </mo>
         <mi id="alg1.l20.m1.1.3">
          γ
         </mi>
         <mrow id="alg1.l20.m1.1.4">
          <mo id="alg1.l20.m1.1.4.1" stretchy="false">
           (
          </mo>
          <msub id="alg1.l20.m1.1.4.2">
           <mi id="alg1.l20.m1.1.4.2.2">
            𝔼
           </mi>
           <mrow id="alg1.l20.m1.1.1.1">
            <msubsup id="alg1.l20.m1.1.1.1.3">
             <mi id="alg1.l20.m1.1.1.1.3.2.2">
              w
             </mi>
             <mrow id="alg1.l20.m1.1.1.1.3.2.3">
              <mi id="alg1.l20.m1.1.1.1.3.2.3.2">
               t
              </mi>
              <mo id="alg1.l20.m1.1.1.1.3.2.3.1">
               +
              </mo>
              <mn id="alg1.l20.m1.1.1.1.3.2.3.3">
               1
              </mn>
             </mrow>
             <mn id="alg1.l20.m1.1.1.1.3.3">
              1
             </mn>
            </msubsup>
            <mo id="alg1.l20.m1.1.1.1.2">
             ∼
            </mo>
            <mrow id="alg1.l20.m1.1.1.1.1">
             <msub id="alg1.l20.m1.1.1.1.1.3">
              <mi id="alg1.l20.m1.1.1.1.1.3.2">
               π
              </mi>
              <mi id="alg1.l20.m1.1.1.1.1.3.3">
               ϕ
              </mi>
             </msub>
             <mo id="alg1.l20.m1.1.1.1.1.2" lspace="0em" rspace="0em">
              ​
             </mo>
             <mrow id="alg1.l20.m1.1.1.1.1.1.1">
              <mo id="alg1.l20.m1.1.1.1.1.1.1.2" stretchy="false">
               (
              </mo>
              <msub id="alg1.l20.m1.1.1.1.1.1.1.1">
               <mi id="alg1.l20.m1.1.1.1.1.1.1.1.2">
                s
               </mi>
               <mrow id="alg1.l20.m1.1.1.1.1.1.1.1.3">
                <mi id="alg1.l20.m1.1.1.1.1.1.1.1.3.2">
                 t
                </mi>
                <mo id="alg1.l20.m1.1.1.1.1.1.1.1.3.1">
                 +
                </mo>
                <mn id="alg1.l20.m1.1.1.1.1.1.1.1.3.3">
                 1
                </mn>
               </mrow>
              </msub>
              <mo id="alg1.l20.m1.1.1.1.1.1.1.3" stretchy="false">
               )
              </mo>
             </mrow>
            </mrow>
           </mrow>
          </msub>
          <mrow id="alg1.l20.m1.1.4.3">
           <mo id="alg1.l20.m1.1.4.3.1" stretchy="false">
            [
           </mo>
           <msub id="alg1.l20.m1.1.4.3.2">
            <mi id="alg1.l20.m1.1.4.3.2.2">
             Q
            </mi>
            <mover accent="true" id="alg1.l20.m1.1.4.3.2.3">
             <mi id="alg1.l20.m1.1.4.3.2.3.2">
              θ
             </mi>
             <mo id="alg1.l20.m1.1.4.3.2.3.1">
              ¯
             </mo>
            </mover>
           </msub>
           <mrow id="alg1.l20.m1.1.4.3.3">
            <mo id="alg1.l20.m1.1.4.3.3.1" stretchy="false">
             (
            </mo>
            <msub id="alg1.l20.m1.1.4.3.3.2">
             <mi id="alg1.l20.m1.1.4.3.3.2.2">
              s
             </mi>
             <mrow id="alg1.l20.m1.1.4.3.3.2.3">
              <mi id="alg1.l20.m1.1.4.3.3.2.3.2">
               t
              </mi>
              <mo id="alg1.l20.m1.1.4.3.3.2.3.1">
               +
              </mo>
              <mn id="alg1.l20.m1.1.4.3.3.2.3.3">
               1
              </mn>
             </mrow>
            </msub>
            <mo id="alg1.l20.m1.1.4.3.3.3">
             ,
            </mo>
            <msubsup id="alg1.l20.m1.1.4.3.3.4">
             <mi id="alg1.l20.m1.1.4.3.3.4.2.2">
              w
             </mi>
             <mrow id="alg1.l20.m1.1.4.3.3.4.2.3">
              <mi id="alg1.l20.m1.1.4.3.3.4.2.3.2">
               t
              </mi>
              <mo id="alg1.l20.m1.1.4.3.3.4.2.3.1">
               +
              </mo>
              <mn id="alg1.l20.m1.1.4.3.3.4.2.3.3">
               1
              </mn>
             </mrow>
             <mn id="alg1.l20.m1.1.4.3.3.4.3">
              1
             </mn>
            </msubsup>
            <mo id="alg1.l20.m1.1.4.3.3.5" stretchy="false">
             )
            </mo>
           </mrow>
           <mo id="alg1.l20.m1.1.4.3.4" stretchy="false">
            ]
           </mo>
          </mrow>
         </mrow>
        </mrow>
        <annotation encoding="application/x-tex" id="alg1.l20.m1.1c">
         +\gamma(\mathbb{E}_{w_{t+1}^{1}\sim\pi_{\phi}(s_{t+1})}[Q_{\bar{\theta}}(s_{t+1},w_{t+1}^{1})]
        </annotation>
       </semantics>
      </math>
     </div>
     <div class="ltx_listingline" id="alg1.l21">
      <math alttext="-\beta D_{KL}[\pi_{\phi}||\bar{\pi}_{\bar{\phi}}](s_{t+1})" class="ltx_math_unparsed" display="inline" id="alg1.l21.m1.1">
       <semantics id="alg1.l21.m1.1a">
        <mrow id="alg1.l21.m1.1b">
         <mo id="alg1.l21.m1.1.1">
          −
         </mo>
         <mi id="alg1.l21.m1.1.2">
          β
         </mi>
         <msub id="alg1.l21.m1.1.3">
          <mi id="alg1.l21.m1.1.3.2">
           D
          </mi>
          <mrow id="alg1.l21.m1.1.3.3">
           <mi id="alg1.l21.m1.1.3.3.2">
            K
           </mi>
           <mo id="alg1.l21.m1.1.3.3.1" lspace="0em" rspace="0em">
            ​
           </mo>
           <mi id="alg1.l21.m1.1.3.3.3">
            L
           </mi>
          </mrow>
         </msub>
         <mrow id="alg1.l21.m1.1.4">
          <mo id="alg1.l21.m1.1.4.1" stretchy="false">
           [
          </mo>
          <msub id="alg1.l21.m1.1.4.2">
           <mi id="alg1.l21.m1.1.4.2.2">
            π
           </mi>
           <mi id="alg1.l21.m1.1.4.2.3">
            ϕ
           </mi>
          </msub>
          <mo fence="false" id="alg1.l21.m1.1.4.3" rspace="0.167em" stretchy="false">
           |
          </mo>
          <mo fence="false" id="alg1.l21.m1.1.4.4" rspace="0.167em" stretchy="false">
           |
          </mo>
          <msub id="alg1.l21.m1.1.4.5">
           <mover accent="true" id="alg1.l21.m1.1.4.5.2">
            <mi id="alg1.l21.m1.1.4.5.2.2">
             π
            </mi>
            <mo id="alg1.l21.m1.1.4.5.2.1">
             ¯
            </mo>
           </mover>
           <mover accent="true" id="alg1.l21.m1.1.4.5.3">
            <mi id="alg1.l21.m1.1.4.5.3.2">
             ϕ
            </mi>
            <mo id="alg1.l21.m1.1.4.5.3.1">
             ¯
            </mo>
           </mover>
          </msub>
          <mo id="alg1.l21.m1.1.4.6" stretchy="false">
           ]
          </mo>
         </mrow>
         <mrow id="alg1.l21.m1.1.5">
          <mo id="alg1.l21.m1.1.5.1" stretchy="false">
           (
          </mo>
          <msub id="alg1.l21.m1.1.5.2">
           <mi id="alg1.l21.m1.1.5.2.2">
            s
           </mi>
           <mrow id="alg1.l21.m1.1.5.2.3">
            <mi id="alg1.l21.m1.1.5.2.3.2">
             t
            </mi>
            <mo id="alg1.l21.m1.1.5.2.3.1">
             +
            </mo>
            <mn id="alg1.l21.m1.1.5.2.3.3">
             1
            </mn>
           </mrow>
          </msub>
          <mo id="alg1.l21.m1.1.5.3" stretchy="false">
           )
          </mo>
         </mrow>
        </mrow>
        <annotation encoding="application/x-tex" id="alg1.l21.m1.1c">
         -\beta D_{KL}[\pi_{\phi}||\bar{\pi}_{\bar{\phi}}](s_{t+1})
        </annotation>
       </semantics>
      </math>
     </div>
     <div class="ltx_listingline" id="alg1.l22">
      <span class="ltx_text ltx_font_bold" id="alg1.l22.1">
       end
      </span>
      <span class="ltx_text ltx_font_bold" id="alg1.l22.2">
       if
      </span>
     </div>
     <div class="ltx_listingline" id="alg1.l23">
      <span class="ltx_text ltx_font_bold" id="alg1.l23.1">
       end
      </span>
      <span class="ltx_text ltx_font_bold" id="alg1.l23.2">
       for
      </span>
     </div>
     <div class="ltx_listingline" id="alg1.l24">
      <span class="ltx_text ltx_font_bold" id="alg1.l24.1">
       end
      </span>
      <span class="ltx_text ltx_font_bold" id="alg1.l24.2">
       for
      </span>
     </div>
     <div class="ltx_listingline" id="alg1.l25">
      <math alttext="\theta\leftarrow\theta-\alpha\nabla_{\theta}\mathbb{E}_{\mathcal{B}}[(q-q_{targ})^{2}]" class="ltx_Math" display="inline" id="alg1.l25.m1.1">
       <semantics id="alg1.l25.m1.1a">
        <mrow id="alg1.l25.m1.1.1" xref="alg1.l25.m1.1.1.cmml">
         <mi id="alg1.l25.m1.1.1.3" xref="alg1.l25.m1.1.1.3.cmml">
          θ
         </mi>
         <mo id="alg1.l25.m1.1.1.2" stretchy="false" xref="alg1.l25.m1.1.1.2.cmml">
          ←
         </mo>
         <mrow id="alg1.l25.m1.1.1.1" xref="alg1.l25.m1.1.1.1.cmml">
          <mi id="alg1.l25.m1.1.1.1.3" xref="alg1.l25.m1.1.1.1.3.cmml">
           θ
          </mi>
          <mo id="alg1.l25.m1.1.1.1.2" xref="alg1.l25.m1.1.1.1.2.cmml">
           −
          </mo>
          <mrow id="alg1.l25.m1.1.1.1.1" xref="alg1.l25.m1.1.1.1.1.cmml">
           <mi id="alg1.l25.m1.1.1.1.1.3" xref="alg1.l25.m1.1.1.1.1.3.cmml">
            α
           </mi>
           <mo id="alg1.l25.m1.1.1.1.1.2" lspace="0.167em" rspace="0em" xref="alg1.l25.m1.1.1.1.1.2.cmml">
            ​
           </mo>
           <mrow id="alg1.l25.m1.1.1.1.1.4" xref="alg1.l25.m1.1.1.1.1.4.cmml">
            <msub id="alg1.l25.m1.1.1.1.1.4.1" xref="alg1.l25.m1.1.1.1.1.4.1.cmml">
             <mo id="alg1.l25.m1.1.1.1.1.4.1.2" rspace="0.167em" xref="alg1.l25.m1.1.1.1.1.4.1.2.cmml">
              ∇
             </mo>
             <mi id="alg1.l25.m1.1.1.1.1.4.1.3" xref="alg1.l25.m1.1.1.1.1.4.1.3.cmml">
              θ
             </mi>
            </msub>
            <msub id="alg1.l25.m1.1.1.1.1.4.2" xref="alg1.l25.m1.1.1.1.1.4.2.cmml">
             <mi id="alg1.l25.m1.1.1.1.1.4.2.2" xref="alg1.l25.m1.1.1.1.1.4.2.2.cmml">
              𝔼
             </mi>
             <mi class="ltx_font_mathcaligraphic" id="alg1.l25.m1.1.1.1.1.4.2.3" xref="alg1.l25.m1.1.1.1.1.4.2.3.cmml">
              ℬ
             </mi>
            </msub>
           </mrow>
           <mo id="alg1.l25.m1.1.1.1.1.2a" lspace="0em" rspace="0em" xref="alg1.l25.m1.1.1.1.1.2.cmml">
            ​
           </mo>
           <mrow id="alg1.l25.m1.1.1.1.1.1.1" xref="alg1.l25.m1.1.1.1.1.1.2.cmml">
            <mo id="alg1.l25.m1.1.1.1.1.1.1.2" stretchy="false" xref="alg1.l25.m1.1.1.1.1.1.2.1.cmml">
             [
            </mo>
            <msup id="alg1.l25.m1.1.1.1.1.1.1.1" xref="alg1.l25.m1.1.1.1.1.1.1.1.cmml">
             <mrow id="alg1.l25.m1.1.1.1.1.1.1.1.1.1" xref="alg1.l25.m1.1.1.1.1.1.1.1.1.1.1.cmml">
              <mo id="alg1.l25.m1.1.1.1.1.1.1.1.1.1.2" stretchy="false" xref="alg1.l25.m1.1.1.1.1.1.1.1.1.1.1.cmml">
               (
              </mo>
              <mrow id="alg1.l25.m1.1.1.1.1.1.1.1.1.1.1" xref="alg1.l25.m1.1.1.1.1.1.1.1.1.1.1.cmml">
               <mi id="alg1.l25.m1.1.1.1.1.1.1.1.1.1.1.2" xref="alg1.l25.m1.1.1.1.1.1.1.1.1.1.1.2.cmml">
                q
               </mi>
               <mo id="alg1.l25.m1.1.1.1.1.1.1.1.1.1.1.1" xref="alg1.l25.m1.1.1.1.1.1.1.1.1.1.1.1.cmml">
                −
               </mo>
               <msub id="alg1.l25.m1.1.1.1.1.1.1.1.1.1.1.3" xref="alg1.l25.m1.1.1.1.1.1.1.1.1.1.1.3.cmml">
                <mi id="alg1.l25.m1.1.1.1.1.1.1.1.1.1.1.3.2" xref="alg1.l25.m1.1.1.1.1.1.1.1.1.1.1.3.2.cmml">
                 q
                </mi>
                <mrow id="alg1.l25.m1.1.1.1.1.1.1.1.1.1.1.3.3" xref="alg1.l25.m1.1.1.1.1.1.1.1.1.1.1.3.3.cmml">
                 <mi id="alg1.l25.m1.1.1.1.1.1.1.1.1.1.1.3.3.2" xref="alg1.l25.m1.1.1.1.1.1.1.1.1.1.1.3.3.2.cmml">
                  t
                 </mi>
                 <mo id="alg1.l25.m1.1.1.1.1.1.1.1.1.1.1.3.3.1" lspace="0em" rspace="0em" xref="alg1.l25.m1.1.1.1.1.1.1.1.1.1.1.3.3.1.cmml">
                  ​
                 </mo>
                 <mi id="alg1.l25.m1.1.1.1.1.1.1.1.1.1.1.3.3.3" xref="alg1.l25.m1.1.1.1.1.1.1.1.1.1.1.3.3.3.cmml">
                  a
                 </mi>
                 <mo id="alg1.l25.m1.1.1.1.1.1.1.1.1.1.1.3.3.1a" lspace="0em" rspace="0em" xref="alg1.l25.m1.1.1.1.1.1.1.1.1.1.1.3.3.1.cmml">
                  ​
                 </mo>
                 <mi id="alg1.l25.m1.1.1.1.1.1.1.1.1.1.1.3.3.4" xref="alg1.l25.m1.1.1.1.1.1.1.1.1.1.1.3.3.4.cmml">
                  r
                 </mi>
                 <mo id="alg1.l25.m1.1.1.1.1.1.1.1.1.1.1.3.3.1b" lspace="0em" rspace="0em" xref="alg1.l25.m1.1.1.1.1.1.1.1.1.1.1.3.3.1.cmml">
                  ​
                 </mo>
                 <mi id="alg1.l25.m1.1.1.1.1.1.1.1.1.1.1.3.3.5" xref="alg1.l25.m1.1.1.1.1.1.1.1.1.1.1.3.3.5.cmml">
                  g
                 </mi>
                </mrow>
               </msub>
              </mrow>
              <mo id="alg1.l25.m1.1.1.1.1.1.1.1.1.1.3" stretchy="false" xref="alg1.l25.m1.1.1.1.1.1.1.1.1.1.1.cmml">
               )
              </mo>
             </mrow>
             <mn id="alg1.l25.m1.1.1.1.1.1.1.1.3" xref="alg1.l25.m1.1.1.1.1.1.1.1.3.cmml">
              2
             </mn>
            </msup>
            <mo id="alg1.l25.m1.1.1.1.1.1.1.3" stretchy="false" xref="alg1.l25.m1.1.1.1.1.1.2.1.cmml">
             ]
            </mo>
           </mrow>
          </mrow>
         </mrow>
        </mrow>
        <annotation-xml encoding="MathML-Content" id="alg1.l25.m1.1b">
         <apply id="alg1.l25.m1.1.1.cmml" xref="alg1.l25.m1.1.1">
          <ci id="alg1.l25.m1.1.1.2.cmml" xref="alg1.l25.m1.1.1.2">
           ←
          </ci>
          <ci id="alg1.l25.m1.1.1.3.cmml" xref="alg1.l25.m1.1.1.3">
           𝜃
          </ci>
          <apply id="alg1.l25.m1.1.1.1.cmml" xref="alg1.l25.m1.1.1.1">
           <minus id="alg1.l25.m1.1.1.1.2.cmml" xref="alg1.l25.m1.1.1.1.2">
           </minus>
           <ci id="alg1.l25.m1.1.1.1.3.cmml" xref="alg1.l25.m1.1.1.1.3">
            𝜃
           </ci>
           <apply id="alg1.l25.m1.1.1.1.1.cmml" xref="alg1.l25.m1.1.1.1.1">
            <times id="alg1.l25.m1.1.1.1.1.2.cmml" xref="alg1.l25.m1.1.1.1.1.2">
            </times>
            <ci id="alg1.l25.m1.1.1.1.1.3.cmml" xref="alg1.l25.m1.1.1.1.1.3">
             𝛼
            </ci>
            <apply id="alg1.l25.m1.1.1.1.1.4.cmml" xref="alg1.l25.m1.1.1.1.1.4">
             <apply id="alg1.l25.m1.1.1.1.1.4.1.cmml" xref="alg1.l25.m1.1.1.1.1.4.1">
              <csymbol cd="ambiguous" id="alg1.l25.m1.1.1.1.1.4.1.1.cmml" xref="alg1.l25.m1.1.1.1.1.4.1">
               subscript
              </csymbol>
              <ci id="alg1.l25.m1.1.1.1.1.4.1.2.cmml" xref="alg1.l25.m1.1.1.1.1.4.1.2">
               ∇
              </ci>
              <ci id="alg1.l25.m1.1.1.1.1.4.1.3.cmml" xref="alg1.l25.m1.1.1.1.1.4.1.3">
               𝜃
              </ci>
             </apply>
             <apply id="alg1.l25.m1.1.1.1.1.4.2.cmml" xref="alg1.l25.m1.1.1.1.1.4.2">
              <csymbol cd="ambiguous" id="alg1.l25.m1.1.1.1.1.4.2.1.cmml" xref="alg1.l25.m1.1.1.1.1.4.2">
               subscript
              </csymbol>
              <ci id="alg1.l25.m1.1.1.1.1.4.2.2.cmml" xref="alg1.l25.m1.1.1.1.1.4.2.2">
               𝔼
              </ci>
              <ci id="alg1.l25.m1.1.1.1.1.4.2.3.cmml" xref="alg1.l25.m1.1.1.1.1.4.2.3">
               ℬ
              </ci>
             </apply>
            </apply>
            <apply id="alg1.l25.m1.1.1.1.1.1.2.cmml" xref="alg1.l25.m1.1.1.1.1.1.1">
             <csymbol cd="latexml" id="alg1.l25.m1.1.1.1.1.1.2.1.cmml" xref="alg1.l25.m1.1.1.1.1.1.1.2">
              delimited-[]
             </csymbol>
             <apply id="alg1.l25.m1.1.1.1.1.1.1.1.cmml" xref="alg1.l25.m1.1.1.1.1.1.1.1">
              <csymbol cd="ambiguous" id="alg1.l25.m1.1.1.1.1.1.1.1.2.cmml" xref="alg1.l25.m1.1.1.1.1.1.1.1">
               superscript
              </csymbol>
              <apply id="alg1.l25.m1.1.1.1.1.1.1.1.1.1.1.cmml" xref="alg1.l25.m1.1.1.1.1.1.1.1.1.1">
               <minus id="alg1.l25.m1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="alg1.l25.m1.1.1.1.1.1.1.1.1.1.1.1">
               </minus>
               <ci id="alg1.l25.m1.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="alg1.l25.m1.1.1.1.1.1.1.1.1.1.1.2">
                𝑞
               </ci>
               <apply id="alg1.l25.m1.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="alg1.l25.m1.1.1.1.1.1.1.1.1.1.1.3">
                <csymbol cd="ambiguous" id="alg1.l25.m1.1.1.1.1.1.1.1.1.1.1.3.1.cmml" xref="alg1.l25.m1.1.1.1.1.1.1.1.1.1.1.3">
                 subscript
                </csymbol>
                <ci id="alg1.l25.m1.1.1.1.1.1.1.1.1.1.1.3.2.cmml" xref="alg1.l25.m1.1.1.1.1.1.1.1.1.1.1.3.2">
                 𝑞
                </ci>
                <apply id="alg1.l25.m1.1.1.1.1.1.1.1.1.1.1.3.3.cmml" xref="alg1.l25.m1.1.1.1.1.1.1.1.1.1.1.3.3">
                 <times id="alg1.l25.m1.1.1.1.1.1.1.1.1.1.1.3.3.1.cmml" xref="alg1.l25.m1.1.1.1.1.1.1.1.1.1.1.3.3.1">
                 </times>
                 <ci id="alg1.l25.m1.1.1.1.1.1.1.1.1.1.1.3.3.2.cmml" xref="alg1.l25.m1.1.1.1.1.1.1.1.1.1.1.3.3.2">
                  𝑡
                 </ci>
                 <ci id="alg1.l25.m1.1.1.1.1.1.1.1.1.1.1.3.3.3.cmml" xref="alg1.l25.m1.1.1.1.1.1.1.1.1.1.1.3.3.3">
                  𝑎
                 </ci>
                 <ci id="alg1.l25.m1.1.1.1.1.1.1.1.1.1.1.3.3.4.cmml" xref="alg1.l25.m1.1.1.1.1.1.1.1.1.1.1.3.3.4">
                  𝑟
                 </ci>
                 <ci id="alg1.l25.m1.1.1.1.1.1.1.1.1.1.1.3.3.5.cmml" xref="alg1.l25.m1.1.1.1.1.1.1.1.1.1.1.3.3.5">
                  𝑔
                 </ci>
                </apply>
               </apply>
              </apply>
              <cn id="alg1.l25.m1.1.1.1.1.1.1.1.3.cmml" type="integer" xref="alg1.l25.m1.1.1.1.1.1.1.1.3">
               2
              </cn>
             </apply>
            </apply>
           </apply>
          </apply>
         </apply>
        </annotation-xml>
        <annotation encoding="application/x-tex" id="alg1.l25.m1.1c">
         \theta\leftarrow\theta-\alpha\nabla_{\theta}\mathbb{E}_{\mathcal{B}}[(q-q_{targ})^{2}]
        </annotation>
       </semantics>
      </math>
     </div>
     <div class="ltx_listingline" id="alg1.l26">
      <math alttext="\phi\leftarrow\phi-\alpha\nabla_{\phi}\mathbb{E}_{\mathcal{B}}[\mathcal{J}_{Q_{\theta}}(\pi_{\phi})]" class="ltx_Math" display="inline" id="alg1.l26.m1.1">
       <semantics id="alg1.l26.m1.1a">
        <mrow id="alg1.l26.m1.1.1" xref="alg1.l26.m1.1.1.cmml">
         <mi id="alg1.l26.m1.1.1.3" xref="alg1.l26.m1.1.1.3.cmml">
          ϕ
         </mi>
         <mo id="alg1.l26.m1.1.1.2" stretchy="false" xref="alg1.l26.m1.1.1.2.cmml">
          ←
         </mo>
         <mrow id="alg1.l26.m1.1.1.1" xref="alg1.l26.m1.1.1.1.cmml">
          <mi id="alg1.l26.m1.1.1.1.3" xref="alg1.l26.m1.1.1.1.3.cmml">
           ϕ
          </mi>
          <mo id="alg1.l26.m1.1.1.1.2" xref="alg1.l26.m1.1.1.1.2.cmml">
           −
          </mo>
          <mrow id="alg1.l26.m1.1.1.1.1" xref="alg1.l26.m1.1.1.1.1.cmml">
           <mi id="alg1.l26.m1.1.1.1.1.3" xref="alg1.l26.m1.1.1.1.1.3.cmml">
            α
           </mi>
           <mo id="alg1.l26.m1.1.1.1.1.2" lspace="0.167em" rspace="0em" xref="alg1.l26.m1.1.1.1.1.2.cmml">
            ​
           </mo>
           <mrow id="alg1.l26.m1.1.1.1.1.4" xref="alg1.l26.m1.1.1.1.1.4.cmml">
            <msub id="alg1.l26.m1.1.1.1.1.4.1" xref="alg1.l26.m1.1.1.1.1.4.1.cmml">
             <mo id="alg1.l26.m1.1.1.1.1.4.1.2" rspace="0.167em" xref="alg1.l26.m1.1.1.1.1.4.1.2.cmml">
              ∇
             </mo>
             <mi id="alg1.l26.m1.1.1.1.1.4.1.3" xref="alg1.l26.m1.1.1.1.1.4.1.3.cmml">
              ϕ
             </mi>
            </msub>
            <msub id="alg1.l26.m1.1.1.1.1.4.2" xref="alg1.l26.m1.1.1.1.1.4.2.cmml">
             <mi id="alg1.l26.m1.1.1.1.1.4.2.2" xref="alg1.l26.m1.1.1.1.1.4.2.2.cmml">
              𝔼
             </mi>
             <mi class="ltx_font_mathcaligraphic" id="alg1.l26.m1.1.1.1.1.4.2.3" xref="alg1.l26.m1.1.1.1.1.4.2.3.cmml">
              ℬ
             </mi>
            </msub>
           </mrow>
           <mo id="alg1.l26.m1.1.1.1.1.2a" lspace="0em" rspace="0em" xref="alg1.l26.m1.1.1.1.1.2.cmml">
            ​
           </mo>
           <mrow id="alg1.l26.m1.1.1.1.1.1.1" xref="alg1.l26.m1.1.1.1.1.1.2.cmml">
            <mo id="alg1.l26.m1.1.1.1.1.1.1.2" stretchy="false" xref="alg1.l26.m1.1.1.1.1.1.2.1.cmml">
             [
            </mo>
            <mrow id="alg1.l26.m1.1.1.1.1.1.1.1" xref="alg1.l26.m1.1.1.1.1.1.1.1.cmml">
             <msub id="alg1.l26.m1.1.1.1.1.1.1.1.3" xref="alg1.l26.m1.1.1.1.1.1.1.1.3.cmml">
              <mi class="ltx_font_mathcaligraphic" id="alg1.l26.m1.1.1.1.1.1.1.1.3.2" xref="alg1.l26.m1.1.1.1.1.1.1.1.3.2.cmml">
               𝒥
              </mi>
              <msub id="alg1.l26.m1.1.1.1.1.1.1.1.3.3" xref="alg1.l26.m1.1.1.1.1.1.1.1.3.3.cmml">
               <mi id="alg1.l26.m1.1.1.1.1.1.1.1.3.3.2" xref="alg1.l26.m1.1.1.1.1.1.1.1.3.3.2.cmml">
                Q
               </mi>
               <mi id="alg1.l26.m1.1.1.1.1.1.1.1.3.3.3" xref="alg1.l26.m1.1.1.1.1.1.1.1.3.3.3.cmml">
                θ
               </mi>
              </msub>
             </msub>
             <mo id="alg1.l26.m1.1.1.1.1.1.1.1.2" lspace="0em" rspace="0em" xref="alg1.l26.m1.1.1.1.1.1.1.1.2.cmml">
              ​
             </mo>
             <mrow id="alg1.l26.m1.1.1.1.1.1.1.1.1.1" xref="alg1.l26.m1.1.1.1.1.1.1.1.1.1.1.cmml">
              <mo id="alg1.l26.m1.1.1.1.1.1.1.1.1.1.2" stretchy="false" xref="alg1.l26.m1.1.1.1.1.1.1.1.1.1.1.cmml">
               (
              </mo>
              <msub id="alg1.l26.m1.1.1.1.1.1.1.1.1.1.1" xref="alg1.l26.m1.1.1.1.1.1.1.1.1.1.1.cmml">
               <mi id="alg1.l26.m1.1.1.1.1.1.1.1.1.1.1.2" xref="alg1.l26.m1.1.1.1.1.1.1.1.1.1.1.2.cmml">
                π
               </mi>
               <mi id="alg1.l26.m1.1.1.1.1.1.1.1.1.1.1.3" xref="alg1.l26.m1.1.1.1.1.1.1.1.1.1.1.3.cmml">
                ϕ
               </mi>
              </msub>
              <mo id="alg1.l26.m1.1.1.1.1.1.1.1.1.1.3" stretchy="false" xref="alg1.l26.m1.1.1.1.1.1.1.1.1.1.1.cmml">
               )
              </mo>
             </mrow>
            </mrow>
            <mo id="alg1.l26.m1.1.1.1.1.1.1.3" stretchy="false" xref="alg1.l26.m1.1.1.1.1.1.2.1.cmml">
             ]
            </mo>
           </mrow>
          </mrow>
         </mrow>
        </mrow>
        <annotation-xml encoding="MathML-Content" id="alg1.l26.m1.1b">
         <apply id="alg1.l26.m1.1.1.cmml" xref="alg1.l26.m1.1.1">
          <ci id="alg1.l26.m1.1.1.2.cmml" xref="alg1.l26.m1.1.1.2">
           ←
          </ci>
          <ci id="alg1.l26.m1.1.1.3.cmml" xref="alg1.l26.m1.1.1.3">
           italic-ϕ
          </ci>
          <apply id="alg1.l26.m1.1.1.1.cmml" xref="alg1.l26.m1.1.1.1">
           <minus id="alg1.l26.m1.1.1.1.2.cmml" xref="alg1.l26.m1.1.1.1.2">
           </minus>
           <ci id="alg1.l26.m1.1.1.1.3.cmml" xref="alg1.l26.m1.1.1.1.3">
            italic-ϕ
           </ci>
           <apply id="alg1.l26.m1.1.1.1.1.cmml" xref="alg1.l26.m1.1.1.1.1">
            <times id="alg1.l26.m1.1.1.1.1.2.cmml" xref="alg1.l26.m1.1.1.1.1.2">
            </times>
            <ci id="alg1.l26.m1.1.1.1.1.3.cmml" xref="alg1.l26.m1.1.1.1.1.3">
             𝛼
            </ci>
            <apply id="alg1.l26.m1.1.1.1.1.4.cmml" xref="alg1.l26.m1.1.1.1.1.4">
             <apply id="alg1.l26.m1.1.1.1.1.4.1.cmml" xref="alg1.l26.m1.1.1.1.1.4.1">
              <csymbol cd="ambiguous" id="alg1.l26.m1.1.1.1.1.4.1.1.cmml" xref="alg1.l26.m1.1.1.1.1.4.1">
               subscript
              </csymbol>
              <ci id="alg1.l26.m1.1.1.1.1.4.1.2.cmml" xref="alg1.l26.m1.1.1.1.1.4.1.2">
               ∇
              </ci>
              <ci id="alg1.l26.m1.1.1.1.1.4.1.3.cmml" xref="alg1.l26.m1.1.1.1.1.4.1.3">
               italic-ϕ
              </ci>
             </apply>
             <apply id="alg1.l26.m1.1.1.1.1.4.2.cmml" xref="alg1.l26.m1.1.1.1.1.4.2">
              <csymbol cd="ambiguous" id="alg1.l26.m1.1.1.1.1.4.2.1.cmml" xref="alg1.l26.m1.1.1.1.1.4.2">
               subscript
              </csymbol>
              <ci id="alg1.l26.m1.1.1.1.1.4.2.2.cmml" xref="alg1.l26.m1.1.1.1.1.4.2.2">
               𝔼
              </ci>
              <ci id="alg1.l26.m1.1.1.1.1.4.2.3.cmml" xref="alg1.l26.m1.1.1.1.1.4.2.3">
               ℬ
              </ci>
             </apply>
            </apply>
            <apply id="alg1.l26.m1.1.1.1.1.1.2.cmml" xref="alg1.l26.m1.1.1.1.1.1.1">
             <csymbol cd="latexml" id="alg1.l26.m1.1.1.1.1.1.2.1.cmml" xref="alg1.l26.m1.1.1.1.1.1.1.2">
              delimited-[]
             </csymbol>
             <apply id="alg1.l26.m1.1.1.1.1.1.1.1.cmml" xref="alg1.l26.m1.1.1.1.1.1.1.1">
              <times id="alg1.l26.m1.1.1.1.1.1.1.1.2.cmml" xref="alg1.l26.m1.1.1.1.1.1.1.1.2">
              </times>
              <apply id="alg1.l26.m1.1.1.1.1.1.1.1.3.cmml" xref="alg1.l26.m1.1.1.1.1.1.1.1.3">
               <csymbol cd="ambiguous" id="alg1.l26.m1.1.1.1.1.1.1.1.3.1.cmml" xref="alg1.l26.m1.1.1.1.1.1.1.1.3">
                subscript
               </csymbol>
               <ci id="alg1.l26.m1.1.1.1.1.1.1.1.3.2.cmml" xref="alg1.l26.m1.1.1.1.1.1.1.1.3.2">
                𝒥
               </ci>
               <apply id="alg1.l26.m1.1.1.1.1.1.1.1.3.3.cmml" xref="alg1.l26.m1.1.1.1.1.1.1.1.3.3">
                <csymbol cd="ambiguous" id="alg1.l26.m1.1.1.1.1.1.1.1.3.3.1.cmml" xref="alg1.l26.m1.1.1.1.1.1.1.1.3.3">
                 subscript
                </csymbol>
                <ci id="alg1.l26.m1.1.1.1.1.1.1.1.3.3.2.cmml" xref="alg1.l26.m1.1.1.1.1.1.1.1.3.3.2">
                 𝑄
                </ci>
                <ci id="alg1.l26.m1.1.1.1.1.1.1.1.3.3.3.cmml" xref="alg1.l26.m1.1.1.1.1.1.1.1.3.3.3">
                 𝜃
                </ci>
               </apply>
              </apply>
              <apply id="alg1.l26.m1.1.1.1.1.1.1.1.1.1.1.cmml" xref="alg1.l26.m1.1.1.1.1.1.1.1.1.1">
               <csymbol cd="ambiguous" id="alg1.l26.m1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="alg1.l26.m1.1.1.1.1.1.1.1.1.1">
                subscript
               </csymbol>
               <ci id="alg1.l26.m1.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="alg1.l26.m1.1.1.1.1.1.1.1.1.1.1.2">
                𝜋
               </ci>
               <ci id="alg1.l26.m1.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="alg1.l26.m1.1.1.1.1.1.1.1.1.1.1.3">
                italic-ϕ
               </ci>
              </apply>
             </apply>
            </apply>
           </apply>
          </apply>
         </apply>
        </annotation-xml>
        <annotation encoding="application/x-tex" id="alg1.l26.m1.1c">
         \phi\leftarrow\phi-\alpha\nabla_{\phi}\mathbb{E}_{\mathcal{B}}[\mathcal{J}_{Q_{\theta}}(\pi_{\phi})]
        </annotation>
       </semantics>
      </math>
     </div>
     <div class="ltx_listingline" id="alg1.l27">
      <math alttext="\bar{\theta}\leftarrow\lambda\bar{\theta}+(1-\lambda)\theta" class="ltx_Math" display="inline" id="alg1.l27.m1.1">
       <semantics id="alg1.l27.m1.1a">
        <mrow id="alg1.l27.m1.1.1" xref="alg1.l27.m1.1.1.cmml">
         <mover accent="true" id="alg1.l27.m1.1.1.3" xref="alg1.l27.m1.1.1.3.cmml">
          <mi id="alg1.l27.m1.1.1.3.2" xref="alg1.l27.m1.1.1.3.2.cmml">
           θ
          </mi>
          <mo id="alg1.l27.m1.1.1.3.1" xref="alg1.l27.m1.1.1.3.1.cmml">
           ¯
          </mo>
         </mover>
         <mo id="alg1.l27.m1.1.1.2" stretchy="false" xref="alg1.l27.m1.1.1.2.cmml">
          ←
         </mo>
         <mrow id="alg1.l27.m1.1.1.1" xref="alg1.l27.m1.1.1.1.cmml">
          <mrow id="alg1.l27.m1.1.1.1.3" xref="alg1.l27.m1.1.1.1.3.cmml">
           <mi id="alg1.l27.m1.1.1.1.3.2" xref="alg1.l27.m1.1.1.1.3.2.cmml">
            λ
           </mi>
           <mo id="alg1.l27.m1.1.1.1.3.1" lspace="0em" rspace="0em" xref="alg1.l27.m1.1.1.1.3.1.cmml">
            ​
           </mo>
           <mover accent="true" id="alg1.l27.m1.1.1.1.3.3" xref="alg1.l27.m1.1.1.1.3.3.cmml">
            <mi id="alg1.l27.m1.1.1.1.3.3.2" xref="alg1.l27.m1.1.1.1.3.3.2.cmml">
             θ
            </mi>
            <mo id="alg1.l27.m1.1.1.1.3.3.1" xref="alg1.l27.m1.1.1.1.3.3.1.cmml">
             ¯
            </mo>
           </mover>
          </mrow>
          <mo id="alg1.l27.m1.1.1.1.2" xref="alg1.l27.m1.1.1.1.2.cmml">
           +
          </mo>
          <mrow id="alg1.l27.m1.1.1.1.1" xref="alg1.l27.m1.1.1.1.1.cmml">
           <mrow id="alg1.l27.m1.1.1.1.1.1.1" xref="alg1.l27.m1.1.1.1.1.1.1.1.cmml">
            <mo id="alg1.l27.m1.1.1.1.1.1.1.2" stretchy="false" xref="alg1.l27.m1.1.1.1.1.1.1.1.cmml">
             (
            </mo>
            <mrow id="alg1.l27.m1.1.1.1.1.1.1.1" xref="alg1.l27.m1.1.1.1.1.1.1.1.cmml">
             <mn id="alg1.l27.m1.1.1.1.1.1.1.1.2" xref="alg1.l27.m1.1.1.1.1.1.1.1.2.cmml">
              1
             </mn>
             <mo id="alg1.l27.m1.1.1.1.1.1.1.1.1" xref="alg1.l27.m1.1.1.1.1.1.1.1.1.cmml">
              −
             </mo>
             <mi id="alg1.l27.m1.1.1.1.1.1.1.1.3" xref="alg1.l27.m1.1.1.1.1.1.1.1.3.cmml">
              λ
             </mi>
            </mrow>
            <mo id="alg1.l27.m1.1.1.1.1.1.1.3" stretchy="false" xref="alg1.l27.m1.1.1.1.1.1.1.1.cmml">
             )
            </mo>
           </mrow>
           <mo id="alg1.l27.m1.1.1.1.1.2" lspace="0em" rspace="0em" xref="alg1.l27.m1.1.1.1.1.2.cmml">
            ​
           </mo>
           <mi id="alg1.l27.m1.1.1.1.1.3" xref="alg1.l27.m1.1.1.1.1.3.cmml">
            θ
           </mi>
          </mrow>
         </mrow>
        </mrow>
        <annotation-xml encoding="MathML-Content" id="alg1.l27.m1.1b">
         <apply id="alg1.l27.m1.1.1.cmml" xref="alg1.l27.m1.1.1">
          <ci id="alg1.l27.m1.1.1.2.cmml" xref="alg1.l27.m1.1.1.2">
           ←
          </ci>
          <apply id="alg1.l27.m1.1.1.3.cmml" xref="alg1.l27.m1.1.1.3">
           <ci id="alg1.l27.m1.1.1.3.1.cmml" xref="alg1.l27.m1.1.1.3.1">
            ¯
           </ci>
           <ci id="alg1.l27.m1.1.1.3.2.cmml" xref="alg1.l27.m1.1.1.3.2">
            𝜃
           </ci>
          </apply>
          <apply id="alg1.l27.m1.1.1.1.cmml" xref="alg1.l27.m1.1.1.1">
           <plus id="alg1.l27.m1.1.1.1.2.cmml" xref="alg1.l27.m1.1.1.1.2">
           </plus>
           <apply id="alg1.l27.m1.1.1.1.3.cmml" xref="alg1.l27.m1.1.1.1.3">
            <times id="alg1.l27.m1.1.1.1.3.1.cmml" xref="alg1.l27.m1.1.1.1.3.1">
            </times>
            <ci id="alg1.l27.m1.1.1.1.3.2.cmml" xref="alg1.l27.m1.1.1.1.3.2">
             𝜆
            </ci>
            <apply id="alg1.l27.m1.1.1.1.3.3.cmml" xref="alg1.l27.m1.1.1.1.3.3">
             <ci id="alg1.l27.m1.1.1.1.3.3.1.cmml" xref="alg1.l27.m1.1.1.1.3.3.1">
              ¯
             </ci>
             <ci id="alg1.l27.m1.1.1.1.3.3.2.cmml" xref="alg1.l27.m1.1.1.1.3.3.2">
              𝜃
             </ci>
            </apply>
           </apply>
           <apply id="alg1.l27.m1.1.1.1.1.cmml" xref="alg1.l27.m1.1.1.1.1">
            <times id="alg1.l27.m1.1.1.1.1.2.cmml" xref="alg1.l27.m1.1.1.1.1.2">
            </times>
            <apply id="alg1.l27.m1.1.1.1.1.1.1.1.cmml" xref="alg1.l27.m1.1.1.1.1.1.1">
             <minus id="alg1.l27.m1.1.1.1.1.1.1.1.1.cmml" xref="alg1.l27.m1.1.1.1.1.1.1.1.1">
             </minus>
             <cn id="alg1.l27.m1.1.1.1.1.1.1.1.2.cmml" type="integer" xref="alg1.l27.m1.1.1.1.1.1.1.1.2">
              1
             </cn>
             <ci id="alg1.l27.m1.1.1.1.1.1.1.1.3.cmml" xref="alg1.l27.m1.1.1.1.1.1.1.1.3">
              𝜆
             </ci>
            </apply>
            <ci id="alg1.l27.m1.1.1.1.1.3.cmml" xref="alg1.l27.m1.1.1.1.1.3">
             𝜃
            </ci>
           </apply>
          </apply>
         </apply>
        </annotation-xml>
        <annotation encoding="application/x-tex" id="alg1.l27.m1.1c">
         \bar{\theta}\leftarrow\lambda\bar{\theta}+(1-\lambda)\theta
        </annotation>
       </semantics>
      </math>
     </div>
     <div class="ltx_listingline" id="alg1.l28">
      <span class="ltx_text ltx_font_bold" id="alg1.l28.1">
       end
      </span>
      <span class="ltx_text ltx_font_bold" id="alg1.l28.2">
       for
      </span>
     </div>
     <div class="ltx_listingline" id="alg1.l29">
      <span class="ltx_text ltx_font_bold" id="alg1.l29.1">
       Output:
      </span>
      <math alttext="\pi_{\phi}" class="ltx_Math" display="inline" id="alg1.l29.m1.1">
       <semantics id="alg1.l29.m1.1a">
        <msub id="alg1.l29.m1.1.1" xref="alg1.l29.m1.1.1.cmml">
         <mi id="alg1.l29.m1.1.1.2" xref="alg1.l29.m1.1.1.2.cmml">
          π
         </mi>
         <mi id="alg1.l29.m1.1.1.3" xref="alg1.l29.m1.1.1.3.cmml">
          ϕ
         </mi>
        </msub>
        <annotation-xml encoding="MathML-Content" id="alg1.l29.m1.1b">
         <apply id="alg1.l29.m1.1.1.cmml" xref="alg1.l29.m1.1.1">
          <csymbol cd="ambiguous" id="alg1.l29.m1.1.1.1.cmml" xref="alg1.l29.m1.1.1">
           subscript
          </csymbol>
          <ci id="alg1.l29.m1.1.1.2.cmml" xref="alg1.l29.m1.1.1.2">
           𝜋
          </ci>
          <ci id="alg1.l29.m1.1.1.3.cmml" xref="alg1.l29.m1.1.1.3">
           italic-ϕ
          </ci>
         </apply>
        </annotation-xml>
        <annotation encoding="application/x-tex" id="alg1.l29.m1.1c">
         \pi_{\phi}
        </annotation>
       </semantics>
      </math>
     </div>
    </div>
   </figure>
  </section>
 </section>
 <section class="ltx_section" id="S5">
  <h2 class="ltx_title ltx_title_section">
   <span class="ltx_tag ltx_tag_section">
    5
   </span>
   Experiments
  </h2>
  <div class="ltx_para" id="S5.p1">
   <p class="ltx_p" id="S5.p1.1">
    In this section, we evaluate our method by modeling data science code generation tasks as interactive decision-making environments and training a 7B CodeLlama model with ETPO. Based on the experimental results, we discussed the superiority of our method over several baselines in generating machine learning code to achieve the highest possible ROC AUC score
    <cite class="ltx_cite ltx_citemacro_citep">
     (Narkhede,
     <a class="ltx_ref" href="#bib.bib25" title="">
      2018
     </a>
     )
    </cite>
    with Scikit-learn module
    <cite class="ltx_cite ltx_citemacro_citep">
     (Pedregosa et al.,
     <a class="ltx_ref" href="#bib.bib27" title="">
      2011
     </a>
     )
    </cite>
    .
We also showcase the convergence performance of ETPO, which is important for evaluating RL algorithms. Further, we analyze the difference between the generated code of vanilla CodeLlama-7B and the CodeLlama-7B fine-tuned by ETPO, giving insights about the behavioral emergence of LLMs with RL training. In the end, we examine the perplexity with the benchmarks of Github, Wikitext, and arXiv
    <cite class="ltx_cite ltx_citemacro_citep">
     (Wu et al.,
     <a class="ltx_ref" href="#bib.bib46" title="">
      2022
     </a>
     )
    </cite>
    to confirm if ETPO can maintain the model’s fundamental capabilities and stability. Ablation studies are conducted in Appendix
    <a class="ltx_ref" href="#A7" title="Appendix G Ablations ‣ Entropy-Regularized Token-Level Policy Optimization for Large Language Models">
     <span class="ltx_text ltx_ref_tag">
      G
     </span>
    </a>
    to investigate the importance of multi-step reflection and per-token soft Bellman update separately.
   </p>
  </div>
  <section class="ltx_subsection" id="S5.SS1">
   <h3 class="ltx_title ltx_title_subsection">
    <span class="ltx_tag ltx_tag_subsection">
     5.1
    </span>
    Environmental Setup
   </h3>
   <div class="ltx_para" id="S5.SS1.p1">
    <p class="ltx_p" id="S5.SS1.p1.1">
     To make the experiment closer to real industrial scenarios, we build an interactive environment that models machine learning code writing and debugging tasks into a sequential decision-making problem. With the same testbeds as
     <cite class="ltx_cite ltx_citemacro_citep">
      (Hollmann et al.,
      <a class="ltx_ref" href="#bib.bib12" title="">
       2023
      </a>
      )
     </cite>
     , we adopt 4 Kaggle datasets and 10 OpenML datasets
     <cite class="ltx_cite ltx_citemacro_citep">
      (Vanschoren et al.,
      <a class="ltx_ref" href="#bib.bib44" title="">
       2014
      </a>
      )
     </cite>
     , with details in Table
     <a class="ltx_ref" href="#S5.T1" title="Table 1 ‣ 5.1 Environmental Setup ‣ 5 Experiments ‣ Entropy-Regularized Token-Level Policy Optimization for Large Language Models">
      <span class="ltx_text ltx_ref_tag">
       1
      </span>
     </a>
     .
    </p>
   </div>
   <figure class="ltx_table" id="S5.T1">
    <figcaption class="ltx_caption">
     <span class="ltx_tag ltx_tag_table">
      Table 1:
     </span>
     Details of datasets used for experiments, where ⟨
     <span class="ltx_text ltx_font_italic" id="S5.T1.2.1">
      K
     </span>
     ⟩ denotes the Kaggle datasets.
    </figcaption>
    <table class="ltx_tabular ltx_centering ltx_guessed_headers ltx_align_middle" id="S5.T1.3">
     <tbody class="ltx_tbody">
      <tr class="ltx_tr" id="S5.T1.3.1.1">
       <th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r ltx_border_tt" id="S5.T1.3.1.1.1">
        <span class="ltx_text ltx_font_smallcaps" id="S5.T1.3.1.1.1.1" style="font-size:70%;">
         Data set
        </span>
       </th>
       <td class="ltx_td ltx_align_center ltx_border_r ltx_border_tt" id="S5.T1.3.1.1.2">
        <span class="ltx_text ltx_font_smallcaps" id="S5.T1.3.1.1.2.1" style="font-size:70%;">
         #Features
        </span>
       </td>
       <td class="ltx_td ltx_align_center ltx_border_r ltx_border_tt" id="S5.T1.3.1.1.3">
        <span class="ltx_text ltx_font_smallcaps" id="S5.T1.3.1.1.3.1" style="font-size:70%;">
         #Samples
        </span>
       </td>
       <td class="ltx_td ltx_align_center ltx_border_tt" id="S5.T1.3.1.1.4">
        <span class="ltx_text ltx_font_smallcaps" id="S5.T1.3.1.1.4.1" style="font-size:70%;">
         #Classes
        </span>
       </td>
      </tr>
      <tr class="ltx_tr" id="S5.T1.3.2.2">
       <th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r ltx_border_t" id="S5.T1.3.2.2.1">
        <span class="ltx_text ltx_font_smallcaps" id="S5.T1.3.2.2.1.1" style="font-size:70%;">
         Pharyngitis ⟨
        </span>
        <span class="ltx_text ltx_font_italic" id="S5.T1.3.2.2.1.2" style="font-size:70%;">
         K
        </span>
        <span class="ltx_text ltx_font_smallcaps" id="S5.T1.3.2.2.1.3" style="font-size:70%;">
         ⟩
        </span>
       </th>
       <td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S5.T1.3.2.2.2">
        <span class="ltx_text ltx_font_smallcaps" id="S5.T1.3.2.2.2.1" style="font-size:70%;">
         19
        </span>
       </td>
       <td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S5.T1.3.2.2.3">
        <span class="ltx_text ltx_font_smallcaps" id="S5.T1.3.2.2.3.1" style="font-size:70%;">
         512
        </span>
       </td>
       <td class="ltx_td ltx_align_center ltx_border_t" id="S5.T1.3.2.2.4">
        <span class="ltx_text ltx_font_smallcaps" id="S5.T1.3.2.2.4.1" style="font-size:70%;">
         2
        </span>
       </td>
      </tr>
      <tr class="ltx_tr" id="S5.T1.3.3.3">
       <th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r" id="S5.T1.3.3.3.1">
        <span class="ltx_text ltx_font_smallcaps" id="S5.T1.3.3.3.1.1" style="font-size:70%;">
         Kidney Stone ⟨
        </span>
        <span class="ltx_text ltx_font_italic" id="S5.T1.3.3.3.1.2" style="font-size:70%;">
         K
        </span>
        <span class="ltx_text ltx_font_smallcaps" id="S5.T1.3.3.3.1.3" style="font-size:70%;">
         ⟩
        </span>
       </th>
       <td class="ltx_td ltx_align_center ltx_border_r" id="S5.T1.3.3.3.2">
        <span class="ltx_text ltx_font_smallcaps" id="S5.T1.3.3.3.2.1" style="font-size:70%;">
         7
        </span>
       </td>
       <td class="ltx_td ltx_align_center ltx_border_r" id="S5.T1.3.3.3.3">
        <span class="ltx_text ltx_font_smallcaps" id="S5.T1.3.3.3.3.1" style="font-size:70%;">
         414
        </span>
       </td>
       <td class="ltx_td ltx_align_center" id="S5.T1.3.3.3.4">
        <span class="ltx_text ltx_font_smallcaps" id="S5.T1.3.3.3.4.1" style="font-size:70%;">
         2
        </span>
       </td>
      </tr>
      <tr class="ltx_tr" id="S5.T1.3.4.4">
       <th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r" id="S5.T1.3.4.4.1">
        <span class="ltx_text ltx_font_smallcaps" id="S5.T1.3.4.4.1.1" style="font-size:70%;">
         Health Insurance ⟨
        </span>
        <span class="ltx_text ltx_font_italic" id="S5.T1.3.4.4.1.2" style="font-size:70%;">
         K
        </span>
        <span class="ltx_text ltx_font_smallcaps" id="S5.T1.3.4.4.1.3" style="font-size:70%;">
         ⟩
        </span>
       </th>
       <td class="ltx_td ltx_align_center ltx_border_r" id="S5.T1.3.4.4.2">
        <span class="ltx_text ltx_font_smallcaps" id="S5.T1.3.4.4.2.1" style="font-size:70%;">
         13
        </span>
       </td>
       <td class="ltx_td ltx_align_center ltx_border_r" id="S5.T1.3.4.4.3">
        <span class="ltx_text ltx_font_smallcaps" id="S5.T1.3.4.4.3.1" style="font-size:70%;">
         2000
        </span>
       </td>
       <td class="ltx_td ltx_align_center" id="S5.T1.3.4.4.4">
        <span class="ltx_text ltx_font_smallcaps" id="S5.T1.3.4.4.4.1" style="font-size:70%;">
         2
        </span>
       </td>
      </tr>
      <tr class="ltx_tr" id="S5.T1.3.5.5">
       <th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r" id="S5.T1.3.5.5.1">
        <span class="ltx_text ltx_font_smallcaps" id="S5.T1.3.5.5.1.1" style="font-size:70%;">
         Spaceship Titanic ⟨
        </span>
        <span class="ltx_text ltx_font_italic" id="S5.T1.3.5.5.1.2" style="font-size:70%;">
         K
        </span>
        <span class="ltx_text ltx_font_smallcaps" id="S5.T1.3.5.5.1.3" style="font-size:70%;">
         ⟩
        </span>
       </th>
       <td class="ltx_td ltx_align_center ltx_border_r" id="S5.T1.3.5.5.2">
        <span class="ltx_text ltx_font_smallcaps" id="S5.T1.3.5.5.2.1" style="font-size:70%;">
         13
        </span>
       </td>
       <td class="ltx_td ltx_align_center ltx_border_r" id="S5.T1.3.5.5.3">
        <span class="ltx_text ltx_font_smallcaps" id="S5.T1.3.5.5.3.1" style="font-size:70%;">
         2000
        </span>
       </td>
       <td class="ltx_td ltx_align_center" id="S5.T1.3.5.5.4">
        <span class="ltx_text ltx_font_smallcaps" id="S5.T1.3.5.5.4.1" style="font-size:70%;">
         2
        </span>
       </td>
      </tr>
      <tr class="ltx_tr" id="S5.T1.3.6.6">
       <th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r ltx_border_t" id="S5.T1.3.6.6.1">
        <span class="ltx_text ltx_font_smallcaps" id="S5.T1.3.6.6.1.1" style="font-size:70%;">
         Airlines
        </span>
       </th>
       <td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S5.T1.3.6.6.2">
        <span class="ltx_text ltx_font_smallcaps" id="S5.T1.3.6.6.2.1" style="font-size:70%;">
         7
        </span>
       </td>
       <td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S5.T1.3.6.6.3">
        <span class="ltx_text ltx_font_smallcaps" id="S5.T1.3.6.6.3.1" style="font-size:70%;">
         2000
        </span>
       </td>
       <td class="ltx_td ltx_align_center ltx_border_t" id="S5.T1.3.6.6.4">
        <span class="ltx_text ltx_font_smallcaps" id="S5.T1.3.6.6.4.1" style="font-size:70%;">
         2
        </span>
       </td>
      </tr>
      <tr class="ltx_tr" id="S5.T1.3.7.7">
       <th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r" id="S5.T1.3.7.7.1">
        <span class="ltx_text ltx_font_smallcaps" id="S5.T1.3.7.7.1.1" style="font-size:70%;">
         Balance Scale
        </span>
       </th>
       <td class="ltx_td ltx_align_center ltx_border_r" id="S5.T1.3.7.7.2">
        <span class="ltx_text ltx_font_smallcaps" id="S5.T1.3.7.7.2.1" style="font-size:70%;">
         4
        </span>
       </td>
       <td class="ltx_td ltx_align_center ltx_border_r" id="S5.T1.3.7.7.3">
        <span class="ltx_text ltx_font_smallcaps" id="S5.T1.3.7.7.3.1" style="font-size:70%;">
         125
        </span>
       </td>
       <td class="ltx_td ltx_align_center" id="S5.T1.3.7.7.4">
        <span class="ltx_text ltx_font_smallcaps" id="S5.T1.3.7.7.4.1" style="font-size:70%;">
         3
        </span>
       </td>
      </tr>
      <tr class="ltx_tr" id="S5.T1.3.8.8">
       <th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r" id="S5.T1.3.8.8.1">
        <span class="ltx_text ltx_font_smallcaps" id="S5.T1.3.8.8.1.1" style="font-size:70%;">
         Breast-w
        </span>
       </th>
       <td class="ltx_td ltx_align_center ltx_border_r" id="S5.T1.3.8.8.2">
        <span class="ltx_text ltx_font_smallcaps" id="S5.T1.3.8.8.2.1" style="font-size:70%;">
         9
        </span>
       </td>
       <td class="ltx_td ltx_align_center ltx_border_r" id="S5.T1.3.8.8.3">
        <span class="ltx_text ltx_font_smallcaps" id="S5.T1.3.8.8.3.1" style="font-size:70%;">
         69
        </span>
       </td>
       <td class="ltx_td ltx_align_center" id="S5.T1.3.8.8.4">
        <span class="ltx_text ltx_font_smallcaps" id="S5.T1.3.8.8.4.1" style="font-size:70%;">
         2
        </span>
       </td>
      </tr>
      <tr class="ltx_tr" id="S5.T1.3.9.9">
       <th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r" id="S5.T1.3.9.9.1">
        <span class="ltx_text ltx_font_smallcaps" id="S5.T1.3.9.9.1.1" style="font-size:70%;">
         CMC
        </span>
       </th>
       <td class="ltx_td ltx_align_center ltx_border_r" id="S5.T1.3.9.9.2">
        <span class="ltx_text ltx_font_smallcaps" id="S5.T1.3.9.9.2.1" style="font-size:70%;">
         9
        </span>
       </td>
       <td class="ltx_td ltx_align_center ltx_border_r" id="S5.T1.3.9.9.3">
        <span class="ltx_text ltx_font_smallcaps" id="S5.T1.3.9.9.3.1" style="font-size:70%;">
         1473
        </span>
       </td>
       <td class="ltx_td ltx_align_center" id="S5.T1.3.9.9.4">
        <span class="ltx_text ltx_font_smallcaps" id="S5.T1.3.9.9.4.1" style="font-size:70%;">
         3
        </span>
       </td>
      </tr>
      <tr class="ltx_tr" id="S5.T1.3.10.10">
       <th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r" id="S5.T1.3.10.10.1">
        <span class="ltx_text ltx_font_smallcaps" id="S5.T1.3.10.10.1.1" style="font-size:70%;">
         Credit-g
        </span>
       </th>
       <td class="ltx_td ltx_align_center ltx_border_r" id="S5.T1.3.10.10.2">
        <span class="ltx_text ltx_font_smallcaps" id="S5.T1.3.10.10.2.1" style="font-size:70%;">
         20
        </span>
       </td>
       <td class="ltx_td ltx_align_center ltx_border_r" id="S5.T1.3.10.10.3">
        <span class="ltx_text ltx_font_smallcaps" id="S5.T1.3.10.10.3.1" style="font-size:70%;">
         1000
        </span>
       </td>
       <td class="ltx_td ltx_align_center" id="S5.T1.3.10.10.4">
        <span class="ltx_text ltx_font_smallcaps" id="S5.T1.3.10.10.4.1" style="font-size:70%;">
         2
        </span>
       </td>
      </tr>
      <tr class="ltx_tr" id="S5.T1.3.11.11">
       <th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r" id="S5.T1.3.11.11.1">
        <span class="ltx_text ltx_font_smallcaps" id="S5.T1.3.11.11.1.1" style="font-size:70%;">
         Diabetes
        </span>
       </th>
       <td class="ltx_td ltx_align_center ltx_border_r" id="S5.T1.3.11.11.2">
        <span class="ltx_text ltx_font_smallcaps" id="S5.T1.3.11.11.2.1" style="font-size:70%;">
         8
        </span>
       </td>
       <td class="ltx_td ltx_align_center ltx_border_r" id="S5.T1.3.11.11.3">
        <span class="ltx_text ltx_font_smallcaps" id="S5.T1.3.11.11.3.1" style="font-size:70%;">
         768
        </span>
       </td>
       <td class="ltx_td ltx_align_center" id="S5.T1.3.11.11.4">
        <span class="ltx_text ltx_font_smallcaps" id="S5.T1.3.11.11.4.1" style="font-size:70%;">
         2
        </span>
       </td>
      </tr>
      <tr class="ltx_tr" id="S5.T1.3.12.12">
       <th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r" id="S5.T1.3.12.12.1">
        <span class="ltx_text ltx_font_smallcaps" id="S5.T1.3.12.12.1.1" style="font-size:70%;">
         Eucalyptus
        </span>
       </th>
       <td class="ltx_td ltx_align_center ltx_border_r" id="S5.T1.3.12.12.2">
        <span class="ltx_text ltx_font_smallcaps" id="S5.T1.3.12.12.2.1" style="font-size:70%;">
         19
        </span>
       </td>
       <td class="ltx_td ltx_align_center ltx_border_r" id="S5.T1.3.12.12.3">
        <span class="ltx_text ltx_font_smallcaps" id="S5.T1.3.12.12.3.1" style="font-size:70%;">
         736
        </span>
       </td>
       <td class="ltx_td ltx_align_center" id="S5.T1.3.12.12.4">
        <span class="ltx_text ltx_font_smallcaps" id="S5.T1.3.12.12.4.1" style="font-size:70%;">
         5
        </span>
       </td>
      </tr>
      <tr class="ltx_tr" id="S5.T1.3.13.13">
       <th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r" id="S5.T1.3.13.13.1">
        <span class="ltx_text ltx_font_smallcaps" id="S5.T1.3.13.13.1.1" style="font-size:70%;">
         Jungle Chess
        </span>
       </th>
       <td class="ltx_td ltx_align_center ltx_border_r" id="S5.T1.3.13.13.2">
        <span class="ltx_text ltx_font_smallcaps" id="S5.T1.3.13.13.2.1" style="font-size:70%;">
         6
        </span>
       </td>
       <td class="ltx_td ltx_align_center ltx_border_r" id="S5.T1.3.13.13.3">
        <span class="ltx_text ltx_font_smallcaps" id="S5.T1.3.13.13.3.1" style="font-size:70%;">
         2000
        </span>
       </td>
       <td class="ltx_td ltx_align_center" id="S5.T1.3.13.13.4">
        <span class="ltx_text ltx_font_smallcaps" id="S5.T1.3.13.13.4.1" style="font-size:70%;">
         3
        </span>
       </td>
      </tr>
      <tr class="ltx_tr" id="S5.T1.3.14.14">
       <th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r" id="S5.T1.3.14.14.1">
        <span class="ltx_text ltx_font_smallcaps" id="S5.T1.3.14.14.1.1" style="font-size:70%;">
         PC1
        </span>
       </th>
       <td class="ltx_td ltx_align_center ltx_border_r" id="S5.T1.3.14.14.2">
        <span class="ltx_text ltx_font_smallcaps" id="S5.T1.3.14.14.2.1" style="font-size:70%;">
         21
        </span>
       </td>
       <td class="ltx_td ltx_align_center ltx_border_r" id="S5.T1.3.14.14.3">
        <span class="ltx_text ltx_font_smallcaps" id="S5.T1.3.14.14.3.1" style="font-size:70%;">
         1109
        </span>
       </td>
       <td class="ltx_td ltx_align_center" id="S5.T1.3.14.14.4">
        <span class="ltx_text ltx_font_smallcaps" id="S5.T1.3.14.14.4.1" style="font-size:70%;">
         2
        </span>
       </td>
      </tr>
      <tr class="ltx_tr" id="S5.T1.3.15.15">
       <th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_bb ltx_border_r" id="S5.T1.3.15.15.1">
        <span class="ltx_text ltx_font_smallcaps" id="S5.T1.3.15.15.1.1" style="font-size:70%;">
         Tic-Tac-Toe
        </span>
       </th>
       <td class="ltx_td ltx_align_center ltx_border_bb ltx_border_r" id="S5.T1.3.15.15.2">
        <span class="ltx_text ltx_font_smallcaps" id="S5.T1.3.15.15.2.1" style="font-size:70%;">
         9
        </span>
       </td>
       <td class="ltx_td ltx_align_center ltx_border_bb ltx_border_r" id="S5.T1.3.15.15.3">
        <span class="ltx_text ltx_font_smallcaps" id="S5.T1.3.15.15.3.1" style="font-size:70%;">
         95
        </span>
       </td>
       <td class="ltx_td ltx_align_center ltx_border_bb" id="S5.T1.3.15.15.4">
        <span class="ltx_text ltx_font_smallcaps" id="S5.T1.3.15.15.4.1" style="font-size:70%;">
         2
        </span>
       </td>
      </tr>
     </tbody>
    </table>
   </figure>
   <div class="ltx_para" id="S5.SS1.p2">
    <p class="ltx_p" id="S5.SS1.p2.7">
     To model the code generation tasks as MDPs, we define
     <math alttext="g\in\mathcal{V}^{N}" class="ltx_Math" display="inline" id="S5.SS1.p2.1.m1.1">
      <semantics id="S5.SS1.p2.1.m1.1a">
       <mrow id="S5.SS1.p2.1.m1.1.1" xref="S5.SS1.p2.1.m1.1.1.cmml">
        <mi id="S5.SS1.p2.1.m1.1.1.2" xref="S5.SS1.p2.1.m1.1.1.2.cmml">
         g
        </mi>
        <mo id="S5.SS1.p2.1.m1.1.1.1" xref="S5.SS1.p2.1.m1.1.1.1.cmml">
         ∈
        </mo>
        <msup id="S5.SS1.p2.1.m1.1.1.3" xref="S5.SS1.p2.1.m1.1.1.3.cmml">
         <mi class="ltx_font_mathcaligraphic" id="S5.SS1.p2.1.m1.1.1.3.2" xref="S5.SS1.p2.1.m1.1.1.3.2.cmml">
          𝒱
         </mi>
         <mi id="S5.SS1.p2.1.m1.1.1.3.3" xref="S5.SS1.p2.1.m1.1.1.3.3.cmml">
          N
         </mi>
        </msup>
       </mrow>
       <annotation-xml encoding="MathML-Content" id="S5.SS1.p2.1.m1.1b">
        <apply id="S5.SS1.p2.1.m1.1.1.cmml" xref="S5.SS1.p2.1.m1.1.1">
         <in id="S5.SS1.p2.1.m1.1.1.1.cmml" xref="S5.SS1.p2.1.m1.1.1.1">
         </in>
         <ci id="S5.SS1.p2.1.m1.1.1.2.cmml" xref="S5.SS1.p2.1.m1.1.1.2">
          𝑔
         </ci>
         <apply id="S5.SS1.p2.1.m1.1.1.3.cmml" xref="S5.SS1.p2.1.m1.1.1.3">
          <csymbol cd="ambiguous" id="S5.SS1.p2.1.m1.1.1.3.1.cmml" xref="S5.SS1.p2.1.m1.1.1.3">
           superscript
          </csymbol>
          <ci id="S5.SS1.p2.1.m1.1.1.3.2.cmml" xref="S5.SS1.p2.1.m1.1.1.3.2">
           𝒱
          </ci>
          <ci id="S5.SS1.p2.1.m1.1.1.3.3.cmml" xref="S5.SS1.p2.1.m1.1.1.3.3">
           𝑁
          </ci>
         </apply>
        </apply>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="S5.SS1.p2.1.m1.1c">
        g\in\mathcal{V}^{N}
       </annotation>
      </semantics>
     </math>
     to be the task description,
     <math alttext="e\in\mathcal{V}^{N}" class="ltx_Math" display="inline" id="S5.SS1.p2.2.m2.1">
      <semantics id="S5.SS1.p2.2.m2.1a">
       <mrow id="S5.SS1.p2.2.m2.1.1" xref="S5.SS1.p2.2.m2.1.1.cmml">
        <mi id="S5.SS1.p2.2.m2.1.1.2" xref="S5.SS1.p2.2.m2.1.1.2.cmml">
         e
        </mi>
        <mo id="S5.SS1.p2.2.m2.1.1.1" xref="S5.SS1.p2.2.m2.1.1.1.cmml">
         ∈
        </mo>
        <msup id="S5.SS1.p2.2.m2.1.1.3" xref="S5.SS1.p2.2.m2.1.1.3.cmml">
         <mi class="ltx_font_mathcaligraphic" id="S5.SS1.p2.2.m2.1.1.3.2" xref="S5.SS1.p2.2.m2.1.1.3.2.cmml">
          𝒱
         </mi>
         <mi id="S5.SS1.p2.2.m2.1.1.3.3" xref="S5.SS1.p2.2.m2.1.1.3.3.cmml">
          N
         </mi>
        </msup>
       </mrow>
       <annotation-xml encoding="MathML-Content" id="S5.SS1.p2.2.m2.1b">
        <apply id="S5.SS1.p2.2.m2.1.1.cmml" xref="S5.SS1.p2.2.m2.1.1">
         <in id="S5.SS1.p2.2.m2.1.1.1.cmml" xref="S5.SS1.p2.2.m2.1.1.1">
         </in>
         <ci id="S5.SS1.p2.2.m2.1.1.2.cmml" xref="S5.SS1.p2.2.m2.1.1.2">
          𝑒
         </ci>
         <apply id="S5.SS1.p2.2.m2.1.1.3.cmml" xref="S5.SS1.p2.2.m2.1.1.3">
          <csymbol cd="ambiguous" id="S5.SS1.p2.2.m2.1.1.3.1.cmml" xref="S5.SS1.p2.2.m2.1.1.3">
           superscript
          </csymbol>
          <ci id="S5.SS1.p2.2.m2.1.1.3.2.cmml" xref="S5.SS1.p2.2.m2.1.1.3.2">
           𝒱
          </ci>
          <ci id="S5.SS1.p2.2.m2.1.1.3.3.cmml" xref="S5.SS1.p2.2.m2.1.1.3.3">
           𝑁
          </ci>
         </apply>
        </apply>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="S5.SS1.p2.2.m2.1c">
        e\in\mathcal{V}^{N}
       </annotation>
      </semantics>
     </math>
     to be the runtime error message when generated codes are non-runnable, serving as reflection messages.
In the beginning, our agent generates codes as an action
     <math alttext="a_{0}" class="ltx_Math" display="inline" id="S5.SS1.p2.3.m3.1">
      <semantics id="S5.SS1.p2.3.m3.1a">
       <msub id="S5.SS1.p2.3.m3.1.1" xref="S5.SS1.p2.3.m3.1.1.cmml">
        <mi id="S5.SS1.p2.3.m3.1.1.2" xref="S5.SS1.p2.3.m3.1.1.2.cmml">
         a
        </mi>
        <mn id="S5.SS1.p2.3.m3.1.1.3" xref="S5.SS1.p2.3.m3.1.1.3.cmml">
         0
        </mn>
       </msub>
       <annotation-xml encoding="MathML-Content" id="S5.SS1.p2.3.m3.1b">
        <apply id="S5.SS1.p2.3.m3.1.1.cmml" xref="S5.SS1.p2.3.m3.1.1">
         <csymbol cd="ambiguous" id="S5.SS1.p2.3.m3.1.1.1.cmml" xref="S5.SS1.p2.3.m3.1.1">
          subscript
         </csymbol>
         <ci id="S5.SS1.p2.3.m3.1.1.2.cmml" xref="S5.SS1.p2.3.m3.1.1.2">
          𝑎
         </ci>
         <cn id="S5.SS1.p2.3.m3.1.1.3.cmml" type="integer" xref="S5.SS1.p2.3.m3.1.1.3">
          0
         </cn>
        </apply>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="S5.SS1.p2.3.m3.1c">
        a_{0}
       </annotation>
      </semantics>
     </math>
     based on the initial state
     <math alttext="s_{0}=\eta(g)" class="ltx_Math" display="inline" id="S5.SS1.p2.4.m4.1">
      <semantics id="S5.SS1.p2.4.m4.1a">
       <mrow id="S5.SS1.p2.4.m4.1.2" xref="S5.SS1.p2.4.m4.1.2.cmml">
        <msub id="S5.SS1.p2.4.m4.1.2.2" xref="S5.SS1.p2.4.m4.1.2.2.cmml">
         <mi id="S5.SS1.p2.4.m4.1.2.2.2" xref="S5.SS1.p2.4.m4.1.2.2.2.cmml">
          s
         </mi>
         <mn id="S5.SS1.p2.4.m4.1.2.2.3" xref="S5.SS1.p2.4.m4.1.2.2.3.cmml">
          0
         </mn>
        </msub>
        <mo id="S5.SS1.p2.4.m4.1.2.1" xref="S5.SS1.p2.4.m4.1.2.1.cmml">
         =
        </mo>
        <mrow id="S5.SS1.p2.4.m4.1.2.3" xref="S5.SS1.p2.4.m4.1.2.3.cmml">
         <mi id="S5.SS1.p2.4.m4.1.2.3.2" xref="S5.SS1.p2.4.m4.1.2.3.2.cmml">
          η
         </mi>
         <mo id="S5.SS1.p2.4.m4.1.2.3.1" lspace="0em" rspace="0em" xref="S5.SS1.p2.4.m4.1.2.3.1.cmml">
          ​
         </mo>
         <mrow id="S5.SS1.p2.4.m4.1.2.3.3.2" xref="S5.SS1.p2.4.m4.1.2.3.cmml">
          <mo id="S5.SS1.p2.4.m4.1.2.3.3.2.1" stretchy="false" xref="S5.SS1.p2.4.m4.1.2.3.cmml">
           (
          </mo>
          <mi id="S5.SS1.p2.4.m4.1.1" xref="S5.SS1.p2.4.m4.1.1.cmml">
           g
          </mi>
          <mo id="S5.SS1.p2.4.m4.1.2.3.3.2.2" stretchy="false" xref="S5.SS1.p2.4.m4.1.2.3.cmml">
           )
          </mo>
         </mrow>
        </mrow>
       </mrow>
       <annotation-xml encoding="MathML-Content" id="S5.SS1.p2.4.m4.1b">
        <apply id="S5.SS1.p2.4.m4.1.2.cmml" xref="S5.SS1.p2.4.m4.1.2">
         <eq id="S5.SS1.p2.4.m4.1.2.1.cmml" xref="S5.SS1.p2.4.m4.1.2.1">
         </eq>
         <apply id="S5.SS1.p2.4.m4.1.2.2.cmml" xref="S5.SS1.p2.4.m4.1.2.2">
          <csymbol cd="ambiguous" id="S5.SS1.p2.4.m4.1.2.2.1.cmml" xref="S5.SS1.p2.4.m4.1.2.2">
           subscript
          </csymbol>
          <ci id="S5.SS1.p2.4.m4.1.2.2.2.cmml" xref="S5.SS1.p2.4.m4.1.2.2.2">
           𝑠
          </ci>
          <cn id="S5.SS1.p2.4.m4.1.2.2.3.cmml" type="integer" xref="S5.SS1.p2.4.m4.1.2.2.3">
           0
          </cn>
         </apply>
         <apply id="S5.SS1.p2.4.m4.1.2.3.cmml" xref="S5.SS1.p2.4.m4.1.2.3">
          <times id="S5.SS1.p2.4.m4.1.2.3.1.cmml" xref="S5.SS1.p2.4.m4.1.2.3.1">
          </times>
          <ci id="S5.SS1.p2.4.m4.1.2.3.2.cmml" xref="S5.SS1.p2.4.m4.1.2.3.2">
           𝜂
          </ci>
          <ci id="S5.SS1.p2.4.m4.1.1.cmml" xref="S5.SS1.p2.4.m4.1.1">
           𝑔
          </ci>
         </apply>
        </apply>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="S5.SS1.p2.4.m4.1c">
        s_{0}=\eta(g)
       </annotation>
      </semantics>
     </math>
     where
     <math alttext="\eta" class="ltx_Math" display="inline" id="S5.SS1.p2.5.m5.1">
      <semantics id="S5.SS1.p2.5.m5.1a">
       <mi id="S5.SS1.p2.5.m5.1.1" xref="S5.SS1.p2.5.m5.1.1.cmml">
        η
       </mi>
       <annotation-xml encoding="MathML-Content" id="S5.SS1.p2.5.m5.1b">
        <ci id="S5.SS1.p2.5.m5.1.1.cmml" xref="S5.SS1.p2.5.m5.1.1">
         𝜂
        </ci>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="S5.SS1.p2.5.m5.1c">
        \eta
       </annotation>
      </semantics>
     </math>
     is a prompting operation, then receives a reward
     <math alttext="r" class="ltx_Math" display="inline" id="S5.SS1.p2.6.m6.1">
      <semantics id="S5.SS1.p2.6.m6.1a">
       <mi id="S5.SS1.p2.6.m6.1.1" xref="S5.SS1.p2.6.m6.1.1.cmml">
        r
       </mi>
       <annotation-xml encoding="MathML-Content" id="S5.SS1.p2.6.m6.1b">
        <ci id="S5.SS1.p2.6.m6.1.1.cmml" xref="S5.SS1.p2.6.m6.1.1">
         𝑟
        </ci>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="S5.SS1.p2.6.m6.1c">
        r
       </annotation>
      </semantics>
     </math>
     by executing the codes. The reward function
     <math alttext="r(s_{t},a_{t})" class="ltx_Math" display="inline" id="S5.SS1.p2.7.m7.2">
      <semantics id="S5.SS1.p2.7.m7.2a">
       <mrow id="S5.SS1.p2.7.m7.2.2" xref="S5.SS1.p2.7.m7.2.2.cmml">
        <mi id="S5.SS1.p2.7.m7.2.2.4" xref="S5.SS1.p2.7.m7.2.2.4.cmml">
         r
        </mi>
        <mo id="S5.SS1.p2.7.m7.2.2.3" lspace="0em" rspace="0em" xref="S5.SS1.p2.7.m7.2.2.3.cmml">
         ​
        </mo>
        <mrow id="S5.SS1.p2.7.m7.2.2.2.2" xref="S5.SS1.p2.7.m7.2.2.2.3.cmml">
         <mo id="S5.SS1.p2.7.m7.2.2.2.2.3" stretchy="false" xref="S5.SS1.p2.7.m7.2.2.2.3.cmml">
          (
         </mo>
         <msub id="S5.SS1.p2.7.m7.1.1.1.1.1" xref="S5.SS1.p2.7.m7.1.1.1.1.1.cmml">
          <mi id="S5.SS1.p2.7.m7.1.1.1.1.1.2" xref="S5.SS1.p2.7.m7.1.1.1.1.1.2.cmml">
           s
          </mi>
          <mi id="S5.SS1.p2.7.m7.1.1.1.1.1.3" xref="S5.SS1.p2.7.m7.1.1.1.1.1.3.cmml">
           t
          </mi>
         </msub>
         <mo id="S5.SS1.p2.7.m7.2.2.2.2.4" xref="S5.SS1.p2.7.m7.2.2.2.3.cmml">
          ,
         </mo>
         <msub id="S5.SS1.p2.7.m7.2.2.2.2.2" xref="S5.SS1.p2.7.m7.2.2.2.2.2.cmml">
          <mi id="S5.SS1.p2.7.m7.2.2.2.2.2.2" xref="S5.SS1.p2.7.m7.2.2.2.2.2.2.cmml">
           a
          </mi>
          <mi id="S5.SS1.p2.7.m7.2.2.2.2.2.3" xref="S5.SS1.p2.7.m7.2.2.2.2.2.3.cmml">
           t
          </mi>
         </msub>
         <mo id="S5.SS1.p2.7.m7.2.2.2.2.5" stretchy="false" xref="S5.SS1.p2.7.m7.2.2.2.3.cmml">
          )
         </mo>
        </mrow>
       </mrow>
       <annotation-xml encoding="MathML-Content" id="S5.SS1.p2.7.m7.2b">
        <apply id="S5.SS1.p2.7.m7.2.2.cmml" xref="S5.SS1.p2.7.m7.2.2">
         <times id="S5.SS1.p2.7.m7.2.2.3.cmml" xref="S5.SS1.p2.7.m7.2.2.3">
         </times>
         <ci id="S5.SS1.p2.7.m7.2.2.4.cmml" xref="S5.SS1.p2.7.m7.2.2.4">
          𝑟
         </ci>
         <interval closure="open" id="S5.SS1.p2.7.m7.2.2.2.3.cmml" xref="S5.SS1.p2.7.m7.2.2.2.2">
          <apply id="S5.SS1.p2.7.m7.1.1.1.1.1.cmml" xref="S5.SS1.p2.7.m7.1.1.1.1.1">
           <csymbol cd="ambiguous" id="S5.SS1.p2.7.m7.1.1.1.1.1.1.cmml" xref="S5.SS1.p2.7.m7.1.1.1.1.1">
            subscript
           </csymbol>
           <ci id="S5.SS1.p2.7.m7.1.1.1.1.1.2.cmml" xref="S5.SS1.p2.7.m7.1.1.1.1.1.2">
            𝑠
           </ci>
           <ci id="S5.SS1.p2.7.m7.1.1.1.1.1.3.cmml" xref="S5.SS1.p2.7.m7.1.1.1.1.1.3">
            𝑡
           </ci>
          </apply>
          <apply id="S5.SS1.p2.7.m7.2.2.2.2.2.cmml" xref="S5.SS1.p2.7.m7.2.2.2.2.2">
           <csymbol cd="ambiguous" id="S5.SS1.p2.7.m7.2.2.2.2.2.1.cmml" xref="S5.SS1.p2.7.m7.2.2.2.2.2">
            subscript
           </csymbol>
           <ci id="S5.SS1.p2.7.m7.2.2.2.2.2.2.cmml" xref="S5.SS1.p2.7.m7.2.2.2.2.2.2">
            𝑎
           </ci>
           <ci id="S5.SS1.p2.7.m7.2.2.2.2.2.3.cmml" xref="S5.SS1.p2.7.m7.2.2.2.2.2.3">
            𝑡
           </ci>
          </apply>
         </interval>
        </apply>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="S5.SS1.p2.7.m7.2c">
        r(s_{t},a_{t})
       </annotation>
      </semantics>
     </math>
     is defined as:
    </p>
    <table class="ltx_equationgroup ltx_eqn_align ltx_eqn_table" id="A7.EGx10">
     <tbody id="S5.E10">
      <tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
       <td class="ltx_eqn_cell ltx_eqn_center_padleft">
       </td>
       <td class="ltx_td ltx_align_right ltx_eqn_cell">
        <math alttext="\displaystyle r(s,\mathbf{a}_{t})=\begin{cases}\mbox{ROC AUC score},&amp;\mbox{Runnable}\\
-1.0,&amp;\mbox{Non-runnable}\end{cases}" class="ltx_Math" display="inline" id="S5.E10.m1.6">
         <semantics id="S5.E10.m1.6a">
          <mrow id="S5.E10.m1.6.6" xref="S5.E10.m1.6.6.cmml">
           <mrow id="S5.E10.m1.6.6.1" xref="S5.E10.m1.6.6.1.cmml">
            <mi id="S5.E10.m1.6.6.1.3" xref="S5.E10.m1.6.6.1.3.cmml">
             r
            </mi>
            <mo id="S5.E10.m1.6.6.1.2" lspace="0em" rspace="0em" xref="S5.E10.m1.6.6.1.2.cmml">
             ​
            </mo>
            <mrow id="S5.E10.m1.6.6.1.1.1" xref="S5.E10.m1.6.6.1.1.2.cmml">
             <mo id="S5.E10.m1.6.6.1.1.1.2" stretchy="false" xref="S5.E10.m1.6.6.1.1.2.cmml">
              (
             </mo>
             <mi id="S5.E10.m1.5.5" xref="S5.E10.m1.5.5.cmml">
              s
             </mi>
             <mo id="S5.E10.m1.6.6.1.1.1.3" xref="S5.E10.m1.6.6.1.1.2.cmml">
              ,
             </mo>
             <msub id="S5.E10.m1.6.6.1.1.1.1" xref="S5.E10.m1.6.6.1.1.1.1.cmml">
              <mi id="S5.E10.m1.6.6.1.1.1.1.2" xref="S5.E10.m1.6.6.1.1.1.1.2.cmml">
               𝐚
              </mi>
              <mi id="S5.E10.m1.6.6.1.1.1.1.3" xref="S5.E10.m1.6.6.1.1.1.1.3.cmml">
               t
              </mi>
             </msub>
             <mo id="S5.E10.m1.6.6.1.1.1.4" stretchy="false" xref="S5.E10.m1.6.6.1.1.2.cmml">
              )
             </mo>
            </mrow>
           </mrow>
           <mo id="S5.E10.m1.6.6.2" xref="S5.E10.m1.6.6.2.cmml">
            =
           </mo>
           <mrow id="S5.E10.m1.4.4a" xref="S5.E10.m1.6.6.3.1.cmml">
            <mo id="S5.E10.m1.4.4a.5" xref="S5.E10.m1.6.6.3.1.1.cmml">
             {
            </mo>
            <mtable columnspacing="5pt" id="S5.E10.m1.4.4.4a" rowspacing="0pt" xref="S5.E10.m1.6.6.3.1.cmml">
             <mtr id="S5.E10.m1.4.4.4aa" xref="S5.E10.m1.6.6.3.1.cmml">
              <mtd class="ltx_align_left" columnalign="left" id="S5.E10.m1.4.4.4ab" xref="S5.E10.m1.6.6.3.1.cmml">
               <mrow id="S5.E10.m1.1.1.1.1.1.1.3" xref="S5.E10.m1.1.1.1.1.1.1.1a.cmml">
                <mtext id="S5.E10.m1.1.1.1.1.1.1.1" xref="S5.E10.m1.1.1.1.1.1.1.1.cmml">
                 ROC AUC score
                </mtext>
                <mo id="S5.E10.m1.1.1.1.1.1.1.3.1" xref="S5.E10.m1.1.1.1.1.1.1.1a.cmml">
                 ,
                </mo>
               </mrow>
              </mtd>
              <mtd class="ltx_align_left" columnalign="left" id="S5.E10.m1.4.4.4ac" xref="S5.E10.m1.6.6.3.1.cmml">
               <mtext id="S5.E10.m1.2.2.2.2.2.1" xref="S5.E10.m1.2.2.2.2.2.1a.cmml">
                Runnable
               </mtext>
              </mtd>
             </mtr>
             <mtr id="S5.E10.m1.4.4.4ad" xref="S5.E10.m1.6.6.3.1.cmml">
              <mtd class="ltx_align_left" columnalign="left" id="S5.E10.m1.4.4.4ae" xref="S5.E10.m1.6.6.3.1.cmml">
               <mrow id="S5.E10.m1.3.3.3.3.1.1.1" xref="S5.E10.m1.3.3.3.3.1.1.1.1.cmml">
                <mrow id="S5.E10.m1.3.3.3.3.1.1.1.1" xref="S5.E10.m1.3.3.3.3.1.1.1.1.cmml">
                 <mo id="S5.E10.m1.3.3.3.3.1.1.1.1a" xref="S5.E10.m1.3.3.3.3.1.1.1.1.cmml">
                  −
                 </mo>
                 <mn id="S5.E10.m1.3.3.3.3.1.1.1.1.2" xref="S5.E10.m1.3.3.3.3.1.1.1.1.2.cmml">
                  1.0
                 </mn>
                </mrow>
                <mo id="S5.E10.m1.3.3.3.3.1.1.1.2" xref="S5.E10.m1.3.3.3.3.1.1.1.1.cmml">
                 ,
                </mo>
               </mrow>
              </mtd>
              <mtd class="ltx_align_left" columnalign="left" id="S5.E10.m1.4.4.4af" xref="S5.E10.m1.6.6.3.1.cmml">
               <mtext id="S5.E10.m1.4.4.4.4.2.1" xref="S5.E10.m1.4.4.4.4.2.1a.cmml">
                Non-runnable
               </mtext>
              </mtd>
             </mtr>
            </mtable>
           </mrow>
          </mrow>
          <annotation-xml encoding="MathML-Content" id="S5.E10.m1.6b">
           <apply id="S5.E10.m1.6.6.cmml" xref="S5.E10.m1.6.6">
            <eq id="S5.E10.m1.6.6.2.cmml" xref="S5.E10.m1.6.6.2">
            </eq>
            <apply id="S5.E10.m1.6.6.1.cmml" xref="S5.E10.m1.6.6.1">
             <times id="S5.E10.m1.6.6.1.2.cmml" xref="S5.E10.m1.6.6.1.2">
             </times>
             <ci id="S5.E10.m1.6.6.1.3.cmml" xref="S5.E10.m1.6.6.1.3">
              𝑟
             </ci>
             <interval closure="open" id="S5.E10.m1.6.6.1.1.2.cmml" xref="S5.E10.m1.6.6.1.1.1">
              <ci id="S5.E10.m1.5.5.cmml" xref="S5.E10.m1.5.5">
               𝑠
              </ci>
              <apply id="S5.E10.m1.6.6.1.1.1.1.cmml" xref="S5.E10.m1.6.6.1.1.1.1">
               <csymbol cd="ambiguous" id="S5.E10.m1.6.6.1.1.1.1.1.cmml" xref="S5.E10.m1.6.6.1.1.1.1">
                subscript
               </csymbol>
               <ci id="S5.E10.m1.6.6.1.1.1.1.2.cmml" xref="S5.E10.m1.6.6.1.1.1.1.2">
                𝐚
               </ci>
               <ci id="S5.E10.m1.6.6.1.1.1.1.3.cmml" xref="S5.E10.m1.6.6.1.1.1.1.3">
                𝑡
               </ci>
              </apply>
             </interval>
            </apply>
            <apply id="S5.E10.m1.6.6.3.1.cmml" xref="S5.E10.m1.4.4a">
             <csymbol cd="latexml" id="S5.E10.m1.6.6.3.1.1.cmml" xref="S5.E10.m1.4.4a.5">
              cases
             </csymbol>
             <ci id="S5.E10.m1.1.1.1.1.1.1.1a.cmml" xref="S5.E10.m1.1.1.1.1.1.1.3">
              <mtext id="S5.E10.m1.1.1.1.1.1.1.1.cmml" xref="S5.E10.m1.1.1.1.1.1.1.1">
               ROC AUC score
              </mtext>
             </ci>
             <ci id="S5.E10.m1.2.2.2.2.2.1a.cmml" xref="S5.E10.m1.2.2.2.2.2.1">
              <mtext id="S5.E10.m1.2.2.2.2.2.1.cmml" xref="S5.E10.m1.2.2.2.2.2.1">
               Runnable
              </mtext>
             </ci>
             <apply id="S5.E10.m1.3.3.3.3.1.1.1.1.cmml" xref="S5.E10.m1.3.3.3.3.1.1.1">
              <minus id="S5.E10.m1.3.3.3.3.1.1.1.1.1.cmml" xref="S5.E10.m1.3.3.3.3.1.1.1">
              </minus>
              <cn id="S5.E10.m1.3.3.3.3.1.1.1.1.2.cmml" type="float" xref="S5.E10.m1.3.3.3.3.1.1.1.1.2">
               1.0
              </cn>
             </apply>
             <ci id="S5.E10.m1.4.4.4.4.2.1a.cmml" xref="S5.E10.m1.4.4.4.4.2.1">
              <mtext id="S5.E10.m1.4.4.4.4.2.1.cmml" xref="S5.E10.m1.4.4.4.4.2.1">
               Non-runnable
              </mtext>
             </ci>
            </apply>
           </apply>
          </annotation-xml>
          <annotation encoding="application/x-tex" id="S5.E10.m1.6c">
           \displaystyle r(s,\mathbf{a}_{t})=\begin{cases}\mbox{ROC AUC score},&amp;\mbox{Runnable}\\
-1.0,&amp;\mbox{Non-runnable}\end{cases}
          </annotation>
         </semantics>
        </math>
       </td>
       <td class="ltx_eqn_cell ltx_eqn_center_padright">
       </td>
       <td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1">
        <span class="ltx_tag ltx_tag_equation ltx_align_right">
         (10)
        </span>
       </td>
      </tr>
     </tbody>
    </table>
    <p class="ltx_p" id="S5.SS1.p2.12">
     When the codes are executed successfully, a done signal will occur immediately, along with a ROC AUC score
     <math alttext="\in[0,1]" class="ltx_Math" display="inline" id="S5.SS1.p2.8.m1.2">
      <semantics id="S5.SS1.p2.8.m1.2a">
       <mrow id="S5.SS1.p2.8.m1.2.3" xref="S5.SS1.p2.8.m1.2.3.cmml">
        <mi id="S5.SS1.p2.8.m1.2.3.2" xref="S5.SS1.p2.8.m1.2.3.2.cmml">
        </mi>
        <mo id="S5.SS1.p2.8.m1.2.3.1" xref="S5.SS1.p2.8.m1.2.3.1.cmml">
         ∈
        </mo>
        <mrow id="S5.SS1.p2.8.m1.2.3.3.2" xref="S5.SS1.p2.8.m1.2.3.3.1.cmml">
         <mo id="S5.SS1.p2.8.m1.2.3.3.2.1" stretchy="false" xref="S5.SS1.p2.8.m1.2.3.3.1.cmml">
          [
         </mo>
         <mn id="S5.SS1.p2.8.m1.1.1" xref="S5.SS1.p2.8.m1.1.1.cmml">
          0
         </mn>
         <mo id="S5.SS1.p2.8.m1.2.3.3.2.2" xref="S5.SS1.p2.8.m1.2.3.3.1.cmml">
          ,
         </mo>
         <mn id="S5.SS1.p2.8.m1.2.2" xref="S5.SS1.p2.8.m1.2.2.cmml">
          1
         </mn>
         <mo id="S5.SS1.p2.8.m1.2.3.3.2.3" stretchy="false" xref="S5.SS1.p2.8.m1.2.3.3.1.cmml">
          ]
         </mo>
        </mrow>
       </mrow>
       <annotation-xml encoding="MathML-Content" id="S5.SS1.p2.8.m1.2b">
        <apply id="S5.SS1.p2.8.m1.2.3.cmml" xref="S5.SS1.p2.8.m1.2.3">
         <in id="S5.SS1.p2.8.m1.2.3.1.cmml" xref="S5.SS1.p2.8.m1.2.3.1">
         </in>
         <csymbol cd="latexml" id="S5.SS1.p2.8.m1.2.3.2.cmml" xref="S5.SS1.p2.8.m1.2.3.2">
          absent
         </csymbol>
         <interval closure="closed" id="S5.SS1.p2.8.m1.2.3.3.1.cmml" xref="S5.SS1.p2.8.m1.2.3.3.2">
          <cn id="S5.SS1.p2.8.m1.1.1.cmml" type="integer" xref="S5.SS1.p2.8.m1.1.1">
           0
          </cn>
          <cn id="S5.SS1.p2.8.m1.2.2.cmml" type="integer" xref="S5.SS1.p2.8.m1.2.2">
           1
          </cn>
         </interval>
        </apply>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="S5.SS1.p2.8.m1.2c">
        \in[0,1]
       </annotation>
      </semantics>
     </math>
     . If the codes run wrong, the agent receives a constant
     <math alttext="-1.0" class="ltx_Math" display="inline" id="S5.SS1.p2.9.m2.1">
      <semantics id="S5.SS1.p2.9.m2.1a">
       <mrow id="S5.SS1.p2.9.m2.1.1" xref="S5.SS1.p2.9.m2.1.1.cmml">
        <mo id="S5.SS1.p2.9.m2.1.1a" xref="S5.SS1.p2.9.m2.1.1.cmml">
         −
        </mo>
        <mn id="S5.SS1.p2.9.m2.1.1.2" xref="S5.SS1.p2.9.m2.1.1.2.cmml">
         1.0
        </mn>
       </mrow>
       <annotation-xml encoding="MathML-Content" id="S5.SS1.p2.9.m2.1b">
        <apply id="S5.SS1.p2.9.m2.1.1.cmml" xref="S5.SS1.p2.9.m2.1.1">
         <minus id="S5.SS1.p2.9.m2.1.1.1.cmml" xref="S5.SS1.p2.9.m2.1.1">
         </minus>
         <cn id="S5.SS1.p2.9.m2.1.1.2.cmml" type="float" xref="S5.SS1.p2.9.m2.1.1.2">
          1.0
         </cn>
        </apply>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="S5.SS1.p2.9.m2.1c">
        -1.0
       </annotation>
      </semantics>
     </math>
     as a reward, as well as the next state
     <math alttext="s^{\prime}=\eta(g,a,e)" class="ltx_Math" display="inline" id="S5.SS1.p2.10.m3.3">
      <semantics id="S5.SS1.p2.10.m3.3a">
       <mrow id="S5.SS1.p2.10.m3.3.4" xref="S5.SS1.p2.10.m3.3.4.cmml">
        <msup id="S5.SS1.p2.10.m3.3.4.2" xref="S5.SS1.p2.10.m3.3.4.2.cmml">
         <mi id="S5.SS1.p2.10.m3.3.4.2.2" xref="S5.SS1.p2.10.m3.3.4.2.2.cmml">
          s
         </mi>
         <mo id="S5.SS1.p2.10.m3.3.4.2.3" xref="S5.SS1.p2.10.m3.3.4.2.3.cmml">
          ′
         </mo>
        </msup>
        <mo id="S5.SS1.p2.10.m3.3.4.1" xref="S5.SS1.p2.10.m3.3.4.1.cmml">
         =
        </mo>
        <mrow id="S5.SS1.p2.10.m3.3.4.3" xref="S5.SS1.p2.10.m3.3.4.3.cmml">
         <mi id="S5.SS1.p2.10.m3.3.4.3.2" xref="S5.SS1.p2.10.m3.3.4.3.2.cmml">
          η
         </mi>
         <mo id="S5.SS1.p2.10.m3.3.4.3.1" lspace="0em" rspace="0em" xref="S5.SS1.p2.10.m3.3.4.3.1.cmml">
          ​
         </mo>
         <mrow id="S5.SS1.p2.10.m3.3.4.3.3.2" xref="S5.SS1.p2.10.m3.3.4.3.3.1.cmml">
          <mo id="S5.SS1.p2.10.m3.3.4.3.3.2.1" stretchy="false" xref="S5.SS1.p2.10.m3.3.4.3.3.1.cmml">
           (
          </mo>
          <mi id="S5.SS1.p2.10.m3.1.1" xref="S5.SS1.p2.10.m3.1.1.cmml">
           g
          </mi>
          <mo id="S5.SS1.p2.10.m3.3.4.3.3.2.2" xref="S5.SS1.p2.10.m3.3.4.3.3.1.cmml">
           ,
          </mo>
          <mi id="S5.SS1.p2.10.m3.2.2" xref="S5.SS1.p2.10.m3.2.2.cmml">
           a
          </mi>
          <mo id="S5.SS1.p2.10.m3.3.4.3.3.2.3" xref="S5.SS1.p2.10.m3.3.4.3.3.1.cmml">
           ,
          </mo>
          <mi id="S5.SS1.p2.10.m3.3.3" xref="S5.SS1.p2.10.m3.3.3.cmml">
           e
          </mi>
          <mo id="S5.SS1.p2.10.m3.3.4.3.3.2.4" stretchy="false" xref="S5.SS1.p2.10.m3.3.4.3.3.1.cmml">
           )
          </mo>
         </mrow>
        </mrow>
       </mrow>
       <annotation-xml encoding="MathML-Content" id="S5.SS1.p2.10.m3.3b">
        <apply id="S5.SS1.p2.10.m3.3.4.cmml" xref="S5.SS1.p2.10.m3.3.4">
         <eq id="S5.SS1.p2.10.m3.3.4.1.cmml" xref="S5.SS1.p2.10.m3.3.4.1">
         </eq>
         <apply id="S5.SS1.p2.10.m3.3.4.2.cmml" xref="S5.SS1.p2.10.m3.3.4.2">
          <csymbol cd="ambiguous" id="S5.SS1.p2.10.m3.3.4.2.1.cmml" xref="S5.SS1.p2.10.m3.3.4.2">
           superscript
          </csymbol>
          <ci id="S5.SS1.p2.10.m3.3.4.2.2.cmml" xref="S5.SS1.p2.10.m3.3.4.2.2">
           𝑠
          </ci>
          <ci id="S5.SS1.p2.10.m3.3.4.2.3.cmml" xref="S5.SS1.p2.10.m3.3.4.2.3">
           ′
          </ci>
         </apply>
         <apply id="S5.SS1.p2.10.m3.3.4.3.cmml" xref="S5.SS1.p2.10.m3.3.4.3">
          <times id="S5.SS1.p2.10.m3.3.4.3.1.cmml" xref="S5.SS1.p2.10.m3.3.4.3.1">
          </times>
          <ci id="S5.SS1.p2.10.m3.3.4.3.2.cmml" xref="S5.SS1.p2.10.m3.3.4.3.2">
           𝜂
          </ci>
          <vector id="S5.SS1.p2.10.m3.3.4.3.3.1.cmml" xref="S5.SS1.p2.10.m3.3.4.3.3.2">
           <ci id="S5.SS1.p2.10.m3.1.1.cmml" xref="S5.SS1.p2.10.m3.1.1">
            𝑔
           </ci>
           <ci id="S5.SS1.p2.10.m3.2.2.cmml" xref="S5.SS1.p2.10.m3.2.2">
            𝑎
           </ci>
           <ci id="S5.SS1.p2.10.m3.3.3.cmml" xref="S5.SS1.p2.10.m3.3.3">
            𝑒
           </ci>
          </vector>
         </apply>
        </apply>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="S5.SS1.p2.10.m3.3c">
        s^{\prime}=\eta(g,a,e)
       </annotation>
      </semantics>
     </math>
     .
Appendix
     <a class="ltx_ref" href="#A4" title="Appendix D Simple Prompts ‣ Entropy-Regularized Token-Level Policy Optimization for Large Language Models">
      <span class="ltx_text ltx_ref_tag">
       D
      </span>
     </a>
     provides concrete examples of the prompts and generated codes. In addition to successful code execution, a done signal will also be received if
     <math alttext="t" class="ltx_Math" display="inline" id="S5.SS1.p2.11.m4.1">
      <semantics id="S5.SS1.p2.11.m4.1a">
       <mi id="S5.SS1.p2.11.m4.1.1" xref="S5.SS1.p2.11.m4.1.1.cmml">
        t
       </mi>
       <annotation-xml encoding="MathML-Content" id="S5.SS1.p2.11.m4.1b">
        <ci id="S5.SS1.p2.11.m4.1.1.cmml" xref="S5.SS1.p2.11.m4.1.1">
         𝑡
        </ci>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="S5.SS1.p2.11.m4.1c">
        t
       </annotation>
      </semantics>
     </math>
     reaches a pre-set maximum step limit, e.g.
     <math alttext="5" class="ltx_Math" display="inline" id="S5.SS1.p2.12.m5.1">
      <semantics id="S5.SS1.p2.12.m5.1a">
       <mn id="S5.SS1.p2.12.m5.1.1" xref="S5.SS1.p2.12.m5.1.1.cmml">
        5
       </mn>
       <annotation-xml encoding="MathML-Content" id="S5.SS1.p2.12.m5.1b">
        <cn id="S5.SS1.p2.12.m5.1.1.cmml" type="integer" xref="S5.SS1.p2.12.m5.1.1">
         5
        </cn>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="S5.SS1.p2.12.m5.1c">
        5
       </annotation>
      </semantics>
     </math>
     in our experiments.
    </p>
   </div>
   <div class="ltx_para" id="S5.SS1.p3">
    <p class="ltx_p" id="S5.SS1.p3.3">
     Adopting the same evaluation metrics as
     <cite class="ltx_cite ltx_citemacro_citep">
      (Hollmann et al.,
      <a class="ltx_ref" href="#bib.bib12" title="">
       2023
      </a>
      )
     </cite>
     , for each dataset, we evaluate 5 repetitions, each with a different random seed and train-validation split to reduce the variance stemming from these splits
     <cite class="ltx_cite ltx_citemacro_citep">
      (Bouthillier et al.,
      <a class="ltx_ref" href="#bib.bib1" title="">
       2021
      </a>
      )
     </cite>
     . We split into
     <math alttext="50\%" class="ltx_Math" display="inline" id="S5.SS1.p3.1.m1.1">
      <semantics id="S5.SS1.p3.1.m1.1a">
       <mrow id="S5.SS1.p3.1.m1.1.1" xref="S5.SS1.p3.1.m1.1.1.cmml">
        <mn id="S5.SS1.p3.1.m1.1.1.2" xref="S5.SS1.p3.1.m1.1.1.2.cmml">
         50
        </mn>
        <mo id="S5.SS1.p3.1.m1.1.1.1" xref="S5.SS1.p3.1.m1.1.1.1.cmml">
         %
        </mo>
       </mrow>
       <annotation-xml encoding="MathML-Content" id="S5.SS1.p3.1.m1.1b">
        <apply id="S5.SS1.p3.1.m1.1.1.cmml" xref="S5.SS1.p3.1.m1.1.1">
         <csymbol cd="latexml" id="S5.SS1.p3.1.m1.1.1.1.cmml" xref="S5.SS1.p3.1.m1.1.1.1">
          percent
         </csymbol>
         <cn id="S5.SS1.p3.1.m1.1.1.2.cmml" type="integer" xref="S5.SS1.p3.1.m1.1.1.2">
          50
         </cn>
        </apply>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="S5.SS1.p3.1.m1.1c">
        50\%
       </annotation>
      </semantics>
     </math>
     train and
     <math alttext="50\%" class="ltx_Math" display="inline" id="S5.SS1.p3.2.m2.1">
      <semantics id="S5.SS1.p3.2.m2.1a">
       <mrow id="S5.SS1.p3.2.m2.1.1" xref="S5.SS1.p3.2.m2.1.1.cmml">
        <mn id="S5.SS1.p3.2.m2.1.1.2" xref="S5.SS1.p3.2.m2.1.1.2.cmml">
         50
        </mn>
        <mo id="S5.SS1.p3.2.m2.1.1.1" xref="S5.SS1.p3.2.m2.1.1.1.cmml">
         %
        </mo>
       </mrow>
       <annotation-xml encoding="MathML-Content" id="S5.SS1.p3.2.m2.1b">
        <apply id="S5.SS1.p3.2.m2.1.1.cmml" xref="S5.SS1.p3.2.m2.1.1">
         <csymbol cd="latexml" id="S5.SS1.p3.2.m2.1.1.1.cmml" xref="S5.SS1.p3.2.m2.1.1.1">
          percent
         </csymbol>
         <cn id="S5.SS1.p3.2.m2.1.1.2.cmml" type="integer" xref="S5.SS1.p3.2.m2.1.1.2">
          50
         </cn>
        </apply>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="S5.SS1.p3.2.m2.1c">
        50\%
       </annotation>
      </semantics>
     </math>
     validation samples and all methods used the same splits. We record the highest reward explored by each method within a given number of environment steps
     <math alttext="k" class="ltx_Math" display="inline" id="S5.SS1.p3.3.m3.1">
      <semantics id="S5.SS1.p3.3.m3.1a">
       <mi id="S5.SS1.p3.3.m3.1.1" xref="S5.SS1.p3.3.m3.1.1.cmml">
        k
       </mi>
       <annotation-xml encoding="MathML-Content" id="S5.SS1.p3.3.m3.1b">
        <ci id="S5.SS1.p3.3.m3.1.1.cmml" xref="S5.SS1.p3.3.m3.1.1">
         𝑘
        </ci>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="S5.SS1.p3.3.m3.1c">
        k
       </annotation>
      </semantics>
     </math>
     as the main criteria for judgment, similar to evaluating AutoML tasks
     <cite class="ltx_cite ltx_citemacro_citep">
      (Hutter et al.,
      <a class="ltx_ref" href="#bib.bib13" title="">
       2019
      </a>
      )
     </cite>
     .
    </p>
   </div>
  </section>
  <section class="ltx_subsection" id="S5.SS2">
   <h3 class="ltx_title ltx_title_subsection">
    <span class="ltx_tag ltx_tag_subsection">
     5.2
    </span>
    Main Results
   </h3>
   <figure class="ltx_figure" id="S5.F3">
    <p class="ltx_p ltx_align_center ltx_align_center" id="S5.F3.1.1">
     <span class="ltx_text" id="S5.F3.1.1.1">
      <img alt="Refer to caption" class="ltx_graphics ltx_img_landscape" height="311" id="S5.F3.1.1.1.g1" src="/html/2402.06700/assets/x2.png" width="415"/>
     </span>
    </p>
    <figcaption class="ltx_caption ltx_centering">
     <span class="ltx_tag ltx_tag_figure">
      Figure 3:
     </span>
     Average of the best reward explored across 14 datasets corresponding to different environmental steps
     <math alttext="k" class="ltx_Math" display="inline" id="S5.F3.3.3.m1.1">
      <semantics id="S5.F3.3.3.m1.1b">
       <mi id="S5.F3.3.3.m1.1.1" xref="S5.F3.3.3.m1.1.1.cmml">
        k
       </mi>
       <annotation-xml encoding="MathML-Content" id="S5.F3.3.3.m1.1c">
        <ci id="S5.F3.3.3.m1.1.1.cmml" xref="S5.F3.3.3.m1.1.1">
         𝑘
        </ci>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="S5.F3.3.3.m1.1d">
        k
       </annotation>
      </semantics>
     </math>
     . ”REF” indicates the Reflection baselines.
    </figcaption>
   </figure>
   <figure class="ltx_table" id="S5.T2">
    <figcaption class="ltx_caption">
     <span class="ltx_tag ltx_tag_table">
      Table 2:
     </span>
     ROC AUC results on validation set where
     <math alttext="\pm" class="ltx_Math" display="inline" id="S5.T2.2.m1.1">
      <semantics id="S5.T2.2.m1.1b">
       <mo id="S5.T2.2.m1.1.1" xref="S5.T2.2.m1.1.1.cmml">
        ±
       </mo>
       <annotation-xml encoding="MathML-Content" id="S5.T2.2.m1.1c">
        <csymbol cd="latexml" id="S5.T2.2.m1.1.1.cmml" xref="S5.T2.2.m1.1.1">
         plus-or-minus
        </csymbol>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="S5.T2.2.m1.1d">
        \pm
       </annotation>
      </semantics>
     </math>
     indicates the standard deviation across 5 splits. ⟨
     <span class="ltx_text ltx_font_italic" id="S5.T2.64.1">
      K
     </span>
     ⟩ denotes the Kaggle datasets.
    </figcaption>
    <table class="ltx_tabular ltx_centering ltx_guessed_headers ltx_align_middle" id="S5.T2.62.60">
     <tbody class="ltx_tbody">
      <tr class="ltx_tr" id="S5.T2.62.60.61.1">
       <th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r ltx_border_tt" id="S5.T2.62.60.61.1.1" rowspan="2">
        <span class="ltx_text ltx_font_smallcaps" id="S5.T2.62.60.61.1.1.1" style="font-size:90%;">
         Data set
        </span>
       </th>
       <td class="ltx_td ltx_align_center ltx_border_tt" id="S5.T2.62.60.61.1.2">
        <span class="ltx_text ltx_font_smallcaps" id="S5.T2.62.60.61.1.2.1" style="font-size:90%;">
         GPT-4
        </span>
       </td>
       <td class="ltx_td ltx_align_center ltx_border_r ltx_border_tt" id="S5.T2.62.60.61.1.3">
        <span class="ltx_text ltx_font_smallcaps" id="S5.T2.62.60.61.1.3.1" style="font-size:90%;">
         CodeLlama-7B
        </span>
       </td>
       <td class="ltx_td ltx_align_center ltx_border_tt" colspan="2" id="S5.T2.62.60.61.1.4">
        <span class="ltx_text ltx_font_smallcaps" id="S5.T2.62.60.61.1.4.1" style="font-size:90%;">
         CodeLlama-7B
        </span>
       </td>
      </tr>
      <tr class="ltx_tr" id="S5.T2.62.60.62.2">
       <td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" colspan="2" id="S5.T2.62.60.62.2.1">
        <span class="ltx_text ltx_font_smallcaps" id="S5.T2.62.60.62.2.1.1" style="font-size:90%;">
         Reflection
        </span>
       </td>
       <td class="ltx_td ltx_align_center ltx_border_t" id="S5.T2.62.60.62.2.2">
        <span class="ltx_text ltx_font_smallcaps" id="S5.T2.62.60.62.2.2.1" style="font-size:90%;">
         PPO-KL
        </span>
       </td>
       <td class="ltx_td ltx_align_center ltx_border_t" id="S5.T2.62.60.62.2.3">
        <span class="ltx_text ltx_font_smallcaps" id="S5.T2.62.60.62.2.3.1" style="font-size:90%;">
         ETPO
        </span>
       </td>
      </tr>
      <tr class="ltx_tr" id="S5.T2.6.4.4">
       <th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r ltx_border_t" id="S5.T2.6.4.4.5">
        <span class="ltx_text ltx_font_smallcaps" id="S5.T2.6.4.4.5.1" style="font-size:90%;">
         Pharyngitis ⟨
        </span>
        <span class="ltx_text ltx_font_italic" id="S5.T2.6.4.4.5.2" style="font-size:90%;">
         K
        </span>
        <span class="ltx_text ltx_font_smallcaps" id="S5.T2.6.4.4.5.3" style="font-size:90%;">
         ⟩
        </span>
       </th>
       <td class="ltx_td ltx_align_center ltx_border_t" id="S5.T2.3.1.1.1">
        <span class="ltx_text ltx_font_smallcaps" id="S5.T2.3.1.1.1.1" style="font-size:90%;">
         0.6902
        </span>
        <math alttext="\pm" class="ltx_Math" display="inline" id="S5.T2.3.1.1.1.m1.1">
         <semantics id="S5.T2.3.1.1.1.m1.1a">
          <mo id="S5.T2.3.1.1.1.m1.1.1" mathsize="90%" xref="S5.T2.3.1.1.1.m1.1.1.cmml">
           ±
          </mo>
          <annotation-xml encoding="MathML-Content" id="S5.T2.3.1.1.1.m1.1b">
           <csymbol cd="latexml" id="S5.T2.3.1.1.1.m1.1.1.cmml" xref="S5.T2.3.1.1.1.m1.1.1">
            plus-or-minus
           </csymbol>
          </annotation-xml>
          <annotation encoding="application/x-tex" id="S5.T2.3.1.1.1.m1.1c">
           \pm
          </annotation>
         </semantics>
        </math>
        <span class="ltx_text ltx_font_smallcaps" id="S5.T2.3.1.1.1.2" style="font-size:90%;">
         0.008
        </span>
       </td>
       <td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S5.T2.4.2.2.2">
        <span class="ltx_text ltx_font_smallcaps" id="S5.T2.4.2.2.2.1" style="font-size:90%;">
         0.7129
        </span>
        <math alttext="\pm" class="ltx_Math" display="inline" id="S5.T2.4.2.2.2.m1.1">
         <semantics id="S5.T2.4.2.2.2.m1.1a">
          <mo id="S5.T2.4.2.2.2.m1.1.1" mathsize="90%" xref="S5.T2.4.2.2.2.m1.1.1.cmml">
           ±
          </mo>
          <annotation-xml encoding="MathML-Content" id="S5.T2.4.2.2.2.m1.1b">
           <csymbol cd="latexml" id="S5.T2.4.2.2.2.m1.1.1.cmml" xref="S5.T2.4.2.2.2.m1.1.1">
            plus-or-minus
           </csymbol>
          </annotation-xml>
          <annotation encoding="application/x-tex" id="S5.T2.4.2.2.2.m1.1c">
           \pm
          </annotation>
         </semantics>
        </math>
        <span class="ltx_text ltx_font_smallcaps" id="S5.T2.4.2.2.2.2" style="font-size:90%;">
         0.010
        </span>
       </td>
       <td class="ltx_td ltx_align_center ltx_border_t" id="S5.T2.5.3.3.3">
        <span class="ltx_text ltx_font_smallcaps" id="S5.T2.5.3.3.3.1" style="font-size:90%;">
         0.7134
        </span>
        <math alttext="\pm" class="ltx_Math" display="inline" id="S5.T2.5.3.3.3.m1.1">
         <semantics id="S5.T2.5.3.3.3.m1.1a">
          <mo id="S5.T2.5.3.3.3.m1.1.1" mathsize="90%" xref="S5.T2.5.3.3.3.m1.1.1.cmml">
           ±
          </mo>
          <annotation-xml encoding="MathML-Content" id="S5.T2.5.3.3.3.m1.1b">
           <csymbol cd="latexml" id="S5.T2.5.3.3.3.m1.1.1.cmml" xref="S5.T2.5.3.3.3.m1.1.1">
            plus-or-minus
           </csymbol>
          </annotation-xml>
          <annotation encoding="application/x-tex" id="S5.T2.5.3.3.3.m1.1c">
           \pm
          </annotation>
         </semantics>
        </math>
        <span class="ltx_text ltx_font_smallcaps" id="S5.T2.5.3.3.3.2" style="font-size:90%;">
         0.009
        </span>
       </td>
       <td class="ltx_td ltx_align_center ltx_border_t" id="S5.T2.6.4.4.4">
        <span class="ltx_text ltx_font_bold" id="S5.T2.6.4.4.4.1" style="font-size:90%;">
         0.7317
         <math alttext="\pm" class="ltx_Math" display="inline" id="S5.T2.6.4.4.4.1.m1.1">
          <semantics id="S5.T2.6.4.4.4.1.m1.1a">
           <mo id="S5.T2.6.4.4.4.1.m1.1.1" xref="S5.T2.6.4.4.4.1.m1.1.1.cmml">
            ±
           </mo>
           <annotation-xml encoding="MathML-Content" id="S5.T2.6.4.4.4.1.m1.1b">
            <csymbol cd="latexml" id="S5.T2.6.4.4.4.1.m1.1.1.cmml" xref="S5.T2.6.4.4.4.1.m1.1.1">
             plus-or-minus
            </csymbol>
           </annotation-xml>
           <annotation encoding="application/x-tex" id="S5.T2.6.4.4.4.1.m1.1c">
            \pm
           </annotation>
          </semantics>
         </math>
        </span>
        <span class="ltx_text ltx_font_smallcaps" id="S5.T2.6.4.4.4.2" style="font-size:90%;">
         0.006
        </span>
       </td>
      </tr>
      <tr class="ltx_tr" id="S5.T2.10.8.8">
       <th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r" id="S5.T2.10.8.8.5">
        <span class="ltx_text ltx_font_smallcaps" id="S5.T2.10.8.8.5.1" style="font-size:90%;">
         Kidney Stone ⟨
        </span>
        <span class="ltx_text ltx_font_italic" id="S5.T2.10.8.8.5.2" style="font-size:90%;">
         K
        </span>
        <span class="ltx_text ltx_font_smallcaps" id="S5.T2.10.8.8.5.3" style="font-size:90%;">
         ⟩
        </span>
       </th>
       <td class="ltx_td ltx_align_center" id="S5.T2.7.5.5.1">
        <span class="ltx_text ltx_font_smallcaps" id="S5.T2.7.5.5.1.1" style="font-size:90%;">
         0.7833
        </span>
        <math alttext="\pm" class="ltx_Math" display="inline" id="S5.T2.7.5.5.1.m1.1">
         <semantics id="S5.T2.7.5.5.1.m1.1a">
          <mo id="S5.T2.7.5.5.1.m1.1.1" mathsize="90%" xref="S5.T2.7.5.5.1.m1.1.1.cmml">
           ±
          </mo>
          <annotation-xml encoding="MathML-Content" id="S5.T2.7.5.5.1.m1.1b">
           <csymbol cd="latexml" id="S5.T2.7.5.5.1.m1.1.1.cmml" xref="S5.T2.7.5.5.1.m1.1.1">
            plus-or-minus
           </csymbol>
          </annotation-xml>
          <annotation encoding="application/x-tex" id="S5.T2.7.5.5.1.m1.1c">
           \pm
          </annotation>
         </semantics>
        </math>
        <span class="ltx_text ltx_font_smallcaps" id="S5.T2.7.5.5.1.2" style="font-size:90%;">
         0.019
        </span>
       </td>
       <td class="ltx_td ltx_align_center ltx_border_r" id="S5.T2.8.6.6.2">
        <span class="ltx_text ltx_font_smallcaps" id="S5.T2.8.6.6.2.1" style="font-size:90%;">
         0.7825
        </span>
        <math alttext="\pm" class="ltx_Math" display="inline" id="S5.T2.8.6.6.2.m1.1">
         <semantics id="S5.T2.8.6.6.2.m1.1a">
          <mo id="S5.T2.8.6.6.2.m1.1.1" mathsize="90%" xref="S5.T2.8.6.6.2.m1.1.1.cmml">
           ±
          </mo>
          <annotation-xml encoding="MathML-Content" id="S5.T2.8.6.6.2.m1.1b">
           <csymbol cd="latexml" id="S5.T2.8.6.6.2.m1.1.1.cmml" xref="S5.T2.8.6.6.2.m1.1.1">
            plus-or-minus
           </csymbol>
          </annotation-xml>
          <annotation encoding="application/x-tex" id="S5.T2.8.6.6.2.m1.1c">
           \pm
          </annotation>
         </semantics>
        </math>
        <span class="ltx_text ltx_font_smallcaps" id="S5.T2.8.6.6.2.2" style="font-size:90%;">
         0.018
        </span>
       </td>
       <td class="ltx_td ltx_align_center" id="S5.T2.9.7.7.3">
        <span class="ltx_text ltx_font_smallcaps" id="S5.T2.9.7.7.3.1" style="font-size:90%;">
         0.7840
        </span>
        <math alttext="\pm" class="ltx_Math" display="inline" id="S5.T2.9.7.7.3.m1.1">
         <semantics id="S5.T2.9.7.7.3.m1.1a">
          <mo id="S5.T2.9.7.7.3.m1.1.1" mathsize="90%" xref="S5.T2.9.7.7.3.m1.1.1.cmml">
           ±
          </mo>
          <annotation-xml encoding="MathML-Content" id="S5.T2.9.7.7.3.m1.1b">
           <csymbol cd="latexml" id="S5.T2.9.7.7.3.m1.1.1.cmml" xref="S5.T2.9.7.7.3.m1.1.1">
            plus-or-minus
           </csymbol>
          </annotation-xml>
          <annotation encoding="application/x-tex" id="S5.T2.9.7.7.3.m1.1c">
           \pm
          </annotation>
         </semantics>
        </math>
        <span class="ltx_text ltx_font_smallcaps" id="S5.T2.9.7.7.3.2" style="font-size:90%;">
         0.015
        </span>
       </td>
       <td class="ltx_td ltx_align_center" id="S5.T2.10.8.8.4">
        <span class="ltx_text ltx_font_bold" id="S5.T2.10.8.8.4.1" style="font-size:90%;">
         0.7881
         <math alttext="\pm" class="ltx_Math" display="inline" id="S5.T2.10.8.8.4.1.m1.1">
          <semantics id="S5.T2.10.8.8.4.1.m1.1a">
           <mo id="S5.T2.10.8.8.4.1.m1.1.1" xref="S5.T2.10.8.8.4.1.m1.1.1.cmml">
            ±
           </mo>
           <annotation-xml encoding="MathML-Content" id="S5.T2.10.8.8.4.1.m1.1b">
            <csymbol cd="latexml" id="S5.T2.10.8.8.4.1.m1.1.1.cmml" xref="S5.T2.10.8.8.4.1.m1.1.1">
             plus-or-minus
            </csymbol>
           </annotation-xml>
           <annotation encoding="application/x-tex" id="S5.T2.10.8.8.4.1.m1.1c">
            \pm
           </annotation>
          </semantics>
         </math>
        </span>
        <span class="ltx_text ltx_font_smallcaps" id="S5.T2.10.8.8.4.2" style="font-size:90%;">
         0.011
        </span>
       </td>
      </tr>
      <tr class="ltx_tr" id="S5.T2.14.12.12">
       <th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r" id="S5.T2.14.12.12.5">
        <span class="ltx_text ltx_font_smallcaps" id="S5.T2.14.12.12.5.1" style="font-size:90%;">
         Health Insurance ⟨
        </span>
        <span class="ltx_text ltx_font_italic" id="S5.T2.14.12.12.5.2" style="font-size:90%;">
         K
        </span>
        <span class="ltx_text ltx_font_smallcaps" id="S5.T2.14.12.12.5.3" style="font-size:90%;">
         ⟩
        </span>
       </th>
       <td class="ltx_td ltx_align_center" id="S5.T2.11.9.9.1">
        <span class="ltx_text ltx_font_smallcaps" id="S5.T2.11.9.9.1.1" style="font-size:90%;">
         0.5826
        </span>
        <math alttext="\pm" class="ltx_Math" display="inline" id="S5.T2.11.9.9.1.m1.1">
         <semantics id="S5.T2.11.9.9.1.m1.1a">
          <mo id="S5.T2.11.9.9.1.m1.1.1" mathsize="90%" xref="S5.T2.11.9.9.1.m1.1.1.cmml">
           ±
          </mo>
          <annotation-xml encoding="MathML-Content" id="S5.T2.11.9.9.1.m1.1b">
           <csymbol cd="latexml" id="S5.T2.11.9.9.1.m1.1.1.cmml" xref="S5.T2.11.9.9.1.m1.1.1">
            plus-or-minus
           </csymbol>
          </annotation-xml>
          <annotation encoding="application/x-tex" id="S5.T2.11.9.9.1.m1.1c">
           \pm
          </annotation>
         </semantics>
        </math>
        <span class="ltx_text ltx_font_smallcaps" id="S5.T2.11.9.9.1.2" style="font-size:90%;">
         0.008
        </span>
       </td>
       <td class="ltx_td ltx_align_center ltx_border_r" id="S5.T2.12.10.10.2">
        <span class="ltx_text ltx_font_smallcaps" id="S5.T2.12.10.10.2.1" style="font-size:90%;">
         0.5725
        </span>
        <math alttext="\pm" class="ltx_Math" display="inline" id="S5.T2.12.10.10.2.m1.1">
         <semantics id="S5.T2.12.10.10.2.m1.1a">
          <mo id="S5.T2.12.10.10.2.m1.1.1" mathsize="90%" xref="S5.T2.12.10.10.2.m1.1.1.cmml">
           ±
          </mo>
          <annotation-xml encoding="MathML-Content" id="S5.T2.12.10.10.2.m1.1b">
           <csymbol cd="latexml" id="S5.T2.12.10.10.2.m1.1.1.cmml" xref="S5.T2.12.10.10.2.m1.1.1">
            plus-or-minus
           </csymbol>
          </annotation-xml>
          <annotation encoding="application/x-tex" id="S5.T2.12.10.10.2.m1.1c">
           \pm
          </annotation>
         </semantics>
        </math>
        <span class="ltx_text ltx_font_smallcaps" id="S5.T2.12.10.10.2.2" style="font-size:90%;">
         0.014
        </span>
       </td>
       <td class="ltx_td ltx_align_center" id="S5.T2.13.11.11.3">
        <span class="ltx_text ltx_font_smallcaps" id="S5.T2.13.11.11.3.1" style="font-size:90%;">
         0.5849
        </span>
        <math alttext="\pm" class="ltx_Math" display="inline" id="S5.T2.13.11.11.3.m1.1">
         <semantics id="S5.T2.13.11.11.3.m1.1a">
          <mo id="S5.T2.13.11.11.3.m1.1.1" mathsize="90%" xref="S5.T2.13.11.11.3.m1.1.1.cmml">
           ±
          </mo>
          <annotation-xml encoding="MathML-Content" id="S5.T2.13.11.11.3.m1.1b">
           <csymbol cd="latexml" id="S5.T2.13.11.11.3.m1.1.1.cmml" xref="S5.T2.13.11.11.3.m1.1.1">
            plus-or-minus
           </csymbol>
          </annotation-xml>
          <annotation encoding="application/x-tex" id="S5.T2.13.11.11.3.m1.1c">
           \pm
          </annotation>
         </semantics>
        </math>
        <span class="ltx_text ltx_font_smallcaps" id="S5.T2.13.11.11.3.2" style="font-size:90%;">
         0.015
        </span>
       </td>
       <td class="ltx_td ltx_align_center" id="S5.T2.14.12.12.4">
        <span class="ltx_text ltx_font_bold" id="S5.T2.14.12.12.4.1" style="font-size:90%;">
         0.5995
         <math alttext="\pm" class="ltx_Math" display="inline" id="S5.T2.14.12.12.4.1.m1.1">
          <semantics id="S5.T2.14.12.12.4.1.m1.1a">
           <mo id="S5.T2.14.12.12.4.1.m1.1.1" xref="S5.T2.14.12.12.4.1.m1.1.1.cmml">
            ±
           </mo>
           <annotation-xml encoding="MathML-Content" id="S5.T2.14.12.12.4.1.m1.1b">
            <csymbol cd="latexml" id="S5.T2.14.12.12.4.1.m1.1.1.cmml" xref="S5.T2.14.12.12.4.1.m1.1.1">
             plus-or-minus
            </csymbol>
           </annotation-xml>
           <annotation encoding="application/x-tex" id="S5.T2.14.12.12.4.1.m1.1c">
            \pm
           </annotation>
          </semantics>
         </math>
        </span>
        <span class="ltx_text ltx_font_smallcaps" id="S5.T2.14.12.12.4.2" style="font-size:90%;">
         0.011
        </span>
       </td>
      </tr>
      <tr class="ltx_tr" id="S5.T2.18.16.16">
       <th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r" id="S5.T2.18.16.16.5">
        <span class="ltx_text ltx_font_smallcaps" id="S5.T2.18.16.16.5.1" style="font-size:90%;">
         Spaceship Titanic ⟨
        </span>
        <span class="ltx_text ltx_font_italic" id="S5.T2.18.16.16.5.2" style="font-size:90%;">
         K
        </span>
        <span class="ltx_text ltx_font_smallcaps" id="S5.T2.18.16.16.5.3" style="font-size:90%;">
         ⟩
        </span>
       </th>
       <td class="ltx_td ltx_align_center" id="S5.T2.15.13.13.1">
        <span class="ltx_text ltx_font_smallcaps" id="S5.T2.15.13.13.1.1" style="font-size:90%;">
         0.8532
        </span>
        <math alttext="\pm" class="ltx_Math" display="inline" id="S5.T2.15.13.13.1.m1.1">
         <semantics id="S5.T2.15.13.13.1.m1.1a">
          <mo id="S5.T2.15.13.13.1.m1.1.1" mathsize="90%" xref="S5.T2.15.13.13.1.m1.1.1.cmml">
           ±
          </mo>
          <annotation-xml encoding="MathML-Content" id="S5.T2.15.13.13.1.m1.1b">
           <csymbol cd="latexml" id="S5.T2.15.13.13.1.m1.1.1.cmml" xref="S5.T2.15.13.13.1.m1.1.1">
            plus-or-minus
           </csymbol>
          </annotation-xml>
          <annotation encoding="application/x-tex" id="S5.T2.15.13.13.1.m1.1c">
           \pm
          </annotation>
         </semantics>
        </math>
        <span class="ltx_text ltx_font_smallcaps" id="S5.T2.15.13.13.1.2" style="font-size:90%;">
         0.015
        </span>
       </td>
       <td class="ltx_td ltx_align_center ltx_border_r" id="S5.T2.16.14.14.2">
        <span class="ltx_text ltx_font_smallcaps" id="S5.T2.16.14.14.2.1" style="font-size:90%;">
         0.8524
        </span>
        <math alttext="\pm" class="ltx_Math" display="inline" id="S5.T2.16.14.14.2.m1.1">
         <semantics id="S5.T2.16.14.14.2.m1.1a">
          <mo id="S5.T2.16.14.14.2.m1.1.1" mathsize="90%" xref="S5.T2.16.14.14.2.m1.1.1.cmml">
           ±
          </mo>
          <annotation-xml encoding="MathML-Content" id="S5.T2.16.14.14.2.m1.1b">
           <csymbol cd="latexml" id="S5.T2.16.14.14.2.m1.1.1.cmml" xref="S5.T2.16.14.14.2.m1.1.1">
            plus-or-minus
           </csymbol>
          </annotation-xml>
          <annotation encoding="application/x-tex" id="S5.T2.16.14.14.2.m1.1c">
           \pm
          </annotation>
         </semantics>
        </math>
        <span class="ltx_text ltx_font_smallcaps" id="S5.T2.16.14.14.2.2" style="font-size:90%;">
         0.015
        </span>
       </td>
       <td class="ltx_td ltx_align_center" id="S5.T2.17.15.15.3">
        <span class="ltx_text ltx_font_smallcaps" id="S5.T2.17.15.15.3.1" style="font-size:90%;">
         0.8575
        </span>
        <math alttext="\pm" class="ltx_Math" display="inline" id="S5.T2.17.15.15.3.m1.1">
         <semantics id="S5.T2.17.15.15.3.m1.1a">
          <mo id="S5.T2.17.15.15.3.m1.1.1" mathsize="90%" xref="S5.T2.17.15.15.3.m1.1.1.cmml">
           ±
          </mo>
          <annotation-xml encoding="MathML-Content" id="S5.T2.17.15.15.3.m1.1b">
           <csymbol cd="latexml" id="S5.T2.17.15.15.3.m1.1.1.cmml" xref="S5.T2.17.15.15.3.m1.1.1">
            plus-or-minus
           </csymbol>
          </annotation-xml>
          <annotation encoding="application/x-tex" id="S5.T2.17.15.15.3.m1.1c">
           \pm
          </annotation>
         </semantics>
        </math>
        <span class="ltx_text ltx_font_smallcaps" id="S5.T2.17.15.15.3.2" style="font-size:90%;">
         0.011
        </span>
       </td>
       <td class="ltx_td ltx_align_center" id="S5.T2.18.16.16.4">
        <span class="ltx_text ltx_font_bold" id="S5.T2.18.16.16.4.1" style="font-size:90%;">
         0.8578
         <math alttext="\pm" class="ltx_Math" display="inline" id="S5.T2.18.16.16.4.1.m1.1">
          <semantics id="S5.T2.18.16.16.4.1.m1.1a">
           <mo id="S5.T2.18.16.16.4.1.m1.1.1" xref="S5.T2.18.16.16.4.1.m1.1.1.cmml">
            ±
           </mo>
           <annotation-xml encoding="MathML-Content" id="S5.T2.18.16.16.4.1.m1.1b">
            <csymbol cd="latexml" id="S5.T2.18.16.16.4.1.m1.1.1.cmml" xref="S5.T2.18.16.16.4.1.m1.1.1">
             plus-or-minus
            </csymbol>
           </annotation-xml>
           <annotation encoding="application/x-tex" id="S5.T2.18.16.16.4.1.m1.1c">
            \pm
           </annotation>
          </semantics>
         </math>
        </span>
        <span class="ltx_text ltx_font_smallcaps" id="S5.T2.18.16.16.4.2" style="font-size:90%;">
         0.015
        </span>
       </td>
      </tr>
      <tr class="ltx_tr" id="S5.T2.22.20.20">
       <th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r ltx_border_t" id="S5.T2.22.20.20.5">
        <span class="ltx_text ltx_font_smallcaps" id="S5.T2.22.20.20.5.1" style="font-size:90%;">
         Airlines
        </span>
       </th>
       <td class="ltx_td ltx_align_center ltx_border_t" id="S5.T2.19.17.17.1">
        <span class="ltx_text ltx_font_smallcaps" id="S5.T2.19.17.17.1.1" style="font-size:90%;">
         0.6495
        </span>
        <math alttext="\pm" class="ltx_Math" display="inline" id="S5.T2.19.17.17.1.m1.1">
         <semantics id="S5.T2.19.17.17.1.m1.1a">
          <mo id="S5.T2.19.17.17.1.m1.1.1" mathsize="90%" xref="S5.T2.19.17.17.1.m1.1.1.cmml">
           ±
          </mo>
          <annotation-xml encoding="MathML-Content" id="S5.T2.19.17.17.1.m1.1b">
           <csymbol cd="latexml" id="S5.T2.19.17.17.1.m1.1.1.cmml" xref="S5.T2.19.17.17.1.m1.1.1">
            plus-or-minus
           </csymbol>
          </annotation-xml>
          <annotation encoding="application/x-tex" id="S5.T2.19.17.17.1.m1.1c">
           \pm
          </annotation>
         </semantics>
        </math>
        <span class="ltx_text ltx_font_smallcaps" id="S5.T2.19.17.17.1.2" style="font-size:90%;">
         0.013
        </span>
       </td>
       <td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S5.T2.20.18.18.2">
        <span class="ltx_text ltx_font_smallcaps" id="S5.T2.20.18.18.2.1" style="font-size:90%;">
         0.6476
        </span>
        <math alttext="\pm" class="ltx_Math" display="inline" id="S5.T2.20.18.18.2.m1.1">
         <semantics id="S5.T2.20.18.18.2.m1.1a">
          <mo id="S5.T2.20.18.18.2.m1.1.1" mathsize="90%" xref="S5.T2.20.18.18.2.m1.1.1.cmml">
           ±
          </mo>
          <annotation-xml encoding="MathML-Content" id="S5.T2.20.18.18.2.m1.1b">
           <csymbol cd="latexml" id="S5.T2.20.18.18.2.m1.1.1.cmml" xref="S5.T2.20.18.18.2.m1.1.1">
            plus-or-minus
           </csymbol>
          </annotation-xml>
          <annotation encoding="application/x-tex" id="S5.T2.20.18.18.2.m1.1c">
           \pm
          </annotation>
         </semantics>
        </math>
        <span class="ltx_text ltx_font_smallcaps" id="S5.T2.20.18.18.2.2" style="font-size:90%;">
         0.012
        </span>
       </td>
       <td class="ltx_td ltx_align_center ltx_border_t" id="S5.T2.21.19.19.3">
        <span class="ltx_text ltx_font_smallcaps" id="S5.T2.21.19.19.3.1" style="font-size:90%;">
         0.6549
        </span>
        <math alttext="\pm" class="ltx_Math" display="inline" id="S5.T2.21.19.19.3.m1.1">
         <semantics id="S5.T2.21.19.19.3.m1.1a">
          <mo id="S5.T2.21.19.19.3.m1.1.1" mathsize="90%" xref="S5.T2.21.19.19.3.m1.1.1.cmml">
           ±
          </mo>
          <annotation-xml encoding="MathML-Content" id="S5.T2.21.19.19.3.m1.1b">
           <csymbol cd="latexml" id="S5.T2.21.19.19.3.m1.1.1.cmml" xref="S5.T2.21.19.19.3.m1.1.1">
            plus-or-minus
           </csymbol>
          </annotation-xml>
          <annotation encoding="application/x-tex" id="S5.T2.21.19.19.3.m1.1c">
           \pm
          </annotation>
         </semantics>
        </math>
        <span class="ltx_text ltx_font_smallcaps" id="S5.T2.21.19.19.3.2" style="font-size:90%;">
         0.011
        </span>
       </td>
       <td class="ltx_td ltx_align_center ltx_border_t" id="S5.T2.22.20.20.4">
        <span class="ltx_text ltx_font_bold" id="S5.T2.22.20.20.4.1" style="font-size:90%;">
         0.6580
         <math alttext="\pm" class="ltx_Math" display="inline" id="S5.T2.22.20.20.4.1.m1.1">
          <semantics id="S5.T2.22.20.20.4.1.m1.1a">
           <mo id="S5.T2.22.20.20.4.1.m1.1.1" xref="S5.T2.22.20.20.4.1.m1.1.1.cmml">
            ±
           </mo>
           <annotation-xml encoding="MathML-Content" id="S5.T2.22.20.20.4.1.m1.1b">
            <csymbol cd="latexml" id="S5.T2.22.20.20.4.1.m1.1.1.cmml" xref="S5.T2.22.20.20.4.1.m1.1.1">
             plus-or-minus
            </csymbol>
           </annotation-xml>
           <annotation encoding="application/x-tex" id="S5.T2.22.20.20.4.1.m1.1c">
            \pm
           </annotation>
          </semantics>
         </math>
        </span>
        <span class="ltx_text ltx_font_smallcaps" id="S5.T2.22.20.20.4.2" style="font-size:90%;">
         0.011
        </span>
       </td>
      </tr>
      <tr class="ltx_tr" id="S5.T2.26.24.24">
       <th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r" id="S5.T2.26.24.24.5">
        <span class="ltx_text ltx_font_smallcaps" id="S5.T2.26.24.24.5.1" style="font-size:90%;">
         Balance Scale
        </span>
       </th>
       <td class="ltx_td ltx_align_center" id="S5.T2.23.21.21.1">
        <span class="ltx_text ltx_font_smallcaps" id="S5.T2.23.21.21.1.1" style="font-size:90%;">
         0.8833
        </span>
        <math alttext="\pm" class="ltx_Math" display="inline" id="S5.T2.23.21.21.1.m1.1">
         <semantics id="S5.T2.23.21.21.1.m1.1a">
          <mo id="S5.T2.23.21.21.1.m1.1.1" mathsize="90%" xref="S5.T2.23.21.21.1.m1.1.1.cmml">
           ±
          </mo>
          <annotation-xml encoding="MathML-Content" id="S5.T2.23.21.21.1.m1.1b">
           <csymbol cd="latexml" id="S5.T2.23.21.21.1.m1.1.1.cmml" xref="S5.T2.23.21.21.1.m1.1.1">
            plus-or-minus
           </csymbol>
          </annotation-xml>
          <annotation encoding="application/x-tex" id="S5.T2.23.21.21.1.m1.1c">
           \pm
          </annotation>
         </semantics>
        </math>
        <span class="ltx_text ltx_font_smallcaps" id="S5.T2.23.21.21.1.2" style="font-size:90%;">
         0.043
        </span>
       </td>
       <td class="ltx_td ltx_align_center ltx_border_r" id="S5.T2.24.22.22.2">
        <span class="ltx_text ltx_font_smallcaps" id="S5.T2.24.22.22.2.1" style="font-size:90%;">
         0.8833
        </span>
        <math alttext="\pm" class="ltx_Math" display="inline" id="S5.T2.24.22.22.2.m1.1">
         <semantics id="S5.T2.24.22.22.2.m1.1a">
          <mo id="S5.T2.24.22.22.2.m1.1.1" mathsize="90%" xref="S5.T2.24.22.22.2.m1.1.1.cmml">
           ±
          </mo>
          <annotation-xml encoding="MathML-Content" id="S5.T2.24.22.22.2.m1.1b">
           <csymbol cd="latexml" id="S5.T2.24.22.22.2.m1.1.1.cmml" xref="S5.T2.24.22.22.2.m1.1.1">
            plus-or-minus
           </csymbol>
          </annotation-xml>
          <annotation encoding="application/x-tex" id="S5.T2.24.22.22.2.m1.1c">
           \pm
          </annotation>
         </semantics>
        </math>
        <span class="ltx_text ltx_font_smallcaps" id="S5.T2.24.22.22.2.2" style="font-size:90%;">
         0.043
        </span>
       </td>
       <td class="ltx_td ltx_align_center" id="S5.T2.25.23.23.3">
        <span class="ltx_text ltx_font_smallcaps" id="S5.T2.25.23.23.3.1" style="font-size:90%;">
         0.8833
        </span>
        <math alttext="\pm" class="ltx_Math" display="inline" id="S5.T2.25.23.23.3.m1.1">
         <semantics id="S5.T2.25.23.23.3.m1.1a">
          <mo id="S5.T2.25.23.23.3.m1.1.1" mathsize="90%" xref="S5.T2.25.23.23.3.m1.1.1.cmml">
           ±
          </mo>
          <annotation-xml encoding="MathML-Content" id="S5.T2.25.23.23.3.m1.1b">
           <csymbol cd="latexml" id="S5.T2.25.23.23.3.m1.1.1.cmml" xref="S5.T2.25.23.23.3.m1.1.1">
            plus-or-minus
           </csymbol>
          </annotation-xml>
          <annotation encoding="application/x-tex" id="S5.T2.25.23.23.3.m1.1c">
           \pm
          </annotation>
         </semantics>
        </math>
        <span class="ltx_text ltx_font_smallcaps" id="S5.T2.25.23.23.3.2" style="font-size:90%;">
         0.043
        </span>
       </td>
       <td class="ltx_td ltx_align_center" id="S5.T2.26.24.24.4">
        <span class="ltx_text ltx_font_bold" id="S5.T2.26.24.24.4.1" style="font-size:90%;">
         0.9289
         <math alttext="\pm" class="ltx_Math" display="inline" id="S5.T2.26.24.24.4.1.m1.1">
          <semantics id="S5.T2.26.24.24.4.1.m1.1a">
           <mo id="S5.T2.26.24.24.4.1.m1.1.1" xref="S5.T2.26.24.24.4.1.m1.1.1.cmml">
            ±
           </mo>
           <annotation-xml encoding="MathML-Content" id="S5.T2.26.24.24.4.1.m1.1b">
            <csymbol cd="latexml" id="S5.T2.26.24.24.4.1.m1.1.1.cmml" xref="S5.T2.26.24.24.4.1.m1.1.1">
             plus-or-minus
            </csymbol>
           </annotation-xml>
           <annotation encoding="application/x-tex" id="S5.T2.26.24.24.4.1.m1.1c">
            \pm
           </annotation>
          </semantics>
         </math>
        </span>
        <span class="ltx_text ltx_font_smallcaps" id="S5.T2.26.24.24.4.2" style="font-size:90%;">
         0.038
        </span>
       </td>
      </tr>
      <tr class="ltx_tr" id="S5.T2.30.28.28">
       <th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r" id="S5.T2.30.28.28.5">
        <span class="ltx_text ltx_font_smallcaps" id="S5.T2.30.28.28.5.1" style="font-size:90%;">
         Breast-w
        </span>
       </th>
       <td class="ltx_td ltx_align_center" id="S5.T2.27.25.25.1">
        <span class="ltx_text ltx_font_smallcaps" id="S5.T2.27.25.25.1.1" style="font-size:90%;">
         0.9944
        </span>
        <math alttext="\pm" class="ltx_Math" display="inline" id="S5.T2.27.25.25.1.m1.1">
         <semantics id="S5.T2.27.25.25.1.m1.1a">
          <mo id="S5.T2.27.25.25.1.m1.1.1" mathsize="90%" xref="S5.T2.27.25.25.1.m1.1.1.cmml">
           ±
          </mo>
          <annotation-xml encoding="MathML-Content" id="S5.T2.27.25.25.1.m1.1b">
           <csymbol cd="latexml" id="S5.T2.27.25.25.1.m1.1.1.cmml" xref="S5.T2.27.25.25.1.m1.1.1">
            plus-or-minus
           </csymbol>
          </annotation-xml>
          <annotation encoding="application/x-tex" id="S5.T2.27.25.25.1.m1.1c">
           \pm
          </annotation>
         </semantics>
        </math>
        <span class="ltx_text ltx_font_smallcaps" id="S5.T2.27.25.25.1.2" style="font-size:90%;">
         0.004
        </span>
       </td>
       <td class="ltx_td ltx_align_center ltx_border_r" id="S5.T2.28.26.26.2">
        <span class="ltx_text ltx_font_smallcaps" id="S5.T2.28.26.26.2.1" style="font-size:90%;">
         0.9941
        </span>
        <math alttext="\pm" class="ltx_Math" display="inline" id="S5.T2.28.26.26.2.m1.1">
         <semantics id="S5.T2.28.26.26.2.m1.1a">
          <mo id="S5.T2.28.26.26.2.m1.1.1" mathsize="90%" xref="S5.T2.28.26.26.2.m1.1.1.cmml">
           ±
          </mo>
          <annotation-xml encoding="MathML-Content" id="S5.T2.28.26.26.2.m1.1b">
           <csymbol cd="latexml" id="S5.T2.28.26.26.2.m1.1.1.cmml" xref="S5.T2.28.26.26.2.m1.1.1">
            plus-or-minus
           </csymbol>
          </annotation-xml>
          <annotation encoding="application/x-tex" id="S5.T2.28.26.26.2.m1.1c">
           \pm
          </annotation>
         </semantics>
        </math>
        <span class="ltx_text ltx_font_smallcaps" id="S5.T2.28.26.26.2.2" style="font-size:90%;">
         0.003
        </span>
       </td>
       <td class="ltx_td ltx_align_center" id="S5.T2.29.27.27.3">
        <span class="ltx_text ltx_font_bold" id="S5.T2.29.27.27.3.1" style="font-size:90%;">
         0.9948
         <math alttext="\pm" class="ltx_Math" display="inline" id="S5.T2.29.27.27.3.1.m1.1">
          <semantics id="S5.T2.29.27.27.3.1.m1.1a">
           <mo id="S5.T2.29.27.27.3.1.m1.1.1" xref="S5.T2.29.27.27.3.1.m1.1.1.cmml">
            ±
           </mo>
           <annotation-xml encoding="MathML-Content" id="S5.T2.29.27.27.3.1.m1.1b">
            <csymbol cd="latexml" id="S5.T2.29.27.27.3.1.m1.1.1.cmml" xref="S5.T2.29.27.27.3.1.m1.1.1">
             plus-or-minus
            </csymbol>
           </annotation-xml>
           <annotation encoding="application/x-tex" id="S5.T2.29.27.27.3.1.m1.1c">
            \pm
           </annotation>
          </semantics>
         </math>
        </span>
        <span class="ltx_text ltx_font_smallcaps" id="S5.T2.29.27.27.3.2" style="font-size:90%;">
         0.003
        </span>
       </td>
       <td class="ltx_td ltx_align_center" id="S5.T2.30.28.28.4">
        <span class="ltx_text ltx_font_bold" id="S5.T2.30.28.28.4.1" style="font-size:90%;">
         0.9948
         <math alttext="\pm" class="ltx_Math" display="inline" id="S5.T2.30.28.28.4.1.m1.1">
          <semantics id="S5.T2.30.28.28.4.1.m1.1a">
           <mo id="S5.T2.30.28.28.4.1.m1.1.1" xref="S5.T2.30.28.28.4.1.m1.1.1.cmml">
            ±
           </mo>
           <annotation-xml encoding="MathML-Content" id="S5.T2.30.28.28.4.1.m1.1b">
            <csymbol cd="latexml" id="S5.T2.30.28.28.4.1.m1.1.1.cmml" xref="S5.T2.30.28.28.4.1.m1.1.1">
             plus-or-minus
            </csymbol>
           </annotation-xml>
           <annotation encoding="application/x-tex" id="S5.T2.30.28.28.4.1.m1.1c">
            \pm
           </annotation>
          </semantics>
         </math>
        </span>
        <span class="ltx_text ltx_font_smallcaps" id="S5.T2.30.28.28.4.2" style="font-size:90%;">
         0.003
        </span>
       </td>
      </tr>
      <tr class="ltx_tr" id="S5.T2.34.32.32">
       <th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r" id="S5.T2.34.32.32.5">
        <span class="ltx_text ltx_font_smallcaps" id="S5.T2.34.32.32.5.1" style="font-size:90%;">
         CMC
        </span>
       </th>
       <td class="ltx_td ltx_align_center" id="S5.T2.31.29.29.1">
        <span class="ltx_text ltx_font_smallcaps" id="S5.T2.31.29.29.1.1" style="font-size:90%;">
         0.6940
        </span>
        <math alttext="\pm" class="ltx_Math" display="inline" id="S5.T2.31.29.29.1.m1.1">
         <semantics id="S5.T2.31.29.29.1.m1.1a">
          <mo id="S5.T2.31.29.29.1.m1.1.1" mathsize="90%" xref="S5.T2.31.29.29.1.m1.1.1.cmml">
           ±
          </mo>
          <annotation-xml encoding="MathML-Content" id="S5.T2.31.29.29.1.m1.1b">
           <csymbol cd="latexml" id="S5.T2.31.29.29.1.m1.1.1.cmml" xref="S5.T2.31.29.29.1.m1.1.1">
            plus-or-minus
           </csymbol>
          </annotation-xml>
          <annotation encoding="application/x-tex" id="S5.T2.31.29.29.1.m1.1c">
           \pm
          </annotation>
         </semantics>
        </math>
        <span class="ltx_text ltx_font_smallcaps" id="S5.T2.31.29.29.1.2" style="font-size:90%;">
         0.006
        </span>
       </td>
       <td class="ltx_td ltx_align_center ltx_border_r" id="S5.T2.32.30.30.2">
        <span class="ltx_text ltx_font_smallcaps" id="S5.T2.32.30.30.2.1" style="font-size:90%;">
         0.7158
        </span>
        <math alttext="\pm" class="ltx_Math" display="inline" id="S5.T2.32.30.30.2.m1.1">
         <semantics id="S5.T2.32.30.30.2.m1.1a">
          <mo id="S5.T2.32.30.30.2.m1.1.1" mathsize="90%" xref="S5.T2.32.30.30.2.m1.1.1.cmml">
           ±
          </mo>
          <annotation-xml encoding="MathML-Content" id="S5.T2.32.30.30.2.m1.1b">
           <csymbol cd="latexml" id="S5.T2.32.30.30.2.m1.1.1.cmml" xref="S5.T2.32.30.30.2.m1.1.1">
            plus-or-minus
           </csymbol>
          </annotation-xml>
          <annotation encoding="application/x-tex" id="S5.T2.32.30.30.2.m1.1c">
           \pm
          </annotation>
         </semantics>
        </math>
        <span class="ltx_text ltx_font_smallcaps" id="S5.T2.32.30.30.2.2" style="font-size:90%;">
         0.006
        </span>
       </td>
       <td class="ltx_td ltx_align_center" id="S5.T2.33.31.31.3">
        <span class="ltx_text ltx_font_smallcaps" id="S5.T2.33.31.31.3.1" style="font-size:90%;">
         0.7278
        </span>
        <math alttext="\pm" class="ltx_Math" display="inline" id="S5.T2.33.31.31.3.m1.1">
         <semantics id="S5.T2.33.31.31.3.m1.1a">
          <mo id="S5.T2.33.31.31.3.m1.1.1" mathsize="90%" xref="S5.T2.33.31.31.3.m1.1.1.cmml">
           ±
          </mo>
          <annotation-xml encoding="MathML-Content" id="S5.T2.33.31.31.3.m1.1b">
           <csymbol cd="latexml" id="S5.T2.33.31.31.3.m1.1.1.cmml" xref="S5.T2.33.31.31.3.m1.1.1">
            plus-or-minus
           </csymbol>
          </annotation-xml>
          <annotation encoding="application/x-tex" id="S5.T2.33.31.31.3.m1.1c">
           \pm
          </annotation>
         </semantics>
        </math>
        <span class="ltx_text ltx_font_smallcaps" id="S5.T2.33.31.31.3.2" style="font-size:90%;">
         0.005
        </span>
       </td>
       <td class="ltx_td ltx_align_center" id="S5.T2.34.32.32.4">
        <span class="ltx_text ltx_font_bold" id="S5.T2.34.32.32.4.1" style="font-size:90%;">
         0.7306
         <math alttext="\pm" class="ltx_Math" display="inline" id="S5.T2.34.32.32.4.1.m1.1">
          <semantics id="S5.T2.34.32.32.4.1.m1.1a">
           <mo id="S5.T2.34.32.32.4.1.m1.1.1" xref="S5.T2.34.32.32.4.1.m1.1.1.cmml">
            ±
           </mo>
           <annotation-xml encoding="MathML-Content" id="S5.T2.34.32.32.4.1.m1.1b">
            <csymbol cd="latexml" id="S5.T2.34.32.32.4.1.m1.1.1.cmml" xref="S5.T2.34.32.32.4.1.m1.1.1">
             plus-or-minus
            </csymbol>
           </annotation-xml>
           <annotation encoding="application/x-tex" id="S5.T2.34.32.32.4.1.m1.1c">
            \pm
           </annotation>
          </semantics>
         </math>
        </span>
        <span class="ltx_text ltx_font_smallcaps" id="S5.T2.34.32.32.4.2" style="font-size:90%;">
         0.003
        </span>
       </td>
      </tr>
      <tr class="ltx_tr" id="S5.T2.38.36.36">
       <th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r" id="S5.T2.38.36.36.5">
        <span class="ltx_text ltx_font_smallcaps" id="S5.T2.38.36.36.5.1" style="font-size:90%;">
         Credit-g
        </span>
       </th>
       <td class="ltx_td ltx_align_center" id="S5.T2.35.33.33.1">
        <span class="ltx_text ltx_font_bold" id="S5.T2.35.33.33.1.1" style="font-size:90%;">
         0.7883
         <math alttext="\pm" class="ltx_Math" display="inline" id="S5.T2.35.33.33.1.1.m1.1">
          <semantics id="S5.T2.35.33.33.1.1.m1.1a">
           <mo id="S5.T2.35.33.33.1.1.m1.1.1" xref="S5.T2.35.33.33.1.1.m1.1.1.cmml">
            ±
           </mo>
           <annotation-xml encoding="MathML-Content" id="S5.T2.35.33.33.1.1.m1.1b">
            <csymbol cd="latexml" id="S5.T2.35.33.33.1.1.m1.1.1.cmml" xref="S5.T2.35.33.33.1.1.m1.1.1">
             plus-or-minus
            </csymbol>
           </annotation-xml>
           <annotation encoding="application/x-tex" id="S5.T2.35.33.33.1.1.m1.1c">
            \pm
           </annotation>
          </semantics>
         </math>
        </span>
        <span class="ltx_text ltx_font_smallcaps" id="S5.T2.35.33.33.1.2" style="font-size:90%;">
         0.024
        </span>
       </td>
       <td class="ltx_td ltx_align_center ltx_border_r" id="S5.T2.36.34.34.2">
        <span class="ltx_text ltx_font_smallcaps" id="S5.T2.36.34.34.2.1" style="font-size:90%;">
         0.7799
        </span>
        <math alttext="\pm" class="ltx_Math" display="inline" id="S5.T2.36.34.34.2.m1.1">
         <semantics id="S5.T2.36.34.34.2.m1.1a">
          <mo id="S5.T2.36.34.34.2.m1.1.1" mathsize="90%" xref="S5.T2.36.34.34.2.m1.1.1.cmml">
           ±
          </mo>
          <annotation-xml encoding="MathML-Content" id="S5.T2.36.34.34.2.m1.1b">
           <csymbol cd="latexml" id="S5.T2.36.34.34.2.m1.1.1.cmml" xref="S5.T2.36.34.34.2.m1.1.1">
            plus-or-minus
           </csymbol>
          </annotation-xml>
          <annotation encoding="application/x-tex" id="S5.T2.36.34.34.2.m1.1c">
           \pm
          </annotation>
         </semantics>
        </math>
        <span class="ltx_text ltx_font_smallcaps" id="S5.T2.36.34.34.2.2" style="font-size:90%;">
         0.021
        </span>
       </td>
       <td class="ltx_td ltx_align_center" id="S5.T2.37.35.35.3">
        <span class="ltx_text ltx_font_smallcaps" id="S5.T2.37.35.35.3.1" style="font-size:90%;">
         0.7850
        </span>
        <math alttext="\pm" class="ltx_Math" display="inline" id="S5.T2.37.35.35.3.m1.1">
         <semantics id="S5.T2.37.35.35.3.m1.1a">
          <mo id="S5.T2.37.35.35.3.m1.1.1" mathsize="90%" xref="S5.T2.37.35.35.3.m1.1.1.cmml">
           ±
          </mo>
          <annotation-xml encoding="MathML-Content" id="S5.T2.37.35.35.3.m1.1b">
           <csymbol cd="latexml" id="S5.T2.37.35.35.3.m1.1.1.cmml" xref="S5.T2.37.35.35.3.m1.1.1">
            plus-or-minus
           </csymbol>
          </annotation-xml>
          <annotation encoding="application/x-tex" id="S5.T2.37.35.35.3.m1.1c">
           \pm
          </annotation>
         </semantics>
        </math>
        <span class="ltx_text ltx_font_smallcaps" id="S5.T2.37.35.35.3.2" style="font-size:90%;">
         0.025
        </span>
       </td>
       <td class="ltx_td ltx_align_center" id="S5.T2.38.36.36.4">
        <span class="ltx_text ltx_font_smallcaps" id="S5.T2.38.36.36.4.1" style="font-size:90%;">
         0.7875
        </span>
        <math alttext="\pm" class="ltx_Math" display="inline" id="S5.T2.38.36.36.4.m1.1">
         <semantics id="S5.T2.38.36.36.4.m1.1a">
          <mo id="S5.T2.38.36.36.4.m1.1.1" mathsize="90%" xref="S5.T2.38.36.36.4.m1.1.1.cmml">
           ±
          </mo>
          <annotation-xml encoding="MathML-Content" id="S5.T2.38.36.36.4.m1.1b">
           <csymbol cd="latexml" id="S5.T2.38.36.36.4.m1.1.1.cmml" xref="S5.T2.38.36.36.4.m1.1.1">
            plus-or-minus
           </csymbol>
          </annotation-xml>
          <annotation encoding="application/x-tex" id="S5.T2.38.36.36.4.m1.1c">
           \pm
          </annotation>
         </semantics>
        </math>
        <span class="ltx_text ltx_font_smallcaps" id="S5.T2.38.36.36.4.2" style="font-size:90%;">
         0.023
        </span>
       </td>
      </tr>
      <tr class="ltx_tr" id="S5.T2.42.40.40">
       <th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r" id="S5.T2.42.40.40.5">
        <span class="ltx_text ltx_font_smallcaps" id="S5.T2.42.40.40.5.1" style="font-size:90%;">
         Diabetes
        </span>
       </th>
       <td class="ltx_td ltx_align_center" id="S5.T2.39.37.37.1">
        <span class="ltx_text ltx_font_smallcaps" id="S5.T2.39.37.37.1.1" style="font-size:90%;">
         0.8327
        </span>
        <math alttext="\pm" class="ltx_Math" display="inline" id="S5.T2.39.37.37.1.m1.1">
         <semantics id="S5.T2.39.37.37.1.m1.1a">
          <mo id="S5.T2.39.37.37.1.m1.1.1" mathsize="90%" xref="S5.T2.39.37.37.1.m1.1.1.cmml">
           ±
          </mo>
          <annotation-xml encoding="MathML-Content" id="S5.T2.39.37.37.1.m1.1b">
           <csymbol cd="latexml" id="S5.T2.39.37.37.1.m1.1.1.cmml" xref="S5.T2.39.37.37.1.m1.1.1">
            plus-or-minus
           </csymbol>
          </annotation-xml>
          <annotation encoding="application/x-tex" id="S5.T2.39.37.37.1.m1.1c">
           \pm
          </annotation>
         </semantics>
        </math>
        <span class="ltx_text ltx_font_smallcaps" id="S5.T2.39.37.37.1.2" style="font-size:90%;">
         0.009
        </span>
       </td>
       <td class="ltx_td ltx_align_center ltx_border_r" id="S5.T2.40.38.38.2">
        <span class="ltx_text ltx_font_smallcaps" id="S5.T2.40.38.38.2.1" style="font-size:90%;">
         0.8321
        </span>
        <math alttext="\pm" class="ltx_Math" display="inline" id="S5.T2.40.38.38.2.m1.1">
         <semantics id="S5.T2.40.38.38.2.m1.1a">
          <mo id="S5.T2.40.38.38.2.m1.1.1" mathsize="90%" xref="S5.T2.40.38.38.2.m1.1.1.cmml">
           ±
          </mo>
          <annotation-xml encoding="MathML-Content" id="S5.T2.40.38.38.2.m1.1b">
           <csymbol cd="latexml" id="S5.T2.40.38.38.2.m1.1.1.cmml" xref="S5.T2.40.38.38.2.m1.1.1">
            plus-or-minus
           </csymbol>
          </annotation-xml>
          <annotation encoding="application/x-tex" id="S5.T2.40.38.38.2.m1.1c">
           \pm
          </annotation>
         </semantics>
        </math>
        <span class="ltx_text ltx_font_smallcaps" id="S5.T2.40.38.38.2.2" style="font-size:90%;">
         0.009
        </span>
       </td>
       <td class="ltx_td ltx_align_center" id="S5.T2.41.39.39.3">
        <span class="ltx_text ltx_font_smallcaps" id="S5.T2.41.39.39.3.1" style="font-size:90%;">
         0.8322
        </span>
        <math alttext="\pm" class="ltx_Math" display="inline" id="S5.T2.41.39.39.3.m1.1">
         <semantics id="S5.T2.41.39.39.3.m1.1a">
          <mo id="S5.T2.41.39.39.3.m1.1.1" mathsize="90%" xref="S5.T2.41.39.39.3.m1.1.1.cmml">
           ±
          </mo>
          <annotation-xml encoding="MathML-Content" id="S5.T2.41.39.39.3.m1.1b">
           <csymbol cd="latexml" id="S5.T2.41.39.39.3.m1.1.1.cmml" xref="S5.T2.41.39.39.3.m1.1.1">
            plus-or-minus
           </csymbol>
          </annotation-xml>
          <annotation encoding="application/x-tex" id="S5.T2.41.39.39.3.m1.1c">
           \pm
          </annotation>
         </semantics>
        </math>
        <span class="ltx_text ltx_font_smallcaps" id="S5.T2.41.39.39.3.2" style="font-size:90%;">
         0.014
        </span>
       </td>
       <td class="ltx_td ltx_align_center" id="S5.T2.42.40.40.4">
        <span class="ltx_text ltx_font_bold" id="S5.T2.42.40.40.4.1" style="font-size:90%;">
         0.8329
         <math alttext="\pm" class="ltx_Math" display="inline" id="S5.T2.42.40.40.4.1.m1.1">
          <semantics id="S5.T2.42.40.40.4.1.m1.1a">
           <mo id="S5.T2.42.40.40.4.1.m1.1.1" xref="S5.T2.42.40.40.4.1.m1.1.1.cmml">
            ±
           </mo>
           <annotation-xml encoding="MathML-Content" id="S5.T2.42.40.40.4.1.m1.1b">
            <csymbol cd="latexml" id="S5.T2.42.40.40.4.1.m1.1.1.cmml" xref="S5.T2.42.40.40.4.1.m1.1.1">
             plus-or-minus
            </csymbol>
           </annotation-xml>
           <annotation encoding="application/x-tex" id="S5.T2.42.40.40.4.1.m1.1c">
            \pm
           </annotation>
          </semantics>
         </math>
        </span>
        <span class="ltx_text ltx_font_smallcaps" id="S5.T2.42.40.40.4.2" style="font-size:90%;">
         0.008
        </span>
       </td>
      </tr>
      <tr class="ltx_tr" id="S5.T2.46.44.44">
       <th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r" id="S5.T2.46.44.44.5">
        <span class="ltx_text ltx_font_smallcaps" id="S5.T2.46.44.44.5.1" style="font-size:90%;">
         Eucalyptus
        </span>
       </th>
       <td class="ltx_td ltx_align_center" id="S5.T2.43.41.41.1">
        <span class="ltx_text ltx_font_smallcaps" id="S5.T2.43.41.41.1.1" style="font-size:90%;">
         0.8960
        </span>
        <math alttext="\pm" class="ltx_Math" display="inline" id="S5.T2.43.41.41.1.m1.1">
         <semantics id="S5.T2.43.41.41.1.m1.1a">
          <mo id="S5.T2.43.41.41.1.m1.1.1" mathsize="90%" xref="S5.T2.43.41.41.1.m1.1.1.cmml">
           ±
          </mo>
          <annotation-xml encoding="MathML-Content" id="S5.T2.43.41.41.1.m1.1b">
           <csymbol cd="latexml" id="S5.T2.43.41.41.1.m1.1.1.cmml" xref="S5.T2.43.41.41.1.m1.1.1">
            plus-or-minus
           </csymbol>
          </annotation-xml>
          <annotation encoding="application/x-tex" id="S5.T2.43.41.41.1.m1.1c">
           \pm
          </annotation>
         </semantics>
        </math>
        <span class="ltx_text ltx_font_smallcaps" id="S5.T2.43.41.41.1.2" style="font-size:90%;">
         0.006
        </span>
       </td>
       <td class="ltx_td ltx_align_center ltx_border_r" id="S5.T2.44.42.42.2">
        <span class="ltx_text ltx_font_smallcaps" id="S5.T2.44.42.42.2.1" style="font-size:90%;">
         0.8961
        </span>
        <math alttext="\pm" class="ltx_Math" display="inline" id="S5.T2.44.42.42.2.m1.1">
         <semantics id="S5.T2.44.42.42.2.m1.1a">
          <mo id="S5.T2.44.42.42.2.m1.1.1" mathsize="90%" xref="S5.T2.44.42.42.2.m1.1.1.cmml">
           ±
          </mo>
          <annotation-xml encoding="MathML-Content" id="S5.T2.44.42.42.2.m1.1b">
           <csymbol cd="latexml" id="S5.T2.44.42.42.2.m1.1.1.cmml" xref="S5.T2.44.42.42.2.m1.1.1">
            plus-or-minus
           </csymbol>
          </annotation-xml>
          <annotation encoding="application/x-tex" id="S5.T2.44.42.42.2.m1.1c">
           \pm
          </annotation>
         </semantics>
        </math>
        <span class="ltx_text ltx_font_smallcaps" id="S5.T2.44.42.42.2.2" style="font-size:90%;">
         0.004
        </span>
       </td>
       <td class="ltx_td ltx_align_center" id="S5.T2.45.43.43.3">
        <span class="ltx_text ltx_font_smallcaps" id="S5.T2.45.43.43.3.1" style="font-size:90%;">
         0.8961
        </span>
        <math alttext="\pm" class="ltx_Math" display="inline" id="S5.T2.45.43.43.3.m1.1">
         <semantics id="S5.T2.45.43.43.3.m1.1a">
          <mo id="S5.T2.45.43.43.3.m1.1.1" mathsize="90%" xref="S5.T2.45.43.43.3.m1.1.1.cmml">
           ±
          </mo>
          <annotation-xml encoding="MathML-Content" id="S5.T2.45.43.43.3.m1.1b">
           <csymbol cd="latexml" id="S5.T2.45.43.43.3.m1.1.1.cmml" xref="S5.T2.45.43.43.3.m1.1.1">
            plus-or-minus
           </csymbol>
          </annotation-xml>
          <annotation encoding="application/x-tex" id="S5.T2.45.43.43.3.m1.1c">
           \pm
          </annotation>
         </semantics>
        </math>
        <span class="ltx_text ltx_font_smallcaps" id="S5.T2.45.43.43.3.2" style="font-size:90%;">
         0.004
        </span>
       </td>
       <td class="ltx_td ltx_align_center" id="S5.T2.46.44.44.4">
        <span class="ltx_text ltx_font_bold" id="S5.T2.46.44.44.4.1" style="font-size:90%;">
         0.8973
         <math alttext="\pm" class="ltx_Math" display="inline" id="S5.T2.46.44.44.4.1.m1.1">
          <semantics id="S5.T2.46.44.44.4.1.m1.1a">
           <mo id="S5.T2.46.44.44.4.1.m1.1.1" xref="S5.T2.46.44.44.4.1.m1.1.1.cmml">
            ±
           </mo>
           <annotation-xml encoding="MathML-Content" id="S5.T2.46.44.44.4.1.m1.1b">
            <csymbol cd="latexml" id="S5.T2.46.44.44.4.1.m1.1.1.cmml" xref="S5.T2.46.44.44.4.1.m1.1.1">
             plus-or-minus
            </csymbol>
           </annotation-xml>
           <annotation encoding="application/x-tex" id="S5.T2.46.44.44.4.1.m1.1c">
            \pm
           </annotation>
          </semantics>
         </math>
        </span>
        <span class="ltx_text ltx_font_smallcaps" id="S5.T2.46.44.44.4.2" style="font-size:90%;">
         0.006
        </span>
       </td>
      </tr>
      <tr class="ltx_tr" id="S5.T2.50.48.48">
       <th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r" id="S5.T2.50.48.48.5">
        <span class="ltx_text ltx_font_smallcaps" id="S5.T2.50.48.48.5.1" style="font-size:90%;">
         Jungle Chess
        </span>
       </th>
       <td class="ltx_td ltx_align_center" id="S5.T2.47.45.45.1">
        <span class="ltx_text ltx_font_smallcaps" id="S5.T2.47.45.45.1.1" style="font-size:90%;">
         0.9100
        </span>
        <math alttext="\pm" class="ltx_Math" display="inline" id="S5.T2.47.45.45.1.m1.1">
         <semantics id="S5.T2.47.45.45.1.m1.1a">
          <mo id="S5.T2.47.45.45.1.m1.1.1" mathsize="90%" xref="S5.T2.47.45.45.1.m1.1.1.cmml">
           ±
          </mo>
          <annotation-xml encoding="MathML-Content" id="S5.T2.47.45.45.1.m1.1b">
           <csymbol cd="latexml" id="S5.T2.47.45.45.1.m1.1.1.cmml" xref="S5.T2.47.45.45.1.m1.1.1">
            plus-or-minus
           </csymbol>
          </annotation-xml>
          <annotation encoding="application/x-tex" id="S5.T2.47.45.45.1.m1.1c">
           \pm
          </annotation>
         </semantics>
        </math>
        <span class="ltx_text ltx_font_smallcaps" id="S5.T2.47.45.45.1.2" style="font-size:90%;">
         0.005
        </span>
       </td>
       <td class="ltx_td ltx_align_center ltx_border_r" id="S5.T2.48.46.46.2">
        <span class="ltx_text ltx_font_smallcaps" id="S5.T2.48.46.46.2.1" style="font-size:90%;">
         0.9097
        </span>
        <math alttext="\pm" class="ltx_Math" display="inline" id="S5.T2.48.46.46.2.m1.1">
         <semantics id="S5.T2.48.46.46.2.m1.1a">
          <mo id="S5.T2.48.46.46.2.m1.1.1" mathsize="90%" xref="S5.T2.48.46.46.2.m1.1.1.cmml">
           ±
          </mo>
          <annotation-xml encoding="MathML-Content" id="S5.T2.48.46.46.2.m1.1b">
           <csymbol cd="latexml" id="S5.T2.48.46.46.2.m1.1.1.cmml" xref="S5.T2.48.46.46.2.m1.1.1">
            plus-or-minus
           </csymbol>
          </annotation-xml>
          <annotation encoding="application/x-tex" id="S5.T2.48.46.46.2.m1.1c">
           \pm
          </annotation>
         </semantics>
        </math>
        <span class="ltx_text ltx_font_smallcaps" id="S5.T2.48.46.46.2.2" style="font-size:90%;">
         0.006
        </span>
       </td>
       <td class="ltx_td ltx_align_center" id="S5.T2.49.47.47.3">
        <span class="ltx_text ltx_font_smallcaps" id="S5.T2.49.47.47.3.1" style="font-size:90%;">
         0.9107
        </span>
        <math alttext="\pm" class="ltx_Math" display="inline" id="S5.T2.49.47.47.3.m1.1">
         <semantics id="S5.T2.49.47.47.3.m1.1a">
          <mo id="S5.T2.49.47.47.3.m1.1.1" mathsize="90%" xref="S5.T2.49.47.47.3.m1.1.1.cmml">
           ±
          </mo>
          <annotation-xml encoding="MathML-Content" id="S5.T2.49.47.47.3.m1.1b">
           <csymbol cd="latexml" id="S5.T2.49.47.47.3.m1.1.1.cmml" xref="S5.T2.49.47.47.3.m1.1.1">
            plus-or-minus
           </csymbol>
          </annotation-xml>
          <annotation encoding="application/x-tex" id="S5.T2.49.47.47.3.m1.1c">
           \pm
          </annotation>
         </semantics>
        </math>
        <span class="ltx_text ltx_font_smallcaps" id="S5.T2.49.47.47.3.2" style="font-size:90%;">
         0.008
        </span>
       </td>
       <td class="ltx_td ltx_align_center" id="S5.T2.50.48.48.4">
        <span class="ltx_text ltx_font_bold" id="S5.T2.50.48.48.4.1" style="font-size:90%;">
         0.9216
         <math alttext="\pm" class="ltx_Math" display="inline" id="S5.T2.50.48.48.4.1.m1.1">
          <semantics id="S5.T2.50.48.48.4.1.m1.1a">
           <mo id="S5.T2.50.48.48.4.1.m1.1.1" xref="S5.T2.50.48.48.4.1.m1.1.1.cmml">
            ±
           </mo>
           <annotation-xml encoding="MathML-Content" id="S5.T2.50.48.48.4.1.m1.1b">
            <csymbol cd="latexml" id="S5.T2.50.48.48.4.1.m1.1.1.cmml" xref="S5.T2.50.48.48.4.1.m1.1.1">
             plus-or-minus
            </csymbol>
           </annotation-xml>
           <annotation encoding="application/x-tex" id="S5.T2.50.48.48.4.1.m1.1c">
            \pm
           </annotation>
          </semantics>
         </math>
        </span>
        <span class="ltx_text ltx_font_smallcaps" id="S5.T2.50.48.48.4.2" style="font-size:90%;">
         0.007
        </span>
       </td>
      </tr>
      <tr class="ltx_tr" id="S5.T2.54.52.52">
       <th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r" id="S5.T2.54.52.52.5">
        <span class="ltx_text ltx_font_smallcaps" id="S5.T2.54.52.52.5.1" style="font-size:90%;">
         PC1
        </span>
       </th>
       <td class="ltx_td ltx_align_center" id="S5.T2.51.49.49.1">
        <span class="ltx_text ltx_font_smallcaps" id="S5.T2.51.49.49.1.1" style="font-size:90%;">
         0.8489
        </span>
        <math alttext="\pm" class="ltx_Math" display="inline" id="S5.T2.51.49.49.1.m1.1">
         <semantics id="S5.T2.51.49.49.1.m1.1a">
          <mo id="S5.T2.51.49.49.1.m1.1.1" mathsize="90%" xref="S5.T2.51.49.49.1.m1.1.1.cmml">
           ±
          </mo>
          <annotation-xml encoding="MathML-Content" id="S5.T2.51.49.49.1.m1.1b">
           <csymbol cd="latexml" id="S5.T2.51.49.49.1.m1.1.1.cmml" xref="S5.T2.51.49.49.1.m1.1.1">
            plus-or-minus
           </csymbol>
          </annotation-xml>
          <annotation encoding="application/x-tex" id="S5.T2.51.49.49.1.m1.1c">
           \pm
          </annotation>
         </semantics>
        </math>
        <span class="ltx_text ltx_font_smallcaps" id="S5.T2.51.49.49.1.2" style="font-size:90%;">
         0.009
        </span>
       </td>
       <td class="ltx_td ltx_align_center ltx_border_r" id="S5.T2.52.50.50.2">
        <span class="ltx_text ltx_font_smallcaps" id="S5.T2.52.50.50.2.1" style="font-size:90%;">
         0.8414
        </span>
        <math alttext="\pm" class="ltx_Math" display="inline" id="S5.T2.52.50.50.2.m1.1">
         <semantics id="S5.T2.52.50.50.2.m1.1a">
          <mo id="S5.T2.52.50.50.2.m1.1.1" mathsize="90%" xref="S5.T2.52.50.50.2.m1.1.1.cmml">
           ±
          </mo>
          <annotation-xml encoding="MathML-Content" id="S5.T2.52.50.50.2.m1.1b">
           <csymbol cd="latexml" id="S5.T2.52.50.50.2.m1.1.1.cmml" xref="S5.T2.52.50.50.2.m1.1.1">
            plus-or-minus
           </csymbol>
          </annotation-xml>
          <annotation encoding="application/x-tex" id="S5.T2.52.50.50.2.m1.1c">
           \pm
          </annotation>
         </semantics>
        </math>
        <span class="ltx_text ltx_font_smallcaps" id="S5.T2.52.50.50.2.2" style="font-size:90%;">
         0.019
        </span>
       </td>
       <td class="ltx_td ltx_align_center" id="S5.T2.53.51.51.3">
        <span class="ltx_text ltx_font_smallcaps" id="S5.T2.53.51.51.3.1" style="font-size:90%;">
         0.8470
        </span>
        <math alttext="\pm" class="ltx_Math" display="inline" id="S5.T2.53.51.51.3.m1.1">
         <semantics id="S5.T2.53.51.51.3.m1.1a">
          <mo id="S5.T2.53.51.51.3.m1.1.1" mathsize="90%" xref="S5.T2.53.51.51.3.m1.1.1.cmml">
           ±
          </mo>
          <annotation-xml encoding="MathML-Content" id="S5.T2.53.51.51.3.m1.1b">
           <csymbol cd="latexml" id="S5.T2.53.51.51.3.m1.1.1.cmml" xref="S5.T2.53.51.51.3.m1.1.1">
            plus-or-minus
           </csymbol>
          </annotation-xml>
          <annotation encoding="application/x-tex" id="S5.T2.53.51.51.3.m1.1c">
           \pm
          </annotation>
         </semantics>
        </math>
        <span class="ltx_text ltx_font_smallcaps" id="S5.T2.53.51.51.3.2" style="font-size:90%;">
         0.021
        </span>
       </td>
       <td class="ltx_td ltx_align_center" id="S5.T2.54.52.52.4">
        <span class="ltx_text ltx_font_bold" id="S5.T2.54.52.52.4.1" style="font-size:90%;">
         0.8492
         <math alttext="\pm" class="ltx_Math" display="inline" id="S5.T2.54.52.52.4.1.m1.1">
          <semantics id="S5.T2.54.52.52.4.1.m1.1a">
           <mo id="S5.T2.54.52.52.4.1.m1.1.1" xref="S5.T2.54.52.52.4.1.m1.1.1.cmml">
            ±
           </mo>
           <annotation-xml encoding="MathML-Content" id="S5.T2.54.52.52.4.1.m1.1b">
            <csymbol cd="latexml" id="S5.T2.54.52.52.4.1.m1.1.1.cmml" xref="S5.T2.54.52.52.4.1.m1.1.1">
             plus-or-minus
            </csymbol>
           </annotation-xml>
           <annotation encoding="application/x-tex" id="S5.T2.54.52.52.4.1.m1.1c">
            \pm
           </annotation>
          </semantics>
         </math>
        </span>
        <span class="ltx_text ltx_font_smallcaps" id="S5.T2.54.52.52.4.2" style="font-size:90%;">
         0.016
        </span>
       </td>
      </tr>
      <tr class="ltx_tr" id="S5.T2.58.56.56">
       <th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_r" id="S5.T2.58.56.56.5">
        <span class="ltx_text ltx_font_smallcaps" id="S5.T2.58.56.56.5.1" style="font-size:90%;">
         Tic-Tac-Toe
        </span>
       </th>
       <td class="ltx_td ltx_align_center" id="S5.T2.55.53.53.1">
        <span class="ltx_text ltx_font_smallcaps" id="S5.T2.55.53.53.1.1" style="font-size:90%;">
         0.7560
        </span>
        <math alttext="\pm" class="ltx_Math" display="inline" id="S5.T2.55.53.53.1.m1.1">
         <semantics id="S5.T2.55.53.53.1.m1.1a">
          <mo id="S5.T2.55.53.53.1.m1.1.1" mathsize="90%" xref="S5.T2.55.53.53.1.m1.1.1.cmml">
           ±
          </mo>
          <annotation-xml encoding="MathML-Content" id="S5.T2.55.53.53.1.m1.1b">
           <csymbol cd="latexml" id="S5.T2.55.53.53.1.m1.1.1.cmml" xref="S5.T2.55.53.53.1.m1.1.1">
            plus-or-minus
           </csymbol>
          </annotation-xml>
          <annotation encoding="application/x-tex" id="S5.T2.55.53.53.1.m1.1c">
           \pm
          </annotation>
         </semantics>
        </math>
        <span class="ltx_text ltx_font_smallcaps" id="S5.T2.55.53.53.1.2" style="font-size:90%;">
         0.039
        </span>
       </td>
       <td class="ltx_td ltx_align_center ltx_border_r" id="S5.T2.56.54.54.2">
        <span class="ltx_text ltx_font_smallcaps" id="S5.T2.56.54.54.2.1" style="font-size:90%;">
         0.7304
        </span>
        <math alttext="\pm" class="ltx_Math" display="inline" id="S5.T2.56.54.54.2.m1.1">
         <semantics id="S5.T2.56.54.54.2.m1.1a">
          <mo id="S5.T2.56.54.54.2.m1.1.1" mathsize="90%" xref="S5.T2.56.54.54.2.m1.1.1.cmml">
           ±
          </mo>
          <annotation-xml encoding="MathML-Content" id="S5.T2.56.54.54.2.m1.1b">
           <csymbol cd="latexml" id="S5.T2.56.54.54.2.m1.1.1.cmml" xref="S5.T2.56.54.54.2.m1.1.1">
            plus-or-minus
           </csymbol>
          </annotation-xml>
          <annotation encoding="application/x-tex" id="S5.T2.56.54.54.2.m1.1c">
           \pm
          </annotation>
         </semantics>
        </math>
        <span class="ltx_text ltx_font_smallcaps" id="S5.T2.56.54.54.2.2" style="font-size:90%;">
         0.057
        </span>
       </td>
       <td class="ltx_td ltx_align_center" id="S5.T2.57.55.55.3">
        <span class="ltx_text ltx_font_smallcaps" id="S5.T2.57.55.55.3.1" style="font-size:90%;">
         0.7356
        </span>
        <math alttext="\pm" class="ltx_Math" display="inline" id="S5.T2.57.55.55.3.m1.1">
         <semantics id="S5.T2.57.55.55.3.m1.1a">
          <mo id="S5.T2.57.55.55.3.m1.1.1" mathsize="90%" xref="S5.T2.57.55.55.3.m1.1.1.cmml">
           ±
          </mo>
          <annotation-xml encoding="MathML-Content" id="S5.T2.57.55.55.3.m1.1b">
           <csymbol cd="latexml" id="S5.T2.57.55.55.3.m1.1.1.cmml" xref="S5.T2.57.55.55.3.m1.1.1">
            plus-or-minus
           </csymbol>
          </annotation-xml>
          <annotation encoding="application/x-tex" id="S5.T2.57.55.55.3.m1.1c">
           \pm
          </annotation>
         </semantics>
        </math>
        <span class="ltx_text ltx_font_smallcaps" id="S5.T2.57.55.55.3.2" style="font-size:90%;">
         0.036
        </span>
       </td>
       <td class="ltx_td ltx_align_center" id="S5.T2.58.56.56.4">
        <span class="ltx_text ltx_font_bold" id="S5.T2.58.56.56.4.1" style="font-size:90%;">
         0.7483
         <math alttext="\pm" class="ltx_Math" display="inline" id="S5.T2.58.56.56.4.1.m1.1">
          <semantics id="S5.T2.58.56.56.4.1.m1.1a">
           <mo id="S5.T2.58.56.56.4.1.m1.1.1" xref="S5.T2.58.56.56.4.1.m1.1.1.cmml">
            ±
           </mo>
           <annotation-xml encoding="MathML-Content" id="S5.T2.58.56.56.4.1.m1.1b">
            <csymbol cd="latexml" id="S5.T2.58.56.56.4.1.m1.1.1.cmml" xref="S5.T2.58.56.56.4.1.m1.1.1">
             plus-or-minus
            </csymbol>
           </annotation-xml>
           <annotation encoding="application/x-tex" id="S5.T2.58.56.56.4.1.m1.1c">
            \pm
           </annotation>
          </semantics>
         </math>
        </span>
        <span class="ltx_text ltx_font_smallcaps" id="S5.T2.58.56.56.4.2" style="font-size:90%;">
         0.032
        </span>
       </td>
      </tr>
      <tr class="ltx_tr" id="S5.T2.62.60.60">
       <th class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_bb ltx_border_r ltx_border_t" id="S5.T2.62.60.60.5">
        <span class="ltx_text ltx_font_smallcaps" id="S5.T2.62.60.60.5.1" style="font-size:90%;">
         Average
        </span>
       </th>
       <td class="ltx_td ltx_align_center ltx_border_bb ltx_border_t" id="S5.T2.59.57.57.1">
        <span class="ltx_text ltx_font_smallcaps" id="S5.T2.59.57.57.1.1" style="font-size:90%;">
         0.7973
        </span>
        <math alttext="\pm" class="ltx_Math" display="inline" id="S5.T2.59.57.57.1.m1.1">
         <semantics id="S5.T2.59.57.57.1.m1.1a">
          <mo id="S5.T2.59.57.57.1.m1.1.1" mathsize="90%" xref="S5.T2.59.57.57.1.m1.1.1.cmml">
           ±
          </mo>
          <annotation-xml encoding="MathML-Content" id="S5.T2.59.57.57.1.m1.1b">
           <csymbol cd="latexml" id="S5.T2.59.57.57.1.m1.1.1.cmml" xref="S5.T2.59.57.57.1.m1.1.1">
            plus-or-minus
           </csymbol>
          </annotation-xml>
          <annotation encoding="application/x-tex" id="S5.T2.59.57.57.1.m1.1c">
           \pm
          </annotation>
         </semantics>
        </math>
        <span class="ltx_text ltx_font_smallcaps" id="S5.T2.59.57.57.1.2" style="font-size:90%;">
         0.015
        </span>
       </td>
       <td class="ltx_td ltx_align_center ltx_border_bb ltx_border_r ltx_border_t" id="S5.T2.60.58.58.2">
        <span class="ltx_text ltx_font_smallcaps" id="S5.T2.60.58.58.2.1" style="font-size:90%;">
         0.7965
        </span>
        <math alttext="\pm" class="ltx_Math" display="inline" id="S5.T2.60.58.58.2.m1.1">
         <semantics id="S5.T2.60.58.58.2.m1.1a">
          <mo id="S5.T2.60.58.58.2.m1.1.1" mathsize="90%" xref="S5.T2.60.58.58.2.m1.1.1.cmml">
           ±
          </mo>
          <annotation-xml encoding="MathML-Content" id="S5.T2.60.58.58.2.m1.1b">
           <csymbol cd="latexml" id="S5.T2.60.58.58.2.m1.1.1.cmml" xref="S5.T2.60.58.58.2.m1.1.1">
            plus-or-minus
           </csymbol>
          </annotation-xml>
          <annotation encoding="application/x-tex" id="S5.T2.60.58.58.2.m1.1c">
           \pm
          </annotation>
         </semantics>
        </math>
        <span class="ltx_text ltx_font_smallcaps" id="S5.T2.60.58.58.2.2" style="font-size:90%;">
         0.017
        </span>
       </td>
       <td class="ltx_td ltx_align_center ltx_border_bb ltx_border_t" id="S5.T2.61.59.59.3">
        <span class="ltx_text ltx_font_smallcaps" id="S5.T2.61.59.59.3.1" style="font-size:90%;">
         0.8005
        </span>
        <math alttext="\pm" class="ltx_Math" display="inline" id="S5.T2.61.59.59.3.m1.1">
         <semantics id="S5.T2.61.59.59.3.m1.1a">
          <mo id="S5.T2.61.59.59.3.m1.1.1" mathsize="90%" xref="S5.T2.61.59.59.3.m1.1.1.cmml">
           ±
          </mo>
          <annotation-xml encoding="MathML-Content" id="S5.T2.61.59.59.3.m1.1b">
           <csymbol cd="latexml" id="S5.T2.61.59.59.3.m1.1.1.cmml" xref="S5.T2.61.59.59.3.m1.1.1">
            plus-or-minus
           </csymbol>
          </annotation-xml>
          <annotation encoding="application/x-tex" id="S5.T2.61.59.59.3.m1.1c">
           \pm
          </annotation>
         </semantics>
        </math>
        <span class="ltx_text ltx_font_smallcaps" id="S5.T2.61.59.59.3.2" style="font-size:90%;">
         0.016
        </span>
       </td>
       <td class="ltx_td ltx_align_center ltx_border_bb ltx_border_t" id="S5.T2.62.60.60.4">
        <span class="ltx_text ltx_font_bold" id="S5.T2.62.60.60.4.1" style="font-size:90%;">
         0.8090
         <math alttext="\pm" class="ltx_Math" display="inline" id="S5.T2.62.60.60.4.1.m1.1">
          <semantics id="S5.T2.62.60.60.4.1.m1.1a">
           <mo id="S5.T2.62.60.60.4.1.m1.1.1" xref="S5.T2.62.60.60.4.1.m1.1.1.cmml">
            ±
           </mo>
           <annotation-xml encoding="MathML-Content" id="S5.T2.62.60.60.4.1.m1.1b">
            <csymbol cd="latexml" id="S5.T2.62.60.60.4.1.m1.1.1.cmml" xref="S5.T2.62.60.60.4.1.m1.1.1">
             plus-or-minus
            </csymbol>
           </annotation-xml>
           <annotation encoding="application/x-tex" id="S5.T2.62.60.60.4.1.m1.1c">
            \pm
           </annotation>
          </semantics>
         </math>
        </span>
        <span class="ltx_text ltx_font_smallcaps" id="S5.T2.62.60.60.4.2" style="font-size:90%;">
         0.013
        </span>
       </td>
      </tr>
     </tbody>
    </table>
   </figure>
   <div class="ltx_para" id="S5.SS2.p1">
    <p class="ltx_p" id="S5.SS2.p1.4">
     Figure
     <a class="ltx_ref" href="#S5.F3" title="Figure 3 ‣ 5.2 Main Results ‣ 5 Experiments ‣ Entropy-Regularized Token-Level Policy Optimization for Large Language Models">
      <span class="ltx_text ltx_ref_tag">
       3
      </span>
     </a>
     shows the trends of average performance of ETPO and three related baseline methods across
     <math alttext="14" class="ltx_Math" display="inline" id="S5.SS2.p1.1.m1.1">
      <semantics id="S5.SS2.p1.1.m1.1a">
       <mn id="S5.SS2.p1.1.m1.1.1" xref="S5.SS2.p1.1.m1.1.1.cmml">
        14
       </mn>
       <annotation-xml encoding="MathML-Content" id="S5.SS2.p1.1.m1.1b">
        <cn id="S5.SS2.p1.1.m1.1.1.cmml" type="integer" xref="S5.SS2.p1.1.m1.1.1">
         14
        </cn>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="S5.SS2.p1.1.m1.1c">
        14
       </annotation>
      </semantics>
     </math>
     datasets under different exploration intensities, i.e.
     <math alttext="k" class="ltx_Math" display="inline" id="S5.SS2.p1.2.m2.1">
      <semantics id="S5.SS2.p1.2.m2.1a">
       <mi id="S5.SS2.p1.2.m2.1.1" xref="S5.SS2.p1.2.m2.1.1.cmml">
        k
       </mi>
       <annotation-xml encoding="MathML-Content" id="S5.SS2.p1.2.m2.1b">
        <ci id="S5.SS2.p1.2.m2.1.1.cmml" xref="S5.SS2.p1.2.m2.1.1">
         𝑘
        </ci>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="S5.SS2.p1.2.m2.1c">
        k
       </annotation>
      </semantics>
     </math>
     . More specifically, Table
     <a class="ltx_ref" href="#S5.T2" title="Table 2 ‣ 5.2 Main Results ‣ 5 Experiments ‣ Entropy-Regularized Token-Level Policy Optimization for Large Language Models">
      <span class="ltx_text ltx_ref_tag">
       2
      </span>
     </a>
     shows the highest reward explored by these methods for each dataset within
     <math alttext="500" class="ltx_Math" display="inline" id="S5.SS2.p1.3.m3.1">
      <semantics id="S5.SS2.p1.3.m3.1a">
       <mn id="S5.SS2.p1.3.m3.1.1" xref="S5.SS2.p1.3.m3.1.1.cmml">
        500
       </mn>
       <annotation-xml encoding="MathML-Content" id="S5.SS2.p1.3.m3.1b">
        <cn id="S5.SS2.p1.3.m3.1.1.cmml" type="integer" xref="S5.SS2.p1.3.m3.1.1">
         500
        </cn>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="S5.SS2.p1.3.m3.1c">
        500
       </annotation>
      </semantics>
     </math>
     interactive steps. Among these baselines, the
     <span class="ltx_text ltx_font_italic" id="S5.SS2.p1.4.1">
      Reflection
     </span>
     keeps the interactive pipeline of ETPO unchanged but removes the training process as a reference for LLMs’ initial performance.
Besides, similar to RLHF, we also implement an action-level PPO with KL term in the reward function:
     <math alttext="r(s_{t},a_{t})-\beta\log\frac{\pi(a_{t}|s_{t})}{\rho(a_{t}|s_{t})}" class="ltx_Math" display="inline" id="S5.SS2.p1.4.m4.4">
      <semantics id="S5.SS2.p1.4.m4.4a">
       <mrow id="S5.SS2.p1.4.m4.4.4" xref="S5.SS2.p1.4.m4.4.4.cmml">
        <mrow id="S5.SS2.p1.4.m4.4.4.2" xref="S5.SS2.p1.4.m4.4.4.2.cmml">
         <mi id="S5.SS2.p1.4.m4.4.4.2.4" xref="S5.SS2.p1.4.m4.4.4.2.4.cmml">
          r
         </mi>
         <mo id="S5.SS2.p1.4.m4.4.4.2.3" lspace="0em" rspace="0em" xref="S5.SS2.p1.4.m4.4.4.2.3.cmml">
          ​
         </mo>
         <mrow id="S5.SS2.p1.4.m4.4.4.2.2.2" xref="S5.SS2.p1.4.m4.4.4.2.2.3.cmml">
          <mo id="S5.SS2.p1.4.m4.4.4.2.2.2.3" stretchy="false" xref="S5.SS2.p1.4.m4.4.4.2.2.3.cmml">
           (
          </mo>
          <msub id="S5.SS2.p1.4.m4.3.3.1.1.1.1" xref="S5.SS2.p1.4.m4.3.3.1.1.1.1.cmml">
           <mi id="S5.SS2.p1.4.m4.3.3.1.1.1.1.2" xref="S5.SS2.p1.4.m4.3.3.1.1.1.1.2.cmml">
            s
           </mi>
           <mi id="S5.SS2.p1.4.m4.3.3.1.1.1.1.3" xref="S5.SS2.p1.4.m4.3.3.1.1.1.1.3.cmml">
            t
           </mi>
          </msub>
          <mo id="S5.SS2.p1.4.m4.4.4.2.2.2.4" xref="S5.SS2.p1.4.m4.4.4.2.2.3.cmml">
           ,
          </mo>
          <msub id="S5.SS2.p1.4.m4.4.4.2.2.2.2" xref="S5.SS2.p1.4.m4.4.4.2.2.2.2.cmml">
           <mi id="S5.SS2.p1.4.m4.4.4.2.2.2.2.2" xref="S5.SS2.p1.4.m4.4.4.2.2.2.2.2.cmml">
            a
           </mi>
           <mi id="S5.SS2.p1.4.m4.4.4.2.2.2.2.3" xref="S5.SS2.p1.4.m4.4.4.2.2.2.2.3.cmml">
            t
           </mi>
          </msub>
          <mo id="S5.SS2.p1.4.m4.4.4.2.2.2.5" stretchy="false" xref="S5.SS2.p1.4.m4.4.4.2.2.3.cmml">
           )
          </mo>
         </mrow>
        </mrow>
        <mo id="S5.SS2.p1.4.m4.4.4.3" xref="S5.SS2.p1.4.m4.4.4.3.cmml">
         −
        </mo>
        <mrow id="S5.SS2.p1.4.m4.4.4.4" xref="S5.SS2.p1.4.m4.4.4.4.cmml">
         <mi id="S5.SS2.p1.4.m4.4.4.4.2" xref="S5.SS2.p1.4.m4.4.4.4.2.cmml">
          β
         </mi>
         <mo id="S5.SS2.p1.4.m4.4.4.4.1" lspace="0.167em" rspace="0em" xref="S5.SS2.p1.4.m4.4.4.4.1.cmml">
          ​
         </mo>
         <mrow id="S5.SS2.p1.4.m4.4.4.4.3" xref="S5.SS2.p1.4.m4.4.4.4.3.cmml">
          <mi id="S5.SS2.p1.4.m4.4.4.4.3.1" xref="S5.SS2.p1.4.m4.4.4.4.3.1.cmml">
           log
          </mi>
          <mo id="S5.SS2.p1.4.m4.4.4.4.3a" lspace="0.167em" xref="S5.SS2.p1.4.m4.4.4.4.3.cmml">
           ⁡
          </mo>
          <mfrac id="S5.SS2.p1.4.m4.2.2" xref="S5.SS2.p1.4.m4.2.2.cmml">
           <mrow id="S5.SS2.p1.4.m4.1.1.1" xref="S5.SS2.p1.4.m4.1.1.1.cmml">
            <mi id="S5.SS2.p1.4.m4.1.1.1.3" xref="S5.SS2.p1.4.m4.1.1.1.3.cmml">
             π
            </mi>
            <mo id="S5.SS2.p1.4.m4.1.1.1.2" lspace="0em" rspace="0em" xref="S5.SS2.p1.4.m4.1.1.1.2.cmml">
             ​
            </mo>
            <mrow id="S5.SS2.p1.4.m4.1.1.1.1.1" xref="S5.SS2.p1.4.m4.1.1.1.1.1.1.cmml">
             <mo id="S5.SS2.p1.4.m4.1.1.1.1.1.2" stretchy="false" xref="S5.SS2.p1.4.m4.1.1.1.1.1.1.cmml">
              (
             </mo>
             <mrow id="S5.SS2.p1.4.m4.1.1.1.1.1.1" xref="S5.SS2.p1.4.m4.1.1.1.1.1.1.cmml">
              <msub id="S5.SS2.p1.4.m4.1.1.1.1.1.1.2" xref="S5.SS2.p1.4.m4.1.1.1.1.1.1.2.cmml">
               <mi id="S5.SS2.p1.4.m4.1.1.1.1.1.1.2.2" xref="S5.SS2.p1.4.m4.1.1.1.1.1.1.2.2.cmml">
                a
               </mi>
               <mi id="S5.SS2.p1.4.m4.1.1.1.1.1.1.2.3" xref="S5.SS2.p1.4.m4.1.1.1.1.1.1.2.3.cmml">
                t
               </mi>
              </msub>
              <mo fence="false" id="S5.SS2.p1.4.m4.1.1.1.1.1.1.1" xref="S5.SS2.p1.4.m4.1.1.1.1.1.1.1.cmml">
               |
              </mo>
              <msub id="S5.SS2.p1.4.m4.1.1.1.1.1.1.3" xref="S5.SS2.p1.4.m4.1.1.1.1.1.1.3.cmml">
               <mi id="S5.SS2.p1.4.m4.1.1.1.1.1.1.3.2" xref="S5.SS2.p1.4.m4.1.1.1.1.1.1.3.2.cmml">
                s
               </mi>
               <mi id="S5.SS2.p1.4.m4.1.1.1.1.1.1.3.3" xref="S5.SS2.p1.4.m4.1.1.1.1.1.1.3.3.cmml">
                t
               </mi>
              </msub>
             </mrow>
             <mo id="S5.SS2.p1.4.m4.1.1.1.1.1.3" stretchy="false" xref="S5.SS2.p1.4.m4.1.1.1.1.1.1.cmml">
              )
             </mo>
            </mrow>
           </mrow>
           <mrow id="S5.SS2.p1.4.m4.2.2.2" xref="S5.SS2.p1.4.m4.2.2.2.cmml">
            <mi id="S5.SS2.p1.4.m4.2.2.2.3" xref="S5.SS2.p1.4.m4.2.2.2.3.cmml">
             ρ
            </mi>
            <mo id="S5.SS2.p1.4.m4.2.2.2.2" lspace="0em" rspace="0em" xref="S5.SS2.p1.4.m4.2.2.2.2.cmml">
             ​
            </mo>
            <mrow id="S5.SS2.p1.4.m4.2.2.2.1.1" xref="S5.SS2.p1.4.m4.2.2.2.1.1.1.cmml">
             <mo id="S5.SS2.p1.4.m4.2.2.2.1.1.2" stretchy="false" xref="S5.SS2.p1.4.m4.2.2.2.1.1.1.cmml">
              (
             </mo>
             <mrow id="S5.SS2.p1.4.m4.2.2.2.1.1.1" xref="S5.SS2.p1.4.m4.2.2.2.1.1.1.cmml">
              <msub id="S5.SS2.p1.4.m4.2.2.2.1.1.1.2" xref="S5.SS2.p1.4.m4.2.2.2.1.1.1.2.cmml">
               <mi id="S5.SS2.p1.4.m4.2.2.2.1.1.1.2.2" xref="S5.SS2.p1.4.m4.2.2.2.1.1.1.2.2.cmml">
                a
               </mi>
               <mi id="S5.SS2.p1.4.m4.2.2.2.1.1.1.2.3" xref="S5.SS2.p1.4.m4.2.2.2.1.1.1.2.3.cmml">
                t
               </mi>
              </msub>
              <mo fence="false" id="S5.SS2.p1.4.m4.2.2.2.1.1.1.1" xref="S5.SS2.p1.4.m4.2.2.2.1.1.1.1.cmml">
               |
              </mo>
              <msub id="S5.SS2.p1.4.m4.2.2.2.1.1.1.3" xref="S5.SS2.p1.4.m4.2.2.2.1.1.1.3.cmml">
               <mi id="S5.SS2.p1.4.m4.2.2.2.1.1.1.3.2" xref="S5.SS2.p1.4.m4.2.2.2.1.1.1.3.2.cmml">
                s
               </mi>
               <mi id="S5.SS2.p1.4.m4.2.2.2.1.1.1.3.3" xref="S5.SS2.p1.4.m4.2.2.2.1.1.1.3.3.cmml">
                t
               </mi>
              </msub>
             </mrow>
             <mo id="S5.SS2.p1.4.m4.2.2.2.1.1.3" stretchy="false" xref="S5.SS2.p1.4.m4.2.2.2.1.1.1.cmml">
              )
             </mo>
            </mrow>
           </mrow>
          </mfrac>
         </mrow>
        </mrow>
       </mrow>
       <annotation-xml encoding="MathML-Content" id="S5.SS2.p1.4.m4.4b">
        <apply id="S5.SS2.p1.4.m4.4.4.cmml" xref="S5.SS2.p1.4.m4.4.4">
         <minus id="S5.SS2.p1.4.m4.4.4.3.cmml" xref="S5.SS2.p1.4.m4.4.4.3">
         </minus>
         <apply id="S5.SS2.p1.4.m4.4.4.2.cmml" xref="S5.SS2.p1.4.m4.4.4.2">
          <times id="S5.SS2.p1.4.m4.4.4.2.3.cmml" xref="S5.SS2.p1.4.m4.4.4.2.3">
          </times>
          <ci id="S5.SS2.p1.4.m4.4.4.2.4.cmml" xref="S5.SS2.p1.4.m4.4.4.2.4">
           𝑟
          </ci>
          <interval closure="open" id="S5.SS2.p1.4.m4.4.4.2.2.3.cmml" xref="S5.SS2.p1.4.m4.4.4.2.2.2">
           <apply id="S5.SS2.p1.4.m4.3.3.1.1.1.1.cmml" xref="S5.SS2.p1.4.m4.3.3.1.1.1.1">
            <csymbol cd="ambiguous" id="S5.SS2.p1.4.m4.3.3.1.1.1.1.1.cmml" xref="S5.SS2.p1.4.m4.3.3.1.1.1.1">
             subscript
            </csymbol>
            <ci id="S5.SS2.p1.4.m4.3.3.1.1.1.1.2.cmml" xref="S5.SS2.p1.4.m4.3.3.1.1.1.1.2">
             𝑠
            </ci>
            <ci id="S5.SS2.p1.4.m4.3.3.1.1.1.1.3.cmml" xref="S5.SS2.p1.4.m4.3.3.1.1.1.1.3">
             𝑡
            </ci>
           </apply>
           <apply id="S5.SS2.p1.4.m4.4.4.2.2.2.2.cmml" xref="S5.SS2.p1.4.m4.4.4.2.2.2.2">
            <csymbol cd="ambiguous" id="S5.SS2.p1.4.m4.4.4.2.2.2.2.1.cmml" xref="S5.SS2.p1.4.m4.4.4.2.2.2.2">
             subscript
            </csymbol>
            <ci id="S5.SS2.p1.4.m4.4.4.2.2.2.2.2.cmml" xref="S5.SS2.p1.4.m4.4.4.2.2.2.2.2">
             𝑎
            </ci>
            <ci id="S5.SS2.p1.4.m4.4.4.2.2.2.2.3.cmml" xref="S5.SS2.p1.4.m4.4.4.2.2.2.2.3">
             𝑡
            </ci>
           </apply>
          </interval>
         </apply>
         <apply id="S5.SS2.p1.4.m4.4.4.4.cmml" xref="S5.SS2.p1.4.m4.4.4.4">
          <times id="S5.SS2.p1.4.m4.4.4.4.1.cmml" xref="S5.SS2.p1.4.m4.4.4.4.1">
          </times>
          <ci id="S5.SS2.p1.4.m4.4.4.4.2.cmml" xref="S5.SS2.p1.4.m4.4.4.4.2">
           𝛽
          </ci>
          <apply id="S5.SS2.p1.4.m4.4.4.4.3.cmml" xref="S5.SS2.p1.4.m4.4.4.4.3">
           <log id="S5.SS2.p1.4.m4.4.4.4.3.1.cmml" xref="S5.SS2.p1.4.m4.4.4.4.3.1">
           </log>
           <apply id="S5.SS2.p1.4.m4.2.2.cmml" xref="S5.SS2.p1.4.m4.2.2">
            <divide id="S5.SS2.p1.4.m4.2.2.3.cmml" xref="S5.SS2.p1.4.m4.2.2">
            </divide>
            <apply id="S5.SS2.p1.4.m4.1.1.1.cmml" xref="S5.SS2.p1.4.m4.1.1.1">
             <times id="S5.SS2.p1.4.m4.1.1.1.2.cmml" xref="S5.SS2.p1.4.m4.1.1.1.2">
             </times>
             <ci id="S5.SS2.p1.4.m4.1.1.1.3.cmml" xref="S5.SS2.p1.4.m4.1.1.1.3">
              𝜋
             </ci>
             <apply id="S5.SS2.p1.4.m4.1.1.1.1.1.1.cmml" xref="S5.SS2.p1.4.m4.1.1.1.1.1">
              <csymbol cd="latexml" id="S5.SS2.p1.4.m4.1.1.1.1.1.1.1.cmml" xref="S5.SS2.p1.4.m4.1.1.1.1.1.1.1">
               conditional
              </csymbol>
              <apply id="S5.SS2.p1.4.m4.1.1.1.1.1.1.2.cmml" xref="S5.SS2.p1.4.m4.1.1.1.1.1.1.2">
               <csymbol cd="ambiguous" id="S5.SS2.p1.4.m4.1.1.1.1.1.1.2.1.cmml" xref="S5.SS2.p1.4.m4.1.1.1.1.1.1.2">
                subscript
               </csymbol>
               <ci id="S5.SS2.p1.4.m4.1.1.1.1.1.1.2.2.cmml" xref="S5.SS2.p1.4.m4.1.1.1.1.1.1.2.2">
                𝑎
               </ci>
               <ci id="S5.SS2.p1.4.m4.1.1.1.1.1.1.2.3.cmml" xref="S5.SS2.p1.4.m4.1.1.1.1.1.1.2.3">
                𝑡
               </ci>
              </apply>
              <apply id="S5.SS2.p1.4.m4.1.1.1.1.1.1.3.cmml" xref="S5.SS2.p1.4.m4.1.1.1.1.1.1.3">
               <csymbol cd="ambiguous" id="S5.SS2.p1.4.m4.1.1.1.1.1.1.3.1.cmml" xref="S5.SS2.p1.4.m4.1.1.1.1.1.1.3">
                subscript
               </csymbol>
               <ci id="S5.SS2.p1.4.m4.1.1.1.1.1.1.3.2.cmml" xref="S5.SS2.p1.4.m4.1.1.1.1.1.1.3.2">
                𝑠
               </ci>
               <ci id="S5.SS2.p1.4.m4.1.1.1.1.1.1.3.3.cmml" xref="S5.SS2.p1.4.m4.1.1.1.1.1.1.3.3">
                𝑡
               </ci>
              </apply>
             </apply>
            </apply>
            <apply id="S5.SS2.p1.4.m4.2.2.2.cmml" xref="S5.SS2.p1.4.m4.2.2.2">
             <times id="S5.SS2.p1.4.m4.2.2.2.2.cmml" xref="S5.SS2.p1.4.m4.2.2.2.2">
             </times>
             <ci id="S5.SS2.p1.4.m4.2.2.2.3.cmml" xref="S5.SS2.p1.4.m4.2.2.2.3">
              𝜌
             </ci>
             <apply id="S5.SS2.p1.4.m4.2.2.2.1.1.1.cmml" xref="S5.SS2.p1.4.m4.2.2.2.1.1">
              <csymbol cd="latexml" id="S5.SS2.p1.4.m4.2.2.2.1.1.1.1.cmml" xref="S5.SS2.p1.4.m4.2.2.2.1.1.1.1">
               conditional
              </csymbol>
              <apply id="S5.SS2.p1.4.m4.2.2.2.1.1.1.2.cmml" xref="S5.SS2.p1.4.m4.2.2.2.1.1.1.2">
               <csymbol cd="ambiguous" id="S5.SS2.p1.4.m4.2.2.2.1.1.1.2.1.cmml" xref="S5.SS2.p1.4.m4.2.2.2.1.1.1.2">
                subscript
               </csymbol>
               <ci id="S5.SS2.p1.4.m4.2.2.2.1.1.1.2.2.cmml" xref="S5.SS2.p1.4.m4.2.2.2.1.1.1.2.2">
                𝑎
               </ci>
               <ci id="S5.SS2.p1.4.m4.2.2.2.1.1.1.2.3.cmml" xref="S5.SS2.p1.4.m4.2.2.2.1.1.1.2.3">
                𝑡
               </ci>
              </apply>
              <apply id="S5.SS2.p1.4.m4.2.2.2.1.1.1.3.cmml" xref="S5.SS2.p1.4.m4.2.2.2.1.1.1.3">
               <csymbol cd="ambiguous" id="S5.SS2.p1.4.m4.2.2.2.1.1.1.3.1.cmml" xref="S5.SS2.p1.4.m4.2.2.2.1.1.1.3">
                subscript
               </csymbol>
               <ci id="S5.SS2.p1.4.m4.2.2.2.1.1.1.3.2.cmml" xref="S5.SS2.p1.4.m4.2.2.2.1.1.1.3.2">
                𝑠
               </ci>
               <ci id="S5.SS2.p1.4.m4.2.2.2.1.1.1.3.3.cmml" xref="S5.SS2.p1.4.m4.2.2.2.1.1.1.3.3">
                𝑡
               </ci>
              </apply>
             </apply>
            </apply>
           </apply>
          </apply>
         </apply>
        </apply>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="S5.SS2.p1.4.m4.4c">
        r(s_{t},a_{t})-\beta\log\frac{\pi(a_{t}|s_{t})}{\rho(a_{t}|s_{t})}
       </annotation>
      </semantics>
     </math>
     , based on the same framework as ETPO to fine-tune CodeLlama-7B model, i.e. (
     <span class="ltx_text ltx_font_italic" id="S5.SS2.p1.4.2">
      PPO-KL
     </span>
     ). As an action-level algorithm, PPO-KL will assign the same credit to all tokens in an action.
    </p>
   </div>
   <div class="ltx_para" id="S5.SS2.p2">
    <p class="ltx_p" id="S5.SS2.p2.3">
     From Figure
     <a class="ltx_ref" href="#S5.F3" title="Figure 3 ‣ 5.2 Main Results ‣ 5 Experiments ‣ Entropy-Regularized Token-Level Policy Optimization for Large Language Models">
      <span class="ltx_text ltx_ref_tag">
       3
      </span>
     </a>
     , we observe that the performance of the Reflections hardly changes as the number of exploration steps increases from
     <math alttext="100" class="ltx_Math" display="inline" id="S5.SS2.p2.1.m1.1">
      <semantics id="S5.SS2.p2.1.m1.1a">
       <mn id="S5.SS2.p2.1.m1.1.1" xref="S5.SS2.p2.1.m1.1.1.cmml">
        100
       </mn>
       <annotation-xml encoding="MathML-Content" id="S5.SS2.p2.1.m1.1b">
        <cn id="S5.SS2.p2.1.m1.1.1.cmml" type="integer" xref="S5.SS2.p2.1.m1.1.1">
         100
        </cn>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="S5.SS2.p2.1.m1.1c">
        100
       </annotation>
      </semantics>
     </math>
     to
     <math alttext="500" class="ltx_Math" display="inline" id="S5.SS2.p2.2.m2.1">
      <semantics id="S5.SS2.p2.2.m2.1a">
       <mn id="S5.SS2.p2.2.m2.1.1" xref="S5.SS2.p2.2.m2.1.1.cmml">
        500
       </mn>
       <annotation-xml encoding="MathML-Content" id="S5.SS2.p2.2.m2.1b">
        <cn id="S5.SS2.p2.2.m2.1.1.cmml" type="integer" xref="S5.SS2.p2.2.m2.1.1">
         500
        </cn>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="S5.SS2.p2.2.m2.1c">
        500
       </annotation>
      </semantics>
     </math>
     , which means
     <math alttext="k=500" class="ltx_Math" display="inline" id="S5.SS2.p2.3.m3.1">
      <semantics id="S5.SS2.p2.3.m3.1a">
       <mrow id="S5.SS2.p2.3.m3.1.1" xref="S5.SS2.p2.3.m3.1.1.cmml">
        <mi id="S5.SS2.p2.3.m3.1.1.2" xref="S5.SS2.p2.3.m3.1.1.2.cmml">
         k
        </mi>
        <mo id="S5.SS2.p2.3.m3.1.1.1" xref="S5.SS2.p2.3.m3.1.1.1.cmml">
         =
        </mo>
        <mn id="S5.SS2.p2.3.m3.1.1.3" xref="S5.SS2.p2.3.m3.1.1.3.cmml">
         500
        </mn>
       </mrow>
       <annotation-xml encoding="MathML-Content" id="S5.SS2.p2.3.m3.1b">
        <apply id="S5.SS2.p2.3.m3.1.1.cmml" xref="S5.SS2.p2.3.m3.1.1">
         <eq id="S5.SS2.p2.3.m3.1.1.1.cmml" xref="S5.SS2.p2.3.m3.1.1.1">
         </eq>
         <ci id="S5.SS2.p2.3.m3.1.1.2.cmml" xref="S5.SS2.p2.3.m3.1.1.2">
          𝑘
         </ci>
         <cn id="S5.SS2.p2.3.m3.1.1.3.cmml" type="integer" xref="S5.SS2.p2.3.m3.1.1.3">
          500
         </cn>
        </apply>
       </annotation-xml>
       <annotation encoding="application/x-tex" id="S5.SS2.p2.3.m3.1c">
        k=500
       </annotation>
      </semantics>
     </math>
     is enough to touch the caps of the Reflection with vanilla models. Comparing the Reflection with PPO-KL, we confirm that even action-level RL training can slightly improve the model’s ability to generate better code for specific datasets. Further, ETPO outperforms both Reflection and PPO-KL in most of the experimental datasets, which verifies the effectiveness of our method.
    </p>
   </div>
  </section>
  <section class="ltx_subsection" id="S5.SS3">
   <h3 class="ltx_title ltx_title_subsection">
    <span class="ltx_tag ltx_tag_subsection">
     5.3
    </span>
    Convergence
   </h3>
   <figure class="ltx_figure" id="S5.F4">
    <p class="ltx_p ltx_align_center ltx_align_center" id="S5.F4.1.1">
     <span class="ltx_text" id="S5.F4.1.1.1">
      <img alt="Refer to caption" class="ltx_graphics ltx_img_landscape" height="328" id="S5.F4.1.1.1.g1" src="/html/2402.06700/assets/x3.png" width="438"/>
     </span>
    </p>
    <figcaption class="ltx_caption ltx_centering">
     <span class="ltx_tag ltx_tag_figure">
      Figure 4:
     </span>
     Average performance comparison during training on all Kaggle datasets that are lesser-known.
    </figcaption>
   </figure>
   <div class="ltx_para" id="S5.SS3.p1">
    <p class="ltx_p" id="S5.SS3.p1.1">
     In this section, we take four Kaggle datasets to further analyze the learning process of PPO-KL and ETPO in depth. To this end, we record the average reward of generated codes in each batch during the training process, instead of the best reward in the previous section. It is also an important indicator for evaluating the convergence performance and stability of RL algorithms
     <cite class="ltx_cite ltx_citemacro_citep">
      (Potapov &amp; Ali,
      <a class="ltx_ref" href="#bib.bib28" title="">
       2003
      </a>
      )
     </cite>
     . Figure
     <a class="ltx_ref" href="#S5.F4" title="Figure 4 ‣ 5.3 Convergence ‣ 5 Experiments ‣ Entropy-Regularized Token-Level Policy Optimization for Large Language Models">
      <span class="ltx_text ltx_ref_tag">
       4
      </span>
     </a>
     shows the average performance on 4 Kaggle datasets achieved by PPO-KL and ETPO as well as the average rewards of Reflection with GPT-4 and CodeLlama-7B after 500 interactions.
    </p>
   </div>
   <div class="ltx_para" id="S5.SS3.p2">
    <p class="ltx_p" id="S5.SS3.p2.1">
     According to Figure
     <a class="ltx_ref" href="#S5.F4" title="Figure 4 ‣ 5.3 Convergence ‣ 5 Experiments ‣ Entropy-Regularized Token-Level Policy Optimization for Large Language Models">
      <span class="ltx_text ltx_ref_tag">
       4
      </span>
     </a>
     , although the best codes explored by GPT-4 and CodeLlama-7B enjoy similar rewards for each dataset in the previous section, it does not mean that CodaLlama-7B has equal capabilities to GPT-4. The huge gap between CodeLlama-7B and GPT-4 in average rewards shown in Figure
     <a class="ltx_ref" href="#S5.F4" title="Figure 4 ‣ 5.3 Convergence ‣ 5 Experiments ‣ Entropy-Regularized Token-Level Policy Optimization for Large Language Models">
      <span class="ltx_text ltx_ref_tag">
       4
      </span>
     </a>
     implies that a significant portion of the code generated by CodeLlama-7B is non-runnable and therefore receives a -1 as a reward which brings down the average. This illustrates that vanilla CodeLlama-7B is more unstable than GPT-4 before training. Then, as training progresses, the average performance of PPO-KL and ETPO has improved significantly. Especially PPO-KL, because it allows all tokens in an action to share credit, it can backpropagate the impact of the reward signal to the front end of the token sequence earlier and thus enjoy faster performance improvements. However, the credit assignment granularity of PPO-KL is too large and not precise enough, which prevents further improvement of its performance and brings instability to the convergence process, as shown in the second half of the curve. In contrast, ETPO spreads the impact of reward signals token-by-token. Thus its performance improvement is relatively gentle in the early stage. But, benefit from its fine-grained credit assignment, its improvement process is more stable and converges to average performance exceeding PPO-KL even the Reflection with GPT-4.
    </p>
   </div>
  </section>
  <section class="ltx_subsection" id="S5.SS4">
   <h3 class="ltx_title ltx_title_subsection">
    <span class="ltx_tag ltx_tag_subsection">
     5.4
    </span>
    Behavioural emergence with RL training
   </h3>
   <div class="ltx_para" id="S5.SS4.p1">
    <p class="ltx_p" id="S5.SS4.p1.1">
     Let’s take a deeper investigation into the behavior of LLM after RL training.
In Figures
     <a class="ltx_ref" href="#A5.F9" title="Figure 9 ‣ Appendix E Generated Code Examples ‣ Entropy-Regularized Token-Level Policy Optimization for Large Language Models">
      <span class="ltx_text ltx_ref_tag">
       9
      </span>
     </a>
     and
     <a class="ltx_ref" href="#A5.F9" title="Figure 9 ‣ Appendix E Generated Code Examples ‣ Entropy-Regularized Token-Level Policy Optimization for Large Language Models">
      <span class="ltx_text ltx_ref_tag">
       9
      </span>
     </a>
     at Appendix
     <a class="ltx_ref" href="#A5" title="Appendix E Generated Code Examples ‣ Entropy-Regularized Token-Level Policy Optimization for Large Language Models">
      <span class="ltx_text ltx_ref_tag">
       E
      </span>
     </a>
     , we demonstrate the difference of generated codes between the vanilla CodeLlama-7B and the CodeLlama-7B fine-tuned with ETPO. The code generated by the trained model in Figure
     <a class="ltx_ref" href="#A5.F9" title="Figure 9 ‣ Appendix E Generated Code Examples ‣ Entropy-Regularized Token-Level Policy Optimization for Large Language Models">
      <span class="ltx_text ltx_ref_tag">
       9
      </span>
     </a>
     indicates the effectiveness of entropy-regularized RL in preventing the policy from moving too far and losing the coherence and readability of generated text.
    </p>
   </div>
   <div class="ltx_para" id="S5.SS4.p2">
    <p class="ltx_p" id="S5.SS4.p2.1">
     In addition to the difference in code complexity, another significant difference between Figures
     <a class="ltx_ref" href="#A5.F9" title="Figure 9 ‣ Appendix E Generated Code Examples ‣ Entropy-Regularized Token-Level Policy Optimization for Large Language Models">
      <span class="ltx_text ltx_ref_tag">
       9
      </span>
     </a>
     and
     <a class="ltx_ref" href="#A5.F9" title="Figure 9 ‣ Appendix E Generated Code Examples ‣ Entropy-Regularized Token-Level Policy Optimization for Large Language Models">
      <span class="ltx_text ltx_ref_tag">
       9
      </span>
     </a>
     is that the code generated by the vanilla model is more in line with the prompt requirements, i.e. returning a Scikit
     <span class="ltx_text ltx_font_bold" id="S5.SS4.p2.1.1">
      model
     </span>
     , while the code generated by RL trained model deviates from prompt to a certain extent, i.e. it builds a
     <span class="ltx_text ltx_font_bold" id="S5.SS4.p2.1.2">
      pipeline
     </span>
     with data processing operation. This situation is similar to the hallucination
     <cite class="ltx_cite ltx_citemacro_citep">
      (Ji et al.,
      <a class="ltx_ref" href="#bib.bib14" title="">
       2023
      </a>
      )
     </cite>
     issue in the text-generation tasks that needed to be avoided. However, this deviant code in fact achieves higher rewards for the corresponding dataset. From an RL perspective, this situation is easy to understand. Since RL algorithms encourage agents to further explore directions with higher rewards, even unexpected behaviors with high rewards will be continuously enhanced and improved in the subsequent training process. Finally, models are promoted to generate the complex and ”noncompliant” code in Figure
     <a class="ltx_ref" href="#A5.F9" title="Figure 9 ‣ Appendix E Generated Code Examples ‣ Entropy-Regularized Token-Level Policy Optimization for Large Language Models">
      <span class="ltx_text ltx_ref_tag">
       9
      </span>
     </a>
     , which achieves better performance than code generated by repeated exploration without RL training. Figure
     <a class="ltx_ref" href="#S1.F1" title="Figure 1 ‣ 1 Introduction ‣ Entropy-Regularized Token-Level Policy Optimization for Large Language Models">
      <span class="ltx_text ltx_ref_tag">
       1
      </span>
     </a>
     gives a more detailed demonstration of how this process occurs.
    </p>
   </div>
   <div class="ltx_para" id="S5.SS4.p3">
    <p class="ltx_p" id="S5.SS4.p3.1">
     Further, this phenomenon inspires us an insight that we can filter the hallucination of LLMs with the exploration-exploitation manner
     <cite class="ltx_cite ltx_citemacro_citep">
      (Sutton &amp; Barto,
      <a class="ltx_ref" href="#bib.bib39" title="">
       2018
      </a>
      )
     </cite>
     of RL to boost the emergence of new behaviors or capabilities. Limited by token length, it isn’t easy to encode all task-related information into prompts. The hallucination could be treated as supplemental explorations in an exploration-exploitation manner. we can filter out those that are beneficial to the specific task and reinforce them to promote new behaviors, instead of deliberately preventing it. On the other way, even those hallucinations that are useless for the current task may still be able to contribute to other tasks with techniques like hindsight relabelling
     <cite class="ltx_cite ltx_citemacro_citep">
      (Li et al.,
      <a class="ltx_ref" href="#bib.bib21" title="">
       2020
      </a>
      )
     </cite>
     to boost the emergence of new capabilities. In other words, for LLM agents with RL, hallucination is the source of creativity and innovation that drives agents’ performance improvement. By embracing the inherent uncertainty and variability in the outputs of LLMs, we can harness their potential with serendipitous discoveries.
    </p>
   </div>
  </section>
  <section class="ltx_subsection" id="S5.SS5">
   <h3 class="ltx_title ltx_title_subsection">
    <span class="ltx_tag ltx_tag_subsection">
     5.5
    </span>
    Affect on Perplexity
   </h3>
   <div class="ltx_para" id="S5.SS5.p1">
    <p class="ltx_p" id="S5.SS5.p1.1">
     We choose benchmarks Github, Wikitext, and arXiv introduced by memorizing transformers
     <cite class="ltx_cite ltx_citemacro_citep">
      (Wu et al.,
      <a class="ltx_ref" href="#bib.bib46" title="">
       2022
      </a>
      )
     </cite>
     to observe the perplexity changes compared to the original model after training by ETPO.
    </p>
   </div>
   <figure class="ltx_table" id="S5.T3">
    <table class="ltx_tabular ltx_centering ltx_guessed_headers ltx_align_middle" id="S5.T3.1">
     <tbody class="ltx_tbody">
      <tr class="ltx_tr" id="S5.T3.1.1.1">
       <td class="ltx_td ltx_border_tt" id="S5.T3.1.1.1.1">
       </td>
       <th class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_border_tt" id="S5.T3.1.1.1.2">
        <span class="ltx_text ltx_font_bold" id="S5.T3.1.1.1.2.1" style="font-size:90%;">
         Github
        </span>
       </th>
       <th class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_border_tt" id="S5.T3.1.1.1.3">
        <span class="ltx_text ltx_font_bold" id="S5.T3.1.1.1.3.1" style="font-size:90%;">
         Wikitext
        </span>
       </th>
       <th class="ltx_td ltx_nopad_r ltx_align_left ltx_th ltx_th_column ltx_border_tt" id="S5.T3.1.1.1.4">
        <span class="ltx_text ltx_font_bold" id="S5.T3.1.1.1.4.1" style="font-size:90%;">
         arXiv
        </span>
       </th>
      </tr>
      <tr class="ltx_tr" id="S5.T3.1.2.2">
       <td class="ltx_td ltx_align_left ltx_border_t" id="S5.T3.1.2.2.1">
        <span class="ltx_text ltx_font_bold" id="S5.T3.1.2.2.1.1" style="font-size:90%;">
         CodeLlama-7B
        </span>
       </td>
       <td class="ltx_td ltx_align_left ltx_border_t" id="S5.T3.1.2.2.2">
        <span class="ltx_text" id="S5.T3.1.2.2.2.1" style="font-size:90%;">
         2.0633
        </span>
       </td>
       <td class="ltx_td ltx_align_left ltx_border_t" id="S5.T3.1.2.2.3">
        <span class="ltx_text" id="S5.T3.1.2.2.3.1" style="font-size:90%;">
         5.9850
        </span>
       </td>
       <td class="ltx_td ltx_nopad_r ltx_align_left ltx_border_t" id="S5.T3.1.2.2.4">
        <span class="ltx_text" id="S5.T3.1.2.2.4.1" style="font-size:90%;">
         3.5768
        </span>
       </td>
      </tr>
      <tr class="ltx_tr" id="S5.T3.1.3.3">
       <td class="ltx_td ltx_align_left ltx_border_bb" id="S5.T3.1.3.3.1">
        <span class="ltx_text ltx_font_bold" id="S5.T3.1.3.3.1.1" style="font-size:90%;">
         ETPO (Ours)
        </span>
       </td>
       <td class="ltx_td ltx_align_left ltx_border_bb" id="S5.T3.1.3.3.2">
        <span class="ltx_text" id="S5.T3.1.3.3.2.1" style="font-size:90%;">
         2.0648
        </span>
       </td>
       <td class="ltx_td ltx_align_left ltx_border_bb" id="S5.T3.1.3.3.3">
        <span class="ltx_text" id="S5.T3.1.3.3.3.1" style="font-size:90%;">
         5.9874
        </span>
       </td>
       <td class="ltx_td ltx_nopad_r ltx_align_left ltx_border_bb" id="S5.T3.1.3.3.4">
        <span class="ltx_text" id="S5.T3.1.3.3.4.1" style="font-size:90%;">
         3.5787
        </span>
       </td>
      </tr>
     </tbody>
    </table>
    <figcaption class="ltx_caption ltx_centering" style="font-size:90%;">
     <span class="ltx_tag ltx_tag_table">
      Table 3:
     </span>
     Perplexity changes comparison.
    </figcaption>
   </figure>
   <div class="ltx_para" id="S5.SS5.p2">
    <p class="ltx_p" id="S5.SS5.p2.1">
     According to the experimental results (as shown in
     <a class="ltx_ref ltx_refmacro_autoref" href="#S5.T3" title="Table 3 ‣ 5.5 Affect on Perplexity ‣ 5 Experiments ‣ Entropy-Regularized Token-Level Policy Optimization for Large Language Models">
      <span class="ltx_text ltx_ref_tag">
       Table 3
      </span>
     </a>
     ), the minor changes observed after training the CodeLlama-7B model using the ETPO method indicate that this method has a relatively small impact on the original language modeling. This slight variation suggests that although the ETPO method may introduce new optimization or training strategies, it does not fundamentally alter or disrupt the basic logic of language modeling. This is a positive outcome, as it means that while trying to improve model performance or introduce new training methods, the model’s fundamental capabilities and stability are maintained.
    </p>
   </div>
   <div class="ltx_para" id="S5.SS5.p3">
    <p class="ltx_p" id="S5.SS5.p3.1">
     In the process of training and optimizing language models, maintaining the model’s understanding of language structure is crucial. Minor performance improvements or changes indicate that your method may be effective in subtly adjusting the model to suit specific tasks or datasets without sacrificing the model’s generality and foundational language abilities. This balance is very important, especially in the development of models that can be broadly applied across different linguistic tasks and domains.
    </p>
   </div>
  </section>
 </section>
 <section class="ltx_section" id="S6">
  <h2 class="ltx_title ltx_title_section">
   <span class="ltx_tag ltx_tag_section">
    6
   </span>
   Conclusion
  </h2>
  <div class="ltx_para" id="S6.p1">
   <p class="ltx_p" id="S6.p1.1">
    In this work, we present the ETPO, a token-level optimization approach that leverages entropy-regularized reinforcement learning to train LLM agents for verbal sequential decision-making tasks. ETPO decomposes the optimization in action space to token space and theoretically proves their consistency. Our experiments also confirm the effectiveness of ETPO from different dimensions. Moreover, we acknowledge the existing limitations of ETPO, i.e. the requirement for a quantitative reward function, which is not easily attainable in some textual environment. To mitigate this issue, we envisage integrating ETPO with self-rewarding
    <cite class="ltx_cite ltx_citemacro_citep">
     (Yuan et al.,
     <a class="ltx_ref" href="#bib.bib48" title="">
      2024
     </a>
     )
    </cite>
    or hindsight relabeling
    <cite class="ltx_cite ltx_citemacro_citep">
     (Li et al.,
     <a class="ltx_ref" href="#bib.bib21" title="">
      2020
     </a>
     )
    </cite>
    techniques and leave detailed exploration for future research endeavors.
   </p>
  </div>
  <div class="ltx_pagination ltx_role_newpage">
  </div>
 </section>
 <section class="ltx_section" id="Sx1">
  <h2 class="ltx_title ltx_title_section">
   Impact Statements
  </h2>
  <div class="ltx_para" id="Sx1.p1">
   <p class="ltx_p" id="Sx1.p1.1">
    This paper presents work whose goal is to advance the field of Machine Learning. There are many potential societal consequences of our work, none of which we feel must be specifically highlighted here.
   </p>
  </div>
 </section>
 <section class="ltx_bibliography" id="bib">
  <h2 class="ltx_title ltx_title_bibliography">
   References
  </h2>
  <ul class="ltx_biblist">
   <li class="ltx_bibitem" id="bib.bib1">
    <span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">
     Bouthillier et al. (2021)
    </span>
    <span class="ltx_bibblock">
     Bouthillier, X., Delaunay, P., Bronzi, M., Trofimov, A., Nichyporuk, B., Szeto, J., Mohammadi Sepahvand, N., Raff, E., Madan, K., Voleti, V., et al.
    </span>
    <span class="ltx_bibblock">
     Accounting for variance in machine learning benchmarks.
    </span>
    <span class="ltx_bibblock">
     <em class="ltx_emph ltx_font_italic" id="bib.bib1.1.1">
      Proceedings of Machine Learning and Systems
     </em>
     , 3:747–769, 2021.
    </span>
   </li>
   <li class="ltx_bibitem" id="bib.bib2">
    <span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">
     Carta et al. (2023)
    </span>
    <span class="ltx_bibblock">
     Carta, T., Romac, C., Wolf, T., Lamprier, S., Sigaud, O., and Oudeyer, P.-Y.
    </span>
    <span class="ltx_bibblock">
     Grounding large language models in interactive environments with online reinforcement learning.
    </span>
    <span class="ltx_bibblock">
     <em class="ltx_emph ltx_font_italic" id="bib.bib2.1.1">
      arXiv preprint arXiv:2302.02662
     </em>
     , 2023.
    </span>
   </li>
   <li class="ltx_bibitem" id="bib.bib3">
    <span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">
     Chebotar et al. (2023)
    </span>
    <span class="ltx_bibblock">
     Chebotar, Y., Vuong, Q., Hausman, K., Xia, F., Lu, Y., Irpan, A., Kumar, A., Yu, T., Herzog, A., Pertsch, K., et al.
    </span>
    <span class="ltx_bibblock">
     Q-transformer: Scalable offline reinforcement learning via autoregressive q-functions.
    </span>
    <span class="ltx_bibblock">
     In
     <em class="ltx_emph ltx_font_italic" id="bib.bib3.1.1">
      Conference on Robot Learning
     </em>
     , pp.  3909–3928. PMLR, 2023.
    </span>
   </li>
   <li class="ltx_bibitem" id="bib.bib4">
    <span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">
     Chen et al. (2024)
    </span>
    <span class="ltx_bibblock">
     Chen, Z., Zhou, K., Zhao, W. X., Wan, J., Zhang, F., Zhang, D., and Wen, J.-R.
    </span>
    <span class="ltx_bibblock">
     Improving large language models via fine-grained reinforcement learning with minimum editing constraint.
    </span>
    <span class="ltx_bibblock">
     <em class="ltx_emph ltx_font_italic" id="bib.bib4.1.1">
      arXiv preprint arXiv:2401.06081
     </em>
     , 2024.
    </span>
   </li>
   <li class="ltx_bibitem" id="bib.bib5">
    <span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">
     Deng et al. (2023)
    </span>
    <span class="ltx_bibblock">
     Deng, C., Zhang, T., He, Z., Chen, Q., Shi, Y., Zhou, L., Fu, L., Zhang, W., Wang, X., Zhou, C., Lin, Z., and He, J.
    </span>
    <span class="ltx_bibblock">
     K2: A foundation language model for geoscience knowledge understanding and utilization.
    </span>
    <span class="ltx_bibblock">
     2023.
    </span>
    <span class="ltx_bibblock">
     URL
     <a class="ltx_ref ltx_url ltx_font_typewriter" href="https://api.semanticscholar.org/CorpusID:259108887" target="_blank" title="">
      https://api.semanticscholar.org/CorpusID:259108887
     </a>
     .
    </span>
   </li>
   <li class="ltx_bibitem" id="bib.bib6">
    <span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">
     Feng et al. (2023)
    </span>
    <span class="ltx_bibblock">
     Feng, X., Wan, Z., Wen, M., Wen, Y., Zhang, W., and Wang, J.
    </span>
    <span class="ltx_bibblock">
     Alphazero-like tree-search can guide large language model decoding and training.
    </span>
    <span class="ltx_bibblock">
     <em class="ltx_emph ltx_font_italic" id="bib.bib6.1.1">
      arXiv preprint arXiv:2309.17179
     </em>
     , 2023.
    </span>
   </li>
   <li class="ltx_bibitem" id="bib.bib7">
    <span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">
     Fox et al. (2015)
    </span>
    <span class="ltx_bibblock">
     Fox, R., Pakman, A., and Tishby, N.
    </span>
    <span class="ltx_bibblock">
     Taming the noise in reinforcement learning via soft updates.
    </span>
    <span class="ltx_bibblock">
     <em class="ltx_emph ltx_font_italic" id="bib.bib7.1.1">
      arXiv preprint arXiv:1512.08562
     </em>
     , 2015.
    </span>
   </li>
   <li class="ltx_bibitem" id="bib.bib8">
    <span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">
     Haarnoja et al. (2017)
    </span>
    <span class="ltx_bibblock">
     Haarnoja, T., Tang, H., Abbeel, P., and Levine, S.
    </span>
    <span class="ltx_bibblock">
     Reinforcement learning with deep energy-based policies.
    </span>
    <span class="ltx_bibblock">
     In
     <em class="ltx_emph ltx_font_italic" id="bib.bib8.1.1">
      International conference on machine learning
     </em>
     , pp.  1352–1361. PMLR, 2017.
    </span>
   </li>
   <li class="ltx_bibitem" id="bib.bib9">
    <span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">
     Haarnoja et al. (2018a)
    </span>
    <span class="ltx_bibblock">
     Haarnoja, T., Zhou, A., Abbeel, P., and Levine, S.
    </span>
    <span class="ltx_bibblock">
     Soft actor-critic: Off-policy maximum entropy deep reinforcement learning with a stochastic actor.
    </span>
    <span class="ltx_bibblock">
     In
     <em class="ltx_emph ltx_font_italic" id="bib.bib9.1.1">
      International conference on machine learning
     </em>
     , pp.  1861–1870. PMLR, 2018a.
    </span>
   </li>
   <li class="ltx_bibitem" id="bib.bib10">
    <span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">
     Haarnoja et al. (2018b)
    </span>
    <span class="ltx_bibblock">
     Haarnoja, T., Zhou, A., Hartikainen, K., Tucker, G., Ha, S., Tan, J., Kumar, V., Zhu, H., Gupta, A., Abbeel, P., et al.
    </span>
    <span class="ltx_bibblock">
     Soft actor-critic algorithms and applications.
    </span>
    <span class="ltx_bibblock">
     <em class="ltx_emph ltx_font_italic" id="bib.bib10.1.1">
      arXiv preprint arXiv:1812.05905
     </em>
     , 2018b.
    </span>
   </li>
   <li class="ltx_bibitem" id="bib.bib11">
    <span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">
     Hao et al. (2023)
    </span>
    <span class="ltx_bibblock">
     Hao, S., Gu, Y., Ma, H., Hong, J. J., Wang, Z., Wang, D. Z., and Hu, Z.
    </span>
    <span class="ltx_bibblock">
     Reasoning with language model is planning with world model.
    </span>
    <span class="ltx_bibblock">
     <em class="ltx_emph ltx_font_italic" id="bib.bib11.1.1">
      arXiv preprint arXiv:2305.14992
     </em>
     , 2023.
    </span>
   </li>
   <li class="ltx_bibitem" id="bib.bib12">
    <span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">
     Hollmann et al. (2023)
    </span>
    <span class="ltx_bibblock">
     Hollmann, N., Müller, S., and Hutter, F.
    </span>
    <span class="ltx_bibblock">
     Large language models for automated data science: Introducing caafe for context-aware automated feature engineering.
    </span>
    <span class="ltx_bibblock">
     In
     <em class="ltx_emph ltx_font_italic" id="bib.bib12.1.1">
      Thirty-seventh Conference on Neural Information Processing Systems
     </em>
     , 2023.
    </span>
   </li>
   <li class="ltx_bibitem" id="bib.bib13">
    <span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">
     Hutter et al. (2019)
    </span>
    <span class="ltx_bibblock">
     Hutter, F., Kotthoff, L., and Vanschoren, J.
    </span>
    <span class="ltx_bibblock">
     <em class="ltx_emph ltx_font_italic" id="bib.bib13.1.1">
      Automated machine learning: methods, systems, challenges
     </em>
     .
    </span>
    <span class="ltx_bibblock">
     Springer Nature, 2019.
    </span>
   </li>
   <li class="ltx_bibitem" id="bib.bib14">
    <span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">
     Ji et al. (2023)
    </span>
    <span class="ltx_bibblock">
     Ji, Z., Lee, N., Frieske, R., Yu, T., Su, D., Xu, Y., Ishii, E., Bang, Y. J., Madotto, A., and Fung, P.
    </span>
    <span class="ltx_bibblock">
     Survey of hallucination in natural language generation.
    </span>
    <span class="ltx_bibblock">
     <em class="ltx_emph ltx_font_italic" id="bib.bib14.1.1">
      ACM Computing Surveys
     </em>
     , 55(12):1–38, 2023.
    </span>
   </li>
   <li class="ltx_bibitem" id="bib.bib15">
    <span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">
     Kappen (2011)
    </span>
    <span class="ltx_bibblock">
     Kappen, H. J.
    </span>
    <span class="ltx_bibblock">
     Optimal control theory and the linear bellman equation.
    </span>
    <span class="ltx_bibblock">
     <em class="ltx_emph ltx_font_italic" id="bib.bib15.1.1">
      Cambridge: Cambridge University Press
     </em>
     , 2011.
    </span>
   </li>
   <li class="ltx_bibitem" id="bib.bib16">
    <span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">
     Kappen et al. (2012)
    </span>
    <span class="ltx_bibblock">
     Kappen, H. J., Gómez, V., and Opper, M.
    </span>
    <span class="ltx_bibblock">
     Optimal control as a graphical model inference problem.
    </span>
    <span class="ltx_bibblock">
     <em class="ltx_emph ltx_font_italic" id="bib.bib16.1.1">
      Machine learning
     </em>
     , 87:159–182, 2012.
    </span>
   </li>
   <li class="ltx_bibitem" id="bib.bib17">
    <span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">
     Koller &amp; Friedman (2009)
    </span>
    <span class="ltx_bibblock">
     Koller, D. and Friedman, N.
    </span>
    <span class="ltx_bibblock">
     <em class="ltx_emph ltx_font_italic" id="bib.bib17.1.1">
      Probabilistic graphical models: principles and techniques
     </em>
     .
    </span>
    <span class="ltx_bibblock">
     MIT press, 2009.
    </span>
   </li>
   <li class="ltx_bibitem" id="bib.bib18">
    <span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">
     Konda &amp; Tsitsiklis (1999)
    </span>
    <span class="ltx_bibblock">
     Konda, V. and Tsitsiklis, J.
    </span>
    <span class="ltx_bibblock">
     Actor-critic algorithms.
    </span>
    <span class="ltx_bibblock">
     <em class="ltx_emph ltx_font_italic" id="bib.bib18.1.1">
      Advances in neural information processing systems
     </em>
     , 12, 1999.
    </span>
   </li>
   <li class="ltx_bibitem" id="bib.bib19">
    <span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">
     Le et al. (2022)
    </span>
    <span class="ltx_bibblock">
     Le, H., Wang, Y., Gotmare, A. D., Savarese, S., and Hoi, S. C. H.
    </span>
    <span class="ltx_bibblock">
     Coderl: Mastering code generation through pretrained models and deep reinforcement learning.
    </span>
    <span class="ltx_bibblock">
     <em class="ltx_emph ltx_font_italic" id="bib.bib19.1.1">
      Advances in Neural Information Processing Systems
     </em>
     , 35:21314–21328, 2022.
    </span>
   </li>
   <li class="ltx_bibitem" id="bib.bib20">
    <span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">
     Levine (2018)
    </span>
    <span class="ltx_bibblock">
     Levine, S.
    </span>
    <span class="ltx_bibblock">
     Reinforcement learning and control as probabilistic inference: Tutorial and review.
    </span>
    <span class="ltx_bibblock">
     <em class="ltx_emph ltx_font_italic" id="bib.bib20.1.1">
      arXiv preprint arXiv:1805.00909
     </em>
     , 2018.
    </span>
   </li>
   <li class="ltx_bibitem" id="bib.bib21">
    <span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">
     Li et al. (2020)
    </span>
    <span class="ltx_bibblock">
     Li, A., Pinto, L., and Abbeel, P.
    </span>
    <span class="ltx_bibblock">
     Generalized hindsight for reinforcement learning.
    </span>
    <span class="ltx_bibblock">
     <em class="ltx_emph ltx_font_italic" id="bib.bib21.1.1">
      Advances in neural information processing systems
     </em>
     , 33:7754–7767, 2020.
    </span>
   </li>
   <li class="ltx_bibitem" id="bib.bib22">
    <span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">
     Lin et al. (2023)
    </span>
    <span class="ltx_bibblock">
     Lin, Z., Deng, C., Zhou, L., Zhang, T., Xu, Y., Xu, Y., He, Z., Shi, Y., Dai, B., Song, Y., Zeng, B., Chen, Q., Shi, T., Huang, T., Xu, Y., Wang, S., Fu, L., Zhang, W., He, J., Ma, C., Zhu, Y., Wang, X., and Zhou, C.
    </span>
    <span class="ltx_bibblock">
     Geogalactica: A scientific large language model in geoscience.
    </span>
    <span class="ltx_bibblock">
     <em class="ltx_emph ltx_font_italic" id="bib.bib22.1.1">
      ArXiv
     </em>
     , abs/2401.00434, 2023.
    </span>
    <span class="ltx_bibblock">
     URL
     <a class="ltx_ref ltx_url ltx_font_typewriter" href="https://api.semanticscholar.org/CorpusID:266693296" target="_blank" title="">
      https://api.semanticscholar.org/CorpusID:266693296
     </a>
     .
    </span>
   </li>
   <li class="ltx_bibitem" id="bib.bib23">
    <span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">
     Madaan et al. (2023)
    </span>
    <span class="ltx_bibblock">
     Madaan, A., Tandon, N., Gupta, P., Hallinan, S., Gao, L., Wiegreffe, S., Alon, U., Dziri, N., Prabhumoye, S., Yang, Y., et al.
    </span>
    <span class="ltx_bibblock">
     Self-refine: Iterative refinement with self-feedback.
    </span>
    <span class="ltx_bibblock">
     <em class="ltx_emph ltx_font_italic" id="bib.bib23.1.1">
      arXiv preprint arXiv:2303.17651
     </em>
     , 2023.
    </span>
   </li>
   <li class="ltx_bibitem" id="bib.bib24">
    <span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">
     Nachum et al. (2017)
    </span>
    <span class="ltx_bibblock">
     Nachum, O., Norouzi, M., Xu, K., and Schuurmans, D.
    </span>
    <span class="ltx_bibblock">
     Bridging the gap between value and policy based reinforcement learning.
    </span>
    <span class="ltx_bibblock">
     <em class="ltx_emph ltx_font_italic" id="bib.bib24.1.1">
      Advances in neural information processing systems
     </em>
     , 30, 2017.
    </span>
   </li>
   <li class="ltx_bibitem" id="bib.bib25">
    <span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">
     Narkhede (2018)
    </span>
    <span class="ltx_bibblock">
     Narkhede, S.
    </span>
    <span class="ltx_bibblock">
     Understanding auc-roc curve.
    </span>
    <span class="ltx_bibblock">
     <em class="ltx_emph ltx_font_italic" id="bib.bib25.1.1">
      Towards data science
     </em>
     , 26(1):220–227, 2018.
    </span>
   </li>
   <li class="ltx_bibitem" id="bib.bib26">
    <span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">
     Ouyang et al. (2022)
    </span>
    <span class="ltx_bibblock">
     Ouyang, L., Wu, J., Jiang, X., Almeida, D., Wainwright, C., Mishkin, P., Zhang, C., Agarwal, S., Slama, K., Ray, A., et al.
    </span>
    <span class="ltx_bibblock">
     Training language models to follow instructions with human feedback.
    </span>
    <span class="ltx_bibblock">
     <em class="ltx_emph ltx_font_italic" id="bib.bib26.1.1">
      Advances in Neural Information Processing Systems
     </em>
     , 35:27730–27744, 2022.
    </span>
   </li>
   <li class="ltx_bibitem" id="bib.bib27">
    <span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">
     Pedregosa et al. (2011)
    </span>
    <span class="ltx_bibblock">
     Pedregosa, F., Varoquaux, G., Gramfort, A., Michel, V., Thirion, B., Grisel, O., Blondel, M., Prettenhofer, P., Weiss, R., Dubourg, V., et al.
    </span>
    <span class="ltx_bibblock">
     Scikit-learn: Machine learning in python.
    </span>
    <span class="ltx_bibblock">
     <em class="ltx_emph ltx_font_italic" id="bib.bib27.1.1">
      the Journal of machine Learning research
     </em>
     , 12:2825–2830, 2011.
    </span>
   </li>
   <li class="ltx_bibitem" id="bib.bib28">
    <span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">
     Potapov &amp; Ali (2003)
    </span>
    <span class="ltx_bibblock">
     Potapov, A. and Ali, M.
    </span>
    <span class="ltx_bibblock">
     Convergence of reinforcement learning algorithms and acceleration of learning.
    </span>
    <span class="ltx_bibblock">
     <em class="ltx_emph ltx_font_italic" id="bib.bib28.1.1">
      Physical Review E
     </em>
     , 67(2):026706, 2003.
    </span>
   </li>
   <li class="ltx_bibitem" id="bib.bib29">
    <span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">
     Pryzant et al. (2023)
    </span>
    <span class="ltx_bibblock">
     Pryzant, R., Iter, D., Li, J., Lee, Y. T., Zhu, C., and Zeng, M.
    </span>
    <span class="ltx_bibblock">
     Automatic prompt optimization with” gradient descent” and beam search.
    </span>
    <span class="ltx_bibblock">
     <em class="ltx_emph ltx_font_italic" id="bib.bib29.1.1">
      arXiv preprint arXiv:2305.03495
     </em>
     , 2023.
    </span>
   </li>
   <li class="ltx_bibitem" id="bib.bib30">
    <span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">
     Qian et al. (2023)
    </span>
    <span class="ltx_bibblock">
     Qian, C., Cong, X., Yang, C., Chen, W., Su, Y., Xu, J., Liu, Z., and Sun, M.
    </span>
    <span class="ltx_bibblock">
     Communicative agents for software development.
    </span>
    <span class="ltx_bibblock">
     <em class="ltx_emph ltx_font_italic" id="bib.bib30.1.1">
      arXiv preprint arXiv:2307.07924
     </em>
     , 2023.
    </span>
   </li>
   <li class="ltx_bibitem" id="bib.bib31">
    <span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">
     Radford et al. (2018)
    </span>
    <span class="ltx_bibblock">
     Radford, A., Narasimhan, K., Salimans, T., Sutskever, I., et al.
    </span>
    <span class="ltx_bibblock">
     Improving language understanding by generative pre-training.
    </span>
    <span class="ltx_bibblock">
     2018.
    </span>
   </li>
   <li class="ltx_bibitem" id="bib.bib32">
    <span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">
     Ramamurthy et al. (2022)
    </span>
    <span class="ltx_bibblock">
     Ramamurthy, R., Ammanabrolu, P., Brantley, K., Hessel, J., Sifa, R., Bauckhage, C., Hajishirzi, H., and Choi, Y.
    </span>
    <span class="ltx_bibblock">
     Is reinforcement learning (not) for natural language processing?: Benchmarks, baselines, and building blocks for natural language policy optimization.
    </span>
    <span class="ltx_bibblock">
     <em class="ltx_emph ltx_font_italic" id="bib.bib32.1.1">
      arXiv preprint arXiv:2210.01241
     </em>
     , 2022.
    </span>
   </li>
   <li class="ltx_bibitem" id="bib.bib33">
    <span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">
     Romera-Paredes et al. (2023)
    </span>
    <span class="ltx_bibblock">
     Romera-Paredes, B., Barekatain, M., Novikov, A., Balog, M., Kumar, M. P., Dupont, E., Ruiz, F. J., Ellenberg, J. S., Wang, P., Fawzi, O., et al.
    </span>
    <span class="ltx_bibblock">
     Mathematical discoveries from program search with large language models.
    </span>
    <span class="ltx_bibblock">
     <em class="ltx_emph ltx_font_italic" id="bib.bib33.1.1">
      Nature
     </em>
     , pp.  1–3, 2023.
    </span>
   </li>
   <li class="ltx_bibitem" id="bib.bib34">
    <span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">
     Schick et al. (2023)
    </span>
    <span class="ltx_bibblock">
     Schick, T., Dwivedi-Yu, J., Dessì, R., Raileanu, R., Lomeli, M., Zettlemoyer, L., Cancedda, N., and Scialom, T.
    </span>
    <span class="ltx_bibblock">
     Toolformer: Language models can teach themselves to use tools.
    </span>
    <span class="ltx_bibblock">
     <em class="ltx_emph ltx_font_italic" id="bib.bib34.1.1">
      arXiv preprint arXiv:2302.04761
     </em>
     , 2023.
    </span>
   </li>
   <li class="ltx_bibitem" id="bib.bib35">
    <span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">
     Schulman et al. (2017a)
    </span>
    <span class="ltx_bibblock">
     Schulman, J., Chen, X., and Abbeel, P.
    </span>
    <span class="ltx_bibblock">
     Equivalence between policy gradients and soft q-learning.
    </span>
    <span class="ltx_bibblock">
     <em class="ltx_emph ltx_font_italic" id="bib.bib35.1.1">
      arXiv preprint arXiv:1704.06440
     </em>
     , 2017a.
    </span>
   </li>
   <li class="ltx_bibitem" id="bib.bib36">
    <span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">
     Schulman et al. (2017b)
    </span>
    <span class="ltx_bibblock">
     Schulman, J., Wolski, F., Dhariwal, P., Radford, A., and Klimov, O.
    </span>
    <span class="ltx_bibblock">
     Proximal policy optimization algorithms.
    </span>
    <span class="ltx_bibblock">
     <em class="ltx_emph ltx_font_italic" id="bib.bib36.1.1">
      arXiv preprint arXiv:1707.06347
     </em>
     , 2017b.
    </span>
   </li>
   <li class="ltx_bibitem" id="bib.bib37">
    <span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">
     Shinn et al. (2023)
    </span>
    <span class="ltx_bibblock">
     Shinn, N., Labash, B., and Gopinath, A.
    </span>
    <span class="ltx_bibblock">
     Reflexion: an autonomous agent with dynamic memory and self-reflection.
    </span>
    <span class="ltx_bibblock">
     <em class="ltx_emph ltx_font_italic" id="bib.bib37.1.1">
      arXiv preprint arXiv:2303.11366
     </em>
     , 2023.
    </span>
   </li>
   <li class="ltx_bibitem" id="bib.bib38">
    <span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">
     Shridhar et al. (2020)
    </span>
    <span class="ltx_bibblock">
     Shridhar, M., Yuan, X., Côté, M.-A., Bisk, Y., Trischler, A., and Hausknecht, M.
    </span>
    <span class="ltx_bibblock">
     Alfworld: Aligning text and embodied environments for interactive learning.
    </span>
    <span class="ltx_bibblock">
     <em class="ltx_emph ltx_font_italic" id="bib.bib38.1.1">
      arXiv preprint arXiv:2010.03768
     </em>
     , 2020.
    </span>
   </li>
   <li class="ltx_bibitem" id="bib.bib39">
    <span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">
     Sutton &amp; Barto (2018)
    </span>
    <span class="ltx_bibblock">
     Sutton, R. S. and Barto, A. G.
    </span>
    <span class="ltx_bibblock">
     <em class="ltx_emph ltx_font_italic" id="bib.bib39.1.1">
      Reinforcement learning: An introduction
     </em>
     .
    </span>
    <span class="ltx_bibblock">
     MIT press, 2018.
    </span>
   </li>
   <li class="ltx_bibitem" id="bib.bib40">
    <span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">
     Todorov (2008)
    </span>
    <span class="ltx_bibblock">
     Todorov, E.
    </span>
    <span class="ltx_bibblock">
     General duality between optimal control and estimation.
    </span>
    <span class="ltx_bibblock">
     In
     <em class="ltx_emph ltx_font_italic" id="bib.bib40.1.1">
      2008 47th IEEE Conference on Decision and Control
     </em>
     , pp.  4286–4292. IEEE, 2008.
    </span>
   </li>
   <li class="ltx_bibitem" id="bib.bib41">
    <span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">
     Toussaint (2009)
    </span>
    <span class="ltx_bibblock">
     Toussaint, M.
    </span>
    <span class="ltx_bibblock">
     Robot trajectory optimization using approximate inference.
    </span>
    <span class="ltx_bibblock">
     In
     <em class="ltx_emph ltx_font_italic" id="bib.bib41.1.1">
      Proceedings of the 26th annual international conference on machine learning
     </em>
     , pp.  1049–1056, 2009.
    </span>
   </li>
   <li class="ltx_bibitem" id="bib.bib42">
    <span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">
     Touvron et al. (2023)
    </span>
    <span class="ltx_bibblock">
     Touvron, H., Martin, L., Stone, K., Albert, P., Almahairi, A., Babaei, Y., Bashlykov, N., Batra, S., Bhargava, P., Bhosale, S., et al.
    </span>
    <span class="ltx_bibblock">
     Llama 2: Open foundation and fine-tuned chat models.
    </span>
    <span class="ltx_bibblock">
     <em class="ltx_emph ltx_font_italic" id="bib.bib42.1.1">
      arXiv preprint arXiv:2307.09288
     </em>
     , 2023.
    </span>
   </li>
   <li class="ltx_bibitem" id="bib.bib43">
    <span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">
     Van Otterlo &amp; Wiering (2012)
    </span>
    <span class="ltx_bibblock">
     Van Otterlo, M. and Wiering, M.
    </span>
    <span class="ltx_bibblock">
     Reinforcement learning and markov decision processes.
    </span>
    <span class="ltx_bibblock">
     In
     <em class="ltx_emph ltx_font_italic" id="bib.bib43.1.1">
      Reinforcement learning: State-of-the-art
     </em>
     , pp.  3–42. Springer, 2012.
    </span>
   </li>
   <li class="ltx_bibitem" id="bib.bib44">
    <span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">
     Vanschoren et al. (2014)
    </span>
    <span class="ltx_bibblock">
     Vanschoren, J., Van Rijn, J. N., Bischl, B., and Torgo, L.
    </span>
    <span class="ltx_bibblock">
     Openml: networked science in machine learning.
    </span>
    <span class="ltx_bibblock">
     <em class="ltx_emph ltx_font_italic" id="bib.bib44.1.1">
      ACM SIGKDD Explorations Newsletter
     </em>
     , 15(2):49–60, 2014.
    </span>
   </li>
   <li class="ltx_bibitem" id="bib.bib45">
    <span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">
     Wen et al. (2022)
    </span>
    <span class="ltx_bibblock">
     Wen, M., Kuba, J., Lin, R., Zhang, W., Wen, Y., Wang, J., and Yang, Y.
    </span>
    <span class="ltx_bibblock">
     Multi-agent reinforcement learning is a sequence modeling problem.
    </span>
    <span class="ltx_bibblock">
     <em class="ltx_emph ltx_font_italic" id="bib.bib45.1.1">
      Advances in Neural Information Processing Systems
     </em>
     , 35:16509–16521, 2022.
    </span>
   </li>
   <li class="ltx_bibitem" id="bib.bib46">
    <span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">
     Wu et al. (2022)
    </span>
    <span class="ltx_bibblock">
     Wu, Y., Rabe, M. N., Hutchins, D. S., and Szegedy, C.
    </span>
    <span class="ltx_bibblock">
     Memorizing transformers.
    </span>
    <span class="ltx_bibblock">
     <em class="ltx_emph ltx_font_italic" id="bib.bib46.1.1">
      ArXiv
     </em>
     , abs/2203.08913, 2022.
    </span>
    <span class="ltx_bibblock">
     URL
     <a class="ltx_ref ltx_url ltx_font_typewriter" href="https://api.semanticscholar.org/CorpusID:247519194" target="_blank" title="">
      https://api.semanticscholar.org/CorpusID:247519194
     </a>
     .
    </span>
   </li>
   <li class="ltx_bibitem" id="bib.bib47">
    <span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">
     Yao et al. (2022)
    </span>
    <span class="ltx_bibblock">
     Yao, S., Zhao, J., Yu, D., Du, N., Shafran, I., Narasimhan, K., and Cao, Y.
    </span>
    <span class="ltx_bibblock">
     React: Synergizing reasoning and acting in language models.
    </span>
    <span class="ltx_bibblock">
     <em class="ltx_emph ltx_font_italic" id="bib.bib47.1.1">
      arXiv preprint arXiv:2210.03629
     </em>
     , 2022.
    </span>
   </li>
   <li class="ltx_bibitem" id="bib.bib48">
    <span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">
     Yuan et al. (2024)
    </span>
    <span class="ltx_bibblock">
     Yuan, W., Pang, R. Y., Cho, K., Sukhbaatar, S., Xu, J., and Weston, J.
    </span>
    <span class="ltx_bibblock">
     Self-rewarding language models.
    </span>
    <span class="ltx_bibblock">
     <em class="ltx_emph ltx_font_italic" id="bib.bib48.1.1">
      arXiv preprint arXiv:2401.10020
     </em>
     , 2024.
    </span>
   </li>
   <li class="ltx_bibitem" id="bib.bib49">
    <span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">
     Zhang et al. (2018)
    </span>
    <span class="ltx_bibblock">
     Zhang, C., Vinyals, O., Munos, R., and Bengio, S.
    </span>
    <span class="ltx_bibblock">
     A study on overfitting in deep reinforcement learning.
    </span>
    <span class="ltx_bibblock">
     <em class="ltx_emph ltx_font_italic" id="bib.bib49.1.1">
      arXiv preprint arXiv:1804.06893
     </em>
     , 2018.
    </span>
   </li>
   <li class="ltx_bibitem" id="bib.bib50">
    <span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">
     Ziebart (2010)
    </span>
    <span class="ltx_bibblock">
     Ziebart, B. D.
    </span>
    <span class="ltx_bibblock">
     <em class="ltx_emph ltx_font_italic" id="bib.bib50.1.1">
      Modeling purposeful adaptive behavior with the principle of maximum causal entropy
     </em>
     .
    </span>
    <span class="ltx_bibblock">
     Carnegie Mellon University, 2010.
    </span>
   </li>
   <li class="ltx_bibitem" id="bib.bib51">
    <span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">
     Ziegler et al. (2019)
    </span>
    <span class="ltx_bibblock">
     Ziegler, D. M., Stiennon, N., Wu, J., Brown, T. B., Radford, A., Amodei, D., Christiano, P., and Irving, G.
    </span>
    <span class="ltx_bibblock">
     Fine-tuning language models from human preferences.
    </span>
    <span class="ltx_bibblock">
     <em class="ltx_emph ltx_font_italic" id="bib.bib51.1.1">
      arXiv preprint arXiv:1909.08593
     </em>
     , 2019.
    </span>
   </li>
  </ul>
 </section>
 <div class="ltx_pagination ltx_role_newpage">
 </div>
 <section class="ltx_appendix" id="A1">
  <h2 class="ltx_title ltx_title_appendix">
   <span class="ltx_tag ltx_tag_appendix">
    Appendix A
   </span>
   Proof of Optimization Consistency
  </h2>
  <div class="ltx_para" id="A1.p1">
   <p class="ltx_p" id="A1.p1.5">
    We show that optimizing the entropy-argument soft Q-function with our per-token soft Bellman update is consistent with optimizing for the full action. We denote
    <math alttext="a=(w_{1},w_{2},\dots,w_{|a|})" class="ltx_Math" display="inline" id="A1.p1.1.m1.5">
     <semantics id="A1.p1.1.m1.5a">
      <mrow id="A1.p1.1.m1.5.5" xref="A1.p1.1.m1.5.5.cmml">
       <mi id="A1.p1.1.m1.5.5.5" xref="A1.p1.1.m1.5.5.5.cmml">
        a
       </mi>
       <mo id="A1.p1.1.m1.5.5.4" xref="A1.p1.1.m1.5.5.4.cmml">
        =
       </mo>
       <mrow id="A1.p1.1.m1.5.5.3.3" xref="A1.p1.1.m1.5.5.3.4.cmml">
        <mo id="A1.p1.1.m1.5.5.3.3.4" stretchy="false" xref="A1.p1.1.m1.5.5.3.4.cmml">
         (
        </mo>
        <msub id="A1.p1.1.m1.3.3.1.1.1" xref="A1.p1.1.m1.3.3.1.1.1.cmml">
         <mi id="A1.p1.1.m1.3.3.1.1.1.2" xref="A1.p1.1.m1.3.3.1.1.1.2.cmml">
          w
         </mi>
         <mn id="A1.p1.1.m1.3.3.1.1.1.3" xref="A1.p1.1.m1.3.3.1.1.1.3.cmml">
          1
         </mn>
        </msub>
        <mo id="A1.p1.1.m1.5.5.3.3.5" xref="A1.p1.1.m1.5.5.3.4.cmml">
         ,
        </mo>
        <msub id="A1.p1.1.m1.4.4.2.2.2" xref="A1.p1.1.m1.4.4.2.2.2.cmml">
         <mi id="A1.p1.1.m1.4.4.2.2.2.2" xref="A1.p1.1.m1.4.4.2.2.2.2.cmml">
          w
         </mi>
         <mn id="A1.p1.1.m1.4.4.2.2.2.3" xref="A1.p1.1.m1.4.4.2.2.2.3.cmml">
          2
         </mn>
        </msub>
        <mo id="A1.p1.1.m1.5.5.3.3.6" xref="A1.p1.1.m1.5.5.3.4.cmml">
         ,
        </mo>
        <mi id="A1.p1.1.m1.2.2" mathvariant="normal" xref="A1.p1.1.m1.2.2.cmml">
         …
        </mi>
        <mo id="A1.p1.1.m1.5.5.3.3.7" xref="A1.p1.1.m1.5.5.3.4.cmml">
         ,
        </mo>
        <msub id="A1.p1.1.m1.5.5.3.3.3" xref="A1.p1.1.m1.5.5.3.3.3.cmml">
         <mi id="A1.p1.1.m1.5.5.3.3.3.2" xref="A1.p1.1.m1.5.5.3.3.3.2.cmml">
          w
         </mi>
         <mrow id="A1.p1.1.m1.1.1.1.3" xref="A1.p1.1.m1.1.1.1.2.cmml">
          <mo id="A1.p1.1.m1.1.1.1.3.1" stretchy="false" xref="A1.p1.1.m1.1.1.1.2.1.cmml">
           |
          </mo>
          <mi id="A1.p1.1.m1.1.1.1.1" xref="A1.p1.1.m1.1.1.1.1.cmml">
           a
          </mi>
          <mo id="A1.p1.1.m1.1.1.1.3.2" stretchy="false" xref="A1.p1.1.m1.1.1.1.2.1.cmml">
           |
          </mo>
         </mrow>
        </msub>
        <mo id="A1.p1.1.m1.5.5.3.3.8" stretchy="false" xref="A1.p1.1.m1.5.5.3.4.cmml">
         )
        </mo>
       </mrow>
      </mrow>
      <annotation-xml encoding="MathML-Content" id="A1.p1.1.m1.5b">
       <apply id="A1.p1.1.m1.5.5.cmml" xref="A1.p1.1.m1.5.5">
        <eq id="A1.p1.1.m1.5.5.4.cmml" xref="A1.p1.1.m1.5.5.4">
        </eq>
        <ci id="A1.p1.1.m1.5.5.5.cmml" xref="A1.p1.1.m1.5.5.5">
         𝑎
        </ci>
        <vector id="A1.p1.1.m1.5.5.3.4.cmml" xref="A1.p1.1.m1.5.5.3.3">
         <apply id="A1.p1.1.m1.3.3.1.1.1.cmml" xref="A1.p1.1.m1.3.3.1.1.1">
          <csymbol cd="ambiguous" id="A1.p1.1.m1.3.3.1.1.1.1.cmml" xref="A1.p1.1.m1.3.3.1.1.1">
           subscript
          </csymbol>
          <ci id="A1.p1.1.m1.3.3.1.1.1.2.cmml" xref="A1.p1.1.m1.3.3.1.1.1.2">
           𝑤
          </ci>
          <cn id="A1.p1.1.m1.3.3.1.1.1.3.cmml" type="integer" xref="A1.p1.1.m1.3.3.1.1.1.3">
           1
          </cn>
         </apply>
         <apply id="A1.p1.1.m1.4.4.2.2.2.cmml" xref="A1.p1.1.m1.4.4.2.2.2">
          <csymbol cd="ambiguous" id="A1.p1.1.m1.4.4.2.2.2.1.cmml" xref="A1.p1.1.m1.4.4.2.2.2">
           subscript
          </csymbol>
          <ci id="A1.p1.1.m1.4.4.2.2.2.2.cmml" xref="A1.p1.1.m1.4.4.2.2.2.2">
           𝑤
          </ci>
          <cn id="A1.p1.1.m1.4.4.2.2.2.3.cmml" type="integer" xref="A1.p1.1.m1.4.4.2.2.2.3">
           2
          </cn>
         </apply>
         <ci id="A1.p1.1.m1.2.2.cmml" xref="A1.p1.1.m1.2.2">
          …
         </ci>
         <apply id="A1.p1.1.m1.5.5.3.3.3.cmml" xref="A1.p1.1.m1.5.5.3.3.3">
          <csymbol cd="ambiguous" id="A1.p1.1.m1.5.5.3.3.3.1.cmml" xref="A1.p1.1.m1.5.5.3.3.3">
           subscript
          </csymbol>
          <ci id="A1.p1.1.m1.5.5.3.3.3.2.cmml" xref="A1.p1.1.m1.5.5.3.3.3.2">
           𝑤
          </ci>
          <apply id="A1.p1.1.m1.1.1.1.2.cmml" xref="A1.p1.1.m1.1.1.1.3">
           <abs id="A1.p1.1.m1.1.1.1.2.1.cmml" xref="A1.p1.1.m1.1.1.1.3.1">
           </abs>
           <ci id="A1.p1.1.m1.1.1.1.1.cmml" xref="A1.p1.1.m1.1.1.1.1">
            𝑎
           </ci>
          </apply>
         </apply>
        </vector>
       </apply>
      </annotation-xml>
      <annotation encoding="application/x-tex" id="A1.p1.1.m1.5c">
       a=(w_{1},w_{2},\dots,w_{|a|})
      </annotation>
     </semantics>
    </math>
    and
    <math alttext="s^{\prime},a^{\prime}" class="ltx_Math" display="inline" id="A1.p1.2.m2.2">
     <semantics id="A1.p1.2.m2.2a">
      <mrow id="A1.p1.2.m2.2.2.2" xref="A1.p1.2.m2.2.2.3.cmml">
       <msup id="A1.p1.2.m2.1.1.1.1" xref="A1.p1.2.m2.1.1.1.1.cmml">
        <mi id="A1.p1.2.m2.1.1.1.1.2" xref="A1.p1.2.m2.1.1.1.1.2.cmml">
         s
        </mi>
        <mo id="A1.p1.2.m2.1.1.1.1.3" xref="A1.p1.2.m2.1.1.1.1.3.cmml">
         ′
        </mo>
       </msup>
       <mo id="A1.p1.2.m2.2.2.2.3" xref="A1.p1.2.m2.2.2.3.cmml">
        ,
       </mo>
       <msup id="A1.p1.2.m2.2.2.2.2" xref="A1.p1.2.m2.2.2.2.2.cmml">
        <mi id="A1.p1.2.m2.2.2.2.2.2" xref="A1.p1.2.m2.2.2.2.2.2.cmml">
         a
        </mi>
        <mo id="A1.p1.2.m2.2.2.2.2.3" xref="A1.p1.2.m2.2.2.2.2.3.cmml">
         ′
        </mo>
       </msup>
      </mrow>
      <annotation-xml encoding="MathML-Content" id="A1.p1.2.m2.2b">
       <list id="A1.p1.2.m2.2.2.3.cmml" xref="A1.p1.2.m2.2.2.2">
        <apply id="A1.p1.2.m2.1.1.1.1.cmml" xref="A1.p1.2.m2.1.1.1.1">
         <csymbol cd="ambiguous" id="A1.p1.2.m2.1.1.1.1.1.cmml" xref="A1.p1.2.m2.1.1.1.1">
          superscript
         </csymbol>
         <ci id="A1.p1.2.m2.1.1.1.1.2.cmml" xref="A1.p1.2.m2.1.1.1.1.2">
          𝑠
         </ci>
         <ci id="A1.p1.2.m2.1.1.1.1.3.cmml" xref="A1.p1.2.m2.1.1.1.1.3">
          ′
         </ci>
        </apply>
        <apply id="A1.p1.2.m2.2.2.2.2.cmml" xref="A1.p1.2.m2.2.2.2.2">
         <csymbol cd="ambiguous" id="A1.p1.2.m2.2.2.2.2.1.cmml" xref="A1.p1.2.m2.2.2.2.2">
          superscript
         </csymbol>
         <ci id="A1.p1.2.m2.2.2.2.2.2.cmml" xref="A1.p1.2.m2.2.2.2.2.2">
          𝑎
         </ci>
         <ci id="A1.p1.2.m2.2.2.2.2.3.cmml" xref="A1.p1.2.m2.2.2.2.2.3">
          ′
         </ci>
        </apply>
       </list>
      </annotation-xml>
      <annotation encoding="application/x-tex" id="A1.p1.2.m2.2c">
       s^{\prime},a^{\prime}
      </annotation>
     </semantics>
    </math>
    as the next state and action for convenience. We also adopt
    <math alttext="\text{KL}(a|s)=D_{KL}[\pi^{*}||\bar{\pi}](s)" class="ltx_math_unparsed" display="inline" id="A1.p1.3.m3.1">
     <semantics id="A1.p1.3.m3.1a">
      <mrow id="A1.p1.3.m3.1b">
       <mtext id="A1.p1.3.m3.1.1">
        KL
       </mtext>
       <mrow id="A1.p1.3.m3.1.2">
        <mo id="A1.p1.3.m3.1.2.1" stretchy="false">
         (
        </mo>
        <mi id="A1.p1.3.m3.1.2.2">
         a
        </mi>
        <mo fence="false" id="A1.p1.3.m3.1.2.3" rspace="0.167em" stretchy="false">
         |
        </mo>
        <mi id="A1.p1.3.m3.1.2.4">
         s
        </mi>
        <mo id="A1.p1.3.m3.1.2.5" stretchy="false">
         )
        </mo>
       </mrow>
       <mo id="A1.p1.3.m3.1.3">
        =
       </mo>
       <msub id="A1.p1.3.m3.1.4">
        <mi id="A1.p1.3.m3.1.4.2">
         D
        </mi>
        <mrow id="A1.p1.3.m3.1.4.3">
         <mi id="A1.p1.3.m3.1.4.3.2">
          K
         </mi>
         <mo id="A1.p1.3.m3.1.4.3.1" lspace="0em" rspace="0em">
          ​
         </mo>
         <mi id="A1.p1.3.m3.1.4.3.3">
          L
         </mi>
        </mrow>
       </msub>
       <mrow id="A1.p1.3.m3.1.5">
        <mo id="A1.p1.3.m3.1.5.1" stretchy="false">
         [
        </mo>
        <msup id="A1.p1.3.m3.1.5.2">
         <mi id="A1.p1.3.m3.1.5.2.2">
          π
         </mi>
         <mo id="A1.p1.3.m3.1.5.2.3">
          ∗
         </mo>
        </msup>
        <mo fence="false" id="A1.p1.3.m3.1.5.3" rspace="0.167em" stretchy="false">
         |
        </mo>
        <mo fence="false" id="A1.p1.3.m3.1.5.4" rspace="0.167em" stretchy="false">
         |
        </mo>
        <mover accent="true" id="A1.p1.3.m3.1.5.5">
         <mi id="A1.p1.3.m3.1.5.5.2">
          π
         </mi>
         <mo id="A1.p1.3.m3.1.5.5.1">
          ¯
         </mo>
        </mover>
        <mo id="A1.p1.3.m3.1.5.6" stretchy="false">
         ]
        </mo>
       </mrow>
       <mrow id="A1.p1.3.m3.1.6">
        <mo id="A1.p1.3.m3.1.6.1" stretchy="false">
         (
        </mo>
        <mi id="A1.p1.3.m3.1.6.2">
         s
        </mi>
        <mo id="A1.p1.3.m3.1.6.3" stretchy="false">
         )
        </mo>
       </mrow>
      </mrow>
      <annotation encoding="application/x-tex" id="A1.p1.3.m3.1c">
       \text{KL}(a|s)=D_{KL}[\pi^{*}||\bar{\pi}](s)
      </annotation>
     </semantics>
    </math>
    , where the
    <math alttext="\text{KL}(a|s)" class="ltx_Math" display="inline" id="A1.p1.4.m4.1">
     <semantics id="A1.p1.4.m4.1a">
      <mrow id="A1.p1.4.m4.1.1" xref="A1.p1.4.m4.1.1.cmml">
       <mtext id="A1.p1.4.m4.1.1.3" xref="A1.p1.4.m4.1.1.3a.cmml">
        KL
       </mtext>
       <mo id="A1.p1.4.m4.1.1.2" lspace="0em" rspace="0em" xref="A1.p1.4.m4.1.1.2.cmml">
        ​
       </mo>
       <mrow id="A1.p1.4.m4.1.1.1.1" xref="A1.p1.4.m4.1.1.1.1.1.cmml">
        <mo id="A1.p1.4.m4.1.1.1.1.2" stretchy="false" xref="A1.p1.4.m4.1.1.1.1.1.cmml">
         (
        </mo>
        <mrow id="A1.p1.4.m4.1.1.1.1.1" xref="A1.p1.4.m4.1.1.1.1.1.cmml">
         <mi id="A1.p1.4.m4.1.1.1.1.1.2" xref="A1.p1.4.m4.1.1.1.1.1.2.cmml">
          a
         </mi>
         <mo fence="false" id="A1.p1.4.m4.1.1.1.1.1.1" xref="A1.p1.4.m4.1.1.1.1.1.1.cmml">
          |
         </mo>
         <mi id="A1.p1.4.m4.1.1.1.1.1.3" xref="A1.p1.4.m4.1.1.1.1.1.3.cmml">
          s
         </mi>
        </mrow>
        <mo id="A1.p1.4.m4.1.1.1.1.3" stretchy="false" xref="A1.p1.4.m4.1.1.1.1.1.cmml">
         )
        </mo>
       </mrow>
      </mrow>
      <annotation-xml encoding="MathML-Content" id="A1.p1.4.m4.1b">
       <apply id="A1.p1.4.m4.1.1.cmml" xref="A1.p1.4.m4.1.1">
        <times id="A1.p1.4.m4.1.1.2.cmml" xref="A1.p1.4.m4.1.1.2">
        </times>
        <ci id="A1.p1.4.m4.1.1.3a.cmml" xref="A1.p1.4.m4.1.1.3">
         <mtext id="A1.p1.4.m4.1.1.3.cmml" xref="A1.p1.4.m4.1.1.3">
          KL
         </mtext>
        </ci>
        <apply id="A1.p1.4.m4.1.1.1.1.1.cmml" xref="A1.p1.4.m4.1.1.1.1">
         <csymbol cd="latexml" id="A1.p1.4.m4.1.1.1.1.1.1.cmml" xref="A1.p1.4.m4.1.1.1.1.1.1">
          conditional
         </csymbol>
         <ci id="A1.p1.4.m4.1.1.1.1.1.2.cmml" xref="A1.p1.4.m4.1.1.1.1.1.2">
          𝑎
         </ci>
         <ci id="A1.p1.4.m4.1.1.1.1.1.3.cmml" xref="A1.p1.4.m4.1.1.1.1.1.3">
          𝑠
         </ci>
        </apply>
       </apply>
      </annotation-xml>
      <annotation encoding="application/x-tex" id="A1.p1.4.m4.1c">
       \text{KL}(a|s)
      </annotation>
     </semantics>
    </math>
    indicate it is a action level KL divergence,
    <math alttext="\text{KL}(w|s)" class="ltx_Math" display="inline" id="A1.p1.5.m5.1">
     <semantics id="A1.p1.5.m5.1a">
      <mrow id="A1.p1.5.m5.1.1" xref="A1.p1.5.m5.1.1.cmml">
       <mtext id="A1.p1.5.m5.1.1.3" xref="A1.p1.5.m5.1.1.3a.cmml">
        KL
       </mtext>
       <mo id="A1.p1.5.m5.1.1.2" lspace="0em" rspace="0em" xref="A1.p1.5.m5.1.1.2.cmml">
        ​
       </mo>
       <mrow id="A1.p1.5.m5.1.1.1.1" xref="A1.p1.5.m5.1.1.1.1.1.cmml">
        <mo id="A1.p1.5.m5.1.1.1.1.2" stretchy="false" xref="A1.p1.5.m5.1.1.1.1.1.cmml">
         (
        </mo>
        <mrow id="A1.p1.5.m5.1.1.1.1.1" xref="A1.p1.5.m5.1.1.1.1.1.cmml">
         <mi id="A1.p1.5.m5.1.1.1.1.1.2" xref="A1.p1.5.m5.1.1.1.1.1.2.cmml">
          w
         </mi>
         <mo fence="false" id="A1.p1.5.m5.1.1.1.1.1.1" xref="A1.p1.5.m5.1.1.1.1.1.1.cmml">
          |
         </mo>
         <mi id="A1.p1.5.m5.1.1.1.1.1.3" xref="A1.p1.5.m5.1.1.1.1.1.3.cmml">
          s
         </mi>
        </mrow>
        <mo id="A1.p1.5.m5.1.1.1.1.3" stretchy="false" xref="A1.p1.5.m5.1.1.1.1.1.cmml">
         )
        </mo>
       </mrow>
      </mrow>
      <annotation-xml encoding="MathML-Content" id="A1.p1.5.m5.1b">
       <apply id="A1.p1.5.m5.1.1.cmml" xref="A1.p1.5.m5.1.1">
        <times id="A1.p1.5.m5.1.1.2.cmml" xref="A1.p1.5.m5.1.1.2">
        </times>
        <ci id="A1.p1.5.m5.1.1.3a.cmml" xref="A1.p1.5.m5.1.1.3">
         <mtext id="A1.p1.5.m5.1.1.3.cmml" xref="A1.p1.5.m5.1.1.3">
          KL
         </mtext>
        </ci>
        <apply id="A1.p1.5.m5.1.1.1.1.1.cmml" xref="A1.p1.5.m5.1.1.1.1">
         <csymbol cd="latexml" id="A1.p1.5.m5.1.1.1.1.1.1.cmml" xref="A1.p1.5.m5.1.1.1.1.1.1">
          conditional
         </csymbol>
         <ci id="A1.p1.5.m5.1.1.1.1.1.2.cmml" xref="A1.p1.5.m5.1.1.1.1.1.2">
          𝑤
         </ci>
         <ci id="A1.p1.5.m5.1.1.1.1.1.3.cmml" xref="A1.p1.5.m5.1.1.1.1.1.3">
          𝑠
         </ci>
        </apply>
       </apply>
      </annotation-xml>
      <annotation encoding="application/x-tex" id="A1.p1.5.m5.1c">
       \text{KL}(w|s)
      </annotation>
     </semantics>
    </math>
    indicate a token level KL divergence.
   </p>
  </div>
  <div class="ltx_para" id="A1.p2">
   <p class="ltx_p" id="A1.p2.1">
    Given the optimal stochastic policy,
    <math alttext="\pi^{*}" class="ltx_Math" display="inline" id="A1.p2.1.m1.1">
     <semantics id="A1.p2.1.m1.1a">
      <msup id="A1.p2.1.m1.1.1" xref="A1.p2.1.m1.1.1.cmml">
       <mi id="A1.p2.1.m1.1.1.2" xref="A1.p2.1.m1.1.1.2.cmml">
        π
       </mi>
       <mo id="A1.p2.1.m1.1.1.3" xref="A1.p2.1.m1.1.1.3.cmml">
        ∗
       </mo>
      </msup>
      <annotation-xml encoding="MathML-Content" id="A1.p2.1.m1.1b">
       <apply id="A1.p2.1.m1.1.1.cmml" xref="A1.p2.1.m1.1.1">
        <csymbol cd="ambiguous" id="A1.p2.1.m1.1.1.1.cmml" xref="A1.p2.1.m1.1.1">
         superscript
        </csymbol>
        <ci id="A1.p2.1.m1.1.1.2.cmml" xref="A1.p2.1.m1.1.1.2">
         𝜋
        </ci>
        <times id="A1.p2.1.m1.1.1.3.cmml" xref="A1.p2.1.m1.1.1.3">
        </times>
       </apply>
      </annotation-xml>
      <annotation encoding="application/x-tex" id="A1.p2.1.m1.1c">
       \pi^{*}
      </annotation>
     </semantics>
    </math>
    , the vanilla soft Bellman backup for full actions is:
   </p>
   <table class="ltx_equationgroup ltx_eqn_align ltx_eqn_table" id="A7.EGx11">
    <tbody id="A1.Ex3">
     <tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
      <td class="ltx_eqn_cell ltx_eqn_center_padleft">
      </td>
      <td class="ltx_td ltx_align_right ltx_eqn_cell">
       <math alttext="\displaystyle\mathbb{E}_{a\sim\pi^{*}(s)}[Q(s,a)]" class="ltx_Math" display="inline" id="A1.Ex3.m1.4">
        <semantics id="A1.Ex3.m1.4a">
         <mrow id="A1.Ex3.m1.4.4" xref="A1.Ex3.m1.4.4.cmml">
          <msub id="A1.Ex3.m1.4.4.3" xref="A1.Ex3.m1.4.4.3.cmml">
           <mi id="A1.Ex3.m1.4.4.3.2" xref="A1.Ex3.m1.4.4.3.2.cmml">
            𝔼
           </mi>
           <mrow id="A1.Ex3.m1.1.1.1" xref="A1.Ex3.m1.1.1.1.cmml">
            <mi id="A1.Ex3.m1.1.1.1.3" xref="A1.Ex3.m1.1.1.1.3.cmml">
             a
            </mi>
            <mo id="A1.Ex3.m1.1.1.1.2" xref="A1.Ex3.m1.1.1.1.2.cmml">
             ∼
            </mo>
            <mrow id="A1.Ex3.m1.1.1.1.4" xref="A1.Ex3.m1.1.1.1.4.cmml">
             <msup id="A1.Ex3.m1.1.1.1.4.2" xref="A1.Ex3.m1.1.1.1.4.2.cmml">
              <mi id="A1.Ex3.m1.1.1.1.4.2.2" xref="A1.Ex3.m1.1.1.1.4.2.2.cmml">
               π
              </mi>
              <mo id="A1.Ex3.m1.1.1.1.4.2.3" xref="A1.Ex3.m1.1.1.1.4.2.3.cmml">
               ∗
              </mo>
             </msup>
             <mo id="A1.Ex3.m1.1.1.1.4.1" lspace="0em" rspace="0em" xref="A1.Ex3.m1.1.1.1.4.1.cmml">
              ​
             </mo>
             <mrow id="A1.Ex3.m1.1.1.1.4.3.2" xref="A1.Ex3.m1.1.1.1.4.cmml">
              <mo id="A1.Ex3.m1.1.1.1.4.3.2.1" stretchy="false" xref="A1.Ex3.m1.1.1.1.4.cmml">
               (
              </mo>
              <mi id="A1.Ex3.m1.1.1.1.1" xref="A1.Ex3.m1.1.1.1.1.cmml">
               s
              </mi>
              <mo id="A1.Ex3.m1.1.1.1.4.3.2.2" stretchy="false" xref="A1.Ex3.m1.1.1.1.4.cmml">
               )
              </mo>
             </mrow>
            </mrow>
           </mrow>
          </msub>
          <mo id="A1.Ex3.m1.4.4.2" lspace="0em" rspace="0em" xref="A1.Ex3.m1.4.4.2.cmml">
           ​
          </mo>
          <mrow id="A1.Ex3.m1.4.4.1.1" xref="A1.Ex3.m1.4.4.1.2.cmml">
           <mo id="A1.Ex3.m1.4.4.1.1.2" stretchy="false" xref="A1.Ex3.m1.4.4.1.2.1.cmml">
            [
           </mo>
           <mrow id="A1.Ex3.m1.4.4.1.1.1" xref="A1.Ex3.m1.4.4.1.1.1.cmml">
            <mi id="A1.Ex3.m1.4.4.1.1.1.2" xref="A1.Ex3.m1.4.4.1.1.1.2.cmml">
             Q
            </mi>
            <mo id="A1.Ex3.m1.4.4.1.1.1.1" lspace="0em" rspace="0em" xref="A1.Ex3.m1.4.4.1.1.1.1.cmml">
             ​
            </mo>
            <mrow id="A1.Ex3.m1.4.4.1.1.1.3.2" xref="A1.Ex3.m1.4.4.1.1.1.3.1.cmml">
             <mo id="A1.Ex3.m1.4.4.1.1.1.3.2.1" stretchy="false" xref="A1.Ex3.m1.4.4.1.1.1.3.1.cmml">
              (
             </mo>
             <mi id="A1.Ex3.m1.2.2" xref="A1.Ex3.m1.2.2.cmml">
              s
             </mi>
             <mo id="A1.Ex3.m1.4.4.1.1.1.3.2.2" xref="A1.Ex3.m1.4.4.1.1.1.3.1.cmml">
              ,
             </mo>
             <mi id="A1.Ex3.m1.3.3" xref="A1.Ex3.m1.3.3.cmml">
              a
             </mi>
             <mo id="A1.Ex3.m1.4.4.1.1.1.3.2.3" stretchy="false" xref="A1.Ex3.m1.4.4.1.1.1.3.1.cmml">
              )
             </mo>
            </mrow>
           </mrow>
           <mo id="A1.Ex3.m1.4.4.1.1.3" stretchy="false" xref="A1.Ex3.m1.4.4.1.2.1.cmml">
            ]
           </mo>
          </mrow>
         </mrow>
         <annotation-xml encoding="MathML-Content" id="A1.Ex3.m1.4b">
          <apply id="A1.Ex3.m1.4.4.cmml" xref="A1.Ex3.m1.4.4">
           <times id="A1.Ex3.m1.4.4.2.cmml" xref="A1.Ex3.m1.4.4.2">
           </times>
           <apply id="A1.Ex3.m1.4.4.3.cmml" xref="A1.Ex3.m1.4.4.3">
            <csymbol cd="ambiguous" id="A1.Ex3.m1.4.4.3.1.cmml" xref="A1.Ex3.m1.4.4.3">
             subscript
            </csymbol>
            <ci id="A1.Ex3.m1.4.4.3.2.cmml" xref="A1.Ex3.m1.4.4.3.2">
             𝔼
            </ci>
            <apply id="A1.Ex3.m1.1.1.1.cmml" xref="A1.Ex3.m1.1.1.1">
             <csymbol cd="latexml" id="A1.Ex3.m1.1.1.1.2.cmml" xref="A1.Ex3.m1.1.1.1.2">
              similar-to
             </csymbol>
             <ci id="A1.Ex3.m1.1.1.1.3.cmml" xref="A1.Ex3.m1.1.1.1.3">
              𝑎
             </ci>
             <apply id="A1.Ex3.m1.1.1.1.4.cmml" xref="A1.Ex3.m1.1.1.1.4">
              <times id="A1.Ex3.m1.1.1.1.4.1.cmml" xref="A1.Ex3.m1.1.1.1.4.1">
              </times>
              <apply id="A1.Ex3.m1.1.1.1.4.2.cmml" xref="A1.Ex3.m1.1.1.1.4.2">
               <csymbol cd="ambiguous" id="A1.Ex3.m1.1.1.1.4.2.1.cmml" xref="A1.Ex3.m1.1.1.1.4.2">
                superscript
               </csymbol>
               <ci id="A1.Ex3.m1.1.1.1.4.2.2.cmml" xref="A1.Ex3.m1.1.1.1.4.2.2">
                𝜋
               </ci>
               <times id="A1.Ex3.m1.1.1.1.4.2.3.cmml" xref="A1.Ex3.m1.1.1.1.4.2.3">
               </times>
              </apply>
              <ci id="A1.Ex3.m1.1.1.1.1.cmml" xref="A1.Ex3.m1.1.1.1.1">
               𝑠
              </ci>
             </apply>
            </apply>
           </apply>
           <apply id="A1.Ex3.m1.4.4.1.2.cmml" xref="A1.Ex3.m1.4.4.1.1">
            <csymbol cd="latexml" id="A1.Ex3.m1.4.4.1.2.1.cmml" xref="A1.Ex3.m1.4.4.1.1.2">
             delimited-[]
            </csymbol>
            <apply id="A1.Ex3.m1.4.4.1.1.1.cmml" xref="A1.Ex3.m1.4.4.1.1.1">
             <times id="A1.Ex3.m1.4.4.1.1.1.1.cmml" xref="A1.Ex3.m1.4.4.1.1.1.1">
             </times>
             <ci id="A1.Ex3.m1.4.4.1.1.1.2.cmml" xref="A1.Ex3.m1.4.4.1.1.1.2">
              𝑄
             </ci>
             <interval closure="open" id="A1.Ex3.m1.4.4.1.1.1.3.1.cmml" xref="A1.Ex3.m1.4.4.1.1.1.3.2">
              <ci id="A1.Ex3.m1.2.2.cmml" xref="A1.Ex3.m1.2.2">
               𝑠
              </ci>
              <ci id="A1.Ex3.m1.3.3.cmml" xref="A1.Ex3.m1.3.3">
               𝑎
              </ci>
             </interval>
            </apply>
           </apply>
          </apply>
         </annotation-xml>
         <annotation encoding="application/x-tex" id="A1.Ex3.m1.4c">
          \displaystyle\mathbb{E}_{a\sim\pi^{*}(s)}[Q(s,a)]
         </annotation>
        </semantics>
       </math>
      </td>
      <td class="ltx_td ltx_align_left ltx_eqn_cell">
       <math alttext="\displaystyle=\mathbb{E}_{a\sim\pi^{*}(s)}\Big{[}r(s,a)+\gamma(\mathbb{E}_{a^{\prime}\sim\pi^{*}(s^{\prime})}[Q(s^{\prime},a^{\prime})]-\beta\text{KL}(a^{\prime}|s^{\prime}))\Big{]}" class="ltx_Math" display="inline" id="A1.Ex3.m2.5">
        <semantics id="A1.Ex3.m2.5a">
         <mrow id="A1.Ex3.m2.5.5" xref="A1.Ex3.m2.5.5.cmml">
          <mi id="A1.Ex3.m2.5.5.3" xref="A1.Ex3.m2.5.5.3.cmml">
          </mi>
          <mo id="A1.Ex3.m2.5.5.2" xref="A1.Ex3.m2.5.5.2.cmml">
           =
          </mo>
          <mrow id="A1.Ex3.m2.5.5.1" xref="A1.Ex3.m2.5.5.1.cmml">
           <msub id="A1.Ex3.m2.5.5.1.3" xref="A1.Ex3.m2.5.5.1.3.cmml">
            <mi id="A1.Ex3.m2.5.5.1.3.2" xref="A1.Ex3.m2.5.5.1.3.2.cmml">
             𝔼
            </mi>
            <mrow id="A1.Ex3.m2.1.1.1" xref="A1.Ex3.m2.1.1.1.cmml">
             <mi id="A1.Ex3.m2.1.1.1.3" xref="A1.Ex3.m2.1.1.1.3.cmml">
              a
             </mi>
             <mo id="A1.Ex3.m2.1.1.1.2" xref="A1.Ex3.m2.1.1.1.2.cmml">
              ∼
             </mo>
             <mrow id="A1.Ex3.m2.1.1.1.4" xref="A1.Ex3.m2.1.1.1.4.cmml">
              <msup id="A1.Ex3.m2.1.1.1.4.2" xref="A1.Ex3.m2.1.1.1.4.2.cmml">
               <mi id="A1.Ex3.m2.1.1.1.4.2.2" xref="A1.Ex3.m2.1.1.1.4.2.2.cmml">
                π
               </mi>
               <mo id="A1.Ex3.m2.1.1.1.4.2.3" xref="A1.Ex3.m2.1.1.1.4.2.3.cmml">
                ∗
               </mo>
              </msup>
              <mo id="A1.Ex3.m2.1.1.1.4.1" lspace="0em" rspace="0em" xref="A1.Ex3.m2.1.1.1.4.1.cmml">
               ​
              </mo>
              <mrow id="A1.Ex3.m2.1.1.1.4.3.2" xref="A1.Ex3.m2.1.1.1.4.cmml">
               <mo id="A1.Ex3.m2.1.1.1.4.3.2.1" stretchy="false" xref="A1.Ex3.m2.1.1.1.4.cmml">
                (
               </mo>
               <mi id="A1.Ex3.m2.1.1.1.1" xref="A1.Ex3.m2.1.1.1.1.cmml">
                s
               </mi>
               <mo id="A1.Ex3.m2.1.1.1.4.3.2.2" stretchy="false" xref="A1.Ex3.m2.1.1.1.4.cmml">
                )
               </mo>
              </mrow>
             </mrow>
            </mrow>
           </msub>
           <mo id="A1.Ex3.m2.5.5.1.2" lspace="0em" rspace="0em" xref="A1.Ex3.m2.5.5.1.2.cmml">
            ​
           </mo>
           <mrow id="A1.Ex3.m2.5.5.1.1.1" xref="A1.Ex3.m2.5.5.1.1.2.cmml">
            <mo id="A1.Ex3.m2.5.5.1.1.1.2" maxsize="160%" minsize="160%" xref="A1.Ex3.m2.5.5.1.1.2.1.cmml">
             [
            </mo>
            <mrow id="A1.Ex3.m2.5.5.1.1.1.1" xref="A1.Ex3.m2.5.5.1.1.1.1.cmml">
             <mrow id="A1.Ex3.m2.5.5.1.1.1.1.3" xref="A1.Ex3.m2.5.5.1.1.1.1.3.cmml">
              <mi id="A1.Ex3.m2.5.5.1.1.1.1.3.2" xref="A1.Ex3.m2.5.5.1.1.1.1.3.2.cmml">
               r
              </mi>
              <mo id="A1.Ex3.m2.5.5.1.1.1.1.3.1" lspace="0em" rspace="0em" xref="A1.Ex3.m2.5.5.1.1.1.1.3.1.cmml">
               ​
              </mo>
              <mrow id="A1.Ex3.m2.5.5.1.1.1.1.3.3.2" xref="A1.Ex3.m2.5.5.1.1.1.1.3.3.1.cmml">
               <mo id="A1.Ex3.m2.5.5.1.1.1.1.3.3.2.1" stretchy="false" xref="A1.Ex3.m2.5.5.1.1.1.1.3.3.1.cmml">
                (
               </mo>
               <mi id="A1.Ex3.m2.3.3" xref="A1.Ex3.m2.3.3.cmml">
                s
               </mi>
               <mo id="A1.Ex3.m2.5.5.1.1.1.1.3.3.2.2" xref="A1.Ex3.m2.5.5.1.1.1.1.3.3.1.cmml">
                ,
               </mo>
               <mi id="A1.Ex3.m2.4.4" xref="A1.Ex3.m2.4.4.cmml">
                a
               </mi>
               <mo id="A1.Ex3.m2.5.5.1.1.1.1.3.3.2.3" stretchy="false" xref="A1.Ex3.m2.5.5.1.1.1.1.3.3.1.cmml">
                )
               </mo>
              </mrow>
             </mrow>
             <mo id="A1.Ex3.m2.5.5.1.1.1.1.2" xref="A1.Ex3.m2.5.5.1.1.1.1.2.cmml">
              +
             </mo>
             <mrow id="A1.Ex3.m2.5.5.1.1.1.1.1" xref="A1.Ex3.m2.5.5.1.1.1.1.1.cmml">
              <mi id="A1.Ex3.m2.5.5.1.1.1.1.1.3" xref="A1.Ex3.m2.5.5.1.1.1.1.1.3.cmml">
               γ
              </mi>
              <mo id="A1.Ex3.m2.5.5.1.1.1.1.1.2" lspace="0em" rspace="0em" xref="A1.Ex3.m2.5.5.1.1.1.1.1.2.cmml">
               ​
              </mo>
              <mrow id="A1.Ex3.m2.5.5.1.1.1.1.1.1.1" xref="A1.Ex3.m2.5.5.1.1.1.1.1.1.1.1.cmml">
               <mo id="A1.Ex3.m2.5.5.1.1.1.1.1.1.1.2" stretchy="false" xref="A1.Ex3.m2.5.5.1.1.1.1.1.1.1.1.cmml">
                (
               </mo>
               <mrow id="A1.Ex3.m2.5.5.1.1.1.1.1.1.1.1" xref="A1.Ex3.m2.5.5.1.1.1.1.1.1.1.1.cmml">
                <mrow id="A1.Ex3.m2.5.5.1.1.1.1.1.1.1.1.1" xref="A1.Ex3.m2.5.5.1.1.1.1.1.1.1.1.1.cmml">
                 <msub id="A1.Ex3.m2.5.5.1.1.1.1.1.1.1.1.1.3" xref="A1.Ex3.m2.5.5.1.1.1.1.1.1.1.1.1.3.cmml">
                  <mi id="A1.Ex3.m2.5.5.1.1.1.1.1.1.1.1.1.3.2" xref="A1.Ex3.m2.5.5.1.1.1.1.1.1.1.1.1.3.2.cmml">
                   𝔼
                  </mi>
                  <mrow id="A1.Ex3.m2.2.2.1" xref="A1.Ex3.m2.2.2.1.cmml">
                   <msup id="A1.Ex3.m2.2.2.1.3" xref="A1.Ex3.m2.2.2.1.3.cmml">
                    <mi id="A1.Ex3.m2.2.2.1.3.2" xref="A1.Ex3.m2.2.2.1.3.2.cmml">
                     a
                    </mi>
                    <mo id="A1.Ex3.m2.2.2.1.3.3" xref="A1.Ex3.m2.2.2.1.3.3.cmml">
                     ′
                    </mo>
                   </msup>
                   <mo id="A1.Ex3.m2.2.2.1.2" xref="A1.Ex3.m2.2.2.1.2.cmml">
                    ∼
                   </mo>
                   <mrow id="A1.Ex3.m2.2.2.1.1" xref="A1.Ex3.m2.2.2.1.1.cmml">
                    <msup id="A1.Ex3.m2.2.2.1.1.3" xref="A1.Ex3.m2.2.2.1.1.3.cmml">
                     <mi id="A1.Ex3.m2.2.2.1.1.3.2" xref="A1.Ex3.m2.2.2.1.1.3.2.cmml">
                      π
                     </mi>
                     <mo id="A1.Ex3.m2.2.2.1.1.3.3" xref="A1.Ex3.m2.2.2.1.1.3.3.cmml">
                      ∗
                     </mo>
                    </msup>
                    <mo id="A1.Ex3.m2.2.2.1.1.2" lspace="0em" rspace="0em" xref="A1.Ex3.m2.2.2.1.1.2.cmml">
                     ​
                    </mo>
                    <mrow id="A1.Ex3.m2.2.2.1.1.1.1" xref="A1.Ex3.m2.2.2.1.1.1.1.1.cmml">
                     <mo id="A1.Ex3.m2.2.2.1.1.1.1.2" stretchy="false" xref="A1.Ex3.m2.2.2.1.1.1.1.1.cmml">
                      (
                     </mo>
                     <msup id="A1.Ex3.m2.2.2.1.1.1.1.1" xref="A1.Ex3.m2.2.2.1.1.1.1.1.cmml">
                      <mi id="A1.Ex3.m2.2.2.1.1.1.1.1.2" xref="A1.Ex3.m2.2.2.1.1.1.1.1.2.cmml">
                       s
                      </mi>
                      <mo id="A1.Ex3.m2.2.2.1.1.1.1.1.3" xref="A1.Ex3.m2.2.2.1.1.1.1.1.3.cmml">
                       ′
                      </mo>
                     </msup>
                     <mo id="A1.Ex3.m2.2.2.1.1.1.1.3" stretchy="false" xref="A1.Ex3.m2.2.2.1.1.1.1.1.cmml">
                      )
                     </mo>
                    </mrow>
                   </mrow>
                  </mrow>
                 </msub>
                 <mo id="A1.Ex3.m2.5.5.1.1.1.1.1.1.1.1.1.2" lspace="0em" rspace="0em" xref="A1.Ex3.m2.5.5.1.1.1.1.1.1.1.1.1.2.cmml">
                  ​
                 </mo>
                 <mrow id="A1.Ex3.m2.5.5.1.1.1.1.1.1.1.1.1.1.1" xref="A1.Ex3.m2.5.5.1.1.1.1.1.1.1.1.1.1.2.cmml">
                  <mo id="A1.Ex3.m2.5.5.1.1.1.1.1.1.1.1.1.1.1.2" stretchy="false" xref="A1.Ex3.m2.5.5.1.1.1.1.1.1.1.1.1.1.2.1.cmml">
                   [
                  </mo>
                  <mrow id="A1.Ex3.m2.5.5.1.1.1.1.1.1.1.1.1.1.1.1" xref="A1.Ex3.m2.5.5.1.1.1.1.1.1.1.1.1.1.1.1.cmml">
                   <mi id="A1.Ex3.m2.5.5.1.1.1.1.1.1.1.1.1.1.1.1.4" xref="A1.Ex3.m2.5.5.1.1.1.1.1.1.1.1.1.1.1.1.4.cmml">
                    Q
                   </mi>
                   <mo id="A1.Ex3.m2.5.5.1.1.1.1.1.1.1.1.1.1.1.1.3" lspace="0em" rspace="0em" xref="A1.Ex3.m2.5.5.1.1.1.1.1.1.1.1.1.1.1.1.3.cmml">
                    ​
                   </mo>
                   <mrow id="A1.Ex3.m2.5.5.1.1.1.1.1.1.1.1.1.1.1.1.2.2" xref="A1.Ex3.m2.5.5.1.1.1.1.1.1.1.1.1.1.1.1.2.3.cmml">
                    <mo id="A1.Ex3.m2.5.5.1.1.1.1.1.1.1.1.1.1.1.1.2.2.3" stretchy="false" xref="A1.Ex3.m2.5.5.1.1.1.1.1.1.1.1.1.1.1.1.2.3.cmml">
                     (
                    </mo>
                    <msup id="A1.Ex3.m2.5.5.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1" xref="A1.Ex3.m2.5.5.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml">
                     <mi id="A1.Ex3.m2.5.5.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2" xref="A1.Ex3.m2.5.5.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.cmml">
                      s
                     </mi>
                     <mo id="A1.Ex3.m2.5.5.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3" xref="A1.Ex3.m2.5.5.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.cmml">
                      ′
                     </mo>
                    </msup>
                    <mo id="A1.Ex3.m2.5.5.1.1.1.1.1.1.1.1.1.1.1.1.2.2.4" xref="A1.Ex3.m2.5.5.1.1.1.1.1.1.1.1.1.1.1.1.2.3.cmml">
                     ,
                    </mo>
                    <msup id="A1.Ex3.m2.5.5.1.1.1.1.1.1.1.1.1.1.1.1.2.2.2" xref="A1.Ex3.m2.5.5.1.1.1.1.1.1.1.1.1.1.1.1.2.2.2.cmml">
                     <mi id="A1.Ex3.m2.5.5.1.1.1.1.1.1.1.1.1.1.1.1.2.2.2.2" xref="A1.Ex3.m2.5.5.1.1.1.1.1.1.1.1.1.1.1.1.2.2.2.2.cmml">
                      a
                     </mi>
                     <mo id="A1.Ex3.m2.5.5.1.1.1.1.1.1.1.1.1.1.1.1.2.2.2.3" xref="A1.Ex3.m2.5.5.1.1.1.1.1.1.1.1.1.1.1.1.2.2.2.3.cmml">
                      ′
                     </mo>
                    </msup>
                    <mo id="A1.Ex3.m2.5.5.1.1.1.1.1.1.1.1.1.1.1.1.2.2.5" stretchy="false" xref="A1.Ex3.m2.5.5.1.1.1.1.1.1.1.1.1.1.1.1.2.3.cmml">
                     )
                    </mo>
                   </mrow>
                  </mrow>
                  <mo id="A1.Ex3.m2.5.5.1.1.1.1.1.1.1.1.1.1.1.3" stretchy="false" xref="A1.Ex3.m2.5.5.1.1.1.1.1.1.1.1.1.1.2.1.cmml">
                   ]
                  </mo>
                 </mrow>
                </mrow>
                <mo id="A1.Ex3.m2.5.5.1.1.1.1.1.1.1.1.3" xref="A1.Ex3.m2.5.5.1.1.1.1.1.1.1.1.3.cmml">
                 −
                </mo>
                <mrow id="A1.Ex3.m2.5.5.1.1.1.1.1.1.1.1.2" xref="A1.Ex3.m2.5.5.1.1.1.1.1.1.1.1.2.cmml">
                 <mi id="A1.Ex3.m2.5.5.1.1.1.1.1.1.1.1.2.3" xref="A1.Ex3.m2.5.5.1.1.1.1.1.1.1.1.2.3.cmml">
                  β
                 </mi>
                 <mo id="A1.Ex3.m2.5.5.1.1.1.1.1.1.1.1.2.2" lspace="0em" rspace="0em" xref="A1.Ex3.m2.5.5.1.1.1.1.1.1.1.1.2.2.cmml">
                  ​
                 </mo>
                 <mtext id="A1.Ex3.m2.5.5.1.1.1.1.1.1.1.1.2.4" xref="A1.Ex3.m2.5.5.1.1.1.1.1.1.1.1.2.4a.cmml">
                  KL
                 </mtext>
                 <mo id="A1.Ex3.m2.5.5.1.1.1.1.1.1.1.1.2.2a" lspace="0em" rspace="0em" xref="A1.Ex3.m2.5.5.1.1.1.1.1.1.1.1.2.2.cmml">
                  ​
                 </mo>
                 <mrow id="A1.Ex3.m2.5.5.1.1.1.1.1.1.1.1.2.1.1" xref="A1.Ex3.m2.5.5.1.1.1.1.1.1.1.1.2.1.1.1.cmml">
                  <mo id="A1.Ex3.m2.5.5.1.1.1.1.1.1.1.1.2.1.1.2" stretchy="false" xref="A1.Ex3.m2.5.5.1.1.1.1.1.1.1.1.2.1.1.1.cmml">
                   (
                  </mo>
                  <mrow id="A1.Ex3.m2.5.5.1.1.1.1.1.1.1.1.2.1.1.1" xref="A1.Ex3.m2.5.5.1.1.1.1.1.1.1.1.2.1.1.1.cmml">
                   <msup id="A1.Ex3.m2.5.5.1.1.1.1.1.1.1.1.2.1.1.1.2" xref="A1.Ex3.m2.5.5.1.1.1.1.1.1.1.1.2.1.1.1.2.cmml">
                    <mi id="A1.Ex3.m2.5.5.1.1.1.1.1.1.1.1.2.1.1.1.2.2" xref="A1.Ex3.m2.5.5.1.1.1.1.1.1.1.1.2.1.1.1.2.2.cmml">
                     a
                    </mi>
                    <mo id="A1.Ex3.m2.5.5.1.1.1.1.1.1.1.1.2.1.1.1.2.3" xref="A1.Ex3.m2.5.5.1.1.1.1.1.1.1.1.2.1.1.1.2.3.cmml">
                     ′
                    </mo>
                   </msup>
                   <mo fence="false" id="A1.Ex3.m2.5.5.1.1.1.1.1.1.1.1.2.1.1.1.1" xref="A1.Ex3.m2.5.5.1.1.1.1.1.1.1.1.2.1.1.1.1.cmml">
                    |
                   </mo>
                   <msup id="A1.Ex3.m2.5.5.1.1.1.1.1.1.1.1.2.1.1.1.3" xref="A1.Ex3.m2.5.5.1.1.1.1.1.1.1.1.2.1.1.1.3.cmml">
                    <mi id="A1.Ex3.m2.5.5.1.1.1.1.1.1.1.1.2.1.1.1.3.2" xref="A1.Ex3.m2.5.5.1.1.1.1.1.1.1.1.2.1.1.1.3.2.cmml">
                     s
                    </mi>
                    <mo id="A1.Ex3.m2.5.5.1.1.1.1.1.1.1.1.2.1.1.1.3.3" xref="A1.Ex3.m2.5.5.1.1.1.1.1.1.1.1.2.1.1.1.3.3.cmml">
                     ′
                    </mo>
                   </msup>
                  </mrow>
                  <mo id="A1.Ex3.m2.5.5.1.1.1.1.1.1.1.1.2.1.1.3" stretchy="false" xref="A1.Ex3.m2.5.5.1.1.1.1.1.1.1.1.2.1.1.1.cmml">
                   )
                  </mo>
                 </mrow>
                </mrow>
               </mrow>
               <mo id="A1.Ex3.m2.5.5.1.1.1.1.1.1.1.3" stretchy="false" xref="A1.Ex3.m2.5.5.1.1.1.1.1.1.1.1.cmml">
                )
               </mo>
              </mrow>
             </mrow>
            </mrow>
            <mo id="A1.Ex3.m2.5.5.1.1.1.3" maxsize="160%" minsize="160%" xref="A1.Ex3.m2.5.5.1.1.2.1.cmml">
             ]
            </mo>
           </mrow>
          </mrow>
         </mrow>
         <annotation-xml encoding="MathML-Content" id="A1.Ex3.m2.5b">
          <apply id="A1.Ex3.m2.5.5.cmml" xref="A1.Ex3.m2.5.5">
           <eq id="A1.Ex3.m2.5.5.2.cmml" xref="A1.Ex3.m2.5.5.2">
           </eq>
           <csymbol cd="latexml" id="A1.Ex3.m2.5.5.3.cmml" xref="A1.Ex3.m2.5.5.3">
            absent
           </csymbol>
           <apply id="A1.Ex3.m2.5.5.1.cmml" xref="A1.Ex3.m2.5.5.1">
            <times id="A1.Ex3.m2.5.5.1.2.cmml" xref="A1.Ex3.m2.5.5.1.2">
            </times>
            <apply id="A1.Ex3.m2.5.5.1.3.cmml" xref="A1.Ex3.m2.5.5.1.3">
             <csymbol cd="ambiguous" id="A1.Ex3.m2.5.5.1.3.1.cmml" xref="A1.Ex3.m2.5.5.1.3">
              subscript
             </csymbol>
             <ci id="A1.Ex3.m2.5.5.1.3.2.cmml" xref="A1.Ex3.m2.5.5.1.3.2">
              𝔼
             </ci>
             <apply id="A1.Ex3.m2.1.1.1.cmml" xref="A1.Ex3.m2.1.1.1">
              <csymbol cd="latexml" id="A1.Ex3.m2.1.1.1.2.cmml" xref="A1.Ex3.m2.1.1.1.2">
               similar-to
              </csymbol>
              <ci id="A1.Ex3.m2.1.1.1.3.cmml" xref="A1.Ex3.m2.1.1.1.3">
               𝑎
              </ci>
              <apply id="A1.Ex3.m2.1.1.1.4.cmml" xref="A1.Ex3.m2.1.1.1.4">
               <times id="A1.Ex3.m2.1.1.1.4.1.cmml" xref="A1.Ex3.m2.1.1.1.4.1">
               </times>
               <apply id="A1.Ex3.m2.1.1.1.4.2.cmml" xref="A1.Ex3.m2.1.1.1.4.2">
                <csymbol cd="ambiguous" id="A1.Ex3.m2.1.1.1.4.2.1.cmml" xref="A1.Ex3.m2.1.1.1.4.2">
                 superscript
                </csymbol>
                <ci id="A1.Ex3.m2.1.1.1.4.2.2.cmml" xref="A1.Ex3.m2.1.1.1.4.2.2">
                 𝜋
                </ci>
                <times id="A1.Ex3.m2.1.1.1.4.2.3.cmml" xref="A1.Ex3.m2.1.1.1.4.2.3">
                </times>
               </apply>
               <ci id="A1.Ex3.m2.1.1.1.1.cmml" xref="A1.Ex3.m2.1.1.1.1">
                𝑠
               </ci>
              </apply>
             </apply>
            </apply>
            <apply id="A1.Ex3.m2.5.5.1.1.2.cmml" xref="A1.Ex3.m2.5.5.1.1.1">
             <csymbol cd="latexml" id="A1.Ex3.m2.5.5.1.1.2.1.cmml" xref="A1.Ex3.m2.5.5.1.1.1.2">
              delimited-[]
             </csymbol>
             <apply id="A1.Ex3.m2.5.5.1.1.1.1.cmml" xref="A1.Ex3.m2.5.5.1.1.1.1">
              <plus id="A1.Ex3.m2.5.5.1.1.1.1.2.cmml" xref="A1.Ex3.m2.5.5.1.1.1.1.2">
              </plus>
              <apply id="A1.Ex3.m2.5.5.1.1.1.1.3.cmml" xref="A1.Ex3.m2.5.5.1.1.1.1.3">
               <times id="A1.Ex3.m2.5.5.1.1.1.1.3.1.cmml" xref="A1.Ex3.m2.5.5.1.1.1.1.3.1">
               </times>
               <ci id="A1.Ex3.m2.5.5.1.1.1.1.3.2.cmml" xref="A1.Ex3.m2.5.5.1.1.1.1.3.2">
                𝑟
               </ci>
               <interval closure="open" id="A1.Ex3.m2.5.5.1.1.1.1.3.3.1.cmml" xref="A1.Ex3.m2.5.5.1.1.1.1.3.3.2">
                <ci id="A1.Ex3.m2.3.3.cmml" xref="A1.Ex3.m2.3.3">
                 𝑠
                </ci>
                <ci id="A1.Ex3.m2.4.4.cmml" xref="A1.Ex3.m2.4.4">
                 𝑎
                </ci>
               </interval>
              </apply>
              <apply id="A1.Ex3.m2.5.5.1.1.1.1.1.cmml" xref="A1.Ex3.m2.5.5.1.1.1.1.1">
               <times id="A1.Ex3.m2.5.5.1.1.1.1.1.2.cmml" xref="A1.Ex3.m2.5.5.1.1.1.1.1.2">
               </times>
               <ci id="A1.Ex3.m2.5.5.1.1.1.1.1.3.cmml" xref="A1.Ex3.m2.5.5.1.1.1.1.1.3">
                𝛾
               </ci>
               <apply id="A1.Ex3.m2.5.5.1.1.1.1.1.1.1.1.cmml" xref="A1.Ex3.m2.5.5.1.1.1.1.1.1.1">
                <minus id="A1.Ex3.m2.5.5.1.1.1.1.1.1.1.1.3.cmml" xref="A1.Ex3.m2.5.5.1.1.1.1.1.1.1.1.3">
                </minus>
                <apply id="A1.Ex3.m2.5.5.1.1.1.1.1.1.1.1.1.cmml" xref="A1.Ex3.m2.5.5.1.1.1.1.1.1.1.1.1">
                 <times id="A1.Ex3.m2.5.5.1.1.1.1.1.1.1.1.1.2.cmml" xref="A1.Ex3.m2.5.5.1.1.1.1.1.1.1.1.1.2">
                 </times>
                 <apply id="A1.Ex3.m2.5.5.1.1.1.1.1.1.1.1.1.3.cmml" xref="A1.Ex3.m2.5.5.1.1.1.1.1.1.1.1.1.3">
                  <csymbol cd="ambiguous" id="A1.Ex3.m2.5.5.1.1.1.1.1.1.1.1.1.3.1.cmml" xref="A1.Ex3.m2.5.5.1.1.1.1.1.1.1.1.1.3">
                   subscript
                  </csymbol>
                  <ci id="A1.Ex3.m2.5.5.1.1.1.1.1.1.1.1.1.3.2.cmml" xref="A1.Ex3.m2.5.5.1.1.1.1.1.1.1.1.1.3.2">
                   𝔼
                  </ci>
                  <apply id="A1.Ex3.m2.2.2.1.cmml" xref="A1.Ex3.m2.2.2.1">
                   <csymbol cd="latexml" id="A1.Ex3.m2.2.2.1.2.cmml" xref="A1.Ex3.m2.2.2.1.2">
                    similar-to
                   </csymbol>
                   <apply id="A1.Ex3.m2.2.2.1.3.cmml" xref="A1.Ex3.m2.2.2.1.3">
                    <csymbol cd="ambiguous" id="A1.Ex3.m2.2.2.1.3.1.cmml" xref="A1.Ex3.m2.2.2.1.3">
                     superscript
                    </csymbol>
                    <ci id="A1.Ex3.m2.2.2.1.3.2.cmml" xref="A1.Ex3.m2.2.2.1.3.2">
                     𝑎
                    </ci>
                    <ci id="A1.Ex3.m2.2.2.1.3.3.cmml" xref="A1.Ex3.m2.2.2.1.3.3">
                     ′
                    </ci>
                   </apply>
                   <apply id="A1.Ex3.m2.2.2.1.1.cmml" xref="A1.Ex3.m2.2.2.1.1">
                    <times id="A1.Ex3.m2.2.2.1.1.2.cmml" xref="A1.Ex3.m2.2.2.1.1.2">
                    </times>
                    <apply id="A1.Ex3.m2.2.2.1.1.3.cmml" xref="A1.Ex3.m2.2.2.1.1.3">
                     <csymbol cd="ambiguous" id="A1.Ex3.m2.2.2.1.1.3.1.cmml" xref="A1.Ex3.m2.2.2.1.1.3">
                      superscript
                     </csymbol>
                     <ci id="A1.Ex3.m2.2.2.1.1.3.2.cmml" xref="A1.Ex3.m2.2.2.1.1.3.2">
                      𝜋
                     </ci>
                     <times id="A1.Ex3.m2.2.2.1.1.3.3.cmml" xref="A1.Ex3.m2.2.2.1.1.3.3">
                     </times>
                    </apply>
                    <apply id="A1.Ex3.m2.2.2.1.1.1.1.1.cmml" xref="A1.Ex3.m2.2.2.1.1.1.1">
                     <csymbol cd="ambiguous" id="A1.Ex3.m2.2.2.1.1.1.1.1.1.cmml" xref="A1.Ex3.m2.2.2.1.1.1.1">
                      superscript
                     </csymbol>
                     <ci id="A1.Ex3.m2.2.2.1.1.1.1.1.2.cmml" xref="A1.Ex3.m2.2.2.1.1.1.1.1.2">
                      𝑠
                     </ci>
                     <ci id="A1.Ex3.m2.2.2.1.1.1.1.1.3.cmml" xref="A1.Ex3.m2.2.2.1.1.1.1.1.3">
                      ′
                     </ci>
                    </apply>
                   </apply>
                  </apply>
                 </apply>
                 <apply id="A1.Ex3.m2.5.5.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="A1.Ex3.m2.5.5.1.1.1.1.1.1.1.1.1.1.1">
                  <csymbol cd="latexml" id="A1.Ex3.m2.5.5.1.1.1.1.1.1.1.1.1.1.2.1.cmml" xref="A1.Ex3.m2.5.5.1.1.1.1.1.1.1.1.1.1.1.2">
                   delimited-[]
                  </csymbol>
                  <apply id="A1.Ex3.m2.5.5.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="A1.Ex3.m2.5.5.1.1.1.1.1.1.1.1.1.1.1.1">
                   <times id="A1.Ex3.m2.5.5.1.1.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="A1.Ex3.m2.5.5.1.1.1.1.1.1.1.1.1.1.1.1.3">
                   </times>
                   <ci id="A1.Ex3.m2.5.5.1.1.1.1.1.1.1.1.1.1.1.1.4.cmml" xref="A1.Ex3.m2.5.5.1.1.1.1.1.1.1.1.1.1.1.1.4">
                    𝑄
                   </ci>
                   <interval closure="open" id="A1.Ex3.m2.5.5.1.1.1.1.1.1.1.1.1.1.1.1.2.3.cmml" xref="A1.Ex3.m2.5.5.1.1.1.1.1.1.1.1.1.1.1.1.2.2">
                    <apply id="A1.Ex3.m2.5.5.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="A1.Ex3.m2.5.5.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1">
                     <csymbol cd="ambiguous" id="A1.Ex3.m2.5.5.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="A1.Ex3.m2.5.5.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1">
                      superscript
                     </csymbol>
                     <ci id="A1.Ex3.m2.5.5.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="A1.Ex3.m2.5.5.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.2">
                      𝑠
                     </ci>
                     <ci id="A1.Ex3.m2.5.5.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="A1.Ex3.m2.5.5.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.3">
                      ′
                     </ci>
                    </apply>
                    <apply id="A1.Ex3.m2.5.5.1.1.1.1.1.1.1.1.1.1.1.1.2.2.2.cmml" xref="A1.Ex3.m2.5.5.1.1.1.1.1.1.1.1.1.1.1.1.2.2.2">
                     <csymbol cd="ambiguous" id="A1.Ex3.m2.5.5.1.1.1.1.1.1.1.1.1.1.1.1.2.2.2.1.cmml" xref="A1.Ex3.m2.5.5.1.1.1.1.1.1.1.1.1.1.1.1.2.2.2">
                      superscript
                     </csymbol>
                     <ci id="A1.Ex3.m2.5.5.1.1.1.1.1.1.1.1.1.1.1.1.2.2.2.2.cmml" xref="A1.Ex3.m2.5.5.1.1.1.1.1.1.1.1.1.1.1.1.2.2.2.2">
                      𝑎
                     </ci>
                     <ci id="A1.Ex3.m2.5.5.1.1.1.1.1.1.1.1.1.1.1.1.2.2.2.3.cmml" xref="A1.Ex3.m2.5.5.1.1.1.1.1.1.1.1.1.1.1.1.2.2.2.3">
                      ′
                     </ci>
                    </apply>
                   </interval>
                  </apply>
                 </apply>
                </apply>
                <apply id="A1.Ex3.m2.5.5.1.1.1.1.1.1.1.1.2.cmml" xref="A1.Ex3.m2.5.5.1.1.1.1.1.1.1.1.2">
                 <times id="A1.Ex3.m2.5.5.1.1.1.1.1.1.1.1.2.2.cmml" xref="A1.Ex3.m2.5.5.1.1.1.1.1.1.1.1.2.2">
                 </times>
                 <ci id="A1.Ex3.m2.5.5.1.1.1.1.1.1.1.1.2.3.cmml" xref="A1.Ex3.m2.5.5.1.1.1.1.1.1.1.1.2.3">
                  𝛽
                 </ci>
                 <ci id="A1.Ex3.m2.5.5.1.1.1.1.1.1.1.1.2.4a.cmml" xref="A1.Ex3.m2.5.5.1.1.1.1.1.1.1.1.2.4">
                  <mtext id="A1.Ex3.m2.5.5.1.1.1.1.1.1.1.1.2.4.cmml" xref="A1.Ex3.m2.5.5.1.1.1.1.1.1.1.1.2.4">
                   KL
                  </mtext>
                 </ci>
                 <apply id="A1.Ex3.m2.5.5.1.1.1.1.1.1.1.1.2.1.1.1.cmml" xref="A1.Ex3.m2.5.5.1.1.1.1.1.1.1.1.2.1.1">
                  <csymbol cd="latexml" id="A1.Ex3.m2.5.5.1.1.1.1.1.1.1.1.2.1.1.1.1.cmml" xref="A1.Ex3.m2.5.5.1.1.1.1.1.1.1.1.2.1.1.1.1">
                   conditional
                  </csymbol>
                  <apply id="A1.Ex3.m2.5.5.1.1.1.1.1.1.1.1.2.1.1.1.2.cmml" xref="A1.Ex3.m2.5.5.1.1.1.1.1.1.1.1.2.1.1.1.2">
                   <csymbol cd="ambiguous" id="A1.Ex3.m2.5.5.1.1.1.1.1.1.1.1.2.1.1.1.2.1.cmml" xref="A1.Ex3.m2.5.5.1.1.1.1.1.1.1.1.2.1.1.1.2">
                    superscript
                   </csymbol>
                   <ci id="A1.Ex3.m2.5.5.1.1.1.1.1.1.1.1.2.1.1.1.2.2.cmml" xref="A1.Ex3.m2.5.5.1.1.1.1.1.1.1.1.2.1.1.1.2.2">
                    𝑎
                   </ci>
                   <ci id="A1.Ex3.m2.5.5.1.1.1.1.1.1.1.1.2.1.1.1.2.3.cmml" xref="A1.Ex3.m2.5.5.1.1.1.1.1.1.1.1.2.1.1.1.2.3">
                    ′
                   </ci>
                  </apply>
                  <apply id="A1.Ex3.m2.5.5.1.1.1.1.1.1.1.1.2.1.1.1.3.cmml" xref="A1.Ex3.m2.5.5.1.1.1.1.1.1.1.1.2.1.1.1.3">
                   <csymbol cd="ambiguous" id="A1.Ex3.m2.5.5.1.1.1.1.1.1.1.1.2.1.1.1.3.1.cmml" xref="A1.Ex3.m2.5.5.1.1.1.1.1.1.1.1.2.1.1.1.3">
                    superscript
                   </csymbol>
                   <ci id="A1.Ex3.m2.5.5.1.1.1.1.1.1.1.1.2.1.1.1.3.2.cmml" xref="A1.Ex3.m2.5.5.1.1.1.1.1.1.1.1.2.1.1.1.3.2">
                    𝑠
                   </ci>
                   <ci id="A1.Ex3.m2.5.5.1.1.1.1.1.1.1.1.2.1.1.1.3.3.cmml" xref="A1.Ex3.m2.5.5.1.1.1.1.1.1.1.1.2.1.1.1.3.3">
                    ′
                   </ci>
                  </apply>
                 </apply>
                </apply>
               </apply>
              </apply>
             </apply>
            </apply>
           </apply>
          </apply>
         </annotation-xml>
         <annotation encoding="application/x-tex" id="A1.Ex3.m2.5c">
          \displaystyle=\mathbb{E}_{a\sim\pi^{*}(s)}\Big{[}r(s,a)+\gamma(\mathbb{E}_{a^{\prime}\sim\pi^{*}(s^{\prime})}[Q(s^{\prime},a^{\prime})]-\beta\text{KL}(a^{\prime}|s^{\prime}))\Big{]}
         </annotation>
        </semantics>
       </math>
      </td>
      <td class="ltx_eqn_cell ltx_eqn_center_padright">
      </td>
     </tr>
    </tbody>
    <tbody id="A1.E11">
     <tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
      <td class="ltx_eqn_cell ltx_eqn_center_padleft">
      </td>
      <td class="ltx_td ltx_eqn_cell">
      </td>
      <td class="ltx_td ltx_align_left ltx_eqn_cell">
       <math alttext="\displaystyle=\mathbb{E}_{a\sim\pi^{*}(s)}[r(s,a)]+\gamma\mathbb{E}_{a\sim\pi^{*}(s),s^{\prime}\sim\mathcal{T}(s,a),a^{\prime}\sim\pi^{*}(s^{\prime})}[Q(s^{\prime},a^{\prime})]-\gamma\beta\mathbb{E}_{a\sim\pi^{*}(s),s^{\prime}\sim\mathcal{T}(s,a)}[\text{KL}(a^{\prime}|s^{\prime})]." class="ltx_Math" display="inline" id="A1.E11.m1.14">
        <semantics id="A1.E11.m1.14a">
         <mrow id="A1.E11.m1.14.14.1" xref="A1.E11.m1.14.14.1.1.cmml">
          <mrow id="A1.E11.m1.14.14.1.1" xref="A1.E11.m1.14.14.1.1.cmml">
           <mi id="A1.E11.m1.14.14.1.1.5" xref="A1.E11.m1.14.14.1.1.5.cmml">
           </mi>
           <mo id="A1.E11.m1.14.14.1.1.4" xref="A1.E11.m1.14.14.1.1.4.cmml">
            =
           </mo>
           <mrow id="A1.E11.m1.14.14.1.1.3" xref="A1.E11.m1.14.14.1.1.3.cmml">
            <mrow id="A1.E11.m1.14.14.1.1.2.2" xref="A1.E11.m1.14.14.1.1.2.2.cmml">
             <mrow id="A1.E11.m1.14.14.1.1.1.1.1" xref="A1.E11.m1.14.14.1.1.1.1.1.cmml">
              <msub id="A1.E11.m1.14.14.1.1.1.1.1.3" xref="A1.E11.m1.14.14.1.1.1.1.1.3.cmml">
               <mi id="A1.E11.m1.14.14.1.1.1.1.1.3.2" xref="A1.E11.m1.14.14.1.1.1.1.1.3.2.cmml">
                𝔼
               </mi>
               <mrow id="A1.E11.m1.1.1.1" xref="A1.E11.m1.1.1.1.cmml">
                <mi id="A1.E11.m1.1.1.1.3" xref="A1.E11.m1.1.1.1.3.cmml">
                 a
                </mi>
                <mo id="A1.E11.m1.1.1.1.2" xref="A1.E11.m1.1.1.1.2.cmml">
                 ∼
                </mo>
                <mrow id="A1.E11.m1.1.1.1.4" xref="A1.E11.m1.1.1.1.4.cmml">
                 <msup id="A1.E11.m1.1.1.1.4.2" xref="A1.E11.m1.1.1.1.4.2.cmml">
                  <mi id="A1.E11.m1.1.1.1.4.2.2" xref="A1.E11.m1.1.1.1.4.2.2.cmml">
                   π
                  </mi>
                  <mo id="A1.E11.m1.1.1.1.4.2.3" xref="A1.E11.m1.1.1.1.4.2.3.cmml">
                   ∗
                  </mo>
                 </msup>
                 <mo id="A1.E11.m1.1.1.1.4.1" lspace="0em" rspace="0em" xref="A1.E11.m1.1.1.1.4.1.cmml">
                  ​
                 </mo>
                 <mrow id="A1.E11.m1.1.1.1.4.3.2" xref="A1.E11.m1.1.1.1.4.cmml">
                  <mo id="A1.E11.m1.1.1.1.4.3.2.1" stretchy="false" xref="A1.E11.m1.1.1.1.4.cmml">
                   (
                  </mo>
                  <mi id="A1.E11.m1.1.1.1.1" xref="A1.E11.m1.1.1.1.1.cmml">
                   s
                  </mi>
                  <mo id="A1.E11.m1.1.1.1.4.3.2.2" stretchy="false" xref="A1.E11.m1.1.1.1.4.cmml">
                   )
                  </mo>
                 </mrow>
                </mrow>
               </mrow>
              </msub>
              <mo id="A1.E11.m1.14.14.1.1.1.1.1.2" lspace="0em" rspace="0em" xref="A1.E11.m1.14.14.1.1.1.1.1.2.cmml">
               ​
              </mo>
              <mrow id="A1.E11.m1.14.14.1.1.1.1.1.1.1" xref="A1.E11.m1.14.14.1.1.1.1.1.1.2.cmml">
               <mo id="A1.E11.m1.14.14.1.1.1.1.1.1.1.2" stretchy="false" xref="A1.E11.m1.14.14.1.1.1.1.1.1.2.1.cmml">
                [
               </mo>
               <mrow id="A1.E11.m1.14.14.1.1.1.1.1.1.1.1" xref="A1.E11.m1.14.14.1.1.1.1.1.1.1.1.cmml">
                <mi id="A1.E11.m1.14.14.1.1.1.1.1.1.1.1.2" xref="A1.E11.m1.14.14.1.1.1.1.1.1.1.1.2.cmml">
                 r
                </mi>
                <mo id="A1.E11.m1.14.14.1.1.1.1.1.1.1.1.1" lspace="0em" rspace="0em" xref="A1.E11.m1.14.14.1.1.1.1.1.1.1.1.1.cmml">
                 ​
                </mo>
                <mrow id="A1.E11.m1.14.14.1.1.1.1.1.1.1.1.3.2" xref="A1.E11.m1.14.14.1.1.1.1.1.1.1.1.3.1.cmml">
                 <mo id="A1.E11.m1.14.14.1.1.1.1.1.1.1.1.3.2.1" stretchy="false" xref="A1.E11.m1.14.14.1.1.1.1.1.1.1.1.3.1.cmml">
                  (
                 </mo>
                 <mi id="A1.E11.m1.12.12" xref="A1.E11.m1.12.12.cmml">
                  s
                 </mi>
                 <mo id="A1.E11.m1.14.14.1.1.1.1.1.1.1.1.3.2.2" xref="A1.E11.m1.14.14.1.1.1.1.1.1.1.1.3.1.cmml">
                  ,
                 </mo>
                 <mi id="A1.E11.m1.13.13" xref="A1.E11.m1.13.13.cmml">
                  a
                 </mi>
                 <mo id="A1.E11.m1.14.14.1.1.1.1.1.1.1.1.3.2.3" stretchy="false" xref="A1.E11.m1.14.14.1.1.1.1.1.1.1.1.3.1.cmml">
                  )
                 </mo>
                </mrow>
               </mrow>
               <mo id="A1.E11.m1.14.14.1.1.1.1.1.1.1.3" stretchy="false" xref="A1.E11.m1.14.14.1.1.1.1.1.1.2.1.cmml">
                ]
               </mo>
              </mrow>
             </mrow>
             <mo id="A1.E11.m1.14.14.1.1.2.2.3" xref="A1.E11.m1.14.14.1.1.2.2.3.cmml">
              +
             </mo>
             <mrow id="A1.E11.m1.14.14.1.1.2.2.2" xref="A1.E11.m1.14.14.1.1.2.2.2.cmml">
              <mi id="A1.E11.m1.14.14.1.1.2.2.2.3" xref="A1.E11.m1.14.14.1.1.2.2.2.3.cmml">
               γ
              </mi>
              <mo id="A1.E11.m1.14.14.1.1.2.2.2.2" lspace="0em" rspace="0em" xref="A1.E11.m1.14.14.1.1.2.2.2.2.cmml">
               ​
              </mo>
              <msub id="A1.E11.m1.14.14.1.1.2.2.2.4" xref="A1.E11.m1.14.14.1.1.2.2.2.4.cmml">
               <mi id="A1.E11.m1.14.14.1.1.2.2.2.4.2" xref="A1.E11.m1.14.14.1.1.2.2.2.4.2.cmml">
                𝔼
               </mi>
               <mrow id="A1.E11.m1.6.6.5.5" xref="A1.E11.m1.6.6.5.6.cmml">
                <mrow id="A1.E11.m1.5.5.4.4.1" xref="A1.E11.m1.5.5.4.4.1.cmml">
                 <mi id="A1.E11.m1.5.5.4.4.1.2" xref="A1.E11.m1.5.5.4.4.1.2.cmml">
                  a
                 </mi>
                 <mo id="A1.E11.m1.5.5.4.4.1.1" xref="A1.E11.m1.5.5.4.4.1.1.cmml">
                  ∼
                 </mo>
                 <mrow id="A1.E11.m1.5.5.4.4.1.3" xref="A1.E11.m1.5.5.4.4.1.3.cmml">
                  <msup id="A1.E11.m1.5.5.4.4.1.3.2" xref="A1.E11.m1.5.5.4.4.1.3.2.cmml">
                   <mi id="A1.E11.m1.5.5.4.4.1.3.2.2" xref="A1.E11.m1.5.5.4.4.1.3.2.2.cmml">
                    π
                   </mi>
                   <mo id="A1.E11.m1.5.5.4.4.1.3.2.3" xref="A1.E11.m1.5.5.4.4.1.3.2.3.cmml">
                    ∗
                   </mo>
                  </msup>
                  <mo id="A1.E11.m1.5.5.4.4.1.3.1" lspace="0em" rspace="0em" xref="A1.E11.m1.5.5.4.4.1.3.1.cmml">
                   ​
                  </mo>
                  <mrow id="A1.E11.m1.5.5.4.4.1.3.3.2" xref="A1.E11.m1.5.5.4.4.1.3.cmml">
                   <mo id="A1.E11.m1.5.5.4.4.1.3.3.2.1" stretchy="false" xref="A1.E11.m1.5.5.4.4.1.3.cmml">
                    (
                   </mo>
                   <mi id="A1.E11.m1.2.2.1.1" xref="A1.E11.m1.2.2.1.1.cmml">
                    s
                   </mi>
                   <mo id="A1.E11.m1.5.5.4.4.1.3.3.2.2" stretchy="false" xref="A1.E11.m1.5.5.4.4.1.3.cmml">
                    )
                   </mo>
                  </mrow>
                 </mrow>
                </mrow>
                <mo id="A1.E11.m1.6.6.5.5.3" xref="A1.E11.m1.6.6.5.6a.cmml">
                 ,
                </mo>
                <mrow id="A1.E11.m1.6.6.5.5.2.2" xref="A1.E11.m1.6.6.5.5.2.3.cmml">
                 <mrow id="A1.E11.m1.6.6.5.5.2.1.1" xref="A1.E11.m1.6.6.5.5.2.1.1.cmml">
                  <msup id="A1.E11.m1.6.6.5.5.2.1.1.2" xref="A1.E11.m1.6.6.5.5.2.1.1.2.cmml">
                   <mi id="A1.E11.m1.6.6.5.5.2.1.1.2.2" xref="A1.E11.m1.6.6.5.5.2.1.1.2.2.cmml">
                    s
                   </mi>
                   <mo id="A1.E11.m1.6.6.5.5.2.1.1.2.3" xref="A1.E11.m1.6.6.5.5.2.1.1.2.3.cmml">
                    ′
                   </mo>
                  </msup>
                  <mo id="A1.E11.m1.6.6.5.5.2.1.1.1" xref="A1.E11.m1.6.6.5.5.2.1.1.1.cmml">
                   ∼
                  </mo>
                  <mrow id="A1.E11.m1.6.6.5.5.2.1.1.3" xref="A1.E11.m1.6.6.5.5.2.1.1.3.cmml">
                   <mi class="ltx_font_mathcaligraphic" id="A1.E11.m1.6.6.5.5.2.1.1.3.2" xref="A1.E11.m1.6.6.5.5.2.1.1.3.2.cmml">
                    𝒯
                   </mi>
                   <mo id="A1.E11.m1.6.6.5.5.2.1.1.3.1" lspace="0em" rspace="0em" xref="A1.E11.m1.6.6.5.5.2.1.1.3.1.cmml">
                    ​
                   </mo>
                   <mrow id="A1.E11.m1.6.6.5.5.2.1.1.3.3.2" xref="A1.E11.m1.6.6.5.5.2.1.1.3.3.1.cmml">
                    <mo id="A1.E11.m1.6.6.5.5.2.1.1.3.3.2.1" stretchy="false" xref="A1.E11.m1.6.6.5.5.2.1.1.3.3.1.cmml">
                     (
                    </mo>
                    <mi id="A1.E11.m1.3.3.2.2" xref="A1.E11.m1.3.3.2.2.cmml">
                     s
                    </mi>
                    <mo id="A1.E11.m1.6.6.5.5.2.1.1.3.3.2.2" xref="A1.E11.m1.6.6.5.5.2.1.1.3.3.1.cmml">
                     ,
                    </mo>
                    <mi id="A1.E11.m1.4.4.3.3" xref="A1.E11.m1.4.4.3.3.cmml">
                     a
                    </mi>
                    <mo id="A1.E11.m1.6.6.5.5.2.1.1.3.3.2.3" stretchy="false" xref="A1.E11.m1.6.6.5.5.2.1.1.3.3.1.cmml">
                     )
                    </mo>
                   </mrow>
                  </mrow>
                 </mrow>
                 <mo id="A1.E11.m1.6.6.5.5.2.2.3" xref="A1.E11.m1.6.6.5.5.2.3a.cmml">
                  ,
                 </mo>
                 <mrow id="A1.E11.m1.6.6.5.5.2.2.2" xref="A1.E11.m1.6.6.5.5.2.2.2.cmml">
                  <msup id="A1.E11.m1.6.6.5.5.2.2.2.3" xref="A1.E11.m1.6.6.5.5.2.2.2.3.cmml">
                   <mi id="A1.E11.m1.6.6.5.5.2.2.2.3.2" xref="A1.E11.m1.6.6.5.5.2.2.2.3.2.cmml">
                    a
                   </mi>
                   <mo id="A1.E11.m1.6.6.5.5.2.2.2.3.3" xref="A1.E11.m1.6.6.5.5.2.2.2.3.3.cmml">
                    ′
                   </mo>
                  </msup>
                  <mo id="A1.E11.m1.6.6.5.5.2.2.2.2" xref="A1.E11.m1.6.6.5.5.2.2.2.2.cmml">
                   ∼
                  </mo>
                  <mrow id="A1.E11.m1.6.6.5.5.2.2.2.1" xref="A1.E11.m1.6.6.5.5.2.2.2.1.cmml">
                   <msup id="A1.E11.m1.6.6.5.5.2.2.2.1.3" xref="A1.E11.m1.6.6.5.5.2.2.2.1.3.cmml">
                    <mi id="A1.E11.m1.6.6.5.5.2.2.2.1.3.2" xref="A1.E11.m1.6.6.5.5.2.2.2.1.3.2.cmml">
                     π
                    </mi>
                    <mo id="A1.E11.m1.6.6.5.5.2.2.2.1.3.3" xref="A1.E11.m1.6.6.5.5.2.2.2.1.3.3.cmml">
                     ∗
                    </mo>
                   </msup>
                   <mo id="A1.E11.m1.6.6.5.5.2.2.2.1.2" lspace="0em" rspace="0em" xref="A1.E11.m1.6.6.5.5.2.2.2.1.2.cmml">
                    ​
                   </mo>
                   <mrow id="A1.E11.m1.6.6.5.5.2.2.2.1.1.1" xref="A1.E11.m1.6.6.5.5.2.2.2.1.1.1.1.cmml">
                    <mo id="A1.E11.m1.6.6.5.5.2.2.2.1.1.1.2" stretchy="false" xref="A1.E11.m1.6.6.5.5.2.2.2.1.1.1.1.cmml">
                     (
                    </mo>
                    <msup id="A1.E11.m1.6.6.5.5.2.2.2.1.1.1.1" xref="A1.E11.m1.6.6.5.5.2.2.2.1.1.1.1.cmml">
                     <mi id="A1.E11.m1.6.6.5.5.2.2.2.1.1.1.1.2" xref="A1.E11.m1.6.6.5.5.2.2.2.1.1.1.1.2.cmml">
                      s
                     </mi>
                     <mo id="A1.E11.m1.6.6.5.5.2.2.2.1.1.1.1.3" xref="A1.E11.m1.6.6.5.5.2.2.2.1.1.1.1.3.cmml">
                      ′
                     </mo>
                    </msup>
                    <mo id="A1.E11.m1.6.6.5.5.2.2.2.1.1.1.3" stretchy="false" xref="A1.E11.m1.6.6.5.5.2.2.2.1.1.1.1.cmml">
                     )
                    </mo>
                   </mrow>
                  </mrow>
                 </mrow>
                </mrow>
               </mrow>
              </msub>
              <mo id="A1.E11.m1.14.14.1.1.2.2.2.2a" lspace="0em" rspace="0em" xref="A1.E11.m1.14.14.1.1.2.2.2.2.cmml">
               ​
              </mo>
              <mrow id="A1.E11.m1.14.14.1.1.2.2.2.1.1" xref="A1.E11.m1.14.14.1.1.2.2.2.1.2.cmml">
               <mo id="A1.E11.m1.14.14.1.1.2.2.2.1.1.2" stretchy="false" xref="A1.E11.m1.14.14.1.1.2.2.2.1.2.1.cmml">
                [
               </mo>
               <mrow id="A1.E11.m1.14.14.1.1.2.2.2.1.1.1" xref="A1.E11.m1.14.14.1.1.2.2.2.1.1.1.cmml">
                <mi id="A1.E11.m1.14.14.1.1.2.2.2.1.1.1.4" xref="A1.E11.m1.14.14.1.1.2.2.2.1.1.1.4.cmml">
                 Q
                </mi>
                <mo id="A1.E11.m1.14.14.1.1.2.2.2.1.1.1.3" lspace="0em" rspace="0em" xref="A1.E11.m1.14.14.1.1.2.2.2.1.1.1.3.cmml">
                 ​
                </mo>
                <mrow id="A1.E11.m1.14.14.1.1.2.2.2.1.1.1.2.2" xref="A1.E11.m1.14.14.1.1.2.2.2.1.1.1.2.3.cmml">
                 <mo id="A1.E11.m1.14.14.1.1.2.2.2.1.1.1.2.2.3" stretchy="false" xref="A1.E11.m1.14.14.1.1.2.2.2.1.1.1.2.3.cmml">
                  (
                 </mo>
                 <msup id="A1.E11.m1.14.14.1.1.2.2.2.1.1.1.1.1.1" xref="A1.E11.m1.14.14.1.1.2.2.2.1.1.1.1.1.1.cmml">
                  <mi id="A1.E11.m1.14.14.1.1.2.2.2.1.1.1.1.1.1.2" xref="A1.E11.m1.14.14.1.1.2.2.2.1.1.1.1.1.1.2.cmml">
                   s
                  </mi>
                  <mo id="A1.E11.m1.14.14.1.1.2.2.2.1.1.1.1.1.1.3" xref="A1.E11.m1.14.14.1.1.2.2.2.1.1.1.1.1.1.3.cmml">
                   ′
                  </mo>
                 </msup>
                 <mo id="A1.E11.m1.14.14.1.1.2.2.2.1.1.1.2.2.4" xref="A1.E11.m1.14.14.1.1.2.2.2.1.1.1.2.3.cmml">
                  ,
                 </mo>
                 <msup id="A1.E11.m1.14.14.1.1.2.2.2.1.1.1.2.2.2" xref="A1.E11.m1.14.14.1.1.2.2.2.1.1.1.2.2.2.cmml">
                  <mi id="A1.E11.m1.14.14.1.1.2.2.2.1.1.1.2.2.2.2" xref="A1.E11.m1.14.14.1.1.2.2.2.1.1.1.2.2.2.2.cmml">
                   a
                  </mi>
                  <mo id="A1.E11.m1.14.14.1.1.2.2.2.1.1.1.2.2.2.3" xref="A1.E11.m1.14.14.1.1.2.2.2.1.1.1.2.2.2.3.cmml">
                   ′
                  </mo>
                 </msup>
                 <mo id="A1.E11.m1.14.14.1.1.2.2.2.1.1.1.2.2.5" stretchy="false" xref="A1.E11.m1.14.14.1.1.2.2.2.1.1.1.2.3.cmml">
                  )
                 </mo>
                </mrow>
               </mrow>
               <mo id="A1.E11.m1.14.14.1.1.2.2.2.1.1.3" stretchy="false" xref="A1.E11.m1.14.14.1.1.2.2.2.1.2.1.cmml">
                ]
               </mo>
              </mrow>
             </mrow>
            </mrow>
            <mo id="A1.E11.m1.14.14.1.1.3.4" xref="A1.E11.m1.14.14.1.1.3.4.cmml">
             −
            </mo>
            <mrow id="A1.E11.m1.14.14.1.1.3.3" xref="A1.E11.m1.14.14.1.1.3.3.cmml">
             <mi id="A1.E11.m1.14.14.1.1.3.3.3" xref="A1.E11.m1.14.14.1.1.3.3.3.cmml">
              γ
             </mi>
             <mo id="A1.E11.m1.14.14.1.1.3.3.2" lspace="0em" rspace="0em" xref="A1.E11.m1.14.14.1.1.3.3.2.cmml">
              ​
             </mo>
             <mi id="A1.E11.m1.14.14.1.1.3.3.4" xref="A1.E11.m1.14.14.1.1.3.3.4.cmml">
              β
             </mi>
             <mo id="A1.E11.m1.14.14.1.1.3.3.2a" lspace="0em" rspace="0em" xref="A1.E11.m1.14.14.1.1.3.3.2.cmml">
              ​
             </mo>
             <msub id="A1.E11.m1.14.14.1.1.3.3.5" xref="A1.E11.m1.14.14.1.1.3.3.5.cmml">
              <mi id="A1.E11.m1.14.14.1.1.3.3.5.2" xref="A1.E11.m1.14.14.1.1.3.3.5.2.cmml">
               𝔼
              </mi>
              <mrow id="A1.E11.m1.11.11.5.5" xref="A1.E11.m1.11.11.5.6.cmml">
               <mrow id="A1.E11.m1.10.10.4.4.1" xref="A1.E11.m1.10.10.4.4.1.cmml">
                <mi id="A1.E11.m1.10.10.4.4.1.2" xref="A1.E11.m1.10.10.4.4.1.2.cmml">
                 a
                </mi>
                <mo id="A1.E11.m1.10.10.4.4.1.1" xref="A1.E11.m1.10.10.4.4.1.1.cmml">
                 ∼
                </mo>
                <mrow id="A1.E11.m1.10.10.4.4.1.3" xref="A1.E11.m1.10.10.4.4.1.3.cmml">
                 <msup id="A1.E11.m1.10.10.4.4.1.3.2" xref="A1.E11.m1.10.10.4.4.1.3.2.cmml">
                  <mi id="A1.E11.m1.10.10.4.4.1.3.2.2" xref="A1.E11.m1.10.10.4.4.1.3.2.2.cmml">
                   π
                  </mi>
                  <mo id="A1.E11.m1.10.10.4.4.1.3.2.3" xref="A1.E11.m1.10.10.4.4.1.3.2.3.cmml">
                   ∗
                  </mo>
                 </msup>
                 <mo id="A1.E11.m1.10.10.4.4.1.3.1" lspace="0em" rspace="0em" xref="A1.E11.m1.10.10.4.4.1.3.1.cmml">
                  ​
                 </mo>
                 <mrow id="A1.E11.m1.10.10.4.4.1.3.3.2" xref="A1.E11.m1.10.10.4.4.1.3.cmml">
                  <mo id="A1.E11.m1.10.10.4.4.1.3.3.2.1" stretchy="false" xref="A1.E11.m1.10.10.4.4.1.3.cmml">
                   (
                  </mo>
                  <mi id="A1.E11.m1.7.7.1.1" xref="A1.E11.m1.7.7.1.1.cmml">
                   s
                  </mi>
                  <mo id="A1.E11.m1.10.10.4.4.1.3.3.2.2" stretchy="false" xref="A1.E11.m1.10.10.4.4.1.3.cmml">
                   )
                  </mo>
                 </mrow>
                </mrow>
               </mrow>
               <mo id="A1.E11.m1.11.11.5.5.3" xref="A1.E11.m1.11.11.5.6a.cmml">
                ,
               </mo>
               <mrow id="A1.E11.m1.11.11.5.5.2" xref="A1.E11.m1.11.11.5.5.2.cmml">
                <msup id="A1.E11.m1.11.11.5.5.2.2" xref="A1.E11.m1.11.11.5.5.2.2.cmml">
                 <mi id="A1.E11.m1.11.11.5.5.2.2.2" xref="A1.E11.m1.11.11.5.5.2.2.2.cmml">
                  s
                 </mi>
                 <mo id="A1.E11.m1.11.11.5.5.2.2.3" xref="A1.E11.m1.11.11.5.5.2.2.3.cmml">
                  ′
                 </mo>
                </msup>
                <mo id="A1.E11.m1.11.11.5.5.2.1" xref="A1.E11.m1.11.11.5.5.2.1.cmml">
                 ∼
                </mo>
                <mrow id="A1.E11.m1.11.11.5.5.2.3" xref="A1.E11.m1.11.11.5.5.2.3.cmml">
                 <mi class="ltx_font_mathcaligraphic" id="A1.E11.m1.11.11.5.5.2.3.2" xref="A1.E11.m1.11.11.5.5.2.3.2.cmml">
                  𝒯
                 </mi>
                 <mo id="A1.E11.m1.11.11.5.5.2.3.1" lspace="0em" rspace="0em" xref="A1.E11.m1.11.11.5.5.2.3.1.cmml">
                  ​
                 </mo>
                 <mrow id="A1.E11.m1.11.11.5.5.2.3.3.2" xref="A1.E11.m1.11.11.5.5.2.3.3.1.cmml">
                  <mo id="A1.E11.m1.11.11.5.5.2.3.3.2.1" stretchy="false" xref="A1.E11.m1.11.11.5.5.2.3.3.1.cmml">
                   (
                  </mo>
                  <mi id="A1.E11.m1.8.8.2.2" xref="A1.E11.m1.8.8.2.2.cmml">
                   s
                  </mi>
                  <mo id="A1.E11.m1.11.11.5.5.2.3.3.2.2" xref="A1.E11.m1.11.11.5.5.2.3.3.1.cmml">
                   ,
                  </mo>
                  <mi id="A1.E11.m1.9.9.3.3" xref="A1.E11.m1.9.9.3.3.cmml">
                   a
                  </mi>
                  <mo id="A1.E11.m1.11.11.5.5.2.3.3.2.3" stretchy="false" xref="A1.E11.m1.11.11.5.5.2.3.3.1.cmml">
                   )
                  </mo>
                 </mrow>
                </mrow>
               </mrow>
              </mrow>
             </msub>
             <mo id="A1.E11.m1.14.14.1.1.3.3.2b" lspace="0em" rspace="0em" xref="A1.E11.m1.14.14.1.1.3.3.2.cmml">
              ​
             </mo>
             <mrow id="A1.E11.m1.14.14.1.1.3.3.1.1" xref="A1.E11.m1.14.14.1.1.3.3.1.2.cmml">
              <mo id="A1.E11.m1.14.14.1.1.3.3.1.1.2" stretchy="false" xref="A1.E11.m1.14.14.1.1.3.3.1.2.1.cmml">
               [
              </mo>
              <mrow id="A1.E11.m1.14.14.1.1.3.3.1.1.1" xref="A1.E11.m1.14.14.1.1.3.3.1.1.1.cmml">
               <mtext id="A1.E11.m1.14.14.1.1.3.3.1.1.1.3" xref="A1.E11.m1.14.14.1.1.3.3.1.1.1.3a.cmml">
                KL
               </mtext>
               <mo id="A1.E11.m1.14.14.1.1.3.3.1.1.1.2" lspace="0em" rspace="0em" xref="A1.E11.m1.14.14.1.1.3.3.1.1.1.2.cmml">
                ​
               </mo>
               <mrow id="A1.E11.m1.14.14.1.1.3.3.1.1.1.1.1" xref="A1.E11.m1.14.14.1.1.3.3.1.1.1.1.1.1.cmml">
                <mo id="A1.E11.m1.14.14.1.1.3.3.1.1.1.1.1.2" stretchy="false" xref="A1.E11.m1.14.14.1.1.3.3.1.1.1.1.1.1.cmml">
                 (
                </mo>
                <mrow id="A1.E11.m1.14.14.1.1.3.3.1.1.1.1.1.1" xref="A1.E11.m1.14.14.1.1.3.3.1.1.1.1.1.1.cmml">
                 <msup id="A1.E11.m1.14.14.1.1.3.3.1.1.1.1.1.1.2" xref="A1.E11.m1.14.14.1.1.3.3.1.1.1.1.1.1.2.cmml">
                  <mi id="A1.E11.m1.14.14.1.1.3.3.1.1.1.1.1.1.2.2" xref="A1.E11.m1.14.14.1.1.3.3.1.1.1.1.1.1.2.2.cmml">
                   a
                  </mi>
                  <mo id="A1.E11.m1.14.14.1.1.3.3.1.1.1.1.1.1.2.3" xref="A1.E11.m1.14.14.1.1.3.3.1.1.1.1.1.1.2.3.cmml">
                   ′
                  </mo>
                 </msup>
                 <mo fence="false" id="A1.E11.m1.14.14.1.1.3.3.1.1.1.1.1.1.1" xref="A1.E11.m1.14.14.1.1.3.3.1.1.1.1.1.1.1.cmml">
                  |
                 </mo>
                 <msup id="A1.E11.m1.14.14.1.1.3.3.1.1.1.1.1.1.3" xref="A1.E11.m1.14.14.1.1.3.3.1.1.1.1.1.1.3.cmml">
                  <mi id="A1.E11.m1.14.14.1.1.3.3.1.1.1.1.1.1.3.2" xref="A1.E11.m1.14.14.1.1.3.3.1.1.1.1.1.1.3.2.cmml">
                   s
                  </mi>
                  <mo id="A1.E11.m1.14.14.1.1.3.3.1.1.1.1.1.1.3.3" xref="A1.E11.m1.14.14.1.1.3.3.1.1.1.1.1.1.3.3.cmml">
                   ′
                  </mo>
                 </msup>
                </mrow>
                <mo id="A1.E11.m1.14.14.1.1.3.3.1.1.1.1.1.3" stretchy="false" xref="A1.E11.m1.14.14.1.1.3.3.1.1.1.1.1.1.cmml">
                 )
                </mo>
               </mrow>
              </mrow>
              <mo id="A1.E11.m1.14.14.1.1.3.3.1.1.3" stretchy="false" xref="A1.E11.m1.14.14.1.1.3.3.1.2.1.cmml">
               ]
              </mo>
             </mrow>
            </mrow>
           </mrow>
          </mrow>
          <mo id="A1.E11.m1.14.14.1.2" lspace="0em" xref="A1.E11.m1.14.14.1.1.cmml">
           .
          </mo>
         </mrow>
         <annotation-xml encoding="MathML-Content" id="A1.E11.m1.14b">
          <apply id="A1.E11.m1.14.14.1.1.cmml" xref="A1.E11.m1.14.14.1">
           <eq id="A1.E11.m1.14.14.1.1.4.cmml" xref="A1.E11.m1.14.14.1.1.4">
           </eq>
           <csymbol cd="latexml" id="A1.E11.m1.14.14.1.1.5.cmml" xref="A1.E11.m1.14.14.1.1.5">
            absent
           </csymbol>
           <apply id="A1.E11.m1.14.14.1.1.3.cmml" xref="A1.E11.m1.14.14.1.1.3">
            <minus id="A1.E11.m1.14.14.1.1.3.4.cmml" xref="A1.E11.m1.14.14.1.1.3.4">
            </minus>
            <apply id="A1.E11.m1.14.14.1.1.2.2.cmml" xref="A1.E11.m1.14.14.1.1.2.2">
             <plus id="A1.E11.m1.14.14.1.1.2.2.3.cmml" xref="A1.E11.m1.14.14.1.1.2.2.3">
             </plus>
             <apply id="A1.E11.m1.14.14.1.1.1.1.1.cmml" xref="A1.E11.m1.14.14.1.1.1.1.1">
              <times id="A1.E11.m1.14.14.1.1.1.1.1.2.cmml" xref="A1.E11.m1.14.14.1.1.1.1.1.2">
              </times>
              <apply id="A1.E11.m1.14.14.1.1.1.1.1.3.cmml" xref="A1.E11.m1.14.14.1.1.1.1.1.3">
               <csymbol cd="ambiguous" id="A1.E11.m1.14.14.1.1.1.1.1.3.1.cmml" xref="A1.E11.m1.14.14.1.1.1.1.1.3">
                subscript
               </csymbol>
               <ci id="A1.E11.m1.14.14.1.1.1.1.1.3.2.cmml" xref="A1.E11.m1.14.14.1.1.1.1.1.3.2">
                𝔼
               </ci>
               <apply id="A1.E11.m1.1.1.1.cmml" xref="A1.E11.m1.1.1.1">
                <csymbol cd="latexml" id="A1.E11.m1.1.1.1.2.cmml" xref="A1.E11.m1.1.1.1.2">
                 similar-to
                </csymbol>
                <ci id="A1.E11.m1.1.1.1.3.cmml" xref="A1.E11.m1.1.1.1.3">
                 𝑎
                </ci>
                <apply id="A1.E11.m1.1.1.1.4.cmml" xref="A1.E11.m1.1.1.1.4">
                 <times id="A1.E11.m1.1.1.1.4.1.cmml" xref="A1.E11.m1.1.1.1.4.1">
                 </times>
                 <apply id="A1.E11.m1.1.1.1.4.2.cmml" xref="A1.E11.m1.1.1.1.4.2">
                  <csymbol cd="ambiguous" id="A1.E11.m1.1.1.1.4.2.1.cmml" xref="A1.E11.m1.1.1.1.4.2">
                   superscript
                  </csymbol>
                  <ci id="A1.E11.m1.1.1.1.4.2.2.cmml" xref="A1.E11.m1.1.1.1.4.2.2">
                   𝜋
                  </ci>
                  <times id="A1.E11.m1.1.1.1.4.2.3.cmml" xref="A1.E11.m1.1.1.1.4.2.3">
                  </times>
                 </apply>
                 <ci id="A1.E11.m1.1.1.1.1.cmml" xref="A1.E11.m1.1.1.1.1">
                  𝑠
                 </ci>
                </apply>
               </apply>
              </apply>
              <apply id="A1.E11.m1.14.14.1.1.1.1.1.1.2.cmml" xref="A1.E11.m1.14.14.1.1.1.1.1.1.1">
               <csymbol cd="latexml" id="A1.E11.m1.14.14.1.1.1.1.1.1.2.1.cmml" xref="A1.E11.m1.14.14.1.1.1.1.1.1.1.2">
                delimited-[]
               </csymbol>
               <apply id="A1.E11.m1.14.14.1.1.1.1.1.1.1.1.cmml" xref="A1.E11.m1.14.14.1.1.1.1.1.1.1.1">
                <times id="A1.E11.m1.14.14.1.1.1.1.1.1.1.1.1.cmml" xref="A1.E11.m1.14.14.1.1.1.1.1.1.1.1.1">
                </times>
                <ci id="A1.E11.m1.14.14.1.1.1.1.1.1.1.1.2.cmml" xref="A1.E11.m1.14.14.1.1.1.1.1.1.1.1.2">
                 𝑟
                </ci>
                <interval closure="open" id="A1.E11.m1.14.14.1.1.1.1.1.1.1.1.3.1.cmml" xref="A1.E11.m1.14.14.1.1.1.1.1.1.1.1.3.2">
                 <ci id="A1.E11.m1.12.12.cmml" xref="A1.E11.m1.12.12">
                  𝑠
                 </ci>
                 <ci id="A1.E11.m1.13.13.cmml" xref="A1.E11.m1.13.13">
                  𝑎
                 </ci>
                </interval>
               </apply>
              </apply>
             </apply>
             <apply id="A1.E11.m1.14.14.1.1.2.2.2.cmml" xref="A1.E11.m1.14.14.1.1.2.2.2">
              <times id="A1.E11.m1.14.14.1.1.2.2.2.2.cmml" xref="A1.E11.m1.14.14.1.1.2.2.2.2">
              </times>
              <ci id="A1.E11.m1.14.14.1.1.2.2.2.3.cmml" xref="A1.E11.m1.14.14.1.1.2.2.2.3">
               𝛾
              </ci>
              <apply id="A1.E11.m1.14.14.1.1.2.2.2.4.cmml" xref="A1.E11.m1.14.14.1.1.2.2.2.4">
               <csymbol cd="ambiguous" id="A1.E11.m1.14.14.1.1.2.2.2.4.1.cmml" xref="A1.E11.m1.14.14.1.1.2.2.2.4">
                subscript
               </csymbol>
               <ci id="A1.E11.m1.14.14.1.1.2.2.2.4.2.cmml" xref="A1.E11.m1.14.14.1.1.2.2.2.4.2">
                𝔼
               </ci>
               <apply id="A1.E11.m1.6.6.5.6.cmml" xref="A1.E11.m1.6.6.5.5">
                <csymbol cd="ambiguous" id="A1.E11.m1.6.6.5.6a.cmml" xref="A1.E11.m1.6.6.5.5.3">
                 formulae-sequence
                </csymbol>
                <apply id="A1.E11.m1.5.5.4.4.1.cmml" xref="A1.E11.m1.5.5.4.4.1">
                 <csymbol cd="latexml" id="A1.E11.m1.5.5.4.4.1.1.cmml" xref="A1.E11.m1.5.5.4.4.1.1">
                  similar-to
                 </csymbol>
                 <ci id="A1.E11.m1.5.5.4.4.1.2.cmml" xref="A1.E11.m1.5.5.4.4.1.2">
                  𝑎
                 </ci>
                 <apply id="A1.E11.m1.5.5.4.4.1.3.cmml" xref="A1.E11.m1.5.5.4.4.1.3">
                  <times id="A1.E11.m1.5.5.4.4.1.3.1.cmml" xref="A1.E11.m1.5.5.4.4.1.3.1">
                  </times>
                  <apply id="A1.E11.m1.5.5.4.4.1.3.2.cmml" xref="A1.E11.m1.5.5.4.4.1.3.2">
                   <csymbol cd="ambiguous" id="A1.E11.m1.5.5.4.4.1.3.2.1.cmml" xref="A1.E11.m1.5.5.4.4.1.3.2">
                    superscript
                   </csymbol>
                   <ci id="A1.E11.m1.5.5.4.4.1.3.2.2.cmml" xref="A1.E11.m1.5.5.4.4.1.3.2.2">
                    𝜋
                   </ci>
                   <times id="A1.E11.m1.5.5.4.4.1.3.2.3.cmml" xref="A1.E11.m1.5.5.4.4.1.3.2.3">
                   </times>
                  </apply>
                  <ci id="A1.E11.m1.2.2.1.1.cmml" xref="A1.E11.m1.2.2.1.1">
                   𝑠
                  </ci>
                 </apply>
                </apply>
                <apply id="A1.E11.m1.6.6.5.5.2.3.cmml" xref="A1.E11.m1.6.6.5.5.2.2">
                 <csymbol cd="ambiguous" id="A1.E11.m1.6.6.5.5.2.3a.cmml" xref="A1.E11.m1.6.6.5.5.2.2.3">
                  formulae-sequence
                 </csymbol>
                 <apply id="A1.E11.m1.6.6.5.5.2.1.1.cmml" xref="A1.E11.m1.6.6.5.5.2.1.1">
                  <csymbol cd="latexml" id="A1.E11.m1.6.6.5.5.2.1.1.1.cmml" xref="A1.E11.m1.6.6.5.5.2.1.1.1">
                   similar-to
                  </csymbol>
                  <apply id="A1.E11.m1.6.6.5.5.2.1.1.2.cmml" xref="A1.E11.m1.6.6.5.5.2.1.1.2">
                   <csymbol cd="ambiguous" id="A1.E11.m1.6.6.5.5.2.1.1.2.1.cmml" xref="A1.E11.m1.6.6.5.5.2.1.1.2">
                    superscript
                   </csymbol>
                   <ci id="A1.E11.m1.6.6.5.5.2.1.1.2.2.cmml" xref="A1.E11.m1.6.6.5.5.2.1.1.2.2">
                    𝑠
                   </ci>
                   <ci id="A1.E11.m1.6.6.5.5.2.1.1.2.3.cmml" xref="A1.E11.m1.6.6.5.5.2.1.1.2.3">
                    ′
                   </ci>
                  </apply>
                  <apply id="A1.E11.m1.6.6.5.5.2.1.1.3.cmml" xref="A1.E11.m1.6.6.5.5.2.1.1.3">
                   <times id="A1.E11.m1.6.6.5.5.2.1.1.3.1.cmml" xref="A1.E11.m1.6.6.5.5.2.1.1.3.1">
                   </times>
                   <ci id="A1.E11.m1.6.6.5.5.2.1.1.3.2.cmml" xref="A1.E11.m1.6.6.5.5.2.1.1.3.2">
                    𝒯
                   </ci>
                   <interval closure="open" id="A1.E11.m1.6.6.5.5.2.1.1.3.3.1.cmml" xref="A1.E11.m1.6.6.5.5.2.1.1.3.3.2">
                    <ci id="A1.E11.m1.3.3.2.2.cmml" xref="A1.E11.m1.3.3.2.2">
                     𝑠
                    </ci>
                    <ci id="A1.E11.m1.4.4.3.3.cmml" xref="A1.E11.m1.4.4.3.3">
                     𝑎
                    </ci>
                   </interval>
                  </apply>
                 </apply>
                 <apply id="A1.E11.m1.6.6.5.5.2.2.2.cmml" xref="A1.E11.m1.6.6.5.5.2.2.2">
                  <csymbol cd="latexml" id="A1.E11.m1.6.6.5.5.2.2.2.2.cmml" xref="A1.E11.m1.6.6.5.5.2.2.2.2">
                   similar-to
                  </csymbol>
                  <apply id="A1.E11.m1.6.6.5.5.2.2.2.3.cmml" xref="A1.E11.m1.6.6.5.5.2.2.2.3">
                   <csymbol cd="ambiguous" id="A1.E11.m1.6.6.5.5.2.2.2.3.1.cmml" xref="A1.E11.m1.6.6.5.5.2.2.2.3">
                    superscript
                   </csymbol>
                   <ci id="A1.E11.m1.6.6.5.5.2.2.2.3.2.cmml" xref="A1.E11.m1.6.6.5.5.2.2.2.3.2">
                    𝑎
                   </ci>
                   <ci id="A1.E11.m1.6.6.5.5.2.2.2.3.3.cmml" xref="A1.E11.m1.6.6.5.5.2.2.2.3.3">
                    ′
                   </ci>
                  </apply>
                  <apply id="A1.E11.m1.6.6.5.5.2.2.2.1.cmml" xref="A1.E11.m1.6.6.5.5.2.2.2.1">
                   <times id="A1.E11.m1.6.6.5.5.2.2.2.1.2.cmml" xref="A1.E11.m1.6.6.5.5.2.2.2.1.2">
                   </times>
                   <apply id="A1.E11.m1.6.6.5.5.2.2.2.1.3.cmml" xref="A1.E11.m1.6.6.5.5.2.2.2.1.3">
                    <csymbol cd="ambiguous" id="A1.E11.m1.6.6.5.5.2.2.2.1.3.1.cmml" xref="A1.E11.m1.6.6.5.5.2.2.2.1.3">
                     superscript
                    </csymbol>
                    <ci id="A1.E11.m1.6.6.5.5.2.2.2.1.3.2.cmml" xref="A1.E11.m1.6.6.5.5.2.2.2.1.3.2">
                     𝜋
                    </ci>
                    <times id="A1.E11.m1.6.6.5.5.2.2.2.1.3.3.cmml" xref="A1.E11.m1.6.6.5.5.2.2.2.1.3.3">
                    </times>
                   </apply>
                   <apply id="A1.E11.m1.6.6.5.5.2.2.2.1.1.1.1.cmml" xref="A1.E11.m1.6.6.5.5.2.2.2.1.1.1">
                    <csymbol cd="ambiguous" id="A1.E11.m1.6.6.5.5.2.2.2.1.1.1.1.1.cmml" xref="A1.E11.m1.6.6.5.5.2.2.2.1.1.1">
                     superscript
                    </csymbol>
                    <ci id="A1.E11.m1.6.6.5.5.2.2.2.1.1.1.1.2.cmml" xref="A1.E11.m1.6.6.5.5.2.2.2.1.1.1.1.2">
                     𝑠
                    </ci>
                    <ci id="A1.E11.m1.6.6.5.5.2.2.2.1.1.1.1.3.cmml" xref="A1.E11.m1.6.6.5.5.2.2.2.1.1.1.1.3">
                     ′
                    </ci>
                   </apply>
                  </apply>
                 </apply>
                </apply>
               </apply>
              </apply>
              <apply id="A1.E11.m1.14.14.1.1.2.2.2.1.2.cmml" xref="A1.E11.m1.14.14.1.1.2.2.2.1.1">
               <csymbol cd="latexml" id="A1.E11.m1.14.14.1.1.2.2.2.1.2.1.cmml" xref="A1.E11.m1.14.14.1.1.2.2.2.1.1.2">
                delimited-[]
               </csymbol>
               <apply id="A1.E11.m1.14.14.1.1.2.2.2.1.1.1.cmml" xref="A1.E11.m1.14.14.1.1.2.2.2.1.1.1">
                <times id="A1.E11.m1.14.14.1.1.2.2.2.1.1.1.3.cmml" xref="A1.E11.m1.14.14.1.1.2.2.2.1.1.1.3">
                </times>
                <ci id="A1.E11.m1.14.14.1.1.2.2.2.1.1.1.4.cmml" xref="A1.E11.m1.14.14.1.1.2.2.2.1.1.1.4">
                 𝑄
                </ci>
                <interval closure="open" id="A1.E11.m1.14.14.1.1.2.2.2.1.1.1.2.3.cmml" xref="A1.E11.m1.14.14.1.1.2.2.2.1.1.1.2.2">
                 <apply id="A1.E11.m1.14.14.1.1.2.2.2.1.1.1.1.1.1.cmml" xref="A1.E11.m1.14.14.1.1.2.2.2.1.1.1.1.1.1">
                  <csymbol cd="ambiguous" id="A1.E11.m1.14.14.1.1.2.2.2.1.1.1.1.1.1.1.cmml" xref="A1.E11.m1.14.14.1.1.2.2.2.1.1.1.1.1.1">
                   superscript
                  </csymbol>
                  <ci id="A1.E11.m1.14.14.1.1.2.2.2.1.1.1.1.1.1.2.cmml" xref="A1.E11.m1.14.14.1.1.2.2.2.1.1.1.1.1.1.2">
                   𝑠
                  </ci>
                  <ci id="A1.E11.m1.14.14.1.1.2.2.2.1.1.1.1.1.1.3.cmml" xref="A1.E11.m1.14.14.1.1.2.2.2.1.1.1.1.1.1.3">
                   ′
                  </ci>
                 </apply>
                 <apply id="A1.E11.m1.14.14.1.1.2.2.2.1.1.1.2.2.2.cmml" xref="A1.E11.m1.14.14.1.1.2.2.2.1.1.1.2.2.2">
                  <csymbol cd="ambiguous" id="A1.E11.m1.14.14.1.1.2.2.2.1.1.1.2.2.2.1.cmml" xref="A1.E11.m1.14.14.1.1.2.2.2.1.1.1.2.2.2">
                   superscript
                  </csymbol>
                  <ci id="A1.E11.m1.14.14.1.1.2.2.2.1.1.1.2.2.2.2.cmml" xref="A1.E11.m1.14.14.1.1.2.2.2.1.1.1.2.2.2.2">
                   𝑎
                  </ci>
                  <ci id="A1.E11.m1.14.14.1.1.2.2.2.1.1.1.2.2.2.3.cmml" xref="A1.E11.m1.14.14.1.1.2.2.2.1.1.1.2.2.2.3">
                   ′
                  </ci>
                 </apply>
                </interval>
               </apply>
              </apply>
             </apply>
            </apply>
            <apply id="A1.E11.m1.14.14.1.1.3.3.cmml" xref="A1.E11.m1.14.14.1.1.3.3">
             <times id="A1.E11.m1.14.14.1.1.3.3.2.cmml" xref="A1.E11.m1.14.14.1.1.3.3.2">
             </times>
             <ci id="A1.E11.m1.14.14.1.1.3.3.3.cmml" xref="A1.E11.m1.14.14.1.1.3.3.3">
              𝛾
             </ci>
             <ci id="A1.E11.m1.14.14.1.1.3.3.4.cmml" xref="A1.E11.m1.14.14.1.1.3.3.4">
              𝛽
             </ci>
             <apply id="A1.E11.m1.14.14.1.1.3.3.5.cmml" xref="A1.E11.m1.14.14.1.1.3.3.5">
              <csymbol cd="ambiguous" id="A1.E11.m1.14.14.1.1.3.3.5.1.cmml" xref="A1.E11.m1.14.14.1.1.3.3.5">
               subscript
              </csymbol>
              <ci id="A1.E11.m1.14.14.1.1.3.3.5.2.cmml" xref="A1.E11.m1.14.14.1.1.3.3.5.2">
               𝔼
              </ci>
              <apply id="A1.E11.m1.11.11.5.6.cmml" xref="A1.E11.m1.11.11.5.5">
               <csymbol cd="ambiguous" id="A1.E11.m1.11.11.5.6a.cmml" xref="A1.E11.m1.11.11.5.5.3">
                formulae-sequence
               </csymbol>
               <apply id="A1.E11.m1.10.10.4.4.1.cmml" xref="A1.E11.m1.10.10.4.4.1">
                <csymbol cd="latexml" id="A1.E11.m1.10.10.4.4.1.1.cmml" xref="A1.E11.m1.10.10.4.4.1.1">
                 similar-to
                </csymbol>
                <ci id="A1.E11.m1.10.10.4.4.1.2.cmml" xref="A1.E11.m1.10.10.4.4.1.2">
                 𝑎
                </ci>
                <apply id="A1.E11.m1.10.10.4.4.1.3.cmml" xref="A1.E11.m1.10.10.4.4.1.3">
                 <times id="A1.E11.m1.10.10.4.4.1.3.1.cmml" xref="A1.E11.m1.10.10.4.4.1.3.1">
                 </times>
                 <apply id="A1.E11.m1.10.10.4.4.1.3.2.cmml" xref="A1.E11.m1.10.10.4.4.1.3.2">
                  <csymbol cd="ambiguous" id="A1.E11.m1.10.10.4.4.1.3.2.1.cmml" xref="A1.E11.m1.10.10.4.4.1.3.2">
                   superscript
                  </csymbol>
                  <ci id="A1.E11.m1.10.10.4.4.1.3.2.2.cmml" xref="A1.E11.m1.10.10.4.4.1.3.2.2">
                   𝜋
                  </ci>
                  <times id="A1.E11.m1.10.10.4.4.1.3.2.3.cmml" xref="A1.E11.m1.10.10.4.4.1.3.2.3">
                  </times>
                 </apply>
                 <ci id="A1.E11.m1.7.7.1.1.cmml" xref="A1.E11.m1.7.7.1.1">
                  𝑠
                 </ci>
                </apply>
               </apply>
               <apply id="A1.E11.m1.11.11.5.5.2.cmml" xref="A1.E11.m1.11.11.5.5.2">
                <csymbol cd="latexml" id="A1.E11.m1.11.11.5.5.2.1.cmml" xref="A1.E11.m1.11.11.5.5.2.1">
                 similar-to
                </csymbol>
                <apply id="A1.E11.m1.11.11.5.5.2.2.cmml" xref="A1.E11.m1.11.11.5.5.2.2">
                 <csymbol cd="ambiguous" id="A1.E11.m1.11.11.5.5.2.2.1.cmml" xref="A1.E11.m1.11.11.5.5.2.2">
                  superscript
                 </csymbol>
                 <ci id="A1.E11.m1.11.11.5.5.2.2.2.cmml" xref="A1.E11.m1.11.11.5.5.2.2.2">
                  𝑠
                 </ci>
                 <ci id="A1.E11.m1.11.11.5.5.2.2.3.cmml" xref="A1.E11.m1.11.11.5.5.2.2.3">
                  ′
                 </ci>
                </apply>
                <apply id="A1.E11.m1.11.11.5.5.2.3.cmml" xref="A1.E11.m1.11.11.5.5.2.3">
                 <times id="A1.E11.m1.11.11.5.5.2.3.1.cmml" xref="A1.E11.m1.11.11.5.5.2.3.1">
                 </times>
                 <ci id="A1.E11.m1.11.11.5.5.2.3.2.cmml" xref="A1.E11.m1.11.11.5.5.2.3.2">
                  𝒯
                 </ci>
                 <interval closure="open" id="A1.E11.m1.11.11.5.5.2.3.3.1.cmml" xref="A1.E11.m1.11.11.5.5.2.3.3.2">
                  <ci id="A1.E11.m1.8.8.2.2.cmml" xref="A1.E11.m1.8.8.2.2">
                   𝑠
                  </ci>
                  <ci id="A1.E11.m1.9.9.3.3.cmml" xref="A1.E11.m1.9.9.3.3">
                   𝑎
                  </ci>
                 </interval>
                </apply>
               </apply>
              </apply>
             </apply>
             <apply id="A1.E11.m1.14.14.1.1.3.3.1.2.cmml" xref="A1.E11.m1.14.14.1.1.3.3.1.1">
              <csymbol cd="latexml" id="A1.E11.m1.14.14.1.1.3.3.1.2.1.cmml" xref="A1.E11.m1.14.14.1.1.3.3.1.1.2">
               delimited-[]
              </csymbol>
              <apply id="A1.E11.m1.14.14.1.1.3.3.1.1.1.cmml" xref="A1.E11.m1.14.14.1.1.3.3.1.1.1">
               <times id="A1.E11.m1.14.14.1.1.3.3.1.1.1.2.cmml" xref="A1.E11.m1.14.14.1.1.3.3.1.1.1.2">
               </times>
               <ci id="A1.E11.m1.14.14.1.1.3.3.1.1.1.3a.cmml" xref="A1.E11.m1.14.14.1.1.3.3.1.1.1.3">
                <mtext id="A1.E11.m1.14.14.1.1.3.3.1.1.1.3.cmml" xref="A1.E11.m1.14.14.1.1.3.3.1.1.1.3">
                 KL
                </mtext>
               </ci>
               <apply id="A1.E11.m1.14.14.1.1.3.3.1.1.1.1.1.1.cmml" xref="A1.E11.m1.14.14.1.1.3.3.1.1.1.1.1">
                <csymbol cd="latexml" id="A1.E11.m1.14.14.1.1.3.3.1.1.1.1.1.1.1.cmml" xref="A1.E11.m1.14.14.1.1.3.3.1.1.1.1.1.1.1">
                 conditional
                </csymbol>
                <apply id="A1.E11.m1.14.14.1.1.3.3.1.1.1.1.1.1.2.cmml" xref="A1.E11.m1.14.14.1.1.3.3.1.1.1.1.1.1.2">
                 <csymbol cd="ambiguous" id="A1.E11.m1.14.14.1.1.3.3.1.1.1.1.1.1.2.1.cmml" xref="A1.E11.m1.14.14.1.1.3.3.1.1.1.1.1.1.2">
                  superscript
                 </csymbol>
                 <ci id="A1.E11.m1.14.14.1.1.3.3.1.1.1.1.1.1.2.2.cmml" xref="A1.E11.m1.14.14.1.1.3.3.1.1.1.1.1.1.2.2">
                  𝑎
                 </ci>
                 <ci id="A1.E11.m1.14.14.1.1.3.3.1.1.1.1.1.1.2.3.cmml" xref="A1.E11.m1.14.14.1.1.3.3.1.1.1.1.1.1.2.3">
                  ′
                 </ci>
                </apply>
                <apply id="A1.E11.m1.14.14.1.1.3.3.1.1.1.1.1.1.3.cmml" xref="A1.E11.m1.14.14.1.1.3.3.1.1.1.1.1.1.3">
                 <csymbol cd="ambiguous" id="A1.E11.m1.14.14.1.1.3.3.1.1.1.1.1.1.3.1.cmml" xref="A1.E11.m1.14.14.1.1.3.3.1.1.1.1.1.1.3">
                  superscript
                 </csymbol>
                 <ci id="A1.E11.m1.14.14.1.1.3.3.1.1.1.1.1.1.3.2.cmml" xref="A1.E11.m1.14.14.1.1.3.3.1.1.1.1.1.1.3.2">
                  𝑠
                 </ci>
                 <ci id="A1.E11.m1.14.14.1.1.3.3.1.1.1.1.1.1.3.3.cmml" xref="A1.E11.m1.14.14.1.1.3.3.1.1.1.1.1.1.3.3">
                  ′
                 </ci>
                </apply>
               </apply>
              </apply>
             </apply>
            </apply>
           </apply>
          </apply>
         </annotation-xml>
         <annotation encoding="application/x-tex" id="A1.E11.m1.14c">
          \displaystyle=\mathbb{E}_{a\sim\pi^{*}(s)}[r(s,a)]+\gamma\mathbb{E}_{a\sim\pi^{*}(s),s^{\prime}\sim\mathcal{T}(s,a),a^{\prime}\sim\pi^{*}(s^{\prime})}[Q(s^{\prime},a^{\prime})]-\gamma\beta\mathbb{E}_{a\sim\pi^{*}(s),s^{\prime}\sim\mathcal{T}(s,a)}[\text{KL}(a^{\prime}|s^{\prime})].
         </annotation>
        </semantics>
       </math>
      </td>
      <td class="ltx_eqn_cell ltx_eqn_center_padright">
      </td>
      <td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1">
       <span class="ltx_tag ltx_tag_equation ltx_align_right">
        (11)
       </span>
      </td>
     </tr>
    </tbody>
   </table>
  </div>
  <div class="ltx_para" id="A1.p3">
   <p class="ltx_p" id="A1.p3.1">
    Following our Per-token Soft Bellman update, the update over each token within an action (
    <math alttext="j&lt;|a|" class="ltx_Math" display="inline" id="A1.p3.1.m1.1">
     <semantics id="A1.p3.1.m1.1a">
      <mrow id="A1.p3.1.m1.1.2" xref="A1.p3.1.m1.1.2.cmml">
       <mi id="A1.p3.1.m1.1.2.2" xref="A1.p3.1.m1.1.2.2.cmml">
        j
       </mi>
       <mo id="A1.p3.1.m1.1.2.1" xref="A1.p3.1.m1.1.2.1.cmml">
        &lt;
       </mo>
       <mrow id="A1.p3.1.m1.1.2.3.2" xref="A1.p3.1.m1.1.2.3.1.cmml">
        <mo id="A1.p3.1.m1.1.2.3.2.1" stretchy="false" xref="A1.p3.1.m1.1.2.3.1.1.cmml">
         |
        </mo>
        <mi id="A1.p3.1.m1.1.1" xref="A1.p3.1.m1.1.1.cmml">
         a
        </mi>
        <mo id="A1.p3.1.m1.1.2.3.2.2" stretchy="false" xref="A1.p3.1.m1.1.2.3.1.1.cmml">
         |
        </mo>
       </mrow>
      </mrow>
      <annotation-xml encoding="MathML-Content" id="A1.p3.1.m1.1b">
       <apply id="A1.p3.1.m1.1.2.cmml" xref="A1.p3.1.m1.1.2">
        <lt id="A1.p3.1.m1.1.2.1.cmml" xref="A1.p3.1.m1.1.2.1">
        </lt>
        <ci id="A1.p3.1.m1.1.2.2.cmml" xref="A1.p3.1.m1.1.2.2">
         𝑗
        </ci>
        <apply id="A1.p3.1.m1.1.2.3.1.cmml" xref="A1.p3.1.m1.1.2.3.2">
         <abs id="A1.p3.1.m1.1.2.3.1.1.cmml" xref="A1.p3.1.m1.1.2.3.2.1">
         </abs>
         <ci id="A1.p3.1.m1.1.1.cmml" xref="A1.p3.1.m1.1.1">
          𝑎
         </ci>
        </apply>
       </apply>
      </annotation-xml>
      <annotation encoding="application/x-tex" id="A1.p3.1.m1.1c">
       j&lt;|a|
      </annotation>
     </semantics>
    </math>
    ) is:
   </p>
   <table class="ltx_equationgroup ltx_eqn_align ltx_eqn_table" id="A7.EGx12">
    <tbody id="A1.Ex4">
     <tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
      <td class="ltx_eqn_cell ltx_eqn_center_padleft">
      </td>
      <td class="ltx_td ltx_align_right ltx_eqn_cell">
       <math alttext="\displaystyle\mathbb{E}_{w_{1}\sim\pi^{*}(s)}[Q(s,w_{1})]" class="ltx_Math" display="inline" id="A1.Ex4.m1.3">
        <semantics id="A1.Ex4.m1.3a">
         <mrow id="A1.Ex4.m1.3.3" xref="A1.Ex4.m1.3.3.cmml">
          <msub id="A1.Ex4.m1.3.3.3" xref="A1.Ex4.m1.3.3.3.cmml">
           <mi id="A1.Ex4.m1.3.3.3.2" xref="A1.Ex4.m1.3.3.3.2.cmml">
            𝔼
           </mi>
           <mrow id="A1.Ex4.m1.1.1.1" xref="A1.Ex4.m1.1.1.1.cmml">
            <msub id="A1.Ex4.m1.1.1.1.3" xref="A1.Ex4.m1.1.1.1.3.cmml">
             <mi id="A1.Ex4.m1.1.1.1.3.2" xref="A1.Ex4.m1.1.1.1.3.2.cmml">
              w
             </mi>
             <mn id="A1.Ex4.m1.1.1.1.3.3" xref="A1.Ex4.m1.1.1.1.3.3.cmml">
              1
             </mn>
            </msub>
            <mo id="A1.Ex4.m1.1.1.1.2" xref="A1.Ex4.m1.1.1.1.2.cmml">
             ∼
            </mo>
            <mrow id="A1.Ex4.m1.1.1.1.4" xref="A1.Ex4.m1.1.1.1.4.cmml">
             <msup id="A1.Ex4.m1.1.1.1.4.2" xref="A1.Ex4.m1.1.1.1.4.2.cmml">
              <mi id="A1.Ex4.m1.1.1.1.4.2.2" xref="A1.Ex4.m1.1.1.1.4.2.2.cmml">
               π
              </mi>
              <mo id="A1.Ex4.m1.1.1.1.4.2.3" xref="A1.Ex4.m1.1.1.1.4.2.3.cmml">
               ∗
              </mo>
             </msup>
             <mo id="A1.Ex4.m1.1.1.1.4.1" lspace="0em" rspace="0em" xref="A1.Ex4.m1.1.1.1.4.1.cmml">
              ​
             </mo>
             <mrow id="A1.Ex4.m1.1.1.1.4.3.2" xref="A1.Ex4.m1.1.1.1.4.cmml">
              <mo id="A1.Ex4.m1.1.1.1.4.3.2.1" stretchy="false" xref="A1.Ex4.m1.1.1.1.4.cmml">
               (
              </mo>
              <mi id="A1.Ex4.m1.1.1.1.1" xref="A1.Ex4.m1.1.1.1.1.cmml">
               s
              </mi>
              <mo id="A1.Ex4.m1.1.1.1.4.3.2.2" stretchy="false" xref="A1.Ex4.m1.1.1.1.4.cmml">
               )
              </mo>
             </mrow>
            </mrow>
           </mrow>
          </msub>
          <mo id="A1.Ex4.m1.3.3.2" lspace="0em" rspace="0em" xref="A1.Ex4.m1.3.3.2.cmml">
           ​
          </mo>
          <mrow id="A1.Ex4.m1.3.3.1.1" xref="A1.Ex4.m1.3.3.1.2.cmml">
           <mo id="A1.Ex4.m1.3.3.1.1.2" stretchy="false" xref="A1.Ex4.m1.3.3.1.2.1.cmml">
            [
           </mo>
           <mrow id="A1.Ex4.m1.3.3.1.1.1" xref="A1.Ex4.m1.3.3.1.1.1.cmml">
            <mi id="A1.Ex4.m1.3.3.1.1.1.3" xref="A1.Ex4.m1.3.3.1.1.1.3.cmml">
             Q
            </mi>
            <mo id="A1.Ex4.m1.3.3.1.1.1.2" lspace="0em" rspace="0em" xref="A1.Ex4.m1.3.3.1.1.1.2.cmml">
             ​
            </mo>
            <mrow id="A1.Ex4.m1.3.3.1.1.1.1.1" xref="A1.Ex4.m1.3.3.1.1.1.1.2.cmml">
             <mo id="A1.Ex4.m1.3.3.1.1.1.1.1.2" stretchy="false" xref="A1.Ex4.m1.3.3.1.1.1.1.2.cmml">
              (
             </mo>
             <mi id="A1.Ex4.m1.2.2" xref="A1.Ex4.m1.2.2.cmml">
              s
             </mi>
             <mo id="A1.Ex4.m1.3.3.1.1.1.1.1.3" xref="A1.Ex4.m1.3.3.1.1.1.1.2.cmml">
              ,
             </mo>
             <msub id="A1.Ex4.m1.3.3.1.1.1.1.1.1" xref="A1.Ex4.m1.3.3.1.1.1.1.1.1.cmml">
              <mi id="A1.Ex4.m1.3.3.1.1.1.1.1.1.2" xref="A1.Ex4.m1.3.3.1.1.1.1.1.1.2.cmml">
               w
              </mi>
              <mn id="A1.Ex4.m1.3.3.1.1.1.1.1.1.3" xref="A1.Ex4.m1.3.3.1.1.1.1.1.1.3.cmml">
               1
              </mn>
             </msub>
             <mo id="A1.Ex4.m1.3.3.1.1.1.1.1.4" stretchy="false" xref="A1.Ex4.m1.3.3.1.1.1.1.2.cmml">
              )
             </mo>
            </mrow>
           </mrow>
           <mo id="A1.Ex4.m1.3.3.1.1.3" stretchy="false" xref="A1.Ex4.m1.3.3.1.2.1.cmml">
            ]
           </mo>
          </mrow>
         </mrow>
         <annotation-xml encoding="MathML-Content" id="A1.Ex4.m1.3b">
          <apply id="A1.Ex4.m1.3.3.cmml" xref="A1.Ex4.m1.3.3">
           <times id="A1.Ex4.m1.3.3.2.cmml" xref="A1.Ex4.m1.3.3.2">
           </times>
           <apply id="A1.Ex4.m1.3.3.3.cmml" xref="A1.Ex4.m1.3.3.3">
            <csymbol cd="ambiguous" id="A1.Ex4.m1.3.3.3.1.cmml" xref="A1.Ex4.m1.3.3.3">
             subscript
            </csymbol>
            <ci id="A1.Ex4.m1.3.3.3.2.cmml" xref="A1.Ex4.m1.3.3.3.2">
             𝔼
            </ci>
            <apply id="A1.Ex4.m1.1.1.1.cmml" xref="A1.Ex4.m1.1.1.1">
             <csymbol cd="latexml" id="A1.Ex4.m1.1.1.1.2.cmml" xref="A1.Ex4.m1.1.1.1.2">
              similar-to
             </csymbol>
             <apply id="A1.Ex4.m1.1.1.1.3.cmml" xref="A1.Ex4.m1.1.1.1.3">
              <csymbol cd="ambiguous" id="A1.Ex4.m1.1.1.1.3.1.cmml" xref="A1.Ex4.m1.1.1.1.3">
               subscript
              </csymbol>
              <ci id="A1.Ex4.m1.1.1.1.3.2.cmml" xref="A1.Ex4.m1.1.1.1.3.2">
               𝑤
              </ci>
              <cn id="A1.Ex4.m1.1.1.1.3.3.cmml" type="integer" xref="A1.Ex4.m1.1.1.1.3.3">
               1
              </cn>
             </apply>
             <apply id="A1.Ex4.m1.1.1.1.4.cmml" xref="A1.Ex4.m1.1.1.1.4">
              <times id="A1.Ex4.m1.1.1.1.4.1.cmml" xref="A1.Ex4.m1.1.1.1.4.1">
              </times>
              <apply id="A1.Ex4.m1.1.1.1.4.2.cmml" xref="A1.Ex4.m1.1.1.1.4.2">
               <csymbol cd="ambiguous" id="A1.Ex4.m1.1.1.1.4.2.1.cmml" xref="A1.Ex4.m1.1.1.1.4.2">
                superscript
               </csymbol>
               <ci id="A1.Ex4.m1.1.1.1.4.2.2.cmml" xref="A1.Ex4.m1.1.1.1.4.2.2">
                𝜋
               </ci>
               <times id="A1.Ex4.m1.1.1.1.4.2.3.cmml" xref="A1.Ex4.m1.1.1.1.4.2.3">
               </times>
              </apply>
              <ci id="A1.Ex4.m1.1.1.1.1.cmml" xref="A1.Ex4.m1.1.1.1.1">
               𝑠
              </ci>
             </apply>
            </apply>
           </apply>
           <apply id="A1.Ex4.m1.3.3.1.2.cmml" xref="A1.Ex4.m1.3.3.1.1">
            <csymbol cd="latexml" id="A1.Ex4.m1.3.3.1.2.1.cmml" xref="A1.Ex4.m1.3.3.1.1.2">
             delimited-[]
            </csymbol>
            <apply id="A1.Ex4.m1.3.3.1.1.1.cmml" xref="A1.Ex4.m1.3.3.1.1.1">
             <times id="A1.Ex4.m1.3.3.1.1.1.2.cmml" xref="A1.Ex4.m1.3.3.1.1.1.2">
             </times>
             <ci id="A1.Ex4.m1.3.3.1.1.1.3.cmml" xref="A1.Ex4.m1.3.3.1.1.1.3">
              𝑄
             </ci>
             <interval closure="open" id="A1.Ex4.m1.3.3.1.1.1.1.2.cmml" xref="A1.Ex4.m1.3.3.1.1.1.1.1">
              <ci id="A1.Ex4.m1.2.2.cmml" xref="A1.Ex4.m1.2.2">
               𝑠
              </ci>
              <apply id="A1.Ex4.m1.3.3.1.1.1.1.1.1.cmml" xref="A1.Ex4.m1.3.3.1.1.1.1.1.1">
               <csymbol cd="ambiguous" id="A1.Ex4.m1.3.3.1.1.1.1.1.1.1.cmml" xref="A1.Ex4.m1.3.3.1.1.1.1.1.1">
                subscript
               </csymbol>
               <ci id="A1.Ex4.m1.3.3.1.1.1.1.1.1.2.cmml" xref="A1.Ex4.m1.3.3.1.1.1.1.1.1.2">
                𝑤
               </ci>
               <cn id="A1.Ex4.m1.3.3.1.1.1.1.1.1.3.cmml" type="integer" xref="A1.Ex4.m1.3.3.1.1.1.1.1.1.3">
                1
               </cn>
              </apply>
             </interval>
            </apply>
           </apply>
          </apply>
         </annotation-xml>
         <annotation encoding="application/x-tex" id="A1.Ex4.m1.3c">
          \displaystyle\mathbb{E}_{w_{1}\sim\pi^{*}(s)}[Q(s,w_{1})]
         </annotation>
        </semantics>
       </math>
      </td>
      <td class="ltx_td ltx_align_left ltx_eqn_cell">
       <math alttext="\displaystyle=\mathbb{E}_{w_{1}\sim\pi^{*}(s)}[\mathbb{E}_{w_{2}\sim\pi^{*}(s,w_{1})}[Q(s,w_{1},w_{2})]-\beta\text{KL}(w_{2}|s,w_{1})]" class="ltx_Math" display="inline" id="A1.Ex4.m2.6">
        <semantics id="A1.Ex4.m2.6a">
         <mrow id="A1.Ex4.m2.6.6" xref="A1.Ex4.m2.6.6.cmml">
          <mi id="A1.Ex4.m2.6.6.3" xref="A1.Ex4.m2.6.6.3.cmml">
          </mi>
          <mo id="A1.Ex4.m2.6.6.2" xref="A1.Ex4.m2.6.6.2.cmml">
           =
          </mo>
          <mrow id="A1.Ex4.m2.6.6.1" xref="A1.Ex4.m2.6.6.1.cmml">
           <msub id="A1.Ex4.m2.6.6.1.3" xref="A1.Ex4.m2.6.6.1.3.cmml">
            <mi id="A1.Ex4.m2.6.6.1.3.2" xref="A1.Ex4.m2.6.6.1.3.2.cmml">
             𝔼
            </mi>
            <mrow id="A1.Ex4.m2.1.1.1" xref="A1.Ex4.m2.1.1.1.cmml">
             <msub id="A1.Ex4.m2.1.1.1.3" xref="A1.Ex4.m2.1.1.1.3.cmml">
              <mi id="A1.Ex4.m2.1.1.1.3.2" xref="A1.Ex4.m2.1.1.1.3.2.cmml">
               w
              </mi>
              <mn id="A1.Ex4.m2.1.1.1.3.3" xref="A1.Ex4.m2.1.1.1.3.3.cmml">
               1
              </mn>
             </msub>
             <mo id="A1.Ex4.m2.1.1.1.2" xref="A1.Ex4.m2.1.1.1.2.cmml">
              ∼
             </mo>
             <mrow id="A1.Ex4.m2.1.1.1.4" xref="A1.Ex4.m2.1.1.1.4.cmml">
              <msup id="A1.Ex4.m2.1.1.1.4.2" xref="A1.Ex4.m2.1.1.1.4.2.cmml">
               <mi id="A1.Ex4.m2.1.1.1.4.2.2" xref="A1.Ex4.m2.1.1.1.4.2.2.cmml">
                π
               </mi>
               <mo id="A1.Ex4.m2.1.1.1.4.2.3" xref="A1.Ex4.m2.1.1.1.4.2.3.cmml">
                ∗
               </mo>
              </msup>
              <mo id="A1.Ex4.m2.1.1.1.4.1" lspace="0em" rspace="0em" xref="A1.Ex4.m2.1.1.1.4.1.cmml">
               ​
              </mo>
              <mrow id="A1.Ex4.m2.1.1.1.4.3.2" xref="A1.Ex4.m2.1.1.1.4.cmml">
               <mo id="A1.Ex4.m2.1.1.1.4.3.2.1" stretchy="false" xref="A1.Ex4.m2.1.1.1.4.cmml">
                (
               </mo>
               <mi id="A1.Ex4.m2.1.1.1.1" xref="A1.Ex4.m2.1.1.1.1.cmml">
                s
               </mi>
               <mo id="A1.Ex4.m2.1.1.1.4.3.2.2" stretchy="false" xref="A1.Ex4.m2.1.1.1.4.cmml">
                )
               </mo>
              </mrow>
             </mrow>
            </mrow>
           </msub>
           <mo id="A1.Ex4.m2.6.6.1.2" lspace="0em" rspace="0em" xref="A1.Ex4.m2.6.6.1.2.cmml">
            ​
           </mo>
           <mrow id="A1.Ex4.m2.6.6.1.1.1" xref="A1.Ex4.m2.6.6.1.1.2.cmml">
            <mo id="A1.Ex4.m2.6.6.1.1.1.2" stretchy="false" xref="A1.Ex4.m2.6.6.1.1.2.1.cmml">
             [
            </mo>
            <mrow id="A1.Ex4.m2.6.6.1.1.1.1" xref="A1.Ex4.m2.6.6.1.1.1.1.cmml">
             <mrow id="A1.Ex4.m2.6.6.1.1.1.1.1" xref="A1.Ex4.m2.6.6.1.1.1.1.1.cmml">
              <msub id="A1.Ex4.m2.6.6.1.1.1.1.1.3" xref="A1.Ex4.m2.6.6.1.1.1.1.1.3.cmml">
               <mi id="A1.Ex4.m2.6.6.1.1.1.1.1.3.2" xref="A1.Ex4.m2.6.6.1.1.1.1.1.3.2.cmml">
                𝔼
               </mi>
               <mrow id="A1.Ex4.m2.3.3.2" xref="A1.Ex4.m2.3.3.2.cmml">
                <msub id="A1.Ex4.m2.3.3.2.4" xref="A1.Ex4.m2.3.3.2.4.cmml">
                 <mi id="A1.Ex4.m2.3.3.2.4.2" xref="A1.Ex4.m2.3.3.2.4.2.cmml">
                  w
                 </mi>
                 <mn id="A1.Ex4.m2.3.3.2.4.3" xref="A1.Ex4.m2.3.3.2.4.3.cmml">
                  2
                 </mn>
                </msub>
                <mo id="A1.Ex4.m2.3.3.2.3" xref="A1.Ex4.m2.3.3.2.3.cmml">
                 ∼
                </mo>
                <mrow id="A1.Ex4.m2.3.3.2.2" xref="A1.Ex4.m2.3.3.2.2.cmml">
                 <msup id="A1.Ex4.m2.3.3.2.2.3" xref="A1.Ex4.m2.3.3.2.2.3.cmml">
                  <mi id="A1.Ex4.m2.3.3.2.2.3.2" xref="A1.Ex4.m2.3.3.2.2.3.2.cmml">
                   π
                  </mi>
                  <mo id="A1.Ex4.m2.3.3.2.2.3.3" xref="A1.Ex4.m2.3.3.2.2.3.3.cmml">
                   ∗
                  </mo>
                 </msup>
                 <mo id="A1.Ex4.m2.3.3.2.2.2" lspace="0em" rspace="0em" xref="A1.Ex4.m2.3.3.2.2.2.cmml">
                  ​
                 </mo>
                 <mrow id="A1.Ex4.m2.3.3.2.2.1.1" xref="A1.Ex4.m2.3.3.2.2.1.2.cmml">
                  <mo id="A1.Ex4.m2.3.3.2.2.1.1.2" stretchy="false" xref="A1.Ex4.m2.3.3.2.2.1.2.cmml">
                   (
                  </mo>
                  <mi id="A1.Ex4.m2.2.2.1.1" xref="A1.Ex4.m2.2.2.1.1.cmml">
                   s
                  </mi>
                  <mo id="A1.Ex4.m2.3.3.2.2.1.1.3" xref="A1.Ex4.m2.3.3.2.2.1.2.cmml">
                   ,
                  </mo>
                  <msub id="A1.Ex4.m2.3.3.2.2.1.1.1" xref="A1.Ex4.m2.3.3.2.2.1.1.1.cmml">
                   <mi id="A1.Ex4.m2.3.3.2.2.1.1.1.2" xref="A1.Ex4.m2.3.3.2.2.1.1.1.2.cmml">
                    w
                   </mi>
                   <mn id="A1.Ex4.m2.3.3.2.2.1.1.1.3" xref="A1.Ex4.m2.3.3.2.2.1.1.1.3.cmml">
                    1
                   </mn>
                  </msub>
                  <mo id="A1.Ex4.m2.3.3.2.2.1.1.4" stretchy="false" xref="A1.Ex4.m2.3.3.2.2.1.2.cmml">
                   )
                  </mo>
                 </mrow>
                </mrow>
               </mrow>
              </msub>
              <mo id="A1.Ex4.m2.6.6.1.1.1.1.1.2" lspace="0em" rspace="0em" xref="A1.Ex4.m2.6.6.1.1.1.1.1.2.cmml">
               ​
              </mo>
              <mrow id="A1.Ex4.m2.6.6.1.1.1.1.1.1.1" xref="A1.Ex4.m2.6.6.1.1.1.1.1.1.2.cmml">
               <mo id="A1.Ex4.m2.6.6.1.1.1.1.1.1.1.2" stretchy="false" xref="A1.Ex4.m2.6.6.1.1.1.1.1.1.2.1.cmml">
                [
               </mo>
               <mrow id="A1.Ex4.m2.6.6.1.1.1.1.1.1.1.1" xref="A1.Ex4.m2.6.6.1.1.1.1.1.1.1.1.cmml">
                <mi id="A1.Ex4.m2.6.6.1.1.1.1.1.1.1.1.4" xref="A1.Ex4.m2.6.6.1.1.1.1.1.1.1.1.4.cmml">
                 Q
                </mi>
                <mo id="A1.Ex4.m2.6.6.1.1.1.1.1.1.1.1.3" lspace="0em" rspace="0em" xref="A1.Ex4.m2.6.6.1.1.1.1.1.1.1.1.3.cmml">
                 ​
                </mo>
                <mrow id="A1.Ex4.m2.6.6.1.1.1.1.1.1.1.1.2.2" xref="A1.Ex4.m2.6.6.1.1.1.1.1.1.1.1.2.3.cmml">
                 <mo id="A1.Ex4.m2.6.6.1.1.1.1.1.1.1.1.2.2.3" stretchy="false" xref="A1.Ex4.m2.6.6.1.1.1.1.1.1.1.1.2.3.cmml">
                  (
                 </mo>
                 <mi id="A1.Ex4.m2.4.4" xref="A1.Ex4.m2.4.4.cmml">
                  s
                 </mi>
                 <mo id="A1.Ex4.m2.6.6.1.1.1.1.1.1.1.1.2.2.4" xref="A1.Ex4.m2.6.6.1.1.1.1.1.1.1.1.2.3.cmml">
                  ,
                 </mo>
                 <msub id="A1.Ex4.m2.6.6.1.1.1.1.1.1.1.1.1.1.1" xref="A1.Ex4.m2.6.6.1.1.1.1.1.1.1.1.1.1.1.cmml">
                  <mi id="A1.Ex4.m2.6.6.1.1.1.1.1.1.1.1.1.1.1.2" xref="A1.Ex4.m2.6.6.1.1.1.1.1.1.1.1.1.1.1.2.cmml">
                   w
                  </mi>
                  <mn id="A1.Ex4.m2.6.6.1.1.1.1.1.1.1.1.1.1.1.3" xref="A1.Ex4.m2.6.6.1.1.1.1.1.1.1.1.1.1.1.3.cmml">
                   1
                  </mn>
                 </msub>
                 <mo id="A1.Ex4.m2.6.6.1.1.1.1.1.1.1.1.2.2.5" xref="A1.Ex4.m2.6.6.1.1.1.1.1.1.1.1.2.3.cmml">
                  ,
                 </mo>
                 <msub id="A1.Ex4.m2.6.6.1.1.1.1.1.1.1.1.2.2.2" xref="A1.Ex4.m2.6.6.1.1.1.1.1.1.1.1.2.2.2.cmml">
                  <mi id="A1.Ex4.m2.6.6.1.1.1.1.1.1.1.1.2.2.2.2" xref="A1.Ex4.m2.6.6.1.1.1.1.1.1.1.1.2.2.2.2.cmml">
                   w
                  </mi>
                  <mn id="A1.Ex4.m2.6.6.1.1.1.1.1.1.1.1.2.2.2.3" xref="A1.Ex4.m2.6.6.1.1.1.1.1.1.1.1.2.2.2.3.cmml">
                   2
                  </mn>
                 </msub>
                 <mo id="A1.Ex4.m2.6.6.1.1.1.1.1.1.1.1.2.2.6" stretchy="false" xref="A1.Ex4.m2.6.6.1.1.1.1.1.1.1.1.2.3.cmml">
                  )
                 </mo>
                </mrow>
               </mrow>
               <mo id="A1.Ex4.m2.6.6.1.1.1.1.1.1.1.3" stretchy="false" xref="A1.Ex4.m2.6.6.1.1.1.1.1.1.2.1.cmml">
                ]
               </mo>
              </mrow>
             </mrow>
             <mo id="A1.Ex4.m2.6.6.1.1.1.1.3" xref="A1.Ex4.m2.6.6.1.1.1.1.3.cmml">
              −
             </mo>
             <mrow id="A1.Ex4.m2.6.6.1.1.1.1.2" xref="A1.Ex4.m2.6.6.1.1.1.1.2.cmml">
              <mi id="A1.Ex4.m2.6.6.1.1.1.1.2.3" xref="A1.Ex4.m2.6.6.1.1.1.1.2.3.cmml">
               β
              </mi>
              <mo id="A1.Ex4.m2.6.6.1.1.1.1.2.2" lspace="0em" rspace="0em" xref="A1.Ex4.m2.6.6.1.1.1.1.2.2.cmml">
               ​
              </mo>
              <mtext id="A1.Ex4.m2.6.6.1.1.1.1.2.4" xref="A1.Ex4.m2.6.6.1.1.1.1.2.4a.cmml">
               KL
              </mtext>
              <mo id="A1.Ex4.m2.6.6.1.1.1.1.2.2a" lspace="0em" rspace="0em" xref="A1.Ex4.m2.6.6.1.1.1.1.2.2.cmml">
               ​
              </mo>
              <mrow id="A1.Ex4.m2.6.6.1.1.1.1.2.1.1" xref="A1.Ex4.m2.6.6.1.1.1.1.2.1.1.1.cmml">
               <mo id="A1.Ex4.m2.6.6.1.1.1.1.2.1.1.2" stretchy="false" xref="A1.Ex4.m2.6.6.1.1.1.1.2.1.1.1.cmml">
                (
               </mo>
               <mrow id="A1.Ex4.m2.6.6.1.1.1.1.2.1.1.1" xref="A1.Ex4.m2.6.6.1.1.1.1.2.1.1.1.cmml">
                <msub id="A1.Ex4.m2.6.6.1.1.1.1.2.1.1.1.3" xref="A1.Ex4.m2.6.6.1.1.1.1.2.1.1.1.3.cmml">
                 <mi id="A1.Ex4.m2.6.6.1.1.1.1.2.1.1.1.3.2" xref="A1.Ex4.m2.6.6.1.1.1.1.2.1.1.1.3.2.cmml">
                  w
                 </mi>
                 <mn id="A1.Ex4.m2.6.6.1.1.1.1.2.1.1.1.3.3" xref="A1.Ex4.m2.6.6.1.1.1.1.2.1.1.1.3.3.cmml">
                  2
                 </mn>
                </msub>
                <mo fence="false" id="A1.Ex4.m2.6.6.1.1.1.1.2.1.1.1.2" xref="A1.Ex4.m2.6.6.1.1.1.1.2.1.1.1.2.cmml">
                 |
                </mo>
                <mrow id="A1.Ex4.m2.6.6.1.1.1.1.2.1.1.1.1.1" xref="A1.Ex4.m2.6.6.1.1.1.1.2.1.1.1.1.2.cmml">
                 <mi id="A1.Ex4.m2.5.5" xref="A1.Ex4.m2.5.5.cmml">
                  s
                 </mi>
                 <mo id="A1.Ex4.m2.6.6.1.1.1.1.2.1.1.1.1.1.2" xref="A1.Ex4.m2.6.6.1.1.1.1.2.1.1.1.1.2.cmml">
                  ,
                 </mo>
                 <msub id="A1.Ex4.m2.6.6.1.1.1.1.2.1.1.1.1.1.1" xref="A1.Ex4.m2.6.6.1.1.1.1.2.1.1.1.1.1.1.cmml">
                  <mi id="A1.Ex4.m2.6.6.1.1.1.1.2.1.1.1.1.1.1.2" xref="A1.Ex4.m2.6.6.1.1.1.1.2.1.1.1.1.1.1.2.cmml">
                   w
                  </mi>
                  <mn id="A1.Ex4.m2.6.6.1.1.1.1.2.1.1.1.1.1.1.3" xref="A1.Ex4.m2.6.6.1.1.1.1.2.1.1.1.1.1.1.3.cmml">
                   1
                  </mn>
                 </msub>
                </mrow>
               </mrow>
               <mo id="A1.Ex4.m2.6.6.1.1.1.1.2.1.1.3" stretchy="false" xref="A1.Ex4.m2.6.6.1.1.1.1.2.1.1.1.cmml">
                )
               </mo>
              </mrow>
             </mrow>
            </mrow>
            <mo id="A1.Ex4.m2.6.6.1.1.1.3" stretchy="false" xref="A1.Ex4.m2.6.6.1.1.2.1.cmml">
             ]
            </mo>
           </mrow>
          </mrow>
         </mrow>
         <annotation-xml encoding="MathML-Content" id="A1.Ex4.m2.6b">
          <apply id="A1.Ex4.m2.6.6.cmml" xref="A1.Ex4.m2.6.6">
           <eq id="A1.Ex4.m2.6.6.2.cmml" xref="A1.Ex4.m2.6.6.2">
           </eq>
           <csymbol cd="latexml" id="A1.Ex4.m2.6.6.3.cmml" xref="A1.Ex4.m2.6.6.3">
            absent
           </csymbol>
           <apply id="A1.Ex4.m2.6.6.1.cmml" xref="A1.Ex4.m2.6.6.1">
            <times id="A1.Ex4.m2.6.6.1.2.cmml" xref="A1.Ex4.m2.6.6.1.2">
            </times>
            <apply id="A1.Ex4.m2.6.6.1.3.cmml" xref="A1.Ex4.m2.6.6.1.3">
             <csymbol cd="ambiguous" id="A1.Ex4.m2.6.6.1.3.1.cmml" xref="A1.Ex4.m2.6.6.1.3">
              subscript
             </csymbol>
             <ci id="A1.Ex4.m2.6.6.1.3.2.cmml" xref="A1.Ex4.m2.6.6.1.3.2">
              𝔼
             </ci>
             <apply id="A1.Ex4.m2.1.1.1.cmml" xref="A1.Ex4.m2.1.1.1">
              <csymbol cd="latexml" id="A1.Ex4.m2.1.1.1.2.cmml" xref="A1.Ex4.m2.1.1.1.2">
               similar-to
              </csymbol>
              <apply id="A1.Ex4.m2.1.1.1.3.cmml" xref="A1.Ex4.m2.1.1.1.3">
               <csymbol cd="ambiguous" id="A1.Ex4.m2.1.1.1.3.1.cmml" xref="A1.Ex4.m2.1.1.1.3">
                subscript
               </csymbol>
               <ci id="A1.Ex4.m2.1.1.1.3.2.cmml" xref="A1.Ex4.m2.1.1.1.3.2">
                𝑤
               </ci>
               <cn id="A1.Ex4.m2.1.1.1.3.3.cmml" type="integer" xref="A1.Ex4.m2.1.1.1.3.3">
                1
               </cn>
              </apply>
              <apply id="A1.Ex4.m2.1.1.1.4.cmml" xref="A1.Ex4.m2.1.1.1.4">
               <times id="A1.Ex4.m2.1.1.1.4.1.cmml" xref="A1.Ex4.m2.1.1.1.4.1">
               </times>
               <apply id="A1.Ex4.m2.1.1.1.4.2.cmml" xref="A1.Ex4.m2.1.1.1.4.2">
                <csymbol cd="ambiguous" id="A1.Ex4.m2.1.1.1.4.2.1.cmml" xref="A1.Ex4.m2.1.1.1.4.2">
                 superscript
                </csymbol>
                <ci id="A1.Ex4.m2.1.1.1.4.2.2.cmml" xref="A1.Ex4.m2.1.1.1.4.2.2">
                 𝜋
                </ci>
                <times id="A1.Ex4.m2.1.1.1.4.2.3.cmml" xref="A1.Ex4.m2.1.1.1.4.2.3">
                </times>
               </apply>
               <ci id="A1.Ex4.m2.1.1.1.1.cmml" xref="A1.Ex4.m2.1.1.1.1">
                𝑠
               </ci>
              </apply>
             </apply>
            </apply>
            <apply id="A1.Ex4.m2.6.6.1.1.2.cmml" xref="A1.Ex4.m2.6.6.1.1.1">
             <csymbol cd="latexml" id="A1.Ex4.m2.6.6.1.1.2.1.cmml" xref="A1.Ex4.m2.6.6.1.1.1.2">
              delimited-[]
             </csymbol>
             <apply id="A1.Ex4.m2.6.6.1.1.1.1.cmml" xref="A1.Ex4.m2.6.6.1.1.1.1">
              <minus id="A1.Ex4.m2.6.6.1.1.1.1.3.cmml" xref="A1.Ex4.m2.6.6.1.1.1.1.3">
              </minus>
              <apply id="A1.Ex4.m2.6.6.1.1.1.1.1.cmml" xref="A1.Ex4.m2.6.6.1.1.1.1.1">
               <times id="A1.Ex4.m2.6.6.1.1.1.1.1.2.cmml" xref="A1.Ex4.m2.6.6.1.1.1.1.1.2">
               </times>
               <apply id="A1.Ex4.m2.6.6.1.1.1.1.1.3.cmml" xref="A1.Ex4.m2.6.6.1.1.1.1.1.3">
                <csymbol cd="ambiguous" id="A1.Ex4.m2.6.6.1.1.1.1.1.3.1.cmml" xref="A1.Ex4.m2.6.6.1.1.1.1.1.3">
                 subscript
                </csymbol>
                <ci id="A1.Ex4.m2.6.6.1.1.1.1.1.3.2.cmml" xref="A1.Ex4.m2.6.6.1.1.1.1.1.3.2">
                 𝔼
                </ci>
                <apply id="A1.Ex4.m2.3.3.2.cmml" xref="A1.Ex4.m2.3.3.2">
                 <csymbol cd="latexml" id="A1.Ex4.m2.3.3.2.3.cmml" xref="A1.Ex4.m2.3.3.2.3">
                  similar-to
                 </csymbol>
                 <apply id="A1.Ex4.m2.3.3.2.4.cmml" xref="A1.Ex4.m2.3.3.2.4">
                  <csymbol cd="ambiguous" id="A1.Ex4.m2.3.3.2.4.1.cmml" xref="A1.Ex4.m2.3.3.2.4">
                   subscript
                  </csymbol>
                  <ci id="A1.Ex4.m2.3.3.2.4.2.cmml" xref="A1.Ex4.m2.3.3.2.4.2">
                   𝑤
                  </ci>
                  <cn id="A1.Ex4.m2.3.3.2.4.3.cmml" type="integer" xref="A1.Ex4.m2.3.3.2.4.3">
                   2
                  </cn>
                 </apply>
                 <apply id="A1.Ex4.m2.3.3.2.2.cmml" xref="A1.Ex4.m2.3.3.2.2">
                  <times id="A1.Ex4.m2.3.3.2.2.2.cmml" xref="A1.Ex4.m2.3.3.2.2.2">
                  </times>
                  <apply id="A1.Ex4.m2.3.3.2.2.3.cmml" xref="A1.Ex4.m2.3.3.2.2.3">
                   <csymbol cd="ambiguous" id="A1.Ex4.m2.3.3.2.2.3.1.cmml" xref="A1.Ex4.m2.3.3.2.2.3">
                    superscript
                   </csymbol>
                   <ci id="A1.Ex4.m2.3.3.2.2.3.2.cmml" xref="A1.Ex4.m2.3.3.2.2.3.2">
                    𝜋
                   </ci>
                   <times id="A1.Ex4.m2.3.3.2.2.3.3.cmml" xref="A1.Ex4.m2.3.3.2.2.3.3">
                   </times>
                  </apply>
                  <interval closure="open" id="A1.Ex4.m2.3.3.2.2.1.2.cmml" xref="A1.Ex4.m2.3.3.2.2.1.1">
                   <ci id="A1.Ex4.m2.2.2.1.1.cmml" xref="A1.Ex4.m2.2.2.1.1">
                    𝑠
                   </ci>
                   <apply id="A1.Ex4.m2.3.3.2.2.1.1.1.cmml" xref="A1.Ex4.m2.3.3.2.2.1.1.1">
                    <csymbol cd="ambiguous" id="A1.Ex4.m2.3.3.2.2.1.1.1.1.cmml" xref="A1.Ex4.m2.3.3.2.2.1.1.1">
                     subscript
                    </csymbol>
                    <ci id="A1.Ex4.m2.3.3.2.2.1.1.1.2.cmml" xref="A1.Ex4.m2.3.3.2.2.1.1.1.2">
                     𝑤
                    </ci>
                    <cn id="A1.Ex4.m2.3.3.2.2.1.1.1.3.cmml" type="integer" xref="A1.Ex4.m2.3.3.2.2.1.1.1.3">
                     1
                    </cn>
                   </apply>
                  </interval>
                 </apply>
                </apply>
               </apply>
               <apply id="A1.Ex4.m2.6.6.1.1.1.1.1.1.2.cmml" xref="A1.Ex4.m2.6.6.1.1.1.1.1.1.1">
                <csymbol cd="latexml" id="A1.Ex4.m2.6.6.1.1.1.1.1.1.2.1.cmml" xref="A1.Ex4.m2.6.6.1.1.1.1.1.1.1.2">
                 delimited-[]
                </csymbol>
                <apply id="A1.Ex4.m2.6.6.1.1.1.1.1.1.1.1.cmml" xref="A1.Ex4.m2.6.6.1.1.1.1.1.1.1.1">
                 <times id="A1.Ex4.m2.6.6.1.1.1.1.1.1.1.1.3.cmml" xref="A1.Ex4.m2.6.6.1.1.1.1.1.1.1.1.3">
                 </times>
                 <ci id="A1.Ex4.m2.6.6.1.1.1.1.1.1.1.1.4.cmml" xref="A1.Ex4.m2.6.6.1.1.1.1.1.1.1.1.4">
                  𝑄
                 </ci>
                 <vector id="A1.Ex4.m2.6.6.1.1.1.1.1.1.1.1.2.3.cmml" xref="A1.Ex4.m2.6.6.1.1.1.1.1.1.1.1.2.2">
                  <ci id="A1.Ex4.m2.4.4.cmml" xref="A1.Ex4.m2.4.4">
                   𝑠
                  </ci>
                  <apply id="A1.Ex4.m2.6.6.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="A1.Ex4.m2.6.6.1.1.1.1.1.1.1.1.1.1.1">
                   <csymbol cd="ambiguous" id="A1.Ex4.m2.6.6.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="A1.Ex4.m2.6.6.1.1.1.1.1.1.1.1.1.1.1">
                    subscript
                   </csymbol>
                   <ci id="A1.Ex4.m2.6.6.1.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="A1.Ex4.m2.6.6.1.1.1.1.1.1.1.1.1.1.1.2">
                    𝑤
                   </ci>
                   <cn id="A1.Ex4.m2.6.6.1.1.1.1.1.1.1.1.1.1.1.3.cmml" type="integer" xref="A1.Ex4.m2.6.6.1.1.1.1.1.1.1.1.1.1.1.3">
                    1
                   </cn>
                  </apply>
                  <apply id="A1.Ex4.m2.6.6.1.1.1.1.1.1.1.1.2.2.2.cmml" xref="A1.Ex4.m2.6.6.1.1.1.1.1.1.1.1.2.2.2">
                   <csymbol cd="ambiguous" id="A1.Ex4.m2.6.6.1.1.1.1.1.1.1.1.2.2.2.1.cmml" xref="A1.Ex4.m2.6.6.1.1.1.1.1.1.1.1.2.2.2">
                    subscript
                   </csymbol>
                   <ci id="A1.Ex4.m2.6.6.1.1.1.1.1.1.1.1.2.2.2.2.cmml" xref="A1.Ex4.m2.6.6.1.1.1.1.1.1.1.1.2.2.2.2">
                    𝑤
                   </ci>
                   <cn id="A1.Ex4.m2.6.6.1.1.1.1.1.1.1.1.2.2.2.3.cmml" type="integer" xref="A1.Ex4.m2.6.6.1.1.1.1.1.1.1.1.2.2.2.3">
                    2
                   </cn>
                  </apply>
                 </vector>
                </apply>
               </apply>
              </apply>
              <apply id="A1.Ex4.m2.6.6.1.1.1.1.2.cmml" xref="A1.Ex4.m2.6.6.1.1.1.1.2">
               <times id="A1.Ex4.m2.6.6.1.1.1.1.2.2.cmml" xref="A1.Ex4.m2.6.6.1.1.1.1.2.2">
               </times>
               <ci id="A1.Ex4.m2.6.6.1.1.1.1.2.3.cmml" xref="A1.Ex4.m2.6.6.1.1.1.1.2.3">
                𝛽
               </ci>
               <ci id="A1.Ex4.m2.6.6.1.1.1.1.2.4a.cmml" xref="A1.Ex4.m2.6.6.1.1.1.1.2.4">
                <mtext id="A1.Ex4.m2.6.6.1.1.1.1.2.4.cmml" xref="A1.Ex4.m2.6.6.1.1.1.1.2.4">
                 KL
                </mtext>
               </ci>
               <apply id="A1.Ex4.m2.6.6.1.1.1.1.2.1.1.1.cmml" xref="A1.Ex4.m2.6.6.1.1.1.1.2.1.1">
                <csymbol cd="latexml" id="A1.Ex4.m2.6.6.1.1.1.1.2.1.1.1.2.cmml" xref="A1.Ex4.m2.6.6.1.1.1.1.2.1.1.1.2">
                 conditional
                </csymbol>
                <apply id="A1.Ex4.m2.6.6.1.1.1.1.2.1.1.1.3.cmml" xref="A1.Ex4.m2.6.6.1.1.1.1.2.1.1.1.3">
                 <csymbol cd="ambiguous" id="A1.Ex4.m2.6.6.1.1.1.1.2.1.1.1.3.1.cmml" xref="A1.Ex4.m2.6.6.1.1.1.1.2.1.1.1.3">
                  subscript
                 </csymbol>
                 <ci id="A1.Ex4.m2.6.6.1.1.1.1.2.1.1.1.3.2.cmml" xref="A1.Ex4.m2.6.6.1.1.1.1.2.1.1.1.3.2">
                  𝑤
                 </ci>
                 <cn id="A1.Ex4.m2.6.6.1.1.1.1.2.1.1.1.3.3.cmml" type="integer" xref="A1.Ex4.m2.6.6.1.1.1.1.2.1.1.1.3.3">
                  2
                 </cn>
                </apply>
                <list id="A1.Ex4.m2.6.6.1.1.1.1.2.1.1.1.1.2.cmml" xref="A1.Ex4.m2.6.6.1.1.1.1.2.1.1.1.1.1">
                 <ci id="A1.Ex4.m2.5.5.cmml" xref="A1.Ex4.m2.5.5">
                  𝑠
                 </ci>
                 <apply id="A1.Ex4.m2.6.6.1.1.1.1.2.1.1.1.1.1.1.cmml" xref="A1.Ex4.m2.6.6.1.1.1.1.2.1.1.1.1.1.1">
                  <csymbol cd="ambiguous" id="A1.Ex4.m2.6.6.1.1.1.1.2.1.1.1.1.1.1.1.cmml" xref="A1.Ex4.m2.6.6.1.1.1.1.2.1.1.1.1.1.1">
                   subscript
                  </csymbol>
                  <ci id="A1.Ex4.m2.6.6.1.1.1.1.2.1.1.1.1.1.1.2.cmml" xref="A1.Ex4.m2.6.6.1.1.1.1.2.1.1.1.1.1.1.2">
                   𝑤
                  </ci>
                  <cn id="A1.Ex4.m2.6.6.1.1.1.1.2.1.1.1.1.1.1.3.cmml" type="integer" xref="A1.Ex4.m2.6.6.1.1.1.1.2.1.1.1.1.1.1.3">
                   1
                  </cn>
                 </apply>
                </list>
               </apply>
              </apply>
             </apply>
            </apply>
           </apply>
          </apply>
         </annotation-xml>
         <annotation encoding="application/x-tex" id="A1.Ex4.m2.6c">
          \displaystyle=\mathbb{E}_{w_{1}\sim\pi^{*}(s)}[\mathbb{E}_{w_{2}\sim\pi^{*}(s,w_{1})}[Q(s,w_{1},w_{2})]-\beta\text{KL}(w_{2}|s,w_{1})]
         </annotation>
        </semantics>
       </math>
      </td>
      <td class="ltx_eqn_cell ltx_eqn_center_padright">
      </td>
     </tr>
    </tbody>
    <tbody id="A1.Ex5">
     <tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
      <td class="ltx_eqn_cell ltx_eqn_center_padleft">
      </td>
      <td class="ltx_td ltx_eqn_cell">
      </td>
      <td class="ltx_td ltx_align_left ltx_eqn_cell">
       <math alttext="\displaystyle=\mathbb{E}_{w_{1}\sim\pi^{*}(s),w_{2}\sim\pi^{*}(s,w_{1})}[Q(s,w_{1},w_{2})]-\beta\mathbb{E}_{w_{1}\sim\pi^{*}(s)}[\text{KL}(w_{2}|s,w_{1})]" class="ltx_Math" display="inline" id="A1.Ex5.m1.9">
        <semantics id="A1.Ex5.m1.9a">
         <mrow id="A1.Ex5.m1.9.9" xref="A1.Ex5.m1.9.9.cmml">
          <mi id="A1.Ex5.m1.9.9.4" xref="A1.Ex5.m1.9.9.4.cmml">
          </mi>
          <mo id="A1.Ex5.m1.9.9.3" xref="A1.Ex5.m1.9.9.3.cmml">
           =
          </mo>
          <mrow id="A1.Ex5.m1.9.9.2" xref="A1.Ex5.m1.9.9.2.cmml">
           <mrow id="A1.Ex5.m1.8.8.1.1" xref="A1.Ex5.m1.8.8.1.1.cmml">
            <msub id="A1.Ex5.m1.8.8.1.1.3" xref="A1.Ex5.m1.8.8.1.1.3.cmml">
             <mi id="A1.Ex5.m1.8.8.1.1.3.2" xref="A1.Ex5.m1.8.8.1.1.3.2.cmml">
              𝔼
             </mi>
             <mrow id="A1.Ex5.m1.4.4.4.4" xref="A1.Ex5.m1.4.4.4.5.cmml">
              <mrow id="A1.Ex5.m1.3.3.3.3.1" xref="A1.Ex5.m1.3.3.3.3.1.cmml">
               <msub id="A1.Ex5.m1.3.3.3.3.1.2" xref="A1.Ex5.m1.3.3.3.3.1.2.cmml">
                <mi id="A1.Ex5.m1.3.3.3.3.1.2.2" xref="A1.Ex5.m1.3.3.3.3.1.2.2.cmml">
                 w
                </mi>
                <mn id="A1.Ex5.m1.3.3.3.3.1.2.3" xref="A1.Ex5.m1.3.3.3.3.1.2.3.cmml">
                 1
                </mn>
               </msub>
               <mo id="A1.Ex5.m1.3.3.3.3.1.1" xref="A1.Ex5.m1.3.3.3.3.1.1.cmml">
                ∼
               </mo>
               <mrow id="A1.Ex5.m1.3.3.3.3.1.3" xref="A1.Ex5.m1.3.3.3.3.1.3.cmml">
                <msup id="A1.Ex5.m1.3.3.3.3.1.3.2" xref="A1.Ex5.m1.3.3.3.3.1.3.2.cmml">
                 <mi id="A1.Ex5.m1.3.3.3.3.1.3.2.2" xref="A1.Ex5.m1.3.3.3.3.1.3.2.2.cmml">
                  π
                 </mi>
                 <mo id="A1.Ex5.m1.3.3.3.3.1.3.2.3" xref="A1.Ex5.m1.3.3.3.3.1.3.2.3.cmml">
                  ∗
                 </mo>
                </msup>
                <mo id="A1.Ex5.m1.3.3.3.3.1.3.1" lspace="0em" rspace="0em" xref="A1.Ex5.m1.3.3.3.3.1.3.1.cmml">
                 ​
                </mo>
                <mrow id="A1.Ex5.m1.3.3.3.3.1.3.3.2" xref="A1.Ex5.m1.3.3.3.3.1.3.cmml">
                 <mo id="A1.Ex5.m1.3.3.3.3.1.3.3.2.1" stretchy="false" xref="A1.Ex5.m1.3.3.3.3.1.3.cmml">
                  (
                 </mo>
                 <mi id="A1.Ex5.m1.1.1.1.1" xref="A1.Ex5.m1.1.1.1.1.cmml">
                  s
                 </mi>
                 <mo id="A1.Ex5.m1.3.3.3.3.1.3.3.2.2" stretchy="false" xref="A1.Ex5.m1.3.3.3.3.1.3.cmml">
                  )
                 </mo>
                </mrow>
               </mrow>
              </mrow>
              <mo id="A1.Ex5.m1.4.4.4.4.3" xref="A1.Ex5.m1.4.4.4.5a.cmml">
               ,
              </mo>
              <mrow id="A1.Ex5.m1.4.4.4.4.2" xref="A1.Ex5.m1.4.4.4.4.2.cmml">
               <msub id="A1.Ex5.m1.4.4.4.4.2.3" xref="A1.Ex5.m1.4.4.4.4.2.3.cmml">
                <mi id="A1.Ex5.m1.4.4.4.4.2.3.2" xref="A1.Ex5.m1.4.4.4.4.2.3.2.cmml">
                 w
                </mi>
                <mn id="A1.Ex5.m1.4.4.4.4.2.3.3" xref="A1.Ex5.m1.4.4.4.4.2.3.3.cmml">
                 2
                </mn>
               </msub>
               <mo id="A1.Ex5.m1.4.4.4.4.2.2" xref="A1.Ex5.m1.4.4.4.4.2.2.cmml">
                ∼
               </mo>
               <mrow id="A1.Ex5.m1.4.4.4.4.2.1" xref="A1.Ex5.m1.4.4.4.4.2.1.cmml">
                <msup id="A1.Ex5.m1.4.4.4.4.2.1.3" xref="A1.Ex5.m1.4.4.4.4.2.1.3.cmml">
                 <mi id="A1.Ex5.m1.4.4.4.4.2.1.3.2" xref="A1.Ex5.m1.4.4.4.4.2.1.3.2.cmml">
                  π
                 </mi>
                 <mo id="A1.Ex5.m1.4.4.4.4.2.1.3.3" xref="A1.Ex5.m1.4.4.4.4.2.1.3.3.cmml">
                  ∗
                 </mo>
                </msup>
                <mo id="A1.Ex5.m1.4.4.4.4.2.1.2" lspace="0em" rspace="0em" xref="A1.Ex5.m1.4.4.4.4.2.1.2.cmml">
                 ​
                </mo>
                <mrow id="A1.Ex5.m1.4.4.4.4.2.1.1.1" xref="A1.Ex5.m1.4.4.4.4.2.1.1.2.cmml">
                 <mo id="A1.Ex5.m1.4.4.4.4.2.1.1.1.2" stretchy="false" xref="A1.Ex5.m1.4.4.4.4.2.1.1.2.cmml">
                  (
                 </mo>
                 <mi id="A1.Ex5.m1.2.2.2.2" xref="A1.Ex5.m1.2.2.2.2.cmml">
                  s
                 </mi>
                 <mo id="A1.Ex5.m1.4.4.4.4.2.1.1.1.3" xref="A1.Ex5.m1.4.4.4.4.2.1.1.2.cmml">
                  ,
                 </mo>
                 <msub id="A1.Ex5.m1.4.4.4.4.2.1.1.1.1" xref="A1.Ex5.m1.4.4.4.4.2.1.1.1.1.cmml">
                  <mi id="A1.Ex5.m1.4.4.4.4.2.1.1.1.1.2" xref="A1.Ex5.m1.4.4.4.4.2.1.1.1.1.2.cmml">
                   w
                  </mi>
                  <mn id="A1.Ex5.m1.4.4.4.4.2.1.1.1.1.3" xref="A1.Ex5.m1.4.4.4.4.2.1.1.1.1.3.cmml">
                   1
                  </mn>
                 </msub>
                 <mo id="A1.Ex5.m1.4.4.4.4.2.1.1.1.4" stretchy="false" xref="A1.Ex5.m1.4.4.4.4.2.1.1.2.cmml">
                  )
                 </mo>
                </mrow>
               </mrow>
              </mrow>
             </mrow>
            </msub>
            <mo id="A1.Ex5.m1.8.8.1.1.2" lspace="0em" rspace="0em" xref="A1.Ex5.m1.8.8.1.1.2.cmml">
             ​
            </mo>
            <mrow id="A1.Ex5.m1.8.8.1.1.1.1" xref="A1.Ex5.m1.8.8.1.1.1.2.cmml">
             <mo id="A1.Ex5.m1.8.8.1.1.1.1.2" stretchy="false" xref="A1.Ex5.m1.8.8.1.1.1.2.1.cmml">
              [
             </mo>
             <mrow id="A1.Ex5.m1.8.8.1.1.1.1.1" xref="A1.Ex5.m1.8.8.1.1.1.1.1.cmml">
              <mi id="A1.Ex5.m1.8.8.1.1.1.1.1.4" xref="A1.Ex5.m1.8.8.1.1.1.1.1.4.cmml">
               Q
              </mi>
              <mo id="A1.Ex5.m1.8.8.1.1.1.1.1.3" lspace="0em" rspace="0em" xref="A1.Ex5.m1.8.8.1.1.1.1.1.3.cmml">
               ​
              </mo>
              <mrow id="A1.Ex5.m1.8.8.1.1.1.1.1.2.2" xref="A1.Ex5.m1.8.8.1.1.1.1.1.2.3.cmml">
               <mo id="A1.Ex5.m1.8.8.1.1.1.1.1.2.2.3" stretchy="false" xref="A1.Ex5.m1.8.8.1.1.1.1.1.2.3.cmml">
                (
               </mo>
               <mi id="A1.Ex5.m1.6.6" xref="A1.Ex5.m1.6.6.cmml">
                s
               </mi>
               <mo id="A1.Ex5.m1.8.8.1.1.1.1.1.2.2.4" xref="A1.Ex5.m1.8.8.1.1.1.1.1.2.3.cmml">
                ,
               </mo>
               <msub id="A1.Ex5.m1.8.8.1.1.1.1.1.1.1.1" xref="A1.Ex5.m1.8.8.1.1.1.1.1.1.1.1.cmml">
                <mi id="A1.Ex5.m1.8.8.1.1.1.1.1.1.1.1.2" xref="A1.Ex5.m1.8.8.1.1.1.1.1.1.1.1.2.cmml">
                 w
                </mi>
                <mn id="A1.Ex5.m1.8.8.1.1.1.1.1.1.1.1.3" xref="A1.Ex5.m1.8.8.1.1.1.1.1.1.1.1.3.cmml">
                 1
                </mn>
               </msub>
               <mo id="A1.Ex5.m1.8.8.1.1.1.1.1.2.2.5" xref="A1.Ex5.m1.8.8.1.1.1.1.1.2.3.cmml">
                ,
               </mo>
               <msub id="A1.Ex5.m1.8.8.1.1.1.1.1.2.2.2" xref="A1.Ex5.m1.8.8.1.1.1.1.1.2.2.2.cmml">
                <mi id="A1.Ex5.m1.8.8.1.1.1.1.1.2.2.2.2" xref="A1.Ex5.m1.8.8.1.1.1.1.1.2.2.2.2.cmml">
                 w
                </mi>
                <mn id="A1.Ex5.m1.8.8.1.1.1.1.1.2.2.2.3" xref="A1.Ex5.m1.8.8.1.1.1.1.1.2.2.2.3.cmml">
                 2
                </mn>
               </msub>
               <mo id="A1.Ex5.m1.8.8.1.1.1.1.1.2.2.6" stretchy="false" xref="A1.Ex5.m1.8.8.1.1.1.1.1.2.3.cmml">
                )
               </mo>
              </mrow>
             </mrow>
             <mo id="A1.Ex5.m1.8.8.1.1.1.1.3" stretchy="false" xref="A1.Ex5.m1.8.8.1.1.1.2.1.cmml">
              ]
             </mo>
            </mrow>
           </mrow>
           <mo id="A1.Ex5.m1.9.9.2.3" xref="A1.Ex5.m1.9.9.2.3.cmml">
            −
           </mo>
           <mrow id="A1.Ex5.m1.9.9.2.2" xref="A1.Ex5.m1.9.9.2.2.cmml">
            <mi id="A1.Ex5.m1.9.9.2.2.3" xref="A1.Ex5.m1.9.9.2.2.3.cmml">
             β
            </mi>
            <mo id="A1.Ex5.m1.9.9.2.2.2" lspace="0em" rspace="0em" xref="A1.Ex5.m1.9.9.2.2.2.cmml">
             ​
            </mo>
            <msub id="A1.Ex5.m1.9.9.2.2.4" xref="A1.Ex5.m1.9.9.2.2.4.cmml">
             <mi id="A1.Ex5.m1.9.9.2.2.4.2" xref="A1.Ex5.m1.9.9.2.2.4.2.cmml">
              𝔼
             </mi>
             <mrow id="A1.Ex5.m1.5.5.1" xref="A1.Ex5.m1.5.5.1.cmml">
              <msub id="A1.Ex5.m1.5.5.1.3" xref="A1.Ex5.m1.5.5.1.3.cmml">
               <mi id="A1.Ex5.m1.5.5.1.3.2" xref="A1.Ex5.m1.5.5.1.3.2.cmml">
                w
               </mi>
               <mn id="A1.Ex5.m1.5.5.1.3.3" xref="A1.Ex5.m1.5.5.1.3.3.cmml">
                1
               </mn>
              </msub>
              <mo id="A1.Ex5.m1.5.5.1.2" xref="A1.Ex5.m1.5.5.1.2.cmml">
               ∼
              </mo>
              <mrow id="A1.Ex5.m1.5.5.1.4" xref="A1.Ex5.m1.5.5.1.4.cmml">
               <msup id="A1.Ex5.m1.5.5.1.4.2" xref="A1.Ex5.m1.5.5.1.4.2.cmml">
                <mi id="A1.Ex5.m1.5.5.1.4.2.2" xref="A1.Ex5.m1.5.5.1.4.2.2.cmml">
                 π
                </mi>
                <mo id="A1.Ex5.m1.5.5.1.4.2.3" xref="A1.Ex5.m1.5.5.1.4.2.3.cmml">
                 ∗
                </mo>
               </msup>
               <mo id="A1.Ex5.m1.5.5.1.4.1" lspace="0em" rspace="0em" xref="A1.Ex5.m1.5.5.1.4.1.cmml">
                ​
               </mo>
               <mrow id="A1.Ex5.m1.5.5.1.4.3.2" xref="A1.Ex5.m1.5.5.1.4.cmml">
                <mo id="A1.Ex5.m1.5.5.1.4.3.2.1" stretchy="false" xref="A1.Ex5.m1.5.5.1.4.cmml">
                 (
                </mo>
                <mi id="A1.Ex5.m1.5.5.1.1" xref="A1.Ex5.m1.5.5.1.1.cmml">
                 s
                </mi>
                <mo id="A1.Ex5.m1.5.5.1.4.3.2.2" stretchy="false" xref="A1.Ex5.m1.5.5.1.4.cmml">
                 )
                </mo>
               </mrow>
              </mrow>
             </mrow>
            </msub>
            <mo id="A1.Ex5.m1.9.9.2.2.2a" lspace="0em" rspace="0em" xref="A1.Ex5.m1.9.9.2.2.2.cmml">
             ​
            </mo>
            <mrow id="A1.Ex5.m1.9.9.2.2.1.1" xref="A1.Ex5.m1.9.9.2.2.1.2.cmml">
             <mo id="A1.Ex5.m1.9.9.2.2.1.1.2" stretchy="false" xref="A1.Ex5.m1.9.9.2.2.1.2.1.cmml">
              [
             </mo>
             <mrow id="A1.Ex5.m1.9.9.2.2.1.1.1" xref="A1.Ex5.m1.9.9.2.2.1.1.1.cmml">
              <mtext id="A1.Ex5.m1.9.9.2.2.1.1.1.3" xref="A1.Ex5.m1.9.9.2.2.1.1.1.3a.cmml">
               KL
              </mtext>
              <mo id="A1.Ex5.m1.9.9.2.2.1.1.1.2" lspace="0em" rspace="0em" xref="A1.Ex5.m1.9.9.2.2.1.1.1.2.cmml">
               ​
              </mo>
              <mrow id="A1.Ex5.m1.9.9.2.2.1.1.1.1.1" xref="A1.Ex5.m1.9.9.2.2.1.1.1.1.1.1.cmml">
               <mo id="A1.Ex5.m1.9.9.2.2.1.1.1.1.1.2" stretchy="false" xref="A1.Ex5.m1.9.9.2.2.1.1.1.1.1.1.cmml">
                (
               </mo>
               <mrow id="A1.Ex5.m1.9.9.2.2.1.1.1.1.1.1" xref="A1.Ex5.m1.9.9.2.2.1.1.1.1.1.1.cmml">
                <msub id="A1.Ex5.m1.9.9.2.2.1.1.1.1.1.1.3" xref="A1.Ex5.m1.9.9.2.2.1.1.1.1.1.1.3.cmml">
                 <mi id="A1.Ex5.m1.9.9.2.2.1.1.1.1.1.1.3.2" xref="A1.Ex5.m1.9.9.2.2.1.1.1.1.1.1.3.2.cmml">
                  w
                 </mi>
                 <mn id="A1.Ex5.m1.9.9.2.2.1.1.1.1.1.1.3.3" xref="A1.Ex5.m1.9.9.2.2.1.1.1.1.1.1.3.3.cmml">
                  2
                 </mn>
                </msub>
                <mo fence="false" id="A1.Ex5.m1.9.9.2.2.1.1.1.1.1.1.2" xref="A1.Ex5.m1.9.9.2.2.1.1.1.1.1.1.2.cmml">
                 |
                </mo>
                <mrow id="A1.Ex5.m1.9.9.2.2.1.1.1.1.1.1.1.1" xref="A1.Ex5.m1.9.9.2.2.1.1.1.1.1.1.1.2.cmml">
                 <mi id="A1.Ex5.m1.7.7" xref="A1.Ex5.m1.7.7.cmml">
                  s
                 </mi>
                 <mo id="A1.Ex5.m1.9.9.2.2.1.1.1.1.1.1.1.1.2" xref="A1.Ex5.m1.9.9.2.2.1.1.1.1.1.1.1.2.cmml">
                  ,
                 </mo>
                 <msub id="A1.Ex5.m1.9.9.2.2.1.1.1.1.1.1.1.1.1" xref="A1.Ex5.m1.9.9.2.2.1.1.1.1.1.1.1.1.1.cmml">
                  <mi id="A1.Ex5.m1.9.9.2.2.1.1.1.1.1.1.1.1.1.2" xref="A1.Ex5.m1.9.9.2.2.1.1.1.1.1.1.1.1.1.2.cmml">
                   w
                  </mi>
                  <mn id="A1.Ex5.m1.9.9.2.2.1.1.1.1.1.1.1.1.1.3" xref="A1.Ex5.m1.9.9.2.2.1.1.1.1.1.1.1.1.1.3.cmml">
                   1
                  </mn>
                 </msub>
                </mrow>
               </mrow>
               <mo id="A1.Ex5.m1.9.9.2.2.1.1.1.1.1.3" stretchy="false" xref="A1.Ex5.m1.9.9.2.2.1.1.1.1.1.1.cmml">
                )
               </mo>
              </mrow>
             </mrow>
             <mo id="A1.Ex5.m1.9.9.2.2.1.1.3" stretchy="false" xref="A1.Ex5.m1.9.9.2.2.1.2.1.cmml">
              ]
             </mo>
            </mrow>
           </mrow>
          </mrow>
         </mrow>
         <annotation-xml encoding="MathML-Content" id="A1.Ex5.m1.9b">
          <apply id="A1.Ex5.m1.9.9.cmml" xref="A1.Ex5.m1.9.9">
           <eq id="A1.Ex5.m1.9.9.3.cmml" xref="A1.Ex5.m1.9.9.3">
           </eq>
           <csymbol cd="latexml" id="A1.Ex5.m1.9.9.4.cmml" xref="A1.Ex5.m1.9.9.4">
            absent
           </csymbol>
           <apply id="A1.Ex5.m1.9.9.2.cmml" xref="A1.Ex5.m1.9.9.2">
            <minus id="A1.Ex5.m1.9.9.2.3.cmml" xref="A1.Ex5.m1.9.9.2.3">
            </minus>
            <apply id="A1.Ex5.m1.8.8.1.1.cmml" xref="A1.Ex5.m1.8.8.1.1">
             <times id="A1.Ex5.m1.8.8.1.1.2.cmml" xref="A1.Ex5.m1.8.8.1.1.2">
             </times>
             <apply id="A1.Ex5.m1.8.8.1.1.3.cmml" xref="A1.Ex5.m1.8.8.1.1.3">
              <csymbol cd="ambiguous" id="A1.Ex5.m1.8.8.1.1.3.1.cmml" xref="A1.Ex5.m1.8.8.1.1.3">
               subscript
              </csymbol>
              <ci id="A1.Ex5.m1.8.8.1.1.3.2.cmml" xref="A1.Ex5.m1.8.8.1.1.3.2">
               𝔼
              </ci>
              <apply id="A1.Ex5.m1.4.4.4.5.cmml" xref="A1.Ex5.m1.4.4.4.4">
               <csymbol cd="ambiguous" id="A1.Ex5.m1.4.4.4.5a.cmml" xref="A1.Ex5.m1.4.4.4.4.3">
                formulae-sequence
               </csymbol>
               <apply id="A1.Ex5.m1.3.3.3.3.1.cmml" xref="A1.Ex5.m1.3.3.3.3.1">
                <csymbol cd="latexml" id="A1.Ex5.m1.3.3.3.3.1.1.cmml" xref="A1.Ex5.m1.3.3.3.3.1.1">
                 similar-to
                </csymbol>
                <apply id="A1.Ex5.m1.3.3.3.3.1.2.cmml" xref="A1.Ex5.m1.3.3.3.3.1.2">
                 <csymbol cd="ambiguous" id="A1.Ex5.m1.3.3.3.3.1.2.1.cmml" xref="A1.Ex5.m1.3.3.3.3.1.2">
                  subscript
                 </csymbol>
                 <ci id="A1.Ex5.m1.3.3.3.3.1.2.2.cmml" xref="A1.Ex5.m1.3.3.3.3.1.2.2">
                  𝑤
                 </ci>
                 <cn id="A1.Ex5.m1.3.3.3.3.1.2.3.cmml" type="integer" xref="A1.Ex5.m1.3.3.3.3.1.2.3">
                  1
                 </cn>
                </apply>
                <apply id="A1.Ex5.m1.3.3.3.3.1.3.cmml" xref="A1.Ex5.m1.3.3.3.3.1.3">
                 <times id="A1.Ex5.m1.3.3.3.3.1.3.1.cmml" xref="A1.Ex5.m1.3.3.3.3.1.3.1">
                 </times>
                 <apply id="A1.Ex5.m1.3.3.3.3.1.3.2.cmml" xref="A1.Ex5.m1.3.3.3.3.1.3.2">
                  <csymbol cd="ambiguous" id="A1.Ex5.m1.3.3.3.3.1.3.2.1.cmml" xref="A1.Ex5.m1.3.3.3.3.1.3.2">
                   superscript
                  </csymbol>
                  <ci id="A1.Ex5.m1.3.3.3.3.1.3.2.2.cmml" xref="A1.Ex5.m1.3.3.3.3.1.3.2.2">
                   𝜋
                  </ci>
                  <times id="A1.Ex5.m1.3.3.3.3.1.3.2.3.cmml" xref="A1.Ex5.m1.3.3.3.3.1.3.2.3">
                  </times>
                 </apply>
                 <ci id="A1.Ex5.m1.1.1.1.1.cmml" xref="A1.Ex5.m1.1.1.1.1">
                  𝑠
                 </ci>
                </apply>
               </apply>
               <apply id="A1.Ex5.m1.4.4.4.4.2.cmml" xref="A1.Ex5.m1.4.4.4.4.2">
                <csymbol cd="latexml" id="A1.Ex5.m1.4.4.4.4.2.2.cmml" xref="A1.Ex5.m1.4.4.4.4.2.2">
                 similar-to
                </csymbol>
                <apply id="A1.Ex5.m1.4.4.4.4.2.3.cmml" xref="A1.Ex5.m1.4.4.4.4.2.3">
                 <csymbol cd="ambiguous" id="A1.Ex5.m1.4.4.4.4.2.3.1.cmml" xref="A1.Ex5.m1.4.4.4.4.2.3">
                  subscript
                 </csymbol>
                 <ci id="A1.Ex5.m1.4.4.4.4.2.3.2.cmml" xref="A1.Ex5.m1.4.4.4.4.2.3.2">
                  𝑤
                 </ci>
                 <cn id="A1.Ex5.m1.4.4.4.4.2.3.3.cmml" type="integer" xref="A1.Ex5.m1.4.4.4.4.2.3.3">
                  2
                 </cn>
                </apply>
                <apply id="A1.Ex5.m1.4.4.4.4.2.1.cmml" xref="A1.Ex5.m1.4.4.4.4.2.1">
                 <times id="A1.Ex5.m1.4.4.4.4.2.1.2.cmml" xref="A1.Ex5.m1.4.4.4.4.2.1.2">
                 </times>
                 <apply id="A1.Ex5.m1.4.4.4.4.2.1.3.cmml" xref="A1.Ex5.m1.4.4.4.4.2.1.3">
                  <csymbol cd="ambiguous" id="A1.Ex5.m1.4.4.4.4.2.1.3.1.cmml" xref="A1.Ex5.m1.4.4.4.4.2.1.3">
                   superscript
                  </csymbol>
                  <ci id="A1.Ex5.m1.4.4.4.4.2.1.3.2.cmml" xref="A1.Ex5.m1.4.4.4.4.2.1.3.2">
                   𝜋
                  </ci>
                  <times id="A1.Ex5.m1.4.4.4.4.2.1.3.3.cmml" xref="A1.Ex5.m1.4.4.4.4.2.1.3.3">
                  </times>
                 </apply>
                 <interval closure="open" id="A1.Ex5.m1.4.4.4.4.2.1.1.2.cmml" xref="A1.Ex5.m1.4.4.4.4.2.1.1.1">
                  <ci id="A1.Ex5.m1.2.2.2.2.cmml" xref="A1.Ex5.m1.2.2.2.2">
                   𝑠
                  </ci>
                  <apply id="A1.Ex5.m1.4.4.4.4.2.1.1.1.1.cmml" xref="A1.Ex5.m1.4.4.4.4.2.1.1.1.1">
                   <csymbol cd="ambiguous" id="A1.Ex5.m1.4.4.4.4.2.1.1.1.1.1.cmml" xref="A1.Ex5.m1.4.4.4.4.2.1.1.1.1">
                    subscript
                   </csymbol>
                   <ci id="A1.Ex5.m1.4.4.4.4.2.1.1.1.1.2.cmml" xref="A1.Ex5.m1.4.4.4.4.2.1.1.1.1.2">
                    𝑤
                   </ci>
                   <cn id="A1.Ex5.m1.4.4.4.4.2.1.1.1.1.3.cmml" type="integer" xref="A1.Ex5.m1.4.4.4.4.2.1.1.1.1.3">
                    1
                   </cn>
                  </apply>
                 </interval>
                </apply>
               </apply>
              </apply>
             </apply>
             <apply id="A1.Ex5.m1.8.8.1.1.1.2.cmml" xref="A1.Ex5.m1.8.8.1.1.1.1">
              <csymbol cd="latexml" id="A1.Ex5.m1.8.8.1.1.1.2.1.cmml" xref="A1.Ex5.m1.8.8.1.1.1.1.2">
               delimited-[]
              </csymbol>
              <apply id="A1.Ex5.m1.8.8.1.1.1.1.1.cmml" xref="A1.Ex5.m1.8.8.1.1.1.1.1">
               <times id="A1.Ex5.m1.8.8.1.1.1.1.1.3.cmml" xref="A1.Ex5.m1.8.8.1.1.1.1.1.3">
               </times>
               <ci id="A1.Ex5.m1.8.8.1.1.1.1.1.4.cmml" xref="A1.Ex5.m1.8.8.1.1.1.1.1.4">
                𝑄
               </ci>
               <vector id="A1.Ex5.m1.8.8.1.1.1.1.1.2.3.cmml" xref="A1.Ex5.m1.8.8.1.1.1.1.1.2.2">
                <ci id="A1.Ex5.m1.6.6.cmml" xref="A1.Ex5.m1.6.6">
                 𝑠
                </ci>
                <apply id="A1.Ex5.m1.8.8.1.1.1.1.1.1.1.1.cmml" xref="A1.Ex5.m1.8.8.1.1.1.1.1.1.1.1">
                 <csymbol cd="ambiguous" id="A1.Ex5.m1.8.8.1.1.1.1.1.1.1.1.1.cmml" xref="A1.Ex5.m1.8.8.1.1.1.1.1.1.1.1">
                  subscript
                 </csymbol>
                 <ci id="A1.Ex5.m1.8.8.1.1.1.1.1.1.1.1.2.cmml" xref="A1.Ex5.m1.8.8.1.1.1.1.1.1.1.1.2">
                  𝑤
                 </ci>
                 <cn id="A1.Ex5.m1.8.8.1.1.1.1.1.1.1.1.3.cmml" type="integer" xref="A1.Ex5.m1.8.8.1.1.1.1.1.1.1.1.3">
                  1
                 </cn>
                </apply>
                <apply id="A1.Ex5.m1.8.8.1.1.1.1.1.2.2.2.cmml" xref="A1.Ex5.m1.8.8.1.1.1.1.1.2.2.2">
                 <csymbol cd="ambiguous" id="A1.Ex5.m1.8.8.1.1.1.1.1.2.2.2.1.cmml" xref="A1.Ex5.m1.8.8.1.1.1.1.1.2.2.2">
                  subscript
                 </csymbol>
                 <ci id="A1.Ex5.m1.8.8.1.1.1.1.1.2.2.2.2.cmml" xref="A1.Ex5.m1.8.8.1.1.1.1.1.2.2.2.2">
                  𝑤
                 </ci>
                 <cn id="A1.Ex5.m1.8.8.1.1.1.1.1.2.2.2.3.cmml" type="integer" xref="A1.Ex5.m1.8.8.1.1.1.1.1.2.2.2.3">
                  2
                 </cn>
                </apply>
               </vector>
              </apply>
             </apply>
            </apply>
            <apply id="A1.Ex5.m1.9.9.2.2.cmml" xref="A1.Ex5.m1.9.9.2.2">
             <times id="A1.Ex5.m1.9.9.2.2.2.cmml" xref="A1.Ex5.m1.9.9.2.2.2">
             </times>
             <ci id="A1.Ex5.m1.9.9.2.2.3.cmml" xref="A1.Ex5.m1.9.9.2.2.3">
              𝛽
             </ci>
             <apply id="A1.Ex5.m1.9.9.2.2.4.cmml" xref="A1.Ex5.m1.9.9.2.2.4">
              <csymbol cd="ambiguous" id="A1.Ex5.m1.9.9.2.2.4.1.cmml" xref="A1.Ex5.m1.9.9.2.2.4">
               subscript
              </csymbol>
              <ci id="A1.Ex5.m1.9.9.2.2.4.2.cmml" xref="A1.Ex5.m1.9.9.2.2.4.2">
               𝔼
              </ci>
              <apply id="A1.Ex5.m1.5.5.1.cmml" xref="A1.Ex5.m1.5.5.1">
               <csymbol cd="latexml" id="A1.Ex5.m1.5.5.1.2.cmml" xref="A1.Ex5.m1.5.5.1.2">
                similar-to
               </csymbol>
               <apply id="A1.Ex5.m1.5.5.1.3.cmml" xref="A1.Ex5.m1.5.5.1.3">
                <csymbol cd="ambiguous" id="A1.Ex5.m1.5.5.1.3.1.cmml" xref="A1.Ex5.m1.5.5.1.3">
                 subscript
                </csymbol>
                <ci id="A1.Ex5.m1.5.5.1.3.2.cmml" xref="A1.Ex5.m1.5.5.1.3.2">
                 𝑤
                </ci>
                <cn id="A1.Ex5.m1.5.5.1.3.3.cmml" type="integer" xref="A1.Ex5.m1.5.5.1.3.3">
                 1
                </cn>
               </apply>
               <apply id="A1.Ex5.m1.5.5.1.4.cmml" xref="A1.Ex5.m1.5.5.1.4">
                <times id="A1.Ex5.m1.5.5.1.4.1.cmml" xref="A1.Ex5.m1.5.5.1.4.1">
                </times>
                <apply id="A1.Ex5.m1.5.5.1.4.2.cmml" xref="A1.Ex5.m1.5.5.1.4.2">
                 <csymbol cd="ambiguous" id="A1.Ex5.m1.5.5.1.4.2.1.cmml" xref="A1.Ex5.m1.5.5.1.4.2">
                  superscript
                 </csymbol>
                 <ci id="A1.Ex5.m1.5.5.1.4.2.2.cmml" xref="A1.Ex5.m1.5.5.1.4.2.2">
                  𝜋
                 </ci>
                 <times id="A1.Ex5.m1.5.5.1.4.2.3.cmml" xref="A1.Ex5.m1.5.5.1.4.2.3">
                 </times>
                </apply>
                <ci id="A1.Ex5.m1.5.5.1.1.cmml" xref="A1.Ex5.m1.5.5.1.1">
                 𝑠
                </ci>
               </apply>
              </apply>
             </apply>
             <apply id="A1.Ex5.m1.9.9.2.2.1.2.cmml" xref="A1.Ex5.m1.9.9.2.2.1.1">
              <csymbol cd="latexml" id="A1.Ex5.m1.9.9.2.2.1.2.1.cmml" xref="A1.Ex5.m1.9.9.2.2.1.1.2">
               delimited-[]
              </csymbol>
              <apply id="A1.Ex5.m1.9.9.2.2.1.1.1.cmml" xref="A1.Ex5.m1.9.9.2.2.1.1.1">
               <times id="A1.Ex5.m1.9.9.2.2.1.1.1.2.cmml" xref="A1.Ex5.m1.9.9.2.2.1.1.1.2">
               </times>
               <ci id="A1.Ex5.m1.9.9.2.2.1.1.1.3a.cmml" xref="A1.Ex5.m1.9.9.2.2.1.1.1.3">
                <mtext id="A1.Ex5.m1.9.9.2.2.1.1.1.3.cmml" xref="A1.Ex5.m1.9.9.2.2.1.1.1.3">
                 KL
                </mtext>
               </ci>
               <apply id="A1.Ex5.m1.9.9.2.2.1.1.1.1.1.1.cmml" xref="A1.Ex5.m1.9.9.2.2.1.1.1.1.1">
                <csymbol cd="latexml" id="A1.Ex5.m1.9.9.2.2.1.1.1.1.1.1.2.cmml" xref="A1.Ex5.m1.9.9.2.2.1.1.1.1.1.1.2">
                 conditional
                </csymbol>
                <apply id="A1.Ex5.m1.9.9.2.2.1.1.1.1.1.1.3.cmml" xref="A1.Ex5.m1.9.9.2.2.1.1.1.1.1.1.3">
                 <csymbol cd="ambiguous" id="A1.Ex5.m1.9.9.2.2.1.1.1.1.1.1.3.1.cmml" xref="A1.Ex5.m1.9.9.2.2.1.1.1.1.1.1.3">
                  subscript
                 </csymbol>
                 <ci id="A1.Ex5.m1.9.9.2.2.1.1.1.1.1.1.3.2.cmml" xref="A1.Ex5.m1.9.9.2.2.1.1.1.1.1.1.3.2">
                  𝑤
                 </ci>
                 <cn id="A1.Ex5.m1.9.9.2.2.1.1.1.1.1.1.3.3.cmml" type="integer" xref="A1.Ex5.m1.9.9.2.2.1.1.1.1.1.1.3.3">
                  2
                 </cn>
                </apply>
                <list id="A1.Ex5.m1.9.9.2.2.1.1.1.1.1.1.1.2.cmml" xref="A1.Ex5.m1.9.9.2.2.1.1.1.1.1.1.1.1">
                 <ci id="A1.Ex5.m1.7.7.cmml" xref="A1.Ex5.m1.7.7">
                  𝑠
                 </ci>
                 <apply id="A1.Ex5.m1.9.9.2.2.1.1.1.1.1.1.1.1.1.cmml" xref="A1.Ex5.m1.9.9.2.2.1.1.1.1.1.1.1.1.1">
                  <csymbol cd="ambiguous" id="A1.Ex5.m1.9.9.2.2.1.1.1.1.1.1.1.1.1.1.cmml" xref="A1.Ex5.m1.9.9.2.2.1.1.1.1.1.1.1.1.1">
                   subscript
                  </csymbol>
                  <ci id="A1.Ex5.m1.9.9.2.2.1.1.1.1.1.1.1.1.1.2.cmml" xref="A1.Ex5.m1.9.9.2.2.1.1.1.1.1.1.1.1.1.2">
                   𝑤
                  </ci>
                  <cn id="A1.Ex5.m1.9.9.2.2.1.1.1.1.1.1.1.1.1.3.cmml" type="integer" xref="A1.Ex5.m1.9.9.2.2.1.1.1.1.1.1.1.1.1.3">
                   1
                  </cn>
                 </apply>
                </list>
               </apply>
              </apply>
             </apply>
            </apply>
           </apply>
          </apply>
         </annotation-xml>
         <annotation encoding="application/x-tex" id="A1.Ex5.m1.9c">
          \displaystyle=\mathbb{E}_{w_{1}\sim\pi^{*}(s),w_{2}\sim\pi^{*}(s,w_{1})}[Q(s,w_{1},w_{2})]-\beta\mathbb{E}_{w_{1}\sim\pi^{*}(s)}[\text{KL}(w_{2}|s,w_{1})]
         </annotation>
        </semantics>
       </math>
      </td>
      <td class="ltx_eqn_cell ltx_eqn_center_padright">
      </td>
     </tr>
    </tbody>
    <tbody id="A1.Ex6">
     <tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
      <td class="ltx_eqn_cell ltx_eqn_center_padleft">
      </td>
      <td class="ltx_td ltx_eqn_cell">
      </td>
      <td class="ltx_td ltx_align_left ltx_eqn_cell">
       <math alttext="\displaystyle=\mathbb{E}_{w_{1}\sim\pi^{*}(s),\dots,w_{|a|}\sim\pi^{*}(s,w_{1:|a|-1})}[Q(s,w_{1:|a|-1},w_{|a|})]" class="ltx_Math" display="inline" id="A1.Ex6.m1.11">
        <semantics id="A1.Ex6.m1.11a">
         <mrow id="A1.Ex6.m1.11.11" xref="A1.Ex6.m1.11.11.cmml">
          <mi id="A1.Ex6.m1.11.11.3" xref="A1.Ex6.m1.11.11.3.cmml">
          </mi>
          <mo id="A1.Ex6.m1.11.11.2" xref="A1.Ex6.m1.11.11.2.cmml">
           =
          </mo>
          <mrow id="A1.Ex6.m1.11.11.1" xref="A1.Ex6.m1.11.11.1.cmml">
           <msub id="A1.Ex6.m1.11.11.1.3" xref="A1.Ex6.m1.11.11.1.3.cmml">
            <mi id="A1.Ex6.m1.11.11.1.3.2" xref="A1.Ex6.m1.11.11.1.3.2.cmml">
             𝔼
            </mi>
            <mrow id="A1.Ex6.m1.7.7.7.7" xref="A1.Ex6.m1.7.7.7.8.cmml">
             <mrow id="A1.Ex6.m1.6.6.6.6.1" xref="A1.Ex6.m1.6.6.6.6.1.cmml">
              <msub id="A1.Ex6.m1.6.6.6.6.1.3" xref="A1.Ex6.m1.6.6.6.6.1.3.cmml">
               <mi id="A1.Ex6.m1.6.6.6.6.1.3.2" xref="A1.Ex6.m1.6.6.6.6.1.3.2.cmml">
                w
               </mi>
               <mn id="A1.Ex6.m1.6.6.6.6.1.3.3" xref="A1.Ex6.m1.6.6.6.6.1.3.3.cmml">
                1
               </mn>
              </msub>
              <mo id="A1.Ex6.m1.6.6.6.6.1.2" xref="A1.Ex6.m1.6.6.6.6.1.2.cmml">
               ∼
              </mo>
              <mrow id="A1.Ex6.m1.6.6.6.6.1.1.1" xref="A1.Ex6.m1.6.6.6.6.1.1.2.cmml">
               <mrow id="A1.Ex6.m1.6.6.6.6.1.1.1.1" xref="A1.Ex6.m1.6.6.6.6.1.1.1.1.cmml">
                <msup id="A1.Ex6.m1.6.6.6.6.1.1.1.1.2" xref="A1.Ex6.m1.6.6.6.6.1.1.1.1.2.cmml">
                 <mi id="A1.Ex6.m1.6.6.6.6.1.1.1.1.2.2" xref="A1.Ex6.m1.6.6.6.6.1.1.1.1.2.2.cmml">
                  π
                 </mi>
                 <mo id="A1.Ex6.m1.6.6.6.6.1.1.1.1.2.3" xref="A1.Ex6.m1.6.6.6.6.1.1.1.1.2.3.cmml">
                  ∗
                 </mo>
                </msup>
                <mo id="A1.Ex6.m1.6.6.6.6.1.1.1.1.1" lspace="0em" rspace="0em" xref="A1.Ex6.m1.6.6.6.6.1.1.1.1.1.cmml">
                 ​
                </mo>
                <mrow id="A1.Ex6.m1.6.6.6.6.1.1.1.1.3.2" xref="A1.Ex6.m1.6.6.6.6.1.1.1.1.cmml">
                 <mo id="A1.Ex6.m1.6.6.6.6.1.1.1.1.3.2.1" stretchy="false" xref="A1.Ex6.m1.6.6.6.6.1.1.1.1.cmml">
                  (
                 </mo>
                 <mi id="A1.Ex6.m1.3.3.3.3" xref="A1.Ex6.m1.3.3.3.3.cmml">
                  s
                 </mi>
                 <mo id="A1.Ex6.m1.6.6.6.6.1.1.1.1.3.2.2" stretchy="false" xref="A1.Ex6.m1.6.6.6.6.1.1.1.1.cmml">
                  )
                 </mo>
                </mrow>
               </mrow>
               <mo id="A1.Ex6.m1.6.6.6.6.1.1.1.2" xref="A1.Ex6.m1.6.6.6.6.1.1.2.cmml">
                ,
               </mo>
               <mi id="A1.Ex6.m1.5.5.5.5" mathvariant="normal" xref="A1.Ex6.m1.5.5.5.5.cmml">
                …
               </mi>
              </mrow>
             </mrow>
             <mo id="A1.Ex6.m1.7.7.7.7.3" xref="A1.Ex6.m1.7.7.7.8a.cmml">
              ,
             </mo>
             <mrow id="A1.Ex6.m1.7.7.7.7.2" xref="A1.Ex6.m1.7.7.7.7.2.cmml">
              <msub id="A1.Ex6.m1.7.7.7.7.2.3" xref="A1.Ex6.m1.7.7.7.7.2.3.cmml">
               <mi id="A1.Ex6.m1.7.7.7.7.2.3.2" xref="A1.Ex6.m1.7.7.7.7.2.3.2.cmml">
                w
               </mi>
               <mrow id="A1.Ex6.m1.1.1.1.1.1.3" xref="A1.Ex6.m1.1.1.1.1.1.2.cmml">
                <mo id="A1.Ex6.m1.1.1.1.1.1.3.1" stretchy="false" xref="A1.Ex6.m1.1.1.1.1.1.2.1.cmml">
                 |
                </mo>
                <mi id="A1.Ex6.m1.1.1.1.1.1.1" xref="A1.Ex6.m1.1.1.1.1.1.1.cmml">
                 a
                </mi>
                <mo id="A1.Ex6.m1.1.1.1.1.1.3.2" stretchy="false" xref="A1.Ex6.m1.1.1.1.1.1.2.1.cmml">
                 |
                </mo>
               </mrow>
              </msub>
              <mo id="A1.Ex6.m1.7.7.7.7.2.2" xref="A1.Ex6.m1.7.7.7.7.2.2.cmml">
               ∼
              </mo>
              <mrow id="A1.Ex6.m1.7.7.7.7.2.1" xref="A1.Ex6.m1.7.7.7.7.2.1.cmml">
               <msup id="A1.Ex6.m1.7.7.7.7.2.1.3" xref="A1.Ex6.m1.7.7.7.7.2.1.3.cmml">
                <mi id="A1.Ex6.m1.7.7.7.7.2.1.3.2" xref="A1.Ex6.m1.7.7.7.7.2.1.3.2.cmml">
                 π
                </mi>
                <mo id="A1.Ex6.m1.7.7.7.7.2.1.3.3" xref="A1.Ex6.m1.7.7.7.7.2.1.3.3.cmml">
                 ∗
                </mo>
               </msup>
               <mo id="A1.Ex6.m1.7.7.7.7.2.1.2" lspace="0em" rspace="0em" xref="A1.Ex6.m1.7.7.7.7.2.1.2.cmml">
                ​
               </mo>
               <mrow id="A1.Ex6.m1.7.7.7.7.2.1.1.1" xref="A1.Ex6.m1.7.7.7.7.2.1.1.2.cmml">
                <mo id="A1.Ex6.m1.7.7.7.7.2.1.1.1.2" stretchy="false" xref="A1.Ex6.m1.7.7.7.7.2.1.1.2.cmml">
                 (
                </mo>
                <mi id="A1.Ex6.m1.4.4.4.4" xref="A1.Ex6.m1.4.4.4.4.cmml">
                 s
                </mi>
                <mo id="A1.Ex6.m1.7.7.7.7.2.1.1.1.3" xref="A1.Ex6.m1.7.7.7.7.2.1.1.2.cmml">
                 ,
                </mo>
                <msub id="A1.Ex6.m1.7.7.7.7.2.1.1.1.1" xref="A1.Ex6.m1.7.7.7.7.2.1.1.1.1.cmml">
                 <mi id="A1.Ex6.m1.7.7.7.7.2.1.1.1.1.2" xref="A1.Ex6.m1.7.7.7.7.2.1.1.1.1.2.cmml">
                  w
                 </mi>
                 <mrow id="A1.Ex6.m1.2.2.2.2.1" xref="A1.Ex6.m1.2.2.2.2.1.cmml">
                  <mn id="A1.Ex6.m1.2.2.2.2.1.3" xref="A1.Ex6.m1.2.2.2.2.1.3.cmml">
                   1
                  </mn>
                  <mo id="A1.Ex6.m1.2.2.2.2.1.2" lspace="0.278em" rspace="0.278em" xref="A1.Ex6.m1.2.2.2.2.1.2.cmml">
                   :
                  </mo>
                  <mrow id="A1.Ex6.m1.2.2.2.2.1.4" xref="A1.Ex6.m1.2.2.2.2.1.4.cmml">
                   <mrow id="A1.Ex6.m1.2.2.2.2.1.4.2.2" xref="A1.Ex6.m1.2.2.2.2.1.4.2.1.cmml">
                    <mo id="A1.Ex6.m1.2.2.2.2.1.4.2.2.1" stretchy="false" xref="A1.Ex6.m1.2.2.2.2.1.4.2.1.1.cmml">
                     |
                    </mo>
                    <mi id="A1.Ex6.m1.2.2.2.2.1.1" xref="A1.Ex6.m1.2.2.2.2.1.1.cmml">
                     a
                    </mi>
                    <mo id="A1.Ex6.m1.2.2.2.2.1.4.2.2.2" stretchy="false" xref="A1.Ex6.m1.2.2.2.2.1.4.2.1.1.cmml">
                     |
                    </mo>
                   </mrow>
                   <mo id="A1.Ex6.m1.2.2.2.2.1.4.1" xref="A1.Ex6.m1.2.2.2.2.1.4.1.cmml">
                    −
                   </mo>
                   <mn id="A1.Ex6.m1.2.2.2.2.1.4.3" xref="A1.Ex6.m1.2.2.2.2.1.4.3.cmml">
                    1
                   </mn>
                  </mrow>
                 </mrow>
                </msub>
                <mo id="A1.Ex6.m1.7.7.7.7.2.1.1.1.4" stretchy="false" xref="A1.Ex6.m1.7.7.7.7.2.1.1.2.cmml">
                 )
                </mo>
               </mrow>
              </mrow>
             </mrow>
            </mrow>
           </msub>
           <mo id="A1.Ex6.m1.11.11.1.2" lspace="0em" rspace="0em" xref="A1.Ex6.m1.11.11.1.2.cmml">
            ​
           </mo>
           <mrow id="A1.Ex6.m1.11.11.1.1.1" xref="A1.Ex6.m1.11.11.1.1.2.cmml">
            <mo id="A1.Ex6.m1.11.11.1.1.1.2" stretchy="false" xref="A1.Ex6.m1.11.11.1.1.2.1.cmml">
             [
            </mo>
            <mrow id="A1.Ex6.m1.11.11.1.1.1.1" xref="A1.Ex6.m1.11.11.1.1.1.1.cmml">
             <mi id="A1.Ex6.m1.11.11.1.1.1.1.4" xref="A1.Ex6.m1.11.11.1.1.1.1.4.cmml">
              Q
             </mi>
             <mo id="A1.Ex6.m1.11.11.1.1.1.1.3" lspace="0em" rspace="0em" xref="A1.Ex6.m1.11.11.1.1.1.1.3.cmml">
              ​
             </mo>
             <mrow id="A1.Ex6.m1.11.11.1.1.1.1.2.2" xref="A1.Ex6.m1.11.11.1.1.1.1.2.3.cmml">
              <mo id="A1.Ex6.m1.11.11.1.1.1.1.2.2.3" stretchy="false" xref="A1.Ex6.m1.11.11.1.1.1.1.2.3.cmml">
               (
              </mo>
              <mi id="A1.Ex6.m1.10.10" xref="A1.Ex6.m1.10.10.cmml">
               s
              </mi>
              <mo id="A1.Ex6.m1.11.11.1.1.1.1.2.2.4" xref="A1.Ex6.m1.11.11.1.1.1.1.2.3.cmml">
               ,
              </mo>
              <msub id="A1.Ex6.m1.11.11.1.1.1.1.1.1.1" xref="A1.Ex6.m1.11.11.1.1.1.1.1.1.1.cmml">
               <mi id="A1.Ex6.m1.11.11.1.1.1.1.1.1.1.2" xref="A1.Ex6.m1.11.11.1.1.1.1.1.1.1.2.cmml">
                w
               </mi>
               <mrow id="A1.Ex6.m1.8.8.1" xref="A1.Ex6.m1.8.8.1.cmml">
                <mn id="A1.Ex6.m1.8.8.1.3" xref="A1.Ex6.m1.8.8.1.3.cmml">
                 1
                </mn>
                <mo id="A1.Ex6.m1.8.8.1.2" lspace="0.278em" rspace="0.278em" xref="A1.Ex6.m1.8.8.1.2.cmml">
                 :
                </mo>
                <mrow id="A1.Ex6.m1.8.8.1.4" xref="A1.Ex6.m1.8.8.1.4.cmml">
                 <mrow id="A1.Ex6.m1.8.8.1.4.2.2" xref="A1.Ex6.m1.8.8.1.4.2.1.cmml">
                  <mo id="A1.Ex6.m1.8.8.1.4.2.2.1" stretchy="false" xref="A1.Ex6.m1.8.8.1.4.2.1.1.cmml">
                   |
                  </mo>
                  <mi id="A1.Ex6.m1.8.8.1.1" xref="A1.Ex6.m1.8.8.1.1.cmml">
                   a
                  </mi>
                  <mo id="A1.Ex6.m1.8.8.1.4.2.2.2" stretchy="false" xref="A1.Ex6.m1.8.8.1.4.2.1.1.cmml">
                   |
                  </mo>
                 </mrow>
                 <mo id="A1.Ex6.m1.8.8.1.4.1" xref="A1.Ex6.m1.8.8.1.4.1.cmml">
                  −
                 </mo>
                 <mn id="A1.Ex6.m1.8.8.1.4.3" xref="A1.Ex6.m1.8.8.1.4.3.cmml">
                  1
                 </mn>
                </mrow>
               </mrow>
              </msub>
              <mo id="A1.Ex6.m1.11.11.1.1.1.1.2.2.5" xref="A1.Ex6.m1.11.11.1.1.1.1.2.3.cmml">
               ,
              </mo>
              <msub id="A1.Ex6.m1.11.11.1.1.1.1.2.2.2" xref="A1.Ex6.m1.11.11.1.1.1.1.2.2.2.cmml">
               <mi id="A1.Ex6.m1.11.11.1.1.1.1.2.2.2.2" xref="A1.Ex6.m1.11.11.1.1.1.1.2.2.2.2.cmml">
                w
               </mi>
               <mrow id="A1.Ex6.m1.9.9.1.3" xref="A1.Ex6.m1.9.9.1.2.cmml">
                <mo id="A1.Ex6.m1.9.9.1.3.1" stretchy="false" xref="A1.Ex6.m1.9.9.1.2.1.cmml">
                 |
                </mo>
                <mi id="A1.Ex6.m1.9.9.1.1" xref="A1.Ex6.m1.9.9.1.1.cmml">
                 a
                </mi>
                <mo id="A1.Ex6.m1.9.9.1.3.2" stretchy="false" xref="A1.Ex6.m1.9.9.1.2.1.cmml">
                 |
                </mo>
               </mrow>
              </msub>
              <mo id="A1.Ex6.m1.11.11.1.1.1.1.2.2.6" stretchy="false" xref="A1.Ex6.m1.11.11.1.1.1.1.2.3.cmml">
               )
              </mo>
             </mrow>
            </mrow>
            <mo id="A1.Ex6.m1.11.11.1.1.1.3" stretchy="false" xref="A1.Ex6.m1.11.11.1.1.2.1.cmml">
             ]
            </mo>
           </mrow>
          </mrow>
         </mrow>
         <annotation-xml encoding="MathML-Content" id="A1.Ex6.m1.11b">
          <apply id="A1.Ex6.m1.11.11.cmml" xref="A1.Ex6.m1.11.11">
           <eq id="A1.Ex6.m1.11.11.2.cmml" xref="A1.Ex6.m1.11.11.2">
           </eq>
           <csymbol cd="latexml" id="A1.Ex6.m1.11.11.3.cmml" xref="A1.Ex6.m1.11.11.3">
            absent
           </csymbol>
           <apply id="A1.Ex6.m1.11.11.1.cmml" xref="A1.Ex6.m1.11.11.1">
            <times id="A1.Ex6.m1.11.11.1.2.cmml" xref="A1.Ex6.m1.11.11.1.2">
            </times>
            <apply id="A1.Ex6.m1.11.11.1.3.cmml" xref="A1.Ex6.m1.11.11.1.3">
             <csymbol cd="ambiguous" id="A1.Ex6.m1.11.11.1.3.1.cmml" xref="A1.Ex6.m1.11.11.1.3">
              subscript
             </csymbol>
             <ci id="A1.Ex6.m1.11.11.1.3.2.cmml" xref="A1.Ex6.m1.11.11.1.3.2">
              𝔼
             </ci>
             <apply id="A1.Ex6.m1.7.7.7.8.cmml" xref="A1.Ex6.m1.7.7.7.7">
              <csymbol cd="ambiguous" id="A1.Ex6.m1.7.7.7.8a.cmml" xref="A1.Ex6.m1.7.7.7.7.3">
               formulae-sequence
              </csymbol>
              <apply id="A1.Ex6.m1.6.6.6.6.1.cmml" xref="A1.Ex6.m1.6.6.6.6.1">
               <csymbol cd="latexml" id="A1.Ex6.m1.6.6.6.6.1.2.cmml" xref="A1.Ex6.m1.6.6.6.6.1.2">
                similar-to
               </csymbol>
               <apply id="A1.Ex6.m1.6.6.6.6.1.3.cmml" xref="A1.Ex6.m1.6.6.6.6.1.3">
                <csymbol cd="ambiguous" id="A1.Ex6.m1.6.6.6.6.1.3.1.cmml" xref="A1.Ex6.m1.6.6.6.6.1.3">
                 subscript
                </csymbol>
                <ci id="A1.Ex6.m1.6.6.6.6.1.3.2.cmml" xref="A1.Ex6.m1.6.6.6.6.1.3.2">
                 𝑤
                </ci>
                <cn id="A1.Ex6.m1.6.6.6.6.1.3.3.cmml" type="integer" xref="A1.Ex6.m1.6.6.6.6.1.3.3">
                 1
                </cn>
               </apply>
               <list id="A1.Ex6.m1.6.6.6.6.1.1.2.cmml" xref="A1.Ex6.m1.6.6.6.6.1.1.1">
                <apply id="A1.Ex6.m1.6.6.6.6.1.1.1.1.cmml" xref="A1.Ex6.m1.6.6.6.6.1.1.1.1">
                 <times id="A1.Ex6.m1.6.6.6.6.1.1.1.1.1.cmml" xref="A1.Ex6.m1.6.6.6.6.1.1.1.1.1">
                 </times>
                 <apply id="A1.Ex6.m1.6.6.6.6.1.1.1.1.2.cmml" xref="A1.Ex6.m1.6.6.6.6.1.1.1.1.2">
                  <csymbol cd="ambiguous" id="A1.Ex6.m1.6.6.6.6.1.1.1.1.2.1.cmml" xref="A1.Ex6.m1.6.6.6.6.1.1.1.1.2">
                   superscript
                  </csymbol>
                  <ci id="A1.Ex6.m1.6.6.6.6.1.1.1.1.2.2.cmml" xref="A1.Ex6.m1.6.6.6.6.1.1.1.1.2.2">
                   𝜋
                  </ci>
                  <times id="A1.Ex6.m1.6.6.6.6.1.1.1.1.2.3.cmml" xref="A1.Ex6.m1.6.6.6.6.1.1.1.1.2.3">
                  </times>
                 </apply>
                 <ci id="A1.Ex6.m1.3.3.3.3.cmml" xref="A1.Ex6.m1.3.3.3.3">
                  𝑠
                 </ci>
                </apply>
                <ci id="A1.Ex6.m1.5.5.5.5.cmml" xref="A1.Ex6.m1.5.5.5.5">
                 …
                </ci>
               </list>
              </apply>
              <apply id="A1.Ex6.m1.7.7.7.7.2.cmml" xref="A1.Ex6.m1.7.7.7.7.2">
               <csymbol cd="latexml" id="A1.Ex6.m1.7.7.7.7.2.2.cmml" xref="A1.Ex6.m1.7.7.7.7.2.2">
                similar-to
               </csymbol>
               <apply id="A1.Ex6.m1.7.7.7.7.2.3.cmml" xref="A1.Ex6.m1.7.7.7.7.2.3">
                <csymbol cd="ambiguous" id="A1.Ex6.m1.7.7.7.7.2.3.1.cmml" xref="A1.Ex6.m1.7.7.7.7.2.3">
                 subscript
                </csymbol>
                <ci id="A1.Ex6.m1.7.7.7.7.2.3.2.cmml" xref="A1.Ex6.m1.7.7.7.7.2.3.2">
                 𝑤
                </ci>
                <apply id="A1.Ex6.m1.1.1.1.1.1.2.cmml" xref="A1.Ex6.m1.1.1.1.1.1.3">
                 <abs id="A1.Ex6.m1.1.1.1.1.1.2.1.cmml" xref="A1.Ex6.m1.1.1.1.1.1.3.1">
                 </abs>
                 <ci id="A1.Ex6.m1.1.1.1.1.1.1.cmml" xref="A1.Ex6.m1.1.1.1.1.1.1">
                  𝑎
                 </ci>
                </apply>
               </apply>
               <apply id="A1.Ex6.m1.7.7.7.7.2.1.cmml" xref="A1.Ex6.m1.7.7.7.7.2.1">
                <times id="A1.Ex6.m1.7.7.7.7.2.1.2.cmml" xref="A1.Ex6.m1.7.7.7.7.2.1.2">
                </times>
                <apply id="A1.Ex6.m1.7.7.7.7.2.1.3.cmml" xref="A1.Ex6.m1.7.7.7.7.2.1.3">
                 <csymbol cd="ambiguous" id="A1.Ex6.m1.7.7.7.7.2.1.3.1.cmml" xref="A1.Ex6.m1.7.7.7.7.2.1.3">
                  superscript
                 </csymbol>
                 <ci id="A1.Ex6.m1.7.7.7.7.2.1.3.2.cmml" xref="A1.Ex6.m1.7.7.7.7.2.1.3.2">
                  𝜋
                 </ci>
                 <times id="A1.Ex6.m1.7.7.7.7.2.1.3.3.cmml" xref="A1.Ex6.m1.7.7.7.7.2.1.3.3">
                 </times>
                </apply>
                <interval closure="open" id="A1.Ex6.m1.7.7.7.7.2.1.1.2.cmml" xref="A1.Ex6.m1.7.7.7.7.2.1.1.1">
                 <ci id="A1.Ex6.m1.4.4.4.4.cmml" xref="A1.Ex6.m1.4.4.4.4">
                  𝑠
                 </ci>
                 <apply id="A1.Ex6.m1.7.7.7.7.2.1.1.1.1.cmml" xref="A1.Ex6.m1.7.7.7.7.2.1.1.1.1">
                  <csymbol cd="ambiguous" id="A1.Ex6.m1.7.7.7.7.2.1.1.1.1.1.cmml" xref="A1.Ex6.m1.7.7.7.7.2.1.1.1.1">
                   subscript
                  </csymbol>
                  <ci id="A1.Ex6.m1.7.7.7.7.2.1.1.1.1.2.cmml" xref="A1.Ex6.m1.7.7.7.7.2.1.1.1.1.2">
                   𝑤
                  </ci>
                  <apply id="A1.Ex6.m1.2.2.2.2.1.cmml" xref="A1.Ex6.m1.2.2.2.2.1">
                   <ci id="A1.Ex6.m1.2.2.2.2.1.2.cmml" xref="A1.Ex6.m1.2.2.2.2.1.2">
                    :
                   </ci>
                   <cn id="A1.Ex6.m1.2.2.2.2.1.3.cmml" type="integer" xref="A1.Ex6.m1.2.2.2.2.1.3">
                    1
                   </cn>
                   <apply id="A1.Ex6.m1.2.2.2.2.1.4.cmml" xref="A1.Ex6.m1.2.2.2.2.1.4">
                    <minus id="A1.Ex6.m1.2.2.2.2.1.4.1.cmml" xref="A1.Ex6.m1.2.2.2.2.1.4.1">
                    </minus>
                    <apply id="A1.Ex6.m1.2.2.2.2.1.4.2.1.cmml" xref="A1.Ex6.m1.2.2.2.2.1.4.2.2">
                     <abs id="A1.Ex6.m1.2.2.2.2.1.4.2.1.1.cmml" xref="A1.Ex6.m1.2.2.2.2.1.4.2.2.1">
                     </abs>
                     <ci id="A1.Ex6.m1.2.2.2.2.1.1.cmml" xref="A1.Ex6.m1.2.2.2.2.1.1">
                      𝑎
                     </ci>
                    </apply>
                    <cn id="A1.Ex6.m1.2.2.2.2.1.4.3.cmml" type="integer" xref="A1.Ex6.m1.2.2.2.2.1.4.3">
                     1
                    </cn>
                   </apply>
                  </apply>
                 </apply>
                </interval>
               </apply>
              </apply>
             </apply>
            </apply>
            <apply id="A1.Ex6.m1.11.11.1.1.2.cmml" xref="A1.Ex6.m1.11.11.1.1.1">
             <csymbol cd="latexml" id="A1.Ex6.m1.11.11.1.1.2.1.cmml" xref="A1.Ex6.m1.11.11.1.1.1.2">
              delimited-[]
             </csymbol>
             <apply id="A1.Ex6.m1.11.11.1.1.1.1.cmml" xref="A1.Ex6.m1.11.11.1.1.1.1">
              <times id="A1.Ex6.m1.11.11.1.1.1.1.3.cmml" xref="A1.Ex6.m1.11.11.1.1.1.1.3">
              </times>
              <ci id="A1.Ex6.m1.11.11.1.1.1.1.4.cmml" xref="A1.Ex6.m1.11.11.1.1.1.1.4">
               𝑄
              </ci>
              <vector id="A1.Ex6.m1.11.11.1.1.1.1.2.3.cmml" xref="A1.Ex6.m1.11.11.1.1.1.1.2.2">
               <ci id="A1.Ex6.m1.10.10.cmml" xref="A1.Ex6.m1.10.10">
                𝑠
               </ci>
               <apply id="A1.Ex6.m1.11.11.1.1.1.1.1.1.1.cmml" xref="A1.Ex6.m1.11.11.1.1.1.1.1.1.1">
                <csymbol cd="ambiguous" id="A1.Ex6.m1.11.11.1.1.1.1.1.1.1.1.cmml" xref="A1.Ex6.m1.11.11.1.1.1.1.1.1.1">
                 subscript
                </csymbol>
                <ci id="A1.Ex6.m1.11.11.1.1.1.1.1.1.1.2.cmml" xref="A1.Ex6.m1.11.11.1.1.1.1.1.1.1.2">
                 𝑤
                </ci>
                <apply id="A1.Ex6.m1.8.8.1.cmml" xref="A1.Ex6.m1.8.8.1">
                 <ci id="A1.Ex6.m1.8.8.1.2.cmml" xref="A1.Ex6.m1.8.8.1.2">
                  :
                 </ci>
                 <cn id="A1.Ex6.m1.8.8.1.3.cmml" type="integer" xref="A1.Ex6.m1.8.8.1.3">
                  1
                 </cn>
                 <apply id="A1.Ex6.m1.8.8.1.4.cmml" xref="A1.Ex6.m1.8.8.1.4">
                  <minus id="A1.Ex6.m1.8.8.1.4.1.cmml" xref="A1.Ex6.m1.8.8.1.4.1">
                  </minus>
                  <apply id="A1.Ex6.m1.8.8.1.4.2.1.cmml" xref="A1.Ex6.m1.8.8.1.4.2.2">
                   <abs id="A1.Ex6.m1.8.8.1.4.2.1.1.cmml" xref="A1.Ex6.m1.8.8.1.4.2.2.1">
                   </abs>
                   <ci id="A1.Ex6.m1.8.8.1.1.cmml" xref="A1.Ex6.m1.8.8.1.1">
                    𝑎
                   </ci>
                  </apply>
                  <cn id="A1.Ex6.m1.8.8.1.4.3.cmml" type="integer" xref="A1.Ex6.m1.8.8.1.4.3">
                   1
                  </cn>
                 </apply>
                </apply>
               </apply>
               <apply id="A1.Ex6.m1.11.11.1.1.1.1.2.2.2.cmml" xref="A1.Ex6.m1.11.11.1.1.1.1.2.2.2">
                <csymbol cd="ambiguous" id="A1.Ex6.m1.11.11.1.1.1.1.2.2.2.1.cmml" xref="A1.Ex6.m1.11.11.1.1.1.1.2.2.2">
                 subscript
                </csymbol>
                <ci id="A1.Ex6.m1.11.11.1.1.1.1.2.2.2.2.cmml" xref="A1.Ex6.m1.11.11.1.1.1.1.2.2.2.2">
                 𝑤
                </ci>
                <apply id="A1.Ex6.m1.9.9.1.2.cmml" xref="A1.Ex6.m1.9.9.1.3">
                 <abs id="A1.Ex6.m1.9.9.1.2.1.cmml" xref="A1.Ex6.m1.9.9.1.3.1">
                 </abs>
                 <ci id="A1.Ex6.m1.9.9.1.1.cmml" xref="A1.Ex6.m1.9.9.1.1">
                  𝑎
                 </ci>
                </apply>
               </apply>
              </vector>
             </apply>
            </apply>
           </apply>
          </apply>
         </annotation-xml>
         <annotation encoding="application/x-tex" id="A1.Ex6.m1.11c">
          \displaystyle=\mathbb{E}_{w_{1}\sim\pi^{*}(s),\dots,w_{|a|}\sim\pi^{*}(s,w_{1:|a|-1})}[Q(s,w_{1:|a|-1},w_{|a|})]
         </annotation>
        </semantics>
       </math>
      </td>
      <td class="ltx_eqn_cell ltx_eqn_center_padright">
      </td>
     </tr>
    </tbody>
    <tbody id="A1.E12">
     <tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
      <td class="ltx_eqn_cell ltx_eqn_center_padleft">
      </td>
      <td class="ltx_td ltx_eqn_cell">
      </td>
      <td class="ltx_td ltx_align_left ltx_eqn_cell">
       <math alttext="\displaystyle~{}~{}~{}~{}-\beta\mathbb{E}_{w_{1}\sim\pi^{*}(s),\dots,w_{|a|-1}\sim\pi^{*}(s,w_{1:|a|-2})}[\sum_{j=1}^{|a|-1}\text{KL}(w_{j+1}|s,w_{1:j})]." class="ltx_Math" display="inline" id="A1.E12.m1.10">
        <semantics id="A1.E12.m1.10a">
         <mrow id="A1.E12.m1.10.10.1" xref="A1.E12.m1.10.10.1.1.cmml">
          <mrow id="A1.E12.m1.10.10.1.1" xref="A1.E12.m1.10.10.1.1.cmml">
           <mo id="A1.E12.m1.10.10.1.1a" xref="A1.E12.m1.10.10.1.1.cmml">
            −
           </mo>
           <mrow id="A1.E12.m1.10.10.1.1.1" xref="A1.E12.m1.10.10.1.1.1.cmml">
            <mi id="A1.E12.m1.10.10.1.1.1.3" xref="A1.E12.m1.10.10.1.1.1.3.cmml">
             β
            </mi>
            <mo id="A1.E12.m1.10.10.1.1.1.2" lspace="0em" rspace="0em" xref="A1.E12.m1.10.10.1.1.1.2.cmml">
             ​
            </mo>
            <msub id="A1.E12.m1.10.10.1.1.1.4" xref="A1.E12.m1.10.10.1.1.1.4.cmml">
             <mi id="A1.E12.m1.10.10.1.1.1.4.2" xref="A1.E12.m1.10.10.1.1.1.4.2.cmml">
              𝔼
             </mi>
             <mrow id="A1.E12.m1.7.7.7.7" xref="A1.E12.m1.7.7.7.8.cmml">
              <mrow id="A1.E12.m1.6.6.6.6.1" xref="A1.E12.m1.6.6.6.6.1.cmml">
               <msub id="A1.E12.m1.6.6.6.6.1.3" xref="A1.E12.m1.6.6.6.6.1.3.cmml">
                <mi id="A1.E12.m1.6.6.6.6.1.3.2" xref="A1.E12.m1.6.6.6.6.1.3.2.cmml">
                 w
                </mi>
                <mn id="A1.E12.m1.6.6.6.6.1.3.3" xref="A1.E12.m1.6.6.6.6.1.3.3.cmml">
                 1
                </mn>
               </msub>
               <mo id="A1.E12.m1.6.6.6.6.1.2" xref="A1.E12.m1.6.6.6.6.1.2.cmml">
                ∼
               </mo>
               <mrow id="A1.E12.m1.6.6.6.6.1.1.1" xref="A1.E12.m1.6.6.6.6.1.1.2.cmml">
                <mrow id="A1.E12.m1.6.6.6.6.1.1.1.1" xref="A1.E12.m1.6.6.6.6.1.1.1.1.cmml">
                 <msup id="A1.E12.m1.6.6.6.6.1.1.1.1.2" xref="A1.E12.m1.6.6.6.6.1.1.1.1.2.cmml">
                  <mi id="A1.E12.m1.6.6.6.6.1.1.1.1.2.2" xref="A1.E12.m1.6.6.6.6.1.1.1.1.2.2.cmml">
                   π
                  </mi>
                  <mo id="A1.E12.m1.6.6.6.6.1.1.1.1.2.3" xref="A1.E12.m1.6.6.6.6.1.1.1.1.2.3.cmml">
                   ∗
                  </mo>
                 </msup>
                 <mo id="A1.E12.m1.6.6.6.6.1.1.1.1.1" lspace="0em" rspace="0em" xref="A1.E12.m1.6.6.6.6.1.1.1.1.1.cmml">
                  ​
                 </mo>
                 <mrow id="A1.E12.m1.6.6.6.6.1.1.1.1.3.2" xref="A1.E12.m1.6.6.6.6.1.1.1.1.cmml">
                  <mo id="A1.E12.m1.6.6.6.6.1.1.1.1.3.2.1" stretchy="false" xref="A1.E12.m1.6.6.6.6.1.1.1.1.cmml">
                   (
                  </mo>
                  <mi id="A1.E12.m1.3.3.3.3" xref="A1.E12.m1.3.3.3.3.cmml">
                   s
                  </mi>
                  <mo id="A1.E12.m1.6.6.6.6.1.1.1.1.3.2.2" stretchy="false" xref="A1.E12.m1.6.6.6.6.1.1.1.1.cmml">
                   )
                  </mo>
                 </mrow>
                </mrow>
                <mo id="A1.E12.m1.6.6.6.6.1.1.1.2" xref="A1.E12.m1.6.6.6.6.1.1.2.cmml">
                 ,
                </mo>
                <mi id="A1.E12.m1.5.5.5.5" mathvariant="normal" xref="A1.E12.m1.5.5.5.5.cmml">
                 …
                </mi>
               </mrow>
              </mrow>
              <mo id="A1.E12.m1.7.7.7.7.3" xref="A1.E12.m1.7.7.7.8a.cmml">
               ,
              </mo>
              <mrow id="A1.E12.m1.7.7.7.7.2" xref="A1.E12.m1.7.7.7.7.2.cmml">
               <msub id="A1.E12.m1.7.7.7.7.2.3" xref="A1.E12.m1.7.7.7.7.2.3.cmml">
                <mi id="A1.E12.m1.7.7.7.7.2.3.2" xref="A1.E12.m1.7.7.7.7.2.3.2.cmml">
                 w
                </mi>
                <mrow id="A1.E12.m1.1.1.1.1.1" xref="A1.E12.m1.1.1.1.1.1.cmml">
                 <mrow id="A1.E12.m1.1.1.1.1.1.3.2" xref="A1.E12.m1.1.1.1.1.1.3.1.cmml">
                  <mo id="A1.E12.m1.1.1.1.1.1.3.2.1" stretchy="false" xref="A1.E12.m1.1.1.1.1.1.3.1.1.cmml">
                   |
                  </mo>
                  <mi id="A1.E12.m1.1.1.1.1.1.1" xref="A1.E12.m1.1.1.1.1.1.1.cmml">
                   a
                  </mi>
                  <mo id="A1.E12.m1.1.1.1.1.1.3.2.2" stretchy="false" xref="A1.E12.m1.1.1.1.1.1.3.1.1.cmml">
                   |
                  </mo>
                 </mrow>
                 <mo id="A1.E12.m1.1.1.1.1.1.2" xref="A1.E12.m1.1.1.1.1.1.2.cmml">
                  −
                 </mo>
                 <mn id="A1.E12.m1.1.1.1.1.1.4" xref="A1.E12.m1.1.1.1.1.1.4.cmml">
                  1
                 </mn>
                </mrow>
               </msub>
               <mo id="A1.E12.m1.7.7.7.7.2.2" xref="A1.E12.m1.7.7.7.7.2.2.cmml">
                ∼
               </mo>
               <mrow id="A1.E12.m1.7.7.7.7.2.1" xref="A1.E12.m1.7.7.7.7.2.1.cmml">
                <msup id="A1.E12.m1.7.7.7.7.2.1.3" xref="A1.E12.m1.7.7.7.7.2.1.3.cmml">
                 <mi id="A1.E12.m1.7.7.7.7.2.1.3.2" xref="A1.E12.m1.7.7.7.7.2.1.3.2.cmml">
                  π
                 </mi>
                 <mo id="A1.E12.m1.7.7.7.7.2.1.3.3" xref="A1.E12.m1.7.7.7.7.2.1.3.3.cmml">
                  ∗
                 </mo>
                </msup>
                <mo id="A1.E12.m1.7.7.7.7.2.1.2" lspace="0em" rspace="0em" xref="A1.E12.m1.7.7.7.7.2.1.2.cmml">
                 ​
                </mo>
                <mrow id="A1.E12.m1.7.7.7.7.2.1.1.1" xref="A1.E12.m1.7.7.7.7.2.1.1.2.cmml">
                 <mo id="A1.E12.m1.7.7.7.7.2.1.1.1.2" stretchy="false" xref="A1.E12.m1.7.7.7.7.2.1.1.2.cmml">
                  (
                 </mo>
                 <mi id="A1.E12.m1.4.4.4.4" xref="A1.E12.m1.4.4.4.4.cmml">
                  s
                 </mi>
                 <mo id="A1.E12.m1.7.7.7.7.2.1.1.1.3" xref="A1.E12.m1.7.7.7.7.2.1.1.2.cmml">
                  ,
                 </mo>
                 <msub id="A1.E12.m1.7.7.7.7.2.1.1.1.1" xref="A1.E12.m1.7.7.7.7.2.1.1.1.1.cmml">
                  <mi id="A1.E12.m1.7.7.7.7.2.1.1.1.1.2" xref="A1.E12.m1.7.7.7.7.2.1.1.1.1.2.cmml">
                   w
                  </mi>
                  <mrow id="A1.E12.m1.2.2.2.2.1" xref="A1.E12.m1.2.2.2.2.1.cmml">
                   <mn id="A1.E12.m1.2.2.2.2.1.3" xref="A1.E12.m1.2.2.2.2.1.3.cmml">
                    1
                   </mn>
                   <mo id="A1.E12.m1.2.2.2.2.1.2" lspace="0.278em" rspace="0.278em" xref="A1.E12.m1.2.2.2.2.1.2.cmml">
                    :
                   </mo>
                   <mrow id="A1.E12.m1.2.2.2.2.1.4" xref="A1.E12.m1.2.2.2.2.1.4.cmml">
                    <mrow id="A1.E12.m1.2.2.2.2.1.4.2.2" xref="A1.E12.m1.2.2.2.2.1.4.2.1.cmml">
                     <mo id="A1.E12.m1.2.2.2.2.1.4.2.2.1" stretchy="false" xref="A1.E12.m1.2.2.2.2.1.4.2.1.1.cmml">
                      |
                     </mo>
                     <mi id="A1.E12.m1.2.2.2.2.1.1" xref="A1.E12.m1.2.2.2.2.1.1.cmml">
                      a
                     </mi>
                     <mo id="A1.E12.m1.2.2.2.2.1.4.2.2.2" stretchy="false" xref="A1.E12.m1.2.2.2.2.1.4.2.1.1.cmml">
                      |
                     </mo>
                    </mrow>
                    <mo id="A1.E12.m1.2.2.2.2.1.4.1" xref="A1.E12.m1.2.2.2.2.1.4.1.cmml">
                     −
                    </mo>
                    <mn id="A1.E12.m1.2.2.2.2.1.4.3" xref="A1.E12.m1.2.2.2.2.1.4.3.cmml">
                     2
                    </mn>
                   </mrow>
                  </mrow>
                 </msub>
                 <mo id="A1.E12.m1.7.7.7.7.2.1.1.1.4" stretchy="false" xref="A1.E12.m1.7.7.7.7.2.1.1.2.cmml">
                  )
                 </mo>
                </mrow>
               </mrow>
              </mrow>
             </mrow>
            </msub>
            <mo id="A1.E12.m1.10.10.1.1.1.2a" lspace="0em" rspace="0em" xref="A1.E12.m1.10.10.1.1.1.2.cmml">
             ​
            </mo>
            <mrow id="A1.E12.m1.10.10.1.1.1.1.1" xref="A1.E12.m1.10.10.1.1.1.1.2.cmml">
             <mo id="A1.E12.m1.10.10.1.1.1.1.1.2" stretchy="false" xref="A1.E12.m1.10.10.1.1.1.1.2.1.cmml">
              [
             </mo>
             <mrow id="A1.E12.m1.10.10.1.1.1.1.1.1" xref="A1.E12.m1.10.10.1.1.1.1.1.1.cmml">
              <mstyle displaystyle="true" id="A1.E12.m1.10.10.1.1.1.1.1.1.2" xref="A1.E12.m1.10.10.1.1.1.1.1.1.2.cmml">
               <munderover id="A1.E12.m1.10.10.1.1.1.1.1.1.2a" xref="A1.E12.m1.10.10.1.1.1.1.1.1.2.cmml">
                <mo id="A1.E12.m1.10.10.1.1.1.1.1.1.2.2.2" movablelimits="false" xref="A1.E12.m1.10.10.1.1.1.1.1.1.2.2.2.cmml">
                 ∑
                </mo>
                <mrow id="A1.E12.m1.10.10.1.1.1.1.1.1.2.2.3" xref="A1.E12.m1.10.10.1.1.1.1.1.1.2.2.3.cmml">
                 <mi id="A1.E12.m1.10.10.1.1.1.1.1.1.2.2.3.2" xref="A1.E12.m1.10.10.1.1.1.1.1.1.2.2.3.2.cmml">
                  j
                 </mi>
                 <mo id="A1.E12.m1.10.10.1.1.1.1.1.1.2.2.3.1" xref="A1.E12.m1.10.10.1.1.1.1.1.1.2.2.3.1.cmml">
                  =
                 </mo>
                 <mn id="A1.E12.m1.10.10.1.1.1.1.1.1.2.2.3.3" xref="A1.E12.m1.10.10.1.1.1.1.1.1.2.2.3.3.cmml">
                  1
                 </mn>
                </mrow>
                <mrow id="A1.E12.m1.8.8.1" xref="A1.E12.m1.8.8.1.cmml">
                 <mrow id="A1.E12.m1.8.8.1.3.2" xref="A1.E12.m1.8.8.1.3.1.cmml">
                  <mo id="A1.E12.m1.8.8.1.3.2.1" stretchy="false" xref="A1.E12.m1.8.8.1.3.1.1.cmml">
                   |
                  </mo>
                  <mi id="A1.E12.m1.8.8.1.1" xref="A1.E12.m1.8.8.1.1.cmml">
                   a
                  </mi>
                  <mo id="A1.E12.m1.8.8.1.3.2.2" stretchy="false" xref="A1.E12.m1.8.8.1.3.1.1.cmml">
                   |
                  </mo>
                 </mrow>
                 <mo id="A1.E12.m1.8.8.1.2" xref="A1.E12.m1.8.8.1.2.cmml">
                  −
                 </mo>
                 <mn id="A1.E12.m1.8.8.1.4" xref="A1.E12.m1.8.8.1.4.cmml">
                  1
                 </mn>
                </mrow>
               </munderover>
              </mstyle>
              <mrow id="A1.E12.m1.10.10.1.1.1.1.1.1.1" xref="A1.E12.m1.10.10.1.1.1.1.1.1.1.cmml">
               <mtext id="A1.E12.m1.10.10.1.1.1.1.1.1.1.3" xref="A1.E12.m1.10.10.1.1.1.1.1.1.1.3a.cmml">
                KL
               </mtext>
               <mo id="A1.E12.m1.10.10.1.1.1.1.1.1.1.2" lspace="0em" rspace="0em" xref="A1.E12.m1.10.10.1.1.1.1.1.1.1.2.cmml">
                ​
               </mo>
               <mrow id="A1.E12.m1.10.10.1.1.1.1.1.1.1.1.1" xref="A1.E12.m1.10.10.1.1.1.1.1.1.1.1.1.1.cmml">
                <mo id="A1.E12.m1.10.10.1.1.1.1.1.1.1.1.1.2" stretchy="false" xref="A1.E12.m1.10.10.1.1.1.1.1.1.1.1.1.1.cmml">
                 (
                </mo>
                <mrow id="A1.E12.m1.10.10.1.1.1.1.1.1.1.1.1.1" xref="A1.E12.m1.10.10.1.1.1.1.1.1.1.1.1.1.cmml">
                 <msub id="A1.E12.m1.10.10.1.1.1.1.1.1.1.1.1.1.3" xref="A1.E12.m1.10.10.1.1.1.1.1.1.1.1.1.1.3.cmml">
                  <mi id="A1.E12.m1.10.10.1.1.1.1.1.1.1.1.1.1.3.2" xref="A1.E12.m1.10.10.1.1.1.1.1.1.1.1.1.1.3.2.cmml">
                   w
                  </mi>
                  <mrow id="A1.E12.m1.10.10.1.1.1.1.1.1.1.1.1.1.3.3" xref="A1.E12.m1.10.10.1.1.1.1.1.1.1.1.1.1.3.3.cmml">
                   <mi id="A1.E12.m1.10.10.1.1.1.1.1.1.1.1.1.1.3.3.2" xref="A1.E12.m1.10.10.1.1.1.1.1.1.1.1.1.1.3.3.2.cmml">
                    j
                   </mi>
                   <mo id="A1.E12.m1.10.10.1.1.1.1.1.1.1.1.1.1.3.3.1" xref="A1.E12.m1.10.10.1.1.1.1.1.1.1.1.1.1.3.3.1.cmml">
                    +
                   </mo>
                   <mn id="A1.E12.m1.10.10.1.1.1.1.1.1.1.1.1.1.3.3.3" xref="A1.E12.m1.10.10.1.1.1.1.1.1.1.1.1.1.3.3.3.cmml">
                    1
                   </mn>
                  </mrow>
                 </msub>
                 <mo fence="false" id="A1.E12.m1.10.10.1.1.1.1.1.1.1.1.1.1.2" xref="A1.E12.m1.10.10.1.1.1.1.1.1.1.1.1.1.2.cmml">
                  |
                 </mo>
                 <mrow id="A1.E12.m1.10.10.1.1.1.1.1.1.1.1.1.1.1.1" xref="A1.E12.m1.10.10.1.1.1.1.1.1.1.1.1.1.1.2.cmml">
                  <mi id="A1.E12.m1.9.9" xref="A1.E12.m1.9.9.cmml">
                   s
                  </mi>
                  <mo id="A1.E12.m1.10.10.1.1.1.1.1.1.1.1.1.1.1.1.2" xref="A1.E12.m1.10.10.1.1.1.1.1.1.1.1.1.1.1.2.cmml">
                   ,
                  </mo>
                  <msub id="A1.E12.m1.10.10.1.1.1.1.1.1.1.1.1.1.1.1.1" xref="A1.E12.m1.10.10.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml">
                   <mi id="A1.E12.m1.10.10.1.1.1.1.1.1.1.1.1.1.1.1.1.2" xref="A1.E12.m1.10.10.1.1.1.1.1.1.1.1.1.1.1.1.1.2.cmml">
                    w
                   </mi>
                   <mrow id="A1.E12.m1.10.10.1.1.1.1.1.1.1.1.1.1.1.1.1.3" xref="A1.E12.m1.10.10.1.1.1.1.1.1.1.1.1.1.1.1.1.3.cmml">
                    <mn id="A1.E12.m1.10.10.1.1.1.1.1.1.1.1.1.1.1.1.1.3.2" xref="A1.E12.m1.10.10.1.1.1.1.1.1.1.1.1.1.1.1.1.3.2.cmml">
                     1
                    </mn>
                    <mo id="A1.E12.m1.10.10.1.1.1.1.1.1.1.1.1.1.1.1.1.3.1" lspace="0.278em" rspace="0.278em" xref="A1.E12.m1.10.10.1.1.1.1.1.1.1.1.1.1.1.1.1.3.1.cmml">
                     :
                    </mo>
                    <mi id="A1.E12.m1.10.10.1.1.1.1.1.1.1.1.1.1.1.1.1.3.3" xref="A1.E12.m1.10.10.1.1.1.1.1.1.1.1.1.1.1.1.1.3.3.cmml">
                     j
                    </mi>
                   </mrow>
                  </msub>
                 </mrow>
                </mrow>
                <mo id="A1.E12.m1.10.10.1.1.1.1.1.1.1.1.1.3" stretchy="false" xref="A1.E12.m1.10.10.1.1.1.1.1.1.1.1.1.1.cmml">
                 )
                </mo>
               </mrow>
              </mrow>
             </mrow>
             <mo id="A1.E12.m1.10.10.1.1.1.1.1.3" stretchy="false" xref="A1.E12.m1.10.10.1.1.1.1.2.1.cmml">
              ]
             </mo>
            </mrow>
           </mrow>
          </mrow>
          <mo id="A1.E12.m1.10.10.1.2" lspace="0em" xref="A1.E12.m1.10.10.1.1.cmml">
           .
          </mo>
         </mrow>
         <annotation-xml encoding="MathML-Content" id="A1.E12.m1.10b">
          <apply id="A1.E12.m1.10.10.1.1.cmml" xref="A1.E12.m1.10.10.1">
           <minus id="A1.E12.m1.10.10.1.1.2.cmml" xref="A1.E12.m1.10.10.1">
           </minus>
           <apply id="A1.E12.m1.10.10.1.1.1.cmml" xref="A1.E12.m1.10.10.1.1.1">
            <times id="A1.E12.m1.10.10.1.1.1.2.cmml" xref="A1.E12.m1.10.10.1.1.1.2">
            </times>
            <ci id="A1.E12.m1.10.10.1.1.1.3.cmml" xref="A1.E12.m1.10.10.1.1.1.3">
             𝛽
            </ci>
            <apply id="A1.E12.m1.10.10.1.1.1.4.cmml" xref="A1.E12.m1.10.10.1.1.1.4">
             <csymbol cd="ambiguous" id="A1.E12.m1.10.10.1.1.1.4.1.cmml" xref="A1.E12.m1.10.10.1.1.1.4">
              subscript
             </csymbol>
             <ci id="A1.E12.m1.10.10.1.1.1.4.2.cmml" xref="A1.E12.m1.10.10.1.1.1.4.2">
              𝔼
             </ci>
             <apply id="A1.E12.m1.7.7.7.8.cmml" xref="A1.E12.m1.7.7.7.7">
              <csymbol cd="ambiguous" id="A1.E12.m1.7.7.7.8a.cmml" xref="A1.E12.m1.7.7.7.7.3">
               formulae-sequence
              </csymbol>
              <apply id="A1.E12.m1.6.6.6.6.1.cmml" xref="A1.E12.m1.6.6.6.6.1">
               <csymbol cd="latexml" id="A1.E12.m1.6.6.6.6.1.2.cmml" xref="A1.E12.m1.6.6.6.6.1.2">
                similar-to
               </csymbol>
               <apply id="A1.E12.m1.6.6.6.6.1.3.cmml" xref="A1.E12.m1.6.6.6.6.1.3">
                <csymbol cd="ambiguous" id="A1.E12.m1.6.6.6.6.1.3.1.cmml" xref="A1.E12.m1.6.6.6.6.1.3">
                 subscript
                </csymbol>
                <ci id="A1.E12.m1.6.6.6.6.1.3.2.cmml" xref="A1.E12.m1.6.6.6.6.1.3.2">
                 𝑤
                </ci>
                <cn id="A1.E12.m1.6.6.6.6.1.3.3.cmml" type="integer" xref="A1.E12.m1.6.6.6.6.1.3.3">
                 1
                </cn>
               </apply>
               <list id="A1.E12.m1.6.6.6.6.1.1.2.cmml" xref="A1.E12.m1.6.6.6.6.1.1.1">
                <apply id="A1.E12.m1.6.6.6.6.1.1.1.1.cmml" xref="A1.E12.m1.6.6.6.6.1.1.1.1">
                 <times id="A1.E12.m1.6.6.6.6.1.1.1.1.1.cmml" xref="A1.E12.m1.6.6.6.6.1.1.1.1.1">
                 </times>
                 <apply id="A1.E12.m1.6.6.6.6.1.1.1.1.2.cmml" xref="A1.E12.m1.6.6.6.6.1.1.1.1.2">
                  <csymbol cd="ambiguous" id="A1.E12.m1.6.6.6.6.1.1.1.1.2.1.cmml" xref="A1.E12.m1.6.6.6.6.1.1.1.1.2">
                   superscript
                  </csymbol>
                  <ci id="A1.E12.m1.6.6.6.6.1.1.1.1.2.2.cmml" xref="A1.E12.m1.6.6.6.6.1.1.1.1.2.2">
                   𝜋
                  </ci>
                  <times id="A1.E12.m1.6.6.6.6.1.1.1.1.2.3.cmml" xref="A1.E12.m1.6.6.6.6.1.1.1.1.2.3">
                  </times>
                 </apply>
                 <ci id="A1.E12.m1.3.3.3.3.cmml" xref="A1.E12.m1.3.3.3.3">
                  𝑠
                 </ci>
                </apply>
                <ci id="A1.E12.m1.5.5.5.5.cmml" xref="A1.E12.m1.5.5.5.5">
                 …
                </ci>
               </list>
              </apply>
              <apply id="A1.E12.m1.7.7.7.7.2.cmml" xref="A1.E12.m1.7.7.7.7.2">
               <csymbol cd="latexml" id="A1.E12.m1.7.7.7.7.2.2.cmml" xref="A1.E12.m1.7.7.7.7.2.2">
                similar-to
               </csymbol>
               <apply id="A1.E12.m1.7.7.7.7.2.3.cmml" xref="A1.E12.m1.7.7.7.7.2.3">
                <csymbol cd="ambiguous" id="A1.E12.m1.7.7.7.7.2.3.1.cmml" xref="A1.E12.m1.7.7.7.7.2.3">
                 subscript
                </csymbol>
                <ci id="A1.E12.m1.7.7.7.7.2.3.2.cmml" xref="A1.E12.m1.7.7.7.7.2.3.2">
                 𝑤
                </ci>
                <apply id="A1.E12.m1.1.1.1.1.1.cmml" xref="A1.E12.m1.1.1.1.1.1">
                 <minus id="A1.E12.m1.1.1.1.1.1.2.cmml" xref="A1.E12.m1.1.1.1.1.1.2">
                 </minus>
                 <apply id="A1.E12.m1.1.1.1.1.1.3.1.cmml" xref="A1.E12.m1.1.1.1.1.1.3.2">
                  <abs id="A1.E12.m1.1.1.1.1.1.3.1.1.cmml" xref="A1.E12.m1.1.1.1.1.1.3.2.1">
                  </abs>
                  <ci id="A1.E12.m1.1.1.1.1.1.1.cmml" xref="A1.E12.m1.1.1.1.1.1.1">
                   𝑎
                  </ci>
                 </apply>
                 <cn id="A1.E12.m1.1.1.1.1.1.4.cmml" type="integer" xref="A1.E12.m1.1.1.1.1.1.4">
                  1
                 </cn>
                </apply>
               </apply>
               <apply id="A1.E12.m1.7.7.7.7.2.1.cmml" xref="A1.E12.m1.7.7.7.7.2.1">
                <times id="A1.E12.m1.7.7.7.7.2.1.2.cmml" xref="A1.E12.m1.7.7.7.7.2.1.2">
                </times>
                <apply id="A1.E12.m1.7.7.7.7.2.1.3.cmml" xref="A1.E12.m1.7.7.7.7.2.1.3">
                 <csymbol cd="ambiguous" id="A1.E12.m1.7.7.7.7.2.1.3.1.cmml" xref="A1.E12.m1.7.7.7.7.2.1.3">
                  superscript
                 </csymbol>
                 <ci id="A1.E12.m1.7.7.7.7.2.1.3.2.cmml" xref="A1.E12.m1.7.7.7.7.2.1.3.2">
                  𝜋
                 </ci>
                 <times id="A1.E12.m1.7.7.7.7.2.1.3.3.cmml" xref="A1.E12.m1.7.7.7.7.2.1.3.3">
                 </times>
                </apply>
                <interval closure="open" id="A1.E12.m1.7.7.7.7.2.1.1.2.cmml" xref="A1.E12.m1.7.7.7.7.2.1.1.1">
                 <ci id="A1.E12.m1.4.4.4.4.cmml" xref="A1.E12.m1.4.4.4.4">
                  𝑠
                 </ci>
                 <apply id="A1.E12.m1.7.7.7.7.2.1.1.1.1.cmml" xref="A1.E12.m1.7.7.7.7.2.1.1.1.1">
                  <csymbol cd="ambiguous" id="A1.E12.m1.7.7.7.7.2.1.1.1.1.1.cmml" xref="A1.E12.m1.7.7.7.7.2.1.1.1.1">
                   subscript
                  </csymbol>
                  <ci id="A1.E12.m1.7.7.7.7.2.1.1.1.1.2.cmml" xref="A1.E12.m1.7.7.7.7.2.1.1.1.1.2">
                   𝑤
                  </ci>
                  <apply id="A1.E12.m1.2.2.2.2.1.cmml" xref="A1.E12.m1.2.2.2.2.1">
                   <ci id="A1.E12.m1.2.2.2.2.1.2.cmml" xref="A1.E12.m1.2.2.2.2.1.2">
                    :
                   </ci>
                   <cn id="A1.E12.m1.2.2.2.2.1.3.cmml" type="integer" xref="A1.E12.m1.2.2.2.2.1.3">
                    1
                   </cn>
                   <apply id="A1.E12.m1.2.2.2.2.1.4.cmml" xref="A1.E12.m1.2.2.2.2.1.4">
                    <minus id="A1.E12.m1.2.2.2.2.1.4.1.cmml" xref="A1.E12.m1.2.2.2.2.1.4.1">
                    </minus>
                    <apply id="A1.E12.m1.2.2.2.2.1.4.2.1.cmml" xref="A1.E12.m1.2.2.2.2.1.4.2.2">
                     <abs id="A1.E12.m1.2.2.2.2.1.4.2.1.1.cmml" xref="A1.E12.m1.2.2.2.2.1.4.2.2.1">
                     </abs>
                     <ci id="A1.E12.m1.2.2.2.2.1.1.cmml" xref="A1.E12.m1.2.2.2.2.1.1">
                      𝑎
                     </ci>
                    </apply>
                    <cn id="A1.E12.m1.2.2.2.2.1.4.3.cmml" type="integer" xref="A1.E12.m1.2.2.2.2.1.4.3">
                     2
                    </cn>
                   </apply>
                  </apply>
                 </apply>
                </interval>
               </apply>
              </apply>
             </apply>
            </apply>
            <apply id="A1.E12.m1.10.10.1.1.1.1.2.cmml" xref="A1.E12.m1.10.10.1.1.1.1.1">
             <csymbol cd="latexml" id="A1.E12.m1.10.10.1.1.1.1.2.1.cmml" xref="A1.E12.m1.10.10.1.1.1.1.1.2">
              delimited-[]
             </csymbol>
             <apply id="A1.E12.m1.10.10.1.1.1.1.1.1.cmml" xref="A1.E12.m1.10.10.1.1.1.1.1.1">
              <apply id="A1.E12.m1.10.10.1.1.1.1.1.1.2.cmml" xref="A1.E12.m1.10.10.1.1.1.1.1.1.2">
               <csymbol cd="ambiguous" id="A1.E12.m1.10.10.1.1.1.1.1.1.2.1.cmml" xref="A1.E12.m1.10.10.1.1.1.1.1.1.2">
                superscript
               </csymbol>
               <apply id="A1.E12.m1.10.10.1.1.1.1.1.1.2.2.cmml" xref="A1.E12.m1.10.10.1.1.1.1.1.1.2">
                <csymbol cd="ambiguous" id="A1.E12.m1.10.10.1.1.1.1.1.1.2.2.1.cmml" xref="A1.E12.m1.10.10.1.1.1.1.1.1.2">
                 subscript
                </csymbol>
                <sum id="A1.E12.m1.10.10.1.1.1.1.1.1.2.2.2.cmml" xref="A1.E12.m1.10.10.1.1.1.1.1.1.2.2.2">
                </sum>
                <apply id="A1.E12.m1.10.10.1.1.1.1.1.1.2.2.3.cmml" xref="A1.E12.m1.10.10.1.1.1.1.1.1.2.2.3">
                 <eq id="A1.E12.m1.10.10.1.1.1.1.1.1.2.2.3.1.cmml" xref="A1.E12.m1.10.10.1.1.1.1.1.1.2.2.3.1">
                 </eq>
                 <ci id="A1.E12.m1.10.10.1.1.1.1.1.1.2.2.3.2.cmml" xref="A1.E12.m1.10.10.1.1.1.1.1.1.2.2.3.2">
                  𝑗
                 </ci>
                 <cn id="A1.E12.m1.10.10.1.1.1.1.1.1.2.2.3.3.cmml" type="integer" xref="A1.E12.m1.10.10.1.1.1.1.1.1.2.2.3.3">
                  1
                 </cn>
                </apply>
               </apply>
               <apply id="A1.E12.m1.8.8.1.cmml" xref="A1.E12.m1.8.8.1">
                <minus id="A1.E12.m1.8.8.1.2.cmml" xref="A1.E12.m1.8.8.1.2">
                </minus>
                <apply id="A1.E12.m1.8.8.1.3.1.cmml" xref="A1.E12.m1.8.8.1.3.2">
                 <abs id="A1.E12.m1.8.8.1.3.1.1.cmml" xref="A1.E12.m1.8.8.1.3.2.1">
                 </abs>
                 <ci id="A1.E12.m1.8.8.1.1.cmml" xref="A1.E12.m1.8.8.1.1">
                  𝑎
                 </ci>
                </apply>
                <cn id="A1.E12.m1.8.8.1.4.cmml" type="integer" xref="A1.E12.m1.8.8.1.4">
                 1
                </cn>
               </apply>
              </apply>
              <apply id="A1.E12.m1.10.10.1.1.1.1.1.1.1.cmml" xref="A1.E12.m1.10.10.1.1.1.1.1.1.1">
               <times id="A1.E12.m1.10.10.1.1.1.1.1.1.1.2.cmml" xref="A1.E12.m1.10.10.1.1.1.1.1.1.1.2">
               </times>
               <ci id="A1.E12.m1.10.10.1.1.1.1.1.1.1.3a.cmml" xref="A1.E12.m1.10.10.1.1.1.1.1.1.1.3">
                <mtext id="A1.E12.m1.10.10.1.1.1.1.1.1.1.3.cmml" xref="A1.E12.m1.10.10.1.1.1.1.1.1.1.3">
                 KL
                </mtext>
               </ci>
               <apply id="A1.E12.m1.10.10.1.1.1.1.1.1.1.1.1.1.cmml" xref="A1.E12.m1.10.10.1.1.1.1.1.1.1.1.1">
                <csymbol cd="latexml" id="A1.E12.m1.10.10.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="A1.E12.m1.10.10.1.1.1.1.1.1.1.1.1.1.2">
                 conditional
                </csymbol>
                <apply id="A1.E12.m1.10.10.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="A1.E12.m1.10.10.1.1.1.1.1.1.1.1.1.1.3">
                 <csymbol cd="ambiguous" id="A1.E12.m1.10.10.1.1.1.1.1.1.1.1.1.1.3.1.cmml" xref="A1.E12.m1.10.10.1.1.1.1.1.1.1.1.1.1.3">
                  subscript
                 </csymbol>
                 <ci id="A1.E12.m1.10.10.1.1.1.1.1.1.1.1.1.1.3.2.cmml" xref="A1.E12.m1.10.10.1.1.1.1.1.1.1.1.1.1.3.2">
                  𝑤
                 </ci>
                 <apply id="A1.E12.m1.10.10.1.1.1.1.1.1.1.1.1.1.3.3.cmml" xref="A1.E12.m1.10.10.1.1.1.1.1.1.1.1.1.1.3.3">
                  <plus id="A1.E12.m1.10.10.1.1.1.1.1.1.1.1.1.1.3.3.1.cmml" xref="A1.E12.m1.10.10.1.1.1.1.1.1.1.1.1.1.3.3.1">
                  </plus>
                  <ci id="A1.E12.m1.10.10.1.1.1.1.1.1.1.1.1.1.3.3.2.cmml" xref="A1.E12.m1.10.10.1.1.1.1.1.1.1.1.1.1.3.3.2">
                   𝑗
                  </ci>
                  <cn id="A1.E12.m1.10.10.1.1.1.1.1.1.1.1.1.1.3.3.3.cmml" type="integer" xref="A1.E12.m1.10.10.1.1.1.1.1.1.1.1.1.1.3.3.3">
                   1
                  </cn>
                 </apply>
                </apply>
                <list id="A1.E12.m1.10.10.1.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="A1.E12.m1.10.10.1.1.1.1.1.1.1.1.1.1.1.1">
                 <ci id="A1.E12.m1.9.9.cmml" xref="A1.E12.m1.9.9">
                  𝑠
                 </ci>
                 <apply id="A1.E12.m1.10.10.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="A1.E12.m1.10.10.1.1.1.1.1.1.1.1.1.1.1.1.1">
                  <csymbol cd="ambiguous" id="A1.E12.m1.10.10.1.1.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="A1.E12.m1.10.10.1.1.1.1.1.1.1.1.1.1.1.1.1">
                   subscript
                  </csymbol>
                  <ci id="A1.E12.m1.10.10.1.1.1.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="A1.E12.m1.10.10.1.1.1.1.1.1.1.1.1.1.1.1.1.2">
                   𝑤
                  </ci>
                  <apply id="A1.E12.m1.10.10.1.1.1.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="A1.E12.m1.10.10.1.1.1.1.1.1.1.1.1.1.1.1.1.3">
                   <ci id="A1.E12.m1.10.10.1.1.1.1.1.1.1.1.1.1.1.1.1.3.1.cmml" xref="A1.E12.m1.10.10.1.1.1.1.1.1.1.1.1.1.1.1.1.3.1">
                    :
                   </ci>
                   <cn id="A1.E12.m1.10.10.1.1.1.1.1.1.1.1.1.1.1.1.1.3.2.cmml" type="integer" xref="A1.E12.m1.10.10.1.1.1.1.1.1.1.1.1.1.1.1.1.3.2">
                    1
                   </cn>
                   <ci id="A1.E12.m1.10.10.1.1.1.1.1.1.1.1.1.1.1.1.1.3.3.cmml" xref="A1.E12.m1.10.10.1.1.1.1.1.1.1.1.1.1.1.1.1.3.3">
                    𝑗
                   </ci>
                  </apply>
                 </apply>
                </list>
               </apply>
              </apply>
             </apply>
            </apply>
           </apply>
          </apply>
         </annotation-xml>
         <annotation encoding="application/x-tex" id="A1.E12.m1.10c">
          \displaystyle~{}~{}~{}~{}-\beta\mathbb{E}_{w_{1}\sim\pi^{*}(s),\dots,w_{|a|-1}\sim\pi^{*}(s,w_{1:|a|-2})}[\sum_{j=1}^{|a|-1}\text{KL}(w_{j+1}|s,w_{1:j})].
         </annotation>
        </semantics>
       </math>
      </td>
      <td class="ltx_eqn_cell ltx_eqn_center_padright">
      </td>
      <td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1">
       <span class="ltx_tag ltx_tag_equation ltx_align_right">
        (12)
       </span>
      </td>
     </tr>
    </tbody>
   </table>
  </div>
  <div class="ltx_para" id="A1.p4">
   <p class="ltx_p" id="A1.p4.2">
    Minus
    <math alttext="\beta\text{KL}(w_{1}|s)" class="ltx_Math" display="inline" id="A1.p4.1.m1.1">
     <semantics id="A1.p4.1.m1.1a">
      <mrow id="A1.p4.1.m1.1.1" xref="A1.p4.1.m1.1.1.cmml">
       <mi id="A1.p4.1.m1.1.1.3" xref="A1.p4.1.m1.1.1.3.cmml">
        β
       </mi>
       <mo id="A1.p4.1.m1.1.1.2" lspace="0em" rspace="0em" xref="A1.p4.1.m1.1.1.2.cmml">
        ​
       </mo>
       <mtext id="A1.p4.1.m1.1.1.4" xref="A1.p4.1.m1.1.1.4a.cmml">
        KL
       </mtext>
       <mo id="A1.p4.1.m1.1.1.2a" lspace="0em" rspace="0em" xref="A1.p4.1.m1.1.1.2.cmml">
        ​
       </mo>
       <mrow id="A1.p4.1.m1.1.1.1.1" xref="A1.p4.1.m1.1.1.1.1.1.cmml">
        <mo id="A1.p4.1.m1.1.1.1.1.2" stretchy="false" xref="A1.p4.1.m1.1.1.1.1.1.cmml">
         (
        </mo>
        <mrow id="A1.p4.1.m1.1.1.1.1.1" xref="A1.p4.1.m1.1.1.1.1.1.cmml">
         <msub id="A1.p4.1.m1.1.1.1.1.1.2" xref="A1.p4.1.m1.1.1.1.1.1.2.cmml">
          <mi id="A1.p4.1.m1.1.1.1.1.1.2.2" xref="A1.p4.1.m1.1.1.1.1.1.2.2.cmml">
           w
          </mi>
          <mn id="A1.p4.1.m1.1.1.1.1.1.2.3" xref="A1.p4.1.m1.1.1.1.1.1.2.3.cmml">
           1
          </mn>
         </msub>
         <mo fence="false" id="A1.p4.1.m1.1.1.1.1.1.1" xref="A1.p4.1.m1.1.1.1.1.1.1.cmml">
          |
         </mo>
         <mi id="A1.p4.1.m1.1.1.1.1.1.3" xref="A1.p4.1.m1.1.1.1.1.1.3.cmml">
          s
         </mi>
        </mrow>
        <mo id="A1.p4.1.m1.1.1.1.1.3" stretchy="false" xref="A1.p4.1.m1.1.1.1.1.1.cmml">
         )
        </mo>
       </mrow>
      </mrow>
      <annotation-xml encoding="MathML-Content" id="A1.p4.1.m1.1b">
       <apply id="A1.p4.1.m1.1.1.cmml" xref="A1.p4.1.m1.1.1">
        <times id="A1.p4.1.m1.1.1.2.cmml" xref="A1.p4.1.m1.1.1.2">
        </times>
        <ci id="A1.p4.1.m1.1.1.3.cmml" xref="A1.p4.1.m1.1.1.3">
         𝛽
        </ci>
        <ci id="A1.p4.1.m1.1.1.4a.cmml" xref="A1.p4.1.m1.1.1.4">
         <mtext id="A1.p4.1.m1.1.1.4.cmml" xref="A1.p4.1.m1.1.1.4">
          KL
         </mtext>
        </ci>
        <apply id="A1.p4.1.m1.1.1.1.1.1.cmml" xref="A1.p4.1.m1.1.1.1.1">
         <csymbol cd="latexml" id="A1.p4.1.m1.1.1.1.1.1.1.cmml" xref="A1.p4.1.m1.1.1.1.1.1.1">
          conditional
         </csymbol>
         <apply id="A1.p4.1.m1.1.1.1.1.1.2.cmml" xref="A1.p4.1.m1.1.1.1.1.1.2">
          <csymbol cd="ambiguous" id="A1.p4.1.m1.1.1.1.1.1.2.1.cmml" xref="A1.p4.1.m1.1.1.1.1.1.2">
           subscript
          </csymbol>
          <ci id="A1.p4.1.m1.1.1.1.1.1.2.2.cmml" xref="A1.p4.1.m1.1.1.1.1.1.2.2">
           𝑤
          </ci>
          <cn id="A1.p4.1.m1.1.1.1.1.1.2.3.cmml" type="integer" xref="A1.p4.1.m1.1.1.1.1.1.2.3">
           1
          </cn>
         </apply>
         <ci id="A1.p4.1.m1.1.1.1.1.1.3.cmml" xref="A1.p4.1.m1.1.1.1.1.1.3">
          𝑠
         </ci>
        </apply>
       </apply>
      </annotation-xml>
      <annotation encoding="application/x-tex" id="A1.p4.1.m1.1c">
       \beta\text{KL}(w_{1}|s)
      </annotation>
     </semantics>
    </math>
    from both sides (Note here we use
    <math alttext="\mathbb{E}_{a\sim\pi^{*}(s)}[\cdot]=\mathbb{E}_{w_{1}\sim\pi^{*}(s),\dots,w_{|a|}\sim\pi^{*}(s,w_{1:|a|-1})}[\cdot]" class="ltx_Math" display="inline" id="A1.p4.2.m2.10">
     <semantics id="A1.p4.2.m2.10a">
      <mrow id="A1.p4.2.m2.10.11" xref="A1.p4.2.m2.10.11.cmml">
       <mrow id="A1.p4.2.m2.10.11.2" xref="A1.p4.2.m2.10.11.2.cmml">
        <msub id="A1.p4.2.m2.10.11.2.2" xref="A1.p4.2.m2.10.11.2.2.cmml">
         <mi id="A1.p4.2.m2.10.11.2.2.2" xref="A1.p4.2.m2.10.11.2.2.2.cmml">
          𝔼
         </mi>
         <mrow id="A1.p4.2.m2.1.1.1" xref="A1.p4.2.m2.1.1.1.cmml">
          <mi id="A1.p4.2.m2.1.1.1.3" xref="A1.p4.2.m2.1.1.1.3.cmml">
           a
          </mi>
          <mo id="A1.p4.2.m2.1.1.1.2" xref="A1.p4.2.m2.1.1.1.2.cmml">
           ∼
          </mo>
          <mrow id="A1.p4.2.m2.1.1.1.4" xref="A1.p4.2.m2.1.1.1.4.cmml">
           <msup id="A1.p4.2.m2.1.1.1.4.2" xref="A1.p4.2.m2.1.1.1.4.2.cmml">
            <mi id="A1.p4.2.m2.1.1.1.4.2.2" xref="A1.p4.2.m2.1.1.1.4.2.2.cmml">
             π
            </mi>
            <mo id="A1.p4.2.m2.1.1.1.4.2.3" xref="A1.p4.2.m2.1.1.1.4.2.3.cmml">
             ∗
            </mo>
           </msup>
           <mo id="A1.p4.2.m2.1.1.1.4.1" lspace="0em" rspace="0em" xref="A1.p4.2.m2.1.1.1.4.1.cmml">
            ​
           </mo>
           <mrow id="A1.p4.2.m2.1.1.1.4.3.2" xref="A1.p4.2.m2.1.1.1.4.cmml">
            <mo id="A1.p4.2.m2.1.1.1.4.3.2.1" stretchy="false" xref="A1.p4.2.m2.1.1.1.4.cmml">
             (
            </mo>
            <mi id="A1.p4.2.m2.1.1.1.1" xref="A1.p4.2.m2.1.1.1.1.cmml">
             s
            </mi>
            <mo id="A1.p4.2.m2.1.1.1.4.3.2.2" stretchy="false" xref="A1.p4.2.m2.1.1.1.4.cmml">
             )
            </mo>
           </mrow>
          </mrow>
         </mrow>
        </msub>
        <mo id="A1.p4.2.m2.10.11.2.1" lspace="0em" rspace="0em" xref="A1.p4.2.m2.10.11.2.1.cmml">
         ​
        </mo>
        <mrow id="A1.p4.2.m2.10.11.2.3.2" xref="A1.p4.2.m2.10.11.2.3.1.cmml">
         <mo id="A1.p4.2.m2.10.11.2.3.2.1" stretchy="false" xref="A1.p4.2.m2.10.11.2.3.1.1.cmml">
          [
         </mo>
         <mo id="A1.p4.2.m2.9.9" lspace="0em" rspace="0em" xref="A1.p4.2.m2.9.9.cmml">
          ⋅
         </mo>
         <mo id="A1.p4.2.m2.10.11.2.3.2.2" stretchy="false" xref="A1.p4.2.m2.10.11.2.3.1.1.cmml">
          ]
         </mo>
        </mrow>
       </mrow>
       <mo id="A1.p4.2.m2.10.11.1" xref="A1.p4.2.m2.10.11.1.cmml">
        =
       </mo>
       <mrow id="A1.p4.2.m2.10.11.3" xref="A1.p4.2.m2.10.11.3.cmml">
        <msub id="A1.p4.2.m2.10.11.3.2" xref="A1.p4.2.m2.10.11.3.2.cmml">
         <mi id="A1.p4.2.m2.10.11.3.2.2" xref="A1.p4.2.m2.10.11.3.2.2.cmml">
          𝔼
         </mi>
         <mrow id="A1.p4.2.m2.8.8.7.7" xref="A1.p4.2.m2.8.8.7.8.cmml">
          <mrow id="A1.p4.2.m2.7.7.6.6.1" xref="A1.p4.2.m2.7.7.6.6.1.cmml">
           <msub id="A1.p4.2.m2.7.7.6.6.1.3" xref="A1.p4.2.m2.7.7.6.6.1.3.cmml">
            <mi id="A1.p4.2.m2.7.7.6.6.1.3.2" xref="A1.p4.2.m2.7.7.6.6.1.3.2.cmml">
             w
            </mi>
            <mn id="A1.p4.2.m2.7.7.6.6.1.3.3" xref="A1.p4.2.m2.7.7.6.6.1.3.3.cmml">
             1
            </mn>
           </msub>
           <mo id="A1.p4.2.m2.7.7.6.6.1.2" xref="A1.p4.2.m2.7.7.6.6.1.2.cmml">
            ∼
           </mo>
           <mrow id="A1.p4.2.m2.7.7.6.6.1.1.1" xref="A1.p4.2.m2.7.7.6.6.1.1.2.cmml">
            <mrow id="A1.p4.2.m2.7.7.6.6.1.1.1.1" xref="A1.p4.2.m2.7.7.6.6.1.1.1.1.cmml">
             <msup id="A1.p4.2.m2.7.7.6.6.1.1.1.1.2" xref="A1.p4.2.m2.7.7.6.6.1.1.1.1.2.cmml">
              <mi id="A1.p4.2.m2.7.7.6.6.1.1.1.1.2.2" xref="A1.p4.2.m2.7.7.6.6.1.1.1.1.2.2.cmml">
               π
              </mi>
              <mo id="A1.p4.2.m2.7.7.6.6.1.1.1.1.2.3" xref="A1.p4.2.m2.7.7.6.6.1.1.1.1.2.3.cmml">
               ∗
              </mo>
             </msup>
             <mo id="A1.p4.2.m2.7.7.6.6.1.1.1.1.1" lspace="0em" rspace="0em" xref="A1.p4.2.m2.7.7.6.6.1.1.1.1.1.cmml">
              ​
             </mo>
             <mrow id="A1.p4.2.m2.7.7.6.6.1.1.1.1.3.2" xref="A1.p4.2.m2.7.7.6.6.1.1.1.1.cmml">
              <mo id="A1.p4.2.m2.7.7.6.6.1.1.1.1.3.2.1" stretchy="false" xref="A1.p4.2.m2.7.7.6.6.1.1.1.1.cmml">
               (
              </mo>
              <mi id="A1.p4.2.m2.4.4.3.3" xref="A1.p4.2.m2.4.4.3.3.cmml">
               s
              </mi>
              <mo id="A1.p4.2.m2.7.7.6.6.1.1.1.1.3.2.2" stretchy="false" xref="A1.p4.2.m2.7.7.6.6.1.1.1.1.cmml">
               )
              </mo>
             </mrow>
            </mrow>
            <mo id="A1.p4.2.m2.7.7.6.6.1.1.1.2" xref="A1.p4.2.m2.7.7.6.6.1.1.2.cmml">
             ,
            </mo>
            <mi id="A1.p4.2.m2.6.6.5.5" mathvariant="normal" xref="A1.p4.2.m2.6.6.5.5.cmml">
             …
            </mi>
           </mrow>
          </mrow>
          <mo id="A1.p4.2.m2.8.8.7.7.3" xref="A1.p4.2.m2.8.8.7.8a.cmml">
           ,
          </mo>
          <mrow id="A1.p4.2.m2.8.8.7.7.2" xref="A1.p4.2.m2.8.8.7.7.2.cmml">
           <msub id="A1.p4.2.m2.8.8.7.7.2.3" xref="A1.p4.2.m2.8.8.7.7.2.3.cmml">
            <mi id="A1.p4.2.m2.8.8.7.7.2.3.2" xref="A1.p4.2.m2.8.8.7.7.2.3.2.cmml">
             w
            </mi>
            <mrow id="A1.p4.2.m2.2.2.1.1.1.3" xref="A1.p4.2.m2.2.2.1.1.1.2.cmml">
             <mo id="A1.p4.2.m2.2.2.1.1.1.3.1" stretchy="false" xref="A1.p4.2.m2.2.2.1.1.1.2.1.cmml">
              |
             </mo>
             <mi id="A1.p4.2.m2.2.2.1.1.1.1" xref="A1.p4.2.m2.2.2.1.1.1.1.cmml">
              a
             </mi>
             <mo id="A1.p4.2.m2.2.2.1.1.1.3.2" stretchy="false" xref="A1.p4.2.m2.2.2.1.1.1.2.1.cmml">
              |
             </mo>
            </mrow>
           </msub>
           <mo id="A1.p4.2.m2.8.8.7.7.2.2" xref="A1.p4.2.m2.8.8.7.7.2.2.cmml">
            ∼
           </mo>
           <mrow id="A1.p4.2.m2.8.8.7.7.2.1" xref="A1.p4.2.m2.8.8.7.7.2.1.cmml">
            <msup id="A1.p4.2.m2.8.8.7.7.2.1.3" xref="A1.p4.2.m2.8.8.7.7.2.1.3.cmml">
             <mi id="A1.p4.2.m2.8.8.7.7.2.1.3.2" xref="A1.p4.2.m2.8.8.7.7.2.1.3.2.cmml">
              π
             </mi>
             <mo id="A1.p4.2.m2.8.8.7.7.2.1.3.3" xref="A1.p4.2.m2.8.8.7.7.2.1.3.3.cmml">
              ∗
             </mo>
            </msup>
            <mo id="A1.p4.2.m2.8.8.7.7.2.1.2" lspace="0em" rspace="0em" xref="A1.p4.2.m2.8.8.7.7.2.1.2.cmml">
             ​
            </mo>
            <mrow id="A1.p4.2.m2.8.8.7.7.2.1.1.1" xref="A1.p4.2.m2.8.8.7.7.2.1.1.2.cmml">
             <mo id="A1.p4.2.m2.8.8.7.7.2.1.1.1.2" stretchy="false" xref="A1.p4.2.m2.8.8.7.7.2.1.1.2.cmml">
              (
             </mo>
             <mi id="A1.p4.2.m2.5.5.4.4" xref="A1.p4.2.m2.5.5.4.4.cmml">
              s
             </mi>
             <mo id="A1.p4.2.m2.8.8.7.7.2.1.1.1.3" xref="A1.p4.2.m2.8.8.7.7.2.1.1.2.cmml">
              ,
             </mo>
             <msub id="A1.p4.2.m2.8.8.7.7.2.1.1.1.1" xref="A1.p4.2.m2.8.8.7.7.2.1.1.1.1.cmml">
              <mi id="A1.p4.2.m2.8.8.7.7.2.1.1.1.1.2" xref="A1.p4.2.m2.8.8.7.7.2.1.1.1.1.2.cmml">
               w
              </mi>
              <mrow id="A1.p4.2.m2.3.3.2.2.1" xref="A1.p4.2.m2.3.3.2.2.1.cmml">
               <mn id="A1.p4.2.m2.3.3.2.2.1.3" xref="A1.p4.2.m2.3.3.2.2.1.3.cmml">
                1
               </mn>
               <mo id="A1.p4.2.m2.3.3.2.2.1.2" lspace="0.278em" rspace="0.278em" xref="A1.p4.2.m2.3.3.2.2.1.2.cmml">
                :
               </mo>
               <mrow id="A1.p4.2.m2.3.3.2.2.1.4" xref="A1.p4.2.m2.3.3.2.2.1.4.cmml">
                <mrow id="A1.p4.2.m2.3.3.2.2.1.4.2.2" xref="A1.p4.2.m2.3.3.2.2.1.4.2.1.cmml">
                 <mo id="A1.p4.2.m2.3.3.2.2.1.4.2.2.1" stretchy="false" xref="A1.p4.2.m2.3.3.2.2.1.4.2.1.1.cmml">
                  |
                 </mo>
                 <mi id="A1.p4.2.m2.3.3.2.2.1.1" xref="A1.p4.2.m2.3.3.2.2.1.1.cmml">
                  a
                 </mi>
                 <mo id="A1.p4.2.m2.3.3.2.2.1.4.2.2.2" stretchy="false" xref="A1.p4.2.m2.3.3.2.2.1.4.2.1.1.cmml">
                  |
                 </mo>
                </mrow>
                <mo id="A1.p4.2.m2.3.3.2.2.1.4.1" xref="A1.p4.2.m2.3.3.2.2.1.4.1.cmml">
                 −
                </mo>
                <mn id="A1.p4.2.m2.3.3.2.2.1.4.3" xref="A1.p4.2.m2.3.3.2.2.1.4.3.cmml">
                 1
                </mn>
               </mrow>
              </mrow>
             </msub>
             <mo id="A1.p4.2.m2.8.8.7.7.2.1.1.1.4" stretchy="false" xref="A1.p4.2.m2.8.8.7.7.2.1.1.2.cmml">
              )
             </mo>
            </mrow>
           </mrow>
          </mrow>
         </mrow>
        </msub>
        <mo id="A1.p4.2.m2.10.11.3.1" lspace="0em" rspace="0em" xref="A1.p4.2.m2.10.11.3.1.cmml">
         ​
        </mo>
        <mrow id="A1.p4.2.m2.10.11.3.3.2" xref="A1.p4.2.m2.10.11.3.3.1.cmml">
         <mo id="A1.p4.2.m2.10.11.3.3.2.1" stretchy="false" xref="A1.p4.2.m2.10.11.3.3.1.1.cmml">
          [
         </mo>
         <mo id="A1.p4.2.m2.10.10" lspace="0em" rspace="0em" xref="A1.p4.2.m2.10.10.cmml">
          ⋅
         </mo>
         <mo id="A1.p4.2.m2.10.11.3.3.2.2" stretchy="false" xref="A1.p4.2.m2.10.11.3.3.1.1.cmml">
          ]
         </mo>
        </mrow>
       </mrow>
      </mrow>
      <annotation-xml encoding="MathML-Content" id="A1.p4.2.m2.10b">
       <apply id="A1.p4.2.m2.10.11.cmml" xref="A1.p4.2.m2.10.11">
        <eq id="A1.p4.2.m2.10.11.1.cmml" xref="A1.p4.2.m2.10.11.1">
        </eq>
        <apply id="A1.p4.2.m2.10.11.2.cmml" xref="A1.p4.2.m2.10.11.2">
         <times id="A1.p4.2.m2.10.11.2.1.cmml" xref="A1.p4.2.m2.10.11.2.1">
         </times>
         <apply id="A1.p4.2.m2.10.11.2.2.cmml" xref="A1.p4.2.m2.10.11.2.2">
          <csymbol cd="ambiguous" id="A1.p4.2.m2.10.11.2.2.1.cmml" xref="A1.p4.2.m2.10.11.2.2">
           subscript
          </csymbol>
          <ci id="A1.p4.2.m2.10.11.2.2.2.cmml" xref="A1.p4.2.m2.10.11.2.2.2">
           𝔼
          </ci>
          <apply id="A1.p4.2.m2.1.1.1.cmml" xref="A1.p4.2.m2.1.1.1">
           <csymbol cd="latexml" id="A1.p4.2.m2.1.1.1.2.cmml" xref="A1.p4.2.m2.1.1.1.2">
            similar-to
           </csymbol>
           <ci id="A1.p4.2.m2.1.1.1.3.cmml" xref="A1.p4.2.m2.1.1.1.3">
            𝑎
           </ci>
           <apply id="A1.p4.2.m2.1.1.1.4.cmml" xref="A1.p4.2.m2.1.1.1.4">
            <times id="A1.p4.2.m2.1.1.1.4.1.cmml" xref="A1.p4.2.m2.1.1.1.4.1">
            </times>
            <apply id="A1.p4.2.m2.1.1.1.4.2.cmml" xref="A1.p4.2.m2.1.1.1.4.2">
             <csymbol cd="ambiguous" id="A1.p4.2.m2.1.1.1.4.2.1.cmml" xref="A1.p4.2.m2.1.1.1.4.2">
              superscript
             </csymbol>
             <ci id="A1.p4.2.m2.1.1.1.4.2.2.cmml" xref="A1.p4.2.m2.1.1.1.4.2.2">
              𝜋
             </ci>
             <times id="A1.p4.2.m2.1.1.1.4.2.3.cmml" xref="A1.p4.2.m2.1.1.1.4.2.3">
             </times>
            </apply>
            <ci id="A1.p4.2.m2.1.1.1.1.cmml" xref="A1.p4.2.m2.1.1.1.1">
             𝑠
            </ci>
           </apply>
          </apply>
         </apply>
         <apply id="A1.p4.2.m2.10.11.2.3.1.cmml" xref="A1.p4.2.m2.10.11.2.3.2">
          <csymbol cd="latexml" id="A1.p4.2.m2.10.11.2.3.1.1.cmml" xref="A1.p4.2.m2.10.11.2.3.2.1">
           delimited-[]
          </csymbol>
          <ci id="A1.p4.2.m2.9.9.cmml" xref="A1.p4.2.m2.9.9">
           ⋅
          </ci>
         </apply>
        </apply>
        <apply id="A1.p4.2.m2.10.11.3.cmml" xref="A1.p4.2.m2.10.11.3">
         <times id="A1.p4.2.m2.10.11.3.1.cmml" xref="A1.p4.2.m2.10.11.3.1">
         </times>
         <apply id="A1.p4.2.m2.10.11.3.2.cmml" xref="A1.p4.2.m2.10.11.3.2">
          <csymbol cd="ambiguous" id="A1.p4.2.m2.10.11.3.2.1.cmml" xref="A1.p4.2.m2.10.11.3.2">
           subscript
          </csymbol>
          <ci id="A1.p4.2.m2.10.11.3.2.2.cmml" xref="A1.p4.2.m2.10.11.3.2.2">
           𝔼
          </ci>
          <apply id="A1.p4.2.m2.8.8.7.8.cmml" xref="A1.p4.2.m2.8.8.7.7">
           <csymbol cd="ambiguous" id="A1.p4.2.m2.8.8.7.8a.cmml" xref="A1.p4.2.m2.8.8.7.7.3">
            formulae-sequence
           </csymbol>
           <apply id="A1.p4.2.m2.7.7.6.6.1.cmml" xref="A1.p4.2.m2.7.7.6.6.1">
            <csymbol cd="latexml" id="A1.p4.2.m2.7.7.6.6.1.2.cmml" xref="A1.p4.2.m2.7.7.6.6.1.2">
             similar-to
            </csymbol>
            <apply id="A1.p4.2.m2.7.7.6.6.1.3.cmml" xref="A1.p4.2.m2.7.7.6.6.1.3">
             <csymbol cd="ambiguous" id="A1.p4.2.m2.7.7.6.6.1.3.1.cmml" xref="A1.p4.2.m2.7.7.6.6.1.3">
              subscript
             </csymbol>
             <ci id="A1.p4.2.m2.7.7.6.6.1.3.2.cmml" xref="A1.p4.2.m2.7.7.6.6.1.3.2">
              𝑤
             </ci>
             <cn id="A1.p4.2.m2.7.7.6.6.1.3.3.cmml" type="integer" xref="A1.p4.2.m2.7.7.6.6.1.3.3">
              1
             </cn>
            </apply>
            <list id="A1.p4.2.m2.7.7.6.6.1.1.2.cmml" xref="A1.p4.2.m2.7.7.6.6.1.1.1">
             <apply id="A1.p4.2.m2.7.7.6.6.1.1.1.1.cmml" xref="A1.p4.2.m2.7.7.6.6.1.1.1.1">
              <times id="A1.p4.2.m2.7.7.6.6.1.1.1.1.1.cmml" xref="A1.p4.2.m2.7.7.6.6.1.1.1.1.1">
              </times>
              <apply id="A1.p4.2.m2.7.7.6.6.1.1.1.1.2.cmml" xref="A1.p4.2.m2.7.7.6.6.1.1.1.1.2">
               <csymbol cd="ambiguous" id="A1.p4.2.m2.7.7.6.6.1.1.1.1.2.1.cmml" xref="A1.p4.2.m2.7.7.6.6.1.1.1.1.2">
                superscript
               </csymbol>
               <ci id="A1.p4.2.m2.7.7.6.6.1.1.1.1.2.2.cmml" xref="A1.p4.2.m2.7.7.6.6.1.1.1.1.2.2">
                𝜋
               </ci>
               <times id="A1.p4.2.m2.7.7.6.6.1.1.1.1.2.3.cmml" xref="A1.p4.2.m2.7.7.6.6.1.1.1.1.2.3">
               </times>
              </apply>
              <ci id="A1.p4.2.m2.4.4.3.3.cmml" xref="A1.p4.2.m2.4.4.3.3">
               𝑠
              </ci>
             </apply>
             <ci id="A1.p4.2.m2.6.6.5.5.cmml" xref="A1.p4.2.m2.6.6.5.5">
              …
             </ci>
            </list>
           </apply>
           <apply id="A1.p4.2.m2.8.8.7.7.2.cmml" xref="A1.p4.2.m2.8.8.7.7.2">
            <csymbol cd="latexml" id="A1.p4.2.m2.8.8.7.7.2.2.cmml" xref="A1.p4.2.m2.8.8.7.7.2.2">
             similar-to
            </csymbol>
            <apply id="A1.p4.2.m2.8.8.7.7.2.3.cmml" xref="A1.p4.2.m2.8.8.7.7.2.3">
             <csymbol cd="ambiguous" id="A1.p4.2.m2.8.8.7.7.2.3.1.cmml" xref="A1.p4.2.m2.8.8.7.7.2.3">
              subscript
             </csymbol>
             <ci id="A1.p4.2.m2.8.8.7.7.2.3.2.cmml" xref="A1.p4.2.m2.8.8.7.7.2.3.2">
              𝑤
             </ci>
             <apply id="A1.p4.2.m2.2.2.1.1.1.2.cmml" xref="A1.p4.2.m2.2.2.1.1.1.3">
              <abs id="A1.p4.2.m2.2.2.1.1.1.2.1.cmml" xref="A1.p4.2.m2.2.2.1.1.1.3.1">
              </abs>
              <ci id="A1.p4.2.m2.2.2.1.1.1.1.cmml" xref="A1.p4.2.m2.2.2.1.1.1.1">
               𝑎
              </ci>
             </apply>
            </apply>
            <apply id="A1.p4.2.m2.8.8.7.7.2.1.cmml" xref="A1.p4.2.m2.8.8.7.7.2.1">
             <times id="A1.p4.2.m2.8.8.7.7.2.1.2.cmml" xref="A1.p4.2.m2.8.8.7.7.2.1.2">
             </times>
             <apply id="A1.p4.2.m2.8.8.7.7.2.1.3.cmml" xref="A1.p4.2.m2.8.8.7.7.2.1.3">
              <csymbol cd="ambiguous" id="A1.p4.2.m2.8.8.7.7.2.1.3.1.cmml" xref="A1.p4.2.m2.8.8.7.7.2.1.3">
               superscript
              </csymbol>
              <ci id="A1.p4.2.m2.8.8.7.7.2.1.3.2.cmml" xref="A1.p4.2.m2.8.8.7.7.2.1.3.2">
               𝜋
              </ci>
              <times id="A1.p4.2.m2.8.8.7.7.2.1.3.3.cmml" xref="A1.p4.2.m2.8.8.7.7.2.1.3.3">
              </times>
             </apply>
             <interval closure="open" id="A1.p4.2.m2.8.8.7.7.2.1.1.2.cmml" xref="A1.p4.2.m2.8.8.7.7.2.1.1.1">
              <ci id="A1.p4.2.m2.5.5.4.4.cmml" xref="A1.p4.2.m2.5.5.4.4">
               𝑠
              </ci>
              <apply id="A1.p4.2.m2.8.8.7.7.2.1.1.1.1.cmml" xref="A1.p4.2.m2.8.8.7.7.2.1.1.1.1">
               <csymbol cd="ambiguous" id="A1.p4.2.m2.8.8.7.7.2.1.1.1.1.1.cmml" xref="A1.p4.2.m2.8.8.7.7.2.1.1.1.1">
                subscript
               </csymbol>
               <ci id="A1.p4.2.m2.8.8.7.7.2.1.1.1.1.2.cmml" xref="A1.p4.2.m2.8.8.7.7.2.1.1.1.1.2">
                𝑤
               </ci>
               <apply id="A1.p4.2.m2.3.3.2.2.1.cmml" xref="A1.p4.2.m2.3.3.2.2.1">
                <ci id="A1.p4.2.m2.3.3.2.2.1.2.cmml" xref="A1.p4.2.m2.3.3.2.2.1.2">
                 :
                </ci>
                <cn id="A1.p4.2.m2.3.3.2.2.1.3.cmml" type="integer" xref="A1.p4.2.m2.3.3.2.2.1.3">
                 1
                </cn>
                <apply id="A1.p4.2.m2.3.3.2.2.1.4.cmml" xref="A1.p4.2.m2.3.3.2.2.1.4">
                 <minus id="A1.p4.2.m2.3.3.2.2.1.4.1.cmml" xref="A1.p4.2.m2.3.3.2.2.1.4.1">
                 </minus>
                 <apply id="A1.p4.2.m2.3.3.2.2.1.4.2.1.cmml" xref="A1.p4.2.m2.3.3.2.2.1.4.2.2">
                  <abs id="A1.p4.2.m2.3.3.2.2.1.4.2.1.1.cmml" xref="A1.p4.2.m2.3.3.2.2.1.4.2.2.1">
                  </abs>
                  <ci id="A1.p4.2.m2.3.3.2.2.1.1.cmml" xref="A1.p4.2.m2.3.3.2.2.1.1">
                   𝑎
                  </ci>
                 </apply>
                 <cn id="A1.p4.2.m2.3.3.2.2.1.4.3.cmml" type="integer" xref="A1.p4.2.m2.3.3.2.2.1.4.3">
                  1
                 </cn>
                </apply>
               </apply>
              </apply>
             </interval>
            </apply>
           </apply>
          </apply>
         </apply>
         <apply id="A1.p4.2.m2.10.11.3.3.1.cmml" xref="A1.p4.2.m2.10.11.3.3.2">
          <csymbol cd="latexml" id="A1.p4.2.m2.10.11.3.3.1.1.cmml" xref="A1.p4.2.m2.10.11.3.3.2.1">
           delimited-[]
          </csymbol>
          <ci id="A1.p4.2.m2.10.10.cmml" xref="A1.p4.2.m2.10.10">
           ⋅
          </ci>
         </apply>
        </apply>
       </apply>
      </annotation-xml>
      <annotation encoding="application/x-tex" id="A1.p4.2.m2.10c">
       \mathbb{E}_{a\sim\pi^{*}(s)}[\cdot]=\mathbb{E}_{w_{1}\sim\pi^{*}(s),\dots,w_{|a|}\sim\pi^{*}(s,w_{1:|a|-1})}[\cdot]
      </annotation>
     </semantics>
    </math>
    for convenience), we have:
   </p>
   <table class="ltx_equationgroup ltx_eqn_align ltx_eqn_table" id="A7.EGx13">
    <tbody id="A1.E13">
     <tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
      <td class="ltx_eqn_cell ltx_eqn_center_padleft">
      </td>
      <td class="ltx_td ltx_align_right ltx_eqn_cell">
       <math alttext="\displaystyle\mathbb{E}_{w_{1}\sim\pi^{*}(s)}[Q(s,w_{1})]-\beta\text{KL}(w_{1}|s)=\mathbb{E}_{a\sim\pi^{*}(s)}[Q(s,a)]-\beta\text{KL}(a|s)," class="ltx_Math" display="inline" id="A1.E13.m1.6">
        <semantics id="A1.E13.m1.6a">
         <mrow id="A1.E13.m1.6.6.1" xref="A1.E13.m1.6.6.1.1.cmml">
          <mrow id="A1.E13.m1.6.6.1.1" xref="A1.E13.m1.6.6.1.1.cmml">
           <mrow id="A1.E13.m1.6.6.1.1.2" xref="A1.E13.m1.6.6.1.1.2.cmml">
            <mrow id="A1.E13.m1.6.6.1.1.1.1" xref="A1.E13.m1.6.6.1.1.1.1.cmml">
             <msub id="A1.E13.m1.6.6.1.1.1.1.3" xref="A1.E13.m1.6.6.1.1.1.1.3.cmml">
              <mi id="A1.E13.m1.6.6.1.1.1.1.3.2" xref="A1.E13.m1.6.6.1.1.1.1.3.2.cmml">
               𝔼
              </mi>
              <mrow id="A1.E13.m1.1.1.1" xref="A1.E13.m1.1.1.1.cmml">
               <msub id="A1.E13.m1.1.1.1.3" xref="A1.E13.m1.1.1.1.3.cmml">
                <mi id="A1.E13.m1.1.1.1.3.2" xref="A1.E13.m1.1.1.1.3.2.cmml">
                 w
                </mi>
                <mn id="A1.E13.m1.1.1.1.3.3" xref="A1.E13.m1.1.1.1.3.3.cmml">
                 1
                </mn>
               </msub>
               <mo id="A1.E13.m1.1.1.1.2" xref="A1.E13.m1.1.1.1.2.cmml">
                ∼
               </mo>
               <mrow id="A1.E13.m1.1.1.1.4" xref="A1.E13.m1.1.1.1.4.cmml">
                <msup id="A1.E13.m1.1.1.1.4.2" xref="A1.E13.m1.1.1.1.4.2.cmml">
                 <mi id="A1.E13.m1.1.1.1.4.2.2" xref="A1.E13.m1.1.1.1.4.2.2.cmml">
                  π
                 </mi>
                 <mo id="A1.E13.m1.1.1.1.4.2.3" xref="A1.E13.m1.1.1.1.4.2.3.cmml">
                  ∗
                 </mo>
                </msup>
                <mo id="A1.E13.m1.1.1.1.4.1" lspace="0em" rspace="0em" xref="A1.E13.m1.1.1.1.4.1.cmml">
                 ​
                </mo>
                <mrow id="A1.E13.m1.1.1.1.4.3.2" xref="A1.E13.m1.1.1.1.4.cmml">
                 <mo id="A1.E13.m1.1.1.1.4.3.2.1" stretchy="false" xref="A1.E13.m1.1.1.1.4.cmml">
                  (
                 </mo>
                 <mi id="A1.E13.m1.1.1.1.1" xref="A1.E13.m1.1.1.1.1.cmml">
                  s
                 </mi>
                 <mo id="A1.E13.m1.1.1.1.4.3.2.2" stretchy="false" xref="A1.E13.m1.1.1.1.4.cmml">
                  )
                 </mo>
                </mrow>
               </mrow>
              </mrow>
             </msub>
             <mo id="A1.E13.m1.6.6.1.1.1.1.2" lspace="0em" rspace="0em" xref="A1.E13.m1.6.6.1.1.1.1.2.cmml">
              ​
             </mo>
             <mrow id="A1.E13.m1.6.6.1.1.1.1.1.1" xref="A1.E13.m1.6.6.1.1.1.1.1.2.cmml">
              <mo id="A1.E13.m1.6.6.1.1.1.1.1.1.2" stretchy="false" xref="A1.E13.m1.6.6.1.1.1.1.1.2.1.cmml">
               [
              </mo>
              <mrow id="A1.E13.m1.6.6.1.1.1.1.1.1.1" xref="A1.E13.m1.6.6.1.1.1.1.1.1.1.cmml">
               <mi id="A1.E13.m1.6.6.1.1.1.1.1.1.1.3" xref="A1.E13.m1.6.6.1.1.1.1.1.1.1.3.cmml">
                Q
               </mi>
               <mo id="A1.E13.m1.6.6.1.1.1.1.1.1.1.2" lspace="0em" rspace="0em" xref="A1.E13.m1.6.6.1.1.1.1.1.1.1.2.cmml">
                ​
               </mo>
               <mrow id="A1.E13.m1.6.6.1.1.1.1.1.1.1.1.1" xref="A1.E13.m1.6.6.1.1.1.1.1.1.1.1.2.cmml">
                <mo id="A1.E13.m1.6.6.1.1.1.1.1.1.1.1.1.2" stretchy="false" xref="A1.E13.m1.6.6.1.1.1.1.1.1.1.1.2.cmml">
                 (
                </mo>
                <mi id="A1.E13.m1.3.3" xref="A1.E13.m1.3.3.cmml">
                 s
                </mi>
                <mo id="A1.E13.m1.6.6.1.1.1.1.1.1.1.1.1.3" xref="A1.E13.m1.6.6.1.1.1.1.1.1.1.1.2.cmml">
                 ,
                </mo>
                <msub id="A1.E13.m1.6.6.1.1.1.1.1.1.1.1.1.1" xref="A1.E13.m1.6.6.1.1.1.1.1.1.1.1.1.1.cmml">
                 <mi id="A1.E13.m1.6.6.1.1.1.1.1.1.1.1.1.1.2" xref="A1.E13.m1.6.6.1.1.1.1.1.1.1.1.1.1.2.cmml">
                  w
                 </mi>
                 <mn id="A1.E13.m1.6.6.1.1.1.1.1.1.1.1.1.1.3" xref="A1.E13.m1.6.6.1.1.1.1.1.1.1.1.1.1.3.cmml">
                  1
                 </mn>
                </msub>
                <mo id="A1.E13.m1.6.6.1.1.1.1.1.1.1.1.1.4" stretchy="false" xref="A1.E13.m1.6.6.1.1.1.1.1.1.1.1.2.cmml">
                 )
                </mo>
               </mrow>
              </mrow>
              <mo id="A1.E13.m1.6.6.1.1.1.1.1.1.3" stretchy="false" xref="A1.E13.m1.6.6.1.1.1.1.1.2.1.cmml">
               ]
              </mo>
             </mrow>
            </mrow>
            <mo id="A1.E13.m1.6.6.1.1.2.3" xref="A1.E13.m1.6.6.1.1.2.3.cmml">
             −
            </mo>
            <mrow id="A1.E13.m1.6.6.1.1.2.2" xref="A1.E13.m1.6.6.1.1.2.2.cmml">
             <mi id="A1.E13.m1.6.6.1.1.2.2.3" xref="A1.E13.m1.6.6.1.1.2.2.3.cmml">
              β
             </mi>
             <mo id="A1.E13.m1.6.6.1.1.2.2.2" lspace="0em" rspace="0em" xref="A1.E13.m1.6.6.1.1.2.2.2.cmml">
              ​
             </mo>
             <mtext id="A1.E13.m1.6.6.1.1.2.2.4" xref="A1.E13.m1.6.6.1.1.2.2.4a.cmml">
              KL
             </mtext>
             <mo id="A1.E13.m1.6.6.1.1.2.2.2a" lspace="0em" rspace="0em" xref="A1.E13.m1.6.6.1.1.2.2.2.cmml">
              ​
             </mo>
             <mrow id="A1.E13.m1.6.6.1.1.2.2.1.1" xref="A1.E13.m1.6.6.1.1.2.2.1.1.1.cmml">
              <mo id="A1.E13.m1.6.6.1.1.2.2.1.1.2" stretchy="false" xref="A1.E13.m1.6.6.1.1.2.2.1.1.1.cmml">
               (
              </mo>
              <mrow id="A1.E13.m1.6.6.1.1.2.2.1.1.1" xref="A1.E13.m1.6.6.1.1.2.2.1.1.1.cmml">
               <msub id="A1.E13.m1.6.6.1.1.2.2.1.1.1.2" xref="A1.E13.m1.6.6.1.1.2.2.1.1.1.2.cmml">
                <mi id="A1.E13.m1.6.6.1.1.2.2.1.1.1.2.2" xref="A1.E13.m1.6.6.1.1.2.2.1.1.1.2.2.cmml">
                 w
                </mi>
                <mn id="A1.E13.m1.6.6.1.1.2.2.1.1.1.2.3" xref="A1.E13.m1.6.6.1.1.2.2.1.1.1.2.3.cmml">
                 1
                </mn>
               </msub>
               <mo fence="false" id="A1.E13.m1.6.6.1.1.2.2.1.1.1.1" xref="A1.E13.m1.6.6.1.1.2.2.1.1.1.1.cmml">
                |
               </mo>
               <mi id="A1.E13.m1.6.6.1.1.2.2.1.1.1.3" xref="A1.E13.m1.6.6.1.1.2.2.1.1.1.3.cmml">
                s
               </mi>
              </mrow>
              <mo id="A1.E13.m1.6.6.1.1.2.2.1.1.3" stretchy="false" xref="A1.E13.m1.6.6.1.1.2.2.1.1.1.cmml">
               )
              </mo>
             </mrow>
            </mrow>
           </mrow>
           <mo id="A1.E13.m1.6.6.1.1.5" xref="A1.E13.m1.6.6.1.1.5.cmml">
            =
           </mo>
           <mrow id="A1.E13.m1.6.6.1.1.4" xref="A1.E13.m1.6.6.1.1.4.cmml">
            <mrow id="A1.E13.m1.6.6.1.1.3.1" xref="A1.E13.m1.6.6.1.1.3.1.cmml">
             <msub id="A1.E13.m1.6.6.1.1.3.1.3" xref="A1.E13.m1.6.6.1.1.3.1.3.cmml">
              <mi id="A1.E13.m1.6.6.1.1.3.1.3.2" xref="A1.E13.m1.6.6.1.1.3.1.3.2.cmml">
               𝔼
              </mi>
              <mrow id="A1.E13.m1.2.2.1" xref="A1.E13.m1.2.2.1.cmml">
               <mi id="A1.E13.m1.2.2.1.3" xref="A1.E13.m1.2.2.1.3.cmml">
                a
               </mi>
               <mo id="A1.E13.m1.2.2.1.2" xref="A1.E13.m1.2.2.1.2.cmml">
                ∼
               </mo>
               <mrow id="A1.E13.m1.2.2.1.4" xref="A1.E13.m1.2.2.1.4.cmml">
                <msup id="A1.E13.m1.2.2.1.4.2" xref="A1.E13.m1.2.2.1.4.2.cmml">
                 <mi id="A1.E13.m1.2.2.1.4.2.2" xref="A1.E13.m1.2.2.1.4.2.2.cmml">
                  π
                 </mi>
                 <mo id="A1.E13.m1.2.2.1.4.2.3" xref="A1.E13.m1.2.2.1.4.2.3.cmml">
                  ∗
                 </mo>
                </msup>
                <mo id="A1.E13.m1.2.2.1.4.1" lspace="0em" rspace="0em" xref="A1.E13.m1.2.2.1.4.1.cmml">
                 ​
                </mo>
                <mrow id="A1.E13.m1.2.2.1.4.3.2" xref="A1.E13.m1.2.2.1.4.cmml">
                 <mo id="A1.E13.m1.2.2.1.4.3.2.1" stretchy="false" xref="A1.E13.m1.2.2.1.4.cmml">
                  (
                 </mo>
                 <mi id="A1.E13.m1.2.2.1.1" xref="A1.E13.m1.2.2.1.1.cmml">
                  s
                 </mi>
                 <mo id="A1.E13.m1.2.2.1.4.3.2.2" stretchy="false" xref="A1.E13.m1.2.2.1.4.cmml">
                  )
                 </mo>
                </mrow>
               </mrow>
              </mrow>
             </msub>
             <mo id="A1.E13.m1.6.6.1.1.3.1.2" lspace="0em" rspace="0em" xref="A1.E13.m1.6.6.1.1.3.1.2.cmml">
              ​
             </mo>
             <mrow id="A1.E13.m1.6.6.1.1.3.1.1.1" xref="A1.E13.m1.6.6.1.1.3.1.1.2.cmml">
              <mo id="A1.E13.m1.6.6.1.1.3.1.1.1.2" stretchy="false" xref="A1.E13.m1.6.6.1.1.3.1.1.2.1.cmml">
               [
              </mo>
              <mrow id="A1.E13.m1.6.6.1.1.3.1.1.1.1" xref="A1.E13.m1.6.6.1.1.3.1.1.1.1.cmml">
               <mi id="A1.E13.m1.6.6.1.1.3.1.1.1.1.2" xref="A1.E13.m1.6.6.1.1.3.1.1.1.1.2.cmml">
                Q
               </mi>
               <mo id="A1.E13.m1.6.6.1.1.3.1.1.1.1.1" lspace="0em" rspace="0em" xref="A1.E13.m1.6.6.1.1.3.1.1.1.1.1.cmml">
                ​
               </mo>
               <mrow id="A1.E13.m1.6.6.1.1.3.1.1.1.1.3.2" xref="A1.E13.m1.6.6.1.1.3.1.1.1.1.3.1.cmml">
                <mo id="A1.E13.m1.6.6.1.1.3.1.1.1.1.3.2.1" stretchy="false" xref="A1.E13.m1.6.6.1.1.3.1.1.1.1.3.1.cmml">
                 (
                </mo>
                <mi id="A1.E13.m1.4.4" xref="A1.E13.m1.4.4.cmml">
                 s
                </mi>
                <mo id="A1.E13.m1.6.6.1.1.3.1.1.1.1.3.2.2" xref="A1.E13.m1.6.6.1.1.3.1.1.1.1.3.1.cmml">
                 ,
                </mo>
                <mi id="A1.E13.m1.5.5" xref="A1.E13.m1.5.5.cmml">
                 a
                </mi>
                <mo id="A1.E13.m1.6.6.1.1.3.1.1.1.1.3.2.3" stretchy="false" xref="A1.E13.m1.6.6.1.1.3.1.1.1.1.3.1.cmml">
                 )
                </mo>
               </mrow>
              </mrow>
              <mo id="A1.E13.m1.6.6.1.1.3.1.1.1.3" stretchy="false" xref="A1.E13.m1.6.6.1.1.3.1.1.2.1.cmml">
               ]
              </mo>
             </mrow>
            </mrow>
            <mo id="A1.E13.m1.6.6.1.1.4.3" xref="A1.E13.m1.6.6.1.1.4.3.cmml">
             −
            </mo>
            <mrow id="A1.E13.m1.6.6.1.1.4.2" xref="A1.E13.m1.6.6.1.1.4.2.cmml">
             <mi id="A1.E13.m1.6.6.1.1.4.2.3" xref="A1.E13.m1.6.6.1.1.4.2.3.cmml">
              β
             </mi>
             <mo id="A1.E13.m1.6.6.1.1.4.2.2" lspace="0em" rspace="0em" xref="A1.E13.m1.6.6.1.1.4.2.2.cmml">
              ​
             </mo>
             <mtext id="A1.E13.m1.6.6.1.1.4.2.4" xref="A1.E13.m1.6.6.1.1.4.2.4a.cmml">
              KL
             </mtext>
             <mo id="A1.E13.m1.6.6.1.1.4.2.2a" lspace="0em" rspace="0em" xref="A1.E13.m1.6.6.1.1.4.2.2.cmml">
              ​
             </mo>
             <mrow id="A1.E13.m1.6.6.1.1.4.2.1.1" xref="A1.E13.m1.6.6.1.1.4.2.1.1.1.cmml">
              <mo id="A1.E13.m1.6.6.1.1.4.2.1.1.2" stretchy="false" xref="A1.E13.m1.6.6.1.1.4.2.1.1.1.cmml">
               (
              </mo>
              <mrow id="A1.E13.m1.6.6.1.1.4.2.1.1.1" xref="A1.E13.m1.6.6.1.1.4.2.1.1.1.cmml">
               <mi id="A1.E13.m1.6.6.1.1.4.2.1.1.1.2" xref="A1.E13.m1.6.6.1.1.4.2.1.1.1.2.cmml">
                a
               </mi>
               <mo fence="false" id="A1.E13.m1.6.6.1.1.4.2.1.1.1.1" xref="A1.E13.m1.6.6.1.1.4.2.1.1.1.1.cmml">
                |
               </mo>
               <mi id="A1.E13.m1.6.6.1.1.4.2.1.1.1.3" xref="A1.E13.m1.6.6.1.1.4.2.1.1.1.3.cmml">
                s
               </mi>
              </mrow>
              <mo id="A1.E13.m1.6.6.1.1.4.2.1.1.3" stretchy="false" xref="A1.E13.m1.6.6.1.1.4.2.1.1.1.cmml">
               )
              </mo>
             </mrow>
            </mrow>
           </mrow>
          </mrow>
          <mo id="A1.E13.m1.6.6.1.2" xref="A1.E13.m1.6.6.1.1.cmml">
           ,
          </mo>
         </mrow>
         <annotation-xml encoding="MathML-Content" id="A1.E13.m1.6b">
          <apply id="A1.E13.m1.6.6.1.1.cmml" xref="A1.E13.m1.6.6.1">
           <eq id="A1.E13.m1.6.6.1.1.5.cmml" xref="A1.E13.m1.6.6.1.1.5">
           </eq>
           <apply id="A1.E13.m1.6.6.1.1.2.cmml" xref="A1.E13.m1.6.6.1.1.2">
            <minus id="A1.E13.m1.6.6.1.1.2.3.cmml" xref="A1.E13.m1.6.6.1.1.2.3">
            </minus>
            <apply id="A1.E13.m1.6.6.1.1.1.1.cmml" xref="A1.E13.m1.6.6.1.1.1.1">
             <times id="A1.E13.m1.6.6.1.1.1.1.2.cmml" xref="A1.E13.m1.6.6.1.1.1.1.2">
             </times>
             <apply id="A1.E13.m1.6.6.1.1.1.1.3.cmml" xref="A1.E13.m1.6.6.1.1.1.1.3">
              <csymbol cd="ambiguous" id="A1.E13.m1.6.6.1.1.1.1.3.1.cmml" xref="A1.E13.m1.6.6.1.1.1.1.3">
               subscript
              </csymbol>
              <ci id="A1.E13.m1.6.6.1.1.1.1.3.2.cmml" xref="A1.E13.m1.6.6.1.1.1.1.3.2">
               𝔼
              </ci>
              <apply id="A1.E13.m1.1.1.1.cmml" xref="A1.E13.m1.1.1.1">
               <csymbol cd="latexml" id="A1.E13.m1.1.1.1.2.cmml" xref="A1.E13.m1.1.1.1.2">
                similar-to
               </csymbol>
               <apply id="A1.E13.m1.1.1.1.3.cmml" xref="A1.E13.m1.1.1.1.3">
                <csymbol cd="ambiguous" id="A1.E13.m1.1.1.1.3.1.cmml" xref="A1.E13.m1.1.1.1.3">
                 subscript
                </csymbol>
                <ci id="A1.E13.m1.1.1.1.3.2.cmml" xref="A1.E13.m1.1.1.1.3.2">
                 𝑤
                </ci>
                <cn id="A1.E13.m1.1.1.1.3.3.cmml" type="integer" xref="A1.E13.m1.1.1.1.3.3">
                 1
                </cn>
               </apply>
               <apply id="A1.E13.m1.1.1.1.4.cmml" xref="A1.E13.m1.1.1.1.4">
                <times id="A1.E13.m1.1.1.1.4.1.cmml" xref="A1.E13.m1.1.1.1.4.1">
                </times>
                <apply id="A1.E13.m1.1.1.1.4.2.cmml" xref="A1.E13.m1.1.1.1.4.2">
                 <csymbol cd="ambiguous" id="A1.E13.m1.1.1.1.4.2.1.cmml" xref="A1.E13.m1.1.1.1.4.2">
                  superscript
                 </csymbol>
                 <ci id="A1.E13.m1.1.1.1.4.2.2.cmml" xref="A1.E13.m1.1.1.1.4.2.2">
                  𝜋
                 </ci>
                 <times id="A1.E13.m1.1.1.1.4.2.3.cmml" xref="A1.E13.m1.1.1.1.4.2.3">
                 </times>
                </apply>
                <ci id="A1.E13.m1.1.1.1.1.cmml" xref="A1.E13.m1.1.1.1.1">
                 𝑠
                </ci>
               </apply>
              </apply>
             </apply>
             <apply id="A1.E13.m1.6.6.1.1.1.1.1.2.cmml" xref="A1.E13.m1.6.6.1.1.1.1.1.1">
              <csymbol cd="latexml" id="A1.E13.m1.6.6.1.1.1.1.1.2.1.cmml" xref="A1.E13.m1.6.6.1.1.1.1.1.1.2">
               delimited-[]
              </csymbol>
              <apply id="A1.E13.m1.6.6.1.1.1.1.1.1.1.cmml" xref="A1.E13.m1.6.6.1.1.1.1.1.1.1">
               <times id="A1.E13.m1.6.6.1.1.1.1.1.1.1.2.cmml" xref="A1.E13.m1.6.6.1.1.1.1.1.1.1.2">
               </times>
               <ci id="A1.E13.m1.6.6.1.1.1.1.1.1.1.3.cmml" xref="A1.E13.m1.6.6.1.1.1.1.1.1.1.3">
                𝑄
               </ci>
               <interval closure="open" id="A1.E13.m1.6.6.1.1.1.1.1.1.1.1.2.cmml" xref="A1.E13.m1.6.6.1.1.1.1.1.1.1.1.1">
                <ci id="A1.E13.m1.3.3.cmml" xref="A1.E13.m1.3.3">
                 𝑠
                </ci>
                <apply id="A1.E13.m1.6.6.1.1.1.1.1.1.1.1.1.1.cmml" xref="A1.E13.m1.6.6.1.1.1.1.1.1.1.1.1.1">
                 <csymbol cd="ambiguous" id="A1.E13.m1.6.6.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="A1.E13.m1.6.6.1.1.1.1.1.1.1.1.1.1">
                  subscript
                 </csymbol>
                 <ci id="A1.E13.m1.6.6.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="A1.E13.m1.6.6.1.1.1.1.1.1.1.1.1.1.2">
                  𝑤
                 </ci>
                 <cn id="A1.E13.m1.6.6.1.1.1.1.1.1.1.1.1.1.3.cmml" type="integer" xref="A1.E13.m1.6.6.1.1.1.1.1.1.1.1.1.1.3">
                  1
                 </cn>
                </apply>
               </interval>
              </apply>
             </apply>
            </apply>
            <apply id="A1.E13.m1.6.6.1.1.2.2.cmml" xref="A1.E13.m1.6.6.1.1.2.2">
             <times id="A1.E13.m1.6.6.1.1.2.2.2.cmml" xref="A1.E13.m1.6.6.1.1.2.2.2">
             </times>
             <ci id="A1.E13.m1.6.6.1.1.2.2.3.cmml" xref="A1.E13.m1.6.6.1.1.2.2.3">
              𝛽
             </ci>
             <ci id="A1.E13.m1.6.6.1.1.2.2.4a.cmml" xref="A1.E13.m1.6.6.1.1.2.2.4">
              <mtext id="A1.E13.m1.6.6.1.1.2.2.4.cmml" xref="A1.E13.m1.6.6.1.1.2.2.4">
               KL
              </mtext>
             </ci>
             <apply id="A1.E13.m1.6.6.1.1.2.2.1.1.1.cmml" xref="A1.E13.m1.6.6.1.1.2.2.1.1">
              <csymbol cd="latexml" id="A1.E13.m1.6.6.1.1.2.2.1.1.1.1.cmml" xref="A1.E13.m1.6.6.1.1.2.2.1.1.1.1">
               conditional
              </csymbol>
              <apply id="A1.E13.m1.6.6.1.1.2.2.1.1.1.2.cmml" xref="A1.E13.m1.6.6.1.1.2.2.1.1.1.2">
               <csymbol cd="ambiguous" id="A1.E13.m1.6.6.1.1.2.2.1.1.1.2.1.cmml" xref="A1.E13.m1.6.6.1.1.2.2.1.1.1.2">
                subscript
               </csymbol>
               <ci id="A1.E13.m1.6.6.1.1.2.2.1.1.1.2.2.cmml" xref="A1.E13.m1.6.6.1.1.2.2.1.1.1.2.2">
                𝑤
               </ci>
               <cn id="A1.E13.m1.6.6.1.1.2.2.1.1.1.2.3.cmml" type="integer" xref="A1.E13.m1.6.6.1.1.2.2.1.1.1.2.3">
                1
               </cn>
              </apply>
              <ci id="A1.E13.m1.6.6.1.1.2.2.1.1.1.3.cmml" xref="A1.E13.m1.6.6.1.1.2.2.1.1.1.3">
               𝑠
              </ci>
             </apply>
            </apply>
           </apply>
           <apply id="A1.E13.m1.6.6.1.1.4.cmml" xref="A1.E13.m1.6.6.1.1.4">
            <minus id="A1.E13.m1.6.6.1.1.4.3.cmml" xref="A1.E13.m1.6.6.1.1.4.3">
            </minus>
            <apply id="A1.E13.m1.6.6.1.1.3.1.cmml" xref="A1.E13.m1.6.6.1.1.3.1">
             <times id="A1.E13.m1.6.6.1.1.3.1.2.cmml" xref="A1.E13.m1.6.6.1.1.3.1.2">
             </times>
             <apply id="A1.E13.m1.6.6.1.1.3.1.3.cmml" xref="A1.E13.m1.6.6.1.1.3.1.3">
              <csymbol cd="ambiguous" id="A1.E13.m1.6.6.1.1.3.1.3.1.cmml" xref="A1.E13.m1.6.6.1.1.3.1.3">
               subscript
              </csymbol>
              <ci id="A1.E13.m1.6.6.1.1.3.1.3.2.cmml" xref="A1.E13.m1.6.6.1.1.3.1.3.2">
               𝔼
              </ci>
              <apply id="A1.E13.m1.2.2.1.cmml" xref="A1.E13.m1.2.2.1">
               <csymbol cd="latexml" id="A1.E13.m1.2.2.1.2.cmml" xref="A1.E13.m1.2.2.1.2">
                similar-to
               </csymbol>
               <ci id="A1.E13.m1.2.2.1.3.cmml" xref="A1.E13.m1.2.2.1.3">
                𝑎
               </ci>
               <apply id="A1.E13.m1.2.2.1.4.cmml" xref="A1.E13.m1.2.2.1.4">
                <times id="A1.E13.m1.2.2.1.4.1.cmml" xref="A1.E13.m1.2.2.1.4.1">
                </times>
                <apply id="A1.E13.m1.2.2.1.4.2.cmml" xref="A1.E13.m1.2.2.1.4.2">
                 <csymbol cd="ambiguous" id="A1.E13.m1.2.2.1.4.2.1.cmml" xref="A1.E13.m1.2.2.1.4.2">
                  superscript
                 </csymbol>
                 <ci id="A1.E13.m1.2.2.1.4.2.2.cmml" xref="A1.E13.m1.2.2.1.4.2.2">
                  𝜋
                 </ci>
                 <times id="A1.E13.m1.2.2.1.4.2.3.cmml" xref="A1.E13.m1.2.2.1.4.2.3">
                 </times>
                </apply>
                <ci id="A1.E13.m1.2.2.1.1.cmml" xref="A1.E13.m1.2.2.1.1">
                 𝑠
                </ci>
               </apply>
              </apply>
             </apply>
             <apply id="A1.E13.m1.6.6.1.1.3.1.1.2.cmml" xref="A1.E13.m1.6.6.1.1.3.1.1.1">
              <csymbol cd="latexml" id="A1.E13.m1.6.6.1.1.3.1.1.2.1.cmml" xref="A1.E13.m1.6.6.1.1.3.1.1.1.2">
               delimited-[]
              </csymbol>
              <apply id="A1.E13.m1.6.6.1.1.3.1.1.1.1.cmml" xref="A1.E13.m1.6.6.1.1.3.1.1.1.1">
               <times id="A1.E13.m1.6.6.1.1.3.1.1.1.1.1.cmml" xref="A1.E13.m1.6.6.1.1.3.1.1.1.1.1">
               </times>
               <ci id="A1.E13.m1.6.6.1.1.3.1.1.1.1.2.cmml" xref="A1.E13.m1.6.6.1.1.3.1.1.1.1.2">
                𝑄
               </ci>
               <interval closure="open" id="A1.E13.m1.6.6.1.1.3.1.1.1.1.3.1.cmml" xref="A1.E13.m1.6.6.1.1.3.1.1.1.1.3.2">
                <ci id="A1.E13.m1.4.4.cmml" xref="A1.E13.m1.4.4">
                 𝑠
                </ci>
                <ci id="A1.E13.m1.5.5.cmml" xref="A1.E13.m1.5.5">
                 𝑎
                </ci>
               </interval>
              </apply>
             </apply>
            </apply>
            <apply id="A1.E13.m1.6.6.1.1.4.2.cmml" xref="A1.E13.m1.6.6.1.1.4.2">
             <times id="A1.E13.m1.6.6.1.1.4.2.2.cmml" xref="A1.E13.m1.6.6.1.1.4.2.2">
             </times>
             <ci id="A1.E13.m1.6.6.1.1.4.2.3.cmml" xref="A1.E13.m1.6.6.1.1.4.2.3">
              𝛽
             </ci>
             <ci id="A1.E13.m1.6.6.1.1.4.2.4a.cmml" xref="A1.E13.m1.6.6.1.1.4.2.4">
              <mtext id="A1.E13.m1.6.6.1.1.4.2.4.cmml" xref="A1.E13.m1.6.6.1.1.4.2.4">
               KL
              </mtext>
             </ci>
             <apply id="A1.E13.m1.6.6.1.1.4.2.1.1.1.cmml" xref="A1.E13.m1.6.6.1.1.4.2.1.1">
              <csymbol cd="latexml" id="A1.E13.m1.6.6.1.1.4.2.1.1.1.1.cmml" xref="A1.E13.m1.6.6.1.1.4.2.1.1.1.1">
               conditional
              </csymbol>
              <ci id="A1.E13.m1.6.6.1.1.4.2.1.1.1.2.cmml" xref="A1.E13.m1.6.6.1.1.4.2.1.1.1.2">
               𝑎
              </ci>
              <ci id="A1.E13.m1.6.6.1.1.4.2.1.1.1.3.cmml" xref="A1.E13.m1.6.6.1.1.4.2.1.1.1.3">
               𝑠
              </ci>
             </apply>
            </apply>
           </apply>
          </apply>
         </annotation-xml>
         <annotation encoding="application/x-tex" id="A1.E13.m1.6c">
          \displaystyle\mathbb{E}_{w_{1}\sim\pi^{*}(s)}[Q(s,w_{1})]-\beta\text{KL}(w_{1}|s)=\mathbb{E}_{a\sim\pi^{*}(s)}[Q(s,a)]-\beta\text{KL}(a|s),
         </annotation>
        </semantics>
       </math>
      </td>
      <td class="ltx_eqn_cell ltx_eqn_center_padright">
      </td>
      <td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1">
       <span class="ltx_tag ltx_tag_equation ltx_align_right">
        (13)
       </span>
      </td>
     </tr>
    </tbody>
   </table>
   <p class="ltx_p" id="A1.p4.4">
    where
    <math alttext="a=w_{1:|a|}" class="ltx_Math" display="inline" id="A1.p4.3.m1.1">
     <semantics id="A1.p4.3.m1.1a">
      <mrow id="A1.p4.3.m1.1.2" xref="A1.p4.3.m1.1.2.cmml">
       <mi id="A1.p4.3.m1.1.2.2" xref="A1.p4.3.m1.1.2.2.cmml">
        a
       </mi>
       <mo id="A1.p4.3.m1.1.2.1" xref="A1.p4.3.m1.1.2.1.cmml">
        =
       </mo>
       <msub id="A1.p4.3.m1.1.2.3" xref="A1.p4.3.m1.1.2.3.cmml">
        <mi id="A1.p4.3.m1.1.2.3.2" xref="A1.p4.3.m1.1.2.3.2.cmml">
         w
        </mi>
        <mrow id="A1.p4.3.m1.1.1.1" xref="A1.p4.3.m1.1.1.1.cmml">
         <mn id="A1.p4.3.m1.1.1.1.3" xref="A1.p4.3.m1.1.1.1.3.cmml">
          1
         </mn>
         <mo id="A1.p4.3.m1.1.1.1.2" lspace="0.278em" rspace="0.278em" xref="A1.p4.3.m1.1.1.1.2.cmml">
          :
         </mo>
         <mrow id="A1.p4.3.m1.1.1.1.4.2" xref="A1.p4.3.m1.1.1.1.4.1.cmml">
          <mo id="A1.p4.3.m1.1.1.1.4.2.1" stretchy="false" xref="A1.p4.3.m1.1.1.1.4.1.1.cmml">
           |
          </mo>
          <mi id="A1.p4.3.m1.1.1.1.1" xref="A1.p4.3.m1.1.1.1.1.cmml">
           a
          </mi>
          <mo id="A1.p4.3.m1.1.1.1.4.2.2" stretchy="false" xref="A1.p4.3.m1.1.1.1.4.1.1.cmml">
           |
          </mo>
         </mrow>
        </mrow>
       </msub>
      </mrow>
      <annotation-xml encoding="MathML-Content" id="A1.p4.3.m1.1b">
       <apply id="A1.p4.3.m1.1.2.cmml" xref="A1.p4.3.m1.1.2">
        <eq id="A1.p4.3.m1.1.2.1.cmml" xref="A1.p4.3.m1.1.2.1">
        </eq>
        <ci id="A1.p4.3.m1.1.2.2.cmml" xref="A1.p4.3.m1.1.2.2">
         𝑎
        </ci>
        <apply id="A1.p4.3.m1.1.2.3.cmml" xref="A1.p4.3.m1.1.2.3">
         <csymbol cd="ambiguous" id="A1.p4.3.m1.1.2.3.1.cmml" xref="A1.p4.3.m1.1.2.3">
          subscript
         </csymbol>
         <ci id="A1.p4.3.m1.1.2.3.2.cmml" xref="A1.p4.3.m1.1.2.3.2">
          𝑤
         </ci>
         <apply id="A1.p4.3.m1.1.1.1.cmml" xref="A1.p4.3.m1.1.1.1">
          <ci id="A1.p4.3.m1.1.1.1.2.cmml" xref="A1.p4.3.m1.1.1.1.2">
           :
          </ci>
          <cn id="A1.p4.3.m1.1.1.1.3.cmml" type="integer" xref="A1.p4.3.m1.1.1.1.3">
           1
          </cn>
          <apply id="A1.p4.3.m1.1.1.1.4.1.cmml" xref="A1.p4.3.m1.1.1.1.4.2">
           <abs id="A1.p4.3.m1.1.1.1.4.1.1.cmml" xref="A1.p4.3.m1.1.1.1.4.2.1">
           </abs>
           <ci id="A1.p4.3.m1.1.1.1.1.cmml" xref="A1.p4.3.m1.1.1.1.1">
            𝑎
           </ci>
          </apply>
         </apply>
        </apply>
       </apply>
      </annotation-xml>
      <annotation encoding="application/x-tex" id="A1.p4.3.m1.1c">
       a=w_{1:|a|}
      </annotation>
     </semantics>
    </math>
    and
    <math alttext="\text{KL}(a|s)=\sum_{j=1}^{|a|}\text{KL}(w_{j}|s,w_{1:j-1})" class="ltx_Math" display="inline" id="A1.p4.4.m2.4">
     <semantics id="A1.p4.4.m2.4a">
      <mrow id="A1.p4.4.m2.4.4" xref="A1.p4.4.m2.4.4.cmml">
       <mrow id="A1.p4.4.m2.3.3.1" xref="A1.p4.4.m2.3.3.1.cmml">
        <mtext id="A1.p4.4.m2.3.3.1.3" xref="A1.p4.4.m2.3.3.1.3a.cmml">
         KL
        </mtext>
        <mo id="A1.p4.4.m2.3.3.1.2" lspace="0em" rspace="0em" xref="A1.p4.4.m2.3.3.1.2.cmml">
         ​
        </mo>
        <mrow id="A1.p4.4.m2.3.3.1.1.1" xref="A1.p4.4.m2.3.3.1.1.1.1.cmml">
         <mo id="A1.p4.4.m2.3.3.1.1.1.2" stretchy="false" xref="A1.p4.4.m2.3.3.1.1.1.1.cmml">
          (
         </mo>
         <mrow id="A1.p4.4.m2.3.3.1.1.1.1" xref="A1.p4.4.m2.3.3.1.1.1.1.cmml">
          <mi id="A1.p4.4.m2.3.3.1.1.1.1.2" xref="A1.p4.4.m2.3.3.1.1.1.1.2.cmml">
           a
          </mi>
          <mo fence="false" id="A1.p4.4.m2.3.3.1.1.1.1.1" xref="A1.p4.4.m2.3.3.1.1.1.1.1.cmml">
           |
          </mo>
          <mi id="A1.p4.4.m2.3.3.1.1.1.1.3" xref="A1.p4.4.m2.3.3.1.1.1.1.3.cmml">
           s
          </mi>
         </mrow>
         <mo id="A1.p4.4.m2.3.3.1.1.1.3" stretchy="false" xref="A1.p4.4.m2.3.3.1.1.1.1.cmml">
          )
         </mo>
        </mrow>
       </mrow>
       <mo id="A1.p4.4.m2.4.4.3" rspace="0.111em" xref="A1.p4.4.m2.4.4.3.cmml">
        =
       </mo>
       <mrow id="A1.p4.4.m2.4.4.2" xref="A1.p4.4.m2.4.4.2.cmml">
        <msubsup id="A1.p4.4.m2.4.4.2.2" xref="A1.p4.4.m2.4.4.2.2.cmml">
         <mo id="A1.p4.4.m2.4.4.2.2.2.2" xref="A1.p4.4.m2.4.4.2.2.2.2.cmml">
          ∑
         </mo>
         <mrow id="A1.p4.4.m2.4.4.2.2.2.3" xref="A1.p4.4.m2.4.4.2.2.2.3.cmml">
          <mi id="A1.p4.4.m2.4.4.2.2.2.3.2" xref="A1.p4.4.m2.4.4.2.2.2.3.2.cmml">
           j
          </mi>
          <mo id="A1.p4.4.m2.4.4.2.2.2.3.1" xref="A1.p4.4.m2.4.4.2.2.2.3.1.cmml">
           =
          </mo>
          <mn id="A1.p4.4.m2.4.4.2.2.2.3.3" xref="A1.p4.4.m2.4.4.2.2.2.3.3.cmml">
           1
          </mn>
         </mrow>
         <mrow id="A1.p4.4.m2.1.1.1.3" xref="A1.p4.4.m2.1.1.1.2.cmml">
          <mo id="A1.p4.4.m2.1.1.1.3.1" stretchy="false" xref="A1.p4.4.m2.1.1.1.2.1.cmml">
           |
          </mo>
          <mi id="A1.p4.4.m2.1.1.1.1" xref="A1.p4.4.m2.1.1.1.1.cmml">
           a
          </mi>
          <mo id="A1.p4.4.m2.1.1.1.3.2" stretchy="false" xref="A1.p4.4.m2.1.1.1.2.1.cmml">
           |
          </mo>
         </mrow>
        </msubsup>
        <mrow id="A1.p4.4.m2.4.4.2.1" xref="A1.p4.4.m2.4.4.2.1.cmml">
         <mtext id="A1.p4.4.m2.4.4.2.1.3" xref="A1.p4.4.m2.4.4.2.1.3a.cmml">
          KL
         </mtext>
         <mo id="A1.p4.4.m2.4.4.2.1.2" lspace="0em" rspace="0em" xref="A1.p4.4.m2.4.4.2.1.2.cmml">
          ​
         </mo>
         <mrow id="A1.p4.4.m2.4.4.2.1.1.1" xref="A1.p4.4.m2.4.4.2.1.1.1.1.cmml">
          <mo id="A1.p4.4.m2.4.4.2.1.1.1.2" stretchy="false" xref="A1.p4.4.m2.4.4.2.1.1.1.1.cmml">
           (
          </mo>
          <mrow id="A1.p4.4.m2.4.4.2.1.1.1.1" xref="A1.p4.4.m2.4.4.2.1.1.1.1.cmml">
           <msub id="A1.p4.4.m2.4.4.2.1.1.1.1.3" xref="A1.p4.4.m2.4.4.2.1.1.1.1.3.cmml">
            <mi id="A1.p4.4.m2.4.4.2.1.1.1.1.3.2" xref="A1.p4.4.m2.4.4.2.1.1.1.1.3.2.cmml">
             w
            </mi>
            <mi id="A1.p4.4.m2.4.4.2.1.1.1.1.3.3" xref="A1.p4.4.m2.4.4.2.1.1.1.1.3.3.cmml">
             j
            </mi>
           </msub>
           <mo fence="false" id="A1.p4.4.m2.4.4.2.1.1.1.1.2" xref="A1.p4.4.m2.4.4.2.1.1.1.1.2.cmml">
            |
           </mo>
           <mrow id="A1.p4.4.m2.4.4.2.1.1.1.1.1.1" xref="A1.p4.4.m2.4.4.2.1.1.1.1.1.2.cmml">
            <mi id="A1.p4.4.m2.2.2" xref="A1.p4.4.m2.2.2.cmml">
             s
            </mi>
            <mo id="A1.p4.4.m2.4.4.2.1.1.1.1.1.1.2" xref="A1.p4.4.m2.4.4.2.1.1.1.1.1.2.cmml">
             ,
            </mo>
            <msub id="A1.p4.4.m2.4.4.2.1.1.1.1.1.1.1" xref="A1.p4.4.m2.4.4.2.1.1.1.1.1.1.1.cmml">
             <mi id="A1.p4.4.m2.4.4.2.1.1.1.1.1.1.1.2" xref="A1.p4.4.m2.4.4.2.1.1.1.1.1.1.1.2.cmml">
              w
             </mi>
             <mrow id="A1.p4.4.m2.4.4.2.1.1.1.1.1.1.1.3" xref="A1.p4.4.m2.4.4.2.1.1.1.1.1.1.1.3.cmml">
              <mn id="A1.p4.4.m2.4.4.2.1.1.1.1.1.1.1.3.2" xref="A1.p4.4.m2.4.4.2.1.1.1.1.1.1.1.3.2.cmml">
               1
              </mn>
              <mo id="A1.p4.4.m2.4.4.2.1.1.1.1.1.1.1.3.1" lspace="0.278em" rspace="0.278em" xref="A1.p4.4.m2.4.4.2.1.1.1.1.1.1.1.3.1.cmml">
               :
              </mo>
              <mrow id="A1.p4.4.m2.4.4.2.1.1.1.1.1.1.1.3.3" xref="A1.p4.4.m2.4.4.2.1.1.1.1.1.1.1.3.3.cmml">
               <mi id="A1.p4.4.m2.4.4.2.1.1.1.1.1.1.1.3.3.2" xref="A1.p4.4.m2.4.4.2.1.1.1.1.1.1.1.3.3.2.cmml">
                j
               </mi>
               <mo id="A1.p4.4.m2.4.4.2.1.1.1.1.1.1.1.3.3.1" xref="A1.p4.4.m2.4.4.2.1.1.1.1.1.1.1.3.3.1.cmml">
                −
               </mo>
               <mn id="A1.p4.4.m2.4.4.2.1.1.1.1.1.1.1.3.3.3" xref="A1.p4.4.m2.4.4.2.1.1.1.1.1.1.1.3.3.3.cmml">
                1
               </mn>
              </mrow>
             </mrow>
            </msub>
           </mrow>
          </mrow>
          <mo id="A1.p4.4.m2.4.4.2.1.1.1.3" stretchy="false" xref="A1.p4.4.m2.4.4.2.1.1.1.1.cmml">
           )
          </mo>
         </mrow>
        </mrow>
       </mrow>
      </mrow>
      <annotation-xml encoding="MathML-Content" id="A1.p4.4.m2.4b">
       <apply id="A1.p4.4.m2.4.4.cmml" xref="A1.p4.4.m2.4.4">
        <eq id="A1.p4.4.m2.4.4.3.cmml" xref="A1.p4.4.m2.4.4.3">
        </eq>
        <apply id="A1.p4.4.m2.3.3.1.cmml" xref="A1.p4.4.m2.3.3.1">
         <times id="A1.p4.4.m2.3.3.1.2.cmml" xref="A1.p4.4.m2.3.3.1.2">
         </times>
         <ci id="A1.p4.4.m2.3.3.1.3a.cmml" xref="A1.p4.4.m2.3.3.1.3">
          <mtext id="A1.p4.4.m2.3.3.1.3.cmml" xref="A1.p4.4.m2.3.3.1.3">
           KL
          </mtext>
         </ci>
         <apply id="A1.p4.4.m2.3.3.1.1.1.1.cmml" xref="A1.p4.4.m2.3.3.1.1.1">
          <csymbol cd="latexml" id="A1.p4.4.m2.3.3.1.1.1.1.1.cmml" xref="A1.p4.4.m2.3.3.1.1.1.1.1">
           conditional
          </csymbol>
          <ci id="A1.p4.4.m2.3.3.1.1.1.1.2.cmml" xref="A1.p4.4.m2.3.3.1.1.1.1.2">
           𝑎
          </ci>
          <ci id="A1.p4.4.m2.3.3.1.1.1.1.3.cmml" xref="A1.p4.4.m2.3.3.1.1.1.1.3">
           𝑠
          </ci>
         </apply>
        </apply>
        <apply id="A1.p4.4.m2.4.4.2.cmml" xref="A1.p4.4.m2.4.4.2">
         <apply id="A1.p4.4.m2.4.4.2.2.cmml" xref="A1.p4.4.m2.4.4.2.2">
          <csymbol cd="ambiguous" id="A1.p4.4.m2.4.4.2.2.1.cmml" xref="A1.p4.4.m2.4.4.2.2">
           superscript
          </csymbol>
          <apply id="A1.p4.4.m2.4.4.2.2.2.cmml" xref="A1.p4.4.m2.4.4.2.2">
           <csymbol cd="ambiguous" id="A1.p4.4.m2.4.4.2.2.2.1.cmml" xref="A1.p4.4.m2.4.4.2.2">
            subscript
           </csymbol>
           <sum id="A1.p4.4.m2.4.4.2.2.2.2.cmml" xref="A1.p4.4.m2.4.4.2.2.2.2">
           </sum>
           <apply id="A1.p4.4.m2.4.4.2.2.2.3.cmml" xref="A1.p4.4.m2.4.4.2.2.2.3">
            <eq id="A1.p4.4.m2.4.4.2.2.2.3.1.cmml" xref="A1.p4.4.m2.4.4.2.2.2.3.1">
            </eq>
            <ci id="A1.p4.4.m2.4.4.2.2.2.3.2.cmml" xref="A1.p4.4.m2.4.4.2.2.2.3.2">
             𝑗
            </ci>
            <cn id="A1.p4.4.m2.4.4.2.2.2.3.3.cmml" type="integer" xref="A1.p4.4.m2.4.4.2.2.2.3.3">
             1
            </cn>
           </apply>
          </apply>
          <apply id="A1.p4.4.m2.1.1.1.2.cmml" xref="A1.p4.4.m2.1.1.1.3">
           <abs id="A1.p4.4.m2.1.1.1.2.1.cmml" xref="A1.p4.4.m2.1.1.1.3.1">
           </abs>
           <ci id="A1.p4.4.m2.1.1.1.1.cmml" xref="A1.p4.4.m2.1.1.1.1">
            𝑎
           </ci>
          </apply>
         </apply>
         <apply id="A1.p4.4.m2.4.4.2.1.cmml" xref="A1.p4.4.m2.4.4.2.1">
          <times id="A1.p4.4.m2.4.4.2.1.2.cmml" xref="A1.p4.4.m2.4.4.2.1.2">
          </times>
          <ci id="A1.p4.4.m2.4.4.2.1.3a.cmml" xref="A1.p4.4.m2.4.4.2.1.3">
           <mtext id="A1.p4.4.m2.4.4.2.1.3.cmml" xref="A1.p4.4.m2.4.4.2.1.3">
            KL
           </mtext>
          </ci>
          <apply id="A1.p4.4.m2.4.4.2.1.1.1.1.cmml" xref="A1.p4.4.m2.4.4.2.1.1.1">
           <csymbol cd="latexml" id="A1.p4.4.m2.4.4.2.1.1.1.1.2.cmml" xref="A1.p4.4.m2.4.4.2.1.1.1.1.2">
            conditional
           </csymbol>
           <apply id="A1.p4.4.m2.4.4.2.1.1.1.1.3.cmml" xref="A1.p4.4.m2.4.4.2.1.1.1.1.3">
            <csymbol cd="ambiguous" id="A1.p4.4.m2.4.4.2.1.1.1.1.3.1.cmml" xref="A1.p4.4.m2.4.4.2.1.1.1.1.3">
             subscript
            </csymbol>
            <ci id="A1.p4.4.m2.4.4.2.1.1.1.1.3.2.cmml" xref="A1.p4.4.m2.4.4.2.1.1.1.1.3.2">
             𝑤
            </ci>
            <ci id="A1.p4.4.m2.4.4.2.1.1.1.1.3.3.cmml" xref="A1.p4.4.m2.4.4.2.1.1.1.1.3.3">
             𝑗
            </ci>
           </apply>
           <list id="A1.p4.4.m2.4.4.2.1.1.1.1.1.2.cmml" xref="A1.p4.4.m2.4.4.2.1.1.1.1.1.1">
            <ci id="A1.p4.4.m2.2.2.cmml" xref="A1.p4.4.m2.2.2">
             𝑠
            </ci>
            <apply id="A1.p4.4.m2.4.4.2.1.1.1.1.1.1.1.cmml" xref="A1.p4.4.m2.4.4.2.1.1.1.1.1.1.1">
             <csymbol cd="ambiguous" id="A1.p4.4.m2.4.4.2.1.1.1.1.1.1.1.1.cmml" xref="A1.p4.4.m2.4.4.2.1.1.1.1.1.1.1">
              subscript
             </csymbol>
             <ci id="A1.p4.4.m2.4.4.2.1.1.1.1.1.1.1.2.cmml" xref="A1.p4.4.m2.4.4.2.1.1.1.1.1.1.1.2">
              𝑤
             </ci>
             <apply id="A1.p4.4.m2.4.4.2.1.1.1.1.1.1.1.3.cmml" xref="A1.p4.4.m2.4.4.2.1.1.1.1.1.1.1.3">
              <ci id="A1.p4.4.m2.4.4.2.1.1.1.1.1.1.1.3.1.cmml" xref="A1.p4.4.m2.4.4.2.1.1.1.1.1.1.1.3.1">
               :
              </ci>
              <cn id="A1.p4.4.m2.4.4.2.1.1.1.1.1.1.1.3.2.cmml" type="integer" xref="A1.p4.4.m2.4.4.2.1.1.1.1.1.1.1.3.2">
               1
              </cn>
              <apply id="A1.p4.4.m2.4.4.2.1.1.1.1.1.1.1.3.3.cmml" xref="A1.p4.4.m2.4.4.2.1.1.1.1.1.1.1.3.3">
               <minus id="A1.p4.4.m2.4.4.2.1.1.1.1.1.1.1.3.3.1.cmml" xref="A1.p4.4.m2.4.4.2.1.1.1.1.1.1.1.3.3.1">
               </minus>
               <ci id="A1.p4.4.m2.4.4.2.1.1.1.1.1.1.1.3.3.2.cmml" xref="A1.p4.4.m2.4.4.2.1.1.1.1.1.1.1.3.3.2">
                𝑗
               </ci>
               <cn id="A1.p4.4.m2.4.4.2.1.1.1.1.1.1.1.3.3.3.cmml" type="integer" xref="A1.p4.4.m2.4.4.2.1.1.1.1.1.1.1.3.3.3">
                1
               </cn>
              </apply>
             </apply>
            </apply>
           </list>
          </apply>
         </apply>
        </apply>
       </apply>
      </annotation-xml>
      <annotation encoding="application/x-tex" id="A1.p4.4.m2.4c">
       \text{KL}(a|s)=\sum_{j=1}^{|a|}\text{KL}(w_{j}|s,w_{1:j-1})
      </annotation>
     </semantics>
    </math>
    .
   </p>
  </div>
  <div class="ltx_para" id="A1.p5">
   <p class="ltx_p" id="A1.p5.2">
    Then, the update across the current action
    <math alttext="a" class="ltx_Math" display="inline" id="A1.p5.1.m1.1">
     <semantics id="A1.p5.1.m1.1a">
      <mi id="A1.p5.1.m1.1.1" xref="A1.p5.1.m1.1.1.cmml">
       a
      </mi>
      <annotation-xml encoding="MathML-Content" id="A1.p5.1.m1.1b">
       <ci id="A1.p5.1.m1.1.1.cmml" xref="A1.p5.1.m1.1.1">
        𝑎
       </ci>
      </annotation-xml>
      <annotation encoding="application/x-tex" id="A1.p5.1.m1.1c">
       a
      </annotation>
     </semantics>
    </math>
    and the next action
    <math alttext="a^{\prime}" class="ltx_Math" display="inline" id="A1.p5.2.m2.1">
     <semantics id="A1.p5.2.m2.1a">
      <msup id="A1.p5.2.m2.1.1" xref="A1.p5.2.m2.1.1.cmml">
       <mi id="A1.p5.2.m2.1.1.2" xref="A1.p5.2.m2.1.1.2.cmml">
        a
       </mi>
       <mo id="A1.p5.2.m2.1.1.3" xref="A1.p5.2.m2.1.1.3.cmml">
        ′
       </mo>
      </msup>
      <annotation-xml encoding="MathML-Content" id="A1.p5.2.m2.1b">
       <apply id="A1.p5.2.m2.1.1.cmml" xref="A1.p5.2.m2.1.1">
        <csymbol cd="ambiguous" id="A1.p5.2.m2.1.1.1.cmml" xref="A1.p5.2.m2.1.1">
         superscript
        </csymbol>
        <ci id="A1.p5.2.m2.1.1.2.cmml" xref="A1.p5.2.m2.1.1.2">
         𝑎
        </ci>
        <ci id="A1.p5.2.m2.1.1.3.cmml" xref="A1.p5.2.m2.1.1.3">
         ′
        </ci>
       </apply>
      </annotation-xml>
      <annotation encoding="application/x-tex" id="A1.p5.2.m2.1c">
       a^{\prime}
      </annotation>
     </semantics>
    </math>
    with our Per-token Soft Bellman update is:
   </p>
   <table class="ltx_equationgroup ltx_eqn_align ltx_eqn_table" id="A7.EGx14">
    <tbody id="A1.Ex7">
     <tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
      <td class="ltx_eqn_cell ltx_eqn_center_padleft">
      </td>
      <td class="ltx_td ltx_align_right ltx_eqn_cell">
       <math alttext="\displaystyle\mathbb{E}_{a\sim\pi^{*}(s)}[Q(s,a)]" class="ltx_Math" display="inline" id="A1.Ex7.m1.4">
        <semantics id="A1.Ex7.m1.4a">
         <mrow id="A1.Ex7.m1.4.4" xref="A1.Ex7.m1.4.4.cmml">
          <msub id="A1.Ex7.m1.4.4.3" xref="A1.Ex7.m1.4.4.3.cmml">
           <mi id="A1.Ex7.m1.4.4.3.2" xref="A1.Ex7.m1.4.4.3.2.cmml">
            𝔼
           </mi>
           <mrow id="A1.Ex7.m1.1.1.1" xref="A1.Ex7.m1.1.1.1.cmml">
            <mi id="A1.Ex7.m1.1.1.1.3" xref="A1.Ex7.m1.1.1.1.3.cmml">
             a
            </mi>
            <mo id="A1.Ex7.m1.1.1.1.2" xref="A1.Ex7.m1.1.1.1.2.cmml">
             ∼
            </mo>
            <mrow id="A1.Ex7.m1.1.1.1.4" xref="A1.Ex7.m1.1.1.1.4.cmml">
             <msup id="A1.Ex7.m1.1.1.1.4.2" xref="A1.Ex7.m1.1.1.1.4.2.cmml">
              <mi id="A1.Ex7.m1.1.1.1.4.2.2" xref="A1.Ex7.m1.1.1.1.4.2.2.cmml">
               π
              </mi>
              <mo id="A1.Ex7.m1.1.1.1.4.2.3" xref="A1.Ex7.m1.1.1.1.4.2.3.cmml">
               ∗
              </mo>
             </msup>
             <mo id="A1.Ex7.m1.1.1.1.4.1" lspace="0em" rspace="0em" xref="A1.Ex7.m1.1.1.1.4.1.cmml">
              ​
             </mo>
             <mrow id="A1.Ex7.m1.1.1.1.4.3.2" xref="A1.Ex7.m1.1.1.1.4.cmml">
              <mo id="A1.Ex7.m1.1.1.1.4.3.2.1" stretchy="false" xref="A1.Ex7.m1.1.1.1.4.cmml">
               (
              </mo>
              <mi id="A1.Ex7.m1.1.1.1.1" xref="A1.Ex7.m1.1.1.1.1.cmml">
               s
              </mi>
              <mo id="A1.Ex7.m1.1.1.1.4.3.2.2" stretchy="false" xref="A1.Ex7.m1.1.1.1.4.cmml">
               )
              </mo>
             </mrow>
            </mrow>
           </mrow>
          </msub>
          <mo id="A1.Ex7.m1.4.4.2" lspace="0em" rspace="0em" xref="A1.Ex7.m1.4.4.2.cmml">
           ​
          </mo>
          <mrow id="A1.Ex7.m1.4.4.1.1" xref="A1.Ex7.m1.4.4.1.2.cmml">
           <mo id="A1.Ex7.m1.4.4.1.1.2" stretchy="false" xref="A1.Ex7.m1.4.4.1.2.1.cmml">
            [
           </mo>
           <mrow id="A1.Ex7.m1.4.4.1.1.1" xref="A1.Ex7.m1.4.4.1.1.1.cmml">
            <mi id="A1.Ex7.m1.4.4.1.1.1.2" xref="A1.Ex7.m1.4.4.1.1.1.2.cmml">
             Q
            </mi>
            <mo id="A1.Ex7.m1.4.4.1.1.1.1" lspace="0em" rspace="0em" xref="A1.Ex7.m1.4.4.1.1.1.1.cmml">
             ​
            </mo>
            <mrow id="A1.Ex7.m1.4.4.1.1.1.3.2" xref="A1.Ex7.m1.4.4.1.1.1.3.1.cmml">
             <mo id="A1.Ex7.m1.4.4.1.1.1.3.2.1" stretchy="false" xref="A1.Ex7.m1.4.4.1.1.1.3.1.cmml">
              (
             </mo>
             <mi id="A1.Ex7.m1.2.2" xref="A1.Ex7.m1.2.2.cmml">
              s
             </mi>
             <mo id="A1.Ex7.m1.4.4.1.1.1.3.2.2" xref="A1.Ex7.m1.4.4.1.1.1.3.1.cmml">
              ,
             </mo>
             <mi id="A1.Ex7.m1.3.3" xref="A1.Ex7.m1.3.3.cmml">
              a
             </mi>
             <mo id="A1.Ex7.m1.4.4.1.1.1.3.2.3" stretchy="false" xref="A1.Ex7.m1.4.4.1.1.1.3.1.cmml">
              )
             </mo>
            </mrow>
           </mrow>
           <mo id="A1.Ex7.m1.4.4.1.1.3" stretchy="false" xref="A1.Ex7.m1.4.4.1.2.1.cmml">
            ]
           </mo>
          </mrow>
         </mrow>
         <annotation-xml encoding="MathML-Content" id="A1.Ex7.m1.4b">
          <apply id="A1.Ex7.m1.4.4.cmml" xref="A1.Ex7.m1.4.4">
           <times id="A1.Ex7.m1.4.4.2.cmml" xref="A1.Ex7.m1.4.4.2">
           </times>
           <apply id="A1.Ex7.m1.4.4.3.cmml" xref="A1.Ex7.m1.4.4.3">
            <csymbol cd="ambiguous" id="A1.Ex7.m1.4.4.3.1.cmml" xref="A1.Ex7.m1.4.4.3">
             subscript
            </csymbol>
            <ci id="A1.Ex7.m1.4.4.3.2.cmml" xref="A1.Ex7.m1.4.4.3.2">
             𝔼
            </ci>
            <apply id="A1.Ex7.m1.1.1.1.cmml" xref="A1.Ex7.m1.1.1.1">
             <csymbol cd="latexml" id="A1.Ex7.m1.1.1.1.2.cmml" xref="A1.Ex7.m1.1.1.1.2">
              similar-to
             </csymbol>
             <ci id="A1.Ex7.m1.1.1.1.3.cmml" xref="A1.Ex7.m1.1.1.1.3">
              𝑎
             </ci>
             <apply id="A1.Ex7.m1.1.1.1.4.cmml" xref="A1.Ex7.m1.1.1.1.4">
              <times id="A1.Ex7.m1.1.1.1.4.1.cmml" xref="A1.Ex7.m1.1.1.1.4.1">
              </times>
              <apply id="A1.Ex7.m1.1.1.1.4.2.cmml" xref="A1.Ex7.m1.1.1.1.4.2">
               <csymbol cd="ambiguous" id="A1.Ex7.m1.1.1.1.4.2.1.cmml" xref="A1.Ex7.m1.1.1.1.4.2">
                superscript
               </csymbol>
               <ci id="A1.Ex7.m1.1.1.1.4.2.2.cmml" xref="A1.Ex7.m1.1.1.1.4.2.2">
                𝜋
               </ci>
               <times id="A1.Ex7.m1.1.1.1.4.2.3.cmml" xref="A1.Ex7.m1.1.1.1.4.2.3">
               </times>
              </apply>
              <ci id="A1.Ex7.m1.1.1.1.1.cmml" xref="A1.Ex7.m1.1.1.1.1">
               𝑠
              </ci>
             </apply>
            </apply>
           </apply>
           <apply id="A1.Ex7.m1.4.4.1.2.cmml" xref="A1.Ex7.m1.4.4.1.1">
            <csymbol cd="latexml" id="A1.Ex7.m1.4.4.1.2.1.cmml" xref="A1.Ex7.m1.4.4.1.1.2">
             delimited-[]
            </csymbol>
            <apply id="A1.Ex7.m1.4.4.1.1.1.cmml" xref="A1.Ex7.m1.4.4.1.1.1">
             <times id="A1.Ex7.m1.4.4.1.1.1.1.cmml" xref="A1.Ex7.m1.4.4.1.1.1.1">
             </times>
             <ci id="A1.Ex7.m1.4.4.1.1.1.2.cmml" xref="A1.Ex7.m1.4.4.1.1.1.2">
              𝑄
             </ci>
             <interval closure="open" id="A1.Ex7.m1.4.4.1.1.1.3.1.cmml" xref="A1.Ex7.m1.4.4.1.1.1.3.2">
              <ci id="A1.Ex7.m1.2.2.cmml" xref="A1.Ex7.m1.2.2">
               𝑠
              </ci>
              <ci id="A1.Ex7.m1.3.3.cmml" xref="A1.Ex7.m1.3.3">
               𝑎
              </ci>
             </interval>
            </apply>
           </apply>
          </apply>
         </annotation-xml>
         <annotation encoding="application/x-tex" id="A1.Ex7.m1.4c">
          \displaystyle\mathbb{E}_{a\sim\pi^{*}(s)}[Q(s,a)]
         </annotation>
        </semantics>
       </math>
      </td>
      <td class="ltx_td ltx_align_left ltx_eqn_cell">
       <math alttext="\displaystyle=\mathbb{E}_{a\sim\pi^{*}(s)}[r(s,a)]+\gamma(\mathbb{E}_{a\sim\pi^{*}(s),s^{\prime}\sim\mathcal{T}(s,a),w^{\prime}_{1}\sim\pi^{*}(s^{\prime})}[Q(s^{\prime},w^{\prime}_{1})]-\beta\mathbb{E}_{a\sim\pi^{*}(s),s^{\prime}\sim\mathcal{T}(s,a)}[\text{KL}(w^{\prime}_{1}|s^{\prime})])" class="ltx_Math" display="inline" id="A1.Ex7.m2.15">
        <semantics id="A1.Ex7.m2.15a">
         <mrow id="A1.Ex7.m2.15.15" xref="A1.Ex7.m2.15.15.cmml">
          <mi id="A1.Ex7.m2.15.15.4" xref="A1.Ex7.m2.15.15.4.cmml">
          </mi>
          <mo id="A1.Ex7.m2.15.15.3" xref="A1.Ex7.m2.15.15.3.cmml">
           =
          </mo>
          <mrow id="A1.Ex7.m2.15.15.2" xref="A1.Ex7.m2.15.15.2.cmml">
           <mrow id="A1.Ex7.m2.14.14.1.1" xref="A1.Ex7.m2.14.14.1.1.cmml">
            <msub id="A1.Ex7.m2.14.14.1.1.3" xref="A1.Ex7.m2.14.14.1.1.3.cmml">
             <mi id="A1.Ex7.m2.14.14.1.1.3.2" xref="A1.Ex7.m2.14.14.1.1.3.2.cmml">
              𝔼
             </mi>
             <mrow id="A1.Ex7.m2.1.1.1" xref="A1.Ex7.m2.1.1.1.cmml">
              <mi id="A1.Ex7.m2.1.1.1.3" xref="A1.Ex7.m2.1.1.1.3.cmml">
               a
              </mi>
              <mo id="A1.Ex7.m2.1.1.1.2" xref="A1.Ex7.m2.1.1.1.2.cmml">
               ∼
              </mo>
              <mrow id="A1.Ex7.m2.1.1.1.4" xref="A1.Ex7.m2.1.1.1.4.cmml">
               <msup id="A1.Ex7.m2.1.1.1.4.2" xref="A1.Ex7.m2.1.1.1.4.2.cmml">
                <mi id="A1.Ex7.m2.1.1.1.4.2.2" xref="A1.Ex7.m2.1.1.1.4.2.2.cmml">
                 π
                </mi>
                <mo id="A1.Ex7.m2.1.1.1.4.2.3" xref="A1.Ex7.m2.1.1.1.4.2.3.cmml">
                 ∗
                </mo>
               </msup>
               <mo id="A1.Ex7.m2.1.1.1.4.1" lspace="0em" rspace="0em" xref="A1.Ex7.m2.1.1.1.4.1.cmml">
                ​
               </mo>
               <mrow id="A1.Ex7.m2.1.1.1.4.3.2" xref="A1.Ex7.m2.1.1.1.4.cmml">
                <mo id="A1.Ex7.m2.1.1.1.4.3.2.1" stretchy="false" xref="A1.Ex7.m2.1.1.1.4.cmml">
                 (
                </mo>
                <mi id="A1.Ex7.m2.1.1.1.1" xref="A1.Ex7.m2.1.1.1.1.cmml">
                 s
                </mi>
                <mo id="A1.Ex7.m2.1.1.1.4.3.2.2" stretchy="false" xref="A1.Ex7.m2.1.1.1.4.cmml">
                 )
                </mo>
               </mrow>
              </mrow>
             </mrow>
            </msub>
            <mo id="A1.Ex7.m2.14.14.1.1.2" lspace="0em" rspace="0em" xref="A1.Ex7.m2.14.14.1.1.2.cmml">
             ​
            </mo>
            <mrow id="A1.Ex7.m2.14.14.1.1.1.1" xref="A1.Ex7.m2.14.14.1.1.1.2.cmml">
             <mo id="A1.Ex7.m2.14.14.1.1.1.1.2" stretchy="false" xref="A1.Ex7.m2.14.14.1.1.1.2.1.cmml">
              [
             </mo>
             <mrow id="A1.Ex7.m2.14.14.1.1.1.1.1" xref="A1.Ex7.m2.14.14.1.1.1.1.1.cmml">
              <mi id="A1.Ex7.m2.14.14.1.1.1.1.1.2" xref="A1.Ex7.m2.14.14.1.1.1.1.1.2.cmml">
               r
              </mi>
              <mo id="A1.Ex7.m2.14.14.1.1.1.1.1.1" lspace="0em" rspace="0em" xref="A1.Ex7.m2.14.14.1.1.1.1.1.1.cmml">
               ​
              </mo>
              <mrow id="A1.Ex7.m2.14.14.1.1.1.1.1.3.2" xref="A1.Ex7.m2.14.14.1.1.1.1.1.3.1.cmml">
               <mo id="A1.Ex7.m2.14.14.1.1.1.1.1.3.2.1" stretchy="false" xref="A1.Ex7.m2.14.14.1.1.1.1.1.3.1.cmml">
                (
               </mo>
               <mi id="A1.Ex7.m2.12.12" xref="A1.Ex7.m2.12.12.cmml">
                s
               </mi>
               <mo id="A1.Ex7.m2.14.14.1.1.1.1.1.3.2.2" xref="A1.Ex7.m2.14.14.1.1.1.1.1.3.1.cmml">
                ,
               </mo>
               <mi id="A1.Ex7.m2.13.13" xref="A1.Ex7.m2.13.13.cmml">
                a
               </mi>
               <mo id="A1.Ex7.m2.14.14.1.1.1.1.1.3.2.3" stretchy="false" xref="A1.Ex7.m2.14.14.1.1.1.1.1.3.1.cmml">
                )
               </mo>
              </mrow>
             </mrow>
             <mo id="A1.Ex7.m2.14.14.1.1.1.1.3" stretchy="false" xref="A1.Ex7.m2.14.14.1.1.1.2.1.cmml">
              ]
             </mo>
            </mrow>
           </mrow>
           <mo id="A1.Ex7.m2.15.15.2.3" xref="A1.Ex7.m2.15.15.2.3.cmml">
            +
           </mo>
           <mrow id="A1.Ex7.m2.15.15.2.2" xref="A1.Ex7.m2.15.15.2.2.cmml">
            <mi id="A1.Ex7.m2.15.15.2.2.3" xref="A1.Ex7.m2.15.15.2.2.3.cmml">
             γ
            </mi>
            <mo id="A1.Ex7.m2.15.15.2.2.2" lspace="0em" rspace="0em" xref="A1.Ex7.m2.15.15.2.2.2.cmml">
             ​
            </mo>
            <mrow id="A1.Ex7.m2.15.15.2.2.1.1" xref="A1.Ex7.m2.15.15.2.2.1.1.1.cmml">
             <mo id="A1.Ex7.m2.15.15.2.2.1.1.2" stretchy="false" xref="A1.Ex7.m2.15.15.2.2.1.1.1.cmml">
              (
             </mo>
             <mrow id="A1.Ex7.m2.15.15.2.2.1.1.1" xref="A1.Ex7.m2.15.15.2.2.1.1.1.cmml">
              <mrow id="A1.Ex7.m2.15.15.2.2.1.1.1.1" xref="A1.Ex7.m2.15.15.2.2.1.1.1.1.cmml">
               <msub id="A1.Ex7.m2.15.15.2.2.1.1.1.1.3" xref="A1.Ex7.m2.15.15.2.2.1.1.1.1.3.cmml">
                <mi id="A1.Ex7.m2.15.15.2.2.1.1.1.1.3.2" xref="A1.Ex7.m2.15.15.2.2.1.1.1.1.3.2.cmml">
                 𝔼
                </mi>
                <mrow id="A1.Ex7.m2.6.6.5.5" xref="A1.Ex7.m2.6.6.5.6.cmml">
                 <mrow id="A1.Ex7.m2.5.5.4.4.1" xref="A1.Ex7.m2.5.5.4.4.1.cmml">
                  <mi id="A1.Ex7.m2.5.5.4.4.1.2" xref="A1.Ex7.m2.5.5.4.4.1.2.cmml">
                   a
                  </mi>
                  <mo id="A1.Ex7.m2.5.5.4.4.1.1" xref="A1.Ex7.m2.5.5.4.4.1.1.cmml">
                   ∼
                  </mo>
                  <mrow id="A1.Ex7.m2.5.5.4.4.1.3" xref="A1.Ex7.m2.5.5.4.4.1.3.cmml">
                   <msup id="A1.Ex7.m2.5.5.4.4.1.3.2" xref="A1.Ex7.m2.5.5.4.4.1.3.2.cmml">
                    <mi id="A1.Ex7.m2.5.5.4.4.1.3.2.2" xref="A1.Ex7.m2.5.5.4.4.1.3.2.2.cmml">
                     π
                    </mi>
                    <mo id="A1.Ex7.m2.5.5.4.4.1.3.2.3" xref="A1.Ex7.m2.5.5.4.4.1.3.2.3.cmml">
                     ∗
                    </mo>
                   </msup>
                   <mo id="A1.Ex7.m2.5.5.4.4.1.3.1" lspace="0em" rspace="0em" xref="A1.Ex7.m2.5.5.4.4.1.3.1.cmml">
                    ​
                   </mo>
                   <mrow id="A1.Ex7.m2.5.5.4.4.1.3.3.2" xref="A1.Ex7.m2.5.5.4.4.1.3.cmml">
                    <mo id="A1.Ex7.m2.5.5.4.4.1.3.3.2.1" stretchy="false" xref="A1.Ex7.m2.5.5.4.4.1.3.cmml">
                     (
                    </mo>
                    <mi id="A1.Ex7.m2.2.2.1.1" xref="A1.Ex7.m2.2.2.1.1.cmml">
                     s
                    </mi>
                    <mo id="A1.Ex7.m2.5.5.4.4.1.3.3.2.2" stretchy="false" xref="A1.Ex7.m2.5.5.4.4.1.3.cmml">
                     )
                    </mo>
                   </mrow>
                  </mrow>
                 </mrow>
                 <mo id="A1.Ex7.m2.6.6.5.5.3" xref="A1.Ex7.m2.6.6.5.6a.cmml">
                  ,
                 </mo>
                 <mrow id="A1.Ex7.m2.6.6.5.5.2.2" xref="A1.Ex7.m2.6.6.5.5.2.3.cmml">
                  <mrow id="A1.Ex7.m2.6.6.5.5.2.1.1" xref="A1.Ex7.m2.6.6.5.5.2.1.1.cmml">
                   <msup id="A1.Ex7.m2.6.6.5.5.2.1.1.2" xref="A1.Ex7.m2.6.6.5.5.2.1.1.2.cmml">
                    <mi id="A1.Ex7.m2.6.6.5.5.2.1.1.2.2" xref="A1.Ex7.m2.6.6.5.5.2.1.1.2.2.cmml">
                     s
                    </mi>
                    <mo id="A1.Ex7.m2.6.6.5.5.2.1.1.2.3" xref="A1.Ex7.m2.6.6.5.5.2.1.1.2.3.cmml">
                     ′
                    </mo>
                   </msup>
                   <mo id="A1.Ex7.m2.6.6.5.5.2.1.1.1" xref="A1.Ex7.m2.6.6.5.5.2.1.1.1.cmml">
                    ∼
                   </mo>
                   <mrow id="A1.Ex7.m2.6.6.5.5.2.1.1.3" xref="A1.Ex7.m2.6.6.5.5.2.1.1.3.cmml">
                    <mi class="ltx_font_mathcaligraphic" id="A1.Ex7.m2.6.6.5.5.2.1.1.3.2" xref="A1.Ex7.m2.6.6.5.5.2.1.1.3.2.cmml">
                     𝒯
                    </mi>
                    <mo id="A1.Ex7.m2.6.6.5.5.2.1.1.3.1" lspace="0em" rspace="0em" xref="A1.Ex7.m2.6.6.5.5.2.1.1.3.1.cmml">
                     ​
                    </mo>
                    <mrow id="A1.Ex7.m2.6.6.5.5.2.1.1.3.3.2" xref="A1.Ex7.m2.6.6.5.5.2.1.1.3.3.1.cmml">
                     <mo id="A1.Ex7.m2.6.6.5.5.2.1.1.3.3.2.1" stretchy="false" xref="A1.Ex7.m2.6.6.5.5.2.1.1.3.3.1.cmml">
                      (
                     </mo>
                     <mi id="A1.Ex7.m2.3.3.2.2" xref="A1.Ex7.m2.3.3.2.2.cmml">
                      s
                     </mi>
                     <mo id="A1.Ex7.m2.6.6.5.5.2.1.1.3.3.2.2" xref="A1.Ex7.m2.6.6.5.5.2.1.1.3.3.1.cmml">
                      ,
                     </mo>
                     <mi id="A1.Ex7.m2.4.4.3.3" xref="A1.Ex7.m2.4.4.3.3.cmml">
                      a
                     </mi>
                     <mo id="A1.Ex7.m2.6.6.5.5.2.1.1.3.3.2.3" stretchy="false" xref="A1.Ex7.m2.6.6.5.5.2.1.1.3.3.1.cmml">
                      )
                     </mo>
                    </mrow>
                   </mrow>
                  </mrow>
                  <mo id="A1.Ex7.m2.6.6.5.5.2.2.3" xref="A1.Ex7.m2.6.6.5.5.2.3a.cmml">
                   ,
                  </mo>
                  <mrow id="A1.Ex7.m2.6.6.5.5.2.2.2" xref="A1.Ex7.m2.6.6.5.5.2.2.2.cmml">
                   <msubsup id="A1.Ex7.m2.6.6.5.5.2.2.2.3" xref="A1.Ex7.m2.6.6.5.5.2.2.2.3.cmml">
                    <mi id="A1.Ex7.m2.6.6.5.5.2.2.2.3.2.2" xref="A1.Ex7.m2.6.6.5.5.2.2.2.3.2.2.cmml">
                     w
                    </mi>
                    <mn id="A1.Ex7.m2.6.6.5.5.2.2.2.3.3" xref="A1.Ex7.m2.6.6.5.5.2.2.2.3.3.cmml">
                     1
                    </mn>
                    <mo id="A1.Ex7.m2.6.6.5.5.2.2.2.3.2.3" xref="A1.Ex7.m2.6.6.5.5.2.2.2.3.2.3.cmml">
                     ′
                    </mo>
                   </msubsup>
                   <mo id="A1.Ex7.m2.6.6.5.5.2.2.2.2" xref="A1.Ex7.m2.6.6.5.5.2.2.2.2.cmml">
                    ∼
                   </mo>
                   <mrow id="A1.Ex7.m2.6.6.5.5.2.2.2.1" xref="A1.Ex7.m2.6.6.5.5.2.2.2.1.cmml">
                    <msup id="A1.Ex7.m2.6.6.5.5.2.2.2.1.3" xref="A1.Ex7.m2.6.6.5.5.2.2.2.1.3.cmml">
                     <mi id="A1.Ex7.m2.6.6.5.5.2.2.2.1.3.2" xref="A1.Ex7.m2.6.6.5.5.2.2.2.1.3.2.cmml">
                      π
                     </mi>
                     <mo id="A1.Ex7.m2.6.6.5.5.2.2.2.1.3.3" xref="A1.Ex7.m2.6.6.5.5.2.2.2.1.3.3.cmml">
                      ∗
                     </mo>
                    </msup>
                    <mo id="A1.Ex7.m2.6.6.5.5.2.2.2.1.2" lspace="0em" rspace="0em" xref="A1.Ex7.m2.6.6.5.5.2.2.2.1.2.cmml">
                     ​
                    </mo>
                    <mrow id="A1.Ex7.m2.6.6.5.5.2.2.2.1.1.1" xref="A1.Ex7.m2.6.6.5.5.2.2.2.1.1.1.1.cmml">
                     <mo id="A1.Ex7.m2.6.6.5.5.2.2.2.1.1.1.2" stretchy="false" xref="A1.Ex7.m2.6.6.5.5.2.2.2.1.1.1.1.cmml">
                      (
                     </mo>
                     <msup id="A1.Ex7.m2.6.6.5.5.2.2.2.1.1.1.1" xref="A1.Ex7.m2.6.6.5.5.2.2.2.1.1.1.1.cmml">
                      <mi id="A1.Ex7.m2.6.6.5.5.2.2.2.1.1.1.1.2" xref="A1.Ex7.m2.6.6.5.5.2.2.2.1.1.1.1.2.cmml">
                       s
                      </mi>
                      <mo id="A1.Ex7.m2.6.6.5.5.2.2.2.1.1.1.1.3" xref="A1.Ex7.m2.6.6.5.5.2.2.2.1.1.1.1.3.cmml">
                       ′
                      </mo>
                     </msup>
                     <mo id="A1.Ex7.m2.6.6.5.5.2.2.2.1.1.1.3" stretchy="false" xref="A1.Ex7.m2.6.6.5.5.2.2.2.1.1.1.1.cmml">
                      )
                     </mo>
                    </mrow>
                   </mrow>
                  </mrow>
                 </mrow>
                </mrow>
               </msub>
               <mo id="A1.Ex7.m2.15.15.2.2.1.1.1.1.2" lspace="0em" rspace="0em" xref="A1.Ex7.m2.15.15.2.2.1.1.1.1.2.cmml">
                ​
               </mo>
               <mrow id="A1.Ex7.m2.15.15.2.2.1.1.1.1.1.1" xref="A1.Ex7.m2.15.15.2.2.1.1.1.1.1.2.cmml">
                <mo id="A1.Ex7.m2.15.15.2.2.1.1.1.1.1.1.2" stretchy="false" xref="A1.Ex7.m2.15.15.2.2.1.1.1.1.1.2.1.cmml">
                 [
                </mo>
                <mrow id="A1.Ex7.m2.15.15.2.2.1.1.1.1.1.1.1" xref="A1.Ex7.m2.15.15.2.2.1.1.1.1.1.1.1.cmml">
                 <mi id="A1.Ex7.m2.15.15.2.2.1.1.1.1.1.1.1.4" xref="A1.Ex7.m2.15.15.2.2.1.1.1.1.1.1.1.4.cmml">
                  Q
                 </mi>
                 <mo id="A1.Ex7.m2.15.15.2.2.1.1.1.1.1.1.1.3" lspace="0em" rspace="0em" xref="A1.Ex7.m2.15.15.2.2.1.1.1.1.1.1.1.3.cmml">
                  ​
                 </mo>
                 <mrow id="A1.Ex7.m2.15.15.2.2.1.1.1.1.1.1.1.2.2" xref="A1.Ex7.m2.15.15.2.2.1.1.1.1.1.1.1.2.3.cmml">
                  <mo id="A1.Ex7.m2.15.15.2.2.1.1.1.1.1.1.1.2.2.3" stretchy="false" xref="A1.Ex7.m2.15.15.2.2.1.1.1.1.1.1.1.2.3.cmml">
                   (
                  </mo>
                  <msup id="A1.Ex7.m2.15.15.2.2.1.1.1.1.1.1.1.1.1.1" xref="A1.Ex7.m2.15.15.2.2.1.1.1.1.1.1.1.1.1.1.cmml">
                   <mi id="A1.Ex7.m2.15.15.2.2.1.1.1.1.1.1.1.1.1.1.2" xref="A1.Ex7.m2.15.15.2.2.1.1.1.1.1.1.1.1.1.1.2.cmml">
                    s
                   </mi>
                   <mo id="A1.Ex7.m2.15.15.2.2.1.1.1.1.1.1.1.1.1.1.3" xref="A1.Ex7.m2.15.15.2.2.1.1.1.1.1.1.1.1.1.1.3.cmml">
                    ′
                   </mo>
                  </msup>
                  <mo id="A1.Ex7.m2.15.15.2.2.1.1.1.1.1.1.1.2.2.4" xref="A1.Ex7.m2.15.15.2.2.1.1.1.1.1.1.1.2.3.cmml">
                   ,
                  </mo>
                  <msubsup id="A1.Ex7.m2.15.15.2.2.1.1.1.1.1.1.1.2.2.2" xref="A1.Ex7.m2.15.15.2.2.1.1.1.1.1.1.1.2.2.2.cmml">
                   <mi id="A1.Ex7.m2.15.15.2.2.1.1.1.1.1.1.1.2.2.2.2.2" xref="A1.Ex7.m2.15.15.2.2.1.1.1.1.1.1.1.2.2.2.2.2.cmml">
                    w
                   </mi>
                   <mn id="A1.Ex7.m2.15.15.2.2.1.1.1.1.1.1.1.2.2.2.3" xref="A1.Ex7.m2.15.15.2.2.1.1.1.1.1.1.1.2.2.2.3.cmml">
                    1
                   </mn>
                   <mo id="A1.Ex7.m2.15.15.2.2.1.1.1.1.1.1.1.2.2.2.2.3" xref="A1.Ex7.m2.15.15.2.2.1.1.1.1.1.1.1.2.2.2.2.3.cmml">
                    ′
                   </mo>
                  </msubsup>
                  <mo id="A1.Ex7.m2.15.15.2.2.1.1.1.1.1.1.1.2.2.5" stretchy="false" xref="A1.Ex7.m2.15.15.2.2.1.1.1.1.1.1.1.2.3.cmml">
                   )
                  </mo>
                 </mrow>
                </mrow>
                <mo id="A1.Ex7.m2.15.15.2.2.1.1.1.1.1.1.3" stretchy="false" xref="A1.Ex7.m2.15.15.2.2.1.1.1.1.1.2.1.cmml">
                 ]
                </mo>
               </mrow>
              </mrow>
              <mo id="A1.Ex7.m2.15.15.2.2.1.1.1.3" xref="A1.Ex7.m2.15.15.2.2.1.1.1.3.cmml">
               −
              </mo>
              <mrow id="A1.Ex7.m2.15.15.2.2.1.1.1.2" xref="A1.Ex7.m2.15.15.2.2.1.1.1.2.cmml">
               <mi id="A1.Ex7.m2.15.15.2.2.1.1.1.2.3" xref="A1.Ex7.m2.15.15.2.2.1.1.1.2.3.cmml">
                β
               </mi>
               <mo id="A1.Ex7.m2.15.15.2.2.1.1.1.2.2" lspace="0em" rspace="0em" xref="A1.Ex7.m2.15.15.2.2.1.1.1.2.2.cmml">
                ​
               </mo>
               <msub id="A1.Ex7.m2.15.15.2.2.1.1.1.2.4" xref="A1.Ex7.m2.15.15.2.2.1.1.1.2.4.cmml">
                <mi id="A1.Ex7.m2.15.15.2.2.1.1.1.2.4.2" xref="A1.Ex7.m2.15.15.2.2.1.1.1.2.4.2.cmml">
                 𝔼
                </mi>
                <mrow id="A1.Ex7.m2.11.11.5.5" xref="A1.Ex7.m2.11.11.5.6.cmml">
                 <mrow id="A1.Ex7.m2.10.10.4.4.1" xref="A1.Ex7.m2.10.10.4.4.1.cmml">
                  <mi id="A1.Ex7.m2.10.10.4.4.1.2" xref="A1.Ex7.m2.10.10.4.4.1.2.cmml">
                   a
                  </mi>
                  <mo id="A1.Ex7.m2.10.10.4.4.1.1" xref="A1.Ex7.m2.10.10.4.4.1.1.cmml">
                   ∼
                  </mo>
                  <mrow id="A1.Ex7.m2.10.10.4.4.1.3" xref="A1.Ex7.m2.10.10.4.4.1.3.cmml">
                   <msup id="A1.Ex7.m2.10.10.4.4.1.3.2" xref="A1.Ex7.m2.10.10.4.4.1.3.2.cmml">
                    <mi id="A1.Ex7.m2.10.10.4.4.1.3.2.2" xref="A1.Ex7.m2.10.10.4.4.1.3.2.2.cmml">
                     π
                    </mi>
                    <mo id="A1.Ex7.m2.10.10.4.4.1.3.2.3" xref="A1.Ex7.m2.10.10.4.4.1.3.2.3.cmml">
                     ∗
                    </mo>
                   </msup>
                   <mo id="A1.Ex7.m2.10.10.4.4.1.3.1" lspace="0em" rspace="0em" xref="A1.Ex7.m2.10.10.4.4.1.3.1.cmml">
                    ​
                   </mo>
                   <mrow id="A1.Ex7.m2.10.10.4.4.1.3.3.2" xref="A1.Ex7.m2.10.10.4.4.1.3.cmml">
                    <mo id="A1.Ex7.m2.10.10.4.4.1.3.3.2.1" stretchy="false" xref="A1.Ex7.m2.10.10.4.4.1.3.cmml">
                     (
                    </mo>
                    <mi id="A1.Ex7.m2.7.7.1.1" xref="A1.Ex7.m2.7.7.1.1.cmml">
                     s
                    </mi>
                    <mo id="A1.Ex7.m2.10.10.4.4.1.3.3.2.2" stretchy="false" xref="A1.Ex7.m2.10.10.4.4.1.3.cmml">
                     )
                    </mo>
                   </mrow>
                  </mrow>
                 </mrow>
                 <mo id="A1.Ex7.m2.11.11.5.5.3" xref="A1.Ex7.m2.11.11.5.6a.cmml">
                  ,
                 </mo>
                 <mrow id="A1.Ex7.m2.11.11.5.5.2" xref="A1.Ex7.m2.11.11.5.5.2.cmml">
                  <msup id="A1.Ex7.m2.11.11.5.5.2.2" xref="A1.Ex7.m2.11.11.5.5.2.2.cmml">
                   <mi id="A1.Ex7.m2.11.11.5.5.2.2.2" xref="A1.Ex7.m2.11.11.5.5.2.2.2.cmml">
                    s
                   </mi>
                   <mo id="A1.Ex7.m2.11.11.5.5.2.2.3" xref="A1.Ex7.m2.11.11.5.5.2.2.3.cmml">
                    ′
                   </mo>
                  </msup>
                  <mo id="A1.Ex7.m2.11.11.5.5.2.1" xref="A1.Ex7.m2.11.11.5.5.2.1.cmml">
                   ∼
                  </mo>
                  <mrow id="A1.Ex7.m2.11.11.5.5.2.3" xref="A1.Ex7.m2.11.11.5.5.2.3.cmml">
                   <mi class="ltx_font_mathcaligraphic" id="A1.Ex7.m2.11.11.5.5.2.3.2" xref="A1.Ex7.m2.11.11.5.5.2.3.2.cmml">
                    𝒯
                   </mi>
                   <mo id="A1.Ex7.m2.11.11.5.5.2.3.1" lspace="0em" rspace="0em" xref="A1.Ex7.m2.11.11.5.5.2.3.1.cmml">
                    ​
                   </mo>
                   <mrow id="A1.Ex7.m2.11.11.5.5.2.3.3.2" xref="A1.Ex7.m2.11.11.5.5.2.3.3.1.cmml">
                    <mo id="A1.Ex7.m2.11.11.5.5.2.3.3.2.1" stretchy="false" xref="A1.Ex7.m2.11.11.5.5.2.3.3.1.cmml">
                     (
                    </mo>
                    <mi id="A1.Ex7.m2.8.8.2.2" xref="A1.Ex7.m2.8.8.2.2.cmml">
                     s
                    </mi>
                    <mo id="A1.Ex7.m2.11.11.5.5.2.3.3.2.2" xref="A1.Ex7.m2.11.11.5.5.2.3.3.1.cmml">
                     ,
                    </mo>
                    <mi id="A1.Ex7.m2.9.9.3.3" xref="A1.Ex7.m2.9.9.3.3.cmml">
                     a
                    </mi>
                    <mo id="A1.Ex7.m2.11.11.5.5.2.3.3.2.3" stretchy="false" xref="A1.Ex7.m2.11.11.5.5.2.3.3.1.cmml">
                     )
                    </mo>
                   </mrow>
                  </mrow>
                 </mrow>
                </mrow>
               </msub>
               <mo id="A1.Ex7.m2.15.15.2.2.1.1.1.2.2a" lspace="0em" rspace="0em" xref="A1.Ex7.m2.15.15.2.2.1.1.1.2.2.cmml">
                ​
               </mo>
               <mrow id="A1.Ex7.m2.15.15.2.2.1.1.1.2.1.1" xref="A1.Ex7.m2.15.15.2.2.1.1.1.2.1.2.cmml">
                <mo id="A1.Ex7.m2.15.15.2.2.1.1.1.2.1.1.2" stretchy="false" xref="A1.Ex7.m2.15.15.2.2.1.1.1.2.1.2.1.cmml">
                 [
                </mo>
                <mrow id="A1.Ex7.m2.15.15.2.2.1.1.1.2.1.1.1" xref="A1.Ex7.m2.15.15.2.2.1.1.1.2.1.1.1.cmml">
                 <mtext id="A1.Ex7.m2.15.15.2.2.1.1.1.2.1.1.1.3" xref="A1.Ex7.m2.15.15.2.2.1.1.1.2.1.1.1.3a.cmml">
                  KL
                 </mtext>
                 <mo id="A1.Ex7.m2.15.15.2.2.1.1.1.2.1.1.1.2" lspace="0em" rspace="0em" xref="A1.Ex7.m2.15.15.2.2.1.1.1.2.1.1.1.2.cmml">
                  ​
                 </mo>
                 <mrow id="A1.Ex7.m2.15.15.2.2.1.1.1.2.1.1.1.1.1" xref="A1.Ex7.m2.15.15.2.2.1.1.1.2.1.1.1.1.1.1.cmml">
                  <mo id="A1.Ex7.m2.15.15.2.2.1.1.1.2.1.1.1.1.1.2" stretchy="false" xref="A1.Ex7.m2.15.15.2.2.1.1.1.2.1.1.1.1.1.1.cmml">
                   (
                  </mo>
                  <mrow id="A1.Ex7.m2.15.15.2.2.1.1.1.2.1.1.1.1.1.1" xref="A1.Ex7.m2.15.15.2.2.1.1.1.2.1.1.1.1.1.1.cmml">
                   <msubsup id="A1.Ex7.m2.15.15.2.2.1.1.1.2.1.1.1.1.1.1.2" xref="A1.Ex7.m2.15.15.2.2.1.1.1.2.1.1.1.1.1.1.2.cmml">
                    <mi id="A1.Ex7.m2.15.15.2.2.1.1.1.2.1.1.1.1.1.1.2.2.2" xref="A1.Ex7.m2.15.15.2.2.1.1.1.2.1.1.1.1.1.1.2.2.2.cmml">
                     w
                    </mi>
                    <mn id="A1.Ex7.m2.15.15.2.2.1.1.1.2.1.1.1.1.1.1.2.3" xref="A1.Ex7.m2.15.15.2.2.1.1.1.2.1.1.1.1.1.1.2.3.cmml">
                     1
                    </mn>
                    <mo id="A1.Ex7.m2.15.15.2.2.1.1.1.2.1.1.1.1.1.1.2.2.3" xref="A1.Ex7.m2.15.15.2.2.1.1.1.2.1.1.1.1.1.1.2.2.3.cmml">
                     ′
                    </mo>
                   </msubsup>
                   <mo fence="false" id="A1.Ex7.m2.15.15.2.2.1.1.1.2.1.1.1.1.1.1.1" xref="A1.Ex7.m2.15.15.2.2.1.1.1.2.1.1.1.1.1.1.1.cmml">
                    |
                   </mo>
                   <msup id="A1.Ex7.m2.15.15.2.2.1.1.1.2.1.1.1.1.1.1.3" xref="A1.Ex7.m2.15.15.2.2.1.1.1.2.1.1.1.1.1.1.3.cmml">
                    <mi id="A1.Ex7.m2.15.15.2.2.1.1.1.2.1.1.1.1.1.1.3.2" xref="A1.Ex7.m2.15.15.2.2.1.1.1.2.1.1.1.1.1.1.3.2.cmml">
                     s
                    </mi>
                    <mo id="A1.Ex7.m2.15.15.2.2.1.1.1.2.1.1.1.1.1.1.3.3" xref="A1.Ex7.m2.15.15.2.2.1.1.1.2.1.1.1.1.1.1.3.3.cmml">
                     ′
                    </mo>
                   </msup>
                  </mrow>
                  <mo id="A1.Ex7.m2.15.15.2.2.1.1.1.2.1.1.1.1.1.3" stretchy="false" xref="A1.Ex7.m2.15.15.2.2.1.1.1.2.1.1.1.1.1.1.cmml">
                   )
                  </mo>
                 </mrow>
                </mrow>
                <mo id="A1.Ex7.m2.15.15.2.2.1.1.1.2.1.1.3" stretchy="false" xref="A1.Ex7.m2.15.15.2.2.1.1.1.2.1.2.1.cmml">
                 ]
                </mo>
               </mrow>
              </mrow>
             </mrow>
             <mo id="A1.Ex7.m2.15.15.2.2.1.1.3" stretchy="false" xref="A1.Ex7.m2.15.15.2.2.1.1.1.cmml">
              )
             </mo>
            </mrow>
           </mrow>
          </mrow>
         </mrow>
         <annotation-xml encoding="MathML-Content" id="A1.Ex7.m2.15b">
          <apply id="A1.Ex7.m2.15.15.cmml" xref="A1.Ex7.m2.15.15">
           <eq id="A1.Ex7.m2.15.15.3.cmml" xref="A1.Ex7.m2.15.15.3">
           </eq>
           <csymbol cd="latexml" id="A1.Ex7.m2.15.15.4.cmml" xref="A1.Ex7.m2.15.15.4">
            absent
           </csymbol>
           <apply id="A1.Ex7.m2.15.15.2.cmml" xref="A1.Ex7.m2.15.15.2">
            <plus id="A1.Ex7.m2.15.15.2.3.cmml" xref="A1.Ex7.m2.15.15.2.3">
            </plus>
            <apply id="A1.Ex7.m2.14.14.1.1.cmml" xref="A1.Ex7.m2.14.14.1.1">
             <times id="A1.Ex7.m2.14.14.1.1.2.cmml" xref="A1.Ex7.m2.14.14.1.1.2">
             </times>
             <apply id="A1.Ex7.m2.14.14.1.1.3.cmml" xref="A1.Ex7.m2.14.14.1.1.3">
              <csymbol cd="ambiguous" id="A1.Ex7.m2.14.14.1.1.3.1.cmml" xref="A1.Ex7.m2.14.14.1.1.3">
               subscript
              </csymbol>
              <ci id="A1.Ex7.m2.14.14.1.1.3.2.cmml" xref="A1.Ex7.m2.14.14.1.1.3.2">
               𝔼
              </ci>
              <apply id="A1.Ex7.m2.1.1.1.cmml" xref="A1.Ex7.m2.1.1.1">
               <csymbol cd="latexml" id="A1.Ex7.m2.1.1.1.2.cmml" xref="A1.Ex7.m2.1.1.1.2">
                similar-to
               </csymbol>
               <ci id="A1.Ex7.m2.1.1.1.3.cmml" xref="A1.Ex7.m2.1.1.1.3">
                𝑎
               </ci>
               <apply id="A1.Ex7.m2.1.1.1.4.cmml" xref="A1.Ex7.m2.1.1.1.4">
                <times id="A1.Ex7.m2.1.1.1.4.1.cmml" xref="A1.Ex7.m2.1.1.1.4.1">
                </times>
                <apply id="A1.Ex7.m2.1.1.1.4.2.cmml" xref="A1.Ex7.m2.1.1.1.4.2">
                 <csymbol cd="ambiguous" id="A1.Ex7.m2.1.1.1.4.2.1.cmml" xref="A1.Ex7.m2.1.1.1.4.2">
                  superscript
                 </csymbol>
                 <ci id="A1.Ex7.m2.1.1.1.4.2.2.cmml" xref="A1.Ex7.m2.1.1.1.4.2.2">
                  𝜋
                 </ci>
                 <times id="A1.Ex7.m2.1.1.1.4.2.3.cmml" xref="A1.Ex7.m2.1.1.1.4.2.3">
                 </times>
                </apply>
                <ci id="A1.Ex7.m2.1.1.1.1.cmml" xref="A1.Ex7.m2.1.1.1.1">
                 𝑠
                </ci>
               </apply>
              </apply>
             </apply>
             <apply id="A1.Ex7.m2.14.14.1.1.1.2.cmml" xref="A1.Ex7.m2.14.14.1.1.1.1">
              <csymbol cd="latexml" id="A1.Ex7.m2.14.14.1.1.1.2.1.cmml" xref="A1.Ex7.m2.14.14.1.1.1.1.2">
               delimited-[]
              </csymbol>
              <apply id="A1.Ex7.m2.14.14.1.1.1.1.1.cmml" xref="A1.Ex7.m2.14.14.1.1.1.1.1">
               <times id="A1.Ex7.m2.14.14.1.1.1.1.1.1.cmml" xref="A1.Ex7.m2.14.14.1.1.1.1.1.1">
               </times>
               <ci id="A1.Ex7.m2.14.14.1.1.1.1.1.2.cmml" xref="A1.Ex7.m2.14.14.1.1.1.1.1.2">
                𝑟
               </ci>
               <interval closure="open" id="A1.Ex7.m2.14.14.1.1.1.1.1.3.1.cmml" xref="A1.Ex7.m2.14.14.1.1.1.1.1.3.2">
                <ci id="A1.Ex7.m2.12.12.cmml" xref="A1.Ex7.m2.12.12">
                 𝑠
                </ci>
                <ci id="A1.Ex7.m2.13.13.cmml" xref="A1.Ex7.m2.13.13">
                 𝑎
                </ci>
               </interval>
              </apply>
             </apply>
            </apply>
            <apply id="A1.Ex7.m2.15.15.2.2.cmml" xref="A1.Ex7.m2.15.15.2.2">
             <times id="A1.Ex7.m2.15.15.2.2.2.cmml" xref="A1.Ex7.m2.15.15.2.2.2">
             </times>
             <ci id="A1.Ex7.m2.15.15.2.2.3.cmml" xref="A1.Ex7.m2.15.15.2.2.3">
              𝛾
             </ci>
             <apply id="A1.Ex7.m2.15.15.2.2.1.1.1.cmml" xref="A1.Ex7.m2.15.15.2.2.1.1">
              <minus id="A1.Ex7.m2.15.15.2.2.1.1.1.3.cmml" xref="A1.Ex7.m2.15.15.2.2.1.1.1.3">
              </minus>
              <apply id="A1.Ex7.m2.15.15.2.2.1.1.1.1.cmml" xref="A1.Ex7.m2.15.15.2.2.1.1.1.1">
               <times id="A1.Ex7.m2.15.15.2.2.1.1.1.1.2.cmml" xref="A1.Ex7.m2.15.15.2.2.1.1.1.1.2">
               </times>
               <apply id="A1.Ex7.m2.15.15.2.2.1.1.1.1.3.cmml" xref="A1.Ex7.m2.15.15.2.2.1.1.1.1.3">
                <csymbol cd="ambiguous" id="A1.Ex7.m2.15.15.2.2.1.1.1.1.3.1.cmml" xref="A1.Ex7.m2.15.15.2.2.1.1.1.1.3">
                 subscript
                </csymbol>
                <ci id="A1.Ex7.m2.15.15.2.2.1.1.1.1.3.2.cmml" xref="A1.Ex7.m2.15.15.2.2.1.1.1.1.3.2">
                 𝔼
                </ci>
                <apply id="A1.Ex7.m2.6.6.5.6.cmml" xref="A1.Ex7.m2.6.6.5.5">
                 <csymbol cd="ambiguous" id="A1.Ex7.m2.6.6.5.6a.cmml" xref="A1.Ex7.m2.6.6.5.5.3">
                  formulae-sequence
                 </csymbol>
                 <apply id="A1.Ex7.m2.5.5.4.4.1.cmml" xref="A1.Ex7.m2.5.5.4.4.1">
                  <csymbol cd="latexml" id="A1.Ex7.m2.5.5.4.4.1.1.cmml" xref="A1.Ex7.m2.5.5.4.4.1.1">
                   similar-to
                  </csymbol>
                  <ci id="A1.Ex7.m2.5.5.4.4.1.2.cmml" xref="A1.Ex7.m2.5.5.4.4.1.2">
                   𝑎
                  </ci>
                  <apply id="A1.Ex7.m2.5.5.4.4.1.3.cmml" xref="A1.Ex7.m2.5.5.4.4.1.3">
                   <times id="A1.Ex7.m2.5.5.4.4.1.3.1.cmml" xref="A1.Ex7.m2.5.5.4.4.1.3.1">
                   </times>
                   <apply id="A1.Ex7.m2.5.5.4.4.1.3.2.cmml" xref="A1.Ex7.m2.5.5.4.4.1.3.2">
                    <csymbol cd="ambiguous" id="A1.Ex7.m2.5.5.4.4.1.3.2.1.cmml" xref="A1.Ex7.m2.5.5.4.4.1.3.2">
                     superscript
                    </csymbol>
                    <ci id="A1.Ex7.m2.5.5.4.4.1.3.2.2.cmml" xref="A1.Ex7.m2.5.5.4.4.1.3.2.2">
                     𝜋
                    </ci>
                    <times id="A1.Ex7.m2.5.5.4.4.1.3.2.3.cmml" xref="A1.Ex7.m2.5.5.4.4.1.3.2.3">
                    </times>
                   </apply>
                   <ci id="A1.Ex7.m2.2.2.1.1.cmml" xref="A1.Ex7.m2.2.2.1.1">
                    𝑠
                   </ci>
                  </apply>
                 </apply>
                 <apply id="A1.Ex7.m2.6.6.5.5.2.3.cmml" xref="A1.Ex7.m2.6.6.5.5.2.2">
                  <csymbol cd="ambiguous" id="A1.Ex7.m2.6.6.5.5.2.3a.cmml" xref="A1.Ex7.m2.6.6.5.5.2.2.3">
                   formulae-sequence
                  </csymbol>
                  <apply id="A1.Ex7.m2.6.6.5.5.2.1.1.cmml" xref="A1.Ex7.m2.6.6.5.5.2.1.1">
                   <csymbol cd="latexml" id="A1.Ex7.m2.6.6.5.5.2.1.1.1.cmml" xref="A1.Ex7.m2.6.6.5.5.2.1.1.1">
                    similar-to
                   </csymbol>
                   <apply id="A1.Ex7.m2.6.6.5.5.2.1.1.2.cmml" xref="A1.Ex7.m2.6.6.5.5.2.1.1.2">
                    <csymbol cd="ambiguous" id="A1.Ex7.m2.6.6.5.5.2.1.1.2.1.cmml" xref="A1.Ex7.m2.6.6.5.5.2.1.1.2">
                     superscript
                    </csymbol>
                    <ci id="A1.Ex7.m2.6.6.5.5.2.1.1.2.2.cmml" xref="A1.Ex7.m2.6.6.5.5.2.1.1.2.2">
                     𝑠
                    </ci>
                    <ci id="A1.Ex7.m2.6.6.5.5.2.1.1.2.3.cmml" xref="A1.Ex7.m2.6.6.5.5.2.1.1.2.3">
                     ′
                    </ci>
                   </apply>
                   <apply id="A1.Ex7.m2.6.6.5.5.2.1.1.3.cmml" xref="A1.Ex7.m2.6.6.5.5.2.1.1.3">
                    <times id="A1.Ex7.m2.6.6.5.5.2.1.1.3.1.cmml" xref="A1.Ex7.m2.6.6.5.5.2.1.1.3.1">
                    </times>
                    <ci id="A1.Ex7.m2.6.6.5.5.2.1.1.3.2.cmml" xref="A1.Ex7.m2.6.6.5.5.2.1.1.3.2">
                     𝒯
                    </ci>
                    <interval closure="open" id="A1.Ex7.m2.6.6.5.5.2.1.1.3.3.1.cmml" xref="A1.Ex7.m2.6.6.5.5.2.1.1.3.3.2">
                     <ci id="A1.Ex7.m2.3.3.2.2.cmml" xref="A1.Ex7.m2.3.3.2.2">
                      𝑠
                     </ci>
                     <ci id="A1.Ex7.m2.4.4.3.3.cmml" xref="A1.Ex7.m2.4.4.3.3">
                      𝑎
                     </ci>
                    </interval>
                   </apply>
                  </apply>
                  <apply id="A1.Ex7.m2.6.6.5.5.2.2.2.cmml" xref="A1.Ex7.m2.6.6.5.5.2.2.2">
                   <csymbol cd="latexml" id="A1.Ex7.m2.6.6.5.5.2.2.2.2.cmml" xref="A1.Ex7.m2.6.6.5.5.2.2.2.2">
                    similar-to
                   </csymbol>
                   <apply id="A1.Ex7.m2.6.6.5.5.2.2.2.3.cmml" xref="A1.Ex7.m2.6.6.5.5.2.2.2.3">
                    <csymbol cd="ambiguous" id="A1.Ex7.m2.6.6.5.5.2.2.2.3.1.cmml" xref="A1.Ex7.m2.6.6.5.5.2.2.2.3">
                     subscript
                    </csymbol>
                    <apply id="A1.Ex7.m2.6.6.5.5.2.2.2.3.2.cmml" xref="A1.Ex7.m2.6.6.5.5.2.2.2.3">
                     <csymbol cd="ambiguous" id="A1.Ex7.m2.6.6.5.5.2.2.2.3.2.1.cmml" xref="A1.Ex7.m2.6.6.5.5.2.2.2.3">
                      superscript
                     </csymbol>
                     <ci id="A1.Ex7.m2.6.6.5.5.2.2.2.3.2.2.cmml" xref="A1.Ex7.m2.6.6.5.5.2.2.2.3.2.2">
                      𝑤
                     </ci>
                     <ci id="A1.Ex7.m2.6.6.5.5.2.2.2.3.2.3.cmml" xref="A1.Ex7.m2.6.6.5.5.2.2.2.3.2.3">
                      ′
                     </ci>
                    </apply>
                    <cn id="A1.Ex7.m2.6.6.5.5.2.2.2.3.3.cmml" type="integer" xref="A1.Ex7.m2.6.6.5.5.2.2.2.3.3">
                     1
                    </cn>
                   </apply>
                   <apply id="A1.Ex7.m2.6.6.5.5.2.2.2.1.cmml" xref="A1.Ex7.m2.6.6.5.5.2.2.2.1">
                    <times id="A1.Ex7.m2.6.6.5.5.2.2.2.1.2.cmml" xref="A1.Ex7.m2.6.6.5.5.2.2.2.1.2">
                    </times>
                    <apply id="A1.Ex7.m2.6.6.5.5.2.2.2.1.3.cmml" xref="A1.Ex7.m2.6.6.5.5.2.2.2.1.3">
                     <csymbol cd="ambiguous" id="A1.Ex7.m2.6.6.5.5.2.2.2.1.3.1.cmml" xref="A1.Ex7.m2.6.6.5.5.2.2.2.1.3">
                      superscript
                     </csymbol>
                     <ci id="A1.Ex7.m2.6.6.5.5.2.2.2.1.3.2.cmml" xref="A1.Ex7.m2.6.6.5.5.2.2.2.1.3.2">
                      𝜋
                     </ci>
                     <times id="A1.Ex7.m2.6.6.5.5.2.2.2.1.3.3.cmml" xref="A1.Ex7.m2.6.6.5.5.2.2.2.1.3.3">
                     </times>
                    </apply>
                    <apply id="A1.Ex7.m2.6.6.5.5.2.2.2.1.1.1.1.cmml" xref="A1.Ex7.m2.6.6.5.5.2.2.2.1.1.1">
                     <csymbol cd="ambiguous" id="A1.Ex7.m2.6.6.5.5.2.2.2.1.1.1.1.1.cmml" xref="A1.Ex7.m2.6.6.5.5.2.2.2.1.1.1">
                      superscript
                     </csymbol>
                     <ci id="A1.Ex7.m2.6.6.5.5.2.2.2.1.1.1.1.2.cmml" xref="A1.Ex7.m2.6.6.5.5.2.2.2.1.1.1.1.2">
                      𝑠
                     </ci>
                     <ci id="A1.Ex7.m2.6.6.5.5.2.2.2.1.1.1.1.3.cmml" xref="A1.Ex7.m2.6.6.5.5.2.2.2.1.1.1.1.3">
                      ′
                     </ci>
                    </apply>
                   </apply>
                  </apply>
                 </apply>
                </apply>
               </apply>
               <apply id="A1.Ex7.m2.15.15.2.2.1.1.1.1.1.2.cmml" xref="A1.Ex7.m2.15.15.2.2.1.1.1.1.1.1">
                <csymbol cd="latexml" id="A1.Ex7.m2.15.15.2.2.1.1.1.1.1.2.1.cmml" xref="A1.Ex7.m2.15.15.2.2.1.1.1.1.1.1.2">
                 delimited-[]
                </csymbol>
                <apply id="A1.Ex7.m2.15.15.2.2.1.1.1.1.1.1.1.cmml" xref="A1.Ex7.m2.15.15.2.2.1.1.1.1.1.1.1">
                 <times id="A1.Ex7.m2.15.15.2.2.1.1.1.1.1.1.1.3.cmml" xref="A1.Ex7.m2.15.15.2.2.1.1.1.1.1.1.1.3">
                 </times>
                 <ci id="A1.Ex7.m2.15.15.2.2.1.1.1.1.1.1.1.4.cmml" xref="A1.Ex7.m2.15.15.2.2.1.1.1.1.1.1.1.4">
                  𝑄
                 </ci>
                 <interval closure="open" id="A1.Ex7.m2.15.15.2.2.1.1.1.1.1.1.1.2.3.cmml" xref="A1.Ex7.m2.15.15.2.2.1.1.1.1.1.1.1.2.2">
                  <apply id="A1.Ex7.m2.15.15.2.2.1.1.1.1.1.1.1.1.1.1.cmml" xref="A1.Ex7.m2.15.15.2.2.1.1.1.1.1.1.1.1.1.1">
                   <csymbol cd="ambiguous" id="A1.Ex7.m2.15.15.2.2.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="A1.Ex7.m2.15.15.2.2.1.1.1.1.1.1.1.1.1.1">
                    superscript
                   </csymbol>
                   <ci id="A1.Ex7.m2.15.15.2.2.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="A1.Ex7.m2.15.15.2.2.1.1.1.1.1.1.1.1.1.1.2">
                    𝑠
                   </ci>
                   <ci id="A1.Ex7.m2.15.15.2.2.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="A1.Ex7.m2.15.15.2.2.1.1.1.1.1.1.1.1.1.1.3">
                    ′
                   </ci>
                  </apply>
                  <apply id="A1.Ex7.m2.15.15.2.2.1.1.1.1.1.1.1.2.2.2.cmml" xref="A1.Ex7.m2.15.15.2.2.1.1.1.1.1.1.1.2.2.2">
                   <csymbol cd="ambiguous" id="A1.Ex7.m2.15.15.2.2.1.1.1.1.1.1.1.2.2.2.1.cmml" xref="A1.Ex7.m2.15.15.2.2.1.1.1.1.1.1.1.2.2.2">
                    subscript
                   </csymbol>
                   <apply id="A1.Ex7.m2.15.15.2.2.1.1.1.1.1.1.1.2.2.2.2.cmml" xref="A1.Ex7.m2.15.15.2.2.1.1.1.1.1.1.1.2.2.2">
                    <csymbol cd="ambiguous" id="A1.Ex7.m2.15.15.2.2.1.1.1.1.1.1.1.2.2.2.2.1.cmml" xref="A1.Ex7.m2.15.15.2.2.1.1.1.1.1.1.1.2.2.2">
                     superscript
                    </csymbol>
                    <ci id="A1.Ex7.m2.15.15.2.2.1.1.1.1.1.1.1.2.2.2.2.2.cmml" xref="A1.Ex7.m2.15.15.2.2.1.1.1.1.1.1.1.2.2.2.2.2">
                     𝑤
                    </ci>
                    <ci id="A1.Ex7.m2.15.15.2.2.1.1.1.1.1.1.1.2.2.2.2.3.cmml" xref="A1.Ex7.m2.15.15.2.2.1.1.1.1.1.1.1.2.2.2.2.3">
                     ′
                    </ci>
                   </apply>
                   <cn id="A1.Ex7.m2.15.15.2.2.1.1.1.1.1.1.1.2.2.2.3.cmml" type="integer" xref="A1.Ex7.m2.15.15.2.2.1.1.1.1.1.1.1.2.2.2.3">
                    1
                   </cn>
                  </apply>
                 </interval>
                </apply>
               </apply>
              </apply>
              <apply id="A1.Ex7.m2.15.15.2.2.1.1.1.2.cmml" xref="A1.Ex7.m2.15.15.2.2.1.1.1.2">
               <times id="A1.Ex7.m2.15.15.2.2.1.1.1.2.2.cmml" xref="A1.Ex7.m2.15.15.2.2.1.1.1.2.2">
               </times>
               <ci id="A1.Ex7.m2.15.15.2.2.1.1.1.2.3.cmml" xref="A1.Ex7.m2.15.15.2.2.1.1.1.2.3">
                𝛽
               </ci>
               <apply id="A1.Ex7.m2.15.15.2.2.1.1.1.2.4.cmml" xref="A1.Ex7.m2.15.15.2.2.1.1.1.2.4">
                <csymbol cd="ambiguous" id="A1.Ex7.m2.15.15.2.2.1.1.1.2.4.1.cmml" xref="A1.Ex7.m2.15.15.2.2.1.1.1.2.4">
                 subscript
                </csymbol>
                <ci id="A1.Ex7.m2.15.15.2.2.1.1.1.2.4.2.cmml" xref="A1.Ex7.m2.15.15.2.2.1.1.1.2.4.2">
                 𝔼
                </ci>
                <apply id="A1.Ex7.m2.11.11.5.6.cmml" xref="A1.Ex7.m2.11.11.5.5">
                 <csymbol cd="ambiguous" id="A1.Ex7.m2.11.11.5.6a.cmml" xref="A1.Ex7.m2.11.11.5.5.3">
                  formulae-sequence
                 </csymbol>
                 <apply id="A1.Ex7.m2.10.10.4.4.1.cmml" xref="A1.Ex7.m2.10.10.4.4.1">
                  <csymbol cd="latexml" id="A1.Ex7.m2.10.10.4.4.1.1.cmml" xref="A1.Ex7.m2.10.10.4.4.1.1">
                   similar-to
                  </csymbol>
                  <ci id="A1.Ex7.m2.10.10.4.4.1.2.cmml" xref="A1.Ex7.m2.10.10.4.4.1.2">
                   𝑎
                  </ci>
                  <apply id="A1.Ex7.m2.10.10.4.4.1.3.cmml" xref="A1.Ex7.m2.10.10.4.4.1.3">
                   <times id="A1.Ex7.m2.10.10.4.4.1.3.1.cmml" xref="A1.Ex7.m2.10.10.4.4.1.3.1">
                   </times>
                   <apply id="A1.Ex7.m2.10.10.4.4.1.3.2.cmml" xref="A1.Ex7.m2.10.10.4.4.1.3.2">
                    <csymbol cd="ambiguous" id="A1.Ex7.m2.10.10.4.4.1.3.2.1.cmml" xref="A1.Ex7.m2.10.10.4.4.1.3.2">
                     superscript
                    </csymbol>
                    <ci id="A1.Ex7.m2.10.10.4.4.1.3.2.2.cmml" xref="A1.Ex7.m2.10.10.4.4.1.3.2.2">
                     𝜋
                    </ci>
                    <times id="A1.Ex7.m2.10.10.4.4.1.3.2.3.cmml" xref="A1.Ex7.m2.10.10.4.4.1.3.2.3">
                    </times>
                   </apply>
                   <ci id="A1.Ex7.m2.7.7.1.1.cmml" xref="A1.Ex7.m2.7.7.1.1">
                    𝑠
                   </ci>
                  </apply>
                 </apply>
                 <apply id="A1.Ex7.m2.11.11.5.5.2.cmml" xref="A1.Ex7.m2.11.11.5.5.2">
                  <csymbol cd="latexml" id="A1.Ex7.m2.11.11.5.5.2.1.cmml" xref="A1.Ex7.m2.11.11.5.5.2.1">
                   similar-to
                  </csymbol>
                  <apply id="A1.Ex7.m2.11.11.5.5.2.2.cmml" xref="A1.Ex7.m2.11.11.5.5.2.2">
                   <csymbol cd="ambiguous" id="A1.Ex7.m2.11.11.5.5.2.2.1.cmml" xref="A1.Ex7.m2.11.11.5.5.2.2">
                    superscript
                   </csymbol>
                   <ci id="A1.Ex7.m2.11.11.5.5.2.2.2.cmml" xref="A1.Ex7.m2.11.11.5.5.2.2.2">
                    𝑠
                   </ci>
                   <ci id="A1.Ex7.m2.11.11.5.5.2.2.3.cmml" xref="A1.Ex7.m2.11.11.5.5.2.2.3">
                    ′
                   </ci>
                  </apply>
                  <apply id="A1.Ex7.m2.11.11.5.5.2.3.cmml" xref="A1.Ex7.m2.11.11.5.5.2.3">
                   <times id="A1.Ex7.m2.11.11.5.5.2.3.1.cmml" xref="A1.Ex7.m2.11.11.5.5.2.3.1">
                   </times>
                   <ci id="A1.Ex7.m2.11.11.5.5.2.3.2.cmml" xref="A1.Ex7.m2.11.11.5.5.2.3.2">
                    𝒯
                   </ci>
                   <interval closure="open" id="A1.Ex7.m2.11.11.5.5.2.3.3.1.cmml" xref="A1.Ex7.m2.11.11.5.5.2.3.3.2">
                    <ci id="A1.Ex7.m2.8.8.2.2.cmml" xref="A1.Ex7.m2.8.8.2.2">
                     𝑠
                    </ci>
                    <ci id="A1.Ex7.m2.9.9.3.3.cmml" xref="A1.Ex7.m2.9.9.3.3">
                     𝑎
                    </ci>
                   </interval>
                  </apply>
                 </apply>
                </apply>
               </apply>
               <apply id="A1.Ex7.m2.15.15.2.2.1.1.1.2.1.2.cmml" xref="A1.Ex7.m2.15.15.2.2.1.1.1.2.1.1">
                <csymbol cd="latexml" id="A1.Ex7.m2.15.15.2.2.1.1.1.2.1.2.1.cmml" xref="A1.Ex7.m2.15.15.2.2.1.1.1.2.1.1.2">
                 delimited-[]
                </csymbol>
                <apply id="A1.Ex7.m2.15.15.2.2.1.1.1.2.1.1.1.cmml" xref="A1.Ex7.m2.15.15.2.2.1.1.1.2.1.1.1">
                 <times id="A1.Ex7.m2.15.15.2.2.1.1.1.2.1.1.1.2.cmml" xref="A1.Ex7.m2.15.15.2.2.1.1.1.2.1.1.1.2">
                 </times>
                 <ci id="A1.Ex7.m2.15.15.2.2.1.1.1.2.1.1.1.3a.cmml" xref="A1.Ex7.m2.15.15.2.2.1.1.1.2.1.1.1.3">
                  <mtext id="A1.Ex7.m2.15.15.2.2.1.1.1.2.1.1.1.3.cmml" xref="A1.Ex7.m2.15.15.2.2.1.1.1.2.1.1.1.3">
                   KL
                  </mtext>
                 </ci>
                 <apply id="A1.Ex7.m2.15.15.2.2.1.1.1.2.1.1.1.1.1.1.cmml" xref="A1.Ex7.m2.15.15.2.2.1.1.1.2.1.1.1.1.1">
                  <csymbol cd="latexml" id="A1.Ex7.m2.15.15.2.2.1.1.1.2.1.1.1.1.1.1.1.cmml" xref="A1.Ex7.m2.15.15.2.2.1.1.1.2.1.1.1.1.1.1.1">
                   conditional
                  </csymbol>
                  <apply id="A1.Ex7.m2.15.15.2.2.1.1.1.2.1.1.1.1.1.1.2.cmml" xref="A1.Ex7.m2.15.15.2.2.1.1.1.2.1.1.1.1.1.1.2">
                   <csymbol cd="ambiguous" id="A1.Ex7.m2.15.15.2.2.1.1.1.2.1.1.1.1.1.1.2.1.cmml" xref="A1.Ex7.m2.15.15.2.2.1.1.1.2.1.1.1.1.1.1.2">
                    subscript
                   </csymbol>
                   <apply id="A1.Ex7.m2.15.15.2.2.1.1.1.2.1.1.1.1.1.1.2.2.cmml" xref="A1.Ex7.m2.15.15.2.2.1.1.1.2.1.1.1.1.1.1.2">
                    <csymbol cd="ambiguous" id="A1.Ex7.m2.15.15.2.2.1.1.1.2.1.1.1.1.1.1.2.2.1.cmml" xref="A1.Ex7.m2.15.15.2.2.1.1.1.2.1.1.1.1.1.1.2">
                     superscript
                    </csymbol>
                    <ci id="A1.Ex7.m2.15.15.2.2.1.1.1.2.1.1.1.1.1.1.2.2.2.cmml" xref="A1.Ex7.m2.15.15.2.2.1.1.1.2.1.1.1.1.1.1.2.2.2">
                     𝑤
                    </ci>
                    <ci id="A1.Ex7.m2.15.15.2.2.1.1.1.2.1.1.1.1.1.1.2.2.3.cmml" xref="A1.Ex7.m2.15.15.2.2.1.1.1.2.1.1.1.1.1.1.2.2.3">
                     ′
                    </ci>
                   </apply>
                   <cn id="A1.Ex7.m2.15.15.2.2.1.1.1.2.1.1.1.1.1.1.2.3.cmml" type="integer" xref="A1.Ex7.m2.15.15.2.2.1.1.1.2.1.1.1.1.1.1.2.3">
                    1
                   </cn>
                  </apply>
                  <apply id="A1.Ex7.m2.15.15.2.2.1.1.1.2.1.1.1.1.1.1.3.cmml" xref="A1.Ex7.m2.15.15.2.2.1.1.1.2.1.1.1.1.1.1.3">
                   <csymbol cd="ambiguous" id="A1.Ex7.m2.15.15.2.2.1.1.1.2.1.1.1.1.1.1.3.1.cmml" xref="A1.Ex7.m2.15.15.2.2.1.1.1.2.1.1.1.1.1.1.3">
                    superscript
                   </csymbol>
                   <ci id="A1.Ex7.m2.15.15.2.2.1.1.1.2.1.1.1.1.1.1.3.2.cmml" xref="A1.Ex7.m2.15.15.2.2.1.1.1.2.1.1.1.1.1.1.3.2">
                    𝑠
                   </ci>
                   <ci id="A1.Ex7.m2.15.15.2.2.1.1.1.2.1.1.1.1.1.1.3.3.cmml" xref="A1.Ex7.m2.15.15.2.2.1.1.1.2.1.1.1.1.1.1.3.3">
                    ′
                   </ci>
                  </apply>
                 </apply>
                </apply>
               </apply>
              </apply>
             </apply>
            </apply>
           </apply>
          </apply>
         </annotation-xml>
         <annotation encoding="application/x-tex" id="A1.Ex7.m2.15c">
          \displaystyle=\mathbb{E}_{a\sim\pi^{*}(s)}[r(s,a)]+\gamma(\mathbb{E}_{a\sim\pi^{*}(s),s^{\prime}\sim\mathcal{T}(s,a),w^{\prime}_{1}\sim\pi^{*}(s^{\prime})}[Q(s^{\prime},w^{\prime}_{1})]-\beta\mathbb{E}_{a\sim\pi^{*}(s),s^{\prime}\sim\mathcal{T}(s,a)}[\text{KL}(w^{\prime}_{1}|s^{\prime})])
         </annotation>
        </semantics>
       </math>
      </td>
      <td class="ltx_eqn_cell ltx_eqn_center_padright">
      </td>
     </tr>
    </tbody>
    <tbody id="A1.E14">
     <tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
      <td class="ltx_eqn_cell ltx_eqn_center_padleft">
      </td>
      <td class="ltx_td ltx_eqn_cell">
      </td>
      <td class="ltx_td ltx_align_left ltx_eqn_cell">
       <math alttext="\displaystyle=\mathbb{E}_{a\sim\pi^{*}(s)}[r(s,a)]+\gamma\mathbb{E}_{a\sim\pi^{*}(s),s^{\prime}\sim\mathcal{T}(s,a),a^{\prime}\sim\pi^{*}(s^{\prime})}[Q(s^{\prime},a^{\prime})]-\gamma\beta\mathbb{E}_{a\sim\pi^{*}(s),s^{\prime}\sim\mathcal{T}(s,a)}[\text{KL}(a^{\prime}|s^{\prime})]." class="ltx_Math" display="inline" id="A1.E14.m1.14">
        <semantics id="A1.E14.m1.14a">
         <mrow id="A1.E14.m1.14.14.1" xref="A1.E14.m1.14.14.1.1.cmml">
          <mrow id="A1.E14.m1.14.14.1.1" xref="A1.E14.m1.14.14.1.1.cmml">
           <mi id="A1.E14.m1.14.14.1.1.5" xref="A1.E14.m1.14.14.1.1.5.cmml">
           </mi>
           <mo id="A1.E14.m1.14.14.1.1.4" xref="A1.E14.m1.14.14.1.1.4.cmml">
            =
           </mo>
           <mrow id="A1.E14.m1.14.14.1.1.3" xref="A1.E14.m1.14.14.1.1.3.cmml">
            <mrow id="A1.E14.m1.14.14.1.1.2.2" xref="A1.E14.m1.14.14.1.1.2.2.cmml">
             <mrow id="A1.E14.m1.14.14.1.1.1.1.1" xref="A1.E14.m1.14.14.1.1.1.1.1.cmml">
              <msub id="A1.E14.m1.14.14.1.1.1.1.1.3" xref="A1.E14.m1.14.14.1.1.1.1.1.3.cmml">
               <mi id="A1.E14.m1.14.14.1.1.1.1.1.3.2" xref="A1.E14.m1.14.14.1.1.1.1.1.3.2.cmml">
                𝔼
               </mi>
               <mrow id="A1.E14.m1.1.1.1" xref="A1.E14.m1.1.1.1.cmml">
                <mi id="A1.E14.m1.1.1.1.3" xref="A1.E14.m1.1.1.1.3.cmml">
                 a
                </mi>
                <mo id="A1.E14.m1.1.1.1.2" xref="A1.E14.m1.1.1.1.2.cmml">
                 ∼
                </mo>
                <mrow id="A1.E14.m1.1.1.1.4" xref="A1.E14.m1.1.1.1.4.cmml">
                 <msup id="A1.E14.m1.1.1.1.4.2" xref="A1.E14.m1.1.1.1.4.2.cmml">
                  <mi id="A1.E14.m1.1.1.1.4.2.2" xref="A1.E14.m1.1.1.1.4.2.2.cmml">
                   π
                  </mi>
                  <mo id="A1.E14.m1.1.1.1.4.2.3" xref="A1.E14.m1.1.1.1.4.2.3.cmml">
                   ∗
                  </mo>
                 </msup>
                 <mo id="A1.E14.m1.1.1.1.4.1" lspace="0em" rspace="0em" xref="A1.E14.m1.1.1.1.4.1.cmml">
                  ​
                 </mo>
                 <mrow id="A1.E14.m1.1.1.1.4.3.2" xref="A1.E14.m1.1.1.1.4.cmml">
                  <mo id="A1.E14.m1.1.1.1.4.3.2.1" stretchy="false" xref="A1.E14.m1.1.1.1.4.cmml">
                   (
                  </mo>
                  <mi id="A1.E14.m1.1.1.1.1" xref="A1.E14.m1.1.1.1.1.cmml">
                   s
                  </mi>
                  <mo id="A1.E14.m1.1.1.1.4.3.2.2" stretchy="false" xref="A1.E14.m1.1.1.1.4.cmml">
                   )
                  </mo>
                 </mrow>
                </mrow>
               </mrow>
              </msub>
              <mo id="A1.E14.m1.14.14.1.1.1.1.1.2" lspace="0em" rspace="0em" xref="A1.E14.m1.14.14.1.1.1.1.1.2.cmml">
               ​
              </mo>
              <mrow id="A1.E14.m1.14.14.1.1.1.1.1.1.1" xref="A1.E14.m1.14.14.1.1.1.1.1.1.2.cmml">
               <mo id="A1.E14.m1.14.14.1.1.1.1.1.1.1.2" stretchy="false" xref="A1.E14.m1.14.14.1.1.1.1.1.1.2.1.cmml">
                [
               </mo>
               <mrow id="A1.E14.m1.14.14.1.1.1.1.1.1.1.1" xref="A1.E14.m1.14.14.1.1.1.1.1.1.1.1.cmml">
                <mi id="A1.E14.m1.14.14.1.1.1.1.1.1.1.1.2" xref="A1.E14.m1.14.14.1.1.1.1.1.1.1.1.2.cmml">
                 r
                </mi>
                <mo id="A1.E14.m1.14.14.1.1.1.1.1.1.1.1.1" lspace="0em" rspace="0em" xref="A1.E14.m1.14.14.1.1.1.1.1.1.1.1.1.cmml">
                 ​
                </mo>
                <mrow id="A1.E14.m1.14.14.1.1.1.1.1.1.1.1.3.2" xref="A1.E14.m1.14.14.1.1.1.1.1.1.1.1.3.1.cmml">
                 <mo id="A1.E14.m1.14.14.1.1.1.1.1.1.1.1.3.2.1" stretchy="false" xref="A1.E14.m1.14.14.1.1.1.1.1.1.1.1.3.1.cmml">
                  (
                 </mo>
                 <mi id="A1.E14.m1.12.12" xref="A1.E14.m1.12.12.cmml">
                  s
                 </mi>
                 <mo id="A1.E14.m1.14.14.1.1.1.1.1.1.1.1.3.2.2" xref="A1.E14.m1.14.14.1.1.1.1.1.1.1.1.3.1.cmml">
                  ,
                 </mo>
                 <mi id="A1.E14.m1.13.13" xref="A1.E14.m1.13.13.cmml">
                  a
                 </mi>
                 <mo id="A1.E14.m1.14.14.1.1.1.1.1.1.1.1.3.2.3" stretchy="false" xref="A1.E14.m1.14.14.1.1.1.1.1.1.1.1.3.1.cmml">
                  )
                 </mo>
                </mrow>
               </mrow>
               <mo id="A1.E14.m1.14.14.1.1.1.1.1.1.1.3" stretchy="false" xref="A1.E14.m1.14.14.1.1.1.1.1.1.2.1.cmml">
                ]
               </mo>
              </mrow>
             </mrow>
             <mo id="A1.E14.m1.14.14.1.1.2.2.3" xref="A1.E14.m1.14.14.1.1.2.2.3.cmml">
              +
             </mo>
             <mrow id="A1.E14.m1.14.14.1.1.2.2.2" xref="A1.E14.m1.14.14.1.1.2.2.2.cmml">
              <mi id="A1.E14.m1.14.14.1.1.2.2.2.3" xref="A1.E14.m1.14.14.1.1.2.2.2.3.cmml">
               γ
              </mi>
              <mo id="A1.E14.m1.14.14.1.1.2.2.2.2" lspace="0em" rspace="0em" xref="A1.E14.m1.14.14.1.1.2.2.2.2.cmml">
               ​
              </mo>
              <msub id="A1.E14.m1.14.14.1.1.2.2.2.4" xref="A1.E14.m1.14.14.1.1.2.2.2.4.cmml">
               <mi id="A1.E14.m1.14.14.1.1.2.2.2.4.2" xref="A1.E14.m1.14.14.1.1.2.2.2.4.2.cmml">
                𝔼
               </mi>
               <mrow id="A1.E14.m1.6.6.5.5" xref="A1.E14.m1.6.6.5.6.cmml">
                <mrow id="A1.E14.m1.5.5.4.4.1" xref="A1.E14.m1.5.5.4.4.1.cmml">
                 <mi id="A1.E14.m1.5.5.4.4.1.2" xref="A1.E14.m1.5.5.4.4.1.2.cmml">
                  a
                 </mi>
                 <mo id="A1.E14.m1.5.5.4.4.1.1" xref="A1.E14.m1.5.5.4.4.1.1.cmml">
                  ∼
                 </mo>
                 <mrow id="A1.E14.m1.5.5.4.4.1.3" xref="A1.E14.m1.5.5.4.4.1.3.cmml">
                  <msup id="A1.E14.m1.5.5.4.4.1.3.2" xref="A1.E14.m1.5.5.4.4.1.3.2.cmml">
                   <mi id="A1.E14.m1.5.5.4.4.1.3.2.2" xref="A1.E14.m1.5.5.4.4.1.3.2.2.cmml">
                    π
                   </mi>
                   <mo id="A1.E14.m1.5.5.4.4.1.3.2.3" xref="A1.E14.m1.5.5.4.4.1.3.2.3.cmml">
                    ∗
                   </mo>
                  </msup>
                  <mo id="A1.E14.m1.5.5.4.4.1.3.1" lspace="0em" rspace="0em" xref="A1.E14.m1.5.5.4.4.1.3.1.cmml">
                   ​
                  </mo>
                  <mrow id="A1.E14.m1.5.5.4.4.1.3.3.2" xref="A1.E14.m1.5.5.4.4.1.3.cmml">
                   <mo id="A1.E14.m1.5.5.4.4.1.3.3.2.1" stretchy="false" xref="A1.E14.m1.5.5.4.4.1.3.cmml">
                    (
                   </mo>
                   <mi id="A1.E14.m1.2.2.1.1" xref="A1.E14.m1.2.2.1.1.cmml">
                    s
                   </mi>
                   <mo id="A1.E14.m1.5.5.4.4.1.3.3.2.2" stretchy="false" xref="A1.E14.m1.5.5.4.4.1.3.cmml">
                    )
                   </mo>
                  </mrow>
                 </mrow>
                </mrow>
                <mo id="A1.E14.m1.6.6.5.5.3" xref="A1.E14.m1.6.6.5.6a.cmml">
                 ,
                </mo>
                <mrow id="A1.E14.m1.6.6.5.5.2.2" xref="A1.E14.m1.6.6.5.5.2.3.cmml">
                 <mrow id="A1.E14.m1.6.6.5.5.2.1.1" xref="A1.E14.m1.6.6.5.5.2.1.1.cmml">
                  <msup id="A1.E14.m1.6.6.5.5.2.1.1.2" xref="A1.E14.m1.6.6.5.5.2.1.1.2.cmml">
                   <mi id="A1.E14.m1.6.6.5.5.2.1.1.2.2" xref="A1.E14.m1.6.6.5.5.2.1.1.2.2.cmml">
                    s
                   </mi>
                   <mo id="A1.E14.m1.6.6.5.5.2.1.1.2.3" xref="A1.E14.m1.6.6.5.5.2.1.1.2.3.cmml">
                    ′
                   </mo>
                  </msup>
                  <mo id="A1.E14.m1.6.6.5.5.2.1.1.1" xref="A1.E14.m1.6.6.5.5.2.1.1.1.cmml">
                   ∼
                  </mo>
                  <mrow id="A1.E14.m1.6.6.5.5.2.1.1.3" xref="A1.E14.m1.6.6.5.5.2.1.1.3.cmml">
                   <mi class="ltx_font_mathcaligraphic" id="A1.E14.m1.6.6.5.5.2.1.1.3.2" xref="A1.E14.m1.6.6.5.5.2.1.1.3.2.cmml">
                    𝒯
                   </mi>
                   <mo id="A1.E14.m1.6.6.5.5.2.1.1.3.1" lspace="0em" rspace="0em" xref="A1.E14.m1.6.6.5.5.2.1.1.3.1.cmml">
                    ​
                   </mo>
                   <mrow id="A1.E14.m1.6.6.5.5.2.1.1.3.3.2" xref="A1.E14.m1.6.6.5.5.2.1.1.3.3.1.cmml">
                    <mo id="A1.E14.m1.6.6.5.5.2.1.1.3.3.2.1" stretchy="false" xref="A1.E14.m1.6.6.5.5.2.1.1.3.3.1.cmml">
                     (
                    </mo>
                    <mi id="A1.E14.m1.3.3.2.2" xref="A1.E14.m1.3.3.2.2.cmml">
                     s
                    </mi>
                    <mo id="A1.E14.m1.6.6.5.5.2.1.1.3.3.2.2" xref="A1.E14.m1.6.6.5.5.2.1.1.3.3.1.cmml">
                     ,
                    </mo>
                    <mi id="A1.E14.m1.4.4.3.3" xref="A1.E14.m1.4.4.3.3.cmml">
                     a
                    </mi>
                    <mo id="A1.E14.m1.6.6.5.5.2.1.1.3.3.2.3" stretchy="false" xref="A1.E14.m1.6.6.5.5.2.1.1.3.3.1.cmml">
                     )
                    </mo>
                   </mrow>
                  </mrow>
                 </mrow>
                 <mo id="A1.E14.m1.6.6.5.5.2.2.3" xref="A1.E14.m1.6.6.5.5.2.3a.cmml">
                  ,
                 </mo>
                 <mrow id="A1.E14.m1.6.6.5.5.2.2.2" xref="A1.E14.m1.6.6.5.5.2.2.2.cmml">
                  <msup id="A1.E14.m1.6.6.5.5.2.2.2.3" xref="A1.E14.m1.6.6.5.5.2.2.2.3.cmml">
                   <mi id="A1.E14.m1.6.6.5.5.2.2.2.3.2" xref="A1.E14.m1.6.6.5.5.2.2.2.3.2.cmml">
                    a
                   </mi>
                   <mo id="A1.E14.m1.6.6.5.5.2.2.2.3.3" xref="A1.E14.m1.6.6.5.5.2.2.2.3.3.cmml">
                    ′
                   </mo>
                  </msup>
                  <mo id="A1.E14.m1.6.6.5.5.2.2.2.2" xref="A1.E14.m1.6.6.5.5.2.2.2.2.cmml">
                   ∼
                  </mo>
                  <mrow id="A1.E14.m1.6.6.5.5.2.2.2.1" xref="A1.E14.m1.6.6.5.5.2.2.2.1.cmml">
                   <msup id="A1.E14.m1.6.6.5.5.2.2.2.1.3" xref="A1.E14.m1.6.6.5.5.2.2.2.1.3.cmml">
                    <mi id="A1.E14.m1.6.6.5.5.2.2.2.1.3.2" xref="A1.E14.m1.6.6.5.5.2.2.2.1.3.2.cmml">
                     π
                    </mi>
                    <mo id="A1.E14.m1.6.6.5.5.2.2.2.1.3.3" xref="A1.E14.m1.6.6.5.5.2.2.2.1.3.3.cmml">
                     ∗
                    </mo>
                   </msup>
                   <mo id="A1.E14.m1.6.6.5.5.2.2.2.1.2" lspace="0em" rspace="0em" xref="A1.E14.m1.6.6.5.5.2.2.2.1.2.cmml">
                    ​
                   </mo>
                   <mrow id="A1.E14.m1.6.6.5.5.2.2.2.1.1.1" xref="A1.E14.m1.6.6.5.5.2.2.2.1.1.1.1.cmml">
                    <mo id="A1.E14.m1.6.6.5.5.2.2.2.1.1.1.2" stretchy="false" xref="A1.E14.m1.6.6.5.5.2.2.2.1.1.1.1.cmml">
                     (
                    </mo>
                    <msup id="A1.E14.m1.6.6.5.5.2.2.2.1.1.1.1" xref="A1.E14.m1.6.6.5.5.2.2.2.1.1.1.1.cmml">
                     <mi id="A1.E14.m1.6.6.5.5.2.2.2.1.1.1.1.2" xref="A1.E14.m1.6.6.5.5.2.2.2.1.1.1.1.2.cmml">
                      s
                     </mi>
                     <mo id="A1.E14.m1.6.6.5.5.2.2.2.1.1.1.1.3" xref="A1.E14.m1.6.6.5.5.2.2.2.1.1.1.1.3.cmml">
                      ′
                     </mo>
                    </msup>
                    <mo id="A1.E14.m1.6.6.5.5.2.2.2.1.1.1.3" stretchy="false" xref="A1.E14.m1.6.6.5.5.2.2.2.1.1.1.1.cmml">
                     )
                    </mo>
                   </mrow>
                  </mrow>
                 </mrow>
                </mrow>
               </mrow>
              </msub>
              <mo id="A1.E14.m1.14.14.1.1.2.2.2.2a" lspace="0em" rspace="0em" xref="A1.E14.m1.14.14.1.1.2.2.2.2.cmml">
               ​
              </mo>
              <mrow id="A1.E14.m1.14.14.1.1.2.2.2.1.1" xref="A1.E14.m1.14.14.1.1.2.2.2.1.2.cmml">
               <mo id="A1.E14.m1.14.14.1.1.2.2.2.1.1.2" stretchy="false" xref="A1.E14.m1.14.14.1.1.2.2.2.1.2.1.cmml">
                [
               </mo>
               <mrow id="A1.E14.m1.14.14.1.1.2.2.2.1.1.1" xref="A1.E14.m1.14.14.1.1.2.2.2.1.1.1.cmml">
                <mi id="A1.E14.m1.14.14.1.1.2.2.2.1.1.1.4" xref="A1.E14.m1.14.14.1.1.2.2.2.1.1.1.4.cmml">
                 Q
                </mi>
                <mo id="A1.E14.m1.14.14.1.1.2.2.2.1.1.1.3" lspace="0em" rspace="0em" xref="A1.E14.m1.14.14.1.1.2.2.2.1.1.1.3.cmml">
                 ​
                </mo>
                <mrow id="A1.E14.m1.14.14.1.1.2.2.2.1.1.1.2.2" xref="A1.E14.m1.14.14.1.1.2.2.2.1.1.1.2.3.cmml">
                 <mo id="A1.E14.m1.14.14.1.1.2.2.2.1.1.1.2.2.3" stretchy="false" xref="A1.E14.m1.14.14.1.1.2.2.2.1.1.1.2.3.cmml">
                  (
                 </mo>
                 <msup id="A1.E14.m1.14.14.1.1.2.2.2.1.1.1.1.1.1" xref="A1.E14.m1.14.14.1.1.2.2.2.1.1.1.1.1.1.cmml">
                  <mi id="A1.E14.m1.14.14.1.1.2.2.2.1.1.1.1.1.1.2" xref="A1.E14.m1.14.14.1.1.2.2.2.1.1.1.1.1.1.2.cmml">
                   s
                  </mi>
                  <mo id="A1.E14.m1.14.14.1.1.2.2.2.1.1.1.1.1.1.3" xref="A1.E14.m1.14.14.1.1.2.2.2.1.1.1.1.1.1.3.cmml">
                   ′
                  </mo>
                 </msup>
                 <mo id="A1.E14.m1.14.14.1.1.2.2.2.1.1.1.2.2.4" xref="A1.E14.m1.14.14.1.1.2.2.2.1.1.1.2.3.cmml">
                  ,
                 </mo>
                 <msup id="A1.E14.m1.14.14.1.1.2.2.2.1.1.1.2.2.2" xref="A1.E14.m1.14.14.1.1.2.2.2.1.1.1.2.2.2.cmml">
                  <mi id="A1.E14.m1.14.14.1.1.2.2.2.1.1.1.2.2.2.2" xref="A1.E14.m1.14.14.1.1.2.2.2.1.1.1.2.2.2.2.cmml">
                   a
                  </mi>
                  <mo id="A1.E14.m1.14.14.1.1.2.2.2.1.1.1.2.2.2.3" xref="A1.E14.m1.14.14.1.1.2.2.2.1.1.1.2.2.2.3.cmml">
                   ′
                  </mo>
                 </msup>
                 <mo id="A1.E14.m1.14.14.1.1.2.2.2.1.1.1.2.2.5" stretchy="false" xref="A1.E14.m1.14.14.1.1.2.2.2.1.1.1.2.3.cmml">
                  )
                 </mo>
                </mrow>
               </mrow>
               <mo id="A1.E14.m1.14.14.1.1.2.2.2.1.1.3" stretchy="false" xref="A1.E14.m1.14.14.1.1.2.2.2.1.2.1.cmml">
                ]
               </mo>
              </mrow>
             </mrow>
            </mrow>
            <mo id="A1.E14.m1.14.14.1.1.3.4" xref="A1.E14.m1.14.14.1.1.3.4.cmml">
             −
            </mo>
            <mrow id="A1.E14.m1.14.14.1.1.3.3" xref="A1.E14.m1.14.14.1.1.3.3.cmml">
             <mi id="A1.E14.m1.14.14.1.1.3.3.3" xref="A1.E14.m1.14.14.1.1.3.3.3.cmml">
              γ
             </mi>
             <mo id="A1.E14.m1.14.14.1.1.3.3.2" lspace="0em" rspace="0em" xref="A1.E14.m1.14.14.1.1.3.3.2.cmml">
              ​
             </mo>
             <mi id="A1.E14.m1.14.14.1.1.3.3.4" xref="A1.E14.m1.14.14.1.1.3.3.4.cmml">
              β
             </mi>
             <mo id="A1.E14.m1.14.14.1.1.3.3.2a" lspace="0em" rspace="0em" xref="A1.E14.m1.14.14.1.1.3.3.2.cmml">
              ​
             </mo>
             <msub id="A1.E14.m1.14.14.1.1.3.3.5" xref="A1.E14.m1.14.14.1.1.3.3.5.cmml">
              <mi id="A1.E14.m1.14.14.1.1.3.3.5.2" xref="A1.E14.m1.14.14.1.1.3.3.5.2.cmml">
               𝔼
              </mi>
              <mrow id="A1.E14.m1.11.11.5.5" xref="A1.E14.m1.11.11.5.6.cmml">
               <mrow id="A1.E14.m1.10.10.4.4.1" xref="A1.E14.m1.10.10.4.4.1.cmml">
                <mi id="A1.E14.m1.10.10.4.4.1.2" xref="A1.E14.m1.10.10.4.4.1.2.cmml">
                 a
                </mi>
                <mo id="A1.E14.m1.10.10.4.4.1.1" xref="A1.E14.m1.10.10.4.4.1.1.cmml">
                 ∼
                </mo>
                <mrow id="A1.E14.m1.10.10.4.4.1.3" xref="A1.E14.m1.10.10.4.4.1.3.cmml">
                 <msup id="A1.E14.m1.10.10.4.4.1.3.2" xref="A1.E14.m1.10.10.4.4.1.3.2.cmml">
                  <mi id="A1.E14.m1.10.10.4.4.1.3.2.2" xref="A1.E14.m1.10.10.4.4.1.3.2.2.cmml">
                   π
                  </mi>
                  <mo id="A1.E14.m1.10.10.4.4.1.3.2.3" xref="A1.E14.m1.10.10.4.4.1.3.2.3.cmml">
                   ∗
                  </mo>
                 </msup>
                 <mo id="A1.E14.m1.10.10.4.4.1.3.1" lspace="0em" rspace="0em" xref="A1.E14.m1.10.10.4.4.1.3.1.cmml">
                  ​
                 </mo>
                 <mrow id="A1.E14.m1.10.10.4.4.1.3.3.2" xref="A1.E14.m1.10.10.4.4.1.3.cmml">
                  <mo id="A1.E14.m1.10.10.4.4.1.3.3.2.1" stretchy="false" xref="A1.E14.m1.10.10.4.4.1.3.cmml">
                   (
                  </mo>
                  <mi id="A1.E14.m1.7.7.1.1" xref="A1.E14.m1.7.7.1.1.cmml">
                   s
                  </mi>
                  <mo id="A1.E14.m1.10.10.4.4.1.3.3.2.2" stretchy="false" xref="A1.E14.m1.10.10.4.4.1.3.cmml">
                   )
                  </mo>
                 </mrow>
                </mrow>
               </mrow>
               <mo id="A1.E14.m1.11.11.5.5.3" xref="A1.E14.m1.11.11.5.6a.cmml">
                ,
               </mo>
               <mrow id="A1.E14.m1.11.11.5.5.2" xref="A1.E14.m1.11.11.5.5.2.cmml">
                <msup id="A1.E14.m1.11.11.5.5.2.2" xref="A1.E14.m1.11.11.5.5.2.2.cmml">
                 <mi id="A1.E14.m1.11.11.5.5.2.2.2" xref="A1.E14.m1.11.11.5.5.2.2.2.cmml">
                  s
                 </mi>
                 <mo id="A1.E14.m1.11.11.5.5.2.2.3" xref="A1.E14.m1.11.11.5.5.2.2.3.cmml">
                  ′
                 </mo>
                </msup>
                <mo id="A1.E14.m1.11.11.5.5.2.1" xref="A1.E14.m1.11.11.5.5.2.1.cmml">
                 ∼
                </mo>
                <mrow id="A1.E14.m1.11.11.5.5.2.3" xref="A1.E14.m1.11.11.5.5.2.3.cmml">
                 <mi class="ltx_font_mathcaligraphic" id="A1.E14.m1.11.11.5.5.2.3.2" xref="A1.E14.m1.11.11.5.5.2.3.2.cmml">
                  𝒯
                 </mi>
                 <mo id="A1.E14.m1.11.11.5.5.2.3.1" lspace="0em" rspace="0em" xref="A1.E14.m1.11.11.5.5.2.3.1.cmml">
                  ​
                 </mo>
                 <mrow id="A1.E14.m1.11.11.5.5.2.3.3.2" xref="A1.E14.m1.11.11.5.5.2.3.3.1.cmml">
                  <mo id="A1.E14.m1.11.11.5.5.2.3.3.2.1" stretchy="false" xref="A1.E14.m1.11.11.5.5.2.3.3.1.cmml">
                   (
                  </mo>
                  <mi id="A1.E14.m1.8.8.2.2" xref="A1.E14.m1.8.8.2.2.cmml">
                   s
                  </mi>
                  <mo id="A1.E14.m1.11.11.5.5.2.3.3.2.2" xref="A1.E14.m1.11.11.5.5.2.3.3.1.cmml">
                   ,
                  </mo>
                  <mi id="A1.E14.m1.9.9.3.3" xref="A1.E14.m1.9.9.3.3.cmml">
                   a
                  </mi>
                  <mo id="A1.E14.m1.11.11.5.5.2.3.3.2.3" stretchy="false" xref="A1.E14.m1.11.11.5.5.2.3.3.1.cmml">
                   )
                  </mo>
                 </mrow>
                </mrow>
               </mrow>
              </mrow>
             </msub>
             <mo id="A1.E14.m1.14.14.1.1.3.3.2b" lspace="0em" rspace="0em" xref="A1.E14.m1.14.14.1.1.3.3.2.cmml">
              ​
             </mo>
             <mrow id="A1.E14.m1.14.14.1.1.3.3.1.1" xref="A1.E14.m1.14.14.1.1.3.3.1.2.cmml">
              <mo id="A1.E14.m1.14.14.1.1.3.3.1.1.2" stretchy="false" xref="A1.E14.m1.14.14.1.1.3.3.1.2.1.cmml">
               [
              </mo>
              <mrow id="A1.E14.m1.14.14.1.1.3.3.1.1.1" xref="A1.E14.m1.14.14.1.1.3.3.1.1.1.cmml">
               <mtext id="A1.E14.m1.14.14.1.1.3.3.1.1.1.3" xref="A1.E14.m1.14.14.1.1.3.3.1.1.1.3a.cmml">
                KL
               </mtext>
               <mo id="A1.E14.m1.14.14.1.1.3.3.1.1.1.2" lspace="0em" rspace="0em" xref="A1.E14.m1.14.14.1.1.3.3.1.1.1.2.cmml">
                ​
               </mo>
               <mrow id="A1.E14.m1.14.14.1.1.3.3.1.1.1.1.1" xref="A1.E14.m1.14.14.1.1.3.3.1.1.1.1.1.1.cmml">
                <mo id="A1.E14.m1.14.14.1.1.3.3.1.1.1.1.1.2" stretchy="false" xref="A1.E14.m1.14.14.1.1.3.3.1.1.1.1.1.1.cmml">
                 (
                </mo>
                <mrow id="A1.E14.m1.14.14.1.1.3.3.1.1.1.1.1.1" xref="A1.E14.m1.14.14.1.1.3.3.1.1.1.1.1.1.cmml">
                 <msup id="A1.E14.m1.14.14.1.1.3.3.1.1.1.1.1.1.2" xref="A1.E14.m1.14.14.1.1.3.3.1.1.1.1.1.1.2.cmml">
                  <mi id="A1.E14.m1.14.14.1.1.3.3.1.1.1.1.1.1.2.2" xref="A1.E14.m1.14.14.1.1.3.3.1.1.1.1.1.1.2.2.cmml">
                   a
                  </mi>
                  <mo id="A1.E14.m1.14.14.1.1.3.3.1.1.1.1.1.1.2.3" xref="A1.E14.m1.14.14.1.1.3.3.1.1.1.1.1.1.2.3.cmml">
                   ′
                  </mo>
                 </msup>
                 <mo fence="false" id="A1.E14.m1.14.14.1.1.3.3.1.1.1.1.1.1.1" xref="A1.E14.m1.14.14.1.1.3.3.1.1.1.1.1.1.1.cmml">
                  |
                 </mo>
                 <msup id="A1.E14.m1.14.14.1.1.3.3.1.1.1.1.1.1.3" xref="A1.E14.m1.14.14.1.1.3.3.1.1.1.1.1.1.3.cmml">
                  <mi id="A1.E14.m1.14.14.1.1.3.3.1.1.1.1.1.1.3.2" xref="A1.E14.m1.14.14.1.1.3.3.1.1.1.1.1.1.3.2.cmml">
                   s
                  </mi>
                  <mo id="A1.E14.m1.14.14.1.1.3.3.1.1.1.1.1.1.3.3" xref="A1.E14.m1.14.14.1.1.3.3.1.1.1.1.1.1.3.3.cmml">
                   ′
                  </mo>
                 </msup>
                </mrow>
                <mo id="A1.E14.m1.14.14.1.1.3.3.1.1.1.1.1.3" stretchy="false" xref="A1.E14.m1.14.14.1.1.3.3.1.1.1.1.1.1.cmml">
                 )
                </mo>
               </mrow>
              </mrow>
              <mo id="A1.E14.m1.14.14.1.1.3.3.1.1.3" stretchy="false" xref="A1.E14.m1.14.14.1.1.3.3.1.2.1.cmml">
               ]
              </mo>
             </mrow>
            </mrow>
           </mrow>
          </mrow>
          <mo id="A1.E14.m1.14.14.1.2" lspace="0em" xref="A1.E14.m1.14.14.1.1.cmml">
           .
          </mo>
         </mrow>
         <annotation-xml encoding="MathML-Content" id="A1.E14.m1.14b">
          <apply id="A1.E14.m1.14.14.1.1.cmml" xref="A1.E14.m1.14.14.1">
           <eq id="A1.E14.m1.14.14.1.1.4.cmml" xref="A1.E14.m1.14.14.1.1.4">
           </eq>
           <csymbol cd="latexml" id="A1.E14.m1.14.14.1.1.5.cmml" xref="A1.E14.m1.14.14.1.1.5">
            absent
           </csymbol>
           <apply id="A1.E14.m1.14.14.1.1.3.cmml" xref="A1.E14.m1.14.14.1.1.3">
            <minus id="A1.E14.m1.14.14.1.1.3.4.cmml" xref="A1.E14.m1.14.14.1.1.3.4">
            </minus>
            <apply id="A1.E14.m1.14.14.1.1.2.2.cmml" xref="A1.E14.m1.14.14.1.1.2.2">
             <plus id="A1.E14.m1.14.14.1.1.2.2.3.cmml" xref="A1.E14.m1.14.14.1.1.2.2.3">
             </plus>
             <apply id="A1.E14.m1.14.14.1.1.1.1.1.cmml" xref="A1.E14.m1.14.14.1.1.1.1.1">
              <times id="A1.E14.m1.14.14.1.1.1.1.1.2.cmml" xref="A1.E14.m1.14.14.1.1.1.1.1.2">
              </times>
              <apply id="A1.E14.m1.14.14.1.1.1.1.1.3.cmml" xref="A1.E14.m1.14.14.1.1.1.1.1.3">
               <csymbol cd="ambiguous" id="A1.E14.m1.14.14.1.1.1.1.1.3.1.cmml" xref="A1.E14.m1.14.14.1.1.1.1.1.3">
                subscript
               </csymbol>
               <ci id="A1.E14.m1.14.14.1.1.1.1.1.3.2.cmml" xref="A1.E14.m1.14.14.1.1.1.1.1.3.2">
                𝔼
               </ci>
               <apply id="A1.E14.m1.1.1.1.cmml" xref="A1.E14.m1.1.1.1">
                <csymbol cd="latexml" id="A1.E14.m1.1.1.1.2.cmml" xref="A1.E14.m1.1.1.1.2">
                 similar-to
                </csymbol>
                <ci id="A1.E14.m1.1.1.1.3.cmml" xref="A1.E14.m1.1.1.1.3">
                 𝑎
                </ci>
                <apply id="A1.E14.m1.1.1.1.4.cmml" xref="A1.E14.m1.1.1.1.4">
                 <times id="A1.E14.m1.1.1.1.4.1.cmml" xref="A1.E14.m1.1.1.1.4.1">
                 </times>
                 <apply id="A1.E14.m1.1.1.1.4.2.cmml" xref="A1.E14.m1.1.1.1.4.2">
                  <csymbol cd="ambiguous" id="A1.E14.m1.1.1.1.4.2.1.cmml" xref="A1.E14.m1.1.1.1.4.2">
                   superscript
                  </csymbol>
                  <ci id="A1.E14.m1.1.1.1.4.2.2.cmml" xref="A1.E14.m1.1.1.1.4.2.2">
                   𝜋
                  </ci>
                  <times id="A1.E14.m1.1.1.1.4.2.3.cmml" xref="A1.E14.m1.1.1.1.4.2.3">
                  </times>
                 </apply>
                 <ci id="A1.E14.m1.1.1.1.1.cmml" xref="A1.E14.m1.1.1.1.1">
                  𝑠
                 </ci>
                </apply>
               </apply>
              </apply>
              <apply id="A1.E14.m1.14.14.1.1.1.1.1.1.2.cmml" xref="A1.E14.m1.14.14.1.1.1.1.1.1.1">
               <csymbol cd="latexml" id="A1.E14.m1.14.14.1.1.1.1.1.1.2.1.cmml" xref="A1.E14.m1.14.14.1.1.1.1.1.1.1.2">
                delimited-[]
               </csymbol>
               <apply id="A1.E14.m1.14.14.1.1.1.1.1.1.1.1.cmml" xref="A1.E14.m1.14.14.1.1.1.1.1.1.1.1">
                <times id="A1.E14.m1.14.14.1.1.1.1.1.1.1.1.1.cmml" xref="A1.E14.m1.14.14.1.1.1.1.1.1.1.1.1">
                </times>
                <ci id="A1.E14.m1.14.14.1.1.1.1.1.1.1.1.2.cmml" xref="A1.E14.m1.14.14.1.1.1.1.1.1.1.1.2">
                 𝑟
                </ci>
                <interval closure="open" id="A1.E14.m1.14.14.1.1.1.1.1.1.1.1.3.1.cmml" xref="A1.E14.m1.14.14.1.1.1.1.1.1.1.1.3.2">
                 <ci id="A1.E14.m1.12.12.cmml" xref="A1.E14.m1.12.12">
                  𝑠
                 </ci>
                 <ci id="A1.E14.m1.13.13.cmml" xref="A1.E14.m1.13.13">
                  𝑎
                 </ci>
                </interval>
               </apply>
              </apply>
             </apply>
             <apply id="A1.E14.m1.14.14.1.1.2.2.2.cmml" xref="A1.E14.m1.14.14.1.1.2.2.2">
              <times id="A1.E14.m1.14.14.1.1.2.2.2.2.cmml" xref="A1.E14.m1.14.14.1.1.2.2.2.2">
              </times>
              <ci id="A1.E14.m1.14.14.1.1.2.2.2.3.cmml" xref="A1.E14.m1.14.14.1.1.2.2.2.3">
               𝛾
              </ci>
              <apply id="A1.E14.m1.14.14.1.1.2.2.2.4.cmml" xref="A1.E14.m1.14.14.1.1.2.2.2.4">
               <csymbol cd="ambiguous" id="A1.E14.m1.14.14.1.1.2.2.2.4.1.cmml" xref="A1.E14.m1.14.14.1.1.2.2.2.4">
                subscript
               </csymbol>
               <ci id="A1.E14.m1.14.14.1.1.2.2.2.4.2.cmml" xref="A1.E14.m1.14.14.1.1.2.2.2.4.2">
                𝔼
               </ci>
               <apply id="A1.E14.m1.6.6.5.6.cmml" xref="A1.E14.m1.6.6.5.5">
                <csymbol cd="ambiguous" id="A1.E14.m1.6.6.5.6a.cmml" xref="A1.E14.m1.6.6.5.5.3">
                 formulae-sequence
                </csymbol>
                <apply id="A1.E14.m1.5.5.4.4.1.cmml" xref="A1.E14.m1.5.5.4.4.1">
                 <csymbol cd="latexml" id="A1.E14.m1.5.5.4.4.1.1.cmml" xref="A1.E14.m1.5.5.4.4.1.1">
                  similar-to
                 </csymbol>
                 <ci id="A1.E14.m1.5.5.4.4.1.2.cmml" xref="A1.E14.m1.5.5.4.4.1.2">
                  𝑎
                 </ci>
                 <apply id="A1.E14.m1.5.5.4.4.1.3.cmml" xref="A1.E14.m1.5.5.4.4.1.3">
                  <times id="A1.E14.m1.5.5.4.4.1.3.1.cmml" xref="A1.E14.m1.5.5.4.4.1.3.1">
                  </times>
                  <apply id="A1.E14.m1.5.5.4.4.1.3.2.cmml" xref="A1.E14.m1.5.5.4.4.1.3.2">
                   <csymbol cd="ambiguous" id="A1.E14.m1.5.5.4.4.1.3.2.1.cmml" xref="A1.E14.m1.5.5.4.4.1.3.2">
                    superscript
                   </csymbol>
                   <ci id="A1.E14.m1.5.5.4.4.1.3.2.2.cmml" xref="A1.E14.m1.5.5.4.4.1.3.2.2">
                    𝜋
                   </ci>
                   <times id="A1.E14.m1.5.5.4.4.1.3.2.3.cmml" xref="A1.E14.m1.5.5.4.4.1.3.2.3">
                   </times>
                  </apply>
                  <ci id="A1.E14.m1.2.2.1.1.cmml" xref="A1.E14.m1.2.2.1.1">
                   𝑠
                  </ci>
                 </apply>
                </apply>
                <apply id="A1.E14.m1.6.6.5.5.2.3.cmml" xref="A1.E14.m1.6.6.5.5.2.2">
                 <csymbol cd="ambiguous" id="A1.E14.m1.6.6.5.5.2.3a.cmml" xref="A1.E14.m1.6.6.5.5.2.2.3">
                  formulae-sequence
                 </csymbol>
                 <apply id="A1.E14.m1.6.6.5.5.2.1.1.cmml" xref="A1.E14.m1.6.6.5.5.2.1.1">
                  <csymbol cd="latexml" id="A1.E14.m1.6.6.5.5.2.1.1.1.cmml" xref="A1.E14.m1.6.6.5.5.2.1.1.1">
                   similar-to
                  </csymbol>
                  <apply id="A1.E14.m1.6.6.5.5.2.1.1.2.cmml" xref="A1.E14.m1.6.6.5.5.2.1.1.2">
                   <csymbol cd="ambiguous" id="A1.E14.m1.6.6.5.5.2.1.1.2.1.cmml" xref="A1.E14.m1.6.6.5.5.2.1.1.2">
                    superscript
                   </csymbol>
                   <ci id="A1.E14.m1.6.6.5.5.2.1.1.2.2.cmml" xref="A1.E14.m1.6.6.5.5.2.1.1.2.2">
                    𝑠
                   </ci>
                   <ci id="A1.E14.m1.6.6.5.5.2.1.1.2.3.cmml" xref="A1.E14.m1.6.6.5.5.2.1.1.2.3">
                    ′
                   </ci>
                  </apply>
                  <apply id="A1.E14.m1.6.6.5.5.2.1.1.3.cmml" xref="A1.E14.m1.6.6.5.5.2.1.1.3">
                   <times id="A1.E14.m1.6.6.5.5.2.1.1.3.1.cmml" xref="A1.E14.m1.6.6.5.5.2.1.1.3.1">
                   </times>
                   <ci id="A1.E14.m1.6.6.5.5.2.1.1.3.2.cmml" xref="A1.E14.m1.6.6.5.5.2.1.1.3.2">
                    𝒯
                   </ci>
                   <interval closure="open" id="A1.E14.m1.6.6.5.5.2.1.1.3.3.1.cmml" xref="A1.E14.m1.6.6.5.5.2.1.1.3.3.2">
                    <ci id="A1.E14.m1.3.3.2.2.cmml" xref="A1.E14.m1.3.3.2.2">
                     𝑠
                    </ci>
                    <ci id="A1.E14.m1.4.4.3.3.cmml" xref="A1.E14.m1.4.4.3.3">
                     𝑎
                    </ci>
                   </interval>
                  </apply>
                 </apply>
                 <apply id="A1.E14.m1.6.6.5.5.2.2.2.cmml" xref="A1.E14.m1.6.6.5.5.2.2.2">
                  <csymbol cd="latexml" id="A1.E14.m1.6.6.5.5.2.2.2.2.cmml" xref="A1.E14.m1.6.6.5.5.2.2.2.2">
                   similar-to
                  </csymbol>
                  <apply id="A1.E14.m1.6.6.5.5.2.2.2.3.cmml" xref="A1.E14.m1.6.6.5.5.2.2.2.3">
                   <csymbol cd="ambiguous" id="A1.E14.m1.6.6.5.5.2.2.2.3.1.cmml" xref="A1.E14.m1.6.6.5.5.2.2.2.3">
                    superscript
                   </csymbol>
                   <ci id="A1.E14.m1.6.6.5.5.2.2.2.3.2.cmml" xref="A1.E14.m1.6.6.5.5.2.2.2.3.2">
                    𝑎
                   </ci>
                   <ci id="A1.E14.m1.6.6.5.5.2.2.2.3.3.cmml" xref="A1.E14.m1.6.6.5.5.2.2.2.3.3">
                    ′
                   </ci>
                  </apply>
                  <apply id="A1.E14.m1.6.6.5.5.2.2.2.1.cmml" xref="A1.E14.m1.6.6.5.5.2.2.2.1">
                   <times id="A1.E14.m1.6.6.5.5.2.2.2.1.2.cmml" xref="A1.E14.m1.6.6.5.5.2.2.2.1.2">
                   </times>
                   <apply id="A1.E14.m1.6.6.5.5.2.2.2.1.3.cmml" xref="A1.E14.m1.6.6.5.5.2.2.2.1.3">
                    <csymbol cd="ambiguous" id="A1.E14.m1.6.6.5.5.2.2.2.1.3.1.cmml" xref="A1.E14.m1.6.6.5.5.2.2.2.1.3">
                     superscript
                    </csymbol>
                    <ci id="A1.E14.m1.6.6.5.5.2.2.2.1.3.2.cmml" xref="A1.E14.m1.6.6.5.5.2.2.2.1.3.2">
                     𝜋
                    </ci>
                    <times id="A1.E14.m1.6.6.5.5.2.2.2.1.3.3.cmml" xref="A1.E14.m1.6.6.5.5.2.2.2.1.3.3">
                    </times>
                   </apply>
                   <apply id="A1.E14.m1.6.6.5.5.2.2.2.1.1.1.1.cmml" xref="A1.E14.m1.6.6.5.5.2.2.2.1.1.1">
                    <csymbol cd="ambiguous" id="A1.E14.m1.6.6.5.5.2.2.2.1.1.1.1.1.cmml" xref="A1.E14.m1.6.6.5.5.2.2.2.1.1.1">
                     superscript
                    </csymbol>
                    <ci id="A1.E14.m1.6.6.5.5.2.2.2.1.1.1.1.2.cmml" xref="A1.E14.m1.6.6.5.5.2.2.2.1.1.1.1.2">
                     𝑠
                    </ci>
                    <ci id="A1.E14.m1.6.6.5.5.2.2.2.1.1.1.1.3.cmml" xref="A1.E14.m1.6.6.5.5.2.2.2.1.1.1.1.3">
                     ′
                    </ci>
                   </apply>
                  </apply>
                 </apply>
                </apply>
               </apply>
              </apply>
              <apply id="A1.E14.m1.14.14.1.1.2.2.2.1.2.cmml" xref="A1.E14.m1.14.14.1.1.2.2.2.1.1">
               <csymbol cd="latexml" id="A1.E14.m1.14.14.1.1.2.2.2.1.2.1.cmml" xref="A1.E14.m1.14.14.1.1.2.2.2.1.1.2">
                delimited-[]
               </csymbol>
               <apply id="A1.E14.m1.14.14.1.1.2.2.2.1.1.1.cmml" xref="A1.E14.m1.14.14.1.1.2.2.2.1.1.1">
                <times id="A1.E14.m1.14.14.1.1.2.2.2.1.1.1.3.cmml" xref="A1.E14.m1.14.14.1.1.2.2.2.1.1.1.3">
                </times>
                <ci id="A1.E14.m1.14.14.1.1.2.2.2.1.1.1.4.cmml" xref="A1.E14.m1.14.14.1.1.2.2.2.1.1.1.4">
                 𝑄
                </ci>
                <interval closure="open" id="A1.E14.m1.14.14.1.1.2.2.2.1.1.1.2.3.cmml" xref="A1.E14.m1.14.14.1.1.2.2.2.1.1.1.2.2">
                 <apply id="A1.E14.m1.14.14.1.1.2.2.2.1.1.1.1.1.1.cmml" xref="A1.E14.m1.14.14.1.1.2.2.2.1.1.1.1.1.1">
                  <csymbol cd="ambiguous" id="A1.E14.m1.14.14.1.1.2.2.2.1.1.1.1.1.1.1.cmml" xref="A1.E14.m1.14.14.1.1.2.2.2.1.1.1.1.1.1">
                   superscript
                  </csymbol>
                  <ci id="A1.E14.m1.14.14.1.1.2.2.2.1.1.1.1.1.1.2.cmml" xref="A1.E14.m1.14.14.1.1.2.2.2.1.1.1.1.1.1.2">
                   𝑠
                  </ci>
                  <ci id="A1.E14.m1.14.14.1.1.2.2.2.1.1.1.1.1.1.3.cmml" xref="A1.E14.m1.14.14.1.1.2.2.2.1.1.1.1.1.1.3">
                   ′
                  </ci>
                 </apply>
                 <apply id="A1.E14.m1.14.14.1.1.2.2.2.1.1.1.2.2.2.cmml" xref="A1.E14.m1.14.14.1.1.2.2.2.1.1.1.2.2.2">
                  <csymbol cd="ambiguous" id="A1.E14.m1.14.14.1.1.2.2.2.1.1.1.2.2.2.1.cmml" xref="A1.E14.m1.14.14.1.1.2.2.2.1.1.1.2.2.2">
                   superscript
                  </csymbol>
                  <ci id="A1.E14.m1.14.14.1.1.2.2.2.1.1.1.2.2.2.2.cmml" xref="A1.E14.m1.14.14.1.1.2.2.2.1.1.1.2.2.2.2">
                   𝑎
                  </ci>
                  <ci id="A1.E14.m1.14.14.1.1.2.2.2.1.1.1.2.2.2.3.cmml" xref="A1.E14.m1.14.14.1.1.2.2.2.1.1.1.2.2.2.3">
                   ′
                  </ci>
                 </apply>
                </interval>
               </apply>
              </apply>
             </apply>
            </apply>
            <apply id="A1.E14.m1.14.14.1.1.3.3.cmml" xref="A1.E14.m1.14.14.1.1.3.3">
             <times id="A1.E14.m1.14.14.1.1.3.3.2.cmml" xref="A1.E14.m1.14.14.1.1.3.3.2">
             </times>
             <ci id="A1.E14.m1.14.14.1.1.3.3.3.cmml" xref="A1.E14.m1.14.14.1.1.3.3.3">
              𝛾
             </ci>
             <ci id="A1.E14.m1.14.14.1.1.3.3.4.cmml" xref="A1.E14.m1.14.14.1.1.3.3.4">
              𝛽
             </ci>
             <apply id="A1.E14.m1.14.14.1.1.3.3.5.cmml" xref="A1.E14.m1.14.14.1.1.3.3.5">
              <csymbol cd="ambiguous" id="A1.E14.m1.14.14.1.1.3.3.5.1.cmml" xref="A1.E14.m1.14.14.1.1.3.3.5">
               subscript
              </csymbol>
              <ci id="A1.E14.m1.14.14.1.1.3.3.5.2.cmml" xref="A1.E14.m1.14.14.1.1.3.3.5.2">
               𝔼
              </ci>
              <apply id="A1.E14.m1.11.11.5.6.cmml" xref="A1.E14.m1.11.11.5.5">
               <csymbol cd="ambiguous" id="A1.E14.m1.11.11.5.6a.cmml" xref="A1.E14.m1.11.11.5.5.3">
                formulae-sequence
               </csymbol>
               <apply id="A1.E14.m1.10.10.4.4.1.cmml" xref="A1.E14.m1.10.10.4.4.1">
                <csymbol cd="latexml" id="A1.E14.m1.10.10.4.4.1.1.cmml" xref="A1.E14.m1.10.10.4.4.1.1">
                 similar-to
                </csymbol>
                <ci id="A1.E14.m1.10.10.4.4.1.2.cmml" xref="A1.E14.m1.10.10.4.4.1.2">
                 𝑎
                </ci>
                <apply id="A1.E14.m1.10.10.4.4.1.3.cmml" xref="A1.E14.m1.10.10.4.4.1.3">
                 <times id="A1.E14.m1.10.10.4.4.1.3.1.cmml" xref="A1.E14.m1.10.10.4.4.1.3.1">
                 </times>
                 <apply id="A1.E14.m1.10.10.4.4.1.3.2.cmml" xref="A1.E14.m1.10.10.4.4.1.3.2">
                  <csymbol cd="ambiguous" id="A1.E14.m1.10.10.4.4.1.3.2.1.cmml" xref="A1.E14.m1.10.10.4.4.1.3.2">
                   superscript
                  </csymbol>
                  <ci id="A1.E14.m1.10.10.4.4.1.3.2.2.cmml" xref="A1.E14.m1.10.10.4.4.1.3.2.2">
                   𝜋
                  </ci>
                  <times id="A1.E14.m1.10.10.4.4.1.3.2.3.cmml" xref="A1.E14.m1.10.10.4.4.1.3.2.3">
                  </times>
                 </apply>
                 <ci id="A1.E14.m1.7.7.1.1.cmml" xref="A1.E14.m1.7.7.1.1">
                  𝑠
                 </ci>
                </apply>
               </apply>
               <apply id="A1.E14.m1.11.11.5.5.2.cmml" xref="A1.E14.m1.11.11.5.5.2">
                <csymbol cd="latexml" id="A1.E14.m1.11.11.5.5.2.1.cmml" xref="A1.E14.m1.11.11.5.5.2.1">
                 similar-to
                </csymbol>
                <apply id="A1.E14.m1.11.11.5.5.2.2.cmml" xref="A1.E14.m1.11.11.5.5.2.2">
                 <csymbol cd="ambiguous" id="A1.E14.m1.11.11.5.5.2.2.1.cmml" xref="A1.E14.m1.11.11.5.5.2.2">
                  superscript
                 </csymbol>
                 <ci id="A1.E14.m1.11.11.5.5.2.2.2.cmml" xref="A1.E14.m1.11.11.5.5.2.2.2">
                  𝑠
                 </ci>
                 <ci id="A1.E14.m1.11.11.5.5.2.2.3.cmml" xref="A1.E14.m1.11.11.5.5.2.2.3">
                  ′
                 </ci>
                </apply>
                <apply id="A1.E14.m1.11.11.5.5.2.3.cmml" xref="A1.E14.m1.11.11.5.5.2.3">
                 <times id="A1.E14.m1.11.11.5.5.2.3.1.cmml" xref="A1.E14.m1.11.11.5.5.2.3.1">
                 </times>
                 <ci id="A1.E14.m1.11.11.5.5.2.3.2.cmml" xref="A1.E14.m1.11.11.5.5.2.3.2">
                  𝒯
                 </ci>
                 <interval closure="open" id="A1.E14.m1.11.11.5.5.2.3.3.1.cmml" xref="A1.E14.m1.11.11.5.5.2.3.3.2">
                  <ci id="A1.E14.m1.8.8.2.2.cmml" xref="A1.E14.m1.8.8.2.2">
                   𝑠
                  </ci>
                  <ci id="A1.E14.m1.9.9.3.3.cmml" xref="A1.E14.m1.9.9.3.3">
                   𝑎
                  </ci>
                 </interval>
                </apply>
               </apply>
              </apply>
             </apply>
             <apply id="A1.E14.m1.14.14.1.1.3.3.1.2.cmml" xref="A1.E14.m1.14.14.1.1.3.3.1.1">
              <csymbol cd="latexml" id="A1.E14.m1.14.14.1.1.3.3.1.2.1.cmml" xref="A1.E14.m1.14.14.1.1.3.3.1.1.2">
               delimited-[]
              </csymbol>
              <apply id="A1.E14.m1.14.14.1.1.3.3.1.1.1.cmml" xref="A1.E14.m1.14.14.1.1.3.3.1.1.1">
               <times id="A1.E14.m1.14.14.1.1.3.3.1.1.1.2.cmml" xref="A1.E14.m1.14.14.1.1.3.3.1.1.1.2">
               </times>
               <ci id="A1.E14.m1.14.14.1.1.3.3.1.1.1.3a.cmml" xref="A1.E14.m1.14.14.1.1.3.3.1.1.1.3">
                <mtext id="A1.E14.m1.14.14.1.1.3.3.1.1.1.3.cmml" xref="A1.E14.m1.14.14.1.1.3.3.1.1.1.3">
                 KL
                </mtext>
               </ci>
               <apply id="A1.E14.m1.14.14.1.1.3.3.1.1.1.1.1.1.cmml" xref="A1.E14.m1.14.14.1.1.3.3.1.1.1.1.1">
                <csymbol cd="latexml" id="A1.E14.m1.14.14.1.1.3.3.1.1.1.1.1.1.1.cmml" xref="A1.E14.m1.14.14.1.1.3.3.1.1.1.1.1.1.1">
                 conditional
                </csymbol>
                <apply id="A1.E14.m1.14.14.1.1.3.3.1.1.1.1.1.1.2.cmml" xref="A1.E14.m1.14.14.1.1.3.3.1.1.1.1.1.1.2">
                 <csymbol cd="ambiguous" id="A1.E14.m1.14.14.1.1.3.3.1.1.1.1.1.1.2.1.cmml" xref="A1.E14.m1.14.14.1.1.3.3.1.1.1.1.1.1.2">
                  superscript
                 </csymbol>
                 <ci id="A1.E14.m1.14.14.1.1.3.3.1.1.1.1.1.1.2.2.cmml" xref="A1.E14.m1.14.14.1.1.3.3.1.1.1.1.1.1.2.2">
                  𝑎
                 </ci>
                 <ci id="A1.E14.m1.14.14.1.1.3.3.1.1.1.1.1.1.2.3.cmml" xref="A1.E14.m1.14.14.1.1.3.3.1.1.1.1.1.1.2.3">
                  ′
                 </ci>
                </apply>
                <apply id="A1.E14.m1.14.14.1.1.3.3.1.1.1.1.1.1.3.cmml" xref="A1.E14.m1.14.14.1.1.3.3.1.1.1.1.1.1.3">
                 <csymbol cd="ambiguous" id="A1.E14.m1.14.14.1.1.3.3.1.1.1.1.1.1.3.1.cmml" xref="A1.E14.m1.14.14.1.1.3.3.1.1.1.1.1.1.3">
                  superscript
                 </csymbol>
                 <ci id="A1.E14.m1.14.14.1.1.3.3.1.1.1.1.1.1.3.2.cmml" xref="A1.E14.m1.14.14.1.1.3.3.1.1.1.1.1.1.3.2">
                  𝑠
                 </ci>
                 <ci id="A1.E14.m1.14.14.1.1.3.3.1.1.1.1.1.1.3.3.cmml" xref="A1.E14.m1.14.14.1.1.3.3.1.1.1.1.1.1.3.3">
                  ′
                 </ci>
                </apply>
               </apply>
              </apply>
             </apply>
            </apply>
           </apply>
          </apply>
         </annotation-xml>
         <annotation encoding="application/x-tex" id="A1.E14.m1.14c">
          \displaystyle=\mathbb{E}_{a\sim\pi^{*}(s)}[r(s,a)]+\gamma\mathbb{E}_{a\sim\pi^{*}(s),s^{\prime}\sim\mathcal{T}(s,a),a^{\prime}\sim\pi^{*}(s^{\prime})}[Q(s^{\prime},a^{\prime})]-\gamma\beta\mathbb{E}_{a\sim\pi^{*}(s),s^{\prime}\sim\mathcal{T}(s,a)}[\text{KL}(a^{\prime}|s^{\prime})].
         </annotation>
        </semantics>
       </math>
      </td>
      <td class="ltx_eqn_cell ltx_eqn_center_padright">
      </td>
      <td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1">
       <span class="ltx_tag ltx_tag_equation ltx_align_right">
        (14)
       </span>
      </td>
     </tr>
    </tbody>
   </table>
  </div>
  <div class="ltx_para" id="A1.p6">
   <p class="ltx_p" id="A1.p6.1">
    Eq.
    <a class="ltx_ref" href="#A1.Ex7" title="Appendix A Proof of Optimization Consistency ‣ Entropy-Regularized Token-Level Policy Optimization for Large Language Models">
     <span class="ltx_text ltx_ref_tag">
      A
     </span>
    </a>
    enjoys the same shape as Eq.
    <a class="ltx_ref" href="#A1.Ex3" title="Appendix A Proof of Optimization Consistency ‣ Entropy-Regularized Token-Level Policy Optimization for Large Language Models">
     <span class="ltx_text ltx_ref_tag">
      A
     </span>
    </a>
    , thus optimizing the soft Q function following our per-token soft Bellman update is equivalent to the action-level optimization. We prove the consistency between per-token soft Bellman updates and soft Bellman updates over full actions.
   </p>
  </div>
 </section>
 <section class="ltx_appendix" id="A2">
  <h2 class="ltx_title ltx_title_appendix">
   <span class="ltx_tag ltx_tag_appendix">
    Appendix B
   </span>
   Per-token Policy Update
  </h2>
  <div class="ltx_para" id="A2.p1">
   <p class="ltx_p" id="A2.p1.1">
    Optimal Soft Policy w.r.t Q function:
   </p>
   <table class="ltx_equationgroup ltx_eqn_align ltx_eqn_table" id="A7.EGx15">
    <tbody id="A2.Ex8">
     <tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
      <td class="ltx_eqn_cell ltx_eqn_center_padleft">
      </td>
      <td class="ltx_td ltx_align_right ltx_eqn_cell">
       <math alttext="\displaystyle\pi^{*}(a|s)" class="ltx_Math" display="inline" id="A2.Ex8.m1.1">
        <semantics id="A2.Ex8.m1.1a">
         <mrow id="A2.Ex8.m1.1.1" xref="A2.Ex8.m1.1.1.cmml">
          <msup id="A2.Ex8.m1.1.1.3" xref="A2.Ex8.m1.1.1.3.cmml">
           <mi id="A2.Ex8.m1.1.1.3.2" xref="A2.Ex8.m1.1.1.3.2.cmml">
            π
           </mi>
           <mo id="A2.Ex8.m1.1.1.3.3" xref="A2.Ex8.m1.1.1.3.3.cmml">
            ∗
           </mo>
          </msup>
          <mo id="A2.Ex8.m1.1.1.2" lspace="0em" rspace="0em" xref="A2.Ex8.m1.1.1.2.cmml">
           ​
          </mo>
          <mrow id="A2.Ex8.m1.1.1.1.1" xref="A2.Ex8.m1.1.1.1.1.1.cmml">
           <mo id="A2.Ex8.m1.1.1.1.1.2" stretchy="false" xref="A2.Ex8.m1.1.1.1.1.1.cmml">
            (
           </mo>
           <mrow id="A2.Ex8.m1.1.1.1.1.1" xref="A2.Ex8.m1.1.1.1.1.1.cmml">
            <mi id="A2.Ex8.m1.1.1.1.1.1.2" xref="A2.Ex8.m1.1.1.1.1.1.2.cmml">
             a
            </mi>
            <mo fence="false" id="A2.Ex8.m1.1.1.1.1.1.1" xref="A2.Ex8.m1.1.1.1.1.1.1.cmml">
             |
            </mo>
            <mi id="A2.Ex8.m1.1.1.1.1.1.3" xref="A2.Ex8.m1.1.1.1.1.1.3.cmml">
             s
            </mi>
           </mrow>
           <mo id="A2.Ex8.m1.1.1.1.1.3" stretchy="false" xref="A2.Ex8.m1.1.1.1.1.1.cmml">
            )
           </mo>
          </mrow>
         </mrow>
         <annotation-xml encoding="MathML-Content" id="A2.Ex8.m1.1b">
          <apply id="A2.Ex8.m1.1.1.cmml" xref="A2.Ex8.m1.1.1">
           <times id="A2.Ex8.m1.1.1.2.cmml" xref="A2.Ex8.m1.1.1.2">
           </times>
           <apply id="A2.Ex8.m1.1.1.3.cmml" xref="A2.Ex8.m1.1.1.3">
            <csymbol cd="ambiguous" id="A2.Ex8.m1.1.1.3.1.cmml" xref="A2.Ex8.m1.1.1.3">
             superscript
            </csymbol>
            <ci id="A2.Ex8.m1.1.1.3.2.cmml" xref="A2.Ex8.m1.1.1.3.2">
             𝜋
            </ci>
            <times id="A2.Ex8.m1.1.1.3.3.cmml" xref="A2.Ex8.m1.1.1.3.3">
            </times>
           </apply>
           <apply id="A2.Ex8.m1.1.1.1.1.1.cmml" xref="A2.Ex8.m1.1.1.1.1">
            <csymbol cd="latexml" id="A2.Ex8.m1.1.1.1.1.1.1.cmml" xref="A2.Ex8.m1.1.1.1.1.1.1">
             conditional
            </csymbol>
            <ci id="A2.Ex8.m1.1.1.1.1.1.2.cmml" xref="A2.Ex8.m1.1.1.1.1.1.2">
             𝑎
            </ci>
            <ci id="A2.Ex8.m1.1.1.1.1.1.3.cmml" xref="A2.Ex8.m1.1.1.1.1.1.3">
             𝑠
            </ci>
           </apply>
          </apply>
         </annotation-xml>
         <annotation encoding="application/x-tex" id="A2.Ex8.m1.1c">
          \displaystyle\pi^{*}(a|s)
         </annotation>
        </semantics>
       </math>
      </td>
      <td class="ltx_td ltx_align_left ltx_eqn_cell">
       <math alttext="\displaystyle=\arg\max_{\pi}\Big{\{}\mathbb{E}_{a\sim\pi(s)}[Q(s,a)]-\beta\text{KL}(s)\Big{\}}" class="ltx_Math" display="inline" id="A2.Ex8.m2.6">
        <semantics id="A2.Ex8.m2.6a">
         <mrow id="A2.Ex8.m2.6.6" xref="A2.Ex8.m2.6.6.cmml">
          <mi id="A2.Ex8.m2.6.6.4" xref="A2.Ex8.m2.6.6.4.cmml">
          </mi>
          <mo id="A2.Ex8.m2.6.6.3" xref="A2.Ex8.m2.6.6.3.cmml">
           =
          </mo>
          <mrow id="A2.Ex8.m2.6.6.2" xref="A2.Ex8.m2.6.6.2.cmml">
           <mi id="A2.Ex8.m2.6.6.2.3" xref="A2.Ex8.m2.6.6.2.3.cmml">
            arg
           </mi>
           <mo id="A2.Ex8.m2.6.6.2a" lspace="0.167em" xref="A2.Ex8.m2.6.6.2.cmml">
            ⁡
           </mo>
           <mrow id="A2.Ex8.m2.6.6.2.2.2" xref="A2.Ex8.m2.6.6.2.2.3.cmml">
            <munder id="A2.Ex8.m2.5.5.1.1.1.1" xref="A2.Ex8.m2.5.5.1.1.1.1.cmml">
             <mi id="A2.Ex8.m2.5.5.1.1.1.1.2" xref="A2.Ex8.m2.5.5.1.1.1.1.2.cmml">
              max
             </mi>
             <mi id="A2.Ex8.m2.5.5.1.1.1.1.3" xref="A2.Ex8.m2.5.5.1.1.1.1.3.cmml">
              π
             </mi>
            </munder>
            <mo id="A2.Ex8.m2.6.6.2.2.2a" xref="A2.Ex8.m2.6.6.2.2.3.cmml">
             ⁡
            </mo>
            <mrow id="A2.Ex8.m2.6.6.2.2.2.2" xref="A2.Ex8.m2.6.6.2.2.3.cmml">
             <mo id="A2.Ex8.m2.6.6.2.2.2.2.2" maxsize="160%" minsize="160%" xref="A2.Ex8.m2.6.6.2.2.3.cmml">
              {
             </mo>
             <mrow id="A2.Ex8.m2.6.6.2.2.2.2.1" xref="A2.Ex8.m2.6.6.2.2.2.2.1.cmml">
              <mrow id="A2.Ex8.m2.6.6.2.2.2.2.1.1" xref="A2.Ex8.m2.6.6.2.2.2.2.1.1.cmml">
               <msub id="A2.Ex8.m2.6.6.2.2.2.2.1.1.3" xref="A2.Ex8.m2.6.6.2.2.2.2.1.1.3.cmml">
                <mi id="A2.Ex8.m2.6.6.2.2.2.2.1.1.3.2" xref="A2.Ex8.m2.6.6.2.2.2.2.1.1.3.2.cmml">
                 𝔼
                </mi>
                <mrow id="A2.Ex8.m2.1.1.1" xref="A2.Ex8.m2.1.1.1.cmml">
                 <mi id="A2.Ex8.m2.1.1.1.3" xref="A2.Ex8.m2.1.1.1.3.cmml">
                  a
                 </mi>
                 <mo id="A2.Ex8.m2.1.1.1.2" xref="A2.Ex8.m2.1.1.1.2.cmml">
                  ∼
                 </mo>
                 <mrow id="A2.Ex8.m2.1.1.1.4" xref="A2.Ex8.m2.1.1.1.4.cmml">
                  <mi id="A2.Ex8.m2.1.1.1.4.2" xref="A2.Ex8.m2.1.1.1.4.2.cmml">
                   π
                  </mi>
                  <mo id="A2.Ex8.m2.1.1.1.4.1" lspace="0em" rspace="0em" xref="A2.Ex8.m2.1.1.1.4.1.cmml">
                   ​
                  </mo>
                  <mrow id="A2.Ex8.m2.1.1.1.4.3.2" xref="A2.Ex8.m2.1.1.1.4.cmml">
                   <mo id="A2.Ex8.m2.1.1.1.4.3.2.1" stretchy="false" xref="A2.Ex8.m2.1.1.1.4.cmml">
                    (
                   </mo>
                   <mi id="A2.Ex8.m2.1.1.1.1" xref="A2.Ex8.m2.1.1.1.1.cmml">
                    s
                   </mi>
                   <mo id="A2.Ex8.m2.1.1.1.4.3.2.2" stretchy="false" xref="A2.Ex8.m2.1.1.1.4.cmml">
                    )
                   </mo>
                  </mrow>
                 </mrow>
                </mrow>
               </msub>
               <mo id="A2.Ex8.m2.6.6.2.2.2.2.1.1.2" lspace="0em" rspace="0em" xref="A2.Ex8.m2.6.6.2.2.2.2.1.1.2.cmml">
                ​
               </mo>
               <mrow id="A2.Ex8.m2.6.6.2.2.2.2.1.1.1.1" xref="A2.Ex8.m2.6.6.2.2.2.2.1.1.1.2.cmml">
                <mo id="A2.Ex8.m2.6.6.2.2.2.2.1.1.1.1.2" stretchy="false" xref="A2.Ex8.m2.6.6.2.2.2.2.1.1.1.2.1.cmml">
                 [
                </mo>
                <mrow id="A2.Ex8.m2.6.6.2.2.2.2.1.1.1.1.1" xref="A2.Ex8.m2.6.6.2.2.2.2.1.1.1.1.1.cmml">
                 <mi id="A2.Ex8.m2.6.6.2.2.2.2.1.1.1.1.1.2" xref="A2.Ex8.m2.6.6.2.2.2.2.1.1.1.1.1.2.cmml">
                  Q
                 </mi>
                 <mo id="A2.Ex8.m2.6.6.2.2.2.2.1.1.1.1.1.1" lspace="0em" rspace="0em" xref="A2.Ex8.m2.6.6.2.2.2.2.1.1.1.1.1.1.cmml">
                  ​
                 </mo>
                 <mrow id="A2.Ex8.m2.6.6.2.2.2.2.1.1.1.1.1.3.2" xref="A2.Ex8.m2.6.6.2.2.2.2.1.1.1.1.1.3.1.cmml">
                  <mo id="A2.Ex8.m2.6.6.2.2.2.2.1.1.1.1.1.3.2.1" stretchy="false" xref="A2.Ex8.m2.6.6.2.2.2.2.1.1.1.1.1.3.1.cmml">
                   (
                  </mo>
                  <mi id="A2.Ex8.m2.2.2" xref="A2.Ex8.m2.2.2.cmml">
                   s
                  </mi>
                  <mo id="A2.Ex8.m2.6.6.2.2.2.2.1.1.1.1.1.3.2.2" xref="A2.Ex8.m2.6.6.2.2.2.2.1.1.1.1.1.3.1.cmml">
                   ,
                  </mo>
                  <mi id="A2.Ex8.m2.3.3" xref="A2.Ex8.m2.3.3.cmml">
                   a
                  </mi>
                  <mo id="A2.Ex8.m2.6.6.2.2.2.2.1.1.1.1.1.3.2.3" stretchy="false" xref="A2.Ex8.m2.6.6.2.2.2.2.1.1.1.1.1.3.1.cmml">
                   )
                  </mo>
                 </mrow>
                </mrow>
                <mo id="A2.Ex8.m2.6.6.2.2.2.2.1.1.1.1.3" stretchy="false" xref="A2.Ex8.m2.6.6.2.2.2.2.1.1.1.2.1.cmml">
                 ]
                </mo>
               </mrow>
              </mrow>
              <mo id="A2.Ex8.m2.6.6.2.2.2.2.1.2" xref="A2.Ex8.m2.6.6.2.2.2.2.1.2.cmml">
               −
              </mo>
              <mrow id="A2.Ex8.m2.6.6.2.2.2.2.1.3" xref="A2.Ex8.m2.6.6.2.2.2.2.1.3.cmml">
               <mi id="A2.Ex8.m2.6.6.2.2.2.2.1.3.2" xref="A2.Ex8.m2.6.6.2.2.2.2.1.3.2.cmml">
                β
               </mi>
               <mo id="A2.Ex8.m2.6.6.2.2.2.2.1.3.1" lspace="0em" rspace="0em" xref="A2.Ex8.m2.6.6.2.2.2.2.1.3.1.cmml">
                ​
               </mo>
               <mtext id="A2.Ex8.m2.6.6.2.2.2.2.1.3.3" xref="A2.Ex8.m2.6.6.2.2.2.2.1.3.3a.cmml">
                KL
               </mtext>
               <mo id="A2.Ex8.m2.6.6.2.2.2.2.1.3.1a" lspace="0em" rspace="0em" xref="A2.Ex8.m2.6.6.2.2.2.2.1.3.1.cmml">
                ​
               </mo>
               <mrow id="A2.Ex8.m2.6.6.2.2.2.2.1.3.4.2" xref="A2.Ex8.m2.6.6.2.2.2.2.1.3.cmml">
                <mo id="A2.Ex8.m2.6.6.2.2.2.2.1.3.4.2.1" stretchy="false" xref="A2.Ex8.m2.6.6.2.2.2.2.1.3.cmml">
                 (
                </mo>
                <mi id="A2.Ex8.m2.4.4" xref="A2.Ex8.m2.4.4.cmml">
                 s
                </mi>
                <mo id="A2.Ex8.m2.6.6.2.2.2.2.1.3.4.2.2" stretchy="false" xref="A2.Ex8.m2.6.6.2.2.2.2.1.3.cmml">
                 )
                </mo>
               </mrow>
              </mrow>
             </mrow>
             <mo id="A2.Ex8.m2.6.6.2.2.2.2.3" maxsize="160%" minsize="160%" xref="A2.Ex8.m2.6.6.2.2.3.cmml">
              }
             </mo>
            </mrow>
           </mrow>
          </mrow>
         </mrow>
         <annotation-xml encoding="MathML-Content" id="A2.Ex8.m2.6b">
          <apply id="A2.Ex8.m2.6.6.cmml" xref="A2.Ex8.m2.6.6">
           <eq id="A2.Ex8.m2.6.6.3.cmml" xref="A2.Ex8.m2.6.6.3">
           </eq>
           <csymbol cd="latexml" id="A2.Ex8.m2.6.6.4.cmml" xref="A2.Ex8.m2.6.6.4">
            absent
           </csymbol>
           <apply id="A2.Ex8.m2.6.6.2.cmml" xref="A2.Ex8.m2.6.6.2">
            <arg id="A2.Ex8.m2.6.6.2.3.cmml" xref="A2.Ex8.m2.6.6.2.3">
            </arg>
            <apply id="A2.Ex8.m2.6.6.2.2.3.cmml" xref="A2.Ex8.m2.6.6.2.2.2">
             <apply id="A2.Ex8.m2.5.5.1.1.1.1.cmml" xref="A2.Ex8.m2.5.5.1.1.1.1">
              <csymbol cd="ambiguous" id="A2.Ex8.m2.5.5.1.1.1.1.1.cmml" xref="A2.Ex8.m2.5.5.1.1.1.1">
               subscript
              </csymbol>
              <max id="A2.Ex8.m2.5.5.1.1.1.1.2.cmml" xref="A2.Ex8.m2.5.5.1.1.1.1.2">
              </max>
              <ci id="A2.Ex8.m2.5.5.1.1.1.1.3.cmml" xref="A2.Ex8.m2.5.5.1.1.1.1.3">
               𝜋
              </ci>
             </apply>
             <apply id="A2.Ex8.m2.6.6.2.2.2.2.1.cmml" xref="A2.Ex8.m2.6.6.2.2.2.2.1">
              <minus id="A2.Ex8.m2.6.6.2.2.2.2.1.2.cmml" xref="A2.Ex8.m2.6.6.2.2.2.2.1.2">
              </minus>
              <apply id="A2.Ex8.m2.6.6.2.2.2.2.1.1.cmml" xref="A2.Ex8.m2.6.6.2.2.2.2.1.1">
               <times id="A2.Ex8.m2.6.6.2.2.2.2.1.1.2.cmml" xref="A2.Ex8.m2.6.6.2.2.2.2.1.1.2">
               </times>
               <apply id="A2.Ex8.m2.6.6.2.2.2.2.1.1.3.cmml" xref="A2.Ex8.m2.6.6.2.2.2.2.1.1.3">
                <csymbol cd="ambiguous" id="A2.Ex8.m2.6.6.2.2.2.2.1.1.3.1.cmml" xref="A2.Ex8.m2.6.6.2.2.2.2.1.1.3">
                 subscript
                </csymbol>
                <ci id="A2.Ex8.m2.6.6.2.2.2.2.1.1.3.2.cmml" xref="A2.Ex8.m2.6.6.2.2.2.2.1.1.3.2">
                 𝔼
                </ci>
                <apply id="A2.Ex8.m2.1.1.1.cmml" xref="A2.Ex8.m2.1.1.1">
                 <csymbol cd="latexml" id="A2.Ex8.m2.1.1.1.2.cmml" xref="A2.Ex8.m2.1.1.1.2">
                  similar-to
                 </csymbol>
                 <ci id="A2.Ex8.m2.1.1.1.3.cmml" xref="A2.Ex8.m2.1.1.1.3">
                  𝑎
                 </ci>
                 <apply id="A2.Ex8.m2.1.1.1.4.cmml" xref="A2.Ex8.m2.1.1.1.4">
                  <times id="A2.Ex8.m2.1.1.1.4.1.cmml" xref="A2.Ex8.m2.1.1.1.4.1">
                  </times>
                  <ci id="A2.Ex8.m2.1.1.1.4.2.cmml" xref="A2.Ex8.m2.1.1.1.4.2">
                   𝜋
                  </ci>
                  <ci id="A2.Ex8.m2.1.1.1.1.cmml" xref="A2.Ex8.m2.1.1.1.1">
                   𝑠
                  </ci>
                 </apply>
                </apply>
               </apply>
               <apply id="A2.Ex8.m2.6.6.2.2.2.2.1.1.1.2.cmml" xref="A2.Ex8.m2.6.6.2.2.2.2.1.1.1.1">
                <csymbol cd="latexml" id="A2.Ex8.m2.6.6.2.2.2.2.1.1.1.2.1.cmml" xref="A2.Ex8.m2.6.6.2.2.2.2.1.1.1.1.2">
                 delimited-[]
                </csymbol>
                <apply id="A2.Ex8.m2.6.6.2.2.2.2.1.1.1.1.1.cmml" xref="A2.Ex8.m2.6.6.2.2.2.2.1.1.1.1.1">
                 <times id="A2.Ex8.m2.6.6.2.2.2.2.1.1.1.1.1.1.cmml" xref="A2.Ex8.m2.6.6.2.2.2.2.1.1.1.1.1.1">
                 </times>
                 <ci id="A2.Ex8.m2.6.6.2.2.2.2.1.1.1.1.1.2.cmml" xref="A2.Ex8.m2.6.6.2.2.2.2.1.1.1.1.1.2">
                  𝑄
                 </ci>
                 <interval closure="open" id="A2.Ex8.m2.6.6.2.2.2.2.1.1.1.1.1.3.1.cmml" xref="A2.Ex8.m2.6.6.2.2.2.2.1.1.1.1.1.3.2">
                  <ci id="A2.Ex8.m2.2.2.cmml" xref="A2.Ex8.m2.2.2">
                   𝑠
                  </ci>
                  <ci id="A2.Ex8.m2.3.3.cmml" xref="A2.Ex8.m2.3.3">
                   𝑎
                  </ci>
                 </interval>
                </apply>
               </apply>
              </apply>
              <apply id="A2.Ex8.m2.6.6.2.2.2.2.1.3.cmml" xref="A2.Ex8.m2.6.6.2.2.2.2.1.3">
               <times id="A2.Ex8.m2.6.6.2.2.2.2.1.3.1.cmml" xref="A2.Ex8.m2.6.6.2.2.2.2.1.3.1">
               </times>
               <ci id="A2.Ex8.m2.6.6.2.2.2.2.1.3.2.cmml" xref="A2.Ex8.m2.6.6.2.2.2.2.1.3.2">
                𝛽
               </ci>
               <ci id="A2.Ex8.m2.6.6.2.2.2.2.1.3.3a.cmml" xref="A2.Ex8.m2.6.6.2.2.2.2.1.3.3">
                <mtext id="A2.Ex8.m2.6.6.2.2.2.2.1.3.3.cmml" xref="A2.Ex8.m2.6.6.2.2.2.2.1.3.3">
                 KL
                </mtext>
               </ci>
               <ci id="A2.Ex8.m2.4.4.cmml" xref="A2.Ex8.m2.4.4">
                𝑠
               </ci>
              </apply>
             </apply>
            </apply>
           </apply>
          </apply>
         </annotation-xml>
         <annotation encoding="application/x-tex" id="A2.Ex8.m2.6c">
          \displaystyle=\arg\max_{\pi}\Big{\{}\mathbb{E}_{a\sim\pi(s)}[Q(s,a)]-\beta\text{KL}(s)\Big{\}}
         </annotation>
        </semantics>
       </math>
      </td>
      <td class="ltx_eqn_cell ltx_eqn_center_padright">
      </td>
     </tr>
    </tbody>
    <tbody id="A2.Ex9">
     <tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
      <td class="ltx_eqn_cell ltx_eqn_center_padleft">
      </td>
      <td class="ltx_td ltx_eqn_cell">
      </td>
      <td class="ltx_td ltx_align_left ltx_eqn_cell">
       <math alttext="\displaystyle=\rho(a|s)\exp(Q(s,a)/\beta)/\mathbb{E}_{a^{\prime}\sim\rho(s)}[\exp(Q(s,a^{\prime})/\beta)]." class="ltx_Math" display="inline" id="A2.Ex9.m1.7">
        <semantics id="A2.Ex9.m1.7a">
         <mrow id="A2.Ex9.m1.7.7.1" xref="A2.Ex9.m1.7.7.1.1.cmml">
          <mrow id="A2.Ex9.m1.7.7.1.1" xref="A2.Ex9.m1.7.7.1.1.cmml">
           <mi id="A2.Ex9.m1.7.7.1.1.5" xref="A2.Ex9.m1.7.7.1.1.5.cmml">
           </mi>
           <mo id="A2.Ex9.m1.7.7.1.1.4" xref="A2.Ex9.m1.7.7.1.1.4.cmml">
            =
           </mo>
           <mrow id="A2.Ex9.m1.7.7.1.1.3" xref="A2.Ex9.m1.7.7.1.1.3.cmml">
            <mrow id="A2.Ex9.m1.7.7.1.1.2.2" xref="A2.Ex9.m1.7.7.1.1.2.2.cmml">
             <mrow id="A2.Ex9.m1.7.7.1.1.2.2.2" xref="A2.Ex9.m1.7.7.1.1.2.2.2.cmml">
              <mi id="A2.Ex9.m1.7.7.1.1.2.2.2.4" xref="A2.Ex9.m1.7.7.1.1.2.2.2.4.cmml">
               ρ
              </mi>
              <mo id="A2.Ex9.m1.7.7.1.1.2.2.2.3" lspace="0em" rspace="0em" xref="A2.Ex9.m1.7.7.1.1.2.2.2.3.cmml">
               ​
              </mo>
              <mrow id="A2.Ex9.m1.7.7.1.1.1.1.1.1.1" xref="A2.Ex9.m1.7.7.1.1.1.1.1.1.1.1.cmml">
               <mo id="A2.Ex9.m1.7.7.1.1.1.1.1.1.1.2" stretchy="false" xref="A2.Ex9.m1.7.7.1.1.1.1.1.1.1.1.cmml">
                (
               </mo>
               <mrow id="A2.Ex9.m1.7.7.1.1.1.1.1.1.1.1" xref="A2.Ex9.m1.7.7.1.1.1.1.1.1.1.1.cmml">
                <mi id="A2.Ex9.m1.7.7.1.1.1.1.1.1.1.1.2" xref="A2.Ex9.m1.7.7.1.1.1.1.1.1.1.1.2.cmml">
                 a
                </mi>
                <mo fence="false" id="A2.Ex9.m1.7.7.1.1.1.1.1.1.1.1.1" xref="A2.Ex9.m1.7.7.1.1.1.1.1.1.1.1.1.cmml">
                 |
                </mo>
                <mi id="A2.Ex9.m1.7.7.1.1.1.1.1.1.1.1.3" xref="A2.Ex9.m1.7.7.1.1.1.1.1.1.1.1.3.cmml">
                 s
                </mi>
               </mrow>
               <mo id="A2.Ex9.m1.7.7.1.1.1.1.1.1.1.3" stretchy="false" xref="A2.Ex9.m1.7.7.1.1.1.1.1.1.1.1.cmml">
                )
               </mo>
              </mrow>
              <mo id="A2.Ex9.m1.7.7.1.1.2.2.2.3a" lspace="0.167em" rspace="0em" xref="A2.Ex9.m1.7.7.1.1.2.2.2.3.cmml">
               ​
              </mo>
              <mrow id="A2.Ex9.m1.7.7.1.1.2.2.2.2.1" xref="A2.Ex9.m1.7.7.1.1.2.2.2.2.2.cmml">
               <mi id="A2.Ex9.m1.4.4" xref="A2.Ex9.m1.4.4.cmml">
                exp
               </mi>
               <mo id="A2.Ex9.m1.7.7.1.1.2.2.2.2.1a" xref="A2.Ex9.m1.7.7.1.1.2.2.2.2.2.cmml">
                ⁡
               </mo>
               <mrow id="A2.Ex9.m1.7.7.1.1.2.2.2.2.1.1" xref="A2.Ex9.m1.7.7.1.1.2.2.2.2.2.cmml">
                <mo id="A2.Ex9.m1.7.7.1.1.2.2.2.2.1.1.2" stretchy="false" xref="A2.Ex9.m1.7.7.1.1.2.2.2.2.2.cmml">
                 (
                </mo>
                <mrow id="A2.Ex9.m1.7.7.1.1.2.2.2.2.1.1.1" xref="A2.Ex9.m1.7.7.1.1.2.2.2.2.1.1.1.cmml">
                 <mrow id="A2.Ex9.m1.7.7.1.1.2.2.2.2.1.1.1.2" xref="A2.Ex9.m1.7.7.1.1.2.2.2.2.1.1.1.2.cmml">
                  <mi id="A2.Ex9.m1.7.7.1.1.2.2.2.2.1.1.1.2.2" xref="A2.Ex9.m1.7.7.1.1.2.2.2.2.1.1.1.2.2.cmml">
                   Q
                  </mi>
                  <mo id="A2.Ex9.m1.7.7.1.1.2.2.2.2.1.1.1.2.1" lspace="0em" rspace="0em" xref="A2.Ex9.m1.7.7.1.1.2.2.2.2.1.1.1.2.1.cmml">
                   ​
                  </mo>
                  <mrow id="A2.Ex9.m1.7.7.1.1.2.2.2.2.1.1.1.2.3.2" xref="A2.Ex9.m1.7.7.1.1.2.2.2.2.1.1.1.2.3.1.cmml">
                   <mo id="A2.Ex9.m1.7.7.1.1.2.2.2.2.1.1.1.2.3.2.1" stretchy="false" xref="A2.Ex9.m1.7.7.1.1.2.2.2.2.1.1.1.2.3.1.cmml">
                    (
                   </mo>
                   <mi id="A2.Ex9.m1.2.2" xref="A2.Ex9.m1.2.2.cmml">
                    s
                   </mi>
                   <mo id="A2.Ex9.m1.7.7.1.1.2.2.2.2.1.1.1.2.3.2.2" xref="A2.Ex9.m1.7.7.1.1.2.2.2.2.1.1.1.2.3.1.cmml">
                    ,
                   </mo>
                   <mi id="A2.Ex9.m1.3.3" xref="A2.Ex9.m1.3.3.cmml">
                    a
                   </mi>
                   <mo id="A2.Ex9.m1.7.7.1.1.2.2.2.2.1.1.1.2.3.2.3" stretchy="false" xref="A2.Ex9.m1.7.7.1.1.2.2.2.2.1.1.1.2.3.1.cmml">
                    )
                   </mo>
                  </mrow>
                 </mrow>
                 <mo id="A2.Ex9.m1.7.7.1.1.2.2.2.2.1.1.1.1" xref="A2.Ex9.m1.7.7.1.1.2.2.2.2.1.1.1.1.cmml">
                  /
                 </mo>
                 <mi id="A2.Ex9.m1.7.7.1.1.2.2.2.2.1.1.1.3" xref="A2.Ex9.m1.7.7.1.1.2.2.2.2.1.1.1.3.cmml">
                  β
                 </mi>
                </mrow>
                <mo id="A2.Ex9.m1.7.7.1.1.2.2.2.2.1.1.3" stretchy="false" xref="A2.Ex9.m1.7.7.1.1.2.2.2.2.2.cmml">
                 )
                </mo>
               </mrow>
              </mrow>
             </mrow>
             <mo id="A2.Ex9.m1.7.7.1.1.2.2.3" xref="A2.Ex9.m1.7.7.1.1.2.2.3.cmml">
              /
             </mo>
             <msub id="A2.Ex9.m1.7.7.1.1.2.2.4" xref="A2.Ex9.m1.7.7.1.1.2.2.4.cmml">
              <mi id="A2.Ex9.m1.7.7.1.1.2.2.4.2" xref="A2.Ex9.m1.7.7.1.1.2.2.4.2.cmml">
               𝔼
              </mi>
              <mrow id="A2.Ex9.m1.1.1.1" xref="A2.Ex9.m1.1.1.1.cmml">
               <msup id="A2.Ex9.m1.1.1.1.3" xref="A2.Ex9.m1.1.1.1.3.cmml">
                <mi id="A2.Ex9.m1.1.1.1.3.2" xref="A2.Ex9.m1.1.1.1.3.2.cmml">
                 a
                </mi>
                <mo id="A2.Ex9.m1.1.1.1.3.3" xref="A2.Ex9.m1.1.1.1.3.3.cmml">
                 ′
                </mo>
               </msup>
               <mo id="A2.Ex9.m1.1.1.1.2" xref="A2.Ex9.m1.1.1.1.2.cmml">
                ∼
               </mo>
               <mrow id="A2.Ex9.m1.1.1.1.4" xref="A2.Ex9.m1.1.1.1.4.cmml">
                <mi id="A2.Ex9.m1.1.1.1.4.2" xref="A2.Ex9.m1.1.1.1.4.2.cmml">
                 ρ
                </mi>
                <mo id="A2.Ex9.m1.1.1.1.4.1" lspace="0em" rspace="0em" xref="A2.Ex9.m1.1.1.1.4.1.cmml">
                 ​
                </mo>
                <mrow id="A2.Ex9.m1.1.1.1.4.3.2" xref="A2.Ex9.m1.1.1.1.4.cmml">
                 <mo id="A2.Ex9.m1.1.1.1.4.3.2.1" stretchy="false" xref="A2.Ex9.m1.1.1.1.4.cmml">
                  (
                 </mo>
                 <mi id="A2.Ex9.m1.1.1.1.1" xref="A2.Ex9.m1.1.1.1.1.cmml">
                  s
                 </mi>
                 <mo id="A2.Ex9.m1.1.1.1.4.3.2.2" stretchy="false" xref="A2.Ex9.m1.1.1.1.4.cmml">
                  )
                 </mo>
                </mrow>
               </mrow>
              </mrow>
             </msub>
            </mrow>
            <mo id="A2.Ex9.m1.7.7.1.1.3.4" lspace="0em" rspace="0em" xref="A2.Ex9.m1.7.7.1.1.3.4.cmml">
             ​
            </mo>
            <mrow id="A2.Ex9.m1.7.7.1.1.3.3.1" xref="A2.Ex9.m1.7.7.1.1.3.3.2.cmml">
             <mo id="A2.Ex9.m1.7.7.1.1.3.3.1.2" stretchy="false" xref="A2.Ex9.m1.7.7.1.1.3.3.2.1.cmml">
              [
             </mo>
             <mrow id="A2.Ex9.m1.7.7.1.1.3.3.1.1.1" xref="A2.Ex9.m1.7.7.1.1.3.3.1.1.2.cmml">
              <mi id="A2.Ex9.m1.6.6" xref="A2.Ex9.m1.6.6.cmml">
               exp
              </mi>
              <mo id="A2.Ex9.m1.7.7.1.1.3.3.1.1.1a" xref="A2.Ex9.m1.7.7.1.1.3.3.1.1.2.cmml">
               ⁡
              </mo>
              <mrow id="A2.Ex9.m1.7.7.1.1.3.3.1.1.1.1" xref="A2.Ex9.m1.7.7.1.1.3.3.1.1.2.cmml">
               <mo id="A2.Ex9.m1.7.7.1.1.3.3.1.1.1.1.2" stretchy="false" xref="A2.Ex9.m1.7.7.1.1.3.3.1.1.2.cmml">
                (
               </mo>
               <mrow id="A2.Ex9.m1.7.7.1.1.3.3.1.1.1.1.1" xref="A2.Ex9.m1.7.7.1.1.3.3.1.1.1.1.1.cmml">
                <mrow id="A2.Ex9.m1.7.7.1.1.3.3.1.1.1.1.1.1" xref="A2.Ex9.m1.7.7.1.1.3.3.1.1.1.1.1.1.cmml">
                 <mi id="A2.Ex9.m1.7.7.1.1.3.3.1.1.1.1.1.1.3" xref="A2.Ex9.m1.7.7.1.1.3.3.1.1.1.1.1.1.3.cmml">
                  Q
                 </mi>
                 <mo id="A2.Ex9.m1.7.7.1.1.3.3.1.1.1.1.1.1.2" lspace="0em" rspace="0em" xref="A2.Ex9.m1.7.7.1.1.3.3.1.1.1.1.1.1.2.cmml">
                  ​
                 </mo>
                 <mrow id="A2.Ex9.m1.7.7.1.1.3.3.1.1.1.1.1.1.1.1" xref="A2.Ex9.m1.7.7.1.1.3.3.1.1.1.1.1.1.1.2.cmml">
                  <mo id="A2.Ex9.m1.7.7.1.1.3.3.1.1.1.1.1.1.1.1.2" stretchy="false" xref="A2.Ex9.m1.7.7.1.1.3.3.1.1.1.1.1.1.1.2.cmml">
                   (
                  </mo>
                  <mi id="A2.Ex9.m1.5.5" xref="A2.Ex9.m1.5.5.cmml">
                   s
                  </mi>
                  <mo id="A2.Ex9.m1.7.7.1.1.3.3.1.1.1.1.1.1.1.1.3" xref="A2.Ex9.m1.7.7.1.1.3.3.1.1.1.1.1.1.1.2.cmml">
                   ,
                  </mo>
                  <msup id="A2.Ex9.m1.7.7.1.1.3.3.1.1.1.1.1.1.1.1.1" xref="A2.Ex9.m1.7.7.1.1.3.3.1.1.1.1.1.1.1.1.1.cmml">
                   <mi id="A2.Ex9.m1.7.7.1.1.3.3.1.1.1.1.1.1.1.1.1.2" xref="A2.Ex9.m1.7.7.1.1.3.3.1.1.1.1.1.1.1.1.1.2.cmml">
                    a
                   </mi>
                   <mo id="A2.Ex9.m1.7.7.1.1.3.3.1.1.1.1.1.1.1.1.1.3" xref="A2.Ex9.m1.7.7.1.1.3.3.1.1.1.1.1.1.1.1.1.3.cmml">
                    ′
                   </mo>
                  </msup>
                  <mo id="A2.Ex9.m1.7.7.1.1.3.3.1.1.1.1.1.1.1.1.4" stretchy="false" xref="A2.Ex9.m1.7.7.1.1.3.3.1.1.1.1.1.1.1.2.cmml">
                   )
                  </mo>
                 </mrow>
                </mrow>
                <mo id="A2.Ex9.m1.7.7.1.1.3.3.1.1.1.1.1.2" xref="A2.Ex9.m1.7.7.1.1.3.3.1.1.1.1.1.2.cmml">
                 /
                </mo>
                <mi id="A2.Ex9.m1.7.7.1.1.3.3.1.1.1.1.1.3" xref="A2.Ex9.m1.7.7.1.1.3.3.1.1.1.1.1.3.cmml">
                 β
                </mi>
               </mrow>
               <mo id="A2.Ex9.m1.7.7.1.1.3.3.1.1.1.1.3" stretchy="false" xref="A2.Ex9.m1.7.7.1.1.3.3.1.1.2.cmml">
                )
               </mo>
              </mrow>
             </mrow>
             <mo id="A2.Ex9.m1.7.7.1.1.3.3.1.3" stretchy="false" xref="A2.Ex9.m1.7.7.1.1.3.3.2.1.cmml">
              ]
             </mo>
            </mrow>
           </mrow>
          </mrow>
          <mo id="A2.Ex9.m1.7.7.1.2" lspace="0em" xref="A2.Ex9.m1.7.7.1.1.cmml">
           .
          </mo>
         </mrow>
         <annotation-xml encoding="MathML-Content" id="A2.Ex9.m1.7b">
          <apply id="A2.Ex9.m1.7.7.1.1.cmml" xref="A2.Ex9.m1.7.7.1">
           <eq id="A2.Ex9.m1.7.7.1.1.4.cmml" xref="A2.Ex9.m1.7.7.1.1.4">
           </eq>
           <csymbol cd="latexml" id="A2.Ex9.m1.7.7.1.1.5.cmml" xref="A2.Ex9.m1.7.7.1.1.5">
            absent
           </csymbol>
           <apply id="A2.Ex9.m1.7.7.1.1.3.cmml" xref="A2.Ex9.m1.7.7.1.1.3">
            <times id="A2.Ex9.m1.7.7.1.1.3.4.cmml" xref="A2.Ex9.m1.7.7.1.1.3.4">
            </times>
            <apply id="A2.Ex9.m1.7.7.1.1.2.2.cmml" xref="A2.Ex9.m1.7.7.1.1.2.2">
             <divide id="A2.Ex9.m1.7.7.1.1.2.2.3.cmml" xref="A2.Ex9.m1.7.7.1.1.2.2.3">
             </divide>
             <apply id="A2.Ex9.m1.7.7.1.1.2.2.2.cmml" xref="A2.Ex9.m1.7.7.1.1.2.2.2">
              <times id="A2.Ex9.m1.7.7.1.1.2.2.2.3.cmml" xref="A2.Ex9.m1.7.7.1.1.2.2.2.3">
              </times>
              <ci id="A2.Ex9.m1.7.7.1.1.2.2.2.4.cmml" xref="A2.Ex9.m1.7.7.1.1.2.2.2.4">
               𝜌
              </ci>
              <apply id="A2.Ex9.m1.7.7.1.1.1.1.1.1.1.1.cmml" xref="A2.Ex9.m1.7.7.1.1.1.1.1.1.1">
               <csymbol cd="latexml" id="A2.Ex9.m1.7.7.1.1.1.1.1.1.1.1.1.cmml" xref="A2.Ex9.m1.7.7.1.1.1.1.1.1.1.1.1">
                conditional
               </csymbol>
               <ci id="A2.Ex9.m1.7.7.1.1.1.1.1.1.1.1.2.cmml" xref="A2.Ex9.m1.7.7.1.1.1.1.1.1.1.1.2">
                𝑎
               </ci>
               <ci id="A2.Ex9.m1.7.7.1.1.1.1.1.1.1.1.3.cmml" xref="A2.Ex9.m1.7.7.1.1.1.1.1.1.1.1.3">
                𝑠
               </ci>
              </apply>
              <apply id="A2.Ex9.m1.7.7.1.1.2.2.2.2.2.cmml" xref="A2.Ex9.m1.7.7.1.1.2.2.2.2.1">
               <exp id="A2.Ex9.m1.4.4.cmml" xref="A2.Ex9.m1.4.4">
               </exp>
               <apply id="A2.Ex9.m1.7.7.1.1.2.2.2.2.1.1.1.cmml" xref="A2.Ex9.m1.7.7.1.1.2.2.2.2.1.1.1">
                <divide id="A2.Ex9.m1.7.7.1.1.2.2.2.2.1.1.1.1.cmml" xref="A2.Ex9.m1.7.7.1.1.2.2.2.2.1.1.1.1">
                </divide>
                <apply id="A2.Ex9.m1.7.7.1.1.2.2.2.2.1.1.1.2.cmml" xref="A2.Ex9.m1.7.7.1.1.2.2.2.2.1.1.1.2">
                 <times id="A2.Ex9.m1.7.7.1.1.2.2.2.2.1.1.1.2.1.cmml" xref="A2.Ex9.m1.7.7.1.1.2.2.2.2.1.1.1.2.1">
                 </times>
                 <ci id="A2.Ex9.m1.7.7.1.1.2.2.2.2.1.1.1.2.2.cmml" xref="A2.Ex9.m1.7.7.1.1.2.2.2.2.1.1.1.2.2">
                  𝑄
                 </ci>
                 <interval closure="open" id="A2.Ex9.m1.7.7.1.1.2.2.2.2.1.1.1.2.3.1.cmml" xref="A2.Ex9.m1.7.7.1.1.2.2.2.2.1.1.1.2.3.2">
                  <ci id="A2.Ex9.m1.2.2.cmml" xref="A2.Ex9.m1.2.2">
                   𝑠
                  </ci>
                  <ci id="A2.Ex9.m1.3.3.cmml" xref="A2.Ex9.m1.3.3">
                   𝑎
                  </ci>
                 </interval>
                </apply>
                <ci id="A2.Ex9.m1.7.7.1.1.2.2.2.2.1.1.1.3.cmml" xref="A2.Ex9.m1.7.7.1.1.2.2.2.2.1.1.1.3">
                 𝛽
                </ci>
               </apply>
              </apply>
             </apply>
             <apply id="A2.Ex9.m1.7.7.1.1.2.2.4.cmml" xref="A2.Ex9.m1.7.7.1.1.2.2.4">
              <csymbol cd="ambiguous" id="A2.Ex9.m1.7.7.1.1.2.2.4.1.cmml" xref="A2.Ex9.m1.7.7.1.1.2.2.4">
               subscript
              </csymbol>
              <ci id="A2.Ex9.m1.7.7.1.1.2.2.4.2.cmml" xref="A2.Ex9.m1.7.7.1.1.2.2.4.2">
               𝔼
              </ci>
              <apply id="A2.Ex9.m1.1.1.1.cmml" xref="A2.Ex9.m1.1.1.1">
               <csymbol cd="latexml" id="A2.Ex9.m1.1.1.1.2.cmml" xref="A2.Ex9.m1.1.1.1.2">
                similar-to
               </csymbol>
               <apply id="A2.Ex9.m1.1.1.1.3.cmml" xref="A2.Ex9.m1.1.1.1.3">
                <csymbol cd="ambiguous" id="A2.Ex9.m1.1.1.1.3.1.cmml" xref="A2.Ex9.m1.1.1.1.3">
                 superscript
                </csymbol>
                <ci id="A2.Ex9.m1.1.1.1.3.2.cmml" xref="A2.Ex9.m1.1.1.1.3.2">
                 𝑎
                </ci>
                <ci id="A2.Ex9.m1.1.1.1.3.3.cmml" xref="A2.Ex9.m1.1.1.1.3.3">
                 ′
                </ci>
               </apply>
               <apply id="A2.Ex9.m1.1.1.1.4.cmml" xref="A2.Ex9.m1.1.1.1.4">
                <times id="A2.Ex9.m1.1.1.1.4.1.cmml" xref="A2.Ex9.m1.1.1.1.4.1">
                </times>
                <ci id="A2.Ex9.m1.1.1.1.4.2.cmml" xref="A2.Ex9.m1.1.1.1.4.2">
                 𝜌
                </ci>
                <ci id="A2.Ex9.m1.1.1.1.1.cmml" xref="A2.Ex9.m1.1.1.1.1">
                 𝑠
                </ci>
               </apply>
              </apply>
             </apply>
            </apply>
            <apply id="A2.Ex9.m1.7.7.1.1.3.3.2.cmml" xref="A2.Ex9.m1.7.7.1.1.3.3.1">
             <csymbol cd="latexml" id="A2.Ex9.m1.7.7.1.1.3.3.2.1.cmml" xref="A2.Ex9.m1.7.7.1.1.3.3.1.2">
              delimited-[]
             </csymbol>
             <apply id="A2.Ex9.m1.7.7.1.1.3.3.1.1.2.cmml" xref="A2.Ex9.m1.7.7.1.1.3.3.1.1.1">
              <exp id="A2.Ex9.m1.6.6.cmml" xref="A2.Ex9.m1.6.6">
              </exp>
              <apply id="A2.Ex9.m1.7.7.1.1.3.3.1.1.1.1.1.cmml" xref="A2.Ex9.m1.7.7.1.1.3.3.1.1.1.1.1">
               <divide id="A2.Ex9.m1.7.7.1.1.3.3.1.1.1.1.1.2.cmml" xref="A2.Ex9.m1.7.7.1.1.3.3.1.1.1.1.1.2">
               </divide>
               <apply id="A2.Ex9.m1.7.7.1.1.3.3.1.1.1.1.1.1.cmml" xref="A2.Ex9.m1.7.7.1.1.3.3.1.1.1.1.1.1">
                <times id="A2.Ex9.m1.7.7.1.1.3.3.1.1.1.1.1.1.2.cmml" xref="A2.Ex9.m1.7.7.1.1.3.3.1.1.1.1.1.1.2">
                </times>
                <ci id="A2.Ex9.m1.7.7.1.1.3.3.1.1.1.1.1.1.3.cmml" xref="A2.Ex9.m1.7.7.1.1.3.3.1.1.1.1.1.1.3">
                 𝑄
                </ci>
                <interval closure="open" id="A2.Ex9.m1.7.7.1.1.3.3.1.1.1.1.1.1.1.2.cmml" xref="A2.Ex9.m1.7.7.1.1.3.3.1.1.1.1.1.1.1.1">
                 <ci id="A2.Ex9.m1.5.5.cmml" xref="A2.Ex9.m1.5.5">
                  𝑠
                 </ci>
                 <apply id="A2.Ex9.m1.7.7.1.1.3.3.1.1.1.1.1.1.1.1.1.cmml" xref="A2.Ex9.m1.7.7.1.1.3.3.1.1.1.1.1.1.1.1.1">
                  <csymbol cd="ambiguous" id="A2.Ex9.m1.7.7.1.1.3.3.1.1.1.1.1.1.1.1.1.1.cmml" xref="A2.Ex9.m1.7.7.1.1.3.3.1.1.1.1.1.1.1.1.1">
                   superscript
                  </csymbol>
                  <ci id="A2.Ex9.m1.7.7.1.1.3.3.1.1.1.1.1.1.1.1.1.2.cmml" xref="A2.Ex9.m1.7.7.1.1.3.3.1.1.1.1.1.1.1.1.1.2">
                   𝑎
                  </ci>
                  <ci id="A2.Ex9.m1.7.7.1.1.3.3.1.1.1.1.1.1.1.1.1.3.cmml" xref="A2.Ex9.m1.7.7.1.1.3.3.1.1.1.1.1.1.1.1.1.3">
                   ′
                  </ci>
                 </apply>
                </interval>
               </apply>
               <ci id="A2.Ex9.m1.7.7.1.1.3.3.1.1.1.1.1.3.cmml" xref="A2.Ex9.m1.7.7.1.1.3.3.1.1.1.1.1.3">
                𝛽
               </ci>
              </apply>
             </apply>
            </apply>
           </apply>
          </apply>
         </annotation-xml>
         <annotation encoding="application/x-tex" id="A2.Ex9.m1.7c">
          \displaystyle=\rho(a|s)\exp(Q(s,a)/\beta)/\mathbb{E}_{a^{\prime}\sim\rho(s)}[\exp(Q(s,a^{\prime})/\beta)].
         </annotation>
        </semantics>
       </math>
      </td>
      <td class="ltx_eqn_cell ltx_eqn_center_padright">
      </td>
     </tr>
    </tbody>
   </table>
  </div>
  <div class="ltx_para" id="A2.p2">
   <p class="ltx_p" id="A2.p2.1">
    Recall Eq.
    <a class="ltx_ref" href="#A1.E13" title="Equation 13 ‣ Appendix A Proof of Optimization Consistency ‣ Entropy-Regularized Token-Level Policy Optimization for Large Language Models">
     <span class="ltx_text ltx_ref_tag">
      13
     </span>
    </a>
    , the optimal soft policy can also be extended to token level:
   </p>
   <table class="ltx_equationgroup ltx_eqn_align ltx_eqn_table" id="A7.EGx16">
    <tbody id="A2.Ex10">
     <tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
      <td class="ltx_eqn_cell ltx_eqn_center_padleft">
      </td>
      <td class="ltx_td ltx_align_right ltx_eqn_cell">
       <math alttext="\displaystyle\pi^{*}(w_{j}|s,w_{1:j-1})=\rho(w_{j}|s,w_{1:j-1})\exp(Q(s,w_{1:j-1},w_{j})/\beta)/\mathbb{E}_{\bar{w}_{j}\sim\rho(s,w_{1:j-1})}[\exp(Q(s,w_{1:j-1},\bar{w}_{j})/\beta)]" class="ltx_Math" display="inline" id="A2.Ex10.m1.12">
        <semantics id="A2.Ex10.m1.12a">
         <mrow id="A2.Ex10.m1.12.12" xref="A2.Ex10.m1.12.12.cmml">
          <mrow id="A2.Ex10.m1.9.9.1" xref="A2.Ex10.m1.9.9.1.cmml">
           <msup id="A2.Ex10.m1.9.9.1.3" xref="A2.Ex10.m1.9.9.1.3.cmml">
            <mi id="A2.Ex10.m1.9.9.1.3.2" xref="A2.Ex10.m1.9.9.1.3.2.cmml">
             π
            </mi>
            <mo id="A2.Ex10.m1.9.9.1.3.3" xref="A2.Ex10.m1.9.9.1.3.3.cmml">
             ∗
            </mo>
           </msup>
           <mo id="A2.Ex10.m1.9.9.1.2" lspace="0em" rspace="0em" xref="A2.Ex10.m1.9.9.1.2.cmml">
            ​
           </mo>
           <mrow id="A2.Ex10.m1.9.9.1.1.1" xref="A2.Ex10.m1.9.9.1.1.1.1.cmml">
            <mo id="A2.Ex10.m1.9.9.1.1.1.2" stretchy="false" xref="A2.Ex10.m1.9.9.1.1.1.1.cmml">
             (
            </mo>
            <mrow id="A2.Ex10.m1.9.9.1.1.1.1" xref="A2.Ex10.m1.9.9.1.1.1.1.cmml">
             <msub id="A2.Ex10.m1.9.9.1.1.1.1.3" xref="A2.Ex10.m1.9.9.1.1.1.1.3.cmml">
              <mi id="A2.Ex10.m1.9.9.1.1.1.1.3.2" xref="A2.Ex10.m1.9.9.1.1.1.1.3.2.cmml">
               w
              </mi>
              <mi id="A2.Ex10.m1.9.9.1.1.1.1.3.3" xref="A2.Ex10.m1.9.9.1.1.1.1.3.3.cmml">
               j
              </mi>
             </msub>
             <mo fence="false" id="A2.Ex10.m1.9.9.1.1.1.1.2" xref="A2.Ex10.m1.9.9.1.1.1.1.2.cmml">
              |
             </mo>
             <mrow id="A2.Ex10.m1.9.9.1.1.1.1.1.1" xref="A2.Ex10.m1.9.9.1.1.1.1.1.2.cmml">
              <mi id="A2.Ex10.m1.3.3" xref="A2.Ex10.m1.3.3.cmml">
               s
              </mi>
              <mo id="A2.Ex10.m1.9.9.1.1.1.1.1.1.2" xref="A2.Ex10.m1.9.9.1.1.1.1.1.2.cmml">
               ,
              </mo>
              <msub id="A2.Ex10.m1.9.9.1.1.1.1.1.1.1" xref="A2.Ex10.m1.9.9.1.1.1.1.1.1.1.cmml">
               <mi id="A2.Ex10.m1.9.9.1.1.1.1.1.1.1.2" xref="A2.Ex10.m1.9.9.1.1.1.1.1.1.1.2.cmml">
                w
               </mi>
               <mrow id="A2.Ex10.m1.9.9.1.1.1.1.1.1.1.3" xref="A2.Ex10.m1.9.9.1.1.1.1.1.1.1.3.cmml">
                <mn id="A2.Ex10.m1.9.9.1.1.1.1.1.1.1.3.2" xref="A2.Ex10.m1.9.9.1.1.1.1.1.1.1.3.2.cmml">
                 1
                </mn>
                <mo id="A2.Ex10.m1.9.9.1.1.1.1.1.1.1.3.1" lspace="0.278em" rspace="0.278em" xref="A2.Ex10.m1.9.9.1.1.1.1.1.1.1.3.1.cmml">
                 :
                </mo>
                <mrow id="A2.Ex10.m1.9.9.1.1.1.1.1.1.1.3.3" xref="A2.Ex10.m1.9.9.1.1.1.1.1.1.1.3.3.cmml">
                 <mi id="A2.Ex10.m1.9.9.1.1.1.1.1.1.1.3.3.2" xref="A2.Ex10.m1.9.9.1.1.1.1.1.1.1.3.3.2.cmml">
                  j
                 </mi>
                 <mo id="A2.Ex10.m1.9.9.1.1.1.1.1.1.1.3.3.1" xref="A2.Ex10.m1.9.9.1.1.1.1.1.1.1.3.3.1.cmml">
                  −
                 </mo>
                 <mn id="A2.Ex10.m1.9.9.1.1.1.1.1.1.1.3.3.3" xref="A2.Ex10.m1.9.9.1.1.1.1.1.1.1.3.3.3.cmml">
                  1
                 </mn>
                </mrow>
               </mrow>
              </msub>
             </mrow>
            </mrow>
            <mo id="A2.Ex10.m1.9.9.1.1.1.3" stretchy="false" xref="A2.Ex10.m1.9.9.1.1.1.1.cmml">
             )
            </mo>
           </mrow>
          </mrow>
          <mo id="A2.Ex10.m1.12.12.5" xref="A2.Ex10.m1.12.12.5.cmml">
           =
          </mo>
          <mrow id="A2.Ex10.m1.12.12.4" xref="A2.Ex10.m1.12.12.4.cmml">
           <mrow id="A2.Ex10.m1.11.11.3.2" xref="A2.Ex10.m1.11.11.3.2.cmml">
            <mrow id="A2.Ex10.m1.11.11.3.2.2" xref="A2.Ex10.m1.11.11.3.2.2.cmml">
             <mi id="A2.Ex10.m1.11.11.3.2.2.4" xref="A2.Ex10.m1.11.11.3.2.2.4.cmml">
              ρ
             </mi>
             <mo id="A2.Ex10.m1.11.11.3.2.2.3" lspace="0em" rspace="0em" xref="A2.Ex10.m1.11.11.3.2.2.3.cmml">
              ​
             </mo>
             <mrow id="A2.Ex10.m1.10.10.2.1.1.1.1" xref="A2.Ex10.m1.10.10.2.1.1.1.1.1.cmml">
              <mo id="A2.Ex10.m1.10.10.2.1.1.1.1.2" stretchy="false" xref="A2.Ex10.m1.10.10.2.1.1.1.1.1.cmml">
               (
              </mo>
              <mrow id="A2.Ex10.m1.10.10.2.1.1.1.1.1" xref="A2.Ex10.m1.10.10.2.1.1.1.1.1.cmml">
               <msub id="A2.Ex10.m1.10.10.2.1.1.1.1.1.3" xref="A2.Ex10.m1.10.10.2.1.1.1.1.1.3.cmml">
                <mi id="A2.Ex10.m1.10.10.2.1.1.1.1.1.3.2" xref="A2.Ex10.m1.10.10.2.1.1.1.1.1.3.2.cmml">
                 w
                </mi>
                <mi id="A2.Ex10.m1.10.10.2.1.1.1.1.1.3.3" xref="A2.Ex10.m1.10.10.2.1.1.1.1.1.3.3.cmml">
                 j
                </mi>
               </msub>
               <mo fence="false" id="A2.Ex10.m1.10.10.2.1.1.1.1.1.2" xref="A2.Ex10.m1.10.10.2.1.1.1.1.1.2.cmml">
                |
               </mo>
               <mrow id="A2.Ex10.m1.10.10.2.1.1.1.1.1.1.1" xref="A2.Ex10.m1.10.10.2.1.1.1.1.1.1.2.cmml">
                <mi id="A2.Ex10.m1.4.4" xref="A2.Ex10.m1.4.4.cmml">
                 s
                </mi>
                <mo id="A2.Ex10.m1.10.10.2.1.1.1.1.1.1.1.2" xref="A2.Ex10.m1.10.10.2.1.1.1.1.1.1.2.cmml">
                 ,
                </mo>
                <msub id="A2.Ex10.m1.10.10.2.1.1.1.1.1.1.1.1" xref="A2.Ex10.m1.10.10.2.1.1.1.1.1.1.1.1.cmml">
                 <mi id="A2.Ex10.m1.10.10.2.1.1.1.1.1.1.1.1.2" xref="A2.Ex10.m1.10.10.2.1.1.1.1.1.1.1.1.2.cmml">
                  w
                 </mi>
                 <mrow id="A2.Ex10.m1.10.10.2.1.1.1.1.1.1.1.1.3" xref="A2.Ex10.m1.10.10.2.1.1.1.1.1.1.1.1.3.cmml">
                  <mn id="A2.Ex10.m1.10.10.2.1.1.1.1.1.1.1.1.3.2" xref="A2.Ex10.m1.10.10.2.1.1.1.1.1.1.1.1.3.2.cmml">
                   1
                  </mn>
                  <mo id="A2.Ex10.m1.10.10.2.1.1.1.1.1.1.1.1.3.1" lspace="0.278em" rspace="0.278em" xref="A2.Ex10.m1.10.10.2.1.1.1.1.1.1.1.1.3.1.cmml">
                   :
                  </mo>
                  <mrow id="A2.Ex10.m1.10.10.2.1.1.1.1.1.1.1.1.3.3" xref="A2.Ex10.m1.10.10.2.1.1.1.1.1.1.1.1.3.3.cmml">
                   <mi id="A2.Ex10.m1.10.10.2.1.1.1.1.1.1.1.1.3.3.2" xref="A2.Ex10.m1.10.10.2.1.1.1.1.1.1.1.1.3.3.2.cmml">
                    j
                   </mi>
                   <mo id="A2.Ex10.m1.10.10.2.1.1.1.1.1.1.1.1.3.3.1" xref="A2.Ex10.m1.10.10.2.1.1.1.1.1.1.1.1.3.3.1.cmml">
                    −
                   </mo>
                   <mn id="A2.Ex10.m1.10.10.2.1.1.1.1.1.1.1.1.3.3.3" xref="A2.Ex10.m1.10.10.2.1.1.1.1.1.1.1.1.3.3.3.cmml">
                    1
                   </mn>
                  </mrow>
                 </mrow>
                </msub>
               </mrow>
              </mrow>
              <mo id="A2.Ex10.m1.10.10.2.1.1.1.1.3" stretchy="false" xref="A2.Ex10.m1.10.10.2.1.1.1.1.1.cmml">
               )
              </mo>
             </mrow>
             <mo id="A2.Ex10.m1.11.11.3.2.2.3a" lspace="0.167em" rspace="0em" xref="A2.Ex10.m1.11.11.3.2.2.3.cmml">
              ​
             </mo>
             <mrow id="A2.Ex10.m1.11.11.3.2.2.2.1" xref="A2.Ex10.m1.11.11.3.2.2.2.2.cmml">
              <mi id="A2.Ex10.m1.6.6" xref="A2.Ex10.m1.6.6.cmml">
               exp
              </mi>
              <mo id="A2.Ex10.m1.11.11.3.2.2.2.1a" xref="A2.Ex10.m1.11.11.3.2.2.2.2.cmml">
               ⁡
              </mo>
              <mrow id="A2.Ex10.m1.11.11.3.2.2.2.1.1" xref="A2.Ex10.m1.11.11.3.2.2.2.2.cmml">
               <mo id="A2.Ex10.m1.11.11.3.2.2.2.1.1.2" stretchy="false" xref="A2.Ex10.m1.11.11.3.2.2.2.2.cmml">
                (
               </mo>
               <mrow id="A2.Ex10.m1.11.11.3.2.2.2.1.1.1" xref="A2.Ex10.m1.11.11.3.2.2.2.1.1.1.cmml">
                <mrow id="A2.Ex10.m1.11.11.3.2.2.2.1.1.1.2" xref="A2.Ex10.m1.11.11.3.2.2.2.1.1.1.2.cmml">
                 <mi id="A2.Ex10.m1.11.11.3.2.2.2.1.1.1.2.4" xref="A2.Ex10.m1.11.11.3.2.2.2.1.1.1.2.4.cmml">
                  Q
                 </mi>
                 <mo id="A2.Ex10.m1.11.11.3.2.2.2.1.1.1.2.3" lspace="0em" rspace="0em" xref="A2.Ex10.m1.11.11.3.2.2.2.1.1.1.2.3.cmml">
                  ​
                 </mo>
                 <mrow id="A2.Ex10.m1.11.11.3.2.2.2.1.1.1.2.2.2" xref="A2.Ex10.m1.11.11.3.2.2.2.1.1.1.2.2.3.cmml">
                  <mo id="A2.Ex10.m1.11.11.3.2.2.2.1.1.1.2.2.2.3" stretchy="false" xref="A2.Ex10.m1.11.11.3.2.2.2.1.1.1.2.2.3.cmml">
                   (
                  </mo>
                  <mi id="A2.Ex10.m1.5.5" xref="A2.Ex10.m1.5.5.cmml">
                   s
                  </mi>
                  <mo id="A2.Ex10.m1.11.11.3.2.2.2.1.1.1.2.2.2.4" xref="A2.Ex10.m1.11.11.3.2.2.2.1.1.1.2.2.3.cmml">
                   ,
                  </mo>
                  <msub id="A2.Ex10.m1.11.11.3.2.2.2.1.1.1.1.1.1.1" xref="A2.Ex10.m1.11.11.3.2.2.2.1.1.1.1.1.1.1.cmml">
                   <mi id="A2.Ex10.m1.11.11.3.2.2.2.1.1.1.1.1.1.1.2" xref="A2.Ex10.m1.11.11.3.2.2.2.1.1.1.1.1.1.1.2.cmml">
                    w
                   </mi>
                   <mrow id="A2.Ex10.m1.11.11.3.2.2.2.1.1.1.1.1.1.1.3" xref="A2.Ex10.m1.11.11.3.2.2.2.1.1.1.1.1.1.1.3.cmml">
                    <mn id="A2.Ex10.m1.11.11.3.2.2.2.1.1.1.1.1.1.1.3.2" xref="A2.Ex10.m1.11.11.3.2.2.2.1.1.1.1.1.1.1.3.2.cmml">
                     1
                    </mn>
                    <mo id="A2.Ex10.m1.11.11.3.2.2.2.1.1.1.1.1.1.1.3.1" lspace="0.278em" rspace="0.278em" xref="A2.Ex10.m1.11.11.3.2.2.2.1.1.1.1.1.1.1.3.1.cmml">
                     :
                    </mo>
                    <mrow id="A2.Ex10.m1.11.11.3.2.2.2.1.1.1.1.1.1.1.3.3" xref="A2.Ex10.m1.11.11.3.2.2.2.1.1.1.1.1.1.1.3.3.cmml">
                     <mi id="A2.Ex10.m1.11.11.3.2.2.2.1.1.1.1.1.1.1.3.3.2" xref="A2.Ex10.m1.11.11.3.2.2.2.1.1.1.1.1.1.1.3.3.2.cmml">
                      j
                     </mi>
                     <mo id="A2.Ex10.m1.11.11.3.2.2.2.1.1.1.1.1.1.1.3.3.1" xref="A2.Ex10.m1.11.11.3.2.2.2.1.1.1.1.1.1.1.3.3.1.cmml">
                      −
                     </mo>
                     <mn id="A2.Ex10.m1.11.11.3.2.2.2.1.1.1.1.1.1.1.3.3.3" xref="A2.Ex10.m1.11.11.3.2.2.2.1.1.1.1.1.1.1.3.3.3.cmml">
                      1
                     </mn>
                    </mrow>
                   </mrow>
                  </msub>
                  <mo id="A2.Ex10.m1.11.11.3.2.2.2.1.1.1.2.2.2.5" xref="A2.Ex10.m1.11.11.3.2.2.2.1.1.1.2.2.3.cmml">
                   ,
                  </mo>
                  <msub id="A2.Ex10.m1.11.11.3.2.2.2.1.1.1.2.2.2.2" xref="A2.Ex10.m1.11.11.3.2.2.2.1.1.1.2.2.2.2.cmml">
                   <mi id="A2.Ex10.m1.11.11.3.2.2.2.1.1.1.2.2.2.2.2" xref="A2.Ex10.m1.11.11.3.2.2.2.1.1.1.2.2.2.2.2.cmml">
                    w
                   </mi>
                   <mi id="A2.Ex10.m1.11.11.3.2.2.2.1.1.1.2.2.2.2.3" xref="A2.Ex10.m1.11.11.3.2.2.2.1.1.1.2.2.2.2.3.cmml">
                    j
                   </mi>
                  </msub>
                  <mo id="A2.Ex10.m1.11.11.3.2.2.2.1.1.1.2.2.2.6" stretchy="false" xref="A2.Ex10.m1.11.11.3.2.2.2.1.1.1.2.2.3.cmml">
                   )
                  </mo>
                 </mrow>
                </mrow>
                <mo id="A2.Ex10.m1.11.11.3.2.2.2.1.1.1.3" xref="A2.Ex10.m1.11.11.3.2.2.2.1.1.1.3.cmml">
                 /
                </mo>
                <mi id="A2.Ex10.m1.11.11.3.2.2.2.1.1.1.4" xref="A2.Ex10.m1.11.11.3.2.2.2.1.1.1.4.cmml">
                 β
                </mi>
               </mrow>
               <mo id="A2.Ex10.m1.11.11.3.2.2.2.1.1.3" stretchy="false" xref="A2.Ex10.m1.11.11.3.2.2.2.2.cmml">
                )
               </mo>
              </mrow>
             </mrow>
            </mrow>
            <mo id="A2.Ex10.m1.11.11.3.2.3" xref="A2.Ex10.m1.11.11.3.2.3.cmml">
             /
            </mo>
            <msub id="A2.Ex10.m1.11.11.3.2.4" xref="A2.Ex10.m1.11.11.3.2.4.cmml">
             <mi id="A2.Ex10.m1.11.11.3.2.4.2" xref="A2.Ex10.m1.11.11.3.2.4.2.cmml">
              𝔼
             </mi>
             <mrow id="A2.Ex10.m1.2.2.2" xref="A2.Ex10.m1.2.2.2.cmml">
              <msub id="A2.Ex10.m1.2.2.2.4" xref="A2.Ex10.m1.2.2.2.4.cmml">
               <mover accent="true" id="A2.Ex10.m1.2.2.2.4.2" xref="A2.Ex10.m1.2.2.2.4.2.cmml">
                <mi id="A2.Ex10.m1.2.2.2.4.2.2" xref="A2.Ex10.m1.2.2.2.4.2.2.cmml">
                 w
                </mi>
                <mo id="A2.Ex10.m1.2.2.2.4.2.1" xref="A2.Ex10.m1.2.2.2.4.2.1.cmml">
                 ¯
                </mo>
               </mover>
               <mi id="A2.Ex10.m1.2.2.2.4.3" xref="A2.Ex10.m1.2.2.2.4.3.cmml">
                j
               </mi>
              </msub>
              <mo id="A2.Ex10.m1.2.2.2.3" xref="A2.Ex10.m1.2.2.2.3.cmml">
               ∼
              </mo>
              <mrow id="A2.Ex10.m1.2.2.2.2" xref="A2.Ex10.m1.2.2.2.2.cmml">
               <mi id="A2.Ex10.m1.2.2.2.2.3" xref="A2.Ex10.m1.2.2.2.2.3.cmml">
                ρ
               </mi>
               <mo id="A2.Ex10.m1.2.2.2.2.2" lspace="0em" rspace="0em" xref="A2.Ex10.m1.2.2.2.2.2.cmml">
                ​
               </mo>
               <mrow id="A2.Ex10.m1.2.2.2.2.1.1" xref="A2.Ex10.m1.2.2.2.2.1.2.cmml">
                <mo id="A2.Ex10.m1.2.2.2.2.1.1.2" stretchy="false" xref="A2.Ex10.m1.2.2.2.2.1.2.cmml">
                 (
                </mo>
                <mi id="A2.Ex10.m1.1.1.1.1" xref="A2.Ex10.m1.1.1.1.1.cmml">
                 s
                </mi>
                <mo id="A2.Ex10.m1.2.2.2.2.1.1.3" xref="A2.Ex10.m1.2.2.2.2.1.2.cmml">
                 ,
                </mo>
                <msub id="A2.Ex10.m1.2.2.2.2.1.1.1" xref="A2.Ex10.m1.2.2.2.2.1.1.1.cmml">
                 <mi id="A2.Ex10.m1.2.2.2.2.1.1.1.2" xref="A2.Ex10.m1.2.2.2.2.1.1.1.2.cmml">
                  w
                 </mi>
                 <mrow id="A2.Ex10.m1.2.2.2.2.1.1.1.3" xref="A2.Ex10.m1.2.2.2.2.1.1.1.3.cmml">
                  <mn id="A2.Ex10.m1.2.2.2.2.1.1.1.3.2" xref="A2.Ex10.m1.2.2.2.2.1.1.1.3.2.cmml">
                   1
                  </mn>
                  <mo id="A2.Ex10.m1.2.2.2.2.1.1.1.3.1" lspace="0.278em" rspace="0.278em" xref="A2.Ex10.m1.2.2.2.2.1.1.1.3.1.cmml">
                   :
                  </mo>
                  <mrow id="A2.Ex10.m1.2.2.2.2.1.1.1.3.3" xref="A2.Ex10.m1.2.2.2.2.1.1.1.3.3.cmml">
                   <mi id="A2.Ex10.m1.2.2.2.2.1.1.1.3.3.2" xref="A2.Ex10.m1.2.2.2.2.1.1.1.3.3.2.cmml">
                    j
                   </mi>
                   <mo id="A2.Ex10.m1.2.2.2.2.1.1.1.3.3.1" xref="A2.Ex10.m1.2.2.2.2.1.1.1.3.3.1.cmml">
                    −
                   </mo>
                   <mn id="A2.Ex10.m1.2.2.2.2.1.1.1.3.3.3" xref="A2.Ex10.m1.2.2.2.2.1.1.1.3.3.3.cmml">
                    1
                   </mn>
                  </mrow>
                 </mrow>
                </msub>
                <mo id="A2.Ex10.m1.2.2.2.2.1.1.4" stretchy="false" xref="A2.Ex10.m1.2.2.2.2.1.2.cmml">
                 )
                </mo>
               </mrow>
              </mrow>
             </mrow>
            </msub>
           </mrow>
           <mo id="A2.Ex10.m1.12.12.4.4" lspace="0em" rspace="0em" xref="A2.Ex10.m1.12.12.4.4.cmml">
            ​
           </mo>
           <mrow id="A2.Ex10.m1.12.12.4.3.1" xref="A2.Ex10.m1.12.12.4.3.2.cmml">
            <mo id="A2.Ex10.m1.12.12.4.3.1.2" stretchy="false" xref="A2.Ex10.m1.12.12.4.3.2.1.cmml">
             [
            </mo>
            <mrow id="A2.Ex10.m1.12.12.4.3.1.1.1" xref="A2.Ex10.m1.12.12.4.3.1.1.2.cmml">
             <mi id="A2.Ex10.m1.8.8" xref="A2.Ex10.m1.8.8.cmml">
              exp
             </mi>
             <mo id="A2.Ex10.m1.12.12.4.3.1.1.1a" xref="A2.Ex10.m1.12.12.4.3.1.1.2.cmml">
              ⁡
             </mo>
             <mrow id="A2.Ex10.m1.12.12.4.3.1.1.1.1" xref="A2.Ex10.m1.12.12.4.3.1.1.2.cmml">
              <mo id="A2.Ex10.m1.12.12.4.3.1.1.1.1.2" stretchy="false" xref="A2.Ex10.m1.12.12.4.3.1.1.2.cmml">
               (
              </mo>
              <mrow id="A2.Ex10.m1.12.12.4.3.1.1.1.1.1" xref="A2.Ex10.m1.12.12.4.3.1.1.1.1.1.cmml">
               <mrow id="A2.Ex10.m1.12.12.4.3.1.1.1.1.1.2" xref="A2.Ex10.m1.12.12.4.3.1.1.1.1.1.2.cmml">
                <mi id="A2.Ex10.m1.12.12.4.3.1.1.1.1.1.2.4" xref="A2.Ex10.m1.12.12.4.3.1.1.1.1.1.2.4.cmml">
                 Q
                </mi>
                <mo id="A2.Ex10.m1.12.12.4.3.1.1.1.1.1.2.3" lspace="0em" rspace="0em" xref="A2.Ex10.m1.12.12.4.3.1.1.1.1.1.2.3.cmml">
                 ​
                </mo>
                <mrow id="A2.Ex10.m1.12.12.4.3.1.1.1.1.1.2.2.2" xref="A2.Ex10.m1.12.12.4.3.1.1.1.1.1.2.2.3.cmml">
                 <mo id="A2.Ex10.m1.12.12.4.3.1.1.1.1.1.2.2.2.3" stretchy="false" xref="A2.Ex10.m1.12.12.4.3.1.1.1.1.1.2.2.3.cmml">
                  (
                 </mo>
                 <mi id="A2.Ex10.m1.7.7" xref="A2.Ex10.m1.7.7.cmml">
                  s
                 </mi>
                 <mo id="A2.Ex10.m1.12.12.4.3.1.1.1.1.1.2.2.2.4" xref="A2.Ex10.m1.12.12.4.3.1.1.1.1.1.2.2.3.cmml">
                  ,
                 </mo>
                 <msub id="A2.Ex10.m1.12.12.4.3.1.1.1.1.1.1.1.1.1" xref="A2.Ex10.m1.12.12.4.3.1.1.1.1.1.1.1.1.1.cmml">
                  <mi id="A2.Ex10.m1.12.12.4.3.1.1.1.1.1.1.1.1.1.2" xref="A2.Ex10.m1.12.12.4.3.1.1.1.1.1.1.1.1.1.2.cmml">
                   w
                  </mi>
                  <mrow id="A2.Ex10.m1.12.12.4.3.1.1.1.1.1.1.1.1.1.3" xref="A2.Ex10.m1.12.12.4.3.1.1.1.1.1.1.1.1.1.3.cmml">
                   <mn id="A2.Ex10.m1.12.12.4.3.1.1.1.1.1.1.1.1.1.3.2" xref="A2.Ex10.m1.12.12.4.3.1.1.1.1.1.1.1.1.1.3.2.cmml">
                    1
                   </mn>
                   <mo id="A2.Ex10.m1.12.12.4.3.1.1.1.1.1.1.1.1.1.3.1" lspace="0.278em" rspace="0.278em" xref="A2.Ex10.m1.12.12.4.3.1.1.1.1.1.1.1.1.1.3.1.cmml">
                    :
                   </mo>
                   <mrow id="A2.Ex10.m1.12.12.4.3.1.1.1.1.1.1.1.1.1.3.3" xref="A2.Ex10.m1.12.12.4.3.1.1.1.1.1.1.1.1.1.3.3.cmml">
                    <mi id="A2.Ex10.m1.12.12.4.3.1.1.1.1.1.1.1.1.1.3.3.2" xref="A2.Ex10.m1.12.12.4.3.1.1.1.1.1.1.1.1.1.3.3.2.cmml">
                     j
                    </mi>
                    <mo id="A2.Ex10.m1.12.12.4.3.1.1.1.1.1.1.1.1.1.3.3.1" xref="A2.Ex10.m1.12.12.4.3.1.1.1.1.1.1.1.1.1.3.3.1.cmml">
                     −
                    </mo>
                    <mn id="A2.Ex10.m1.12.12.4.3.1.1.1.1.1.1.1.1.1.3.3.3" xref="A2.Ex10.m1.12.12.4.3.1.1.1.1.1.1.1.1.1.3.3.3.cmml">
                     1
                    </mn>
                   </mrow>
                  </mrow>
                 </msub>
                 <mo id="A2.Ex10.m1.12.12.4.3.1.1.1.1.1.2.2.2.5" xref="A2.Ex10.m1.12.12.4.3.1.1.1.1.1.2.2.3.cmml">
                  ,
                 </mo>
                 <msub id="A2.Ex10.m1.12.12.4.3.1.1.1.1.1.2.2.2.2" xref="A2.Ex10.m1.12.12.4.3.1.1.1.1.1.2.2.2.2.cmml">
                  <mover accent="true" id="A2.Ex10.m1.12.12.4.3.1.1.1.1.1.2.2.2.2.2" xref="A2.Ex10.m1.12.12.4.3.1.1.1.1.1.2.2.2.2.2.cmml">
                   <mi id="A2.Ex10.m1.12.12.4.3.1.1.1.1.1.2.2.2.2.2.2" xref="A2.Ex10.m1.12.12.4.3.1.1.1.1.1.2.2.2.2.2.2.cmml">
                    w
                   </mi>
                   <mo id="A2.Ex10.m1.12.12.4.3.1.1.1.1.1.2.2.2.2.2.1" xref="A2.Ex10.m1.12.12.4.3.1.1.1.1.1.2.2.2.2.2.1.cmml">
                    ¯
                   </mo>
                  </mover>
                  <mi id="A2.Ex10.m1.12.12.4.3.1.1.1.1.1.2.2.2.2.3" xref="A2.Ex10.m1.12.12.4.3.1.1.1.1.1.2.2.2.2.3.cmml">
                   j
                  </mi>
                 </msub>
                 <mo id="A2.Ex10.m1.12.12.4.3.1.1.1.1.1.2.2.2.6" stretchy="false" xref="A2.Ex10.m1.12.12.4.3.1.1.1.1.1.2.2.3.cmml">
                  )
                 </mo>
                </mrow>
               </mrow>
               <mo id="A2.Ex10.m1.12.12.4.3.1.1.1.1.1.3" xref="A2.Ex10.m1.12.12.4.3.1.1.1.1.1.3.cmml">
                /
               </mo>
               <mi id="A2.Ex10.m1.12.12.4.3.1.1.1.1.1.4" xref="A2.Ex10.m1.12.12.4.3.1.1.1.1.1.4.cmml">
                β
               </mi>
              </mrow>
              <mo id="A2.Ex10.m1.12.12.4.3.1.1.1.1.3" stretchy="false" xref="A2.Ex10.m1.12.12.4.3.1.1.2.cmml">
               )
              </mo>
             </mrow>
            </mrow>
            <mo id="A2.Ex10.m1.12.12.4.3.1.3" stretchy="false" xref="A2.Ex10.m1.12.12.4.3.2.1.cmml">
             ]
            </mo>
           </mrow>
          </mrow>
         </mrow>
         <annotation-xml encoding="MathML-Content" id="A2.Ex10.m1.12b">
          <apply id="A2.Ex10.m1.12.12.cmml" xref="A2.Ex10.m1.12.12">
           <eq id="A2.Ex10.m1.12.12.5.cmml" xref="A2.Ex10.m1.12.12.5">
           </eq>
           <apply id="A2.Ex10.m1.9.9.1.cmml" xref="A2.Ex10.m1.9.9.1">
            <times id="A2.Ex10.m1.9.9.1.2.cmml" xref="A2.Ex10.m1.9.9.1.2">
            </times>
            <apply id="A2.Ex10.m1.9.9.1.3.cmml" xref="A2.Ex10.m1.9.9.1.3">
             <csymbol cd="ambiguous" id="A2.Ex10.m1.9.9.1.3.1.cmml" xref="A2.Ex10.m1.9.9.1.3">
              superscript
             </csymbol>
             <ci id="A2.Ex10.m1.9.9.1.3.2.cmml" xref="A2.Ex10.m1.9.9.1.3.2">
              𝜋
             </ci>
             <times id="A2.Ex10.m1.9.9.1.3.3.cmml" xref="A2.Ex10.m1.9.9.1.3.3">
             </times>
            </apply>
            <apply id="A2.Ex10.m1.9.9.1.1.1.1.cmml" xref="A2.Ex10.m1.9.9.1.1.1">
             <csymbol cd="latexml" id="A2.Ex10.m1.9.9.1.1.1.1.2.cmml" xref="A2.Ex10.m1.9.9.1.1.1.1.2">
              conditional
             </csymbol>
             <apply id="A2.Ex10.m1.9.9.1.1.1.1.3.cmml" xref="A2.Ex10.m1.9.9.1.1.1.1.3">
              <csymbol cd="ambiguous" id="A2.Ex10.m1.9.9.1.1.1.1.3.1.cmml" xref="A2.Ex10.m1.9.9.1.1.1.1.3">
               subscript
              </csymbol>
              <ci id="A2.Ex10.m1.9.9.1.1.1.1.3.2.cmml" xref="A2.Ex10.m1.9.9.1.1.1.1.3.2">
               𝑤
              </ci>
              <ci id="A2.Ex10.m1.9.9.1.1.1.1.3.3.cmml" xref="A2.Ex10.m1.9.9.1.1.1.1.3.3">
               𝑗
              </ci>
             </apply>
             <list id="A2.Ex10.m1.9.9.1.1.1.1.1.2.cmml" xref="A2.Ex10.m1.9.9.1.1.1.1.1.1">
              <ci id="A2.Ex10.m1.3.3.cmml" xref="A2.Ex10.m1.3.3">
               𝑠
              </ci>
              <apply id="A2.Ex10.m1.9.9.1.1.1.1.1.1.1.cmml" xref="A2.Ex10.m1.9.9.1.1.1.1.1.1.1">
               <csymbol cd="ambiguous" id="A2.Ex10.m1.9.9.1.1.1.1.1.1.1.1.cmml" xref="A2.Ex10.m1.9.9.1.1.1.1.1.1.1">
                subscript
               </csymbol>
               <ci id="A2.Ex10.m1.9.9.1.1.1.1.1.1.1.2.cmml" xref="A2.Ex10.m1.9.9.1.1.1.1.1.1.1.2">
                𝑤
               </ci>
               <apply id="A2.Ex10.m1.9.9.1.1.1.1.1.1.1.3.cmml" xref="A2.Ex10.m1.9.9.1.1.1.1.1.1.1.3">
                <ci id="A2.Ex10.m1.9.9.1.1.1.1.1.1.1.3.1.cmml" xref="A2.Ex10.m1.9.9.1.1.1.1.1.1.1.3.1">
                 :
                </ci>
                <cn id="A2.Ex10.m1.9.9.1.1.1.1.1.1.1.3.2.cmml" type="integer" xref="A2.Ex10.m1.9.9.1.1.1.1.1.1.1.3.2">
                 1
                </cn>
                <apply id="A2.Ex10.m1.9.9.1.1.1.1.1.1.1.3.3.cmml" xref="A2.Ex10.m1.9.9.1.1.1.1.1.1.1.3.3">
                 <minus id="A2.Ex10.m1.9.9.1.1.1.1.1.1.1.3.3.1.cmml" xref="A2.Ex10.m1.9.9.1.1.1.1.1.1.1.3.3.1">
                 </minus>
                 <ci id="A2.Ex10.m1.9.9.1.1.1.1.1.1.1.3.3.2.cmml" xref="A2.Ex10.m1.9.9.1.1.1.1.1.1.1.3.3.2">
                  𝑗
                 </ci>
                 <cn id="A2.Ex10.m1.9.9.1.1.1.1.1.1.1.3.3.3.cmml" type="integer" xref="A2.Ex10.m1.9.9.1.1.1.1.1.1.1.3.3.3">
                  1
                 </cn>
                </apply>
               </apply>
              </apply>
             </list>
            </apply>
           </apply>
           <apply id="A2.Ex10.m1.12.12.4.cmml" xref="A2.Ex10.m1.12.12.4">
            <times id="A2.Ex10.m1.12.12.4.4.cmml" xref="A2.Ex10.m1.12.12.4.4">
            </times>
            <apply id="A2.Ex10.m1.11.11.3.2.cmml" xref="A2.Ex10.m1.11.11.3.2">
             <divide id="A2.Ex10.m1.11.11.3.2.3.cmml" xref="A2.Ex10.m1.11.11.3.2.3">
             </divide>
             <apply id="A2.Ex10.m1.11.11.3.2.2.cmml" xref="A2.Ex10.m1.11.11.3.2.2">
              <times id="A2.Ex10.m1.11.11.3.2.2.3.cmml" xref="A2.Ex10.m1.11.11.3.2.2.3">
              </times>
              <ci id="A2.Ex10.m1.11.11.3.2.2.4.cmml" xref="A2.Ex10.m1.11.11.3.2.2.4">
               𝜌
              </ci>
              <apply id="A2.Ex10.m1.10.10.2.1.1.1.1.1.cmml" xref="A2.Ex10.m1.10.10.2.1.1.1.1">
               <csymbol cd="latexml" id="A2.Ex10.m1.10.10.2.1.1.1.1.1.2.cmml" xref="A2.Ex10.m1.10.10.2.1.1.1.1.1.2">
                conditional
               </csymbol>
               <apply id="A2.Ex10.m1.10.10.2.1.1.1.1.1.3.cmml" xref="A2.Ex10.m1.10.10.2.1.1.1.1.1.3">
                <csymbol cd="ambiguous" id="A2.Ex10.m1.10.10.2.1.1.1.1.1.3.1.cmml" xref="A2.Ex10.m1.10.10.2.1.1.1.1.1.3">
                 subscript
                </csymbol>
                <ci id="A2.Ex10.m1.10.10.2.1.1.1.1.1.3.2.cmml" xref="A2.Ex10.m1.10.10.2.1.1.1.1.1.3.2">
                 𝑤
                </ci>
                <ci id="A2.Ex10.m1.10.10.2.1.1.1.1.1.3.3.cmml" xref="A2.Ex10.m1.10.10.2.1.1.1.1.1.3.3">
                 𝑗
                </ci>
               </apply>
               <list id="A2.Ex10.m1.10.10.2.1.1.1.1.1.1.2.cmml" xref="A2.Ex10.m1.10.10.2.1.1.1.1.1.1.1">
                <ci id="A2.Ex10.m1.4.4.cmml" xref="A2.Ex10.m1.4.4">
                 𝑠
                </ci>
                <apply id="A2.Ex10.m1.10.10.2.1.1.1.1.1.1.1.1.cmml" xref="A2.Ex10.m1.10.10.2.1.1.1.1.1.1.1.1">
                 <csymbol cd="ambiguous" id="A2.Ex10.m1.10.10.2.1.1.1.1.1.1.1.1.1.cmml" xref="A2.Ex10.m1.10.10.2.1.1.1.1.1.1.1.1">
                  subscript
                 </csymbol>
                 <ci id="A2.Ex10.m1.10.10.2.1.1.1.1.1.1.1.1.2.cmml" xref="A2.Ex10.m1.10.10.2.1.1.1.1.1.1.1.1.2">
                  𝑤
                 </ci>
                 <apply id="A2.Ex10.m1.10.10.2.1.1.1.1.1.1.1.1.3.cmml" xref="A2.Ex10.m1.10.10.2.1.1.1.1.1.1.1.1.3">
                  <ci id="A2.Ex10.m1.10.10.2.1.1.1.1.1.1.1.1.3.1.cmml" xref="A2.Ex10.m1.10.10.2.1.1.1.1.1.1.1.1.3.1">
                   :
                  </ci>
                  <cn id="A2.Ex10.m1.10.10.2.1.1.1.1.1.1.1.1.3.2.cmml" type="integer" xref="A2.Ex10.m1.10.10.2.1.1.1.1.1.1.1.1.3.2">
                   1
                  </cn>
                  <apply id="A2.Ex10.m1.10.10.2.1.1.1.1.1.1.1.1.3.3.cmml" xref="A2.Ex10.m1.10.10.2.1.1.1.1.1.1.1.1.3.3">
                   <minus id="A2.Ex10.m1.10.10.2.1.1.1.1.1.1.1.1.3.3.1.cmml" xref="A2.Ex10.m1.10.10.2.1.1.1.1.1.1.1.1.3.3.1">
                   </minus>
                   <ci id="A2.Ex10.m1.10.10.2.1.1.1.1.1.1.1.1.3.3.2.cmml" xref="A2.Ex10.m1.10.10.2.1.1.1.1.1.1.1.1.3.3.2">
                    𝑗
                   </ci>
                   <cn id="A2.Ex10.m1.10.10.2.1.1.1.1.1.1.1.1.3.3.3.cmml" type="integer" xref="A2.Ex10.m1.10.10.2.1.1.1.1.1.1.1.1.3.3.3">
                    1
                   </cn>
                  </apply>
                 </apply>
                </apply>
               </list>
              </apply>
              <apply id="A2.Ex10.m1.11.11.3.2.2.2.2.cmml" xref="A2.Ex10.m1.11.11.3.2.2.2.1">
               <exp id="A2.Ex10.m1.6.6.cmml" xref="A2.Ex10.m1.6.6">
               </exp>
               <apply id="A2.Ex10.m1.11.11.3.2.2.2.1.1.1.cmml" xref="A2.Ex10.m1.11.11.3.2.2.2.1.1.1">
                <divide id="A2.Ex10.m1.11.11.3.2.2.2.1.1.1.3.cmml" xref="A2.Ex10.m1.11.11.3.2.2.2.1.1.1.3">
                </divide>
                <apply id="A2.Ex10.m1.11.11.3.2.2.2.1.1.1.2.cmml" xref="A2.Ex10.m1.11.11.3.2.2.2.1.1.1.2">
                 <times id="A2.Ex10.m1.11.11.3.2.2.2.1.1.1.2.3.cmml" xref="A2.Ex10.m1.11.11.3.2.2.2.1.1.1.2.3">
                 </times>
                 <ci id="A2.Ex10.m1.11.11.3.2.2.2.1.1.1.2.4.cmml" xref="A2.Ex10.m1.11.11.3.2.2.2.1.1.1.2.4">
                  𝑄
                 </ci>
                 <vector id="A2.Ex10.m1.11.11.3.2.2.2.1.1.1.2.2.3.cmml" xref="A2.Ex10.m1.11.11.3.2.2.2.1.1.1.2.2.2">
                  <ci id="A2.Ex10.m1.5.5.cmml" xref="A2.Ex10.m1.5.5">
                   𝑠
                  </ci>
                  <apply id="A2.Ex10.m1.11.11.3.2.2.2.1.1.1.1.1.1.1.cmml" xref="A2.Ex10.m1.11.11.3.2.2.2.1.1.1.1.1.1.1">
                   <csymbol cd="ambiguous" id="A2.Ex10.m1.11.11.3.2.2.2.1.1.1.1.1.1.1.1.cmml" xref="A2.Ex10.m1.11.11.3.2.2.2.1.1.1.1.1.1.1">
                    subscript
                   </csymbol>
                   <ci id="A2.Ex10.m1.11.11.3.2.2.2.1.1.1.1.1.1.1.2.cmml" xref="A2.Ex10.m1.11.11.3.2.2.2.1.1.1.1.1.1.1.2">
                    𝑤
                   </ci>
                   <apply id="A2.Ex10.m1.11.11.3.2.2.2.1.1.1.1.1.1.1.3.cmml" xref="A2.Ex10.m1.11.11.3.2.2.2.1.1.1.1.1.1.1.3">
                    <ci id="A2.Ex10.m1.11.11.3.2.2.2.1.1.1.1.1.1.1.3.1.cmml" xref="A2.Ex10.m1.11.11.3.2.2.2.1.1.1.1.1.1.1.3.1">
                     :
                    </ci>
                    <cn id="A2.Ex10.m1.11.11.3.2.2.2.1.1.1.1.1.1.1.3.2.cmml" type="integer" xref="A2.Ex10.m1.11.11.3.2.2.2.1.1.1.1.1.1.1.3.2">
                     1
                    </cn>
                    <apply id="A2.Ex10.m1.11.11.3.2.2.2.1.1.1.1.1.1.1.3.3.cmml" xref="A2.Ex10.m1.11.11.3.2.2.2.1.1.1.1.1.1.1.3.3">
                     <minus id="A2.Ex10.m1.11.11.3.2.2.2.1.1.1.1.1.1.1.3.3.1.cmml" xref="A2.Ex10.m1.11.11.3.2.2.2.1.1.1.1.1.1.1.3.3.1">
                     </minus>
                     <ci id="A2.Ex10.m1.11.11.3.2.2.2.1.1.1.1.1.1.1.3.3.2.cmml" xref="A2.Ex10.m1.11.11.3.2.2.2.1.1.1.1.1.1.1.3.3.2">
                      𝑗
                     </ci>
                     <cn id="A2.Ex10.m1.11.11.3.2.2.2.1.1.1.1.1.1.1.3.3.3.cmml" type="integer" xref="A2.Ex10.m1.11.11.3.2.2.2.1.1.1.1.1.1.1.3.3.3">
                      1
                     </cn>
                    </apply>
                   </apply>
                  </apply>
                  <apply id="A2.Ex10.m1.11.11.3.2.2.2.1.1.1.2.2.2.2.cmml" xref="A2.Ex10.m1.11.11.3.2.2.2.1.1.1.2.2.2.2">
                   <csymbol cd="ambiguous" id="A2.Ex10.m1.11.11.3.2.2.2.1.1.1.2.2.2.2.1.cmml" xref="A2.Ex10.m1.11.11.3.2.2.2.1.1.1.2.2.2.2">
                    subscript
                   </csymbol>
                   <ci id="A2.Ex10.m1.11.11.3.2.2.2.1.1.1.2.2.2.2.2.cmml" xref="A2.Ex10.m1.11.11.3.2.2.2.1.1.1.2.2.2.2.2">
                    𝑤
                   </ci>
                   <ci id="A2.Ex10.m1.11.11.3.2.2.2.1.1.1.2.2.2.2.3.cmml" xref="A2.Ex10.m1.11.11.3.2.2.2.1.1.1.2.2.2.2.3">
                    𝑗
                   </ci>
                  </apply>
                 </vector>
                </apply>
                <ci id="A2.Ex10.m1.11.11.3.2.2.2.1.1.1.4.cmml" xref="A2.Ex10.m1.11.11.3.2.2.2.1.1.1.4">
                 𝛽
                </ci>
               </apply>
              </apply>
             </apply>
             <apply id="A2.Ex10.m1.11.11.3.2.4.cmml" xref="A2.Ex10.m1.11.11.3.2.4">
              <csymbol cd="ambiguous" id="A2.Ex10.m1.11.11.3.2.4.1.cmml" xref="A2.Ex10.m1.11.11.3.2.4">
               subscript
              </csymbol>
              <ci id="A2.Ex10.m1.11.11.3.2.4.2.cmml" xref="A2.Ex10.m1.11.11.3.2.4.2">
               𝔼
              </ci>
              <apply id="A2.Ex10.m1.2.2.2.cmml" xref="A2.Ex10.m1.2.2.2">
               <csymbol cd="latexml" id="A2.Ex10.m1.2.2.2.3.cmml" xref="A2.Ex10.m1.2.2.2.3">
                similar-to
               </csymbol>
               <apply id="A2.Ex10.m1.2.2.2.4.cmml" xref="A2.Ex10.m1.2.2.2.4">
                <csymbol cd="ambiguous" id="A2.Ex10.m1.2.2.2.4.1.cmml" xref="A2.Ex10.m1.2.2.2.4">
                 subscript
                </csymbol>
                <apply id="A2.Ex10.m1.2.2.2.4.2.cmml" xref="A2.Ex10.m1.2.2.2.4.2">
                 <ci id="A2.Ex10.m1.2.2.2.4.2.1.cmml" xref="A2.Ex10.m1.2.2.2.4.2.1">
                  ¯
                 </ci>
                 <ci id="A2.Ex10.m1.2.2.2.4.2.2.cmml" xref="A2.Ex10.m1.2.2.2.4.2.2">
                  𝑤
                 </ci>
                </apply>
                <ci id="A2.Ex10.m1.2.2.2.4.3.cmml" xref="A2.Ex10.m1.2.2.2.4.3">
                 𝑗
                </ci>
               </apply>
               <apply id="A2.Ex10.m1.2.2.2.2.cmml" xref="A2.Ex10.m1.2.2.2.2">
                <times id="A2.Ex10.m1.2.2.2.2.2.cmml" xref="A2.Ex10.m1.2.2.2.2.2">
                </times>
                <ci id="A2.Ex10.m1.2.2.2.2.3.cmml" xref="A2.Ex10.m1.2.2.2.2.3">
                 𝜌
                </ci>
                <interval closure="open" id="A2.Ex10.m1.2.2.2.2.1.2.cmml" xref="A2.Ex10.m1.2.2.2.2.1.1">
                 <ci id="A2.Ex10.m1.1.1.1.1.cmml" xref="A2.Ex10.m1.1.1.1.1">
                  𝑠
                 </ci>
                 <apply id="A2.Ex10.m1.2.2.2.2.1.1.1.cmml" xref="A2.Ex10.m1.2.2.2.2.1.1.1">
                  <csymbol cd="ambiguous" id="A2.Ex10.m1.2.2.2.2.1.1.1.1.cmml" xref="A2.Ex10.m1.2.2.2.2.1.1.1">
                   subscript
                  </csymbol>
                  <ci id="A2.Ex10.m1.2.2.2.2.1.1.1.2.cmml" xref="A2.Ex10.m1.2.2.2.2.1.1.1.2">
                   𝑤
                  </ci>
                  <apply id="A2.Ex10.m1.2.2.2.2.1.1.1.3.cmml" xref="A2.Ex10.m1.2.2.2.2.1.1.1.3">
                   <ci id="A2.Ex10.m1.2.2.2.2.1.1.1.3.1.cmml" xref="A2.Ex10.m1.2.2.2.2.1.1.1.3.1">
                    :
                   </ci>
                   <cn id="A2.Ex10.m1.2.2.2.2.1.1.1.3.2.cmml" type="integer" xref="A2.Ex10.m1.2.2.2.2.1.1.1.3.2">
                    1
                   </cn>
                   <apply id="A2.Ex10.m1.2.2.2.2.1.1.1.3.3.cmml" xref="A2.Ex10.m1.2.2.2.2.1.1.1.3.3">
                    <minus id="A2.Ex10.m1.2.2.2.2.1.1.1.3.3.1.cmml" xref="A2.Ex10.m1.2.2.2.2.1.1.1.3.3.1">
                    </minus>
                    <ci id="A2.Ex10.m1.2.2.2.2.1.1.1.3.3.2.cmml" xref="A2.Ex10.m1.2.2.2.2.1.1.1.3.3.2">
                     𝑗
                    </ci>
                    <cn id="A2.Ex10.m1.2.2.2.2.1.1.1.3.3.3.cmml" type="integer" xref="A2.Ex10.m1.2.2.2.2.1.1.1.3.3.3">
                     1
                    </cn>
                   </apply>
                  </apply>
                 </apply>
                </interval>
               </apply>
              </apply>
             </apply>
            </apply>
            <apply id="A2.Ex10.m1.12.12.4.3.2.cmml" xref="A2.Ex10.m1.12.12.4.3.1">
             <csymbol cd="latexml" id="A2.Ex10.m1.12.12.4.3.2.1.cmml" xref="A2.Ex10.m1.12.12.4.3.1.2">
              delimited-[]
             </csymbol>
             <apply id="A2.Ex10.m1.12.12.4.3.1.1.2.cmml" xref="A2.Ex10.m1.12.12.4.3.1.1.1">
              <exp id="A2.Ex10.m1.8.8.cmml" xref="A2.Ex10.m1.8.8">
              </exp>
              <apply id="A2.Ex10.m1.12.12.4.3.1.1.1.1.1.cmml" xref="A2.Ex10.m1.12.12.4.3.1.1.1.1.1">
               <divide id="A2.Ex10.m1.12.12.4.3.1.1.1.1.1.3.cmml" xref="A2.Ex10.m1.12.12.4.3.1.1.1.1.1.3">
               </divide>
               <apply id="A2.Ex10.m1.12.12.4.3.1.1.1.1.1.2.cmml" xref="A2.Ex10.m1.12.12.4.3.1.1.1.1.1.2">
                <times id="A2.Ex10.m1.12.12.4.3.1.1.1.1.1.2.3.cmml" xref="A2.Ex10.m1.12.12.4.3.1.1.1.1.1.2.3">
                </times>
                <ci id="A2.Ex10.m1.12.12.4.3.1.1.1.1.1.2.4.cmml" xref="A2.Ex10.m1.12.12.4.3.1.1.1.1.1.2.4">
                 𝑄
                </ci>
                <vector id="A2.Ex10.m1.12.12.4.3.1.1.1.1.1.2.2.3.cmml" xref="A2.Ex10.m1.12.12.4.3.1.1.1.1.1.2.2.2">
                 <ci id="A2.Ex10.m1.7.7.cmml" xref="A2.Ex10.m1.7.7">
                  𝑠
                 </ci>
                 <apply id="A2.Ex10.m1.12.12.4.3.1.1.1.1.1.1.1.1.1.cmml" xref="A2.Ex10.m1.12.12.4.3.1.1.1.1.1.1.1.1.1">
                  <csymbol cd="ambiguous" id="A2.Ex10.m1.12.12.4.3.1.1.1.1.1.1.1.1.1.1.cmml" xref="A2.Ex10.m1.12.12.4.3.1.1.1.1.1.1.1.1.1">
                   subscript
                  </csymbol>
                  <ci id="A2.Ex10.m1.12.12.4.3.1.1.1.1.1.1.1.1.1.2.cmml" xref="A2.Ex10.m1.12.12.4.3.1.1.1.1.1.1.1.1.1.2">
                   𝑤
                  </ci>
                  <apply id="A2.Ex10.m1.12.12.4.3.1.1.1.1.1.1.1.1.1.3.cmml" xref="A2.Ex10.m1.12.12.4.3.1.1.1.1.1.1.1.1.1.3">
                   <ci id="A2.Ex10.m1.12.12.4.3.1.1.1.1.1.1.1.1.1.3.1.cmml" xref="A2.Ex10.m1.12.12.4.3.1.1.1.1.1.1.1.1.1.3.1">
                    :
                   </ci>
                   <cn id="A2.Ex10.m1.12.12.4.3.1.1.1.1.1.1.1.1.1.3.2.cmml" type="integer" xref="A2.Ex10.m1.12.12.4.3.1.1.1.1.1.1.1.1.1.3.2">
                    1
                   </cn>
                   <apply id="A2.Ex10.m1.12.12.4.3.1.1.1.1.1.1.1.1.1.3.3.cmml" xref="A2.Ex10.m1.12.12.4.3.1.1.1.1.1.1.1.1.1.3.3">
                    <minus id="A2.Ex10.m1.12.12.4.3.1.1.1.1.1.1.1.1.1.3.3.1.cmml" xref="A2.Ex10.m1.12.12.4.3.1.1.1.1.1.1.1.1.1.3.3.1">
                    </minus>
                    <ci id="A2.Ex10.m1.12.12.4.3.1.1.1.1.1.1.1.1.1.3.3.2.cmml" xref="A2.Ex10.m1.12.12.4.3.1.1.1.1.1.1.1.1.1.3.3.2">
                     𝑗
                    </ci>
                    <cn id="A2.Ex10.m1.12.12.4.3.1.1.1.1.1.1.1.1.1.3.3.3.cmml" type="integer" xref="A2.Ex10.m1.12.12.4.3.1.1.1.1.1.1.1.1.1.3.3.3">
                     1
                    </cn>
                   </apply>
                  </apply>
                 </apply>
                 <apply id="A2.Ex10.m1.12.12.4.3.1.1.1.1.1.2.2.2.2.cmml" xref="A2.Ex10.m1.12.12.4.3.1.1.1.1.1.2.2.2.2">
                  <csymbol cd="ambiguous" id="A2.Ex10.m1.12.12.4.3.1.1.1.1.1.2.2.2.2.1.cmml" xref="A2.Ex10.m1.12.12.4.3.1.1.1.1.1.2.2.2.2">
                   subscript
                  </csymbol>
                  <apply id="A2.Ex10.m1.12.12.4.3.1.1.1.1.1.2.2.2.2.2.cmml" xref="A2.Ex10.m1.12.12.4.3.1.1.1.1.1.2.2.2.2.2">
                   <ci id="A2.Ex10.m1.12.12.4.3.1.1.1.1.1.2.2.2.2.2.1.cmml" xref="A2.Ex10.m1.12.12.4.3.1.1.1.1.1.2.2.2.2.2.1">
                    ¯
                   </ci>
                   <ci id="A2.Ex10.m1.12.12.4.3.1.1.1.1.1.2.2.2.2.2.2.cmml" xref="A2.Ex10.m1.12.12.4.3.1.1.1.1.1.2.2.2.2.2.2">
                    𝑤
                   </ci>
                  </apply>
                  <ci id="A2.Ex10.m1.12.12.4.3.1.1.1.1.1.2.2.2.2.3.cmml" xref="A2.Ex10.m1.12.12.4.3.1.1.1.1.1.2.2.2.2.3">
                   𝑗
                  </ci>
                 </apply>
                </vector>
               </apply>
               <ci id="A2.Ex10.m1.12.12.4.3.1.1.1.1.1.4.cmml" xref="A2.Ex10.m1.12.12.4.3.1.1.1.1.1.4">
                𝛽
               </ci>
              </apply>
             </apply>
            </apply>
           </apply>
          </apply>
         </annotation-xml>
         <annotation encoding="application/x-tex" id="A2.Ex10.m1.12c">
          \displaystyle\pi^{*}(w_{j}|s,w_{1:j-1})=\rho(w_{j}|s,w_{1:j-1})\exp(Q(s,w_{1:j-1},w_{j})/\beta)/\mathbb{E}_{\bar{w}_{j}\sim\rho(s,w_{1:j-1})}[\exp(Q(s,w_{1:j-1},\bar{w}_{j})/\beta)]
         </annotation>
        </semantics>
       </math>
      </td>
      <td class="ltx_eqn_cell ltx_eqn_center_padright">
      </td>
     </tr>
    </tbody>
   </table>
  </div>
  <div class="ltx_para" id="A2.p3">
   <p class="ltx_p" id="A2.p3.3">
    Since
    <math alttext="\pi^{*}(w_{j}|s,w_{1:j-1})\propto\exp(Q(s,w_{1:j-1},w_{j})/\beta)" class="ltx_Math" display="inline" id="A2.p3.1.m1.5">
     <semantics id="A2.p3.1.m1.5a">
      <mrow id="A2.p3.1.m1.5.5" xref="A2.p3.1.m1.5.5.cmml">
       <mrow id="A2.p3.1.m1.4.4.1" xref="A2.p3.1.m1.4.4.1.cmml">
        <msup id="A2.p3.1.m1.4.4.1.3" xref="A2.p3.1.m1.4.4.1.3.cmml">
         <mi id="A2.p3.1.m1.4.4.1.3.2" xref="A2.p3.1.m1.4.4.1.3.2.cmml">
          π
         </mi>
         <mo id="A2.p3.1.m1.4.4.1.3.3" xref="A2.p3.1.m1.4.4.1.3.3.cmml">
          ∗
         </mo>
        </msup>
        <mo id="A2.p3.1.m1.4.4.1.2" lspace="0em" rspace="0em" xref="A2.p3.1.m1.4.4.1.2.cmml">
         ​
        </mo>
        <mrow id="A2.p3.1.m1.4.4.1.1.1" xref="A2.p3.1.m1.4.4.1.1.1.1.cmml">
         <mo id="A2.p3.1.m1.4.4.1.1.1.2" stretchy="false" xref="A2.p3.1.m1.4.4.1.1.1.1.cmml">
          (
         </mo>
         <mrow id="A2.p3.1.m1.4.4.1.1.1.1" xref="A2.p3.1.m1.4.4.1.1.1.1.cmml">
          <msub id="A2.p3.1.m1.4.4.1.1.1.1.3" xref="A2.p3.1.m1.4.4.1.1.1.1.3.cmml">
           <mi id="A2.p3.1.m1.4.4.1.1.1.1.3.2" xref="A2.p3.1.m1.4.4.1.1.1.1.3.2.cmml">
            w
           </mi>
           <mi id="A2.p3.1.m1.4.4.1.1.1.1.3.3" xref="A2.p3.1.m1.4.4.1.1.1.1.3.3.cmml">
            j
           </mi>
          </msub>
          <mo fence="false" id="A2.p3.1.m1.4.4.1.1.1.1.2" xref="A2.p3.1.m1.4.4.1.1.1.1.2.cmml">
           |
          </mo>
          <mrow id="A2.p3.1.m1.4.4.1.1.1.1.1.1" xref="A2.p3.1.m1.4.4.1.1.1.1.1.2.cmml">
           <mi id="A2.p3.1.m1.1.1" xref="A2.p3.1.m1.1.1.cmml">
            s
           </mi>
           <mo id="A2.p3.1.m1.4.4.1.1.1.1.1.1.2" xref="A2.p3.1.m1.4.4.1.1.1.1.1.2.cmml">
            ,
           </mo>
           <msub id="A2.p3.1.m1.4.4.1.1.1.1.1.1.1" xref="A2.p3.1.m1.4.4.1.1.1.1.1.1.1.cmml">
            <mi id="A2.p3.1.m1.4.4.1.1.1.1.1.1.1.2" xref="A2.p3.1.m1.4.4.1.1.1.1.1.1.1.2.cmml">
             w
            </mi>
            <mrow id="A2.p3.1.m1.4.4.1.1.1.1.1.1.1.3" xref="A2.p3.1.m1.4.4.1.1.1.1.1.1.1.3.cmml">
             <mn id="A2.p3.1.m1.4.4.1.1.1.1.1.1.1.3.2" xref="A2.p3.1.m1.4.4.1.1.1.1.1.1.1.3.2.cmml">
              1
             </mn>
             <mo id="A2.p3.1.m1.4.4.1.1.1.1.1.1.1.3.1" lspace="0.278em" rspace="0.278em" xref="A2.p3.1.m1.4.4.1.1.1.1.1.1.1.3.1.cmml">
              :
             </mo>
             <mrow id="A2.p3.1.m1.4.4.1.1.1.1.1.1.1.3.3" xref="A2.p3.1.m1.4.4.1.1.1.1.1.1.1.3.3.cmml">
              <mi id="A2.p3.1.m1.4.4.1.1.1.1.1.1.1.3.3.2" xref="A2.p3.1.m1.4.4.1.1.1.1.1.1.1.3.3.2.cmml">
               j
              </mi>
              <mo id="A2.p3.1.m1.4.4.1.1.1.1.1.1.1.3.3.1" xref="A2.p3.1.m1.4.4.1.1.1.1.1.1.1.3.3.1.cmml">
               −
              </mo>
              <mn id="A2.p3.1.m1.4.4.1.1.1.1.1.1.1.3.3.3" xref="A2.p3.1.m1.4.4.1.1.1.1.1.1.1.3.3.3.cmml">
               1
              </mn>
             </mrow>
            </mrow>
           </msub>
          </mrow>
         </mrow>
         <mo id="A2.p3.1.m1.4.4.1.1.1.3" stretchy="false" xref="A2.p3.1.m1.4.4.1.1.1.1.cmml">
          )
         </mo>
        </mrow>
       </mrow>
       <mo id="A2.p3.1.m1.5.5.3" xref="A2.p3.1.m1.5.5.3.cmml">
        ∝
       </mo>
       <mrow id="A2.p3.1.m1.5.5.2.1" xref="A2.p3.1.m1.5.5.2.2.cmml">
        <mi id="A2.p3.1.m1.3.3" xref="A2.p3.1.m1.3.3.cmml">
         exp
        </mi>
        <mo id="A2.p3.1.m1.5.5.2.1a" xref="A2.p3.1.m1.5.5.2.2.cmml">
         ⁡
        </mo>
        <mrow id="A2.p3.1.m1.5.5.2.1.1" xref="A2.p3.1.m1.5.5.2.2.cmml">
         <mo id="A2.p3.1.m1.5.5.2.1.1.2" stretchy="false" xref="A2.p3.1.m1.5.5.2.2.cmml">
          (
         </mo>
         <mrow id="A2.p3.1.m1.5.5.2.1.1.1" xref="A2.p3.1.m1.5.5.2.1.1.1.cmml">
          <mrow id="A2.p3.1.m1.5.5.2.1.1.1.2" xref="A2.p3.1.m1.5.5.2.1.1.1.2.cmml">
           <mi id="A2.p3.1.m1.5.5.2.1.1.1.2.4" xref="A2.p3.1.m1.5.5.2.1.1.1.2.4.cmml">
            Q
           </mi>
           <mo id="A2.p3.1.m1.5.5.2.1.1.1.2.3" lspace="0em" rspace="0em" xref="A2.p3.1.m1.5.5.2.1.1.1.2.3.cmml">
            ​
           </mo>
           <mrow id="A2.p3.1.m1.5.5.2.1.1.1.2.2.2" xref="A2.p3.1.m1.5.5.2.1.1.1.2.2.3.cmml">
            <mo id="A2.p3.1.m1.5.5.2.1.1.1.2.2.2.3" stretchy="false" xref="A2.p3.1.m1.5.5.2.1.1.1.2.2.3.cmml">
             (
            </mo>
            <mi id="A2.p3.1.m1.2.2" xref="A2.p3.1.m1.2.2.cmml">
             s
            </mi>
            <mo id="A2.p3.1.m1.5.5.2.1.1.1.2.2.2.4" xref="A2.p3.1.m1.5.5.2.1.1.1.2.2.3.cmml">
             ,
            </mo>
            <msub id="A2.p3.1.m1.5.5.2.1.1.1.1.1.1.1" xref="A2.p3.1.m1.5.5.2.1.1.1.1.1.1.1.cmml">
             <mi id="A2.p3.1.m1.5.5.2.1.1.1.1.1.1.1.2" xref="A2.p3.1.m1.5.5.2.1.1.1.1.1.1.1.2.cmml">
              w
             </mi>
             <mrow id="A2.p3.1.m1.5.5.2.1.1.1.1.1.1.1.3" xref="A2.p3.1.m1.5.5.2.1.1.1.1.1.1.1.3.cmml">
              <mn id="A2.p3.1.m1.5.5.2.1.1.1.1.1.1.1.3.2" xref="A2.p3.1.m1.5.5.2.1.1.1.1.1.1.1.3.2.cmml">
               1
              </mn>
              <mo id="A2.p3.1.m1.5.5.2.1.1.1.1.1.1.1.3.1" lspace="0.278em" rspace="0.278em" xref="A2.p3.1.m1.5.5.2.1.1.1.1.1.1.1.3.1.cmml">
               :
              </mo>
              <mrow id="A2.p3.1.m1.5.5.2.1.1.1.1.1.1.1.3.3" xref="A2.p3.1.m1.5.5.2.1.1.1.1.1.1.1.3.3.cmml">
               <mi id="A2.p3.1.m1.5.5.2.1.1.1.1.1.1.1.3.3.2" xref="A2.p3.1.m1.5.5.2.1.1.1.1.1.1.1.3.3.2.cmml">
                j
               </mi>
               <mo id="A2.p3.1.m1.5.5.2.1.1.1.1.1.1.1.3.3.1" xref="A2.p3.1.m1.5.5.2.1.1.1.1.1.1.1.3.3.1.cmml">
                −
               </mo>
               <mn id="A2.p3.1.m1.5.5.2.1.1.1.1.1.1.1.3.3.3" xref="A2.p3.1.m1.5.5.2.1.1.1.1.1.1.1.3.3.3.cmml">
                1
               </mn>
              </mrow>
             </mrow>
            </msub>
            <mo id="A2.p3.1.m1.5.5.2.1.1.1.2.2.2.5" xref="A2.p3.1.m1.5.5.2.1.1.1.2.2.3.cmml">
             ,
            </mo>
            <msub id="A2.p3.1.m1.5.5.2.1.1.1.2.2.2.2" xref="A2.p3.1.m1.5.5.2.1.1.1.2.2.2.2.cmml">
             <mi id="A2.p3.1.m1.5.5.2.1.1.1.2.2.2.2.2" xref="A2.p3.1.m1.5.5.2.1.1.1.2.2.2.2.2.cmml">
              w
             </mi>
             <mi id="A2.p3.1.m1.5.5.2.1.1.1.2.2.2.2.3" xref="A2.p3.1.m1.5.5.2.1.1.1.2.2.2.2.3.cmml">
              j
             </mi>
            </msub>
            <mo id="A2.p3.1.m1.5.5.2.1.1.1.2.2.2.6" stretchy="false" xref="A2.p3.1.m1.5.5.2.1.1.1.2.2.3.cmml">
             )
            </mo>
           </mrow>
          </mrow>
          <mo id="A2.p3.1.m1.5.5.2.1.1.1.3" xref="A2.p3.1.m1.5.5.2.1.1.1.3.cmml">
           /
          </mo>
          <mi id="A2.p3.1.m1.5.5.2.1.1.1.4" xref="A2.p3.1.m1.5.5.2.1.1.1.4.cmml">
           β
          </mi>
         </mrow>
         <mo id="A2.p3.1.m1.5.5.2.1.1.3" stretchy="false" xref="A2.p3.1.m1.5.5.2.2.cmml">
          )
         </mo>
        </mrow>
       </mrow>
      </mrow>
      <annotation-xml encoding="MathML-Content" id="A2.p3.1.m1.5b">
       <apply id="A2.p3.1.m1.5.5.cmml" xref="A2.p3.1.m1.5.5">
        <csymbol cd="latexml" id="A2.p3.1.m1.5.5.3.cmml" xref="A2.p3.1.m1.5.5.3">
         proportional-to
        </csymbol>
        <apply id="A2.p3.1.m1.4.4.1.cmml" xref="A2.p3.1.m1.4.4.1">
         <times id="A2.p3.1.m1.4.4.1.2.cmml" xref="A2.p3.1.m1.4.4.1.2">
         </times>
         <apply id="A2.p3.1.m1.4.4.1.3.cmml" xref="A2.p3.1.m1.4.4.1.3">
          <csymbol cd="ambiguous" id="A2.p3.1.m1.4.4.1.3.1.cmml" xref="A2.p3.1.m1.4.4.1.3">
           superscript
          </csymbol>
          <ci id="A2.p3.1.m1.4.4.1.3.2.cmml" xref="A2.p3.1.m1.4.4.1.3.2">
           𝜋
          </ci>
          <times id="A2.p3.1.m1.4.4.1.3.3.cmml" xref="A2.p3.1.m1.4.4.1.3.3">
          </times>
         </apply>
         <apply id="A2.p3.1.m1.4.4.1.1.1.1.cmml" xref="A2.p3.1.m1.4.4.1.1.1">
          <csymbol cd="latexml" id="A2.p3.1.m1.4.4.1.1.1.1.2.cmml" xref="A2.p3.1.m1.4.4.1.1.1.1.2">
           conditional
          </csymbol>
          <apply id="A2.p3.1.m1.4.4.1.1.1.1.3.cmml" xref="A2.p3.1.m1.4.4.1.1.1.1.3">
           <csymbol cd="ambiguous" id="A2.p3.1.m1.4.4.1.1.1.1.3.1.cmml" xref="A2.p3.1.m1.4.4.1.1.1.1.3">
            subscript
           </csymbol>
           <ci id="A2.p3.1.m1.4.4.1.1.1.1.3.2.cmml" xref="A2.p3.1.m1.4.4.1.1.1.1.3.2">
            𝑤
           </ci>
           <ci id="A2.p3.1.m1.4.4.1.1.1.1.3.3.cmml" xref="A2.p3.1.m1.4.4.1.1.1.1.3.3">
            𝑗
           </ci>
          </apply>
          <list id="A2.p3.1.m1.4.4.1.1.1.1.1.2.cmml" xref="A2.p3.1.m1.4.4.1.1.1.1.1.1">
           <ci id="A2.p3.1.m1.1.1.cmml" xref="A2.p3.1.m1.1.1">
            𝑠
           </ci>
           <apply id="A2.p3.1.m1.4.4.1.1.1.1.1.1.1.cmml" xref="A2.p3.1.m1.4.4.1.1.1.1.1.1.1">
            <csymbol cd="ambiguous" id="A2.p3.1.m1.4.4.1.1.1.1.1.1.1.1.cmml" xref="A2.p3.1.m1.4.4.1.1.1.1.1.1.1">
             subscript
            </csymbol>
            <ci id="A2.p3.1.m1.4.4.1.1.1.1.1.1.1.2.cmml" xref="A2.p3.1.m1.4.4.1.1.1.1.1.1.1.2">
             𝑤
            </ci>
            <apply id="A2.p3.1.m1.4.4.1.1.1.1.1.1.1.3.cmml" xref="A2.p3.1.m1.4.4.1.1.1.1.1.1.1.3">
             <ci id="A2.p3.1.m1.4.4.1.1.1.1.1.1.1.3.1.cmml" xref="A2.p3.1.m1.4.4.1.1.1.1.1.1.1.3.1">
              :
             </ci>
             <cn id="A2.p3.1.m1.4.4.1.1.1.1.1.1.1.3.2.cmml" type="integer" xref="A2.p3.1.m1.4.4.1.1.1.1.1.1.1.3.2">
              1
             </cn>
             <apply id="A2.p3.1.m1.4.4.1.1.1.1.1.1.1.3.3.cmml" xref="A2.p3.1.m1.4.4.1.1.1.1.1.1.1.3.3">
              <minus id="A2.p3.1.m1.4.4.1.1.1.1.1.1.1.3.3.1.cmml" xref="A2.p3.1.m1.4.4.1.1.1.1.1.1.1.3.3.1">
              </minus>
              <ci id="A2.p3.1.m1.4.4.1.1.1.1.1.1.1.3.3.2.cmml" xref="A2.p3.1.m1.4.4.1.1.1.1.1.1.1.3.3.2">
               𝑗
              </ci>
              <cn id="A2.p3.1.m1.4.4.1.1.1.1.1.1.1.3.3.3.cmml" type="integer" xref="A2.p3.1.m1.4.4.1.1.1.1.1.1.1.3.3.3">
               1
              </cn>
             </apply>
            </apply>
           </apply>
          </list>
         </apply>
        </apply>
        <apply id="A2.p3.1.m1.5.5.2.2.cmml" xref="A2.p3.1.m1.5.5.2.1">
         <exp id="A2.p3.1.m1.3.3.cmml" xref="A2.p3.1.m1.3.3">
         </exp>
         <apply id="A2.p3.1.m1.5.5.2.1.1.1.cmml" xref="A2.p3.1.m1.5.5.2.1.1.1">
          <divide id="A2.p3.1.m1.5.5.2.1.1.1.3.cmml" xref="A2.p3.1.m1.5.5.2.1.1.1.3">
          </divide>
          <apply id="A2.p3.1.m1.5.5.2.1.1.1.2.cmml" xref="A2.p3.1.m1.5.5.2.1.1.1.2">
           <times id="A2.p3.1.m1.5.5.2.1.1.1.2.3.cmml" xref="A2.p3.1.m1.5.5.2.1.1.1.2.3">
           </times>
           <ci id="A2.p3.1.m1.5.5.2.1.1.1.2.4.cmml" xref="A2.p3.1.m1.5.5.2.1.1.1.2.4">
            𝑄
           </ci>
           <vector id="A2.p3.1.m1.5.5.2.1.1.1.2.2.3.cmml" xref="A2.p3.1.m1.5.5.2.1.1.1.2.2.2">
            <ci id="A2.p3.1.m1.2.2.cmml" xref="A2.p3.1.m1.2.2">
             𝑠
            </ci>
            <apply id="A2.p3.1.m1.5.5.2.1.1.1.1.1.1.1.cmml" xref="A2.p3.1.m1.5.5.2.1.1.1.1.1.1.1">
             <csymbol cd="ambiguous" id="A2.p3.1.m1.5.5.2.1.1.1.1.1.1.1.1.cmml" xref="A2.p3.1.m1.5.5.2.1.1.1.1.1.1.1">
              subscript
             </csymbol>
             <ci id="A2.p3.1.m1.5.5.2.1.1.1.1.1.1.1.2.cmml" xref="A2.p3.1.m1.5.5.2.1.1.1.1.1.1.1.2">
              𝑤
             </ci>
             <apply id="A2.p3.1.m1.5.5.2.1.1.1.1.1.1.1.3.cmml" xref="A2.p3.1.m1.5.5.2.1.1.1.1.1.1.1.3">
              <ci id="A2.p3.1.m1.5.5.2.1.1.1.1.1.1.1.3.1.cmml" xref="A2.p3.1.m1.5.5.2.1.1.1.1.1.1.1.3.1">
               :
              </ci>
              <cn id="A2.p3.1.m1.5.5.2.1.1.1.1.1.1.1.3.2.cmml" type="integer" xref="A2.p3.1.m1.5.5.2.1.1.1.1.1.1.1.3.2">
               1
              </cn>
              <apply id="A2.p3.1.m1.5.5.2.1.1.1.1.1.1.1.3.3.cmml" xref="A2.p3.1.m1.5.5.2.1.1.1.1.1.1.1.3.3">
               <minus id="A2.p3.1.m1.5.5.2.1.1.1.1.1.1.1.3.3.1.cmml" xref="A2.p3.1.m1.5.5.2.1.1.1.1.1.1.1.3.3.1">
               </minus>
               <ci id="A2.p3.1.m1.5.5.2.1.1.1.1.1.1.1.3.3.2.cmml" xref="A2.p3.1.m1.5.5.2.1.1.1.1.1.1.1.3.3.2">
                𝑗
               </ci>
               <cn id="A2.p3.1.m1.5.5.2.1.1.1.1.1.1.1.3.3.3.cmml" type="integer" xref="A2.p3.1.m1.5.5.2.1.1.1.1.1.1.1.3.3.3">
                1
               </cn>
              </apply>
             </apply>
            </apply>
            <apply id="A2.p3.1.m1.5.5.2.1.1.1.2.2.2.2.cmml" xref="A2.p3.1.m1.5.5.2.1.1.1.2.2.2.2">
             <csymbol cd="ambiguous" id="A2.p3.1.m1.5.5.2.1.1.1.2.2.2.2.1.cmml" xref="A2.p3.1.m1.5.5.2.1.1.1.2.2.2.2">
              subscript
             </csymbol>
             <ci id="A2.p3.1.m1.5.5.2.1.1.1.2.2.2.2.2.cmml" xref="A2.p3.1.m1.5.5.2.1.1.1.2.2.2.2.2">
              𝑤
             </ci>
             <ci id="A2.p3.1.m1.5.5.2.1.1.1.2.2.2.2.3.cmml" xref="A2.p3.1.m1.5.5.2.1.1.1.2.2.2.2.3">
              𝑗
             </ci>
            </apply>
           </vector>
          </apply>
          <ci id="A2.p3.1.m1.5.5.2.1.1.1.4.cmml" xref="A2.p3.1.m1.5.5.2.1.1.1.4">
           𝛽
          </ci>
         </apply>
        </apply>
       </apply>
      </annotation-xml>
      <annotation encoding="application/x-tex" id="A2.p3.1.m1.5c">
       \pi^{*}(w_{j}|s,w_{1:j-1})\propto\exp(Q(s,w_{1:j-1},w_{j})/\beta)
      </annotation>
     </semantics>
    </math>
    , we can update the policy toward minimizing the KL-Divergence between
    <math alttext="\pi(w_{j}|s,w_{1:j-1})" class="ltx_Math" display="inline" id="A2.p3.2.m2.2">
     <semantics id="A2.p3.2.m2.2a">
      <mrow id="A2.p3.2.m2.2.2" xref="A2.p3.2.m2.2.2.cmml">
       <mi id="A2.p3.2.m2.2.2.3" xref="A2.p3.2.m2.2.2.3.cmml">
        π
       </mi>
       <mo id="A2.p3.2.m2.2.2.2" lspace="0em" rspace="0em" xref="A2.p3.2.m2.2.2.2.cmml">
        ​
       </mo>
       <mrow id="A2.p3.2.m2.2.2.1.1" xref="A2.p3.2.m2.2.2.1.1.1.cmml">
        <mo id="A2.p3.2.m2.2.2.1.1.2" stretchy="false" xref="A2.p3.2.m2.2.2.1.1.1.cmml">
         (
        </mo>
        <mrow id="A2.p3.2.m2.2.2.1.1.1" xref="A2.p3.2.m2.2.2.1.1.1.cmml">
         <msub id="A2.p3.2.m2.2.2.1.1.1.3" xref="A2.p3.2.m2.2.2.1.1.1.3.cmml">
          <mi id="A2.p3.2.m2.2.2.1.1.1.3.2" xref="A2.p3.2.m2.2.2.1.1.1.3.2.cmml">
           w
          </mi>
          <mi id="A2.p3.2.m2.2.2.1.1.1.3.3" xref="A2.p3.2.m2.2.2.1.1.1.3.3.cmml">
           j
          </mi>
         </msub>
         <mo fence="false" id="A2.p3.2.m2.2.2.1.1.1.2" xref="A2.p3.2.m2.2.2.1.1.1.2.cmml">
          |
         </mo>
         <mrow id="A2.p3.2.m2.2.2.1.1.1.1.1" xref="A2.p3.2.m2.2.2.1.1.1.1.2.cmml">
          <mi id="A2.p3.2.m2.1.1" xref="A2.p3.2.m2.1.1.cmml">
           s
          </mi>
          <mo id="A2.p3.2.m2.2.2.1.1.1.1.1.2" xref="A2.p3.2.m2.2.2.1.1.1.1.2.cmml">
           ,
          </mo>
          <msub id="A2.p3.2.m2.2.2.1.1.1.1.1.1" xref="A2.p3.2.m2.2.2.1.1.1.1.1.1.cmml">
           <mi id="A2.p3.2.m2.2.2.1.1.1.1.1.1.2" xref="A2.p3.2.m2.2.2.1.1.1.1.1.1.2.cmml">
            w
           </mi>
           <mrow id="A2.p3.2.m2.2.2.1.1.1.1.1.1.3" xref="A2.p3.2.m2.2.2.1.1.1.1.1.1.3.cmml">
            <mn id="A2.p3.2.m2.2.2.1.1.1.1.1.1.3.2" xref="A2.p3.2.m2.2.2.1.1.1.1.1.1.3.2.cmml">
             1
            </mn>
            <mo id="A2.p3.2.m2.2.2.1.1.1.1.1.1.3.1" lspace="0.278em" rspace="0.278em" xref="A2.p3.2.m2.2.2.1.1.1.1.1.1.3.1.cmml">
             :
            </mo>
            <mrow id="A2.p3.2.m2.2.2.1.1.1.1.1.1.3.3" xref="A2.p3.2.m2.2.2.1.1.1.1.1.1.3.3.cmml">
             <mi id="A2.p3.2.m2.2.2.1.1.1.1.1.1.3.3.2" xref="A2.p3.2.m2.2.2.1.1.1.1.1.1.3.3.2.cmml">
              j
             </mi>
             <mo id="A2.p3.2.m2.2.2.1.1.1.1.1.1.3.3.1" xref="A2.p3.2.m2.2.2.1.1.1.1.1.1.3.3.1.cmml">
              −
             </mo>
             <mn id="A2.p3.2.m2.2.2.1.1.1.1.1.1.3.3.3" xref="A2.p3.2.m2.2.2.1.1.1.1.1.1.3.3.3.cmml">
              1
             </mn>
            </mrow>
           </mrow>
          </msub>
         </mrow>
        </mrow>
        <mo id="A2.p3.2.m2.2.2.1.1.3" stretchy="false" xref="A2.p3.2.m2.2.2.1.1.1.cmml">
         )
        </mo>
       </mrow>
      </mrow>
      <annotation-xml encoding="MathML-Content" id="A2.p3.2.m2.2b">
       <apply id="A2.p3.2.m2.2.2.cmml" xref="A2.p3.2.m2.2.2">
        <times id="A2.p3.2.m2.2.2.2.cmml" xref="A2.p3.2.m2.2.2.2">
        </times>
        <ci id="A2.p3.2.m2.2.2.3.cmml" xref="A2.p3.2.m2.2.2.3">
         𝜋
        </ci>
        <apply id="A2.p3.2.m2.2.2.1.1.1.cmml" xref="A2.p3.2.m2.2.2.1.1">
         <csymbol cd="latexml" id="A2.p3.2.m2.2.2.1.1.1.2.cmml" xref="A2.p3.2.m2.2.2.1.1.1.2">
          conditional
         </csymbol>
         <apply id="A2.p3.2.m2.2.2.1.1.1.3.cmml" xref="A2.p3.2.m2.2.2.1.1.1.3">
          <csymbol cd="ambiguous" id="A2.p3.2.m2.2.2.1.1.1.3.1.cmml" xref="A2.p3.2.m2.2.2.1.1.1.3">
           subscript
          </csymbol>
          <ci id="A2.p3.2.m2.2.2.1.1.1.3.2.cmml" xref="A2.p3.2.m2.2.2.1.1.1.3.2">
           𝑤
          </ci>
          <ci id="A2.p3.2.m2.2.2.1.1.1.3.3.cmml" xref="A2.p3.2.m2.2.2.1.1.1.3.3">
           𝑗
          </ci>
         </apply>
         <list id="A2.p3.2.m2.2.2.1.1.1.1.2.cmml" xref="A2.p3.2.m2.2.2.1.1.1.1.1">
          <ci id="A2.p3.2.m2.1.1.cmml" xref="A2.p3.2.m2.1.1">
           𝑠
          </ci>
          <apply id="A2.p3.2.m2.2.2.1.1.1.1.1.1.cmml" xref="A2.p3.2.m2.2.2.1.1.1.1.1.1">
           <csymbol cd="ambiguous" id="A2.p3.2.m2.2.2.1.1.1.1.1.1.1.cmml" xref="A2.p3.2.m2.2.2.1.1.1.1.1.1">
            subscript
           </csymbol>
           <ci id="A2.p3.2.m2.2.2.1.1.1.1.1.1.2.cmml" xref="A2.p3.2.m2.2.2.1.1.1.1.1.1.2">
            𝑤
           </ci>
           <apply id="A2.p3.2.m2.2.2.1.1.1.1.1.1.3.cmml" xref="A2.p3.2.m2.2.2.1.1.1.1.1.1.3">
            <ci id="A2.p3.2.m2.2.2.1.1.1.1.1.1.3.1.cmml" xref="A2.p3.2.m2.2.2.1.1.1.1.1.1.3.1">
             :
            </ci>
            <cn id="A2.p3.2.m2.2.2.1.1.1.1.1.1.3.2.cmml" type="integer" xref="A2.p3.2.m2.2.2.1.1.1.1.1.1.3.2">
             1
            </cn>
            <apply id="A2.p3.2.m2.2.2.1.1.1.1.1.1.3.3.cmml" xref="A2.p3.2.m2.2.2.1.1.1.1.1.1.3.3">
             <minus id="A2.p3.2.m2.2.2.1.1.1.1.1.1.3.3.1.cmml" xref="A2.p3.2.m2.2.2.1.1.1.1.1.1.3.3.1">
             </minus>
             <ci id="A2.p3.2.m2.2.2.1.1.1.1.1.1.3.3.2.cmml" xref="A2.p3.2.m2.2.2.1.1.1.1.1.1.3.3.2">
              𝑗
             </ci>
             <cn id="A2.p3.2.m2.2.2.1.1.1.1.1.1.3.3.3.cmml" type="integer" xref="A2.p3.2.m2.2.2.1.1.1.1.1.1.3.3.3">
              1
             </cn>
            </apply>
           </apply>
          </apply>
         </list>
        </apply>
       </apply>
      </annotation-xml>
      <annotation encoding="application/x-tex" id="A2.p3.2.m2.2c">
       \pi(w_{j}|s,w_{1:j-1})
      </annotation>
     </semantics>
    </math>
    and
    <math alttext="\exp(Q(s,w_{1:j-1},w_{j})/\beta)" class="ltx_Math" display="inline" id="A2.p3.3.m3.3">
     <semantics id="A2.p3.3.m3.3a">
      <mrow id="A2.p3.3.m3.3.3.1" xref="A2.p3.3.m3.3.3.2.cmml">
       <mi id="A2.p3.3.m3.2.2" xref="A2.p3.3.m3.2.2.cmml">
        exp
       </mi>
       <mo id="A2.p3.3.m3.3.3.1a" xref="A2.p3.3.m3.3.3.2.cmml">
        ⁡
       </mo>
       <mrow id="A2.p3.3.m3.3.3.1.1" xref="A2.p3.3.m3.3.3.2.cmml">
        <mo id="A2.p3.3.m3.3.3.1.1.2" stretchy="false" xref="A2.p3.3.m3.3.3.2.cmml">
         (
        </mo>
        <mrow id="A2.p3.3.m3.3.3.1.1.1" xref="A2.p3.3.m3.3.3.1.1.1.cmml">
         <mrow id="A2.p3.3.m3.3.3.1.1.1.2" xref="A2.p3.3.m3.3.3.1.1.1.2.cmml">
          <mi id="A2.p3.3.m3.3.3.1.1.1.2.4" xref="A2.p3.3.m3.3.3.1.1.1.2.4.cmml">
           Q
          </mi>
          <mo id="A2.p3.3.m3.3.3.1.1.1.2.3" lspace="0em" rspace="0em" xref="A2.p3.3.m3.3.3.1.1.1.2.3.cmml">
           ​
          </mo>
          <mrow id="A2.p3.3.m3.3.3.1.1.1.2.2.2" xref="A2.p3.3.m3.3.3.1.1.1.2.2.3.cmml">
           <mo id="A2.p3.3.m3.3.3.1.1.1.2.2.2.3" stretchy="false" xref="A2.p3.3.m3.3.3.1.1.1.2.2.3.cmml">
            (
           </mo>
           <mi id="A2.p3.3.m3.1.1" xref="A2.p3.3.m3.1.1.cmml">
            s
           </mi>
           <mo id="A2.p3.3.m3.3.3.1.1.1.2.2.2.4" xref="A2.p3.3.m3.3.3.1.1.1.2.2.3.cmml">
            ,
           </mo>
           <msub id="A2.p3.3.m3.3.3.1.1.1.1.1.1.1" xref="A2.p3.3.m3.3.3.1.1.1.1.1.1.1.cmml">
            <mi id="A2.p3.3.m3.3.3.1.1.1.1.1.1.1.2" xref="A2.p3.3.m3.3.3.1.1.1.1.1.1.1.2.cmml">
             w
            </mi>
            <mrow id="A2.p3.3.m3.3.3.1.1.1.1.1.1.1.3" xref="A2.p3.3.m3.3.3.1.1.1.1.1.1.1.3.cmml">
             <mn id="A2.p3.3.m3.3.3.1.1.1.1.1.1.1.3.2" xref="A2.p3.3.m3.3.3.1.1.1.1.1.1.1.3.2.cmml">
              1
             </mn>
             <mo id="A2.p3.3.m3.3.3.1.1.1.1.1.1.1.3.1" lspace="0.278em" rspace="0.278em" xref="A2.p3.3.m3.3.3.1.1.1.1.1.1.1.3.1.cmml">
              :
             </mo>
             <mrow id="A2.p3.3.m3.3.3.1.1.1.1.1.1.1.3.3" xref="A2.p3.3.m3.3.3.1.1.1.1.1.1.1.3.3.cmml">
              <mi id="A2.p3.3.m3.3.3.1.1.1.1.1.1.1.3.3.2" xref="A2.p3.3.m3.3.3.1.1.1.1.1.1.1.3.3.2.cmml">
               j
              </mi>
              <mo id="A2.p3.3.m3.3.3.1.1.1.1.1.1.1.3.3.1" xref="A2.p3.3.m3.3.3.1.1.1.1.1.1.1.3.3.1.cmml">
               −
              </mo>
              <mn id="A2.p3.3.m3.3.3.1.1.1.1.1.1.1.3.3.3" xref="A2.p3.3.m3.3.3.1.1.1.1.1.1.1.3.3.3.cmml">
               1
              </mn>
             </mrow>
            </mrow>
           </msub>
           <mo id="A2.p3.3.m3.3.3.1.1.1.2.2.2.5" xref="A2.p3.3.m3.3.3.1.1.1.2.2.3.cmml">
            ,
           </mo>
           <msub id="A2.p3.3.m3.3.3.1.1.1.2.2.2.2" xref="A2.p3.3.m3.3.3.1.1.1.2.2.2.2.cmml">
            <mi id="A2.p3.3.m3.3.3.1.1.1.2.2.2.2.2" xref="A2.p3.3.m3.3.3.1.1.1.2.2.2.2.2.cmml">
             w
            </mi>
            <mi id="A2.p3.3.m3.3.3.1.1.1.2.2.2.2.3" xref="A2.p3.3.m3.3.3.1.1.1.2.2.2.2.3.cmml">
             j
            </mi>
           </msub>
           <mo id="A2.p3.3.m3.3.3.1.1.1.2.2.2.6" stretchy="false" xref="A2.p3.3.m3.3.3.1.1.1.2.2.3.cmml">
            )
           </mo>
          </mrow>
         </mrow>
         <mo id="A2.p3.3.m3.3.3.1.1.1.3" xref="A2.p3.3.m3.3.3.1.1.1.3.cmml">
          /
         </mo>
         <mi id="A2.p3.3.m3.3.3.1.1.1.4" xref="A2.p3.3.m3.3.3.1.1.1.4.cmml">
          β
         </mi>
        </mrow>
        <mo id="A2.p3.3.m3.3.3.1.1.3" stretchy="false" xref="A2.p3.3.m3.3.3.2.cmml">
         )
        </mo>
       </mrow>
      </mrow>
      <annotation-xml encoding="MathML-Content" id="A2.p3.3.m3.3b">
       <apply id="A2.p3.3.m3.3.3.2.cmml" xref="A2.p3.3.m3.3.3.1">
        <exp id="A2.p3.3.m3.2.2.cmml" xref="A2.p3.3.m3.2.2">
        </exp>
        <apply id="A2.p3.3.m3.3.3.1.1.1.cmml" xref="A2.p3.3.m3.3.3.1.1.1">
         <divide id="A2.p3.3.m3.3.3.1.1.1.3.cmml" xref="A2.p3.3.m3.3.3.1.1.1.3">
         </divide>
         <apply id="A2.p3.3.m3.3.3.1.1.1.2.cmml" xref="A2.p3.3.m3.3.3.1.1.1.2">
          <times id="A2.p3.3.m3.3.3.1.1.1.2.3.cmml" xref="A2.p3.3.m3.3.3.1.1.1.2.3">
          </times>
          <ci id="A2.p3.3.m3.3.3.1.1.1.2.4.cmml" xref="A2.p3.3.m3.3.3.1.1.1.2.4">
           𝑄
          </ci>
          <vector id="A2.p3.3.m3.3.3.1.1.1.2.2.3.cmml" xref="A2.p3.3.m3.3.3.1.1.1.2.2.2">
           <ci id="A2.p3.3.m3.1.1.cmml" xref="A2.p3.3.m3.1.1">
            𝑠
           </ci>
           <apply id="A2.p3.3.m3.3.3.1.1.1.1.1.1.1.cmml" xref="A2.p3.3.m3.3.3.1.1.1.1.1.1.1">
            <csymbol cd="ambiguous" id="A2.p3.3.m3.3.3.1.1.1.1.1.1.1.1.cmml" xref="A2.p3.3.m3.3.3.1.1.1.1.1.1.1">
             subscript
            </csymbol>
            <ci id="A2.p3.3.m3.3.3.1.1.1.1.1.1.1.2.cmml" xref="A2.p3.3.m3.3.3.1.1.1.1.1.1.1.2">
             𝑤
            </ci>
            <apply id="A2.p3.3.m3.3.3.1.1.1.1.1.1.1.3.cmml" xref="A2.p3.3.m3.3.3.1.1.1.1.1.1.1.3">
             <ci id="A2.p3.3.m3.3.3.1.1.1.1.1.1.1.3.1.cmml" xref="A2.p3.3.m3.3.3.1.1.1.1.1.1.1.3.1">
              :
             </ci>
             <cn id="A2.p3.3.m3.3.3.1.1.1.1.1.1.1.3.2.cmml" type="integer" xref="A2.p3.3.m3.3.3.1.1.1.1.1.1.1.3.2">
              1
             </cn>
             <apply id="A2.p3.3.m3.3.3.1.1.1.1.1.1.1.3.3.cmml" xref="A2.p3.3.m3.3.3.1.1.1.1.1.1.1.3.3">
              <minus id="A2.p3.3.m3.3.3.1.1.1.1.1.1.1.3.3.1.cmml" xref="A2.p3.3.m3.3.3.1.1.1.1.1.1.1.3.3.1">
              </minus>
              <ci id="A2.p3.3.m3.3.3.1.1.1.1.1.1.1.3.3.2.cmml" xref="A2.p3.3.m3.3.3.1.1.1.1.1.1.1.3.3.2">
               𝑗
              </ci>
              <cn id="A2.p3.3.m3.3.3.1.1.1.1.1.1.1.3.3.3.cmml" type="integer" xref="A2.p3.3.m3.3.3.1.1.1.1.1.1.1.3.3.3">
               1
              </cn>
             </apply>
            </apply>
           </apply>
           <apply id="A2.p3.3.m3.3.3.1.1.1.2.2.2.2.cmml" xref="A2.p3.3.m3.3.3.1.1.1.2.2.2.2">
            <csymbol cd="ambiguous" id="A2.p3.3.m3.3.3.1.1.1.2.2.2.2.1.cmml" xref="A2.p3.3.m3.3.3.1.1.1.2.2.2.2">
             subscript
            </csymbol>
            <ci id="A2.p3.3.m3.3.3.1.1.1.2.2.2.2.2.cmml" xref="A2.p3.3.m3.3.3.1.1.1.2.2.2.2.2">
             𝑤
            </ci>
            <ci id="A2.p3.3.m3.3.3.1.1.1.2.2.2.2.3.cmml" xref="A2.p3.3.m3.3.3.1.1.1.2.2.2.2.3">
             𝑗
            </ci>
           </apply>
          </vector>
         </apply>
         <ci id="A2.p3.3.m3.3.3.1.1.1.4.cmml" xref="A2.p3.3.m3.3.3.1.1.1.4">
          𝛽
         </ci>
        </apply>
       </apply>
      </annotation-xml>
      <annotation encoding="application/x-tex" id="A2.p3.3.m3.3c">
       \exp(Q(s,w_{1:j-1},w_{j})/\beta)
      </annotation>
     </semantics>
    </math>
    :
   </p>
   <table class="ltx_equationgroup ltx_eqn_align ltx_eqn_table" id="A7.EGx17">
    <tbody id="A2.E15">
     <tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
      <td class="ltx_eqn_cell ltx_eqn_center_padleft">
      </td>
      <td class="ltx_td ltx_align_right ltx_eqn_cell">
       <math alttext="\displaystyle\pi_{\text{new}}(w_{j}|s,w_{1:j-1})=\arg\min_{\pi}\text{KL}\Big{[}\pi(w_{j}|s,w_{1:j-1})||\exp(Q(s,w_{1:j-1},w_{j})/\beta)\Big{]}." class="ltx_math_unparsed" display="inline" id="A2.E15.m1.4">
        <semantics id="A2.E15.m1.4a">
         <mrow id="A2.E15.m1.4b">
          <msub id="A2.E15.m1.4.5">
           <mi id="A2.E15.m1.4.5.2">
            π
           </mi>
           <mtext id="A2.E15.m1.4.5.3">
            new
           </mtext>
          </msub>
          <mrow id="A2.E15.m1.4.6">
           <mo id="A2.E15.m1.4.6.1" stretchy="false">
            (
           </mo>
           <msub id="A2.E15.m1.4.6.2">
            <mi id="A2.E15.m1.4.6.2.2">
             w
            </mi>
            <mi id="A2.E15.m1.4.6.2.3">
             j
            </mi>
           </msub>
           <mo fence="false" id="A2.E15.m1.4.6.3" rspace="0.167em" stretchy="false">
            |
           </mo>
           <mi id="A2.E15.m1.1.1">
            s
           </mi>
           <mo id="A2.E15.m1.4.6.4">
            ,
           </mo>
           <msub id="A2.E15.m1.4.6.5">
            <mi id="A2.E15.m1.4.6.5.2">
             w
            </mi>
            <mrow id="A2.E15.m1.4.6.5.3">
             <mn id="A2.E15.m1.4.6.5.3.2">
              1
             </mn>
             <mo id="A2.E15.m1.4.6.5.3.1" lspace="0.278em" rspace="0.278em">
              :
             </mo>
             <mrow id="A2.E15.m1.4.6.5.3.3">
              <mi id="A2.E15.m1.4.6.5.3.3.2">
               j
              </mi>
              <mo id="A2.E15.m1.4.6.5.3.3.1">
               −
              </mo>
              <mn id="A2.E15.m1.4.6.5.3.3.3">
               1
              </mn>
             </mrow>
            </mrow>
           </msub>
           <mo id="A2.E15.m1.4.6.6" stretchy="false">
            )
           </mo>
          </mrow>
          <mo id="A2.E15.m1.4.7">
           =
          </mo>
          <mi id="A2.E15.m1.4.8">
           arg
          </mi>
          <munder id="A2.E15.m1.4.9">
           <mi id="A2.E15.m1.4.9.2">
            min
           </mi>
           <mi id="A2.E15.m1.4.9.3">
            π
           </mi>
          </munder>
          <mtext id="A2.E15.m1.4.10">
           KL
          </mtext>
          <mrow id="A2.E15.m1.4.11">
           <mo id="A2.E15.m1.4.11.1" maxsize="160%" minsize="160%">
            [
           </mo>
           <mi id="A2.E15.m1.4.11.2">
            π
           </mi>
           <mrow id="A2.E15.m1.4.11.3">
            <mo id="A2.E15.m1.4.11.3.1" stretchy="false">
             (
            </mo>
            <msub id="A2.E15.m1.4.11.3.2">
             <mi id="A2.E15.m1.4.11.3.2.2">
              w
             </mi>
             <mi id="A2.E15.m1.4.11.3.2.3">
              j
             </mi>
            </msub>
            <mo fence="false" id="A2.E15.m1.4.11.3.3" rspace="0.167em" stretchy="false">
             |
            </mo>
            <mi id="A2.E15.m1.2.2">
             s
            </mi>
            <mo id="A2.E15.m1.4.11.3.4">
             ,
            </mo>
            <msub id="A2.E15.m1.4.11.3.5">
             <mi id="A2.E15.m1.4.11.3.5.2">
              w
             </mi>
             <mrow id="A2.E15.m1.4.11.3.5.3">
              <mn id="A2.E15.m1.4.11.3.5.3.2">
               1
              </mn>
              <mo id="A2.E15.m1.4.11.3.5.3.1" lspace="0.278em" rspace="0.278em">
               :
              </mo>
              <mrow id="A2.E15.m1.4.11.3.5.3.3">
               <mi id="A2.E15.m1.4.11.3.5.3.3.2">
                j
               </mi>
               <mo id="A2.E15.m1.4.11.3.5.3.3.1">
                −
               </mo>
               <mn id="A2.E15.m1.4.11.3.5.3.3.3">
                1
               </mn>
              </mrow>
             </mrow>
            </msub>
            <mo id="A2.E15.m1.4.11.3.6" stretchy="false">
             )
            </mo>
           </mrow>
           <mo fence="false" id="A2.E15.m1.4.11.4" rspace="0.167em" stretchy="false">
            |
           </mo>
           <mo fence="false" id="A2.E15.m1.4.11.5" rspace="0.167em" stretchy="false">
            |
           </mo>
           <mi id="A2.E15.m1.4.4">
            exp
           </mi>
           <mrow id="A2.E15.m1.4.11.6">
            <mo id="A2.E15.m1.4.11.6.1" stretchy="false">
             (
            </mo>
            <mi id="A2.E15.m1.4.11.6.2">
             Q
            </mi>
            <mrow id="A2.E15.m1.4.11.6.3">
             <mo id="A2.E15.m1.4.11.6.3.1" stretchy="false">
              (
             </mo>
             <mi id="A2.E15.m1.3.3">
              s
             </mi>
             <mo id="A2.E15.m1.4.11.6.3.2">
              ,
             </mo>
             <msub id="A2.E15.m1.4.11.6.3.3">
              <mi id="A2.E15.m1.4.11.6.3.3.2">
               w
              </mi>
              <mrow id="A2.E15.m1.4.11.6.3.3.3">
               <mn id="A2.E15.m1.4.11.6.3.3.3.2">
                1
               </mn>
               <mo id="A2.E15.m1.4.11.6.3.3.3.1" lspace="0.278em" rspace="0.278em">
                :
               </mo>
               <mrow id="A2.E15.m1.4.11.6.3.3.3.3">
                <mi id="A2.E15.m1.4.11.6.3.3.3.3.2">
                 j
                </mi>
                <mo id="A2.E15.m1.4.11.6.3.3.3.3.1">
                 −
                </mo>
                <mn id="A2.E15.m1.4.11.6.3.3.3.3.3">
                 1
                </mn>
               </mrow>
              </mrow>
             </msub>
             <mo id="A2.E15.m1.4.11.6.3.4">
              ,
             </mo>
             <msub id="A2.E15.m1.4.11.6.3.5">
              <mi id="A2.E15.m1.4.11.6.3.5.2">
               w
              </mi>
              <mi id="A2.E15.m1.4.11.6.3.5.3">
               j
              </mi>
             </msub>
             <mo id="A2.E15.m1.4.11.6.3.6" stretchy="false">
              )
             </mo>
            </mrow>
            <mo id="A2.E15.m1.4.11.6.4">
             /
            </mo>
            <mi id="A2.E15.m1.4.11.6.5">
             β
            </mi>
            <mo id="A2.E15.m1.4.11.6.6" stretchy="false">
             )
            </mo>
           </mrow>
           <mo id="A2.E15.m1.4.11.7" maxsize="160%" minsize="160%">
            ]
           </mo>
          </mrow>
          <mo id="A2.E15.m1.4.12" lspace="0em">
           .
          </mo>
         </mrow>
         <annotation encoding="application/x-tex" id="A2.E15.m1.4c">
          \displaystyle\pi_{\text{new}}(w_{j}|s,w_{1:j-1})=\arg\min_{\pi}\text{KL}\Big{[}\pi(w_{j}|s,w_{1:j-1})||\exp(Q(s,w_{1:j-1},w_{j})/\beta)\Big{]}.
         </annotation>
        </semantics>
       </math>
      </td>
      <td class="ltx_eqn_cell ltx_eqn_center_padright">
      </td>
      <td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1">
       <span class="ltx_tag ltx_tag_equation ltx_align_right">
        (15)
       </span>
      </td>
     </tr>
    </tbody>
   </table>
  </div>
  <div class="ltx_para" id="A2.p4">
   <p class="ltx_p" id="A2.p4.1">
    In practice, we only take one gradient step on this objective, similar to the policy improvement step in SAC.
   </p>
  </div>
  <div class="ltx_pagination ltx_role_newpage">
  </div>
 </section>
 <section class="ltx_appendix" id="A3">
  <h2 class="ltx_title ltx_title_appendix">
   <span class="ltx_tag ltx_tag_appendix">
    Appendix C
   </span>
   Details Pipeline of Experiment
  </h2>
  <figure class="ltx_figure" id="A3.F5">
   <p class="ltx_p ltx_align_center ltx_align_center" id="A3.F5.1.1">
    <span class="ltx_text" id="A3.F5.1.1.1">
     <img alt="Refer to caption" class="ltx_graphics ltx_img_square" height="470" id="A3.F5.1.1.1.g1" src="/html/2402.06700/assets/x4.png" width="461"/>
    </span>
   </p>
   <figcaption class="ltx_caption ltx_centering">
    <span class="ltx_tag ltx_tag_figure">
     Figure 5:
    </span>
    Detailed pipeline of applying ETPO to the data science code generation task, where the yellow curve demonstrates the sampling process and the red curve indicates the training loop. The dotted line means the soft Q network is initialized with the policy network, i.e. the LLM, at the beginning. The code generated by LLM agents will be used to replace the “
    <span class="ltx_text ltx_font_bold" id="A3.F5.3.1">
     FILL_ME
    </span>
    ” component in the states.
   </figcaption>
  </figure>
  <div class="ltx_pagination ltx_role_newpage">
  </div>
 </section>
 <section class="ltx_appendix" id="A4">
  <h2 class="ltx_title ltx_title_appendix">
   <span class="ltx_tag ltx_tag_appendix">
    Appendix D
   </span>
   Simple Prompts
  </h2>
  <figure class="ltx_figure" id="A4.F7">
   <div class="ltx_flex_figure">
    <div class="ltx_flex_cell ltx_flex_size_1">
     <figure class="ltx_figure ltx_figure_panel ltx_minipage ltx_align_center ltx_align_middle" id="A4.F7.3" style="width:433.6pt;">
      <figure class="ltx_float ltx_lstlisting" id="A4.F7.1.tab1">
       <div class="ltx_listing ltx_lst_language_diff ltx_lstlisting ltx_listing" id="A4.F7.1.tab1.1">
        <div class="ltx_listing_data">
         <a download="prompt_code.txt" href="data:text/plain;base64,IiIiQ2xhc3NpZmljYXRpb24gd2l0aCBhIFBoYXJ5bmdpdGlzIFByZWRpY3Rpb24gRGF0YXNldCIiIgppbXBvcnQgbnVtcHkgYXMgbnAKCmRlZiBidWlsZF9tb2RlbCh4X3RyYWluOiBucC5uZGFycmF5LCB5X3RyYWluOiBucC5uZGFycmF5KToKICAgICIiIkltcG9ydCBtb2R1bGVzLCByZXR1cm4gYSBzY2lraXQgbW9kZWwgdHJhaW5lZCB3aXRoIHhfdHJhaW4gaW4gc2hhcGUgKDI1NiwgMTgpLiIiIgogICAgZnJvbSBza2xlYXJuLnN2bSBpbXBvcnQgU1ZDCiAgICBtb2RlbCA9IFNWQyhDPTEwMCwga2VybmVsPSdyYmYnKQogICAgbW9kZWwuZml0KHhfdHJhaW4sIHlfdHJhaW4pCiAgICByZXR1cm4gbW9kZWwK">
          ⬇
         </a>
        </div>
        <div class="ltx_listingline" id="lstnumberx20">
         <span class="ltx_text ltx_lst_comment ltx_font_typewriter ltx_font_italic" id="lstnumberx20.1" style="font-size:80%;">
          """Classification
          <span class="ltx_text ltx_lst_space" id="lstnumberx20.1.1">
          </span>
          with
          <span class="ltx_text ltx_lst_space" id="lstnumberx20.1.2">
          </span>
          a
          <span class="ltx_text ltx_lst_space" id="lstnumberx20.1.3">
          </span>
          Pharyngitis
          <span class="ltx_text ltx_lst_space" id="lstnumberx20.1.4">
          </span>
          Prediction
          <span class="ltx_text ltx_lst_space" id="lstnumberx20.1.5">
          </span>
          Dataset"""
         </span>
        </div>
        <div class="ltx_listingline" id="lstnumberx21">
         <span class="ltx_text ltx_font_typewriter ltx_font_italic" id="lstnumberx21.1" style="font-size:80%;">
          import
         </span>
         <span class="ltx_text ltx_lst_space ltx_font_typewriter ltx_font_italic" id="lstnumberx21.2" style="font-size:80%;">
         </span>
         <span class="ltx_text ltx_font_typewriter ltx_font_italic" id="lstnumberx21.3" style="font-size:80%;">
          numpy
         </span>
         <span class="ltx_text ltx_lst_space ltx_font_typewriter ltx_font_italic" id="lstnumberx21.4" style="font-size:80%;">
         </span>
         <span class="ltx_text ltx_font_typewriter ltx_font_italic" id="lstnumberx21.5" style="font-size:80%;">
          as
         </span>
         <span class="ltx_text ltx_lst_space ltx_font_typewriter ltx_font_italic" id="lstnumberx21.6" style="font-size:80%;">
         </span>
         <span class="ltx_text ltx_font_typewriter ltx_font_italic" id="lstnumberx21.7" style="font-size:80%;">
          np
         </span>
        </div>
        <div class="ltx_listingline" id="lstnumberx22">
        </div>
        <div class="ltx_listingline" id="lstnumberx23">
         <span class="ltx_text ltx_font_typewriter ltx_font_italic" id="lstnumberx23.1" style="font-size:80%;">
          def
         </span>
         <span class="ltx_text ltx_lst_space ltx_font_typewriter ltx_font_italic" id="lstnumberx23.2" style="font-size:80%;">
         </span>
         <span class="ltx_text ltx_font_typewriter ltx_font_italic" id="lstnumberx23.3" style="font-size:80%;">
          build_model(x_train:
         </span>
         <span class="ltx_text ltx_lst_space ltx_font_typewriter ltx_font_italic" id="lstnumberx23.4" style="font-size:80%;">
         </span>
         <span class="ltx_text ltx_font_typewriter ltx_font_italic" id="lstnumberx23.5" style="font-size:80%;">
          np.ndarray,
         </span>
         <span class="ltx_text ltx_lst_space ltx_font_typewriter ltx_font_italic" id="lstnumberx23.6" style="font-size:80%;">
         </span>
         <span class="ltx_text ltx_font_typewriter ltx_font_italic" id="lstnumberx23.7" style="font-size:80%;">
          y_train:
         </span>
         <span class="ltx_text ltx_lst_space ltx_font_typewriter ltx_font_italic" id="lstnumberx23.8" style="font-size:80%;">
         </span>
         <span class="ltx_text ltx_font_typewriter ltx_font_italic" id="lstnumberx23.9" style="font-size:80%;">
          np.ndarray):
         </span>
        </div>
        <div class="ltx_listingline" id="lstnumberx24">
         <span class="ltx_text ltx_lst_space ltx_font_typewriter ltx_font_italic" id="lstnumberx24.1" style="font-size:80%;">
         </span>
         <span class="ltx_text ltx_font_typewriter ltx_font_italic" id="lstnumberx24.2" style="font-size:80%;">
          """Import
         </span>
         <span class="ltx_text ltx_lst_space ltx_font_typewriter ltx_font_italic" id="lstnumberx24.3" style="font-size:80%;">
         </span>
         <span class="ltx_text ltx_font_typewriter ltx_font_italic" id="lstnumberx24.4" style="font-size:80%;">
          modules,
         </span>
         <span class="ltx_text ltx_lst_space ltx_font_typewriter ltx_font_italic" id="lstnumberx24.5" style="font-size:80%;">
         </span>
         <span class="ltx_text ltx_font_typewriter ltx_font_italic" id="lstnumberx24.6" style="font-size:80%;">
          return
         </span>
         <span class="ltx_text ltx_lst_space ltx_font_typewriter ltx_font_italic" id="lstnumberx24.7" style="font-size:80%;">
         </span>
         <span class="ltx_text ltx_font_typewriter ltx_font_italic" id="lstnumberx24.8" style="font-size:80%;">
          a
         </span>
         <span class="ltx_text ltx_lst_space ltx_font_typewriter ltx_font_italic" id="lstnumberx24.9" style="font-size:80%;">
         </span>
         <span class="ltx_text ltx_font_typewriter ltx_font_italic" id="lstnumberx24.10" style="font-size:80%;">
          scikit
         </span>
         <span class="ltx_text ltx_lst_space ltx_font_typewriter ltx_font_italic" id="lstnumberx24.11" style="font-size:80%;">
         </span>
         <span class="ltx_text ltx_font_typewriter ltx_font_italic" id="lstnumberx24.12" style="font-size:80%;">
          model
         </span>
         <span class="ltx_text ltx_lst_space ltx_font_typewriter ltx_font_italic" id="lstnumberx24.13" style="font-size:80%;">
         </span>
         <span class="ltx_text ltx_font_typewriter ltx_font_italic" id="lstnumberx24.14" style="font-size:80%;">
          trained
         </span>
         <span class="ltx_text ltx_lst_space ltx_font_typewriter ltx_font_italic" id="lstnumberx24.15" style="font-size:80%;">
         </span>
         <span class="ltx_text ltx_font_typewriter ltx_font_italic" id="lstnumberx24.16" style="font-size:80%;">
          with
         </span>
         <span class="ltx_text ltx_lst_space ltx_font_typewriter ltx_font_italic" id="lstnumberx24.17" style="font-size:80%;">
         </span>
         <span class="ltx_text ltx_font_typewriter ltx_font_italic" id="lstnumberx24.18" style="font-size:80%;">
          x_train
         </span>
         <span class="ltx_text ltx_lst_space ltx_font_typewriter ltx_font_italic" id="lstnumberx24.19" style="font-size:80%;">
         </span>
         <span class="ltx_text ltx_font_typewriter ltx_font_italic" id="lstnumberx24.20" style="font-size:80%;">
          in
         </span>
         <span class="ltx_text ltx_lst_space ltx_font_typewriter ltx_font_italic" id="lstnumberx24.21" style="font-size:80%;">
         </span>
         <span class="ltx_text ltx_font_typewriter ltx_font_italic" id="lstnumberx24.22" style="font-size:80%;">
          shape
         </span>
         <span class="ltx_text ltx_lst_space ltx_font_typewriter ltx_font_italic" id="lstnumberx24.23" style="font-size:80%;">
         </span>
         <span class="ltx_text ltx_font_typewriter ltx_font_italic" id="lstnumberx24.24" style="font-size:80%;">
          (256,
         </span>
         <span class="ltx_text ltx_lst_space ltx_font_typewriter ltx_font_italic" id="lstnumberx24.25" style="font-size:80%;">
         </span>
         <span class="ltx_text ltx_font_typewriter ltx_font_italic" id="lstnumberx24.26" style="font-size:80%;">
          18)."""
         </span>
        </div>
        <div class="ltx_listingline" id="lstnumberx25">
         <span class="ltx_text ltx_lst_space ltx_font_typewriter ltx_font_italic" id="lstnumberx25.1" style="font-size:80%;">
         </span>
         <span class="ltx_text ltx_font_typewriter ltx_font_italic" id="lstnumberx25.2" style="font-size:80%;">
          from
         </span>
         <span class="ltx_text ltx_lst_space ltx_font_typewriter ltx_font_italic" id="lstnumberx25.3" style="font-size:80%;">
         </span>
         <span class="ltx_text ltx_font_typewriter ltx_font_italic" id="lstnumberx25.4" style="font-size:80%;">
          sklearn.svm
         </span>
         <span class="ltx_text ltx_lst_space ltx_font_typewriter ltx_font_italic" id="lstnumberx25.5" style="font-size:80%;">
         </span>
         <span class="ltx_text ltx_font_typewriter ltx_font_italic" id="lstnumberx25.6" style="font-size:80%;">
          import
         </span>
         <span class="ltx_text ltx_lst_space ltx_font_typewriter ltx_font_italic" id="lstnumberx25.7" style="font-size:80%;">
         </span>
         <span class="ltx_text ltx_font_typewriter ltx_font_italic" id="lstnumberx25.8" style="font-size:80%;">
          SVC
         </span>
        </div>
        <div class="ltx_listingline" id="lstnumberx26">
         <span class="ltx_text ltx_lst_space ltx_font_typewriter ltx_font_italic" id="lstnumberx26.1" style="font-size:80%;">
         </span>
         <span class="ltx_text ltx_font_typewriter ltx_font_italic" id="lstnumberx26.2" style="font-size:80%;">
          model
         </span>
         <span class="ltx_text ltx_lst_space ltx_font_typewriter ltx_font_italic" id="lstnumberx26.3" style="font-size:80%;">
         </span>
         <span class="ltx_text ltx_font_typewriter ltx_font_italic" id="lstnumberx26.4" style="font-size:80%;">
          =
         </span>
         <span class="ltx_text ltx_lst_space ltx_font_typewriter ltx_font_italic" id="lstnumberx26.5" style="font-size:80%;">
         </span>
         <span class="ltx_text ltx_font_typewriter ltx_font_italic" id="lstnumberx26.6" style="font-size:80%;">
          SVC(C=100,
         </span>
         <span class="ltx_text ltx_lst_space ltx_font_typewriter ltx_font_italic" id="lstnumberx26.7" style="font-size:80%;">
         </span>
         <span class="ltx_text ltx_font_typewriter ltx_font_italic" id="lstnumberx26.8" style="font-size:80%;">
          kernel=’rbf’)
         </span>
        </div>
        <div class="ltx_listingline" id="lstnumberx27">
         <span class="ltx_text ltx_lst_space ltx_font_typewriter ltx_font_italic" id="lstnumberx27.1" style="font-size:80%;">
         </span>
         <span class="ltx_text ltx_font_typewriter ltx_font_italic" id="lstnumberx27.2" style="font-size:80%;">
          model.fit(x_train,
         </span>
         <span class="ltx_text ltx_lst_space ltx_font_typewriter ltx_font_italic" id="lstnumberx27.3" style="font-size:80%;">
         </span>
         <span class="ltx_text ltx_font_typewriter ltx_font_italic" id="lstnumberx27.4" style="font-size:80%;">
          y_train)
         </span>
        </div>
        <div class="ltx_listingline" id="lstnumberx28">
         <span class="ltx_text ltx_lst_space ltx_font_typewriter ltx_font_italic" id="lstnumberx28.1" style="font-size:80%;">
         </span>
         <span class="ltx_text ltx_font_typewriter ltx_font_italic" id="lstnumberx28.2" style="font-size:80%;">
          return
         </span>
         <span class="ltx_text ltx_lst_space ltx_font_typewriter ltx_font_italic" id="lstnumberx28.3" style="font-size:80%;">
         </span>
         <span class="ltx_text ltx_font_typewriter ltx_font_italic" id="lstnumberx28.4" style="font-size:80%;">
          model
         </span>
        </div>
       </div>
      </figure>
      <figcaption class="ltx_caption ltx_centering">
       <span class="ltx_tag ltx_tag_figure">
        Figure 6:
       </span>
       A demonstration of prompts and generated code at the initial time step in our experiment. The text in
       <span class="ltx_text" id="A4.F7.3.4.1" style="color:#0000FF;">
        blue
       </span>
       is the prompted task description
       <math alttext="\eta(g)" class="ltx_Math" display="inline" id="A4.F7.3.2.m1.1">
        <semantics id="A4.F7.3.2.m1.1b">
         <mrow id="A4.F7.3.2.m1.1.2" xref="A4.F7.3.2.m1.1.2.cmml">
          <mi id="A4.F7.3.2.m1.1.2.2" xref="A4.F7.3.2.m1.1.2.2.cmml">
           η
          </mi>
          <mo id="A4.F7.3.2.m1.1.2.1" lspace="0em" rspace="0em" xref="A4.F7.3.2.m1.1.2.1.cmml">
           ​
          </mo>
          <mrow id="A4.F7.3.2.m1.1.2.3.2" xref="A4.F7.3.2.m1.1.2.cmml">
           <mo id="A4.F7.3.2.m1.1.2.3.2.1" stretchy="false" xref="A4.F7.3.2.m1.1.2.cmml">
            (
           </mo>
           <mi id="A4.F7.3.2.m1.1.1" xref="A4.F7.3.2.m1.1.1.cmml">
            g
           </mi>
           <mo id="A4.F7.3.2.m1.1.2.3.2.2" stretchy="false" xref="A4.F7.3.2.m1.1.2.cmml">
            )
           </mo>
          </mrow>
         </mrow>
         <annotation-xml encoding="MathML-Content" id="A4.F7.3.2.m1.1c">
          <apply id="A4.F7.3.2.m1.1.2.cmml" xref="A4.F7.3.2.m1.1.2">
           <times id="A4.F7.3.2.m1.1.2.1.cmml" xref="A4.F7.3.2.m1.1.2.1">
           </times>
           <ci id="A4.F7.3.2.m1.1.2.2.cmml" xref="A4.F7.3.2.m1.1.2.2">
            𝜂
           </ci>
           <ci id="A4.F7.3.2.m1.1.1.cmml" xref="A4.F7.3.2.m1.1.1">
            𝑔
           </ci>
          </apply>
         </annotation-xml>
         <annotation encoding="application/x-tex" id="A4.F7.3.2.m1.1d">
          \eta(g)
         </annotation>
        </semantics>
       </math>
       input to LLMs and the code they output is shown in black.
      </figcaption>
     </figure>
    </div>
    <div class="ltx_flex_break">
    </div>
    <div class="ltx_flex_cell ltx_flex_size_1">
     <figure class="ltx_figure ltx_figure_panel ltx_minipage ltx_align_center ltx_align_middle" id="A4.F7.8" style="width:433.6pt;">
      <figure class="ltx_float ltx_lstlisting" id="A4.F7.4.tab1">
       <div class="ltx_listing ltx_lst_language_diff ltx_lstlisting ltx_listing" id="A4.F7.4.tab1.1">
        <div class="ltx_listing_data">
         <a download="prompt_reflection.txt" href="data:text/plain;base64,IiIiQ2xhc3NpZmljYXRpb24gd2l0aCBhIFBoYXJ5bmdpdGlzIFByZWRpY3Rpb24gRGF0YXNldCIiIgppbXBvcnQgbnVtcHkgYXMgbnAKCiIiIkFuIGVycm9yIHdhcyByZXBvcnRlZCB3aGlsZSBleGVjdXRpbmcgdGhpcyBmdW5jdGlvbjogcHJlZGljdF9wcm9iYSBpcyBub3QgYXZhaWxhYmxlIHdoZW4gcHJvYmFiaWxpdHk9RmFsc2UuIFBsZWFzZSBmaXggaXQuIiIiCiMgZGVmIGJ1aWxkX21vZGVsKHhfdHJhaW46IG5wLm5kYXJyYXksIHlfdHJhaW46IG5wLm5kYXJyYXkpOgojICAgICIiIkltcG9ydCBtb2R1bGVzLCByZXR1cm4gYSBzY2lraXQgbW9kZWwgdHJhaW5lZCB3aXRoIHhfdHJhaW4gaW4gc2hhcGUgKDI1NiwgMTgpLiIiIgojICAgIGZyb20gc2tsZWFybi5zdm0gaW1wb3J0IFNWQwojICAgIG1vZGVsID0gU1ZDKEM9MTAwLCBrZXJuZWw9J3JiZicpCiMgICAgbW9kZWwuZml0KHhfdHJhaW4sIHlfdHJhaW4pCiMgICAgcmV0dXJuIG1vZGVsCgpkZWYgYnVpbGRfbW9kZWwoeF90cmFpbjogbnAubmRhcnJheSwgeV90cmFpbjogbnAubmRhcnJheSk6CiAgICAiIiJGaXggdGhlIGVycm9yIGluIHRoZSBwcmV2aW91cyBmdW5jdGlvbi4gIiIiCiAgICBmcm9tIHNrbGVhcm4uc3ZtIGltcG9ydCBTVkMKICAgIG1vZGVsID0gU1ZDKEM9MTAwLCBrZXJuZWw9J3JiZicsIHByb2JhYmlsaXR5PVRydWUpCiAgICBtb2RlbC5maXQoeF90cmFpbiwgeV90cmFpbikKICAgIHJldHVybiBtb2RlbA==">
          ⬇
         </a>
        </div>
        <div class="ltx_listingline" id="lstnumberx29">
         <span class="ltx_text ltx_lst_comment ltx_font_typewriter ltx_font_italic" id="lstnumberx29.1" style="font-size:80%;">
          """Classification
          <span class="ltx_text ltx_lst_space" id="lstnumberx29.1.1">
          </span>
          with
          <span class="ltx_text ltx_lst_space" id="lstnumberx29.1.2">
          </span>
          a
          <span class="ltx_text ltx_lst_space" id="lstnumberx29.1.3">
          </span>
          Pharyngitis
          <span class="ltx_text ltx_lst_space" id="lstnumberx29.1.4">
          </span>
          Prediction
          <span class="ltx_text ltx_lst_space" id="lstnumberx29.1.5">
          </span>
          Dataset"""
         </span>
        </div>
        <div class="ltx_listingline" id="lstnumberx30">
         <span class="ltx_text ltx_font_typewriter ltx_font_italic" id="lstnumberx30.1" style="font-size:80%;">
          import
         </span>
         <span class="ltx_text ltx_lst_space ltx_font_typewriter ltx_font_italic" id="lstnumberx30.2" style="font-size:80%;">
         </span>
         <span class="ltx_text ltx_font_typewriter ltx_font_italic" id="lstnumberx30.3" style="font-size:80%;">
          numpy
         </span>
         <span class="ltx_text ltx_lst_space ltx_font_typewriter ltx_font_italic" id="lstnumberx30.4" style="font-size:80%;">
         </span>
         <span class="ltx_text ltx_font_typewriter ltx_font_italic" id="lstnumberx30.5" style="font-size:80%;">
          as
         </span>
         <span class="ltx_text ltx_lst_space ltx_font_typewriter ltx_font_italic" id="lstnumberx30.6" style="font-size:80%;">
         </span>
         <span class="ltx_text ltx_font_typewriter ltx_font_italic" id="lstnumberx30.7" style="font-size:80%;">
          np
         </span>
        </div>
        <div class="ltx_listingline" id="lstnumberx31">
        </div>
        <div class="ltx_listingline" id="lstnumberx32">
         <span class="ltx_text ltx_font_typewriter ltx_font_italic" id="lstnumberx32.1" style="font-size:80%;">
          """An
         </span>
         <span class="ltx_text ltx_lst_space ltx_font_typewriter ltx_font_italic" id="lstnumberx32.2" style="font-size:80%;">
         </span>
         <span class="ltx_text ltx_font_typewriter ltx_font_italic" id="lstnumberx32.3" style="font-size:80%;">
          error
         </span>
         <span class="ltx_text ltx_lst_space ltx_font_typewriter ltx_font_italic" id="lstnumberx32.4" style="font-size:80%;">
         </span>
         <span class="ltx_text ltx_font_typewriter ltx_font_italic" id="lstnumberx32.5" style="font-size:80%;">
          was
         </span>
         <span class="ltx_text ltx_lst_space ltx_font_typewriter ltx_font_italic" id="lstnumberx32.6" style="font-size:80%;">
         </span>
         <span class="ltx_text ltx_font_typewriter ltx_font_italic" id="lstnumberx32.7" style="font-size:80%;">
          reported
         </span>
         <span class="ltx_text ltx_lst_space ltx_font_typewriter ltx_font_italic" id="lstnumberx32.8" style="font-size:80%;">
         </span>
         <span class="ltx_text ltx_font_typewriter ltx_font_italic" id="lstnumberx32.9" style="font-size:80%;">
          while
         </span>
         <span class="ltx_text ltx_lst_space ltx_font_typewriter ltx_font_italic" id="lstnumberx32.10" style="font-size:80%;">
         </span>
         <span class="ltx_text ltx_font_typewriter ltx_font_italic" id="lstnumberx32.11" style="font-size:80%;">
          executing
         </span>
         <span class="ltx_text ltx_lst_space ltx_font_typewriter ltx_font_italic" id="lstnumberx32.12" style="font-size:80%;">
         </span>
         <span class="ltx_text ltx_font_typewriter ltx_font_italic" id="lstnumberx32.13" style="font-size:80%;">
          this
         </span>
         <span class="ltx_text ltx_lst_space ltx_font_typewriter ltx_font_italic" id="lstnumberx32.14" style="font-size:80%;">
         </span>
         <span class="ltx_text ltx_font_typewriter ltx_font_italic" id="lstnumberx32.15" style="font-size:80%;">
          function:
         </span>
         <span class="ltx_text ltx_lst_space ltx_font_typewriter ltx_font_italic" id="lstnumberx32.16" style="font-size:80%;">
         </span>
         <span class="ltx_text ltx_font_typewriter ltx_font_italic" id="lstnumberx32.17" style="font-size:80%;">
          predict_proba
         </span>
         <span class="ltx_text ltx_lst_space ltx_font_typewriter ltx_font_italic" id="lstnumberx32.18" style="font-size:80%;">
         </span>
         <span class="ltx_text ltx_font_typewriter ltx_font_italic" id="lstnumberx32.19" style="font-size:80%;">
          is
         </span>
         <span class="ltx_text ltx_lst_space ltx_font_typewriter ltx_font_italic" id="lstnumberx32.20" style="font-size:80%;">
         </span>
         <span class="ltx_text ltx_font_typewriter ltx_font_italic" id="lstnumberx32.21" style="font-size:80%;">
          not
         </span>
         <span class="ltx_text ltx_lst_space ltx_font_typewriter ltx_font_italic" id="lstnumberx32.22" style="font-size:80%;">
         </span>
         <span class="ltx_text ltx_font_typewriter ltx_font_italic" id="lstnumberx32.23" style="font-size:80%;">
          available
         </span>
         <span class="ltx_text ltx_lst_space ltx_font_typewriter ltx_font_italic" id="lstnumberx32.24" style="font-size:80%;">
         </span>
         <span class="ltx_text ltx_font_typewriter ltx_font_italic" id="lstnumberx32.25" style="font-size:80%;">
          when
         </span>
         <span class="ltx_text ltx_lst_space ltx_font_typewriter ltx_font_italic" id="lstnumberx32.26" style="font-size:80%;">
         </span>
         <span class="ltx_text ltx_font_typewriter ltx_font_italic" id="lstnumberx32.27" style="font-size:80%;">
          probability=False.
         </span>
         <span class="ltx_text ltx_lst_space ltx_font_typewriter ltx_font_italic" id="lstnumberx32.28" style="font-size:80%;">
         </span>
         <span class="ltx_text ltx_font_typewriter ltx_font_italic" id="lstnumberx32.29" style="font-size:80%;">
          Please
         </span>
         <span class="ltx_text ltx_lst_space ltx_font_typewriter ltx_font_italic" id="lstnumberx32.30" style="font-size:80%;">
         </span>
         <span class="ltx_text ltx_font_typewriter ltx_font_italic" id="lstnumberx32.31" style="font-size:80%;">
          fix
         </span>
         <span class="ltx_text ltx_lst_space ltx_font_typewriter ltx_font_italic" id="lstnumberx32.32" style="font-size:80%;">
         </span>
         <span class="ltx_text ltx_font_typewriter ltx_font_italic" id="lstnumberx32.33" style="font-size:80%;">
          it."""
         </span>
        </div>
        <div class="ltx_listingline" id="lstnumberx33">
         <span class="ltx_text ltx_font_typewriter ltx_font_italic" id="lstnumberx33.1" style="font-size:80%;">
          #
         </span>
         <span class="ltx_text ltx_lst_space ltx_font_typewriter ltx_font_italic" id="lstnumberx33.2" style="font-size:80%;">
         </span>
         <span class="ltx_text ltx_font_typewriter ltx_font_italic" id="lstnumberx33.3" style="font-size:80%;">
          def
         </span>
         <span class="ltx_text ltx_lst_space ltx_font_typewriter ltx_font_italic" id="lstnumberx33.4" style="font-size:80%;">
         </span>
         <span class="ltx_text ltx_font_typewriter ltx_font_italic" id="lstnumberx33.5" style="font-size:80%;">
          build_model(x_train:
         </span>
         <span class="ltx_text ltx_lst_space ltx_font_typewriter ltx_font_italic" id="lstnumberx33.6" style="font-size:80%;">
         </span>
         <span class="ltx_text ltx_font_typewriter ltx_font_italic" id="lstnumberx33.7" style="font-size:80%;">
          np.ndarray,
         </span>
         <span class="ltx_text ltx_lst_space ltx_font_typewriter ltx_font_italic" id="lstnumberx33.8" style="font-size:80%;">
         </span>
         <span class="ltx_text ltx_font_typewriter ltx_font_italic" id="lstnumberx33.9" style="font-size:80%;">
          y_train:
         </span>
         <span class="ltx_text ltx_lst_space ltx_font_typewriter ltx_font_italic" id="lstnumberx33.10" style="font-size:80%;">
         </span>
         <span class="ltx_text ltx_font_typewriter ltx_font_italic" id="lstnumberx33.11" style="font-size:80%;">
          np.ndarray):
         </span>
        </div>
        <div class="ltx_listingline" id="lstnumberx34">
         <span class="ltx_text ltx_font_typewriter ltx_font_italic" id="lstnumberx34.1" style="font-size:80%;">
          #
         </span>
         <span class="ltx_text ltx_lst_space ltx_font_typewriter ltx_font_italic" id="lstnumberx34.2" style="font-size:80%;">
         </span>
         <span class="ltx_text ltx_font_typewriter ltx_font_italic" id="lstnumberx34.3" style="font-size:80%;">
          """Import
         </span>
         <span class="ltx_text ltx_lst_space ltx_font_typewriter ltx_font_italic" id="lstnumberx34.4" style="font-size:80%;">
         </span>
         <span class="ltx_text ltx_font_typewriter ltx_font_italic" id="lstnumberx34.5" style="font-size:80%;">
          modules,
         </span>
         <span class="ltx_text ltx_lst_space ltx_font_typewriter ltx_font_italic" id="lstnumberx34.6" style="font-size:80%;">
         </span>
         <span class="ltx_text ltx_font_typewriter ltx_font_italic" id="lstnumberx34.7" style="font-size:80%;">
          return
         </span>
         <span class="ltx_text ltx_lst_space ltx_font_typewriter ltx_font_italic" id="lstnumberx34.8" style="font-size:80%;">
         </span>
         <span class="ltx_text ltx_font_typewriter ltx_font_italic" id="lstnumberx34.9" style="font-size:80%;">
          a
         </span>
         <span class="ltx_text ltx_lst_space ltx_font_typewriter ltx_font_italic" id="lstnumberx34.10" style="font-size:80%;">
         </span>
         <span class="ltx_text ltx_font_typewriter ltx_font_italic" id="lstnumberx34.11" style="font-size:80%;">
          scikit
         </span>
         <span class="ltx_text ltx_lst_space ltx_font_typewriter ltx_font_italic" id="lstnumberx34.12" style="font-size:80%;">
         </span>
         <span class="ltx_text ltx_font_typewriter ltx_font_italic" id="lstnumberx34.13" style="font-size:80%;">
          model
         </span>
         <span class="ltx_text ltx_lst_space ltx_font_typewriter ltx_font_italic" id="lstnumberx34.14" style="font-size:80%;">
         </span>
         <span class="ltx_text ltx_font_typewriter ltx_font_italic" id="lstnumberx34.15" style="font-size:80%;">
          trained
         </span>
         <span class="ltx_text ltx_lst_space ltx_font_typewriter ltx_font_italic" id="lstnumberx34.16" style="font-size:80%;">
         </span>
         <span class="ltx_text ltx_font_typewriter ltx_font_italic" id="lstnumberx34.17" style="font-size:80%;">
          with
         </span>
         <span class="ltx_text ltx_lst_space ltx_font_typewriter ltx_font_italic" id="lstnumberx34.18" style="font-size:80%;">
         </span>
         <span class="ltx_text ltx_font_typewriter ltx_font_italic" id="lstnumberx34.19" style="font-size:80%;">
          x_train
         </span>
         <span class="ltx_text ltx_lst_space ltx_font_typewriter ltx_font_italic" id="lstnumberx34.20" style="font-size:80%;">
         </span>
         <span class="ltx_text ltx_font_typewriter ltx_font_italic" id="lstnumberx34.21" style="font-size:80%;">
          in
         </span>
         <span class="ltx_text ltx_lst_space ltx_font_typewriter ltx_font_italic" id="lstnumberx34.22" style="font-size:80%;">
         </span>
         <span class="ltx_text ltx_font_typewriter ltx_font_italic" id="lstnumberx34.23" style="font-size:80%;">
          shape
         </span>
         <span class="ltx_text ltx_lst_space ltx_font_typewriter ltx_font_italic" id="lstnumberx34.24" style="font-size:80%;">
         </span>
         <span class="ltx_text ltx_font_typewriter ltx_font_italic" id="lstnumberx34.25" style="font-size:80%;">
          (256,
         </span>
         <span class="ltx_text ltx_lst_space ltx_font_typewriter ltx_font_italic" id="lstnumberx34.26" style="font-size:80%;">
         </span>
         <span class="ltx_text ltx_font_typewriter ltx_font_italic" id="lstnumberx34.27" style="font-size:80%;">
          18)."""
         </span>
        </div>
        <div class="ltx_listingline" id="lstnumberx35">
         <span class="ltx_text ltx_font_typewriter ltx_font_italic" id="lstnumberx35.1" style="font-size:80%;">
          #
         </span>
         <span class="ltx_text ltx_lst_space ltx_font_typewriter ltx_font_italic" id="lstnumberx35.2" style="font-size:80%;">
         </span>
         <span class="ltx_text ltx_font_typewriter ltx_font_italic" id="lstnumberx35.3" style="font-size:80%;">
          from
         </span>
         <span class="ltx_text ltx_lst_space ltx_font_typewriter ltx_font_italic" id="lstnumberx35.4" style="font-size:80%;">
         </span>
         <span class="ltx_text ltx_font_typewriter ltx_font_italic" id="lstnumberx35.5" style="font-size:80%;">
          sklearn.svm
         </span>
         <span class="ltx_text ltx_lst_space ltx_font_typewriter ltx_font_italic" id="lstnumberx35.6" style="font-size:80%;">
         </span>
         <span class="ltx_text ltx_font_typewriter ltx_font_italic" id="lstnumberx35.7" style="font-size:80%;">
          import
         </span>
         <span class="ltx_text ltx_lst_space ltx_font_typewriter ltx_font_italic" id="lstnumberx35.8" style="font-size:80%;">
         </span>
         <span class="ltx_text ltx_font_typewriter ltx_font_italic" id="lstnumberx35.9" style="font-size:80%;">
          SVC
         </span>
        </div>
        <div class="ltx_listingline" id="lstnumberx36">
         <span class="ltx_text ltx_font_typewriter ltx_font_italic" id="lstnumberx36.1" style="font-size:80%;">
          #
         </span>
         <span class="ltx_text ltx_lst_space ltx_font_typewriter ltx_font_italic" id="lstnumberx36.2" style="font-size:80%;">
         </span>
         <span class="ltx_text ltx_font_typewriter ltx_font_italic" id="lstnumberx36.3" style="font-size:80%;">
          model
         </span>
         <span class="ltx_text ltx_lst_space ltx_font_typewriter ltx_font_italic" id="lstnumberx36.4" style="font-size:80%;">
         </span>
         <span class="ltx_text ltx_font_typewriter ltx_font_italic" id="lstnumberx36.5" style="font-size:80%;">
          =
         </span>
         <span class="ltx_text ltx_lst_space ltx_font_typewriter ltx_font_italic" id="lstnumberx36.6" style="font-size:80%;">
         </span>
         <span class="ltx_text ltx_font_typewriter ltx_font_italic" id="lstnumberx36.7" style="font-size:80%;">
          SVC(C=100,
         </span>
         <span class="ltx_text ltx_lst_space ltx_font_typewriter ltx_font_italic" id="lstnumberx36.8" style="font-size:80%;">
         </span>
         <span class="ltx_text ltx_font_typewriter ltx_font_italic" id="lstnumberx36.9" style="font-size:80%;">
          kernel=’rbf’)
         </span>
        </div>
        <div class="ltx_listingline" id="lstnumberx37">
         <span class="ltx_text ltx_font_typewriter ltx_font_italic" id="lstnumberx37.1" style="font-size:80%;">
          #
         </span>
         <span class="ltx_text ltx_lst_space ltx_font_typewriter ltx_font_italic" id="lstnumberx37.2" style="font-size:80%;">
         </span>
         <span class="ltx_text ltx_font_typewriter ltx_font_italic" id="lstnumberx37.3" style="font-size:80%;">
          model.fit(x_train,
         </span>
         <span class="ltx_text ltx_lst_space ltx_font_typewriter ltx_font_italic" id="lstnumberx37.4" style="font-size:80%;">
         </span>
         <span class="ltx_text ltx_font_typewriter ltx_font_italic" id="lstnumberx37.5" style="font-size:80%;">
          y_train)
         </span>
        </div>
        <div class="ltx_listingline" id="lstnumberx38">
         <span class="ltx_text ltx_font_typewriter ltx_font_italic" id="lstnumberx38.1" style="font-size:80%;">
          #
         </span>
         <span class="ltx_text ltx_lst_space ltx_font_typewriter ltx_font_italic" id="lstnumberx38.2" style="font-size:80%;">
         </span>
         <span class="ltx_text ltx_font_typewriter ltx_font_italic" id="lstnumberx38.3" style="font-size:80%;">
          return
         </span>
         <span class="ltx_text ltx_lst_space ltx_font_typewriter ltx_font_italic" id="lstnumberx38.4" style="font-size:80%;">
         </span>
         <span class="ltx_text ltx_font_typewriter ltx_font_italic" id="lstnumberx38.5" style="font-size:80%;">
          model
         </span>
        </div>
        <div class="ltx_listingline" id="lstnumberx39">
        </div>
        <div class="ltx_listingline" id="lstnumberx40">
         <span class="ltx_text ltx_font_typewriter ltx_font_italic" id="lstnumberx40.1" style="font-size:80%;">
          def
         </span>
         <span class="ltx_text ltx_lst_space ltx_font_typewriter ltx_font_italic" id="lstnumberx40.2" style="font-size:80%;">
         </span>
         <span class="ltx_text ltx_font_typewriter ltx_font_italic" id="lstnumberx40.3" style="font-size:80%;">
          build_model(x_train:
         </span>
         <span class="ltx_text ltx_lst_space ltx_font_typewriter ltx_font_italic" id="lstnumberx40.4" style="font-size:80%;">
         </span>
         <span class="ltx_text ltx_font_typewriter ltx_font_italic" id="lstnumberx40.5" style="font-size:80%;">
          np.ndarray,
         </span>
         <span class="ltx_text ltx_lst_space ltx_font_typewriter ltx_font_italic" id="lstnumberx40.6" style="font-size:80%;">
         </span>
         <span class="ltx_text ltx_font_typewriter ltx_font_italic" id="lstnumberx40.7" style="font-size:80%;">
          y_train:
         </span>
         <span class="ltx_text ltx_lst_space ltx_font_typewriter ltx_font_italic" id="lstnumberx40.8" style="font-size:80%;">
         </span>
         <span class="ltx_text ltx_font_typewriter ltx_font_italic" id="lstnumberx40.9" style="font-size:80%;">
          np.ndarray):
         </span>
        </div>
        <div class="ltx_listingline" id="lstnumberx41">
         <span class="ltx_text ltx_lst_space ltx_font_typewriter ltx_font_italic" id="lstnumberx41.1" style="font-size:80%;">
         </span>
         <span class="ltx_text ltx_font_typewriter ltx_font_italic" id="lstnumberx41.2" style="font-size:80%;">
          """Fix
         </span>
         <span class="ltx_text ltx_lst_space ltx_font_typewriter ltx_font_italic" id="lstnumberx41.3" style="font-size:80%;">
         </span>
         <span class="ltx_text ltx_font_typewriter ltx_font_italic" id="lstnumberx41.4" style="font-size:80%;">
          the
         </span>
         <span class="ltx_text ltx_lst_space ltx_font_typewriter ltx_font_italic" id="lstnumberx41.5" style="font-size:80%;">
         </span>
         <span class="ltx_text ltx_font_typewriter ltx_font_italic" id="lstnumberx41.6" style="font-size:80%;">
          error
         </span>
         <span class="ltx_text ltx_lst_space ltx_font_typewriter ltx_font_italic" id="lstnumberx41.7" style="font-size:80%;">
         </span>
         <span class="ltx_text ltx_font_typewriter ltx_font_italic" id="lstnumberx41.8" style="font-size:80%;">
          in
         </span>
         <span class="ltx_text ltx_lst_space ltx_font_typewriter ltx_font_italic" id="lstnumberx41.9" style="font-size:80%;">
         </span>
         <span class="ltx_text ltx_font_typewriter ltx_font_italic" id="lstnumberx41.10" style="font-size:80%;">
          the
         </span>
         <span class="ltx_text ltx_lst_space ltx_font_typewriter ltx_font_italic" id="lstnumberx41.11" style="font-size:80%;">
         </span>
         <span class="ltx_text ltx_font_typewriter ltx_font_italic" id="lstnumberx41.12" style="font-size:80%;">
          previous
         </span>
         <span class="ltx_text ltx_lst_space ltx_font_typewriter ltx_font_italic" id="lstnumberx41.13" style="font-size:80%;">
         </span>
         <span class="ltx_text ltx_font_typewriter ltx_font_italic" id="lstnumberx41.14" style="font-size:80%;">
          function.
         </span>
         <span class="ltx_text ltx_lst_space ltx_font_typewriter ltx_font_italic" id="lstnumberx41.15" style="font-size:80%;">
         </span>
         <span class="ltx_text ltx_font_typewriter ltx_font_italic" id="lstnumberx41.16" style="font-size:80%;">
          """
         </span>
        </div>
        <div class="ltx_listingline" id="lstnumberx42">
         <span class="ltx_text ltx_lst_space ltx_font_typewriter ltx_font_italic" id="lstnumberx42.1" style="font-size:80%;">
         </span>
         <span class="ltx_text ltx_font_typewriter ltx_font_italic" id="lstnumberx42.2" style="font-size:80%;">
          from
         </span>
         <span class="ltx_text ltx_lst_space ltx_font_typewriter ltx_font_italic" id="lstnumberx42.3" style="font-size:80%;">
         </span>
         <span class="ltx_text ltx_font_typewriter ltx_font_italic" id="lstnumberx42.4" style="font-size:80%;">
          sklearn.svm
         </span>
         <span class="ltx_text ltx_lst_space ltx_font_typewriter ltx_font_italic" id="lstnumberx42.5" style="font-size:80%;">
         </span>
         <span class="ltx_text ltx_font_typewriter ltx_font_italic" id="lstnumberx42.6" style="font-size:80%;">
          import
         </span>
         <span class="ltx_text ltx_lst_space ltx_font_typewriter ltx_font_italic" id="lstnumberx42.7" style="font-size:80%;">
         </span>
         <span class="ltx_text ltx_font_typewriter ltx_font_italic" id="lstnumberx42.8" style="font-size:80%;">
          SVC
         </span>
        </div>
        <div class="ltx_listingline" id="lstnumberx43">
         <span class="ltx_text ltx_lst_space ltx_font_typewriter ltx_font_italic" id="lstnumberx43.1" style="font-size:80%;">
         </span>
         <span class="ltx_text ltx_font_typewriter ltx_font_italic" id="lstnumberx43.2" style="font-size:80%;">
          model
         </span>
         <span class="ltx_text ltx_lst_space ltx_font_typewriter ltx_font_italic" id="lstnumberx43.3" style="font-size:80%;">
         </span>
         <span class="ltx_text ltx_font_typewriter ltx_font_italic" id="lstnumberx43.4" style="font-size:80%;">
          =
         </span>
         <span class="ltx_text ltx_lst_space ltx_font_typewriter ltx_font_italic" id="lstnumberx43.5" style="font-size:80%;">
         </span>
         <span class="ltx_text ltx_font_typewriter ltx_font_italic" id="lstnumberx43.6" style="font-size:80%;">
          SVC(C=100,
         </span>
         <span class="ltx_text ltx_lst_space ltx_font_typewriter ltx_font_italic" id="lstnumberx43.7" style="font-size:80%;">
         </span>
         <span class="ltx_text ltx_font_typewriter ltx_font_italic" id="lstnumberx43.8" style="font-size:80%;">
          kernel=’rbf’,
         </span>
         <span class="ltx_text ltx_lst_space ltx_font_typewriter ltx_font_italic" id="lstnumberx43.9" style="font-size:80%;">
         </span>
         <span class="ltx_text ltx_font_typewriter ltx_font_italic" id="lstnumberx43.10" style="font-size:80%;">
          probability=True)
         </span>
        </div>
        <div class="ltx_listingline" id="lstnumberx44">
         <span class="ltx_text ltx_lst_space ltx_font_typewriter ltx_font_italic" id="lstnumberx44.1" style="font-size:80%;">
         </span>
         <span class="ltx_text ltx_font_typewriter ltx_font_italic" id="lstnumberx44.2" style="font-size:80%;">
          model.fit(x_train,
         </span>
         <span class="ltx_text ltx_lst_space ltx_font_typewriter ltx_font_italic" id="lstnumberx44.3" style="font-size:80%;">
         </span>
         <span class="ltx_text ltx_font_typewriter ltx_font_italic" id="lstnumberx44.4" style="font-size:80%;">
          y_train)
         </span>
        </div>
        <div class="ltx_listingline" id="lstnumberx45">
         <span class="ltx_text ltx_lst_space ltx_font_typewriter ltx_font_italic" id="lstnumberx45.1" style="font-size:80%;">
         </span>
         <span class="ltx_text ltx_font_typewriter ltx_font_italic" id="lstnumberx45.2" style="font-size:80%;">
          return
         </span>
         <span class="ltx_text ltx_lst_space ltx_font_typewriter ltx_font_italic" id="lstnumberx45.3" style="font-size:80%;">
         </span>
         <span class="ltx_text ltx_font_typewriter ltx_font_italic" id="lstnumberx45.4" style="font-size:80%;">
          model
         </span>
        </div>
       </div>
      </figure>
      <figcaption class="ltx_caption ltx_centering">
       <span class="ltx_tag ltx_tag_figure">
        Figure 7:
       </span>
       A demonstration of prompts and generated code at reflective steps in our experiment. The text in color is the prompt input to LLMs and the code they output is shown in black. More specifically, a runtime error message
       <math alttext="e_{t}" class="ltx_Math" display="inline" id="A4.F7.7.3.m1.1">
        <semantics id="A4.F7.7.3.m1.1b">
         <msub id="A4.F7.7.3.m1.1.1" xref="A4.F7.7.3.m1.1.1.cmml">
          <mi id="A4.F7.7.3.m1.1.1.2" xref="A4.F7.7.3.m1.1.1.2.cmml">
           e
          </mi>
          <mi id="A4.F7.7.3.m1.1.1.3" xref="A4.F7.7.3.m1.1.1.3.cmml">
           t
          </mi>
         </msub>
         <annotation-xml encoding="MathML-Content" id="A4.F7.7.3.m1.1c">
          <apply id="A4.F7.7.3.m1.1.1.cmml" xref="A4.F7.7.3.m1.1.1">
           <csymbol cd="ambiguous" id="A4.F7.7.3.m1.1.1.1.cmml" xref="A4.F7.7.3.m1.1.1">
            subscript
           </csymbol>
           <ci id="A4.F7.7.3.m1.1.1.2.cmml" xref="A4.F7.7.3.m1.1.1.2">
            𝑒
           </ci>
           <ci id="A4.F7.7.3.m1.1.1.3.cmml" xref="A4.F7.7.3.m1.1.1.3">
            𝑡
           </ci>
          </apply>
         </annotation-xml>
         <annotation encoding="application/x-tex" id="A4.F7.7.3.m1.1d">
          e_{t}
         </annotation>
        </semantics>
       </math>
       is decorated with
       <span class="ltx_text" id="A4.F7.8.7.1" style="color:#FF0000;">
        red
       </span>
       while a previous action
       <math alttext="a_{t-1}" class="ltx_Math" display="inline" id="A4.F7.8.4.m2.1">
        <semantics id="A4.F7.8.4.m2.1b">
         <msub id="A4.F7.8.4.m2.1.1" xref="A4.F7.8.4.m2.1.1.cmml">
          <mi id="A4.F7.8.4.m2.1.1.2" xref="A4.F7.8.4.m2.1.1.2.cmml">
           a
          </mi>
          <mrow id="A4.F7.8.4.m2.1.1.3" xref="A4.F7.8.4.m2.1.1.3.cmml">
           <mi id="A4.F7.8.4.m2.1.1.3.2" xref="A4.F7.8.4.m2.1.1.3.2.cmml">
            t
           </mi>
           <mo id="A4.F7.8.4.m2.1.1.3.1" xref="A4.F7.8.4.m2.1.1.3.1.cmml">
            −
           </mo>
           <mn id="A4.F7.8.4.m2.1.1.3.3" xref="A4.F7.8.4.m2.1.1.3.3.cmml">
            1
           </mn>
          </mrow>
         </msub>
         <annotation-xml encoding="MathML-Content" id="A4.F7.8.4.m2.1c">
          <apply id="A4.F7.8.4.m2.1.1.cmml" xref="A4.F7.8.4.m2.1.1">
           <csymbol cd="ambiguous" id="A4.F7.8.4.m2.1.1.1.cmml" xref="A4.F7.8.4.m2.1.1">
            subscript
           </csymbol>
           <ci id="A4.F7.8.4.m2.1.1.2.cmml" xref="A4.F7.8.4.m2.1.1.2">
            𝑎
           </ci>
           <apply id="A4.F7.8.4.m2.1.1.3.cmml" xref="A4.F7.8.4.m2.1.1.3">
            <minus id="A4.F7.8.4.m2.1.1.3.1.cmml" xref="A4.F7.8.4.m2.1.1.3.1">
            </minus>
            <ci id="A4.F7.8.4.m2.1.1.3.2.cmml" xref="A4.F7.8.4.m2.1.1.3.2">
             𝑡
            </ci>
            <cn id="A4.F7.8.4.m2.1.1.3.3.cmml" type="integer" xref="A4.F7.8.4.m2.1.1.3.3">
             1
            </cn>
           </apply>
          </apply>
         </annotation-xml>
         <annotation encoding="application/x-tex" id="A4.F7.8.4.m2.1d">
          a_{t-1}
         </annotation>
        </semantics>
       </math>
       is decorated with
       <span class="ltx_text" id="A4.F7.8.8.2" style="color:#009900;">
        green
       </span>
       .
      </figcaption>
     </figure>
    </div>
   </div>
  </figure>
  <div class="ltx_pagination ltx_role_newpage">
  </div>
 </section>
 <section class="ltx_appendix" id="A5">
  <h2 class="ltx_title ltx_title_appendix">
   <span class="ltx_tag ltx_tag_appendix">
    Appendix E
   </span>
   Generated Code Examples
  </h2>
  <figure class="ltx_figure" id="A5.F9">
   <div class="ltx_flex_figure">
    <div class="ltx_flex_cell ltx_flex_size_1">
     <figure class="ltx_figure ltx_figure_panel ltx_minipage ltx_align_center ltx_align_middle" id="A5.F9.1" style="width:433.6pt;">
      <figure class="ltx_float ltx_lstlisting" id="A5.F9.1.tab1">
       <div class="ltx_listing ltx_lst_language_diff ltx_lstlisting ltx_listing" id="A5.F9.1.tab1.1">
        <div class="ltx_listing_data">
         <a download="code_ref.txt" href="data:text/plain;base64,IiIiQ2xhc3NpZmljYXRpb24gd2l0aCBhIEJhbGFuY2UgU2NhbGUgV2VpZ2h0ICYgRGlzdGFuY2UgUHJlZGljdGlvbiBEYXRhc2V0IiIiCmltcG9ydCBudW1weSBhcyBucAoKZGVmIGJ1aWxkX21vZGVsKHhfdHJhaW46IG5wLm5kYXJyYXksIHlfdHJhaW46IG5wLm5kYXJyYXkpOgogICAgIiIiSW1wb3J0IG1vZHVsZXMsIHJldHVybiBhIHNjaWtpdCBtb2RlbCB0cmFpbmVkIHdpdGggeF90cmFpbiBpbiBzaGFwZSAoNjIsIDQpIGFuZCB5X3RyYWluLiIiIgogICAgCiAgICBmcm9tIHNrbGVhcm4ubGluZWFyX21vZGVsIGltcG9ydCBMb2dpc3RpY1JlZ3Jlc3Npb24KICAgIG1vZGVsID0gTG9naXN0aWNSZWdyZXNzaW9uKCkKICAgIG1vZGVsLmZpdCh4X3RyYWluLCB5X3RyYWluKQogICAgcmV0dXJuIG1vZGVs">
          ⬇
         </a>
        </div>
        <div class="ltx_listingline" id="lstnumberx46">
         <span class="ltx_text ltx_lst_comment ltx_font_typewriter ltx_font_italic" id="lstnumberx46.1" style="font-size:80%;">
          """Classification
          <span class="ltx_text ltx_lst_space" id="lstnumberx46.1.1">
          </span>
          with
          <span class="ltx_text ltx_lst_space" id="lstnumberx46.1.2">
          </span>
          a
          <span class="ltx_text ltx_lst_space" id="lstnumberx46.1.3">
          </span>
          Balance
          <span class="ltx_text ltx_lst_space" id="lstnumberx46.1.4">
          </span>
          Scale
          <span class="ltx_text ltx_lst_space" id="lstnumberx46.1.5">
          </span>
          Weight
          <span class="ltx_text ltx_lst_space" id="lstnumberx46.1.6">
          </span>
          &amp;
          <span class="ltx_text ltx_lst_space" id="lstnumberx46.1.7">
          </span>
          Distance
          <span class="ltx_text ltx_lst_space" id="lstnumberx46.1.8">
          </span>
          Prediction
          <span class="ltx_text ltx_lst_space" id="lstnumberx46.1.9">
          </span>
          Dataset"""
         </span>
        </div>
        <div class="ltx_listingline" id="lstnumberx47">
         <span class="ltx_text ltx_font_typewriter ltx_font_italic" id="lstnumberx47.1" style="font-size:80%;">
          import
         </span>
         <span class="ltx_text ltx_lst_space ltx_font_typewriter ltx_font_italic" id="lstnumberx47.2" style="font-size:80%;">
         </span>
         <span class="ltx_text ltx_font_typewriter ltx_font_italic" id="lstnumberx47.3" style="font-size:80%;">
          numpy
         </span>
         <span class="ltx_text ltx_lst_space ltx_font_typewriter ltx_font_italic" id="lstnumberx47.4" style="font-size:80%;">
         </span>
         <span class="ltx_text ltx_font_typewriter ltx_font_italic" id="lstnumberx47.5" style="font-size:80%;">
          as
         </span>
         <span class="ltx_text ltx_lst_space ltx_font_typewriter ltx_font_italic" id="lstnumberx47.6" style="font-size:80%;">
         </span>
         <span class="ltx_text ltx_font_typewriter ltx_font_italic" id="lstnumberx47.7" style="font-size:80%;">
          np
         </span>
        </div>
        <div class="ltx_listingline" id="lstnumberx48">
        </div>
        <div class="ltx_listingline" id="lstnumberx49">
         <span class="ltx_text ltx_font_typewriter ltx_font_italic" id="lstnumberx49.1" style="font-size:80%;">
          def
         </span>
         <span class="ltx_text ltx_lst_space ltx_font_typewriter ltx_font_italic" id="lstnumberx49.2" style="font-size:80%;">
         </span>
         <span class="ltx_text ltx_font_typewriter ltx_font_italic" id="lstnumberx49.3" style="font-size:80%;">
          build_model(x_train:
         </span>
         <span class="ltx_text ltx_lst_space ltx_font_typewriter ltx_font_italic" id="lstnumberx49.4" style="font-size:80%;">
         </span>
         <span class="ltx_text ltx_font_typewriter ltx_font_italic" id="lstnumberx49.5" style="font-size:80%;">
          np.ndarray,
         </span>
         <span class="ltx_text ltx_lst_space ltx_font_typewriter ltx_font_italic" id="lstnumberx49.6" style="font-size:80%;">
         </span>
         <span class="ltx_text ltx_font_typewriter ltx_font_italic" id="lstnumberx49.7" style="font-size:80%;">
          y_train:
         </span>
         <span class="ltx_text ltx_lst_space ltx_font_typewriter ltx_font_italic" id="lstnumberx49.8" style="font-size:80%;">
         </span>
         <span class="ltx_text ltx_font_typewriter ltx_font_italic" id="lstnumberx49.9" style="font-size:80%;">
          np.ndarray):
         </span>
        </div>
        <div class="ltx_listingline" id="lstnumberx50">
         <span class="ltx_text ltx_lst_space ltx_font_typewriter ltx_font_italic" id="lstnumberx50.1" style="font-size:80%;">
         </span>
         <span class="ltx_text ltx_font_typewriter ltx_font_italic" id="lstnumberx50.2" style="font-size:80%;">
          """Import
         </span>
         <span class="ltx_text ltx_lst_space ltx_font_typewriter ltx_font_italic" id="lstnumberx50.3" style="font-size:80%;">
         </span>
         <span class="ltx_text ltx_font_typewriter ltx_font_italic" id="lstnumberx50.4" style="font-size:80%;">
          modules,
         </span>
         <span class="ltx_text ltx_lst_space ltx_font_typewriter ltx_font_italic" id="lstnumberx50.5" style="font-size:80%;">
         </span>
         <span class="ltx_text ltx_font_typewriter ltx_font_italic" id="lstnumberx50.6" style="font-size:80%;">
          return
         </span>
         <span class="ltx_text ltx_lst_space ltx_font_typewriter ltx_font_italic" id="lstnumberx50.7" style="font-size:80%;">
         </span>
         <span class="ltx_text ltx_font_typewriter ltx_font_italic" id="lstnumberx50.8" style="font-size:80%;">
          a
         </span>
         <span class="ltx_text ltx_lst_space ltx_font_typewriter ltx_font_italic" id="lstnumberx50.9" style="font-size:80%;">
         </span>
         <span class="ltx_text ltx_font_typewriter ltx_font_italic" id="lstnumberx50.10" style="font-size:80%;">
          scikit
         </span>
         <span class="ltx_text ltx_lst_space ltx_font_typewriter ltx_font_italic" id="lstnumberx50.11" style="font-size:80%;">
         </span>
         <span class="ltx_text ltx_font_typewriter ltx_font_italic" id="lstnumberx50.12" style="font-size:80%;">
          model
         </span>
         <span class="ltx_text ltx_lst_space ltx_font_typewriter ltx_font_italic" id="lstnumberx50.13" style="font-size:80%;">
         </span>
         <span class="ltx_text ltx_font_typewriter ltx_font_italic" id="lstnumberx50.14" style="font-size:80%;">
          trained
         </span>
         <span class="ltx_text ltx_lst_space ltx_font_typewriter ltx_font_italic" id="lstnumberx50.15" style="font-size:80%;">
         </span>
         <span class="ltx_text ltx_font_typewriter ltx_font_italic" id="lstnumberx50.16" style="font-size:80%;">
          with
         </span>
         <span class="ltx_text ltx_lst_space ltx_font_typewriter ltx_font_italic" id="lstnumberx50.17" style="font-size:80%;">
         </span>
         <span class="ltx_text ltx_font_typewriter ltx_font_italic" id="lstnumberx50.18" style="font-size:80%;">
          x_train
         </span>
         <span class="ltx_text ltx_lst_space ltx_font_typewriter ltx_font_italic" id="lstnumberx50.19" style="font-size:80%;">
         </span>
         <span class="ltx_text ltx_font_typewriter ltx_font_italic" id="lstnumberx50.20" style="font-size:80%;">
          in
         </span>
         <span class="ltx_text ltx_lst_space ltx_font_typewriter ltx_font_italic" id="lstnumberx50.21" style="font-size:80%;">
         </span>
         <span class="ltx_text ltx_font_typewriter ltx_font_italic" id="lstnumberx50.22" style="font-size:80%;">
          shape
         </span>
         <span class="ltx_text ltx_lst_space ltx_font_typewriter ltx_font_italic" id="lstnumberx50.23" style="font-size:80%;">
         </span>
         <span class="ltx_text ltx_font_typewriter ltx_font_italic" id="lstnumberx50.24" style="font-size:80%;">
          (62,
         </span>
         <span class="ltx_text ltx_lst_space ltx_font_typewriter ltx_font_italic" id="lstnumberx50.25" style="font-size:80%;">
         </span>
         <span class="ltx_text ltx_font_typewriter ltx_font_italic" id="lstnumberx50.26" style="font-size:80%;">
          4)
         </span>
         <span class="ltx_text ltx_lst_space ltx_font_typewriter ltx_font_italic" id="lstnumberx50.27" style="font-size:80%;">
         </span>
         <span class="ltx_text ltx_font_typewriter ltx_font_italic" id="lstnumberx50.28" style="font-size:80%;">
          and
         </span>
         <span class="ltx_text ltx_lst_space ltx_font_typewriter ltx_font_italic" id="lstnumberx50.29" style="font-size:80%;">
         </span>
         <span class="ltx_text ltx_font_typewriter ltx_font_italic" id="lstnumberx50.30" style="font-size:80%;">
          y_train."""
         </span>
        </div>
        <div class="ltx_listingline" id="lstnumberx51">
        </div>
        <div class="ltx_listingline" id="lstnumberx52">
         <span class="ltx_text ltx_lst_space ltx_font_typewriter ltx_font_italic" id="lstnumberx52.1" style="font-size:80%;">
         </span>
         <span class="ltx_text ltx_font_typewriter ltx_font_italic" id="lstnumberx52.2" style="font-size:80%;">
          from
         </span>
         <span class="ltx_text ltx_lst_space ltx_font_typewriter ltx_font_italic" id="lstnumberx52.3" style="font-size:80%;">
         </span>
         <span class="ltx_text ltx_font_typewriter ltx_font_italic" id="lstnumberx52.4" style="font-size:80%;">
          sklearn.linear_model
         </span>
         <span class="ltx_text ltx_lst_space ltx_font_typewriter ltx_font_italic" id="lstnumberx52.5" style="font-size:80%;">
         </span>
         <span class="ltx_text ltx_font_typewriter ltx_font_italic" id="lstnumberx52.6" style="font-size:80%;">
          import
         </span>
         <span class="ltx_text ltx_lst_space ltx_font_typewriter ltx_font_italic" id="lstnumberx52.7" style="font-size:80%;">
         </span>
         <span class="ltx_text ltx_font_typewriter ltx_font_italic" id="lstnumberx52.8" style="font-size:80%;">
          LogisticRegression
         </span>
        </div>
        <div class="ltx_listingline" id="lstnumberx53">
         <span class="ltx_text ltx_lst_space ltx_font_typewriter ltx_font_italic" id="lstnumberx53.1" style="font-size:80%;">
         </span>
         <span class="ltx_text ltx_font_typewriter ltx_font_italic" id="lstnumberx53.2" style="font-size:80%;">
          model
         </span>
         <span class="ltx_text ltx_lst_space ltx_font_typewriter ltx_font_italic" id="lstnumberx53.3" style="font-size:80%;">
         </span>
         <span class="ltx_text ltx_font_typewriter ltx_font_italic" id="lstnumberx53.4" style="font-size:80%;">
          =
         </span>
         <span class="ltx_text ltx_lst_space ltx_font_typewriter ltx_font_italic" id="lstnumberx53.5" style="font-size:80%;">
         </span>
         <span class="ltx_text ltx_font_typewriter ltx_font_italic" id="lstnumberx53.6" style="font-size:80%;">
          LogisticRegression()
         </span>
        </div>
        <div class="ltx_listingline" id="lstnumberx54">
         <span class="ltx_text ltx_lst_space ltx_font_typewriter ltx_font_italic" id="lstnumberx54.1" style="font-size:80%;">
         </span>
         <span class="ltx_text ltx_font_typewriter ltx_font_italic" id="lstnumberx54.2" style="font-size:80%;">
          model.fit(x_train,
         </span>
         <span class="ltx_text ltx_lst_space ltx_font_typewriter ltx_font_italic" id="lstnumberx54.3" style="font-size:80%;">
         </span>
         <span class="ltx_text ltx_font_typewriter ltx_font_italic" id="lstnumberx54.4" style="font-size:80%;">
          y_train)
         </span>
        </div>
        <div class="ltx_listingline" id="lstnumberx55">
         <span class="ltx_text ltx_lst_space ltx_font_typewriter ltx_font_italic" id="lstnumberx55.1" style="font-size:80%;">
         </span>
         <span class="ltx_text ltx_font_typewriter ltx_font_italic" id="lstnumberx55.2" style="font-size:80%;">
          return
         </span>
         <span class="ltx_text ltx_lst_space ltx_font_typewriter ltx_font_italic" id="lstnumberx55.3" style="font-size:80%;">
         </span>
         <span class="ltx_text ltx_font_typewriter ltx_font_italic" id="lstnumberx55.4" style="font-size:80%;">
          model
         </span>
        </div>
       </div>
      </figure>
      <figcaption class="ltx_caption ltx_centering">
       <span class="ltx_tag ltx_tag_figure">
        Figure 8:
       </span>
       A demonstration of the best code generated by vanilla CodeLlama-7B for the Balance Scale dataset in 500 exploration steps. It achieves the ROC AUC score of 0.8833.
      </figcaption>
     </figure>
    </div>
    <div class="ltx_flex_break">
    </div>
    <div class="ltx_flex_cell ltx_flex_size_1">
     <figure class="ltx_figure ltx_figure_panel ltx_minipage ltx_align_center ltx_align_middle" id="A5.F9.2" style="width:433.6pt;">
      <figure class="ltx_float ltx_lstlisting" id="A5.F9.2.tab1">
       <div class="ltx_listing ltx_lst_language_diff ltx_lstlisting ltx_listing" id="A5.F9.2.tab1.1">
        <div class="ltx_listing_data">
         <a download="code_ours.txt" href="data:text/plain;base64,IiIiQ2xhc3NpZmljYXRpb24gd2l0aCBhIEJhbGFuY2UgU2NhbGUgV2VpZ2h0ICYgRGlzdGFuY2UgUHJlZGljdGlvbiBEYXRhc2V0IiIiCmltcG9ydCBudW1weSBhcyBucAoKZGVmIGJ1aWxkX21vZGVsKHhfdHJhaW46IG5wLm5kYXJyYXksIHlfdHJhaW46IG5wLm5kYXJyYXkpOgogICAgIiIiSW1wb3J0IG1vZHVsZXMsIHJldHVybiBhIHNjaWtpdCBtb2RlbCB0cmFpbmVkIHdpdGggeF90cmFpbiBpbiBzaGFwZSAoNjIsIDQpIGFuZCB5X3RyYWluLiIiIgogICAgZnJvbSBza2xlYXJuLnBpcGVsaW5lIGltcG9ydCBQaXBlbGluZQogICAgZnJvbSBza2xlYXJuLnByZXByb2Nlc3NpbmcgaW1wb3J0IFN0YW5kYXJkU2NhbGVyCiAgICBmcm9tIHNrbGVhcm4ubmV1cmFsX25ldHdvcmsgaW1wb3J0IE1MUENsYXNzaWZpZXIKICAgIAogICAgcGlwZWxpbmUgPSBQaXBlbGluZShbCiAgICAgICAgKCdzY2FsZXInLCBTdGFuZGFyZFNjYWxlcigpKSwKICAgICAgICAoJ21vZGVsJywgTUxQQ2xhc3NpZmllcihoaWRkZW5fbGF5ZXJfc2l6ZXM9KDEwMCwpLCBhY3RpdmF0aW9uPSdyZWx1Jywgc29sdmVyPSdsYmZncycsIG1heF9pdGVyPTEwMDAsIGFscGhhPTFlLTUsCiAgICAgICAgICAgIGJhdGNoX3NpemU9MTAwLCBsZWFybmluZ19yYXRlX2luaXQ9MC4xLCBsZWFybmluZ19yYXRlPSdhZGFwdGl2ZScsIHRvbD0xZS00LCB2ZXJib3NlPVRydWUsCiAgICAgICAgICAgIHdhcm1fc3RhcnQ9RmFsc2UsIG1vbWVudHVtPTAuOSwgbmVzdGVyb3ZzX21vbWVudHVtPVRydWUsIGVhcmx5X3N0b3BwaW5nPVRydWUsCiAgICAgICAgICAgIHZhbGlkYXRpb25fZnJhY3Rpb249MC4xLCBiZXRhXzE9MC45LCBiZXRhXzI9MC45OTksIGVwc2lsb249MWUtOCwgbl9pdGVyX25vX2NoYW5nZT0xMCwKICAgICAgICAgICAgbWF4X2Z1bj0xNTAwMCkpLAogICAgXSkKICAgIAogICAgbW9kZWwgPSBwaXBlbGluZS5maXQoeF90cmFpbiwgeV90cmFpbikKICAgIAogICAgcmV0dXJuIG1vZGVs">
          ⬇
         </a>
        </div>
        <div class="ltx_listingline" id="lstnumberx56">
         <span class="ltx_text ltx_lst_comment ltx_font_typewriter ltx_font_italic" id="lstnumberx56.1" style="font-size:80%;">
          """Classification
          <span class="ltx_text ltx_lst_space" id="lstnumberx56.1.1">
          </span>
          with
          <span class="ltx_text ltx_lst_space" id="lstnumberx56.1.2">
          </span>
          a
          <span class="ltx_text ltx_lst_space" id="lstnumberx56.1.3">
          </span>
          Balance
          <span class="ltx_text ltx_lst_space" id="lstnumberx56.1.4">
          </span>
          Scale
          <span class="ltx_text ltx_lst_space" id="lstnumberx56.1.5">
          </span>
          Weight
          <span class="ltx_text ltx_lst_space" id="lstnumberx56.1.6">
          </span>
          &amp;
          <span class="ltx_text ltx_lst_space" id="lstnumberx56.1.7">
          </span>
          Distance
          <span class="ltx_text ltx_lst_space" id="lstnumberx56.1.8">
          </span>
          Prediction
          <span class="ltx_text ltx_lst_space" id="lstnumberx56.1.9">
          </span>
          Dataset"""
         </span>
        </div>
        <div class="ltx_listingline" id="lstnumberx57">
         <span class="ltx_text ltx_font_typewriter ltx_font_italic" id="lstnumberx57.1" style="font-size:80%;">
          import
         </span>
         <span class="ltx_text ltx_lst_space ltx_font_typewriter ltx_font_italic" id="lstnumberx57.2" style="font-size:80%;">
         </span>
         <span class="ltx_text ltx_font_typewriter ltx_font_italic" id="lstnumberx57.3" style="font-size:80%;">
          numpy
         </span>
         <span class="ltx_text ltx_lst_space ltx_font_typewriter ltx_font_italic" id="lstnumberx57.4" style="font-size:80%;">
         </span>
         <span class="ltx_text ltx_font_typewriter ltx_font_italic" id="lstnumberx57.5" style="font-size:80%;">
          as
         </span>
         <span class="ltx_text ltx_lst_space ltx_font_typewriter ltx_font_italic" id="lstnumberx57.6" style="font-size:80%;">
         </span>
         <span class="ltx_text ltx_font_typewriter ltx_font_italic" id="lstnumberx57.7" style="font-size:80%;">
          np
         </span>
        </div>
        <div class="ltx_listingline" id="lstnumberx58">
        </div>
        <div class="ltx_listingline" id="lstnumberx59">
         <span class="ltx_text ltx_font_typewriter ltx_font_italic" id="lstnumberx59.1" style="font-size:80%;">
          def
         </span>
         <span class="ltx_text ltx_lst_space ltx_font_typewriter ltx_font_italic" id="lstnumberx59.2" style="font-size:80%;">
         </span>
         <span class="ltx_text ltx_font_typewriter ltx_font_italic" id="lstnumberx59.3" style="font-size:80%;">
          build_model(x_train:
         </span>
         <span class="ltx_text ltx_lst_space ltx_font_typewriter ltx_font_italic" id="lstnumberx59.4" style="font-size:80%;">
         </span>
         <span class="ltx_text ltx_font_typewriter ltx_font_italic" id="lstnumberx59.5" style="font-size:80%;">
          np.ndarray,
         </span>
         <span class="ltx_text ltx_lst_space ltx_font_typewriter ltx_font_italic" id="lstnumberx59.6" style="font-size:80%;">
         </span>
         <span class="ltx_text ltx_font_typewriter ltx_font_italic" id="lstnumberx59.7" style="font-size:80%;">
          y_train:
         </span>
         <span class="ltx_text ltx_lst_space ltx_font_typewriter ltx_font_italic" id="lstnumberx59.8" style="font-size:80%;">
         </span>
         <span class="ltx_text ltx_font_typewriter ltx_font_italic" id="lstnumberx59.9" style="font-size:80%;">
          np.ndarray):
         </span>
        </div>
        <div class="ltx_listingline" id="lstnumberx60">
         <span class="ltx_text ltx_lst_space ltx_font_typewriter ltx_font_italic" id="lstnumberx60.1" style="font-size:80%;">
         </span>
         <span class="ltx_text ltx_font_typewriter ltx_font_italic" id="lstnumberx60.2" style="font-size:80%;">
          """Import
         </span>
         <span class="ltx_text ltx_lst_space ltx_font_typewriter ltx_font_italic" id="lstnumberx60.3" style="font-size:80%;">
         </span>
         <span class="ltx_text ltx_font_typewriter ltx_font_italic" id="lstnumberx60.4" style="font-size:80%;">
          modules,
         </span>
         <span class="ltx_text ltx_lst_space ltx_font_typewriter ltx_font_italic" id="lstnumberx60.5" style="font-size:80%;">
         </span>
         <span class="ltx_text ltx_font_typewriter ltx_font_italic" id="lstnumberx60.6" style="font-size:80%;">
          return
         </span>
         <span class="ltx_text ltx_lst_space ltx_font_typewriter ltx_font_italic" id="lstnumberx60.7" style="font-size:80%;">
         </span>
         <span class="ltx_text ltx_font_typewriter ltx_font_italic" id="lstnumberx60.8" style="font-size:80%;">
          a
         </span>
         <span class="ltx_text ltx_lst_space ltx_font_typewriter ltx_font_italic" id="lstnumberx60.9" style="font-size:80%;">
         </span>
         <span class="ltx_text ltx_font_typewriter ltx_font_italic" id="lstnumberx60.10" style="font-size:80%;">
          scikit
         </span>
         <span class="ltx_text ltx_lst_space ltx_font_typewriter ltx_font_italic" id="lstnumberx60.11" style="font-size:80%;">
         </span>
         <span class="ltx_text ltx_font_typewriter ltx_font_italic" id="lstnumberx60.12" style="font-size:80%;">
          model
         </span>
         <span class="ltx_text ltx_lst_space ltx_font_typewriter ltx_font_italic" id="lstnumberx60.13" style="font-size:80%;">
         </span>
         <span class="ltx_text ltx_font_typewriter ltx_font_italic" id="lstnumberx60.14" style="font-size:80%;">
          trained
         </span>
         <span class="ltx_text ltx_lst_space ltx_font_typewriter ltx_font_italic" id="lstnumberx60.15" style="font-size:80%;">
         </span>
         <span class="ltx_text ltx_font_typewriter ltx_font_italic" id="lstnumberx60.16" style="font-size:80%;">
          with
         </span>
         <span class="ltx_text ltx_lst_space ltx_font_typewriter ltx_font_italic" id="lstnumberx60.17" style="font-size:80%;">
         </span>
         <span class="ltx_text ltx_font_typewriter ltx_font_italic" id="lstnumberx60.18" style="font-size:80%;">
          x_train
         </span>
         <span class="ltx_text ltx_lst_space ltx_font_typewriter ltx_font_italic" id="lstnumberx60.19" style="font-size:80%;">
         </span>
         <span class="ltx_text ltx_font_typewriter ltx_font_italic" id="lstnumberx60.20" style="font-size:80%;">
          in
         </span>
         <span class="ltx_text ltx_lst_space ltx_font_typewriter ltx_font_italic" id="lstnumberx60.21" style="font-size:80%;">
         </span>
         <span class="ltx_text ltx_font_typewriter ltx_font_italic" id="lstnumberx60.22" style="font-size:80%;">
          shape
         </span>
         <span class="ltx_text ltx_lst_space ltx_font_typewriter ltx_font_italic" id="lstnumberx60.23" style="font-size:80%;">
         </span>
         <span class="ltx_text ltx_font_typewriter ltx_font_italic" id="lstnumberx60.24" style="font-size:80%;">
          (62,
         </span>
         <span class="ltx_text ltx_lst_space ltx_font_typewriter ltx_font_italic" id="lstnumberx60.25" style="font-size:80%;">
         </span>
         <span class="ltx_text ltx_font_typewriter ltx_font_italic" id="lstnumberx60.26" style="font-size:80%;">
          4)
         </span>
         <span class="ltx_text ltx_lst_space ltx_font_typewriter ltx_font_italic" id="lstnumberx60.27" style="font-size:80%;">
         </span>
         <span class="ltx_text ltx_font_typewriter ltx_font_italic" id="lstnumberx60.28" style="font-size:80%;">
          and
         </span>
         <span class="ltx_text ltx_lst_space ltx_font_typewriter ltx_font_italic" id="lstnumberx60.29" style="font-size:80%;">
         </span>
         <span class="ltx_text ltx_font_typewriter ltx_font_italic" id="lstnumberx60.30" style="font-size:80%;">
          y_train."""
         </span>
        </div>
        <div class="ltx_listingline" id="lstnumberx61">
         <span class="ltx_text ltx_lst_space ltx_font_typewriter ltx_font_italic" id="lstnumberx61.1" style="font-size:80%;">
         </span>
         <span class="ltx_text ltx_font_typewriter ltx_font_italic" id="lstnumberx61.2" style="font-size:80%;">
          from
         </span>
         <span class="ltx_text ltx_lst_space ltx_font_typewriter ltx_font_italic" id="lstnumberx61.3" style="font-size:80%;">
         </span>
         <span class="ltx_text ltx_font_typewriter ltx_font_italic" id="lstnumberx61.4" style="font-size:80%;">
          sklearn.pipeline
         </span>
         <span class="ltx_text ltx_lst_space ltx_font_typewriter ltx_font_italic" id="lstnumberx61.5" style="font-size:80%;">
         </span>
         <span class="ltx_text ltx_font_typewriter ltx_font_italic" id="lstnumberx61.6" style="font-size:80%;">
          import
         </span>
         <span class="ltx_text ltx_lst_space ltx_font_typewriter ltx_font_italic" id="lstnumberx61.7" style="font-size:80%;">
         </span>
         <span class="ltx_text ltx_font_typewriter ltx_font_italic" id="lstnumberx61.8" style="font-size:80%;">
          Pipeline
         </span>
        </div>
        <div class="ltx_listingline" id="lstnumberx62">
         <span class="ltx_text ltx_lst_space ltx_font_typewriter ltx_font_italic" id="lstnumberx62.1" style="font-size:80%;">
         </span>
         <span class="ltx_text ltx_font_typewriter ltx_font_italic" id="lstnumberx62.2" style="font-size:80%;">
          from
         </span>
         <span class="ltx_text ltx_lst_space ltx_font_typewriter ltx_font_italic" id="lstnumberx62.3" style="font-size:80%;">
         </span>
         <span class="ltx_text ltx_font_typewriter ltx_font_italic" id="lstnumberx62.4" style="font-size:80%;">
          sklearn.preprocessing
         </span>
         <span class="ltx_text ltx_lst_space ltx_font_typewriter ltx_font_italic" id="lstnumberx62.5" style="font-size:80%;">
         </span>
         <span class="ltx_text ltx_font_typewriter ltx_font_italic" id="lstnumberx62.6" style="font-size:80%;">
          import
         </span>
         <span class="ltx_text ltx_lst_space ltx_font_typewriter ltx_font_italic" id="lstnumberx62.7" style="font-size:80%;">
         </span>
         <span class="ltx_text ltx_font_typewriter ltx_font_italic" id="lstnumberx62.8" style="font-size:80%;">
          StandardScaler
         </span>
        </div>
        <div class="ltx_listingline" id="lstnumberx63">
         <span class="ltx_text ltx_lst_space ltx_font_typewriter ltx_font_italic" id="lstnumberx63.1" style="font-size:80%;">
         </span>
         <span class="ltx_text ltx_font_typewriter ltx_font_italic" id="lstnumberx63.2" style="font-size:80%;">
          from
         </span>
         <span class="ltx_text ltx_lst_space ltx_font_typewriter ltx_font_italic" id="lstnumberx63.3" style="font-size:80%;">
         </span>
         <span class="ltx_text ltx_font_typewriter ltx_font_italic" id="lstnumberx63.4" style="font-size:80%;">
          sklearn.neural_network
         </span>
         <span class="ltx_text ltx_lst_space ltx_font_typewriter ltx_font_italic" id="lstnumberx63.5" style="font-size:80%;">
         </span>
         <span class="ltx_text ltx_font_typewriter ltx_font_italic" id="lstnumberx63.6" style="font-size:80%;">
          import
         </span>
         <span class="ltx_text ltx_lst_space ltx_font_typewriter ltx_font_italic" id="lstnumberx63.7" style="font-size:80%;">
         </span>
         <span class="ltx_text ltx_font_typewriter ltx_font_italic" id="lstnumberx63.8" style="font-size:80%;">
          MLPClassifier
         </span>
        </div>
        <div class="ltx_listingline" id="lstnumberx64">
        </div>
        <div class="ltx_listingline" id="lstnumberx65">
         <span class="ltx_text ltx_lst_space ltx_font_typewriter ltx_font_italic" id="lstnumberx65.1" style="font-size:80%;">
         </span>
         <span class="ltx_text ltx_font_typewriter ltx_font_italic" id="lstnumberx65.2" style="font-size:80%;">
          pipeline
         </span>
         <span class="ltx_text ltx_lst_space ltx_font_typewriter ltx_font_italic" id="lstnumberx65.3" style="font-size:80%;">
         </span>
         <span class="ltx_text ltx_font_typewriter ltx_font_italic" id="lstnumberx65.4" style="font-size:80%;">
          =
         </span>
         <span class="ltx_text ltx_lst_space ltx_font_typewriter ltx_font_italic" id="lstnumberx65.5" style="font-size:80%;">
         </span>
         <span class="ltx_text ltx_font_typewriter ltx_font_italic" id="lstnumberx65.6" style="font-size:80%;">
          Pipeline([
         </span>
        </div>
        <div class="ltx_listingline" id="lstnumberx66">
         <span class="ltx_text ltx_lst_space ltx_font_typewriter ltx_font_italic" id="lstnumberx66.1" style="font-size:80%;">
         </span>
         <span class="ltx_text ltx_font_typewriter ltx_font_italic" id="lstnumberx66.2" style="font-size:80%;">
          (’scaler’,
         </span>
         <span class="ltx_text ltx_lst_space ltx_font_typewriter ltx_font_italic" id="lstnumberx66.3" style="font-size:80%;">
         </span>
         <span class="ltx_text ltx_font_typewriter ltx_font_italic" id="lstnumberx66.4" style="font-size:80%;">
          StandardScaler()),
         </span>
        </div>
        <div class="ltx_listingline" id="lstnumberx67">
         <span class="ltx_text ltx_lst_space ltx_font_typewriter ltx_font_italic" id="lstnumberx67.1" style="font-size:80%;">
         </span>
         <span class="ltx_text ltx_font_typewriter ltx_font_italic" id="lstnumberx67.2" style="font-size:80%;">
          (’model’,
         </span>
         <span class="ltx_text ltx_lst_space ltx_font_typewriter ltx_font_italic" id="lstnumberx67.3" style="font-size:80%;">
         </span>
         <span class="ltx_text ltx_font_typewriter ltx_font_italic" id="lstnumberx67.4" style="font-size:80%;">
          MLPClassifier(hidden_layer_sizes=(100,),
         </span>
         <span class="ltx_text ltx_lst_space ltx_font_typewriter ltx_font_italic" id="lstnumberx67.5" style="font-size:80%;">
         </span>
         <span class="ltx_text ltx_font_typewriter ltx_font_italic" id="lstnumberx67.6" style="font-size:80%;">
          activation=’relu’,
         </span>
         <span class="ltx_text ltx_lst_space ltx_font_typewriter ltx_font_italic" id="lstnumberx67.7" style="font-size:80%;">
         </span>
         <span class="ltx_text ltx_font_typewriter ltx_font_italic" id="lstnumberx67.8" style="font-size:80%;">
          solver=’lbfgs’,
         </span>
         <span class="ltx_text ltx_lst_space ltx_font_typewriter ltx_font_italic" id="lstnumberx67.9" style="font-size:80%;">
         </span>
         <span class="ltx_text ltx_font_typewriter ltx_font_italic" id="lstnumberx67.10" style="font-size:80%;">
          max_iter=1000,
         </span>
         <span class="ltx_text ltx_lst_space ltx_font_typewriter ltx_font_italic" id="lstnumberx67.11" style="font-size:80%;">
         </span>
         <span class="ltx_text ltx_font_typewriter ltx_font_italic" id="lstnumberx67.12" style="font-size:80%;">
          alpha=1e-5,
         </span>
        </div>
        <div class="ltx_listingline" id="lstnumberx68">
         <span class="ltx_text ltx_lst_space ltx_font_typewriter ltx_font_italic" id="lstnumberx68.1" style="font-size:80%;">
         </span>
         <span class="ltx_text ltx_font_typewriter ltx_font_italic" id="lstnumberx68.2" style="font-size:80%;">
          batch_size=100,
         </span>
         <span class="ltx_text ltx_lst_space ltx_font_typewriter ltx_font_italic" id="lstnumberx68.3" style="font-size:80%;">
         </span>
         <span class="ltx_text ltx_font_typewriter ltx_font_italic" id="lstnumberx68.4" style="font-size:80%;">
          learning_rate_init=0.1,
         </span>
         <span class="ltx_text ltx_lst_space ltx_font_typewriter ltx_font_italic" id="lstnumberx68.5" style="font-size:80%;">
         </span>
         <span class="ltx_text ltx_font_typewriter ltx_font_italic" id="lstnumberx68.6" style="font-size:80%;">
          learning_rate=’adaptive’,
         </span>
         <span class="ltx_text ltx_lst_space ltx_font_typewriter ltx_font_italic" id="lstnumberx68.7" style="font-size:80%;">
         </span>
         <span class="ltx_text ltx_font_typewriter ltx_font_italic" id="lstnumberx68.8" style="font-size:80%;">
          tol=1e-4,
         </span>
         <span class="ltx_text ltx_lst_space ltx_font_typewriter ltx_font_italic" id="lstnumberx68.9" style="font-size:80%;">
         </span>
         <span class="ltx_text ltx_font_typewriter ltx_font_italic" id="lstnumberx68.10" style="font-size:80%;">
          verbose=True,
         </span>
        </div>
        <div class="ltx_listingline" id="lstnumberx69">
         <span class="ltx_text ltx_lst_space ltx_font_typewriter ltx_font_italic" id="lstnumberx69.1" style="font-size:80%;">
         </span>
         <span class="ltx_text ltx_font_typewriter ltx_font_italic" id="lstnumberx69.2" style="font-size:80%;">
          warm_start=False,
         </span>
         <span class="ltx_text ltx_lst_space ltx_font_typewriter ltx_font_italic" id="lstnumberx69.3" style="font-size:80%;">
         </span>
         <span class="ltx_text ltx_font_typewriter ltx_font_italic" id="lstnumberx69.4" style="font-size:80%;">
          momentum=0.9,
         </span>
         <span class="ltx_text ltx_lst_space ltx_font_typewriter ltx_font_italic" id="lstnumberx69.5" style="font-size:80%;">
         </span>
         <span class="ltx_text ltx_font_typewriter ltx_font_italic" id="lstnumberx69.6" style="font-size:80%;">
          nesterovs_momentum=True,
         </span>
         <span class="ltx_text ltx_lst_space ltx_font_typewriter ltx_font_italic" id="lstnumberx69.7" style="font-size:80%;">
         </span>
         <span class="ltx_text ltx_font_typewriter ltx_font_italic" id="lstnumberx69.8" style="font-size:80%;">
          early_stopping=True,
         </span>
        </div>
        <div class="ltx_listingline" id="lstnumberx70">
         <span class="ltx_text ltx_lst_space ltx_font_typewriter ltx_font_italic" id="lstnumberx70.1" style="font-size:80%;">
         </span>
         <span class="ltx_text ltx_font_typewriter ltx_font_italic" id="lstnumberx70.2" style="font-size:80%;">
          validation_fraction=0.1,
         </span>
         <span class="ltx_text ltx_lst_space ltx_font_typewriter ltx_font_italic" id="lstnumberx70.3" style="font-size:80%;">
         </span>
         <span class="ltx_text ltx_font_typewriter ltx_font_italic" id="lstnumberx70.4" style="font-size:80%;">
          beta_1=0.9,
         </span>
         <span class="ltx_text ltx_lst_space ltx_font_typewriter ltx_font_italic" id="lstnumberx70.5" style="font-size:80%;">
         </span>
         <span class="ltx_text ltx_font_typewriter ltx_font_italic" id="lstnumberx70.6" style="font-size:80%;">
          beta_2=0.999,
         </span>
         <span class="ltx_text ltx_lst_space ltx_font_typewriter ltx_font_italic" id="lstnumberx70.7" style="font-size:80%;">
         </span>
         <span class="ltx_text ltx_font_typewriter ltx_font_italic" id="lstnumberx70.8" style="font-size:80%;">
          epsilon=1e-8,
         </span>
         <span class="ltx_text ltx_lst_space ltx_font_typewriter ltx_font_italic" id="lstnumberx70.9" style="font-size:80%;">
         </span>
         <span class="ltx_text ltx_font_typewriter ltx_font_italic" id="lstnumberx70.10" style="font-size:80%;">
          n_iter_no_change=10,
         </span>
        </div>
        <div class="ltx_listingline" id="lstnumberx71">
         <span class="ltx_text ltx_lst_space ltx_font_typewriter ltx_font_italic" id="lstnumberx71.1" style="font-size:80%;">
         </span>
         <span class="ltx_text ltx_font_typewriter ltx_font_italic" id="lstnumberx71.2" style="font-size:80%;">
          max_fun=15000)),
         </span>
        </div>
        <div class="ltx_listingline" id="lstnumberx72">
         <span class="ltx_text ltx_lst_space ltx_font_typewriter ltx_font_italic" id="lstnumberx72.1" style="font-size:80%;">
         </span>
         <span class="ltx_text ltx_font_typewriter ltx_font_italic" id="lstnumberx72.2" style="font-size:80%;">
          ])
         </span>
        </div>
        <div class="ltx_listingline" id="lstnumberx73">
        </div>
        <div class="ltx_listingline" id="lstnumberx74">
         <span class="ltx_text ltx_lst_space ltx_font_typewriter ltx_font_italic" id="lstnumberx74.1" style="font-size:80%;">
         </span>
         <span class="ltx_text ltx_font_typewriter ltx_font_italic" id="lstnumberx74.2" style="font-size:80%;">
          model
         </span>
         <span class="ltx_text ltx_lst_space ltx_font_typewriter ltx_font_italic" id="lstnumberx74.3" style="font-size:80%;">
         </span>
         <span class="ltx_text ltx_font_typewriter ltx_font_italic" id="lstnumberx74.4" style="font-size:80%;">
          =
         </span>
         <span class="ltx_text ltx_lst_space ltx_font_typewriter ltx_font_italic" id="lstnumberx74.5" style="font-size:80%;">
         </span>
         <span class="ltx_text ltx_font_typewriter ltx_font_italic" id="lstnumberx74.6" style="font-size:80%;">
          pipeline.fit(x_train,
         </span>
         <span class="ltx_text ltx_lst_space ltx_font_typewriter ltx_font_italic" id="lstnumberx74.7" style="font-size:80%;">
         </span>
         <span class="ltx_text ltx_font_typewriter ltx_font_italic" id="lstnumberx74.8" style="font-size:80%;">
          y_train)
         </span>
        </div>
        <div class="ltx_listingline" id="lstnumberx75">
        </div>
        <div class="ltx_listingline" id="lstnumberx76">
         <span class="ltx_text ltx_lst_space ltx_font_typewriter ltx_font_italic" id="lstnumberx76.1" style="font-size:80%;">
         </span>
         <span class="ltx_text ltx_font_typewriter ltx_font_italic" id="lstnumberx76.2" style="font-size:80%;">
          return
         </span>
         <span class="ltx_text ltx_lst_space ltx_font_typewriter ltx_font_italic" id="lstnumberx76.3" style="font-size:80%;">
         </span>
         <span class="ltx_text ltx_font_typewriter ltx_font_italic" id="lstnumberx76.4" style="font-size:80%;">
          model
         </span>
        </div>
       </div>
      </figure>
      <figcaption class="ltx_caption ltx_centering">
       <span class="ltx_tag ltx_tag_figure">
        Figure 9:
       </span>
       A demonstration of the best code generated by CodeLlama-7B after RL training for the Balance Scale dataset. It achieves the ROC AUC score of 0.9289.
      </figcaption>
     </figure>
    </div>
   </div>
  </figure>
  <div class="ltx_pagination ltx_role_newpage">
  </div>
 </section>
 <section class="ltx_appendix" id="A6">
  <h2 class="ltx_title ltx_title_appendix">
   <span class="ltx_tag ltx_tag_appendix">
    Appendix F
   </span>
   Additional Results
  </h2>
  <figure class="ltx_table" id="A6.T4">
   <figcaption class="ltx_caption">
    <span class="ltx_tag ltx_tag_table">
     Table 4:
    </span>
    Details of performance comparison between different ablations across 14 datasets.
   </figcaption>
   <table class="ltx_tabular ltx_centering ltx_align_middle" id="A6.T4.45.45">
    <tbody class="ltx_tbody">
     <tr class="ltx_tr" id="A6.T4.45.45.46.1">
      <td class="ltx_td ltx_align_left ltx_border_r ltx_border_tt" id="A6.T4.45.45.46.1.1">
       <span class="ltx_text ltx_font_smallcaps" id="A6.T4.45.45.46.1.1.1">
        Data set
       </span>
      </td>
      <td class="ltx_td ltx_align_center ltx_border_r ltx_border_tt" id="A6.T4.45.45.46.1.2">
       <span class="ltx_text ltx_font_smallcaps" id="A6.T4.45.45.46.1.2.1">
        ETPO(Disc.)
       </span>
      </td>
      <td class="ltx_td ltx_align_center ltx_border_r ltx_border_tt" id="A6.T4.45.45.46.1.3">
       <span class="ltx_text ltx_font_smallcaps" id="A6.T4.45.45.46.1.3.1">
        ETPO(1-Step)
       </span>
      </td>
      <td class="ltx_td ltx_align_center ltx_border_tt" id="A6.T4.45.45.46.1.4">
       <span class="ltx_text ltx_font_smallcaps" id="A6.T4.45.45.46.1.4.1">
        ETPO
       </span>
      </td>
     </tr>
     <tr class="ltx_tr" id="A6.T4.3.3.3">
      <td class="ltx_td ltx_align_left ltx_border_r ltx_border_t" id="A6.T4.3.3.3.4">
       <span class="ltx_text ltx_font_smallcaps" id="A6.T4.3.3.3.4.1">
        Pharyngitis ⟨
       </span>
       <span class="ltx_text ltx_font_italic" id="A6.T4.3.3.3.4.2">
        K
       </span>
       <span class="ltx_text ltx_font_smallcaps" id="A6.T4.3.3.3.4.3">
        ⟩
       </span>
      </td>
      <td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="A6.T4.1.1.1.1">
       <span class="ltx_text ltx_font_smallcaps" id="A6.T4.1.1.1.1.1">
        0.7134
       </span>
       <math alttext="\pm" class="ltx_Math" display="inline" id="A6.T4.1.1.1.1.m1.1">
        <semantics id="A6.T4.1.1.1.1.m1.1a">
         <mo id="A6.T4.1.1.1.1.m1.1.1" xref="A6.T4.1.1.1.1.m1.1.1.cmml">
          ±
         </mo>
         <annotation-xml encoding="MathML-Content" id="A6.T4.1.1.1.1.m1.1b">
          <csymbol cd="latexml" id="A6.T4.1.1.1.1.m1.1.1.cmml" xref="A6.T4.1.1.1.1.m1.1.1">
           plus-or-minus
          </csymbol>
         </annotation-xml>
         <annotation encoding="application/x-tex" id="A6.T4.1.1.1.1.m1.1c">
          \pm
         </annotation>
        </semantics>
       </math>
       <span class="ltx_text ltx_font_smallcaps" id="A6.T4.1.1.1.1.2">
        0.009
       </span>
      </td>
      <td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="A6.T4.2.2.2.2">
       <span class="ltx_text ltx_font_bold" id="A6.T4.2.2.2.2.1">
        0.7357
        <math alttext="\pm" class="ltx_Math" display="inline" id="A6.T4.2.2.2.2.1.m1.1">
         <semantics id="A6.T4.2.2.2.2.1.m1.1a">
          <mo id="A6.T4.2.2.2.2.1.m1.1.1" xref="A6.T4.2.2.2.2.1.m1.1.1.cmml">
           ±
          </mo>
          <annotation-xml encoding="MathML-Content" id="A6.T4.2.2.2.2.1.m1.1b">
           <csymbol cd="latexml" id="A6.T4.2.2.2.2.1.m1.1.1.cmml" xref="A6.T4.2.2.2.2.1.m1.1.1">
            plus-or-minus
           </csymbol>
          </annotation-xml>
          <annotation encoding="application/x-tex" id="A6.T4.2.2.2.2.1.m1.1c">
           \pm
          </annotation>
         </semantics>
        </math>
       </span>
       <span class="ltx_text ltx_font_smallcaps" id="A6.T4.2.2.2.2.2">
        0.007
       </span>
      </td>
      <td class="ltx_td ltx_align_center ltx_border_t" id="A6.T4.3.3.3.3">
       <span class="ltx_text ltx_font_smallcaps" id="A6.T4.3.3.3.3.1">
        0.7317
       </span>
       <math alttext="\pm" class="ltx_Math" display="inline" id="A6.T4.3.3.3.3.m1.1">
        <semantics id="A6.T4.3.3.3.3.m1.1a">
         <mo id="A6.T4.3.3.3.3.m1.1.1" xref="A6.T4.3.3.3.3.m1.1.1.cmml">
          ±
         </mo>
         <annotation-xml encoding="MathML-Content" id="A6.T4.3.3.3.3.m1.1b">
          <csymbol cd="latexml" id="A6.T4.3.3.3.3.m1.1.1.cmml" xref="A6.T4.3.3.3.3.m1.1.1">
           plus-or-minus
          </csymbol>
         </annotation-xml>
         <annotation encoding="application/x-tex" id="A6.T4.3.3.3.3.m1.1c">
          \pm
         </annotation>
        </semantics>
       </math>
       <span class="ltx_text ltx_font_smallcaps" id="A6.T4.3.3.3.3.2">
        0.006
       </span>
      </td>
     </tr>
     <tr class="ltx_tr" id="A6.T4.6.6.6">
      <td class="ltx_td ltx_align_left ltx_border_r" id="A6.T4.6.6.6.4">
       <span class="ltx_text ltx_font_smallcaps" id="A6.T4.6.6.6.4.1">
        Kidney Stone ⟨
       </span>
       <span class="ltx_text ltx_font_italic" id="A6.T4.6.6.6.4.2">
        K
       </span>
       <span class="ltx_text ltx_font_smallcaps" id="A6.T4.6.6.6.4.3">
        ⟩
       </span>
      </td>
      <td class="ltx_td ltx_align_center ltx_border_r" id="A6.T4.4.4.4.1">
       <span class="ltx_text ltx_font_bold" id="A6.T4.4.4.4.1.1">
        0.7881
        <math alttext="\pm" class="ltx_Math" display="inline" id="A6.T4.4.4.4.1.1.m1.1">
         <semantics id="A6.T4.4.4.4.1.1.m1.1a">
          <mo id="A6.T4.4.4.4.1.1.m1.1.1" xref="A6.T4.4.4.4.1.1.m1.1.1.cmml">
           ±
          </mo>
          <annotation-xml encoding="MathML-Content" id="A6.T4.4.4.4.1.1.m1.1b">
           <csymbol cd="latexml" id="A6.T4.4.4.4.1.1.m1.1.1.cmml" xref="A6.T4.4.4.4.1.1.m1.1.1">
            plus-or-minus
           </csymbol>
          </annotation-xml>
          <annotation encoding="application/x-tex" id="A6.T4.4.4.4.1.1.m1.1c">
           \pm
          </annotation>
         </semantics>
        </math>
       </span>
       <span class="ltx_text ltx_font_smallcaps" id="A6.T4.4.4.4.1.2">
        0.011
       </span>
      </td>
      <td class="ltx_td ltx_align_center ltx_border_r" id="A6.T4.5.5.5.2">
       <span class="ltx_text ltx_font_smallcaps" id="A6.T4.5.5.5.2.1">
        0.7861
       </span>
       <math alttext="\pm" class="ltx_Math" display="inline" id="A6.T4.5.5.5.2.m1.1">
        <semantics id="A6.T4.5.5.5.2.m1.1a">
         <mo id="A6.T4.5.5.5.2.m1.1.1" xref="A6.T4.5.5.5.2.m1.1.1.cmml">
          ±
         </mo>
         <annotation-xml encoding="MathML-Content" id="A6.T4.5.5.5.2.m1.1b">
          <csymbol cd="latexml" id="A6.T4.5.5.5.2.m1.1.1.cmml" xref="A6.T4.5.5.5.2.m1.1.1">
           plus-or-minus
          </csymbol>
         </annotation-xml>
         <annotation encoding="application/x-tex" id="A6.T4.5.5.5.2.m1.1c">
          \pm
         </annotation>
        </semantics>
       </math>
       <span class="ltx_text ltx_font_smallcaps" id="A6.T4.5.5.5.2.2">
        0.012
       </span>
      </td>
      <td class="ltx_td ltx_align_center" id="A6.T4.6.6.6.3">
       <span class="ltx_text ltx_font_bold" id="A6.T4.6.6.6.3.1">
        0.7881
        <math alttext="\pm" class="ltx_Math" display="inline" id="A6.T4.6.6.6.3.1.m1.1">
         <semantics id="A6.T4.6.6.6.3.1.m1.1a">
          <mo id="A6.T4.6.6.6.3.1.m1.1.1" xref="A6.T4.6.6.6.3.1.m1.1.1.cmml">
           ±
          </mo>
          <annotation-xml encoding="MathML-Content" id="A6.T4.6.6.6.3.1.m1.1b">
           <csymbol cd="latexml" id="A6.T4.6.6.6.3.1.m1.1.1.cmml" xref="A6.T4.6.6.6.3.1.m1.1.1">
            plus-or-minus
           </csymbol>
          </annotation-xml>
          <annotation encoding="application/x-tex" id="A6.T4.6.6.6.3.1.m1.1c">
           \pm
          </annotation>
         </semantics>
        </math>
       </span>
       <span class="ltx_text ltx_font_smallcaps" id="A6.T4.6.6.6.3.2">
        0.011
       </span>
      </td>
     </tr>
     <tr class="ltx_tr" id="A6.T4.9.9.9">
      <td class="ltx_td ltx_align_left ltx_border_r" id="A6.T4.9.9.9.4">
       <span class="ltx_text ltx_font_smallcaps" id="A6.T4.9.9.9.4.1">
        Health Insurance ⟨
       </span>
       <span class="ltx_text ltx_font_italic" id="A6.T4.9.9.9.4.2">
        K
       </span>
       <span class="ltx_text ltx_font_smallcaps" id="A6.T4.9.9.9.4.3">
        ⟩
       </span>
      </td>
      <td class="ltx_td ltx_align_center ltx_border_r" id="A6.T4.7.7.7.1">
       <span class="ltx_text ltx_font_smallcaps" id="A6.T4.7.7.7.1.1">
        0.5849
       </span>
       <math alttext="\pm" class="ltx_Math" display="inline" id="A6.T4.7.7.7.1.m1.1">
        <semantics id="A6.T4.7.7.7.1.m1.1a">
         <mo id="A6.T4.7.7.7.1.m1.1.1" xref="A6.T4.7.7.7.1.m1.1.1.cmml">
          ±
         </mo>
         <annotation-xml encoding="MathML-Content" id="A6.T4.7.7.7.1.m1.1b">
          <csymbol cd="latexml" id="A6.T4.7.7.7.1.m1.1.1.cmml" xref="A6.T4.7.7.7.1.m1.1.1">
           plus-or-minus
          </csymbol>
         </annotation-xml>
         <annotation encoding="application/x-tex" id="A6.T4.7.7.7.1.m1.1c">
          \pm
         </annotation>
        </semantics>
       </math>
       <span class="ltx_text ltx_font_smallcaps" id="A6.T4.7.7.7.1.2">
        0.015
       </span>
      </td>
      <td class="ltx_td ltx_align_center ltx_border_r" id="A6.T4.8.8.8.2">
       <span class="ltx_text ltx_font_smallcaps" id="A6.T4.8.8.8.2.1">
        0.5829
       </span>
       <math alttext="\pm" class="ltx_Math" display="inline" id="A6.T4.8.8.8.2.m1.1">
        <semantics id="A6.T4.8.8.8.2.m1.1a">
         <mo id="A6.T4.8.8.8.2.m1.1.1" xref="A6.T4.8.8.8.2.m1.1.1.cmml">
          ±
         </mo>
         <annotation-xml encoding="MathML-Content" id="A6.T4.8.8.8.2.m1.1b">
          <csymbol cd="latexml" id="A6.T4.8.8.8.2.m1.1.1.cmml" xref="A6.T4.8.8.8.2.m1.1.1">
           plus-or-minus
          </csymbol>
         </annotation-xml>
         <annotation encoding="application/x-tex" id="A6.T4.8.8.8.2.m1.1c">
          \pm
         </annotation>
        </semantics>
       </math>
       <span class="ltx_text ltx_font_smallcaps" id="A6.T4.8.8.8.2.2">
        0.016
       </span>
      </td>
      <td class="ltx_td ltx_align_center" id="A6.T4.9.9.9.3">
       <span class="ltx_text ltx_font_bold" id="A6.T4.9.9.9.3.1">
        0.5995
        <math alttext="\pm" class="ltx_Math" display="inline" id="A6.T4.9.9.9.3.1.m1.1">
         <semantics id="A6.T4.9.9.9.3.1.m1.1a">
          <mo id="A6.T4.9.9.9.3.1.m1.1.1" xref="A6.T4.9.9.9.3.1.m1.1.1.cmml">
           ±
          </mo>
          <annotation-xml encoding="MathML-Content" id="A6.T4.9.9.9.3.1.m1.1b">
           <csymbol cd="latexml" id="A6.T4.9.9.9.3.1.m1.1.1.cmml" xref="A6.T4.9.9.9.3.1.m1.1.1">
            plus-or-minus
           </csymbol>
          </annotation-xml>
          <annotation encoding="application/x-tex" id="A6.T4.9.9.9.3.1.m1.1c">
           \pm
          </annotation>
         </semantics>
        </math>
       </span>
       <span class="ltx_text ltx_font_smallcaps" id="A6.T4.9.9.9.3.2">
        0.011
       </span>
      </td>
     </tr>
     <tr class="ltx_tr" id="A6.T4.12.12.12">
      <td class="ltx_td ltx_align_left ltx_border_r" id="A6.T4.12.12.12.4">
       <span class="ltx_text ltx_font_smallcaps" id="A6.T4.12.12.12.4.1">
        Spaceship Titanic ⟨
       </span>
       <span class="ltx_text ltx_font_italic" id="A6.T4.12.12.12.4.2">
        K
       </span>
       <span class="ltx_text ltx_font_smallcaps" id="A6.T4.12.12.12.4.3">
        ⟩
       </span>
      </td>
      <td class="ltx_td ltx_align_center ltx_border_r" id="A6.T4.10.10.10.1">
       <span class="ltx_text ltx_font_smallcaps" id="A6.T4.10.10.10.1.1">
        0.8574
       </span>
       <math alttext="\pm" class="ltx_Math" display="inline" id="A6.T4.10.10.10.1.m1.1">
        <semantics id="A6.T4.10.10.10.1.m1.1a">
         <mo id="A6.T4.10.10.10.1.m1.1.1" xref="A6.T4.10.10.10.1.m1.1.1.cmml">
          ±
         </mo>
         <annotation-xml encoding="MathML-Content" id="A6.T4.10.10.10.1.m1.1b">
          <csymbol cd="latexml" id="A6.T4.10.10.10.1.m1.1.1.cmml" xref="A6.T4.10.10.10.1.m1.1.1">
           plus-or-minus
          </csymbol>
         </annotation-xml>
         <annotation encoding="application/x-tex" id="A6.T4.10.10.10.1.m1.1c">
          \pm
         </annotation>
        </semantics>
       </math>
       <span class="ltx_text ltx_font_smallcaps" id="A6.T4.10.10.10.1.2">
        0.013
       </span>
      </td>
      <td class="ltx_td ltx_align_center ltx_border_r" id="A6.T4.11.11.11.2">
       <span class="ltx_text ltx_font_bold" id="A6.T4.11.11.11.2.1">
        0.8597
        <math alttext="\pm" class="ltx_Math" display="inline" id="A6.T4.11.11.11.2.1.m1.1">
         <semantics id="A6.T4.11.11.11.2.1.m1.1a">
          <mo id="A6.T4.11.11.11.2.1.m1.1.1" xref="A6.T4.11.11.11.2.1.m1.1.1.cmml">
           ±
          </mo>
          <annotation-xml encoding="MathML-Content" id="A6.T4.11.11.11.2.1.m1.1b">
           <csymbol cd="latexml" id="A6.T4.11.11.11.2.1.m1.1.1.cmml" xref="A6.T4.11.11.11.2.1.m1.1.1">
            plus-or-minus
           </csymbol>
          </annotation-xml>
          <annotation encoding="application/x-tex" id="A6.T4.11.11.11.2.1.m1.1c">
           \pm
          </annotation>
         </semantics>
        </math>
       </span>
       <span class="ltx_text ltx_font_smallcaps" id="A6.T4.11.11.11.2.2">
        0.013
       </span>
      </td>
      <td class="ltx_td ltx_align_center" id="A6.T4.12.12.12.3">
       <span class="ltx_text ltx_font_smallcaps" id="A6.T4.12.12.12.3.1">
        0.8578
       </span>
       <math alttext="\pm" class="ltx_Math" display="inline" id="A6.T4.12.12.12.3.m1.1">
        <semantics id="A6.T4.12.12.12.3.m1.1a">
         <mo id="A6.T4.12.12.12.3.m1.1.1" xref="A6.T4.12.12.12.3.m1.1.1.cmml">
          ±
         </mo>
         <annotation-xml encoding="MathML-Content" id="A6.T4.12.12.12.3.m1.1b">
          <csymbol cd="latexml" id="A6.T4.12.12.12.3.m1.1.1.cmml" xref="A6.T4.12.12.12.3.m1.1.1">
           plus-or-minus
          </csymbol>
         </annotation-xml>
         <annotation encoding="application/x-tex" id="A6.T4.12.12.12.3.m1.1c">
          \pm
         </annotation>
        </semantics>
       </math>
       <span class="ltx_text ltx_font_smallcaps" id="A6.T4.12.12.12.3.2">
        0.015
       </span>
      </td>
     </tr>
     <tr class="ltx_tr" id="A6.T4.15.15.15">
      <td class="ltx_td ltx_align_left ltx_border_r ltx_border_t" id="A6.T4.15.15.15.4">
       <span class="ltx_text ltx_font_smallcaps" id="A6.T4.15.15.15.4.1">
        Airlines
       </span>
      </td>
      <td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="A6.T4.13.13.13.1">
       <span class="ltx_text ltx_font_smallcaps" id="A6.T4.13.13.13.1.1">
        0.6540
       </span>
       <math alttext="\pm" class="ltx_Math" display="inline" id="A6.T4.13.13.13.1.m1.1">
        <semantics id="A6.T4.13.13.13.1.m1.1a">
         <mo id="A6.T4.13.13.13.1.m1.1.1" xref="A6.T4.13.13.13.1.m1.1.1.cmml">
          ±
         </mo>
         <annotation-xml encoding="MathML-Content" id="A6.T4.13.13.13.1.m1.1b">
          <csymbol cd="latexml" id="A6.T4.13.13.13.1.m1.1.1.cmml" xref="A6.T4.13.13.13.1.m1.1.1">
           plus-or-minus
          </csymbol>
         </annotation-xml>
         <annotation encoding="application/x-tex" id="A6.T4.13.13.13.1.m1.1c">
          \pm
         </annotation>
        </semantics>
       </math>
       <span class="ltx_text ltx_font_smallcaps" id="A6.T4.13.13.13.1.2">
        0.011
       </span>
      </td>
      <td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="A6.T4.14.14.14.2">
       <span class="ltx_text ltx_font_smallcaps" id="A6.T4.14.14.14.2.1">
        0.6564
       </span>
       <math alttext="\pm" class="ltx_Math" display="inline" id="A6.T4.14.14.14.2.m1.1">
        <semantics id="A6.T4.14.14.14.2.m1.1a">
         <mo id="A6.T4.14.14.14.2.m1.1.1" xref="A6.T4.14.14.14.2.m1.1.1.cmml">
          ±
         </mo>
         <annotation-xml encoding="MathML-Content" id="A6.T4.14.14.14.2.m1.1b">
          <csymbol cd="latexml" id="A6.T4.14.14.14.2.m1.1.1.cmml" xref="A6.T4.14.14.14.2.m1.1.1">
           plus-or-minus
          </csymbol>
         </annotation-xml>
         <annotation encoding="application/x-tex" id="A6.T4.14.14.14.2.m1.1c">
          \pm
         </annotation>
        </semantics>
       </math>
       <span class="ltx_text ltx_font_smallcaps" id="A6.T4.14.14.14.2.2">
        0.010
       </span>
      </td>
      <td class="ltx_td ltx_align_center ltx_border_t" id="A6.T4.15.15.15.3">
       <span class="ltx_text ltx_font_bold" id="A6.T4.15.15.15.3.1">
        0.6580
        <math alttext="\pm" class="ltx_Math" display="inline" id="A6.T4.15.15.15.3.1.m1.1">
         <semantics id="A6.T4.15.15.15.3.1.m1.1a">
          <mo id="A6.T4.15.15.15.3.1.m1.1.1" xref="A6.T4.15.15.15.3.1.m1.1.1.cmml">
           ±
          </mo>
          <annotation-xml encoding="MathML-Content" id="A6.T4.15.15.15.3.1.m1.1b">
           <csymbol cd="latexml" id="A6.T4.15.15.15.3.1.m1.1.1.cmml" xref="A6.T4.15.15.15.3.1.m1.1.1">
            plus-or-minus
           </csymbol>
          </annotation-xml>
          <annotation encoding="application/x-tex" id="A6.T4.15.15.15.3.1.m1.1c">
           \pm
          </annotation>
         </semantics>
        </math>
       </span>
       <span class="ltx_text ltx_font_smallcaps" id="A6.T4.15.15.15.3.2">
        0.011
       </span>
      </td>
     </tr>
     <tr class="ltx_tr" id="A6.T4.18.18.18">
      <td class="ltx_td ltx_align_left ltx_border_r" id="A6.T4.18.18.18.4">
       <span class="ltx_text ltx_font_smallcaps" id="A6.T4.18.18.18.4.1">
        Balance Scale
       </span>
      </td>
      <td class="ltx_td ltx_align_center ltx_border_r" id="A6.T4.16.16.16.1">
       <span class="ltx_text ltx_font_smallcaps" id="A6.T4.16.16.16.1.1">
        0.8966
       </span>
       <math alttext="\pm" class="ltx_Math" display="inline" id="A6.T4.16.16.16.1.m1.1">
        <semantics id="A6.T4.16.16.16.1.m1.1a">
         <mo id="A6.T4.16.16.16.1.m1.1.1" xref="A6.T4.16.16.16.1.m1.1.1.cmml">
          ±
         </mo>
         <annotation-xml encoding="MathML-Content" id="A6.T4.16.16.16.1.m1.1b">
          <csymbol cd="latexml" id="A6.T4.16.16.16.1.m1.1.1.cmml" xref="A6.T4.16.16.16.1.m1.1.1">
           plus-or-minus
          </csymbol>
         </annotation-xml>
         <annotation encoding="application/x-tex" id="A6.T4.16.16.16.1.m1.1c">
          \pm
         </annotation>
        </semantics>
       </math>
       <span class="ltx_text ltx_font_smallcaps" id="A6.T4.16.16.16.1.2">
        0.066
       </span>
      </td>
      <td class="ltx_td ltx_align_center ltx_border_r" id="A6.T4.17.17.17.2">
       <span class="ltx_text ltx_font_smallcaps" id="A6.T4.17.17.17.2.1">
        0.9020
       </span>
       <math alttext="\pm" class="ltx_Math" display="inline" id="A6.T4.17.17.17.2.m1.1">
        <semantics id="A6.T4.17.17.17.2.m1.1a">
         <mo id="A6.T4.17.17.17.2.m1.1.1" xref="A6.T4.17.17.17.2.m1.1.1.cmml">
          ±
         </mo>
         <annotation-xml encoding="MathML-Content" id="A6.T4.17.17.17.2.m1.1b">
          <csymbol cd="latexml" id="A6.T4.17.17.17.2.m1.1.1.cmml" xref="A6.T4.17.17.17.2.m1.1.1">
           plus-or-minus
          </csymbol>
         </annotation-xml>
         <annotation encoding="application/x-tex" id="A6.T4.17.17.17.2.m1.1c">
          \pm
         </annotation>
        </semantics>
       </math>
       <span class="ltx_text ltx_font_smallcaps" id="A6.T4.17.17.17.2.2">
        0.043
       </span>
      </td>
      <td class="ltx_td ltx_align_center" id="A6.T4.18.18.18.3">
       <span class="ltx_text ltx_font_bold" id="A6.T4.18.18.18.3.1">
        0.9289
        <math alttext="\pm" class="ltx_Math" display="inline" id="A6.T4.18.18.18.3.1.m1.1">
         <semantics id="A6.T4.18.18.18.3.1.m1.1a">
          <mo id="A6.T4.18.18.18.3.1.m1.1.1" xref="A6.T4.18.18.18.3.1.m1.1.1.cmml">
           ±
          </mo>
          <annotation-xml encoding="MathML-Content" id="A6.T4.18.18.18.3.1.m1.1b">
           <csymbol cd="latexml" id="A6.T4.18.18.18.3.1.m1.1.1.cmml" xref="A6.T4.18.18.18.3.1.m1.1.1">
            plus-or-minus
           </csymbol>
          </annotation-xml>
          <annotation encoding="application/x-tex" id="A6.T4.18.18.18.3.1.m1.1c">
           \pm
          </annotation>
         </semantics>
        </math>
       </span>
       <span class="ltx_text ltx_font_smallcaps" id="A6.T4.18.18.18.3.2">
        0.038
       </span>
      </td>
     </tr>
     <tr class="ltx_tr" id="A6.T4.21.21.21">
      <td class="ltx_td ltx_align_left ltx_border_r" id="A6.T4.21.21.21.4">
       <span class="ltx_text ltx_font_smallcaps" id="A6.T4.21.21.21.4.1">
        Breast-w
       </span>
      </td>
      <td class="ltx_td ltx_align_center ltx_border_r" id="A6.T4.19.19.19.1">
       <span class="ltx_text ltx_font_bold" id="A6.T4.19.19.19.1.1">
        0.9948
        <math alttext="\pm" class="ltx_Math" display="inline" id="A6.T4.19.19.19.1.1.m1.1">
         <semantics id="A6.T4.19.19.19.1.1.m1.1a">
          <mo id="A6.T4.19.19.19.1.1.m1.1.1" xref="A6.T4.19.19.19.1.1.m1.1.1.cmml">
           ±
          </mo>
          <annotation-xml encoding="MathML-Content" id="A6.T4.19.19.19.1.1.m1.1b">
           <csymbol cd="latexml" id="A6.T4.19.19.19.1.1.m1.1.1.cmml" xref="A6.T4.19.19.19.1.1.m1.1.1">
            plus-or-minus
           </csymbol>
          </annotation-xml>
          <annotation encoding="application/x-tex" id="A6.T4.19.19.19.1.1.m1.1c">
           \pm
          </annotation>
         </semantics>
        </math>
       </span>
       <span class="ltx_text ltx_font_smallcaps" id="A6.T4.19.19.19.1.2">
        0.003
       </span>
      </td>
      <td class="ltx_td ltx_align_center ltx_border_r" id="A6.T4.20.20.20.2">
       <span class="ltx_text ltx_font_smallcaps" id="A6.T4.20.20.20.2.1">
        0.9941
       </span>
       <math alttext="\pm" class="ltx_Math" display="inline" id="A6.T4.20.20.20.2.m1.1">
        <semantics id="A6.T4.20.20.20.2.m1.1a">
         <mo id="A6.T4.20.20.20.2.m1.1.1" xref="A6.T4.20.20.20.2.m1.1.1.cmml">
          ±
         </mo>
         <annotation-xml encoding="MathML-Content" id="A6.T4.20.20.20.2.m1.1b">
          <csymbol cd="latexml" id="A6.T4.20.20.20.2.m1.1.1.cmml" xref="A6.T4.20.20.20.2.m1.1.1">
           plus-or-minus
          </csymbol>
         </annotation-xml>
         <annotation encoding="application/x-tex" id="A6.T4.20.20.20.2.m1.1c">
          \pm
         </annotation>
        </semantics>
       </math>
       <span class="ltx_text ltx_font_smallcaps" id="A6.T4.20.20.20.2.2">
        0.004
       </span>
      </td>
      <td class="ltx_td ltx_align_center" id="A6.T4.21.21.21.3">
       <span class="ltx_text ltx_font_bold" id="A6.T4.21.21.21.3.1">
        0.9948
        <math alttext="\pm" class="ltx_Math" display="inline" id="A6.T4.21.21.21.3.1.m1.1">
         <semantics id="A6.T4.21.21.21.3.1.m1.1a">
          <mo id="A6.T4.21.21.21.3.1.m1.1.1" xref="A6.T4.21.21.21.3.1.m1.1.1.cmml">
           ±
          </mo>
          <annotation-xml encoding="MathML-Content" id="A6.T4.21.21.21.3.1.m1.1b">
           <csymbol cd="latexml" id="A6.T4.21.21.21.3.1.m1.1.1.cmml" xref="A6.T4.21.21.21.3.1.m1.1.1">
            plus-or-minus
           </csymbol>
          </annotation-xml>
          <annotation encoding="application/x-tex" id="A6.T4.21.21.21.3.1.m1.1c">
           \pm
          </annotation>
         </semantics>
        </math>
       </span>
       <span class="ltx_text ltx_font_smallcaps" id="A6.T4.21.21.21.3.2">
        0.003
       </span>
      </td>
     </tr>
     <tr class="ltx_tr" id="A6.T4.24.24.24">
      <td class="ltx_td ltx_align_left ltx_border_r" id="A6.T4.24.24.24.4">
       <span class="ltx_text ltx_font_smallcaps" id="A6.T4.24.24.24.4.1">
        CMC
       </span>
      </td>
      <td class="ltx_td ltx_align_center ltx_border_r" id="A6.T4.22.22.22.1">
       <span class="ltx_text ltx_font_smallcaps" id="A6.T4.22.22.22.1.1">
        0.7278
       </span>
       <math alttext="\pm" class="ltx_Math" display="inline" id="A6.T4.22.22.22.1.m1.1">
        <semantics id="A6.T4.22.22.22.1.m1.1a">
         <mo id="A6.T4.22.22.22.1.m1.1.1" xref="A6.T4.22.22.22.1.m1.1.1.cmml">
          ±
         </mo>
         <annotation-xml encoding="MathML-Content" id="A6.T4.22.22.22.1.m1.1b">
          <csymbol cd="latexml" id="A6.T4.22.22.22.1.m1.1.1.cmml" xref="A6.T4.22.22.22.1.m1.1.1">
           plus-or-minus
          </csymbol>
         </annotation-xml>
         <annotation encoding="application/x-tex" id="A6.T4.22.22.22.1.m1.1c">
          \pm
         </annotation>
        </semantics>
       </math>
       <span class="ltx_text ltx_font_smallcaps" id="A6.T4.22.22.22.1.2">
        0.005
       </span>
      </td>
      <td class="ltx_td ltx_align_center ltx_border_r" id="A6.T4.23.23.23.2">
       <span class="ltx_text ltx_font_smallcaps" id="A6.T4.23.23.23.2.1">
        0.7296
       </span>
       <math alttext="\pm" class="ltx_Math" display="inline" id="A6.T4.23.23.23.2.m1.1">
        <semantics id="A6.T4.23.23.23.2.m1.1a">
         <mo id="A6.T4.23.23.23.2.m1.1.1" xref="A6.T4.23.23.23.2.m1.1.1.cmml">
          ±
         </mo>
         <annotation-xml encoding="MathML-Content" id="A6.T4.23.23.23.2.m1.1b">
          <csymbol cd="latexml" id="A6.T4.23.23.23.2.m1.1.1.cmml" xref="A6.T4.23.23.23.2.m1.1.1">
           plus-or-minus
          </csymbol>
         </annotation-xml>
         <annotation encoding="application/x-tex" id="A6.T4.23.23.23.2.m1.1c">
          \pm
         </annotation>
        </semantics>
       </math>
       <span class="ltx_text ltx_font_smallcaps" id="A6.T4.23.23.23.2.2">
        0.004
       </span>
      </td>
      <td class="ltx_td ltx_align_center" id="A6.T4.24.24.24.3">
       <span class="ltx_text ltx_font_bold" id="A6.T4.24.24.24.3.1">
        0.7306
        <math alttext="\pm" class="ltx_Math" display="inline" id="A6.T4.24.24.24.3.1.m1.1">
         <semantics id="A6.T4.24.24.24.3.1.m1.1a">
          <mo id="A6.T4.24.24.24.3.1.m1.1.1" xref="A6.T4.24.24.24.3.1.m1.1.1.cmml">
           ±
          </mo>
          <annotation-xml encoding="MathML-Content" id="A6.T4.24.24.24.3.1.m1.1b">
           <csymbol cd="latexml" id="A6.T4.24.24.24.3.1.m1.1.1.cmml" xref="A6.T4.24.24.24.3.1.m1.1.1">
            plus-or-minus
           </csymbol>
          </annotation-xml>
          <annotation encoding="application/x-tex" id="A6.T4.24.24.24.3.1.m1.1c">
           \pm
          </annotation>
         </semantics>
        </math>
       </span>
       <span class="ltx_text ltx_font_smallcaps" id="A6.T4.24.24.24.3.2">
        0.003
       </span>
      </td>
     </tr>
     <tr class="ltx_tr" id="A6.T4.27.27.27">
      <td class="ltx_td ltx_align_left ltx_border_r" id="A6.T4.27.27.27.4">
       <span class="ltx_text ltx_font_smallcaps" id="A6.T4.27.27.27.4.1">
        Credit-g
       </span>
      </td>
      <td class="ltx_td ltx_align_center ltx_border_r" id="A6.T4.25.25.25.1">
       <span class="ltx_text ltx_font_smallcaps" id="A6.T4.25.25.25.1.1">
        0.7850
       </span>
       <math alttext="\pm" class="ltx_Math" display="inline" id="A6.T4.25.25.25.1.m1.1">
        <semantics id="A6.T4.25.25.25.1.m1.1a">
         <mo id="A6.T4.25.25.25.1.m1.1.1" xref="A6.T4.25.25.25.1.m1.1.1.cmml">
          ±
         </mo>
         <annotation-xml encoding="MathML-Content" id="A6.T4.25.25.25.1.m1.1b">
          <csymbol cd="latexml" id="A6.T4.25.25.25.1.m1.1.1.cmml" xref="A6.T4.25.25.25.1.m1.1.1">
           plus-or-minus
          </csymbol>
         </annotation-xml>
         <annotation encoding="application/x-tex" id="A6.T4.25.25.25.1.m1.1c">
          \pm
         </annotation>
        </semantics>
       </math>
       <span class="ltx_text ltx_font_smallcaps" id="A6.T4.25.25.25.1.2">
        0.025
       </span>
      </td>
      <td class="ltx_td ltx_align_center ltx_border_r" id="A6.T4.26.26.26.2">
       <span class="ltx_text ltx_font_smallcaps" id="A6.T4.26.26.26.2.1">
        0.7868
       </span>
       <math alttext="\pm" class="ltx_Math" display="inline" id="A6.T4.26.26.26.2.m1.1">
        <semantics id="A6.T4.26.26.26.2.m1.1a">
         <mo id="A6.T4.26.26.26.2.m1.1.1" xref="A6.T4.26.26.26.2.m1.1.1.cmml">
          ±
         </mo>
         <annotation-xml encoding="MathML-Content" id="A6.T4.26.26.26.2.m1.1b">
          <csymbol cd="latexml" id="A6.T4.26.26.26.2.m1.1.1.cmml" xref="A6.T4.26.26.26.2.m1.1.1">
           plus-or-minus
          </csymbol>
         </annotation-xml>
         <annotation encoding="application/x-tex" id="A6.T4.26.26.26.2.m1.1c">
          \pm
         </annotation>
        </semantics>
       </math>
       <span class="ltx_text ltx_font_smallcaps" id="A6.T4.26.26.26.2.2">
        0.024
       </span>
      </td>
      <td class="ltx_td ltx_align_center" id="A6.T4.27.27.27.3">
       <span class="ltx_text ltx_font_bold" id="A6.T4.27.27.27.3.1">
        0.7875
        <math alttext="\pm" class="ltx_Math" display="inline" id="A6.T4.27.27.27.3.1.m1.1">
         <semantics id="A6.T4.27.27.27.3.1.m1.1a">
          <mo id="A6.T4.27.27.27.3.1.m1.1.1" xref="A6.T4.27.27.27.3.1.m1.1.1.cmml">
           ±
          </mo>
          <annotation-xml encoding="MathML-Content" id="A6.T4.27.27.27.3.1.m1.1b">
           <csymbol cd="latexml" id="A6.T4.27.27.27.3.1.m1.1.1.cmml" xref="A6.T4.27.27.27.3.1.m1.1.1">
            plus-or-minus
           </csymbol>
          </annotation-xml>
          <annotation encoding="application/x-tex" id="A6.T4.27.27.27.3.1.m1.1c">
           \pm
          </annotation>
         </semantics>
        </math>
       </span>
       <span class="ltx_text ltx_font_smallcaps" id="A6.T4.27.27.27.3.2">
        0.023
       </span>
      </td>
     </tr>
     <tr class="ltx_tr" id="A6.T4.30.30.30">
      <td class="ltx_td ltx_align_left ltx_border_r" id="A6.T4.30.30.30.4">
       <span class="ltx_text ltx_font_smallcaps" id="A6.T4.30.30.30.4.1">
        Diabetes
       </span>
      </td>
      <td class="ltx_td ltx_align_center ltx_border_r" id="A6.T4.28.28.28.1">
       <span class="ltx_text ltx_font_smallcaps" id="A6.T4.28.28.28.1.1">
        0.8327
       </span>
       <math alttext="\pm" class="ltx_Math" display="inline" id="A6.T4.28.28.28.1.m1.1">
        <semantics id="A6.T4.28.28.28.1.m1.1a">
         <mo id="A6.T4.28.28.28.1.m1.1.1" xref="A6.T4.28.28.28.1.m1.1.1.cmml">
          ±
         </mo>
         <annotation-xml encoding="MathML-Content" id="A6.T4.28.28.28.1.m1.1b">
          <csymbol cd="latexml" id="A6.T4.28.28.28.1.m1.1.1.cmml" xref="A6.T4.28.28.28.1.m1.1.1">
           plus-or-minus
          </csymbol>
         </annotation-xml>
         <annotation encoding="application/x-tex" id="A6.T4.28.28.28.1.m1.1c">
          \pm
         </annotation>
        </semantics>
       </math>
       <span class="ltx_text ltx_font_smallcaps" id="A6.T4.28.28.28.1.2">
        0.009
       </span>
      </td>
      <td class="ltx_td ltx_align_center ltx_border_r" id="A6.T4.29.29.29.2">
       <span class="ltx_text ltx_font_smallcaps" id="A6.T4.29.29.29.2.1">
        0.8327
       </span>
       <math alttext="\pm" class="ltx_Math" display="inline" id="A6.T4.29.29.29.2.m1.1">
        <semantics id="A6.T4.29.29.29.2.m1.1a">
         <mo id="A6.T4.29.29.29.2.m1.1.1" xref="A6.T4.29.29.29.2.m1.1.1.cmml">
          ±
         </mo>
         <annotation-xml encoding="MathML-Content" id="A6.T4.29.29.29.2.m1.1b">
          <csymbol cd="latexml" id="A6.T4.29.29.29.2.m1.1.1.cmml" xref="A6.T4.29.29.29.2.m1.1.1">
           plus-or-minus
          </csymbol>
         </annotation-xml>
         <annotation encoding="application/x-tex" id="A6.T4.29.29.29.2.m1.1c">
          \pm
         </annotation>
        </semantics>
       </math>
       <span class="ltx_text ltx_font_smallcaps" id="A6.T4.29.29.29.2.2">
        0.009
       </span>
      </td>
      <td class="ltx_td ltx_align_center" id="A6.T4.30.30.30.3">
       <span class="ltx_text ltx_font_bold" id="A6.T4.30.30.30.3.1">
        0.8329
        <math alttext="\pm" class="ltx_Math" display="inline" id="A6.T4.30.30.30.3.1.m1.1">
         <semantics id="A6.T4.30.30.30.3.1.m1.1a">
          <mo id="A6.T4.30.30.30.3.1.m1.1.1" xref="A6.T4.30.30.30.3.1.m1.1.1.cmml">
           ±
          </mo>
          <annotation-xml encoding="MathML-Content" id="A6.T4.30.30.30.3.1.m1.1b">
           <csymbol cd="latexml" id="A6.T4.30.30.30.3.1.m1.1.1.cmml" xref="A6.T4.30.30.30.3.1.m1.1.1">
            plus-or-minus
           </csymbol>
          </annotation-xml>
          <annotation encoding="application/x-tex" id="A6.T4.30.30.30.3.1.m1.1c">
           \pm
          </annotation>
         </semantics>
        </math>
       </span>
       <span class="ltx_text ltx_font_smallcaps" id="A6.T4.30.30.30.3.2">
        0.008
       </span>
      </td>
     </tr>
     <tr class="ltx_tr" id="A6.T4.33.33.33">
      <td class="ltx_td ltx_align_left ltx_border_r" id="A6.T4.33.33.33.4">
       <span class="ltx_text ltx_font_smallcaps" id="A6.T4.33.33.33.4.1">
        Eucalyptus
       </span>
      </td>
      <td class="ltx_td ltx_align_center ltx_border_r" id="A6.T4.31.31.31.1">
       <span class="ltx_text ltx_font_smallcaps" id="A6.T4.31.31.31.1.1">
        0.8961
       </span>
       <math alttext="\pm" class="ltx_Math" display="inline" id="A6.T4.31.31.31.1.m1.1">
        <semantics id="A6.T4.31.31.31.1.m1.1a">
         <mo id="A6.T4.31.31.31.1.m1.1.1" xref="A6.T4.31.31.31.1.m1.1.1.cmml">
          ±
         </mo>
         <annotation-xml encoding="MathML-Content" id="A6.T4.31.31.31.1.m1.1b">
          <csymbol cd="latexml" id="A6.T4.31.31.31.1.m1.1.1.cmml" xref="A6.T4.31.31.31.1.m1.1.1">
           plus-or-minus
          </csymbol>
         </annotation-xml>
         <annotation encoding="application/x-tex" id="A6.T4.31.31.31.1.m1.1c">
          \pm
         </annotation>
        </semantics>
       </math>
       <span class="ltx_text ltx_font_smallcaps" id="A6.T4.31.31.31.1.2">
        0.004
       </span>
      </td>
      <td class="ltx_td ltx_align_center ltx_border_r" id="A6.T4.32.32.32.2">
       <span class="ltx_text ltx_font_smallcaps" id="A6.T4.32.32.32.2.1">
        0.8961
       </span>
       <math alttext="\pm" class="ltx_Math" display="inline" id="A6.T4.32.32.32.2.m1.1">
        <semantics id="A6.T4.32.32.32.2.m1.1a">
         <mo id="A6.T4.32.32.32.2.m1.1.1" xref="A6.T4.32.32.32.2.m1.1.1.cmml">
          ±
         </mo>
         <annotation-xml encoding="MathML-Content" id="A6.T4.32.32.32.2.m1.1b">
          <csymbol cd="latexml" id="A6.T4.32.32.32.2.m1.1.1.cmml" xref="A6.T4.32.32.32.2.m1.1.1">
           plus-or-minus
          </csymbol>
         </annotation-xml>
         <annotation encoding="application/x-tex" id="A6.T4.32.32.32.2.m1.1c">
          \pm
         </annotation>
        </semantics>
       </math>
       <span class="ltx_text ltx_font_smallcaps" id="A6.T4.32.32.32.2.2">
        0.004
       </span>
      </td>
      <td class="ltx_td ltx_align_center" id="A6.T4.33.33.33.3">
       <span class="ltx_text ltx_font_bold" id="A6.T4.33.33.33.3.1">
        0.8973
        <math alttext="\pm" class="ltx_Math" display="inline" id="A6.T4.33.33.33.3.1.m1.1">
         <semantics id="A6.T4.33.33.33.3.1.m1.1a">
          <mo id="A6.T4.33.33.33.3.1.m1.1.1" xref="A6.T4.33.33.33.3.1.m1.1.1.cmml">
           ±
          </mo>
          <annotation-xml encoding="MathML-Content" id="A6.T4.33.33.33.3.1.m1.1b">
           <csymbol cd="latexml" id="A6.T4.33.33.33.3.1.m1.1.1.cmml" xref="A6.T4.33.33.33.3.1.m1.1.1">
            plus-or-minus
           </csymbol>
          </annotation-xml>
          <annotation encoding="application/x-tex" id="A6.T4.33.33.33.3.1.m1.1c">
           \pm
          </annotation>
         </semantics>
        </math>
       </span>
       <span class="ltx_text ltx_font_smallcaps" id="A6.T4.33.33.33.3.2">
        0.006
       </span>
      </td>
     </tr>
     <tr class="ltx_tr" id="A6.T4.36.36.36">
      <td class="ltx_td ltx_align_left ltx_border_r" id="A6.T4.36.36.36.4">
       <span class="ltx_text ltx_font_smallcaps" id="A6.T4.36.36.36.4.1">
        Jungle Chess
       </span>
      </td>
      <td class="ltx_td ltx_align_center ltx_border_r" id="A6.T4.34.34.34.1">
       <span class="ltx_text ltx_font_smallcaps" id="A6.T4.34.34.34.1.1">
        0.9100
       </span>
       <math alttext="\pm" class="ltx_Math" display="inline" id="A6.T4.34.34.34.1.m1.1">
        <semantics id="A6.T4.34.34.34.1.m1.1a">
         <mo id="A6.T4.34.34.34.1.m1.1.1" xref="A6.T4.34.34.34.1.m1.1.1.cmml">
          ±
         </mo>
         <annotation-xml encoding="MathML-Content" id="A6.T4.34.34.34.1.m1.1b">
          <csymbol cd="latexml" id="A6.T4.34.34.34.1.m1.1.1.cmml" xref="A6.T4.34.34.34.1.m1.1.1">
           plus-or-minus
          </csymbol>
         </annotation-xml>
         <annotation encoding="application/x-tex" id="A6.T4.34.34.34.1.m1.1c">
          \pm
         </annotation>
        </semantics>
       </math>
       <span class="ltx_text ltx_font_smallcaps" id="A6.T4.34.34.34.1.2">
        0.005
       </span>
      </td>
      <td class="ltx_td ltx_align_center ltx_border_r" id="A6.T4.35.35.35.2">
       <span class="ltx_text ltx_font_smallcaps" id="A6.T4.35.35.35.2.1">
        0.9108
       </span>
       <math alttext="\pm" class="ltx_Math" display="inline" id="A6.T4.35.35.35.2.m1.1">
        <semantics id="A6.T4.35.35.35.2.m1.1a">
         <mo id="A6.T4.35.35.35.2.m1.1.1" xref="A6.T4.35.35.35.2.m1.1.1.cmml">
          ±
         </mo>
         <annotation-xml encoding="MathML-Content" id="A6.T4.35.35.35.2.m1.1b">
          <csymbol cd="latexml" id="A6.T4.35.35.35.2.m1.1.1.cmml" xref="A6.T4.35.35.35.2.m1.1.1">
           plus-or-minus
          </csymbol>
         </annotation-xml>
         <annotation encoding="application/x-tex" id="A6.T4.35.35.35.2.m1.1c">
          \pm
         </annotation>
        </semantics>
       </math>
       <span class="ltx_text ltx_font_smallcaps" id="A6.T4.35.35.35.2.2">
        0.006
       </span>
      </td>
      <td class="ltx_td ltx_align_center" id="A6.T4.36.36.36.3">
       <span class="ltx_text ltx_font_bold" id="A6.T4.36.36.36.3.1">
        0.9216
        <math alttext="\pm" class="ltx_Math" display="inline" id="A6.T4.36.36.36.3.1.m1.1">
         <semantics id="A6.T4.36.36.36.3.1.m1.1a">
          <mo id="A6.T4.36.36.36.3.1.m1.1.1" xref="A6.T4.36.36.36.3.1.m1.1.1.cmml">
           ±
          </mo>
          <annotation-xml encoding="MathML-Content" id="A6.T4.36.36.36.3.1.m1.1b">
           <csymbol cd="latexml" id="A6.T4.36.36.36.3.1.m1.1.1.cmml" xref="A6.T4.36.36.36.3.1.m1.1.1">
            plus-or-minus
           </csymbol>
          </annotation-xml>
          <annotation encoding="application/x-tex" id="A6.T4.36.36.36.3.1.m1.1c">
           \pm
          </annotation>
         </semantics>
        </math>
       </span>
       <span class="ltx_text ltx_font_smallcaps" id="A6.T4.36.36.36.3.2">
        0.007
       </span>
      </td>
     </tr>
     <tr class="ltx_tr" id="A6.T4.39.39.39">
      <td class="ltx_td ltx_align_left ltx_border_r" id="A6.T4.39.39.39.4">
       <span class="ltx_text ltx_font_smallcaps" id="A6.T4.39.39.39.4.1">
        PC1
       </span>
      </td>
      <td class="ltx_td ltx_align_center ltx_border_r" id="A6.T4.37.37.37.1">
       <span class="ltx_text ltx_font_smallcaps" id="A6.T4.37.37.37.1.1">
        0.8470
       </span>
       <math alttext="\pm" class="ltx_Math" display="inline" id="A6.T4.37.37.37.1.m1.1">
        <semantics id="A6.T4.37.37.37.1.m1.1a">
         <mo id="A6.T4.37.37.37.1.m1.1.1" xref="A6.T4.37.37.37.1.m1.1.1.cmml">
          ±
         </mo>
         <annotation-xml encoding="MathML-Content" id="A6.T4.37.37.37.1.m1.1b">
          <csymbol cd="latexml" id="A6.T4.37.37.37.1.m1.1.1.cmml" xref="A6.T4.37.37.37.1.m1.1.1">
           plus-or-minus
          </csymbol>
         </annotation-xml>
         <annotation encoding="application/x-tex" id="A6.T4.37.37.37.1.m1.1c">
          \pm
         </annotation>
        </semantics>
       </math>
       <span class="ltx_text ltx_font_smallcaps" id="A6.T4.37.37.37.1.2">
        0.021
       </span>
      </td>
      <td class="ltx_td ltx_align_center ltx_border_r" id="A6.T4.38.38.38.2">
       <span class="ltx_text ltx_font_smallcaps" id="A6.T4.38.38.38.2.1">
        0.8468
       </span>
       <math alttext="\pm" class="ltx_Math" display="inline" id="A6.T4.38.38.38.2.m1.1">
        <semantics id="A6.T4.38.38.38.2.m1.1a">
         <mo id="A6.T4.38.38.38.2.m1.1.1" xref="A6.T4.38.38.38.2.m1.1.1.cmml">
          ±
         </mo>
         <annotation-xml encoding="MathML-Content" id="A6.T4.38.38.38.2.m1.1b">
          <csymbol cd="latexml" id="A6.T4.38.38.38.2.m1.1.1.cmml" xref="A6.T4.38.38.38.2.m1.1.1">
           plus-or-minus
          </csymbol>
         </annotation-xml>
         <annotation encoding="application/x-tex" id="A6.T4.38.38.38.2.m1.1c">
          \pm
         </annotation>
        </semantics>
       </math>
       <span class="ltx_text ltx_font_smallcaps" id="A6.T4.38.38.38.2.2">
        0.020
       </span>
      </td>
      <td class="ltx_td ltx_align_center" id="A6.T4.39.39.39.3">
       <span class="ltx_text ltx_font_bold" id="A6.T4.39.39.39.3.1">
        0.8492
        <math alttext="\pm" class="ltx_Math" display="inline" id="A6.T4.39.39.39.3.1.m1.1">
         <semantics id="A6.T4.39.39.39.3.1.m1.1a">
          <mo id="A6.T4.39.39.39.3.1.m1.1.1" xref="A6.T4.39.39.39.3.1.m1.1.1.cmml">
           ±
          </mo>
          <annotation-xml encoding="MathML-Content" id="A6.T4.39.39.39.3.1.m1.1b">
           <csymbol cd="latexml" id="A6.T4.39.39.39.3.1.m1.1.1.cmml" xref="A6.T4.39.39.39.3.1.m1.1.1">
            plus-or-minus
           </csymbol>
          </annotation-xml>
          <annotation encoding="application/x-tex" id="A6.T4.39.39.39.3.1.m1.1c">
           \pm
          </annotation>
         </semantics>
        </math>
       </span>
       <span class="ltx_text ltx_font_smallcaps" id="A6.T4.39.39.39.3.2">
        0.016
       </span>
      </td>
     </tr>
     <tr class="ltx_tr" id="A6.T4.42.42.42">
      <td class="ltx_td ltx_align_left ltx_border_r" id="A6.T4.42.42.42.4">
       <span class="ltx_text ltx_font_smallcaps" id="A6.T4.42.42.42.4.1">
        Tic-Tac-Toe
       </span>
      </td>
      <td class="ltx_td ltx_align_center ltx_border_r" id="A6.T4.40.40.40.1">
       <span class="ltx_text ltx_font_smallcaps" id="A6.T4.40.40.40.1.1">
        0.7334
       </span>
       <math alttext="\pm" class="ltx_Math" display="inline" id="A6.T4.40.40.40.1.m1.1">
        <semantics id="A6.T4.40.40.40.1.m1.1a">
         <mo id="A6.T4.40.40.40.1.m1.1.1" xref="A6.T4.40.40.40.1.m1.1.1.cmml">
          ±
         </mo>
         <annotation-xml encoding="MathML-Content" id="A6.T4.40.40.40.1.m1.1b">
          <csymbol cd="latexml" id="A6.T4.40.40.40.1.m1.1.1.cmml" xref="A6.T4.40.40.40.1.m1.1.1">
           plus-or-minus
          </csymbol>
         </annotation-xml>
         <annotation encoding="application/x-tex" id="A6.T4.40.40.40.1.m1.1c">
          \pm
         </annotation>
        </semantics>
       </math>
       <span class="ltx_text ltx_font_smallcaps" id="A6.T4.40.40.40.1.2">
        0.033
       </span>
      </td>
      <td class="ltx_td ltx_align_center ltx_border_r" id="A6.T4.41.41.41.2">
       <span class="ltx_text ltx_font_smallcaps" id="A6.T4.41.41.41.2.1">
        0.7314
       </span>
       <math alttext="\pm" class="ltx_Math" display="inline" id="A6.T4.41.41.41.2.m1.1">
        <semantics id="A6.T4.41.41.41.2.m1.1a">
         <mo id="A6.T4.41.41.41.2.m1.1.1" xref="A6.T4.41.41.41.2.m1.1.1.cmml">
          ±
         </mo>
         <annotation-xml encoding="MathML-Content" id="A6.T4.41.41.41.2.m1.1b">
          <csymbol cd="latexml" id="A6.T4.41.41.41.2.m1.1.1.cmml" xref="A6.T4.41.41.41.2.m1.1.1">
           plus-or-minus
          </csymbol>
         </annotation-xml>
         <annotation encoding="application/x-tex" id="A6.T4.41.41.41.2.m1.1c">
          \pm
         </annotation>
        </semantics>
       </math>
       <span class="ltx_text ltx_font_smallcaps" id="A6.T4.41.41.41.2.2">
        0.060
       </span>
      </td>
      <td class="ltx_td ltx_align_center" id="A6.T4.42.42.42.3">
       <span class="ltx_text ltx_font_bold" id="A6.T4.42.42.42.3.1">
        0.7483
        <math alttext="\pm" class="ltx_Math" display="inline" id="A6.T4.42.42.42.3.1.m1.1">
         <semantics id="A6.T4.42.42.42.3.1.m1.1a">
          <mo id="A6.T4.42.42.42.3.1.m1.1.1" xref="A6.T4.42.42.42.3.1.m1.1.1.cmml">
           ±
          </mo>
          <annotation-xml encoding="MathML-Content" id="A6.T4.42.42.42.3.1.m1.1b">
           <csymbol cd="latexml" id="A6.T4.42.42.42.3.1.m1.1.1.cmml" xref="A6.T4.42.42.42.3.1.m1.1.1">
            plus-or-minus
           </csymbol>
          </annotation-xml>
          <annotation encoding="application/x-tex" id="A6.T4.42.42.42.3.1.m1.1c">
           \pm
          </annotation>
         </semantics>
        </math>
       </span>
       <span class="ltx_text ltx_font_smallcaps" id="A6.T4.42.42.42.3.2">
        0.032
       </span>
      </td>
     </tr>
     <tr class="ltx_tr" id="A6.T4.45.45.45">
      <td class="ltx_td ltx_align_left ltx_border_bb ltx_border_r ltx_border_t" id="A6.T4.45.45.45.4">
       <span class="ltx_text ltx_font_smallcaps" id="A6.T4.45.45.45.4.1">
        Average
       </span>
      </td>
      <td class="ltx_td ltx_align_center ltx_border_bb ltx_border_r ltx_border_t" id="A6.T4.43.43.43.1">
       <span class="ltx_text ltx_font_smallcaps" id="A6.T4.43.43.43.1.1">
        0.8015
       </span>
       <math alttext="\pm" class="ltx_Math" display="inline" id="A6.T4.43.43.43.1.m1.1">
        <semantics id="A6.T4.43.43.43.1.m1.1a">
         <mo id="A6.T4.43.43.43.1.m1.1.1" xref="A6.T4.43.43.43.1.m1.1.1.cmml">
          ±
         </mo>
         <annotation-xml encoding="MathML-Content" id="A6.T4.43.43.43.1.m1.1b">
          <csymbol cd="latexml" id="A6.T4.43.43.43.1.m1.1.1.cmml" xref="A6.T4.43.43.43.1.m1.1.1">
           plus-or-minus
          </csymbol>
         </annotation-xml>
         <annotation encoding="application/x-tex" id="A6.T4.43.43.43.1.m1.1c">
          \pm
         </annotation>
        </semantics>
       </math>
       <span class="ltx_text ltx_font_smallcaps" id="A6.T4.43.43.43.1.2">
        0.016
       </span>
      </td>
      <td class="ltx_td ltx_align_center ltx_border_bb ltx_border_r ltx_border_t" id="A6.T4.44.44.44.2">
       <span class="ltx_text ltx_font_smallcaps" id="A6.T4.44.44.44.2.1">
        0.8037
       </span>
       <math alttext="\pm" class="ltx_Math" display="inline" id="A6.T4.44.44.44.2.m1.1">
        <semantics id="A6.T4.44.44.44.2.m1.1a">
         <mo id="A6.T4.44.44.44.2.m1.1.1" xref="A6.T4.44.44.44.2.m1.1.1.cmml">
          ±
         </mo>
         <annotation-xml encoding="MathML-Content" id="A6.T4.44.44.44.2.m1.1b">
          <csymbol cd="latexml" id="A6.T4.44.44.44.2.m1.1.1.cmml" xref="A6.T4.44.44.44.2.m1.1.1">
           plus-or-minus
          </csymbol>
         </annotation-xml>
         <annotation encoding="application/x-tex" id="A6.T4.44.44.44.2.m1.1c">
          \pm
         </annotation>
        </semantics>
       </math>
       <span class="ltx_text ltx_font_smallcaps" id="A6.T4.44.44.44.2.2">
        0.017
       </span>
      </td>
      <td class="ltx_td ltx_align_center ltx_border_bb ltx_border_t" id="A6.T4.45.45.45.3">
       <span class="ltx_text ltx_font_bold" id="A6.T4.45.45.45.3.1">
        0.8090
        <math alttext="\pm" class="ltx_Math" display="inline" id="A6.T4.45.45.45.3.1.m1.1">
         <semantics id="A6.T4.45.45.45.3.1.m1.1a">
          <mo id="A6.T4.45.45.45.3.1.m1.1.1" xref="A6.T4.45.45.45.3.1.m1.1.1.cmml">
           ±
          </mo>
          <annotation-xml encoding="MathML-Content" id="A6.T4.45.45.45.3.1.m1.1b">
           <csymbol cd="latexml" id="A6.T4.45.45.45.3.1.m1.1.1.cmml" xref="A6.T4.45.45.45.3.1.m1.1.1">
            plus-or-minus
           </csymbol>
          </annotation-xml>
          <annotation encoding="application/x-tex" id="A6.T4.45.45.45.3.1.m1.1c">
           \pm
          </annotation>
         </semantics>
        </math>
       </span>
       <span class="ltx_text ltx_font_smallcaps" id="A6.T4.45.45.45.3.2">
        0.013
       </span>
      </td>
     </tr>
    </tbody>
   </table>
  </figure>
  <figure class="ltx_table" id="A6.T5">
   <figcaption class="ltx_caption">
    <span class="ltx_tag ltx_tag_table">
     Table 5:
    </span>
    Performance comparison between ETPO and CAAFE. CAAFE is the current sota in these datasets that integrates expert-designed models and feature engineering enhanced by GPT-4. From this table, we can notice that ETPO trains a 7B model achieving comparable performance with CAAFE on more than half of tasks
   </figcaption>
   <table class="ltx_tabular ltx_centering ltx_align_middle" id="A6.T5.28.28">
    <tbody class="ltx_tbody">
     <tr class="ltx_tr" id="A6.T5.28.28.29.1">
      <td class="ltx_td ltx_align_left ltx_border_r ltx_border_tt" id="A6.T5.28.28.29.1.1">
       <span class="ltx_text ltx_font_smallcaps" id="A6.T5.28.28.29.1.1.1">
        Data set
       </span>
      </td>
      <td class="ltx_td ltx_align_center ltx_border_r ltx_border_tt" id="A6.T5.28.28.29.1.2">
       <span class="ltx_text ltx_font_smallcaps" id="A6.T5.28.28.29.1.2.1">
        CAAFE(GPT-4)
       </span>
      </td>
      <td class="ltx_td ltx_align_center ltx_border_tt" id="A6.T5.28.28.29.1.3">
       <span class="ltx_text ltx_font_smallcaps" id="A6.T5.28.28.29.1.3.1">
        ETPO(CodeLlama-7B)
       </span>
      </td>
     </tr>
     <tr class="ltx_tr" id="A6.T5.2.2.2">
      <td class="ltx_td ltx_align_left ltx_border_r ltx_border_t" id="A6.T5.2.2.2.3">
       <span class="ltx_text ltx_font_smallcaps" id="A6.T5.2.2.2.3.1">
        Pharyngitis ⟨
       </span>
       <span class="ltx_text ltx_font_italic" id="A6.T5.2.2.2.3.2">
        K
       </span>
       <span class="ltx_text ltx_font_smallcaps" id="A6.T5.2.2.2.3.3">
        ⟩
       </span>
      </td>
      <td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="A6.T5.1.1.1.1">
       <span class="ltx_text ltx_font_smallcaps" id="A6.T5.1.1.1.1.1">
        0.7078
       </span>
       <math alttext="\pm" class="ltx_Math" display="inline" id="A6.T5.1.1.1.1.m1.1">
        <semantics id="A6.T5.1.1.1.1.m1.1a">
         <mo id="A6.T5.1.1.1.1.m1.1.1" xref="A6.T5.1.1.1.1.m1.1.1.cmml">
          ±
         </mo>
         <annotation-xml encoding="MathML-Content" id="A6.T5.1.1.1.1.m1.1b">
          <csymbol cd="latexml" id="A6.T5.1.1.1.1.m1.1.1.cmml" xref="A6.T5.1.1.1.1.m1.1.1">
           plus-or-minus
          </csymbol>
         </annotation-xml>
         <annotation encoding="application/x-tex" id="A6.T5.1.1.1.1.m1.1c">
          \pm
         </annotation>
        </semantics>
       </math>
       <span class="ltx_text ltx_font_smallcaps" id="A6.T5.1.1.1.1.2">
        0.040
       </span>
      </td>
      <td class="ltx_td ltx_align_center ltx_border_t" id="A6.T5.2.2.2.2">
       <span class="ltx_text ltx_font_bold" id="A6.T5.2.2.2.2.1">
        0.7317
        <math alttext="\pm" class="ltx_Math" display="inline" id="A6.T5.2.2.2.2.1.m1.1">
         <semantics id="A6.T5.2.2.2.2.1.m1.1a">
          <mo id="A6.T5.2.2.2.2.1.m1.1.1" xref="A6.T5.2.2.2.2.1.m1.1.1.cmml">
           ±
          </mo>
          <annotation-xml encoding="MathML-Content" id="A6.T5.2.2.2.2.1.m1.1b">
           <csymbol cd="latexml" id="A6.T5.2.2.2.2.1.m1.1.1.cmml" xref="A6.T5.2.2.2.2.1.m1.1.1">
            plus-or-minus
           </csymbol>
          </annotation-xml>
          <annotation encoding="application/x-tex" id="A6.T5.2.2.2.2.1.m1.1c">
           \pm
          </annotation>
         </semantics>
        </math>
       </span>
       <span class="ltx_text ltx_font_smallcaps" id="A6.T5.2.2.2.2.2">
        0.006
       </span>
      </td>
     </tr>
     <tr class="ltx_tr" id="A6.T5.4.4.4">
      <td class="ltx_td ltx_align_left ltx_border_r" id="A6.T5.4.4.4.3">
       <span class="ltx_text ltx_font_smallcaps" id="A6.T5.4.4.4.3.1">
        Kidney Stone ⟨
       </span>
       <span class="ltx_text ltx_font_italic" id="A6.T5.4.4.4.3.2">
        K
       </span>
       <span class="ltx_text ltx_font_smallcaps" id="A6.T5.4.4.4.3.3">
        ⟩
       </span>
      </td>
      <td class="ltx_td ltx_align_center ltx_border_r" id="A6.T5.3.3.3.1">
       <span class="ltx_text ltx_font_bold" id="A6.T5.3.3.3.1.1">
        0.7903
        <math alttext="\pm" class="ltx_Math" display="inline" id="A6.T5.3.3.3.1.1.m1.1">
         <semantics id="A6.T5.3.3.3.1.1.m1.1a">
          <mo id="A6.T5.3.3.3.1.1.m1.1.1" xref="A6.T5.3.3.3.1.1.m1.1.1.cmml">
           ±
          </mo>
          <annotation-xml encoding="MathML-Content" id="A6.T5.3.3.3.1.1.m1.1b">
           <csymbol cd="latexml" id="A6.T5.3.3.3.1.1.m1.1.1.cmml" xref="A6.T5.3.3.3.1.1.m1.1.1">
            plus-or-minus
           </csymbol>
          </annotation-xml>
          <annotation encoding="application/x-tex" id="A6.T5.3.3.3.1.1.m1.1c">
           \pm
          </annotation>
         </semantics>
        </math>
       </span>
       <span class="ltx_text ltx_font_smallcaps" id="A6.T5.3.3.3.1.2">
        0.040
       </span>
      </td>
      <td class="ltx_td ltx_align_center" id="A6.T5.4.4.4.2">
       <span class="ltx_text ltx_font_smallcaps" id="A6.T5.4.4.4.2.1">
        0.7881
       </span>
       <math alttext="\pm" class="ltx_Math" display="inline" id="A6.T5.4.4.4.2.m1.1">
        <semantics id="A6.T5.4.4.4.2.m1.1a">
         <mo id="A6.T5.4.4.4.2.m1.1.1" xref="A6.T5.4.4.4.2.m1.1.1.cmml">
          ±
         </mo>
         <annotation-xml encoding="MathML-Content" id="A6.T5.4.4.4.2.m1.1b">
          <csymbol cd="latexml" id="A6.T5.4.4.4.2.m1.1.1.cmml" xref="A6.T5.4.4.4.2.m1.1.1">
           plus-or-minus
          </csymbol>
         </annotation-xml>
         <annotation encoding="application/x-tex" id="A6.T5.4.4.4.2.m1.1c">
          \pm
         </annotation>
        </semantics>
       </math>
       <span class="ltx_text ltx_font_smallcaps" id="A6.T5.4.4.4.2.2">
        0.011
       </span>
      </td>
     </tr>
     <tr class="ltx_tr" id="A6.T5.6.6.6">
      <td class="ltx_td ltx_align_left ltx_border_r" id="A6.T5.6.6.6.3">
       <span class="ltx_text ltx_font_smallcaps" id="A6.T5.6.6.6.3.1">
        Health Insurance ⟨
       </span>
       <span class="ltx_text ltx_font_italic" id="A6.T5.6.6.6.3.2">
        K
       </span>
       <span class="ltx_text ltx_font_smallcaps" id="A6.T5.6.6.6.3.3">
        ⟩
       </span>
      </td>
      <td class="ltx_td ltx_align_center ltx_border_r" id="A6.T5.5.5.5.1">
       <span class="ltx_text ltx_font_smallcaps" id="A6.T5.5.5.5.1.1">
        0.5748
       </span>
       <math alttext="\pm" class="ltx_Math" display="inline" id="A6.T5.5.5.5.1.m1.1">
        <semantics id="A6.T5.5.5.5.1.m1.1a">
         <mo id="A6.T5.5.5.5.1.m1.1.1" xref="A6.T5.5.5.5.1.m1.1.1.cmml">
          ±
         </mo>
         <annotation-xml encoding="MathML-Content" id="A6.T5.5.5.5.1.m1.1b">
          <csymbol cd="latexml" id="A6.T5.5.5.5.1.m1.1.1.cmml" xref="A6.T5.5.5.5.1.m1.1.1">
           plus-or-minus
          </csymbol>
         </annotation-xml>
         <annotation encoding="application/x-tex" id="A6.T5.5.5.5.1.m1.1c">
          \pm
         </annotation>
        </semantics>
       </math>
       <span class="ltx_text ltx_font_smallcaps" id="A6.T5.5.5.5.1.2">
        0.020
       </span>
      </td>
      <td class="ltx_td ltx_align_center" id="A6.T5.6.6.6.2">
       <span class="ltx_text ltx_font_bold" id="A6.T5.6.6.6.2.1">
        0.5995
        <math alttext="\pm" class="ltx_Math" display="inline" id="A6.T5.6.6.6.2.1.m1.1">
         <semantics id="A6.T5.6.6.6.2.1.m1.1a">
          <mo id="A6.T5.6.6.6.2.1.m1.1.1" xref="A6.T5.6.6.6.2.1.m1.1.1.cmml">
           ±
          </mo>
          <annotation-xml encoding="MathML-Content" id="A6.T5.6.6.6.2.1.m1.1b">
           <csymbol cd="latexml" id="A6.T5.6.6.6.2.1.m1.1.1.cmml" xref="A6.T5.6.6.6.2.1.m1.1.1">
            plus-or-minus
           </csymbol>
          </annotation-xml>
          <annotation encoding="application/x-tex" id="A6.T5.6.6.6.2.1.m1.1c">
           \pm
          </annotation>
         </semantics>
        </math>
       </span>
       <span class="ltx_text ltx_font_smallcaps" id="A6.T5.6.6.6.2.2">
        0.011
       </span>
      </td>
     </tr>
     <tr class="ltx_tr" id="A6.T5.8.8.8">
      <td class="ltx_td ltx_align_left ltx_border_r" id="A6.T5.8.8.8.3">
       <span class="ltx_text ltx_font_smallcaps" id="A6.T5.8.8.8.3.1">
        Spaceship Titanic ⟨
       </span>
       <span class="ltx_text ltx_font_italic" id="A6.T5.8.8.8.3.2">
        K
       </span>
       <span class="ltx_text ltx_font_smallcaps" id="A6.T5.8.8.8.3.3">
        ⟩
       </span>
      </td>
      <td class="ltx_td ltx_align_center ltx_border_r" id="A6.T5.7.7.7.1">
       <span class="ltx_text ltx_font_smallcaps" id="A6.T5.7.7.7.1.1">
        0.8405
       </span>
       <math alttext="\pm" class="ltx_Math" display="inline" id="A6.T5.7.7.7.1.m1.1">
        <semantics id="A6.T5.7.7.7.1.m1.1a">
         <mo id="A6.T5.7.7.7.1.m1.1.1" xref="A6.T5.7.7.7.1.m1.1.1.cmml">
          ±
         </mo>
         <annotation-xml encoding="MathML-Content" id="A6.T5.7.7.7.1.m1.1b">
          <csymbol cd="latexml" id="A6.T5.7.7.7.1.m1.1.1.cmml" xref="A6.T5.7.7.7.1.m1.1.1">
           plus-or-minus
          </csymbol>
         </annotation-xml>
         <annotation encoding="application/x-tex" id="A6.T5.7.7.7.1.m1.1c">
          \pm
         </annotation>
        </semantics>
       </math>
       <span class="ltx_text ltx_font_smallcaps" id="A6.T5.7.7.7.1.2">
        0.020
       </span>
      </td>
      <td class="ltx_td ltx_align_center" id="A6.T5.8.8.8.2">
       <span class="ltx_text ltx_font_bold" id="A6.T5.8.8.8.2.1">
        0.8578
        <math alttext="\pm" class="ltx_Math" display="inline" id="A6.T5.8.8.8.2.1.m1.1">
         <semantics id="A6.T5.8.8.8.2.1.m1.1a">
          <mo id="A6.T5.8.8.8.2.1.m1.1.1" xref="A6.T5.8.8.8.2.1.m1.1.1.cmml">
           ±
          </mo>
          <annotation-xml encoding="MathML-Content" id="A6.T5.8.8.8.2.1.m1.1b">
           <csymbol cd="latexml" id="A6.T5.8.8.8.2.1.m1.1.1.cmml" xref="A6.T5.8.8.8.2.1.m1.1.1">
            plus-or-minus
           </csymbol>
          </annotation-xml>
          <annotation encoding="application/x-tex" id="A6.T5.8.8.8.2.1.m1.1c">
           \pm
          </annotation>
         </semantics>
        </math>
       </span>
       <span class="ltx_text ltx_font_smallcaps" id="A6.T5.8.8.8.2.2">
        0.015
       </span>
      </td>
     </tr>
     <tr class="ltx_tr" id="A6.T5.10.10.10">
      <td class="ltx_td ltx_align_left ltx_border_r ltx_border_t" id="A6.T5.10.10.10.3">
       <span class="ltx_text ltx_font_smallcaps" id="A6.T5.10.10.10.3.1">
        Airlines
       </span>
      </td>
      <td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="A6.T5.9.9.9.1">
       <span class="ltx_text ltx_font_smallcaps" id="A6.T5.9.9.9.1.1">
        0.6203
       </span>
       <math alttext="\pm" class="ltx_Math" display="inline" id="A6.T5.9.9.9.1.m1.1">
        <semantics id="A6.T5.9.9.9.1.m1.1a">
         <mo id="A6.T5.9.9.9.1.m1.1.1" xref="A6.T5.9.9.9.1.m1.1.1.cmml">
          ±
         </mo>
         <annotation-xml encoding="MathML-Content" id="A6.T5.9.9.9.1.m1.1b">
          <csymbol cd="latexml" id="A6.T5.9.9.9.1.m1.1.1.cmml" xref="A6.T5.9.9.9.1.m1.1.1">
           plus-or-minus
          </csymbol>
         </annotation-xml>
         <annotation encoding="application/x-tex" id="A6.T5.9.9.9.1.m1.1c">
          \pm
         </annotation>
        </semantics>
       </math>
       <span class="ltx_text ltx_font_smallcaps" id="A6.T5.9.9.9.1.2">
        0.040
       </span>
      </td>
      <td class="ltx_td ltx_align_center ltx_border_t" id="A6.T5.10.10.10.2">
       <span class="ltx_text ltx_font_bold" id="A6.T5.10.10.10.2.1">
        0.6580
        <math alttext="\pm" class="ltx_Math" display="inline" id="A6.T5.10.10.10.2.1.m1.1">
         <semantics id="A6.T5.10.10.10.2.1.m1.1a">
          <mo id="A6.T5.10.10.10.2.1.m1.1.1" xref="A6.T5.10.10.10.2.1.m1.1.1.cmml">
           ±
          </mo>
          <annotation-xml encoding="MathML-Content" id="A6.T5.10.10.10.2.1.m1.1b">
           <csymbol cd="latexml" id="A6.T5.10.10.10.2.1.m1.1.1.cmml" xref="A6.T5.10.10.10.2.1.m1.1.1">
            plus-or-minus
           </csymbol>
          </annotation-xml>
          <annotation encoding="application/x-tex" id="A6.T5.10.10.10.2.1.m1.1c">
           \pm
          </annotation>
         </semantics>
        </math>
       </span>
       <span class="ltx_text ltx_font_smallcaps" id="A6.T5.10.10.10.2.2">
        0.011
       </span>
      </td>
     </tr>
     <tr class="ltx_tr" id="A6.T5.12.12.12">
      <td class="ltx_td ltx_align_left ltx_border_r" id="A6.T5.12.12.12.3">
       <span class="ltx_text ltx_font_smallcaps" id="A6.T5.12.12.12.3.1">
        Balance Scale
       </span>
      </td>
      <td class="ltx_td ltx_align_center ltx_border_r" id="A6.T5.11.11.11.1">
       <span class="ltx_text ltx_font_smallcaps" id="A6.T5.11.11.11.1.1">
        0.882
       </span>
       <math alttext="\pm" class="ltx_Math" display="inline" id="A6.T5.11.11.11.1.m1.1">
        <semantics id="A6.T5.11.11.11.1.m1.1a">
         <mo id="A6.T5.11.11.11.1.m1.1.1" xref="A6.T5.11.11.11.1.m1.1.1.cmml">
          ±
         </mo>
         <annotation-xml encoding="MathML-Content" id="A6.T5.11.11.11.1.m1.1b">
          <csymbol cd="latexml" id="A6.T5.11.11.11.1.m1.1.1.cmml" xref="A6.T5.11.11.11.1.m1.1.1">
           plus-or-minus
          </csymbol>
         </annotation-xml>
         <annotation encoding="application/x-tex" id="A6.T5.11.11.11.1.m1.1c">
          \pm
         </annotation>
        </semantics>
       </math>
       <span class="ltx_text ltx_font_smallcaps" id="A6.T5.11.11.11.1.2">
        0.260
       </span>
      </td>
      <td class="ltx_td ltx_align_center" id="A6.T5.12.12.12.2">
       <span class="ltx_text ltx_font_bold" id="A6.T5.12.12.12.2.1">
        0.9289
        <math alttext="\pm" class="ltx_Math" display="inline" id="A6.T5.12.12.12.2.1.m1.1">
         <semantics id="A6.T5.12.12.12.2.1.m1.1a">
          <mo id="A6.T5.12.12.12.2.1.m1.1.1" xref="A6.T5.12.12.12.2.1.m1.1.1.cmml">
           ±
          </mo>
          <annotation-xml encoding="MathML-Content" id="A6.T5.12.12.12.2.1.m1.1b">
           <csymbol cd="latexml" id="A6.T5.12.12.12.2.1.m1.1.1.cmml" xref="A6.T5.12.12.12.2.1.m1.1.1">
            plus-or-minus
           </csymbol>
          </annotation-xml>
          <annotation encoding="application/x-tex" id="A6.T5.12.12.12.2.1.m1.1c">
           \pm
          </annotation>
         </semantics>
        </math>
       </span>
       <span class="ltx_text ltx_font_smallcaps" id="A6.T5.12.12.12.2.2">
        0.038
       </span>
      </td>
     </tr>
     <tr class="ltx_tr" id="A6.T5.14.14.14">
      <td class="ltx_td ltx_align_left ltx_border_r" id="A6.T5.14.14.14.3">
       <span class="ltx_text ltx_font_smallcaps" id="A6.T5.14.14.14.3.1">
        Breast-w
       </span>
      </td>
      <td class="ltx_td ltx_align_center ltx_border_r" id="A6.T5.13.13.13.1">
       <span class="ltx_text ltx_font_smallcaps" id="A6.T5.13.13.13.1.1">
        0.9809
       </span>
       <math alttext="\pm" class="ltx_Math" display="inline" id="A6.T5.13.13.13.1.m1.1">
        <semantics id="A6.T5.13.13.13.1.m1.1a">
         <mo id="A6.T5.13.13.13.1.m1.1.1" xref="A6.T5.13.13.13.1.m1.1.1.cmml">
          ±
         </mo>
         <annotation-xml encoding="MathML-Content" id="A6.T5.13.13.13.1.m1.1b">
          <csymbol cd="latexml" id="A6.T5.13.13.13.1.m1.1.1.cmml" xref="A6.T5.13.13.13.1.m1.1.1">
           plus-or-minus
          </csymbol>
         </annotation-xml>
         <annotation encoding="application/x-tex" id="A6.T5.13.13.13.1.m1.1c">
          \pm
         </annotation>
        </semantics>
       </math>
       <span class="ltx_text ltx_font_smallcaps" id="A6.T5.13.13.13.1.2">
        0.020
       </span>
      </td>
      <td class="ltx_td ltx_align_center" id="A6.T5.14.14.14.2">
       <span class="ltx_text ltx_font_bold" id="A6.T5.14.14.14.2.1">
        0.9948
        <math alttext="\pm" class="ltx_Math" display="inline" id="A6.T5.14.14.14.2.1.m1.1">
         <semantics id="A6.T5.14.14.14.2.1.m1.1a">
          <mo id="A6.T5.14.14.14.2.1.m1.1.1" xref="A6.T5.14.14.14.2.1.m1.1.1.cmml">
           ±
          </mo>
          <annotation-xml encoding="MathML-Content" id="A6.T5.14.14.14.2.1.m1.1b">
           <csymbol cd="latexml" id="A6.T5.14.14.14.2.1.m1.1.1.cmml" xref="A6.T5.14.14.14.2.1.m1.1.1">
            plus-or-minus
           </csymbol>
          </annotation-xml>
          <annotation encoding="application/x-tex" id="A6.T5.14.14.14.2.1.m1.1c">
           \pm
          </annotation>
         </semantics>
        </math>
       </span>
       <span class="ltx_text ltx_font_smallcaps" id="A6.T5.14.14.14.2.2">
        0.003
       </span>
      </td>
     </tr>
     <tr class="ltx_tr" id="A6.T5.16.16.16">
      <td class="ltx_td ltx_align_left ltx_border_r" id="A6.T5.16.16.16.3">
       <span class="ltx_text ltx_font_smallcaps" id="A6.T5.16.16.16.3.1">
        CMC
       </span>
      </td>
      <td class="ltx_td ltx_align_center ltx_border_r" id="A6.T5.15.15.15.1">
       <span class="ltx_text ltx_font_bold" id="A6.T5.15.15.15.1.1">
        0.7393
        <math alttext="\pm" class="ltx_Math" display="inline" id="A6.T5.15.15.15.1.1.m1.1">
         <semantics id="A6.T5.15.15.15.1.1.m1.1a">
          <mo id="A6.T5.15.15.15.1.1.m1.1.1" xref="A6.T5.15.15.15.1.1.m1.1.1.cmml">
           ±
          </mo>
          <annotation-xml encoding="MathML-Content" id="A6.T5.15.15.15.1.1.m1.1b">
           <csymbol cd="latexml" id="A6.T5.15.15.15.1.1.m1.1.1.cmml" xref="A6.T5.15.15.15.1.1.m1.1.1">
            plus-or-minus
           </csymbol>
          </annotation-xml>
          <annotation encoding="application/x-tex" id="A6.T5.15.15.15.1.1.m1.1c">
           \pm
          </annotation>
         </semantics>
        </math>
       </span>
       <span class="ltx_text ltx_font_smallcaps" id="A6.T5.15.15.15.1.2">
        0.020
       </span>
      </td>
      <td class="ltx_td ltx_align_center" id="A6.T5.16.16.16.2">
       <span class="ltx_text ltx_font_smallcaps" id="A6.T5.16.16.16.2.1">
        0.7306
       </span>
       <math alttext="\pm" class="ltx_Math" display="inline" id="A6.T5.16.16.16.2.m1.1">
        <semantics id="A6.T5.16.16.16.2.m1.1a">
         <mo id="A6.T5.16.16.16.2.m1.1.1" xref="A6.T5.16.16.16.2.m1.1.1.cmml">
          ±
         </mo>
         <annotation-xml encoding="MathML-Content" id="A6.T5.16.16.16.2.m1.1b">
          <csymbol cd="latexml" id="A6.T5.16.16.16.2.m1.1.1.cmml" xref="A6.T5.16.16.16.2.m1.1.1">
           plus-or-minus
          </csymbol>
         </annotation-xml>
         <annotation encoding="application/x-tex" id="A6.T5.16.16.16.2.m1.1c">
          \pm
         </annotation>
        </semantics>
       </math>
       <span class="ltx_text ltx_font_smallcaps" id="A6.T5.16.16.16.2.2">
        0.003
       </span>
      </td>
     </tr>
     <tr class="ltx_tr" id="A6.T5.18.18.18">
      <td class="ltx_td ltx_align_left ltx_border_r" id="A6.T5.18.18.18.3">
       <span class="ltx_text ltx_font_smallcaps" id="A6.T5.18.18.18.3.1">
        Credit-g
       </span>
      </td>
      <td class="ltx_td ltx_align_center ltx_border_r" id="A6.T5.17.17.17.1">
       <span class="ltx_text ltx_font_smallcaps" id="A6.T5.17.17.17.1.1">
        0.7832
       </span>
       <math alttext="\pm" class="ltx_Math" display="inline" id="A6.T5.17.17.17.1.m1.1">
        <semantics id="A6.T5.17.17.17.1.m1.1a">
         <mo id="A6.T5.17.17.17.1.m1.1.1" xref="A6.T5.17.17.17.1.m1.1.1.cmml">
          ±
         </mo>
         <annotation-xml encoding="MathML-Content" id="A6.T5.17.17.17.1.m1.1b">
          <csymbol cd="latexml" id="A6.T5.17.17.17.1.m1.1.1.cmml" xref="A6.T5.17.17.17.1.m1.1.1">
           plus-or-minus
          </csymbol>
         </annotation-xml>
         <annotation encoding="application/x-tex" id="A6.T5.17.17.17.1.m1.1c">
          \pm
         </annotation>
        </semantics>
       </math>
       <span class="ltx_text ltx_font_smallcaps" id="A6.T5.17.17.17.1.2">
        0.030
       </span>
      </td>
      <td class="ltx_td ltx_align_center" id="A6.T5.18.18.18.2">
       <span class="ltx_text ltx_font_bold" id="A6.T5.18.18.18.2.1">
        0.7875
        <math alttext="\pm" class="ltx_Math" display="inline" id="A6.T5.18.18.18.2.1.m1.1">
         <semantics id="A6.T5.18.18.18.2.1.m1.1a">
          <mo id="A6.T5.18.18.18.2.1.m1.1.1" xref="A6.T5.18.18.18.2.1.m1.1.1.cmml">
           ±
          </mo>
          <annotation-xml encoding="MathML-Content" id="A6.T5.18.18.18.2.1.m1.1b">
           <csymbol cd="latexml" id="A6.T5.18.18.18.2.1.m1.1.1.cmml" xref="A6.T5.18.18.18.2.1.m1.1.1">
            plus-or-minus
           </csymbol>
          </annotation-xml>
          <annotation encoding="application/x-tex" id="A6.T5.18.18.18.2.1.m1.1c">
           \pm
          </annotation>
         </semantics>
        </math>
       </span>
       <span class="ltx_text ltx_font_smallcaps" id="A6.T5.18.18.18.2.2">
        0.023
       </span>
      </td>
     </tr>
     <tr class="ltx_tr" id="A6.T5.20.20.20">
      <td class="ltx_td ltx_align_left ltx_border_r" id="A6.T5.20.20.20.3">
       <span class="ltx_text ltx_font_smallcaps" id="A6.T5.20.20.20.3.1">
        Diabetes
       </span>
      </td>
      <td class="ltx_td ltx_align_center ltx_border_r" id="A6.T5.19.19.19.1">
       <span class="ltx_text ltx_font_bold" id="A6.T5.19.19.19.1.1">
        0.8425
        <math alttext="\pm" class="ltx_Math" display="inline" id="A6.T5.19.19.19.1.1.m1.1">
         <semantics id="A6.T5.19.19.19.1.1.m1.1a">
          <mo id="A6.T5.19.19.19.1.1.m1.1.1" xref="A6.T5.19.19.19.1.1.m1.1.1.cmml">
           ±
          </mo>
          <annotation-xml encoding="MathML-Content" id="A6.T5.19.19.19.1.1.m1.1b">
           <csymbol cd="latexml" id="A6.T5.19.19.19.1.1.m1.1.1.cmml" xref="A6.T5.19.19.19.1.1.m1.1.1">
            plus-or-minus
           </csymbol>
          </annotation-xml>
          <annotation encoding="application/x-tex" id="A6.T5.19.19.19.1.1.m1.1c">
           \pm
          </annotation>
         </semantics>
        </math>
       </span>
       <span class="ltx_text ltx_font_smallcaps" id="A6.T5.19.19.19.1.2">
        0.030
       </span>
      </td>
      <td class="ltx_td ltx_align_center" id="A6.T5.20.20.20.2">
       <span class="ltx_text ltx_font_smallcaps" id="A6.T5.20.20.20.2.1">
        0.8329
       </span>
       <math alttext="\pm" class="ltx_Math" display="inline" id="A6.T5.20.20.20.2.m1.1">
        <semantics id="A6.T5.20.20.20.2.m1.1a">
         <mo id="A6.T5.20.20.20.2.m1.1.1" xref="A6.T5.20.20.20.2.m1.1.1.cmml">
          ±
         </mo>
         <annotation-xml encoding="MathML-Content" id="A6.T5.20.20.20.2.m1.1b">
          <csymbol cd="latexml" id="A6.T5.20.20.20.2.m1.1.1.cmml" xref="A6.T5.20.20.20.2.m1.1.1">
           plus-or-minus
          </csymbol>
         </annotation-xml>
         <annotation encoding="application/x-tex" id="A6.T5.20.20.20.2.m1.1c">
          \pm
         </annotation>
        </semantics>
       </math>
       <span class="ltx_text ltx_font_smallcaps" id="A6.T5.20.20.20.2.2">
        0.008
       </span>
      </td>
     </tr>
     <tr class="ltx_tr" id="A6.T5.22.22.22">
      <td class="ltx_td ltx_align_left ltx_border_r" id="A6.T5.22.22.22.3">
       <span class="ltx_text ltx_font_smallcaps" id="A6.T5.22.22.22.3.1">
        Eucalyptus
       </span>
      </td>
      <td class="ltx_td ltx_align_center ltx_border_r" id="A6.T5.21.21.21.1">
       <span class="ltx_text ltx_font_bold" id="A6.T5.21.21.21.1.1">
        0.9319
        <math alttext="\pm" class="ltx_Math" display="inline" id="A6.T5.21.21.21.1.1.m1.1">
         <semantics id="A6.T5.21.21.21.1.1.m1.1a">
          <mo id="A6.T5.21.21.21.1.1.m1.1.1" xref="A6.T5.21.21.21.1.1.m1.1.1.cmml">
           ±
          </mo>
          <annotation-xml encoding="MathML-Content" id="A6.T5.21.21.21.1.1.m1.1b">
           <csymbol cd="latexml" id="A6.T5.21.21.21.1.1.m1.1.1.cmml" xref="A6.T5.21.21.21.1.1.m1.1.1">
            plus-or-minus
           </csymbol>
          </annotation-xml>
          <annotation encoding="application/x-tex" id="A6.T5.21.21.21.1.1.m1.1c">
           \pm
          </annotation>
         </semantics>
        </math>
       </span>
       <span class="ltx_text ltx_font_smallcaps" id="A6.T5.21.21.21.1.2">
        0.000
       </span>
      </td>
      <td class="ltx_td ltx_align_center" id="A6.T5.22.22.22.2">
       <span class="ltx_text ltx_font_smallcaps" id="A6.T5.22.22.22.2.1">
        0.8973
       </span>
       <math alttext="\pm" class="ltx_Math" display="inline" id="A6.T5.22.22.22.2.m1.1">
        <semantics id="A6.T5.22.22.22.2.m1.1a">
         <mo id="A6.T5.22.22.22.2.m1.1.1" xref="A6.T5.22.22.22.2.m1.1.1.cmml">
          ±
         </mo>
         <annotation-xml encoding="MathML-Content" id="A6.T5.22.22.22.2.m1.1b">
          <csymbol cd="latexml" id="A6.T5.22.22.22.2.m1.1.1.cmml" xref="A6.T5.22.22.22.2.m1.1.1">
           plus-or-minus
          </csymbol>
         </annotation-xml>
         <annotation encoding="application/x-tex" id="A6.T5.22.22.22.2.m1.1c">
          \pm
         </annotation>
        </semantics>
       </math>
       <span class="ltx_text ltx_font_smallcaps" id="A6.T5.22.22.22.2.2">
        0.006
       </span>
      </td>
     </tr>
     <tr class="ltx_tr" id="A6.T5.24.24.24">
      <td class="ltx_td ltx_align_left ltx_border_r" id="A6.T5.24.24.24.3">
       <span class="ltx_text ltx_font_smallcaps" id="A6.T5.24.24.24.3.1">
        Jungle Chess
       </span>
      </td>
      <td class="ltx_td ltx_align_center ltx_border_r" id="A6.T5.23.23.23.1">
       <span class="ltx_text ltx_font_bold" id="A6.T5.23.23.23.1.1">
        0.9453
        <math alttext="\pm" class="ltx_Math" display="inline" id="A6.T5.23.23.23.1.1.m1.1">
         <semantics id="A6.T5.23.23.23.1.1.m1.1a">
          <mo id="A6.T5.23.23.23.1.1.m1.1.1" xref="A6.T5.23.23.23.1.1.m1.1.1.cmml">
           ±
          </mo>
          <annotation-xml encoding="MathML-Content" id="A6.T5.23.23.23.1.1.m1.1b">
           <csymbol cd="latexml" id="A6.T5.23.23.23.1.1.m1.1.1.cmml" xref="A6.T5.23.23.23.1.1.m1.1.1">
            plus-or-minus
           </csymbol>
          </annotation-xml>
          <annotation encoding="application/x-tex" id="A6.T5.23.23.23.1.1.m1.1c">
           \pm
          </annotation>
         </semantics>
        </math>
       </span>
       <span class="ltx_text ltx_font_smallcaps" id="A6.T5.23.23.23.1.2">
        0.010
       </span>
      </td>
      <td class="ltx_td ltx_align_center" id="A6.T5.24.24.24.2">
       <span class="ltx_text ltx_font_smallcaps" id="A6.T5.24.24.24.2.1">
        0.9216
       </span>
       <math alttext="\pm" class="ltx_Math" display="inline" id="A6.T5.24.24.24.2.m1.1">
        <semantics id="A6.T5.24.24.24.2.m1.1a">
         <mo id="A6.T5.24.24.24.2.m1.1.1" xref="A6.T5.24.24.24.2.m1.1.1.cmml">
          ±
         </mo>
         <annotation-xml encoding="MathML-Content" id="A6.T5.24.24.24.2.m1.1b">
          <csymbol cd="latexml" id="A6.T5.24.24.24.2.m1.1.1.cmml" xref="A6.T5.24.24.24.2.m1.1.1">
           plus-or-minus
          </csymbol>
         </annotation-xml>
         <annotation encoding="application/x-tex" id="A6.T5.24.24.24.2.m1.1c">
          \pm
         </annotation>
        </semantics>
       </math>
       <span class="ltx_text ltx_font_smallcaps" id="A6.T5.24.24.24.2.2">
        0.007
       </span>
      </td>
     </tr>
     <tr class="ltx_tr" id="A6.T5.26.26.26">
      <td class="ltx_td ltx_align_left ltx_border_r" id="A6.T5.26.26.26.3">
       <span class="ltx_text ltx_font_smallcaps" id="A6.T5.26.26.26.3.1">
        PC1
       </span>
      </td>
      <td class="ltx_td ltx_align_center ltx_border_r" id="A6.T5.25.25.25.1">
       <span class="ltx_text ltx_font_bold" id="A6.T5.25.25.25.1.1">
        0.9093
        <math alttext="\pm" class="ltx_Math" display="inline" id="A6.T5.25.25.25.1.1.m1.1">
         <semantics id="A6.T5.25.25.25.1.1.m1.1a">
          <mo id="A6.T5.25.25.25.1.1.m1.1.1" xref="A6.T5.25.25.25.1.1.m1.1.1.cmml">
           ±
          </mo>
          <annotation-xml encoding="MathML-Content" id="A6.T5.25.25.25.1.1.m1.1b">
           <csymbol cd="latexml" id="A6.T5.25.25.25.1.1.m1.1.1.cmml" xref="A6.T5.25.25.25.1.1.m1.1.1">
            plus-or-minus
           </csymbol>
          </annotation-xml>
          <annotation encoding="application/x-tex" id="A6.T5.25.25.25.1.1.m1.1c">
           \pm
          </annotation>
         </semantics>
        </math>
       </span>
       <span class="ltx_text ltx_font_smallcaps" id="A6.T5.25.25.25.1.2">
        0.010
       </span>
      </td>
      <td class="ltx_td ltx_align_center" id="A6.T5.26.26.26.2">
       <span class="ltx_text ltx_font_smallcaps" id="A6.T5.26.26.26.2.1">
        0.8492
       </span>
       <math alttext="\pm" class="ltx_Math" display="inline" id="A6.T5.26.26.26.2.m1.1">
        <semantics id="A6.T5.26.26.26.2.m1.1a">
         <mo id="A6.T5.26.26.26.2.m1.1.1" xref="A6.T5.26.26.26.2.m1.1.1.cmml">
          ±
         </mo>
         <annotation-xml encoding="MathML-Content" id="A6.T5.26.26.26.2.m1.1b">
          <csymbol cd="latexml" id="A6.T5.26.26.26.2.m1.1.1.cmml" xref="A6.T5.26.26.26.2.m1.1.1">
           plus-or-minus
          </csymbol>
         </annotation-xml>
         <annotation encoding="application/x-tex" id="A6.T5.26.26.26.2.m1.1c">
          \pm
         </annotation>
        </semantics>
       </math>
       <span class="ltx_text ltx_font_smallcaps" id="A6.T5.26.26.26.2.2">
        0.016
       </span>
      </td>
     </tr>
     <tr class="ltx_tr" id="A6.T5.28.28.28">
      <td class="ltx_td ltx_align_left ltx_border_bb ltx_border_r" id="A6.T5.28.28.28.3">
       <span class="ltx_text ltx_font_smallcaps" id="A6.T5.28.28.28.3.1">
        Tic-Tac-Toe
       </span>
      </td>
      <td class="ltx_td ltx_align_center ltx_border_bb ltx_border_r" id="A6.T5.27.27.27.1">
       <span class="ltx_text ltx_font_bold" id="A6.T5.27.27.27.1.1">
        0.9536
        <math alttext="\pm" class="ltx_Math" display="inline" id="A6.T5.27.27.27.1.1.m1.1">
         <semantics id="A6.T5.27.27.27.1.1.m1.1a">
          <mo id="A6.T5.27.27.27.1.1.m1.1.1" xref="A6.T5.27.27.27.1.1.m1.1.1.cmml">
           ±
          </mo>
          <annotation-xml encoding="MathML-Content" id="A6.T5.27.27.27.1.1.m1.1b">
           <csymbol cd="latexml" id="A6.T5.27.27.27.1.1.m1.1.1.cmml" xref="A6.T5.27.27.27.1.1.m1.1.1">
            plus-or-minus
           </csymbol>
          </annotation-xml>
          <annotation encoding="application/x-tex" id="A6.T5.27.27.27.1.1.m1.1c">
           \pm
          </annotation>
         </semantics>
        </math>
       </span>
       <span class="ltx_text ltx_font_smallcaps" id="A6.T5.27.27.27.1.2">
        0.060
       </span>
      </td>
      <td class="ltx_td ltx_align_center ltx_border_bb" id="A6.T5.28.28.28.2">
       <span class="ltx_text ltx_font_smallcaps" id="A6.T5.28.28.28.2.1">
        0.7483
       </span>
       <math alttext="\pm" class="ltx_Math" display="inline" id="A6.T5.28.28.28.2.m1.1">
        <semantics id="A6.T5.28.28.28.2.m1.1a">
         <mo id="A6.T5.28.28.28.2.m1.1.1" xref="A6.T5.28.28.28.2.m1.1.1.cmml">
          ±
         </mo>
         <annotation-xml encoding="MathML-Content" id="A6.T5.28.28.28.2.m1.1b">
          <csymbol cd="latexml" id="A6.T5.28.28.28.2.m1.1.1.cmml" xref="A6.T5.28.28.28.2.m1.1.1">
           plus-or-minus
          </csymbol>
         </annotation-xml>
         <annotation encoding="application/x-tex" id="A6.T5.28.28.28.2.m1.1c">
          \pm
         </annotation>
        </semantics>
       </math>
       <span class="ltx_text ltx_font_smallcaps" id="A6.T5.28.28.28.2.2">
        0.032
       </span>
      </td>
     </tr>
    </tbody>
   </table>
  </figure>
  <div class="ltx_pagination ltx_role_newpage">
  </div>
 </section>
 <section class="ltx_appendix" id="A7">
  <h2 class="ltx_title ltx_title_appendix">
   <span class="ltx_tag ltx_tag_appendix">
    Appendix G
   </span>
   Ablations
  </h2>
  <div class="ltx_para" id="A7.p1">
   <p class="ltx_p" id="A7.p1.1">
    In this section, we conduct ablation studies to investigate the importance of different choices.
   </p>
  </div>
  <figure class="ltx_figure" id="A7.F10">
   <p class="ltx_p ltx_align_center ltx_align_center" id="A7.F10.1.1">
    <span class="ltx_text" id="A7.F10.1.1.1">
     <img alt="Refer to caption" class="ltx_graphics ltx_img_landscape" height="207" id="A7.F10.1.1.1.g1" src="/html/2402.06700/assets/x5.png" width="276"/>
    </span>
   </p>
   <figcaption class="ltx_caption ltx_centering">
    <span class="ltx_tag ltx_tag_figure">
     Figure 10:
    </span>
    Average performance comparison between ETPO and its ablated variants, with details in Table
    <a class="ltx_ref" href="#A6.T4" title="Table 4 ‣ Appendix F Additional Results ‣ Entropy-Regularized Token-Level Policy Optimization for Large Language Models">
     <span class="ltx_text ltx_ref_tag">
      4
     </span>
    </a>
    . ETPO(DISC.) applies discount factor
    <math alttext="\gamma=0.99" class="ltx_Math" display="inline" id="A7.F10.3.3.m1.1">
     <semantics id="A7.F10.3.3.m1.1b">
      <mrow id="A7.F10.3.3.m1.1.1" xref="A7.F10.3.3.m1.1.1.cmml">
       <mi id="A7.F10.3.3.m1.1.1.2" xref="A7.F10.3.3.m1.1.1.2.cmml">
        γ
       </mi>
       <mo id="A7.F10.3.3.m1.1.1.1" xref="A7.F10.3.3.m1.1.1.1.cmml">
        =
       </mo>
       <mn id="A7.F10.3.3.m1.1.1.3" xref="A7.F10.3.3.m1.1.1.3.cmml">
        0.99
       </mn>
      </mrow>
      <annotation-xml encoding="MathML-Content" id="A7.F10.3.3.m1.1c">
       <apply id="A7.F10.3.3.m1.1.1.cmml" xref="A7.F10.3.3.m1.1.1">
        <eq id="A7.F10.3.3.m1.1.1.1.cmml" xref="A7.F10.3.3.m1.1.1.1">
        </eq>
        <ci id="A7.F10.3.3.m1.1.1.2.cmml" xref="A7.F10.3.3.m1.1.1.2">
         𝛾
        </ci>
        <cn id="A7.F10.3.3.m1.1.1.3.cmml" type="float" xref="A7.F10.3.3.m1.1.1.3">
         0.99
        </cn>
       </apply>
      </annotation-xml>
      <annotation encoding="application/x-tex" id="A7.F10.3.3.m1.1d">
       \gamma=0.99
      </annotation>
     </semantics>
    </math>
    when backpropagating the credit between tokens within an action. ETPO(1-Step) is trained on the environment with a maximum step limit of 1 to disable the reflection process.
   </figcaption>
  </figure>
  <div class="ltx_para" id="A7.p2">
   <p class="ltx_p" id="A7.p2.2">
    <span class="ltx_text ltx_font_bold" id="A7.p2.2.1">
     Discounting within actions or not
    </span>
    In the per-token soft Bellman update, we only discount the Q-values backpropagation between the last token in
    <math alttext="a_{t}" class="ltx_Math" display="inline" id="A7.p2.1.m1.1">
     <semantics id="A7.p2.1.m1.1a">
      <msub id="A7.p2.1.m1.1.1" xref="A7.p2.1.m1.1.1.cmml">
       <mi id="A7.p2.1.m1.1.1.2" xref="A7.p2.1.m1.1.1.2.cmml">
        a
       </mi>
       <mi id="A7.p2.1.m1.1.1.3" xref="A7.p2.1.m1.1.1.3.cmml">
        t
       </mi>
      </msub>
      <annotation-xml encoding="MathML-Content" id="A7.p2.1.m1.1b">
       <apply id="A7.p2.1.m1.1.1.cmml" xref="A7.p2.1.m1.1.1">
        <csymbol cd="ambiguous" id="A7.p2.1.m1.1.1.1.cmml" xref="A7.p2.1.m1.1.1">
         subscript
        </csymbol>
        <ci id="A7.p2.1.m1.1.1.2.cmml" xref="A7.p2.1.m1.1.1.2">
         𝑎
        </ci>
        <ci id="A7.p2.1.m1.1.1.3.cmml" xref="A7.p2.1.m1.1.1.3">
         𝑡
        </ci>
       </apply>
      </annotation-xml>
      <annotation encoding="application/x-tex" id="A7.p2.1.m1.1c">
       a_{t}
      </annotation>
     </semantics>
    </math>
    and the first token in the next action
    <math alttext="a_{t+1}" class="ltx_Math" display="inline" id="A7.p2.2.m2.1">
     <semantics id="A7.p2.2.m2.1a">
      <msub id="A7.p2.2.m2.1.1" xref="A7.p2.2.m2.1.1.cmml">
       <mi id="A7.p2.2.m2.1.1.2" xref="A7.p2.2.m2.1.1.2.cmml">
        a
       </mi>
       <mrow id="A7.p2.2.m2.1.1.3" xref="A7.p2.2.m2.1.1.3.cmml">
        <mi id="A7.p2.2.m2.1.1.3.2" xref="A7.p2.2.m2.1.1.3.2.cmml">
         t
        </mi>
        <mo id="A7.p2.2.m2.1.1.3.1" xref="A7.p2.2.m2.1.1.3.1.cmml">
         +
        </mo>
        <mn id="A7.p2.2.m2.1.1.3.3" xref="A7.p2.2.m2.1.1.3.3.cmml">
         1
        </mn>
       </mrow>
      </msub>
      <annotation-xml encoding="MathML-Content" id="A7.p2.2.m2.1b">
       <apply id="A7.p2.2.m2.1.1.cmml" xref="A7.p2.2.m2.1.1">
        <csymbol cd="ambiguous" id="A7.p2.2.m2.1.1.1.cmml" xref="A7.p2.2.m2.1.1">
         subscript
        </csymbol>
        <ci id="A7.p2.2.m2.1.1.2.cmml" xref="A7.p2.2.m2.1.1.2">
         𝑎
        </ci>
        <apply id="A7.p2.2.m2.1.1.3.cmml" xref="A7.p2.2.m2.1.1.3">
         <plus id="A7.p2.2.m2.1.1.3.1.cmml" xref="A7.p2.2.m2.1.1.3.1">
         </plus>
         <ci id="A7.p2.2.m2.1.1.3.2.cmml" xref="A7.p2.2.m2.1.1.3.2">
          𝑡
         </ci>
         <cn id="A7.p2.2.m2.1.1.3.3.cmml" type="integer" xref="A7.p2.2.m2.1.1.3.3">
          1
         </cn>
        </apply>
       </apply>
      </annotation-xml>
      <annotation encoding="application/x-tex" id="A7.p2.2.m2.1c">
       a_{t+1}
      </annotation>
     </semantics>
    </math>
    . Besides, we also confirm this choice by comparing ETPO with a variant that applies the same discount factor to the credit backpropagation within an action, i.e. the ETPO(DISC.) in Figure
    <a class="ltx_ref" href="#A7.F10" title="Figure 10 ‣ Appendix G Ablations ‣ Entropy-Regularized Token-Level Policy Optimization for Large Language Models">
     <span class="ltx_text ltx_ref_tag">
      10
     </span>
    </a>
    . It is worth noting that ETPO(DISC.) is a theoretically flawed algorithm since it breaks the consistency between token optimization and action optimization.
   </p>
  </div>
  <div class="ltx_para" id="A7.p3">
   <p class="ltx_p" id="A7.p3.1">
    <span class="ltx_text ltx_font_bold" id="A7.p3.1.1">
     Single-step or multi-step
    </span>
    As we discussed in Section
    <a class="ltx_ref" href="#S5.SS3" title="5.3 Convergence ‣ 5 Experiments ‣ Entropy-Regularized Token-Level Policy Optimization for Large Language Models">
     <span class="ltx_text ltx_ref_tag">
      5.3
     </span>
    </a>
    , vanilla CodeLlama-7B is unstable in generating runnable code. To reduce the frequency of generating invalid code and improve exploration efficiency, we model the code generation task as a multi-step sequential decision-making process with reflection. The results in Table
    <a class="ltx_ref" href="#A6.T4" title="Table 4 ‣ Appendix F Additional Results ‣ Entropy-Regularized Token-Level Policy Optimization for Large Language Models">
     <span class="ltx_text ltx_ref_tag">
      4
     </span>
    </a>
    confirmed our choice, where ETPO outperforms its single-step variant whose maximum step limit is set to
    <math alttext="1" class="ltx_Math" display="inline" id="A7.p3.1.m1.1">
     <semantics id="A7.p3.1.m1.1a">
      <mn id="A7.p3.1.m1.1.1" xref="A7.p3.1.m1.1.1.cmml">
       1
      </mn>
      <annotation-xml encoding="MathML-Content" id="A7.p3.1.m1.1b">
       <cn id="A7.p3.1.m1.1.1.cmml" type="integer" xref="A7.p3.1.m1.1.1">
        1
       </cn>
      </annotation-xml>
      <annotation encoding="application/x-tex" id="A7.p3.1.m1.1c">
       1
      </annotation>
     </semantics>
    </math>
    and the reflection process is ignored.
   </p>
  </div>
  <div class="ltx_pagination ltx_role_newpage">
  </div>
 </section>
</article>
