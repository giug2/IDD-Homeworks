<!DOCTYPE html>
<html lang="en">
<head>
<meta content="text/html; charset=utf-8" http-equiv="content-type"/>
<title>Movie Recommendation with Poster Attention via Multi-modal Transformer Feature Fusion</title>
<!--Generated on Fri Jul 12 10:42:24 2024 by LaTeXML (version 0.8.8) http://dlmf.nist.gov/LaTeXML/.-->
<meta content="width=device-width, initial-scale=1, shrink-to-fit=no" name="viewport"/>
<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet" type="text/css"/>
<link href="/static/browse/0.3.4/css/ar5iv.0.7.9.min.css" rel="stylesheet" type="text/css"/>
<link href="/static/browse/0.3.4/css/ar5iv-fonts.0.7.9.min.css" rel="stylesheet" type="text/css"/>
<link href="/static/browse/0.3.4/css/latexml_styles.css" rel="stylesheet" type="text/css"/>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.3.3/html2canvas.min.js"></script>
<script src="/static/browse/0.3.4/js/addons_new.js"></script>
<script src="/static/browse/0.3.4/js/feedbackOverlay.js"></script>
<base href="/html/2407.09157v1/"/></head>
<body>
<nav class="ltx_page_navbar">
<nav class="ltx_TOC">
<ol class="ltx_toclist">
<li class="ltx_tocentry ltx_tocentry_section"><a class="ltx_ref" href="https://arxiv.org/html/2407.09157v1#S1" title="In Movie Recommendation with Poster Attention via Multi-modal Transformer Feature Fusion"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">1 </span>Introduction</span></a></li>
<li class="ltx_tocentry ltx_tocentry_section">
<a class="ltx_ref" href="https://arxiv.org/html/2407.09157v1#S2" title="In Movie Recommendation with Poster Attention via Multi-modal Transformer Feature Fusion"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">2 </span>Related Work</span></a>
<ol class="ltx_toclist ltx_toclist_section">
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2407.09157v1#S2.SS1" title="In 2 Related Work ‣ Movie Recommendation with Poster Attention via Multi-modal Transformer Feature Fusion"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">2.1 </span>Single modal approaches of recommendation system</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2407.09157v1#S2.SS2" title="In 2 Related Work ‣ Movie Recommendation with Poster Attention via Multi-modal Transformer Feature Fusion"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">2.2 </span>Multi-modal fusion recommendation system</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2407.09157v1#S2.SS3" title="In 2 Related Work ‣ Movie Recommendation with Poster Attention via Multi-modal Transformer Feature Fusion"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">2.3 </span>Pre-trained models</span></a></li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_section">
<a class="ltx_ref" href="https://arxiv.org/html/2407.09157v1#S3" title="In Movie Recommendation with Poster Attention via Multi-modal Transformer Feature Fusion"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3 </span>Methodology</span></a>
<ol class="ltx_toclist ltx_toclist_section">
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2407.09157v1#S3.SS1" title="In 3 Methodology ‣ Movie Recommendation with Poster Attention via Multi-modal Transformer Feature Fusion"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3.1 </span>Framework of the proposed model</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2407.09157v1#S3.SS2" title="In 3 Methodology ‣ Movie Recommendation with Poster Attention via Multi-modal Transformer Feature Fusion"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3.2 </span>Textual feature extractor</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2407.09157v1#S3.SS3" title="In 3 Methodology ‣ Movie Recommendation with Poster Attention via Multi-modal Transformer Feature Fusion"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3.3 </span>Image feature extractor</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2407.09157v1#S3.SS4" title="In 3 Methodology ‣ Movie Recommendation with Poster Attention via Multi-modal Transformer Feature Fusion"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3.4 </span>Structural data feature extractor</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2407.09157v1#S3.SS5" title="In 3 Methodology ‣ Movie Recommendation with Poster Attention via Multi-modal Transformer Feature Fusion"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3.5 </span>Feature fusion based on Transformer</span></a></li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_section">
<a class="ltx_ref" href="https://arxiv.org/html/2407.09157v1#S4" title="In Movie Recommendation with Poster Attention via Multi-modal Transformer Feature Fusion"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">4 </span>Results</span></a>
<ol class="ltx_toclist ltx_toclist_section">
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2407.09157v1#S4.SS1" title="In 4 Results ‣ Movie Recommendation with Poster Attention via Multi-modal Transformer Feature Fusion"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">4.1 </span>Hardware and Environment configure</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2407.09157v1#S4.SS2" title="In 4 Results ‣ Movie Recommendation with Poster Attention via Multi-modal Transformer Feature Fusion"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">4.2 </span>Introduction of dataset</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2407.09157v1#S4.SS3" title="In 4 Results ‣ Movie Recommendation with Poster Attention via Multi-modal Transformer Feature Fusion"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">4.3 </span>Test B: explore the influence of size of dataset and learning rate</span></a></li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_section"><a class="ltx_ref" href="https://arxiv.org/html/2407.09157v1#S5" title="In Movie Recommendation with Poster Attention via Multi-modal Transformer Feature Fusion"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">5 </span>Discussion and Conclusions</span></a></li>
</ol></nav>
</nav>
<div class="ltx_page_main">
<div class="ltx_page_content">
<article class="ltx_document ltx_authors_1line ltx_fleqn">
<div class="ltx_para" id="p1">
<p class="ltx_p" id="p1.1">[2]<span class="ltx_ERROR undefined" id="p1.1.1">\fnm</span>Shengxin <span class="ltx_ERROR undefined" id="p1.1.2">\sur</span>Zhu</p>
</div>
<div class="ltx_para" id="p2">
<p class="ltx_p" id="p2.1">[1]<span class="ltx_ERROR undefined" id="p2.1.1">\orgdiv</span> Guangdong Provincial Key Laboratory of Interdisciplinary Research and Application for Data Science, <span class="ltx_ERROR undefined" id="p2.1.2">\orgname</span>BNU-HKBU United International
College, <span class="ltx_ERROR undefined" id="p2.1.3">\orgaddress</span> <span class="ltx_ERROR undefined" id="p2.1.4">\city</span>Zhuhai, <span class="ltx_ERROR undefined" id="p2.1.5">\postcode</span>519087, <span class="ltx_ERROR undefined" id="p2.1.6">\state</span>Guangdong, <span class="ltx_ERROR undefined" id="p2.1.7">\country</span>China</p>
</div>
<div class="ltx_para" id="p3">
<p class="ltx_p" id="p3.1">2]<span class="ltx_ERROR undefined" id="p3.1.1">\orgdiv</span>Research Center for Mathematics, <span class="ltx_ERROR undefined" id="p3.1.2">\orgname</span>Beijing Normal University, <span class="ltx_ERROR undefined" id="p3.1.3">\orgaddress</span><span class="ltx_ERROR undefined" id="p3.1.4">\street</span>Jingfeng Road, <span class="ltx_ERROR undefined" id="p3.1.5">\city</span>Zhuhai, <span class="ltx_ERROR undefined" id="p3.1.6">\postcode</span>519087, <span class="ltx_ERROR undefined" id="p3.1.7">\state</span>Guangdong, <span class="ltx_ERROR undefined" id="p3.1.8">\country</span>China</p>
</div>
<h1 class="ltx_title ltx_title_document">Movie Recommendation with Poster Attention via Multi-modal Transformer Feature Fusion</h1>
<div class="ltx_authors">
<span class="ltx_creator ltx_role_author">
<span class="ltx_personname"><span class="ltx_ERROR undefined" id="id1.1.id1">\fnm</span>Linhan <span class="ltx_ERROR undefined" id="id2.2.id2">\sur</span>Xia
</span></span>
<span class="ltx_author_before">  </span><span class="ltx_creator ltx_role_author">
<span class="ltx_personname"><span class="ltx_ERROR undefined" id="id3.1.id1">\fnm</span>Yicheng <span class="ltx_ERROR undefined" id="id4.2.id2">\sur</span>Yang
</span></span>
<span class="ltx_author_before">  </span><span class="ltx_creator ltx_role_author">
<span class="ltx_personname"><span class="ltx_ERROR undefined" id="id5.1.id1">\fnm</span>Ziou <span class="ltx_ERROR undefined" id="id6.2.id2">\sur</span>Chen
</span></span>
<span class="ltx_author_before">  </span><span class="ltx_creator ltx_role_author">
<span class="ltx_personname"><span class="ltx_ERROR undefined" id="id7.1.id1">\fnm</span>Zheng <span class="ltx_ERROR undefined" id="id8.2.id2">\sur</span>Yang
</span></span>
<span class="ltx_author_before">  </span><span class="ltx_creator ltx_role_author">
<span class="ltx_personname">
</span><span class="ltx_author_notes">
<span class="ltx_contact ltx_role_email"><a href="mailto:Shengxin.Zhu@bnu.edu.cn">Shengxin.Zhu@bnu.edu.cn</a>
</span>
<span class="ltx_contact ltx_role_affiliation">*
</span>
<span class="ltx_contact ltx_role_affiliation">[
</span></span></span>
</div>
<div class="ltx_abstract">
<h6 class="ltx_title ltx_title_abstract">Abstract</h6>
<p class="ltx_p" id="id9.id1">Pre-trained models learn general representations from large datsets which can be fine-turned for specific tasks to significantly reduce training time. Pre-trained models like generative pretrained transformers (GPT), bidirectional encoder representations from transformers (BERT), vision transfomers (ViT) have become a cornerstone of current research in machine learning. This study proposes a multi-modal movie recommendation system by extract features of the well designed posters for each movie and the narrative text description of the movie. This system uses the BERT model to extract the information of text modality, the ViT model applied to extract the information of poster/image modality, and the Transformer architecture for feature fusion of all modalities to predict users’ preference. The integration of pre-trained foundational models with some smaller data sets in downstream applications capture multi-modal content features in a more comprehensive manner, thereby providing more accurate recommendations. The efficiency of the proof-of-concept model is verified by the standard benchmark problem the MovieLens 100K and 1M datasets. The prediction accuracy of user ratings is enhanced in comparison to the baseline algorithm, thereby demonstrating the potential of this cross-modal algorithm to be applied for movie or video recommendation.</p>
</div>
<div class="ltx_classification">
<h6 class="ltx_title ltx_title_classification">keywords: </h6>Recommender System; multi-modal feature fusion; Token fusion; Pre-trained model; MovieLens; foundation models
</div>
<section class="ltx_section" id="S1">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">1 </span>Introduction</h2>
<div class="ltx_para" id="S1.p1">
<p class="ltx_p" id="S1.p1.1">The development and application of information technology has generated overload information <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2407.09157v1#bib.bib1" title="">1</a>]</cite> and it have become a difficult task for users to retrieve relevant information that matches their needs from the overload information. It may even cause a decrease in the quality of users’ decision-making as well as an increase in their anxiety level <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2407.09157v1#bib.bib2" title="">2</a>]</cite>.</p>
</div>
<div class="ltx_para" id="S1.p2">
<p class="ltx_p" id="S1.p2.1">In order to help users better filter information through reasonable information management and filtering mechanisms, recommender systems have emerged. The role of a recommender systems is to filter information that may interest users based on their interests, behaviors and preferences, and to provide personalized content in the massive amount of information to enhance user experience and satisfaction <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2407.09157v1#bib.bib3" title="">3</a>]</cite>.</p>
</div>
<div class="ltx_para" id="S1.p3">
<p class="ltx_p" id="S1.p3.1">Recommender systems usually integrate data mining, machine learning and other means to analyze users’ historical behavior, social relationships and content characteristics of the information to build user-item interaction model <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2407.09157v1#bib.bib4" title="">4</a>]</cite>. The advent of recommender systems in the mid-1990s saw the emergence of algorithms that matched and customized content for users. These systems have since become a pervasive feature of e-commerce, social media, audio-visual entertainment, and numerous other fields.</p>
</div>
<div class="ltx_para" id="S1.p4">
<p class="ltx_p" id="S1.p4.1">The development of deep learning in recent years has greatly empowered recommender systems, and some of these methods are already working in real applications. For instance, YouTube uses Convolution Neural Networks(CNN) to extract poster features combined with user preferences <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2407.09157v1#bib.bib5" title="">5</a>]</cite>; Netflix uses recurrent neural networks (RNN) to track users’ reading history to capture changes in user interests <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2407.09157v1#bib.bib6" title="">6</a>]</cite>; twitter uses graph neural networks (GNN) to analyze users‘ social relationships and interaction history to achieve personalized topic recommendations <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2407.09157v1#bib.bib7" title="">7</a>]</cite>. What’s more, recommendation systems can also be used for medical care <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2407.09157v1#bib.bib8" title="">8</a>]</cite> and knowledge discovery <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2407.09157v1#bib.bib9" title="">9</a>]</cite>.</p>
</div>
<div class="ltx_para" id="S1.p5">
<p class="ltx_p" id="S1.p5.1">However, with the popularization of internet applications and the proliferation of multimedia contents, it is difficult to meet users’ needs with single-modal information. Among them, the data sparsity problem is a serious challenge. In the context of a recommendation system, the term ’sparsity problem’ is used to describe a situation where interaction data between users and items is very sparse. This makes it challenging for the system to accurately learn and predict users’ preferences. Cross-modal recommender systems are supposed to capture content features more comprehensively by integrating and analyzing data from multiple modalities and thus provide more accurate recommendations. For instance, in movie recommendation, the data sparsity problem is alleviated by combining information such as text descriptions and poster images of movies.</p>
</div>
<div class="ltx_para" id="S1.p6">
<p class="ltx_p" id="S1.p6.1">This research proposes a movie recommender system that combines cross-modal data analysis and deep learning. The proposed system employs pre-trained model to mine and fuse multi-source information and uses a transformer architecture to fuse them. The multi-modal data set includes user characteristics and multi-modal data of movies. Result on the MovieLens benchmark problems shows that better prediction accuracy can be achieved in comparison to some traditional algorithms. This indicates the potential of multi-model recommendation.</p>
</div>
</section>
<section class="ltx_section" id="S2">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">2 </span>Related Work</h2>
<div class="ltx_para" id="S2.p1">
<p class="ltx_p" id="S2.p1.1">In the past two decades, the development of recommendation algorithms has had a profound impact on people’s lives. Major content platforms such as Bytedance, Weibo, and Twitter have adopted different recommendation algorithms to serve their users and help them discover personalized content. With the development of the Internet industry, numerous researchers have put forward a variety of different methods. This chapter describes the relevant work in detail from two aspects: traditional approaches and multi-modal fusion approaches.</p>
</div>
<section class="ltx_subsection" id="S2.SS1">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">2.1 </span>Single modal approaches of recommendation system</h3>
<div class="ltx_para" id="S2.SS1.p1">
<p class="ltx_p" id="S2.SS1.p1.1">Single modal recommendation algorithms can be divided into three main branches: content based approach <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2407.09157v1#bib.bib10" title="">10</a>]</cite>, collaborative recommendation approach <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2407.09157v1#bib.bib11" title="">11</a>]</cite> and hybrid recommender system <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2407.09157v1#bib.bib12" title="">12</a>]</cite>.</p>
</div>
<div class="ltx_para" id="S2.SS1.p2">
<p class="ltx_p" id="S2.SS1.p2.1">Content-based recommender systems have evolved over decades as well as relatively matured, and their core features are relying on content features and user characteristics to achieve accurate recommendations. Roy et al. provide an extensive overview of these principles, and they emphasize the importance of understanding user preferences and content features to generate accurate recommendations <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2407.09157v1#bib.bib13" title="">13</a>]</cite>. The process of understanding user preference is often referred to as profile inference <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2407.09157v1#bib.bib14" title="">14</a>]</cite>. In addition, Dahdouh et al. emphasized the significance of tools for recommender system development, with particular reference to big data technologies such as Hadoop and Spark in content-based recommender systems <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2407.09157v1#bib.bib15" title="">15</a>]</cite>.</p>
</div>
<div class="ltx_para" id="S2.SS1.p3">
<p class="ltx_p" id="S2.SS1.p3.1">Content based recommender systems rely on content features to generate recommendations. Based on the traditional algorithmic perspective, some scholars have proposed to analyze the text images or other content forms of the items to match with user preferences. Beel et al. have used the TF-IDF approach to capture the semantic relevance of the documents to achieve accurate recommendations in the publication domain <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2407.09157v1#bib.bib16" title="">16</a>]</cite>. Latent semantic analysis (LSA) is a modeling technique based on singular value decomposition, which aims to reduce the dimensionality of document features and discover the potential topics in them. Bergamaschi et al. used LSA to model the topics of the documents, which significantly improves the effectiveness of the recommender system <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2407.09157v1#bib.bib17" title="">17</a>]</cite>. In addition, rule-based recommender system also favored by some researchers. Bouihi et al. proposed a recommendation algorithm based on learning history rule and learning performance rule for recommendation based on embedded coding <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2407.09157v1#bib.bib18" title="">18</a>]</cite>. Simple Bayesian classifier is a probabilistic based classification algorithm commonly used in text classification and recommender systems with the advantages of computational efficiency and simplicity of implementation. Roy et al. in their study pointed out the application of simple Bayes in recommender systems especially in news recommendation and email filtering <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2407.09157v1#bib.bib13" title="">13</a>]</cite>. Zhang et al. proposed a method for linearly classifying text content using SVMs and thus realizing accurate recommendation approach, emphasizing its role in improving accuracy and generalization ability <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2407.09157v1#bib.bib19" title="">19</a>]</cite>. Gao et al. proposed to utilize a linear mixed model for group recommender systems, based on this approach the accuracy and adaptability of the recommendation system in group recommendation are improved effectively <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2407.09157v1#bib.bib20" title="">20</a>]</cite>. Zuo et al. proposed a approach to combine linear mixed model and singular value decomposition (SVD) to improve the performance <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2407.09157v1#bib.bib21" title="">21</a>]</cite>.</p>
</div>
<div class="ltx_para" id="S2.SS1.p4">
<p class="ltx_p" id="S2.SS1.p4.1">The development of deep learning has provided new perspectives for content based recommender systems. Shafqat et al. employed hierarchical LSTM model to predict the destination of travelers. This approach allowed the model to learn the context, thereby enabling it to consider factors such as location, user, and environment. These factors included aspects such as weather, climate, and risk <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2407.09157v1#bib.bib22" title="">22</a>]</cite>. Paradarami et al. proposed a deep learning neural network framework that utilizes reviews and content-based features to generate model-based predictions for business user portfolios <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2407.09157v1#bib.bib22" title="">22</a>]</cite>. Hassan et al. proposed the use of artificial neural networks to model standard ratings and determine the predictive performance of the system based on the aggregated function approach <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2407.09157v1#bib.bib23" title="">23</a>]</cite>. The performance is more prominent in seven evaluation metrics. David et al. evaluated the performance of various models including LSTM, GRU in e-commerce recommender systems and found that RNN models based on the attention mechanism have certain advantages on specific tasks <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2407.09157v1#bib.bib24" title="">24</a>]</cite>. In order to achieve holistic optimization of long-term recommendation, Huang et al. proposed a reinforcement learning-based long-term recommendation system. The recommendation process in Huang’s work is considered as a Markov decision process, in which the interaction between agents (recommender system) and environments (user) is simulated by a RNN, and a reinforcement learning optimization model is used to achieve more accurate recommendation <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2407.09157v1#bib.bib25" title="">25</a>]</cite>. Lee et al. and others divided the recommendation cycle into different time steps and the proposed recommendation system based on RNN divides the time series into multiple periods for recommendation <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2407.09157v1#bib.bib26" title="">26</a>]</cite>. These deep learning models can capture higher order feature interactions <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2407.09157v1#bib.bib27" title="">27</a>]</cite> and explore users deep interests <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2407.09157v1#bib.bib28" title="">28</a>, <a class="ltx_ref" href="https://arxiv.org/html/2407.09157v1#bib.bib29" title="">29</a>]</cite> and thus often result in better results. Siet et al. proposed a movie recommendation system, which used user behavior sequence and multi-head attention mechanism to analyze user preferences, embed user information and movie sequences to optimize data processing results, and finally use the K-means algorithm to improve the accuracy and diversity of recommendations <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2407.09157v1#bib.bib30" title="">30</a>]</cite>. Aljunid et al. used deep learning to embed the characteristics of users and movies, and achieves dimensionality reduction through embedding layer, and predicts the score through forward propagation method <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2407.09157v1#bib.bib31" title="">31</a>]</cite>.</p>
</div>
<div class="ltx_para" id="S2.SS1.p5">
<p class="ltx_p" id="S2.SS1.p5.1">A collaborative recommendation system is a type of recommendation technology that employs user behavior data, which is widely used in e-commerce, social media, movie recommendation and other domains. In recent years, with the expansion of data and the enhancement of algorithms, the research of collaborative recommendation systems has witnessed a significant advancement.</p>
</div>
<div class="ltx_para" id="S2.SS1.p6">
<p class="ltx_p" id="S2.SS1.p6.1">One of approaches is user-based collaborative filtering, which identifies groups of users with similar interests to the target user and formulates recommendations based on their preferences. Ma et al. improved the user-based collaborative filtering (CF) technique by proposing two recommendation methods that incorporate user-generated labels and social relationships. The performance is improved compared to the baseline model <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2407.09157v1#bib.bib32" title="">32</a>]</cite>. Millan et al. used KNN algorithm to generate asymmetric group, based on the asymmetric group to measure the asymmetric similarity among users and thus achieve recommendation <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2407.09157v1#bib.bib33" title="">33</a>]</cite>. O’connor et al. proposed PolyLens, which is designed to provide recommendation services for groups of users rather than for individuals to recommendation, and they pointed out that giving up some privacy in group recommendation can get better recommendation results <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2407.09157v1#bib.bib34" title="">34</a>]</cite>. Zhang et al. proposed to extract the hidden social relationship information based on user feedback, and integrate the user’s social relationship information into matrix factorization and Bayesian personalized ranking to solve the problems of rating prediction and item ranking, respectively <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2407.09157v1#bib.bib35" title="">35</a>]</cite>. Fakhri proposed a methodology based on the user rating similarity and user similarity for restaurant recommendation, which has achieved an mean absolute error (MAE) of 1.492 in an experiment without user attributes <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2407.09157v1#bib.bib36" title="">36</a>]</cite>.</p>
</div>
<div class="ltx_para" id="S2.SS1.p7">
<p class="ltx_p" id="S2.SS1.p7.1">Deep learning algorithms also have a wide range of applications in collaborative recommender systems. Fu et al. proposed to simulate effective intelligent recommendations by implementing learning about users and content <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2407.09157v1#bib.bib37" title="">37</a>]</cite>. Fu’s approach embeds encoded user-items relevance semantic information, respectively, to obtain low latitude vectors as a way of realizing the recommendations. Bobadilla et al. proposed a three-phase approach to collaborative recommendation <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2407.09157v1#bib.bib38" title="">38</a>]</cite>. The first phase involves the actual prediction error, the second the prediction error, and the third the prediction rating. Each phase has its own learning process, which aims to improve the quality of prediction at a given time. Wang et al. Collaborative deep learning, which inherits the idea of collaborative topic regression, couples two different sources of information together, and generates rating matrices for collaborative filtering through deep learning <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2407.09157v1#bib.bib39" title="">39</a>]</cite>. Aljunid et al. proposed a multi-model deep learning (MMDL), integrating items and users to build a hybrid recommender system, MMDL combines deep self-encoder and one-dimensional convolution to realize the improvement of performance <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2407.09157v1#bib.bib40" title="">40</a>]</cite>. The research of Wu <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2407.09157v1#bib.bib41" title="">41</a>]</cite> pointed out that there is a great potential of graphical neural networks (GNNs) to be applied in recommender systems. Based on GNN, Gao et al. proposed CA-GNN for sensing contextual scenes and users-items interaction graphs, and used the attention mechanism to improve the interpretability and accuracy of the model <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2407.09157v1#bib.bib40" title="">40</a>]</cite>. Wang et al. proposed a graph neural network social recommendation model, for GNN-based social recommendation <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2407.09157v1#bib.bib42" title="">42</a>]</cite>.</p>
</div>
<div class="ltx_para" id="S2.SS1.p8">
<p class="ltx_p" id="S2.SS1.p8.1">Hybrid recommender systems integrate multiple recommendation techniques, capitalising on the unique strengths of each to enhance the overall efficacy of the system. These systems frequently employ collaborative filtering, content-based recommendations, and other algorithms, such as machine learning, to enhance the precision and efficacy of the recommendations generated. Kreutz et al. combined content-based and collaborative filtering techniques to provide personalized recommendations for researchers, generating personalized recommendations based on users’ historical publications and their citation patterns <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2407.09157v1#bib.bib43" title="">43</a>]</cite>. Pradhan et al. proposed a paper recommendation combining social network analysis and content-based recommendation, the contextual similarity of papers and social relationships between researchers are considered <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2407.09157v1#bib.bib44" title="">44</a>]</cite>. Lorbeer et al. employed deep learning techniques to analyze textual data and clustering algorithms such as birch to improve the grouping of similar items and enhance the content-based filtering process <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2407.09157v1#bib.bib45" title="">45</a>]</cite>. Qaiser et al. proposed an article recommendation algorithm based on word embeddings generated from article metadata to form article embeddings, followed by spherical k-means clustering, combined with content-based methods and clustering to improve scalability <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2407.09157v1#bib.bib46" title="">46</a>]</cite>. Biswas et al. combined collaborative filtering and deep learning to solve the cold start problem and improve the recommendation quality by using user behavior data and item characteristics <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2407.09157v1#bib.bib47" title="">47</a>]</cite>.</p>
</div>
</section>
<section class="ltx_subsection" id="S2.SS2">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">2.2 </span>Multi-modal fusion recommendation system</h3>
<div class="ltx_para" id="S2.SS2.p1">
<p class="ltx_p" id="S2.SS2.p1.1">The advent of multimedia platforms has prompted a surge of interest among researchers in recommender systems based on multi-modality. These systems are able to consider multi-modal data (such as input text and image) simultaneously, offering a more comprehensive approach to information processing.</p>
</div>
<div class="ltx_para" id="S2.SS2.p2">
<p class="ltx_p" id="S2.SS2.p2.1">In the level of multi-modal recommendation algorithms, Saga et al. proposed a way to extract features of product images based on convolutional neural networks (CNNs), combined with information from other modalities such as user reviews to achieve prediction of users’ purchasing tendencies <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2407.09157v1#bib.bib48" title="">48</a>]</cite>. Choudhury et al. proposed a trust matrix approach combining user similarity with weighted trust propagation in multi-modality, where active users are evaluated by different trust filters and cold users generate optimized score predictions through their preferences <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2407.09157v1#bib.bib49" title="">49</a>]</cite>. Nikzad-Khasmakhi et al. proposed Berters to recommend relevant experts on specific topics based on three different scores: authority, text similarity and reputation <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2407.09157v1#bib.bib50" title="">50</a>]</cite>. Chung et al. proposed a multi-modal collaborative recommendation algorithm based on the attention mechanism, which firstly utilizes a convolutional network to represent the image features at a high order, and the user habits and preferences learned by the LSTM to perform the feature fusion to realize the recommendation algorithm <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2407.09157v1#bib.bib51" title="">51</a>]</cite>. In order to better embed multi-modal information, Sun et al. proposed Multi-modal Knowledge Graph Attention Network (MKGAT), which first propagates the multi-modal knowledge graph for knowledge propagation, and then aggregates the representations of different modalities for recommendation in order to improve the recommendation quality <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2407.09157v1#bib.bib52" title="">52</a>]</cite>.</p>
</div>
<div class="ltx_para" id="S2.SS2.p3">
<p class="ltx_p" id="S2.SS2.p3.1">The core of multi-modal recommendation algorithm is how to fuse the information of different modes. By fusing the information of multiple modes together, complementary information can be provided for the model to improve the accuracy of the model <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2407.09157v1#bib.bib53" title="">53</a>]</cite>. For this reason, some scholars proposed different fusion methods.</p>
</div>
<div class="ltx_para" id="S2.SS2.p4">
<p class="ltx_p" id="S2.SS2.p4.1">Linear weight based fusion method is the simplest fusion approach which combines information from different modalities in a linear manner. Foresti and Snidaro and Yang et al. applied this approach to detecting and tracking pedestrians <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2407.09157v1#bib.bib54" title="">54</a>, <a class="ltx_ref" href="https://arxiv.org/html/2407.09157v1#bib.bib55" title="">55</a>]</cite>. Zhu et al. proposed a low-rank tensor multi-modal fusion approach with an attentional mechanism, which improves the efficiency and reduces the computational complexity at the same time <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2407.09157v1#bib.bib56" title="">56</a>]</cite>. Wei et al. proposed the use of cross-attention architecture to achieve fusion of image modalities and text modalities for downstream tasks <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2407.09157v1#bib.bib57" title="">57</a>]</cite>. Wang et al. proposed a multi-modal token fusion method for transformer-based multi-modal token fusion (TokenFusion), where TokenFusion dynamically detects uninformative tokens and replaces these tokens with projected and aggregated multi-modal features <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2407.09157v1#bib.bib58" title="">58</a>]</cite>. This design helps the model learn the correlation between different modalities.</p>
</div>
</section>
<section class="ltx_subsection" id="S2.SS3">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">2.3 </span>Pre-trained models</h3>
<div class="ltx_para" id="S2.SS3.p1">
<p class="ltx_p" id="S2.SS3.p1.1">In our research, we implement recommendation algorithm based on feature extraction through pre-trained models. Pre-trained models have become a cornerstone of current research in machine learning, especially in the fields of Natural Language Processing (NLP) and Computer Vision (CV). Pre-training models learn general representations from large datasets, which can be fine-tuned for specific tasks to significantly reduce training time.</p>
</div>
<div class="ltx_para" id="S2.SS3.p2">
<p class="ltx_p" id="S2.SS3.p2.1">In the field of NLP, pre-trained models such as BERT (Bidirectional Encoder Representations from transformers) <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2407.09157v1#bib.bib59" title="">59</a>]</cite>, Generative Pre-trained Transformer (GPT) <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2407.09157v1#bib.bib60" title="">60</a>]</cite> and Robustly optimized BERT approach (RoBERTa) <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2407.09157v1#bib.bib61" title="">61</a>]</cite>. They are pre-trained in a corpus, initially learn the knowledge of human society and embed it in their own parameters and can be fine-tuned in downstream tasks to achieve the target results.</p>
</div>
<div class="ltx_para" id="S2.SS3.p3">
<p class="ltx_p" id="S2.SS3.p3.1">In the field of CV, pre-trained models such as VGGNet <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2407.09157v1#bib.bib62" title="">62</a>]</cite>, Residual networks (RoBERTa) <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2407.09157v1#bib.bib63" title="">63</a>]</cite> and Vision transformer (ViT) <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2407.09157v1#bib.bib64" title="">64</a>]</cite> based on transformer architecture. These models are pre-trained on large-scale image datasets to learn to extract image features and migrate these features to other tasks including feature extraction, target detection and semantic segmentation.</p>
</div>
</section>
</section>
<section class="ltx_section" id="S3">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">3 </span>Methodology</h2>
<div class="ltx_para" id="S3.p1">
<p class="ltx_p" id="S3.p1.1">In this section, we elaborate the composition and structure of our cross-modal movie recommendation algorithm based on pre-trained model feature extraction and Transformer architecture feature fusion. The model uses BERT model to extract the information of text modality, the ViT model to extract the information of image modality, and the Transformer architecture for feature fusion of all modalities to predict the users’ ratings of movies. The performance indexes are significantly improved compared with traditional collaborative filtering algorithms.</p>
</div>
<section class="ltx_subsection" id="S3.SS1">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.1 </span>Framework of the proposed model</h3>
<div class="ltx_para" id="S3.SS1.p1">
<p class="ltx_p" id="S3.SS1.p1.1">We propose a deep learning based cross-modal neural network for movie recommendation. The framework of our model is illustrated in Figure <a class="ltx_ref" href="https://arxiv.org/html/2407.09157v1#S3.F1" title="Figure 1 ‣ 3.1 Framework of the proposed model ‣ 3 Methodology ‣ Movie Recommendation with Poster Attention via Multi-modal Transformer Feature Fusion"><span class="ltx_text ltx_ref_tag">1</span></a>. The input data of the model comprises multi-modal information from both users and movies. Users’ information includes the user ID, age, ZIP code, occupation, and gender, while movies’ information comprises the movie ID, genre, poster, title, and introduction. These data are divided into three modalities: textual information modality (e.g., title and introduction), image information modality (e.g., movie poster) and structured data (e.g., genre, occupation, etc.). We use different embedding methods to embed information in each of the three modalities. For image modality we use ViT model to extract the features, for text modality we use BERT model to extract the features, and for structured data we design a multilayer neural network based embedding structure to embed the information. After feature extraction, we design a transformer-based feature fusion module, and input the fusion result into the classification function to get the user’s rating estimation of a certain movie so as to realize personalized recommendation.</p>
</div>
<figure class="ltx_figure" id="S3.F1"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="361" id="S3.F1.g1" src="extracted/5727377/img/pipeline.jpg" width="598"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 1: </span>Pipeline of proposed model where ViT is Vision transformer and BERT is Bidirectional Encoder Representations from transformer. Both of them are pre-trained model downloaded from Hugging Face.</figcaption>
</figure>
</section>
<section class="ltx_subsection" id="S3.SS2">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.2 </span>Textual feature extractor</h3>
<div class="ltx_para" id="S3.SS2.p1">
<p class="ltx_p" id="S3.SS2.p1.12">For the information of text modality we use BERT model for feature extraction. We denote the input text sequence as <math alttext="S_{\text{input}}=[W_{1},W_{2},\ldots,W_{\text{len}}]" class="ltx_Math" display="inline" id="S3.SS2.p1.1.m1.4"><semantics id="S3.SS2.p1.1.m1.4a"><mrow id="S3.SS2.p1.1.m1.4.4" xref="S3.SS2.p1.1.m1.4.4.cmml"><msub id="S3.SS2.p1.1.m1.4.4.5" xref="S3.SS2.p1.1.m1.4.4.5.cmml"><mi id="S3.SS2.p1.1.m1.4.4.5.2" xref="S3.SS2.p1.1.m1.4.4.5.2.cmml">S</mi><mtext id="S3.SS2.p1.1.m1.4.4.5.3" xref="S3.SS2.p1.1.m1.4.4.5.3a.cmml">input</mtext></msub><mo id="S3.SS2.p1.1.m1.4.4.4" xref="S3.SS2.p1.1.m1.4.4.4.cmml">=</mo><mrow id="S3.SS2.p1.1.m1.4.4.3.3" xref="S3.SS2.p1.1.m1.4.4.3.4.cmml"><mo id="S3.SS2.p1.1.m1.4.4.3.3.4" stretchy="false" xref="S3.SS2.p1.1.m1.4.4.3.4.cmml">[</mo><msub id="S3.SS2.p1.1.m1.2.2.1.1.1" xref="S3.SS2.p1.1.m1.2.2.1.1.1.cmml"><mi id="S3.SS2.p1.1.m1.2.2.1.1.1.2" xref="S3.SS2.p1.1.m1.2.2.1.1.1.2.cmml">W</mi><mn id="S3.SS2.p1.1.m1.2.2.1.1.1.3" xref="S3.SS2.p1.1.m1.2.2.1.1.1.3.cmml">1</mn></msub><mo id="S3.SS2.p1.1.m1.4.4.3.3.5" xref="S3.SS2.p1.1.m1.4.4.3.4.cmml">,</mo><msub id="S3.SS2.p1.1.m1.3.3.2.2.2" xref="S3.SS2.p1.1.m1.3.3.2.2.2.cmml"><mi id="S3.SS2.p1.1.m1.3.3.2.2.2.2" xref="S3.SS2.p1.1.m1.3.3.2.2.2.2.cmml">W</mi><mn id="S3.SS2.p1.1.m1.3.3.2.2.2.3" xref="S3.SS2.p1.1.m1.3.3.2.2.2.3.cmml">2</mn></msub><mo id="S3.SS2.p1.1.m1.4.4.3.3.6" xref="S3.SS2.p1.1.m1.4.4.3.4.cmml">,</mo><mi id="S3.SS2.p1.1.m1.1.1" mathvariant="normal" xref="S3.SS2.p1.1.m1.1.1.cmml">…</mi><mo id="S3.SS2.p1.1.m1.4.4.3.3.7" xref="S3.SS2.p1.1.m1.4.4.3.4.cmml">,</mo><msub id="S3.SS2.p1.1.m1.4.4.3.3.3" xref="S3.SS2.p1.1.m1.4.4.3.3.3.cmml"><mi id="S3.SS2.p1.1.m1.4.4.3.3.3.2" xref="S3.SS2.p1.1.m1.4.4.3.3.3.2.cmml">W</mi><mtext id="S3.SS2.p1.1.m1.4.4.3.3.3.3" xref="S3.SS2.p1.1.m1.4.4.3.3.3.3a.cmml">len</mtext></msub><mo id="S3.SS2.p1.1.m1.4.4.3.3.8" stretchy="false" xref="S3.SS2.p1.1.m1.4.4.3.4.cmml">]</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.1.m1.4b"><apply id="S3.SS2.p1.1.m1.4.4.cmml" xref="S3.SS2.p1.1.m1.4.4"><eq id="S3.SS2.p1.1.m1.4.4.4.cmml" xref="S3.SS2.p1.1.m1.4.4.4"></eq><apply id="S3.SS2.p1.1.m1.4.4.5.cmml" xref="S3.SS2.p1.1.m1.4.4.5"><csymbol cd="ambiguous" id="S3.SS2.p1.1.m1.4.4.5.1.cmml" xref="S3.SS2.p1.1.m1.4.4.5">subscript</csymbol><ci id="S3.SS2.p1.1.m1.4.4.5.2.cmml" xref="S3.SS2.p1.1.m1.4.4.5.2">𝑆</ci><ci id="S3.SS2.p1.1.m1.4.4.5.3a.cmml" xref="S3.SS2.p1.1.m1.4.4.5.3"><mtext id="S3.SS2.p1.1.m1.4.4.5.3.cmml" mathsize="70%" xref="S3.SS2.p1.1.m1.4.4.5.3">input</mtext></ci></apply><list id="S3.SS2.p1.1.m1.4.4.3.4.cmml" xref="S3.SS2.p1.1.m1.4.4.3.3"><apply id="S3.SS2.p1.1.m1.2.2.1.1.1.cmml" xref="S3.SS2.p1.1.m1.2.2.1.1.1"><csymbol cd="ambiguous" id="S3.SS2.p1.1.m1.2.2.1.1.1.1.cmml" xref="S3.SS2.p1.1.m1.2.2.1.1.1">subscript</csymbol><ci id="S3.SS2.p1.1.m1.2.2.1.1.1.2.cmml" xref="S3.SS2.p1.1.m1.2.2.1.1.1.2">𝑊</ci><cn id="S3.SS2.p1.1.m1.2.2.1.1.1.3.cmml" type="integer" xref="S3.SS2.p1.1.m1.2.2.1.1.1.3">1</cn></apply><apply id="S3.SS2.p1.1.m1.3.3.2.2.2.cmml" xref="S3.SS2.p1.1.m1.3.3.2.2.2"><csymbol cd="ambiguous" id="S3.SS2.p1.1.m1.3.3.2.2.2.1.cmml" xref="S3.SS2.p1.1.m1.3.3.2.2.2">subscript</csymbol><ci id="S3.SS2.p1.1.m1.3.3.2.2.2.2.cmml" xref="S3.SS2.p1.1.m1.3.3.2.2.2.2">𝑊</ci><cn id="S3.SS2.p1.1.m1.3.3.2.2.2.3.cmml" type="integer" xref="S3.SS2.p1.1.m1.3.3.2.2.2.3">2</cn></apply><ci id="S3.SS2.p1.1.m1.1.1.cmml" xref="S3.SS2.p1.1.m1.1.1">…</ci><apply id="S3.SS2.p1.1.m1.4.4.3.3.3.cmml" xref="S3.SS2.p1.1.m1.4.4.3.3.3"><csymbol cd="ambiguous" id="S3.SS2.p1.1.m1.4.4.3.3.3.1.cmml" xref="S3.SS2.p1.1.m1.4.4.3.3.3">subscript</csymbol><ci id="S3.SS2.p1.1.m1.4.4.3.3.3.2.cmml" xref="S3.SS2.p1.1.m1.4.4.3.3.3.2">𝑊</ci><ci id="S3.SS2.p1.1.m1.4.4.3.3.3.3a.cmml" xref="S3.SS2.p1.1.m1.4.4.3.3.3.3"><mtext id="S3.SS2.p1.1.m1.4.4.3.3.3.3.cmml" mathsize="70%" xref="S3.SS2.p1.1.m1.4.4.3.3.3.3">len</mtext></ci></apply></list></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.1.m1.4c">S_{\text{input}}=[W_{1},W_{2},\ldots,W_{\text{len}}]</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p1.1.m1.4d">italic_S start_POSTSUBSCRIPT input end_POSTSUBSCRIPT = [ italic_W start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT , italic_W start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT , … , italic_W start_POSTSUBSCRIPT len end_POSTSUBSCRIPT ]</annotation></semantics></math>, where <math alttext="W_{x}(1\leq x\leq\text{len})" class="ltx_Math" display="inline" id="S3.SS2.p1.2.m2.1"><semantics id="S3.SS2.p1.2.m2.1a"><mrow id="S3.SS2.p1.2.m2.1.1" xref="S3.SS2.p1.2.m2.1.1.cmml"><msub id="S3.SS2.p1.2.m2.1.1.3" xref="S3.SS2.p1.2.m2.1.1.3.cmml"><mi id="S3.SS2.p1.2.m2.1.1.3.2" xref="S3.SS2.p1.2.m2.1.1.3.2.cmml">W</mi><mi id="S3.SS2.p1.2.m2.1.1.3.3" xref="S3.SS2.p1.2.m2.1.1.3.3.cmml">x</mi></msub><mo id="S3.SS2.p1.2.m2.1.1.2" xref="S3.SS2.p1.2.m2.1.1.2.cmml">⁢</mo><mrow id="S3.SS2.p1.2.m2.1.1.1.1" xref="S3.SS2.p1.2.m2.1.1.1.1.1.cmml"><mo id="S3.SS2.p1.2.m2.1.1.1.1.2" stretchy="false" xref="S3.SS2.p1.2.m2.1.1.1.1.1.cmml">(</mo><mrow id="S3.SS2.p1.2.m2.1.1.1.1.1" xref="S3.SS2.p1.2.m2.1.1.1.1.1.cmml"><mn id="S3.SS2.p1.2.m2.1.1.1.1.1.2" xref="S3.SS2.p1.2.m2.1.1.1.1.1.2.cmml">1</mn><mo id="S3.SS2.p1.2.m2.1.1.1.1.1.3" xref="S3.SS2.p1.2.m2.1.1.1.1.1.3.cmml">≤</mo><mi id="S3.SS2.p1.2.m2.1.1.1.1.1.4" xref="S3.SS2.p1.2.m2.1.1.1.1.1.4.cmml">x</mi><mo id="S3.SS2.p1.2.m2.1.1.1.1.1.5" xref="S3.SS2.p1.2.m2.1.1.1.1.1.5.cmml">≤</mo><mtext id="S3.SS2.p1.2.m2.1.1.1.1.1.6" xref="S3.SS2.p1.2.m2.1.1.1.1.1.6a.cmml">len</mtext></mrow><mo id="S3.SS2.p1.2.m2.1.1.1.1.3" stretchy="false" xref="S3.SS2.p1.2.m2.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.2.m2.1b"><apply id="S3.SS2.p1.2.m2.1.1.cmml" xref="S3.SS2.p1.2.m2.1.1"><times id="S3.SS2.p1.2.m2.1.1.2.cmml" xref="S3.SS2.p1.2.m2.1.1.2"></times><apply id="S3.SS2.p1.2.m2.1.1.3.cmml" xref="S3.SS2.p1.2.m2.1.1.3"><csymbol cd="ambiguous" id="S3.SS2.p1.2.m2.1.1.3.1.cmml" xref="S3.SS2.p1.2.m2.1.1.3">subscript</csymbol><ci id="S3.SS2.p1.2.m2.1.1.3.2.cmml" xref="S3.SS2.p1.2.m2.1.1.3.2">𝑊</ci><ci id="S3.SS2.p1.2.m2.1.1.3.3.cmml" xref="S3.SS2.p1.2.m2.1.1.3.3">𝑥</ci></apply><apply id="S3.SS2.p1.2.m2.1.1.1.1.1.cmml" xref="S3.SS2.p1.2.m2.1.1.1.1"><and id="S3.SS2.p1.2.m2.1.1.1.1.1a.cmml" xref="S3.SS2.p1.2.m2.1.1.1.1"></and><apply id="S3.SS2.p1.2.m2.1.1.1.1.1b.cmml" xref="S3.SS2.p1.2.m2.1.1.1.1"><leq id="S3.SS2.p1.2.m2.1.1.1.1.1.3.cmml" xref="S3.SS2.p1.2.m2.1.1.1.1.1.3"></leq><cn id="S3.SS2.p1.2.m2.1.1.1.1.1.2.cmml" type="integer" xref="S3.SS2.p1.2.m2.1.1.1.1.1.2">1</cn><ci id="S3.SS2.p1.2.m2.1.1.1.1.1.4.cmml" xref="S3.SS2.p1.2.m2.1.1.1.1.1.4">𝑥</ci></apply><apply id="S3.SS2.p1.2.m2.1.1.1.1.1c.cmml" xref="S3.SS2.p1.2.m2.1.1.1.1"><leq id="S3.SS2.p1.2.m2.1.1.1.1.1.5.cmml" xref="S3.SS2.p1.2.m2.1.1.1.1.1.5"></leq><share href="https://arxiv.org/html/2407.09157v1#S3.SS2.p1.2.m2.1.1.1.1.1.4.cmml" id="S3.SS2.p1.2.m2.1.1.1.1.1d.cmml" xref="S3.SS2.p1.2.m2.1.1.1.1"></share><ci id="S3.SS2.p1.2.m2.1.1.1.1.1.6a.cmml" xref="S3.SS2.p1.2.m2.1.1.1.1.1.6"><mtext id="S3.SS2.p1.2.m2.1.1.1.1.1.6.cmml" xref="S3.SS2.p1.2.m2.1.1.1.1.1.6">len</mtext></ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.2.m2.1c">W_{x}(1\leq x\leq\text{len})</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p1.2.m2.1d">italic_W start_POSTSUBSCRIPT italic_x end_POSTSUBSCRIPT ( 1 ≤ italic_x ≤ len )</annotation></semantics></math> is a word (later denoted as Token) in the input text sequence. The BERT model firstly adds ”[CLS]” token (denoted as <math alttext="W_{\text{CLS}}" class="ltx_Math" display="inline" id="S3.SS2.p1.3.m3.1"><semantics id="S3.SS2.p1.3.m3.1a"><msub id="S3.SS2.p1.3.m3.1.1" xref="S3.SS2.p1.3.m3.1.1.cmml"><mi id="S3.SS2.p1.3.m3.1.1.2" xref="S3.SS2.p1.3.m3.1.1.2.cmml">W</mi><mtext id="S3.SS2.p1.3.m3.1.1.3" xref="S3.SS2.p1.3.m3.1.1.3a.cmml">CLS</mtext></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.3.m3.1b"><apply id="S3.SS2.p1.3.m3.1.1.cmml" xref="S3.SS2.p1.3.m3.1.1"><csymbol cd="ambiguous" id="S3.SS2.p1.3.m3.1.1.1.cmml" xref="S3.SS2.p1.3.m3.1.1">subscript</csymbol><ci id="S3.SS2.p1.3.m3.1.1.2.cmml" xref="S3.SS2.p1.3.m3.1.1.2">𝑊</ci><ci id="S3.SS2.p1.3.m3.1.1.3a.cmml" xref="S3.SS2.p1.3.m3.1.1.3"><mtext id="S3.SS2.p1.3.m3.1.1.3.cmml" mathsize="70%" xref="S3.SS2.p1.3.m3.1.1.3">CLS</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.3.m3.1c">W_{\text{CLS}}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p1.3.m3.1d">italic_W start_POSTSUBSCRIPT CLS end_POSTSUBSCRIPT</annotation></semantics></math>) and ”[SEP]” token (denoted as <math alttext="W_{\text{SEP}}" class="ltx_Math" display="inline" id="S3.SS2.p1.4.m4.1"><semantics id="S3.SS2.p1.4.m4.1a"><msub id="S3.SS2.p1.4.m4.1.1" xref="S3.SS2.p1.4.m4.1.1.cmml"><mi id="S3.SS2.p1.4.m4.1.1.2" xref="S3.SS2.p1.4.m4.1.1.2.cmml">W</mi><mtext id="S3.SS2.p1.4.m4.1.1.3" xref="S3.SS2.p1.4.m4.1.1.3a.cmml">SEP</mtext></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.4.m4.1b"><apply id="S3.SS2.p1.4.m4.1.1.cmml" xref="S3.SS2.p1.4.m4.1.1"><csymbol cd="ambiguous" id="S3.SS2.p1.4.m4.1.1.1.cmml" xref="S3.SS2.p1.4.m4.1.1">subscript</csymbol><ci id="S3.SS2.p1.4.m4.1.1.2.cmml" xref="S3.SS2.p1.4.m4.1.1.2">𝑊</ci><ci id="S3.SS2.p1.4.m4.1.1.3a.cmml" xref="S3.SS2.p1.4.m4.1.1.3"><mtext id="S3.SS2.p1.4.m4.1.1.3.cmml" mathsize="70%" xref="S3.SS2.p1.4.m4.1.1.3">SEP</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.4.m4.1c">W_{\text{SEP}}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p1.4.m4.1d">italic_W start_POSTSUBSCRIPT SEP end_POSTSUBSCRIPT</annotation></semantics></math>) before and after the text sequence as the start and end of the sequence respectively. The BERT model encodes the sequence to obtain a hidden state matrix <math alttext="H=[h_{\text{CLS}},h_{1},h_{2},\ldots,h_{\text{len}},h_{\text{SEP}}]" class="ltx_Math" display="inline" id="S3.SS2.p1.5.m5.6"><semantics id="S3.SS2.p1.5.m5.6a"><mrow id="S3.SS2.p1.5.m5.6.6" xref="S3.SS2.p1.5.m5.6.6.cmml"><mi id="S3.SS2.p1.5.m5.6.6.7" xref="S3.SS2.p1.5.m5.6.6.7.cmml">H</mi><mo id="S3.SS2.p1.5.m5.6.6.6" xref="S3.SS2.p1.5.m5.6.6.6.cmml">=</mo><mrow id="S3.SS2.p1.5.m5.6.6.5.5" xref="S3.SS2.p1.5.m5.6.6.5.6.cmml"><mo id="S3.SS2.p1.5.m5.6.6.5.5.6" stretchy="false" xref="S3.SS2.p1.5.m5.6.6.5.6.cmml">[</mo><msub id="S3.SS2.p1.5.m5.2.2.1.1.1" xref="S3.SS2.p1.5.m5.2.2.1.1.1.cmml"><mi id="S3.SS2.p1.5.m5.2.2.1.1.1.2" xref="S3.SS2.p1.5.m5.2.2.1.1.1.2.cmml">h</mi><mtext id="S3.SS2.p1.5.m5.2.2.1.1.1.3" xref="S3.SS2.p1.5.m5.2.2.1.1.1.3a.cmml">CLS</mtext></msub><mo id="S3.SS2.p1.5.m5.6.6.5.5.7" xref="S3.SS2.p1.5.m5.6.6.5.6.cmml">,</mo><msub id="S3.SS2.p1.5.m5.3.3.2.2.2" xref="S3.SS2.p1.5.m5.3.3.2.2.2.cmml"><mi id="S3.SS2.p1.5.m5.3.3.2.2.2.2" xref="S3.SS2.p1.5.m5.3.3.2.2.2.2.cmml">h</mi><mn id="S3.SS2.p1.5.m5.3.3.2.2.2.3" xref="S3.SS2.p1.5.m5.3.3.2.2.2.3.cmml">1</mn></msub><mo id="S3.SS2.p1.5.m5.6.6.5.5.8" xref="S3.SS2.p1.5.m5.6.6.5.6.cmml">,</mo><msub id="S3.SS2.p1.5.m5.4.4.3.3.3" xref="S3.SS2.p1.5.m5.4.4.3.3.3.cmml"><mi id="S3.SS2.p1.5.m5.4.4.3.3.3.2" xref="S3.SS2.p1.5.m5.4.4.3.3.3.2.cmml">h</mi><mn id="S3.SS2.p1.5.m5.4.4.3.3.3.3" xref="S3.SS2.p1.5.m5.4.4.3.3.3.3.cmml">2</mn></msub><mo id="S3.SS2.p1.5.m5.6.6.5.5.9" xref="S3.SS2.p1.5.m5.6.6.5.6.cmml">,</mo><mi id="S3.SS2.p1.5.m5.1.1" mathvariant="normal" xref="S3.SS2.p1.5.m5.1.1.cmml">…</mi><mo id="S3.SS2.p1.5.m5.6.6.5.5.10" xref="S3.SS2.p1.5.m5.6.6.5.6.cmml">,</mo><msub id="S3.SS2.p1.5.m5.5.5.4.4.4" xref="S3.SS2.p1.5.m5.5.5.4.4.4.cmml"><mi id="S3.SS2.p1.5.m5.5.5.4.4.4.2" xref="S3.SS2.p1.5.m5.5.5.4.4.4.2.cmml">h</mi><mtext id="S3.SS2.p1.5.m5.5.5.4.4.4.3" xref="S3.SS2.p1.5.m5.5.5.4.4.4.3a.cmml">len</mtext></msub><mo id="S3.SS2.p1.5.m5.6.6.5.5.11" xref="S3.SS2.p1.5.m5.6.6.5.6.cmml">,</mo><msub id="S3.SS2.p1.5.m5.6.6.5.5.5" xref="S3.SS2.p1.5.m5.6.6.5.5.5.cmml"><mi id="S3.SS2.p1.5.m5.6.6.5.5.5.2" xref="S3.SS2.p1.5.m5.6.6.5.5.5.2.cmml">h</mi><mtext id="S3.SS2.p1.5.m5.6.6.5.5.5.3" xref="S3.SS2.p1.5.m5.6.6.5.5.5.3a.cmml">SEP</mtext></msub><mo id="S3.SS2.p1.5.m5.6.6.5.5.12" stretchy="false" xref="S3.SS2.p1.5.m5.6.6.5.6.cmml">]</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.5.m5.6b"><apply id="S3.SS2.p1.5.m5.6.6.cmml" xref="S3.SS2.p1.5.m5.6.6"><eq id="S3.SS2.p1.5.m5.6.6.6.cmml" xref="S3.SS2.p1.5.m5.6.6.6"></eq><ci id="S3.SS2.p1.5.m5.6.6.7.cmml" xref="S3.SS2.p1.5.m5.6.6.7">𝐻</ci><list id="S3.SS2.p1.5.m5.6.6.5.6.cmml" xref="S3.SS2.p1.5.m5.6.6.5.5"><apply id="S3.SS2.p1.5.m5.2.2.1.1.1.cmml" xref="S3.SS2.p1.5.m5.2.2.1.1.1"><csymbol cd="ambiguous" id="S3.SS2.p1.5.m5.2.2.1.1.1.1.cmml" xref="S3.SS2.p1.5.m5.2.2.1.1.1">subscript</csymbol><ci id="S3.SS2.p1.5.m5.2.2.1.1.1.2.cmml" xref="S3.SS2.p1.5.m5.2.2.1.1.1.2">ℎ</ci><ci id="S3.SS2.p1.5.m5.2.2.1.1.1.3a.cmml" xref="S3.SS2.p1.5.m5.2.2.1.1.1.3"><mtext id="S3.SS2.p1.5.m5.2.2.1.1.1.3.cmml" mathsize="70%" xref="S3.SS2.p1.5.m5.2.2.1.1.1.3">CLS</mtext></ci></apply><apply id="S3.SS2.p1.5.m5.3.3.2.2.2.cmml" xref="S3.SS2.p1.5.m5.3.3.2.2.2"><csymbol cd="ambiguous" id="S3.SS2.p1.5.m5.3.3.2.2.2.1.cmml" xref="S3.SS2.p1.5.m5.3.3.2.2.2">subscript</csymbol><ci id="S3.SS2.p1.5.m5.3.3.2.2.2.2.cmml" xref="S3.SS2.p1.5.m5.3.3.2.2.2.2">ℎ</ci><cn id="S3.SS2.p1.5.m5.3.3.2.2.2.3.cmml" type="integer" xref="S3.SS2.p1.5.m5.3.3.2.2.2.3">1</cn></apply><apply id="S3.SS2.p1.5.m5.4.4.3.3.3.cmml" xref="S3.SS2.p1.5.m5.4.4.3.3.3"><csymbol cd="ambiguous" id="S3.SS2.p1.5.m5.4.4.3.3.3.1.cmml" xref="S3.SS2.p1.5.m5.4.4.3.3.3">subscript</csymbol><ci id="S3.SS2.p1.5.m5.4.4.3.3.3.2.cmml" xref="S3.SS2.p1.5.m5.4.4.3.3.3.2">ℎ</ci><cn id="S3.SS2.p1.5.m5.4.4.3.3.3.3.cmml" type="integer" xref="S3.SS2.p1.5.m5.4.4.3.3.3.3">2</cn></apply><ci id="S3.SS2.p1.5.m5.1.1.cmml" xref="S3.SS2.p1.5.m5.1.1">…</ci><apply id="S3.SS2.p1.5.m5.5.5.4.4.4.cmml" xref="S3.SS2.p1.5.m5.5.5.4.4.4"><csymbol cd="ambiguous" id="S3.SS2.p1.5.m5.5.5.4.4.4.1.cmml" xref="S3.SS2.p1.5.m5.5.5.4.4.4">subscript</csymbol><ci id="S3.SS2.p1.5.m5.5.5.4.4.4.2.cmml" xref="S3.SS2.p1.5.m5.5.5.4.4.4.2">ℎ</ci><ci id="S3.SS2.p1.5.m5.5.5.4.4.4.3a.cmml" xref="S3.SS2.p1.5.m5.5.5.4.4.4.3"><mtext id="S3.SS2.p1.5.m5.5.5.4.4.4.3.cmml" mathsize="70%" xref="S3.SS2.p1.5.m5.5.5.4.4.4.3">len</mtext></ci></apply><apply id="S3.SS2.p1.5.m5.6.6.5.5.5.cmml" xref="S3.SS2.p1.5.m5.6.6.5.5.5"><csymbol cd="ambiguous" id="S3.SS2.p1.5.m5.6.6.5.5.5.1.cmml" xref="S3.SS2.p1.5.m5.6.6.5.5.5">subscript</csymbol><ci id="S3.SS2.p1.5.m5.6.6.5.5.5.2.cmml" xref="S3.SS2.p1.5.m5.6.6.5.5.5.2">ℎ</ci><ci id="S3.SS2.p1.5.m5.6.6.5.5.5.3a.cmml" xref="S3.SS2.p1.5.m5.6.6.5.5.5.3"><mtext id="S3.SS2.p1.5.m5.6.6.5.5.5.3.cmml" mathsize="70%" xref="S3.SS2.p1.5.m5.6.6.5.5.5.3">SEP</mtext></ci></apply></list></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.5.m5.6c">H=[h_{\text{CLS}},h_{1},h_{2},\ldots,h_{\text{len}},h_{\text{SEP}}]</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p1.5.m5.6d">italic_H = [ italic_h start_POSTSUBSCRIPT CLS end_POSTSUBSCRIPT , italic_h start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT , italic_h start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT , … , italic_h start_POSTSUBSCRIPT len end_POSTSUBSCRIPT , italic_h start_POSTSUBSCRIPT SEP end_POSTSUBSCRIPT ]</annotation></semantics></math> where <math alttext="h_{\text{CLS}}" class="ltx_Math" display="inline" id="S3.SS2.p1.6.m6.1"><semantics id="S3.SS2.p1.6.m6.1a"><msub id="S3.SS2.p1.6.m6.1.1" xref="S3.SS2.p1.6.m6.1.1.cmml"><mi id="S3.SS2.p1.6.m6.1.1.2" xref="S3.SS2.p1.6.m6.1.1.2.cmml">h</mi><mtext id="S3.SS2.p1.6.m6.1.1.3" xref="S3.SS2.p1.6.m6.1.1.3a.cmml">CLS</mtext></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.6.m6.1b"><apply id="S3.SS2.p1.6.m6.1.1.cmml" xref="S3.SS2.p1.6.m6.1.1"><csymbol cd="ambiguous" id="S3.SS2.p1.6.m6.1.1.1.cmml" xref="S3.SS2.p1.6.m6.1.1">subscript</csymbol><ci id="S3.SS2.p1.6.m6.1.1.2.cmml" xref="S3.SS2.p1.6.m6.1.1.2">ℎ</ci><ci id="S3.SS2.p1.6.m6.1.1.3a.cmml" xref="S3.SS2.p1.6.m6.1.1.3"><mtext id="S3.SS2.p1.6.m6.1.1.3.cmml" mathsize="70%" xref="S3.SS2.p1.6.m6.1.1.3">CLS</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.6.m6.1c">h_{\text{CLS}}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p1.6.m6.1d">italic_h start_POSTSUBSCRIPT CLS end_POSTSUBSCRIPT</annotation></semantics></math> and <math alttext="h_{\text{SEP}}" class="ltx_Math" display="inline" id="S3.SS2.p1.7.m7.1"><semantics id="S3.SS2.p1.7.m7.1a"><msub id="S3.SS2.p1.7.m7.1.1" xref="S3.SS2.p1.7.m7.1.1.cmml"><mi id="S3.SS2.p1.7.m7.1.1.2" xref="S3.SS2.p1.7.m7.1.1.2.cmml">h</mi><mtext id="S3.SS2.p1.7.m7.1.1.3" xref="S3.SS2.p1.7.m7.1.1.3a.cmml">SEP</mtext></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.7.m7.1b"><apply id="S3.SS2.p1.7.m7.1.1.cmml" xref="S3.SS2.p1.7.m7.1.1"><csymbol cd="ambiguous" id="S3.SS2.p1.7.m7.1.1.1.cmml" xref="S3.SS2.p1.7.m7.1.1">subscript</csymbol><ci id="S3.SS2.p1.7.m7.1.1.2.cmml" xref="S3.SS2.p1.7.m7.1.1.2">ℎ</ci><ci id="S3.SS2.p1.7.m7.1.1.3a.cmml" xref="S3.SS2.p1.7.m7.1.1.3"><mtext id="S3.SS2.p1.7.m7.1.1.3.cmml" mathsize="70%" xref="S3.SS2.p1.7.m7.1.1.3">SEP</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.7.m7.1c">h_{\text{SEP}}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p1.7.m7.1d">italic_h start_POSTSUBSCRIPT SEP end_POSTSUBSCRIPT</annotation></semantics></math> are the hidden value of <math alttext="h_{\text{CLS}}" class="ltx_Math" display="inline" id="S3.SS2.p1.8.m8.1"><semantics id="S3.SS2.p1.8.m8.1a"><msub id="S3.SS2.p1.8.m8.1.1" xref="S3.SS2.p1.8.m8.1.1.cmml"><mi id="S3.SS2.p1.8.m8.1.1.2" xref="S3.SS2.p1.8.m8.1.1.2.cmml">h</mi><mtext id="S3.SS2.p1.8.m8.1.1.3" xref="S3.SS2.p1.8.m8.1.1.3a.cmml">CLS</mtext></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.8.m8.1b"><apply id="S3.SS2.p1.8.m8.1.1.cmml" xref="S3.SS2.p1.8.m8.1.1"><csymbol cd="ambiguous" id="S3.SS2.p1.8.m8.1.1.1.cmml" xref="S3.SS2.p1.8.m8.1.1">subscript</csymbol><ci id="S3.SS2.p1.8.m8.1.1.2.cmml" xref="S3.SS2.p1.8.m8.1.1.2">ℎ</ci><ci id="S3.SS2.p1.8.m8.1.1.3a.cmml" xref="S3.SS2.p1.8.m8.1.1.3"><mtext id="S3.SS2.p1.8.m8.1.1.3.cmml" mathsize="70%" xref="S3.SS2.p1.8.m8.1.1.3">CLS</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.8.m8.1c">h_{\text{CLS}}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p1.8.m8.1d">italic_h start_POSTSUBSCRIPT CLS end_POSTSUBSCRIPT</annotation></semantics></math> and <math alttext="h_{\text{SEP}}" class="ltx_Math" display="inline" id="S3.SS2.p1.9.m9.1"><semantics id="S3.SS2.p1.9.m9.1a"><msub id="S3.SS2.p1.9.m9.1.1" xref="S3.SS2.p1.9.m9.1.1.cmml"><mi id="S3.SS2.p1.9.m9.1.1.2" xref="S3.SS2.p1.9.m9.1.1.2.cmml">h</mi><mtext id="S3.SS2.p1.9.m9.1.1.3" xref="S3.SS2.p1.9.m9.1.1.3a.cmml">SEP</mtext></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.9.m9.1b"><apply id="S3.SS2.p1.9.m9.1.1.cmml" xref="S3.SS2.p1.9.m9.1.1"><csymbol cd="ambiguous" id="S3.SS2.p1.9.m9.1.1.1.cmml" xref="S3.SS2.p1.9.m9.1.1">subscript</csymbol><ci id="S3.SS2.p1.9.m9.1.1.2.cmml" xref="S3.SS2.p1.9.m9.1.1.2">ℎ</ci><ci id="S3.SS2.p1.9.m9.1.1.3a.cmml" xref="S3.SS2.p1.9.m9.1.1.3"><mtext id="S3.SS2.p1.9.m9.1.1.3.cmml" mathsize="70%" xref="S3.SS2.p1.9.m9.1.1.3">SEP</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.9.m9.1c">h_{\text{SEP}}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p1.9.m9.1d">italic_h start_POSTSUBSCRIPT SEP end_POSTSUBSCRIPT</annotation></semantics></math>. For the matrix <math alttext="H" class="ltx_Math" display="inline" id="S3.SS2.p1.10.m10.1"><semantics id="S3.SS2.p1.10.m10.1a"><mi id="S3.SS2.p1.10.m10.1.1" xref="S3.SS2.p1.10.m10.1.1.cmml">H</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.10.m10.1b"><ci id="S3.SS2.p1.10.m10.1.1.cmml" xref="S3.SS2.p1.10.m10.1.1">𝐻</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.10.m10.1c">H</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p1.10.m10.1d">italic_H</annotation></semantics></math>, its dimension is <math alttext="[768,\text{len}+2]" class="ltx_Math" display="inline" id="S3.SS2.p1.11.m11.2"><semantics id="S3.SS2.p1.11.m11.2a"><mrow id="S3.SS2.p1.11.m11.2.2.1" xref="S3.SS2.p1.11.m11.2.2.2.cmml"><mo id="S3.SS2.p1.11.m11.2.2.1.2" stretchy="false" xref="S3.SS2.p1.11.m11.2.2.2.cmml">[</mo><mn id="S3.SS2.p1.11.m11.1.1" xref="S3.SS2.p1.11.m11.1.1.cmml">768</mn><mo id="S3.SS2.p1.11.m11.2.2.1.3" xref="S3.SS2.p1.11.m11.2.2.2.cmml">,</mo><mrow id="S3.SS2.p1.11.m11.2.2.1.1" xref="S3.SS2.p1.11.m11.2.2.1.1.cmml"><mtext id="S3.SS2.p1.11.m11.2.2.1.1.2" xref="S3.SS2.p1.11.m11.2.2.1.1.2a.cmml">len</mtext><mo id="S3.SS2.p1.11.m11.2.2.1.1.1" xref="S3.SS2.p1.11.m11.2.2.1.1.1.cmml">+</mo><mn id="S3.SS2.p1.11.m11.2.2.1.1.3" xref="S3.SS2.p1.11.m11.2.2.1.1.3.cmml">2</mn></mrow><mo id="S3.SS2.p1.11.m11.2.2.1.4" stretchy="false" xref="S3.SS2.p1.11.m11.2.2.2.cmml">]</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.11.m11.2b"><interval closure="closed" id="S3.SS2.p1.11.m11.2.2.2.cmml" xref="S3.SS2.p1.11.m11.2.2.1"><cn id="S3.SS2.p1.11.m11.1.1.cmml" type="integer" xref="S3.SS2.p1.11.m11.1.1">768</cn><apply id="S3.SS2.p1.11.m11.2.2.1.1.cmml" xref="S3.SS2.p1.11.m11.2.2.1.1"><plus id="S3.SS2.p1.11.m11.2.2.1.1.1.cmml" xref="S3.SS2.p1.11.m11.2.2.1.1.1"></plus><ci id="S3.SS2.p1.11.m11.2.2.1.1.2a.cmml" xref="S3.SS2.p1.11.m11.2.2.1.1.2"><mtext id="S3.SS2.p1.11.m11.2.2.1.1.2.cmml" xref="S3.SS2.p1.11.m11.2.2.1.1.2">len</mtext></ci><cn id="S3.SS2.p1.11.m11.2.2.1.1.3.cmml" type="integer" xref="S3.SS2.p1.11.m11.2.2.1.1.3">2</cn></apply></interval></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.11.m11.2c">[768,\text{len}+2]</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p1.11.m11.2d">[ 768 , len + 2 ]</annotation></semantics></math>, where 768 is the dimension of the encoded output of the BERT model for each Token. We extract <math alttext="h_{\text{CLS}}" class="ltx_Math" display="inline" id="S3.SS2.p1.12.m12.1"><semantics id="S3.SS2.p1.12.m12.1a"><msub id="S3.SS2.p1.12.m12.1.1" xref="S3.SS2.p1.12.m12.1.1.cmml"><mi id="S3.SS2.p1.12.m12.1.1.2" xref="S3.SS2.p1.12.m12.1.1.2.cmml">h</mi><mtext id="S3.SS2.p1.12.m12.1.1.3" xref="S3.SS2.p1.12.m12.1.1.3a.cmml">CLS</mtext></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.12.m12.1b"><apply id="S3.SS2.p1.12.m12.1.1.cmml" xref="S3.SS2.p1.12.m12.1.1"><csymbol cd="ambiguous" id="S3.SS2.p1.12.m12.1.1.1.cmml" xref="S3.SS2.p1.12.m12.1.1">subscript</csymbol><ci id="S3.SS2.p1.12.m12.1.1.2.cmml" xref="S3.SS2.p1.12.m12.1.1.2">ℎ</ci><ci id="S3.SS2.p1.12.m12.1.1.3a.cmml" xref="S3.SS2.p1.12.m12.1.1.3"><mtext id="S3.SS2.p1.12.m12.1.1.3.cmml" mathsize="70%" xref="S3.SS2.p1.12.m12.1.1.3">CLS</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.12.m12.1c">h_{\text{CLS}}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p1.12.m12.1d">italic_h start_POSTSUBSCRIPT CLS end_POSTSUBSCRIPT</annotation></semantics></math> as the representation of the whole sequence semantics, its dimension is 768 in our research. Its flow is shown in Figure <a class="ltx_ref" href="https://arxiv.org/html/2407.09157v1#S3.F2" title="Figure 2 ‣ 3.2 Textual feature extractor ‣ 3 Methodology ‣ Movie Recommendation with Poster Attention via Multi-modal Transformer Feature Fusion"><span class="ltx_text ltx_ref_tag">2</span></a>.</p>
</div>
<figure class="ltx_figure" id="S3.F2"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="283" id="S3.F2.g1" src="extracted/5727377/img/bert_1.jpg" width="419"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 2: </span>Feature extraction process of BERT model in our research, the dimension of BERT’s out put is 768.</figcaption>
</figure>
<div class="ltx_para" id="S3.SS2.p2">
<ol class="ltx_enumerate" id="S3.I1">
<li class="ltx_item" id="S3.I1.i1" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">1.</span>
<div class="ltx_para" id="S3.I1.i1.p1">
<p class="ltx_p" id="S3.I1.i1.p1.1"><span class="ltx_text ltx_font_bold" id="S3.I1.i1.p1.1.1">Global context integration: </span>the first token in BERT model interacts attentively with other tokens in the whole sequence during the process of multi-head self-attention computation, so that it can learn the global information of the whole sequence.</p>
</div>
</li>
<li class="ltx_item" id="S3.I1.i2" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">2.</span>
<div class="ltx_para" id="S3.I1.i2.p1">
<p class="ltx_p" id="S3.I1.i2.p1.2"><span class="ltx_text ltx_font_bold" id="S3.I1.i2.p1.2.1">Special pre-trained task: </span>the pre-trained task of the BERT model consists of two stages, one is the Masked Language Model (MLM) and the other is the Next Sentence Prediction (NSP) <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2407.09157v1#bib.bib59" title="">59</a>]</cite>. In the NSP task, the BERT model needs to determine whether two sentences are contextual or not, and this process requires <math alttext="h_{CLS}" class="ltx_Math" display="inline" id="S3.I1.i2.p1.1.m1.1"><semantics id="S3.I1.i2.p1.1.m1.1a"><msub id="S3.I1.i2.p1.1.m1.1.1" xref="S3.I1.i2.p1.1.m1.1.1.cmml"><mi id="S3.I1.i2.p1.1.m1.1.1.2" xref="S3.I1.i2.p1.1.m1.1.1.2.cmml">h</mi><mrow id="S3.I1.i2.p1.1.m1.1.1.3" xref="S3.I1.i2.p1.1.m1.1.1.3.cmml"><mi id="S3.I1.i2.p1.1.m1.1.1.3.2" xref="S3.I1.i2.p1.1.m1.1.1.3.2.cmml">C</mi><mo id="S3.I1.i2.p1.1.m1.1.1.3.1" xref="S3.I1.i2.p1.1.m1.1.1.3.1.cmml">⁢</mo><mi id="S3.I1.i2.p1.1.m1.1.1.3.3" xref="S3.I1.i2.p1.1.m1.1.1.3.3.cmml">L</mi><mo id="S3.I1.i2.p1.1.m1.1.1.3.1a" xref="S3.I1.i2.p1.1.m1.1.1.3.1.cmml">⁢</mo><mi id="S3.I1.i2.p1.1.m1.1.1.3.4" xref="S3.I1.i2.p1.1.m1.1.1.3.4.cmml">S</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S3.I1.i2.p1.1.m1.1b"><apply id="S3.I1.i2.p1.1.m1.1.1.cmml" xref="S3.I1.i2.p1.1.m1.1.1"><csymbol cd="ambiguous" id="S3.I1.i2.p1.1.m1.1.1.1.cmml" xref="S3.I1.i2.p1.1.m1.1.1">subscript</csymbol><ci id="S3.I1.i2.p1.1.m1.1.1.2.cmml" xref="S3.I1.i2.p1.1.m1.1.1.2">ℎ</ci><apply id="S3.I1.i2.p1.1.m1.1.1.3.cmml" xref="S3.I1.i2.p1.1.m1.1.1.3"><times id="S3.I1.i2.p1.1.m1.1.1.3.1.cmml" xref="S3.I1.i2.p1.1.m1.1.1.3.1"></times><ci id="S3.I1.i2.p1.1.m1.1.1.3.2.cmml" xref="S3.I1.i2.p1.1.m1.1.1.3.2">𝐶</ci><ci id="S3.I1.i2.p1.1.m1.1.1.3.3.cmml" xref="S3.I1.i2.p1.1.m1.1.1.3.3">𝐿</ci><ci id="S3.I1.i2.p1.1.m1.1.1.3.4.cmml" xref="S3.I1.i2.p1.1.m1.1.1.3.4">𝑆</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.I1.i2.p1.1.m1.1c">h_{CLS}</annotation><annotation encoding="application/x-llamapun" id="S3.I1.i2.p1.1.m1.1d">italic_h start_POSTSUBSCRIPT italic_C italic_L italic_S end_POSTSUBSCRIPT</annotation></semantics></math> as the semantic representation for downstream judgment, which makes the BERT model give <math alttext="h_{CLS}" class="ltx_Math" display="inline" id="S3.I1.i2.p1.2.m2.1"><semantics id="S3.I1.i2.p1.2.m2.1a"><msub id="S3.I1.i2.p1.2.m2.1.1" xref="S3.I1.i2.p1.2.m2.1.1.cmml"><mi id="S3.I1.i2.p1.2.m2.1.1.2" xref="S3.I1.i2.p1.2.m2.1.1.2.cmml">h</mi><mrow id="S3.I1.i2.p1.2.m2.1.1.3" xref="S3.I1.i2.p1.2.m2.1.1.3.cmml"><mi id="S3.I1.i2.p1.2.m2.1.1.3.2" xref="S3.I1.i2.p1.2.m2.1.1.3.2.cmml">C</mi><mo id="S3.I1.i2.p1.2.m2.1.1.3.1" xref="S3.I1.i2.p1.2.m2.1.1.3.1.cmml">⁢</mo><mi id="S3.I1.i2.p1.2.m2.1.1.3.3" xref="S3.I1.i2.p1.2.m2.1.1.3.3.cmml">L</mi><mo id="S3.I1.i2.p1.2.m2.1.1.3.1a" xref="S3.I1.i2.p1.2.m2.1.1.3.1.cmml">⁢</mo><mi id="S3.I1.i2.p1.2.m2.1.1.3.4" xref="S3.I1.i2.p1.2.m2.1.1.3.4.cmml">S</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S3.I1.i2.p1.2.m2.1b"><apply id="S3.I1.i2.p1.2.m2.1.1.cmml" xref="S3.I1.i2.p1.2.m2.1.1"><csymbol cd="ambiguous" id="S3.I1.i2.p1.2.m2.1.1.1.cmml" xref="S3.I1.i2.p1.2.m2.1.1">subscript</csymbol><ci id="S3.I1.i2.p1.2.m2.1.1.2.cmml" xref="S3.I1.i2.p1.2.m2.1.1.2">ℎ</ci><apply id="S3.I1.i2.p1.2.m2.1.1.3.cmml" xref="S3.I1.i2.p1.2.m2.1.1.3"><times id="S3.I1.i2.p1.2.m2.1.1.3.1.cmml" xref="S3.I1.i2.p1.2.m2.1.1.3.1"></times><ci id="S3.I1.i2.p1.2.m2.1.1.3.2.cmml" xref="S3.I1.i2.p1.2.m2.1.1.3.2">𝐶</ci><ci id="S3.I1.i2.p1.2.m2.1.1.3.3.cmml" xref="S3.I1.i2.p1.2.m2.1.1.3.3">𝐿</ci><ci id="S3.I1.i2.p1.2.m2.1.1.3.4.cmml" xref="S3.I1.i2.p1.2.m2.1.1.3.4">𝑆</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.I1.i2.p1.2.m2.1c">h_{CLS}</annotation><annotation encoding="application/x-llamapun" id="S3.I1.i2.p1.2.m2.1d">italic_h start_POSTSUBSCRIPT italic_C italic_L italic_S end_POSTSUBSCRIPT</annotation></semantics></math> the function of learning the semantics of the whole sequence during the pre-training process.</p>
</div>
</li>
</ol>
</div>
<div class="ltx_para" id="S3.SS2.p3">
<p class="ltx_p" id="S3.SS2.p3.1">Through these mechanisms, <math alttext="h_{CLS}" class="ltx_Math" display="inline" id="S3.SS2.p3.1.m1.1"><semantics id="S3.SS2.p3.1.m1.1a"><msub id="S3.SS2.p3.1.m1.1.1" xref="S3.SS2.p3.1.m1.1.1.cmml"><mi id="S3.SS2.p3.1.m1.1.1.2" xref="S3.SS2.p3.1.m1.1.1.2.cmml">h</mi><mrow id="S3.SS2.p3.1.m1.1.1.3" xref="S3.SS2.p3.1.m1.1.1.3.cmml"><mi id="S3.SS2.p3.1.m1.1.1.3.2" xref="S3.SS2.p3.1.m1.1.1.3.2.cmml">C</mi><mo id="S3.SS2.p3.1.m1.1.1.3.1" xref="S3.SS2.p3.1.m1.1.1.3.1.cmml">⁢</mo><mi id="S3.SS2.p3.1.m1.1.1.3.3" xref="S3.SS2.p3.1.m1.1.1.3.3.cmml">L</mi><mo id="S3.SS2.p3.1.m1.1.1.3.1a" xref="S3.SS2.p3.1.m1.1.1.3.1.cmml">⁢</mo><mi id="S3.SS2.p3.1.m1.1.1.3.4" xref="S3.SS2.p3.1.m1.1.1.3.4.cmml">S</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.p3.1.m1.1b"><apply id="S3.SS2.p3.1.m1.1.1.cmml" xref="S3.SS2.p3.1.m1.1.1"><csymbol cd="ambiguous" id="S3.SS2.p3.1.m1.1.1.1.cmml" xref="S3.SS2.p3.1.m1.1.1">subscript</csymbol><ci id="S3.SS2.p3.1.m1.1.1.2.cmml" xref="S3.SS2.p3.1.m1.1.1.2">ℎ</ci><apply id="S3.SS2.p3.1.m1.1.1.3.cmml" xref="S3.SS2.p3.1.m1.1.1.3"><times id="S3.SS2.p3.1.m1.1.1.3.1.cmml" xref="S3.SS2.p3.1.m1.1.1.3.1"></times><ci id="S3.SS2.p3.1.m1.1.1.3.2.cmml" xref="S3.SS2.p3.1.m1.1.1.3.2">𝐶</ci><ci id="S3.SS2.p3.1.m1.1.1.3.3.cmml" xref="S3.SS2.p3.1.m1.1.1.3.3">𝐿</ci><ci id="S3.SS2.p3.1.m1.1.1.3.4.cmml" xref="S3.SS2.p3.1.m1.1.1.3.4">𝑆</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p3.1.m1.1c">h_{CLS}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.p3.1.m1.1d">italic_h start_POSTSUBSCRIPT italic_C italic_L italic_S end_POSTSUBSCRIPT</annotation></semantics></math> can capture the global semantic information of the input text and provide strong support in a variety of downstream tasks.</p>
</div>
</section>
<section class="ltx_subsection" id="S3.SS3">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.3 </span>Image feature extractor</h3>
<div class="ltx_para" id="S3.SS3.p1">
<p class="ltx_p" id="S3.SS3.p1.4">For image modal features, we perform feature extraction using Vision Transformer (ViT), model that utilizes the Transformer architecture for image feature extraction. In contrast to traditional convolutional neural networks (e.g., VGGNet and ResNet), the input to ViT is not a complete matrix of pixels, but rather the image is sliced into fixed-size patches, each of which is flattened and mapped to a high-dimensional space by a linear link to form a vector representation. Assuming that the original length and width of an image are <math alttext="H" class="ltx_Math" display="inline" id="S3.SS3.p1.1.m1.1"><semantics id="S3.SS3.p1.1.m1.1a"><mi id="S3.SS3.p1.1.m1.1.1" xref="S3.SS3.p1.1.m1.1.1.cmml">H</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.p1.1.m1.1b"><ci id="S3.SS3.p1.1.m1.1.1.cmml" xref="S3.SS3.p1.1.m1.1.1">𝐻</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p1.1.m1.1c">H</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p1.1.m1.1d">italic_H</annotation></semantics></math> and <math alttext="W" class="ltx_Math" display="inline" id="S3.SS3.p1.2.m2.1"><semantics id="S3.SS3.p1.2.m2.1a"><mi id="S3.SS3.p1.2.m2.1.1" xref="S3.SS3.p1.2.m2.1.1.cmml">W</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.p1.2.m2.1b"><ci id="S3.SS3.p1.2.m2.1.1.cmml" xref="S3.SS3.p1.2.m2.1.1">𝑊</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p1.2.m2.1c">W</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p1.2.m2.1d">italic_W</annotation></semantics></math> respectively, the image will be cut into <math alttext="P\times P" class="ltx_Math" display="inline" id="S3.SS3.p1.3.m3.1"><semantics id="S3.SS3.p1.3.m3.1a"><mrow id="S3.SS3.p1.3.m3.1.1" xref="S3.SS3.p1.3.m3.1.1.cmml"><mi id="S3.SS3.p1.3.m3.1.1.2" xref="S3.SS3.p1.3.m3.1.1.2.cmml">P</mi><mo id="S3.SS3.p1.3.m3.1.1.1" lspace="0.222em" rspace="0.222em" xref="S3.SS3.p1.3.m3.1.1.1.cmml">×</mo><mi id="S3.SS3.p1.3.m3.1.1.3" xref="S3.SS3.p1.3.m3.1.1.3.cmml">P</mi></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.p1.3.m3.1b"><apply id="S3.SS3.p1.3.m3.1.1.cmml" xref="S3.SS3.p1.3.m3.1.1"><times id="S3.SS3.p1.3.m3.1.1.1.cmml" xref="S3.SS3.p1.3.m3.1.1.1"></times><ci id="S3.SS3.p1.3.m3.1.1.2.cmml" xref="S3.SS3.p1.3.m3.1.1.2">𝑃</ci><ci id="S3.SS3.p1.3.m3.1.1.3.cmml" xref="S3.SS3.p1.3.m3.1.1.3">𝑃</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p1.3.m3.1c">P\times P</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p1.3.m3.1d">italic_P × italic_P</annotation></semantics></math> patches, each of which has a size of <math alttext="\frac{H\times W}{P^{2}}" class="ltx_Math" display="inline" id="S3.SS3.p1.4.m4.1"><semantics id="S3.SS3.p1.4.m4.1a"><mfrac id="S3.SS3.p1.4.m4.1.1" xref="S3.SS3.p1.4.m4.1.1.cmml"><mrow id="S3.SS3.p1.4.m4.1.1.2" xref="S3.SS3.p1.4.m4.1.1.2.cmml"><mi id="S3.SS3.p1.4.m4.1.1.2.2" xref="S3.SS3.p1.4.m4.1.1.2.2.cmml">H</mi><mo id="S3.SS3.p1.4.m4.1.1.2.1" lspace="0.222em" rspace="0.222em" xref="S3.SS3.p1.4.m4.1.1.2.1.cmml">×</mo><mi id="S3.SS3.p1.4.m4.1.1.2.3" xref="S3.SS3.p1.4.m4.1.1.2.3.cmml">W</mi></mrow><msup id="S3.SS3.p1.4.m4.1.1.3" xref="S3.SS3.p1.4.m4.1.1.3.cmml"><mi id="S3.SS3.p1.4.m4.1.1.3.2" xref="S3.SS3.p1.4.m4.1.1.3.2.cmml">P</mi><mn id="S3.SS3.p1.4.m4.1.1.3.3" xref="S3.SS3.p1.4.m4.1.1.3.3.cmml">2</mn></msup></mfrac><annotation-xml encoding="MathML-Content" id="S3.SS3.p1.4.m4.1b"><apply id="S3.SS3.p1.4.m4.1.1.cmml" xref="S3.SS3.p1.4.m4.1.1"><divide id="S3.SS3.p1.4.m4.1.1.1.cmml" xref="S3.SS3.p1.4.m4.1.1"></divide><apply id="S3.SS3.p1.4.m4.1.1.2.cmml" xref="S3.SS3.p1.4.m4.1.1.2"><times id="S3.SS3.p1.4.m4.1.1.2.1.cmml" xref="S3.SS3.p1.4.m4.1.1.2.1"></times><ci id="S3.SS3.p1.4.m4.1.1.2.2.cmml" xref="S3.SS3.p1.4.m4.1.1.2.2">𝐻</ci><ci id="S3.SS3.p1.4.m4.1.1.2.3.cmml" xref="S3.SS3.p1.4.m4.1.1.2.3">𝑊</ci></apply><apply id="S3.SS3.p1.4.m4.1.1.3.cmml" xref="S3.SS3.p1.4.m4.1.1.3"><csymbol cd="ambiguous" id="S3.SS3.p1.4.m4.1.1.3.1.cmml" xref="S3.SS3.p1.4.m4.1.1.3">superscript</csymbol><ci id="S3.SS3.p1.4.m4.1.1.3.2.cmml" xref="S3.SS3.p1.4.m4.1.1.3.2">𝑃</ci><cn id="S3.SS3.p1.4.m4.1.1.3.3.cmml" type="integer" xref="S3.SS3.p1.4.m4.1.1.3.3">2</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p1.4.m4.1c">\frac{H\times W}{P^{2}}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p1.4.m4.1d">divide start_ARG italic_H × italic_W end_ARG start_ARG italic_P start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT end_ARG</annotation></semantics></math>.</p>
</div>
<div class="ltx_para" id="S3.SS3.p2">
<p class="ltx_p" id="S3.SS3.p2.1">The calculation process of linear transform is shown as:</p>
</div>
<div class="ltx_para" id="S3.SS3.p3">
<table class="ltx_equation ltx_eqn_table" id="S3.E1">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_left_padleft"></td>
<td class="ltx_eqn_cell ltx_align_left"><math alttext="x_{p}^{i}=\text{Linear}\left(x_{\text{patch}}^{i}\right)," class="ltx_Math" display="block" id="S3.E1.m1.1"><semantics id="S3.E1.m1.1a"><mrow id="S3.E1.m1.1.1.1" xref="S3.E1.m1.1.1.1.1.cmml"><mrow id="S3.E1.m1.1.1.1.1" xref="S3.E1.m1.1.1.1.1.cmml"><msubsup id="S3.E1.m1.1.1.1.1.3" xref="S3.E1.m1.1.1.1.1.3.cmml"><mi id="S3.E1.m1.1.1.1.1.3.2.2" xref="S3.E1.m1.1.1.1.1.3.2.2.cmml">x</mi><mi id="S3.E1.m1.1.1.1.1.3.2.3" xref="S3.E1.m1.1.1.1.1.3.2.3.cmml">p</mi><mi id="S3.E1.m1.1.1.1.1.3.3" xref="S3.E1.m1.1.1.1.1.3.3.cmml">i</mi></msubsup><mo id="S3.E1.m1.1.1.1.1.2" xref="S3.E1.m1.1.1.1.1.2.cmml">=</mo><mrow id="S3.E1.m1.1.1.1.1.1" xref="S3.E1.m1.1.1.1.1.1.cmml"><mtext id="S3.E1.m1.1.1.1.1.1.3" xref="S3.E1.m1.1.1.1.1.1.3a.cmml">Linear</mtext><mo id="S3.E1.m1.1.1.1.1.1.2" xref="S3.E1.m1.1.1.1.1.1.2.cmml">⁢</mo><mrow id="S3.E1.m1.1.1.1.1.1.1.1" xref="S3.E1.m1.1.1.1.1.1.1.1.1.cmml"><mo id="S3.E1.m1.1.1.1.1.1.1.1.2" xref="S3.E1.m1.1.1.1.1.1.1.1.1.cmml">(</mo><msubsup id="S3.E1.m1.1.1.1.1.1.1.1.1" xref="S3.E1.m1.1.1.1.1.1.1.1.1.cmml"><mi id="S3.E1.m1.1.1.1.1.1.1.1.1.2.2" xref="S3.E1.m1.1.1.1.1.1.1.1.1.2.2.cmml">x</mi><mtext id="S3.E1.m1.1.1.1.1.1.1.1.1.2.3" xref="S3.E1.m1.1.1.1.1.1.1.1.1.2.3a.cmml">patch</mtext><mi id="S3.E1.m1.1.1.1.1.1.1.1.1.3" xref="S3.E1.m1.1.1.1.1.1.1.1.1.3.cmml">i</mi></msubsup><mo id="S3.E1.m1.1.1.1.1.1.1.1.3" xref="S3.E1.m1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><mo id="S3.E1.m1.1.1.1.2" xref="S3.E1.m1.1.1.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E1.m1.1b"><apply id="S3.E1.m1.1.1.1.1.cmml" xref="S3.E1.m1.1.1.1"><eq id="S3.E1.m1.1.1.1.1.2.cmml" xref="S3.E1.m1.1.1.1.1.2"></eq><apply id="S3.E1.m1.1.1.1.1.3.cmml" xref="S3.E1.m1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.E1.m1.1.1.1.1.3.1.cmml" xref="S3.E1.m1.1.1.1.1.3">superscript</csymbol><apply id="S3.E1.m1.1.1.1.1.3.2.cmml" xref="S3.E1.m1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.E1.m1.1.1.1.1.3.2.1.cmml" xref="S3.E1.m1.1.1.1.1.3">subscript</csymbol><ci id="S3.E1.m1.1.1.1.1.3.2.2.cmml" xref="S3.E1.m1.1.1.1.1.3.2.2">𝑥</ci><ci id="S3.E1.m1.1.1.1.1.3.2.3.cmml" xref="S3.E1.m1.1.1.1.1.3.2.3">𝑝</ci></apply><ci id="S3.E1.m1.1.1.1.1.3.3.cmml" xref="S3.E1.m1.1.1.1.1.3.3">𝑖</ci></apply><apply id="S3.E1.m1.1.1.1.1.1.cmml" xref="S3.E1.m1.1.1.1.1.1"><times id="S3.E1.m1.1.1.1.1.1.2.cmml" xref="S3.E1.m1.1.1.1.1.1.2"></times><ci id="S3.E1.m1.1.1.1.1.1.3a.cmml" xref="S3.E1.m1.1.1.1.1.1.3"><mtext id="S3.E1.m1.1.1.1.1.1.3.cmml" xref="S3.E1.m1.1.1.1.1.1.3">Linear</mtext></ci><apply id="S3.E1.m1.1.1.1.1.1.1.1.1.cmml" xref="S3.E1.m1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E1.m1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E1.m1.1.1.1.1.1.1.1">superscript</csymbol><apply id="S3.E1.m1.1.1.1.1.1.1.1.1.2.cmml" xref="S3.E1.m1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E1.m1.1.1.1.1.1.1.1.1.2.1.cmml" xref="S3.E1.m1.1.1.1.1.1.1.1">subscript</csymbol><ci id="S3.E1.m1.1.1.1.1.1.1.1.1.2.2.cmml" xref="S3.E1.m1.1.1.1.1.1.1.1.1.2.2">𝑥</ci><ci id="S3.E1.m1.1.1.1.1.1.1.1.1.2.3a.cmml" xref="S3.E1.m1.1.1.1.1.1.1.1.1.2.3"><mtext id="S3.E1.m1.1.1.1.1.1.1.1.1.2.3.cmml" mathsize="70%" xref="S3.E1.m1.1.1.1.1.1.1.1.1.2.3">patch</mtext></ci></apply><ci id="S3.E1.m1.1.1.1.1.1.1.1.1.3.cmml" xref="S3.E1.m1.1.1.1.1.1.1.1.1.3">𝑖</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E1.m1.1c">x_{p}^{i}=\text{Linear}\left(x_{\text{patch}}^{i}\right),</annotation><annotation encoding="application/x-llamapun" id="S3.E1.m1.1d">italic_x start_POSTSUBSCRIPT italic_p end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_i end_POSTSUPERSCRIPT = Linear ( italic_x start_POSTSUBSCRIPT patch end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_i end_POSTSUPERSCRIPT ) ,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_left_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(1)</span></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S3.SS3.p3.3">where <math alttext="x_{\text{patch}}^{i}" class="ltx_Math" display="inline" id="S3.SS3.p3.1.m1.1"><semantics id="S3.SS3.p3.1.m1.1a"><msubsup id="S3.SS3.p3.1.m1.1.1" xref="S3.SS3.p3.1.m1.1.1.cmml"><mi id="S3.SS3.p3.1.m1.1.1.2.2" xref="S3.SS3.p3.1.m1.1.1.2.2.cmml">x</mi><mtext id="S3.SS3.p3.1.m1.1.1.2.3" xref="S3.SS3.p3.1.m1.1.1.2.3a.cmml">patch</mtext><mi id="S3.SS3.p3.1.m1.1.1.3" xref="S3.SS3.p3.1.m1.1.1.3.cmml">i</mi></msubsup><annotation-xml encoding="MathML-Content" id="S3.SS3.p3.1.m1.1b"><apply id="S3.SS3.p3.1.m1.1.1.cmml" xref="S3.SS3.p3.1.m1.1.1"><csymbol cd="ambiguous" id="S3.SS3.p3.1.m1.1.1.1.cmml" xref="S3.SS3.p3.1.m1.1.1">superscript</csymbol><apply id="S3.SS3.p3.1.m1.1.1.2.cmml" xref="S3.SS3.p3.1.m1.1.1"><csymbol cd="ambiguous" id="S3.SS3.p3.1.m1.1.1.2.1.cmml" xref="S3.SS3.p3.1.m1.1.1">subscript</csymbol><ci id="S3.SS3.p3.1.m1.1.1.2.2.cmml" xref="S3.SS3.p3.1.m1.1.1.2.2">𝑥</ci><ci id="S3.SS3.p3.1.m1.1.1.2.3a.cmml" xref="S3.SS3.p3.1.m1.1.1.2.3"><mtext id="S3.SS3.p3.1.m1.1.1.2.3.cmml" mathsize="70%" xref="S3.SS3.p3.1.m1.1.1.2.3">patch</mtext></ci></apply><ci id="S3.SS3.p3.1.m1.1.1.3.cmml" xref="S3.SS3.p3.1.m1.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p3.1.m1.1c">x_{\text{patch}}^{i}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p3.1.m1.1d">italic_x start_POSTSUBSCRIPT patch end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_i end_POSTSUPERSCRIPT</annotation></semantics></math> is <math alttext="i" class="ltx_Math" display="inline" id="S3.SS3.p3.2.m2.1"><semantics id="S3.SS3.p3.2.m2.1a"><mi id="S3.SS3.p3.2.m2.1.1" xref="S3.SS3.p3.2.m2.1.1.cmml">i</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.p3.2.m2.1b"><ci id="S3.SS3.p3.2.m2.1.1.cmml" xref="S3.SS3.p3.2.m2.1.1">𝑖</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p3.2.m2.1c">i</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p3.2.m2.1d">italic_i</annotation></semantics></math>th patch and <math alttext="x_{p}^{i}" class="ltx_Math" display="inline" id="S3.SS3.p3.3.m3.1"><semantics id="S3.SS3.p3.3.m3.1a"><msubsup id="S3.SS3.p3.3.m3.1.1" xref="S3.SS3.p3.3.m3.1.1.cmml"><mi id="S3.SS3.p3.3.m3.1.1.2.2" xref="S3.SS3.p3.3.m3.1.1.2.2.cmml">x</mi><mi id="S3.SS3.p3.3.m3.1.1.2.3" xref="S3.SS3.p3.3.m3.1.1.2.3.cmml">p</mi><mi id="S3.SS3.p3.3.m3.1.1.3" xref="S3.SS3.p3.3.m3.1.1.3.cmml">i</mi></msubsup><annotation-xml encoding="MathML-Content" id="S3.SS3.p3.3.m3.1b"><apply id="S3.SS3.p3.3.m3.1.1.cmml" xref="S3.SS3.p3.3.m3.1.1"><csymbol cd="ambiguous" id="S3.SS3.p3.3.m3.1.1.1.cmml" xref="S3.SS3.p3.3.m3.1.1">superscript</csymbol><apply id="S3.SS3.p3.3.m3.1.1.2.cmml" xref="S3.SS3.p3.3.m3.1.1"><csymbol cd="ambiguous" id="S3.SS3.p3.3.m3.1.1.2.1.cmml" xref="S3.SS3.p3.3.m3.1.1">subscript</csymbol><ci id="S3.SS3.p3.3.m3.1.1.2.2.cmml" xref="S3.SS3.p3.3.m3.1.1.2.2">𝑥</ci><ci id="S3.SS3.p3.3.m3.1.1.2.3.cmml" xref="S3.SS3.p3.3.m3.1.1.2.3">𝑝</ci></apply><ci id="S3.SS3.p3.3.m3.1.1.3.cmml" xref="S3.SS3.p3.3.m3.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p3.3.m3.1c">x_{p}^{i}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p3.3.m3.1d">italic_x start_POSTSUBSCRIPT italic_p end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_i end_POSTSUPERSCRIPT</annotation></semantics></math> is the corresponding linear representation after transformation.</p>
</div>
<div class="ltx_para" id="S3.SS3.p4">
<p class="ltx_p" id="S3.SS3.p4.1">Similar to the BERT model, ViT processes these patch vectors by adding a special classification token [CLS] in front of the sequence of these patch vectors, and the initial value of this token is a vector that can be learned during the training process. The whole input sequence can be represented as:</p>
</div>
<div class="ltx_para" id="S3.SS3.p5">
<table class="ltx_equation ltx_eqn_table" id="S3.E2">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_left_padleft"></td>
<td class="ltx_eqn_cell ltx_align_left"><math alttext="z_{0}=\left[x_{\text{CLS}};x_{p}^{1};x_{p}^{2};\ldots;x_{p}^{N}\right]+E_{%
\text{pos}}," class="ltx_Math" display="block" id="S3.E2.m1.2"><semantics id="S3.E2.m1.2a"><mrow id="S3.E2.m1.2.2.1" xref="S3.E2.m1.2.2.1.1.cmml"><mrow id="S3.E2.m1.2.2.1.1" xref="S3.E2.m1.2.2.1.1.cmml"><msub id="S3.E2.m1.2.2.1.1.6" xref="S3.E2.m1.2.2.1.1.6.cmml"><mi id="S3.E2.m1.2.2.1.1.6.2" xref="S3.E2.m1.2.2.1.1.6.2.cmml">z</mi><mn id="S3.E2.m1.2.2.1.1.6.3" xref="S3.E2.m1.2.2.1.1.6.3.cmml">0</mn></msub><mo id="S3.E2.m1.2.2.1.1.5" xref="S3.E2.m1.2.2.1.1.5.cmml">=</mo><mrow id="S3.E2.m1.2.2.1.1.4" xref="S3.E2.m1.2.2.1.1.4.cmml"><mrow id="S3.E2.m1.2.2.1.1.4.4.4" xref="S3.E2.m1.2.2.1.1.4.4.5.cmml"><mo id="S3.E2.m1.2.2.1.1.4.4.4.5" xref="S3.E2.m1.2.2.1.1.4.4.5.cmml">[</mo><msub id="S3.E2.m1.2.2.1.1.1.1.1.1" xref="S3.E2.m1.2.2.1.1.1.1.1.1.cmml"><mi id="S3.E2.m1.2.2.1.1.1.1.1.1.2" xref="S3.E2.m1.2.2.1.1.1.1.1.1.2.cmml">x</mi><mtext id="S3.E2.m1.2.2.1.1.1.1.1.1.3" xref="S3.E2.m1.2.2.1.1.1.1.1.1.3a.cmml">CLS</mtext></msub><mo id="S3.E2.m1.2.2.1.1.4.4.4.6" xref="S3.E2.m1.2.2.1.1.4.4.5.cmml">;</mo><msubsup id="S3.E2.m1.2.2.1.1.2.2.2.2" xref="S3.E2.m1.2.2.1.1.2.2.2.2.cmml"><mi id="S3.E2.m1.2.2.1.1.2.2.2.2.2.2" xref="S3.E2.m1.2.2.1.1.2.2.2.2.2.2.cmml">x</mi><mi id="S3.E2.m1.2.2.1.1.2.2.2.2.2.3" xref="S3.E2.m1.2.2.1.1.2.2.2.2.2.3.cmml">p</mi><mn id="S3.E2.m1.2.2.1.1.2.2.2.2.3" xref="S3.E2.m1.2.2.1.1.2.2.2.2.3.cmml">1</mn></msubsup><mo id="S3.E2.m1.2.2.1.1.4.4.4.7" xref="S3.E2.m1.2.2.1.1.4.4.5.cmml">;</mo><msubsup id="S3.E2.m1.2.2.1.1.3.3.3.3" xref="S3.E2.m1.2.2.1.1.3.3.3.3.cmml"><mi id="S3.E2.m1.2.2.1.1.3.3.3.3.2.2" xref="S3.E2.m1.2.2.1.1.3.3.3.3.2.2.cmml">x</mi><mi id="S3.E2.m1.2.2.1.1.3.3.3.3.2.3" xref="S3.E2.m1.2.2.1.1.3.3.3.3.2.3.cmml">p</mi><mn id="S3.E2.m1.2.2.1.1.3.3.3.3.3" xref="S3.E2.m1.2.2.1.1.3.3.3.3.3.cmml">2</mn></msubsup><mo id="S3.E2.m1.2.2.1.1.4.4.4.8" xref="S3.E2.m1.2.2.1.1.4.4.5.cmml">;</mo><mi id="S3.E2.m1.1.1" mathvariant="normal" xref="S3.E2.m1.1.1.cmml">…</mi><mo id="S3.E2.m1.2.2.1.1.4.4.4.9" xref="S3.E2.m1.2.2.1.1.4.4.5.cmml">;</mo><msubsup id="S3.E2.m1.2.2.1.1.4.4.4.4" xref="S3.E2.m1.2.2.1.1.4.4.4.4.cmml"><mi id="S3.E2.m1.2.2.1.1.4.4.4.4.2.2" xref="S3.E2.m1.2.2.1.1.4.4.4.4.2.2.cmml">x</mi><mi id="S3.E2.m1.2.2.1.1.4.4.4.4.2.3" xref="S3.E2.m1.2.2.1.1.4.4.4.4.2.3.cmml">p</mi><mi id="S3.E2.m1.2.2.1.1.4.4.4.4.3" xref="S3.E2.m1.2.2.1.1.4.4.4.4.3.cmml">N</mi></msubsup><mo id="S3.E2.m1.2.2.1.1.4.4.4.10" xref="S3.E2.m1.2.2.1.1.4.4.5.cmml">]</mo></mrow><mo id="S3.E2.m1.2.2.1.1.4.5" xref="S3.E2.m1.2.2.1.1.4.5.cmml">+</mo><msub id="S3.E2.m1.2.2.1.1.4.6" xref="S3.E2.m1.2.2.1.1.4.6.cmml"><mi id="S3.E2.m1.2.2.1.1.4.6.2" xref="S3.E2.m1.2.2.1.1.4.6.2.cmml">E</mi><mtext id="S3.E2.m1.2.2.1.1.4.6.3" xref="S3.E2.m1.2.2.1.1.4.6.3a.cmml">pos</mtext></msub></mrow></mrow><mo id="S3.E2.m1.2.2.1.2" xref="S3.E2.m1.2.2.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E2.m1.2b"><apply id="S3.E2.m1.2.2.1.1.cmml" xref="S3.E2.m1.2.2.1"><eq id="S3.E2.m1.2.2.1.1.5.cmml" xref="S3.E2.m1.2.2.1.1.5"></eq><apply id="S3.E2.m1.2.2.1.1.6.cmml" xref="S3.E2.m1.2.2.1.1.6"><csymbol cd="ambiguous" id="S3.E2.m1.2.2.1.1.6.1.cmml" xref="S3.E2.m1.2.2.1.1.6">subscript</csymbol><ci id="S3.E2.m1.2.2.1.1.6.2.cmml" xref="S3.E2.m1.2.2.1.1.6.2">𝑧</ci><cn id="S3.E2.m1.2.2.1.1.6.3.cmml" type="integer" xref="S3.E2.m1.2.2.1.1.6.3">0</cn></apply><apply id="S3.E2.m1.2.2.1.1.4.cmml" xref="S3.E2.m1.2.2.1.1.4"><plus id="S3.E2.m1.2.2.1.1.4.5.cmml" xref="S3.E2.m1.2.2.1.1.4.5"></plus><list id="S3.E2.m1.2.2.1.1.4.4.5.cmml" xref="S3.E2.m1.2.2.1.1.4.4.4"><apply id="S3.E2.m1.2.2.1.1.1.1.1.1.cmml" xref="S3.E2.m1.2.2.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E2.m1.2.2.1.1.1.1.1.1.1.cmml" xref="S3.E2.m1.2.2.1.1.1.1.1.1">subscript</csymbol><ci id="S3.E2.m1.2.2.1.1.1.1.1.1.2.cmml" xref="S3.E2.m1.2.2.1.1.1.1.1.1.2">𝑥</ci><ci id="S3.E2.m1.2.2.1.1.1.1.1.1.3a.cmml" xref="S3.E2.m1.2.2.1.1.1.1.1.1.3"><mtext id="S3.E2.m1.2.2.1.1.1.1.1.1.3.cmml" mathsize="70%" xref="S3.E2.m1.2.2.1.1.1.1.1.1.3">CLS</mtext></ci></apply><apply id="S3.E2.m1.2.2.1.1.2.2.2.2.cmml" xref="S3.E2.m1.2.2.1.1.2.2.2.2"><csymbol cd="ambiguous" id="S3.E2.m1.2.2.1.1.2.2.2.2.1.cmml" xref="S3.E2.m1.2.2.1.1.2.2.2.2">superscript</csymbol><apply id="S3.E2.m1.2.2.1.1.2.2.2.2.2.cmml" xref="S3.E2.m1.2.2.1.1.2.2.2.2"><csymbol cd="ambiguous" id="S3.E2.m1.2.2.1.1.2.2.2.2.2.1.cmml" xref="S3.E2.m1.2.2.1.1.2.2.2.2">subscript</csymbol><ci id="S3.E2.m1.2.2.1.1.2.2.2.2.2.2.cmml" xref="S3.E2.m1.2.2.1.1.2.2.2.2.2.2">𝑥</ci><ci id="S3.E2.m1.2.2.1.1.2.2.2.2.2.3.cmml" xref="S3.E2.m1.2.2.1.1.2.2.2.2.2.3">𝑝</ci></apply><cn id="S3.E2.m1.2.2.1.1.2.2.2.2.3.cmml" type="integer" xref="S3.E2.m1.2.2.1.1.2.2.2.2.3">1</cn></apply><apply id="S3.E2.m1.2.2.1.1.3.3.3.3.cmml" xref="S3.E2.m1.2.2.1.1.3.3.3.3"><csymbol cd="ambiguous" id="S3.E2.m1.2.2.1.1.3.3.3.3.1.cmml" xref="S3.E2.m1.2.2.1.1.3.3.3.3">superscript</csymbol><apply id="S3.E2.m1.2.2.1.1.3.3.3.3.2.cmml" xref="S3.E2.m1.2.2.1.1.3.3.3.3"><csymbol cd="ambiguous" id="S3.E2.m1.2.2.1.1.3.3.3.3.2.1.cmml" xref="S3.E2.m1.2.2.1.1.3.3.3.3">subscript</csymbol><ci id="S3.E2.m1.2.2.1.1.3.3.3.3.2.2.cmml" xref="S3.E2.m1.2.2.1.1.3.3.3.3.2.2">𝑥</ci><ci id="S3.E2.m1.2.2.1.1.3.3.3.3.2.3.cmml" xref="S3.E2.m1.2.2.1.1.3.3.3.3.2.3">𝑝</ci></apply><cn id="S3.E2.m1.2.2.1.1.3.3.3.3.3.cmml" type="integer" xref="S3.E2.m1.2.2.1.1.3.3.3.3.3">2</cn></apply><ci id="S3.E2.m1.1.1.cmml" xref="S3.E2.m1.1.1">…</ci><apply id="S3.E2.m1.2.2.1.1.4.4.4.4.cmml" xref="S3.E2.m1.2.2.1.1.4.4.4.4"><csymbol cd="ambiguous" id="S3.E2.m1.2.2.1.1.4.4.4.4.1.cmml" xref="S3.E2.m1.2.2.1.1.4.4.4.4">superscript</csymbol><apply id="S3.E2.m1.2.2.1.1.4.4.4.4.2.cmml" xref="S3.E2.m1.2.2.1.1.4.4.4.4"><csymbol cd="ambiguous" id="S3.E2.m1.2.2.1.1.4.4.4.4.2.1.cmml" xref="S3.E2.m1.2.2.1.1.4.4.4.4">subscript</csymbol><ci id="S3.E2.m1.2.2.1.1.4.4.4.4.2.2.cmml" xref="S3.E2.m1.2.2.1.1.4.4.4.4.2.2">𝑥</ci><ci id="S3.E2.m1.2.2.1.1.4.4.4.4.2.3.cmml" xref="S3.E2.m1.2.2.1.1.4.4.4.4.2.3">𝑝</ci></apply><ci id="S3.E2.m1.2.2.1.1.4.4.4.4.3.cmml" xref="S3.E2.m1.2.2.1.1.4.4.4.4.3">𝑁</ci></apply></list><apply id="S3.E2.m1.2.2.1.1.4.6.cmml" xref="S3.E2.m1.2.2.1.1.4.6"><csymbol cd="ambiguous" id="S3.E2.m1.2.2.1.1.4.6.1.cmml" xref="S3.E2.m1.2.2.1.1.4.6">subscript</csymbol><ci id="S3.E2.m1.2.2.1.1.4.6.2.cmml" xref="S3.E2.m1.2.2.1.1.4.6.2">𝐸</ci><ci id="S3.E2.m1.2.2.1.1.4.6.3a.cmml" xref="S3.E2.m1.2.2.1.1.4.6.3"><mtext id="S3.E2.m1.2.2.1.1.4.6.3.cmml" mathsize="70%" xref="S3.E2.m1.2.2.1.1.4.6.3">pos</mtext></ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E2.m1.2c">z_{0}=\left[x_{\text{CLS}};x_{p}^{1};x_{p}^{2};\ldots;x_{p}^{N}\right]+E_{%
\text{pos}},</annotation><annotation encoding="application/x-llamapun" id="S3.E2.m1.2d">italic_z start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT = [ italic_x start_POSTSUBSCRIPT CLS end_POSTSUBSCRIPT ; italic_x start_POSTSUBSCRIPT italic_p end_POSTSUBSCRIPT start_POSTSUPERSCRIPT 1 end_POSTSUPERSCRIPT ; italic_x start_POSTSUBSCRIPT italic_p end_POSTSUBSCRIPT start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT ; … ; italic_x start_POSTSUBSCRIPT italic_p end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_N end_POSTSUPERSCRIPT ] + italic_E start_POSTSUBSCRIPT pos end_POSTSUBSCRIPT ,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_left_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(2)</span></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S3.SS3.p5.1">where <math alttext="E_{\text{pos}}" class="ltx_Math" display="inline" id="S3.SS3.p5.1.m1.1"><semantics id="S3.SS3.p5.1.m1.1a"><msub id="S3.SS3.p5.1.m1.1.1" xref="S3.SS3.p5.1.m1.1.1.cmml"><mi id="S3.SS3.p5.1.m1.1.1.2" xref="S3.SS3.p5.1.m1.1.1.2.cmml">E</mi><mtext id="S3.SS3.p5.1.m1.1.1.3" xref="S3.SS3.p5.1.m1.1.1.3a.cmml">pos</mtext></msub><annotation-xml encoding="MathML-Content" id="S3.SS3.p5.1.m1.1b"><apply id="S3.SS3.p5.1.m1.1.1.cmml" xref="S3.SS3.p5.1.m1.1.1"><csymbol cd="ambiguous" id="S3.SS3.p5.1.m1.1.1.1.cmml" xref="S3.SS3.p5.1.m1.1.1">subscript</csymbol><ci id="S3.SS3.p5.1.m1.1.1.2.cmml" xref="S3.SS3.p5.1.m1.1.1.2">𝐸</ci><ci id="S3.SS3.p5.1.m1.1.1.3a.cmml" xref="S3.SS3.p5.1.m1.1.1.3"><mtext id="S3.SS3.p5.1.m1.1.1.3.cmml" mathsize="70%" xref="S3.SS3.p5.1.m1.1.1.3">pos</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p5.1.m1.1c">E_{\text{pos}}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p5.1.m1.1d">italic_E start_POSTSUBSCRIPT pos end_POSTSUBSCRIPT</annotation></semantics></math> is position code, which is used to retain the position information of the patch from the image.</p>
</div>
<div class="ltx_para" id="S3.SS3.p6">
<p class="ltx_p" id="S3.SS3.p6.1">After going through multiple layers of Transformer Encoder, the [CLS] token will aggregate the information of all patches and become a global representation of the entire image semantics. Eventually, the output representation of the [CLS] token is used as the semantic embedding representation of the image, which can be used for various downstream tasks, such as image classification, target detection. The formula reads as:</p>
</div>
<div class="ltx_para" id="S3.SS3.p7">
<table class="ltx_equation ltx_eqn_table" id="S3.E3">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_left_padleft"></td>
<td class="ltx_eqn_cell ltx_align_left"><math alttext="h_{\text{CLS}}^{L}=\text{Transformer Layers}(z_{0})," class="ltx_Math" display="block" id="S3.E3.m1.1"><semantics id="S3.E3.m1.1a"><mrow id="S3.E3.m1.1.1.1" xref="S3.E3.m1.1.1.1.1.cmml"><mrow id="S3.E3.m1.1.1.1.1" xref="S3.E3.m1.1.1.1.1.cmml"><msubsup id="S3.E3.m1.1.1.1.1.3" xref="S3.E3.m1.1.1.1.1.3.cmml"><mi id="S3.E3.m1.1.1.1.1.3.2.2" xref="S3.E3.m1.1.1.1.1.3.2.2.cmml">h</mi><mtext id="S3.E3.m1.1.1.1.1.3.2.3" xref="S3.E3.m1.1.1.1.1.3.2.3a.cmml">CLS</mtext><mi id="S3.E3.m1.1.1.1.1.3.3" xref="S3.E3.m1.1.1.1.1.3.3.cmml">L</mi></msubsup><mo id="S3.E3.m1.1.1.1.1.2" xref="S3.E3.m1.1.1.1.1.2.cmml">=</mo><mrow id="S3.E3.m1.1.1.1.1.1" xref="S3.E3.m1.1.1.1.1.1.cmml"><mtext id="S3.E3.m1.1.1.1.1.1.3" xref="S3.E3.m1.1.1.1.1.1.3a.cmml">Transformer Layers</mtext><mo id="S3.E3.m1.1.1.1.1.1.2" xref="S3.E3.m1.1.1.1.1.1.2.cmml">⁢</mo><mrow id="S3.E3.m1.1.1.1.1.1.1.1" xref="S3.E3.m1.1.1.1.1.1.1.1.1.cmml"><mo id="S3.E3.m1.1.1.1.1.1.1.1.2" stretchy="false" xref="S3.E3.m1.1.1.1.1.1.1.1.1.cmml">(</mo><msub id="S3.E3.m1.1.1.1.1.1.1.1.1" xref="S3.E3.m1.1.1.1.1.1.1.1.1.cmml"><mi id="S3.E3.m1.1.1.1.1.1.1.1.1.2" xref="S3.E3.m1.1.1.1.1.1.1.1.1.2.cmml">z</mi><mn id="S3.E3.m1.1.1.1.1.1.1.1.1.3" xref="S3.E3.m1.1.1.1.1.1.1.1.1.3.cmml">0</mn></msub><mo id="S3.E3.m1.1.1.1.1.1.1.1.3" stretchy="false" xref="S3.E3.m1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><mo id="S3.E3.m1.1.1.1.2" xref="S3.E3.m1.1.1.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E3.m1.1b"><apply id="S3.E3.m1.1.1.1.1.cmml" xref="S3.E3.m1.1.1.1"><eq id="S3.E3.m1.1.1.1.1.2.cmml" xref="S3.E3.m1.1.1.1.1.2"></eq><apply id="S3.E3.m1.1.1.1.1.3.cmml" xref="S3.E3.m1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.E3.m1.1.1.1.1.3.1.cmml" xref="S3.E3.m1.1.1.1.1.3">superscript</csymbol><apply id="S3.E3.m1.1.1.1.1.3.2.cmml" xref="S3.E3.m1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.E3.m1.1.1.1.1.3.2.1.cmml" xref="S3.E3.m1.1.1.1.1.3">subscript</csymbol><ci id="S3.E3.m1.1.1.1.1.3.2.2.cmml" xref="S3.E3.m1.1.1.1.1.3.2.2">ℎ</ci><ci id="S3.E3.m1.1.1.1.1.3.2.3a.cmml" xref="S3.E3.m1.1.1.1.1.3.2.3"><mtext id="S3.E3.m1.1.1.1.1.3.2.3.cmml" mathsize="70%" xref="S3.E3.m1.1.1.1.1.3.2.3">CLS</mtext></ci></apply><ci id="S3.E3.m1.1.1.1.1.3.3.cmml" xref="S3.E3.m1.1.1.1.1.3.3">𝐿</ci></apply><apply id="S3.E3.m1.1.1.1.1.1.cmml" xref="S3.E3.m1.1.1.1.1.1"><times id="S3.E3.m1.1.1.1.1.1.2.cmml" xref="S3.E3.m1.1.1.1.1.1.2"></times><ci id="S3.E3.m1.1.1.1.1.1.3a.cmml" xref="S3.E3.m1.1.1.1.1.1.3"><mtext id="S3.E3.m1.1.1.1.1.1.3.cmml" xref="S3.E3.m1.1.1.1.1.1.3">Transformer Layers</mtext></ci><apply id="S3.E3.m1.1.1.1.1.1.1.1.1.cmml" xref="S3.E3.m1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E3.m1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E3.m1.1.1.1.1.1.1.1">subscript</csymbol><ci id="S3.E3.m1.1.1.1.1.1.1.1.1.2.cmml" xref="S3.E3.m1.1.1.1.1.1.1.1.1.2">𝑧</ci><cn id="S3.E3.m1.1.1.1.1.1.1.1.1.3.cmml" type="integer" xref="S3.E3.m1.1.1.1.1.1.1.1.1.3">0</cn></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E3.m1.1c">h_{\text{CLS}}^{L}=\text{Transformer Layers}(z_{0}),</annotation><annotation encoding="application/x-llamapun" id="S3.E3.m1.1d">italic_h start_POSTSUBSCRIPT CLS end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_L end_POSTSUPERSCRIPT = Transformer Layers ( italic_z start_POSTSUBSCRIPT 0 end_POSTSUBSCRIPT ) ,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_left_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(3)</span></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S3.SS3.p7.1">where <math alttext="h_{\text{CLS}}^{L}" class="ltx_Math" display="inline" id="S3.SS3.p7.1.m1.1"><semantics id="S3.SS3.p7.1.m1.1a"><msubsup id="S3.SS3.p7.1.m1.1.1" xref="S3.SS3.p7.1.m1.1.1.cmml"><mi id="S3.SS3.p7.1.m1.1.1.2.2" xref="S3.SS3.p7.1.m1.1.1.2.2.cmml">h</mi><mtext id="S3.SS3.p7.1.m1.1.1.2.3" xref="S3.SS3.p7.1.m1.1.1.2.3a.cmml">CLS</mtext><mi id="S3.SS3.p7.1.m1.1.1.3" xref="S3.SS3.p7.1.m1.1.1.3.cmml">L</mi></msubsup><annotation-xml encoding="MathML-Content" id="S3.SS3.p7.1.m1.1b"><apply id="S3.SS3.p7.1.m1.1.1.cmml" xref="S3.SS3.p7.1.m1.1.1"><csymbol cd="ambiguous" id="S3.SS3.p7.1.m1.1.1.1.cmml" xref="S3.SS3.p7.1.m1.1.1">superscript</csymbol><apply id="S3.SS3.p7.1.m1.1.1.2.cmml" xref="S3.SS3.p7.1.m1.1.1"><csymbol cd="ambiguous" id="S3.SS3.p7.1.m1.1.1.2.1.cmml" xref="S3.SS3.p7.1.m1.1.1">subscript</csymbol><ci id="S3.SS3.p7.1.m1.1.1.2.2.cmml" xref="S3.SS3.p7.1.m1.1.1.2.2">ℎ</ci><ci id="S3.SS3.p7.1.m1.1.1.2.3a.cmml" xref="S3.SS3.p7.1.m1.1.1.2.3"><mtext id="S3.SS3.p7.1.m1.1.1.2.3.cmml" mathsize="70%" xref="S3.SS3.p7.1.m1.1.1.2.3">CLS</mtext></ci></apply><ci id="S3.SS3.p7.1.m1.1.1.3.cmml" xref="S3.SS3.p7.1.m1.1.1.3">𝐿</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p7.1.m1.1c">h_{\text{CLS}}^{L}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p7.1.m1.1d">italic_h start_POSTSUBSCRIPT CLS end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_L end_POSTSUPERSCRIPT</annotation></semantics></math> is the semantic representation of whole image.</p>
</div>
<div class="ltx_para" id="S3.SS3.p8">
<p class="ltx_p" id="S3.SS3.p8.1">There are several advantages of using <math alttext="h_{\text{CLS}}^{L}" class="ltx_Math" display="inline" id="S3.SS3.p8.1.m1.1"><semantics id="S3.SS3.p8.1.m1.1a"><msubsup id="S3.SS3.p8.1.m1.1.1" xref="S3.SS3.p8.1.m1.1.1.cmml"><mi id="S3.SS3.p8.1.m1.1.1.2.2" xref="S3.SS3.p8.1.m1.1.1.2.2.cmml">h</mi><mtext id="S3.SS3.p8.1.m1.1.1.2.3" xref="S3.SS3.p8.1.m1.1.1.2.3a.cmml">CLS</mtext><mi id="S3.SS3.p8.1.m1.1.1.3" xref="S3.SS3.p8.1.m1.1.1.3.cmml">L</mi></msubsup><annotation-xml encoding="MathML-Content" id="S3.SS3.p8.1.m1.1b"><apply id="S3.SS3.p8.1.m1.1.1.cmml" xref="S3.SS3.p8.1.m1.1.1"><csymbol cd="ambiguous" id="S3.SS3.p8.1.m1.1.1.1.cmml" xref="S3.SS3.p8.1.m1.1.1">superscript</csymbol><apply id="S3.SS3.p8.1.m1.1.1.2.cmml" xref="S3.SS3.p8.1.m1.1.1"><csymbol cd="ambiguous" id="S3.SS3.p8.1.m1.1.1.2.1.cmml" xref="S3.SS3.p8.1.m1.1.1">subscript</csymbol><ci id="S3.SS3.p8.1.m1.1.1.2.2.cmml" xref="S3.SS3.p8.1.m1.1.1.2.2">ℎ</ci><ci id="S3.SS3.p8.1.m1.1.1.2.3a.cmml" xref="S3.SS3.p8.1.m1.1.1.2.3"><mtext id="S3.SS3.p8.1.m1.1.1.2.3.cmml" mathsize="70%" xref="S3.SS3.p8.1.m1.1.1.2.3">CLS</mtext></ci></apply><ci id="S3.SS3.p8.1.m1.1.1.3.cmml" xref="S3.SS3.p8.1.m1.1.1.3">𝐿</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p8.1.m1.1c">h_{\text{CLS}}^{L}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p8.1.m1.1d">italic_h start_POSTSUBSCRIPT CLS end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_L end_POSTSUPERSCRIPT</annotation></semantics></math> as semantic embedding:</p>
</div>
<div class="ltx_para" id="S3.SS3.p9">
<ol class="ltx_enumerate" id="S3.I2">
<li class="ltx_item" id="S3.I2.i1" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">1.</span>
<div class="ltx_para" id="S3.I2.i1.p1">
<p class="ltx_p" id="S3.I2.i1.p1.1"><span class="ltx_text ltx_font_bold" id="S3.I2.i1.p1.1.1">Global information aggregation: </span>since the <math alttext="h_{\text{CLS}}^{L}" class="ltx_Math" display="inline" id="S3.I2.i1.p1.1.m1.1"><semantics id="S3.I2.i1.p1.1.m1.1a"><msubsup id="S3.I2.i1.p1.1.m1.1.1" xref="S3.I2.i1.p1.1.m1.1.1.cmml"><mi id="S3.I2.i1.p1.1.m1.1.1.2.2" xref="S3.I2.i1.p1.1.m1.1.1.2.2.cmml">h</mi><mtext id="S3.I2.i1.p1.1.m1.1.1.2.3" xref="S3.I2.i1.p1.1.m1.1.1.2.3a.cmml">CLS</mtext><mi id="S3.I2.i1.p1.1.m1.1.1.3" xref="S3.I2.i1.p1.1.m1.1.1.3.cmml">L</mi></msubsup><annotation-xml encoding="MathML-Content" id="S3.I2.i1.p1.1.m1.1b"><apply id="S3.I2.i1.p1.1.m1.1.1.cmml" xref="S3.I2.i1.p1.1.m1.1.1"><csymbol cd="ambiguous" id="S3.I2.i1.p1.1.m1.1.1.1.cmml" xref="S3.I2.i1.p1.1.m1.1.1">superscript</csymbol><apply id="S3.I2.i1.p1.1.m1.1.1.2.cmml" xref="S3.I2.i1.p1.1.m1.1.1"><csymbol cd="ambiguous" id="S3.I2.i1.p1.1.m1.1.1.2.1.cmml" xref="S3.I2.i1.p1.1.m1.1.1">subscript</csymbol><ci id="S3.I2.i1.p1.1.m1.1.1.2.2.cmml" xref="S3.I2.i1.p1.1.m1.1.1.2.2">ℎ</ci><ci id="S3.I2.i1.p1.1.m1.1.1.2.3a.cmml" xref="S3.I2.i1.p1.1.m1.1.1.2.3"><mtext id="S3.I2.i1.p1.1.m1.1.1.2.3.cmml" mathsize="70%" xref="S3.I2.i1.p1.1.m1.1.1.2.3">CLS</mtext></ci></apply><ci id="S3.I2.i1.p1.1.m1.1.1.3.cmml" xref="S3.I2.i1.p1.1.m1.1.1.3">𝐿</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.I2.i1.p1.1.m1.1c">h_{\text{CLS}}^{L}</annotation><annotation encoding="application/x-llamapun" id="S3.I2.i1.p1.1.m1.1d">italic_h start_POSTSUBSCRIPT CLS end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_L end_POSTSUPERSCRIPT</annotation></semantics></math> interacts with all patches in each layer of the Transformer, it is able to capture global information about the entire image, not just local features.</p>
</div>
</li>
<li class="ltx_item" id="S3.I2.i2" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">2.</span>
<div class="ltx_para" id="S3.I2.i2.p1">
<p class="ltx_p" id="S3.I2.i2.p1.1"><span class="ltx_text ltx_font_bold" id="S3.I2.i2.p1.1.1">Simplified structure: </span>compared to traditional convolutional neural networks that require the full representation of the image, the direct use of ViT’s <math alttext="h_{\text{CLS}}^{L}" class="ltx_Math" display="inline" id="S3.I2.i2.p1.1.m1.1"><semantics id="S3.I2.i2.p1.1.m1.1a"><msubsup id="S3.I2.i2.p1.1.m1.1.1" xref="S3.I2.i2.p1.1.m1.1.1.cmml"><mi id="S3.I2.i2.p1.1.m1.1.1.2.2" xref="S3.I2.i2.p1.1.m1.1.1.2.2.cmml">h</mi><mtext id="S3.I2.i2.p1.1.m1.1.1.2.3" xref="S3.I2.i2.p1.1.m1.1.1.2.3a.cmml">CLS</mtext><mi id="S3.I2.i2.p1.1.m1.1.1.3" xref="S3.I2.i2.p1.1.m1.1.1.3.cmml">L</mi></msubsup><annotation-xml encoding="MathML-Content" id="S3.I2.i2.p1.1.m1.1b"><apply id="S3.I2.i2.p1.1.m1.1.1.cmml" xref="S3.I2.i2.p1.1.m1.1.1"><csymbol cd="ambiguous" id="S3.I2.i2.p1.1.m1.1.1.1.cmml" xref="S3.I2.i2.p1.1.m1.1.1">superscript</csymbol><apply id="S3.I2.i2.p1.1.m1.1.1.2.cmml" xref="S3.I2.i2.p1.1.m1.1.1"><csymbol cd="ambiguous" id="S3.I2.i2.p1.1.m1.1.1.2.1.cmml" xref="S3.I2.i2.p1.1.m1.1.1">subscript</csymbol><ci id="S3.I2.i2.p1.1.m1.1.1.2.2.cmml" xref="S3.I2.i2.p1.1.m1.1.1.2.2">ℎ</ci><ci id="S3.I2.i2.p1.1.m1.1.1.2.3a.cmml" xref="S3.I2.i2.p1.1.m1.1.1.2.3"><mtext id="S3.I2.i2.p1.1.m1.1.1.2.3.cmml" mathsize="70%" xref="S3.I2.i2.p1.1.m1.1.1.2.3">CLS</mtext></ci></apply><ci id="S3.I2.i2.p1.1.m1.1.1.3.cmml" xref="S3.I2.i2.p1.1.m1.1.1.3">𝐿</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.I2.i2.p1.1.m1.1c">h_{\text{CLS}}^{L}</annotation><annotation encoding="application/x-llamapun" id="S3.I2.i2.p1.1.m1.1d">italic_h start_POSTSUBSCRIPT CLS end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_L end_POSTSUPERSCRIPT</annotation></semantics></math> simplifies the subsequent task implementation.</p>
</div>
</li>
</ol>
</div>
<div class="ltx_para" id="S3.SS3.p10">
<p class="ltx_p" id="S3.SS3.p10.1">The work process of ViT in our research is shown in Figure <a class="ltx_ref" href="https://arxiv.org/html/2407.09157v1#S3.F3" title="Figure 3 ‣ 3.3 Image feature extractor ‣ 3 Methodology ‣ Movie Recommendation with Poster Attention via Multi-modal Transformer Feature Fusion"><span class="ltx_text ltx_ref_tag">3</span></a>.</p>
</div>
<figure class="ltx_figure" id="S3.F3"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="375" id="S3.F3.g1" src="extracted/5727377/img/ViT.jpg" width="598"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 3: </span>Working process of proposed image feature extraction method,Where transformation is converting all images to a standard 224 by 224 square.</figcaption>
</figure>
</section>
<section class="ltx_subsection" id="S3.SS4">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.4 </span>Structural data feature extractor</h3>
<div class="ltx_para" id="S3.SS4.p1">
<p class="ltx_p" id="S3.SS4.p1.1">To handle structured features such as user ID, movie ID, ZIP code, etc., we use a dense layer for embedding encoding. This approach projects these discrete features into a continuous high-dimensional vector space. For this purpose we adopt an up-sampling method to embed the low dimensional features into a 768 dimensional high latitude vector space step by step, firstly for each structured feature we use different low dimensional coding methods such as one-hot encoding for the occupation feature, and then the low dimensional vectors are up-sampled by the dense layer until their dimension reaches 768. In the proposed method the ReLU function is applied as activation function.</p>
</div>
</section>
<section class="ltx_subsection" id="S3.SS5">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.5 </span>Feature fusion based on Transformer</h3>
<div class="ltx_para" id="S3.SS5.p1">
<p class="ltx_p" id="S3.SS5.p1.1">After feature extraction, we need to carry out feature fusion of multi-source features to make full use of their complementary information. To this end, a feature fusion method based on Transformer is proposed to capture the global dependencies between different modal features through self-attention mechanism to achieve fusion.</p>
</div>
<div class="ltx_para" id="S3.SS5.p2">
<p class="ltx_p" id="S3.SS5.p2.1">In the proposed method, we first reconstruct different feature vectors into a unified feature sequence, and input each feature vector into transformer as a Token. We add special tokens before and after the sequence: [CLS] and [SEP], the former to mark the semantic information of the whole sequence, and the latter to mark the end of the sequence.</p>
</div>
<div class="ltx_para" id="S3.SS5.p3">
<p class="ltx_p" id="S3.SS5.p3.5">The constructed feature sequence is denoted as <math alttext="S=[V_{CLS},V_{1},V_{2},...,V_{10},V_{SEP}]" class="ltx_Math" display="inline" id="S3.SS5.p3.1.m1.6"><semantics id="S3.SS5.p3.1.m1.6a"><mrow id="S3.SS5.p3.1.m1.6.6" xref="S3.SS5.p3.1.m1.6.6.cmml"><mi id="S3.SS5.p3.1.m1.6.6.7" xref="S3.SS5.p3.1.m1.6.6.7.cmml">S</mi><mo id="S3.SS5.p3.1.m1.6.6.6" xref="S3.SS5.p3.1.m1.6.6.6.cmml">=</mo><mrow id="S3.SS5.p3.1.m1.6.6.5.5" xref="S3.SS5.p3.1.m1.6.6.5.6.cmml"><mo id="S3.SS5.p3.1.m1.6.6.5.5.6" stretchy="false" xref="S3.SS5.p3.1.m1.6.6.5.6.cmml">[</mo><msub id="S3.SS5.p3.1.m1.2.2.1.1.1" xref="S3.SS5.p3.1.m1.2.2.1.1.1.cmml"><mi id="S3.SS5.p3.1.m1.2.2.1.1.1.2" xref="S3.SS5.p3.1.m1.2.2.1.1.1.2.cmml">V</mi><mrow id="S3.SS5.p3.1.m1.2.2.1.1.1.3" xref="S3.SS5.p3.1.m1.2.2.1.1.1.3.cmml"><mi id="S3.SS5.p3.1.m1.2.2.1.1.1.3.2" xref="S3.SS5.p3.1.m1.2.2.1.1.1.3.2.cmml">C</mi><mo id="S3.SS5.p3.1.m1.2.2.1.1.1.3.1" xref="S3.SS5.p3.1.m1.2.2.1.1.1.3.1.cmml">⁢</mo><mi id="S3.SS5.p3.1.m1.2.2.1.1.1.3.3" xref="S3.SS5.p3.1.m1.2.2.1.1.1.3.3.cmml">L</mi><mo id="S3.SS5.p3.1.m1.2.2.1.1.1.3.1a" xref="S3.SS5.p3.1.m1.2.2.1.1.1.3.1.cmml">⁢</mo><mi id="S3.SS5.p3.1.m1.2.2.1.1.1.3.4" xref="S3.SS5.p3.1.m1.2.2.1.1.1.3.4.cmml">S</mi></mrow></msub><mo id="S3.SS5.p3.1.m1.6.6.5.5.7" xref="S3.SS5.p3.1.m1.6.6.5.6.cmml">,</mo><msub id="S3.SS5.p3.1.m1.3.3.2.2.2" xref="S3.SS5.p3.1.m1.3.3.2.2.2.cmml"><mi id="S3.SS5.p3.1.m1.3.3.2.2.2.2" xref="S3.SS5.p3.1.m1.3.3.2.2.2.2.cmml">V</mi><mn id="S3.SS5.p3.1.m1.3.3.2.2.2.3" xref="S3.SS5.p3.1.m1.3.3.2.2.2.3.cmml">1</mn></msub><mo id="S3.SS5.p3.1.m1.6.6.5.5.8" xref="S3.SS5.p3.1.m1.6.6.5.6.cmml">,</mo><msub id="S3.SS5.p3.1.m1.4.4.3.3.3" xref="S3.SS5.p3.1.m1.4.4.3.3.3.cmml"><mi id="S3.SS5.p3.1.m1.4.4.3.3.3.2" xref="S3.SS5.p3.1.m1.4.4.3.3.3.2.cmml">V</mi><mn id="S3.SS5.p3.1.m1.4.4.3.3.3.3" xref="S3.SS5.p3.1.m1.4.4.3.3.3.3.cmml">2</mn></msub><mo id="S3.SS5.p3.1.m1.6.6.5.5.9" xref="S3.SS5.p3.1.m1.6.6.5.6.cmml">,</mo><mi id="S3.SS5.p3.1.m1.1.1" mathvariant="normal" xref="S3.SS5.p3.1.m1.1.1.cmml">…</mi><mo id="S3.SS5.p3.1.m1.6.6.5.5.10" xref="S3.SS5.p3.1.m1.6.6.5.6.cmml">,</mo><msub id="S3.SS5.p3.1.m1.5.5.4.4.4" xref="S3.SS5.p3.1.m1.5.5.4.4.4.cmml"><mi id="S3.SS5.p3.1.m1.5.5.4.4.4.2" xref="S3.SS5.p3.1.m1.5.5.4.4.4.2.cmml">V</mi><mn id="S3.SS5.p3.1.m1.5.5.4.4.4.3" xref="S3.SS5.p3.1.m1.5.5.4.4.4.3.cmml">10</mn></msub><mo id="S3.SS5.p3.1.m1.6.6.5.5.11" xref="S3.SS5.p3.1.m1.6.6.5.6.cmml">,</mo><msub id="S3.SS5.p3.1.m1.6.6.5.5.5" xref="S3.SS5.p3.1.m1.6.6.5.5.5.cmml"><mi id="S3.SS5.p3.1.m1.6.6.5.5.5.2" xref="S3.SS5.p3.1.m1.6.6.5.5.5.2.cmml">V</mi><mrow id="S3.SS5.p3.1.m1.6.6.5.5.5.3" xref="S3.SS5.p3.1.m1.6.6.5.5.5.3.cmml"><mi id="S3.SS5.p3.1.m1.6.6.5.5.5.3.2" xref="S3.SS5.p3.1.m1.6.6.5.5.5.3.2.cmml">S</mi><mo id="S3.SS5.p3.1.m1.6.6.5.5.5.3.1" xref="S3.SS5.p3.1.m1.6.6.5.5.5.3.1.cmml">⁢</mo><mi id="S3.SS5.p3.1.m1.6.6.5.5.5.3.3" xref="S3.SS5.p3.1.m1.6.6.5.5.5.3.3.cmml">E</mi><mo id="S3.SS5.p3.1.m1.6.6.5.5.5.3.1a" xref="S3.SS5.p3.1.m1.6.6.5.5.5.3.1.cmml">⁢</mo><mi id="S3.SS5.p3.1.m1.6.6.5.5.5.3.4" xref="S3.SS5.p3.1.m1.6.6.5.5.5.3.4.cmml">P</mi></mrow></msub><mo id="S3.SS5.p3.1.m1.6.6.5.5.12" stretchy="false" xref="S3.SS5.p3.1.m1.6.6.5.6.cmml">]</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS5.p3.1.m1.6b"><apply id="S3.SS5.p3.1.m1.6.6.cmml" xref="S3.SS5.p3.1.m1.6.6"><eq id="S3.SS5.p3.1.m1.6.6.6.cmml" xref="S3.SS5.p3.1.m1.6.6.6"></eq><ci id="S3.SS5.p3.1.m1.6.6.7.cmml" xref="S3.SS5.p3.1.m1.6.6.7">𝑆</ci><list id="S3.SS5.p3.1.m1.6.6.5.6.cmml" xref="S3.SS5.p3.1.m1.6.6.5.5"><apply id="S3.SS5.p3.1.m1.2.2.1.1.1.cmml" xref="S3.SS5.p3.1.m1.2.2.1.1.1"><csymbol cd="ambiguous" id="S3.SS5.p3.1.m1.2.2.1.1.1.1.cmml" xref="S3.SS5.p3.1.m1.2.2.1.1.1">subscript</csymbol><ci id="S3.SS5.p3.1.m1.2.2.1.1.1.2.cmml" xref="S3.SS5.p3.1.m1.2.2.1.1.1.2">𝑉</ci><apply id="S3.SS5.p3.1.m1.2.2.1.1.1.3.cmml" xref="S3.SS5.p3.1.m1.2.2.1.1.1.3"><times id="S3.SS5.p3.1.m1.2.2.1.1.1.3.1.cmml" xref="S3.SS5.p3.1.m1.2.2.1.1.1.3.1"></times><ci id="S3.SS5.p3.1.m1.2.2.1.1.1.3.2.cmml" xref="S3.SS5.p3.1.m1.2.2.1.1.1.3.2">𝐶</ci><ci id="S3.SS5.p3.1.m1.2.2.1.1.1.3.3.cmml" xref="S3.SS5.p3.1.m1.2.2.1.1.1.3.3">𝐿</ci><ci id="S3.SS5.p3.1.m1.2.2.1.1.1.3.4.cmml" xref="S3.SS5.p3.1.m1.2.2.1.1.1.3.4">𝑆</ci></apply></apply><apply id="S3.SS5.p3.1.m1.3.3.2.2.2.cmml" xref="S3.SS5.p3.1.m1.3.3.2.2.2"><csymbol cd="ambiguous" id="S3.SS5.p3.1.m1.3.3.2.2.2.1.cmml" xref="S3.SS5.p3.1.m1.3.3.2.2.2">subscript</csymbol><ci id="S3.SS5.p3.1.m1.3.3.2.2.2.2.cmml" xref="S3.SS5.p3.1.m1.3.3.2.2.2.2">𝑉</ci><cn id="S3.SS5.p3.1.m1.3.3.2.2.2.3.cmml" type="integer" xref="S3.SS5.p3.1.m1.3.3.2.2.2.3">1</cn></apply><apply id="S3.SS5.p3.1.m1.4.4.3.3.3.cmml" xref="S3.SS5.p3.1.m1.4.4.3.3.3"><csymbol cd="ambiguous" id="S3.SS5.p3.1.m1.4.4.3.3.3.1.cmml" xref="S3.SS5.p3.1.m1.4.4.3.3.3">subscript</csymbol><ci id="S3.SS5.p3.1.m1.4.4.3.3.3.2.cmml" xref="S3.SS5.p3.1.m1.4.4.3.3.3.2">𝑉</ci><cn id="S3.SS5.p3.1.m1.4.4.3.3.3.3.cmml" type="integer" xref="S3.SS5.p3.1.m1.4.4.3.3.3.3">2</cn></apply><ci id="S3.SS5.p3.1.m1.1.1.cmml" xref="S3.SS5.p3.1.m1.1.1">…</ci><apply id="S3.SS5.p3.1.m1.5.5.4.4.4.cmml" xref="S3.SS5.p3.1.m1.5.5.4.4.4"><csymbol cd="ambiguous" id="S3.SS5.p3.1.m1.5.5.4.4.4.1.cmml" xref="S3.SS5.p3.1.m1.5.5.4.4.4">subscript</csymbol><ci id="S3.SS5.p3.1.m1.5.5.4.4.4.2.cmml" xref="S3.SS5.p3.1.m1.5.5.4.4.4.2">𝑉</ci><cn id="S3.SS5.p3.1.m1.5.5.4.4.4.3.cmml" type="integer" xref="S3.SS5.p3.1.m1.5.5.4.4.4.3">10</cn></apply><apply id="S3.SS5.p3.1.m1.6.6.5.5.5.cmml" xref="S3.SS5.p3.1.m1.6.6.5.5.5"><csymbol cd="ambiguous" id="S3.SS5.p3.1.m1.6.6.5.5.5.1.cmml" xref="S3.SS5.p3.1.m1.6.6.5.5.5">subscript</csymbol><ci id="S3.SS5.p3.1.m1.6.6.5.5.5.2.cmml" xref="S3.SS5.p3.1.m1.6.6.5.5.5.2">𝑉</ci><apply id="S3.SS5.p3.1.m1.6.6.5.5.5.3.cmml" xref="S3.SS5.p3.1.m1.6.6.5.5.5.3"><times id="S3.SS5.p3.1.m1.6.6.5.5.5.3.1.cmml" xref="S3.SS5.p3.1.m1.6.6.5.5.5.3.1"></times><ci id="S3.SS5.p3.1.m1.6.6.5.5.5.3.2.cmml" xref="S3.SS5.p3.1.m1.6.6.5.5.5.3.2">𝑆</ci><ci id="S3.SS5.p3.1.m1.6.6.5.5.5.3.3.cmml" xref="S3.SS5.p3.1.m1.6.6.5.5.5.3.3">𝐸</ci><ci id="S3.SS5.p3.1.m1.6.6.5.5.5.3.4.cmml" xref="S3.SS5.p3.1.m1.6.6.5.5.5.3.4">𝑃</ci></apply></apply></list></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS5.p3.1.m1.6c">S=[V_{CLS},V_{1},V_{2},...,V_{10},V_{SEP}]</annotation><annotation encoding="application/x-llamapun" id="S3.SS5.p3.1.m1.6d">italic_S = [ italic_V start_POSTSUBSCRIPT italic_C italic_L italic_S end_POSTSUBSCRIPT , italic_V start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT , italic_V start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT , … , italic_V start_POSTSUBSCRIPT 10 end_POSTSUBSCRIPT , italic_V start_POSTSUBSCRIPT italic_S italic_E italic_P end_POSTSUBSCRIPT ]</annotation></semantics></math>. Where <math alttext="V_{i}(1\leq i\leq 10)" class="ltx_Math" display="inline" id="S3.SS5.p3.2.m2.1"><semantics id="S3.SS5.p3.2.m2.1a"><mrow id="S3.SS5.p3.2.m2.1.1" xref="S3.SS5.p3.2.m2.1.1.cmml"><msub id="S3.SS5.p3.2.m2.1.1.3" xref="S3.SS5.p3.2.m2.1.1.3.cmml"><mi id="S3.SS5.p3.2.m2.1.1.3.2" xref="S3.SS5.p3.2.m2.1.1.3.2.cmml">V</mi><mi id="S3.SS5.p3.2.m2.1.1.3.3" xref="S3.SS5.p3.2.m2.1.1.3.3.cmml">i</mi></msub><mo id="S3.SS5.p3.2.m2.1.1.2" xref="S3.SS5.p3.2.m2.1.1.2.cmml">⁢</mo><mrow id="S3.SS5.p3.2.m2.1.1.1.1" xref="S3.SS5.p3.2.m2.1.1.1.1.1.cmml"><mo id="S3.SS5.p3.2.m2.1.1.1.1.2" stretchy="false" xref="S3.SS5.p3.2.m2.1.1.1.1.1.cmml">(</mo><mrow id="S3.SS5.p3.2.m2.1.1.1.1.1" xref="S3.SS5.p3.2.m2.1.1.1.1.1.cmml"><mn id="S3.SS5.p3.2.m2.1.1.1.1.1.2" xref="S3.SS5.p3.2.m2.1.1.1.1.1.2.cmml">1</mn><mo id="S3.SS5.p3.2.m2.1.1.1.1.1.3" xref="S3.SS5.p3.2.m2.1.1.1.1.1.3.cmml">≤</mo><mi id="S3.SS5.p3.2.m2.1.1.1.1.1.4" xref="S3.SS5.p3.2.m2.1.1.1.1.1.4.cmml">i</mi><mo id="S3.SS5.p3.2.m2.1.1.1.1.1.5" xref="S3.SS5.p3.2.m2.1.1.1.1.1.5.cmml">≤</mo><mn id="S3.SS5.p3.2.m2.1.1.1.1.1.6" xref="S3.SS5.p3.2.m2.1.1.1.1.1.6.cmml">10</mn></mrow><mo id="S3.SS5.p3.2.m2.1.1.1.1.3" stretchy="false" xref="S3.SS5.p3.2.m2.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS5.p3.2.m2.1b"><apply id="S3.SS5.p3.2.m2.1.1.cmml" xref="S3.SS5.p3.2.m2.1.1"><times id="S3.SS5.p3.2.m2.1.1.2.cmml" xref="S3.SS5.p3.2.m2.1.1.2"></times><apply id="S3.SS5.p3.2.m2.1.1.3.cmml" xref="S3.SS5.p3.2.m2.1.1.3"><csymbol cd="ambiguous" id="S3.SS5.p3.2.m2.1.1.3.1.cmml" xref="S3.SS5.p3.2.m2.1.1.3">subscript</csymbol><ci id="S3.SS5.p3.2.m2.1.1.3.2.cmml" xref="S3.SS5.p3.2.m2.1.1.3.2">𝑉</ci><ci id="S3.SS5.p3.2.m2.1.1.3.3.cmml" xref="S3.SS5.p3.2.m2.1.1.3.3">𝑖</ci></apply><apply id="S3.SS5.p3.2.m2.1.1.1.1.1.cmml" xref="S3.SS5.p3.2.m2.1.1.1.1"><and id="S3.SS5.p3.2.m2.1.1.1.1.1a.cmml" xref="S3.SS5.p3.2.m2.1.1.1.1"></and><apply id="S3.SS5.p3.2.m2.1.1.1.1.1b.cmml" xref="S3.SS5.p3.2.m2.1.1.1.1"><leq id="S3.SS5.p3.2.m2.1.1.1.1.1.3.cmml" xref="S3.SS5.p3.2.m2.1.1.1.1.1.3"></leq><cn id="S3.SS5.p3.2.m2.1.1.1.1.1.2.cmml" type="integer" xref="S3.SS5.p3.2.m2.1.1.1.1.1.2">1</cn><ci id="S3.SS5.p3.2.m2.1.1.1.1.1.4.cmml" xref="S3.SS5.p3.2.m2.1.1.1.1.1.4">𝑖</ci></apply><apply id="S3.SS5.p3.2.m2.1.1.1.1.1c.cmml" xref="S3.SS5.p3.2.m2.1.1.1.1"><leq id="S3.SS5.p3.2.m2.1.1.1.1.1.5.cmml" xref="S3.SS5.p3.2.m2.1.1.1.1.1.5"></leq><share href="https://arxiv.org/html/2407.09157v1#S3.SS5.p3.2.m2.1.1.1.1.1.4.cmml" id="S3.SS5.p3.2.m2.1.1.1.1.1d.cmml" xref="S3.SS5.p3.2.m2.1.1.1.1"></share><cn id="S3.SS5.p3.2.m2.1.1.1.1.1.6.cmml" type="integer" xref="S3.SS5.p3.2.m2.1.1.1.1.1.6">10</cn></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS5.p3.2.m2.1c">V_{i}(1\leq i\leq 10)</annotation><annotation encoding="application/x-llamapun" id="S3.SS5.p3.2.m2.1d">italic_V start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT ( 1 ≤ italic_i ≤ 10 )</annotation></semantics></math> is <math alttext="ith" class="ltx_Math" display="inline" id="S3.SS5.p3.3.m3.1"><semantics id="S3.SS5.p3.3.m3.1a"><mrow id="S3.SS5.p3.3.m3.1.1" xref="S3.SS5.p3.3.m3.1.1.cmml"><mi id="S3.SS5.p3.3.m3.1.1.2" xref="S3.SS5.p3.3.m3.1.1.2.cmml">i</mi><mo id="S3.SS5.p3.3.m3.1.1.1" xref="S3.SS5.p3.3.m3.1.1.1.cmml">⁢</mo><mi id="S3.SS5.p3.3.m3.1.1.3" xref="S3.SS5.p3.3.m3.1.1.3.cmml">t</mi><mo id="S3.SS5.p3.3.m3.1.1.1a" xref="S3.SS5.p3.3.m3.1.1.1.cmml">⁢</mo><mi id="S3.SS5.p3.3.m3.1.1.4" xref="S3.SS5.p3.3.m3.1.1.4.cmml">h</mi></mrow><annotation-xml encoding="MathML-Content" id="S3.SS5.p3.3.m3.1b"><apply id="S3.SS5.p3.3.m3.1.1.cmml" xref="S3.SS5.p3.3.m3.1.1"><times id="S3.SS5.p3.3.m3.1.1.1.cmml" xref="S3.SS5.p3.3.m3.1.1.1"></times><ci id="S3.SS5.p3.3.m3.1.1.2.cmml" xref="S3.SS5.p3.3.m3.1.1.2">𝑖</ci><ci id="S3.SS5.p3.3.m3.1.1.3.cmml" xref="S3.SS5.p3.3.m3.1.1.3">𝑡</ci><ci id="S3.SS5.p3.3.m3.1.1.4.cmml" xref="S3.SS5.p3.3.m3.1.1.4">ℎ</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS5.p3.3.m3.1c">ith</annotation><annotation encoding="application/x-llamapun" id="S3.SS5.p3.3.m3.1d">italic_i italic_t italic_h</annotation></semantics></math> feature vector in the sequence, <math alttext="V_{CLS}" class="ltx_Math" display="inline" id="S3.SS5.p3.4.m4.1"><semantics id="S3.SS5.p3.4.m4.1a"><msub id="S3.SS5.p3.4.m4.1.1" xref="S3.SS5.p3.4.m4.1.1.cmml"><mi id="S3.SS5.p3.4.m4.1.1.2" xref="S3.SS5.p3.4.m4.1.1.2.cmml">V</mi><mrow id="S3.SS5.p3.4.m4.1.1.3" xref="S3.SS5.p3.4.m4.1.1.3.cmml"><mi id="S3.SS5.p3.4.m4.1.1.3.2" xref="S3.SS5.p3.4.m4.1.1.3.2.cmml">C</mi><mo id="S3.SS5.p3.4.m4.1.1.3.1" xref="S3.SS5.p3.4.m4.1.1.3.1.cmml">⁢</mo><mi id="S3.SS5.p3.4.m4.1.1.3.3" xref="S3.SS5.p3.4.m4.1.1.3.3.cmml">L</mi><mo id="S3.SS5.p3.4.m4.1.1.3.1a" xref="S3.SS5.p3.4.m4.1.1.3.1.cmml">⁢</mo><mi id="S3.SS5.p3.4.m4.1.1.3.4" xref="S3.SS5.p3.4.m4.1.1.3.4.cmml">S</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S3.SS5.p3.4.m4.1b"><apply id="S3.SS5.p3.4.m4.1.1.cmml" xref="S3.SS5.p3.4.m4.1.1"><csymbol cd="ambiguous" id="S3.SS5.p3.4.m4.1.1.1.cmml" xref="S3.SS5.p3.4.m4.1.1">subscript</csymbol><ci id="S3.SS5.p3.4.m4.1.1.2.cmml" xref="S3.SS5.p3.4.m4.1.1.2">𝑉</ci><apply id="S3.SS5.p3.4.m4.1.1.3.cmml" xref="S3.SS5.p3.4.m4.1.1.3"><times id="S3.SS5.p3.4.m4.1.1.3.1.cmml" xref="S3.SS5.p3.4.m4.1.1.3.1"></times><ci id="S3.SS5.p3.4.m4.1.1.3.2.cmml" xref="S3.SS5.p3.4.m4.1.1.3.2">𝐶</ci><ci id="S3.SS5.p3.4.m4.1.1.3.3.cmml" xref="S3.SS5.p3.4.m4.1.1.3.3">𝐿</ci><ci id="S3.SS5.p3.4.m4.1.1.3.4.cmml" xref="S3.SS5.p3.4.m4.1.1.3.4">𝑆</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS5.p3.4.m4.1c">V_{CLS}</annotation><annotation encoding="application/x-llamapun" id="S3.SS5.p3.4.m4.1d">italic_V start_POSTSUBSCRIPT italic_C italic_L italic_S end_POSTSUBSCRIPT</annotation></semantics></math> and <math alttext="V_{SEP}" class="ltx_Math" display="inline" id="S3.SS5.p3.5.m5.1"><semantics id="S3.SS5.p3.5.m5.1a"><msub id="S3.SS5.p3.5.m5.1.1" xref="S3.SS5.p3.5.m5.1.1.cmml"><mi id="S3.SS5.p3.5.m5.1.1.2" xref="S3.SS5.p3.5.m5.1.1.2.cmml">V</mi><mrow id="S3.SS5.p3.5.m5.1.1.3" xref="S3.SS5.p3.5.m5.1.1.3.cmml"><mi id="S3.SS5.p3.5.m5.1.1.3.2" xref="S3.SS5.p3.5.m5.1.1.3.2.cmml">S</mi><mo id="S3.SS5.p3.5.m5.1.1.3.1" xref="S3.SS5.p3.5.m5.1.1.3.1.cmml">⁢</mo><mi id="S3.SS5.p3.5.m5.1.1.3.3" xref="S3.SS5.p3.5.m5.1.1.3.3.cmml">E</mi><mo id="S3.SS5.p3.5.m5.1.1.3.1a" xref="S3.SS5.p3.5.m5.1.1.3.1.cmml">⁢</mo><mi id="S3.SS5.p3.5.m5.1.1.3.4" xref="S3.SS5.p3.5.m5.1.1.3.4.cmml">P</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S3.SS5.p3.5.m5.1b"><apply id="S3.SS5.p3.5.m5.1.1.cmml" xref="S3.SS5.p3.5.m5.1.1"><csymbol cd="ambiguous" id="S3.SS5.p3.5.m5.1.1.1.cmml" xref="S3.SS5.p3.5.m5.1.1">subscript</csymbol><ci id="S3.SS5.p3.5.m5.1.1.2.cmml" xref="S3.SS5.p3.5.m5.1.1.2">𝑉</ci><apply id="S3.SS5.p3.5.m5.1.1.3.cmml" xref="S3.SS5.p3.5.m5.1.1.3"><times id="S3.SS5.p3.5.m5.1.1.3.1.cmml" xref="S3.SS5.p3.5.m5.1.1.3.1"></times><ci id="S3.SS5.p3.5.m5.1.1.3.2.cmml" xref="S3.SS5.p3.5.m5.1.1.3.2">𝑆</ci><ci id="S3.SS5.p3.5.m5.1.1.3.3.cmml" xref="S3.SS5.p3.5.m5.1.1.3.3">𝐸</ci><ci id="S3.SS5.p3.5.m5.1.1.3.4.cmml" xref="S3.SS5.p3.5.m5.1.1.3.4">𝑃</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS5.p3.5.m5.1c">V_{SEP}</annotation><annotation encoding="application/x-llamapun" id="S3.SS5.p3.5.m5.1d">italic_V start_POSTSUBSCRIPT italic_S italic_E italic_P end_POSTSUBSCRIPT</annotation></semantics></math> are special tokens.</p>
</div>
<div class="ltx_para" id="S3.SS5.p4">
<p class="ltx_p" id="S3.SS5.p4.1">Since a transformer is a model without sequential information, in order to enable the model to distinguish different feature tokens, we use fixed-position coding to add location information to feature vectors. Position coding is a vector with the same input feature dimension, that is, 768 dimensions. By introducing position coding model, the position of each feature vector in the sequence can be identified and sequence information can be captured. The calculation formula of location encoding reads as</p>
</div>
<div class="ltx_para" id="S3.SS5.p5">
<table class="ltx_equation ltx_eqn_table" id="S3.E4">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_left_padleft"></td>
<td class="ltx_eqn_cell ltx_align_left"><math alttext="P_{(pos,2i)}=\sin{\left(\frac{pos}{10000^{\frac{2i}{d}}}\right)}," class="ltx_Math" display="block" id="S3.E4.m1.5"><semantics id="S3.E4.m1.5a"><mrow id="S3.E4.m1.5.5.1" xref="S3.E4.m1.5.5.1.1.cmml"><mrow id="S3.E4.m1.5.5.1.1" xref="S3.E4.m1.5.5.1.1.cmml"><msub id="S3.E4.m1.5.5.1.1.2" xref="S3.E4.m1.5.5.1.1.2.cmml"><mi id="S3.E4.m1.5.5.1.1.2.2" xref="S3.E4.m1.5.5.1.1.2.2.cmml">P</mi><mrow id="S3.E4.m1.2.2.2.2" xref="S3.E4.m1.2.2.2.3.cmml"><mo id="S3.E4.m1.2.2.2.2.3" stretchy="false" xref="S3.E4.m1.2.2.2.3.cmml">(</mo><mrow id="S3.E4.m1.1.1.1.1.1" xref="S3.E4.m1.1.1.1.1.1.cmml"><mi id="S3.E4.m1.1.1.1.1.1.2" xref="S3.E4.m1.1.1.1.1.1.2.cmml">p</mi><mo id="S3.E4.m1.1.1.1.1.1.1" xref="S3.E4.m1.1.1.1.1.1.1.cmml">⁢</mo><mi id="S3.E4.m1.1.1.1.1.1.3" xref="S3.E4.m1.1.1.1.1.1.3.cmml">o</mi><mo id="S3.E4.m1.1.1.1.1.1.1a" xref="S3.E4.m1.1.1.1.1.1.1.cmml">⁢</mo><mi id="S3.E4.m1.1.1.1.1.1.4" xref="S3.E4.m1.1.1.1.1.1.4.cmml">s</mi></mrow><mo id="S3.E4.m1.2.2.2.2.4" xref="S3.E4.m1.2.2.2.3.cmml">,</mo><mrow id="S3.E4.m1.2.2.2.2.2" xref="S3.E4.m1.2.2.2.2.2.cmml"><mn id="S3.E4.m1.2.2.2.2.2.2" xref="S3.E4.m1.2.2.2.2.2.2.cmml">2</mn><mo id="S3.E4.m1.2.2.2.2.2.1" xref="S3.E4.m1.2.2.2.2.2.1.cmml">⁢</mo><mi id="S3.E4.m1.2.2.2.2.2.3" xref="S3.E4.m1.2.2.2.2.2.3.cmml">i</mi></mrow><mo id="S3.E4.m1.2.2.2.2.5" stretchy="false" xref="S3.E4.m1.2.2.2.3.cmml">)</mo></mrow></msub><mo id="S3.E4.m1.5.5.1.1.1" xref="S3.E4.m1.5.5.1.1.1.cmml">=</mo><mrow id="S3.E4.m1.5.5.1.1.3.2" xref="S3.E4.m1.5.5.1.1.3.1.cmml"><mi id="S3.E4.m1.3.3" xref="S3.E4.m1.3.3.cmml">sin</mi><mo id="S3.E4.m1.5.5.1.1.3.2a" xref="S3.E4.m1.5.5.1.1.3.1.cmml">⁡</mo><mrow id="S3.E4.m1.5.5.1.1.3.2.1" xref="S3.E4.m1.5.5.1.1.3.1.cmml"><mo id="S3.E4.m1.5.5.1.1.3.2.1.1" xref="S3.E4.m1.5.5.1.1.3.1.cmml">(</mo><mfrac id="S3.E4.m1.4.4" xref="S3.E4.m1.4.4.cmml"><mrow id="S3.E4.m1.4.4.2" xref="S3.E4.m1.4.4.2.cmml"><mi id="S3.E4.m1.4.4.2.2" xref="S3.E4.m1.4.4.2.2.cmml">p</mi><mo id="S3.E4.m1.4.4.2.1" xref="S3.E4.m1.4.4.2.1.cmml">⁢</mo><mi id="S3.E4.m1.4.4.2.3" xref="S3.E4.m1.4.4.2.3.cmml">o</mi><mo id="S3.E4.m1.4.4.2.1a" xref="S3.E4.m1.4.4.2.1.cmml">⁢</mo><mi id="S3.E4.m1.4.4.2.4" xref="S3.E4.m1.4.4.2.4.cmml">s</mi></mrow><msup id="S3.E4.m1.4.4.3" xref="S3.E4.m1.4.4.3.cmml"><mn id="S3.E4.m1.4.4.3.2" xref="S3.E4.m1.4.4.3.2.cmml">10000</mn><mfrac id="S3.E4.m1.4.4.3.3" xref="S3.E4.m1.4.4.3.3.cmml"><mrow id="S3.E4.m1.4.4.3.3.2" xref="S3.E4.m1.4.4.3.3.2.cmml"><mn id="S3.E4.m1.4.4.3.3.2.2" xref="S3.E4.m1.4.4.3.3.2.2.cmml">2</mn><mo id="S3.E4.m1.4.4.3.3.2.1" xref="S3.E4.m1.4.4.3.3.2.1.cmml">⁢</mo><mi id="S3.E4.m1.4.4.3.3.2.3" xref="S3.E4.m1.4.4.3.3.2.3.cmml">i</mi></mrow><mi id="S3.E4.m1.4.4.3.3.3" xref="S3.E4.m1.4.4.3.3.3.cmml">d</mi></mfrac></msup></mfrac><mo id="S3.E4.m1.5.5.1.1.3.2.1.2" xref="S3.E4.m1.5.5.1.1.3.1.cmml">)</mo></mrow></mrow></mrow><mo id="S3.E4.m1.5.5.1.2" xref="S3.E4.m1.5.5.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E4.m1.5b"><apply id="S3.E4.m1.5.5.1.1.cmml" xref="S3.E4.m1.5.5.1"><eq id="S3.E4.m1.5.5.1.1.1.cmml" xref="S3.E4.m1.5.5.1.1.1"></eq><apply id="S3.E4.m1.5.5.1.1.2.cmml" xref="S3.E4.m1.5.5.1.1.2"><csymbol cd="ambiguous" id="S3.E4.m1.5.5.1.1.2.1.cmml" xref="S3.E4.m1.5.5.1.1.2">subscript</csymbol><ci id="S3.E4.m1.5.5.1.1.2.2.cmml" xref="S3.E4.m1.5.5.1.1.2.2">𝑃</ci><interval closure="open" id="S3.E4.m1.2.2.2.3.cmml" xref="S3.E4.m1.2.2.2.2"><apply id="S3.E4.m1.1.1.1.1.1.cmml" xref="S3.E4.m1.1.1.1.1.1"><times id="S3.E4.m1.1.1.1.1.1.1.cmml" xref="S3.E4.m1.1.1.1.1.1.1"></times><ci id="S3.E4.m1.1.1.1.1.1.2.cmml" xref="S3.E4.m1.1.1.1.1.1.2">𝑝</ci><ci id="S3.E4.m1.1.1.1.1.1.3.cmml" xref="S3.E4.m1.1.1.1.1.1.3">𝑜</ci><ci id="S3.E4.m1.1.1.1.1.1.4.cmml" xref="S3.E4.m1.1.1.1.1.1.4">𝑠</ci></apply><apply id="S3.E4.m1.2.2.2.2.2.cmml" xref="S3.E4.m1.2.2.2.2.2"><times id="S3.E4.m1.2.2.2.2.2.1.cmml" xref="S3.E4.m1.2.2.2.2.2.1"></times><cn id="S3.E4.m1.2.2.2.2.2.2.cmml" type="integer" xref="S3.E4.m1.2.2.2.2.2.2">2</cn><ci id="S3.E4.m1.2.2.2.2.2.3.cmml" xref="S3.E4.m1.2.2.2.2.2.3">𝑖</ci></apply></interval></apply><apply id="S3.E4.m1.5.5.1.1.3.1.cmml" xref="S3.E4.m1.5.5.1.1.3.2"><sin id="S3.E4.m1.3.3.cmml" xref="S3.E4.m1.3.3"></sin><apply id="S3.E4.m1.4.4.cmml" xref="S3.E4.m1.4.4"><divide id="S3.E4.m1.4.4.1.cmml" xref="S3.E4.m1.4.4"></divide><apply id="S3.E4.m1.4.4.2.cmml" xref="S3.E4.m1.4.4.2"><times id="S3.E4.m1.4.4.2.1.cmml" xref="S3.E4.m1.4.4.2.1"></times><ci id="S3.E4.m1.4.4.2.2.cmml" xref="S3.E4.m1.4.4.2.2">𝑝</ci><ci id="S3.E4.m1.4.4.2.3.cmml" xref="S3.E4.m1.4.4.2.3">𝑜</ci><ci id="S3.E4.m1.4.4.2.4.cmml" xref="S3.E4.m1.4.4.2.4">𝑠</ci></apply><apply id="S3.E4.m1.4.4.3.cmml" xref="S3.E4.m1.4.4.3"><csymbol cd="ambiguous" id="S3.E4.m1.4.4.3.1.cmml" xref="S3.E4.m1.4.4.3">superscript</csymbol><cn id="S3.E4.m1.4.4.3.2.cmml" type="integer" xref="S3.E4.m1.4.4.3.2">10000</cn><apply id="S3.E4.m1.4.4.3.3.cmml" xref="S3.E4.m1.4.4.3.3"><divide id="S3.E4.m1.4.4.3.3.1.cmml" xref="S3.E4.m1.4.4.3.3"></divide><apply id="S3.E4.m1.4.4.3.3.2.cmml" xref="S3.E4.m1.4.4.3.3.2"><times id="S3.E4.m1.4.4.3.3.2.1.cmml" xref="S3.E4.m1.4.4.3.3.2.1"></times><cn id="S3.E4.m1.4.4.3.3.2.2.cmml" type="integer" xref="S3.E4.m1.4.4.3.3.2.2">2</cn><ci id="S3.E4.m1.4.4.3.3.2.3.cmml" xref="S3.E4.m1.4.4.3.3.2.3">𝑖</ci></apply><ci id="S3.E4.m1.4.4.3.3.3.cmml" xref="S3.E4.m1.4.4.3.3.3">𝑑</ci></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E4.m1.5c">P_{(pos,2i)}=\sin{\left(\frac{pos}{10000^{\frac{2i}{d}}}\right)},</annotation><annotation encoding="application/x-llamapun" id="S3.E4.m1.5d">italic_P start_POSTSUBSCRIPT ( italic_p italic_o italic_s , 2 italic_i ) end_POSTSUBSCRIPT = roman_sin ( divide start_ARG italic_p italic_o italic_s end_ARG start_ARG 10000 start_POSTSUPERSCRIPT divide start_ARG 2 italic_i end_ARG start_ARG italic_d end_ARG end_POSTSUPERSCRIPT end_ARG ) ,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_left_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(4)</span></td>
</tr></tbody>
</table>
</div>
<div class="ltx_para" id="S3.SS5.p6">
<table class="ltx_equation ltx_eqn_table" id="S3.E5">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_left_padleft"></td>
<td class="ltx_eqn_cell ltx_align_left"><math alttext="P_{(pos,2i+1)}=\cos{\left(\frac{pos}{10000^{\frac{2i}{d}}}\right)}," class="ltx_Math" display="block" id="S3.E5.m1.5"><semantics id="S3.E5.m1.5a"><mrow id="S3.E5.m1.5.5.1" xref="S3.E5.m1.5.5.1.1.cmml"><mrow id="S3.E5.m1.5.5.1.1" xref="S3.E5.m1.5.5.1.1.cmml"><msub id="S3.E5.m1.5.5.1.1.2" xref="S3.E5.m1.5.5.1.1.2.cmml"><mi id="S3.E5.m1.5.5.1.1.2.2" xref="S3.E5.m1.5.5.1.1.2.2.cmml">P</mi><mrow id="S3.E5.m1.2.2.2.2" xref="S3.E5.m1.2.2.2.3.cmml"><mo id="S3.E5.m1.2.2.2.2.3" stretchy="false" xref="S3.E5.m1.2.2.2.3.cmml">(</mo><mrow id="S3.E5.m1.1.1.1.1.1" xref="S3.E5.m1.1.1.1.1.1.cmml"><mi id="S3.E5.m1.1.1.1.1.1.2" xref="S3.E5.m1.1.1.1.1.1.2.cmml">p</mi><mo id="S3.E5.m1.1.1.1.1.1.1" xref="S3.E5.m1.1.1.1.1.1.1.cmml">⁢</mo><mi id="S3.E5.m1.1.1.1.1.1.3" xref="S3.E5.m1.1.1.1.1.1.3.cmml">o</mi><mo id="S3.E5.m1.1.1.1.1.1.1a" xref="S3.E5.m1.1.1.1.1.1.1.cmml">⁢</mo><mi id="S3.E5.m1.1.1.1.1.1.4" xref="S3.E5.m1.1.1.1.1.1.4.cmml">s</mi></mrow><mo id="S3.E5.m1.2.2.2.2.4" xref="S3.E5.m1.2.2.2.3.cmml">,</mo><mrow id="S3.E5.m1.2.2.2.2.2" xref="S3.E5.m1.2.2.2.2.2.cmml"><mrow id="S3.E5.m1.2.2.2.2.2.2" xref="S3.E5.m1.2.2.2.2.2.2.cmml"><mn id="S3.E5.m1.2.2.2.2.2.2.2" xref="S3.E5.m1.2.2.2.2.2.2.2.cmml">2</mn><mo id="S3.E5.m1.2.2.2.2.2.2.1" xref="S3.E5.m1.2.2.2.2.2.2.1.cmml">⁢</mo><mi id="S3.E5.m1.2.2.2.2.2.2.3" xref="S3.E5.m1.2.2.2.2.2.2.3.cmml">i</mi></mrow><mo id="S3.E5.m1.2.2.2.2.2.1" xref="S3.E5.m1.2.2.2.2.2.1.cmml">+</mo><mn id="S3.E5.m1.2.2.2.2.2.3" xref="S3.E5.m1.2.2.2.2.2.3.cmml">1</mn></mrow><mo id="S3.E5.m1.2.2.2.2.5" stretchy="false" xref="S3.E5.m1.2.2.2.3.cmml">)</mo></mrow></msub><mo id="S3.E5.m1.5.5.1.1.1" xref="S3.E5.m1.5.5.1.1.1.cmml">=</mo><mrow id="S3.E5.m1.5.5.1.1.3.2" xref="S3.E5.m1.5.5.1.1.3.1.cmml"><mi id="S3.E5.m1.3.3" xref="S3.E5.m1.3.3.cmml">cos</mi><mo id="S3.E5.m1.5.5.1.1.3.2a" xref="S3.E5.m1.5.5.1.1.3.1.cmml">⁡</mo><mrow id="S3.E5.m1.5.5.1.1.3.2.1" xref="S3.E5.m1.5.5.1.1.3.1.cmml"><mo id="S3.E5.m1.5.5.1.1.3.2.1.1" xref="S3.E5.m1.5.5.1.1.3.1.cmml">(</mo><mfrac id="S3.E5.m1.4.4" xref="S3.E5.m1.4.4.cmml"><mrow id="S3.E5.m1.4.4.2" xref="S3.E5.m1.4.4.2.cmml"><mi id="S3.E5.m1.4.4.2.2" xref="S3.E5.m1.4.4.2.2.cmml">p</mi><mo id="S3.E5.m1.4.4.2.1" xref="S3.E5.m1.4.4.2.1.cmml">⁢</mo><mi id="S3.E5.m1.4.4.2.3" xref="S3.E5.m1.4.4.2.3.cmml">o</mi><mo id="S3.E5.m1.4.4.2.1a" xref="S3.E5.m1.4.4.2.1.cmml">⁢</mo><mi id="S3.E5.m1.4.4.2.4" xref="S3.E5.m1.4.4.2.4.cmml">s</mi></mrow><msup id="S3.E5.m1.4.4.3" xref="S3.E5.m1.4.4.3.cmml"><mn id="S3.E5.m1.4.4.3.2" xref="S3.E5.m1.4.4.3.2.cmml">10000</mn><mfrac id="S3.E5.m1.4.4.3.3" xref="S3.E5.m1.4.4.3.3.cmml"><mrow id="S3.E5.m1.4.4.3.3.2" xref="S3.E5.m1.4.4.3.3.2.cmml"><mn id="S3.E5.m1.4.4.3.3.2.2" xref="S3.E5.m1.4.4.3.3.2.2.cmml">2</mn><mo id="S3.E5.m1.4.4.3.3.2.1" xref="S3.E5.m1.4.4.3.3.2.1.cmml">⁢</mo><mi id="S3.E5.m1.4.4.3.3.2.3" xref="S3.E5.m1.4.4.3.3.2.3.cmml">i</mi></mrow><mi id="S3.E5.m1.4.4.3.3.3" xref="S3.E5.m1.4.4.3.3.3.cmml">d</mi></mfrac></msup></mfrac><mo id="S3.E5.m1.5.5.1.1.3.2.1.2" xref="S3.E5.m1.5.5.1.1.3.1.cmml">)</mo></mrow></mrow></mrow><mo id="S3.E5.m1.5.5.1.2" xref="S3.E5.m1.5.5.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E5.m1.5b"><apply id="S3.E5.m1.5.5.1.1.cmml" xref="S3.E5.m1.5.5.1"><eq id="S3.E5.m1.5.5.1.1.1.cmml" xref="S3.E5.m1.5.5.1.1.1"></eq><apply id="S3.E5.m1.5.5.1.1.2.cmml" xref="S3.E5.m1.5.5.1.1.2"><csymbol cd="ambiguous" id="S3.E5.m1.5.5.1.1.2.1.cmml" xref="S3.E5.m1.5.5.1.1.2">subscript</csymbol><ci id="S3.E5.m1.5.5.1.1.2.2.cmml" xref="S3.E5.m1.5.5.1.1.2.2">𝑃</ci><interval closure="open" id="S3.E5.m1.2.2.2.3.cmml" xref="S3.E5.m1.2.2.2.2"><apply id="S3.E5.m1.1.1.1.1.1.cmml" xref="S3.E5.m1.1.1.1.1.1"><times id="S3.E5.m1.1.1.1.1.1.1.cmml" xref="S3.E5.m1.1.1.1.1.1.1"></times><ci id="S3.E5.m1.1.1.1.1.1.2.cmml" xref="S3.E5.m1.1.1.1.1.1.2">𝑝</ci><ci id="S3.E5.m1.1.1.1.1.1.3.cmml" xref="S3.E5.m1.1.1.1.1.1.3">𝑜</ci><ci id="S3.E5.m1.1.1.1.1.1.4.cmml" xref="S3.E5.m1.1.1.1.1.1.4">𝑠</ci></apply><apply id="S3.E5.m1.2.2.2.2.2.cmml" xref="S3.E5.m1.2.2.2.2.2"><plus id="S3.E5.m1.2.2.2.2.2.1.cmml" xref="S3.E5.m1.2.2.2.2.2.1"></plus><apply id="S3.E5.m1.2.2.2.2.2.2.cmml" xref="S3.E5.m1.2.2.2.2.2.2"><times id="S3.E5.m1.2.2.2.2.2.2.1.cmml" xref="S3.E5.m1.2.2.2.2.2.2.1"></times><cn id="S3.E5.m1.2.2.2.2.2.2.2.cmml" type="integer" xref="S3.E5.m1.2.2.2.2.2.2.2">2</cn><ci id="S3.E5.m1.2.2.2.2.2.2.3.cmml" xref="S3.E5.m1.2.2.2.2.2.2.3">𝑖</ci></apply><cn id="S3.E5.m1.2.2.2.2.2.3.cmml" type="integer" xref="S3.E5.m1.2.2.2.2.2.3">1</cn></apply></interval></apply><apply id="S3.E5.m1.5.5.1.1.3.1.cmml" xref="S3.E5.m1.5.5.1.1.3.2"><cos id="S3.E5.m1.3.3.cmml" xref="S3.E5.m1.3.3"></cos><apply id="S3.E5.m1.4.4.cmml" xref="S3.E5.m1.4.4"><divide id="S3.E5.m1.4.4.1.cmml" xref="S3.E5.m1.4.4"></divide><apply id="S3.E5.m1.4.4.2.cmml" xref="S3.E5.m1.4.4.2"><times id="S3.E5.m1.4.4.2.1.cmml" xref="S3.E5.m1.4.4.2.1"></times><ci id="S3.E5.m1.4.4.2.2.cmml" xref="S3.E5.m1.4.4.2.2">𝑝</ci><ci id="S3.E5.m1.4.4.2.3.cmml" xref="S3.E5.m1.4.4.2.3">𝑜</ci><ci id="S3.E5.m1.4.4.2.4.cmml" xref="S3.E5.m1.4.4.2.4">𝑠</ci></apply><apply id="S3.E5.m1.4.4.3.cmml" xref="S3.E5.m1.4.4.3"><csymbol cd="ambiguous" id="S3.E5.m1.4.4.3.1.cmml" xref="S3.E5.m1.4.4.3">superscript</csymbol><cn id="S3.E5.m1.4.4.3.2.cmml" type="integer" xref="S3.E5.m1.4.4.3.2">10000</cn><apply id="S3.E5.m1.4.4.3.3.cmml" xref="S3.E5.m1.4.4.3.3"><divide id="S3.E5.m1.4.4.3.3.1.cmml" xref="S3.E5.m1.4.4.3.3"></divide><apply id="S3.E5.m1.4.4.3.3.2.cmml" xref="S3.E5.m1.4.4.3.3.2"><times id="S3.E5.m1.4.4.3.3.2.1.cmml" xref="S3.E5.m1.4.4.3.3.2.1"></times><cn id="S3.E5.m1.4.4.3.3.2.2.cmml" type="integer" xref="S3.E5.m1.4.4.3.3.2.2">2</cn><ci id="S3.E5.m1.4.4.3.3.2.3.cmml" xref="S3.E5.m1.4.4.3.3.2.3">𝑖</ci></apply><ci id="S3.E5.m1.4.4.3.3.3.cmml" xref="S3.E5.m1.4.4.3.3.3">𝑑</ci></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E5.m1.5c">P_{(pos,2i+1)}=\cos{\left(\frac{pos}{10000^{\frac{2i}{d}}}\right)},</annotation><annotation encoding="application/x-llamapun" id="S3.E5.m1.5d">italic_P start_POSTSUBSCRIPT ( italic_p italic_o italic_s , 2 italic_i + 1 ) end_POSTSUBSCRIPT = roman_cos ( divide start_ARG italic_p italic_o italic_s end_ARG start_ARG 10000 start_POSTSUPERSCRIPT divide start_ARG 2 italic_i end_ARG start_ARG italic_d end_ARG end_POSTSUPERSCRIPT end_ARG ) ,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_left_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(5)</span></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S3.SS5.p6.4">where <math alttext="pos" class="ltx_Math" display="inline" id="S3.SS5.p6.1.m1.1"><semantics id="S3.SS5.p6.1.m1.1a"><mrow id="S3.SS5.p6.1.m1.1.1" xref="S3.SS5.p6.1.m1.1.1.cmml"><mi id="S3.SS5.p6.1.m1.1.1.2" xref="S3.SS5.p6.1.m1.1.1.2.cmml">p</mi><mo id="S3.SS5.p6.1.m1.1.1.1" xref="S3.SS5.p6.1.m1.1.1.1.cmml">⁢</mo><mi id="S3.SS5.p6.1.m1.1.1.3" xref="S3.SS5.p6.1.m1.1.1.3.cmml">o</mi><mo id="S3.SS5.p6.1.m1.1.1.1a" xref="S3.SS5.p6.1.m1.1.1.1.cmml">⁢</mo><mi id="S3.SS5.p6.1.m1.1.1.4" xref="S3.SS5.p6.1.m1.1.1.4.cmml">s</mi></mrow><annotation-xml encoding="MathML-Content" id="S3.SS5.p6.1.m1.1b"><apply id="S3.SS5.p6.1.m1.1.1.cmml" xref="S3.SS5.p6.1.m1.1.1"><times id="S3.SS5.p6.1.m1.1.1.1.cmml" xref="S3.SS5.p6.1.m1.1.1.1"></times><ci id="S3.SS5.p6.1.m1.1.1.2.cmml" xref="S3.SS5.p6.1.m1.1.1.2">𝑝</ci><ci id="S3.SS5.p6.1.m1.1.1.3.cmml" xref="S3.SS5.p6.1.m1.1.1.3">𝑜</ci><ci id="S3.SS5.p6.1.m1.1.1.4.cmml" xref="S3.SS5.p6.1.m1.1.1.4">𝑠</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS5.p6.1.m1.1c">pos</annotation><annotation encoding="application/x-llamapun" id="S3.SS5.p6.1.m1.1d">italic_p italic_o italic_s</annotation></semantics></math> represents the position, <math alttext="i" class="ltx_Math" display="inline" id="S3.SS5.p6.2.m2.1"><semantics id="S3.SS5.p6.2.m2.1a"><mi id="S3.SS5.p6.2.m2.1.1" xref="S3.SS5.p6.2.m2.1.1.cmml">i</mi><annotation-xml encoding="MathML-Content" id="S3.SS5.p6.2.m2.1b"><ci id="S3.SS5.p6.2.m2.1.1.cmml" xref="S3.SS5.p6.2.m2.1.1">𝑖</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS5.p6.2.m2.1c">i</annotation><annotation encoding="application/x-llamapun" id="S3.SS5.p6.2.m2.1d">italic_i</annotation></semantics></math> represents the dimension. In practice, we add the positional coding matrix <math alttext="P" class="ltx_Math" display="inline" id="S3.SS5.p6.3.m3.1"><semantics id="S3.SS5.p6.3.m3.1a"><mi id="S3.SS5.p6.3.m3.1.1" xref="S3.SS5.p6.3.m3.1.1.cmml">P</mi><annotation-xml encoding="MathML-Content" id="S3.SS5.p6.3.m3.1b"><ci id="S3.SS5.p6.3.m3.1.1.cmml" xref="S3.SS5.p6.3.m3.1.1">𝑃</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS5.p6.3.m3.1c">P</annotation><annotation encoding="application/x-llamapun" id="S3.SS5.p6.3.m3.1d">italic_P</annotation></semantics></math> to a feature sequence <math alttext="V" class="ltx_Math" display="inline" id="S3.SS5.p6.4.m4.1"><semantics id="S3.SS5.p6.4.m4.1a"><mi id="S3.SS5.p6.4.m4.1.1" xref="S3.SS5.p6.4.m4.1.1.cmml">V</mi><annotation-xml encoding="MathML-Content" id="S3.SS5.p6.4.m4.1b"><ci id="S3.SS5.p6.4.m4.1.1.cmml" xref="S3.SS5.p6.4.m4.1.1">𝑉</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS5.p6.4.m4.1c">V</annotation><annotation encoding="application/x-llamapun" id="S3.SS5.p6.4.m4.1d">italic_V</annotation></semantics></math> to get the positional encoded feature sequence, the process reads as:</p>
</div>
<div class="ltx_para" id="S3.SS5.p7">
<table class="ltx_equation ltx_eqn_table" id="S3.E6">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_left_padleft"></td>
<td class="ltx_eqn_cell ltx_align_left"><math alttext="V_{i}^{pos}=V_{i}+P." class="ltx_Math" display="block" id="S3.E6.m1.1"><semantics id="S3.E6.m1.1a"><mrow id="S3.E6.m1.1.1.1" xref="S3.E6.m1.1.1.1.1.cmml"><mrow id="S3.E6.m1.1.1.1.1" xref="S3.E6.m1.1.1.1.1.cmml"><msubsup id="S3.E6.m1.1.1.1.1.2" xref="S3.E6.m1.1.1.1.1.2.cmml"><mi id="S3.E6.m1.1.1.1.1.2.2.2" xref="S3.E6.m1.1.1.1.1.2.2.2.cmml">V</mi><mi id="S3.E6.m1.1.1.1.1.2.2.3" xref="S3.E6.m1.1.1.1.1.2.2.3.cmml">i</mi><mrow id="S3.E6.m1.1.1.1.1.2.3" xref="S3.E6.m1.1.1.1.1.2.3.cmml"><mi id="S3.E6.m1.1.1.1.1.2.3.2" xref="S3.E6.m1.1.1.1.1.2.3.2.cmml">p</mi><mo id="S3.E6.m1.1.1.1.1.2.3.1" xref="S3.E6.m1.1.1.1.1.2.3.1.cmml">⁢</mo><mi id="S3.E6.m1.1.1.1.1.2.3.3" xref="S3.E6.m1.1.1.1.1.2.3.3.cmml">o</mi><mo id="S3.E6.m1.1.1.1.1.2.3.1a" xref="S3.E6.m1.1.1.1.1.2.3.1.cmml">⁢</mo><mi id="S3.E6.m1.1.1.1.1.2.3.4" xref="S3.E6.m1.1.1.1.1.2.3.4.cmml">s</mi></mrow></msubsup><mo id="S3.E6.m1.1.1.1.1.1" xref="S3.E6.m1.1.1.1.1.1.cmml">=</mo><mrow id="S3.E6.m1.1.1.1.1.3" xref="S3.E6.m1.1.1.1.1.3.cmml"><msub id="S3.E6.m1.1.1.1.1.3.2" xref="S3.E6.m1.1.1.1.1.3.2.cmml"><mi id="S3.E6.m1.1.1.1.1.3.2.2" xref="S3.E6.m1.1.1.1.1.3.2.2.cmml">V</mi><mi id="S3.E6.m1.1.1.1.1.3.2.3" xref="S3.E6.m1.1.1.1.1.3.2.3.cmml">i</mi></msub><mo id="S3.E6.m1.1.1.1.1.3.1" xref="S3.E6.m1.1.1.1.1.3.1.cmml">+</mo><mi id="S3.E6.m1.1.1.1.1.3.3" xref="S3.E6.m1.1.1.1.1.3.3.cmml">P</mi></mrow></mrow><mo id="S3.E6.m1.1.1.1.2" lspace="0em" xref="S3.E6.m1.1.1.1.1.cmml">.</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E6.m1.1b"><apply id="S3.E6.m1.1.1.1.1.cmml" xref="S3.E6.m1.1.1.1"><eq id="S3.E6.m1.1.1.1.1.1.cmml" xref="S3.E6.m1.1.1.1.1.1"></eq><apply id="S3.E6.m1.1.1.1.1.2.cmml" xref="S3.E6.m1.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.E6.m1.1.1.1.1.2.1.cmml" xref="S3.E6.m1.1.1.1.1.2">superscript</csymbol><apply id="S3.E6.m1.1.1.1.1.2.2.cmml" xref="S3.E6.m1.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.E6.m1.1.1.1.1.2.2.1.cmml" xref="S3.E6.m1.1.1.1.1.2">subscript</csymbol><ci id="S3.E6.m1.1.1.1.1.2.2.2.cmml" xref="S3.E6.m1.1.1.1.1.2.2.2">𝑉</ci><ci id="S3.E6.m1.1.1.1.1.2.2.3.cmml" xref="S3.E6.m1.1.1.1.1.2.2.3">𝑖</ci></apply><apply id="S3.E6.m1.1.1.1.1.2.3.cmml" xref="S3.E6.m1.1.1.1.1.2.3"><times id="S3.E6.m1.1.1.1.1.2.3.1.cmml" xref="S3.E6.m1.1.1.1.1.2.3.1"></times><ci id="S3.E6.m1.1.1.1.1.2.3.2.cmml" xref="S3.E6.m1.1.1.1.1.2.3.2">𝑝</ci><ci id="S3.E6.m1.1.1.1.1.2.3.3.cmml" xref="S3.E6.m1.1.1.1.1.2.3.3">𝑜</ci><ci id="S3.E6.m1.1.1.1.1.2.3.4.cmml" xref="S3.E6.m1.1.1.1.1.2.3.4">𝑠</ci></apply></apply><apply id="S3.E6.m1.1.1.1.1.3.cmml" xref="S3.E6.m1.1.1.1.1.3"><plus id="S3.E6.m1.1.1.1.1.3.1.cmml" xref="S3.E6.m1.1.1.1.1.3.1"></plus><apply id="S3.E6.m1.1.1.1.1.3.2.cmml" xref="S3.E6.m1.1.1.1.1.3.2"><csymbol cd="ambiguous" id="S3.E6.m1.1.1.1.1.3.2.1.cmml" xref="S3.E6.m1.1.1.1.1.3.2">subscript</csymbol><ci id="S3.E6.m1.1.1.1.1.3.2.2.cmml" xref="S3.E6.m1.1.1.1.1.3.2.2">𝑉</ci><ci id="S3.E6.m1.1.1.1.1.3.2.3.cmml" xref="S3.E6.m1.1.1.1.1.3.2.3">𝑖</ci></apply><ci id="S3.E6.m1.1.1.1.1.3.3.cmml" xref="S3.E6.m1.1.1.1.1.3.3">𝑃</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E6.m1.1c">V_{i}^{pos}=V_{i}+P.</annotation><annotation encoding="application/x-llamapun" id="S3.E6.m1.1d">italic_V start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_p italic_o italic_s end_POSTSUPERSCRIPT = italic_V start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT + italic_P .</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_left_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(6)</span></td>
</tr></tbody>
</table>
</div>
<div class="ltx_para" id="S3.SS5.p8">
<p class="ltx_p" id="S3.SS5.p8.1">The position encoded feature sequence is used as input for the transformer encoder. The transformer encoder consists of multiple self-attention layers and feedforward neural network layers that capture global associations between features through multi-head self-attention mechanisms.</p>
</div>
<div class="ltx_para" id="S3.SS5.p9">
<p class="ltx_p" id="S3.SS5.p9.1">At the heart of the self-attention mechanism lies the calculation of the importance of each token to the other tokens in the input sequence, which is achieved through three matrices: Query (Q), Key (K), and Value (V). These matrices are obtained from the input features by linear transformations as:</p>
</div>
<div class="ltx_para" id="S3.SS5.p10">
<table class="ltx_equation ltx_eqn_table" id="S3.E7">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_left_padleft"></td>
<td class="ltx_eqn_cell ltx_align_left"><math alttext="Q=V_{i}^{pos}\cdot W_{Q}," class="ltx_Math" display="block" id="S3.E7.m1.1"><semantics id="S3.E7.m1.1a"><mrow id="S3.E7.m1.1.1.1" xref="S3.E7.m1.1.1.1.1.cmml"><mrow id="S3.E7.m1.1.1.1.1" xref="S3.E7.m1.1.1.1.1.cmml"><mi id="S3.E7.m1.1.1.1.1.2" xref="S3.E7.m1.1.1.1.1.2.cmml">Q</mi><mo id="S3.E7.m1.1.1.1.1.1" xref="S3.E7.m1.1.1.1.1.1.cmml">=</mo><mrow id="S3.E7.m1.1.1.1.1.3" xref="S3.E7.m1.1.1.1.1.3.cmml"><msubsup id="S3.E7.m1.1.1.1.1.3.2" xref="S3.E7.m1.1.1.1.1.3.2.cmml"><mi id="S3.E7.m1.1.1.1.1.3.2.2.2" xref="S3.E7.m1.1.1.1.1.3.2.2.2.cmml">V</mi><mi id="S3.E7.m1.1.1.1.1.3.2.2.3" xref="S3.E7.m1.1.1.1.1.3.2.2.3.cmml">i</mi><mrow id="S3.E7.m1.1.1.1.1.3.2.3" xref="S3.E7.m1.1.1.1.1.3.2.3.cmml"><mi id="S3.E7.m1.1.1.1.1.3.2.3.2" xref="S3.E7.m1.1.1.1.1.3.2.3.2.cmml">p</mi><mo id="S3.E7.m1.1.1.1.1.3.2.3.1" xref="S3.E7.m1.1.1.1.1.3.2.3.1.cmml">⁢</mo><mi id="S3.E7.m1.1.1.1.1.3.2.3.3" xref="S3.E7.m1.1.1.1.1.3.2.3.3.cmml">o</mi><mo id="S3.E7.m1.1.1.1.1.3.2.3.1a" xref="S3.E7.m1.1.1.1.1.3.2.3.1.cmml">⁢</mo><mi id="S3.E7.m1.1.1.1.1.3.2.3.4" xref="S3.E7.m1.1.1.1.1.3.2.3.4.cmml">s</mi></mrow></msubsup><mo id="S3.E7.m1.1.1.1.1.3.1" lspace="0.222em" rspace="0.222em" xref="S3.E7.m1.1.1.1.1.3.1.cmml">⋅</mo><msub id="S3.E7.m1.1.1.1.1.3.3" xref="S3.E7.m1.1.1.1.1.3.3.cmml"><mi id="S3.E7.m1.1.1.1.1.3.3.2" xref="S3.E7.m1.1.1.1.1.3.3.2.cmml">W</mi><mi id="S3.E7.m1.1.1.1.1.3.3.3" xref="S3.E7.m1.1.1.1.1.3.3.3.cmml">Q</mi></msub></mrow></mrow><mo id="S3.E7.m1.1.1.1.2" xref="S3.E7.m1.1.1.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E7.m1.1b"><apply id="S3.E7.m1.1.1.1.1.cmml" xref="S3.E7.m1.1.1.1"><eq id="S3.E7.m1.1.1.1.1.1.cmml" xref="S3.E7.m1.1.1.1.1.1"></eq><ci id="S3.E7.m1.1.1.1.1.2.cmml" xref="S3.E7.m1.1.1.1.1.2">𝑄</ci><apply id="S3.E7.m1.1.1.1.1.3.cmml" xref="S3.E7.m1.1.1.1.1.3"><ci id="S3.E7.m1.1.1.1.1.3.1.cmml" xref="S3.E7.m1.1.1.1.1.3.1">⋅</ci><apply id="S3.E7.m1.1.1.1.1.3.2.cmml" xref="S3.E7.m1.1.1.1.1.3.2"><csymbol cd="ambiguous" id="S3.E7.m1.1.1.1.1.3.2.1.cmml" xref="S3.E7.m1.1.1.1.1.3.2">superscript</csymbol><apply id="S3.E7.m1.1.1.1.1.3.2.2.cmml" xref="S3.E7.m1.1.1.1.1.3.2"><csymbol cd="ambiguous" id="S3.E7.m1.1.1.1.1.3.2.2.1.cmml" xref="S3.E7.m1.1.1.1.1.3.2">subscript</csymbol><ci id="S3.E7.m1.1.1.1.1.3.2.2.2.cmml" xref="S3.E7.m1.1.1.1.1.3.2.2.2">𝑉</ci><ci id="S3.E7.m1.1.1.1.1.3.2.2.3.cmml" xref="S3.E7.m1.1.1.1.1.3.2.2.3">𝑖</ci></apply><apply id="S3.E7.m1.1.1.1.1.3.2.3.cmml" xref="S3.E7.m1.1.1.1.1.3.2.3"><times id="S3.E7.m1.1.1.1.1.3.2.3.1.cmml" xref="S3.E7.m1.1.1.1.1.3.2.3.1"></times><ci id="S3.E7.m1.1.1.1.1.3.2.3.2.cmml" xref="S3.E7.m1.1.1.1.1.3.2.3.2">𝑝</ci><ci id="S3.E7.m1.1.1.1.1.3.2.3.3.cmml" xref="S3.E7.m1.1.1.1.1.3.2.3.3">𝑜</ci><ci id="S3.E7.m1.1.1.1.1.3.2.3.4.cmml" xref="S3.E7.m1.1.1.1.1.3.2.3.4">𝑠</ci></apply></apply><apply id="S3.E7.m1.1.1.1.1.3.3.cmml" xref="S3.E7.m1.1.1.1.1.3.3"><csymbol cd="ambiguous" id="S3.E7.m1.1.1.1.1.3.3.1.cmml" xref="S3.E7.m1.1.1.1.1.3.3">subscript</csymbol><ci id="S3.E7.m1.1.1.1.1.3.3.2.cmml" xref="S3.E7.m1.1.1.1.1.3.3.2">𝑊</ci><ci id="S3.E7.m1.1.1.1.1.3.3.3.cmml" xref="S3.E7.m1.1.1.1.1.3.3.3">𝑄</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E7.m1.1c">Q=V_{i}^{pos}\cdot W_{Q},</annotation><annotation encoding="application/x-llamapun" id="S3.E7.m1.1d">italic_Q = italic_V start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_p italic_o italic_s end_POSTSUPERSCRIPT ⋅ italic_W start_POSTSUBSCRIPT italic_Q end_POSTSUBSCRIPT ,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_left_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(7)</span></td>
</tr></tbody>
</table>
</div>
<div class="ltx_para" id="S3.SS5.p11">
<table class="ltx_equation ltx_eqn_table" id="S3.E8">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_left_padleft"></td>
<td class="ltx_eqn_cell ltx_align_left"><math alttext="K=V_{i}^{pos}\cdot W_{K}," class="ltx_Math" display="block" id="S3.E8.m1.1"><semantics id="S3.E8.m1.1a"><mrow id="S3.E8.m1.1.1.1" xref="S3.E8.m1.1.1.1.1.cmml"><mrow id="S3.E8.m1.1.1.1.1" xref="S3.E8.m1.1.1.1.1.cmml"><mi id="S3.E8.m1.1.1.1.1.2" xref="S3.E8.m1.1.1.1.1.2.cmml">K</mi><mo id="S3.E8.m1.1.1.1.1.1" xref="S3.E8.m1.1.1.1.1.1.cmml">=</mo><mrow id="S3.E8.m1.1.1.1.1.3" xref="S3.E8.m1.1.1.1.1.3.cmml"><msubsup id="S3.E8.m1.1.1.1.1.3.2" xref="S3.E8.m1.1.1.1.1.3.2.cmml"><mi id="S3.E8.m1.1.1.1.1.3.2.2.2" xref="S3.E8.m1.1.1.1.1.3.2.2.2.cmml">V</mi><mi id="S3.E8.m1.1.1.1.1.3.2.2.3" xref="S3.E8.m1.1.1.1.1.3.2.2.3.cmml">i</mi><mrow id="S3.E8.m1.1.1.1.1.3.2.3" xref="S3.E8.m1.1.1.1.1.3.2.3.cmml"><mi id="S3.E8.m1.1.1.1.1.3.2.3.2" xref="S3.E8.m1.1.1.1.1.3.2.3.2.cmml">p</mi><mo id="S3.E8.m1.1.1.1.1.3.2.3.1" xref="S3.E8.m1.1.1.1.1.3.2.3.1.cmml">⁢</mo><mi id="S3.E8.m1.1.1.1.1.3.2.3.3" xref="S3.E8.m1.1.1.1.1.3.2.3.3.cmml">o</mi><mo id="S3.E8.m1.1.1.1.1.3.2.3.1a" xref="S3.E8.m1.1.1.1.1.3.2.3.1.cmml">⁢</mo><mi id="S3.E8.m1.1.1.1.1.3.2.3.4" xref="S3.E8.m1.1.1.1.1.3.2.3.4.cmml">s</mi></mrow></msubsup><mo id="S3.E8.m1.1.1.1.1.3.1" lspace="0.222em" rspace="0.222em" xref="S3.E8.m1.1.1.1.1.3.1.cmml">⋅</mo><msub id="S3.E8.m1.1.1.1.1.3.3" xref="S3.E8.m1.1.1.1.1.3.3.cmml"><mi id="S3.E8.m1.1.1.1.1.3.3.2" xref="S3.E8.m1.1.1.1.1.3.3.2.cmml">W</mi><mi id="S3.E8.m1.1.1.1.1.3.3.3" xref="S3.E8.m1.1.1.1.1.3.3.3.cmml">K</mi></msub></mrow></mrow><mo id="S3.E8.m1.1.1.1.2" xref="S3.E8.m1.1.1.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E8.m1.1b"><apply id="S3.E8.m1.1.1.1.1.cmml" xref="S3.E8.m1.1.1.1"><eq id="S3.E8.m1.1.1.1.1.1.cmml" xref="S3.E8.m1.1.1.1.1.1"></eq><ci id="S3.E8.m1.1.1.1.1.2.cmml" xref="S3.E8.m1.1.1.1.1.2">𝐾</ci><apply id="S3.E8.m1.1.1.1.1.3.cmml" xref="S3.E8.m1.1.1.1.1.3"><ci id="S3.E8.m1.1.1.1.1.3.1.cmml" xref="S3.E8.m1.1.1.1.1.3.1">⋅</ci><apply id="S3.E8.m1.1.1.1.1.3.2.cmml" xref="S3.E8.m1.1.1.1.1.3.2"><csymbol cd="ambiguous" id="S3.E8.m1.1.1.1.1.3.2.1.cmml" xref="S3.E8.m1.1.1.1.1.3.2">superscript</csymbol><apply id="S3.E8.m1.1.1.1.1.3.2.2.cmml" xref="S3.E8.m1.1.1.1.1.3.2"><csymbol cd="ambiguous" id="S3.E8.m1.1.1.1.1.3.2.2.1.cmml" xref="S3.E8.m1.1.1.1.1.3.2">subscript</csymbol><ci id="S3.E8.m1.1.1.1.1.3.2.2.2.cmml" xref="S3.E8.m1.1.1.1.1.3.2.2.2">𝑉</ci><ci id="S3.E8.m1.1.1.1.1.3.2.2.3.cmml" xref="S3.E8.m1.1.1.1.1.3.2.2.3">𝑖</ci></apply><apply id="S3.E8.m1.1.1.1.1.3.2.3.cmml" xref="S3.E8.m1.1.1.1.1.3.2.3"><times id="S3.E8.m1.1.1.1.1.3.2.3.1.cmml" xref="S3.E8.m1.1.1.1.1.3.2.3.1"></times><ci id="S3.E8.m1.1.1.1.1.3.2.3.2.cmml" xref="S3.E8.m1.1.1.1.1.3.2.3.2">𝑝</ci><ci id="S3.E8.m1.1.1.1.1.3.2.3.3.cmml" xref="S3.E8.m1.1.1.1.1.3.2.3.3">𝑜</ci><ci id="S3.E8.m1.1.1.1.1.3.2.3.4.cmml" xref="S3.E8.m1.1.1.1.1.3.2.3.4">𝑠</ci></apply></apply><apply id="S3.E8.m1.1.1.1.1.3.3.cmml" xref="S3.E8.m1.1.1.1.1.3.3"><csymbol cd="ambiguous" id="S3.E8.m1.1.1.1.1.3.3.1.cmml" xref="S3.E8.m1.1.1.1.1.3.3">subscript</csymbol><ci id="S3.E8.m1.1.1.1.1.3.3.2.cmml" xref="S3.E8.m1.1.1.1.1.3.3.2">𝑊</ci><ci id="S3.E8.m1.1.1.1.1.3.3.3.cmml" xref="S3.E8.m1.1.1.1.1.3.3.3">𝐾</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E8.m1.1c">K=V_{i}^{pos}\cdot W_{K},</annotation><annotation encoding="application/x-llamapun" id="S3.E8.m1.1d">italic_K = italic_V start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_p italic_o italic_s end_POSTSUPERSCRIPT ⋅ italic_W start_POSTSUBSCRIPT italic_K end_POSTSUBSCRIPT ,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_left_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(8)</span></td>
</tr></tbody>
</table>
</div>
<div class="ltx_para" id="S3.SS5.p12">
<table class="ltx_equation ltx_eqn_table" id="S3.E9">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_left_padleft"></td>
<td class="ltx_eqn_cell ltx_align_left"><math alttext="V=V_{i}^{pos}\cdot W_{V}," class="ltx_Math" display="block" id="S3.E9.m1.1"><semantics id="S3.E9.m1.1a"><mrow id="S3.E9.m1.1.1.1" xref="S3.E9.m1.1.1.1.1.cmml"><mrow id="S3.E9.m1.1.1.1.1" xref="S3.E9.m1.1.1.1.1.cmml"><mi id="S3.E9.m1.1.1.1.1.2" xref="S3.E9.m1.1.1.1.1.2.cmml">V</mi><mo id="S3.E9.m1.1.1.1.1.1" xref="S3.E9.m1.1.1.1.1.1.cmml">=</mo><mrow id="S3.E9.m1.1.1.1.1.3" xref="S3.E9.m1.1.1.1.1.3.cmml"><msubsup id="S3.E9.m1.1.1.1.1.3.2" xref="S3.E9.m1.1.1.1.1.3.2.cmml"><mi id="S3.E9.m1.1.1.1.1.3.2.2.2" xref="S3.E9.m1.1.1.1.1.3.2.2.2.cmml">V</mi><mi id="S3.E9.m1.1.1.1.1.3.2.2.3" xref="S3.E9.m1.1.1.1.1.3.2.2.3.cmml">i</mi><mrow id="S3.E9.m1.1.1.1.1.3.2.3" xref="S3.E9.m1.1.1.1.1.3.2.3.cmml"><mi id="S3.E9.m1.1.1.1.1.3.2.3.2" xref="S3.E9.m1.1.1.1.1.3.2.3.2.cmml">p</mi><mo id="S3.E9.m1.1.1.1.1.3.2.3.1" xref="S3.E9.m1.1.1.1.1.3.2.3.1.cmml">⁢</mo><mi id="S3.E9.m1.1.1.1.1.3.2.3.3" xref="S3.E9.m1.1.1.1.1.3.2.3.3.cmml">o</mi><mo id="S3.E9.m1.1.1.1.1.3.2.3.1a" xref="S3.E9.m1.1.1.1.1.3.2.3.1.cmml">⁢</mo><mi id="S3.E9.m1.1.1.1.1.3.2.3.4" xref="S3.E9.m1.1.1.1.1.3.2.3.4.cmml">s</mi></mrow></msubsup><mo id="S3.E9.m1.1.1.1.1.3.1" lspace="0.222em" rspace="0.222em" xref="S3.E9.m1.1.1.1.1.3.1.cmml">⋅</mo><msub id="S3.E9.m1.1.1.1.1.3.3" xref="S3.E9.m1.1.1.1.1.3.3.cmml"><mi id="S3.E9.m1.1.1.1.1.3.3.2" xref="S3.E9.m1.1.1.1.1.3.3.2.cmml">W</mi><mi id="S3.E9.m1.1.1.1.1.3.3.3" xref="S3.E9.m1.1.1.1.1.3.3.3.cmml">V</mi></msub></mrow></mrow><mo id="S3.E9.m1.1.1.1.2" xref="S3.E9.m1.1.1.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E9.m1.1b"><apply id="S3.E9.m1.1.1.1.1.cmml" xref="S3.E9.m1.1.1.1"><eq id="S3.E9.m1.1.1.1.1.1.cmml" xref="S3.E9.m1.1.1.1.1.1"></eq><ci id="S3.E9.m1.1.1.1.1.2.cmml" xref="S3.E9.m1.1.1.1.1.2">𝑉</ci><apply id="S3.E9.m1.1.1.1.1.3.cmml" xref="S3.E9.m1.1.1.1.1.3"><ci id="S3.E9.m1.1.1.1.1.3.1.cmml" xref="S3.E9.m1.1.1.1.1.3.1">⋅</ci><apply id="S3.E9.m1.1.1.1.1.3.2.cmml" xref="S3.E9.m1.1.1.1.1.3.2"><csymbol cd="ambiguous" id="S3.E9.m1.1.1.1.1.3.2.1.cmml" xref="S3.E9.m1.1.1.1.1.3.2">superscript</csymbol><apply id="S3.E9.m1.1.1.1.1.3.2.2.cmml" xref="S3.E9.m1.1.1.1.1.3.2"><csymbol cd="ambiguous" id="S3.E9.m1.1.1.1.1.3.2.2.1.cmml" xref="S3.E9.m1.1.1.1.1.3.2">subscript</csymbol><ci id="S3.E9.m1.1.1.1.1.3.2.2.2.cmml" xref="S3.E9.m1.1.1.1.1.3.2.2.2">𝑉</ci><ci id="S3.E9.m1.1.1.1.1.3.2.2.3.cmml" xref="S3.E9.m1.1.1.1.1.3.2.2.3">𝑖</ci></apply><apply id="S3.E9.m1.1.1.1.1.3.2.3.cmml" xref="S3.E9.m1.1.1.1.1.3.2.3"><times id="S3.E9.m1.1.1.1.1.3.2.3.1.cmml" xref="S3.E9.m1.1.1.1.1.3.2.3.1"></times><ci id="S3.E9.m1.1.1.1.1.3.2.3.2.cmml" xref="S3.E9.m1.1.1.1.1.3.2.3.2">𝑝</ci><ci id="S3.E9.m1.1.1.1.1.3.2.3.3.cmml" xref="S3.E9.m1.1.1.1.1.3.2.3.3">𝑜</ci><ci id="S3.E9.m1.1.1.1.1.3.2.3.4.cmml" xref="S3.E9.m1.1.1.1.1.3.2.3.4">𝑠</ci></apply></apply><apply id="S3.E9.m1.1.1.1.1.3.3.cmml" xref="S3.E9.m1.1.1.1.1.3.3"><csymbol cd="ambiguous" id="S3.E9.m1.1.1.1.1.3.3.1.cmml" xref="S3.E9.m1.1.1.1.1.3.3">subscript</csymbol><ci id="S3.E9.m1.1.1.1.1.3.3.2.cmml" xref="S3.E9.m1.1.1.1.1.3.3.2">𝑊</ci><ci id="S3.E9.m1.1.1.1.1.3.3.3.cmml" xref="S3.E9.m1.1.1.1.1.3.3.3">𝑉</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E9.m1.1c">V=V_{i}^{pos}\cdot W_{V},</annotation><annotation encoding="application/x-llamapun" id="S3.E9.m1.1d">italic_V = italic_V start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_p italic_o italic_s end_POSTSUPERSCRIPT ⋅ italic_W start_POSTSUBSCRIPT italic_V end_POSTSUBSCRIPT ,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_left_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(9)</span></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S3.SS5.p12.2">where, <math alttext="W_{Q},W_{K},W_{V}" class="ltx_Math" display="inline" id="S3.SS5.p12.1.m1.3"><semantics id="S3.SS5.p12.1.m1.3a"><mrow id="S3.SS5.p12.1.m1.3.3.3" xref="S3.SS5.p12.1.m1.3.3.4.cmml"><msub id="S3.SS5.p12.1.m1.1.1.1.1" xref="S3.SS5.p12.1.m1.1.1.1.1.cmml"><mi id="S3.SS5.p12.1.m1.1.1.1.1.2" xref="S3.SS5.p12.1.m1.1.1.1.1.2.cmml">W</mi><mi id="S3.SS5.p12.1.m1.1.1.1.1.3" xref="S3.SS5.p12.1.m1.1.1.1.1.3.cmml">Q</mi></msub><mo id="S3.SS5.p12.1.m1.3.3.3.4" xref="S3.SS5.p12.1.m1.3.3.4.cmml">,</mo><msub id="S3.SS5.p12.1.m1.2.2.2.2" xref="S3.SS5.p12.1.m1.2.2.2.2.cmml"><mi id="S3.SS5.p12.1.m1.2.2.2.2.2" xref="S3.SS5.p12.1.m1.2.2.2.2.2.cmml">W</mi><mi id="S3.SS5.p12.1.m1.2.2.2.2.3" xref="S3.SS5.p12.1.m1.2.2.2.2.3.cmml">K</mi></msub><mo id="S3.SS5.p12.1.m1.3.3.3.5" xref="S3.SS5.p12.1.m1.3.3.4.cmml">,</mo><msub id="S3.SS5.p12.1.m1.3.3.3.3" xref="S3.SS5.p12.1.m1.3.3.3.3.cmml"><mi id="S3.SS5.p12.1.m1.3.3.3.3.2" xref="S3.SS5.p12.1.m1.3.3.3.3.2.cmml">W</mi><mi id="S3.SS5.p12.1.m1.3.3.3.3.3" xref="S3.SS5.p12.1.m1.3.3.3.3.3.cmml">V</mi></msub></mrow><annotation-xml encoding="MathML-Content" id="S3.SS5.p12.1.m1.3b"><list id="S3.SS5.p12.1.m1.3.3.4.cmml" xref="S3.SS5.p12.1.m1.3.3.3"><apply id="S3.SS5.p12.1.m1.1.1.1.1.cmml" xref="S3.SS5.p12.1.m1.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS5.p12.1.m1.1.1.1.1.1.cmml" xref="S3.SS5.p12.1.m1.1.1.1.1">subscript</csymbol><ci id="S3.SS5.p12.1.m1.1.1.1.1.2.cmml" xref="S3.SS5.p12.1.m1.1.1.1.1.2">𝑊</ci><ci id="S3.SS5.p12.1.m1.1.1.1.1.3.cmml" xref="S3.SS5.p12.1.m1.1.1.1.1.3">𝑄</ci></apply><apply id="S3.SS5.p12.1.m1.2.2.2.2.cmml" xref="S3.SS5.p12.1.m1.2.2.2.2"><csymbol cd="ambiguous" id="S3.SS5.p12.1.m1.2.2.2.2.1.cmml" xref="S3.SS5.p12.1.m1.2.2.2.2">subscript</csymbol><ci id="S3.SS5.p12.1.m1.2.2.2.2.2.cmml" xref="S3.SS5.p12.1.m1.2.2.2.2.2">𝑊</ci><ci id="S3.SS5.p12.1.m1.2.2.2.2.3.cmml" xref="S3.SS5.p12.1.m1.2.2.2.2.3">𝐾</ci></apply><apply id="S3.SS5.p12.1.m1.3.3.3.3.cmml" xref="S3.SS5.p12.1.m1.3.3.3.3"><csymbol cd="ambiguous" id="S3.SS5.p12.1.m1.3.3.3.3.1.cmml" xref="S3.SS5.p12.1.m1.3.3.3.3">subscript</csymbol><ci id="S3.SS5.p12.1.m1.3.3.3.3.2.cmml" xref="S3.SS5.p12.1.m1.3.3.3.3.2">𝑊</ci><ci id="S3.SS5.p12.1.m1.3.3.3.3.3.cmml" xref="S3.SS5.p12.1.m1.3.3.3.3.3">𝑉</ci></apply></list></annotation-xml><annotation encoding="application/x-tex" id="S3.SS5.p12.1.m1.3c">W_{Q},W_{K},W_{V}</annotation><annotation encoding="application/x-llamapun" id="S3.SS5.p12.1.m1.3d">italic_W start_POSTSUBSCRIPT italic_Q end_POSTSUBSCRIPT , italic_W start_POSTSUBSCRIPT italic_K end_POSTSUBSCRIPT , italic_W start_POSTSUBSCRIPT italic_V end_POSTSUBSCRIPT</annotation></semantics></math> are trainable weight matrix. After we get <math alttext="Q,K,V" class="ltx_Math" display="inline" id="S3.SS5.p12.2.m2.3"><semantics id="S3.SS5.p12.2.m2.3a"><mrow id="S3.SS5.p12.2.m2.3.4.2" xref="S3.SS5.p12.2.m2.3.4.1.cmml"><mi id="S3.SS5.p12.2.m2.1.1" xref="S3.SS5.p12.2.m2.1.1.cmml">Q</mi><mo id="S3.SS5.p12.2.m2.3.4.2.1" xref="S3.SS5.p12.2.m2.3.4.1.cmml">,</mo><mi id="S3.SS5.p12.2.m2.2.2" xref="S3.SS5.p12.2.m2.2.2.cmml">K</mi><mo id="S3.SS5.p12.2.m2.3.4.2.2" xref="S3.SS5.p12.2.m2.3.4.1.cmml">,</mo><mi id="S3.SS5.p12.2.m2.3.3" xref="S3.SS5.p12.2.m2.3.3.cmml">V</mi></mrow><annotation-xml encoding="MathML-Content" id="S3.SS5.p12.2.m2.3b"><list id="S3.SS5.p12.2.m2.3.4.1.cmml" xref="S3.SS5.p12.2.m2.3.4.2"><ci id="S3.SS5.p12.2.m2.1.1.cmml" xref="S3.SS5.p12.2.m2.1.1">𝑄</ci><ci id="S3.SS5.p12.2.m2.2.2.cmml" xref="S3.SS5.p12.2.m2.2.2">𝐾</ci><ci id="S3.SS5.p12.2.m2.3.3.cmml" xref="S3.SS5.p12.2.m2.3.3">𝑉</ci></list></annotation-xml><annotation encoding="application/x-tex" id="S3.SS5.p12.2.m2.3c">Q,K,V</annotation><annotation encoding="application/x-llamapun" id="S3.SS5.p12.2.m2.3d">italic_Q , italic_K , italic_V</annotation></semantics></math> we can conduct self attention calculation as:</p>
</div>
<div class="ltx_para" id="S3.SS5.p13">
<table class="ltx_equation ltx_eqn_table" id="S3.E10">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_left_padleft"></td>
<td class="ltx_eqn_cell ltx_align_left"><math alttext="\text{Attention}(Q,K,V)=\text{SoftMax}\left(\frac{Q\cdot K^{T}}{\sqrt{d_{k}}}%
\right)\cdot V," class="ltx_Math" display="block" id="S3.E10.m1.5"><semantics id="S3.E10.m1.5a"><mrow id="S3.E10.m1.5.5.1" xref="S3.E10.m1.5.5.1.1.cmml"><mrow id="S3.E10.m1.5.5.1.1" xref="S3.E10.m1.5.5.1.1.cmml"><mrow id="S3.E10.m1.5.5.1.1.2" xref="S3.E10.m1.5.5.1.1.2.cmml"><mtext id="S3.E10.m1.5.5.1.1.2.2" xref="S3.E10.m1.5.5.1.1.2.2a.cmml">Attention</mtext><mo id="S3.E10.m1.5.5.1.1.2.1" xref="S3.E10.m1.5.5.1.1.2.1.cmml">⁢</mo><mrow id="S3.E10.m1.5.5.1.1.2.3.2" xref="S3.E10.m1.5.5.1.1.2.3.1.cmml"><mo id="S3.E10.m1.5.5.1.1.2.3.2.1" stretchy="false" xref="S3.E10.m1.5.5.1.1.2.3.1.cmml">(</mo><mi id="S3.E10.m1.1.1" xref="S3.E10.m1.1.1.cmml">Q</mi><mo id="S3.E10.m1.5.5.1.1.2.3.2.2" xref="S3.E10.m1.5.5.1.1.2.3.1.cmml">,</mo><mi id="S3.E10.m1.2.2" xref="S3.E10.m1.2.2.cmml">K</mi><mo id="S3.E10.m1.5.5.1.1.2.3.2.3" xref="S3.E10.m1.5.5.1.1.2.3.1.cmml">,</mo><mi id="S3.E10.m1.3.3" xref="S3.E10.m1.3.3.cmml">V</mi><mo id="S3.E10.m1.5.5.1.1.2.3.2.4" stretchy="false" xref="S3.E10.m1.5.5.1.1.2.3.1.cmml">)</mo></mrow></mrow><mo id="S3.E10.m1.5.5.1.1.1" xref="S3.E10.m1.5.5.1.1.1.cmml">=</mo><mrow id="S3.E10.m1.5.5.1.1.3" xref="S3.E10.m1.5.5.1.1.3.cmml"><mrow id="S3.E10.m1.5.5.1.1.3.2" xref="S3.E10.m1.5.5.1.1.3.2.cmml"><mtext id="S3.E10.m1.5.5.1.1.3.2.2" xref="S3.E10.m1.5.5.1.1.3.2.2a.cmml">SoftMax</mtext><mo id="S3.E10.m1.5.5.1.1.3.2.1" xref="S3.E10.m1.5.5.1.1.3.2.1.cmml">⁢</mo><mrow id="S3.E10.m1.5.5.1.1.3.2.3.2" xref="S3.E10.m1.4.4.cmml"><mo id="S3.E10.m1.5.5.1.1.3.2.3.2.1" xref="S3.E10.m1.4.4.cmml">(</mo><mfrac id="S3.E10.m1.4.4" xref="S3.E10.m1.4.4.cmml"><mrow id="S3.E10.m1.4.4.2" xref="S3.E10.m1.4.4.2.cmml"><mi id="S3.E10.m1.4.4.2.2" xref="S3.E10.m1.4.4.2.2.cmml">Q</mi><mo id="S3.E10.m1.4.4.2.1" lspace="0.222em" rspace="0.222em" xref="S3.E10.m1.4.4.2.1.cmml">⋅</mo><msup id="S3.E10.m1.4.4.2.3" xref="S3.E10.m1.4.4.2.3.cmml"><mi id="S3.E10.m1.4.4.2.3.2" xref="S3.E10.m1.4.4.2.3.2.cmml">K</mi><mi id="S3.E10.m1.4.4.2.3.3" xref="S3.E10.m1.4.4.2.3.3.cmml">T</mi></msup></mrow><msqrt id="S3.E10.m1.4.4.3" xref="S3.E10.m1.4.4.3.cmml"><msub id="S3.E10.m1.4.4.3.2" xref="S3.E10.m1.4.4.3.2.cmml"><mi id="S3.E10.m1.4.4.3.2.2" xref="S3.E10.m1.4.4.3.2.2.cmml">d</mi><mi id="S3.E10.m1.4.4.3.2.3" xref="S3.E10.m1.4.4.3.2.3.cmml">k</mi></msub></msqrt></mfrac><mo id="S3.E10.m1.5.5.1.1.3.2.3.2.2" rspace="0.055em" xref="S3.E10.m1.4.4.cmml">)</mo></mrow></mrow><mo id="S3.E10.m1.5.5.1.1.3.1" rspace="0.222em" xref="S3.E10.m1.5.5.1.1.3.1.cmml">⋅</mo><mi id="S3.E10.m1.5.5.1.1.3.3" xref="S3.E10.m1.5.5.1.1.3.3.cmml">V</mi></mrow></mrow><mo id="S3.E10.m1.5.5.1.2" xref="S3.E10.m1.5.5.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E10.m1.5b"><apply id="S3.E10.m1.5.5.1.1.cmml" xref="S3.E10.m1.5.5.1"><eq id="S3.E10.m1.5.5.1.1.1.cmml" xref="S3.E10.m1.5.5.1.1.1"></eq><apply id="S3.E10.m1.5.5.1.1.2.cmml" xref="S3.E10.m1.5.5.1.1.2"><times id="S3.E10.m1.5.5.1.1.2.1.cmml" xref="S3.E10.m1.5.5.1.1.2.1"></times><ci id="S3.E10.m1.5.5.1.1.2.2a.cmml" xref="S3.E10.m1.5.5.1.1.2.2"><mtext id="S3.E10.m1.5.5.1.1.2.2.cmml" xref="S3.E10.m1.5.5.1.1.2.2">Attention</mtext></ci><vector id="S3.E10.m1.5.5.1.1.2.3.1.cmml" xref="S3.E10.m1.5.5.1.1.2.3.2"><ci id="S3.E10.m1.1.1.cmml" xref="S3.E10.m1.1.1">𝑄</ci><ci id="S3.E10.m1.2.2.cmml" xref="S3.E10.m1.2.2">𝐾</ci><ci id="S3.E10.m1.3.3.cmml" xref="S3.E10.m1.3.3">𝑉</ci></vector></apply><apply id="S3.E10.m1.5.5.1.1.3.cmml" xref="S3.E10.m1.5.5.1.1.3"><ci id="S3.E10.m1.5.5.1.1.3.1.cmml" xref="S3.E10.m1.5.5.1.1.3.1">⋅</ci><apply id="S3.E10.m1.5.5.1.1.3.2.cmml" xref="S3.E10.m1.5.5.1.1.3.2"><times id="S3.E10.m1.5.5.1.1.3.2.1.cmml" xref="S3.E10.m1.5.5.1.1.3.2.1"></times><ci id="S3.E10.m1.5.5.1.1.3.2.2a.cmml" xref="S3.E10.m1.5.5.1.1.3.2.2"><mtext id="S3.E10.m1.5.5.1.1.3.2.2.cmml" xref="S3.E10.m1.5.5.1.1.3.2.2">SoftMax</mtext></ci><apply id="S3.E10.m1.4.4.cmml" xref="S3.E10.m1.5.5.1.1.3.2.3.2"><divide id="S3.E10.m1.4.4.1.cmml" xref="S3.E10.m1.5.5.1.1.3.2.3.2"></divide><apply id="S3.E10.m1.4.4.2.cmml" xref="S3.E10.m1.4.4.2"><ci id="S3.E10.m1.4.4.2.1.cmml" xref="S3.E10.m1.4.4.2.1">⋅</ci><ci id="S3.E10.m1.4.4.2.2.cmml" xref="S3.E10.m1.4.4.2.2">𝑄</ci><apply id="S3.E10.m1.4.4.2.3.cmml" xref="S3.E10.m1.4.4.2.3"><csymbol cd="ambiguous" id="S3.E10.m1.4.4.2.3.1.cmml" xref="S3.E10.m1.4.4.2.3">superscript</csymbol><ci id="S3.E10.m1.4.4.2.3.2.cmml" xref="S3.E10.m1.4.4.2.3.2">𝐾</ci><ci id="S3.E10.m1.4.4.2.3.3.cmml" xref="S3.E10.m1.4.4.2.3.3">𝑇</ci></apply></apply><apply id="S3.E10.m1.4.4.3.cmml" xref="S3.E10.m1.4.4.3"><root id="S3.E10.m1.4.4.3a.cmml" xref="S3.E10.m1.4.4.3"></root><apply id="S3.E10.m1.4.4.3.2.cmml" xref="S3.E10.m1.4.4.3.2"><csymbol cd="ambiguous" id="S3.E10.m1.4.4.3.2.1.cmml" xref="S3.E10.m1.4.4.3.2">subscript</csymbol><ci id="S3.E10.m1.4.4.3.2.2.cmml" xref="S3.E10.m1.4.4.3.2.2">𝑑</ci><ci id="S3.E10.m1.4.4.3.2.3.cmml" xref="S3.E10.m1.4.4.3.2.3">𝑘</ci></apply></apply></apply></apply><ci id="S3.E10.m1.5.5.1.1.3.3.cmml" xref="S3.E10.m1.5.5.1.1.3.3">𝑉</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E10.m1.5c">\text{Attention}(Q,K,V)=\text{SoftMax}\left(\frac{Q\cdot K^{T}}{\sqrt{d_{k}}}%
\right)\cdot V,</annotation><annotation encoding="application/x-llamapun" id="S3.E10.m1.5d">Attention ( italic_Q , italic_K , italic_V ) = SoftMax ( divide start_ARG italic_Q ⋅ italic_K start_POSTSUPERSCRIPT italic_T end_POSTSUPERSCRIPT end_ARG start_ARG square-root start_ARG italic_d start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT end_ARG end_ARG ) ⋅ italic_V ,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_left_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(10)</span></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S3.SS5.p13.1">where <math alttext="d_{k}" class="ltx_Math" display="inline" id="S3.SS5.p13.1.m1.1"><semantics id="S3.SS5.p13.1.m1.1a"><msub id="S3.SS5.p13.1.m1.1.1" xref="S3.SS5.p13.1.m1.1.1.cmml"><mi id="S3.SS5.p13.1.m1.1.1.2" xref="S3.SS5.p13.1.m1.1.1.2.cmml">d</mi><mi id="S3.SS5.p13.1.m1.1.1.3" xref="S3.SS5.p13.1.m1.1.1.3.cmml">k</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS5.p13.1.m1.1b"><apply id="S3.SS5.p13.1.m1.1.1.cmml" xref="S3.SS5.p13.1.m1.1.1"><csymbol cd="ambiguous" id="S3.SS5.p13.1.m1.1.1.1.cmml" xref="S3.SS5.p13.1.m1.1.1">subscript</csymbol><ci id="S3.SS5.p13.1.m1.1.1.2.cmml" xref="S3.SS5.p13.1.m1.1.1.2">𝑑</ci><ci id="S3.SS5.p13.1.m1.1.1.3.cmml" xref="S3.SS5.p13.1.m1.1.1.3">𝑘</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS5.p13.1.m1.1c">d_{k}</annotation><annotation encoding="application/x-llamapun" id="S3.SS5.p13.1.m1.1d">italic_d start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT</annotation></semantics></math> is dimension of key. With this calculation, the model is able to assign a weight to each feature vector, thus capturing the relationship between the features.</p>
</div>
<div class="ltx_para" id="S3.SS5.p14">
<p class="ltx_p" id="S3.SS5.p14.1">The multi-head self-attention mechanism further parallelizes the above processes and enhances the expressive power of the model. The process reads as:</p>
</div>
<div class="ltx_para" id="S3.SS5.p15">
<table class="ltx_equation ltx_eqn_table" id="S3.E11">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_left_padleft"></td>
<td class="ltx_eqn_cell ltx_align_left"><math alttext="\text{MultiHead}\left(Q,K,V\right)=\text{Concat}(head_{1},...,head_{h})\cdot W%
_{o}," class="ltx_Math" display="block" id="S3.E11.m1.5"><semantics id="S3.E11.m1.5a"><mrow id="S3.E11.m1.5.5.1" xref="S3.E11.m1.5.5.1.1.cmml"><mrow id="S3.E11.m1.5.5.1.1" xref="S3.E11.m1.5.5.1.1.cmml"><mrow id="S3.E11.m1.5.5.1.1.4" xref="S3.E11.m1.5.5.1.1.4.cmml"><mtext id="S3.E11.m1.5.5.1.1.4.2" xref="S3.E11.m1.5.5.1.1.4.2a.cmml">MultiHead</mtext><mo id="S3.E11.m1.5.5.1.1.4.1" xref="S3.E11.m1.5.5.1.1.4.1.cmml">⁢</mo><mrow id="S3.E11.m1.5.5.1.1.4.3.2" xref="S3.E11.m1.5.5.1.1.4.3.1.cmml"><mo id="S3.E11.m1.5.5.1.1.4.3.2.1" xref="S3.E11.m1.5.5.1.1.4.3.1.cmml">(</mo><mi id="S3.E11.m1.1.1" xref="S3.E11.m1.1.1.cmml">Q</mi><mo id="S3.E11.m1.5.5.1.1.4.3.2.2" xref="S3.E11.m1.5.5.1.1.4.3.1.cmml">,</mo><mi id="S3.E11.m1.2.2" xref="S3.E11.m1.2.2.cmml">K</mi><mo id="S3.E11.m1.5.5.1.1.4.3.2.3" xref="S3.E11.m1.5.5.1.1.4.3.1.cmml">,</mo><mi id="S3.E11.m1.3.3" xref="S3.E11.m1.3.3.cmml">V</mi><mo id="S3.E11.m1.5.5.1.1.4.3.2.4" xref="S3.E11.m1.5.5.1.1.4.3.1.cmml">)</mo></mrow></mrow><mo id="S3.E11.m1.5.5.1.1.3" xref="S3.E11.m1.5.5.1.1.3.cmml">=</mo><mrow id="S3.E11.m1.5.5.1.1.2" xref="S3.E11.m1.5.5.1.1.2.cmml"><mrow id="S3.E11.m1.5.5.1.1.2.2" xref="S3.E11.m1.5.5.1.1.2.2.cmml"><mtext id="S3.E11.m1.5.5.1.1.2.2.4" xref="S3.E11.m1.5.5.1.1.2.2.4a.cmml">Concat</mtext><mo id="S3.E11.m1.5.5.1.1.2.2.3" xref="S3.E11.m1.5.5.1.1.2.2.3.cmml">⁢</mo><mrow id="S3.E11.m1.5.5.1.1.2.2.2.2" xref="S3.E11.m1.5.5.1.1.2.2.2.3.cmml"><mo id="S3.E11.m1.5.5.1.1.2.2.2.2.3" stretchy="false" xref="S3.E11.m1.5.5.1.1.2.2.2.3.cmml">(</mo><mrow id="S3.E11.m1.5.5.1.1.1.1.1.1.1" xref="S3.E11.m1.5.5.1.1.1.1.1.1.1.cmml"><mi id="S3.E11.m1.5.5.1.1.1.1.1.1.1.2" xref="S3.E11.m1.5.5.1.1.1.1.1.1.1.2.cmml">h</mi><mo id="S3.E11.m1.5.5.1.1.1.1.1.1.1.1" xref="S3.E11.m1.5.5.1.1.1.1.1.1.1.1.cmml">⁢</mo><mi id="S3.E11.m1.5.5.1.1.1.1.1.1.1.3" xref="S3.E11.m1.5.5.1.1.1.1.1.1.1.3.cmml">e</mi><mo id="S3.E11.m1.5.5.1.1.1.1.1.1.1.1a" xref="S3.E11.m1.5.5.1.1.1.1.1.1.1.1.cmml">⁢</mo><mi id="S3.E11.m1.5.5.1.1.1.1.1.1.1.4" xref="S3.E11.m1.5.5.1.1.1.1.1.1.1.4.cmml">a</mi><mo id="S3.E11.m1.5.5.1.1.1.1.1.1.1.1b" xref="S3.E11.m1.5.5.1.1.1.1.1.1.1.1.cmml">⁢</mo><msub id="S3.E11.m1.5.5.1.1.1.1.1.1.1.5" xref="S3.E11.m1.5.5.1.1.1.1.1.1.1.5.cmml"><mi id="S3.E11.m1.5.5.1.1.1.1.1.1.1.5.2" xref="S3.E11.m1.5.5.1.1.1.1.1.1.1.5.2.cmml">d</mi><mn id="S3.E11.m1.5.5.1.1.1.1.1.1.1.5.3" xref="S3.E11.m1.5.5.1.1.1.1.1.1.1.5.3.cmml">1</mn></msub></mrow><mo id="S3.E11.m1.5.5.1.1.2.2.2.2.4" xref="S3.E11.m1.5.5.1.1.2.2.2.3.cmml">,</mo><mi id="S3.E11.m1.4.4" mathvariant="normal" xref="S3.E11.m1.4.4.cmml">…</mi><mo id="S3.E11.m1.5.5.1.1.2.2.2.2.5" xref="S3.E11.m1.5.5.1.1.2.2.2.3.cmml">,</mo><mrow id="S3.E11.m1.5.5.1.1.2.2.2.2.2" xref="S3.E11.m1.5.5.1.1.2.2.2.2.2.cmml"><mi id="S3.E11.m1.5.5.1.1.2.2.2.2.2.2" xref="S3.E11.m1.5.5.1.1.2.2.2.2.2.2.cmml">h</mi><mo id="S3.E11.m1.5.5.1.1.2.2.2.2.2.1" xref="S3.E11.m1.5.5.1.1.2.2.2.2.2.1.cmml">⁢</mo><mi id="S3.E11.m1.5.5.1.1.2.2.2.2.2.3" xref="S3.E11.m1.5.5.1.1.2.2.2.2.2.3.cmml">e</mi><mo id="S3.E11.m1.5.5.1.1.2.2.2.2.2.1a" xref="S3.E11.m1.5.5.1.1.2.2.2.2.2.1.cmml">⁢</mo><mi id="S3.E11.m1.5.5.1.1.2.2.2.2.2.4" xref="S3.E11.m1.5.5.1.1.2.2.2.2.2.4.cmml">a</mi><mo id="S3.E11.m1.5.5.1.1.2.2.2.2.2.1b" xref="S3.E11.m1.5.5.1.1.2.2.2.2.2.1.cmml">⁢</mo><msub id="S3.E11.m1.5.5.1.1.2.2.2.2.2.5" xref="S3.E11.m1.5.5.1.1.2.2.2.2.2.5.cmml"><mi id="S3.E11.m1.5.5.1.1.2.2.2.2.2.5.2" xref="S3.E11.m1.5.5.1.1.2.2.2.2.2.5.2.cmml">d</mi><mi id="S3.E11.m1.5.5.1.1.2.2.2.2.2.5.3" xref="S3.E11.m1.5.5.1.1.2.2.2.2.2.5.3.cmml">h</mi></msub></mrow><mo id="S3.E11.m1.5.5.1.1.2.2.2.2.6" rspace="0.055em" stretchy="false" xref="S3.E11.m1.5.5.1.1.2.2.2.3.cmml">)</mo></mrow></mrow><mo id="S3.E11.m1.5.5.1.1.2.3" rspace="0.222em" xref="S3.E11.m1.5.5.1.1.2.3.cmml">⋅</mo><msub id="S3.E11.m1.5.5.1.1.2.4" xref="S3.E11.m1.5.5.1.1.2.4.cmml"><mi id="S3.E11.m1.5.5.1.1.2.4.2" xref="S3.E11.m1.5.5.1.1.2.4.2.cmml">W</mi><mi id="S3.E11.m1.5.5.1.1.2.4.3" xref="S3.E11.m1.5.5.1.1.2.4.3.cmml">o</mi></msub></mrow></mrow><mo id="S3.E11.m1.5.5.1.2" xref="S3.E11.m1.5.5.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E11.m1.5b"><apply id="S3.E11.m1.5.5.1.1.cmml" xref="S3.E11.m1.5.5.1"><eq id="S3.E11.m1.5.5.1.1.3.cmml" xref="S3.E11.m1.5.5.1.1.3"></eq><apply id="S3.E11.m1.5.5.1.1.4.cmml" xref="S3.E11.m1.5.5.1.1.4"><times id="S3.E11.m1.5.5.1.1.4.1.cmml" xref="S3.E11.m1.5.5.1.1.4.1"></times><ci id="S3.E11.m1.5.5.1.1.4.2a.cmml" xref="S3.E11.m1.5.5.1.1.4.2"><mtext id="S3.E11.m1.5.5.1.1.4.2.cmml" xref="S3.E11.m1.5.5.1.1.4.2">MultiHead</mtext></ci><vector id="S3.E11.m1.5.5.1.1.4.3.1.cmml" xref="S3.E11.m1.5.5.1.1.4.3.2"><ci id="S3.E11.m1.1.1.cmml" xref="S3.E11.m1.1.1">𝑄</ci><ci id="S3.E11.m1.2.2.cmml" xref="S3.E11.m1.2.2">𝐾</ci><ci id="S3.E11.m1.3.3.cmml" xref="S3.E11.m1.3.3">𝑉</ci></vector></apply><apply id="S3.E11.m1.5.5.1.1.2.cmml" xref="S3.E11.m1.5.5.1.1.2"><ci id="S3.E11.m1.5.5.1.1.2.3.cmml" xref="S3.E11.m1.5.5.1.1.2.3">⋅</ci><apply id="S3.E11.m1.5.5.1.1.2.2.cmml" xref="S3.E11.m1.5.5.1.1.2.2"><times id="S3.E11.m1.5.5.1.1.2.2.3.cmml" xref="S3.E11.m1.5.5.1.1.2.2.3"></times><ci id="S3.E11.m1.5.5.1.1.2.2.4a.cmml" xref="S3.E11.m1.5.5.1.1.2.2.4"><mtext id="S3.E11.m1.5.5.1.1.2.2.4.cmml" xref="S3.E11.m1.5.5.1.1.2.2.4">Concat</mtext></ci><vector id="S3.E11.m1.5.5.1.1.2.2.2.3.cmml" xref="S3.E11.m1.5.5.1.1.2.2.2.2"><apply id="S3.E11.m1.5.5.1.1.1.1.1.1.1.cmml" xref="S3.E11.m1.5.5.1.1.1.1.1.1.1"><times id="S3.E11.m1.5.5.1.1.1.1.1.1.1.1.cmml" xref="S3.E11.m1.5.5.1.1.1.1.1.1.1.1"></times><ci id="S3.E11.m1.5.5.1.1.1.1.1.1.1.2.cmml" xref="S3.E11.m1.5.5.1.1.1.1.1.1.1.2">ℎ</ci><ci id="S3.E11.m1.5.5.1.1.1.1.1.1.1.3.cmml" xref="S3.E11.m1.5.5.1.1.1.1.1.1.1.3">𝑒</ci><ci id="S3.E11.m1.5.5.1.1.1.1.1.1.1.4.cmml" xref="S3.E11.m1.5.5.1.1.1.1.1.1.1.4">𝑎</ci><apply id="S3.E11.m1.5.5.1.1.1.1.1.1.1.5.cmml" xref="S3.E11.m1.5.5.1.1.1.1.1.1.1.5"><csymbol cd="ambiguous" id="S3.E11.m1.5.5.1.1.1.1.1.1.1.5.1.cmml" xref="S3.E11.m1.5.5.1.1.1.1.1.1.1.5">subscript</csymbol><ci id="S3.E11.m1.5.5.1.1.1.1.1.1.1.5.2.cmml" xref="S3.E11.m1.5.5.1.1.1.1.1.1.1.5.2">𝑑</ci><cn id="S3.E11.m1.5.5.1.1.1.1.1.1.1.5.3.cmml" type="integer" xref="S3.E11.m1.5.5.1.1.1.1.1.1.1.5.3">1</cn></apply></apply><ci id="S3.E11.m1.4.4.cmml" xref="S3.E11.m1.4.4">…</ci><apply id="S3.E11.m1.5.5.1.1.2.2.2.2.2.cmml" xref="S3.E11.m1.5.5.1.1.2.2.2.2.2"><times id="S3.E11.m1.5.5.1.1.2.2.2.2.2.1.cmml" xref="S3.E11.m1.5.5.1.1.2.2.2.2.2.1"></times><ci id="S3.E11.m1.5.5.1.1.2.2.2.2.2.2.cmml" xref="S3.E11.m1.5.5.1.1.2.2.2.2.2.2">ℎ</ci><ci id="S3.E11.m1.5.5.1.1.2.2.2.2.2.3.cmml" xref="S3.E11.m1.5.5.1.1.2.2.2.2.2.3">𝑒</ci><ci id="S3.E11.m1.5.5.1.1.2.2.2.2.2.4.cmml" xref="S3.E11.m1.5.5.1.1.2.2.2.2.2.4">𝑎</ci><apply id="S3.E11.m1.5.5.1.1.2.2.2.2.2.5.cmml" xref="S3.E11.m1.5.5.1.1.2.2.2.2.2.5"><csymbol cd="ambiguous" id="S3.E11.m1.5.5.1.1.2.2.2.2.2.5.1.cmml" xref="S3.E11.m1.5.5.1.1.2.2.2.2.2.5">subscript</csymbol><ci id="S3.E11.m1.5.5.1.1.2.2.2.2.2.5.2.cmml" xref="S3.E11.m1.5.5.1.1.2.2.2.2.2.5.2">𝑑</ci><ci id="S3.E11.m1.5.5.1.1.2.2.2.2.2.5.3.cmml" xref="S3.E11.m1.5.5.1.1.2.2.2.2.2.5.3">ℎ</ci></apply></apply></vector></apply><apply id="S3.E11.m1.5.5.1.1.2.4.cmml" xref="S3.E11.m1.5.5.1.1.2.4"><csymbol cd="ambiguous" id="S3.E11.m1.5.5.1.1.2.4.1.cmml" xref="S3.E11.m1.5.5.1.1.2.4">subscript</csymbol><ci id="S3.E11.m1.5.5.1.1.2.4.2.cmml" xref="S3.E11.m1.5.5.1.1.2.4.2">𝑊</ci><ci id="S3.E11.m1.5.5.1.1.2.4.3.cmml" xref="S3.E11.m1.5.5.1.1.2.4.3">𝑜</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E11.m1.5c">\text{MultiHead}\left(Q,K,V\right)=\text{Concat}(head_{1},...,head_{h})\cdot W%
_{o},</annotation><annotation encoding="application/x-llamapun" id="S3.E11.m1.5d">MultiHead ( italic_Q , italic_K , italic_V ) = Concat ( italic_h italic_e italic_a italic_d start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT , … , italic_h italic_e italic_a italic_d start_POSTSUBSCRIPT italic_h end_POSTSUBSCRIPT ) ⋅ italic_W start_POSTSUBSCRIPT italic_o end_POSTSUBSCRIPT ,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_left_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(11)</span></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S3.SS5.p15.3">where, <math alttext="head_{i}=Attention(Q,K,V)" class="ltx_Math" display="inline" id="S3.SS5.p15.1.m1.3"><semantics id="S3.SS5.p15.1.m1.3a"><mrow id="S3.SS5.p15.1.m1.3.4" xref="S3.SS5.p15.1.m1.3.4.cmml"><mrow id="S3.SS5.p15.1.m1.3.4.2" xref="S3.SS5.p15.1.m1.3.4.2.cmml"><mi id="S3.SS5.p15.1.m1.3.4.2.2" xref="S3.SS5.p15.1.m1.3.4.2.2.cmml">h</mi><mo id="S3.SS5.p15.1.m1.3.4.2.1" xref="S3.SS5.p15.1.m1.3.4.2.1.cmml">⁢</mo><mi id="S3.SS5.p15.1.m1.3.4.2.3" xref="S3.SS5.p15.1.m1.3.4.2.3.cmml">e</mi><mo id="S3.SS5.p15.1.m1.3.4.2.1a" xref="S3.SS5.p15.1.m1.3.4.2.1.cmml">⁢</mo><mi id="S3.SS5.p15.1.m1.3.4.2.4" xref="S3.SS5.p15.1.m1.3.4.2.4.cmml">a</mi><mo id="S3.SS5.p15.1.m1.3.4.2.1b" xref="S3.SS5.p15.1.m1.3.4.2.1.cmml">⁢</mo><msub id="S3.SS5.p15.1.m1.3.4.2.5" xref="S3.SS5.p15.1.m1.3.4.2.5.cmml"><mi id="S3.SS5.p15.1.m1.3.4.2.5.2" xref="S3.SS5.p15.1.m1.3.4.2.5.2.cmml">d</mi><mi id="S3.SS5.p15.1.m1.3.4.2.5.3" xref="S3.SS5.p15.1.m1.3.4.2.5.3.cmml">i</mi></msub></mrow><mo id="S3.SS5.p15.1.m1.3.4.1" xref="S3.SS5.p15.1.m1.3.4.1.cmml">=</mo><mrow id="S3.SS5.p15.1.m1.3.4.3" xref="S3.SS5.p15.1.m1.3.4.3.cmml"><mi id="S3.SS5.p15.1.m1.3.4.3.2" xref="S3.SS5.p15.1.m1.3.4.3.2.cmml">A</mi><mo id="S3.SS5.p15.1.m1.3.4.3.1" xref="S3.SS5.p15.1.m1.3.4.3.1.cmml">⁢</mo><mi id="S3.SS5.p15.1.m1.3.4.3.3" xref="S3.SS5.p15.1.m1.3.4.3.3.cmml">t</mi><mo id="S3.SS5.p15.1.m1.3.4.3.1a" xref="S3.SS5.p15.1.m1.3.4.3.1.cmml">⁢</mo><mi id="S3.SS5.p15.1.m1.3.4.3.4" xref="S3.SS5.p15.1.m1.3.4.3.4.cmml">t</mi><mo id="S3.SS5.p15.1.m1.3.4.3.1b" xref="S3.SS5.p15.1.m1.3.4.3.1.cmml">⁢</mo><mi id="S3.SS5.p15.1.m1.3.4.3.5" xref="S3.SS5.p15.1.m1.3.4.3.5.cmml">e</mi><mo id="S3.SS5.p15.1.m1.3.4.3.1c" xref="S3.SS5.p15.1.m1.3.4.3.1.cmml">⁢</mo><mi id="S3.SS5.p15.1.m1.3.4.3.6" xref="S3.SS5.p15.1.m1.3.4.3.6.cmml">n</mi><mo id="S3.SS5.p15.1.m1.3.4.3.1d" xref="S3.SS5.p15.1.m1.3.4.3.1.cmml">⁢</mo><mi id="S3.SS5.p15.1.m1.3.4.3.7" xref="S3.SS5.p15.1.m1.3.4.3.7.cmml">t</mi><mo id="S3.SS5.p15.1.m1.3.4.3.1e" xref="S3.SS5.p15.1.m1.3.4.3.1.cmml">⁢</mo><mi id="S3.SS5.p15.1.m1.3.4.3.8" xref="S3.SS5.p15.1.m1.3.4.3.8.cmml">i</mi><mo id="S3.SS5.p15.1.m1.3.4.3.1f" xref="S3.SS5.p15.1.m1.3.4.3.1.cmml">⁢</mo><mi id="S3.SS5.p15.1.m1.3.4.3.9" xref="S3.SS5.p15.1.m1.3.4.3.9.cmml">o</mi><mo id="S3.SS5.p15.1.m1.3.4.3.1g" xref="S3.SS5.p15.1.m1.3.4.3.1.cmml">⁢</mo><mi id="S3.SS5.p15.1.m1.3.4.3.10" xref="S3.SS5.p15.1.m1.3.4.3.10.cmml">n</mi><mo id="S3.SS5.p15.1.m1.3.4.3.1h" xref="S3.SS5.p15.1.m1.3.4.3.1.cmml">⁢</mo><mrow id="S3.SS5.p15.1.m1.3.4.3.11.2" xref="S3.SS5.p15.1.m1.3.4.3.11.1.cmml"><mo id="S3.SS5.p15.1.m1.3.4.3.11.2.1" stretchy="false" xref="S3.SS5.p15.1.m1.3.4.3.11.1.cmml">(</mo><mi id="S3.SS5.p15.1.m1.1.1" xref="S3.SS5.p15.1.m1.1.1.cmml">Q</mi><mo id="S3.SS5.p15.1.m1.3.4.3.11.2.2" xref="S3.SS5.p15.1.m1.3.4.3.11.1.cmml">,</mo><mi id="S3.SS5.p15.1.m1.2.2" xref="S3.SS5.p15.1.m1.2.2.cmml">K</mi><mo id="S3.SS5.p15.1.m1.3.4.3.11.2.3" xref="S3.SS5.p15.1.m1.3.4.3.11.1.cmml">,</mo><mi id="S3.SS5.p15.1.m1.3.3" xref="S3.SS5.p15.1.m1.3.3.cmml">V</mi><mo id="S3.SS5.p15.1.m1.3.4.3.11.2.4" stretchy="false" xref="S3.SS5.p15.1.m1.3.4.3.11.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS5.p15.1.m1.3b"><apply id="S3.SS5.p15.1.m1.3.4.cmml" xref="S3.SS5.p15.1.m1.3.4"><eq id="S3.SS5.p15.1.m1.3.4.1.cmml" xref="S3.SS5.p15.1.m1.3.4.1"></eq><apply id="S3.SS5.p15.1.m1.3.4.2.cmml" xref="S3.SS5.p15.1.m1.3.4.2"><times id="S3.SS5.p15.1.m1.3.4.2.1.cmml" xref="S3.SS5.p15.1.m1.3.4.2.1"></times><ci id="S3.SS5.p15.1.m1.3.4.2.2.cmml" xref="S3.SS5.p15.1.m1.3.4.2.2">ℎ</ci><ci id="S3.SS5.p15.1.m1.3.4.2.3.cmml" xref="S3.SS5.p15.1.m1.3.4.2.3">𝑒</ci><ci id="S3.SS5.p15.1.m1.3.4.2.4.cmml" xref="S3.SS5.p15.1.m1.3.4.2.4">𝑎</ci><apply id="S3.SS5.p15.1.m1.3.4.2.5.cmml" xref="S3.SS5.p15.1.m1.3.4.2.5"><csymbol cd="ambiguous" id="S3.SS5.p15.1.m1.3.4.2.5.1.cmml" xref="S3.SS5.p15.1.m1.3.4.2.5">subscript</csymbol><ci id="S3.SS5.p15.1.m1.3.4.2.5.2.cmml" xref="S3.SS5.p15.1.m1.3.4.2.5.2">𝑑</ci><ci id="S3.SS5.p15.1.m1.3.4.2.5.3.cmml" xref="S3.SS5.p15.1.m1.3.4.2.5.3">𝑖</ci></apply></apply><apply id="S3.SS5.p15.1.m1.3.4.3.cmml" xref="S3.SS5.p15.1.m1.3.4.3"><times id="S3.SS5.p15.1.m1.3.4.3.1.cmml" xref="S3.SS5.p15.1.m1.3.4.3.1"></times><ci id="S3.SS5.p15.1.m1.3.4.3.2.cmml" xref="S3.SS5.p15.1.m1.3.4.3.2">𝐴</ci><ci id="S3.SS5.p15.1.m1.3.4.3.3.cmml" xref="S3.SS5.p15.1.m1.3.4.3.3">𝑡</ci><ci id="S3.SS5.p15.1.m1.3.4.3.4.cmml" xref="S3.SS5.p15.1.m1.3.4.3.4">𝑡</ci><ci id="S3.SS5.p15.1.m1.3.4.3.5.cmml" xref="S3.SS5.p15.1.m1.3.4.3.5">𝑒</ci><ci id="S3.SS5.p15.1.m1.3.4.3.6.cmml" xref="S3.SS5.p15.1.m1.3.4.3.6">𝑛</ci><ci id="S3.SS5.p15.1.m1.3.4.3.7.cmml" xref="S3.SS5.p15.1.m1.3.4.3.7">𝑡</ci><ci id="S3.SS5.p15.1.m1.3.4.3.8.cmml" xref="S3.SS5.p15.1.m1.3.4.3.8">𝑖</ci><ci id="S3.SS5.p15.1.m1.3.4.3.9.cmml" xref="S3.SS5.p15.1.m1.3.4.3.9">𝑜</ci><ci id="S3.SS5.p15.1.m1.3.4.3.10.cmml" xref="S3.SS5.p15.1.m1.3.4.3.10">𝑛</ci><vector id="S3.SS5.p15.1.m1.3.4.3.11.1.cmml" xref="S3.SS5.p15.1.m1.3.4.3.11.2"><ci id="S3.SS5.p15.1.m1.1.1.cmml" xref="S3.SS5.p15.1.m1.1.1">𝑄</ci><ci id="S3.SS5.p15.1.m1.2.2.cmml" xref="S3.SS5.p15.1.m1.2.2">𝐾</ci><ci id="S3.SS5.p15.1.m1.3.3.cmml" xref="S3.SS5.p15.1.m1.3.3">𝑉</ci></vector></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS5.p15.1.m1.3c">head_{i}=Attention(Q,K,V)</annotation><annotation encoding="application/x-llamapun" id="S3.SS5.p15.1.m1.3d">italic_h italic_e italic_a italic_d start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT = italic_A italic_t italic_t italic_e italic_n italic_t italic_i italic_o italic_n ( italic_Q , italic_K , italic_V )</annotation></semantics></math>, <math alttext="h" class="ltx_Math" display="inline" id="S3.SS5.p15.2.m2.1"><semantics id="S3.SS5.p15.2.m2.1a"><mi id="S3.SS5.p15.2.m2.1.1" xref="S3.SS5.p15.2.m2.1.1.cmml">h</mi><annotation-xml encoding="MathML-Content" id="S3.SS5.p15.2.m2.1b"><ci id="S3.SS5.p15.2.m2.1.1.cmml" xref="S3.SS5.p15.2.m2.1.1">ℎ</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS5.p15.2.m2.1c">h</annotation><annotation encoding="application/x-llamapun" id="S3.SS5.p15.2.m2.1d">italic_h</annotation></semantics></math> is number of heads and <math alttext="W_{o}" class="ltx_Math" display="inline" id="S3.SS5.p15.3.m3.1"><semantics id="S3.SS5.p15.3.m3.1a"><msub id="S3.SS5.p15.3.m3.1.1" xref="S3.SS5.p15.3.m3.1.1.cmml"><mi id="S3.SS5.p15.3.m3.1.1.2" xref="S3.SS5.p15.3.m3.1.1.2.cmml">W</mi><mi id="S3.SS5.p15.3.m3.1.1.3" xref="S3.SS5.p15.3.m3.1.1.3.cmml">o</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS5.p15.3.m3.1b"><apply id="S3.SS5.p15.3.m3.1.1.cmml" xref="S3.SS5.p15.3.m3.1.1"><csymbol cd="ambiguous" id="S3.SS5.p15.3.m3.1.1.1.cmml" xref="S3.SS5.p15.3.m3.1.1">subscript</csymbol><ci id="S3.SS5.p15.3.m3.1.1.2.cmml" xref="S3.SS5.p15.3.m3.1.1.2">𝑊</ci><ci id="S3.SS5.p15.3.m3.1.1.3.cmml" xref="S3.SS5.p15.3.m3.1.1.3">𝑜</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS5.p15.3.m3.1c">W_{o}</annotation><annotation encoding="application/x-llamapun" id="S3.SS5.p15.3.m3.1d">italic_W start_POSTSUBSCRIPT italic_o end_POSTSUBSCRIPT</annotation></semantics></math> is weight matrix of output layer.After several self-attention layers and feed forward neural network layers, we get the output matrix of Transformer encoder as</p>
</div>
<div class="ltx_para" id="S3.SS5.p16">
<table class="ltx_equation ltx_eqn_table" id="S3.E12">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_left_padleft"></td>
<td class="ltx_eqn_cell ltx_align_left"><math alttext="H=\text{Transformer Encoder}\left(V_{i}^{p}\right)," class="ltx_Math" display="block" id="S3.E12.m1.1"><semantics id="S3.E12.m1.1a"><mrow id="S3.E12.m1.1.1.1" xref="S3.E12.m1.1.1.1.1.cmml"><mrow id="S3.E12.m1.1.1.1.1" xref="S3.E12.m1.1.1.1.1.cmml"><mi id="S3.E12.m1.1.1.1.1.3" xref="S3.E12.m1.1.1.1.1.3.cmml">H</mi><mo id="S3.E12.m1.1.1.1.1.2" xref="S3.E12.m1.1.1.1.1.2.cmml">=</mo><mrow id="S3.E12.m1.1.1.1.1.1" xref="S3.E12.m1.1.1.1.1.1.cmml"><mtext id="S3.E12.m1.1.1.1.1.1.3" xref="S3.E12.m1.1.1.1.1.1.3a.cmml">Transformer Encoder</mtext><mo id="S3.E12.m1.1.1.1.1.1.2" xref="S3.E12.m1.1.1.1.1.1.2.cmml">⁢</mo><mrow id="S3.E12.m1.1.1.1.1.1.1.1" xref="S3.E12.m1.1.1.1.1.1.1.1.1.cmml"><mo id="S3.E12.m1.1.1.1.1.1.1.1.2" xref="S3.E12.m1.1.1.1.1.1.1.1.1.cmml">(</mo><msubsup id="S3.E12.m1.1.1.1.1.1.1.1.1" xref="S3.E12.m1.1.1.1.1.1.1.1.1.cmml"><mi id="S3.E12.m1.1.1.1.1.1.1.1.1.2.2" xref="S3.E12.m1.1.1.1.1.1.1.1.1.2.2.cmml">V</mi><mi id="S3.E12.m1.1.1.1.1.1.1.1.1.2.3" xref="S3.E12.m1.1.1.1.1.1.1.1.1.2.3.cmml">i</mi><mi id="S3.E12.m1.1.1.1.1.1.1.1.1.3" xref="S3.E12.m1.1.1.1.1.1.1.1.1.3.cmml">p</mi></msubsup><mo id="S3.E12.m1.1.1.1.1.1.1.1.3" xref="S3.E12.m1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><mo id="S3.E12.m1.1.1.1.2" xref="S3.E12.m1.1.1.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E12.m1.1b"><apply id="S3.E12.m1.1.1.1.1.cmml" xref="S3.E12.m1.1.1.1"><eq id="S3.E12.m1.1.1.1.1.2.cmml" xref="S3.E12.m1.1.1.1.1.2"></eq><ci id="S3.E12.m1.1.1.1.1.3.cmml" xref="S3.E12.m1.1.1.1.1.3">𝐻</ci><apply id="S3.E12.m1.1.1.1.1.1.cmml" xref="S3.E12.m1.1.1.1.1.1"><times id="S3.E12.m1.1.1.1.1.1.2.cmml" xref="S3.E12.m1.1.1.1.1.1.2"></times><ci id="S3.E12.m1.1.1.1.1.1.3a.cmml" xref="S3.E12.m1.1.1.1.1.1.3"><mtext id="S3.E12.m1.1.1.1.1.1.3.cmml" xref="S3.E12.m1.1.1.1.1.1.3">Transformer Encoder</mtext></ci><apply id="S3.E12.m1.1.1.1.1.1.1.1.1.cmml" xref="S3.E12.m1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E12.m1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E12.m1.1.1.1.1.1.1.1">superscript</csymbol><apply id="S3.E12.m1.1.1.1.1.1.1.1.1.2.cmml" xref="S3.E12.m1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E12.m1.1.1.1.1.1.1.1.1.2.1.cmml" xref="S3.E12.m1.1.1.1.1.1.1.1">subscript</csymbol><ci id="S3.E12.m1.1.1.1.1.1.1.1.1.2.2.cmml" xref="S3.E12.m1.1.1.1.1.1.1.1.1.2.2">𝑉</ci><ci id="S3.E12.m1.1.1.1.1.1.1.1.1.2.3.cmml" xref="S3.E12.m1.1.1.1.1.1.1.1.1.2.3">𝑖</ci></apply><ci id="S3.E12.m1.1.1.1.1.1.1.1.1.3.cmml" xref="S3.E12.m1.1.1.1.1.1.1.1.1.3">𝑝</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E12.m1.1c">H=\text{Transformer Encoder}\left(V_{i}^{p}\right),</annotation><annotation encoding="application/x-llamapun" id="S3.E12.m1.1d">italic_H = Transformer Encoder ( italic_V start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_p end_POSTSUPERSCRIPT ) ,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_left_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(12)</span></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S3.SS5.p16.2">where, <math alttext="\mathbf{H}\in\mathbb{R}^{12\times 768}" class="ltx_Math" display="inline" id="S3.SS5.p16.1.m1.1"><semantics id="S3.SS5.p16.1.m1.1a"><mrow id="S3.SS5.p16.1.m1.1.1" xref="S3.SS5.p16.1.m1.1.1.cmml"><mi id="S3.SS5.p16.1.m1.1.1.2" xref="S3.SS5.p16.1.m1.1.1.2.cmml">𝐇</mi><mo id="S3.SS5.p16.1.m1.1.1.1" xref="S3.SS5.p16.1.m1.1.1.1.cmml">∈</mo><msup id="S3.SS5.p16.1.m1.1.1.3" xref="S3.SS5.p16.1.m1.1.1.3.cmml"><mi id="S3.SS5.p16.1.m1.1.1.3.2" xref="S3.SS5.p16.1.m1.1.1.3.2.cmml">ℝ</mi><mrow id="S3.SS5.p16.1.m1.1.1.3.3" xref="S3.SS5.p16.1.m1.1.1.3.3.cmml"><mn id="S3.SS5.p16.1.m1.1.1.3.3.2" xref="S3.SS5.p16.1.m1.1.1.3.3.2.cmml">12</mn><mo id="S3.SS5.p16.1.m1.1.1.3.3.1" lspace="0.222em" rspace="0.222em" xref="S3.SS5.p16.1.m1.1.1.3.3.1.cmml">×</mo><mn id="S3.SS5.p16.1.m1.1.1.3.3.3" xref="S3.SS5.p16.1.m1.1.1.3.3.3.cmml">768</mn></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S3.SS5.p16.1.m1.1b"><apply id="S3.SS5.p16.1.m1.1.1.cmml" xref="S3.SS5.p16.1.m1.1.1"><in id="S3.SS5.p16.1.m1.1.1.1.cmml" xref="S3.SS5.p16.1.m1.1.1.1"></in><ci id="S3.SS5.p16.1.m1.1.1.2.cmml" xref="S3.SS5.p16.1.m1.1.1.2">𝐇</ci><apply id="S3.SS5.p16.1.m1.1.1.3.cmml" xref="S3.SS5.p16.1.m1.1.1.3"><csymbol cd="ambiguous" id="S3.SS5.p16.1.m1.1.1.3.1.cmml" xref="S3.SS5.p16.1.m1.1.1.3">superscript</csymbol><ci id="S3.SS5.p16.1.m1.1.1.3.2.cmml" xref="S3.SS5.p16.1.m1.1.1.3.2">ℝ</ci><apply id="S3.SS5.p16.1.m1.1.1.3.3.cmml" xref="S3.SS5.p16.1.m1.1.1.3.3"><times id="S3.SS5.p16.1.m1.1.1.3.3.1.cmml" xref="S3.SS5.p16.1.m1.1.1.3.3.1"></times><cn id="S3.SS5.p16.1.m1.1.1.3.3.2.cmml" type="integer" xref="S3.SS5.p16.1.m1.1.1.3.3.2">12</cn><cn id="S3.SS5.p16.1.m1.1.1.3.3.3.cmml" type="integer" xref="S3.SS5.p16.1.m1.1.1.3.3.3">768</cn></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS5.p16.1.m1.1c">\mathbf{H}\in\mathbb{R}^{12\times 768}</annotation><annotation encoding="application/x-llamapun" id="S3.SS5.p16.1.m1.1d">bold_H ∈ blackboard_R start_POSTSUPERSCRIPT 12 × 768 end_POSTSUPERSCRIPT</annotation></semantics></math> is output of transformer encoder. Base on the output, we extract [CLS] token as representation of whole sequence <math alttext="S" class="ltx_Math" display="inline" id="S3.SS5.p16.2.m2.1"><semantics id="S3.SS5.p16.2.m2.1a"><mi id="S3.SS5.p16.2.m2.1.1" xref="S3.SS5.p16.2.m2.1.1.cmml">S</mi><annotation-xml encoding="MathML-Content" id="S3.SS5.p16.2.m2.1b"><ci id="S3.SS5.p16.2.m2.1.1.cmml" xref="S3.SS5.p16.2.m2.1.1">𝑆</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS5.p16.2.m2.1c">S</annotation><annotation encoding="application/x-llamapun" id="S3.SS5.p16.2.m2.1d">italic_S</annotation></semantics></math>.</p>
</div>
<div class="ltx_para" id="S3.SS5.p17">
<table class="ltx_equation ltx_eqn_table" id="S3.E13">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_left_padleft"></td>
<td class="ltx_eqn_cell ltx_align_left"><math alttext="h_{CLS}=H[0]." class="ltx_Math" display="block" id="S3.E13.m1.2"><semantics id="S3.E13.m1.2a"><mrow id="S3.E13.m1.2.2.1" xref="S3.E13.m1.2.2.1.1.cmml"><mrow id="S3.E13.m1.2.2.1.1" xref="S3.E13.m1.2.2.1.1.cmml"><msub id="S3.E13.m1.2.2.1.1.2" xref="S3.E13.m1.2.2.1.1.2.cmml"><mi id="S3.E13.m1.2.2.1.1.2.2" xref="S3.E13.m1.2.2.1.1.2.2.cmml">h</mi><mrow id="S3.E13.m1.2.2.1.1.2.3" xref="S3.E13.m1.2.2.1.1.2.3.cmml"><mi id="S3.E13.m1.2.2.1.1.2.3.2" xref="S3.E13.m1.2.2.1.1.2.3.2.cmml">C</mi><mo id="S3.E13.m1.2.2.1.1.2.3.1" xref="S3.E13.m1.2.2.1.1.2.3.1.cmml">⁢</mo><mi id="S3.E13.m1.2.2.1.1.2.3.3" xref="S3.E13.m1.2.2.1.1.2.3.3.cmml">L</mi><mo id="S3.E13.m1.2.2.1.1.2.3.1a" xref="S3.E13.m1.2.2.1.1.2.3.1.cmml">⁢</mo><mi id="S3.E13.m1.2.2.1.1.2.3.4" xref="S3.E13.m1.2.2.1.1.2.3.4.cmml">S</mi></mrow></msub><mo id="S3.E13.m1.2.2.1.1.1" xref="S3.E13.m1.2.2.1.1.1.cmml">=</mo><mrow id="S3.E13.m1.2.2.1.1.3" xref="S3.E13.m1.2.2.1.1.3.cmml"><mi id="S3.E13.m1.2.2.1.1.3.2" xref="S3.E13.m1.2.2.1.1.3.2.cmml">H</mi><mo id="S3.E13.m1.2.2.1.1.3.1" xref="S3.E13.m1.2.2.1.1.3.1.cmml">⁢</mo><mrow id="S3.E13.m1.2.2.1.1.3.3.2" xref="S3.E13.m1.2.2.1.1.3.3.1.cmml"><mo id="S3.E13.m1.2.2.1.1.3.3.2.1" stretchy="false" xref="S3.E13.m1.2.2.1.1.3.3.1.1.cmml">[</mo><mn id="S3.E13.m1.1.1" xref="S3.E13.m1.1.1.cmml">0</mn><mo id="S3.E13.m1.2.2.1.1.3.3.2.2" stretchy="false" xref="S3.E13.m1.2.2.1.1.3.3.1.1.cmml">]</mo></mrow></mrow></mrow><mo id="S3.E13.m1.2.2.1.2" lspace="0em" xref="S3.E13.m1.2.2.1.1.cmml">.</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E13.m1.2b"><apply id="S3.E13.m1.2.2.1.1.cmml" xref="S3.E13.m1.2.2.1"><eq id="S3.E13.m1.2.2.1.1.1.cmml" xref="S3.E13.m1.2.2.1.1.1"></eq><apply id="S3.E13.m1.2.2.1.1.2.cmml" xref="S3.E13.m1.2.2.1.1.2"><csymbol cd="ambiguous" id="S3.E13.m1.2.2.1.1.2.1.cmml" xref="S3.E13.m1.2.2.1.1.2">subscript</csymbol><ci id="S3.E13.m1.2.2.1.1.2.2.cmml" xref="S3.E13.m1.2.2.1.1.2.2">ℎ</ci><apply id="S3.E13.m1.2.2.1.1.2.3.cmml" xref="S3.E13.m1.2.2.1.1.2.3"><times id="S3.E13.m1.2.2.1.1.2.3.1.cmml" xref="S3.E13.m1.2.2.1.1.2.3.1"></times><ci id="S3.E13.m1.2.2.1.1.2.3.2.cmml" xref="S3.E13.m1.2.2.1.1.2.3.2">𝐶</ci><ci id="S3.E13.m1.2.2.1.1.2.3.3.cmml" xref="S3.E13.m1.2.2.1.1.2.3.3">𝐿</ci><ci id="S3.E13.m1.2.2.1.1.2.3.4.cmml" xref="S3.E13.m1.2.2.1.1.2.3.4">𝑆</ci></apply></apply><apply id="S3.E13.m1.2.2.1.1.3.cmml" xref="S3.E13.m1.2.2.1.1.3"><times id="S3.E13.m1.2.2.1.1.3.1.cmml" xref="S3.E13.m1.2.2.1.1.3.1"></times><ci id="S3.E13.m1.2.2.1.1.3.2.cmml" xref="S3.E13.m1.2.2.1.1.3.2">𝐻</ci><apply id="S3.E13.m1.2.2.1.1.3.3.1.cmml" xref="S3.E13.m1.2.2.1.1.3.3.2"><csymbol cd="latexml" id="S3.E13.m1.2.2.1.1.3.3.1.1.cmml" xref="S3.E13.m1.2.2.1.1.3.3.2.1">delimited-[]</csymbol><cn id="S3.E13.m1.1.1.cmml" type="integer" xref="S3.E13.m1.1.1">0</cn></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E13.m1.2c">h_{CLS}=H[0].</annotation><annotation encoding="application/x-llamapun" id="S3.E13.m1.2d">italic_h start_POSTSUBSCRIPT italic_C italic_L italic_S end_POSTSUBSCRIPT = italic_H [ 0 ] .</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_left_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(13)</span></td>
</tr></tbody>
</table>
</div>
<div class="ltx_para" id="S3.SS5.p18">
<p class="ltx_p" id="S3.SS5.p18.1">Based on this feature aggregation, we get a global feature vector <math alttext="h_{CLS}" class="ltx_Math" display="inline" id="S3.SS5.p18.1.m1.1"><semantics id="S3.SS5.p18.1.m1.1a"><msub id="S3.SS5.p18.1.m1.1.1" xref="S3.SS5.p18.1.m1.1.1.cmml"><mi id="S3.SS5.p18.1.m1.1.1.2" xref="S3.SS5.p18.1.m1.1.1.2.cmml">h</mi><mrow id="S3.SS5.p18.1.m1.1.1.3" xref="S3.SS5.p18.1.m1.1.1.3.cmml"><mi id="S3.SS5.p18.1.m1.1.1.3.2" xref="S3.SS5.p18.1.m1.1.1.3.2.cmml">C</mi><mo id="S3.SS5.p18.1.m1.1.1.3.1" xref="S3.SS5.p18.1.m1.1.1.3.1.cmml">⁢</mo><mi id="S3.SS5.p18.1.m1.1.1.3.3" xref="S3.SS5.p18.1.m1.1.1.3.3.cmml">L</mi><mo id="S3.SS5.p18.1.m1.1.1.3.1a" xref="S3.SS5.p18.1.m1.1.1.3.1.cmml">⁢</mo><mi id="S3.SS5.p18.1.m1.1.1.3.4" xref="S3.SS5.p18.1.m1.1.1.3.4.cmml">S</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S3.SS5.p18.1.m1.1b"><apply id="S3.SS5.p18.1.m1.1.1.cmml" xref="S3.SS5.p18.1.m1.1.1"><csymbol cd="ambiguous" id="S3.SS5.p18.1.m1.1.1.1.cmml" xref="S3.SS5.p18.1.m1.1.1">subscript</csymbol><ci id="S3.SS5.p18.1.m1.1.1.2.cmml" xref="S3.SS5.p18.1.m1.1.1.2">ℎ</ci><apply id="S3.SS5.p18.1.m1.1.1.3.cmml" xref="S3.SS5.p18.1.m1.1.1.3"><times id="S3.SS5.p18.1.m1.1.1.3.1.cmml" xref="S3.SS5.p18.1.m1.1.1.3.1"></times><ci id="S3.SS5.p18.1.m1.1.1.3.2.cmml" xref="S3.SS5.p18.1.m1.1.1.3.2">𝐶</ci><ci id="S3.SS5.p18.1.m1.1.1.3.3.cmml" xref="S3.SS5.p18.1.m1.1.1.3.3">𝐿</ci><ci id="S3.SS5.p18.1.m1.1.1.3.4.cmml" xref="S3.SS5.p18.1.m1.1.1.3.4">𝑆</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS5.p18.1.m1.1c">h_{CLS}</annotation><annotation encoding="application/x-llamapun" id="S3.SS5.p18.1.m1.1d">italic_h start_POSTSUBSCRIPT italic_C italic_L italic_S end_POSTSUBSCRIPT</annotation></semantics></math> containing multi-modal information. And then, the representation can be applied in classification layer. In our research we implement SoftMax function as output function.</p>
</div>
<div class="ltx_para" id="S3.SS5.p19">
<table class="ltx_equation ltx_eqn_table" id="S3.E14">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_left_padleft"></td>
<td class="ltx_eqn_cell ltx_align_left"><math alttext="y=\text{SoftMax}\left(W\cdot h_{CLS}+b\right)." class="ltx_Math" display="block" id="S3.E14.m1.1"><semantics id="S3.E14.m1.1a"><mrow id="S3.E14.m1.1.1.1" xref="S3.E14.m1.1.1.1.1.cmml"><mrow id="S3.E14.m1.1.1.1.1" xref="S3.E14.m1.1.1.1.1.cmml"><mi id="S3.E14.m1.1.1.1.1.3" xref="S3.E14.m1.1.1.1.1.3.cmml">y</mi><mo id="S3.E14.m1.1.1.1.1.2" xref="S3.E14.m1.1.1.1.1.2.cmml">=</mo><mrow id="S3.E14.m1.1.1.1.1.1" xref="S3.E14.m1.1.1.1.1.1.cmml"><mtext id="S3.E14.m1.1.1.1.1.1.3" xref="S3.E14.m1.1.1.1.1.1.3a.cmml">SoftMax</mtext><mo id="S3.E14.m1.1.1.1.1.1.2" xref="S3.E14.m1.1.1.1.1.1.2.cmml">⁢</mo><mrow id="S3.E14.m1.1.1.1.1.1.1.1" xref="S3.E14.m1.1.1.1.1.1.1.1.1.cmml"><mo id="S3.E14.m1.1.1.1.1.1.1.1.2" xref="S3.E14.m1.1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="S3.E14.m1.1.1.1.1.1.1.1.1" xref="S3.E14.m1.1.1.1.1.1.1.1.1.cmml"><mrow id="S3.E14.m1.1.1.1.1.1.1.1.1.2" xref="S3.E14.m1.1.1.1.1.1.1.1.1.2.cmml"><mi id="S3.E14.m1.1.1.1.1.1.1.1.1.2.2" xref="S3.E14.m1.1.1.1.1.1.1.1.1.2.2.cmml">W</mi><mo id="S3.E14.m1.1.1.1.1.1.1.1.1.2.1" lspace="0.222em" rspace="0.222em" xref="S3.E14.m1.1.1.1.1.1.1.1.1.2.1.cmml">⋅</mo><msub id="S3.E14.m1.1.1.1.1.1.1.1.1.2.3" xref="S3.E14.m1.1.1.1.1.1.1.1.1.2.3.cmml"><mi id="S3.E14.m1.1.1.1.1.1.1.1.1.2.3.2" xref="S3.E14.m1.1.1.1.1.1.1.1.1.2.3.2.cmml">h</mi><mrow id="S3.E14.m1.1.1.1.1.1.1.1.1.2.3.3" xref="S3.E14.m1.1.1.1.1.1.1.1.1.2.3.3.cmml"><mi id="S3.E14.m1.1.1.1.1.1.1.1.1.2.3.3.2" xref="S3.E14.m1.1.1.1.1.1.1.1.1.2.3.3.2.cmml">C</mi><mo id="S3.E14.m1.1.1.1.1.1.1.1.1.2.3.3.1" xref="S3.E14.m1.1.1.1.1.1.1.1.1.2.3.3.1.cmml">⁢</mo><mi id="S3.E14.m1.1.1.1.1.1.1.1.1.2.3.3.3" xref="S3.E14.m1.1.1.1.1.1.1.1.1.2.3.3.3.cmml">L</mi><mo id="S3.E14.m1.1.1.1.1.1.1.1.1.2.3.3.1a" xref="S3.E14.m1.1.1.1.1.1.1.1.1.2.3.3.1.cmml">⁢</mo><mi id="S3.E14.m1.1.1.1.1.1.1.1.1.2.3.3.4" xref="S3.E14.m1.1.1.1.1.1.1.1.1.2.3.3.4.cmml">S</mi></mrow></msub></mrow><mo id="S3.E14.m1.1.1.1.1.1.1.1.1.1" xref="S3.E14.m1.1.1.1.1.1.1.1.1.1.cmml">+</mo><mi id="S3.E14.m1.1.1.1.1.1.1.1.1.3" xref="S3.E14.m1.1.1.1.1.1.1.1.1.3.cmml">b</mi></mrow><mo id="S3.E14.m1.1.1.1.1.1.1.1.3" xref="S3.E14.m1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><mo id="S3.E14.m1.1.1.1.2" lspace="0em" xref="S3.E14.m1.1.1.1.1.cmml">.</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E14.m1.1b"><apply id="S3.E14.m1.1.1.1.1.cmml" xref="S3.E14.m1.1.1.1"><eq id="S3.E14.m1.1.1.1.1.2.cmml" xref="S3.E14.m1.1.1.1.1.2"></eq><ci id="S3.E14.m1.1.1.1.1.3.cmml" xref="S3.E14.m1.1.1.1.1.3">𝑦</ci><apply id="S3.E14.m1.1.1.1.1.1.cmml" xref="S3.E14.m1.1.1.1.1.1"><times id="S3.E14.m1.1.1.1.1.1.2.cmml" xref="S3.E14.m1.1.1.1.1.1.2"></times><ci id="S3.E14.m1.1.1.1.1.1.3a.cmml" xref="S3.E14.m1.1.1.1.1.1.3"><mtext id="S3.E14.m1.1.1.1.1.1.3.cmml" xref="S3.E14.m1.1.1.1.1.1.3">SoftMax</mtext></ci><apply id="S3.E14.m1.1.1.1.1.1.1.1.1.cmml" xref="S3.E14.m1.1.1.1.1.1.1.1"><plus id="S3.E14.m1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E14.m1.1.1.1.1.1.1.1.1.1"></plus><apply id="S3.E14.m1.1.1.1.1.1.1.1.1.2.cmml" xref="S3.E14.m1.1.1.1.1.1.1.1.1.2"><ci id="S3.E14.m1.1.1.1.1.1.1.1.1.2.1.cmml" xref="S3.E14.m1.1.1.1.1.1.1.1.1.2.1">⋅</ci><ci id="S3.E14.m1.1.1.1.1.1.1.1.1.2.2.cmml" xref="S3.E14.m1.1.1.1.1.1.1.1.1.2.2">𝑊</ci><apply id="S3.E14.m1.1.1.1.1.1.1.1.1.2.3.cmml" xref="S3.E14.m1.1.1.1.1.1.1.1.1.2.3"><csymbol cd="ambiguous" id="S3.E14.m1.1.1.1.1.1.1.1.1.2.3.1.cmml" xref="S3.E14.m1.1.1.1.1.1.1.1.1.2.3">subscript</csymbol><ci id="S3.E14.m1.1.1.1.1.1.1.1.1.2.3.2.cmml" xref="S3.E14.m1.1.1.1.1.1.1.1.1.2.3.2">ℎ</ci><apply id="S3.E14.m1.1.1.1.1.1.1.1.1.2.3.3.cmml" xref="S3.E14.m1.1.1.1.1.1.1.1.1.2.3.3"><times id="S3.E14.m1.1.1.1.1.1.1.1.1.2.3.3.1.cmml" xref="S3.E14.m1.1.1.1.1.1.1.1.1.2.3.3.1"></times><ci id="S3.E14.m1.1.1.1.1.1.1.1.1.2.3.3.2.cmml" xref="S3.E14.m1.1.1.1.1.1.1.1.1.2.3.3.2">𝐶</ci><ci id="S3.E14.m1.1.1.1.1.1.1.1.1.2.3.3.3.cmml" xref="S3.E14.m1.1.1.1.1.1.1.1.1.2.3.3.3">𝐿</ci><ci id="S3.E14.m1.1.1.1.1.1.1.1.1.2.3.3.4.cmml" xref="S3.E14.m1.1.1.1.1.1.1.1.1.2.3.3.4">𝑆</ci></apply></apply></apply><ci id="S3.E14.m1.1.1.1.1.1.1.1.1.3.cmml" xref="S3.E14.m1.1.1.1.1.1.1.1.1.3">𝑏</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E14.m1.1c">y=\text{SoftMax}\left(W\cdot h_{CLS}+b\right).</annotation><annotation encoding="application/x-llamapun" id="S3.E14.m1.1d">italic_y = SoftMax ( italic_W ⋅ italic_h start_POSTSUBSCRIPT italic_C italic_L italic_S end_POSTSUBSCRIPT + italic_b ) .</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_left_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(14)</span></td>
</tr></tbody>
</table>
</div>
<div class="ltx_para" id="S3.SS5.p20">
<p class="ltx_p" id="S3.SS5.p20.1">The working process is shown in Figure <a class="ltx_ref" href="https://arxiv.org/html/2407.09157v1#S3.F4" title="Figure 4 ‣ 3.5 Feature fusion based on Transformer ‣ 3 Methodology ‣ Movie Recommendation with Poster Attention via Multi-modal Transformer Feature Fusion"><span class="ltx_text ltx_ref_tag">4</span></a>.</p>
</div>
<figure class="ltx_figure" id="S3.F4"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="236" id="S3.F4.g1" src="extracted/5727377/img/fusion.jpg" width="598"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 4: </span>Framework of proposed features fusion method, where <math alttext="[CLS]" class="ltx_Math" display="inline" id="S3.F4.3.m1.1"><semantics id="S3.F4.3.m1.1b"><mrow id="S3.F4.3.m1.1.1.1" xref="S3.F4.3.m1.1.1.2.cmml"><mo id="S3.F4.3.m1.1.1.1.2" stretchy="false" xref="S3.F4.3.m1.1.1.2.1.cmml">[</mo><mrow id="S3.F4.3.m1.1.1.1.1" xref="S3.F4.3.m1.1.1.1.1.cmml"><mi id="S3.F4.3.m1.1.1.1.1.2" xref="S3.F4.3.m1.1.1.1.1.2.cmml">C</mi><mo id="S3.F4.3.m1.1.1.1.1.1" xref="S3.F4.3.m1.1.1.1.1.1.cmml">⁢</mo><mi id="S3.F4.3.m1.1.1.1.1.3" xref="S3.F4.3.m1.1.1.1.1.3.cmml">L</mi><mo id="S3.F4.3.m1.1.1.1.1.1b" xref="S3.F4.3.m1.1.1.1.1.1.cmml">⁢</mo><mi id="S3.F4.3.m1.1.1.1.1.4" xref="S3.F4.3.m1.1.1.1.1.4.cmml">S</mi></mrow><mo id="S3.F4.3.m1.1.1.1.3" stretchy="false" xref="S3.F4.3.m1.1.1.2.1.cmml">]</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.F4.3.m1.1c"><apply id="S3.F4.3.m1.1.1.2.cmml" xref="S3.F4.3.m1.1.1.1"><csymbol cd="latexml" id="S3.F4.3.m1.1.1.2.1.cmml" xref="S3.F4.3.m1.1.1.1.2">delimited-[]</csymbol><apply id="S3.F4.3.m1.1.1.1.1.cmml" xref="S3.F4.3.m1.1.1.1.1"><times id="S3.F4.3.m1.1.1.1.1.1.cmml" xref="S3.F4.3.m1.1.1.1.1.1"></times><ci id="S3.F4.3.m1.1.1.1.1.2.cmml" xref="S3.F4.3.m1.1.1.1.1.2">𝐶</ci><ci id="S3.F4.3.m1.1.1.1.1.3.cmml" xref="S3.F4.3.m1.1.1.1.1.3">𝐿</ci><ci id="S3.F4.3.m1.1.1.1.1.4.cmml" xref="S3.F4.3.m1.1.1.1.1.4">𝑆</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.F4.3.m1.1d">[CLS]</annotation><annotation encoding="application/x-llamapun" id="S3.F4.3.m1.1e">[ italic_C italic_L italic_S ]</annotation></semantics></math> and <math alttext="[SEP]" class="ltx_Math" display="inline" id="S3.F4.4.m2.1"><semantics id="S3.F4.4.m2.1b"><mrow id="S3.F4.4.m2.1.1.1" xref="S3.F4.4.m2.1.1.2.cmml"><mo id="S3.F4.4.m2.1.1.1.2" stretchy="false" xref="S3.F4.4.m2.1.1.2.1.cmml">[</mo><mrow id="S3.F4.4.m2.1.1.1.1" xref="S3.F4.4.m2.1.1.1.1.cmml"><mi id="S3.F4.4.m2.1.1.1.1.2" xref="S3.F4.4.m2.1.1.1.1.2.cmml">S</mi><mo id="S3.F4.4.m2.1.1.1.1.1" xref="S3.F4.4.m2.1.1.1.1.1.cmml">⁢</mo><mi id="S3.F4.4.m2.1.1.1.1.3" xref="S3.F4.4.m2.1.1.1.1.3.cmml">E</mi><mo id="S3.F4.4.m2.1.1.1.1.1b" xref="S3.F4.4.m2.1.1.1.1.1.cmml">⁢</mo><mi id="S3.F4.4.m2.1.1.1.1.4" xref="S3.F4.4.m2.1.1.1.1.4.cmml">P</mi></mrow><mo id="S3.F4.4.m2.1.1.1.3" stretchy="false" xref="S3.F4.4.m2.1.1.2.1.cmml">]</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.F4.4.m2.1c"><apply id="S3.F4.4.m2.1.1.2.cmml" xref="S3.F4.4.m2.1.1.1"><csymbol cd="latexml" id="S3.F4.4.m2.1.1.2.1.cmml" xref="S3.F4.4.m2.1.1.1.2">delimited-[]</csymbol><apply id="S3.F4.4.m2.1.1.1.1.cmml" xref="S3.F4.4.m2.1.1.1.1"><times id="S3.F4.4.m2.1.1.1.1.1.cmml" xref="S3.F4.4.m2.1.1.1.1.1"></times><ci id="S3.F4.4.m2.1.1.1.1.2.cmml" xref="S3.F4.4.m2.1.1.1.1.2">𝑆</ci><ci id="S3.F4.4.m2.1.1.1.1.3.cmml" xref="S3.F4.4.m2.1.1.1.1.3">𝐸</ci><ci id="S3.F4.4.m2.1.1.1.1.4.cmml" xref="S3.F4.4.m2.1.1.1.1.4">𝑃</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.F4.4.m2.1d">[SEP]</annotation><annotation encoding="application/x-llamapun" id="S3.F4.4.m2.1e">[ italic_S italic_E italic_P ]</annotation></semantics></math> token is the beginning and the end of sequence. </figcaption>
</figure>
</section>
</section>
<section class="ltx_section" id="S4">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">4 </span>Results</h2>
<div class="ltx_para" id="S4.p1">
<p class="ltx_p" id="S4.p1.1">In this section, we describe in detail the experiments we conducted to verify the validity of the model and test its performance. In this experiment, two datasets, MovieLens 1M and MovieLens 100k, were used as experimental data respectively to verify the validity of the model in different data. And we reproduce some classic algorithms such as item-CF, user-CF, and SVD. At the same time, we refer to the literature of Mu et al. <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2407.09157v1#bib.bib3" title="">3</a>]</cite> in multi-modal movie recommendation algorithm, and reproduce their work to compare with our proposed model.</p>
</div>
<section class="ltx_subsection" id="S4.SS1">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.1 </span>Hardware and Environment configure</h3>
<div class="ltx_para" id="S4.SS1.p1">
<p class="ltx_p" id="S4.SS1.p1.1">Our experiment used Google Colab as the computing platform, configured with an Nvidia A100 GPU and extended RAM. In the experimental environment configuration, the Python validation is 3.10.0, CUDA version is 12.1, Pytorch version is 2.3.0+cu121, torchvision version is 0.18.0+cu121, and transformers version is 4.30.0. In addition, the ”Google-Bert/Bert-base-uncased” is used as the BERT model and the ”google/ VIT-base-Patch16-224 ”is used as the ViT model.</p>
</div>
<div class="ltx_para" id="S4.SS1.p2">
<p class="ltx_p" id="S4.SS1.p2.1">We split the MovieLens data set into a training set, a test set, and a verifier in a ratio of 9:0.5:0.5. We use the RMSE as an indicator to evaluate the predictive power of the model. The fomula of RMSE reads as:</p>
</div>
<div class="ltx_para" id="S4.SS1.p3">
<table class="ltx_equation ltx_eqn_table" id="S4.E15">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_left_padleft"></td>
<td class="ltx_eqn_cell ltx_align_left"><math alttext="\text{RMSE}=\sqrt{\frac{1}{N}\sum_{i=1}^{N}\left(y_{i}-\hat{y}_{i}\right)^{2}}," class="ltx_Math" display="block" id="S4.E15.m1.2"><semantics id="S4.E15.m1.2a"><mrow id="S4.E15.m1.2.2.1" xref="S4.E15.m1.2.2.1.1.cmml"><mrow id="S4.E15.m1.2.2.1.1" xref="S4.E15.m1.2.2.1.1.cmml"><mtext id="S4.E15.m1.2.2.1.1.2" xref="S4.E15.m1.2.2.1.1.2a.cmml">RMSE</mtext><mo id="S4.E15.m1.2.2.1.1.1" xref="S4.E15.m1.2.2.1.1.1.cmml">=</mo><msqrt id="S4.E15.m1.1.1" xref="S4.E15.m1.1.1.cmml"><mrow id="S4.E15.m1.1.1.1" xref="S4.E15.m1.1.1.1.cmml"><mfrac id="S4.E15.m1.1.1.1.3" xref="S4.E15.m1.1.1.1.3.cmml"><mn id="S4.E15.m1.1.1.1.3.2" xref="S4.E15.m1.1.1.1.3.2.cmml">1</mn><mi id="S4.E15.m1.1.1.1.3.3" xref="S4.E15.m1.1.1.1.3.3.cmml">N</mi></mfrac><mo id="S4.E15.m1.1.1.1.2" xref="S4.E15.m1.1.1.1.2.cmml">⁢</mo><mrow id="S4.E15.m1.1.1.1.1" xref="S4.E15.m1.1.1.1.1.cmml"><munderover id="S4.E15.m1.1.1.1.1.2" xref="S4.E15.m1.1.1.1.1.2.cmml"><mo id="S4.E15.m1.1.1.1.1.2.2.2" movablelimits="false" rspace="0em" xref="S4.E15.m1.1.1.1.1.2.2.2.cmml">∑</mo><mrow id="S4.E15.m1.1.1.1.1.2.2.3" xref="S4.E15.m1.1.1.1.1.2.2.3.cmml"><mi id="S4.E15.m1.1.1.1.1.2.2.3.2" xref="S4.E15.m1.1.1.1.1.2.2.3.2.cmml">i</mi><mo id="S4.E15.m1.1.1.1.1.2.2.3.1" xref="S4.E15.m1.1.1.1.1.2.2.3.1.cmml">=</mo><mn id="S4.E15.m1.1.1.1.1.2.2.3.3" xref="S4.E15.m1.1.1.1.1.2.2.3.3.cmml">1</mn></mrow><mi id="S4.E15.m1.1.1.1.1.2.3" xref="S4.E15.m1.1.1.1.1.2.3.cmml">N</mi></munderover><msup id="S4.E15.m1.1.1.1.1.1" xref="S4.E15.m1.1.1.1.1.1.cmml"><mrow id="S4.E15.m1.1.1.1.1.1.1.1" xref="S4.E15.m1.1.1.1.1.1.1.1.1.cmml"><mo id="S4.E15.m1.1.1.1.1.1.1.1.2" xref="S4.E15.m1.1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="S4.E15.m1.1.1.1.1.1.1.1.1" xref="S4.E15.m1.1.1.1.1.1.1.1.1.cmml"><msub id="S4.E15.m1.1.1.1.1.1.1.1.1.2" xref="S4.E15.m1.1.1.1.1.1.1.1.1.2.cmml"><mi id="S4.E15.m1.1.1.1.1.1.1.1.1.2.2" xref="S4.E15.m1.1.1.1.1.1.1.1.1.2.2.cmml">y</mi><mi id="S4.E15.m1.1.1.1.1.1.1.1.1.2.3" xref="S4.E15.m1.1.1.1.1.1.1.1.1.2.3.cmml">i</mi></msub><mo id="S4.E15.m1.1.1.1.1.1.1.1.1.1" xref="S4.E15.m1.1.1.1.1.1.1.1.1.1.cmml">−</mo><msub id="S4.E15.m1.1.1.1.1.1.1.1.1.3" xref="S4.E15.m1.1.1.1.1.1.1.1.1.3.cmml"><mover accent="true" id="S4.E15.m1.1.1.1.1.1.1.1.1.3.2" xref="S4.E15.m1.1.1.1.1.1.1.1.1.3.2.cmml"><mi id="S4.E15.m1.1.1.1.1.1.1.1.1.3.2.2" xref="S4.E15.m1.1.1.1.1.1.1.1.1.3.2.2.cmml">y</mi><mo id="S4.E15.m1.1.1.1.1.1.1.1.1.3.2.1" xref="S4.E15.m1.1.1.1.1.1.1.1.1.3.2.1.cmml">^</mo></mover><mi id="S4.E15.m1.1.1.1.1.1.1.1.1.3.3" xref="S4.E15.m1.1.1.1.1.1.1.1.1.3.3.cmml">i</mi></msub></mrow><mo id="S4.E15.m1.1.1.1.1.1.1.1.3" xref="S4.E15.m1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow><mn id="S4.E15.m1.1.1.1.1.1.3" xref="S4.E15.m1.1.1.1.1.1.3.cmml">2</mn></msup></mrow></mrow></msqrt></mrow><mo id="S4.E15.m1.2.2.1.2" xref="S4.E15.m1.2.2.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.E15.m1.2b"><apply id="S4.E15.m1.2.2.1.1.cmml" xref="S4.E15.m1.2.2.1"><eq id="S4.E15.m1.2.2.1.1.1.cmml" xref="S4.E15.m1.2.2.1.1.1"></eq><ci id="S4.E15.m1.2.2.1.1.2a.cmml" xref="S4.E15.m1.2.2.1.1.2"><mtext id="S4.E15.m1.2.2.1.1.2.cmml" xref="S4.E15.m1.2.2.1.1.2">RMSE</mtext></ci><apply id="S4.E15.m1.1.1.cmml" xref="S4.E15.m1.1.1"><root id="S4.E15.m1.1.1a.cmml" xref="S4.E15.m1.1.1"></root><apply id="S4.E15.m1.1.1.1.cmml" xref="S4.E15.m1.1.1.1"><times id="S4.E15.m1.1.1.1.2.cmml" xref="S4.E15.m1.1.1.1.2"></times><apply id="S4.E15.m1.1.1.1.3.cmml" xref="S4.E15.m1.1.1.1.3"><divide id="S4.E15.m1.1.1.1.3.1.cmml" xref="S4.E15.m1.1.1.1.3"></divide><cn id="S4.E15.m1.1.1.1.3.2.cmml" type="integer" xref="S4.E15.m1.1.1.1.3.2">1</cn><ci id="S4.E15.m1.1.1.1.3.3.cmml" xref="S4.E15.m1.1.1.1.3.3">𝑁</ci></apply><apply id="S4.E15.m1.1.1.1.1.cmml" xref="S4.E15.m1.1.1.1.1"><apply id="S4.E15.m1.1.1.1.1.2.cmml" xref="S4.E15.m1.1.1.1.1.2"><csymbol cd="ambiguous" id="S4.E15.m1.1.1.1.1.2.1.cmml" xref="S4.E15.m1.1.1.1.1.2">superscript</csymbol><apply id="S4.E15.m1.1.1.1.1.2.2.cmml" xref="S4.E15.m1.1.1.1.1.2"><csymbol cd="ambiguous" id="S4.E15.m1.1.1.1.1.2.2.1.cmml" xref="S4.E15.m1.1.1.1.1.2">subscript</csymbol><sum id="S4.E15.m1.1.1.1.1.2.2.2.cmml" xref="S4.E15.m1.1.1.1.1.2.2.2"></sum><apply id="S4.E15.m1.1.1.1.1.2.2.3.cmml" xref="S4.E15.m1.1.1.1.1.2.2.3"><eq id="S4.E15.m1.1.1.1.1.2.2.3.1.cmml" xref="S4.E15.m1.1.1.1.1.2.2.3.1"></eq><ci id="S4.E15.m1.1.1.1.1.2.2.3.2.cmml" xref="S4.E15.m1.1.1.1.1.2.2.3.2">𝑖</ci><cn id="S4.E15.m1.1.1.1.1.2.2.3.3.cmml" type="integer" xref="S4.E15.m1.1.1.1.1.2.2.3.3">1</cn></apply></apply><ci id="S4.E15.m1.1.1.1.1.2.3.cmml" xref="S4.E15.m1.1.1.1.1.2.3">𝑁</ci></apply><apply id="S4.E15.m1.1.1.1.1.1.cmml" xref="S4.E15.m1.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.E15.m1.1.1.1.1.1.2.cmml" xref="S4.E15.m1.1.1.1.1.1">superscript</csymbol><apply id="S4.E15.m1.1.1.1.1.1.1.1.1.cmml" xref="S4.E15.m1.1.1.1.1.1.1.1"><minus id="S4.E15.m1.1.1.1.1.1.1.1.1.1.cmml" xref="S4.E15.m1.1.1.1.1.1.1.1.1.1"></minus><apply id="S4.E15.m1.1.1.1.1.1.1.1.1.2.cmml" xref="S4.E15.m1.1.1.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S4.E15.m1.1.1.1.1.1.1.1.1.2.1.cmml" xref="S4.E15.m1.1.1.1.1.1.1.1.1.2">subscript</csymbol><ci id="S4.E15.m1.1.1.1.1.1.1.1.1.2.2.cmml" xref="S4.E15.m1.1.1.1.1.1.1.1.1.2.2">𝑦</ci><ci id="S4.E15.m1.1.1.1.1.1.1.1.1.2.3.cmml" xref="S4.E15.m1.1.1.1.1.1.1.1.1.2.3">𝑖</ci></apply><apply id="S4.E15.m1.1.1.1.1.1.1.1.1.3.cmml" xref="S4.E15.m1.1.1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S4.E15.m1.1.1.1.1.1.1.1.1.3.1.cmml" xref="S4.E15.m1.1.1.1.1.1.1.1.1.3">subscript</csymbol><apply id="S4.E15.m1.1.1.1.1.1.1.1.1.3.2.cmml" xref="S4.E15.m1.1.1.1.1.1.1.1.1.3.2"><ci id="S4.E15.m1.1.1.1.1.1.1.1.1.3.2.1.cmml" xref="S4.E15.m1.1.1.1.1.1.1.1.1.3.2.1">^</ci><ci id="S4.E15.m1.1.1.1.1.1.1.1.1.3.2.2.cmml" xref="S4.E15.m1.1.1.1.1.1.1.1.1.3.2.2">𝑦</ci></apply><ci id="S4.E15.m1.1.1.1.1.1.1.1.1.3.3.cmml" xref="S4.E15.m1.1.1.1.1.1.1.1.1.3.3">𝑖</ci></apply></apply><cn id="S4.E15.m1.1.1.1.1.1.3.cmml" type="integer" xref="S4.E15.m1.1.1.1.1.1.3">2</cn></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.E15.m1.2c">\text{RMSE}=\sqrt{\frac{1}{N}\sum_{i=1}^{N}\left(y_{i}-\hat{y}_{i}\right)^{2}},</annotation><annotation encoding="application/x-llamapun" id="S4.E15.m1.2d">RMSE = square-root start_ARG divide start_ARG 1 end_ARG start_ARG italic_N end_ARG ∑ start_POSTSUBSCRIPT italic_i = 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_N end_POSTSUPERSCRIPT ( italic_y start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT - over^ start_ARG italic_y end_ARG start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT ) start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT end_ARG ,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_left_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(15)</span></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S4.SS1.p3.3">where, <math alttext="N" class="ltx_Math" display="inline" id="S4.SS1.p3.1.m1.1"><semantics id="S4.SS1.p3.1.m1.1a"><mi id="S4.SS1.p3.1.m1.1.1" xref="S4.SS1.p3.1.m1.1.1.cmml">N</mi><annotation-xml encoding="MathML-Content" id="S4.SS1.p3.1.m1.1b"><ci id="S4.SS1.p3.1.m1.1.1.cmml" xref="S4.SS1.p3.1.m1.1.1">𝑁</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p3.1.m1.1c">N</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p3.1.m1.1d">italic_N</annotation></semantics></math> is number of samples and <math alttext="y_{i}" class="ltx_Math" display="inline" id="S4.SS1.p3.2.m2.1"><semantics id="S4.SS1.p3.2.m2.1a"><msub id="S4.SS1.p3.2.m2.1.1" xref="S4.SS1.p3.2.m2.1.1.cmml"><mi id="S4.SS1.p3.2.m2.1.1.2" xref="S4.SS1.p3.2.m2.1.1.2.cmml">y</mi><mi id="S4.SS1.p3.2.m2.1.1.3" xref="S4.SS1.p3.2.m2.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS1.p3.2.m2.1b"><apply id="S4.SS1.p3.2.m2.1.1.cmml" xref="S4.SS1.p3.2.m2.1.1"><csymbol cd="ambiguous" id="S4.SS1.p3.2.m2.1.1.1.cmml" xref="S4.SS1.p3.2.m2.1.1">subscript</csymbol><ci id="S4.SS1.p3.2.m2.1.1.2.cmml" xref="S4.SS1.p3.2.m2.1.1.2">𝑦</ci><ci id="S4.SS1.p3.2.m2.1.1.3.cmml" xref="S4.SS1.p3.2.m2.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p3.2.m2.1c">y_{i}</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p3.2.m2.1d">italic_y start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT</annotation></semantics></math> is true label, <math alttext="\hat{y}_{i}" class="ltx_Math" display="inline" id="S4.SS1.p3.3.m3.1"><semantics id="S4.SS1.p3.3.m3.1a"><msub id="S4.SS1.p3.3.m3.1.1" xref="S4.SS1.p3.3.m3.1.1.cmml"><mover accent="true" id="S4.SS1.p3.3.m3.1.1.2" xref="S4.SS1.p3.3.m3.1.1.2.cmml"><mi id="S4.SS1.p3.3.m3.1.1.2.2" xref="S4.SS1.p3.3.m3.1.1.2.2.cmml">y</mi><mo id="S4.SS1.p3.3.m3.1.1.2.1" xref="S4.SS1.p3.3.m3.1.1.2.1.cmml">^</mo></mover><mi id="S4.SS1.p3.3.m3.1.1.3" xref="S4.SS1.p3.3.m3.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS1.p3.3.m3.1b"><apply id="S4.SS1.p3.3.m3.1.1.cmml" xref="S4.SS1.p3.3.m3.1.1"><csymbol cd="ambiguous" id="S4.SS1.p3.3.m3.1.1.1.cmml" xref="S4.SS1.p3.3.m3.1.1">subscript</csymbol><apply id="S4.SS1.p3.3.m3.1.1.2.cmml" xref="S4.SS1.p3.3.m3.1.1.2"><ci id="S4.SS1.p3.3.m3.1.1.2.1.cmml" xref="S4.SS1.p3.3.m3.1.1.2.1">^</ci><ci id="S4.SS1.p3.3.m3.1.1.2.2.cmml" xref="S4.SS1.p3.3.m3.1.1.2.2">𝑦</ci></apply><ci id="S4.SS1.p3.3.m3.1.1.3.cmml" xref="S4.SS1.p3.3.m3.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p3.3.m3.1c">\hat{y}_{i}</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p3.3.m3.1d">over^ start_ARG italic_y end_ARG start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT</annotation></semantics></math> is predicted label.</p>
</div>
</section>
<section class="ltx_subsection" id="S4.SS2">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.2 </span>Introduction of dataset</h3>
<div class="ltx_para" id="S4.SS2.p1">
<p class="ltx_p" id="S4.SS2.p1.1">The MovieLens dataset was collected and published by the GroupLens research group at the University of Minnesota to support research on movie recommender systems. This dataset is one of the widely used and studied data sets in the field of recommendation system, which contains users’ ratings of movies and related movie information. The data sets used in this study are MovieLens 1M and MovieLens 100k. The MovieLens 100k dataset contains 100,000 movie ratings from 943 users and 1,682 movie ratings. Each user has reviewed at least five movies with ratings ranging from 1 to 5. The dataset also includes the year of release and genre of the film’s title. Similar to MovieLens 100k The MovieLens 1M dataset contains the same content but the dataset is much larger, with 1 million ratings from more than 6,000 users and 3,900 movies. The MovieLens dataset covers all types of movies from all ages, and the diverse rating behaviors of users can be used to mine the preferences and rating patterns of different user groups.This research uses movie posters and movie introductions in movie data from IMDB datasets.</p>
</div>
<figure class="ltx_table" id="S4.T1">
<table class="ltx_tabular ltx_centering ltx_guessed_headers ltx_align_middle" id="S4.T1.1">
<thead class="ltx_thead">
<tr class="ltx_tr" id="S4.T1.1.1.1">
<th class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_border_tt" id="S4.T1.1.1.1.1"><span class="ltx_text ltx_font_bold" id="S4.T1.1.1.1.1.1">Dataset</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="S4.T1.1.1.1.2"><span class="ltx_text ltx_font_bold" id="S4.T1.1.1.1.2.1">Data</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="S4.T1.1.1.1.3"><span class="ltx_text ltx_font_bold" id="S4.T1.1.1.1.3.1">Value</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="S4.T1.1.1.1.4"><span class="ltx_text ltx_font_bold" id="S4.T1.1.1.1.4.1">Data size</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="S4.T1.1.1.1.5"><span class="ltx_text ltx_font_bold" id="S4.T1.1.1.1.5.1">Data size with poster</span></th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr class="ltx_tr" id="S4.T1.1.2.1">
<td class="ltx_td ltx_align_left ltx_border_t" id="S4.T1.1.2.1.1" rowspan="4"><span class="ltx_text" id="S4.T1.1.2.1.1.1">MovieLens 100K</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T1.1.2.1.2">Users</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T1.1.2.1.3">943</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T1.1.2.1.4" rowspan="4"><span class="ltx_text" id="S4.T1.1.2.1.4.1">5.3 MB</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T1.1.2.1.5" rowspan="4"><span class="ltx_text" id="S4.T1.1.2.1.5.1">1.153 GB</span></td>
</tr>
<tr class="ltx_tr" id="S4.T1.1.3.2">
<td class="ltx_td ltx_align_center" id="S4.T1.1.3.2.1">Movies</td>
<td class="ltx_td ltx_align_center" id="S4.T1.1.3.2.2">1682</td>
</tr>
<tr class="ltx_tr" id="S4.T1.1.4.3">
<td class="ltx_td ltx_align_center" id="S4.T1.1.4.3.1">Ratings</td>
<td class="ltx_td ltx_align_center" id="S4.T1.1.4.3.2">100,000</td>
</tr>
<tr class="ltx_tr" id="S4.T1.1.5.4">
<td class="ltx_td ltx_align_center" id="S4.T1.1.5.4.1">Sparsity</td>
<td class="ltx_td ltx_align_center" id="S4.T1.1.5.4.2">93.695%</td>
</tr>
<tr class="ltx_tr" id="S4.T1.1.6.5">
<td class="ltx_td ltx_align_left ltx_border_bb ltx_border_t" id="S4.T1.1.6.5.1" rowspan="4"><span class="ltx_text" id="S4.T1.1.6.5.1.1">MovieLens 1M</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T1.1.6.5.2">Users</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T1.1.6.5.3">6040</td>
<td class="ltx_td ltx_align_center ltx_border_bb ltx_border_t" id="S4.T1.1.6.5.4" rowspan="4"><span class="ltx_text" id="S4.T1.1.6.5.4.1">21.7 MB</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb ltx_border_t" id="S4.T1.1.6.5.5" rowspan="4"><span class="ltx_text" id="S4.T1.1.6.5.5.1">11.530 GB</span></td>
</tr>
<tr class="ltx_tr" id="S4.T1.1.7.6">
<td class="ltx_td ltx_align_center" id="S4.T1.1.7.6.1">Items</td>
<td class="ltx_td ltx_align_center" id="S4.T1.1.7.6.2">3883</td>
</tr>
<tr class="ltx_tr" id="S4.T1.1.8.7">
<td class="ltx_td ltx_align_center" id="S4.T1.1.8.7.1">Ratings</td>
<td class="ltx_td ltx_align_center" id="S4.T1.1.8.7.2">1,000,209</td>
</tr>
<tr class="ltx_tr" id="S4.T1.1.9.8">
<td class="ltx_td ltx_align_center ltx_border_bb" id="S4.T1.1.9.8.1">Sparsity</td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S4.T1.1.9.8.2">95.359%</td>
</tr>
</tbody>
</table>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table">Table 1: </span>Statistics of MovieLens datasets</figcaption>
</figure>
<div class="ltx_para" id="S4.SS2.p2">
<p class="ltx_p" id="S4.SS2.p2.1">In test A, we compare the proposed model with multiple baseline approaches includes three different categories: traditional method which used non-deep learning method and single modal information; deep learning method which used deep-learning technique but only single modal and multi-modal method which used deep-learning and multiple modals information.</p>
</div>
<div class="ltx_para" id="S4.SS2.p3">
<p class="ltx_p" id="S4.SS2.p3.1">For traditional method, we replicate User-CF, item-CF and SVD algorithm. For deep learning method we replicate Siet et al.’s <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2407.09157v1#bib.bib30" title="">30</a>]</cite> work and Aljunid et al.’s <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2407.09157v1#bib.bib31" title="">31</a>]</cite> work.</p>
</div>
<div class="ltx_para" id="S4.SS2.p4">
<p class="ltx_p" id="S4.SS2.p4.1">For multi-modal method, we replicate the algorithm proposed by Mu et al. <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2407.09157v1#bib.bib3" title="">3</a>]</cite>, which use convolution neural network to embed the poster information and use dense layer to embed other information such as users’ age, ZIP code movies’ genre and so on. For poster data, we implement crawling technique to obtain movie poster and movie’s introduction information from IMDB open source dataset in the data preparation phase. To evaluate the effect of multi-modal information, we divide the test into two different situations: single modal and cross modal, where single modal’s input exclude poster and cross modal’s input include poster. We evaluated the performance of different algorithms based on RMSE metrics. To verify the effectiveness of the cross-modal algorithms, we set up a control group without inputting movie poster information. The result is illustrated in Table <a class="ltx_ref" href="https://arxiv.org/html/2407.09157v1#S4.T2" title="Table 2 ‣ 4.2 Introduction of dataset ‣ 4 Results ‣ Movie Recommendation with Poster Attention via Multi-modal Transformer Feature Fusion"><span class="ltx_text ltx_ref_tag">2</span></a>.</p>
</div>
<figure class="ltx_table" id="S4.T2">
<table class="ltx_tabular ltx_centering ltx_guessed_headers ltx_align_middle" id="S4.T2.4">
<tbody class="ltx_tbody">
<tr class="ltx_tr" id="S4.T2.4.5.1">
<th class="ltx_td ltx_th ltx_th_row ltx_border_tt" id="S4.T2.4.5.1.1"></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_tt" id="S4.T2.4.5.1.2"><span class="ltx_text ltx_font_bold" id="S4.T2.4.5.1.2.1">Approaches</span></th>
<td class="ltx_td ltx_align_center ltx_border_tt" id="S4.T2.4.5.1.3"><span class="ltx_text ltx_font_bold" id="S4.T2.4.5.1.3.1">Train set</span></td>
<td class="ltx_td ltx_align_center ltx_border_tt" id="S4.T2.4.5.1.4"><span class="ltx_text ltx_font_bold" id="S4.T2.4.5.1.4.1">Test set</span></td>
</tr>
<tr class="ltx_tr" id="S4.T2.4.6.2">
<th class="ltx_td ltx_align_center ltx_align_middle ltx_th ltx_th_row ltx_border_t" id="S4.T2.4.6.2.1" rowspan="3"><span class="ltx_text" id="S4.T2.4.6.2.1.1">Traditional</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_t" id="S4.T2.4.6.2.2">Item-CF</th>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T2.4.6.2.3">2.534</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T2.4.6.2.4">2.812</td>
</tr>
<tr class="ltx_tr" id="S4.T2.4.7.3">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row" id="S4.T2.4.7.3.1">User-CF</th>
<td class="ltx_td ltx_align_center" id="S4.T2.4.7.3.2">2.221</td>
<td class="ltx_td ltx_align_center" id="S4.T2.4.7.3.3">2.310</td>
</tr>
<tr class="ltx_tr" id="S4.T2.4.8.4">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row" id="S4.T2.4.8.4.1">SVD</th>
<td class="ltx_td ltx_align_center" id="S4.T2.4.8.4.2">2.345</td>
<td class="ltx_td ltx_align_center" id="S4.T2.4.8.4.3">2.298</td>
</tr>
<tr class="ltx_tr" id="S4.T2.4.9.5">
<th class="ltx_td ltx_align_center ltx_align_middle ltx_th ltx_th_row ltx_border_t" id="S4.T2.4.9.5.1" rowspan="2"><span class="ltx_text" id="S4.T2.4.9.5.1.1">Deep learning</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_t" id="S4.T2.4.9.5.2">Siet’s work</th>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T2.4.9.5.3">1.127</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T2.4.9.5.4">0.994</td>
</tr>
<tr class="ltx_tr" id="S4.T2.4.10.6">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row" id="S4.T2.4.10.6.1">Aljunid’s work</th>
<td class="ltx_td ltx_align_center" id="S4.T2.4.10.6.2">1.085</td>
<td class="ltx_td ltx_align_center" id="S4.T2.4.10.6.3">0.947</td>
</tr>
<tr class="ltx_tr" id="S4.T2.1.1">
<th class="ltx_td ltx_align_center ltx_align_middle ltx_th ltx_th_row ltx_border_bb ltx_border_t" id="S4.T2.1.1.2" rowspan="4"><span class="ltx_text" id="S4.T2.1.1.2.1">Multi-modal</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_t" id="S4.T2.1.1.1"><math alttext="\text{Mu's work}_{sin}" class="ltx_Math" display="inline" id="S4.T2.1.1.1.m1.1"><semantics id="S4.T2.1.1.1.m1.1a"><msub id="S4.T2.1.1.1.m1.1.1" xref="S4.T2.1.1.1.m1.1.1.cmml"><mtext id="S4.T2.1.1.1.m1.1.1.2" xref="S4.T2.1.1.1.m1.1.1.2a.cmml">Mu’s work</mtext><mrow id="S4.T2.1.1.1.m1.1.1.3" xref="S4.T2.1.1.1.m1.1.1.3.cmml"><mi id="S4.T2.1.1.1.m1.1.1.3.2" xref="S4.T2.1.1.1.m1.1.1.3.2.cmml">s</mi><mo id="S4.T2.1.1.1.m1.1.1.3.1" xref="S4.T2.1.1.1.m1.1.1.3.1.cmml">⁢</mo><mi id="S4.T2.1.1.1.m1.1.1.3.3" xref="S4.T2.1.1.1.m1.1.1.3.3.cmml">i</mi><mo id="S4.T2.1.1.1.m1.1.1.3.1a" xref="S4.T2.1.1.1.m1.1.1.3.1.cmml">⁢</mo><mi id="S4.T2.1.1.1.m1.1.1.3.4" xref="S4.T2.1.1.1.m1.1.1.3.4.cmml">n</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S4.T2.1.1.1.m1.1b"><apply id="S4.T2.1.1.1.m1.1.1.cmml" xref="S4.T2.1.1.1.m1.1.1"><csymbol cd="ambiguous" id="S4.T2.1.1.1.m1.1.1.1.cmml" xref="S4.T2.1.1.1.m1.1.1">subscript</csymbol><ci id="S4.T2.1.1.1.m1.1.1.2a.cmml" xref="S4.T2.1.1.1.m1.1.1.2"><mtext id="S4.T2.1.1.1.m1.1.1.2.cmml" xref="S4.T2.1.1.1.m1.1.1.2">Mu’s work</mtext></ci><apply id="S4.T2.1.1.1.m1.1.1.3.cmml" xref="S4.T2.1.1.1.m1.1.1.3"><times id="S4.T2.1.1.1.m1.1.1.3.1.cmml" xref="S4.T2.1.1.1.m1.1.1.3.1"></times><ci id="S4.T2.1.1.1.m1.1.1.3.2.cmml" xref="S4.T2.1.1.1.m1.1.1.3.2">𝑠</ci><ci id="S4.T2.1.1.1.m1.1.1.3.3.cmml" xref="S4.T2.1.1.1.m1.1.1.3.3">𝑖</ci><ci id="S4.T2.1.1.1.m1.1.1.3.4.cmml" xref="S4.T2.1.1.1.m1.1.1.3.4">𝑛</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.T2.1.1.1.m1.1c">\text{Mu's work}_{sin}</annotation><annotation encoding="application/x-llamapun" id="S4.T2.1.1.1.m1.1d">Mu’s work start_POSTSUBSCRIPT italic_s italic_i italic_n end_POSTSUBSCRIPT</annotation></semantics></math></th>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T2.1.1.3">1.137</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T2.1.1.4">1.004</td>
</tr>
<tr class="ltx_tr" id="S4.T2.2.2">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row" id="S4.T2.2.2.1"><math alttext="\text{Mu's work}_{cro}" class="ltx_Math" display="inline" id="S4.T2.2.2.1.m1.1"><semantics id="S4.T2.2.2.1.m1.1a"><msub id="S4.T2.2.2.1.m1.1.1" xref="S4.T2.2.2.1.m1.1.1.cmml"><mtext id="S4.T2.2.2.1.m1.1.1.2" xref="S4.T2.2.2.1.m1.1.1.2a.cmml">Mu’s work</mtext><mrow id="S4.T2.2.2.1.m1.1.1.3" xref="S4.T2.2.2.1.m1.1.1.3.cmml"><mi id="S4.T2.2.2.1.m1.1.1.3.2" xref="S4.T2.2.2.1.m1.1.1.3.2.cmml">c</mi><mo id="S4.T2.2.2.1.m1.1.1.3.1" xref="S4.T2.2.2.1.m1.1.1.3.1.cmml">⁢</mo><mi id="S4.T2.2.2.1.m1.1.1.3.3" xref="S4.T2.2.2.1.m1.1.1.3.3.cmml">r</mi><mo id="S4.T2.2.2.1.m1.1.1.3.1a" xref="S4.T2.2.2.1.m1.1.1.3.1.cmml">⁢</mo><mi id="S4.T2.2.2.1.m1.1.1.3.4" xref="S4.T2.2.2.1.m1.1.1.3.4.cmml">o</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S4.T2.2.2.1.m1.1b"><apply id="S4.T2.2.2.1.m1.1.1.cmml" xref="S4.T2.2.2.1.m1.1.1"><csymbol cd="ambiguous" id="S4.T2.2.2.1.m1.1.1.1.cmml" xref="S4.T2.2.2.1.m1.1.1">subscript</csymbol><ci id="S4.T2.2.2.1.m1.1.1.2a.cmml" xref="S4.T2.2.2.1.m1.1.1.2"><mtext id="S4.T2.2.2.1.m1.1.1.2.cmml" xref="S4.T2.2.2.1.m1.1.1.2">Mu’s work</mtext></ci><apply id="S4.T2.2.2.1.m1.1.1.3.cmml" xref="S4.T2.2.2.1.m1.1.1.3"><times id="S4.T2.2.2.1.m1.1.1.3.1.cmml" xref="S4.T2.2.2.1.m1.1.1.3.1"></times><ci id="S4.T2.2.2.1.m1.1.1.3.2.cmml" xref="S4.T2.2.2.1.m1.1.1.3.2">𝑐</ci><ci id="S4.T2.2.2.1.m1.1.1.3.3.cmml" xref="S4.T2.2.2.1.m1.1.1.3.3">𝑟</ci><ci id="S4.T2.2.2.1.m1.1.1.3.4.cmml" xref="S4.T2.2.2.1.m1.1.1.3.4">𝑜</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.T2.2.2.1.m1.1c">\text{Mu's work}_{cro}</annotation><annotation encoding="application/x-llamapun" id="S4.T2.2.2.1.m1.1d">Mu’s work start_POSTSUBSCRIPT italic_c italic_r italic_o end_POSTSUBSCRIPT</annotation></semantics></math></th>
<td class="ltx_td ltx_align_center" id="S4.T2.2.2.2">1.020</td>
<td class="ltx_td ltx_align_center" id="S4.T2.2.2.3">0.992</td>
</tr>
<tr class="ltx_tr" id="S4.T2.3.3">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row" id="S4.T2.3.3.1"><math alttext="\text{Our work}_{sin}" class="ltx_Math" display="inline" id="S4.T2.3.3.1.m1.1"><semantics id="S4.T2.3.3.1.m1.1a"><msub id="S4.T2.3.3.1.m1.1.1" xref="S4.T2.3.3.1.m1.1.1.cmml"><mtext id="S4.T2.3.3.1.m1.1.1.2" xref="S4.T2.3.3.1.m1.1.1.2a.cmml">Our work</mtext><mrow id="S4.T2.3.3.1.m1.1.1.3" xref="S4.T2.3.3.1.m1.1.1.3.cmml"><mi id="S4.T2.3.3.1.m1.1.1.3.2" xref="S4.T2.3.3.1.m1.1.1.3.2.cmml">s</mi><mo id="S4.T2.3.3.1.m1.1.1.3.1" xref="S4.T2.3.3.1.m1.1.1.3.1.cmml">⁢</mo><mi id="S4.T2.3.3.1.m1.1.1.3.3" xref="S4.T2.3.3.1.m1.1.1.3.3.cmml">i</mi><mo id="S4.T2.3.3.1.m1.1.1.3.1a" xref="S4.T2.3.3.1.m1.1.1.3.1.cmml">⁢</mo><mi id="S4.T2.3.3.1.m1.1.1.3.4" xref="S4.T2.3.3.1.m1.1.1.3.4.cmml">n</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S4.T2.3.3.1.m1.1b"><apply id="S4.T2.3.3.1.m1.1.1.cmml" xref="S4.T2.3.3.1.m1.1.1"><csymbol cd="ambiguous" id="S4.T2.3.3.1.m1.1.1.1.cmml" xref="S4.T2.3.3.1.m1.1.1">subscript</csymbol><ci id="S4.T2.3.3.1.m1.1.1.2a.cmml" xref="S4.T2.3.3.1.m1.1.1.2"><mtext id="S4.T2.3.3.1.m1.1.1.2.cmml" xref="S4.T2.3.3.1.m1.1.1.2">Our work</mtext></ci><apply id="S4.T2.3.3.1.m1.1.1.3.cmml" xref="S4.T2.3.3.1.m1.1.1.3"><times id="S4.T2.3.3.1.m1.1.1.3.1.cmml" xref="S4.T2.3.3.1.m1.1.1.3.1"></times><ci id="S4.T2.3.3.1.m1.1.1.3.2.cmml" xref="S4.T2.3.3.1.m1.1.1.3.2">𝑠</ci><ci id="S4.T2.3.3.1.m1.1.1.3.3.cmml" xref="S4.T2.3.3.1.m1.1.1.3.3">𝑖</ci><ci id="S4.T2.3.3.1.m1.1.1.3.4.cmml" xref="S4.T2.3.3.1.m1.1.1.3.4">𝑛</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.T2.3.3.1.m1.1c">\text{Our work}_{sin}</annotation><annotation encoding="application/x-llamapun" id="S4.T2.3.3.1.m1.1d">Our work start_POSTSUBSCRIPT italic_s italic_i italic_n end_POSTSUBSCRIPT</annotation></semantics></math></th>
<td class="ltx_td ltx_align_center" id="S4.T2.3.3.2">1.065</td>
<td class="ltx_td ltx_align_center" id="S4.T2.3.3.3">0.987</td>
</tr>
<tr class="ltx_tr" id="S4.T2.4.4">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_bb" id="S4.T2.4.4.1"><math alttext="\text{Our work}_{cro}" class="ltx_Math" display="inline" id="S4.T2.4.4.1.m1.1"><semantics id="S4.T2.4.4.1.m1.1a"><msub id="S4.T2.4.4.1.m1.1.1" xref="S4.T2.4.4.1.m1.1.1.cmml"><mtext id="S4.T2.4.4.1.m1.1.1.2" xref="S4.T2.4.4.1.m1.1.1.2a.cmml">Our work</mtext><mrow id="S4.T2.4.4.1.m1.1.1.3" xref="S4.T2.4.4.1.m1.1.1.3.cmml"><mi id="S4.T2.4.4.1.m1.1.1.3.2" xref="S4.T2.4.4.1.m1.1.1.3.2.cmml">c</mi><mo id="S4.T2.4.4.1.m1.1.1.3.1" xref="S4.T2.4.4.1.m1.1.1.3.1.cmml">⁢</mo><mi id="S4.T2.4.4.1.m1.1.1.3.3" xref="S4.T2.4.4.1.m1.1.1.3.3.cmml">r</mi><mo id="S4.T2.4.4.1.m1.1.1.3.1a" xref="S4.T2.4.4.1.m1.1.1.3.1.cmml">⁢</mo><mi id="S4.T2.4.4.1.m1.1.1.3.4" xref="S4.T2.4.4.1.m1.1.1.3.4.cmml">o</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S4.T2.4.4.1.m1.1b"><apply id="S4.T2.4.4.1.m1.1.1.cmml" xref="S4.T2.4.4.1.m1.1.1"><csymbol cd="ambiguous" id="S4.T2.4.4.1.m1.1.1.1.cmml" xref="S4.T2.4.4.1.m1.1.1">subscript</csymbol><ci id="S4.T2.4.4.1.m1.1.1.2a.cmml" xref="S4.T2.4.4.1.m1.1.1.2"><mtext id="S4.T2.4.4.1.m1.1.1.2.cmml" xref="S4.T2.4.4.1.m1.1.1.2">Our work</mtext></ci><apply id="S4.T2.4.4.1.m1.1.1.3.cmml" xref="S4.T2.4.4.1.m1.1.1.3"><times id="S4.T2.4.4.1.m1.1.1.3.1.cmml" xref="S4.T2.4.4.1.m1.1.1.3.1"></times><ci id="S4.T2.4.4.1.m1.1.1.3.2.cmml" xref="S4.T2.4.4.1.m1.1.1.3.2">𝑐</ci><ci id="S4.T2.4.4.1.m1.1.1.3.3.cmml" xref="S4.T2.4.4.1.m1.1.1.3.3">𝑟</ci><ci id="S4.T2.4.4.1.m1.1.1.3.4.cmml" xref="S4.T2.4.4.1.m1.1.1.3.4">𝑜</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.T2.4.4.1.m1.1c">\text{Our work}_{cro}</annotation><annotation encoding="application/x-llamapun" id="S4.T2.4.4.1.m1.1d">Our work start_POSTSUBSCRIPT italic_c italic_r italic_o end_POSTSUBSCRIPT</annotation></semantics></math></th>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S4.T2.4.4.2"><span class="ltx_text ltx_font_bold" id="S4.T2.4.4.2.1">0.965</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S4.T2.4.4.3"><span class="ltx_text ltx_font_bold" id="S4.T2.4.4.3.1">0.902</span></td>
</tr>
</tbody>
</table>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table">Table 2: </span>Result of test A, where <sub class="ltx_sub" id="S4.T2.11.1"><span class="ltx_text ltx_font_italic" id="S4.T2.11.1.1">sin</span></sub> stand for single modal and <sub class="ltx_sub" id="S4.T2.12.2"><span class="ltx_text ltx_font_italic" id="S4.T2.12.2.1">cro</span></sub> stand for cross modal of multi-modal approaches. The test is based on MovieLens 100k dataset.</figcaption>
</figure>
<div class="ltx_para" id="S4.SS2.p5">
<p class="ltx_p" id="S4.SS2.p5.1">The following conclusions can be drawn from the results:</p>
</div>
<div class="ltx_para" id="S4.SS2.p6">
<ol class="ltx_enumerate" id="S4.I1">
<li class="ltx_item" id="S4.I1.i1" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">1.</span>
<div class="ltx_para" id="S4.I1.i1.p1">
<p class="ltx_p" id="S4.I1.i1.p1.1">Compared with the traditional models (item-CF, user-CF and SVD), the model proposed in this study has a large advantage in performance regardless of whether there is added image modality information or not.</p>
</div>
</li>
<li class="ltx_item" id="S4.I1.i2" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">2.</span>
<div class="ltx_para" id="S4.I1.i2.p1">
<p class="ltx_p" id="S4.I1.i2.p1.1">The advantages of the proposed model in feature extraction and feature fusion are verified compared to the method proposed by Mu et al.</p>
</div>
</li>
<li class="ltx_item" id="S4.I1.i3" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">3.</span>
<div class="ltx_para" id="S4.I1.i3.p1">
<p class="ltx_p" id="S4.I1.i3.p1.1">Inputting image information will improve the model performance to some extent compared to the model without image information.</p>
</div>
</li>
</ol>
</div>
</section>
<section class="ltx_subsection" id="S4.SS3">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.3 </span>Test B: explore the influence of size of dataset and learning rate</h3>
<div class="ltx_para" id="S4.SS3.p1">
<p class="ltx_p" id="S4.SS3.p1.1">In order to explore the performance in datasets of different sizes and the impact of different learning rates on model performance, we used the MovieLens 100k and MovieLens 1M datasets to train and evaluate the model proposed in this study under different learning rates. The learning rate is an important hyperparameter in deep learning, which can be pre-adjusted. A larger learning rate means the model will converge faster, but more unstable, and a smaller learning rate means slower convergence <cite class="ltx_cite ltx_citemacro_cite">[<a class="ltx_ref" href="https://arxiv.org/html/2407.09157v1#bib.bib65" title="">65</a>]</cite>. We set up the model’s optimizer with a learning rate of 0.001, 0.0005 and 0.0001. The result is shown on Table <a class="ltx_ref" href="https://arxiv.org/html/2407.09157v1#S4.T3" title="Table 3 ‣ 4.3 Test B: explore the influence of size of dataset and learning rate ‣ 4 Results ‣ Movie Recommendation with Poster Attention via Multi-modal Transformer Feature Fusion"><span class="ltx_text ltx_ref_tag">3</span></a>.</p>
</div>
<figure class="ltx_table" id="S4.T3">
<table class="ltx_tabular ltx_centering ltx_guessed_headers ltx_align_middle" id="S4.T3.1">
<tbody class="ltx_tbody">
<tr class="ltx_tr" id="S4.T3.1.1.1">
<td class="ltx_td ltx_border_tt" id="S4.T3.1.1.1.1"></td>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" colspan="3" id="S4.T3.1.1.1.2"><span class="ltx_text ltx_font_bold" id="S4.T3.1.1.1.2.1">MovieLens 100 K</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" colspan="3" id="S4.T3.1.1.1.3"><span class="ltx_text ltx_font_bold" id="S4.T3.1.1.1.3.1">MovieLens 1 M</span></th>
</tr>
<tr class="ltx_tr" id="S4.T3.1.2.2">
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T3.1.2.2.1"><span class="ltx_text ltx_font_bold" id="S4.T3.1.2.2.1.1">Learning rate</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T3.1.2.2.2">0.001</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T3.1.2.2.3">0.0005</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T3.1.2.2.4">0.0001</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T3.1.2.2.5">0.001</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T3.1.2.2.6">0.0005</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T3.1.2.2.7">0.0001</td>
</tr>
<tr class="ltx_tr" id="S4.T3.1.3.3">
<td class="ltx_td ltx_align_center" id="S4.T3.1.3.3.1"><span class="ltx_text ltx_font_bold" id="S4.T3.1.3.3.1.1">RMSE of Train set</span></td>
<td class="ltx_td ltx_align_center" id="S4.T3.1.3.3.2">0.994</td>
<td class="ltx_td ltx_align_center" id="S4.T3.1.3.3.3"><span class="ltx_text ltx_font_bold" id="S4.T3.1.3.3.3.1">0.965</span></td>
<td class="ltx_td ltx_align_center" id="S4.T3.1.3.3.4">1.009</td>
<td class="ltx_td ltx_align_center" id="S4.T3.1.3.3.5">1.039</td>
<td class="ltx_td ltx_align_center" id="S4.T3.1.3.3.6">1.004</td>
<td class="ltx_td ltx_align_center" id="S4.T3.1.3.3.7">1.075</td>
</tr>
<tr class="ltx_tr" id="S4.T3.1.4.4">
<td class="ltx_td ltx_align_center ltx_border_bb" id="S4.T3.1.4.4.1"><span class="ltx_text ltx_font_bold" id="S4.T3.1.4.4.1.1">RMSE of Test set</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S4.T3.1.4.4.2">0.991</td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S4.T3.1.4.4.3">0.902</td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S4.T3.1.4.4.4">1.058</td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S4.T3.1.4.4.5">0.996</td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S4.T3.1.4.4.6"><span class="ltx_text ltx_font_bold" id="S4.T3.1.4.4.6.1">0.893</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S4.T3.1.4.4.7">0.994</td>
</tr>
</tbody>
</table>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table">Table 3: </span>RMSE scores of the multimodal movie recommendation algorithm based on deep learning.</figcaption>
</figure>
<div class="ltx_para" id="S4.SS3.p2">
<p class="ltx_p" id="S4.SS3.p2.1">At a learning rate of 0.0005, our proposed model performs 0.902 and 0.893 on the two datasets respectively, which are both slightly ahead of 0.0001 and 0.001. In addition, the model trained on a small dataset performs better on the training set, and the model trained on a large dataset performs better on the test set, which means that the generalization ability of the model will improve as the amount of data increases.</p>
</div>
</section>
</section>
<section class="ltx_section" id="S5">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">5 </span>Discussion and Conclusions</h2>
<div class="ltx_para" id="S5.p1">
<p class="ltx_p" id="S5.p1.1">In this research, we propose and evaluate a multi-modal information-based recommendation system. The proposed model extracts text modal information with BERT model and extracts image modal information with ViT model. It apply transformer architecture to fuse extracted feature and predicts users’ rating. The main goal of this research is to verify the effectiveness of the recommendation system based on cross-modal information.</p>
</div>
<div class="ltx_para" id="S5.p2">
<p class="ltx_p" id="S5.p2.1">Experiments on the MovieLens 100k and 1M datasets show that our system outperforms traditional and deep learning baseline models. On MovieLens 100k, our system achieved an RMSE of 0.902, compared to 0.987 for a unimodal approach, indicating that multimodal data enhances prediction accuracy. Testing different learning rates (0.001, 0.0005, and 0.0001) revealed that 0.0005 yielded the best performance in both datasets. Additionally, as data volume increased, the system’s generalization improved, achieving an RMSE of 0.893 on MovieLens 1M, demonstrating that more data enhances performance.</p>
</div>
<div class="ltx_para" id="S5.p3">
<p class="ltx_p" id="S5.p3.1">Despite the positive results of this study, there are still some limitations. Firstly, the large number of parameters in the pre-trained model and the high computational overhead in the tuning process may affect the economics of time-based recommendation in future applications, and secondly, the inclusion of multimodal data, especially image data, brings about noise enhancement. In future work, the focus should be on model simplification based on knowledge distillation and exploring techniques to deal with noise.</p>
</div>
</section>
<section class="ltx_section" id="Sx1">
<h2 class="ltx_title ltx_title_section">Declarations</h2>
<div class="ltx_para" id="Sx1.p1">
<ul class="ltx_itemize" id="Sx1.I1">
<li class="ltx_item" id="Sx1.I1.i1" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="Sx1.I1.i1.p1">
<p class="ltx_p" id="Sx1.I1.i1.p1.1">Funding: This work was funded by the Natural Science Foundation of China (12271047); Guangdong Provincial Key Laboratory of Interdisciplinary Research and Application for Data Science, BNU-HKBU United International College (2022B1212010006); UIC research grant (R0400001-22; UICR0400008-21; UICR0400036-21CTL; UICR04202405-21); Guangdong College Enhancement and Innovation Program (2021ZDZX1046).</p>
</div>
</li>
<li class="ltx_item" id="Sx1.I1.i2" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="Sx1.I1.i2.p1">
<p class="ltx_p" id="Sx1.I1.i2.p1.1">Conflict of interest: We declare that we have no financial and personal relationships with other
people or organizations that can inappropriately influence our work, and there is no professional or
other personal interests of any nature or kind in any product, service, and/or company that could be
construed as influencing the position presented in, or the review of, the manuscript entitled.</p>
</div>
</li>
<li class="ltx_item" id="Sx1.I1.i3" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="Sx1.I1.i3.p1">
<p class="ltx_p" id="Sx1.I1.i3.p1.1">Data availability: The experiment data is available in MovieLens official website (<a class="ltx_ref ltx_url ltx_font_typewriter" href="https://movielens.org/" title="">https://movielens.org/</a>) and IMDB official website (<a class="ltx_ref ltx_url ltx_font_typewriter" href="https://www.imdb.com/" title="">https://www.imdb.com/</a>), the data used in the experiment also can be downloaded through <a class="ltx_ref ltx_url ltx_font_typewriter" href="https://github.com/Xia12121/MovieLens-dataset-with-poster" title="">https://github.com/Xia12121/MovieLens-dataset-with-poster</a>.</p>
</div>
</li>
<li class="ltx_item" id="Sx1.I1.i4" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="Sx1.I1.i4.p1">
<p class="ltx_p" id="Sx1.I1.i4.p1.1">Author contribution: Conceptualization and methodology,L.X., software,L.X. and Y.Y., validation, Z.C. and Z.Y., writing–original draft, L.X., writing–review &amp; editing, S.Z., Z.C. and Z.Y., supervision, S.Z.</p>
</div>
</li>
</ul>
</div>
</section>
<section class="ltx_bibliography" id="bib">
<h2 class="ltx_title ltx_title_bibliography">References</h2>
<ul class="ltx_biblist">
<li class="ltx_bibitem" id="bib.1.1">
<span class="ltx_bibblock"><span class="ltx_ERROR undefined" id="bib.1.1.1.1">\bibcommenthead</span>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib1">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Eppler and Mengis [2004]</span>
<span class="ltx_bibblock">
Eppler, M.J.,
Mengis, J.:
The concept of information overload: A review of literature from organization science, accounting, marketing, mis, and related disciplines.
The Information Society
<span class="ltx_text ltx_font_bold" id="bib.bib1.1.1">20</span>(5),
325–344
(2004)


</span>
</li>
<li class="ltx_bibitem" id="bib.bib2">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Roetzel [2019]</span>
<span class="ltx_bibblock">
Roetzel, P.G.:
Information overload in the information age: a review of the literature from business administration, business psychology, and related disciplines with a bibliometric approach and framework development.
Business Research
<span class="ltx_text ltx_font_bold" id="bib.bib2.1.1">12</span>(2),
479–522
(2019)


</span>
</li>
<li class="ltx_bibitem" id="bib.bib3">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Mu and Wu [2023]</span>
<span class="ltx_bibblock">
Mu, Y.,
Wu, Y.:
Multi-modal movie recommendation system using deep learning.
Mathematics
<span class="ltx_text ltx_font_bold" id="bib.bib3.1.1">11</span>(4),
895
(2023)


</span>
</li>
<li class="ltx_bibitem" id="bib.bib4">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Burke et al. [2011]</span>
<span class="ltx_bibblock">
Burke, R.,
Felfernig, A.,
Göker, M.H.:
Recommender systems: An overview.
AI Magazine
<span class="ltx_text ltx_font_bold" id="bib.bib4.1.1">32</span>(3),
13–18
(2011)


</span>
</li>
<li class="ltx_bibitem" id="bib.bib5">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Daneshvar and Ravanmehr [2022]</span>
<span class="ltx_bibblock">
Daneshvar, H.,
Ravanmehr, R.:
A social hybrid recommendation system using lstm and cnn.
Concurrency and Computation: Practice and Experience
<span class="ltx_text ltx_font_bold" id="bib.bib5.1.1">34</span>(18),
7015
(2022)


</span>
</li>
<li class="ltx_bibitem" id="bib.bib6">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Amatriain and Basilico [2015]</span>
<span class="ltx_bibblock">
Amatriain, X.,
Basilico, J.:
Recommender systems in industry: A netflix case study.
In: Recommender Systems Handbook,
pp. 385–419.
Springer, ???
(2015)


</span>
</li>
<li class="ltx_bibitem" id="bib.bib7">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Li et al. [2023]</span>
<span class="ltx_bibblock">
Li, X.,
Sun, L.,
Ling, M.,
Peng, Y.:
A survey of graph neural network based recommendation in social networks.
Neurocomputing
<span class="ltx_text ltx_font_bold" id="bib.bib7.1.1">549</span>,
126441
(2023)


</span>
</li>
<li class="ltx_bibitem" id="bib.bib8">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Zheng et al. [2024]</span>
<span class="ltx_bibblock">
Zheng, Y.,
Lin, X.,
Chen, K.,
Zhu, S.:
Cycletrans: a transformer-based clinical foundation model for safer prescription.
In: AAAI 2024 Spring Symposium on Clinical Foundation Models
(2024)


</span>
</li>
<li class="ltx_bibitem" id="bib.bib9">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Chen et al. [2020]</span>
<span class="ltx_bibblock">
Chen, Z.,
Zhu, S.,
Niu, Q.,
Zuo, T.:
Knowledge discovery and recommendation with linear mixed model.
IEEE Access
<span class="ltx_text ltx_font_bold" id="bib.bib9.1.1">8</span>,
38304–38317
(2020)


</span>
</li>
<li class="ltx_bibitem" id="bib.bib10">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Lops et al. [2019]</span>
<span class="ltx_bibblock">
Lops, P., <span class="ltx_text ltx_font_italic" id="bib.bib10.1.1">et al.</span>:
Trends in content-based recommendation: Preface to the special issue on recommender systems based on rich item descriptions.
User Modeling and User-Adapted Interaction
<span class="ltx_text ltx_font_bold" id="bib.bib10.2.2">29</span>,
239–249
(2019)


</span>
</li>
<li class="ltx_bibitem" id="bib.bib11">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Chen et al. [2018]</span>
<span class="ltx_bibblock">
Chen, R., <span class="ltx_text ltx_font_italic" id="bib.bib11.1.1">et al.</span>:
A survey of collaborative filtering-based recommender systems: From traditional methods to hybrid methods based on social networks.
IEEE Access
<span class="ltx_text ltx_font_bold" id="bib.bib11.2.2">6</span>,
64301–64320
(2018)


</span>
</li>
<li class="ltx_bibitem" id="bib.bib12">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Çano and Morisio [2017]</span>
<span class="ltx_bibblock">
Çano, E.,
Morisio, M.:
Hybrid recommender systems: A systematic literature review.
Intelligent Data Analysis
<span class="ltx_text ltx_font_bold" id="bib.bib12.1.1">21</span>(6),
1487–1524
(2017)


</span>
</li>
<li class="ltx_bibitem" id="bib.bib13">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Roy and Dutta [2022]</span>
<span class="ltx_bibblock">
Roy, D.,
Dutta, M.:
A systematic review and research perspective on recommender systems.
Journal of Big Data
<span class="ltx_text ltx_font_bold" id="bib.bib13.1.1">9</span>(1),
59
(2022)


</span>
</li>
<li class="ltx_bibitem" id="bib.bib14">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Lu et al. [2019]</span>
<span class="ltx_bibblock">
Lu, X.,
Zhu, S.,
Niu, Q.,
Chen, Z.:
Profile inference from heterogeneous data: Fundamentals and new trends.
In: International Conference on Business Information Systems,
pp. 122–136
(2019).
Springer


</span>
</li>
<li class="ltx_bibitem" id="bib.bib15">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Dahdouh et al. [2019]</span>
<span class="ltx_bibblock">
Dahdouh, K.,
Dakkak, A.,
Oughdir, L.,
Ibriz, A.:
Large-scale e-learning recommender system based on spark and hadoop.
Journal of Big Data
<span class="ltx_text ltx_font_bold" id="bib.bib15.1.1">6</span>(1),
1–23
(2019)


</span>
</li>
<li class="ltx_bibitem" id="bib.bib16">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Achakulvisut et al. [2016]</span>
<span class="ltx_bibblock">
Achakulvisut, T., <span class="ltx_text ltx_font_italic" id="bib.bib16.1.1">et al.</span>:
Science concierge: A fast content-based recommendation system for scientific publications.
PloS One
<span class="ltx_text ltx_font_bold" id="bib.bib16.2.2">11</span>(7),
0158423
(2016)


</span>
</li>
<li class="ltx_bibitem" id="bib.bib17">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Bergamaschi and Po [2015]</span>
<span class="ltx_bibblock">
Bergamaschi, S.,
Po, L.:
Comparing lda and lsa topic models for content-based movie recommendation systems.
In: Web Information Systems and Technologies: 10th International Conference, WEBIST 2014, Barcelona, Spain, April 3-5, 2014, Revised Selected Papers
vol. 10,
(2015)


</span>
</li>
<li class="ltx_bibitem" id="bib.bib18">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Bouihi and Bahaj [2019]</span>
<span class="ltx_bibblock">
Bouihi, B.,
Bahaj, M.:
Ontology and rule-based recommender system for e-learning applications.
International Journal of Emerging Technologies in Learning (Online)
<span class="ltx_text ltx_font_bold" id="bib.bib18.1.1">14</span>(15),
4
(2019)


</span>
</li>
<li class="ltx_bibitem" id="bib.bib19">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Zhang and Iyengar [2002]</span>
<span class="ltx_bibblock">
Zhang, T.,
Iyengar, V.S.:
Recommender systems using linear classifiers.
The Journal of Machine Learning Research
<span class="ltx_text ltx_font_bold" id="bib.bib19.1.1">2</span>,
313–334
(2002)


</span>
</li>
<li class="ltx_bibitem" id="bib.bib20">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Gao et al. [2019]</span>
<span class="ltx_bibblock">
Gao, B.,
Zhan, G.,
Wang, H.,
Wang, Y.,
Zhu, S.:
Learning with linear mixed model for group recommendation systems.
In: Proceedings of the 2019 11th International Conference on Machine Learning and Computing,
pp. 81–85
(2019)


</span>
</li>
<li class="ltx_bibitem" id="bib.bib21">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Zuo et al. [2020]</span>
<span class="ltx_bibblock">
Zuo, T.,
Zhu, S.,
Lu, J.:
A hybrid recommender system combing singular value decomposition and linear mixed model.
In: Intelligent Computing. SAI 2020.
vol. 1228,
pp. 347–362.
Springer, ???
(2020)


</span>
</li>
<li class="ltx_bibitem" id="bib.bib22">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Shafqat and Byun [2020]</span>
<span class="ltx_bibblock">
Shafqat, W.,
Byun, Y.-C.:
A context-aware location recommendation system for tourists using hierarchical lstm model.
Sustainability
<span class="ltx_text ltx_font_bold" id="bib.bib22.1.1">12</span>(10),
4107
(2020)


</span>
</li>
<li class="ltx_bibitem" id="bib.bib23">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Hassan and Hamada [2019]</span>
<span class="ltx_bibblock">
Hassan, M.,
Hamada, M.:
Evaluating the performance of a neural network-based multi-criteria recommender system.
International Journal of Spatio-Temporal Data Science
<span class="ltx_text ltx_font_bold" id="bib.bib23.1.1">1</span>(1),
54–69
(2019)


</span>
</li>
<li class="ltx_bibitem" id="bib.bib24">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Liu and Singh [2016]</span>
<span class="ltx_bibblock">
Liu, D.Z.,
Singh, G.:
A recurrent neural network based recommendation system.
In: International Conference on Recent Trends in Engineering, Science &amp; Technology
(2016)


</span>
</li>
<li class="ltx_bibitem" id="bib.bib25">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Huang et al. [2021]</span>
<span class="ltx_bibblock">
Huang, L., et al.:
A deep reinforcement learning based long-term recommender system.
Knowledge-Based Systems
<span class="ltx_text ltx_font_bold" id="bib.bib25.1.1">213</span>
(2021)


</span>
</li>
<li class="ltx_bibitem" id="bib.bib26">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Lee et al. [2020]</span>
<span class="ltx_bibblock">
Lee, H.I., <span class="ltx_text ltx_font_italic" id="bib.bib26.1.1">et al.</span>:
A multi-period product recommender system in online food market based on recurrent neural networks.
Sustainability
<span class="ltx_text ltx_font_bold" id="bib.bib26.2.2">12</span>(3),
969
(2020)


</span>
</li>
<li class="ltx_bibitem" id="bib.bib27">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Xu et al. [2021]</span>
<span class="ltx_bibblock">
Xu, B.,
Bu, S.,
Li, X.,
Lin, Y.,
Zhu, S.:
xdeepfig: An extreme deep model with feature interactions and generation for ctr prediction.
In: Proceedings of the 2021 3rd International Conference on Big-data Service and Intelligent Computation,
pp. 42–51
(2021)


</span>
</li>
<li class="ltx_bibitem" id="bib.bib28">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Feng et al. [2022]</span>
<span class="ltx_bibblock">
Feng, Y.,
Zhu, S.,
Ou, Y.:
Accelerating din model for online ctr prediction with data compression.
In: 2022 7th International Conference on Big Data Analytics (ICBDA),
pp. 84–89
(2022).
IEEE


</span>
</li>
<li class="ltx_bibitem" id="bib.bib29">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Luo et al. [2023]</span>
<span class="ltx_bibblock">
Luo, Z.,
Zhang, Y.,
Hu, C.,
Xia, Y.,
Zhu, S.:
Click-through rate prediction models based on interest modeling.
In: Proceedings of the 2023 5th International Conference on Big Data Engineering,
pp. 18–27
(2023)


</span>
</li>
<li class="ltx_bibitem" id="bib.bib30">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Siet et al. [2024]</span>
<span class="ltx_bibblock">
Siet, S.,
Peng, S.,
Ilkhomjon, S.,
Kang, M.,
Park, D.-S.:
Enhancing sequence movie recommendation system using deep learning and kmeans.
Applied Sciences
<span class="ltx_text ltx_font_bold" id="bib.bib30.1.1">14</span>(6)
(2024)


</span>
</li>
<li class="ltx_bibitem" id="bib.bib31">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Aljunid and Dh [2020]</span>
<span class="ltx_bibblock">
Aljunid, M.F.,
Dh, M.:
An efficient deep learning approach for collaborative filtering recommender system.
Procedia Computer Science
<span class="ltx_text ltx_font_bold" id="bib.bib31.1.1">171</span>,
829–836
(2020)


</span>
</li>
<li class="ltx_bibitem" id="bib.bib32">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Ma et al. [2015]</span>
<span class="ltx_bibblock">
Ma, T., <span class="ltx_text ltx_font_italic" id="bib.bib32.1.1">et al.</span>:
Social network and tag sources based augmenting collaborative recommender system.
IEICE transactions on Information and Systems
<span class="ltx_text ltx_font_bold" id="bib.bib32.2.2">98</span>(4),
902–910
(2015)


</span>
</li>
<li class="ltx_bibitem" id="bib.bib33">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Millan et al. [2007]</span>
<span class="ltx_bibblock">
Millan, M.,
Trujillo, M.,
Ortiz, E.:
A collaborative recommender system based on asymmetric user similarity.
In: Intelligent Data Engineering and Automated Learning-IDEAL 2007: 8th International Conference, Birmingham, UK, December 16-19, 2007. Proceedings
vol. 8,
(2007)


</span>
</li>
<li class="ltx_bibitem" id="bib.bib34">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">O’connor et al. [2001]</span>
<span class="ltx_bibblock">
O’connor, M.,
Cosley, D.,
Konstan, J.A.,
Riedl, J.:
Polylens: A recommender system for groups of users.
In: ECSCW 2001: Proceedings of the Seventh European Conference on Computer Supported Cooperative Work 16–20 September 2001, Bonn, Germany,
pp. 199–218
(2001).
Springer


</span>
</li>
<li class="ltx_bibitem" id="bib.bib35">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[35]</span>
<span class="ltx_bibblock">
Zhang, C.,
Yu, L.,
Wang, Y.,
Shah, C.,
Zhang, X.:
Collaborative User Network Embedding for Social Recommender Systems,
pp. 381–389.
<a class="ltx_ref ltx_url ltx_font_typewriter" href="https://doi.org/10.1137/1.9781611974973.43" title="">https://doi.org/10.1137/1.9781611974973.43</a> .
<a class="ltx_ref ltx_url ltx_font_typewriter" href="https://epubs.siam.org/doi/abs/10.1137/1.9781611974973.43" title="">https://epubs.siam.org/doi/abs/10.1137/1.9781611974973.43</a>
</span>
</li>
<li class="ltx_bibitem" id="bib.bib36">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Fakhri et al. [2019]</span>
<span class="ltx_bibblock">
Fakhri, A.A.,
Baizal, Z.K.A.,
Setiawan, E.B.:
Restaurant recommender system using user-based collaborative filtering approach: a case study at bandung raya region.
Journal of Physics: Conference Series
<span class="ltx_text ltx_font_bold" id="bib.bib36.1.1">1192</span>(1)
(2019)


</span>
</li>
<li class="ltx_bibitem" id="bib.bib37">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Fu et al. [2018]</span>
<span class="ltx_bibblock">
Fu, M., <span class="ltx_text ltx_font_italic" id="bib.bib37.1.1">et al.</span>:
A novel deep learning-based collaborative filtering model for recommendation system.
IEEE Transactions on Cybernetics
<span class="ltx_text ltx_font_bold" id="bib.bib37.2.2">49</span>(3),
1084–1096
(2018)


</span>
</li>
<li class="ltx_bibitem" id="bib.bib38">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Bobadilla et al. [2020]</span>
<span class="ltx_bibblock">
Bobadilla, J.,
Alonso, S.,
Hernando, A.:
Deep learning architecture for collaborative filtering recommender systems.
Applied Sciences
<span class="ltx_text ltx_font_bold" id="bib.bib38.1.1">10</span>(7),
2441
(2020)


</span>
</li>
<li class="ltx_bibitem" id="bib.bib39">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Wang et al. [2015]</span>
<span class="ltx_bibblock">
Wang, H.,
Wang, N.,
Yeung, D.-Y.:
Collaborative deep learning for recommender systems.
In: Proceedings of the 21th ACM SIGKDD International Conference on Knowledge Discovery and Data Mining
(2015)


</span>
</li>
<li class="ltx_bibitem" id="bib.bib40">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Aljunid and Dh [2020]</span>
<span class="ltx_bibblock">
Aljunid, M.F.,
Dh, M.:
An efficient deep learning approach for collaborative filtering recommender system.
Procedia Computer Science
<span class="ltx_text ltx_font_bold" id="bib.bib40.1.1">171</span>,
829–836
(2020)


</span>
</li>
<li class="ltx_bibitem" id="bib.bib41">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Wu et al. [2022]</span>
<span class="ltx_bibblock">
Wu, S., <span class="ltx_text ltx_font_italic" id="bib.bib41.1.1">et al.</span>:
Graph neural networks in recommender systems: a survey.
ACM Computing Surveys
<span class="ltx_text ltx_font_bold" id="bib.bib41.2.2">55</span>(5),
1–37
(2022)


</span>
</li>
<li class="ltx_bibitem" id="bib.bib42">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Wang et al. [2023]</span>
<span class="ltx_bibblock">
Wang, W., et al.:
User-context collaboration and tensor factorization for gnn-based social recommendation.
IEEE Transactions on Network Science and Engineering
(2023)


</span>
</li>
<li class="ltx_bibitem" id="bib.bib43">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Kreutz and Schenkel [2022]</span>
<span class="ltx_bibblock">
Kreutz, C.,
Schenkel, R.:
Scientific paper recommendation systems: A literature review of recent publications.
International Journal of Digital Libraries
<span class="ltx_text ltx_font_bold" id="bib.bib43.1.1">23</span>(4),
335–369
(2022)


</span>
</li>
<li class="ltx_bibitem" id="bib.bib44">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Pradhan and Pal [2020]</span>
<span class="ltx_bibblock">
Pradhan, T.,
Pal, S.:
A hybrid personalized scholarly venue recommender system integrating social network analysis and contextual similarity.
Future Generation Computer Systems
<span class="ltx_text ltx_font_bold" id="bib.bib44.1.1">110</span>,
1139–1166
(2020)


</span>
</li>
<li class="ltx_bibitem" id="bib.bib45">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Lorbeer et al. [2018]</span>
<span class="ltx_bibblock">
Lorbeer, B., <span class="ltx_text ltx_font_italic" id="bib.bib45.1.1">et al.</span>:
A novel hybrid paper recommendation system using deep learning.
Big Data Research
<span class="ltx_text ltx_font_bold" id="bib.bib45.2.2">11</span>,
44–53
(2018)


</span>
</li>
<li class="ltx_bibitem" id="bib.bib46">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Qaiser and Ali [2018]</span>
<span class="ltx_bibblock">
Qaiser, S.,
Ali, R.:
A scalable hybrid research paper recommender system for microsoft academic.
arXiv preprint arXiv:1905.08880
(2018)


</span>
</li>
<li class="ltx_bibitem" id="bib.bib47">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Biswas and Liu [2021]</span>
<span class="ltx_bibblock">
Biswas, P.K.,
Liu, S.:
A hybrid recommender system for recommending smartphones to prospective customers.
Papers With Code
(2021)


</span>
</li>
<li class="ltx_bibitem" id="bib.bib48">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Saga and Duan [2018]</span>
<span class="ltx_bibblock">
Saga, R.,
Duan, Y.:
Apparel goods recommender system based on image shape features extracted by a cnn.
In: 2018 IEEE International Conference on Systems, Man, and Cybernetics (SMC)
(2018)


</span>
</li>
<li class="ltx_bibitem" id="bib.bib49">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Choudhury et al. [2021]</span>
<span class="ltx_bibblock">
Choudhury, S.S.,
Mohanty, S.N.,
Jagadev, A.K.:
Multi-modal trust based recommender system with machine learning approaches for movie recommendation.
International Journal of Information Technology
<span class="ltx_text ltx_font_bold" id="bib.bib49.1.1">13</span>,
475–482
(2021)


</span>
</li>
<li class="ltx_bibitem" id="bib.bib50">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Nikzad-Khasmakhi et al. [2021]</span>
<span class="ltx_bibblock">
Nikzad-Khasmakhi, N., et al.:
Berters: multi-modal representation learning for expert recommendation system with transformers and graph embeddings.
Chaos, Solitons &amp; Fractals
<span class="ltx_text ltx_font_bold" id="bib.bib50.1.1">151</span>
(2021)


</span>
</li>
<li class="ltx_bibitem" id="bib.bib51">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Chung and Chen [2021]</span>
<span class="ltx_bibblock">
Chung, Y.-H.,
Chen, Y.-L.:
Social recommendation system with multi-modal collaborative filtering.
In: 2021 IEEE Global Communications Conference (GLOBECOM)
(2021)


</span>
</li>
<li class="ltx_bibitem" id="bib.bib52">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Sun et al. [2020]</span>
<span class="ltx_bibblock">
Sun, R., <span class="ltx_text ltx_font_italic" id="bib.bib52.1.1">et al.</span>:
Multi-modal knowledge graphs for recommender systems.
In: Proceedings of the 29th ACM International Conference on Information &amp; Knowledge Management
(2020)


</span>
</li>
<li class="ltx_bibitem" id="bib.bib53">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Atrey et al. [2010]</span>
<span class="ltx_bibblock">
Atrey, P.K., <span class="ltx_text ltx_font_italic" id="bib.bib53.1.1">et al.</span>:
Multi-modal fusion for multimedia analysis: a survey.
Multimedia systems
<span class="ltx_text ltx_font_bold" id="bib.bib53.2.2">16</span>,
345–379
(2010)


</span>
</li>
<li class="ltx_bibitem" id="bib.bib54">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Foresti and Snidaro [2002]</span>
<span class="ltx_bibblock">
Foresti, G.L.,
Snidaro, L.:
A distributed sensor network for video surveillance of outdoor environments.
In: Proceedings. International Conference on Image Processing,
vol. 1
(2002)


</span>
</li>
<li class="ltx_bibitem" id="bib.bib55">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Yang et al. [2005]</span>
<span class="ltx_bibblock">
Yang, M.-T.,
Wang, S.-C.,
Lin, Y.-Y.:
A multi-modal fusion system for people detection and tracking.
International journal of imaging systems and technology
<span class="ltx_text ltx_font_bold" id="bib.bib55.1.1">15</span>(2),
131–142
(2005)


</span>
</li>
<li class="ltx_bibitem" id="bib.bib56">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Zhu et al. [2020]</span>
<span class="ltx_bibblock">
Zhu, H., <span class="ltx_text ltx_font_italic" id="bib.bib56.1.1">et al.</span>:
Multi-modal fusion method based on self-attention mechanism.
Wireless Communications and Mobile Computing
<span class="ltx_text ltx_font_bold" id="bib.bib56.2.2">2020</span>,
1–8
(2020)


</span>
</li>
<li class="ltx_bibitem" id="bib.bib57">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Wei et al. [2020]</span>
<span class="ltx_bibblock">
Wei, X., <span class="ltx_text ltx_font_italic" id="bib.bib57.1.1">et al.</span>:
Multi-modality cross attention network for image and sentence matching.
In: Proceedings of the IEEE/CVF Conference on Computer Vision and Pattern Recognition
(2020)


</span>
</li>
<li class="ltx_bibitem" id="bib.bib58">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Wang et al. [2022]</span>
<span class="ltx_bibblock">
Wang, Y., <span class="ltx_text ltx_font_italic" id="bib.bib58.1.1">et al.</span>:
Multi-modal token fusion for vision transformers.
In: Proceedings of the IEEE/CVF Conference on Computer Vision and Pattern Recognition
(2022)


</span>
</li>
<li class="ltx_bibitem" id="bib.bib59">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Devlin et al. [2019]</span>
<span class="ltx_bibblock">
Devlin, J.,
Chang, M.-W.,
Lee, K.,
Toutanova, K.:
Bert: Pre-training of deep bidirectional transformers for language understanding.
In: Proceedings of the 2019 Conference of the North American Chapter of the Association for Computational Linguistics: Human Language Technologies, Volume 1 (Long and Short Papers),
pp. 4171–4186
(2019)


</span>
</li>
<li class="ltx_bibitem" id="bib.bib60">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Floridi and Chiriatti [2020]</span>
<span class="ltx_bibblock">
Floridi, L.,
Chiriatti, M.:
Gpt-3: Its nature, scope, limits, and consequences.
Minds and Machines
<span class="ltx_text ltx_font_bold" id="bib.bib60.1.1">30</span>,
681–694
(2020)


</span>
</li>
<li class="ltx_bibitem" id="bib.bib61">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Liu et al. [2021]</span>
<span class="ltx_bibblock">
Liu, Z.,
Lin, W.,
Shi, Y.,
Zhao, J.:
A robustly optimized bert pre-training approach with post-training.
In: China National Conference on Chinese Computational Linguistics,
pp. 471–484
(2021).
Springer


</span>
</li>
<li class="ltx_bibitem" id="bib.bib62">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Simonyan and Zisserman [2014]</span>
<span class="ltx_bibblock">
Simonyan, K.,
Zisserman, A.:
Very deep convolutional networks for large-scale image recognition.
arXiv preprint arXiv:1409.1556
(2014)


</span>
</li>
<li class="ltx_bibitem" id="bib.bib63">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">He et al. [2016]</span>
<span class="ltx_bibblock">
He, K., <span class="ltx_text ltx_font_italic" id="bib.bib63.1.1">et al.</span>:
Deep residual learning for image recognition.
In: Proceedings of the IEEE Conference on Computer Vision and Pattern Recognition
(2016)


</span>
</li>
<li class="ltx_bibitem" id="bib.bib64">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Han et al. [2022]</span>
<span class="ltx_bibblock">
Han, K., <span class="ltx_text ltx_font_italic" id="bib.bib64.1.1">et al.</span>:
A survey on vision transformer.
IEEE transactions on pattern analysis and machine intelligence
<span class="ltx_text ltx_font_bold" id="bib.bib64.2.2">45</span>(1),
87–110
(2022)


</span>
</li>
<li class="ltx_bibitem" id="bib.bib65">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Kane [2018]</span>
<span class="ltx_bibblock">
Kane, F.:
Building Recommender Systems with Machine Learning and AI: Help People Discover New Products and Content with Deep Learning, Neural Networks, and Machine Learning Recommendations.
Independently published, ???
(2018)


</span>
</li>
</ul>
</section>
</article>
</div>
<footer class="ltx_page_footer">
<div class="ltx_page_logo">Generated  on Fri Jul 12 10:42:24 2024 by <a class="ltx_LaTeXML_logo" href="http://dlmf.nist.gov/LaTeXML/"><span style="letter-spacing:-0.2em; margin-right:0.1em;">L<span class="ltx_font_smallcaps" style="position:relative; bottom:2.2pt;">a</span>T<span class="ltx_font_smallcaps" style="font-size:120%;position:relative; bottom:-0.2ex;">e</span></span><span style="font-size:90%; position:relative; bottom:-0.2ex;">XML</span><img alt="Mascot Sammy" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAsAAAAOCAYAAAD5YeaVAAAAAXNSR0IArs4c6QAAAAZiS0dEAP8A/wD/oL2nkwAAAAlwSFlzAAALEwAACxMBAJqcGAAAAAd0SU1FB9wKExQZLWTEaOUAAAAddEVYdENvbW1lbnQAQ3JlYXRlZCB3aXRoIFRoZSBHSU1Q72QlbgAAAdpJREFUKM9tkL+L2nAARz9fPZNCKFapUn8kyI0e4iRHSR1Kb8ng0lJw6FYHFwv2LwhOpcWxTjeUunYqOmqd6hEoRDhtDWdA8ApRYsSUCDHNt5ul13vz4w0vWCgUnnEc975arX6ORqN3VqtVZbfbTQC4uEHANM3jSqXymFI6yWazP2KxWAXAL9zCUa1Wy2tXVxheKA9YNoR8Pt+aTqe4FVVVvz05O6MBhqUIBGk8Hn8HAOVy+T+XLJfLS4ZhTiRJgqIoVBRFIoric47jPnmeB1mW/9rr9ZpSSn3Lsmir1fJZlqWlUonKsvwWwD8ymc/nXwVBeLjf7xEKhdBut9Hr9WgmkyGEkJwsy5eHG5vN5g0AKIoCAEgkEkin0wQAfN9/cXPdheu6P33fBwB4ngcAcByHJpPJl+fn54mD3Gg0NrquXxeLRQAAwzAYj8cwTZPwPH9/sVg8PXweDAauqqr2cDjEer1GJBLBZDJBs9mE4zjwfZ85lAGg2+06hmGgXq+j3+/DsixYlgVN03a9Xu8jgCNCyIegIAgx13Vfd7vdu+FweG8YRkjXdWy329+dTgeSJD3ieZ7RNO0VAXAPwDEAO5VKndi2fWrb9jWl9Esul6PZbDY9Go1OZ7PZ9z/lyuD3OozU2wAAAABJRU5ErkJggg=="/></a>
</div></footer>
</div>
</body>
</html>
