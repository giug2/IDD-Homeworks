<!DOCTYPE html><html lang="en">
<head>
<meta http-equiv="content-type" content="text/html; charset=UTF-8">
<title>[2310.02549] Heterogeneous Federated Learning Using Knowledge Codistillation</title><meta property="og:description" content="Federated Averaging, and many federated learning algorithm variants which build upon it, have a limitation: all clients must share the same model architecture. This results in unused modeling capacity on many clients, …">
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Heterogeneous Federated Learning Using Knowledge Codistillation">
<meta name="twitter:image:src" content="https://ar5iv.labs.arxiv.org/assets/ar5iv_card.png">
<meta name="twitter:image:alt" content="ar5iv logo">
<meta property="og:title" content="Heterogeneous Federated Learning Using Knowledge Codistillation">
<meta property="og:site_name" content="ar5iv">
<meta property="og:image" content="https://ar5iv.labs.arxiv.org/assets/ar5iv_card.png">
<meta property="og:type" content="article">
<meta property="og:url" content="https://ar5iv.labs.arxiv.org/html/2310.02549">

<!--Generated on Wed Feb 28 02:45:32 2024 by LaTeXML (version 0.8.8) http://dlmf.nist.gov/LaTeXML/.-->
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="keywords" lang="en" content="Machine Learning,  ICML">

<script>
  function detectColorScheme(){
    var theme="light";
    var current_theme = localStorage.getItem("ar5iv_theme");
    if(current_theme){
      if(current_theme == "dark"){
        theme = "dark";
      } }
    else if(!window.matchMedia) { return false; }
    else if(window.matchMedia("(prefers-color-scheme: dark)").matches) {
      theme = "dark"; }
    if (theme=="dark") {
      document.documentElement.setAttribute("data-theme", "dark");
    } else {
      document.documentElement.setAttribute("data-theme", "light"); } }

  detectColorScheme();

  function toggleColorScheme(){
    var current_theme = localStorage.getItem("ar5iv_theme");
    if (current_theme) {
      if (current_theme == "light") {
        localStorage.setItem("ar5iv_theme", "dark"); }
      else {
        localStorage.setItem("ar5iv_theme", "light"); } }
    else {
        localStorage.setItem("ar5iv_theme", "dark"); }
    detectColorScheme(); }
</script>
<link media="all" rel="stylesheet" href="/assets/ar5iv-fonts.0.8.0.min.css"><link media="all" rel="stylesheet" href="/assets/ar5iv.0.8.0.min.css"><link media="all" rel="stylesheet" href="/assets/ar5iv-site.0.2.2.css">
</head>
<body>
<div class="ltx_page_main">
<div class="ltx_page_content">
<article class="ltx_document ltx_pruned_first">
<h1 class="ltx_title ltx_title_document">Heterogeneous Federated Learning Using Knowledge Codistillation</h1>
<div class="ltx_authors">
<span class="ltx_creator ltx_role_author">
<span class="ltx_personname">Jared Licharge
</span></span>
<span class="ltx_author_before">  </span><span class="ltx_creator ltx_role_author">
<span class="ltx_personname">Ehsan Amid
</span></span>
<span class="ltx_author_before">  </span><span class="ltx_creator ltx_role_author">
<span class="ltx_personname">Shankar Kumar
</span></span>
<span class="ltx_author_before">  </span><span class="ltx_creator ltx_role_author">
<span class="ltx_personname">Tien-Ju Yang
</span></span>
<span class="ltx_author_before">  </span><span class="ltx_creator ltx_role_author">
<span class="ltx_personname">Rohan Anil
</span></span>
<span class="ltx_author_before">  </span><span class="ltx_creator ltx_role_author">
<span class="ltx_personname">Rajiv Mathews
</span></span>
</div>

<div class="ltx_abstract">
<h6 class="ltx_title ltx_title_abstract">Abstract</h6>
<p id="id1.id1" class="ltx_p">Federated Averaging, and many federated learning algorithm variants which build upon it, have a limitation: all clients must share the same model architecture. This results in unused modeling capacity on many clients, which limits model performance. To address this issue, we propose a method that involves training a small model on the entire pool and a larger model on a subset of clients with higher capacity. The models exchange information bidirectionally via knowledge distillation, utilizing an unlabeled dataset on a server without sharing parameters. We present two variants of our method, which improve upon
federated averaging on image classification and language modeling tasks. We show this technique can be useful even if only out-of-domain or limited in-domain distillation data is available. Additionally, the bi-directional knowledge distillation allows for domain transfer between the models when different pool populations introduce domain shift.</p>
</div>
<div class="ltx_keywords">Machine Learning, ICML
</div>
<div id="p2" class="ltx_para">
<br class="ltx_break">
</div>
<section id="S1" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">1 </span>Introduction</h2>

<div id="S1.p1" class="ltx_para">
<p id="S1.p1.1" class="ltx_p">Federated Learning (FL) <cite class="ltx_cite ltx_citemacro_citep">(McMahan et al., <a href="#bib.bib21" title="" class="ltx_ref">2016</a>)</cite> is a technique for training a centralized model using the private data of decentralized clients without the need for data sharing. It is typically implemented through the Federated Averaging Algorithm <cite class="ltx_cite ltx_citemacro_citep">(McMahan et al., <a href="#bib.bib20" title="" class="ltx_ref">2017</a>)</cite> (<span id="S1.p1.1.1" class="ltx_text ltx_font_smallcaps">FedAvg</span>), which combines model updates from a subset of clients in each round to produce a single update on the shared server model. However, this approach requires all clients to use the same model architecture. As the client pool is often composed of diverse hardware with varying capacities, sharing an architecture limits the shared model size to the lowest-common-denominator architecture of the federated pool. This results in unused modeling capacity on many clients, which detriments model performance. To overcome this limitation, newer federated learning methods are being developed <cite class="ltx_cite ltx_citemacro_citep">(Lin et al., <a href="#bib.bib19" title="" class="ltx_ref">2020</a>; Ozkara et al., <a href="#bib.bib27" title="" class="ltx_ref">2021</a>)</cite> that remove the constraint that all models in the pool must share a single architecture. While some methods alleviate this constraint by soliciting logits from the clients instead of model differences <cite class="ltx_cite ltx_citemacro_citep">(Lin et al., <a href="#bib.bib19" title="" class="ltx_ref">2020</a>)</cite>, we seek to address this issue by building on top of the popular <span id="S1.p1.1.2" class="ltx_text ltx_font_smallcaps">FedAvg</span> strategy. A thorough discussion of related work is presented in Appendix <a href="#A1" title="Appendix A Related Work ‣ Heterogeneous Federated Learning Using Knowledge Codistillation" class="ltx_ref"><span class="ltx_text ltx_ref_tag">A</span></a>.
In this work, we propose to partition the set of clients into two or more pools by model-size capacity, and run (bi-directional) knowledge distillation <cite class="ltx_cite ltx_citemacro_citep">(Hinton et al., <a href="#bib.bib11" title="" class="ltx_ref">2015</a>)</cite>, known as <em id="S1.p1.1.3" class="ltx_emph ltx_font_italic">codistillation</em> <cite class="ltx_cite ltx_citemacro_citep">(Anil et al., <a href="#bib.bib5" title="" class="ltx_ref">2018</a>)</cite>, between the server models produced by each <span id="S1.p1.1.4" class="ltx_text ltx_font_smallcaps">FedAvg</span> pool, leveraging (un)labeled server data as the distillation dataset. By co-distilling the two (or more) models frequently over the course of <span id="S1.p1.1.5" class="ltx_text ltx_font_smallcaps">FedAvg</span> rounds, we can share information between the pools without sharing model parameters. This partitioning allows us to make fuller use of the computational capacity of the federated pool, which can lead to increased performance and convergence in fewer federated rounds. Our methods are agnostic to the FL method applied within each pool and can work in a complementary fashion with any of the variants of <span id="S1.p1.1.6" class="ltx_text ltx_font_smallcaps">FedAvg</span> which still train a single server model<span id="footnote1" class="ltx_note ltx_role_footnote"><sup class="ltx_note_mark">1</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">1</sup><span class="ltx_tag ltx_tag_note">1</span>See related work discussion in Appendix <a href="#A1" title="Appendix A Related Work ‣ Heterogeneous Federated Learning Using Knowledge Codistillation" class="ltx_ref"><span class="ltx_text ltx_ref_tag">A</span></a>.</span></span></span>. Our approach places no additional computational burden on the client, as all distillation computation occurs on the server.</p>
</div>
<figure id="S1.F1" class="ltx_figure">
<div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_2">
<figure id="S1.F1.1.1" class="ltx_figure ltx_figure_panel ltx_align_center"><img src="/html/2310.02549/assets/x1.png" id="S1.F1.1.1.g1" class="ltx_graphics ltx_img_landscape" width="225" height="178" alt="Refer to caption">
</figure>
</div>
<div class="ltx_flex_cell ltx_flex_size_2">
<figure id="S1.F1.2.2" class="ltx_figure ltx_figure_panel ltx_align_center"><img src="/html/2310.02549/assets/x2.png" id="S1.F1.2.2.g1" class="ltx_graphics ltx_img_landscape" width="225" height="178" alt="Refer to caption">
</figure>
</div>
</div>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 1: </span>Schematics of the proposed methods: (a) Baseline <span id="S1.F1.4.1" class="ltx_text ltx_font_smallcaps">FedAvg</span> on the single pool of clients. The model capacity is limited by the lowest-common-denominator client’s capacity in the pool. (b) Federated co-distillation with two client pools. The larger model trains on a smaller pool of high-capacity clients. The models exchange information via co-distillation on the server. </figcaption>
</figure>
</section>
<section id="S2" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">2 </span>Methods</h2>

<div id="S2.p1" class="ltx_para">
<p id="S2.p1.1" class="ltx_p">We present two novel federated learning algorithms that avoid the requirement for a common server model by using knowledge distillation to share information between the server models of different <span id="S2.p1.1.1" class="ltx_text ltx_font_smallcaps">FedAvg</span> pools without sharing model parameters. We present two variants of our method: <span id="S2.p1.1.2" class="ltx_text ltx_font_smallcaps">PeriodicCodist</span>  in which co-distillation is applied independently from <span id="S2.p1.1.3" class="ltx_text ltx_font_smallcaps">FedAvg</span> updates at fixed intervals of federated rounds, and <span id="S2.p1.1.4" class="ltx_text ltx_font_smallcaps">MergedCodist</span>, in which co-distillation updates are merged with <span id="S2.p1.1.5" class="ltx_text ltx_font_smallcaps">FedAvg</span> updates at each round. Neither approach is restricted to a specific distillation technique, as any underlying knowledge distillation strategy can be employed <cite class="ltx_cite ltx_citemacro_citep">(Hinton et al., <a href="#bib.bib11" title="" class="ltx_ref">2015</a>; Romero et al., <a href="#bib.bib31" title="" class="ltx_ref">2014</a>; Tian et al., <a href="#bib.bib34" title="" class="ltx_ref">2019</a>; Müller et al., <a href="#bib.bib24" title="" class="ltx_ref">2020</a>; Amid et al., <a href="#bib.bib4" title="" class="ltx_ref">2022</a>)</cite>. In this work, we use KL-divergence between output probabilities for performing distillation. We explore using two federated pools, one for low-capacity and another for high-capacity models, but our approach can be extended to work for any number of pools. The standard <span id="S2.p1.1.6" class="ltx_text ltx_font_smallcaps">FedAvg</span> method and our proposed co-distillation approaches are illustrated in Figure <a href="#S1.F1" title="Figure 1 ‣ 1 Introduction ‣ Heterogeneous Federated Learning Using Knowledge Codistillation" class="ltx_ref"><span class="ltx_text ltx_ref_tag">1</span></a>(a) and Figure <a href="#S1.F1" title="Figure 1 ‣ 1 Introduction ‣ Heterogeneous Federated Learning Using Knowledge Codistillation" class="ltx_ref"><span class="ltx_text ltx_ref_tag">1</span></a>(b), respectively.</p>
</div>
<div id="S2.p2" class="ltx_para">
<p id="S2.p2.22" class="ltx_p">We denote by <math id="S2.p2.1.m1.1" class="ltx_Math" alttext="\mathcal{P}" display="inline"><semantics id="S2.p2.1.m1.1a"><mi class="ltx_font_mathcaligraphic" id="S2.p2.1.m1.1.1" xref="S2.p2.1.m1.1.1.cmml">𝒫</mi><annotation-xml encoding="MathML-Content" id="S2.p2.1.m1.1b"><ci id="S2.p2.1.m1.1.1.cmml" xref="S2.p2.1.m1.1.1">𝒫</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.p2.1.m1.1c">\mathcal{P}</annotation></semantics></math> the pool of clients with heterogeneous memory constraints. For ease of presentation, we consider the case where <math id="S2.p2.2.m2.1" class="ltx_Math" alttext="\mathcal{P}" display="inline"><semantics id="S2.p2.2.m2.1a"><mi class="ltx_font_mathcaligraphic" id="S2.p2.2.m2.1.1" xref="S2.p2.2.m2.1.1.cmml">𝒫</mi><annotation-xml encoding="MathML-Content" id="S2.p2.2.m2.1b"><ci id="S2.p2.2.m2.1.1.cmml" xref="S2.p2.2.m2.1.1">𝒫</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.p2.2.m2.1c">\mathcal{P}</annotation></semantics></math> is partitioned into two pools: the high-performance clients <math id="S2.p2.3.m3.1" class="ltx_Math" alttext="\mathcal{P}_{H}" display="inline"><semantics id="S2.p2.3.m3.1a"><msub id="S2.p2.3.m3.1.1" xref="S2.p2.3.m3.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S2.p2.3.m3.1.1.2" xref="S2.p2.3.m3.1.1.2.cmml">𝒫</mi><mi id="S2.p2.3.m3.1.1.3" xref="S2.p2.3.m3.1.1.3.cmml">H</mi></msub><annotation-xml encoding="MathML-Content" id="S2.p2.3.m3.1b"><apply id="S2.p2.3.m3.1.1.cmml" xref="S2.p2.3.m3.1.1"><csymbol cd="ambiguous" id="S2.p2.3.m3.1.1.1.cmml" xref="S2.p2.3.m3.1.1">subscript</csymbol><ci id="S2.p2.3.m3.1.1.2.cmml" xref="S2.p2.3.m3.1.1.2">𝒫</ci><ci id="S2.p2.3.m3.1.1.3.cmml" xref="S2.p2.3.m3.1.1.3">𝐻</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.p2.3.m3.1c">\mathcal{P}_{H}</annotation></semantics></math> having devices with higher capacity, and the remaining (low-performance) clients <math id="S2.p2.4.m4.1" class="ltx_Math" alttext="\mathcal{P}_{L}=\mathcal{P}-\mathcal{P}_{H}" display="inline"><semantics id="S2.p2.4.m4.1a"><mrow id="S2.p2.4.m4.1.1" xref="S2.p2.4.m4.1.1.cmml"><msub id="S2.p2.4.m4.1.1.2" xref="S2.p2.4.m4.1.1.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S2.p2.4.m4.1.1.2.2" xref="S2.p2.4.m4.1.1.2.2.cmml">𝒫</mi><mi id="S2.p2.4.m4.1.1.2.3" xref="S2.p2.4.m4.1.1.2.3.cmml">L</mi></msub><mo id="S2.p2.4.m4.1.1.1" xref="S2.p2.4.m4.1.1.1.cmml">=</mo><mrow id="S2.p2.4.m4.1.1.3" xref="S2.p2.4.m4.1.1.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S2.p2.4.m4.1.1.3.2" xref="S2.p2.4.m4.1.1.3.2.cmml">𝒫</mi><mo id="S2.p2.4.m4.1.1.3.1" xref="S2.p2.4.m4.1.1.3.1.cmml">−</mo><msub id="S2.p2.4.m4.1.1.3.3" xref="S2.p2.4.m4.1.1.3.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S2.p2.4.m4.1.1.3.3.2" xref="S2.p2.4.m4.1.1.3.3.2.cmml">𝒫</mi><mi id="S2.p2.4.m4.1.1.3.3.3" xref="S2.p2.4.m4.1.1.3.3.3.cmml">H</mi></msub></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.p2.4.m4.1b"><apply id="S2.p2.4.m4.1.1.cmml" xref="S2.p2.4.m4.1.1"><eq id="S2.p2.4.m4.1.1.1.cmml" xref="S2.p2.4.m4.1.1.1"></eq><apply id="S2.p2.4.m4.1.1.2.cmml" xref="S2.p2.4.m4.1.1.2"><csymbol cd="ambiguous" id="S2.p2.4.m4.1.1.2.1.cmml" xref="S2.p2.4.m4.1.1.2">subscript</csymbol><ci id="S2.p2.4.m4.1.1.2.2.cmml" xref="S2.p2.4.m4.1.1.2.2">𝒫</ci><ci id="S2.p2.4.m4.1.1.2.3.cmml" xref="S2.p2.4.m4.1.1.2.3">𝐿</ci></apply><apply id="S2.p2.4.m4.1.1.3.cmml" xref="S2.p2.4.m4.1.1.3"><minus id="S2.p2.4.m4.1.1.3.1.cmml" xref="S2.p2.4.m4.1.1.3.1"></minus><ci id="S2.p2.4.m4.1.1.3.2.cmml" xref="S2.p2.4.m4.1.1.3.2">𝒫</ci><apply id="S2.p2.4.m4.1.1.3.3.cmml" xref="S2.p2.4.m4.1.1.3.3"><csymbol cd="ambiguous" id="S2.p2.4.m4.1.1.3.3.1.cmml" xref="S2.p2.4.m4.1.1.3.3">subscript</csymbol><ci id="S2.p2.4.m4.1.1.3.3.2.cmml" xref="S2.p2.4.m4.1.1.3.3.2">𝒫</ci><ci id="S2.p2.4.m4.1.1.3.3.3.cmml" xref="S2.p2.4.m4.1.1.3.3.3">𝐻</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.p2.4.m4.1c">\mathcal{P}_{L}=\mathcal{P}-\mathcal{P}_{H}</annotation></semantics></math>. Based on the distribution of the devices across a typical federated client pool <cite class="ltx_cite ltx_citemacro_citep">(Wang et al., <a href="#bib.bib35" title="" class="ltx_ref">2021</a>)</cite>, it is reasonable to assume that <math id="S2.p2.5.m5.2" class="ltx_Math" alttext="|\mathcal{P}_{H}|\ll|\mathcal{P}_{L}|" display="inline"><semantics id="S2.p2.5.m5.2a"><mrow id="S2.p2.5.m5.2.2" xref="S2.p2.5.m5.2.2.cmml"><mrow id="S2.p2.5.m5.1.1.1.1" xref="S2.p2.5.m5.1.1.1.2.cmml"><mo stretchy="false" id="S2.p2.5.m5.1.1.1.1.2" xref="S2.p2.5.m5.1.1.1.2.1.cmml">|</mo><msub id="S2.p2.5.m5.1.1.1.1.1" xref="S2.p2.5.m5.1.1.1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S2.p2.5.m5.1.1.1.1.1.2" xref="S2.p2.5.m5.1.1.1.1.1.2.cmml">𝒫</mi><mi id="S2.p2.5.m5.1.1.1.1.1.3" xref="S2.p2.5.m5.1.1.1.1.1.3.cmml">H</mi></msub><mo stretchy="false" id="S2.p2.5.m5.1.1.1.1.3" xref="S2.p2.5.m5.1.1.1.2.1.cmml">|</mo></mrow><mo id="S2.p2.5.m5.2.2.3" xref="S2.p2.5.m5.2.2.3.cmml">≪</mo><mrow id="S2.p2.5.m5.2.2.2.1" xref="S2.p2.5.m5.2.2.2.2.cmml"><mo stretchy="false" id="S2.p2.5.m5.2.2.2.1.2" xref="S2.p2.5.m5.2.2.2.2.1.cmml">|</mo><msub id="S2.p2.5.m5.2.2.2.1.1" xref="S2.p2.5.m5.2.2.2.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S2.p2.5.m5.2.2.2.1.1.2" xref="S2.p2.5.m5.2.2.2.1.1.2.cmml">𝒫</mi><mi id="S2.p2.5.m5.2.2.2.1.1.3" xref="S2.p2.5.m5.2.2.2.1.1.3.cmml">L</mi></msub><mo stretchy="false" id="S2.p2.5.m5.2.2.2.1.3" xref="S2.p2.5.m5.2.2.2.2.1.cmml">|</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.p2.5.m5.2b"><apply id="S2.p2.5.m5.2.2.cmml" xref="S2.p2.5.m5.2.2"><csymbol cd="latexml" id="S2.p2.5.m5.2.2.3.cmml" xref="S2.p2.5.m5.2.2.3">much-less-than</csymbol><apply id="S2.p2.5.m5.1.1.1.2.cmml" xref="S2.p2.5.m5.1.1.1.1"><abs id="S2.p2.5.m5.1.1.1.2.1.cmml" xref="S2.p2.5.m5.1.1.1.1.2"></abs><apply id="S2.p2.5.m5.1.1.1.1.1.cmml" xref="S2.p2.5.m5.1.1.1.1.1"><csymbol cd="ambiguous" id="S2.p2.5.m5.1.1.1.1.1.1.cmml" xref="S2.p2.5.m5.1.1.1.1.1">subscript</csymbol><ci id="S2.p2.5.m5.1.1.1.1.1.2.cmml" xref="S2.p2.5.m5.1.1.1.1.1.2">𝒫</ci><ci id="S2.p2.5.m5.1.1.1.1.1.3.cmml" xref="S2.p2.5.m5.1.1.1.1.1.3">𝐻</ci></apply></apply><apply id="S2.p2.5.m5.2.2.2.2.cmml" xref="S2.p2.5.m5.2.2.2.1"><abs id="S2.p2.5.m5.2.2.2.2.1.cmml" xref="S2.p2.5.m5.2.2.2.1.2"></abs><apply id="S2.p2.5.m5.2.2.2.1.1.cmml" xref="S2.p2.5.m5.2.2.2.1.1"><csymbol cd="ambiguous" id="S2.p2.5.m5.2.2.2.1.1.1.cmml" xref="S2.p2.5.m5.2.2.2.1.1">subscript</csymbol><ci id="S2.p2.5.m5.2.2.2.1.1.2.cmml" xref="S2.p2.5.m5.2.2.2.1.1.2">𝒫</ci><ci id="S2.p2.5.m5.2.2.2.1.1.3.cmml" xref="S2.p2.5.m5.2.2.2.1.1.3">𝐿</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.p2.5.m5.2c">|\mathcal{P}_{H}|\ll|\mathcal{P}_{L}|</annotation></semantics></math>. We consider training two model architectures, parameterized by <math id="S2.p2.6.m6.1" class="ltx_Math" alttext="\theta_{L}" display="inline"><semantics id="S2.p2.6.m6.1a"><msub id="S2.p2.6.m6.1.1" xref="S2.p2.6.m6.1.1.cmml"><mi id="S2.p2.6.m6.1.1.2" xref="S2.p2.6.m6.1.1.2.cmml">θ</mi><mi id="S2.p2.6.m6.1.1.3" xref="S2.p2.6.m6.1.1.3.cmml">L</mi></msub><annotation-xml encoding="MathML-Content" id="S2.p2.6.m6.1b"><apply id="S2.p2.6.m6.1.1.cmml" xref="S2.p2.6.m6.1.1"><csymbol cd="ambiguous" id="S2.p2.6.m6.1.1.1.cmml" xref="S2.p2.6.m6.1.1">subscript</csymbol><ci id="S2.p2.6.m6.1.1.2.cmml" xref="S2.p2.6.m6.1.1.2">𝜃</ci><ci id="S2.p2.6.m6.1.1.3.cmml" xref="S2.p2.6.m6.1.1.3">𝐿</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.p2.6.m6.1c">\theta_{L}</annotation></semantics></math> and <math id="S2.p2.7.m7.1" class="ltx_Math" alttext="\theta_{H}" display="inline"><semantics id="S2.p2.7.m7.1a"><msub id="S2.p2.7.m7.1.1" xref="S2.p2.7.m7.1.1.cmml"><mi id="S2.p2.7.m7.1.1.2" xref="S2.p2.7.m7.1.1.2.cmml">θ</mi><mi id="S2.p2.7.m7.1.1.3" xref="S2.p2.7.m7.1.1.3.cmml">H</mi></msub><annotation-xml encoding="MathML-Content" id="S2.p2.7.m7.1b"><apply id="S2.p2.7.m7.1.1.cmml" xref="S2.p2.7.m7.1.1"><csymbol cd="ambiguous" id="S2.p2.7.m7.1.1.1.cmml" xref="S2.p2.7.m7.1.1">subscript</csymbol><ci id="S2.p2.7.m7.1.1.2.cmml" xref="S2.p2.7.m7.1.1.2">𝜃</ci><ci id="S2.p2.7.m7.1.1.3.cmml" xref="S2.p2.7.m7.1.1.3">𝐻</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.p2.7.m7.1c">\theta_{H}</annotation></semantics></math>, using the available clients in <math id="S2.p2.8.m8.1" class="ltx_Math" alttext="\mathcal{P}" display="inline"><semantics id="S2.p2.8.m8.1a"><mi class="ltx_font_mathcaligraphic" id="S2.p2.8.m8.1.1" xref="S2.p2.8.m8.1.1.cmml">𝒫</mi><annotation-xml encoding="MathML-Content" id="S2.p2.8.m8.1b"><ci id="S2.p2.8.m8.1.1.cmml" xref="S2.p2.8.m8.1.1">𝒫</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.p2.8.m8.1c">\mathcal{P}</annotation></semantics></math>, with <math id="S2.p2.9.m9.2" class="ltx_Math" alttext="|\theta_{L}|&lt;|\theta_{H}|" display="inline"><semantics id="S2.p2.9.m9.2a"><mrow id="S2.p2.9.m9.2.2" xref="S2.p2.9.m9.2.2.cmml"><mrow id="S2.p2.9.m9.1.1.1.1" xref="S2.p2.9.m9.1.1.1.2.cmml"><mo stretchy="false" id="S2.p2.9.m9.1.1.1.1.2" xref="S2.p2.9.m9.1.1.1.2.1.cmml">|</mo><msub id="S2.p2.9.m9.1.1.1.1.1" xref="S2.p2.9.m9.1.1.1.1.1.cmml"><mi id="S2.p2.9.m9.1.1.1.1.1.2" xref="S2.p2.9.m9.1.1.1.1.1.2.cmml">θ</mi><mi id="S2.p2.9.m9.1.1.1.1.1.3" xref="S2.p2.9.m9.1.1.1.1.1.3.cmml">L</mi></msub><mo stretchy="false" id="S2.p2.9.m9.1.1.1.1.3" xref="S2.p2.9.m9.1.1.1.2.1.cmml">|</mo></mrow><mo id="S2.p2.9.m9.2.2.3" xref="S2.p2.9.m9.2.2.3.cmml">&lt;</mo><mrow id="S2.p2.9.m9.2.2.2.1" xref="S2.p2.9.m9.2.2.2.2.cmml"><mo stretchy="false" id="S2.p2.9.m9.2.2.2.1.2" xref="S2.p2.9.m9.2.2.2.2.1.cmml">|</mo><msub id="S2.p2.9.m9.2.2.2.1.1" xref="S2.p2.9.m9.2.2.2.1.1.cmml"><mi id="S2.p2.9.m9.2.2.2.1.1.2" xref="S2.p2.9.m9.2.2.2.1.1.2.cmml">θ</mi><mi id="S2.p2.9.m9.2.2.2.1.1.3" xref="S2.p2.9.m9.2.2.2.1.1.3.cmml">H</mi></msub><mo stretchy="false" id="S2.p2.9.m9.2.2.2.1.3" xref="S2.p2.9.m9.2.2.2.2.1.cmml">|</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.p2.9.m9.2b"><apply id="S2.p2.9.m9.2.2.cmml" xref="S2.p2.9.m9.2.2"><lt id="S2.p2.9.m9.2.2.3.cmml" xref="S2.p2.9.m9.2.2.3"></lt><apply id="S2.p2.9.m9.1.1.1.2.cmml" xref="S2.p2.9.m9.1.1.1.1"><abs id="S2.p2.9.m9.1.1.1.2.1.cmml" xref="S2.p2.9.m9.1.1.1.1.2"></abs><apply id="S2.p2.9.m9.1.1.1.1.1.cmml" xref="S2.p2.9.m9.1.1.1.1.1"><csymbol cd="ambiguous" id="S2.p2.9.m9.1.1.1.1.1.1.cmml" xref="S2.p2.9.m9.1.1.1.1.1">subscript</csymbol><ci id="S2.p2.9.m9.1.1.1.1.1.2.cmml" xref="S2.p2.9.m9.1.1.1.1.1.2">𝜃</ci><ci id="S2.p2.9.m9.1.1.1.1.1.3.cmml" xref="S2.p2.9.m9.1.1.1.1.1.3">𝐿</ci></apply></apply><apply id="S2.p2.9.m9.2.2.2.2.cmml" xref="S2.p2.9.m9.2.2.2.1"><abs id="S2.p2.9.m9.2.2.2.2.1.cmml" xref="S2.p2.9.m9.2.2.2.1.2"></abs><apply id="S2.p2.9.m9.2.2.2.1.1.cmml" xref="S2.p2.9.m9.2.2.2.1.1"><csymbol cd="ambiguous" id="S2.p2.9.m9.2.2.2.1.1.1.cmml" xref="S2.p2.9.m9.2.2.2.1.1">subscript</csymbol><ci id="S2.p2.9.m9.2.2.2.1.1.2.cmml" xref="S2.p2.9.m9.2.2.2.1.1.2">𝜃</ci><ci id="S2.p2.9.m9.2.2.2.1.1.3.cmml" xref="S2.p2.9.m9.2.2.2.1.1.3">𝐻</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.p2.9.m9.2c">|\theta_{L}|&lt;|\theta_{H}|</annotation></semantics></math>. Therefore, we assume that
<math id="S2.p2.10.m10.1" class="ltx_Math" alttext="\theta_{H}" display="inline"><semantics id="S2.p2.10.m10.1a"><msub id="S2.p2.10.m10.1.1" xref="S2.p2.10.m10.1.1.cmml"><mi id="S2.p2.10.m10.1.1.2" xref="S2.p2.10.m10.1.1.2.cmml">θ</mi><mi id="S2.p2.10.m10.1.1.3" xref="S2.p2.10.m10.1.1.3.cmml">H</mi></msub><annotation-xml encoding="MathML-Content" id="S2.p2.10.m10.1b"><apply id="S2.p2.10.m10.1.1.cmml" xref="S2.p2.10.m10.1.1"><csymbol cd="ambiguous" id="S2.p2.10.m10.1.1.1.cmml" xref="S2.p2.10.m10.1.1">subscript</csymbol><ci id="S2.p2.10.m10.1.1.2.cmml" xref="S2.p2.10.m10.1.1.2">𝜃</ci><ci id="S2.p2.10.m10.1.1.3.cmml" xref="S2.p2.10.m10.1.1.3">𝐻</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.p2.10.m10.1c">\theta_{H}</annotation></semantics></math> is only deployable on the high-performance clients in <math id="S2.p2.11.m11.1" class="ltx_Math" alttext="\mathcal{P}_{H}\subset\mathcal{P}" display="inline"><semantics id="S2.p2.11.m11.1a"><mrow id="S2.p2.11.m11.1.1" xref="S2.p2.11.m11.1.1.cmml"><msub id="S2.p2.11.m11.1.1.2" xref="S2.p2.11.m11.1.1.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S2.p2.11.m11.1.1.2.2" xref="S2.p2.11.m11.1.1.2.2.cmml">𝒫</mi><mi id="S2.p2.11.m11.1.1.2.3" xref="S2.p2.11.m11.1.1.2.3.cmml">H</mi></msub><mo id="S2.p2.11.m11.1.1.1" xref="S2.p2.11.m11.1.1.1.cmml">⊂</mo><mi class="ltx_font_mathcaligraphic" id="S2.p2.11.m11.1.1.3" xref="S2.p2.11.m11.1.1.3.cmml">𝒫</mi></mrow><annotation-xml encoding="MathML-Content" id="S2.p2.11.m11.1b"><apply id="S2.p2.11.m11.1.1.cmml" xref="S2.p2.11.m11.1.1"><subset id="S2.p2.11.m11.1.1.1.cmml" xref="S2.p2.11.m11.1.1.1"></subset><apply id="S2.p2.11.m11.1.1.2.cmml" xref="S2.p2.11.m11.1.1.2"><csymbol cd="ambiguous" id="S2.p2.11.m11.1.1.2.1.cmml" xref="S2.p2.11.m11.1.1.2">subscript</csymbol><ci id="S2.p2.11.m11.1.1.2.2.cmml" xref="S2.p2.11.m11.1.1.2.2">𝒫</ci><ci id="S2.p2.11.m11.1.1.2.3.cmml" xref="S2.p2.11.m11.1.1.2.3">𝐻</ci></apply><ci id="S2.p2.11.m11.1.1.3.cmml" xref="S2.p2.11.m11.1.1.3">𝒫</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.p2.11.m11.1c">\mathcal{P}_{H}\subset\mathcal{P}</annotation></semantics></math>, while <math id="S2.p2.12.m12.1" class="ltx_Math" alttext="\theta_{L}" display="inline"><semantics id="S2.p2.12.m12.1a"><msub id="S2.p2.12.m12.1.1" xref="S2.p2.12.m12.1.1.cmml"><mi id="S2.p2.12.m12.1.1.2" xref="S2.p2.12.m12.1.1.2.cmml">θ</mi><mi id="S2.p2.12.m12.1.1.3" xref="S2.p2.12.m12.1.1.3.cmml">L</mi></msub><annotation-xml encoding="MathML-Content" id="S2.p2.12.m12.1b"><apply id="S2.p2.12.m12.1.1.cmml" xref="S2.p2.12.m12.1.1"><csymbol cd="ambiguous" id="S2.p2.12.m12.1.1.1.cmml" xref="S2.p2.12.m12.1.1">subscript</csymbol><ci id="S2.p2.12.m12.1.1.2.cmml" xref="S2.p2.12.m12.1.1.2">𝜃</ci><ci id="S2.p2.12.m12.1.1.3.cmml" xref="S2.p2.12.m12.1.1.3">𝐿</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.p2.12.m12.1c">\theta_{L}</annotation></semantics></math> can be trained on any client in <math id="S2.p2.13.m13.1" class="ltx_Math" alttext="\mathcal{P}" display="inline"><semantics id="S2.p2.13.m13.1a"><mi class="ltx_font_mathcaligraphic" id="S2.p2.13.m13.1.1" xref="S2.p2.13.m13.1.1.cmml">𝒫</mi><annotation-xml encoding="MathML-Content" id="S2.p2.13.m13.1b"><ci id="S2.p2.13.m13.1.1.cmml" xref="S2.p2.13.m13.1.1">𝒫</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.p2.13.m13.1c">\mathcal{P}</annotation></semantics></math>. In particular, we assume that <math id="S2.p2.14.m14.1" class="ltx_Math" alttext="\theta_{L}" display="inline"><semantics id="S2.p2.14.m14.1a"><msub id="S2.p2.14.m14.1.1" xref="S2.p2.14.m14.1.1.cmml"><mi id="S2.p2.14.m14.1.1.2" xref="S2.p2.14.m14.1.1.2.cmml">θ</mi><mi id="S2.p2.14.m14.1.1.3" xref="S2.p2.14.m14.1.1.3.cmml">L</mi></msub><annotation-xml encoding="MathML-Content" id="S2.p2.14.m14.1b"><apply id="S2.p2.14.m14.1.1.cmml" xref="S2.p2.14.m14.1.1"><csymbol cd="ambiguous" id="S2.p2.14.m14.1.1.1.cmml" xref="S2.p2.14.m14.1.1">subscript</csymbol><ci id="S2.p2.14.m14.1.1.2.cmml" xref="S2.p2.14.m14.1.1.2">𝜃</ci><ci id="S2.p2.14.m14.1.1.3.cmml" xref="S2.p2.14.m14.1.1.3">𝐿</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.p2.14.m14.1c">\theta_{L}</annotation></semantics></math> represents the lowest-common-denominator model size given the hardware constraints on the entire pool <math id="S2.p2.15.m15.1" class="ltx_Math" alttext="\mathcal{P}" display="inline"><semantics id="S2.p2.15.m15.1a"><mi class="ltx_font_mathcaligraphic" id="S2.p2.15.m15.1.1" xref="S2.p2.15.m15.1.1.cmml">𝒫</mi><annotation-xml encoding="MathML-Content" id="S2.p2.15.m15.1b"><ci id="S2.p2.15.m15.1.1.cmml" xref="S2.p2.15.m15.1.1">𝒫</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.p2.15.m15.1c">\mathcal{P}</annotation></semantics></math>. Therefore, vanilla <span id="S2.p2.22.1" class="ltx_text ltx_font_smallcaps">FedAvg</span> may be applied to train <math id="S2.p2.16.m16.1" class="ltx_Math" alttext="\theta_{L}" display="inline"><semantics id="S2.p2.16.m16.1a"><msub id="S2.p2.16.m16.1.1" xref="S2.p2.16.m16.1.1.cmml"><mi id="S2.p2.16.m16.1.1.2" xref="S2.p2.16.m16.1.1.2.cmml">θ</mi><mi id="S2.p2.16.m16.1.1.3" xref="S2.p2.16.m16.1.1.3.cmml">L</mi></msub><annotation-xml encoding="MathML-Content" id="S2.p2.16.m16.1b"><apply id="S2.p2.16.m16.1.1.cmml" xref="S2.p2.16.m16.1.1"><csymbol cd="ambiguous" id="S2.p2.16.m16.1.1.1.cmml" xref="S2.p2.16.m16.1.1">subscript</csymbol><ci id="S2.p2.16.m16.1.1.2.cmml" xref="S2.p2.16.m16.1.1.2">𝜃</ci><ci id="S2.p2.16.m16.1.1.3.cmml" xref="S2.p2.16.m16.1.1.3">𝐿</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.p2.16.m16.1c">\theta_{L}</annotation></semantics></math> via <span id="S2.p2.22.2" class="ltx_text ltx_font_smallcaps">FedAvg</span> on the entire pool <math id="S2.p2.17.m17.1" class="ltx_Math" alttext="\mathcal{P}" display="inline"><semantics id="S2.p2.17.m17.1a"><mi class="ltx_font_mathcaligraphic" id="S2.p2.17.m17.1.1" xref="S2.p2.17.m17.1.1.cmml">𝒫</mi><annotation-xml encoding="MathML-Content" id="S2.p2.17.m17.1b"><ci id="S2.p2.17.m17.1.1.cmml" xref="S2.p2.17.m17.1.1">𝒫</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.p2.17.m17.1c">\mathcal{P}</annotation></semantics></math>. However, <math id="S2.p2.18.m18.1" class="ltx_Math" alttext="\theta_{H}" display="inline"><semantics id="S2.p2.18.m18.1a"><msub id="S2.p2.18.m18.1.1" xref="S2.p2.18.m18.1.1.cmml"><mi id="S2.p2.18.m18.1.1.2" xref="S2.p2.18.m18.1.1.2.cmml">θ</mi><mi id="S2.p2.18.m18.1.1.3" xref="S2.p2.18.m18.1.1.3.cmml">H</mi></msub><annotation-xml encoding="MathML-Content" id="S2.p2.18.m18.1b"><apply id="S2.p2.18.m18.1.1.cmml" xref="S2.p2.18.m18.1.1"><csymbol cd="ambiguous" id="S2.p2.18.m18.1.1.1.cmml" xref="S2.p2.18.m18.1.1">subscript</csymbol><ci id="S2.p2.18.m18.1.1.2.cmml" xref="S2.p2.18.m18.1.1.2">𝜃</ci><ci id="S2.p2.18.m18.1.1.3.cmml" xref="S2.p2.18.m18.1.1.3">𝐻</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.p2.18.m18.1c">\theta_{H}</annotation></semantics></math> is not trainable on the client devices in <math id="S2.p2.19.m19.1" class="ltx_Math" alttext="\mathcal{P}_{L}" display="inline"><semantics id="S2.p2.19.m19.1a"><msub id="S2.p2.19.m19.1.1" xref="S2.p2.19.m19.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S2.p2.19.m19.1.1.2" xref="S2.p2.19.m19.1.1.2.cmml">𝒫</mi><mi id="S2.p2.19.m19.1.1.3" xref="S2.p2.19.m19.1.1.3.cmml">L</mi></msub><annotation-xml encoding="MathML-Content" id="S2.p2.19.m19.1b"><apply id="S2.p2.19.m19.1.1.cmml" xref="S2.p2.19.m19.1.1"><csymbol cd="ambiguous" id="S2.p2.19.m19.1.1.1.cmml" xref="S2.p2.19.m19.1.1">subscript</csymbol><ci id="S2.p2.19.m19.1.1.2.cmml" xref="S2.p2.19.m19.1.1.2">𝒫</ci><ci id="S2.p2.19.m19.1.1.3.cmml" xref="S2.p2.19.m19.1.1.3">𝐿</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.p2.19.m19.1c">\mathcal{P}_{L}</annotation></semantics></math> due to resource constraints. <math id="S2.p2.20.m20.1" class="ltx_Math" alttext="\theta_{H}" display="inline"><semantics id="S2.p2.20.m20.1a"><msub id="S2.p2.20.m20.1.1" xref="S2.p2.20.m20.1.1.cmml"><mi id="S2.p2.20.m20.1.1.2" xref="S2.p2.20.m20.1.1.2.cmml">θ</mi><mi id="S2.p2.20.m20.1.1.3" xref="S2.p2.20.m20.1.1.3.cmml">H</mi></msub><annotation-xml encoding="MathML-Content" id="S2.p2.20.m20.1b"><apply id="S2.p2.20.m20.1.1.cmml" xref="S2.p2.20.m20.1.1"><csymbol cd="ambiguous" id="S2.p2.20.m20.1.1.1.cmml" xref="S2.p2.20.m20.1.1">subscript</csymbol><ci id="S2.p2.20.m20.1.1.2.cmml" xref="S2.p2.20.m20.1.1.2">𝜃</ci><ci id="S2.p2.20.m20.1.1.3.cmml" xref="S2.p2.20.m20.1.1.3">𝐻</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.p2.20.m20.1c">\theta_{H}</annotation></semantics></math> offers an advantage over <math id="S2.p2.21.m21.1" class="ltx_Math" alttext="\theta_{L}" display="inline"><semantics id="S2.p2.21.m21.1a"><msub id="S2.p2.21.m21.1.1" xref="S2.p2.21.m21.1.1.cmml"><mi id="S2.p2.21.m21.1.1.2" xref="S2.p2.21.m21.1.1.2.cmml">θ</mi><mi id="S2.p2.21.m21.1.1.3" xref="S2.p2.21.m21.1.1.3.cmml">L</mi></msub><annotation-xml encoding="MathML-Content" id="S2.p2.21.m21.1b"><apply id="S2.p2.21.m21.1.1.cmml" xref="S2.p2.21.m21.1.1"><csymbol cd="ambiguous" id="S2.p2.21.m21.1.1.1.cmml" xref="S2.p2.21.m21.1.1">subscript</csymbol><ci id="S2.p2.21.m21.1.1.2.cmml" xref="S2.p2.21.m21.1.1.2">𝜃</ci><ci id="S2.p2.21.m21.1.1.3.cmml" xref="S2.p2.21.m21.1.1.3">𝐿</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.p2.21.m21.1c">\theta_{L}</annotation></semantics></math> by having a higher capacity, while <math id="S2.p2.22.m22.1" class="ltx_Math" alttext="\theta_{L}" display="inline"><semantics id="S2.p2.22.m22.1a"><msub id="S2.p2.22.m22.1.1" xref="S2.p2.22.m22.1.1.cmml"><mi id="S2.p2.22.m22.1.1.2" xref="S2.p2.22.m22.1.1.2.cmml">θ</mi><mi id="S2.p2.22.m22.1.1.3" xref="S2.p2.22.m22.1.1.3.cmml">L</mi></msub><annotation-xml encoding="MathML-Content" id="S2.p2.22.m22.1b"><apply id="S2.p2.22.m22.1.1.cmml" xref="S2.p2.22.m22.1.1"><csymbol cd="ambiguous" id="S2.p2.22.m22.1.1.1.cmml" xref="S2.p2.22.m22.1.1">subscript</csymbol><ci id="S2.p2.22.m22.1.1.2.cmml" xref="S2.p2.22.m22.1.1.2">𝜃</ci><ci id="S2.p2.22.m22.1.1.3.cmml" xref="S2.p2.22.m22.1.1.3">𝐿</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.p2.22.m22.1c">\theta_{L}</annotation></semantics></math> benefits from a significantly larger pool of clients for training. Thus, model capacity imposes a trade-off in terms of modeling power and data availability. We aim to tackle this issue by allowing the larger model to benefit from the low-performance clients’ data while allowing the smaller model to utilize the improved modeling power offered by the larger model as a teacher.</p>
</div>
<section id="S2.SS1" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">2.1 </span>Periodic Codistillation (<span id="S2.SS1.1.1" class="ltx_text ltx_font_smallcaps">PeriodicCodist</span>)</h3>

<div id="S2.SS1.p1" class="ltx_para">
<p id="S2.SS1.p1.13" class="ltx_p">In our first approach, we apply vanilla <span id="S2.SS1.p1.13.1" class="ltx_text ltx_font_smallcaps">FedAvg</span> for training each model on its corresponding available client pool.
Let <math id="S2.SS1.p1.1.m1.1" class="ltx_Math" alttext="T" display="inline"><semantics id="S2.SS1.p1.1.m1.1a"><mi id="S2.SS1.p1.1.m1.1.1" xref="S2.SS1.p1.1.m1.1.1.cmml">T</mi><annotation-xml encoding="MathML-Content" id="S2.SS1.p1.1.m1.1b"><ci id="S2.SS1.p1.1.m1.1.1.cmml" xref="S2.SS1.p1.1.m1.1.1">𝑇</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p1.1.m1.1c">T</annotation></semantics></math> denote the total number of <span id="S2.SS1.p1.13.2" class="ltx_text ltx_font_smallcaps">FedAvg</span> rounds for training <math id="S2.SS1.p1.2.m2.1" class="ltx_Math" alttext="\theta_{L}" display="inline"><semantics id="S2.SS1.p1.2.m2.1a"><msub id="S2.SS1.p1.2.m2.1.1" xref="S2.SS1.p1.2.m2.1.1.cmml"><mi id="S2.SS1.p1.2.m2.1.1.2" xref="S2.SS1.p1.2.m2.1.1.2.cmml">θ</mi><mi id="S2.SS1.p1.2.m2.1.1.3" xref="S2.SS1.p1.2.m2.1.1.3.cmml">L</mi></msub><annotation-xml encoding="MathML-Content" id="S2.SS1.p1.2.m2.1b"><apply id="S2.SS1.p1.2.m2.1.1.cmml" xref="S2.SS1.p1.2.m2.1.1"><csymbol cd="ambiguous" id="S2.SS1.p1.2.m2.1.1.1.cmml" xref="S2.SS1.p1.2.m2.1.1">subscript</csymbol><ci id="S2.SS1.p1.2.m2.1.1.2.cmml" xref="S2.SS1.p1.2.m2.1.1.2">𝜃</ci><ci id="S2.SS1.p1.2.m2.1.1.3.cmml" xref="S2.SS1.p1.2.m2.1.1.3">𝐿</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p1.2.m2.1c">\theta_{L}</annotation></semantics></math> and <math id="S2.SS1.p1.3.m3.1" class="ltx_Math" alttext="\theta_{H}" display="inline"><semantics id="S2.SS1.p1.3.m3.1a"><msub id="S2.SS1.p1.3.m3.1.1" xref="S2.SS1.p1.3.m3.1.1.cmml"><mi id="S2.SS1.p1.3.m3.1.1.2" xref="S2.SS1.p1.3.m3.1.1.2.cmml">θ</mi><mi id="S2.SS1.p1.3.m3.1.1.3" xref="S2.SS1.p1.3.m3.1.1.3.cmml">H</mi></msub><annotation-xml encoding="MathML-Content" id="S2.SS1.p1.3.m3.1b"><apply id="S2.SS1.p1.3.m3.1.1.cmml" xref="S2.SS1.p1.3.m3.1.1"><csymbol cd="ambiguous" id="S2.SS1.p1.3.m3.1.1.1.cmml" xref="S2.SS1.p1.3.m3.1.1">subscript</csymbol><ci id="S2.SS1.p1.3.m3.1.1.2.cmml" xref="S2.SS1.p1.3.m3.1.1.2">𝜃</ci><ci id="S2.SS1.p1.3.m3.1.1.3.cmml" xref="S2.SS1.p1.3.m3.1.1.3">𝐻</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p1.3.m3.1c">\theta_{H}</annotation></semantics></math>. In our <span id="S2.SS1.p1.13.3" class="ltx_text ltx_font_smallcaps">PeriodicCodist</span> approach, we perform vanilla <span id="S2.SS1.p1.13.4" class="ltx_text ltx_font_smallcaps">FedAvg</span> on <math id="S2.SS1.p1.4.m4.1" class="ltx_Math" alttext="\theta_{L}" display="inline"><semantics id="S2.SS1.p1.4.m4.1a"><msub id="S2.SS1.p1.4.m4.1.1" xref="S2.SS1.p1.4.m4.1.1.cmml"><mi id="S2.SS1.p1.4.m4.1.1.2" xref="S2.SS1.p1.4.m4.1.1.2.cmml">θ</mi><mi id="S2.SS1.p1.4.m4.1.1.3" xref="S2.SS1.p1.4.m4.1.1.3.cmml">L</mi></msub><annotation-xml encoding="MathML-Content" id="S2.SS1.p1.4.m4.1b"><apply id="S2.SS1.p1.4.m4.1.1.cmml" xref="S2.SS1.p1.4.m4.1.1"><csymbol cd="ambiguous" id="S2.SS1.p1.4.m4.1.1.1.cmml" xref="S2.SS1.p1.4.m4.1.1">subscript</csymbol><ci id="S2.SS1.p1.4.m4.1.1.2.cmml" xref="S2.SS1.p1.4.m4.1.1.2">𝜃</ci><ci id="S2.SS1.p1.4.m4.1.1.3.cmml" xref="S2.SS1.p1.4.m4.1.1.3">𝐿</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p1.4.m4.1c">\theta_{L}</annotation></semantics></math> and <math id="S2.SS1.p1.5.m5.1" class="ltx_Math" alttext="\theta_{H}" display="inline"><semantics id="S2.SS1.p1.5.m5.1a"><msub id="S2.SS1.p1.5.m5.1.1" xref="S2.SS1.p1.5.m5.1.1.cmml"><mi id="S2.SS1.p1.5.m5.1.1.2" xref="S2.SS1.p1.5.m5.1.1.2.cmml">θ</mi><mi id="S2.SS1.p1.5.m5.1.1.3" xref="S2.SS1.p1.5.m5.1.1.3.cmml">H</mi></msub><annotation-xml encoding="MathML-Content" id="S2.SS1.p1.5.m5.1b"><apply id="S2.SS1.p1.5.m5.1.1.cmml" xref="S2.SS1.p1.5.m5.1.1"><csymbol cd="ambiguous" id="S2.SS1.p1.5.m5.1.1.1.cmml" xref="S2.SS1.p1.5.m5.1.1">subscript</csymbol><ci id="S2.SS1.p1.5.m5.1.1.2.cmml" xref="S2.SS1.p1.5.m5.1.1.2">𝜃</ci><ci id="S2.SS1.p1.5.m5.1.1.3.cmml" xref="S2.SS1.p1.5.m5.1.1.3">𝐻</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p1.5.m5.1c">\theta_{H}</annotation></semantics></math> using the pool of clients <math id="S2.SS1.p1.6.m6.1" class="ltx_Math" alttext="\mathcal{P}" display="inline"><semantics id="S2.SS1.p1.6.m6.1a"><mi class="ltx_font_mathcaligraphic" id="S2.SS1.p1.6.m6.1.1" xref="S2.SS1.p1.6.m6.1.1.cmml">𝒫</mi><annotation-xml encoding="MathML-Content" id="S2.SS1.p1.6.m6.1b"><ci id="S2.SS1.p1.6.m6.1.1.cmml" xref="S2.SS1.p1.6.m6.1.1">𝒫</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p1.6.m6.1c">\mathcal{P}</annotation></semantics></math> and <math id="S2.SS1.p1.7.m7.1" class="ltx_Math" alttext="\mathcal{P}_{H}\subset\mathcal{P}" display="inline"><semantics id="S2.SS1.p1.7.m7.1a"><mrow id="S2.SS1.p1.7.m7.1.1" xref="S2.SS1.p1.7.m7.1.1.cmml"><msub id="S2.SS1.p1.7.m7.1.1.2" xref="S2.SS1.p1.7.m7.1.1.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S2.SS1.p1.7.m7.1.1.2.2" xref="S2.SS1.p1.7.m7.1.1.2.2.cmml">𝒫</mi><mi id="S2.SS1.p1.7.m7.1.1.2.3" xref="S2.SS1.p1.7.m7.1.1.2.3.cmml">H</mi></msub><mo id="S2.SS1.p1.7.m7.1.1.1" xref="S2.SS1.p1.7.m7.1.1.1.cmml">⊂</mo><mi class="ltx_font_mathcaligraphic" id="S2.SS1.p1.7.m7.1.1.3" xref="S2.SS1.p1.7.m7.1.1.3.cmml">𝒫</mi></mrow><annotation-xml encoding="MathML-Content" id="S2.SS1.p1.7.m7.1b"><apply id="S2.SS1.p1.7.m7.1.1.cmml" xref="S2.SS1.p1.7.m7.1.1"><subset id="S2.SS1.p1.7.m7.1.1.1.cmml" xref="S2.SS1.p1.7.m7.1.1.1"></subset><apply id="S2.SS1.p1.7.m7.1.1.2.cmml" xref="S2.SS1.p1.7.m7.1.1.2"><csymbol cd="ambiguous" id="S2.SS1.p1.7.m7.1.1.2.1.cmml" xref="S2.SS1.p1.7.m7.1.1.2">subscript</csymbol><ci id="S2.SS1.p1.7.m7.1.1.2.2.cmml" xref="S2.SS1.p1.7.m7.1.1.2.2">𝒫</ci><ci id="S2.SS1.p1.7.m7.1.1.2.3.cmml" xref="S2.SS1.p1.7.m7.1.1.2.3">𝐻</ci></apply><ci id="S2.SS1.p1.7.m7.1.1.3.cmml" xref="S2.SS1.p1.7.m7.1.1.3">𝒫</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p1.7.m7.1c">\mathcal{P}_{H}\subset\mathcal{P}</annotation></semantics></math>, respectively. However, we pause the process every <math id="S2.SS1.p1.8.m8.1" class="ltx_Math" alttext="p" display="inline"><semantics id="S2.SS1.p1.8.m8.1a"><mi id="S2.SS1.p1.8.m8.1.1" xref="S2.SS1.p1.8.m8.1.1.cmml">p</mi><annotation-xml encoding="MathML-Content" id="S2.SS1.p1.8.m8.1b"><ci id="S2.SS1.p1.8.m8.1.1.cmml" xref="S2.SS1.p1.8.m8.1.1">𝑝</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p1.8.m8.1c">p</annotation></semantics></math> rounds and perform codistillation for <math id="S2.SS1.p1.9.m9.1" class="ltx_Math" alttext="s" display="inline"><semantics id="S2.SS1.p1.9.m9.1a"><mi id="S2.SS1.p1.9.m9.1.1" xref="S2.SS1.p1.9.m9.1.1.cmml">s</mi><annotation-xml encoding="MathML-Content" id="S2.SS1.p1.9.m9.1b"><ci id="S2.SS1.p1.9.m9.1.1.cmml" xref="S2.SS1.p1.9.m9.1.1">𝑠</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p1.9.m9.1c">s</annotation></semantics></math> steps. The codistillation round involves creating a copy of each model <math id="S2.SS1.p1.10.m10.1" class="ltx_Math" alttext="\theta_{L}^{t}" display="inline"><semantics id="S2.SS1.p1.10.m10.1a"><msubsup id="S2.SS1.p1.10.m10.1.1" xref="S2.SS1.p1.10.m10.1.1.cmml"><mi id="S2.SS1.p1.10.m10.1.1.2.2" xref="S2.SS1.p1.10.m10.1.1.2.2.cmml">θ</mi><mi id="S2.SS1.p1.10.m10.1.1.2.3" xref="S2.SS1.p1.10.m10.1.1.2.3.cmml">L</mi><mi id="S2.SS1.p1.10.m10.1.1.3" xref="S2.SS1.p1.10.m10.1.1.3.cmml">t</mi></msubsup><annotation-xml encoding="MathML-Content" id="S2.SS1.p1.10.m10.1b"><apply id="S2.SS1.p1.10.m10.1.1.cmml" xref="S2.SS1.p1.10.m10.1.1"><csymbol cd="ambiguous" id="S2.SS1.p1.10.m10.1.1.1.cmml" xref="S2.SS1.p1.10.m10.1.1">superscript</csymbol><apply id="S2.SS1.p1.10.m10.1.1.2.cmml" xref="S2.SS1.p1.10.m10.1.1"><csymbol cd="ambiguous" id="S2.SS1.p1.10.m10.1.1.2.1.cmml" xref="S2.SS1.p1.10.m10.1.1">subscript</csymbol><ci id="S2.SS1.p1.10.m10.1.1.2.2.cmml" xref="S2.SS1.p1.10.m10.1.1.2.2">𝜃</ci><ci id="S2.SS1.p1.10.m10.1.1.2.3.cmml" xref="S2.SS1.p1.10.m10.1.1.2.3">𝐿</ci></apply><ci id="S2.SS1.p1.10.m10.1.1.3.cmml" xref="S2.SS1.p1.10.m10.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p1.10.m10.1c">\theta_{L}^{t}</annotation></semantics></math> and <math id="S2.SS1.p1.11.m11.1" class="ltx_Math" alttext="\theta_{H}^{t}" display="inline"><semantics id="S2.SS1.p1.11.m11.1a"><msubsup id="S2.SS1.p1.11.m11.1.1" xref="S2.SS1.p1.11.m11.1.1.cmml"><mi id="S2.SS1.p1.11.m11.1.1.2.2" xref="S2.SS1.p1.11.m11.1.1.2.2.cmml">θ</mi><mi id="S2.SS1.p1.11.m11.1.1.2.3" xref="S2.SS1.p1.11.m11.1.1.2.3.cmml">H</mi><mi id="S2.SS1.p1.11.m11.1.1.3" xref="S2.SS1.p1.11.m11.1.1.3.cmml">t</mi></msubsup><annotation-xml encoding="MathML-Content" id="S2.SS1.p1.11.m11.1b"><apply id="S2.SS1.p1.11.m11.1.1.cmml" xref="S2.SS1.p1.11.m11.1.1"><csymbol cd="ambiguous" id="S2.SS1.p1.11.m11.1.1.1.cmml" xref="S2.SS1.p1.11.m11.1.1">superscript</csymbol><apply id="S2.SS1.p1.11.m11.1.1.2.cmml" xref="S2.SS1.p1.11.m11.1.1"><csymbol cd="ambiguous" id="S2.SS1.p1.11.m11.1.1.2.1.cmml" xref="S2.SS1.p1.11.m11.1.1">subscript</csymbol><ci id="S2.SS1.p1.11.m11.1.1.2.2.cmml" xref="S2.SS1.p1.11.m11.1.1.2.2">𝜃</ci><ci id="S2.SS1.p1.11.m11.1.1.2.3.cmml" xref="S2.SS1.p1.11.m11.1.1.2.3">𝐻</ci></apply><ci id="S2.SS1.p1.11.m11.1.1.3.cmml" xref="S2.SS1.p1.11.m11.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p1.11.m11.1c">\theta_{H}^{t}</annotation></semantics></math> at round <math id="S2.SS1.p1.12.m12.1" class="ltx_Math" alttext="t=kp" display="inline"><semantics id="S2.SS1.p1.12.m12.1a"><mrow id="S2.SS1.p1.12.m12.1.1" xref="S2.SS1.p1.12.m12.1.1.cmml"><mi id="S2.SS1.p1.12.m12.1.1.2" xref="S2.SS1.p1.12.m12.1.1.2.cmml">t</mi><mo id="S2.SS1.p1.12.m12.1.1.1" xref="S2.SS1.p1.12.m12.1.1.1.cmml">=</mo><mrow id="S2.SS1.p1.12.m12.1.1.3" xref="S2.SS1.p1.12.m12.1.1.3.cmml"><mi id="S2.SS1.p1.12.m12.1.1.3.2" xref="S2.SS1.p1.12.m12.1.1.3.2.cmml">k</mi><mo lspace="0em" rspace="0em" id="S2.SS1.p1.12.m12.1.1.3.1" xref="S2.SS1.p1.12.m12.1.1.3.1.cmml">​</mo><mi id="S2.SS1.p1.12.m12.1.1.3.3" xref="S2.SS1.p1.12.m12.1.1.3.3.cmml">p</mi></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.SS1.p1.12.m12.1b"><apply id="S2.SS1.p1.12.m12.1.1.cmml" xref="S2.SS1.p1.12.m12.1.1"><eq id="S2.SS1.p1.12.m12.1.1.1.cmml" xref="S2.SS1.p1.12.m12.1.1.1"></eq><ci id="S2.SS1.p1.12.m12.1.1.2.cmml" xref="S2.SS1.p1.12.m12.1.1.2">𝑡</ci><apply id="S2.SS1.p1.12.m12.1.1.3.cmml" xref="S2.SS1.p1.12.m12.1.1.3"><times id="S2.SS1.p1.12.m12.1.1.3.1.cmml" xref="S2.SS1.p1.12.m12.1.1.3.1"></times><ci id="S2.SS1.p1.12.m12.1.1.3.2.cmml" xref="S2.SS1.p1.12.m12.1.1.3.2">𝑘</ci><ci id="S2.SS1.p1.12.m12.1.1.3.3.cmml" xref="S2.SS1.p1.12.m12.1.1.3.3">𝑝</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p1.12.m12.1c">t=kp</annotation></semantics></math>, where <math id="S2.SS1.p1.13.m13.1" class="ltx_Math" alttext="k\in\mathbb{N}" display="inline"><semantics id="S2.SS1.p1.13.m13.1a"><mrow id="S2.SS1.p1.13.m13.1.1" xref="S2.SS1.p1.13.m13.1.1.cmml"><mi id="S2.SS1.p1.13.m13.1.1.2" xref="S2.SS1.p1.13.m13.1.1.2.cmml">k</mi><mo id="S2.SS1.p1.13.m13.1.1.1" xref="S2.SS1.p1.13.m13.1.1.1.cmml">∈</mo><mi id="S2.SS1.p1.13.m13.1.1.3" xref="S2.SS1.p1.13.m13.1.1.3.cmml">ℕ</mi></mrow><annotation-xml encoding="MathML-Content" id="S2.SS1.p1.13.m13.1b"><apply id="S2.SS1.p1.13.m13.1.1.cmml" xref="S2.SS1.p1.13.m13.1.1"><in id="S2.SS1.p1.13.m13.1.1.1.cmml" xref="S2.SS1.p1.13.m13.1.1.1"></in><ci id="S2.SS1.p1.13.m13.1.1.2.cmml" xref="S2.SS1.p1.13.m13.1.1.2">𝑘</ci><ci id="S2.SS1.p1.13.m13.1.1.3.cmml" xref="S2.SS1.p1.13.m13.1.1.3">ℕ</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p1.13.m13.1c">k\in\mathbb{N}</annotation></semantics></math>, to serve as a teacher for distilling information to the other model.</p>
</div>
<div id="S2.SS1.p2" class="ltx_para">
<p id="S2.SS1.p2.12" class="ltx_p">Let <math id="S2.SS1.p2.1.m1.1" class="ltx_Math" alttext="\theta_{L}^{\text{\tiny student}}" display="inline"><semantics id="S2.SS1.p2.1.m1.1a"><msubsup id="S2.SS1.p2.1.m1.1.1" xref="S2.SS1.p2.1.m1.1.1.cmml"><mi id="S2.SS1.p2.1.m1.1.1.2.2" xref="S2.SS1.p2.1.m1.1.1.2.2.cmml">θ</mi><mi id="S2.SS1.p2.1.m1.1.1.2.3" xref="S2.SS1.p2.1.m1.1.1.2.3.cmml">L</mi><mtext mathsize="71%" id="S2.SS1.p2.1.m1.1.1.3" xref="S2.SS1.p2.1.m1.1.1.3a.cmml">student</mtext></msubsup><annotation-xml encoding="MathML-Content" id="S2.SS1.p2.1.m1.1b"><apply id="S2.SS1.p2.1.m1.1.1.cmml" xref="S2.SS1.p2.1.m1.1.1"><csymbol cd="ambiguous" id="S2.SS1.p2.1.m1.1.1.1.cmml" xref="S2.SS1.p2.1.m1.1.1">superscript</csymbol><apply id="S2.SS1.p2.1.m1.1.1.2.cmml" xref="S2.SS1.p2.1.m1.1.1"><csymbol cd="ambiguous" id="S2.SS1.p2.1.m1.1.1.2.1.cmml" xref="S2.SS1.p2.1.m1.1.1">subscript</csymbol><ci id="S2.SS1.p2.1.m1.1.1.2.2.cmml" xref="S2.SS1.p2.1.m1.1.1.2.2">𝜃</ci><ci id="S2.SS1.p2.1.m1.1.1.2.3.cmml" xref="S2.SS1.p2.1.m1.1.1.2.3">𝐿</ci></apply><ci id="S2.SS1.p2.1.m1.1.1.3a.cmml" xref="S2.SS1.p2.1.m1.1.1.3"><mtext mathsize="50%" id="S2.SS1.p2.1.m1.1.1.3.cmml" xref="S2.SS1.p2.1.m1.1.1.3">student</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p2.1.m1.1c">\theta_{L}^{\text{\tiny student}}</annotation></semantics></math> and <math id="S2.SS1.p2.2.m2.1" class="ltx_Math" alttext="\theta_{H}^{\text{\tiny student}}" display="inline"><semantics id="S2.SS1.p2.2.m2.1a"><msubsup id="S2.SS1.p2.2.m2.1.1" xref="S2.SS1.p2.2.m2.1.1.cmml"><mi id="S2.SS1.p2.2.m2.1.1.2.2" xref="S2.SS1.p2.2.m2.1.1.2.2.cmml">θ</mi><mi id="S2.SS1.p2.2.m2.1.1.2.3" xref="S2.SS1.p2.2.m2.1.1.2.3.cmml">H</mi><mtext mathsize="71%" id="S2.SS1.p2.2.m2.1.1.3" xref="S2.SS1.p2.2.m2.1.1.3a.cmml">student</mtext></msubsup><annotation-xml encoding="MathML-Content" id="S2.SS1.p2.2.m2.1b"><apply id="S2.SS1.p2.2.m2.1.1.cmml" xref="S2.SS1.p2.2.m2.1.1"><csymbol cd="ambiguous" id="S2.SS1.p2.2.m2.1.1.1.cmml" xref="S2.SS1.p2.2.m2.1.1">superscript</csymbol><apply id="S2.SS1.p2.2.m2.1.1.2.cmml" xref="S2.SS1.p2.2.m2.1.1"><csymbol cd="ambiguous" id="S2.SS1.p2.2.m2.1.1.2.1.cmml" xref="S2.SS1.p2.2.m2.1.1">subscript</csymbol><ci id="S2.SS1.p2.2.m2.1.1.2.2.cmml" xref="S2.SS1.p2.2.m2.1.1.2.2">𝜃</ci><ci id="S2.SS1.p2.2.m2.1.1.2.3.cmml" xref="S2.SS1.p2.2.m2.1.1.2.3">𝐻</ci></apply><ci id="S2.SS1.p2.2.m2.1.1.3a.cmml" xref="S2.SS1.p2.2.m2.1.1.3"><mtext mathsize="50%" id="S2.SS1.p2.2.m2.1.1.3.cmml" xref="S2.SS1.p2.2.m2.1.1.3">student</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p2.2.m2.1c">\theta_{H}^{\text{\tiny student}}</annotation></semantics></math> respectively denote the updated student models after codistillation, starting from <math id="S2.SS1.p2.3.m3.1" class="ltx_Math" alttext="\theta_{L}^{t}" display="inline"><semantics id="S2.SS1.p2.3.m3.1a"><msubsup id="S2.SS1.p2.3.m3.1.1" xref="S2.SS1.p2.3.m3.1.1.cmml"><mi id="S2.SS1.p2.3.m3.1.1.2.2" xref="S2.SS1.p2.3.m3.1.1.2.2.cmml">θ</mi><mi id="S2.SS1.p2.3.m3.1.1.2.3" xref="S2.SS1.p2.3.m3.1.1.2.3.cmml">L</mi><mi id="S2.SS1.p2.3.m3.1.1.3" xref="S2.SS1.p2.3.m3.1.1.3.cmml">t</mi></msubsup><annotation-xml encoding="MathML-Content" id="S2.SS1.p2.3.m3.1b"><apply id="S2.SS1.p2.3.m3.1.1.cmml" xref="S2.SS1.p2.3.m3.1.1"><csymbol cd="ambiguous" id="S2.SS1.p2.3.m3.1.1.1.cmml" xref="S2.SS1.p2.3.m3.1.1">superscript</csymbol><apply id="S2.SS1.p2.3.m3.1.1.2.cmml" xref="S2.SS1.p2.3.m3.1.1"><csymbol cd="ambiguous" id="S2.SS1.p2.3.m3.1.1.2.1.cmml" xref="S2.SS1.p2.3.m3.1.1">subscript</csymbol><ci id="S2.SS1.p2.3.m3.1.1.2.2.cmml" xref="S2.SS1.p2.3.m3.1.1.2.2">𝜃</ci><ci id="S2.SS1.p2.3.m3.1.1.2.3.cmml" xref="S2.SS1.p2.3.m3.1.1.2.3">𝐿</ci></apply><ci id="S2.SS1.p2.3.m3.1.1.3.cmml" xref="S2.SS1.p2.3.m3.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p2.3.m3.1c">\theta_{L}^{t}</annotation></semantics></math> and <math id="S2.SS1.p2.4.m4.1" class="ltx_Math" alttext="\theta_{H}^{t}" display="inline"><semantics id="S2.SS1.p2.4.m4.1a"><msubsup id="S2.SS1.p2.4.m4.1.1" xref="S2.SS1.p2.4.m4.1.1.cmml"><mi id="S2.SS1.p2.4.m4.1.1.2.2" xref="S2.SS1.p2.4.m4.1.1.2.2.cmml">θ</mi><mi id="S2.SS1.p2.4.m4.1.1.2.3" xref="S2.SS1.p2.4.m4.1.1.2.3.cmml">H</mi><mi id="S2.SS1.p2.4.m4.1.1.3" xref="S2.SS1.p2.4.m4.1.1.3.cmml">t</mi></msubsup><annotation-xml encoding="MathML-Content" id="S2.SS1.p2.4.m4.1b"><apply id="S2.SS1.p2.4.m4.1.1.cmml" xref="S2.SS1.p2.4.m4.1.1"><csymbol cd="ambiguous" id="S2.SS1.p2.4.m4.1.1.1.cmml" xref="S2.SS1.p2.4.m4.1.1">superscript</csymbol><apply id="S2.SS1.p2.4.m4.1.1.2.cmml" xref="S2.SS1.p2.4.m4.1.1"><csymbol cd="ambiguous" id="S2.SS1.p2.4.m4.1.1.2.1.cmml" xref="S2.SS1.p2.4.m4.1.1">subscript</csymbol><ci id="S2.SS1.p2.4.m4.1.1.2.2.cmml" xref="S2.SS1.p2.4.m4.1.1.2.2">𝜃</ci><ci id="S2.SS1.p2.4.m4.1.1.2.3.cmml" xref="S2.SS1.p2.4.m4.1.1.2.3">𝐻</ci></apply><ci id="S2.SS1.p2.4.m4.1.1.3.cmml" xref="S2.SS1.p2.4.m4.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p2.4.m4.1c">\theta_{H}^{t}</annotation></semantics></math> at round <math id="S2.SS1.p2.5.m5.1" class="ltx_Math" alttext="t" display="inline"><semantics id="S2.SS1.p2.5.m5.1a"><mi id="S2.SS1.p2.5.m5.1.1" xref="S2.SS1.p2.5.m5.1.1.cmml">t</mi><annotation-xml encoding="MathML-Content" id="S2.SS1.p2.5.m5.1b"><ci id="S2.SS1.p2.5.m5.1.1.cmml" xref="S2.SS1.p2.5.m5.1.1">𝑡</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p2.5.m5.1c">t</annotation></semantics></math>, using teachers <math id="S2.SS1.p2.6.m6.1" class="ltx_Math" alttext="\theta_{H}^{\text{\tiny teacher}}" display="inline"><semantics id="S2.SS1.p2.6.m6.1a"><msubsup id="S2.SS1.p2.6.m6.1.1" xref="S2.SS1.p2.6.m6.1.1.cmml"><mi id="S2.SS1.p2.6.m6.1.1.2.2" xref="S2.SS1.p2.6.m6.1.1.2.2.cmml">θ</mi><mi id="S2.SS1.p2.6.m6.1.1.2.3" xref="S2.SS1.p2.6.m6.1.1.2.3.cmml">H</mi><mtext mathsize="71%" id="S2.SS1.p2.6.m6.1.1.3" xref="S2.SS1.p2.6.m6.1.1.3a.cmml">teacher</mtext></msubsup><annotation-xml encoding="MathML-Content" id="S2.SS1.p2.6.m6.1b"><apply id="S2.SS1.p2.6.m6.1.1.cmml" xref="S2.SS1.p2.6.m6.1.1"><csymbol cd="ambiguous" id="S2.SS1.p2.6.m6.1.1.1.cmml" xref="S2.SS1.p2.6.m6.1.1">superscript</csymbol><apply id="S2.SS1.p2.6.m6.1.1.2.cmml" xref="S2.SS1.p2.6.m6.1.1"><csymbol cd="ambiguous" id="S2.SS1.p2.6.m6.1.1.2.1.cmml" xref="S2.SS1.p2.6.m6.1.1">subscript</csymbol><ci id="S2.SS1.p2.6.m6.1.1.2.2.cmml" xref="S2.SS1.p2.6.m6.1.1.2.2">𝜃</ci><ci id="S2.SS1.p2.6.m6.1.1.2.3.cmml" xref="S2.SS1.p2.6.m6.1.1.2.3">𝐻</ci></apply><ci id="S2.SS1.p2.6.m6.1.1.3a.cmml" xref="S2.SS1.p2.6.m6.1.1.3"><mtext mathsize="50%" id="S2.SS1.p2.6.m6.1.1.3.cmml" xref="S2.SS1.p2.6.m6.1.1.3">teacher</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p2.6.m6.1c">\theta_{H}^{\text{\tiny teacher}}</annotation></semantics></math> and <math id="S2.SS1.p2.7.m7.1" class="ltx_Math" alttext="\theta_{L}^{\text{\tiny teacher}}" display="inline"><semantics id="S2.SS1.p2.7.m7.1a"><msubsup id="S2.SS1.p2.7.m7.1.1" xref="S2.SS1.p2.7.m7.1.1.cmml"><mi id="S2.SS1.p2.7.m7.1.1.2.2" xref="S2.SS1.p2.7.m7.1.1.2.2.cmml">θ</mi><mi id="S2.SS1.p2.7.m7.1.1.2.3" xref="S2.SS1.p2.7.m7.1.1.2.3.cmml">L</mi><mtext mathsize="71%" id="S2.SS1.p2.7.m7.1.1.3" xref="S2.SS1.p2.7.m7.1.1.3a.cmml">teacher</mtext></msubsup><annotation-xml encoding="MathML-Content" id="S2.SS1.p2.7.m7.1b"><apply id="S2.SS1.p2.7.m7.1.1.cmml" xref="S2.SS1.p2.7.m7.1.1"><csymbol cd="ambiguous" id="S2.SS1.p2.7.m7.1.1.1.cmml" xref="S2.SS1.p2.7.m7.1.1">superscript</csymbol><apply id="S2.SS1.p2.7.m7.1.1.2.cmml" xref="S2.SS1.p2.7.m7.1.1"><csymbol cd="ambiguous" id="S2.SS1.p2.7.m7.1.1.2.1.cmml" xref="S2.SS1.p2.7.m7.1.1">subscript</csymbol><ci id="S2.SS1.p2.7.m7.1.1.2.2.cmml" xref="S2.SS1.p2.7.m7.1.1.2.2">𝜃</ci><ci id="S2.SS1.p2.7.m7.1.1.2.3.cmml" xref="S2.SS1.p2.7.m7.1.1.2.3">𝐿</ci></apply><ci id="S2.SS1.p2.7.m7.1.1.3a.cmml" xref="S2.SS1.p2.7.m7.1.1.3"><mtext mathsize="50%" id="S2.SS1.p2.7.m7.1.1.3.cmml" xref="S2.SS1.p2.7.m7.1.1.3">teacher</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p2.7.m7.1c">\theta_{L}^{\text{\tiny teacher}}</annotation></semantics></math>. At the end of the codistillation round, we replace <math id="S2.SS1.p2.8.m8.1" class="ltx_Math" alttext="\theta_{L}^{t}" display="inline"><semantics id="S2.SS1.p2.8.m8.1a"><msubsup id="S2.SS1.p2.8.m8.1.1" xref="S2.SS1.p2.8.m8.1.1.cmml"><mi id="S2.SS1.p2.8.m8.1.1.2.2" xref="S2.SS1.p2.8.m8.1.1.2.2.cmml">θ</mi><mi id="S2.SS1.p2.8.m8.1.1.2.3" xref="S2.SS1.p2.8.m8.1.1.2.3.cmml">L</mi><mi id="S2.SS1.p2.8.m8.1.1.3" xref="S2.SS1.p2.8.m8.1.1.3.cmml">t</mi></msubsup><annotation-xml encoding="MathML-Content" id="S2.SS1.p2.8.m8.1b"><apply id="S2.SS1.p2.8.m8.1.1.cmml" xref="S2.SS1.p2.8.m8.1.1"><csymbol cd="ambiguous" id="S2.SS1.p2.8.m8.1.1.1.cmml" xref="S2.SS1.p2.8.m8.1.1">superscript</csymbol><apply id="S2.SS1.p2.8.m8.1.1.2.cmml" xref="S2.SS1.p2.8.m8.1.1"><csymbol cd="ambiguous" id="S2.SS1.p2.8.m8.1.1.2.1.cmml" xref="S2.SS1.p2.8.m8.1.1">subscript</csymbol><ci id="S2.SS1.p2.8.m8.1.1.2.2.cmml" xref="S2.SS1.p2.8.m8.1.1.2.2">𝜃</ci><ci id="S2.SS1.p2.8.m8.1.1.2.3.cmml" xref="S2.SS1.p2.8.m8.1.1.2.3">𝐿</ci></apply><ci id="S2.SS1.p2.8.m8.1.1.3.cmml" xref="S2.SS1.p2.8.m8.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p2.8.m8.1c">\theta_{L}^{t}</annotation></semantics></math> (<math id="S2.SS1.p2.9.m9.1" class="ltx_Math" alttext="\theta_{H}^{t}" display="inline"><semantics id="S2.SS1.p2.9.m9.1a"><msubsup id="S2.SS1.p2.9.m9.1.1" xref="S2.SS1.p2.9.m9.1.1.cmml"><mi id="S2.SS1.p2.9.m9.1.1.2.2" xref="S2.SS1.p2.9.m9.1.1.2.2.cmml">θ</mi><mi id="S2.SS1.p2.9.m9.1.1.2.3" xref="S2.SS1.p2.9.m9.1.1.2.3.cmml">H</mi><mi id="S2.SS1.p2.9.m9.1.1.3" xref="S2.SS1.p2.9.m9.1.1.3.cmml">t</mi></msubsup><annotation-xml encoding="MathML-Content" id="S2.SS1.p2.9.m9.1b"><apply id="S2.SS1.p2.9.m9.1.1.cmml" xref="S2.SS1.p2.9.m9.1.1"><csymbol cd="ambiguous" id="S2.SS1.p2.9.m9.1.1.1.cmml" xref="S2.SS1.p2.9.m9.1.1">superscript</csymbol><apply id="S2.SS1.p2.9.m9.1.1.2.cmml" xref="S2.SS1.p2.9.m9.1.1"><csymbol cd="ambiguous" id="S2.SS1.p2.9.m9.1.1.2.1.cmml" xref="S2.SS1.p2.9.m9.1.1">subscript</csymbol><ci id="S2.SS1.p2.9.m9.1.1.2.2.cmml" xref="S2.SS1.p2.9.m9.1.1.2.2">𝜃</ci><ci id="S2.SS1.p2.9.m9.1.1.2.3.cmml" xref="S2.SS1.p2.9.m9.1.1.2.3">𝐻</ci></apply><ci id="S2.SS1.p2.9.m9.1.1.3.cmml" xref="S2.SS1.p2.9.m9.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p2.9.m9.1c">\theta_{H}^{t}</annotation></semantics></math>) by <math id="S2.SS1.p2.10.m10.1" class="ltx_Math" alttext="\theta_{L}^{\text{\tiny student}}" display="inline"><semantics id="S2.SS1.p2.10.m10.1a"><msubsup id="S2.SS1.p2.10.m10.1.1" xref="S2.SS1.p2.10.m10.1.1.cmml"><mi id="S2.SS1.p2.10.m10.1.1.2.2" xref="S2.SS1.p2.10.m10.1.1.2.2.cmml">θ</mi><mi id="S2.SS1.p2.10.m10.1.1.2.3" xref="S2.SS1.p2.10.m10.1.1.2.3.cmml">L</mi><mtext mathsize="71%" id="S2.SS1.p2.10.m10.1.1.3" xref="S2.SS1.p2.10.m10.1.1.3a.cmml">student</mtext></msubsup><annotation-xml encoding="MathML-Content" id="S2.SS1.p2.10.m10.1b"><apply id="S2.SS1.p2.10.m10.1.1.cmml" xref="S2.SS1.p2.10.m10.1.1"><csymbol cd="ambiguous" id="S2.SS1.p2.10.m10.1.1.1.cmml" xref="S2.SS1.p2.10.m10.1.1">superscript</csymbol><apply id="S2.SS1.p2.10.m10.1.1.2.cmml" xref="S2.SS1.p2.10.m10.1.1"><csymbol cd="ambiguous" id="S2.SS1.p2.10.m10.1.1.2.1.cmml" xref="S2.SS1.p2.10.m10.1.1">subscript</csymbol><ci id="S2.SS1.p2.10.m10.1.1.2.2.cmml" xref="S2.SS1.p2.10.m10.1.1.2.2">𝜃</ci><ci id="S2.SS1.p2.10.m10.1.1.2.3.cmml" xref="S2.SS1.p2.10.m10.1.1.2.3">𝐿</ci></apply><ci id="S2.SS1.p2.10.m10.1.1.3a.cmml" xref="S2.SS1.p2.10.m10.1.1.3"><mtext mathsize="50%" id="S2.SS1.p2.10.m10.1.1.3.cmml" xref="S2.SS1.p2.10.m10.1.1.3">student</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p2.10.m10.1c">\theta_{L}^{\text{\tiny student}}</annotation></semantics></math> (<math id="S2.SS1.p2.11.m11.1" class="ltx_Math" alttext="\theta_{H}^{\text{\tiny student}}" display="inline"><semantics id="S2.SS1.p2.11.m11.1a"><msubsup id="S2.SS1.p2.11.m11.1.1" xref="S2.SS1.p2.11.m11.1.1.cmml"><mi id="S2.SS1.p2.11.m11.1.1.2.2" xref="S2.SS1.p2.11.m11.1.1.2.2.cmml">θ</mi><mi id="S2.SS1.p2.11.m11.1.1.2.3" xref="S2.SS1.p2.11.m11.1.1.2.3.cmml">H</mi><mtext mathsize="71%" id="S2.SS1.p2.11.m11.1.1.3" xref="S2.SS1.p2.11.m11.1.1.3a.cmml">student</mtext></msubsup><annotation-xml encoding="MathML-Content" id="S2.SS1.p2.11.m11.1b"><apply id="S2.SS1.p2.11.m11.1.1.cmml" xref="S2.SS1.p2.11.m11.1.1"><csymbol cd="ambiguous" id="S2.SS1.p2.11.m11.1.1.1.cmml" xref="S2.SS1.p2.11.m11.1.1">superscript</csymbol><apply id="S2.SS1.p2.11.m11.1.1.2.cmml" xref="S2.SS1.p2.11.m11.1.1"><csymbol cd="ambiguous" id="S2.SS1.p2.11.m11.1.1.2.1.cmml" xref="S2.SS1.p2.11.m11.1.1">subscript</csymbol><ci id="S2.SS1.p2.11.m11.1.1.2.2.cmml" xref="S2.SS1.p2.11.m11.1.1.2.2">𝜃</ci><ci id="S2.SS1.p2.11.m11.1.1.2.3.cmml" xref="S2.SS1.p2.11.m11.1.1.2.3">𝐻</ci></apply><ci id="S2.SS1.p2.11.m11.1.1.3a.cmml" xref="S2.SS1.p2.11.m11.1.1.3"><mtext mathsize="50%" id="S2.SS1.p2.11.m11.1.1.3.cmml" xref="S2.SS1.p2.11.m11.1.1.3">student</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p2.11.m11.1c">\theta_{H}^{\text{\tiny student}}</annotation></semantics></math>) and continue training the models using <span id="S2.SS1.p2.12.1" class="ltx_text ltx_font_smallcaps">FedAvg</span> at round <math id="S2.SS1.p2.12.m12.1" class="ltx_Math" alttext="t+1" display="inline"><semantics id="S2.SS1.p2.12.m12.1a"><mrow id="S2.SS1.p2.12.m12.1.1" xref="S2.SS1.p2.12.m12.1.1.cmml"><mi id="S2.SS1.p2.12.m12.1.1.2" xref="S2.SS1.p2.12.m12.1.1.2.cmml">t</mi><mo id="S2.SS1.p2.12.m12.1.1.1" xref="S2.SS1.p2.12.m12.1.1.1.cmml">+</mo><mn id="S2.SS1.p2.12.m12.1.1.3" xref="S2.SS1.p2.12.m12.1.1.3.cmml">1</mn></mrow><annotation-xml encoding="MathML-Content" id="S2.SS1.p2.12.m12.1b"><apply id="S2.SS1.p2.12.m12.1.1.cmml" xref="S2.SS1.p2.12.m12.1.1"><plus id="S2.SS1.p2.12.m12.1.1.1.cmml" xref="S2.SS1.p2.12.m12.1.1.1"></plus><ci id="S2.SS1.p2.12.m12.1.1.2.cmml" xref="S2.SS1.p2.12.m12.1.1.2">𝑡</ci><cn type="integer" id="S2.SS1.p2.12.m12.1.1.3.cmml" xref="S2.SS1.p2.12.m12.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS1.p2.12.m12.1c">t+1</annotation></semantics></math>. The <span id="S2.SS1.p2.12.2" class="ltx_text ltx_font_smallcaps">PeriodicCodist</span> strategy is summarized in Algorithm <a href="#alg1" title="Algorithm 1 ‣ Appendix B Methods ‣ Heterogeneous Federated Learning Using Knowledge Codistillation" class="ltx_ref"><span class="ltx_text ltx_ref_tag">1</span></a> and illustrated in Figure <a href="#A2.F2" title="Figure 2 ‣ Appendix B Methods ‣ Heterogeneous Federated Learning Using Knowledge Codistillation" class="ltx_ref"><span class="ltx_text ltx_ref_tag">2</span></a>(a) in Appendix <a href="#A2" title="Appendix B Methods ‣ Heterogeneous Federated Learning Using Knowledge Codistillation" class="ltx_ref"><span class="ltx_text ltx_ref_tag">B</span></a>.</p>
</div>
</section>
<section id="S2.SS2" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">2.2 </span>Merged Gradient Codistillation (<span id="S2.SS2.1.1" class="ltx_text ltx_font_smallcaps">MergedCodist</span>)</h3>

<div id="S2.SS2.p1" class="ltx_para">
<p id="S2.SS2.p1.1" class="ltx_p">We consider an alternative strategy where we apply codistillation in conjunction with <span id="S2.SS2.p1.1.1" class="ltx_text ltx_font_smallcaps">FedAvg</span> at every round. To motivate our strategy, we note that <span id="S2.SS2.p1.1.2" class="ltx_text ltx_font_smallcaps">FedAvg</span> aggregates <em id="S2.SS2.p1.1.3" class="ltx_emph ltx_font_italic">model differences</em> from the clients participating in the round and treats the combined model difference as a single gradient to apply the update. We use a similar approach to treat the model difference obtained from applying a round of distillation as a gradient. By merging the two gradients, we can apply a single update to the model parameters at each round.</p>
</div>
<div id="S2.SS2.p2" class="ltx_para">
<p id="S2.SS2.p2.18" class="ltx_p">Similar to <span id="S2.SS2.p2.18.1" class="ltx_text ltx_font_smallcaps">PeriodicCodist</span>, we conduct <span id="S2.SS2.p2.18.2" class="ltx_text ltx_font_smallcaps">FedAvg</span> independently for <math id="S2.SS2.p2.1.m1.1" class="ltx_Math" alttext="\theta_{L}" display="inline"><semantics id="S2.SS2.p2.1.m1.1a"><msub id="S2.SS2.p2.1.m1.1.1" xref="S2.SS2.p2.1.m1.1.1.cmml"><mi id="S2.SS2.p2.1.m1.1.1.2" xref="S2.SS2.p2.1.m1.1.1.2.cmml">θ</mi><mi id="S2.SS2.p2.1.m1.1.1.3" xref="S2.SS2.p2.1.m1.1.1.3.cmml">L</mi></msub><annotation-xml encoding="MathML-Content" id="S2.SS2.p2.1.m1.1b"><apply id="S2.SS2.p2.1.m1.1.1.cmml" xref="S2.SS2.p2.1.m1.1.1"><csymbol cd="ambiguous" id="S2.SS2.p2.1.m1.1.1.1.cmml" xref="S2.SS2.p2.1.m1.1.1">subscript</csymbol><ci id="S2.SS2.p2.1.m1.1.1.2.cmml" xref="S2.SS2.p2.1.m1.1.1.2">𝜃</ci><ci id="S2.SS2.p2.1.m1.1.1.3.cmml" xref="S2.SS2.p2.1.m1.1.1.3">𝐿</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p2.1.m1.1c">\theta_{L}</annotation></semantics></math> and <math id="S2.SS2.p2.2.m2.1" class="ltx_Math" alttext="\theta_{H}" display="inline"><semantics id="S2.SS2.p2.2.m2.1a"><msub id="S2.SS2.p2.2.m2.1.1" xref="S2.SS2.p2.2.m2.1.1.cmml"><mi id="S2.SS2.p2.2.m2.1.1.2" xref="S2.SS2.p2.2.m2.1.1.2.cmml">θ</mi><mi id="S2.SS2.p2.2.m2.1.1.3" xref="S2.SS2.p2.2.m2.1.1.3.cmml">H</mi></msub><annotation-xml encoding="MathML-Content" id="S2.SS2.p2.2.m2.1b"><apply id="S2.SS2.p2.2.m2.1.1.cmml" xref="S2.SS2.p2.2.m2.1.1"><csymbol cd="ambiguous" id="S2.SS2.p2.2.m2.1.1.1.cmml" xref="S2.SS2.p2.2.m2.1.1">subscript</csymbol><ci id="S2.SS2.p2.2.m2.1.1.2.cmml" xref="S2.SS2.p2.2.m2.1.1.2">𝜃</ci><ci id="S2.SS2.p2.2.m2.1.1.3.cmml" xref="S2.SS2.p2.2.m2.1.1.3">𝐻</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p2.2.m2.1c">\theta_{H}</annotation></semantics></math> using their respective pools of clients <math id="S2.SS2.p2.3.m3.1" class="ltx_Math" alttext="\mathcal{P}" display="inline"><semantics id="S2.SS2.p2.3.m3.1a"><mi class="ltx_font_mathcaligraphic" id="S2.SS2.p2.3.m3.1.1" xref="S2.SS2.p2.3.m3.1.1.cmml">𝒫</mi><annotation-xml encoding="MathML-Content" id="S2.SS2.p2.3.m3.1b"><ci id="S2.SS2.p2.3.m3.1.1.cmml" xref="S2.SS2.p2.3.m3.1.1">𝒫</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p2.3.m3.1c">\mathcal{P}</annotation></semantics></math> and <math id="S2.SS2.p2.4.m4.1" class="ltx_Math" alttext="\mathcal{P}_{H}\subset\mathcal{P}" display="inline"><semantics id="S2.SS2.p2.4.m4.1a"><mrow id="S2.SS2.p2.4.m4.1.1" xref="S2.SS2.p2.4.m4.1.1.cmml"><msub id="S2.SS2.p2.4.m4.1.1.2" xref="S2.SS2.p2.4.m4.1.1.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S2.SS2.p2.4.m4.1.1.2.2" xref="S2.SS2.p2.4.m4.1.1.2.2.cmml">𝒫</mi><mi id="S2.SS2.p2.4.m4.1.1.2.3" xref="S2.SS2.p2.4.m4.1.1.2.3.cmml">H</mi></msub><mo id="S2.SS2.p2.4.m4.1.1.1" xref="S2.SS2.p2.4.m4.1.1.1.cmml">⊂</mo><mi class="ltx_font_mathcaligraphic" id="S2.SS2.p2.4.m4.1.1.3" xref="S2.SS2.p2.4.m4.1.1.3.cmml">𝒫</mi></mrow><annotation-xml encoding="MathML-Content" id="S2.SS2.p2.4.m4.1b"><apply id="S2.SS2.p2.4.m4.1.1.cmml" xref="S2.SS2.p2.4.m4.1.1"><subset id="S2.SS2.p2.4.m4.1.1.1.cmml" xref="S2.SS2.p2.4.m4.1.1.1"></subset><apply id="S2.SS2.p2.4.m4.1.1.2.cmml" xref="S2.SS2.p2.4.m4.1.1.2"><csymbol cd="ambiguous" id="S2.SS2.p2.4.m4.1.1.2.1.cmml" xref="S2.SS2.p2.4.m4.1.1.2">subscript</csymbol><ci id="S2.SS2.p2.4.m4.1.1.2.2.cmml" xref="S2.SS2.p2.4.m4.1.1.2.2">𝒫</ci><ci id="S2.SS2.p2.4.m4.1.1.2.3.cmml" xref="S2.SS2.p2.4.m4.1.1.2.3">𝐻</ci></apply><ci id="S2.SS2.p2.4.m4.1.1.3.cmml" xref="S2.SS2.p2.4.m4.1.1.3">𝒫</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p2.4.m4.1c">\mathcal{P}_{H}\subset\mathcal{P}</annotation></semantics></math>. We denote the gradients obtained for the models <math id="S2.SS2.p2.5.m5.1" class="ltx_Math" alttext="\theta_{L}" display="inline"><semantics id="S2.SS2.p2.5.m5.1a"><msub id="S2.SS2.p2.5.m5.1.1" xref="S2.SS2.p2.5.m5.1.1.cmml"><mi id="S2.SS2.p2.5.m5.1.1.2" xref="S2.SS2.p2.5.m5.1.1.2.cmml">θ</mi><mi id="S2.SS2.p2.5.m5.1.1.3" xref="S2.SS2.p2.5.m5.1.1.3.cmml">L</mi></msub><annotation-xml encoding="MathML-Content" id="S2.SS2.p2.5.m5.1b"><apply id="S2.SS2.p2.5.m5.1.1.cmml" xref="S2.SS2.p2.5.m5.1.1"><csymbol cd="ambiguous" id="S2.SS2.p2.5.m5.1.1.1.cmml" xref="S2.SS2.p2.5.m5.1.1">subscript</csymbol><ci id="S2.SS2.p2.5.m5.1.1.2.cmml" xref="S2.SS2.p2.5.m5.1.1.2">𝜃</ci><ci id="S2.SS2.p2.5.m5.1.1.3.cmml" xref="S2.SS2.p2.5.m5.1.1.3">𝐿</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p2.5.m5.1c">\theta_{L}</annotation></semantics></math> and <math id="S2.SS2.p2.6.m6.1" class="ltx_Math" alttext="\theta_{H}" display="inline"><semantics id="S2.SS2.p2.6.m6.1a"><msub id="S2.SS2.p2.6.m6.1.1" xref="S2.SS2.p2.6.m6.1.1.cmml"><mi id="S2.SS2.p2.6.m6.1.1.2" xref="S2.SS2.p2.6.m6.1.1.2.cmml">θ</mi><mi id="S2.SS2.p2.6.m6.1.1.3" xref="S2.SS2.p2.6.m6.1.1.3.cmml">H</mi></msub><annotation-xml encoding="MathML-Content" id="S2.SS2.p2.6.m6.1b"><apply id="S2.SS2.p2.6.m6.1.1.cmml" xref="S2.SS2.p2.6.m6.1.1"><csymbol cd="ambiguous" id="S2.SS2.p2.6.m6.1.1.1.cmml" xref="S2.SS2.p2.6.m6.1.1">subscript</csymbol><ci id="S2.SS2.p2.6.m6.1.1.2.cmml" xref="S2.SS2.p2.6.m6.1.1.2">𝜃</ci><ci id="S2.SS2.p2.6.m6.1.1.3.cmml" xref="S2.SS2.p2.6.m6.1.1.3">𝐻</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p2.6.m6.1c">\theta_{H}</annotation></semantics></math> by aggregating the client gradients at round <math id="S2.SS2.p2.7.m7.1" class="ltx_Math" alttext="t" display="inline"><semantics id="S2.SS2.p2.7.m7.1a"><mi id="S2.SS2.p2.7.m7.1.1" xref="S2.SS2.p2.7.m7.1.1.cmml">t</mi><annotation-xml encoding="MathML-Content" id="S2.SS2.p2.7.m7.1b"><ci id="S2.SS2.p2.7.m7.1.1.cmml" xref="S2.SS2.p2.7.m7.1.1">𝑡</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p2.7.m7.1c">t</annotation></semantics></math>, as in vanilla <span id="S2.SS2.p2.18.3" class="ltx_text ltx_font_smallcaps">FedAvg</span>, as <math id="S2.SS2.p2.8.m8.1" class="ltx_Math" alttext="g^{t}_{L}" display="inline"><semantics id="S2.SS2.p2.8.m8.1a"><msubsup id="S2.SS2.p2.8.m8.1.1" xref="S2.SS2.p2.8.m8.1.1.cmml"><mi id="S2.SS2.p2.8.m8.1.1.2.2" xref="S2.SS2.p2.8.m8.1.1.2.2.cmml">g</mi><mi id="S2.SS2.p2.8.m8.1.1.3" xref="S2.SS2.p2.8.m8.1.1.3.cmml">L</mi><mi id="S2.SS2.p2.8.m8.1.1.2.3" xref="S2.SS2.p2.8.m8.1.1.2.3.cmml">t</mi></msubsup><annotation-xml encoding="MathML-Content" id="S2.SS2.p2.8.m8.1b"><apply id="S2.SS2.p2.8.m8.1.1.cmml" xref="S2.SS2.p2.8.m8.1.1"><csymbol cd="ambiguous" id="S2.SS2.p2.8.m8.1.1.1.cmml" xref="S2.SS2.p2.8.m8.1.1">subscript</csymbol><apply id="S2.SS2.p2.8.m8.1.1.2.cmml" xref="S2.SS2.p2.8.m8.1.1"><csymbol cd="ambiguous" id="S2.SS2.p2.8.m8.1.1.2.1.cmml" xref="S2.SS2.p2.8.m8.1.1">superscript</csymbol><ci id="S2.SS2.p2.8.m8.1.1.2.2.cmml" xref="S2.SS2.p2.8.m8.1.1.2.2">𝑔</ci><ci id="S2.SS2.p2.8.m8.1.1.2.3.cmml" xref="S2.SS2.p2.8.m8.1.1.2.3">𝑡</ci></apply><ci id="S2.SS2.p2.8.m8.1.1.3.cmml" xref="S2.SS2.p2.8.m8.1.1.3">𝐿</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p2.8.m8.1c">g^{t}_{L}</annotation></semantics></math> and <math id="S2.SS2.p2.9.m9.1" class="ltx_Math" alttext="g^{t}_{H}" display="inline"><semantics id="S2.SS2.p2.9.m9.1a"><msubsup id="S2.SS2.p2.9.m9.1.1" xref="S2.SS2.p2.9.m9.1.1.cmml"><mi id="S2.SS2.p2.9.m9.1.1.2.2" xref="S2.SS2.p2.9.m9.1.1.2.2.cmml">g</mi><mi id="S2.SS2.p2.9.m9.1.1.3" xref="S2.SS2.p2.9.m9.1.1.3.cmml">H</mi><mi id="S2.SS2.p2.9.m9.1.1.2.3" xref="S2.SS2.p2.9.m9.1.1.2.3.cmml">t</mi></msubsup><annotation-xml encoding="MathML-Content" id="S2.SS2.p2.9.m9.1b"><apply id="S2.SS2.p2.9.m9.1.1.cmml" xref="S2.SS2.p2.9.m9.1.1"><csymbol cd="ambiguous" id="S2.SS2.p2.9.m9.1.1.1.cmml" xref="S2.SS2.p2.9.m9.1.1">subscript</csymbol><apply id="S2.SS2.p2.9.m9.1.1.2.cmml" xref="S2.SS2.p2.9.m9.1.1"><csymbol cd="ambiguous" id="S2.SS2.p2.9.m9.1.1.2.1.cmml" xref="S2.SS2.p2.9.m9.1.1">superscript</csymbol><ci id="S2.SS2.p2.9.m9.1.1.2.2.cmml" xref="S2.SS2.p2.9.m9.1.1.2.2">𝑔</ci><ci id="S2.SS2.p2.9.m9.1.1.2.3.cmml" xref="S2.SS2.p2.9.m9.1.1.2.3">𝑡</ci></apply><ci id="S2.SS2.p2.9.m9.1.1.3.cmml" xref="S2.SS2.p2.9.m9.1.1.3">𝐻</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p2.9.m9.1c">g^{t}_{H}</annotation></semantics></math>, respectively.
Before applying the <span id="S2.SS2.p2.18.4" class="ltx_text ltx_font_smallcaps">FedAvg</span> step at each round using the aggregated client gradients, we calculate an additional gradient for each model via codistillation. To apply codistillation, we first create a copy of the parameters of each model at the start of the round to act as a student. Let <math id="S2.SS2.p2.10.m10.1" class="ltx_Math" alttext="\theta_{L}^{\text{\tiny student}}" display="inline"><semantics id="S2.SS2.p2.10.m10.1a"><msubsup id="S2.SS2.p2.10.m10.1.1" xref="S2.SS2.p2.10.m10.1.1.cmml"><mi id="S2.SS2.p2.10.m10.1.1.2.2" xref="S2.SS2.p2.10.m10.1.1.2.2.cmml">θ</mi><mi id="S2.SS2.p2.10.m10.1.1.2.3" xref="S2.SS2.p2.10.m10.1.1.2.3.cmml">L</mi><mtext mathsize="71%" id="S2.SS2.p2.10.m10.1.1.3" xref="S2.SS2.p2.10.m10.1.1.3a.cmml">student</mtext></msubsup><annotation-xml encoding="MathML-Content" id="S2.SS2.p2.10.m10.1b"><apply id="S2.SS2.p2.10.m10.1.1.cmml" xref="S2.SS2.p2.10.m10.1.1"><csymbol cd="ambiguous" id="S2.SS2.p2.10.m10.1.1.1.cmml" xref="S2.SS2.p2.10.m10.1.1">superscript</csymbol><apply id="S2.SS2.p2.10.m10.1.1.2.cmml" xref="S2.SS2.p2.10.m10.1.1"><csymbol cd="ambiguous" id="S2.SS2.p2.10.m10.1.1.2.1.cmml" xref="S2.SS2.p2.10.m10.1.1">subscript</csymbol><ci id="S2.SS2.p2.10.m10.1.1.2.2.cmml" xref="S2.SS2.p2.10.m10.1.1.2.2">𝜃</ci><ci id="S2.SS2.p2.10.m10.1.1.2.3.cmml" xref="S2.SS2.p2.10.m10.1.1.2.3">𝐿</ci></apply><ci id="S2.SS2.p2.10.m10.1.1.3a.cmml" xref="S2.SS2.p2.10.m10.1.1.3"><mtext mathsize="50%" id="S2.SS2.p2.10.m10.1.1.3.cmml" xref="S2.SS2.p2.10.m10.1.1.3">student</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p2.10.m10.1c">\theta_{L}^{\text{\tiny student}}</annotation></semantics></math> and <math id="S2.SS2.p2.11.m11.1" class="ltx_Math" alttext="\theta_{H}^{\text{\tiny student}}" display="inline"><semantics id="S2.SS2.p2.11.m11.1a"><msubsup id="S2.SS2.p2.11.m11.1.1" xref="S2.SS2.p2.11.m11.1.1.cmml"><mi id="S2.SS2.p2.11.m11.1.1.2.2" xref="S2.SS2.p2.11.m11.1.1.2.2.cmml">θ</mi><mi id="S2.SS2.p2.11.m11.1.1.2.3" xref="S2.SS2.p2.11.m11.1.1.2.3.cmml">H</mi><mtext mathsize="71%" id="S2.SS2.p2.11.m11.1.1.3" xref="S2.SS2.p2.11.m11.1.1.3a.cmml">student</mtext></msubsup><annotation-xml encoding="MathML-Content" id="S2.SS2.p2.11.m11.1b"><apply id="S2.SS2.p2.11.m11.1.1.cmml" xref="S2.SS2.p2.11.m11.1.1"><csymbol cd="ambiguous" id="S2.SS2.p2.11.m11.1.1.1.cmml" xref="S2.SS2.p2.11.m11.1.1">superscript</csymbol><apply id="S2.SS2.p2.11.m11.1.1.2.cmml" xref="S2.SS2.p2.11.m11.1.1"><csymbol cd="ambiguous" id="S2.SS2.p2.11.m11.1.1.2.1.cmml" xref="S2.SS2.p2.11.m11.1.1">subscript</csymbol><ci id="S2.SS2.p2.11.m11.1.1.2.2.cmml" xref="S2.SS2.p2.11.m11.1.1.2.2">𝜃</ci><ci id="S2.SS2.p2.11.m11.1.1.2.3.cmml" xref="S2.SS2.p2.11.m11.1.1.2.3">𝐻</ci></apply><ci id="S2.SS2.p2.11.m11.1.1.3a.cmml" xref="S2.SS2.p2.11.m11.1.1.3"><mtext mathsize="50%" id="S2.SS2.p2.11.m11.1.1.3.cmml" xref="S2.SS2.p2.11.m11.1.1.3">student</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p2.11.m11.1c">\theta_{H}^{\text{\tiny student}}</annotation></semantics></math> denote the student models for <math id="S2.SS2.p2.12.m12.1" class="ltx_Math" alttext="\theta_{L}" display="inline"><semantics id="S2.SS2.p2.12.m12.1a"><msub id="S2.SS2.p2.12.m12.1.1" xref="S2.SS2.p2.12.m12.1.1.cmml"><mi id="S2.SS2.p2.12.m12.1.1.2" xref="S2.SS2.p2.12.m12.1.1.2.cmml">θ</mi><mi id="S2.SS2.p2.12.m12.1.1.3" xref="S2.SS2.p2.12.m12.1.1.3.cmml">L</mi></msub><annotation-xml encoding="MathML-Content" id="S2.SS2.p2.12.m12.1b"><apply id="S2.SS2.p2.12.m12.1.1.cmml" xref="S2.SS2.p2.12.m12.1.1"><csymbol cd="ambiguous" id="S2.SS2.p2.12.m12.1.1.1.cmml" xref="S2.SS2.p2.12.m12.1.1">subscript</csymbol><ci id="S2.SS2.p2.12.m12.1.1.2.cmml" xref="S2.SS2.p2.12.m12.1.1.2">𝜃</ci><ci id="S2.SS2.p2.12.m12.1.1.3.cmml" xref="S2.SS2.p2.12.m12.1.1.3">𝐿</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p2.12.m12.1c">\theta_{L}</annotation></semantics></math> and <math id="S2.SS2.p2.13.m13.1" class="ltx_Math" alttext="\theta_{H}" display="inline"><semantics id="S2.SS2.p2.13.m13.1a"><msub id="S2.SS2.p2.13.m13.1.1" xref="S2.SS2.p2.13.m13.1.1.cmml"><mi id="S2.SS2.p2.13.m13.1.1.2" xref="S2.SS2.p2.13.m13.1.1.2.cmml">θ</mi><mi id="S2.SS2.p2.13.m13.1.1.3" xref="S2.SS2.p2.13.m13.1.1.3.cmml">H</mi></msub><annotation-xml encoding="MathML-Content" id="S2.SS2.p2.13.m13.1b"><apply id="S2.SS2.p2.13.m13.1.1.cmml" xref="S2.SS2.p2.13.m13.1.1"><csymbol cd="ambiguous" id="S2.SS2.p2.13.m13.1.1.1.cmml" xref="S2.SS2.p2.13.m13.1.1">subscript</csymbol><ci id="S2.SS2.p2.13.m13.1.1.2.cmml" xref="S2.SS2.p2.13.m13.1.1.2">𝜃</ci><ci id="S2.SS2.p2.13.m13.1.1.3.cmml" xref="S2.SS2.p2.13.m13.1.1.3">𝐻</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p2.13.m13.1c">\theta_{H}</annotation></semantics></math>, respectively. Using <math id="S2.SS2.p2.14.m14.1" class="ltx_Math" alttext="\theta_{H}^{\text{\tiny teacher}}=\theta_{H}^{t}" display="inline"><semantics id="S2.SS2.p2.14.m14.1a"><mrow id="S2.SS2.p2.14.m14.1.1" xref="S2.SS2.p2.14.m14.1.1.cmml"><msubsup id="S2.SS2.p2.14.m14.1.1.2" xref="S2.SS2.p2.14.m14.1.1.2.cmml"><mi id="S2.SS2.p2.14.m14.1.1.2.2.2" xref="S2.SS2.p2.14.m14.1.1.2.2.2.cmml">θ</mi><mi id="S2.SS2.p2.14.m14.1.1.2.2.3" xref="S2.SS2.p2.14.m14.1.1.2.2.3.cmml">H</mi><mtext mathsize="71%" id="S2.SS2.p2.14.m14.1.1.2.3" xref="S2.SS2.p2.14.m14.1.1.2.3a.cmml">teacher</mtext></msubsup><mo id="S2.SS2.p2.14.m14.1.1.1" xref="S2.SS2.p2.14.m14.1.1.1.cmml">=</mo><msubsup id="S2.SS2.p2.14.m14.1.1.3" xref="S2.SS2.p2.14.m14.1.1.3.cmml"><mi id="S2.SS2.p2.14.m14.1.1.3.2.2" xref="S2.SS2.p2.14.m14.1.1.3.2.2.cmml">θ</mi><mi id="S2.SS2.p2.14.m14.1.1.3.2.3" xref="S2.SS2.p2.14.m14.1.1.3.2.3.cmml">H</mi><mi id="S2.SS2.p2.14.m14.1.1.3.3" xref="S2.SS2.p2.14.m14.1.1.3.3.cmml">t</mi></msubsup></mrow><annotation-xml encoding="MathML-Content" id="S2.SS2.p2.14.m14.1b"><apply id="S2.SS2.p2.14.m14.1.1.cmml" xref="S2.SS2.p2.14.m14.1.1"><eq id="S2.SS2.p2.14.m14.1.1.1.cmml" xref="S2.SS2.p2.14.m14.1.1.1"></eq><apply id="S2.SS2.p2.14.m14.1.1.2.cmml" xref="S2.SS2.p2.14.m14.1.1.2"><csymbol cd="ambiguous" id="S2.SS2.p2.14.m14.1.1.2.1.cmml" xref="S2.SS2.p2.14.m14.1.1.2">superscript</csymbol><apply id="S2.SS2.p2.14.m14.1.1.2.2.cmml" xref="S2.SS2.p2.14.m14.1.1.2"><csymbol cd="ambiguous" id="S2.SS2.p2.14.m14.1.1.2.2.1.cmml" xref="S2.SS2.p2.14.m14.1.1.2">subscript</csymbol><ci id="S2.SS2.p2.14.m14.1.1.2.2.2.cmml" xref="S2.SS2.p2.14.m14.1.1.2.2.2">𝜃</ci><ci id="S2.SS2.p2.14.m14.1.1.2.2.3.cmml" xref="S2.SS2.p2.14.m14.1.1.2.2.3">𝐻</ci></apply><ci id="S2.SS2.p2.14.m14.1.1.2.3a.cmml" xref="S2.SS2.p2.14.m14.1.1.2.3"><mtext mathsize="50%" id="S2.SS2.p2.14.m14.1.1.2.3.cmml" xref="S2.SS2.p2.14.m14.1.1.2.3">teacher</mtext></ci></apply><apply id="S2.SS2.p2.14.m14.1.1.3.cmml" xref="S2.SS2.p2.14.m14.1.1.3"><csymbol cd="ambiguous" id="S2.SS2.p2.14.m14.1.1.3.1.cmml" xref="S2.SS2.p2.14.m14.1.1.3">superscript</csymbol><apply id="S2.SS2.p2.14.m14.1.1.3.2.cmml" xref="S2.SS2.p2.14.m14.1.1.3"><csymbol cd="ambiguous" id="S2.SS2.p2.14.m14.1.1.3.2.1.cmml" xref="S2.SS2.p2.14.m14.1.1.3">subscript</csymbol><ci id="S2.SS2.p2.14.m14.1.1.3.2.2.cmml" xref="S2.SS2.p2.14.m14.1.1.3.2.2">𝜃</ci><ci id="S2.SS2.p2.14.m14.1.1.3.2.3.cmml" xref="S2.SS2.p2.14.m14.1.1.3.2.3">𝐻</ci></apply><ci id="S2.SS2.p2.14.m14.1.1.3.3.cmml" xref="S2.SS2.p2.14.m14.1.1.3.3">𝑡</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p2.14.m14.1c">\theta_{H}^{\text{\tiny teacher}}=\theta_{H}^{t}</annotation></semantics></math> (respectively, <math id="S2.SS2.p2.15.m15.1" class="ltx_Math" alttext="\theta_{L}^{\text{\tiny teacher}}=\theta_{L}^{t}" display="inline"><semantics id="S2.SS2.p2.15.m15.1a"><mrow id="S2.SS2.p2.15.m15.1.1" xref="S2.SS2.p2.15.m15.1.1.cmml"><msubsup id="S2.SS2.p2.15.m15.1.1.2" xref="S2.SS2.p2.15.m15.1.1.2.cmml"><mi id="S2.SS2.p2.15.m15.1.1.2.2.2" xref="S2.SS2.p2.15.m15.1.1.2.2.2.cmml">θ</mi><mi id="S2.SS2.p2.15.m15.1.1.2.2.3" xref="S2.SS2.p2.15.m15.1.1.2.2.3.cmml">L</mi><mtext mathsize="71%" id="S2.SS2.p2.15.m15.1.1.2.3" xref="S2.SS2.p2.15.m15.1.1.2.3a.cmml">teacher</mtext></msubsup><mo id="S2.SS2.p2.15.m15.1.1.1" xref="S2.SS2.p2.15.m15.1.1.1.cmml">=</mo><msubsup id="S2.SS2.p2.15.m15.1.1.3" xref="S2.SS2.p2.15.m15.1.1.3.cmml"><mi id="S2.SS2.p2.15.m15.1.1.3.2.2" xref="S2.SS2.p2.15.m15.1.1.3.2.2.cmml">θ</mi><mi id="S2.SS2.p2.15.m15.1.1.3.2.3" xref="S2.SS2.p2.15.m15.1.1.3.2.3.cmml">L</mi><mi id="S2.SS2.p2.15.m15.1.1.3.3" xref="S2.SS2.p2.15.m15.1.1.3.3.cmml">t</mi></msubsup></mrow><annotation-xml encoding="MathML-Content" id="S2.SS2.p2.15.m15.1b"><apply id="S2.SS2.p2.15.m15.1.1.cmml" xref="S2.SS2.p2.15.m15.1.1"><eq id="S2.SS2.p2.15.m15.1.1.1.cmml" xref="S2.SS2.p2.15.m15.1.1.1"></eq><apply id="S2.SS2.p2.15.m15.1.1.2.cmml" xref="S2.SS2.p2.15.m15.1.1.2"><csymbol cd="ambiguous" id="S2.SS2.p2.15.m15.1.1.2.1.cmml" xref="S2.SS2.p2.15.m15.1.1.2">superscript</csymbol><apply id="S2.SS2.p2.15.m15.1.1.2.2.cmml" xref="S2.SS2.p2.15.m15.1.1.2"><csymbol cd="ambiguous" id="S2.SS2.p2.15.m15.1.1.2.2.1.cmml" xref="S2.SS2.p2.15.m15.1.1.2">subscript</csymbol><ci id="S2.SS2.p2.15.m15.1.1.2.2.2.cmml" xref="S2.SS2.p2.15.m15.1.1.2.2.2">𝜃</ci><ci id="S2.SS2.p2.15.m15.1.1.2.2.3.cmml" xref="S2.SS2.p2.15.m15.1.1.2.2.3">𝐿</ci></apply><ci id="S2.SS2.p2.15.m15.1.1.2.3a.cmml" xref="S2.SS2.p2.15.m15.1.1.2.3"><mtext mathsize="50%" id="S2.SS2.p2.15.m15.1.1.2.3.cmml" xref="S2.SS2.p2.15.m15.1.1.2.3">teacher</mtext></ci></apply><apply id="S2.SS2.p2.15.m15.1.1.3.cmml" xref="S2.SS2.p2.15.m15.1.1.3"><csymbol cd="ambiguous" id="S2.SS2.p2.15.m15.1.1.3.1.cmml" xref="S2.SS2.p2.15.m15.1.1.3">superscript</csymbol><apply id="S2.SS2.p2.15.m15.1.1.3.2.cmml" xref="S2.SS2.p2.15.m15.1.1.3"><csymbol cd="ambiguous" id="S2.SS2.p2.15.m15.1.1.3.2.1.cmml" xref="S2.SS2.p2.15.m15.1.1.3">subscript</csymbol><ci id="S2.SS2.p2.15.m15.1.1.3.2.2.cmml" xref="S2.SS2.p2.15.m15.1.1.3.2.2">𝜃</ci><ci id="S2.SS2.p2.15.m15.1.1.3.2.3.cmml" xref="S2.SS2.p2.15.m15.1.1.3.2.3">𝐿</ci></apply><ci id="S2.SS2.p2.15.m15.1.1.3.3.cmml" xref="S2.SS2.p2.15.m15.1.1.3.3">𝑡</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p2.15.m15.1c">\theta_{L}^{\text{\tiny teacher}}=\theta_{L}^{t}</annotation></semantics></math>) as the teacher, we distill to <math id="S2.SS2.p2.16.m16.1" class="ltx_Math" alttext="\theta_{L}^{\text{\tiny student}}" display="inline"><semantics id="S2.SS2.p2.16.m16.1a"><msubsup id="S2.SS2.p2.16.m16.1.1" xref="S2.SS2.p2.16.m16.1.1.cmml"><mi id="S2.SS2.p2.16.m16.1.1.2.2" xref="S2.SS2.p2.16.m16.1.1.2.2.cmml">θ</mi><mi id="S2.SS2.p2.16.m16.1.1.2.3" xref="S2.SS2.p2.16.m16.1.1.2.3.cmml">L</mi><mtext mathsize="71%" id="S2.SS2.p2.16.m16.1.1.3" xref="S2.SS2.p2.16.m16.1.1.3a.cmml">student</mtext></msubsup><annotation-xml encoding="MathML-Content" id="S2.SS2.p2.16.m16.1b"><apply id="S2.SS2.p2.16.m16.1.1.cmml" xref="S2.SS2.p2.16.m16.1.1"><csymbol cd="ambiguous" id="S2.SS2.p2.16.m16.1.1.1.cmml" xref="S2.SS2.p2.16.m16.1.1">superscript</csymbol><apply id="S2.SS2.p2.16.m16.1.1.2.cmml" xref="S2.SS2.p2.16.m16.1.1"><csymbol cd="ambiguous" id="S2.SS2.p2.16.m16.1.1.2.1.cmml" xref="S2.SS2.p2.16.m16.1.1">subscript</csymbol><ci id="S2.SS2.p2.16.m16.1.1.2.2.cmml" xref="S2.SS2.p2.16.m16.1.1.2.2">𝜃</ci><ci id="S2.SS2.p2.16.m16.1.1.2.3.cmml" xref="S2.SS2.p2.16.m16.1.1.2.3">𝐿</ci></apply><ci id="S2.SS2.p2.16.m16.1.1.3a.cmml" xref="S2.SS2.p2.16.m16.1.1.3"><mtext mathsize="50%" id="S2.SS2.p2.16.m16.1.1.3.cmml" xref="S2.SS2.p2.16.m16.1.1.3">student</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p2.16.m16.1c">\theta_{L}^{\text{\tiny student}}</annotation></semantics></math> (respectively, <math id="S2.SS2.p2.17.m17.1" class="ltx_Math" alttext="\theta_{H}^{\text{\tiny student}}" display="inline"><semantics id="S2.SS2.p2.17.m17.1a"><msubsup id="S2.SS2.p2.17.m17.1.1" xref="S2.SS2.p2.17.m17.1.1.cmml"><mi id="S2.SS2.p2.17.m17.1.1.2.2" xref="S2.SS2.p2.17.m17.1.1.2.2.cmml">θ</mi><mi id="S2.SS2.p2.17.m17.1.1.2.3" xref="S2.SS2.p2.17.m17.1.1.2.3.cmml">H</mi><mtext mathsize="71%" id="S2.SS2.p2.17.m17.1.1.3" xref="S2.SS2.p2.17.m17.1.1.3a.cmml">student</mtext></msubsup><annotation-xml encoding="MathML-Content" id="S2.SS2.p2.17.m17.1b"><apply id="S2.SS2.p2.17.m17.1.1.cmml" xref="S2.SS2.p2.17.m17.1.1"><csymbol cd="ambiguous" id="S2.SS2.p2.17.m17.1.1.1.cmml" xref="S2.SS2.p2.17.m17.1.1">superscript</csymbol><apply id="S2.SS2.p2.17.m17.1.1.2.cmml" xref="S2.SS2.p2.17.m17.1.1"><csymbol cd="ambiguous" id="S2.SS2.p2.17.m17.1.1.2.1.cmml" xref="S2.SS2.p2.17.m17.1.1">subscript</csymbol><ci id="S2.SS2.p2.17.m17.1.1.2.2.cmml" xref="S2.SS2.p2.17.m17.1.1.2.2">𝜃</ci><ci id="S2.SS2.p2.17.m17.1.1.2.3.cmml" xref="S2.SS2.p2.17.m17.1.1.2.3">𝐻</ci></apply><ci id="S2.SS2.p2.17.m17.1.1.3a.cmml" xref="S2.SS2.p2.17.m17.1.1.3"><mtext mathsize="50%" id="S2.SS2.p2.17.m17.1.1.3.cmml" xref="S2.SS2.p2.17.m17.1.1.3">student</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p2.17.m17.1c">\theta_{H}^{\text{\tiny student}}</annotation></semantics></math>). We then calculate the model difference between the model parameters at round <math id="S2.SS2.p2.18.m18.1" class="ltx_Math" alttext="t" display="inline"><semantics id="S2.SS2.p2.18.m18.1a"><mi id="S2.SS2.p2.18.m18.1.1" xref="S2.SS2.p2.18.m18.1.1.cmml">t</mi><annotation-xml encoding="MathML-Content" id="S2.SS2.p2.18.m18.1b"><ci id="S2.SS2.p2.18.m18.1.1.cmml" xref="S2.SS2.p2.18.m18.1.1">𝑡</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p2.18.m18.1c">t</annotation></semantics></math> and the student models at the end of the codistillation round, that is</p>
<table id="S2.E1" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S2.E1.m1.3" class="ltx_Math" alttext="\delta_{i}^{t}=\theta_{i}^{t}-\theta_{i}^{\text{\tiny student}},\,\,i\in\{L,H\}\,." display="block"><semantics id="S2.E1.m1.3a"><mrow id="S2.E1.m1.3.3.1"><mrow id="S2.E1.m1.3.3.1.1.2" xref="S2.E1.m1.3.3.1.1.3.cmml"><mrow id="S2.E1.m1.3.3.1.1.1.1" xref="S2.E1.m1.3.3.1.1.1.1.cmml"><msubsup id="S2.E1.m1.3.3.1.1.1.1.2" xref="S2.E1.m1.3.3.1.1.1.1.2.cmml"><mi id="S2.E1.m1.3.3.1.1.1.1.2.2.2" xref="S2.E1.m1.3.3.1.1.1.1.2.2.2.cmml">δ</mi><mi id="S2.E1.m1.3.3.1.1.1.1.2.2.3" xref="S2.E1.m1.3.3.1.1.1.1.2.2.3.cmml">i</mi><mi id="S2.E1.m1.3.3.1.1.1.1.2.3" xref="S2.E1.m1.3.3.1.1.1.1.2.3.cmml">t</mi></msubsup><mo id="S2.E1.m1.3.3.1.1.1.1.1" xref="S2.E1.m1.3.3.1.1.1.1.1.cmml">=</mo><mrow id="S2.E1.m1.3.3.1.1.1.1.3" xref="S2.E1.m1.3.3.1.1.1.1.3.cmml"><msubsup id="S2.E1.m1.3.3.1.1.1.1.3.2" xref="S2.E1.m1.3.3.1.1.1.1.3.2.cmml"><mi id="S2.E1.m1.3.3.1.1.1.1.3.2.2.2" xref="S2.E1.m1.3.3.1.1.1.1.3.2.2.2.cmml">θ</mi><mi id="S2.E1.m1.3.3.1.1.1.1.3.2.2.3" xref="S2.E1.m1.3.3.1.1.1.1.3.2.2.3.cmml">i</mi><mi id="S2.E1.m1.3.3.1.1.1.1.3.2.3" xref="S2.E1.m1.3.3.1.1.1.1.3.2.3.cmml">t</mi></msubsup><mo id="S2.E1.m1.3.3.1.1.1.1.3.1" xref="S2.E1.m1.3.3.1.1.1.1.3.1.cmml">−</mo><msubsup id="S2.E1.m1.3.3.1.1.1.1.3.3" xref="S2.E1.m1.3.3.1.1.1.1.3.3.cmml"><mi id="S2.E1.m1.3.3.1.1.1.1.3.3.2.2" xref="S2.E1.m1.3.3.1.1.1.1.3.3.2.2.cmml">θ</mi><mi id="S2.E1.m1.3.3.1.1.1.1.3.3.2.3" xref="S2.E1.m1.3.3.1.1.1.1.3.3.2.3.cmml">i</mi><mtext mathsize="71%" id="S2.E1.m1.3.3.1.1.1.1.3.3.3" xref="S2.E1.m1.3.3.1.1.1.1.3.3.3a.cmml">student</mtext></msubsup></mrow></mrow><mo rspace="0.497em" id="S2.E1.m1.3.3.1.1.2.3" xref="S2.E1.m1.3.3.1.1.3a.cmml">,</mo><mrow id="S2.E1.m1.3.3.1.1.2.2" xref="S2.E1.m1.3.3.1.1.2.2.cmml"><mi id="S2.E1.m1.3.3.1.1.2.2.2" xref="S2.E1.m1.3.3.1.1.2.2.2.cmml">i</mi><mo id="S2.E1.m1.3.3.1.1.2.2.1" xref="S2.E1.m1.3.3.1.1.2.2.1.cmml">∈</mo><mrow id="S2.E1.m1.3.3.1.1.2.2.3.2" xref="S2.E1.m1.3.3.1.1.2.2.3.1.cmml"><mo stretchy="false" id="S2.E1.m1.3.3.1.1.2.2.3.2.1" xref="S2.E1.m1.3.3.1.1.2.2.3.1.cmml">{</mo><mi id="S2.E1.m1.1.1" xref="S2.E1.m1.1.1.cmml">L</mi><mo id="S2.E1.m1.3.3.1.1.2.2.3.2.2" xref="S2.E1.m1.3.3.1.1.2.2.3.1.cmml">,</mo><mi id="S2.E1.m1.2.2" xref="S2.E1.m1.2.2.cmml">H</mi><mo stretchy="false" id="S2.E1.m1.3.3.1.1.2.2.3.2.3" xref="S2.E1.m1.3.3.1.1.2.2.3.1.cmml">}</mo></mrow></mrow></mrow><mo lspace="0.170em" id="S2.E1.m1.3.3.1.2">.</mo></mrow><annotation-xml encoding="MathML-Content" id="S2.E1.m1.3b"><apply id="S2.E1.m1.3.3.1.1.3.cmml" xref="S2.E1.m1.3.3.1.1.2"><csymbol cd="ambiguous" id="S2.E1.m1.3.3.1.1.3a.cmml" xref="S2.E1.m1.3.3.1.1.2.3">formulae-sequence</csymbol><apply id="S2.E1.m1.3.3.1.1.1.1.cmml" xref="S2.E1.m1.3.3.1.1.1.1"><eq id="S2.E1.m1.3.3.1.1.1.1.1.cmml" xref="S2.E1.m1.3.3.1.1.1.1.1"></eq><apply id="S2.E1.m1.3.3.1.1.1.1.2.cmml" xref="S2.E1.m1.3.3.1.1.1.1.2"><csymbol cd="ambiguous" id="S2.E1.m1.3.3.1.1.1.1.2.1.cmml" xref="S2.E1.m1.3.3.1.1.1.1.2">superscript</csymbol><apply id="S2.E1.m1.3.3.1.1.1.1.2.2.cmml" xref="S2.E1.m1.3.3.1.1.1.1.2"><csymbol cd="ambiguous" id="S2.E1.m1.3.3.1.1.1.1.2.2.1.cmml" xref="S2.E1.m1.3.3.1.1.1.1.2">subscript</csymbol><ci id="S2.E1.m1.3.3.1.1.1.1.2.2.2.cmml" xref="S2.E1.m1.3.3.1.1.1.1.2.2.2">𝛿</ci><ci id="S2.E1.m1.3.3.1.1.1.1.2.2.3.cmml" xref="S2.E1.m1.3.3.1.1.1.1.2.2.3">𝑖</ci></apply><ci id="S2.E1.m1.3.3.1.1.1.1.2.3.cmml" xref="S2.E1.m1.3.3.1.1.1.1.2.3">𝑡</ci></apply><apply id="S2.E1.m1.3.3.1.1.1.1.3.cmml" xref="S2.E1.m1.3.3.1.1.1.1.3"><minus id="S2.E1.m1.3.3.1.1.1.1.3.1.cmml" xref="S2.E1.m1.3.3.1.1.1.1.3.1"></minus><apply id="S2.E1.m1.3.3.1.1.1.1.3.2.cmml" xref="S2.E1.m1.3.3.1.1.1.1.3.2"><csymbol cd="ambiguous" id="S2.E1.m1.3.3.1.1.1.1.3.2.1.cmml" xref="S2.E1.m1.3.3.1.1.1.1.3.2">superscript</csymbol><apply id="S2.E1.m1.3.3.1.1.1.1.3.2.2.cmml" xref="S2.E1.m1.3.3.1.1.1.1.3.2"><csymbol cd="ambiguous" id="S2.E1.m1.3.3.1.1.1.1.3.2.2.1.cmml" xref="S2.E1.m1.3.3.1.1.1.1.3.2">subscript</csymbol><ci id="S2.E1.m1.3.3.1.1.1.1.3.2.2.2.cmml" xref="S2.E1.m1.3.3.1.1.1.1.3.2.2.2">𝜃</ci><ci id="S2.E1.m1.3.3.1.1.1.1.3.2.2.3.cmml" xref="S2.E1.m1.3.3.1.1.1.1.3.2.2.3">𝑖</ci></apply><ci id="S2.E1.m1.3.3.1.1.1.1.3.2.3.cmml" xref="S2.E1.m1.3.3.1.1.1.1.3.2.3">𝑡</ci></apply><apply id="S2.E1.m1.3.3.1.1.1.1.3.3.cmml" xref="S2.E1.m1.3.3.1.1.1.1.3.3"><csymbol cd="ambiguous" id="S2.E1.m1.3.3.1.1.1.1.3.3.1.cmml" xref="S2.E1.m1.3.3.1.1.1.1.3.3">superscript</csymbol><apply id="S2.E1.m1.3.3.1.1.1.1.3.3.2.cmml" xref="S2.E1.m1.3.3.1.1.1.1.3.3"><csymbol cd="ambiguous" id="S2.E1.m1.3.3.1.1.1.1.3.3.2.1.cmml" xref="S2.E1.m1.3.3.1.1.1.1.3.3">subscript</csymbol><ci id="S2.E1.m1.3.3.1.1.1.1.3.3.2.2.cmml" xref="S2.E1.m1.3.3.1.1.1.1.3.3.2.2">𝜃</ci><ci id="S2.E1.m1.3.3.1.1.1.1.3.3.2.3.cmml" xref="S2.E1.m1.3.3.1.1.1.1.3.3.2.3">𝑖</ci></apply><ci id="S2.E1.m1.3.3.1.1.1.1.3.3.3a.cmml" xref="S2.E1.m1.3.3.1.1.1.1.3.3.3"><mtext mathsize="50%" id="S2.E1.m1.3.3.1.1.1.1.3.3.3.cmml" xref="S2.E1.m1.3.3.1.1.1.1.3.3.3">student</mtext></ci></apply></apply></apply><apply id="S2.E1.m1.3.3.1.1.2.2.cmml" xref="S2.E1.m1.3.3.1.1.2.2"><in id="S2.E1.m1.3.3.1.1.2.2.1.cmml" xref="S2.E1.m1.3.3.1.1.2.2.1"></in><ci id="S2.E1.m1.3.3.1.1.2.2.2.cmml" xref="S2.E1.m1.3.3.1.1.2.2.2">𝑖</ci><set id="S2.E1.m1.3.3.1.1.2.2.3.1.cmml" xref="S2.E1.m1.3.3.1.1.2.2.3.2"><ci id="S2.E1.m1.1.1.cmml" xref="S2.E1.m1.1.1">𝐿</ci><ci id="S2.E1.m1.2.2.cmml" xref="S2.E1.m1.2.2">𝐻</ci></set></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.E1.m1.3c">\delta_{i}^{t}=\theta_{i}^{t}-\theta_{i}^{\text{\tiny student}},\,\,i\in\{L,H\}\,.</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(1)</span></td>
</tr></tbody>
</table>
<p id="S2.SS2.p2.19" class="ltx_p">We call the model difference induced by the distillation round the <em id="S2.SS2.p2.19.1" class="ltx_emph ltx_font_italic">distillation gradient</em>. The last step involves merging the two gradients for each model: the aggregated <span id="S2.SS2.p2.19.2" class="ltx_text ltx_font_smallcaps">FedAvg</span>  gradient and the distillation gradient. We can achieve this by a weighted combination of the two gradients using an interpolating factor <math id="S2.SS2.p2.19.m1.2" class="ltx_Math" alttext="\alpha\in[0,1]" display="inline"><semantics id="S2.SS2.p2.19.m1.2a"><mrow id="S2.SS2.p2.19.m1.2.3" xref="S2.SS2.p2.19.m1.2.3.cmml"><mi id="S2.SS2.p2.19.m1.2.3.2" xref="S2.SS2.p2.19.m1.2.3.2.cmml">α</mi><mo id="S2.SS2.p2.19.m1.2.3.1" xref="S2.SS2.p2.19.m1.2.3.1.cmml">∈</mo><mrow id="S2.SS2.p2.19.m1.2.3.3.2" xref="S2.SS2.p2.19.m1.2.3.3.1.cmml"><mo stretchy="false" id="S2.SS2.p2.19.m1.2.3.3.2.1" xref="S2.SS2.p2.19.m1.2.3.3.1.cmml">[</mo><mn id="S2.SS2.p2.19.m1.1.1" xref="S2.SS2.p2.19.m1.1.1.cmml">0</mn><mo id="S2.SS2.p2.19.m1.2.3.3.2.2" xref="S2.SS2.p2.19.m1.2.3.3.1.cmml">,</mo><mn id="S2.SS2.p2.19.m1.2.2" xref="S2.SS2.p2.19.m1.2.2.cmml">1</mn><mo stretchy="false" id="S2.SS2.p2.19.m1.2.3.3.2.3" xref="S2.SS2.p2.19.m1.2.3.3.1.cmml">]</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.SS2.p2.19.m1.2b"><apply id="S2.SS2.p2.19.m1.2.3.cmml" xref="S2.SS2.p2.19.m1.2.3"><in id="S2.SS2.p2.19.m1.2.3.1.cmml" xref="S2.SS2.p2.19.m1.2.3.1"></in><ci id="S2.SS2.p2.19.m1.2.3.2.cmml" xref="S2.SS2.p2.19.m1.2.3.2">𝛼</ci><interval closure="closed" id="S2.SS2.p2.19.m1.2.3.3.1.cmml" xref="S2.SS2.p2.19.m1.2.3.3.2"><cn type="integer" id="S2.SS2.p2.19.m1.1.1.cmml" xref="S2.SS2.p2.19.m1.1.1">0</cn><cn type="integer" id="S2.SS2.p2.19.m1.2.2.cmml" xref="S2.SS2.p2.19.m1.2.2">1</cn></interval></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p2.19.m1.2c">\alpha\in[0,1]</annotation></semantics></math>. However, before merging, we ensure that the two gradients have the same scale by rescaling the distillation gradient. The final <em id="S2.SS2.p2.19.3" class="ltx_emph ltx_font_italic">merged gradient</em> for each model can be written as</p>
<table id="S2.E2" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S2.E2.m1.5" class="ltx_Math" alttext="\Delta^{t}_{i}=\alpha\,g^{t}_{i}+(1-\alpha)\,\delta_{i}^{t}\,\frac{\|g_{i}^{t}\|_{2}}{\|\delta_{i}^{t}\|_{2}}\,,\,i\in\{L,H\}\,," display="block"><semantics id="S2.E2.m1.5a"><mrow id="S2.E2.m1.5.5.1"><mrow id="S2.E2.m1.5.5.1.1.2" xref="S2.E2.m1.5.5.1.1.3.cmml"><mrow id="S2.E2.m1.5.5.1.1.1.1" xref="S2.E2.m1.5.5.1.1.1.1.cmml"><msubsup id="S2.E2.m1.5.5.1.1.1.1.3" xref="S2.E2.m1.5.5.1.1.1.1.3.cmml"><mi mathvariant="normal" id="S2.E2.m1.5.5.1.1.1.1.3.2.2" xref="S2.E2.m1.5.5.1.1.1.1.3.2.2.cmml">Δ</mi><mi id="S2.E2.m1.5.5.1.1.1.1.3.3" xref="S2.E2.m1.5.5.1.1.1.1.3.3.cmml">i</mi><mi id="S2.E2.m1.5.5.1.1.1.1.3.2.3" xref="S2.E2.m1.5.5.1.1.1.1.3.2.3.cmml">t</mi></msubsup><mo id="S2.E2.m1.5.5.1.1.1.1.2" xref="S2.E2.m1.5.5.1.1.1.1.2.cmml">=</mo><mrow id="S2.E2.m1.5.5.1.1.1.1.1" xref="S2.E2.m1.5.5.1.1.1.1.1.cmml"><mrow id="S2.E2.m1.5.5.1.1.1.1.1.3" xref="S2.E2.m1.5.5.1.1.1.1.1.3.cmml"><mi id="S2.E2.m1.5.5.1.1.1.1.1.3.2" xref="S2.E2.m1.5.5.1.1.1.1.1.3.2.cmml">α</mi><mo lspace="0.170em" rspace="0em" id="S2.E2.m1.5.5.1.1.1.1.1.3.1" xref="S2.E2.m1.5.5.1.1.1.1.1.3.1.cmml">​</mo><msubsup id="S2.E2.m1.5.5.1.1.1.1.1.3.3" xref="S2.E2.m1.5.5.1.1.1.1.1.3.3.cmml"><mi id="S2.E2.m1.5.5.1.1.1.1.1.3.3.2.2" xref="S2.E2.m1.5.5.1.1.1.1.1.3.3.2.2.cmml">g</mi><mi id="S2.E2.m1.5.5.1.1.1.1.1.3.3.3" xref="S2.E2.m1.5.5.1.1.1.1.1.3.3.3.cmml">i</mi><mi id="S2.E2.m1.5.5.1.1.1.1.1.3.3.2.3" xref="S2.E2.m1.5.5.1.1.1.1.1.3.3.2.3.cmml">t</mi></msubsup></mrow><mo id="S2.E2.m1.5.5.1.1.1.1.1.2" xref="S2.E2.m1.5.5.1.1.1.1.1.2.cmml">+</mo><mrow id="S2.E2.m1.5.5.1.1.1.1.1.1" xref="S2.E2.m1.5.5.1.1.1.1.1.1.cmml"><mrow id="S2.E2.m1.5.5.1.1.1.1.1.1.1.1" xref="S2.E2.m1.5.5.1.1.1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S2.E2.m1.5.5.1.1.1.1.1.1.1.1.2" xref="S2.E2.m1.5.5.1.1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="S2.E2.m1.5.5.1.1.1.1.1.1.1.1.1" xref="S2.E2.m1.5.5.1.1.1.1.1.1.1.1.1.cmml"><mn id="S2.E2.m1.5.5.1.1.1.1.1.1.1.1.1.2" xref="S2.E2.m1.5.5.1.1.1.1.1.1.1.1.1.2.cmml">1</mn><mo id="S2.E2.m1.5.5.1.1.1.1.1.1.1.1.1.1" xref="S2.E2.m1.5.5.1.1.1.1.1.1.1.1.1.1.cmml">−</mo><mi id="S2.E2.m1.5.5.1.1.1.1.1.1.1.1.1.3" xref="S2.E2.m1.5.5.1.1.1.1.1.1.1.1.1.3.cmml">α</mi></mrow><mo stretchy="false" id="S2.E2.m1.5.5.1.1.1.1.1.1.1.1.3" xref="S2.E2.m1.5.5.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow><mo lspace="0.170em" rspace="0em" id="S2.E2.m1.5.5.1.1.1.1.1.1.2" xref="S2.E2.m1.5.5.1.1.1.1.1.1.2.cmml">​</mo><msubsup id="S2.E2.m1.5.5.1.1.1.1.1.1.3" xref="S2.E2.m1.5.5.1.1.1.1.1.1.3.cmml"><mi id="S2.E2.m1.5.5.1.1.1.1.1.1.3.2.2" xref="S2.E2.m1.5.5.1.1.1.1.1.1.3.2.2.cmml">δ</mi><mi id="S2.E2.m1.5.5.1.1.1.1.1.1.3.2.3" xref="S2.E2.m1.5.5.1.1.1.1.1.1.3.2.3.cmml">i</mi><mi id="S2.E2.m1.5.5.1.1.1.1.1.1.3.3" xref="S2.E2.m1.5.5.1.1.1.1.1.1.3.3.cmml">t</mi></msubsup><mo lspace="0em" rspace="0em" id="S2.E2.m1.5.5.1.1.1.1.1.1.2a" xref="S2.E2.m1.5.5.1.1.1.1.1.1.2.cmml">​</mo><mfrac id="S2.E2.m1.2.2" xref="S2.E2.m1.2.2.cmml"><msub id="S2.E2.m1.1.1.1" xref="S2.E2.m1.1.1.1.cmml"><mrow id="S2.E2.m1.1.1.1.1.1" xref="S2.E2.m1.1.1.1.1.2.cmml"><mo stretchy="false" id="S2.E2.m1.1.1.1.1.1.2" xref="S2.E2.m1.1.1.1.1.2.1.cmml">‖</mo><msubsup id="S2.E2.m1.1.1.1.1.1.1" xref="S2.E2.m1.1.1.1.1.1.1.cmml"><mi id="S2.E2.m1.1.1.1.1.1.1.2.2" xref="S2.E2.m1.1.1.1.1.1.1.2.2.cmml">g</mi><mi id="S2.E2.m1.1.1.1.1.1.1.2.3" xref="S2.E2.m1.1.1.1.1.1.1.2.3.cmml">i</mi><mi id="S2.E2.m1.1.1.1.1.1.1.3" xref="S2.E2.m1.1.1.1.1.1.1.3.cmml">t</mi></msubsup><mo stretchy="false" id="S2.E2.m1.1.1.1.1.1.3" xref="S2.E2.m1.1.1.1.1.2.1.cmml">‖</mo></mrow><mn id="S2.E2.m1.1.1.1.3" xref="S2.E2.m1.1.1.1.3.cmml">2</mn></msub><msub id="S2.E2.m1.2.2.2" xref="S2.E2.m1.2.2.2.cmml"><mrow id="S2.E2.m1.2.2.2.1.1" xref="S2.E2.m1.2.2.2.1.2.cmml"><mo stretchy="false" id="S2.E2.m1.2.2.2.1.1.2" xref="S2.E2.m1.2.2.2.1.2.1.cmml">‖</mo><msubsup id="S2.E2.m1.2.2.2.1.1.1" xref="S2.E2.m1.2.2.2.1.1.1.cmml"><mi id="S2.E2.m1.2.2.2.1.1.1.2.2" xref="S2.E2.m1.2.2.2.1.1.1.2.2.cmml">δ</mi><mi id="S2.E2.m1.2.2.2.1.1.1.2.3" xref="S2.E2.m1.2.2.2.1.1.1.2.3.cmml">i</mi><mi id="S2.E2.m1.2.2.2.1.1.1.3" xref="S2.E2.m1.2.2.2.1.1.1.3.cmml">t</mi></msubsup><mo stretchy="false" id="S2.E2.m1.2.2.2.1.1.3" xref="S2.E2.m1.2.2.2.1.2.1.cmml">‖</mo></mrow><mn id="S2.E2.m1.2.2.2.3" xref="S2.E2.m1.2.2.2.3.cmml">2</mn></msub></mfrac></mrow></mrow></mrow><mo lspace="0.170em" rspace="0.337em" id="S2.E2.m1.5.5.1.1.2.3" xref="S2.E2.m1.5.5.1.1.3a.cmml">,</mo><mrow id="S2.E2.m1.5.5.1.1.2.2" xref="S2.E2.m1.5.5.1.1.2.2.cmml"><mi id="S2.E2.m1.5.5.1.1.2.2.2" xref="S2.E2.m1.5.5.1.1.2.2.2.cmml">i</mi><mo id="S2.E2.m1.5.5.1.1.2.2.1" xref="S2.E2.m1.5.5.1.1.2.2.1.cmml">∈</mo><mrow id="S2.E2.m1.5.5.1.1.2.2.3.2" xref="S2.E2.m1.5.5.1.1.2.2.3.1.cmml"><mo stretchy="false" id="S2.E2.m1.5.5.1.1.2.2.3.2.1" xref="S2.E2.m1.5.5.1.1.2.2.3.1.cmml">{</mo><mi id="S2.E2.m1.3.3" xref="S2.E2.m1.3.3.cmml">L</mi><mo id="S2.E2.m1.5.5.1.1.2.2.3.2.2" xref="S2.E2.m1.5.5.1.1.2.2.3.1.cmml">,</mo><mi id="S2.E2.m1.4.4" xref="S2.E2.m1.4.4.cmml">H</mi><mo rspace="0.170em" stretchy="false" id="S2.E2.m1.5.5.1.1.2.2.3.2.3" xref="S2.E2.m1.5.5.1.1.2.2.3.1.cmml">}</mo></mrow></mrow></mrow><mo id="S2.E2.m1.5.5.1.2">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S2.E2.m1.5b"><apply id="S2.E2.m1.5.5.1.1.3.cmml" xref="S2.E2.m1.5.5.1.1.2"><csymbol cd="ambiguous" id="S2.E2.m1.5.5.1.1.3a.cmml" xref="S2.E2.m1.5.5.1.1.2.3">formulae-sequence</csymbol><apply id="S2.E2.m1.5.5.1.1.1.1.cmml" xref="S2.E2.m1.5.5.1.1.1.1"><eq id="S2.E2.m1.5.5.1.1.1.1.2.cmml" xref="S2.E2.m1.5.5.1.1.1.1.2"></eq><apply id="S2.E2.m1.5.5.1.1.1.1.3.cmml" xref="S2.E2.m1.5.5.1.1.1.1.3"><csymbol cd="ambiguous" id="S2.E2.m1.5.5.1.1.1.1.3.1.cmml" xref="S2.E2.m1.5.5.1.1.1.1.3">subscript</csymbol><apply id="S2.E2.m1.5.5.1.1.1.1.3.2.cmml" xref="S2.E2.m1.5.5.1.1.1.1.3"><csymbol cd="ambiguous" id="S2.E2.m1.5.5.1.1.1.1.3.2.1.cmml" xref="S2.E2.m1.5.5.1.1.1.1.3">superscript</csymbol><ci id="S2.E2.m1.5.5.1.1.1.1.3.2.2.cmml" xref="S2.E2.m1.5.5.1.1.1.1.3.2.2">Δ</ci><ci id="S2.E2.m1.5.5.1.1.1.1.3.2.3.cmml" xref="S2.E2.m1.5.5.1.1.1.1.3.2.3">𝑡</ci></apply><ci id="S2.E2.m1.5.5.1.1.1.1.3.3.cmml" xref="S2.E2.m1.5.5.1.1.1.1.3.3">𝑖</ci></apply><apply id="S2.E2.m1.5.5.1.1.1.1.1.cmml" xref="S2.E2.m1.5.5.1.1.1.1.1"><plus id="S2.E2.m1.5.5.1.1.1.1.1.2.cmml" xref="S2.E2.m1.5.5.1.1.1.1.1.2"></plus><apply id="S2.E2.m1.5.5.1.1.1.1.1.3.cmml" xref="S2.E2.m1.5.5.1.1.1.1.1.3"><times id="S2.E2.m1.5.5.1.1.1.1.1.3.1.cmml" xref="S2.E2.m1.5.5.1.1.1.1.1.3.1"></times><ci id="S2.E2.m1.5.5.1.1.1.1.1.3.2.cmml" xref="S2.E2.m1.5.5.1.1.1.1.1.3.2">𝛼</ci><apply id="S2.E2.m1.5.5.1.1.1.1.1.3.3.cmml" xref="S2.E2.m1.5.5.1.1.1.1.1.3.3"><csymbol cd="ambiguous" id="S2.E2.m1.5.5.1.1.1.1.1.3.3.1.cmml" xref="S2.E2.m1.5.5.1.1.1.1.1.3.3">subscript</csymbol><apply id="S2.E2.m1.5.5.1.1.1.1.1.3.3.2.cmml" xref="S2.E2.m1.5.5.1.1.1.1.1.3.3"><csymbol cd="ambiguous" id="S2.E2.m1.5.5.1.1.1.1.1.3.3.2.1.cmml" xref="S2.E2.m1.5.5.1.1.1.1.1.3.3">superscript</csymbol><ci id="S2.E2.m1.5.5.1.1.1.1.1.3.3.2.2.cmml" xref="S2.E2.m1.5.5.1.1.1.1.1.3.3.2.2">𝑔</ci><ci id="S2.E2.m1.5.5.1.1.1.1.1.3.3.2.3.cmml" xref="S2.E2.m1.5.5.1.1.1.1.1.3.3.2.3">𝑡</ci></apply><ci id="S2.E2.m1.5.5.1.1.1.1.1.3.3.3.cmml" xref="S2.E2.m1.5.5.1.1.1.1.1.3.3.3">𝑖</ci></apply></apply><apply id="S2.E2.m1.5.5.1.1.1.1.1.1.cmml" xref="S2.E2.m1.5.5.1.1.1.1.1.1"><times id="S2.E2.m1.5.5.1.1.1.1.1.1.2.cmml" xref="S2.E2.m1.5.5.1.1.1.1.1.1.2"></times><apply id="S2.E2.m1.5.5.1.1.1.1.1.1.1.1.1.cmml" xref="S2.E2.m1.5.5.1.1.1.1.1.1.1.1"><minus id="S2.E2.m1.5.5.1.1.1.1.1.1.1.1.1.1.cmml" xref="S2.E2.m1.5.5.1.1.1.1.1.1.1.1.1.1"></minus><cn type="integer" id="S2.E2.m1.5.5.1.1.1.1.1.1.1.1.1.2.cmml" xref="S2.E2.m1.5.5.1.1.1.1.1.1.1.1.1.2">1</cn><ci id="S2.E2.m1.5.5.1.1.1.1.1.1.1.1.1.3.cmml" xref="S2.E2.m1.5.5.1.1.1.1.1.1.1.1.1.3">𝛼</ci></apply><apply id="S2.E2.m1.5.5.1.1.1.1.1.1.3.cmml" xref="S2.E2.m1.5.5.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S2.E2.m1.5.5.1.1.1.1.1.1.3.1.cmml" xref="S2.E2.m1.5.5.1.1.1.1.1.1.3">superscript</csymbol><apply id="S2.E2.m1.5.5.1.1.1.1.1.1.3.2.cmml" xref="S2.E2.m1.5.5.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S2.E2.m1.5.5.1.1.1.1.1.1.3.2.1.cmml" xref="S2.E2.m1.5.5.1.1.1.1.1.1.3">subscript</csymbol><ci id="S2.E2.m1.5.5.1.1.1.1.1.1.3.2.2.cmml" xref="S2.E2.m1.5.5.1.1.1.1.1.1.3.2.2">𝛿</ci><ci id="S2.E2.m1.5.5.1.1.1.1.1.1.3.2.3.cmml" xref="S2.E2.m1.5.5.1.1.1.1.1.1.3.2.3">𝑖</ci></apply><ci id="S2.E2.m1.5.5.1.1.1.1.1.1.3.3.cmml" xref="S2.E2.m1.5.5.1.1.1.1.1.1.3.3">𝑡</ci></apply><apply id="S2.E2.m1.2.2.cmml" xref="S2.E2.m1.2.2"><divide id="S2.E2.m1.2.2.3.cmml" xref="S2.E2.m1.2.2"></divide><apply id="S2.E2.m1.1.1.1.cmml" xref="S2.E2.m1.1.1.1"><csymbol cd="ambiguous" id="S2.E2.m1.1.1.1.2.cmml" xref="S2.E2.m1.1.1.1">subscript</csymbol><apply id="S2.E2.m1.1.1.1.1.2.cmml" xref="S2.E2.m1.1.1.1.1.1"><csymbol cd="latexml" id="S2.E2.m1.1.1.1.1.2.1.cmml" xref="S2.E2.m1.1.1.1.1.1.2">norm</csymbol><apply id="S2.E2.m1.1.1.1.1.1.1.cmml" xref="S2.E2.m1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S2.E2.m1.1.1.1.1.1.1.1.cmml" xref="S2.E2.m1.1.1.1.1.1.1">superscript</csymbol><apply id="S2.E2.m1.1.1.1.1.1.1.2.cmml" xref="S2.E2.m1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S2.E2.m1.1.1.1.1.1.1.2.1.cmml" xref="S2.E2.m1.1.1.1.1.1.1">subscript</csymbol><ci id="S2.E2.m1.1.1.1.1.1.1.2.2.cmml" xref="S2.E2.m1.1.1.1.1.1.1.2.2">𝑔</ci><ci id="S2.E2.m1.1.1.1.1.1.1.2.3.cmml" xref="S2.E2.m1.1.1.1.1.1.1.2.3">𝑖</ci></apply><ci id="S2.E2.m1.1.1.1.1.1.1.3.cmml" xref="S2.E2.m1.1.1.1.1.1.1.3">𝑡</ci></apply></apply><cn type="integer" id="S2.E2.m1.1.1.1.3.cmml" xref="S2.E2.m1.1.1.1.3">2</cn></apply><apply id="S2.E2.m1.2.2.2.cmml" xref="S2.E2.m1.2.2.2"><csymbol cd="ambiguous" id="S2.E2.m1.2.2.2.2.cmml" xref="S2.E2.m1.2.2.2">subscript</csymbol><apply id="S2.E2.m1.2.2.2.1.2.cmml" xref="S2.E2.m1.2.2.2.1.1"><csymbol cd="latexml" id="S2.E2.m1.2.2.2.1.2.1.cmml" xref="S2.E2.m1.2.2.2.1.1.2">norm</csymbol><apply id="S2.E2.m1.2.2.2.1.1.1.cmml" xref="S2.E2.m1.2.2.2.1.1.1"><csymbol cd="ambiguous" id="S2.E2.m1.2.2.2.1.1.1.1.cmml" xref="S2.E2.m1.2.2.2.1.1.1">superscript</csymbol><apply id="S2.E2.m1.2.2.2.1.1.1.2.cmml" xref="S2.E2.m1.2.2.2.1.1.1"><csymbol cd="ambiguous" id="S2.E2.m1.2.2.2.1.1.1.2.1.cmml" xref="S2.E2.m1.2.2.2.1.1.1">subscript</csymbol><ci id="S2.E2.m1.2.2.2.1.1.1.2.2.cmml" xref="S2.E2.m1.2.2.2.1.1.1.2.2">𝛿</ci><ci id="S2.E2.m1.2.2.2.1.1.1.2.3.cmml" xref="S2.E2.m1.2.2.2.1.1.1.2.3">𝑖</ci></apply><ci id="S2.E2.m1.2.2.2.1.1.1.3.cmml" xref="S2.E2.m1.2.2.2.1.1.1.3">𝑡</ci></apply></apply><cn type="integer" id="S2.E2.m1.2.2.2.3.cmml" xref="S2.E2.m1.2.2.2.3">2</cn></apply></apply></apply></apply></apply><apply id="S2.E2.m1.5.5.1.1.2.2.cmml" xref="S2.E2.m1.5.5.1.1.2.2"><in id="S2.E2.m1.5.5.1.1.2.2.1.cmml" xref="S2.E2.m1.5.5.1.1.2.2.1"></in><ci id="S2.E2.m1.5.5.1.1.2.2.2.cmml" xref="S2.E2.m1.5.5.1.1.2.2.2">𝑖</ci><set id="S2.E2.m1.5.5.1.1.2.2.3.1.cmml" xref="S2.E2.m1.5.5.1.1.2.2.3.2"><ci id="S2.E2.m1.3.3.cmml" xref="S2.E2.m1.3.3">𝐿</ci><ci id="S2.E2.m1.4.4.cmml" xref="S2.E2.m1.4.4">𝐻</ci></set></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.E2.m1.5c">\Delta^{t}_{i}=\alpha\,g^{t}_{i}+(1-\alpha)\,\delta_{i}^{t}\,\frac{\|g_{i}^{t}\|_{2}}{\|\delta_{i}^{t}\|_{2}}\,,\,i\in\{L,H\}\,,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(2)</span></td>
</tr></tbody>
</table>
<p id="S2.SS2.p2.22" class="ltx_p">where <math id="S2.SS2.p2.20.m1.1" class="ltx_math_unparsed" alttext="\|\cdot\|_{2}" display="inline"><semantics id="S2.SS2.p2.20.m1.1a"><mrow id="S2.SS2.p2.20.m1.1b"><mo rspace="0em" id="S2.SS2.p2.20.m1.1.1">∥</mo><mo lspace="0em" rspace="0em" id="S2.SS2.p2.20.m1.1.2">⋅</mo><msub id="S2.SS2.p2.20.m1.1.3"><mo lspace="0em" id="S2.SS2.p2.20.m1.1.3.2">∥</mo><mn id="S2.SS2.p2.20.m1.1.3.3">2</mn></msub></mrow><annotation encoding="application/x-tex" id="S2.SS2.p2.20.m1.1c">\|\cdot\|_{2}</annotation></semantics></math> denotes <math id="S2.SS2.p2.21.m2.1" class="ltx_Math" alttext="\mathrm{L}_{2}" display="inline"><semantics id="S2.SS2.p2.21.m2.1a"><msub id="S2.SS2.p2.21.m2.1.1" xref="S2.SS2.p2.21.m2.1.1.cmml"><mi mathvariant="normal" id="S2.SS2.p2.21.m2.1.1.2" xref="S2.SS2.p2.21.m2.1.1.2.cmml">L</mi><mn id="S2.SS2.p2.21.m2.1.1.3" xref="S2.SS2.p2.21.m2.1.1.3.cmml">2</mn></msub><annotation-xml encoding="MathML-Content" id="S2.SS2.p2.21.m2.1b"><apply id="S2.SS2.p2.21.m2.1.1.cmml" xref="S2.SS2.p2.21.m2.1.1"><csymbol cd="ambiguous" id="S2.SS2.p2.21.m2.1.1.1.cmml" xref="S2.SS2.p2.21.m2.1.1">subscript</csymbol><ci id="S2.SS2.p2.21.m2.1.1.2.cmml" xref="S2.SS2.p2.21.m2.1.1.2">L</ci><cn type="integer" id="S2.SS2.p2.21.m2.1.1.3.cmml" xref="S2.SS2.p2.21.m2.1.1.3">2</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p2.21.m2.1c">\mathrm{L}_{2}</annotation></semantics></math>-norm. We then use the merged gradient for each model to perform the update and move on to the next <span id="S2.SS2.p2.22.1" class="ltx_text ltx_font_smallcaps">FedAvg</span> round. Note that in this setting, <math id="S2.SS2.p2.22.m3.1" class="ltx_Math" alttext="\alpha=1" display="inline"><semantics id="S2.SS2.p2.22.m3.1a"><mrow id="S2.SS2.p2.22.m3.1.1" xref="S2.SS2.p2.22.m3.1.1.cmml"><mi id="S2.SS2.p2.22.m3.1.1.2" xref="S2.SS2.p2.22.m3.1.1.2.cmml">α</mi><mo id="S2.SS2.p2.22.m3.1.1.1" xref="S2.SS2.p2.22.m3.1.1.1.cmml">=</mo><mn id="S2.SS2.p2.22.m3.1.1.3" xref="S2.SS2.p2.22.m3.1.1.3.cmml">1</mn></mrow><annotation-xml encoding="MathML-Content" id="S2.SS2.p2.22.m3.1b"><apply id="S2.SS2.p2.22.m3.1.1.cmml" xref="S2.SS2.p2.22.m3.1.1"><eq id="S2.SS2.p2.22.m3.1.1.1.cmml" xref="S2.SS2.p2.22.m3.1.1.1"></eq><ci id="S2.SS2.p2.22.m3.1.1.2.cmml" xref="S2.SS2.p2.22.m3.1.1.2">𝛼</ci><cn type="integer" id="S2.SS2.p2.22.m3.1.1.3.cmml" xref="S2.SS2.p2.22.m3.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.SS2.p2.22.m3.1c">\alpha=1</annotation></semantics></math> recovers the vanilla <span id="S2.SS2.p2.22.2" class="ltx_text ltx_font_smallcaps">FedAvg</span> approach. The <span id="S2.SS2.p2.22.3" class="ltx_text ltx_font_smallcaps">MergedCodist</span> approach is summarized in Algorithm <a href="#alg2" title="Algorithm 2 ‣ Appendix B Methods ‣ Heterogeneous Federated Learning Using Knowledge Codistillation" class="ltx_ref"><span class="ltx_text ltx_ref_tag">2</span></a> and illustrated in Figure <a href="#A2.F2" title="Figure 2 ‣ Appendix B Methods ‣ Heterogeneous Federated Learning Using Knowledge Codistillation" class="ltx_ref"><span class="ltx_text ltx_ref_tag">2</span></a>(b) in Appendix <a href="#A2" title="Appendix B Methods ‣ Heterogeneous Federated Learning Using Knowledge Codistillation" class="ltx_ref"><span class="ltx_text ltx_ref_tag">B</span></a>.</p>
</div>
</section>
</section>
<section id="S3" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">3 </span>Experiments</h2>

<div id="S3.p1" class="ltx_para">
<p id="S3.p1.1" class="ltx_p">In this section, we provide experimental results. The details of the experimental setups are shown in Appendix <a href="#A3" title="Appendix C Experiment Setup ‣ Heterogeneous Federated Learning Using Knowledge Codistillation" class="ltx_ref"><span class="ltx_text ltx_ref_tag">C</span></a>.</p>
</div>
<section id="S3.SS1" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.1 </span>Balanced Model Performance</h3>

<div id="S3.SS1.p1" class="ltx_para">
<p id="S3.SS1.p1.2" class="ltx_p">As we are interested in sharing information between the two server models, we first explore an experimental setup where the two models obtain similar performance and where knowledge distillation does not have to work against a large gap in performance between the teacher and the student. To accomplish this, we sample <math id="S3.SS1.p1.1.m1.1" class="ltx_Math" alttext="\sim" display="inline"><semantics id="S3.SS1.p1.1.m1.1a"><mo id="S3.SS1.p1.1.m1.1.1" xref="S3.SS1.p1.1.m1.1.1.cmml">∼</mo><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.1.m1.1b"><csymbol cd="latexml" id="S3.SS1.p1.1.m1.1.1.cmml" xref="S3.SS1.p1.1.m1.1.1">similar-to</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.1.m1.1c">\sim</annotation></semantics></math>700 clients from the StackOverflow dataset and <math id="S3.SS1.p1.2.m2.1" class="ltx_Math" alttext="\sim" display="inline"><semantics id="S3.SS1.p1.2.m2.1a"><mo id="S3.SS1.p1.2.m2.1.1" xref="S3.SS1.p1.2.m2.1.1.cmml">∼</mo><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.2.m2.1b"><csymbol cd="latexml" id="S3.SS1.p1.2.m2.1.1.cmml" xref="S3.SS1.p1.2.m2.1.1">similar-to</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.2.m2.1c">\sim</annotation></semantics></math>50 clients from the CIFAR-100 dataset as the high-capacity pools in their respective experiments. The data splits used are shown in Appendix <a href="#A3" title="Appendix C Experiment Setup ‣ Heterogeneous Federated Learning Using Knowledge Codistillation" class="ltx_ref"><span class="ltx_text ltx_ref_tag">C</span></a>. Acquiring in-domain unlabeled corpora for the distillation dataset may be even infeasible, but for many tasks, large out-of-domain corpora are often available. To evaluate how sensitive the distillation methods may be to distillation data domain shift, we run experiments with both in- and out-of-domain data. For image classification and language modeling, we use CIFAR-10 and C4-MOD, respectively, as the out-of-domain datasets. Results are shown in the middle column of Table <a href="#S3.T1" title="Table 1 ‣ 3.1 Balanced Model Performance ‣ 3 Experiments ‣ Heterogeneous Federated Learning Using Knowledge Codistillation" class="ltx_ref"><span class="ltx_text ltx_ref_tag">1</span></a>. When the small and large models have similar performance <span id="S3.SS1.p1.2.1" class="ltx_text ltx_font_smallcaps">PeriodicCodist</span> and <span id="S3.SS1.p1.2.2" class="ltx_text ltx_font_smallcaps">MergedCodist</span> can improve performance over baseline <span id="S3.SS1.p1.2.3" class="ltx_text ltx_font_smallcaps">FedAvg</span> for both small and large models. The gains are greater when in-domain distillation data is available, but it is still possible to obtain gains using out-of-domain distillation data. The <span id="S3.SS1.p1.2.4" class="ltx_text ltx_font_smallcaps">MergedCodist</span> technique yields gains in both tasks for both models.</p>
</div>
<figure id="S3.T1" class="ltx_table">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_table">Table 1: </span>Accuracy on the test set, showing performance versus relative strength of the high-capacity model for both in- and out-of-domain distillation data. <math id="S3.T1.2.m1.1" class="ltx_Math" alttext="|\mathcal{P}_{H}|" display="inline"><semantics id="S3.T1.2.m1.1b"><mrow id="S3.T1.2.m1.1.1.1" xref="S3.T1.2.m1.1.1.2.cmml"><mo stretchy="false" id="S3.T1.2.m1.1.1.1.2" xref="S3.T1.2.m1.1.1.2.1.cmml">|</mo><msub id="S3.T1.2.m1.1.1.1.1" xref="S3.T1.2.m1.1.1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.T1.2.m1.1.1.1.1.2" xref="S3.T1.2.m1.1.1.1.1.2.cmml">𝒫</mi><mi id="S3.T1.2.m1.1.1.1.1.3" xref="S3.T1.2.m1.1.1.1.1.3.cmml">H</mi></msub><mo stretchy="false" id="S3.T1.2.m1.1.1.1.3" xref="S3.T1.2.m1.1.1.2.1.cmml">|</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.T1.2.m1.1c"><apply id="S3.T1.2.m1.1.1.2.cmml" xref="S3.T1.2.m1.1.1.1"><abs id="S3.T1.2.m1.1.1.2.1.cmml" xref="S3.T1.2.m1.1.1.1.2"></abs><apply id="S3.T1.2.m1.1.1.1.1.cmml" xref="S3.T1.2.m1.1.1.1.1"><csymbol cd="ambiguous" id="S3.T1.2.m1.1.1.1.1.1.cmml" xref="S3.T1.2.m1.1.1.1.1">subscript</csymbol><ci id="S3.T1.2.m1.1.1.1.1.2.cmml" xref="S3.T1.2.m1.1.1.1.1.2">𝒫</ci><ci id="S3.T1.2.m1.1.1.1.1.3.cmml" xref="S3.T1.2.m1.1.1.1.1.3">𝐻</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.T1.2.m1.1d">|\mathcal{P}_{H}|</annotation></semantics></math> represents the size of the high-capacity pool in number of examples. Best-performing models in each setup are in bold. The central column shows roughly balanced performance between the small and large models, as described in Section <a href="#S3.SS1" title="3.1 Balanced Model Performance ‣ 3 Experiments ‣ Heterogeneous Federated Learning Using Knowledge Codistillation" class="ltx_ref"><span class="ltx_text ltx_ref_tag">3.1</span></a>.</figcaption>
<div id="S3.T1.8.6" class="ltx_inline-block ltx_align_center ltx_transformed_outer" style="width:650.4pt;height:586.1pt;vertical-align:-0.0pt;"><span class="ltx_transformed_inner" style="transform:translate(165.4pt,-149.1pt) scale(2.03513450105222,2.03513450105222) ;">
<table id="S3.T1.8.6.6" class="ltx_tabular ltx_guessed_headers ltx_align_middle">
<tbody class="ltx_tbody">
<tr id="S3.T1.8.6.6.7.1" class="ltx_tr">
<th id="S3.T1.8.6.6.7.1.1" class="ltx_td ltx_th ltx_th_row ltx_border_tt"></th>
<td id="S3.T1.8.6.6.7.1.2" class="ltx_td ltx_border_r ltx_border_tt"></td>
<th id="S3.T1.8.6.6.7.1.3" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_tt" colspan="6"><span id="S3.T1.8.6.6.7.1.3.1" class="ltx_text ltx_font_smallcaps" style="font-size:90%;">CIFAR</span></th>
</tr>
<tr id="S3.T1.5.3.3.3" class="ltx_tr">
<th id="S3.T1.5.3.3.3.4" class="ltx_td ltx_th ltx_th_row"></th>
<td id="S3.T1.5.3.3.3.5" class="ltx_td ltx_align_center ltx_border_r"><span id="S3.T1.5.3.3.3.5.1" class="ltx_text ltx_font_smallcaps" style="font-size:90%;">in-domain</span></td>
<th id="S3.T1.3.1.1.1.1" class="ltx_td ltx_align_center ltx_th ltx_th_row" colspan="2">
<span id="S3.T1.3.1.1.1.1.1" class="ltx_text ltx_font_smallcaps" style="font-size:90%;"></span><math id="S3.T1.3.1.1.1.1.m1.1" class="ltx_Math" alttext="|\mathcal{P}_{H}|" display="inline"><semantics id="S3.T1.3.1.1.1.1.m1.1a"><mrow id="S3.T1.3.1.1.1.1.m1.1.1.1" xref="S3.T1.3.1.1.1.1.m1.1.1.2.cmml"><mo maxsize="90%" minsize="90%" id="S3.T1.3.1.1.1.1.m1.1.1.1.2" xref="S3.T1.3.1.1.1.1.m1.1.1.2.1.cmml">|</mo><msub id="S3.T1.3.1.1.1.1.m1.1.1.1.1" xref="S3.T1.3.1.1.1.1.m1.1.1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" mathsize="90%" id="S3.T1.3.1.1.1.1.m1.1.1.1.1.2" xref="S3.T1.3.1.1.1.1.m1.1.1.1.1.2.cmml">𝒫</mi><mi mathsize="90%" id="S3.T1.3.1.1.1.1.m1.1.1.1.1.3" xref="S3.T1.3.1.1.1.1.m1.1.1.1.1.3.cmml">H</mi></msub><mo maxsize="90%" minsize="90%" id="S3.T1.3.1.1.1.1.m1.1.1.1.3" xref="S3.T1.3.1.1.1.1.m1.1.1.2.1.cmml">|</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.T1.3.1.1.1.1.m1.1b"><apply id="S3.T1.3.1.1.1.1.m1.1.1.2.cmml" xref="S3.T1.3.1.1.1.1.m1.1.1.1"><abs id="S3.T1.3.1.1.1.1.m1.1.1.2.1.cmml" xref="S3.T1.3.1.1.1.1.m1.1.1.1.2"></abs><apply id="S3.T1.3.1.1.1.1.m1.1.1.1.1.cmml" xref="S3.T1.3.1.1.1.1.m1.1.1.1.1"><csymbol cd="ambiguous" id="S3.T1.3.1.1.1.1.m1.1.1.1.1.1.cmml" xref="S3.T1.3.1.1.1.1.m1.1.1.1.1">subscript</csymbol><ci id="S3.T1.3.1.1.1.1.m1.1.1.1.1.2.cmml" xref="S3.T1.3.1.1.1.1.m1.1.1.1.1.2">𝒫</ci><ci id="S3.T1.3.1.1.1.1.m1.1.1.1.1.3.cmml" xref="S3.T1.3.1.1.1.1.m1.1.1.1.1.3">𝐻</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.T1.3.1.1.1.1.m1.1c">|\mathcal{P}_{H}|</annotation></semantics></math><span id="S3.T1.3.1.1.1.1.2" class="ltx_text ltx_font_smallcaps" style="font-size:90%;">=3100</span>
</th>
<th id="S3.T1.4.2.2.2.2" class="ltx_td ltx_align_center ltx_th ltx_th_row" colspan="2">
<span id="S3.T1.4.2.2.2.2.1" class="ltx_text ltx_font_smallcaps" style="font-size:90%;"></span><math id="S3.T1.4.2.2.2.2.m1.1" class="ltx_Math" alttext="|\mathcal{P}_{H}|" display="inline"><semantics id="S3.T1.4.2.2.2.2.m1.1a"><mrow id="S3.T1.4.2.2.2.2.m1.1.1.1" xref="S3.T1.4.2.2.2.2.m1.1.1.2.cmml"><mo maxsize="90%" minsize="90%" id="S3.T1.4.2.2.2.2.m1.1.1.1.2" xref="S3.T1.4.2.2.2.2.m1.1.1.2.1.cmml">|</mo><msub id="S3.T1.4.2.2.2.2.m1.1.1.1.1" xref="S3.T1.4.2.2.2.2.m1.1.1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" mathsize="90%" id="S3.T1.4.2.2.2.2.m1.1.1.1.1.2" xref="S3.T1.4.2.2.2.2.m1.1.1.1.1.2.cmml">𝒫</mi><mi mathsize="90%" id="S3.T1.4.2.2.2.2.m1.1.1.1.1.3" xref="S3.T1.4.2.2.2.2.m1.1.1.1.1.3.cmml">H</mi></msub><mo maxsize="90%" minsize="90%" id="S3.T1.4.2.2.2.2.m1.1.1.1.3" xref="S3.T1.4.2.2.2.2.m1.1.1.2.1.cmml">|</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.T1.4.2.2.2.2.m1.1b"><apply id="S3.T1.4.2.2.2.2.m1.1.1.2.cmml" xref="S3.T1.4.2.2.2.2.m1.1.1.1"><abs id="S3.T1.4.2.2.2.2.m1.1.1.2.1.cmml" xref="S3.T1.4.2.2.2.2.m1.1.1.1.2"></abs><apply id="S3.T1.4.2.2.2.2.m1.1.1.1.1.cmml" xref="S3.T1.4.2.2.2.2.m1.1.1.1.1"><csymbol cd="ambiguous" id="S3.T1.4.2.2.2.2.m1.1.1.1.1.1.cmml" xref="S3.T1.4.2.2.2.2.m1.1.1.1.1">subscript</csymbol><ci id="S3.T1.4.2.2.2.2.m1.1.1.1.1.2.cmml" xref="S3.T1.4.2.2.2.2.m1.1.1.1.1.2">𝒫</ci><ci id="S3.T1.4.2.2.2.2.m1.1.1.1.1.3.cmml" xref="S3.T1.4.2.2.2.2.m1.1.1.1.1.3">𝐻</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.T1.4.2.2.2.2.m1.1c">|\mathcal{P}_{H}|</annotation></semantics></math><span id="S3.T1.4.2.2.2.2.2" class="ltx_text ltx_font_smallcaps" style="font-size:90%;">=4700</span>
</th>
<th id="S3.T1.5.3.3.3.3" class="ltx_td ltx_align_center ltx_th ltx_th_row" colspan="2">
<span id="S3.T1.5.3.3.3.3.1" class="ltx_text ltx_font_smallcaps" style="font-size:90%;"></span><math id="S3.T1.5.3.3.3.3.m1.1" class="ltx_Math" alttext="|\mathcal{P}_{H}|" display="inline"><semantics id="S3.T1.5.3.3.3.3.m1.1a"><mrow id="S3.T1.5.3.3.3.3.m1.1.1.1" xref="S3.T1.5.3.3.3.3.m1.1.1.2.cmml"><mo maxsize="90%" minsize="90%" id="S3.T1.5.3.3.3.3.m1.1.1.1.2" xref="S3.T1.5.3.3.3.3.m1.1.1.2.1.cmml">|</mo><msub id="S3.T1.5.3.3.3.3.m1.1.1.1.1" xref="S3.T1.5.3.3.3.3.m1.1.1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" mathsize="90%" id="S3.T1.5.3.3.3.3.m1.1.1.1.1.2" xref="S3.T1.5.3.3.3.3.m1.1.1.1.1.2.cmml">𝒫</mi><mi mathsize="90%" id="S3.T1.5.3.3.3.3.m1.1.1.1.1.3" xref="S3.T1.5.3.3.3.3.m1.1.1.1.1.3.cmml">H</mi></msub><mo maxsize="90%" minsize="90%" id="S3.T1.5.3.3.3.3.m1.1.1.1.3" xref="S3.T1.5.3.3.3.3.m1.1.1.2.1.cmml">|</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.T1.5.3.3.3.3.m1.1b"><apply id="S3.T1.5.3.3.3.3.m1.1.1.2.cmml" xref="S3.T1.5.3.3.3.3.m1.1.1.1"><abs id="S3.T1.5.3.3.3.3.m1.1.1.2.1.cmml" xref="S3.T1.5.3.3.3.3.m1.1.1.1.2"></abs><apply id="S3.T1.5.3.3.3.3.m1.1.1.1.1.cmml" xref="S3.T1.5.3.3.3.3.m1.1.1.1.1"><csymbol cd="ambiguous" id="S3.T1.5.3.3.3.3.m1.1.1.1.1.1.cmml" xref="S3.T1.5.3.3.3.3.m1.1.1.1.1">subscript</csymbol><ci id="S3.T1.5.3.3.3.3.m1.1.1.1.1.2.cmml" xref="S3.T1.5.3.3.3.3.m1.1.1.1.1.2">𝒫</ci><ci id="S3.T1.5.3.3.3.3.m1.1.1.1.1.3.cmml" xref="S3.T1.5.3.3.3.3.m1.1.1.1.1.3">𝐻</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.T1.5.3.3.3.3.m1.1c">|\mathcal{P}_{H}|</annotation></semantics></math><span id="S3.T1.5.3.3.3.3.2" class="ltx_text ltx_font_smallcaps" style="font-size:90%;">=6300</span>
</th>
</tr>
<tr id="S3.T1.8.6.6.8.2" class="ltx_tr">
<th id="S3.T1.8.6.6.8.2.1" class="ltx_td ltx_th ltx_th_row"></th>
<td id="S3.T1.8.6.6.8.2.2" class="ltx_td ltx_border_r"></td>
<th id="S3.T1.8.6.6.8.2.3" class="ltx_td ltx_align_center ltx_th ltx_th_row"><span id="S3.T1.8.6.6.8.2.3.1" class="ltx_text ltx_font_smallcaps" style="font-size:90%;">small</span></th>
<td id="S3.T1.8.6.6.8.2.4" class="ltx_td ltx_align_center ltx_border_r"><span id="S3.T1.8.6.6.8.2.4.1" class="ltx_text ltx_font_smallcaps" style="font-size:90%;">large</span></td>
<th id="S3.T1.8.6.6.8.2.5" class="ltx_td ltx_align_center ltx_th ltx_th_row"><span id="S3.T1.8.6.6.8.2.5.1" class="ltx_text ltx_font_smallcaps" style="font-size:90%;">small</span></th>
<td id="S3.T1.8.6.6.8.2.6" class="ltx_td ltx_align_center ltx_border_r"><span id="S3.T1.8.6.6.8.2.6.1" class="ltx_text ltx_font_smallcaps" style="font-size:90%;">large</span></td>
<th id="S3.T1.8.6.6.8.2.7" class="ltx_td ltx_align_center ltx_th ltx_th_row"><span id="S3.T1.8.6.6.8.2.7.1" class="ltx_text ltx_font_smallcaps" style="font-size:90%;">small</span></th>
<td id="S3.T1.8.6.6.8.2.8" class="ltx_td ltx_align_center"><span id="S3.T1.8.6.6.8.2.8.1" class="ltx_text ltx_font_smallcaps" style="font-size:90%;">large</span></td>
</tr>
<tr id="S3.T1.8.6.6.9.3" class="ltx_tr">
<th id="S3.T1.8.6.6.9.3.1" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_t"><span id="S3.T1.8.6.6.9.3.1.1" class="ltx_text ltx_font_smallcaps" style="font-size:90%;">FedAvg</span></th>
<td id="S3.T1.8.6.6.9.3.2" class="ltx_td ltx_border_r ltx_border_t"></td>
<th id="S3.T1.8.6.6.9.3.3" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_t"><span id="S3.T1.8.6.6.9.3.3.1" class="ltx_text ltx_font_smallcaps" style="font-size:90%;">31.84</span></th>
<td id="S3.T1.8.6.6.9.3.4" class="ltx_td ltx_align_center ltx_border_r ltx_border_t"><span id="S3.T1.8.6.6.9.3.4.1" class="ltx_text ltx_font_smallcaps" style="font-size:90%;">24.76</span></td>
<th id="S3.T1.8.6.6.9.3.5" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_t"><span id="S3.T1.8.6.6.9.3.5.1" class="ltx_text ltx_font_smallcaps" style="font-size:90%;">31.84</span></th>
<td id="S3.T1.8.6.6.9.3.6" class="ltx_td ltx_align_center ltx_border_r ltx_border_t"><span id="S3.T1.8.6.6.9.3.6.1" class="ltx_text ltx_font_smallcaps" style="font-size:90%;">30.57</span></td>
<th id="S3.T1.8.6.6.9.3.7" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_t"><span id="S3.T1.8.6.6.9.3.7.1" class="ltx_text ltx_font_smallcaps" style="font-size:90%;">31.84</span></th>
<td id="S3.T1.8.6.6.9.3.8" class="ltx_td ltx_align_center ltx_border_t"><span id="S3.T1.8.6.6.9.3.8.1" class="ltx_text ltx_font_smallcaps" style="font-size:90%;">35.10</span></td>
</tr>
<tr id="S3.T1.8.6.6.10.4" class="ltx_tr">
<th id="S3.T1.8.6.6.10.4.1" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_t"><span id="S3.T1.8.6.6.10.4.1.1" class="ltx_text ltx_font_smallcaps" style="font-size:90%;">PeriodicCodist</span></th>
<td id="S3.T1.8.6.6.10.4.2" class="ltx_td ltx_align_center ltx_border_r ltx_border_t"><span id="S3.T1.8.6.6.10.4.2.1" class="ltx_text ltx_font_smallcaps" style="font-size:90%;">✓</span></td>
<th id="S3.T1.8.6.6.10.4.3" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_t"><span id="S3.T1.8.6.6.10.4.3.1" class="ltx_text ltx_font_bold" style="font-size:90%;">33.95</span></th>
<td id="S3.T1.8.6.6.10.4.4" class="ltx_td ltx_align_center ltx_border_r ltx_border_t"><span id="S3.T1.8.6.6.10.4.4.1" class="ltx_text ltx_font_smallcaps" style="font-size:90%;">31.09</span></td>
<th id="S3.T1.8.6.6.10.4.5" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_t"><span id="S3.T1.8.6.6.10.4.5.1" class="ltx_text ltx_font_bold" style="font-size:90%;">34.36</span></th>
<td id="S3.T1.8.6.6.10.4.6" class="ltx_td ltx_align_center ltx_border_r ltx_border_t"><span id="S3.T1.8.6.6.10.4.6.1" class="ltx_text ltx_font_bold" style="font-size:90%;">35.08</span></td>
<th id="S3.T1.8.6.6.10.4.7" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_t"><span id="S3.T1.8.6.6.10.4.7.1" class="ltx_text ltx_font_bold" style="font-size:90%;">35.68</span></th>
<td id="S3.T1.8.6.6.10.4.8" class="ltx_td ltx_align_center ltx_border_t"><span id="S3.T1.8.6.6.10.4.8.1" class="ltx_text ltx_font_bold" style="font-size:90%;">37.20</span></td>
</tr>
<tr id="S3.T1.8.6.6.11.5" class="ltx_tr">
<th id="S3.T1.8.6.6.11.5.1" class="ltx_td ltx_align_center ltx_th ltx_th_row"><span id="S3.T1.8.6.6.11.5.1.1" class="ltx_text ltx_font_smallcaps" style="font-size:90%;">MergedCodist</span></th>
<td id="S3.T1.8.6.6.11.5.2" class="ltx_td ltx_align_center ltx_border_r"><span id="S3.T1.8.6.6.11.5.2.1" class="ltx_text ltx_font_smallcaps" style="font-size:90%;">✓</span></td>
<th id="S3.T1.8.6.6.11.5.3" class="ltx_td ltx_align_center ltx_th ltx_th_row"><span id="S3.T1.8.6.6.11.5.3.1" class="ltx_text ltx_font_smallcaps" style="font-size:90%;">32.86</span></th>
<td id="S3.T1.8.6.6.11.5.4" class="ltx_td ltx_align_center ltx_border_r"><span id="S3.T1.8.6.6.11.5.4.1" class="ltx_text ltx_font_bold" style="font-size:90%;">31.98</span></td>
<th id="S3.T1.8.6.6.11.5.5" class="ltx_td ltx_align_center ltx_th ltx_th_row"><span id="S3.T1.8.6.6.11.5.5.1" class="ltx_text ltx_font_smallcaps" style="font-size:90%;">33.86</span></th>
<td id="S3.T1.8.6.6.11.5.6" class="ltx_td ltx_align_center ltx_border_r"><span id="S3.T1.8.6.6.11.5.6.1" class="ltx_text ltx_font_smallcaps" style="font-size:90%;">33.15</span></td>
<th id="S3.T1.8.6.6.11.5.7" class="ltx_td ltx_align_center ltx_th ltx_th_row"><span id="S3.T1.8.6.6.11.5.7.1" class="ltx_text ltx_font_smallcaps" style="font-size:90%;">33.78</span></th>
<td id="S3.T1.8.6.6.11.5.8" class="ltx_td ltx_align_center"><span id="S3.T1.8.6.6.11.5.8.1" class="ltx_text ltx_font_smallcaps" style="font-size:90%;">33.96</span></td>
</tr>
<tr id="S3.T1.8.6.6.12.6" class="ltx_tr">
<th id="S3.T1.8.6.6.12.6.1" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_t"><span id="S3.T1.8.6.6.12.6.1.1" class="ltx_text ltx_font_smallcaps" style="font-size:90%;">PeriodicCodist</span></th>
<td id="S3.T1.8.6.6.12.6.2" class="ltx_td ltx_align_center ltx_border_r ltx_border_t"><span id="S3.T1.8.6.6.12.6.2.1" class="ltx_text ltx_font_smallcaps" style="font-size:90%;">x</span></td>
<th id="S3.T1.8.6.6.12.6.3" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_t"><span id="S3.T1.8.6.6.12.6.3.1" class="ltx_text ltx_font_smallcaps" style="font-size:90%;">33.75</span></th>
<td id="S3.T1.8.6.6.12.6.4" class="ltx_td ltx_align_center ltx_border_r ltx_border_t"><span id="S3.T1.8.6.6.12.6.4.1" class="ltx_text ltx_font_smallcaps" style="font-size:90%;">25.03</span></td>
<th id="S3.T1.8.6.6.12.6.5" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_t"><span id="S3.T1.8.6.6.12.6.5.1" class="ltx_text ltx_font_smallcaps" style="font-size:90%;">34.02</span></th>
<td id="S3.T1.8.6.6.12.6.6" class="ltx_td ltx_align_center ltx_border_r ltx_border_t"><span id="S3.T1.8.6.6.12.6.6.1" class="ltx_text ltx_font_smallcaps" style="font-size:90%;">30.53</span></td>
<th id="S3.T1.8.6.6.12.6.7" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_t"><span id="S3.T1.8.6.6.12.6.7.1" class="ltx_text ltx_font_smallcaps" style="font-size:90%;">33.37</span></th>
<td id="S3.T1.8.6.6.12.6.8" class="ltx_td ltx_align_center ltx_border_t"><span id="S3.T1.8.6.6.12.6.8.1" class="ltx_text ltx_font_smallcaps" style="font-size:90%;">34.27</span></td>
</tr>
<tr id="S3.T1.8.6.6.13.7" class="ltx_tr">
<th id="S3.T1.8.6.6.13.7.1" class="ltx_td ltx_align_center ltx_th ltx_th_row"><span id="S3.T1.8.6.6.13.7.1.1" class="ltx_text ltx_font_smallcaps" style="font-size:90%;">MergedCodist</span></th>
<td id="S3.T1.8.6.6.13.7.2" class="ltx_td ltx_align_center ltx_border_r"><span id="S3.T1.8.6.6.13.7.2.1" class="ltx_text ltx_font_smallcaps" style="font-size:90%;">x</span></td>
<th id="S3.T1.8.6.6.13.7.3" class="ltx_td ltx_align_center ltx_th ltx_th_row"><span id="S3.T1.8.6.6.13.7.3.1" class="ltx_text ltx_font_smallcaps" style="font-size:90%;">33.02</span></th>
<td id="S3.T1.8.6.6.13.7.4" class="ltx_td ltx_align_center ltx_border_r"><span id="S3.T1.8.6.6.13.7.4.1" class="ltx_text ltx_font_smallcaps" style="font-size:90%;">25.83</span></td>
<th id="S3.T1.8.6.6.13.7.5" class="ltx_td ltx_align_center ltx_th ltx_th_row"><span id="S3.T1.8.6.6.13.7.5.1" class="ltx_text ltx_font_smallcaps" style="font-size:90%;">33.45</span></th>
<td id="S3.T1.8.6.6.13.7.6" class="ltx_td ltx_align_center ltx_border_r"><span id="S3.T1.8.6.6.13.7.6.1" class="ltx_text ltx_font_smallcaps" style="font-size:90%;">31.02</span></td>
<th id="S3.T1.8.6.6.13.7.7" class="ltx_td ltx_align_center ltx_th ltx_th_row"><span id="S3.T1.8.6.6.13.7.7.1" class="ltx_text ltx_font_smallcaps" style="font-size:90%;">33.03</span></th>
<td id="S3.T1.8.6.6.13.7.8" class="ltx_td ltx_align_center"><span id="S3.T1.8.6.6.13.7.8.1" class="ltx_text ltx_font_smallcaps" style="font-size:90%;">33.47</span></td>
</tr>
<tr id="S3.T1.8.6.6.14.8" class="ltx_tr">
<th id="S3.T1.8.6.6.14.8.1" class="ltx_td ltx_th ltx_th_row ltx_border_tt"></th>
<td id="S3.T1.8.6.6.14.8.2" class="ltx_td ltx_border_r ltx_border_tt"></td>
<th id="S3.T1.8.6.6.14.8.3" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_tt" colspan="6"><span id="S3.T1.8.6.6.14.8.3.1" class="ltx_text ltx_font_smallcaps" style="font-size:90%;">StackOverflow</span></th>
</tr>
<tr id="S3.T1.8.6.6.6" class="ltx_tr">
<th id="S3.T1.8.6.6.6.4" class="ltx_td ltx_th ltx_th_row"></th>
<td id="S3.T1.8.6.6.6.5" class="ltx_td ltx_align_center ltx_border_r"><span id="S3.T1.8.6.6.6.5.1" class="ltx_text ltx_font_smallcaps" style="font-size:90%;">in-domain</span></td>
<th id="S3.T1.6.4.4.4.1" class="ltx_td ltx_align_center ltx_th ltx_th_row" colspan="2">
<span id="S3.T1.6.4.4.4.1.1" class="ltx_text ltx_font_smallcaps" style="font-size:90%;"></span><math id="S3.T1.6.4.4.4.1.m1.1" class="ltx_Math" alttext="|\mathcal{P}_{H}|" display="inline"><semantics id="S3.T1.6.4.4.4.1.m1.1a"><mrow id="S3.T1.6.4.4.4.1.m1.1.1.1" xref="S3.T1.6.4.4.4.1.m1.1.1.2.cmml"><mo maxsize="90%" minsize="90%" id="S3.T1.6.4.4.4.1.m1.1.1.1.2" xref="S3.T1.6.4.4.4.1.m1.1.1.2.1.cmml">|</mo><msub id="S3.T1.6.4.4.4.1.m1.1.1.1.1" xref="S3.T1.6.4.4.4.1.m1.1.1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" mathsize="90%" id="S3.T1.6.4.4.4.1.m1.1.1.1.1.2" xref="S3.T1.6.4.4.4.1.m1.1.1.1.1.2.cmml">𝒫</mi><mi mathsize="90%" id="S3.T1.6.4.4.4.1.m1.1.1.1.1.3" xref="S3.T1.6.4.4.4.1.m1.1.1.1.1.3.cmml">H</mi></msub><mo maxsize="90%" minsize="90%" id="S3.T1.6.4.4.4.1.m1.1.1.1.3" xref="S3.T1.6.4.4.4.1.m1.1.1.2.1.cmml">|</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.T1.6.4.4.4.1.m1.1b"><apply id="S3.T1.6.4.4.4.1.m1.1.1.2.cmml" xref="S3.T1.6.4.4.4.1.m1.1.1.1"><abs id="S3.T1.6.4.4.4.1.m1.1.1.2.1.cmml" xref="S3.T1.6.4.4.4.1.m1.1.1.1.2"></abs><apply id="S3.T1.6.4.4.4.1.m1.1.1.1.1.cmml" xref="S3.T1.6.4.4.4.1.m1.1.1.1.1"><csymbol cd="ambiguous" id="S3.T1.6.4.4.4.1.m1.1.1.1.1.1.cmml" xref="S3.T1.6.4.4.4.1.m1.1.1.1.1">subscript</csymbol><ci id="S3.T1.6.4.4.4.1.m1.1.1.1.1.2.cmml" xref="S3.T1.6.4.4.4.1.m1.1.1.1.1.2">𝒫</ci><ci id="S3.T1.6.4.4.4.1.m1.1.1.1.1.3.cmml" xref="S3.T1.6.4.4.4.1.m1.1.1.1.1.3">𝐻</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.T1.6.4.4.4.1.m1.1c">|\mathcal{P}_{H}|</annotation></semantics></math><span id="S3.T1.6.4.4.4.1.2" class="ltx_text ltx_font_smallcaps" style="font-size:90%;">=143k</span>
</th>
<th id="S3.T1.7.5.5.5.2" class="ltx_td ltx_align_center ltx_th ltx_th_row" colspan="2">
<span id="S3.T1.7.5.5.5.2.1" class="ltx_text ltx_font_smallcaps" style="font-size:90%;"></span><math id="S3.T1.7.5.5.5.2.m1.1" class="ltx_Math" alttext="|\mathcal{P}_{H}|" display="inline"><semantics id="S3.T1.7.5.5.5.2.m1.1a"><mrow id="S3.T1.7.5.5.5.2.m1.1.1.1" xref="S3.T1.7.5.5.5.2.m1.1.1.2.cmml"><mo maxsize="90%" minsize="90%" id="S3.T1.7.5.5.5.2.m1.1.1.1.2" xref="S3.T1.7.5.5.5.2.m1.1.1.2.1.cmml">|</mo><msub id="S3.T1.7.5.5.5.2.m1.1.1.1.1" xref="S3.T1.7.5.5.5.2.m1.1.1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" mathsize="90%" id="S3.T1.7.5.5.5.2.m1.1.1.1.1.2" xref="S3.T1.7.5.5.5.2.m1.1.1.1.1.2.cmml">𝒫</mi><mi mathsize="90%" id="S3.T1.7.5.5.5.2.m1.1.1.1.1.3" xref="S3.T1.7.5.5.5.2.m1.1.1.1.1.3.cmml">H</mi></msub><mo maxsize="90%" minsize="90%" id="S3.T1.7.5.5.5.2.m1.1.1.1.3" xref="S3.T1.7.5.5.5.2.m1.1.1.2.1.cmml">|</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.T1.7.5.5.5.2.m1.1b"><apply id="S3.T1.7.5.5.5.2.m1.1.1.2.cmml" xref="S3.T1.7.5.5.5.2.m1.1.1.1"><abs id="S3.T1.7.5.5.5.2.m1.1.1.2.1.cmml" xref="S3.T1.7.5.5.5.2.m1.1.1.1.2"></abs><apply id="S3.T1.7.5.5.5.2.m1.1.1.1.1.cmml" xref="S3.T1.7.5.5.5.2.m1.1.1.1.1"><csymbol cd="ambiguous" id="S3.T1.7.5.5.5.2.m1.1.1.1.1.1.cmml" xref="S3.T1.7.5.5.5.2.m1.1.1.1.1">subscript</csymbol><ci id="S3.T1.7.5.5.5.2.m1.1.1.1.1.2.cmml" xref="S3.T1.7.5.5.5.2.m1.1.1.1.1.2">𝒫</ci><ci id="S3.T1.7.5.5.5.2.m1.1.1.1.1.3.cmml" xref="S3.T1.7.5.5.5.2.m1.1.1.1.1.3">𝐻</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.T1.7.5.5.5.2.m1.1c">|\mathcal{P}_{H}|</annotation></semantics></math><span id="S3.T1.7.5.5.5.2.2" class="ltx_text ltx_font_smallcaps" style="font-size:90%;">=296k</span>
</th>
<th id="S3.T1.8.6.6.6.3" class="ltx_td ltx_align_center ltx_th ltx_th_row" colspan="2">
<span id="S3.T1.8.6.6.6.3.1" class="ltx_text ltx_font_smallcaps" style="font-size:90%;"></span><math id="S3.T1.8.6.6.6.3.m1.1" class="ltx_Math" alttext="|\mathcal{P}_{H}|" display="inline"><semantics id="S3.T1.8.6.6.6.3.m1.1a"><mrow id="S3.T1.8.6.6.6.3.m1.1.1.1" xref="S3.T1.8.6.6.6.3.m1.1.1.2.cmml"><mo maxsize="90%" minsize="90%" id="S3.T1.8.6.6.6.3.m1.1.1.1.2" xref="S3.T1.8.6.6.6.3.m1.1.1.2.1.cmml">|</mo><msub id="S3.T1.8.6.6.6.3.m1.1.1.1.1" xref="S3.T1.8.6.6.6.3.m1.1.1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" mathsize="90%" id="S3.T1.8.6.6.6.3.m1.1.1.1.1.2" xref="S3.T1.8.6.6.6.3.m1.1.1.1.1.2.cmml">𝒫</mi><mi mathsize="90%" id="S3.T1.8.6.6.6.3.m1.1.1.1.1.3" xref="S3.T1.8.6.6.6.3.m1.1.1.1.1.3.cmml">H</mi></msub><mo maxsize="90%" minsize="90%" id="S3.T1.8.6.6.6.3.m1.1.1.1.3" xref="S3.T1.8.6.6.6.3.m1.1.1.2.1.cmml">|</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.T1.8.6.6.6.3.m1.1b"><apply id="S3.T1.8.6.6.6.3.m1.1.1.2.cmml" xref="S3.T1.8.6.6.6.3.m1.1.1.1"><abs id="S3.T1.8.6.6.6.3.m1.1.1.2.1.cmml" xref="S3.T1.8.6.6.6.3.m1.1.1.1.2"></abs><apply id="S3.T1.8.6.6.6.3.m1.1.1.1.1.cmml" xref="S3.T1.8.6.6.6.3.m1.1.1.1.1"><csymbol cd="ambiguous" id="S3.T1.8.6.6.6.3.m1.1.1.1.1.1.cmml" xref="S3.T1.8.6.6.6.3.m1.1.1.1.1">subscript</csymbol><ci id="S3.T1.8.6.6.6.3.m1.1.1.1.1.2.cmml" xref="S3.T1.8.6.6.6.3.m1.1.1.1.1.2">𝒫</ci><ci id="S3.T1.8.6.6.6.3.m1.1.1.1.1.3.cmml" xref="S3.T1.8.6.6.6.3.m1.1.1.1.1.3">𝐻</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.T1.8.6.6.6.3.m1.1c">|\mathcal{P}_{H}|</annotation></semantics></math><span id="S3.T1.8.6.6.6.3.2" class="ltx_text ltx_font_smallcaps" style="font-size:90%;">=612k</span>
</th>
</tr>
<tr id="S3.T1.8.6.6.15.9" class="ltx_tr">
<th id="S3.T1.8.6.6.15.9.1" class="ltx_td ltx_th ltx_th_row"></th>
<td id="S3.T1.8.6.6.15.9.2" class="ltx_td ltx_border_r"></td>
<th id="S3.T1.8.6.6.15.9.3" class="ltx_td ltx_align_center ltx_th ltx_th_row"><span id="S3.T1.8.6.6.15.9.3.1" class="ltx_text ltx_font_smallcaps" style="font-size:90%;">small</span></th>
<td id="S3.T1.8.6.6.15.9.4" class="ltx_td ltx_align_center ltx_border_r"><span id="S3.T1.8.6.6.15.9.4.1" class="ltx_text ltx_font_smallcaps" style="font-size:90%;">large</span></td>
<th id="S3.T1.8.6.6.15.9.5" class="ltx_td ltx_align_center ltx_th ltx_th_row"><span id="S3.T1.8.6.6.15.9.5.1" class="ltx_text ltx_font_smallcaps" style="font-size:90%;">small</span></th>
<td id="S3.T1.8.6.6.15.9.6" class="ltx_td ltx_align_center ltx_border_r"><span id="S3.T1.8.6.6.15.9.6.1" class="ltx_text ltx_font_smallcaps" style="font-size:90%;">large</span></td>
<th id="S3.T1.8.6.6.15.9.7" class="ltx_td ltx_align_center ltx_th ltx_th_row"><span id="S3.T1.8.6.6.15.9.7.1" class="ltx_text ltx_font_smallcaps" style="font-size:90%;">small</span></th>
<td id="S3.T1.8.6.6.15.9.8" class="ltx_td ltx_align_center"><span id="S3.T1.8.6.6.15.9.8.1" class="ltx_text ltx_font_smallcaps" style="font-size:90%;">large</span></td>
</tr>
<tr id="S3.T1.8.6.6.16.10" class="ltx_tr">
<th id="S3.T1.8.6.6.16.10.1" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_t"><span id="S3.T1.8.6.6.16.10.1.1" class="ltx_text ltx_font_smallcaps" style="font-size:90%;">FedAvg</span></th>
<td id="S3.T1.8.6.6.16.10.2" class="ltx_td ltx_align_center ltx_border_r ltx_border_t"><span id="S3.T1.8.6.6.16.10.2.1" class="ltx_text ltx_font_smallcaps" style="font-size:90%;">x</span></td>
<th id="S3.T1.8.6.6.16.10.3" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_t"><span id="S3.T1.8.6.6.16.10.3.1" class="ltx_text ltx_font_smallcaps" style="font-size:90%;">26.29</span></th>
<td id="S3.T1.8.6.6.16.10.4" class="ltx_td ltx_align_center ltx_border_r ltx_border_t"><span id="S3.T1.8.6.6.16.10.4.1" class="ltx_text ltx_font_smallcaps" style="font-size:90%;">24.87</span></td>
<th id="S3.T1.8.6.6.16.10.5" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_t"><span id="S3.T1.8.6.6.16.10.5.1" class="ltx_text ltx_font_smallcaps" style="font-size:90%;">26.29</span></th>
<td id="S3.T1.8.6.6.16.10.6" class="ltx_td ltx_align_center ltx_border_r ltx_border_t"><span id="S3.T1.8.6.6.16.10.6.1" class="ltx_text ltx_font_smallcaps" style="font-size:90%;">26.23</span></td>
<th id="S3.T1.8.6.6.16.10.7" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_t"><span id="S3.T1.8.6.6.16.10.7.1" class="ltx_text ltx_font_smallcaps" style="font-size:90%;">26.29</span></th>
<td id="S3.T1.8.6.6.16.10.8" class="ltx_td ltx_align_center ltx_border_t"><span id="S3.T1.8.6.6.16.10.8.1" class="ltx_text ltx_font_smallcaps" style="font-size:90%;">27.51</span></td>
</tr>
<tr id="S3.T1.8.6.6.17.11" class="ltx_tr">
<th id="S3.T1.8.6.6.17.11.1" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_t"><span id="S3.T1.8.6.6.17.11.1.1" class="ltx_text ltx_font_smallcaps" style="font-size:90%;">PeriodicCodist</span></th>
<td id="S3.T1.8.6.6.17.11.2" class="ltx_td ltx_align_center ltx_border_r ltx_border_t"><span id="S3.T1.8.6.6.17.11.2.1" class="ltx_text ltx_font_smallcaps" style="font-size:90%;">✓</span></td>
<th id="S3.T1.8.6.6.17.11.3" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_t"><span id="S3.T1.8.6.6.17.11.3.1" class="ltx_text ltx_font_smallcaps" style="font-size:90%;">25.70</span></th>
<td id="S3.T1.8.6.6.17.11.4" class="ltx_td ltx_align_center ltx_border_r ltx_border_t"><span id="S3.T1.8.6.6.17.11.4.1" class="ltx_text ltx_font_smallcaps" style="font-size:90%;">26.26</span></td>
<th id="S3.T1.8.6.6.17.11.5" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_t"><span id="S3.T1.8.6.6.17.11.5.1" class="ltx_text ltx_font_smallcaps" style="font-size:90%;">25.95</span></th>
<td id="S3.T1.8.6.6.17.11.6" class="ltx_td ltx_align_center ltx_border_r ltx_border_t"><span id="S3.T1.8.6.6.17.11.6.1" class="ltx_text ltx_font_smallcaps" style="font-size:90%;">26.68</span></td>
<th id="S3.T1.8.6.6.17.11.7" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_t"><span id="S3.T1.8.6.6.17.11.7.1" class="ltx_text ltx_font_smallcaps" style="font-size:90%;">25.73</span></th>
<td id="S3.T1.8.6.6.17.11.8" class="ltx_td ltx_align_center ltx_border_t"><span id="S3.T1.8.6.6.17.11.8.1" class="ltx_text ltx_font_smallcaps" style="font-size:90%;">27.06</span></td>
</tr>
<tr id="S3.T1.8.6.6.18.12" class="ltx_tr">
<th id="S3.T1.8.6.6.18.12.1" class="ltx_td ltx_align_center ltx_th ltx_th_row"><span id="S3.T1.8.6.6.18.12.1.1" class="ltx_text ltx_font_smallcaps" style="font-size:90%;">MergedCodist</span></th>
<td id="S3.T1.8.6.6.18.12.2" class="ltx_td ltx_align_center ltx_border_r"><span id="S3.T1.8.6.6.18.12.2.1" class="ltx_text ltx_font_smallcaps" style="font-size:90%;">✓</span></td>
<th id="S3.T1.8.6.6.18.12.3" class="ltx_td ltx_align_center ltx_th ltx_th_row"><span id="S3.T1.8.6.6.18.12.3.1" class="ltx_text ltx_font_smallcaps" style="font-size:90%;">26.42</span></th>
<td id="S3.T1.8.6.6.18.12.4" class="ltx_td ltx_align_center ltx_border_r"><span id="S3.T1.8.6.6.18.12.4.1" class="ltx_text ltx_font_bold" style="font-size:90%;">26.63</span></td>
<th id="S3.T1.8.6.6.18.12.5" class="ltx_td ltx_align_center ltx_th ltx_th_row"><span id="S3.T1.8.6.6.18.12.5.1" class="ltx_text ltx_font_smallcaps" style="font-size:90%;">26.50</span></th>
<td id="S3.T1.8.6.6.18.12.6" class="ltx_td ltx_align_center ltx_border_r"><span id="S3.T1.8.6.6.18.12.6.1" class="ltx_text ltx_font_bold" style="font-size:90%;">26.72</span></td>
<th id="S3.T1.8.6.6.18.12.7" class="ltx_td ltx_align_center ltx_th ltx_th_row"><span id="S3.T1.8.6.6.18.12.7.1" class="ltx_text ltx_font_bold" style="font-size:90%;">26.66</span></th>
<td id="S3.T1.8.6.6.18.12.8" class="ltx_td ltx_align_center"><span id="S3.T1.8.6.6.18.12.8.1" class="ltx_text ltx_font_smallcaps" style="font-size:90%;">27.55</span></td>
</tr>
<tr id="S3.T1.8.6.6.19.13" class="ltx_tr">
<th id="S3.T1.8.6.6.19.13.1" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_t"><span id="S3.T1.8.6.6.19.13.1.1" class="ltx_text ltx_font_smallcaps" style="font-size:90%;">PeriodicCodist</span></th>
<td id="S3.T1.8.6.6.19.13.2" class="ltx_td ltx_align_center ltx_border_r ltx_border_t"><span id="S3.T1.8.6.6.19.13.2.1" class="ltx_text ltx_font_smallcaps" style="font-size:90%;">x</span></td>
<th id="S3.T1.8.6.6.19.13.3" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_t"><span id="S3.T1.8.6.6.19.13.3.1" class="ltx_text ltx_font_smallcaps" style="font-size:90%;">25.72</span></th>
<td id="S3.T1.8.6.6.19.13.4" class="ltx_td ltx_align_center ltx_border_r ltx_border_t"><span id="S3.T1.8.6.6.19.13.4.1" class="ltx_text ltx_font_smallcaps" style="font-size:90%;">25.79</span></td>
<th id="S3.T1.8.6.6.19.13.5" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_t"><span id="S3.T1.8.6.6.19.13.5.1" class="ltx_text ltx_font_smallcaps" style="font-size:90%;">25.57</span></th>
<td id="S3.T1.8.6.6.19.13.6" class="ltx_td ltx_align_center ltx_border_r ltx_border_t"><span id="S3.T1.8.6.6.19.13.6.1" class="ltx_text ltx_font_smallcaps" style="font-size:90%;">26.50</span></td>
<th id="S3.T1.8.6.6.19.13.7" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_t"><span id="S3.T1.8.6.6.19.13.7.1" class="ltx_text ltx_font_smallcaps" style="font-size:90%;">25.77</span></th>
<td id="S3.T1.8.6.6.19.13.8" class="ltx_td ltx_align_center ltx_border_t"><span id="S3.T1.8.6.6.19.13.8.1" class="ltx_text ltx_font_smallcaps" style="font-size:90%;">27.18</span></td>
</tr>
<tr id="S3.T1.8.6.6.20.14" class="ltx_tr">
<th id="S3.T1.8.6.6.20.14.1" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_bb"><span id="S3.T1.8.6.6.20.14.1.1" class="ltx_text ltx_font_smallcaps" style="font-size:90%;">MergedCodist</span></th>
<td id="S3.T1.8.6.6.20.14.2" class="ltx_td ltx_align_center ltx_border_bb ltx_border_r"><span id="S3.T1.8.6.6.20.14.2.1" class="ltx_text ltx_font_smallcaps" style="font-size:90%;">x</span></td>
<th id="S3.T1.8.6.6.20.14.3" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_bb"><span id="S3.T1.8.6.6.20.14.3.1" class="ltx_text ltx_font_bold" style="font-size:90%;">26.55</span></th>
<td id="S3.T1.8.6.6.20.14.4" class="ltx_td ltx_align_center ltx_border_bb ltx_border_r"><span id="S3.T1.8.6.6.20.14.4.1" class="ltx_text ltx_font_smallcaps" style="font-size:90%;">25.52</span></td>
<th id="S3.T1.8.6.6.20.14.5" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_bb"><span id="S3.T1.8.6.6.20.14.5.1" class="ltx_text ltx_font_bold" style="font-size:90%;">26.51</span></th>
<td id="S3.T1.8.6.6.20.14.6" class="ltx_td ltx_align_center ltx_border_bb ltx_border_r"><span id="S3.T1.8.6.6.20.14.6.1" class="ltx_text ltx_font_smallcaps" style="font-size:90%;">26.43</span></td>
<th id="S3.T1.8.6.6.20.14.7" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_bb"><span id="S3.T1.8.6.6.20.14.7.1" class="ltx_text ltx_font_smallcaps" style="font-size:90%;">26.59</span></th>
<td id="S3.T1.8.6.6.20.14.8" class="ltx_td ltx_align_center ltx_border_bb"><span id="S3.T1.8.6.6.20.14.8.1" class="ltx_text ltx_font_bold" style="font-size:90%;">27.67</span></td>
</tr>
</tbody>
</table>
</span></div>
</figure>
</section>
<section id="S3.SS2" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.2 </span>Imbalanced Model Performance</h3>

<div id="S3.SS2.p1" class="ltx_para">
<p id="S3.SS2.p1.2" class="ltx_p">We now evaluate the extent to which the distillation methods are effective when the two models have imbalanced baseline performance. We achieve this setting by either increasing or decreasing the number of clients in the high-capacity pool. Results are shown in Table <a href="#S3.T1" title="Table 1 ‣ 3.1 Balanced Model Performance ‣ 3 Experiments ‣ Heterogeneous Federated Learning Using Knowledge Codistillation" class="ltx_ref"><span class="ltx_text ltx_ref_tag">1</span></a>.
The most striking gains are seen when the small model is used as the teacher for the under-performing large model (Columns corresponding to <math id="S3.SS2.p1.1.m1.1" class="ltx_Math" alttext="|\mathcal{P}_{H}|" display="inline"><semantics id="S3.SS2.p1.1.m1.1a"><mrow id="S3.SS2.p1.1.m1.1.1.1" xref="S3.SS2.p1.1.m1.1.1.2.cmml"><mo stretchy="false" id="S3.SS2.p1.1.m1.1.1.1.2" xref="S3.SS2.p1.1.m1.1.1.2.1.cmml">|</mo><msub id="S3.SS2.p1.1.m1.1.1.1.1" xref="S3.SS2.p1.1.m1.1.1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS2.p1.1.m1.1.1.1.1.2" xref="S3.SS2.p1.1.m1.1.1.1.1.2.cmml">𝒫</mi><mi id="S3.SS2.p1.1.m1.1.1.1.1.3" xref="S3.SS2.p1.1.m1.1.1.1.1.3.cmml">H</mi></msub><mo stretchy="false" id="S3.SS2.p1.1.m1.1.1.1.3" xref="S3.SS2.p1.1.m1.1.1.2.1.cmml">|</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.1.m1.1b"><apply id="S3.SS2.p1.1.m1.1.1.2.cmml" xref="S3.SS2.p1.1.m1.1.1.1"><abs id="S3.SS2.p1.1.m1.1.1.2.1.cmml" xref="S3.SS2.p1.1.m1.1.1.1.2"></abs><apply id="S3.SS2.p1.1.m1.1.1.1.1.cmml" xref="S3.SS2.p1.1.m1.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS2.p1.1.m1.1.1.1.1.1.cmml" xref="S3.SS2.p1.1.m1.1.1.1.1">subscript</csymbol><ci id="S3.SS2.p1.1.m1.1.1.1.1.2.cmml" xref="S3.SS2.p1.1.m1.1.1.1.1.2">𝒫</ci><ci id="S3.SS2.p1.1.m1.1.1.1.1.3.cmml" xref="S3.SS2.p1.1.m1.1.1.1.1.3">𝐻</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.1.m1.1c">|\mathcal{P}_{H}|</annotation></semantics></math>=3100 or 4700). In this case, the large model is limited by the size of its participating clients pool <math id="S3.SS2.p1.2.m2.1" class="ltx_Math" alttext="\mathcal{P}_{H}" display="inline"><semantics id="S3.SS2.p1.2.m2.1a"><msub id="S3.SS2.p1.2.m2.1.1" xref="S3.SS2.p1.2.m2.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS2.p1.2.m2.1.1.2" xref="S3.SS2.p1.2.m2.1.1.2.cmml">𝒫</mi><mi id="S3.SS2.p1.2.m2.1.1.3" xref="S3.SS2.p1.2.m2.1.1.3.cmml">H</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.2.m2.1b"><apply id="S3.SS2.p1.2.m2.1.1.cmml" xref="S3.SS2.p1.2.m2.1.1"><csymbol cd="ambiguous" id="S3.SS2.p1.2.m2.1.1.1.cmml" xref="S3.SS2.p1.2.m2.1.1">subscript</csymbol><ci id="S3.SS2.p1.2.m2.1.1.2.cmml" xref="S3.SS2.p1.2.m2.1.1.2">𝒫</ci><ci id="S3.SS2.p1.2.m2.1.1.3.cmml" xref="S3.SS2.p1.2.m2.1.1.3">𝐻</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.2.m2.1c">\mathcal{P}_{H}</annotation></semantics></math>; this allows us to leverage the small model trained on the low-capacity pool to make better use of the larger model’s unutilized capacity. By sharing information bi-directionally via the distillation methods, we are able to improve the small model as well, via both methods for CIFAR and via <span id="S3.SS2.p1.2.1" class="ltx_text ltx_font_smallcaps">MergedCodist</span> for StackOverflow.</p>
</div>
<figure id="S3.T2" class="ltx_table">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_table">Table 2: </span>Performance of <span id="S3.T2.6.1" class="ltx_text ltx_font_smallcaps">PeriodicCodist</span> and <span id="S3.T2.7.2" class="ltx_text ltx_font_smallcaps">MergedCodist</span> when the two <span id="S3.T2.8.3" class="ltx_text ltx_font_smallcaps">FedAvg</span> pools are domain-shifted. Test accuracy is reported, with Mixed representing the same evaluation set as used previously and Answers / Questions being split versions of that testset.</figcaption>
<div id="S3.T2.2.2" class="ltx_inline-block ltx_align_center ltx_transformed_outer" style="width:520.3pt;height:244.5pt;vertical-align:-0.0pt;"><span class="ltx_transformed_inner" style="transform:translate(126.1pt,-59.3pt) scale(1.94084999921458,1.94084999921458) ;">
<table id="S3.T2.2.2.2" class="ltx_tabular ltx_guessed_headers ltx_align_middle">
<thead class="ltx_thead">
<tr id="S3.T2.2.2.2.3.1" class="ltx_tr">
<th id="S3.T2.2.2.2.3.1.1" class="ltx_td ltx_th ltx_th_column ltx_th_row ltx_border_r ltx_border_tt"></th>
<th id="S3.T2.2.2.2.3.1.2" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_l ltx_border_tt" colspan="6"><span id="S3.T2.2.2.2.3.1.2.1" class="ltx_text ltx_font_smallcaps" style="font-size:90%;">StackOverflow</span></th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr id="S3.T2.2.2.2.4.1" class="ltx_tr">
<th id="S3.T2.2.2.2.4.1.1" class="ltx_td ltx_th ltx_th_row ltx_border_r"></th>
<td id="S3.T2.2.2.2.4.1.2" class="ltx_td ltx_align_center ltx_border_r" colspan="2"><span id="S3.T2.2.2.2.4.1.2.1" class="ltx_text ltx_font_smallcaps" style="font-size:90%;">answers</span></td>
<td id="S3.T2.2.2.2.4.1.3" class="ltx_td ltx_align_center ltx_border_r" colspan="2"><span id="S3.T2.2.2.2.4.1.3.1" class="ltx_text ltx_font_smallcaps" style="font-size:90%;">questions</span></td>
<td id="S3.T2.2.2.2.4.1.4" class="ltx_td ltx_align_center ltx_border_r" colspan="2"><span id="S3.T2.2.2.2.4.1.4.1" class="ltx_text ltx_font_smallcaps" style="font-size:90%;">mixed</span></td>
</tr>
<tr id="S3.T2.2.2.2.5.2" class="ltx_tr">
<th id="S3.T2.2.2.2.5.2.1" class="ltx_td ltx_th ltx_th_row ltx_border_r"></th>
<td id="S3.T2.2.2.2.5.2.2" class="ltx_td ltx_align_center"><span id="S3.T2.2.2.2.5.2.2.1" class="ltx_text ltx_font_smallcaps" style="font-size:90%;">small</span></td>
<td id="S3.T2.2.2.2.5.2.3" class="ltx_td ltx_align_center"><span id="S3.T2.2.2.2.5.2.3.1" class="ltx_text ltx_font_smallcaps" style="font-size:90%;">large</span></td>
<td id="S3.T2.2.2.2.5.2.4" class="ltx_td ltx_align_center"><span id="S3.T2.2.2.2.5.2.4.1" class="ltx_text ltx_font_smallcaps" style="font-size:90%;">small</span></td>
<td id="S3.T2.2.2.2.5.2.5" class="ltx_td ltx_align_center"><span id="S3.T2.2.2.2.5.2.5.1" class="ltx_text ltx_font_smallcaps" style="font-size:90%;">large</span></td>
<td id="S3.T2.2.2.2.5.2.6" class="ltx_td ltx_align_center"><span id="S3.T2.2.2.2.5.2.6.1" class="ltx_text ltx_font_smallcaps" style="font-size:90%;">small</span></td>
<td id="S3.T2.2.2.2.5.2.7" class="ltx_td ltx_align_center"><span id="S3.T2.2.2.2.5.2.7.1" class="ltx_text ltx_font_smallcaps" style="font-size:90%;">large</span></td>
</tr>
<tr id="S3.T2.2.2.2.2" class="ltx_tr">
<th id="S3.T2.2.2.2.2.3" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r ltx_border_t"><span id="S3.T2.2.2.2.2.3.1" class="ltx_text ltx_font_smallcaps" style="font-size:90%;">in-domain</span></th>
<td id="S3.T2.2.2.2.2.4" class="ltx_td ltx_align_center ltx_border_t"><span id="S3.T2.2.2.2.2.4.1" class="ltx_text ltx_font_smallcaps" style="font-size:90%;">✓</span></td>
<td id="S3.T2.2.2.2.2.5" class="ltx_td ltx_align_center ltx_border_t"><span id="S3.T2.2.2.2.2.5.1" class="ltx_text ltx_font_smallcaps" style="font-size:90%;">X</span></td>
<td id="S3.T2.2.2.2.2.6" class="ltx_td ltx_align_center ltx_border_t"><span id="S3.T2.2.2.2.2.6.1" class="ltx_text ltx_font_smallcaps" style="font-size:90%;">X</span></td>
<td id="S3.T2.2.2.2.2.7" class="ltx_td ltx_align_center ltx_border_t"><span id="S3.T2.2.2.2.2.7.1" class="ltx_text ltx_font_smallcaps" style="font-size:90%;">✓</span></td>
<td id="S3.T2.1.1.1.1.1" class="ltx_td ltx_align_center ltx_border_t"><math id="S3.T2.1.1.1.1.1.m1.1" class="ltx_Math" alttext="\sim" display="inline"><semantics id="S3.T2.1.1.1.1.1.m1.1a"><mo mathsize="90%" id="S3.T2.1.1.1.1.1.m1.1.1" xref="S3.T2.1.1.1.1.1.m1.1.1.cmml">∼</mo><annotation-xml encoding="MathML-Content" id="S3.T2.1.1.1.1.1.m1.1b"><csymbol cd="latexml" id="S3.T2.1.1.1.1.1.m1.1.1.cmml" xref="S3.T2.1.1.1.1.1.m1.1.1">similar-to</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S3.T2.1.1.1.1.1.m1.1c">\sim</annotation></semantics></math></td>
<td id="S3.T2.2.2.2.2.2" class="ltx_td ltx_align_center ltx_border_t"><math id="S3.T2.2.2.2.2.2.m1.1" class="ltx_Math" alttext="\sim" display="inline"><semantics id="S3.T2.2.2.2.2.2.m1.1a"><mo mathsize="90%" id="S3.T2.2.2.2.2.2.m1.1.1" xref="S3.T2.2.2.2.2.2.m1.1.1.cmml">∼</mo><annotation-xml encoding="MathML-Content" id="S3.T2.2.2.2.2.2.m1.1b"><csymbol cd="latexml" id="S3.T2.2.2.2.2.2.m1.1.1.cmml" xref="S3.T2.2.2.2.2.2.m1.1.1">similar-to</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S3.T2.2.2.2.2.2.m1.1c">\sim</annotation></semantics></math></td>
</tr>
<tr id="S3.T2.2.2.2.6.3" class="ltx_tr">
<th id="S3.T2.2.2.2.6.3.1" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_th_row ltx_border_r ltx_border_t"><span id="S3.T2.2.2.2.6.3.1.1" class="ltx_text ltx_font_smallcaps" style="font-size:90%;">FedAvg</span></th>
<th id="S3.T2.2.2.2.6.3.2" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t"><span id="S3.T2.2.2.2.6.3.2.1" class="ltx_text ltx_font_smallcaps" style="font-size:90%;">26.00</span></th>
<th id="S3.T2.2.2.2.6.3.3" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t"><span id="S3.T2.2.2.2.6.3.3.1" class="ltx_text ltx_font_smallcaps" style="font-size:90%;">24.79</span></th>
<th id="S3.T2.2.2.2.6.3.4" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t"><span id="S3.T2.2.2.2.6.3.4.1" class="ltx_text ltx_font_smallcaps" style="font-size:90%;">22.62</span></th>
<th id="S3.T2.2.2.2.6.3.5" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t"><span id="S3.T2.2.2.2.6.3.5.1" class="ltx_text ltx_font_smallcaps" style="font-size:90%;">30.34</span></th>
<th id="S3.T2.2.2.2.6.3.6" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t"><span id="S3.T2.2.2.2.6.3.6.1" class="ltx_text ltx_font_smallcaps" style="font-size:90%;">24.51</span></th>
<th id="S3.T2.2.2.2.6.3.7" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t"><span id="S3.T2.2.2.2.6.3.7.1" class="ltx_text ltx_font_smallcaps" style="font-size:90%;">27.25</span></th>
</tr>
<tr id="S3.T2.2.2.2.7.4" class="ltx_tr">
<th id="S3.T2.2.2.2.7.4.1" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r"><span id="S3.T2.2.2.2.7.4.1.1" class="ltx_text ltx_font_smallcaps" style="font-size:90%;">PeriodicCodist</span></th>
<td id="S3.T2.2.2.2.7.4.2" class="ltx_td ltx_align_center"><span id="S3.T2.2.2.2.7.4.2.1" class="ltx_text ltx_font_smallcaps" style="font-size:90%;">25.56</span></td>
<td id="S3.T2.2.2.2.7.4.3" class="ltx_td ltx_align_center"><span id="S3.T2.2.2.2.7.4.3.1" class="ltx_text ltx_font_smallcaps" style="font-size:90%;">24.82</span></td>
<td id="S3.T2.2.2.2.7.4.4" class="ltx_td ltx_align_center"><span id="S3.T2.2.2.2.7.4.4.1" class="ltx_text ltx_font_smallcaps" style="font-size:90%;">22.51</span></td>
<td id="S3.T2.2.2.2.7.4.5" class="ltx_td ltx_align_center"><span id="S3.T2.2.2.2.7.4.5.1" class="ltx_text ltx_font_smallcaps" style="font-size:90%;">30.23</span></td>
<td id="S3.T2.2.2.2.7.4.6" class="ltx_td ltx_align_center"><span id="S3.T2.2.2.2.7.4.6.1" class="ltx_text ltx_font_smallcaps" style="font-size:90%;">24.21</span></td>
<td id="S3.T2.2.2.2.7.4.7" class="ltx_td ltx_align_center"><span id="S3.T2.2.2.2.7.4.7.1" class="ltx_text ltx_font_smallcaps" style="font-size:90%;">27.23</span></td>
</tr>
<tr id="S3.T2.2.2.2.8.5" class="ltx_tr">
<th id="S3.T2.2.2.2.8.5.1" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_bb ltx_border_r"><span id="S3.T2.2.2.2.8.5.1.1" class="ltx_text ltx_font_smallcaps" style="font-size:90%;">MergedCodist</span></th>
<td id="S3.T2.2.2.2.8.5.2" class="ltx_td ltx_align_center ltx_border_bb"><span id="S3.T2.2.2.2.8.5.2.1" class="ltx_text ltx_font_smallcaps" style="font-size:90%;">25.50</span></td>
<td id="S3.T2.2.2.2.8.5.3" class="ltx_td ltx_align_center ltx_border_bb"><span id="S3.T2.2.2.2.8.5.3.1" class="ltx_text ltx_font_smallcaps" style="font-size:90%;">25.29</span></td>
<td id="S3.T2.2.2.2.8.5.4" class="ltx_td ltx_align_center ltx_border_bb"><span id="S3.T2.2.2.2.8.5.4.1" class="ltx_text ltx_font_smallcaps" style="font-size:90%;">27.65</span></td>
<td id="S3.T2.2.2.2.8.5.5" class="ltx_td ltx_align_center ltx_border_bb"><span id="S3.T2.2.2.2.8.5.5.1" class="ltx_text ltx_font_smallcaps" style="font-size:90%;">30.75</span></td>
<td id="S3.T2.2.2.2.8.5.6" class="ltx_td ltx_align_center ltx_border_bb"><span id="S3.T2.2.2.2.8.5.6.1" class="ltx_text ltx_font_smallcaps" style="font-size:90%;">26.45</span></td>
<td id="S3.T2.2.2.2.8.5.7" class="ltx_td ltx_align_center ltx_border_bb"><span id="S3.T2.2.2.2.8.5.7.1" class="ltx_text ltx_font_smallcaps" style="font-size:90%;">27.70</span></td>
</tr>
</tbody>
</table>
</span></div>
</figure>
</section>
<section id="S3.SS3" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.3 </span>Domain-shifted Client Pools</h3>

<div id="S3.SS3.p1" class="ltx_para">
<p id="S3.SS3.p1.4" class="ltx_p">We next introduce a domain-shift between the two <span id="S3.SS3.p1.4.1" class="ltx_text ltx_font_smallcaps">FedAvg</span> pools by splitting the StackOverflow examples such that the high-capacity pool <math id="S3.SS3.p1.1.m1.1" class="ltx_Math" alttext="\mathcal{P}_{H}" display="inline"><semantics id="S3.SS3.p1.1.m1.1a"><msub id="S3.SS3.p1.1.m1.1.1" xref="S3.SS3.p1.1.m1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS3.p1.1.m1.1.1.2" xref="S3.SS3.p1.1.m1.1.1.2.cmml">𝒫</mi><mi id="S3.SS3.p1.1.m1.1.1.3" xref="S3.SS3.p1.1.m1.1.1.3.cmml">H</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS3.p1.1.m1.1b"><apply id="S3.SS3.p1.1.m1.1.1.cmml" xref="S3.SS3.p1.1.m1.1.1"><csymbol cd="ambiguous" id="S3.SS3.p1.1.m1.1.1.1.cmml" xref="S3.SS3.p1.1.m1.1.1">subscript</csymbol><ci id="S3.SS3.p1.1.m1.1.1.2.cmml" xref="S3.SS3.p1.1.m1.1.1.2">𝒫</ci><ci id="S3.SS3.p1.1.m1.1.1.3.cmml" xref="S3.SS3.p1.1.m1.1.1.3">𝐻</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p1.1.m1.1c">\mathcal{P}_{H}</annotation></semantics></math> only contains questions and the low-capacity pool <math id="S3.SS3.p1.2.m2.1" class="ltx_Math" alttext="\mathcal{P}_{L}" display="inline"><semantics id="S3.SS3.p1.2.m2.1a"><msub id="S3.SS3.p1.2.m2.1.1" xref="S3.SS3.p1.2.m2.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS3.p1.2.m2.1.1.2" xref="S3.SS3.p1.2.m2.1.1.2.cmml">𝒫</mi><mi id="S3.SS3.p1.2.m2.1.1.3" xref="S3.SS3.p1.2.m2.1.1.3.cmml">L</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS3.p1.2.m2.1b"><apply id="S3.SS3.p1.2.m2.1.1.cmml" xref="S3.SS3.p1.2.m2.1.1"><csymbol cd="ambiguous" id="S3.SS3.p1.2.m2.1.1.1.cmml" xref="S3.SS3.p1.2.m2.1.1">subscript</csymbol><ci id="S3.SS3.p1.2.m2.1.1.2.cmml" xref="S3.SS3.p1.2.m2.1.1.2">𝒫</ci><ci id="S3.SS3.p1.2.m2.1.1.3.cmml" xref="S3.SS3.p1.2.m2.1.1.3">𝐿</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p1.2.m2.1c">\mathcal{P}_{L}</annotation></semantics></math> only contains answers. Thus the pools are entirely distinct, as opposed to previous experiments when the high-capacity pool covered a subset of the clients in the low-capacity pool. As before, we use cross-domain distillation data, which contains both questions (<math id="S3.SS3.p1.3.m3.1" class="ltx_Math" alttext="\sim 45\%" display="inline"><semantics id="S3.SS3.p1.3.m3.1a"><mrow id="S3.SS3.p1.3.m3.1.1" xref="S3.SS3.p1.3.m3.1.1.cmml"><mi id="S3.SS3.p1.3.m3.1.1.2" xref="S3.SS3.p1.3.m3.1.1.2.cmml"></mi><mo id="S3.SS3.p1.3.m3.1.1.1" xref="S3.SS3.p1.3.m3.1.1.1.cmml">∼</mo><mrow id="S3.SS3.p1.3.m3.1.1.3" xref="S3.SS3.p1.3.m3.1.1.3.cmml"><mn id="S3.SS3.p1.3.m3.1.1.3.2" xref="S3.SS3.p1.3.m3.1.1.3.2.cmml">45</mn><mo id="S3.SS3.p1.3.m3.1.1.3.1" xref="S3.SS3.p1.3.m3.1.1.3.1.cmml">%</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.p1.3.m3.1b"><apply id="S3.SS3.p1.3.m3.1.1.cmml" xref="S3.SS3.p1.3.m3.1.1"><csymbol cd="latexml" id="S3.SS3.p1.3.m3.1.1.1.cmml" xref="S3.SS3.p1.3.m3.1.1.1">similar-to</csymbol><csymbol cd="latexml" id="S3.SS3.p1.3.m3.1.1.2.cmml" xref="S3.SS3.p1.3.m3.1.1.2">absent</csymbol><apply id="S3.SS3.p1.3.m3.1.1.3.cmml" xref="S3.SS3.p1.3.m3.1.1.3"><csymbol cd="latexml" id="S3.SS3.p1.3.m3.1.1.3.1.cmml" xref="S3.SS3.p1.3.m3.1.1.3.1">percent</csymbol><cn type="integer" id="S3.SS3.p1.3.m3.1.1.3.2.cmml" xref="S3.SS3.p1.3.m3.1.1.3.2">45</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p1.3.m3.1c">\sim 45\%</annotation></semantics></math>) and answers (<math id="S3.SS3.p1.4.m4.1" class="ltx_Math" alttext="\sim 55\%" display="inline"><semantics id="S3.SS3.p1.4.m4.1a"><mrow id="S3.SS3.p1.4.m4.1.1" xref="S3.SS3.p1.4.m4.1.1.cmml"><mi id="S3.SS3.p1.4.m4.1.1.2" xref="S3.SS3.p1.4.m4.1.1.2.cmml"></mi><mo id="S3.SS3.p1.4.m4.1.1.1" xref="S3.SS3.p1.4.m4.1.1.1.cmml">∼</mo><mrow id="S3.SS3.p1.4.m4.1.1.3" xref="S3.SS3.p1.4.m4.1.1.3.cmml"><mn id="S3.SS3.p1.4.m4.1.1.3.2" xref="S3.SS3.p1.4.m4.1.1.3.2.cmml">55</mn><mo id="S3.SS3.p1.4.m4.1.1.3.1" xref="S3.SS3.p1.4.m4.1.1.3.1.cmml">%</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.p1.4.m4.1b"><apply id="S3.SS3.p1.4.m4.1.1.cmml" xref="S3.SS3.p1.4.m4.1.1"><csymbol cd="latexml" id="S3.SS3.p1.4.m4.1.1.1.cmml" xref="S3.SS3.p1.4.m4.1.1.1">similar-to</csymbol><csymbol cd="latexml" id="S3.SS3.p1.4.m4.1.1.2.cmml" xref="S3.SS3.p1.4.m4.1.1.2">absent</csymbol><apply id="S3.SS3.p1.4.m4.1.1.3.cmml" xref="S3.SS3.p1.4.m4.1.1.3"><csymbol cd="latexml" id="S3.SS3.p1.4.m4.1.1.3.1.cmml" xref="S3.SS3.p1.4.m4.1.1.3.1">percent</csymbol><cn type="integer" id="S3.SS3.p1.4.m4.1.1.3.2.cmml" xref="S3.SS3.p1.4.m4.1.1.3.2">55</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p1.4.m4.1c">\sim 55\%</annotation></semantics></math>) to explore to what extent knowledge codistillation can help to address each model’s weaknesses in their respective out-of-domain categories. We use the same test set as before and additionally evaluate on partitions of the test set, which contain only questions and only answers. The sizes of the pool are reported in Table <a href="#A3.T5" title="Table 5 ‣ C.5 Domain-shifted Client Pools ‣ Appendix C Experiment Setup ‣ Heterogeneous Federated Learning Using Knowledge Codistillation" class="ltx_ref"><span class="ltx_text ltx_ref_tag">5</span></a> in Appendix <a href="#A3" title="Appendix C Experiment Setup ‣ Heterogeneous Federated Learning Using Knowledge Codistillation" class="ltx_ref"><span class="ltx_text ltx_ref_tag">C</span></a>. Results are reported in Table <a href="#S3.T2" title="Table 2 ‣ 3.2 Imbalanced Model Performance ‣ 3 Experiments ‣ Heterogeneous Federated Learning Using Knowledge Codistillation" class="ltx_ref"><span class="ltx_text ltx_ref_tag">2</span></a>.</p>
</div>
<div id="S3.SS3.p2" class="ltx_para">
<p id="S3.SS3.p2.2" class="ltx_p"><span id="S3.SS3.p2.2.1" class="ltx_text ltx_font_smallcaps">MergedCodist</span> achieves domain transfer between the two models resulting in a <math id="S3.SS3.p2.1.m1.1" class="ltx_Math" alttext="+5\%" display="inline"><semantics id="S3.SS3.p2.1.m1.1a"><mrow id="S3.SS3.p2.1.m1.1.1" xref="S3.SS3.p2.1.m1.1.1.cmml"><mo id="S3.SS3.p2.1.m1.1.1a" xref="S3.SS3.p2.1.m1.1.1.cmml">+</mo><mrow id="S3.SS3.p2.1.m1.1.1.2" xref="S3.SS3.p2.1.m1.1.1.2.cmml"><mn id="S3.SS3.p2.1.m1.1.1.2.2" xref="S3.SS3.p2.1.m1.1.1.2.2.cmml">5</mn><mo id="S3.SS3.p2.1.m1.1.1.2.1" xref="S3.SS3.p2.1.m1.1.1.2.1.cmml">%</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.p2.1.m1.1b"><apply id="S3.SS3.p2.1.m1.1.1.cmml" xref="S3.SS3.p2.1.m1.1.1"><plus id="S3.SS3.p2.1.m1.1.1.1.cmml" xref="S3.SS3.p2.1.m1.1.1"></plus><apply id="S3.SS3.p2.1.m1.1.1.2.cmml" xref="S3.SS3.p2.1.m1.1.1.2"><csymbol cd="latexml" id="S3.SS3.p2.1.m1.1.1.2.1.cmml" xref="S3.SS3.p2.1.m1.1.1.2.1">percent</csymbol><cn type="integer" id="S3.SS3.p2.1.m1.1.1.2.2.cmml" xref="S3.SS3.p2.1.m1.1.1.2.2">5</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p2.1.m1.1c">+5\%</annotation></semantics></math> accuracy boost for the small model on out-of-domain questions and <math id="S3.SS3.p2.2.m2.1" class="ltx_Math" alttext="+0.5\%" display="inline"><semantics id="S3.SS3.p2.2.m2.1a"><mrow id="S3.SS3.p2.2.m2.1.1" xref="S3.SS3.p2.2.m2.1.1.cmml"><mo id="S3.SS3.p2.2.m2.1.1a" xref="S3.SS3.p2.2.m2.1.1.cmml">+</mo><mrow id="S3.SS3.p2.2.m2.1.1.2" xref="S3.SS3.p2.2.m2.1.1.2.cmml"><mn id="S3.SS3.p2.2.m2.1.1.2.2" xref="S3.SS3.p2.2.m2.1.1.2.2.cmml">0.5</mn><mo id="S3.SS3.p2.2.m2.1.1.2.1" xref="S3.SS3.p2.2.m2.1.1.2.1.cmml">%</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.p2.2.m2.1b"><apply id="S3.SS3.p2.2.m2.1.1.cmml" xref="S3.SS3.p2.2.m2.1.1"><plus id="S3.SS3.p2.2.m2.1.1.1.cmml" xref="S3.SS3.p2.2.m2.1.1"></plus><apply id="S3.SS3.p2.2.m2.1.1.2.cmml" xref="S3.SS3.p2.2.m2.1.1.2"><csymbol cd="latexml" id="S3.SS3.p2.2.m2.1.1.2.1.cmml" xref="S3.SS3.p2.2.m2.1.1.2.1">percent</csymbol><cn type="float" id="S3.SS3.p2.2.m2.1.1.2.2.cmml" xref="S3.SS3.p2.2.m2.1.1.2.2">0.5</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p2.2.m2.1c">+0.5\%</annotation></semantics></math> accuracy boost for the large model on out-of-domain answers. The large model also improves on in-domain questions. Overall performance improves for both models, and <span id="S3.SS3.p2.2.2" class="ltx_text ltx_font_smallcaps">MergedCodist</span> achieves faster convergence on the general performance (see Figure <a href="#A4.F3" title="Figure 3 ‣ D.1 Domain-shifted Client Pools ‣ Appendix D Further Analysis ‣ Heterogeneous Federated Learning Using Knowledge Codistillation" class="ltx_ref"><span class="ltx_text ltx_ref_tag">3</span></a> in Appendix <a href="#A4" title="Appendix D Further Analysis ‣ Heterogeneous Federated Learning Using Knowledge Codistillation" class="ltx_ref"><span class="ltx_text ltx_ref_tag">D</span></a>). We analyze the poor performance of <span id="S3.SS3.p2.2.3" class="ltx_text ltx_font_smallcaps">PeriodicCodist</span> in the domain-shifted setting in Appendix <a href="#A4" title="Appendix D Further Analysis ‣ Heterogeneous Federated Learning Using Knowledge Codistillation" class="ltx_ref"><span class="ltx_text ltx_ref_tag">D</span></a>.</p>
</div>
</section>
</section>
<section id="S4" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">4 </span>Discussion</h2>

<div id="S4.p1" class="ltx_para">
<p id="S4.p1.2" class="ltx_p">Our experiments on the federated CIFAR-100 and StackOverflow datasets show that the effectiveness of the <span id="S4.p1.2.1" class="ltx_text ltx_font_smallcaps">PeriodicCodist</span> and <span id="S4.p1.2.2" class="ltx_text ltx_font_smallcaps">MergedCodist</span> strategies for codistillation depends on the sizes of the model, the client pool, and the distillation dataset. Codistillation offers the most benefit when the larger model, trained on the smaller subset of high-capacity clients, cannot utilize its full capacity due to limited training data. This is evident in Table <a href="#S3.T1" title="Table 1 ‣ 3.1 Balanced Model Performance ‣ 3 Experiments ‣ Heterogeneous Federated Learning Using Knowledge Codistillation" class="ltx_ref"><span class="ltx_text ltx_ref_tag">1</span></a> where the gains are more substantial for both codistillation strategies when the size of the high-capacity clients’ pool is smaller. In most cases, both models can benefit by exchanging information throughout training; the larger model utilizes the information in the larger pool of clients through the smaller model, and the smaller model can benefit from the higher capacity of the larger model.
Of the two codistillation strategies, <span id="S4.p1.2.3" class="ltx_text ltx_font_smallcaps">PeriodicCodist</span> is easier to integrate into standard <span id="S4.p1.2.4" class="ltx_text ltx_font_smallcaps">FedAvg</span> setups and does not require significant changes on the server side. Additionally, <span id="S4.p1.2.5" class="ltx_text ltx_font_smallcaps">PeriodicCodist</span> offers more flexibility in terms of computation by adjusting the codistillation period based on the available resources. However, <span id="S4.p1.2.6" class="ltx_text ltx_font_smallcaps">MergedCodist</span> is the more effective strategy and consistently improves performance in most scenarios. A downside of <span id="S4.p1.2.7" class="ltx_text ltx_font_smallcaps">MergedCodist</span> is that it requires running codistillation at every federated round. To reduce this overhead of <span id="S4.p1.2.8" class="ltx_text ltx_font_smallcaps">MergedCodist</span>, we can adjust the combination factor <math id="S4.p1.1.m1.1" class="ltx_Math" alttext="\alpha" display="inline"><semantics id="S4.p1.1.m1.1a"><mi id="S4.p1.1.m1.1.1" xref="S4.p1.1.m1.1.1.cmml">α</mi><annotation-xml encoding="MathML-Content" id="S4.p1.1.m1.1b"><ci id="S4.p1.1.m1.1.1.cmml" xref="S4.p1.1.m1.1.1">𝛼</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.p1.1.m1.1c">\alpha</annotation></semantics></math> (Equation <a href="#S2.E2" title="Equation 2 ‣ 2.2 Merged Gradient Codistillation (MergedCodist) ‣ 2 Methods ‣ Heterogeneous Federated Learning Using Knowledge Codistillation" class="ltx_ref"><span class="ltx_text ltx_ref_tag">2</span></a>) dynamically during training. By setting <math id="S4.p1.2.m2.1" class="ltx_Math" alttext="\alpha=1" display="inline"><semantics id="S4.p1.2.m2.1a"><mrow id="S4.p1.2.m2.1.1" xref="S4.p1.2.m2.1.1.cmml"><mi id="S4.p1.2.m2.1.1.2" xref="S4.p1.2.m2.1.1.2.cmml">α</mi><mo id="S4.p1.2.m2.1.1.1" xref="S4.p1.2.m2.1.1.1.cmml">=</mo><mn id="S4.p1.2.m2.1.1.3" xref="S4.p1.2.m2.1.1.3.cmml">1</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.p1.2.m2.1b"><apply id="S4.p1.2.m2.1.1.cmml" xref="S4.p1.2.m2.1.1"><eq id="S4.p1.2.m2.1.1.1.cmml" xref="S4.p1.2.m2.1.1.1"></eq><ci id="S4.p1.2.m2.1.1.2.cmml" xref="S4.p1.2.m2.1.1.2">𝛼</ci><cn type="integer" id="S4.p1.2.m2.1.1.3.cmml" xref="S4.p1.2.m2.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.p1.2.m2.1c">\alpha=1</annotation></semantics></math>, we can recover <span id="S4.p1.2.9" class="ltx_text ltx_font_smallcaps">FedAvg</span> and skip the codistillation cost for specific rounds. We plan to explore such strategies for more efficient utilization of computing resources in the future. In our experiments, we investigated codistillation in settings where the clients were partitioned according to capacity. Alternative criteria for partitioning clients could be based on user characteristics, an aspect we plan to explore in the future.</p>
</div>
</section>
<section id="S5" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">5 </span>Conclusion</h2>

<div id="S5.p1" class="ltx_para">
<p id="S5.p1.1" class="ltx_p">We have introduced two new methods for federated learning built on top of <span id="S5.p1.1.1" class="ltx_text ltx_font_smallcaps">FedAvg</span>; <span id="S5.p1.1.2" class="ltx_text ltx_font_smallcaps">PeriodicCodist</span> and <span id="S5.p1.1.3" class="ltx_text ltx_font_smallcaps">MergedCodist</span>, which address the unused modeling capacity on high-quality hardware necessitated by the shared-model-architecture constraint of <span id="S5.p1.1.4" class="ltx_text ltx_font_smallcaps">FedAvg</span>. We have conducted experiments on image classification and language modeling tasks and have shown that these methods outperform <span id="S5.p1.1.5" class="ltx_text ltx_font_smallcaps">FedAvg</span>. Both methods allow us to train a computationally efficient model on all clients while still benefiting from the enhanced modeling power of a larger model trained on a subset of the entire client pool. These methods are applicable even when only out-of-domain data is available or when only a limited amount of in-domain data can be collected. We have demonstrated that a high-capacity teacher can help improve a low-capacity student, even when the teacher has lower performance than the student. In addition to providing performance gains, both <span id="S5.p1.1.6" class="ltx_text ltx_font_smallcaps">MergedCodist</span> and <span id="S5.p1.1.7" class="ltx_text ltx_font_smallcaps">PeriodicCodist</span> are useful for sharing domain-specific knowledge between models. Our proposed methods provide a means to more fully utilize the modeling capacity available within a federated population. We will release code for both methods on publication of this work.</p>
</div>
<div class="ltx_pagination ltx_role_newpage"></div>
</section>
<section id="bib" class="ltx_bibliography">
<h2 class="ltx_title ltx_title_bibliography">References</h2>

<ul class="ltx_biblist">
<li id="bib.bib1" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Afonin &amp; Karimireddy (2021)</span>
<span class="ltx_bibblock">
Afonin, A. and Karimireddy, S. P.

</span>
<span class="ltx_bibblock">Towards model agnostic federated learning using knowledge
distillation.

</span>
<span class="ltx_bibblock"><em id="bib.bib1.1.1" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:2110.15210</em>, 2021.

</span>
</li>
<li id="bib.bib2" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Ahn et al. (2019)</span>
<span class="ltx_bibblock">
Ahn, J.-H., Simeone, O., and Kang, J.

</span>
<span class="ltx_bibblock">Wireless federated distillation for distributed edge learning with
heterogeneous data.

</span>
<span class="ltx_bibblock">In <em id="bib.bib2.1.1" class="ltx_emph ltx_font_italic">2019 IEEE 30th Annual International Symposium on Personal,
Indoor and Mobile Radio Communications (PIMRC)</em>, pp.  1–6. IEEE, 2019.

</span>
</li>
<li id="bib.bib3" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Ahn et al. (2020)</span>
<span class="ltx_bibblock">
Ahn, J.-H., Simeone, O., and Kang, J.

</span>
<span class="ltx_bibblock">Cooperative learning via federated distillation over fading channels.

</span>
<span class="ltx_bibblock">In <em id="bib.bib3.1.1" class="ltx_emph ltx_font_italic">ICASSP 2020-2020 IEEE International Conference on Acoustics,
Speech and Signal Processing (ICASSP)</em>, pp.  8856–8860. IEEE, 2020.

</span>
</li>
<li id="bib.bib4" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Amid et al. (2022)</span>
<span class="ltx_bibblock">
Amid, E., Anil, R., Fifty, C., and Warmuth, M. K.

</span>
<span class="ltx_bibblock">Layerwise Bregman representation learning with applications to
knowledge distillation.

</span>
<span class="ltx_bibblock"><em id="bib.bib4.1.1" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:2209.07080</em>, 2022.

</span>
</li>
<li id="bib.bib5" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Anil et al. (2018)</span>
<span class="ltx_bibblock">
Anil, R., Pereyra, G., Passos, A. T., Ormandi, R., Dahl, G., and Hinton, G.

</span>
<span class="ltx_bibblock">Large scale distributed neural network training through online
distillation.

</span>
<span class="ltx_bibblock"><em id="bib.bib5.1.1" class="ltx_emph ltx_font_italic">International Conference on Learning Representations (ICLR)</em>,
2018.

</span>
</li>
<li id="bib.bib6" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Bird et al. (2009)</span>
<span class="ltx_bibblock">
Bird, S., Klein, E., and Loper, E.

</span>
<span class="ltx_bibblock"><em id="bib.bib6.1.1" class="ltx_emph ltx_font_italic">Natural language processing with Python: analyzing text with
the natural language toolkit</em>.

</span>
<span class="ltx_bibblock">” O’Reilly Media, Inc.”, 2009.

</span>
</li>
<li id="bib.bib7" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Chen et al. (2022)</span>
<span class="ltx_bibblock">
Chen, Q., Wang, Z., Wang, H., and Lin, X.

</span>
<span class="ltx_bibblock">Feddual: Pair-wise gossip helps federated learning in large
decentralized networks.

</span>
<span class="ltx_bibblock"><em id="bib.bib7.1.1" class="ltx_emph ltx_font_italic">IEEE Transactions on Information Forensics and Security</em>,
18:335–350, 2022.

</span>
</li>
<li id="bib.bib8" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Diao et al. (2020)</span>
<span class="ltx_bibblock">
Diao, E., Ding, J., and Tarokh, V.

</span>
<span class="ltx_bibblock">Heterofl: Computation and communication efficient federated learning
for heterogeneous clients.

</span>
<span class="ltx_bibblock"><em id="bib.bib8.1.1" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:2010.01264</em>, 2020.

</span>
</li>
<li id="bib.bib9" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Golovin et al. (2017)</span>
<span class="ltx_bibblock">
Golovin, D., Solnik, B., Moitra, S., Kochanski, G., Karro, J., and Sculley, D.

</span>
<span class="ltx_bibblock">Google vizier: A service for black-box optimization.

</span>
<span class="ltx_bibblock">In <em id="bib.bib9.1.1" class="ltx_emph ltx_font_italic">Proceedings of the 23rd ACM SIGKDD international conference
on knowledge discovery and data mining</em>, pp.  1487–1495, 2017.

</span>
</li>
<li id="bib.bib10" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Goodfellow et al. (2016)</span>
<span class="ltx_bibblock">
Goodfellow, I., Bengio, Y., and Courville, A.

</span>
<span class="ltx_bibblock"><em id="bib.bib10.1.1" class="ltx_emph ltx_font_italic">Deep learning</em>.

</span>
<span class="ltx_bibblock">MIT press, 2016.

</span>
</li>
<li id="bib.bib11" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Hinton et al. (2015)</span>
<span class="ltx_bibblock">
Hinton, G., Vinyals, O., Dean, J., et al.

</span>
<span class="ltx_bibblock">Distilling the knowledge in a neural network.

</span>
<span class="ltx_bibblock"><em id="bib.bib11.1.1" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:1503.02531</em>, 2(7), 2015.

</span>
</li>
<li id="bib.bib12" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Hochreiter &amp; Schmidhuber (1997)</span>
<span class="ltx_bibblock">
Hochreiter, S. and Schmidhuber, J.

</span>
<span class="ltx_bibblock">Long short-term memory.

</span>
<span class="ltx_bibblock"><em id="bib.bib12.1.1" class="ltx_emph ltx_font_italic">Neural Comput.</em>, 9(8):1735–1780, nov
1997.

</span>
<span class="ltx_bibblock">ISSN 0899-7667.

</span>
<span class="ltx_bibblock">doi: <span class="ltx_ref ltx_nolink ltx_Url ltx_ref_self">10.1162/neco.1997.9.8.1735</span>.

</span>
<span class="ltx_bibblock">URL <a target="_blank" href="https://doi.org/10.1162/neco.1997.9.8.1735" title="" class="ltx_ref ltx_url ltx_font_typewriter">https://doi.org/10.1162/neco.1997.9.8.1735</a>.

</span>
</li>
<li id="bib.bib13" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Hong et al. (2022)</span>
<span class="ltx_bibblock">
Hong, J., Wang, H., Wang, Z., and Zhou, J.

</span>
<span class="ltx_bibblock">Efficient split-mix federated learning for on-demand and in-situ
customization.

</span>
<span class="ltx_bibblock"><em id="bib.bib13.1.1" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:2203.09747</em>, 2022.

</span>
</li>
<li id="bib.bib14" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Itahara et al. (2020)</span>
<span class="ltx_bibblock">
Itahara, S., Nishio, T., Koda, Y., Morikura, M., and Yamamoto, K.

</span>
<span class="ltx_bibblock">Distillation-based semi-supervised federated learning for
communication-efficient collaborative training with non-iid private data.

</span>
<span class="ltx_bibblock"><em id="bib.bib14.1.1" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:2008.06180</em>, 2020.

</span>
</li>
<li id="bib.bib15" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Jeong et al. (2018)</span>
<span class="ltx_bibblock">
Jeong, E., Oh, S., Kim, H., Park, J., Bennis, M., and Kim, S.-L.

</span>
<span class="ltx_bibblock">Communication-efficient on-device machine learning: Federated
distillation and augmentation under non-iid private data.

</span>
<span class="ltx_bibblock"><em id="bib.bib15.1.1" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:1811.11479</em>, 2018.

</span>
</li>
<li id="bib.bib16" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Kingma &amp; Ba (2014)</span>
<span class="ltx_bibblock">
Kingma, D. P. and Ba, J.

</span>
<span class="ltx_bibblock">Adam: A method for stochastic optimization.

</span>
<span class="ltx_bibblock"><em id="bib.bib16.1.1" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:1412.6980</em>, 2014.

</span>
</li>
<li id="bib.bib17" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Krizhevsky et al. (2009)</span>
<span class="ltx_bibblock">
Krizhevsky, A., Hinton, G., et al.

</span>
<span class="ltx_bibblock">Learning multiple layers of features from tiny images.

</span>
<span class="ltx_bibblock">2009.

</span>
</li>
<li id="bib.bib18" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Li et al. (2020)</span>
<span class="ltx_bibblock">
Li, T., Sahu, A. K., Zaheer, M., Sanjabi, M., Talwalkar, A., and Smith, V.

</span>
<span class="ltx_bibblock">Federated optimization in heterogeneous networks.

</span>
<span class="ltx_bibblock"><em id="bib.bib18.1.1" class="ltx_emph ltx_font_italic">Proceedings of Machine learning and systems</em>, 2:429–450, 2020.

</span>
</li>
<li id="bib.bib19" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Lin et al. (2020)</span>
<span class="ltx_bibblock">
Lin, T., Kong, L., Stich, S. U., and Jaggi, M.

</span>
<span class="ltx_bibblock">Ensemble distillation for robust model fusion in federated learning.

</span>
<span class="ltx_bibblock">In <em id="bib.bib19.1.1" class="ltx_emph ltx_font_italic">Advances in Neural Information Processing Systems</em>,
volume 33, pp.  2351–2363. Curran Associates, Inc., 2020.

</span>
</li>
<li id="bib.bib20" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">McMahan et al. (2017)</span>
<span class="ltx_bibblock">
McMahan, B., Moore, E., Ramage, D., Hampson, S., and y Arcas, B. A.

</span>
<span class="ltx_bibblock">Communication-efficient learning of deep networks from decentralized
data.

</span>
<span class="ltx_bibblock">In <em id="bib.bib20.1.1" class="ltx_emph ltx_font_italic">Artificial intelligence and statistics</em>, pp.  1273–1282.
PMLR, 2017.

</span>
</li>
<li id="bib.bib21" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">McMahan et al. (2016)</span>
<span class="ltx_bibblock">
McMahan, H. B., Moore, E., Ramage, D., and y Arcas, B. A.

</span>
<span class="ltx_bibblock">Federated learning of deep networks using model averaging.

</span>
<span class="ltx_bibblock"><em id="bib.bib21.1.1" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:1602.05629</em>, 2, 2016.

</span>
</li>
<li id="bib.bib22" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Mei et al. (2022)</span>
<span class="ltx_bibblock">
Mei, Y., Guo, P., Zhou, M., and Patel, V.

</span>
<span class="ltx_bibblock">Resource-adaptive federated learning with all-in-one neural
composition.

</span>
<span class="ltx_bibblock">In <em id="bib.bib22.1.1" class="ltx_emph ltx_font_italic">Advances in Neural Information Processing Systems</em>, 2022.

</span>
</li>
<li id="bib.bib23" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Mora et al. (2022)</span>
<span class="ltx_bibblock">
Mora, A., Tenison, I., Bellavista, P., and Rish, I.

</span>
<span class="ltx_bibblock">Knowledge distillation for federated learning: a practical guide.

</span>
<span class="ltx_bibblock"><em id="bib.bib23.1.1" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:2211.04742</em>, 2022.

</span>
</li>
<li id="bib.bib24" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Müller et al. (2020)</span>
<span class="ltx_bibblock">
Müller, R., Kornblith, S., and Hinton, G.

</span>
<span class="ltx_bibblock">Subclass distillation.

</span>
<span class="ltx_bibblock"><em id="bib.bib24.1.1" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:2002.03936</em>, 2020.

</span>
</li>
<li id="bib.bib25" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Murphy (2022)</span>
<span class="ltx_bibblock">
Murphy, K. P.

</span>
<span class="ltx_bibblock"><em id="bib.bib25.1.1" class="ltx_emph ltx_font_italic">Probabilistic machine learning: an introduction</em>.

</span>
<span class="ltx_bibblock">MIT press, 2022.

</span>
</li>
<li id="bib.bib26" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Oh et al. (2020)</span>
<span class="ltx_bibblock">
Oh, S., Park, J., Jeong, E., Kim, H., Bennis, M., and Kim, S.-L.

</span>
<span class="ltx_bibblock">Mix2fld: Downlink federated learning after uplink federated
distillation with two-way mixup.

</span>
<span class="ltx_bibblock"><em id="bib.bib26.1.1" class="ltx_emph ltx_font_italic">IEEE Communications Letters</em>, 24(10):2211–2215, 2020.

</span>
<span class="ltx_bibblock">doi: <span class="ltx_ref ltx_nolink ltx_Url ltx_ref_self">10.1109/LCOMM.2020.3003693</span>.

</span>
</li>
<li id="bib.bib27" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Ozkara et al. (2021)</span>
<span class="ltx_bibblock">
Ozkara, K., Singh, N., Data, D., and Diggavi, S.

</span>
<span class="ltx_bibblock">Quped: Quantized personalization via distillation with applications
to federated learning.

</span>
<span class="ltx_bibblock"><em id="bib.bib27.1.1" class="ltx_emph ltx_font_italic">Advances in Neural Information Processing Systems</em>,
34:3622–3634, 2021.

</span>
</li>
<li id="bib.bib28" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Raffel et al. (2020)</span>
<span class="ltx_bibblock">
Raffel, C., Shazeer, N., Roberts, A., Lee, K., Narang, S., Matena, M., Zhou,
Y., Li, W., Liu, P. J., et al.

</span>
<span class="ltx_bibblock">Exploring the limits of transfer learning with a unified text-to-text
transformer.

</span>
<span class="ltx_bibblock"><em id="bib.bib28.1.1" class="ltx_emph ltx_font_italic">J. Mach. Learn. Res.</em>, 21(140):1–67, 2020.

</span>
</li>
<li id="bib.bib29" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Reddi et al. (2021)</span>
<span class="ltx_bibblock">
Reddi, S., Charles, Z., Zaheer, M., Garrett, Z., Rush, K., Konečnỳ,
J., Kumar, S., and McMahan, H. B.

</span>
<span class="ltx_bibblock">Adaptive federated optimization.

</span>
<span class="ltx_bibblock"><em id="bib.bib29.1.1" class="ltx_emph ltx_font_italic">International Conference on Learning Representations (ICLR)</em>,
2021.

</span>
</li>
<li id="bib.bib30" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Ro et al. (2021)</span>
<span class="ltx_bibblock">
Ro, J. H., Suresh, A. T., and Wu, K.

</span>
<span class="ltx_bibblock">FedJax: Federated learning simulation with JAX.

</span>
<span class="ltx_bibblock"><em id="bib.bib30.1.1" class="ltx_emph ltx_font_italic">CoRR</em>, abs/2108.02117, 2021.

</span>
</li>
<li id="bib.bib31" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Romero et al. (2014)</span>
<span class="ltx_bibblock">
Romero, A., Ballas, N., Kahou, S. E., Chassang, A., Gatta, C., and Bengio, Y.

</span>
<span class="ltx_bibblock">Fitnets: Hints for thin deep nets.

</span>
<span class="ltx_bibblock"><em id="bib.bib31.1.1" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:1412.6550</em>, 2014.

</span>
</li>
<li id="bib.bib32" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Schuster &amp; Nakajima (2012)</span>
<span class="ltx_bibblock">
Schuster, M. and Nakajima, K.

</span>
<span class="ltx_bibblock">Japanese and Korean voice search.

</span>
<span class="ltx_bibblock">In <em id="bib.bib32.1.1" class="ltx_emph ltx_font_italic">2012 IEEE International Conference on Acoustics, Speech and
Signal Processing (ICASSP)</em>, pp.  5149–5152, 2012.

</span>
</li>
<li id="bib.bib33" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Seo et al. (2022)</span>
<span class="ltx_bibblock">
Seo, H., Park, J., Oh, S., Bennis, M., and Kim, S.-L.

</span>
<span class="ltx_bibblock">Federated knowledge distillation.

</span>
<span class="ltx_bibblock"><em id="bib.bib33.1.1" class="ltx_emph ltx_font_italic">Machine Learning and Wireless Communications</em>, pp.  457, 2022.

</span>
</li>
<li id="bib.bib34" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Tian et al. (2019)</span>
<span class="ltx_bibblock">
Tian, Y., Krishnan, D., and Isola, P.

</span>
<span class="ltx_bibblock">Contrastive representation distillation.

</span>
<span class="ltx_bibblock"><em id="bib.bib34.1.1" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:1910.10699</em>, 2019.

</span>
</li>
<li id="bib.bib35" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Wang et al. (2021)</span>
<span class="ltx_bibblock">
Wang, J., Charles, Z., Xu, Z., Joshi, G., McMahan, H. B., Al-Shedivat, M.,
Andrew, G., Avestimehr, S., Daly, K., Data, D., et al.

</span>
<span class="ltx_bibblock">A field guide to federated optimization.

</span>
<span class="ltx_bibblock"><em id="bib.bib35.1.1" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:2107.06917</em>, 2021.

</span>
</li>
<li id="bib.bib36" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Yuan et al. (2021)</span>
<span class="ltx_bibblock">
Yuan, H., Zaheer, M., and Reddi, S.

</span>
<span class="ltx_bibblock">Federated composite optimization.

</span>
<span class="ltx_bibblock">In <em id="bib.bib36.1.1" class="ltx_emph ltx_font_italic">International Conference on Machine Learning</em>, pp. 12253–12266. PMLR, 2021.

</span>
</li>
<li id="bib.bib37" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Zhang et al. (2017)</span>
<span class="ltx_bibblock">
Zhang, H., Cissé, M., Dauphin, Y. N., and Lopez-Paz, D.

</span>
<span class="ltx_bibblock">mixup: Beyond empirical risk minimization.

</span>
<span class="ltx_bibblock"><em id="bib.bib37.1.1" class="ltx_emph ltx_font_italic">CoRR</em>, abs/1710.09412, 2017.

</span>
</li>
<li id="bib.bib38" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Zhang et al. (2022)</span>
<span class="ltx_bibblock">
Zhang, L., Shen, L., Ding, L., Tao, D., and Duan, L.-Y.

</span>
<span class="ltx_bibblock">Fine-tuning global model via data-free knowledge distillation for
non-iid federated learning.

</span>
<span class="ltx_bibblock">In <em id="bib.bib38.1.1" class="ltx_emph ltx_font_italic">Proceedings of the IEEE/CVF Conference on Computer Vision
and Pattern Recognition</em>, pp.  10174–10183, 2022.

</span>
</li>
<li id="bib.bib39" class="ltx_bibitem">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Zhu et al. (2022)</span>
<span class="ltx_bibblock">
Zhu, Z., Hong, J., Drew, S., and Zhou, J.

</span>
<span class="ltx_bibblock">Resilient and communication efficient learning for heterogeneous
federated systems.

</span>
<span class="ltx_bibblock">In <em id="bib.bib39.1.1" class="ltx_emph ltx_font_italic">International Conference on Machine Learning</em>, pp. 27504–27526. PMLR, 2022.

</span>
</li>
</ul>
</section>
<div class="ltx_pagination ltx_role_newpage"></div>
<section id="A1" class="ltx_appendix">
<h2 class="ltx_title ltx_title_appendix">
<span class="ltx_tag ltx_tag_appendix">Appendix A </span>Related Work</h2>

<div id="A1.p1" class="ltx_para">
<p id="A1.p1.1" class="ltx_p"><cite class="ltx_cite ltx_citemacro_citet">Mora et al. (<a href="#bib.bib23" title="" class="ltx_ref">2022</a>)</cite> present an overview of Knowledge Distillation (KD) techniques for Federated Learning (FL). In one set of approaches, client models transfer knowledge to a centralized served model <cite class="ltx_cite ltx_citemacro_citep">(Seo et al., <a href="#bib.bib33" title="" class="ltx_ref">2022</a>)</cite>, In the second set, called <em id="A1.p1.1.1" class="ltx_emph ltx_font_italic">co-distillation</em> <cite class="ltx_cite ltx_citemacro_citep">(Anil et al., <a href="#bib.bib5" title="" class="ltx_ref">2018</a>)</cite>, an ensemble of clients learn without a central server model. <cite class="ltx_cite ltx_citemacro_citet">Jeong et al. (<a href="#bib.bib15" title="" class="ltx_ref">2018</a>)</cite> propose a distillation strategy that significantly reduces communication costs by exchanging soft targets instead of model parameters between the server and clients. In this approach, the clients transmit their per-label averaged logits computed on their private data, and the server averages these logits and broadcasts them in the next round. The clients then regularize their local loss using the server’s logits. Variants of this method are presented by <cite class="ltx_cite ltx_citemacro_citet">Oh et al. (<a href="#bib.bib26" title="" class="ltx_ref">2020</a>); Ahn et al. (<a href="#bib.bib2" title="" class="ltx_ref">2019</a>, <a href="#bib.bib3" title="" class="ltx_ref">2020</a>)</cite>. <cite class="ltx_cite ltx_citemacro_citet">Itahara et al. (<a href="#bib.bib14" title="" class="ltx_ref">2020</a>)</cite> demonstrate that this technique does not perform as well as <span id="A1.p1.1.2" class="ltx_text ltx_font_smallcaps">FedAvg</span> on non-IID data in terms of communication cost and accuracy. They present a variation where clients compute logits on unlabeled data, which are then averaged to compute a global logit after applying a temperature parameter that is chosen to minimize the entropy of the softmax. Their strategy leads to a lower communication cost and better accuracy than <span id="A1.p1.1.3" class="ltx_text ltx_font_smallcaps">FedAvg</span>. <cite class="ltx_cite ltx_citemacro_citet">Afonin &amp; Karimireddy (<a href="#bib.bib1" title="" class="ltx_ref">2021</a>)</cite> present a theoretical framework for KD in FL, showing that the performance is limited by data heterogeneity. <cite class="ltx_cite ltx_citemacro_citet">Ozkara et al. (<a href="#bib.bib27" title="" class="ltx_ref">2021</a>)</cite> propose a KD approach for learning personalized FL models where the clients can differ in terms of architecture and weight precision.</p>
</div>
<div id="A1.p2" class="ltx_para">
<p id="A1.p2.1" class="ltx_p"><span id="A1.p2.1.1" class="ltx_text" style="color:#000000;">FedDF <cite class="ltx_cite ltx_citemacro_citep">(Lin et al., <a href="#bib.bib19" title="" class="ltx_ref">2020</a>)</cite> allows for different model topologies between clients, rather than requiring all clients to use the same architecture. This is done by maintaining multiple server model prototypes, one for each unique client topology. In each round of federated learning, the client models are updated using their local data and an ensemble is computed by averaging logits from all client models sampled in that round, regardless of the architecture. This step enables sharing of information across model topologies. Distillation is then performed using the ensemble as the teacher and the server model prototype as the student. Each client model is sent the updated server model prototype that corresponds to its topology. Both FedDF and our method relax the assumption of identical model topology in FedAVG and enable sharing of information between models with different topologies. In our method, this is made possible by dividing the set of clients into pools based on capacity and using co-distillation to share information between the server pools. While FedDF diverges from <span id="A1.p2.1.1.1" class="ltx_text ltx_font_smallcaps">FedAvg</span> in using client logits for constructing server models, we use <span id="A1.p2.1.1.2" class="ltx_text ltx_font_smallcaps">FedAvg</span> as a building block. This makes our method easier to implement when compared to FedDF, which requires considerable changes to the FedAVG implementation. Unlike FedDF, our approach additionally enables learning an explicit shared representation within each client pool, whereas in FedDF, this is only possible in an indirect manner by initializing the server model prototype with the average of the client models with that topology.</span>
<span id="A1.p2.1.2" class="ltx_text" style="color:#000000;">By learning explicit shared representations within each client pool, our method is robust to data-heterogeneous scenarios, as each model can become an expert in its pool’s domain, and be a useful teacher to the out-of-domain model(s). See Appendix <a href="#A4.SS1" title="D.1 Domain-shifted Client Pools ‣ Appendix D Further Analysis ‣ Heterogeneous Federated Learning Using Knowledge Codistillation" class="ltx_ref"><span class="ltx_text ltx_ref_tag">D.1</span></a> for experiments demonstrating strong performance when splitting the clients introduces domain-shift between client pools.</span></p>
</div>
<div id="A1.p3" class="ltx_para">
<p id="A1.p3.2" class="ltx_p"><cite class="ltx_cite ltx_citemacro_citet">Zhu et al. (<a href="#bib.bib39" title="" class="ltx_ref">2022</a>)</cite> and <cite class="ltx_cite ltx_citemacro_citet">Diao et al. (<a href="#bib.bib8" title="" class="ltx_ref">2020</a>)</cite> present FL approaches which are robust to heterogeneity in client sizes. In both approaches, each client updates a fraction of the parameters in the server model depending on its capacity. In <cite class="ltx_cite ltx_citemacro_citet">Zhu et al. (<a href="#bib.bib39" title="" class="ltx_ref">2022</a>)</cite>, the model is learnt in an incremental manner by adding one parameter column at a time. At download (upload) time, a client only downloads (uploads) the first <math id="A1.p3.1.m1.1" class="ltx_Math" alttext="k" display="inline"><semantics id="A1.p3.1.m1.1a"><mi id="A1.p3.1.m1.1.1" xref="A1.p3.1.m1.1.1.cmml">k</mi><annotation-xml encoding="MathML-Content" id="A1.p3.1.m1.1b"><ci id="A1.p3.1.m1.1.1.cmml" xref="A1.p3.1.m1.1.1">𝑘</ci></annotation-xml><annotation encoding="application/x-tex" id="A1.p3.1.m1.1c">k</annotation></semantics></math> columns. In <cite class="ltx_cite ltx_citemacro_citet">Diao et al. (<a href="#bib.bib8" title="" class="ltx_ref">2020</a>)</cite>., the parameters of the server model in each layer are decomposed into nested subsets. A client only receives the subset of the model depending on its capacity. The approach of <cite class="ltx_cite ltx_citemacro_citet">Zhu et al. (<a href="#bib.bib39" title="" class="ltx_ref">2022</a>)</cite> is also resilient to network unreliability because if there is a disruption in the network after downloading the first <math id="A1.p3.2.m2.1" class="ltx_Math" alttext="k" display="inline"><semantics id="A1.p3.2.m2.1a"><mi id="A1.p3.2.m2.1.1" xref="A1.p3.2.m2.1.1.cmml">k</mi><annotation-xml encoding="MathML-Content" id="A1.p3.2.m2.1b"><ci id="A1.p3.2.m2.1.1.cmml" xref="A1.p3.2.m2.1.1">𝑘</ci></annotation-xml><annotation encoding="application/x-tex" id="A1.p3.2.m2.1c">k</annotation></semantics></math> columns, the remaining columns can be copied from the last round. Both these approaches and ours allow the possibility for different clients to have different network sizes. The difference between their work and ours is that in their case, there is no explicit strategy for the small (or large) capacity models to share representation amongst themselves. In contrast, we employ distinct pools for the small/large capacity clients which enables learning of a better shared representation within each pool<span id="A1.p3.2.1" class="ltx_text" style="color:#000000;">, and makes the server models more robust to data heterogeneity between pools</span>. Like their approaches, our approach also benefits from communication efficiency in that the model sizes in the low-capacity pool are smaller than that in the high-capacity pool. In their approaches, the smaller subsets of global parameters benefit more from aggregation relative to larger subsets, which are thus relatively undertrained. Our approach does not share this limitation because it updates all parameters of the server model in each client pool. <cite class="ltx_cite ltx_citemacro_citet">Zhu et al. (<a href="#bib.bib39" title="" class="ltx_ref">2022</a>)</cite> have an additional assumption that the model can be learnt in a progressive manner by adding one column at a time, but we do not rely on such an assumption. <span id="A1.p3.2.2" class="ltx_text" style="color:#000000;">Additionally, any method which trains a single server model can be used in any client pool of our methods as a drop-in replacement for <span id="A1.p3.2.2.1" class="ltx_text ltx_font_smallcaps">FedAvg</span>. This allows our method to subsume any gains made by FL methods which produce single server models, while retaining the advantages of model heterogeneity and pool-specific shared representations.</span></p>
</div>
<div id="A1.p4" class="ltx_para">
<p id="A1.p4.1" class="ltx_p"><span id="A1.p4.1.1" class="ltx_text" style="color:#000000;">Many other methods make improvements to <span id="A1.p4.1.1.1" class="ltx_text ltx_font_smallcaps">FedAvg</span> while still training a single server model:
Split-mix FL <cite class="ltx_cite ltx_citemacro_citep">(Hong et al., <a href="#bib.bib13" title="" class="ltx_ref">2022</a>)</cite> extends HeteroFL by splitting the server model into base models based on width, and allowing all base models to be trained on all clients.
FLANC <cite class="ltx_cite ltx_citemacro_citep">(Mei et al., <a href="#bib.bib22" title="" class="ltx_ref">2022</a>)</cite> uses low rank approximation to assemble local models on the fly from a shared basis; each local model modifies the shared basis and the local model transformation coefficients. FedFTG <cite class="ltx_cite ltx_citemacro_citep">(Zhang et al., <a href="#bib.bib38" title="" class="ltx_ref">2022</a>)</cite> fine-tunes the server model to correct the model shift after aggregation so that the server model preserves the information in the local models to the maximum extent. Other methods which modify <span id="A1.p4.1.1.2" class="ltx_text ltx_font_smallcaps">FedAvg</span> but do not address the constraint of model-heterogeneity include FedProx <cite class="ltx_cite ltx_citemacro_citep">(Li et al., <a href="#bib.bib18" title="" class="ltx_ref">2020</a>)</cite>, FedMiD <cite class="ltx_cite ltx_citemacro_citep">(Yuan et al., <a href="#bib.bib36" title="" class="ltx_ref">2021</a>)</cite>, and FedDual <cite class="ltx_cite ltx_citemacro_citep">(Chen et al., <a href="#bib.bib7" title="" class="ltx_ref">2022</a>)</cite>. Since the above approaches train a single server model and can be thought of as improvements over FedAVG, our methods yield complementary and orthogonal gains as our co-distillation framework can be applied in conjunction by using any of these methods as the federated algorithm applied to a single pool.
</span></p>
</div>
<div class="ltx_pagination ltx_role_newpage"></div>
</section>
<section id="A2" class="ltx_appendix">
<h2 class="ltx_title ltx_title_appendix">
<span class="ltx_tag ltx_tag_appendix">Appendix B </span>Methods</h2>

<figure id="alg1" class="ltx_float ltx_float_algorithm ltx_framed ltx_framed_top">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_float"><span id="alg1.3.1.1" class="ltx_text ltx_font_bold">Algorithm 1</span> </span> <span id="alg1.4.2" class="ltx_text ltx_font_smallcaps">PeriodicCodist</span>: Periodic Codistillation</figcaption>
<div id="alg1.5" class="ltx_listing ltx_listing">
<div id="alg1.l0" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg1.l0.1.1.1" class="ltx_text" style="font-size:80%;">0:</span></span>  number of <span id="alg1.l0.2" class="ltx_text ltx_font_smallcaps">FedAvg</span> rounds <math id="alg1.l0.m1.1" class="ltx_Math" alttext="T" display="inline"><semantics id="alg1.l0.m1.1a"><mi id="alg1.l0.m1.1.1" xref="alg1.l0.m1.1.1.cmml">T</mi><annotation-xml encoding="MathML-Content" id="alg1.l0.m1.1b"><ci id="alg1.l0.m1.1.1.cmml" xref="alg1.l0.m1.1.1">𝑇</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.l0.m1.1c">T</annotation></semantics></math>, total clients pool <math id="alg1.l0.m2.1" class="ltx_Math" alttext="\mathcal{P}" display="inline"><semantics id="alg1.l0.m2.1a"><mi class="ltx_font_mathcaligraphic" id="alg1.l0.m2.1.1" xref="alg1.l0.m2.1.1.cmml">𝒫</mi><annotation-xml encoding="MathML-Content" id="alg1.l0.m2.1b"><ci id="alg1.l0.m2.1.1.cmml" xref="alg1.l0.m2.1.1">𝒫</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.l0.m2.1c">\mathcal{P}</annotation></semantics></math> and the subset of high-performance clients <math id="alg1.l0.m3.1" class="ltx_Math" alttext="\mathcal{P}_{H}\subset\mathcal{P}" display="inline"><semantics id="alg1.l0.m3.1a"><mrow id="alg1.l0.m3.1.1" xref="alg1.l0.m3.1.1.cmml"><msub id="alg1.l0.m3.1.1.2" xref="alg1.l0.m3.1.1.2.cmml"><mi class="ltx_font_mathcaligraphic" id="alg1.l0.m3.1.1.2.2" xref="alg1.l0.m3.1.1.2.2.cmml">𝒫</mi><mi id="alg1.l0.m3.1.1.2.3" xref="alg1.l0.m3.1.1.2.3.cmml">H</mi></msub><mo id="alg1.l0.m3.1.1.1" xref="alg1.l0.m3.1.1.1.cmml">⊂</mo><mi class="ltx_font_mathcaligraphic" id="alg1.l0.m3.1.1.3" xref="alg1.l0.m3.1.1.3.cmml">𝒫</mi></mrow><annotation-xml encoding="MathML-Content" id="alg1.l0.m3.1b"><apply id="alg1.l0.m3.1.1.cmml" xref="alg1.l0.m3.1.1"><subset id="alg1.l0.m3.1.1.1.cmml" xref="alg1.l0.m3.1.1.1"></subset><apply id="alg1.l0.m3.1.1.2.cmml" xref="alg1.l0.m3.1.1.2"><csymbol cd="ambiguous" id="alg1.l0.m3.1.1.2.1.cmml" xref="alg1.l0.m3.1.1.2">subscript</csymbol><ci id="alg1.l0.m3.1.1.2.2.cmml" xref="alg1.l0.m3.1.1.2.2">𝒫</ci><ci id="alg1.l0.m3.1.1.2.3.cmml" xref="alg1.l0.m3.1.1.2.3">𝐻</ci></apply><ci id="alg1.l0.m3.1.1.3.cmml" xref="alg1.l0.m3.1.1.3">𝒫</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l0.m3.1c">\mathcal{P}_{H}\subset\mathcal{P}</annotation></semantics></math>, codistillation period <math id="alg1.l0.m4.1" class="ltx_Math" alttext="p" display="inline"><semantics id="alg1.l0.m4.1a"><mi id="alg1.l0.m4.1.1" xref="alg1.l0.m4.1.1.cmml">p</mi><annotation-xml encoding="MathML-Content" id="alg1.l0.m4.1b"><ci id="alg1.l0.m4.1.1.cmml" xref="alg1.l0.m4.1.1">𝑝</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.l0.m4.1c">p</annotation></semantics></math>, codistillation steps <math id="alg1.l0.m5.1" class="ltx_Math" alttext="s" display="inline"><semantics id="alg1.l0.m5.1a"><mi id="alg1.l0.m5.1.1" xref="alg1.l0.m5.1.1.cmml">s</mi><annotation-xml encoding="MathML-Content" id="alg1.l0.m5.1b"><ci id="alg1.l0.m5.1.1.cmml" xref="alg1.l0.m5.1.1">𝑠</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.l0.m5.1c">s</annotation></semantics></math>


</div>
<div id="alg1.l1" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg1.l1.1.1.1" class="ltx_text" style="font-size:80%;">1:</span></span>  Initialize parameters <math id="alg1.l1.m1.1" class="ltx_Math" alttext="\theta_{L}^{0}" display="inline"><semantics id="alg1.l1.m1.1a"><msubsup id="alg1.l1.m1.1.1" xref="alg1.l1.m1.1.1.cmml"><mi id="alg1.l1.m1.1.1.2.2" xref="alg1.l1.m1.1.1.2.2.cmml">θ</mi><mi id="alg1.l1.m1.1.1.2.3" xref="alg1.l1.m1.1.1.2.3.cmml">L</mi><mn id="alg1.l1.m1.1.1.3" xref="alg1.l1.m1.1.1.3.cmml">0</mn></msubsup><annotation-xml encoding="MathML-Content" id="alg1.l1.m1.1b"><apply id="alg1.l1.m1.1.1.cmml" xref="alg1.l1.m1.1.1"><csymbol cd="ambiguous" id="alg1.l1.m1.1.1.1.cmml" xref="alg1.l1.m1.1.1">superscript</csymbol><apply id="alg1.l1.m1.1.1.2.cmml" xref="alg1.l1.m1.1.1"><csymbol cd="ambiguous" id="alg1.l1.m1.1.1.2.1.cmml" xref="alg1.l1.m1.1.1">subscript</csymbol><ci id="alg1.l1.m1.1.1.2.2.cmml" xref="alg1.l1.m1.1.1.2.2">𝜃</ci><ci id="alg1.l1.m1.1.1.2.3.cmml" xref="alg1.l1.m1.1.1.2.3">𝐿</ci></apply><cn type="integer" id="alg1.l1.m1.1.1.3.cmml" xref="alg1.l1.m1.1.1.3">0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l1.m1.1c">\theta_{L}^{0}</annotation></semantics></math> and <math id="alg1.l1.m2.1" class="ltx_Math" alttext="\theta_{H}^{0}" display="inline"><semantics id="alg1.l1.m2.1a"><msubsup id="alg1.l1.m2.1.1" xref="alg1.l1.m2.1.1.cmml"><mi id="alg1.l1.m2.1.1.2.2" xref="alg1.l1.m2.1.1.2.2.cmml">θ</mi><mi id="alg1.l1.m2.1.1.2.3" xref="alg1.l1.m2.1.1.2.3.cmml">H</mi><mn id="alg1.l1.m2.1.1.3" xref="alg1.l1.m2.1.1.3.cmml">0</mn></msubsup><annotation-xml encoding="MathML-Content" id="alg1.l1.m2.1b"><apply id="alg1.l1.m2.1.1.cmml" xref="alg1.l1.m2.1.1"><csymbol cd="ambiguous" id="alg1.l1.m2.1.1.1.cmml" xref="alg1.l1.m2.1.1">superscript</csymbol><apply id="alg1.l1.m2.1.1.2.cmml" xref="alg1.l1.m2.1.1"><csymbol cd="ambiguous" id="alg1.l1.m2.1.1.2.1.cmml" xref="alg1.l1.m2.1.1">subscript</csymbol><ci id="alg1.l1.m2.1.1.2.2.cmml" xref="alg1.l1.m2.1.1.2.2">𝜃</ci><ci id="alg1.l1.m2.1.1.2.3.cmml" xref="alg1.l1.m2.1.1.2.3">𝐻</ci></apply><cn type="integer" id="alg1.l1.m2.1.1.3.cmml" xref="alg1.l1.m2.1.1.3">0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l1.m2.1c">\theta_{H}^{0}</annotation></semantics></math>

</div>
<div id="alg1.l2" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg1.l2.1.1.1" class="ltx_text" style="font-size:80%;">2:</span></span>  <span id="alg1.l2.2" class="ltx_text ltx_font_bold">for</span> <math id="alg1.l2.m1.1" class="ltx_Math" alttext="t=1" display="inline"><semantics id="alg1.l2.m1.1a"><mrow id="alg1.l2.m1.1.1" xref="alg1.l2.m1.1.1.cmml"><mi id="alg1.l2.m1.1.1.2" xref="alg1.l2.m1.1.1.2.cmml">t</mi><mo id="alg1.l2.m1.1.1.1" xref="alg1.l2.m1.1.1.1.cmml">=</mo><mn id="alg1.l2.m1.1.1.3" xref="alg1.l2.m1.1.1.3.cmml">1</mn></mrow><annotation-xml encoding="MathML-Content" id="alg1.l2.m1.1b"><apply id="alg1.l2.m1.1.1.cmml" xref="alg1.l2.m1.1.1"><eq id="alg1.l2.m1.1.1.1.cmml" xref="alg1.l2.m1.1.1.1"></eq><ci id="alg1.l2.m1.1.1.2.cmml" xref="alg1.l2.m1.1.1.2">𝑡</ci><cn type="integer" id="alg1.l2.m1.1.1.3.cmml" xref="alg1.l2.m1.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l2.m1.1c">t=1</annotation></semantics></math> <span id="alg1.l2.3" class="ltx_text ltx_font_bold">to</span> <math id="alg1.l2.m2.1" class="ltx_Math" alttext="T" display="inline"><semantics id="alg1.l2.m2.1a"><mi id="alg1.l2.m2.1.1" xref="alg1.l2.m2.1.1.cmml">T</mi><annotation-xml encoding="MathML-Content" id="alg1.l2.m2.1b"><ci id="alg1.l2.m2.1.1.cmml" xref="alg1.l2.m2.1.1">𝑇</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.l2.m2.1c">T</annotation></semantics></math> <span id="alg1.l2.4" class="ltx_text ltx_font_bold">do</span>



</div>
<div id="alg1.l3" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg1.l3.1.1.1" class="ltx_text" style="font-size:80%;">3:</span></span>     Apply <span id="alg1.l3.2" class="ltx_text ltx_font_smallcaps">FedAvg</span> on <math id="alg1.l3.m1.1" class="ltx_Math" alttext="\theta_{L}^{t}" display="inline"><semantics id="alg1.l3.m1.1a"><msubsup id="alg1.l3.m1.1.1" xref="alg1.l3.m1.1.1.cmml"><mi id="alg1.l3.m1.1.1.2.2" xref="alg1.l3.m1.1.1.2.2.cmml">θ</mi><mi id="alg1.l3.m1.1.1.2.3" xref="alg1.l3.m1.1.1.2.3.cmml">L</mi><mi id="alg1.l3.m1.1.1.3" xref="alg1.l3.m1.1.1.3.cmml">t</mi></msubsup><annotation-xml encoding="MathML-Content" id="alg1.l3.m1.1b"><apply id="alg1.l3.m1.1.1.cmml" xref="alg1.l3.m1.1.1"><csymbol cd="ambiguous" id="alg1.l3.m1.1.1.1.cmml" xref="alg1.l3.m1.1.1">superscript</csymbol><apply id="alg1.l3.m1.1.1.2.cmml" xref="alg1.l3.m1.1.1"><csymbol cd="ambiguous" id="alg1.l3.m1.1.1.2.1.cmml" xref="alg1.l3.m1.1.1">subscript</csymbol><ci id="alg1.l3.m1.1.1.2.2.cmml" xref="alg1.l3.m1.1.1.2.2">𝜃</ci><ci id="alg1.l3.m1.1.1.2.3.cmml" xref="alg1.l3.m1.1.1.2.3">𝐿</ci></apply><ci id="alg1.l3.m1.1.1.3.cmml" xref="alg1.l3.m1.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l3.m1.1c">\theta_{L}^{t}</annotation></semantics></math> and <math id="alg1.l3.m2.1" class="ltx_Math" alttext="\theta_{H}^{t}" display="inline"><semantics id="alg1.l3.m2.1a"><msubsup id="alg1.l3.m2.1.1" xref="alg1.l3.m2.1.1.cmml"><mi id="alg1.l3.m2.1.1.2.2" xref="alg1.l3.m2.1.1.2.2.cmml">θ</mi><mi id="alg1.l3.m2.1.1.2.3" xref="alg1.l3.m2.1.1.2.3.cmml">H</mi><mi id="alg1.l3.m2.1.1.3" xref="alg1.l3.m2.1.1.3.cmml">t</mi></msubsup><annotation-xml encoding="MathML-Content" id="alg1.l3.m2.1b"><apply id="alg1.l3.m2.1.1.cmml" xref="alg1.l3.m2.1.1"><csymbol cd="ambiguous" id="alg1.l3.m2.1.1.1.cmml" xref="alg1.l3.m2.1.1">superscript</csymbol><apply id="alg1.l3.m2.1.1.2.cmml" xref="alg1.l3.m2.1.1"><csymbol cd="ambiguous" id="alg1.l3.m2.1.1.2.1.cmml" xref="alg1.l3.m2.1.1">subscript</csymbol><ci id="alg1.l3.m2.1.1.2.2.cmml" xref="alg1.l3.m2.1.1.2.2">𝜃</ci><ci id="alg1.l3.m2.1.1.2.3.cmml" xref="alg1.l3.m2.1.1.2.3">𝐻</ci></apply><ci id="alg1.l3.m2.1.1.3.cmml" xref="alg1.l3.m2.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l3.m2.1c">\theta_{H}^{t}</annotation></semantics></math> by sampling clients from <math id="alg1.l3.m3.1" class="ltx_Math" alttext="\mathcal{P}" display="inline"><semantics id="alg1.l3.m3.1a"><mi class="ltx_font_mathcaligraphic" id="alg1.l3.m3.1.1" xref="alg1.l3.m3.1.1.cmml">𝒫</mi><annotation-xml encoding="MathML-Content" id="alg1.l3.m3.1b"><ci id="alg1.l3.m3.1.1.cmml" xref="alg1.l3.m3.1.1">𝒫</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.l3.m3.1c">\mathcal{P}</annotation></semantics></math> and <math id="alg1.l3.m4.1" class="ltx_Math" alttext="\mathcal{P}_{H}" display="inline"><semantics id="alg1.l3.m4.1a"><msub id="alg1.l3.m4.1.1" xref="alg1.l3.m4.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="alg1.l3.m4.1.1.2" xref="alg1.l3.m4.1.1.2.cmml">𝒫</mi><mi id="alg1.l3.m4.1.1.3" xref="alg1.l3.m4.1.1.3.cmml">H</mi></msub><annotation-xml encoding="MathML-Content" id="alg1.l3.m4.1b"><apply id="alg1.l3.m4.1.1.cmml" xref="alg1.l3.m4.1.1"><csymbol cd="ambiguous" id="alg1.l3.m4.1.1.1.cmml" xref="alg1.l3.m4.1.1">subscript</csymbol><ci id="alg1.l3.m4.1.1.2.cmml" xref="alg1.l3.m4.1.1.2">𝒫</ci><ci id="alg1.l3.m4.1.1.3.cmml" xref="alg1.l3.m4.1.1.3">𝐻</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l3.m4.1c">\mathcal{P}_{H}</annotation></semantics></math>, respectively

</div>
<div id="alg1.l4" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg1.l4.1.1.1" class="ltx_text" style="font-size:80%;">4:</span></span>     <span id="alg1.l4.2" class="ltx_text ltx_font_bold">if</span> <math id="alg1.l4.m1.1" class="ltx_math_unparsed" alttext="t\,\%\,p==0" display="inline"><semantics id="alg1.l4.m1.1a"><mrow id="alg1.l4.m1.1b"><mi id="alg1.l4.m1.1.1">t</mi><mo lspace="0.170em" rspace="0.170em" id="alg1.l4.m1.1.2">%</mo><mi id="alg1.l4.m1.1.3">p</mi><mo rspace="0em" id="alg1.l4.m1.1.4">=</mo><mo lspace="0em" id="alg1.l4.m1.1.5">=</mo><mn id="alg1.l4.m1.1.6">0</mn></mrow><annotation encoding="application/x-tex" id="alg1.l4.m1.1c">t\,\%\,p==0</annotation></semantics></math> <span id="alg1.l4.3" class="ltx_text ltx_font_bold">then</span>



</div>
<div id="alg1.l5" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg1.l5.1.1.1" class="ltx_text" style="font-size:80%;">5:</span></span>        Create <span id="alg1.l5.2" class="ltx_text ltx_font_bold">teachers</span> <math id="alg1.l5.m1.1" class="ltx_Math" alttext="\theta_{L}^{\text{\tiny teacher}}\leftarrow\theta_{L}^{t}" display="inline"><semantics id="alg1.l5.m1.1a"><mrow id="alg1.l5.m1.1.1" xref="alg1.l5.m1.1.1.cmml"><msubsup id="alg1.l5.m1.1.1.2" xref="alg1.l5.m1.1.1.2.cmml"><mi id="alg1.l5.m1.1.1.2.2.2" xref="alg1.l5.m1.1.1.2.2.2.cmml">θ</mi><mi id="alg1.l5.m1.1.1.2.2.3" xref="alg1.l5.m1.1.1.2.2.3.cmml">L</mi><mtext mathsize="71%" id="alg1.l5.m1.1.1.2.3" xref="alg1.l5.m1.1.1.2.3a.cmml">teacher</mtext></msubsup><mo stretchy="false" id="alg1.l5.m1.1.1.1" xref="alg1.l5.m1.1.1.1.cmml">←</mo><msubsup id="alg1.l5.m1.1.1.3" xref="alg1.l5.m1.1.1.3.cmml"><mi id="alg1.l5.m1.1.1.3.2.2" xref="alg1.l5.m1.1.1.3.2.2.cmml">θ</mi><mi id="alg1.l5.m1.1.1.3.2.3" xref="alg1.l5.m1.1.1.3.2.3.cmml">L</mi><mi id="alg1.l5.m1.1.1.3.3" xref="alg1.l5.m1.1.1.3.3.cmml">t</mi></msubsup></mrow><annotation-xml encoding="MathML-Content" id="alg1.l5.m1.1b"><apply id="alg1.l5.m1.1.1.cmml" xref="alg1.l5.m1.1.1"><ci id="alg1.l5.m1.1.1.1.cmml" xref="alg1.l5.m1.1.1.1">←</ci><apply id="alg1.l5.m1.1.1.2.cmml" xref="alg1.l5.m1.1.1.2"><csymbol cd="ambiguous" id="alg1.l5.m1.1.1.2.1.cmml" xref="alg1.l5.m1.1.1.2">superscript</csymbol><apply id="alg1.l5.m1.1.1.2.2.cmml" xref="alg1.l5.m1.1.1.2"><csymbol cd="ambiguous" id="alg1.l5.m1.1.1.2.2.1.cmml" xref="alg1.l5.m1.1.1.2">subscript</csymbol><ci id="alg1.l5.m1.1.1.2.2.2.cmml" xref="alg1.l5.m1.1.1.2.2.2">𝜃</ci><ci id="alg1.l5.m1.1.1.2.2.3.cmml" xref="alg1.l5.m1.1.1.2.2.3">𝐿</ci></apply><ci id="alg1.l5.m1.1.1.2.3a.cmml" xref="alg1.l5.m1.1.1.2.3"><mtext mathsize="50%" id="alg1.l5.m1.1.1.2.3.cmml" xref="alg1.l5.m1.1.1.2.3">teacher</mtext></ci></apply><apply id="alg1.l5.m1.1.1.3.cmml" xref="alg1.l5.m1.1.1.3"><csymbol cd="ambiguous" id="alg1.l5.m1.1.1.3.1.cmml" xref="alg1.l5.m1.1.1.3">superscript</csymbol><apply id="alg1.l5.m1.1.1.3.2.cmml" xref="alg1.l5.m1.1.1.3"><csymbol cd="ambiguous" id="alg1.l5.m1.1.1.3.2.1.cmml" xref="alg1.l5.m1.1.1.3">subscript</csymbol><ci id="alg1.l5.m1.1.1.3.2.2.cmml" xref="alg1.l5.m1.1.1.3.2.2">𝜃</ci><ci id="alg1.l5.m1.1.1.3.2.3.cmml" xref="alg1.l5.m1.1.1.3.2.3">𝐿</ci></apply><ci id="alg1.l5.m1.1.1.3.3.cmml" xref="alg1.l5.m1.1.1.3.3">𝑡</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l5.m1.1c">\theta_{L}^{\text{\tiny teacher}}\leftarrow\theta_{L}^{t}</annotation></semantics></math> and <math id="alg1.l5.m2.1" class="ltx_Math" alttext="\theta_{H}^{\text{\tiny teacher}}\leftarrow\theta_{H}^{t}" display="inline"><semantics id="alg1.l5.m2.1a"><mrow id="alg1.l5.m2.1.1" xref="alg1.l5.m2.1.1.cmml"><msubsup id="alg1.l5.m2.1.1.2" xref="alg1.l5.m2.1.1.2.cmml"><mi id="alg1.l5.m2.1.1.2.2.2" xref="alg1.l5.m2.1.1.2.2.2.cmml">θ</mi><mi id="alg1.l5.m2.1.1.2.2.3" xref="alg1.l5.m2.1.1.2.2.3.cmml">H</mi><mtext mathsize="71%" id="alg1.l5.m2.1.1.2.3" xref="alg1.l5.m2.1.1.2.3a.cmml">teacher</mtext></msubsup><mo stretchy="false" id="alg1.l5.m2.1.1.1" xref="alg1.l5.m2.1.1.1.cmml">←</mo><msubsup id="alg1.l5.m2.1.1.3" xref="alg1.l5.m2.1.1.3.cmml"><mi id="alg1.l5.m2.1.1.3.2.2" xref="alg1.l5.m2.1.1.3.2.2.cmml">θ</mi><mi id="alg1.l5.m2.1.1.3.2.3" xref="alg1.l5.m2.1.1.3.2.3.cmml">H</mi><mi id="alg1.l5.m2.1.1.3.3" xref="alg1.l5.m2.1.1.3.3.cmml">t</mi></msubsup></mrow><annotation-xml encoding="MathML-Content" id="alg1.l5.m2.1b"><apply id="alg1.l5.m2.1.1.cmml" xref="alg1.l5.m2.1.1"><ci id="alg1.l5.m2.1.1.1.cmml" xref="alg1.l5.m2.1.1.1">←</ci><apply id="alg1.l5.m2.1.1.2.cmml" xref="alg1.l5.m2.1.1.2"><csymbol cd="ambiguous" id="alg1.l5.m2.1.1.2.1.cmml" xref="alg1.l5.m2.1.1.2">superscript</csymbol><apply id="alg1.l5.m2.1.1.2.2.cmml" xref="alg1.l5.m2.1.1.2"><csymbol cd="ambiguous" id="alg1.l5.m2.1.1.2.2.1.cmml" xref="alg1.l5.m2.1.1.2">subscript</csymbol><ci id="alg1.l5.m2.1.1.2.2.2.cmml" xref="alg1.l5.m2.1.1.2.2.2">𝜃</ci><ci id="alg1.l5.m2.1.1.2.2.3.cmml" xref="alg1.l5.m2.1.1.2.2.3">𝐻</ci></apply><ci id="alg1.l5.m2.1.1.2.3a.cmml" xref="alg1.l5.m2.1.1.2.3"><mtext mathsize="50%" id="alg1.l5.m2.1.1.2.3.cmml" xref="alg1.l5.m2.1.1.2.3">teacher</mtext></ci></apply><apply id="alg1.l5.m2.1.1.3.cmml" xref="alg1.l5.m2.1.1.3"><csymbol cd="ambiguous" id="alg1.l5.m2.1.1.3.1.cmml" xref="alg1.l5.m2.1.1.3">superscript</csymbol><apply id="alg1.l5.m2.1.1.3.2.cmml" xref="alg1.l5.m2.1.1.3"><csymbol cd="ambiguous" id="alg1.l5.m2.1.1.3.2.1.cmml" xref="alg1.l5.m2.1.1.3">subscript</csymbol><ci id="alg1.l5.m2.1.1.3.2.2.cmml" xref="alg1.l5.m2.1.1.3.2.2">𝜃</ci><ci id="alg1.l5.m2.1.1.3.2.3.cmml" xref="alg1.l5.m2.1.1.3.2.3">𝐻</ci></apply><ci id="alg1.l5.m2.1.1.3.3.cmml" xref="alg1.l5.m2.1.1.3.3">𝑡</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l5.m2.1c">\theta_{H}^{\text{\tiny teacher}}\leftarrow\theta_{H}^{t}</annotation></semantics></math>

</div>
<div id="alg1.l6" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg1.l6.1.1.1" class="ltx_text" style="font-size:80%;">6:</span></span>        Initialize <span id="alg1.l6.2" class="ltx_text ltx_font_bold">students</span> <math id="alg1.l6.m1.2" class="ltx_Math" alttext="\theta_{L}^{\text{\tiny student}}\leftarrow\theta_{L}^{t},\,\theta_{H}^{\text{\tiny student}}\leftarrow\theta_{H}^{t}" display="inline"><semantics id="alg1.l6.m1.2a"><mrow id="alg1.l6.m1.2.2.2" xref="alg1.l6.m1.2.2.3.cmml"><mrow id="alg1.l6.m1.1.1.1.1" xref="alg1.l6.m1.1.1.1.1.cmml"><msubsup id="alg1.l6.m1.1.1.1.1.2" xref="alg1.l6.m1.1.1.1.1.2.cmml"><mi id="alg1.l6.m1.1.1.1.1.2.2.2" xref="alg1.l6.m1.1.1.1.1.2.2.2.cmml">θ</mi><mi id="alg1.l6.m1.1.1.1.1.2.2.3" xref="alg1.l6.m1.1.1.1.1.2.2.3.cmml">L</mi><mtext mathsize="71%" id="alg1.l6.m1.1.1.1.1.2.3" xref="alg1.l6.m1.1.1.1.1.2.3a.cmml">student</mtext></msubsup><mo stretchy="false" id="alg1.l6.m1.1.1.1.1.1" xref="alg1.l6.m1.1.1.1.1.1.cmml">←</mo><msubsup id="alg1.l6.m1.1.1.1.1.3" xref="alg1.l6.m1.1.1.1.1.3.cmml"><mi id="alg1.l6.m1.1.1.1.1.3.2.2" xref="alg1.l6.m1.1.1.1.1.3.2.2.cmml">θ</mi><mi id="alg1.l6.m1.1.1.1.1.3.2.3" xref="alg1.l6.m1.1.1.1.1.3.2.3.cmml">L</mi><mi id="alg1.l6.m1.1.1.1.1.3.3" xref="alg1.l6.m1.1.1.1.1.3.3.cmml">t</mi></msubsup></mrow><mo rspace="0.337em" id="alg1.l6.m1.2.2.2.3" xref="alg1.l6.m1.2.2.3a.cmml">,</mo><mrow id="alg1.l6.m1.2.2.2.2" xref="alg1.l6.m1.2.2.2.2.cmml"><msubsup id="alg1.l6.m1.2.2.2.2.2" xref="alg1.l6.m1.2.2.2.2.2.cmml"><mi id="alg1.l6.m1.2.2.2.2.2.2.2" xref="alg1.l6.m1.2.2.2.2.2.2.2.cmml">θ</mi><mi id="alg1.l6.m1.2.2.2.2.2.2.3" xref="alg1.l6.m1.2.2.2.2.2.2.3.cmml">H</mi><mtext mathsize="71%" id="alg1.l6.m1.2.2.2.2.2.3" xref="alg1.l6.m1.2.2.2.2.2.3a.cmml">student</mtext></msubsup><mo stretchy="false" id="alg1.l6.m1.2.2.2.2.1" xref="alg1.l6.m1.2.2.2.2.1.cmml">←</mo><msubsup id="alg1.l6.m1.2.2.2.2.3" xref="alg1.l6.m1.2.2.2.2.3.cmml"><mi id="alg1.l6.m1.2.2.2.2.3.2.2" xref="alg1.l6.m1.2.2.2.2.3.2.2.cmml">θ</mi><mi id="alg1.l6.m1.2.2.2.2.3.2.3" xref="alg1.l6.m1.2.2.2.2.3.2.3.cmml">H</mi><mi id="alg1.l6.m1.2.2.2.2.3.3" xref="alg1.l6.m1.2.2.2.2.3.3.cmml">t</mi></msubsup></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l6.m1.2b"><apply id="alg1.l6.m1.2.2.3.cmml" xref="alg1.l6.m1.2.2.2"><csymbol cd="ambiguous" id="alg1.l6.m1.2.2.3a.cmml" xref="alg1.l6.m1.2.2.2.3">formulae-sequence</csymbol><apply id="alg1.l6.m1.1.1.1.1.cmml" xref="alg1.l6.m1.1.1.1.1"><ci id="alg1.l6.m1.1.1.1.1.1.cmml" xref="alg1.l6.m1.1.1.1.1.1">←</ci><apply id="alg1.l6.m1.1.1.1.1.2.cmml" xref="alg1.l6.m1.1.1.1.1.2"><csymbol cd="ambiguous" id="alg1.l6.m1.1.1.1.1.2.1.cmml" xref="alg1.l6.m1.1.1.1.1.2">superscript</csymbol><apply id="alg1.l6.m1.1.1.1.1.2.2.cmml" xref="alg1.l6.m1.1.1.1.1.2"><csymbol cd="ambiguous" id="alg1.l6.m1.1.1.1.1.2.2.1.cmml" xref="alg1.l6.m1.1.1.1.1.2">subscript</csymbol><ci id="alg1.l6.m1.1.1.1.1.2.2.2.cmml" xref="alg1.l6.m1.1.1.1.1.2.2.2">𝜃</ci><ci id="alg1.l6.m1.1.1.1.1.2.2.3.cmml" xref="alg1.l6.m1.1.1.1.1.2.2.3">𝐿</ci></apply><ci id="alg1.l6.m1.1.1.1.1.2.3a.cmml" xref="alg1.l6.m1.1.1.1.1.2.3"><mtext mathsize="50%" id="alg1.l6.m1.1.1.1.1.2.3.cmml" xref="alg1.l6.m1.1.1.1.1.2.3">student</mtext></ci></apply><apply id="alg1.l6.m1.1.1.1.1.3.cmml" xref="alg1.l6.m1.1.1.1.1.3"><csymbol cd="ambiguous" id="alg1.l6.m1.1.1.1.1.3.1.cmml" xref="alg1.l6.m1.1.1.1.1.3">superscript</csymbol><apply id="alg1.l6.m1.1.1.1.1.3.2.cmml" xref="alg1.l6.m1.1.1.1.1.3"><csymbol cd="ambiguous" id="alg1.l6.m1.1.1.1.1.3.2.1.cmml" xref="alg1.l6.m1.1.1.1.1.3">subscript</csymbol><ci id="alg1.l6.m1.1.1.1.1.3.2.2.cmml" xref="alg1.l6.m1.1.1.1.1.3.2.2">𝜃</ci><ci id="alg1.l6.m1.1.1.1.1.3.2.3.cmml" xref="alg1.l6.m1.1.1.1.1.3.2.3">𝐿</ci></apply><ci id="alg1.l6.m1.1.1.1.1.3.3.cmml" xref="alg1.l6.m1.1.1.1.1.3.3">𝑡</ci></apply></apply><apply id="alg1.l6.m1.2.2.2.2.cmml" xref="alg1.l6.m1.2.2.2.2"><ci id="alg1.l6.m1.2.2.2.2.1.cmml" xref="alg1.l6.m1.2.2.2.2.1">←</ci><apply id="alg1.l6.m1.2.2.2.2.2.cmml" xref="alg1.l6.m1.2.2.2.2.2"><csymbol cd="ambiguous" id="alg1.l6.m1.2.2.2.2.2.1.cmml" xref="alg1.l6.m1.2.2.2.2.2">superscript</csymbol><apply id="alg1.l6.m1.2.2.2.2.2.2.cmml" xref="alg1.l6.m1.2.2.2.2.2"><csymbol cd="ambiguous" id="alg1.l6.m1.2.2.2.2.2.2.1.cmml" xref="alg1.l6.m1.2.2.2.2.2">subscript</csymbol><ci id="alg1.l6.m1.2.2.2.2.2.2.2.cmml" xref="alg1.l6.m1.2.2.2.2.2.2.2">𝜃</ci><ci id="alg1.l6.m1.2.2.2.2.2.2.3.cmml" xref="alg1.l6.m1.2.2.2.2.2.2.3">𝐻</ci></apply><ci id="alg1.l6.m1.2.2.2.2.2.3a.cmml" xref="alg1.l6.m1.2.2.2.2.2.3"><mtext mathsize="50%" id="alg1.l6.m1.2.2.2.2.2.3.cmml" xref="alg1.l6.m1.2.2.2.2.2.3">student</mtext></ci></apply><apply id="alg1.l6.m1.2.2.2.2.3.cmml" xref="alg1.l6.m1.2.2.2.2.3"><csymbol cd="ambiguous" id="alg1.l6.m1.2.2.2.2.3.1.cmml" xref="alg1.l6.m1.2.2.2.2.3">superscript</csymbol><apply id="alg1.l6.m1.2.2.2.2.3.2.cmml" xref="alg1.l6.m1.2.2.2.2.3"><csymbol cd="ambiguous" id="alg1.l6.m1.2.2.2.2.3.2.1.cmml" xref="alg1.l6.m1.2.2.2.2.3">subscript</csymbol><ci id="alg1.l6.m1.2.2.2.2.3.2.2.cmml" xref="alg1.l6.m1.2.2.2.2.3.2.2">𝜃</ci><ci id="alg1.l6.m1.2.2.2.2.3.2.3.cmml" xref="alg1.l6.m1.2.2.2.2.3.2.3">𝐻</ci></apply><ci id="alg1.l6.m1.2.2.2.2.3.3.cmml" xref="alg1.l6.m1.2.2.2.2.3.3">𝑡</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l6.m1.2c">\theta_{L}^{\text{\tiny student}}\leftarrow\theta_{L}^{t},\,\theta_{H}^{\text{\tiny student}}\leftarrow\theta_{H}^{t}</annotation></semantics></math>

</div>
<div id="alg1.l7" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg1.l7.1.1.1" class="ltx_text" style="font-size:80%;">7:</span></span>        <span id="alg1.l7.2" class="ltx_text ltx_font_bold">In parallel</span>, distill to <math id="alg1.l7.m1.1" class="ltx_Math" alttext="\theta^{\text{\tiny student}}_{i}" display="inline"><semantics id="alg1.l7.m1.1a"><msubsup id="alg1.l7.m1.1.1" xref="alg1.l7.m1.1.1.cmml"><mi id="alg1.l7.m1.1.1.2.2" xref="alg1.l7.m1.1.1.2.2.cmml">θ</mi><mi id="alg1.l7.m1.1.1.3" xref="alg1.l7.m1.1.1.3.cmml">i</mi><mtext mathsize="71%" id="alg1.l7.m1.1.1.2.3" xref="alg1.l7.m1.1.1.2.3a.cmml">student</mtext></msubsup><annotation-xml encoding="MathML-Content" id="alg1.l7.m1.1b"><apply id="alg1.l7.m1.1.1.cmml" xref="alg1.l7.m1.1.1"><csymbol cd="ambiguous" id="alg1.l7.m1.1.1.1.cmml" xref="alg1.l7.m1.1.1">subscript</csymbol><apply id="alg1.l7.m1.1.1.2.cmml" xref="alg1.l7.m1.1.1"><csymbol cd="ambiguous" id="alg1.l7.m1.1.1.2.1.cmml" xref="alg1.l7.m1.1.1">superscript</csymbol><ci id="alg1.l7.m1.1.1.2.2.cmml" xref="alg1.l7.m1.1.1.2.2">𝜃</ci><ci id="alg1.l7.m1.1.1.2.3a.cmml" xref="alg1.l7.m1.1.1.2.3"><mtext mathsize="50%" id="alg1.l7.m1.1.1.2.3.cmml" xref="alg1.l7.m1.1.1.2.3">student</mtext></ci></apply><ci id="alg1.l7.m1.1.1.3.cmml" xref="alg1.l7.m1.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l7.m1.1c">\theta^{\text{\tiny student}}_{i}</annotation></semantics></math> for <math id="alg1.l7.m2.1" class="ltx_Math" alttext="s" display="inline"><semantics id="alg1.l7.m2.1a"><mi id="alg1.l7.m2.1.1" xref="alg1.l7.m2.1.1.cmml">s</mi><annotation-xml encoding="MathML-Content" id="alg1.l7.m2.1b"><ci id="alg1.l7.m2.1.1.cmml" xref="alg1.l7.m2.1.1">𝑠</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.l7.m2.1c">s</annotation></semantics></math> steps using <math id="alg1.l7.m3.3" class="ltx_Math" alttext="\theta^{\text{\tiny teacher}}_{\{L,H\}-\{i\}}" display="inline"><semantics id="alg1.l7.m3.3a"><msubsup id="alg1.l7.m3.3.4" xref="alg1.l7.m3.3.4.cmml"><mi id="alg1.l7.m3.3.4.2.2" xref="alg1.l7.m3.3.4.2.2.cmml">θ</mi><mrow id="alg1.l7.m3.3.3.3" xref="alg1.l7.m3.3.3.3.cmml"><mrow id="alg1.l7.m3.3.3.3.5.2" xref="alg1.l7.m3.3.3.3.5.1.cmml"><mo stretchy="false" id="alg1.l7.m3.3.3.3.5.2.1" xref="alg1.l7.m3.3.3.3.5.1.cmml">{</mo><mi id="alg1.l7.m3.1.1.1.1" xref="alg1.l7.m3.1.1.1.1.cmml">L</mi><mo id="alg1.l7.m3.3.3.3.5.2.2" xref="alg1.l7.m3.3.3.3.5.1.cmml">,</mo><mi id="alg1.l7.m3.2.2.2.2" xref="alg1.l7.m3.2.2.2.2.cmml">H</mi><mo stretchy="false" id="alg1.l7.m3.3.3.3.5.2.3" xref="alg1.l7.m3.3.3.3.5.1.cmml">}</mo></mrow><mo id="alg1.l7.m3.3.3.3.4" xref="alg1.l7.m3.3.3.3.4.cmml">−</mo><mrow id="alg1.l7.m3.3.3.3.6.2" xref="alg1.l7.m3.3.3.3.6.1.cmml"><mo stretchy="false" id="alg1.l7.m3.3.3.3.6.2.1" xref="alg1.l7.m3.3.3.3.6.1.cmml">{</mo><mi id="alg1.l7.m3.3.3.3.3" xref="alg1.l7.m3.3.3.3.3.cmml">i</mi><mo stretchy="false" id="alg1.l7.m3.3.3.3.6.2.2" xref="alg1.l7.m3.3.3.3.6.1.cmml">}</mo></mrow></mrow><mtext mathsize="71%" id="alg1.l7.m3.3.4.2.3" xref="alg1.l7.m3.3.4.2.3a.cmml">teacher</mtext></msubsup><annotation-xml encoding="MathML-Content" id="alg1.l7.m3.3b"><apply id="alg1.l7.m3.3.4.cmml" xref="alg1.l7.m3.3.4"><csymbol cd="ambiguous" id="alg1.l7.m3.3.4.1.cmml" xref="alg1.l7.m3.3.4">subscript</csymbol><apply id="alg1.l7.m3.3.4.2.cmml" xref="alg1.l7.m3.3.4"><csymbol cd="ambiguous" id="alg1.l7.m3.3.4.2.1.cmml" xref="alg1.l7.m3.3.4">superscript</csymbol><ci id="alg1.l7.m3.3.4.2.2.cmml" xref="alg1.l7.m3.3.4.2.2">𝜃</ci><ci id="alg1.l7.m3.3.4.2.3a.cmml" xref="alg1.l7.m3.3.4.2.3"><mtext mathsize="50%" id="alg1.l7.m3.3.4.2.3.cmml" xref="alg1.l7.m3.3.4.2.3">teacher</mtext></ci></apply><apply id="alg1.l7.m3.3.3.3.cmml" xref="alg1.l7.m3.3.3.3"><minus id="alg1.l7.m3.3.3.3.4.cmml" xref="alg1.l7.m3.3.3.3.4"></minus><set id="alg1.l7.m3.3.3.3.5.1.cmml" xref="alg1.l7.m3.3.3.3.5.2"><ci id="alg1.l7.m3.1.1.1.1.cmml" xref="alg1.l7.m3.1.1.1.1">𝐿</ci><ci id="alg1.l7.m3.2.2.2.2.cmml" xref="alg1.l7.m3.2.2.2.2">𝐻</ci></set><set id="alg1.l7.m3.3.3.3.6.1.cmml" xref="alg1.l7.m3.3.3.3.6.2"><ci id="alg1.l7.m3.3.3.3.3.cmml" xref="alg1.l7.m3.3.3.3.3">𝑖</ci></set></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l7.m3.3c">\theta^{\text{\tiny teacher}}_{\{L,H\}-\{i\}}</annotation></semantics></math> as the teacher, where <math id="alg1.l7.m4.2" class="ltx_Math" alttext="i\in\{L,H\}" display="inline"><semantics id="alg1.l7.m4.2a"><mrow id="alg1.l7.m4.2.3" xref="alg1.l7.m4.2.3.cmml"><mi id="alg1.l7.m4.2.3.2" xref="alg1.l7.m4.2.3.2.cmml">i</mi><mo id="alg1.l7.m4.2.3.1" xref="alg1.l7.m4.2.3.1.cmml">∈</mo><mrow id="alg1.l7.m4.2.3.3.2" xref="alg1.l7.m4.2.3.3.1.cmml"><mo stretchy="false" id="alg1.l7.m4.2.3.3.2.1" xref="alg1.l7.m4.2.3.3.1.cmml">{</mo><mi id="alg1.l7.m4.1.1" xref="alg1.l7.m4.1.1.cmml">L</mi><mo id="alg1.l7.m4.2.3.3.2.2" xref="alg1.l7.m4.2.3.3.1.cmml">,</mo><mi id="alg1.l7.m4.2.2" xref="alg1.l7.m4.2.2.cmml">H</mi><mo stretchy="false" id="alg1.l7.m4.2.3.3.2.3" xref="alg1.l7.m4.2.3.3.1.cmml">}</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l7.m4.2b"><apply id="alg1.l7.m4.2.3.cmml" xref="alg1.l7.m4.2.3"><in id="alg1.l7.m4.2.3.1.cmml" xref="alg1.l7.m4.2.3.1"></in><ci id="alg1.l7.m4.2.3.2.cmml" xref="alg1.l7.m4.2.3.2">𝑖</ci><set id="alg1.l7.m4.2.3.3.1.cmml" xref="alg1.l7.m4.2.3.3.2"><ci id="alg1.l7.m4.1.1.cmml" xref="alg1.l7.m4.1.1">𝐿</ci><ci id="alg1.l7.m4.2.2.cmml" xref="alg1.l7.m4.2.2">𝐻</ci></set></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l7.m4.2c">i\in\{L,H\}</annotation></semantics></math>

</div>
<div id="alg1.l8" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg1.l8.1.1.1" class="ltx_text" style="font-size:80%;">8:</span></span>        Replace <math id="alg1.l8.m1.2" class="ltx_Math" alttext="\theta_{L}^{t}\leftarrow\theta_{L}^{\text{\tiny student}},\,\theta_{H}^{t}\leftarrow\theta_{H}^{\text{\tiny student}}" display="inline"><semantics id="alg1.l8.m1.2a"><mrow id="alg1.l8.m1.2.2.2" xref="alg1.l8.m1.2.2.3.cmml"><mrow id="alg1.l8.m1.1.1.1.1" xref="alg1.l8.m1.1.1.1.1.cmml"><msubsup id="alg1.l8.m1.1.1.1.1.2" xref="alg1.l8.m1.1.1.1.1.2.cmml"><mi id="alg1.l8.m1.1.1.1.1.2.2.2" xref="alg1.l8.m1.1.1.1.1.2.2.2.cmml">θ</mi><mi id="alg1.l8.m1.1.1.1.1.2.2.3" xref="alg1.l8.m1.1.1.1.1.2.2.3.cmml">L</mi><mi id="alg1.l8.m1.1.1.1.1.2.3" xref="alg1.l8.m1.1.1.1.1.2.3.cmml">t</mi></msubsup><mo stretchy="false" id="alg1.l8.m1.1.1.1.1.1" xref="alg1.l8.m1.1.1.1.1.1.cmml">←</mo><msubsup id="alg1.l8.m1.1.1.1.1.3" xref="alg1.l8.m1.1.1.1.1.3.cmml"><mi id="alg1.l8.m1.1.1.1.1.3.2.2" xref="alg1.l8.m1.1.1.1.1.3.2.2.cmml">θ</mi><mi id="alg1.l8.m1.1.1.1.1.3.2.3" xref="alg1.l8.m1.1.1.1.1.3.2.3.cmml">L</mi><mtext mathsize="71%" id="alg1.l8.m1.1.1.1.1.3.3" xref="alg1.l8.m1.1.1.1.1.3.3a.cmml">student</mtext></msubsup></mrow><mo rspace="0.337em" id="alg1.l8.m1.2.2.2.3" xref="alg1.l8.m1.2.2.3a.cmml">,</mo><mrow id="alg1.l8.m1.2.2.2.2" xref="alg1.l8.m1.2.2.2.2.cmml"><msubsup id="alg1.l8.m1.2.2.2.2.2" xref="alg1.l8.m1.2.2.2.2.2.cmml"><mi id="alg1.l8.m1.2.2.2.2.2.2.2" xref="alg1.l8.m1.2.2.2.2.2.2.2.cmml">θ</mi><mi id="alg1.l8.m1.2.2.2.2.2.2.3" xref="alg1.l8.m1.2.2.2.2.2.2.3.cmml">H</mi><mi id="alg1.l8.m1.2.2.2.2.2.3" xref="alg1.l8.m1.2.2.2.2.2.3.cmml">t</mi></msubsup><mo stretchy="false" id="alg1.l8.m1.2.2.2.2.1" xref="alg1.l8.m1.2.2.2.2.1.cmml">←</mo><msubsup id="alg1.l8.m1.2.2.2.2.3" xref="alg1.l8.m1.2.2.2.2.3.cmml"><mi id="alg1.l8.m1.2.2.2.2.3.2.2" xref="alg1.l8.m1.2.2.2.2.3.2.2.cmml">θ</mi><mi id="alg1.l8.m1.2.2.2.2.3.2.3" xref="alg1.l8.m1.2.2.2.2.3.2.3.cmml">H</mi><mtext mathsize="71%" id="alg1.l8.m1.2.2.2.2.3.3" xref="alg1.l8.m1.2.2.2.2.3.3a.cmml">student</mtext></msubsup></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l8.m1.2b"><apply id="alg1.l8.m1.2.2.3.cmml" xref="alg1.l8.m1.2.2.2"><csymbol cd="ambiguous" id="alg1.l8.m1.2.2.3a.cmml" xref="alg1.l8.m1.2.2.2.3">formulae-sequence</csymbol><apply id="alg1.l8.m1.1.1.1.1.cmml" xref="alg1.l8.m1.1.1.1.1"><ci id="alg1.l8.m1.1.1.1.1.1.cmml" xref="alg1.l8.m1.1.1.1.1.1">←</ci><apply id="alg1.l8.m1.1.1.1.1.2.cmml" xref="alg1.l8.m1.1.1.1.1.2"><csymbol cd="ambiguous" id="alg1.l8.m1.1.1.1.1.2.1.cmml" xref="alg1.l8.m1.1.1.1.1.2">superscript</csymbol><apply id="alg1.l8.m1.1.1.1.1.2.2.cmml" xref="alg1.l8.m1.1.1.1.1.2"><csymbol cd="ambiguous" id="alg1.l8.m1.1.1.1.1.2.2.1.cmml" xref="alg1.l8.m1.1.1.1.1.2">subscript</csymbol><ci id="alg1.l8.m1.1.1.1.1.2.2.2.cmml" xref="alg1.l8.m1.1.1.1.1.2.2.2">𝜃</ci><ci id="alg1.l8.m1.1.1.1.1.2.2.3.cmml" xref="alg1.l8.m1.1.1.1.1.2.2.3">𝐿</ci></apply><ci id="alg1.l8.m1.1.1.1.1.2.3.cmml" xref="alg1.l8.m1.1.1.1.1.2.3">𝑡</ci></apply><apply id="alg1.l8.m1.1.1.1.1.3.cmml" xref="alg1.l8.m1.1.1.1.1.3"><csymbol cd="ambiguous" id="alg1.l8.m1.1.1.1.1.3.1.cmml" xref="alg1.l8.m1.1.1.1.1.3">superscript</csymbol><apply id="alg1.l8.m1.1.1.1.1.3.2.cmml" xref="alg1.l8.m1.1.1.1.1.3"><csymbol cd="ambiguous" id="alg1.l8.m1.1.1.1.1.3.2.1.cmml" xref="alg1.l8.m1.1.1.1.1.3">subscript</csymbol><ci id="alg1.l8.m1.1.1.1.1.3.2.2.cmml" xref="alg1.l8.m1.1.1.1.1.3.2.2">𝜃</ci><ci id="alg1.l8.m1.1.1.1.1.3.2.3.cmml" xref="alg1.l8.m1.1.1.1.1.3.2.3">𝐿</ci></apply><ci id="alg1.l8.m1.1.1.1.1.3.3a.cmml" xref="alg1.l8.m1.1.1.1.1.3.3"><mtext mathsize="50%" id="alg1.l8.m1.1.1.1.1.3.3.cmml" xref="alg1.l8.m1.1.1.1.1.3.3">student</mtext></ci></apply></apply><apply id="alg1.l8.m1.2.2.2.2.cmml" xref="alg1.l8.m1.2.2.2.2"><ci id="alg1.l8.m1.2.2.2.2.1.cmml" xref="alg1.l8.m1.2.2.2.2.1">←</ci><apply id="alg1.l8.m1.2.2.2.2.2.cmml" xref="alg1.l8.m1.2.2.2.2.2"><csymbol cd="ambiguous" id="alg1.l8.m1.2.2.2.2.2.1.cmml" xref="alg1.l8.m1.2.2.2.2.2">superscript</csymbol><apply id="alg1.l8.m1.2.2.2.2.2.2.cmml" xref="alg1.l8.m1.2.2.2.2.2"><csymbol cd="ambiguous" id="alg1.l8.m1.2.2.2.2.2.2.1.cmml" xref="alg1.l8.m1.2.2.2.2.2">subscript</csymbol><ci id="alg1.l8.m1.2.2.2.2.2.2.2.cmml" xref="alg1.l8.m1.2.2.2.2.2.2.2">𝜃</ci><ci id="alg1.l8.m1.2.2.2.2.2.2.3.cmml" xref="alg1.l8.m1.2.2.2.2.2.2.3">𝐻</ci></apply><ci id="alg1.l8.m1.2.2.2.2.2.3.cmml" xref="alg1.l8.m1.2.2.2.2.2.3">𝑡</ci></apply><apply id="alg1.l8.m1.2.2.2.2.3.cmml" xref="alg1.l8.m1.2.2.2.2.3"><csymbol cd="ambiguous" id="alg1.l8.m1.2.2.2.2.3.1.cmml" xref="alg1.l8.m1.2.2.2.2.3">superscript</csymbol><apply id="alg1.l8.m1.2.2.2.2.3.2.cmml" xref="alg1.l8.m1.2.2.2.2.3"><csymbol cd="ambiguous" id="alg1.l8.m1.2.2.2.2.3.2.1.cmml" xref="alg1.l8.m1.2.2.2.2.3">subscript</csymbol><ci id="alg1.l8.m1.2.2.2.2.3.2.2.cmml" xref="alg1.l8.m1.2.2.2.2.3.2.2">𝜃</ci><ci id="alg1.l8.m1.2.2.2.2.3.2.3.cmml" xref="alg1.l8.m1.2.2.2.2.3.2.3">𝐻</ci></apply><ci id="alg1.l8.m1.2.2.2.2.3.3a.cmml" xref="alg1.l8.m1.2.2.2.2.3.3"><mtext mathsize="50%" id="alg1.l8.m1.2.2.2.2.3.3.cmml" xref="alg1.l8.m1.2.2.2.2.3.3">student</mtext></ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l8.m1.2c">\theta_{L}^{t}\leftarrow\theta_{L}^{\text{\tiny student}},\,\theta_{H}^{t}\leftarrow\theta_{H}^{\text{\tiny student}}</annotation></semantics></math>

</div>
<div id="alg1.l9" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg1.l9.1.1.1" class="ltx_text" style="font-size:80%;">9:</span></span>     <span id="alg1.l9.2" class="ltx_text ltx_font_bold">end</span> <span id="alg1.l9.3" class="ltx_text ltx_font_bold">if</span>
</div>
<div id="alg1.l10" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg1.l10.1.1.1" class="ltx_text" style="font-size:80%;">10:</span></span>  <span id="alg1.l10.2" class="ltx_text ltx_font_bold">end</span> <span id="alg1.l10.3" class="ltx_text ltx_font_bold">for</span>
</div>
<div id="alg1.l10a" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg1.l10a.1.1.1" class="ltx_text" style="font-size:80%;">10:</span></span>  <math id="alg1.l10a.m1.1" class="ltx_Math" alttext="\theta_{L}^{T}" display="inline"><semantics id="alg1.l10a.m1.1a"><msubsup id="alg1.l10a.m1.1.1" xref="alg1.l10a.m1.1.1.cmml"><mi id="alg1.l10a.m1.1.1.2.2" xref="alg1.l10a.m1.1.1.2.2.cmml">θ</mi><mi id="alg1.l10a.m1.1.1.2.3" xref="alg1.l10a.m1.1.1.2.3.cmml">L</mi><mi id="alg1.l10a.m1.1.1.3" xref="alg1.l10a.m1.1.1.3.cmml">T</mi></msubsup><annotation-xml encoding="MathML-Content" id="alg1.l10a.m1.1b"><apply id="alg1.l10a.m1.1.1.cmml" xref="alg1.l10a.m1.1.1"><csymbol cd="ambiguous" id="alg1.l10a.m1.1.1.1.cmml" xref="alg1.l10a.m1.1.1">superscript</csymbol><apply id="alg1.l10a.m1.1.1.2.cmml" xref="alg1.l10a.m1.1.1"><csymbol cd="ambiguous" id="alg1.l10a.m1.1.1.2.1.cmml" xref="alg1.l10a.m1.1.1">subscript</csymbol><ci id="alg1.l10a.m1.1.1.2.2.cmml" xref="alg1.l10a.m1.1.1.2.2">𝜃</ci><ci id="alg1.l10a.m1.1.1.2.3.cmml" xref="alg1.l10a.m1.1.1.2.3">𝐿</ci></apply><ci id="alg1.l10a.m1.1.1.3.cmml" xref="alg1.l10a.m1.1.1.3">𝑇</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l10a.m1.1c">\theta_{L}^{T}</annotation></semantics></math>, <math id="alg1.l10a.m2.1" class="ltx_Math" alttext="\theta_{H}^{T}" display="inline"><semantics id="alg1.l10a.m2.1a"><msubsup id="alg1.l10a.m2.1.1" xref="alg1.l10a.m2.1.1.cmml"><mi id="alg1.l10a.m2.1.1.2.2" xref="alg1.l10a.m2.1.1.2.2.cmml">θ</mi><mi id="alg1.l10a.m2.1.1.2.3" xref="alg1.l10a.m2.1.1.2.3.cmml">H</mi><mi id="alg1.l10a.m2.1.1.3" xref="alg1.l10a.m2.1.1.3.cmml">T</mi></msubsup><annotation-xml encoding="MathML-Content" id="alg1.l10a.m2.1b"><apply id="alg1.l10a.m2.1.1.cmml" xref="alg1.l10a.m2.1.1"><csymbol cd="ambiguous" id="alg1.l10a.m2.1.1.1.cmml" xref="alg1.l10a.m2.1.1">superscript</csymbol><apply id="alg1.l10a.m2.1.1.2.cmml" xref="alg1.l10a.m2.1.1"><csymbol cd="ambiguous" id="alg1.l10a.m2.1.1.2.1.cmml" xref="alg1.l10a.m2.1.1">subscript</csymbol><ci id="alg1.l10a.m2.1.1.2.2.cmml" xref="alg1.l10a.m2.1.1.2.2">𝜃</ci><ci id="alg1.l10a.m2.1.1.2.3.cmml" xref="alg1.l10a.m2.1.1.2.3">𝐻</ci></apply><ci id="alg1.l10a.m2.1.1.3.cmml" xref="alg1.l10a.m2.1.1.3">𝑇</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l10a.m2.1c">\theta_{H}^{T}</annotation></semantics></math>

</div>
</div>
</figure>
<figure id="alg2" class="ltx_float ltx_float_algorithm ltx_framed ltx_framed_top">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_float"><span id="alg2.3.1.1" class="ltx_text ltx_font_bold">Algorithm 2</span> </span> <span id="alg2.4.2" class="ltx_text ltx_font_smallcaps">MergedCodist</span>: Merged Codistillation</figcaption>
<div id="alg2.5" class="ltx_listing ltx_listing">
<div id="alg2.l0" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg2.l0.1.1.1" class="ltx_text" style="font-size:80%;">0:</span></span>  number of <span id="alg2.l0.2" class="ltx_text ltx_font_smallcaps">FedAvg</span> rounds <math id="alg2.l0.m1.1" class="ltx_Math" alttext="T" display="inline"><semantics id="alg2.l0.m1.1a"><mi id="alg2.l0.m1.1.1" xref="alg2.l0.m1.1.1.cmml">T</mi><annotation-xml encoding="MathML-Content" id="alg2.l0.m1.1b"><ci id="alg2.l0.m1.1.1.cmml" xref="alg2.l0.m1.1.1">𝑇</ci></annotation-xml><annotation encoding="application/x-tex" id="alg2.l0.m1.1c">T</annotation></semantics></math>, total clients pool <math id="alg2.l0.m2.1" class="ltx_Math" alttext="\mathcal{P}" display="inline"><semantics id="alg2.l0.m2.1a"><mi class="ltx_font_mathcaligraphic" id="alg2.l0.m2.1.1" xref="alg2.l0.m2.1.1.cmml">𝒫</mi><annotation-xml encoding="MathML-Content" id="alg2.l0.m2.1b"><ci id="alg2.l0.m2.1.1.cmml" xref="alg2.l0.m2.1.1">𝒫</ci></annotation-xml><annotation encoding="application/x-tex" id="alg2.l0.m2.1c">\mathcal{P}</annotation></semantics></math> and the subset of high-performance clients <math id="alg2.l0.m3.1" class="ltx_Math" alttext="\mathcal{P}_{H}\subset\mathcal{P}" display="inline"><semantics id="alg2.l0.m3.1a"><mrow id="alg2.l0.m3.1.1" xref="alg2.l0.m3.1.1.cmml"><msub id="alg2.l0.m3.1.1.2" xref="alg2.l0.m3.1.1.2.cmml"><mi class="ltx_font_mathcaligraphic" id="alg2.l0.m3.1.1.2.2" xref="alg2.l0.m3.1.1.2.2.cmml">𝒫</mi><mi id="alg2.l0.m3.1.1.2.3" xref="alg2.l0.m3.1.1.2.3.cmml">H</mi></msub><mo id="alg2.l0.m3.1.1.1" xref="alg2.l0.m3.1.1.1.cmml">⊂</mo><mi class="ltx_font_mathcaligraphic" id="alg2.l0.m3.1.1.3" xref="alg2.l0.m3.1.1.3.cmml">𝒫</mi></mrow><annotation-xml encoding="MathML-Content" id="alg2.l0.m3.1b"><apply id="alg2.l0.m3.1.1.cmml" xref="alg2.l0.m3.1.1"><subset id="alg2.l0.m3.1.1.1.cmml" xref="alg2.l0.m3.1.1.1"></subset><apply id="alg2.l0.m3.1.1.2.cmml" xref="alg2.l0.m3.1.1.2"><csymbol cd="ambiguous" id="alg2.l0.m3.1.1.2.1.cmml" xref="alg2.l0.m3.1.1.2">subscript</csymbol><ci id="alg2.l0.m3.1.1.2.2.cmml" xref="alg2.l0.m3.1.1.2.2">𝒫</ci><ci id="alg2.l0.m3.1.1.2.3.cmml" xref="alg2.l0.m3.1.1.2.3">𝐻</ci></apply><ci id="alg2.l0.m3.1.1.3.cmml" xref="alg2.l0.m3.1.1.3">𝒫</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.l0.m3.1c">\mathcal{P}_{H}\subset\mathcal{P}</annotation></semantics></math>, codistillation steps <math id="alg2.l0.m4.1" class="ltx_Math" alttext="s" display="inline"><semantics id="alg2.l0.m4.1a"><mi id="alg2.l0.m4.1.1" xref="alg2.l0.m4.1.1.cmml">s</mi><annotation-xml encoding="MathML-Content" id="alg2.l0.m4.1b"><ci id="alg2.l0.m4.1.1.cmml" xref="alg2.l0.m4.1.1">𝑠</ci></annotation-xml><annotation encoding="application/x-tex" id="alg2.l0.m4.1c">s</annotation></semantics></math>, merging factor <math id="alg2.l0.m5.2" class="ltx_Math" alttext="\alpha\in[0,1]" display="inline"><semantics id="alg2.l0.m5.2a"><mrow id="alg2.l0.m5.2.3" xref="alg2.l0.m5.2.3.cmml"><mi id="alg2.l0.m5.2.3.2" xref="alg2.l0.m5.2.3.2.cmml">α</mi><mo id="alg2.l0.m5.2.3.1" xref="alg2.l0.m5.2.3.1.cmml">∈</mo><mrow id="alg2.l0.m5.2.3.3.2" xref="alg2.l0.m5.2.3.3.1.cmml"><mo stretchy="false" id="alg2.l0.m5.2.3.3.2.1" xref="alg2.l0.m5.2.3.3.1.cmml">[</mo><mn id="alg2.l0.m5.1.1" xref="alg2.l0.m5.1.1.cmml">0</mn><mo id="alg2.l0.m5.2.3.3.2.2" xref="alg2.l0.m5.2.3.3.1.cmml">,</mo><mn id="alg2.l0.m5.2.2" xref="alg2.l0.m5.2.2.cmml">1</mn><mo stretchy="false" id="alg2.l0.m5.2.3.3.2.3" xref="alg2.l0.m5.2.3.3.1.cmml">]</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg2.l0.m5.2b"><apply id="alg2.l0.m5.2.3.cmml" xref="alg2.l0.m5.2.3"><in id="alg2.l0.m5.2.3.1.cmml" xref="alg2.l0.m5.2.3.1"></in><ci id="alg2.l0.m5.2.3.2.cmml" xref="alg2.l0.m5.2.3.2">𝛼</ci><interval closure="closed" id="alg2.l0.m5.2.3.3.1.cmml" xref="alg2.l0.m5.2.3.3.2"><cn type="integer" id="alg2.l0.m5.1.1.cmml" xref="alg2.l0.m5.1.1">0</cn><cn type="integer" id="alg2.l0.m5.2.2.cmml" xref="alg2.l0.m5.2.2">1</cn></interval></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.l0.m5.2c">\alpha\in[0,1]</annotation></semantics></math>


</div>
<div id="alg2.l1" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg2.l1.1.1.1" class="ltx_text" style="font-size:80%;">1:</span></span>  Initialize parameters <math id="alg2.l1.m1.1" class="ltx_Math" alttext="\theta_{L}^{0}" display="inline"><semantics id="alg2.l1.m1.1a"><msubsup id="alg2.l1.m1.1.1" xref="alg2.l1.m1.1.1.cmml"><mi id="alg2.l1.m1.1.1.2.2" xref="alg2.l1.m1.1.1.2.2.cmml">θ</mi><mi id="alg2.l1.m1.1.1.2.3" xref="alg2.l1.m1.1.1.2.3.cmml">L</mi><mn id="alg2.l1.m1.1.1.3" xref="alg2.l1.m1.1.1.3.cmml">0</mn></msubsup><annotation-xml encoding="MathML-Content" id="alg2.l1.m1.1b"><apply id="alg2.l1.m1.1.1.cmml" xref="alg2.l1.m1.1.1"><csymbol cd="ambiguous" id="alg2.l1.m1.1.1.1.cmml" xref="alg2.l1.m1.1.1">superscript</csymbol><apply id="alg2.l1.m1.1.1.2.cmml" xref="alg2.l1.m1.1.1"><csymbol cd="ambiguous" id="alg2.l1.m1.1.1.2.1.cmml" xref="alg2.l1.m1.1.1">subscript</csymbol><ci id="alg2.l1.m1.1.1.2.2.cmml" xref="alg2.l1.m1.1.1.2.2">𝜃</ci><ci id="alg2.l1.m1.1.1.2.3.cmml" xref="alg2.l1.m1.1.1.2.3">𝐿</ci></apply><cn type="integer" id="alg2.l1.m1.1.1.3.cmml" xref="alg2.l1.m1.1.1.3">0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.l1.m1.1c">\theta_{L}^{0}</annotation></semantics></math> and <math id="alg2.l1.m2.1" class="ltx_Math" alttext="\theta_{H}^{0}" display="inline"><semantics id="alg2.l1.m2.1a"><msubsup id="alg2.l1.m2.1.1" xref="alg2.l1.m2.1.1.cmml"><mi id="alg2.l1.m2.1.1.2.2" xref="alg2.l1.m2.1.1.2.2.cmml">θ</mi><mi id="alg2.l1.m2.1.1.2.3" xref="alg2.l1.m2.1.1.2.3.cmml">H</mi><mn id="alg2.l1.m2.1.1.3" xref="alg2.l1.m2.1.1.3.cmml">0</mn></msubsup><annotation-xml encoding="MathML-Content" id="alg2.l1.m2.1b"><apply id="alg2.l1.m2.1.1.cmml" xref="alg2.l1.m2.1.1"><csymbol cd="ambiguous" id="alg2.l1.m2.1.1.1.cmml" xref="alg2.l1.m2.1.1">superscript</csymbol><apply id="alg2.l1.m2.1.1.2.cmml" xref="alg2.l1.m2.1.1"><csymbol cd="ambiguous" id="alg2.l1.m2.1.1.2.1.cmml" xref="alg2.l1.m2.1.1">subscript</csymbol><ci id="alg2.l1.m2.1.1.2.2.cmml" xref="alg2.l1.m2.1.1.2.2">𝜃</ci><ci id="alg2.l1.m2.1.1.2.3.cmml" xref="alg2.l1.m2.1.1.2.3">𝐻</ci></apply><cn type="integer" id="alg2.l1.m2.1.1.3.cmml" xref="alg2.l1.m2.1.1.3">0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.l1.m2.1c">\theta_{H}^{0}</annotation></semantics></math>

</div>
<div id="alg2.l2" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg2.l2.1.1.1" class="ltx_text" style="font-size:80%;">2:</span></span>  <span id="alg2.l2.2" class="ltx_text ltx_font_bold">for</span> <math id="alg2.l2.m1.1" class="ltx_Math" alttext="t=1" display="inline"><semantics id="alg2.l2.m1.1a"><mrow id="alg2.l2.m1.1.1" xref="alg2.l2.m1.1.1.cmml"><mi id="alg2.l2.m1.1.1.2" xref="alg2.l2.m1.1.1.2.cmml">t</mi><mo id="alg2.l2.m1.1.1.1" xref="alg2.l2.m1.1.1.1.cmml">=</mo><mn id="alg2.l2.m1.1.1.3" xref="alg2.l2.m1.1.1.3.cmml">1</mn></mrow><annotation-xml encoding="MathML-Content" id="alg2.l2.m1.1b"><apply id="alg2.l2.m1.1.1.cmml" xref="alg2.l2.m1.1.1"><eq id="alg2.l2.m1.1.1.1.cmml" xref="alg2.l2.m1.1.1.1"></eq><ci id="alg2.l2.m1.1.1.2.cmml" xref="alg2.l2.m1.1.1.2">𝑡</ci><cn type="integer" id="alg2.l2.m1.1.1.3.cmml" xref="alg2.l2.m1.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.l2.m1.1c">t=1</annotation></semantics></math> <span id="alg2.l2.3" class="ltx_text ltx_font_bold">to</span> <math id="alg2.l2.m2.1" class="ltx_Math" alttext="T" display="inline"><semantics id="alg2.l2.m2.1a"><mi id="alg2.l2.m2.1.1" xref="alg2.l2.m2.1.1.cmml">T</mi><annotation-xml encoding="MathML-Content" id="alg2.l2.m2.1b"><ci id="alg2.l2.m2.1.1.cmml" xref="alg2.l2.m2.1.1">𝑇</ci></annotation-xml><annotation encoding="application/x-tex" id="alg2.l2.m2.1c">T</annotation></semantics></math> <span id="alg2.l2.4" class="ltx_text ltx_font_bold">do</span>



</div>
<div id="alg2.l3" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg2.l3.1.1.1" class="ltx_text" style="font-size:80%;">3:</span></span>     Aggregate client gradients <math id="alg2.l3.m1.1" class="ltx_Math" alttext="g^{t}_{L}" display="inline"><semantics id="alg2.l3.m1.1a"><msubsup id="alg2.l3.m1.1.1" xref="alg2.l3.m1.1.1.cmml"><mi id="alg2.l3.m1.1.1.2.2" xref="alg2.l3.m1.1.1.2.2.cmml">g</mi><mi id="alg2.l3.m1.1.1.3" xref="alg2.l3.m1.1.1.3.cmml">L</mi><mi id="alg2.l3.m1.1.1.2.3" xref="alg2.l3.m1.1.1.2.3.cmml">t</mi></msubsup><annotation-xml encoding="MathML-Content" id="alg2.l3.m1.1b"><apply id="alg2.l3.m1.1.1.cmml" xref="alg2.l3.m1.1.1"><csymbol cd="ambiguous" id="alg2.l3.m1.1.1.1.cmml" xref="alg2.l3.m1.1.1">subscript</csymbol><apply id="alg2.l3.m1.1.1.2.cmml" xref="alg2.l3.m1.1.1"><csymbol cd="ambiguous" id="alg2.l3.m1.1.1.2.1.cmml" xref="alg2.l3.m1.1.1">superscript</csymbol><ci id="alg2.l3.m1.1.1.2.2.cmml" xref="alg2.l3.m1.1.1.2.2">𝑔</ci><ci id="alg2.l3.m1.1.1.2.3.cmml" xref="alg2.l3.m1.1.1.2.3">𝑡</ci></apply><ci id="alg2.l3.m1.1.1.3.cmml" xref="alg2.l3.m1.1.1.3">𝐿</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.l3.m1.1c">g^{t}_{L}</annotation></semantics></math> and <math id="alg2.l3.m2.1" class="ltx_Math" alttext="g^{t}_{H}" display="inline"><semantics id="alg2.l3.m2.1a"><msubsup id="alg2.l3.m2.1.1" xref="alg2.l3.m2.1.1.cmml"><mi id="alg2.l3.m2.1.1.2.2" xref="alg2.l3.m2.1.1.2.2.cmml">g</mi><mi id="alg2.l3.m2.1.1.3" xref="alg2.l3.m2.1.1.3.cmml">H</mi><mi id="alg2.l3.m2.1.1.2.3" xref="alg2.l3.m2.1.1.2.3.cmml">t</mi></msubsup><annotation-xml encoding="MathML-Content" id="alg2.l3.m2.1b"><apply id="alg2.l3.m2.1.1.cmml" xref="alg2.l3.m2.1.1"><csymbol cd="ambiguous" id="alg2.l3.m2.1.1.1.cmml" xref="alg2.l3.m2.1.1">subscript</csymbol><apply id="alg2.l3.m2.1.1.2.cmml" xref="alg2.l3.m2.1.1"><csymbol cd="ambiguous" id="alg2.l3.m2.1.1.2.1.cmml" xref="alg2.l3.m2.1.1">superscript</csymbol><ci id="alg2.l3.m2.1.1.2.2.cmml" xref="alg2.l3.m2.1.1.2.2">𝑔</ci><ci id="alg2.l3.m2.1.1.2.3.cmml" xref="alg2.l3.m2.1.1.2.3">𝑡</ci></apply><ci id="alg2.l3.m2.1.1.3.cmml" xref="alg2.l3.m2.1.1.3">𝐻</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.l3.m2.1c">g^{t}_{H}</annotation></semantics></math>, respectively, for <math id="alg2.l3.m3.1" class="ltx_Math" alttext="\theta_{L}^{t}" display="inline"><semantics id="alg2.l3.m3.1a"><msubsup id="alg2.l3.m3.1.1" xref="alg2.l3.m3.1.1.cmml"><mi id="alg2.l3.m3.1.1.2.2" xref="alg2.l3.m3.1.1.2.2.cmml">θ</mi><mi id="alg2.l3.m3.1.1.2.3" xref="alg2.l3.m3.1.1.2.3.cmml">L</mi><mi id="alg2.l3.m3.1.1.3" xref="alg2.l3.m3.1.1.3.cmml">t</mi></msubsup><annotation-xml encoding="MathML-Content" id="alg2.l3.m3.1b"><apply id="alg2.l3.m3.1.1.cmml" xref="alg2.l3.m3.1.1"><csymbol cd="ambiguous" id="alg2.l3.m3.1.1.1.cmml" xref="alg2.l3.m3.1.1">superscript</csymbol><apply id="alg2.l3.m3.1.1.2.cmml" xref="alg2.l3.m3.1.1"><csymbol cd="ambiguous" id="alg2.l3.m3.1.1.2.1.cmml" xref="alg2.l3.m3.1.1">subscript</csymbol><ci id="alg2.l3.m3.1.1.2.2.cmml" xref="alg2.l3.m3.1.1.2.2">𝜃</ci><ci id="alg2.l3.m3.1.1.2.3.cmml" xref="alg2.l3.m3.1.1.2.3">𝐿</ci></apply><ci id="alg2.l3.m3.1.1.3.cmml" xref="alg2.l3.m3.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.l3.m3.1c">\theta_{L}^{t}</annotation></semantics></math> and <math id="alg2.l3.m4.1" class="ltx_Math" alttext="\theta_{H}^{t}" display="inline"><semantics id="alg2.l3.m4.1a"><msubsup id="alg2.l3.m4.1.1" xref="alg2.l3.m4.1.1.cmml"><mi id="alg2.l3.m4.1.1.2.2" xref="alg2.l3.m4.1.1.2.2.cmml">θ</mi><mi id="alg2.l3.m4.1.1.2.3" xref="alg2.l3.m4.1.1.2.3.cmml">H</mi><mi id="alg2.l3.m4.1.1.3" xref="alg2.l3.m4.1.1.3.cmml">t</mi></msubsup><annotation-xml encoding="MathML-Content" id="alg2.l3.m4.1b"><apply id="alg2.l3.m4.1.1.cmml" xref="alg2.l3.m4.1.1"><csymbol cd="ambiguous" id="alg2.l3.m4.1.1.1.cmml" xref="alg2.l3.m4.1.1">superscript</csymbol><apply id="alg2.l3.m4.1.1.2.cmml" xref="alg2.l3.m4.1.1"><csymbol cd="ambiguous" id="alg2.l3.m4.1.1.2.1.cmml" xref="alg2.l3.m4.1.1">subscript</csymbol><ci id="alg2.l3.m4.1.1.2.2.cmml" xref="alg2.l3.m4.1.1.2.2">𝜃</ci><ci id="alg2.l3.m4.1.1.2.3.cmml" xref="alg2.l3.m4.1.1.2.3">𝐻</ci></apply><ci id="alg2.l3.m4.1.1.3.cmml" xref="alg2.l3.m4.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.l3.m4.1c">\theta_{H}^{t}</annotation></semantics></math> by sampling clients from <math id="alg2.l3.m5.1" class="ltx_Math" alttext="\mathcal{P}" display="inline"><semantics id="alg2.l3.m5.1a"><mi class="ltx_font_mathcaligraphic" id="alg2.l3.m5.1.1" xref="alg2.l3.m5.1.1.cmml">𝒫</mi><annotation-xml encoding="MathML-Content" id="alg2.l3.m5.1b"><ci id="alg2.l3.m5.1.1.cmml" xref="alg2.l3.m5.1.1">𝒫</ci></annotation-xml><annotation encoding="application/x-tex" id="alg2.l3.m5.1c">\mathcal{P}</annotation></semantics></math> and <math id="alg2.l3.m6.1" class="ltx_Math" alttext="\mathcal{P}_{H}" display="inline"><semantics id="alg2.l3.m6.1a"><msub id="alg2.l3.m6.1.1" xref="alg2.l3.m6.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="alg2.l3.m6.1.1.2" xref="alg2.l3.m6.1.1.2.cmml">𝒫</mi><mi id="alg2.l3.m6.1.1.3" xref="alg2.l3.m6.1.1.3.cmml">H</mi></msub><annotation-xml encoding="MathML-Content" id="alg2.l3.m6.1b"><apply id="alg2.l3.m6.1.1.cmml" xref="alg2.l3.m6.1.1"><csymbol cd="ambiguous" id="alg2.l3.m6.1.1.1.cmml" xref="alg2.l3.m6.1.1">subscript</csymbol><ci id="alg2.l3.m6.1.1.2.cmml" xref="alg2.l3.m6.1.1.2">𝒫</ci><ci id="alg2.l3.m6.1.1.3.cmml" xref="alg2.l3.m6.1.1.3">𝐻</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.l3.m6.1c">\mathcal{P}_{H}</annotation></semantics></math>

</div>
<div id="alg2.l4" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg2.l4.1.1.1" class="ltx_text" style="font-size:80%;">4:</span></span>     Create <span id="alg2.l4.2" class="ltx_text ltx_font_bold">teachers</span> <math id="alg2.l4.m1.1" class="ltx_Math" alttext="\theta_{L}^{\text{\tiny teacher}}\leftarrow\theta_{L}^{t}" display="inline"><semantics id="alg2.l4.m1.1a"><mrow id="alg2.l4.m1.1.1" xref="alg2.l4.m1.1.1.cmml"><msubsup id="alg2.l4.m1.1.1.2" xref="alg2.l4.m1.1.1.2.cmml"><mi id="alg2.l4.m1.1.1.2.2.2" xref="alg2.l4.m1.1.1.2.2.2.cmml">θ</mi><mi id="alg2.l4.m1.1.1.2.2.3" xref="alg2.l4.m1.1.1.2.2.3.cmml">L</mi><mtext mathsize="71%" id="alg2.l4.m1.1.1.2.3" xref="alg2.l4.m1.1.1.2.3a.cmml">teacher</mtext></msubsup><mo stretchy="false" id="alg2.l4.m1.1.1.1" xref="alg2.l4.m1.1.1.1.cmml">←</mo><msubsup id="alg2.l4.m1.1.1.3" xref="alg2.l4.m1.1.1.3.cmml"><mi id="alg2.l4.m1.1.1.3.2.2" xref="alg2.l4.m1.1.1.3.2.2.cmml">θ</mi><mi id="alg2.l4.m1.1.1.3.2.3" xref="alg2.l4.m1.1.1.3.2.3.cmml">L</mi><mi id="alg2.l4.m1.1.1.3.3" xref="alg2.l4.m1.1.1.3.3.cmml">t</mi></msubsup></mrow><annotation-xml encoding="MathML-Content" id="alg2.l4.m1.1b"><apply id="alg2.l4.m1.1.1.cmml" xref="alg2.l4.m1.1.1"><ci id="alg2.l4.m1.1.1.1.cmml" xref="alg2.l4.m1.1.1.1">←</ci><apply id="alg2.l4.m1.1.1.2.cmml" xref="alg2.l4.m1.1.1.2"><csymbol cd="ambiguous" id="alg2.l4.m1.1.1.2.1.cmml" xref="alg2.l4.m1.1.1.2">superscript</csymbol><apply id="alg2.l4.m1.1.1.2.2.cmml" xref="alg2.l4.m1.1.1.2"><csymbol cd="ambiguous" id="alg2.l4.m1.1.1.2.2.1.cmml" xref="alg2.l4.m1.1.1.2">subscript</csymbol><ci id="alg2.l4.m1.1.1.2.2.2.cmml" xref="alg2.l4.m1.1.1.2.2.2">𝜃</ci><ci id="alg2.l4.m1.1.1.2.2.3.cmml" xref="alg2.l4.m1.1.1.2.2.3">𝐿</ci></apply><ci id="alg2.l4.m1.1.1.2.3a.cmml" xref="alg2.l4.m1.1.1.2.3"><mtext mathsize="50%" id="alg2.l4.m1.1.1.2.3.cmml" xref="alg2.l4.m1.1.1.2.3">teacher</mtext></ci></apply><apply id="alg2.l4.m1.1.1.3.cmml" xref="alg2.l4.m1.1.1.3"><csymbol cd="ambiguous" id="alg2.l4.m1.1.1.3.1.cmml" xref="alg2.l4.m1.1.1.3">superscript</csymbol><apply id="alg2.l4.m1.1.1.3.2.cmml" xref="alg2.l4.m1.1.1.3"><csymbol cd="ambiguous" id="alg2.l4.m1.1.1.3.2.1.cmml" xref="alg2.l4.m1.1.1.3">subscript</csymbol><ci id="alg2.l4.m1.1.1.3.2.2.cmml" xref="alg2.l4.m1.1.1.3.2.2">𝜃</ci><ci id="alg2.l4.m1.1.1.3.2.3.cmml" xref="alg2.l4.m1.1.1.3.2.3">𝐿</ci></apply><ci id="alg2.l4.m1.1.1.3.3.cmml" xref="alg2.l4.m1.1.1.3.3">𝑡</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.l4.m1.1c">\theta_{L}^{\text{\tiny teacher}}\leftarrow\theta_{L}^{t}</annotation></semantics></math> and <math id="alg2.l4.m2.1" class="ltx_Math" alttext="\theta_{H}^{\text{\tiny teacher}}\leftarrow\theta_{H}^{t}" display="inline"><semantics id="alg2.l4.m2.1a"><mrow id="alg2.l4.m2.1.1" xref="alg2.l4.m2.1.1.cmml"><msubsup id="alg2.l4.m2.1.1.2" xref="alg2.l4.m2.1.1.2.cmml"><mi id="alg2.l4.m2.1.1.2.2.2" xref="alg2.l4.m2.1.1.2.2.2.cmml">θ</mi><mi id="alg2.l4.m2.1.1.2.2.3" xref="alg2.l4.m2.1.1.2.2.3.cmml">H</mi><mtext mathsize="71%" id="alg2.l4.m2.1.1.2.3" xref="alg2.l4.m2.1.1.2.3a.cmml">teacher</mtext></msubsup><mo stretchy="false" id="alg2.l4.m2.1.1.1" xref="alg2.l4.m2.1.1.1.cmml">←</mo><msubsup id="alg2.l4.m2.1.1.3" xref="alg2.l4.m2.1.1.3.cmml"><mi id="alg2.l4.m2.1.1.3.2.2" xref="alg2.l4.m2.1.1.3.2.2.cmml">θ</mi><mi id="alg2.l4.m2.1.1.3.2.3" xref="alg2.l4.m2.1.1.3.2.3.cmml">H</mi><mi id="alg2.l4.m2.1.1.3.3" xref="alg2.l4.m2.1.1.3.3.cmml">t</mi></msubsup></mrow><annotation-xml encoding="MathML-Content" id="alg2.l4.m2.1b"><apply id="alg2.l4.m2.1.1.cmml" xref="alg2.l4.m2.1.1"><ci id="alg2.l4.m2.1.1.1.cmml" xref="alg2.l4.m2.1.1.1">←</ci><apply id="alg2.l4.m2.1.1.2.cmml" xref="alg2.l4.m2.1.1.2"><csymbol cd="ambiguous" id="alg2.l4.m2.1.1.2.1.cmml" xref="alg2.l4.m2.1.1.2">superscript</csymbol><apply id="alg2.l4.m2.1.1.2.2.cmml" xref="alg2.l4.m2.1.1.2"><csymbol cd="ambiguous" id="alg2.l4.m2.1.1.2.2.1.cmml" xref="alg2.l4.m2.1.1.2">subscript</csymbol><ci id="alg2.l4.m2.1.1.2.2.2.cmml" xref="alg2.l4.m2.1.1.2.2.2">𝜃</ci><ci id="alg2.l4.m2.1.1.2.2.3.cmml" xref="alg2.l4.m2.1.1.2.2.3">𝐻</ci></apply><ci id="alg2.l4.m2.1.1.2.3a.cmml" xref="alg2.l4.m2.1.1.2.3"><mtext mathsize="50%" id="alg2.l4.m2.1.1.2.3.cmml" xref="alg2.l4.m2.1.1.2.3">teacher</mtext></ci></apply><apply id="alg2.l4.m2.1.1.3.cmml" xref="alg2.l4.m2.1.1.3"><csymbol cd="ambiguous" id="alg2.l4.m2.1.1.3.1.cmml" xref="alg2.l4.m2.1.1.3">superscript</csymbol><apply id="alg2.l4.m2.1.1.3.2.cmml" xref="alg2.l4.m2.1.1.3"><csymbol cd="ambiguous" id="alg2.l4.m2.1.1.3.2.1.cmml" xref="alg2.l4.m2.1.1.3">subscript</csymbol><ci id="alg2.l4.m2.1.1.3.2.2.cmml" xref="alg2.l4.m2.1.1.3.2.2">𝜃</ci><ci id="alg2.l4.m2.1.1.3.2.3.cmml" xref="alg2.l4.m2.1.1.3.2.3">𝐻</ci></apply><ci id="alg2.l4.m2.1.1.3.3.cmml" xref="alg2.l4.m2.1.1.3.3">𝑡</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.l4.m2.1c">\theta_{H}^{\text{\tiny teacher}}\leftarrow\theta_{H}^{t}</annotation></semantics></math>

</div>
<div id="alg2.l5" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg2.l5.1.1.1" class="ltx_text" style="font-size:80%;">5:</span></span>     Initialize <span id="alg2.l5.2" class="ltx_text ltx_font_bold">students</span> <math id="alg2.l5.m1.2" class="ltx_Math" alttext="\theta_{L}^{\text{\tiny student}}\leftarrow\theta_{L}^{t},\,\theta_{H}^{\text{\tiny student}}\leftarrow\theta_{H}^{t}" display="inline"><semantics id="alg2.l5.m1.2a"><mrow id="alg2.l5.m1.2.2.2" xref="alg2.l5.m1.2.2.3.cmml"><mrow id="alg2.l5.m1.1.1.1.1" xref="alg2.l5.m1.1.1.1.1.cmml"><msubsup id="alg2.l5.m1.1.1.1.1.2" xref="alg2.l5.m1.1.1.1.1.2.cmml"><mi id="alg2.l5.m1.1.1.1.1.2.2.2" xref="alg2.l5.m1.1.1.1.1.2.2.2.cmml">θ</mi><mi id="alg2.l5.m1.1.1.1.1.2.2.3" xref="alg2.l5.m1.1.1.1.1.2.2.3.cmml">L</mi><mtext mathsize="71%" id="alg2.l5.m1.1.1.1.1.2.3" xref="alg2.l5.m1.1.1.1.1.2.3a.cmml">student</mtext></msubsup><mo stretchy="false" id="alg2.l5.m1.1.1.1.1.1" xref="alg2.l5.m1.1.1.1.1.1.cmml">←</mo><msubsup id="alg2.l5.m1.1.1.1.1.3" xref="alg2.l5.m1.1.1.1.1.3.cmml"><mi id="alg2.l5.m1.1.1.1.1.3.2.2" xref="alg2.l5.m1.1.1.1.1.3.2.2.cmml">θ</mi><mi id="alg2.l5.m1.1.1.1.1.3.2.3" xref="alg2.l5.m1.1.1.1.1.3.2.3.cmml">L</mi><mi id="alg2.l5.m1.1.1.1.1.3.3" xref="alg2.l5.m1.1.1.1.1.3.3.cmml">t</mi></msubsup></mrow><mo rspace="0.337em" id="alg2.l5.m1.2.2.2.3" xref="alg2.l5.m1.2.2.3a.cmml">,</mo><mrow id="alg2.l5.m1.2.2.2.2" xref="alg2.l5.m1.2.2.2.2.cmml"><msubsup id="alg2.l5.m1.2.2.2.2.2" xref="alg2.l5.m1.2.2.2.2.2.cmml"><mi id="alg2.l5.m1.2.2.2.2.2.2.2" xref="alg2.l5.m1.2.2.2.2.2.2.2.cmml">θ</mi><mi id="alg2.l5.m1.2.2.2.2.2.2.3" xref="alg2.l5.m1.2.2.2.2.2.2.3.cmml">H</mi><mtext mathsize="71%" id="alg2.l5.m1.2.2.2.2.2.3" xref="alg2.l5.m1.2.2.2.2.2.3a.cmml">student</mtext></msubsup><mo stretchy="false" id="alg2.l5.m1.2.2.2.2.1" xref="alg2.l5.m1.2.2.2.2.1.cmml">←</mo><msubsup id="alg2.l5.m1.2.2.2.2.3" xref="alg2.l5.m1.2.2.2.2.3.cmml"><mi id="alg2.l5.m1.2.2.2.2.3.2.2" xref="alg2.l5.m1.2.2.2.2.3.2.2.cmml">θ</mi><mi id="alg2.l5.m1.2.2.2.2.3.2.3" xref="alg2.l5.m1.2.2.2.2.3.2.3.cmml">H</mi><mi id="alg2.l5.m1.2.2.2.2.3.3" xref="alg2.l5.m1.2.2.2.2.3.3.cmml">t</mi></msubsup></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg2.l5.m1.2b"><apply id="alg2.l5.m1.2.2.3.cmml" xref="alg2.l5.m1.2.2.2"><csymbol cd="ambiguous" id="alg2.l5.m1.2.2.3a.cmml" xref="alg2.l5.m1.2.2.2.3">formulae-sequence</csymbol><apply id="alg2.l5.m1.1.1.1.1.cmml" xref="alg2.l5.m1.1.1.1.1"><ci id="alg2.l5.m1.1.1.1.1.1.cmml" xref="alg2.l5.m1.1.1.1.1.1">←</ci><apply id="alg2.l5.m1.1.1.1.1.2.cmml" xref="alg2.l5.m1.1.1.1.1.2"><csymbol cd="ambiguous" id="alg2.l5.m1.1.1.1.1.2.1.cmml" xref="alg2.l5.m1.1.1.1.1.2">superscript</csymbol><apply id="alg2.l5.m1.1.1.1.1.2.2.cmml" xref="alg2.l5.m1.1.1.1.1.2"><csymbol cd="ambiguous" id="alg2.l5.m1.1.1.1.1.2.2.1.cmml" xref="alg2.l5.m1.1.1.1.1.2">subscript</csymbol><ci id="alg2.l5.m1.1.1.1.1.2.2.2.cmml" xref="alg2.l5.m1.1.1.1.1.2.2.2">𝜃</ci><ci id="alg2.l5.m1.1.1.1.1.2.2.3.cmml" xref="alg2.l5.m1.1.1.1.1.2.2.3">𝐿</ci></apply><ci id="alg2.l5.m1.1.1.1.1.2.3a.cmml" xref="alg2.l5.m1.1.1.1.1.2.3"><mtext mathsize="50%" id="alg2.l5.m1.1.1.1.1.2.3.cmml" xref="alg2.l5.m1.1.1.1.1.2.3">student</mtext></ci></apply><apply id="alg2.l5.m1.1.1.1.1.3.cmml" xref="alg2.l5.m1.1.1.1.1.3"><csymbol cd="ambiguous" id="alg2.l5.m1.1.1.1.1.3.1.cmml" xref="alg2.l5.m1.1.1.1.1.3">superscript</csymbol><apply id="alg2.l5.m1.1.1.1.1.3.2.cmml" xref="alg2.l5.m1.1.1.1.1.3"><csymbol cd="ambiguous" id="alg2.l5.m1.1.1.1.1.3.2.1.cmml" xref="alg2.l5.m1.1.1.1.1.3">subscript</csymbol><ci id="alg2.l5.m1.1.1.1.1.3.2.2.cmml" xref="alg2.l5.m1.1.1.1.1.3.2.2">𝜃</ci><ci id="alg2.l5.m1.1.1.1.1.3.2.3.cmml" xref="alg2.l5.m1.1.1.1.1.3.2.3">𝐿</ci></apply><ci id="alg2.l5.m1.1.1.1.1.3.3.cmml" xref="alg2.l5.m1.1.1.1.1.3.3">𝑡</ci></apply></apply><apply id="alg2.l5.m1.2.2.2.2.cmml" xref="alg2.l5.m1.2.2.2.2"><ci id="alg2.l5.m1.2.2.2.2.1.cmml" xref="alg2.l5.m1.2.2.2.2.1">←</ci><apply id="alg2.l5.m1.2.2.2.2.2.cmml" xref="alg2.l5.m1.2.2.2.2.2"><csymbol cd="ambiguous" id="alg2.l5.m1.2.2.2.2.2.1.cmml" xref="alg2.l5.m1.2.2.2.2.2">superscript</csymbol><apply id="alg2.l5.m1.2.2.2.2.2.2.cmml" xref="alg2.l5.m1.2.2.2.2.2"><csymbol cd="ambiguous" id="alg2.l5.m1.2.2.2.2.2.2.1.cmml" xref="alg2.l5.m1.2.2.2.2.2">subscript</csymbol><ci id="alg2.l5.m1.2.2.2.2.2.2.2.cmml" xref="alg2.l5.m1.2.2.2.2.2.2.2">𝜃</ci><ci id="alg2.l5.m1.2.2.2.2.2.2.3.cmml" xref="alg2.l5.m1.2.2.2.2.2.2.3">𝐻</ci></apply><ci id="alg2.l5.m1.2.2.2.2.2.3a.cmml" xref="alg2.l5.m1.2.2.2.2.2.3"><mtext mathsize="50%" id="alg2.l5.m1.2.2.2.2.2.3.cmml" xref="alg2.l5.m1.2.2.2.2.2.3">student</mtext></ci></apply><apply id="alg2.l5.m1.2.2.2.2.3.cmml" xref="alg2.l5.m1.2.2.2.2.3"><csymbol cd="ambiguous" id="alg2.l5.m1.2.2.2.2.3.1.cmml" xref="alg2.l5.m1.2.2.2.2.3">superscript</csymbol><apply id="alg2.l5.m1.2.2.2.2.3.2.cmml" xref="alg2.l5.m1.2.2.2.2.3"><csymbol cd="ambiguous" id="alg2.l5.m1.2.2.2.2.3.2.1.cmml" xref="alg2.l5.m1.2.2.2.2.3">subscript</csymbol><ci id="alg2.l5.m1.2.2.2.2.3.2.2.cmml" xref="alg2.l5.m1.2.2.2.2.3.2.2">𝜃</ci><ci id="alg2.l5.m1.2.2.2.2.3.2.3.cmml" xref="alg2.l5.m1.2.2.2.2.3.2.3">𝐻</ci></apply><ci id="alg2.l5.m1.2.2.2.2.3.3.cmml" xref="alg2.l5.m1.2.2.2.2.3.3">𝑡</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.l5.m1.2c">\theta_{L}^{\text{\tiny student}}\leftarrow\theta_{L}^{t},\,\theta_{H}^{\text{\tiny student}}\leftarrow\theta_{H}^{t}</annotation></semantics></math>

</div>
<div id="alg2.l6" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg2.l6.1.1.1" class="ltx_text" style="font-size:80%;">6:</span></span>     <span id="alg2.l6.2" class="ltx_text ltx_font_bold">In parallel</span>, distill to <math id="alg2.l6.m1.1" class="ltx_Math" alttext="\theta^{\text{\tiny student}}_{i}" display="inline"><semantics id="alg2.l6.m1.1a"><msubsup id="alg2.l6.m1.1.1" xref="alg2.l6.m1.1.1.cmml"><mi id="alg2.l6.m1.1.1.2.2" xref="alg2.l6.m1.1.1.2.2.cmml">θ</mi><mi id="alg2.l6.m1.1.1.3" xref="alg2.l6.m1.1.1.3.cmml">i</mi><mtext mathsize="71%" id="alg2.l6.m1.1.1.2.3" xref="alg2.l6.m1.1.1.2.3a.cmml">student</mtext></msubsup><annotation-xml encoding="MathML-Content" id="alg2.l6.m1.1b"><apply id="alg2.l6.m1.1.1.cmml" xref="alg2.l6.m1.1.1"><csymbol cd="ambiguous" id="alg2.l6.m1.1.1.1.cmml" xref="alg2.l6.m1.1.1">subscript</csymbol><apply id="alg2.l6.m1.1.1.2.cmml" xref="alg2.l6.m1.1.1"><csymbol cd="ambiguous" id="alg2.l6.m1.1.1.2.1.cmml" xref="alg2.l6.m1.1.1">superscript</csymbol><ci id="alg2.l6.m1.1.1.2.2.cmml" xref="alg2.l6.m1.1.1.2.2">𝜃</ci><ci id="alg2.l6.m1.1.1.2.3a.cmml" xref="alg2.l6.m1.1.1.2.3"><mtext mathsize="50%" id="alg2.l6.m1.1.1.2.3.cmml" xref="alg2.l6.m1.1.1.2.3">student</mtext></ci></apply><ci id="alg2.l6.m1.1.1.3.cmml" xref="alg2.l6.m1.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.l6.m1.1c">\theta^{\text{\tiny student}}_{i}</annotation></semantics></math> for <math id="alg2.l6.m2.1" class="ltx_Math" alttext="s" display="inline"><semantics id="alg2.l6.m2.1a"><mi id="alg2.l6.m2.1.1" xref="alg2.l6.m2.1.1.cmml">s</mi><annotation-xml encoding="MathML-Content" id="alg2.l6.m2.1b"><ci id="alg2.l6.m2.1.1.cmml" xref="alg2.l6.m2.1.1">𝑠</ci></annotation-xml><annotation encoding="application/x-tex" id="alg2.l6.m2.1c">s</annotation></semantics></math> steps using <math id="alg2.l6.m3.3" class="ltx_Math" alttext="\theta^{\text{\tiny teacher}}_{\{L,H\}-\{i\}}" display="inline"><semantics id="alg2.l6.m3.3a"><msubsup id="alg2.l6.m3.3.4" xref="alg2.l6.m3.3.4.cmml"><mi id="alg2.l6.m3.3.4.2.2" xref="alg2.l6.m3.3.4.2.2.cmml">θ</mi><mrow id="alg2.l6.m3.3.3.3" xref="alg2.l6.m3.3.3.3.cmml"><mrow id="alg2.l6.m3.3.3.3.5.2" xref="alg2.l6.m3.3.3.3.5.1.cmml"><mo stretchy="false" id="alg2.l6.m3.3.3.3.5.2.1" xref="alg2.l6.m3.3.3.3.5.1.cmml">{</mo><mi id="alg2.l6.m3.1.1.1.1" xref="alg2.l6.m3.1.1.1.1.cmml">L</mi><mo id="alg2.l6.m3.3.3.3.5.2.2" xref="alg2.l6.m3.3.3.3.5.1.cmml">,</mo><mi id="alg2.l6.m3.2.2.2.2" xref="alg2.l6.m3.2.2.2.2.cmml">H</mi><mo stretchy="false" id="alg2.l6.m3.3.3.3.5.2.3" xref="alg2.l6.m3.3.3.3.5.1.cmml">}</mo></mrow><mo id="alg2.l6.m3.3.3.3.4" xref="alg2.l6.m3.3.3.3.4.cmml">−</mo><mrow id="alg2.l6.m3.3.3.3.6.2" xref="alg2.l6.m3.3.3.3.6.1.cmml"><mo stretchy="false" id="alg2.l6.m3.3.3.3.6.2.1" xref="alg2.l6.m3.3.3.3.6.1.cmml">{</mo><mi id="alg2.l6.m3.3.3.3.3" xref="alg2.l6.m3.3.3.3.3.cmml">i</mi><mo stretchy="false" id="alg2.l6.m3.3.3.3.6.2.2" xref="alg2.l6.m3.3.3.3.6.1.cmml">}</mo></mrow></mrow><mtext mathsize="71%" id="alg2.l6.m3.3.4.2.3" xref="alg2.l6.m3.3.4.2.3a.cmml">teacher</mtext></msubsup><annotation-xml encoding="MathML-Content" id="alg2.l6.m3.3b"><apply id="alg2.l6.m3.3.4.cmml" xref="alg2.l6.m3.3.4"><csymbol cd="ambiguous" id="alg2.l6.m3.3.4.1.cmml" xref="alg2.l6.m3.3.4">subscript</csymbol><apply id="alg2.l6.m3.3.4.2.cmml" xref="alg2.l6.m3.3.4"><csymbol cd="ambiguous" id="alg2.l6.m3.3.4.2.1.cmml" xref="alg2.l6.m3.3.4">superscript</csymbol><ci id="alg2.l6.m3.3.4.2.2.cmml" xref="alg2.l6.m3.3.4.2.2">𝜃</ci><ci id="alg2.l6.m3.3.4.2.3a.cmml" xref="alg2.l6.m3.3.4.2.3"><mtext mathsize="50%" id="alg2.l6.m3.3.4.2.3.cmml" xref="alg2.l6.m3.3.4.2.3">teacher</mtext></ci></apply><apply id="alg2.l6.m3.3.3.3.cmml" xref="alg2.l6.m3.3.3.3"><minus id="alg2.l6.m3.3.3.3.4.cmml" xref="alg2.l6.m3.3.3.3.4"></minus><set id="alg2.l6.m3.3.3.3.5.1.cmml" xref="alg2.l6.m3.3.3.3.5.2"><ci id="alg2.l6.m3.1.1.1.1.cmml" xref="alg2.l6.m3.1.1.1.1">𝐿</ci><ci id="alg2.l6.m3.2.2.2.2.cmml" xref="alg2.l6.m3.2.2.2.2">𝐻</ci></set><set id="alg2.l6.m3.3.3.3.6.1.cmml" xref="alg2.l6.m3.3.3.3.6.2"><ci id="alg2.l6.m3.3.3.3.3.cmml" xref="alg2.l6.m3.3.3.3.3">𝑖</ci></set></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.l6.m3.3c">\theta^{\text{\tiny teacher}}_{\{L,H\}-\{i\}}</annotation></semantics></math> as the teacher, where <math id="alg2.l6.m4.2" class="ltx_Math" alttext="i\in\{L,H\}" display="inline"><semantics id="alg2.l6.m4.2a"><mrow id="alg2.l6.m4.2.3" xref="alg2.l6.m4.2.3.cmml"><mi id="alg2.l6.m4.2.3.2" xref="alg2.l6.m4.2.3.2.cmml">i</mi><mo id="alg2.l6.m4.2.3.1" xref="alg2.l6.m4.2.3.1.cmml">∈</mo><mrow id="alg2.l6.m4.2.3.3.2" xref="alg2.l6.m4.2.3.3.1.cmml"><mo stretchy="false" id="alg2.l6.m4.2.3.3.2.1" xref="alg2.l6.m4.2.3.3.1.cmml">{</mo><mi id="alg2.l6.m4.1.1" xref="alg2.l6.m4.1.1.cmml">L</mi><mo id="alg2.l6.m4.2.3.3.2.2" xref="alg2.l6.m4.2.3.3.1.cmml">,</mo><mi id="alg2.l6.m4.2.2" xref="alg2.l6.m4.2.2.cmml">H</mi><mo stretchy="false" id="alg2.l6.m4.2.3.3.2.3" xref="alg2.l6.m4.2.3.3.1.cmml">}</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg2.l6.m4.2b"><apply id="alg2.l6.m4.2.3.cmml" xref="alg2.l6.m4.2.3"><in id="alg2.l6.m4.2.3.1.cmml" xref="alg2.l6.m4.2.3.1"></in><ci id="alg2.l6.m4.2.3.2.cmml" xref="alg2.l6.m4.2.3.2">𝑖</ci><set id="alg2.l6.m4.2.3.3.1.cmml" xref="alg2.l6.m4.2.3.3.2"><ci id="alg2.l6.m4.1.1.cmml" xref="alg2.l6.m4.1.1">𝐿</ci><ci id="alg2.l6.m4.2.2.cmml" xref="alg2.l6.m4.2.2">𝐻</ci></set></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.l6.m4.2c">i\in\{L,H\}</annotation></semantics></math>

</div>
<div id="alg2.l7" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg2.l7.1.1.1" class="ltx_text" style="font-size:80%;">7:</span></span>     Calculate <span id="alg2.l7.2" class="ltx_text ltx_font_bold">distillation gradients</span>
<table id="A2.Ex1" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="A2.Ex1.m1.4" class="ltx_Math" alttext="\delta_{i}^{t}\leftarrow\theta_{i}^{t}-\theta_{i}^{\text{\tiny student}},\,\,i\in\{L,H\}" display="block"><semantics id="A2.Ex1.m1.4a"><mrow id="A2.Ex1.m1.4.4.2" xref="A2.Ex1.m1.4.4.3.cmml"><mrow id="A2.Ex1.m1.3.3.1.1" xref="A2.Ex1.m1.3.3.1.1.cmml"><msubsup id="A2.Ex1.m1.3.3.1.1.2" xref="A2.Ex1.m1.3.3.1.1.2.cmml"><mi id="A2.Ex1.m1.3.3.1.1.2.2.2" xref="A2.Ex1.m1.3.3.1.1.2.2.2.cmml">δ</mi><mi id="A2.Ex1.m1.3.3.1.1.2.2.3" xref="A2.Ex1.m1.3.3.1.1.2.2.3.cmml">i</mi><mi id="A2.Ex1.m1.3.3.1.1.2.3" xref="A2.Ex1.m1.3.3.1.1.2.3.cmml">t</mi></msubsup><mo stretchy="false" id="A2.Ex1.m1.3.3.1.1.1" xref="A2.Ex1.m1.3.3.1.1.1.cmml">←</mo><mrow id="A2.Ex1.m1.3.3.1.1.3" xref="A2.Ex1.m1.3.3.1.1.3.cmml"><msubsup id="A2.Ex1.m1.3.3.1.1.3.2" xref="A2.Ex1.m1.3.3.1.1.3.2.cmml"><mi id="A2.Ex1.m1.3.3.1.1.3.2.2.2" xref="A2.Ex1.m1.3.3.1.1.3.2.2.2.cmml">θ</mi><mi id="A2.Ex1.m1.3.3.1.1.3.2.2.3" xref="A2.Ex1.m1.3.3.1.1.3.2.2.3.cmml">i</mi><mi id="A2.Ex1.m1.3.3.1.1.3.2.3" xref="A2.Ex1.m1.3.3.1.1.3.2.3.cmml">t</mi></msubsup><mo id="A2.Ex1.m1.3.3.1.1.3.1" xref="A2.Ex1.m1.3.3.1.1.3.1.cmml">−</mo><msubsup id="A2.Ex1.m1.3.3.1.1.3.3" xref="A2.Ex1.m1.3.3.1.1.3.3.cmml"><mi id="A2.Ex1.m1.3.3.1.1.3.3.2.2" xref="A2.Ex1.m1.3.3.1.1.3.3.2.2.cmml">θ</mi><mi id="A2.Ex1.m1.3.3.1.1.3.3.2.3" xref="A2.Ex1.m1.3.3.1.1.3.3.2.3.cmml">i</mi><mtext mathsize="71%" id="A2.Ex1.m1.3.3.1.1.3.3.3" xref="A2.Ex1.m1.3.3.1.1.3.3.3a.cmml">student</mtext></msubsup></mrow></mrow><mo rspace="0.497em" id="A2.Ex1.m1.4.4.2.3" xref="A2.Ex1.m1.4.4.3a.cmml">,</mo><mrow id="A2.Ex1.m1.4.4.2.2" xref="A2.Ex1.m1.4.4.2.2.cmml"><mi id="A2.Ex1.m1.4.4.2.2.2" xref="A2.Ex1.m1.4.4.2.2.2.cmml">i</mi><mo id="A2.Ex1.m1.4.4.2.2.1" xref="A2.Ex1.m1.4.4.2.2.1.cmml">∈</mo><mrow id="A2.Ex1.m1.4.4.2.2.3.2" xref="A2.Ex1.m1.4.4.2.2.3.1.cmml"><mo stretchy="false" id="A2.Ex1.m1.4.4.2.2.3.2.1" xref="A2.Ex1.m1.4.4.2.2.3.1.cmml">{</mo><mi id="A2.Ex1.m1.1.1" xref="A2.Ex1.m1.1.1.cmml">L</mi><mo id="A2.Ex1.m1.4.4.2.2.3.2.2" xref="A2.Ex1.m1.4.4.2.2.3.1.cmml">,</mo><mi id="A2.Ex1.m1.2.2" xref="A2.Ex1.m1.2.2.cmml">H</mi><mo stretchy="false" id="A2.Ex1.m1.4.4.2.2.3.2.3" xref="A2.Ex1.m1.4.4.2.2.3.1.cmml">}</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="A2.Ex1.m1.4b"><apply id="A2.Ex1.m1.4.4.3.cmml" xref="A2.Ex1.m1.4.4.2"><csymbol cd="ambiguous" id="A2.Ex1.m1.4.4.3a.cmml" xref="A2.Ex1.m1.4.4.2.3">formulae-sequence</csymbol><apply id="A2.Ex1.m1.3.3.1.1.cmml" xref="A2.Ex1.m1.3.3.1.1"><ci id="A2.Ex1.m1.3.3.1.1.1.cmml" xref="A2.Ex1.m1.3.3.1.1.1">←</ci><apply id="A2.Ex1.m1.3.3.1.1.2.cmml" xref="A2.Ex1.m1.3.3.1.1.2"><csymbol cd="ambiguous" id="A2.Ex1.m1.3.3.1.1.2.1.cmml" xref="A2.Ex1.m1.3.3.1.1.2">superscript</csymbol><apply id="A2.Ex1.m1.3.3.1.1.2.2.cmml" xref="A2.Ex1.m1.3.3.1.1.2"><csymbol cd="ambiguous" id="A2.Ex1.m1.3.3.1.1.2.2.1.cmml" xref="A2.Ex1.m1.3.3.1.1.2">subscript</csymbol><ci id="A2.Ex1.m1.3.3.1.1.2.2.2.cmml" xref="A2.Ex1.m1.3.3.1.1.2.2.2">𝛿</ci><ci id="A2.Ex1.m1.3.3.1.1.2.2.3.cmml" xref="A2.Ex1.m1.3.3.1.1.2.2.3">𝑖</ci></apply><ci id="A2.Ex1.m1.3.3.1.1.2.3.cmml" xref="A2.Ex1.m1.3.3.1.1.2.3">𝑡</ci></apply><apply id="A2.Ex1.m1.3.3.1.1.3.cmml" xref="A2.Ex1.m1.3.3.1.1.3"><minus id="A2.Ex1.m1.3.3.1.1.3.1.cmml" xref="A2.Ex1.m1.3.3.1.1.3.1"></minus><apply id="A2.Ex1.m1.3.3.1.1.3.2.cmml" xref="A2.Ex1.m1.3.3.1.1.3.2"><csymbol cd="ambiguous" id="A2.Ex1.m1.3.3.1.1.3.2.1.cmml" xref="A2.Ex1.m1.3.3.1.1.3.2">superscript</csymbol><apply id="A2.Ex1.m1.3.3.1.1.3.2.2.cmml" xref="A2.Ex1.m1.3.3.1.1.3.2"><csymbol cd="ambiguous" id="A2.Ex1.m1.3.3.1.1.3.2.2.1.cmml" xref="A2.Ex1.m1.3.3.1.1.3.2">subscript</csymbol><ci id="A2.Ex1.m1.3.3.1.1.3.2.2.2.cmml" xref="A2.Ex1.m1.3.3.1.1.3.2.2.2">𝜃</ci><ci id="A2.Ex1.m1.3.3.1.1.3.2.2.3.cmml" xref="A2.Ex1.m1.3.3.1.1.3.2.2.3">𝑖</ci></apply><ci id="A2.Ex1.m1.3.3.1.1.3.2.3.cmml" xref="A2.Ex1.m1.3.3.1.1.3.2.3">𝑡</ci></apply><apply id="A2.Ex1.m1.3.3.1.1.3.3.cmml" xref="A2.Ex1.m1.3.3.1.1.3.3"><csymbol cd="ambiguous" id="A2.Ex1.m1.3.3.1.1.3.3.1.cmml" xref="A2.Ex1.m1.3.3.1.1.3.3">superscript</csymbol><apply id="A2.Ex1.m1.3.3.1.1.3.3.2.cmml" xref="A2.Ex1.m1.3.3.1.1.3.3"><csymbol cd="ambiguous" id="A2.Ex1.m1.3.3.1.1.3.3.2.1.cmml" xref="A2.Ex1.m1.3.3.1.1.3.3">subscript</csymbol><ci id="A2.Ex1.m1.3.3.1.1.3.3.2.2.cmml" xref="A2.Ex1.m1.3.3.1.1.3.3.2.2">𝜃</ci><ci id="A2.Ex1.m1.3.3.1.1.3.3.2.3.cmml" xref="A2.Ex1.m1.3.3.1.1.3.3.2.3">𝑖</ci></apply><ci id="A2.Ex1.m1.3.3.1.1.3.3.3a.cmml" xref="A2.Ex1.m1.3.3.1.1.3.3.3"><mtext mathsize="50%" id="A2.Ex1.m1.3.3.1.1.3.3.3.cmml" xref="A2.Ex1.m1.3.3.1.1.3.3.3">student</mtext></ci></apply></apply></apply><apply id="A2.Ex1.m1.4.4.2.2.cmml" xref="A2.Ex1.m1.4.4.2.2"><in id="A2.Ex1.m1.4.4.2.2.1.cmml" xref="A2.Ex1.m1.4.4.2.2.1"></in><ci id="A2.Ex1.m1.4.4.2.2.2.cmml" xref="A2.Ex1.m1.4.4.2.2.2">𝑖</ci><set id="A2.Ex1.m1.4.4.2.2.3.1.cmml" xref="A2.Ex1.m1.4.4.2.2.3.2"><ci id="A2.Ex1.m1.1.1.cmml" xref="A2.Ex1.m1.1.1">𝐿</ci><ci id="A2.Ex1.m1.2.2.cmml" xref="A2.Ex1.m1.2.2">𝐻</ci></set></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A2.Ex1.m1.4c">\delta_{i}^{t}\leftarrow\theta_{i}^{t}-\theta_{i}^{\text{\tiny student}},\,\,i\in\{L,H\}</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
</div>
<div id="alg2.l8" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg2.l8.1.1.1" class="ltx_text" style="font-size:80%;">8:</span></span>     <span id="alg2.l8.2" class="ltx_text ltx_font_bold">Merge</span> the gradients
<table id="A2.Ex2" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="A2.Ex2.m1.6" class="ltx_Math" alttext="\Delta^{t}_{i}\leftarrow\alpha\,g^{t}_{i}+(1-\alpha)\,\delta_{i}^{t}\,\frac{\|g_{i}^{t}\|_{2}}{\|\delta_{i}^{t}\|_{2}}\,,\,i\in\{L,H\}" display="block"><semantics id="A2.Ex2.m1.6a"><mrow id="A2.Ex2.m1.6.6.2" xref="A2.Ex2.m1.6.6.3.cmml"><mrow id="A2.Ex2.m1.5.5.1.1" xref="A2.Ex2.m1.5.5.1.1.cmml"><msubsup id="A2.Ex2.m1.5.5.1.1.3" xref="A2.Ex2.m1.5.5.1.1.3.cmml"><mi mathvariant="normal" id="A2.Ex2.m1.5.5.1.1.3.2.2" xref="A2.Ex2.m1.5.5.1.1.3.2.2.cmml">Δ</mi><mi id="A2.Ex2.m1.5.5.1.1.3.3" xref="A2.Ex2.m1.5.5.1.1.3.3.cmml">i</mi><mi id="A2.Ex2.m1.5.5.1.1.3.2.3" xref="A2.Ex2.m1.5.5.1.1.3.2.3.cmml">t</mi></msubsup><mo stretchy="false" id="A2.Ex2.m1.5.5.1.1.2" xref="A2.Ex2.m1.5.5.1.1.2.cmml">←</mo><mrow id="A2.Ex2.m1.5.5.1.1.1" xref="A2.Ex2.m1.5.5.1.1.1.cmml"><mrow id="A2.Ex2.m1.5.5.1.1.1.3" xref="A2.Ex2.m1.5.5.1.1.1.3.cmml"><mi id="A2.Ex2.m1.5.5.1.1.1.3.2" xref="A2.Ex2.m1.5.5.1.1.1.3.2.cmml">α</mi><mo lspace="0.170em" rspace="0em" id="A2.Ex2.m1.5.5.1.1.1.3.1" xref="A2.Ex2.m1.5.5.1.1.1.3.1.cmml">​</mo><msubsup id="A2.Ex2.m1.5.5.1.1.1.3.3" xref="A2.Ex2.m1.5.5.1.1.1.3.3.cmml"><mi id="A2.Ex2.m1.5.5.1.1.1.3.3.2.2" xref="A2.Ex2.m1.5.5.1.1.1.3.3.2.2.cmml">g</mi><mi id="A2.Ex2.m1.5.5.1.1.1.3.3.3" xref="A2.Ex2.m1.5.5.1.1.1.3.3.3.cmml">i</mi><mi id="A2.Ex2.m1.5.5.1.1.1.3.3.2.3" xref="A2.Ex2.m1.5.5.1.1.1.3.3.2.3.cmml">t</mi></msubsup></mrow><mo id="A2.Ex2.m1.5.5.1.1.1.2" xref="A2.Ex2.m1.5.5.1.1.1.2.cmml">+</mo><mrow id="A2.Ex2.m1.5.5.1.1.1.1" xref="A2.Ex2.m1.5.5.1.1.1.1.cmml"><mrow id="A2.Ex2.m1.5.5.1.1.1.1.1.1" xref="A2.Ex2.m1.5.5.1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="A2.Ex2.m1.5.5.1.1.1.1.1.1.2" xref="A2.Ex2.m1.5.5.1.1.1.1.1.1.1.cmml">(</mo><mrow id="A2.Ex2.m1.5.5.1.1.1.1.1.1.1" xref="A2.Ex2.m1.5.5.1.1.1.1.1.1.1.cmml"><mn id="A2.Ex2.m1.5.5.1.1.1.1.1.1.1.2" xref="A2.Ex2.m1.5.5.1.1.1.1.1.1.1.2.cmml">1</mn><mo id="A2.Ex2.m1.5.5.1.1.1.1.1.1.1.1" xref="A2.Ex2.m1.5.5.1.1.1.1.1.1.1.1.cmml">−</mo><mi id="A2.Ex2.m1.5.5.1.1.1.1.1.1.1.3" xref="A2.Ex2.m1.5.5.1.1.1.1.1.1.1.3.cmml">α</mi></mrow><mo stretchy="false" id="A2.Ex2.m1.5.5.1.1.1.1.1.1.3" xref="A2.Ex2.m1.5.5.1.1.1.1.1.1.1.cmml">)</mo></mrow><mo lspace="0.170em" rspace="0em" id="A2.Ex2.m1.5.5.1.1.1.1.2" xref="A2.Ex2.m1.5.5.1.1.1.1.2.cmml">​</mo><msubsup id="A2.Ex2.m1.5.5.1.1.1.1.3" xref="A2.Ex2.m1.5.5.1.1.1.1.3.cmml"><mi id="A2.Ex2.m1.5.5.1.1.1.1.3.2.2" xref="A2.Ex2.m1.5.5.1.1.1.1.3.2.2.cmml">δ</mi><mi id="A2.Ex2.m1.5.5.1.1.1.1.3.2.3" xref="A2.Ex2.m1.5.5.1.1.1.1.3.2.3.cmml">i</mi><mi id="A2.Ex2.m1.5.5.1.1.1.1.3.3" xref="A2.Ex2.m1.5.5.1.1.1.1.3.3.cmml">t</mi></msubsup><mo lspace="0em" rspace="0em" id="A2.Ex2.m1.5.5.1.1.1.1.2a" xref="A2.Ex2.m1.5.5.1.1.1.1.2.cmml">​</mo><mfrac id="A2.Ex2.m1.2.2" xref="A2.Ex2.m1.2.2.cmml"><msub id="A2.Ex2.m1.1.1.1" xref="A2.Ex2.m1.1.1.1.cmml"><mrow id="A2.Ex2.m1.1.1.1.1.1" xref="A2.Ex2.m1.1.1.1.1.2.cmml"><mo stretchy="false" id="A2.Ex2.m1.1.1.1.1.1.2" xref="A2.Ex2.m1.1.1.1.1.2.1.cmml">‖</mo><msubsup id="A2.Ex2.m1.1.1.1.1.1.1" xref="A2.Ex2.m1.1.1.1.1.1.1.cmml"><mi id="A2.Ex2.m1.1.1.1.1.1.1.2.2" xref="A2.Ex2.m1.1.1.1.1.1.1.2.2.cmml">g</mi><mi id="A2.Ex2.m1.1.1.1.1.1.1.2.3" xref="A2.Ex2.m1.1.1.1.1.1.1.2.3.cmml">i</mi><mi id="A2.Ex2.m1.1.1.1.1.1.1.3" xref="A2.Ex2.m1.1.1.1.1.1.1.3.cmml">t</mi></msubsup><mo stretchy="false" id="A2.Ex2.m1.1.1.1.1.1.3" xref="A2.Ex2.m1.1.1.1.1.2.1.cmml">‖</mo></mrow><mn id="A2.Ex2.m1.1.1.1.3" xref="A2.Ex2.m1.1.1.1.3.cmml">2</mn></msub><msub id="A2.Ex2.m1.2.2.2" xref="A2.Ex2.m1.2.2.2.cmml"><mrow id="A2.Ex2.m1.2.2.2.1.1" xref="A2.Ex2.m1.2.2.2.1.2.cmml"><mo stretchy="false" id="A2.Ex2.m1.2.2.2.1.1.2" xref="A2.Ex2.m1.2.2.2.1.2.1.cmml">‖</mo><msubsup id="A2.Ex2.m1.2.2.2.1.1.1" xref="A2.Ex2.m1.2.2.2.1.1.1.cmml"><mi id="A2.Ex2.m1.2.2.2.1.1.1.2.2" xref="A2.Ex2.m1.2.2.2.1.1.1.2.2.cmml">δ</mi><mi id="A2.Ex2.m1.2.2.2.1.1.1.2.3" xref="A2.Ex2.m1.2.2.2.1.1.1.2.3.cmml">i</mi><mi id="A2.Ex2.m1.2.2.2.1.1.1.3" xref="A2.Ex2.m1.2.2.2.1.1.1.3.cmml">t</mi></msubsup><mo stretchy="false" id="A2.Ex2.m1.2.2.2.1.1.3" xref="A2.Ex2.m1.2.2.2.1.2.1.cmml">‖</mo></mrow><mn id="A2.Ex2.m1.2.2.2.3" xref="A2.Ex2.m1.2.2.2.3.cmml">2</mn></msub></mfrac></mrow></mrow></mrow><mo lspace="0.170em" rspace="0.337em" id="A2.Ex2.m1.6.6.2.3" xref="A2.Ex2.m1.6.6.3a.cmml">,</mo><mrow id="A2.Ex2.m1.6.6.2.2" xref="A2.Ex2.m1.6.6.2.2.cmml"><mi id="A2.Ex2.m1.6.6.2.2.2" xref="A2.Ex2.m1.6.6.2.2.2.cmml">i</mi><mo id="A2.Ex2.m1.6.6.2.2.1" xref="A2.Ex2.m1.6.6.2.2.1.cmml">∈</mo><mrow id="A2.Ex2.m1.6.6.2.2.3.2" xref="A2.Ex2.m1.6.6.2.2.3.1.cmml"><mo stretchy="false" id="A2.Ex2.m1.6.6.2.2.3.2.1" xref="A2.Ex2.m1.6.6.2.2.3.1.cmml">{</mo><mi id="A2.Ex2.m1.3.3" xref="A2.Ex2.m1.3.3.cmml">L</mi><mo id="A2.Ex2.m1.6.6.2.2.3.2.2" xref="A2.Ex2.m1.6.6.2.2.3.1.cmml">,</mo><mi id="A2.Ex2.m1.4.4" xref="A2.Ex2.m1.4.4.cmml">H</mi><mo stretchy="false" id="A2.Ex2.m1.6.6.2.2.3.2.3" xref="A2.Ex2.m1.6.6.2.2.3.1.cmml">}</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="A2.Ex2.m1.6b"><apply id="A2.Ex2.m1.6.6.3.cmml" xref="A2.Ex2.m1.6.6.2"><csymbol cd="ambiguous" id="A2.Ex2.m1.6.6.3a.cmml" xref="A2.Ex2.m1.6.6.2.3">formulae-sequence</csymbol><apply id="A2.Ex2.m1.5.5.1.1.cmml" xref="A2.Ex2.m1.5.5.1.1"><ci id="A2.Ex2.m1.5.5.1.1.2.cmml" xref="A2.Ex2.m1.5.5.1.1.2">←</ci><apply id="A2.Ex2.m1.5.5.1.1.3.cmml" xref="A2.Ex2.m1.5.5.1.1.3"><csymbol cd="ambiguous" id="A2.Ex2.m1.5.5.1.1.3.1.cmml" xref="A2.Ex2.m1.5.5.1.1.3">subscript</csymbol><apply id="A2.Ex2.m1.5.5.1.1.3.2.cmml" xref="A2.Ex2.m1.5.5.1.1.3"><csymbol cd="ambiguous" id="A2.Ex2.m1.5.5.1.1.3.2.1.cmml" xref="A2.Ex2.m1.5.5.1.1.3">superscript</csymbol><ci id="A2.Ex2.m1.5.5.1.1.3.2.2.cmml" xref="A2.Ex2.m1.5.5.1.1.3.2.2">Δ</ci><ci id="A2.Ex2.m1.5.5.1.1.3.2.3.cmml" xref="A2.Ex2.m1.5.5.1.1.3.2.3">𝑡</ci></apply><ci id="A2.Ex2.m1.5.5.1.1.3.3.cmml" xref="A2.Ex2.m1.5.5.1.1.3.3">𝑖</ci></apply><apply id="A2.Ex2.m1.5.5.1.1.1.cmml" xref="A2.Ex2.m1.5.5.1.1.1"><plus id="A2.Ex2.m1.5.5.1.1.1.2.cmml" xref="A2.Ex2.m1.5.5.1.1.1.2"></plus><apply id="A2.Ex2.m1.5.5.1.1.1.3.cmml" xref="A2.Ex2.m1.5.5.1.1.1.3"><times id="A2.Ex2.m1.5.5.1.1.1.3.1.cmml" xref="A2.Ex2.m1.5.5.1.1.1.3.1"></times><ci id="A2.Ex2.m1.5.5.1.1.1.3.2.cmml" xref="A2.Ex2.m1.5.5.1.1.1.3.2">𝛼</ci><apply id="A2.Ex2.m1.5.5.1.1.1.3.3.cmml" xref="A2.Ex2.m1.5.5.1.1.1.3.3"><csymbol cd="ambiguous" id="A2.Ex2.m1.5.5.1.1.1.3.3.1.cmml" xref="A2.Ex2.m1.5.5.1.1.1.3.3">subscript</csymbol><apply id="A2.Ex2.m1.5.5.1.1.1.3.3.2.cmml" xref="A2.Ex2.m1.5.5.1.1.1.3.3"><csymbol cd="ambiguous" id="A2.Ex2.m1.5.5.1.1.1.3.3.2.1.cmml" xref="A2.Ex2.m1.5.5.1.1.1.3.3">superscript</csymbol><ci id="A2.Ex2.m1.5.5.1.1.1.3.3.2.2.cmml" xref="A2.Ex2.m1.5.5.1.1.1.3.3.2.2">𝑔</ci><ci id="A2.Ex2.m1.5.5.1.1.1.3.3.2.3.cmml" xref="A2.Ex2.m1.5.5.1.1.1.3.3.2.3">𝑡</ci></apply><ci id="A2.Ex2.m1.5.5.1.1.1.3.3.3.cmml" xref="A2.Ex2.m1.5.5.1.1.1.3.3.3">𝑖</ci></apply></apply><apply id="A2.Ex2.m1.5.5.1.1.1.1.cmml" xref="A2.Ex2.m1.5.5.1.1.1.1"><times id="A2.Ex2.m1.5.5.1.1.1.1.2.cmml" xref="A2.Ex2.m1.5.5.1.1.1.1.2"></times><apply id="A2.Ex2.m1.5.5.1.1.1.1.1.1.1.cmml" xref="A2.Ex2.m1.5.5.1.1.1.1.1.1"><minus id="A2.Ex2.m1.5.5.1.1.1.1.1.1.1.1.cmml" xref="A2.Ex2.m1.5.5.1.1.1.1.1.1.1.1"></minus><cn type="integer" id="A2.Ex2.m1.5.5.1.1.1.1.1.1.1.2.cmml" xref="A2.Ex2.m1.5.5.1.1.1.1.1.1.1.2">1</cn><ci id="A2.Ex2.m1.5.5.1.1.1.1.1.1.1.3.cmml" xref="A2.Ex2.m1.5.5.1.1.1.1.1.1.1.3">𝛼</ci></apply><apply id="A2.Ex2.m1.5.5.1.1.1.1.3.cmml" xref="A2.Ex2.m1.5.5.1.1.1.1.3"><csymbol cd="ambiguous" id="A2.Ex2.m1.5.5.1.1.1.1.3.1.cmml" xref="A2.Ex2.m1.5.5.1.1.1.1.3">superscript</csymbol><apply id="A2.Ex2.m1.5.5.1.1.1.1.3.2.cmml" xref="A2.Ex2.m1.5.5.1.1.1.1.3"><csymbol cd="ambiguous" id="A2.Ex2.m1.5.5.1.1.1.1.3.2.1.cmml" xref="A2.Ex2.m1.5.5.1.1.1.1.3">subscript</csymbol><ci id="A2.Ex2.m1.5.5.1.1.1.1.3.2.2.cmml" xref="A2.Ex2.m1.5.5.1.1.1.1.3.2.2">𝛿</ci><ci id="A2.Ex2.m1.5.5.1.1.1.1.3.2.3.cmml" xref="A2.Ex2.m1.5.5.1.1.1.1.3.2.3">𝑖</ci></apply><ci id="A2.Ex2.m1.5.5.1.1.1.1.3.3.cmml" xref="A2.Ex2.m1.5.5.1.1.1.1.3.3">𝑡</ci></apply><apply id="A2.Ex2.m1.2.2.cmml" xref="A2.Ex2.m1.2.2"><divide id="A2.Ex2.m1.2.2.3.cmml" xref="A2.Ex2.m1.2.2"></divide><apply id="A2.Ex2.m1.1.1.1.cmml" xref="A2.Ex2.m1.1.1.1"><csymbol cd="ambiguous" id="A2.Ex2.m1.1.1.1.2.cmml" xref="A2.Ex2.m1.1.1.1">subscript</csymbol><apply id="A2.Ex2.m1.1.1.1.1.2.cmml" xref="A2.Ex2.m1.1.1.1.1.1"><csymbol cd="latexml" id="A2.Ex2.m1.1.1.1.1.2.1.cmml" xref="A2.Ex2.m1.1.1.1.1.1.2">norm</csymbol><apply id="A2.Ex2.m1.1.1.1.1.1.1.cmml" xref="A2.Ex2.m1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="A2.Ex2.m1.1.1.1.1.1.1.1.cmml" xref="A2.Ex2.m1.1.1.1.1.1.1">superscript</csymbol><apply id="A2.Ex2.m1.1.1.1.1.1.1.2.cmml" xref="A2.Ex2.m1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="A2.Ex2.m1.1.1.1.1.1.1.2.1.cmml" xref="A2.Ex2.m1.1.1.1.1.1.1">subscript</csymbol><ci id="A2.Ex2.m1.1.1.1.1.1.1.2.2.cmml" xref="A2.Ex2.m1.1.1.1.1.1.1.2.2">𝑔</ci><ci id="A2.Ex2.m1.1.1.1.1.1.1.2.3.cmml" xref="A2.Ex2.m1.1.1.1.1.1.1.2.3">𝑖</ci></apply><ci id="A2.Ex2.m1.1.1.1.1.1.1.3.cmml" xref="A2.Ex2.m1.1.1.1.1.1.1.3">𝑡</ci></apply></apply><cn type="integer" id="A2.Ex2.m1.1.1.1.3.cmml" xref="A2.Ex2.m1.1.1.1.3">2</cn></apply><apply id="A2.Ex2.m1.2.2.2.cmml" xref="A2.Ex2.m1.2.2.2"><csymbol cd="ambiguous" id="A2.Ex2.m1.2.2.2.2.cmml" xref="A2.Ex2.m1.2.2.2">subscript</csymbol><apply id="A2.Ex2.m1.2.2.2.1.2.cmml" xref="A2.Ex2.m1.2.2.2.1.1"><csymbol cd="latexml" id="A2.Ex2.m1.2.2.2.1.2.1.cmml" xref="A2.Ex2.m1.2.2.2.1.1.2">norm</csymbol><apply id="A2.Ex2.m1.2.2.2.1.1.1.cmml" xref="A2.Ex2.m1.2.2.2.1.1.1"><csymbol cd="ambiguous" id="A2.Ex2.m1.2.2.2.1.1.1.1.cmml" xref="A2.Ex2.m1.2.2.2.1.1.1">superscript</csymbol><apply id="A2.Ex2.m1.2.2.2.1.1.1.2.cmml" xref="A2.Ex2.m1.2.2.2.1.1.1"><csymbol cd="ambiguous" id="A2.Ex2.m1.2.2.2.1.1.1.2.1.cmml" xref="A2.Ex2.m1.2.2.2.1.1.1">subscript</csymbol><ci id="A2.Ex2.m1.2.2.2.1.1.1.2.2.cmml" xref="A2.Ex2.m1.2.2.2.1.1.1.2.2">𝛿</ci><ci id="A2.Ex2.m1.2.2.2.1.1.1.2.3.cmml" xref="A2.Ex2.m1.2.2.2.1.1.1.2.3">𝑖</ci></apply><ci id="A2.Ex2.m1.2.2.2.1.1.1.3.cmml" xref="A2.Ex2.m1.2.2.2.1.1.1.3">𝑡</ci></apply></apply><cn type="integer" id="A2.Ex2.m1.2.2.2.3.cmml" xref="A2.Ex2.m1.2.2.2.3">2</cn></apply></apply></apply></apply></apply><apply id="A2.Ex2.m1.6.6.2.2.cmml" xref="A2.Ex2.m1.6.6.2.2"><in id="A2.Ex2.m1.6.6.2.2.1.cmml" xref="A2.Ex2.m1.6.6.2.2.1"></in><ci id="A2.Ex2.m1.6.6.2.2.2.cmml" xref="A2.Ex2.m1.6.6.2.2.2">𝑖</ci><set id="A2.Ex2.m1.6.6.2.2.3.1.cmml" xref="A2.Ex2.m1.6.6.2.2.3.2"><ci id="A2.Ex2.m1.3.3.cmml" xref="A2.Ex2.m1.3.3">𝐿</ci><ci id="A2.Ex2.m1.4.4.cmml" xref="A2.Ex2.m1.4.4">𝐻</ci></set></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A2.Ex2.m1.6c">\Delta^{t}_{i}\leftarrow\alpha\,g^{t}_{i}+(1-\alpha)\,\delta_{i}^{t}\,\frac{\|g_{i}^{t}\|_{2}}{\|\delta_{i}^{t}\|_{2}}\,,\,i\in\{L,H\}</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
</div>
<div id="alg2.l9" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg2.l9.1.1.1" class="ltx_text" style="font-size:80%;">9:</span></span>     Apply <span id="alg2.l9.2" class="ltx_text ltx_font_smallcaps">FedAvg</span> on <math id="alg2.l9.m1.1" class="ltx_Math" alttext="\theta^{t}_{i}" display="inline"><semantics id="alg2.l9.m1.1a"><msubsup id="alg2.l9.m1.1.1" xref="alg2.l9.m1.1.1.cmml"><mi id="alg2.l9.m1.1.1.2.2" xref="alg2.l9.m1.1.1.2.2.cmml">θ</mi><mi id="alg2.l9.m1.1.1.3" xref="alg2.l9.m1.1.1.3.cmml">i</mi><mi id="alg2.l9.m1.1.1.2.3" xref="alg2.l9.m1.1.1.2.3.cmml">t</mi></msubsup><annotation-xml encoding="MathML-Content" id="alg2.l9.m1.1b"><apply id="alg2.l9.m1.1.1.cmml" xref="alg2.l9.m1.1.1"><csymbol cd="ambiguous" id="alg2.l9.m1.1.1.1.cmml" xref="alg2.l9.m1.1.1">subscript</csymbol><apply id="alg2.l9.m1.1.1.2.cmml" xref="alg2.l9.m1.1.1"><csymbol cd="ambiguous" id="alg2.l9.m1.1.1.2.1.cmml" xref="alg2.l9.m1.1.1">superscript</csymbol><ci id="alg2.l9.m1.1.1.2.2.cmml" xref="alg2.l9.m1.1.1.2.2">𝜃</ci><ci id="alg2.l9.m1.1.1.2.3.cmml" xref="alg2.l9.m1.1.1.2.3">𝑡</ci></apply><ci id="alg2.l9.m1.1.1.3.cmml" xref="alg2.l9.m1.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.l9.m1.1c">\theta^{t}_{i}</annotation></semantics></math> using <math id="alg2.l9.m2.1" class="ltx_Math" alttext="\Delta^{t}_{i}" display="inline"><semantics id="alg2.l9.m2.1a"><msubsup id="alg2.l9.m2.1.1" xref="alg2.l9.m2.1.1.cmml"><mi mathvariant="normal" id="alg2.l9.m2.1.1.2.2" xref="alg2.l9.m2.1.1.2.2.cmml">Δ</mi><mi id="alg2.l9.m2.1.1.3" xref="alg2.l9.m2.1.1.3.cmml">i</mi><mi id="alg2.l9.m2.1.1.2.3" xref="alg2.l9.m2.1.1.2.3.cmml">t</mi></msubsup><annotation-xml encoding="MathML-Content" id="alg2.l9.m2.1b"><apply id="alg2.l9.m2.1.1.cmml" xref="alg2.l9.m2.1.1"><csymbol cd="ambiguous" id="alg2.l9.m2.1.1.1.cmml" xref="alg2.l9.m2.1.1">subscript</csymbol><apply id="alg2.l9.m2.1.1.2.cmml" xref="alg2.l9.m2.1.1"><csymbol cd="ambiguous" id="alg2.l9.m2.1.1.2.1.cmml" xref="alg2.l9.m2.1.1">superscript</csymbol><ci id="alg2.l9.m2.1.1.2.2.cmml" xref="alg2.l9.m2.1.1.2.2">Δ</ci><ci id="alg2.l9.m2.1.1.2.3.cmml" xref="alg2.l9.m2.1.1.2.3">𝑡</ci></apply><ci id="alg2.l9.m2.1.1.3.cmml" xref="alg2.l9.m2.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.l9.m2.1c">\Delta^{t}_{i}</annotation></semantics></math> as the gradient to find <math id="alg2.l9.m3.1" class="ltx_Math" alttext="\theta^{t+1}_{i}" display="inline"><semantics id="alg2.l9.m3.1a"><msubsup id="alg2.l9.m3.1.1" xref="alg2.l9.m3.1.1.cmml"><mi id="alg2.l9.m3.1.1.2.2" xref="alg2.l9.m3.1.1.2.2.cmml">θ</mi><mi id="alg2.l9.m3.1.1.3" xref="alg2.l9.m3.1.1.3.cmml">i</mi><mrow id="alg2.l9.m3.1.1.2.3" xref="alg2.l9.m3.1.1.2.3.cmml"><mi id="alg2.l9.m3.1.1.2.3.2" xref="alg2.l9.m3.1.1.2.3.2.cmml">t</mi><mo id="alg2.l9.m3.1.1.2.3.1" xref="alg2.l9.m3.1.1.2.3.1.cmml">+</mo><mn id="alg2.l9.m3.1.1.2.3.3" xref="alg2.l9.m3.1.1.2.3.3.cmml">1</mn></mrow></msubsup><annotation-xml encoding="MathML-Content" id="alg2.l9.m3.1b"><apply id="alg2.l9.m3.1.1.cmml" xref="alg2.l9.m3.1.1"><csymbol cd="ambiguous" id="alg2.l9.m3.1.1.1.cmml" xref="alg2.l9.m3.1.1">subscript</csymbol><apply id="alg2.l9.m3.1.1.2.cmml" xref="alg2.l9.m3.1.1"><csymbol cd="ambiguous" id="alg2.l9.m3.1.1.2.1.cmml" xref="alg2.l9.m3.1.1">superscript</csymbol><ci id="alg2.l9.m3.1.1.2.2.cmml" xref="alg2.l9.m3.1.1.2.2">𝜃</ci><apply id="alg2.l9.m3.1.1.2.3.cmml" xref="alg2.l9.m3.1.1.2.3"><plus id="alg2.l9.m3.1.1.2.3.1.cmml" xref="alg2.l9.m3.1.1.2.3.1"></plus><ci id="alg2.l9.m3.1.1.2.3.2.cmml" xref="alg2.l9.m3.1.1.2.3.2">𝑡</ci><cn type="integer" id="alg2.l9.m3.1.1.2.3.3.cmml" xref="alg2.l9.m3.1.1.2.3.3">1</cn></apply></apply><ci id="alg2.l9.m3.1.1.3.cmml" xref="alg2.l9.m3.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.l9.m3.1c">\theta^{t+1}_{i}</annotation></semantics></math>, where <math id="alg2.l9.m4.2" class="ltx_Math" alttext="i\in\{L,H\}" display="inline"><semantics id="alg2.l9.m4.2a"><mrow id="alg2.l9.m4.2.3" xref="alg2.l9.m4.2.3.cmml"><mi id="alg2.l9.m4.2.3.2" xref="alg2.l9.m4.2.3.2.cmml">i</mi><mo id="alg2.l9.m4.2.3.1" xref="alg2.l9.m4.2.3.1.cmml">∈</mo><mrow id="alg2.l9.m4.2.3.3.2" xref="alg2.l9.m4.2.3.3.1.cmml"><mo stretchy="false" id="alg2.l9.m4.2.3.3.2.1" xref="alg2.l9.m4.2.3.3.1.cmml">{</mo><mi id="alg2.l9.m4.1.1" xref="alg2.l9.m4.1.1.cmml">L</mi><mo id="alg2.l9.m4.2.3.3.2.2" xref="alg2.l9.m4.2.3.3.1.cmml">,</mo><mi id="alg2.l9.m4.2.2" xref="alg2.l9.m4.2.2.cmml">H</mi><mo stretchy="false" id="alg2.l9.m4.2.3.3.2.3" xref="alg2.l9.m4.2.3.3.1.cmml">}</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg2.l9.m4.2b"><apply id="alg2.l9.m4.2.3.cmml" xref="alg2.l9.m4.2.3"><in id="alg2.l9.m4.2.3.1.cmml" xref="alg2.l9.m4.2.3.1"></in><ci id="alg2.l9.m4.2.3.2.cmml" xref="alg2.l9.m4.2.3.2">𝑖</ci><set id="alg2.l9.m4.2.3.3.1.cmml" xref="alg2.l9.m4.2.3.3.2"><ci id="alg2.l9.m4.1.1.cmml" xref="alg2.l9.m4.1.1">𝐿</ci><ci id="alg2.l9.m4.2.2.cmml" xref="alg2.l9.m4.2.2">𝐻</ci></set></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.l9.m4.2c">i\in\{L,H\}</annotation></semantics></math>

</div>
<div id="alg2.l10" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg2.l10.1.1.1" class="ltx_text" style="font-size:80%;">10:</span></span>  <span id="alg2.l10.2" class="ltx_text ltx_font_bold">end</span> <span id="alg2.l10.3" class="ltx_text ltx_font_bold">for</span>
</div>
<div id="alg2.l10a" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg2.l10a.1.1.1" class="ltx_text" style="font-size:80%;">10:</span></span>  <math id="alg2.l10a.m1.1" class="ltx_Math" alttext="\theta_{L}^{T}" display="inline"><semantics id="alg2.l10a.m1.1a"><msubsup id="alg2.l10a.m1.1.1" xref="alg2.l10a.m1.1.1.cmml"><mi id="alg2.l10a.m1.1.1.2.2" xref="alg2.l10a.m1.1.1.2.2.cmml">θ</mi><mi id="alg2.l10a.m1.1.1.2.3" xref="alg2.l10a.m1.1.1.2.3.cmml">L</mi><mi id="alg2.l10a.m1.1.1.3" xref="alg2.l10a.m1.1.1.3.cmml">T</mi></msubsup><annotation-xml encoding="MathML-Content" id="alg2.l10a.m1.1b"><apply id="alg2.l10a.m1.1.1.cmml" xref="alg2.l10a.m1.1.1"><csymbol cd="ambiguous" id="alg2.l10a.m1.1.1.1.cmml" xref="alg2.l10a.m1.1.1">superscript</csymbol><apply id="alg2.l10a.m1.1.1.2.cmml" xref="alg2.l10a.m1.1.1"><csymbol cd="ambiguous" id="alg2.l10a.m1.1.1.2.1.cmml" xref="alg2.l10a.m1.1.1">subscript</csymbol><ci id="alg2.l10a.m1.1.1.2.2.cmml" xref="alg2.l10a.m1.1.1.2.2">𝜃</ci><ci id="alg2.l10a.m1.1.1.2.3.cmml" xref="alg2.l10a.m1.1.1.2.3">𝐿</ci></apply><ci id="alg2.l10a.m1.1.1.3.cmml" xref="alg2.l10a.m1.1.1.3">𝑇</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.l10a.m1.1c">\theta_{L}^{T}</annotation></semantics></math>, <math id="alg2.l10a.m2.1" class="ltx_Math" alttext="\theta_{H}^{T}" display="inline"><semantics id="alg2.l10a.m2.1a"><msubsup id="alg2.l10a.m2.1.1" xref="alg2.l10a.m2.1.1.cmml"><mi id="alg2.l10a.m2.1.1.2.2" xref="alg2.l10a.m2.1.1.2.2.cmml">θ</mi><mi id="alg2.l10a.m2.1.1.2.3" xref="alg2.l10a.m2.1.1.2.3.cmml">H</mi><mi id="alg2.l10a.m2.1.1.3" xref="alg2.l10a.m2.1.1.3.cmml">T</mi></msubsup><annotation-xml encoding="MathML-Content" id="alg2.l10a.m2.1b"><apply id="alg2.l10a.m2.1.1.cmml" xref="alg2.l10a.m2.1.1"><csymbol cd="ambiguous" id="alg2.l10a.m2.1.1.1.cmml" xref="alg2.l10a.m2.1.1">superscript</csymbol><apply id="alg2.l10a.m2.1.1.2.cmml" xref="alg2.l10a.m2.1.1"><csymbol cd="ambiguous" id="alg2.l10a.m2.1.1.2.1.cmml" xref="alg2.l10a.m2.1.1">subscript</csymbol><ci id="alg2.l10a.m2.1.1.2.2.cmml" xref="alg2.l10a.m2.1.1.2.2">𝜃</ci><ci id="alg2.l10a.m2.1.1.2.3.cmml" xref="alg2.l10a.m2.1.1.2.3">𝐻</ci></apply><ci id="alg2.l10a.m2.1.1.3.cmml" xref="alg2.l10a.m2.1.1.3">𝑇</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.l10a.m2.1c">\theta_{H}^{T}</annotation></semantics></math>

</div>
</div>
</figure>
<figure id="A2.F2" class="ltx_figure">
<div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_2">
<figure id="A2.F2.1.1" class="ltx_figure ltx_figure_panel ltx_align_center"><img src="/html/2310.02549/assets/x3.png" id="A2.F2.1.1.g1" class="ltx_graphics ltx_img_square" width="161" height="161" alt="Refer to caption">
</figure>
</div>
<div class="ltx_flex_cell ltx_flex_size_2">
<figure id="A2.F2.2.2" class="ltx_figure ltx_figure_panel ltx_align_center"><img src="/html/2310.02549/assets/x4.png" id="A2.F2.2.2.g1" class="ltx_graphics ltx_img_square" width="161" height="161" alt="Refer to caption">
</figure>
</div>
</div>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 2: </span>
(a) An illustration of the <span id="A2.F2.14.1" class="ltx_text ltx_font_smallcaps">PeriodicCodist</span> approach in the weight space. After <math id="A2.F2.6.6.m1.1" class="ltx_Math" alttext="p=3" display="inline"><semantics id="A2.F2.6.6.m1.1b"><mrow id="A2.F2.6.6.m1.1.1" xref="A2.F2.6.6.m1.1.1.cmml"><mi id="A2.F2.6.6.m1.1.1.2" xref="A2.F2.6.6.m1.1.1.2.cmml">p</mi><mo id="A2.F2.6.6.m1.1.1.1" xref="A2.F2.6.6.m1.1.1.1.cmml">=</mo><mn id="A2.F2.6.6.m1.1.1.3" xref="A2.F2.6.6.m1.1.1.3.cmml">3</mn></mrow><annotation-xml encoding="MathML-Content" id="A2.F2.6.6.m1.1c"><apply id="A2.F2.6.6.m1.1.1.cmml" xref="A2.F2.6.6.m1.1.1"><eq id="A2.F2.6.6.m1.1.1.1.cmml" xref="A2.F2.6.6.m1.1.1.1"></eq><ci id="A2.F2.6.6.m1.1.1.2.cmml" xref="A2.F2.6.6.m1.1.1.2">𝑝</ci><cn type="integer" id="A2.F2.6.6.m1.1.1.3.cmml" xref="A2.F2.6.6.m1.1.1.3">3</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A2.F2.6.6.m1.1d">p=3</annotation></semantics></math> <span id="A2.F2.15.2" class="ltx_text ltx_font_smallcaps">FedAvg</span> steps, we apply a round of co-distillation for <math id="A2.F2.7.7.m2.1" class="ltx_Math" alttext="s=15" display="inline"><semantics id="A2.F2.7.7.m2.1b"><mrow id="A2.F2.7.7.m2.1.1" xref="A2.F2.7.7.m2.1.1.cmml"><mi id="A2.F2.7.7.m2.1.1.2" xref="A2.F2.7.7.m2.1.1.2.cmml">s</mi><mo id="A2.F2.7.7.m2.1.1.1" xref="A2.F2.7.7.m2.1.1.1.cmml">=</mo><mn id="A2.F2.7.7.m2.1.1.3" xref="A2.F2.7.7.m2.1.1.3.cmml">15</mn></mrow><annotation-xml encoding="MathML-Content" id="A2.F2.7.7.m2.1c"><apply id="A2.F2.7.7.m2.1.1.cmml" xref="A2.F2.7.7.m2.1.1"><eq id="A2.F2.7.7.m2.1.1.1.cmml" xref="A2.F2.7.7.m2.1.1.1"></eq><ci id="A2.F2.7.7.m2.1.1.2.cmml" xref="A2.F2.7.7.m2.1.1.2">𝑠</ci><cn type="integer" id="A2.F2.7.7.m2.1.1.3.cmml" xref="A2.F2.7.7.m2.1.1.3">15</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A2.F2.7.7.m2.1d">s=15</annotation></semantics></math> steps by using the other model as a teacher. The <span id="A2.F2.16.3" class="ltx_text ltx_font_smallcaps">FedAvg</span> resumes after the co-distillation round. (b) An illustration of the <span id="A2.F2.17.4" class="ltx_text ltx_font_smallcaps">MergedCodist</span> approach. In each round, we merge the scaled distillation direction (by calculating the distillation direction after <math id="A2.F2.8.8.m3.1" class="ltx_Math" alttext="s=15" display="inline"><semantics id="A2.F2.8.8.m3.1b"><mrow id="A2.F2.8.8.m3.1.1" xref="A2.F2.8.8.m3.1.1.cmml"><mi id="A2.F2.8.8.m3.1.1.2" xref="A2.F2.8.8.m3.1.1.2.cmml">s</mi><mo id="A2.F2.8.8.m3.1.1.1" xref="A2.F2.8.8.m3.1.1.1.cmml">=</mo><mn id="A2.F2.8.8.m3.1.1.3" xref="A2.F2.8.8.m3.1.1.3.cmml">15</mn></mrow><annotation-xml encoding="MathML-Content" id="A2.F2.8.8.m3.1c"><apply id="A2.F2.8.8.m3.1.1.cmml" xref="A2.F2.8.8.m3.1.1"><eq id="A2.F2.8.8.m3.1.1.1.cmml" xref="A2.F2.8.8.m3.1.1.1"></eq><ci id="A2.F2.8.8.m3.1.1.2.cmml" xref="A2.F2.8.8.m3.1.1.2">𝑠</ci><cn type="integer" id="A2.F2.8.8.m3.1.1.3.cmml" xref="A2.F2.8.8.m3.1.1.3">15</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A2.F2.8.8.m3.1d">s=15</annotation></semantics></math> steps) with the <span id="A2.F2.18.5" class="ltx_text ltx_font_smallcaps">FedAvg</span> direction before applying the update to the model.</figcaption>
</figure>
<div class="ltx_pagination ltx_role_newpage"></div>
</section>
<section id="A3" class="ltx_appendix">
<h2 class="ltx_title ltx_title_appendix">
<span class="ltx_tag ltx_tag_appendix">Appendix C </span>Experiment Setup</h2>

<figure id="A3.T3" class="ltx_table">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_table">Table 3: </span>Dataset sizes used for the experiments. The distillation datasets for federated CIFAR-100 and StackOverflow are excised from the original datasets’ training split, as is the held-out set for CIFAR-100. StackOverflow has default held-out and test sets of <math id="A3.T3.2.m1.1" class="ltx_Math" alttext="\sim" display="inline"><semantics id="A3.T3.2.m1.1b"><mo id="A3.T3.2.m1.1.1" xref="A3.T3.2.m1.1.1.cmml">∼</mo><annotation-xml encoding="MathML-Content" id="A3.T3.2.m1.1c"><csymbol cd="latexml" id="A3.T3.2.m1.1.1.cmml" xref="A3.T3.2.m1.1.1">similar-to</csymbol></annotation-xml><annotation encoding="application/x-tex" id="A3.T3.2.m1.1d">\sim</annotation></semantics></math>16M examples each. From each, we draw 5,000 and 100,000 examples for tuning and evaluation, respectively.</figcaption>
<table id="A3.T3.3" class="ltx_tabular ltx_centering ltx_guessed_headers ltx_align_middle">
<thead class="ltx_thead">
<tr id="A3.T3.3.1.1" class="ltx_tr">
<th id="A3.T3.3.1.1.1" class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_border_r ltx_border_tt" rowspan="2"><span id="A3.T3.3.1.1.1.1" class="ltx_text ltx_font_smallcaps" style="font-size:90%;">Dataset</span></th>
<th id="A3.T3.3.1.1.2" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_r ltx_border_tt"><span id="A3.T3.3.1.1.2.1" class="ltx_text ltx_font_smallcaps" style="font-size:90%;">Distillation</span></th>
<th id="A3.T3.3.1.1.3" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" colspan="2"><span id="A3.T3.3.1.1.3.1" class="ltx_text ltx_font_smallcaps" style="font-size:90%;">Federated Pool</span></th>
<th id="A3.T3.3.1.1.4" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_l ltx_border_tt"><span id="A3.T3.3.1.1.4.1" class="ltx_text ltx_font_smallcaps" style="font-size:90%;">Held Out</span></th>
<th id="A3.T3.3.1.1.5" class="ltx_td ltx_align_right ltx_th ltx_th_column ltx_border_l ltx_border_tt"><span id="A3.T3.3.1.1.5.1" class="ltx_text ltx_font_smallcaps" style="font-size:90%;">Test</span></th>
</tr>
<tr id="A3.T3.3.2.2" class="ltx_tr">
<th id="A3.T3.3.2.2.1" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_r"><span id="A3.T3.3.2.2.1.1" class="ltx_text ltx_font_smallcaps" style="font-size:90%;">Examples</span></th>
<th id="A3.T3.3.2.2.2" class="ltx_td ltx_align_center ltx_th ltx_th_column"><span id="A3.T3.3.2.2.2.1" class="ltx_text ltx_font_smallcaps" style="font-size:90%;">Clients</span></th>
<th id="A3.T3.3.2.2.3" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_r"><span id="A3.T3.3.2.2.3.1" class="ltx_text ltx_font_smallcaps" style="font-size:90%;">Examples</span></th>
<th id="A3.T3.3.2.2.4" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_r"><span id="A3.T3.3.2.2.4.1" class="ltx_text ltx_font_smallcaps" style="font-size:90%;">Examples</span></th>
<th id="A3.T3.3.2.2.5" class="ltx_td ltx_align_right ltx_th ltx_th_column"><span id="A3.T3.3.2.2.5.1" class="ltx_text ltx_font_smallcaps" style="font-size:90%;">Examples</span></th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr id="A3.T3.3.3.1" class="ltx_tr">
<td id="A3.T3.3.3.1.1" class="ltx_td ltx_align_left ltx_border_r ltx_border_t"><span id="A3.T3.3.3.1.1.1" class="ltx_text ltx_font_smallcaps" style="font-size:90%;">CIFAR-100</span></td>
<td id="A3.T3.3.3.1.2" class="ltx_td ltx_align_center ltx_border_r ltx_border_t"><span id="A3.T3.3.3.1.2.1" class="ltx_text ltx_font_smallcaps" style="font-size:90%;">13,500</span></td>
<td id="A3.T3.3.3.1.3" class="ltx_td ltx_align_center ltx_border_t"><span id="A3.T3.3.3.1.3.1" class="ltx_text ltx_font_smallcaps" style="font-size:90%;">315</span></td>
<td id="A3.T3.3.3.1.4" class="ltx_td ltx_align_center ltx_border_r ltx_border_t"><span id="A3.T3.3.3.1.4.1" class="ltx_text ltx_font_smallcaps" style="font-size:90%;">31,500</span></td>
<td id="A3.T3.3.3.1.5" class="ltx_td ltx_align_center ltx_border_r ltx_border_t"><span id="A3.T3.3.3.1.5.1" class="ltx_text ltx_font_smallcaps" style="font-size:90%;">5,000</span></td>
<td id="A3.T3.3.3.1.6" class="ltx_td ltx_align_right ltx_border_t"><span id="A3.T3.3.3.1.6.1" class="ltx_text ltx_font_smallcaps" style="font-size:90%;">10,000</span></td>
</tr>
<tr id="A3.T3.3.4.2" class="ltx_tr">
<td id="A3.T3.3.4.2.1" class="ltx_td ltx_align_left ltx_border_r"><span id="A3.T3.3.4.2.1.1" class="ltx_text ltx_font_smallcaps" style="font-size:90%;">CIFAR-10</span></td>
<td id="A3.T3.3.4.2.2" class="ltx_td ltx_align_center ltx_border_r"><span id="A3.T3.3.4.2.2.1" class="ltx_text ltx_font_smallcaps" style="font-size:90%;">50,000</span></td>
<td id="A3.T3.3.4.2.3" class="ltx_td"></td>
<td id="A3.T3.3.4.2.4" class="ltx_td ltx_border_r"></td>
<td id="A3.T3.3.4.2.5" class="ltx_td ltx_border_r"></td>
<td id="A3.T3.3.4.2.6" class="ltx_td"></td>
</tr>
<tr id="A3.T3.3.5.3" class="ltx_tr">
<td id="A3.T3.3.5.3.1" class="ltx_td ltx_align_left ltx_border_r ltx_border_t"><span id="A3.T3.3.5.3.1.1" class="ltx_text ltx_font_smallcaps" style="font-size:90%;">StackOverflow</span></td>
<td id="A3.T3.3.5.3.2" class="ltx_td ltx_align_center ltx_border_r ltx_border_t"><span id="A3.T3.3.5.3.2.1" class="ltx_text ltx_font_smallcaps" style="font-size:90%;">122,250,952</span></td>
<td id="A3.T3.3.5.3.3" class="ltx_td ltx_align_center ltx_border_t"><span id="A3.T3.3.5.3.3.1" class="ltx_text ltx_font_smallcaps" style="font-size:90%;">34,248</span></td>
<td id="A3.T3.3.5.3.4" class="ltx_td ltx_align_center ltx_border_r ltx_border_t"><span id="A3.T3.3.5.3.4.1" class="ltx_text ltx_font_smallcaps" style="font-size:90%;">13,567,778</span></td>
<td id="A3.T3.3.5.3.5" class="ltx_td ltx_align_center ltx_border_r ltx_border_t"><span id="A3.T3.3.5.3.5.1" class="ltx_text ltx_font_smallcaps" style="font-size:90%;">100,000</span></td>
<td id="A3.T3.3.5.3.6" class="ltx_td ltx_align_right ltx_border_t"><span id="A3.T3.3.5.3.6.1" class="ltx_text ltx_font_smallcaps" style="font-size:90%;">100,000</span></td>
</tr>
<tr id="A3.T3.3.6.4" class="ltx_tr">
<td id="A3.T3.3.6.4.1" class="ltx_td ltx_align_left ltx_border_bb ltx_border_r"><span id="A3.T3.3.6.4.1.1" class="ltx_text ltx_font_smallcaps" style="font-size:90%;">C4-mod</span></td>
<td id="A3.T3.3.6.4.2" class="ltx_td ltx_align_center ltx_border_bb ltx_border_r"><span id="A3.T3.3.6.4.2.1" class="ltx_text ltx_font_smallcaps" style="font-size:90%;">4,488,694</span></td>
<td id="A3.T3.3.6.4.3" class="ltx_td ltx_border_bb"></td>
<td id="A3.T3.3.6.4.4" class="ltx_td ltx_border_bb ltx_border_r"></td>
<td id="A3.T3.3.6.4.5" class="ltx_td ltx_border_bb ltx_border_r"></td>
<td id="A3.T3.3.6.4.6" class="ltx_td ltx_border_bb"></td>
</tr>
</tbody>
</table>
</figure>
<div id="A3.p1" class="ltx_para">
<p id="A3.p1.1" class="ltx_p">To evaluate <span id="A3.p1.1.1" class="ltx_text ltx_font_smallcaps">PeriodicCodist</span> and <span id="A3.p1.1.2" class="ltx_text ltx_font_smallcaps">MergedCodist</span>, we run experiments on the tasks of image classification and language modeling, comparing against a baseline of <span id="A3.p1.1.3" class="ltx_text ltx_font_smallcaps">FedAvg</span>. For image classification experiments, we use the federated version of the CIFAR-100 dataset<span id="footnote2" class="ltx_note ltx_role_footnote"><sup class="ltx_note_mark">2</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">2</sup><span class="ltx_tag ltx_tag_note">2</span><a target="_blank" href="https://www.tensorflow.org/federated/api_docs/python/tff/simulation/datasets/cifar100" title="" class="ltx_ref ltx_url ltx_font_typewriter" style="font-size:50%;">https://www.tensorflow.org/federated/api_docs/python/tff/simulation/datasets/cifar100</a></span></span></span> <cite class="ltx_cite ltx_citemacro_citep">(Krizhevsky et al., <a href="#bib.bib17" title="" class="ltx_ref">2009</a>)</cite>, supplemented by CIFAR-10 as out-of-domain distillation data. For language modeling, we use federated Stack Overflow (SO)<span id="footnote3" class="ltx_note ltx_role_footnote"><sup class="ltx_note_mark">3</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">3</sup><span class="ltx_tag ltx_tag_note">3</span><a target="_blank" href="https://www.tensorflow.org/federated/api_docs/python/tff/simulation/datasets/stackoverflow" title="" class="ltx_ref ltx_url ltx_font_typewriter" style="font-size:50%;">https://www.tensorflow.org/federated/api_docs/python/tff/simulation/datasets/stackoverflow</a></span></span></span>, which we supplement with out-of-domain distillation data drawn from the C4 <cite class="ltx_cite ltx_citemacro_citep">(Raffel et al., <a href="#bib.bib28" title="" class="ltx_ref">2020</a>)</cite> dataset and modified to match the casing and tokenization of the SO data; we refer to this as C4-MOD. All dataset sizes are shown in Table <a href="#A3.T3" title="Table 3 ‣ Appendix C Experiment Setup ‣ Heterogeneous Federated Learning Using Knowledge Codistillation" class="ltx_ref"><span class="ltx_text ltx_ref_tag">3</span></a>. For both CIFAR-100 and SO datasets, we hold out 10% of the original train split as validation data.</p>
</div>
<div id="A3.p2" class="ltx_para">
<p id="A3.p2.1" class="ltx_p">All experiments are run in the FedJax framework <cite class="ltx_cite ltx_citemacro_citep">(Ro et al., <a href="#bib.bib30" title="" class="ltx_ref">2021</a>)</cite>, and all hyper-parameters are tuned on the held-out sets through the Vizier hyper-parameter tuning service<span id="footnote4" class="ltx_note ltx_role_footnote"><sup class="ltx_note_mark">4</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">4</sup><span class="ltx_tag ltx_tag_note">4</span><a target="_blank" href="https://cloud.google.com/ai-platform/optimizer/docs/overview" title="" class="ltx_ref ltx_url ltx_font_typewriter" style="font-size:50%;">https://cloud.google.com/ai-platform/optimizer/docs/overview</a></span></span></span> <cite class="ltx_cite ltx_citemacro_citep">(Golovin et al., <a href="#bib.bib9" title="" class="ltx_ref">2017</a>)</cite> with default settings, to a max of 1024 trials.<span id="footnote5" class="ltx_note ltx_role_footnote"><sup class="ltx_note_mark">5</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">5</sup><span class="ltx_tag ltx_tag_note">5</span>Details of hyper-parameter tuning are shown in Appendix <a href="#A6" title="Appendix F Hyper-Parameter Tuning ‣ Heterogeneous Federated Learning Using Knowledge Codistillation" class="ltx_ref"><span class="ltx_text ltx_ref_tag">F</span></a>.</span></span></span> As all experiment runs have both ‘small’ (low-capacity) and ‘large’ (high-capacity) server models, we tune hyper-parameters to maximize the average accuracy of the two models on the held-out set.</p>
</div>
<figure id="A3.T4" class="ltx_table">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_table">Table 4: </span>Data splits for the initial set of experiments.</figcaption>
<table id="A3.T4.2.2" class="ltx_tabular ltx_centering ltx_guessed_headers ltx_align_middle">
<tbody class="ltx_tbody">
<tr id="A3.T4.2.2.3.1" class="ltx_tr">
<th id="A3.T4.2.2.3.1.1" class="ltx_td ltx_th ltx_th_row ltx_border_r ltx_border_tt"></th>
<th id="A3.T4.2.2.3.1.2" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r ltx_border_tt"><span id="A3.T4.2.2.3.1.2.1" class="ltx_text ltx_font_smallcaps" style="font-size:90%;">distillation data</span></th>
<td id="A3.T4.2.2.3.1.3" class="ltx_td ltx_align_center ltx_border_tt" colspan="4"><span id="A3.T4.2.2.3.1.3.1" class="ltx_text ltx_font_smallcaps" style="font-size:90%;">federated pools</span></td>
</tr>
<tr id="A3.T4.2.2.2" class="ltx_tr">
<th id="A3.T4.2.2.2.3" class="ltx_td ltx_th ltx_th_row ltx_border_r"></th>
<th id="A3.T4.2.2.2.4" class="ltx_td ltx_th ltx_th_row ltx_border_r"></th>
<td id="A3.T4.1.1.1.1" class="ltx_td ltx_align_center ltx_border_r" colspan="2">
<span id="A3.T4.1.1.1.1.1" class="ltx_text ltx_font_smallcaps" style="font-size:90%;">full pool (</span><math id="A3.T4.1.1.1.1.m1.1" class="ltx_Math" alttext="\mathcal{P}" display="inline"><semantics id="A3.T4.1.1.1.1.m1.1a"><mi class="ltx_font_mathcaligraphic" mathsize="90%" id="A3.T4.1.1.1.1.m1.1.1" xref="A3.T4.1.1.1.1.m1.1.1.cmml">𝒫</mi><annotation-xml encoding="MathML-Content" id="A3.T4.1.1.1.1.m1.1b"><ci id="A3.T4.1.1.1.1.m1.1.1.cmml" xref="A3.T4.1.1.1.1.m1.1.1">𝒫</ci></annotation-xml><annotation encoding="application/x-tex" id="A3.T4.1.1.1.1.m1.1c">\mathcal{P}</annotation></semantics></math><span id="A3.T4.1.1.1.1.2" class="ltx_text ltx_font_smallcaps" style="font-size:90%;">)</span>
</td>
<td id="A3.T4.2.2.2.2" class="ltx_td ltx_align_center" colspan="2">
<span id="A3.T4.2.2.2.2.1" class="ltx_text ltx_font_smallcaps" style="font-size:90%;">high-capacity (</span><math id="A3.T4.2.2.2.2.m1.1" class="ltx_Math" alttext="\mathcal{P}_{H}" display="inline"><semantics id="A3.T4.2.2.2.2.m1.1a"><msub id="A3.T4.2.2.2.2.m1.1.1" xref="A3.T4.2.2.2.2.m1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" mathsize="90%" id="A3.T4.2.2.2.2.m1.1.1.2" xref="A3.T4.2.2.2.2.m1.1.1.2.cmml">𝒫</mi><mi mathsize="90%" id="A3.T4.2.2.2.2.m1.1.1.3" xref="A3.T4.2.2.2.2.m1.1.1.3.cmml">H</mi></msub><annotation-xml encoding="MathML-Content" id="A3.T4.2.2.2.2.m1.1b"><apply id="A3.T4.2.2.2.2.m1.1.1.cmml" xref="A3.T4.2.2.2.2.m1.1.1"><csymbol cd="ambiguous" id="A3.T4.2.2.2.2.m1.1.1.1.cmml" xref="A3.T4.2.2.2.2.m1.1.1">subscript</csymbol><ci id="A3.T4.2.2.2.2.m1.1.1.2.cmml" xref="A3.T4.2.2.2.2.m1.1.1.2">𝒫</ci><ci id="A3.T4.2.2.2.2.m1.1.1.3.cmml" xref="A3.T4.2.2.2.2.m1.1.1.3">𝐻</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A3.T4.2.2.2.2.m1.1c">\mathcal{P}_{H}</annotation></semantics></math><span id="A3.T4.2.2.2.2.2" class="ltx_text ltx_font_smallcaps" style="font-size:90%;">)</span>
</td>
</tr>
<tr id="A3.T4.2.2.4.2" class="ltx_tr">
<th id="A3.T4.2.2.4.2.1" class="ltx_td ltx_th ltx_th_row ltx_border_r"></th>
<th id="A3.T4.2.2.4.2.2" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r"><span id="A3.T4.2.2.4.2.2.1" class="ltx_text ltx_font_smallcaps" style="font-size:90%;">examples</span></th>
<td id="A3.T4.2.2.4.2.3" class="ltx_td ltx_align_center"><span id="A3.T4.2.2.4.2.3.1" class="ltx_text ltx_font_smallcaps" style="font-size:90%;">clients</span></td>
<td id="A3.T4.2.2.4.2.4" class="ltx_td ltx_align_center ltx_border_r"><span id="A3.T4.2.2.4.2.4.1" class="ltx_text ltx_font_smallcaps" style="font-size:90%;">examples</span></td>
<td id="A3.T4.2.2.4.2.5" class="ltx_td ltx_align_center"><span id="A3.T4.2.2.4.2.5.1" class="ltx_text ltx_font_smallcaps" style="font-size:90%;">clients</span></td>
<td id="A3.T4.2.2.4.2.6" class="ltx_td ltx_align_center"><span id="A3.T4.2.2.4.2.6.1" class="ltx_text ltx_font_smallcaps" style="font-size:90%;">examples</span></td>
</tr>
<tr id="A3.T4.2.2.5.3" class="ltx_tr">
<th id="A3.T4.2.2.5.3.1" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r ltx_border_t"><span id="A3.T4.2.2.5.3.1.1" class="ltx_text ltx_font_smallcaps" style="font-size:90%;">CIFAR</span></th>
<th id="A3.T4.2.2.5.3.2" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r ltx_border_t"><span id="A3.T4.2.2.5.3.2.1" class="ltx_text ltx_font_smallcaps" style="font-size:90%;">13,500</span></th>
<td id="A3.T4.2.2.5.3.3" class="ltx_td ltx_align_center ltx_border_t"><span id="A3.T4.2.2.5.3.3.1" class="ltx_text ltx_font_smallcaps" style="font-size:90%;">315</span></td>
<td id="A3.T4.2.2.5.3.4" class="ltx_td ltx_align_center ltx_border_r ltx_border_t"><span id="A3.T4.2.2.5.3.4.1" class="ltx_text ltx_font_smallcaps" style="font-size:90%;">31,500</span></td>
<td id="A3.T4.2.2.5.3.5" class="ltx_td ltx_align_center ltx_border_t"><span id="A3.T4.2.2.5.3.5.1" class="ltx_text ltx_font_smallcaps" style="font-size:90%;">47</span></td>
<td id="A3.T4.2.2.5.3.6" class="ltx_td ltx_align_center ltx_border_t"><span id="A3.T4.2.2.5.3.6.1" class="ltx_text ltx_font_smallcaps" style="font-size:90%;">4700</span></td>
</tr>
<tr id="A3.T4.2.2.6.4" class="ltx_tr">
<th id="A3.T4.2.2.6.4.1" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_bb ltx_border_r"><span id="A3.T4.2.2.6.4.1.1" class="ltx_text ltx_font_smallcaps" style="font-size:90%;">StackOverflow</span></th>
<th id="A3.T4.2.2.6.4.2" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_bb ltx_border_r"><span id="A3.T4.2.2.6.4.2.1" class="ltx_text ltx_font_smallcaps" style="font-size:90%;">122,250,952</span></th>
<td id="A3.T4.2.2.6.4.3" class="ltx_td ltx_align_center ltx_border_bb"><span id="A3.T4.2.2.6.4.3.1" class="ltx_text ltx_font_smallcaps" style="font-size:90%;">34,248</span></td>
<td id="A3.T4.2.2.6.4.4" class="ltx_td ltx_align_center ltx_border_bb ltx_border_r"><span id="A3.T4.2.2.6.4.4.1" class="ltx_text ltx_font_smallcaps" style="font-size:90%;">13,567,778</span></td>
<td id="A3.T4.2.2.6.4.5" class="ltx_td ltx_align_center ltx_border_bb"><span id="A3.T4.2.2.6.4.5.1" class="ltx_text ltx_font_smallcaps" style="font-size:90%;">684</span></td>
<td id="A3.T4.2.2.6.4.6" class="ltx_td ltx_align_center ltx_border_bb"><span id="A3.T4.2.2.6.4.6.1" class="ltx_text ltx_font_smallcaps" style="font-size:90%;">296,597</span></td>
</tr>
</tbody>
</table>
</figure>
<section id="A3.SS1" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">C.1 </span>Image Classification</h3>

<div id="A3.SS1.p1" class="ltx_para">
<p id="A3.SS1.p1.1" class="ltx_p">For the CIFAR-10 and CIFAR-100 datasets, we pre-process all examples with the default settings in FedJAX; all images are centered and normalized, and training images are randomly cropped and horizontally flipped. When using the data for distillation, we apply additional random flipping, which may be vertical or horizontal, and mixup <cite class="ltx_cite ltx_citemacro_citep">(Zhang et al., <a href="#bib.bib37" title="" class="ltx_ref">2017</a>)</cite> with <math id="A3.SS1.p1.1.m1.1" class="ltx_Math" alttext="\beta=2" display="inline"><semantics id="A3.SS1.p1.1.m1.1a"><mrow id="A3.SS1.p1.1.m1.1.1" xref="A3.SS1.p1.1.m1.1.1.cmml"><mi id="A3.SS1.p1.1.m1.1.1.2" xref="A3.SS1.p1.1.m1.1.1.2.cmml">β</mi><mo id="A3.SS1.p1.1.m1.1.1.1" xref="A3.SS1.p1.1.m1.1.1.1.cmml">=</mo><mn id="A3.SS1.p1.1.m1.1.1.3" xref="A3.SS1.p1.1.m1.1.1.3.cmml">2</mn></mrow><annotation-xml encoding="MathML-Content" id="A3.SS1.p1.1.m1.1b"><apply id="A3.SS1.p1.1.m1.1.1.cmml" xref="A3.SS1.p1.1.m1.1.1"><eq id="A3.SS1.p1.1.m1.1.1.1.cmml" xref="A3.SS1.p1.1.m1.1.1.1"></eq><ci id="A3.SS1.p1.1.m1.1.1.2.cmml" xref="A3.SS1.p1.1.m1.1.1.2">𝛽</ci><cn type="integer" id="A3.SS1.p1.1.m1.1.1.3.cmml" xref="A3.SS1.p1.1.m1.1.1.3">2</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A3.SS1.p1.1.m1.1c">\beta=2</annotation></semantics></math>.</p>
</div>
<div id="A3.SS1.p2" class="ltx_para">
<p id="A3.SS1.p2.1" class="ltx_p">For all image classification experiments, we train Convolutional Neural Network (CNNs) <cite class="ltx_cite ltx_citemacro_citep">(Goodfellow et al., <a href="#bib.bib10" title="" class="ltx_ref">2016</a>)</cite> with five layers; for the model trained on the high-capacity pool, hereon the ‘large’ model, we train with approx 410k parameters. For the model trained on the low-capacity pool, hereon the ‘small’ model, we train with approx 109k parameters. The details of the model architectures are given in Appendix <a href="#A5" title="Appendix E Model Architectures ‣ Heterogeneous Federated Learning Using Knowledge Codistillation" class="ltx_ref"><span class="ltx_text ltx_ref_tag">E</span></a>.</p>
</div>
</section>
<section id="A3.SS2" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">C.2 </span>Language Modeling</h3>

<div id="A3.SS2.p1" class="ltx_para">
<p id="A3.SS2.p1.1" class="ltx_p">For the StackOverflow dataset, we tokenize with a lower-cased 4k word-piece model <cite class="ltx_cite ltx_citemacro_citep">(Schuster &amp; Nakajima, <a href="#bib.bib32" title="" class="ltx_ref">2012</a>)</cite> fit to the training split. To render the C4 data in the same format as the SO data, we pre-process the C4 dataset by lower-casing and word-tokenizing the first sentence from each C4 example paragraph.<span id="footnote6" class="ltx_note ltx_role_footnote"><sup class="ltx_note_mark">6</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">6</sup><span class="ltx_tag ltx_tag_note">6</span>Word and sentence tokenization via NLTK <cite class="ltx_cite ltx_citemacro_citep">(Bird et al., <a href="#bib.bib6" title="" class="ltx_ref">2009</a>)</cite></span></span></span> We additionally correct the remaining differences to the SO tokenization by replacing a small hand-coded list of incorrectly tokenized contractions.<span id="footnote7" class="ltx_note ltx_role_footnote"><sup class="ltx_note_mark">7</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">7</sup><span class="ltx_tag ltx_tag_note">7</span>This list is shown in Appendix <a href="#A7" title="Appendix G Contractions for C4-MOD tokenization ‣ Heterogeneous Federated Learning Using Knowledge Codistillation" class="ltx_ref"><span class="ltx_text ltx_ref_tag">G</span></a></span></span></span> As the full C4 dataset is substantially larger than what we require for distillation data, we draw from it a subset of 4.5M examples. We train LSTMs <cite class="ltx_cite ltx_citemacro_citep">(Hochreiter &amp; Schmidhuber, <a href="#bib.bib12" title="" class="ltx_ref">1997</a>)</cite> with one layer for the ‘small’ model and two layers for the ‘large’ model.
For the ‘large’ model, we train with approx 4.3M parameters and the ‘small’ with approx 2M parameters. The details of the model architectures are given in Appendix <a href="#A5" title="Appendix E Model Architectures ‣ Heterogeneous Federated Learning Using Knowledge Codistillation" class="ltx_ref"><span class="ltx_text ltx_ref_tag">E</span></a>.</p>
</div>
<div id="A3.SS2.p2" class="ltx_para">
<p id="A3.SS2.p2.1" class="ltx_p">For the language modeling runs, rather than using the entire default held-out and test sets with <math id="A3.SS2.p2.1.m1.1" class="ltx_Math" alttext="\sim" display="inline"><semantics id="A3.SS2.p2.1.m1.1a"><mo id="A3.SS2.p2.1.m1.1.1" xref="A3.SS2.p2.1.m1.1.1.cmml">∼</mo><annotation-xml encoding="MathML-Content" id="A3.SS2.p2.1.m1.1b"><csymbol cd="latexml" id="A3.SS2.p2.1.m1.1.1.cmml" xref="A3.SS2.p2.1.m1.1.1">similar-to</csymbol></annotation-xml><annotation encoding="application/x-tex" id="A3.SS2.p2.1.m1.1c">\sim</annotation></semantics></math>16M examples, we draw 100k examples from each. We tune hyperparameters on the held-out set and report accuracy on the test set. To simulate a practical federated learning setting that is constrained in both modeling capacity and data availability, in all experiments, we use only a subset of the federated training pool of the StackOverflow dataset, leaving the remainder of examples unused, or for use as in-domain distillation data.</p>
</div>
</section>
<section id="A3.SS3" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">C.3 </span>Federated Averaging Baseline</h3>

<div id="A3.SS3.p1" class="ltx_para">
<p id="A3.SS3.p1.1" class="ltx_p">For all experiments, we use a set of shared <span id="A3.SS3.p1.1.1" class="ltx_text ltx_font_smallcaps">FedAvg</span> settings. All experiments are run for 1500 federated rounds, sampling 20 clients per round. The clients are optimized with SGD with a constant learning rate. We set the client batch size to 20; all clients train locally for one epoch. We optimize the server models with FedAdam <cite class="ltx_cite ltx_citemacro_citep">(Kingma &amp; Ba, <a href="#bib.bib16" title="" class="ltx_ref">2014</a>; Reddi et al., <a href="#bib.bib29" title="" class="ltx_ref">2021</a>)</cite>, using the default hyper-parameters,<span id="footnote8" class="ltx_note ltx_role_footnote"><sup class="ltx_note_mark">8</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">8</sup><span class="ltx_tag ltx_tag_note">8</span><math id="footnote8.m1.1" class="ltx_Math" alttext="\beta_{1}=" display="inline"><semantics id="footnote8.m1.1b"><mrow id="footnote8.m1.1.1" xref="footnote8.m1.1.1.cmml"><msub id="footnote8.m1.1.1.2" xref="footnote8.m1.1.1.2.cmml"><mi id="footnote8.m1.1.1.2.2" xref="footnote8.m1.1.1.2.2.cmml">β</mi><mn id="footnote8.m1.1.1.2.3" xref="footnote8.m1.1.1.2.3.cmml">1</mn></msub><mo id="footnote8.m1.1.1.1" xref="footnote8.m1.1.1.1.cmml">=</mo><mi id="footnote8.m1.1.1.3" xref="footnote8.m1.1.1.3.cmml"></mi></mrow><annotation-xml encoding="MathML-Content" id="footnote8.m1.1c"><apply id="footnote8.m1.1.1.cmml" xref="footnote8.m1.1.1"><eq id="footnote8.m1.1.1.1.cmml" xref="footnote8.m1.1.1.1"></eq><apply id="footnote8.m1.1.1.2.cmml" xref="footnote8.m1.1.1.2"><csymbol cd="ambiguous" id="footnote8.m1.1.1.2.1.cmml" xref="footnote8.m1.1.1.2">subscript</csymbol><ci id="footnote8.m1.1.1.2.2.cmml" xref="footnote8.m1.1.1.2.2">𝛽</ci><cn type="integer" id="footnote8.m1.1.1.2.3.cmml" xref="footnote8.m1.1.1.2.3">1</cn></apply><csymbol cd="latexml" id="footnote8.m1.1.1.3.cmml" xref="footnote8.m1.1.1.3">absent</csymbol></apply></annotation-xml><annotation encoding="application/x-tex" id="footnote8.m1.1d">\beta_{1}=</annotation></semantics></math>  0.9, <math id="footnote8.m2.1" class="ltx_Math" alttext="\beta_{2}=\,\," display="inline"><semantics id="footnote8.m2.1b"><mrow id="footnote8.m2.1.1" xref="footnote8.m2.1.1.cmml"><msub id="footnote8.m2.1.1.2" xref="footnote8.m2.1.1.2.cmml"><mi id="footnote8.m2.1.1.2.2" xref="footnote8.m2.1.1.2.2.cmml">β</mi><mn id="footnote8.m2.1.1.2.3" xref="footnote8.m2.1.1.2.3.cmml">2</mn></msub><mo rspace="0.608em" id="footnote8.m2.1.1.1" xref="footnote8.m2.1.1.1.cmml">=</mo><mi id="footnote8.m2.1.1.3" xref="footnote8.m2.1.1.3.cmml"></mi></mrow><annotation-xml encoding="MathML-Content" id="footnote8.m2.1c"><apply id="footnote8.m2.1.1.cmml" xref="footnote8.m2.1.1"><eq id="footnote8.m2.1.1.1.cmml" xref="footnote8.m2.1.1.1"></eq><apply id="footnote8.m2.1.1.2.cmml" xref="footnote8.m2.1.1.2"><csymbol cd="ambiguous" id="footnote8.m2.1.1.2.1.cmml" xref="footnote8.m2.1.1.2">subscript</csymbol><ci id="footnote8.m2.1.1.2.2.cmml" xref="footnote8.m2.1.1.2.2">𝛽</ci><cn type="integer" id="footnote8.m2.1.1.2.3.cmml" xref="footnote8.m2.1.1.2.3">2</cn></apply><csymbol cd="latexml" id="footnote8.m2.1.1.3.cmml" xref="footnote8.m2.1.1.3">absent</csymbol></apply></annotation-xml><annotation encoding="application/x-tex" id="footnote8.m2.1d">\beta_{2}=\,\,</annotation></semantics></math>0.999, <math id="footnote8.m3.1" class="ltx_Math" alttext="\epsilon=" display="inline"><semantics id="footnote8.m3.1b"><mrow id="footnote8.m3.1.1" xref="footnote8.m3.1.1.cmml"><mi id="footnote8.m3.1.1.2" xref="footnote8.m3.1.1.2.cmml">ϵ</mi><mo id="footnote8.m3.1.1.1" xref="footnote8.m3.1.1.1.cmml">=</mo><mi id="footnote8.m3.1.1.3" xref="footnote8.m3.1.1.3.cmml"></mi></mrow><annotation-xml encoding="MathML-Content" id="footnote8.m3.1c"><apply id="footnote8.m3.1.1.cmml" xref="footnote8.m3.1.1"><eq id="footnote8.m3.1.1.1.cmml" xref="footnote8.m3.1.1.1"></eq><ci id="footnote8.m3.1.1.2.cmml" xref="footnote8.m3.1.1.2">italic-ϵ</ci><csymbol cd="latexml" id="footnote8.m3.1.1.3.cmml" xref="footnote8.m3.1.1.3">absent</csymbol></apply></annotation-xml><annotation encoding="application/x-tex" id="footnote8.m3.1d">\epsilon=</annotation></semantics></math>  1e-5</span></span></span> and with separate tuned learning rates for the large and small models. We use a linearly decaying learning rate (with a zero final value) over the course of the federated rounds.</p>
</div>
</section>
<section id="A3.SS4" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">C.4 </span>Distillation</h3>

<div id="A3.SS4.p1" class="ltx_para">
<p id="A3.SS4.p1.9" class="ltx_p">For each teacher model, we tune a softmax temperature parameter <math id="A3.SS4.p1.1.m1.1" class="ltx_Math" alttext="T&gt;0" display="inline"><semantics id="A3.SS4.p1.1.m1.1a"><mrow id="A3.SS4.p1.1.m1.1.1" xref="A3.SS4.p1.1.m1.1.1.cmml"><mi id="A3.SS4.p1.1.m1.1.1.2" xref="A3.SS4.p1.1.m1.1.1.2.cmml">T</mi><mo id="A3.SS4.p1.1.m1.1.1.1" xref="A3.SS4.p1.1.m1.1.1.1.cmml">&gt;</mo><mn id="A3.SS4.p1.1.m1.1.1.3" xref="A3.SS4.p1.1.m1.1.1.3.cmml">0</mn></mrow><annotation-xml encoding="MathML-Content" id="A3.SS4.p1.1.m1.1b"><apply id="A3.SS4.p1.1.m1.1.1.cmml" xref="A3.SS4.p1.1.m1.1.1"><gt id="A3.SS4.p1.1.m1.1.1.1.cmml" xref="A3.SS4.p1.1.m1.1.1.1"></gt><ci id="A3.SS4.p1.1.m1.1.1.2.cmml" xref="A3.SS4.p1.1.m1.1.1.2">𝑇</ci><cn type="integer" id="A3.SS4.p1.1.m1.1.1.3.cmml" xref="A3.SS4.p1.1.m1.1.1.3">0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A3.SS4.p1.1.m1.1c">T&gt;0</annotation></semantics></math>
which may either sharpen (when <math id="A3.SS4.p1.2.m2.1" class="ltx_Math" alttext="T&lt;1" display="inline"><semantics id="A3.SS4.p1.2.m2.1a"><mrow id="A3.SS4.p1.2.m2.1.1" xref="A3.SS4.p1.2.m2.1.1.cmml"><mi id="A3.SS4.p1.2.m2.1.1.2" xref="A3.SS4.p1.2.m2.1.1.2.cmml">T</mi><mo id="A3.SS4.p1.2.m2.1.1.1" xref="A3.SS4.p1.2.m2.1.1.1.cmml">&lt;</mo><mn id="A3.SS4.p1.2.m2.1.1.3" xref="A3.SS4.p1.2.m2.1.1.3.cmml">1</mn></mrow><annotation-xml encoding="MathML-Content" id="A3.SS4.p1.2.m2.1b"><apply id="A3.SS4.p1.2.m2.1.1.cmml" xref="A3.SS4.p1.2.m2.1.1"><lt id="A3.SS4.p1.2.m2.1.1.1.cmml" xref="A3.SS4.p1.2.m2.1.1.1"></lt><ci id="A3.SS4.p1.2.m2.1.1.2.cmml" xref="A3.SS4.p1.2.m2.1.1.2">𝑇</ci><cn type="integer" id="A3.SS4.p1.2.m2.1.1.3.cmml" xref="A3.SS4.p1.2.m2.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A3.SS4.p1.2.m2.1c">T&lt;1</annotation></semantics></math>) or smooth (when <math id="A3.SS4.p1.3.m3.1" class="ltx_Math" alttext="T&gt;1" display="inline"><semantics id="A3.SS4.p1.3.m3.1a"><mrow id="A3.SS4.p1.3.m3.1.1" xref="A3.SS4.p1.3.m3.1.1.cmml"><mi id="A3.SS4.p1.3.m3.1.1.2" xref="A3.SS4.p1.3.m3.1.1.2.cmml">T</mi><mo id="A3.SS4.p1.3.m3.1.1.1" xref="A3.SS4.p1.3.m3.1.1.1.cmml">&gt;</mo><mn id="A3.SS4.p1.3.m3.1.1.3" xref="A3.SS4.p1.3.m3.1.1.3.cmml">1</mn></mrow><annotation-xml encoding="MathML-Content" id="A3.SS4.p1.3.m3.1b"><apply id="A3.SS4.p1.3.m3.1.1.cmml" xref="A3.SS4.p1.3.m3.1.1"><gt id="A3.SS4.p1.3.m3.1.1.1.cmml" xref="A3.SS4.p1.3.m3.1.1.1"></gt><ci id="A3.SS4.p1.3.m3.1.1.2.cmml" xref="A3.SS4.p1.3.m3.1.1.2">𝑇</ci><cn type="integer" id="A3.SS4.p1.3.m3.1.1.3.cmml" xref="A3.SS4.p1.3.m3.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A3.SS4.p1.3.m3.1c">T&gt;1</annotation></semantics></math>) the output probability distribution: <math id="A3.SS4.p1.4.m4.5" class="ltx_Math" alttext="p(y_{i})=\frac{\exp\left(\frac{z_{i}}{T}\right)}{\sum_{j}\exp\left(\frac{z_{j}}{T}\right)}" display="inline"><semantics id="A3.SS4.p1.4.m4.5a"><mrow id="A3.SS4.p1.4.m4.5.5" xref="A3.SS4.p1.4.m4.5.5.cmml"><mrow id="A3.SS4.p1.4.m4.5.5.1" xref="A3.SS4.p1.4.m4.5.5.1.cmml"><mi id="A3.SS4.p1.4.m4.5.5.1.3" xref="A3.SS4.p1.4.m4.5.5.1.3.cmml">p</mi><mo lspace="0em" rspace="0em" id="A3.SS4.p1.4.m4.5.5.1.2" xref="A3.SS4.p1.4.m4.5.5.1.2.cmml">​</mo><mrow id="A3.SS4.p1.4.m4.5.5.1.1.1" xref="A3.SS4.p1.4.m4.5.5.1.1.1.1.cmml"><mo stretchy="false" id="A3.SS4.p1.4.m4.5.5.1.1.1.2" xref="A3.SS4.p1.4.m4.5.5.1.1.1.1.cmml">(</mo><msub id="A3.SS4.p1.4.m4.5.5.1.1.1.1" xref="A3.SS4.p1.4.m4.5.5.1.1.1.1.cmml"><mi id="A3.SS4.p1.4.m4.5.5.1.1.1.1.2" xref="A3.SS4.p1.4.m4.5.5.1.1.1.1.2.cmml">y</mi><mi id="A3.SS4.p1.4.m4.5.5.1.1.1.1.3" xref="A3.SS4.p1.4.m4.5.5.1.1.1.1.3.cmml">i</mi></msub><mo stretchy="false" id="A3.SS4.p1.4.m4.5.5.1.1.1.3" xref="A3.SS4.p1.4.m4.5.5.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="A3.SS4.p1.4.m4.5.5.2" xref="A3.SS4.p1.4.m4.5.5.2.cmml">=</mo><mfrac id="A3.SS4.p1.4.m4.4.4" xref="A3.SS4.p1.4.m4.4.4.cmml"><mrow id="A3.SS4.p1.4.m4.2.2.2.4" xref="A3.SS4.p1.4.m4.2.2.2.3.cmml"><mi id="A3.SS4.p1.4.m4.1.1.1.1" xref="A3.SS4.p1.4.m4.1.1.1.1.cmml">exp</mi><mo id="A3.SS4.p1.4.m4.2.2.2.4a" xref="A3.SS4.p1.4.m4.2.2.2.3.cmml">⁡</mo><mrow id="A3.SS4.p1.4.m4.2.2.2.4.1" xref="A3.SS4.p1.4.m4.2.2.2.3.cmml"><mo id="A3.SS4.p1.4.m4.2.2.2.4.1.1" xref="A3.SS4.p1.4.m4.2.2.2.3.cmml">(</mo><mfrac id="A3.SS4.p1.4.m4.2.2.2.2" xref="A3.SS4.p1.4.m4.2.2.2.2.cmml"><msub id="A3.SS4.p1.4.m4.2.2.2.2.2" xref="A3.SS4.p1.4.m4.2.2.2.2.2.cmml"><mi id="A3.SS4.p1.4.m4.2.2.2.2.2.2" xref="A3.SS4.p1.4.m4.2.2.2.2.2.2.cmml">z</mi><mi id="A3.SS4.p1.4.m4.2.2.2.2.2.3" xref="A3.SS4.p1.4.m4.2.2.2.2.2.3.cmml">i</mi></msub><mi id="A3.SS4.p1.4.m4.2.2.2.2.3" xref="A3.SS4.p1.4.m4.2.2.2.2.3.cmml">T</mi></mfrac><mo id="A3.SS4.p1.4.m4.2.2.2.4.1.2" xref="A3.SS4.p1.4.m4.2.2.2.3.cmml">)</mo></mrow></mrow><mrow id="A3.SS4.p1.4.m4.4.4.4" xref="A3.SS4.p1.4.m4.4.4.4.cmml"><mstyle displaystyle="false" id="A3.SS4.p1.4.m4.4.4.4.3" xref="A3.SS4.p1.4.m4.4.4.4.3.cmml"><msub id="A3.SS4.p1.4.m4.4.4.4.3a" xref="A3.SS4.p1.4.m4.4.4.4.3.cmml"><mo id="A3.SS4.p1.4.m4.4.4.4.3.2" xref="A3.SS4.p1.4.m4.4.4.4.3.2.cmml">∑</mo><mi id="A3.SS4.p1.4.m4.4.4.4.3.3" xref="A3.SS4.p1.4.m4.4.4.4.3.3.cmml">j</mi></msub></mstyle><mrow id="A3.SS4.p1.4.m4.4.4.4.4.2" xref="A3.SS4.p1.4.m4.4.4.4.4.1.cmml"><mi id="A3.SS4.p1.4.m4.3.3.3.1" xref="A3.SS4.p1.4.m4.3.3.3.1.cmml">exp</mi><mo id="A3.SS4.p1.4.m4.4.4.4.4.2a" xref="A3.SS4.p1.4.m4.4.4.4.4.1.cmml">⁡</mo><mrow id="A3.SS4.p1.4.m4.4.4.4.4.2.1" xref="A3.SS4.p1.4.m4.4.4.4.4.1.cmml"><mo id="A3.SS4.p1.4.m4.4.4.4.4.2.1.1" xref="A3.SS4.p1.4.m4.4.4.4.4.1.cmml">(</mo><mfrac id="A3.SS4.p1.4.m4.4.4.4.2" xref="A3.SS4.p1.4.m4.4.4.4.2.cmml"><msub id="A3.SS4.p1.4.m4.4.4.4.2.2" xref="A3.SS4.p1.4.m4.4.4.4.2.2.cmml"><mi id="A3.SS4.p1.4.m4.4.4.4.2.2.2" xref="A3.SS4.p1.4.m4.4.4.4.2.2.2.cmml">z</mi><mi id="A3.SS4.p1.4.m4.4.4.4.2.2.3" xref="A3.SS4.p1.4.m4.4.4.4.2.2.3.cmml">j</mi></msub><mi id="A3.SS4.p1.4.m4.4.4.4.2.3" xref="A3.SS4.p1.4.m4.4.4.4.2.3.cmml">T</mi></mfrac><mo id="A3.SS4.p1.4.m4.4.4.4.4.2.1.2" xref="A3.SS4.p1.4.m4.4.4.4.4.1.cmml">)</mo></mrow></mrow></mrow></mfrac></mrow><annotation-xml encoding="MathML-Content" id="A3.SS4.p1.4.m4.5b"><apply id="A3.SS4.p1.4.m4.5.5.cmml" xref="A3.SS4.p1.4.m4.5.5"><eq id="A3.SS4.p1.4.m4.5.5.2.cmml" xref="A3.SS4.p1.4.m4.5.5.2"></eq><apply id="A3.SS4.p1.4.m4.5.5.1.cmml" xref="A3.SS4.p1.4.m4.5.5.1"><times id="A3.SS4.p1.4.m4.5.5.1.2.cmml" xref="A3.SS4.p1.4.m4.5.5.1.2"></times><ci id="A3.SS4.p1.4.m4.5.5.1.3.cmml" xref="A3.SS4.p1.4.m4.5.5.1.3">𝑝</ci><apply id="A3.SS4.p1.4.m4.5.5.1.1.1.1.cmml" xref="A3.SS4.p1.4.m4.5.5.1.1.1"><csymbol cd="ambiguous" id="A3.SS4.p1.4.m4.5.5.1.1.1.1.1.cmml" xref="A3.SS4.p1.4.m4.5.5.1.1.1">subscript</csymbol><ci id="A3.SS4.p1.4.m4.5.5.1.1.1.1.2.cmml" xref="A3.SS4.p1.4.m4.5.5.1.1.1.1.2">𝑦</ci><ci id="A3.SS4.p1.4.m4.5.5.1.1.1.1.3.cmml" xref="A3.SS4.p1.4.m4.5.5.1.1.1.1.3">𝑖</ci></apply></apply><apply id="A3.SS4.p1.4.m4.4.4.cmml" xref="A3.SS4.p1.4.m4.4.4"><divide id="A3.SS4.p1.4.m4.4.4.5.cmml" xref="A3.SS4.p1.4.m4.4.4"></divide><apply id="A3.SS4.p1.4.m4.2.2.2.3.cmml" xref="A3.SS4.p1.4.m4.2.2.2.4"><exp id="A3.SS4.p1.4.m4.1.1.1.1.cmml" xref="A3.SS4.p1.4.m4.1.1.1.1"></exp><apply id="A3.SS4.p1.4.m4.2.2.2.2.cmml" xref="A3.SS4.p1.4.m4.2.2.2.2"><divide id="A3.SS4.p1.4.m4.2.2.2.2.1.cmml" xref="A3.SS4.p1.4.m4.2.2.2.2"></divide><apply id="A3.SS4.p1.4.m4.2.2.2.2.2.cmml" xref="A3.SS4.p1.4.m4.2.2.2.2.2"><csymbol cd="ambiguous" id="A3.SS4.p1.4.m4.2.2.2.2.2.1.cmml" xref="A3.SS4.p1.4.m4.2.2.2.2.2">subscript</csymbol><ci id="A3.SS4.p1.4.m4.2.2.2.2.2.2.cmml" xref="A3.SS4.p1.4.m4.2.2.2.2.2.2">𝑧</ci><ci id="A3.SS4.p1.4.m4.2.2.2.2.2.3.cmml" xref="A3.SS4.p1.4.m4.2.2.2.2.2.3">𝑖</ci></apply><ci id="A3.SS4.p1.4.m4.2.2.2.2.3.cmml" xref="A3.SS4.p1.4.m4.2.2.2.2.3">𝑇</ci></apply></apply><apply id="A3.SS4.p1.4.m4.4.4.4.cmml" xref="A3.SS4.p1.4.m4.4.4.4"><apply id="A3.SS4.p1.4.m4.4.4.4.3.cmml" xref="A3.SS4.p1.4.m4.4.4.4.3"><csymbol cd="ambiguous" id="A3.SS4.p1.4.m4.4.4.4.3.1.cmml" xref="A3.SS4.p1.4.m4.4.4.4.3">subscript</csymbol><sum id="A3.SS4.p1.4.m4.4.4.4.3.2.cmml" xref="A3.SS4.p1.4.m4.4.4.4.3.2"></sum><ci id="A3.SS4.p1.4.m4.4.4.4.3.3.cmml" xref="A3.SS4.p1.4.m4.4.4.4.3.3">𝑗</ci></apply><apply id="A3.SS4.p1.4.m4.4.4.4.4.1.cmml" xref="A3.SS4.p1.4.m4.4.4.4.4.2"><exp id="A3.SS4.p1.4.m4.3.3.3.1.cmml" xref="A3.SS4.p1.4.m4.3.3.3.1"></exp><apply id="A3.SS4.p1.4.m4.4.4.4.2.cmml" xref="A3.SS4.p1.4.m4.4.4.4.2"><divide id="A3.SS4.p1.4.m4.4.4.4.2.1.cmml" xref="A3.SS4.p1.4.m4.4.4.4.2"></divide><apply id="A3.SS4.p1.4.m4.4.4.4.2.2.cmml" xref="A3.SS4.p1.4.m4.4.4.4.2.2"><csymbol cd="ambiguous" id="A3.SS4.p1.4.m4.4.4.4.2.2.1.cmml" xref="A3.SS4.p1.4.m4.4.4.4.2.2">subscript</csymbol><ci id="A3.SS4.p1.4.m4.4.4.4.2.2.2.cmml" xref="A3.SS4.p1.4.m4.4.4.4.2.2.2">𝑧</ci><ci id="A3.SS4.p1.4.m4.4.4.4.2.2.3.cmml" xref="A3.SS4.p1.4.m4.4.4.4.2.2.3">𝑗</ci></apply><ci id="A3.SS4.p1.4.m4.4.4.4.2.3.cmml" xref="A3.SS4.p1.4.m4.4.4.4.2.3">𝑇</ci></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A3.SS4.p1.4.m4.5c">p(y_{i})=\frac{\exp\left(\frac{z_{i}}{T}\right)}{\sum_{j}\exp\left(\frac{z_{j}}{T}\right)}</annotation></semantics></math>, where <math id="A3.SS4.p1.5.m5.1" class="ltx_Math" alttext="y_{i}" display="inline"><semantics id="A3.SS4.p1.5.m5.1a"><msub id="A3.SS4.p1.5.m5.1.1" xref="A3.SS4.p1.5.m5.1.1.cmml"><mi id="A3.SS4.p1.5.m5.1.1.2" xref="A3.SS4.p1.5.m5.1.1.2.cmml">y</mi><mi id="A3.SS4.p1.5.m5.1.1.3" xref="A3.SS4.p1.5.m5.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="A3.SS4.p1.5.m5.1b"><apply id="A3.SS4.p1.5.m5.1.1.cmml" xref="A3.SS4.p1.5.m5.1.1"><csymbol cd="ambiguous" id="A3.SS4.p1.5.m5.1.1.1.cmml" xref="A3.SS4.p1.5.m5.1.1">subscript</csymbol><ci id="A3.SS4.p1.5.m5.1.1.2.cmml" xref="A3.SS4.p1.5.m5.1.1.2">𝑦</ci><ci id="A3.SS4.p1.5.m5.1.1.3.cmml" xref="A3.SS4.p1.5.m5.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A3.SS4.p1.5.m5.1c">y_{i}</annotation></semantics></math> is a label and <math id="A3.SS4.p1.6.m6.1" class="ltx_Math" alttext="z_{i}" display="inline"><semantics id="A3.SS4.p1.6.m6.1a"><msub id="A3.SS4.p1.6.m6.1.1" xref="A3.SS4.p1.6.m6.1.1.cmml"><mi id="A3.SS4.p1.6.m6.1.1.2" xref="A3.SS4.p1.6.m6.1.1.2.cmml">z</mi><mi id="A3.SS4.p1.6.m6.1.1.3" xref="A3.SS4.p1.6.m6.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="A3.SS4.p1.6.m6.1b"><apply id="A3.SS4.p1.6.m6.1.1.cmml" xref="A3.SS4.p1.6.m6.1.1"><csymbol cd="ambiguous" id="A3.SS4.p1.6.m6.1.1.1.cmml" xref="A3.SS4.p1.6.m6.1.1">subscript</csymbol><ci id="A3.SS4.p1.6.m6.1.1.2.cmml" xref="A3.SS4.p1.6.m6.1.1.2">𝑧</ci><ci id="A3.SS4.p1.6.m6.1.1.3.cmml" xref="A3.SS4.p1.6.m6.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A3.SS4.p1.6.m6.1c">z_{i}</annotation></semantics></math> is the corresponding logit. We additionally tune a student regularization term which modifies the target distribution by interpolating between the temperature-scaled teacher distribution and the soft-labels of the initial parameters of the student. This corresponds to using both <math id="A3.SS4.p1.7.m7.2" class="ltx_Math" alttext="\theta^{\text{\tiny teacher}}_{\{L,H\}-i}" display="inline"><semantics id="A3.SS4.p1.7.m7.2a"><msubsup id="A3.SS4.p1.7.m7.2.3" xref="A3.SS4.p1.7.m7.2.3.cmml"><mi id="A3.SS4.p1.7.m7.2.3.2.2" xref="A3.SS4.p1.7.m7.2.3.2.2.cmml">θ</mi><mrow id="A3.SS4.p1.7.m7.2.2.2" xref="A3.SS4.p1.7.m7.2.2.2.cmml"><mrow id="A3.SS4.p1.7.m7.2.2.2.4.2" xref="A3.SS4.p1.7.m7.2.2.2.4.1.cmml"><mo stretchy="false" id="A3.SS4.p1.7.m7.2.2.2.4.2.1" xref="A3.SS4.p1.7.m7.2.2.2.4.1.cmml">{</mo><mi id="A3.SS4.p1.7.m7.1.1.1.1" xref="A3.SS4.p1.7.m7.1.1.1.1.cmml">L</mi><mo id="A3.SS4.p1.7.m7.2.2.2.4.2.2" xref="A3.SS4.p1.7.m7.2.2.2.4.1.cmml">,</mo><mi id="A3.SS4.p1.7.m7.2.2.2.2" xref="A3.SS4.p1.7.m7.2.2.2.2.cmml">H</mi><mo stretchy="false" id="A3.SS4.p1.7.m7.2.2.2.4.2.3" xref="A3.SS4.p1.7.m7.2.2.2.4.1.cmml">}</mo></mrow><mo id="A3.SS4.p1.7.m7.2.2.2.3" xref="A3.SS4.p1.7.m7.2.2.2.3.cmml">−</mo><mi id="A3.SS4.p1.7.m7.2.2.2.5" xref="A3.SS4.p1.7.m7.2.2.2.5.cmml">i</mi></mrow><mtext mathsize="71%" id="A3.SS4.p1.7.m7.2.3.2.3" xref="A3.SS4.p1.7.m7.2.3.2.3a.cmml">teacher</mtext></msubsup><annotation-xml encoding="MathML-Content" id="A3.SS4.p1.7.m7.2b"><apply id="A3.SS4.p1.7.m7.2.3.cmml" xref="A3.SS4.p1.7.m7.2.3"><csymbol cd="ambiguous" id="A3.SS4.p1.7.m7.2.3.1.cmml" xref="A3.SS4.p1.7.m7.2.3">subscript</csymbol><apply id="A3.SS4.p1.7.m7.2.3.2.cmml" xref="A3.SS4.p1.7.m7.2.3"><csymbol cd="ambiguous" id="A3.SS4.p1.7.m7.2.3.2.1.cmml" xref="A3.SS4.p1.7.m7.2.3">superscript</csymbol><ci id="A3.SS4.p1.7.m7.2.3.2.2.cmml" xref="A3.SS4.p1.7.m7.2.3.2.2">𝜃</ci><ci id="A3.SS4.p1.7.m7.2.3.2.3a.cmml" xref="A3.SS4.p1.7.m7.2.3.2.3"><mtext mathsize="50%" id="A3.SS4.p1.7.m7.2.3.2.3.cmml" xref="A3.SS4.p1.7.m7.2.3.2.3">teacher</mtext></ci></apply><apply id="A3.SS4.p1.7.m7.2.2.2.cmml" xref="A3.SS4.p1.7.m7.2.2.2"><minus id="A3.SS4.p1.7.m7.2.2.2.3.cmml" xref="A3.SS4.p1.7.m7.2.2.2.3"></minus><set id="A3.SS4.p1.7.m7.2.2.2.4.1.cmml" xref="A3.SS4.p1.7.m7.2.2.2.4.2"><ci id="A3.SS4.p1.7.m7.1.1.1.1.cmml" xref="A3.SS4.p1.7.m7.1.1.1.1">𝐿</ci><ci id="A3.SS4.p1.7.m7.2.2.2.2.cmml" xref="A3.SS4.p1.7.m7.2.2.2.2">𝐻</ci></set><ci id="A3.SS4.p1.7.m7.2.2.2.5.cmml" xref="A3.SS4.p1.7.m7.2.2.2.5">𝑖</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A3.SS4.p1.7.m7.2c">\theta^{\text{\tiny teacher}}_{\{L,H\}-i}</annotation></semantics></math> and <math id="A3.SS4.p1.8.m8.1" class="ltx_Math" alttext="\theta^{\text{\tiny teacher}}_{i}" display="inline"><semantics id="A3.SS4.p1.8.m8.1a"><msubsup id="A3.SS4.p1.8.m8.1.1" xref="A3.SS4.p1.8.m8.1.1.cmml"><mi id="A3.SS4.p1.8.m8.1.1.2.2" xref="A3.SS4.p1.8.m8.1.1.2.2.cmml">θ</mi><mi id="A3.SS4.p1.8.m8.1.1.3" xref="A3.SS4.p1.8.m8.1.1.3.cmml">i</mi><mtext mathsize="71%" id="A3.SS4.p1.8.m8.1.1.2.3" xref="A3.SS4.p1.8.m8.1.1.2.3a.cmml">teacher</mtext></msubsup><annotation-xml encoding="MathML-Content" id="A3.SS4.p1.8.m8.1b"><apply id="A3.SS4.p1.8.m8.1.1.cmml" xref="A3.SS4.p1.8.m8.1.1"><csymbol cd="ambiguous" id="A3.SS4.p1.8.m8.1.1.1.cmml" xref="A3.SS4.p1.8.m8.1.1">subscript</csymbol><apply id="A3.SS4.p1.8.m8.1.1.2.cmml" xref="A3.SS4.p1.8.m8.1.1"><csymbol cd="ambiguous" id="A3.SS4.p1.8.m8.1.1.2.1.cmml" xref="A3.SS4.p1.8.m8.1.1">superscript</csymbol><ci id="A3.SS4.p1.8.m8.1.1.2.2.cmml" xref="A3.SS4.p1.8.m8.1.1.2.2">𝜃</ci><ci id="A3.SS4.p1.8.m8.1.1.2.3a.cmml" xref="A3.SS4.p1.8.m8.1.1.2.3"><mtext mathsize="50%" id="A3.SS4.p1.8.m8.1.1.2.3.cmml" xref="A3.SS4.p1.8.m8.1.1.2.3">teacher</mtext></ci></apply><ci id="A3.SS4.p1.8.m8.1.1.3.cmml" xref="A3.SS4.p1.8.m8.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A3.SS4.p1.8.m8.1c">\theta^{\text{\tiny teacher}}_{i}</annotation></semantics></math> as teachers, when distilling to <math id="A3.SS4.p1.9.m9.4" class="ltx_Math" alttext="\theta^{\text{\tiny student}}_{i},\,i\in\{L,H\}" display="inline"><semantics id="A3.SS4.p1.9.m9.4a"><mrow id="A3.SS4.p1.9.m9.4.4" xref="A3.SS4.p1.9.m9.4.4.cmml"><mrow id="A3.SS4.p1.9.m9.4.4.1.1" xref="A3.SS4.p1.9.m9.4.4.1.2.cmml"><msubsup id="A3.SS4.p1.9.m9.4.4.1.1.1" xref="A3.SS4.p1.9.m9.4.4.1.1.1.cmml"><mi id="A3.SS4.p1.9.m9.4.4.1.1.1.2.2" xref="A3.SS4.p1.9.m9.4.4.1.1.1.2.2.cmml">θ</mi><mi id="A3.SS4.p1.9.m9.4.4.1.1.1.3" xref="A3.SS4.p1.9.m9.4.4.1.1.1.3.cmml">i</mi><mtext mathsize="71%" id="A3.SS4.p1.9.m9.4.4.1.1.1.2.3" xref="A3.SS4.p1.9.m9.4.4.1.1.1.2.3a.cmml">student</mtext></msubsup><mo rspace="0.337em" id="A3.SS4.p1.9.m9.4.4.1.1.2" xref="A3.SS4.p1.9.m9.4.4.1.2.cmml">,</mo><mi id="A3.SS4.p1.9.m9.3.3" xref="A3.SS4.p1.9.m9.3.3.cmml">i</mi></mrow><mo id="A3.SS4.p1.9.m9.4.4.2" xref="A3.SS4.p1.9.m9.4.4.2.cmml">∈</mo><mrow id="A3.SS4.p1.9.m9.4.4.3.2" xref="A3.SS4.p1.9.m9.4.4.3.1.cmml"><mo stretchy="false" id="A3.SS4.p1.9.m9.4.4.3.2.1" xref="A3.SS4.p1.9.m9.4.4.3.1.cmml">{</mo><mi id="A3.SS4.p1.9.m9.1.1" xref="A3.SS4.p1.9.m9.1.1.cmml">L</mi><mo id="A3.SS4.p1.9.m9.4.4.3.2.2" xref="A3.SS4.p1.9.m9.4.4.3.1.cmml">,</mo><mi id="A3.SS4.p1.9.m9.2.2" xref="A3.SS4.p1.9.m9.2.2.cmml">H</mi><mo stretchy="false" id="A3.SS4.p1.9.m9.4.4.3.2.3" xref="A3.SS4.p1.9.m9.4.4.3.1.cmml">}</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="A3.SS4.p1.9.m9.4b"><apply id="A3.SS4.p1.9.m9.4.4.cmml" xref="A3.SS4.p1.9.m9.4.4"><in id="A3.SS4.p1.9.m9.4.4.2.cmml" xref="A3.SS4.p1.9.m9.4.4.2"></in><list id="A3.SS4.p1.9.m9.4.4.1.2.cmml" xref="A3.SS4.p1.9.m9.4.4.1.1"><apply id="A3.SS4.p1.9.m9.4.4.1.1.1.cmml" xref="A3.SS4.p1.9.m9.4.4.1.1.1"><csymbol cd="ambiguous" id="A3.SS4.p1.9.m9.4.4.1.1.1.1.cmml" xref="A3.SS4.p1.9.m9.4.4.1.1.1">subscript</csymbol><apply id="A3.SS4.p1.9.m9.4.4.1.1.1.2.cmml" xref="A3.SS4.p1.9.m9.4.4.1.1.1"><csymbol cd="ambiguous" id="A3.SS4.p1.9.m9.4.4.1.1.1.2.1.cmml" xref="A3.SS4.p1.9.m9.4.4.1.1.1">superscript</csymbol><ci id="A3.SS4.p1.9.m9.4.4.1.1.1.2.2.cmml" xref="A3.SS4.p1.9.m9.4.4.1.1.1.2.2">𝜃</ci><ci id="A3.SS4.p1.9.m9.4.4.1.1.1.2.3a.cmml" xref="A3.SS4.p1.9.m9.4.4.1.1.1.2.3"><mtext mathsize="50%" id="A3.SS4.p1.9.m9.4.4.1.1.1.2.3.cmml" xref="A3.SS4.p1.9.m9.4.4.1.1.1.2.3">student</mtext></ci></apply><ci id="A3.SS4.p1.9.m9.4.4.1.1.1.3.cmml" xref="A3.SS4.p1.9.m9.4.4.1.1.1.3">𝑖</ci></apply><ci id="A3.SS4.p1.9.m9.3.3.cmml" xref="A3.SS4.p1.9.m9.3.3">𝑖</ci></list><set id="A3.SS4.p1.9.m9.4.4.3.1.cmml" xref="A3.SS4.p1.9.m9.4.4.3.2"><ci id="A3.SS4.p1.9.m9.1.1.cmml" xref="A3.SS4.p1.9.m9.1.1">𝐿</ci><ci id="A3.SS4.p1.9.m9.2.2.cmml" xref="A3.SS4.p1.9.m9.2.2">𝐻</ci></set></apply></annotation-xml><annotation encoding="application/x-tex" id="A3.SS4.p1.9.m9.4c">\theta^{\text{\tiny student}}_{i},\,i\in\{L,H\}</annotation></semantics></math>. The former teacher is used to predict soft-labels for distillation, while the latter acts as a regularizer, preventing the student model from drifting too far from the parameters at the start of the distillation round.</p>
</div>
<div id="A3.SS4.p2" class="ltx_para">
<p id="A3.SS4.p2.1" class="ltx_p">We use the Kullback–Leibler divergence <cite class="ltx_cite ltx_citemacro_citep">(Murphy, <a href="#bib.bib25" title="" class="ltx_ref">2022</a>)</cite> between the student probabilities and the target probabilities as the distillation loss. For both <span id="A3.SS4.p2.1.1" class="ltx_text ltx_font_smallcaps">MergedCodist</span> and <span id="A3.SS4.p2.1.2" class="ltx_text ltx_font_smallcaps">PeriodicCodist</span>, we optimize the distillation updates with Adam using the default hyper-parameters. For each student optimizer, we tune a learning rate that decays linearly over all rounds.</p>
</div>
<div id="A3.SS4.p3" class="ltx_para">
<p id="A3.SS4.p3.1" class="ltx_p">Though either method can be trivially extended to incorporate labeled distillation data by tuning an additional interpolating value between the teacher soft-labels and the true one-hot labels, in all experiments, we use only unlabeled distillation data. Our goal is to avoid any gains by exposing the models to additional labeled data and, thus, demonstrate the improvements solely due to codistillation. Nonetheless, unlabeled data is easier to acquire in practice than labeled data, especially in our domain of interest.</p>
</div>
<div id="A3.SS4.p4" class="ltx_para">
<p id="A3.SS4.p4.3" class="ltx_p">In all experiments with <span id="A3.SS4.p4.3.1" class="ltx_text ltx_font_smallcaps">PeriodicCodist</span>, we set the codistillation period to <math id="A3.SS4.p4.1.m1.1" class="ltx_Math" alttext="p=200" display="inline"><semantics id="A3.SS4.p4.1.m1.1a"><mrow id="A3.SS4.p4.1.m1.1.1" xref="A3.SS4.p4.1.m1.1.1.cmml"><mi id="A3.SS4.p4.1.m1.1.1.2" xref="A3.SS4.p4.1.m1.1.1.2.cmml">p</mi><mo id="A3.SS4.p4.1.m1.1.1.1" xref="A3.SS4.p4.1.m1.1.1.1.cmml">=</mo><mn id="A3.SS4.p4.1.m1.1.1.3" xref="A3.SS4.p4.1.m1.1.1.3.cmml">200</mn></mrow><annotation-xml encoding="MathML-Content" id="A3.SS4.p4.1.m1.1b"><apply id="A3.SS4.p4.1.m1.1.1.cmml" xref="A3.SS4.p4.1.m1.1.1"><eq id="A3.SS4.p4.1.m1.1.1.1.cmml" xref="A3.SS4.p4.1.m1.1.1.1"></eq><ci id="A3.SS4.p4.1.m1.1.1.2.cmml" xref="A3.SS4.p4.1.m1.1.1.2">𝑝</ci><cn type="integer" id="A3.SS4.p4.1.m1.1.1.3.cmml" xref="A3.SS4.p4.1.m1.1.1.3">200</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A3.SS4.p4.1.m1.1c">p=200</annotation></semantics></math> rounds and run codistillation for <math id="A3.SS4.p4.2.m2.1" class="ltx_Math" alttext="s=200" display="inline"><semantics id="A3.SS4.p4.2.m2.1a"><mrow id="A3.SS4.p4.2.m2.1.1" xref="A3.SS4.p4.2.m2.1.1.cmml"><mi id="A3.SS4.p4.2.m2.1.1.2" xref="A3.SS4.p4.2.m2.1.1.2.cmml">s</mi><mo id="A3.SS4.p4.2.m2.1.1.1" xref="A3.SS4.p4.2.m2.1.1.1.cmml">=</mo><mn id="A3.SS4.p4.2.m2.1.1.3" xref="A3.SS4.p4.2.m2.1.1.3.cmml">200</mn></mrow><annotation-xml encoding="MathML-Content" id="A3.SS4.p4.2.m2.1b"><apply id="A3.SS4.p4.2.m2.1.1.cmml" xref="A3.SS4.p4.2.m2.1.1"><eq id="A3.SS4.p4.2.m2.1.1.1.cmml" xref="A3.SS4.p4.2.m2.1.1.1"></eq><ci id="A3.SS4.p4.2.m2.1.1.2.cmml" xref="A3.SS4.p4.2.m2.1.1.2">𝑠</ci><cn type="integer" id="A3.SS4.p4.2.m2.1.1.3.cmml" xref="A3.SS4.p4.2.m2.1.1.3">200</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A3.SS4.p4.2.m2.1c">s=200</annotation></semantics></math> steps each codistillation round. When running <span id="A3.SS4.p4.3.2" class="ltx_text ltx_font_smallcaps">PeriodicCodist</span>, we reset the momentum variables of the <span id="A3.SS4.p4.3.3" class="ltx_text ltx_font_smallcaps">FedAvg</span> optimizers after each codistillation round, as the models have departed from their initial parameters, rendering the momentum stale. When running <span id="A3.SS4.p4.3.4" class="ltx_text ltx_font_smallcaps">MergedCodist</span>, we take <math id="A3.SS4.p4.3.m3.1" class="ltx_Math" alttext="s=32" display="inline"><semantics id="A3.SS4.p4.3.m3.1a"><mrow id="A3.SS4.p4.3.m3.1.1" xref="A3.SS4.p4.3.m3.1.1.cmml"><mi id="A3.SS4.p4.3.m3.1.1.2" xref="A3.SS4.p4.3.m3.1.1.2.cmml">s</mi><mo id="A3.SS4.p4.3.m3.1.1.1" xref="A3.SS4.p4.3.m3.1.1.1.cmml">=</mo><mn id="A3.SS4.p4.3.m3.1.1.3" xref="A3.SS4.p4.3.m3.1.1.3.cmml">32</mn></mrow><annotation-xml encoding="MathML-Content" id="A3.SS4.p4.3.m3.1b"><apply id="A3.SS4.p4.3.m3.1.1.cmml" xref="A3.SS4.p4.3.m3.1.1"><eq id="A3.SS4.p4.3.m3.1.1.1.cmml" xref="A3.SS4.p4.3.m3.1.1.1"></eq><ci id="A3.SS4.p4.3.m3.1.1.2.cmml" xref="A3.SS4.p4.3.m3.1.1.2">𝑠</ci><cn type="integer" id="A3.SS4.p4.3.m3.1.1.3.cmml" xref="A3.SS4.p4.3.m3.1.1.3">32</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A3.SS4.p4.3.m3.1c">s=32</annotation></semantics></math> distillation steps to form each round’s distillation gradient.</p>
</div>
</section>
<section id="A3.SS5" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">C.5 </span>Domain-shifted Client Pools</h3>

<figure id="A3.T5" class="ltx_table">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_table">Table 5: </span>Dataset sizes for the StackOverflow domain-shift experiments. Distillation data is <math id="A3.T5.3.m1.1" class="ltx_Math" alttext="\sim" display="inline"><semantics id="A3.T5.3.m1.1b"><mo id="A3.T5.3.m1.1.1" xref="A3.T5.3.m1.1.1.cmml">∼</mo><annotation-xml encoding="MathML-Content" id="A3.T5.3.m1.1c"><csymbol cd="latexml" id="A3.T5.3.m1.1.1.cmml" xref="A3.T5.3.m1.1.1">similar-to</csymbol></annotation-xml><annotation encoding="application/x-tex" id="A3.T5.3.m1.1d">\sim</annotation></semantics></math>55% answers and <math id="A3.T5.4.m2.1" class="ltx_Math" alttext="\sim" display="inline"><semantics id="A3.T5.4.m2.1b"><mo id="A3.T5.4.m2.1.1" xref="A3.T5.4.m2.1.1.cmml">∼</mo><annotation-xml encoding="MathML-Content" id="A3.T5.4.m2.1c"><csymbol cd="latexml" id="A3.T5.4.m2.1.1.cmml" xref="A3.T5.4.m2.1.1">similar-to</csymbol></annotation-xml><annotation encoding="application/x-tex" id="A3.T5.4.m2.1d">\sim</annotation></semantics></math>45% questions, reflecting the split in the overall federated StackOverflow dataset.</figcaption>
<table id="A3.T5.6.2" class="ltx_tabular ltx_centering ltx_guessed_headers ltx_align_middle">
<thead class="ltx_thead">
<tr id="A3.T5.6.2.3.1" class="ltx_tr">
<th id="A3.T5.6.2.3.1.1" class="ltx_td ltx_th ltx_th_column ltx_th_row ltx_border_r ltx_border_tt"></th>
<th id="A3.T5.6.2.3.1.2" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt"><span id="A3.T5.6.2.3.1.2.1" class="ltx_text ltx_font_smallcaps" style="font-size:90%;">clients</span></th>
<th id="A3.T5.6.2.3.1.3" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt"><span id="A3.T5.6.2.3.1.3.1" class="ltx_text ltx_font_smallcaps" style="font-size:90%;">examples</span></th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr id="A3.T5.5.1.1" class="ltx_tr">
<th id="A3.T5.5.1.1.1" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r ltx_border_tt">
<span id="A3.T5.5.1.1.1.1" class="ltx_text ltx_font_smallcaps" style="font-size:90%;">answers only (</span><math id="A3.T5.5.1.1.1.m1.1" class="ltx_Math" alttext="\mathcal{P}_{L}" display="inline"><semantics id="A3.T5.5.1.1.1.m1.1a"><msub id="A3.T5.5.1.1.1.m1.1.1" xref="A3.T5.5.1.1.1.m1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" mathsize="90%" id="A3.T5.5.1.1.1.m1.1.1.2" xref="A3.T5.5.1.1.1.m1.1.1.2.cmml">𝒫</mi><mi mathsize="90%" id="A3.T5.5.1.1.1.m1.1.1.3" xref="A3.T5.5.1.1.1.m1.1.1.3.cmml">L</mi></msub><annotation-xml encoding="MathML-Content" id="A3.T5.5.1.1.1.m1.1b"><apply id="A3.T5.5.1.1.1.m1.1.1.cmml" xref="A3.T5.5.1.1.1.m1.1.1"><csymbol cd="ambiguous" id="A3.T5.5.1.1.1.m1.1.1.1.cmml" xref="A3.T5.5.1.1.1.m1.1.1">subscript</csymbol><ci id="A3.T5.5.1.1.1.m1.1.1.2.cmml" xref="A3.T5.5.1.1.1.m1.1.1.2">𝒫</ci><ci id="A3.T5.5.1.1.1.m1.1.1.3.cmml" xref="A3.T5.5.1.1.1.m1.1.1.3">𝐿</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A3.T5.5.1.1.1.m1.1c">\mathcal{P}_{L}</annotation></semantics></math><span id="A3.T5.5.1.1.1.2" class="ltx_text ltx_font_smallcaps" style="font-size:90%;">)</span>
</th>
<td id="A3.T5.5.1.1.2" class="ltx_td ltx_align_center ltx_border_tt"><span id="A3.T5.5.1.1.2.1" class="ltx_text ltx_font_smallcaps" style="font-size:90%;">30,000</span></td>
<td id="A3.T5.5.1.1.3" class="ltx_td ltx_align_center ltx_border_tt"><span id="A3.T5.5.1.1.3.1" class="ltx_text ltx_font_smallcaps" style="font-size:90%;">11,580,368</span></td>
</tr>
<tr id="A3.T5.6.2.2" class="ltx_tr">
<th id="A3.T5.6.2.2.1" class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_bb ltx_border_r">
<span id="A3.T5.6.2.2.1.1" class="ltx_text ltx_font_smallcaps" style="font-size:90%;">questions only (</span><math id="A3.T5.6.2.2.1.m1.1" class="ltx_Math" alttext="\mathcal{P}_{H}" display="inline"><semantics id="A3.T5.6.2.2.1.m1.1a"><msub id="A3.T5.6.2.2.1.m1.1.1" xref="A3.T5.6.2.2.1.m1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" mathsize="90%" id="A3.T5.6.2.2.1.m1.1.1.2" xref="A3.T5.6.2.2.1.m1.1.1.2.cmml">𝒫</mi><mi mathsize="90%" id="A3.T5.6.2.2.1.m1.1.1.3" xref="A3.T5.6.2.2.1.m1.1.1.3.cmml">H</mi></msub><annotation-xml encoding="MathML-Content" id="A3.T5.6.2.2.1.m1.1b"><apply id="A3.T5.6.2.2.1.m1.1.1.cmml" xref="A3.T5.6.2.2.1.m1.1.1"><csymbol cd="ambiguous" id="A3.T5.6.2.2.1.m1.1.1.1.cmml" xref="A3.T5.6.2.2.1.m1.1.1">subscript</csymbol><ci id="A3.T5.6.2.2.1.m1.1.1.2.cmml" xref="A3.T5.6.2.2.1.m1.1.1.2">𝒫</ci><ci id="A3.T5.6.2.2.1.m1.1.1.3.cmml" xref="A3.T5.6.2.2.1.m1.1.1.3">𝐻</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A3.T5.6.2.2.1.m1.1c">\mathcal{P}_{H}</annotation></semantics></math><span id="A3.T5.6.2.2.1.2" class="ltx_text ltx_font_smallcaps" style="font-size:90%;">)</span>
</th>
<td id="A3.T5.6.2.2.2" class="ltx_td ltx_align_center ltx_border_bb"><span id="A3.T5.6.2.2.2.1" class="ltx_text ltx_font_smallcaps" style="font-size:90%;">30,000</span></td>
<td id="A3.T5.6.2.2.3" class="ltx_td ltx_align_center ltx_border_bb"><span id="A3.T5.6.2.2.3.1" class="ltx_text ltx_font_smallcaps" style="font-size:90%;">5,060,866</span></td>
</tr>
</tbody>
</table>
</figure>
<div class="ltx_pagination ltx_role_newpage"></div>
</section>
</section>
<section id="A4" class="ltx_appendix">
<h2 class="ltx_title ltx_title_appendix">
<span class="ltx_tag ltx_tag_appendix">Appendix D </span>Further Analysis</h2>

<section id="A4.SS1" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">D.1 </span>Domain-shifted Client Pools</h3>

<figure id="A4.F3" class="ltx_figure"><img src="/html/2310.02549/assets/x5.png" id="A4.F3.1.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="484" height="203" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 3: </span>Performance of <span id="A4.F3.13.1" class="ltx_text ltx_font_smallcaps">MergedCodist</span> in dashed blue (<span id="A4.F3.14.2" class="ltx_text ltx_font_typewriter ltx_font_bold" style="color:#0000FF;">--</span>) and <span id="A4.F3.15.3" class="ltx_text ltx_font_smallcaps">PeriodicCodist</span> in solid green (<span id="A4.F3.16.4" class="ltx_text ltx_font_bold" style="color:#007F00;">—</span>) vs. baseline of <span id="A4.F3.17.5" class="ltx_text ltx_font_smallcaps">FedAvg</span> in dotted black (<math id="A4.F3.4.3.m1.2" class="ltx_Math" alttext="\bm{\cdot\,\cdot}" display="inline"><semantics id="A4.F3.4.3.m1.2b"><mrow id="A4.F3.4.3.m1.2.3.2" xref="A4.F3.4.3.m1.2.3.1.cmml"><mo class="ltx_mathvariant_bold" mathvariant="bold" id="A4.F3.4.3.m1.1.1" xref="A4.F3.4.3.m1.1.1.cmml">⋅</mo><mo lspace="0.170em" id="A4.F3.4.3.m1.2.3.2.1" xref="A4.F3.4.3.m1.2.3.1.cmml">⁣</mo><mo class="ltx_mathvariant_bold" mathvariant="bold" id="A4.F3.4.3.m1.2.2" xref="A4.F3.4.3.m1.2.2.cmml">⋅</mo></mrow><annotation-xml encoding="MathML-Content" id="A4.F3.4.3.m1.2c"><list id="A4.F3.4.3.m1.2.3.1.cmml" xref="A4.F3.4.3.m1.2.3.2"><ci id="A4.F3.4.3.m1.1.1.cmml" xref="A4.F3.4.3.m1.1.1">bold-⋅</ci><ci id="A4.F3.4.3.m1.2.2.cmml" xref="A4.F3.4.3.m1.2.2">bold-⋅</ci></list></annotation-xml><annotation encoding="application/x-tex" id="A4.F3.4.3.m1.2d">\bm{\cdot\,\cdot}</annotation></semantics></math>). Accuracy on the Answers-only, Questions-only, and Mixed test sets are shown. The small model <span id="A4.F3.18.6" class="ltx_text ltx_font_smallcaps">FedAvg</span> pool contains Answers only, and the large model pool contains Questions only. For <span id="A4.F3.19.7" class="ltx_text ltx_font_smallcaps">PeriodicCodist</span>  codistillation is run every <math id="A4.F3.5.4.m2.1" class="ltx_Math" alttext="p=200" display="inline"><semantics id="A4.F3.5.4.m2.1b"><mrow id="A4.F3.5.4.m2.1.1" xref="A4.F3.5.4.m2.1.1.cmml"><mi id="A4.F3.5.4.m2.1.1.2" xref="A4.F3.5.4.m2.1.1.2.cmml">p</mi><mo id="A4.F3.5.4.m2.1.1.1" xref="A4.F3.5.4.m2.1.1.1.cmml">=</mo><mn id="A4.F3.5.4.m2.1.1.3" xref="A4.F3.5.4.m2.1.1.3.cmml">200</mn></mrow><annotation-xml encoding="MathML-Content" id="A4.F3.5.4.m2.1c"><apply id="A4.F3.5.4.m2.1.1.cmml" xref="A4.F3.5.4.m2.1.1"><eq id="A4.F3.5.4.m2.1.1.1.cmml" xref="A4.F3.5.4.m2.1.1.1"></eq><ci id="A4.F3.5.4.m2.1.1.2.cmml" xref="A4.F3.5.4.m2.1.1.2">𝑝</ci><cn type="integer" id="A4.F3.5.4.m2.1.1.3.cmml" xref="A4.F3.5.4.m2.1.1.3">200</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A4.F3.5.4.m2.1d">p=200</annotation></semantics></math> rounds. Note the spikes in out-of-domain performance (large model on Answers and small model on Questions) following each codistillation round, and the corresponding drops in the in-domain performance.</figcaption>
</figure>
<div id="A4.SS1.p1" class="ltx_para">
<p id="A4.SS1.p1.1" class="ltx_p"><span id="A4.SS1.p1.1.1" class="ltx_text ltx_font_smallcaps">PeriodicCodist</span> performs poorly compared to <span id="A4.SS1.p1.1.2" class="ltx_text ltx_font_smallcaps">FedAvg</span> in domain-shifted experiments.
Figure <a href="#A4.F3" title="Figure 3 ‣ D.1 Domain-shifted Client Pools ‣ Appendix D Further Analysis ‣ Heterogeneous Federated Learning Using Knowledge Codistillation" class="ltx_ref"><span class="ltx_text ltx_ref_tag">3</span></a> shows that it struggles to share information between models because the student model never sees information from both domains at once. In each codistillation round, it shows upward spikes on out-of-domain accuracy and downward spikes on in-domain accuracy, which are smoothed out by subsequent <span id="A4.SS1.p1.1.3" class="ltx_text ltx_font_smallcaps">FedAvg</span> rounds resulting in no net gains over <span id="A4.SS1.p1.1.4" class="ltx_text ltx_font_smallcaps">FedAvg</span>. <span id="A4.SS1.p1.1.5" class="ltx_text ltx_font_smallcaps">MergedCodist</span> avoids this issue by showing the model information from both domains at all times, leading to overall improvement for both models, as well as faster convergence on the general performance.</p>
</div>
</section>
<section id="A4.SS2" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">D.2 </span>Distillation Dataset Size</h3>

<figure id="A4.F4" class="ltx_figure"><img src="/html/2310.02549/assets/x6.png" id="A4.F4.1.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="272" height="80" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 4: </span>Performance of <span id="A4.F4.7.1" class="ltx_text ltx_font_smallcaps">PeriodicCodist</span> and <span id="A4.F4.8.2" class="ltx_text ltx_font_smallcaps">MergedCodist</span> on the CIFAR-100 dataset, with varying sizes of distillation data. The dashed purple line (<span id="A4.F4.9.3" class="ltx_text ltx_font_typewriter ltx_font_bold" style="color:#800080;">--</span>) represents the large model, and the solid orange line (<span id="A4.F4.10.4" class="ltx_text ltx_font_bold" style="color:#FF8000;">—</span>) the small model. The <span id="A4.F4.11.5" class="ltx_text ltx_font_smallcaps">FedAvg</span> baseline is shown as a dotted horizontal line for each model. For each distillation size, the averaged test accuracy of the 25 tuning runs with the best performance on the held-out set is shown. Though having more distillation data is better, good performance can be reached with just 600 examples for both methods.</figcaption>
</figure>
<div id="A4.SS2.p1" class="ltx_para">
<p id="A4.SS2.p1.1" class="ltx_p">In the experiments in Section <a href="#S3.SS1" title="3.1 Balanced Model Performance ‣ 3 Experiments ‣ Heterogeneous Federated Learning Using Knowledge Codistillation" class="ltx_ref"><span class="ltx_text ltx_ref_tag">3.1</span></a>, we use as much in-domain data as is available. Realistically, acquiring even unlabeled in-domain data can be expensive, so available in-domain data may be limited in size. In Figure <a href="#A4.F4" title="Figure 4 ‣ D.2 Distillation Dataset Size ‣ Appendix D Further Analysis ‣ Heterogeneous Federated Learning Using Knowledge Codistillation" class="ltx_ref"><span class="ltx_text ltx_ref_tag">4</span></a>, we evaluate how the performance of <span id="A4.SS2.p1.1.1" class="ltx_text ltx_font_smallcaps">PeriodicCodist</span> and <span id="A4.SS2.p1.1.2" class="ltx_text ltx_font_smallcaps">MergedCodist</span> varies as a function of the size of the distillation dataset, using the CIFAR-100 equally-performant setup from Section <a href="#S3.SS1" title="3.1 Balanced Model Performance ‣ 3 Experiments ‣ Heterogeneous Federated Learning Using Knowledge Codistillation" class="ltx_ref"><span class="ltx_text ltx_ref_tag">3.1</span></a> as our baseline. Though <span id="A4.SS2.p1.1.3" class="ltx_text ltx_font_smallcaps">MergedCodist</span> and <span id="A4.SS2.p1.1.4" class="ltx_text ltx_font_smallcaps">PeriodicCodist</span> work best with more distillation data, it is possible to achieve good results on CIFAR-100 with only 600 unlabeled examples. This suggests that these methods may be practically useful even in settings where getting access to copious distillation data is expensive or infeasible.</p>
</div>
<div class="ltx_pagination ltx_role_newpage"></div>
</section>
</section>
<section id="A5" class="ltx_appendix">
<h2 class="ltx_title ltx_title_appendix">
<span class="ltx_tag ltx_tag_appendix">Appendix E </span>Model Architectures</h2>

<div id="A5.p1" class="ltx_para">
<p id="A5.p1.4" class="ltx_p">For Image Classification, we train 5-layer CNNs with 3 convolutional layers and 2 dense layers. The small model has filter sizes <math id="A5.p1.1.m1.3" class="ltx_Math" alttext="[16,32,32]" display="inline"><semantics id="A5.p1.1.m1.3a"><mrow id="A5.p1.1.m1.3.4.2" xref="A5.p1.1.m1.3.4.1.cmml"><mo stretchy="false" id="A5.p1.1.m1.3.4.2.1" xref="A5.p1.1.m1.3.4.1.cmml">[</mo><mn id="A5.p1.1.m1.1.1" xref="A5.p1.1.m1.1.1.cmml">16</mn><mo id="A5.p1.1.m1.3.4.2.2" xref="A5.p1.1.m1.3.4.1.cmml">,</mo><mn id="A5.p1.1.m1.2.2" xref="A5.p1.1.m1.2.2.cmml">32</mn><mo id="A5.p1.1.m1.3.4.2.3" xref="A5.p1.1.m1.3.4.1.cmml">,</mo><mn id="A5.p1.1.m1.3.3" xref="A5.p1.1.m1.3.3.cmml">32</mn><mo stretchy="false" id="A5.p1.1.m1.3.4.2.4" xref="A5.p1.1.m1.3.4.1.cmml">]</mo></mrow><annotation-xml encoding="MathML-Content" id="A5.p1.1.m1.3b"><list id="A5.p1.1.m1.3.4.1.cmml" xref="A5.p1.1.m1.3.4.2"><cn type="integer" id="A5.p1.1.m1.1.1.cmml" xref="A5.p1.1.m1.1.1">16</cn><cn type="integer" id="A5.p1.1.m1.2.2.cmml" xref="A5.p1.1.m1.2.2">32</cn><cn type="integer" id="A5.p1.1.m1.3.3.cmml" xref="A5.p1.1.m1.3.3">32</cn></list></annotation-xml><annotation encoding="application/x-tex" id="A5.p1.1.m1.3c">[16,32,32]</annotation></semantics></math> and dense layer sizes <math id="A5.p1.2.m2.2" class="ltx_Math" alttext="[64,128]" display="inline"><semantics id="A5.p1.2.m2.2a"><mrow id="A5.p1.2.m2.2.3.2" xref="A5.p1.2.m2.2.3.1.cmml"><mo stretchy="false" id="A5.p1.2.m2.2.3.2.1" xref="A5.p1.2.m2.2.3.1.cmml">[</mo><mn id="A5.p1.2.m2.1.1" xref="A5.p1.2.m2.1.1.cmml">64</mn><mo id="A5.p1.2.m2.2.3.2.2" xref="A5.p1.2.m2.2.3.1.cmml">,</mo><mn id="A5.p1.2.m2.2.2" xref="A5.p1.2.m2.2.2.cmml">128</mn><mo stretchy="false" id="A5.p1.2.m2.2.3.2.3" xref="A5.p1.2.m2.2.3.1.cmml">]</mo></mrow><annotation-xml encoding="MathML-Content" id="A5.p1.2.m2.2b"><interval closure="closed" id="A5.p1.2.m2.2.3.1.cmml" xref="A5.p1.2.m2.2.3.2"><cn type="integer" id="A5.p1.2.m2.1.1.cmml" xref="A5.p1.2.m2.1.1">64</cn><cn type="integer" id="A5.p1.2.m2.2.2.cmml" xref="A5.p1.2.m2.2.2">128</cn></interval></annotation-xml><annotation encoding="application/x-tex" id="A5.p1.2.m2.2c">[64,128]</annotation></semantics></math>, with a total of 109,348 parameters. The large model has filter sizes <math id="A5.p1.3.m3.3" class="ltx_Math" alttext="[32,64,64]" display="inline"><semantics id="A5.p1.3.m3.3a"><mrow id="A5.p1.3.m3.3.4.2" xref="A5.p1.3.m3.3.4.1.cmml"><mo stretchy="false" id="A5.p1.3.m3.3.4.2.1" xref="A5.p1.3.m3.3.4.1.cmml">[</mo><mn id="A5.p1.3.m3.1.1" xref="A5.p1.3.m3.1.1.cmml">32</mn><mo id="A5.p1.3.m3.3.4.2.2" xref="A5.p1.3.m3.3.4.1.cmml">,</mo><mn id="A5.p1.3.m3.2.2" xref="A5.p1.3.m3.2.2.cmml">64</mn><mo id="A5.p1.3.m3.3.4.2.3" xref="A5.p1.3.m3.3.4.1.cmml">,</mo><mn id="A5.p1.3.m3.3.3" xref="A5.p1.3.m3.3.3.cmml">64</mn><mo stretchy="false" id="A5.p1.3.m3.3.4.2.4" xref="A5.p1.3.m3.3.4.1.cmml">]</mo></mrow><annotation-xml encoding="MathML-Content" id="A5.p1.3.m3.3b"><list id="A5.p1.3.m3.3.4.1.cmml" xref="A5.p1.3.m3.3.4.2"><cn type="integer" id="A5.p1.3.m3.1.1.cmml" xref="A5.p1.3.m3.1.1">32</cn><cn type="integer" id="A5.p1.3.m3.2.2.cmml" xref="A5.p1.3.m3.2.2">64</cn><cn type="integer" id="A5.p1.3.m3.3.3.cmml" xref="A5.p1.3.m3.3.3">64</cn></list></annotation-xml><annotation encoding="application/x-tex" id="A5.p1.3.m3.3c">[32,64,64]</annotation></semantics></math> and dense layer sizes <math id="A5.p1.4.m4.2" class="ltx_Math" alttext="[128,256]" display="inline"><semantics id="A5.p1.4.m4.2a"><mrow id="A5.p1.4.m4.2.3.2" xref="A5.p1.4.m4.2.3.1.cmml"><mo stretchy="false" id="A5.p1.4.m4.2.3.2.1" xref="A5.p1.4.m4.2.3.1.cmml">[</mo><mn id="A5.p1.4.m4.1.1" xref="A5.p1.4.m4.1.1.cmml">128</mn><mo id="A5.p1.4.m4.2.3.2.2" xref="A5.p1.4.m4.2.3.1.cmml">,</mo><mn id="A5.p1.4.m4.2.2" xref="A5.p1.4.m4.2.2.cmml">256</mn><mo stretchy="false" id="A5.p1.4.m4.2.3.2.3" xref="A5.p1.4.m4.2.3.1.cmml">]</mo></mrow><annotation-xml encoding="MathML-Content" id="A5.p1.4.m4.2b"><interval closure="closed" id="A5.p1.4.m4.2.3.1.cmml" xref="A5.p1.4.m4.2.3.2"><cn type="integer" id="A5.p1.4.m4.1.1.cmml" xref="A5.p1.4.m4.1.1">128</cn><cn type="integer" id="A5.p1.4.m4.2.2.cmml" xref="A5.p1.4.m4.2.2">256</cn></interval></annotation-xml><annotation encoding="application/x-tex" id="A5.p1.4.m4.2c">[128,256]</annotation></semantics></math> with a total of 410,084 parameters.</p>
</div>
<div id="A5.p2" class="ltx_para">
<p id="A5.p2.1" class="ltx_p">For Language Modeling, we train LSTMs with either one or two LSTM layers, following the modeling architecture described by <cite class="ltx_cite ltx_citemacro_citep">(Reddi et al., <a href="#bib.bib29" title="" class="ltx_ref">2021</a>)</cite>. For the small model, we use an embedding size of 96 and LSTM hidden size of 70, for a total of 1,984,348 parameters. For the large model, we use an embedding size of 192 with a hidden size of 140, for a total of 4,278,644 parameters.</p>
</div>
<div id="A5.p3" class="ltx_para">
<p id="A5.p3.1" class="ltx_p">All models are built in the haiku framework.<span id="footnote9" class="ltx_note ltx_role_footnote"><sup class="ltx_note_mark">9</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">9</sup><span class="ltx_tag ltx_tag_note">9</span><a target="_blank" href="https://dm-haiku.readthedocs.io/en/latest/" title="" class="ltx_ref ltx_url ltx_font_typewriter">https://dm-haiku.readthedocs.io/en/latest/</a></span></span></span></p>
</div>
</section>
<section id="A6" class="ltx_appendix">
<h2 class="ltx_title ltx_title_appendix">
<span class="ltx_tag ltx_tag_appendix">Appendix F </span>Hyper-Parameter Tuning</h2>

<div id="A6.p1" class="ltx_para">
<p id="A6.p1.6" class="ltx_p">For all runs, we tune hyper-parameters to maximize the accuracy on held-out data. We use the Vizier hyper-parameter tuning service <cite class="ltx_cite ltx_citemacro_citep">(Golovin et al., <a href="#bib.bib9" title="" class="ltx_ref">2017</a>)</cite> with the default setting, with 64 concurrent trials to a max of 1024 trials. For <span id="A6.p1.6.1" class="ltx_text ltx_font_smallcaps">FedAvg</span> runs, we tune a single client learning rate, and server learning rates for the small and large models. Learning rates are all tuned on the range <math id="A6.p1.1.m1.2" class="ltx_Math" alttext="(0.0001,0.1)" display="inline"><semantics id="A6.p1.1.m1.2a"><mrow id="A6.p1.1.m1.2.3.2" xref="A6.p1.1.m1.2.3.1.cmml"><mo stretchy="false" id="A6.p1.1.m1.2.3.2.1" xref="A6.p1.1.m1.2.3.1.cmml">(</mo><mn id="A6.p1.1.m1.1.1" xref="A6.p1.1.m1.1.1.cmml">0.0001</mn><mo id="A6.p1.1.m1.2.3.2.2" xref="A6.p1.1.m1.2.3.1.cmml">,</mo><mn id="A6.p1.1.m1.2.2" xref="A6.p1.1.m1.2.2.cmml">0.1</mn><mo stretchy="false" id="A6.p1.1.m1.2.3.2.3" xref="A6.p1.1.m1.2.3.1.cmml">)</mo></mrow><annotation-xml encoding="MathML-Content" id="A6.p1.1.m1.2b"><interval closure="open" id="A6.p1.1.m1.2.3.1.cmml" xref="A6.p1.1.m1.2.3.2"><cn type="float" id="A6.p1.1.m1.1.1.cmml" xref="A6.p1.1.m1.1.1">0.0001</cn><cn type="float" id="A6.p1.1.m1.2.2.cmml" xref="A6.p1.1.m1.2.2">0.1</cn></interval></annotation-xml><annotation encoding="application/x-tex" id="A6.p1.1.m1.2c">(0.0001,0.1)</annotation></semantics></math>, which is explored on a log scale. When running <span id="A6.p1.6.2" class="ltx_text ltx_font_smallcaps">PeriodicCodist</span>  we additionally tune learning rates for the large model and small model distillation optimizers. We also tune decay coefficients for those learning rates, tuned on <math id="A6.p1.2.m2.2" class="ltx_Math" alttext="(0,1)" display="inline"><semantics id="A6.p1.2.m2.2a"><mrow id="A6.p1.2.m2.2.3.2" xref="A6.p1.2.m2.2.3.1.cmml"><mo stretchy="false" id="A6.p1.2.m2.2.3.2.1" xref="A6.p1.2.m2.2.3.1.cmml">(</mo><mn id="A6.p1.2.m2.1.1" xref="A6.p1.2.m2.1.1.cmml">0</mn><mo id="A6.p1.2.m2.2.3.2.2" xref="A6.p1.2.m2.2.3.1.cmml">,</mo><mn id="A6.p1.2.m2.2.2" xref="A6.p1.2.m2.2.2.cmml">1</mn><mo stretchy="false" id="A6.p1.2.m2.2.3.2.3" xref="A6.p1.2.m2.2.3.1.cmml">)</mo></mrow><annotation-xml encoding="MathML-Content" id="A6.p1.2.m2.2b"><interval closure="open" id="A6.p1.2.m2.2.3.1.cmml" xref="A6.p1.2.m2.2.3.2"><cn type="integer" id="A6.p1.2.m2.1.1.cmml" xref="A6.p1.2.m2.1.1">0</cn><cn type="integer" id="A6.p1.2.m2.2.2.cmml" xref="A6.p1.2.m2.2.2">1</cn></interval></annotation-xml><annotation encoding="application/x-tex" id="A6.p1.2.m2.2c">(0,1)</annotation></semantics></math> on a log scale. We further tune temperature coefficients on <math id="A6.p1.3.m3.2" class="ltx_Math" alttext="(0.1,10)" display="inline"><semantics id="A6.p1.3.m3.2a"><mrow id="A6.p1.3.m3.2.3.2" xref="A6.p1.3.m3.2.3.1.cmml"><mo stretchy="false" id="A6.p1.3.m3.2.3.2.1" xref="A6.p1.3.m3.2.3.1.cmml">(</mo><mn id="A6.p1.3.m3.1.1" xref="A6.p1.3.m3.1.1.cmml">0.1</mn><mo id="A6.p1.3.m3.2.3.2.2" xref="A6.p1.3.m3.2.3.1.cmml">,</mo><mn id="A6.p1.3.m3.2.2" xref="A6.p1.3.m3.2.2.cmml">10</mn><mo stretchy="false" id="A6.p1.3.m3.2.3.2.3" xref="A6.p1.3.m3.2.3.1.cmml">)</mo></mrow><annotation-xml encoding="MathML-Content" id="A6.p1.3.m3.2b"><interval closure="open" id="A6.p1.3.m3.2.3.1.cmml" xref="A6.p1.3.m3.2.3.2"><cn type="float" id="A6.p1.3.m3.1.1.cmml" xref="A6.p1.3.m3.1.1">0.1</cn><cn type="integer" id="A6.p1.3.m3.2.2.cmml" xref="A6.p1.3.m3.2.2">10</cn></interval></annotation-xml><annotation encoding="application/x-tex" id="A6.p1.3.m3.2c">(0.1,10)</annotation></semantics></math> and server regularization interpolating variables on <math id="A6.p1.4.m4.2" class="ltx_Math" alttext="(0.001,0.5)" display="inline"><semantics id="A6.p1.4.m4.2a"><mrow id="A6.p1.4.m4.2.3.2" xref="A6.p1.4.m4.2.3.1.cmml"><mo stretchy="false" id="A6.p1.4.m4.2.3.2.1" xref="A6.p1.4.m4.2.3.1.cmml">(</mo><mn id="A6.p1.4.m4.1.1" xref="A6.p1.4.m4.1.1.cmml">0.001</mn><mo id="A6.p1.4.m4.2.3.2.2" xref="A6.p1.4.m4.2.3.1.cmml">,</mo><mn id="A6.p1.4.m4.2.2" xref="A6.p1.4.m4.2.2.cmml">0.5</mn><mo stretchy="false" id="A6.p1.4.m4.2.3.2.3" xref="A6.p1.4.m4.2.3.1.cmml">)</mo></mrow><annotation-xml encoding="MathML-Content" id="A6.p1.4.m4.2b"><interval closure="open" id="A6.p1.4.m4.2.3.1.cmml" xref="A6.p1.4.m4.2.3.2"><cn type="float" id="A6.p1.4.m4.1.1.cmml" xref="A6.p1.4.m4.1.1">0.001</cn><cn type="float" id="A6.p1.4.m4.2.2.cmml" xref="A6.p1.4.m4.2.2">0.5</cn></interval></annotation-xml><annotation encoding="application/x-tex" id="A6.p1.4.m4.2c">(0.001,0.5)</annotation></semantics></math>, both also on log scales. For <span id="A6.p1.6.3" class="ltx_text ltx_font_smallcaps">MergedCodist</span> runs, we tune all of the above, and additionally tune the interpolating variable <math id="A6.p1.5.m5.1" class="ltx_Math" alttext="\alpha" display="inline"><semantics id="A6.p1.5.m5.1a"><mi id="A6.p1.5.m5.1.1" xref="A6.p1.5.m5.1.1.cmml">α</mi><annotation-xml encoding="MathML-Content" id="A6.p1.5.m5.1b"><ci id="A6.p1.5.m5.1.1.cmml" xref="A6.p1.5.m5.1.1">𝛼</ci></annotation-xml><annotation encoding="application/x-tex" id="A6.p1.5.m5.1c">\alpha</annotation></semantics></math> on a linear scale on the range <math id="A6.p1.6.m6.2" class="ltx_Math" alttext="(0.05,0.95)" display="inline"><semantics id="A6.p1.6.m6.2a"><mrow id="A6.p1.6.m6.2.3.2" xref="A6.p1.6.m6.2.3.1.cmml"><mo stretchy="false" id="A6.p1.6.m6.2.3.2.1" xref="A6.p1.6.m6.2.3.1.cmml">(</mo><mn id="A6.p1.6.m6.1.1" xref="A6.p1.6.m6.1.1.cmml">0.05</mn><mo id="A6.p1.6.m6.2.3.2.2" xref="A6.p1.6.m6.2.3.1.cmml">,</mo><mn id="A6.p1.6.m6.2.2" xref="A6.p1.6.m6.2.2.cmml">0.95</mn><mo stretchy="false" id="A6.p1.6.m6.2.3.2.3" xref="A6.p1.6.m6.2.3.1.cmml">)</mo></mrow><annotation-xml encoding="MathML-Content" id="A6.p1.6.m6.2b"><interval closure="open" id="A6.p1.6.m6.2.3.1.cmml" xref="A6.p1.6.m6.2.3.2"><cn type="float" id="A6.p1.6.m6.1.1.cmml" xref="A6.p1.6.m6.1.1">0.05</cn><cn type="float" id="A6.p1.6.m6.2.2.cmml" xref="A6.p1.6.m6.2.2">0.95</cn></interval></annotation-xml><annotation encoding="application/x-tex" id="A6.p1.6.m6.2c">(0.05,0.95)</annotation></semantics></math>.</p>
</div>
</section>
<section id="A7" class="ltx_appendix">
<h2 class="ltx_title ltx_title_appendix">
<span class="ltx_tag ltx_tag_appendix">Appendix G </span>Contractions for C4-MOD tokenization</h2>

<div id="A7.p1" class="ltx_para">
<p id="A7.p1.1" class="ltx_p">After sentence-tokenizing, word-tokenizing, and lower-casing the C4 data, we manually corrected the tokenization of punctuation with the following list of replacements:</p>
</div>
<div class="ltx_pagination ltx_role_start_3_columns"></div>
<div id="A7.p2" class="ltx_para">
<ul id="A7.I1" class="ltx_itemize">
<li id="A7.I1.i1" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="A7.I1.i1.p1" class="ltx_para">
<p id="A7.I1.i1.p1.1" class="ltx_p"><span id="A7.I1.i1.p1.1.1" class="ltx_text ltx_font_typewriter">aren ’ t</span> <math id="A7.I1.i1.p1.1.m1.1" class="ltx_Math" alttext="\rightarrow" display="inline"><semantics id="A7.I1.i1.p1.1.m1.1a"><mo stretchy="false" id="A7.I1.i1.p1.1.m1.1.1" xref="A7.I1.i1.p1.1.m1.1.1.cmml">→</mo><annotation-xml encoding="MathML-Content" id="A7.I1.i1.p1.1.m1.1b"><ci id="A7.I1.i1.p1.1.m1.1.1.cmml" xref="A7.I1.i1.p1.1.m1.1.1">→</ci></annotation-xml><annotation encoding="application/x-tex" id="A7.I1.i1.p1.1.m1.1c">\rightarrow</annotation></semantics></math> <span id="A7.I1.i1.p1.1.2" class="ltx_text ltx_font_typewriter">aren’t</span></p>
</div>
</li>
<li id="A7.I1.i2" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="A7.I1.i2.p1" class="ltx_para">
<p id="A7.I1.i2.p1.1" class="ltx_p"><span id="A7.I1.i2.p1.1.1" class="ltx_text ltx_font_typewriter">can ’ t</span> <math id="A7.I1.i2.p1.1.m1.1" class="ltx_Math" alttext="\rightarrow" display="inline"><semantics id="A7.I1.i2.p1.1.m1.1a"><mo stretchy="false" id="A7.I1.i2.p1.1.m1.1.1" xref="A7.I1.i2.p1.1.m1.1.1.cmml">→</mo><annotation-xml encoding="MathML-Content" id="A7.I1.i2.p1.1.m1.1b"><ci id="A7.I1.i2.p1.1.m1.1.1.cmml" xref="A7.I1.i2.p1.1.m1.1.1">→</ci></annotation-xml><annotation encoding="application/x-tex" id="A7.I1.i2.p1.1.m1.1c">\rightarrow</annotation></semantics></math> <span id="A7.I1.i2.p1.1.2" class="ltx_text ltx_font_typewriter">can’t</span></p>
</div>
</li>
<li id="A7.I1.i3" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="A7.I1.i3.p1" class="ltx_para">
<p id="A7.I1.i3.p1.1" class="ltx_p"><span id="A7.I1.i3.p1.1.1" class="ltx_text ltx_font_typewriter">couldn ’ t</span> <math id="A7.I1.i3.p1.1.m1.1" class="ltx_Math" alttext="\rightarrow" display="inline"><semantics id="A7.I1.i3.p1.1.m1.1a"><mo stretchy="false" id="A7.I1.i3.p1.1.m1.1.1" xref="A7.I1.i3.p1.1.m1.1.1.cmml">→</mo><annotation-xml encoding="MathML-Content" id="A7.I1.i3.p1.1.m1.1b"><ci id="A7.I1.i3.p1.1.m1.1.1.cmml" xref="A7.I1.i3.p1.1.m1.1.1">→</ci></annotation-xml><annotation encoding="application/x-tex" id="A7.I1.i3.p1.1.m1.1c">\rightarrow</annotation></semantics></math> <span id="A7.I1.i3.p1.1.2" class="ltx_text ltx_font_typewriter">couldn’t</span></p>
</div>
</li>
<li id="A7.I1.i4" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="A7.I1.i4.p1" class="ltx_para">
<p id="A7.I1.i4.p1.1" class="ltx_p"><span id="A7.I1.i4.p1.1.1" class="ltx_text ltx_font_typewriter">didn ’ t</span> <math id="A7.I1.i4.p1.1.m1.1" class="ltx_Math" alttext="\rightarrow" display="inline"><semantics id="A7.I1.i4.p1.1.m1.1a"><mo stretchy="false" id="A7.I1.i4.p1.1.m1.1.1" xref="A7.I1.i4.p1.1.m1.1.1.cmml">→</mo><annotation-xml encoding="MathML-Content" id="A7.I1.i4.p1.1.m1.1b"><ci id="A7.I1.i4.p1.1.m1.1.1.cmml" xref="A7.I1.i4.p1.1.m1.1.1">→</ci></annotation-xml><annotation encoding="application/x-tex" id="A7.I1.i4.p1.1.m1.1c">\rightarrow</annotation></semantics></math> <span id="A7.I1.i4.p1.1.2" class="ltx_text ltx_font_typewriter">didn’t</span></p>
</div>
</li>
<li id="A7.I1.i5" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="A7.I1.i5.p1" class="ltx_para">
<p id="A7.I1.i5.p1.1" class="ltx_p"><span id="A7.I1.i5.p1.1.1" class="ltx_text ltx_font_typewriter">doesn ’ t</span> <math id="A7.I1.i5.p1.1.m1.1" class="ltx_Math" alttext="\rightarrow" display="inline"><semantics id="A7.I1.i5.p1.1.m1.1a"><mo stretchy="false" id="A7.I1.i5.p1.1.m1.1.1" xref="A7.I1.i5.p1.1.m1.1.1.cmml">→</mo><annotation-xml encoding="MathML-Content" id="A7.I1.i5.p1.1.m1.1b"><ci id="A7.I1.i5.p1.1.m1.1.1.cmml" xref="A7.I1.i5.p1.1.m1.1.1">→</ci></annotation-xml><annotation encoding="application/x-tex" id="A7.I1.i5.p1.1.m1.1c">\rightarrow</annotation></semantics></math> <span id="A7.I1.i5.p1.1.2" class="ltx_text ltx_font_typewriter">doesn’t</span></p>
</div>
</li>
<li id="A7.I1.i6" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="A7.I1.i6.p1" class="ltx_para">
<p id="A7.I1.i6.p1.1" class="ltx_p"><span id="A7.I1.i6.p1.1.1" class="ltx_text ltx_font_typewriter">don ’ t</span> <math id="A7.I1.i6.p1.1.m1.1" class="ltx_Math" alttext="\rightarrow" display="inline"><semantics id="A7.I1.i6.p1.1.m1.1a"><mo stretchy="false" id="A7.I1.i6.p1.1.m1.1.1" xref="A7.I1.i6.p1.1.m1.1.1.cmml">→</mo><annotation-xml encoding="MathML-Content" id="A7.I1.i6.p1.1.m1.1b"><ci id="A7.I1.i6.p1.1.m1.1.1.cmml" xref="A7.I1.i6.p1.1.m1.1.1">→</ci></annotation-xml><annotation encoding="application/x-tex" id="A7.I1.i6.p1.1.m1.1c">\rightarrow</annotation></semantics></math> <span id="A7.I1.i6.p1.1.2" class="ltx_text ltx_font_typewriter">don’t</span></p>
</div>
</li>
<li id="A7.I1.i7" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="A7.I1.i7.p1" class="ltx_para">
<p id="A7.I1.i7.p1.1" class="ltx_p"><span id="A7.I1.i7.p1.1.1" class="ltx_text ltx_font_typewriter">hadn ’ t</span> <math id="A7.I1.i7.p1.1.m1.1" class="ltx_Math" alttext="\rightarrow" display="inline"><semantics id="A7.I1.i7.p1.1.m1.1a"><mo stretchy="false" id="A7.I1.i7.p1.1.m1.1.1" xref="A7.I1.i7.p1.1.m1.1.1.cmml">→</mo><annotation-xml encoding="MathML-Content" id="A7.I1.i7.p1.1.m1.1b"><ci id="A7.I1.i7.p1.1.m1.1.1.cmml" xref="A7.I1.i7.p1.1.m1.1.1">→</ci></annotation-xml><annotation encoding="application/x-tex" id="A7.I1.i7.p1.1.m1.1c">\rightarrow</annotation></semantics></math> <span id="A7.I1.i7.p1.1.2" class="ltx_text ltx_font_typewriter">hadn’t</span></p>
</div>
</li>
<li id="A7.I1.i8" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="A7.I1.i8.p1" class="ltx_para">
<p id="A7.I1.i8.p1.1" class="ltx_p"><span id="A7.I1.i8.p1.1.1" class="ltx_text ltx_font_typewriter">hasn ’ t</span> <math id="A7.I1.i8.p1.1.m1.1" class="ltx_Math" alttext="\rightarrow" display="inline"><semantics id="A7.I1.i8.p1.1.m1.1a"><mo stretchy="false" id="A7.I1.i8.p1.1.m1.1.1" xref="A7.I1.i8.p1.1.m1.1.1.cmml">→</mo><annotation-xml encoding="MathML-Content" id="A7.I1.i8.p1.1.m1.1b"><ci id="A7.I1.i8.p1.1.m1.1.1.cmml" xref="A7.I1.i8.p1.1.m1.1.1">→</ci></annotation-xml><annotation encoding="application/x-tex" id="A7.I1.i8.p1.1.m1.1c">\rightarrow</annotation></semantics></math> <span id="A7.I1.i8.p1.1.2" class="ltx_text ltx_font_typewriter">hasn’t</span></p>
</div>
</li>
<li id="A7.I1.i9" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="A7.I1.i9.p1" class="ltx_para">
<p id="A7.I1.i9.p1.1" class="ltx_p"><span id="A7.I1.i9.p1.1.1" class="ltx_text ltx_font_typewriter">haven ’ t</span> <math id="A7.I1.i9.p1.1.m1.1" class="ltx_Math" alttext="\rightarrow" display="inline"><semantics id="A7.I1.i9.p1.1.m1.1a"><mo stretchy="false" id="A7.I1.i9.p1.1.m1.1.1" xref="A7.I1.i9.p1.1.m1.1.1.cmml">→</mo><annotation-xml encoding="MathML-Content" id="A7.I1.i9.p1.1.m1.1b"><ci id="A7.I1.i9.p1.1.m1.1.1.cmml" xref="A7.I1.i9.p1.1.m1.1.1">→</ci></annotation-xml><annotation encoding="application/x-tex" id="A7.I1.i9.p1.1.m1.1c">\rightarrow</annotation></semantics></math> <span id="A7.I1.i9.p1.1.2" class="ltx_text ltx_font_typewriter">haven’t</span></p>
</div>
</li>
<li id="A7.I1.i10" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="A7.I1.i10.p1" class="ltx_para">
<p id="A7.I1.i10.p1.1" class="ltx_p"><span id="A7.I1.i10.p1.1.1" class="ltx_text ltx_font_typewriter">he ’ d</span> <math id="A7.I1.i10.p1.1.m1.1" class="ltx_Math" alttext="\rightarrow" display="inline"><semantics id="A7.I1.i10.p1.1.m1.1a"><mo stretchy="false" id="A7.I1.i10.p1.1.m1.1.1" xref="A7.I1.i10.p1.1.m1.1.1.cmml">→</mo><annotation-xml encoding="MathML-Content" id="A7.I1.i10.p1.1.m1.1b"><ci id="A7.I1.i10.p1.1.m1.1.1.cmml" xref="A7.I1.i10.p1.1.m1.1.1">→</ci></annotation-xml><annotation encoding="application/x-tex" id="A7.I1.i10.p1.1.m1.1c">\rightarrow</annotation></semantics></math> <span id="A7.I1.i10.p1.1.2" class="ltx_text ltx_font_typewriter">he’d</span></p>
</div>
</li>
<li id="A7.I1.i11" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="A7.I1.i11.p1" class="ltx_para">
<p id="A7.I1.i11.p1.1" class="ltx_p"><span id="A7.I1.i11.p1.1.1" class="ltx_text ltx_font_typewriter">he ’ ll</span> <math id="A7.I1.i11.p1.1.m1.1" class="ltx_Math" alttext="\rightarrow" display="inline"><semantics id="A7.I1.i11.p1.1.m1.1a"><mo stretchy="false" id="A7.I1.i11.p1.1.m1.1.1" xref="A7.I1.i11.p1.1.m1.1.1.cmml">→</mo><annotation-xml encoding="MathML-Content" id="A7.I1.i11.p1.1.m1.1b"><ci id="A7.I1.i11.p1.1.m1.1.1.cmml" xref="A7.I1.i11.p1.1.m1.1.1">→</ci></annotation-xml><annotation encoding="application/x-tex" id="A7.I1.i11.p1.1.m1.1c">\rightarrow</annotation></semantics></math> <span id="A7.I1.i11.p1.1.2" class="ltx_text ltx_font_typewriter">he’ll</span></p>
</div>
</li>
<li id="A7.I1.i12" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="A7.I1.i12.p1" class="ltx_para">
<p id="A7.I1.i12.p1.1" class="ltx_p"><span id="A7.I1.i12.p1.1.1" class="ltx_text ltx_font_typewriter">he ’ s</span> <math id="A7.I1.i12.p1.1.m1.1" class="ltx_Math" alttext="\rightarrow" display="inline"><semantics id="A7.I1.i12.p1.1.m1.1a"><mo stretchy="false" id="A7.I1.i12.p1.1.m1.1.1" xref="A7.I1.i12.p1.1.m1.1.1.cmml">→</mo><annotation-xml encoding="MathML-Content" id="A7.I1.i12.p1.1.m1.1b"><ci id="A7.I1.i12.p1.1.m1.1.1.cmml" xref="A7.I1.i12.p1.1.m1.1.1">→</ci></annotation-xml><annotation encoding="application/x-tex" id="A7.I1.i12.p1.1.m1.1c">\rightarrow</annotation></semantics></math> <span id="A7.I1.i12.p1.1.2" class="ltx_text ltx_font_typewriter">he’s</span></p>
</div>
</li>
<li id="A7.I1.i13" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="A7.I1.i13.p1" class="ltx_para">
<p id="A7.I1.i13.p1.1" class="ltx_p"><span id="A7.I1.i13.p1.1.1" class="ltx_text ltx_font_typewriter">i ’ d</span> <math id="A7.I1.i13.p1.1.m1.1" class="ltx_Math" alttext="\rightarrow" display="inline"><semantics id="A7.I1.i13.p1.1.m1.1a"><mo stretchy="false" id="A7.I1.i13.p1.1.m1.1.1" xref="A7.I1.i13.p1.1.m1.1.1.cmml">→</mo><annotation-xml encoding="MathML-Content" id="A7.I1.i13.p1.1.m1.1b"><ci id="A7.I1.i13.p1.1.m1.1.1.cmml" xref="A7.I1.i13.p1.1.m1.1.1">→</ci></annotation-xml><annotation encoding="application/x-tex" id="A7.I1.i13.p1.1.m1.1c">\rightarrow</annotation></semantics></math> <span id="A7.I1.i13.p1.1.2" class="ltx_text ltx_font_typewriter">i’d</span></p>
</div>
</li>
<li id="A7.I1.i14" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="A7.I1.i14.p1" class="ltx_para">
<p id="A7.I1.i14.p1.1" class="ltx_p"><span id="A7.I1.i14.p1.1.1" class="ltx_text ltx_font_typewriter">it ’ s</span> <math id="A7.I1.i14.p1.1.m1.1" class="ltx_Math" alttext="\rightarrow" display="inline"><semantics id="A7.I1.i14.p1.1.m1.1a"><mo stretchy="false" id="A7.I1.i14.p1.1.m1.1.1" xref="A7.I1.i14.p1.1.m1.1.1.cmml">→</mo><annotation-xml encoding="MathML-Content" id="A7.I1.i14.p1.1.m1.1b"><ci id="A7.I1.i14.p1.1.m1.1.1.cmml" xref="A7.I1.i14.p1.1.m1.1.1">→</ci></annotation-xml><annotation encoding="application/x-tex" id="A7.I1.i14.p1.1.m1.1c">\rightarrow</annotation></semantics></math> <span id="A7.I1.i14.p1.1.2" class="ltx_text ltx_font_typewriter">it’s</span></p>
</div>
</li>
<li id="A7.I1.i15" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="A7.I1.i15.p1" class="ltx_para">
<p id="A7.I1.i15.p1.1" class="ltx_p"><span id="A7.I1.i15.p1.1.1" class="ltx_text ltx_font_typewriter">i ’ ll</span> <math id="A7.I1.i15.p1.1.m1.1" class="ltx_Math" alttext="\rightarrow" display="inline"><semantics id="A7.I1.i15.p1.1.m1.1a"><mo stretchy="false" id="A7.I1.i15.p1.1.m1.1.1" xref="A7.I1.i15.p1.1.m1.1.1.cmml">→</mo><annotation-xml encoding="MathML-Content" id="A7.I1.i15.p1.1.m1.1b"><ci id="A7.I1.i15.p1.1.m1.1.1.cmml" xref="A7.I1.i15.p1.1.m1.1.1">→</ci></annotation-xml><annotation encoding="application/x-tex" id="A7.I1.i15.p1.1.m1.1c">\rightarrow</annotation></semantics></math> <span id="A7.I1.i15.p1.1.2" class="ltx_text ltx_font_typewriter">i’ll</span></p>
</div>
</li>
<li id="A7.I1.i16" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="A7.I1.i16.p1" class="ltx_para">
<p id="A7.I1.i16.p1.1" class="ltx_p"><span id="A7.I1.i16.p1.1.1" class="ltx_text ltx_font_typewriter">i ’ m</span> <math id="A7.I1.i16.p1.1.m1.1" class="ltx_Math" alttext="\rightarrow" display="inline"><semantics id="A7.I1.i16.p1.1.m1.1a"><mo stretchy="false" id="A7.I1.i16.p1.1.m1.1.1" xref="A7.I1.i16.p1.1.m1.1.1.cmml">→</mo><annotation-xml encoding="MathML-Content" id="A7.I1.i16.p1.1.m1.1b"><ci id="A7.I1.i16.p1.1.m1.1.1.cmml" xref="A7.I1.i16.p1.1.m1.1.1">→</ci></annotation-xml><annotation encoding="application/x-tex" id="A7.I1.i16.p1.1.m1.1c">\rightarrow</annotation></semantics></math> <span id="A7.I1.i16.p1.1.2" class="ltx_text ltx_font_typewriter">i’m</span></p>
</div>
</li>
<li id="A7.I1.i17" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="A7.I1.i17.p1" class="ltx_para">
<p id="A7.I1.i17.p1.1" class="ltx_p"><span id="A7.I1.i17.p1.1.1" class="ltx_text ltx_font_typewriter">i ’ ve</span> <math id="A7.I1.i17.p1.1.m1.1" class="ltx_Math" alttext="\rightarrow" display="inline"><semantics id="A7.I1.i17.p1.1.m1.1a"><mo stretchy="false" id="A7.I1.i17.p1.1.m1.1.1" xref="A7.I1.i17.p1.1.m1.1.1.cmml">→</mo><annotation-xml encoding="MathML-Content" id="A7.I1.i17.p1.1.m1.1b"><ci id="A7.I1.i17.p1.1.m1.1.1.cmml" xref="A7.I1.i17.p1.1.m1.1.1">→</ci></annotation-xml><annotation encoding="application/x-tex" id="A7.I1.i17.p1.1.m1.1c">\rightarrow</annotation></semantics></math> <span id="A7.I1.i17.p1.1.2" class="ltx_text ltx_font_typewriter">i’ve</span></p>
</div>
</li>
<li id="A7.I1.i18" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="A7.I1.i18.p1" class="ltx_para">
<p id="A7.I1.i18.p1.1" class="ltx_p"><span id="A7.I1.i18.p1.1.1" class="ltx_text ltx_font_typewriter">isn ’ t</span> <math id="A7.I1.i18.p1.1.m1.1" class="ltx_Math" alttext="\rightarrow" display="inline"><semantics id="A7.I1.i18.p1.1.m1.1a"><mo stretchy="false" id="A7.I1.i18.p1.1.m1.1.1" xref="A7.I1.i18.p1.1.m1.1.1.cmml">→</mo><annotation-xml encoding="MathML-Content" id="A7.I1.i18.p1.1.m1.1b"><ci id="A7.I1.i18.p1.1.m1.1.1.cmml" xref="A7.I1.i18.p1.1.m1.1.1">→</ci></annotation-xml><annotation encoding="application/x-tex" id="A7.I1.i18.p1.1.m1.1c">\rightarrow</annotation></semantics></math> <span id="A7.I1.i18.p1.1.2" class="ltx_text ltx_font_typewriter">isn’t</span></p>
</div>
</li>
<li id="A7.I1.i19" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="A7.I1.i19.p1" class="ltx_para">
<p id="A7.I1.i19.p1.1" class="ltx_p"><span id="A7.I1.i19.p1.1.1" class="ltx_text ltx_font_typewriter">let ’ s</span> <math id="A7.I1.i19.p1.1.m1.1" class="ltx_Math" alttext="\rightarrow" display="inline"><semantics id="A7.I1.i19.p1.1.m1.1a"><mo stretchy="false" id="A7.I1.i19.p1.1.m1.1.1" xref="A7.I1.i19.p1.1.m1.1.1.cmml">→</mo><annotation-xml encoding="MathML-Content" id="A7.I1.i19.p1.1.m1.1b"><ci id="A7.I1.i19.p1.1.m1.1.1.cmml" xref="A7.I1.i19.p1.1.m1.1.1">→</ci></annotation-xml><annotation encoding="application/x-tex" id="A7.I1.i19.p1.1.m1.1c">\rightarrow</annotation></semantics></math> <span id="A7.I1.i19.p1.1.2" class="ltx_text ltx_font_typewriter">let’s</span></p>
</div>
</li>
<li id="A7.I1.i20" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="A7.I1.i20.p1" class="ltx_para">
<p id="A7.I1.i20.p1.1" class="ltx_p"><span id="A7.I1.i20.p1.1.1" class="ltx_text ltx_font_typewriter">mightn ’ t</span> <math id="A7.I1.i20.p1.1.m1.1" class="ltx_Math" alttext="\rightarrow" display="inline"><semantics id="A7.I1.i20.p1.1.m1.1a"><mo stretchy="false" id="A7.I1.i20.p1.1.m1.1.1" xref="A7.I1.i20.p1.1.m1.1.1.cmml">→</mo><annotation-xml encoding="MathML-Content" id="A7.I1.i20.p1.1.m1.1b"><ci id="A7.I1.i20.p1.1.m1.1.1.cmml" xref="A7.I1.i20.p1.1.m1.1.1">→</ci></annotation-xml><annotation encoding="application/x-tex" id="A7.I1.i20.p1.1.m1.1c">\rightarrow</annotation></semantics></math> <span id="A7.I1.i20.p1.1.2" class="ltx_text ltx_font_typewriter">mightn’t</span></p>
</div>
</li>
<li id="A7.I1.i21" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="A7.I1.i21.p1" class="ltx_para">
<p id="A7.I1.i21.p1.1" class="ltx_p"><span id="A7.I1.i21.p1.1.1" class="ltx_text ltx_font_typewriter">mustn ’ t</span> <math id="A7.I1.i21.p1.1.m1.1" class="ltx_Math" alttext="\rightarrow" display="inline"><semantics id="A7.I1.i21.p1.1.m1.1a"><mo stretchy="false" id="A7.I1.i21.p1.1.m1.1.1" xref="A7.I1.i21.p1.1.m1.1.1.cmml">→</mo><annotation-xml encoding="MathML-Content" id="A7.I1.i21.p1.1.m1.1b"><ci id="A7.I1.i21.p1.1.m1.1.1.cmml" xref="A7.I1.i21.p1.1.m1.1.1">→</ci></annotation-xml><annotation encoding="application/x-tex" id="A7.I1.i21.p1.1.m1.1c">\rightarrow</annotation></semantics></math> <span id="A7.I1.i21.p1.1.2" class="ltx_text ltx_font_typewriter">mustn’t</span></p>
</div>
</li>
<li id="A7.I1.i22" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="A7.I1.i22.p1" class="ltx_para">
<p id="A7.I1.i22.p1.1" class="ltx_p"><span id="A7.I1.i22.p1.1.1" class="ltx_text ltx_font_typewriter">shan ’ t</span> <math id="A7.I1.i22.p1.1.m1.1" class="ltx_Math" alttext="\rightarrow" display="inline"><semantics id="A7.I1.i22.p1.1.m1.1a"><mo stretchy="false" id="A7.I1.i22.p1.1.m1.1.1" xref="A7.I1.i22.p1.1.m1.1.1.cmml">→</mo><annotation-xml encoding="MathML-Content" id="A7.I1.i22.p1.1.m1.1b"><ci id="A7.I1.i22.p1.1.m1.1.1.cmml" xref="A7.I1.i22.p1.1.m1.1.1">→</ci></annotation-xml><annotation encoding="application/x-tex" id="A7.I1.i22.p1.1.m1.1c">\rightarrow</annotation></semantics></math> <span id="A7.I1.i22.p1.1.2" class="ltx_text ltx_font_typewriter">shan’t</span></p>
</div>
</li>
<li id="A7.I1.i23" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="A7.I1.i23.p1" class="ltx_para">
<p id="A7.I1.i23.p1.1" class="ltx_p"><span id="A7.I1.i23.p1.1.1" class="ltx_text ltx_font_typewriter">she ’ d</span> <math id="A7.I1.i23.p1.1.m1.1" class="ltx_Math" alttext="\rightarrow" display="inline"><semantics id="A7.I1.i23.p1.1.m1.1a"><mo stretchy="false" id="A7.I1.i23.p1.1.m1.1.1" xref="A7.I1.i23.p1.1.m1.1.1.cmml">→</mo><annotation-xml encoding="MathML-Content" id="A7.I1.i23.p1.1.m1.1b"><ci id="A7.I1.i23.p1.1.m1.1.1.cmml" xref="A7.I1.i23.p1.1.m1.1.1">→</ci></annotation-xml><annotation encoding="application/x-tex" id="A7.I1.i23.p1.1.m1.1c">\rightarrow</annotation></semantics></math> <span id="A7.I1.i23.p1.1.2" class="ltx_text ltx_font_typewriter">she’d</span></p>
</div>
</li>
<li id="A7.I1.i24" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="A7.I1.i24.p1" class="ltx_para">
<p id="A7.I1.i24.p1.1" class="ltx_p"><span id="A7.I1.i24.p1.1.1" class="ltx_text ltx_font_typewriter">she ’ ll</span> <math id="A7.I1.i24.p1.1.m1.1" class="ltx_Math" alttext="\rightarrow" display="inline"><semantics id="A7.I1.i24.p1.1.m1.1a"><mo stretchy="false" id="A7.I1.i24.p1.1.m1.1.1" xref="A7.I1.i24.p1.1.m1.1.1.cmml">→</mo><annotation-xml encoding="MathML-Content" id="A7.I1.i24.p1.1.m1.1b"><ci id="A7.I1.i24.p1.1.m1.1.1.cmml" xref="A7.I1.i24.p1.1.m1.1.1">→</ci></annotation-xml><annotation encoding="application/x-tex" id="A7.I1.i24.p1.1.m1.1c">\rightarrow</annotation></semantics></math> <span id="A7.I1.i24.p1.1.2" class="ltx_text ltx_font_typewriter">she’ll</span></p>
</div>
</li>
<li id="A7.I1.i25" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="A7.I1.i25.p1" class="ltx_para">
<p id="A7.I1.i25.p1.1" class="ltx_p"><span id="A7.I1.i25.p1.1.1" class="ltx_text ltx_font_typewriter">she ’ s</span> <math id="A7.I1.i25.p1.1.m1.1" class="ltx_Math" alttext="\rightarrow" display="inline"><semantics id="A7.I1.i25.p1.1.m1.1a"><mo stretchy="false" id="A7.I1.i25.p1.1.m1.1.1" xref="A7.I1.i25.p1.1.m1.1.1.cmml">→</mo><annotation-xml encoding="MathML-Content" id="A7.I1.i25.p1.1.m1.1b"><ci id="A7.I1.i25.p1.1.m1.1.1.cmml" xref="A7.I1.i25.p1.1.m1.1.1">→</ci></annotation-xml><annotation encoding="application/x-tex" id="A7.I1.i25.p1.1.m1.1c">\rightarrow</annotation></semantics></math> <span id="A7.I1.i25.p1.1.2" class="ltx_text ltx_font_typewriter">she’s</span></p>
</div>
</li>
<li id="A7.I1.i26" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="A7.I1.i26.p1" class="ltx_para">
<p id="A7.I1.i26.p1.1" class="ltx_p"><span id="A7.I1.i26.p1.1.1" class="ltx_text ltx_font_typewriter">shouldn ’ t</span> <math id="A7.I1.i26.p1.1.m1.1" class="ltx_Math" alttext="\rightarrow" display="inline"><semantics id="A7.I1.i26.p1.1.m1.1a"><mo stretchy="false" id="A7.I1.i26.p1.1.m1.1.1" xref="A7.I1.i26.p1.1.m1.1.1.cmml">→</mo><annotation-xml encoding="MathML-Content" id="A7.I1.i26.p1.1.m1.1b"><ci id="A7.I1.i26.p1.1.m1.1.1.cmml" xref="A7.I1.i26.p1.1.m1.1.1">→</ci></annotation-xml><annotation encoding="application/x-tex" id="A7.I1.i26.p1.1.m1.1c">\rightarrow</annotation></semantics></math> <span id="A7.I1.i26.p1.1.2" class="ltx_text ltx_font_typewriter">shouldn’t</span></p>
</div>
</li>
<li id="A7.I1.i27" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="A7.I1.i27.p1" class="ltx_para">
<p id="A7.I1.i27.p1.1" class="ltx_p"><span id="A7.I1.i27.p1.1.1" class="ltx_text ltx_font_typewriter">that ’ s</span> <math id="A7.I1.i27.p1.1.m1.1" class="ltx_Math" alttext="\rightarrow" display="inline"><semantics id="A7.I1.i27.p1.1.m1.1a"><mo stretchy="false" id="A7.I1.i27.p1.1.m1.1.1" xref="A7.I1.i27.p1.1.m1.1.1.cmml">→</mo><annotation-xml encoding="MathML-Content" id="A7.I1.i27.p1.1.m1.1b"><ci id="A7.I1.i27.p1.1.m1.1.1.cmml" xref="A7.I1.i27.p1.1.m1.1.1">→</ci></annotation-xml><annotation encoding="application/x-tex" id="A7.I1.i27.p1.1.m1.1c">\rightarrow</annotation></semantics></math> <span id="A7.I1.i27.p1.1.2" class="ltx_text ltx_font_typewriter">that’s</span></p>
</div>
</li>
<li id="A7.I1.i28" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="A7.I1.i28.p1" class="ltx_para">
<p id="A7.I1.i28.p1.1" class="ltx_p"><span id="A7.I1.i28.p1.1.1" class="ltx_text ltx_font_typewriter">there ’ s</span> <math id="A7.I1.i28.p1.1.m1.1" class="ltx_Math" alttext="\rightarrow" display="inline"><semantics id="A7.I1.i28.p1.1.m1.1a"><mo stretchy="false" id="A7.I1.i28.p1.1.m1.1.1" xref="A7.I1.i28.p1.1.m1.1.1.cmml">→</mo><annotation-xml encoding="MathML-Content" id="A7.I1.i28.p1.1.m1.1b"><ci id="A7.I1.i28.p1.1.m1.1.1.cmml" xref="A7.I1.i28.p1.1.m1.1.1">→</ci></annotation-xml><annotation encoding="application/x-tex" id="A7.I1.i28.p1.1.m1.1c">\rightarrow</annotation></semantics></math> <span id="A7.I1.i28.p1.1.2" class="ltx_text ltx_font_typewriter">there’s</span></p>
</div>
</li>
<li id="A7.I1.i29" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="A7.I1.i29.p1" class="ltx_para">
<p id="A7.I1.i29.p1.1" class="ltx_p"><span id="A7.I1.i29.p1.1.1" class="ltx_text ltx_font_typewriter">they ’ d</span> <math id="A7.I1.i29.p1.1.m1.1" class="ltx_Math" alttext="\rightarrow" display="inline"><semantics id="A7.I1.i29.p1.1.m1.1a"><mo stretchy="false" id="A7.I1.i29.p1.1.m1.1.1" xref="A7.I1.i29.p1.1.m1.1.1.cmml">→</mo><annotation-xml encoding="MathML-Content" id="A7.I1.i29.p1.1.m1.1b"><ci id="A7.I1.i29.p1.1.m1.1.1.cmml" xref="A7.I1.i29.p1.1.m1.1.1">→</ci></annotation-xml><annotation encoding="application/x-tex" id="A7.I1.i29.p1.1.m1.1c">\rightarrow</annotation></semantics></math> <span id="A7.I1.i29.p1.1.2" class="ltx_text ltx_font_typewriter">they’d</span></p>
</div>
</li>
<li id="A7.I1.i30" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="A7.I1.i30.p1" class="ltx_para">
<p id="A7.I1.i30.p1.1" class="ltx_p"><span id="A7.I1.i30.p1.1.1" class="ltx_text ltx_font_typewriter">they ’ ll</span> <math id="A7.I1.i30.p1.1.m1.1" class="ltx_Math" alttext="\rightarrow" display="inline"><semantics id="A7.I1.i30.p1.1.m1.1a"><mo stretchy="false" id="A7.I1.i30.p1.1.m1.1.1" xref="A7.I1.i30.p1.1.m1.1.1.cmml">→</mo><annotation-xml encoding="MathML-Content" id="A7.I1.i30.p1.1.m1.1b"><ci id="A7.I1.i30.p1.1.m1.1.1.cmml" xref="A7.I1.i30.p1.1.m1.1.1">→</ci></annotation-xml><annotation encoding="application/x-tex" id="A7.I1.i30.p1.1.m1.1c">\rightarrow</annotation></semantics></math> <span id="A7.I1.i30.p1.1.2" class="ltx_text ltx_font_typewriter">they’ll</span></p>
</div>
</li>
<li id="A7.I1.i31" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="A7.I1.i31.p1" class="ltx_para">
<p id="A7.I1.i31.p1.1" class="ltx_p"><span id="A7.I1.i31.p1.1.1" class="ltx_text ltx_font_typewriter">they ’ re</span> <math id="A7.I1.i31.p1.1.m1.1" class="ltx_Math" alttext="\rightarrow" display="inline"><semantics id="A7.I1.i31.p1.1.m1.1a"><mo stretchy="false" id="A7.I1.i31.p1.1.m1.1.1" xref="A7.I1.i31.p1.1.m1.1.1.cmml">→</mo><annotation-xml encoding="MathML-Content" id="A7.I1.i31.p1.1.m1.1b"><ci id="A7.I1.i31.p1.1.m1.1.1.cmml" xref="A7.I1.i31.p1.1.m1.1.1">→</ci></annotation-xml><annotation encoding="application/x-tex" id="A7.I1.i31.p1.1.m1.1c">\rightarrow</annotation></semantics></math> <span id="A7.I1.i31.p1.1.2" class="ltx_text ltx_font_typewriter">they’re</span></p>
</div>
</li>
<li id="A7.I1.i32" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="A7.I1.i32.p1" class="ltx_para">
<p id="A7.I1.i32.p1.1" class="ltx_p"><span id="A7.I1.i32.p1.1.1" class="ltx_text ltx_font_typewriter">they ’ ve</span> <math id="A7.I1.i32.p1.1.m1.1" class="ltx_Math" alttext="\rightarrow" display="inline"><semantics id="A7.I1.i32.p1.1.m1.1a"><mo stretchy="false" id="A7.I1.i32.p1.1.m1.1.1" xref="A7.I1.i32.p1.1.m1.1.1.cmml">→</mo><annotation-xml encoding="MathML-Content" id="A7.I1.i32.p1.1.m1.1b"><ci id="A7.I1.i32.p1.1.m1.1.1.cmml" xref="A7.I1.i32.p1.1.m1.1.1">→</ci></annotation-xml><annotation encoding="application/x-tex" id="A7.I1.i32.p1.1.m1.1c">\rightarrow</annotation></semantics></math> <span id="A7.I1.i32.p1.1.2" class="ltx_text ltx_font_typewriter">they’ve</span></p>
</div>
</li>
<li id="A7.I1.i33" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="A7.I1.i33.p1" class="ltx_para">
<p id="A7.I1.i33.p1.1" class="ltx_p"><span id="A7.I1.i33.p1.1.1" class="ltx_text ltx_font_typewriter">we ’ d</span> <math id="A7.I1.i33.p1.1.m1.1" class="ltx_Math" alttext="\rightarrow" display="inline"><semantics id="A7.I1.i33.p1.1.m1.1a"><mo stretchy="false" id="A7.I1.i33.p1.1.m1.1.1" xref="A7.I1.i33.p1.1.m1.1.1.cmml">→</mo><annotation-xml encoding="MathML-Content" id="A7.I1.i33.p1.1.m1.1b"><ci id="A7.I1.i33.p1.1.m1.1.1.cmml" xref="A7.I1.i33.p1.1.m1.1.1">→</ci></annotation-xml><annotation encoding="application/x-tex" id="A7.I1.i33.p1.1.m1.1c">\rightarrow</annotation></semantics></math> <span id="A7.I1.i33.p1.1.2" class="ltx_text ltx_font_typewriter">we’d</span></p>
</div>
</li>
<li id="A7.I1.i34" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="A7.I1.i34.p1" class="ltx_para">
<p id="A7.I1.i34.p1.1" class="ltx_p"><span id="A7.I1.i34.p1.1.1" class="ltx_text ltx_font_typewriter">we ’ re</span> <math id="A7.I1.i34.p1.1.m1.1" class="ltx_Math" alttext="\rightarrow" display="inline"><semantics id="A7.I1.i34.p1.1.m1.1a"><mo stretchy="false" id="A7.I1.i34.p1.1.m1.1.1" xref="A7.I1.i34.p1.1.m1.1.1.cmml">→</mo><annotation-xml encoding="MathML-Content" id="A7.I1.i34.p1.1.m1.1b"><ci id="A7.I1.i34.p1.1.m1.1.1.cmml" xref="A7.I1.i34.p1.1.m1.1.1">→</ci></annotation-xml><annotation encoding="application/x-tex" id="A7.I1.i34.p1.1.m1.1c">\rightarrow</annotation></semantics></math> <span id="A7.I1.i34.p1.1.2" class="ltx_text ltx_font_typewriter">we’re</span></p>
</div>
</li>
<li id="A7.I1.i35" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="A7.I1.i35.p1" class="ltx_para">
<p id="A7.I1.i35.p1.1" class="ltx_p"><span id="A7.I1.i35.p1.1.1" class="ltx_text ltx_font_typewriter">we ’ ve</span> <math id="A7.I1.i35.p1.1.m1.1" class="ltx_Math" alttext="\rightarrow" display="inline"><semantics id="A7.I1.i35.p1.1.m1.1a"><mo stretchy="false" id="A7.I1.i35.p1.1.m1.1.1" xref="A7.I1.i35.p1.1.m1.1.1.cmml">→</mo><annotation-xml encoding="MathML-Content" id="A7.I1.i35.p1.1.m1.1b"><ci id="A7.I1.i35.p1.1.m1.1.1.cmml" xref="A7.I1.i35.p1.1.m1.1.1">→</ci></annotation-xml><annotation encoding="application/x-tex" id="A7.I1.i35.p1.1.m1.1c">\rightarrow</annotation></semantics></math> <span id="A7.I1.i35.p1.1.2" class="ltx_text ltx_font_typewriter">we’ve</span></p>
</div>
</li>
<li id="A7.I1.i36" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="A7.I1.i36.p1" class="ltx_para">
<p id="A7.I1.i36.p1.1" class="ltx_p"><span id="A7.I1.i36.p1.1.1" class="ltx_text ltx_font_typewriter">weren ’ t</span> <math id="A7.I1.i36.p1.1.m1.1" class="ltx_Math" alttext="\rightarrow" display="inline"><semantics id="A7.I1.i36.p1.1.m1.1a"><mo stretchy="false" id="A7.I1.i36.p1.1.m1.1.1" xref="A7.I1.i36.p1.1.m1.1.1.cmml">→</mo><annotation-xml encoding="MathML-Content" id="A7.I1.i36.p1.1.m1.1b"><ci id="A7.I1.i36.p1.1.m1.1.1.cmml" xref="A7.I1.i36.p1.1.m1.1.1">→</ci></annotation-xml><annotation encoding="application/x-tex" id="A7.I1.i36.p1.1.m1.1c">\rightarrow</annotation></semantics></math> <span id="A7.I1.i36.p1.1.2" class="ltx_text ltx_font_typewriter">weren’t</span></p>
</div>
</li>
<li id="A7.I1.i37" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="A7.I1.i37.p1" class="ltx_para">
<p id="A7.I1.i37.p1.1" class="ltx_p"><span id="A7.I1.i37.p1.1.1" class="ltx_text ltx_font_typewriter">what ’ ll</span> <math id="A7.I1.i37.p1.1.m1.1" class="ltx_Math" alttext="\rightarrow" display="inline"><semantics id="A7.I1.i37.p1.1.m1.1a"><mo stretchy="false" id="A7.I1.i37.p1.1.m1.1.1" xref="A7.I1.i37.p1.1.m1.1.1.cmml">→</mo><annotation-xml encoding="MathML-Content" id="A7.I1.i37.p1.1.m1.1b"><ci id="A7.I1.i37.p1.1.m1.1.1.cmml" xref="A7.I1.i37.p1.1.m1.1.1">→</ci></annotation-xml><annotation encoding="application/x-tex" id="A7.I1.i37.p1.1.m1.1c">\rightarrow</annotation></semantics></math> <span id="A7.I1.i37.p1.1.2" class="ltx_text ltx_font_typewriter">what’ll</span></p>
</div>
</li>
<li id="A7.I1.i38" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="A7.I1.i38.p1" class="ltx_para">
<p id="A7.I1.i38.p1.1" class="ltx_p"><span id="A7.I1.i38.p1.1.1" class="ltx_text ltx_font_typewriter">what ’ re</span> <math id="A7.I1.i38.p1.1.m1.1" class="ltx_Math" alttext="\rightarrow" display="inline"><semantics id="A7.I1.i38.p1.1.m1.1a"><mo stretchy="false" id="A7.I1.i38.p1.1.m1.1.1" xref="A7.I1.i38.p1.1.m1.1.1.cmml">→</mo><annotation-xml encoding="MathML-Content" id="A7.I1.i38.p1.1.m1.1b"><ci id="A7.I1.i38.p1.1.m1.1.1.cmml" xref="A7.I1.i38.p1.1.m1.1.1">→</ci></annotation-xml><annotation encoding="application/x-tex" id="A7.I1.i38.p1.1.m1.1c">\rightarrow</annotation></semantics></math> <span id="A7.I1.i38.p1.1.2" class="ltx_text ltx_font_typewriter">what’re</span></p>
</div>
</li>
<li id="A7.I1.i39" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="A7.I1.i39.p1" class="ltx_para">
<p id="A7.I1.i39.p1.1" class="ltx_p"><span id="A7.I1.i39.p1.1.1" class="ltx_text ltx_font_typewriter">what ’ s</span> <math id="A7.I1.i39.p1.1.m1.1" class="ltx_Math" alttext="\rightarrow" display="inline"><semantics id="A7.I1.i39.p1.1.m1.1a"><mo stretchy="false" id="A7.I1.i39.p1.1.m1.1.1" xref="A7.I1.i39.p1.1.m1.1.1.cmml">→</mo><annotation-xml encoding="MathML-Content" id="A7.I1.i39.p1.1.m1.1b"><ci id="A7.I1.i39.p1.1.m1.1.1.cmml" xref="A7.I1.i39.p1.1.m1.1.1">→</ci></annotation-xml><annotation encoding="application/x-tex" id="A7.I1.i39.p1.1.m1.1c">\rightarrow</annotation></semantics></math> <span id="A7.I1.i39.p1.1.2" class="ltx_text ltx_font_typewriter">what’s</span></p>
</div>
</li>
<li id="A7.I1.i40" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="A7.I1.i40.p1" class="ltx_para">
<p id="A7.I1.i40.p1.1" class="ltx_p"><span id="A7.I1.i40.p1.1.1" class="ltx_text ltx_font_typewriter">what ’ ve</span> <math id="A7.I1.i40.p1.1.m1.1" class="ltx_Math" alttext="\rightarrow" display="inline"><semantics id="A7.I1.i40.p1.1.m1.1a"><mo stretchy="false" id="A7.I1.i40.p1.1.m1.1.1" xref="A7.I1.i40.p1.1.m1.1.1.cmml">→</mo><annotation-xml encoding="MathML-Content" id="A7.I1.i40.p1.1.m1.1b"><ci id="A7.I1.i40.p1.1.m1.1.1.cmml" xref="A7.I1.i40.p1.1.m1.1.1">→</ci></annotation-xml><annotation encoding="application/x-tex" id="A7.I1.i40.p1.1.m1.1c">\rightarrow</annotation></semantics></math> <span id="A7.I1.i40.p1.1.2" class="ltx_text ltx_font_typewriter">what’ve</span></p>
</div>
</li>
<li id="A7.I1.i41" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="A7.I1.i41.p1" class="ltx_para">
<p id="A7.I1.i41.p1.1" class="ltx_p"><span id="A7.I1.i41.p1.1.1" class="ltx_text ltx_font_typewriter">where ’ s</span> <math id="A7.I1.i41.p1.1.m1.1" class="ltx_Math" alttext="\rightarrow" display="inline"><semantics id="A7.I1.i41.p1.1.m1.1a"><mo stretchy="false" id="A7.I1.i41.p1.1.m1.1.1" xref="A7.I1.i41.p1.1.m1.1.1.cmml">→</mo><annotation-xml encoding="MathML-Content" id="A7.I1.i41.p1.1.m1.1b"><ci id="A7.I1.i41.p1.1.m1.1.1.cmml" xref="A7.I1.i41.p1.1.m1.1.1">→</ci></annotation-xml><annotation encoding="application/x-tex" id="A7.I1.i41.p1.1.m1.1c">\rightarrow</annotation></semantics></math> <span id="A7.I1.i41.p1.1.2" class="ltx_text ltx_font_typewriter">where’s</span></p>
</div>
</li>
<li id="A7.I1.i42" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="A7.I1.i42.p1" class="ltx_para">
<p id="A7.I1.i42.p1.1" class="ltx_p"><span id="A7.I1.i42.p1.1.1" class="ltx_text ltx_font_typewriter">who ’ d</span> <math id="A7.I1.i42.p1.1.m1.1" class="ltx_Math" alttext="\rightarrow" display="inline"><semantics id="A7.I1.i42.p1.1.m1.1a"><mo stretchy="false" id="A7.I1.i42.p1.1.m1.1.1" xref="A7.I1.i42.p1.1.m1.1.1.cmml">→</mo><annotation-xml encoding="MathML-Content" id="A7.I1.i42.p1.1.m1.1b"><ci id="A7.I1.i42.p1.1.m1.1.1.cmml" xref="A7.I1.i42.p1.1.m1.1.1">→</ci></annotation-xml><annotation encoding="application/x-tex" id="A7.I1.i42.p1.1.m1.1c">\rightarrow</annotation></semantics></math> <span id="A7.I1.i42.p1.1.2" class="ltx_text ltx_font_typewriter">who’d</span></p>
</div>
</li>
<li id="A7.I1.i43" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="A7.I1.i43.p1" class="ltx_para">
<p id="A7.I1.i43.p1.1" class="ltx_p"><span id="A7.I1.i43.p1.1.1" class="ltx_text ltx_font_typewriter">who ’ ll</span> <math id="A7.I1.i43.p1.1.m1.1" class="ltx_Math" alttext="\rightarrow" display="inline"><semantics id="A7.I1.i43.p1.1.m1.1a"><mo stretchy="false" id="A7.I1.i43.p1.1.m1.1.1" xref="A7.I1.i43.p1.1.m1.1.1.cmml">→</mo><annotation-xml encoding="MathML-Content" id="A7.I1.i43.p1.1.m1.1b"><ci id="A7.I1.i43.p1.1.m1.1.1.cmml" xref="A7.I1.i43.p1.1.m1.1.1">→</ci></annotation-xml><annotation encoding="application/x-tex" id="A7.I1.i43.p1.1.m1.1c">\rightarrow</annotation></semantics></math> <span id="A7.I1.i43.p1.1.2" class="ltx_text ltx_font_typewriter">who’ll</span></p>
</div>
</li>
<li id="A7.I1.i44" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="A7.I1.i44.p1" class="ltx_para">
<p id="A7.I1.i44.p1.1" class="ltx_p"><span id="A7.I1.i44.p1.1.1" class="ltx_text ltx_font_typewriter">who ’ re</span> <math id="A7.I1.i44.p1.1.m1.1" class="ltx_Math" alttext="\rightarrow" display="inline"><semantics id="A7.I1.i44.p1.1.m1.1a"><mo stretchy="false" id="A7.I1.i44.p1.1.m1.1.1" xref="A7.I1.i44.p1.1.m1.1.1.cmml">→</mo><annotation-xml encoding="MathML-Content" id="A7.I1.i44.p1.1.m1.1b"><ci id="A7.I1.i44.p1.1.m1.1.1.cmml" xref="A7.I1.i44.p1.1.m1.1.1">→</ci></annotation-xml><annotation encoding="application/x-tex" id="A7.I1.i44.p1.1.m1.1c">\rightarrow</annotation></semantics></math> <span id="A7.I1.i44.p1.1.2" class="ltx_text ltx_font_typewriter">who’re</span></p>
</div>
</li>
<li id="A7.I1.i45" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="A7.I1.i45.p1" class="ltx_para">
<p id="A7.I1.i45.p1.1" class="ltx_p"><span id="A7.I1.i45.p1.1.1" class="ltx_text ltx_font_typewriter">who ’ s</span> <math id="A7.I1.i45.p1.1.m1.1" class="ltx_Math" alttext="\rightarrow" display="inline"><semantics id="A7.I1.i45.p1.1.m1.1a"><mo stretchy="false" id="A7.I1.i45.p1.1.m1.1.1" xref="A7.I1.i45.p1.1.m1.1.1.cmml">→</mo><annotation-xml encoding="MathML-Content" id="A7.I1.i45.p1.1.m1.1b"><ci id="A7.I1.i45.p1.1.m1.1.1.cmml" xref="A7.I1.i45.p1.1.m1.1.1">→</ci></annotation-xml><annotation encoding="application/x-tex" id="A7.I1.i45.p1.1.m1.1c">\rightarrow</annotation></semantics></math> <span id="A7.I1.i45.p1.1.2" class="ltx_text ltx_font_typewriter">who’s</span></p>
</div>
</li>
<li id="A7.I1.i46" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="A7.I1.i46.p1" class="ltx_para">
<p id="A7.I1.i46.p1.1" class="ltx_p"><span id="A7.I1.i46.p1.1.1" class="ltx_text ltx_font_typewriter">who ’ ve</span> <math id="A7.I1.i46.p1.1.m1.1" class="ltx_Math" alttext="\rightarrow" display="inline"><semantics id="A7.I1.i46.p1.1.m1.1a"><mo stretchy="false" id="A7.I1.i46.p1.1.m1.1.1" xref="A7.I1.i46.p1.1.m1.1.1.cmml">→</mo><annotation-xml encoding="MathML-Content" id="A7.I1.i46.p1.1.m1.1b"><ci id="A7.I1.i46.p1.1.m1.1.1.cmml" xref="A7.I1.i46.p1.1.m1.1.1">→</ci></annotation-xml><annotation encoding="application/x-tex" id="A7.I1.i46.p1.1.m1.1c">\rightarrow</annotation></semantics></math> <span id="A7.I1.i46.p1.1.2" class="ltx_text ltx_font_typewriter">who’ve</span></p>
</div>
</li>
<li id="A7.I1.i47" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="A7.I1.i47.p1" class="ltx_para">
<p id="A7.I1.i47.p1.1" class="ltx_p"><span id="A7.I1.i47.p1.1.1" class="ltx_text ltx_font_typewriter">won ’ t</span> <math id="A7.I1.i47.p1.1.m1.1" class="ltx_Math" alttext="\rightarrow" display="inline"><semantics id="A7.I1.i47.p1.1.m1.1a"><mo stretchy="false" id="A7.I1.i47.p1.1.m1.1.1" xref="A7.I1.i47.p1.1.m1.1.1.cmml">→</mo><annotation-xml encoding="MathML-Content" id="A7.I1.i47.p1.1.m1.1b"><ci id="A7.I1.i47.p1.1.m1.1.1.cmml" xref="A7.I1.i47.p1.1.m1.1.1">→</ci></annotation-xml><annotation encoding="application/x-tex" id="A7.I1.i47.p1.1.m1.1c">\rightarrow</annotation></semantics></math> <span id="A7.I1.i47.p1.1.2" class="ltx_text ltx_font_typewriter">won’t</span></p>
</div>
</li>
<li id="A7.I1.i48" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="A7.I1.i48.p1" class="ltx_para">
<p id="A7.I1.i48.p1.1" class="ltx_p"><span id="A7.I1.i48.p1.1.1" class="ltx_text ltx_font_typewriter">wouldn ’ t</span> <math id="A7.I1.i48.p1.1.m1.1" class="ltx_Math" alttext="\rightarrow" display="inline"><semantics id="A7.I1.i48.p1.1.m1.1a"><mo stretchy="false" id="A7.I1.i48.p1.1.m1.1.1" xref="A7.I1.i48.p1.1.m1.1.1.cmml">→</mo><annotation-xml encoding="MathML-Content" id="A7.I1.i48.p1.1.m1.1b"><ci id="A7.I1.i48.p1.1.m1.1.1.cmml" xref="A7.I1.i48.p1.1.m1.1.1">→</ci></annotation-xml><annotation encoding="application/x-tex" id="A7.I1.i48.p1.1.m1.1c">\rightarrow</annotation></semantics></math> <span id="A7.I1.i48.p1.1.2" class="ltx_text ltx_font_typewriter">wouldn’t</span></p>
</div>
</li>
<li id="A7.I1.i49" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="A7.I1.i49.p1" class="ltx_para">
<p id="A7.I1.i49.p1.1" class="ltx_p"><span id="A7.I1.i49.p1.1.1" class="ltx_text ltx_font_typewriter">you ’ d</span> <math id="A7.I1.i49.p1.1.m1.1" class="ltx_Math" alttext="\rightarrow" display="inline"><semantics id="A7.I1.i49.p1.1.m1.1a"><mo stretchy="false" id="A7.I1.i49.p1.1.m1.1.1" xref="A7.I1.i49.p1.1.m1.1.1.cmml">→</mo><annotation-xml encoding="MathML-Content" id="A7.I1.i49.p1.1.m1.1b"><ci id="A7.I1.i49.p1.1.m1.1.1.cmml" xref="A7.I1.i49.p1.1.m1.1.1">→</ci></annotation-xml><annotation encoding="application/x-tex" id="A7.I1.i49.p1.1.m1.1c">\rightarrow</annotation></semantics></math> <span id="A7.I1.i49.p1.1.2" class="ltx_text ltx_font_typewriter">you’d</span></p>
</div>
</li>
<li id="A7.I1.i50" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="A7.I1.i50.p1" class="ltx_para">
<p id="A7.I1.i50.p1.1" class="ltx_p"><span id="A7.I1.i50.p1.1.1" class="ltx_text ltx_font_typewriter">you ’ ll</span> <math id="A7.I1.i50.p1.1.m1.1" class="ltx_Math" alttext="\rightarrow" display="inline"><semantics id="A7.I1.i50.p1.1.m1.1a"><mo stretchy="false" id="A7.I1.i50.p1.1.m1.1.1" xref="A7.I1.i50.p1.1.m1.1.1.cmml">→</mo><annotation-xml encoding="MathML-Content" id="A7.I1.i50.p1.1.m1.1b"><ci id="A7.I1.i50.p1.1.m1.1.1.cmml" xref="A7.I1.i50.p1.1.m1.1.1">→</ci></annotation-xml><annotation encoding="application/x-tex" id="A7.I1.i50.p1.1.m1.1c">\rightarrow</annotation></semantics></math> <span id="A7.I1.i50.p1.1.2" class="ltx_text ltx_font_typewriter">you’ll</span></p>
</div>
</li>
<li id="A7.I1.i51" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="A7.I1.i51.p1" class="ltx_para">
<p id="A7.I1.i51.p1.1" class="ltx_p"><span id="A7.I1.i51.p1.1.1" class="ltx_text ltx_font_typewriter">you ’ re</span> <math id="A7.I1.i51.p1.1.m1.1" class="ltx_Math" alttext="\rightarrow" display="inline"><semantics id="A7.I1.i51.p1.1.m1.1a"><mo stretchy="false" id="A7.I1.i51.p1.1.m1.1.1" xref="A7.I1.i51.p1.1.m1.1.1.cmml">→</mo><annotation-xml encoding="MathML-Content" id="A7.I1.i51.p1.1.m1.1b"><ci id="A7.I1.i51.p1.1.m1.1.1.cmml" xref="A7.I1.i51.p1.1.m1.1.1">→</ci></annotation-xml><annotation encoding="application/x-tex" id="A7.I1.i51.p1.1.m1.1c">\rightarrow</annotation></semantics></math> <span id="A7.I1.i51.p1.1.2" class="ltx_text ltx_font_typewriter">you’re</span></p>
</div>
</li>
<li id="A7.I1.i52" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="A7.I1.i52.p1" class="ltx_para">
<p id="A7.I1.i52.p1.1" class="ltx_p"><span id="A7.I1.i52.p1.1.1" class="ltx_text ltx_font_typewriter">you ’ ve</span> <math id="A7.I1.i52.p1.1.m1.1" class="ltx_Math" alttext="\rightarrow" display="inline"><semantics id="A7.I1.i52.p1.1.m1.1a"><mo stretchy="false" id="A7.I1.i52.p1.1.m1.1.1" xref="A7.I1.i52.p1.1.m1.1.1.cmml">→</mo><annotation-xml encoding="MathML-Content" id="A7.I1.i52.p1.1.m1.1b"><ci id="A7.I1.i52.p1.1.m1.1.1.cmml" xref="A7.I1.i52.p1.1.m1.1.1">→</ci></annotation-xml><annotation encoding="application/x-tex" id="A7.I1.i52.p1.1.m1.1c">\rightarrow</annotation></semantics></math> <span id="A7.I1.i52.p1.1.2" class="ltx_text ltx_font_typewriter">you’ve</span></p>
</div>
</li>
<li id="A7.I1.i53" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="A7.I1.i53.p1" class="ltx_para">
<p id="A7.I1.i53.p1.1" class="ltx_p"><span id="A7.I1.i53.p1.1.1" class="ltx_text ltx_font_typewriter">’ s</span> <math id="A7.I1.i53.p1.1.m1.1" class="ltx_Math" alttext="\rightarrow" display="inline"><semantics id="A7.I1.i53.p1.1.m1.1a"><mo stretchy="false" id="A7.I1.i53.p1.1.m1.1.1" xref="A7.I1.i53.p1.1.m1.1.1.cmml">→</mo><annotation-xml encoding="MathML-Content" id="A7.I1.i53.p1.1.m1.1b"><ci id="A7.I1.i53.p1.1.m1.1.1.cmml" xref="A7.I1.i53.p1.1.m1.1.1">→</ci></annotation-xml><annotation encoding="application/x-tex" id="A7.I1.i53.p1.1.m1.1c">\rightarrow</annotation></semantics></math> <span id="A7.I1.i53.p1.1.2" class="ltx_text ltx_font_typewriter">’s</span></p>
</div>
</li>
</ul>
<div class="ltx_pagination ltx_role_end_3_columns"></div>
</div>
<div class="ltx_pagination ltx_role_newpage"></div>
</section>
</article>
</div>
<div class="ar5iv-footer"><a href="/html/2310.02548" class="ar5iv-nav-button ar5iv-nav-button-prev">◄</a>
    <a class="ar5iv-home-button" href="/"><img height="40" alt="ar5iv homepage" src="/assets/ar5iv.png"></a>
    <a href="/feeling_lucky" class="ar5iv-text-button">Feeling<br>lucky?</a>
    <a href="/log/2310.02549" class="ar5iv-text-button ar5iv-severity-warning">Conversion<br>report</a>
    <a class="ar5iv-text-button" target="_blank" href="https://github.com/dginev/ar5iv/issues/new?template=improve-article--arxiv-id-.md&title=Improve+article+2310.02549">Report<br>an issue</a>
    <a href="https://arxiv.org/abs/2310.02549" class="ar5iv-text-button arxiv-ui-theme">View&nbsp;original<br>on&nbsp;arXiv</a><a href="/html/2310.02550" class="ar5iv-nav-button ar5iv-nav-button-next">►</a>
</div><footer class="ltx_page_footer">
<a class="ar5iv-toggle-color-scheme" href="javascript:toggleColorScheme()" title="Toggle ar5iv color scheme"><span class="color-scheme-icon"></span></a>
<a class="ar5iv-footer-button" href="https://arxiv.org/help/license" target="_blank">Copyright</a>
<a class="ar5iv-footer-button" href="https://arxiv.org/help/policies/privacy_policy" target="_blank">Privacy Policy</a>

<div class="ltx_page_logo">Generated  on Wed Feb 28 02:45:32 2024 by <a target="_blank" href="http://dlmf.nist.gov/LaTeXML/" class="ltx_LaTeXML_logo"><span style="letter-spacing:-0.2em; margin-right:0.1em;">L<span class="ltx_font_smallcaps" style="position:relative; bottom:2.2pt;">a</span>T<span class="ltx_font_smallcaps" style="font-size:120%;position:relative; bottom:-0.2ex;">e</span></span><span style="font-size:90%; position:relative; bottom:-0.2ex;">XML</span><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAsAAAAOCAYAAAD5YeaVAAAAAXNSR0IArs4c6QAAAAZiS0dEAP8A/wD/oL2nkwAAAAlwSFlzAAALEwAACxMBAJqcGAAAAAd0SU1FB9wKExQZLWTEaOUAAAAddEVYdENvbW1lbnQAQ3JlYXRlZCB3aXRoIFRoZSBHSU1Q72QlbgAAAdpJREFUKM9tkL+L2nAARz9fPZNCKFapUn8kyI0e4iRHSR1Kb8ng0lJw6FYHFwv2LwhOpcWxTjeUunYqOmqd6hEoRDhtDWdA8ApRYsSUCDHNt5ul13vz4w0vWCgUnnEc975arX6ORqN3VqtVZbfbTQC4uEHANM3jSqXymFI6yWazP2KxWAXAL9zCUa1Wy2tXVxheKA9YNoR8Pt+aTqe4FVVVvz05O6MBhqUIBGk8Hn8HAOVy+T+XLJfLS4ZhTiRJgqIoVBRFIoric47jPnmeB1mW/9rr9ZpSSn3Lsmir1fJZlqWlUonKsvwWwD8ymc/nXwVBeLjf7xEKhdBut9Hr9WgmkyGEkJwsy5eHG5vN5g0AKIoCAEgkEkin0wQAfN9/cXPdheu6P33fBwB4ngcAcByHJpPJl+fn54mD3Gg0NrquXxeLRQAAwzAYj8cwTZPwPH9/sVg8PXweDAauqqr2cDjEer1GJBLBZDJBs9mE4zjwfZ85lAGg2+06hmGgXq+j3+/DsixYlgVN03a9Xu8jgCNCyIegIAgx13Vfd7vdu+FweG8YRkjXdWy329+dTgeSJD3ieZ7RNO0VAXAPwDEAO5VKndi2fWrb9jWl9Esul6PZbDY9Go1OZ7PZ9z/lyuD3OozU2wAAAABJRU5ErkJggg==" alt="Mascot Sammy"></a>
</div></footer>
</div>

    <script>
      var canMathML = typeof(MathMLElement) == "function";
      if (!canMathML) {
        var body = document.querySelector("body");
        body.firstElementChild.setAttribute('style', 'opacity: 0;');
        var loading = document.createElement("div");
        loading.setAttribute("id", "mathjax-loading-spinner");
        var message = document.createElement("div");
        message.setAttribute("id", "mathjax-loading-message");
        message.innerText = "Typesetting Equations...";
        body.prepend(loading);
        body.prepend(message);

        var el = document.createElement("script");
        el.src = "https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js";
        document.querySelector("head").appendChild(el);

        window.MathJax = {
          startup: {
            pageReady: () => {
              return MathJax.startup.defaultPageReady().then(() => {
                body.removeChild(loading);
                body.removeChild(message);
                body.firstElementChild.removeAttribute('style');
              }); } } };
      }
    </script>
    <script>
    // Auxiliary function, building the preview feature when
    // an inline citation is clicked
    function clicked_cite(e) {
      e.preventDefault();
      let cite = this.closest('.ltx_cite');
      let next = cite.nextSibling;
      if (next && next.nodeType == Node.ELEMENT_NODE && next.getAttribute('class') == "ar5iv-bibitem-preview") {
        next.remove();
        return; }
      // Before adding a preview modal,
      // cleanup older previews, in case they're still open
      document.querySelectorAll('span.ar5iv-bibitem-preview').forEach(function(node) {
        node.remove();
      })

      // Create the preview
      preview = document.createElement('span');
      preview.setAttribute('class','ar5iv-bibitem-preview');
      let target = document.getElementById(this.getAttribute('href').slice(1));
      target.childNodes.forEach(function (child) {
        preview.append(child.cloneNode(true));
      });
      let close_x = document.createElement('button');
      close_x.setAttribute("aria-label","Close modal for bibliography item preview");
      close_x.textContent = "×";
      close_x.setAttribute('class', 'ar5iv-button-close-preview');
      close_x.setAttribute('onclick','this.parentNode.remove()');
      preview.append(close_x);
      preview.querySelectorAll('.ltx_tag_bibitem').forEach(function(node) {
        node.remove();
      });
      cite.parentNode.insertBefore(preview, cite.nextSibling);
      return;
    }
    // Global Document initialization:
    // - assign the preview feature to all inline citation links
    document.querySelectorAll(".ltx_cite .ltx_ref").forEach(function (link) {
      link.addEventListener("click", clicked_cite);
    });
    </script>
    </body>
</html>
