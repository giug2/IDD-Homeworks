<!DOCTYPE html><html lang="en">
<head>
<meta http-equiv="content-type" content="text/html; charset=UTF-8">
<title>[1511.06973] Ask Me Anything: Free-form Visual Question Answering Based on Knowledge from External Sources</title><meta property="og:description" content="We propose a method for visual question answering which combines an internal representation of the content of an image with information extracted from a general knowledge base to answer a broad range of image-based que…">
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Ask Me Anything: Free-form Visual Question Answering Based on Knowledge from External Sources">
<meta name="twitter:image:src" content="https://ar5iv.labs.arxiv.org/assets/ar5iv_card.png">
<meta name="twitter:image:alt" content="ar5iv logo">
<meta property="og:title" content="Ask Me Anything: Free-form Visual Question Answering Based on Knowledge from External Sources">
<meta property="og:site_name" content="ar5iv">
<meta property="og:image" content="https://ar5iv.labs.arxiv.org/assets/ar5iv_card.png">
<meta property="og:type" content="article">
<meta property="og:url" content="https://ar5iv.labs.arxiv.org/html/1511.06973">

<!--Generated on Sun Mar  3 09:30:37 2024 by LaTeXML (version 0.8.8) http://dlmf.nist.gov/LaTeXML/.-->
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

<script>
  function detectColorScheme(){
    var theme="light";
    var current_theme = localStorage.getItem("ar5iv_theme");
    if(current_theme){
      if(current_theme == "dark"){
        theme = "dark";
      } }
    else if(!window.matchMedia) { return false; }
    else if(window.matchMedia("(prefers-color-scheme: dark)").matches) {
      theme = "dark"; }
    if (theme=="dark") {
      document.documentElement.setAttribute("data-theme", "dark");
    } else {
      document.documentElement.setAttribute("data-theme", "light"); } }

  detectColorScheme();

  function toggleColorScheme(){
    var current_theme = localStorage.getItem("ar5iv_theme");
    if (current_theme) {
      if (current_theme == "light") {
        localStorage.setItem("ar5iv_theme", "dark"); }
      else {
        localStorage.setItem("ar5iv_theme", "light"); } }
    else {
        localStorage.setItem("ar5iv_theme", "dark"); }
    detectColorScheme(); }
</script>
<link media="all" rel="stylesheet" href="/assets/ar5iv-fonts.0.8.0.min.css"><link media="all" rel="stylesheet" href="/assets/ar5iv.0.8.0.min.css"><link media="all" rel="stylesheet" href="/assets/ar5iv-site.0.2.2.css">
</head>
<body>
<div class="ltx_page_main">
<div class="ltx_page_content">
<article class="ltx_document ltx_authors_1line">
<h1 class="ltx_title ltx_title_document">Ask Me Anything: Free-form Visual Question Answering 
<br class="ltx_break">Based on Knowledge from External Sources</h1>
<div class="ltx_authors">
<span class="ltx_creator ltx_role_author">
<span class="ltx_personname">Qi Wu, Peng Wang, Chunhua Shen, Anthony Dick, Anton van den Hengel
<br class="ltx_break">School of Computer Science,
The University of Adelaide, Australia
<br class="ltx_break"><span id="id1.1.id1" class="ltx_text ltx_font_typewriter" style="font-size:90%;">{qi.wu01,p.wang,chunhua.shen,anthony.dick,anton.vandenhengel}@adelaide.edu.au</span>
</span></span>
</div>

<div class="ltx_abstract">
<h6 class="ltx_title ltx_title_abstract">Abstract</h6>
<p id="id2.id1" class="ltx_p">We propose a method for visual question answering which combines an internal representation of the content of an image with information extracted from a general knowledge base to answer a broad range of image-based questions. This allows more complex questions to be answered using the predominant neural network-based approach than has previously been possible. It particularly allows questions to be asked about the contents of an image, even when the image itself does not contain the whole answer. The method constructs a textual representation of the semantic content of an image, and merges it with textual information sourced from a knowledge base, to develop a deeper understanding of the scene viewed. Priming a recurrent neural network with this combined information, and the submitted question, leads to a very flexible visual question answering approach. We are specifically able to answer questions posed in natural language, that refer to information not contained in the image.
We demonstrate the effectiveness of our model on two publicly available datasets, Toronto COCO-QA <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib23" title="" class="ltx_ref">23</a>]</cite> and VQA <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib1" title="" class="ltx_ref">1</a>]</cite> and show that it produces the best reported results in both cases.</p>
</div>
<section id="S1" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">1 </span>Introduction</h2>

<div id="S1.p1" class="ltx_para">
<p id="S1.p1.1" class="ltx_p">Visual question answering (VQA) is distinct from many problems in Computer Vision because the question to be answered is not determined until run time <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib1" title="" class="ltx_ref">1</a>]</cite>. In more traditional problems such as segmentation or detection, the single question to be answered by an algorithm is predetermined, and only the image changes. In visual question answering, in contrast, the form that the question will take is unknown, as is the set of operations required to answer it. In this sense it more closely reflects the challenge of general image interpretation.</p>
</div>
<div id="S1.p2" class="ltx_para">
<p id="S1.p2.1" class="ltx_p">VQA typically requires processing both visual information (the image) and textual information (the question and answer). One approach to Vision-to-Language problems, such as VQA and image captioning, which interrelate visual and textual information is based on a direct method pioneered in machine language translation <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib7" title="" class="ltx_ref">7</a>, <a href="#bib.bib26" title="" class="ltx_ref">26</a>]</cite>.
This direct approach develops an encoding of the input text using a Recurrent Neural Network (RNN) and passes it to another RNN for decoding.</p>
</div>
<figure id="S1.F1" class="ltx_figure"><img src="/html/1511.06973/assets/x1.png" id="S1.F1.g1" class="ltx_graphics ltx_img_square" width="461" height="462" alt="Refer to caption">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure">Figure 1: </span>A real case of question answering based on an internal textual representation and external knowledge. All of the attributes, textual representation, knowledge and answer are produced by our VQA model. Underlined words indicate the information required to answer the question.</figcaption>
</figure>
<div id="S1.p3" class="ltx_para">
<p id="S1.p3.1" class="ltx_p">The Vision-to-Language version of this direct translation approach uses a Convolutional Neural Network (CNN) to encode the image, and an RNN to encode and generate text.
This approach has been well studied. The image captioning methods developed in <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib9" title="" class="ltx_ref">9</a>, <a href="#bib.bib14" title="" class="ltx_ref">14</a>, <a href="#bib.bib21" title="" class="ltx_ref">21</a>, <a href="#bib.bib28" title="" class="ltx_ref">28</a>, <a href="#bib.bib32" title="" class="ltx_ref">32</a>]</cite>, for example,
learn a mapping from images to text
using CNNs trained on object recognition, and word embeddings trained on large scale text corpora.
Visual question answering is a significantly more complex problem than image captioning, not least because it requires accessing information not present in the image. This may be common sense, or specific knowledge about the image subject.
For example, given an image, such as Figure <a href="#S1.F1" title="Figure 1 ‣ 1 Introduction ‣ Ask Me Anything: Free-form Visual Question Answering Based on Knowledge from External Sources" class="ltx_ref"><span class="ltx_text ltx_ref_tag">1</span></a>, showing ‘a group of people enjoying a sunny day at the beach with umbrellas’, if one asks a question ‘why do they have umbrellas?’, to answer this question, the machine must not only detect the scene ‘beach’, but must know that ‘umbrellas are often used as points of shade on a sunny beach’. Recently, Antol <em id="S1.p3.1.1" class="ltx_emph ltx_font_italic">et al</em>.<span id="S1.p3.1.2" class="ltx_text"></span> <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib1" title="" class="ltx_ref">1</a>]</cite> also have suggested that VQA is a more “AI-complete” task since it requires multimodal knowledge beyond a single sub-domain. Our proposed system finally gives the right answer ‘shade’ for the above real example.</p>
</div>
<div id="S1.p4" class="ltx_para">
<p id="S1.p4.1" class="ltx_p">Large-scale Knowledge Bases (KBs), such as Freebase <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib4" title="" class="ltx_ref">4</a>]</cite> and DBpedia <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib2" title="" class="ltx_ref">2</a>]</cite>, have been used successfully in several
natural language Question Answering (QA) systems <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib3" title="" class="ltx_ref">3</a>, <a href="#bib.bib10" title="" class="ltx_ref">10</a>]</cite>.
However, VQA systems exploiting KBs
are still relatively rare.
Gao <em id="S1.p4.1.1" class="ltx_emph ltx_font_italic">et al</em>.<span id="S1.p4.1.2" class="ltx_text"></span> <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib11" title="" class="ltx_ref">11</a>]</cite> and Malinowski <em id="S1.p4.1.3" class="ltx_emph ltx_font_italic">et al</em>.<span id="S1.p4.1.4" class="ltx_text"></span> <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib20" title="" class="ltx_ref">20</a>]</cite>
do not use a KB at all.
Zhu <em id="S1.p4.1.5" class="ltx_emph ltx_font_italic">et al</em>.<span id="S1.p4.1.6" class="ltx_text"></span> <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib33" title="" class="ltx_ref">33</a>]</cite> do use a KB, but it is created specifically for the purpose, and consequently contains a small amount of very specific, largely image-focused, information. This in turn means that only a specific set of questions may be asked of the system, and the query generation approach taken mandates a very particular question form. The method that we propose here, in contrast, is applicable to general (even publicly created) KBs, and admits general questions.</p>
</div>
<div id="S1.p5" class="ltx_para">
<p id="S1.p5.1" class="ltx_p">In this work, we
fuse an automatically generated description of an image with information extracted from an external KB to provide an answer to a general question about the image (See Figure <a href="#S2.F2" title="Figure 2 ‣ 2 Related Work ‣ Ask Me Anything: Free-form Visual Question Answering Based on Knowledge from External Sources" class="ltx_ref"><span class="ltx_text ltx_ref_tag">2</span></a>). The image description takes the form of a set of captions, and the external knowledge is text-based information mined from a Knowledge Base. Given an image-question pair, a CNN is first employed to predict a set of attributes of the image. The attributes cover a wide range of high-level concepts, including objects, scenes, actions, modifiers and so on. A state-of-the-art image captioning model <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib30" title="" class="ltx_ref">30</a>]</cite> is applied to generate a series of captions based on the attributes.
We then use the detected attributes to extract relevant information from the KB. Specifically, for each of the top-5 attributes detected in the image we generate a query which may be applied to a Resource Description Framework (RDF) KB, such as DBpedia. RDF is the standard format for large KBs, of which there are many. The queries are specified using Semantic Protocol And RDF Query Language (SPARQL).
We encode the paragraphs extracted from the KB using Doc2Vec <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib15" title="" class="ltx_ref">15</a>]</cite>, which maps paragraphs into a fixed-length feature representation.
The encoded attributes, captions, and KB information are then input to an LSTM which is trained so as to maximise the likelihood of the ground truth answers in a training set.</p>
</div>
<div id="S1.p6" class="ltx_para">
<p id="S1.p6.1" class="ltx_p">The approach we propose here combines the generality of information that using a KB allows with the generality of question that the LSTM allows.
In addition, it achieves an accuracy of 69.73% on the Toronto COCO-QA, while the latest state-of-the-art is 55.92%. We also produce the best results on the VQA evaluation server (which does not publish ground truth answers for its test set), which is 59.44%.</p>
</div>
</section>
<section id="S2" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">2 </span>Related Work</h2>

<div id="S2.p1" class="ltx_para">
<p id="S2.p1.1" class="ltx_p">Malinowski <em id="S2.p1.1.1" class="ltx_emph ltx_font_italic">et al</em>.<span id="S2.p1.1.2" class="ltx_text"></span> <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib18" title="" class="ltx_ref">18</a>]</cite> were among the first to study the VQA problem. They proposed a method that combines semantic parsing and image segmentation with a Bayesian approach to sample from nearest neighbors in the training set. This approach requires human defined predicates, which are inevitably dataset-specific. This approach is also very dependent on the accuracy of the image segmentation algorithm and on the estimated image depth information. Tu <em id="S2.p1.1.3" class="ltx_emph ltx_font_italic">et al</em>.<span id="S2.p1.1.4" class="ltx_text"></span> <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib27" title="" class="ltx_ref">27</a>]</cite> built a query answering system based on a joint parse graph from text and videos. Geman <em id="S2.p1.1.5" class="ltx_emph ltx_font_italic">et al</em>.<span id="S2.p1.1.6" class="ltx_text"></span> <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib12" title="" class="ltx_ref">12</a>]</cite> proposed an automatic ‘query generator’ that was trained on annotated images and produced a sequence of binary questions from any given test image.
Each of these approaches places significant limitations on the form of question that can be answered.</p>
</div>
<figure id="S2.F2" class="ltx_figure"><img src="/html/1511.06973/assets/x2.png" id="S2.F2.1.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="456" height="177" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 2: </span>Our proposed framework: given an image, a CNN is first applied to produce the attribute-based representation <math id="S2.F2.6.5.m1.1" class="ltx_Math" alttext="{V_{att}}(I)" display="inline"><semantics id="S2.F2.6.5.m1.1b"><mrow id="S2.F2.6.5.m1.1.2" xref="S2.F2.6.5.m1.1.2.cmml"><msub id="S2.F2.6.5.m1.1.2.2" xref="S2.F2.6.5.m1.1.2.2.cmml"><mi mathcolor="#FF0000" id="S2.F2.6.5.m1.1.2.2.2" xref="S2.F2.6.5.m1.1.2.2.2.cmml">V</mi><mrow id="S2.F2.6.5.m1.1.2.2.3" xref="S2.F2.6.5.m1.1.2.2.3.cmml"><mi mathcolor="#FF0000" id="S2.F2.6.5.m1.1.2.2.3.2" xref="S2.F2.6.5.m1.1.2.2.3.2.cmml">a</mi><mo lspace="0em" rspace="0em" id="S2.F2.6.5.m1.1.2.2.3.1" xref="S2.F2.6.5.m1.1.2.2.3.1.cmml">​</mo><mi mathcolor="#FF0000" id="S2.F2.6.5.m1.1.2.2.3.3" xref="S2.F2.6.5.m1.1.2.2.3.3.cmml">t</mi><mo lspace="0em" rspace="0em" id="S2.F2.6.5.m1.1.2.2.3.1b" xref="S2.F2.6.5.m1.1.2.2.3.1.cmml">​</mo><mi mathcolor="#FF0000" id="S2.F2.6.5.m1.1.2.2.3.4" xref="S2.F2.6.5.m1.1.2.2.3.4.cmml">t</mi></mrow></msub><mo lspace="0em" rspace="0em" id="S2.F2.6.5.m1.1.2.1" xref="S2.F2.6.5.m1.1.2.1.cmml">​</mo><mrow id="S2.F2.6.5.m1.1.2.3.2" xref="S2.F2.6.5.m1.1.2.cmml"><mo mathcolor="#FF0000" stretchy="false" id="S2.F2.6.5.m1.1.2.3.2.1" xref="S2.F2.6.5.m1.1.2.cmml">(</mo><mi mathcolor="#FF0000" id="S2.F2.6.5.m1.1.1" xref="S2.F2.6.5.m1.1.1.cmml">I</mi><mo mathcolor="#FF0000" stretchy="false" id="S2.F2.6.5.m1.1.2.3.2.2" xref="S2.F2.6.5.m1.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.F2.6.5.m1.1c"><apply id="S2.F2.6.5.m1.1.2.cmml" xref="S2.F2.6.5.m1.1.2"><times id="S2.F2.6.5.m1.1.2.1.cmml" xref="S2.F2.6.5.m1.1.2.1"></times><apply id="S2.F2.6.5.m1.1.2.2.cmml" xref="S2.F2.6.5.m1.1.2.2"><csymbol cd="ambiguous" id="S2.F2.6.5.m1.1.2.2.1.cmml" xref="S2.F2.6.5.m1.1.2.2">subscript</csymbol><ci id="S2.F2.6.5.m1.1.2.2.2.cmml" xref="S2.F2.6.5.m1.1.2.2.2">𝑉</ci><apply id="S2.F2.6.5.m1.1.2.2.3.cmml" xref="S2.F2.6.5.m1.1.2.2.3"><times id="S2.F2.6.5.m1.1.2.2.3.1.cmml" xref="S2.F2.6.5.m1.1.2.2.3.1"></times><ci id="S2.F2.6.5.m1.1.2.2.3.2.cmml" xref="S2.F2.6.5.m1.1.2.2.3.2">𝑎</ci><ci id="S2.F2.6.5.m1.1.2.2.3.3.cmml" xref="S2.F2.6.5.m1.1.2.2.3.3">𝑡</ci><ci id="S2.F2.6.5.m1.1.2.2.3.4.cmml" xref="S2.F2.6.5.m1.1.2.2.3.4">𝑡</ci></apply></apply><ci id="S2.F2.6.5.m1.1.1.cmml" xref="S2.F2.6.5.m1.1.1">𝐼</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.F2.6.5.m1.1d">{V_{att}}(I)</annotation></semantics></math>. The internal textual representation is made up of image captions generated based on the image-attributes. The hidden state of the caption-LSTM after it has generated the last word in each caption is used as its vector representation. These vectors are then aggregated as <math id="S2.F2.7.6.m2.1" class="ltx_Math" alttext="{V_{cap}}(I)" display="inline"><semantics id="S2.F2.7.6.m2.1b"><mrow id="S2.F2.7.6.m2.1.2" xref="S2.F2.7.6.m2.1.2.cmml"><msub id="S2.F2.7.6.m2.1.2.2" xref="S2.F2.7.6.m2.1.2.2.cmml"><mi mathcolor="#00FF00" id="S2.F2.7.6.m2.1.2.2.2" xref="S2.F2.7.6.m2.1.2.2.2.cmml">V</mi><mrow id="S2.F2.7.6.m2.1.2.2.3" xref="S2.F2.7.6.m2.1.2.2.3.cmml"><mi mathcolor="#00FF00" id="S2.F2.7.6.m2.1.2.2.3.2" xref="S2.F2.7.6.m2.1.2.2.3.2.cmml">c</mi><mo lspace="0em" rspace="0em" id="S2.F2.7.6.m2.1.2.2.3.1" xref="S2.F2.7.6.m2.1.2.2.3.1.cmml">​</mo><mi mathcolor="#00FF00" id="S2.F2.7.6.m2.1.2.2.3.3" xref="S2.F2.7.6.m2.1.2.2.3.3.cmml">a</mi><mo lspace="0em" rspace="0em" id="S2.F2.7.6.m2.1.2.2.3.1b" xref="S2.F2.7.6.m2.1.2.2.3.1.cmml">​</mo><mi mathcolor="#00FF00" id="S2.F2.7.6.m2.1.2.2.3.4" xref="S2.F2.7.6.m2.1.2.2.3.4.cmml">p</mi></mrow></msub><mo lspace="0em" rspace="0em" id="S2.F2.7.6.m2.1.2.1" xref="S2.F2.7.6.m2.1.2.1.cmml">​</mo><mrow id="S2.F2.7.6.m2.1.2.3.2" xref="S2.F2.7.6.m2.1.2.cmml"><mo mathcolor="#00FF00" stretchy="false" id="S2.F2.7.6.m2.1.2.3.2.1" xref="S2.F2.7.6.m2.1.2.cmml">(</mo><mi mathcolor="#00FF00" id="S2.F2.7.6.m2.1.1" xref="S2.F2.7.6.m2.1.1.cmml">I</mi><mo mathcolor="#00FF00" stretchy="false" id="S2.F2.7.6.m2.1.2.3.2.2" xref="S2.F2.7.6.m2.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.F2.7.6.m2.1c"><apply id="S2.F2.7.6.m2.1.2.cmml" xref="S2.F2.7.6.m2.1.2"><times id="S2.F2.7.6.m2.1.2.1.cmml" xref="S2.F2.7.6.m2.1.2.1"></times><apply id="S2.F2.7.6.m2.1.2.2.cmml" xref="S2.F2.7.6.m2.1.2.2"><csymbol cd="ambiguous" id="S2.F2.7.6.m2.1.2.2.1.cmml" xref="S2.F2.7.6.m2.1.2.2">subscript</csymbol><ci id="S2.F2.7.6.m2.1.2.2.2.cmml" xref="S2.F2.7.6.m2.1.2.2.2">𝑉</ci><apply id="S2.F2.7.6.m2.1.2.2.3.cmml" xref="S2.F2.7.6.m2.1.2.2.3"><times id="S2.F2.7.6.m2.1.2.2.3.1.cmml" xref="S2.F2.7.6.m2.1.2.2.3.1"></times><ci id="S2.F2.7.6.m2.1.2.2.3.2.cmml" xref="S2.F2.7.6.m2.1.2.2.3.2">𝑐</ci><ci id="S2.F2.7.6.m2.1.2.2.3.3.cmml" xref="S2.F2.7.6.m2.1.2.2.3.3">𝑎</ci><ci id="S2.F2.7.6.m2.1.2.2.3.4.cmml" xref="S2.F2.7.6.m2.1.2.2.3.4">𝑝</ci></apply></apply><ci id="S2.F2.7.6.m2.1.1.cmml" xref="S2.F2.7.6.m2.1.1">𝐼</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.F2.7.6.m2.1d">{V_{cap}}(I)</annotation></semantics></math> with average-pooling. The external knowledge is mined from the KB (in this case DBpedia) and the responses encoded by Doc2Vec, which produces a vector <math id="S2.F2.8.7.m3.1" class="ltx_Math" alttext="{V_{know}}(I)" display="inline"><semantics id="S2.F2.8.7.m3.1b"><mrow id="S2.F2.8.7.m3.1.2" xref="S2.F2.8.7.m3.1.2.cmml"><msub id="S2.F2.8.7.m3.1.2.2" xref="S2.F2.8.7.m3.1.2.2.cmml"><mi mathcolor="#0000FF" id="S2.F2.8.7.m3.1.2.2.2" xref="S2.F2.8.7.m3.1.2.2.2.cmml">V</mi><mrow id="S2.F2.8.7.m3.1.2.2.3" xref="S2.F2.8.7.m3.1.2.2.3.cmml"><mi mathcolor="#0000FF" id="S2.F2.8.7.m3.1.2.2.3.2" xref="S2.F2.8.7.m3.1.2.2.3.2.cmml">k</mi><mo lspace="0em" rspace="0em" id="S2.F2.8.7.m3.1.2.2.3.1" xref="S2.F2.8.7.m3.1.2.2.3.1.cmml">​</mo><mi mathcolor="#0000FF" id="S2.F2.8.7.m3.1.2.2.3.3" xref="S2.F2.8.7.m3.1.2.2.3.3.cmml">n</mi><mo lspace="0em" rspace="0em" id="S2.F2.8.7.m3.1.2.2.3.1b" xref="S2.F2.8.7.m3.1.2.2.3.1.cmml">​</mo><mi mathcolor="#0000FF" id="S2.F2.8.7.m3.1.2.2.3.4" xref="S2.F2.8.7.m3.1.2.2.3.4.cmml">o</mi><mo lspace="0em" rspace="0em" id="S2.F2.8.7.m3.1.2.2.3.1c" xref="S2.F2.8.7.m3.1.2.2.3.1.cmml">​</mo><mi mathcolor="#0000FF" id="S2.F2.8.7.m3.1.2.2.3.5" xref="S2.F2.8.7.m3.1.2.2.3.5.cmml">w</mi></mrow></msub><mo lspace="0em" rspace="0em" id="S2.F2.8.7.m3.1.2.1" xref="S2.F2.8.7.m3.1.2.1.cmml">​</mo><mrow id="S2.F2.8.7.m3.1.2.3.2" xref="S2.F2.8.7.m3.1.2.cmml"><mo mathcolor="#0000FF" stretchy="false" id="S2.F2.8.7.m3.1.2.3.2.1" xref="S2.F2.8.7.m3.1.2.cmml">(</mo><mi mathcolor="#0000FF" id="S2.F2.8.7.m3.1.1" xref="S2.F2.8.7.m3.1.1.cmml">I</mi><mo mathcolor="#0000FF" stretchy="false" id="S2.F2.8.7.m3.1.2.3.2.2" xref="S2.F2.8.7.m3.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.F2.8.7.m3.1c"><apply id="S2.F2.8.7.m3.1.2.cmml" xref="S2.F2.8.7.m3.1.2"><times id="S2.F2.8.7.m3.1.2.1.cmml" xref="S2.F2.8.7.m3.1.2.1"></times><apply id="S2.F2.8.7.m3.1.2.2.cmml" xref="S2.F2.8.7.m3.1.2.2"><csymbol cd="ambiguous" id="S2.F2.8.7.m3.1.2.2.1.cmml" xref="S2.F2.8.7.m3.1.2.2">subscript</csymbol><ci id="S2.F2.8.7.m3.1.2.2.2.cmml" xref="S2.F2.8.7.m3.1.2.2.2">𝑉</ci><apply id="S2.F2.8.7.m3.1.2.2.3.cmml" xref="S2.F2.8.7.m3.1.2.2.3"><times id="S2.F2.8.7.m3.1.2.2.3.1.cmml" xref="S2.F2.8.7.m3.1.2.2.3.1"></times><ci id="S2.F2.8.7.m3.1.2.2.3.2.cmml" xref="S2.F2.8.7.m3.1.2.2.3.2">𝑘</ci><ci id="S2.F2.8.7.m3.1.2.2.3.3.cmml" xref="S2.F2.8.7.m3.1.2.2.3.3">𝑛</ci><ci id="S2.F2.8.7.m3.1.2.2.3.4.cmml" xref="S2.F2.8.7.m3.1.2.2.3.4">𝑜</ci><ci id="S2.F2.8.7.m3.1.2.2.3.5.cmml" xref="S2.F2.8.7.m3.1.2.2.3.5">𝑤</ci></apply></apply><ci id="S2.F2.8.7.m3.1.1.cmml" xref="S2.F2.8.7.m3.1.1">𝐼</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.F2.8.7.m3.1d">{V_{know}}(I)</annotation></semantics></math>. The 3 vectors <math id="S2.F2.9.8.m4.1" class="ltx_Math" alttext="\mathbf{V}" display="inline"><semantics id="S2.F2.9.8.m4.1b"><mi id="S2.F2.9.8.m4.1.1" xref="S2.F2.9.8.m4.1.1.cmml">𝐕</mi><annotation-xml encoding="MathML-Content" id="S2.F2.9.8.m4.1c"><ci id="S2.F2.9.8.m4.1.1.cmml" xref="S2.F2.9.8.m4.1.1">𝐕</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.F2.9.8.m4.1d">\mathbf{V}</annotation></semantics></math> are combined into a single representation of scene content, which is input to the VQA LSTM model which interprets the question and generates an answer.</figcaption>
</figure>
<div id="S2.p2" class="ltx_para">
<p id="S2.p2.1" class="ltx_p">Most recently, inspired by the significant progress achieved using deep neural network models in both computer vision and natural language processing, an architecture which combines a CNN and RNN to learn the mapping from images to sentences has become the dominant trend. Both Gao <em id="S2.p2.1.1" class="ltx_emph ltx_font_italic">et al</em>.<span id="S2.p2.1.2" class="ltx_text"></span> <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib11" title="" class="ltx_ref">11</a>]</cite> and Malinowski <em id="S2.p2.1.3" class="ltx_emph ltx_font_italic">et al</em>.<span id="S2.p2.1.4" class="ltx_text"></span> <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib20" title="" class="ltx_ref">20</a>]</cite> used RNNs to encode the question and output the answer. Whereas Gao <em id="S2.p2.1.5" class="ltx_emph ltx_font_italic">et al</em>.<span id="S2.p2.1.6" class="ltx_text"></span> <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib11" title="" class="ltx_ref">11</a>]</cite> used two networks, a separate encoder and decoder, Malinowski <em id="S2.p2.1.7" class="ltx_emph ltx_font_italic">et al</em>.<span id="S2.p2.1.8" class="ltx_text"></span> <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib20" title="" class="ltx_ref">20</a>]</cite> used a single network for both encoding and decoding. Ren <em id="S2.p2.1.9" class="ltx_emph ltx_font_italic">et al</em>.<span id="S2.p2.1.10" class="ltx_text"></span> <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib23" title="" class="ltx_ref">23</a>]</cite> focused on questions with a single-word answer and formulated the task as a classification problem using an LSTM. A single-word answer dataset COCO-QA was published with <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib23" title="" class="ltx_ref">23</a>]</cite>. Ma <em id="S2.p2.1.11" class="ltx_emph ltx_font_italic">et al</em>.<span id="S2.p2.1.12" class="ltx_text"></span> <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib17" title="" class="ltx_ref">17</a>]</cite> used CNNs to both extract image features and sentence features, and fused the features together with another multimodal CNN. Antol <em id="S2.p2.1.13" class="ltx_emph ltx_font_italic">et al</em>.<span id="S2.p2.1.14" class="ltx_text"></span> <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib1" title="" class="ltx_ref">1</a>]</cite> proposed a large-scale open-ended VQA dataset based on COCO, which is called VQA. They also provided several baseline methods which combined both image features (CNN extracted) and question features (LSTM extracted) to obtain a single embedding and further built a MLP (Multi-Layer Perceptron) to obtain a distribution over answers. Our framework also exploits both CNNs and RNNs, but in contrast to preceding approaches which use only image features extracted from a CNN in answering a question, we employ multiple sources, including image content,
generated image captions and mined external knowledge, to feed to an RNN to answer questions.</p>
</div>
<div id="S2.p3" class="ltx_para">
<p id="S2.p3.1" class="ltx_p">The quality of the information in the KB is one of the primary issues in this approach to VQA. The problem is that KBs constructed by analysing Wikipedia and similar are patchy and inconsistent at best, and hand-curated KBs are inevitably very topic specific. Using visually-sourced information is a promising approach to solving this problem <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib16" title="" class="ltx_ref">16</a>, <a href="#bib.bib24" title="" class="ltx_ref">24</a>]</cite>, but has a way to go before it might be usefully applied within our approach. Thus, although our SPARQL and RDF driven approach can incorporate any information that might be extracted from a KB, the limitations of the existing available KBs mean that the text descriptions of the detected attributes is all that can be usefully extracted.</p>
</div>
<div id="S2.p4" class="ltx_para">
<p id="S2.p4.1" class="ltx_p">Zhu <em id="S2.p4.1.1" class="ltx_emph ltx_font_italic">et al</em>.<span id="S2.p4.1.2" class="ltx_text"></span> <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib33" title="" class="ltx_ref">33</a>]</cite>, in contrast used a hand-crafted KB primarily containing image-related information such as category labels, attribute labels and affordance labels, but also some quantities relating to their specific question format such as GPS coordinates and similar.
The questions in that system are phrased in the DBMS query language, and are thus tightly coupled to the nature of the hand-crafted KB. This represents a significant restriction on the form of question that might be asked, but has the significant advantage that the DBMS is able to respond decisively as to whether it has the information required to answer the question. Instead of building a problem-specific KB, we use a pre-built large-scale KB (DBpedia <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib2" title="" class="ltx_ref">2</a>]</cite>) from which we extract information using a standard RDF query language. DBpedia has been created by extracting structured information from Wikipedia, and is thus significantly larger and more general than a hand-crafted KB. Rather than having a user to pose their question in a formal query language, our VQA system is able to encode questions written in natural language automatically. This is achieved without manually specified formalization, but rather depends on processing a suitable training set. The result is a model which is very general in the forms of question that it will accept.</p>
</div>
</section>
<section id="S3" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">3 </span>Extracting, Encoding, and Merging</h2>

<div id="S3.p1" class="ltx_para">
<p id="S3.p1.1" class="ltx_p">The key differentiator of our approach is that it is able to usefully combine image information with that extracted from a KB, within the LSTM framework. The novelty lies in the fact that this is achieved by representing both of these disparate forms of information as text before combining them.
Figure <a href="#S2.F2" title="Figure 2 ‣ 2 Related Work ‣ Ask Me Anything: Free-form Visual Question Answering Based on Knowledge from External Sources" class="ltx_ref"><span class="ltx_text ltx_ref_tag">2</span></a> summarises how this is achieved.
We now describe each step in more details.</p>
</div>
<section id="S3.SS1" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.1 </span>Attribute-based Image Representation</h3>

<div id="S3.SS1.p1" class="ltx_para">
<p id="S3.SS1.p1.1" class="ltx_p">Our first task is to describe the image content in terms of a set of attributes.
Each attribute in our vocabulary is extracted from captions from MS COCO <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib5" title="" class="ltx_ref">5</a>]</cite>, a large-scale image-captioning dataset. An attribute can be any part of speech, including object names (nouns), motions (verbs) or properties (adjectives). Because MS COCO captions are created by humans, attributes derived from captions
are likely to represent image features that are of particular significance to humans, and are thus likely to be the subject of image-based questions.</p>
</div>
<div id="S3.SS1.p2" class="ltx_para">
<p id="S3.SS1.p2.1" class="ltx_p">We formalize attribute prediction as a multi-label classification problem. To address the issue that some attributes may only apply to image sub-regions, we follow Wei <em id="S3.SS1.p2.1.1" class="ltx_emph ltx_font_italic">et al</em>.<span id="S3.SS1.p2.1.2" class="ltx_text"></span> <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib29" title="" class="ltx_ref">29</a>]</cite> to design a region-based multi-label classification framework that takes an arbitrary number of sub-region proposals as input. A shared CNN is connected with each proposal, and the CNN outputs from different proposals are aggregated with max pooling to produce the final prediction over the attribute vocabulary.</p>
</div>
<div id="S3.SS1.p3" class="ltx_para">
<p id="S3.SS1.p3.4" class="ltx_p">To initialize the attribute prediction model, we use the powerful VggNet-16 <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib25" title="" class="ltx_ref">25</a>]</cite> pre-trained on the ImageNet <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib8" title="" class="ltx_ref">8</a>]</cite>. The shared CNN is then fine-tuned on the multi-label dataset, the MS COCO image-attribute training data <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib30" title="" class="ltx_ref">30</a>]</cite>. The output of the last fully-connected layer is fed into a <math id="S3.SS1.p3.1.m1.1" class="ltx_Math" alttext="c" display="inline"><semantics id="S3.SS1.p3.1.m1.1a"><mi id="S3.SS1.p3.1.m1.1.1" xref="S3.SS1.p3.1.m1.1.1.cmml">c</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p3.1.m1.1b"><ci id="S3.SS1.p3.1.m1.1.1.cmml" xref="S3.SS1.p3.1.m1.1.1">𝑐</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p3.1.m1.1c">c</annotation></semantics></math>-way softmax which produces a probability distribution over the <math id="S3.SS1.p3.2.m2.1" class="ltx_Math" alttext="c" display="inline"><semantics id="S3.SS1.p3.2.m2.1a"><mi id="S3.SS1.p3.2.m2.1.1" xref="S3.SS1.p3.2.m2.1.1.cmml">c</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p3.2.m2.1b"><ci id="S3.SS1.p3.2.m2.1.1.cmml" xref="S3.SS1.p3.2.m2.1.1">𝑐</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p3.2.m2.1c">c</annotation></semantics></math> class labels. The <math id="S3.SS1.p3.3.m3.1" class="ltx_Math" alttext="c" display="inline"><semantics id="S3.SS1.p3.3.m3.1a"><mi id="S3.SS1.p3.3.m3.1.1" xref="S3.SS1.p3.3.m3.1.1.cmml">c</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p3.3.m3.1b"><ci id="S3.SS1.p3.3.m3.1.1.cmml" xref="S3.SS1.p3.3.m3.1.1">𝑐</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p3.3.m3.1c">c</annotation></semantics></math> represents the attribute vocabulary size, which here is 256. The fine-tuning learning rates of the last two fully connect layers are initialized to 0.001 and the prediction layer is initialized to 0.01. All the other layers are fixed. We execute 40 epochs in total and decrease the learning rate to one tenth of the current rate for each layer after 10 epochs. The momentum is set to 0.9. The dropout rate is set to 0.5. Then, we use Multiscale Combinatorial Grouping (MCG) <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib22" title="" class="ltx_ref">22</a>]</cite> for the proposal generation.
Finally, a cross hypothesis max-pooling is applied to integrate the outputs into a single prediction vector <math id="S3.SS1.p3.4.m4.1" class="ltx_Math" alttext="{V_{att}}(I)" display="inline"><semantics id="S3.SS1.p3.4.m4.1a"><mrow id="S3.SS1.p3.4.m4.1.2" xref="S3.SS1.p3.4.m4.1.2.cmml"><msub id="S3.SS1.p3.4.m4.1.2.2" xref="S3.SS1.p3.4.m4.1.2.2.cmml"><mi id="S3.SS1.p3.4.m4.1.2.2.2" xref="S3.SS1.p3.4.m4.1.2.2.2.cmml">V</mi><mrow id="S3.SS1.p3.4.m4.1.2.2.3" xref="S3.SS1.p3.4.m4.1.2.2.3.cmml"><mi id="S3.SS1.p3.4.m4.1.2.2.3.2" xref="S3.SS1.p3.4.m4.1.2.2.3.2.cmml">a</mi><mo lspace="0em" rspace="0em" id="S3.SS1.p3.4.m4.1.2.2.3.1" xref="S3.SS1.p3.4.m4.1.2.2.3.1.cmml">​</mo><mi id="S3.SS1.p3.4.m4.1.2.2.3.3" xref="S3.SS1.p3.4.m4.1.2.2.3.3.cmml">t</mi><mo lspace="0em" rspace="0em" id="S3.SS1.p3.4.m4.1.2.2.3.1a" xref="S3.SS1.p3.4.m4.1.2.2.3.1.cmml">​</mo><mi id="S3.SS1.p3.4.m4.1.2.2.3.4" xref="S3.SS1.p3.4.m4.1.2.2.3.4.cmml">t</mi></mrow></msub><mo lspace="0em" rspace="0em" id="S3.SS1.p3.4.m4.1.2.1" xref="S3.SS1.p3.4.m4.1.2.1.cmml">​</mo><mrow id="S3.SS1.p3.4.m4.1.2.3.2" xref="S3.SS1.p3.4.m4.1.2.cmml"><mo stretchy="false" id="S3.SS1.p3.4.m4.1.2.3.2.1" xref="S3.SS1.p3.4.m4.1.2.cmml">(</mo><mi id="S3.SS1.p3.4.m4.1.1" xref="S3.SS1.p3.4.m4.1.1.cmml">I</mi><mo stretchy="false" id="S3.SS1.p3.4.m4.1.2.3.2.2" xref="S3.SS1.p3.4.m4.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p3.4.m4.1b"><apply id="S3.SS1.p3.4.m4.1.2.cmml" xref="S3.SS1.p3.4.m4.1.2"><times id="S3.SS1.p3.4.m4.1.2.1.cmml" xref="S3.SS1.p3.4.m4.1.2.1"></times><apply id="S3.SS1.p3.4.m4.1.2.2.cmml" xref="S3.SS1.p3.4.m4.1.2.2"><csymbol cd="ambiguous" id="S3.SS1.p3.4.m4.1.2.2.1.cmml" xref="S3.SS1.p3.4.m4.1.2.2">subscript</csymbol><ci id="S3.SS1.p3.4.m4.1.2.2.2.cmml" xref="S3.SS1.p3.4.m4.1.2.2.2">𝑉</ci><apply id="S3.SS1.p3.4.m4.1.2.2.3.cmml" xref="S3.SS1.p3.4.m4.1.2.2.3"><times id="S3.SS1.p3.4.m4.1.2.2.3.1.cmml" xref="S3.SS1.p3.4.m4.1.2.2.3.1"></times><ci id="S3.SS1.p3.4.m4.1.2.2.3.2.cmml" xref="S3.SS1.p3.4.m4.1.2.2.3.2">𝑎</ci><ci id="S3.SS1.p3.4.m4.1.2.2.3.3.cmml" xref="S3.SS1.p3.4.m4.1.2.2.3.3">𝑡</ci><ci id="S3.SS1.p3.4.m4.1.2.2.3.4.cmml" xref="S3.SS1.p3.4.m4.1.2.2.3.4">𝑡</ci></apply></apply><ci id="S3.SS1.p3.4.m4.1.1.cmml" xref="S3.SS1.p3.4.m4.1.1">𝐼</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p3.4.m4.1c">{V_{att}}(I)</annotation></semantics></math>.</p>
</div>
<figure id="S3.F3" class="ltx_figure"><img src="/html/1511.06973/assets/x3.png" id="S3.F3.1.g1" class="ltx_graphics ltx_centering ltx_img_square" width="461" height="475" alt="Refer to caption">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure">Figure 3: </span>Examples of predicted attributes and generated captions.</figcaption>
</figure>
</section>
<section id="S3.SS2" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.2 </span>Caption-based Image Representation</h3>

<div id="S3.SS2.p1" class="ltx_para">
<p id="S3.SS2.p1.1" class="ltx_p">Currently the most successful approach to image captioning  <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib6" title="" class="ltx_ref">6</a>, <a href="#bib.bib9" title="" class="ltx_ref">9</a>, <a href="#bib.bib14" title="" class="ltx_ref">14</a>, <a href="#bib.bib21" title="" class="ltx_ref">21</a>, <a href="#bib.bib28" title="" class="ltx_ref">28</a>]</cite> is to attach a CNN to an RNN to learn the mapping from images to sentences directly. Wu <em id="S3.SS2.p1.1.1" class="ltx_emph ltx_font_italic">et al</em>.<span id="S3.SS2.p1.1.2" class="ltx_text"></span> <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib30" title="" class="ltx_ref">30</a>]</cite> proposed to feed a high-level attribute-based representation to an LSTM to generate captions, instead of directly using CNN-extracted features. This method produces promising results on the major public captioning challenge <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib5" title="" class="ltx_ref">5</a>]</cite> and accepts our attributes prediction vector <math id="S3.SS2.p1.1.m1.1" class="ltx_Math" alttext="{V_{att}}(I)" display="inline"><semantics id="S3.SS2.p1.1.m1.1a"><mrow id="S3.SS2.p1.1.m1.1.2" xref="S3.SS2.p1.1.m1.1.2.cmml"><msub id="S3.SS2.p1.1.m1.1.2.2" xref="S3.SS2.p1.1.m1.1.2.2.cmml"><mi id="S3.SS2.p1.1.m1.1.2.2.2" xref="S3.SS2.p1.1.m1.1.2.2.2.cmml">V</mi><mrow id="S3.SS2.p1.1.m1.1.2.2.3" xref="S3.SS2.p1.1.m1.1.2.2.3.cmml"><mi id="S3.SS2.p1.1.m1.1.2.2.3.2" xref="S3.SS2.p1.1.m1.1.2.2.3.2.cmml">a</mi><mo lspace="0em" rspace="0em" id="S3.SS2.p1.1.m1.1.2.2.3.1" xref="S3.SS2.p1.1.m1.1.2.2.3.1.cmml">​</mo><mi id="S3.SS2.p1.1.m1.1.2.2.3.3" xref="S3.SS2.p1.1.m1.1.2.2.3.3.cmml">t</mi><mo lspace="0em" rspace="0em" id="S3.SS2.p1.1.m1.1.2.2.3.1a" xref="S3.SS2.p1.1.m1.1.2.2.3.1.cmml">​</mo><mi id="S3.SS2.p1.1.m1.1.2.2.3.4" xref="S3.SS2.p1.1.m1.1.2.2.3.4.cmml">t</mi></mrow></msub><mo lspace="0em" rspace="0em" id="S3.SS2.p1.1.m1.1.2.1" xref="S3.SS2.p1.1.m1.1.2.1.cmml">​</mo><mrow id="S3.SS2.p1.1.m1.1.2.3.2" xref="S3.SS2.p1.1.m1.1.2.cmml"><mo stretchy="false" id="S3.SS2.p1.1.m1.1.2.3.2.1" xref="S3.SS2.p1.1.m1.1.2.cmml">(</mo><mi id="S3.SS2.p1.1.m1.1.1" xref="S3.SS2.p1.1.m1.1.1.cmml">I</mi><mo stretchy="false" id="S3.SS2.p1.1.m1.1.2.3.2.2" xref="S3.SS2.p1.1.m1.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.1.m1.1b"><apply id="S3.SS2.p1.1.m1.1.2.cmml" xref="S3.SS2.p1.1.m1.1.2"><times id="S3.SS2.p1.1.m1.1.2.1.cmml" xref="S3.SS2.p1.1.m1.1.2.1"></times><apply id="S3.SS2.p1.1.m1.1.2.2.cmml" xref="S3.SS2.p1.1.m1.1.2.2"><csymbol cd="ambiguous" id="S3.SS2.p1.1.m1.1.2.2.1.cmml" xref="S3.SS2.p1.1.m1.1.2.2">subscript</csymbol><ci id="S3.SS2.p1.1.m1.1.2.2.2.cmml" xref="S3.SS2.p1.1.m1.1.2.2.2">𝑉</ci><apply id="S3.SS2.p1.1.m1.1.2.2.3.cmml" xref="S3.SS2.p1.1.m1.1.2.2.3"><times id="S3.SS2.p1.1.m1.1.2.2.3.1.cmml" xref="S3.SS2.p1.1.m1.1.2.2.3.1"></times><ci id="S3.SS2.p1.1.m1.1.2.2.3.2.cmml" xref="S3.SS2.p1.1.m1.1.2.2.3.2">𝑎</ci><ci id="S3.SS2.p1.1.m1.1.2.2.3.3.cmml" xref="S3.SS2.p1.1.m1.1.2.2.3.3">𝑡</ci><ci id="S3.SS2.p1.1.m1.1.2.2.3.4.cmml" xref="S3.SS2.p1.1.m1.1.2.2.3.4">𝑡</ci></apply></apply><ci id="S3.SS2.p1.1.m1.1.1.cmml" xref="S3.SS2.p1.1.m1.1.1">𝐼</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.1.m1.1c">{V_{att}}(I)</annotation></semantics></math> as the input. We thus use this approach to generate 5 different captions (using beam search) that constitute the internal textual representation for a given image.</p>
</div>
<div id="S3.SS2.p2" class="ltx_para">
<p id="S3.SS2.p2.2" class="ltx_p">The hidden state vector of the caption-LSTM after it has generated the last word in each caption is used to represent its content. Average-pooling is applied over the 5 hidden-state vectors, to obtain a 512-d vector <math id="S3.SS2.p2.1.m1.1" class="ltx_Math" alttext="{V_{cap}}(I)" display="inline"><semantics id="S3.SS2.p2.1.m1.1a"><mrow id="S3.SS2.p2.1.m1.1.2" xref="S3.SS2.p2.1.m1.1.2.cmml"><msub id="S3.SS2.p2.1.m1.1.2.2" xref="S3.SS2.p2.1.m1.1.2.2.cmml"><mi id="S3.SS2.p2.1.m1.1.2.2.2" xref="S3.SS2.p2.1.m1.1.2.2.2.cmml">V</mi><mrow id="S3.SS2.p2.1.m1.1.2.2.3" xref="S3.SS2.p2.1.m1.1.2.2.3.cmml"><mi id="S3.SS2.p2.1.m1.1.2.2.3.2" xref="S3.SS2.p2.1.m1.1.2.2.3.2.cmml">c</mi><mo lspace="0em" rspace="0em" id="S3.SS2.p2.1.m1.1.2.2.3.1" xref="S3.SS2.p2.1.m1.1.2.2.3.1.cmml">​</mo><mi id="S3.SS2.p2.1.m1.1.2.2.3.3" xref="S3.SS2.p2.1.m1.1.2.2.3.3.cmml">a</mi><mo lspace="0em" rspace="0em" id="S3.SS2.p2.1.m1.1.2.2.3.1a" xref="S3.SS2.p2.1.m1.1.2.2.3.1.cmml">​</mo><mi id="S3.SS2.p2.1.m1.1.2.2.3.4" xref="S3.SS2.p2.1.m1.1.2.2.3.4.cmml">p</mi></mrow></msub><mo lspace="0em" rspace="0em" id="S3.SS2.p2.1.m1.1.2.1" xref="S3.SS2.p2.1.m1.1.2.1.cmml">​</mo><mrow id="S3.SS2.p2.1.m1.1.2.3.2" xref="S3.SS2.p2.1.m1.1.2.cmml"><mo stretchy="false" id="S3.SS2.p2.1.m1.1.2.3.2.1" xref="S3.SS2.p2.1.m1.1.2.cmml">(</mo><mi id="S3.SS2.p2.1.m1.1.1" xref="S3.SS2.p2.1.m1.1.1.cmml">I</mi><mo stretchy="false" id="S3.SS2.p2.1.m1.1.2.3.2.2" xref="S3.SS2.p2.1.m1.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p2.1.m1.1b"><apply id="S3.SS2.p2.1.m1.1.2.cmml" xref="S3.SS2.p2.1.m1.1.2"><times id="S3.SS2.p2.1.m1.1.2.1.cmml" xref="S3.SS2.p2.1.m1.1.2.1"></times><apply id="S3.SS2.p2.1.m1.1.2.2.cmml" xref="S3.SS2.p2.1.m1.1.2.2"><csymbol cd="ambiguous" id="S3.SS2.p2.1.m1.1.2.2.1.cmml" xref="S3.SS2.p2.1.m1.1.2.2">subscript</csymbol><ci id="S3.SS2.p2.1.m1.1.2.2.2.cmml" xref="S3.SS2.p2.1.m1.1.2.2.2">𝑉</ci><apply id="S3.SS2.p2.1.m1.1.2.2.3.cmml" xref="S3.SS2.p2.1.m1.1.2.2.3"><times id="S3.SS2.p2.1.m1.1.2.2.3.1.cmml" xref="S3.SS2.p2.1.m1.1.2.2.3.1"></times><ci id="S3.SS2.p2.1.m1.1.2.2.3.2.cmml" xref="S3.SS2.p2.1.m1.1.2.2.3.2">𝑐</ci><ci id="S3.SS2.p2.1.m1.1.2.2.3.3.cmml" xref="S3.SS2.p2.1.m1.1.2.2.3.3">𝑎</ci><ci id="S3.SS2.p2.1.m1.1.2.2.3.4.cmml" xref="S3.SS2.p2.1.m1.1.2.2.3.4">𝑝</ci></apply></apply><ci id="S3.SS2.p2.1.m1.1.1.cmml" xref="S3.SS2.p2.1.m1.1.1">𝐼</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p2.1.m1.1c">{V_{cap}}(I)</annotation></semantics></math> for the image <math id="S3.SS2.p2.2.m2.1" class="ltx_Math" alttext="I" display="inline"><semantics id="S3.SS2.p2.2.m2.1a"><mi id="S3.SS2.p2.2.m2.1.1" xref="S3.SS2.p2.2.m2.1.1.cmml">I</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p2.2.m2.1b"><ci id="S3.SS2.p2.2.m2.1.1.cmml" xref="S3.SS2.p2.2.m2.1.1">𝐼</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p2.2.m2.1c">I</annotation></semantics></math>. The caption-LSTM is trained on the human-generated captions from the MS COCO training set, which means that the resulting model is focused on the types of image content that humans are most interested in describing. Figure <a href="#S3.F3" title="Figure 3 ‣ 3.1 Attribute-based Image Representation ‣ 3 Extracting, Encoding, and Merging ‣ Ask Me Anything: Free-form Visual Question Answering Based on Knowledge from External Sources" class="ltx_ref"><span class="ltx_text ltx_ref_tag">3</span></a> shows some examples of the predicted attributes and generated captions.</p>
</div>
</section>
<section id="S3.SS3" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.3 </span>Relating to the Knowledge Base</h3>

<div id="S3.SS3.p1" class="ltx_para">
<p id="S3.SS3.p1.2" class="ltx_p">The external data source that we use here is
DBpedia <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib2" title="" class="ltx_ref">2</a>]</cite>. As a source of general background information, although any such KB could equally be applied, DBpedia is a structured database of information extracted from Wikipedia. The whole DBpedia dataset describes <math id="S3.SS3.p1.1.m1.1" class="ltx_Math" alttext="4.58" display="inline"><semantics id="S3.SS3.p1.1.m1.1a"><mn id="S3.SS3.p1.1.m1.1.1" xref="S3.SS3.p1.1.m1.1.1.cmml">4.58</mn><annotation-xml encoding="MathML-Content" id="S3.SS3.p1.1.m1.1b"><cn type="float" id="S3.SS3.p1.1.m1.1.1.cmml" xref="S3.SS3.p1.1.m1.1.1">4.58</cn></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p1.1.m1.1c">4.58</annotation></semantics></math> million entities, of which <math id="S3.SS3.p1.2.m2.1" class="ltx_Math" alttext="4.22" display="inline"><semantics id="S3.SS3.p1.2.m2.1a"><mn id="S3.SS3.p1.2.m2.1.1" xref="S3.SS3.p1.2.m2.1.1.cmml">4.22</mn><annotation-xml encoding="MathML-Content" id="S3.SS3.p1.2.m2.1b"><cn type="float" id="S3.SS3.p1.2.m2.1.1.cmml" xref="S3.SS3.p1.2.m2.1.1">4.22</cn></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p1.2.m2.1c">4.22</annotation></semantics></math> million are classified in a consistent ontology. The data can be accessed using an SQL-like query language for RDF called SPARQL. Given an image and its predicted attributes, we use the top-5 most strongly predicted attributes<span id="footnote1" class="ltx_note ltx_role_footnote"><sup class="ltx_note_mark">1</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">1</sup><span class="ltx_tag ltx_tag_note">1</span>We only use the top-5 attributes to query the KB because, based on the observation of training data, an image typically contains 5-8 attributes. We also tested with top-10, but no improvements were observed.</span></span></span> to generate DBpedia queries.
Inspecting the database shows that the ‘comment’ field is the most generally informative about an attribute, as it contains a general text description of it. We therefore retrieve the comment text for each query term. The KB+SPARQL combination is very general, however, and could be applied to problem specific KBs, or a database of common sense information, and can even perform basic inference over RDF. Figure <a href="#S3.F4" title="Figure 4 ‣ 3.3 Relating to the Knowledge Base ‣ 3 Extracting, Encoding, and Merging ‣ Ask Me Anything: Free-form Visual Question Answering Based on Knowledge from External Sources" class="ltx_ref"><span class="ltx_text ltx_ref_tag">4</span></a> shows an example of the query language and returned text.</p>
</div>
<figure id="S3.F4" class="ltx_figure"><img src="/html/1511.06973/assets/x4.png" id="S3.F4.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="415" height="218" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 4: </span>An example of SPARQL query language for the attribute <span id="S3.F4.2.1" class="ltx_text ltx_font_typewriter">‘dog’</span>. The mined text-based knowledge are shown below.</figcaption>
</figure>
<div id="S3.SS3.p2" class="ltx_para">
<p id="S3.SS3.p2.2" class="ltx_p">Since the
text returned by the SPARQL query is typically
much longer than the captions generated in the section <a href="#S3.SS2" title="3.2 Caption-based Image Representation ‣ 3 Extracting, Encoding, and Merging ‣ Ask Me Anything: Free-form Visual Question Answering Based on Knowledge from External Sources" class="ltx_ref"><span class="ltx_text ltx_ref_tag">3.2</span></a>, we turn to Doc2Vec <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib15" title="" class="ltx_ref">15</a>]</cite> to extract the semantic meanings. Doc2Vec, also known as Paragraph Vector, is an unsupervised algorithm that learns fixed-length feature representations from variable-length pieces of texts, such as sentences, paragraphs, and documents. Le <em id="S3.SS3.p2.2.1" class="ltx_emph ltx_font_italic">et al</em>.<span id="S3.SS3.p2.2.2" class="ltx_text"></span> <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib15" title="" class="ltx_ref">15</a>]</cite> proved that it can capture the semantics of paragraphs. A Doc2Vec model is trained to predict words in the document given the context words. We collect 100,000 documents from DBpedia to train a model with vector size 500. To obtain the knowledge vector <math id="S3.SS3.p2.1.m1.1" class="ltx_Math" alttext="{V_{know}}(I)" display="inline"><semantics id="S3.SS3.p2.1.m1.1a"><mrow id="S3.SS3.p2.1.m1.1.2" xref="S3.SS3.p2.1.m1.1.2.cmml"><msub id="S3.SS3.p2.1.m1.1.2.2" xref="S3.SS3.p2.1.m1.1.2.2.cmml"><mi id="S3.SS3.p2.1.m1.1.2.2.2" xref="S3.SS3.p2.1.m1.1.2.2.2.cmml">V</mi><mrow id="S3.SS3.p2.1.m1.1.2.2.3" xref="S3.SS3.p2.1.m1.1.2.2.3.cmml"><mi id="S3.SS3.p2.1.m1.1.2.2.3.2" xref="S3.SS3.p2.1.m1.1.2.2.3.2.cmml">k</mi><mo lspace="0em" rspace="0em" id="S3.SS3.p2.1.m1.1.2.2.3.1" xref="S3.SS3.p2.1.m1.1.2.2.3.1.cmml">​</mo><mi id="S3.SS3.p2.1.m1.1.2.2.3.3" xref="S3.SS3.p2.1.m1.1.2.2.3.3.cmml">n</mi><mo lspace="0em" rspace="0em" id="S3.SS3.p2.1.m1.1.2.2.3.1a" xref="S3.SS3.p2.1.m1.1.2.2.3.1.cmml">​</mo><mi id="S3.SS3.p2.1.m1.1.2.2.3.4" xref="S3.SS3.p2.1.m1.1.2.2.3.4.cmml">o</mi><mo lspace="0em" rspace="0em" id="S3.SS3.p2.1.m1.1.2.2.3.1b" xref="S3.SS3.p2.1.m1.1.2.2.3.1.cmml">​</mo><mi id="S3.SS3.p2.1.m1.1.2.2.3.5" xref="S3.SS3.p2.1.m1.1.2.2.3.5.cmml">w</mi></mrow></msub><mo lspace="0em" rspace="0em" id="S3.SS3.p2.1.m1.1.2.1" xref="S3.SS3.p2.1.m1.1.2.1.cmml">​</mo><mrow id="S3.SS3.p2.1.m1.1.2.3.2" xref="S3.SS3.p2.1.m1.1.2.cmml"><mo stretchy="false" id="S3.SS3.p2.1.m1.1.2.3.2.1" xref="S3.SS3.p2.1.m1.1.2.cmml">(</mo><mi id="S3.SS3.p2.1.m1.1.1" xref="S3.SS3.p2.1.m1.1.1.cmml">I</mi><mo stretchy="false" id="S3.SS3.p2.1.m1.1.2.3.2.2" xref="S3.SS3.p2.1.m1.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.p2.1.m1.1b"><apply id="S3.SS3.p2.1.m1.1.2.cmml" xref="S3.SS3.p2.1.m1.1.2"><times id="S3.SS3.p2.1.m1.1.2.1.cmml" xref="S3.SS3.p2.1.m1.1.2.1"></times><apply id="S3.SS3.p2.1.m1.1.2.2.cmml" xref="S3.SS3.p2.1.m1.1.2.2"><csymbol cd="ambiguous" id="S3.SS3.p2.1.m1.1.2.2.1.cmml" xref="S3.SS3.p2.1.m1.1.2.2">subscript</csymbol><ci id="S3.SS3.p2.1.m1.1.2.2.2.cmml" xref="S3.SS3.p2.1.m1.1.2.2.2">𝑉</ci><apply id="S3.SS3.p2.1.m1.1.2.2.3.cmml" xref="S3.SS3.p2.1.m1.1.2.2.3"><times id="S3.SS3.p2.1.m1.1.2.2.3.1.cmml" xref="S3.SS3.p2.1.m1.1.2.2.3.1"></times><ci id="S3.SS3.p2.1.m1.1.2.2.3.2.cmml" xref="S3.SS3.p2.1.m1.1.2.2.3.2">𝑘</ci><ci id="S3.SS3.p2.1.m1.1.2.2.3.3.cmml" xref="S3.SS3.p2.1.m1.1.2.2.3.3">𝑛</ci><ci id="S3.SS3.p2.1.m1.1.2.2.3.4.cmml" xref="S3.SS3.p2.1.m1.1.2.2.3.4">𝑜</ci><ci id="S3.SS3.p2.1.m1.1.2.2.3.5.cmml" xref="S3.SS3.p2.1.m1.1.2.2.3.5">𝑤</ci></apply></apply><ci id="S3.SS3.p2.1.m1.1.1.cmml" xref="S3.SS3.p2.1.m1.1.1">𝐼</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p2.1.m1.1c">{V_{know}}(I)</annotation></semantics></math> for image <math id="S3.SS3.p2.2.m2.1" class="ltx_Math" alttext="I" display="inline"><semantics id="S3.SS3.p2.2.m2.1a"><mi id="S3.SS3.p2.2.m2.1.1" xref="S3.SS3.p2.2.m2.1.1.cmml">I</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.p2.2.m2.1b"><ci id="S3.SS3.p2.2.m2.1.1.cmml" xref="S3.SS3.p2.2.m2.1.1">𝐼</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p2.2.m2.1c">I</annotation></semantics></math>, we combine the 5 returned paragraphs in to a single large paragraph, before extracting semantic features using our Doc2Vec model.</p>
</div>
</section>
</section>
<section id="S4" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">4 </span>A VQA Model with Multiple Inputs</h2>

<div id="S4.p1" class="ltx_para">
<p id="S4.p1.4" class="ltx_p">We propose to train a VQA model by maximizing the probability of the correct answer given the image and question.
We want our VQA model to be able to generate multiple word answers, so we formulate the answering process as a word sequence generation procedure. Let <math id="S4.p1.1.m1.3" class="ltx_Math" alttext="Q=\{q_{1},...,q_{n}\}" display="inline"><semantics id="S4.p1.1.m1.3a"><mrow id="S4.p1.1.m1.3.3" xref="S4.p1.1.m1.3.3.cmml"><mi id="S4.p1.1.m1.3.3.4" xref="S4.p1.1.m1.3.3.4.cmml">Q</mi><mo id="S4.p1.1.m1.3.3.3" xref="S4.p1.1.m1.3.3.3.cmml">=</mo><mrow id="S4.p1.1.m1.3.3.2.2" xref="S4.p1.1.m1.3.3.2.3.cmml"><mo stretchy="false" id="S4.p1.1.m1.3.3.2.2.3" xref="S4.p1.1.m1.3.3.2.3.cmml">{</mo><msub id="S4.p1.1.m1.2.2.1.1.1" xref="S4.p1.1.m1.2.2.1.1.1.cmml"><mi id="S4.p1.1.m1.2.2.1.1.1.2" xref="S4.p1.1.m1.2.2.1.1.1.2.cmml">q</mi><mn id="S4.p1.1.m1.2.2.1.1.1.3" xref="S4.p1.1.m1.2.2.1.1.1.3.cmml">1</mn></msub><mo id="S4.p1.1.m1.3.3.2.2.4" xref="S4.p1.1.m1.3.3.2.3.cmml">,</mo><mi mathvariant="normal" id="S4.p1.1.m1.1.1" xref="S4.p1.1.m1.1.1.cmml">…</mi><mo id="S4.p1.1.m1.3.3.2.2.5" xref="S4.p1.1.m1.3.3.2.3.cmml">,</mo><msub id="S4.p1.1.m1.3.3.2.2.2" xref="S4.p1.1.m1.3.3.2.2.2.cmml"><mi id="S4.p1.1.m1.3.3.2.2.2.2" xref="S4.p1.1.m1.3.3.2.2.2.2.cmml">q</mi><mi id="S4.p1.1.m1.3.3.2.2.2.3" xref="S4.p1.1.m1.3.3.2.2.2.3.cmml">n</mi></msub><mo stretchy="false" id="S4.p1.1.m1.3.3.2.2.6" xref="S4.p1.1.m1.3.3.2.3.cmml">}</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.p1.1.m1.3b"><apply id="S4.p1.1.m1.3.3.cmml" xref="S4.p1.1.m1.3.3"><eq id="S4.p1.1.m1.3.3.3.cmml" xref="S4.p1.1.m1.3.3.3"></eq><ci id="S4.p1.1.m1.3.3.4.cmml" xref="S4.p1.1.m1.3.3.4">𝑄</ci><set id="S4.p1.1.m1.3.3.2.3.cmml" xref="S4.p1.1.m1.3.3.2.2"><apply id="S4.p1.1.m1.2.2.1.1.1.cmml" xref="S4.p1.1.m1.2.2.1.1.1"><csymbol cd="ambiguous" id="S4.p1.1.m1.2.2.1.1.1.1.cmml" xref="S4.p1.1.m1.2.2.1.1.1">subscript</csymbol><ci id="S4.p1.1.m1.2.2.1.1.1.2.cmml" xref="S4.p1.1.m1.2.2.1.1.1.2">𝑞</ci><cn type="integer" id="S4.p1.1.m1.2.2.1.1.1.3.cmml" xref="S4.p1.1.m1.2.2.1.1.1.3">1</cn></apply><ci id="S4.p1.1.m1.1.1.cmml" xref="S4.p1.1.m1.1.1">…</ci><apply id="S4.p1.1.m1.3.3.2.2.2.cmml" xref="S4.p1.1.m1.3.3.2.2.2"><csymbol cd="ambiguous" id="S4.p1.1.m1.3.3.2.2.2.1.cmml" xref="S4.p1.1.m1.3.3.2.2.2">subscript</csymbol><ci id="S4.p1.1.m1.3.3.2.2.2.2.cmml" xref="S4.p1.1.m1.3.3.2.2.2.2">𝑞</ci><ci id="S4.p1.1.m1.3.3.2.2.2.3.cmml" xref="S4.p1.1.m1.3.3.2.2.2.3">𝑛</ci></apply></set></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.p1.1.m1.3c">Q=\{q_{1},...,q_{n}\}</annotation></semantics></math> represents the sequence of words in a question, and <math id="S4.p1.2.m2.3" class="ltx_Math" alttext="A=\{a_{1},...,a_{l}\}" display="inline"><semantics id="S4.p1.2.m2.3a"><mrow id="S4.p1.2.m2.3.3" xref="S4.p1.2.m2.3.3.cmml"><mi id="S4.p1.2.m2.3.3.4" xref="S4.p1.2.m2.3.3.4.cmml">A</mi><mo id="S4.p1.2.m2.3.3.3" xref="S4.p1.2.m2.3.3.3.cmml">=</mo><mrow id="S4.p1.2.m2.3.3.2.2" xref="S4.p1.2.m2.3.3.2.3.cmml"><mo stretchy="false" id="S4.p1.2.m2.3.3.2.2.3" xref="S4.p1.2.m2.3.3.2.3.cmml">{</mo><msub id="S4.p1.2.m2.2.2.1.1.1" xref="S4.p1.2.m2.2.2.1.1.1.cmml"><mi id="S4.p1.2.m2.2.2.1.1.1.2" xref="S4.p1.2.m2.2.2.1.1.1.2.cmml">a</mi><mn id="S4.p1.2.m2.2.2.1.1.1.3" xref="S4.p1.2.m2.2.2.1.1.1.3.cmml">1</mn></msub><mo id="S4.p1.2.m2.3.3.2.2.4" xref="S4.p1.2.m2.3.3.2.3.cmml">,</mo><mi mathvariant="normal" id="S4.p1.2.m2.1.1" xref="S4.p1.2.m2.1.1.cmml">…</mi><mo id="S4.p1.2.m2.3.3.2.2.5" xref="S4.p1.2.m2.3.3.2.3.cmml">,</mo><msub id="S4.p1.2.m2.3.3.2.2.2" xref="S4.p1.2.m2.3.3.2.2.2.cmml"><mi id="S4.p1.2.m2.3.3.2.2.2.2" xref="S4.p1.2.m2.3.3.2.2.2.2.cmml">a</mi><mi id="S4.p1.2.m2.3.3.2.2.2.3" xref="S4.p1.2.m2.3.3.2.2.2.3.cmml">l</mi></msub><mo stretchy="false" id="S4.p1.2.m2.3.3.2.2.6" xref="S4.p1.2.m2.3.3.2.3.cmml">}</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.p1.2.m2.3b"><apply id="S4.p1.2.m2.3.3.cmml" xref="S4.p1.2.m2.3.3"><eq id="S4.p1.2.m2.3.3.3.cmml" xref="S4.p1.2.m2.3.3.3"></eq><ci id="S4.p1.2.m2.3.3.4.cmml" xref="S4.p1.2.m2.3.3.4">𝐴</ci><set id="S4.p1.2.m2.3.3.2.3.cmml" xref="S4.p1.2.m2.3.3.2.2"><apply id="S4.p1.2.m2.2.2.1.1.1.cmml" xref="S4.p1.2.m2.2.2.1.1.1"><csymbol cd="ambiguous" id="S4.p1.2.m2.2.2.1.1.1.1.cmml" xref="S4.p1.2.m2.2.2.1.1.1">subscript</csymbol><ci id="S4.p1.2.m2.2.2.1.1.1.2.cmml" xref="S4.p1.2.m2.2.2.1.1.1.2">𝑎</ci><cn type="integer" id="S4.p1.2.m2.2.2.1.1.1.3.cmml" xref="S4.p1.2.m2.2.2.1.1.1.3">1</cn></apply><ci id="S4.p1.2.m2.1.1.cmml" xref="S4.p1.2.m2.1.1">…</ci><apply id="S4.p1.2.m2.3.3.2.2.2.cmml" xref="S4.p1.2.m2.3.3.2.2.2"><csymbol cd="ambiguous" id="S4.p1.2.m2.3.3.2.2.2.1.cmml" xref="S4.p1.2.m2.3.3.2.2.2">subscript</csymbol><ci id="S4.p1.2.m2.3.3.2.2.2.2.cmml" xref="S4.p1.2.m2.3.3.2.2.2.2">𝑎</ci><ci id="S4.p1.2.m2.3.3.2.2.2.3.cmml" xref="S4.p1.2.m2.3.3.2.2.2.3">𝑙</ci></apply></set></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.p1.2.m2.3c">A=\{a_{1},...,a_{l}\}</annotation></semantics></math> the answer sequence, where <math id="S4.p1.3.m3.1" class="ltx_Math" alttext="n" display="inline"><semantics id="S4.p1.3.m3.1a"><mi id="S4.p1.3.m3.1.1" xref="S4.p1.3.m3.1.1.cmml">n</mi><annotation-xml encoding="MathML-Content" id="S4.p1.3.m3.1b"><ci id="S4.p1.3.m3.1.1.cmml" xref="S4.p1.3.m3.1.1">𝑛</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.p1.3.m3.1c">n</annotation></semantics></math> and <math id="S4.p1.4.m4.1" class="ltx_Math" alttext="l" display="inline"><semantics id="S4.p1.4.m4.1a"><mi id="S4.p1.4.m4.1.1" xref="S4.p1.4.m4.1.1.cmml">l</mi><annotation-xml encoding="MathML-Content" id="S4.p1.4.m4.1b"><ci id="S4.p1.4.m4.1.1.cmml" xref="S4.p1.4.m4.1.1">𝑙</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.p1.4.m4.1c">l</annotation></semantics></math> are the length of question and answer, respectively. The log-likelihood of the generated answer can be written as:</p>
<table id="S4.E1" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S4.E1.m1.6" class="ltx_Math" alttext="\log p(A|I,Q)=\sum_{t=1}^{l}\log p(a_{t}|a_{1:t-1},I,Q)\vspace{-3pt}" display="block"><semantics id="S4.E1.m1.6a"><mrow id="S4.E1.m1.6.6" xref="S4.E1.m1.6.6.cmml"><mrow id="S4.E1.m1.5.5.1" xref="S4.E1.m1.5.5.1.cmml"><mrow id="S4.E1.m1.5.5.1.3" xref="S4.E1.m1.5.5.1.3.cmml"><mi id="S4.E1.m1.5.5.1.3.1" xref="S4.E1.m1.5.5.1.3.1.cmml">log</mi><mo lspace="0.167em" id="S4.E1.m1.5.5.1.3a" xref="S4.E1.m1.5.5.1.3.cmml">⁡</mo><mi id="S4.E1.m1.5.5.1.3.2" xref="S4.E1.m1.5.5.1.3.2.cmml">p</mi></mrow><mo lspace="0em" rspace="0em" id="S4.E1.m1.5.5.1.2" xref="S4.E1.m1.5.5.1.2.cmml">​</mo><mrow id="S4.E1.m1.5.5.1.1.1" xref="S4.E1.m1.5.5.1.1.1.1.cmml"><mo stretchy="false" id="S4.E1.m1.5.5.1.1.1.2" xref="S4.E1.m1.5.5.1.1.1.1.cmml">(</mo><mrow id="S4.E1.m1.5.5.1.1.1.1" xref="S4.E1.m1.5.5.1.1.1.1.cmml"><mi id="S4.E1.m1.5.5.1.1.1.1.2" xref="S4.E1.m1.5.5.1.1.1.1.2.cmml">A</mi><mo fence="false" id="S4.E1.m1.5.5.1.1.1.1.1" xref="S4.E1.m1.5.5.1.1.1.1.1.cmml">|</mo><mrow id="S4.E1.m1.5.5.1.1.1.1.3.2" xref="S4.E1.m1.5.5.1.1.1.1.3.1.cmml"><mi id="S4.E1.m1.1.1" xref="S4.E1.m1.1.1.cmml">I</mi><mo id="S4.E1.m1.5.5.1.1.1.1.3.2.1" xref="S4.E1.m1.5.5.1.1.1.1.3.1.cmml">,</mo><mi id="S4.E1.m1.2.2" xref="S4.E1.m1.2.2.cmml">Q</mi></mrow></mrow><mo stretchy="false" id="S4.E1.m1.5.5.1.1.1.3" xref="S4.E1.m1.5.5.1.1.1.1.cmml">)</mo></mrow></mrow><mo rspace="0.111em" id="S4.E1.m1.6.6.3" xref="S4.E1.m1.6.6.3.cmml">=</mo><mrow id="S4.E1.m1.6.6.2" xref="S4.E1.m1.6.6.2.cmml"><munderover id="S4.E1.m1.6.6.2.2" xref="S4.E1.m1.6.6.2.2.cmml"><mo movablelimits="false" id="S4.E1.m1.6.6.2.2.2.2" xref="S4.E1.m1.6.6.2.2.2.2.cmml">∑</mo><mrow id="S4.E1.m1.6.6.2.2.2.3" xref="S4.E1.m1.6.6.2.2.2.3.cmml"><mi id="S4.E1.m1.6.6.2.2.2.3.2" xref="S4.E1.m1.6.6.2.2.2.3.2.cmml">t</mi><mo id="S4.E1.m1.6.6.2.2.2.3.1" xref="S4.E1.m1.6.6.2.2.2.3.1.cmml">=</mo><mn id="S4.E1.m1.6.6.2.2.2.3.3" xref="S4.E1.m1.6.6.2.2.2.3.3.cmml">1</mn></mrow><mi id="S4.E1.m1.6.6.2.2.3" xref="S4.E1.m1.6.6.2.2.3.cmml">l</mi></munderover><mrow id="S4.E1.m1.6.6.2.1" xref="S4.E1.m1.6.6.2.1.cmml"><mrow id="S4.E1.m1.6.6.2.1.3" xref="S4.E1.m1.6.6.2.1.3.cmml"><mi id="S4.E1.m1.6.6.2.1.3.1" xref="S4.E1.m1.6.6.2.1.3.1.cmml">log</mi><mo lspace="0.167em" id="S4.E1.m1.6.6.2.1.3a" xref="S4.E1.m1.6.6.2.1.3.cmml">⁡</mo><mi id="S4.E1.m1.6.6.2.1.3.2" xref="S4.E1.m1.6.6.2.1.3.2.cmml">p</mi></mrow><mo lspace="0em" rspace="0em" id="S4.E1.m1.6.6.2.1.2" xref="S4.E1.m1.6.6.2.1.2.cmml">​</mo><mrow id="S4.E1.m1.6.6.2.1.1.1" xref="S4.E1.m1.6.6.2.1.1.1.1.cmml"><mo stretchy="false" id="S4.E1.m1.6.6.2.1.1.1.2" xref="S4.E1.m1.6.6.2.1.1.1.1.cmml">(</mo><mrow id="S4.E1.m1.6.6.2.1.1.1.1" xref="S4.E1.m1.6.6.2.1.1.1.1.cmml"><msub id="S4.E1.m1.6.6.2.1.1.1.1.3" xref="S4.E1.m1.6.6.2.1.1.1.1.3.cmml"><mi id="S4.E1.m1.6.6.2.1.1.1.1.3.2" xref="S4.E1.m1.6.6.2.1.1.1.1.3.2.cmml">a</mi><mi id="S4.E1.m1.6.6.2.1.1.1.1.3.3" xref="S4.E1.m1.6.6.2.1.1.1.1.3.3.cmml">t</mi></msub><mo fence="false" id="S4.E1.m1.6.6.2.1.1.1.1.2" xref="S4.E1.m1.6.6.2.1.1.1.1.2.cmml">|</mo><mrow id="S4.E1.m1.6.6.2.1.1.1.1.1.1" xref="S4.E1.m1.6.6.2.1.1.1.1.1.2.cmml"><msub id="S4.E1.m1.6.6.2.1.1.1.1.1.1.1" xref="S4.E1.m1.6.6.2.1.1.1.1.1.1.1.cmml"><mi id="S4.E1.m1.6.6.2.1.1.1.1.1.1.1.2" xref="S4.E1.m1.6.6.2.1.1.1.1.1.1.1.2.cmml">a</mi><mrow id="S4.E1.m1.6.6.2.1.1.1.1.1.1.1.3" xref="S4.E1.m1.6.6.2.1.1.1.1.1.1.1.3.cmml"><mn id="S4.E1.m1.6.6.2.1.1.1.1.1.1.1.3.2" xref="S4.E1.m1.6.6.2.1.1.1.1.1.1.1.3.2.cmml">1</mn><mo lspace="0.278em" rspace="0.278em" id="S4.E1.m1.6.6.2.1.1.1.1.1.1.1.3.1" xref="S4.E1.m1.6.6.2.1.1.1.1.1.1.1.3.1.cmml">:</mo><mrow id="S4.E1.m1.6.6.2.1.1.1.1.1.1.1.3.3" xref="S4.E1.m1.6.6.2.1.1.1.1.1.1.1.3.3.cmml"><mi id="S4.E1.m1.6.6.2.1.1.1.1.1.1.1.3.3.2" xref="S4.E1.m1.6.6.2.1.1.1.1.1.1.1.3.3.2.cmml">t</mi><mo id="S4.E1.m1.6.6.2.1.1.1.1.1.1.1.3.3.1" xref="S4.E1.m1.6.6.2.1.1.1.1.1.1.1.3.3.1.cmml">−</mo><mn id="S4.E1.m1.6.6.2.1.1.1.1.1.1.1.3.3.3" xref="S4.E1.m1.6.6.2.1.1.1.1.1.1.1.3.3.3.cmml">1</mn></mrow></mrow></msub><mo id="S4.E1.m1.6.6.2.1.1.1.1.1.1.2" xref="S4.E1.m1.6.6.2.1.1.1.1.1.2.cmml">,</mo><mi id="S4.E1.m1.3.3" xref="S4.E1.m1.3.3.cmml">I</mi><mo id="S4.E1.m1.6.6.2.1.1.1.1.1.1.3" xref="S4.E1.m1.6.6.2.1.1.1.1.1.2.cmml">,</mo><mi id="S4.E1.m1.4.4" xref="S4.E1.m1.4.4.cmml">Q</mi></mrow></mrow><mo stretchy="false" id="S4.E1.m1.6.6.2.1.1.1.3" xref="S4.E1.m1.6.6.2.1.1.1.1.cmml">)</mo></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.E1.m1.6b"><apply id="S4.E1.m1.6.6.cmml" xref="S4.E1.m1.6.6"><eq id="S4.E1.m1.6.6.3.cmml" xref="S4.E1.m1.6.6.3"></eq><apply id="S4.E1.m1.5.5.1.cmml" xref="S4.E1.m1.5.5.1"><times id="S4.E1.m1.5.5.1.2.cmml" xref="S4.E1.m1.5.5.1.2"></times><apply id="S4.E1.m1.5.5.1.3.cmml" xref="S4.E1.m1.5.5.1.3"><log id="S4.E1.m1.5.5.1.3.1.cmml" xref="S4.E1.m1.5.5.1.3.1"></log><ci id="S4.E1.m1.5.5.1.3.2.cmml" xref="S4.E1.m1.5.5.1.3.2">𝑝</ci></apply><apply id="S4.E1.m1.5.5.1.1.1.1.cmml" xref="S4.E1.m1.5.5.1.1.1"><csymbol cd="latexml" id="S4.E1.m1.5.5.1.1.1.1.1.cmml" xref="S4.E1.m1.5.5.1.1.1.1.1">conditional</csymbol><ci id="S4.E1.m1.5.5.1.1.1.1.2.cmml" xref="S4.E1.m1.5.5.1.1.1.1.2">𝐴</ci><list id="S4.E1.m1.5.5.1.1.1.1.3.1.cmml" xref="S4.E1.m1.5.5.1.1.1.1.3.2"><ci id="S4.E1.m1.1.1.cmml" xref="S4.E1.m1.1.1">𝐼</ci><ci id="S4.E1.m1.2.2.cmml" xref="S4.E1.m1.2.2">𝑄</ci></list></apply></apply><apply id="S4.E1.m1.6.6.2.cmml" xref="S4.E1.m1.6.6.2"><apply id="S4.E1.m1.6.6.2.2.cmml" xref="S4.E1.m1.6.6.2.2"><csymbol cd="ambiguous" id="S4.E1.m1.6.6.2.2.1.cmml" xref="S4.E1.m1.6.6.2.2">superscript</csymbol><apply id="S4.E1.m1.6.6.2.2.2.cmml" xref="S4.E1.m1.6.6.2.2"><csymbol cd="ambiguous" id="S4.E1.m1.6.6.2.2.2.1.cmml" xref="S4.E1.m1.6.6.2.2">subscript</csymbol><sum id="S4.E1.m1.6.6.2.2.2.2.cmml" xref="S4.E1.m1.6.6.2.2.2.2"></sum><apply id="S4.E1.m1.6.6.2.2.2.3.cmml" xref="S4.E1.m1.6.6.2.2.2.3"><eq id="S4.E1.m1.6.6.2.2.2.3.1.cmml" xref="S4.E1.m1.6.6.2.2.2.3.1"></eq><ci id="S4.E1.m1.6.6.2.2.2.3.2.cmml" xref="S4.E1.m1.6.6.2.2.2.3.2">𝑡</ci><cn type="integer" id="S4.E1.m1.6.6.2.2.2.3.3.cmml" xref="S4.E1.m1.6.6.2.2.2.3.3">1</cn></apply></apply><ci id="S4.E1.m1.6.6.2.2.3.cmml" xref="S4.E1.m1.6.6.2.2.3">𝑙</ci></apply><apply id="S4.E1.m1.6.6.2.1.cmml" xref="S4.E1.m1.6.6.2.1"><times id="S4.E1.m1.6.6.2.1.2.cmml" xref="S4.E1.m1.6.6.2.1.2"></times><apply id="S4.E1.m1.6.6.2.1.3.cmml" xref="S4.E1.m1.6.6.2.1.3"><log id="S4.E1.m1.6.6.2.1.3.1.cmml" xref="S4.E1.m1.6.6.2.1.3.1"></log><ci id="S4.E1.m1.6.6.2.1.3.2.cmml" xref="S4.E1.m1.6.6.2.1.3.2">𝑝</ci></apply><apply id="S4.E1.m1.6.6.2.1.1.1.1.cmml" xref="S4.E1.m1.6.6.2.1.1.1"><csymbol cd="latexml" id="S4.E1.m1.6.6.2.1.1.1.1.2.cmml" xref="S4.E1.m1.6.6.2.1.1.1.1.2">conditional</csymbol><apply id="S4.E1.m1.6.6.2.1.1.1.1.3.cmml" xref="S4.E1.m1.6.6.2.1.1.1.1.3"><csymbol cd="ambiguous" id="S4.E1.m1.6.6.2.1.1.1.1.3.1.cmml" xref="S4.E1.m1.6.6.2.1.1.1.1.3">subscript</csymbol><ci id="S4.E1.m1.6.6.2.1.1.1.1.3.2.cmml" xref="S4.E1.m1.6.6.2.1.1.1.1.3.2">𝑎</ci><ci id="S4.E1.m1.6.6.2.1.1.1.1.3.3.cmml" xref="S4.E1.m1.6.6.2.1.1.1.1.3.3">𝑡</ci></apply><list id="S4.E1.m1.6.6.2.1.1.1.1.1.2.cmml" xref="S4.E1.m1.6.6.2.1.1.1.1.1.1"><apply id="S4.E1.m1.6.6.2.1.1.1.1.1.1.1.cmml" xref="S4.E1.m1.6.6.2.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.E1.m1.6.6.2.1.1.1.1.1.1.1.1.cmml" xref="S4.E1.m1.6.6.2.1.1.1.1.1.1.1">subscript</csymbol><ci id="S4.E1.m1.6.6.2.1.1.1.1.1.1.1.2.cmml" xref="S4.E1.m1.6.6.2.1.1.1.1.1.1.1.2">𝑎</ci><apply id="S4.E1.m1.6.6.2.1.1.1.1.1.1.1.3.cmml" xref="S4.E1.m1.6.6.2.1.1.1.1.1.1.1.3"><ci id="S4.E1.m1.6.6.2.1.1.1.1.1.1.1.3.1.cmml" xref="S4.E1.m1.6.6.2.1.1.1.1.1.1.1.3.1">:</ci><cn type="integer" id="S4.E1.m1.6.6.2.1.1.1.1.1.1.1.3.2.cmml" xref="S4.E1.m1.6.6.2.1.1.1.1.1.1.1.3.2">1</cn><apply id="S4.E1.m1.6.6.2.1.1.1.1.1.1.1.3.3.cmml" xref="S4.E1.m1.6.6.2.1.1.1.1.1.1.1.3.3"><minus id="S4.E1.m1.6.6.2.1.1.1.1.1.1.1.3.3.1.cmml" xref="S4.E1.m1.6.6.2.1.1.1.1.1.1.1.3.3.1"></minus><ci id="S4.E1.m1.6.6.2.1.1.1.1.1.1.1.3.3.2.cmml" xref="S4.E1.m1.6.6.2.1.1.1.1.1.1.1.3.3.2">𝑡</ci><cn type="integer" id="S4.E1.m1.6.6.2.1.1.1.1.1.1.1.3.3.3.cmml" xref="S4.E1.m1.6.6.2.1.1.1.1.1.1.1.3.3.3">1</cn></apply></apply></apply><ci id="S4.E1.m1.3.3.cmml" xref="S4.E1.m1.3.3">𝐼</ci><ci id="S4.E1.m1.4.4.cmml" xref="S4.E1.m1.4.4">𝑄</ci></list></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.E1.m1.6c">\log p(A|I,Q)=\sum_{t=1}^{l}\log p(a_{t}|a_{1:t-1},I,Q)\vspace{-3pt}</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(1)</span></td>
</tr></tbody>
</table>
<p id="S4.p1.11" class="ltx_p">where <math id="S4.p1.5.m1.3" class="ltx_Math" alttext="p(a_{t}|a_{1:t-1},I,Q)" display="inline"><semantics id="S4.p1.5.m1.3a"><mrow id="S4.p1.5.m1.3.3" xref="S4.p1.5.m1.3.3.cmml"><mi id="S4.p1.5.m1.3.3.3" xref="S4.p1.5.m1.3.3.3.cmml">p</mi><mo lspace="0em" rspace="0em" id="S4.p1.5.m1.3.3.2" xref="S4.p1.5.m1.3.3.2.cmml">​</mo><mrow id="S4.p1.5.m1.3.3.1.1" xref="S4.p1.5.m1.3.3.1.1.1.cmml"><mo stretchy="false" id="S4.p1.5.m1.3.3.1.1.2" xref="S4.p1.5.m1.3.3.1.1.1.cmml">(</mo><mrow id="S4.p1.5.m1.3.3.1.1.1" xref="S4.p1.5.m1.3.3.1.1.1.cmml"><msub id="S4.p1.5.m1.3.3.1.1.1.3" xref="S4.p1.5.m1.3.3.1.1.1.3.cmml"><mi id="S4.p1.5.m1.3.3.1.1.1.3.2" xref="S4.p1.5.m1.3.3.1.1.1.3.2.cmml">a</mi><mi id="S4.p1.5.m1.3.3.1.1.1.3.3" xref="S4.p1.5.m1.3.3.1.1.1.3.3.cmml">t</mi></msub><mo fence="false" id="S4.p1.5.m1.3.3.1.1.1.2" xref="S4.p1.5.m1.3.3.1.1.1.2.cmml">|</mo><mrow id="S4.p1.5.m1.3.3.1.1.1.1.1" xref="S4.p1.5.m1.3.3.1.1.1.1.2.cmml"><msub id="S4.p1.5.m1.3.3.1.1.1.1.1.1" xref="S4.p1.5.m1.3.3.1.1.1.1.1.1.cmml"><mi id="S4.p1.5.m1.3.3.1.1.1.1.1.1.2" xref="S4.p1.5.m1.3.3.1.1.1.1.1.1.2.cmml">a</mi><mrow id="S4.p1.5.m1.3.3.1.1.1.1.1.1.3" xref="S4.p1.5.m1.3.3.1.1.1.1.1.1.3.cmml"><mn id="S4.p1.5.m1.3.3.1.1.1.1.1.1.3.2" xref="S4.p1.5.m1.3.3.1.1.1.1.1.1.3.2.cmml">1</mn><mo lspace="0.278em" rspace="0.278em" id="S4.p1.5.m1.3.3.1.1.1.1.1.1.3.1" xref="S4.p1.5.m1.3.3.1.1.1.1.1.1.3.1.cmml">:</mo><mrow id="S4.p1.5.m1.3.3.1.1.1.1.1.1.3.3" xref="S4.p1.5.m1.3.3.1.1.1.1.1.1.3.3.cmml"><mi id="S4.p1.5.m1.3.3.1.1.1.1.1.1.3.3.2" xref="S4.p1.5.m1.3.3.1.1.1.1.1.1.3.3.2.cmml">t</mi><mo id="S4.p1.5.m1.3.3.1.1.1.1.1.1.3.3.1" xref="S4.p1.5.m1.3.3.1.1.1.1.1.1.3.3.1.cmml">−</mo><mn id="S4.p1.5.m1.3.3.1.1.1.1.1.1.3.3.3" xref="S4.p1.5.m1.3.3.1.1.1.1.1.1.3.3.3.cmml">1</mn></mrow></mrow></msub><mo id="S4.p1.5.m1.3.3.1.1.1.1.1.2" xref="S4.p1.5.m1.3.3.1.1.1.1.2.cmml">,</mo><mi id="S4.p1.5.m1.1.1" xref="S4.p1.5.m1.1.1.cmml">I</mi><mo id="S4.p1.5.m1.3.3.1.1.1.1.1.3" xref="S4.p1.5.m1.3.3.1.1.1.1.2.cmml">,</mo><mi id="S4.p1.5.m1.2.2" xref="S4.p1.5.m1.2.2.cmml">Q</mi></mrow></mrow><mo stretchy="false" id="S4.p1.5.m1.3.3.1.1.3" xref="S4.p1.5.m1.3.3.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.p1.5.m1.3b"><apply id="S4.p1.5.m1.3.3.cmml" xref="S4.p1.5.m1.3.3"><times id="S4.p1.5.m1.3.3.2.cmml" xref="S4.p1.5.m1.3.3.2"></times><ci id="S4.p1.5.m1.3.3.3.cmml" xref="S4.p1.5.m1.3.3.3">𝑝</ci><apply id="S4.p1.5.m1.3.3.1.1.1.cmml" xref="S4.p1.5.m1.3.3.1.1"><csymbol cd="latexml" id="S4.p1.5.m1.3.3.1.1.1.2.cmml" xref="S4.p1.5.m1.3.3.1.1.1.2">conditional</csymbol><apply id="S4.p1.5.m1.3.3.1.1.1.3.cmml" xref="S4.p1.5.m1.3.3.1.1.1.3"><csymbol cd="ambiguous" id="S4.p1.5.m1.3.3.1.1.1.3.1.cmml" xref="S4.p1.5.m1.3.3.1.1.1.3">subscript</csymbol><ci id="S4.p1.5.m1.3.3.1.1.1.3.2.cmml" xref="S4.p1.5.m1.3.3.1.1.1.3.2">𝑎</ci><ci id="S4.p1.5.m1.3.3.1.1.1.3.3.cmml" xref="S4.p1.5.m1.3.3.1.1.1.3.3">𝑡</ci></apply><list id="S4.p1.5.m1.3.3.1.1.1.1.2.cmml" xref="S4.p1.5.m1.3.3.1.1.1.1.1"><apply id="S4.p1.5.m1.3.3.1.1.1.1.1.1.cmml" xref="S4.p1.5.m1.3.3.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.p1.5.m1.3.3.1.1.1.1.1.1.1.cmml" xref="S4.p1.5.m1.3.3.1.1.1.1.1.1">subscript</csymbol><ci id="S4.p1.5.m1.3.3.1.1.1.1.1.1.2.cmml" xref="S4.p1.5.m1.3.3.1.1.1.1.1.1.2">𝑎</ci><apply id="S4.p1.5.m1.3.3.1.1.1.1.1.1.3.cmml" xref="S4.p1.5.m1.3.3.1.1.1.1.1.1.3"><ci id="S4.p1.5.m1.3.3.1.1.1.1.1.1.3.1.cmml" xref="S4.p1.5.m1.3.3.1.1.1.1.1.1.3.1">:</ci><cn type="integer" id="S4.p1.5.m1.3.3.1.1.1.1.1.1.3.2.cmml" xref="S4.p1.5.m1.3.3.1.1.1.1.1.1.3.2">1</cn><apply id="S4.p1.5.m1.3.3.1.1.1.1.1.1.3.3.cmml" xref="S4.p1.5.m1.3.3.1.1.1.1.1.1.3.3"><minus id="S4.p1.5.m1.3.3.1.1.1.1.1.1.3.3.1.cmml" xref="S4.p1.5.m1.3.3.1.1.1.1.1.1.3.3.1"></minus><ci id="S4.p1.5.m1.3.3.1.1.1.1.1.1.3.3.2.cmml" xref="S4.p1.5.m1.3.3.1.1.1.1.1.1.3.3.2">𝑡</ci><cn type="integer" id="S4.p1.5.m1.3.3.1.1.1.1.1.1.3.3.3.cmml" xref="S4.p1.5.m1.3.3.1.1.1.1.1.1.3.3.3">1</cn></apply></apply></apply><ci id="S4.p1.5.m1.1.1.cmml" xref="S4.p1.5.m1.1.1">𝐼</ci><ci id="S4.p1.5.m1.2.2.cmml" xref="S4.p1.5.m1.2.2">𝑄</ci></list></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.p1.5.m1.3c">p(a_{t}|a_{1:t-1},I,Q)</annotation></semantics></math> is the probability of generating <math id="S4.p1.6.m2.1" class="ltx_Math" alttext="a_{t}" display="inline"><semantics id="S4.p1.6.m2.1a"><msub id="S4.p1.6.m2.1.1" xref="S4.p1.6.m2.1.1.cmml"><mi id="S4.p1.6.m2.1.1.2" xref="S4.p1.6.m2.1.1.2.cmml">a</mi><mi id="S4.p1.6.m2.1.1.3" xref="S4.p1.6.m2.1.1.3.cmml">t</mi></msub><annotation-xml encoding="MathML-Content" id="S4.p1.6.m2.1b"><apply id="S4.p1.6.m2.1.1.cmml" xref="S4.p1.6.m2.1.1"><csymbol cd="ambiguous" id="S4.p1.6.m2.1.1.1.cmml" xref="S4.p1.6.m2.1.1">subscript</csymbol><ci id="S4.p1.6.m2.1.1.2.cmml" xref="S4.p1.6.m2.1.1.2">𝑎</ci><ci id="S4.p1.6.m2.1.1.3.cmml" xref="S4.p1.6.m2.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.p1.6.m2.1c">a_{t}</annotation></semantics></math> given image information <math id="S4.p1.7.m3.1" class="ltx_Math" alttext="I" display="inline"><semantics id="S4.p1.7.m3.1a"><mi id="S4.p1.7.m3.1.1" xref="S4.p1.7.m3.1.1.cmml">I</mi><annotation-xml encoding="MathML-Content" id="S4.p1.7.m3.1b"><ci id="S4.p1.7.m3.1.1.cmml" xref="S4.p1.7.m3.1.1">𝐼</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.p1.7.m3.1c">I</annotation></semantics></math>, question <math id="S4.p1.8.m4.1" class="ltx_Math" alttext="Q" display="inline"><semantics id="S4.p1.8.m4.1a"><mi id="S4.p1.8.m4.1.1" xref="S4.p1.8.m4.1.1.cmml">Q</mi><annotation-xml encoding="MathML-Content" id="S4.p1.8.m4.1b"><ci id="S4.p1.8.m4.1.1.cmml" xref="S4.p1.8.m4.1.1">𝑄</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.p1.8.m4.1c">Q</annotation></semantics></math> and previous words <math id="S4.p1.9.m5.1" class="ltx_Math" alttext="a_{1:t-1}" display="inline"><semantics id="S4.p1.9.m5.1a"><msub id="S4.p1.9.m5.1.1" xref="S4.p1.9.m5.1.1.cmml"><mi id="S4.p1.9.m5.1.1.2" xref="S4.p1.9.m5.1.1.2.cmml">a</mi><mrow id="S4.p1.9.m5.1.1.3" xref="S4.p1.9.m5.1.1.3.cmml"><mn id="S4.p1.9.m5.1.1.3.2" xref="S4.p1.9.m5.1.1.3.2.cmml">1</mn><mo lspace="0.278em" rspace="0.278em" id="S4.p1.9.m5.1.1.3.1" xref="S4.p1.9.m5.1.1.3.1.cmml">:</mo><mrow id="S4.p1.9.m5.1.1.3.3" xref="S4.p1.9.m5.1.1.3.3.cmml"><mi id="S4.p1.9.m5.1.1.3.3.2" xref="S4.p1.9.m5.1.1.3.3.2.cmml">t</mi><mo id="S4.p1.9.m5.1.1.3.3.1" xref="S4.p1.9.m5.1.1.3.3.1.cmml">−</mo><mn id="S4.p1.9.m5.1.1.3.3.3" xref="S4.p1.9.m5.1.1.3.3.3.cmml">1</mn></mrow></mrow></msub><annotation-xml encoding="MathML-Content" id="S4.p1.9.m5.1b"><apply id="S4.p1.9.m5.1.1.cmml" xref="S4.p1.9.m5.1.1"><csymbol cd="ambiguous" id="S4.p1.9.m5.1.1.1.cmml" xref="S4.p1.9.m5.1.1">subscript</csymbol><ci id="S4.p1.9.m5.1.1.2.cmml" xref="S4.p1.9.m5.1.1.2">𝑎</ci><apply id="S4.p1.9.m5.1.1.3.cmml" xref="S4.p1.9.m5.1.1.3"><ci id="S4.p1.9.m5.1.1.3.1.cmml" xref="S4.p1.9.m5.1.1.3.1">:</ci><cn type="integer" id="S4.p1.9.m5.1.1.3.2.cmml" xref="S4.p1.9.m5.1.1.3.2">1</cn><apply id="S4.p1.9.m5.1.1.3.3.cmml" xref="S4.p1.9.m5.1.1.3.3"><minus id="S4.p1.9.m5.1.1.3.3.1.cmml" xref="S4.p1.9.m5.1.1.3.3.1"></minus><ci id="S4.p1.9.m5.1.1.3.3.2.cmml" xref="S4.p1.9.m5.1.1.3.3.2">𝑡</ci><cn type="integer" id="S4.p1.9.m5.1.1.3.3.3.cmml" xref="S4.p1.9.m5.1.1.3.3.3">1</cn></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.p1.9.m5.1c">a_{1:t-1}</annotation></semantics></math>. We employ an encoder LSTM <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib13" title="" class="ltx_ref">13</a>]</cite> to take the semantic information from image <math id="S4.p1.10.m6.1" class="ltx_Math" alttext="I" display="inline"><semantics id="S4.p1.10.m6.1a"><mi id="S4.p1.10.m6.1.1" xref="S4.p1.10.m6.1.1.cmml">I</mi><annotation-xml encoding="MathML-Content" id="S4.p1.10.m6.1b"><ci id="S4.p1.10.m6.1.1.cmml" xref="S4.p1.10.m6.1.1">𝐼</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.p1.10.m6.1c">I</annotation></semantics></math> and the question <math id="S4.p1.11.m7.1" class="ltx_Math" alttext="Q" display="inline"><semantics id="S4.p1.11.m7.1a"><mi id="S4.p1.11.m7.1.1" xref="S4.p1.11.m7.1.1.cmml">Q</mi><annotation-xml encoding="MathML-Content" id="S4.p1.11.m7.1b"><ci id="S4.p1.11.m7.1.1.cmml" xref="S4.p1.11.m7.1.1">𝑄</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.p1.11.m7.1c">Q</annotation></semantics></math>, while using a decoder LSTM to generate the answer. Weights are shared between the encoder and decoder LSTM.</p>
</div>
<div id="S4.p2" class="ltx_para">
<p id="S4.p2.5" class="ltx_p">In the training phase, the question <math id="S4.p2.1.m1.1" class="ltx_Math" alttext="Q" display="inline"><semantics id="S4.p2.1.m1.1a"><mi id="S4.p2.1.m1.1.1" xref="S4.p2.1.m1.1.1.cmml">Q</mi><annotation-xml encoding="MathML-Content" id="S4.p2.1.m1.1b"><ci id="S4.p2.1.m1.1.1.cmml" xref="S4.p2.1.m1.1.1">𝑄</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.p2.1.m1.1c">Q</annotation></semantics></math> and answer <math id="S4.p2.2.m2.1" class="ltx_Math" alttext="A" display="inline"><semantics id="S4.p2.2.m2.1a"><mi id="S4.p2.2.m2.1.1" xref="S4.p2.2.m2.1.1.cmml">A</mi><annotation-xml encoding="MathML-Content" id="S4.p2.2.m2.1b"><ci id="S4.p2.2.m2.1.1.cmml" xref="S4.p2.2.m2.1.1">𝐴</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.p2.2.m2.1c">A</annotation></semantics></math> are concatenated as <math id="S4.p2.3.m3.7" class="ltx_Math" alttext="\{q_{1},...,q_{n},a_{1},...,a_{l},a_{l+1}\}" display="inline"><semantics id="S4.p2.3.m3.7a"><mrow id="S4.p2.3.m3.7.7.5" xref="S4.p2.3.m3.7.7.6.cmml"><mo stretchy="false" id="S4.p2.3.m3.7.7.5.6" xref="S4.p2.3.m3.7.7.6.cmml">{</mo><msub id="S4.p2.3.m3.3.3.1.1" xref="S4.p2.3.m3.3.3.1.1.cmml"><mi id="S4.p2.3.m3.3.3.1.1.2" xref="S4.p2.3.m3.3.3.1.1.2.cmml">q</mi><mn id="S4.p2.3.m3.3.3.1.1.3" xref="S4.p2.3.m3.3.3.1.1.3.cmml">1</mn></msub><mo id="S4.p2.3.m3.7.7.5.7" xref="S4.p2.3.m3.7.7.6.cmml">,</mo><mi mathvariant="normal" id="S4.p2.3.m3.1.1" xref="S4.p2.3.m3.1.1.cmml">…</mi><mo id="S4.p2.3.m3.7.7.5.8" xref="S4.p2.3.m3.7.7.6.cmml">,</mo><msub id="S4.p2.3.m3.4.4.2.2" xref="S4.p2.3.m3.4.4.2.2.cmml"><mi id="S4.p2.3.m3.4.4.2.2.2" xref="S4.p2.3.m3.4.4.2.2.2.cmml">q</mi><mi id="S4.p2.3.m3.4.4.2.2.3" xref="S4.p2.3.m3.4.4.2.2.3.cmml">n</mi></msub><mo id="S4.p2.3.m3.7.7.5.9" xref="S4.p2.3.m3.7.7.6.cmml">,</mo><msub id="S4.p2.3.m3.5.5.3.3" xref="S4.p2.3.m3.5.5.3.3.cmml"><mi id="S4.p2.3.m3.5.5.3.3.2" xref="S4.p2.3.m3.5.5.3.3.2.cmml">a</mi><mn id="S4.p2.3.m3.5.5.3.3.3" xref="S4.p2.3.m3.5.5.3.3.3.cmml">1</mn></msub><mo id="S4.p2.3.m3.7.7.5.10" xref="S4.p2.3.m3.7.7.6.cmml">,</mo><mi mathvariant="normal" id="S4.p2.3.m3.2.2" xref="S4.p2.3.m3.2.2.cmml">…</mi><mo id="S4.p2.3.m3.7.7.5.11" xref="S4.p2.3.m3.7.7.6.cmml">,</mo><msub id="S4.p2.3.m3.6.6.4.4" xref="S4.p2.3.m3.6.6.4.4.cmml"><mi id="S4.p2.3.m3.6.6.4.4.2" xref="S4.p2.3.m3.6.6.4.4.2.cmml">a</mi><mi id="S4.p2.3.m3.6.6.4.4.3" xref="S4.p2.3.m3.6.6.4.4.3.cmml">l</mi></msub><mo id="S4.p2.3.m3.7.7.5.12" xref="S4.p2.3.m3.7.7.6.cmml">,</mo><msub id="S4.p2.3.m3.7.7.5.5" xref="S4.p2.3.m3.7.7.5.5.cmml"><mi id="S4.p2.3.m3.7.7.5.5.2" xref="S4.p2.3.m3.7.7.5.5.2.cmml">a</mi><mrow id="S4.p2.3.m3.7.7.5.5.3" xref="S4.p2.3.m3.7.7.5.5.3.cmml"><mi id="S4.p2.3.m3.7.7.5.5.3.2" xref="S4.p2.3.m3.7.7.5.5.3.2.cmml">l</mi><mo id="S4.p2.3.m3.7.7.5.5.3.1" xref="S4.p2.3.m3.7.7.5.5.3.1.cmml">+</mo><mn id="S4.p2.3.m3.7.7.5.5.3.3" xref="S4.p2.3.m3.7.7.5.5.3.3.cmml">1</mn></mrow></msub><mo stretchy="false" id="S4.p2.3.m3.7.7.5.13" xref="S4.p2.3.m3.7.7.6.cmml">}</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.p2.3.m3.7b"><set id="S4.p2.3.m3.7.7.6.cmml" xref="S4.p2.3.m3.7.7.5"><apply id="S4.p2.3.m3.3.3.1.1.cmml" xref="S4.p2.3.m3.3.3.1.1"><csymbol cd="ambiguous" id="S4.p2.3.m3.3.3.1.1.1.cmml" xref="S4.p2.3.m3.3.3.1.1">subscript</csymbol><ci id="S4.p2.3.m3.3.3.1.1.2.cmml" xref="S4.p2.3.m3.3.3.1.1.2">𝑞</ci><cn type="integer" id="S4.p2.3.m3.3.3.1.1.3.cmml" xref="S4.p2.3.m3.3.3.1.1.3">1</cn></apply><ci id="S4.p2.3.m3.1.1.cmml" xref="S4.p2.3.m3.1.1">…</ci><apply id="S4.p2.3.m3.4.4.2.2.cmml" xref="S4.p2.3.m3.4.4.2.2"><csymbol cd="ambiguous" id="S4.p2.3.m3.4.4.2.2.1.cmml" xref="S4.p2.3.m3.4.4.2.2">subscript</csymbol><ci id="S4.p2.3.m3.4.4.2.2.2.cmml" xref="S4.p2.3.m3.4.4.2.2.2">𝑞</ci><ci id="S4.p2.3.m3.4.4.2.2.3.cmml" xref="S4.p2.3.m3.4.4.2.2.3">𝑛</ci></apply><apply id="S4.p2.3.m3.5.5.3.3.cmml" xref="S4.p2.3.m3.5.5.3.3"><csymbol cd="ambiguous" id="S4.p2.3.m3.5.5.3.3.1.cmml" xref="S4.p2.3.m3.5.5.3.3">subscript</csymbol><ci id="S4.p2.3.m3.5.5.3.3.2.cmml" xref="S4.p2.3.m3.5.5.3.3.2">𝑎</ci><cn type="integer" id="S4.p2.3.m3.5.5.3.3.3.cmml" xref="S4.p2.3.m3.5.5.3.3.3">1</cn></apply><ci id="S4.p2.3.m3.2.2.cmml" xref="S4.p2.3.m3.2.2">…</ci><apply id="S4.p2.3.m3.6.6.4.4.cmml" xref="S4.p2.3.m3.6.6.4.4"><csymbol cd="ambiguous" id="S4.p2.3.m3.6.6.4.4.1.cmml" xref="S4.p2.3.m3.6.6.4.4">subscript</csymbol><ci id="S4.p2.3.m3.6.6.4.4.2.cmml" xref="S4.p2.3.m3.6.6.4.4.2">𝑎</ci><ci id="S4.p2.3.m3.6.6.4.4.3.cmml" xref="S4.p2.3.m3.6.6.4.4.3">𝑙</ci></apply><apply id="S4.p2.3.m3.7.7.5.5.cmml" xref="S4.p2.3.m3.7.7.5.5"><csymbol cd="ambiguous" id="S4.p2.3.m3.7.7.5.5.1.cmml" xref="S4.p2.3.m3.7.7.5.5">subscript</csymbol><ci id="S4.p2.3.m3.7.7.5.5.2.cmml" xref="S4.p2.3.m3.7.7.5.5.2">𝑎</ci><apply id="S4.p2.3.m3.7.7.5.5.3.cmml" xref="S4.p2.3.m3.7.7.5.5.3"><plus id="S4.p2.3.m3.7.7.5.5.3.1.cmml" xref="S4.p2.3.m3.7.7.5.5.3.1"></plus><ci id="S4.p2.3.m3.7.7.5.5.3.2.cmml" xref="S4.p2.3.m3.7.7.5.5.3.2">𝑙</ci><cn type="integer" id="S4.p2.3.m3.7.7.5.5.3.3.cmml" xref="S4.p2.3.m3.7.7.5.5.3.3">1</cn></apply></apply></set></annotation-xml><annotation encoding="application/x-tex" id="S4.p2.3.m3.7c">\{q_{1},...,q_{n},a_{1},...,a_{l},a_{l+1}\}</annotation></semantics></math>, where <math id="S4.p2.4.m4.1" class="ltx_Math" alttext="a_{l+1}" display="inline"><semantics id="S4.p2.4.m4.1a"><msub id="S4.p2.4.m4.1.1" xref="S4.p2.4.m4.1.1.cmml"><mi id="S4.p2.4.m4.1.1.2" xref="S4.p2.4.m4.1.1.2.cmml">a</mi><mrow id="S4.p2.4.m4.1.1.3" xref="S4.p2.4.m4.1.1.3.cmml"><mi id="S4.p2.4.m4.1.1.3.2" xref="S4.p2.4.m4.1.1.3.2.cmml">l</mi><mo id="S4.p2.4.m4.1.1.3.1" xref="S4.p2.4.m4.1.1.3.1.cmml">+</mo><mn id="S4.p2.4.m4.1.1.3.3" xref="S4.p2.4.m4.1.1.3.3.cmml">1</mn></mrow></msub><annotation-xml encoding="MathML-Content" id="S4.p2.4.m4.1b"><apply id="S4.p2.4.m4.1.1.cmml" xref="S4.p2.4.m4.1.1"><csymbol cd="ambiguous" id="S4.p2.4.m4.1.1.1.cmml" xref="S4.p2.4.m4.1.1">subscript</csymbol><ci id="S4.p2.4.m4.1.1.2.cmml" xref="S4.p2.4.m4.1.1.2">𝑎</ci><apply id="S4.p2.4.m4.1.1.3.cmml" xref="S4.p2.4.m4.1.1.3"><plus id="S4.p2.4.m4.1.1.3.1.cmml" xref="S4.p2.4.m4.1.1.3.1"></plus><ci id="S4.p2.4.m4.1.1.3.2.cmml" xref="S4.p2.4.m4.1.1.3.2">𝑙</ci><cn type="integer" id="S4.p2.4.m4.1.1.3.3.cmml" xref="S4.p2.4.m4.1.1.3.3">1</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.p2.4.m4.1c">a_{l+1}</annotation></semantics></math> is a special END token. Each word is represented as a one-hot vector of dimension equal to the size of the word dictionary. The training procedure is as follows: at time step <math id="S4.p2.5.m5.1" class="ltx_Math" alttext="t=0" display="inline"><semantics id="S4.p2.5.m5.1a"><mrow id="S4.p2.5.m5.1.1" xref="S4.p2.5.m5.1.1.cmml"><mi id="S4.p2.5.m5.1.1.2" xref="S4.p2.5.m5.1.1.2.cmml">t</mi><mo id="S4.p2.5.m5.1.1.1" xref="S4.p2.5.m5.1.1.1.cmml">=</mo><mn id="S4.p2.5.m5.1.1.3" xref="S4.p2.5.m5.1.1.3.cmml">0</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.p2.5.m5.1b"><apply id="S4.p2.5.m5.1.1.cmml" xref="S4.p2.5.m5.1.1"><eq id="S4.p2.5.m5.1.1.1.cmml" xref="S4.p2.5.m5.1.1.1"></eq><ci id="S4.p2.5.m5.1.1.2.cmml" xref="S4.p2.5.m5.1.1.2">𝑡</ci><cn type="integer" id="S4.p2.5.m5.1.1.3.cmml" xref="S4.p2.5.m5.1.1.3">0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.p2.5.m5.1c">t=0</annotation></semantics></math>, we set the LSTM input:</p>
<table id="S4.E2" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S4.E2.m1.6" class="ltx_Math" alttext="x_{initial}=[W_{ea}{V_{att}}(I),W_{ec}{V_{cap}}(I),W_{ek}{V_{know}}(I)]\vspace{-2pt}" display="block"><semantics id="S4.E2.m1.6a"><mrow id="S4.E2.m1.6.6" xref="S4.E2.m1.6.6.cmml"><msub id="S4.E2.m1.6.6.5" xref="S4.E2.m1.6.6.5.cmml"><mi id="S4.E2.m1.6.6.5.2" xref="S4.E2.m1.6.6.5.2.cmml">x</mi><mrow id="S4.E2.m1.6.6.5.3" xref="S4.E2.m1.6.6.5.3.cmml"><mi id="S4.E2.m1.6.6.5.3.2" xref="S4.E2.m1.6.6.5.3.2.cmml">i</mi><mo lspace="0em" rspace="0em" id="S4.E2.m1.6.6.5.3.1" xref="S4.E2.m1.6.6.5.3.1.cmml">​</mo><mi id="S4.E2.m1.6.6.5.3.3" xref="S4.E2.m1.6.6.5.3.3.cmml">n</mi><mo lspace="0em" rspace="0em" id="S4.E2.m1.6.6.5.3.1a" xref="S4.E2.m1.6.6.5.3.1.cmml">​</mo><mi id="S4.E2.m1.6.6.5.3.4" xref="S4.E2.m1.6.6.5.3.4.cmml">i</mi><mo lspace="0em" rspace="0em" id="S4.E2.m1.6.6.5.3.1b" xref="S4.E2.m1.6.6.5.3.1.cmml">​</mo><mi id="S4.E2.m1.6.6.5.3.5" xref="S4.E2.m1.6.6.5.3.5.cmml">t</mi><mo lspace="0em" rspace="0em" id="S4.E2.m1.6.6.5.3.1c" xref="S4.E2.m1.6.6.5.3.1.cmml">​</mo><mi id="S4.E2.m1.6.6.5.3.6" xref="S4.E2.m1.6.6.5.3.6.cmml">i</mi><mo lspace="0em" rspace="0em" id="S4.E2.m1.6.6.5.3.1d" xref="S4.E2.m1.6.6.5.3.1.cmml">​</mo><mi id="S4.E2.m1.6.6.5.3.7" xref="S4.E2.m1.6.6.5.3.7.cmml">a</mi><mo lspace="0em" rspace="0em" id="S4.E2.m1.6.6.5.3.1e" xref="S4.E2.m1.6.6.5.3.1.cmml">​</mo><mi id="S4.E2.m1.6.6.5.3.8" xref="S4.E2.m1.6.6.5.3.8.cmml">l</mi></mrow></msub><mo id="S4.E2.m1.6.6.4" xref="S4.E2.m1.6.6.4.cmml">=</mo><mrow id="S4.E2.m1.6.6.3.3" xref="S4.E2.m1.6.6.3.4.cmml"><mo stretchy="false" id="S4.E2.m1.6.6.3.3.4" xref="S4.E2.m1.6.6.3.4.cmml">[</mo><mrow id="S4.E2.m1.4.4.1.1.1" xref="S4.E2.m1.4.4.1.1.1.cmml"><msub id="S4.E2.m1.4.4.1.1.1.2" xref="S4.E2.m1.4.4.1.1.1.2.cmml"><mi id="S4.E2.m1.4.4.1.1.1.2.2" xref="S4.E2.m1.4.4.1.1.1.2.2.cmml">W</mi><mrow id="S4.E2.m1.4.4.1.1.1.2.3" xref="S4.E2.m1.4.4.1.1.1.2.3.cmml"><mi id="S4.E2.m1.4.4.1.1.1.2.3.2" xref="S4.E2.m1.4.4.1.1.1.2.3.2.cmml">e</mi><mo lspace="0em" rspace="0em" id="S4.E2.m1.4.4.1.1.1.2.3.1" xref="S4.E2.m1.4.4.1.1.1.2.3.1.cmml">​</mo><mi id="S4.E2.m1.4.4.1.1.1.2.3.3" xref="S4.E2.m1.4.4.1.1.1.2.3.3.cmml">a</mi></mrow></msub><mo lspace="0em" rspace="0em" id="S4.E2.m1.4.4.1.1.1.1" xref="S4.E2.m1.4.4.1.1.1.1.cmml">​</mo><msub id="S4.E2.m1.4.4.1.1.1.3" xref="S4.E2.m1.4.4.1.1.1.3.cmml"><mi id="S4.E2.m1.4.4.1.1.1.3.2" xref="S4.E2.m1.4.4.1.1.1.3.2.cmml">V</mi><mrow id="S4.E2.m1.4.4.1.1.1.3.3" xref="S4.E2.m1.4.4.1.1.1.3.3.cmml"><mi id="S4.E2.m1.4.4.1.1.1.3.3.2" xref="S4.E2.m1.4.4.1.1.1.3.3.2.cmml">a</mi><mo lspace="0em" rspace="0em" id="S4.E2.m1.4.4.1.1.1.3.3.1" xref="S4.E2.m1.4.4.1.1.1.3.3.1.cmml">​</mo><mi id="S4.E2.m1.4.4.1.1.1.3.3.3" xref="S4.E2.m1.4.4.1.1.1.3.3.3.cmml">t</mi><mo lspace="0em" rspace="0em" id="S4.E2.m1.4.4.1.1.1.3.3.1a" xref="S4.E2.m1.4.4.1.1.1.3.3.1.cmml">​</mo><mi id="S4.E2.m1.4.4.1.1.1.3.3.4" xref="S4.E2.m1.4.4.1.1.1.3.3.4.cmml">t</mi></mrow></msub><mo lspace="0em" rspace="0em" id="S4.E2.m1.4.4.1.1.1.1a" xref="S4.E2.m1.4.4.1.1.1.1.cmml">​</mo><mrow id="S4.E2.m1.4.4.1.1.1.4.2" xref="S4.E2.m1.4.4.1.1.1.cmml"><mo stretchy="false" id="S4.E2.m1.4.4.1.1.1.4.2.1" xref="S4.E2.m1.4.4.1.1.1.cmml">(</mo><mi id="S4.E2.m1.1.1" xref="S4.E2.m1.1.1.cmml">I</mi><mo stretchy="false" id="S4.E2.m1.4.4.1.1.1.4.2.2" xref="S4.E2.m1.4.4.1.1.1.cmml">)</mo></mrow></mrow><mo id="S4.E2.m1.6.6.3.3.5" xref="S4.E2.m1.6.6.3.4.cmml">,</mo><mrow id="S4.E2.m1.5.5.2.2.2" xref="S4.E2.m1.5.5.2.2.2.cmml"><msub id="S4.E2.m1.5.5.2.2.2.2" xref="S4.E2.m1.5.5.2.2.2.2.cmml"><mi id="S4.E2.m1.5.5.2.2.2.2.2" xref="S4.E2.m1.5.5.2.2.2.2.2.cmml">W</mi><mrow id="S4.E2.m1.5.5.2.2.2.2.3" xref="S4.E2.m1.5.5.2.2.2.2.3.cmml"><mi id="S4.E2.m1.5.5.2.2.2.2.3.2" xref="S4.E2.m1.5.5.2.2.2.2.3.2.cmml">e</mi><mo lspace="0em" rspace="0em" id="S4.E2.m1.5.5.2.2.2.2.3.1" xref="S4.E2.m1.5.5.2.2.2.2.3.1.cmml">​</mo><mi id="S4.E2.m1.5.5.2.2.2.2.3.3" xref="S4.E2.m1.5.5.2.2.2.2.3.3.cmml">c</mi></mrow></msub><mo lspace="0em" rspace="0em" id="S4.E2.m1.5.5.2.2.2.1" xref="S4.E2.m1.5.5.2.2.2.1.cmml">​</mo><msub id="S4.E2.m1.5.5.2.2.2.3" xref="S4.E2.m1.5.5.2.2.2.3.cmml"><mi id="S4.E2.m1.5.5.2.2.2.3.2" xref="S4.E2.m1.5.5.2.2.2.3.2.cmml">V</mi><mrow id="S4.E2.m1.5.5.2.2.2.3.3" xref="S4.E2.m1.5.5.2.2.2.3.3.cmml"><mi id="S4.E2.m1.5.5.2.2.2.3.3.2" xref="S4.E2.m1.5.5.2.2.2.3.3.2.cmml">c</mi><mo lspace="0em" rspace="0em" id="S4.E2.m1.5.5.2.2.2.3.3.1" xref="S4.E2.m1.5.5.2.2.2.3.3.1.cmml">​</mo><mi id="S4.E2.m1.5.5.2.2.2.3.3.3" xref="S4.E2.m1.5.5.2.2.2.3.3.3.cmml">a</mi><mo lspace="0em" rspace="0em" id="S4.E2.m1.5.5.2.2.2.3.3.1a" xref="S4.E2.m1.5.5.2.2.2.3.3.1.cmml">​</mo><mi id="S4.E2.m1.5.5.2.2.2.3.3.4" xref="S4.E2.m1.5.5.2.2.2.3.3.4.cmml">p</mi></mrow></msub><mo lspace="0em" rspace="0em" id="S4.E2.m1.5.5.2.2.2.1a" xref="S4.E2.m1.5.5.2.2.2.1.cmml">​</mo><mrow id="S4.E2.m1.5.5.2.2.2.4.2" xref="S4.E2.m1.5.5.2.2.2.cmml"><mo stretchy="false" id="S4.E2.m1.5.5.2.2.2.4.2.1" xref="S4.E2.m1.5.5.2.2.2.cmml">(</mo><mi id="S4.E2.m1.2.2" xref="S4.E2.m1.2.2.cmml">I</mi><mo stretchy="false" id="S4.E2.m1.5.5.2.2.2.4.2.2" xref="S4.E2.m1.5.5.2.2.2.cmml">)</mo></mrow></mrow><mo id="S4.E2.m1.6.6.3.3.6" xref="S4.E2.m1.6.6.3.4.cmml">,</mo><mrow id="S4.E2.m1.6.6.3.3.3" xref="S4.E2.m1.6.6.3.3.3.cmml"><msub id="S4.E2.m1.6.6.3.3.3.2" xref="S4.E2.m1.6.6.3.3.3.2.cmml"><mi id="S4.E2.m1.6.6.3.3.3.2.2" xref="S4.E2.m1.6.6.3.3.3.2.2.cmml">W</mi><mrow id="S4.E2.m1.6.6.3.3.3.2.3" xref="S4.E2.m1.6.6.3.3.3.2.3.cmml"><mi id="S4.E2.m1.6.6.3.3.3.2.3.2" xref="S4.E2.m1.6.6.3.3.3.2.3.2.cmml">e</mi><mo lspace="0em" rspace="0em" id="S4.E2.m1.6.6.3.3.3.2.3.1" xref="S4.E2.m1.6.6.3.3.3.2.3.1.cmml">​</mo><mi id="S4.E2.m1.6.6.3.3.3.2.3.3" xref="S4.E2.m1.6.6.3.3.3.2.3.3.cmml">k</mi></mrow></msub><mo lspace="0em" rspace="0em" id="S4.E2.m1.6.6.3.3.3.1" xref="S4.E2.m1.6.6.3.3.3.1.cmml">​</mo><msub id="S4.E2.m1.6.6.3.3.3.3" xref="S4.E2.m1.6.6.3.3.3.3.cmml"><mi id="S4.E2.m1.6.6.3.3.3.3.2" xref="S4.E2.m1.6.6.3.3.3.3.2.cmml">V</mi><mrow id="S4.E2.m1.6.6.3.3.3.3.3" xref="S4.E2.m1.6.6.3.3.3.3.3.cmml"><mi id="S4.E2.m1.6.6.3.3.3.3.3.2" xref="S4.E2.m1.6.6.3.3.3.3.3.2.cmml">k</mi><mo lspace="0em" rspace="0em" id="S4.E2.m1.6.6.3.3.3.3.3.1" xref="S4.E2.m1.6.6.3.3.3.3.3.1.cmml">​</mo><mi id="S4.E2.m1.6.6.3.3.3.3.3.3" xref="S4.E2.m1.6.6.3.3.3.3.3.3.cmml">n</mi><mo lspace="0em" rspace="0em" id="S4.E2.m1.6.6.3.3.3.3.3.1a" xref="S4.E2.m1.6.6.3.3.3.3.3.1.cmml">​</mo><mi id="S4.E2.m1.6.6.3.3.3.3.3.4" xref="S4.E2.m1.6.6.3.3.3.3.3.4.cmml">o</mi><mo lspace="0em" rspace="0em" id="S4.E2.m1.6.6.3.3.3.3.3.1b" xref="S4.E2.m1.6.6.3.3.3.3.3.1.cmml">​</mo><mi id="S4.E2.m1.6.6.3.3.3.3.3.5" xref="S4.E2.m1.6.6.3.3.3.3.3.5.cmml">w</mi></mrow></msub><mo lspace="0em" rspace="0em" id="S4.E2.m1.6.6.3.3.3.1a" xref="S4.E2.m1.6.6.3.3.3.1.cmml">​</mo><mrow id="S4.E2.m1.6.6.3.3.3.4.2" xref="S4.E2.m1.6.6.3.3.3.cmml"><mo stretchy="false" id="S4.E2.m1.6.6.3.3.3.4.2.1" xref="S4.E2.m1.6.6.3.3.3.cmml">(</mo><mi id="S4.E2.m1.3.3" xref="S4.E2.m1.3.3.cmml">I</mi><mo stretchy="false" id="S4.E2.m1.6.6.3.3.3.4.2.2" xref="S4.E2.m1.6.6.3.3.3.cmml">)</mo></mrow></mrow><mo stretchy="false" id="S4.E2.m1.6.6.3.3.7" xref="S4.E2.m1.6.6.3.4.cmml">]</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.E2.m1.6b"><apply id="S4.E2.m1.6.6.cmml" xref="S4.E2.m1.6.6"><eq id="S4.E2.m1.6.6.4.cmml" xref="S4.E2.m1.6.6.4"></eq><apply id="S4.E2.m1.6.6.5.cmml" xref="S4.E2.m1.6.6.5"><csymbol cd="ambiguous" id="S4.E2.m1.6.6.5.1.cmml" xref="S4.E2.m1.6.6.5">subscript</csymbol><ci id="S4.E2.m1.6.6.5.2.cmml" xref="S4.E2.m1.6.6.5.2">𝑥</ci><apply id="S4.E2.m1.6.6.5.3.cmml" xref="S4.E2.m1.6.6.5.3"><times id="S4.E2.m1.6.6.5.3.1.cmml" xref="S4.E2.m1.6.6.5.3.1"></times><ci id="S4.E2.m1.6.6.5.3.2.cmml" xref="S4.E2.m1.6.6.5.3.2">𝑖</ci><ci id="S4.E2.m1.6.6.5.3.3.cmml" xref="S4.E2.m1.6.6.5.3.3">𝑛</ci><ci id="S4.E2.m1.6.6.5.3.4.cmml" xref="S4.E2.m1.6.6.5.3.4">𝑖</ci><ci id="S4.E2.m1.6.6.5.3.5.cmml" xref="S4.E2.m1.6.6.5.3.5">𝑡</ci><ci id="S4.E2.m1.6.6.5.3.6.cmml" xref="S4.E2.m1.6.6.5.3.6">𝑖</ci><ci id="S4.E2.m1.6.6.5.3.7.cmml" xref="S4.E2.m1.6.6.5.3.7">𝑎</ci><ci id="S4.E2.m1.6.6.5.3.8.cmml" xref="S4.E2.m1.6.6.5.3.8">𝑙</ci></apply></apply><list id="S4.E2.m1.6.6.3.4.cmml" xref="S4.E2.m1.6.6.3.3"><apply id="S4.E2.m1.4.4.1.1.1.cmml" xref="S4.E2.m1.4.4.1.1.1"><times id="S4.E2.m1.4.4.1.1.1.1.cmml" xref="S4.E2.m1.4.4.1.1.1.1"></times><apply id="S4.E2.m1.4.4.1.1.1.2.cmml" xref="S4.E2.m1.4.4.1.1.1.2"><csymbol cd="ambiguous" id="S4.E2.m1.4.4.1.1.1.2.1.cmml" xref="S4.E2.m1.4.4.1.1.1.2">subscript</csymbol><ci id="S4.E2.m1.4.4.1.1.1.2.2.cmml" xref="S4.E2.m1.4.4.1.1.1.2.2">𝑊</ci><apply id="S4.E2.m1.4.4.1.1.1.2.3.cmml" xref="S4.E2.m1.4.4.1.1.1.2.3"><times id="S4.E2.m1.4.4.1.1.1.2.3.1.cmml" xref="S4.E2.m1.4.4.1.1.1.2.3.1"></times><ci id="S4.E2.m1.4.4.1.1.1.2.3.2.cmml" xref="S4.E2.m1.4.4.1.1.1.2.3.2">𝑒</ci><ci id="S4.E2.m1.4.4.1.1.1.2.3.3.cmml" xref="S4.E2.m1.4.4.1.1.1.2.3.3">𝑎</ci></apply></apply><apply id="S4.E2.m1.4.4.1.1.1.3.cmml" xref="S4.E2.m1.4.4.1.1.1.3"><csymbol cd="ambiguous" id="S4.E2.m1.4.4.1.1.1.3.1.cmml" xref="S4.E2.m1.4.4.1.1.1.3">subscript</csymbol><ci id="S4.E2.m1.4.4.1.1.1.3.2.cmml" xref="S4.E2.m1.4.4.1.1.1.3.2">𝑉</ci><apply id="S4.E2.m1.4.4.1.1.1.3.3.cmml" xref="S4.E2.m1.4.4.1.1.1.3.3"><times id="S4.E2.m1.4.4.1.1.1.3.3.1.cmml" xref="S4.E2.m1.4.4.1.1.1.3.3.1"></times><ci id="S4.E2.m1.4.4.1.1.1.3.3.2.cmml" xref="S4.E2.m1.4.4.1.1.1.3.3.2">𝑎</ci><ci id="S4.E2.m1.4.4.1.1.1.3.3.3.cmml" xref="S4.E2.m1.4.4.1.1.1.3.3.3">𝑡</ci><ci id="S4.E2.m1.4.4.1.1.1.3.3.4.cmml" xref="S4.E2.m1.4.4.1.1.1.3.3.4">𝑡</ci></apply></apply><ci id="S4.E2.m1.1.1.cmml" xref="S4.E2.m1.1.1">𝐼</ci></apply><apply id="S4.E2.m1.5.5.2.2.2.cmml" xref="S4.E2.m1.5.5.2.2.2"><times id="S4.E2.m1.5.5.2.2.2.1.cmml" xref="S4.E2.m1.5.5.2.2.2.1"></times><apply id="S4.E2.m1.5.5.2.2.2.2.cmml" xref="S4.E2.m1.5.5.2.2.2.2"><csymbol cd="ambiguous" id="S4.E2.m1.5.5.2.2.2.2.1.cmml" xref="S4.E2.m1.5.5.2.2.2.2">subscript</csymbol><ci id="S4.E2.m1.5.5.2.2.2.2.2.cmml" xref="S4.E2.m1.5.5.2.2.2.2.2">𝑊</ci><apply id="S4.E2.m1.5.5.2.2.2.2.3.cmml" xref="S4.E2.m1.5.5.2.2.2.2.3"><times id="S4.E2.m1.5.5.2.2.2.2.3.1.cmml" xref="S4.E2.m1.5.5.2.2.2.2.3.1"></times><ci id="S4.E2.m1.5.5.2.2.2.2.3.2.cmml" xref="S4.E2.m1.5.5.2.2.2.2.3.2">𝑒</ci><ci id="S4.E2.m1.5.5.2.2.2.2.3.3.cmml" xref="S4.E2.m1.5.5.2.2.2.2.3.3">𝑐</ci></apply></apply><apply id="S4.E2.m1.5.5.2.2.2.3.cmml" xref="S4.E2.m1.5.5.2.2.2.3"><csymbol cd="ambiguous" id="S4.E2.m1.5.5.2.2.2.3.1.cmml" xref="S4.E2.m1.5.5.2.2.2.3">subscript</csymbol><ci id="S4.E2.m1.5.5.2.2.2.3.2.cmml" xref="S4.E2.m1.5.5.2.2.2.3.2">𝑉</ci><apply id="S4.E2.m1.5.5.2.2.2.3.3.cmml" xref="S4.E2.m1.5.5.2.2.2.3.3"><times id="S4.E2.m1.5.5.2.2.2.3.3.1.cmml" xref="S4.E2.m1.5.5.2.2.2.3.3.1"></times><ci id="S4.E2.m1.5.5.2.2.2.3.3.2.cmml" xref="S4.E2.m1.5.5.2.2.2.3.3.2">𝑐</ci><ci id="S4.E2.m1.5.5.2.2.2.3.3.3.cmml" xref="S4.E2.m1.5.5.2.2.2.3.3.3">𝑎</ci><ci id="S4.E2.m1.5.5.2.2.2.3.3.4.cmml" xref="S4.E2.m1.5.5.2.2.2.3.3.4">𝑝</ci></apply></apply><ci id="S4.E2.m1.2.2.cmml" xref="S4.E2.m1.2.2">𝐼</ci></apply><apply id="S4.E2.m1.6.6.3.3.3.cmml" xref="S4.E2.m1.6.6.3.3.3"><times id="S4.E2.m1.6.6.3.3.3.1.cmml" xref="S4.E2.m1.6.6.3.3.3.1"></times><apply id="S4.E2.m1.6.6.3.3.3.2.cmml" xref="S4.E2.m1.6.6.3.3.3.2"><csymbol cd="ambiguous" id="S4.E2.m1.6.6.3.3.3.2.1.cmml" xref="S4.E2.m1.6.6.3.3.3.2">subscript</csymbol><ci id="S4.E2.m1.6.6.3.3.3.2.2.cmml" xref="S4.E2.m1.6.6.3.3.3.2.2">𝑊</ci><apply id="S4.E2.m1.6.6.3.3.3.2.3.cmml" xref="S4.E2.m1.6.6.3.3.3.2.3"><times id="S4.E2.m1.6.6.3.3.3.2.3.1.cmml" xref="S4.E2.m1.6.6.3.3.3.2.3.1"></times><ci id="S4.E2.m1.6.6.3.3.3.2.3.2.cmml" xref="S4.E2.m1.6.6.3.3.3.2.3.2">𝑒</ci><ci id="S4.E2.m1.6.6.3.3.3.2.3.3.cmml" xref="S4.E2.m1.6.6.3.3.3.2.3.3">𝑘</ci></apply></apply><apply id="S4.E2.m1.6.6.3.3.3.3.cmml" xref="S4.E2.m1.6.6.3.3.3.3"><csymbol cd="ambiguous" id="S4.E2.m1.6.6.3.3.3.3.1.cmml" xref="S4.E2.m1.6.6.3.3.3.3">subscript</csymbol><ci id="S4.E2.m1.6.6.3.3.3.3.2.cmml" xref="S4.E2.m1.6.6.3.3.3.3.2">𝑉</ci><apply id="S4.E2.m1.6.6.3.3.3.3.3.cmml" xref="S4.E2.m1.6.6.3.3.3.3.3"><times id="S4.E2.m1.6.6.3.3.3.3.3.1.cmml" xref="S4.E2.m1.6.6.3.3.3.3.3.1"></times><ci id="S4.E2.m1.6.6.3.3.3.3.3.2.cmml" xref="S4.E2.m1.6.6.3.3.3.3.3.2">𝑘</ci><ci id="S4.E2.m1.6.6.3.3.3.3.3.3.cmml" xref="S4.E2.m1.6.6.3.3.3.3.3.3">𝑛</ci><ci id="S4.E2.m1.6.6.3.3.3.3.3.4.cmml" xref="S4.E2.m1.6.6.3.3.3.3.3.4">𝑜</ci><ci id="S4.E2.m1.6.6.3.3.3.3.3.5.cmml" xref="S4.E2.m1.6.6.3.3.3.3.3.5">𝑤</ci></apply></apply><ci id="S4.E2.m1.3.3.cmml" xref="S4.E2.m1.3.3">𝐼</ci></apply></list></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.E2.m1.6c">x_{initial}=[W_{ea}{V_{att}}(I),W_{ec}{V_{cap}}(I),W_{ek}{V_{know}}(I)]\vspace{-2pt}</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(2)</span></td>
</tr></tbody>
</table>
<p id="S4.p2.23" class="ltx_p">where <math id="S4.p2.6.m1.1" class="ltx_Math" alttext="W_{ea}" display="inline"><semantics id="S4.p2.6.m1.1a"><msub id="S4.p2.6.m1.1.1" xref="S4.p2.6.m1.1.1.cmml"><mi id="S4.p2.6.m1.1.1.2" xref="S4.p2.6.m1.1.1.2.cmml">W</mi><mrow id="S4.p2.6.m1.1.1.3" xref="S4.p2.6.m1.1.1.3.cmml"><mi id="S4.p2.6.m1.1.1.3.2" xref="S4.p2.6.m1.1.1.3.2.cmml">e</mi><mo lspace="0em" rspace="0em" id="S4.p2.6.m1.1.1.3.1" xref="S4.p2.6.m1.1.1.3.1.cmml">​</mo><mi id="S4.p2.6.m1.1.1.3.3" xref="S4.p2.6.m1.1.1.3.3.cmml">a</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S4.p2.6.m1.1b"><apply id="S4.p2.6.m1.1.1.cmml" xref="S4.p2.6.m1.1.1"><csymbol cd="ambiguous" id="S4.p2.6.m1.1.1.1.cmml" xref="S4.p2.6.m1.1.1">subscript</csymbol><ci id="S4.p2.6.m1.1.1.2.cmml" xref="S4.p2.6.m1.1.1.2">𝑊</ci><apply id="S4.p2.6.m1.1.1.3.cmml" xref="S4.p2.6.m1.1.1.3"><times id="S4.p2.6.m1.1.1.3.1.cmml" xref="S4.p2.6.m1.1.1.3.1"></times><ci id="S4.p2.6.m1.1.1.3.2.cmml" xref="S4.p2.6.m1.1.1.3.2">𝑒</ci><ci id="S4.p2.6.m1.1.1.3.3.cmml" xref="S4.p2.6.m1.1.1.3.3">𝑎</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.p2.6.m1.1c">W_{ea}</annotation></semantics></math>, <math id="S4.p2.7.m2.1" class="ltx_Math" alttext="W_{ec}" display="inline"><semantics id="S4.p2.7.m2.1a"><msub id="S4.p2.7.m2.1.1" xref="S4.p2.7.m2.1.1.cmml"><mi id="S4.p2.7.m2.1.1.2" xref="S4.p2.7.m2.1.1.2.cmml">W</mi><mrow id="S4.p2.7.m2.1.1.3" xref="S4.p2.7.m2.1.1.3.cmml"><mi id="S4.p2.7.m2.1.1.3.2" xref="S4.p2.7.m2.1.1.3.2.cmml">e</mi><mo lspace="0em" rspace="0em" id="S4.p2.7.m2.1.1.3.1" xref="S4.p2.7.m2.1.1.3.1.cmml">​</mo><mi id="S4.p2.7.m2.1.1.3.3" xref="S4.p2.7.m2.1.1.3.3.cmml">c</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S4.p2.7.m2.1b"><apply id="S4.p2.7.m2.1.1.cmml" xref="S4.p2.7.m2.1.1"><csymbol cd="ambiguous" id="S4.p2.7.m2.1.1.1.cmml" xref="S4.p2.7.m2.1.1">subscript</csymbol><ci id="S4.p2.7.m2.1.1.2.cmml" xref="S4.p2.7.m2.1.1.2">𝑊</ci><apply id="S4.p2.7.m2.1.1.3.cmml" xref="S4.p2.7.m2.1.1.3"><times id="S4.p2.7.m2.1.1.3.1.cmml" xref="S4.p2.7.m2.1.1.3.1"></times><ci id="S4.p2.7.m2.1.1.3.2.cmml" xref="S4.p2.7.m2.1.1.3.2">𝑒</ci><ci id="S4.p2.7.m2.1.1.3.3.cmml" xref="S4.p2.7.m2.1.1.3.3">𝑐</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.p2.7.m2.1c">W_{ec}</annotation></semantics></math>, <math id="S4.p2.8.m3.1" class="ltx_Math" alttext="W_{ek}" display="inline"><semantics id="S4.p2.8.m3.1a"><msub id="S4.p2.8.m3.1.1" xref="S4.p2.8.m3.1.1.cmml"><mi id="S4.p2.8.m3.1.1.2" xref="S4.p2.8.m3.1.1.2.cmml">W</mi><mrow id="S4.p2.8.m3.1.1.3" xref="S4.p2.8.m3.1.1.3.cmml"><mi id="S4.p2.8.m3.1.1.3.2" xref="S4.p2.8.m3.1.1.3.2.cmml">e</mi><mo lspace="0em" rspace="0em" id="S4.p2.8.m3.1.1.3.1" xref="S4.p2.8.m3.1.1.3.1.cmml">​</mo><mi id="S4.p2.8.m3.1.1.3.3" xref="S4.p2.8.m3.1.1.3.3.cmml">k</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S4.p2.8.m3.1b"><apply id="S4.p2.8.m3.1.1.cmml" xref="S4.p2.8.m3.1.1"><csymbol cd="ambiguous" id="S4.p2.8.m3.1.1.1.cmml" xref="S4.p2.8.m3.1.1">subscript</csymbol><ci id="S4.p2.8.m3.1.1.2.cmml" xref="S4.p2.8.m3.1.1.2">𝑊</ci><apply id="S4.p2.8.m3.1.1.3.cmml" xref="S4.p2.8.m3.1.1.3"><times id="S4.p2.8.m3.1.1.3.1.cmml" xref="S4.p2.8.m3.1.1.3.1"></times><ci id="S4.p2.8.m3.1.1.3.2.cmml" xref="S4.p2.8.m3.1.1.3.2">𝑒</ci><ci id="S4.p2.8.m3.1.1.3.3.cmml" xref="S4.p2.8.m3.1.1.3.3">𝑘</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.p2.8.m3.1c">W_{ek}</annotation></semantics></math> are learnable embedding weights for the vector representation of attributes, captions and external knowledge, respectively. In practice, all these embedding weights are learned jointly. Given the randomly initialized hidden state, the encoder LSTM feeds forward to produce hidden state <math id="S4.p2.9.m4.1" class="ltx_Math" alttext="h_{0}" display="inline"><semantics id="S4.p2.9.m4.1a"><msub id="S4.p2.9.m4.1.1" xref="S4.p2.9.m4.1.1.cmml"><mi id="S4.p2.9.m4.1.1.2" xref="S4.p2.9.m4.1.1.2.cmml">h</mi><mn id="S4.p2.9.m4.1.1.3" xref="S4.p2.9.m4.1.1.3.cmml">0</mn></msub><annotation-xml encoding="MathML-Content" id="S4.p2.9.m4.1b"><apply id="S4.p2.9.m4.1.1.cmml" xref="S4.p2.9.m4.1.1"><csymbol cd="ambiguous" id="S4.p2.9.m4.1.1.1.cmml" xref="S4.p2.9.m4.1.1">subscript</csymbol><ci id="S4.p2.9.m4.1.1.2.cmml" xref="S4.p2.9.m4.1.1.2">ℎ</ci><cn type="integer" id="S4.p2.9.m4.1.1.3.cmml" xref="S4.p2.9.m4.1.1.3">0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.p2.9.m4.1c">h_{0}</annotation></semantics></math> which encodes all of the input information. From <math id="S4.p2.10.m5.1" class="ltx_Math" alttext="t=1" display="inline"><semantics id="S4.p2.10.m5.1a"><mrow id="S4.p2.10.m5.1.1" xref="S4.p2.10.m5.1.1.cmml"><mi id="S4.p2.10.m5.1.1.2" xref="S4.p2.10.m5.1.1.2.cmml">t</mi><mo id="S4.p2.10.m5.1.1.1" xref="S4.p2.10.m5.1.1.1.cmml">=</mo><mn id="S4.p2.10.m5.1.1.3" xref="S4.p2.10.m5.1.1.3.cmml">1</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.p2.10.m5.1b"><apply id="S4.p2.10.m5.1.1.cmml" xref="S4.p2.10.m5.1.1"><eq id="S4.p2.10.m5.1.1.1.cmml" xref="S4.p2.10.m5.1.1.1"></eq><ci id="S4.p2.10.m5.1.1.2.cmml" xref="S4.p2.10.m5.1.1.2">𝑡</ci><cn type="integer" id="S4.p2.10.m5.1.1.3.cmml" xref="S4.p2.10.m5.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.p2.10.m5.1c">t=1</annotation></semantics></math> to <math id="S4.p2.11.m6.1" class="ltx_Math" alttext="t=n" display="inline"><semantics id="S4.p2.11.m6.1a"><mrow id="S4.p2.11.m6.1.1" xref="S4.p2.11.m6.1.1.cmml"><mi id="S4.p2.11.m6.1.1.2" xref="S4.p2.11.m6.1.1.2.cmml">t</mi><mo id="S4.p2.11.m6.1.1.1" xref="S4.p2.11.m6.1.1.1.cmml">=</mo><mi id="S4.p2.11.m6.1.1.3" xref="S4.p2.11.m6.1.1.3.cmml">n</mi></mrow><annotation-xml encoding="MathML-Content" id="S4.p2.11.m6.1b"><apply id="S4.p2.11.m6.1.1.cmml" xref="S4.p2.11.m6.1.1"><eq id="S4.p2.11.m6.1.1.1.cmml" xref="S4.p2.11.m6.1.1.1"></eq><ci id="S4.p2.11.m6.1.1.2.cmml" xref="S4.p2.11.m6.1.1.2">𝑡</ci><ci id="S4.p2.11.m6.1.1.3.cmml" xref="S4.p2.11.m6.1.1.3">𝑛</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.p2.11.m6.1c">t=n</annotation></semantics></math>, we set <math id="S4.p2.12.m7.1" class="ltx_Math" alttext="x_{t}=W_{es}q_{t}" display="inline"><semantics id="S4.p2.12.m7.1a"><mrow id="S4.p2.12.m7.1.1" xref="S4.p2.12.m7.1.1.cmml"><msub id="S4.p2.12.m7.1.1.2" xref="S4.p2.12.m7.1.1.2.cmml"><mi id="S4.p2.12.m7.1.1.2.2" xref="S4.p2.12.m7.1.1.2.2.cmml">x</mi><mi id="S4.p2.12.m7.1.1.2.3" xref="S4.p2.12.m7.1.1.2.3.cmml">t</mi></msub><mo id="S4.p2.12.m7.1.1.1" xref="S4.p2.12.m7.1.1.1.cmml">=</mo><mrow id="S4.p2.12.m7.1.1.3" xref="S4.p2.12.m7.1.1.3.cmml"><msub id="S4.p2.12.m7.1.1.3.2" xref="S4.p2.12.m7.1.1.3.2.cmml"><mi id="S4.p2.12.m7.1.1.3.2.2" xref="S4.p2.12.m7.1.1.3.2.2.cmml">W</mi><mrow id="S4.p2.12.m7.1.1.3.2.3" xref="S4.p2.12.m7.1.1.3.2.3.cmml"><mi id="S4.p2.12.m7.1.1.3.2.3.2" xref="S4.p2.12.m7.1.1.3.2.3.2.cmml">e</mi><mo lspace="0em" rspace="0em" id="S4.p2.12.m7.1.1.3.2.3.1" xref="S4.p2.12.m7.1.1.3.2.3.1.cmml">​</mo><mi id="S4.p2.12.m7.1.1.3.2.3.3" xref="S4.p2.12.m7.1.1.3.2.3.3.cmml">s</mi></mrow></msub><mo lspace="0em" rspace="0em" id="S4.p2.12.m7.1.1.3.1" xref="S4.p2.12.m7.1.1.3.1.cmml">​</mo><msub id="S4.p2.12.m7.1.1.3.3" xref="S4.p2.12.m7.1.1.3.3.cmml"><mi id="S4.p2.12.m7.1.1.3.3.2" xref="S4.p2.12.m7.1.1.3.3.2.cmml">q</mi><mi id="S4.p2.12.m7.1.1.3.3.3" xref="S4.p2.12.m7.1.1.3.3.3.cmml">t</mi></msub></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.p2.12.m7.1b"><apply id="S4.p2.12.m7.1.1.cmml" xref="S4.p2.12.m7.1.1"><eq id="S4.p2.12.m7.1.1.1.cmml" xref="S4.p2.12.m7.1.1.1"></eq><apply id="S4.p2.12.m7.1.1.2.cmml" xref="S4.p2.12.m7.1.1.2"><csymbol cd="ambiguous" id="S4.p2.12.m7.1.1.2.1.cmml" xref="S4.p2.12.m7.1.1.2">subscript</csymbol><ci id="S4.p2.12.m7.1.1.2.2.cmml" xref="S4.p2.12.m7.1.1.2.2">𝑥</ci><ci id="S4.p2.12.m7.1.1.2.3.cmml" xref="S4.p2.12.m7.1.1.2.3">𝑡</ci></apply><apply id="S4.p2.12.m7.1.1.3.cmml" xref="S4.p2.12.m7.1.1.3"><times id="S4.p2.12.m7.1.1.3.1.cmml" xref="S4.p2.12.m7.1.1.3.1"></times><apply id="S4.p2.12.m7.1.1.3.2.cmml" xref="S4.p2.12.m7.1.1.3.2"><csymbol cd="ambiguous" id="S4.p2.12.m7.1.1.3.2.1.cmml" xref="S4.p2.12.m7.1.1.3.2">subscript</csymbol><ci id="S4.p2.12.m7.1.1.3.2.2.cmml" xref="S4.p2.12.m7.1.1.3.2.2">𝑊</ci><apply id="S4.p2.12.m7.1.1.3.2.3.cmml" xref="S4.p2.12.m7.1.1.3.2.3"><times id="S4.p2.12.m7.1.1.3.2.3.1.cmml" xref="S4.p2.12.m7.1.1.3.2.3.1"></times><ci id="S4.p2.12.m7.1.1.3.2.3.2.cmml" xref="S4.p2.12.m7.1.1.3.2.3.2">𝑒</ci><ci id="S4.p2.12.m7.1.1.3.2.3.3.cmml" xref="S4.p2.12.m7.1.1.3.2.3.3">𝑠</ci></apply></apply><apply id="S4.p2.12.m7.1.1.3.3.cmml" xref="S4.p2.12.m7.1.1.3.3"><csymbol cd="ambiguous" id="S4.p2.12.m7.1.1.3.3.1.cmml" xref="S4.p2.12.m7.1.1.3.3">subscript</csymbol><ci id="S4.p2.12.m7.1.1.3.3.2.cmml" xref="S4.p2.12.m7.1.1.3.3.2">𝑞</ci><ci id="S4.p2.12.m7.1.1.3.3.3.cmml" xref="S4.p2.12.m7.1.1.3.3.3">𝑡</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.p2.12.m7.1c">x_{t}=W_{es}q_{t}</annotation></semantics></math> and the hidden state <math id="S4.p2.13.m8.1" class="ltx_Math" alttext="h_{t-1}" display="inline"><semantics id="S4.p2.13.m8.1a"><msub id="S4.p2.13.m8.1.1" xref="S4.p2.13.m8.1.1.cmml"><mi id="S4.p2.13.m8.1.1.2" xref="S4.p2.13.m8.1.1.2.cmml">h</mi><mrow id="S4.p2.13.m8.1.1.3" xref="S4.p2.13.m8.1.1.3.cmml"><mi id="S4.p2.13.m8.1.1.3.2" xref="S4.p2.13.m8.1.1.3.2.cmml">t</mi><mo id="S4.p2.13.m8.1.1.3.1" xref="S4.p2.13.m8.1.1.3.1.cmml">−</mo><mn id="S4.p2.13.m8.1.1.3.3" xref="S4.p2.13.m8.1.1.3.3.cmml">1</mn></mrow></msub><annotation-xml encoding="MathML-Content" id="S4.p2.13.m8.1b"><apply id="S4.p2.13.m8.1.1.cmml" xref="S4.p2.13.m8.1.1"><csymbol cd="ambiguous" id="S4.p2.13.m8.1.1.1.cmml" xref="S4.p2.13.m8.1.1">subscript</csymbol><ci id="S4.p2.13.m8.1.1.2.cmml" xref="S4.p2.13.m8.1.1.2">ℎ</ci><apply id="S4.p2.13.m8.1.1.3.cmml" xref="S4.p2.13.m8.1.1.3"><minus id="S4.p2.13.m8.1.1.3.1.cmml" xref="S4.p2.13.m8.1.1.3.1"></minus><ci id="S4.p2.13.m8.1.1.3.2.cmml" xref="S4.p2.13.m8.1.1.3.2">𝑡</ci><cn type="integer" id="S4.p2.13.m8.1.1.3.3.cmml" xref="S4.p2.13.m8.1.1.3.3">1</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.p2.13.m8.1c">h_{t-1}</annotation></semantics></math> is given by the previous step, where <math id="S4.p2.14.m9.1" class="ltx_Math" alttext="W_{es}" display="inline"><semantics id="S4.p2.14.m9.1a"><msub id="S4.p2.14.m9.1.1" xref="S4.p2.14.m9.1.1.cmml"><mi id="S4.p2.14.m9.1.1.2" xref="S4.p2.14.m9.1.1.2.cmml">W</mi><mrow id="S4.p2.14.m9.1.1.3" xref="S4.p2.14.m9.1.1.3.cmml"><mi id="S4.p2.14.m9.1.1.3.2" xref="S4.p2.14.m9.1.1.3.2.cmml">e</mi><mo lspace="0em" rspace="0em" id="S4.p2.14.m9.1.1.3.1" xref="S4.p2.14.m9.1.1.3.1.cmml">​</mo><mi id="S4.p2.14.m9.1.1.3.3" xref="S4.p2.14.m9.1.1.3.3.cmml">s</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S4.p2.14.m9.1b"><apply id="S4.p2.14.m9.1.1.cmml" xref="S4.p2.14.m9.1.1"><csymbol cd="ambiguous" id="S4.p2.14.m9.1.1.1.cmml" xref="S4.p2.14.m9.1.1">subscript</csymbol><ci id="S4.p2.14.m9.1.1.2.cmml" xref="S4.p2.14.m9.1.1.2">𝑊</ci><apply id="S4.p2.14.m9.1.1.3.cmml" xref="S4.p2.14.m9.1.1.3"><times id="S4.p2.14.m9.1.1.3.1.cmml" xref="S4.p2.14.m9.1.1.3.1"></times><ci id="S4.p2.14.m9.1.1.3.2.cmml" xref="S4.p2.14.m9.1.1.3.2">𝑒</ci><ci id="S4.p2.14.m9.1.1.3.3.cmml" xref="S4.p2.14.m9.1.1.3.3">𝑠</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.p2.14.m9.1c">W_{es}</annotation></semantics></math> is the learnable word embedding weights. The decoder LSTM runs from time step <math id="S4.p2.15.m10.1" class="ltx_Math" alttext="n+1" display="inline"><semantics id="S4.p2.15.m10.1a"><mrow id="S4.p2.15.m10.1.1" xref="S4.p2.15.m10.1.1.cmml"><mi id="S4.p2.15.m10.1.1.2" xref="S4.p2.15.m10.1.1.2.cmml">n</mi><mo id="S4.p2.15.m10.1.1.1" xref="S4.p2.15.m10.1.1.1.cmml">+</mo><mn id="S4.p2.15.m10.1.1.3" xref="S4.p2.15.m10.1.1.3.cmml">1</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.p2.15.m10.1b"><apply id="S4.p2.15.m10.1.1.cmml" xref="S4.p2.15.m10.1.1"><plus id="S4.p2.15.m10.1.1.1.cmml" xref="S4.p2.15.m10.1.1.1"></plus><ci id="S4.p2.15.m10.1.1.2.cmml" xref="S4.p2.15.m10.1.1.2">𝑛</ci><cn type="integer" id="S4.p2.15.m10.1.1.3.cmml" xref="S4.p2.15.m10.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.p2.15.m10.1c">n+1</annotation></semantics></math> to <math id="S4.p2.16.m11.1" class="ltx_Math" alttext="l+1" display="inline"><semantics id="S4.p2.16.m11.1a"><mrow id="S4.p2.16.m11.1.1" xref="S4.p2.16.m11.1.1.cmml"><mi id="S4.p2.16.m11.1.1.2" xref="S4.p2.16.m11.1.1.2.cmml">l</mi><mo id="S4.p2.16.m11.1.1.1" xref="S4.p2.16.m11.1.1.1.cmml">+</mo><mn id="S4.p2.16.m11.1.1.3" xref="S4.p2.16.m11.1.1.3.cmml">1</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.p2.16.m11.1b"><apply id="S4.p2.16.m11.1.1.cmml" xref="S4.p2.16.m11.1.1"><plus id="S4.p2.16.m11.1.1.1.cmml" xref="S4.p2.16.m11.1.1.1"></plus><ci id="S4.p2.16.m11.1.1.2.cmml" xref="S4.p2.16.m11.1.1.2">𝑙</ci><cn type="integer" id="S4.p2.16.m11.1.1.3.cmml" xref="S4.p2.16.m11.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.p2.16.m11.1c">l+1</annotation></semantics></math>. Specifically, at time step <math id="S4.p2.17.m12.1" class="ltx_Math" alttext="t=n+1" display="inline"><semantics id="S4.p2.17.m12.1a"><mrow id="S4.p2.17.m12.1.1" xref="S4.p2.17.m12.1.1.cmml"><mi id="S4.p2.17.m12.1.1.2" xref="S4.p2.17.m12.1.1.2.cmml">t</mi><mo id="S4.p2.17.m12.1.1.1" xref="S4.p2.17.m12.1.1.1.cmml">=</mo><mrow id="S4.p2.17.m12.1.1.3" xref="S4.p2.17.m12.1.1.3.cmml"><mi id="S4.p2.17.m12.1.1.3.2" xref="S4.p2.17.m12.1.1.3.2.cmml">n</mi><mo id="S4.p2.17.m12.1.1.3.1" xref="S4.p2.17.m12.1.1.3.1.cmml">+</mo><mn id="S4.p2.17.m12.1.1.3.3" xref="S4.p2.17.m12.1.1.3.3.cmml">1</mn></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.p2.17.m12.1b"><apply id="S4.p2.17.m12.1.1.cmml" xref="S4.p2.17.m12.1.1"><eq id="S4.p2.17.m12.1.1.1.cmml" xref="S4.p2.17.m12.1.1.1"></eq><ci id="S4.p2.17.m12.1.1.2.cmml" xref="S4.p2.17.m12.1.1.2">𝑡</ci><apply id="S4.p2.17.m12.1.1.3.cmml" xref="S4.p2.17.m12.1.1.3"><plus id="S4.p2.17.m12.1.1.3.1.cmml" xref="S4.p2.17.m12.1.1.3.1"></plus><ci id="S4.p2.17.m12.1.1.3.2.cmml" xref="S4.p2.17.m12.1.1.3.2">𝑛</ci><cn type="integer" id="S4.p2.17.m12.1.1.3.3.cmml" xref="S4.p2.17.m12.1.1.3.3">1</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.p2.17.m12.1c">t=n+1</annotation></semantics></math>, the LSTM layer takes the input <math id="S4.p2.18.m13.1" class="ltx_Math" alttext="x_{n+1}=W_{es}a_{1}" display="inline"><semantics id="S4.p2.18.m13.1a"><mrow id="S4.p2.18.m13.1.1" xref="S4.p2.18.m13.1.1.cmml"><msub id="S4.p2.18.m13.1.1.2" xref="S4.p2.18.m13.1.1.2.cmml"><mi id="S4.p2.18.m13.1.1.2.2" xref="S4.p2.18.m13.1.1.2.2.cmml">x</mi><mrow id="S4.p2.18.m13.1.1.2.3" xref="S4.p2.18.m13.1.1.2.3.cmml"><mi id="S4.p2.18.m13.1.1.2.3.2" xref="S4.p2.18.m13.1.1.2.3.2.cmml">n</mi><mo id="S4.p2.18.m13.1.1.2.3.1" xref="S4.p2.18.m13.1.1.2.3.1.cmml">+</mo><mn id="S4.p2.18.m13.1.1.2.3.3" xref="S4.p2.18.m13.1.1.2.3.3.cmml">1</mn></mrow></msub><mo id="S4.p2.18.m13.1.1.1" xref="S4.p2.18.m13.1.1.1.cmml">=</mo><mrow id="S4.p2.18.m13.1.1.3" xref="S4.p2.18.m13.1.1.3.cmml"><msub id="S4.p2.18.m13.1.1.3.2" xref="S4.p2.18.m13.1.1.3.2.cmml"><mi id="S4.p2.18.m13.1.1.3.2.2" xref="S4.p2.18.m13.1.1.3.2.2.cmml">W</mi><mrow id="S4.p2.18.m13.1.1.3.2.3" xref="S4.p2.18.m13.1.1.3.2.3.cmml"><mi id="S4.p2.18.m13.1.1.3.2.3.2" xref="S4.p2.18.m13.1.1.3.2.3.2.cmml">e</mi><mo lspace="0em" rspace="0em" id="S4.p2.18.m13.1.1.3.2.3.1" xref="S4.p2.18.m13.1.1.3.2.3.1.cmml">​</mo><mi id="S4.p2.18.m13.1.1.3.2.3.3" xref="S4.p2.18.m13.1.1.3.2.3.3.cmml">s</mi></mrow></msub><mo lspace="0em" rspace="0em" id="S4.p2.18.m13.1.1.3.1" xref="S4.p2.18.m13.1.1.3.1.cmml">​</mo><msub id="S4.p2.18.m13.1.1.3.3" xref="S4.p2.18.m13.1.1.3.3.cmml"><mi id="S4.p2.18.m13.1.1.3.3.2" xref="S4.p2.18.m13.1.1.3.3.2.cmml">a</mi><mn id="S4.p2.18.m13.1.1.3.3.3" xref="S4.p2.18.m13.1.1.3.3.3.cmml">1</mn></msub></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.p2.18.m13.1b"><apply id="S4.p2.18.m13.1.1.cmml" xref="S4.p2.18.m13.1.1"><eq id="S4.p2.18.m13.1.1.1.cmml" xref="S4.p2.18.m13.1.1.1"></eq><apply id="S4.p2.18.m13.1.1.2.cmml" xref="S4.p2.18.m13.1.1.2"><csymbol cd="ambiguous" id="S4.p2.18.m13.1.1.2.1.cmml" xref="S4.p2.18.m13.1.1.2">subscript</csymbol><ci id="S4.p2.18.m13.1.1.2.2.cmml" xref="S4.p2.18.m13.1.1.2.2">𝑥</ci><apply id="S4.p2.18.m13.1.1.2.3.cmml" xref="S4.p2.18.m13.1.1.2.3"><plus id="S4.p2.18.m13.1.1.2.3.1.cmml" xref="S4.p2.18.m13.1.1.2.3.1"></plus><ci id="S4.p2.18.m13.1.1.2.3.2.cmml" xref="S4.p2.18.m13.1.1.2.3.2">𝑛</ci><cn type="integer" id="S4.p2.18.m13.1.1.2.3.3.cmml" xref="S4.p2.18.m13.1.1.2.3.3">1</cn></apply></apply><apply id="S4.p2.18.m13.1.1.3.cmml" xref="S4.p2.18.m13.1.1.3"><times id="S4.p2.18.m13.1.1.3.1.cmml" xref="S4.p2.18.m13.1.1.3.1"></times><apply id="S4.p2.18.m13.1.1.3.2.cmml" xref="S4.p2.18.m13.1.1.3.2"><csymbol cd="ambiguous" id="S4.p2.18.m13.1.1.3.2.1.cmml" xref="S4.p2.18.m13.1.1.3.2">subscript</csymbol><ci id="S4.p2.18.m13.1.1.3.2.2.cmml" xref="S4.p2.18.m13.1.1.3.2.2">𝑊</ci><apply id="S4.p2.18.m13.1.1.3.2.3.cmml" xref="S4.p2.18.m13.1.1.3.2.3"><times id="S4.p2.18.m13.1.1.3.2.3.1.cmml" xref="S4.p2.18.m13.1.1.3.2.3.1"></times><ci id="S4.p2.18.m13.1.1.3.2.3.2.cmml" xref="S4.p2.18.m13.1.1.3.2.3.2">𝑒</ci><ci id="S4.p2.18.m13.1.1.3.2.3.3.cmml" xref="S4.p2.18.m13.1.1.3.2.3.3">𝑠</ci></apply></apply><apply id="S4.p2.18.m13.1.1.3.3.cmml" xref="S4.p2.18.m13.1.1.3.3"><csymbol cd="ambiguous" id="S4.p2.18.m13.1.1.3.3.1.cmml" xref="S4.p2.18.m13.1.1.3.3">subscript</csymbol><ci id="S4.p2.18.m13.1.1.3.3.2.cmml" xref="S4.p2.18.m13.1.1.3.3.2">𝑎</ci><cn type="integer" id="S4.p2.18.m13.1.1.3.3.3.cmml" xref="S4.p2.18.m13.1.1.3.3.3">1</cn></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.p2.18.m13.1c">x_{n+1}=W_{es}a_{1}</annotation></semantics></math> and the hidden state <math id="S4.p2.19.m14.1" class="ltx_Math" alttext="h_{n}" display="inline"><semantics id="S4.p2.19.m14.1a"><msub id="S4.p2.19.m14.1.1" xref="S4.p2.19.m14.1.1.cmml"><mi id="S4.p2.19.m14.1.1.2" xref="S4.p2.19.m14.1.1.2.cmml">h</mi><mi id="S4.p2.19.m14.1.1.3" xref="S4.p2.19.m14.1.1.3.cmml">n</mi></msub><annotation-xml encoding="MathML-Content" id="S4.p2.19.m14.1b"><apply id="S4.p2.19.m14.1.1.cmml" xref="S4.p2.19.m14.1.1"><csymbol cd="ambiguous" id="S4.p2.19.m14.1.1.1.cmml" xref="S4.p2.19.m14.1.1">subscript</csymbol><ci id="S4.p2.19.m14.1.1.2.cmml" xref="S4.p2.19.m14.1.1.2">ℎ</ci><ci id="S4.p2.19.m14.1.1.3.cmml" xref="S4.p2.19.m14.1.1.3">𝑛</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.p2.19.m14.1c">h_{n}</annotation></semantics></math> corresponding to the last word of the question, where <math id="S4.p2.20.m15.1" class="ltx_Math" alttext="a_{1}" display="inline"><semantics id="S4.p2.20.m15.1a"><msub id="S4.p2.20.m15.1.1" xref="S4.p2.20.m15.1.1.cmml"><mi id="S4.p2.20.m15.1.1.2" xref="S4.p2.20.m15.1.1.2.cmml">a</mi><mn id="S4.p2.20.m15.1.1.3" xref="S4.p2.20.m15.1.1.3.cmml">1</mn></msub><annotation-xml encoding="MathML-Content" id="S4.p2.20.m15.1b"><apply id="S4.p2.20.m15.1.1.cmml" xref="S4.p2.20.m15.1.1"><csymbol cd="ambiguous" id="S4.p2.20.m15.1.1.1.cmml" xref="S4.p2.20.m15.1.1">subscript</csymbol><ci id="S4.p2.20.m15.1.1.2.cmml" xref="S4.p2.20.m15.1.1.2">𝑎</ci><cn type="integer" id="S4.p2.20.m15.1.1.3.cmml" xref="S4.p2.20.m15.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.p2.20.m15.1c">a_{1}</annotation></semantics></math> is the start word of the answer. The hidden state <math id="S4.p2.21.m16.1" class="ltx_Math" alttext="h_{n}" display="inline"><semantics id="S4.p2.21.m16.1a"><msub id="S4.p2.21.m16.1.1" xref="S4.p2.21.m16.1.1.cmml"><mi id="S4.p2.21.m16.1.1.2" xref="S4.p2.21.m16.1.1.2.cmml">h</mi><mi id="S4.p2.21.m16.1.1.3" xref="S4.p2.21.m16.1.1.3.cmml">n</mi></msub><annotation-xml encoding="MathML-Content" id="S4.p2.21.m16.1b"><apply id="S4.p2.21.m16.1.1.cmml" xref="S4.p2.21.m16.1.1"><csymbol cd="ambiguous" id="S4.p2.21.m16.1.1.1.cmml" xref="S4.p2.21.m16.1.1">subscript</csymbol><ci id="S4.p2.21.m16.1.1.2.cmml" xref="S4.p2.21.m16.1.1.2">ℎ</ci><ci id="S4.p2.21.m16.1.1.3.cmml" xref="S4.p2.21.m16.1.1.3">𝑛</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.p2.21.m16.1c">h_{n}</annotation></semantics></math> thus encodes all available information about the image and the question. The probability distribution <math id="S4.p2.22.m17.1" class="ltx_Math" alttext="p_{t+1}" display="inline"><semantics id="S4.p2.22.m17.1a"><msub id="S4.p2.22.m17.1.1" xref="S4.p2.22.m17.1.1.cmml"><mi id="S4.p2.22.m17.1.1.2" xref="S4.p2.22.m17.1.1.2.cmml">p</mi><mrow id="S4.p2.22.m17.1.1.3" xref="S4.p2.22.m17.1.1.3.cmml"><mi id="S4.p2.22.m17.1.1.3.2" xref="S4.p2.22.m17.1.1.3.2.cmml">t</mi><mo id="S4.p2.22.m17.1.1.3.1" xref="S4.p2.22.m17.1.1.3.1.cmml">+</mo><mn id="S4.p2.22.m17.1.1.3.3" xref="S4.p2.22.m17.1.1.3.3.cmml">1</mn></mrow></msub><annotation-xml encoding="MathML-Content" id="S4.p2.22.m17.1b"><apply id="S4.p2.22.m17.1.1.cmml" xref="S4.p2.22.m17.1.1"><csymbol cd="ambiguous" id="S4.p2.22.m17.1.1.1.cmml" xref="S4.p2.22.m17.1.1">subscript</csymbol><ci id="S4.p2.22.m17.1.1.2.cmml" xref="S4.p2.22.m17.1.1.2">𝑝</ci><apply id="S4.p2.22.m17.1.1.3.cmml" xref="S4.p2.22.m17.1.1.3"><plus id="S4.p2.22.m17.1.1.3.1.cmml" xref="S4.p2.22.m17.1.1.3.1"></plus><ci id="S4.p2.22.m17.1.1.3.2.cmml" xref="S4.p2.22.m17.1.1.3.2">𝑡</ci><cn type="integer" id="S4.p2.22.m17.1.1.3.3.cmml" xref="S4.p2.22.m17.1.1.3.3">1</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.p2.22.m17.1c">p_{t+1}</annotation></semantics></math> over all answer words in the vocabulary is then computed by the LSTM feed-forward process. Finally, for the final step, when <math id="S4.p2.23.m18.1" class="ltx_Math" alttext="a_{l+1}" display="inline"><semantics id="S4.p2.23.m18.1a"><msub id="S4.p2.23.m18.1.1" xref="S4.p2.23.m18.1.1.cmml"><mi id="S4.p2.23.m18.1.1.2" xref="S4.p2.23.m18.1.1.2.cmml">a</mi><mrow id="S4.p2.23.m18.1.1.3" xref="S4.p2.23.m18.1.1.3.cmml"><mi id="S4.p2.23.m18.1.1.3.2" xref="S4.p2.23.m18.1.1.3.2.cmml">l</mi><mo id="S4.p2.23.m18.1.1.3.1" xref="S4.p2.23.m18.1.1.3.1.cmml">+</mo><mn id="S4.p2.23.m18.1.1.3.3" xref="S4.p2.23.m18.1.1.3.3.cmml">1</mn></mrow></msub><annotation-xml encoding="MathML-Content" id="S4.p2.23.m18.1b"><apply id="S4.p2.23.m18.1.1.cmml" xref="S4.p2.23.m18.1.1"><csymbol cd="ambiguous" id="S4.p2.23.m18.1.1.1.cmml" xref="S4.p2.23.m18.1.1">subscript</csymbol><ci id="S4.p2.23.m18.1.1.2.cmml" xref="S4.p2.23.m18.1.1.2">𝑎</ci><apply id="S4.p2.23.m18.1.1.3.cmml" xref="S4.p2.23.m18.1.1.3"><plus id="S4.p2.23.m18.1.1.3.1.cmml" xref="S4.p2.23.m18.1.1.3.1"></plus><ci id="S4.p2.23.m18.1.1.3.2.cmml" xref="S4.p2.23.m18.1.1.3.2">𝑙</ci><cn type="integer" id="S4.p2.23.m18.1.1.3.3.cmml" xref="S4.p2.23.m18.1.1.3.3">1</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.p2.23.m18.1c">a_{l+1}</annotation></semantics></math> represents the last word of the answer, the target label is set to the END token.</p>
</div>
<div id="S4.p3" class="ltx_para">
<p id="S4.p3.4" class="ltx_p">Our training objective is to learn parameters <math id="S4.p3.1.m1.1" class="ltx_Math" alttext="W_{ea}" display="inline"><semantics id="S4.p3.1.m1.1a"><msub id="S4.p3.1.m1.1.1" xref="S4.p3.1.m1.1.1.cmml"><mi id="S4.p3.1.m1.1.1.2" xref="S4.p3.1.m1.1.1.2.cmml">W</mi><mrow id="S4.p3.1.m1.1.1.3" xref="S4.p3.1.m1.1.1.3.cmml"><mi id="S4.p3.1.m1.1.1.3.2" xref="S4.p3.1.m1.1.1.3.2.cmml">e</mi><mo lspace="0em" rspace="0em" id="S4.p3.1.m1.1.1.3.1" xref="S4.p3.1.m1.1.1.3.1.cmml">​</mo><mi id="S4.p3.1.m1.1.1.3.3" xref="S4.p3.1.m1.1.1.3.3.cmml">a</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S4.p3.1.m1.1b"><apply id="S4.p3.1.m1.1.1.cmml" xref="S4.p3.1.m1.1.1"><csymbol cd="ambiguous" id="S4.p3.1.m1.1.1.1.cmml" xref="S4.p3.1.m1.1.1">subscript</csymbol><ci id="S4.p3.1.m1.1.1.2.cmml" xref="S4.p3.1.m1.1.1.2">𝑊</ci><apply id="S4.p3.1.m1.1.1.3.cmml" xref="S4.p3.1.m1.1.1.3"><times id="S4.p3.1.m1.1.1.3.1.cmml" xref="S4.p3.1.m1.1.1.3.1"></times><ci id="S4.p3.1.m1.1.1.3.2.cmml" xref="S4.p3.1.m1.1.1.3.2">𝑒</ci><ci id="S4.p3.1.m1.1.1.3.3.cmml" xref="S4.p3.1.m1.1.1.3.3">𝑎</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.p3.1.m1.1c">W_{ea}</annotation></semantics></math>, <math id="S4.p3.2.m2.1" class="ltx_Math" alttext="W_{ec}" display="inline"><semantics id="S4.p3.2.m2.1a"><msub id="S4.p3.2.m2.1.1" xref="S4.p3.2.m2.1.1.cmml"><mi id="S4.p3.2.m2.1.1.2" xref="S4.p3.2.m2.1.1.2.cmml">W</mi><mrow id="S4.p3.2.m2.1.1.3" xref="S4.p3.2.m2.1.1.3.cmml"><mi id="S4.p3.2.m2.1.1.3.2" xref="S4.p3.2.m2.1.1.3.2.cmml">e</mi><mo lspace="0em" rspace="0em" id="S4.p3.2.m2.1.1.3.1" xref="S4.p3.2.m2.1.1.3.1.cmml">​</mo><mi id="S4.p3.2.m2.1.1.3.3" xref="S4.p3.2.m2.1.1.3.3.cmml">c</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S4.p3.2.m2.1b"><apply id="S4.p3.2.m2.1.1.cmml" xref="S4.p3.2.m2.1.1"><csymbol cd="ambiguous" id="S4.p3.2.m2.1.1.1.cmml" xref="S4.p3.2.m2.1.1">subscript</csymbol><ci id="S4.p3.2.m2.1.1.2.cmml" xref="S4.p3.2.m2.1.1.2">𝑊</ci><apply id="S4.p3.2.m2.1.1.3.cmml" xref="S4.p3.2.m2.1.1.3"><times id="S4.p3.2.m2.1.1.3.1.cmml" xref="S4.p3.2.m2.1.1.3.1"></times><ci id="S4.p3.2.m2.1.1.3.2.cmml" xref="S4.p3.2.m2.1.1.3.2">𝑒</ci><ci id="S4.p3.2.m2.1.1.3.3.cmml" xref="S4.p3.2.m2.1.1.3.3">𝑐</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.p3.2.m2.1c">W_{ec}</annotation></semantics></math>, <math id="S4.p3.3.m3.1" class="ltx_Math" alttext="W_{ek}" display="inline"><semantics id="S4.p3.3.m3.1a"><msub id="S4.p3.3.m3.1.1" xref="S4.p3.3.m3.1.1.cmml"><mi id="S4.p3.3.m3.1.1.2" xref="S4.p3.3.m3.1.1.2.cmml">W</mi><mrow id="S4.p3.3.m3.1.1.3" xref="S4.p3.3.m3.1.1.3.cmml"><mi id="S4.p3.3.m3.1.1.3.2" xref="S4.p3.3.m3.1.1.3.2.cmml">e</mi><mo lspace="0em" rspace="0em" id="S4.p3.3.m3.1.1.3.1" xref="S4.p3.3.m3.1.1.3.1.cmml">​</mo><mi id="S4.p3.3.m3.1.1.3.3" xref="S4.p3.3.m3.1.1.3.3.cmml">k</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S4.p3.3.m3.1b"><apply id="S4.p3.3.m3.1.1.cmml" xref="S4.p3.3.m3.1.1"><csymbol cd="ambiguous" id="S4.p3.3.m3.1.1.1.cmml" xref="S4.p3.3.m3.1.1">subscript</csymbol><ci id="S4.p3.3.m3.1.1.2.cmml" xref="S4.p3.3.m3.1.1.2">𝑊</ci><apply id="S4.p3.3.m3.1.1.3.cmml" xref="S4.p3.3.m3.1.1.3"><times id="S4.p3.3.m3.1.1.3.1.cmml" xref="S4.p3.3.m3.1.1.3.1"></times><ci id="S4.p3.3.m3.1.1.3.2.cmml" xref="S4.p3.3.m3.1.1.3.2">𝑒</ci><ci id="S4.p3.3.m3.1.1.3.3.cmml" xref="S4.p3.3.m3.1.1.3.3">𝑘</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.p3.3.m3.1c">W_{ek}</annotation></semantics></math>, <math id="S4.p3.4.m4.1" class="ltx_Math" alttext="W_{es}" display="inline"><semantics id="S4.p3.4.m4.1a"><msub id="S4.p3.4.m4.1.1" xref="S4.p3.4.m4.1.1.cmml"><mi id="S4.p3.4.m4.1.1.2" xref="S4.p3.4.m4.1.1.2.cmml">W</mi><mrow id="S4.p3.4.m4.1.1.3" xref="S4.p3.4.m4.1.1.3.cmml"><mi id="S4.p3.4.m4.1.1.3.2" xref="S4.p3.4.m4.1.1.3.2.cmml">e</mi><mo lspace="0em" rspace="0em" id="S4.p3.4.m4.1.1.3.1" xref="S4.p3.4.m4.1.1.3.1.cmml">​</mo><mi id="S4.p3.4.m4.1.1.3.3" xref="S4.p3.4.m4.1.1.3.3.cmml">s</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S4.p3.4.m4.1b"><apply id="S4.p3.4.m4.1.1.cmml" xref="S4.p3.4.m4.1.1"><csymbol cd="ambiguous" id="S4.p3.4.m4.1.1.1.cmml" xref="S4.p3.4.m4.1.1">subscript</csymbol><ci id="S4.p3.4.m4.1.1.2.cmml" xref="S4.p3.4.m4.1.1.2">𝑊</ci><apply id="S4.p3.4.m4.1.1.3.cmml" xref="S4.p3.4.m4.1.1.3"><times id="S4.p3.4.m4.1.1.3.1.cmml" xref="S4.p3.4.m4.1.1.3.1"></times><ci id="S4.p3.4.m4.1.1.3.2.cmml" xref="S4.p3.4.m4.1.1.3.2">𝑒</ci><ci id="S4.p3.4.m4.1.1.3.3.cmml" xref="S4.p3.4.m4.1.1.3.3">𝑠</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.p3.4.m4.1c">W_{es}</annotation></semantics></math> and all the parameters in the LSTM by minimizing the following cost function:</p>
<table id="S6.EGx1" class="ltx_equationgroup ltx_eqn_eqnarray ltx_eqn_table">

<tbody id="S4.E3"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math id="S4.E3.m1.1" class="ltx_Math" alttext="\displaystyle\mathcal{C}" display="inline"><semantics id="S4.E3.m1.1a"><mi class="ltx_font_mathcaligraphic" id="S4.E3.m1.1.1" xref="S4.E3.m1.1.1.cmml">𝒞</mi><annotation-xml encoding="MathML-Content" id="S4.E3.m1.1b"><ci id="S4.E3.m1.1.1.cmml" xref="S4.E3.m1.1.1">𝒞</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.E3.m1.1c">\displaystyle\mathcal{C}</annotation></semantics></math></td>
<td class="ltx_td ltx_align_center ltx_eqn_cell"><math id="S4.E3.m2.1" class="ltx_Math" alttext="\displaystyle=" display="inline"><semantics id="S4.E3.m2.1a"><mo id="S4.E3.m2.1.1" xref="S4.E3.m2.1.1.cmml">=</mo><annotation-xml encoding="MathML-Content" id="S4.E3.m2.1b"><eq id="S4.E3.m2.1.1.cmml" xref="S4.E3.m2.1.1"></eq></annotation-xml><annotation encoding="application/x-tex" id="S4.E3.m2.1c">\displaystyle=</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math id="S4.E3.m3.5" class="ltx_Math" alttext="\displaystyle-\frac{1}{N}\sum_{i=1}^{N}\log p(A^{(i)}|I,Q)+\lambda_{\boldsymbol{\theta}}\cdot||{\boldsymbol{\theta}}||_{2}^{2}" display="inline"><semantics id="S4.E3.m3.5a"><mrow id="S4.E3.m3.5.5" xref="S4.E3.m3.5.5.cmml"><mrow id="S4.E3.m3.5.5.1" xref="S4.E3.m3.5.5.1.cmml"><mo id="S4.E3.m3.5.5.1a" xref="S4.E3.m3.5.5.1.cmml">−</mo><mrow id="S4.E3.m3.5.5.1.1" xref="S4.E3.m3.5.5.1.1.cmml"><mstyle displaystyle="true" id="S4.E3.m3.5.5.1.1.3" xref="S4.E3.m3.5.5.1.1.3.cmml"><mfrac id="S4.E3.m3.5.5.1.1.3a" xref="S4.E3.m3.5.5.1.1.3.cmml"><mn id="S4.E3.m3.5.5.1.1.3.2" xref="S4.E3.m3.5.5.1.1.3.2.cmml">1</mn><mi id="S4.E3.m3.5.5.1.1.3.3" xref="S4.E3.m3.5.5.1.1.3.3.cmml">N</mi></mfrac></mstyle><mo lspace="0em" rspace="0em" id="S4.E3.m3.5.5.1.1.2" xref="S4.E3.m3.5.5.1.1.2.cmml">​</mo><mrow id="S4.E3.m3.5.5.1.1.1" xref="S4.E3.m3.5.5.1.1.1.cmml"><mstyle displaystyle="true" id="S4.E3.m3.5.5.1.1.1.2" xref="S4.E3.m3.5.5.1.1.1.2.cmml"><munderover id="S4.E3.m3.5.5.1.1.1.2a" xref="S4.E3.m3.5.5.1.1.1.2.cmml"><mo movablelimits="false" id="S4.E3.m3.5.5.1.1.1.2.2.2" xref="S4.E3.m3.5.5.1.1.1.2.2.2.cmml">∑</mo><mrow id="S4.E3.m3.5.5.1.1.1.2.2.3" xref="S4.E3.m3.5.5.1.1.1.2.2.3.cmml"><mi id="S4.E3.m3.5.5.1.1.1.2.2.3.2" xref="S4.E3.m3.5.5.1.1.1.2.2.3.2.cmml">i</mi><mo id="S4.E3.m3.5.5.1.1.1.2.2.3.1" xref="S4.E3.m3.5.5.1.1.1.2.2.3.1.cmml">=</mo><mn id="S4.E3.m3.5.5.1.1.1.2.2.3.3" xref="S4.E3.m3.5.5.1.1.1.2.2.3.3.cmml">1</mn></mrow><mi id="S4.E3.m3.5.5.1.1.1.2.3" xref="S4.E3.m3.5.5.1.1.1.2.3.cmml">N</mi></munderover></mstyle><mrow id="S4.E3.m3.5.5.1.1.1.1" xref="S4.E3.m3.5.5.1.1.1.1.cmml"><mrow id="S4.E3.m3.5.5.1.1.1.1.3" xref="S4.E3.m3.5.5.1.1.1.1.3.cmml"><mi id="S4.E3.m3.5.5.1.1.1.1.3.1" xref="S4.E3.m3.5.5.1.1.1.1.3.1.cmml">log</mi><mo lspace="0.167em" id="S4.E3.m3.5.5.1.1.1.1.3a" xref="S4.E3.m3.5.5.1.1.1.1.3.cmml">⁡</mo><mi id="S4.E3.m3.5.5.1.1.1.1.3.2" xref="S4.E3.m3.5.5.1.1.1.1.3.2.cmml">p</mi></mrow><mo lspace="0em" rspace="0em" id="S4.E3.m3.5.5.1.1.1.1.2" xref="S4.E3.m3.5.5.1.1.1.1.2.cmml">​</mo><mrow id="S4.E3.m3.5.5.1.1.1.1.1.1" xref="S4.E3.m3.5.5.1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S4.E3.m3.5.5.1.1.1.1.1.1.2" xref="S4.E3.m3.5.5.1.1.1.1.1.1.1.cmml">(</mo><mrow id="S4.E3.m3.5.5.1.1.1.1.1.1.1" xref="S4.E3.m3.5.5.1.1.1.1.1.1.1.cmml"><msup id="S4.E3.m3.5.5.1.1.1.1.1.1.1.2" xref="S4.E3.m3.5.5.1.1.1.1.1.1.1.2.cmml"><mi id="S4.E3.m3.5.5.1.1.1.1.1.1.1.2.2" xref="S4.E3.m3.5.5.1.1.1.1.1.1.1.2.2.cmml">A</mi><mrow id="S4.E3.m3.1.1.1.3" xref="S4.E3.m3.5.5.1.1.1.1.1.1.1.2.cmml"><mo stretchy="false" id="S4.E3.m3.1.1.1.3.1" xref="S4.E3.m3.5.5.1.1.1.1.1.1.1.2.cmml">(</mo><mi id="S4.E3.m3.1.1.1.1" xref="S4.E3.m3.1.1.1.1.cmml">i</mi><mo stretchy="false" id="S4.E3.m3.1.1.1.3.2" xref="S4.E3.m3.5.5.1.1.1.1.1.1.1.2.cmml">)</mo></mrow></msup><mo fence="false" id="S4.E3.m3.5.5.1.1.1.1.1.1.1.1" xref="S4.E3.m3.5.5.1.1.1.1.1.1.1.1.cmml">|</mo><mrow id="S4.E3.m3.5.5.1.1.1.1.1.1.1.3.2" xref="S4.E3.m3.5.5.1.1.1.1.1.1.1.3.1.cmml"><mi id="S4.E3.m3.2.2" xref="S4.E3.m3.2.2.cmml">I</mi><mo id="S4.E3.m3.5.5.1.1.1.1.1.1.1.3.2.1" xref="S4.E3.m3.5.5.1.1.1.1.1.1.1.3.1.cmml">,</mo><mi id="S4.E3.m3.3.3" xref="S4.E3.m3.3.3.cmml">Q</mi></mrow></mrow><mo stretchy="false" id="S4.E3.m3.5.5.1.1.1.1.1.1.3" xref="S4.E3.m3.5.5.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow></mrow></mrow><mo id="S4.E3.m3.5.5.2" xref="S4.E3.m3.5.5.2.cmml">+</mo><mrow id="S4.E3.m3.5.5.3" xref="S4.E3.m3.5.5.3.cmml"><msub id="S4.E3.m3.5.5.3.2" xref="S4.E3.m3.5.5.3.2.cmml"><mi id="S4.E3.m3.5.5.3.2.2" xref="S4.E3.m3.5.5.3.2.2.cmml">λ</mi><mi id="S4.E3.m3.5.5.3.2.3" xref="S4.E3.m3.5.5.3.2.3.cmml">𝜽</mi></msub><mo lspace="0.222em" rspace="0.222em" id="S4.E3.m3.5.5.3.1" xref="S4.E3.m3.5.5.3.1.cmml">⋅</mo><msubsup id="S4.E3.m3.5.5.3.3" xref="S4.E3.m3.5.5.3.3.cmml"><mrow id="S4.E3.m3.5.5.3.3.2.2.2" xref="S4.E3.m3.5.5.3.3.2.2.1.cmml"><mo stretchy="false" id="S4.E3.m3.5.5.3.3.2.2.2.1" xref="S4.E3.m3.5.5.3.3.2.2.1.1.cmml">‖</mo><mi id="S4.E3.m3.4.4" xref="S4.E3.m3.4.4.cmml">𝜽</mi><mo stretchy="false" id="S4.E3.m3.5.5.3.3.2.2.2.2" xref="S4.E3.m3.5.5.3.3.2.2.1.1.cmml">‖</mo></mrow><mn id="S4.E3.m3.5.5.3.3.2.3" xref="S4.E3.m3.5.5.3.3.2.3.cmml">2</mn><mn id="S4.E3.m3.5.5.3.3.3" xref="S4.E3.m3.5.5.3.3.3.cmml">2</mn></msubsup></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.E3.m3.5b"><apply id="S4.E3.m3.5.5.cmml" xref="S4.E3.m3.5.5"><plus id="S4.E3.m3.5.5.2.cmml" xref="S4.E3.m3.5.5.2"></plus><apply id="S4.E3.m3.5.5.1.cmml" xref="S4.E3.m3.5.5.1"><minus id="S4.E3.m3.5.5.1.2.cmml" xref="S4.E3.m3.5.5.1"></minus><apply id="S4.E3.m3.5.5.1.1.cmml" xref="S4.E3.m3.5.5.1.1"><times id="S4.E3.m3.5.5.1.1.2.cmml" xref="S4.E3.m3.5.5.1.1.2"></times><apply id="S4.E3.m3.5.5.1.1.3.cmml" xref="S4.E3.m3.5.5.1.1.3"><divide id="S4.E3.m3.5.5.1.1.3.1.cmml" xref="S4.E3.m3.5.5.1.1.3"></divide><cn type="integer" id="S4.E3.m3.5.5.1.1.3.2.cmml" xref="S4.E3.m3.5.5.1.1.3.2">1</cn><ci id="S4.E3.m3.5.5.1.1.3.3.cmml" xref="S4.E3.m3.5.5.1.1.3.3">𝑁</ci></apply><apply id="S4.E3.m3.5.5.1.1.1.cmml" xref="S4.E3.m3.5.5.1.1.1"><apply id="S4.E3.m3.5.5.1.1.1.2.cmml" xref="S4.E3.m3.5.5.1.1.1.2"><csymbol cd="ambiguous" id="S4.E3.m3.5.5.1.1.1.2.1.cmml" xref="S4.E3.m3.5.5.1.1.1.2">superscript</csymbol><apply id="S4.E3.m3.5.5.1.1.1.2.2.cmml" xref="S4.E3.m3.5.5.1.1.1.2"><csymbol cd="ambiguous" id="S4.E3.m3.5.5.1.1.1.2.2.1.cmml" xref="S4.E3.m3.5.5.1.1.1.2">subscript</csymbol><sum id="S4.E3.m3.5.5.1.1.1.2.2.2.cmml" xref="S4.E3.m3.5.5.1.1.1.2.2.2"></sum><apply id="S4.E3.m3.5.5.1.1.1.2.2.3.cmml" xref="S4.E3.m3.5.5.1.1.1.2.2.3"><eq id="S4.E3.m3.5.5.1.1.1.2.2.3.1.cmml" xref="S4.E3.m3.5.5.1.1.1.2.2.3.1"></eq><ci id="S4.E3.m3.5.5.1.1.1.2.2.3.2.cmml" xref="S4.E3.m3.5.5.1.1.1.2.2.3.2">𝑖</ci><cn type="integer" id="S4.E3.m3.5.5.1.1.1.2.2.3.3.cmml" xref="S4.E3.m3.5.5.1.1.1.2.2.3.3">1</cn></apply></apply><ci id="S4.E3.m3.5.5.1.1.1.2.3.cmml" xref="S4.E3.m3.5.5.1.1.1.2.3">𝑁</ci></apply><apply id="S4.E3.m3.5.5.1.1.1.1.cmml" xref="S4.E3.m3.5.5.1.1.1.1"><times id="S4.E3.m3.5.5.1.1.1.1.2.cmml" xref="S4.E3.m3.5.5.1.1.1.1.2"></times><apply id="S4.E3.m3.5.5.1.1.1.1.3.cmml" xref="S4.E3.m3.5.5.1.1.1.1.3"><log id="S4.E3.m3.5.5.1.1.1.1.3.1.cmml" xref="S4.E3.m3.5.5.1.1.1.1.3.1"></log><ci id="S4.E3.m3.5.5.1.1.1.1.3.2.cmml" xref="S4.E3.m3.5.5.1.1.1.1.3.2">𝑝</ci></apply><apply id="S4.E3.m3.5.5.1.1.1.1.1.1.1.cmml" xref="S4.E3.m3.5.5.1.1.1.1.1.1"><csymbol cd="latexml" id="S4.E3.m3.5.5.1.1.1.1.1.1.1.1.cmml" xref="S4.E3.m3.5.5.1.1.1.1.1.1.1.1">conditional</csymbol><apply id="S4.E3.m3.5.5.1.1.1.1.1.1.1.2.cmml" xref="S4.E3.m3.5.5.1.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S4.E3.m3.5.5.1.1.1.1.1.1.1.2.1.cmml" xref="S4.E3.m3.5.5.1.1.1.1.1.1.1.2">superscript</csymbol><ci id="S4.E3.m3.5.5.1.1.1.1.1.1.1.2.2.cmml" xref="S4.E3.m3.5.5.1.1.1.1.1.1.1.2.2">𝐴</ci><ci id="S4.E3.m3.1.1.1.1.cmml" xref="S4.E3.m3.1.1.1.1">𝑖</ci></apply><list id="S4.E3.m3.5.5.1.1.1.1.1.1.1.3.1.cmml" xref="S4.E3.m3.5.5.1.1.1.1.1.1.1.3.2"><ci id="S4.E3.m3.2.2.cmml" xref="S4.E3.m3.2.2">𝐼</ci><ci id="S4.E3.m3.3.3.cmml" xref="S4.E3.m3.3.3">𝑄</ci></list></apply></apply></apply></apply></apply><apply id="S4.E3.m3.5.5.3.cmml" xref="S4.E3.m3.5.5.3"><ci id="S4.E3.m3.5.5.3.1.cmml" xref="S4.E3.m3.5.5.3.1">⋅</ci><apply id="S4.E3.m3.5.5.3.2.cmml" xref="S4.E3.m3.5.5.3.2"><csymbol cd="ambiguous" id="S4.E3.m3.5.5.3.2.1.cmml" xref="S4.E3.m3.5.5.3.2">subscript</csymbol><ci id="S4.E3.m3.5.5.3.2.2.cmml" xref="S4.E3.m3.5.5.3.2.2">𝜆</ci><ci id="S4.E3.m3.5.5.3.2.3.cmml" xref="S4.E3.m3.5.5.3.2.3">𝜽</ci></apply><apply id="S4.E3.m3.5.5.3.3.cmml" xref="S4.E3.m3.5.5.3.3"><csymbol cd="ambiguous" id="S4.E3.m3.5.5.3.3.1.cmml" xref="S4.E3.m3.5.5.3.3">superscript</csymbol><apply id="S4.E3.m3.5.5.3.3.2.cmml" xref="S4.E3.m3.5.5.3.3"><csymbol cd="ambiguous" id="S4.E3.m3.5.5.3.3.2.1.cmml" xref="S4.E3.m3.5.5.3.3">subscript</csymbol><apply id="S4.E3.m3.5.5.3.3.2.2.1.cmml" xref="S4.E3.m3.5.5.3.3.2.2.2"><csymbol cd="latexml" id="S4.E3.m3.5.5.3.3.2.2.1.1.cmml" xref="S4.E3.m3.5.5.3.3.2.2.2.1">norm</csymbol><ci id="S4.E3.m3.4.4.cmml" xref="S4.E3.m3.4.4">𝜽</ci></apply><cn type="integer" id="S4.E3.m3.5.5.3.3.2.3.cmml" xref="S4.E3.m3.5.5.3.3.2.3">2</cn></apply><cn type="integer" id="S4.E3.m3.5.5.3.3.3.cmml" xref="S4.E3.m3.5.5.3.3.3">2</cn></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.E3.m3.5c">\displaystyle-\frac{1}{N}\sum_{i=1}^{N}\log p(A^{(i)}|I,Q)+\lambda_{\boldsymbol{\theta}}\cdot||{\boldsymbol{\theta}}||_{2}^{2}</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(3)</span></td>
</tr></tbody>
<tbody id="S4.E4"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_eqn_cell"></td>
<td class="ltx_td ltx_align_center ltx_eqn_cell"><math id="S4.E4.m1.1" class="ltx_Math" alttext="\displaystyle=" display="inline"><semantics id="S4.E4.m1.1a"><mo id="S4.E4.m1.1.1" xref="S4.E4.m1.1.1.cmml">=</mo><annotation-xml encoding="MathML-Content" id="S4.E4.m1.1b"><eq id="S4.E4.m1.1.1.cmml" xref="S4.E4.m1.1.1"></eq></annotation-xml><annotation encoding="application/x-tex" id="S4.E4.m1.1c">\displaystyle=</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math id="S4.E4.m2.4" class="ltx_Math" alttext="\displaystyle-\frac{1}{N}\sum_{i=1}^{N}\sum_{j=1}^{l^{(i)}+1}\log p_{j}(a_{j}^{(i)})+\lambda_{\boldsymbol{\theta}}\cdot||{\boldsymbol{\theta}}||_{2}^{2}\vspace{-7pt}" display="inline"><semantics id="S4.E4.m2.4a"><mrow id="S4.E4.m2.4.4" xref="S4.E4.m2.4.4.cmml"><mrow id="S4.E4.m2.4.4.1" xref="S4.E4.m2.4.4.1.cmml"><mo id="S4.E4.m2.4.4.1a" xref="S4.E4.m2.4.4.1.cmml">−</mo><mrow id="S4.E4.m2.4.4.1.1" xref="S4.E4.m2.4.4.1.1.cmml"><mstyle displaystyle="true" id="S4.E4.m2.4.4.1.1.3" xref="S4.E4.m2.4.4.1.1.3.cmml"><mfrac id="S4.E4.m2.4.4.1.1.3a" xref="S4.E4.m2.4.4.1.1.3.cmml"><mn id="S4.E4.m2.4.4.1.1.3.2" xref="S4.E4.m2.4.4.1.1.3.2.cmml">1</mn><mi id="S4.E4.m2.4.4.1.1.3.3" xref="S4.E4.m2.4.4.1.1.3.3.cmml">N</mi></mfrac></mstyle><mo lspace="0em" rspace="0em" id="S4.E4.m2.4.4.1.1.2" xref="S4.E4.m2.4.4.1.1.2.cmml">​</mo><mrow id="S4.E4.m2.4.4.1.1.1" xref="S4.E4.m2.4.4.1.1.1.cmml"><mstyle displaystyle="true" id="S4.E4.m2.4.4.1.1.1.2" xref="S4.E4.m2.4.4.1.1.1.2.cmml"><munderover id="S4.E4.m2.4.4.1.1.1.2a" xref="S4.E4.m2.4.4.1.1.1.2.cmml"><mo movablelimits="false" id="S4.E4.m2.4.4.1.1.1.2.2.2" xref="S4.E4.m2.4.4.1.1.1.2.2.2.cmml">∑</mo><mrow id="S4.E4.m2.4.4.1.1.1.2.2.3" xref="S4.E4.m2.4.4.1.1.1.2.2.3.cmml"><mi id="S4.E4.m2.4.4.1.1.1.2.2.3.2" xref="S4.E4.m2.4.4.1.1.1.2.2.3.2.cmml">i</mi><mo id="S4.E4.m2.4.4.1.1.1.2.2.3.1" xref="S4.E4.m2.4.4.1.1.1.2.2.3.1.cmml">=</mo><mn id="S4.E4.m2.4.4.1.1.1.2.2.3.3" xref="S4.E4.m2.4.4.1.1.1.2.2.3.3.cmml">1</mn></mrow><mi id="S4.E4.m2.4.4.1.1.1.2.3" xref="S4.E4.m2.4.4.1.1.1.2.3.cmml">N</mi></munderover></mstyle><mrow id="S4.E4.m2.4.4.1.1.1.1" xref="S4.E4.m2.4.4.1.1.1.1.cmml"><mstyle displaystyle="true" id="S4.E4.m2.4.4.1.1.1.1.2" xref="S4.E4.m2.4.4.1.1.1.1.2.cmml"><munderover id="S4.E4.m2.4.4.1.1.1.1.2a" xref="S4.E4.m2.4.4.1.1.1.1.2.cmml"><mo movablelimits="false" id="S4.E4.m2.4.4.1.1.1.1.2.2.2" xref="S4.E4.m2.4.4.1.1.1.1.2.2.2.cmml">∑</mo><mrow id="S4.E4.m2.4.4.1.1.1.1.2.2.3" xref="S4.E4.m2.4.4.1.1.1.1.2.2.3.cmml"><mi id="S4.E4.m2.4.4.1.1.1.1.2.2.3.2" xref="S4.E4.m2.4.4.1.1.1.1.2.2.3.2.cmml">j</mi><mo id="S4.E4.m2.4.4.1.1.1.1.2.2.3.1" xref="S4.E4.m2.4.4.1.1.1.1.2.2.3.1.cmml">=</mo><mn id="S4.E4.m2.4.4.1.1.1.1.2.2.3.3" xref="S4.E4.m2.4.4.1.1.1.1.2.2.3.3.cmml">1</mn></mrow><mrow id="S4.E4.m2.1.1.1" xref="S4.E4.m2.1.1.1.cmml"><msup id="S4.E4.m2.1.1.1.3" xref="S4.E4.m2.1.1.1.3.cmml"><mi id="S4.E4.m2.1.1.1.3.2" xref="S4.E4.m2.1.1.1.3.2.cmml">l</mi><mrow id="S4.E4.m2.1.1.1.1.1.3" xref="S4.E4.m2.1.1.1.3.cmml"><mo stretchy="false" id="S4.E4.m2.1.1.1.1.1.3.1" xref="S4.E4.m2.1.1.1.3.cmml">(</mo><mi id="S4.E4.m2.1.1.1.1.1.1" xref="S4.E4.m2.1.1.1.1.1.1.cmml">i</mi><mo stretchy="false" id="S4.E4.m2.1.1.1.1.1.3.2" xref="S4.E4.m2.1.1.1.3.cmml">)</mo></mrow></msup><mo id="S4.E4.m2.1.1.1.2" xref="S4.E4.m2.1.1.1.2.cmml">+</mo><mn id="S4.E4.m2.1.1.1.4" xref="S4.E4.m2.1.1.1.4.cmml">1</mn></mrow></munderover></mstyle><mrow id="S4.E4.m2.4.4.1.1.1.1.1" xref="S4.E4.m2.4.4.1.1.1.1.1.cmml"><mrow id="S4.E4.m2.4.4.1.1.1.1.1.3" xref="S4.E4.m2.4.4.1.1.1.1.1.3.cmml"><mi id="S4.E4.m2.4.4.1.1.1.1.1.3.1" xref="S4.E4.m2.4.4.1.1.1.1.1.3.1.cmml">log</mi><mo lspace="0.167em" id="S4.E4.m2.4.4.1.1.1.1.1.3a" xref="S4.E4.m2.4.4.1.1.1.1.1.3.cmml">⁡</mo><msub id="S4.E4.m2.4.4.1.1.1.1.1.3.2" xref="S4.E4.m2.4.4.1.1.1.1.1.3.2.cmml"><mi id="S4.E4.m2.4.4.1.1.1.1.1.3.2.2" xref="S4.E4.m2.4.4.1.1.1.1.1.3.2.2.cmml">p</mi><mi id="S4.E4.m2.4.4.1.1.1.1.1.3.2.3" xref="S4.E4.m2.4.4.1.1.1.1.1.3.2.3.cmml">j</mi></msub></mrow><mo lspace="0em" rspace="0em" id="S4.E4.m2.4.4.1.1.1.1.1.2" xref="S4.E4.m2.4.4.1.1.1.1.1.2.cmml">​</mo><mrow id="S4.E4.m2.4.4.1.1.1.1.1.1.1" xref="S4.E4.m2.4.4.1.1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S4.E4.m2.4.4.1.1.1.1.1.1.1.2" xref="S4.E4.m2.4.4.1.1.1.1.1.1.1.1.cmml">(</mo><msubsup id="S4.E4.m2.4.4.1.1.1.1.1.1.1.1" xref="S4.E4.m2.4.4.1.1.1.1.1.1.1.1.cmml"><mi id="S4.E4.m2.4.4.1.1.1.1.1.1.1.1.2.2" xref="S4.E4.m2.4.4.1.1.1.1.1.1.1.1.2.2.cmml">a</mi><mi id="S4.E4.m2.4.4.1.1.1.1.1.1.1.1.2.3" xref="S4.E4.m2.4.4.1.1.1.1.1.1.1.1.2.3.cmml">j</mi><mrow id="S4.E4.m2.2.2.1.3" xref="S4.E4.m2.4.4.1.1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S4.E4.m2.2.2.1.3.1" xref="S4.E4.m2.4.4.1.1.1.1.1.1.1.1.cmml">(</mo><mi id="S4.E4.m2.2.2.1.1" xref="S4.E4.m2.2.2.1.1.cmml">i</mi><mo stretchy="false" id="S4.E4.m2.2.2.1.3.2" xref="S4.E4.m2.4.4.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></msubsup><mo stretchy="false" id="S4.E4.m2.4.4.1.1.1.1.1.1.1.3" xref="S4.E4.m2.4.4.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow></mrow></mrow></mrow><mo id="S4.E4.m2.4.4.2" xref="S4.E4.m2.4.4.2.cmml">+</mo><mrow id="S4.E4.m2.4.4.3" xref="S4.E4.m2.4.4.3.cmml"><msub id="S4.E4.m2.4.4.3.2" xref="S4.E4.m2.4.4.3.2.cmml"><mi id="S4.E4.m2.4.4.3.2.2" xref="S4.E4.m2.4.4.3.2.2.cmml">λ</mi><mi id="S4.E4.m2.4.4.3.2.3" xref="S4.E4.m2.4.4.3.2.3.cmml">𝜽</mi></msub><mo lspace="0.222em" rspace="0.222em" id="S4.E4.m2.4.4.3.1" xref="S4.E4.m2.4.4.3.1.cmml">⋅</mo><msubsup id="S4.E4.m2.4.4.3.3" xref="S4.E4.m2.4.4.3.3.cmml"><mrow id="S4.E4.m2.4.4.3.3.2.2.2" xref="S4.E4.m2.4.4.3.3.2.2.1.cmml"><mo stretchy="false" id="S4.E4.m2.4.4.3.3.2.2.2.1" xref="S4.E4.m2.4.4.3.3.2.2.1.1.cmml">‖</mo><mi id="S4.E4.m2.3.3" xref="S4.E4.m2.3.3.cmml">𝜽</mi><mo stretchy="false" id="S4.E4.m2.4.4.3.3.2.2.2.2" xref="S4.E4.m2.4.4.3.3.2.2.1.1.cmml">‖</mo></mrow><mn id="S4.E4.m2.4.4.3.3.2.3" xref="S4.E4.m2.4.4.3.3.2.3.cmml">2</mn><mn id="S4.E4.m2.4.4.3.3.3" xref="S4.E4.m2.4.4.3.3.3.cmml">2</mn></msubsup></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.E4.m2.4b"><apply id="S4.E4.m2.4.4.cmml" xref="S4.E4.m2.4.4"><plus id="S4.E4.m2.4.4.2.cmml" xref="S4.E4.m2.4.4.2"></plus><apply id="S4.E4.m2.4.4.1.cmml" xref="S4.E4.m2.4.4.1"><minus id="S4.E4.m2.4.4.1.2.cmml" xref="S4.E4.m2.4.4.1"></minus><apply id="S4.E4.m2.4.4.1.1.cmml" xref="S4.E4.m2.4.4.1.1"><times id="S4.E4.m2.4.4.1.1.2.cmml" xref="S4.E4.m2.4.4.1.1.2"></times><apply id="S4.E4.m2.4.4.1.1.3.cmml" xref="S4.E4.m2.4.4.1.1.3"><divide id="S4.E4.m2.4.4.1.1.3.1.cmml" xref="S4.E4.m2.4.4.1.1.3"></divide><cn type="integer" id="S4.E4.m2.4.4.1.1.3.2.cmml" xref="S4.E4.m2.4.4.1.1.3.2">1</cn><ci id="S4.E4.m2.4.4.1.1.3.3.cmml" xref="S4.E4.m2.4.4.1.1.3.3">𝑁</ci></apply><apply id="S4.E4.m2.4.4.1.1.1.cmml" xref="S4.E4.m2.4.4.1.1.1"><apply id="S4.E4.m2.4.4.1.1.1.2.cmml" xref="S4.E4.m2.4.4.1.1.1.2"><csymbol cd="ambiguous" id="S4.E4.m2.4.4.1.1.1.2.1.cmml" xref="S4.E4.m2.4.4.1.1.1.2">superscript</csymbol><apply id="S4.E4.m2.4.4.1.1.1.2.2.cmml" xref="S4.E4.m2.4.4.1.1.1.2"><csymbol cd="ambiguous" id="S4.E4.m2.4.4.1.1.1.2.2.1.cmml" xref="S4.E4.m2.4.4.1.1.1.2">subscript</csymbol><sum id="S4.E4.m2.4.4.1.1.1.2.2.2.cmml" xref="S4.E4.m2.4.4.1.1.1.2.2.2"></sum><apply id="S4.E4.m2.4.4.1.1.1.2.2.3.cmml" xref="S4.E4.m2.4.4.1.1.1.2.2.3"><eq id="S4.E4.m2.4.4.1.1.1.2.2.3.1.cmml" xref="S4.E4.m2.4.4.1.1.1.2.2.3.1"></eq><ci id="S4.E4.m2.4.4.1.1.1.2.2.3.2.cmml" xref="S4.E4.m2.4.4.1.1.1.2.2.3.2">𝑖</ci><cn type="integer" id="S4.E4.m2.4.4.1.1.1.2.2.3.3.cmml" xref="S4.E4.m2.4.4.1.1.1.2.2.3.3">1</cn></apply></apply><ci id="S4.E4.m2.4.4.1.1.1.2.3.cmml" xref="S4.E4.m2.4.4.1.1.1.2.3">𝑁</ci></apply><apply id="S4.E4.m2.4.4.1.1.1.1.cmml" xref="S4.E4.m2.4.4.1.1.1.1"><apply id="S4.E4.m2.4.4.1.1.1.1.2.cmml" xref="S4.E4.m2.4.4.1.1.1.1.2"><csymbol cd="ambiguous" id="S4.E4.m2.4.4.1.1.1.1.2.1.cmml" xref="S4.E4.m2.4.4.1.1.1.1.2">superscript</csymbol><apply id="S4.E4.m2.4.4.1.1.1.1.2.2.cmml" xref="S4.E4.m2.4.4.1.1.1.1.2"><csymbol cd="ambiguous" id="S4.E4.m2.4.4.1.1.1.1.2.2.1.cmml" xref="S4.E4.m2.4.4.1.1.1.1.2">subscript</csymbol><sum id="S4.E4.m2.4.4.1.1.1.1.2.2.2.cmml" xref="S4.E4.m2.4.4.1.1.1.1.2.2.2"></sum><apply id="S4.E4.m2.4.4.1.1.1.1.2.2.3.cmml" xref="S4.E4.m2.4.4.1.1.1.1.2.2.3"><eq id="S4.E4.m2.4.4.1.1.1.1.2.2.3.1.cmml" xref="S4.E4.m2.4.4.1.1.1.1.2.2.3.1"></eq><ci id="S4.E4.m2.4.4.1.1.1.1.2.2.3.2.cmml" xref="S4.E4.m2.4.4.1.1.1.1.2.2.3.2">𝑗</ci><cn type="integer" id="S4.E4.m2.4.4.1.1.1.1.2.2.3.3.cmml" xref="S4.E4.m2.4.4.1.1.1.1.2.2.3.3">1</cn></apply></apply><apply id="S4.E4.m2.1.1.1.cmml" xref="S4.E4.m2.1.1.1"><plus id="S4.E4.m2.1.1.1.2.cmml" xref="S4.E4.m2.1.1.1.2"></plus><apply id="S4.E4.m2.1.1.1.3.cmml" xref="S4.E4.m2.1.1.1.3"><csymbol cd="ambiguous" id="S4.E4.m2.1.1.1.3.1.cmml" xref="S4.E4.m2.1.1.1.3">superscript</csymbol><ci id="S4.E4.m2.1.1.1.3.2.cmml" xref="S4.E4.m2.1.1.1.3.2">𝑙</ci><ci id="S4.E4.m2.1.1.1.1.1.1.cmml" xref="S4.E4.m2.1.1.1.1.1.1">𝑖</ci></apply><cn type="integer" id="S4.E4.m2.1.1.1.4.cmml" xref="S4.E4.m2.1.1.1.4">1</cn></apply></apply><apply id="S4.E4.m2.4.4.1.1.1.1.1.cmml" xref="S4.E4.m2.4.4.1.1.1.1.1"><times id="S4.E4.m2.4.4.1.1.1.1.1.2.cmml" xref="S4.E4.m2.4.4.1.1.1.1.1.2"></times><apply id="S4.E4.m2.4.4.1.1.1.1.1.3.cmml" xref="S4.E4.m2.4.4.1.1.1.1.1.3"><log id="S4.E4.m2.4.4.1.1.1.1.1.3.1.cmml" xref="S4.E4.m2.4.4.1.1.1.1.1.3.1"></log><apply id="S4.E4.m2.4.4.1.1.1.1.1.3.2.cmml" xref="S4.E4.m2.4.4.1.1.1.1.1.3.2"><csymbol cd="ambiguous" id="S4.E4.m2.4.4.1.1.1.1.1.3.2.1.cmml" xref="S4.E4.m2.4.4.1.1.1.1.1.3.2">subscript</csymbol><ci id="S4.E4.m2.4.4.1.1.1.1.1.3.2.2.cmml" xref="S4.E4.m2.4.4.1.1.1.1.1.3.2.2">𝑝</ci><ci id="S4.E4.m2.4.4.1.1.1.1.1.3.2.3.cmml" xref="S4.E4.m2.4.4.1.1.1.1.1.3.2.3">𝑗</ci></apply></apply><apply id="S4.E4.m2.4.4.1.1.1.1.1.1.1.1.cmml" xref="S4.E4.m2.4.4.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.E4.m2.4.4.1.1.1.1.1.1.1.1.1.cmml" xref="S4.E4.m2.4.4.1.1.1.1.1.1.1">superscript</csymbol><apply id="S4.E4.m2.4.4.1.1.1.1.1.1.1.1.2.cmml" xref="S4.E4.m2.4.4.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.E4.m2.4.4.1.1.1.1.1.1.1.1.2.1.cmml" xref="S4.E4.m2.4.4.1.1.1.1.1.1.1">subscript</csymbol><ci id="S4.E4.m2.4.4.1.1.1.1.1.1.1.1.2.2.cmml" xref="S4.E4.m2.4.4.1.1.1.1.1.1.1.1.2.2">𝑎</ci><ci id="S4.E4.m2.4.4.1.1.1.1.1.1.1.1.2.3.cmml" xref="S4.E4.m2.4.4.1.1.1.1.1.1.1.1.2.3">𝑗</ci></apply><ci id="S4.E4.m2.2.2.1.1.cmml" xref="S4.E4.m2.2.2.1.1">𝑖</ci></apply></apply></apply></apply></apply></apply><apply id="S4.E4.m2.4.4.3.cmml" xref="S4.E4.m2.4.4.3"><ci id="S4.E4.m2.4.4.3.1.cmml" xref="S4.E4.m2.4.4.3.1">⋅</ci><apply id="S4.E4.m2.4.4.3.2.cmml" xref="S4.E4.m2.4.4.3.2"><csymbol cd="ambiguous" id="S4.E4.m2.4.4.3.2.1.cmml" xref="S4.E4.m2.4.4.3.2">subscript</csymbol><ci id="S4.E4.m2.4.4.3.2.2.cmml" xref="S4.E4.m2.4.4.3.2.2">𝜆</ci><ci id="S4.E4.m2.4.4.3.2.3.cmml" xref="S4.E4.m2.4.4.3.2.3">𝜽</ci></apply><apply id="S4.E4.m2.4.4.3.3.cmml" xref="S4.E4.m2.4.4.3.3"><csymbol cd="ambiguous" id="S4.E4.m2.4.4.3.3.1.cmml" xref="S4.E4.m2.4.4.3.3">superscript</csymbol><apply id="S4.E4.m2.4.4.3.3.2.cmml" xref="S4.E4.m2.4.4.3.3"><csymbol cd="ambiguous" id="S4.E4.m2.4.4.3.3.2.1.cmml" xref="S4.E4.m2.4.4.3.3">subscript</csymbol><apply id="S4.E4.m2.4.4.3.3.2.2.1.cmml" xref="S4.E4.m2.4.4.3.3.2.2.2"><csymbol cd="latexml" id="S4.E4.m2.4.4.3.3.2.2.1.1.cmml" xref="S4.E4.m2.4.4.3.3.2.2.2.1">norm</csymbol><ci id="S4.E4.m2.3.3.cmml" xref="S4.E4.m2.3.3">𝜽</ci></apply><cn type="integer" id="S4.E4.m2.4.4.3.3.2.3.cmml" xref="S4.E4.m2.4.4.3.3.2.3">2</cn></apply><cn type="integer" id="S4.E4.m2.4.4.3.3.3.cmml" xref="S4.E4.m2.4.4.3.3.3">2</cn></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.E4.m2.4c">\displaystyle-\frac{1}{N}\sum_{i=1}^{N}\sum_{j=1}^{l^{(i)}+1}\log p_{j}(a_{j}^{(i)})+\lambda_{\boldsymbol{\theta}}\cdot||{\boldsymbol{\theta}}||_{2}^{2}\vspace{-7pt}</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(4)</span></td>
</tr></tbody>
</table>
<p id="S4.p3.12" class="ltx_p">where <math id="S4.p3.5.m1.1" class="ltx_Math" alttext="N" display="inline"><semantics id="S4.p3.5.m1.1a"><mi id="S4.p3.5.m1.1.1" xref="S4.p3.5.m1.1.1.cmml">N</mi><annotation-xml encoding="MathML-Content" id="S4.p3.5.m1.1b"><ci id="S4.p3.5.m1.1.1.cmml" xref="S4.p3.5.m1.1.1">𝑁</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.p3.5.m1.1c">N</annotation></semantics></math> is the number of training examples, and <math id="S4.p3.6.m2.1" class="ltx_Math" alttext="n^{(i)}" display="inline"><semantics id="S4.p3.6.m2.1a"><msup id="S4.p3.6.m2.1.2" xref="S4.p3.6.m2.1.2.cmml"><mi id="S4.p3.6.m2.1.2.2" xref="S4.p3.6.m2.1.2.2.cmml">n</mi><mrow id="S4.p3.6.m2.1.1.1.3" xref="S4.p3.6.m2.1.2.cmml"><mo stretchy="false" id="S4.p3.6.m2.1.1.1.3.1" xref="S4.p3.6.m2.1.2.cmml">(</mo><mi id="S4.p3.6.m2.1.1.1.1" xref="S4.p3.6.m2.1.1.1.1.cmml">i</mi><mo stretchy="false" id="S4.p3.6.m2.1.1.1.3.2" xref="S4.p3.6.m2.1.2.cmml">)</mo></mrow></msup><annotation-xml encoding="MathML-Content" id="S4.p3.6.m2.1b"><apply id="S4.p3.6.m2.1.2.cmml" xref="S4.p3.6.m2.1.2"><csymbol cd="ambiguous" id="S4.p3.6.m2.1.2.1.cmml" xref="S4.p3.6.m2.1.2">superscript</csymbol><ci id="S4.p3.6.m2.1.2.2.cmml" xref="S4.p3.6.m2.1.2.2">𝑛</ci><ci id="S4.p3.6.m2.1.1.1.1.cmml" xref="S4.p3.6.m2.1.1.1.1">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.p3.6.m2.1c">n^{(i)}</annotation></semantics></math> and <math id="S4.p3.7.m3.1" class="ltx_Math" alttext="l^{(i)}" display="inline"><semantics id="S4.p3.7.m3.1a"><msup id="S4.p3.7.m3.1.2" xref="S4.p3.7.m3.1.2.cmml"><mi id="S4.p3.7.m3.1.2.2" xref="S4.p3.7.m3.1.2.2.cmml">l</mi><mrow id="S4.p3.7.m3.1.1.1.3" xref="S4.p3.7.m3.1.2.cmml"><mo stretchy="false" id="S4.p3.7.m3.1.1.1.3.1" xref="S4.p3.7.m3.1.2.cmml">(</mo><mi id="S4.p3.7.m3.1.1.1.1" xref="S4.p3.7.m3.1.1.1.1.cmml">i</mi><mo stretchy="false" id="S4.p3.7.m3.1.1.1.3.2" xref="S4.p3.7.m3.1.2.cmml">)</mo></mrow></msup><annotation-xml encoding="MathML-Content" id="S4.p3.7.m3.1b"><apply id="S4.p3.7.m3.1.2.cmml" xref="S4.p3.7.m3.1.2"><csymbol cd="ambiguous" id="S4.p3.7.m3.1.2.1.cmml" xref="S4.p3.7.m3.1.2">superscript</csymbol><ci id="S4.p3.7.m3.1.2.2.cmml" xref="S4.p3.7.m3.1.2.2">𝑙</ci><ci id="S4.p3.7.m3.1.1.1.1.cmml" xref="S4.p3.7.m3.1.1.1.1">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.p3.7.m3.1c">l^{(i)}</annotation></semantics></math> are the length of question and answer respectively for the <math id="S4.p3.8.m4.1" class="ltx_Math" alttext="i" display="inline"><semantics id="S4.p3.8.m4.1a"><mi id="S4.p3.8.m4.1.1" xref="S4.p3.8.m4.1.1.cmml">i</mi><annotation-xml encoding="MathML-Content" id="S4.p3.8.m4.1b"><ci id="S4.p3.8.m4.1.1.cmml" xref="S4.p3.8.m4.1.1">𝑖</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.p3.8.m4.1c">i</annotation></semantics></math>-th training example. Let <math id="S4.p3.9.m5.2" class="ltx_Math" alttext="p_{t}(a_{t}^{(i)})" display="inline"><semantics id="S4.p3.9.m5.2a"><mrow id="S4.p3.9.m5.2.2" xref="S4.p3.9.m5.2.2.cmml"><msub id="S4.p3.9.m5.2.2.3" xref="S4.p3.9.m5.2.2.3.cmml"><mi id="S4.p3.9.m5.2.2.3.2" xref="S4.p3.9.m5.2.2.3.2.cmml">p</mi><mi id="S4.p3.9.m5.2.2.3.3" xref="S4.p3.9.m5.2.2.3.3.cmml">t</mi></msub><mo lspace="0em" rspace="0em" id="S4.p3.9.m5.2.2.2" xref="S4.p3.9.m5.2.2.2.cmml">​</mo><mrow id="S4.p3.9.m5.2.2.1.1" xref="S4.p3.9.m5.2.2.1.1.1.cmml"><mo stretchy="false" id="S4.p3.9.m5.2.2.1.1.2" xref="S4.p3.9.m5.2.2.1.1.1.cmml">(</mo><msubsup id="S4.p3.9.m5.2.2.1.1.1" xref="S4.p3.9.m5.2.2.1.1.1.cmml"><mi id="S4.p3.9.m5.2.2.1.1.1.2.2" xref="S4.p3.9.m5.2.2.1.1.1.2.2.cmml">a</mi><mi id="S4.p3.9.m5.2.2.1.1.1.2.3" xref="S4.p3.9.m5.2.2.1.1.1.2.3.cmml">t</mi><mrow id="S4.p3.9.m5.1.1.1.3" xref="S4.p3.9.m5.2.2.1.1.1.cmml"><mo stretchy="false" id="S4.p3.9.m5.1.1.1.3.1" xref="S4.p3.9.m5.2.2.1.1.1.cmml">(</mo><mi id="S4.p3.9.m5.1.1.1.1" xref="S4.p3.9.m5.1.1.1.1.cmml">i</mi><mo stretchy="false" id="S4.p3.9.m5.1.1.1.3.2" xref="S4.p3.9.m5.2.2.1.1.1.cmml">)</mo></mrow></msubsup><mo stretchy="false" id="S4.p3.9.m5.2.2.1.1.3" xref="S4.p3.9.m5.2.2.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.p3.9.m5.2b"><apply id="S4.p3.9.m5.2.2.cmml" xref="S4.p3.9.m5.2.2"><times id="S4.p3.9.m5.2.2.2.cmml" xref="S4.p3.9.m5.2.2.2"></times><apply id="S4.p3.9.m5.2.2.3.cmml" xref="S4.p3.9.m5.2.2.3"><csymbol cd="ambiguous" id="S4.p3.9.m5.2.2.3.1.cmml" xref="S4.p3.9.m5.2.2.3">subscript</csymbol><ci id="S4.p3.9.m5.2.2.3.2.cmml" xref="S4.p3.9.m5.2.2.3.2">𝑝</ci><ci id="S4.p3.9.m5.2.2.3.3.cmml" xref="S4.p3.9.m5.2.2.3.3">𝑡</ci></apply><apply id="S4.p3.9.m5.2.2.1.1.1.cmml" xref="S4.p3.9.m5.2.2.1.1"><csymbol cd="ambiguous" id="S4.p3.9.m5.2.2.1.1.1.1.cmml" xref="S4.p3.9.m5.2.2.1.1">superscript</csymbol><apply id="S4.p3.9.m5.2.2.1.1.1.2.cmml" xref="S4.p3.9.m5.2.2.1.1"><csymbol cd="ambiguous" id="S4.p3.9.m5.2.2.1.1.1.2.1.cmml" xref="S4.p3.9.m5.2.2.1.1">subscript</csymbol><ci id="S4.p3.9.m5.2.2.1.1.1.2.2.cmml" xref="S4.p3.9.m5.2.2.1.1.1.2.2">𝑎</ci><ci id="S4.p3.9.m5.2.2.1.1.1.2.3.cmml" xref="S4.p3.9.m5.2.2.1.1.1.2.3">𝑡</ci></apply><ci id="S4.p3.9.m5.1.1.1.1.cmml" xref="S4.p3.9.m5.1.1.1.1">𝑖</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.p3.9.m5.2c">p_{t}(a_{t}^{(i)})</annotation></semantics></math> correspond to the activation of the Softmax layer in the LSTM model for the <math id="S4.p3.10.m6.1" class="ltx_Math" alttext="i" display="inline"><semantics id="S4.p3.10.m6.1a"><mi id="S4.p3.10.m6.1.1" xref="S4.p3.10.m6.1.1.cmml">i</mi><annotation-xml encoding="MathML-Content" id="S4.p3.10.m6.1b"><ci id="S4.p3.10.m6.1.1.cmml" xref="S4.p3.10.m6.1.1">𝑖</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.p3.10.m6.1c">i</annotation></semantics></math>-th input and <math id="S4.p3.11.m7.1" class="ltx_Math" alttext="{\boldsymbol{\theta}}" display="inline"><semantics id="S4.p3.11.m7.1a"><mi id="S4.p3.11.m7.1.1" xref="S4.p3.11.m7.1.1.cmml">𝜽</mi><annotation-xml encoding="MathML-Content" id="S4.p3.11.m7.1b"><ci id="S4.p3.11.m7.1.1.cmml" xref="S4.p3.11.m7.1.1">𝜽</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.p3.11.m7.1c">{\boldsymbol{\theta}}</annotation></semantics></math> represent the model parameters. Note that <math id="S4.p3.12.m8.1" class="ltx_Math" alttext="\lambda_{\boldsymbol{\theta}}\cdot||{\boldsymbol{\theta}}||_{2}^{2}" display="inline"><semantics id="S4.p3.12.m8.1a"><mrow id="S4.p3.12.m8.1.2" xref="S4.p3.12.m8.1.2.cmml"><msub id="S4.p3.12.m8.1.2.2" xref="S4.p3.12.m8.1.2.2.cmml"><mi id="S4.p3.12.m8.1.2.2.2" xref="S4.p3.12.m8.1.2.2.2.cmml">λ</mi><mi id="S4.p3.12.m8.1.2.2.3" xref="S4.p3.12.m8.1.2.2.3.cmml">𝜽</mi></msub><mo lspace="0.222em" rspace="0.222em" id="S4.p3.12.m8.1.2.1" xref="S4.p3.12.m8.1.2.1.cmml">⋅</mo><msubsup id="S4.p3.12.m8.1.2.3" xref="S4.p3.12.m8.1.2.3.cmml"><mrow id="S4.p3.12.m8.1.2.3.2.2.2" xref="S4.p3.12.m8.1.2.3.2.2.1.cmml"><mo stretchy="false" id="S4.p3.12.m8.1.2.3.2.2.2.1" xref="S4.p3.12.m8.1.2.3.2.2.1.1.cmml">‖</mo><mi id="S4.p3.12.m8.1.1" xref="S4.p3.12.m8.1.1.cmml">𝜽</mi><mo stretchy="false" id="S4.p3.12.m8.1.2.3.2.2.2.2" xref="S4.p3.12.m8.1.2.3.2.2.1.1.cmml">‖</mo></mrow><mn id="S4.p3.12.m8.1.2.3.2.3" xref="S4.p3.12.m8.1.2.3.2.3.cmml">2</mn><mn id="S4.p3.12.m8.1.2.3.3" xref="S4.p3.12.m8.1.2.3.3.cmml">2</mn></msubsup></mrow><annotation-xml encoding="MathML-Content" id="S4.p3.12.m8.1b"><apply id="S4.p3.12.m8.1.2.cmml" xref="S4.p3.12.m8.1.2"><ci id="S4.p3.12.m8.1.2.1.cmml" xref="S4.p3.12.m8.1.2.1">⋅</ci><apply id="S4.p3.12.m8.1.2.2.cmml" xref="S4.p3.12.m8.1.2.2"><csymbol cd="ambiguous" id="S4.p3.12.m8.1.2.2.1.cmml" xref="S4.p3.12.m8.1.2.2">subscript</csymbol><ci id="S4.p3.12.m8.1.2.2.2.cmml" xref="S4.p3.12.m8.1.2.2.2">𝜆</ci><ci id="S4.p3.12.m8.1.2.2.3.cmml" xref="S4.p3.12.m8.1.2.2.3">𝜽</ci></apply><apply id="S4.p3.12.m8.1.2.3.cmml" xref="S4.p3.12.m8.1.2.3"><csymbol cd="ambiguous" id="S4.p3.12.m8.1.2.3.1.cmml" xref="S4.p3.12.m8.1.2.3">superscript</csymbol><apply id="S4.p3.12.m8.1.2.3.2.cmml" xref="S4.p3.12.m8.1.2.3"><csymbol cd="ambiguous" id="S4.p3.12.m8.1.2.3.2.1.cmml" xref="S4.p3.12.m8.1.2.3">subscript</csymbol><apply id="S4.p3.12.m8.1.2.3.2.2.1.cmml" xref="S4.p3.12.m8.1.2.3.2.2.2"><csymbol cd="latexml" id="S4.p3.12.m8.1.2.3.2.2.1.1.cmml" xref="S4.p3.12.m8.1.2.3.2.2.2.1">norm</csymbol><ci id="S4.p3.12.m8.1.1.cmml" xref="S4.p3.12.m8.1.1">𝜽</ci></apply><cn type="integer" id="S4.p3.12.m8.1.2.3.2.3.cmml" xref="S4.p3.12.m8.1.2.3.2.3">2</cn></apply><cn type="integer" id="S4.p3.12.m8.1.2.3.3.cmml" xref="S4.p3.12.m8.1.2.3.3">2</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.p3.12.m8.1c">\lambda_{\boldsymbol{\theta}}\cdot||{\boldsymbol{\theta}}||_{2}^{2}</annotation></semantics></math> is a regularization term.</p>
</div>
</section>
<section id="S5" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">5 </span>Experiments</h2>

<div id="S5.p1" class="ltx_para">
<p id="S5.p1.1" class="ltx_p">We evaluate our model on two recent publicly available visual question answering datasets, both based on MS COCO images. The Toronto COCO-QA Dataset <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib23" title="" class="ltx_ref">23</a>]</cite> contains 78,736 training and 38,948 testing examples, which are generated from 117,684 images. There are four types of questions, relating to the object, number, color and location, all constructed so as to have a single-word answer. All of the question-answer pairs in this dataset are automatically converted from human-sourced image descriptions. Another benchmarked dataset is VQA <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib1" title="" class="ltx_ref">1</a>]</cite>, which is a much larger dataset and contains 614,163 questions and 6,141,630 answers based on 204,721 MS COCO images. This dataset provides a surprising variety of question types, including “What is…’, “How Many” and even “Why…”. The ground truth answers were generated by 10 human subjects and can be single word or sentences. The data train/val split follows the COCO official split, which contains 82,783 training images and 40,504 validation images, each has 3 questions and 10 answers. We randomly choose 5000 images from the validation set as our val set,
with the remainder
testing. The human ground truth answers for the actual VQA test split are not available publicly and only can be evaluated via the VQA evaluation server. Hence, we also apply our final model on a test split and report the overall accuracy. Table <a href="#S5.T1" title="Table 1 ‣ 5.1 Implementation Details ‣ 5 Experiments ‣ Ask Me Anything: Free-form Visual Question Answering Based on Knowledge from External Sources" class="ltx_ref"><span class="ltx_text ltx_ref_tag">1</span></a> displays some dataset statistics.
We did not test on the DAQUAR dataset <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib19" title="" class="ltx_ref">19</a>]</cite> as it is an order of magnitude smaller than the datasets mentioned above, and thus too small to train our system, and to test its generality.</p>
</div>
<section id="S5.SS1" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">5.1 </span>Implementation Details</h3>

<div id="S5.SS1.p1" class="ltx_para">
<p id="S5.SS1.p1.1" class="ltx_p">To train the VQA model with multiple inputs in the Section <a href="#S4" title="4 A VQA Model with Multiple Inputs ‣ Ask Me Anything: Free-form Visual Question Answering Based on Knowledge from External Sources" class="ltx_ref"><span class="ltx_text ltx_ref_tag">4</span></a>, we use Stochastic gradient Descent (SGD) with mini-batches of 100 image-QA pairs. The attributes, internal textual representation, external knowledge embedding size, word embedding size and hidden state size are all 256 in all experiments. The learning rate is set to 0.001 and clip gradients is 5. The dropout rate is set to 0.5.</p>
</div>
<figure id="S5.T1" class="ltx_table">
<div id="S5.T1.1" class="ltx_inline-block ltx_align_center ltx_transformed_outer" style="width:433.6pt;height:278.8pt;vertical-align:-0.0pt;"><span class="ltx_transformed_inner" style="transform:translate(118.8pt,-76.4pt) scale(2.21290974333872,2.21290974333872) ;">
<table id="S5.T1.1.1" class="ltx_tabular ltx_align_middle">
<tr id="S5.T1.1.1.1" class="ltx_tr">
<td id="S5.T1.1.1.1.1" class="ltx_td ltx_align_left"><span class="ltx_rule" style="width:100%;height:0.8pt;background:black;display:inline-block;"> </span></td>
<td id="S5.T1.1.1.1.2" class="ltx_td ltx_align_center"><span id="S5.T1.1.1.1.2.1" class="ltx_text" style="font-size:70%;">Toronto COCO-QA</span></td>
<td id="S5.T1.1.1.1.3" class="ltx_td ltx_align_center"><span id="S5.T1.1.1.1.3.1" class="ltx_text" style="font-size:70%;">VQA</span></td>
</tr>
<tr id="S5.T1.1.1.2" class="ltx_tr">
<td id="S5.T1.1.1.2.1" class="ltx_td ltx_align_left ltx_border_t"><span id="S5.T1.1.1.2.1.1" class="ltx_text" style="font-size:70%;"># Images</span></td>
<td id="S5.T1.1.1.2.2" class="ltx_td ltx_align_center ltx_border_t"><span id="S5.T1.1.1.2.2.1" class="ltx_text" style="font-size:70%;">117,684</span></td>
<td id="S5.T1.1.1.2.3" class="ltx_td ltx_align_center ltx_border_t"><span id="S5.T1.1.1.2.3.1" class="ltx_text" style="font-size:70%;">204,721</span></td>
</tr>
<tr id="S5.T1.1.1.3" class="ltx_tr">
<td id="S5.T1.1.1.3.1" class="ltx_td ltx_align_left"><span id="S5.T1.1.1.3.1.1" class="ltx_text" style="font-size:70%;"># Questions</span></td>
<td id="S5.T1.1.1.3.2" class="ltx_td ltx_align_center"><span id="S5.T1.1.1.3.2.1" class="ltx_text" style="font-size:70%;">117,684</span></td>
<td id="S5.T1.1.1.3.3" class="ltx_td ltx_align_center"><span id="S5.T1.1.1.3.3.1" class="ltx_text" style="font-size:70%;">614,163</span></td>
</tr>
<tr id="S5.T1.1.1.4" class="ltx_tr">
<td id="S5.T1.1.1.4.1" class="ltx_td ltx_align_left"><span id="S5.T1.1.1.4.1.1" class="ltx_text" style="font-size:70%;"># Question Types</span></td>
<td id="S5.T1.1.1.4.2" class="ltx_td ltx_align_center"><span id="S5.T1.1.1.4.2.1" class="ltx_text" style="font-size:70%;">4</span></td>
<td id="S5.T1.1.1.4.3" class="ltx_td ltx_align_center"><span id="S5.T1.1.1.4.3.1" class="ltx_text" style="font-size:70%;">more than 20</span></td>
</tr>
<tr id="S5.T1.1.1.5" class="ltx_tr">
<td id="S5.T1.1.1.5.1" class="ltx_td ltx_align_left"><span id="S5.T1.1.1.5.1.1" class="ltx_text" style="font-size:70%;"># Ans per Que</span></td>
<td id="S5.T1.1.1.5.2" class="ltx_td ltx_align_center"><span id="S5.T1.1.1.5.2.1" class="ltx_text" style="font-size:70%;">1</span></td>
<td id="S5.T1.1.1.5.3" class="ltx_td ltx_align_center"><span id="S5.T1.1.1.5.3.1" class="ltx_text" style="font-size:70%;">10</span></td>
</tr>
<tr id="S5.T1.1.1.6" class="ltx_tr">
<td id="S5.T1.1.1.6.1" class="ltx_td ltx_align_left"><span id="S5.T1.1.1.6.1.1" class="ltx_text" style="font-size:70%;"># Words per Ans</span></td>
<td id="S5.T1.1.1.6.2" class="ltx_td ltx_align_center"><span id="S5.T1.1.1.6.2.1" class="ltx_text" style="font-size:70%;">1</span></td>
<td id="S5.T1.1.1.6.3" class="ltx_td ltx_align_center"><span id="S5.T1.1.1.6.3.1" class="ltx_text" style="font-size:70%;">1 or multiple</span></td>
</tr>
<tr id="S5.T1.1.1.7" class="ltx_tr">
<td id="S5.T1.1.1.7.1" class="ltx_td ltx_align_left"><span class="ltx_rule" style="width:100%;height:0.8pt;background:black;display:inline-block;"> </span></td>
<td id="S5.T1.1.1.7.2" class="ltx_td"></td>
<td id="S5.T1.1.1.7.3" class="ltx_td"></td>
</tr>
</table>
</span></div>
<figcaption class="ltx_caption ltx_centering" style="font-size:70%;"><span class="ltx_tag ltx_tag_table">Table 1: </span>Some statistics about the Toronto COCO-QA Dataset <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib23" title="" class="ltx_ref">23</a>]</cite> and VQA dataset <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib1" title="" class="ltx_ref">1</a>]</cite>.</figcaption>
</figure>
</section>
<section id="S5.SS2" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">5.2 </span>Results on Toronto COCO-QA</h3>

<section id="S5.SS2.SSS0.Px1" class="ltx_paragraph">
<h4 class="ltx_title ltx_title_paragraph">Metrics</h4>

<div id="S5.SS2.SSS0.Px1.p1" class="ltx_para">
<p id="S5.SS2.SSS0.Px1.p1.1" class="ltx_p">Following <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib17" title="" class="ltx_ref">17</a>, <a href="#bib.bib23" title="" class="ltx_ref">23</a>]</cite>, the accuracy value (the proportion of correctly answered test questions),
and the Wu-Palmer similarity (WUPS) <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib31" title="" class="ltx_ref">31</a>]</cite> are used to measure performance. The WUPS calculates the similarity between two words based on the similarity between their common subsequence in the taxonomy tree. If the similarity between two words is greater than a threshold then the candidate answer is considered to be right.
We report on thresholds 0.9 and 0.0, following <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib17" title="" class="ltx_ref">17</a>, <a href="#bib.bib23" title="" class="ltx_ref">23</a>]</cite>.</p>
</div>
<figure id="S5.T2" class="ltx_table">
<div id="S5.T2.1" class="ltx_inline-block ltx_align_center ltx_transformed_outer" style="width:433.6pt;height:503.3pt;vertical-align:-0.0pt;"><span class="ltx_transformed_inner" style="transform:translate(92.8pt,-107.7pt) scale(1.74774197544023,1.74774197544023) ;">
<table id="S5.T2.1.1" class="ltx_tabular ltx_align_middle">
<tr id="S5.T2.1.1.1" class="ltx_tr">
<td id="S5.T2.1.1.1.1" class="ltx_td ltx_align_left ltx_border_r">
<span class="ltx_rule" style="width:100%;height:0.8pt;background:black;display:inline-block;"> </span><span id="S5.T2.1.1.1.1.1" class="ltx_text" style="font-size:70%;">
</span><span id="S5.T2.1.1.1.1.2" class="ltx_text ltx_font_bold" style="font-size:70%;">Toronto COCO-QA</span>
</td>
<td id="S5.T2.1.1.1.2" class="ltx_td ltx_align_center"><span id="S5.T2.1.1.1.2.1" class="ltx_text" style="font-size:70%;">Acc(%)</span></td>
<td id="S5.T2.1.1.1.3" class="ltx_td ltx_align_center"><span id="S5.T2.1.1.1.3.1" class="ltx_text" style="font-size:70%;">WUPS@0.9</span></td>
<td id="S5.T2.1.1.1.4" class="ltx_td ltx_align_center"><span id="S5.T2.1.1.1.4.1" class="ltx_text" style="font-size:70%;">WUPS@0.0</span></td>
</tr>
<tr id="S5.T2.1.1.2" class="ltx_tr">
<td id="S5.T2.1.1.2.1" class="ltx_td ltx_align_left ltx_border_r ltx_border_t">
<span id="S5.T2.1.1.2.1.1" class="ltx_text" style="font-size:70%;">GUESS</span><cite class="ltx_cite ltx_citemacro_cite"><span id="S5.T2.1.1.2.1.2.1" class="ltx_text" style="font-size:70%;">[</span><a href="#bib.bib23" title="" class="ltx_ref">23</a><span id="S5.T2.1.1.2.1.3.2" class="ltx_text" style="font-size:70%;">]</span></cite>
</td>
<td id="S5.T2.1.1.2.2" class="ltx_td ltx_align_center ltx_border_t"><span id="S5.T2.1.1.2.2.1" class="ltx_text" style="font-size:70%;">6.65</span></td>
<td id="S5.T2.1.1.2.3" class="ltx_td ltx_align_center ltx_border_t"><span id="S5.T2.1.1.2.3.1" class="ltx_text" style="font-size:70%;">17.42</span></td>
<td id="S5.T2.1.1.2.4" class="ltx_td ltx_align_center ltx_border_t"><span id="S5.T2.1.1.2.4.1" class="ltx_text" style="font-size:70%;">73.44</span></td>
</tr>
<tr id="S5.T2.1.1.3" class="ltx_tr">
<td id="S5.T2.1.1.3.1" class="ltx_td ltx_align_left ltx_border_r">
<span id="S5.T2.1.1.3.1.1" class="ltx_text" style="font-size:70%;">VIS+BOW</span><cite class="ltx_cite ltx_citemacro_cite"><span id="S5.T2.1.1.3.1.2.1" class="ltx_text" style="font-size:70%;">[</span><a href="#bib.bib23" title="" class="ltx_ref">23</a><span id="S5.T2.1.1.3.1.3.2" class="ltx_text" style="font-size:70%;">]</span></cite>
</td>
<td id="S5.T2.1.1.3.2" class="ltx_td ltx_align_center"><span id="S5.T2.1.1.3.2.1" class="ltx_text" style="font-size:70%;">55.92</span></td>
<td id="S5.T2.1.1.3.3" class="ltx_td ltx_align_center"><span id="S5.T2.1.1.3.3.1" class="ltx_text" style="font-size:70%;">66.78</span></td>
<td id="S5.T2.1.1.3.4" class="ltx_td ltx_align_center"><span id="S5.T2.1.1.3.4.1" class="ltx_text" style="font-size:70%;">88.99</span></td>
</tr>
<tr id="S5.T2.1.1.4" class="ltx_tr">
<td id="S5.T2.1.1.4.1" class="ltx_td ltx_align_left ltx_border_r">
<span id="S5.T2.1.1.4.1.1" class="ltx_text" style="font-size:70%;">VIS+LSTM</span><cite class="ltx_cite ltx_citemacro_cite"><span id="S5.T2.1.1.4.1.2.1" class="ltx_text" style="font-size:70%;">[</span><a href="#bib.bib23" title="" class="ltx_ref">23</a><span id="S5.T2.1.1.4.1.3.2" class="ltx_text" style="font-size:70%;">]</span></cite>
</td>
<td id="S5.T2.1.1.4.2" class="ltx_td ltx_align_center"><span id="S5.T2.1.1.4.2.1" class="ltx_text" style="font-size:70%;">53.31</span></td>
<td id="S5.T2.1.1.4.3" class="ltx_td ltx_align_center"><span id="S5.T2.1.1.4.3.1" class="ltx_text" style="font-size:70%;">63.91</span></td>
<td id="S5.T2.1.1.4.4" class="ltx_td ltx_align_center"><span id="S5.T2.1.1.4.4.1" class="ltx_text" style="font-size:70%;">88.25</span></td>
</tr>
<tr id="S5.T2.1.1.5" class="ltx_tr">
<td id="S5.T2.1.1.5.1" class="ltx_td ltx_align_left ltx_border_r">
<span id="S5.T2.1.1.5.1.1" class="ltx_text" style="font-size:70%;">2-VIS+BLSTM</span><cite class="ltx_cite ltx_citemacro_cite"><span id="S5.T2.1.1.5.1.2.1" class="ltx_text" style="font-size:70%;">[</span><a href="#bib.bib23" title="" class="ltx_ref">23</a><span id="S5.T2.1.1.5.1.3.2" class="ltx_text" style="font-size:70%;">]</span></cite>
</td>
<td id="S5.T2.1.1.5.2" class="ltx_td ltx_align_center"><span id="S5.T2.1.1.5.2.1" class="ltx_text" style="font-size:70%;">55.09</span></td>
<td id="S5.T2.1.1.5.3" class="ltx_td ltx_align_center"><span id="S5.T2.1.1.5.3.1" class="ltx_text" style="font-size:70%;">65.34</span></td>
<td id="S5.T2.1.1.5.4" class="ltx_td ltx_align_center"><span id="S5.T2.1.1.5.4.1" class="ltx_text" style="font-size:70%;">88.64</span></td>
</tr>
<tr id="S5.T2.1.1.6" class="ltx_tr">
<td id="S5.T2.1.1.6.1" class="ltx_td ltx_align_left ltx_border_r">
<span id="S5.T2.1.1.6.1.1" class="ltx_text" style="font-size:70%;">Ma et al.</span><cite class="ltx_cite ltx_citemacro_cite"><span id="S5.T2.1.1.6.1.2.1" class="ltx_text" style="font-size:70%;">[</span><a href="#bib.bib17" title="" class="ltx_ref">17</a><span id="S5.T2.1.1.6.1.3.2" class="ltx_text" style="font-size:70%;">]</span></cite>
</td>
<td id="S5.T2.1.1.6.2" class="ltx_td ltx_align_center"><span id="S5.T2.1.1.6.2.1" class="ltx_text" style="font-size:70%;">54.94</span></td>
<td id="S5.T2.1.1.6.3" class="ltx_td ltx_align_center"><span id="S5.T2.1.1.6.3.1" class="ltx_text" style="font-size:70%;">65.36</span></td>
<td id="S5.T2.1.1.6.4" class="ltx_td ltx_align_center"><span id="S5.T2.1.1.6.4.1" class="ltx_text" style="font-size:70%;">88.58</span></td>
</tr>
<tr id="S5.T2.1.1.7" class="ltx_tr">
<td id="S5.T2.1.1.7.1" class="ltx_td ltx_align_left ltx_border_r">
<span class="ltx_rule" style="width:100%;height:0.8pt;background:black;display:inline-block;"> </span><span id="S5.T2.1.1.7.1.1" class="ltx_text" style="font-size:70%;">
</span><span id="S5.T2.1.1.7.1.2" class="ltx_text ltx_font_bold" style="font-size:70%;">Baseline</span>
</td>
<td id="S5.T2.1.1.7.2" class="ltx_td"></td>
<td id="S5.T2.1.1.7.3" class="ltx_td"></td>
<td id="S5.T2.1.1.7.4" class="ltx_td"></td>
</tr>
<tr id="S5.T2.1.1.8" class="ltx_tr">
<td id="S5.T2.1.1.8.1" class="ltx_td ltx_align_left ltx_border_r ltx_border_t"><span id="S5.T2.1.1.8.1.1" class="ltx_text" style="font-size:70%;">VggNet-LSTM</span></td>
<td id="S5.T2.1.1.8.2" class="ltx_td ltx_align_center ltx_border_t"><span id="S5.T2.1.1.8.2.1" class="ltx_text" style="font-size:70%;">50.73</span></td>
<td id="S5.T2.1.1.8.3" class="ltx_td ltx_align_center ltx_border_t"><span id="S5.T2.1.1.8.3.1" class="ltx_text" style="font-size:70%;">60.37</span></td>
<td id="S5.T2.1.1.8.4" class="ltx_td ltx_align_center ltx_border_t"><span id="S5.T2.1.1.8.4.1" class="ltx_text" style="font-size:70%;">87.48</span></td>
</tr>
<tr id="S5.T2.1.1.9" class="ltx_tr">
<td id="S5.T2.1.1.9.1" class="ltx_td ltx_align_left ltx_border_r"><span id="S5.T2.1.1.9.1.1" class="ltx_text" style="font-size:70%;">VggNet+ft-LSTM</span></td>
<td id="S5.T2.1.1.9.2" class="ltx_td ltx_align_center"><span id="S5.T2.1.1.9.2.1" class="ltx_text" style="font-size:70%;">58.34</span></td>
<td id="S5.T2.1.1.9.3" class="ltx_td ltx_align_center"><span id="S5.T2.1.1.9.3.1" class="ltx_text" style="font-size:70%;">67.32</span></td>
<td id="S5.T2.1.1.9.4" class="ltx_td ltx_align_center"><span id="S5.T2.1.1.9.4.1" class="ltx_text" style="font-size:70%;">89.13</span></td>
</tr>
<tr id="S5.T2.1.1.10" class="ltx_tr">
<td id="S5.T2.1.1.10.1" class="ltx_td ltx_align_left ltx_border_r">
<span class="ltx_rule" style="width:100%;height:0.8pt;background:black;display:inline-block;"> </span><span id="S5.T2.1.1.10.1.1" class="ltx_text" style="font-size:70%;">
</span><span id="S5.T2.1.1.10.1.2" class="ltx_text ltx_font_bold" style="font-size:70%;">Our-Proposal</span>
</td>
<td id="S5.T2.1.1.10.2" class="ltx_td"></td>
<td id="S5.T2.1.1.10.3" class="ltx_td"></td>
<td id="S5.T2.1.1.10.4" class="ltx_td"></td>
</tr>
<tr id="S5.T2.1.1.11" class="ltx_tr">
<td id="S5.T2.1.1.11.1" class="ltx_td ltx_align_left ltx_border_r ltx_border_t"><span id="S5.T2.1.1.11.1.1" class="ltx_text" style="font-size:70%;">Att-LSTM</span></td>
<td id="S5.T2.1.1.11.2" class="ltx_td ltx_align_center ltx_border_t"><span id="S5.T2.1.1.11.2.1" class="ltx_text" style="font-size:70%;">61.38</span></td>
<td id="S5.T2.1.1.11.3" class="ltx_td ltx_align_center ltx_border_t"><span id="S5.T2.1.1.11.3.1" class="ltx_text" style="font-size:70%;">71.15</span></td>
<td id="S5.T2.1.1.11.4" class="ltx_td ltx_align_center ltx_border_t"><span id="S5.T2.1.1.11.4.1" class="ltx_text" style="font-size:70%;">91.58</span></td>
</tr>
<tr id="S5.T2.1.1.12" class="ltx_tr">
<td id="S5.T2.1.1.12.1" class="ltx_td ltx_align_left ltx_border_r"><span id="S5.T2.1.1.12.1.1" class="ltx_text" style="font-size:70%;">Att+Cap-LSTM</span></td>
<td id="S5.T2.1.1.12.2" class="ltx_td ltx_align_center"><span id="S5.T2.1.1.12.2.1" class="ltx_text" style="font-size:70%;">69.02</span></td>
<td id="S5.T2.1.1.12.3" class="ltx_td ltx_align_center"><span id="S5.T2.1.1.12.3.1" class="ltx_text" style="font-size:70%;">76.20</span></td>
<td id="S5.T2.1.1.12.4" class="ltx_td ltx_align_center"><span id="S5.T2.1.1.12.4.1" class="ltx_text" style="font-size:70%;">92.38</span></td>
</tr>
<tr id="S5.T2.1.1.13" class="ltx_tr">
<td id="S5.T2.1.1.13.1" class="ltx_td ltx_align_left ltx_border_r"><span id="S5.T2.1.1.13.1.1" class="ltx_text" style="font-size:70%;">Att+Know-LSTM</span></td>
<td id="S5.T2.1.1.13.2" class="ltx_td ltx_align_center"><span id="S5.T2.1.1.13.2.1" class="ltx_text" style="font-size:70%;">63.07</span></td>
<td id="S5.T2.1.1.13.3" class="ltx_td ltx_align_center"><span id="S5.T2.1.1.13.3.1" class="ltx_text" style="font-size:70%;">72.22</span></td>
<td id="S5.T2.1.1.13.4" class="ltx_td ltx_align_center"><span id="S5.T2.1.1.13.4.1" class="ltx_text" style="font-size:70%;">90.84</span></td>
</tr>
<tr id="S5.T2.1.1.14" class="ltx_tr">
<td id="S5.T2.1.1.14.1" class="ltx_td ltx_align_left ltx_border_r"><span id="S5.T2.1.1.14.1.1" class="ltx_text" style="font-size:70%;">Cap+Know-LSTM</span></td>
<td id="S5.T2.1.1.14.2" class="ltx_td ltx_align_center"><span id="S5.T2.1.1.14.2.1" class="ltx_text" style="font-size:70%;">64.31</span></td>
<td id="S5.T2.1.1.14.3" class="ltx_td ltx_align_center"><span id="S5.T2.1.1.14.3.1" class="ltx_text" style="font-size:70%;">73.31</span></td>
<td id="S5.T2.1.1.14.4" class="ltx_td ltx_align_center"><span id="S5.T2.1.1.14.4.1" class="ltx_text" style="font-size:70%;">90.01</span></td>
</tr>
<tr id="S5.T2.1.1.15" class="ltx_tr">
<td id="S5.T2.1.1.15.1" class="ltx_td ltx_align_left ltx_border_r"><span id="S5.T2.1.1.15.1.1" class="ltx_text" style="font-size:70%;">Att+Cap+Know-LSTM</span></td>
<td id="S5.T2.1.1.15.2" class="ltx_td ltx_align_center"><span id="S5.T2.1.1.15.2.1" class="ltx_text ltx_font_bold" style="font-size:70%;">69.73</span></td>
<td id="S5.T2.1.1.15.3" class="ltx_td ltx_align_center"><span id="S5.T2.1.1.15.3.1" class="ltx_text ltx_font_bold" style="font-size:70%;">77.14</span></td>
<td id="S5.T2.1.1.15.4" class="ltx_td ltx_align_center"><span id="S5.T2.1.1.15.4.1" class="ltx_text ltx_font_bold" style="font-size:70%;">92.50</span></td>
</tr>
<tr id="S5.T2.1.1.16" class="ltx_tr">
<td id="S5.T2.1.1.16.1" class="ltx_td ltx_align_left ltx_border_r"><span class="ltx_rule" style="width:100%;height:0.8pt;background:black;display:inline-block;"> </span></td>
<td id="S5.T2.1.1.16.2" class="ltx_td"></td>
<td id="S5.T2.1.1.16.3" class="ltx_td"></td>
<td id="S5.T2.1.1.16.4" class="ltx_td"></td>
</tr>
</table>
</span></div>
<figcaption class="ltx_caption ltx_centering" style="font-size:70%;"><span class="ltx_tag ltx_tag_table">Table 2: </span>Accuracy, WUPS metrics compared to other state-of-the-art methods and our baseline on Toronto COCO-QA dataset.</figcaption>
</figure>
</section>
<section id="S5.SS2.SSS0.Px2" class="ltx_paragraph">
<h4 class="ltx_title ltx_title_paragraph">Evaluations</h4>

<div id="S5.SS2.SSS0.Px2.p1" class="ltx_para">
<p id="S5.SS2.SSS0.Px2.p1.4" class="ltx_p">To illustrate the effectiveness of our model, we provide a baseline and several state-of-the-art results on the Toronto COCO-QA dataset. The <span id="S5.SS2.SSS0.Px2.p1.4.1" class="ltx_text ltx_font_bold">Baseline</span> method is implemented simply by connecting a CNN to an LSTM. The CNN is a pre-trained (on ImageNet) VggNet model
from which we extract the coefficients of the last fully connected layer.
We also implement a baseline model <span id="S5.SS2.SSS0.Px2.p1.4.2" class="ltx_text ltx_font_bold">VggNet+ft-LSTM</span>, which applies a VggNet that has been fine-tuned on the COCO dataset, based on the task of image-attributes classification.
We also present results from a series of cut down versions of our approach for comparison.
<span id="S5.SS2.SSS0.Px2.p1.4.3" class="ltx_text ltx_font_bold">Att-LSTM</span> uses only the semantic level attribute representation <math id="S5.SS2.SSS0.Px2.p1.1.m1.1" class="ltx_Math" alttext="{V_{att}}" display="inline"><semantics id="S5.SS2.SSS0.Px2.p1.1.m1.1a"><msub id="S5.SS2.SSS0.Px2.p1.1.m1.1.1" xref="S5.SS2.SSS0.Px2.p1.1.m1.1.1.cmml"><mi id="S5.SS2.SSS0.Px2.p1.1.m1.1.1.2" xref="S5.SS2.SSS0.Px2.p1.1.m1.1.1.2.cmml">V</mi><mrow id="S5.SS2.SSS0.Px2.p1.1.m1.1.1.3" xref="S5.SS2.SSS0.Px2.p1.1.m1.1.1.3.cmml"><mi id="S5.SS2.SSS0.Px2.p1.1.m1.1.1.3.2" xref="S5.SS2.SSS0.Px2.p1.1.m1.1.1.3.2.cmml">a</mi><mo lspace="0em" rspace="0em" id="S5.SS2.SSS0.Px2.p1.1.m1.1.1.3.1" xref="S5.SS2.SSS0.Px2.p1.1.m1.1.1.3.1.cmml">​</mo><mi id="S5.SS2.SSS0.Px2.p1.1.m1.1.1.3.3" xref="S5.SS2.SSS0.Px2.p1.1.m1.1.1.3.3.cmml">t</mi><mo lspace="0em" rspace="0em" id="S5.SS2.SSS0.Px2.p1.1.m1.1.1.3.1a" xref="S5.SS2.SSS0.Px2.p1.1.m1.1.1.3.1.cmml">​</mo><mi id="S5.SS2.SSS0.Px2.p1.1.m1.1.1.3.4" xref="S5.SS2.SSS0.Px2.p1.1.m1.1.1.3.4.cmml">t</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S5.SS2.SSS0.Px2.p1.1.m1.1b"><apply id="S5.SS2.SSS0.Px2.p1.1.m1.1.1.cmml" xref="S5.SS2.SSS0.Px2.p1.1.m1.1.1"><csymbol cd="ambiguous" id="S5.SS2.SSS0.Px2.p1.1.m1.1.1.1.cmml" xref="S5.SS2.SSS0.Px2.p1.1.m1.1.1">subscript</csymbol><ci id="S5.SS2.SSS0.Px2.p1.1.m1.1.1.2.cmml" xref="S5.SS2.SSS0.Px2.p1.1.m1.1.1.2">𝑉</ci><apply id="S5.SS2.SSS0.Px2.p1.1.m1.1.1.3.cmml" xref="S5.SS2.SSS0.Px2.p1.1.m1.1.1.3"><times id="S5.SS2.SSS0.Px2.p1.1.m1.1.1.3.1.cmml" xref="S5.SS2.SSS0.Px2.p1.1.m1.1.1.3.1"></times><ci id="S5.SS2.SSS0.Px2.p1.1.m1.1.1.3.2.cmml" xref="S5.SS2.SSS0.Px2.p1.1.m1.1.1.3.2">𝑎</ci><ci id="S5.SS2.SSS0.Px2.p1.1.m1.1.1.3.3.cmml" xref="S5.SS2.SSS0.Px2.p1.1.m1.1.1.3.3">𝑡</ci><ci id="S5.SS2.SSS0.Px2.p1.1.m1.1.1.3.4.cmml" xref="S5.SS2.SSS0.Px2.p1.1.m1.1.1.3.4">𝑡</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS2.SSS0.Px2.p1.1.m1.1c">{V_{att}}</annotation></semantics></math> as the LSTM input. To evaluate the contribution of the internal textual representation and external knowledge for the question answering, we feed the image caption representation <math id="S5.SS2.SSS0.Px2.p1.2.m2.1" class="ltx_Math" alttext="{V_{cap}}" display="inline"><semantics id="S5.SS2.SSS0.Px2.p1.2.m2.1a"><msub id="S5.SS2.SSS0.Px2.p1.2.m2.1.1" xref="S5.SS2.SSS0.Px2.p1.2.m2.1.1.cmml"><mi id="S5.SS2.SSS0.Px2.p1.2.m2.1.1.2" xref="S5.SS2.SSS0.Px2.p1.2.m2.1.1.2.cmml">V</mi><mrow id="S5.SS2.SSS0.Px2.p1.2.m2.1.1.3" xref="S5.SS2.SSS0.Px2.p1.2.m2.1.1.3.cmml"><mi id="S5.SS2.SSS0.Px2.p1.2.m2.1.1.3.2" xref="S5.SS2.SSS0.Px2.p1.2.m2.1.1.3.2.cmml">c</mi><mo lspace="0em" rspace="0em" id="S5.SS2.SSS0.Px2.p1.2.m2.1.1.3.1" xref="S5.SS2.SSS0.Px2.p1.2.m2.1.1.3.1.cmml">​</mo><mi id="S5.SS2.SSS0.Px2.p1.2.m2.1.1.3.3" xref="S5.SS2.SSS0.Px2.p1.2.m2.1.1.3.3.cmml">a</mi><mo lspace="0em" rspace="0em" id="S5.SS2.SSS0.Px2.p1.2.m2.1.1.3.1a" xref="S5.SS2.SSS0.Px2.p1.2.m2.1.1.3.1.cmml">​</mo><mi id="S5.SS2.SSS0.Px2.p1.2.m2.1.1.3.4" xref="S5.SS2.SSS0.Px2.p1.2.m2.1.1.3.4.cmml">p</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S5.SS2.SSS0.Px2.p1.2.m2.1b"><apply id="S5.SS2.SSS0.Px2.p1.2.m2.1.1.cmml" xref="S5.SS2.SSS0.Px2.p1.2.m2.1.1"><csymbol cd="ambiguous" id="S5.SS2.SSS0.Px2.p1.2.m2.1.1.1.cmml" xref="S5.SS2.SSS0.Px2.p1.2.m2.1.1">subscript</csymbol><ci id="S5.SS2.SSS0.Px2.p1.2.m2.1.1.2.cmml" xref="S5.SS2.SSS0.Px2.p1.2.m2.1.1.2">𝑉</ci><apply id="S5.SS2.SSS0.Px2.p1.2.m2.1.1.3.cmml" xref="S5.SS2.SSS0.Px2.p1.2.m2.1.1.3"><times id="S5.SS2.SSS0.Px2.p1.2.m2.1.1.3.1.cmml" xref="S5.SS2.SSS0.Px2.p1.2.m2.1.1.3.1"></times><ci id="S5.SS2.SSS0.Px2.p1.2.m2.1.1.3.2.cmml" xref="S5.SS2.SSS0.Px2.p1.2.m2.1.1.3.2">𝑐</ci><ci id="S5.SS2.SSS0.Px2.p1.2.m2.1.1.3.3.cmml" xref="S5.SS2.SSS0.Px2.p1.2.m2.1.1.3.3">𝑎</ci><ci id="S5.SS2.SSS0.Px2.p1.2.m2.1.1.3.4.cmml" xref="S5.SS2.SSS0.Px2.p1.2.m2.1.1.3.4">𝑝</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS2.SSS0.Px2.p1.2.m2.1c">{V_{cap}}</annotation></semantics></math> and knowledge representation <math id="S5.SS2.SSS0.Px2.p1.3.m3.1" class="ltx_Math" alttext="{V_{know}}" display="inline"><semantics id="S5.SS2.SSS0.Px2.p1.3.m3.1a"><msub id="S5.SS2.SSS0.Px2.p1.3.m3.1.1" xref="S5.SS2.SSS0.Px2.p1.3.m3.1.1.cmml"><mi id="S5.SS2.SSS0.Px2.p1.3.m3.1.1.2" xref="S5.SS2.SSS0.Px2.p1.3.m3.1.1.2.cmml">V</mi><mrow id="S5.SS2.SSS0.Px2.p1.3.m3.1.1.3" xref="S5.SS2.SSS0.Px2.p1.3.m3.1.1.3.cmml"><mi id="S5.SS2.SSS0.Px2.p1.3.m3.1.1.3.2" xref="S5.SS2.SSS0.Px2.p1.3.m3.1.1.3.2.cmml">k</mi><mo lspace="0em" rspace="0em" id="S5.SS2.SSS0.Px2.p1.3.m3.1.1.3.1" xref="S5.SS2.SSS0.Px2.p1.3.m3.1.1.3.1.cmml">​</mo><mi id="S5.SS2.SSS0.Px2.p1.3.m3.1.1.3.3" xref="S5.SS2.SSS0.Px2.p1.3.m3.1.1.3.3.cmml">n</mi><mo lspace="0em" rspace="0em" id="S5.SS2.SSS0.Px2.p1.3.m3.1.1.3.1a" xref="S5.SS2.SSS0.Px2.p1.3.m3.1.1.3.1.cmml">​</mo><mi id="S5.SS2.SSS0.Px2.p1.3.m3.1.1.3.4" xref="S5.SS2.SSS0.Px2.p1.3.m3.1.1.3.4.cmml">o</mi><mo lspace="0em" rspace="0em" id="S5.SS2.SSS0.Px2.p1.3.m3.1.1.3.1b" xref="S5.SS2.SSS0.Px2.p1.3.m3.1.1.3.1.cmml">​</mo><mi id="S5.SS2.SSS0.Px2.p1.3.m3.1.1.3.5" xref="S5.SS2.SSS0.Px2.p1.3.m3.1.1.3.5.cmml">w</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S5.SS2.SSS0.Px2.p1.3.m3.1b"><apply id="S5.SS2.SSS0.Px2.p1.3.m3.1.1.cmml" xref="S5.SS2.SSS0.Px2.p1.3.m3.1.1"><csymbol cd="ambiguous" id="S5.SS2.SSS0.Px2.p1.3.m3.1.1.1.cmml" xref="S5.SS2.SSS0.Px2.p1.3.m3.1.1">subscript</csymbol><ci id="S5.SS2.SSS0.Px2.p1.3.m3.1.1.2.cmml" xref="S5.SS2.SSS0.Px2.p1.3.m3.1.1.2">𝑉</ci><apply id="S5.SS2.SSS0.Px2.p1.3.m3.1.1.3.cmml" xref="S5.SS2.SSS0.Px2.p1.3.m3.1.1.3"><times id="S5.SS2.SSS0.Px2.p1.3.m3.1.1.3.1.cmml" xref="S5.SS2.SSS0.Px2.p1.3.m3.1.1.3.1"></times><ci id="S5.SS2.SSS0.Px2.p1.3.m3.1.1.3.2.cmml" xref="S5.SS2.SSS0.Px2.p1.3.m3.1.1.3.2">𝑘</ci><ci id="S5.SS2.SSS0.Px2.p1.3.m3.1.1.3.3.cmml" xref="S5.SS2.SSS0.Px2.p1.3.m3.1.1.3.3">𝑛</ci><ci id="S5.SS2.SSS0.Px2.p1.3.m3.1.1.3.4.cmml" xref="S5.SS2.SSS0.Px2.p1.3.m3.1.1.3.4">𝑜</ci><ci id="S5.SS2.SSS0.Px2.p1.3.m3.1.1.3.5.cmml" xref="S5.SS2.SSS0.Px2.p1.3.m3.1.1.3.5">𝑤</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS2.SSS0.Px2.p1.3.m3.1c">{V_{know}}</annotation></semantics></math> with the <math id="S5.SS2.SSS0.Px2.p1.4.m4.1" class="ltx_Math" alttext="{V_{att}}" display="inline"><semantics id="S5.SS2.SSS0.Px2.p1.4.m4.1a"><msub id="S5.SS2.SSS0.Px2.p1.4.m4.1.1" xref="S5.SS2.SSS0.Px2.p1.4.m4.1.1.cmml"><mi id="S5.SS2.SSS0.Px2.p1.4.m4.1.1.2" xref="S5.SS2.SSS0.Px2.p1.4.m4.1.1.2.cmml">V</mi><mrow id="S5.SS2.SSS0.Px2.p1.4.m4.1.1.3" xref="S5.SS2.SSS0.Px2.p1.4.m4.1.1.3.cmml"><mi id="S5.SS2.SSS0.Px2.p1.4.m4.1.1.3.2" xref="S5.SS2.SSS0.Px2.p1.4.m4.1.1.3.2.cmml">a</mi><mo lspace="0em" rspace="0em" id="S5.SS2.SSS0.Px2.p1.4.m4.1.1.3.1" xref="S5.SS2.SSS0.Px2.p1.4.m4.1.1.3.1.cmml">​</mo><mi id="S5.SS2.SSS0.Px2.p1.4.m4.1.1.3.3" xref="S5.SS2.SSS0.Px2.p1.4.m4.1.1.3.3.cmml">t</mi><mo lspace="0em" rspace="0em" id="S5.SS2.SSS0.Px2.p1.4.m4.1.1.3.1a" xref="S5.SS2.SSS0.Px2.p1.4.m4.1.1.3.1.cmml">​</mo><mi id="S5.SS2.SSS0.Px2.p1.4.m4.1.1.3.4" xref="S5.SS2.SSS0.Px2.p1.4.m4.1.1.3.4.cmml">t</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S5.SS2.SSS0.Px2.p1.4.m4.1b"><apply id="S5.SS2.SSS0.Px2.p1.4.m4.1.1.cmml" xref="S5.SS2.SSS0.Px2.p1.4.m4.1.1"><csymbol cd="ambiguous" id="S5.SS2.SSS0.Px2.p1.4.m4.1.1.1.cmml" xref="S5.SS2.SSS0.Px2.p1.4.m4.1.1">subscript</csymbol><ci id="S5.SS2.SSS0.Px2.p1.4.m4.1.1.2.cmml" xref="S5.SS2.SSS0.Px2.p1.4.m4.1.1.2">𝑉</ci><apply id="S5.SS2.SSS0.Px2.p1.4.m4.1.1.3.cmml" xref="S5.SS2.SSS0.Px2.p1.4.m4.1.1.3"><times id="S5.SS2.SSS0.Px2.p1.4.m4.1.1.3.1.cmml" xref="S5.SS2.SSS0.Px2.p1.4.m4.1.1.3.1"></times><ci id="S5.SS2.SSS0.Px2.p1.4.m4.1.1.3.2.cmml" xref="S5.SS2.SSS0.Px2.p1.4.m4.1.1.3.2">𝑎</ci><ci id="S5.SS2.SSS0.Px2.p1.4.m4.1.1.3.3.cmml" xref="S5.SS2.SSS0.Px2.p1.4.m4.1.1.3.3">𝑡</ci><ci id="S5.SS2.SSS0.Px2.p1.4.m4.1.1.3.4.cmml" xref="S5.SS2.SSS0.Px2.p1.4.m4.1.1.3.4">𝑡</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS2.SSS0.Px2.p1.4.m4.1c">{V_{att}}</annotation></semantics></math> separately, producing two models, <span id="S5.SS2.SSS0.Px2.p1.4.4" class="ltx_text ltx_font_bold">Att+Cap-LSTM</span> and <span id="S5.SS2.SSS0.Px2.p1.4.5" class="ltx_text ltx_font_bold">Att+Know-LSTM</span>. We also tested the <span id="S5.SS2.SSS0.Px2.p1.4.6" class="ltx_text ltx_font_bold">Cap+Know-LSTM</span>, for the experiment completeness. Our final model is the <span id="S5.SS2.SSS0.Px2.p1.4.7" class="ltx_text ltx_font_bold">Att+Cap+Know-LSTM</span>, which combines all the available information.</p>
</div>
<div id="S5.SS2.SSS0.Px2.p2" class="ltx_para">
<p id="S5.SS2.SSS0.Px2.p2.1" class="ltx_p"><span id="S5.SS2.SSS0.Px2.p2.1.1" class="ltx_text ltx_font_bold">GUESS</span> <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib23" title="" class="ltx_ref">23</a>]</cite> simply selects the modal answer from the training set for each of 4 question types (the modal answers are ‘cat’, ‘two’, ‘white’, and ‘room’).
<span id="S5.SS2.SSS0.Px2.p2.1.2" class="ltx_text ltx_font_bold">VIS+BOW</span> <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib23" title="" class="ltx_ref">23</a>]</cite> performs multinomial logistic regression based on image features and a BOW vector obtained by summing all the word vectors of the question. <span id="S5.SS2.SSS0.Px2.p2.1.3" class="ltx_text ltx_font_bold">VIS+LSTM</span> <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib23" title="" class="ltx_ref">23</a>]</cite> has one LSTM to encode the image and question, while <span id="S5.SS2.SSS0.Px2.p2.1.4" class="ltx_text ltx_font_bold">2-VIS+BLSTM</span> <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib23" title="" class="ltx_ref">23</a>]</cite> has two image feature inputs, at the start and the end. Ma <span id="S5.SS2.SSS0.Px2.p2.1.5" class="ltx_text ltx_font_italic">et al.</span> <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib17" title="" class="ltx_ref">17</a>]</cite> encode both images and questions with a CNN.</p>
</div>
<figure id="S5.T3" class="ltx_table">
<div id="S5.T3.1" class="ltx_inline-block ltx_transformed_outer" style="width:433.6pt;height:520.5pt;vertical-align:-0.0pt;"><span class="ltx_transformed_inner" style="transform:translate(104.3pt,-125.3pt) scale(1.92781706383879,1.92781706383879) ;">
<table id="S5.T3.1.1" class="ltx_tabular ltx_align_middle">
<tr id="S5.T3.1.1.1" class="ltx_tr">
<td id="S5.T3.1.1.1.1" class="ltx_td ltx_align_left ltx_border_r">
<span class="ltx_rule" style="width:100%;height:0.8pt;background:black;display:inline-block;"> </span><span id="S5.T3.1.1.1.1.1" class="ltx_text" style="font-size:70%;">
</span><span id="S5.T3.1.1.1.1.2" class="ltx_text ltx_font_bold" style="font-size:70%;">COCO-QA</span>
</td>
<td id="S5.T3.1.1.1.2" class="ltx_td ltx_align_center"><span id="S5.T3.1.1.1.2.1" class="ltx_text" style="font-size:70%;">Object</span></td>
<td id="S5.T3.1.1.1.3" class="ltx_td ltx_align_center"><span id="S5.T3.1.1.1.3.1" class="ltx_text" style="font-size:70%;">Number</span></td>
<td id="S5.T3.1.1.1.4" class="ltx_td ltx_align_center"><span id="S5.T3.1.1.1.4.1" class="ltx_text" style="font-size:70%;">Color</span></td>
<td id="S5.T3.1.1.1.5" class="ltx_td ltx_align_center"><span id="S5.T3.1.1.1.5.1" class="ltx_text" style="font-size:70%;">Location</span></td>
</tr>
<tr id="S5.T3.1.1.2" class="ltx_tr">
<td id="S5.T3.1.1.2.1" class="ltx_td ltx_align_left ltx_border_r ltx_border_t"><span id="S5.T3.1.1.2.1.1" class="ltx_text" style="font-size:70%;">GUESS</span></td>
<td id="S5.T3.1.1.2.2" class="ltx_td ltx_align_center ltx_border_t"><span id="S5.T3.1.1.2.2.1" class="ltx_text" style="font-size:70%;">2.11</span></td>
<td id="S5.T3.1.1.2.3" class="ltx_td ltx_align_center ltx_border_t"><span id="S5.T3.1.1.2.3.1" class="ltx_text" style="font-size:70%;">35.84</span></td>
<td id="S5.T3.1.1.2.4" class="ltx_td ltx_align_center ltx_border_t"><span id="S5.T3.1.1.2.4.1" class="ltx_text" style="font-size:70%;">13.87</span></td>
<td id="S5.T3.1.1.2.5" class="ltx_td ltx_align_center ltx_border_t"><span id="S5.T3.1.1.2.5.1" class="ltx_text" style="font-size:70%;">8.93</span></td>
</tr>
<tr id="S5.T3.1.1.3" class="ltx_tr">
<td id="S5.T3.1.1.3.1" class="ltx_td ltx_align_left ltx_border_r"><span id="S5.T3.1.1.3.1.1" class="ltx_text" style="font-size:70%;">VIS+BOW</span></td>
<td id="S5.T3.1.1.3.2" class="ltx_td ltx_align_center"><span id="S5.T3.1.1.3.2.1" class="ltx_text" style="font-size:70%;">58.66</span></td>
<td id="S5.T3.1.1.3.3" class="ltx_td ltx_align_center"><span id="S5.T3.1.1.3.3.1" class="ltx_text" style="font-size:70%;">44.10</span></td>
<td id="S5.T3.1.1.3.4" class="ltx_td ltx_align_center"><span id="S5.T3.1.1.3.4.1" class="ltx_text" style="font-size:70%;">51.96</span></td>
<td id="S5.T3.1.1.3.5" class="ltx_td ltx_align_center"><span id="S5.T3.1.1.3.5.1" class="ltx_text" style="font-size:70%;">49.39</span></td>
</tr>
<tr id="S5.T3.1.1.4" class="ltx_tr">
<td id="S5.T3.1.1.4.1" class="ltx_td ltx_align_left ltx_border_r"><span id="S5.T3.1.1.4.1.1" class="ltx_text" style="font-size:70%;">VIS+LSTM</span></td>
<td id="S5.T3.1.1.4.2" class="ltx_td ltx_align_center"><span id="S5.T3.1.1.4.2.1" class="ltx_text" style="font-size:70%;">56.53</span></td>
<td id="S5.T3.1.1.4.3" class="ltx_td ltx_align_center"><span id="S5.T3.1.1.4.3.1" class="ltx_text" style="font-size:70%;">46.10</span></td>
<td id="S5.T3.1.1.4.4" class="ltx_td ltx_align_center"><span id="S5.T3.1.1.4.4.1" class="ltx_text" style="font-size:70%;">45.87</span></td>
<td id="S5.T3.1.1.4.5" class="ltx_td ltx_align_center"><span id="S5.T3.1.1.4.5.1" class="ltx_text" style="font-size:70%;">45.52</span></td>
</tr>
<tr id="S5.T3.1.1.5" class="ltx_tr">
<td id="S5.T3.1.1.5.1" class="ltx_td ltx_align_left ltx_border_r"><span id="S5.T3.1.1.5.1.1" class="ltx_text" style="font-size:70%;">2-VIS+BLSTM</span></td>
<td id="S5.T3.1.1.5.2" class="ltx_td ltx_align_center"><span id="S5.T3.1.1.5.2.1" class="ltx_text" style="font-size:70%;">58.17</span></td>
<td id="S5.T3.1.1.5.3" class="ltx_td ltx_align_center"><span id="S5.T3.1.1.5.3.1" class="ltx_text" style="font-size:70%;">44.79</span></td>
<td id="S5.T3.1.1.5.4" class="ltx_td ltx_align_center"><span id="S5.T3.1.1.5.4.1" class="ltx_text" style="font-size:70%;">49.53</span></td>
<td id="S5.T3.1.1.5.5" class="ltx_td ltx_align_center"><span id="S5.T3.1.1.5.5.1" class="ltx_text" style="font-size:70%;">47.34</span></td>
</tr>
<tr id="S5.T3.1.1.6" class="ltx_tr">
<td id="S5.T3.1.1.6.1" class="ltx_td ltx_align_left ltx_border_r">
<span class="ltx_rule" style="width:100%;height:0.8pt;background:black;display:inline-block;"> </span><span id="S5.T3.1.1.6.1.1" class="ltx_text" style="font-size:70%;">
</span><span id="S5.T3.1.1.6.1.2" class="ltx_text ltx_font_bold" style="font-size:70%;">Baseline</span>
</td>
<td id="S5.T3.1.1.6.2" class="ltx_td"></td>
<td id="S5.T3.1.1.6.3" class="ltx_td"></td>
<td id="S5.T3.1.1.6.4" class="ltx_td"></td>
<td id="S5.T3.1.1.6.5" class="ltx_td"></td>
</tr>
<tr id="S5.T3.1.1.7" class="ltx_tr">
<td id="S5.T3.1.1.7.1" class="ltx_td ltx_align_left ltx_border_r ltx_border_t"><span id="S5.T3.1.1.7.1.1" class="ltx_text" style="font-size:70%;">VggNet-LSTM</span></td>
<td id="S5.T3.1.1.7.2" class="ltx_td ltx_align_center ltx_border_t"><span id="S5.T3.1.1.7.2.1" class="ltx_text" style="font-size:70%;">53.71</span></td>
<td id="S5.T3.1.1.7.3" class="ltx_td ltx_align_center ltx_border_t"><span id="S5.T3.1.1.7.3.1" class="ltx_text" style="font-size:70%;">45.37</span></td>
<td id="S5.T3.1.1.7.4" class="ltx_td ltx_align_center ltx_border_t"><span id="S5.T3.1.1.7.4.1" class="ltx_text" style="font-size:70%;">36.23</span></td>
<td id="S5.T3.1.1.7.5" class="ltx_td ltx_align_center ltx_border_t"><span id="S5.T3.1.1.7.5.1" class="ltx_text" style="font-size:70%;">46.37</span></td>
</tr>
<tr id="S5.T3.1.1.8" class="ltx_tr">
<td id="S5.T3.1.1.8.1" class="ltx_td ltx_align_left ltx_border_r"><span id="S5.T3.1.1.8.1.1" class="ltx_text" style="font-size:70%;">VggNet+ft-LSTM</span></td>
<td id="S5.T3.1.1.8.2" class="ltx_td ltx_align_center"><span id="S5.T3.1.1.8.2.1" class="ltx_text" style="font-size:70%;">61.67</span></td>
<td id="S5.T3.1.1.8.3" class="ltx_td ltx_align_center"><span id="S5.T3.1.1.8.3.1" class="ltx_text" style="font-size:70%;">50.04</span></td>
<td id="S5.T3.1.1.8.4" class="ltx_td ltx_align_center"><span id="S5.T3.1.1.8.4.1" class="ltx_text" style="font-size:70%;">52.16</span></td>
<td id="S5.T3.1.1.8.5" class="ltx_td ltx_align_center"><span id="S5.T3.1.1.8.5.1" class="ltx_text" style="font-size:70%;">54.40</span></td>
</tr>
<tr id="S5.T3.1.1.9" class="ltx_tr">
<td id="S5.T3.1.1.9.1" class="ltx_td ltx_align_left ltx_border_r">
<span class="ltx_rule" style="width:100%;height:0.8pt;background:black;display:inline-block;"> </span><span id="S5.T3.1.1.9.1.1" class="ltx_text" style="font-size:70%;">
</span><span id="S5.T3.1.1.9.1.2" class="ltx_text ltx_font_bold" style="font-size:70%;">Our-Proposal</span>
</td>
<td id="S5.T3.1.1.9.2" class="ltx_td"></td>
<td id="S5.T3.1.1.9.3" class="ltx_td"></td>
<td id="S5.T3.1.1.9.4" class="ltx_td"></td>
<td id="S5.T3.1.1.9.5" class="ltx_td"></td>
</tr>
<tr id="S5.T3.1.1.10" class="ltx_tr">
<td id="S5.T3.1.1.10.1" class="ltx_td ltx_align_left ltx_border_r ltx_border_t"><span id="S5.T3.1.1.10.1.1" class="ltx_text" style="font-size:70%;">Att-LSTM</span></td>
<td id="S5.T3.1.1.10.2" class="ltx_td ltx_align_center ltx_border_t"><span id="S5.T3.1.1.10.2.1" class="ltx_text" style="font-size:70%;">63.92</span></td>
<td id="S5.T3.1.1.10.3" class="ltx_td ltx_align_center ltx_border_t"><span id="S5.T3.1.1.10.3.1" class="ltx_text" style="font-size:70%;">51.83</span></td>
<td id="S5.T3.1.1.10.4" class="ltx_td ltx_align_center ltx_border_t"><span id="S5.T3.1.1.10.4.1" class="ltx_text" style="font-size:70%;">57.29</span></td>
<td id="S5.T3.1.1.10.5" class="ltx_td ltx_align_center ltx_border_t"><span id="S5.T3.1.1.10.5.1" class="ltx_text" style="font-size:70%;">54.84</span></td>
</tr>
<tr id="S5.T3.1.1.11" class="ltx_tr">
<td id="S5.T3.1.1.11.1" class="ltx_td ltx_align_left ltx_border_r"><span id="S5.T3.1.1.11.1.1" class="ltx_text" style="font-size:70%;">Att+Cap-LSTM</span></td>
<td id="S5.T3.1.1.11.2" class="ltx_td ltx_align_center"><span id="S5.T3.1.1.11.2.1" class="ltx_text" style="font-size:70%;">71.30</span></td>
<td id="S5.T3.1.1.11.3" class="ltx_td ltx_align_center"><span id="S5.T3.1.1.11.3.1" class="ltx_text" style="font-size:70%;">69.98</span></td>
<td id="S5.T3.1.1.11.4" class="ltx_td ltx_align_center"><span id="S5.T3.1.1.11.4.1" class="ltx_text" style="font-size:70%;">61.50</span></td>
<td id="S5.T3.1.1.11.5" class="ltx_td ltx_align_center"><span id="S5.T3.1.1.11.5.1" class="ltx_text ltx_font_bold" style="font-size:70%;">60.98</span></td>
</tr>
<tr id="S5.T3.1.1.12" class="ltx_tr">
<td id="S5.T3.1.1.12.1" class="ltx_td ltx_align_left ltx_border_r"><span id="S5.T3.1.1.12.1.1" class="ltx_text" style="font-size:70%;">Att+Know-LSTM</span></td>
<td id="S5.T3.1.1.12.2" class="ltx_td ltx_align_center"><span id="S5.T3.1.1.12.2.1" class="ltx_text" style="font-size:70%;">64.57</span></td>
<td id="S5.T3.1.1.12.3" class="ltx_td ltx_align_center"><span id="S5.T3.1.1.12.3.1" class="ltx_text" style="font-size:70%;">54.37</span></td>
<td id="S5.T3.1.1.12.4" class="ltx_td ltx_align_center"><span id="S5.T3.1.1.12.4.1" class="ltx_text" style="font-size:70%;">62.79</span></td>
<td id="S5.T3.1.1.12.5" class="ltx_td ltx_align_center"><span id="S5.T3.1.1.12.5.1" class="ltx_text" style="font-size:70%;">56.98</span></td>
</tr>
<tr id="S5.T3.1.1.13" class="ltx_tr">
<td id="S5.T3.1.1.13.1" class="ltx_td ltx_align_left ltx_border_r"><span id="S5.T3.1.1.13.1.1" class="ltx_text" style="font-size:70%;">Cap+Know-LSTM</span></td>
<td id="S5.T3.1.1.13.2" class="ltx_td ltx_align_center"><span id="S5.T3.1.1.13.2.1" class="ltx_text" style="font-size:70%;">65.61</span></td>
<td id="S5.T3.1.1.13.3" class="ltx_td ltx_align_center"><span id="S5.T3.1.1.13.3.1" class="ltx_text" style="font-size:70%;">55.13</span></td>
<td id="S5.T3.1.1.13.4" class="ltx_td ltx_align_center"><span id="S5.T3.1.1.13.4.1" class="ltx_text" style="font-size:70%;">62.02</span></td>
<td id="S5.T3.1.1.13.5" class="ltx_td ltx_align_center"><span id="S5.T3.1.1.13.5.1" class="ltx_text" style="font-size:70%;">57.28</span></td>
</tr>
<tr id="S5.T3.1.1.14" class="ltx_tr">
<td id="S5.T3.1.1.14.1" class="ltx_td ltx_align_left ltx_border_r"><span id="S5.T3.1.1.14.1.1" class="ltx_text" style="font-size:70%;">Att+Cap+Know-LSTM</span></td>
<td id="S5.T3.1.1.14.2" class="ltx_td ltx_align_center"><span id="S5.T3.1.1.14.2.1" class="ltx_text ltx_font_bold" style="font-size:70%;">71.45</span></td>
<td id="S5.T3.1.1.14.3" class="ltx_td ltx_align_center"><span id="S5.T3.1.1.14.3.1" class="ltx_text ltx_font_bold" style="font-size:70%;">75.33</span></td>
<td id="S5.T3.1.1.14.4" class="ltx_td ltx_align_center"><span id="S5.T3.1.1.14.4.1" class="ltx_text ltx_font_bold" style="font-size:70%;">64.09</span></td>
<td id="S5.T3.1.1.14.5" class="ltx_td ltx_align_center"><span id="S5.T3.1.1.14.5.1" class="ltx_text ltx_font_bold" style="font-size:70%;">60.98</span></td>
</tr>
<tr id="S5.T3.1.1.15" class="ltx_tr">
<td id="S5.T3.1.1.15.1" class="ltx_td ltx_align_left ltx_border_r"><span class="ltx_rule" style="width:100%;height:0.8pt;background:black;display:inline-block;"> </span></td>
<td id="S5.T3.1.1.15.2" class="ltx_td"></td>
<td id="S5.T3.1.1.15.3" class="ltx_td"></td>
<td id="S5.T3.1.1.15.4" class="ltx_td"></td>
<td id="S5.T3.1.1.15.5" class="ltx_td"></td>
</tr>
</table>
</span></div>
<figcaption class="ltx_caption" style="font-size:70%;"><span class="ltx_tag ltx_tag_table">Table 3: </span>Toronto COCO-QA accuracy (%) per category.</figcaption>
</figure>
<div id="S5.SS2.SSS0.Px2.p3" class="ltx_para">
<p id="S5.SS2.SSS0.Px2.p3.1" class="ltx_p">Table <a href="#S5.T2" title="Table 2 ‣ Metrics ‣ 5.2 Results on Toronto COCO-QA ‣ 5 Experiments ‣ Ask Me Anything: Free-form Visual Question Answering Based on Knowledge from External Sources" class="ltx_ref"><span class="ltx_text ltx_ref_tag">2</span></a> reports the results.
All of our proposed models outperform the <span id="S5.SS2.SSS0.Px2.p3.1.1" class="ltx_text ltx_font_bold">Baseline</span> and all of the competing state-of-the-art methods. Our final model <span id="S5.SS2.SSS0.Px2.p3.1.2" class="ltx_text ltx_font_bold">Att+Cap+Know-LSTM</span> achieves the best results. It surpasses the baseline by nearly 20% and outperforms the previous state-of-the-art methods by around 15%. <span id="S5.SS2.SSS0.Px2.p3.1.3" class="ltx_text ltx_font_bold">Att+Cap-LSTM</span> clearly improves the results over the <span id="S5.SS2.SSS0.Px2.p3.1.4" class="ltx_text ltx_font_bold">Att-LSTM</span> model. This proves that internal textual representation plays a significant role in the VQA task. The <span id="S5.SS2.SSS0.Px2.p3.1.5" class="ltx_text ltx_font_bold">Att+Know-LSTM</span> model does not perform as well as <span id="S5.SS2.SSS0.Px2.p3.1.6" class="ltx_text ltx_font_bold">Att+Cap-LSTM</span> , which suggests that the information extracted from captions is more valuable than that extracted from the KB. <span id="S5.SS2.SSS0.Px2.p3.1.7" class="ltx_text ltx_font_bold">Cap+Know-LSTM</span> also performs better than <span id="S5.SS2.SSS0.Px2.p3.1.8" class="ltx_text ltx_font_bold">Att+Know-LSTM</span>. This is not surprising because the Toronto COCO-QA questions were generated automatically from the MS COCO captions, and thus the fact that they can be answered by training on the captions is to be expected. This generation process also leads to questions which require little external information to answer. The comparison on the Toronto COCO-QA thus provides an important benchmark against related methods, but does not really test the ability of our method to incorporate extra information. It is thus interesting that the additional external information provides any benefit at all.</p>
</div>
<figure id="S5.T4" class="ltx_table">
<div id="S5.T4.1" class="ltx_inline-block ltx_align_center ltx_transformed_outer" style="width:433.6pt;height:521.1pt;vertical-align:-0.0pt;"><span class="ltx_transformed_inner" style="transform:translate(7.1pt,-8.5pt) scale(1.03386273996262,1.03386273996262) ;">
<table id="S5.T4.1.1" class="ltx_tabular ltx_align_middle">
<tr id="S5.T4.1.1.1" class="ltx_tr">
<td id="S5.T4.1.1.1.1" class="ltx_td ltx_align_left">
<span class="ltx_rule" style="width:100%;height:0.8pt;background:black;display:inline-block;"> </span></td>
<td id="S5.T4.1.1.1.2" class="ltx_td ltx_align_center">Our-Baseline</td>
<td id="S5.T4.1.1.1.3" class="ltx_td"></td>
<td id="S5.T4.1.1.1.4" class="ltx_td ltx_align_center" colspan="5">Our Proposal</td>
</tr>
<tr id="S5.T4.1.1.2" class="ltx_tr">
<td id="S5.T4.1.1.2.1" class="ltx_td ltx_align_center">Question</td>
<td id="S5.T4.1.1.2.2" class="ltx_td ltx_align_center ltx_border_t">VggNet</td>
<td id="S5.T4.1.1.2.3" class="ltx_td"></td>
<td id="S5.T4.1.1.2.4" class="ltx_td ltx_align_center ltx_border_t">Att</td>
<td id="S5.T4.1.1.2.5" class="ltx_td ltx_align_center ltx_border_t">Att+Cap</td>
<td id="S5.T4.1.1.2.6" class="ltx_td ltx_align_center ltx_border_t">Att+Know</td>
<td id="S5.T4.1.1.2.7" class="ltx_td ltx_align_center ltx_border_t">Cap+Know</td>
<td id="S5.T4.1.1.2.8" class="ltx_td ltx_align_center ltx_border_t">A+C+K</td>
</tr>
<tr id="S5.T4.1.1.3" class="ltx_tr">
<td id="S5.T4.1.1.3.1" class="ltx_td ltx_align_center">Type</td>
<td id="S5.T4.1.1.3.2" class="ltx_td ltx_align_center">+</td>
<td id="S5.T4.1.1.3.3" class="ltx_td"></td>
<td id="S5.T4.1.1.3.4" class="ltx_td ltx_align_center">+</td>
<td id="S5.T4.1.1.3.5" class="ltx_td ltx_align_center">+</td>
<td id="S5.T4.1.1.3.6" class="ltx_td ltx_align_center">+</td>
<td id="S5.T4.1.1.3.7" class="ltx_td ltx_align_center">+</td>
<td id="S5.T4.1.1.3.8" class="ltx_td ltx_align_center">+</td>
</tr>
<tr id="S5.T4.1.1.4" class="ltx_tr">
<td id="S5.T4.1.1.4.1" class="ltx_td"></td>
<td id="S5.T4.1.1.4.2" class="ltx_td ltx_align_center">LSTM</td>
<td id="S5.T4.1.1.4.3" class="ltx_td"></td>
<td id="S5.T4.1.1.4.4" class="ltx_td ltx_align_center">LSTM</td>
<td id="S5.T4.1.1.4.5" class="ltx_td ltx_align_center">LSTM</td>
<td id="S5.T4.1.1.4.6" class="ltx_td ltx_align_center">LSTM</td>
<td id="S5.T4.1.1.4.7" class="ltx_td ltx_align_center">LSTM</td>
<td id="S5.T4.1.1.4.8" class="ltx_td ltx_align_center">LSTM</td>
</tr>
<tr id="S5.T4.1.1.5" class="ltx_tr">
<td id="S5.T4.1.1.5.1" class="ltx_td ltx_align_left ltx_border_t">what is</td>
<td id="S5.T4.1.1.5.2" class="ltx_td ltx_align_center ltx_border_t">21.41</td>
<td id="S5.T4.1.1.5.3" class="ltx_td ltx_border_t"></td>
<td id="S5.T4.1.1.5.4" class="ltx_td ltx_align_center ltx_border_t">34.63</td>
<td id="S5.T4.1.1.5.5" class="ltx_td ltx_align_center ltx_border_t">42.21</td>
<td id="S5.T4.1.1.5.6" class="ltx_td ltx_align_center ltx_border_t">37.11</td>
<td id="S5.T4.1.1.5.7" class="ltx_td ltx_align_center ltx_border_t">35.58</td>
<td id="S5.T4.1.1.5.8" class="ltx_td ltx_align_center ltx_border_t"><span id="S5.T4.1.1.5.8.1" class="ltx_text ltx_font_bold">42.52</span></td>
</tr>
<tr id="S5.T4.1.1.6" class="ltx_tr">
<td id="S5.T4.1.1.6.1" class="ltx_td ltx_align_left">what colour</td>
<td id="S5.T4.1.1.6.2" class="ltx_td ltx_align_center">29.96</td>
<td id="S5.T4.1.1.6.3" class="ltx_td"></td>
<td id="S5.T4.1.1.6.4" class="ltx_td ltx_align_center">39.07</td>
<td id="S5.T4.1.1.6.5" class="ltx_td ltx_align_center">48.65</td>
<td id="S5.T4.1.1.6.6" class="ltx_td ltx_align_center">39.68</td>
<td id="S5.T4.1.1.6.7" class="ltx_td ltx_align_center">40.62</td>
<td id="S5.T4.1.1.6.8" class="ltx_td ltx_align_center"><span id="S5.T4.1.1.6.8.1" class="ltx_text ltx_font_bold">48.86</span></td>
</tr>
<tr id="S5.T4.1.1.7" class="ltx_tr">
<td id="S5.T4.1.1.7.1" class="ltx_td ltx_align_left">what kind</td>
<td id="S5.T4.1.1.7.2" class="ltx_td ltx_align_center">24.15</td>
<td id="S5.T4.1.1.7.3" class="ltx_td"></td>
<td id="S5.T4.1.1.7.4" class="ltx_td ltx_align_center">41.22</td>
<td id="S5.T4.1.1.7.5" class="ltx_td ltx_align_center">47.93</td>
<td id="S5.T4.1.1.7.6" class="ltx_td ltx_align_center">46.16</td>
<td id="S5.T4.1.1.7.7" class="ltx_td ltx_align_center">44.04</td>
<td id="S5.T4.1.1.7.8" class="ltx_td ltx_align_center"><span id="S5.T4.1.1.7.8.1" class="ltx_text ltx_font_bold">48.05</span></td>
</tr>
<tr id="S5.T4.1.1.8" class="ltx_tr">
<td id="S5.T4.1.1.8.1" class="ltx_td ltx_align_left">what are</td>
<td id="S5.T4.1.1.8.2" class="ltx_td ltx_align_center">23.05</td>
<td id="S5.T4.1.1.8.3" class="ltx_td"></td>
<td id="S5.T4.1.1.8.4" class="ltx_td ltx_align_center">38.87</td>
<td id="S5.T4.1.1.8.5" class="ltx_td ltx_align_center">47.13</td>
<td id="S5.T4.1.1.8.6" class="ltx_td ltx_align_center">41.13</td>
<td id="S5.T4.1.1.8.7" class="ltx_td ltx_align_center">39.73</td>
<td id="S5.T4.1.1.8.8" class="ltx_td ltx_align_center"><span id="S5.T4.1.1.8.8.1" class="ltx_text ltx_font_bold">47.21</span></td>
</tr>
<tr id="S5.T4.1.1.9" class="ltx_tr">
<td id="S5.T4.1.1.9.1" class="ltx_td ltx_align_left">what type</td>
<td id="S5.T4.1.1.9.2" class="ltx_td ltx_align_center">26.36</td>
<td id="S5.T4.1.1.9.3" class="ltx_td"></td>
<td id="S5.T4.1.1.9.4" class="ltx_td ltx_align_center">41.71</td>
<td id="S5.T4.1.1.9.5" class="ltx_td ltx_align_center">47.98</td>
<td id="S5.T4.1.1.9.6" class="ltx_td ltx_align_center">44.91</td>
<td id="S5.T4.1.1.9.7" class="ltx_td ltx_align_center">44.95</td>
<td id="S5.T4.1.1.9.8" class="ltx_td ltx_align_center"><span id="S5.T4.1.1.9.8.1" class="ltx_text ltx_font_bold">48.11</span></td>
</tr>
<tr id="S5.T4.1.1.10" class="ltx_tr">
<td id="S5.T4.1.1.10.1" class="ltx_td ltx_align_left">is the</td>
<td id="S5.T4.1.1.10.2" class="ltx_td ltx_align_center">71.49</td>
<td id="S5.T4.1.1.10.3" class="ltx_td"></td>
<td id="S5.T4.1.1.10.4" class="ltx_td ltx_align_center">73.22</td>
<td id="S5.T4.1.1.10.5" class="ltx_td ltx_align_center">74.63</td>
<td id="S5.T4.1.1.10.6" class="ltx_td ltx_align_center">74.40</td>
<td id="S5.T4.1.1.10.7" class="ltx_td ltx_align_center">73.78</td>
<td id="S5.T4.1.1.10.8" class="ltx_td ltx_align_center"><span id="S5.T4.1.1.10.8.1" class="ltx_text ltx_font_bold">74.70</span></td>
</tr>
<tr id="S5.T4.1.1.11" class="ltx_tr">
<td id="S5.T4.1.1.11.1" class="ltx_td ltx_align_left">is this</td>
<td id="S5.T4.1.1.11.2" class="ltx_td ltx_align_center">73.00</td>
<td id="S5.T4.1.1.11.3" class="ltx_td"></td>
<td id="S5.T4.1.1.11.4" class="ltx_td ltx_align_center">75.26</td>
<td id="S5.T4.1.1.11.5" class="ltx_td ltx_align_center">76.08</td>
<td id="S5.T4.1.1.11.6" class="ltx_td ltx_align_center"><span id="S5.T4.1.1.11.6.1" class="ltx_text ltx_font_bold">76.56</span></td>
<td id="S5.T4.1.1.11.7" class="ltx_td ltx_align_center">74.18</td>
<td id="S5.T4.1.1.11.8" class="ltx_td ltx_align_center">76.14</td>
</tr>
<tr id="S5.T4.1.1.12" class="ltx_tr">
<td id="S5.T4.1.1.12.1" class="ltx_td ltx_align_left">how many</td>
<td id="S5.T4.1.1.12.2" class="ltx_td ltx_align_center">34.42</td>
<td id="S5.T4.1.1.12.3" class="ltx_td"></td>
<td id="S5.T4.1.1.12.4" class="ltx_td ltx_align_center">39.14</td>
<td id="S5.T4.1.1.12.5" class="ltx_td ltx_align_center">46.61</td>
<td id="S5.T4.1.1.12.6" class="ltx_td ltx_align_center">39.78</td>
<td id="S5.T4.1.1.12.7" class="ltx_td ltx_align_center">44.20</td>
<td id="S5.T4.1.1.12.8" class="ltx_td ltx_align_center"><span id="S5.T4.1.1.12.8.1" class="ltx_text ltx_font_bold">47.38</span></td>
</tr>
<tr id="S5.T4.1.1.13" class="ltx_tr">
<td id="S5.T4.1.1.13.1" class="ltx_td ltx_align_left">are</td>
<td id="S5.T4.1.1.13.2" class="ltx_td ltx_align_center">73.51</td>
<td id="S5.T4.1.1.13.3" class="ltx_td"></td>
<td id="S5.T4.1.1.13.4" class="ltx_td ltx_align_center">75.14</td>
<td id="S5.T4.1.1.13.5" class="ltx_td ltx_align_center">76.01</td>
<td id="S5.T4.1.1.13.6" class="ltx_td ltx_align_center">75.75</td>
<td id="S5.T4.1.1.13.7" class="ltx_td ltx_align_center">75.78</td>
<td id="S5.T4.1.1.13.8" class="ltx_td ltx_align_center"><span id="S5.T4.1.1.13.8.1" class="ltx_text ltx_font_bold">76.14</span></td>
</tr>
<tr id="S5.T4.1.1.14" class="ltx_tr">
<td id="S5.T4.1.1.14.1" class="ltx_td ltx_align_left">does</td>
<td id="S5.T4.1.1.14.2" class="ltx_td ltx_align_center">76.51</td>
<td id="S5.T4.1.1.14.3" class="ltx_td"></td>
<td id="S5.T4.1.1.14.4" class="ltx_td ltx_align_center">76.71</td>
<td id="S5.T4.1.1.14.5" class="ltx_td ltx_align_center">78.07</td>
<td id="S5.T4.1.1.14.6" class="ltx_td ltx_align_center">76.55</td>
<td id="S5.T4.1.1.14.7" class="ltx_td ltx_align_center">77.17</td>
<td id="S5.T4.1.1.14.8" class="ltx_td ltx_align_center"><span id="S5.T4.1.1.14.8.1" class="ltx_text ltx_font_bold">78.11</span></td>
</tr>
<tr id="S5.T4.1.1.15" class="ltx_tr">
<td id="S5.T4.1.1.15.1" class="ltx_td ltx_align_left">where</td>
<td id="S5.T4.1.1.15.2" class="ltx_td ltx_align_center">10.54</td>
<td id="S5.T4.1.1.15.3" class="ltx_td"></td>
<td id="S5.T4.1.1.15.4" class="ltx_td ltx_align_center">21.42</td>
<td id="S5.T4.1.1.15.5" class="ltx_td ltx_align_center">25.92</td>
<td id="S5.T4.1.1.15.6" class="ltx_td ltx_align_center">24.13</td>
<td id="S5.T4.1.1.15.7" class="ltx_td ltx_align_center">16.09</td>
<td id="S5.T4.1.1.15.8" class="ltx_td ltx_align_center"><span id="S5.T4.1.1.15.8.1" class="ltx_text ltx_font_bold">26.00</span></td>
</tr>
<tr id="S5.T4.1.1.16" class="ltx_tr">
<td id="S5.T4.1.1.16.1" class="ltx_td ltx_align_left">is there</td>
<td id="S5.T4.1.1.16.2" class="ltx_td ltx_align_center">86.66</td>
<td id="S5.T4.1.1.16.3" class="ltx_td"></td>
<td id="S5.T4.1.1.16.4" class="ltx_td ltx_align_center"><span id="S5.T4.1.1.16.4.1" class="ltx_text ltx_font_bold">87.10</span></td>
<td id="S5.T4.1.1.16.5" class="ltx_td ltx_align_center">86.82</td>
<td id="S5.T4.1.1.16.6" class="ltx_td ltx_align_center">85.87</td>
<td id="S5.T4.1.1.16.7" class="ltx_td ltx_align_center">85.26</td>
<td id="S5.T4.1.1.16.8" class="ltx_td ltx_align_center">87.01</td>
</tr>
<tr id="S5.T4.1.1.17" class="ltx_tr">
<td id="S5.T4.1.1.17.1" class="ltx_td ltx_align_left">why</td>
<td id="S5.T4.1.1.17.2" class="ltx_td ltx_align_center">3.04</td>
<td id="S5.T4.1.1.17.3" class="ltx_td"></td>
<td id="S5.T4.1.1.17.4" class="ltx_td ltx_align_center">7.77</td>
<td id="S5.T4.1.1.17.5" class="ltx_td ltx_align_center">9.63</td>
<td id="S5.T4.1.1.17.6" class="ltx_td ltx_align_center">11.88</td>
<td id="S5.T4.1.1.17.7" class="ltx_td ltx_align_center">9.99</td>
<td id="S5.T4.1.1.17.8" class="ltx_td ltx_align_center"><span id="S5.T4.1.1.17.8.1" class="ltx_text ltx_font_bold">13.53</span></td>
</tr>
<tr id="S5.T4.1.1.18" class="ltx_tr">
<td id="S5.T4.1.1.18.1" class="ltx_td ltx_align_left">which</td>
<td id="S5.T4.1.1.18.2" class="ltx_td ltx_align_center">31.28</td>
<td id="S5.T4.1.1.18.3" class="ltx_td"></td>
<td id="S5.T4.1.1.18.4" class="ltx_td ltx_align_center">36.60</td>
<td id="S5.T4.1.1.18.5" class="ltx_td ltx_align_center"><span id="S5.T4.1.1.18.5.1" class="ltx_text ltx_font_bold">39.55</span></td>
<td id="S5.T4.1.1.18.6" class="ltx_td ltx_align_center">37.71</td>
<td id="S5.T4.1.1.18.7" class="ltx_td ltx_align_center">37.86</td>
<td id="S5.T4.1.1.18.8" class="ltx_td ltx_align_center">38.70</td>
</tr>
<tr id="S5.T4.1.1.19" class="ltx_tr">
<td id="S5.T4.1.1.19.1" class="ltx_td ltx_align_left">do</td>
<td id="S5.T4.1.1.19.2" class="ltx_td ltx_align_center">76.44</td>
<td id="S5.T4.1.1.19.3" class="ltx_td"></td>
<td id="S5.T4.1.1.19.4" class="ltx_td ltx_align_center">75.76</td>
<td id="S5.T4.1.1.19.5" class="ltx_td ltx_align_center">78.18</td>
<td id="S5.T4.1.1.19.6" class="ltx_td ltx_align_center">75.25</td>
<td id="S5.T4.1.1.19.7" class="ltx_td ltx_align_center">74.91</td>
<td id="S5.T4.1.1.19.8" class="ltx_td ltx_align_center"><span id="S5.T4.1.1.19.8.1" class="ltx_text ltx_font_bold">78.42</span></td>
</tr>
<tr id="S5.T4.1.1.20" class="ltx_tr">
<td id="S5.T4.1.1.20.1" class="ltx_td ltx_align_left">what does</td>
<td id="S5.T4.1.1.20.2" class="ltx_td ltx_align_center">15.45</td>
<td id="S5.T4.1.1.20.3" class="ltx_td"></td>
<td id="S5.T4.1.1.20.4" class="ltx_td ltx_align_center">19.33</td>
<td id="S5.T4.1.1.20.5" class="ltx_td ltx_align_center">21.80</td>
<td id="S5.T4.1.1.20.6" class="ltx_td ltx_align_center">19.50</td>
<td id="S5.T4.1.1.20.7" class="ltx_td ltx_align_center">19.04</td>
<td id="S5.T4.1.1.20.8" class="ltx_td ltx_align_center"><span id="S5.T4.1.1.20.8.1" class="ltx_text ltx_font_bold">22.16</span></td>
</tr>
<tr id="S5.T4.1.1.21" class="ltx_tr">
<td id="S5.T4.1.1.21.1" class="ltx_td ltx_align_left">what time</td>
<td id="S5.T4.1.1.21.2" class="ltx_td ltx_align_center">13.11</td>
<td id="S5.T4.1.1.21.3" class="ltx_td"></td>
<td id="S5.T4.1.1.21.4" class="ltx_td ltx_align_center">15.34</td>
<td id="S5.T4.1.1.21.5" class="ltx_td ltx_align_center">15.44</td>
<td id="S5.T4.1.1.21.6" class="ltx_td ltx_align_center"><span id="S5.T4.1.1.21.6.1" class="ltx_text ltx_font_bold">15.47</span></td>
<td id="S5.T4.1.1.21.7" class="ltx_td ltx_align_center">15.04</td>
<td id="S5.T4.1.1.21.8" class="ltx_td ltx_align_center">15.34</td>
</tr>
<tr id="S5.T4.1.1.22" class="ltx_tr">
<td id="S5.T4.1.1.22.1" class="ltx_td ltx_align_left">who</td>
<td id="S5.T4.1.1.22.2" class="ltx_td ltx_align_center">17.07</td>
<td id="S5.T4.1.1.22.3" class="ltx_td"></td>
<td id="S5.T4.1.1.22.4" class="ltx_td ltx_align_center">22.56</td>
<td id="S5.T4.1.1.22.5" class="ltx_td ltx_align_center">25.71</td>
<td id="S5.T4.1.1.22.6" class="ltx_td ltx_align_center">21.23</td>
<td id="S5.T4.1.1.22.7" class="ltx_td ltx_align_center">22.86</td>
<td id="S5.T4.1.1.22.8" class="ltx_td ltx_align_center"><span id="S5.T4.1.1.22.8.1" class="ltx_text ltx_font_bold">25.74</span></td>
</tr>
<tr id="S5.T4.1.1.23" class="ltx_tr">
<td id="S5.T4.1.1.23.1" class="ltx_td ltx_align_left">what sport</td>
<td id="S5.T4.1.1.23.2" class="ltx_td ltx_align_center">65.65</td>
<td id="S5.T4.1.1.23.3" class="ltx_td"></td>
<td id="S5.T4.1.1.23.4" class="ltx_td ltx_align_center">91.02</td>
<td id="S5.T4.1.1.23.5" class="ltx_td ltx_align_center">93.96</td>
<td id="S5.T4.1.1.23.6" class="ltx_td ltx_align_center">90.86</td>
<td id="S5.T4.1.1.23.7" class="ltx_td ltx_align_center">91.75</td>
<td id="S5.T4.1.1.23.8" class="ltx_td ltx_align_center"><span id="S5.T4.1.1.23.8.1" class="ltx_text ltx_font_bold">94.20</span></td>
</tr>
<tr id="S5.T4.1.1.24" class="ltx_tr">
<td id="S5.T4.1.1.24.1" class="ltx_td ltx_align_left">what animal</td>
<td id="S5.T4.1.1.24.2" class="ltx_td ltx_align_center">27.77</td>
<td id="S5.T4.1.1.24.3" class="ltx_td"></td>
<td id="S5.T4.1.1.24.4" class="ltx_td ltx_align_center">61.39</td>
<td id="S5.T4.1.1.24.5" class="ltx_td ltx_align_center">70.65</td>
<td id="S5.T4.1.1.24.6" class="ltx_td ltx_align_center">63.91</td>
<td id="S5.T4.1.1.24.7" class="ltx_td ltx_align_center">63.26</td>
<td id="S5.T4.1.1.24.8" class="ltx_td ltx_align_center"><span id="S5.T4.1.1.24.8.1" class="ltx_text ltx_font_bold">71.70</span></td>
</tr>
<tr id="S5.T4.1.1.25" class="ltx_tr">
<td id="S5.T4.1.1.25.1" class="ltx_td ltx_align_left">what brand</td>
<td id="S5.T4.1.1.25.2" class="ltx_td ltx_align_center">26.73</td>
<td id="S5.T4.1.1.25.3" class="ltx_td"></td>
<td id="S5.T4.1.1.25.4" class="ltx_td ltx_align_center">32.25</td>
<td id="S5.T4.1.1.25.5" class="ltx_td ltx_align_center">33.78</td>
<td id="S5.T4.1.1.25.6" class="ltx_td ltx_align_center">32.44</td>
<td id="S5.T4.1.1.25.7" class="ltx_td ltx_align_center">31.30</td>
<td id="S5.T4.1.1.25.8" class="ltx_td ltx_align_center"><span id="S5.T4.1.1.25.8.1" class="ltx_text ltx_font_bold">34.60</span></td>
</tr>
<tr id="S5.T4.1.1.26" class="ltx_tr">
<td id="S5.T4.1.1.26.1" class="ltx_td ltx_align_left">others</td>
<td id="S5.T4.1.1.26.2" class="ltx_td ltx_align_center">44.37</td>
<td id="S5.T4.1.1.26.3" class="ltx_td"></td>
<td id="S5.T4.1.1.26.4" class="ltx_td ltx_align_center">50.23</td>
<td id="S5.T4.1.1.26.5" class="ltx_td ltx_align_center">53.29</td>
<td id="S5.T4.1.1.26.6" class="ltx_td ltx_align_center">52.11</td>
<td id="S5.T4.1.1.26.7" class="ltx_td ltx_align_center">51.20</td>
<td id="S5.T4.1.1.26.8" class="ltx_td ltx_align_center"><span id="S5.T4.1.1.26.8.1" class="ltx_text ltx_font_bold">53.45</span></td>
</tr>
<tr id="S5.T4.1.1.27" class="ltx_tr">
<td id="S5.T4.1.1.27.1" class="ltx_td ltx_align_left ltx_border_t">Overall</td>
<td id="S5.T4.1.1.27.2" class="ltx_td ltx_align_center ltx_border_t">44.93</td>
<td id="S5.T4.1.1.27.3" class="ltx_td ltx_border_t"></td>
<td id="S5.T4.1.1.27.4" class="ltx_td ltx_align_center ltx_border_t">51.60</td>
<td id="S5.T4.1.1.27.5" class="ltx_td ltx_align_center ltx_border_t">55.04</td>
<td id="S5.T4.1.1.27.6" class="ltx_td ltx_align_center ltx_border_t">53.79</td>
<td id="S5.T4.1.1.27.7" class="ltx_td ltx_align_center ltx_border_t">52.31</td>
<td id="S5.T4.1.1.27.8" class="ltx_td ltx_align_center ltx_border_t"><span id="S5.T4.1.1.27.8.1" class="ltx_text ltx_font_bold">55.96</span></td>
</tr>
<tr id="S5.T4.1.1.28" class="ltx_tr">
<td id="S5.T4.1.1.28.1" class="ltx_td ltx_align_left"><span class="ltx_rule" style="width:100%;height:0.8pt;background:black;display:inline-block;"> </span></td>
<td id="S5.T4.1.1.28.2" class="ltx_td"></td>
<td id="S5.T4.1.1.28.3" class="ltx_td"></td>
<td id="S5.T4.1.1.28.4" class="ltx_td"></td>
<td id="S5.T4.1.1.28.5" class="ltx_td"></td>
<td id="S5.T4.1.1.28.6" class="ltx_td"></td>
<td id="S5.T4.1.1.28.7" class="ltx_td"></td>
<td id="S5.T4.1.1.28.8" class="ltx_td"></td>
</tr>
</table>
</span></div>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table">Table 4: </span>Results on the open-answer task for various question types on VQA validation set. All results are in terms of the evaluation metric from the VQA evaluation tools. The overall accuracy for the model of <span id="S5.T4.3.1" class="ltx_text ltx_font_bold">VggNet+ft+LSTM</span> is 50.01. Detailed results of different question types for this model are not shown in the table due to the limited space.</figcaption>
</figure>
<div id="S5.SS2.SSS0.Px2.p4" class="ltx_para">
<p id="S5.SS2.SSS0.Px2.p4.1" class="ltx_p">Table <a href="#S5.T3" title="Table 3 ‣ Evaluations ‣ 5.2 Results on Toronto COCO-QA ‣ 5 Experiments ‣ Ask Me Anything: Free-form Visual Question Answering Based on Knowledge from External Sources" class="ltx_ref"><span class="ltx_text ltx_ref_tag">3</span></a> shows the per-category accuracy for different models. Surprisingly, the counting ability (see question type ‘Number’) increases when both captions and external knowledge are included. This may be because some ‘counting’ questions
are not framed in terms of the labels used in the MS COCO captions.
Ren <em id="S5.SS2.SSS0.Px2.p4.1.1" class="ltx_emph ltx_font_italic">et al</em>.<span id="S5.SS2.SSS0.Px2.p4.1.2" class="ltx_text"></span> also observed similar cases. In <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib23" title="" class="ltx_ref">23</a>]</cite> they mentioned that “there was some observable counting ability in very clean images with a single object type but the ability was fairly weak when different object types are present”. We also find there is a slight increase for the ‘color’ questions when the KB is used. Indeed, some questions like ‘What is the color of the stop sign?’ can be answered directly from the KB, without the visual cue.</p>
</div>
</section>
</section>
<section id="S5.SS3" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">5.3 </span>Results on the VQA</h3>

<div id="S5.SS3.p1" class="ltx_para">
<p id="S5.SS3.p1.2" class="ltx_p">Antol <em id="S5.SS3.p1.2.1" class="ltx_emph ltx_font_italic">et al</em>.<span id="S5.SS3.p1.2.2" class="ltx_text"></span> in <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib1" title="" class="ltx_ref">1</a>]</cite> provide the VQA dataset which is intended to support “free-form and open-ended Visual Question Answering”. They also provide a metric for measuring performance:
<math id="S5.SS3.p1.1.m1.3" class="ltx_Math" alttext="\min\{\frac{\text{\# humans that said answer}}{3},1\}" display="inline"><semantics id="S5.SS3.p1.1.m1.3a"><mrow id="S5.SS3.p1.1.m1.3.4.2" xref="S5.SS3.p1.1.m1.3.4.1.cmml"><mi id="S5.SS3.p1.1.m1.1.1" xref="S5.SS3.p1.1.m1.1.1.cmml">min</mi><mo id="S5.SS3.p1.1.m1.3.4.2a" xref="S5.SS3.p1.1.m1.3.4.1.cmml">⁡</mo><mrow id="S5.SS3.p1.1.m1.3.4.2.1" xref="S5.SS3.p1.1.m1.3.4.1.cmml"><mo stretchy="false" id="S5.SS3.p1.1.m1.3.4.2.1.1" xref="S5.SS3.p1.1.m1.3.4.1.cmml">{</mo><mfrac id="S5.SS3.p1.1.m1.2.2" xref="S5.SS3.p1.1.m1.2.2.cmml"><mtext id="S5.SS3.p1.1.m1.2.2.2" xref="S5.SS3.p1.1.m1.2.2.2a.cmml"># humans that said answer</mtext><mn id="S5.SS3.p1.1.m1.2.2.3" xref="S5.SS3.p1.1.m1.2.2.3.cmml">3</mn></mfrac><mo id="S5.SS3.p1.1.m1.3.4.2.1.2" xref="S5.SS3.p1.1.m1.3.4.1.cmml">,</mo><mn id="S5.SS3.p1.1.m1.3.3" xref="S5.SS3.p1.1.m1.3.3.cmml">1</mn><mo stretchy="false" id="S5.SS3.p1.1.m1.3.4.2.1.3" xref="S5.SS3.p1.1.m1.3.4.1.cmml">}</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S5.SS3.p1.1.m1.3b"><apply id="S5.SS3.p1.1.m1.3.4.1.cmml" xref="S5.SS3.p1.1.m1.3.4.2"><min id="S5.SS3.p1.1.m1.1.1.cmml" xref="S5.SS3.p1.1.m1.1.1"></min><apply id="S5.SS3.p1.1.m1.2.2.cmml" xref="S5.SS3.p1.1.m1.2.2"><divide id="S5.SS3.p1.1.m1.2.2.1.cmml" xref="S5.SS3.p1.1.m1.2.2"></divide><ci id="S5.SS3.p1.1.m1.2.2.2a.cmml" xref="S5.SS3.p1.1.m1.2.2.2"><mtext mathsize="70%" id="S5.SS3.p1.1.m1.2.2.2.cmml" xref="S5.SS3.p1.1.m1.2.2.2"># humans that said answer</mtext></ci><cn type="integer" id="S5.SS3.p1.1.m1.2.2.3.cmml" xref="S5.SS3.p1.1.m1.2.2.3">3</cn></apply><cn type="integer" id="S5.SS3.p1.1.m1.3.3.cmml" xref="S5.SS3.p1.1.m1.3.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS3.p1.1.m1.3c">\min\{\frac{\text{\# humans that said answer}}{3},1\}</annotation></semantics></math>
thus <math id="S5.SS3.p1.2.m2.1" class="ltx_Math" alttext="100\%" display="inline"><semantics id="S5.SS3.p1.2.m2.1a"><mrow id="S5.SS3.p1.2.m2.1.1" xref="S5.SS3.p1.2.m2.1.1.cmml"><mn id="S5.SS3.p1.2.m2.1.1.2" xref="S5.SS3.p1.2.m2.1.1.2.cmml">100</mn><mo id="S5.SS3.p1.2.m2.1.1.1" xref="S5.SS3.p1.2.m2.1.1.1.cmml">%</mo></mrow><annotation-xml encoding="MathML-Content" id="S5.SS3.p1.2.m2.1b"><apply id="S5.SS3.p1.2.m2.1.1.cmml" xref="S5.SS3.p1.2.m2.1.1"><csymbol cd="latexml" id="S5.SS3.p1.2.m2.1.1.1.cmml" xref="S5.SS3.p1.2.m2.1.1.1">percent</csymbol><cn type="integer" id="S5.SS3.p1.2.m2.1.1.2.cmml" xref="S5.SS3.p1.2.m2.1.1.2">100</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS3.p1.2.m2.1c">100\%</annotation></semantics></math> means that at least 3 of the 10 humans who answered the question gave the same answer.
We have used the provided evaluation code to produce the results in Table <a href="#S5.T4" title="Table 4 ‣ Evaluations ‣ 5.2 Results on Toronto COCO-QA ‣ 5 Experiments ‣ Ask Me Anything: Free-form Visual Question Answering Based on Knowledge from External Sources" class="ltx_ref"><span class="ltx_text ltx_ref_tag">4</span></a>.</p>
</div>
<figure id="S5.T5" class="ltx_table">
<div class="ltx_flex_figure ltx_flex_table">
<div class="ltx_flex_cell ltx_flex_size_1">
<div id="S5.T5.4" class="ltx_inline-block ltx_figure_panel ltx_transformed_outer" style="width:433.6pt;height:144.6pt;vertical-align:-0.0pt;"><span class="ltx_transformed_inner" style="transform:translate(-54.0pt,18.0pt) scale(0.800514353427443,0.800514353427443) ;">
<table id="S5.T5.4.4" class="ltx_tabular ltx_align_middle">
<tr id="S5.T5.4.4.4" class="ltx_tr">
<td id="S5.T5.1.1.1.1" class="ltx_td ltx_align_center" colspan="2"><img src="/html/1511.06973/assets/img/results/001.jpg" id="S5.T5.1.1.1.1.g1" class="ltx_graphics ltx_img_landscape" width="157" height="118" alt="[Uncaptioned image]"></td>
<td id="S5.T5.2.2.2.2" class="ltx_td ltx_align_center"><img src="/html/1511.06973/assets/img/results/003.jpg" id="S5.T5.2.2.2.2.g1" class="ltx_graphics ltx_img_landscape" width="157" height="118" alt="[Uncaptioned image]"></td>
<td id="S5.T5.3.3.3.3" class="ltx_td ltx_align_center"><img src="/html/1511.06973/assets/img/results/006.jpg" id="S5.T5.3.3.3.3.g1" class="ltx_graphics ltx_img_landscape" width="165" height="118" alt="[Uncaptioned image]"></td>
<td id="S5.T5.4.4.4.4" class="ltx_td ltx_align_center"><img src="/html/1511.06973/assets/img/results/008.jpg" id="S5.T5.4.4.4.4.g1" class="ltx_graphics ltx_img_landscape" width="177" height="118" alt="[Uncaptioned image]"></td>
</tr>
<tr id="S5.T5.4.4.5" class="ltx_tr">
<td id="S5.T5.4.4.5.1" class="ltx_td ltx_align_center" colspan="2">What color is the tablecloth?</td>
<td id="S5.T5.4.4.5.2" class="ltx_td ltx_align_center">How many people in the photo?</td>
<td id="S5.T5.4.4.5.3" class="ltx_td ltx_align_center">What is the red fruit?</td>
<td id="S5.T5.4.4.5.4" class="ltx_td ltx_align_center">What are these people doing?</td>
</tr>
<tr id="S5.T5.4.4.6" class="ltx_tr">
<td id="S5.T5.4.4.6.1" class="ltx_td ltx_align_left ltx_border_t"><span id="S5.T5.4.4.6.1.1" class="ltx_text ltx_font_italic">Ours:</span></td>
<td id="S5.T5.4.4.6.2" class="ltx_td ltx_align_center ltx_border_t"><span id="S5.T5.4.4.6.2.1" class="ltx_text" style="color:#00FF00;">white</span></td>
<td id="S5.T5.4.4.6.3" class="ltx_td ltx_align_center ltx_border_t"><span id="S5.T5.4.4.6.3.1" class="ltx_text" style="color:#00FF00;">2</span></td>
<td id="S5.T5.4.4.6.4" class="ltx_td ltx_align_center ltx_border_t"><span id="S5.T5.4.4.6.4.1" class="ltx_text" style="color:#00FF00;">apple</span></td>
<td id="S5.T5.4.4.6.5" class="ltx_td ltx_align_center ltx_border_t"><span id="S5.T5.4.4.6.5.1" class="ltx_text" style="color:#00FF00;">eating</span></td>
</tr>
<tr id="S5.T5.4.4.7" class="ltx_tr">
<td id="S5.T5.4.4.7.1" class="ltx_td ltx_align_left"><span id="S5.T5.4.4.7.1.1" class="ltx_text ltx_font_italic">Vgg+LSTM:</span></td>
<td id="S5.T5.4.4.7.2" class="ltx_td ltx_align_center"><span id="S5.T5.4.4.7.2.1" class="ltx_text" style="color:#FF0000;">red</span></td>
<td id="S5.T5.4.4.7.3" class="ltx_td ltx_align_center"><span id="S5.T5.4.4.7.3.1" class="ltx_text" style="color:#FF0000;">1</span></td>
<td id="S5.T5.4.4.7.4" class="ltx_td ltx_align_center"><span id="S5.T5.4.4.7.4.1" class="ltx_text" style="color:#FF0000;">banana</span></td>
<td id="S5.T5.4.4.7.5" class="ltx_td ltx_align_center"><span id="S5.T5.4.4.7.5.1" class="ltx_text" style="color:#FF0000;">playing</span></td>
</tr>
<tr id="S5.T5.4.4.8" class="ltx_tr">
<td id="S5.T5.4.4.8.1" class="ltx_td ltx_align_left"><span id="S5.T5.4.4.8.1.1" class="ltx_text ltx_font_italic">Ground Truth:</span></td>
<td id="S5.T5.4.4.8.2" class="ltx_td ltx_align_center">white</td>
<td id="S5.T5.4.4.8.3" class="ltx_td ltx_align_center">2</td>
<td id="S5.T5.4.4.8.4" class="ltx_td ltx_align_center">apple</td>
<td id="S5.T5.4.4.8.5" class="ltx_td ltx_align_center">eating</td>
</tr>
<tr id="S5.T5.4.4.9" class="ltx_tr">
<td id="S5.T5.4.4.9.1" class="ltx_td ltx_align_left"><span class="ltx_rule" style="width:100%;height:0.8pt;background:black;display:inline-block;"> </span></td>
<td id="S5.T5.4.4.9.2" class="ltx_td"></td>
<td id="S5.T5.4.4.9.3" class="ltx_td"></td>
<td id="S5.T5.4.4.9.4" class="ltx_td"></td>
<td id="S5.T5.4.4.9.5" class="ltx_td"></td>
</tr>
</table>
</span></div>
</div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_1">
<div id="S5.T5.8" class="ltx_inline-block ltx_figure_panel ltx_transformed_outer" style="width:433.6pt;height:131.4pt;vertical-align:-0.0pt;"><span class="ltx_transformed_inner" style="transform:translate(-81.3pt,24.6pt) scale(0.727206677408625,0.727206677408625) ;">
<table id="S5.T5.8.4" class="ltx_tabular ltx_align_middle">
<tr id="S5.T5.8.4.4" class="ltx_tr">
<td id="S5.T5.5.1.1.1" class="ltx_td ltx_align_center" colspan="2"><img src="/html/1511.06973/assets/img/results/002.jpg" id="S5.T5.5.1.1.1.g1" class="ltx_graphics ltx_img_landscape" width="177" height="118" alt="[Uncaptioned image]"></td>
<td id="S5.T5.6.2.2.2" class="ltx_td ltx_align_center"><img src="/html/1511.06973/assets/img/results/004.jpg" id="S5.T5.6.2.2.2.g1" class="ltx_graphics ltx_img_landscape" width="208" height="118" alt="[Uncaptioned image]"></td>
<td id="S5.T5.7.3.3.3" class="ltx_td ltx_align_center"><img src="/html/1511.06973/assets/img/results/005.jpg" id="S5.T5.7.3.3.3.g1" class="ltx_graphics ltx_img_landscape" width="197" height="118" alt="[Uncaptioned image]"></td>
<td id="S5.T5.8.4.4.4" class="ltx_td ltx_align_center"><img src="/html/1511.06973/assets/img/results/007.jpg" id="S5.T5.8.4.4.4.g1" class="ltx_graphics ltx_img_landscape" width="177" height="118" alt="[Uncaptioned image]"></td>
</tr>
<tr id="S5.T5.8.4.5" class="ltx_tr">
<td id="S5.T5.8.4.5.1" class="ltx_td ltx_align_center" colspan="2">Why are his hands outstretched?</td>
<td id="S5.T5.8.4.5.2" class="ltx_td ltx_align_center">Why are the zebras in water?</td>
<td id="S5.T5.8.4.5.3" class="ltx_td ltx_align_center">Is the dog standing or laying down?</td>
<td id="S5.T5.8.4.5.4" class="ltx_td ltx_align_center">Which sport is this?</td>
</tr>
<tr id="S5.T5.8.4.6" class="ltx_tr">
<td id="S5.T5.8.4.6.1" class="ltx_td ltx_align_left ltx_border_t"><span id="S5.T5.8.4.6.1.1" class="ltx_text ltx_font_italic">Ours:</span></td>
<td id="S5.T5.8.4.6.2" class="ltx_td ltx_align_center ltx_border_t"><span id="S5.T5.8.4.6.2.1" class="ltx_text" style="color:#00FF00;">balance</span></td>
<td id="S5.T5.8.4.6.3" class="ltx_td ltx_align_center ltx_border_t"><span id="S5.T5.8.4.6.3.1" class="ltx_text" style="color:#00FF00;">drinking</span></td>
<td id="S5.T5.8.4.6.4" class="ltx_td ltx_align_center ltx_border_t"><span id="S5.T5.8.4.6.4.1" class="ltx_text" style="color:#00FF00;">laying down</span></td>
<td id="S5.T5.8.4.6.5" class="ltx_td ltx_align_center ltx_border_t"><span id="S5.T5.8.4.6.5.1" class="ltx_text" style="color:#00FF00;">baseball</span></td>
</tr>
<tr id="S5.T5.8.4.7" class="ltx_tr">
<td id="S5.T5.8.4.7.1" class="ltx_td ltx_align_left"><span id="S5.T5.8.4.7.1.1" class="ltx_text ltx_font_italic">Vgg+LSTM:</span></td>
<td id="S5.T5.8.4.7.2" class="ltx_td ltx_align_center"><span id="S5.T5.8.4.7.2.1" class="ltx_text" style="color:#FF0000;">play</span></td>
<td id="S5.T5.8.4.7.3" class="ltx_td ltx_align_center"><span id="S5.T5.8.4.7.3.1" class="ltx_text" style="color:#FF0000;">water</span></td>
<td id="S5.T5.8.4.7.4" class="ltx_td ltx_align_center"><span id="S5.T5.8.4.7.4.1" class="ltx_text" style="color:#FF0000;">sitting</span></td>
<td id="S5.T5.8.4.7.5" class="ltx_td ltx_align_center"><span id="S5.T5.8.4.7.5.1" class="ltx_text" style="color:#FF0000;">tennis</span></td>
</tr>
<tr id="S5.T5.8.4.8" class="ltx_tr">
<td id="S5.T5.8.4.8.1" class="ltx_td ltx_align_left"><span id="S5.T5.8.4.8.1.1" class="ltx_text ltx_font_italic">Ground Truth:</span></td>
<td id="S5.T5.8.4.8.2" class="ltx_td ltx_align_center">balance</td>
<td id="S5.T5.8.4.8.3" class="ltx_td ltx_align_center">drinking</td>
<td id="S5.T5.8.4.8.4" class="ltx_td ltx_align_center">laying down</td>
<td id="S5.T5.8.4.8.5" class="ltx_td ltx_align_center">baseball</td>
</tr>
<tr id="S5.T5.8.4.9" class="ltx_tr">
<td id="S5.T5.8.4.9.1" class="ltx_td ltx_align_left"><span class="ltx_rule" style="width:100%;height:0.8pt;background:black;display:inline-block;"> </span></td>
<td id="S5.T5.8.4.9.2" class="ltx_td"></td>
<td id="S5.T5.8.4.9.3" class="ltx_td"></td>
<td id="S5.T5.8.4.9.4" class="ltx_td"></td>
<td id="S5.T5.8.4.9.5" class="ltx_td"></td>
</tr>
</table>
</span></div>
</div>
</div>
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_table">Table 5: </span>Some example cases where our final model gives the correct answer while the base line model <span id="S5.T5.10.1" class="ltx_text ltx_font_bold">VggNet-LSTM</span> generates the wrong answer. All results are from VQA. More results can be found in the supplementary material.</figcaption>
</figure>
<section id="S5.SS3.SSS0.Px1" class="ltx_paragraph">
<h4 class="ltx_title ltx_title_paragraph">Evaluation</h4>

<div id="S5.SS3.SSS0.Px1.p1" class="ltx_para">
<p id="S5.SS3.SSS0.Px1.p1.1" class="ltx_p">Inspecting Table <a href="#S5.T4" title="Table 4 ‣ Evaluations ‣ 5.2 Results on Toronto COCO-QA ‣ 5 Experiments ‣ Ask Me Anything: Free-form Visual Question Answering Based on Knowledge from External Sources" class="ltx_ref"><span class="ltx_text ltx_ref_tag">4</span></a>, results on the VQA validation set, we see that the attribute-based <span id="S5.SS3.SSS0.Px1.p1.1.1" class="ltx_text ltx_font_bold">Att-LSTM</span> is a significant improvement over our <span id="S5.SS3.SSS0.Px1.p1.1.2" class="ltx_text ltx_font_bold">VggNet+LSTM</span> baseline. We also evaluate another baseline, the <span id="S5.SS3.SSS0.Px1.p1.1.3" class="ltx_text ltx_font_bold">VggNet+ft+LSTM</span>, which uses the penultimate layer of the attributes prediction CNN as the input to the LSTM. Its overall accuracy on the VQA is 50.01, which is still lower than our proposed models. Adding either image captions or external knowledge further improves the result. The model <span id="S5.SS3.SSS0.Px1.p1.1.4" class="ltx_text ltx_font_bold">Cap+Know</span> produces overall accuracy 52.31, slightly lower than Att+Know (53.79). This suggests that the attributes representation plays a more important role here.
Our final model <span id="S5.SS3.SSS0.Px1.p1.1.5" class="ltx_text ltx_font_bold">A+C+K-LSTM</span> produces the best results, outperforming the baseline <span id="S5.SS3.SSS0.Px1.p1.1.6" class="ltx_text ltx_font_bold">VggNet-LSTM</span> by 11% overall.</p>
</div>
<div id="S5.SS3.SSS0.Px1.p2" class="ltx_para">
<p id="S5.SS3.SSS0.Px1.p2.4" class="ltx_p">Figure <a href="#S5.F5" title="Figure 5 ‣ Evaluation ‣ 5.3 Results on the VQA ‣ 5 Experiments ‣ Ask Me Anything: Free-form Visual Question Answering Based on Knowledge from External Sources" class="ltx_ref"><span class="ltx_text ltx_ref_tag">5</span></a> relates the performance of the various models on five categories of questions. The ‘object’ category is the average of the accuracy of question types starting with ‘what kind/type/sport/animal/brand…’, while the ‘number’ and ‘color’ category corresponds to the question type ‘how many’ and ‘what color’.
The performance comparison across categories is of particular interest here because answering different classes of questions requires different amounts of external knowledge. The ‘Where’ questions, for instance, require knowledge of potential locations, and ‘Why’ questions typically require general knowledge about people’s motivation. ‘Number’ and ‘Color’ questions, in contrast, can be answered directly. The results show that for ‘Why’ questions, adding the KB improves performance by more than <math id="S5.SS3.SSS0.Px1.p2.1.m1.1" class="ltx_Math" alttext="50\%" display="inline"><semantics id="S5.SS3.SSS0.Px1.p2.1.m1.1a"><mrow id="S5.SS3.SSS0.Px1.p2.1.m1.1.1" xref="S5.SS3.SSS0.Px1.p2.1.m1.1.1.cmml"><mn id="S5.SS3.SSS0.Px1.p2.1.m1.1.1.2" xref="S5.SS3.SSS0.Px1.p2.1.m1.1.1.2.cmml">50</mn><mo id="S5.SS3.SSS0.Px1.p2.1.m1.1.1.1" xref="S5.SS3.SSS0.Px1.p2.1.m1.1.1.1.cmml">%</mo></mrow><annotation-xml encoding="MathML-Content" id="S5.SS3.SSS0.Px1.p2.1.m1.1b"><apply id="S5.SS3.SSS0.Px1.p2.1.m1.1.1.cmml" xref="S5.SS3.SSS0.Px1.p2.1.m1.1.1"><csymbol cd="latexml" id="S5.SS3.SSS0.Px1.p2.1.m1.1.1.1.cmml" xref="S5.SS3.SSS0.Px1.p2.1.m1.1.1.1">percent</csymbol><cn type="integer" id="S5.SS3.SSS0.Px1.p2.1.m1.1.1.2.cmml" xref="S5.SS3.SSS0.Px1.p2.1.m1.1.1.2">50</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS3.SSS0.Px1.p2.1.m1.1c">50\%</annotation></semantics></math> (Att-LSTM achieves <math id="S5.SS3.SSS0.Px1.p2.2.m2.1" class="ltx_Math" alttext="7.77\%" display="inline"><semantics id="S5.SS3.SSS0.Px1.p2.2.m2.1a"><mrow id="S5.SS3.SSS0.Px1.p2.2.m2.1.1" xref="S5.SS3.SSS0.Px1.p2.2.m2.1.1.cmml"><mn id="S5.SS3.SSS0.Px1.p2.2.m2.1.1.2" xref="S5.SS3.SSS0.Px1.p2.2.m2.1.1.2.cmml">7.77</mn><mo id="S5.SS3.SSS0.Px1.p2.2.m2.1.1.1" xref="S5.SS3.SSS0.Px1.p2.2.m2.1.1.1.cmml">%</mo></mrow><annotation-xml encoding="MathML-Content" id="S5.SS3.SSS0.Px1.p2.2.m2.1b"><apply id="S5.SS3.SSS0.Px1.p2.2.m2.1.1.cmml" xref="S5.SS3.SSS0.Px1.p2.2.m2.1.1"><csymbol cd="latexml" id="S5.SS3.SSS0.Px1.p2.2.m2.1.1.1.cmml" xref="S5.SS3.SSS0.Px1.p2.2.m2.1.1.1">percent</csymbol><cn type="float" id="S5.SS3.SSS0.Px1.p2.2.m2.1.1.2.cmml" xref="S5.SS3.SSS0.Px1.p2.2.m2.1.1.2">7.77</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS3.SSS0.Px1.p2.2.m2.1c">7.77\%</annotation></semantics></math> while Att+Know-LSTM achieves <math id="S5.SS3.SSS0.Px1.p2.3.m3.1" class="ltx_Math" alttext="11.88\%" display="inline"><semantics id="S5.SS3.SSS0.Px1.p2.3.m3.1a"><mrow id="S5.SS3.SSS0.Px1.p2.3.m3.1.1" xref="S5.SS3.SSS0.Px1.p2.3.m3.1.1.cmml"><mn id="S5.SS3.SSS0.Px1.p2.3.m3.1.1.2" xref="S5.SS3.SSS0.Px1.p2.3.m3.1.1.2.cmml">11.88</mn><mo id="S5.SS3.SSS0.Px1.p2.3.m3.1.1.1" xref="S5.SS3.SSS0.Px1.p2.3.m3.1.1.1.cmml">%</mo></mrow><annotation-xml encoding="MathML-Content" id="S5.SS3.SSS0.Px1.p2.3.m3.1b"><apply id="S5.SS3.SSS0.Px1.p2.3.m3.1.1.cmml" xref="S5.SS3.SSS0.Px1.p2.3.m3.1.1"><csymbol cd="latexml" id="S5.SS3.SSS0.Px1.p2.3.m3.1.1.1.cmml" xref="S5.SS3.SSS0.Px1.p2.3.m3.1.1.1">percent</csymbol><cn type="float" id="S5.SS3.SSS0.Px1.p2.3.m3.1.1.2.cmml" xref="S5.SS3.SSS0.Px1.p2.3.m3.1.1.2">11.88</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS3.SSS0.Px1.p2.3.m3.1c">11.88\%</annotation></semantics></math>), and that the combined A+C+K-LSTM achieves <math id="S5.SS3.SSS0.Px1.p2.4.m4.1" class="ltx_Math" alttext="13.53\%" display="inline"><semantics id="S5.SS3.SSS0.Px1.p2.4.m4.1a"><mrow id="S5.SS3.SSS0.Px1.p2.4.m4.1.1" xref="S5.SS3.SSS0.Px1.p2.4.m4.1.1.cmml"><mn id="S5.SS3.SSS0.Px1.p2.4.m4.1.1.2" xref="S5.SS3.SSS0.Px1.p2.4.m4.1.1.2.cmml">13.53</mn><mo id="S5.SS3.SSS0.Px1.p2.4.m4.1.1.1" xref="S5.SS3.SSS0.Px1.p2.4.m4.1.1.1.cmml">%</mo></mrow><annotation-xml encoding="MathML-Content" id="S5.SS3.SSS0.Px1.p2.4.m4.1b"><apply id="S5.SS3.SSS0.Px1.p2.4.m4.1.1.cmml" xref="S5.SS3.SSS0.Px1.p2.4.m4.1.1"><csymbol cd="latexml" id="S5.SS3.SSS0.Px1.p2.4.m4.1.1.1.cmml" xref="S5.SS3.SSS0.Px1.p2.4.m4.1.1.1">percent</csymbol><cn type="float" id="S5.SS3.SSS0.Px1.p2.4.m4.1.1.2.cmml" xref="S5.SS3.SSS0.Px1.p2.4.m4.1.1.2">13.53</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS3.SSS0.Px1.p2.4.m4.1c">13.53\%</annotation></semantics></math>.</p>
</div>
<figure id="S5.F5" class="ltx_figure"><img src="/html/1511.06973/assets/x5.png" id="S5.F5.1.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="392" height="285" alt="Refer to caption">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure">Figure 5: </span>Performance on five question categories for different models. The ‘Object’ category is the average accuracy of question types starting with ‘what kind/type/sport/animal/brand…’.</figcaption>
</figure>
<div id="S5.SS3.SSS0.Px1.p3" class="ltx_para">
<p id="S5.SS3.SSS0.Px1.p3.1" class="ltx_p">Table <a href="#S5.T5" title="Table 5 ‣ 5.3 Results on the VQA ‣ 5 Experiments ‣ Ask Me Anything: Free-form Visual Question Answering Based on Knowledge from External Sources" class="ltx_ref"><span class="ltx_text ltx_ref_tag">5</span></a> provides some indicative results, more results can be found in the supplementary material, including failure cases.</p>
</div>
<div id="S5.SS3.SSS0.Px1.p4" class="ltx_para">
<p id="S5.SS3.SSS0.Px1.p4.1" class="ltx_p">We have also tested on the VQA test-dev
and test-standard<span id="footnote2" class="ltx_note ltx_role_footnote"><sup class="ltx_note_mark">2</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">2</sup><span class="ltx_tag ltx_tag_note">2</span>http://www.visualqa.org/challenge.html</span></span></span>
consisting of 60,864 and 244,302 questions (for which ground truth answers are not published) using our final A+C+K-LSTM model, and evaluated them on the VQA evaluation server. Table <a href="#S5.T6" title="Table 6 ‣ Evaluation ‣ 5.3 Results on the VQA ‣ 5 Experiments ‣ Ask Me Anything: Free-form Visual Question Answering Based on Knowledge from External Sources" class="ltx_ref"><span class="ltx_text ltx_ref_tag">6</span></a> shows the server reported results.</p>
</div>
<figure id="S5.T6" class="ltx_table">
<div id="S5.T6.1" class="ltx_inline-block ltx_align_center ltx_transformed_outer" style="width:433.6pt;height:177.5pt;vertical-align:-0.0pt;"><span class="ltx_transformed_inner" style="transform:translate(-3.0pt,1.2pt) scale(0.986182995210035,0.986182995210035) ;">
<table id="S5.T6.1.1" class="ltx_tabular ltx_align_middle">
<tr id="S5.T6.1.1.1" class="ltx_tr">
<td id="S5.T6.1.1.1.1" class="ltx_td ltx_align_center" colspan="2">
<span class="ltx_rule" style="width:100%;height:0.8pt;background:black;display:inline-block;"> </span></td>
<td id="S5.T6.1.1.1.2" class="ltx_td ltx_align_center ltx_border_r" colspan="4">Test-dev</td>
<td id="S5.T6.1.1.1.3" class="ltx_td ltx_align_center" colspan="3">Test-standard</td>
</tr>
<tr id="S5.T6.1.1.2" class="ltx_tr">
<td id="S5.T6.1.1.2.1" class="ltx_td ltx_border_r"></td>
<td id="S5.T6.1.1.2.2" class="ltx_td ltx_align_center">All</td>
<td id="S5.T6.1.1.2.3" class="ltx_td ltx_align_center">Y/N</td>
<td id="S5.T6.1.1.2.4" class="ltx_td ltx_align_center">Num</td>
<td id="S5.T6.1.1.2.5" class="ltx_td ltx_align_center ltx_border_r">Others</td>
<td id="S5.T6.1.1.2.6" class="ltx_td ltx_align_center">All</td>
<td id="S5.T6.1.1.2.7" class="ltx_td ltx_align_center">Y/N</td>
<td id="S5.T6.1.1.2.8" class="ltx_td ltx_align_center">Num</td>
<td id="S5.T6.1.1.2.9" class="ltx_td ltx_align_center">Others</td>
</tr>
<tr id="S5.T6.1.1.3" class="ltx_tr">
<td id="S5.T6.1.1.3.1" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">Question <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib1" title="" class="ltx_ref">1</a>]</cite>
</td>
<td id="S5.T6.1.1.3.2" class="ltx_td ltx_align_center ltx_border_t">40.09</td>
<td id="S5.T6.1.1.3.3" class="ltx_td ltx_align_center ltx_border_t">75.66</td>
<td id="S5.T6.1.1.3.4" class="ltx_td ltx_align_center ltx_border_t">36.70</td>
<td id="S5.T6.1.1.3.5" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">27.14</td>
<td id="S5.T6.1.1.3.6" class="ltx_td ltx_align_center ltx_border_t">-</td>
<td id="S5.T6.1.1.3.7" class="ltx_td ltx_align_center ltx_border_t">-</td>
<td id="S5.T6.1.1.3.8" class="ltx_td ltx_align_center ltx_border_t">-</td>
<td id="S5.T6.1.1.3.9" class="ltx_td ltx_align_center ltx_border_t">-</td>
</tr>
<tr id="S5.T6.1.1.4" class="ltx_tr">
<td id="S5.T6.1.1.4.1" class="ltx_td ltx_align_center ltx_border_r">Image <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib1" title="" class="ltx_ref">1</a>]</cite>
</td>
<td id="S5.T6.1.1.4.2" class="ltx_td ltx_align_center">28.13</td>
<td id="S5.T6.1.1.4.3" class="ltx_td ltx_align_center">64.01</td>
<td id="S5.T6.1.1.4.4" class="ltx_td ltx_align_center">0.42</td>
<td id="S5.T6.1.1.4.5" class="ltx_td ltx_align_center ltx_border_r">3.77</td>
<td id="S5.T6.1.1.4.6" class="ltx_td ltx_align_center">-</td>
<td id="S5.T6.1.1.4.7" class="ltx_td ltx_align_center">-</td>
<td id="S5.T6.1.1.4.8" class="ltx_td ltx_align_center">-</td>
<td id="S5.T6.1.1.4.9" class="ltx_td ltx_align_center">-</td>
</tr>
<tr id="S5.T6.1.1.5" class="ltx_tr">
<td id="S5.T6.1.1.5.1" class="ltx_td ltx_align_center ltx_border_r">Q+I <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib1" title="" class="ltx_ref">1</a>]</cite>
</td>
<td id="S5.T6.1.1.5.2" class="ltx_td ltx_align_center">52.64</td>
<td id="S5.T6.1.1.5.3" class="ltx_td ltx_align_center">75.55</td>
<td id="S5.T6.1.1.5.4" class="ltx_td ltx_align_center">33.67</td>
<td id="S5.T6.1.1.5.5" class="ltx_td ltx_align_center ltx_border_r">37.37</td>
<td id="S5.T6.1.1.5.6" class="ltx_td ltx_align_center">-</td>
<td id="S5.T6.1.1.5.7" class="ltx_td ltx_align_center">-</td>
<td id="S5.T6.1.1.5.8" class="ltx_td ltx_align_center">-</td>
<td id="S5.T6.1.1.5.9" class="ltx_td ltx_align_center">-</td>
</tr>
<tr id="S5.T6.1.1.6" class="ltx_tr">
<td id="S5.T6.1.1.6.1" class="ltx_td ltx_align_center ltx_border_r">LSTM Q <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib1" title="" class="ltx_ref">1</a>]</cite>
</td>
<td id="S5.T6.1.1.6.2" class="ltx_td ltx_align_center">48.76</td>
<td id="S5.T6.1.1.6.3" class="ltx_td ltx_align_center">78.20</td>
<td id="S5.T6.1.1.6.4" class="ltx_td ltx_align_center">35.68</td>
<td id="S5.T6.1.1.6.5" class="ltx_td ltx_align_center ltx_border_r">26.59</td>
<td id="S5.T6.1.1.6.6" class="ltx_td ltx_align_center">48.89</td>
<td id="S5.T6.1.1.6.7" class="ltx_td ltx_align_center">78.12</td>
<td id="S5.T6.1.1.6.8" class="ltx_td ltx_align_center">34.94</td>
<td id="S5.T6.1.1.6.9" class="ltx_td ltx_align_center">26.99</td>
</tr>
<tr id="S5.T6.1.1.7" class="ltx_tr">
<td id="S5.T6.1.1.7.1" class="ltx_td ltx_align_center ltx_border_r">LSTM Q+I <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib1" title="" class="ltx_ref">1</a>]</cite>
</td>
<td id="S5.T6.1.1.7.2" class="ltx_td ltx_align_center">53.74</td>
<td id="S5.T6.1.1.7.3" class="ltx_td ltx_align_center">78.94</td>
<td id="S5.T6.1.1.7.4" class="ltx_td ltx_align_center">35.24</td>
<td id="S5.T6.1.1.7.5" class="ltx_td ltx_align_center ltx_border_r">36.42</td>
<td id="S5.T6.1.1.7.6" class="ltx_td ltx_align_center">54.06</td>
<td id="S5.T6.1.1.7.7" class="ltx_td ltx_align_center">79.01</td>
<td id="S5.T6.1.1.7.8" class="ltx_td ltx_align_center">35.55</td>
<td id="S5.T6.1.1.7.9" class="ltx_td ltx_align_center">36.80</td>
</tr>
<tr id="S5.T6.1.1.8" class="ltx_tr">
<td id="S5.T6.1.1.8.1" class="ltx_td ltx_align_center ltx_border_r">Human <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib1" title="" class="ltx_ref">1</a>]</cite>
</td>
<td id="S5.T6.1.1.8.2" class="ltx_td ltx_align_center">-</td>
<td id="S5.T6.1.1.8.3" class="ltx_td ltx_align_center">-</td>
<td id="S5.T6.1.1.8.4" class="ltx_td ltx_align_center">-</td>
<td id="S5.T6.1.1.8.5" class="ltx_td ltx_align_center ltx_border_r">-</td>
<td id="S5.T6.1.1.8.6" class="ltx_td ltx_align_center">83.30</td>
<td id="S5.T6.1.1.8.7" class="ltx_td ltx_align_center">95.77</td>
<td id="S5.T6.1.1.8.8" class="ltx_td ltx_align_center">83.39</td>
<td id="S5.T6.1.1.8.9" class="ltx_td ltx_align_center">72.67</td>
</tr>
<tr id="S5.T6.1.1.9" class="ltx_tr">
<td id="S5.T6.1.1.9.1" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">Ours</td>
<td id="S5.T6.1.1.9.2" class="ltx_td ltx_align_center ltx_border_t"><span id="S5.T6.1.1.9.2.1" class="ltx_text ltx_font_bold">59.17</span></td>
<td id="S5.T6.1.1.9.3" class="ltx_td ltx_align_center ltx_border_t"><span id="S5.T6.1.1.9.3.1" class="ltx_text ltx_font_bold">81.01</span></td>
<td id="S5.T6.1.1.9.4" class="ltx_td ltx_align_center ltx_border_t"><span id="S5.T6.1.1.9.4.1" class="ltx_text ltx_font_bold">38.42</span></td>
<td id="S5.T6.1.1.9.5" class="ltx_td ltx_align_center ltx_border_r ltx_border_t"><span id="S5.T6.1.1.9.5.1" class="ltx_text ltx_font_bold">45.23</span></td>
<td id="S5.T6.1.1.9.6" class="ltx_td ltx_align_center ltx_border_t"><span id="S5.T6.1.1.9.6.1" class="ltx_text ltx_font_bold">59.44</span></td>
<td id="S5.T6.1.1.9.7" class="ltx_td ltx_align_center ltx_border_t"><span id="S5.T6.1.1.9.7.1" class="ltx_text ltx_font_bold">81.07</span></td>
<td id="S5.T6.1.1.9.8" class="ltx_td ltx_align_center ltx_border_t"><span id="S5.T6.1.1.9.8.1" class="ltx_text ltx_font_bold">37.12</span></td>
<td id="S5.T6.1.1.9.9" class="ltx_td ltx_align_center ltx_border_t"><span id="S5.T6.1.1.9.9.1" class="ltx_text ltx_font_bold">45.83</span></td>
</tr>
<tr id="S5.T6.1.1.10" class="ltx_tr">
<td id="S5.T6.1.1.10.1" class="ltx_td ltx_align_center"><span class="ltx_rule" style="width:100%;height:0.8pt;background:black;display:inline-block;"> </span></td>
<td id="S5.T6.1.1.10.2" class="ltx_td"></td>
<td id="S5.T6.1.1.10.3" class="ltx_td"></td>
<td id="S5.T6.1.1.10.4" class="ltx_td"></td>
<td id="S5.T6.1.1.10.5" class="ltx_td"></td>
<td id="S5.T6.1.1.10.6" class="ltx_td"></td>
<td id="S5.T6.1.1.10.7" class="ltx_td"></td>
<td id="S5.T6.1.1.10.8" class="ltx_td"></td>
<td id="S5.T6.1.1.10.9" class="ltx_td"></td>
</tr>
</table>
</span></div>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table">Table 6: </span>VQA Open-Ended evaluation server results for our method. Accuracies for different answer types and overall performances on test-dev and test-standard datasets are shown.</figcaption>
</figure>
<div id="S5.SS3.SSS0.Px1.p5" class="ltx_para">
<p id="S5.SS3.SSS0.Px1.p5.1" class="ltx_p">Antol <em id="S5.SS3.SSS0.Px1.p5.1.1" class="ltx_emph ltx_font_italic">et al</em>.<span id="S5.SS3.SSS0.Px1.p5.1.2" class="ltx_text"></span> <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib1" title="" class="ltx_ref">1</a>]</cite> provide several results for this dataset. In each case they encode the image with the final hidden layer from VggNet, and questions are encoded using a BOW representation. A softmax neural network classifier with 2 hidden layers and 1000 hidden units (dropout 0.5) in each layer with tanh non-linearity is then trained, the output space of which is the 1000 most frequent answers in the training set. They also provide an LSTM model followed by a softmax layer to generate the answer. Two versions of this approach are used, one which is given both the question and the image, and one which is given only the question (see <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib1" title="" class="ltx_ref">1</a>]</cite> for details). Our final model outperforms the listed approaches according to the overall accuracy and all answer types.</p>
</div>
</section>
</section>
</section>
<section id="S6" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">6 </span>Conclusion</h2>

<div id="S6.p1" class="ltx_para">
<p id="S6.p1.1" class="ltx_p">Open-ended visual question answering is an interesting challenge for computer vision, not least because it represents a move away from purely image-based analysis and towards a broader form of artificial visual intelligence. In this paper we have shown that it is possible to extend the state-of-the-art RNN-based VQA approach so as to incorporate the large volumes of information required to answer general, open-ended, questions about images. The knowledge bases which are currently available do not contain much of the information which would be beneficial to this process, but none-the-less can still be used to significantly improve performance on questions requiring external knowledge (such as ‘Why’ questions). The approach that we propose is very general, however, and will be applicable to more informative knowledge bases should they become available. At the time of writing this paper, our system performs the best on two large-scale VQA datasets and produces promising results on the VQA evaluation server.
Further work includes generating knowledge-base queries which reflect the content of the question and the image, in order to extract more specifically related information.</p>
</div>
<div id="S6.p2" class="ltx_para">
<p id="S6.p2.1" class="ltx_p">It seems inevitable that successful general visual question answering will demand access to a large external knowledge base. We have shown that this is possible using the LSTM-based approach, and that it improves performance. We hope this might lead the way to a visual question answering approach which is capable of deeper analysis of image content, and even common sense.</p>
</div>
<div id="S6.p3" class="ltx_para">
<p id="S6.p3.1" class="ltx_p"><span id="S6.p3.1.1" class="ltx_text ltx_font_bold">Acknowledgements</span>
This research was in part supported by the Data to Decisions Cooperative Research Centre.</p>
</div>
</section>
<section id="bib" class="ltx_bibliography">
<h2 class="ltx_title ltx_title_bibliography" style="font-size:90%;">References</h2>

<ul class="ltx_biblist">
<li id="bib.bib1" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[1]</span>
<span class="ltx_bibblock"><span id="bib.bib1.1.1" class="ltx_text" style="font-size:90%;">
S. Antol, A. Agrawal, J. Lu, M. Mitchell, D. Batra, C. L. Zitnick, and
D. Parikh.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib1.2.1" class="ltx_text" style="font-size:90%;">VQA: Visual Question Answering.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib1.3.1" class="ltx_text" style="font-size:90%;">In </span><span id="bib.bib1.4.2" class="ltx_text ltx_font_italic" style="font-size:90%;">Proc. IEEE Int. Conf. Comp. Vis.</span><span id="bib.bib1.5.3" class="ltx_text" style="font-size:90%;">, 2015.
</span>
</span>
</li>
<li id="bib.bib2" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[2]</span>
<span class="ltx_bibblock"><span id="bib.bib2.1.1" class="ltx_text" style="font-size:90%;">
S. Auer, C. Bizer, G. Kobilarov, J. Lehmann, R. Cyganiak, and Z. Ives.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib2.2.1" class="ltx_text ltx_font_italic" style="font-size:90%;">Dbpedia: A nucleus for a web of open data</span><span id="bib.bib2.3.2" class="ltx_text" style="font-size:90%;">.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib2.4.1" class="ltx_text" style="font-size:90%;">Springer, 2007.
</span>
</span>
</li>
<li id="bib.bib3" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[3]</span>
<span class="ltx_bibblock"><span id="bib.bib3.1.1" class="ltx_text" style="font-size:90%;">
J. Berant, A. Chou, R. Frostig, and P. Liang.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib3.2.1" class="ltx_text" style="font-size:90%;">Semantic Parsing on Freebase from Question-Answer Pairs.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib3.3.1" class="ltx_text" style="font-size:90%;">In </span><span id="bib.bib3.4.2" class="ltx_text ltx_font_italic" style="font-size:90%;">Proc. Conf. Empirical Methods in Natural Language
Processing</span><span id="bib.bib3.5.3" class="ltx_text" style="font-size:90%;">, pages 1533–1544, 2013.
</span>
</span>
</li>
<li id="bib.bib4" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[4]</span>
<span class="ltx_bibblock"><span id="bib.bib4.1.1" class="ltx_text" style="font-size:90%;">
K. Bollacker, C. Evans, P. Paritosh, T. Sturge, and J. Taylor.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib4.2.1" class="ltx_text" style="font-size:90%;">Freebase: a collaboratively created graph database for structuring
human knowledge.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib4.3.1" class="ltx_text" style="font-size:90%;">In </span><span id="bib.bib4.4.2" class="ltx_text ltx_font_italic" style="font-size:90%;">Proceedings of the 2008 ACM SIGMOD international conference
on Management of data</span><span id="bib.bib4.5.3" class="ltx_text" style="font-size:90%;">, pages 1247–1250. ACM, 2008.
</span>
</span>
</li>
<li id="bib.bib5" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[5]</span>
<span class="ltx_bibblock"><span id="bib.bib5.1.1" class="ltx_text" style="font-size:90%;">
X. Chen, H. Fang, T.-Y. Lin, R. Vedantam, S. Gupta, P. Dollar, and C. L.
Zitnick.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib5.2.1" class="ltx_text" style="font-size:90%;">Microsoft COCO captions: Data collection and evaluation server.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib5.3.1" class="ltx_text ltx_font_italic" style="font-size:90%;">arXiv:1504.00325</span><span id="bib.bib5.4.2" class="ltx_text" style="font-size:90%;">, 2015.
</span>
</span>
</li>
<li id="bib.bib6" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[6]</span>
<span class="ltx_bibblock"><span id="bib.bib6.1.1" class="ltx_text" style="font-size:90%;">
X. Chen and C. L. Zitnick.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib6.2.1" class="ltx_text" style="font-size:90%;">Learning a Recurrent Visual Representation for Image Caption
Generation.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib6.3.1" class="ltx_text" style="font-size:90%;">In </span><span id="bib.bib6.4.2" class="ltx_text ltx_font_italic" style="font-size:90%;">Proc. IEEE Conf. Comp. Vis. Patt. Recogn.</span><span id="bib.bib6.5.3" class="ltx_text" style="font-size:90%;">, 2015.
</span>
</span>
</li>
<li id="bib.bib7" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[7]</span>
<span class="ltx_bibblock"><span id="bib.bib7.1.1" class="ltx_text" style="font-size:90%;">
K. Cho, B. van Merrienboer, C. Gulcehre, F. Bougares, H. Schwenk, and
Y. Bengio.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib7.2.1" class="ltx_text" style="font-size:90%;">Learning phrase representations using rnn encoder-decoder for
statistical machine translation.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib7.3.1" class="ltx_text" style="font-size:90%;">In </span><span id="bib.bib7.4.2" class="ltx_text ltx_font_italic" style="font-size:90%;">Proc. Conf. Empirical Methods in Natural Language
Processing</span><span id="bib.bib7.5.3" class="ltx_text" style="font-size:90%;">, 2014.
</span>
</span>
</li>
<li id="bib.bib8" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[8]</span>
<span class="ltx_bibblock"><span id="bib.bib8.1.1" class="ltx_text" style="font-size:90%;">
J. Deng, W. Dong, R. Socher, L.-J. Li, K. Li, and L. Fei-Fei.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib8.2.1" class="ltx_text" style="font-size:90%;">Imagenet: A large-scale hierarchical image database.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib8.3.1" class="ltx_text" style="font-size:90%;">In </span><span id="bib.bib8.4.2" class="ltx_text ltx_font_italic" style="font-size:90%;">Proc. IEEE Conf. Comp. Vis. Patt. Recogn.</span><span id="bib.bib8.5.3" class="ltx_text" style="font-size:90%;">, 2009.
</span>
</span>
</li>
<li id="bib.bib9" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[9]</span>
<span class="ltx_bibblock"><span id="bib.bib9.1.1" class="ltx_text" style="font-size:90%;">
J. Donahue, L. A. Hendricks, S. Guadarrama, M. Rohrbach, S. Venugopalan,
K. Saenko, and T. Darrell.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib9.2.1" class="ltx_text" style="font-size:90%;">Long-term recurrent convolutional networks for visual recognition
and description.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib9.3.1" class="ltx_text" style="font-size:90%;">In </span><span id="bib.bib9.4.2" class="ltx_text ltx_font_italic" style="font-size:90%;">Proc. IEEE Conf. Comp. Vis. Patt. Recogn.</span><span id="bib.bib9.5.3" class="ltx_text" style="font-size:90%;">, 2015.
</span>
</span>
</li>
<li id="bib.bib10" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[10]</span>
<span class="ltx_bibblock"><span id="bib.bib10.1.1" class="ltx_text" style="font-size:90%;">
D. Ferrucci, E. Brown, J. Chu-Carroll, J. Fan, D. Gondek, A. A. Kalyanpur,
A. Lally, J. W. Murdock, E. Nyberg, J. Prager, et al.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib10.2.1" class="ltx_text" style="font-size:90%;">Building Watson: An overview of the DeepQA project.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib10.3.1" class="ltx_text ltx_font_italic" style="font-size:90%;">AI magazine</span><span id="bib.bib10.4.2" class="ltx_text" style="font-size:90%;">, 31(3):59–79, 2010.
</span>
</span>
</li>
<li id="bib.bib11" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[11]</span>
<span class="ltx_bibblock"><span id="bib.bib11.1.1" class="ltx_text" style="font-size:90%;">
H. Gao, J. Mao, J. Zhou, Z. Huang, L. Wang, and W. Xu.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib11.2.1" class="ltx_text" style="font-size:90%;">Are You Talking to a Machine? Dataset and Methods for Multilingual
Image Question Answering.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib11.3.1" class="ltx_text" style="font-size:90%;">In </span><span id="bib.bib11.4.2" class="ltx_text ltx_font_italic" style="font-size:90%;">Proc. Advances in Neural Inf. Process. Syst.</span><span id="bib.bib11.5.3" class="ltx_text" style="font-size:90%;">, 2015.
</span>
</span>
</li>
<li id="bib.bib12" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[12]</span>
<span class="ltx_bibblock"><span id="bib.bib12.1.1" class="ltx_text" style="font-size:90%;">
D. Geman, S. Geman, N. Hallonquist, and L. Younes.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib12.2.1" class="ltx_text" style="font-size:90%;">Visual Turing test for computer vision systems.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib12.3.1" class="ltx_text ltx_font_italic" style="font-size:90%;">Proceedings of the National Academy of Sciences</span><span id="bib.bib12.4.2" class="ltx_text" style="font-size:90%;">,
112(12):3618–3623, 2015.
</span>
</span>
</li>
<li id="bib.bib13" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[13]</span>
<span class="ltx_bibblock"><span id="bib.bib13.1.1" class="ltx_text" style="font-size:90%;">
S. Hochreiter and J. Schmidhuber.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib13.2.1" class="ltx_text" style="font-size:90%;">Long short-term memory.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib13.3.1" class="ltx_text ltx_font_italic" style="font-size:90%;">Neural Computation</span><span id="bib.bib13.4.2" class="ltx_text" style="font-size:90%;">, 9(8):1735–1780, 1997.
</span>
</span>
</li>
<li id="bib.bib14" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[14]</span>
<span class="ltx_bibblock"><span id="bib.bib14.1.1" class="ltx_text" style="font-size:90%;">
A. Karpathy, A. Joulin, and F. F. Li.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib14.2.1" class="ltx_text" style="font-size:90%;">Deep fragment embeddings for bidirectional image sentence mapping.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib14.3.1" class="ltx_text" style="font-size:90%;">In </span><span id="bib.bib14.4.2" class="ltx_text ltx_font_italic" style="font-size:90%;">Proc. Advances in Neural Inf. Process. Syst.</span><span id="bib.bib14.5.3" class="ltx_text" style="font-size:90%;">, 2014.
</span>
</span>
</li>
<li id="bib.bib15" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[15]</span>
<span class="ltx_bibblock"><span id="bib.bib15.1.1" class="ltx_text" style="font-size:90%;">
Q. V. Le and T. Mikolov.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib15.2.1" class="ltx_text" style="font-size:90%;">Distributed representations of sentences and documents.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib15.3.1" class="ltx_text ltx_font_italic" style="font-size:90%;">arXiv preprint arXiv:1405.4053</span><span id="bib.bib15.4.2" class="ltx_text" style="font-size:90%;">, 2014.
</span>
</span>
</li>
<li id="bib.bib16" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[16]</span>
<span class="ltx_bibblock"><span id="bib.bib16.1.1" class="ltx_text" style="font-size:90%;">
X. Lin and D. Parikh.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib16.2.1" class="ltx_text" style="font-size:90%;">Don’t Just Listen, Use Your Imagination: Leveraging Visual Common
Sense for Non-Visual Tasks.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib16.3.1" class="ltx_text" style="font-size:90%;">In </span><span id="bib.bib16.4.2" class="ltx_text ltx_font_italic" style="font-size:90%;">Proc. IEEE Conf. Comp. Vis. Patt. Recogn.</span><span id="bib.bib16.5.3" class="ltx_text" style="font-size:90%;">, June 2015.
</span>
</span>
</li>
<li id="bib.bib17" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[17]</span>
<span class="ltx_bibblock"><span id="bib.bib17.1.1" class="ltx_text" style="font-size:90%;">
L. Ma, Z. Lu, and H. Li.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib17.2.1" class="ltx_text" style="font-size:90%;">Learning to Answer Questions From Image using Convolutional Neural
Network.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib17.3.1" class="ltx_text ltx_font_italic" style="font-size:90%;">arXiv:1506.00333</span><span id="bib.bib17.4.2" class="ltx_text" style="font-size:90%;">, 2015.
</span>
</span>
</li>
<li id="bib.bib18" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[18]</span>
<span class="ltx_bibblock"><span id="bib.bib18.1.1" class="ltx_text" style="font-size:90%;">
M. Malinowski and M. Fritz.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib18.2.1" class="ltx_text" style="font-size:90%;">A multi-world approach to question answering about real-world scenes
based on uncertain input.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib18.3.1" class="ltx_text" style="font-size:90%;">In </span><span id="bib.bib18.4.2" class="ltx_text ltx_font_italic" style="font-size:90%;">Proc. Advances in Neural Inf. Process. Syst.</span><span id="bib.bib18.5.3" class="ltx_text" style="font-size:90%;">, pages
1682–1690, 2014.
</span>
</span>
</li>
<li id="bib.bib19" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[19]</span>
<span class="ltx_bibblock"><span id="bib.bib19.1.1" class="ltx_text" style="font-size:90%;">
M. Malinowski and M. Fritz.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib19.2.1" class="ltx_text" style="font-size:90%;">Towards a Visual Turing Challenge.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib19.3.1" class="ltx_text ltx_font_italic" style="font-size:90%;">arXiv:1410.8027</span><span id="bib.bib19.4.2" class="ltx_text" style="font-size:90%;">, 2014.
</span>
</span>
</li>
<li id="bib.bib20" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[20]</span>
<span class="ltx_bibblock"><span id="bib.bib20.1.1" class="ltx_text" style="font-size:90%;">
M. Malinowski, M. Rohrbach, and M. Fritz.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib20.2.1" class="ltx_text" style="font-size:90%;">Ask Your Neurons: A Neural-based Approach to Answering Questions
about Images.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib20.3.1" class="ltx_text" style="font-size:90%;">In </span><span id="bib.bib20.4.2" class="ltx_text ltx_font_italic" style="font-size:90%;">Proc. IEEE Int. Conf. Comp. Vis.</span><span id="bib.bib20.5.3" class="ltx_text" style="font-size:90%;">, 2015.
</span>
</span>
</li>
<li id="bib.bib21" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[21]</span>
<span class="ltx_bibblock"><span id="bib.bib21.1.1" class="ltx_text" style="font-size:90%;">
J. Mao, W. Xu, Y. Yang, J. Wang, and A. Yuille.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib21.2.1" class="ltx_text" style="font-size:90%;">Deep Captioning with Multimodal Recurrent Neural Networks (m-RNN).
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib21.3.1" class="ltx_text" style="font-size:90%;">In </span><span id="bib.bib21.4.2" class="ltx_text ltx_font_italic" style="font-size:90%;">Proc. Int. Conf. Learn. Representations</span><span id="bib.bib21.5.3" class="ltx_text" style="font-size:90%;">, 2015.
</span>
</span>
</li>
<li id="bib.bib22" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[22]</span>
<span class="ltx_bibblock"><span id="bib.bib22.1.1" class="ltx_text" style="font-size:90%;">
J. Pont-Tuset, P. Arbeláez, J. Barron, F. Marques, and J. Malik.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib22.2.1" class="ltx_text" style="font-size:90%;">Multiscale Combinatorial Grouping for Image Segmentation and Object
Proposal Generation.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib22.3.1" class="ltx_text" style="font-size:90%;">In </span><span id="bib.bib22.4.2" class="ltx_text ltx_font_italic" style="font-size:90%;">arXiv:1503.00848</span><span id="bib.bib22.5.3" class="ltx_text" style="font-size:90%;">, March 2015.
</span>
</span>
</li>
<li id="bib.bib23" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[23]</span>
<span class="ltx_bibblock"><span id="bib.bib23.1.1" class="ltx_text" style="font-size:90%;">
M. Ren, R. Kiros, and R. Zemel.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib23.2.1" class="ltx_text" style="font-size:90%;">Image Question Answering: A Visual Semantic Embedding Model and a
New Dataset.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib23.3.1" class="ltx_text" style="font-size:90%;">In </span><span id="bib.bib23.4.2" class="ltx_text ltx_font_italic" style="font-size:90%;">Proc. Advances in Neural Inf. Process. Syst.</span><span id="bib.bib23.5.3" class="ltx_text" style="font-size:90%;">, 2015.
</span>
</span>
</li>
<li id="bib.bib24" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[24]</span>
<span class="ltx_bibblock"><span id="bib.bib24.1.1" class="ltx_text" style="font-size:90%;">
F. Sadeghi, S. K. Kumar Divvala, and A. Farhadi.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib24.2.1" class="ltx_text" style="font-size:90%;">VisKE: Visual Knowledge Extraction and Question Answering by Visual
Verification of Relation Phrases.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib24.3.1" class="ltx_text" style="font-size:90%;">In </span><span id="bib.bib24.4.2" class="ltx_text ltx_font_italic" style="font-size:90%;">Proc. IEEE Conf. Comp. Vis. Patt. Recogn.</span><span id="bib.bib24.5.3" class="ltx_text" style="font-size:90%;">, June 2015.
</span>
</span>
</li>
<li id="bib.bib25" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[25]</span>
<span class="ltx_bibblock"><span id="bib.bib25.1.1" class="ltx_text" style="font-size:90%;">
K. Simonyan and A. Zisserman.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib25.2.1" class="ltx_text" style="font-size:90%;">Very deep convolutional networks for large-scale image recognition.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib25.3.1" class="ltx_text ltx_font_italic" style="font-size:90%;">arXiv:1409.1556</span><span id="bib.bib25.4.2" class="ltx_text" style="font-size:90%;">, 2014.
</span>
</span>
</li>
<li id="bib.bib26" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[26]</span>
<span class="ltx_bibblock"><span id="bib.bib26.1.1" class="ltx_text" style="font-size:90%;">
I. Sutskever, O. Vinyals, and Q. V. Le.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib26.2.1" class="ltx_text" style="font-size:90%;">Sequence to sequence learning with neural networks.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib26.3.1" class="ltx_text" style="font-size:90%;">In </span><span id="bib.bib26.4.2" class="ltx_text ltx_font_italic" style="font-size:90%;">Proc. Advances in Neural Inf. Process. Syst.</span><span id="bib.bib26.5.3" class="ltx_text" style="font-size:90%;">, 2014.
</span>
</span>
</li>
<li id="bib.bib27" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[27]</span>
<span class="ltx_bibblock"><span id="bib.bib27.1.1" class="ltx_text" style="font-size:90%;">
K. Tu, M. Meng, M. W. Lee, T. E. Choe, and S.-C. Zhu.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib27.2.1" class="ltx_text" style="font-size:90%;">Joint video and text parsing for understanding events and answering
queries.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib27.3.1" class="ltx_text ltx_font_italic" style="font-size:90%;">IEEE Trans. Multimedia</span><span id="bib.bib27.4.2" class="ltx_text" style="font-size:90%;">, 21(2):42–70, 2014.
</span>
</span>
</li>
<li id="bib.bib28" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[28]</span>
<span class="ltx_bibblock"><span id="bib.bib28.1.1" class="ltx_text" style="font-size:90%;">
O. Vinyals, A. Toshev, S. Bengio, and D. Erhan.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib28.2.1" class="ltx_text" style="font-size:90%;">Show and tell: A neural image caption generator.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib28.3.1" class="ltx_text" style="font-size:90%;">In </span><span id="bib.bib28.4.2" class="ltx_text ltx_font_italic" style="font-size:90%;">Proc. IEEE Conf. Comp. Vis. Patt. Recogn.</span><span id="bib.bib28.5.3" class="ltx_text" style="font-size:90%;">, 2014.
</span>
</span>
</li>
<li id="bib.bib29" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[29]</span>
<span class="ltx_bibblock"><span id="bib.bib29.1.1" class="ltx_text" style="font-size:90%;">
Y. Wei, W. Xia, J. Huang, B. Ni, J. Dong, Y. Zhao, and S. Yan.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib29.2.1" class="ltx_text" style="font-size:90%;">CNN: Single-label to multi-label.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib29.3.1" class="ltx_text ltx_font_italic" style="font-size:90%;">arXiv:1406.5726</span><span id="bib.bib29.4.2" class="ltx_text" style="font-size:90%;">, 2014.
</span>
</span>
</li>
<li id="bib.bib30" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[30]</span>
<span class="ltx_bibblock"><span id="bib.bib30.1.1" class="ltx_text" style="font-size:90%;">
Q. Wu, C. Shen, A. v. d. Hengel, L. Liu, and A. Dick.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib30.2.1" class="ltx_text" style="font-size:90%;">What Value Do Explicit High Level Concepts Have in Vision to
Language Problems?
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib30.3.1" class="ltx_text" style="font-size:90%;">In </span><span id="bib.bib30.4.2" class="ltx_text ltx_font_italic" style="font-size:90%;">Proc. IEEE Conf. Comp. Vis. Patt. Recogn.</span><span id="bib.bib30.5.3" class="ltx_text" style="font-size:90%;">, 2016.
</span>
</span>
</li>
<li id="bib.bib31" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[31]</span>
<span class="ltx_bibblock"><span id="bib.bib31.1.1" class="ltx_text" style="font-size:90%;">
Z. Wu and M. Palmer.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib31.2.1" class="ltx_text" style="font-size:90%;">Verbs semantics and lexical selection.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib31.3.1" class="ltx_text" style="font-size:90%;">In </span><span id="bib.bib31.4.2" class="ltx_text ltx_font_italic" style="font-size:90%;">Proc. Conf. Association for Computational Linguistics</span><span id="bib.bib31.5.3" class="ltx_text" style="font-size:90%;">, 1994.
</span>
</span>
</li>
<li id="bib.bib32" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[32]</span>
<span class="ltx_bibblock"><span id="bib.bib32.1.1" class="ltx_text" style="font-size:90%;">
L. Yao, A. Torabi, K. Cho, N. Ballas, C. Pal, H. Larochelle, and A. Courville.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib32.2.1" class="ltx_text" style="font-size:90%;">Describing videos by exploiting temporal structure.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib32.3.1" class="ltx_text ltx_font_italic" style="font-size:90%;">arXiv:1502.08029</span><span id="bib.bib32.4.2" class="ltx_text" style="font-size:90%;">, 2015.
</span>
</span>
</li>
<li id="bib.bib33" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[33]</span>
<span class="ltx_bibblock"><span id="bib.bib33.1.1" class="ltx_text" style="font-size:90%;">
Y. Zhu, C. Zhang, C. Ré, and L. Fei-Fei.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib33.2.1" class="ltx_text" style="font-size:90%;">Building a Large-scale Multimodal Knowledge Base for Visual Question
Answering.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib33.3.1" class="ltx_text ltx_font_italic" style="font-size:90%;">arXiv:1507.05670</span><span id="bib.bib33.4.2" class="ltx_text" style="font-size:90%;">, 2015.
</span>
</span>
</li>
</ul>
</section>
</article>
</div>
<div class="ar5iv-footer"><a href="/html/1511.06972" class="ar5iv-nav-button ar5iv-nav-button-prev">◄</a>
    <a class="ar5iv-home-button" href="/"><img height="40" alt="ar5iv homepage" src="/assets/ar5iv.png"></a>
    <a href="/feeling_lucky" class="ar5iv-text-button">Feeling<br>lucky?</a>
    <a href="/log/1511.06973" class="ar5iv-text-button ar5iv-severity-error">Conversion<br>report</a>
    <a class="ar5iv-text-button" target="_blank" href="https://github.com/dginev/ar5iv/issues/new?template=improve-article--arxiv-id-.md&title=Improve+article+1511.06973">Report<br>an issue</a>
    <a href="https://arxiv.org/abs/1511.06973" class="ar5iv-text-button arxiv-ui-theme">View&nbsp;original<br>on&nbsp;arXiv</a><a href="/html/1511.06974" class="ar5iv-nav-button ar5iv-nav-button-next">►</a>
</div><footer class="ltx_page_footer">
<a class="ar5iv-toggle-color-scheme" href="javascript:toggleColorScheme()" title="Toggle ar5iv color scheme"><span class="color-scheme-icon"></span></a>
<a class="ar5iv-footer-button" href="https://arxiv.org/help/license" target="_blank">Copyright</a>
<a class="ar5iv-footer-button" href="https://arxiv.org/help/policies/privacy_policy" target="_blank">Privacy Policy</a>

<div class="ltx_page_logo">Generated  on Sun Mar  3 09:30:37 2024 by <a target="_blank" href="http://dlmf.nist.gov/LaTeXML/" class="ltx_LaTeXML_logo"><span style="letter-spacing:-0.2em; margin-right:0.1em;">L<span class="ltx_font_smallcaps" style="position:relative; bottom:2.2pt;">a</span>T<span class="ltx_font_smallcaps" style="font-size:120%;position:relative; bottom:-0.2ex;">e</span></span><span style="font-size:90%; position:relative; bottom:-0.2ex;">XML</span><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAsAAAAOCAYAAAD5YeaVAAAAAXNSR0IArs4c6QAAAAZiS0dEAP8A/wD/oL2nkwAAAAlwSFlzAAALEwAACxMBAJqcGAAAAAd0SU1FB9wKExQZLWTEaOUAAAAddEVYdENvbW1lbnQAQ3JlYXRlZCB3aXRoIFRoZSBHSU1Q72QlbgAAAdpJREFUKM9tkL+L2nAARz9fPZNCKFapUn8kyI0e4iRHSR1Kb8ng0lJw6FYHFwv2LwhOpcWxTjeUunYqOmqd6hEoRDhtDWdA8ApRYsSUCDHNt5ul13vz4w0vWCgUnnEc975arX6ORqN3VqtVZbfbTQC4uEHANM3jSqXymFI6yWazP2KxWAXAL9zCUa1Wy2tXVxheKA9YNoR8Pt+aTqe4FVVVvz05O6MBhqUIBGk8Hn8HAOVy+T+XLJfLS4ZhTiRJgqIoVBRFIoric47jPnmeB1mW/9rr9ZpSSn3Lsmir1fJZlqWlUonKsvwWwD8ymc/nXwVBeLjf7xEKhdBut9Hr9WgmkyGEkJwsy5eHG5vN5g0AKIoCAEgkEkin0wQAfN9/cXPdheu6P33fBwB4ngcAcByHJpPJl+fn54mD3Gg0NrquXxeLRQAAwzAYj8cwTZPwPH9/sVg8PXweDAauqqr2cDjEer1GJBLBZDJBs9mE4zjwfZ85lAGg2+06hmGgXq+j3+/DsixYlgVN03a9Xu8jgCNCyIegIAgx13Vfd7vdu+FweG8YRkjXdWy329+dTgeSJD3ieZ7RNO0VAXAPwDEAO5VKndi2fWrb9jWl9Esul6PZbDY9Go1OZ7PZ9z/lyuD3OozU2wAAAABJRU5ErkJggg==" alt="Mascot Sammy"></a>
</div></footer>
</div>

    <script>
      var canMathML = typeof(MathMLElement) == "function";
      if (!canMathML) {
        var body = document.querySelector("body");
        body.firstElementChild.setAttribute('style', 'opacity: 0;');
        var loading = document.createElement("div");
        loading.setAttribute("id", "mathjax-loading-spinner");
        var message = document.createElement("div");
        message.setAttribute("id", "mathjax-loading-message");
        message.innerText = "Typesetting Equations...";
        body.prepend(loading);
        body.prepend(message);

        var el = document.createElement("script");
        el.src = "https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js";
        document.querySelector("head").appendChild(el);

        window.MathJax = {
          startup: {
            pageReady: () => {
              return MathJax.startup.defaultPageReady().then(() => {
                body.removeChild(loading);
                body.removeChild(message);
                body.firstElementChild.removeAttribute('style');
              }); } } };
      }
    </script>
    <script>
    // Auxiliary function, building the preview feature when
    // an inline citation is clicked
    function clicked_cite(e) {
      e.preventDefault();
      let cite = this.closest('.ltx_cite');
      let next = cite.nextSibling;
      if (next && next.nodeType == Node.ELEMENT_NODE && next.getAttribute('class') == "ar5iv-bibitem-preview") {
        next.remove();
        return; }
      // Before adding a preview modal,
      // cleanup older previews, in case they're still open
      document.querySelectorAll('span.ar5iv-bibitem-preview').forEach(function(node) {
        node.remove();
      })

      // Create the preview
      preview = document.createElement('span');
      preview.setAttribute('class','ar5iv-bibitem-preview');
      let target = document.getElementById(this.getAttribute('href').slice(1));
      target.childNodes.forEach(function (child) {
        preview.append(child.cloneNode(true));
      });
      let close_x = document.createElement('button');
      close_x.setAttribute("aria-label","Close modal for bibliography item preview");
      close_x.textContent = "×";
      close_x.setAttribute('class', 'ar5iv-button-close-preview');
      close_x.setAttribute('onclick','this.parentNode.remove()');
      preview.append(close_x);
      preview.querySelectorAll('.ltx_tag_bibitem').forEach(function(node) {
        node.remove();
      });
      cite.parentNode.insertBefore(preview, cite.nextSibling);
      return;
    }
    // Global Document initialization:
    // - assign the preview feature to all inline citation links
    document.querySelectorAll(".ltx_cite .ltx_ref").forEach(function (link) {
      link.addEventListener("click", clicked_cite);
    });
    </script>
    </body>
</html>
