<!DOCTYPE html><html lang="en">
<head>
<meta http-equiv="content-type" content="text/html; charset=UTF-8">
<title>[2311.07760] Ransomware Detection Using Federated Learning with Imbalanced Datasets</title><meta property="og:description" content="Ransomware is a type of malware which encrypts user data and extorts payments in return for the decryption keys. This cyberthreat is one of the most serious challenges facing organizations today and has already caused …">
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Ransomware Detection Using Federated Learning with Imbalanced Datasets">
<meta name="twitter:image:src" content="https://ar5iv.labs.arxiv.org/assets/ar5iv_card.png">
<meta name="twitter:image:alt" content="ar5iv logo">
<meta property="og:title" content="Ransomware Detection Using Federated Learning with Imbalanced Datasets">
<meta property="og:site_name" content="ar5iv">
<meta property="og:image" content="https://ar5iv.labs.arxiv.org/assets/ar5iv_card.png">
<meta property="og:type" content="article">
<meta property="og:url" content="https://ar5iv.labs.arxiv.org/html/2311.07760">

<!--Generated on Tue Feb 27 19:14:24 2024 by LaTeXML (version 0.8.8) http://dlmf.nist.gov/LaTeXML/.-->
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="keywords" lang="en" content="
Cybersecurity,  malware,  ransomware analysis,  federated learning,  data imbalance
">

<script>
  function detectColorScheme(){
    var theme="light";
    var current_theme = localStorage.getItem("ar5iv_theme");
    if(current_theme){
      if(current_theme == "dark"){
        theme = "dark";
      } }
    else if(!window.matchMedia) { return false; }
    else if(window.matchMedia("(prefers-color-scheme: dark)").matches) {
      theme = "dark"; }
    if (theme=="dark") {
      document.documentElement.setAttribute("data-theme", "dark");
    } else {
      document.documentElement.setAttribute("data-theme", "light"); } }

  detectColorScheme();

  function toggleColorScheme(){
    var current_theme = localStorage.getItem("ar5iv_theme");
    if (current_theme) {
      if (current_theme == "light") {
        localStorage.setItem("ar5iv_theme", "dark"); }
      else {
        localStorage.setItem("ar5iv_theme", "light"); } }
    else {
        localStorage.setItem("ar5iv_theme", "dark"); }
    detectColorScheme(); }
</script>
<link media="all" rel="stylesheet" href="/assets/ar5iv-fonts.0.8.0.min.css"><link media="all" rel="stylesheet" href="/assets/ar5iv.0.8.0.min.css"><link media="all" rel="stylesheet" href="/assets/ar5iv-site.0.2.2.css">
</head>
<body>
<div class="ltx_page_main">
<div class="ltx_page_content">
<article class="ltx_document ltx_authors_1line">
<h1 class="ltx_title ltx_title_document">Ransomware Detection Using Federated Learning with Imbalanced Datasets</h1>
<div class="ltx_authors">
<span class="ltx_creator ltx_role_author">
<span class="ltx_personname">A. Vehabovic<sup id="id14.14.id1" class="ltx_sup"><span id="id14.14.id1.1" class="ltx_text ltx_font_italic">1</span></sup>, H. Zanddizari<sup id="id15.15.id2" class="ltx_sup"><span id="id15.15.id2.1" class="ltx_text ltx_font_italic">1</span></sup>, N. Ghani<sup id="id16.16.id3" class="ltx_sup">1</sup>, G. Javidi<sup id="id17.17.id4" class="ltx_sup"><span id="id17.17.id4.1" class="ltx_text ltx_font_italic">1</span></sup>, S. Uluagac<sup id="id18.18.id5" class="ltx_sup"><span id="id18.18.id5.1" class="ltx_text ltx_font_italic">2</span></sup>, 
<br class="ltx_break">M. Rahouti<sup id="id19.19.id6" class="ltx_sup"><span id="id19.19.id6.1" class="ltx_text ltx_font_italic">3</span></sup>, E. Bou-Harb<sup id="id20.20.id7" class="ltx_sup"><span id="id20.20.id7.1" class="ltx_text ltx_font_italic">4</span></sup>, M. Safaei Pour<sup id="id21.21.id8" class="ltx_sup"><span id="id21.21.id8.1" class="ltx_text ltx_font_italic">5</span></sup>
<br class="ltx_break"><sup id="id22.22.id9" class="ltx_sup"><span id="id22.22.id9.1" class="ltx_text ltx_font_italic">1</span></sup><span id="id13.13.4" class="ltx_text ltx_font_italic">University of South Florida, <sup id="id13.13.4.1" class="ltx_sup">2</sup>Florida International University, <sup id="id13.13.4.2" class="ltx_sup">3</sup>Fordham University, <sup id="id13.13.4.3" class="ltx_sup">4</sup>Louisiana State University, <sup id="id13.13.4.4" class="ltx_sup">5</sup>San Diego State University</span>
</span></span>
</div>

<div class="ltx_abstract">
<h6 class="ltx_title ltx_title_abstract">Abstract</h6>
<p id="id23.id1" class="ltx_p">Ransomware is a type of malware which encrypts user data and extorts payments in return for the decryption keys. This cyberthreat is one of the most serious challenges facing organizations today and has already caused immense financial damage. As a result, many researchers have been developing techniques to counter ransomware. Recently, the <span id="id23.id1.1" class="ltx_text ltx_font_italic">federated learning</span> (FL) approach has also been applied for ransomware analysis, allowing corporations to achieve scalable, effective detection and attribution without having to share their private data. However, in reality there is much variation in the quantity and composition of ransomware data collected across multiple FL client sites/regions. This imbalance will inevitably degrade the effectiveness of any defense mechanisms. To address this concern, a modified FL scheme is proposed using a weighted cross-entropy loss function approach to mitigate dataset imbalance. A detailed performance evaluation study is then presented for the case of static analysis using the latest Windows-based ransomware families. The findings confirm improved ML classifier performance for a highly imbalanced dataset.</p>
</div>
<div class="ltx_keywords">
<h6 class="ltx_title ltx_title_keywords">Index Terms: </h6>
Cybersecurity, malware, ransomware analysis, federated learning, data imbalance

</div>
<section id="S1" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">I </span><span id="S1.1.1" class="ltx_text ltx_font_smallcaps">Introduction</span>
</h2>

<div id="S1.p1" class="ltx_para">
<p id="S1.p1.1" class="ltx_p">The ransomware threat has been steadily expanding in recent years, with more sophisticated families and variants emerging on a regular basis, see surveys in <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib1" title="" class="ltx_ref">1</a>]</cite>, <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib2" title="" class="ltx_ref">2</a>]</cite>, <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib3" title="" class="ltx_ref">3</a>]</cite>. This malware uses a range of tactics to infect end-user machines and then proceeds to encrypt important data/files. Criminal affiliates and cyber gangs have even commercialized this malware through a range of <span id="S1.p1.1.1" class="ltx_text ltx_font_italic">ransomware-as-a-service</span> (RaaS) offerings, further expanding the threat surface. As a result, there have been many high-profile ransomware incidents that have caused much financial and reputational damage <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib3" title="" class="ltx_ref">3</a>]</cite>,<cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib4" title="" class="ltx_ref">4</a>]</cite>.</p>
</div>
<div id="S1.p2" class="ltx_para">
<p id="S1.p2.1" class="ltx_p">To address this critical challenge, researchers have developed many different ransomware analysis schemes, and these efforts can be classified using a range of taxonomies, e.g., such as static and dynamic methods, network-based or host-based methods, etc <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib2" title="" class="ltx_ref">2</a>]</cite>, <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib3" title="" class="ltx_ref">3</a>]</cite>. By and large, most of these solutions use some type of <span id="S1.p2.1.1" class="ltx_text ltx_font_italic">machine learning</span> (ML) approach, i.e., by extracting and pre-processing raw data and using it to train appropriate classifiers for detection and attribution.</p>
</div>
<div id="S1.p3" class="ltx_para">
<p id="S1.p3.1" class="ltx_p">Nevertheless, collecting and pre-processing large amounts of ransomware data and training ML algorithms is a challenging task, i.e., in terms of privacy and scalability. Many organizations are unwilling to share their private internal host and/or network data. At the same time, it is becoming unfeasible to perform large-scale data collection and ML training at a single site. Hence the distributed <span id="S1.p3.1.1" class="ltx_text ltx_font_italic">federated learning</span> (FL) approach offers much potential here <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib5" title="" class="ltx_ref">5</a>]</cite>. Along these lines, a recent study in <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib6" title="" class="ltx_ref">6</a>]</cite> has applied this method to ransomware analysis, with the findings showing very promising results for the latest Windows-based ransomware families. However, this initial study assumes “balanced” datasets with an even distribution of malware samples across all client sites. Clearly, real-world settings will not mirror these idealized scenarios. Instead, differing regions and client bases will likely see (and collect) very different types and amounts of ransomware data. This dataset imbalance will inevitably bias the FL training process and lead to degraded ML classifier performance.</p>
</div>
<div id="S1.p4" class="ltx_para">
<p id="S1.p4.1" class="ltx_p">In light of the above, this paper extends the work in <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib6" title="" class="ltx_ref">6</a>]</cite> to address the critical dataset imbalance problem in FL-based ransomware analysis. Namely, the proposed solution uses a weighted cross-entropy loss function approach to account for uneven data distribution across client sites. Overall, this paper is organized as follows. First, Section <a href="#S2" title="II Literature Review ‣ Ransomware Detection Using Federated Learning with Imbalanced Datasets" class="ltx_ref"><span class="ltx_text ltx_ref_tag">II</span></a> briefly reviews existing work in ransomware analysis. Next, Section <a href="#S3" title="III Federated Learning with Imbalanced Ransomware Datasets ‣ Ransomware Detection Using Federated Learning with Imbalanced Datasets" class="ltx_ref"><span class="ltx_text ltx_ref_tag">III</span></a> presents the proposed scheme for imbalanced datasets. The ransomware repository is then detailed in Section <a href="#S4" title="IV Performance Evaluation ‣ Ransomware Detection Using Federated Learning with Imbalanced Datasets" class="ltx_ref"><span class="ltx_text ltx_ref_tag">IV</span></a>, followed by performance results for binary detection and multi-class attribution using static analysis. Conclusions and future work directions are then presented in Section <a href="#S5" title="V Conclusions ‣ Ransomware Detection Using Federated Learning with Imbalanced Datasets" class="ltx_ref"><span class="ltx_text ltx_ref_tag">V</span></a>.</p>
</div>
</section>
<section id="S2" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">II </span><span id="S2.1.1" class="ltx_text ltx_font_smallcaps">Literature Review</span>
</h2>

<div id="S2.p1" class="ltx_para">
<p id="S2.p1.1" class="ltx_p">A diverse sets of schemes have been proposed to tackle the ransomware threat <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib1" title="" class="ltx_ref">1</a>]</cite>-<cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib3" title="" class="ltx_ref">3</a>]</cite>. Some of these methods are more geared towards early (distribution) stages in the ransomware kill-chain, whereas other methods are more latent and focused on post-infection response and even forensic analysis. A brief overview is presented here.</p>
</div>
<div id="S2.p2" class="ltx_para">
<p id="S2.p2.1" class="ltx_p">Static ransomware analysis schemes analyze binary executable files to detect malicious payloads, e.g., via author attribution, code/segment identification, etc <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib2" title="" class="ltx_ref">2</a>]</cite>. Researchers have also proposed ML-based techniques for <span id="S2.p2.1.1" class="ltx_text ltx_font_italic">binary code analysis</span> (BCA), source code analysis (reverse engineering), and domain prediction <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib7" title="" class="ltx_ref">7</a>]</cite>, <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib8" title="" class="ltx_ref">8</a>]</cite>. In addition, some more specialized solutions also generate image-based training data to test binary classifiers <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib3" title="" class="ltx_ref">3</a>]</cite>. Many of these methods show good detection accuracies in the mid-90% range. Researchers have also leveraged Windows <span id="S2.p2.1.2" class="ltx_text ltx_font_italic">portable executable</span> (PE) format files for feature extraction <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib9" title="" class="ltx_ref">9</a>]</cite>,<cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib10" title="" class="ltx_ref">10</a>]</cite>. For example, the recent work in <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib10" title="" class="ltx_ref">10</a>]</cite> investigates static PE file analysis using an up-to-date ransomware repository, and results show very good detection and attribution (90-95% range).</p>
</div>
<div id="S2.p3" class="ltx_para">
<p id="S2.p3.1" class="ltx_p">Meanwhile, dynamic network-based ransomware analysis schemes examine traffic information such as packet traces, <span id="S2.p3.1.1" class="ltx_text ltx_font_italic">domain name service</span> (DNS) queries, and network storage access, etc. These techniques are also very effective at detecting ransomware activity, with detection rates typically varying around 95% <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib11" title="" class="ltx_ref">11</a>]</cite>, <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib12" title="" class="ltx_ref">12</a>]</cite>. Similarly, dynamic host-based ransomware schemes have also been studied. These solutions monitor local machine activity to detect ransomware, e.g., memory and file operations, <span id="S2.p3.1.2" class="ltx_text ltx_font_italic">application programmer interface</span> (API) function calls, <span id="S2.p3.1.3" class="ltx_text ltx_font_italic">dynamic link library</span> (DLL) calls, etc. Some of these methods also try to recover locally-stored encryption keys, see <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib13" title="" class="ltx_ref">13</a>]</cite>.</p>
</div>
<div id="S2.p4" class="ltx_para">
<p id="S2.p4.1" class="ltx_p">Despite these contributions, major concerns still remain. Foremost, many existing studies use mixed training datasets containing older (inactive) ransomware families designed for earlier Windows 7/8 systems (mid-2010s). Hence it is imperative to build updated threat repositories using newer ransomware families, specifically those targeting Windows 10/11 systems. The work in <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib10" title="" class="ltx_ref">10</a>]</cite> presents one such recent effort. From an operational perspective, it is also very difficult to centralize all data collection and ML training functionality to a single site. Namely, privacy concerns will prevent many organizations from sharing their sensitive data externally. Scalability challenges will also arise if raw ransomware datasets become excessively large.</p>
</div>
<div id="S2.p5" class="ltx_para">
<p id="S2.p5.1" class="ltx_p">To address these concerns, recent work in <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib6" title="" class="ltx_ref">6</a>]</cite> presents a distributed ransomware analysis solution based upon the <span id="S2.p5.1.1" class="ltx_text ltx_font_italic">federated learning</span> (FL) approach. This effort extends the work in <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib10" title="" class="ltx_ref">10</a>]</cite> and evenly partitions the (Windows PE file) training datasets across multiple sites. Localized datasets are then used to train and average multiple NN-based classifiers using the <span id="S2.p5.1.2" class="ltx_text ltx_font_typewriter">FedAvg</span> algorithm <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib5" title="" class="ltx_ref">5</a>]</cite>. Findings confirm that the FL approach slightly exceeds centralized ML schemes in terms of detection and attribution accuracy. However, this initial study assumes even data distribution, with local sites having the same number of samples of each family. Clearly, ideal balanced scenarios will rarely exist in practice. Instead, the number of samples and their relative proportions will vary widely across regions. For example, many ransomware attacks target specific users or applications <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib3" title="" class="ltx_ref">3</a>]</cite>. Hence local repositories will exhibit a high degree of <span id="S2.p5.1.3" class="ltx_text ltx_font_italic">imbalance</span> and even non-iid characteristics <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib14" title="" class="ltx_ref">14</a>]</cite>. These conditions may even induce majority and minority classes in the training data. Expectedly, the latter will have lower classification accuracy, and this will be particularly problematic for new ransomware releases with fewer samples (such as zero-day attacks). Hence there is a clear need to develop FL ransomware analysis schemes to handle such dataset imbalance.</p>
</div>
<figure id="S2.F1" class="ltx_figure"><img src="/html/2311.07760/assets/FIG/FL_centralized.png" id="S2.F1.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="573" height="255" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 1: </span>Centralized federated learning approach for ransomware analysis, from <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib6" title="" class="ltx_ref">6</a>]</cite></figcaption>
</figure>
<figure id="S2.F2" class="ltx_figure">
<div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_1">
<p id="S2.F2.1" class="ltx_p ltx_figure_panel"><svg version="1.1" width="0" height="0" overflow="visible"><g transform="translate(0,0) scale(1,-1)"><path d="M 0,0 311.33,0" stroke="#000000" stroke-width="0.4"></path></g></svg></p>
</div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_1">
<div id="S2.F2.5" class="ltx_listing ltx_figure_panel ltx_listing">
<div id="algx1.l1" class="ltx_listingline">
<span id="algx1.l1.1" class="ltx_text" style="font-size:90%;">  </span><span id="algx1.l1.2" class="ltx_text ltx_font_bold" style="font-size:90%;">Input:</span><span id="algx1.l1.3" class="ltx_text" style="font-size:90%;"> Global ML parameters from central server, </span><math id="algx1.l1.m1.1" class="ltx_Math" alttext="\omega" display="inline"><semantics id="algx1.l1.m1.1a"><mi mathsize="90%" id="algx1.l1.m1.1.1" xref="algx1.l1.m1.1.1.cmml">ω</mi><annotation-xml encoding="MathML-Content" id="algx1.l1.m1.1b"><ci id="algx1.l1.m1.1.1.cmml" xref="algx1.l1.m1.1.1">𝜔</ci></annotation-xml><annotation encoding="application/x-tex" id="algx1.l1.m1.1c">\omega</annotation></semantics></math><span id="algx1.l1.4" class="ltx_text" style="font-size:90%;">

</span>
</div>
<div id="algx1.l2" class="ltx_listingline">
<span id="algx1.l2.1" class="ltx_text" style="font-size:90%;">  </span><span id="algx1.l2.2" class="ltx_text ltx_font_italic" style="font-size:90%;">/* Compute inverse class frequency weights */</span><span id="algx1.l2.3" class="ltx_text" style="font-size:90%;">
</span>
</div>
<div id="algx1.l3" class="ltx_listingline">
<span id="algx1.l3.1" class="ltx_text" style="font-size:90%;">  Compute weighting vector </span><math id="algx1.l3.m1.4" class="ltx_Math" alttext="\{\alpha_{1},\alpha_{2},\cdots,\alpha_{Q}\}\rightarrow\Pi_{K}" display="inline"><semantics id="algx1.l3.m1.4a"><mrow id="algx1.l3.m1.4.4" xref="algx1.l3.m1.4.4.cmml"><mrow id="algx1.l3.m1.4.4.3.3" xref="algx1.l3.m1.4.4.3.4.cmml"><mo maxsize="90%" minsize="90%" id="algx1.l3.m1.4.4.3.3.4" xref="algx1.l3.m1.4.4.3.4.cmml">{</mo><msub id="algx1.l3.m1.2.2.1.1.1" xref="algx1.l3.m1.2.2.1.1.1.cmml"><mi mathsize="90%" id="algx1.l3.m1.2.2.1.1.1.2" xref="algx1.l3.m1.2.2.1.1.1.2.cmml">α</mi><mn mathsize="90%" id="algx1.l3.m1.2.2.1.1.1.3" xref="algx1.l3.m1.2.2.1.1.1.3.cmml">1</mn></msub><mo mathsize="90%" id="algx1.l3.m1.4.4.3.3.5" xref="algx1.l3.m1.4.4.3.4.cmml">,</mo><msub id="algx1.l3.m1.3.3.2.2.2" xref="algx1.l3.m1.3.3.2.2.2.cmml"><mi mathsize="90%" id="algx1.l3.m1.3.3.2.2.2.2" xref="algx1.l3.m1.3.3.2.2.2.2.cmml">α</mi><mn mathsize="90%" id="algx1.l3.m1.3.3.2.2.2.3" xref="algx1.l3.m1.3.3.2.2.2.3.cmml">2</mn></msub><mo mathsize="90%" id="algx1.l3.m1.4.4.3.3.6" xref="algx1.l3.m1.4.4.3.4.cmml">,</mo><mi mathsize="90%" mathvariant="normal" id="algx1.l3.m1.1.1" xref="algx1.l3.m1.1.1.cmml">⋯</mi><mo mathsize="90%" id="algx1.l3.m1.4.4.3.3.7" xref="algx1.l3.m1.4.4.3.4.cmml">,</mo><msub id="algx1.l3.m1.4.4.3.3.3" xref="algx1.l3.m1.4.4.3.3.3.cmml"><mi mathsize="90%" id="algx1.l3.m1.4.4.3.3.3.2" xref="algx1.l3.m1.4.4.3.3.3.2.cmml">α</mi><mi mathsize="90%" id="algx1.l3.m1.4.4.3.3.3.3" xref="algx1.l3.m1.4.4.3.3.3.3.cmml">Q</mi></msub><mo maxsize="90%" minsize="90%" id="algx1.l3.m1.4.4.3.3.8" xref="algx1.l3.m1.4.4.3.4.cmml">}</mo></mrow><mo mathsize="90%" stretchy="false" id="algx1.l3.m1.4.4.4" xref="algx1.l3.m1.4.4.4.cmml">→</mo><msub id="algx1.l3.m1.4.4.5" xref="algx1.l3.m1.4.4.5.cmml"><mi mathsize="90%" mathvariant="normal" id="algx1.l3.m1.4.4.5.2" xref="algx1.l3.m1.4.4.5.2.cmml">Π</mi><mi mathsize="90%" id="algx1.l3.m1.4.4.5.3" xref="algx1.l3.m1.4.4.5.3.cmml">K</mi></msub></mrow><annotation-xml encoding="MathML-Content" id="algx1.l3.m1.4b"><apply id="algx1.l3.m1.4.4.cmml" xref="algx1.l3.m1.4.4"><ci id="algx1.l3.m1.4.4.4.cmml" xref="algx1.l3.m1.4.4.4">→</ci><set id="algx1.l3.m1.4.4.3.4.cmml" xref="algx1.l3.m1.4.4.3.3"><apply id="algx1.l3.m1.2.2.1.1.1.cmml" xref="algx1.l3.m1.2.2.1.1.1"><csymbol cd="ambiguous" id="algx1.l3.m1.2.2.1.1.1.1.cmml" xref="algx1.l3.m1.2.2.1.1.1">subscript</csymbol><ci id="algx1.l3.m1.2.2.1.1.1.2.cmml" xref="algx1.l3.m1.2.2.1.1.1.2">𝛼</ci><cn type="integer" id="algx1.l3.m1.2.2.1.1.1.3.cmml" xref="algx1.l3.m1.2.2.1.1.1.3">1</cn></apply><apply id="algx1.l3.m1.3.3.2.2.2.cmml" xref="algx1.l3.m1.3.3.2.2.2"><csymbol cd="ambiguous" id="algx1.l3.m1.3.3.2.2.2.1.cmml" xref="algx1.l3.m1.3.3.2.2.2">subscript</csymbol><ci id="algx1.l3.m1.3.3.2.2.2.2.cmml" xref="algx1.l3.m1.3.3.2.2.2.2">𝛼</ci><cn type="integer" id="algx1.l3.m1.3.3.2.2.2.3.cmml" xref="algx1.l3.m1.3.3.2.2.2.3">2</cn></apply><ci id="algx1.l3.m1.1.1.cmml" xref="algx1.l3.m1.1.1">⋯</ci><apply id="algx1.l3.m1.4.4.3.3.3.cmml" xref="algx1.l3.m1.4.4.3.3.3"><csymbol cd="ambiguous" id="algx1.l3.m1.4.4.3.3.3.1.cmml" xref="algx1.l3.m1.4.4.3.3.3">subscript</csymbol><ci id="algx1.l3.m1.4.4.3.3.3.2.cmml" xref="algx1.l3.m1.4.4.3.3.3.2">𝛼</ci><ci id="algx1.l3.m1.4.4.3.3.3.3.cmml" xref="algx1.l3.m1.4.4.3.3.3.3">𝑄</ci></apply></set><apply id="algx1.l3.m1.4.4.5.cmml" xref="algx1.l3.m1.4.4.5"><csymbol cd="ambiguous" id="algx1.l3.m1.4.4.5.1.cmml" xref="algx1.l3.m1.4.4.5">subscript</csymbol><ci id="algx1.l3.m1.4.4.5.2.cmml" xref="algx1.l3.m1.4.4.5.2">Π</ci><ci id="algx1.l3.m1.4.4.5.3.cmml" xref="algx1.l3.m1.4.4.5.3">𝐾</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="algx1.l3.m1.4c">\{\alpha_{1},\alpha_{2},\cdots,\alpha_{Q}\}\rightarrow\Pi_{K}</annotation></semantics></math><span id="algx1.l3.2" class="ltx_text" style="font-size:90%;">

</span>
</div>
<div id="algx1.l4" class="ltx_listingline">
<span id="algx1.l4.1" class="ltx_text" style="font-size:90%;">  Partition local ML dataset (</span><math id="algx1.l4.m1.1" class="ltx_Math" alttext="n_{i}" display="inline"><semantics id="algx1.l4.m1.1a"><msub id="algx1.l4.m1.1.1" xref="algx1.l4.m1.1.1.cmml"><mi mathsize="90%" id="algx1.l4.m1.1.1.2" xref="algx1.l4.m1.1.1.2.cmml">n</mi><mi mathsize="90%" id="algx1.l4.m1.1.1.3" xref="algx1.l4.m1.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="algx1.l4.m1.1b"><apply id="algx1.l4.m1.1.1.cmml" xref="algx1.l4.m1.1.1"><csymbol cd="ambiguous" id="algx1.l4.m1.1.1.1.cmml" xref="algx1.l4.m1.1.1">subscript</csymbol><ci id="algx1.l4.m1.1.1.2.cmml" xref="algx1.l4.m1.1.1.2">𝑛</ci><ci id="algx1.l4.m1.1.1.3.cmml" xref="algx1.l4.m1.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="algx1.l4.m1.1c">n_{i}</annotation></semantics></math><span id="algx1.l4.2" class="ltx_text" style="font-size:90%;"> samples) into </span><math id="algx1.l4.m2.1" class="ltx_Math" alttext="B" display="inline"><semantics id="algx1.l4.m2.1a"><mi mathsize="90%" id="algx1.l4.m2.1.1" xref="algx1.l4.m2.1.1.cmml">B</mi><annotation-xml encoding="MathML-Content" id="algx1.l4.m2.1b"><ci id="algx1.l4.m2.1.1.cmml" xref="algx1.l4.m2.1.1">𝐵</ci></annotation-xml><annotation encoding="application/x-tex" id="algx1.l4.m2.1c">B</annotation></semantics></math><span id="algx1.l4.3" class="ltx_text" style="font-size:90%;"> batches

</span>
</div>
<div id="algx1.l5" class="ltx_listingline">
<span id="algx1.l5.1" class="ltx_text" style="font-size:90%;">  </span><span id="algx1.l5.2" class="ltx_text ltx_font_italic" style="font-size:90%;">/* Train local ML model over given epochs and batches */</span><span id="algx1.l5.3" class="ltx_text" style="font-size:90%;">
</span>
</div>
<div id="algx1.l6" class="ltx_listingline">
<span id="algx1.l6.1" class="ltx_text" style="font-size:90%;">  </span><span id="algx1.l6.2" class="ltx_text ltx_font_bold" style="font-size:90%;">for</span><span id="algx1.l6.3" class="ltx_text" style="font-size:90%;"> j=1 to </span><math id="algx1.l6.m1.1" class="ltx_Math" alttext="E" display="inline"><semantics id="algx1.l6.m1.1a"><mi mathsize="90%" id="algx1.l6.m1.1.1" xref="algx1.l6.m1.1.1.cmml">E</mi><annotation-xml encoding="MathML-Content" id="algx1.l6.m1.1b"><ci id="algx1.l6.m1.1.1.cmml" xref="algx1.l6.m1.1.1">𝐸</ci></annotation-xml><annotation encoding="application/x-tex" id="algx1.l6.m1.1c">E</annotation></semantics></math><span id="algx1.l6.4" class="ltx_text" style="font-size:90%;"> </span><span id="algx1.l6.5" class="ltx_text ltx_font_bold" style="font-size:90%;">do</span><span id="algx1.l6.6" class="ltx_text" style="font-size:90%;">


</span>
</div>
<div id="algx1.l7" class="ltx_listingline">
<span id="algx1.l7.1" class="ltx_text" style="font-size:90%;">     </span><span id="algx1.l7.2" class="ltx_text ltx_font_bold" style="font-size:90%;">for</span><span id="algx1.l7.3" class="ltx_text" style="font-size:90%;"> k=1 to </span><math id="algx1.l7.m1.1" class="ltx_Math" alttext="B" display="inline"><semantics id="algx1.l7.m1.1a"><mi mathsize="90%" id="algx1.l7.m1.1.1" xref="algx1.l7.m1.1.1.cmml">B</mi><annotation-xml encoding="MathML-Content" id="algx1.l7.m1.1b"><ci id="algx1.l7.m1.1.1.cmml" xref="algx1.l7.m1.1.1">𝐵</ci></annotation-xml><annotation encoding="application/x-tex" id="algx1.l7.m1.1c">B</annotation></semantics></math><span id="algx1.l7.4" class="ltx_text" style="font-size:90%;"> </span><span id="algx1.l7.5" class="ltx_text ltx_font_bold" style="font-size:90%;">do</span><span id="algx1.l7.6" class="ltx_text" style="font-size:90%;">


</span>
</div>
<div id="algx1.l8" class="ltx_listingline">
<span id="algx1.l8.1" class="ltx_text" style="font-size:90%;">        Train local model over </span><math id="algx1.l8.m1.1" class="ltx_Math" alttext="k" display="inline"><semantics id="algx1.l8.m1.1a"><mi mathsize="90%" id="algx1.l8.m1.1.1" xref="algx1.l8.m1.1.1.cmml">k</mi><annotation-xml encoding="MathML-Content" id="algx1.l8.m1.1b"><ci id="algx1.l8.m1.1.1.cmml" xref="algx1.l8.m1.1.1">𝑘</ci></annotation-xml><annotation encoding="application/x-tex" id="algx1.l8.m1.1c">k</annotation></semantics></math><span id="algx1.l8.2" class="ltx_text" style="font-size:90%;">-th batch of data
</span>
</div>
<div id="algx1.l9" class="ltx_listingline">
<span id="algx1.l9.1" class="ltx_text" style="font-size:90%;">        Update loss function w.r.t. class frequencies, </span><math id="algx1.l9.m1.1" class="ltx_Math" alttext="\Pi_{Q}" display="inline"><semantics id="algx1.l9.m1.1a"><msub id="algx1.l9.m1.1.1" xref="algx1.l9.m1.1.1.cmml"><mi mathsize="90%" mathvariant="normal" id="algx1.l9.m1.1.1.2" xref="algx1.l9.m1.1.1.2.cmml">Π</mi><mi mathsize="90%" id="algx1.l9.m1.1.1.3" xref="algx1.l9.m1.1.1.3.cmml">Q</mi></msub><annotation-xml encoding="MathML-Content" id="algx1.l9.m1.1b"><apply id="algx1.l9.m1.1.1.cmml" xref="algx1.l9.m1.1.1"><csymbol cd="ambiguous" id="algx1.l9.m1.1.1.1.cmml" xref="algx1.l9.m1.1.1">subscript</csymbol><ci id="algx1.l9.m1.1.1.2.cmml" xref="algx1.l9.m1.1.1.2">Π</ci><ci id="algx1.l9.m1.1.1.3.cmml" xref="algx1.l9.m1.1.1.3">𝑄</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="algx1.l9.m1.1c">\Pi_{Q}</annotation></semantics></math><span id="algx1.l9.2" class="ltx_text" style="font-size:90%;">
</span>
</div>
<div id="algx1.l10" class="ltx_listingline">
<span id="algx1.l10.1" class="ltx_text" style="font-size:90%;">        Update local ML model parameters </span><math id="algx1.l10.m1.1" class="ltx_Math" alttext="\omega\rightarrow\omega_{i}^{t}" display="inline"><semantics id="algx1.l10.m1.1a"><mrow id="algx1.l10.m1.1.1" xref="algx1.l10.m1.1.1.cmml"><mi mathsize="90%" id="algx1.l10.m1.1.1.2" xref="algx1.l10.m1.1.1.2.cmml">ω</mi><mo mathsize="90%" stretchy="false" id="algx1.l10.m1.1.1.1" xref="algx1.l10.m1.1.1.1.cmml">→</mo><msubsup id="algx1.l10.m1.1.1.3" xref="algx1.l10.m1.1.1.3.cmml"><mi mathsize="90%" id="algx1.l10.m1.1.1.3.2.2" xref="algx1.l10.m1.1.1.3.2.2.cmml">ω</mi><mi mathsize="90%" id="algx1.l10.m1.1.1.3.2.3" xref="algx1.l10.m1.1.1.3.2.3.cmml">i</mi><mi mathsize="90%" id="algx1.l10.m1.1.1.3.3" xref="algx1.l10.m1.1.1.3.3.cmml">t</mi></msubsup></mrow><annotation-xml encoding="MathML-Content" id="algx1.l10.m1.1b"><apply id="algx1.l10.m1.1.1.cmml" xref="algx1.l10.m1.1.1"><ci id="algx1.l10.m1.1.1.1.cmml" xref="algx1.l10.m1.1.1.1">→</ci><ci id="algx1.l10.m1.1.1.2.cmml" xref="algx1.l10.m1.1.1.2">𝜔</ci><apply id="algx1.l10.m1.1.1.3.cmml" xref="algx1.l10.m1.1.1.3"><csymbol cd="ambiguous" id="algx1.l10.m1.1.1.3.1.cmml" xref="algx1.l10.m1.1.1.3">superscript</csymbol><apply id="algx1.l10.m1.1.1.3.2.cmml" xref="algx1.l10.m1.1.1.3"><csymbol cd="ambiguous" id="algx1.l10.m1.1.1.3.2.1.cmml" xref="algx1.l10.m1.1.1.3">subscript</csymbol><ci id="algx1.l10.m1.1.1.3.2.2.cmml" xref="algx1.l10.m1.1.1.3.2.2">𝜔</ci><ci id="algx1.l10.m1.1.1.3.2.3.cmml" xref="algx1.l10.m1.1.1.3.2.3">𝑖</ci></apply><ci id="algx1.l10.m1.1.1.3.3.cmml" xref="algx1.l10.m1.1.1.3.3">𝑡</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="algx1.l10.m1.1c">\omega\rightarrow\omega_{i}^{t}</annotation></semantics></math><span id="algx1.l10.2" class="ltx_text" style="font-size:90%;">

</span>
</div>
<div id="algx1.l11" class="ltx_listingline">
<span id="algx1.l11.1" class="ltx_text" style="font-size:90%;">  </span><span id="algx1.l11.2" class="ltx_text ltx_font_bold" style="font-size:90%;">Output:</span><span id="algx1.l11.3" class="ltx_text" style="font-size:90%;"> Send updated ML parameters, </span><math id="algx1.l11.m1.1" class="ltx_Math" alttext="\omega_{i}^{t}" display="inline"><semantics id="algx1.l11.m1.1a"><msubsup id="algx1.l11.m1.1.1" xref="algx1.l11.m1.1.1.cmml"><mi mathsize="90%" id="algx1.l11.m1.1.1.2.2" xref="algx1.l11.m1.1.1.2.2.cmml">ω</mi><mi mathsize="90%" id="algx1.l11.m1.1.1.2.3" xref="algx1.l11.m1.1.1.2.3.cmml">i</mi><mi mathsize="90%" id="algx1.l11.m1.1.1.3" xref="algx1.l11.m1.1.1.3.cmml">t</mi></msubsup><annotation-xml encoding="MathML-Content" id="algx1.l11.m1.1b"><apply id="algx1.l11.m1.1.1.cmml" xref="algx1.l11.m1.1.1"><csymbol cd="ambiguous" id="algx1.l11.m1.1.1.1.cmml" xref="algx1.l11.m1.1.1">superscript</csymbol><apply id="algx1.l11.m1.1.1.2.cmml" xref="algx1.l11.m1.1.1"><csymbol cd="ambiguous" id="algx1.l11.m1.1.1.2.1.cmml" xref="algx1.l11.m1.1.1">subscript</csymbol><ci id="algx1.l11.m1.1.1.2.2.cmml" xref="algx1.l11.m1.1.1.2.2">𝜔</ci><ci id="algx1.l11.m1.1.1.2.3.cmml" xref="algx1.l11.m1.1.1.2.3">𝑖</ci></apply><ci id="algx1.l11.m1.1.1.3.cmml" xref="algx1.l11.m1.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="algx1.l11.m1.1c">\omega_{i}^{t}</annotation></semantics></math><span id="algx1.l11.4" class="ltx_text" style="font-size:90%;">, to central server
</span>
</div>
</div>
</div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_1">
<p id="S2.F2.2" class="ltx_p ltx_figure_panel"><svg version="1.1" width="0" height="0" overflow="visible"><g transform="translate(0,0) scale(1,-1)"><path d="M 0,0 311.33,0" stroke="#000000" stroke-width="0.4"></path></g></svg></p>
</div>
</div>
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure">Figure 2: </span>Client site <math id="S2.F2.4.m1.1" class="ltx_Math" alttext="i" display="inline"><semantics id="S2.F2.4.m1.1b"><mi id="S2.F2.4.m1.1.1" xref="S2.F2.4.m1.1.1.cmml">i</mi><annotation-xml encoding="MathML-Content" id="S2.F2.4.m1.1c"><ci id="S2.F2.4.m1.1.1.cmml" xref="S2.F2.4.m1.1.1">𝑖</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.F2.4.m1.1d">i</annotation></semantics></math> algorithm </figcaption>
</figure>
<figure id="S2.F3" class="ltx_figure">
<div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_1">
<p id="S2.F3.1" class="ltx_p ltx_figure_panel"><svg version="1.1" width="0" height="0" overflow="visible"><g transform="translate(0,0) scale(1,-1)"><path d="M 0,0 311.33,0" stroke="#000000" stroke-width="0.4"></path></g></svg></p>
</div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_1">
<div id="S2.F3.3" class="ltx_listing ltx_figure_panel ltx_listing">
<div id="algx2.l1" class="ltx_listingline">
<span id="algx2.l1.1" class="ltx_text" style="font-size:90%;">  </span><span id="algx2.l1.2" class="ltx_text ltx_font_bold" style="font-size:90%;">Input:</span><span id="algx2.l1.3" class="ltx_text" style="font-size:90%;"> Initial global ML parameters, </span><math id="algx2.l1.m1.1" class="ltx_Math" alttext="\omega_{0}" display="inline"><semantics id="algx2.l1.m1.1a"><msub id="algx2.l1.m1.1.1" xref="algx2.l1.m1.1.1.cmml"><mi mathsize="90%" id="algx2.l1.m1.1.1.2" xref="algx2.l1.m1.1.1.2.cmml">ω</mi><mn mathsize="90%" id="algx2.l1.m1.1.1.3" xref="algx2.l1.m1.1.1.3.cmml">0</mn></msub><annotation-xml encoding="MathML-Content" id="algx2.l1.m1.1b"><apply id="algx2.l1.m1.1.1.cmml" xref="algx2.l1.m1.1.1"><csymbol cd="ambiguous" id="algx2.l1.m1.1.1.1.cmml" xref="algx2.l1.m1.1.1">subscript</csymbol><ci id="algx2.l1.m1.1.1.2.cmml" xref="algx2.l1.m1.1.1.2">𝜔</ci><cn type="integer" id="algx2.l1.m1.1.1.3.cmml" xref="algx2.l1.m1.1.1.3">0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="algx2.l1.m1.1c">\omega_{0}</annotation></semantics></math><span id="algx2.l1.4" class="ltx_text" style="font-size:90%;">

</span>
</div>
<div id="algx2.l2" class="ltx_listingline">
<span id="algx2.l2.2" class="ltx_text" style="font-size:90%;">  </span><span id="algx2.l2.1" class="ltx_text ltx_font_italic" style="font-size:90%;">/* Iterative FL training process over <math id="algx2.l2.1.m1.1" class="ltx_Math" alttext="T" display="inline"><semantics id="algx2.l2.1.m1.1a"><mi id="algx2.l2.1.m1.1.1" xref="algx2.l2.1.m1.1.1.cmml">T</mi><annotation-xml encoding="MathML-Content" id="algx2.l2.1.m1.1b"><ci id="algx2.l2.1.m1.1.1.cmml" xref="algx2.l2.1.m1.1.1">𝑇</ci></annotation-xml><annotation encoding="application/x-tex" id="algx2.l2.1.m1.1c">T</annotation></semantics></math> rounds */</span><span id="algx2.l2.3" class="ltx_text" style="font-size:90%;">
</span>
</div>
<div id="algx2.l3" class="ltx_listingline">
<span id="algx2.l3.1" class="ltx_text" style="font-size:90%;">  </span><span id="algx2.l3.2" class="ltx_text ltx_font_bold" style="font-size:90%;">for</span><span id="algx2.l3.3" class="ltx_text" style="font-size:90%;"> </span><math id="algx2.l3.m1.1" class="ltx_Math" alttext="t=1" display="inline"><semantics id="algx2.l3.m1.1a"><mrow id="algx2.l3.m1.1.1" xref="algx2.l3.m1.1.1.cmml"><mi mathsize="90%" id="algx2.l3.m1.1.1.2" xref="algx2.l3.m1.1.1.2.cmml">t</mi><mo mathsize="90%" id="algx2.l3.m1.1.1.1" xref="algx2.l3.m1.1.1.1.cmml">=</mo><mn mathsize="90%" id="algx2.l3.m1.1.1.3" xref="algx2.l3.m1.1.1.3.cmml">1</mn></mrow><annotation-xml encoding="MathML-Content" id="algx2.l3.m1.1b"><apply id="algx2.l3.m1.1.1.cmml" xref="algx2.l3.m1.1.1"><eq id="algx2.l3.m1.1.1.1.cmml" xref="algx2.l3.m1.1.1.1"></eq><ci id="algx2.l3.m1.1.1.2.cmml" xref="algx2.l3.m1.1.1.2">𝑡</ci><cn type="integer" id="algx2.l3.m1.1.1.3.cmml" xref="algx2.l3.m1.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="algx2.l3.m1.1c">t=1</annotation></semantics></math><span id="algx2.l3.4" class="ltx_text" style="font-size:90%;"> to </span><math id="algx2.l3.m2.1" class="ltx_Math" alttext="T" display="inline"><semantics id="algx2.l3.m2.1a"><mi mathsize="90%" id="algx2.l3.m2.1.1" xref="algx2.l3.m2.1.1.cmml">T</mi><annotation-xml encoding="MathML-Content" id="algx2.l3.m2.1b"><ci id="algx2.l3.m2.1.1.cmml" xref="algx2.l3.m2.1.1">𝑇</ci></annotation-xml><annotation encoding="application/x-tex" id="algx2.l3.m2.1c">T</annotation></semantics></math><span id="algx2.l3.5" class="ltx_text" style="font-size:90%;"> </span><span id="algx2.l3.6" class="ltx_text ltx_font_bold" style="font-size:90%;">do</span><span id="algx2.l3.7" class="ltx_text" style="font-size:90%;">



</span>
</div>
<div id="algx2.l4" class="ltx_listingline">
<span id="algx2.l4.1" class="ltx_text" style="font-size:90%;">     Select </span><math id="algx2.l4.m1.1" class="ltx_Math" alttext="K" display="inline"><semantics id="algx2.l4.m1.1a"><mi mathsize="90%" id="algx2.l4.m1.1.1" xref="algx2.l4.m1.1.1.cmml">K</mi><annotation-xml encoding="MathML-Content" id="algx2.l4.m1.1b"><ci id="algx2.l4.m1.1.1.cmml" xref="algx2.l4.m1.1.1">𝐾</ci></annotation-xml><annotation encoding="application/x-tex" id="algx2.l4.m1.1c">K</annotation></semantics></math><span id="algx2.l4.2" class="ltx_text" style="font-size:90%;"> client sites

</span>
</div>
<div id="algx2.l5" class="ltx_listingline">
<span id="algx2.l5.1" class="ltx_text" style="font-size:90%;">     </span><span id="algx2.l5.2" class="ltx_text ltx_font_bold" style="font-size:90%;">for</span><span id="algx2.l5.3" class="ltx_text" style="font-size:90%;"> </span><math id="algx2.l5.m1.1" class="ltx_Math" alttext="i=1" display="inline"><semantics id="algx2.l5.m1.1a"><mrow id="algx2.l5.m1.1.1" xref="algx2.l5.m1.1.1.cmml"><mi mathsize="90%" id="algx2.l5.m1.1.1.2" xref="algx2.l5.m1.1.1.2.cmml">i</mi><mo mathsize="90%" id="algx2.l5.m1.1.1.1" xref="algx2.l5.m1.1.1.1.cmml">=</mo><mn mathsize="90%" id="algx2.l5.m1.1.1.3" xref="algx2.l5.m1.1.1.3.cmml">1</mn></mrow><annotation-xml encoding="MathML-Content" id="algx2.l5.m1.1b"><apply id="algx2.l5.m1.1.1.cmml" xref="algx2.l5.m1.1.1"><eq id="algx2.l5.m1.1.1.1.cmml" xref="algx2.l5.m1.1.1.1"></eq><ci id="algx2.l5.m1.1.1.2.cmml" xref="algx2.l5.m1.1.1.2">𝑖</ci><cn type="integer" id="algx2.l5.m1.1.1.3.cmml" xref="algx2.l5.m1.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="algx2.l5.m1.1c">i=1</annotation></semantics></math><span id="algx2.l5.4" class="ltx_text" style="font-size:90%;"> to </span><math id="algx2.l5.m2.1" class="ltx_Math" alttext="K" display="inline"><semantics id="algx2.l5.m2.1a"><mi mathsize="90%" id="algx2.l5.m2.1.1" xref="algx2.l5.m2.1.1.cmml">K</mi><annotation-xml encoding="MathML-Content" id="algx2.l5.m2.1b"><ci id="algx2.l5.m2.1.1.cmml" xref="algx2.l5.m2.1.1">𝐾</ci></annotation-xml><annotation encoding="application/x-tex" id="algx2.l5.m2.1c">K</annotation></semantics></math><span id="algx2.l5.5" class="ltx_text" style="font-size:90%;"> </span><span id="algx2.l5.6" class="ltx_text ltx_font_bold" style="font-size:90%;">do</span><span id="algx2.l5.7" class="ltx_text" style="font-size:90%;">


</span>
</div>
<div id="algx2.l6" class="ltx_listingline">
<span id="algx2.l6.1" class="ltx_text" style="font-size:90%;">        Send latest global ML model </span><math id="algx2.l6.m1.1" class="ltx_Math" alttext="\omega" display="inline"><semantics id="algx2.l6.m1.1a"><mi mathsize="90%" id="algx2.l6.m1.1.1" xref="algx2.l6.m1.1.1.cmml">ω</mi><annotation-xml encoding="MathML-Content" id="algx2.l6.m1.1b"><ci id="algx2.l6.m1.1.1.cmml" xref="algx2.l6.m1.1.1">𝜔</ci></annotation-xml><annotation encoding="application/x-tex" id="algx2.l6.m1.1c">\omega</annotation></semantics></math><span id="algx2.l6.2" class="ltx_text" style="font-size:90%;"> to </span><math id="algx2.l6.m2.1" class="ltx_Math" alttext="i" display="inline"><semantics id="algx2.l6.m2.1a"><mi mathsize="90%" id="algx2.l6.m2.1.1" xref="algx2.l6.m2.1.1.cmml">i</mi><annotation-xml encoding="MathML-Content" id="algx2.l6.m2.1b"><ci id="algx2.l6.m2.1.1.cmml" xref="algx2.l6.m2.1.1">𝑖</ci></annotation-xml><annotation encoding="application/x-tex" id="algx2.l6.m2.1c">i</annotation></semantics></math><span id="algx2.l6.3" class="ltx_text" style="font-size:90%;">-th client site

</span>
</div>
<div id="algx2.l7" class="ltx_listingline">
<span id="algx2.l7.1" class="ltx_text" style="font-size:90%;">     Wait to receive local updates from all </span><math id="algx2.l7.m1.1" class="ltx_Math" alttext="K" display="inline"><semantics id="algx2.l7.m1.1a"><mi mathsize="90%" id="algx2.l7.m1.1.1" xref="algx2.l7.m1.1.1.cmml">K</mi><annotation-xml encoding="MathML-Content" id="algx2.l7.m1.1b"><ci id="algx2.l7.m1.1.1.cmml" xref="algx2.l7.m1.1.1">𝐾</ci></annotation-xml><annotation encoding="application/x-tex" id="algx2.l7.m1.1c">K</annotation></semantics></math><span id="algx2.l7.2" class="ltx_text" style="font-size:90%;"> client sites, </span><math id="algx2.l7.m2.1" class="ltx_Math" alttext="\omega_{i}^{t}" display="inline"><semantics id="algx2.l7.m2.1a"><msubsup id="algx2.l7.m2.1.1" xref="algx2.l7.m2.1.1.cmml"><mi mathsize="90%" id="algx2.l7.m2.1.1.2.2" xref="algx2.l7.m2.1.1.2.2.cmml">ω</mi><mi mathsize="90%" id="algx2.l7.m2.1.1.2.3" xref="algx2.l7.m2.1.1.2.3.cmml">i</mi><mi mathsize="90%" id="algx2.l7.m2.1.1.3" xref="algx2.l7.m2.1.1.3.cmml">t</mi></msubsup><annotation-xml encoding="MathML-Content" id="algx2.l7.m2.1b"><apply id="algx2.l7.m2.1.1.cmml" xref="algx2.l7.m2.1.1"><csymbol cd="ambiguous" id="algx2.l7.m2.1.1.1.cmml" xref="algx2.l7.m2.1.1">superscript</csymbol><apply id="algx2.l7.m2.1.1.2.cmml" xref="algx2.l7.m2.1.1"><csymbol cd="ambiguous" id="algx2.l7.m2.1.1.2.1.cmml" xref="algx2.l7.m2.1.1">subscript</csymbol><ci id="algx2.l7.m2.1.1.2.2.cmml" xref="algx2.l7.m2.1.1.2.2">𝜔</ci><ci id="algx2.l7.m2.1.1.2.3.cmml" xref="algx2.l7.m2.1.1.2.3">𝑖</ci></apply><ci id="algx2.l7.m2.1.1.3.cmml" xref="algx2.l7.m2.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="algx2.l7.m2.1c">\omega_{i}^{t}</annotation></semantics></math><span id="algx2.l7.3" class="ltx_text" style="font-size:90%;">

</span>
</div>
<div id="algx2.l8" class="ltx_listingline">
<span id="algx2.l8.1" class="ltx_text" style="font-size:90%;">     Average to update global ML model parameters:
            </span><math id="algx2.l8.m1.1" class="ltx_Math" alttext="\omega\leftarrow\omega^{t+1}=\sum_{i=1}^{K}\frac{n_{i}}{N}\omega_{i}^{t}" display="inline"><semantics id="algx2.l8.m1.1a"><mrow id="algx2.l8.m1.1.1" xref="algx2.l8.m1.1.1.cmml"><mi mathsize="90%" id="algx2.l8.m1.1.1.2" xref="algx2.l8.m1.1.1.2.cmml">ω</mi><mo mathsize="90%" stretchy="false" id="algx2.l8.m1.1.1.3" xref="algx2.l8.m1.1.1.3.cmml">←</mo><msup id="algx2.l8.m1.1.1.4" xref="algx2.l8.m1.1.1.4.cmml"><mi mathsize="90%" id="algx2.l8.m1.1.1.4.2" xref="algx2.l8.m1.1.1.4.2.cmml">ω</mi><mrow id="algx2.l8.m1.1.1.4.3" xref="algx2.l8.m1.1.1.4.3.cmml"><mi mathsize="90%" id="algx2.l8.m1.1.1.4.3.2" xref="algx2.l8.m1.1.1.4.3.2.cmml">t</mi><mo mathsize="90%" id="algx2.l8.m1.1.1.4.3.1" xref="algx2.l8.m1.1.1.4.3.1.cmml">+</mo><mn mathsize="90%" id="algx2.l8.m1.1.1.4.3.3" xref="algx2.l8.m1.1.1.4.3.3.cmml">1</mn></mrow></msup><mo mathsize="90%" rspace="0.111em" id="algx2.l8.m1.1.1.5" xref="algx2.l8.m1.1.1.5.cmml">=</mo><mrow id="algx2.l8.m1.1.1.6" xref="algx2.l8.m1.1.1.6.cmml"><msubsup id="algx2.l8.m1.1.1.6.1" xref="algx2.l8.m1.1.1.6.1.cmml"><mo maxsize="90%" minsize="90%" stretchy="true" id="algx2.l8.m1.1.1.6.1.2.2" xref="algx2.l8.m1.1.1.6.1.2.2.cmml">∑</mo><mrow id="algx2.l8.m1.1.1.6.1.2.3" xref="algx2.l8.m1.1.1.6.1.2.3.cmml"><mi mathsize="90%" id="algx2.l8.m1.1.1.6.1.2.3.2" xref="algx2.l8.m1.1.1.6.1.2.3.2.cmml">i</mi><mo mathsize="90%" id="algx2.l8.m1.1.1.6.1.2.3.1" xref="algx2.l8.m1.1.1.6.1.2.3.1.cmml">=</mo><mn mathsize="90%" id="algx2.l8.m1.1.1.6.1.2.3.3" xref="algx2.l8.m1.1.1.6.1.2.3.3.cmml">1</mn></mrow><mi mathsize="90%" id="algx2.l8.m1.1.1.6.1.3" xref="algx2.l8.m1.1.1.6.1.3.cmml">K</mi></msubsup><mrow id="algx2.l8.m1.1.1.6.2" xref="algx2.l8.m1.1.1.6.2.cmml"><mfrac id="algx2.l8.m1.1.1.6.2.2" xref="algx2.l8.m1.1.1.6.2.2.cmml"><msub id="algx2.l8.m1.1.1.6.2.2.2" xref="algx2.l8.m1.1.1.6.2.2.2.cmml"><mi mathsize="90%" id="algx2.l8.m1.1.1.6.2.2.2.2" xref="algx2.l8.m1.1.1.6.2.2.2.2.cmml">n</mi><mi mathsize="90%" id="algx2.l8.m1.1.1.6.2.2.2.3" xref="algx2.l8.m1.1.1.6.2.2.2.3.cmml">i</mi></msub><mi mathsize="90%" id="algx2.l8.m1.1.1.6.2.2.3" xref="algx2.l8.m1.1.1.6.2.2.3.cmml">N</mi></mfrac><mo lspace="0em" rspace="0em" id="algx2.l8.m1.1.1.6.2.1" xref="algx2.l8.m1.1.1.6.2.1.cmml">​</mo><msubsup id="algx2.l8.m1.1.1.6.2.3" xref="algx2.l8.m1.1.1.6.2.3.cmml"><mi mathsize="90%" id="algx2.l8.m1.1.1.6.2.3.2.2" xref="algx2.l8.m1.1.1.6.2.3.2.2.cmml">ω</mi><mi mathsize="90%" id="algx2.l8.m1.1.1.6.2.3.2.3" xref="algx2.l8.m1.1.1.6.2.3.2.3.cmml">i</mi><mi mathsize="90%" id="algx2.l8.m1.1.1.6.2.3.3" xref="algx2.l8.m1.1.1.6.2.3.3.cmml">t</mi></msubsup></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="algx2.l8.m1.1b"><apply id="algx2.l8.m1.1.1.cmml" xref="algx2.l8.m1.1.1"><and id="algx2.l8.m1.1.1a.cmml" xref="algx2.l8.m1.1.1"></and><apply id="algx2.l8.m1.1.1b.cmml" xref="algx2.l8.m1.1.1"><ci id="algx2.l8.m1.1.1.3.cmml" xref="algx2.l8.m1.1.1.3">←</ci><ci id="algx2.l8.m1.1.1.2.cmml" xref="algx2.l8.m1.1.1.2">𝜔</ci><apply id="algx2.l8.m1.1.1.4.cmml" xref="algx2.l8.m1.1.1.4"><csymbol cd="ambiguous" id="algx2.l8.m1.1.1.4.1.cmml" xref="algx2.l8.m1.1.1.4">superscript</csymbol><ci id="algx2.l8.m1.1.1.4.2.cmml" xref="algx2.l8.m1.1.1.4.2">𝜔</ci><apply id="algx2.l8.m1.1.1.4.3.cmml" xref="algx2.l8.m1.1.1.4.3"><plus id="algx2.l8.m1.1.1.4.3.1.cmml" xref="algx2.l8.m1.1.1.4.3.1"></plus><ci id="algx2.l8.m1.1.1.4.3.2.cmml" xref="algx2.l8.m1.1.1.4.3.2">𝑡</ci><cn type="integer" id="algx2.l8.m1.1.1.4.3.3.cmml" xref="algx2.l8.m1.1.1.4.3.3">1</cn></apply></apply></apply><apply id="algx2.l8.m1.1.1c.cmml" xref="algx2.l8.m1.1.1"><eq id="algx2.l8.m1.1.1.5.cmml" xref="algx2.l8.m1.1.1.5"></eq><share href="#algx2.l8.m1.1.1.4.cmml" id="algx2.l8.m1.1.1d.cmml" xref="algx2.l8.m1.1.1"></share><apply id="algx2.l8.m1.1.1.6.cmml" xref="algx2.l8.m1.1.1.6"><apply id="algx2.l8.m1.1.1.6.1.cmml" xref="algx2.l8.m1.1.1.6.1"><csymbol cd="ambiguous" id="algx2.l8.m1.1.1.6.1.1.cmml" xref="algx2.l8.m1.1.1.6.1">superscript</csymbol><apply id="algx2.l8.m1.1.1.6.1.2.cmml" xref="algx2.l8.m1.1.1.6.1"><csymbol cd="ambiguous" id="algx2.l8.m1.1.1.6.1.2.1.cmml" xref="algx2.l8.m1.1.1.6.1">subscript</csymbol><sum id="algx2.l8.m1.1.1.6.1.2.2.cmml" xref="algx2.l8.m1.1.1.6.1.2.2"></sum><apply id="algx2.l8.m1.1.1.6.1.2.3.cmml" xref="algx2.l8.m1.1.1.6.1.2.3"><eq id="algx2.l8.m1.1.1.6.1.2.3.1.cmml" xref="algx2.l8.m1.1.1.6.1.2.3.1"></eq><ci id="algx2.l8.m1.1.1.6.1.2.3.2.cmml" xref="algx2.l8.m1.1.1.6.1.2.3.2">𝑖</ci><cn type="integer" id="algx2.l8.m1.1.1.6.1.2.3.3.cmml" xref="algx2.l8.m1.1.1.6.1.2.3.3">1</cn></apply></apply><ci id="algx2.l8.m1.1.1.6.1.3.cmml" xref="algx2.l8.m1.1.1.6.1.3">𝐾</ci></apply><apply id="algx2.l8.m1.1.1.6.2.cmml" xref="algx2.l8.m1.1.1.6.2"><times id="algx2.l8.m1.1.1.6.2.1.cmml" xref="algx2.l8.m1.1.1.6.2.1"></times><apply id="algx2.l8.m1.1.1.6.2.2.cmml" xref="algx2.l8.m1.1.1.6.2.2"><divide id="algx2.l8.m1.1.1.6.2.2.1.cmml" xref="algx2.l8.m1.1.1.6.2.2"></divide><apply id="algx2.l8.m1.1.1.6.2.2.2.cmml" xref="algx2.l8.m1.1.1.6.2.2.2"><csymbol cd="ambiguous" id="algx2.l8.m1.1.1.6.2.2.2.1.cmml" xref="algx2.l8.m1.1.1.6.2.2.2">subscript</csymbol><ci id="algx2.l8.m1.1.1.6.2.2.2.2.cmml" xref="algx2.l8.m1.1.1.6.2.2.2.2">𝑛</ci><ci id="algx2.l8.m1.1.1.6.2.2.2.3.cmml" xref="algx2.l8.m1.1.1.6.2.2.2.3">𝑖</ci></apply><ci id="algx2.l8.m1.1.1.6.2.2.3.cmml" xref="algx2.l8.m1.1.1.6.2.2.3">𝑁</ci></apply><apply id="algx2.l8.m1.1.1.6.2.3.cmml" xref="algx2.l8.m1.1.1.6.2.3"><csymbol cd="ambiguous" id="algx2.l8.m1.1.1.6.2.3.1.cmml" xref="algx2.l8.m1.1.1.6.2.3">superscript</csymbol><apply id="algx2.l8.m1.1.1.6.2.3.2.cmml" xref="algx2.l8.m1.1.1.6.2.3"><csymbol cd="ambiguous" id="algx2.l8.m1.1.1.6.2.3.2.1.cmml" xref="algx2.l8.m1.1.1.6.2.3">subscript</csymbol><ci id="algx2.l8.m1.1.1.6.2.3.2.2.cmml" xref="algx2.l8.m1.1.1.6.2.3.2.2">𝜔</ci><ci id="algx2.l8.m1.1.1.6.2.3.2.3.cmml" xref="algx2.l8.m1.1.1.6.2.3.2.3">𝑖</ci></apply><ci id="algx2.l8.m1.1.1.6.2.3.3.cmml" xref="algx2.l8.m1.1.1.6.2.3.3">𝑡</ci></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="algx2.l8.m1.1c">\omega\leftarrow\omega^{t+1}=\sum_{i=1}^{K}\frac{n_{i}}{N}\omega_{i}^{t}</annotation></semantics></math><span id="algx2.l8.2" class="ltx_text" style="font-size:90%;">

</span>
</div>
<div id="algx2.l9" class="ltx_listingline">
<span id="algx2.l9.1" class="ltx_text" style="font-size:90%;">  </span><span id="algx2.l9.2" class="ltx_text ltx_font_bold" style="font-size:90%;">Output:</span><span id="algx2.l9.3" class="ltx_text" style="font-size:90%;"> Final global ML parameters, </span><math id="algx2.l9.m1.1" class="ltx_Math" alttext="\omega" display="inline"><semantics id="algx2.l9.m1.1a"><mi mathsize="90%" id="algx2.l9.m1.1.1" xref="algx2.l9.m1.1.1.cmml">ω</mi><annotation-xml encoding="MathML-Content" id="algx2.l9.m1.1b"><ci id="algx2.l9.m1.1.1.cmml" xref="algx2.l9.m1.1.1">𝜔</ci></annotation-xml><annotation encoding="application/x-tex" id="algx2.l9.m1.1c">\omega</annotation></semantics></math><span id="algx2.l9.4" class="ltx_text" style="font-size:90%;"> </span>
</div>
</div>
</div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_1">
<p id="S2.F3.2" class="ltx_p ltx_figure_panel"><svg version="1.1" width="0" height="0" overflow="visible"><g transform="translate(0,0) scale(1,-1)"><path d="M 0,0 311.33,0" stroke="#000000" stroke-width="0.4"></path></g></svg></p>
</div>
</div>
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure">Figure 3: </span>Centralized server algorithm, <span id="S2.F3.5.1" class="ltx_text ltx_font_typewriter">FedAvg</span> <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib5" title="" class="ltx_ref">5</a>]</cite> </figcaption>
</figure>
</section>
<section id="S3" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">III </span><span id="S3.1.1" class="ltx_text ltx_font_smallcaps">Federated Learning with Imbalanced Ransomware Datasets</span>
</h2>

<div id="S3.p1" class="ltx_para">
<p id="S3.p1.10" class="ltx_p">As noted earlier, the distributed FL framework has recently been applied to ransomware analysis <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib3" title="" class="ltx_ref">3</a>]</cite>. This setup comprises of a <span id="S3.p1.10.1" class="ltx_text ltx_font_italic">central server</span> communicating with multiple <span id="S3.p1.10.2" class="ltx_text ltx_font_italic">client sites</span>, Figure <a href="#S2.F1" title="Figure 1 ‣ II Literature Review ‣ Ransomware Detection Using Federated Learning with Imbalanced Datasets" class="ltx_ref"><span class="ltx_text ltx_ref_tag">1</span></a>. Here, the former entity coordinates the overall distributed FL process. Meanwhile, the latter entities are located at trusted organizations with large user bases and perform raw data collection, feature extraction, and local ML model training. Namely, local training is done over <math id="S3.p1.1.m1.1" class="ltx_Math" alttext="T" display="inline"><semantics id="S3.p1.1.m1.1a"><mi id="S3.p1.1.m1.1.1" xref="S3.p1.1.m1.1.1.cmml">T</mi><annotation-xml encoding="MathML-Content" id="S3.p1.1.m1.1b"><ci id="S3.p1.1.m1.1.1.cmml" xref="S3.p1.1.m1.1.1">𝑇</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.p1.1.m1.1c">T</annotation></semantics></math> rounds, in which client sites receive “global” model parameters from the central server, <math id="S3.p1.2.m2.1" class="ltx_Math" alttext="\omega" display="inline"><semantics id="S3.p1.2.m2.1a"><mi id="S3.p1.2.m2.1.1" xref="S3.p1.2.m2.1.1.cmml">ω</mi><annotation-xml encoding="MathML-Content" id="S3.p1.2.m2.1b"><ci id="S3.p1.2.m2.1.1.cmml" xref="S3.p1.2.m2.1.1">𝜔</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.p1.2.m2.1c">\omega</annotation></semantics></math>. These models are then trained using local data and the updates sent back to the central server, see psuedocode in Figure <a href="#S2.F2" title="Figure 2 ‣ II Literature Review ‣ Ransomware Detection Using Federated Learning with Imbalanced Datasets" class="ltx_ref"><span class="ltx_text ltx_ref_tag">2</span></a>. Specifically, client site <math id="S3.p1.3.m3.1" class="ltx_Math" alttext="i" display="inline"><semantics id="S3.p1.3.m3.1a"><mi id="S3.p1.3.m3.1.1" xref="S3.p1.3.m3.1.1.cmml">i</mi><annotation-xml encoding="MathML-Content" id="S3.p1.3.m3.1b"><ci id="S3.p1.3.m3.1.1.cmml" xref="S3.p1.3.m3.1.1">𝑖</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.p1.3.m3.1c">i</annotation></semantics></math> has <math id="S3.p1.4.m4.1" class="ltx_Math" alttext="n_{i}" display="inline"><semantics id="S3.p1.4.m4.1a"><msub id="S3.p1.4.m4.1.1" xref="S3.p1.4.m4.1.1.cmml"><mi id="S3.p1.4.m4.1.1.2" xref="S3.p1.4.m4.1.1.2.cmml">n</mi><mi id="S3.p1.4.m4.1.1.3" xref="S3.p1.4.m4.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S3.p1.4.m4.1b"><apply id="S3.p1.4.m4.1.1.cmml" xref="S3.p1.4.m4.1.1"><csymbol cd="ambiguous" id="S3.p1.4.m4.1.1.1.cmml" xref="S3.p1.4.m4.1.1">subscript</csymbol><ci id="S3.p1.4.m4.1.1.2.cmml" xref="S3.p1.4.m4.1.1.2">𝑛</ci><ci id="S3.p1.4.m4.1.1.3.cmml" xref="S3.p1.4.m4.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p1.4.m4.1c">n_{i}</annotation></semantics></math> local samples that are split into <math id="S3.p1.5.m5.1" class="ltx_Math" alttext="B" display="inline"><semantics id="S3.p1.5.m5.1a"><mi id="S3.p1.5.m5.1.1" xref="S3.p1.5.m5.1.1.cmml">B</mi><annotation-xml encoding="MathML-Content" id="S3.p1.5.m5.1b"><ci id="S3.p1.5.m5.1.1.cmml" xref="S3.p1.5.m5.1.1">𝐵</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.p1.5.m5.1c">B</annotation></semantics></math> batches for training <math id="S3.p1.6.m6.1" class="ltx_Math" alttext="E" display="inline"><semantics id="S3.p1.6.m6.1a"><mi id="S3.p1.6.m6.1.1" xref="S3.p1.6.m6.1.1.cmml">E</mi><annotation-xml encoding="MathML-Content" id="S3.p1.6.m6.1b"><ci id="S3.p1.6.m6.1.1.cmml" xref="S3.p1.6.m6.1.1">𝐸</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.p1.6.m6.1c">E</annotation></semantics></math> epochs. Meanwhile, the central server selects a subset of <math id="S3.p1.7.m7.1" class="ltx_Math" alttext="K" display="inline"><semantics id="S3.p1.7.m7.1a"><mi id="S3.p1.7.m7.1.1" xref="S3.p1.7.m7.1.1.cmml">K</mi><annotation-xml encoding="MathML-Content" id="S3.p1.7.m7.1b"><ci id="S3.p1.7.m7.1.1.cmml" xref="S3.p1.7.m7.1.1">𝐾</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.p1.7.m7.1c">K</annotation></semantics></math> client sites to receive the latest global model parameters in each round, see psuedocode in Figure <a href="#S2.F3" title="Figure 3 ‣ II Literature Review ‣ Ransomware Detection Using Federated Learning with Imbalanced Datasets" class="ltx_ref"><span class="ltx_text ltx_ref_tag">3</span></a>. Incoming parameter updates are then averaged in a weighted manner to update the global model, where <math id="S3.p1.8.m8.1" class="ltx_Math" alttext="\omega_{i}^{t}" display="inline"><semantics id="S3.p1.8.m8.1a"><msubsup id="S3.p1.8.m8.1.1" xref="S3.p1.8.m8.1.1.cmml"><mi id="S3.p1.8.m8.1.1.2.2" xref="S3.p1.8.m8.1.1.2.2.cmml">ω</mi><mi id="S3.p1.8.m8.1.1.2.3" xref="S3.p1.8.m8.1.1.2.3.cmml">i</mi><mi id="S3.p1.8.m8.1.1.3" xref="S3.p1.8.m8.1.1.3.cmml">t</mi></msubsup><annotation-xml encoding="MathML-Content" id="S3.p1.8.m8.1b"><apply id="S3.p1.8.m8.1.1.cmml" xref="S3.p1.8.m8.1.1"><csymbol cd="ambiguous" id="S3.p1.8.m8.1.1.1.cmml" xref="S3.p1.8.m8.1.1">superscript</csymbol><apply id="S3.p1.8.m8.1.1.2.cmml" xref="S3.p1.8.m8.1.1"><csymbol cd="ambiguous" id="S3.p1.8.m8.1.1.2.1.cmml" xref="S3.p1.8.m8.1.1">subscript</csymbol><ci id="S3.p1.8.m8.1.1.2.2.cmml" xref="S3.p1.8.m8.1.1.2.2">𝜔</ci><ci id="S3.p1.8.m8.1.1.2.3.cmml" xref="S3.p1.8.m8.1.1.2.3">𝑖</ci></apply><ci id="S3.p1.8.m8.1.1.3.cmml" xref="S3.p1.8.m8.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p1.8.m8.1c">\omega_{i}^{t}</annotation></semantics></math> is the updated model parameters from client site <math id="S3.p1.9.m9.1" class="ltx_Math" alttext="i" display="inline"><semantics id="S3.p1.9.m9.1a"><mi id="S3.p1.9.m9.1.1" xref="S3.p1.9.m9.1.1.cmml">i</mi><annotation-xml encoding="MathML-Content" id="S3.p1.9.m9.1b"><ci id="S3.p1.9.m9.1.1.cmml" xref="S3.p1.9.m9.1.1">𝑖</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.p1.9.m9.1c">i</annotation></semantics></math> in round <math id="S3.p1.10.m10.1" class="ltx_Math" alttext="t" display="inline"><semantics id="S3.p1.10.m10.1a"><mi id="S3.p1.10.m10.1.1" xref="S3.p1.10.m10.1.1.cmml">t</mi><annotation-xml encoding="MathML-Content" id="S3.p1.10.m10.1b"><ci id="S3.p1.10.m10.1.1.cmml" xref="S3.p1.10.m10.1.1">𝑡</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.p1.10.m10.1c">t</annotation></semantics></math> (<span id="S3.p1.10.3" class="ltx_text ltx_font_typewriter">FedAvg</span> algorithm <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib5" title="" class="ltx_ref">5</a>]</cite>).</p>
</div>
<div id="S3.p2" class="ltx_para">
<p id="S3.p2.1" class="ltx_p">Now results in <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib6" title="" class="ltx_ref">6</a>]</cite> confirm that FL is very effective for ransomware detection and attribution with perfectly balanced client datasets. However, data imbalance can skew locally-trained models and reduce global accuracy <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib15" title="" class="ltx_ref">15</a>]</cite>. In particular, uneven data distribution can exist at both the global and local levels in FL, further complicating the challenge. Although anonymizing and sharing data between client sites is an option, few organizations will allow this. Moreover, data sharing violates a key premise of FL privacy. Now data imbalance in ML is not a new problem, and various solutions have been proposed, broadly categorized as data-level, algorithm-level, and hybrid <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib14" title="" class="ltx_ref">14</a>]</cite>. The goal is to improve ML classifier performance and closely track results with balanced datasets. For example, data-level methods use sampling and generative augmentation to add artificial samples for minority classes <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib16" title="" class="ltx_ref">16</a>]</cite>. Conversely, algorithm-level schemes use revised ML algorithms such as modified networks, updated loss functions, etc <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib14" title="" class="ltx_ref">14</a>]</cite>. Meanwhile, hybrid methods use a mix of strategies. However, most of these schemes are not designed for FL, although they can be applied at local client sites.</p>
</div>
<div id="S3.p3" class="ltx_para">
<p id="S3.p3.1" class="ltx_p">Now recent efforts have also proposed more specialized FL solutions for imbalanced datasets. For example, <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib15" title="" class="ltx_ref">15</a>]</cite> presents a self-balancing method using data augmentation and down-sampling techniques at client nodes. However, this method uses intermediate proxy servers and requires clients to share local data distributions. The latter is a key concern as it may compromise some privacy. Alternatively, <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib14" title="" class="ltx_ref">14</a>]</cite> proposes a monitoring scheme to estimate class composition in the training data during FL operation. This method requires clients to provide total sample counts and uses a weight change threshold to estimate proportion vectors in each training round. If sufficient imbalance is detected in a client’s data composition, then a new ratio loss function is used to mitigate its impact (based on cross entropy loss). Others have also studied the related problem of non-iid training datasets in FL, i.e., different underlying distributions at the client sites, see <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib6" title="" class="ltx_ref">6</a>]</cite> for references.</p>
</div>
<div id="S3.p4" class="ltx_para">
<p id="S3.p4.1" class="ltx_p">Drawing from the above, a weighted approach is used to scale the regular cross entropy loss function used for training <span id="S3.p4.1.1" class="ltx_text ltx_font_italic">feedforward neural network</span> (FNN) classifiers (at the client sites). Consider the regular cross entropy loss function for a multi-class problem with <math id="S3.p4.1.m1.1" class="ltx_Math" alttext="Q" display="inline"><semantics id="S3.p4.1.m1.1a"><mi id="S3.p4.1.m1.1.1" xref="S3.p4.1.m1.1.1.cmml">Q</mi><annotation-xml encoding="MathML-Content" id="S3.p4.1.m1.1b"><ci id="S3.p4.1.m1.1.1.cmml" xref="S3.p4.1.m1.1.1">𝑄</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.p4.1.m1.1c">Q</annotation></semantics></math> classes:</p>
<table id="S3.E1" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S3.E1.m1.1" class="ltx_Math" alttext="L_{CE}=-\sum_{i=1}^{Q}t_{i}{\tt log}(p_{i})" display="block"><semantics id="S3.E1.m1.1a"><mrow id="S3.E1.m1.1.1" xref="S3.E1.m1.1.1.cmml"><msub id="S3.E1.m1.1.1.3" xref="S3.E1.m1.1.1.3.cmml"><mi id="S3.E1.m1.1.1.3.2" xref="S3.E1.m1.1.1.3.2.cmml">L</mi><mrow id="S3.E1.m1.1.1.3.3" xref="S3.E1.m1.1.1.3.3.cmml"><mi id="S3.E1.m1.1.1.3.3.2" xref="S3.E1.m1.1.1.3.3.2.cmml">C</mi><mo lspace="0em" rspace="0em" id="S3.E1.m1.1.1.3.3.1" xref="S3.E1.m1.1.1.3.3.1.cmml">​</mo><mi id="S3.E1.m1.1.1.3.3.3" xref="S3.E1.m1.1.1.3.3.3.cmml">E</mi></mrow></msub><mo id="S3.E1.m1.1.1.2" xref="S3.E1.m1.1.1.2.cmml">=</mo><mrow id="S3.E1.m1.1.1.1" xref="S3.E1.m1.1.1.1.cmml"><mo id="S3.E1.m1.1.1.1a" xref="S3.E1.m1.1.1.1.cmml">−</mo><mrow id="S3.E1.m1.1.1.1.1" xref="S3.E1.m1.1.1.1.1.cmml"><munderover id="S3.E1.m1.1.1.1.1.2" xref="S3.E1.m1.1.1.1.1.2.cmml"><mo movablelimits="false" id="S3.E1.m1.1.1.1.1.2.2.2" xref="S3.E1.m1.1.1.1.1.2.2.2.cmml">∑</mo><mrow id="S3.E1.m1.1.1.1.1.2.2.3" xref="S3.E1.m1.1.1.1.1.2.2.3.cmml"><mi id="S3.E1.m1.1.1.1.1.2.2.3.2" xref="S3.E1.m1.1.1.1.1.2.2.3.2.cmml">i</mi><mo id="S3.E1.m1.1.1.1.1.2.2.3.1" xref="S3.E1.m1.1.1.1.1.2.2.3.1.cmml">=</mo><mn id="S3.E1.m1.1.1.1.1.2.2.3.3" xref="S3.E1.m1.1.1.1.1.2.2.3.3.cmml">1</mn></mrow><mi id="S3.E1.m1.1.1.1.1.2.3" xref="S3.E1.m1.1.1.1.1.2.3.cmml">Q</mi></munderover><mrow id="S3.E1.m1.1.1.1.1.1" xref="S3.E1.m1.1.1.1.1.1.cmml"><msub id="S3.E1.m1.1.1.1.1.1.3" xref="S3.E1.m1.1.1.1.1.1.3.cmml"><mi id="S3.E1.m1.1.1.1.1.1.3.2" xref="S3.E1.m1.1.1.1.1.1.3.2.cmml">t</mi><mi id="S3.E1.m1.1.1.1.1.1.3.3" xref="S3.E1.m1.1.1.1.1.1.3.3.cmml">i</mi></msub><mo lspace="0em" rspace="0em" id="S3.E1.m1.1.1.1.1.1.2" xref="S3.E1.m1.1.1.1.1.1.2.cmml">​</mo><mi id="S3.E1.m1.1.1.1.1.1.4" xref="S3.E1.m1.1.1.1.1.1.4.cmml">𝚕𝚘𝚐</mi><mo lspace="0em" rspace="0em" id="S3.E1.m1.1.1.1.1.1.2a" xref="S3.E1.m1.1.1.1.1.1.2.cmml">​</mo><mrow id="S3.E1.m1.1.1.1.1.1.1.1" xref="S3.E1.m1.1.1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S3.E1.m1.1.1.1.1.1.1.1.2" xref="S3.E1.m1.1.1.1.1.1.1.1.1.cmml">(</mo><msub id="S3.E1.m1.1.1.1.1.1.1.1.1" xref="S3.E1.m1.1.1.1.1.1.1.1.1.cmml"><mi id="S3.E1.m1.1.1.1.1.1.1.1.1.2" xref="S3.E1.m1.1.1.1.1.1.1.1.1.2.cmml">p</mi><mi id="S3.E1.m1.1.1.1.1.1.1.1.1.3" xref="S3.E1.m1.1.1.1.1.1.1.1.1.3.cmml">i</mi></msub><mo stretchy="false" id="S3.E1.m1.1.1.1.1.1.1.1.3" xref="S3.E1.m1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.E1.m1.1b"><apply id="S3.E1.m1.1.1.cmml" xref="S3.E1.m1.1.1"><eq id="S3.E1.m1.1.1.2.cmml" xref="S3.E1.m1.1.1.2"></eq><apply id="S3.E1.m1.1.1.3.cmml" xref="S3.E1.m1.1.1.3"><csymbol cd="ambiguous" id="S3.E1.m1.1.1.3.1.cmml" xref="S3.E1.m1.1.1.3">subscript</csymbol><ci id="S3.E1.m1.1.1.3.2.cmml" xref="S3.E1.m1.1.1.3.2">𝐿</ci><apply id="S3.E1.m1.1.1.3.3.cmml" xref="S3.E1.m1.1.1.3.3"><times id="S3.E1.m1.1.1.3.3.1.cmml" xref="S3.E1.m1.1.1.3.3.1"></times><ci id="S3.E1.m1.1.1.3.3.2.cmml" xref="S3.E1.m1.1.1.3.3.2">𝐶</ci><ci id="S3.E1.m1.1.1.3.3.3.cmml" xref="S3.E1.m1.1.1.3.3.3">𝐸</ci></apply></apply><apply id="S3.E1.m1.1.1.1.cmml" xref="S3.E1.m1.1.1.1"><minus id="S3.E1.m1.1.1.1.2.cmml" xref="S3.E1.m1.1.1.1"></minus><apply id="S3.E1.m1.1.1.1.1.cmml" xref="S3.E1.m1.1.1.1.1"><apply id="S3.E1.m1.1.1.1.1.2.cmml" xref="S3.E1.m1.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.E1.m1.1.1.1.1.2.1.cmml" xref="S3.E1.m1.1.1.1.1.2">superscript</csymbol><apply id="S3.E1.m1.1.1.1.1.2.2.cmml" xref="S3.E1.m1.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.E1.m1.1.1.1.1.2.2.1.cmml" xref="S3.E1.m1.1.1.1.1.2">subscript</csymbol><sum id="S3.E1.m1.1.1.1.1.2.2.2.cmml" xref="S3.E1.m1.1.1.1.1.2.2.2"></sum><apply id="S3.E1.m1.1.1.1.1.2.2.3.cmml" xref="S3.E1.m1.1.1.1.1.2.2.3"><eq id="S3.E1.m1.1.1.1.1.2.2.3.1.cmml" xref="S3.E1.m1.1.1.1.1.2.2.3.1"></eq><ci id="S3.E1.m1.1.1.1.1.2.2.3.2.cmml" xref="S3.E1.m1.1.1.1.1.2.2.3.2">𝑖</ci><cn type="integer" id="S3.E1.m1.1.1.1.1.2.2.3.3.cmml" xref="S3.E1.m1.1.1.1.1.2.2.3.3">1</cn></apply></apply><ci id="S3.E1.m1.1.1.1.1.2.3.cmml" xref="S3.E1.m1.1.1.1.1.2.3">𝑄</ci></apply><apply id="S3.E1.m1.1.1.1.1.1.cmml" xref="S3.E1.m1.1.1.1.1.1"><times id="S3.E1.m1.1.1.1.1.1.2.cmml" xref="S3.E1.m1.1.1.1.1.1.2"></times><apply id="S3.E1.m1.1.1.1.1.1.3.cmml" xref="S3.E1.m1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.E1.m1.1.1.1.1.1.3.1.cmml" xref="S3.E1.m1.1.1.1.1.1.3">subscript</csymbol><ci id="S3.E1.m1.1.1.1.1.1.3.2.cmml" xref="S3.E1.m1.1.1.1.1.1.3.2">𝑡</ci><ci id="S3.E1.m1.1.1.1.1.1.3.3.cmml" xref="S3.E1.m1.1.1.1.1.1.3.3">𝑖</ci></apply><ci id="S3.E1.m1.1.1.1.1.1.4.cmml" xref="S3.E1.m1.1.1.1.1.1.4">𝚕𝚘𝚐</ci><apply id="S3.E1.m1.1.1.1.1.1.1.1.1.cmml" xref="S3.E1.m1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E1.m1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E1.m1.1.1.1.1.1.1.1">subscript</csymbol><ci id="S3.E1.m1.1.1.1.1.1.1.1.1.2.cmml" xref="S3.E1.m1.1.1.1.1.1.1.1.1.2">𝑝</ci><ci id="S3.E1.m1.1.1.1.1.1.1.1.1.3.cmml" xref="S3.E1.m1.1.1.1.1.1.1.1.1.3">𝑖</ci></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E1.m1.1c">L_{CE}=-\sum_{i=1}^{Q}t_{i}{\tt log}(p_{i})</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(1)</span></td>
</tr></tbody>
</table>
<p id="S3.p4.9" class="ltx_p">where <math id="S3.p4.2.m1.1" class="ltx_Math" alttext="t_{i}" display="inline"><semantics id="S3.p4.2.m1.1a"><msub id="S3.p4.2.m1.1.1" xref="S3.p4.2.m1.1.1.cmml"><mi id="S3.p4.2.m1.1.1.2" xref="S3.p4.2.m1.1.1.2.cmml">t</mi><mi id="S3.p4.2.m1.1.1.3" xref="S3.p4.2.m1.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S3.p4.2.m1.1b"><apply id="S3.p4.2.m1.1.1.cmml" xref="S3.p4.2.m1.1.1"><csymbol cd="ambiguous" id="S3.p4.2.m1.1.1.1.cmml" xref="S3.p4.2.m1.1.1">subscript</csymbol><ci id="S3.p4.2.m1.1.1.2.cmml" xref="S3.p4.2.m1.1.1.2">𝑡</ci><ci id="S3.p4.2.m1.1.1.3.cmml" xref="S3.p4.2.m1.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p4.2.m1.1c">t_{i}</annotation></semantics></math> is the ground truth label for class <math id="S3.p4.3.m2.1" class="ltx_Math" alttext="i" display="inline"><semantics id="S3.p4.3.m2.1a"><mi id="S3.p4.3.m2.1.1" xref="S3.p4.3.m2.1.1.cmml">i</mi><annotation-xml encoding="MathML-Content" id="S3.p4.3.m2.1b"><ci id="S3.p4.3.m2.1.1.cmml" xref="S3.p4.3.m2.1.1">𝑖</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.p4.3.m2.1c">i</annotation></semantics></math>, and <math id="S3.p4.4.m3.1" class="ltx_Math" alttext="p_{i}" display="inline"><semantics id="S3.p4.4.m3.1a"><msub id="S3.p4.4.m3.1.1" xref="S3.p4.4.m3.1.1.cmml"><mi id="S3.p4.4.m3.1.1.2" xref="S3.p4.4.m3.1.1.2.cmml">p</mi><mi id="S3.p4.4.m3.1.1.3" xref="S3.p4.4.m3.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S3.p4.4.m3.1b"><apply id="S3.p4.4.m3.1.1.cmml" xref="S3.p4.4.m3.1.1"><csymbol cd="ambiguous" id="S3.p4.4.m3.1.1.1.cmml" xref="S3.p4.4.m3.1.1">subscript</csymbol><ci id="S3.p4.4.m3.1.1.2.cmml" xref="S3.p4.4.m3.1.1.2">𝑝</ci><ci id="S3.p4.4.m3.1.1.3.cmml" xref="S3.p4.4.m3.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p4.4.m3.1c">p_{i}</annotation></semantics></math> is the softmax probability for class <math id="S3.p4.5.m4.1" class="ltx_Math" alttext="i" display="inline"><semantics id="S3.p4.5.m4.1a"><mi id="S3.p4.5.m4.1.1" xref="S3.p4.5.m4.1.1.cmml">i</mi><annotation-xml encoding="MathML-Content" id="S3.p4.5.m4.1b"><ci id="S3.p4.5.m4.1.1.cmml" xref="S3.p4.5.m4.1.1">𝑖</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.p4.5.m4.1c">i</annotation></semantics></math>. To address dataset testing imbalance, a weighting vector, <math id="S3.p4.6.m5.4" class="ltx_Math" alttext="\Pi=\{\alpha_{1},\alpha_{2},\cdots,\alpha_{Q}\}" display="inline"><semantics id="S3.p4.6.m5.4a"><mrow id="S3.p4.6.m5.4.4" xref="S3.p4.6.m5.4.4.cmml"><mi mathvariant="normal" id="S3.p4.6.m5.4.4.5" xref="S3.p4.6.m5.4.4.5.cmml">Π</mi><mo id="S3.p4.6.m5.4.4.4" xref="S3.p4.6.m5.4.4.4.cmml">=</mo><mrow id="S3.p4.6.m5.4.4.3.3" xref="S3.p4.6.m5.4.4.3.4.cmml"><mo stretchy="false" id="S3.p4.6.m5.4.4.3.3.4" xref="S3.p4.6.m5.4.4.3.4.cmml">{</mo><msub id="S3.p4.6.m5.2.2.1.1.1" xref="S3.p4.6.m5.2.2.1.1.1.cmml"><mi id="S3.p4.6.m5.2.2.1.1.1.2" xref="S3.p4.6.m5.2.2.1.1.1.2.cmml">α</mi><mn id="S3.p4.6.m5.2.2.1.1.1.3" xref="S3.p4.6.m5.2.2.1.1.1.3.cmml">1</mn></msub><mo id="S3.p4.6.m5.4.4.3.3.5" xref="S3.p4.6.m5.4.4.3.4.cmml">,</mo><msub id="S3.p4.6.m5.3.3.2.2.2" xref="S3.p4.6.m5.3.3.2.2.2.cmml"><mi id="S3.p4.6.m5.3.3.2.2.2.2" xref="S3.p4.6.m5.3.3.2.2.2.2.cmml">α</mi><mn id="S3.p4.6.m5.3.3.2.2.2.3" xref="S3.p4.6.m5.3.3.2.2.2.3.cmml">2</mn></msub><mo id="S3.p4.6.m5.4.4.3.3.6" xref="S3.p4.6.m5.4.4.3.4.cmml">,</mo><mi mathvariant="normal" id="S3.p4.6.m5.1.1" xref="S3.p4.6.m5.1.1.cmml">⋯</mi><mo id="S3.p4.6.m5.4.4.3.3.7" xref="S3.p4.6.m5.4.4.3.4.cmml">,</mo><msub id="S3.p4.6.m5.4.4.3.3.3" xref="S3.p4.6.m5.4.4.3.3.3.cmml"><mi id="S3.p4.6.m5.4.4.3.3.3.2" xref="S3.p4.6.m5.4.4.3.3.3.2.cmml">α</mi><mi id="S3.p4.6.m5.4.4.3.3.3.3" xref="S3.p4.6.m5.4.4.3.3.3.3.cmml">Q</mi></msub><mo stretchy="false" id="S3.p4.6.m5.4.4.3.3.8" xref="S3.p4.6.m5.4.4.3.4.cmml">}</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.p4.6.m5.4b"><apply id="S3.p4.6.m5.4.4.cmml" xref="S3.p4.6.m5.4.4"><eq id="S3.p4.6.m5.4.4.4.cmml" xref="S3.p4.6.m5.4.4.4"></eq><ci id="S3.p4.6.m5.4.4.5.cmml" xref="S3.p4.6.m5.4.4.5">Π</ci><set id="S3.p4.6.m5.4.4.3.4.cmml" xref="S3.p4.6.m5.4.4.3.3"><apply id="S3.p4.6.m5.2.2.1.1.1.cmml" xref="S3.p4.6.m5.2.2.1.1.1"><csymbol cd="ambiguous" id="S3.p4.6.m5.2.2.1.1.1.1.cmml" xref="S3.p4.6.m5.2.2.1.1.1">subscript</csymbol><ci id="S3.p4.6.m5.2.2.1.1.1.2.cmml" xref="S3.p4.6.m5.2.2.1.1.1.2">𝛼</ci><cn type="integer" id="S3.p4.6.m5.2.2.1.1.1.3.cmml" xref="S3.p4.6.m5.2.2.1.1.1.3">1</cn></apply><apply id="S3.p4.6.m5.3.3.2.2.2.cmml" xref="S3.p4.6.m5.3.3.2.2.2"><csymbol cd="ambiguous" id="S3.p4.6.m5.3.3.2.2.2.1.cmml" xref="S3.p4.6.m5.3.3.2.2.2">subscript</csymbol><ci id="S3.p4.6.m5.3.3.2.2.2.2.cmml" xref="S3.p4.6.m5.3.3.2.2.2.2">𝛼</ci><cn type="integer" id="S3.p4.6.m5.3.3.2.2.2.3.cmml" xref="S3.p4.6.m5.3.3.2.2.2.3">2</cn></apply><ci id="S3.p4.6.m5.1.1.cmml" xref="S3.p4.6.m5.1.1">⋯</ci><apply id="S3.p4.6.m5.4.4.3.3.3.cmml" xref="S3.p4.6.m5.4.4.3.3.3"><csymbol cd="ambiguous" id="S3.p4.6.m5.4.4.3.3.3.1.cmml" xref="S3.p4.6.m5.4.4.3.3.3">subscript</csymbol><ci id="S3.p4.6.m5.4.4.3.3.3.2.cmml" xref="S3.p4.6.m5.4.4.3.3.3.2">𝛼</ci><ci id="S3.p4.6.m5.4.4.3.3.3.3.cmml" xref="S3.p4.6.m5.4.4.3.3.3.3">𝑄</ci></apply></set></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p4.6.m5.4c">\Pi=\{\alpha_{1},\alpha_{2},\cdots,\alpha_{Q}\}</annotation></semantics></math>, is introduced to scale the classes based upon the proportion of training data for each, i.e., where <math id="S3.p4.7.m6.1" class="ltx_Math" alttext="\alpha_{j}" display="inline"><semantics id="S3.p4.7.m6.1a"><msub id="S3.p4.7.m6.1.1" xref="S3.p4.7.m6.1.1.cmml"><mi id="S3.p4.7.m6.1.1.2" xref="S3.p4.7.m6.1.1.2.cmml">α</mi><mi id="S3.p4.7.m6.1.1.3" xref="S3.p4.7.m6.1.1.3.cmml">j</mi></msub><annotation-xml encoding="MathML-Content" id="S3.p4.7.m6.1b"><apply id="S3.p4.7.m6.1.1.cmml" xref="S3.p4.7.m6.1.1"><csymbol cd="ambiguous" id="S3.p4.7.m6.1.1.1.cmml" xref="S3.p4.7.m6.1.1">subscript</csymbol><ci id="S3.p4.7.m6.1.1.2.cmml" xref="S3.p4.7.m6.1.1.2">𝛼</ci><ci id="S3.p4.7.m6.1.1.3.cmml" xref="S3.p4.7.m6.1.1.3">𝑗</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p4.7.m6.1c">\alpha_{j}</annotation></semantics></math> is the weight for each individual class <math id="S3.p4.8.m7.1" class="ltx_Math" alttext="j" display="inline"><semantics id="S3.p4.8.m7.1a"><mi id="S3.p4.8.m7.1.1" xref="S3.p4.8.m7.1.1.cmml">j</mi><annotation-xml encoding="MathML-Content" id="S3.p4.8.m7.1b"><ci id="S3.p4.8.m7.1.1.cmml" xref="S3.p4.8.m7.1.1">𝑗</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.p4.8.m7.1c">j</annotation></semantics></math>. The overall strategy here is to assign larger weights to classes with more scarce data, and assign smaller weights to those with more representation. Now the individual values for <math id="S3.p4.9.m8.1" class="ltx_Math" alttext="\alpha_{j}" display="inline"><semantics id="S3.p4.9.m8.1a"><msub id="S3.p4.9.m8.1.1" xref="S3.p4.9.m8.1.1.cmml"><mi id="S3.p4.9.m8.1.1.2" xref="S3.p4.9.m8.1.1.2.cmml">α</mi><mi id="S3.p4.9.m8.1.1.3" xref="S3.p4.9.m8.1.1.3.cmml">j</mi></msub><annotation-xml encoding="MathML-Content" id="S3.p4.9.m8.1b"><apply id="S3.p4.9.m8.1.1.cmml" xref="S3.p4.9.m8.1.1"><csymbol cd="ambiguous" id="S3.p4.9.m8.1.1.1.cmml" xref="S3.p4.9.m8.1.1">subscript</csymbol><ci id="S3.p4.9.m8.1.1.2.cmml" xref="S3.p4.9.m8.1.1.2">𝛼</ci><ci id="S3.p4.9.m8.1.1.3.cmml" xref="S3.p4.9.m8.1.1.3">𝑗</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p4.9.m8.1c">\alpha_{j}</annotation></semantics></math> are determined as follows:</p>
<table id="S3.E2" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S3.E2.m1.1" class="ltx_Math" alttext="\alpha_{j}=\Big{(}\frac{\tt n_{i}^{j}}{{\tt max}({\tt{Z^{T})}}}\Big{)}^{-1}" display="block"><semantics id="S3.E2.m1.1a"><mrow id="S3.E2.m1.1.2" xref="S3.E2.m1.1.2.cmml"><msub id="S3.E2.m1.1.2.2" xref="S3.E2.m1.1.2.2.cmml"><mi id="S3.E2.m1.1.2.2.2" xref="S3.E2.m1.1.2.2.2.cmml">α</mi><mi id="S3.E2.m1.1.2.2.3" xref="S3.E2.m1.1.2.2.3.cmml">j</mi></msub><mo id="S3.E2.m1.1.2.1" xref="S3.E2.m1.1.2.1.cmml">=</mo><msup id="S3.E2.m1.1.2.3" xref="S3.E2.m1.1.2.3.cmml"><mrow id="S3.E2.m1.1.2.3.2.2" xref="S3.E2.m1.1.1.cmml"><mo maxsize="160%" minsize="160%" id="S3.E2.m1.1.2.3.2.2.1" xref="S3.E2.m1.1.1.cmml">(</mo><mfrac id="S3.E2.m1.1.1" xref="S3.E2.m1.1.1.cmml"><msubsup id="S3.E2.m1.1.1.3" xref="S3.E2.m1.1.1.3.cmml"><mi id="S3.E2.m1.1.1.3.2.2" xref="S3.E2.m1.1.1.3.2.2.cmml">𝚗</mi><mi id="S3.E2.m1.1.1.3.2.3" xref="S3.E2.m1.1.1.3.2.3.cmml">𝚒</mi><mi id="S3.E2.m1.1.1.3.3" xref="S3.E2.m1.1.1.3.3.cmml">𝚓</mi></msubsup><mrow id="S3.E2.m1.1.1.1" xref="S3.E2.m1.1.1.1.cmml"><mi id="S3.E2.m1.1.1.1.3" xref="S3.E2.m1.1.1.1.3.cmml">𝚖𝚊𝚡</mi><mo lspace="0em" rspace="0em" id="S3.E2.m1.1.1.1.2" xref="S3.E2.m1.1.1.1.2.cmml">​</mo><mrow id="S3.E2.m1.1.1.1.1.1" xref="S3.E2.m1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S3.E2.m1.1.1.1.1.1.2" xref="S3.E2.m1.1.1.1.1.1.1.cmml">(</mo><msup id="S3.E2.m1.1.1.1.1.1.1" xref="S3.E2.m1.1.1.1.1.1.1.cmml"><mi id="S3.E2.m1.1.1.1.1.1.1.2" xref="S3.E2.m1.1.1.1.1.1.1.2.cmml">𝚉</mi><mi id="S3.E2.m1.1.1.1.1.1.1.3" xref="S3.E2.m1.1.1.1.1.1.1.3.cmml">𝚃</mi></msup><mo stretchy="false" id="S3.E2.m1.1.1.1.1.1.3" xref="S3.E2.m1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mfrac><mo maxsize="160%" minsize="160%" id="S3.E2.m1.1.2.3.2.2.2" xref="S3.E2.m1.1.1.cmml">)</mo></mrow><mrow id="S3.E2.m1.1.2.3.3" xref="S3.E2.m1.1.2.3.3.cmml"><mo id="S3.E2.m1.1.2.3.3a" xref="S3.E2.m1.1.2.3.3.cmml">−</mo><mn id="S3.E2.m1.1.2.3.3.2" xref="S3.E2.m1.1.2.3.3.2.cmml">1</mn></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S3.E2.m1.1b"><apply id="S3.E2.m1.1.2.cmml" xref="S3.E2.m1.1.2"><eq id="S3.E2.m1.1.2.1.cmml" xref="S3.E2.m1.1.2.1"></eq><apply id="S3.E2.m1.1.2.2.cmml" xref="S3.E2.m1.1.2.2"><csymbol cd="ambiguous" id="S3.E2.m1.1.2.2.1.cmml" xref="S3.E2.m1.1.2.2">subscript</csymbol><ci id="S3.E2.m1.1.2.2.2.cmml" xref="S3.E2.m1.1.2.2.2">𝛼</ci><ci id="S3.E2.m1.1.2.2.3.cmml" xref="S3.E2.m1.1.2.2.3">𝑗</ci></apply><apply id="S3.E2.m1.1.2.3.cmml" xref="S3.E2.m1.1.2.3"><csymbol cd="ambiguous" id="S3.E2.m1.1.2.3.1.cmml" xref="S3.E2.m1.1.2.3">superscript</csymbol><apply id="S3.E2.m1.1.1.cmml" xref="S3.E2.m1.1.2.3.2.2"><divide id="S3.E2.m1.1.1.2.cmml" xref="S3.E2.m1.1.2.3.2.2"></divide><apply id="S3.E2.m1.1.1.3.cmml" xref="S3.E2.m1.1.1.3"><csymbol cd="ambiguous" id="S3.E2.m1.1.1.3.1.cmml" xref="S3.E2.m1.1.1.3">superscript</csymbol><apply id="S3.E2.m1.1.1.3.2.cmml" xref="S3.E2.m1.1.1.3"><csymbol cd="ambiguous" id="S3.E2.m1.1.1.3.2.1.cmml" xref="S3.E2.m1.1.1.3">subscript</csymbol><ci id="S3.E2.m1.1.1.3.2.2.cmml" xref="S3.E2.m1.1.1.3.2.2">𝚗</ci><ci id="S3.E2.m1.1.1.3.2.3.cmml" xref="S3.E2.m1.1.1.3.2.3">𝚒</ci></apply><ci id="S3.E2.m1.1.1.3.3.cmml" xref="S3.E2.m1.1.1.3.3">𝚓</ci></apply><apply id="S3.E2.m1.1.1.1.cmml" xref="S3.E2.m1.1.1.1"><times id="S3.E2.m1.1.1.1.2.cmml" xref="S3.E2.m1.1.1.1.2"></times><ci id="S3.E2.m1.1.1.1.3.cmml" xref="S3.E2.m1.1.1.1.3">𝚖𝚊𝚡</ci><apply id="S3.E2.m1.1.1.1.1.1.1.cmml" xref="S3.E2.m1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E2.m1.1.1.1.1.1.1.1.cmml" xref="S3.E2.m1.1.1.1.1.1">superscript</csymbol><ci id="S3.E2.m1.1.1.1.1.1.1.2.cmml" xref="S3.E2.m1.1.1.1.1.1.1.2">𝚉</ci><ci id="S3.E2.m1.1.1.1.1.1.1.3.cmml" xref="S3.E2.m1.1.1.1.1.1.1.3">𝚃</ci></apply></apply></apply><apply id="S3.E2.m1.1.2.3.3.cmml" xref="S3.E2.m1.1.2.3.3"><minus id="S3.E2.m1.1.2.3.3.1.cmml" xref="S3.E2.m1.1.2.3.3"></minus><cn type="integer" id="S3.E2.m1.1.2.3.3.2.cmml" xref="S3.E2.m1.1.2.3.3.2">1</cn></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E2.m1.1c">\alpha_{j}=\Big{(}\frac{\tt n_{i}^{j}}{{\tt max}({\tt{Z^{T})}}}\Big{)}^{-1}</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(2)</span></td>
</tr></tbody>
</table>
<p id="S3.p4.15" class="ltx_p">where <math id="S3.p4.10.m1.1" class="ltx_Math" alttext="n_{i}^{j}" display="inline"><semantics id="S3.p4.10.m1.1a"><msubsup id="S3.p4.10.m1.1.1" xref="S3.p4.10.m1.1.1.cmml"><mi id="S3.p4.10.m1.1.1.2.2" xref="S3.p4.10.m1.1.1.2.2.cmml">n</mi><mi id="S3.p4.10.m1.1.1.2.3" xref="S3.p4.10.m1.1.1.2.3.cmml">i</mi><mi id="S3.p4.10.m1.1.1.3" xref="S3.p4.10.m1.1.1.3.cmml">j</mi></msubsup><annotation-xml encoding="MathML-Content" id="S3.p4.10.m1.1b"><apply id="S3.p4.10.m1.1.1.cmml" xref="S3.p4.10.m1.1.1"><csymbol cd="ambiguous" id="S3.p4.10.m1.1.1.1.cmml" xref="S3.p4.10.m1.1.1">superscript</csymbol><apply id="S3.p4.10.m1.1.1.2.cmml" xref="S3.p4.10.m1.1.1"><csymbol cd="ambiguous" id="S3.p4.10.m1.1.1.2.1.cmml" xref="S3.p4.10.m1.1.1">subscript</csymbol><ci id="S3.p4.10.m1.1.1.2.2.cmml" xref="S3.p4.10.m1.1.1.2.2">𝑛</ci><ci id="S3.p4.10.m1.1.1.2.3.cmml" xref="S3.p4.10.m1.1.1.2.3">𝑖</ci></apply><ci id="S3.p4.10.m1.1.1.3.cmml" xref="S3.p4.10.m1.1.1.3">𝑗</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p4.10.m1.1c">n_{i}^{j}</annotation></semantics></math> is the number of training samples of class <math id="S3.p4.11.m2.1" class="ltx_Math" alttext="j" display="inline"><semantics id="S3.p4.11.m2.1a"><mi id="S3.p4.11.m2.1.1" xref="S3.p4.11.m2.1.1.cmml">j</mi><annotation-xml encoding="MathML-Content" id="S3.p4.11.m2.1b"><ci id="S3.p4.11.m2.1.1.cmml" xref="S3.p4.11.m2.1.1">𝑗</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.p4.11.m2.1c">j</annotation></semantics></math> at client site <math id="S3.p4.12.m3.1" class="ltx_Math" alttext="i" display="inline"><semantics id="S3.p4.12.m3.1a"><mi id="S3.p4.12.m3.1.1" xref="S3.p4.12.m3.1.1.cmml">i</mi><annotation-xml encoding="MathML-Content" id="S3.p4.12.m3.1b"><ci id="S3.p4.12.m3.1.1.cmml" xref="S3.p4.12.m3.1.1">𝑖</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.p4.12.m3.1c">i</annotation></semantics></math>, and <math id="S3.p4.13.m4.1" class="ltx_Math" alttext="Z_{T}" display="inline"><semantics id="S3.p4.13.m4.1a"><msub id="S3.p4.13.m4.1.1" xref="S3.p4.13.m4.1.1.cmml"><mi id="S3.p4.13.m4.1.1.2" xref="S3.p4.13.m4.1.1.2.cmml">Z</mi><mi id="S3.p4.13.m4.1.1.3" xref="S3.p4.13.m4.1.1.3.cmml">T</mi></msub><annotation-xml encoding="MathML-Content" id="S3.p4.13.m4.1b"><apply id="S3.p4.13.m4.1.1.cmml" xref="S3.p4.13.m4.1.1"><csymbol cd="ambiguous" id="S3.p4.13.m4.1.1.1.cmml" xref="S3.p4.13.m4.1.1">subscript</csymbol><ci id="S3.p4.13.m4.1.1.2.cmml" xref="S3.p4.13.m4.1.1.2">𝑍</ci><ci id="S3.p4.13.m4.1.1.3.cmml" xref="S3.p4.13.m4.1.1.3">𝑇</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p4.13.m4.1c">Z_{T}</annotation></semantics></math> is an array representing all training values of <math id="S3.p4.14.m5.1" class="ltx_Math" alttext="n_{i}^{j}" display="inline"><semantics id="S3.p4.14.m5.1a"><msubsup id="S3.p4.14.m5.1.1" xref="S3.p4.14.m5.1.1.cmml"><mi id="S3.p4.14.m5.1.1.2.2" xref="S3.p4.14.m5.1.1.2.2.cmml">n</mi><mi id="S3.p4.14.m5.1.1.2.3" xref="S3.p4.14.m5.1.1.2.3.cmml">i</mi><mi id="S3.p4.14.m5.1.1.3" xref="S3.p4.14.m5.1.1.3.cmml">j</mi></msubsup><annotation-xml encoding="MathML-Content" id="S3.p4.14.m5.1b"><apply id="S3.p4.14.m5.1.1.cmml" xref="S3.p4.14.m5.1.1"><csymbol cd="ambiguous" id="S3.p4.14.m5.1.1.1.cmml" xref="S3.p4.14.m5.1.1">superscript</csymbol><apply id="S3.p4.14.m5.1.1.2.cmml" xref="S3.p4.14.m5.1.1"><csymbol cd="ambiguous" id="S3.p4.14.m5.1.1.2.1.cmml" xref="S3.p4.14.m5.1.1">subscript</csymbol><ci id="S3.p4.14.m5.1.1.2.2.cmml" xref="S3.p4.14.m5.1.1.2.2">𝑛</ci><ci id="S3.p4.14.m5.1.1.2.3.cmml" xref="S3.p4.14.m5.1.1.2.3">𝑖</ci></apply><ci id="S3.p4.14.m5.1.1.3.cmml" xref="S3.p4.14.m5.1.1.3">𝑗</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p4.14.m5.1c">n_{i}^{j}</annotation></semantics></math> at a given client site <math id="S3.p4.15.m6.1" class="ltx_Math" alttext="i" display="inline"><semantics id="S3.p4.15.m6.1a"><mi id="S3.p4.15.m6.1.1" xref="S3.p4.15.m6.1.1.cmml">i</mi><annotation-xml encoding="MathML-Content" id="S3.p4.15.m6.1b"><ci id="S3.p4.15.m6.1.1.cmml" xref="S3.p4.15.m6.1.1">𝑖</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.p4.15.m6.1c">i</annotation></semantics></math>. This equation is a variation of a technique known as inverse class frequency weighting, where higher frequency classes are scaled using smaller weights and lower frequency classes are scaled using larger weights. These revisions for weighted cross entropy loss are also shown in the client site psuedocode in Figure <a href="#S2.F2" title="Figure 2 ‣ II Literature Review ‣ Ransomware Detection Using Federated Learning with Imbalanced Datasets" class="ltx_ref"><span class="ltx_text ltx_ref_tag">2</span></a> (versus <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib6" title="" class="ltx_ref">6</a>]</cite>).</p>
</div>
<figure id="S3.F4" class="ltx_figure"><img src="/html/2311.07760/assets/FIG/dataset_imbalanced.png" id="S3.F4.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="499" height="329" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 4: </span>Imbalanced ransomware dataset for FL setup with <math id="S3.F4.2.m1.1" class="ltx_Math" alttext="K" display="inline"><semantics id="S3.F4.2.m1.1b"><mi id="S3.F4.2.m1.1.1" xref="S3.F4.2.m1.1.1.cmml">K</mi><annotation-xml encoding="MathML-Content" id="S3.F4.2.m1.1c"><ci id="S3.F4.2.m1.1.1.cmml" xref="S3.F4.2.m1.1.1">𝐾</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.F4.2.m1.1d">K</annotation></semantics></math>=3 client sites (using FNN classifiers)</figcaption>
</figure>
<figure id="S3.T1" class="ltx_table">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table">TABLE I: </span>Empirical dataset (9 families and benign)</figcaption>
<table id="S3.T1.1" class="ltx_tabular ltx_centering ltx_guessed_headers ltx_align_middle">
<tbody class="ltx_tbody">
<tr id="S3.T1.1.1.1" class="ltx_tr">
<th id="S3.T1.1.1.1.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_l ltx_border_r ltx_border_t"><span id="S3.T1.1.1.1.1.1" class="ltx_text ltx_font_bold">Family</span></th>
<td id="S3.T1.1.1.1.2" class="ltx_td ltx_align_center ltx_border_r ltx_border_t"><span id="S3.T1.1.1.1.2.1" class="ltx_text ltx_font_bold">Samples</span></td>
<td id="S3.T1.1.1.1.3" class="ltx_td ltx_align_center ltx_border_r ltx_border_t"><span id="S3.T1.1.1.1.3.1" class="ltx_text ltx_font_bold">Avg. Size</span></td>
<td id="S3.T1.1.1.1.4" class="ltx_td ltx_align_center ltx_border_r ltx_border_t"><span id="S3.T1.1.1.1.4.1" class="ltx_text ltx_font_bold">Avg. PE File</span></td>
</tr>
<tr id="S3.T1.1.2.2" class="ltx_tr">
<th id="S3.T1.1.2.2.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_l ltx_border_r ltx_border_tt">Babuk/Babyk</th>
<td id="S3.T1.1.2.2.2" class="ltx_td ltx_align_center ltx_border_r ltx_border_tt">140</td>
<td id="S3.T1.1.2.2.3" class="ltx_td ltx_align_center ltx_border_r ltx_border_tt">0.19 MB</td>
<td id="S3.T1.1.2.2.4" class="ltx_td ltx_align_center ltx_border_r ltx_border_tt">32.68 KB</td>
</tr>
<tr id="S3.T1.1.3.3" class="ltx_tr">
<th id="S3.T1.1.3.3.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_l ltx_border_r ltx_border_t">BlackCat</th>
<td id="S3.T1.1.3.3.2" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">120</td>
<td id="S3.T1.1.3.3.3" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">3.91 MB</td>
<td id="S3.T1.1.3.3.4" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">1,147 KB</td>
</tr>
<tr id="S3.T1.1.4.4" class="ltx_tr">
<th id="S3.T1.1.4.4.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_l ltx_border_r ltx_border_t">Chaos</th>
<td id="S3.T1.1.4.4.2" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">140</td>
<td id="S3.T1.1.4.4.3" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">0.49 MB</td>
<td id="S3.T1.1.4.4.4" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">35.2 KB</td>
</tr>
<tr id="S3.T1.1.5.5" class="ltx_tr">
<th id="S3.T1.1.5.5.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_l ltx_border_r ltx_border_t">DJVu (STOP)</th>
<td id="S3.T1.1.5.5.2" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">140</td>
<td id="S3.T1.1.5.5.3" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">0.71 MB</td>
<td id="S3.T1.1.5.5.4" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">66.2 KB</td>
</tr>
<tr id="S3.T1.1.6.6" class="ltx_tr">
<th id="S3.T1.1.6.6.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_l ltx_border_r ltx_border_t">Hive</th>
<td id="S3.T1.1.6.6.2" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">140</td>
<td id="S3.T1.1.6.6.3" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">3.51 MB</td>
<td id="S3.T1.1.6.6.4" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">403.9 KB</td>
</tr>
<tr id="S3.T1.1.7.7" class="ltx_tr">
<th id="S3.T1.1.7.7.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_l ltx_border_r ltx_border_t">LockBit</th>
<td id="S3.T1.1.7.7.2" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">140</td>
<td id="S3.T1.1.7.7.3" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">1.30 MB</td>
<td id="S3.T1.1.7.7.4" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">171.5 KB</td>
</tr>
<tr id="S3.T1.1.8.8" class="ltx_tr">
<th id="S3.T1.1.8.8.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_l ltx_border_r ltx_border_t">Netwalker</th>
<td id="S3.T1.1.8.8.2" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">140</td>
<td id="S3.T1.1.8.8.3" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">0.26 MB</td>
<td id="S3.T1.1.8.8.4" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">35.72 KB</td>
</tr>
<tr id="S3.T1.1.9.9" class="ltx_tr">
<th id="S3.T1.1.9.9.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_l ltx_border_r ltx_border_t">Sodinokibi</th>
<td id="S3.T1.1.9.9.2" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">140</td>
<td id="S3.T1.1.9.9.3" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">0.30 MB</td>
<td id="S3.T1.1.9.9.4" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">50.89 KB</td>
</tr>
<tr id="S3.T1.1.10.10" class="ltx_tr">
<th id="S3.T1.1.10.10.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_l ltx_border_r ltx_border_t">WannaCry</th>
<td id="S3.T1.1.10.10.2" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">140</td>
<td id="S3.T1.1.10.10.3" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">7.62 MB</td>
<td id="S3.T1.1.10.10.4" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">21.83 KB</td>
</tr>
<tr id="S3.T1.1.11.11" class="ltx_tr">
<th id="S3.T1.1.11.11.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_b ltx_border_l ltx_border_r ltx_border_tt">Benign apps</th>
<td id="S3.T1.1.11.11.2" class="ltx_td ltx_align_center ltx_border_b ltx_border_r ltx_border_tt">2,000</td>
<td id="S3.T1.1.11.11.3" class="ltx_td ltx_align_center ltx_border_b ltx_border_r ltx_border_tt">26.86 MB</td>
<td id="S3.T1.1.11.11.4" class="ltx_td ltx_align_center ltx_border_b ltx_border_r ltx_border_tt">155.88 KB</td>
</tr>
</tbody>
</table>
</figure>
</section>
<section id="S4" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">IV </span><span id="S4.1.1" class="ltx_text ltx_font_smallcaps">Performance Evaluation</span>
</h2>

<div id="S4.p1" class="ltx_para">
<p id="S4.p1.1" class="ltx_p">The performance of the weighted cross entropy loss scheme is tested for both the ransomware detection and attribution problems. An up-to-data repository is used for evaluation purposes here, as per recent studies in <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib6" title="" class="ltx_ref">6</a>]</cite>,<cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib10" title="" class="ltx_ref">10</a>]</cite>. Specifically, this dataset contains binary executables of some of latest ransomware families, as per the IBM X-Force Threat Intelligence Index. This collection includes Babuk/Babyk, BlackCat, Chaos, DJVu/STOP, Hive, LockBit, Netwalker, Sodinokibi/REvil, and WannaCry (9 families in total).</p>
</div>
<div id="S4.p2" class="ltx_para">
<p id="S4.p2.1" class="ltx_p">Now given the dynamic nature of the ransomware threat, it is difficult to collect a large number of samples for each family. Hence, only 140 executable samples are collected for each family from various open repositories, e.g., such as <span id="S4.p2.1.1" class="ltx_text ltx_font_italic">MalwareBazar</span>, <span id="S4.p2.1.2" class="ltx_text ltx_font_italic">Triage</span>, <span id="S4.p2.1.3" class="ltx_text ltx_font_italic">VirusShare</span>, and <span id="S4.p2.1.4" class="ltx_text ltx_font_italic">VirusTotal</span>. This gives a total of 1,260 malware samples. In addition, 2,000 benign Windows applications are also collected to build a benign training class, i.e., 10 total classes. These raw binary executables are then pre-processed to build the ML training/testing dataset. In particular, 15 specific parameters are extracted from the Windows PE format files to generate the requisite feature vectors. Note that these file types are organized in sections (with headers) and contain crucial metadata to support program execution. For further details on the extracted feature sets, please refer to <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib10" title="" class="ltx_ref">10</a>]</cite>.</p>
</div>
<div id="S4.p3" class="ltx_para">
<p id="S4.p3.1" class="ltx_p">Now FL evaluation is done for the case of <math id="S4.p3.1.m1.1" class="ltx_Math" alttext="K=3" display="inline"><semantics id="S4.p3.1.m1.1a"><mrow id="S4.p3.1.m1.1.1" xref="S4.p3.1.m1.1.1.cmml"><mi id="S4.p3.1.m1.1.1.2" xref="S4.p3.1.m1.1.1.2.cmml">K</mi><mo id="S4.p3.1.m1.1.1.1" xref="S4.p3.1.m1.1.1.1.cmml">=</mo><mn id="S4.p3.1.m1.1.1.3" xref="S4.p3.1.m1.1.1.3.cmml">3</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.p3.1.m1.1b"><apply id="S4.p3.1.m1.1.1.cmml" xref="S4.p3.1.m1.1.1"><eq id="S4.p3.1.m1.1.1.1.cmml" xref="S4.p3.1.m1.1.1.1"></eq><ci id="S4.p3.1.m1.1.1.2.cmml" xref="S4.p3.1.m1.1.1.2">𝐾</ci><cn type="integer" id="S4.p3.1.m1.1.1.3.cmml" xref="S4.p3.1.m1.1.1.3">3</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.p3.1.m1.1c">K=3</annotation></semantics></math> distributed client sites. Accordingly, the above dataset is split in a balanced (even) and imbalanced (uneven) manner using a 85/15% partitioning between training/testing data. Namely, for balanced dataset partitioning, 20 random samples of each ransomware family are selected for testing, and the remaining 120 samples are distributed across the 3 client sites for training, i.e., 40 samples each (only 360 malware samples per client site). Conversely, the benign samples are not partitioned between the client sites. The reason here is that regular applications downloads will exceed ransomware downloads in many real-world settings, and there may also be a strong overlap between application downloads across sites. Hence it is feasible and realistic to use the same (larger) set of benign samples across all client sites. Hence the benign samples are also split in a 85/15% manner, with 300 randomized samples selected for testing, and the remaining 1,700 used for training.</p>
</div>
<div id="S4.p4" class="ltx_para">
<p id="S4.p4.1" class="ltx_p">Meanwhile, the imbalanced dataset is also designed using an 85/15% partitioning. Again, 20 random samples from each family are reserved for testing, whereas the remaining 120 samples are used for training (1,080 total). However, the latter samples are now distributed in an uneven manner between the 3 client sites, as shown in Figure <a href="#S3.F4" title="Figure 4 ‣ III Federated Learning with Imbalanced Ransomware Datasets ‣ Ransomware Detection Using Federated Learning with Imbalanced Datasets" class="ltx_ref"><span class="ltx_text ltx_ref_tag">4</span></a>. This partitioning generates a notable imbalance between the number of training samples at each client site and the relative percentage of families at each client site. For example, client site 1 has 50% of the training data (540 samples), whereas client sites 2 and 3 have 25% (270 samples each). Furthermore, classes 0-4 (Sodinokibi, LockBit, Babuk/Babyk, DJVu, NetWalker) represent the majority classes at client site 1. Conversely, classes 5 and 6 (Chaos, Hive) represent the majority classes at client site 2, and classes 7 and 8 (BlackCat, WannaCry) represent the majority classes at client site 3, Figure <a href="#S3.F4" title="Figure 4 ‣ III Federated Learning with Imbalanced Ransomware Datasets ‣ Ransomware Detection Using Federated Learning with Imbalanced Datasets" class="ltx_ref"><span class="ltx_text ltx_ref_tag">4</span></a>. To further quantify this imbalance, the <span id="S4.p4.1.1" class="ltx_text ltx_font_italic">imbalance ratio</span> from <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib14" title="" class="ltx_ref">14</a>]</cite> is also computed for each client site <math id="S4.p4.1.m1.1" class="ltx_Math" alttext="i" display="inline"><semantics id="S4.p4.1.m1.1a"><mi id="S4.p4.1.m1.1.1" xref="S4.p4.1.m1.1.1.cmml">i</mi><annotation-xml encoding="MathML-Content" id="S4.p4.1.m1.1b"><ci id="S4.p4.1.m1.1.1.cmml" xref="S4.p4.1.m1.1.1">𝑖</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.p4.1.m1.1c">i</annotation></semantics></math> as follows:</p>
<table id="S4.E3" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S4.E3.m1.2" class="ltx_Math" alttext="\gamma_{i}=\frac{{\tt max}_{j}({n_{i}^{j}})}{{\tt min}_{j}({n_{i}^{j}})}" display="block"><semantics id="S4.E3.m1.2a"><mrow id="S4.E3.m1.2.3" xref="S4.E3.m1.2.3.cmml"><msub id="S4.E3.m1.2.3.2" xref="S4.E3.m1.2.3.2.cmml"><mi id="S4.E3.m1.2.3.2.2" xref="S4.E3.m1.2.3.2.2.cmml">γ</mi><mi id="S4.E3.m1.2.3.2.3" xref="S4.E3.m1.2.3.2.3.cmml">i</mi></msub><mo id="S4.E3.m1.2.3.1" xref="S4.E3.m1.2.3.1.cmml">=</mo><mfrac id="S4.E3.m1.2.2" xref="S4.E3.m1.2.2.cmml"><mrow id="S4.E3.m1.1.1.1" xref="S4.E3.m1.1.1.1.cmml"><msub id="S4.E3.m1.1.1.1.3" xref="S4.E3.m1.1.1.1.3.cmml"><mi id="S4.E3.m1.1.1.1.3.2" xref="S4.E3.m1.1.1.1.3.2.cmml">𝚖𝚊𝚡</mi><mi id="S4.E3.m1.1.1.1.3.3" xref="S4.E3.m1.1.1.1.3.3.cmml">j</mi></msub><mo lspace="0em" rspace="0em" id="S4.E3.m1.1.1.1.2" xref="S4.E3.m1.1.1.1.2.cmml">​</mo><mrow id="S4.E3.m1.1.1.1.1.1" xref="S4.E3.m1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S4.E3.m1.1.1.1.1.1.2" xref="S4.E3.m1.1.1.1.1.1.1.cmml">(</mo><msubsup id="S4.E3.m1.1.1.1.1.1.1" xref="S4.E3.m1.1.1.1.1.1.1.cmml"><mi id="S4.E3.m1.1.1.1.1.1.1.2.2" xref="S4.E3.m1.1.1.1.1.1.1.2.2.cmml">n</mi><mi id="S4.E3.m1.1.1.1.1.1.1.2.3" xref="S4.E3.m1.1.1.1.1.1.1.2.3.cmml">i</mi><mi id="S4.E3.m1.1.1.1.1.1.1.3" xref="S4.E3.m1.1.1.1.1.1.1.3.cmml">j</mi></msubsup><mo stretchy="false" id="S4.E3.m1.1.1.1.1.1.3" xref="S4.E3.m1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mrow id="S4.E3.m1.2.2.2" xref="S4.E3.m1.2.2.2.cmml"><msub id="S4.E3.m1.2.2.2.3" xref="S4.E3.m1.2.2.2.3.cmml"><mi id="S4.E3.m1.2.2.2.3.2" xref="S4.E3.m1.2.2.2.3.2.cmml">𝚖𝚒𝚗</mi><mi id="S4.E3.m1.2.2.2.3.3" xref="S4.E3.m1.2.2.2.3.3.cmml">j</mi></msub><mo lspace="0em" rspace="0em" id="S4.E3.m1.2.2.2.2" xref="S4.E3.m1.2.2.2.2.cmml">​</mo><mrow id="S4.E3.m1.2.2.2.1.1" xref="S4.E3.m1.2.2.2.1.1.1.cmml"><mo stretchy="false" id="S4.E3.m1.2.2.2.1.1.2" xref="S4.E3.m1.2.2.2.1.1.1.cmml">(</mo><msubsup id="S4.E3.m1.2.2.2.1.1.1" xref="S4.E3.m1.2.2.2.1.1.1.cmml"><mi id="S4.E3.m1.2.2.2.1.1.1.2.2" xref="S4.E3.m1.2.2.2.1.1.1.2.2.cmml">n</mi><mi id="S4.E3.m1.2.2.2.1.1.1.2.3" xref="S4.E3.m1.2.2.2.1.1.1.2.3.cmml">i</mi><mi id="S4.E3.m1.2.2.2.1.1.1.3" xref="S4.E3.m1.2.2.2.1.1.1.3.cmml">j</mi></msubsup><mo stretchy="false" id="S4.E3.m1.2.2.2.1.1.3" xref="S4.E3.m1.2.2.2.1.1.1.cmml">)</mo></mrow></mrow></mfrac></mrow><annotation-xml encoding="MathML-Content" id="S4.E3.m1.2b"><apply id="S4.E3.m1.2.3.cmml" xref="S4.E3.m1.2.3"><eq id="S4.E3.m1.2.3.1.cmml" xref="S4.E3.m1.2.3.1"></eq><apply id="S4.E3.m1.2.3.2.cmml" xref="S4.E3.m1.2.3.2"><csymbol cd="ambiguous" id="S4.E3.m1.2.3.2.1.cmml" xref="S4.E3.m1.2.3.2">subscript</csymbol><ci id="S4.E3.m1.2.3.2.2.cmml" xref="S4.E3.m1.2.3.2.2">𝛾</ci><ci id="S4.E3.m1.2.3.2.3.cmml" xref="S4.E3.m1.2.3.2.3">𝑖</ci></apply><apply id="S4.E3.m1.2.2.cmml" xref="S4.E3.m1.2.2"><divide id="S4.E3.m1.2.2.3.cmml" xref="S4.E3.m1.2.2"></divide><apply id="S4.E3.m1.1.1.1.cmml" xref="S4.E3.m1.1.1.1"><times id="S4.E3.m1.1.1.1.2.cmml" xref="S4.E3.m1.1.1.1.2"></times><apply id="S4.E3.m1.1.1.1.3.cmml" xref="S4.E3.m1.1.1.1.3"><csymbol cd="ambiguous" id="S4.E3.m1.1.1.1.3.1.cmml" xref="S4.E3.m1.1.1.1.3">subscript</csymbol><ci id="S4.E3.m1.1.1.1.3.2.cmml" xref="S4.E3.m1.1.1.1.3.2">𝚖𝚊𝚡</ci><ci id="S4.E3.m1.1.1.1.3.3.cmml" xref="S4.E3.m1.1.1.1.3.3">𝑗</ci></apply><apply id="S4.E3.m1.1.1.1.1.1.1.cmml" xref="S4.E3.m1.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.E3.m1.1.1.1.1.1.1.1.cmml" xref="S4.E3.m1.1.1.1.1.1">superscript</csymbol><apply id="S4.E3.m1.1.1.1.1.1.1.2.cmml" xref="S4.E3.m1.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.E3.m1.1.1.1.1.1.1.2.1.cmml" xref="S4.E3.m1.1.1.1.1.1">subscript</csymbol><ci id="S4.E3.m1.1.1.1.1.1.1.2.2.cmml" xref="S4.E3.m1.1.1.1.1.1.1.2.2">𝑛</ci><ci id="S4.E3.m1.1.1.1.1.1.1.2.3.cmml" xref="S4.E3.m1.1.1.1.1.1.1.2.3">𝑖</ci></apply><ci id="S4.E3.m1.1.1.1.1.1.1.3.cmml" xref="S4.E3.m1.1.1.1.1.1.1.3">𝑗</ci></apply></apply><apply id="S4.E3.m1.2.2.2.cmml" xref="S4.E3.m1.2.2.2"><times id="S4.E3.m1.2.2.2.2.cmml" xref="S4.E3.m1.2.2.2.2"></times><apply id="S4.E3.m1.2.2.2.3.cmml" xref="S4.E3.m1.2.2.2.3"><csymbol cd="ambiguous" id="S4.E3.m1.2.2.2.3.1.cmml" xref="S4.E3.m1.2.2.2.3">subscript</csymbol><ci id="S4.E3.m1.2.2.2.3.2.cmml" xref="S4.E3.m1.2.2.2.3.2">𝚖𝚒𝚗</ci><ci id="S4.E3.m1.2.2.2.3.3.cmml" xref="S4.E3.m1.2.2.2.3.3">𝑗</ci></apply><apply id="S4.E3.m1.2.2.2.1.1.1.cmml" xref="S4.E3.m1.2.2.2.1.1"><csymbol cd="ambiguous" id="S4.E3.m1.2.2.2.1.1.1.1.cmml" xref="S4.E3.m1.2.2.2.1.1">superscript</csymbol><apply id="S4.E3.m1.2.2.2.1.1.1.2.cmml" xref="S4.E3.m1.2.2.2.1.1"><csymbol cd="ambiguous" id="S4.E3.m1.2.2.2.1.1.1.2.1.cmml" xref="S4.E3.m1.2.2.2.1.1">subscript</csymbol><ci id="S4.E3.m1.2.2.2.1.1.1.2.2.cmml" xref="S4.E3.m1.2.2.2.1.1.1.2.2">𝑛</ci><ci id="S4.E3.m1.2.2.2.1.1.1.2.3.cmml" xref="S4.E3.m1.2.2.2.1.1.1.2.3">𝑖</ci></apply><ci id="S4.E3.m1.2.2.2.1.1.1.3.cmml" xref="S4.E3.m1.2.2.2.1.1.1.3">𝑗</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.E3.m1.2c">\gamma_{i}=\frac{{\tt max}_{j}({n_{i}^{j}})}{{\tt min}_{j}({n_{i}^{j}})}</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(3)</span></td>
</tr></tbody>
</table>
<p id="S4.p4.13" class="ltx_p">where <math id="S4.p4.2.m1.1" class="ltx_Math" alttext="n_{i}^{j}" display="inline"><semantics id="S4.p4.2.m1.1a"><msubsup id="S4.p4.2.m1.1.1" xref="S4.p4.2.m1.1.1.cmml"><mi id="S4.p4.2.m1.1.1.2.2" xref="S4.p4.2.m1.1.1.2.2.cmml">n</mi><mi id="S4.p4.2.m1.1.1.2.3" xref="S4.p4.2.m1.1.1.2.3.cmml">i</mi><mi id="S4.p4.2.m1.1.1.3" xref="S4.p4.2.m1.1.1.3.cmml">j</mi></msubsup><annotation-xml encoding="MathML-Content" id="S4.p4.2.m1.1b"><apply id="S4.p4.2.m1.1.1.cmml" xref="S4.p4.2.m1.1.1"><csymbol cd="ambiguous" id="S4.p4.2.m1.1.1.1.cmml" xref="S4.p4.2.m1.1.1">superscript</csymbol><apply id="S4.p4.2.m1.1.1.2.cmml" xref="S4.p4.2.m1.1.1"><csymbol cd="ambiguous" id="S4.p4.2.m1.1.1.2.1.cmml" xref="S4.p4.2.m1.1.1">subscript</csymbol><ci id="S4.p4.2.m1.1.1.2.2.cmml" xref="S4.p4.2.m1.1.1.2.2">𝑛</ci><ci id="S4.p4.2.m1.1.1.2.3.cmml" xref="S4.p4.2.m1.1.1.2.3">𝑖</ci></apply><ci id="S4.p4.2.m1.1.1.3.cmml" xref="S4.p4.2.m1.1.1.3">𝑗</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.p4.2.m1.1c">n_{i}^{j}</annotation></semantics></math> is the number of samples of class <math id="S4.p4.3.m2.1" class="ltx_Math" alttext="j" display="inline"><semantics id="S4.p4.3.m2.1a"><mi id="S4.p4.3.m2.1.1" xref="S4.p4.3.m2.1.1.cmml">j</mi><annotation-xml encoding="MathML-Content" id="S4.p4.3.m2.1b"><ci id="S4.p4.3.m2.1.1.cmml" xref="S4.p4.3.m2.1.1">𝑗</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.p4.3.m2.1c">j</annotation></semantics></math> at client site <math id="S4.p4.4.m3.1" class="ltx_Math" alttext="i" display="inline"><semantics id="S4.p4.4.m3.1a"><mi id="S4.p4.4.m3.1.1" xref="S4.p4.4.m3.1.1.cmml">i</mi><annotation-xml encoding="MathML-Content" id="S4.p4.4.m3.1b"><ci id="S4.p4.4.m3.1.1.cmml" xref="S4.p4.4.m3.1.1">𝑖</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.p4.4.m3.1c">i</annotation></semantics></math> (as defined in Eq. <a href="#S3.E2" title="In III Federated Learning with Imbalanced Ransomware Datasets ‣ Ransomware Detection Using Federated Learning with Imbalanced Datasets" class="ltx_ref"><span class="ltx_text ltx_ref_tag">2</span></a>). Hence values closer to unity imply more even (balanced) data distribution at a client site. Based on the above, the imbalance ratios for multi-class attribution (between the ransomware classes) are <math id="S4.p4.5.m4.1" class="ltx_Math" alttext="\gamma_{1}" display="inline"><semantics id="S4.p4.5.m4.1a"><msub id="S4.p4.5.m4.1.1" xref="S4.p4.5.m4.1.1.cmml"><mi id="S4.p4.5.m4.1.1.2" xref="S4.p4.5.m4.1.1.2.cmml">γ</mi><mn id="S4.p4.5.m4.1.1.3" xref="S4.p4.5.m4.1.1.3.cmml">1</mn></msub><annotation-xml encoding="MathML-Content" id="S4.p4.5.m4.1b"><apply id="S4.p4.5.m4.1.1.cmml" xref="S4.p4.5.m4.1.1"><csymbol cd="ambiguous" id="S4.p4.5.m4.1.1.1.cmml" xref="S4.p4.5.m4.1.1">subscript</csymbol><ci id="S4.p4.5.m4.1.1.2.cmml" xref="S4.p4.5.m4.1.1.2">𝛾</ci><cn type="integer" id="S4.p4.5.m4.1.1.3.cmml" xref="S4.p4.5.m4.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.p4.5.m4.1c">\gamma_{1}</annotation></semantics></math>=3.2, <math id="S4.p4.6.m5.1" class="ltx_Math" alttext="\gamma_{2}" display="inline"><semantics id="S4.p4.6.m5.1a"><msub id="S4.p4.6.m5.1.1" xref="S4.p4.6.m5.1.1.cmml"><mi id="S4.p4.6.m5.1.1.2" xref="S4.p4.6.m5.1.1.2.cmml">γ</mi><mn id="S4.p4.6.m5.1.1.3" xref="S4.p4.6.m5.1.1.3.cmml">2</mn></msub><annotation-xml encoding="MathML-Content" id="S4.p4.6.m5.1b"><apply id="S4.p4.6.m5.1.1.cmml" xref="S4.p4.6.m5.1.1"><csymbol cd="ambiguous" id="S4.p4.6.m5.1.1.1.cmml" xref="S4.p4.6.m5.1.1">subscript</csymbol><ci id="S4.p4.6.m5.1.1.2.cmml" xref="S4.p4.6.m5.1.1.2">𝛾</ci><cn type="integer" id="S4.p4.6.m5.1.1.3.cmml" xref="S4.p4.6.m5.1.1.3">2</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.p4.6.m5.1c">\gamma_{2}</annotation></semantics></math>=3.0, and <math id="S4.p4.7.m6.1" class="ltx_Math" alttext="\gamma_{3}" display="inline"><semantics id="S4.p4.7.m6.1a"><msub id="S4.p4.7.m6.1.1" xref="S4.p4.7.m6.1.1.cmml"><mi id="S4.p4.7.m6.1.1.2" xref="S4.p4.7.m6.1.1.2.cmml">γ</mi><mn id="S4.p4.7.m6.1.1.3" xref="S4.p4.7.m6.1.1.3.cmml">3</mn></msub><annotation-xml encoding="MathML-Content" id="S4.p4.7.m6.1b"><apply id="S4.p4.7.m6.1.1.cmml" xref="S4.p4.7.m6.1.1"><csymbol cd="ambiguous" id="S4.p4.7.m6.1.1.1.cmml" xref="S4.p4.7.m6.1.1">subscript</csymbol><ci id="S4.p4.7.m6.1.1.2.cmml" xref="S4.p4.7.m6.1.1.2">𝛾</ci><cn type="integer" id="S4.p4.7.m6.1.1.3.cmml" xref="S4.p4.7.m6.1.1.3">3</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.p4.7.m6.1c">\gamma_{3}</annotation></semantics></math>=4.7, respectively, for the three client sites. If also taking into account the larger benign class (1,700 samples), the corresponding imbalance ratios are much higher, i.e., <math id="S4.p4.8.m7.1" class="ltx_Math" alttext="\gamma_{1}" display="inline"><semantics id="S4.p4.8.m7.1a"><msub id="S4.p4.8.m7.1.1" xref="S4.p4.8.m7.1.1.cmml"><mi id="S4.p4.8.m7.1.1.2" xref="S4.p4.8.m7.1.1.2.cmml">γ</mi><mn id="S4.p4.8.m7.1.1.3" xref="S4.p4.8.m7.1.1.3.cmml">1</mn></msub><annotation-xml encoding="MathML-Content" id="S4.p4.8.m7.1b"><apply id="S4.p4.8.m7.1.1.cmml" xref="S4.p4.8.m7.1.1"><csymbol cd="ambiguous" id="S4.p4.8.m7.1.1.1.cmml" xref="S4.p4.8.m7.1.1">subscript</csymbol><ci id="S4.p4.8.m7.1.1.2.cmml" xref="S4.p4.8.m7.1.1.2">𝛾</ci><cn type="integer" id="S4.p4.8.m7.1.1.3.cmml" xref="S4.p4.8.m7.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.p4.8.m7.1c">\gamma_{1}</annotation></semantics></math>=65, <math id="S4.p4.9.m8.1" class="ltx_Math" alttext="\gamma_{2}" display="inline"><semantics id="S4.p4.9.m8.1a"><msub id="S4.p4.9.m8.1.1" xref="S4.p4.9.m8.1.1.cmml"><mi id="S4.p4.9.m8.1.1.2" xref="S4.p4.9.m8.1.1.2.cmml">γ</mi><mn id="S4.p4.9.m8.1.1.3" xref="S4.p4.9.m8.1.1.3.cmml">2</mn></msub><annotation-xml encoding="MathML-Content" id="S4.p4.9.m8.1b"><apply id="S4.p4.9.m8.1.1.cmml" xref="S4.p4.9.m8.1.1"><csymbol cd="ambiguous" id="S4.p4.9.m8.1.1.1.cmml" xref="S4.p4.9.m8.1.1">subscript</csymbol><ci id="S4.p4.9.m8.1.1.2.cmml" xref="S4.p4.9.m8.1.1.2">𝛾</ci><cn type="integer" id="S4.p4.9.m8.1.1.3.cmml" xref="S4.p4.9.m8.1.1.3">2</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.p4.9.m8.1c">\gamma_{2}</annotation></semantics></math>=85, and <math id="S4.p4.10.m9.1" class="ltx_Math" alttext="\gamma_{3}" display="inline"><semantics id="S4.p4.10.m9.1a"><msub id="S4.p4.10.m9.1.1" xref="S4.p4.10.m9.1.1.cmml"><mi id="S4.p4.10.m9.1.1.2" xref="S4.p4.10.m9.1.1.2.cmml">γ</mi><mn id="S4.p4.10.m9.1.1.3" xref="S4.p4.10.m9.1.1.3.cmml">3</mn></msub><annotation-xml encoding="MathML-Content" id="S4.p4.10.m9.1b"><apply id="S4.p4.10.m9.1.1.cmml" xref="S4.p4.10.m9.1.1"><csymbol cd="ambiguous" id="S4.p4.10.m9.1.1.1.cmml" xref="S4.p4.10.m9.1.1">subscript</csymbol><ci id="S4.p4.10.m9.1.1.2.cmml" xref="S4.p4.10.m9.1.1.2">𝛾</ci><cn type="integer" id="S4.p4.10.m9.1.1.3.cmml" xref="S4.p4.10.m9.1.1.3">3</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.p4.10.m9.1c">\gamma_{3}</annotation></semantics></math>=113.33. Meanwhile, for the simpler binary detection problem, the imbalance ratios between the two classes are <math id="S4.p4.11.m10.1" class="ltx_Math" alttext="\gamma_{1}" display="inline"><semantics id="S4.p4.11.m10.1a"><msub id="S4.p4.11.m10.1.1" xref="S4.p4.11.m10.1.1.cmml"><mi id="S4.p4.11.m10.1.1.2" xref="S4.p4.11.m10.1.1.2.cmml">γ</mi><mn id="S4.p4.11.m10.1.1.3" xref="S4.p4.11.m10.1.1.3.cmml">1</mn></msub><annotation-xml encoding="MathML-Content" id="S4.p4.11.m10.1b"><apply id="S4.p4.11.m10.1.1.cmml" xref="S4.p4.11.m10.1.1"><csymbol cd="ambiguous" id="S4.p4.11.m10.1.1.1.cmml" xref="S4.p4.11.m10.1.1">subscript</csymbol><ci id="S4.p4.11.m10.1.1.2.cmml" xref="S4.p4.11.m10.1.1.2">𝛾</ci><cn type="integer" id="S4.p4.11.m10.1.1.3.cmml" xref="S4.p4.11.m10.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.p4.11.m10.1c">\gamma_{1}</annotation></semantics></math>=3.14, <math id="S4.p4.12.m11.1" class="ltx_Math" alttext="\gamma_{2}" display="inline"><semantics id="S4.p4.12.m11.1a"><msub id="S4.p4.12.m11.1.1" xref="S4.p4.12.m11.1.1.cmml"><mi id="S4.p4.12.m11.1.1.2" xref="S4.p4.12.m11.1.1.2.cmml">γ</mi><mn id="S4.p4.12.m11.1.1.3" xref="S4.p4.12.m11.1.1.3.cmml">2</mn></msub><annotation-xml encoding="MathML-Content" id="S4.p4.12.m11.1b"><apply id="S4.p4.12.m11.1.1.cmml" xref="S4.p4.12.m11.1.1"><csymbol cd="ambiguous" id="S4.p4.12.m11.1.1.1.cmml" xref="S4.p4.12.m11.1.1">subscript</csymbol><ci id="S4.p4.12.m11.1.1.2.cmml" xref="S4.p4.12.m11.1.1.2">𝛾</ci><cn type="integer" id="S4.p4.12.m11.1.1.3.cmml" xref="S4.p4.12.m11.1.1.3">2</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.p4.12.m11.1c">\gamma_{2}</annotation></semantics></math>=6.29, and <math id="S4.p4.13.m12.1" class="ltx_Math" alttext="\gamma_{3}" display="inline"><semantics id="S4.p4.13.m12.1a"><msub id="S4.p4.13.m12.1.1" xref="S4.p4.13.m12.1.1.cmml"><mi id="S4.p4.13.m12.1.1.2" xref="S4.p4.13.m12.1.1.2.cmml">γ</mi><mn id="S4.p4.13.m12.1.1.3" xref="S4.p4.13.m12.1.1.3.cmml">3</mn></msub><annotation-xml encoding="MathML-Content" id="S4.p4.13.m12.1b"><apply id="S4.p4.13.m12.1.1.cmml" xref="S4.p4.13.m12.1.1"><csymbol cd="ambiguous" id="S4.p4.13.m12.1.1.1.cmml" xref="S4.p4.13.m12.1.1">subscript</csymbol><ci id="S4.p4.13.m12.1.1.2.cmml" xref="S4.p4.13.m12.1.1.2">𝛾</ci><cn type="integer" id="S4.p4.13.m12.1.1.3.cmml" xref="S4.p4.13.m12.1.1.3">3</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.p4.13.m12.1c">\gamma_{3}</annotation></semantics></math>=6.29. Note that <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib14" title="" class="ltx_ref">14</a>]</cite> also defines a global imbalance ratio, i.e., give by the total number of samples of the largest majority class divided by the total number of samples of the smallest minority class. However, since there are 120 testing samples for each ransomware family here, there are no majority or minority classes at the global level here, i.e., imbalance only occurs between the client sites.</p>
</div>
<div id="S4.p5" class="ltx_para">
<p id="S4.p5.1" class="ltx_p">The proposed FL approach is now analyzed using FNN classifiers (using weighted cross entropy loss). All evaluation is done using the <span id="S4.p5.1.1" class="ltx_text ltx_font_typewriter">Keras</span> and <span id="S4.p5.1.2" class="ltx_text ltx_font_typewriter">TensorFlow</span> toolkits, as well as <span id="S4.p5.1.3" class="ltx_text ltx_font_typewriter">Pandas</span> and <span id="S4.p5.1.4" class="ltx_text ltx_font_typewriter">Sklearn</span>. Furthermore, results for each test scenario are averaged over 100 randomized trials. Results for the binary ransomware detection problem are presented first. Here, all ransomware training samples are combined to generate a single malware class for training purposes, i.e., 540 samples at client site 1 and 270 samples each at client sites 2 and 3 (Figure <a href="#S3.F4" title="Figure 4 ‣ III Federated Learning with Imbalanced Ransomware Datasets ‣ Ransomware Detection Using Federated Learning with Imbalanced Datasets" class="ltx_ref"><span class="ltx_text ltx_ref_tag">4</span></a>). The average values for accuracy, precision, recall, and F1 score are summarized in Table <a href="#S4.T2" title="TABLE II ‣ IV Performance Evaluation ‣ Ransomware Detection Using Federated Learning with Imbalanced Datasets" class="ltx_ref"><span class="ltx_text ltx_ref_tag">II</span></a>. In particular, results are presented for three scenarios, i.e., baseline FL scheme with balanced dataset (and regular cross entropy loss function), baseline FL scheme with imbalanced dataset (and regular cross entropy loss function), and proposed FL scheme with imbalanced dataset (and weighted cross entropy loss function). These findings indicate that the relative improvement between the global and local client models (due to global FL model averaging) is much smaller with the imbalanced dataset, i.e., under 2.5% for most metrics. There is also a small, but consistent, performance degradation as compared to the balanced dataset results, albeit mostly under 2%. However, the weighted cross entropy loss scheme does better than the regular weighting scheme, yielding an average accuracy within 0.5% of that with the balanced dataset (and most metrics approaching 95% range).</p>
</div>
<div id="S4.p6" class="ltx_para">
<p id="S4.p6.1" class="ltx_p">Results for the multi-class attribution problem are also presented in Table <a href="#S4.T3" title="TABLE III ‣ IV Performance Evaluation ‣ Ransomware Detection Using Federated Learning with Imbalanced Datasets" class="ltx_ref"><span class="ltx_text ltx_ref_tag">III</span></a> (<math id="S4.p6.1.m1.1" class="ltx_Math" alttext="K" display="inline"><semantics id="S4.p6.1.m1.1a"><mi id="S4.p6.1.m1.1.1" xref="S4.p6.1.m1.1.1.cmml">K</mi><annotation-xml encoding="MathML-Content" id="S4.p6.1.m1.1b"><ci id="S4.p6.1.m1.1.1.cmml" xref="S4.p6.1.m1.1.1">𝐾</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.p6.1.m1.1c">K</annotation></semantics></math>=3). Again, all three scenarios are evaluated here, i.e., baseline FL scheme using balanced dataset, baseline FL scheme using imbalanced dataset, and proposed FL scheme using imbalanced dataset. Overall, these findings show good performance improvement with global model averaging (in the FL schemes) for the imbalanced dataset, albeit the relative differences between the global and local models are smaller with the weighted cross entropy loss function approach (about 2-3% for most metrics). However, unlike the binary detection results in Table <a href="#S4.T2" title="TABLE II ‣ IV Performance Evaluation ‣ Ransomware Detection Using Federated Learning with Imbalanced Datasets" class="ltx_ref"><span class="ltx_text ltx_ref_tag">II</span></a>, there are more significant performance declines versus the results with the balanced dataset. In particular, since there much fewer samples of some minority classes at certain client sites, attribution is much more difficult (versus simple binary detection with larger aggregated classes). For example, average accuracy and F1 scores are 8-10% lower than the perfectly balanced scenarios, whereas the average precision and recall rates are 2-6% lower. Again, the weighted cross entropy scheme gives slightly better accuracy than the regular scheme, i.e., about 2% higher. Although one can argue that the imbalance ratios for the uneven distribution case are very high to begin with, these findings indicate a further need to develop new schemes for imbalanced scenarios.</p>
</div>
<figure id="S4.T2" class="ltx_table">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table">TABLE II: </span>Binary detection (<math id="S4.T2.2.m1.1" class="ltx_Math" alttext="K" display="inline"><semantics id="S4.T2.2.m1.1b"><mi id="S4.T2.2.m1.1.1" xref="S4.T2.2.m1.1.1.cmml">K</mi><annotation-xml encoding="MathML-Content" id="S4.T2.2.m1.1c"><ci id="S4.T2.2.m1.1.1.cmml" xref="S4.T2.2.m1.1.1">𝐾</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.T2.2.m1.1d">K</annotation></semantics></math>=3 client sites)</figcaption>
<table id="S4.T2.3" class="ltx_tabular ltx_centering ltx_align_middle">
<tbody class="ltx_tbody">
<tr id="S4.T2.3.1.1" class="ltx_tr">
<td id="S4.T2.3.1.1.1" class="ltx_td ltx_align_center ltx_border_l ltx_border_r ltx_border_t" colspan="5">
<span id="S4.T2.3.1.1.1.1" class="ltx_text ltx_font_bold" style="font-size:90%;">Baseline </span><span id="S4.T2.3.1.1.1.2" class="ltx_text ltx_font_typewriter" style="font-size:90%;">FedAvg</span><span id="S4.T2.3.1.1.1.3" class="ltx_text ltx_font_bold" style="font-size:90%;"> (balanced dataset)</span>
</td>
</tr>
<tr id="S4.T2.3.2.2" class="ltx_tr">
<td id="S4.T2.3.2.2.1" class="ltx_td ltx_border_l ltx_border_r ltx_border_t"></td>
<td id="S4.T2.3.2.2.2" class="ltx_td ltx_align_center ltx_border_r ltx_border_t"><span id="S4.T2.3.2.2.2.1" class="ltx_text ltx_font_bold" style="font-size:90%;">Acc.</span></td>
<td id="S4.T2.3.2.2.3" class="ltx_td ltx_align_center ltx_border_r ltx_border_t"><span id="S4.T2.3.2.2.3.1" class="ltx_text ltx_font_bold" style="font-size:90%;">Prec.</span></td>
<td id="S4.T2.3.2.2.4" class="ltx_td ltx_align_center ltx_border_r ltx_border_t"><span id="S4.T2.3.2.2.4.1" class="ltx_text ltx_font_bold" style="font-size:90%;">Recall</span></td>
<td id="S4.T2.3.2.2.5" class="ltx_td ltx_align_center ltx_border_r ltx_border_t"><span id="S4.T2.3.2.2.5.1" class="ltx_text ltx_font_bold" style="font-size:90%;">F1</span></td>
</tr>
<tr id="S4.T2.3.3.3" class="ltx_tr">
<td id="S4.T2.3.3.3.1" class="ltx_td ltx_align_center ltx_border_l ltx_border_r ltx_border_t"><span id="S4.T2.3.3.3.1.1" class="ltx_text ltx_font_bold" style="font-size:90%;">Global</span></td>
<td id="S4.T2.3.3.3.2" class="ltx_td ltx_align_center ltx_border_r ltx_border_t"><span id="S4.T2.3.3.3.2.1" class="ltx_text ltx_font_bold" style="font-size:90%;">95.08%</span></td>
<td id="S4.T2.3.3.3.3" class="ltx_td ltx_align_center ltx_border_r ltx_border_t"><span id="S4.T2.3.3.3.3.1" class="ltx_text ltx_font_bold" style="font-size:90%;">95.10%</span></td>
<td id="S4.T2.3.3.3.4" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">
<span id="S4.T2.3.3.3.4.1" class="ltx_text ltx_font_bold" style="font-size:90%;">94.43</span><span id="S4.T2.3.3.3.4.2" class="ltx_text" style="font-size:90%;">%</span>
</td>
<td id="S4.T2.3.3.3.5" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">
<span id="S4.T2.3.3.3.5.1" class="ltx_text ltx_font_bold" style="font-size:90%;">95.25</span><span id="S4.T2.3.3.3.5.2" class="ltx_text" style="font-size:90%;">%</span>
</td>
</tr>
<tr id="S4.T2.3.4.4" class="ltx_tr">
<td id="S4.T2.3.4.4.1" class="ltx_td ltx_align_center ltx_border_l ltx_border_r ltx_border_t"><span id="S4.T2.3.4.4.1.1" class="ltx_text" style="font-size:90%;">Client 1</span></td>
<td id="S4.T2.3.4.4.2" class="ltx_td ltx_align_center ltx_border_r ltx_border_t"><span id="S4.T2.3.4.4.2.1" class="ltx_text" style="font-size:90%;">89.18%</span></td>
<td id="S4.T2.3.4.4.3" class="ltx_td ltx_align_center ltx_border_r ltx_border_t"><span id="S4.T2.3.4.4.3.1" class="ltx_text" style="font-size:90%;">89.18%</span></td>
<td id="S4.T2.3.4.4.4" class="ltx_td ltx_align_center ltx_border_r ltx_border_t"><span id="S4.T2.3.4.4.4.1" class="ltx_text" style="font-size:90%;">89.25%</span></td>
<td id="S4.T2.3.4.4.5" class="ltx_td ltx_align_center ltx_border_r ltx_border_t"><span id="S4.T2.3.4.4.5.1" class="ltx_text" style="font-size:90%;">88.36%</span></td>
</tr>
<tr id="S4.T2.3.5.5" class="ltx_tr">
<td id="S4.T2.3.5.5.1" class="ltx_td ltx_align_center ltx_border_l ltx_border_r ltx_border_t"><span id="S4.T2.3.5.5.1.1" class="ltx_text" style="font-size:90%;">Client 2</span></td>
<td id="S4.T2.3.5.5.2" class="ltx_td ltx_align_center ltx_border_r ltx_border_t"><span id="S4.T2.3.5.5.2.1" class="ltx_text" style="font-size:90%;">90.03%</span></td>
<td id="S4.T2.3.5.5.3" class="ltx_td ltx_align_center ltx_border_r ltx_border_t"><span id="S4.T2.3.5.5.3.1" class="ltx_text" style="font-size:90%;">89.32%</span></td>
<td id="S4.T2.3.5.5.4" class="ltx_td ltx_align_center ltx_border_r ltx_border_t"><span id="S4.T2.3.5.5.4.1" class="ltx_text" style="font-size:90%;">90.17%</span></td>
<td id="S4.T2.3.5.5.5" class="ltx_td ltx_align_center ltx_border_r ltx_border_t"><span id="S4.T2.3.5.5.5.1" class="ltx_text" style="font-size:90%;">89.28%</span></td>
</tr>
<tr id="S4.T2.3.6.6" class="ltx_tr">
<td id="S4.T2.3.6.6.1" class="ltx_td ltx_align_center ltx_border_l ltx_border_r ltx_border_t"><span id="S4.T2.3.6.6.1.1" class="ltx_text" style="font-size:90%;">Client 3</span></td>
<td id="S4.T2.3.6.6.2" class="ltx_td ltx_align_center ltx_border_r ltx_border_t"><span id="S4.T2.3.6.6.2.1" class="ltx_text" style="font-size:90%;">90.23%</span></td>
<td id="S4.T2.3.6.6.3" class="ltx_td ltx_align_center ltx_border_r ltx_border_t"><span id="S4.T2.3.6.6.3.1" class="ltx_text" style="font-size:90%;">89.44%</span></td>
<td id="S4.T2.3.6.6.4" class="ltx_td ltx_align_center ltx_border_r ltx_border_t"><span id="S4.T2.3.6.6.4.1" class="ltx_text" style="font-size:90%;">90.23%</span></td>
<td id="S4.T2.3.6.6.5" class="ltx_td ltx_align_center ltx_border_r ltx_border_t"><span id="S4.T2.3.6.6.5.1" class="ltx_text" style="font-size:90%;">89.40%</span></td>
</tr>
<tr id="S4.T2.3.7.7" class="ltx_tr">
<td id="S4.T2.3.7.7.1" class="ltx_td ltx_align_center ltx_border_l ltx_border_r ltx_border_tt" colspan="5">
<span id="S4.T2.3.7.7.1.1" class="ltx_text ltx_font_bold" style="font-size:90%;">Baseline </span><span id="S4.T2.3.7.7.1.2" class="ltx_text ltx_font_typewriter" style="font-size:90%;">FedAvg</span><span id="S4.T2.3.7.7.1.3" class="ltx_text ltx_font_bold" style="font-size:90%;"> (imbalanced dataset)</span>
</td>
</tr>
<tr id="S4.T2.3.8.8" class="ltx_tr">
<td id="S4.T2.3.8.8.1" class="ltx_td ltx_border_l ltx_border_r ltx_border_t"></td>
<td id="S4.T2.3.8.8.2" class="ltx_td ltx_align_center ltx_border_r ltx_border_t"><span id="S4.T2.3.8.8.2.1" class="ltx_text ltx_font_bold" style="font-size:90%;">Acc.</span></td>
<td id="S4.T2.3.8.8.3" class="ltx_td ltx_align_center ltx_border_r ltx_border_t"><span id="S4.T2.3.8.8.3.1" class="ltx_text ltx_font_bold" style="font-size:90%;">Prec.</span></td>
<td id="S4.T2.3.8.8.4" class="ltx_td ltx_align_center ltx_border_r ltx_border_t"><span id="S4.T2.3.8.8.4.1" class="ltx_text ltx_font_bold" style="font-size:90%;">Recall</span></td>
<td id="S4.T2.3.8.8.5" class="ltx_td ltx_align_center ltx_border_r ltx_border_t"><span id="S4.T2.3.8.8.5.1" class="ltx_text ltx_font_bold" style="font-size:90%;">F1</span></td>
</tr>
<tr id="S4.T2.3.9.9" class="ltx_tr">
<td id="S4.T2.3.9.9.1" class="ltx_td ltx_align_center ltx_border_l ltx_border_r ltx_border_t"><span id="S4.T2.3.9.9.1.1" class="ltx_text ltx_font_bold" style="font-size:90%;">Global</span></td>
<td id="S4.T2.3.9.9.2" class="ltx_td ltx_align_center ltx_border_r ltx_border_t"><span id="S4.T2.3.9.9.2.1" class="ltx_text ltx_font_bold" style="font-size:90%;">93.86%</span></td>
<td id="S4.T2.3.9.9.3" class="ltx_td ltx_align_center ltx_border_r ltx_border_t"><span id="S4.T2.3.9.9.3.1" class="ltx_text ltx_font_bold" style="font-size:90%;">93.94%</span></td>
<td id="S4.T2.3.9.9.4" class="ltx_td ltx_align_center ltx_border_r ltx_border_t"><span id="S4.T2.3.9.9.4.1" class="ltx_text ltx_font_bold" style="font-size:90%;">93.86%</span></td>
<td id="S4.T2.3.9.9.5" class="ltx_td ltx_align_center ltx_border_r ltx_border_t"><span id="S4.T2.3.9.9.5.1" class="ltx_text ltx_font_bold" style="font-size:90%;">93.86%</span></td>
</tr>
<tr id="S4.T2.3.10.10" class="ltx_tr">
<td id="S4.T2.3.10.10.1" class="ltx_td ltx_align_center ltx_border_l ltx_border_r ltx_border_t"><span id="S4.T2.3.10.10.1.1" class="ltx_text" style="font-size:90%;">Client 1</span></td>
<td id="S4.T2.3.10.10.2" class="ltx_td ltx_align_center ltx_border_r ltx_border_t"><span id="S4.T2.3.10.10.2.1" class="ltx_text" style="font-size:90%;">92.95%</span></td>
<td id="S4.T2.3.10.10.3" class="ltx_td ltx_align_center ltx_border_r ltx_border_t"><span id="S4.T2.3.10.10.3.1" class="ltx_text" style="font-size:90%;">92.90%</span></td>
<td id="S4.T2.3.10.10.4" class="ltx_td ltx_align_center ltx_border_r ltx_border_t"><span id="S4.T2.3.10.10.4.1" class="ltx_text" style="font-size:90%;">92.94%</span></td>
<td id="S4.T2.3.10.10.5" class="ltx_td ltx_align_center ltx_border_r ltx_border_t"><span id="S4.T2.3.10.10.5.1" class="ltx_text" style="font-size:90%;">92.93%</span></td>
</tr>
<tr id="S4.T2.3.11.11" class="ltx_tr">
<td id="S4.T2.3.11.11.1" class="ltx_td ltx_align_center ltx_border_l ltx_border_r ltx_border_t"><span id="S4.T2.3.11.11.1.1" class="ltx_text" style="font-size:90%;">Client 2</span></td>
<td id="S4.T2.3.11.11.2" class="ltx_td ltx_align_center ltx_border_r ltx_border_t"><span id="S4.T2.3.11.11.2.1" class="ltx_text" style="font-size:90%;">92.58%</span></td>
<td id="S4.T2.3.11.11.3" class="ltx_td ltx_align_center ltx_border_r ltx_border_t"><span id="S4.T2.3.11.11.3.1" class="ltx_text" style="font-size:90%;">92.71%</span></td>
<td id="S4.T2.3.11.11.4" class="ltx_td ltx_align_center ltx_border_r ltx_border_t"><span id="S4.T2.3.11.11.4.1" class="ltx_text" style="font-size:90%;">92.58%</span></td>
<td id="S4.T2.3.11.11.5" class="ltx_td ltx_align_center ltx_border_r ltx_border_t"><span id="S4.T2.3.11.11.5.1" class="ltx_text" style="font-size:90%;">92.57%</span></td>
</tr>
<tr id="S4.T2.3.12.12" class="ltx_tr">
<td id="S4.T2.3.12.12.1" class="ltx_td ltx_align_center ltx_border_l ltx_border_r ltx_border_t"><span id="S4.T2.3.12.12.1.1" class="ltx_text" style="font-size:90%;">Client 1</span></td>
<td id="S4.T2.3.12.12.2" class="ltx_td ltx_align_center ltx_border_r ltx_border_t"><span id="S4.T2.3.12.12.2.1" class="ltx_text" style="font-size:90%;">92.72%</span></td>
<td id="S4.T2.3.12.12.3" class="ltx_td ltx_align_center ltx_border_r ltx_border_t"><span id="S4.T2.3.12.12.3.1" class="ltx_text" style="font-size:90%;">92.58%</span></td>
<td id="S4.T2.3.12.12.4" class="ltx_td ltx_align_center ltx_border_r ltx_border_t"><span id="S4.T2.3.12.12.4.1" class="ltx_text" style="font-size:90%;">92.71%</span></td>
<td id="S4.T2.3.12.12.5" class="ltx_td ltx_align_center ltx_border_r ltx_border_t"><span id="S4.T2.3.12.12.5.1" class="ltx_text" style="font-size:90%;">92.67%</span></td>
</tr>
<tr id="S4.T2.3.13.13" class="ltx_tr">
<td id="S4.T2.3.13.13.1" class="ltx_td ltx_align_center ltx_border_l ltx_border_r ltx_border_tt" colspan="5"><span id="S4.T2.3.13.13.1.1" class="ltx_text ltx_font_bold" style="font-size:90%;">Weighted cross entropy loss (imbalanced dataset)</span></td>
</tr>
<tr id="S4.T2.3.14.14" class="ltx_tr">
<td id="S4.T2.3.14.14.1" class="ltx_td ltx_border_l ltx_border_r ltx_border_t"></td>
<td id="S4.T2.3.14.14.2" class="ltx_td ltx_align_center ltx_border_r ltx_border_t"><span id="S4.T2.3.14.14.2.1" class="ltx_text ltx_font_bold" style="font-size:90%;">Acc.</span></td>
<td id="S4.T2.3.14.14.3" class="ltx_td ltx_align_center ltx_border_r ltx_border_t"><span id="S4.T2.3.14.14.3.1" class="ltx_text ltx_font_bold" style="font-size:90%;">Prec.</span></td>
<td id="S4.T2.3.14.14.4" class="ltx_td ltx_align_center ltx_border_r ltx_border_t"><span id="S4.T2.3.14.14.4.1" class="ltx_text ltx_font_bold" style="font-size:90%;">Recall</span></td>
<td id="S4.T2.3.14.14.5" class="ltx_td ltx_align_center ltx_border_r ltx_border_t"><span id="S4.T2.3.14.14.5.1" class="ltx_text ltx_font_bold" style="font-size:90%;">F1</span></td>
</tr>
<tr id="S4.T2.3.15.15" class="ltx_tr">
<td id="S4.T2.3.15.15.1" class="ltx_td ltx_align_center ltx_border_l ltx_border_r ltx_border_t">
<span id="S4.T2.3.15.15.1.1" class="ltx_text" style="font-size:90%;"></span><span id="S4.T2.3.15.15.1.2" class="ltx_text ltx_font_bold" style="font-size:90%;">Global</span>
</td>
<td id="S4.T2.3.15.15.2" class="ltx_td ltx_align_center ltx_border_r ltx_border_t"><span id="S4.T2.3.15.15.2.1" class="ltx_text ltx_font_bold" style="font-size:90%;">94.67%</span></td>
<td id="S4.T2.3.15.15.3" class="ltx_td ltx_align_center ltx_border_r ltx_border_t"><span id="S4.T2.3.15.15.3.1" class="ltx_text ltx_font_bold" style="font-size:90%;">94.70%</span></td>
<td id="S4.T2.3.15.15.4" class="ltx_td ltx_align_center ltx_border_r ltx_border_t"><span id="S4.T2.3.15.15.4.1" class="ltx_text ltx_font_bold" style="font-size:90%;">94.62%</span></td>
<td id="S4.T2.3.15.15.5" class="ltx_td ltx_align_center ltx_border_r ltx_border_t"><span id="S4.T2.3.15.15.5.1" class="ltx_text ltx_font_bold" style="font-size:90%;">94.66%</span></td>
</tr>
<tr id="S4.T2.3.16.16" class="ltx_tr">
<td id="S4.T2.3.16.16.1" class="ltx_td ltx_align_center ltx_border_l ltx_border_r ltx_border_t"><span id="S4.T2.3.16.16.1.1" class="ltx_text" style="font-size:90%;">Client 1</span></td>
<td id="S4.T2.3.16.16.2" class="ltx_td ltx_align_center ltx_border_r ltx_border_t"><span id="S4.T2.3.16.16.2.1" class="ltx_text" style="font-size:90%;">92.70%</span></td>
<td id="S4.T2.3.16.16.3" class="ltx_td ltx_align_center ltx_border_r ltx_border_t"><span id="S4.T2.3.16.16.3.1" class="ltx_text" style="font-size:90%;">92.97%</span></td>
<td id="S4.T2.3.16.16.4" class="ltx_td ltx_align_center ltx_border_r ltx_border_t"><span id="S4.T2.3.16.16.4.1" class="ltx_text" style="font-size:90%;">92.69%</span></td>
<td id="S4.T2.3.16.16.5" class="ltx_td ltx_align_center ltx_border_r ltx_border_t"><span id="S4.T2.3.16.16.5.1" class="ltx_text" style="font-size:90%;">92.68%</span></td>
</tr>
<tr id="S4.T2.3.17.17" class="ltx_tr">
<td id="S4.T2.3.17.17.1" class="ltx_td ltx_align_center ltx_border_l ltx_border_r ltx_border_t"><span id="S4.T2.3.17.17.1.1" class="ltx_text" style="font-size:90%;">Client 2</span></td>
<td id="S4.T2.3.17.17.2" class="ltx_td ltx_align_center ltx_border_r ltx_border_t"><span id="S4.T2.3.17.17.2.1" class="ltx_text" style="font-size:90%;">92.64%</span></td>
<td id="S4.T2.3.17.17.3" class="ltx_td ltx_align_center ltx_border_r ltx_border_t"><span id="S4.T2.3.17.17.3.1" class="ltx_text" style="font-size:90%;">92.90%</span></td>
<td id="S4.T2.3.17.17.4" class="ltx_td ltx_align_center ltx_border_r ltx_border_t"><span id="S4.T2.3.17.17.4.1" class="ltx_text" style="font-size:90%;">92.64%</span></td>
<td id="S4.T2.3.17.17.5" class="ltx_td ltx_align_center ltx_border_r ltx_border_t"><span id="S4.T2.3.17.17.5.1" class="ltx_text" style="font-size:90%;">92.63%</span></td>
</tr>
<tr id="S4.T2.3.18.18" class="ltx_tr">
<td id="S4.T2.3.18.18.1" class="ltx_td ltx_align_center ltx_border_bb ltx_border_l ltx_border_r ltx_border_t"><span id="S4.T2.3.18.18.1.1" class="ltx_text" style="font-size:90%;">Client 1</span></td>
<td id="S4.T2.3.18.18.2" class="ltx_td ltx_align_center ltx_border_bb ltx_border_r ltx_border_t"><span id="S4.T2.3.18.18.2.1" class="ltx_text" style="font-size:90%;">92.03%</span></td>
<td id="S4.T2.3.18.18.3" class="ltx_td ltx_align_center ltx_border_bb ltx_border_r ltx_border_t"><span id="S4.T2.3.18.18.3.1" class="ltx_text" style="font-size:90%;">92.36%</span></td>
<td id="S4.T2.3.18.18.4" class="ltx_td ltx_align_center ltx_border_bb ltx_border_r ltx_border_t"><span id="S4.T2.3.18.18.4.1" class="ltx_text" style="font-size:90%;">92.03%</span></td>
<td id="S4.T2.3.18.18.5" class="ltx_td ltx_align_center ltx_border_bb ltx_border_r ltx_border_t"><span id="S4.T2.3.18.18.5.1" class="ltx_text" style="font-size:90%;">92.01%</span></td>
</tr>
</tbody>
</table>
</figure>
<figure id="S4.T3" class="ltx_table">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table">TABLE III: </span>Multi-class attribution (<math id="S4.T3.2.m1.1" class="ltx_Math" alttext="K" display="inline"><semantics id="S4.T3.2.m1.1b"><mi id="S4.T3.2.m1.1.1" xref="S4.T3.2.m1.1.1.cmml">K</mi><annotation-xml encoding="MathML-Content" id="S4.T3.2.m1.1c"><ci id="S4.T3.2.m1.1.1.cmml" xref="S4.T3.2.m1.1.1">𝐾</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.T3.2.m1.1d">K</annotation></semantics></math>=3 client sites)</figcaption>
<table id="S4.T3.3" class="ltx_tabular ltx_centering ltx_align_middle">
<tbody class="ltx_tbody">
<tr id="S4.T3.3.1.1" class="ltx_tr">
<td id="S4.T3.3.1.1.1" class="ltx_td ltx_align_center ltx_border_l ltx_border_r ltx_border_t" colspan="5">
<span id="S4.T3.3.1.1.1.1" class="ltx_text ltx_font_bold" style="font-size:90%;">Baseline </span><span id="S4.T3.3.1.1.1.2" class="ltx_text ltx_font_typewriter" style="font-size:90%;">FedAvg</span><span id="S4.T3.3.1.1.1.3" class="ltx_text ltx_font_bold" style="font-size:90%;"> (balanced dataset)</span>
</td>
</tr>
<tr id="S4.T3.3.2.2" class="ltx_tr">
<td id="S4.T3.3.2.2.1" class="ltx_td ltx_border_l ltx_border_r ltx_border_t"></td>
<td id="S4.T3.3.2.2.2" class="ltx_td ltx_align_center ltx_border_r ltx_border_t"><span id="S4.T3.3.2.2.2.1" class="ltx_text ltx_font_bold" style="font-size:90%;">Acc.</span></td>
<td id="S4.T3.3.2.2.3" class="ltx_td ltx_align_center ltx_border_r ltx_border_t"><span id="S4.T3.3.2.2.3.1" class="ltx_text ltx_font_bold" style="font-size:90%;">Prec.</span></td>
<td id="S4.T3.3.2.2.4" class="ltx_td ltx_align_center ltx_border_r ltx_border_t"><span id="S4.T3.3.2.2.4.1" class="ltx_text ltx_font_bold" style="font-size:90%;">Recall</span></td>
<td id="S4.T3.3.2.2.5" class="ltx_td ltx_align_center ltx_border_r ltx_border_t"><span id="S4.T3.3.2.2.5.1" class="ltx_text ltx_font_bold" style="font-size:90%;">F1</span></td>
</tr>
<tr id="S4.T3.3.3.3" class="ltx_tr">
<td id="S4.T3.3.3.3.1" class="ltx_td ltx_align_center ltx_border_l ltx_border_r ltx_border_t">
<span id="S4.T3.3.3.3.1.1" class="ltx_text" style="font-size:90%;"></span><span id="S4.T3.3.3.3.1.2" class="ltx_text ltx_font_bold" style="font-size:90%;">Global</span>
</td>
<td id="S4.T3.3.3.3.2" class="ltx_td ltx_align_center ltx_border_r ltx_border_t"><span id="S4.T3.3.3.3.2.1" class="ltx_text ltx_font_bold" style="font-size:90%;">92.11%</span></td>
<td id="S4.T3.3.3.3.3" class="ltx_td ltx_align_center ltx_border_r ltx_border_t"><span id="S4.T3.3.3.3.3.1" class="ltx_text ltx_font_bold" style="font-size:90%;">87.40%</span></td>
<td id="S4.T3.3.3.3.4" class="ltx_td ltx_align_center ltx_border_r ltx_border_t"><span id="S4.T3.3.3.3.4.1" class="ltx_text ltx_font_bold" style="font-size:90%;">86.57%</span></td>
<td id="S4.T3.3.3.3.5" class="ltx_td ltx_align_center ltx_border_r ltx_border_t"><span id="S4.T3.3.3.3.5.1" class="ltx_text ltx_font_bold" style="font-size:90%;">91.90%</span></td>
</tr>
<tr id="S4.T3.3.4.4" class="ltx_tr">
<td id="S4.T3.3.4.4.1" class="ltx_td ltx_align_center ltx_border_l ltx_border_r ltx_border_t"><span id="S4.T3.3.4.4.1.1" class="ltx_text" style="font-size:90%;">Client 1</span></td>
<td id="S4.T3.3.4.4.2" class="ltx_td ltx_align_center ltx_border_r ltx_border_t"><span id="S4.T3.3.4.4.2.1" class="ltx_text" style="font-size:90%;">86.02%</span></td>
<td id="S4.T3.3.4.4.3" class="ltx_td ltx_align_center ltx_border_r ltx_border_t"><span id="S4.T3.3.4.4.3.1" class="ltx_text" style="font-size:90%;">77.86%</span></td>
<td id="S4.T3.3.4.4.4" class="ltx_td ltx_align_center ltx_border_r ltx_border_t"><span id="S4.T3.3.4.4.4.1" class="ltx_text" style="font-size:90%;">75.64%</span></td>
<td id="S4.T3.3.4.4.5" class="ltx_td ltx_align_center ltx_border_r ltx_border_t"><span id="S4.T3.3.4.4.5.1" class="ltx_text" style="font-size:90%;">85.33%</span></td>
</tr>
<tr id="S4.T3.3.5.5" class="ltx_tr">
<td id="S4.T3.3.5.5.1" class="ltx_td ltx_align_center ltx_border_l ltx_border_r ltx_border_t"><span id="S4.T3.3.5.5.1.1" class="ltx_text" style="font-size:90%;">Client 2</span></td>
<td id="S4.T3.3.5.5.2" class="ltx_td ltx_align_center ltx_border_r ltx_border_t"><span id="S4.T3.3.5.5.2.1" class="ltx_text" style="font-size:90%;">82.90%</span></td>
<td id="S4.T3.3.5.5.3" class="ltx_td ltx_align_center ltx_border_r ltx_border_t"><span id="S4.T3.3.5.5.3.1" class="ltx_text" style="font-size:90%;">73.89%</span></td>
<td id="S4.T3.3.5.5.4" class="ltx_td ltx_align_center ltx_border_r ltx_border_t"><span id="S4.T3.3.5.5.4.1" class="ltx_text" style="font-size:90%;">74.56%</span></td>
<td id="S4.T3.3.5.5.5" class="ltx_td ltx_align_center ltx_border_r ltx_border_t"><span id="S4.T3.3.5.5.5.1" class="ltx_text" style="font-size:90%;">82.13%</span></td>
</tr>
<tr id="S4.T3.3.6.6" class="ltx_tr">
<td id="S4.T3.3.6.6.1" class="ltx_td ltx_align_center ltx_border_l ltx_border_r ltx_border_t"><span id="S4.T3.3.6.6.1.1" class="ltx_text" style="font-size:90%;">Client 3</span></td>
<td id="S4.T3.3.6.6.2" class="ltx_td ltx_align_center ltx_border_r ltx_border_t"><span id="S4.T3.3.6.6.2.1" class="ltx_text" style="font-size:90%;">81.47%</span></td>
<td id="S4.T3.3.6.6.3" class="ltx_td ltx_align_center ltx_border_r ltx_border_t"><span id="S4.T3.3.6.6.3.1" class="ltx_text" style="font-size:90%;">73.55%</span></td>
<td id="S4.T3.3.6.6.4" class="ltx_td ltx_align_center ltx_border_r ltx_border_t"><span id="S4.T3.3.6.6.4.1" class="ltx_text" style="font-size:90%;">75.95%</span></td>
<td id="S4.T3.3.6.6.5" class="ltx_td ltx_align_center ltx_border_r ltx_border_t"><span id="S4.T3.3.6.6.5.1" class="ltx_text" style="font-size:90%;">81.49%</span></td>
</tr>
<tr id="S4.T3.3.7.7" class="ltx_tr">
<td id="S4.T3.3.7.7.1" class="ltx_td ltx_align_center ltx_border_l ltx_border_r ltx_border_tt" colspan="5">
<span id="S4.T3.3.7.7.1.1" class="ltx_text ltx_font_bold" style="font-size:90%;">Baseline </span><span id="S4.T3.3.7.7.1.2" class="ltx_text ltx_font_typewriter" style="font-size:90%;">FedAvg</span><span id="S4.T3.3.7.7.1.3" class="ltx_text ltx_font_bold" style="font-size:90%;"> (imbalanced dataset)</span>
</td>
</tr>
<tr id="S4.T3.3.8.8" class="ltx_tr">
<td id="S4.T3.3.8.8.1" class="ltx_td ltx_border_l ltx_border_r ltx_border_t"></td>
<td id="S4.T3.3.8.8.2" class="ltx_td ltx_align_center ltx_border_r ltx_border_t"><span id="S4.T3.3.8.8.2.1" class="ltx_text ltx_font_bold" style="font-size:90%;">Acc.</span></td>
<td id="S4.T3.3.8.8.3" class="ltx_td ltx_align_center ltx_border_r ltx_border_t"><span id="S4.T3.3.8.8.3.1" class="ltx_text ltx_font_bold" style="font-size:90%;">Prec.</span></td>
<td id="S4.T3.3.8.8.4" class="ltx_td ltx_align_center ltx_border_r ltx_border_t"><span id="S4.T3.3.8.8.4.1" class="ltx_text ltx_font_bold" style="font-size:90%;">Recall</span></td>
<td id="S4.T3.3.8.8.5" class="ltx_td ltx_align_center ltx_border_r ltx_border_t"><span id="S4.T3.3.8.8.5.1" class="ltx_text ltx_font_bold" style="font-size:90%;">F1</span></td>
</tr>
<tr id="S4.T3.3.9.9" class="ltx_tr">
<td id="S4.T3.3.9.9.1" class="ltx_td ltx_align_center ltx_border_l ltx_border_r ltx_border_t">
<span id="S4.T3.3.9.9.1.1" class="ltx_text" style="font-size:90%;"></span><span id="S4.T3.3.9.9.1.2" class="ltx_text ltx_font_bold" style="font-size:90%;">Global</span>
</td>
<td id="S4.T3.3.9.9.2" class="ltx_td ltx_align_center ltx_border_r ltx_border_t"><span id="S4.T3.3.9.9.2.1" class="ltx_text ltx_font_bold" style="font-size:90%;">82.55%</span></td>
<td id="S4.T3.3.9.9.3" class="ltx_td ltx_align_center ltx_border_r ltx_border_t"><span id="S4.T3.3.9.9.3.1" class="ltx_text ltx_font_bold" style="font-size:90%;">85.17%</span></td>
<td id="S4.T3.3.9.9.4" class="ltx_td ltx_align_center ltx_border_r ltx_border_t"><span id="S4.T3.3.9.9.4.1" class="ltx_text ltx_font_bold" style="font-size:90%;">82.55%</span></td>
<td id="S4.T3.3.9.9.5" class="ltx_td ltx_align_center ltx_border_r ltx_border_t"><span id="S4.T3.3.9.9.5.1" class="ltx_text ltx_font_bold" style="font-size:90%;">82.80%</span></td>
</tr>
<tr id="S4.T3.3.10.10" class="ltx_tr">
<td id="S4.T3.3.10.10.1" class="ltx_td ltx_align_center ltx_border_l ltx_border_r ltx_border_t"><span id="S4.T3.3.10.10.1.1" class="ltx_text" style="font-size:90%;">Client 1</span></td>
<td id="S4.T3.3.10.10.2" class="ltx_td ltx_align_center ltx_border_r ltx_border_t"><span id="S4.T3.3.10.10.2.1" class="ltx_text" style="font-size:90%;">81.70%</span></td>
<td id="S4.T3.3.10.10.3" class="ltx_td ltx_align_center ltx_border_r ltx_border_t"><span id="S4.T3.3.10.10.3.1" class="ltx_text" style="font-size:90%;">84.17%</span></td>
<td id="S4.T3.3.10.10.4" class="ltx_td ltx_align_center ltx_border_r ltx_border_t"><span id="S4.T3.3.10.10.4.1" class="ltx_text" style="font-size:90%;">81.7%</span></td>
<td id="S4.T3.3.10.10.5" class="ltx_td ltx_align_center ltx_border_r ltx_border_t"><span id="S4.T3.3.10.10.5.1" class="ltx_text" style="font-size:90%;">81.73%</span></td>
</tr>
<tr id="S4.T3.3.11.11" class="ltx_tr">
<td id="S4.T3.3.11.11.1" class="ltx_td ltx_align_center ltx_border_l ltx_border_r ltx_border_t"><span id="S4.T3.3.11.11.1.1" class="ltx_text" style="font-size:90%;">Client 2</span></td>
<td id="S4.T3.3.11.11.2" class="ltx_td ltx_align_center ltx_border_r ltx_border_t"><span id="S4.T3.3.11.11.2.1" class="ltx_text" style="font-size:90%;">77.85%</span></td>
<td id="S4.T3.3.11.11.3" class="ltx_td ltx_align_center ltx_border_r ltx_border_t"><span id="S4.T3.3.11.11.3.1" class="ltx_text" style="font-size:90%;">82.71%</span></td>
<td id="S4.T3.3.11.11.4" class="ltx_td ltx_align_center ltx_border_r ltx_border_t"><span id="S4.T3.3.11.11.4.1" class="ltx_text" style="font-size:90%;">77.85%</span></td>
<td id="S4.T3.3.11.11.5" class="ltx_td ltx_align_center ltx_border_r ltx_border_t"><span id="S4.T3.3.11.11.5.1" class="ltx_text" style="font-size:90%;">77.80%</span></td>
</tr>
<tr id="S4.T3.3.12.12" class="ltx_tr">
<td id="S4.T3.3.12.12.1" class="ltx_td ltx_align_center ltx_border_l ltx_border_r ltx_border_t"><span id="S4.T3.3.12.12.1.1" class="ltx_text" style="font-size:90%;">Client 3</span></td>
<td id="S4.T3.3.12.12.2" class="ltx_td ltx_align_center ltx_border_r ltx_border_t"><span id="S4.T3.3.12.12.2.1" class="ltx_text" style="font-size:90%;">76.95%</span></td>
<td id="S4.T3.3.12.12.3" class="ltx_td ltx_align_center ltx_border_r ltx_border_t"><span id="S4.T3.3.12.12.3.1" class="ltx_text" style="font-size:90%;">81.13%</span></td>
<td id="S4.T3.3.12.12.4" class="ltx_td ltx_align_center ltx_border_r ltx_border_t"><span id="S4.T3.3.12.12.4.1" class="ltx_text" style="font-size:90%;">76.95%</span></td>
<td id="S4.T3.3.12.12.5" class="ltx_td ltx_align_center ltx_border_r ltx_border_t"><span id="S4.T3.3.12.12.5.1" class="ltx_text" style="font-size:90%;">76.40%</span></td>
</tr>
<tr id="S4.T3.3.13.13" class="ltx_tr">
<td id="S4.T3.3.13.13.1" class="ltx_td ltx_align_center ltx_border_l ltx_border_r ltx_border_t" colspan="5"><span id="S4.T3.3.13.13.1.1" class="ltx_text ltx_font_bold" style="font-size:90%;">Weighted cross entropy loss (imbalanced dataset)</span></td>
</tr>
<tr id="S4.T3.3.14.14" class="ltx_tr">
<td id="S4.T3.3.14.14.1" class="ltx_td ltx_border_l ltx_border_r ltx_border_t"></td>
<td id="S4.T3.3.14.14.2" class="ltx_td ltx_align_center ltx_border_r ltx_border_t"><span id="S4.T3.3.14.14.2.1" class="ltx_text ltx_font_bold" style="font-size:90%;">Acc.</span></td>
<td id="S4.T3.3.14.14.3" class="ltx_td ltx_align_center ltx_border_r ltx_border_t"><span id="S4.T3.3.14.14.3.1" class="ltx_text ltx_font_bold" style="font-size:90%;">Prec.</span></td>
<td id="S4.T3.3.14.14.4" class="ltx_td ltx_align_center ltx_border_r ltx_border_t"><span id="S4.T3.3.14.14.4.1" class="ltx_text ltx_font_bold" style="font-size:90%;">Recall</span></td>
<td id="S4.T3.3.14.14.5" class="ltx_td ltx_align_center ltx_border_r ltx_border_t"><span id="S4.T3.3.14.14.5.1" class="ltx_text ltx_font_bold" style="font-size:90%;">F1 Score</span></td>
</tr>
<tr id="S4.T3.3.15.15" class="ltx_tr">
<td id="S4.T3.3.15.15.1" class="ltx_td ltx_align_center ltx_border_l ltx_border_r ltx_border_t"><span id="S4.T3.3.15.15.1.1" class="ltx_text ltx_font_bold" style="font-size:90%;">Global</span></td>
<td id="S4.T3.3.15.15.2" class="ltx_td ltx_align_center ltx_border_r ltx_border_t"><span id="S4.T3.3.15.15.2.1" class="ltx_text ltx_font_bold" style="font-size:90%;">84.15%</span></td>
<td id="S4.T3.3.15.15.3" class="ltx_td ltx_align_center ltx_border_r ltx_border_t"><span id="S4.T3.3.15.15.3.1" class="ltx_text ltx_font_bold" style="font-size:90%;">85.35%</span></td>
<td id="S4.T3.3.15.15.4" class="ltx_td ltx_align_center ltx_border_r ltx_border_t"><span id="S4.T3.3.15.15.4.1" class="ltx_text ltx_font_bold" style="font-size:90%;">82.05%</span></td>
<td id="S4.T3.3.15.15.5" class="ltx_td ltx_align_center ltx_border_r ltx_border_t"><span id="S4.T3.3.15.15.5.1" class="ltx_text ltx_font_bold" style="font-size:90%;">82.35%</span></td>
</tr>
<tr id="S4.T3.3.16.16" class="ltx_tr">
<td id="S4.T3.3.16.16.1" class="ltx_td ltx_align_center ltx_border_l ltx_border_r ltx_border_t"><span id="S4.T3.3.16.16.1.1" class="ltx_text" style="font-size:90%;">Client 1</span></td>
<td id="S4.T3.3.16.16.2" class="ltx_td ltx_align_center ltx_border_r ltx_border_t"><span id="S4.T3.3.16.16.2.1" class="ltx_text" style="font-size:90%;">83.35%</span></td>
<td id="S4.T3.3.16.16.3" class="ltx_td ltx_align_center ltx_border_r ltx_border_t"><span id="S4.T3.3.16.16.3.1" class="ltx_text" style="font-size:90%;">81.99%</span></td>
<td id="S4.T3.3.16.16.4" class="ltx_td ltx_align_center ltx_border_r ltx_border_t"><span id="S4.T3.3.16.16.4.1" class="ltx_text" style="font-size:90%;">82.05%</span></td>
<td id="S4.T3.3.16.16.5" class="ltx_td ltx_align_center ltx_border_r ltx_border_t"><span id="S4.T3.3.16.16.5.1" class="ltx_text" style="font-size:90%;">82.35%</span></td>
</tr>
<tr id="S4.T3.3.17.17" class="ltx_tr">
<td id="S4.T3.3.17.17.1" class="ltx_td ltx_align_center ltx_border_l ltx_border_r ltx_border_t"><span id="S4.T3.3.17.17.1.1" class="ltx_text" style="font-size:90%;">Client 2</span></td>
<td id="S4.T3.3.17.17.2" class="ltx_td ltx_align_center ltx_border_r ltx_border_t"><span id="S4.T3.3.17.17.2.1" class="ltx_text" style="font-size:90%;">82.15%</span></td>
<td id="S4.T3.3.17.17.3" class="ltx_td ltx_align_center ltx_border_r ltx_border_t"><span id="S4.T3.3.17.17.3.1" class="ltx_text" style="font-size:90%;">83.82%</span></td>
<td id="S4.T3.3.17.17.4" class="ltx_td ltx_align_center ltx_border_r ltx_border_t"><span id="S4.T3.3.17.17.4.1" class="ltx_text" style="font-size:90%;">79.85%</span></td>
<td id="S4.T3.3.17.17.5" class="ltx_td ltx_align_center ltx_border_r ltx_border_t"><span id="S4.T3.3.17.17.5.1" class="ltx_text" style="font-size:90%;">80.29%</span></td>
</tr>
<tr id="S4.T3.3.18.18" class="ltx_tr">
<td id="S4.T3.3.18.18.1" class="ltx_td ltx_align_center ltx_border_b ltx_border_l ltx_border_r ltx_border_t"><span id="S4.T3.3.18.18.1.1" class="ltx_text" style="font-size:90%;">Client 3</span></td>
<td id="S4.T3.3.18.18.2" class="ltx_td ltx_align_center ltx_border_b ltx_border_r ltx_border_t"><span id="S4.T3.3.18.18.2.1" class="ltx_text" style="font-size:90%;">81.85%</span></td>
<td id="S4.T3.3.18.18.3" class="ltx_td ltx_align_center ltx_border_b ltx_border_r ltx_border_t"><span id="S4.T3.3.18.18.3.1" class="ltx_text" style="font-size:90%;">83.56%</span></td>
<td id="S4.T3.3.18.18.4" class="ltx_td ltx_align_center ltx_border_b ltx_border_r ltx_border_t"><span id="S4.T3.3.18.18.4.1" class="ltx_text" style="font-size:90%;">79.90%</span></td>
<td id="S4.T3.3.18.18.5" class="ltx_td ltx_align_center ltx_border_b ltx_border_r ltx_border_t"><span id="S4.T3.3.18.18.5.1" class="ltx_text" style="font-size:90%;">80.09%</span></td>
</tr>
</tbody>
</table>
</figure>
</section>
<section id="S5" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">V </span><span id="S5.1.1" class="ltx_text ltx_font_smallcaps">Conclusions</span>
</h2>

<div id="S5.p1" class="ltx_para">
<p id="S5.p1.1" class="ltx_p">The <span id="S5.p1.1.1" class="ltx_text ltx_font_italic">federated learning</span> (FL) framework provides improved privacy and scalability support for large <span id="S5.p1.1.2" class="ltx_text ltx_font_italic">machine learning</span> (ML) problems. Here, multiple client sites are used to train classifier algorithms using local data, and the parameters averaged to build a more accurate global model. Now FL has been applied to a wide range of applications, including a recent study on ransomware detection and attribution. However, dataset imbalance can limit the effectiveness of this method. Hence this study presents a modified FL learning scheme for ransomware analysis which uses a weighted cross entropy loss function to train regular <span id="S5.p1.1.3" class="ltx_text ltx_font_italic">feedforward neural network</span> (FNN) classifiers at local client sites. This solution is evaluated using an up-to-date repository containing the latest ransomware threats for the case of static analysis with Windows <span id="S5.p1.1.4" class="ltx_text ltx_font_italic">portable executable</span> (PE) format file data. Results confirm that the proposed scheme can help mitigate the effects of dataset imbalance, particularly for the binary ransomware detection problem.</p>
</div>
</section>
<section id="S6" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">VI </span><span id="S6.1.1" class="ltx_text ltx_font_smallcaps">Acknowledgements</span>
</h2>

<div id="S6.p1" class="ltx_para">
<p id="S6.p1.1" class="ltx_p">This work has been supported in part by Cyber Florida. The authors are very grateful for this support.</p>
</div>
</section>
<section id="bib" class="ltx_bibliography">
<h2 class="ltx_title ltx_title_bibliography">References</h2>

<ul class="ltx_biblist">
<li id="bib.bib1" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[1]</span>
<span class="ltx_bibblock">
E. Berrueta, D. Morato, E. Magaña, and M. Izal, “A survey on detection techniques for cryptographic ransomware,” <em id="bib.bib1.1.1" class="ltx_emph ltx_font_italic">IEEE Access</em>, vol. 7, pp. 144 925–144 944, October 2019.

</span>
</li>
<li id="bib.bib2" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[2]</span>
<span class="ltx_bibblock">
R. Moussaileb, N. Cuppens, J.-L. Lanet, and Bouder, “A survey on windows-based ransomware taxonomy and detection mechanisms: Case closed?” <em id="bib.bib2.1.1" class="ltx_emph ltx_font_italic">ACM Comp. Surveys</em>, vol. 54, no. 6, 2022.

</span>
</li>
<li id="bib.bib3" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[3]</span>
<span class="ltx_bibblock">
A. Vehabovic, N. Ghani, E. Bou-Harb, J. Crichigno, and A. Yayimli, “Ransomware detection and classification strategies,” in <em id="bib.bib3.1.1" class="ltx_emph ltx_font_italic">IEEE Black Sea Comm 2022</em>, Sofia, Bulgaria, June 2022.

</span>
</li>
<li id="bib.bib4" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[4]</span>
<span class="ltx_bibblock">
A. Kapoor, “Ransomware detection, avoidance, and mitigation scheme: A review and future directions,” <em id="bib.bib4.1.1" class="ltx_emph ltx_font_italic">Sustainability</em>, vol. 14, no. 1, December 2021.

</span>
</li>
<li id="bib.bib5" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[5]</span>
<span class="ltx_bibblock">
H. McMahan, E. Moore, D. Ramage, S. Hampson, and B. Arcas, “Communication-efficient learning of deep learning from decentralized data,” in <em id="bib.bib5.1.1" class="ltx_emph ltx_font_italic">AISTATS 2017</em>, Ft. Lauderdale, FL, 2017.

</span>
</li>
<li id="bib.bib6" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[6]</span>
<span class="ltx_bibblock">
A. Vehabovic, H. Zanddizari, F. Shaikh, N. Ghani, M. Safaeipour, E. Bou-Harb, and J. Crichigno, “Federated learning approach for distributed ransomware detection,” in <em id="bib.bib6.1.1" class="ltx_emph ltx_font_italic">5th Workshop on Security in Machine Learning and Its Applications, International Conference on Applied Cryptography and Network Security (ACNS) 2023</em>, Kyoto, Japan, June 2023.

</span>
</li>
<li id="bib.bib7" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[7]</span>
<span class="ltx_bibblock">
S. Poudyal, K. P. Subedi, and D. Dasgupta, “A framework for analyzing ransomware using machine learning.” <em id="bib.bib7.1.1" class="ltx_emph ltx_font_italic">IEEE 2018 SSCI</em>, November 2018.

</span>
</li>
<li id="bib.bib8" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[8]</span>
<span class="ltx_bibblock">
H. Zhang, X. Xiao, F. Mercaldo, S. Ni, F. Martinelli, and A. Sangaiah, “Classification of ransomware families with machine learning based onn-gram of opcodes.” <em id="bib.bib8.1.1" class="ltx_emph ltx_font_italic">Future Generation Computer Systems</em>, vol. 90, pp. 211–221, 2019.

</span>
</li>
<li id="bib.bib9" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[9]</span>
<span class="ltx_bibblock">
D. Kim, S. Woo, D. Lee, and T. Chung, “Static detection of malware and benign executable using machine learning,” in <em id="bib.bib9.1.1" class="ltx_emph ltx_font_italic">Internet 2016</em>, Barcelona, Spain, November 2016.

</span>
</li>
<li id="bib.bib10" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[10]</span>
<span class="ltx_bibblock">
A. Vehabovic, H. Zandizzari, F. Shaikh, N. Ghani, M. S. Pour, E. Bou-Harb, and J. Crichigno, “Data-centric machine learning approach for early ransomware detection and attribution,” in <em id="bib.bib10.1.1" class="ltx_emph ltx_font_italic">8th IEEE/IFIP NOMS Workshop on Analytics for Network and Service Management (AnNet 2023)</em>, Miami, Florida, May 2023.

</span>
</li>
<li id="bib.bib11" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[11]</span>
<span class="ltx_bibblock">
A. Almashhadani, M. Kaiiali, S. Sezer, and P. O’Kane, “A multi-classifier network-based crypto ransomware detection system: A case study of locky ransomware,” <em id="bib.bib11.1.1" class="ltx_emph ltx_font_italic">IEEE Access</em>, vol. 7, no. 1, pp. 47 053–47 067, 2019.

</span>
</li>
<li id="bib.bib12" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[12]</span>
<span class="ltx_bibblock">
K. C. Roy and Q. Chen, “Deepran: Attention-based bilstm and crf for ransomware early detection and classification. information systems frontiers,” <em id="bib.bib12.1.1" class="ltx_emph ltx_font_italic">Information Systems Frontiers</em>, vol. 0, pp. 1–17, 2021.

</span>
</li>
<li id="bib.bib13" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[13]</span>
<span class="ltx_bibblock">
E. Kolodenker, W. Koch, G. Stringhini, and M. Egele, “Paybreak: Defense against cryptographic ransomware,” in <em id="bib.bib13.1.1" class="ltx_emph ltx_font_italic">ACM Asia CCS 2017</em>, Abu Dhabi, UAE, April 2017.

</span>
</li>
<li id="bib.bib14" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[14]</span>
<span class="ltx_bibblock">
L. Wang, S. Xu, X. Wang, and Q. Zhu, “Addressing class imbalance in federated learning,” in <em id="bib.bib14.1.1" class="ltx_emph ltx_font_italic">35th AAAI Conference on Artificial Intelligence (AAAI-21)</em>, virtual/online, February 2021.

</span>
</li>
<li id="bib.bib15" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[15]</span>
<span class="ltx_bibblock">
M. Duan, D. Liu, X. Chen, R. Liu, Y. Tan, and L. Liang, “Self-balancing federated learning with global imbalanced data in mobile systems,” <em id="bib.bib15.1.1" class="ltx_emph ltx_font_italic">IEEE Transactions on Parallel and Distributed Systems</em>, vol. 32, no. 1, pp. 59–71, January 2021.

</span>
</li>
<li id="bib.bib16" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[16]</span>
<span class="ltx_bibblock">
S. Pouyanfar, Y. Tao, A. Mohan, H. Tian, A. Kaseb, K. Gauen, R. Dailey, S. Aghajanzadeh, Y. Lu, S. Chen, and M. Shyu, “Dynamic sampling in convolutional neural networks for imbalanced data classification,” in <em id="bib.bib16.1.1" class="ltx_emph ltx_font_italic">IEEE Conference on Multimedia Info. Processing and Retrieval (MIPR) 2018</em>, Miami, FL, June 2018.

</span>
</li>
</ul>
</section>
</article>
</div>
<div class="ar5iv-footer"><a href="/html/2311.07759" class="ar5iv-nav-button ar5iv-nav-button-prev">◄</a>
    <a class="ar5iv-home-button" href="/"><img height="40" alt="ar5iv homepage" src="/assets/ar5iv.png"></a>
    <a href="/feeling_lucky" class="ar5iv-text-button">Feeling<br>lucky?</a>
    <a href="/log/2311.07760" class="ar5iv-text-button ar5iv-severity-ok">Conversion<br>report</a>
    <a class="ar5iv-text-button" target="_blank" href="https://github.com/dginev/ar5iv/issues/new?template=improve-article--arxiv-id-.md&title=Improve+article+2311.07760">Report<br>an issue</a>
    <a href="https://arxiv.org/abs/2311.07760" class="ar5iv-text-button arxiv-ui-theme">View&nbsp;original<br>on&nbsp;arXiv</a><a href="/html/2311.07761" class="ar5iv-nav-button ar5iv-nav-button-next">►</a>
</div><footer class="ltx_page_footer">
<a class="ar5iv-toggle-color-scheme" href="javascript:toggleColorScheme()" title="Toggle ar5iv color scheme"><span class="color-scheme-icon"></span></a>
<a class="ar5iv-footer-button" href="https://arxiv.org/help/license" target="_blank">Copyright</a>
<a class="ar5iv-footer-button" href="https://arxiv.org/help/policies/privacy_policy" target="_blank">Privacy Policy</a>

<div class="ltx_page_logo">Generated  on Tue Feb 27 19:14:24 2024 by <a target="_blank" href="http://dlmf.nist.gov/LaTeXML/" class="ltx_LaTeXML_logo"><span style="letter-spacing:-0.2em; margin-right:0.1em;">L<span class="ltx_font_smallcaps" style="position:relative; bottom:2.2pt;">a</span>T<span class="ltx_font_smallcaps" style="font-size:120%;position:relative; bottom:-0.2ex;">e</span></span><span style="font-size:90%; position:relative; bottom:-0.2ex;">XML</span><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAsAAAAOCAYAAAD5YeaVAAAAAXNSR0IArs4c6QAAAAZiS0dEAP8A/wD/oL2nkwAAAAlwSFlzAAALEwAACxMBAJqcGAAAAAd0SU1FB9wKExQZLWTEaOUAAAAddEVYdENvbW1lbnQAQ3JlYXRlZCB3aXRoIFRoZSBHSU1Q72QlbgAAAdpJREFUKM9tkL+L2nAARz9fPZNCKFapUn8kyI0e4iRHSR1Kb8ng0lJw6FYHFwv2LwhOpcWxTjeUunYqOmqd6hEoRDhtDWdA8ApRYsSUCDHNt5ul13vz4w0vWCgUnnEc975arX6ORqN3VqtVZbfbTQC4uEHANM3jSqXymFI6yWazP2KxWAXAL9zCUa1Wy2tXVxheKA9YNoR8Pt+aTqe4FVVVvz05O6MBhqUIBGk8Hn8HAOVy+T+XLJfLS4ZhTiRJgqIoVBRFIoric47jPnmeB1mW/9rr9ZpSSn3Lsmir1fJZlqWlUonKsvwWwD8ymc/nXwVBeLjf7xEKhdBut9Hr9WgmkyGEkJwsy5eHG5vN5g0AKIoCAEgkEkin0wQAfN9/cXPdheu6P33fBwB4ngcAcByHJpPJl+fn54mD3Gg0NrquXxeLRQAAwzAYj8cwTZPwPH9/sVg8PXweDAauqqr2cDjEer1GJBLBZDJBs9mE4zjwfZ85lAGg2+06hmGgXq+j3+/DsixYlgVN03a9Xu8jgCNCyIegIAgx13Vfd7vdu+FweG8YRkjXdWy329+dTgeSJD3ieZ7RNO0VAXAPwDEAO5VKndi2fWrb9jWl9Esul6PZbDY9Go1OZ7PZ9z/lyuD3OozU2wAAAABJRU5ErkJggg==" alt="Mascot Sammy"></a>
</div></footer>
</div>

    <script>
      var canMathML = typeof(MathMLElement) == "function";
      if (!canMathML) {
        var body = document.querySelector("body");
        body.firstElementChild.setAttribute('style', 'opacity: 0;');
        var loading = document.createElement("div");
        loading.setAttribute("id", "mathjax-loading-spinner");
        var message = document.createElement("div");
        message.setAttribute("id", "mathjax-loading-message");
        message.innerText = "Typesetting Equations...";
        body.prepend(loading);
        body.prepend(message);

        var el = document.createElement("script");
        el.src = "https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js";
        document.querySelector("head").appendChild(el);

        window.MathJax = {
          startup: {
            pageReady: () => {
              return MathJax.startup.defaultPageReady().then(() => {
                body.removeChild(loading);
                body.removeChild(message);
                body.firstElementChild.removeAttribute('style');
              }); } } };
      }
    </script>
    <script>
    // Auxiliary function, building the preview feature when
    // an inline citation is clicked
    function clicked_cite(e) {
      e.preventDefault();
      let cite = this.closest('.ltx_cite');
      let next = cite.nextSibling;
      if (next && next.nodeType == Node.ELEMENT_NODE && next.getAttribute('class') == "ar5iv-bibitem-preview") {
        next.remove();
        return; }
      // Before adding a preview modal,
      // cleanup older previews, in case they're still open
      document.querySelectorAll('span.ar5iv-bibitem-preview').forEach(function(node) {
        node.remove();
      })

      // Create the preview
      preview = document.createElement('span');
      preview.setAttribute('class','ar5iv-bibitem-preview');
      let target = document.getElementById(this.getAttribute('href').slice(1));
      target.childNodes.forEach(function (child) {
        preview.append(child.cloneNode(true));
      });
      let close_x = document.createElement('button');
      close_x.setAttribute("aria-label","Close modal for bibliography item preview");
      close_x.textContent = "×";
      close_x.setAttribute('class', 'ar5iv-button-close-preview');
      close_x.setAttribute('onclick','this.parentNode.remove()');
      preview.append(close_x);
      preview.querySelectorAll('.ltx_tag_bibitem').forEach(function(node) {
        node.remove();
      });
      cite.parentNode.insertBefore(preview, cite.nextSibling);
      return;
    }
    // Global Document initialization:
    // - assign the preview feature to all inline citation links
    document.querySelectorAll(".ltx_cite .ltx_ref").forEach(function (link) {
      link.addEventListener("click", clicked_cite);
    });
    </script>
    </body>
</html>
