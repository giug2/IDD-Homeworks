<!DOCTYPE html>
<html lang="en">
<head>
<meta content="text/html; charset=utf-8" http-equiv="content-type"/>
<title>Feedback-aligned Mixed LLMs for Machine Language-Molecule Translation</title>
<!--Generated on Fri May 24 15:02:19 2024 by LaTeXML (version 0.8.8) http://dlmf.nist.gov/LaTeXML/.-->
<meta content="width=device-width, initial-scale=1, shrink-to-fit=no" name="viewport"/>
<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet" type="text/css"/>
<link href="/static/browse/0.3.4/css/ar5iv.0.7.9.min.css" rel="stylesheet" type="text/css"/>
<link href="/static/browse/0.3.4/css/ar5iv-fonts.0.7.9.min.css" rel="stylesheet" type="text/css"/>
<link href="/static/browse/0.3.4/css/latexml_styles.css" rel="stylesheet" type="text/css"/>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.3.3/html2canvas.min.js"></script>
<script src="/static/browse/0.3.4/js/addons_new.js"></script>
<script src="/static/browse/0.3.4/js/feedbackOverlay.js"></script>
<base href="/html/2405.13984v1/"/></head>
<body>
<nav class="ltx_page_navbar">
<nav class="ltx_TOC">
<ol class="ltx_toclist">
<li class="ltx_tocentry ltx_tocentry_section"><a class="ltx_ref" href="https://arxiv.org/html/2405.13984v1#S1" title="In Feedback-aligned Mixed LLMs for Machine Language-Molecule Translation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">1 </span>Introduction</span></a></li>
<li class="ltx_tocentry ltx_tocentry_section">
<a class="ltx_ref" href="https://arxiv.org/html/2405.13984v1#S2" title="In Feedback-aligned Mixed LLMs for Machine Language-Molecule Translation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">2 </span>Foundations in RLHF for LLMs</span></a>
<ol class="ltx_toclist ltx_toclist_section">
<li class="ltx_tocentry ltx_tocentry_paragraph"><a class="ltx_ref" href="https://arxiv.org/html/2405.13984v1#S2.SS0.SSS0.Px1" title="In 2 Foundations in RLHF for LLMs ‣ Feedback-aligned Mixed LLMs for Machine Language-Molecule Translation"><span class="ltx_text ltx_ref_title">Human-aware Loss Functions (HALOs):</span></a></li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_section">
<a class="ltx_ref" href="https://arxiv.org/html/2405.13984v1#S3" title="In Feedback-aligned Mixed LLMs for Machine Language-Molecule Translation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3 </span>Methodology</span></a>
<ol class="ltx_toclist ltx_toclist_section">
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2405.13984v1#S3.SS1" title="In 3 Methodology ‣ Feedback-aligned Mixed LLMs for Machine Language-Molecule Translation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3.1 </span>Problem Definition: Machine Language-Molecule Translation (LMolT)</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection">
<a class="ltx_ref" href="https://arxiv.org/html/2405.13984v1#S3.SS2" title="In 3 Methodology ‣ Feedback-aligned Mixed LLMs for Machine Language-Molecule Translation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3.2 </span>Feedback-Aligned Optimisations Algorithms</span></a>
<ol class="ltx_toclist ltx_toclist_subsection">
<li class="ltx_tocentry ltx_tocentry_paragraph"><a class="ltx_ref" href="https://arxiv.org/html/2405.13984v1#S3.SS2.SSS0.Px1" title="In 3.2 Feedback-Aligned Optimisations Algorithms ‣ 3 Methodology ‣ Feedback-aligned Mixed LLMs for Machine Language-Molecule Translation"><span class="ltx_text ltx_ref_title">Supervised Fine-Tuning (SFT):</span></a></li>
<li class="ltx_tocentry ltx_tocentry_paragraph"><a class="ltx_ref" href="https://arxiv.org/html/2405.13984v1#S3.SS2.SSS0.Px2" title="In 3.2 Feedback-Aligned Optimisations Algorithms ‣ 3 Methodology ‣ Feedback-aligned Mixed LLMs for Machine Language-Molecule Translation"><span class="ltx_text ltx_ref_title">Direct Preference Optimisation (DPO):</span></a></li>
<li class="ltx_tocentry ltx_tocentry_paragraph"><a class="ltx_ref" href="https://arxiv.org/html/2405.13984v1#S3.SS2.SSS0.Px3" title="In 3.2 Feedback-Aligned Optimisations Algorithms ‣ 3 Methodology ‣ Feedback-aligned Mixed LLMs for Machine Language-Molecule Translation"><span class="ltx_text ltx_ref_title">Contrastive Preference Optimisation (CPO):</span></a></li>
<li class="ltx_tocentry ltx_tocentry_paragraph"><a class="ltx_ref" href="https://arxiv.org/html/2405.13984v1#S3.SS2.SSS0.Px4" title="In 3.2 Feedback-Aligned Optimisations Algorithms ‣ 3 Methodology ‣ Feedback-aligned Mixed LLMs for Machine Language-Molecule Translation"><span class="ltx_text ltx_ref_title">Kahneman-Tversky Optimisation (KTO):</span></a></li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2405.13984v1#S3.SS3" title="In 3 Methodology ‣ Feedback-aligned Mixed LLMs for Machine Language-Molecule Translation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3.3 </span>Mixed Cross-Modals Fusion</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2405.13984v1#S3.SS4" title="In 3 Methodology ‣ Feedback-aligned Mixed LLMs for Machine Language-Molecule Translation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3.4 </span>Evaluation Method for Assessing Hallucination in Chemical LLMs</span></a></li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_section">
<a class="ltx_ref" href="https://arxiv.org/html/2405.13984v1#S4" title="In Feedback-aligned Mixed LLMs for Machine Language-Molecule Translation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">4 </span>Experiments</span></a>
<ol class="ltx_toclist ltx_toclist_section">
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2405.13984v1#S4.SS1" title="In 4 Experiments ‣ Feedback-aligned Mixed LLMs for Machine Language-Molecule Translation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">4.1 </span>Data</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2405.13984v1#S4.SS2" title="In 4 Experiments ‣ Feedback-aligned Mixed LLMs for Machine Language-Molecule Translation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">4.2 </span>Benchmark Models</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2405.13984v1#S4.SS3" title="In 4 Experiments ‣ Feedback-aligned Mixed LLMs for Machine Language-Molecule Translation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">4.3 </span>Experimental Setup</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection">
<a class="ltx_ref" href="https://arxiv.org/html/2405.13984v1#S4.SS4" title="In 4 Experiments ‣ Feedback-aligned Mixed LLMs for Machine Language-Molecule Translation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">4.4 </span>Results</span></a>
<ol class="ltx_toclist ltx_toclist_subsection">
<li class="ltx_tocentry ltx_tocentry_subsubsection"><a class="ltx_ref" href="https://arxiv.org/html/2405.13984v1#S4.SS4.SSS1" title="In 4.4 Results ‣ 4 Experiments ‣ Feedback-aligned Mixed LLMs for Machine Language-Molecule Translation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">4.4.1 </span>Quantitative Analysis on Feedback-Aligned Optimisation Algorithms</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsubsection"><a class="ltx_ref" href="https://arxiv.org/html/2405.13984v1#S4.SS4.SSS2" title="In 4.4 Results ‣ 4 Experiments ‣ Feedback-aligned Mixed LLMs for Machine Language-Molecule Translation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">4.4.2 </span>Quantitative Analysis on Mixed Cross-Modals Fusion</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsubsection"><a class="ltx_ref" href="https://arxiv.org/html/2405.13984v1#S4.SS4.SSS3" title="In 4.4 Results ‣ 4 Experiments ‣ Feedback-aligned Mixed LLMs for Machine Language-Molecule Translation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">4.4.3 </span>Evaluation Results on Assessing Hallucination in Chemical LLMs</span></a></li>
</ol>
</li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_section"><a class="ltx_ref" href="https://arxiv.org/html/2405.13984v1#S5" title="In Feedback-aligned Mixed LLMs for Machine Language-Molecule Translation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">5 </span>Conclusion</span></a></li>
<li class="ltx_tocentry ltx_tocentry_appendix"><a class="ltx_ref" href="https://arxiv.org/html/2405.13984v1#A1" title="In Feedback-aligned Mixed LLMs for Machine Language-Molecule Translation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">A </span>Related Work</span></a></li>
<li class="ltx_tocentry ltx_tocentry_appendix"><a class="ltx_ref" href="https://arxiv.org/html/2405.13984v1#A2" title="In Feedback-aligned Mixed LLMs for Machine Language-Molecule Translation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">B </span>Human-aware Loss Functions (HALOs)</span></a></li>
<li class="ltx_tocentry ltx_tocentry_appendix"><a class="ltx_ref" href="https://arxiv.org/html/2405.13984v1#A3" title="In Feedback-aligned Mixed LLMs for Machine Language-Molecule Translation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">C </span>Language-molecule Translation Instructions</span></a></li>
<li class="ltx_tocentry ltx_tocentry_appendix"><a class="ltx_ref" href="https://arxiv.org/html/2405.13984v1#A4" title="In Feedback-aligned Mixed LLMs for Machine Language-Molecule Translation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">D </span>Evaluation Metrics</span></a></li>
<li class="ltx_tocentry ltx_tocentry_appendix"><a class="ltx_ref" href="https://arxiv.org/html/2405.13984v1#A5" title="In Feedback-aligned Mixed LLMs for Machine Language-Molecule Translation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">E </span>Examples of Language-Molecule Translation</span></a></li>
<li class="ltx_tocentry ltx_tocentry_appendix"><a class="ltx_ref" href="https://arxiv.org/html/2405.13984v1#A6" title="In Feedback-aligned Mixed LLMs for Machine Language-Molecule Translation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">F </span>Experimental Settings</span></a></li>
<li class="ltx_tocentry ltx_tocentry_appendix"><a class="ltx_ref" href="https://arxiv.org/html/2405.13984v1#A7" title="In Feedback-aligned Mixed LLMs for Machine Language-Molecule Translation"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">G </span>Training Efficiency</span></a></li>
</ol></nav>
</nav>
<div class="ltx_page_main">
<div class="ltx_page_content">
<article class="ltx_document ltx_authors_1line">
<h1 class="ltx_title ltx_title_document">Feedback-aligned Mixed LLMs for Machine Language-Molecule Translation
</h1>
<div class="ltx_authors">
<span class="ltx_creator ltx_role_author">
<span class="ltx_personname">Dimitris Gkoumas<sup class="ltx_sup" id="id4.4.id1"><span class="ltx_text ltx_font_italic" id="id4.4.id1.1">1∗</span></sup>  Maria Liakata<sup class="ltx_sup" id="id5.5.id2"><span class="ltx_text ltx_font_italic" id="id5.5.id2.1">1∗</span></sup>
<br class="ltx_break"/>
<br class="ltx_break"/><sup class="ltx_sup" id="id6.6.id3">1</sup>Queen Mary University of London
<br class="ltx_break"/><span class="ltx_text ltx_font_typewriter" id="id7.7.id4">{d.gkoumas,m.liakata}@qmul.ac.uk</span>
</span></span>
</div>
<div class="ltx_abstract">
<h6 class="ltx_title ltx_title_abstract">Abstract</h6>
<p class="ltx_p" id="id8.id1">The intersection of chemistry and Artificial Intelligence (AI) is an active area of research focused on accelerating scientific discovery. While using large language models (LLMs) with scientific modalities has shown potential, there are significant challenges to address, such as improving training efficiency and dealing with the out-of-distribution problem.
Focussing on the task of automated language-molecule translation, we are the first to use state-of-the art (SOTA) human-centric optimisation algorithms in the cross-modal setting, successfully aligning cross-language-molecule modals. We empirically show that we can augment the capabilities of scientific LLMs without the need for extensive data or large models. We conduct experiments using only 10% of the available data to mitigate memorisation effects associated with training large models on extensive datasets. We achieve significant performance gains, surpassing the best benchmark model trained on extensive in-distribution data by a large margin and reach new SOTA levels. Additionally we are the first to propose employing non-linear fusion for mixing cross-modal LLMs which further boosts performance gains without increasing training costs or data needs. Finally, we introduce a fine-grained, domain-agnostic evaluation method to assess hallucination in LLMs and promote responsible use.</p>
</div>
<section class="ltx_section" id="S1">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">1 </span>Introduction</h2>
<div class="ltx_para" id="S1.p1">
<p class="ltx_p" id="S1.p1.1">Chemistry plays a crucial role in developing innovative scientific solutions that are scalable and cost-effective, whether it involves pioneering new drugs <cite class="ltx_cite ltx_citemacro_cite">Ferguson and Gray (<a class="ltx_ref" href="https://arxiv.org/html/2405.13984v1#bib.bib11" title="">2018</a>)</cite>, advanced materials <cite class="ltx_cite ltx_citemacro_cite">Kippelen and Brédas (<a class="ltx_ref" href="https://arxiv.org/html/2405.13984v1#bib.bib15" title="">2009</a>)</cite>, or improving chemical processes <cite class="ltx_cite ltx_citemacro_cite">Zhong et al. (<a class="ltx_ref" href="https://arxiv.org/html/2405.13984v1#bib.bib45" title="">2023</a>)</cite>. However, navigating the vast possibilities in chemistry but also biology and materials science necessitates the involvement of Artificial Intelligence (AI) technology to enable the acceleration of scientific discovery <cite class="ltx_cite ltx_citemacro_cite">AI4Science and Quantum (<a class="ltx_ref" href="https://arxiv.org/html/2405.13984v1#bib.bib1" title="">2023</a>)</cite>.</p>
</div>
<div class="ltx_para" id="S1.p2">
<p class="ltx_p" id="S1.p2.1">Multi-modal models combining language with molecules have recently gained attention as a promising approach for studying and comprehending molecules, offering significant potential to tackle pressing global issues <cite class="ltx_cite ltx_citemacro_cite"><a class="ltx_ref" href="https://arxiv.org/html/2405.13984v1#bib.bib42" title="">Zhang et al. </a></cite>. Existing work has applied successful paradigms from natural language processing (NLP) and multimodal representation learning to the chemistry domain. One common approach involves converting the inherent three-dimensional structures of molecules into SMILES, which provide a mapping to symbolic character-level representations. Subsequently, researchers have explored learning language-molecule representations in separate yet coordinated spaces <cite class="ltx_cite ltx_citemacro_cite">Edwards et al. (<a class="ltx_ref" href="https://arxiv.org/html/2405.13984v1#bib.bib7" title="">2021</a>, <a class="ltx_ref" href="https://arxiv.org/html/2405.13984v1#bib.bib8" title="">2022</a>); Liu et al. (<a class="ltx_ref" href="https://arxiv.org/html/2405.13984v1#bib.bib17" title="">2023a</a>)</cite>, in a joint space <cite class="ltx_cite ltx_citemacro_cite">Liu et al. (<a class="ltx_ref" href="https://arxiv.org/html/2405.13984v1#bib.bib18" title="">2023b</a>)</cite>, or through hybrid approaches <cite class="ltx_cite ltx_citemacro_cite">Luo et al. (<a class="ltx_ref" href="https://arxiv.org/html/2405.13984v1#bib.bib20" title="">2023</a>); Christofidellis et al. (<a class="ltx_ref" href="https://arxiv.org/html/2405.13984v1#bib.bib5" title="">2023</a>)</cite>. Despite significant advancements in the field, existing work does not effectively tackle the inherent challenges in training such models; they often rely on low quality or noisy synthetic data and typically require significantly more data compared to ordinary NLP tasks <cite class="ltx_cite ltx_citemacro_cite">Edwards et al. (<a class="ltx_ref" href="https://arxiv.org/html/2405.13984v1#bib.bib7" title="">2021</a>)</cite>.</p>
</div>
<div class="ltx_para" id="S1.p3">
<p class="ltx_p" id="S1.p3.1">However training larger models and utilising extensive datasets does not always guarantee better performance. Ongoing research in NLP is focused on innovative training methods to enhance the performance of small-sized LLMs <cite class="ltx_cite ltx_citemacro_cite">Liu et al. (<a class="ltx_ref" href="https://arxiv.org/html/2405.13984v1#bib.bib16" title="">2024</a>)</cite>. For instance, ALMA <cite class="ltx_cite ltx_citemacro_cite">Xu et al. (<a class="ltx_ref" href="https://arxiv.org/html/2405.13984v1#bib.bib38" title="">2023</a>)</cite> fine-tuned LLaMA-2 <cite class="ltx_cite ltx_citemacro_cite">Touvron et al. (<a class="ltx_ref" href="https://arxiv.org/html/2405.13984v1#bib.bib33" title="">2023</a>)</cite> with extensive non-English monolingual data to enhance the model’s multilingual abilities. Subsequently, supervised fine-tuning (SFT) with high-quality parallel data was performed to instruct the model in generating translations, surpassing all prior moderate-sized LLMs, including large models like GPT-3.5 <cite class="ltx_cite ltx_citemacro_cite">Brown et al. (<a class="ltx_ref" href="https://arxiv.org/html/2405.13984v1#bib.bib3" title="">2020</a>)</cite>. Another successful paradigm, Reinforcement Learning with Human Feedback (RLHF) <cite class="ltx_cite ltx_citemacro_cite">Ouyang et al. (<a class="ltx_ref" href="https://arxiv.org/html/2405.13984v1#bib.bib23" title="">2022</a>)</cite>, aims to enhance the capabilities of LLMs across multiple NLP tasks, including machine translation. A recent trend is favouring closed-form losses that directly operate on offline preferences <cite class="ltx_cite ltx_citemacro_cite">Rafailov et al. (<a class="ltx_ref" href="https://arxiv.org/html/2405.13984v1#bib.bib26" title="">2024</a>); Xu et al. (<a class="ltx_ref" href="https://arxiv.org/html/2405.13984v1#bib.bib39" title="">2024</a>); Ethayarajh et al. (<a class="ltx_ref" href="https://arxiv.org/html/2405.13984v1#bib.bib10" title="">2024</a>)</cite>, simplifying over RHLF without loss in performance.</p>
</div>
<div class="ltx_para" id="S1.p4">
<p class="ltx_p" id="S1.p4.1">Here, we address challenges of effectively training robust LLMs and dealing with the out-of-distribution problem when integrating scientific modalities, specifically focusing on machine language-molecule translation. Our approach is the first to experiment with human-centric optimisation objectives in the cross-modal representation learning setting to align cross language-molecule modals with preferred offline translations. To mitigate the memorisation effects inherent in training on large datasets, we conduct experiments using only 10% of the <span class="ltx_text ltx_font_italic" id="S1.p4.1.1">L+M-24</span> benchmark dataset <cite class="ltx_cite ltx_citemacro_cite">Edwards et al. (<a class="ltx_ref" href="https://arxiv.org/html/2405.13984v1#bib.bib9" title="">2024</a>)</cite>, achieving new state-of-the-art (SOTA) levels. Additionally, we propose a novel approach that fuses cross-modal LLMs to amplify performance gains without increasing training costs or data needs. The contributions of this work are as follows:</p>
<ul class="ltx_itemize" id="S1.I1">
<li class="ltx_item" id="S1.I1.i1" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S1.I1.i1.p1">
<p class="ltx_p" id="S1.I1.i1.p1.2">We obtain robust LLMs for machine language-molecule translation by experimenting with recent shifts in RLHF within the cross-modal representation setting, namely, direct preference optimisation (DPO), contrastive preference optimisation (CPO), and Kahneman-Tversky optimisation (KTO) (<math alttext="\S" class="ltx_Math" display="inline" id="S1.I1.i1.p1.1.m1.1"><semantics id="S1.I1.i1.p1.1.m1.1a"><mi id="S1.I1.i1.p1.1.m1.1.1" mathvariant="normal" xref="S1.I1.i1.p1.1.m1.1.1.cmml">§</mi><annotation-xml encoding="MathML-Content" id="S1.I1.i1.p1.1.m1.1b"><ci id="S1.I1.i1.p1.1.m1.1.1.cmml" xref="S1.I1.i1.p1.1.m1.1.1">§</ci></annotation-xml><annotation encoding="application/x-tex" id="S1.I1.i1.p1.1.m1.1c">\S</annotation><annotation encoding="application/x-llamapun" id="S1.I1.i1.p1.1.m1.1d">§</annotation></semantics></math> <a class="ltx_ref" href="https://arxiv.org/html/2405.13984v1#S3.SS2" title="3.2 Feedback-Aligned Optimisations Algorithms ‣ 3 Methodology ‣ Feedback-aligned Mixed LLMs for Machine Language-Molecule Translation"><span class="ltx_text ltx_ref_tag">3.2</span></a>). To the best of our knowledge, this is the first comprehensive study that investigates human-centric optimisations in LLMs in the multidisciplinary field of AI for living sciences. Our experiments show that both DPO and KTO cannot cope within agnostic cross-modal settings. In contrast, CPO, which is invariant to biases in these settings, achieves substantial performance gains by a large margin, reaching new SOTA levels compared to the best benchmark, Meditron, trained on the entire dataset (<math alttext="\S" class="ltx_Math" display="inline" id="S1.I1.i1.p1.2.m2.1"><semantics id="S1.I1.i1.p1.2.m2.1a"><mi id="S1.I1.i1.p1.2.m2.1.1" mathvariant="normal" xref="S1.I1.i1.p1.2.m2.1.1.cmml">§</mi><annotation-xml encoding="MathML-Content" id="S1.I1.i1.p1.2.m2.1b"><ci id="S1.I1.i1.p1.2.m2.1.1.cmml" xref="S1.I1.i1.p1.2.m2.1.1">§</ci></annotation-xml><annotation encoding="application/x-tex" id="S1.I1.i1.p1.2.m2.1c">\S</annotation><annotation encoding="application/x-llamapun" id="S1.I1.i1.p1.2.m2.1d">§</annotation></semantics></math> <a class="ltx_ref" href="https://arxiv.org/html/2405.13984v1#S4.SS4.SSS1" title="4.4.1 Quantitative Analysis on Feedback-Aligned Optimisation Algorithms ‣ 4.4 Results ‣ 4 Experiments ‣ Feedback-aligned Mixed LLMs for Machine Language-Molecule Translation"><span class="ltx_text ltx_ref_tag">4.4.1</span></a>).</p>
</div>
</li>
<li class="ltx_item" id="S1.I1.i2" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S1.I1.i2.p1">
<p class="ltx_p" id="S1.I1.i2.p1.2">We introduce an approach that mixes dominant-modality LLMs, based on non-linear fusion algorithms, namely TIES and SLERP (<math alttext="\S" class="ltx_Math" display="inline" id="S1.I1.i2.p1.1.m1.1"><semantics id="S1.I1.i2.p1.1.m1.1a"><mi id="S1.I1.i2.p1.1.m1.1.1" mathvariant="normal" xref="S1.I1.i2.p1.1.m1.1.1.cmml">§</mi><annotation-xml encoding="MathML-Content" id="S1.I1.i2.p1.1.m1.1b"><ci id="S1.I1.i2.p1.1.m1.1.1.cmml" xref="S1.I1.i2.p1.1.m1.1.1">§</ci></annotation-xml><annotation encoding="application/x-tex" id="S1.I1.i2.p1.1.m1.1c">\S</annotation><annotation encoding="application/x-llamapun" id="S1.I1.i2.p1.1.m1.1d">§</annotation></semantics></math> <a class="ltx_ref" href="https://arxiv.org/html/2405.13984v1#S3.SS3" title="3.3 Mixed Cross-Modals Fusion ‣ 3 Methodology ‣ Feedback-aligned Mixed LLMs for Machine Language-Molecule Translation"><span class="ltx_text ltx_ref_tag">3.3</span></a>). This addresses inequalities between the informativeness of different modalities as well as inherent limitations in optimisations operating on preference data, all without increase in training costs. We empirically demonstrate that this approach facilitates RLHF optimisation algorithms, which, to varying degrees, depend on how well the pre-trained model is suited to specific cross-modal settings, thereby further boosting performance gains (<math alttext="\S" class="ltx_Math" display="inline" id="S1.I1.i2.p1.2.m2.1"><semantics id="S1.I1.i2.p1.2.m2.1a"><mi id="S1.I1.i2.p1.2.m2.1.1" mathvariant="normal" xref="S1.I1.i2.p1.2.m2.1.1.cmml">§</mi><annotation-xml encoding="MathML-Content" id="S1.I1.i2.p1.2.m2.1b"><ci id="S1.I1.i2.p1.2.m2.1.1.cmml" xref="S1.I1.i2.p1.2.m2.1.1">§</ci></annotation-xml><annotation encoding="application/x-tex" id="S1.I1.i2.p1.2.m2.1c">\S</annotation><annotation encoding="application/x-llamapun" id="S1.I1.i2.p1.2.m2.1d">§</annotation></semantics></math> <a class="ltx_ref" href="https://arxiv.org/html/2405.13984v1#S4.SS4.SSS2" title="4.4.2 Quantitative Analysis on Mixed Cross-Modals Fusion ‣ 4.4 Results ‣ 4 Experiments ‣ Feedback-aligned Mixed LLMs for Machine Language-Molecule Translation"><span class="ltx_text ltx_ref_tag">4.4.2</span></a>).</p>
</div>
</li>
<li class="ltx_item" id="S1.I1.i3" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S1.I1.i3.p1">
<p class="ltx_p" id="S1.I1.i3.p1.1">We introduce a fine-grained evaluation method with multi-aspect criteria for assessing the presence of hallucinations in LLMs. Our domain-agnostic method can help ensure the responsible use of chemical LLMs (<math alttext="\S" class="ltx_Math" display="inline" id="S1.I1.i3.p1.1.m1.1"><semantics id="S1.I1.i3.p1.1.m1.1a"><mi id="S1.I1.i3.p1.1.m1.1.1" mathvariant="normal" xref="S1.I1.i3.p1.1.m1.1.1.cmml">§</mi><annotation-xml encoding="MathML-Content" id="S1.I1.i3.p1.1.m1.1b"><ci id="S1.I1.i3.p1.1.m1.1.1.cmml" xref="S1.I1.i3.p1.1.m1.1.1">§</ci></annotation-xml><annotation encoding="application/x-tex" id="S1.I1.i3.p1.1.m1.1c">\S</annotation><annotation encoding="application/x-llamapun" id="S1.I1.i3.p1.1.m1.1d">§</annotation></semantics></math> <a class="ltx_ref" href="https://arxiv.org/html/2405.13984v1#S3.SS4" title="3.4 Evaluation Method for Assessing Hallucination in Chemical LLMs ‣ 3 Methodology ‣ Feedback-aligned Mixed LLMs for Machine Language-Molecule Translation"><span class="ltx_text ltx_ref_tag">3.4</span></a>). We critically discuss our new insights and compare them with established metrics in the literature. We conclude by highlighting the limitations of both our evaluation criteria and previous evaluation and discuss potential future directions for responsibly assessing generative outputs from chemical LLMs (see Section <a class="ltx_ref" href="https://arxiv.org/html/2405.13984v1#S4.SS4.SSS3" title="4.4.3 Evaluation Results on Assessing Hallucination in Chemical LLMs ‣ 4.4 Results ‣ 4 Experiments ‣ Feedback-aligned Mixed LLMs for Machine Language-Molecule Translation"><span class="ltx_text ltx_ref_tag">4.4.3</span></a>).</p>
</div>
</li>
</ul>
</div>
</section>
<section class="ltx_section" id="S2">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">2 </span>Foundations in RLHF for LLMs</h2>
<div class="ltx_para" id="S2.p1">
<p class="ltx_p" id="S2.p1.1">Feedback-aligned LLMs traditionally undergo fine-tuning with RLHF, wherein human preferences serve as a reward signal in optimisation <cite class="ltx_cite ltx_citemacro_cite">Stiennon et al. (<a class="ltx_ref" href="https://arxiv.org/html/2405.13984v1#bib.bib32" title="">2020</a>); Ouyang et al. (<a class="ltx_ref" href="https://arxiv.org/html/2405.13984v1#bib.bib23" title="">2022</a>)</cite>. To train a LLM with RLHF, a reinforcement learning optimisation algorithm such as PPO <cite class="ltx_cite ltx_citemacro_cite">Schulman et al. (<a class="ltx_ref" href="https://arxiv.org/html/2405.13984v1#bib.bib27" title="">2017</a>)</cite> is typically deployed on offline preference data, involving commonly three steps:</p>
</div>
<div class="ltx_para" id="S2.p2">
<ul class="ltx_itemize" id="S2.I1">
<li class="ltx_item" id="S2.I1.i1" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S2.I1.i1.p1">
<p class="ltx_p" id="S2.I1.i1.p1.1"><span class="ltx_text ltx_font_bold" id="S2.I1.i1.p1.1.1">Roll-out:</span> Typically, a model <math alttext="\pi" class="ltx_Math" display="inline" id="S2.I1.i1.p1.1.m1.1"><semantics id="S2.I1.i1.p1.1.m1.1a"><mi id="S2.I1.i1.p1.1.m1.1.1" xref="S2.I1.i1.p1.1.m1.1.1.cmml">π</mi><annotation-xml encoding="MathML-Content" id="S2.I1.i1.p1.1.m1.1b"><ci id="S2.I1.i1.p1.1.m1.1.1.cmml" xref="S2.I1.i1.p1.1.m1.1.1">𝜋</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.I1.i1.p1.1.m1.1c">\pi</annotation><annotation encoding="application/x-llamapun" id="S2.I1.i1.p1.1.m1.1d">italic_π</annotation></semantics></math> is trained for auto-regressive language generation on a large generic corpus. This training operates under the premise that the probability distribution of a sequence of words can be broken down into the product of conditional distributions for the next word <cite class="ltx_cite ltx_citemacro_cite">Radford et al. (<a class="ltx_ref" href="https://arxiv.org/html/2405.13984v1#bib.bib25" title="">2019</a>)</cite>.</p>
</div>
</li>
<li class="ltx_item" id="S2.I1.i2" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S2.I1.i2.p1">
<p class="ltx_p" id="S2.I1.i2.p1.4"><span class="ltx_text ltx_font_bold" id="S2.I1.i2.p1.4.1">Evaluation:</span> A reference model <math alttext="\pi_{\text{ref}}" class="ltx_Math" display="inline" id="S2.I1.i2.p1.1.m1.1"><semantics id="S2.I1.i2.p1.1.m1.1a"><msub id="S2.I1.i2.p1.1.m1.1.1" xref="S2.I1.i2.p1.1.m1.1.1.cmml"><mi id="S2.I1.i2.p1.1.m1.1.1.2" xref="S2.I1.i2.p1.1.m1.1.1.2.cmml">π</mi><mtext id="S2.I1.i2.p1.1.m1.1.1.3" xref="S2.I1.i2.p1.1.m1.1.1.3a.cmml">ref</mtext></msub><annotation-xml encoding="MathML-Content" id="S2.I1.i2.p1.1.m1.1b"><apply id="S2.I1.i2.p1.1.m1.1.1.cmml" xref="S2.I1.i2.p1.1.m1.1.1"><csymbol cd="ambiguous" id="S2.I1.i2.p1.1.m1.1.1.1.cmml" xref="S2.I1.i2.p1.1.m1.1.1">subscript</csymbol><ci id="S2.I1.i2.p1.1.m1.1.1.2.cmml" xref="S2.I1.i2.p1.1.m1.1.1.2">𝜋</ci><ci id="S2.I1.i2.p1.1.m1.1.1.3a.cmml" xref="S2.I1.i2.p1.1.m1.1.1.3"><mtext id="S2.I1.i2.p1.1.m1.1.1.3.cmml" mathsize="70%" xref="S2.I1.i2.p1.1.m1.1.1.3">ref</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.I1.i2.p1.1.m1.1c">\pi_{\text{ref}}</annotation><annotation encoding="application/x-llamapun" id="S2.I1.i2.p1.1.m1.1d">italic_π start_POSTSUBSCRIPT ref end_POSTSUBSCRIPT</annotation></semantics></math> is employed to optimise <math alttext="\pi" class="ltx_Math" display="inline" id="S2.I1.i2.p1.2.m2.1"><semantics id="S2.I1.i2.p1.2.m2.1a"><mi id="S2.I1.i2.p1.2.m2.1.1" xref="S2.I1.i2.p1.2.m2.1.1.cmml">π</mi><annotation-xml encoding="MathML-Content" id="S2.I1.i2.p1.2.m2.1b"><ci id="S2.I1.i2.p1.2.m2.1.1.cmml" xref="S2.I1.i2.p1.2.m2.1.1">𝜋</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.I1.i2.p1.2.m2.1c">\pi</annotation><annotation encoding="application/x-llamapun" id="S2.I1.i2.p1.2.m2.1d">italic_π</annotation></semantics></math> for a downstream task. Typically, the <math alttext="\pi_{\text{ref}}" class="ltx_Math" display="inline" id="S2.I1.i2.p1.3.m3.1"><semantics id="S2.I1.i2.p1.3.m3.1a"><msub id="S2.I1.i2.p1.3.m3.1.1" xref="S2.I1.i2.p1.3.m3.1.1.cmml"><mi id="S2.I1.i2.p1.3.m3.1.1.2" xref="S2.I1.i2.p1.3.m3.1.1.2.cmml">π</mi><mtext id="S2.I1.i2.p1.3.m3.1.1.3" xref="S2.I1.i2.p1.3.m3.1.1.3a.cmml">ref</mtext></msub><annotation-xml encoding="MathML-Content" id="S2.I1.i2.p1.3.m3.1b"><apply id="S2.I1.i2.p1.3.m3.1.1.cmml" xref="S2.I1.i2.p1.3.m3.1.1"><csymbol cd="ambiguous" id="S2.I1.i2.p1.3.m3.1.1.1.cmml" xref="S2.I1.i2.p1.3.m3.1.1">subscript</csymbol><ci id="S2.I1.i2.p1.3.m3.1.1.2.cmml" xref="S2.I1.i2.p1.3.m3.1.1.2">𝜋</ci><ci id="S2.I1.i2.p1.3.m3.1.1.3a.cmml" xref="S2.I1.i2.p1.3.m3.1.1.3"><mtext id="S2.I1.i2.p1.3.m3.1.1.3.cmml" mathsize="70%" xref="S2.I1.i2.p1.3.m3.1.1.3">ref</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.I1.i2.p1.3.m3.1c">\pi_{\text{ref}}</annotation><annotation encoding="application/x-llamapun" id="S2.I1.i2.p1.3.m3.1d">italic_π start_POSTSUBSCRIPT ref end_POSTSUBSCRIPT</annotation></semantics></math> model undergoes fine-tuning with an auto-regressive objective, using data pertinent to the downstream task. This often involves instruction tuning <math alttext="\pi_{\text{ref}}" class="ltx_Math" display="inline" id="S2.I1.i2.p1.4.m4.1"><semantics id="S2.I1.i2.p1.4.m4.1a"><msub id="S2.I1.i2.p1.4.m4.1.1" xref="S2.I1.i2.p1.4.m4.1.1.cmml"><mi id="S2.I1.i2.p1.4.m4.1.1.2" xref="S2.I1.i2.p1.4.m4.1.1.2.cmml">π</mi><mtext id="S2.I1.i2.p1.4.m4.1.1.3" xref="S2.I1.i2.p1.4.m4.1.1.3a.cmml">ref</mtext></msub><annotation-xml encoding="MathML-Content" id="S2.I1.i2.p1.4.m4.1b"><apply id="S2.I1.i2.p1.4.m4.1.1.cmml" xref="S2.I1.i2.p1.4.m4.1.1"><csymbol cd="ambiguous" id="S2.I1.i2.p1.4.m4.1.1.1.cmml" xref="S2.I1.i2.p1.4.m4.1.1">subscript</csymbol><ci id="S2.I1.i2.p1.4.m4.1.1.2.cmml" xref="S2.I1.i2.p1.4.m4.1.1.2">𝜋</ci><ci id="S2.I1.i2.p1.4.m4.1.1.3a.cmml" xref="S2.I1.i2.p1.4.m4.1.1.3"><mtext id="S2.I1.i2.p1.4.m4.1.1.3.cmml" mathsize="70%" xref="S2.I1.i2.p1.4.m4.1.1.3">ref</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.I1.i2.p1.4.m4.1c">\pi_{\text{ref}}</annotation><annotation encoding="application/x-llamapun" id="S2.I1.i2.p1.4.m4.1d">italic_π start_POSTSUBSCRIPT ref end_POSTSUBSCRIPT</annotation></semantics></math> to regulate the generated outputs.</p>
</div>
</li>
<li class="ltx_item" id="S2.I1.i3" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S2.I1.i3.p1">
<p class="ltx_p" id="S2.I1.i3.p1.10"><span class="ltx_text ltx_font_bold" id="S2.I1.i3.p1.10.1">Optimisation:</span>
The optimisation of <math alttext="\pi" class="ltx_Math" display="inline" id="S2.I1.i3.p1.1.m1.1"><semantics id="S2.I1.i3.p1.1.m1.1a"><mi id="S2.I1.i3.p1.1.m1.1.1" xref="S2.I1.i3.p1.1.m1.1.1.cmml">π</mi><annotation-xml encoding="MathML-Content" id="S2.I1.i3.p1.1.m1.1b"><ci id="S2.I1.i3.p1.1.m1.1.1.cmml" xref="S2.I1.i3.p1.1.m1.1.1">𝜋</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.I1.i3.p1.1.m1.1c">\pi</annotation><annotation encoding="application/x-llamapun" id="S2.I1.i3.p1.1.m1.1d">italic_π</annotation></semantics></math> with respect to <math alttext="\pi_{\text{ref}}" class="ltx_Math" display="inline" id="S2.I1.i3.p1.2.m2.1"><semantics id="S2.I1.i3.p1.2.m2.1a"><msub id="S2.I1.i3.p1.2.m2.1.1" xref="S2.I1.i3.p1.2.m2.1.1.cmml"><mi id="S2.I1.i3.p1.2.m2.1.1.2" xref="S2.I1.i3.p1.2.m2.1.1.2.cmml">π</mi><mtext id="S2.I1.i3.p1.2.m2.1.1.3" xref="S2.I1.i3.p1.2.m2.1.1.3a.cmml">ref</mtext></msub><annotation-xml encoding="MathML-Content" id="S2.I1.i3.p1.2.m2.1b"><apply id="S2.I1.i3.p1.2.m2.1.1.cmml" xref="S2.I1.i3.p1.2.m2.1.1"><csymbol cd="ambiguous" id="S2.I1.i3.p1.2.m2.1.1.1.cmml" xref="S2.I1.i3.p1.2.m2.1.1">subscript</csymbol><ci id="S2.I1.i3.p1.2.m2.1.1.2.cmml" xref="S2.I1.i3.p1.2.m2.1.1.2">𝜋</ci><ci id="S2.I1.i3.p1.2.m2.1.1.3a.cmml" xref="S2.I1.i3.p1.2.m2.1.1.3"><mtext id="S2.I1.i3.p1.2.m2.1.1.3.cmml" mathsize="70%" xref="S2.I1.i3.p1.2.m2.1.1.3">ref</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.I1.i3.p1.2.m2.1c">\pi_{\text{ref}}</annotation><annotation encoding="application/x-llamapun" id="S2.I1.i3.p1.2.m2.1d">italic_π start_POSTSUBSCRIPT ref end_POSTSUBSCRIPT</annotation></semantics></math> operates on a triple dataset <math alttext="\mathcal{D}=\{x,y_{w},y_{l}\}" class="ltx_Math" display="inline" id="S2.I1.i3.p1.3.m3.3"><semantics id="S2.I1.i3.p1.3.m3.3a"><mrow id="S2.I1.i3.p1.3.m3.3.3" xref="S2.I1.i3.p1.3.m3.3.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S2.I1.i3.p1.3.m3.3.3.4" xref="S2.I1.i3.p1.3.m3.3.3.4.cmml">𝒟</mi><mo id="S2.I1.i3.p1.3.m3.3.3.3" xref="S2.I1.i3.p1.3.m3.3.3.3.cmml">=</mo><mrow id="S2.I1.i3.p1.3.m3.3.3.2.2" xref="S2.I1.i3.p1.3.m3.3.3.2.3.cmml"><mo id="S2.I1.i3.p1.3.m3.3.3.2.2.3" stretchy="false" xref="S2.I1.i3.p1.3.m3.3.3.2.3.cmml">{</mo><mi id="S2.I1.i3.p1.3.m3.1.1" xref="S2.I1.i3.p1.3.m3.1.1.cmml">x</mi><mo id="S2.I1.i3.p1.3.m3.3.3.2.2.4" xref="S2.I1.i3.p1.3.m3.3.3.2.3.cmml">,</mo><msub id="S2.I1.i3.p1.3.m3.2.2.1.1.1" xref="S2.I1.i3.p1.3.m3.2.2.1.1.1.cmml"><mi id="S2.I1.i3.p1.3.m3.2.2.1.1.1.2" xref="S2.I1.i3.p1.3.m3.2.2.1.1.1.2.cmml">y</mi><mi id="S2.I1.i3.p1.3.m3.2.2.1.1.1.3" xref="S2.I1.i3.p1.3.m3.2.2.1.1.1.3.cmml">w</mi></msub><mo id="S2.I1.i3.p1.3.m3.3.3.2.2.5" xref="S2.I1.i3.p1.3.m3.3.3.2.3.cmml">,</mo><msub id="S2.I1.i3.p1.3.m3.3.3.2.2.2" xref="S2.I1.i3.p1.3.m3.3.3.2.2.2.cmml"><mi id="S2.I1.i3.p1.3.m3.3.3.2.2.2.2" xref="S2.I1.i3.p1.3.m3.3.3.2.2.2.2.cmml">y</mi><mi id="S2.I1.i3.p1.3.m3.3.3.2.2.2.3" xref="S2.I1.i3.p1.3.m3.3.3.2.2.2.3.cmml">l</mi></msub><mo id="S2.I1.i3.p1.3.m3.3.3.2.2.6" stretchy="false" xref="S2.I1.i3.p1.3.m3.3.3.2.3.cmml">}</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.I1.i3.p1.3.m3.3b"><apply id="S2.I1.i3.p1.3.m3.3.3.cmml" xref="S2.I1.i3.p1.3.m3.3.3"><eq id="S2.I1.i3.p1.3.m3.3.3.3.cmml" xref="S2.I1.i3.p1.3.m3.3.3.3"></eq><ci id="S2.I1.i3.p1.3.m3.3.3.4.cmml" xref="S2.I1.i3.p1.3.m3.3.3.4">𝒟</ci><set id="S2.I1.i3.p1.3.m3.3.3.2.3.cmml" xref="S2.I1.i3.p1.3.m3.3.3.2.2"><ci id="S2.I1.i3.p1.3.m3.1.1.cmml" xref="S2.I1.i3.p1.3.m3.1.1">𝑥</ci><apply id="S2.I1.i3.p1.3.m3.2.2.1.1.1.cmml" xref="S2.I1.i3.p1.3.m3.2.2.1.1.1"><csymbol cd="ambiguous" id="S2.I1.i3.p1.3.m3.2.2.1.1.1.1.cmml" xref="S2.I1.i3.p1.3.m3.2.2.1.1.1">subscript</csymbol><ci id="S2.I1.i3.p1.3.m3.2.2.1.1.1.2.cmml" xref="S2.I1.i3.p1.3.m3.2.2.1.1.1.2">𝑦</ci><ci id="S2.I1.i3.p1.3.m3.2.2.1.1.1.3.cmml" xref="S2.I1.i3.p1.3.m3.2.2.1.1.1.3">𝑤</ci></apply><apply id="S2.I1.i3.p1.3.m3.3.3.2.2.2.cmml" xref="S2.I1.i3.p1.3.m3.3.3.2.2.2"><csymbol cd="ambiguous" id="S2.I1.i3.p1.3.m3.3.3.2.2.2.1.cmml" xref="S2.I1.i3.p1.3.m3.3.3.2.2.2">subscript</csymbol><ci id="S2.I1.i3.p1.3.m3.3.3.2.2.2.2.cmml" xref="S2.I1.i3.p1.3.m3.3.3.2.2.2.2">𝑦</ci><ci id="S2.I1.i3.p1.3.m3.3.3.2.2.2.3.cmml" xref="S2.I1.i3.p1.3.m3.3.3.2.2.2.3">𝑙</ci></apply></set></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.I1.i3.p1.3.m3.3c">\mathcal{D}=\{x,y_{w},y_{l}\}</annotation><annotation encoding="application/x-llamapun" id="S2.I1.i3.p1.3.m3.3d">caligraphic_D = { italic_x , italic_y start_POSTSUBSCRIPT italic_w end_POSTSUBSCRIPT , italic_y start_POSTSUBSCRIPT italic_l end_POSTSUBSCRIPT }</annotation></semantics></math>, where <math alttext="x" class="ltx_Math" display="inline" id="S2.I1.i3.p1.4.m4.1"><semantics id="S2.I1.i3.p1.4.m4.1a"><mi id="S2.I1.i3.p1.4.m4.1.1" xref="S2.I1.i3.p1.4.m4.1.1.cmml">x</mi><annotation-xml encoding="MathML-Content" id="S2.I1.i3.p1.4.m4.1b"><ci id="S2.I1.i3.p1.4.m4.1.1.cmml" xref="S2.I1.i3.p1.4.m4.1.1">𝑥</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.I1.i3.p1.4.m4.1c">x</annotation><annotation encoding="application/x-llamapun" id="S2.I1.i3.p1.4.m4.1d">italic_x</annotation></semantics></math> represents the input, and <math alttext="y_{w}" class="ltx_Math" display="inline" id="S2.I1.i3.p1.5.m5.1"><semantics id="S2.I1.i3.p1.5.m5.1a"><msub id="S2.I1.i3.p1.5.m5.1.1" xref="S2.I1.i3.p1.5.m5.1.1.cmml"><mi id="S2.I1.i3.p1.5.m5.1.1.2" xref="S2.I1.i3.p1.5.m5.1.1.2.cmml">y</mi><mi id="S2.I1.i3.p1.5.m5.1.1.3" xref="S2.I1.i3.p1.5.m5.1.1.3.cmml">w</mi></msub><annotation-xml encoding="MathML-Content" id="S2.I1.i3.p1.5.m5.1b"><apply id="S2.I1.i3.p1.5.m5.1.1.cmml" xref="S2.I1.i3.p1.5.m5.1.1"><csymbol cd="ambiguous" id="S2.I1.i3.p1.5.m5.1.1.1.cmml" xref="S2.I1.i3.p1.5.m5.1.1">subscript</csymbol><ci id="S2.I1.i3.p1.5.m5.1.1.2.cmml" xref="S2.I1.i3.p1.5.m5.1.1.2">𝑦</ci><ci id="S2.I1.i3.p1.5.m5.1.1.3.cmml" xref="S2.I1.i3.p1.5.m5.1.1.3">𝑤</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.I1.i3.p1.5.m5.1c">y_{w}</annotation><annotation encoding="application/x-llamapun" id="S2.I1.i3.p1.5.m5.1d">italic_y start_POSTSUBSCRIPT italic_w end_POSTSUBSCRIPT</annotation></semantics></math> and <math alttext="y_{l}" class="ltx_Math" display="inline" id="S2.I1.i3.p1.6.m6.1"><semantics id="S2.I1.i3.p1.6.m6.1a"><msub id="S2.I1.i3.p1.6.m6.1.1" xref="S2.I1.i3.p1.6.m6.1.1.cmml"><mi id="S2.I1.i3.p1.6.m6.1.1.2" xref="S2.I1.i3.p1.6.m6.1.1.2.cmml">y</mi><mi id="S2.I1.i3.p1.6.m6.1.1.3" xref="S2.I1.i3.p1.6.m6.1.1.3.cmml">l</mi></msub><annotation-xml encoding="MathML-Content" id="S2.I1.i3.p1.6.m6.1b"><apply id="S2.I1.i3.p1.6.m6.1.1.cmml" xref="S2.I1.i3.p1.6.m6.1.1"><csymbol cd="ambiguous" id="S2.I1.i3.p1.6.m6.1.1.1.cmml" xref="S2.I1.i3.p1.6.m6.1.1">subscript</csymbol><ci id="S2.I1.i3.p1.6.m6.1.1.2.cmml" xref="S2.I1.i3.p1.6.m6.1.1.2">𝑦</ci><ci id="S2.I1.i3.p1.6.m6.1.1.3.cmml" xref="S2.I1.i3.p1.6.m6.1.1.3">𝑙</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.I1.i3.p1.6.m6.1c">y_{l}</annotation><annotation encoding="application/x-llamapun" id="S2.I1.i3.p1.6.m6.1d">italic_y start_POSTSUBSCRIPT italic_l end_POSTSUBSCRIPT</annotation></semantics></math> denote preferred and dis-preferred outputs, respectively, such that <math alttext="y_{w}\succ y_{l}" class="ltx_Math" display="inline" id="S2.I1.i3.p1.7.m7.1"><semantics id="S2.I1.i3.p1.7.m7.1a"><mrow id="S2.I1.i3.p1.7.m7.1.1" xref="S2.I1.i3.p1.7.m7.1.1.cmml"><msub id="S2.I1.i3.p1.7.m7.1.1.2" xref="S2.I1.i3.p1.7.m7.1.1.2.cmml"><mi id="S2.I1.i3.p1.7.m7.1.1.2.2" xref="S2.I1.i3.p1.7.m7.1.1.2.2.cmml">y</mi><mi id="S2.I1.i3.p1.7.m7.1.1.2.3" xref="S2.I1.i3.p1.7.m7.1.1.2.3.cmml">w</mi></msub><mo id="S2.I1.i3.p1.7.m7.1.1.1" xref="S2.I1.i3.p1.7.m7.1.1.1.cmml">≻</mo><msub id="S2.I1.i3.p1.7.m7.1.1.3" xref="S2.I1.i3.p1.7.m7.1.1.3.cmml"><mi id="S2.I1.i3.p1.7.m7.1.1.3.2" xref="S2.I1.i3.p1.7.m7.1.1.3.2.cmml">y</mi><mi id="S2.I1.i3.p1.7.m7.1.1.3.3" xref="S2.I1.i3.p1.7.m7.1.1.3.3.cmml">l</mi></msub></mrow><annotation-xml encoding="MathML-Content" id="S2.I1.i3.p1.7.m7.1b"><apply id="S2.I1.i3.p1.7.m7.1.1.cmml" xref="S2.I1.i3.p1.7.m7.1.1"><csymbol cd="latexml" id="S2.I1.i3.p1.7.m7.1.1.1.cmml" xref="S2.I1.i3.p1.7.m7.1.1.1">succeeds</csymbol><apply id="S2.I1.i3.p1.7.m7.1.1.2.cmml" xref="S2.I1.i3.p1.7.m7.1.1.2"><csymbol cd="ambiguous" id="S2.I1.i3.p1.7.m7.1.1.2.1.cmml" xref="S2.I1.i3.p1.7.m7.1.1.2">subscript</csymbol><ci id="S2.I1.i3.p1.7.m7.1.1.2.2.cmml" xref="S2.I1.i3.p1.7.m7.1.1.2.2">𝑦</ci><ci id="S2.I1.i3.p1.7.m7.1.1.2.3.cmml" xref="S2.I1.i3.p1.7.m7.1.1.2.3">𝑤</ci></apply><apply id="S2.I1.i3.p1.7.m7.1.1.3.cmml" xref="S2.I1.i3.p1.7.m7.1.1.3"><csymbol cd="ambiguous" id="S2.I1.i3.p1.7.m7.1.1.3.1.cmml" xref="S2.I1.i3.p1.7.m7.1.1.3">subscript</csymbol><ci id="S2.I1.i3.p1.7.m7.1.1.3.2.cmml" xref="S2.I1.i3.p1.7.m7.1.1.3.2">𝑦</ci><ci id="S2.I1.i3.p1.7.m7.1.1.3.3.cmml" xref="S2.I1.i3.p1.7.m7.1.1.3.3">𝑙</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.I1.i3.p1.7.m7.1c">y_{w}\succ y_{l}</annotation><annotation encoding="application/x-llamapun" id="S2.I1.i3.p1.7.m7.1d">italic_y start_POSTSUBSCRIPT italic_w end_POSTSUBSCRIPT ≻ italic_y start_POSTSUBSCRIPT italic_l end_POSTSUBSCRIPT</annotation></semantics></math> for <math alttext="x" class="ltx_Math" display="inline" id="S2.I1.i3.p1.8.m8.1"><semantics id="S2.I1.i3.p1.8.m8.1a"><mi id="S2.I1.i3.p1.8.m8.1.1" xref="S2.I1.i3.p1.8.m8.1.1.cmml">x</mi><annotation-xml encoding="MathML-Content" id="S2.I1.i3.p1.8.m8.1b"><ci id="S2.I1.i3.p1.8.m8.1.1.cmml" xref="S2.I1.i3.p1.8.m8.1.1">𝑥</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.I1.i3.p1.8.m8.1c">x</annotation><annotation encoding="application/x-llamapun" id="S2.I1.i3.p1.8.m8.1d">italic_x</annotation></semantics></math>. In <cite class="ltx_cite ltx_citemacro_cite">Bradley and Terry (<a class="ltx_ref" href="https://arxiv.org/html/2405.13984v1#bib.bib2" title="">1952</a>)</cite>, the probability of <math alttext="y_{w}" class="ltx_Math" display="inline" id="S2.I1.i3.p1.9.m9.1"><semantics id="S2.I1.i3.p1.9.m9.1a"><msub id="S2.I1.i3.p1.9.m9.1.1" xref="S2.I1.i3.p1.9.m9.1.1.cmml"><mi id="S2.I1.i3.p1.9.m9.1.1.2" xref="S2.I1.i3.p1.9.m9.1.1.2.cmml">y</mi><mi id="S2.I1.i3.p1.9.m9.1.1.3" xref="S2.I1.i3.p1.9.m9.1.1.3.cmml">w</mi></msub><annotation-xml encoding="MathML-Content" id="S2.I1.i3.p1.9.m9.1b"><apply id="S2.I1.i3.p1.9.m9.1.1.cmml" xref="S2.I1.i3.p1.9.m9.1.1"><csymbol cd="ambiguous" id="S2.I1.i3.p1.9.m9.1.1.1.cmml" xref="S2.I1.i3.p1.9.m9.1.1">subscript</csymbol><ci id="S2.I1.i3.p1.9.m9.1.1.2.cmml" xref="S2.I1.i3.p1.9.m9.1.1.2">𝑦</ci><ci id="S2.I1.i3.p1.9.m9.1.1.3.cmml" xref="S2.I1.i3.p1.9.m9.1.1.3">𝑤</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.I1.i3.p1.9.m9.1c">y_{w}</annotation><annotation encoding="application/x-llamapun" id="S2.I1.i3.p1.9.m9.1d">italic_y start_POSTSUBSCRIPT italic_w end_POSTSUBSCRIPT</annotation></semantics></math> being preferred over <math alttext="y_{l}" class="ltx_Math" display="inline" id="S2.I1.i3.p1.10.m10.1"><semantics id="S2.I1.i3.p1.10.m10.1a"><msub id="S2.I1.i3.p1.10.m10.1.1" xref="S2.I1.i3.p1.10.m10.1.1.cmml"><mi id="S2.I1.i3.p1.10.m10.1.1.2" xref="S2.I1.i3.p1.10.m10.1.1.2.cmml">y</mi><mi id="S2.I1.i3.p1.10.m10.1.1.3" xref="S2.I1.i3.p1.10.m10.1.1.3.cmml">l</mi></msub><annotation-xml encoding="MathML-Content" id="S2.I1.i3.p1.10.m10.1b"><apply id="S2.I1.i3.p1.10.m10.1.1.cmml" xref="S2.I1.i3.p1.10.m10.1.1"><csymbol cd="ambiguous" id="S2.I1.i3.p1.10.m10.1.1.1.cmml" xref="S2.I1.i3.p1.10.m10.1.1">subscript</csymbol><ci id="S2.I1.i3.p1.10.m10.1.1.2.cmml" xref="S2.I1.i3.p1.10.m10.1.1.2">𝑦</ci><ci id="S2.I1.i3.p1.10.m10.1.1.3.cmml" xref="S2.I1.i3.p1.10.m10.1.1.3">𝑙</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.I1.i3.p1.10.m10.1c">y_{l}</annotation><annotation encoding="application/x-llamapun" id="S2.I1.i3.p1.10.m10.1d">italic_y start_POSTSUBSCRIPT italic_l end_POSTSUBSCRIPT</annotation></semantics></math> in pairwise comparisons can be formulated as follows:</p>
<table class="ltx_equation ltx_eqn_table" id="S2.E1">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="p^{*}(y_{w}\succ y_{l}|x)=\sigma(r^{*}(x,y_{w})-r^{*}(x,y_{l}))" class="ltx_Math" display="block" id="S2.E1.m1.4"><semantics id="S2.E1.m1.4a"><mrow id="S2.E1.m1.4.4" xref="S2.E1.m1.4.4.cmml"><mrow id="S2.E1.m1.3.3.1" xref="S2.E1.m1.3.3.1.cmml"><msup id="S2.E1.m1.3.3.1.3" xref="S2.E1.m1.3.3.1.3.cmml"><mi id="S2.E1.m1.3.3.1.3.2" xref="S2.E1.m1.3.3.1.3.2.cmml">p</mi><mo id="S2.E1.m1.3.3.1.3.3" xref="S2.E1.m1.3.3.1.3.3.cmml">∗</mo></msup><mo id="S2.E1.m1.3.3.1.2" xref="S2.E1.m1.3.3.1.2.cmml">⁢</mo><mrow id="S2.E1.m1.3.3.1.1.1" xref="S2.E1.m1.3.3.1.1.1.1.cmml"><mo id="S2.E1.m1.3.3.1.1.1.2" stretchy="false" xref="S2.E1.m1.3.3.1.1.1.1.cmml">(</mo><mrow id="S2.E1.m1.3.3.1.1.1.1" xref="S2.E1.m1.3.3.1.1.1.1.cmml"><msub id="S2.E1.m1.3.3.1.1.1.1.2" xref="S2.E1.m1.3.3.1.1.1.1.2.cmml"><mi id="S2.E1.m1.3.3.1.1.1.1.2.2" xref="S2.E1.m1.3.3.1.1.1.1.2.2.cmml">y</mi><mi id="S2.E1.m1.3.3.1.1.1.1.2.3" xref="S2.E1.m1.3.3.1.1.1.1.2.3.cmml">w</mi></msub><mo id="S2.E1.m1.3.3.1.1.1.1.1" xref="S2.E1.m1.3.3.1.1.1.1.1.cmml">≻</mo><mrow id="S2.E1.m1.3.3.1.1.1.1.3" xref="S2.E1.m1.3.3.1.1.1.1.3.cmml"><msub id="S2.E1.m1.3.3.1.1.1.1.3.2" xref="S2.E1.m1.3.3.1.1.1.1.3.2.cmml"><mi id="S2.E1.m1.3.3.1.1.1.1.3.2.2" xref="S2.E1.m1.3.3.1.1.1.1.3.2.2.cmml">y</mi><mi id="S2.E1.m1.3.3.1.1.1.1.3.2.3" xref="S2.E1.m1.3.3.1.1.1.1.3.2.3.cmml">l</mi></msub><mo fence="false" id="S2.E1.m1.3.3.1.1.1.1.3.1" xref="S2.E1.m1.3.3.1.1.1.1.3.1.cmml">|</mo><mi id="S2.E1.m1.3.3.1.1.1.1.3.3" xref="S2.E1.m1.3.3.1.1.1.1.3.3.cmml">x</mi></mrow></mrow><mo id="S2.E1.m1.3.3.1.1.1.3" stretchy="false" xref="S2.E1.m1.3.3.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S2.E1.m1.4.4.3" xref="S2.E1.m1.4.4.3.cmml">=</mo><mrow id="S2.E1.m1.4.4.2" xref="S2.E1.m1.4.4.2.cmml"><mi id="S2.E1.m1.4.4.2.3" xref="S2.E1.m1.4.4.2.3.cmml">σ</mi><mo id="S2.E1.m1.4.4.2.2" xref="S2.E1.m1.4.4.2.2.cmml">⁢</mo><mrow id="S2.E1.m1.4.4.2.1.1" xref="S2.E1.m1.4.4.2.1.1.1.cmml"><mo id="S2.E1.m1.4.4.2.1.1.2" stretchy="false" xref="S2.E1.m1.4.4.2.1.1.1.cmml">(</mo><mrow id="S2.E1.m1.4.4.2.1.1.1" xref="S2.E1.m1.4.4.2.1.1.1.cmml"><mrow id="S2.E1.m1.4.4.2.1.1.1.1" xref="S2.E1.m1.4.4.2.1.1.1.1.cmml"><msup id="S2.E1.m1.4.4.2.1.1.1.1.3" xref="S2.E1.m1.4.4.2.1.1.1.1.3.cmml"><mi id="S2.E1.m1.4.4.2.1.1.1.1.3.2" xref="S2.E1.m1.4.4.2.1.1.1.1.3.2.cmml">r</mi><mo id="S2.E1.m1.4.4.2.1.1.1.1.3.3" xref="S2.E1.m1.4.4.2.1.1.1.1.3.3.cmml">∗</mo></msup><mo id="S2.E1.m1.4.4.2.1.1.1.1.2" xref="S2.E1.m1.4.4.2.1.1.1.1.2.cmml">⁢</mo><mrow id="S2.E1.m1.4.4.2.1.1.1.1.1.1" xref="S2.E1.m1.4.4.2.1.1.1.1.1.2.cmml"><mo id="S2.E1.m1.4.4.2.1.1.1.1.1.1.2" stretchy="false" xref="S2.E1.m1.4.4.2.1.1.1.1.1.2.cmml">(</mo><mi id="S2.E1.m1.1.1" xref="S2.E1.m1.1.1.cmml">x</mi><mo id="S2.E1.m1.4.4.2.1.1.1.1.1.1.3" xref="S2.E1.m1.4.4.2.1.1.1.1.1.2.cmml">,</mo><msub id="S2.E1.m1.4.4.2.1.1.1.1.1.1.1" xref="S2.E1.m1.4.4.2.1.1.1.1.1.1.1.cmml"><mi id="S2.E1.m1.4.4.2.1.1.1.1.1.1.1.2" xref="S2.E1.m1.4.4.2.1.1.1.1.1.1.1.2.cmml">y</mi><mi id="S2.E1.m1.4.4.2.1.1.1.1.1.1.1.3" xref="S2.E1.m1.4.4.2.1.1.1.1.1.1.1.3.cmml">w</mi></msub><mo id="S2.E1.m1.4.4.2.1.1.1.1.1.1.4" stretchy="false" xref="S2.E1.m1.4.4.2.1.1.1.1.1.2.cmml">)</mo></mrow></mrow><mo id="S2.E1.m1.4.4.2.1.1.1.3" xref="S2.E1.m1.4.4.2.1.1.1.3.cmml">−</mo><mrow id="S2.E1.m1.4.4.2.1.1.1.2" xref="S2.E1.m1.4.4.2.1.1.1.2.cmml"><msup id="S2.E1.m1.4.4.2.1.1.1.2.3" xref="S2.E1.m1.4.4.2.1.1.1.2.3.cmml"><mi id="S2.E1.m1.4.4.2.1.1.1.2.3.2" xref="S2.E1.m1.4.4.2.1.1.1.2.3.2.cmml">r</mi><mo id="S2.E1.m1.4.4.2.1.1.1.2.3.3" xref="S2.E1.m1.4.4.2.1.1.1.2.3.3.cmml">∗</mo></msup><mo id="S2.E1.m1.4.4.2.1.1.1.2.2" xref="S2.E1.m1.4.4.2.1.1.1.2.2.cmml">⁢</mo><mrow id="S2.E1.m1.4.4.2.1.1.1.2.1.1" xref="S2.E1.m1.4.4.2.1.1.1.2.1.2.cmml"><mo id="S2.E1.m1.4.4.2.1.1.1.2.1.1.2" stretchy="false" xref="S2.E1.m1.4.4.2.1.1.1.2.1.2.cmml">(</mo><mi id="S2.E1.m1.2.2" xref="S2.E1.m1.2.2.cmml">x</mi><mo id="S2.E1.m1.4.4.2.1.1.1.2.1.1.3" xref="S2.E1.m1.4.4.2.1.1.1.2.1.2.cmml">,</mo><msub id="S2.E1.m1.4.4.2.1.1.1.2.1.1.1" xref="S2.E1.m1.4.4.2.1.1.1.2.1.1.1.cmml"><mi id="S2.E1.m1.4.4.2.1.1.1.2.1.1.1.2" xref="S2.E1.m1.4.4.2.1.1.1.2.1.1.1.2.cmml">y</mi><mi id="S2.E1.m1.4.4.2.1.1.1.2.1.1.1.3" xref="S2.E1.m1.4.4.2.1.1.1.2.1.1.1.3.cmml">l</mi></msub><mo id="S2.E1.m1.4.4.2.1.1.1.2.1.1.4" stretchy="false" xref="S2.E1.m1.4.4.2.1.1.1.2.1.2.cmml">)</mo></mrow></mrow></mrow><mo id="S2.E1.m1.4.4.2.1.1.3" stretchy="false" xref="S2.E1.m1.4.4.2.1.1.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.E1.m1.4b"><apply id="S2.E1.m1.4.4.cmml" xref="S2.E1.m1.4.4"><eq id="S2.E1.m1.4.4.3.cmml" xref="S2.E1.m1.4.4.3"></eq><apply id="S2.E1.m1.3.3.1.cmml" xref="S2.E1.m1.3.3.1"><times id="S2.E1.m1.3.3.1.2.cmml" xref="S2.E1.m1.3.3.1.2"></times><apply id="S2.E1.m1.3.3.1.3.cmml" xref="S2.E1.m1.3.3.1.3"><csymbol cd="ambiguous" id="S2.E1.m1.3.3.1.3.1.cmml" xref="S2.E1.m1.3.3.1.3">superscript</csymbol><ci id="S2.E1.m1.3.3.1.3.2.cmml" xref="S2.E1.m1.3.3.1.3.2">𝑝</ci><times id="S2.E1.m1.3.3.1.3.3.cmml" xref="S2.E1.m1.3.3.1.3.3"></times></apply><apply id="S2.E1.m1.3.3.1.1.1.1.cmml" xref="S2.E1.m1.3.3.1.1.1"><csymbol cd="latexml" id="S2.E1.m1.3.3.1.1.1.1.1.cmml" xref="S2.E1.m1.3.3.1.1.1.1.1">succeeds</csymbol><apply id="S2.E1.m1.3.3.1.1.1.1.2.cmml" xref="S2.E1.m1.3.3.1.1.1.1.2"><csymbol cd="ambiguous" id="S2.E1.m1.3.3.1.1.1.1.2.1.cmml" xref="S2.E1.m1.3.3.1.1.1.1.2">subscript</csymbol><ci id="S2.E1.m1.3.3.1.1.1.1.2.2.cmml" xref="S2.E1.m1.3.3.1.1.1.1.2.2">𝑦</ci><ci id="S2.E1.m1.3.3.1.1.1.1.2.3.cmml" xref="S2.E1.m1.3.3.1.1.1.1.2.3">𝑤</ci></apply><apply id="S2.E1.m1.3.3.1.1.1.1.3.cmml" xref="S2.E1.m1.3.3.1.1.1.1.3"><csymbol cd="latexml" id="S2.E1.m1.3.3.1.1.1.1.3.1.cmml" xref="S2.E1.m1.3.3.1.1.1.1.3.1">conditional</csymbol><apply id="S2.E1.m1.3.3.1.1.1.1.3.2.cmml" xref="S2.E1.m1.3.3.1.1.1.1.3.2"><csymbol cd="ambiguous" id="S2.E1.m1.3.3.1.1.1.1.3.2.1.cmml" xref="S2.E1.m1.3.3.1.1.1.1.3.2">subscript</csymbol><ci id="S2.E1.m1.3.3.1.1.1.1.3.2.2.cmml" xref="S2.E1.m1.3.3.1.1.1.1.3.2.2">𝑦</ci><ci id="S2.E1.m1.3.3.1.1.1.1.3.2.3.cmml" xref="S2.E1.m1.3.3.1.1.1.1.3.2.3">𝑙</ci></apply><ci id="S2.E1.m1.3.3.1.1.1.1.3.3.cmml" xref="S2.E1.m1.3.3.1.1.1.1.3.3">𝑥</ci></apply></apply></apply><apply id="S2.E1.m1.4.4.2.cmml" xref="S2.E1.m1.4.4.2"><times id="S2.E1.m1.4.4.2.2.cmml" xref="S2.E1.m1.4.4.2.2"></times><ci id="S2.E1.m1.4.4.2.3.cmml" xref="S2.E1.m1.4.4.2.3">𝜎</ci><apply id="S2.E1.m1.4.4.2.1.1.1.cmml" xref="S2.E1.m1.4.4.2.1.1"><minus id="S2.E1.m1.4.4.2.1.1.1.3.cmml" xref="S2.E1.m1.4.4.2.1.1.1.3"></minus><apply id="S2.E1.m1.4.4.2.1.1.1.1.cmml" xref="S2.E1.m1.4.4.2.1.1.1.1"><times id="S2.E1.m1.4.4.2.1.1.1.1.2.cmml" xref="S2.E1.m1.4.4.2.1.1.1.1.2"></times><apply id="S2.E1.m1.4.4.2.1.1.1.1.3.cmml" xref="S2.E1.m1.4.4.2.1.1.1.1.3"><csymbol cd="ambiguous" id="S2.E1.m1.4.4.2.1.1.1.1.3.1.cmml" xref="S2.E1.m1.4.4.2.1.1.1.1.3">superscript</csymbol><ci id="S2.E1.m1.4.4.2.1.1.1.1.3.2.cmml" xref="S2.E1.m1.4.4.2.1.1.1.1.3.2">𝑟</ci><times id="S2.E1.m1.4.4.2.1.1.1.1.3.3.cmml" xref="S2.E1.m1.4.4.2.1.1.1.1.3.3"></times></apply><interval closure="open" id="S2.E1.m1.4.4.2.1.1.1.1.1.2.cmml" xref="S2.E1.m1.4.4.2.1.1.1.1.1.1"><ci id="S2.E1.m1.1.1.cmml" xref="S2.E1.m1.1.1">𝑥</ci><apply id="S2.E1.m1.4.4.2.1.1.1.1.1.1.1.cmml" xref="S2.E1.m1.4.4.2.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S2.E1.m1.4.4.2.1.1.1.1.1.1.1.1.cmml" xref="S2.E1.m1.4.4.2.1.1.1.1.1.1.1">subscript</csymbol><ci id="S2.E1.m1.4.4.2.1.1.1.1.1.1.1.2.cmml" xref="S2.E1.m1.4.4.2.1.1.1.1.1.1.1.2">𝑦</ci><ci id="S2.E1.m1.4.4.2.1.1.1.1.1.1.1.3.cmml" xref="S2.E1.m1.4.4.2.1.1.1.1.1.1.1.3">𝑤</ci></apply></interval></apply><apply id="S2.E1.m1.4.4.2.1.1.1.2.cmml" xref="S2.E1.m1.4.4.2.1.1.1.2"><times id="S2.E1.m1.4.4.2.1.1.1.2.2.cmml" xref="S2.E1.m1.4.4.2.1.1.1.2.2"></times><apply id="S2.E1.m1.4.4.2.1.1.1.2.3.cmml" xref="S2.E1.m1.4.4.2.1.1.1.2.3"><csymbol cd="ambiguous" id="S2.E1.m1.4.4.2.1.1.1.2.3.1.cmml" xref="S2.E1.m1.4.4.2.1.1.1.2.3">superscript</csymbol><ci id="S2.E1.m1.4.4.2.1.1.1.2.3.2.cmml" xref="S2.E1.m1.4.4.2.1.1.1.2.3.2">𝑟</ci><times id="S2.E1.m1.4.4.2.1.1.1.2.3.3.cmml" xref="S2.E1.m1.4.4.2.1.1.1.2.3.3"></times></apply><interval closure="open" id="S2.E1.m1.4.4.2.1.1.1.2.1.2.cmml" xref="S2.E1.m1.4.4.2.1.1.1.2.1.1"><ci id="S2.E1.m1.2.2.cmml" xref="S2.E1.m1.2.2">𝑥</ci><apply id="S2.E1.m1.4.4.2.1.1.1.2.1.1.1.cmml" xref="S2.E1.m1.4.4.2.1.1.1.2.1.1.1"><csymbol cd="ambiguous" id="S2.E1.m1.4.4.2.1.1.1.2.1.1.1.1.cmml" xref="S2.E1.m1.4.4.2.1.1.1.2.1.1.1">subscript</csymbol><ci id="S2.E1.m1.4.4.2.1.1.1.2.1.1.1.2.cmml" xref="S2.E1.m1.4.4.2.1.1.1.2.1.1.1.2">𝑦</ci><ci id="S2.E1.m1.4.4.2.1.1.1.2.1.1.1.3.cmml" xref="S2.E1.m1.4.4.2.1.1.1.2.1.1.1.3">𝑙</ci></apply></interval></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.E1.m1.4c">p^{*}(y_{w}\succ y_{l}|x)=\sigma(r^{*}(x,y_{w})-r^{*}(x,y_{l}))</annotation><annotation encoding="application/x-llamapun" id="S2.E1.m1.4d">italic_p start_POSTSUPERSCRIPT ∗ end_POSTSUPERSCRIPT ( italic_y start_POSTSUBSCRIPT italic_w end_POSTSUBSCRIPT ≻ italic_y start_POSTSUBSCRIPT italic_l end_POSTSUBSCRIPT | italic_x ) = italic_σ ( italic_r start_POSTSUPERSCRIPT ∗ end_POSTSUPERSCRIPT ( italic_x , italic_y start_POSTSUBSCRIPT italic_w end_POSTSUBSCRIPT ) - italic_r start_POSTSUPERSCRIPT ∗ end_POSTSUPERSCRIPT ( italic_x , italic_y start_POSTSUBSCRIPT italic_l end_POSTSUBSCRIPT ) )</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(1)</span></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S2.I1.i3.p1.13">Here, <math alttext="\sigma" class="ltx_Math" display="inline" id="S2.I1.i3.p1.11.m1.1"><semantics id="S2.I1.i3.p1.11.m1.1a"><mi id="S2.I1.i3.p1.11.m1.1.1" xref="S2.I1.i3.p1.11.m1.1.1.cmml">σ</mi><annotation-xml encoding="MathML-Content" id="S2.I1.i3.p1.11.m1.1b"><ci id="S2.I1.i3.p1.11.m1.1.1.cmml" xref="S2.I1.i3.p1.11.m1.1.1">𝜎</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.I1.i3.p1.11.m1.1c">\sigma</annotation><annotation encoding="application/x-llamapun" id="S2.I1.i3.p1.11.m1.1d">italic_σ</annotation></semantics></math> represents the logistic function, and <math alttext="r^{*}" class="ltx_Math" display="inline" id="S2.I1.i3.p1.12.m2.1"><semantics id="S2.I1.i3.p1.12.m2.1a"><msup id="S2.I1.i3.p1.12.m2.1.1" xref="S2.I1.i3.p1.12.m2.1.1.cmml"><mi id="S2.I1.i3.p1.12.m2.1.1.2" xref="S2.I1.i3.p1.12.m2.1.1.2.cmml">r</mi><mo id="S2.I1.i3.p1.12.m2.1.1.3" xref="S2.I1.i3.p1.12.m2.1.1.3.cmml">∗</mo></msup><annotation-xml encoding="MathML-Content" id="S2.I1.i3.p1.12.m2.1b"><apply id="S2.I1.i3.p1.12.m2.1.1.cmml" xref="S2.I1.i3.p1.12.m2.1.1"><csymbol cd="ambiguous" id="S2.I1.i3.p1.12.m2.1.1.1.cmml" xref="S2.I1.i3.p1.12.m2.1.1">superscript</csymbol><ci id="S2.I1.i3.p1.12.m2.1.1.2.cmml" xref="S2.I1.i3.p1.12.m2.1.1.2">𝑟</ci><times id="S2.I1.i3.p1.12.m2.1.1.3.cmml" xref="S2.I1.i3.p1.12.m2.1.1.3"></times></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.I1.i3.p1.12.m2.1c">r^{*}</annotation><annotation encoding="application/x-llamapun" id="S2.I1.i3.p1.12.m2.1d">italic_r start_POSTSUPERSCRIPT ∗ end_POSTSUPERSCRIPT</annotation></semantics></math> denotes the “true” reward function that underlies the preferences. As obtaining the true reward directly from a human would be prohibitively expensive, a reward model <math alttext="r_{\phi}" class="ltx_Math" display="inline" id="S2.I1.i3.p1.13.m3.1"><semantics id="S2.I1.i3.p1.13.m3.1a"><msub id="S2.I1.i3.p1.13.m3.1.1" xref="S2.I1.i3.p1.13.m3.1.1.cmml"><mi id="S2.I1.i3.p1.13.m3.1.1.2" xref="S2.I1.i3.p1.13.m3.1.1.2.cmml">r</mi><mi id="S2.I1.i3.p1.13.m3.1.1.3" xref="S2.I1.i3.p1.13.m3.1.1.3.cmml">ϕ</mi></msub><annotation-xml encoding="MathML-Content" id="S2.I1.i3.p1.13.m3.1b"><apply id="S2.I1.i3.p1.13.m3.1.1.cmml" xref="S2.I1.i3.p1.13.m3.1.1"><csymbol cd="ambiguous" id="S2.I1.i3.p1.13.m3.1.1.1.cmml" xref="S2.I1.i3.p1.13.m3.1.1">subscript</csymbol><ci id="S2.I1.i3.p1.13.m3.1.1.2.cmml" xref="S2.I1.i3.p1.13.m3.1.1.2">𝑟</ci><ci id="S2.I1.i3.p1.13.m3.1.1.3.cmml" xref="S2.I1.i3.p1.13.m3.1.1.3">italic-ϕ</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.I1.i3.p1.13.m3.1c">r_{\phi}</annotation><annotation encoding="application/x-llamapun" id="S2.I1.i3.p1.13.m3.1d">italic_r start_POSTSUBSCRIPT italic_ϕ end_POSTSUBSCRIPT</annotation></semantics></math> is trained to act as a surrogate. This is achieved by minimising the negative log-likelihood in human preference data;</p>
<table class="ltx_equation ltx_eqn_table" id="S2.E2">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\mathcal{L}(r_{\phi})=-\mathbb{E}_{(x,y_{w},y_{l})\sim\mathcal{D}}[\log\sigma(%
r_{\phi}(x,y_{w})-r_{\phi}(x,y_{l}))]" class="ltx_Math" display="block" id="S2.E2.m1.7"><semantics id="S2.E2.m1.7a"><mrow id="S2.E2.m1.7.7" xref="S2.E2.m1.7.7.cmml"><mrow id="S2.E2.m1.6.6.1" xref="S2.E2.m1.6.6.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S2.E2.m1.6.6.1.3" xref="S2.E2.m1.6.6.1.3.cmml">ℒ</mi><mo id="S2.E2.m1.6.6.1.2" xref="S2.E2.m1.6.6.1.2.cmml">⁢</mo><mrow id="S2.E2.m1.6.6.1.1.1" xref="S2.E2.m1.6.6.1.1.1.1.cmml"><mo id="S2.E2.m1.6.6.1.1.1.2" stretchy="false" xref="S2.E2.m1.6.6.1.1.1.1.cmml">(</mo><msub id="S2.E2.m1.6.6.1.1.1.1" xref="S2.E2.m1.6.6.1.1.1.1.cmml"><mi id="S2.E2.m1.6.6.1.1.1.1.2" xref="S2.E2.m1.6.6.1.1.1.1.2.cmml">r</mi><mi id="S2.E2.m1.6.6.1.1.1.1.3" xref="S2.E2.m1.6.6.1.1.1.1.3.cmml">ϕ</mi></msub><mo id="S2.E2.m1.6.6.1.1.1.3" stretchy="false" xref="S2.E2.m1.6.6.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S2.E2.m1.7.7.3" xref="S2.E2.m1.7.7.3.cmml">=</mo><mrow id="S2.E2.m1.7.7.2" xref="S2.E2.m1.7.7.2.cmml"><mo id="S2.E2.m1.7.7.2a" xref="S2.E2.m1.7.7.2.cmml">−</mo><mrow id="S2.E2.m1.7.7.2.1" xref="S2.E2.m1.7.7.2.1.cmml"><msub id="S2.E2.m1.7.7.2.1.3" xref="S2.E2.m1.7.7.2.1.3.cmml"><mi id="S2.E2.m1.7.7.2.1.3.2" mathvariant="normal" xref="S2.E2.m1.7.7.2.1.3.2.cmml">𝔼</mi><mrow id="S2.E2.m1.3.3.3" xref="S2.E2.m1.3.3.3.cmml"><mrow id="S2.E2.m1.3.3.3.3.2" xref="S2.E2.m1.3.3.3.3.3.cmml"><mo id="S2.E2.m1.3.3.3.3.2.3" stretchy="false" xref="S2.E2.m1.3.3.3.3.3.cmml">(</mo><mi id="S2.E2.m1.1.1.1.1" xref="S2.E2.m1.1.1.1.1.cmml">x</mi><mo id="S2.E2.m1.3.3.3.3.2.4" xref="S2.E2.m1.3.3.3.3.3.cmml">,</mo><msub id="S2.E2.m1.2.2.2.2.1.1" xref="S2.E2.m1.2.2.2.2.1.1.cmml"><mi id="S2.E2.m1.2.2.2.2.1.1.2" xref="S2.E2.m1.2.2.2.2.1.1.2.cmml">y</mi><mi id="S2.E2.m1.2.2.2.2.1.1.3" xref="S2.E2.m1.2.2.2.2.1.1.3.cmml">w</mi></msub><mo id="S2.E2.m1.3.3.3.3.2.5" xref="S2.E2.m1.3.3.3.3.3.cmml">,</mo><msub id="S2.E2.m1.3.3.3.3.2.2" xref="S2.E2.m1.3.3.3.3.2.2.cmml"><mi id="S2.E2.m1.3.3.3.3.2.2.2" xref="S2.E2.m1.3.3.3.3.2.2.2.cmml">y</mi><mi id="S2.E2.m1.3.3.3.3.2.2.3" xref="S2.E2.m1.3.3.3.3.2.2.3.cmml">l</mi></msub><mo id="S2.E2.m1.3.3.3.3.2.6" stretchy="false" xref="S2.E2.m1.3.3.3.3.3.cmml">)</mo></mrow><mo id="S2.E2.m1.3.3.3.4" xref="S2.E2.m1.3.3.3.4.cmml">∼</mo><mi class="ltx_font_mathcaligraphic" id="S2.E2.m1.3.3.3.5" xref="S2.E2.m1.3.3.3.5.cmml">𝒟</mi></mrow></msub><mo id="S2.E2.m1.7.7.2.1.2" xref="S2.E2.m1.7.7.2.1.2.cmml">⁢</mo><mrow id="S2.E2.m1.7.7.2.1.1.1" xref="S2.E2.m1.7.7.2.1.1.2.cmml"><mo id="S2.E2.m1.7.7.2.1.1.1.2" stretchy="false" xref="S2.E2.m1.7.7.2.1.1.2.1.cmml">[</mo><mrow id="S2.E2.m1.7.7.2.1.1.1.1" xref="S2.E2.m1.7.7.2.1.1.1.1.cmml"><mrow id="S2.E2.m1.7.7.2.1.1.1.1.3" xref="S2.E2.m1.7.7.2.1.1.1.1.3.cmml"><mi id="S2.E2.m1.7.7.2.1.1.1.1.3.1" xref="S2.E2.m1.7.7.2.1.1.1.1.3.1.cmml">log</mi><mo id="S2.E2.m1.7.7.2.1.1.1.1.3a" lspace="0.167em" xref="S2.E2.m1.7.7.2.1.1.1.1.3.cmml">⁡</mo><mi id="S2.E2.m1.7.7.2.1.1.1.1.3.2" xref="S2.E2.m1.7.7.2.1.1.1.1.3.2.cmml">σ</mi></mrow><mo id="S2.E2.m1.7.7.2.1.1.1.1.2" xref="S2.E2.m1.7.7.2.1.1.1.1.2.cmml">⁢</mo><mrow id="S2.E2.m1.7.7.2.1.1.1.1.1.1" xref="S2.E2.m1.7.7.2.1.1.1.1.1.1.1.cmml"><mo id="S2.E2.m1.7.7.2.1.1.1.1.1.1.2" stretchy="false" xref="S2.E2.m1.7.7.2.1.1.1.1.1.1.1.cmml">(</mo><mrow id="S2.E2.m1.7.7.2.1.1.1.1.1.1.1" xref="S2.E2.m1.7.7.2.1.1.1.1.1.1.1.cmml"><mrow id="S2.E2.m1.7.7.2.1.1.1.1.1.1.1.1" xref="S2.E2.m1.7.7.2.1.1.1.1.1.1.1.1.cmml"><msub id="S2.E2.m1.7.7.2.1.1.1.1.1.1.1.1.3" xref="S2.E2.m1.7.7.2.1.1.1.1.1.1.1.1.3.cmml"><mi id="S2.E2.m1.7.7.2.1.1.1.1.1.1.1.1.3.2" xref="S2.E2.m1.7.7.2.1.1.1.1.1.1.1.1.3.2.cmml">r</mi><mi id="S2.E2.m1.7.7.2.1.1.1.1.1.1.1.1.3.3" xref="S2.E2.m1.7.7.2.1.1.1.1.1.1.1.1.3.3.cmml">ϕ</mi></msub><mo id="S2.E2.m1.7.7.2.1.1.1.1.1.1.1.1.2" xref="S2.E2.m1.7.7.2.1.1.1.1.1.1.1.1.2.cmml">⁢</mo><mrow id="S2.E2.m1.7.7.2.1.1.1.1.1.1.1.1.1.1" xref="S2.E2.m1.7.7.2.1.1.1.1.1.1.1.1.1.2.cmml"><mo id="S2.E2.m1.7.7.2.1.1.1.1.1.1.1.1.1.1.2" stretchy="false" xref="S2.E2.m1.7.7.2.1.1.1.1.1.1.1.1.1.2.cmml">(</mo><mi id="S2.E2.m1.4.4" xref="S2.E2.m1.4.4.cmml">x</mi><mo id="S2.E2.m1.7.7.2.1.1.1.1.1.1.1.1.1.1.3" xref="S2.E2.m1.7.7.2.1.1.1.1.1.1.1.1.1.2.cmml">,</mo><msub id="S2.E2.m1.7.7.2.1.1.1.1.1.1.1.1.1.1.1" xref="S2.E2.m1.7.7.2.1.1.1.1.1.1.1.1.1.1.1.cmml"><mi id="S2.E2.m1.7.7.2.1.1.1.1.1.1.1.1.1.1.1.2" xref="S2.E2.m1.7.7.2.1.1.1.1.1.1.1.1.1.1.1.2.cmml">y</mi><mi id="S2.E2.m1.7.7.2.1.1.1.1.1.1.1.1.1.1.1.3" xref="S2.E2.m1.7.7.2.1.1.1.1.1.1.1.1.1.1.1.3.cmml">w</mi></msub><mo id="S2.E2.m1.7.7.2.1.1.1.1.1.1.1.1.1.1.4" stretchy="false" xref="S2.E2.m1.7.7.2.1.1.1.1.1.1.1.1.1.2.cmml">)</mo></mrow></mrow><mo id="S2.E2.m1.7.7.2.1.1.1.1.1.1.1.3" xref="S2.E2.m1.7.7.2.1.1.1.1.1.1.1.3.cmml">−</mo><mrow id="S2.E2.m1.7.7.2.1.1.1.1.1.1.1.2" xref="S2.E2.m1.7.7.2.1.1.1.1.1.1.1.2.cmml"><msub id="S2.E2.m1.7.7.2.1.1.1.1.1.1.1.2.3" xref="S2.E2.m1.7.7.2.1.1.1.1.1.1.1.2.3.cmml"><mi id="S2.E2.m1.7.7.2.1.1.1.1.1.1.1.2.3.2" xref="S2.E2.m1.7.7.2.1.1.1.1.1.1.1.2.3.2.cmml">r</mi><mi id="S2.E2.m1.7.7.2.1.1.1.1.1.1.1.2.3.3" xref="S2.E2.m1.7.7.2.1.1.1.1.1.1.1.2.3.3.cmml">ϕ</mi></msub><mo id="S2.E2.m1.7.7.2.1.1.1.1.1.1.1.2.2" xref="S2.E2.m1.7.7.2.1.1.1.1.1.1.1.2.2.cmml">⁢</mo><mrow id="S2.E2.m1.7.7.2.1.1.1.1.1.1.1.2.1.1" xref="S2.E2.m1.7.7.2.1.1.1.1.1.1.1.2.1.2.cmml"><mo id="S2.E2.m1.7.7.2.1.1.1.1.1.1.1.2.1.1.2" stretchy="false" xref="S2.E2.m1.7.7.2.1.1.1.1.1.1.1.2.1.2.cmml">(</mo><mi id="S2.E2.m1.5.5" xref="S2.E2.m1.5.5.cmml">x</mi><mo id="S2.E2.m1.7.7.2.1.1.1.1.1.1.1.2.1.1.3" xref="S2.E2.m1.7.7.2.1.1.1.1.1.1.1.2.1.2.cmml">,</mo><msub id="S2.E2.m1.7.7.2.1.1.1.1.1.1.1.2.1.1.1" xref="S2.E2.m1.7.7.2.1.1.1.1.1.1.1.2.1.1.1.cmml"><mi id="S2.E2.m1.7.7.2.1.1.1.1.1.1.1.2.1.1.1.2" xref="S2.E2.m1.7.7.2.1.1.1.1.1.1.1.2.1.1.1.2.cmml">y</mi><mi id="S2.E2.m1.7.7.2.1.1.1.1.1.1.1.2.1.1.1.3" xref="S2.E2.m1.7.7.2.1.1.1.1.1.1.1.2.1.1.1.3.cmml">l</mi></msub><mo id="S2.E2.m1.7.7.2.1.1.1.1.1.1.1.2.1.1.4" stretchy="false" xref="S2.E2.m1.7.7.2.1.1.1.1.1.1.1.2.1.2.cmml">)</mo></mrow></mrow></mrow><mo id="S2.E2.m1.7.7.2.1.1.1.1.1.1.3" stretchy="false" xref="S2.E2.m1.7.7.2.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S2.E2.m1.7.7.2.1.1.1.3" stretchy="false" xref="S2.E2.m1.7.7.2.1.1.2.1.cmml">]</mo></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.E2.m1.7b"><apply id="S2.E2.m1.7.7.cmml" xref="S2.E2.m1.7.7"><eq id="S2.E2.m1.7.7.3.cmml" xref="S2.E2.m1.7.7.3"></eq><apply id="S2.E2.m1.6.6.1.cmml" xref="S2.E2.m1.6.6.1"><times id="S2.E2.m1.6.6.1.2.cmml" xref="S2.E2.m1.6.6.1.2"></times><ci id="S2.E2.m1.6.6.1.3.cmml" xref="S2.E2.m1.6.6.1.3">ℒ</ci><apply id="S2.E2.m1.6.6.1.1.1.1.cmml" xref="S2.E2.m1.6.6.1.1.1"><csymbol cd="ambiguous" id="S2.E2.m1.6.6.1.1.1.1.1.cmml" xref="S2.E2.m1.6.6.1.1.1">subscript</csymbol><ci id="S2.E2.m1.6.6.1.1.1.1.2.cmml" xref="S2.E2.m1.6.6.1.1.1.1.2">𝑟</ci><ci id="S2.E2.m1.6.6.1.1.1.1.3.cmml" xref="S2.E2.m1.6.6.1.1.1.1.3">italic-ϕ</ci></apply></apply><apply id="S2.E2.m1.7.7.2.cmml" xref="S2.E2.m1.7.7.2"><minus id="S2.E2.m1.7.7.2.2.cmml" xref="S2.E2.m1.7.7.2"></minus><apply id="S2.E2.m1.7.7.2.1.cmml" xref="S2.E2.m1.7.7.2.1"><times id="S2.E2.m1.7.7.2.1.2.cmml" xref="S2.E2.m1.7.7.2.1.2"></times><apply id="S2.E2.m1.7.7.2.1.3.cmml" xref="S2.E2.m1.7.7.2.1.3"><csymbol cd="ambiguous" id="S2.E2.m1.7.7.2.1.3.1.cmml" xref="S2.E2.m1.7.7.2.1.3">subscript</csymbol><ci id="S2.E2.m1.7.7.2.1.3.2.cmml" xref="S2.E2.m1.7.7.2.1.3.2">𝔼</ci><apply id="S2.E2.m1.3.3.3.cmml" xref="S2.E2.m1.3.3.3"><csymbol cd="latexml" id="S2.E2.m1.3.3.3.4.cmml" xref="S2.E2.m1.3.3.3.4">similar-to</csymbol><vector id="S2.E2.m1.3.3.3.3.3.cmml" xref="S2.E2.m1.3.3.3.3.2"><ci id="S2.E2.m1.1.1.1.1.cmml" xref="S2.E2.m1.1.1.1.1">𝑥</ci><apply id="S2.E2.m1.2.2.2.2.1.1.cmml" xref="S2.E2.m1.2.2.2.2.1.1"><csymbol cd="ambiguous" id="S2.E2.m1.2.2.2.2.1.1.1.cmml" xref="S2.E2.m1.2.2.2.2.1.1">subscript</csymbol><ci id="S2.E2.m1.2.2.2.2.1.1.2.cmml" xref="S2.E2.m1.2.2.2.2.1.1.2">𝑦</ci><ci id="S2.E2.m1.2.2.2.2.1.1.3.cmml" xref="S2.E2.m1.2.2.2.2.1.1.3">𝑤</ci></apply><apply id="S2.E2.m1.3.3.3.3.2.2.cmml" xref="S2.E2.m1.3.3.3.3.2.2"><csymbol cd="ambiguous" id="S2.E2.m1.3.3.3.3.2.2.1.cmml" xref="S2.E2.m1.3.3.3.3.2.2">subscript</csymbol><ci id="S2.E2.m1.3.3.3.3.2.2.2.cmml" xref="S2.E2.m1.3.3.3.3.2.2.2">𝑦</ci><ci id="S2.E2.m1.3.3.3.3.2.2.3.cmml" xref="S2.E2.m1.3.3.3.3.2.2.3">𝑙</ci></apply></vector><ci id="S2.E2.m1.3.3.3.5.cmml" xref="S2.E2.m1.3.3.3.5">𝒟</ci></apply></apply><apply id="S2.E2.m1.7.7.2.1.1.2.cmml" xref="S2.E2.m1.7.7.2.1.1.1"><csymbol cd="latexml" id="S2.E2.m1.7.7.2.1.1.2.1.cmml" xref="S2.E2.m1.7.7.2.1.1.1.2">delimited-[]</csymbol><apply id="S2.E2.m1.7.7.2.1.1.1.1.cmml" xref="S2.E2.m1.7.7.2.1.1.1.1"><times id="S2.E2.m1.7.7.2.1.1.1.1.2.cmml" xref="S2.E2.m1.7.7.2.1.1.1.1.2"></times><apply id="S2.E2.m1.7.7.2.1.1.1.1.3.cmml" xref="S2.E2.m1.7.7.2.1.1.1.1.3"><log id="S2.E2.m1.7.7.2.1.1.1.1.3.1.cmml" xref="S2.E2.m1.7.7.2.1.1.1.1.3.1"></log><ci id="S2.E2.m1.7.7.2.1.1.1.1.3.2.cmml" xref="S2.E2.m1.7.7.2.1.1.1.1.3.2">𝜎</ci></apply><apply id="S2.E2.m1.7.7.2.1.1.1.1.1.1.1.cmml" xref="S2.E2.m1.7.7.2.1.1.1.1.1.1"><minus id="S2.E2.m1.7.7.2.1.1.1.1.1.1.1.3.cmml" xref="S2.E2.m1.7.7.2.1.1.1.1.1.1.1.3"></minus><apply id="S2.E2.m1.7.7.2.1.1.1.1.1.1.1.1.cmml" xref="S2.E2.m1.7.7.2.1.1.1.1.1.1.1.1"><times id="S2.E2.m1.7.7.2.1.1.1.1.1.1.1.1.2.cmml" xref="S2.E2.m1.7.7.2.1.1.1.1.1.1.1.1.2"></times><apply id="S2.E2.m1.7.7.2.1.1.1.1.1.1.1.1.3.cmml" xref="S2.E2.m1.7.7.2.1.1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S2.E2.m1.7.7.2.1.1.1.1.1.1.1.1.3.1.cmml" xref="S2.E2.m1.7.7.2.1.1.1.1.1.1.1.1.3">subscript</csymbol><ci id="S2.E2.m1.7.7.2.1.1.1.1.1.1.1.1.3.2.cmml" xref="S2.E2.m1.7.7.2.1.1.1.1.1.1.1.1.3.2">𝑟</ci><ci id="S2.E2.m1.7.7.2.1.1.1.1.1.1.1.1.3.3.cmml" xref="S2.E2.m1.7.7.2.1.1.1.1.1.1.1.1.3.3">italic-ϕ</ci></apply><interval closure="open" id="S2.E2.m1.7.7.2.1.1.1.1.1.1.1.1.1.2.cmml" xref="S2.E2.m1.7.7.2.1.1.1.1.1.1.1.1.1.1"><ci id="S2.E2.m1.4.4.cmml" xref="S2.E2.m1.4.4">𝑥</ci><apply id="S2.E2.m1.7.7.2.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S2.E2.m1.7.7.2.1.1.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S2.E2.m1.7.7.2.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S2.E2.m1.7.7.2.1.1.1.1.1.1.1.1.1.1.1">subscript</csymbol><ci id="S2.E2.m1.7.7.2.1.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S2.E2.m1.7.7.2.1.1.1.1.1.1.1.1.1.1.1.2">𝑦</ci><ci id="S2.E2.m1.7.7.2.1.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="S2.E2.m1.7.7.2.1.1.1.1.1.1.1.1.1.1.1.3">𝑤</ci></apply></interval></apply><apply id="S2.E2.m1.7.7.2.1.1.1.1.1.1.1.2.cmml" xref="S2.E2.m1.7.7.2.1.1.1.1.1.1.1.2"><times id="S2.E2.m1.7.7.2.1.1.1.1.1.1.1.2.2.cmml" xref="S2.E2.m1.7.7.2.1.1.1.1.1.1.1.2.2"></times><apply id="S2.E2.m1.7.7.2.1.1.1.1.1.1.1.2.3.cmml" xref="S2.E2.m1.7.7.2.1.1.1.1.1.1.1.2.3"><csymbol cd="ambiguous" id="S2.E2.m1.7.7.2.1.1.1.1.1.1.1.2.3.1.cmml" xref="S2.E2.m1.7.7.2.1.1.1.1.1.1.1.2.3">subscript</csymbol><ci id="S2.E2.m1.7.7.2.1.1.1.1.1.1.1.2.3.2.cmml" xref="S2.E2.m1.7.7.2.1.1.1.1.1.1.1.2.3.2">𝑟</ci><ci id="S2.E2.m1.7.7.2.1.1.1.1.1.1.1.2.3.3.cmml" xref="S2.E2.m1.7.7.2.1.1.1.1.1.1.1.2.3.3">italic-ϕ</ci></apply><interval closure="open" id="S2.E2.m1.7.7.2.1.1.1.1.1.1.1.2.1.2.cmml" xref="S2.E2.m1.7.7.2.1.1.1.1.1.1.1.2.1.1"><ci id="S2.E2.m1.5.5.cmml" xref="S2.E2.m1.5.5">𝑥</ci><apply id="S2.E2.m1.7.7.2.1.1.1.1.1.1.1.2.1.1.1.cmml" xref="S2.E2.m1.7.7.2.1.1.1.1.1.1.1.2.1.1.1"><csymbol cd="ambiguous" id="S2.E2.m1.7.7.2.1.1.1.1.1.1.1.2.1.1.1.1.cmml" xref="S2.E2.m1.7.7.2.1.1.1.1.1.1.1.2.1.1.1">subscript</csymbol><ci id="S2.E2.m1.7.7.2.1.1.1.1.1.1.1.2.1.1.1.2.cmml" xref="S2.E2.m1.7.7.2.1.1.1.1.1.1.1.2.1.1.1.2">𝑦</ci><ci id="S2.E2.m1.7.7.2.1.1.1.1.1.1.1.2.1.1.1.3.cmml" xref="S2.E2.m1.7.7.2.1.1.1.1.1.1.1.2.1.1.1.3">𝑙</ci></apply></interval></apply></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.E2.m1.7c">\mathcal{L}(r_{\phi})=-\mathbb{E}_{(x,y_{w},y_{l})\sim\mathcal{D}}[\log\sigma(%
r_{\phi}(x,y_{w})-r_{\phi}(x,y_{l}))]</annotation><annotation encoding="application/x-llamapun" id="S2.E2.m1.7d">caligraphic_L ( italic_r start_POSTSUBSCRIPT italic_ϕ end_POSTSUBSCRIPT ) = - roman_𝔼 start_POSTSUBSCRIPT ( italic_x , italic_y start_POSTSUBSCRIPT italic_w end_POSTSUBSCRIPT , italic_y start_POSTSUBSCRIPT italic_l end_POSTSUBSCRIPT ) ∼ caligraphic_D end_POSTSUBSCRIPT [ roman_log italic_σ ( italic_r start_POSTSUBSCRIPT italic_ϕ end_POSTSUBSCRIPT ( italic_x , italic_y start_POSTSUBSCRIPT italic_w end_POSTSUBSCRIPT ) - italic_r start_POSTSUBSCRIPT italic_ϕ end_POSTSUBSCRIPT ( italic_x , italic_y start_POSTSUBSCRIPT italic_l end_POSTSUBSCRIPT ) ) ]</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(2)</span></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S2.I1.i3.p1.16">Additionally, the Kullback-Leibler (KL) divergence between the outputs generated by <math alttext="\pi_{\text{ref}}" class="ltx_Math" display="inline" id="S2.I1.i3.p1.14.m1.1"><semantics id="S2.I1.i3.p1.14.m1.1a"><msub id="S2.I1.i3.p1.14.m1.1.1" xref="S2.I1.i3.p1.14.m1.1.1.cmml"><mi id="S2.I1.i3.p1.14.m1.1.1.2" xref="S2.I1.i3.p1.14.m1.1.1.2.cmml">π</mi><mtext id="S2.I1.i3.p1.14.m1.1.1.3" xref="S2.I1.i3.p1.14.m1.1.1.3a.cmml">ref</mtext></msub><annotation-xml encoding="MathML-Content" id="S2.I1.i3.p1.14.m1.1b"><apply id="S2.I1.i3.p1.14.m1.1.1.cmml" xref="S2.I1.i3.p1.14.m1.1.1"><csymbol cd="ambiguous" id="S2.I1.i3.p1.14.m1.1.1.1.cmml" xref="S2.I1.i3.p1.14.m1.1.1">subscript</csymbol><ci id="S2.I1.i3.p1.14.m1.1.1.2.cmml" xref="S2.I1.i3.p1.14.m1.1.1.2">𝜋</ci><ci id="S2.I1.i3.p1.14.m1.1.1.3a.cmml" xref="S2.I1.i3.p1.14.m1.1.1.3"><mtext id="S2.I1.i3.p1.14.m1.1.1.3.cmml" mathsize="70%" xref="S2.I1.i3.p1.14.m1.1.1.3">ref</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.I1.i3.p1.14.m1.1c">\pi_{\text{ref}}</annotation><annotation encoding="application/x-llamapun" id="S2.I1.i3.p1.14.m1.1d">italic_π start_POSTSUBSCRIPT ref end_POSTSUBSCRIPT</annotation></semantics></math> and the parameterised <math alttext="\pi_{\theta}" class="ltx_Math" display="inline" id="S2.I1.i3.p1.15.m2.1"><semantics id="S2.I1.i3.p1.15.m2.1a"><msub id="S2.I1.i3.p1.15.m2.1.1" xref="S2.I1.i3.p1.15.m2.1.1.cmml"><mi id="S2.I1.i3.p1.15.m2.1.1.2" xref="S2.I1.i3.p1.15.m2.1.1.2.cmml">π</mi><mi id="S2.I1.i3.p1.15.m2.1.1.3" xref="S2.I1.i3.p1.15.m2.1.1.3.cmml">θ</mi></msub><annotation-xml encoding="MathML-Content" id="S2.I1.i3.p1.15.m2.1b"><apply id="S2.I1.i3.p1.15.m2.1.1.cmml" xref="S2.I1.i3.p1.15.m2.1.1"><csymbol cd="ambiguous" id="S2.I1.i3.p1.15.m2.1.1.1.cmml" xref="S2.I1.i3.p1.15.m2.1.1">subscript</csymbol><ci id="S2.I1.i3.p1.15.m2.1.1.2.cmml" xref="S2.I1.i3.p1.15.m2.1.1.2">𝜋</ci><ci id="S2.I1.i3.p1.15.m2.1.1.3.cmml" xref="S2.I1.i3.p1.15.m2.1.1.3">𝜃</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.I1.i3.p1.15.m2.1c">\pi_{\theta}</annotation><annotation encoding="application/x-llamapun" id="S2.I1.i3.p1.15.m2.1d">italic_π start_POSTSUBSCRIPT italic_θ end_POSTSUBSCRIPT</annotation></semantics></math> models serves as an additional reward signal, ensuring that the generated responses closely align with the reference model. Consequently, an optimal model <math alttext="\pi_{\theta}" class="ltx_Math" display="inline" id="S2.I1.i3.p1.16.m3.1"><semantics id="S2.I1.i3.p1.16.m3.1a"><msub id="S2.I1.i3.p1.16.m3.1.1" xref="S2.I1.i3.p1.16.m3.1.1.cmml"><mi id="S2.I1.i3.p1.16.m3.1.1.2" xref="S2.I1.i3.p1.16.m3.1.1.2.cmml">π</mi><mi id="S2.I1.i3.p1.16.m3.1.1.3" xref="S2.I1.i3.p1.16.m3.1.1.3.cmml">θ</mi></msub><annotation-xml encoding="MathML-Content" id="S2.I1.i3.p1.16.m3.1b"><apply id="S2.I1.i3.p1.16.m3.1.1.cmml" xref="S2.I1.i3.p1.16.m3.1.1"><csymbol cd="ambiguous" id="S2.I1.i3.p1.16.m3.1.1.1.cmml" xref="S2.I1.i3.p1.16.m3.1.1">subscript</csymbol><ci id="S2.I1.i3.p1.16.m3.1.1.2.cmml" xref="S2.I1.i3.p1.16.m3.1.1.2">𝜋</ci><ci id="S2.I1.i3.p1.16.m3.1.1.3.cmml" xref="S2.I1.i3.p1.16.m3.1.1.3">𝜃</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.I1.i3.p1.16.m3.1c">\pi_{\theta}</annotation><annotation encoding="application/x-llamapun" id="S2.I1.i3.p1.16.m3.1d">italic_π start_POSTSUBSCRIPT italic_θ end_POSTSUBSCRIPT</annotation></semantics></math> is one that maximises;</p>
<table class="ltx_equation ltx_eqn_table" id="S2.E3">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\mathbb{E}_{(x\in\mathcal{D},y\in\pi_{\theta})}[r_{\phi}(x,y)]-\beta\mathcal{D%
}_{\text{KL}}\bigr{(}\pi_{\theta}(y|x)||\pi_{\text{ref}}(y|x)\bigr{)}" class="ltx_math_unparsed" display="block" id="S2.E3.m1.3"><semantics id="S2.E3.m1.3a"><mrow id="S2.E3.m1.3b"><mrow id="S2.E3.m1.3.4"><msub id="S2.E3.m1.3.4.1"><mi id="S2.E3.m1.3.4.1.2" mathvariant="normal">𝔼</mi><mrow id="S2.E3.m1.1.1.1.1"><mo id="S2.E3.m1.1.1.1.1.2" stretchy="false">(</mo><mrow id="S2.E3.m1.1.1.1.1.1.2"><mrow id="S2.E3.m1.1.1.1.1.1.1.1"><mi id="S2.E3.m1.1.1.1.1.1.1.1.2">x</mi><mo id="S2.E3.m1.1.1.1.1.1.1.1.1">∈</mo><mi class="ltx_font_mathcaligraphic" id="S2.E3.m1.1.1.1.1.1.1.1.3">𝒟</mi></mrow><mo id="S2.E3.m1.1.1.1.1.1.2.3">,</mo><mrow id="S2.E3.m1.1.1.1.1.1.2.2"><mi id="S2.E3.m1.1.1.1.1.1.2.2.2">y</mi><mo id="S2.E3.m1.1.1.1.1.1.2.2.1">∈</mo><msub id="S2.E3.m1.1.1.1.1.1.2.2.3"><mi id="S2.E3.m1.1.1.1.1.1.2.2.3.2">π</mi><mi id="S2.E3.m1.1.1.1.1.1.2.2.3.3">θ</mi></msub></mrow></mrow><mo id="S2.E3.m1.1.1.1.1.3" stretchy="false">)</mo></mrow></msub><mrow id="S2.E3.m1.3.4.2"><mo id="S2.E3.m1.3.4.2.1" stretchy="false">[</mo><msub id="S2.E3.m1.3.4.2.2"><mi id="S2.E3.m1.3.4.2.2.2">r</mi><mi id="S2.E3.m1.3.4.2.2.3">ϕ</mi></msub><mrow id="S2.E3.m1.3.4.2.3"><mo id="S2.E3.m1.3.4.2.3.1" stretchy="false">(</mo><mi id="S2.E3.m1.2.2">x</mi><mo id="S2.E3.m1.3.4.2.3.2">,</mo><mi id="S2.E3.m1.3.3">y</mi><mo id="S2.E3.m1.3.4.2.3.3" stretchy="false">)</mo></mrow><mo id="S2.E3.m1.3.4.2.4" stretchy="false">]</mo></mrow><mo id="S2.E3.m1.3.4.3">−</mo><mi id="S2.E3.m1.3.4.4">β</mi><msub id="S2.E3.m1.3.4.5"><mi class="ltx_font_mathcaligraphic" id="S2.E3.m1.3.4.5.2">𝒟</mi><mtext id="S2.E3.m1.3.4.5.3">KL</mtext></msub><mo id="S2.E3.m1.3.4.6" lspace="0em" mathsize="120%" rspace="0em">(</mo></mrow><msub id="S2.E3.m1.3.5"><mi id="S2.E3.m1.3.5.2">π</mi><mi id="S2.E3.m1.3.5.3">θ</mi></msub><mrow id="S2.E3.m1.3.6"><mo id="S2.E3.m1.3.6.1" stretchy="false">(</mo><mi id="S2.E3.m1.3.6.2">y</mi><mo fence="false" id="S2.E3.m1.3.6.3" rspace="0.167em" stretchy="false">|</mo><mi id="S2.E3.m1.3.6.4">x</mi><mo id="S2.E3.m1.3.6.5" stretchy="false">)</mo></mrow><mo fence="false" id="S2.E3.m1.3.7" rspace="0.167em" stretchy="false">|</mo><mo fence="false" id="S2.E3.m1.3.8" rspace="0.167em" stretchy="false">|</mo><msub id="S2.E3.m1.3.9"><mi id="S2.E3.m1.3.9.2">π</mi><mtext id="S2.E3.m1.3.9.3">ref</mtext></msub><mrow id="S2.E3.m1.3.10"><mo id="S2.E3.m1.3.10.1" stretchy="false">(</mo><mi id="S2.E3.m1.3.10.2">y</mi><mo fence="false" id="S2.E3.m1.3.10.3" rspace="0.167em" stretchy="false">|</mo><mi id="S2.E3.m1.3.10.4">x</mi><mo id="S2.E3.m1.3.10.5" stretchy="false">)</mo></mrow><mo id="S2.E3.m1.3.11" maxsize="120%" minsize="120%">)</mo></mrow><annotation encoding="application/x-tex" id="S2.E3.m1.3c">\mathbb{E}_{(x\in\mathcal{D},y\in\pi_{\theta})}[r_{\phi}(x,y)]-\beta\mathcal{D%
}_{\text{KL}}\bigr{(}\pi_{\theta}(y|x)||\pi_{\text{ref}}(y|x)\bigr{)}</annotation><annotation encoding="application/x-llamapun" id="S2.E3.m1.3d">roman_𝔼 start_POSTSUBSCRIPT ( italic_x ∈ caligraphic_D , italic_y ∈ italic_π start_POSTSUBSCRIPT italic_θ end_POSTSUBSCRIPT ) end_POSTSUBSCRIPT [ italic_r start_POSTSUBSCRIPT italic_ϕ end_POSTSUBSCRIPT ( italic_x , italic_y ) ] - italic_β caligraphic_D start_POSTSUBSCRIPT KL end_POSTSUBSCRIPT ( italic_π start_POSTSUBSCRIPT italic_θ end_POSTSUBSCRIPT ( italic_y | italic_x ) | | italic_π start_POSTSUBSCRIPT ref end_POSTSUBSCRIPT ( italic_y | italic_x ) )</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(3)</span></td>
</tr></tbody>
</table>
</div>
<div class="ltx_para" id="S2.I1.i3.p2">
<p class="ltx_p" id="S2.I1.i3.p2.2">where <math alttext="\beta" class="ltx_Math" display="inline" id="S2.I1.i3.p2.1.m1.1"><semantics id="S2.I1.i3.p2.1.m1.1a"><mi id="S2.I1.i3.p2.1.m1.1.1" xref="S2.I1.i3.p2.1.m1.1.1.cmml">β</mi><annotation-xml encoding="MathML-Content" id="S2.I1.i3.p2.1.m1.1b"><ci id="S2.I1.i3.p2.1.m1.1.1.cmml" xref="S2.I1.i3.p2.1.m1.1.1">𝛽</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.I1.i3.p2.1.m1.1c">\beta</annotation><annotation encoding="application/x-llamapun" id="S2.I1.i3.p2.1.m1.1d">italic_β</annotation></semantics></math> is the temperature parameter typically <math alttext="\in[0.1,0.5]" class="ltx_Math" display="inline" id="S2.I1.i3.p2.2.m2.2"><semantics id="S2.I1.i3.p2.2.m2.2a"><mrow id="S2.I1.i3.p2.2.m2.2.3" xref="S2.I1.i3.p2.2.m2.2.3.cmml"><mi id="S2.I1.i3.p2.2.m2.2.3.2" xref="S2.I1.i3.p2.2.m2.2.3.2.cmml"></mi><mo id="S2.I1.i3.p2.2.m2.2.3.1" xref="S2.I1.i3.p2.2.m2.2.3.1.cmml">∈</mo><mrow id="S2.I1.i3.p2.2.m2.2.3.3.2" xref="S2.I1.i3.p2.2.m2.2.3.3.1.cmml"><mo id="S2.I1.i3.p2.2.m2.2.3.3.2.1" stretchy="false" xref="S2.I1.i3.p2.2.m2.2.3.3.1.cmml">[</mo><mn id="S2.I1.i3.p2.2.m2.1.1" xref="S2.I1.i3.p2.2.m2.1.1.cmml">0.1</mn><mo id="S2.I1.i3.p2.2.m2.2.3.3.2.2" xref="S2.I1.i3.p2.2.m2.2.3.3.1.cmml">,</mo><mn id="S2.I1.i3.p2.2.m2.2.2" xref="S2.I1.i3.p2.2.m2.2.2.cmml">0.5</mn><mo id="S2.I1.i3.p2.2.m2.2.3.3.2.3" stretchy="false" xref="S2.I1.i3.p2.2.m2.2.3.3.1.cmml">]</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.I1.i3.p2.2.m2.2b"><apply id="S2.I1.i3.p2.2.m2.2.3.cmml" xref="S2.I1.i3.p2.2.m2.2.3"><in id="S2.I1.i3.p2.2.m2.2.3.1.cmml" xref="S2.I1.i3.p2.2.m2.2.3.1"></in><csymbol cd="latexml" id="S2.I1.i3.p2.2.m2.2.3.2.cmml" xref="S2.I1.i3.p2.2.m2.2.3.2">absent</csymbol><interval closure="closed" id="S2.I1.i3.p2.2.m2.2.3.3.1.cmml" xref="S2.I1.i3.p2.2.m2.2.3.3.2"><cn id="S2.I1.i3.p2.2.m2.1.1.cmml" type="float" xref="S2.I1.i3.p2.2.m2.1.1">0.1</cn><cn id="S2.I1.i3.p2.2.m2.2.2.cmml" type="float" xref="S2.I1.i3.p2.2.m2.2.2">0.5</cn></interval></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.I1.i3.p2.2.m2.2c">\in[0.1,0.5]</annotation><annotation encoding="application/x-llamapun" id="S2.I1.i3.p2.2.m2.2d">∈ [ 0.1 , 0.5 ]</annotation></semantics></math>.</p>
</div>
</li>
</ul>
</div>
<section class="ltx_paragraph" id="S2.SS0.SSS0.Px1">
<h5 class="ltx_title ltx_title_paragraph">Human-aware Loss Functions (HALOs):</h5>
<div class="ltx_para" id="S2.SS0.SSS0.Px1.p1">
<p class="ltx_p" id="S2.SS0.SSS0.Px1.p1.1">RLHF can present challenges due to its inherent slowness and instability, especially in the case of highly varied outputs <cite class="ltx_cite ltx_citemacro_cite">Zheng et al. (<a class="ltx_ref" href="https://arxiv.org/html/2405.13984v1#bib.bib44" title="">2024</a>)</cite>. Recently, there has been a shift towards using closed-form losses in RLHF to align language models (LLMs) with human preferences. These losses are predominantly HALOs that model human biases, as discussed in <cite class="ltx_cite ltx_citemacro_cite">Tversky and Kahneman (<a class="ltx_ref" href="https://arxiv.org/html/2405.13984v1#bib.bib34" title="">1992</a>)</cite>, aiming to maximise the margin between preferred and dis-preferred generated outputs (for the definition refer to Appx. <a class="ltx_ref" href="https://arxiv.org/html/2405.13984v1#A2" title="Appendix B Human-aware Loss Functions (HALOs) ‣ Feedback-aligned Mixed LLMs for Machine Language-Molecule Translation"><span class="ltx_text ltx_ref_tag">B</span></a>). This approach offers a mathematical equivalence with RLHF, while effectively addressing its inherent limitations.</p>
</div>
</section>
</section>
<section class="ltx_section" id="S3">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">3 </span>Methodology</h2>
<div class="ltx_para" id="S3.p1">
<p class="ltx_p" id="S3.p1.1">Existing approaches for chemical models heavily rely on expensive pre-training using large mono-modality datasets or per-task fine-tuning for each multi-modal task. Meanwhile, other efforts concentrate on multi-task learning, integrating vast multi-task datasets to enhance the capabilities of chemical models (for related work please refer to Appx. <a class="ltx_ref" href="https://arxiv.org/html/2405.13984v1#A1" title="Appendix A Related Work ‣ Feedback-aligned Mixed LLMs for Machine Language-Molecule Translation"><span class="ltx_text ltx_ref_tag">A</span></a>). Here, we adopt a distinct approach by reducing reliance on extensive data and exploring optimisation algorithms and modality fusion techniques to enhance the capabilities of chemical LLMs.</p>
</div>
<section class="ltx_subsection" id="S3.SS1">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.1 </span>Problem Definition: Machine Language-Molecule Translation (LMolT)</h3>
<div class="ltx_para" id="S3.SS1.p1">
<p class="ltx_p" id="S3.SS1.p1.14">Let <math alttext="L" class="ltx_Math" display="inline" id="S3.SS1.p1.1.m1.1"><semantics id="S3.SS1.p1.1.m1.1a"><mi id="S3.SS1.p1.1.m1.1.1" xref="S3.SS1.p1.1.m1.1.1.cmml">L</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.1.m1.1b"><ci id="S3.SS1.p1.1.m1.1.1.cmml" xref="S3.SS1.p1.1.m1.1.1">𝐿</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.1.m1.1c">L</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p1.1.m1.1d">italic_L</annotation></semantics></math> denote the source language space and <math alttext="M" class="ltx_Math" display="inline" id="S3.SS1.p1.2.m2.1"><semantics id="S3.SS1.p1.2.m2.1a"><mi id="S3.SS1.p1.2.m2.1.1" xref="S3.SS1.p1.2.m2.1.1.cmml">M</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.2.m2.1b"><ci id="S3.SS1.p1.2.m2.1.1.cmml" xref="S3.SS1.p1.2.m2.1.1">𝑀</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.2.m2.1c">M</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p1.2.m2.1d">italic_M</annotation></semantics></math> denote the target molecule space. Consider a dataset <math alttext="\mathcal{D}" class="ltx_Math" display="inline" id="S3.SS1.p1.3.m3.1"><semantics id="S3.SS1.p1.3.m3.1a"><mi class="ltx_font_mathcaligraphic" id="S3.SS1.p1.3.m3.1.1" xref="S3.SS1.p1.3.m3.1.1.cmml">𝒟</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.3.m3.1b"><ci id="S3.SS1.p1.3.m3.1.1.cmml" xref="S3.SS1.p1.3.m3.1.1">𝒟</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.3.m3.1c">\mathcal{D}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p1.3.m3.1d">caligraphic_D</annotation></semantics></math>, comprising pairs of source language sequences <math alttext="x" class="ltx_Math" display="inline" id="S3.SS1.p1.4.m4.1"><semantics id="S3.SS1.p1.4.m4.1a"><mi id="S3.SS1.p1.4.m4.1.1" xref="S3.SS1.p1.4.m4.1.1.cmml">x</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.4.m4.1b"><ci id="S3.SS1.p1.4.m4.1.1.cmml" xref="S3.SS1.p1.4.m4.1.1">𝑥</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.4.m4.1c">x</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p1.4.m4.1d">italic_x</annotation></semantics></math> represented in space <math alttext="L" class="ltx_Math" display="inline" id="S3.SS1.p1.5.m5.1"><semantics id="S3.SS1.p1.5.m5.1a"><mi id="S3.SS1.p1.5.m5.1.1" xref="S3.SS1.p1.5.m5.1.1.cmml">L</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.5.m5.1b"><ci id="S3.SS1.p1.5.m5.1.1.cmml" xref="S3.SS1.p1.5.m5.1.1">𝐿</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.5.m5.1c">L</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p1.5.m5.1d">italic_L</annotation></semantics></math>, and their corresponding target molecule sequences <math alttext="y" class="ltx_Math" display="inline" id="S3.SS1.p1.6.m6.1"><semantics id="S3.SS1.p1.6.m6.1a"><mi id="S3.SS1.p1.6.m6.1.1" xref="S3.SS1.p1.6.m6.1.1.cmml">y</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.6.m6.1b"><ci id="S3.SS1.p1.6.m6.1.1.cmml" xref="S3.SS1.p1.6.m6.1.1">𝑦</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.6.m6.1c">y</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p1.6.m6.1d">italic_y</annotation></semantics></math> in space <math alttext="M" class="ltx_Math" display="inline" id="S3.SS1.p1.7.m7.1"><semantics id="S3.SS1.p1.7.m7.1a"><mi id="S3.SS1.p1.7.m7.1.1" xref="S3.SS1.p1.7.m7.1.1.cmml">M</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.7.m7.1b"><ci id="S3.SS1.p1.7.m7.1.1.cmml" xref="S3.SS1.p1.7.m7.1.1">𝑀</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.7.m7.1c">M</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p1.7.m7.1d">italic_M</annotation></semantics></math>, represented as <math alttext="\mathcal{D}=\{x^{(i)},y^{(i)}\}_{i=1}^{N}" class="ltx_Math" display="inline" id="S3.SS1.p1.8.m8.4"><semantics id="S3.SS1.p1.8.m8.4a"><mrow id="S3.SS1.p1.8.m8.4.4" xref="S3.SS1.p1.8.m8.4.4.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS1.p1.8.m8.4.4.4" xref="S3.SS1.p1.8.m8.4.4.4.cmml">𝒟</mi><mo id="S3.SS1.p1.8.m8.4.4.3" xref="S3.SS1.p1.8.m8.4.4.3.cmml">=</mo><msubsup id="S3.SS1.p1.8.m8.4.4.2" xref="S3.SS1.p1.8.m8.4.4.2.cmml"><mrow id="S3.SS1.p1.8.m8.4.4.2.2.2.2" xref="S3.SS1.p1.8.m8.4.4.2.2.2.3.cmml"><mo id="S3.SS1.p1.8.m8.4.4.2.2.2.2.3" stretchy="false" xref="S3.SS1.p1.8.m8.4.4.2.2.2.3.cmml">{</mo><msup id="S3.SS1.p1.8.m8.3.3.1.1.1.1.1" xref="S3.SS1.p1.8.m8.3.3.1.1.1.1.1.cmml"><mi id="S3.SS1.p1.8.m8.3.3.1.1.1.1.1.2" xref="S3.SS1.p1.8.m8.3.3.1.1.1.1.1.2.cmml">x</mi><mrow id="S3.SS1.p1.8.m8.1.1.1.3" xref="S3.SS1.p1.8.m8.3.3.1.1.1.1.1.cmml"><mo id="S3.SS1.p1.8.m8.1.1.1.3.1" stretchy="false" xref="S3.SS1.p1.8.m8.3.3.1.1.1.1.1.cmml">(</mo><mi id="S3.SS1.p1.8.m8.1.1.1.1" xref="S3.SS1.p1.8.m8.1.1.1.1.cmml">i</mi><mo id="S3.SS1.p1.8.m8.1.1.1.3.2" stretchy="false" xref="S3.SS1.p1.8.m8.3.3.1.1.1.1.1.cmml">)</mo></mrow></msup><mo id="S3.SS1.p1.8.m8.4.4.2.2.2.2.4" xref="S3.SS1.p1.8.m8.4.4.2.2.2.3.cmml">,</mo><msup id="S3.SS1.p1.8.m8.4.4.2.2.2.2.2" xref="S3.SS1.p1.8.m8.4.4.2.2.2.2.2.cmml"><mi id="S3.SS1.p1.8.m8.4.4.2.2.2.2.2.2" xref="S3.SS1.p1.8.m8.4.4.2.2.2.2.2.2.cmml">y</mi><mrow id="S3.SS1.p1.8.m8.2.2.1.3" xref="S3.SS1.p1.8.m8.4.4.2.2.2.2.2.cmml"><mo id="S3.SS1.p1.8.m8.2.2.1.3.1" stretchy="false" xref="S3.SS1.p1.8.m8.4.4.2.2.2.2.2.cmml">(</mo><mi id="S3.SS1.p1.8.m8.2.2.1.1" xref="S3.SS1.p1.8.m8.2.2.1.1.cmml">i</mi><mo id="S3.SS1.p1.8.m8.2.2.1.3.2" stretchy="false" xref="S3.SS1.p1.8.m8.4.4.2.2.2.2.2.cmml">)</mo></mrow></msup><mo id="S3.SS1.p1.8.m8.4.4.2.2.2.2.5" stretchy="false" xref="S3.SS1.p1.8.m8.4.4.2.2.2.3.cmml">}</mo></mrow><mrow id="S3.SS1.p1.8.m8.4.4.2.2.4" xref="S3.SS1.p1.8.m8.4.4.2.2.4.cmml"><mi id="S3.SS1.p1.8.m8.4.4.2.2.4.2" xref="S3.SS1.p1.8.m8.4.4.2.2.4.2.cmml">i</mi><mo id="S3.SS1.p1.8.m8.4.4.2.2.4.1" xref="S3.SS1.p1.8.m8.4.4.2.2.4.1.cmml">=</mo><mn id="S3.SS1.p1.8.m8.4.4.2.2.4.3" xref="S3.SS1.p1.8.m8.4.4.2.2.4.3.cmml">1</mn></mrow><mi id="S3.SS1.p1.8.m8.4.4.2.4" xref="S3.SS1.p1.8.m8.4.4.2.4.cmml">N</mi></msubsup></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.8.m8.4b"><apply id="S3.SS1.p1.8.m8.4.4.cmml" xref="S3.SS1.p1.8.m8.4.4"><eq id="S3.SS1.p1.8.m8.4.4.3.cmml" xref="S3.SS1.p1.8.m8.4.4.3"></eq><ci id="S3.SS1.p1.8.m8.4.4.4.cmml" xref="S3.SS1.p1.8.m8.4.4.4">𝒟</ci><apply id="S3.SS1.p1.8.m8.4.4.2.cmml" xref="S3.SS1.p1.8.m8.4.4.2"><csymbol cd="ambiguous" id="S3.SS1.p1.8.m8.4.4.2.3.cmml" xref="S3.SS1.p1.8.m8.4.4.2">superscript</csymbol><apply id="S3.SS1.p1.8.m8.4.4.2.2.cmml" xref="S3.SS1.p1.8.m8.4.4.2"><csymbol cd="ambiguous" id="S3.SS1.p1.8.m8.4.4.2.2.3.cmml" xref="S3.SS1.p1.8.m8.4.4.2">subscript</csymbol><set id="S3.SS1.p1.8.m8.4.4.2.2.2.3.cmml" xref="S3.SS1.p1.8.m8.4.4.2.2.2.2"><apply id="S3.SS1.p1.8.m8.3.3.1.1.1.1.1.cmml" xref="S3.SS1.p1.8.m8.3.3.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS1.p1.8.m8.3.3.1.1.1.1.1.1.cmml" xref="S3.SS1.p1.8.m8.3.3.1.1.1.1.1">superscript</csymbol><ci id="S3.SS1.p1.8.m8.3.3.1.1.1.1.1.2.cmml" xref="S3.SS1.p1.8.m8.3.3.1.1.1.1.1.2">𝑥</ci><ci id="S3.SS1.p1.8.m8.1.1.1.1.cmml" xref="S3.SS1.p1.8.m8.1.1.1.1">𝑖</ci></apply><apply id="S3.SS1.p1.8.m8.4.4.2.2.2.2.2.cmml" xref="S3.SS1.p1.8.m8.4.4.2.2.2.2.2"><csymbol cd="ambiguous" id="S3.SS1.p1.8.m8.4.4.2.2.2.2.2.1.cmml" xref="S3.SS1.p1.8.m8.4.4.2.2.2.2.2">superscript</csymbol><ci id="S3.SS1.p1.8.m8.4.4.2.2.2.2.2.2.cmml" xref="S3.SS1.p1.8.m8.4.4.2.2.2.2.2.2">𝑦</ci><ci id="S3.SS1.p1.8.m8.2.2.1.1.cmml" xref="S3.SS1.p1.8.m8.2.2.1.1">𝑖</ci></apply></set><apply id="S3.SS1.p1.8.m8.4.4.2.2.4.cmml" xref="S3.SS1.p1.8.m8.4.4.2.2.4"><eq id="S3.SS1.p1.8.m8.4.4.2.2.4.1.cmml" xref="S3.SS1.p1.8.m8.4.4.2.2.4.1"></eq><ci id="S3.SS1.p1.8.m8.4.4.2.2.4.2.cmml" xref="S3.SS1.p1.8.m8.4.4.2.2.4.2">𝑖</ci><cn id="S3.SS1.p1.8.m8.4.4.2.2.4.3.cmml" type="integer" xref="S3.SS1.p1.8.m8.4.4.2.2.4.3">1</cn></apply></apply><ci id="S3.SS1.p1.8.m8.4.4.2.4.cmml" xref="S3.SS1.p1.8.m8.4.4.2.4">𝑁</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.8.m8.4c">\mathcal{D}=\{x^{(i)},y^{(i)}\}_{i=1}^{N}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p1.8.m8.4d">caligraphic_D = { italic_x start_POSTSUPERSCRIPT ( italic_i ) end_POSTSUPERSCRIPT , italic_y start_POSTSUPERSCRIPT ( italic_i ) end_POSTSUPERSCRIPT } start_POSTSUBSCRIPT italic_i = 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_N end_POSTSUPERSCRIPT</annotation></semantics></math>, where <math alttext="N" class="ltx_Math" display="inline" id="S3.SS1.p1.9.m9.1"><semantics id="S3.SS1.p1.9.m9.1a"><mi id="S3.SS1.p1.9.m9.1.1" xref="S3.SS1.p1.9.m9.1.1.cmml">N</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.9.m9.1b"><ci id="S3.SS1.p1.9.m9.1.1.cmml" xref="S3.SS1.p1.9.m9.1.1">𝑁</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.9.m9.1c">N</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p1.9.m9.1d">italic_N</annotation></semantics></math> is the total number of pairs. Here, we cast the problem as a cross-modal translation task, aiming to learn an optimal function <math alttext="f:L\leftrightarrow M" class="ltx_Math" display="inline" id="S3.SS1.p1.10.m10.1"><semantics id="S3.SS1.p1.10.m10.1a"><mrow id="S3.SS1.p1.10.m10.1.1" xref="S3.SS1.p1.10.m10.1.1.cmml"><mi id="S3.SS1.p1.10.m10.1.1.2" xref="S3.SS1.p1.10.m10.1.1.2.cmml">f</mi><mo id="S3.SS1.p1.10.m10.1.1.3" lspace="0.278em" rspace="0.278em" xref="S3.SS1.p1.10.m10.1.1.3.cmml">:</mo><mi id="S3.SS1.p1.10.m10.1.1.4" xref="S3.SS1.p1.10.m10.1.1.4.cmml">L</mi><mo id="S3.SS1.p1.10.m10.1.1.5" stretchy="false" xref="S3.SS1.p1.10.m10.1.1.5.cmml">↔</mo><mi id="S3.SS1.p1.10.m10.1.1.6" xref="S3.SS1.p1.10.m10.1.1.6.cmml">M</mi></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.10.m10.1b"><apply id="S3.SS1.p1.10.m10.1.1.cmml" xref="S3.SS1.p1.10.m10.1.1"><and id="S3.SS1.p1.10.m10.1.1a.cmml" xref="S3.SS1.p1.10.m10.1.1"></and><apply id="S3.SS1.p1.10.m10.1.1b.cmml" xref="S3.SS1.p1.10.m10.1.1"><ci id="S3.SS1.p1.10.m10.1.1.3.cmml" xref="S3.SS1.p1.10.m10.1.1.3">:</ci><ci id="S3.SS1.p1.10.m10.1.1.2.cmml" xref="S3.SS1.p1.10.m10.1.1.2">𝑓</ci><ci id="S3.SS1.p1.10.m10.1.1.4.cmml" xref="S3.SS1.p1.10.m10.1.1.4">𝐿</ci></apply><apply id="S3.SS1.p1.10.m10.1.1c.cmml" xref="S3.SS1.p1.10.m10.1.1"><ci id="S3.SS1.p1.10.m10.1.1.5.cmml" xref="S3.SS1.p1.10.m10.1.1.5">↔</ci><share href="https://arxiv.org/html/2405.13984v1#S3.SS1.p1.10.m10.1.1.4.cmml" id="S3.SS1.p1.10.m10.1.1d.cmml" xref="S3.SS1.p1.10.m10.1.1"></share><ci id="S3.SS1.p1.10.m10.1.1.6.cmml" xref="S3.SS1.p1.10.m10.1.1.6">𝑀</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.10.m10.1c">f:L\leftrightarrow M</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p1.10.m10.1d">italic_f : italic_L ↔ italic_M</annotation></semantics></math> through a model <math alttext="\pi_{\theta}" class="ltx_Math" display="inline" id="S3.SS1.p1.11.m11.1"><semantics id="S3.SS1.p1.11.m11.1a"><msub id="S3.SS1.p1.11.m11.1.1" xref="S3.SS1.p1.11.m11.1.1.cmml"><mi id="S3.SS1.p1.11.m11.1.1.2" xref="S3.SS1.p1.11.m11.1.1.2.cmml">π</mi><mi id="S3.SS1.p1.11.m11.1.1.3" xref="S3.SS1.p1.11.m11.1.1.3.cmml">θ</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.11.m11.1b"><apply id="S3.SS1.p1.11.m11.1.1.cmml" xref="S3.SS1.p1.11.m11.1.1"><csymbol cd="ambiguous" id="S3.SS1.p1.11.m11.1.1.1.cmml" xref="S3.SS1.p1.11.m11.1.1">subscript</csymbol><ci id="S3.SS1.p1.11.m11.1.1.2.cmml" xref="S3.SS1.p1.11.m11.1.1.2">𝜋</ci><ci id="S3.SS1.p1.11.m11.1.1.3.cmml" xref="S3.SS1.p1.11.m11.1.1.3">𝜃</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.11.m11.1c">\pi_{\theta}</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p1.11.m11.1d">italic_π start_POSTSUBSCRIPT italic_θ end_POSTSUBSCRIPT</annotation></semantics></math> parameterised by <math alttext="\theta" class="ltx_Math" display="inline" id="S3.SS1.p1.12.m12.1"><semantics id="S3.SS1.p1.12.m12.1a"><mi id="S3.SS1.p1.12.m12.1.1" xref="S3.SS1.p1.12.m12.1.1.cmml">θ</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.12.m12.1b"><ci id="S3.SS1.p1.12.m12.1.1.cmml" xref="S3.SS1.p1.12.m12.1.1">𝜃</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.12.m12.1c">\theta</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p1.12.m12.1d">italic_θ</annotation></semantics></math>. We coordinate the language and molecule spaces through instructional modelling to regulate the translation process across both directions, i.e., <math alttext="L\rightarrow M" class="ltx_Math" display="inline" id="S3.SS1.p1.13.m13.1"><semantics id="S3.SS1.p1.13.m13.1a"><mrow id="S3.SS1.p1.13.m13.1.1" xref="S3.SS1.p1.13.m13.1.1.cmml"><mi id="S3.SS1.p1.13.m13.1.1.2" xref="S3.SS1.p1.13.m13.1.1.2.cmml">L</mi><mo id="S3.SS1.p1.13.m13.1.1.1" stretchy="false" xref="S3.SS1.p1.13.m13.1.1.1.cmml">→</mo><mi id="S3.SS1.p1.13.m13.1.1.3" xref="S3.SS1.p1.13.m13.1.1.3.cmml">M</mi></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.13.m13.1b"><apply id="S3.SS1.p1.13.m13.1.1.cmml" xref="S3.SS1.p1.13.m13.1.1"><ci id="S3.SS1.p1.13.m13.1.1.1.cmml" xref="S3.SS1.p1.13.m13.1.1.1">→</ci><ci id="S3.SS1.p1.13.m13.1.1.2.cmml" xref="S3.SS1.p1.13.m13.1.1.2">𝐿</ci><ci id="S3.SS1.p1.13.m13.1.1.3.cmml" xref="S3.SS1.p1.13.m13.1.1.3">𝑀</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.13.m13.1c">L\rightarrow M</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p1.13.m13.1d">italic_L → italic_M</annotation></semantics></math> and <math alttext="M\rightarrow L" class="ltx_Math" display="inline" id="S3.SS1.p1.14.m14.1"><semantics id="S3.SS1.p1.14.m14.1a"><mrow id="S3.SS1.p1.14.m14.1.1" xref="S3.SS1.p1.14.m14.1.1.cmml"><mi id="S3.SS1.p1.14.m14.1.1.2" xref="S3.SS1.p1.14.m14.1.1.2.cmml">M</mi><mo id="S3.SS1.p1.14.m14.1.1.1" stretchy="false" xref="S3.SS1.p1.14.m14.1.1.1.cmml">→</mo><mi id="S3.SS1.p1.14.m14.1.1.3" xref="S3.SS1.p1.14.m14.1.1.3.cmml">L</mi></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.14.m14.1b"><apply id="S3.SS1.p1.14.m14.1.1.cmml" xref="S3.SS1.p1.14.m14.1.1"><ci id="S3.SS1.p1.14.m14.1.1.1.cmml" xref="S3.SS1.p1.14.m14.1.1.1">→</ci><ci id="S3.SS1.p1.14.m14.1.1.2.cmml" xref="S3.SS1.p1.14.m14.1.1.2">𝑀</ci><ci id="S3.SS1.p1.14.m14.1.1.3.cmml" xref="S3.SS1.p1.14.m14.1.1.3">𝐿</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.14.m14.1c">M\rightarrow L</annotation><annotation encoding="application/x-llamapun" id="S3.SS1.p1.14.m14.1d">italic_M → italic_L</annotation></semantics></math> (please refer to Appx. <a class="ltx_ref" href="https://arxiv.org/html/2405.13984v1#A3" title="Appendix C Language-molecule Translation Instructions ‣ Feedback-aligned Mixed LLMs for Machine Language-Molecule Translation"><span class="ltx_text ltx_ref_tag">C</span></a>).</p>
</div>
</section>
<section class="ltx_subsection" id="S3.SS2">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.2 </span>Feedback-Aligned Optimisations Algorithms</h3>
<div class="ltx_para" id="S3.SS2.p1">
<p class="ltx_p" id="S3.SS2.p1.1">Here we investigate approximation policies for feedback alignment optimisation for the LMolT task.</p>
</div>
<section class="ltx_paragraph" id="S3.SS2.SSS0.Px1">
<h5 class="ltx_title ltx_title_paragraph">Supervised Fine-Tuning (SFT):</h5>
<div class="ltx_para" id="S3.SS2.SSS0.Px1.p1">
<p class="ltx_p" id="S3.SS2.SSS0.Px1.p1.3">A model is optimised by minimising the disparity between the generated and intended target outputs. For a model parameterised by <math alttext="\theta" class="ltx_Math" display="inline" id="S3.SS2.SSS0.Px1.p1.1.m1.1"><semantics id="S3.SS2.SSS0.Px1.p1.1.m1.1a"><mi id="S3.SS2.SSS0.Px1.p1.1.m1.1.1" xref="S3.SS2.SSS0.Px1.p1.1.m1.1.1.cmml">θ</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS0.Px1.p1.1.m1.1b"><ci id="S3.SS2.SSS0.Px1.p1.1.m1.1.1.cmml" xref="S3.SS2.SSS0.Px1.p1.1.m1.1.1">𝜃</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS0.Px1.p1.1.m1.1c">\theta</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS0.Px1.p1.1.m1.1d">italic_θ</annotation></semantics></math>, denoted as <math alttext="\pi_{\theta}" class="ltx_Math" display="inline" id="S3.SS2.SSS0.Px1.p1.2.m2.1"><semantics id="S3.SS2.SSS0.Px1.p1.2.m2.1a"><msub id="S3.SS2.SSS0.Px1.p1.2.m2.1.1" xref="S3.SS2.SSS0.Px1.p1.2.m2.1.1.cmml"><mi id="S3.SS2.SSS0.Px1.p1.2.m2.1.1.2" xref="S3.SS2.SSS0.Px1.p1.2.m2.1.1.2.cmml">π</mi><mi id="S3.SS2.SSS0.Px1.p1.2.m2.1.1.3" xref="S3.SS2.SSS0.Px1.p1.2.m2.1.1.3.cmml">θ</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS0.Px1.p1.2.m2.1b"><apply id="S3.SS2.SSS0.Px1.p1.2.m2.1.1.cmml" xref="S3.SS2.SSS0.Px1.p1.2.m2.1.1"><csymbol cd="ambiguous" id="S3.SS2.SSS0.Px1.p1.2.m2.1.1.1.cmml" xref="S3.SS2.SSS0.Px1.p1.2.m2.1.1">subscript</csymbol><ci id="S3.SS2.SSS0.Px1.p1.2.m2.1.1.2.cmml" xref="S3.SS2.SSS0.Px1.p1.2.m2.1.1.2">𝜋</ci><ci id="S3.SS2.SSS0.Px1.p1.2.m2.1.1.3.cmml" xref="S3.SS2.SSS0.Px1.p1.2.m2.1.1.3">𝜃</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS0.Px1.p1.2.m2.1c">\pi_{\theta}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS0.Px1.p1.2.m2.1d">italic_π start_POSTSUBSCRIPT italic_θ end_POSTSUBSCRIPT</annotation></semantics></math>, the loss function is defined as the negative log-likelihood of source-target pairs <math alttext="(x,y)\sim\mathcal{D}" class="ltx_Math" display="inline" id="S3.SS2.SSS0.Px1.p1.3.m3.2"><semantics id="S3.SS2.SSS0.Px1.p1.3.m3.2a"><mrow id="S3.SS2.SSS0.Px1.p1.3.m3.2.3" xref="S3.SS2.SSS0.Px1.p1.3.m3.2.3.cmml"><mrow id="S3.SS2.SSS0.Px1.p1.3.m3.2.3.2.2" xref="S3.SS2.SSS0.Px1.p1.3.m3.2.3.2.1.cmml"><mo id="S3.SS2.SSS0.Px1.p1.3.m3.2.3.2.2.1" stretchy="false" xref="S3.SS2.SSS0.Px1.p1.3.m3.2.3.2.1.cmml">(</mo><mi id="S3.SS2.SSS0.Px1.p1.3.m3.1.1" xref="S3.SS2.SSS0.Px1.p1.3.m3.1.1.cmml">x</mi><mo id="S3.SS2.SSS0.Px1.p1.3.m3.2.3.2.2.2" xref="S3.SS2.SSS0.Px1.p1.3.m3.2.3.2.1.cmml">,</mo><mi id="S3.SS2.SSS0.Px1.p1.3.m3.2.2" xref="S3.SS2.SSS0.Px1.p1.3.m3.2.2.cmml">y</mi><mo id="S3.SS2.SSS0.Px1.p1.3.m3.2.3.2.2.3" stretchy="false" xref="S3.SS2.SSS0.Px1.p1.3.m3.2.3.2.1.cmml">)</mo></mrow><mo id="S3.SS2.SSS0.Px1.p1.3.m3.2.3.1" xref="S3.SS2.SSS0.Px1.p1.3.m3.2.3.1.cmml">∼</mo><mi class="ltx_font_mathcaligraphic" id="S3.SS2.SSS0.Px1.p1.3.m3.2.3.3" xref="S3.SS2.SSS0.Px1.p1.3.m3.2.3.3.cmml">𝒟</mi></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS0.Px1.p1.3.m3.2b"><apply id="S3.SS2.SSS0.Px1.p1.3.m3.2.3.cmml" xref="S3.SS2.SSS0.Px1.p1.3.m3.2.3"><csymbol cd="latexml" id="S3.SS2.SSS0.Px1.p1.3.m3.2.3.1.cmml" xref="S3.SS2.SSS0.Px1.p1.3.m3.2.3.1">similar-to</csymbol><interval closure="open" id="S3.SS2.SSS0.Px1.p1.3.m3.2.3.2.1.cmml" xref="S3.SS2.SSS0.Px1.p1.3.m3.2.3.2.2"><ci id="S3.SS2.SSS0.Px1.p1.3.m3.1.1.cmml" xref="S3.SS2.SSS0.Px1.p1.3.m3.1.1">𝑥</ci><ci id="S3.SS2.SSS0.Px1.p1.3.m3.2.2.cmml" xref="S3.SS2.SSS0.Px1.p1.3.m3.2.2">𝑦</ci></interval><ci id="S3.SS2.SSS0.Px1.p1.3.m3.2.3.3.cmml" xref="S3.SS2.SSS0.Px1.p1.3.m3.2.3.3">𝒟</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS0.Px1.p1.3.m3.2c">(x,y)\sim\mathcal{D}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS0.Px1.p1.3.m3.2d">( italic_x , italic_y ) ∼ caligraphic_D</annotation></semantics></math>, and can be expressed as follows:</p>
<table class="ltx_equation ltx_eqn_table" id="S3.E4">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\mathcal{L}_{\text{NLL}}=-\mathbb{E}_{(x,y)\sim\mathcal{D}}\bigr{[}\log\pi_{%
\theta}(y|x)\bigr{]}" class="ltx_math_unparsed" display="block" id="S3.E4.m1.2"><semantics id="S3.E4.m1.2a"><mrow id="S3.E4.m1.2b"><mrow id="S3.E4.m1.2.3"><msub id="S3.E4.m1.2.3.1"><mi class="ltx_font_mathcaligraphic" id="S3.E4.m1.2.3.1.2">ℒ</mi><mtext id="S3.E4.m1.2.3.1.3">NLL</mtext></msub><mo id="S3.E4.m1.2.3.2" rspace="0em">=</mo><mo id="S3.E4.m1.2.3.3" lspace="0em">−</mo><msub id="S3.E4.m1.2.3.4"><mi id="S3.E4.m1.2.3.4.2" mathvariant="normal">𝔼</mi><mrow id="S3.E4.m1.2.2.2"><mrow id="S3.E4.m1.2.2.2.4.2"><mo id="S3.E4.m1.2.2.2.4.2.1" stretchy="false">(</mo><mi id="S3.E4.m1.1.1.1.1">x</mi><mo id="S3.E4.m1.2.2.2.4.2.2">,</mo><mi id="S3.E4.m1.2.2.2.2">y</mi><mo id="S3.E4.m1.2.2.2.4.2.3" stretchy="false">)</mo></mrow><mo id="S3.E4.m1.2.2.2.3">∼</mo><mi class="ltx_font_mathcaligraphic" id="S3.E4.m1.2.2.2.5">𝒟</mi></mrow></msub><mo id="S3.E4.m1.2.3.5" lspace="0em" mathsize="120%" rspace="0.167em">[</mo></mrow><mi id="S3.E4.m1.2.4">log</mi><msub id="S3.E4.m1.2.5"><mi id="S3.E4.m1.2.5.2">π</mi><mi id="S3.E4.m1.2.5.3">θ</mi></msub><mrow id="S3.E4.m1.2.6"><mo id="S3.E4.m1.2.6.1" stretchy="false">(</mo><mi id="S3.E4.m1.2.6.2">y</mi><mo fence="false" id="S3.E4.m1.2.6.3" rspace="0.167em" stretchy="false">|</mo><mi id="S3.E4.m1.2.6.4">x</mi><mo id="S3.E4.m1.2.6.5" stretchy="false">)</mo></mrow><mo id="S3.E4.m1.2.7" maxsize="120%" minsize="120%">]</mo></mrow><annotation encoding="application/x-tex" id="S3.E4.m1.2c">\mathcal{L}_{\text{NLL}}=-\mathbb{E}_{(x,y)\sim\mathcal{D}}\bigr{[}\log\pi_{%
\theta}(y|x)\bigr{]}</annotation><annotation encoding="application/x-llamapun" id="S3.E4.m1.2d">caligraphic_L start_POSTSUBSCRIPT NLL end_POSTSUBSCRIPT = - roman_𝔼 start_POSTSUBSCRIPT ( italic_x , italic_y ) ∼ caligraphic_D end_POSTSUBSCRIPT [ roman_log italic_π start_POSTSUBSCRIPT italic_θ end_POSTSUBSCRIPT ( italic_y | italic_x ) ]</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(4)</span></td>
</tr></tbody>
</table>
</div>
<div class="ltx_para" id="S3.SS2.SSS0.Px1.p2">
<p class="ltx_p" id="S3.SS2.SSS0.Px1.p2.1">where the quality of <math alttext="(x,y)" class="ltx_Math" display="inline" id="S3.SS2.SSS0.Px1.p2.1.m1.2"><semantics id="S3.SS2.SSS0.Px1.p2.1.m1.2a"><mrow id="S3.SS2.SSS0.Px1.p2.1.m1.2.3.2" xref="S3.SS2.SSS0.Px1.p2.1.m1.2.3.1.cmml"><mo id="S3.SS2.SSS0.Px1.p2.1.m1.2.3.2.1" stretchy="false" xref="S3.SS2.SSS0.Px1.p2.1.m1.2.3.1.cmml">(</mo><mi id="S3.SS2.SSS0.Px1.p2.1.m1.1.1" xref="S3.SS2.SSS0.Px1.p2.1.m1.1.1.cmml">x</mi><mo id="S3.SS2.SSS0.Px1.p2.1.m1.2.3.2.2" xref="S3.SS2.SSS0.Px1.p2.1.m1.2.3.1.cmml">,</mo><mi id="S3.SS2.SSS0.Px1.p2.1.m1.2.2" xref="S3.SS2.SSS0.Px1.p2.1.m1.2.2.cmml">y</mi><mo id="S3.SS2.SSS0.Px1.p2.1.m1.2.3.2.3" stretchy="false" xref="S3.SS2.SSS0.Px1.p2.1.m1.2.3.1.cmml">)</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS0.Px1.p2.1.m1.2b"><interval closure="open" id="S3.SS2.SSS0.Px1.p2.1.m1.2.3.1.cmml" xref="S3.SS2.SSS0.Px1.p2.1.m1.2.3.2"><ci id="S3.SS2.SSS0.Px1.p2.1.m1.1.1.cmml" xref="S3.SS2.SSS0.Px1.p2.1.m1.1.1">𝑥</ci><ci id="S3.SS2.SSS0.Px1.p2.1.m1.2.2.cmml" xref="S3.SS2.SSS0.Px1.p2.1.m1.2.2">𝑦</ci></interval></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS0.Px1.p2.1.m1.2c">(x,y)</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS0.Px1.p2.1.m1.2d">( italic_x , italic_y )</annotation></semantics></math> is crucial to the effectiveness of the translation model <cite class="ltx_cite ltx_citemacro_cite">Zhao et al. (<a class="ltx_ref" href="https://arxiv.org/html/2405.13984v1#bib.bib43" title="">2022</a>)</cite>.</p>
</div>
</section>
<section class="ltx_paragraph" id="S3.SS2.SSS0.Px2">
<h5 class="ltx_title ltx_title_paragraph">Direct Preference Optimisation (DPO):</h5>
<div class="ltx_para" id="S3.SS2.SSS0.Px2.p1">
<p class="ltx_p" id="S3.SS2.SSS0.Px2.p1.6">DPO <cite class="ltx_cite ltx_citemacro_cite">Rafailov et al. (<a class="ltx_ref" href="https://arxiv.org/html/2405.13984v1#bib.bib26" title="">2024</a>)</cite> provides a more human-centric optimisation objective aimed at aligning the translation model <math alttext="\pi" class="ltx_Math" display="inline" id="S3.SS2.SSS0.Px2.p1.1.m1.1"><semantics id="S3.SS2.SSS0.Px2.p1.1.m1.1a"><mi id="S3.SS2.SSS0.Px2.p1.1.m1.1.1" xref="S3.SS2.SSS0.Px2.p1.1.m1.1.1.cmml">π</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS0.Px2.p1.1.m1.1b"><ci id="S3.SS2.SSS0.Px2.p1.1.m1.1.1.cmml" xref="S3.SS2.SSS0.Px2.p1.1.m1.1.1">𝜋</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS0.Px2.p1.1.m1.1c">\pi</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS0.Px2.p1.1.m1.1d">italic_π</annotation></semantics></math> with human intentions. Here <math alttext="\mathcal{D}" class="ltx_Math" display="inline" id="S3.SS2.SSS0.Px2.p1.2.m2.1"><semantics id="S3.SS2.SSS0.Px2.p1.2.m2.1a"><mi class="ltx_font_mathcaligraphic" id="S3.SS2.SSS0.Px2.p1.2.m2.1.1" xref="S3.SS2.SSS0.Px2.p1.2.m2.1.1.cmml">𝒟</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS0.Px2.p1.2.m2.1b"><ci id="S3.SS2.SSS0.Px2.p1.2.m2.1.1.cmml" xref="S3.SS2.SSS0.Px2.p1.2.m2.1.1">𝒟</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS0.Px2.p1.2.m2.1c">\mathcal{D}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS0.Px2.p1.2.m2.1d">caligraphic_D</annotation></semantics></math> is an offline dataset of comparisons <math alttext="\mathcal{D}=\{x^{(i)},y_{w}^{(i)},y_{l}^{(i)}\}{i=1}^{N}" class="ltx_Math" display="inline" id="S3.SS2.SSS0.Px2.p1.3.m3.6"><semantics id="S3.SS2.SSS0.Px2.p1.3.m3.6a"><mrow id="S3.SS2.SSS0.Px2.p1.3.m3.6.6" xref="S3.SS2.SSS0.Px2.p1.3.m3.6.6.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS2.SSS0.Px2.p1.3.m3.6.6.5" xref="S3.SS2.SSS0.Px2.p1.3.m3.6.6.5.cmml">𝒟</mi><mo id="S3.SS2.SSS0.Px2.p1.3.m3.6.6.6" xref="S3.SS2.SSS0.Px2.p1.3.m3.6.6.6.cmml">=</mo><mrow id="S3.SS2.SSS0.Px2.p1.3.m3.6.6.3" xref="S3.SS2.SSS0.Px2.p1.3.m3.6.6.3.cmml"><mrow id="S3.SS2.SSS0.Px2.p1.3.m3.6.6.3.3.3" xref="S3.SS2.SSS0.Px2.p1.3.m3.6.6.3.3.4.cmml"><mo id="S3.SS2.SSS0.Px2.p1.3.m3.6.6.3.3.3.4" stretchy="false" xref="S3.SS2.SSS0.Px2.p1.3.m3.6.6.3.3.4.cmml">{</mo><msup id="S3.SS2.SSS0.Px2.p1.3.m3.4.4.1.1.1.1" xref="S3.SS2.SSS0.Px2.p1.3.m3.4.4.1.1.1.1.cmml"><mi id="S3.SS2.SSS0.Px2.p1.3.m3.4.4.1.1.1.1.2" xref="S3.SS2.SSS0.Px2.p1.3.m3.4.4.1.1.1.1.2.cmml">x</mi><mrow id="S3.SS2.SSS0.Px2.p1.3.m3.1.1.1.3" xref="S3.SS2.SSS0.Px2.p1.3.m3.4.4.1.1.1.1.cmml"><mo id="S3.SS2.SSS0.Px2.p1.3.m3.1.1.1.3.1" stretchy="false" xref="S3.SS2.SSS0.Px2.p1.3.m3.4.4.1.1.1.1.cmml">(</mo><mi id="S3.SS2.SSS0.Px2.p1.3.m3.1.1.1.1" xref="S3.SS2.SSS0.Px2.p1.3.m3.1.1.1.1.cmml">i</mi><mo id="S3.SS2.SSS0.Px2.p1.3.m3.1.1.1.3.2" stretchy="false" xref="S3.SS2.SSS0.Px2.p1.3.m3.4.4.1.1.1.1.cmml">)</mo></mrow></msup><mo id="S3.SS2.SSS0.Px2.p1.3.m3.6.6.3.3.3.5" xref="S3.SS2.SSS0.Px2.p1.3.m3.6.6.3.3.4.cmml">,</mo><msubsup id="S3.SS2.SSS0.Px2.p1.3.m3.5.5.2.2.2.2" xref="S3.SS2.SSS0.Px2.p1.3.m3.5.5.2.2.2.2.cmml"><mi id="S3.SS2.SSS0.Px2.p1.3.m3.5.5.2.2.2.2.2.2" xref="S3.SS2.SSS0.Px2.p1.3.m3.5.5.2.2.2.2.2.2.cmml">y</mi><mi id="S3.SS2.SSS0.Px2.p1.3.m3.5.5.2.2.2.2.2.3" xref="S3.SS2.SSS0.Px2.p1.3.m3.5.5.2.2.2.2.2.3.cmml">w</mi><mrow id="S3.SS2.SSS0.Px2.p1.3.m3.2.2.1.3" xref="S3.SS2.SSS0.Px2.p1.3.m3.5.5.2.2.2.2.cmml"><mo id="S3.SS2.SSS0.Px2.p1.3.m3.2.2.1.3.1" stretchy="false" xref="S3.SS2.SSS0.Px2.p1.3.m3.5.5.2.2.2.2.cmml">(</mo><mi id="S3.SS2.SSS0.Px2.p1.3.m3.2.2.1.1" xref="S3.SS2.SSS0.Px2.p1.3.m3.2.2.1.1.cmml">i</mi><mo id="S3.SS2.SSS0.Px2.p1.3.m3.2.2.1.3.2" stretchy="false" xref="S3.SS2.SSS0.Px2.p1.3.m3.5.5.2.2.2.2.cmml">)</mo></mrow></msubsup><mo id="S3.SS2.SSS0.Px2.p1.3.m3.6.6.3.3.3.6" xref="S3.SS2.SSS0.Px2.p1.3.m3.6.6.3.3.4.cmml">,</mo><msubsup id="S3.SS2.SSS0.Px2.p1.3.m3.6.6.3.3.3.3" xref="S3.SS2.SSS0.Px2.p1.3.m3.6.6.3.3.3.3.cmml"><mi id="S3.SS2.SSS0.Px2.p1.3.m3.6.6.3.3.3.3.2.2" xref="S3.SS2.SSS0.Px2.p1.3.m3.6.6.3.3.3.3.2.2.cmml">y</mi><mi id="S3.SS2.SSS0.Px2.p1.3.m3.6.6.3.3.3.3.2.3" xref="S3.SS2.SSS0.Px2.p1.3.m3.6.6.3.3.3.3.2.3.cmml">l</mi><mrow id="S3.SS2.SSS0.Px2.p1.3.m3.3.3.1.3" xref="S3.SS2.SSS0.Px2.p1.3.m3.6.6.3.3.3.3.cmml"><mo id="S3.SS2.SSS0.Px2.p1.3.m3.3.3.1.3.1" stretchy="false" xref="S3.SS2.SSS0.Px2.p1.3.m3.6.6.3.3.3.3.cmml">(</mo><mi id="S3.SS2.SSS0.Px2.p1.3.m3.3.3.1.1" xref="S3.SS2.SSS0.Px2.p1.3.m3.3.3.1.1.cmml">i</mi><mo id="S3.SS2.SSS0.Px2.p1.3.m3.3.3.1.3.2" stretchy="false" xref="S3.SS2.SSS0.Px2.p1.3.m3.6.6.3.3.3.3.cmml">)</mo></mrow></msubsup><mo id="S3.SS2.SSS0.Px2.p1.3.m3.6.6.3.3.3.7" stretchy="false" xref="S3.SS2.SSS0.Px2.p1.3.m3.6.6.3.3.4.cmml">}</mo></mrow><mo id="S3.SS2.SSS0.Px2.p1.3.m3.6.6.3.4" xref="S3.SS2.SSS0.Px2.p1.3.m3.6.6.3.4.cmml">⁢</mo><mi id="S3.SS2.SSS0.Px2.p1.3.m3.6.6.3.5" xref="S3.SS2.SSS0.Px2.p1.3.m3.6.6.3.5.cmml">i</mi></mrow><mo id="S3.SS2.SSS0.Px2.p1.3.m3.6.6.7" xref="S3.SS2.SSS0.Px2.p1.3.m3.6.6.7.cmml">=</mo><msup id="S3.SS2.SSS0.Px2.p1.3.m3.6.6.8" xref="S3.SS2.SSS0.Px2.p1.3.m3.6.6.8.cmml"><mn id="S3.SS2.SSS0.Px2.p1.3.m3.6.6.8.2" xref="S3.SS2.SSS0.Px2.p1.3.m3.6.6.8.2.cmml">1</mn><mi id="S3.SS2.SSS0.Px2.p1.3.m3.6.6.8.3" xref="S3.SS2.SSS0.Px2.p1.3.m3.6.6.8.3.cmml">N</mi></msup></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS0.Px2.p1.3.m3.6b"><apply id="S3.SS2.SSS0.Px2.p1.3.m3.6.6.cmml" xref="S3.SS2.SSS0.Px2.p1.3.m3.6.6"><and id="S3.SS2.SSS0.Px2.p1.3.m3.6.6a.cmml" xref="S3.SS2.SSS0.Px2.p1.3.m3.6.6"></and><apply id="S3.SS2.SSS0.Px2.p1.3.m3.6.6b.cmml" xref="S3.SS2.SSS0.Px2.p1.3.m3.6.6"><eq id="S3.SS2.SSS0.Px2.p1.3.m3.6.6.6.cmml" xref="S3.SS2.SSS0.Px2.p1.3.m3.6.6.6"></eq><ci id="S3.SS2.SSS0.Px2.p1.3.m3.6.6.5.cmml" xref="S3.SS2.SSS0.Px2.p1.3.m3.6.6.5">𝒟</ci><apply id="S3.SS2.SSS0.Px2.p1.3.m3.6.6.3.cmml" xref="S3.SS2.SSS0.Px2.p1.3.m3.6.6.3"><times id="S3.SS2.SSS0.Px2.p1.3.m3.6.6.3.4.cmml" xref="S3.SS2.SSS0.Px2.p1.3.m3.6.6.3.4"></times><set id="S3.SS2.SSS0.Px2.p1.3.m3.6.6.3.3.4.cmml" xref="S3.SS2.SSS0.Px2.p1.3.m3.6.6.3.3.3"><apply id="S3.SS2.SSS0.Px2.p1.3.m3.4.4.1.1.1.1.cmml" xref="S3.SS2.SSS0.Px2.p1.3.m3.4.4.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS2.SSS0.Px2.p1.3.m3.4.4.1.1.1.1.1.cmml" xref="S3.SS2.SSS0.Px2.p1.3.m3.4.4.1.1.1.1">superscript</csymbol><ci id="S3.SS2.SSS0.Px2.p1.3.m3.4.4.1.1.1.1.2.cmml" xref="S3.SS2.SSS0.Px2.p1.3.m3.4.4.1.1.1.1.2">𝑥</ci><ci id="S3.SS2.SSS0.Px2.p1.3.m3.1.1.1.1.cmml" xref="S3.SS2.SSS0.Px2.p1.3.m3.1.1.1.1">𝑖</ci></apply><apply id="S3.SS2.SSS0.Px2.p1.3.m3.5.5.2.2.2.2.cmml" xref="S3.SS2.SSS0.Px2.p1.3.m3.5.5.2.2.2.2"><csymbol cd="ambiguous" id="S3.SS2.SSS0.Px2.p1.3.m3.5.5.2.2.2.2.1.cmml" xref="S3.SS2.SSS0.Px2.p1.3.m3.5.5.2.2.2.2">superscript</csymbol><apply id="S3.SS2.SSS0.Px2.p1.3.m3.5.5.2.2.2.2.2.cmml" xref="S3.SS2.SSS0.Px2.p1.3.m3.5.5.2.2.2.2"><csymbol cd="ambiguous" id="S3.SS2.SSS0.Px2.p1.3.m3.5.5.2.2.2.2.2.1.cmml" xref="S3.SS2.SSS0.Px2.p1.3.m3.5.5.2.2.2.2">subscript</csymbol><ci id="S3.SS2.SSS0.Px2.p1.3.m3.5.5.2.2.2.2.2.2.cmml" xref="S3.SS2.SSS0.Px2.p1.3.m3.5.5.2.2.2.2.2.2">𝑦</ci><ci id="S3.SS2.SSS0.Px2.p1.3.m3.5.5.2.2.2.2.2.3.cmml" xref="S3.SS2.SSS0.Px2.p1.3.m3.5.5.2.2.2.2.2.3">𝑤</ci></apply><ci id="S3.SS2.SSS0.Px2.p1.3.m3.2.2.1.1.cmml" xref="S3.SS2.SSS0.Px2.p1.3.m3.2.2.1.1">𝑖</ci></apply><apply id="S3.SS2.SSS0.Px2.p1.3.m3.6.6.3.3.3.3.cmml" xref="S3.SS2.SSS0.Px2.p1.3.m3.6.6.3.3.3.3"><csymbol cd="ambiguous" id="S3.SS2.SSS0.Px2.p1.3.m3.6.6.3.3.3.3.1.cmml" xref="S3.SS2.SSS0.Px2.p1.3.m3.6.6.3.3.3.3">superscript</csymbol><apply id="S3.SS2.SSS0.Px2.p1.3.m3.6.6.3.3.3.3.2.cmml" xref="S3.SS2.SSS0.Px2.p1.3.m3.6.6.3.3.3.3"><csymbol cd="ambiguous" id="S3.SS2.SSS0.Px2.p1.3.m3.6.6.3.3.3.3.2.1.cmml" xref="S3.SS2.SSS0.Px2.p1.3.m3.6.6.3.3.3.3">subscript</csymbol><ci id="S3.SS2.SSS0.Px2.p1.3.m3.6.6.3.3.3.3.2.2.cmml" xref="S3.SS2.SSS0.Px2.p1.3.m3.6.6.3.3.3.3.2.2">𝑦</ci><ci id="S3.SS2.SSS0.Px2.p1.3.m3.6.6.3.3.3.3.2.3.cmml" xref="S3.SS2.SSS0.Px2.p1.3.m3.6.6.3.3.3.3.2.3">𝑙</ci></apply><ci id="S3.SS2.SSS0.Px2.p1.3.m3.3.3.1.1.cmml" xref="S3.SS2.SSS0.Px2.p1.3.m3.3.3.1.1">𝑖</ci></apply></set><ci id="S3.SS2.SSS0.Px2.p1.3.m3.6.6.3.5.cmml" xref="S3.SS2.SSS0.Px2.p1.3.m3.6.6.3.5">𝑖</ci></apply></apply><apply id="S3.SS2.SSS0.Px2.p1.3.m3.6.6c.cmml" xref="S3.SS2.SSS0.Px2.p1.3.m3.6.6"><eq id="S3.SS2.SSS0.Px2.p1.3.m3.6.6.7.cmml" xref="S3.SS2.SSS0.Px2.p1.3.m3.6.6.7"></eq><share href="https://arxiv.org/html/2405.13984v1#S3.SS2.SSS0.Px2.p1.3.m3.6.6.3.cmml" id="S3.SS2.SSS0.Px2.p1.3.m3.6.6d.cmml" xref="S3.SS2.SSS0.Px2.p1.3.m3.6.6"></share><apply id="S3.SS2.SSS0.Px2.p1.3.m3.6.6.8.cmml" xref="S3.SS2.SSS0.Px2.p1.3.m3.6.6.8"><csymbol cd="ambiguous" id="S3.SS2.SSS0.Px2.p1.3.m3.6.6.8.1.cmml" xref="S3.SS2.SSS0.Px2.p1.3.m3.6.6.8">superscript</csymbol><cn id="S3.SS2.SSS0.Px2.p1.3.m3.6.6.8.2.cmml" type="integer" xref="S3.SS2.SSS0.Px2.p1.3.m3.6.6.8.2">1</cn><ci id="S3.SS2.SSS0.Px2.p1.3.m3.6.6.8.3.cmml" xref="S3.SS2.SSS0.Px2.p1.3.m3.6.6.8.3">𝑁</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS0.Px2.p1.3.m3.6c">\mathcal{D}=\{x^{(i)},y_{w}^{(i)},y_{l}^{(i)}\}{i=1}^{N}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS0.Px2.p1.3.m3.6d">caligraphic_D = { italic_x start_POSTSUPERSCRIPT ( italic_i ) end_POSTSUPERSCRIPT , italic_y start_POSTSUBSCRIPT italic_w end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ( italic_i ) end_POSTSUPERSCRIPT , italic_y start_POSTSUBSCRIPT italic_l end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ( italic_i ) end_POSTSUPERSCRIPT } italic_i = 1 start_POSTSUPERSCRIPT italic_N end_POSTSUPERSCRIPT</annotation></semantics></math>, where <math alttext="y_{w}" class="ltx_Math" display="inline" id="S3.SS2.SSS0.Px2.p1.4.m4.1"><semantics id="S3.SS2.SSS0.Px2.p1.4.m4.1a"><msub id="S3.SS2.SSS0.Px2.p1.4.m4.1.1" xref="S3.SS2.SSS0.Px2.p1.4.m4.1.1.cmml"><mi id="S3.SS2.SSS0.Px2.p1.4.m4.1.1.2" xref="S3.SS2.SSS0.Px2.p1.4.m4.1.1.2.cmml">y</mi><mi id="S3.SS2.SSS0.Px2.p1.4.m4.1.1.3" xref="S3.SS2.SSS0.Px2.p1.4.m4.1.1.3.cmml">w</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS0.Px2.p1.4.m4.1b"><apply id="S3.SS2.SSS0.Px2.p1.4.m4.1.1.cmml" xref="S3.SS2.SSS0.Px2.p1.4.m4.1.1"><csymbol cd="ambiguous" id="S3.SS2.SSS0.Px2.p1.4.m4.1.1.1.cmml" xref="S3.SS2.SSS0.Px2.p1.4.m4.1.1">subscript</csymbol><ci id="S3.SS2.SSS0.Px2.p1.4.m4.1.1.2.cmml" xref="S3.SS2.SSS0.Px2.p1.4.m4.1.1.2">𝑦</ci><ci id="S3.SS2.SSS0.Px2.p1.4.m4.1.1.3.cmml" xref="S3.SS2.SSS0.Px2.p1.4.m4.1.1.3">𝑤</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS0.Px2.p1.4.m4.1c">y_{w}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS0.Px2.p1.4.m4.1d">italic_y start_POSTSUBSCRIPT italic_w end_POSTSUBSCRIPT</annotation></semantics></math> represents the preferred translation (e.g. human gold standard), and <math alttext="y_{l}" class="ltx_Math" display="inline" id="S3.SS2.SSS0.Px2.p1.5.m5.1"><semantics id="S3.SS2.SSS0.Px2.p1.5.m5.1a"><msub id="S3.SS2.SSS0.Px2.p1.5.m5.1.1" xref="S3.SS2.SSS0.Px2.p1.5.m5.1.1.cmml"><mi id="S3.SS2.SSS0.Px2.p1.5.m5.1.1.2" xref="S3.SS2.SSS0.Px2.p1.5.m5.1.1.2.cmml">y</mi><mi id="S3.SS2.SSS0.Px2.p1.5.m5.1.1.3" xref="S3.SS2.SSS0.Px2.p1.5.m5.1.1.3.cmml">l</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS0.Px2.p1.5.m5.1b"><apply id="S3.SS2.SSS0.Px2.p1.5.m5.1.1.cmml" xref="S3.SS2.SSS0.Px2.p1.5.m5.1.1"><csymbol cd="ambiguous" id="S3.SS2.SSS0.Px2.p1.5.m5.1.1.1.cmml" xref="S3.SS2.SSS0.Px2.p1.5.m5.1.1">subscript</csymbol><ci id="S3.SS2.SSS0.Px2.p1.5.m5.1.1.2.cmml" xref="S3.SS2.SSS0.Px2.p1.5.m5.1.1.2">𝑦</ci><ci id="S3.SS2.SSS0.Px2.p1.5.m5.1.1.3.cmml" xref="S3.SS2.SSS0.Px2.p1.5.m5.1.1.3">𝑙</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS0.Px2.p1.5.m5.1c">y_{l}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS0.Px2.p1.5.m5.1d">italic_y start_POSTSUBSCRIPT italic_l end_POSTSUBSCRIPT</annotation></semantics></math> represents the dis-preferred translation (typically synthetic outputs obtained by a translation model). The loss function for DPO is constructed as a maximum likelihood objective for a parameterised policy <math alttext="\pi_{\theta}" class="ltx_Math" display="inline" id="S3.SS2.SSS0.Px2.p1.6.m6.1"><semantics id="S3.SS2.SSS0.Px2.p1.6.m6.1a"><msub id="S3.SS2.SSS0.Px2.p1.6.m6.1.1" xref="S3.SS2.SSS0.Px2.p1.6.m6.1.1.cmml"><mi id="S3.SS2.SSS0.Px2.p1.6.m6.1.1.2" xref="S3.SS2.SSS0.Px2.p1.6.m6.1.1.2.cmml">π</mi><mi id="S3.SS2.SSS0.Px2.p1.6.m6.1.1.3" xref="S3.SS2.SSS0.Px2.p1.6.m6.1.1.3.cmml">θ</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS0.Px2.p1.6.m6.1b"><apply id="S3.SS2.SSS0.Px2.p1.6.m6.1.1.cmml" xref="S3.SS2.SSS0.Px2.p1.6.m6.1.1"><csymbol cd="ambiguous" id="S3.SS2.SSS0.Px2.p1.6.m6.1.1.1.cmml" xref="S3.SS2.SSS0.Px2.p1.6.m6.1.1">subscript</csymbol><ci id="S3.SS2.SSS0.Px2.p1.6.m6.1.1.2.cmml" xref="S3.SS2.SSS0.Px2.p1.6.m6.1.1.2">𝜋</ci><ci id="S3.SS2.SSS0.Px2.p1.6.m6.1.1.3.cmml" xref="S3.SS2.SSS0.Px2.p1.6.m6.1.1.3">𝜃</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS0.Px2.p1.6.m6.1c">\pi_{\theta}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS0.Px2.p1.6.m6.1d">italic_π start_POSTSUBSCRIPT italic_θ end_POSTSUBSCRIPT</annotation></semantics></math>;</p>
</div>
<div class="ltx_para" id="S3.SS2.SSS0.Px2.p2">
<table class="ltx_equation ltx_eqn_table" id="S3.E5">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\mathcal{L}_{\text{DPO}}(\pi_{\theta};\pi_{\text{ref}})=-\mathbb{E}_{(x,y_{w},%
y_{l})\sim\mathcal{D}}\Bigr{[}\log\sigma\Bigl{(}\underbrace{\beta\log\frac{\pi%
_{\theta}(y_{w}|x)}{\pi_{\text{ref}}(y_{w}|x)}-\beta\log\frac{\pi_{\theta}(y_{%
l}|x)}{\pi_{\text{ref}}(y_{l}|x)}}_{{\text{Optimal reward }\forall(x,y)\in L%
\times M}}\Bigl{)}\Bigr{]}" class="ltx_math_unparsed" display="block" id="S3.E5.m1.9"><semantics id="S3.E5.m1.9a"><mrow id="S3.E5.m1.9b"><msub id="S3.E5.m1.9.10"><mi class="ltx_font_mathcaligraphic" id="S3.E5.m1.9.10.2">ℒ</mi><mtext id="S3.E5.m1.9.10.3">DPO</mtext></msub><mrow id="S3.E5.m1.9.11"><mo id="S3.E5.m1.9.11.1" stretchy="false">(</mo><msub id="S3.E5.m1.9.11.2"><mi id="S3.E5.m1.9.11.2.2">π</mi><mi id="S3.E5.m1.9.11.2.3">θ</mi></msub><mo id="S3.E5.m1.9.11.3">;</mo><msub id="S3.E5.m1.9.11.4"><mi id="S3.E5.m1.9.11.4.2">π</mi><mtext id="S3.E5.m1.9.11.4.3">ref</mtext></msub><mo id="S3.E5.m1.9.11.5" stretchy="false">)</mo></mrow><mo id="S3.E5.m1.9.12" rspace="0em">=</mo><mo id="S3.E5.m1.9.13" lspace="0em">−</mo><msub id="S3.E5.m1.9.14"><mi id="S3.E5.m1.9.14.2" mathvariant="normal">𝔼</mi><mrow id="S3.E5.m1.3.3.3"><mrow id="S3.E5.m1.3.3.3.3.2"><mo id="S3.E5.m1.3.3.3.3.2.3" stretchy="false">(</mo><mi id="S3.E5.m1.1.1.1.1">x</mi><mo id="S3.E5.m1.3.3.3.3.2.4">,</mo><msub id="S3.E5.m1.2.2.2.2.1.1"><mi id="S3.E5.m1.2.2.2.2.1.1.2">y</mi><mi id="S3.E5.m1.2.2.2.2.1.1.3">w</mi></msub><mo id="S3.E5.m1.3.3.3.3.2.5">,</mo><msub id="S3.E5.m1.3.3.3.3.2.2"><mi id="S3.E5.m1.3.3.3.3.2.2.2">y</mi><mi id="S3.E5.m1.3.3.3.3.2.2.3">l</mi></msub><mo id="S3.E5.m1.3.3.3.3.2.6" stretchy="false">)</mo></mrow><mo id="S3.E5.m1.3.3.3.4">∼</mo><mi class="ltx_font_mathcaligraphic" id="S3.E5.m1.3.3.3.5">𝒟</mi></mrow></msub><mo id="S3.E5.m1.9.15" lspace="0em" mathsize="160%" rspace="0.167em">[</mo><mi id="S3.E5.m1.9.16">log</mi><mi id="S3.E5.m1.9.17">σ</mi><mo id="S3.E5.m1.9.18" maxsize="160%" minsize="160%">(</mo><munder id="S3.E5.m1.9.19"><munder accentunder="true" id="S3.E5.m1.7.7"><mrow id="S3.E5.m1.7.7.4"><mrow id="S3.E5.m1.7.7.4.6"><mi id="S3.E5.m1.7.7.4.6.2">β</mi><mo id="S3.E5.m1.7.7.4.6.1" lspace="0.167em">⁢</mo><mrow id="S3.E5.m1.7.7.4.6.3"><mi id="S3.E5.m1.7.7.4.6.3.1">log</mi><mo id="S3.E5.m1.7.7.4.6.3a" lspace="0.167em">⁡</mo><mfrac id="S3.E5.m1.5.5.2.2"><mrow id="S3.E5.m1.4.4.1.1.1"><msub id="S3.E5.m1.4.4.1.1.1.3"><mi id="S3.E5.m1.4.4.1.1.1.3.2">π</mi><mi id="S3.E5.m1.4.4.1.1.1.3.3">θ</mi></msub><mo id="S3.E5.m1.4.4.1.1.1.2">⁢</mo><mrow id="S3.E5.m1.4.4.1.1.1.1.1"><mo id="S3.E5.m1.4.4.1.1.1.1.1.2" stretchy="false">(</mo><mrow id="S3.E5.m1.4.4.1.1.1.1.1.1"><msub id="S3.E5.m1.4.4.1.1.1.1.1.1.2"><mi id="S3.E5.m1.4.4.1.1.1.1.1.1.2.2">y</mi><mi id="S3.E5.m1.4.4.1.1.1.1.1.1.2.3">w</mi></msub><mo fence="false" id="S3.E5.m1.4.4.1.1.1.1.1.1.1">|</mo><mi id="S3.E5.m1.4.4.1.1.1.1.1.1.3">x</mi></mrow><mo id="S3.E5.m1.4.4.1.1.1.1.1.3" stretchy="false">)</mo></mrow></mrow><mrow id="S3.E5.m1.5.5.2.2.2"><msub id="S3.E5.m1.5.5.2.2.2.3"><mi id="S3.E5.m1.5.5.2.2.2.3.2">π</mi><mtext id="S3.E5.m1.5.5.2.2.2.3.3">ref</mtext></msub><mo id="S3.E5.m1.5.5.2.2.2.2">⁢</mo><mrow id="S3.E5.m1.5.5.2.2.2.1.1"><mo id="S3.E5.m1.5.5.2.2.2.1.1.2" stretchy="false">(</mo><mrow id="S3.E5.m1.5.5.2.2.2.1.1.1"><msub id="S3.E5.m1.5.5.2.2.2.1.1.1.2"><mi id="S3.E5.m1.5.5.2.2.2.1.1.1.2.2">y</mi><mi id="S3.E5.m1.5.5.2.2.2.1.1.1.2.3">w</mi></msub><mo fence="false" id="S3.E5.m1.5.5.2.2.2.1.1.1.1">|</mo><mi id="S3.E5.m1.5.5.2.2.2.1.1.1.3">x</mi></mrow><mo id="S3.E5.m1.5.5.2.2.2.1.1.3" stretchy="false">)</mo></mrow></mrow></mfrac></mrow></mrow><mo id="S3.E5.m1.7.7.4.5">−</mo><mrow id="S3.E5.m1.7.7.4.7"><mi id="S3.E5.m1.7.7.4.7.2">β</mi><mo id="S3.E5.m1.7.7.4.7.1" lspace="0.167em">⁢</mo><mrow id="S3.E5.m1.7.7.4.7.3"><mi id="S3.E5.m1.7.7.4.7.3.1">log</mi><mo id="S3.E5.m1.7.7.4.7.3a" lspace="0.167em">⁡</mo><mfrac id="S3.E5.m1.7.7.4.4"><mrow id="S3.E5.m1.6.6.3.3.1"><msub id="S3.E5.m1.6.6.3.3.1.3"><mi id="S3.E5.m1.6.6.3.3.1.3.2">π</mi><mi id="S3.E5.m1.6.6.3.3.1.3.3">θ</mi></msub><mo id="S3.E5.m1.6.6.3.3.1.2">⁢</mo><mrow id="S3.E5.m1.6.6.3.3.1.1.1"><mo id="S3.E5.m1.6.6.3.3.1.1.1.2" stretchy="false">(</mo><mrow id="S3.E5.m1.6.6.3.3.1.1.1.1"><msub id="S3.E5.m1.6.6.3.3.1.1.1.1.2"><mi id="S3.E5.m1.6.6.3.3.1.1.1.1.2.2">y</mi><mi id="S3.E5.m1.6.6.3.3.1.1.1.1.2.3">l</mi></msub><mo fence="false" id="S3.E5.m1.6.6.3.3.1.1.1.1.1">|</mo><mi id="S3.E5.m1.6.6.3.3.1.1.1.1.3">x</mi></mrow><mo id="S3.E5.m1.6.6.3.3.1.1.1.3" stretchy="false">)</mo></mrow></mrow><mrow id="S3.E5.m1.7.7.4.4.2"><msub id="S3.E5.m1.7.7.4.4.2.3"><mi id="S3.E5.m1.7.7.4.4.2.3.2">π</mi><mtext id="S3.E5.m1.7.7.4.4.2.3.3">ref</mtext></msub><mo id="S3.E5.m1.7.7.4.4.2.2">⁢</mo><mrow id="S3.E5.m1.7.7.4.4.2.1.1"><mo id="S3.E5.m1.7.7.4.4.2.1.1.2" stretchy="false">(</mo><mrow id="S3.E5.m1.7.7.4.4.2.1.1.1"><msub id="S3.E5.m1.7.7.4.4.2.1.1.1.2"><mi id="S3.E5.m1.7.7.4.4.2.1.1.1.2.2">y</mi><mi id="S3.E5.m1.7.7.4.4.2.1.1.1.2.3">l</mi></msub><mo fence="false" id="S3.E5.m1.7.7.4.4.2.1.1.1.1">|</mo><mi id="S3.E5.m1.7.7.4.4.2.1.1.1.3">x</mi></mrow><mo id="S3.E5.m1.7.7.4.4.2.1.1.3" stretchy="false">)</mo></mrow></mrow></mfrac></mrow></mrow></mrow><mo id="S3.E5.m1.7.7.5">⏟</mo></munder><mrow id="S3.E5.m1.9.9.2"><mrow id="S3.E5.m1.9.9.2.4"><mtext id="S3.E5.m1.9.9.2.4.2">Optimal reward </mtext><mo id="S3.E5.m1.9.9.2.4.1" lspace="0.167em">⁢</mo><mrow id="S3.E5.m1.9.9.2.4.3"><mo id="S3.E5.m1.9.9.2.4.3.1">∀</mo><mrow id="S3.E5.m1.9.9.2.4.3.2.2"><mo id="S3.E5.m1.9.9.2.4.3.2.2.1" stretchy="false">(</mo><mi id="S3.E5.m1.8.8.1.1">x</mi><mo id="S3.E5.m1.9.9.2.4.3.2.2.2">,</mo><mi id="S3.E5.m1.9.9.2.2">y</mi><mo id="S3.E5.m1.9.9.2.4.3.2.2.3" stretchy="false">)</mo></mrow></mrow></mrow><mo id="S3.E5.m1.9.9.2.3">∈</mo><mrow id="S3.E5.m1.9.9.2.5"><mi id="S3.E5.m1.9.9.2.5.2">L</mi><mo id="S3.E5.m1.9.9.2.5.1" lspace="0.222em" rspace="0.222em">×</mo><mi id="S3.E5.m1.9.9.2.5.3">M</mi></mrow></mrow></munder><mrow id="S3.E5.m1.9.20"><mo id="S3.E5.m1.9.20.1" lspace="0em" mathsize="160%" rspace="0em">)</mo><mo id="S3.E5.m1.9.20.2" maxsize="160%" minsize="160%">]</mo></mrow></mrow><annotation encoding="application/x-tex" id="S3.E5.m1.9c">\mathcal{L}_{\text{DPO}}(\pi_{\theta};\pi_{\text{ref}})=-\mathbb{E}_{(x,y_{w},%
y_{l})\sim\mathcal{D}}\Bigr{[}\log\sigma\Bigl{(}\underbrace{\beta\log\frac{\pi%
_{\theta}(y_{w}|x)}{\pi_{\text{ref}}(y_{w}|x)}-\beta\log\frac{\pi_{\theta}(y_{%
l}|x)}{\pi_{\text{ref}}(y_{l}|x)}}_{{\text{Optimal reward }\forall(x,y)\in L%
\times M}}\Bigl{)}\Bigr{]}</annotation><annotation encoding="application/x-llamapun" id="S3.E5.m1.9d">caligraphic_L start_POSTSUBSCRIPT DPO end_POSTSUBSCRIPT ( italic_π start_POSTSUBSCRIPT italic_θ end_POSTSUBSCRIPT ; italic_π start_POSTSUBSCRIPT ref end_POSTSUBSCRIPT ) = - roman_𝔼 start_POSTSUBSCRIPT ( italic_x , italic_y start_POSTSUBSCRIPT italic_w end_POSTSUBSCRIPT , italic_y start_POSTSUBSCRIPT italic_l end_POSTSUBSCRIPT ) ∼ caligraphic_D end_POSTSUBSCRIPT [ roman_log italic_σ ( under⏟ start_ARG italic_β roman_log divide start_ARG italic_π start_POSTSUBSCRIPT italic_θ end_POSTSUBSCRIPT ( italic_y start_POSTSUBSCRIPT italic_w end_POSTSUBSCRIPT | italic_x ) end_ARG start_ARG italic_π start_POSTSUBSCRIPT ref end_POSTSUBSCRIPT ( italic_y start_POSTSUBSCRIPT italic_w end_POSTSUBSCRIPT | italic_x ) end_ARG - italic_β roman_log divide start_ARG italic_π start_POSTSUBSCRIPT italic_θ end_POSTSUBSCRIPT ( italic_y start_POSTSUBSCRIPT italic_l end_POSTSUBSCRIPT | italic_x ) end_ARG start_ARG italic_π start_POSTSUBSCRIPT ref end_POSTSUBSCRIPT ( italic_y start_POSTSUBSCRIPT italic_l end_POSTSUBSCRIPT | italic_x ) end_ARG end_ARG start_POSTSUBSCRIPT Optimal reward ∀ ( italic_x , italic_y ) ∈ italic_L × italic_M end_POSTSUBSCRIPT ) ]</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(5)</span></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S3.SS2.SSS0.Px2.p2.3">where <math alttext="\pi_{\text{ref}}" class="ltx_Math" display="inline" id="S3.SS2.SSS0.Px2.p2.1.m1.1"><semantics id="S3.SS2.SSS0.Px2.p2.1.m1.1a"><msub id="S3.SS2.SSS0.Px2.p2.1.m1.1.1" xref="S3.SS2.SSS0.Px2.p2.1.m1.1.1.cmml"><mi id="S3.SS2.SSS0.Px2.p2.1.m1.1.1.2" xref="S3.SS2.SSS0.Px2.p2.1.m1.1.1.2.cmml">π</mi><mtext id="S3.SS2.SSS0.Px2.p2.1.m1.1.1.3" xref="S3.SS2.SSS0.Px2.p2.1.m1.1.1.3a.cmml">ref</mtext></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS0.Px2.p2.1.m1.1b"><apply id="S3.SS2.SSS0.Px2.p2.1.m1.1.1.cmml" xref="S3.SS2.SSS0.Px2.p2.1.m1.1.1"><csymbol cd="ambiguous" id="S3.SS2.SSS0.Px2.p2.1.m1.1.1.1.cmml" xref="S3.SS2.SSS0.Px2.p2.1.m1.1.1">subscript</csymbol><ci id="S3.SS2.SSS0.Px2.p2.1.m1.1.1.2.cmml" xref="S3.SS2.SSS0.Px2.p2.1.m1.1.1.2">𝜋</ci><ci id="S3.SS2.SSS0.Px2.p2.1.m1.1.1.3a.cmml" xref="S3.SS2.SSS0.Px2.p2.1.m1.1.1.3"><mtext id="S3.SS2.SSS0.Px2.p2.1.m1.1.1.3.cmml" mathsize="70%" xref="S3.SS2.SSS0.Px2.p2.1.m1.1.1.3">ref</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS0.Px2.p2.1.m1.1c">\pi_{\text{ref}}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS0.Px2.p2.1.m1.1d">italic_π start_POSTSUBSCRIPT ref end_POSTSUBSCRIPT</annotation></semantics></math> is the fine-tuned translation model used as the reference, <math alttext="\sigma" class="ltx_Math" display="inline" id="S3.SS2.SSS0.Px2.p2.2.m2.1"><semantics id="S3.SS2.SSS0.Px2.p2.2.m2.1a"><mi id="S3.SS2.SSS0.Px2.p2.2.m2.1.1" xref="S3.SS2.SSS0.Px2.p2.2.m2.1.1.cmml">σ</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS0.Px2.p2.2.m2.1b"><ci id="S3.SS2.SSS0.Px2.p2.2.m2.1.1.cmml" xref="S3.SS2.SSS0.Px2.p2.2.m2.1.1">𝜎</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS0.Px2.p2.2.m2.1c">\sigma</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS0.Px2.p2.2.m2.1d">italic_σ</annotation></semantics></math> is the Sigmoid function, and <math alttext="\beta" class="ltx_Math" display="inline" id="S3.SS2.SSS0.Px2.p2.3.m3.1"><semantics id="S3.SS2.SSS0.Px2.p2.3.m3.1a"><mi id="S3.SS2.SSS0.Px2.p2.3.m3.1.1" xref="S3.SS2.SSS0.Px2.p2.3.m3.1.1.cmml">β</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS0.Px2.p2.3.m3.1b"><ci id="S3.SS2.SSS0.Px2.p2.3.m3.1.1.cmml" xref="S3.SS2.SSS0.Px2.p2.3.m3.1.1">𝛽</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS0.Px2.p2.3.m3.1c">\beta</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS0.Px2.p2.3.m3.1d">italic_β</annotation></semantics></math> is a hyper-parameter (§ <a class="ltx_ref" href="https://arxiv.org/html/2405.13984v1#S2" title="2 Foundations in RLHF for LLMs ‣ Feedback-aligned Mixed LLMs for Machine Language-Molecule Translation"><span class="ltx_text ltx_ref_tag">2</span></a>).</p>
</div>
</section>
<section class="ltx_paragraph" id="S3.SS2.SSS0.Px3">
<h5 class="ltx_title ltx_title_paragraph">Contrastive Preference Optimisation (CPO):</h5>
<div class="ltx_para" id="S3.SS2.SSS0.Px3.p1">
<p class="ltx_p" id="S3.SS2.SSS0.Px3.p1.4">DPO requires high-quality data or, at the very least, appropriately fine-tuned models. In real-world scenarios, it may not be feasible to acquire high-quality data, especially for challenging domains such as chemistry and biology. CPO is a general approximation of Eq.<a class="ltx_ref" href="https://arxiv.org/html/2405.13984v1#S3.E5" title="Equation 5 ‣ Direct Preference Optimisation (DPO): ‣ 3.2 Feedback-Aligned Optimisations Algorithms ‣ 3 Methodology ‣ Feedback-aligned Mixed LLMs for Machine Language-Molecule Translation"><span class="ltx_text ltx_ref_tag">5</span></a> that addresses the limitations of DPO by training a model to avoid generating outputs that are merely adequate, but not perfect, tested in machine translation <cite class="ltx_cite ltx_citemacro_cite">Xu et al. (<a class="ltx_ref" href="https://arxiv.org/html/2405.13984v1#bib.bib39" title="">2024</a>)</cite>. Specifically, in CPO, Eq. <a class="ltx_ref" href="https://arxiv.org/html/2405.13984v1#S3.E5" title="Equation 5 ‣ Direct Preference Optimisation (DPO): ‣ 3.2 Feedback-Aligned Optimisations Algorithms ‣ 3 Methodology ‣ Feedback-aligned Mixed LLMs for Machine Language-Molecule Translation"><span class="ltx_text ltx_ref_tag">5</span></a> is effectively approximated using a uniform reference model, which assumes equal likelihood for all possible generated outputs;</p>
<table class="ltx_equation ltx_eqn_table" id="S3.E6">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\mathcal{L}(\pi_{\theta};U)=-\mathbb{E}_{(x,y_{w},y_{l})\sim D}\Bigr{[}\log%
\sigma\Bigl{(}\beta\log\pi_{\theta}(y_{w}|x)-\beta\log\pi_{\theta}(y_{l}|x)%
\Bigl{)}\Bigr{]}" class="ltx_math_unparsed" display="block" id="S3.E6.m1.4"><semantics id="S3.E6.m1.4a"><mrow id="S3.E6.m1.4b"><mi class="ltx_font_mathcaligraphic" id="S3.E6.m1.4.5">ℒ</mi><mrow id="S3.E6.m1.4.6"><mo id="S3.E6.m1.4.6.1" stretchy="false">(</mo><msub id="S3.E6.m1.4.6.2"><mi id="S3.E6.m1.4.6.2.2">π</mi><mi id="S3.E6.m1.4.6.2.3">θ</mi></msub><mo id="S3.E6.m1.4.6.3">;</mo><mi id="S3.E6.m1.4.4">U</mi><mo id="S3.E6.m1.4.6.4" stretchy="false">)</mo></mrow><mo id="S3.E6.m1.4.7" rspace="0em">=</mo><mo id="S3.E6.m1.4.8" lspace="0em">−</mo><msub id="S3.E6.m1.4.9"><mi id="S3.E6.m1.4.9.2" mathvariant="normal">𝔼</mi><mrow id="S3.E6.m1.3.3.3"><mrow id="S3.E6.m1.3.3.3.3.2"><mo id="S3.E6.m1.3.3.3.3.2.3" stretchy="false">(</mo><mi id="S3.E6.m1.1.1.1.1">x</mi><mo id="S3.E6.m1.3.3.3.3.2.4">,</mo><msub id="S3.E6.m1.2.2.2.2.1.1"><mi id="S3.E6.m1.2.2.2.2.1.1.2">y</mi><mi id="S3.E6.m1.2.2.2.2.1.1.3">w</mi></msub><mo id="S3.E6.m1.3.3.3.3.2.5">,</mo><msub id="S3.E6.m1.3.3.3.3.2.2"><mi id="S3.E6.m1.3.3.3.3.2.2.2">y</mi><mi id="S3.E6.m1.3.3.3.3.2.2.3">l</mi></msub><mo id="S3.E6.m1.3.3.3.3.2.6" stretchy="false">)</mo></mrow><mo id="S3.E6.m1.3.3.3.4">∼</mo><mi id="S3.E6.m1.3.3.3.5">D</mi></mrow></msub><mo id="S3.E6.m1.4.10" lspace="0em" mathsize="160%" rspace="0.167em">[</mo><mi id="S3.E6.m1.4.11">log</mi><mi id="S3.E6.m1.4.12">σ</mi><mo id="S3.E6.m1.4.13" maxsize="160%" minsize="160%">(</mo><mi id="S3.E6.m1.4.14">β</mi><mi id="S3.E6.m1.4.15">log</mi><msub id="S3.E6.m1.4.16"><mi id="S3.E6.m1.4.16.2">π</mi><mi id="S3.E6.m1.4.16.3">θ</mi></msub><mrow id="S3.E6.m1.4.17"><mo id="S3.E6.m1.4.17.1" stretchy="false">(</mo><msub id="S3.E6.m1.4.17.2"><mi id="S3.E6.m1.4.17.2.2">y</mi><mi id="S3.E6.m1.4.17.2.3">w</mi></msub><mo fence="false" id="S3.E6.m1.4.17.3" rspace="0.167em" stretchy="false">|</mo><mi id="S3.E6.m1.4.17.4">x</mi><mo id="S3.E6.m1.4.17.5" stretchy="false">)</mo></mrow><mo id="S3.E6.m1.4.18">−</mo><mi id="S3.E6.m1.4.19">β</mi><mi id="S3.E6.m1.4.20">log</mi><msub id="S3.E6.m1.4.21"><mi id="S3.E6.m1.4.21.2">π</mi><mi id="S3.E6.m1.4.21.3">θ</mi></msub><mrow id="S3.E6.m1.4.22"><mo id="S3.E6.m1.4.22.1" stretchy="false">(</mo><msub id="S3.E6.m1.4.22.2"><mi id="S3.E6.m1.4.22.2.2">y</mi><mi id="S3.E6.m1.4.22.2.3">l</mi></msub><mo fence="false" id="S3.E6.m1.4.22.3" rspace="0.167em" stretchy="false">|</mo><mi id="S3.E6.m1.4.22.4">x</mi><mo id="S3.E6.m1.4.22.5" stretchy="false">)</mo></mrow><mrow id="S3.E6.m1.4.23"><mo id="S3.E6.m1.4.23.1" lspace="0em" mathsize="160%" rspace="0em">)</mo><mo id="S3.E6.m1.4.23.2" maxsize="160%" minsize="160%">]</mo></mrow></mrow><annotation encoding="application/x-tex" id="S3.E6.m1.4c">\mathcal{L}(\pi_{\theta};U)=-\mathbb{E}_{(x,y_{w},y_{l})\sim D}\Bigr{[}\log%
\sigma\Bigl{(}\beta\log\pi_{\theta}(y_{w}|x)-\beta\log\pi_{\theta}(y_{l}|x)%
\Bigl{)}\Bigr{]}</annotation><annotation encoding="application/x-llamapun" id="S3.E6.m1.4d">caligraphic_L ( italic_π start_POSTSUBSCRIPT italic_θ end_POSTSUBSCRIPT ; italic_U ) = - roman_𝔼 start_POSTSUBSCRIPT ( italic_x , italic_y start_POSTSUBSCRIPT italic_w end_POSTSUBSCRIPT , italic_y start_POSTSUBSCRIPT italic_l end_POSTSUBSCRIPT ) ∼ italic_D end_POSTSUBSCRIPT [ roman_log italic_σ ( italic_β roman_log italic_π start_POSTSUBSCRIPT italic_θ end_POSTSUBSCRIPT ( italic_y start_POSTSUBSCRIPT italic_w end_POSTSUBSCRIPT | italic_x ) - italic_β roman_log italic_π start_POSTSUBSCRIPT italic_θ end_POSTSUBSCRIPT ( italic_y start_POSTSUBSCRIPT italic_l end_POSTSUBSCRIPT | italic_x ) ) ]</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(6)</span></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S3.SS2.SSS0.Px3.p1.1">Equation <a class="ltx_ref" href="https://arxiv.org/html/2405.13984v1#S3.E6" title="Equation 6 ‣ Contrastive Preference Optimisation (CPO): ‣ 3.2 Feedback-Aligned Optimisations Algorithms ‣ 3 Methodology ‣ Feedback-aligned Mixed LLMs for Machine Language-Molecule Translation"><span class="ltx_text ltx_ref_tag">6</span></a> implies that the loss is calculated based on how well generated outputs match this uniform distribution of possible outputs, rather than being biased towards any particular one. To maintain <math alttext="\pi_{\theta}" class="ltx_Math" display="inline" id="S3.SS2.SSS0.Px3.p1.1.m1.1"><semantics id="S3.SS2.SSS0.Px3.p1.1.m1.1a"><msub id="S3.SS2.SSS0.Px3.p1.1.m1.1.1" xref="S3.SS2.SSS0.Px3.p1.1.m1.1.1.cmml"><mi id="S3.SS2.SSS0.Px3.p1.1.m1.1.1.2" xref="S3.SS2.SSS0.Px3.p1.1.m1.1.1.2.cmml">π</mi><mi id="S3.SS2.SSS0.Px3.p1.1.m1.1.1.3" xref="S3.SS2.SSS0.Px3.p1.1.m1.1.1.3.cmml">θ</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS0.Px3.p1.1.m1.1b"><apply id="S3.SS2.SSS0.Px3.p1.1.m1.1.1.cmml" xref="S3.SS2.SSS0.Px3.p1.1.m1.1.1"><csymbol cd="ambiguous" id="S3.SS2.SSS0.Px3.p1.1.m1.1.1.1.cmml" xref="S3.SS2.SSS0.Px3.p1.1.m1.1.1">subscript</csymbol><ci id="S3.SS2.SSS0.Px3.p1.1.m1.1.1.2.cmml" xref="S3.SS2.SSS0.Px3.p1.1.m1.1.1.2">𝜋</ci><ci id="S3.SS2.SSS0.Px3.p1.1.m1.1.1.3.cmml" xref="S3.SS2.SSS0.Px3.p1.1.m1.1.1.3">𝜃</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS0.Px3.p1.1.m1.1c">\pi_{\theta}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS0.Px3.p1.1.m1.1d">italic_π start_POSTSUBSCRIPT italic_θ end_POSTSUBSCRIPT</annotation></semantics></math> close to the preferred data distribution, a behaviour cloning (BC) <cite class="ltx_cite ltx_citemacro_cite">Hejna et al. (<a class="ltx_ref" href="https://arxiv.org/html/2405.13984v1#bib.bib13" title="">2023</a>)</cite> regulariser is injected;</p>
<table class="ltx_equation ltx_eqn_table" id="S3.E7">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\min_{\theta}\mathcal{L}(\pi_{\theta},U)\quad\text{s.t.}\quad\mathbb{E}_{(x,y_%
{w})\sim D}\Bigr{[}\mathbb{KL}\bigl{(}\pi_{w}(y_{w}|x)||\pi_{\theta}(y_{w}|x)%
\bigl{)}\Bigr{]}&lt;\epsilon," class="ltx_math_unparsed" display="block" id="S3.E7.m1.4"><semantics id="S3.E7.m1.4a"><mrow id="S3.E7.m1.4b"><munder id="S3.E7.m1.4.5"><mi id="S3.E7.m1.4.5.2">min</mi><mi id="S3.E7.m1.4.5.3">θ</mi></munder><mi class="ltx_font_mathcaligraphic" id="S3.E7.m1.4.6">ℒ</mi><mrow id="S3.E7.m1.4.7"><mo id="S3.E7.m1.4.7.1" stretchy="false">(</mo><msub id="S3.E7.m1.4.7.2"><mi id="S3.E7.m1.4.7.2.2">π</mi><mi id="S3.E7.m1.4.7.2.3">θ</mi></msub><mo id="S3.E7.m1.4.7.3">,</mo><mi id="S3.E7.m1.3.3">U</mi><mo id="S3.E7.m1.4.7.4" stretchy="false">)</mo></mrow><mspace id="S3.E7.m1.4.8" width="1em"></mspace><mtext id="S3.E7.m1.4.4">s.t.</mtext><mspace id="S3.E7.m1.4.9" width="1em"></mspace><msub id="S3.E7.m1.4.10"><mi id="S3.E7.m1.4.10.2" mathvariant="normal">𝔼</mi><mrow id="S3.E7.m1.2.2.2"><mrow id="S3.E7.m1.2.2.2.2.1"><mo id="S3.E7.m1.2.2.2.2.1.2" stretchy="false">(</mo><mi id="S3.E7.m1.1.1.1.1">x</mi><mo id="S3.E7.m1.2.2.2.2.1.3">,</mo><msub id="S3.E7.m1.2.2.2.2.1.1"><mi id="S3.E7.m1.2.2.2.2.1.1.2">y</mi><mi id="S3.E7.m1.2.2.2.2.1.1.3">w</mi></msub><mo id="S3.E7.m1.2.2.2.2.1.4" stretchy="false">)</mo></mrow><mo id="S3.E7.m1.2.2.2.3">∼</mo><mi id="S3.E7.m1.2.2.2.4">D</mi></mrow></msub><mo id="S3.E7.m1.4.11" lspace="0em" mathsize="160%" rspace="0em">[</mo><mi id="S3.E7.m1.4.12" mathvariant="normal">𝕂</mi><mi id="S3.E7.m1.4.13" mathvariant="normal">𝕃</mi><mo id="S3.E7.m1.4.14" maxsize="120%" minsize="120%">(</mo><msub id="S3.E7.m1.4.15"><mi id="S3.E7.m1.4.15.2">π</mi><mi id="S3.E7.m1.4.15.3">w</mi></msub><mrow id="S3.E7.m1.4.16"><mo id="S3.E7.m1.4.16.1" stretchy="false">(</mo><msub id="S3.E7.m1.4.16.2"><mi id="S3.E7.m1.4.16.2.2">y</mi><mi id="S3.E7.m1.4.16.2.3">w</mi></msub><mo fence="false" id="S3.E7.m1.4.16.3" rspace="0.167em" stretchy="false">|</mo><mi id="S3.E7.m1.4.16.4">x</mi><mo id="S3.E7.m1.4.16.5" stretchy="false">)</mo></mrow><mo fence="false" id="S3.E7.m1.4.17" rspace="0.167em" stretchy="false">|</mo><mo fence="false" id="S3.E7.m1.4.18" rspace="0.167em" stretchy="false">|</mo><msub id="S3.E7.m1.4.19"><mi id="S3.E7.m1.4.19.2">π</mi><mi id="S3.E7.m1.4.19.3">θ</mi></msub><mrow id="S3.E7.m1.4.20"><mo id="S3.E7.m1.4.20.1" stretchy="false">(</mo><msub id="S3.E7.m1.4.20.2"><mi id="S3.E7.m1.4.20.2.2">y</mi><mi id="S3.E7.m1.4.20.2.3">w</mi></msub><mo fence="false" id="S3.E7.m1.4.20.3" rspace="0.167em" stretchy="false">|</mo><mi id="S3.E7.m1.4.20.4">x</mi><mo id="S3.E7.m1.4.20.5" stretchy="false">)</mo></mrow><mrow id="S3.E7.m1.4.21"><mo id="S3.E7.m1.4.21.1" lspace="0em" mathsize="120%" rspace="0em">)</mo><mo id="S3.E7.m1.4.21.2" maxsize="160%" minsize="160%">]</mo></mrow><mo id="S3.E7.m1.4.22">&lt;</mo><mi id="S3.E7.m1.4.23">ϵ</mi><mo id="S3.E7.m1.4.24">,</mo></mrow><annotation encoding="application/x-tex" id="S3.E7.m1.4c">\min_{\theta}\mathcal{L}(\pi_{\theta},U)\quad\text{s.t.}\quad\mathbb{E}_{(x,y_%
{w})\sim D}\Bigr{[}\mathbb{KL}\bigl{(}\pi_{w}(y_{w}|x)||\pi_{\theta}(y_{w}|x)%
\bigl{)}\Bigr{]}&lt;\epsilon,</annotation><annotation encoding="application/x-llamapun" id="S3.E7.m1.4d">roman_min start_POSTSUBSCRIPT italic_θ end_POSTSUBSCRIPT caligraphic_L ( italic_π start_POSTSUBSCRIPT italic_θ end_POSTSUBSCRIPT , italic_U ) s.t. roman_𝔼 start_POSTSUBSCRIPT ( italic_x , italic_y start_POSTSUBSCRIPT italic_w end_POSTSUBSCRIPT ) ∼ italic_D end_POSTSUBSCRIPT [ roman_𝕂 roman_𝕃 ( italic_π start_POSTSUBSCRIPT italic_w end_POSTSUBSCRIPT ( italic_y start_POSTSUBSCRIPT italic_w end_POSTSUBSCRIPT | italic_x ) | | italic_π start_POSTSUBSCRIPT italic_θ end_POSTSUBSCRIPT ( italic_y start_POSTSUBSCRIPT italic_w end_POSTSUBSCRIPT | italic_x ) ) ] &lt; italic_ϵ ,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(7)</span></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S3.SS2.SSS0.Px3.p1.3">Here, <math alttext="\epsilon" class="ltx_Math" display="inline" id="S3.SS2.SSS0.Px3.p1.2.m1.1"><semantics id="S3.SS2.SSS0.Px3.p1.2.m1.1a"><mi id="S3.SS2.SSS0.Px3.p1.2.m1.1.1" xref="S3.SS2.SSS0.Px3.p1.2.m1.1.1.cmml">ϵ</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS0.Px3.p1.2.m1.1b"><ci id="S3.SS2.SSS0.Px3.p1.2.m1.1.1.cmml" xref="S3.SS2.SSS0.Px3.p1.2.m1.1.1">italic-ϵ</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS0.Px3.p1.2.m1.1c">\epsilon</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS0.Px3.p1.2.m1.1d">italic_ϵ</annotation></semantics></math> denotes a small positive constant, and <math alttext="\mathbb{KL}" class="ltx_Math" display="inline" id="S3.SS2.SSS0.Px3.p1.3.m2.1"><semantics id="S3.SS2.SSS0.Px3.p1.3.m2.1a"><mrow id="S3.SS2.SSS0.Px3.p1.3.m2.1.1" xref="S3.SS2.SSS0.Px3.p1.3.m2.1.1.cmml"><mi id="S3.SS2.SSS0.Px3.p1.3.m2.1.1.2" mathvariant="normal" xref="S3.SS2.SSS0.Px3.p1.3.m2.1.1.2.cmml">𝕂</mi><mo id="S3.SS2.SSS0.Px3.p1.3.m2.1.1.1" xref="S3.SS2.SSS0.Px3.p1.3.m2.1.1.1.cmml">⁢</mo><mi id="S3.SS2.SSS0.Px3.p1.3.m2.1.1.3" mathvariant="normal" xref="S3.SS2.SSS0.Px3.p1.3.m2.1.1.3.cmml">𝕃</mi></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS0.Px3.p1.3.m2.1b"><apply id="S3.SS2.SSS0.Px3.p1.3.m2.1.1.cmml" xref="S3.SS2.SSS0.Px3.p1.3.m2.1.1"><times id="S3.SS2.SSS0.Px3.p1.3.m2.1.1.1.cmml" xref="S3.SS2.SSS0.Px3.p1.3.m2.1.1.1"></times><ci id="S3.SS2.SSS0.Px3.p1.3.m2.1.1.2.cmml" xref="S3.SS2.SSS0.Px3.p1.3.m2.1.1.2">𝕂</ci><ci id="S3.SS2.SSS0.Px3.p1.3.m2.1.1.3.cmml" xref="S3.SS2.SSS0.Px3.p1.3.m2.1.1.3">𝕃</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS0.Px3.p1.3.m2.1c">\mathbb{KL}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS0.Px3.p1.3.m2.1d">roman_𝕂 roman_𝕃</annotation></semantics></math> signifies the Kullback-Leibler divergence. Finally, the regulariser is streamlined with an additional SFT term on the preferred data;</p>
<table class="ltx_equation ltx_eqn_table" id="S3.E8">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\mathcal{L}_{\text{CPO}}=\min_{\theta}\underbrace{\mathcal{L}(\pi_{\theta},U)}%
_{\mathcal{L}_{\text{prefer}}}-\underbrace{\mathbb{E}_{(x,y_{w})\sim D}\bigr{[%
}\log\pi_{\theta}(y_{w}|x)\bigr{]}}_{\mathcal{L}_{\text{NLL}}}" class="ltx_math_unparsed" display="block" id="S3.E8.m1.4"><semantics id="S3.E8.m1.4a"><mrow id="S3.E8.m1.4.5"><msub id="S3.E8.m1.4.5.2"><mi class="ltx_font_mathcaligraphic" id="S3.E8.m1.4.5.2.2">ℒ</mi><mtext id="S3.E8.m1.4.5.2.3">CPO</mtext></msub><mo id="S3.E8.m1.4.5.1">=</mo><mrow id="S3.E8.m1.4.5.3"><mrow id="S3.E8.m1.4.5.3.2"><munder id="S3.E8.m1.4.5.3.2.1"><mi id="S3.E8.m1.4.5.3.2.1.2">min</mi><mi id="S3.E8.m1.4.5.3.2.1.3">θ</mi></munder><mo id="S3.E8.m1.4.5.3.2a" lspace="0.167em">⁡</mo><munder id="S3.E8.m1.4.5.3.2.2"><munder accentunder="true" id="S3.E8.m1.2.2"><mrow id="S3.E8.m1.2.2.2"><mi class="ltx_font_mathcaligraphic" id="S3.E8.m1.2.2.2.4">ℒ</mi><mo id="S3.E8.m1.2.2.2.3">⁢</mo><mrow id="S3.E8.m1.2.2.2.2.1"><mo id="S3.E8.m1.2.2.2.2.1.2" stretchy="false">(</mo><msub id="S3.E8.m1.2.2.2.2.1.1"><mi id="S3.E8.m1.2.2.2.2.1.1.2">π</mi><mi id="S3.E8.m1.2.2.2.2.1.1.3">θ</mi></msub><mo id="S3.E8.m1.2.2.2.2.1.3">,</mo><mi id="S3.E8.m1.1.1.1.1">U</mi><mo id="S3.E8.m1.2.2.2.2.1.4" stretchy="false">)</mo></mrow></mrow><mo id="S3.E8.m1.2.2.3">⏟</mo></munder><msub id="S3.E8.m1.4.5.3.2.2.2"><mi class="ltx_font_mathcaligraphic" id="S3.E8.m1.4.5.3.2.2.2.2">ℒ</mi><mtext id="S3.E8.m1.4.5.3.2.2.2.3">prefer</mtext></msub></munder></mrow><mo id="S3.E8.m1.4.5.3.1">−</mo><munder id="S3.E8.m1.4.5.3.3"><munder accentunder="true" id="S3.E8.m1.4.4"><mrow id="S3.E8.m1.4.4.2"><mrow id="S3.E8.m1.4.4.2.3"><msub id="S3.E8.m1.4.4.2.3.1"><mi id="S3.E8.m1.4.4.2.3.1.2" mathvariant="normal">𝔼</mi><mrow id="S3.E8.m1.4.4.2.2.2"><mrow id="S3.E8.m1.4.4.2.2.2.2.1"><mo id="S3.E8.m1.4.4.2.2.2.2.1.2" stretchy="false">(</mo><mi id="S3.E8.m1.3.3.1.1.1.1">x</mi><mo id="S3.E8.m1.4.4.2.2.2.2.1.3">,</mo><msub id="S3.E8.m1.4.4.2.2.2.2.1.1"><mi id="S3.E8.m1.4.4.2.2.2.2.1.1.2">y</mi><mi id="S3.E8.m1.4.4.2.2.2.2.1.1.3">w</mi></msub><mo id="S3.E8.m1.4.4.2.2.2.2.1.4" stretchy="false">)</mo></mrow><mo id="S3.E8.m1.4.4.2.2.2.3">∼</mo><mi id="S3.E8.m1.4.4.2.2.2.4">D</mi></mrow></msub><mo id="S3.E8.m1.4.4.2.3.2" lspace="0em" mathsize="120%" rspace="0.167em">[</mo></mrow><mi id="S3.E8.m1.4.4.2.4">log</mi><msub id="S3.E8.m1.4.4.2.5"><mi id="S3.E8.m1.4.4.2.5.2">π</mi><mi id="S3.E8.m1.4.4.2.5.3">θ</mi></msub><mrow id="S3.E8.m1.4.4.2.6"><mo id="S3.E8.m1.4.4.2.6.1" stretchy="false">(</mo><msub id="S3.E8.m1.4.4.2.6.2"><mi id="S3.E8.m1.4.4.2.6.2.2">y</mi><mi id="S3.E8.m1.4.4.2.6.2.3">w</mi></msub><mo fence="false" id="S3.E8.m1.4.4.2.6.3" rspace="0.167em" stretchy="false">|</mo><mi id="S3.E8.m1.4.4.2.6.4">x</mi><mo id="S3.E8.m1.4.4.2.6.5" stretchy="false">)</mo></mrow><mo id="S3.E8.m1.4.4.2.7" maxsize="120%" minsize="120%">]</mo></mrow><mo id="S3.E8.m1.4.4.3">⏟</mo></munder><msub id="S3.E8.m1.4.5.3.3.2"><mi class="ltx_font_mathcaligraphic" id="S3.E8.m1.4.5.3.3.2.2">ℒ</mi><mtext id="S3.E8.m1.4.5.3.3.2.3">NLL</mtext></msub></munder></mrow></mrow><annotation encoding="application/x-tex" id="S3.E8.m1.4b">\mathcal{L}_{\text{CPO}}=\min_{\theta}\underbrace{\mathcal{L}(\pi_{\theta},U)}%
_{\mathcal{L}_{\text{prefer}}}-\underbrace{\mathbb{E}_{(x,y_{w})\sim D}\bigr{[%
}\log\pi_{\theta}(y_{w}|x)\bigr{]}}_{\mathcal{L}_{\text{NLL}}}</annotation><annotation encoding="application/x-llamapun" id="S3.E8.m1.4c">caligraphic_L start_POSTSUBSCRIPT CPO end_POSTSUBSCRIPT = roman_min start_POSTSUBSCRIPT italic_θ end_POSTSUBSCRIPT under⏟ start_ARG caligraphic_L ( italic_π start_POSTSUBSCRIPT italic_θ end_POSTSUBSCRIPT , italic_U ) end_ARG start_POSTSUBSCRIPT caligraphic_L start_POSTSUBSCRIPT prefer end_POSTSUBSCRIPT end_POSTSUBSCRIPT - under⏟ start_ARG roman_𝔼 start_POSTSUBSCRIPT ( italic_x , italic_y start_POSTSUBSCRIPT italic_w end_POSTSUBSCRIPT ) ∼ italic_D end_POSTSUBSCRIPT [ roman_log italic_π start_POSTSUBSCRIPT italic_θ end_POSTSUBSCRIPT ( italic_y start_POSTSUBSCRIPT italic_w end_POSTSUBSCRIPT | italic_x ) ] end_ARG start_POSTSUBSCRIPT caligraphic_L start_POSTSUBSCRIPT NLL end_POSTSUBSCRIPT end_POSTSUBSCRIPT</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(8)</span></td>
</tr></tbody>
</table>
</div>
</section>
<section class="ltx_paragraph" id="S3.SS2.SSS0.Px4">
<h5 class="ltx_title ltx_title_paragraph">Kahneman-Tversky Optimisation (KTO):</h5>
<div class="ltx_para" id="S3.SS2.SSS0.Px4.p1">
<p class="ltx_p" id="S3.SS2.SSS0.Px4.p1.11">KTO <cite class="ltx_cite ltx_citemacro_cite">Ethayarajh et al. (<a class="ltx_ref" href="https://arxiv.org/html/2405.13984v1#bib.bib10" title="">2024</a>)</cite> combines the implicit reward under the RLHF objective with the concept of loss aversion from Kahneman-Tversky prospect theory <cite class="ltx_cite ltx_citemacro_cite">Tversky and Kahneman (<a class="ltx_ref" href="https://arxiv.org/html/2405.13984v1#bib.bib34" title="">1992</a>)</cite>.
Unlike DPO and CPO, KTO expects a specific dataset format <math alttext="\mathcal{D}=\{x^{(i)},y^{(i)},y_{\lambda}^{(i)}\}_{i=1}^{N}" class="ltx_Math" display="inline" id="S3.SS2.SSS0.Px4.p1.1.m1.6"><semantics id="S3.SS2.SSS0.Px4.p1.1.m1.6a"><mrow id="S3.SS2.SSS0.Px4.p1.1.m1.6.6" xref="S3.SS2.SSS0.Px4.p1.1.m1.6.6.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS2.SSS0.Px4.p1.1.m1.6.6.5" xref="S3.SS2.SSS0.Px4.p1.1.m1.6.6.5.cmml">𝒟</mi><mo id="S3.SS2.SSS0.Px4.p1.1.m1.6.6.4" xref="S3.SS2.SSS0.Px4.p1.1.m1.6.6.4.cmml">=</mo><msubsup id="S3.SS2.SSS0.Px4.p1.1.m1.6.6.3" xref="S3.SS2.SSS0.Px4.p1.1.m1.6.6.3.cmml"><mrow id="S3.SS2.SSS0.Px4.p1.1.m1.6.6.3.3.3.3" xref="S3.SS2.SSS0.Px4.p1.1.m1.6.6.3.3.3.4.cmml"><mo id="S3.SS2.SSS0.Px4.p1.1.m1.6.6.3.3.3.3.4" stretchy="false" xref="S3.SS2.SSS0.Px4.p1.1.m1.6.6.3.3.3.4.cmml">{</mo><msup id="S3.SS2.SSS0.Px4.p1.1.m1.4.4.1.1.1.1.1" xref="S3.SS2.SSS0.Px4.p1.1.m1.4.4.1.1.1.1.1.cmml"><mi id="S3.SS2.SSS0.Px4.p1.1.m1.4.4.1.1.1.1.1.2" xref="S3.SS2.SSS0.Px4.p1.1.m1.4.4.1.1.1.1.1.2.cmml">x</mi><mrow id="S3.SS2.SSS0.Px4.p1.1.m1.1.1.1.3" xref="S3.SS2.SSS0.Px4.p1.1.m1.4.4.1.1.1.1.1.cmml"><mo id="S3.SS2.SSS0.Px4.p1.1.m1.1.1.1.3.1" stretchy="false" xref="S3.SS2.SSS0.Px4.p1.1.m1.4.4.1.1.1.1.1.cmml">(</mo><mi id="S3.SS2.SSS0.Px4.p1.1.m1.1.1.1.1" xref="S3.SS2.SSS0.Px4.p1.1.m1.1.1.1.1.cmml">i</mi><mo id="S3.SS2.SSS0.Px4.p1.1.m1.1.1.1.3.2" stretchy="false" xref="S3.SS2.SSS0.Px4.p1.1.m1.4.4.1.1.1.1.1.cmml">)</mo></mrow></msup><mo id="S3.SS2.SSS0.Px4.p1.1.m1.6.6.3.3.3.3.5" xref="S3.SS2.SSS0.Px4.p1.1.m1.6.6.3.3.3.4.cmml">,</mo><msup id="S3.SS2.SSS0.Px4.p1.1.m1.5.5.2.2.2.2.2" xref="S3.SS2.SSS0.Px4.p1.1.m1.5.5.2.2.2.2.2.cmml"><mi id="S3.SS2.SSS0.Px4.p1.1.m1.5.5.2.2.2.2.2.2" xref="S3.SS2.SSS0.Px4.p1.1.m1.5.5.2.2.2.2.2.2.cmml">y</mi><mrow id="S3.SS2.SSS0.Px4.p1.1.m1.2.2.1.3" xref="S3.SS2.SSS0.Px4.p1.1.m1.5.5.2.2.2.2.2.cmml"><mo id="S3.SS2.SSS0.Px4.p1.1.m1.2.2.1.3.1" stretchy="false" xref="S3.SS2.SSS0.Px4.p1.1.m1.5.5.2.2.2.2.2.cmml">(</mo><mi id="S3.SS2.SSS0.Px4.p1.1.m1.2.2.1.1" xref="S3.SS2.SSS0.Px4.p1.1.m1.2.2.1.1.cmml">i</mi><mo id="S3.SS2.SSS0.Px4.p1.1.m1.2.2.1.3.2" stretchy="false" xref="S3.SS2.SSS0.Px4.p1.1.m1.5.5.2.2.2.2.2.cmml">)</mo></mrow></msup><mo id="S3.SS2.SSS0.Px4.p1.1.m1.6.6.3.3.3.3.6" xref="S3.SS2.SSS0.Px4.p1.1.m1.6.6.3.3.3.4.cmml">,</mo><msubsup id="S3.SS2.SSS0.Px4.p1.1.m1.6.6.3.3.3.3.3" xref="S3.SS2.SSS0.Px4.p1.1.m1.6.6.3.3.3.3.3.cmml"><mi id="S3.SS2.SSS0.Px4.p1.1.m1.6.6.3.3.3.3.3.2.2" xref="S3.SS2.SSS0.Px4.p1.1.m1.6.6.3.3.3.3.3.2.2.cmml">y</mi><mi id="S3.SS2.SSS0.Px4.p1.1.m1.6.6.3.3.3.3.3.2.3" xref="S3.SS2.SSS0.Px4.p1.1.m1.6.6.3.3.3.3.3.2.3.cmml">λ</mi><mrow id="S3.SS2.SSS0.Px4.p1.1.m1.3.3.1.3" xref="S3.SS2.SSS0.Px4.p1.1.m1.6.6.3.3.3.3.3.cmml"><mo id="S3.SS2.SSS0.Px4.p1.1.m1.3.3.1.3.1" stretchy="false" xref="S3.SS2.SSS0.Px4.p1.1.m1.6.6.3.3.3.3.3.cmml">(</mo><mi id="S3.SS2.SSS0.Px4.p1.1.m1.3.3.1.1" xref="S3.SS2.SSS0.Px4.p1.1.m1.3.3.1.1.cmml">i</mi><mo id="S3.SS2.SSS0.Px4.p1.1.m1.3.3.1.3.2" stretchy="false" xref="S3.SS2.SSS0.Px4.p1.1.m1.6.6.3.3.3.3.3.cmml">)</mo></mrow></msubsup><mo id="S3.SS2.SSS0.Px4.p1.1.m1.6.6.3.3.3.3.7" stretchy="false" xref="S3.SS2.SSS0.Px4.p1.1.m1.6.6.3.3.3.4.cmml">}</mo></mrow><mrow id="S3.SS2.SSS0.Px4.p1.1.m1.6.6.3.3.5" xref="S3.SS2.SSS0.Px4.p1.1.m1.6.6.3.3.5.cmml"><mi id="S3.SS2.SSS0.Px4.p1.1.m1.6.6.3.3.5.2" xref="S3.SS2.SSS0.Px4.p1.1.m1.6.6.3.3.5.2.cmml">i</mi><mo id="S3.SS2.SSS0.Px4.p1.1.m1.6.6.3.3.5.1" xref="S3.SS2.SSS0.Px4.p1.1.m1.6.6.3.3.5.1.cmml">=</mo><mn id="S3.SS2.SSS0.Px4.p1.1.m1.6.6.3.3.5.3" xref="S3.SS2.SSS0.Px4.p1.1.m1.6.6.3.3.5.3.cmml">1</mn></mrow><mi id="S3.SS2.SSS0.Px4.p1.1.m1.6.6.3.5" xref="S3.SS2.SSS0.Px4.p1.1.m1.6.6.3.5.cmml">N</mi></msubsup></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS0.Px4.p1.1.m1.6b"><apply id="S3.SS2.SSS0.Px4.p1.1.m1.6.6.cmml" xref="S3.SS2.SSS0.Px4.p1.1.m1.6.6"><eq id="S3.SS2.SSS0.Px4.p1.1.m1.6.6.4.cmml" xref="S3.SS2.SSS0.Px4.p1.1.m1.6.6.4"></eq><ci id="S3.SS2.SSS0.Px4.p1.1.m1.6.6.5.cmml" xref="S3.SS2.SSS0.Px4.p1.1.m1.6.6.5">𝒟</ci><apply id="S3.SS2.SSS0.Px4.p1.1.m1.6.6.3.cmml" xref="S3.SS2.SSS0.Px4.p1.1.m1.6.6.3"><csymbol cd="ambiguous" id="S3.SS2.SSS0.Px4.p1.1.m1.6.6.3.4.cmml" xref="S3.SS2.SSS0.Px4.p1.1.m1.6.6.3">superscript</csymbol><apply id="S3.SS2.SSS0.Px4.p1.1.m1.6.6.3.3.cmml" xref="S3.SS2.SSS0.Px4.p1.1.m1.6.6.3"><csymbol cd="ambiguous" id="S3.SS2.SSS0.Px4.p1.1.m1.6.6.3.3.4.cmml" xref="S3.SS2.SSS0.Px4.p1.1.m1.6.6.3">subscript</csymbol><set id="S3.SS2.SSS0.Px4.p1.1.m1.6.6.3.3.3.4.cmml" xref="S3.SS2.SSS0.Px4.p1.1.m1.6.6.3.3.3.3"><apply id="S3.SS2.SSS0.Px4.p1.1.m1.4.4.1.1.1.1.1.cmml" xref="S3.SS2.SSS0.Px4.p1.1.m1.4.4.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS2.SSS0.Px4.p1.1.m1.4.4.1.1.1.1.1.1.cmml" xref="S3.SS2.SSS0.Px4.p1.1.m1.4.4.1.1.1.1.1">superscript</csymbol><ci id="S3.SS2.SSS0.Px4.p1.1.m1.4.4.1.1.1.1.1.2.cmml" xref="S3.SS2.SSS0.Px4.p1.1.m1.4.4.1.1.1.1.1.2">𝑥</ci><ci id="S3.SS2.SSS0.Px4.p1.1.m1.1.1.1.1.cmml" xref="S3.SS2.SSS0.Px4.p1.1.m1.1.1.1.1">𝑖</ci></apply><apply id="S3.SS2.SSS0.Px4.p1.1.m1.5.5.2.2.2.2.2.cmml" xref="S3.SS2.SSS0.Px4.p1.1.m1.5.5.2.2.2.2.2"><csymbol cd="ambiguous" id="S3.SS2.SSS0.Px4.p1.1.m1.5.5.2.2.2.2.2.1.cmml" xref="S3.SS2.SSS0.Px4.p1.1.m1.5.5.2.2.2.2.2">superscript</csymbol><ci id="S3.SS2.SSS0.Px4.p1.1.m1.5.5.2.2.2.2.2.2.cmml" xref="S3.SS2.SSS0.Px4.p1.1.m1.5.5.2.2.2.2.2.2">𝑦</ci><ci id="S3.SS2.SSS0.Px4.p1.1.m1.2.2.1.1.cmml" xref="S3.SS2.SSS0.Px4.p1.1.m1.2.2.1.1">𝑖</ci></apply><apply id="S3.SS2.SSS0.Px4.p1.1.m1.6.6.3.3.3.3.3.cmml" xref="S3.SS2.SSS0.Px4.p1.1.m1.6.6.3.3.3.3.3"><csymbol cd="ambiguous" id="S3.SS2.SSS0.Px4.p1.1.m1.6.6.3.3.3.3.3.1.cmml" xref="S3.SS2.SSS0.Px4.p1.1.m1.6.6.3.3.3.3.3">superscript</csymbol><apply id="S3.SS2.SSS0.Px4.p1.1.m1.6.6.3.3.3.3.3.2.cmml" xref="S3.SS2.SSS0.Px4.p1.1.m1.6.6.3.3.3.3.3"><csymbol cd="ambiguous" id="S3.SS2.SSS0.Px4.p1.1.m1.6.6.3.3.3.3.3.2.1.cmml" xref="S3.SS2.SSS0.Px4.p1.1.m1.6.6.3.3.3.3.3">subscript</csymbol><ci id="S3.SS2.SSS0.Px4.p1.1.m1.6.6.3.3.3.3.3.2.2.cmml" xref="S3.SS2.SSS0.Px4.p1.1.m1.6.6.3.3.3.3.3.2.2">𝑦</ci><ci id="S3.SS2.SSS0.Px4.p1.1.m1.6.6.3.3.3.3.3.2.3.cmml" xref="S3.SS2.SSS0.Px4.p1.1.m1.6.6.3.3.3.3.3.2.3">𝜆</ci></apply><ci id="S3.SS2.SSS0.Px4.p1.1.m1.3.3.1.1.cmml" xref="S3.SS2.SSS0.Px4.p1.1.m1.3.3.1.1">𝑖</ci></apply></set><apply id="S3.SS2.SSS0.Px4.p1.1.m1.6.6.3.3.5.cmml" xref="S3.SS2.SSS0.Px4.p1.1.m1.6.6.3.3.5"><eq id="S3.SS2.SSS0.Px4.p1.1.m1.6.6.3.3.5.1.cmml" xref="S3.SS2.SSS0.Px4.p1.1.m1.6.6.3.3.5.1"></eq><ci id="S3.SS2.SSS0.Px4.p1.1.m1.6.6.3.3.5.2.cmml" xref="S3.SS2.SSS0.Px4.p1.1.m1.6.6.3.3.5.2">𝑖</ci><cn id="S3.SS2.SSS0.Px4.p1.1.m1.6.6.3.3.5.3.cmml" type="integer" xref="S3.SS2.SSS0.Px4.p1.1.m1.6.6.3.3.5.3">1</cn></apply></apply><ci id="S3.SS2.SSS0.Px4.p1.1.m1.6.6.3.5.cmml" xref="S3.SS2.SSS0.Px4.p1.1.m1.6.6.3.5">𝑁</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS0.Px4.p1.1.m1.6c">\mathcal{D}=\{x^{(i)},y^{(i)},y_{\lambda}^{(i)}\}_{i=1}^{N}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS0.Px4.p1.1.m1.6d">caligraphic_D = { italic_x start_POSTSUPERSCRIPT ( italic_i ) end_POSTSUPERSCRIPT , italic_y start_POSTSUPERSCRIPT ( italic_i ) end_POSTSUPERSCRIPT , italic_y start_POSTSUBSCRIPT italic_λ end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ( italic_i ) end_POSTSUPERSCRIPT } start_POSTSUBSCRIPT italic_i = 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_N end_POSTSUPERSCRIPT</annotation></semantics></math>, where <math alttext="x" class="ltx_Math" display="inline" id="S3.SS2.SSS0.Px4.p1.2.m2.1"><semantics id="S3.SS2.SSS0.Px4.p1.2.m2.1a"><mi id="S3.SS2.SSS0.Px4.p1.2.m2.1.1" xref="S3.SS2.SSS0.Px4.p1.2.m2.1.1.cmml">x</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS0.Px4.p1.2.m2.1b"><ci id="S3.SS2.SSS0.Px4.p1.2.m2.1.1.cmml" xref="S3.SS2.SSS0.Px4.p1.2.m2.1.1">𝑥</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS0.Px4.p1.2.m2.1c">x</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS0.Px4.p1.2.m2.1d">italic_x</annotation></semantics></math> represents the source, <math alttext="y" class="ltx_Math" display="inline" id="S3.SS2.SSS0.Px4.p1.3.m3.1"><semantics id="S3.SS2.SSS0.Px4.p1.3.m3.1a"><mi id="S3.SS2.SSS0.Px4.p1.3.m3.1.1" xref="S3.SS2.SSS0.Px4.p1.3.m3.1.1.cmml">y</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS0.Px4.p1.3.m3.1b"><ci id="S3.SS2.SSS0.Px4.p1.3.m3.1.1.cmml" xref="S3.SS2.SSS0.Px4.p1.3.m3.1.1">𝑦</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS0.Px4.p1.3.m3.1c">y</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS0.Px4.p1.3.m3.1d">italic_y</annotation></semantics></math> denotes the output, and <math alttext="y_{\lambda}" class="ltx_Math" display="inline" id="S3.SS2.SSS0.Px4.p1.4.m4.1"><semantics id="S3.SS2.SSS0.Px4.p1.4.m4.1a"><msub id="S3.SS2.SSS0.Px4.p1.4.m4.1.1" xref="S3.SS2.SSS0.Px4.p1.4.m4.1.1.cmml"><mi id="S3.SS2.SSS0.Px4.p1.4.m4.1.1.2" xref="S3.SS2.SSS0.Px4.p1.4.m4.1.1.2.cmml">y</mi><mi id="S3.SS2.SSS0.Px4.p1.4.m4.1.1.3" xref="S3.SS2.SSS0.Px4.p1.4.m4.1.1.3.cmml">λ</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS0.Px4.p1.4.m4.1b"><apply id="S3.SS2.SSS0.Px4.p1.4.m4.1.1.cmml" xref="S3.SS2.SSS0.Px4.p1.4.m4.1.1"><csymbol cd="ambiguous" id="S3.SS2.SSS0.Px4.p1.4.m4.1.1.1.cmml" xref="S3.SS2.SSS0.Px4.p1.4.m4.1.1">subscript</csymbol><ci id="S3.SS2.SSS0.Px4.p1.4.m4.1.1.2.cmml" xref="S3.SS2.SSS0.Px4.p1.4.m4.1.1.2">𝑦</ci><ci id="S3.SS2.SSS0.Px4.p1.4.m4.1.1.3.cmml" xref="S3.SS2.SSS0.Px4.p1.4.m4.1.1.3">𝜆</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS0.Px4.p1.4.m4.1c">y_{\lambda}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS0.Px4.p1.4.m4.1d">italic_y start_POSTSUBSCRIPT italic_λ end_POSTSUBSCRIPT</annotation></semantics></math> indicates whether <math alttext="y" class="ltx_Math" display="inline" id="S3.SS2.SSS0.Px4.p1.5.m5.1"><semantics id="S3.SS2.SSS0.Px4.p1.5.m5.1a"><mi id="S3.SS2.SSS0.Px4.p1.5.m5.1.1" xref="S3.SS2.SSS0.Px4.p1.5.m5.1.1.cmml">y</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS0.Px4.p1.5.m5.1b"><ci id="S3.SS2.SSS0.Px4.p1.5.m5.1.1.cmml" xref="S3.SS2.SSS0.Px4.p1.5.m5.1.1">𝑦</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS0.Px4.p1.5.m5.1c">y</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS0.Px4.p1.5.m5.1d">italic_y</annotation></semantics></math> is preferred or dis-preferred. Thus, KTO does not rely on preferences but rather on knowing the desirability of output <math alttext="y" class="ltx_Math" display="inline" id="S3.SS2.SSS0.Px4.p1.6.m6.1"><semantics id="S3.SS2.SSS0.Px4.p1.6.m6.1a"><mi id="S3.SS2.SSS0.Px4.p1.6.m6.1.1" xref="S3.SS2.SSS0.Px4.p1.6.m6.1.1.cmml">y</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS0.Px4.p1.6.m6.1b"><ci id="S3.SS2.SSS0.Px4.p1.6.m6.1.1.cmml" xref="S3.SS2.SSS0.Px4.p1.6.m6.1.1">𝑦</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS0.Px4.p1.6.m6.1c">y</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS0.Px4.p1.6.m6.1d">italic_y</annotation></semantics></math>. Intuitively, KTO’s loss is determined by a <span class="ltx_text ltx_font_italic" id="S3.SS2.SSS0.Px4.p1.11.1">value function</span> <math alttext="v\rightarrow\mathbb{R}" class="ltx_Math" display="inline" id="S3.SS2.SSS0.Px4.p1.7.m7.1"><semantics id="S3.SS2.SSS0.Px4.p1.7.m7.1a"><mrow id="S3.SS2.SSS0.Px4.p1.7.m7.1.1" xref="S3.SS2.SSS0.Px4.p1.7.m7.1.1.cmml"><mi id="S3.SS2.SSS0.Px4.p1.7.m7.1.1.2" xref="S3.SS2.SSS0.Px4.p1.7.m7.1.1.2.cmml">v</mi><mo id="S3.SS2.SSS0.Px4.p1.7.m7.1.1.1" stretchy="false" xref="S3.SS2.SSS0.Px4.p1.7.m7.1.1.1.cmml">→</mo><mi id="S3.SS2.SSS0.Px4.p1.7.m7.1.1.3" mathvariant="normal" xref="S3.SS2.SSS0.Px4.p1.7.m7.1.1.3.cmml">ℝ</mi></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS0.Px4.p1.7.m7.1b"><apply id="S3.SS2.SSS0.Px4.p1.7.m7.1.1.cmml" xref="S3.SS2.SSS0.Px4.p1.7.m7.1.1"><ci id="S3.SS2.SSS0.Px4.p1.7.m7.1.1.1.cmml" xref="S3.SS2.SSS0.Px4.p1.7.m7.1.1.1">→</ci><ci id="S3.SS2.SSS0.Px4.p1.7.m7.1.1.2.cmml" xref="S3.SS2.SSS0.Px4.p1.7.m7.1.1.2">𝑣</ci><ci id="S3.SS2.SSS0.Px4.p1.7.m7.1.1.3.cmml" xref="S3.SS2.SSS0.Px4.p1.7.m7.1.1.3">ℝ</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS0.Px4.p1.7.m7.1c">v\rightarrow\mathbb{R}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS0.Px4.p1.7.m7.1d">italic_v → roman_ℝ</annotation></semantics></math> applied to a generated output <math alttext="z" class="ltx_Math" display="inline" id="S3.SS2.SSS0.Px4.p1.8.m8.1"><semantics id="S3.SS2.SSS0.Px4.p1.8.m8.1a"><mi id="S3.SS2.SSS0.Px4.p1.8.m8.1.1" xref="S3.SS2.SSS0.Px4.p1.8.m8.1.1.cmml">z</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS0.Px4.p1.8.m8.1b"><ci id="S3.SS2.SSS0.Px4.p1.8.m8.1.1.cmml" xref="S3.SS2.SSS0.Px4.p1.8.m8.1.1">𝑧</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS0.Px4.p1.8.m8.1c">z</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS0.Px4.p1.8.m8.1d">italic_z</annotation></semantics></math>, with respect to a reference point <math alttext="z_{\text{ref}}" class="ltx_Math" display="inline" id="S3.SS2.SSS0.Px4.p1.9.m9.1"><semantics id="S3.SS2.SSS0.Px4.p1.9.m9.1a"><msub id="S3.SS2.SSS0.Px4.p1.9.m9.1.1" xref="S3.SS2.SSS0.Px4.p1.9.m9.1.1.cmml"><mi id="S3.SS2.SSS0.Px4.p1.9.m9.1.1.2" xref="S3.SS2.SSS0.Px4.p1.9.m9.1.1.2.cmml">z</mi><mtext id="S3.SS2.SSS0.Px4.p1.9.m9.1.1.3" xref="S3.SS2.SSS0.Px4.p1.9.m9.1.1.3a.cmml">ref</mtext></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS0.Px4.p1.9.m9.1b"><apply id="S3.SS2.SSS0.Px4.p1.9.m9.1.1.cmml" xref="S3.SS2.SSS0.Px4.p1.9.m9.1.1"><csymbol cd="ambiguous" id="S3.SS2.SSS0.Px4.p1.9.m9.1.1.1.cmml" xref="S3.SS2.SSS0.Px4.p1.9.m9.1.1">subscript</csymbol><ci id="S3.SS2.SSS0.Px4.p1.9.m9.1.1.2.cmml" xref="S3.SS2.SSS0.Px4.p1.9.m9.1.1.2">𝑧</ci><ci id="S3.SS2.SSS0.Px4.p1.9.m9.1.1.3a.cmml" xref="S3.SS2.SSS0.Px4.p1.9.m9.1.1.3"><mtext id="S3.SS2.SSS0.Px4.p1.9.m9.1.1.3.cmml" mathsize="70%" xref="S3.SS2.SSS0.Px4.p1.9.m9.1.1.3">ref</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS0.Px4.p1.9.m9.1c">z_{\text{ref}}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS0.Px4.p1.9.m9.1d">italic_z start_POSTSUBSCRIPT ref end_POSTSUBSCRIPT</annotation></semantics></math> and a <span class="ltx_text ltx_font_italic" id="S3.SS2.SSS0.Px4.p1.11.2">weighting function</span> <math alttext="w" class="ltx_Math" display="inline" id="S3.SS2.SSS0.Px4.p1.10.m10.1"><semantics id="S3.SS2.SSS0.Px4.p1.10.m10.1a"><mi id="S3.SS2.SSS0.Px4.p1.10.m10.1.1" xref="S3.SS2.SSS0.Px4.p1.10.m10.1.1.cmml">w</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS0.Px4.p1.10.m10.1b"><ci id="S3.SS2.SSS0.Px4.p1.10.m10.1.1.cmml" xref="S3.SS2.SSS0.Px4.p1.10.m10.1.1">𝑤</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS0.Px4.p1.10.m10.1c">w</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS0.Px4.p1.10.m10.1d">italic_w</annotation></semantics></math> that assigns weights to the loss for preferred and dis-preferred generated outputs. More specifically, for training purposes, the value function is cast as a logistic function <math alttext="\sigma" class="ltx_Math" display="inline" id="S3.SS2.SSS0.Px4.p1.11.m11.1"><semantics id="S3.SS2.SSS0.Px4.p1.11.m11.1a"><mi id="S3.SS2.SSS0.Px4.p1.11.m11.1.1" xref="S3.SS2.SSS0.Px4.p1.11.m11.1.1.cmml">σ</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS0.Px4.p1.11.m11.1b"><ci id="S3.SS2.SSS0.Px4.p1.11.m11.1.1.cmml" xref="S3.SS2.SSS0.Px4.p1.11.m11.1.1">𝜎</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS0.Px4.p1.11.m11.1c">\sigma</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS0.Px4.p1.11.m11.1d">italic_σ</annotation></semantics></math>;</p>
<table class="ltx_equation ltx_eqn_table" id="S3.E9">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="v_{\text{KTO}}(x,y;\beta)=\begin{cases}\sigma\bigl{(}r_{KTO}(x,y)-z_{ref}\bigl%
{)}&amp;\text{if }y\sim y_{\lambda}=\text{preferred}\\
\sigma\bigl{(}z_{\text{ref}}-r_{\text{KTO}}(x,y)\bigl{)}&amp;\text{if }y\sim y_{%
\lambda}=\text{dis-preferred}\end{cases}" class="ltx_math_unparsed" display="block" id="S3.E9.m1.7"><semantics id="S3.E9.m1.7a"><mrow id="S3.E9.m1.7.8"><mrow id="S3.E9.m1.7.8.2"><msub id="S3.E9.m1.7.8.2.2"><mi id="S3.E9.m1.7.8.2.2.2">v</mi><mtext id="S3.E9.m1.7.8.2.2.3">KTO</mtext></msub><mo id="S3.E9.m1.7.8.2.1">⁢</mo><mrow id="S3.E9.m1.7.8.2.3.2"><mo id="S3.E9.m1.7.8.2.3.2.1" stretchy="false">(</mo><mi id="S3.E9.m1.5.5">x</mi><mo id="S3.E9.m1.7.8.2.3.2.2">,</mo><mi id="S3.E9.m1.6.6">y</mi><mo id="S3.E9.m1.7.8.2.3.2.3">;</mo><mi id="S3.E9.m1.7.7">β</mi><mo id="S3.E9.m1.7.8.2.3.2.4" stretchy="false">)</mo></mrow></mrow><mo id="S3.E9.m1.7.8.1">=</mo><mrow id="S3.E9.m1.4.4"><mo id="S3.E9.m1.4.4.5">{</mo><mtable columnspacing="5pt" displaystyle="true" id="S3.E9.m1.4.4.4" rowspacing="0pt"><mtr id="S3.E9.m1.4.4.4a"><mtd class="ltx_align_left" columnalign="left" id="S3.E9.m1.4.4.4b"><mrow id="S3.E9.m1.1.1.1.1.1.1"><mi id="S3.E9.m1.1.1.1.1.1.1.3">σ</mi><mrow id="S3.E9.m1.1.1.1.1.1.1.4"><mo id="S3.E9.m1.1.1.1.1.1.1.4.1" maxsize="120%" minsize="120%">(</mo><msub id="S3.E9.m1.1.1.1.1.1.1.4.2"><mi id="S3.E9.m1.1.1.1.1.1.1.4.2.2">r</mi><mrow id="S3.E9.m1.1.1.1.1.1.1.4.2.3"><mi id="S3.E9.m1.1.1.1.1.1.1.4.2.3.2">K</mi><mo id="S3.E9.m1.1.1.1.1.1.1.4.2.3.1">⁢</mo><mi id="S3.E9.m1.1.1.1.1.1.1.4.2.3.3">T</mi><mo id="S3.E9.m1.1.1.1.1.1.1.4.2.3.1a">⁢</mo><mi id="S3.E9.m1.1.1.1.1.1.1.4.2.3.4">O</mi></mrow></msub><mrow id="S3.E9.m1.1.1.1.1.1.1.4.3"><mo id="S3.E9.m1.1.1.1.1.1.1.4.3.1" stretchy="false">(</mo><mi id="S3.E9.m1.1.1.1.1.1.1.1">x</mi><mo id="S3.E9.m1.1.1.1.1.1.1.4.3.2">,</mo><mi id="S3.E9.m1.1.1.1.1.1.1.2">y</mi><mo id="S3.E9.m1.1.1.1.1.1.1.4.3.3" stretchy="false">)</mo></mrow><mo id="S3.E9.m1.1.1.1.1.1.1.4.4">−</mo><msub id="S3.E9.m1.1.1.1.1.1.1.4.5"><mi id="S3.E9.m1.1.1.1.1.1.1.4.5.2">z</mi><mrow id="S3.E9.m1.1.1.1.1.1.1.4.5.3"><mi id="S3.E9.m1.1.1.1.1.1.1.4.5.3.2">r</mi><mo id="S3.E9.m1.1.1.1.1.1.1.4.5.3.1">⁢</mo><mi id="S3.E9.m1.1.1.1.1.1.1.4.5.3.3">e</mi><mo id="S3.E9.m1.1.1.1.1.1.1.4.5.3.1a">⁢</mo><mi id="S3.E9.m1.1.1.1.1.1.1.4.5.3.4">f</mi></mrow></msub><mo id="S3.E9.m1.1.1.1.1.1.1.4.6" lspace="0em" mathsize="120%">)</mo></mrow></mrow></mtd><mtd class="ltx_align_left" columnalign="left" id="S3.E9.m1.4.4.4c"><mrow id="S3.E9.m1.2.2.2.2.2.1"><mrow id="S3.E9.m1.2.2.2.2.2.1.2"><mtext id="S3.E9.m1.2.2.2.2.2.1.2.2">if </mtext><mo id="S3.E9.m1.2.2.2.2.2.1.2.1">⁢</mo><mi id="S3.E9.m1.2.2.2.2.2.1.2.3">y</mi></mrow><mo id="S3.E9.m1.2.2.2.2.2.1.3">∼</mo><msub id="S3.E9.m1.2.2.2.2.2.1.4"><mi id="S3.E9.m1.2.2.2.2.2.1.4.2">y</mi><mi id="S3.E9.m1.2.2.2.2.2.1.4.3">λ</mi></msub><mo id="S3.E9.m1.2.2.2.2.2.1.5">=</mo><mtext id="S3.E9.m1.2.2.2.2.2.1.6">preferred</mtext></mrow></mtd></mtr><mtr id="S3.E9.m1.4.4.4d"><mtd class="ltx_align_left" columnalign="left" id="S3.E9.m1.4.4.4e"><mrow id="S3.E9.m1.3.3.3.3.1.1"><mi id="S3.E9.m1.3.3.3.3.1.1.3">σ</mi><mrow id="S3.E9.m1.3.3.3.3.1.1.4"><mo id="S3.E9.m1.3.3.3.3.1.1.4.1" maxsize="120%" minsize="120%">(</mo><msub id="S3.E9.m1.3.3.3.3.1.1.4.2"><mi id="S3.E9.m1.3.3.3.3.1.1.4.2.2">z</mi><mtext id="S3.E9.m1.3.3.3.3.1.1.4.2.3">ref</mtext></msub><mo id="S3.E9.m1.3.3.3.3.1.1.4.3">−</mo><msub id="S3.E9.m1.3.3.3.3.1.1.4.4"><mi id="S3.E9.m1.3.3.3.3.1.1.4.4.2">r</mi><mtext id="S3.E9.m1.3.3.3.3.1.1.4.4.3">KTO</mtext></msub><mrow id="S3.E9.m1.3.3.3.3.1.1.4.5"><mo id="S3.E9.m1.3.3.3.3.1.1.4.5.1" stretchy="false">(</mo><mi id="S3.E9.m1.3.3.3.3.1.1.1">x</mi><mo id="S3.E9.m1.3.3.3.3.1.1.4.5.2">,</mo><mi id="S3.E9.m1.3.3.3.3.1.1.2">y</mi><mo id="S3.E9.m1.3.3.3.3.1.1.4.5.3" stretchy="false">)</mo></mrow><mo id="S3.E9.m1.3.3.3.3.1.1.4.6" lspace="0em" mathsize="120%">)</mo></mrow></mrow></mtd><mtd class="ltx_align_left" columnalign="left" id="S3.E9.m1.4.4.4f"><mrow id="S3.E9.m1.4.4.4.4.2.1"><mrow id="S3.E9.m1.4.4.4.4.2.1.2"><mtext id="S3.E9.m1.4.4.4.4.2.1.2.2">if </mtext><mo id="S3.E9.m1.4.4.4.4.2.1.2.1">⁢</mo><mi id="S3.E9.m1.4.4.4.4.2.1.2.3">y</mi></mrow><mo id="S3.E9.m1.4.4.4.4.2.1.3">∼</mo><msub id="S3.E9.m1.4.4.4.4.2.1.4"><mi id="S3.E9.m1.4.4.4.4.2.1.4.2">y</mi><mi id="S3.E9.m1.4.4.4.4.2.1.4.3">λ</mi></msub><mo id="S3.E9.m1.4.4.4.4.2.1.5">=</mo><mtext id="S3.E9.m1.4.4.4.4.2.1.6">dis-preferred</mtext></mrow></mtd></mtr></mtable></mrow></mrow><annotation encoding="application/x-tex" id="S3.E9.m1.7b">v_{\text{KTO}}(x,y;\beta)=\begin{cases}\sigma\bigl{(}r_{KTO}(x,y)-z_{ref}\bigl%
{)}&amp;\text{if }y\sim y_{\lambda}=\text{preferred}\\
\sigma\bigl{(}z_{\text{ref}}-r_{\text{KTO}}(x,y)\bigl{)}&amp;\text{if }y\sim y_{%
\lambda}=\text{dis-preferred}\end{cases}</annotation><annotation encoding="application/x-llamapun" id="S3.E9.m1.7c">italic_v start_POSTSUBSCRIPT KTO end_POSTSUBSCRIPT ( italic_x , italic_y ; italic_β ) = { start_ROW start_CELL italic_σ ( italic_r start_POSTSUBSCRIPT italic_K italic_T italic_O end_POSTSUBSCRIPT ( italic_x , italic_y ) - italic_z start_POSTSUBSCRIPT italic_r italic_e italic_f end_POSTSUBSCRIPT ) end_CELL start_CELL if italic_y ∼ italic_y start_POSTSUBSCRIPT italic_λ end_POSTSUBSCRIPT = preferred end_CELL end_ROW start_ROW start_CELL italic_σ ( italic_z start_POSTSUBSCRIPT ref end_POSTSUBSCRIPT - italic_r start_POSTSUBSCRIPT KTO end_POSTSUBSCRIPT ( italic_x , italic_y ) ) end_CELL start_CELL if italic_y ∼ italic_y start_POSTSUBSCRIPT italic_λ end_POSTSUBSCRIPT = dis-preferred end_CELL end_ROW</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(9)</span></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S3.SS2.SSS0.Px4.p1.12">Here, <math alttext="r_{KTO}" class="ltx_Math" display="inline" id="S3.SS2.SSS0.Px4.p1.12.m1.1"><semantics id="S3.SS2.SSS0.Px4.p1.12.m1.1a"><msub id="S3.SS2.SSS0.Px4.p1.12.m1.1.1" xref="S3.SS2.SSS0.Px4.p1.12.m1.1.1.cmml"><mi id="S3.SS2.SSS0.Px4.p1.12.m1.1.1.2" xref="S3.SS2.SSS0.Px4.p1.12.m1.1.1.2.cmml">r</mi><mrow id="S3.SS2.SSS0.Px4.p1.12.m1.1.1.3" xref="S3.SS2.SSS0.Px4.p1.12.m1.1.1.3.cmml"><mi id="S3.SS2.SSS0.Px4.p1.12.m1.1.1.3.2" xref="S3.SS2.SSS0.Px4.p1.12.m1.1.1.3.2.cmml">K</mi><mo id="S3.SS2.SSS0.Px4.p1.12.m1.1.1.3.1" xref="S3.SS2.SSS0.Px4.p1.12.m1.1.1.3.1.cmml">⁢</mo><mi id="S3.SS2.SSS0.Px4.p1.12.m1.1.1.3.3" xref="S3.SS2.SSS0.Px4.p1.12.m1.1.1.3.3.cmml">T</mi><mo id="S3.SS2.SSS0.Px4.p1.12.m1.1.1.3.1a" xref="S3.SS2.SSS0.Px4.p1.12.m1.1.1.3.1.cmml">⁢</mo><mi id="S3.SS2.SSS0.Px4.p1.12.m1.1.1.3.4" xref="S3.SS2.SSS0.Px4.p1.12.m1.1.1.3.4.cmml">O</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS0.Px4.p1.12.m1.1b"><apply id="S3.SS2.SSS0.Px4.p1.12.m1.1.1.cmml" xref="S3.SS2.SSS0.Px4.p1.12.m1.1.1"><csymbol cd="ambiguous" id="S3.SS2.SSS0.Px4.p1.12.m1.1.1.1.cmml" xref="S3.SS2.SSS0.Px4.p1.12.m1.1.1">subscript</csymbol><ci id="S3.SS2.SSS0.Px4.p1.12.m1.1.1.2.cmml" xref="S3.SS2.SSS0.Px4.p1.12.m1.1.1.2">𝑟</ci><apply id="S3.SS2.SSS0.Px4.p1.12.m1.1.1.3.cmml" xref="S3.SS2.SSS0.Px4.p1.12.m1.1.1.3"><times id="S3.SS2.SSS0.Px4.p1.12.m1.1.1.3.1.cmml" xref="S3.SS2.SSS0.Px4.p1.12.m1.1.1.3.1"></times><ci id="S3.SS2.SSS0.Px4.p1.12.m1.1.1.3.2.cmml" xref="S3.SS2.SSS0.Px4.p1.12.m1.1.1.3.2">𝐾</ci><ci id="S3.SS2.SSS0.Px4.p1.12.m1.1.1.3.3.cmml" xref="S3.SS2.SSS0.Px4.p1.12.m1.1.1.3.3">𝑇</ci><ci id="S3.SS2.SSS0.Px4.p1.12.m1.1.1.3.4.cmml" xref="S3.SS2.SSS0.Px4.p1.12.m1.1.1.3.4">𝑂</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS0.Px4.p1.12.m1.1c">r_{KTO}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS0.Px4.p1.12.m1.1d">italic_r start_POSTSUBSCRIPT italic_K italic_T italic_O end_POSTSUBSCRIPT</annotation></semantics></math> is set to be the implicit reward under the RLHF objective in Eq <a class="ltx_ref" href="https://arxiv.org/html/2405.13984v1#S3.E5" title="Equation 5 ‣ Direct Preference Optimisation (DPO): ‣ 3.2 Feedback-Aligned Optimisations Algorithms ‣ 3 Methodology ‣ Feedback-aligned Mixed LLMs for Machine Language-Molecule Translation"><span class="ltx_text ltx_ref_tag">5</span></a>;</p>
<table class="ltx_equation ltx_eqn_table" id="S3.E10">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="r_{\text{KTO}}(x,y)=\beta\log\frac{\pi_{\theta}(y|x)}{\pi_{\text{ref}}(y|x)}" class="ltx_Math" display="block" id="S3.E10.m1.4"><semantics id="S3.E10.m1.4a"><mrow id="S3.E10.m1.4.5" xref="S3.E10.m1.4.5.cmml"><mrow id="S3.E10.m1.4.5.2" xref="S3.E10.m1.4.5.2.cmml"><msub id="S3.E10.m1.4.5.2.2" xref="S3.E10.m1.4.5.2.2.cmml"><mi id="S3.E10.m1.4.5.2.2.2" xref="S3.E10.m1.4.5.2.2.2.cmml">r</mi><mtext id="S3.E10.m1.4.5.2.2.3" xref="S3.E10.m1.4.5.2.2.3a.cmml">KTO</mtext></msub><mo id="S3.E10.m1.4.5.2.1" xref="S3.E10.m1.4.5.2.1.cmml">⁢</mo><mrow id="S3.E10.m1.4.5.2.3.2" xref="S3.E10.m1.4.5.2.3.1.cmml"><mo id="S3.E10.m1.4.5.2.3.2.1" stretchy="false" xref="S3.E10.m1.4.5.2.3.1.cmml">(</mo><mi id="S3.E10.m1.3.3" xref="S3.E10.m1.3.3.cmml">x</mi><mo id="S3.E10.m1.4.5.2.3.2.2" xref="S3.E10.m1.4.5.2.3.1.cmml">,</mo><mi id="S3.E10.m1.4.4" xref="S3.E10.m1.4.4.cmml">y</mi><mo id="S3.E10.m1.4.5.2.3.2.3" stretchy="false" xref="S3.E10.m1.4.5.2.3.1.cmml">)</mo></mrow></mrow><mo id="S3.E10.m1.4.5.1" xref="S3.E10.m1.4.5.1.cmml">=</mo><mrow id="S3.E10.m1.4.5.3" xref="S3.E10.m1.4.5.3.cmml"><mi id="S3.E10.m1.4.5.3.2" xref="S3.E10.m1.4.5.3.2.cmml">β</mi><mo id="S3.E10.m1.4.5.3.1" lspace="0.167em" xref="S3.E10.m1.4.5.3.1.cmml">⁢</mo><mrow id="S3.E10.m1.4.5.3.3" xref="S3.E10.m1.4.5.3.3.cmml"><mi id="S3.E10.m1.4.5.3.3.1" xref="S3.E10.m1.4.5.3.3.1.cmml">log</mi><mo id="S3.E10.m1.4.5.3.3a" lspace="0.167em" xref="S3.E10.m1.4.5.3.3.cmml">⁡</mo><mfrac id="S3.E10.m1.2.2" xref="S3.E10.m1.2.2.cmml"><mrow id="S3.E10.m1.1.1.1" xref="S3.E10.m1.1.1.1.cmml"><msub id="S3.E10.m1.1.1.1.3" xref="S3.E10.m1.1.1.1.3.cmml"><mi id="S3.E10.m1.1.1.1.3.2" xref="S3.E10.m1.1.1.1.3.2.cmml">π</mi><mi id="S3.E10.m1.1.1.1.3.3" xref="S3.E10.m1.1.1.1.3.3.cmml">θ</mi></msub><mo id="S3.E10.m1.1.1.1.2" xref="S3.E10.m1.1.1.1.2.cmml">⁢</mo><mrow id="S3.E10.m1.1.1.1.1.1" xref="S3.E10.m1.1.1.1.1.1.1.cmml"><mo id="S3.E10.m1.1.1.1.1.1.2" stretchy="false" xref="S3.E10.m1.1.1.1.1.1.1.cmml">(</mo><mrow id="S3.E10.m1.1.1.1.1.1.1" xref="S3.E10.m1.1.1.1.1.1.1.cmml"><mi id="S3.E10.m1.1.1.1.1.1.1.2" xref="S3.E10.m1.1.1.1.1.1.1.2.cmml">y</mi><mo fence="false" id="S3.E10.m1.1.1.1.1.1.1.1" xref="S3.E10.m1.1.1.1.1.1.1.1.cmml">|</mo><mi id="S3.E10.m1.1.1.1.1.1.1.3" xref="S3.E10.m1.1.1.1.1.1.1.3.cmml">x</mi></mrow><mo id="S3.E10.m1.1.1.1.1.1.3" stretchy="false" xref="S3.E10.m1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mrow id="S3.E10.m1.2.2.2" xref="S3.E10.m1.2.2.2.cmml"><msub id="S3.E10.m1.2.2.2.3" xref="S3.E10.m1.2.2.2.3.cmml"><mi id="S3.E10.m1.2.2.2.3.2" xref="S3.E10.m1.2.2.2.3.2.cmml">π</mi><mtext id="S3.E10.m1.2.2.2.3.3" xref="S3.E10.m1.2.2.2.3.3a.cmml">ref</mtext></msub><mo id="S3.E10.m1.2.2.2.2" xref="S3.E10.m1.2.2.2.2.cmml">⁢</mo><mrow id="S3.E10.m1.2.2.2.1.1" xref="S3.E10.m1.2.2.2.1.1.1.cmml"><mo id="S3.E10.m1.2.2.2.1.1.2" stretchy="false" xref="S3.E10.m1.2.2.2.1.1.1.cmml">(</mo><mrow id="S3.E10.m1.2.2.2.1.1.1" xref="S3.E10.m1.2.2.2.1.1.1.cmml"><mi id="S3.E10.m1.2.2.2.1.1.1.2" xref="S3.E10.m1.2.2.2.1.1.1.2.cmml">y</mi><mo fence="false" id="S3.E10.m1.2.2.2.1.1.1.1" xref="S3.E10.m1.2.2.2.1.1.1.1.cmml">|</mo><mi id="S3.E10.m1.2.2.2.1.1.1.3" xref="S3.E10.m1.2.2.2.1.1.1.3.cmml">x</mi></mrow><mo id="S3.E10.m1.2.2.2.1.1.3" stretchy="false" xref="S3.E10.m1.2.2.2.1.1.1.cmml">)</mo></mrow></mrow></mfrac></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.E10.m1.4b"><apply id="S3.E10.m1.4.5.cmml" xref="S3.E10.m1.4.5"><eq id="S3.E10.m1.4.5.1.cmml" xref="S3.E10.m1.4.5.1"></eq><apply id="S3.E10.m1.4.5.2.cmml" xref="S3.E10.m1.4.5.2"><times id="S3.E10.m1.4.5.2.1.cmml" xref="S3.E10.m1.4.5.2.1"></times><apply id="S3.E10.m1.4.5.2.2.cmml" xref="S3.E10.m1.4.5.2.2"><csymbol cd="ambiguous" id="S3.E10.m1.4.5.2.2.1.cmml" xref="S3.E10.m1.4.5.2.2">subscript</csymbol><ci id="S3.E10.m1.4.5.2.2.2.cmml" xref="S3.E10.m1.4.5.2.2.2">𝑟</ci><ci id="S3.E10.m1.4.5.2.2.3a.cmml" xref="S3.E10.m1.4.5.2.2.3"><mtext id="S3.E10.m1.4.5.2.2.3.cmml" mathsize="70%" xref="S3.E10.m1.4.5.2.2.3">KTO</mtext></ci></apply><interval closure="open" id="S3.E10.m1.4.5.2.3.1.cmml" xref="S3.E10.m1.4.5.2.3.2"><ci id="S3.E10.m1.3.3.cmml" xref="S3.E10.m1.3.3">𝑥</ci><ci id="S3.E10.m1.4.4.cmml" xref="S3.E10.m1.4.4">𝑦</ci></interval></apply><apply id="S3.E10.m1.4.5.3.cmml" xref="S3.E10.m1.4.5.3"><times id="S3.E10.m1.4.5.3.1.cmml" xref="S3.E10.m1.4.5.3.1"></times><ci id="S3.E10.m1.4.5.3.2.cmml" xref="S3.E10.m1.4.5.3.2">𝛽</ci><apply id="S3.E10.m1.4.5.3.3.cmml" xref="S3.E10.m1.4.5.3.3"><log id="S3.E10.m1.4.5.3.3.1.cmml" xref="S3.E10.m1.4.5.3.3.1"></log><apply id="S3.E10.m1.2.2.cmml" xref="S3.E10.m1.2.2"><divide id="S3.E10.m1.2.2.3.cmml" xref="S3.E10.m1.2.2"></divide><apply id="S3.E10.m1.1.1.1.cmml" xref="S3.E10.m1.1.1.1"><times id="S3.E10.m1.1.1.1.2.cmml" xref="S3.E10.m1.1.1.1.2"></times><apply id="S3.E10.m1.1.1.1.3.cmml" xref="S3.E10.m1.1.1.1.3"><csymbol cd="ambiguous" id="S3.E10.m1.1.1.1.3.1.cmml" xref="S3.E10.m1.1.1.1.3">subscript</csymbol><ci id="S3.E10.m1.1.1.1.3.2.cmml" xref="S3.E10.m1.1.1.1.3.2">𝜋</ci><ci id="S3.E10.m1.1.1.1.3.3.cmml" xref="S3.E10.m1.1.1.1.3.3">𝜃</ci></apply><apply id="S3.E10.m1.1.1.1.1.1.1.cmml" xref="S3.E10.m1.1.1.1.1.1"><csymbol cd="latexml" id="S3.E10.m1.1.1.1.1.1.1.1.cmml" xref="S3.E10.m1.1.1.1.1.1.1.1">conditional</csymbol><ci id="S3.E10.m1.1.1.1.1.1.1.2.cmml" xref="S3.E10.m1.1.1.1.1.1.1.2">𝑦</ci><ci id="S3.E10.m1.1.1.1.1.1.1.3.cmml" xref="S3.E10.m1.1.1.1.1.1.1.3">𝑥</ci></apply></apply><apply id="S3.E10.m1.2.2.2.cmml" xref="S3.E10.m1.2.2.2"><times id="S3.E10.m1.2.2.2.2.cmml" xref="S3.E10.m1.2.2.2.2"></times><apply id="S3.E10.m1.2.2.2.3.cmml" xref="S3.E10.m1.2.2.2.3"><csymbol cd="ambiguous" id="S3.E10.m1.2.2.2.3.1.cmml" xref="S3.E10.m1.2.2.2.3">subscript</csymbol><ci id="S3.E10.m1.2.2.2.3.2.cmml" xref="S3.E10.m1.2.2.2.3.2">𝜋</ci><ci id="S3.E10.m1.2.2.2.3.3a.cmml" xref="S3.E10.m1.2.2.2.3.3"><mtext id="S3.E10.m1.2.2.2.3.3.cmml" mathsize="70%" xref="S3.E10.m1.2.2.2.3.3">ref</mtext></ci></apply><apply id="S3.E10.m1.2.2.2.1.1.1.cmml" xref="S3.E10.m1.2.2.2.1.1"><csymbol cd="latexml" id="S3.E10.m1.2.2.2.1.1.1.1.cmml" xref="S3.E10.m1.2.2.2.1.1.1.1">conditional</csymbol><ci id="S3.E10.m1.2.2.2.1.1.1.2.cmml" xref="S3.E10.m1.2.2.2.1.1.1.2">𝑦</ci><ci id="S3.E10.m1.2.2.2.1.1.1.3.cmml" xref="S3.E10.m1.2.2.2.1.1.1.3">𝑥</ci></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E10.m1.4c">r_{\text{KTO}}(x,y)=\beta\log\frac{\pi_{\theta}(y|x)}{\pi_{\text{ref}}(y|x)}</annotation><annotation encoding="application/x-llamapun" id="S3.E10.m1.4d">italic_r start_POSTSUBSCRIPT KTO end_POSTSUBSCRIPT ( italic_x , italic_y ) = italic_β roman_log divide start_ARG italic_π start_POSTSUBSCRIPT italic_θ end_POSTSUBSCRIPT ( italic_y | italic_x ) end_ARG start_ARG italic_π start_POSTSUBSCRIPT ref end_POSTSUBSCRIPT ( italic_y | italic_x ) end_ARG</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(10)</span></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S3.SS2.SSS0.Px4.p1.16">where <math alttext="\beta" class="ltx_Math" display="inline" id="S3.SS2.SSS0.Px4.p1.13.m1.1"><semantics id="S3.SS2.SSS0.Px4.p1.13.m1.1a"><mi id="S3.SS2.SSS0.Px4.p1.13.m1.1.1" xref="S3.SS2.SSS0.Px4.p1.13.m1.1.1.cmml">β</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS0.Px4.p1.13.m1.1b"><ci id="S3.SS2.SSS0.Px4.p1.13.m1.1.1.cmml" xref="S3.SS2.SSS0.Px4.p1.13.m1.1.1">𝛽</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS0.Px4.p1.13.m1.1c">\beta</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS0.Px4.p1.13.m1.1d">italic_β</annotation></semantics></math> is a scale factor and <math alttext="z_{\text{ref}}" class="ltx_Math" display="inline" id="S3.SS2.SSS0.Px4.p1.14.m2.1"><semantics id="S3.SS2.SSS0.Px4.p1.14.m2.1a"><msub id="S3.SS2.SSS0.Px4.p1.14.m2.1.1" xref="S3.SS2.SSS0.Px4.p1.14.m2.1.1.cmml"><mi id="S3.SS2.SSS0.Px4.p1.14.m2.1.1.2" xref="S3.SS2.SSS0.Px4.p1.14.m2.1.1.2.cmml">z</mi><mtext id="S3.SS2.SSS0.Px4.p1.14.m2.1.1.3" xref="S3.SS2.SSS0.Px4.p1.14.m2.1.1.3a.cmml">ref</mtext></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS0.Px4.p1.14.m2.1b"><apply id="S3.SS2.SSS0.Px4.p1.14.m2.1.1.cmml" xref="S3.SS2.SSS0.Px4.p1.14.m2.1.1"><csymbol cd="ambiguous" id="S3.SS2.SSS0.Px4.p1.14.m2.1.1.1.cmml" xref="S3.SS2.SSS0.Px4.p1.14.m2.1.1">subscript</csymbol><ci id="S3.SS2.SSS0.Px4.p1.14.m2.1.1.2.cmml" xref="S3.SS2.SSS0.Px4.p1.14.m2.1.1.2">𝑧</ci><ci id="S3.SS2.SSS0.Px4.p1.14.m2.1.1.3a.cmml" xref="S3.SS2.SSS0.Px4.p1.14.m2.1.1.3"><mtext id="S3.SS2.SSS0.Px4.p1.14.m2.1.1.3.cmml" mathsize="70%" xref="S3.SS2.SSS0.Px4.p1.14.m2.1.1.3">ref</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS0.Px4.p1.14.m2.1c">z_{\text{ref}}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS0.Px4.p1.14.m2.1d">italic_z start_POSTSUBSCRIPT ref end_POSTSUBSCRIPT</annotation></semantics></math> is calculated in relation to all pairs <math alttext="(x^{\prime},y^{\prime})" class="ltx_Math" display="inline" id="S3.SS2.SSS0.Px4.p1.15.m3.2"><semantics id="S3.SS2.SSS0.Px4.p1.15.m3.2a"><mrow id="S3.SS2.SSS0.Px4.p1.15.m3.2.2.2" xref="S3.SS2.SSS0.Px4.p1.15.m3.2.2.3.cmml"><mo id="S3.SS2.SSS0.Px4.p1.15.m3.2.2.2.3" stretchy="false" xref="S3.SS2.SSS0.Px4.p1.15.m3.2.2.3.cmml">(</mo><msup id="S3.SS2.SSS0.Px4.p1.15.m3.1.1.1.1" xref="S3.SS2.SSS0.Px4.p1.15.m3.1.1.1.1.cmml"><mi id="S3.SS2.SSS0.Px4.p1.15.m3.1.1.1.1.2" xref="S3.SS2.SSS0.Px4.p1.15.m3.1.1.1.1.2.cmml">x</mi><mo id="S3.SS2.SSS0.Px4.p1.15.m3.1.1.1.1.3" xref="S3.SS2.SSS0.Px4.p1.15.m3.1.1.1.1.3.cmml">′</mo></msup><mo id="S3.SS2.SSS0.Px4.p1.15.m3.2.2.2.4" xref="S3.SS2.SSS0.Px4.p1.15.m3.2.2.3.cmml">,</mo><msup id="S3.SS2.SSS0.Px4.p1.15.m3.2.2.2.2" xref="S3.SS2.SSS0.Px4.p1.15.m3.2.2.2.2.cmml"><mi id="S3.SS2.SSS0.Px4.p1.15.m3.2.2.2.2.2" xref="S3.SS2.SSS0.Px4.p1.15.m3.2.2.2.2.2.cmml">y</mi><mo id="S3.SS2.SSS0.Px4.p1.15.m3.2.2.2.2.3" xref="S3.SS2.SSS0.Px4.p1.15.m3.2.2.2.2.3.cmml">′</mo></msup><mo id="S3.SS2.SSS0.Px4.p1.15.m3.2.2.2.5" stretchy="false" xref="S3.SS2.SSS0.Px4.p1.15.m3.2.2.3.cmml">)</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS0.Px4.p1.15.m3.2b"><interval closure="open" id="S3.SS2.SSS0.Px4.p1.15.m3.2.2.3.cmml" xref="S3.SS2.SSS0.Px4.p1.15.m3.2.2.2"><apply id="S3.SS2.SSS0.Px4.p1.15.m3.1.1.1.1.cmml" xref="S3.SS2.SSS0.Px4.p1.15.m3.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS2.SSS0.Px4.p1.15.m3.1.1.1.1.1.cmml" xref="S3.SS2.SSS0.Px4.p1.15.m3.1.1.1.1">superscript</csymbol><ci id="S3.SS2.SSS0.Px4.p1.15.m3.1.1.1.1.2.cmml" xref="S3.SS2.SSS0.Px4.p1.15.m3.1.1.1.1.2">𝑥</ci><ci id="S3.SS2.SSS0.Px4.p1.15.m3.1.1.1.1.3.cmml" xref="S3.SS2.SSS0.Px4.p1.15.m3.1.1.1.1.3">′</ci></apply><apply id="S3.SS2.SSS0.Px4.p1.15.m3.2.2.2.2.cmml" xref="S3.SS2.SSS0.Px4.p1.15.m3.2.2.2.2"><csymbol cd="ambiguous" id="S3.SS2.SSS0.Px4.p1.15.m3.2.2.2.2.1.cmml" xref="S3.SS2.SSS0.Px4.p1.15.m3.2.2.2.2">superscript</csymbol><ci id="S3.SS2.SSS0.Px4.p1.15.m3.2.2.2.2.2.cmml" xref="S3.SS2.SSS0.Px4.p1.15.m3.2.2.2.2.2">𝑦</ci><ci id="S3.SS2.SSS0.Px4.p1.15.m3.2.2.2.2.3.cmml" xref="S3.SS2.SSS0.Px4.p1.15.m3.2.2.2.2.3">′</ci></apply></interval></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS0.Px4.p1.15.m3.2c">(x^{\prime},y^{\prime})</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS0.Px4.p1.15.m3.2d">( italic_x start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT , italic_y start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT )</annotation></semantics></math> as an approximation of the optimal policy, rather than being computed individually for each pair <math alttext="(x,y)" class="ltx_Math" display="inline" id="S3.SS2.SSS0.Px4.p1.16.m4.2"><semantics id="S3.SS2.SSS0.Px4.p1.16.m4.2a"><mrow id="S3.SS2.SSS0.Px4.p1.16.m4.2.3.2" xref="S3.SS2.SSS0.Px4.p1.16.m4.2.3.1.cmml"><mo id="S3.SS2.SSS0.Px4.p1.16.m4.2.3.2.1" stretchy="false" xref="S3.SS2.SSS0.Px4.p1.16.m4.2.3.1.cmml">(</mo><mi id="S3.SS2.SSS0.Px4.p1.16.m4.1.1" xref="S3.SS2.SSS0.Px4.p1.16.m4.1.1.cmml">x</mi><mo id="S3.SS2.SSS0.Px4.p1.16.m4.2.3.2.2" xref="S3.SS2.SSS0.Px4.p1.16.m4.2.3.1.cmml">,</mo><mi id="S3.SS2.SSS0.Px4.p1.16.m4.2.2" xref="S3.SS2.SSS0.Px4.p1.16.m4.2.2.cmml">y</mi><mo id="S3.SS2.SSS0.Px4.p1.16.m4.2.3.2.3" stretchy="false" xref="S3.SS2.SSS0.Px4.p1.16.m4.2.3.1.cmml">)</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS0.Px4.p1.16.m4.2b"><interval closure="open" id="S3.SS2.SSS0.Px4.p1.16.m4.2.3.1.cmml" xref="S3.SS2.SSS0.Px4.p1.16.m4.2.3.2"><ci id="S3.SS2.SSS0.Px4.p1.16.m4.1.1.cmml" xref="S3.SS2.SSS0.Px4.p1.16.m4.1.1">𝑥</ci><ci id="S3.SS2.SSS0.Px4.p1.16.m4.2.2.cmml" xref="S3.SS2.SSS0.Px4.p1.16.m4.2.2">𝑦</ci></interval></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS0.Px4.p1.16.m4.2c">(x,y)</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS0.Px4.p1.16.m4.2d">( italic_x , italic_y )</annotation></semantics></math>;</p>
<table class="ltx_equation ltx_eqn_table" id="S3.E11">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="z_{\text{ref}}=\mathbb{E}_{x^{\prime}\sim\mathcal{D}}\left[\beta\mathbb{KL}%
\bigl{(}\pi_{\theta}(y^{\prime}|x^{\prime})\|\pi_{\text{ref}}(y^{\prime}|x^{%
\prime})\bigl{)}\right]" class="ltx_math_unparsed" display="block" id="S3.E11.m1.1"><semantics id="S3.E11.m1.1a"><mrow id="S3.E11.m1.1b"><msub id="S3.E11.m1.1.1"><mi id="S3.E11.m1.1.1.2">z</mi><mtext id="S3.E11.m1.1.1.3">ref</mtext></msub><mo id="S3.E11.m1.1.2">=</mo><msub id="S3.E11.m1.1.3"><mi id="S3.E11.m1.1.3.2" mathvariant="normal">𝔼</mi><mrow id="S3.E11.m1.1.3.3"><msup id="S3.E11.m1.1.3.3.2"><mi id="S3.E11.m1.1.3.3.2.2">x</mi><mo id="S3.E11.m1.1.3.3.2.3">′</mo></msup><mo id="S3.E11.m1.1.3.3.1">∼</mo><mi class="ltx_font_mathcaligraphic" id="S3.E11.m1.1.3.3.3">𝒟</mi></mrow></msub><mrow id="S3.E11.m1.1.4"><mo id="S3.E11.m1.1.4.1">[</mo><mi id="S3.E11.m1.1.4.2">β</mi><mi id="S3.E11.m1.1.4.3" mathvariant="normal">𝕂</mi><mi id="S3.E11.m1.1.4.4" mathvariant="normal">𝕃</mi><mrow id="S3.E11.m1.1.4.5"><mo id="S3.E11.m1.1.4.5.1" maxsize="120%" minsize="120%">(</mo><msub id="S3.E11.m1.1.4.5.2"><mi id="S3.E11.m1.1.4.5.2.2">π</mi><mi id="S3.E11.m1.1.4.5.2.3">θ</mi></msub><mrow id="S3.E11.m1.1.4.5.3"><mo id="S3.E11.m1.1.4.5.3.1" stretchy="false">(</mo><msup id="S3.E11.m1.1.4.5.3.2"><mi id="S3.E11.m1.1.4.5.3.2.2">y</mi><mo id="S3.E11.m1.1.4.5.3.2.3">′</mo></msup><mo fence="false" id="S3.E11.m1.1.4.5.3.3" rspace="0.167em" stretchy="false">|</mo><msup id="S3.E11.m1.1.4.5.3.4"><mi id="S3.E11.m1.1.4.5.3.4.2">x</mi><mo id="S3.E11.m1.1.4.5.3.4.3">′</mo></msup><mo id="S3.E11.m1.1.4.5.3.5" stretchy="false">)</mo></mrow><mo id="S3.E11.m1.1.4.5.4" lspace="0em" rspace="0.167em">∥</mo><msub id="S3.E11.m1.1.4.5.5"><mi id="S3.E11.m1.1.4.5.5.2">π</mi><mtext id="S3.E11.m1.1.4.5.5.3">ref</mtext></msub><mrow id="S3.E11.m1.1.4.5.6"><mo id="S3.E11.m1.1.4.5.6.1" stretchy="false">(</mo><msup id="S3.E11.m1.1.4.5.6.2"><mi id="S3.E11.m1.1.4.5.6.2.2">y</mi><mo id="S3.E11.m1.1.4.5.6.2.3">′</mo></msup><mo fence="false" id="S3.E11.m1.1.4.5.6.3" rspace="0.167em" stretchy="false">|</mo><msup id="S3.E11.m1.1.4.5.6.4"><mi id="S3.E11.m1.1.4.5.6.4.2">x</mi><mo id="S3.E11.m1.1.4.5.6.4.3">′</mo></msup><mo id="S3.E11.m1.1.4.5.6.5" stretchy="false">)</mo></mrow><mrow id="S3.E11.m1.1.4.5.7"><mo id="S3.E11.m1.1.4.5.7.1" lspace="0em" mathsize="120%" rspace="0em">)</mo><mo id="S3.E11.m1.1.4.5.7.2">]</mo></mrow></mrow></mrow></mrow><annotation encoding="application/x-tex" id="S3.E11.m1.1c">z_{\text{ref}}=\mathbb{E}_{x^{\prime}\sim\mathcal{D}}\left[\beta\mathbb{KL}%
\bigl{(}\pi_{\theta}(y^{\prime}|x^{\prime})\|\pi_{\text{ref}}(y^{\prime}|x^{%
\prime})\bigl{)}\right]</annotation><annotation encoding="application/x-llamapun" id="S3.E11.m1.1d">italic_z start_POSTSUBSCRIPT ref end_POSTSUBSCRIPT = roman_𝔼 start_POSTSUBSCRIPT italic_x start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT ∼ caligraphic_D end_POSTSUBSCRIPT [ italic_β roman_𝕂 roman_𝕃 ( italic_π start_POSTSUBSCRIPT italic_θ end_POSTSUBSCRIPT ( italic_y start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT | italic_x start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT ) ∥ italic_π start_POSTSUBSCRIPT ref end_POSTSUBSCRIPT ( italic_y start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT | italic_x start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT ) ) ]</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(11)</span></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S3.SS2.SSS0.Px4.p1.18">Ultimately, the KTO loss boils down to the following function:</p>
<table class="ltx_equation ltx_eqn_table" id="S3.E12">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\mathcal{L}_{\text{KTO}}(\pi_{\theta},\pi_{\text{ref}})=\mathbb{E}_{x,y\sim%
\mathcal{D}}\left[w(y)(1-v_{\text{KTO}}(x,y;\beta))\right]" class="ltx_Math" display="block" id="S3.E12.m1.9"><semantics id="S3.E12.m1.9a"><mrow id="S3.E12.m1.9.9" xref="S3.E12.m1.9.9.cmml"><mrow id="S3.E12.m1.8.8.2" xref="S3.E12.m1.8.8.2.cmml"><msub id="S3.E12.m1.8.8.2.4" xref="S3.E12.m1.8.8.2.4.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.E12.m1.8.8.2.4.2" xref="S3.E12.m1.8.8.2.4.2.cmml">ℒ</mi><mtext id="S3.E12.m1.8.8.2.4.3" xref="S3.E12.m1.8.8.2.4.3a.cmml">KTO</mtext></msub><mo id="S3.E12.m1.8.8.2.3" xref="S3.E12.m1.8.8.2.3.cmml">⁢</mo><mrow id="S3.E12.m1.8.8.2.2.2" xref="S3.E12.m1.8.8.2.2.3.cmml"><mo id="S3.E12.m1.8.8.2.2.2.3" stretchy="false" xref="S3.E12.m1.8.8.2.2.3.cmml">(</mo><msub id="S3.E12.m1.7.7.1.1.1.1" xref="S3.E12.m1.7.7.1.1.1.1.cmml"><mi id="S3.E12.m1.7.7.1.1.1.1.2" xref="S3.E12.m1.7.7.1.1.1.1.2.cmml">π</mi><mi id="S3.E12.m1.7.7.1.1.1.1.3" xref="S3.E12.m1.7.7.1.1.1.1.3.cmml">θ</mi></msub><mo id="S3.E12.m1.8.8.2.2.2.4" xref="S3.E12.m1.8.8.2.2.3.cmml">,</mo><msub id="S3.E12.m1.8.8.2.2.2.2" xref="S3.E12.m1.8.8.2.2.2.2.cmml"><mi id="S3.E12.m1.8.8.2.2.2.2.2" xref="S3.E12.m1.8.8.2.2.2.2.2.cmml">π</mi><mtext id="S3.E12.m1.8.8.2.2.2.2.3" xref="S3.E12.m1.8.8.2.2.2.2.3a.cmml">ref</mtext></msub><mo id="S3.E12.m1.8.8.2.2.2.5" stretchy="false" xref="S3.E12.m1.8.8.2.2.3.cmml">)</mo></mrow></mrow><mo id="S3.E12.m1.9.9.4" xref="S3.E12.m1.9.9.4.cmml">=</mo><mrow id="S3.E12.m1.9.9.3" xref="S3.E12.m1.9.9.3.cmml"><msub id="S3.E12.m1.9.9.3.3" xref="S3.E12.m1.9.9.3.3.cmml"><mi id="S3.E12.m1.9.9.3.3.2" mathvariant="normal" xref="S3.E12.m1.9.9.3.3.2.cmml">𝔼</mi><mrow id="S3.E12.m1.2.2.2" xref="S3.E12.m1.2.2.2.cmml"><mrow id="S3.E12.m1.2.2.2.4.2" xref="S3.E12.m1.2.2.2.4.1.cmml"><mi id="S3.E12.m1.1.1.1.1" xref="S3.E12.m1.1.1.1.1.cmml">x</mi><mo id="S3.E12.m1.2.2.2.4.2.1" xref="S3.E12.m1.2.2.2.4.1.cmml">,</mo><mi id="S3.E12.m1.2.2.2.2" xref="S3.E12.m1.2.2.2.2.cmml">y</mi></mrow><mo id="S3.E12.m1.2.2.2.3" xref="S3.E12.m1.2.2.2.3.cmml">∼</mo><mi class="ltx_font_mathcaligraphic" id="S3.E12.m1.2.2.2.5" xref="S3.E12.m1.2.2.2.5.cmml">𝒟</mi></mrow></msub><mo id="S3.E12.m1.9.9.3.2" xref="S3.E12.m1.9.9.3.2.cmml">⁢</mo><mrow id="S3.E12.m1.9.9.3.1.1" xref="S3.E12.m1.9.9.3.1.2.cmml"><mo id="S3.E12.m1.9.9.3.1.1.2" xref="S3.E12.m1.9.9.3.1.2.1.cmml">[</mo><mrow id="S3.E12.m1.9.9.3.1.1.1" xref="S3.E12.m1.9.9.3.1.1.1.cmml"><mi id="S3.E12.m1.9.9.3.1.1.1.3" xref="S3.E12.m1.9.9.3.1.1.1.3.cmml">w</mi><mo id="S3.E12.m1.9.9.3.1.1.1.2" xref="S3.E12.m1.9.9.3.1.1.1.2.cmml">⁢</mo><mrow id="S3.E12.m1.9.9.3.1.1.1.4.2" xref="S3.E12.m1.9.9.3.1.1.1.cmml"><mo id="S3.E12.m1.9.9.3.1.1.1.4.2.1" stretchy="false" xref="S3.E12.m1.9.9.3.1.1.1.cmml">(</mo><mi id="S3.E12.m1.3.3" xref="S3.E12.m1.3.3.cmml">y</mi><mo id="S3.E12.m1.9.9.3.1.1.1.4.2.2" stretchy="false" xref="S3.E12.m1.9.9.3.1.1.1.cmml">)</mo></mrow><mo id="S3.E12.m1.9.9.3.1.1.1.2a" xref="S3.E12.m1.9.9.3.1.1.1.2.cmml">⁢</mo><mrow id="S3.E12.m1.9.9.3.1.1.1.1.1" xref="S3.E12.m1.9.9.3.1.1.1.1.1.1.cmml"><mo id="S3.E12.m1.9.9.3.1.1.1.1.1.2" stretchy="false" xref="S3.E12.m1.9.9.3.1.1.1.1.1.1.cmml">(</mo><mrow id="S3.E12.m1.9.9.3.1.1.1.1.1.1" xref="S3.E12.m1.9.9.3.1.1.1.1.1.1.cmml"><mn id="S3.E12.m1.9.9.3.1.1.1.1.1.1.2" xref="S3.E12.m1.9.9.3.1.1.1.1.1.1.2.cmml">1</mn><mo id="S3.E12.m1.9.9.3.1.1.1.1.1.1.1" xref="S3.E12.m1.9.9.3.1.1.1.1.1.1.1.cmml">−</mo><mrow id="S3.E12.m1.9.9.3.1.1.1.1.1.1.3" xref="S3.E12.m1.9.9.3.1.1.1.1.1.1.3.cmml"><msub id="S3.E12.m1.9.9.3.1.1.1.1.1.1.3.2" xref="S3.E12.m1.9.9.3.1.1.1.1.1.1.3.2.cmml"><mi id="S3.E12.m1.9.9.3.1.1.1.1.1.1.3.2.2" xref="S3.E12.m1.9.9.3.1.1.1.1.1.1.3.2.2.cmml">v</mi><mtext id="S3.E12.m1.9.9.3.1.1.1.1.1.1.3.2.3" xref="S3.E12.m1.9.9.3.1.1.1.1.1.1.3.2.3a.cmml">KTO</mtext></msub><mo id="S3.E12.m1.9.9.3.1.1.1.1.1.1.3.1" xref="S3.E12.m1.9.9.3.1.1.1.1.1.1.3.1.cmml">⁢</mo><mrow id="S3.E12.m1.9.9.3.1.1.1.1.1.1.3.3.2" xref="S3.E12.m1.9.9.3.1.1.1.1.1.1.3.3.1.cmml"><mo id="S3.E12.m1.9.9.3.1.1.1.1.1.1.3.3.2.1" stretchy="false" xref="S3.E12.m1.9.9.3.1.1.1.1.1.1.3.3.1.cmml">(</mo><mi id="S3.E12.m1.4.4" xref="S3.E12.m1.4.4.cmml">x</mi><mo id="S3.E12.m1.9.9.3.1.1.1.1.1.1.3.3.2.2" xref="S3.E12.m1.9.9.3.1.1.1.1.1.1.3.3.1.cmml">,</mo><mi id="S3.E12.m1.5.5" xref="S3.E12.m1.5.5.cmml">y</mi><mo id="S3.E12.m1.9.9.3.1.1.1.1.1.1.3.3.2.3" xref="S3.E12.m1.9.9.3.1.1.1.1.1.1.3.3.1.cmml">;</mo><mi id="S3.E12.m1.6.6" xref="S3.E12.m1.6.6.cmml">β</mi><mo id="S3.E12.m1.9.9.3.1.1.1.1.1.1.3.3.2.4" stretchy="false" xref="S3.E12.m1.9.9.3.1.1.1.1.1.1.3.3.1.cmml">)</mo></mrow></mrow></mrow><mo id="S3.E12.m1.9.9.3.1.1.1.1.1.3" stretchy="false" xref="S3.E12.m1.9.9.3.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S3.E12.m1.9.9.3.1.1.3" xref="S3.E12.m1.9.9.3.1.2.1.cmml">]</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.E12.m1.9b"><apply id="S3.E12.m1.9.9.cmml" xref="S3.E12.m1.9.9"><eq id="S3.E12.m1.9.9.4.cmml" xref="S3.E12.m1.9.9.4"></eq><apply id="S3.E12.m1.8.8.2.cmml" xref="S3.E12.m1.8.8.2"><times id="S3.E12.m1.8.8.2.3.cmml" xref="S3.E12.m1.8.8.2.3"></times><apply id="S3.E12.m1.8.8.2.4.cmml" xref="S3.E12.m1.8.8.2.4"><csymbol cd="ambiguous" id="S3.E12.m1.8.8.2.4.1.cmml" xref="S3.E12.m1.8.8.2.4">subscript</csymbol><ci id="S3.E12.m1.8.8.2.4.2.cmml" xref="S3.E12.m1.8.8.2.4.2">ℒ</ci><ci id="S3.E12.m1.8.8.2.4.3a.cmml" xref="S3.E12.m1.8.8.2.4.3"><mtext id="S3.E12.m1.8.8.2.4.3.cmml" mathsize="70%" xref="S3.E12.m1.8.8.2.4.3">KTO</mtext></ci></apply><interval closure="open" id="S3.E12.m1.8.8.2.2.3.cmml" xref="S3.E12.m1.8.8.2.2.2"><apply id="S3.E12.m1.7.7.1.1.1.1.cmml" xref="S3.E12.m1.7.7.1.1.1.1"><csymbol cd="ambiguous" id="S3.E12.m1.7.7.1.1.1.1.1.cmml" xref="S3.E12.m1.7.7.1.1.1.1">subscript</csymbol><ci id="S3.E12.m1.7.7.1.1.1.1.2.cmml" xref="S3.E12.m1.7.7.1.1.1.1.2">𝜋</ci><ci id="S3.E12.m1.7.7.1.1.1.1.3.cmml" xref="S3.E12.m1.7.7.1.1.1.1.3">𝜃</ci></apply><apply id="S3.E12.m1.8.8.2.2.2.2.cmml" xref="S3.E12.m1.8.8.2.2.2.2"><csymbol cd="ambiguous" id="S3.E12.m1.8.8.2.2.2.2.1.cmml" xref="S3.E12.m1.8.8.2.2.2.2">subscript</csymbol><ci id="S3.E12.m1.8.8.2.2.2.2.2.cmml" xref="S3.E12.m1.8.8.2.2.2.2.2">𝜋</ci><ci id="S3.E12.m1.8.8.2.2.2.2.3a.cmml" xref="S3.E12.m1.8.8.2.2.2.2.3"><mtext id="S3.E12.m1.8.8.2.2.2.2.3.cmml" mathsize="70%" xref="S3.E12.m1.8.8.2.2.2.2.3">ref</mtext></ci></apply></interval></apply><apply id="S3.E12.m1.9.9.3.cmml" xref="S3.E12.m1.9.9.3"><times id="S3.E12.m1.9.9.3.2.cmml" xref="S3.E12.m1.9.9.3.2"></times><apply id="S3.E12.m1.9.9.3.3.cmml" xref="S3.E12.m1.9.9.3.3"><csymbol cd="ambiguous" id="S3.E12.m1.9.9.3.3.1.cmml" xref="S3.E12.m1.9.9.3.3">subscript</csymbol><ci id="S3.E12.m1.9.9.3.3.2.cmml" xref="S3.E12.m1.9.9.3.3.2">𝔼</ci><apply id="S3.E12.m1.2.2.2.cmml" xref="S3.E12.m1.2.2.2"><csymbol cd="latexml" id="S3.E12.m1.2.2.2.3.cmml" xref="S3.E12.m1.2.2.2.3">similar-to</csymbol><list id="S3.E12.m1.2.2.2.4.1.cmml" xref="S3.E12.m1.2.2.2.4.2"><ci id="S3.E12.m1.1.1.1.1.cmml" xref="S3.E12.m1.1.1.1.1">𝑥</ci><ci id="S3.E12.m1.2.2.2.2.cmml" xref="S3.E12.m1.2.2.2.2">𝑦</ci></list><ci id="S3.E12.m1.2.2.2.5.cmml" xref="S3.E12.m1.2.2.2.5">𝒟</ci></apply></apply><apply id="S3.E12.m1.9.9.3.1.2.cmml" xref="S3.E12.m1.9.9.3.1.1"><csymbol cd="latexml" id="S3.E12.m1.9.9.3.1.2.1.cmml" xref="S3.E12.m1.9.9.3.1.1.2">delimited-[]</csymbol><apply id="S3.E12.m1.9.9.3.1.1.1.cmml" xref="S3.E12.m1.9.9.3.1.1.1"><times id="S3.E12.m1.9.9.3.1.1.1.2.cmml" xref="S3.E12.m1.9.9.3.1.1.1.2"></times><ci id="S3.E12.m1.9.9.3.1.1.1.3.cmml" xref="S3.E12.m1.9.9.3.1.1.1.3">𝑤</ci><ci id="S3.E12.m1.3.3.cmml" xref="S3.E12.m1.3.3">𝑦</ci><apply id="S3.E12.m1.9.9.3.1.1.1.1.1.1.cmml" xref="S3.E12.m1.9.9.3.1.1.1.1.1"><minus id="S3.E12.m1.9.9.3.1.1.1.1.1.1.1.cmml" xref="S3.E12.m1.9.9.3.1.1.1.1.1.1.1"></minus><cn id="S3.E12.m1.9.9.3.1.1.1.1.1.1.2.cmml" type="integer" xref="S3.E12.m1.9.9.3.1.1.1.1.1.1.2">1</cn><apply id="S3.E12.m1.9.9.3.1.1.1.1.1.1.3.cmml" xref="S3.E12.m1.9.9.3.1.1.1.1.1.1.3"><times id="S3.E12.m1.9.9.3.1.1.1.1.1.1.3.1.cmml" xref="S3.E12.m1.9.9.3.1.1.1.1.1.1.3.1"></times><apply id="S3.E12.m1.9.9.3.1.1.1.1.1.1.3.2.cmml" xref="S3.E12.m1.9.9.3.1.1.1.1.1.1.3.2"><csymbol cd="ambiguous" id="S3.E12.m1.9.9.3.1.1.1.1.1.1.3.2.1.cmml" xref="S3.E12.m1.9.9.3.1.1.1.1.1.1.3.2">subscript</csymbol><ci id="S3.E12.m1.9.9.3.1.1.1.1.1.1.3.2.2.cmml" xref="S3.E12.m1.9.9.3.1.1.1.1.1.1.3.2.2">𝑣</ci><ci id="S3.E12.m1.9.9.3.1.1.1.1.1.1.3.2.3a.cmml" xref="S3.E12.m1.9.9.3.1.1.1.1.1.1.3.2.3"><mtext id="S3.E12.m1.9.9.3.1.1.1.1.1.1.3.2.3.cmml" mathsize="70%" xref="S3.E12.m1.9.9.3.1.1.1.1.1.1.3.2.3">KTO</mtext></ci></apply><vector id="S3.E12.m1.9.9.3.1.1.1.1.1.1.3.3.1.cmml" xref="S3.E12.m1.9.9.3.1.1.1.1.1.1.3.3.2"><ci id="S3.E12.m1.4.4.cmml" xref="S3.E12.m1.4.4">𝑥</ci><ci id="S3.E12.m1.5.5.cmml" xref="S3.E12.m1.5.5">𝑦</ci><ci id="S3.E12.m1.6.6.cmml" xref="S3.E12.m1.6.6">𝛽</ci></vector></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E12.m1.9c">\mathcal{L}_{\text{KTO}}(\pi_{\theta},\pi_{\text{ref}})=\mathbb{E}_{x,y\sim%
\mathcal{D}}\left[w(y)(1-v_{\text{KTO}}(x,y;\beta))\right]</annotation><annotation encoding="application/x-llamapun" id="S3.E12.m1.9d">caligraphic_L start_POSTSUBSCRIPT KTO end_POSTSUBSCRIPT ( italic_π start_POSTSUBSCRIPT italic_θ end_POSTSUBSCRIPT , italic_π start_POSTSUBSCRIPT ref end_POSTSUBSCRIPT ) = roman_𝔼 start_POSTSUBSCRIPT italic_x , italic_y ∼ caligraphic_D end_POSTSUBSCRIPT [ italic_w ( italic_y ) ( 1 - italic_v start_POSTSUBSCRIPT KTO end_POSTSUBSCRIPT ( italic_x , italic_y ; italic_β ) ) ]</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(12)</span></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S3.SS2.SSS0.Px4.p1.17">where <math alttext="w(y)" class="ltx_Math" display="inline" id="S3.SS2.SSS0.Px4.p1.17.m1.1"><semantics id="S3.SS2.SSS0.Px4.p1.17.m1.1a"><mrow id="S3.SS2.SSS0.Px4.p1.17.m1.1.2" xref="S3.SS2.SSS0.Px4.p1.17.m1.1.2.cmml"><mi id="S3.SS2.SSS0.Px4.p1.17.m1.1.2.2" xref="S3.SS2.SSS0.Px4.p1.17.m1.1.2.2.cmml">w</mi><mo id="S3.SS2.SSS0.Px4.p1.17.m1.1.2.1" xref="S3.SS2.SSS0.Px4.p1.17.m1.1.2.1.cmml">⁢</mo><mrow id="S3.SS2.SSS0.Px4.p1.17.m1.1.2.3.2" xref="S3.SS2.SSS0.Px4.p1.17.m1.1.2.cmml"><mo id="S3.SS2.SSS0.Px4.p1.17.m1.1.2.3.2.1" stretchy="false" xref="S3.SS2.SSS0.Px4.p1.17.m1.1.2.cmml">(</mo><mi id="S3.SS2.SSS0.Px4.p1.17.m1.1.1" xref="S3.SS2.SSS0.Px4.p1.17.m1.1.1.cmml">y</mi><mo id="S3.SS2.SSS0.Px4.p1.17.m1.1.2.3.2.2" stretchy="false" xref="S3.SS2.SSS0.Px4.p1.17.m1.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS0.Px4.p1.17.m1.1b"><apply id="S3.SS2.SSS0.Px4.p1.17.m1.1.2.cmml" xref="S3.SS2.SSS0.Px4.p1.17.m1.1.2"><times id="S3.SS2.SSS0.Px4.p1.17.m1.1.2.1.cmml" xref="S3.SS2.SSS0.Px4.p1.17.m1.1.2.1"></times><ci id="S3.SS2.SSS0.Px4.p1.17.m1.1.2.2.cmml" xref="S3.SS2.SSS0.Px4.p1.17.m1.1.2.2">𝑤</ci><ci id="S3.SS2.SSS0.Px4.p1.17.m1.1.1.cmml" xref="S3.SS2.SSS0.Px4.p1.17.m1.1.1">𝑦</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS0.Px4.p1.17.m1.1c">w(y)</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS0.Px4.p1.17.m1.1d">italic_w ( italic_y )</annotation></semantics></math> represents two hyper-parameters that weigh the losses for preferred and dis-preferred completions, respectively, as follows:</p>
<table class="ltx_equation ltx_eqn_table" id="S3.E13">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="w(y)=\begin{cases}\lambda_{P}&amp;\text{if }y\sim y_{\lambda}=\text{preferred}\\
\lambda_{D}&amp;\text{if }y\sim y_{\lambda}=\text{dis-preferred}\end{cases}" class="ltx_Math" display="block" id="S3.E13.m1.5"><semantics id="S3.E13.m1.5a"><mrow id="S3.E13.m1.5.6" xref="S3.E13.m1.5.6.cmml"><mrow id="S3.E13.m1.5.6.2" xref="S3.E13.m1.5.6.2.cmml"><mi id="S3.E13.m1.5.6.2.2" xref="S3.E13.m1.5.6.2.2.cmml">w</mi><mo id="S3.E13.m1.5.6.2.1" xref="S3.E13.m1.5.6.2.1.cmml">⁢</mo><mrow id="S3.E13.m1.5.6.2.3.2" xref="S3.E13.m1.5.6.2.cmml"><mo id="S3.E13.m1.5.6.2.3.2.1" stretchy="false" xref="S3.E13.m1.5.6.2.cmml">(</mo><mi id="S3.E13.m1.5.5" xref="S3.E13.m1.5.5.cmml">y</mi><mo id="S3.E13.m1.5.6.2.3.2.2" stretchy="false" xref="S3.E13.m1.5.6.2.cmml">)</mo></mrow></mrow><mo id="S3.E13.m1.5.6.1" xref="S3.E13.m1.5.6.1.cmml">=</mo><mrow id="S3.E13.m1.4.4" xref="S3.E13.m1.5.6.3.1.cmml"><mo id="S3.E13.m1.4.4.5" xref="S3.E13.m1.5.6.3.1.1.cmml">{</mo><mtable columnspacing="5pt" displaystyle="true" id="S3.E13.m1.4.4.4" rowspacing="0pt" xref="S3.E13.m1.5.6.3.1.cmml"><mtr id="S3.E13.m1.4.4.4a" xref="S3.E13.m1.5.6.3.1.cmml"><mtd class="ltx_align_left" columnalign="left" id="S3.E13.m1.4.4.4b" xref="S3.E13.m1.5.6.3.1.cmml"><msub id="S3.E13.m1.1.1.1.1.1.1" xref="S3.E13.m1.1.1.1.1.1.1.cmml"><mi id="S3.E13.m1.1.1.1.1.1.1.2" xref="S3.E13.m1.1.1.1.1.1.1.2.cmml">λ</mi><mi id="S3.E13.m1.1.1.1.1.1.1.3" xref="S3.E13.m1.1.1.1.1.1.1.3.cmml">P</mi></msub></mtd><mtd class="ltx_align_left" columnalign="left" id="S3.E13.m1.4.4.4c" xref="S3.E13.m1.5.6.3.1.cmml"><mrow id="S3.E13.m1.2.2.2.2.2.1" xref="S3.E13.m1.2.2.2.2.2.1.cmml"><mrow id="S3.E13.m1.2.2.2.2.2.1.2" xref="S3.E13.m1.2.2.2.2.2.1.2.cmml"><mtext id="S3.E13.m1.2.2.2.2.2.1.2.2" xref="S3.E13.m1.2.2.2.2.2.1.2.2a.cmml">if </mtext><mo id="S3.E13.m1.2.2.2.2.2.1.2.1" xref="S3.E13.m1.2.2.2.2.2.1.2.1.cmml">⁢</mo><mi id="S3.E13.m1.2.2.2.2.2.1.2.3" xref="S3.E13.m1.2.2.2.2.2.1.2.3.cmml">y</mi></mrow><mo id="S3.E13.m1.2.2.2.2.2.1.3" xref="S3.E13.m1.2.2.2.2.2.1.3.cmml">∼</mo><msub id="S3.E13.m1.2.2.2.2.2.1.4" xref="S3.E13.m1.2.2.2.2.2.1.4.cmml"><mi id="S3.E13.m1.2.2.2.2.2.1.4.2" xref="S3.E13.m1.2.2.2.2.2.1.4.2.cmml">y</mi><mi id="S3.E13.m1.2.2.2.2.2.1.4.3" xref="S3.E13.m1.2.2.2.2.2.1.4.3.cmml">λ</mi></msub><mo id="S3.E13.m1.2.2.2.2.2.1.5" xref="S3.E13.m1.2.2.2.2.2.1.5.cmml">=</mo><mtext id="S3.E13.m1.2.2.2.2.2.1.6" xref="S3.E13.m1.2.2.2.2.2.1.6a.cmml">preferred</mtext></mrow></mtd></mtr><mtr id="S3.E13.m1.4.4.4d" xref="S3.E13.m1.5.6.3.1.cmml"><mtd class="ltx_align_left" columnalign="left" id="S3.E13.m1.4.4.4e" xref="S3.E13.m1.5.6.3.1.cmml"><msub id="S3.E13.m1.3.3.3.3.1.1" xref="S3.E13.m1.3.3.3.3.1.1.cmml"><mi id="S3.E13.m1.3.3.3.3.1.1.2" xref="S3.E13.m1.3.3.3.3.1.1.2.cmml">λ</mi><mi id="S3.E13.m1.3.3.3.3.1.1.3" xref="S3.E13.m1.3.3.3.3.1.1.3.cmml">D</mi></msub></mtd><mtd class="ltx_align_left" columnalign="left" id="S3.E13.m1.4.4.4f" xref="S3.E13.m1.5.6.3.1.cmml"><mrow id="S3.E13.m1.4.4.4.4.2.1" xref="S3.E13.m1.4.4.4.4.2.1.cmml"><mrow id="S3.E13.m1.4.4.4.4.2.1.2" xref="S3.E13.m1.4.4.4.4.2.1.2.cmml"><mtext id="S3.E13.m1.4.4.4.4.2.1.2.2" xref="S3.E13.m1.4.4.4.4.2.1.2.2a.cmml">if </mtext><mo id="S3.E13.m1.4.4.4.4.2.1.2.1" xref="S3.E13.m1.4.4.4.4.2.1.2.1.cmml">⁢</mo><mi id="S3.E13.m1.4.4.4.4.2.1.2.3" xref="S3.E13.m1.4.4.4.4.2.1.2.3.cmml">y</mi></mrow><mo id="S3.E13.m1.4.4.4.4.2.1.3" xref="S3.E13.m1.4.4.4.4.2.1.3.cmml">∼</mo><msub id="S3.E13.m1.4.4.4.4.2.1.4" xref="S3.E13.m1.4.4.4.4.2.1.4.cmml"><mi id="S3.E13.m1.4.4.4.4.2.1.4.2" xref="S3.E13.m1.4.4.4.4.2.1.4.2.cmml">y</mi><mi id="S3.E13.m1.4.4.4.4.2.1.4.3" xref="S3.E13.m1.4.4.4.4.2.1.4.3.cmml">λ</mi></msub><mo id="S3.E13.m1.4.4.4.4.2.1.5" xref="S3.E13.m1.4.4.4.4.2.1.5.cmml">=</mo><mtext id="S3.E13.m1.4.4.4.4.2.1.6" xref="S3.E13.m1.4.4.4.4.2.1.6a.cmml">dis-preferred</mtext></mrow></mtd></mtr></mtable></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.E13.m1.5b"><apply id="S3.E13.m1.5.6.cmml" xref="S3.E13.m1.5.6"><eq id="S3.E13.m1.5.6.1.cmml" xref="S3.E13.m1.5.6.1"></eq><apply id="S3.E13.m1.5.6.2.cmml" xref="S3.E13.m1.5.6.2"><times id="S3.E13.m1.5.6.2.1.cmml" xref="S3.E13.m1.5.6.2.1"></times><ci id="S3.E13.m1.5.6.2.2.cmml" xref="S3.E13.m1.5.6.2.2">𝑤</ci><ci id="S3.E13.m1.5.5.cmml" xref="S3.E13.m1.5.5">𝑦</ci></apply><apply id="S3.E13.m1.5.6.3.1.cmml" xref="S3.E13.m1.4.4"><csymbol cd="latexml" id="S3.E13.m1.5.6.3.1.1.cmml" xref="S3.E13.m1.4.4.5">cases</csymbol><apply id="S3.E13.m1.1.1.1.1.1.1.cmml" xref="S3.E13.m1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E13.m1.1.1.1.1.1.1.1.cmml" xref="S3.E13.m1.1.1.1.1.1.1">subscript</csymbol><ci id="S3.E13.m1.1.1.1.1.1.1.2.cmml" xref="S3.E13.m1.1.1.1.1.1.1.2">𝜆</ci><ci id="S3.E13.m1.1.1.1.1.1.1.3.cmml" xref="S3.E13.m1.1.1.1.1.1.1.3">𝑃</ci></apply><apply id="S3.E13.m1.2.2.2.2.2.1.cmml" xref="S3.E13.m1.2.2.2.2.2.1"><and id="S3.E13.m1.2.2.2.2.2.1a.cmml" xref="S3.E13.m1.2.2.2.2.2.1"></and><apply id="S3.E13.m1.2.2.2.2.2.1b.cmml" xref="S3.E13.m1.2.2.2.2.2.1"><csymbol cd="latexml" id="S3.E13.m1.2.2.2.2.2.1.3.cmml" xref="S3.E13.m1.2.2.2.2.2.1.3">similar-to</csymbol><apply id="S3.E13.m1.2.2.2.2.2.1.2.cmml" xref="S3.E13.m1.2.2.2.2.2.1.2"><times id="S3.E13.m1.2.2.2.2.2.1.2.1.cmml" xref="S3.E13.m1.2.2.2.2.2.1.2.1"></times><ci id="S3.E13.m1.2.2.2.2.2.1.2.2a.cmml" xref="S3.E13.m1.2.2.2.2.2.1.2.2"><mtext id="S3.E13.m1.2.2.2.2.2.1.2.2.cmml" xref="S3.E13.m1.2.2.2.2.2.1.2.2">if </mtext></ci><ci id="S3.E13.m1.2.2.2.2.2.1.2.3.cmml" xref="S3.E13.m1.2.2.2.2.2.1.2.3">𝑦</ci></apply><apply id="S3.E13.m1.2.2.2.2.2.1.4.cmml" xref="S3.E13.m1.2.2.2.2.2.1.4"><csymbol cd="ambiguous" id="S3.E13.m1.2.2.2.2.2.1.4.1.cmml" xref="S3.E13.m1.2.2.2.2.2.1.4">subscript</csymbol><ci id="S3.E13.m1.2.2.2.2.2.1.4.2.cmml" xref="S3.E13.m1.2.2.2.2.2.1.4.2">𝑦</ci><ci id="S3.E13.m1.2.2.2.2.2.1.4.3.cmml" xref="S3.E13.m1.2.2.2.2.2.1.4.3">𝜆</ci></apply></apply><apply id="S3.E13.m1.2.2.2.2.2.1c.cmml" xref="S3.E13.m1.2.2.2.2.2.1"><eq id="S3.E13.m1.2.2.2.2.2.1.5.cmml" xref="S3.E13.m1.2.2.2.2.2.1.5"></eq><share href="https://arxiv.org/html/2405.13984v1#S3.E13.m1.2.2.2.2.2.1.4.cmml" id="S3.E13.m1.2.2.2.2.2.1d.cmml" xref="S3.E13.m1.2.2.2.2.2.1"></share><ci id="S3.E13.m1.2.2.2.2.2.1.6a.cmml" xref="S3.E13.m1.2.2.2.2.2.1.6"><mtext id="S3.E13.m1.2.2.2.2.2.1.6.cmml" xref="S3.E13.m1.2.2.2.2.2.1.6">preferred</mtext></ci></apply></apply><apply id="S3.E13.m1.3.3.3.3.1.1.cmml" xref="S3.E13.m1.3.3.3.3.1.1"><csymbol cd="ambiguous" id="S3.E13.m1.3.3.3.3.1.1.1.cmml" xref="S3.E13.m1.3.3.3.3.1.1">subscript</csymbol><ci id="S3.E13.m1.3.3.3.3.1.1.2.cmml" xref="S3.E13.m1.3.3.3.3.1.1.2">𝜆</ci><ci id="S3.E13.m1.3.3.3.3.1.1.3.cmml" xref="S3.E13.m1.3.3.3.3.1.1.3">𝐷</ci></apply><apply id="S3.E13.m1.4.4.4.4.2.1.cmml" xref="S3.E13.m1.4.4.4.4.2.1"><and id="S3.E13.m1.4.4.4.4.2.1a.cmml" xref="S3.E13.m1.4.4.4.4.2.1"></and><apply id="S3.E13.m1.4.4.4.4.2.1b.cmml" xref="S3.E13.m1.4.4.4.4.2.1"><csymbol cd="latexml" id="S3.E13.m1.4.4.4.4.2.1.3.cmml" xref="S3.E13.m1.4.4.4.4.2.1.3">similar-to</csymbol><apply id="S3.E13.m1.4.4.4.4.2.1.2.cmml" xref="S3.E13.m1.4.4.4.4.2.1.2"><times id="S3.E13.m1.4.4.4.4.2.1.2.1.cmml" xref="S3.E13.m1.4.4.4.4.2.1.2.1"></times><ci id="S3.E13.m1.4.4.4.4.2.1.2.2a.cmml" xref="S3.E13.m1.4.4.4.4.2.1.2.2"><mtext id="S3.E13.m1.4.4.4.4.2.1.2.2.cmml" xref="S3.E13.m1.4.4.4.4.2.1.2.2">if </mtext></ci><ci id="S3.E13.m1.4.4.4.4.2.1.2.3.cmml" xref="S3.E13.m1.4.4.4.4.2.1.2.3">𝑦</ci></apply><apply id="S3.E13.m1.4.4.4.4.2.1.4.cmml" xref="S3.E13.m1.4.4.4.4.2.1.4"><csymbol cd="ambiguous" id="S3.E13.m1.4.4.4.4.2.1.4.1.cmml" xref="S3.E13.m1.4.4.4.4.2.1.4">subscript</csymbol><ci id="S3.E13.m1.4.4.4.4.2.1.4.2.cmml" xref="S3.E13.m1.4.4.4.4.2.1.4.2">𝑦</ci><ci id="S3.E13.m1.4.4.4.4.2.1.4.3.cmml" xref="S3.E13.m1.4.4.4.4.2.1.4.3">𝜆</ci></apply></apply><apply id="S3.E13.m1.4.4.4.4.2.1c.cmml" xref="S3.E13.m1.4.4.4.4.2.1"><eq id="S3.E13.m1.4.4.4.4.2.1.5.cmml" xref="S3.E13.m1.4.4.4.4.2.1.5"></eq><share href="https://arxiv.org/html/2405.13984v1#S3.E13.m1.4.4.4.4.2.1.4.cmml" id="S3.E13.m1.4.4.4.4.2.1d.cmml" xref="S3.E13.m1.4.4.4.4.2.1"></share><ci id="S3.E13.m1.4.4.4.4.2.1.6a.cmml" xref="S3.E13.m1.4.4.4.4.2.1.6"><mtext id="S3.E13.m1.4.4.4.4.2.1.6.cmml" xref="S3.E13.m1.4.4.4.4.2.1.6">dis-preferred</mtext></ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E13.m1.5c">w(y)=\begin{cases}\lambda_{P}&amp;\text{if }y\sim y_{\lambda}=\text{preferred}\\
\lambda_{D}&amp;\text{if }y\sim y_{\lambda}=\text{dis-preferred}\end{cases}</annotation><annotation encoding="application/x-llamapun" id="S3.E13.m1.5d">italic_w ( italic_y ) = { start_ROW start_CELL italic_λ start_POSTSUBSCRIPT italic_P end_POSTSUBSCRIPT end_CELL start_CELL if italic_y ∼ italic_y start_POSTSUBSCRIPT italic_λ end_POSTSUBSCRIPT = preferred end_CELL end_ROW start_ROW start_CELL italic_λ start_POSTSUBSCRIPT italic_D end_POSTSUBSCRIPT end_CELL start_CELL if italic_y ∼ italic_y start_POSTSUBSCRIPT italic_λ end_POSTSUBSCRIPT = dis-preferred end_CELL end_ROW</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(13)</span></td>
</tr></tbody>
</table>
</div>
</section>
</section>
<section class="ltx_subsection" id="S3.SS3">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.3 </span>Mixed Cross-Modals Fusion</h3>
<div class="ltx_para" id="S3.SS3.p1">
<p class="ltx_p" id="S3.SS3.p1.1">We propose a novel fusion approach that mixes cross-modal capabilities of LLMs excelling in unidirectional LMolT without increasing training costs or data needs. Our approach builds on early work in model merging, which linearly combines weights of pre-trained models into a unified, robust model <cite class="ltx_cite ltx_citemacro_cite">Wortsman et al. (<a class="ltx_ref" href="https://arxiv.org/html/2405.13984v1#bib.bib37" title="">2022</a>)</cite>. This addresses challenges related to disparities in the informativeness of different modalities and limitations of optimisation algorithms requiring LLMs trained on extensive data. We have employed the following non-linear fusion algorithms for mixing cross-modal LLMs :</p>
<ul class="ltx_itemize" id="S3.I1">
<li class="ltx_item" id="S3.I1.i1" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S3.I1.i1.p1">
<p class="ltx_p" id="S3.I1.i1.p1.1"><span class="ltx_text ltx_font_bold" id="S3.I1.i1.p1.1.1">Trim, Elect Sign &amp; Merge (TIES)</span> <cite class="ltx_cite ltx_citemacro_cite">Yadav et al. (<a class="ltx_ref" href="https://arxiv.org/html/2405.13984v1#bib.bib40" title="">2024</a>)</cite>: This method addresses inference challenges caused by parameter interference from merging different models. It involves three steps: (1) resetting parameters that changed minimally during fine-tuning, (2) resolving sign conflicts, and (3) merging only the parameters aligned with the final agreed-upon sign.</p>
</div>
</li>
<li class="ltx_item" id="S3.I1.i2" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S3.I1.i2.p1">
<p class="ltx_p" id="S3.I1.i2.p1.1"><span class="ltx_text ltx_font_bold" id="S3.I1.i2.p1.1.1">Spherical Linear Interpolation (SLERP)</span> <cite class="ltx_cite ltx_citemacro_cite">Shoemake (<a class="ltx_ref" href="https://arxiv.org/html/2405.13984v1#bib.bib30" title="">1985</a>)</cite>: It is a geometric approach that blends two models while preserving their distinctive characteristics and curvature in high-dimensional spaces. The process consists of three steps: (1) normalising vectors to unit length, prioritising directions over magnitudes, (2) calculating the scale factor, which determines the interpolation factor and the angle between vectors across the fused models, and (3) weighting and summing the vectors to derive the interpolated representation in the fused model.</p>
</div>
</li>
</ul>
</div>
</section>
<section class="ltx_subsection" id="S3.SS4">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.4 </span>Evaluation Method for Assessing Hallucination in Chemical LLMs</h3>
<div class="ltx_para" id="S3.SS4.p1">
<p class="ltx_p" id="S3.SS4.p1.1">Previous work has employed embedding representations <cite class="ltx_cite ltx_citemacro_cite">Jaeger et al. (<a class="ltx_ref" href="https://arxiv.org/html/2405.13984v1#bib.bib14" title="">2018</a>)</cite> to assess semantics in chemical-domain models <cite class="ltx_cite ltx_citemacro_cite">Edwards et al. (<a class="ltx_ref" href="https://arxiv.org/html/2405.13984v1#bib.bib7" title="">2021</a>); Christofidellis et al. (<a class="ltx_ref" href="https://arxiv.org/html/2405.13984v1#bib.bib5" title="">2023</a>)</cite>. However, these approaches often require domain adaptation for out-of-distribution data <cite class="ltx_cite ltx_citemacro_cite">Edwards et al. (<a class="ltx_ref" href="https://arxiv.org/html/2405.13984v1#bib.bib9" title="">2024</a>)</cite> and might yield opaque and arbitrary outcomes <cite class="ltx_cite ltx_citemacro_cite">Steck et al. (<a class="ltx_ref" href="https://arxiv.org/html/2405.13984v1#bib.bib31" title="">2024</a>)</cite>. Here, in addition to performing evaluation according to standard generation metrics, we also introduce fine-grained multi-aspect evaluation criteria for assessing the presence of hallucinations<span class="ltx_note ltx_role_footnote" id="footnote1"><sup class="ltx_note_mark">1</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">1</sup><span class="ltx_tag ltx_tag_note">1</span>Hallucination in LLMs refers to a phenomenon where the generated outputs are inaccurate, nonsensical, or contradictory to the provided factual information.</span></span></span> in generated outputs.</p>
</div>
<div class="ltx_para" id="S3.SS4.p2">
<p class="ltx_p" id="S3.SS4.p2.1">Specifically, for our language-to-molecule translation evaluation, we introduce the following metrics:</p>
<ul class="ltx_itemize" id="S3.I2">
<li class="ltx_item" id="S3.I2.i1" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S3.I2.i1.p1">
<p class="ltx_p" id="S3.I2.i1.p1.1"><math alttext="\Delta_{Len}" class="ltx_Math" display="inline" id="S3.I2.i1.p1.1.m1.1"><semantics id="S3.I2.i1.p1.1.m1.1a"><msub id="S3.I2.i1.p1.1.m1.1.1" xref="S3.I2.i1.p1.1.m1.1.1.cmml"><mi id="S3.I2.i1.p1.1.m1.1.1.2" mathvariant="normal" xref="S3.I2.i1.p1.1.m1.1.1.2.cmml">Δ</mi><mrow id="S3.I2.i1.p1.1.m1.1.1.3" xref="S3.I2.i1.p1.1.m1.1.1.3.cmml"><mi id="S3.I2.i1.p1.1.m1.1.1.3.2" xref="S3.I2.i1.p1.1.m1.1.1.3.2.cmml">L</mi><mo id="S3.I2.i1.p1.1.m1.1.1.3.1" xref="S3.I2.i1.p1.1.m1.1.1.3.1.cmml">⁢</mo><mi id="S3.I2.i1.p1.1.m1.1.1.3.3" xref="S3.I2.i1.p1.1.m1.1.1.3.3.cmml">e</mi><mo id="S3.I2.i1.p1.1.m1.1.1.3.1a" xref="S3.I2.i1.p1.1.m1.1.1.3.1.cmml">⁢</mo><mi id="S3.I2.i1.p1.1.m1.1.1.3.4" xref="S3.I2.i1.p1.1.m1.1.1.3.4.cmml">n</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S3.I2.i1.p1.1.m1.1b"><apply id="S3.I2.i1.p1.1.m1.1.1.cmml" xref="S3.I2.i1.p1.1.m1.1.1"><csymbol cd="ambiguous" id="S3.I2.i1.p1.1.m1.1.1.1.cmml" xref="S3.I2.i1.p1.1.m1.1.1">subscript</csymbol><ci id="S3.I2.i1.p1.1.m1.1.1.2.cmml" xref="S3.I2.i1.p1.1.m1.1.1.2">Δ</ci><apply id="S3.I2.i1.p1.1.m1.1.1.3.cmml" xref="S3.I2.i1.p1.1.m1.1.1.3"><times id="S3.I2.i1.p1.1.m1.1.1.3.1.cmml" xref="S3.I2.i1.p1.1.m1.1.1.3.1"></times><ci id="S3.I2.i1.p1.1.m1.1.1.3.2.cmml" xref="S3.I2.i1.p1.1.m1.1.1.3.2">𝐿</ci><ci id="S3.I2.i1.p1.1.m1.1.1.3.3.cmml" xref="S3.I2.i1.p1.1.m1.1.1.3.3">𝑒</ci><ci id="S3.I2.i1.p1.1.m1.1.1.3.4.cmml" xref="S3.I2.i1.p1.1.m1.1.1.3.4">𝑛</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.I2.i1.p1.1.m1.1c">\Delta_{Len}</annotation><annotation encoding="application/x-llamapun" id="S3.I2.i1.p1.1.m1.1d">roman_Δ start_POSTSUBSCRIPT italic_L italic_e italic_n end_POSTSUBSCRIPT</annotation></semantics></math><span class="ltx_text ltx_font_bold" id="S3.I2.i1.p1.1.1">:</span> Measures the deviation in character length between generated and reference molecule pairs.</p>
</div>
</li>
<li class="ltx_item" id="S3.I2.i2" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S3.I2.i2.p1">
<p class="ltx_p" id="S3.I2.i2.p1.1"><span class="ltx_text ltx_font_bold" id="S3.I2.i2.p1.1.1">Chr-F</span> <cite class="ltx_cite ltx_citemacro_cite">Popović (<a class="ltx_ref" href="https://arxiv.org/html/2405.13984v1#bib.bib24" title="">2015</a>)</cite>: Utilises the F-score statistic for character n-gram matches between prediction-reference pairs. Here it assesses matches in translated molecules against their references by averaging the scores of unigram, bigram, and trigram matches. A higher Chr-F indicates better performance.</p>
</div>
</li>
<li class="ltx_item" id="S3.I2.i3" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S3.I2.i3.p1">
<p class="ltx_p" id="S3.I2.i3.p1.1"><span class="ltx_text ltx_font_bold" id="S3.I2.i3.p1.1.1">Win Rate</span>: Determines the percentage of successfully generated molecules within the test subset. Each sample in the test set is considered a win if it meets several strict criteria: a) Chr-F score &gt; 0.3, b) absolute length deviation from the reference &lt; 5, and c) a valid generated output adhering to standard molecular structure conventions<span class="ltx_note ltx_role_footnote" id="footnote2"><sup class="ltx_note_mark">2</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">2</sup><span class="ltx_tag ltx_tag_note">2</span>Threshold values are determined experimentally, while validity is automatically assessed using rdkit.</span></span></span>.</p>
</div>
</li>
</ul>
</div>
<div class="ltx_para" id="S3.SS4.p3">
<p class="ltx_p" id="S3.SS4.p3.1">For our molecule-to-language translation evaluation, we introduce similar metrics:</p>
<ul class="ltx_itemize" id="S3.I3">
<li class="ltx_item" id="S3.I3.i1" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S3.I3.i1.p1">
<p class="ltx_p" id="S3.I3.i1.p1.1"><math alttext="\Delta_{Len}" class="ltx_Math" display="inline" id="S3.I3.i1.p1.1.m1.1"><semantics id="S3.I3.i1.p1.1.m1.1a"><msub id="S3.I3.i1.p1.1.m1.1.1" xref="S3.I3.i1.p1.1.m1.1.1.cmml"><mi id="S3.I3.i1.p1.1.m1.1.1.2" mathvariant="normal" xref="S3.I3.i1.p1.1.m1.1.1.2.cmml">Δ</mi><mrow id="S3.I3.i1.p1.1.m1.1.1.3" xref="S3.I3.i1.p1.1.m1.1.1.3.cmml"><mi id="S3.I3.i1.p1.1.m1.1.1.3.2" xref="S3.I3.i1.p1.1.m1.1.1.3.2.cmml">L</mi><mo id="S3.I3.i1.p1.1.m1.1.1.3.1" xref="S3.I3.i1.p1.1.m1.1.1.3.1.cmml">⁢</mo><mi id="S3.I3.i1.p1.1.m1.1.1.3.3" xref="S3.I3.i1.p1.1.m1.1.1.3.3.cmml">e</mi><mo id="S3.I3.i1.p1.1.m1.1.1.3.1a" xref="S3.I3.i1.p1.1.m1.1.1.3.1.cmml">⁢</mo><mi id="S3.I3.i1.p1.1.m1.1.1.3.4" xref="S3.I3.i1.p1.1.m1.1.1.3.4.cmml">n</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S3.I3.i1.p1.1.m1.1b"><apply id="S3.I3.i1.p1.1.m1.1.1.cmml" xref="S3.I3.i1.p1.1.m1.1.1"><csymbol cd="ambiguous" id="S3.I3.i1.p1.1.m1.1.1.1.cmml" xref="S3.I3.i1.p1.1.m1.1.1">subscript</csymbol><ci id="S3.I3.i1.p1.1.m1.1.1.2.cmml" xref="S3.I3.i1.p1.1.m1.1.1.2">Δ</ci><apply id="S3.I3.i1.p1.1.m1.1.1.3.cmml" xref="S3.I3.i1.p1.1.m1.1.1.3"><times id="S3.I3.i1.p1.1.m1.1.1.3.1.cmml" xref="S3.I3.i1.p1.1.m1.1.1.3.1"></times><ci id="S3.I3.i1.p1.1.m1.1.1.3.2.cmml" xref="S3.I3.i1.p1.1.m1.1.1.3.2">𝐿</ci><ci id="S3.I3.i1.p1.1.m1.1.1.3.3.cmml" xref="S3.I3.i1.p1.1.m1.1.1.3.3">𝑒</ci><ci id="S3.I3.i1.p1.1.m1.1.1.3.4.cmml" xref="S3.I3.i1.p1.1.m1.1.1.3.4">𝑛</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.I3.i1.p1.1.m1.1c">\Delta_{Len}</annotation><annotation encoding="application/x-llamapun" id="S3.I3.i1.p1.1.m1.1d">roman_Δ start_POSTSUBSCRIPT italic_L italic_e italic_n end_POSTSUBSCRIPT</annotation></semantics></math><span class="ltx_text ltx_font_bold" id="S3.I3.i1.p1.1.1">:</span> Calculates the token-length deviation in generated-reference pairs of texts.</p>
</div>
</li>
<li class="ltx_item" id="S3.I3.i2" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S3.I3.i2.p1">
<p class="ltx_p" id="S3.I3.i2.p1.1"><span class="ltx_text ltx_font_bold" id="S3.I3.i2.p1.1.1">Natural Language Inference (NLI)</span> <cite class="ltx_cite ltx_citemacro_cite">Williams et al. (<a class="ltx_ref" href="https://arxiv.org/html/2405.13984v1#bib.bib36" title="">2018</a>)</cite>: We utilise scores from an NLI model<span class="ltx_note ltx_role_footnote" id="footnote3"><sup class="ltx_note_mark">3</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">3</sup><span class="ltx_tag ltx_tag_note">3</span>We use <span class="ltx_text ltx_font_italic" id="footnote3.1">NLI-DeBERTa</span> based on  <cite class="ltx_cite ltx_citemacro_cite">He et al. (<a class="ltx_ref" href="https://arxiv.org/html/2405.13984v1#bib.bib12" title="">2021</a>)</cite>.</span></span></span>. Specifically, we obtain the probabilities of predictions being entailed in references. Higher probabilities indicate better performance.</p>
</div>
</li>
<li class="ltx_item" id="S3.I3.i3" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S3.I3.i3.p1">
<p class="ltx_p" id="S3.I3.i3.p1.1"><span class="ltx_text ltx_font_bold" id="S3.I3.i3.p1.1.1">Win Rate</span>: Measures the percentage of successfully generated outputs within the test subset. A generated output, in regard to its corresponding reference, is considered a win if classified by the NLI model as entailment rather than neutral or contradiction.</p>
</div>
</li>
</ul>
</div>
</section>
</section>
<section class="ltx_section" id="S4">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">4 </span>Experiments</h2>
<section class="ltx_subsection" id="S4.SS1">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.1 </span>Data</h3>
<div class="ltx_para" id="S4.SS1.p1">
<p class="ltx_p" id="S4.SS1.p1.1">Experiments are conducted on the <span class="ltx_text ltx_font_italic" id="S4.SS1.p1.1.1">L+M-24</span> benchmark dataset, which integrates molecular and linguistic modalities segmented into four categories with significant applications: biomedical; light and electricity; human interaction and organoleptics; and agriculture and industry <cite class="ltx_cite ltx_citemacro_cite">Edwards et al. (<a class="ltx_ref" href="https://arxiv.org/html/2405.13984v1#bib.bib9" title="">2024</a>)</cite>. This dataset is created by extracting molecules and their associated chemical properties from chemical databases. These properties are subsequently transformed into natural language using a template composition procedure with GPT-4.</p>
</div>
<div class="ltx_para" id="S4.SS1.p2">
<p class="ltx_p" id="S4.SS1.p2.1">The training and validation subsets comprise approximately 127k and 34k language-molecule pairs, respectively. We utilise 10% of these subsets for training and validation purposes. To implement optimisation algorithms using offline preference data, we construct tailored triple datasets (refer to <math alttext="\S" class="ltx_Math" display="inline" id="S4.SS1.p2.1.m1.1"><semantics id="S4.SS1.p2.1.m1.1a"><mi id="S4.SS1.p2.1.m1.1.1" mathvariant="normal" xref="S4.SS1.p2.1.m1.1.1.cmml">§</mi><annotation-xml encoding="MathML-Content" id="S4.SS1.p2.1.m1.1b"><ci id="S4.SS1.p2.1.m1.1.1.cmml" xref="S4.SS1.p2.1.m1.1.1">§</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p2.1.m1.1c">\S</annotation><annotation encoding="application/x-llamapun" id="S4.SS1.p2.1.m1.1d">§</annotation></semantics></math><a class="ltx_ref" href="https://arxiv.org/html/2405.13984v1#S3.SS2" title="3.2 Feedback-Aligned Optimisations Algorithms ‣ 3 Methodology ‣ Feedback-aligned Mixed LLMs for Machine Language-Molecule Translation"><span class="ltx_text ltx_ref_tag">3.2</span></a>) comprising both preferred and dis-preferred outputs. The preferred outputs are comprised of the golden references from <span class="ltx_text ltx_font_italic" id="S4.SS1.p2.1.1">L+M-24</span>, while we generate the dis-preferred outputs synthetically using MolT5 <cite class="ltx_cite ltx_citemacro_cite">Edwards et al. (<a class="ltx_ref" href="https://arxiv.org/html/2405.13984v1#bib.bib8" title="">2022</a>)</cite>. For evaluation, we randomly selected 3k unseen pairs from a distinct dataset provided as supplementary resources for extensive training of chemical LLMs at the Language + Molecules @ ACL2024 workshop.<span class="ltx_note ltx_role_footnote" id="footnote4"><sup class="ltx_note_mark">4</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">4</sup><span class="ltx_tag ltx_tag_note">4</span>Sampling is conducted from the test subset of the separate supplementary data provided for the Language + Molecules @ ACL2024 workshop; <a class="ltx_ref ltx_url ltx_font_typewriter" href="https://github.com/language-plus-molecules/LPM-24-Dataset" title="">https://github.com/language-plus-molecules/LPM-24-Dataset</a></span></span></span>.</p>
</div>
</section>
<section class="ltx_subsection" id="S4.SS2">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.2 </span>Benchmark Models</h3>
<div class="ltx_para" id="S4.SS2.p1">
<p class="ltx_p" id="S4.SS2.p1.1">We compare our results with established language-molecule models as reported in the literature:</p>
<ul class="ltx_itemize" id="S4.I1">
<li class="ltx_item" id="S4.I1.i1" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S4.I1.i1.p1">
<p class="ltx_p" id="S4.I1.i1.p1.1">TxtChem-T5 <cite class="ltx_cite ltx_citemacro_cite">Christofidellis et al. (<a class="ltx_ref" href="https://arxiv.org/html/2405.13984v1#bib.bib5" title="">2023</a>)</cite>: A T5<sub class="ltx_sub" id="S4.I1.i1.p1.1.1"><span class="ltx_text ltx_font_italic" id="S4.I1.i1.p1.1.1.1">XL</span></sub> model trained on both linguistic and molecule modalities with a multi-task objective across various datasets, including the CheBI-20 dataset <cite class="ltx_cite ltx_citemacro_cite">Edwards et al. (<a class="ltx_ref" href="https://arxiv.org/html/2405.13984v1#bib.bib8" title="">2022</a>)</cite>, similar to <span class="ltx_text ltx_font_italic" id="S4.I1.i1.p1.1.2">L+M-24</span>.</p>
</div>
</li>
<li class="ltx_item" id="S4.I1.i2" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S4.I1.i2.p1">
<p class="ltx_p" id="S4.I1.i2.p1.1">Chem-LLM <cite class="ltx_cite ltx_citemacro_cite">Zhang et al. (<a class="ltx_ref" href="https://arxiv.org/html/2405.13984v1#bib.bib41" title="">2024</a>)</cite>: An InternLM2-Base-7B model, trained on an extensive chemical domain knowledge dataset, with a direct preference optimisation objective <cite class="ltx_cite ltx_citemacro_cite">Rafailov et al. (<a class="ltx_ref" href="https://arxiv.org/html/2405.13984v1#bib.bib26" title="">2024</a>)</cite>, achieving results comparable to GPT-4.</p>
</div>
</li>
<li class="ltx_item" id="S4.I1.i3" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S4.I1.i3.p1">
<p class="ltx_p" id="S4.I1.i3.p1.1">Meditron <cite class="ltx_cite ltx_citemacro_cite">Chen et al. (<a class="ltx_ref" href="https://arxiv.org/html/2405.13984v1#bib.bib4" title="">2023</a>)</cite>: A Meditron-7B model fine-tuned on the entire <span class="ltx_text ltx_font_italic" id="S4.I1.i3.p1.1.1">L+M-24</span> dataset for unidirectional language-molecule translation.</p>
</div>
</li>
<li class="ltx_item" id="S4.I1.i4" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S4.I1.i4.p1">
<p class="ltx_p" id="S4.I1.i4.p1.1">SFT-Meditron: Our supervised Meditron-7B fine-tuned on a 10% subset of <span class="ltx_text ltx_font_italic" id="S4.I1.i4.p1.1.1">L+M-24</span> for bi-directional machine language-molecule translation.</p>
</div>
</li>
</ul>
</div>
</section>
<section class="ltx_subsection" id="S4.SS3">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.3 </span>Experimental Setup</h3>
<div class="ltx_para" id="S4.SS3.p1">
<p class="ltx_p" id="S4.SS3.p1.2">All experiments are conducted using Meditron <cite class="ltx_cite ltx_citemacro_cite">Chen et al. (<a class="ltx_ref" href="https://arxiv.org/html/2405.13984v1#bib.bib4" title="">2023</a>)</cite>, a model previously noted for its performance on L+M+24. When investigating optimisation algorithms (<math alttext="\S" class="ltx_Math" display="inline" id="S4.SS3.p1.1.m1.1"><semantics id="S4.SS3.p1.1.m1.1a"><mi id="S4.SS3.p1.1.m1.1.1" mathvariant="normal" xref="S4.SS3.p1.1.m1.1.1.cmml">§</mi><annotation-xml encoding="MathML-Content" id="S4.SS3.p1.1.m1.1b"><ci id="S4.SS3.p1.1.m1.1.1.cmml" xref="S4.SS3.p1.1.m1.1.1">§</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p1.1.m1.1c">\S</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.p1.1.m1.1d">§</annotation></semantics></math> <a class="ltx_ref" href="https://arxiv.org/html/2405.13984v1#S3.SS2" title="3.2 Feedback-Aligned Optimisations Algorithms ‣ 3 Methodology ‣ Feedback-aligned Mixed LLMs for Machine Language-Molecule Translation"><span class="ltx_text ltx_ref_tag">3.2</span></a>), we initialise cross-modals from Meditron trained for unidirectional language-to-molecule translation<span class="ltx_note ltx_role_footnote" id="footnote5"><sup class="ltx_note_mark">5</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">5</sup><span class="ltx_tag ltx_tag_note">5</span>Initialisation of cross-modals is based on the task reported as most challenging in <cite class="ltx_cite ltx_citemacro_cite">Edwards et al. (<a class="ltx_ref" href="https://arxiv.org/html/2405.13984v1#bib.bib9" title="">2024</a>)</cite>.</span></span></span>. In investigations of mixed modality fusion strategies (<math alttext="\S" class="ltx_Math" display="inline" id="S4.SS3.p1.2.m2.1"><semantics id="S4.SS3.p1.2.m2.1a"><mi id="S4.SS3.p1.2.m2.1.1" mathvariant="normal" xref="S4.SS3.p1.2.m2.1.1.cmml">§</mi><annotation-xml encoding="MathML-Content" id="S4.SS3.p1.2.m2.1b"><ci id="S4.SS3.p1.2.m2.1.1.cmml" xref="S4.SS3.p1.2.m2.1.1">§</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p1.2.m2.1c">\S</annotation><annotation encoding="application/x-llamapun" id="S4.SS3.p1.2.m2.1d">§</annotation></semantics></math> <a class="ltx_ref" href="https://arxiv.org/html/2405.13984v1#S3.SS3" title="3.3 Mixed Cross-Modals Fusion ‣ 3 Methodology ‣ Feedback-aligned Mixed LLMs for Machine Language-Molecule Translation"><span class="ltx_text ltx_ref_tag">3.3</span></a>), we obtain cross-modals from separate Meditron models trained for unidirectional language-to-molecule and molecule-to-language translation, fusing them in a 19:1 ratio<span class="ltx_note ltx_role_footnote" id="footnote6"><sup class="ltx_note_mark">6</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">6</sup><span class="ltx_tag ltx_tag_note">6</span>The experimental ratio of cross-modals aims to maintain information integrity across them.</span></span></span>. All models are trained with QLoRA <cite class="ltx_cite ltx_citemacro_cite">Dettmers et al. (<a class="ltx_ref" href="https://arxiv.org/html/2405.13984v1#bib.bib6" title="">2024</a>)</cite>, with experimental settings detailed in Appx. <a class="ltx_ref" href="https://arxiv.org/html/2405.13984v1#A6" title="Appendix F Experimental Settings ‣ Feedback-aligned Mixed LLMs for Machine Language-Molecule Translation"><span class="ltx_text ltx_ref_tag">F</span></a>. For evaluation metrics please refer to Appx <a class="ltx_ref" href="https://arxiv.org/html/2405.13984v1#A4" title="Appendix D Evaluation Metrics ‣ Feedback-aligned Mixed LLMs for Machine Language-Molecule Translation"><span class="ltx_text ltx_ref_tag">D</span></a></p>
</div>
</section>
<section class="ltx_subsection" id="S4.SS4">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.4 </span>Results</h3>
<section class="ltx_subsubsection" id="S4.SS4.SSS1">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">4.4.1 </span>Quantitative Analysis on Feedback-Aligned Optimisation Algorithms</h4>
<div class="ltx_para" id="S4.SS4.SSS1.p1">
<p class="ltx_p" id="S4.SS4.SSS1.p1.1">Table <a class="ltx_ref" href="https://arxiv.org/html/2405.13984v1#S4.T1" title="Table 1 ‣ 4.4.1 Quantitative Analysis on Feedback-Aligned Optimisation Algorithms ‣ 4.4 Results ‣ 4 Experiments ‣ Feedback-aligned Mixed LLMs for Machine Language-Molecule Translation"><span class="ltx_text ltx_ref_tag">1</span></a> presents a summary of the molecule-to-language translation results. We observe a notable decrease in performance for benchmark models trained on extensive data with SFT when evaluated on unseen (out-of-distribution data). Among the baselines, Meditron exhibited the highest performance, likely due to its training on the entire <span class="ltx_text ltx_font_italic" id="S4.SS4.SSS1.p1.1.1">L+M-24</span> dataset used in our experiments. However, training with both DPO and KTO results in failure to translate molecules to language when initialised from agnostic cross-modals, such as those trained from language to molecule translation (<math alttext="\S" class="ltx_Math" display="inline" id="S4.SS4.SSS1.p1.1.m1.1"><semantics id="S4.SS4.SSS1.p1.1.m1.1a"><mi id="S4.SS4.SSS1.p1.1.m1.1.1" mathvariant="normal" xref="S4.SS4.SSS1.p1.1.m1.1.1.cmml">§</mi><annotation-xml encoding="MathML-Content" id="S4.SS4.SSS1.p1.1.m1.1b"><ci id="S4.SS4.SSS1.p1.1.m1.1.1.cmml" xref="S4.SS4.SSS1.p1.1.m1.1.1">§</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS4.SSS1.p1.1.m1.1c">\S</annotation><annotation encoding="application/x-llamapun" id="S4.SS4.SSS1.p1.1.m1.1d">§</annotation></semantics></math> <a class="ltx_ref" href="https://arxiv.org/html/2405.13984v1#S4.SS3" title="4.3 Experimental Setup ‣ 4 Experiments ‣ Feedback-aligned Mixed LLMs for Machine Language-Molecule Translation"><span class="ltx_text ltx_ref_tag">4.3</span></a>). This suggests that these optimisation algorithms rely heavily on the model’s suitability for a specific task. Our SFT demonstrated competitive performance when trained on a 10% subset of <span class="ltx_text ltx_font_italic" id="S4.SS4.SSS1.p1.1.2">L+M-24</span> with a bi-directional LMolT objective, but it underperformed compared to Meditron, trained on the entire dataset, and lacked efficiency (for efficiency details, refer to Appendix <a class="ltx_ref" href="https://arxiv.org/html/2405.13984v1#A7" title="Appendix G Training Efficiency ‣ Feedback-aligned Mixed LLMs for Machine Language-Molecule Translation"><span class="ltx_text ltx_ref_tag">G</span></a>). By contrast, CPO showed the ability to cope in the agnostic cross-modal setting, achieving up to a 20% performance increase compared to Meditron (see Table <a class="ltx_ref" href="https://arxiv.org/html/2405.13984v1#S4.T1" title="Table 1 ‣ 4.4.1 Quantitative Analysis on Feedback-Aligned Optimisation Algorithms ‣ 4.4 Results ‣ 4 Experiments ‣ Feedback-aligned Mixed LLMs for Machine Language-Molecule Translation"><span class="ltx_text ltx_ref_tag">1</span></a>).</p>
</div>
<figure class="ltx_table" id="S4.T1">
<div class="ltx_inline-block ltx_align_center ltx_transformed_outer" id="S4.T1.7" style="width:433.6pt;height:182.6pt;vertical-align:-0.0pt;"><span class="ltx_transformed_inner" style="transform:translate(24.5pt,-10.3pt) scale(1.12717859515228,1.12717859515228) ;">
<table class="ltx_tabular ltx_align_middle" id="S4.T1.7.7">
<tr class="ltx_tr" id="S4.T1.6.6.6">
<td class="ltx_td ltx_align_center ltx_border_tt" id="S4.T1.6.6.6.7"><span class="ltx_text ltx_font_bold" id="S4.T1.6.6.6.7.1">Method</span></td>
<td class="ltx_td ltx_align_center ltx_border_tt" id="S4.T1.1.1.1.1"><math alttext="\textbf{Blue-2}\uparrow" class="ltx_Math" display="inline" id="S4.T1.1.1.1.1.m1.1"><semantics id="S4.T1.1.1.1.1.m1.1a"><mrow id="S4.T1.1.1.1.1.m1.1.1" xref="S4.T1.1.1.1.1.m1.1.1.cmml"><mtext class="ltx_mathvariant_bold" id="S4.T1.1.1.1.1.m1.1.1.2" xref="S4.T1.1.1.1.1.m1.1.1.2a.cmml">Blue-2</mtext><mo id="S4.T1.1.1.1.1.m1.1.1.1" stretchy="false" xref="S4.T1.1.1.1.1.m1.1.1.1.cmml">↑</mo><mi id="S4.T1.1.1.1.1.m1.1.1.3" xref="S4.T1.1.1.1.1.m1.1.1.3.cmml"></mi></mrow><annotation-xml encoding="MathML-Content" id="S4.T1.1.1.1.1.m1.1b"><apply id="S4.T1.1.1.1.1.m1.1.1.cmml" xref="S4.T1.1.1.1.1.m1.1.1"><ci id="S4.T1.1.1.1.1.m1.1.1.1.cmml" xref="S4.T1.1.1.1.1.m1.1.1.1">↑</ci><ci id="S4.T1.1.1.1.1.m1.1.1.2a.cmml" xref="S4.T1.1.1.1.1.m1.1.1.2"><mtext class="ltx_mathvariant_bold" id="S4.T1.1.1.1.1.m1.1.1.2.cmml" xref="S4.T1.1.1.1.1.m1.1.1.2">Blue-2</mtext></ci><csymbol cd="latexml" id="S4.T1.1.1.1.1.m1.1.1.3.cmml" xref="S4.T1.1.1.1.1.m1.1.1.3">absent</csymbol></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.T1.1.1.1.1.m1.1c">\textbf{Blue-2}\uparrow</annotation><annotation encoding="application/x-llamapun" id="S4.T1.1.1.1.1.m1.1d">Blue-2 ↑</annotation></semantics></math></td>
<td class="ltx_td ltx_align_center ltx_border_tt" id="S4.T1.2.2.2.2"><math alttext="\textbf{Blue-4}\uparrow" class="ltx_Math" display="inline" id="S4.T1.2.2.2.2.m1.1"><semantics id="S4.T1.2.2.2.2.m1.1a"><mrow id="S4.T1.2.2.2.2.m1.1.1" xref="S4.T1.2.2.2.2.m1.1.1.cmml"><mtext class="ltx_mathvariant_bold" id="S4.T1.2.2.2.2.m1.1.1.2" xref="S4.T1.2.2.2.2.m1.1.1.2a.cmml">Blue-4</mtext><mo id="S4.T1.2.2.2.2.m1.1.1.1" stretchy="false" xref="S4.T1.2.2.2.2.m1.1.1.1.cmml">↑</mo><mi id="S4.T1.2.2.2.2.m1.1.1.3" xref="S4.T1.2.2.2.2.m1.1.1.3.cmml"></mi></mrow><annotation-xml encoding="MathML-Content" id="S4.T1.2.2.2.2.m1.1b"><apply id="S4.T1.2.2.2.2.m1.1.1.cmml" xref="S4.T1.2.2.2.2.m1.1.1"><ci id="S4.T1.2.2.2.2.m1.1.1.1.cmml" xref="S4.T1.2.2.2.2.m1.1.1.1">↑</ci><ci id="S4.T1.2.2.2.2.m1.1.1.2a.cmml" xref="S4.T1.2.2.2.2.m1.1.1.2"><mtext class="ltx_mathvariant_bold" id="S4.T1.2.2.2.2.m1.1.1.2.cmml" xref="S4.T1.2.2.2.2.m1.1.1.2">Blue-4</mtext></ci><csymbol cd="latexml" id="S4.T1.2.2.2.2.m1.1.1.3.cmml" xref="S4.T1.2.2.2.2.m1.1.1.3">absent</csymbol></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.T1.2.2.2.2.m1.1c">\textbf{Blue-4}\uparrow</annotation><annotation encoding="application/x-llamapun" id="S4.T1.2.2.2.2.m1.1d">Blue-4 ↑</annotation></semantics></math></td>
<td class="ltx_td ltx_align_center ltx_border_tt" id="S4.T1.3.3.3.3"><math alttext="\textbf{Rouge-1}\uparrow" class="ltx_Math" display="inline" id="S4.T1.3.3.3.3.m1.1"><semantics id="S4.T1.3.3.3.3.m1.1a"><mrow id="S4.T1.3.3.3.3.m1.1.1" xref="S4.T1.3.3.3.3.m1.1.1.cmml"><mtext class="ltx_mathvariant_bold" id="S4.T1.3.3.3.3.m1.1.1.2" xref="S4.T1.3.3.3.3.m1.1.1.2a.cmml">Rouge-1</mtext><mo id="S4.T1.3.3.3.3.m1.1.1.1" stretchy="false" xref="S4.T1.3.3.3.3.m1.1.1.1.cmml">↑</mo><mi id="S4.T1.3.3.3.3.m1.1.1.3" xref="S4.T1.3.3.3.3.m1.1.1.3.cmml"></mi></mrow><annotation-xml encoding="MathML-Content" id="S4.T1.3.3.3.3.m1.1b"><apply id="S4.T1.3.3.3.3.m1.1.1.cmml" xref="S4.T1.3.3.3.3.m1.1.1"><ci id="S4.T1.3.3.3.3.m1.1.1.1.cmml" xref="S4.T1.3.3.3.3.m1.1.1.1">↑</ci><ci id="S4.T1.3.3.3.3.m1.1.1.2a.cmml" xref="S4.T1.3.3.3.3.m1.1.1.2"><mtext class="ltx_mathvariant_bold" id="S4.T1.3.3.3.3.m1.1.1.2.cmml" xref="S4.T1.3.3.3.3.m1.1.1.2">Rouge-1</mtext></ci><csymbol cd="latexml" id="S4.T1.3.3.3.3.m1.1.1.3.cmml" xref="S4.T1.3.3.3.3.m1.1.1.3">absent</csymbol></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.T1.3.3.3.3.m1.1c">\textbf{Rouge-1}\uparrow</annotation><annotation encoding="application/x-llamapun" id="S4.T1.3.3.3.3.m1.1d">Rouge-1 ↑</annotation></semantics></math></td>
<td class="ltx_td ltx_align_center ltx_border_tt" id="S4.T1.4.4.4.4"><math alttext="\textbf{Rouge-2}\uparrow" class="ltx_Math" display="inline" id="S4.T1.4.4.4.4.m1.1"><semantics id="S4.T1.4.4.4.4.m1.1a"><mrow id="S4.T1.4.4.4.4.m1.1.1" xref="S4.T1.4.4.4.4.m1.1.1.cmml"><mtext class="ltx_mathvariant_bold" id="S4.T1.4.4.4.4.m1.1.1.2" xref="S4.T1.4.4.4.4.m1.1.1.2a.cmml">Rouge-2</mtext><mo id="S4.T1.4.4.4.4.m1.1.1.1" stretchy="false" xref="S4.T1.4.4.4.4.m1.1.1.1.cmml">↑</mo><mi id="S4.T1.4.4.4.4.m1.1.1.3" xref="S4.T1.4.4.4.4.m1.1.1.3.cmml"></mi></mrow><annotation-xml encoding="MathML-Content" id="S4.T1.4.4.4.4.m1.1b"><apply id="S4.T1.4.4.4.4.m1.1.1.cmml" xref="S4.T1.4.4.4.4.m1.1.1"><ci id="S4.T1.4.4.4.4.m1.1.1.1.cmml" xref="S4.T1.4.4.4.4.m1.1.1.1">↑</ci><ci id="S4.T1.4.4.4.4.m1.1.1.2a.cmml" xref="S4.T1.4.4.4.4.m1.1.1.2"><mtext class="ltx_mathvariant_bold" id="S4.T1.4.4.4.4.m1.1.1.2.cmml" xref="S4.T1.4.4.4.4.m1.1.1.2">Rouge-2</mtext></ci><csymbol cd="latexml" id="S4.T1.4.4.4.4.m1.1.1.3.cmml" xref="S4.T1.4.4.4.4.m1.1.1.3">absent</csymbol></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.T1.4.4.4.4.m1.1c">\textbf{Rouge-2}\uparrow</annotation><annotation encoding="application/x-llamapun" id="S4.T1.4.4.4.4.m1.1d">Rouge-2 ↑</annotation></semantics></math></td>
<td class="ltx_td ltx_align_center ltx_border_tt" id="S4.T1.5.5.5.5"><math alttext="\textbf{Rouge-L}\uparrow" class="ltx_Math" display="inline" id="S4.T1.5.5.5.5.m1.1"><semantics id="S4.T1.5.5.5.5.m1.1a"><mrow id="S4.T1.5.5.5.5.m1.1.1" xref="S4.T1.5.5.5.5.m1.1.1.cmml"><mtext class="ltx_mathvariant_bold" id="S4.T1.5.5.5.5.m1.1.1.2" xref="S4.T1.5.5.5.5.m1.1.1.2a.cmml">Rouge-L</mtext><mo id="S4.T1.5.5.5.5.m1.1.1.1" stretchy="false" xref="S4.T1.5.5.5.5.m1.1.1.1.cmml">↑</mo><mi id="S4.T1.5.5.5.5.m1.1.1.3" xref="S4.T1.5.5.5.5.m1.1.1.3.cmml"></mi></mrow><annotation-xml encoding="MathML-Content" id="S4.T1.5.5.5.5.m1.1b"><apply id="S4.T1.5.5.5.5.m1.1.1.cmml" xref="S4.T1.5.5.5.5.m1.1.1"><ci id="S4.T1.5.5.5.5.m1.1.1.1.cmml" xref="S4.T1.5.5.5.5.m1.1.1.1">↑</ci><ci id="S4.T1.5.5.5.5.m1.1.1.2a.cmml" xref="S4.T1.5.5.5.5.m1.1.1.2"><mtext class="ltx_mathvariant_bold" id="S4.T1.5.5.5.5.m1.1.1.2.cmml" xref="S4.T1.5.5.5.5.m1.1.1.2">Rouge-L</mtext></ci><csymbol cd="latexml" id="S4.T1.5.5.5.5.m1.1.1.3.cmml" xref="S4.T1.5.5.5.5.m1.1.1.3">absent</csymbol></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.T1.5.5.5.5.m1.1c">\textbf{Rouge-L}\uparrow</annotation><annotation encoding="application/x-llamapun" id="S4.T1.5.5.5.5.m1.1d">Rouge-L ↑</annotation></semantics></math></td>
<td class="ltx_td ltx_align_center ltx_border_tt" id="S4.T1.6.6.6.6"><math alttext="\textbf{METEOR}\uparrow" class="ltx_Math" display="inline" id="S4.T1.6.6.6.6.m1.1"><semantics id="S4.T1.6.6.6.6.m1.1a"><mrow id="S4.T1.6.6.6.6.m1.1.1" xref="S4.T1.6.6.6.6.m1.1.1.cmml"><mtext class="ltx_mathvariant_bold" id="S4.T1.6.6.6.6.m1.1.1.2" xref="S4.T1.6.6.6.6.m1.1.1.2a.cmml">METEOR</mtext><mo id="S4.T1.6.6.6.6.m1.1.1.1" stretchy="false" xref="S4.T1.6.6.6.6.m1.1.1.1.cmml">↑</mo><mi id="S4.T1.6.6.6.6.m1.1.1.3" xref="S4.T1.6.6.6.6.m1.1.1.3.cmml"></mi></mrow><annotation-xml encoding="MathML-Content" id="S4.T1.6.6.6.6.m1.1b"><apply id="S4.T1.6.6.6.6.m1.1.1.cmml" xref="S4.T1.6.6.6.6.m1.1.1"><ci id="S4.T1.6.6.6.6.m1.1.1.1.cmml" xref="S4.T1.6.6.6.6.m1.1.1.1">↑</ci><ci id="S4.T1.6.6.6.6.m1.1.1.2a.cmml" xref="S4.T1.6.6.6.6.m1.1.1.2"><mtext class="ltx_mathvariant_bold" id="S4.T1.6.6.6.6.m1.1.1.2.cmml" xref="S4.T1.6.6.6.6.m1.1.1.2">METEOR</mtext></ci><csymbol cd="latexml" id="S4.T1.6.6.6.6.m1.1.1.3.cmml" xref="S4.T1.6.6.6.6.m1.1.1.3">absent</csymbol></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.T1.6.6.6.6.m1.1c">\textbf{METEOR}\uparrow</annotation><annotation encoding="application/x-llamapun" id="S4.T1.6.6.6.6.m1.1d">METEOR ↑</annotation></semantics></math></td>
</tr>
<tr class="ltx_tr" id="S4.T1.7.7.8">
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T1.7.7.8.1">TxtChem-T5</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T1.7.7.8.2">0.08</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T1.7.7.8.3">0.09</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T1.7.7.8.4">0.19</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T1.7.7.8.5">0.06</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T1.7.7.8.6">0.17</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T1.7.7.8.7">0.16</td>
</tr>
<tr class="ltx_tr" id="S4.T1.7.7.9">
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T1.7.7.9.1">Chem-LLM</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T1.7.7.9.2">0.03</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T1.7.7.9.3">0.00</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T1.7.7.9.4">0.11</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T1.7.7.9.5">0.02</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T1.7.7.9.6">0.09</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T1.7.7.9.7">0.14</td>
</tr>
<tr class="ltx_tr" id="S4.T1.7.7.10">
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T1.7.7.10.1">Meditron</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T1.7.7.10.2">0.42</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T1.7.7.10.3">0.30</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T1.7.7.10.4">0.63</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T1.7.7.10.5">0.47</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T1.7.7.10.6"><span class="ltx_text ltx_font_bold" id="S4.T1.7.7.10.6.1">0.49</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T1.7.7.10.7">0.54</td>
</tr>
<tr class="ltx_tr" id="S4.T1.7.7.11">
<td class="ltx_td ltx_align_center ltx_border_tt" id="S4.T1.7.7.11.1">SFT</td>
<td class="ltx_td ltx_align_center ltx_border_tt" id="S4.T1.7.7.11.2">0.37</td>
<td class="ltx_td ltx_align_center ltx_border_tt" id="S4.T1.7.7.11.3">0.26</td>
<td class="ltx_td ltx_align_center ltx_border_tt" id="S4.T1.7.7.11.4">0.55</td>
<td class="ltx_td ltx_align_center ltx_border_tt" id="S4.T1.7.7.11.5">0.40</td>
<td class="ltx_td ltx_align_center ltx_border_tt" id="S4.T1.7.7.11.6">0.39</td>
<td class="ltx_td ltx_align_center ltx_border_tt" id="S4.T1.7.7.11.7">0.61</td>
</tr>
<tr class="ltx_tr" id="S4.T1.7.7.12">
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T1.7.7.12.1">DPO</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T1.7.7.12.2">0.00</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T1.7.7.12.3">0.00</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T1.7.7.12.4">0.00</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T1.7.7.12.5">0.00</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T1.7.7.12.6">0.00</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T1.7.7.12.7">0.00</td>
</tr>
<tr class="ltx_tr" id="S4.T1.7.7.13">
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T1.7.7.13.1"><span class="ltx_text ltx_font_bold" id="S4.T1.7.7.13.1.1">CPO</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T1.7.7.13.2"><span class="ltx_text ltx_font_bold" id="S4.T1.7.7.13.2.1">0.62</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T1.7.7.13.3"><span class="ltx_text ltx_font_bold" id="S4.T1.7.7.13.3.1">0.45</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T1.7.7.13.4"><span class="ltx_text ltx_font_bold" id="S4.T1.7.7.13.4.1">0.68</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T1.7.7.13.5"><span class="ltx_text ltx_font_bold" id="S4.T1.7.7.13.5.1">0.50</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T1.7.7.13.6">0.48</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T1.7.7.13.7"><span class="ltx_text ltx_font_bold" id="S4.T1.7.7.13.7.1">0.62</span></td>
</tr>
<tr class="ltx_tr" id="S4.T1.7.7.14">
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T1.7.7.14.1">KTO</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T1.7.7.14.2">0.00</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T1.7.7.14.3">0.00</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T1.7.7.14.4">0.00</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T1.7.7.14.5">0.00</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T1.7.7.14.6">0.00</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T1.7.7.14.7">0.00</td>
</tr>
<tr class="ltx_tr" id="S4.T1.7.7.7">
<td class="ltx_td ltx_align_center ltx_border_bb ltx_border_tt" id="S4.T1.7.7.7.1"><math alttext="\Delta_{CPO\text{vs}MED}" class="ltx_Math" display="inline" id="S4.T1.7.7.7.1.m1.1"><semantics id="S4.T1.7.7.7.1.m1.1a"><msub id="S4.T1.7.7.7.1.m1.1.1" xref="S4.T1.7.7.7.1.m1.1.1.cmml"><mi id="S4.T1.7.7.7.1.m1.1.1.2" mathvariant="normal" xref="S4.T1.7.7.7.1.m1.1.1.2.cmml">Δ</mi><mrow id="S4.T1.7.7.7.1.m1.1.1.3" xref="S4.T1.7.7.7.1.m1.1.1.3.cmml"><mi id="S4.T1.7.7.7.1.m1.1.1.3.2" xref="S4.T1.7.7.7.1.m1.1.1.3.2.cmml">C</mi><mo id="S4.T1.7.7.7.1.m1.1.1.3.1" xref="S4.T1.7.7.7.1.m1.1.1.3.1.cmml">⁢</mo><mi id="S4.T1.7.7.7.1.m1.1.1.3.3" xref="S4.T1.7.7.7.1.m1.1.1.3.3.cmml">P</mi><mo id="S4.T1.7.7.7.1.m1.1.1.3.1a" xref="S4.T1.7.7.7.1.m1.1.1.3.1.cmml">⁢</mo><mi id="S4.T1.7.7.7.1.m1.1.1.3.4" xref="S4.T1.7.7.7.1.m1.1.1.3.4.cmml">O</mi><mo id="S4.T1.7.7.7.1.m1.1.1.3.1b" xref="S4.T1.7.7.7.1.m1.1.1.3.1.cmml">⁢</mo><mtext id="S4.T1.7.7.7.1.m1.1.1.3.5" xref="S4.T1.7.7.7.1.m1.1.1.3.5a.cmml">vs</mtext><mo id="S4.T1.7.7.7.1.m1.1.1.3.1c" xref="S4.T1.7.7.7.1.m1.1.1.3.1.cmml">⁢</mo><mi id="S4.T1.7.7.7.1.m1.1.1.3.6" xref="S4.T1.7.7.7.1.m1.1.1.3.6.cmml">M</mi><mo id="S4.T1.7.7.7.1.m1.1.1.3.1d" xref="S4.T1.7.7.7.1.m1.1.1.3.1.cmml">⁢</mo><mi id="S4.T1.7.7.7.1.m1.1.1.3.7" xref="S4.T1.7.7.7.1.m1.1.1.3.7.cmml">E</mi><mo id="S4.T1.7.7.7.1.m1.1.1.3.1e" xref="S4.T1.7.7.7.1.m1.1.1.3.1.cmml">⁢</mo><mi id="S4.T1.7.7.7.1.m1.1.1.3.8" xref="S4.T1.7.7.7.1.m1.1.1.3.8.cmml">D</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S4.T1.7.7.7.1.m1.1b"><apply id="S4.T1.7.7.7.1.m1.1.1.cmml" xref="S4.T1.7.7.7.1.m1.1.1"><csymbol cd="ambiguous" id="S4.T1.7.7.7.1.m1.1.1.1.cmml" xref="S4.T1.7.7.7.1.m1.1.1">subscript</csymbol><ci id="S4.T1.7.7.7.1.m1.1.1.2.cmml" xref="S4.T1.7.7.7.1.m1.1.1.2">Δ</ci><apply id="S4.T1.7.7.7.1.m1.1.1.3.cmml" xref="S4.T1.7.7.7.1.m1.1.1.3"><times id="S4.T1.7.7.7.1.m1.1.1.3.1.cmml" xref="S4.T1.7.7.7.1.m1.1.1.3.1"></times><ci id="S4.T1.7.7.7.1.m1.1.1.3.2.cmml" xref="S4.T1.7.7.7.1.m1.1.1.3.2">𝐶</ci><ci id="S4.T1.7.7.7.1.m1.1.1.3.3.cmml" xref="S4.T1.7.7.7.1.m1.1.1.3.3">𝑃</ci><ci id="S4.T1.7.7.7.1.m1.1.1.3.4.cmml" xref="S4.T1.7.7.7.1.m1.1.1.3.4">𝑂</ci><ci id="S4.T1.7.7.7.1.m1.1.1.3.5a.cmml" xref="S4.T1.7.7.7.1.m1.1.1.3.5"><mtext id="S4.T1.7.7.7.1.m1.1.1.3.5.cmml" mathsize="70%" xref="S4.T1.7.7.7.1.m1.1.1.3.5">vs</mtext></ci><ci id="S4.T1.7.7.7.1.m1.1.1.3.6.cmml" xref="S4.T1.7.7.7.1.m1.1.1.3.6">𝑀</ci><ci id="S4.T1.7.7.7.1.m1.1.1.3.7.cmml" xref="S4.T1.7.7.7.1.m1.1.1.3.7">𝐸</ci><ci id="S4.T1.7.7.7.1.m1.1.1.3.8.cmml" xref="S4.T1.7.7.7.1.m1.1.1.3.8">𝐷</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.T1.7.7.7.1.m1.1c">\Delta_{CPO\text{vs}MED}</annotation><annotation encoding="application/x-llamapun" id="S4.T1.7.7.7.1.m1.1d">roman_Δ start_POSTSUBSCRIPT italic_C italic_P italic_O vs italic_M italic_E italic_D end_POSTSUBSCRIPT</annotation></semantics></math></td>
<td class="ltx_td ltx_align_center ltx_border_bb ltx_border_tt" id="S4.T1.7.7.7.2"><span class="ltx_text" id="S4.T1.7.7.7.2.1" style="color:#93C47D;">+20%</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb ltx_border_tt" id="S4.T1.7.7.7.3"><span class="ltx_text" id="S4.T1.7.7.7.3.1" style="color:#93C47D;">+19%</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb ltx_border_tt" id="S4.T1.7.7.7.4"><span class="ltx_text" id="S4.T1.7.7.7.4.1" style="color:#93C47D;">+5%</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb ltx_border_tt" id="S4.T1.7.7.7.5"><span class="ltx_text" id="S4.T1.7.7.7.5.1" style="color:#93C47D;">+3%</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb ltx_border_tt" id="S4.T1.7.7.7.6"><span class="ltx_text" id="S4.T1.7.7.7.6.1" style="color:#E06666;">-1%</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb ltx_border_tt" id="S4.T1.7.7.7.7"><span class="ltx_text" id="S4.T1.7.7.7.7.1" style="color:#93C47D;">+8%</span></td>
</tr>
</table>
</span></div>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table">Table 1: </span>Molecule-to-Language Translation Results on 3k Unseen Pairs. Arrows next to metrics indicate the higher value the better performance. Best results are highlighted in bold. <math alttext="\Delta_{CPO\text{vs}MED}" class="ltx_Math" display="inline" id="S4.T1.9.m1.1"><semantics id="S4.T1.9.m1.1b"><msub id="S4.T1.9.m1.1.1" xref="S4.T1.9.m1.1.1.cmml"><mi id="S4.T1.9.m1.1.1.2" mathvariant="normal" xref="S4.T1.9.m1.1.1.2.cmml">Δ</mi><mrow id="S4.T1.9.m1.1.1.3" xref="S4.T1.9.m1.1.1.3.cmml"><mi id="S4.T1.9.m1.1.1.3.2" xref="S4.T1.9.m1.1.1.3.2.cmml">C</mi><mo id="S4.T1.9.m1.1.1.3.1" xref="S4.T1.9.m1.1.1.3.1.cmml">⁢</mo><mi id="S4.T1.9.m1.1.1.3.3" xref="S4.T1.9.m1.1.1.3.3.cmml">P</mi><mo id="S4.T1.9.m1.1.1.3.1b" xref="S4.T1.9.m1.1.1.3.1.cmml">⁢</mo><mi id="S4.T1.9.m1.1.1.3.4" xref="S4.T1.9.m1.1.1.3.4.cmml">O</mi><mo id="S4.T1.9.m1.1.1.3.1c" xref="S4.T1.9.m1.1.1.3.1.cmml">⁢</mo><mtext id="S4.T1.9.m1.1.1.3.5" xref="S4.T1.9.m1.1.1.3.5a.cmml">vs</mtext><mo id="S4.T1.9.m1.1.1.3.1d" xref="S4.T1.9.m1.1.1.3.1.cmml">⁢</mo><mi id="S4.T1.9.m1.1.1.3.6" xref="S4.T1.9.m1.1.1.3.6.cmml">M</mi><mo id="S4.T1.9.m1.1.1.3.1e" xref="S4.T1.9.m1.1.1.3.1.cmml">⁢</mo><mi id="S4.T1.9.m1.1.1.3.7" xref="S4.T1.9.m1.1.1.3.7.cmml">E</mi><mo id="S4.T1.9.m1.1.1.3.1f" xref="S4.T1.9.m1.1.1.3.1.cmml">⁢</mo><mi id="S4.T1.9.m1.1.1.3.8" xref="S4.T1.9.m1.1.1.3.8.cmml">D</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S4.T1.9.m1.1c"><apply id="S4.T1.9.m1.1.1.cmml" xref="S4.T1.9.m1.1.1"><csymbol cd="ambiguous" id="S4.T1.9.m1.1.1.1.cmml" xref="S4.T1.9.m1.1.1">subscript</csymbol><ci id="S4.T1.9.m1.1.1.2.cmml" xref="S4.T1.9.m1.1.1.2">Δ</ci><apply id="S4.T1.9.m1.1.1.3.cmml" xref="S4.T1.9.m1.1.1.3"><times id="S4.T1.9.m1.1.1.3.1.cmml" xref="S4.T1.9.m1.1.1.3.1"></times><ci id="S4.T1.9.m1.1.1.3.2.cmml" xref="S4.T1.9.m1.1.1.3.2">𝐶</ci><ci id="S4.T1.9.m1.1.1.3.3.cmml" xref="S4.T1.9.m1.1.1.3.3">𝑃</ci><ci id="S4.T1.9.m1.1.1.3.4.cmml" xref="S4.T1.9.m1.1.1.3.4">𝑂</ci><ci id="S4.T1.9.m1.1.1.3.5a.cmml" xref="S4.T1.9.m1.1.1.3.5"><mtext id="S4.T1.9.m1.1.1.3.5.cmml" mathsize="70%" xref="S4.T1.9.m1.1.1.3.5">vs</mtext></ci><ci id="S4.T1.9.m1.1.1.3.6.cmml" xref="S4.T1.9.m1.1.1.3.6">𝑀</ci><ci id="S4.T1.9.m1.1.1.3.7.cmml" xref="S4.T1.9.m1.1.1.3.7">𝐸</ci><ci id="S4.T1.9.m1.1.1.3.8.cmml" xref="S4.T1.9.m1.1.1.3.8">𝐷</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.T1.9.m1.1d">\Delta_{CPO\text{vs}MED}</annotation><annotation encoding="application/x-llamapun" id="S4.T1.9.m1.1e">roman_Δ start_POSTSUBSCRIPT italic_C italic_P italic_O vs italic_M italic_E italic_D end_POSTSUBSCRIPT</annotation></semantics></math> represents the performance gain of our best model compared to Meditron trained on the entire data.</figcaption>
</figure>
<div class="ltx_para" id="S4.SS4.SSS1.p2">
<p class="ltx_p" id="S4.SS4.SSS1.p2.1">Performance gains in language-to-molecule translation were notably higher when cross-modals were known (see Table <a class="ltx_ref" href="https://arxiv.org/html/2405.13984v1#S4.T2" title="Table 2 ‣ 4.4.1 Quantitative Analysis on Feedback-Aligned Optimisation Algorithms ‣ 4.4 Results ‣ 4 Experiments ‣ Feedback-aligned Mixed LLMs for Machine Language-Molecule Translation"><span class="ltx_text ltx_ref_tag">2</span></a>). Both DPO and CPO demonstrated similar performance, achieving an increased accuracy of up to 42% compared to Meditron trained on the entire dataset. Conversely, KTO exhibited low performance even in a known cross-modal setting. We suspect that KTO is sensitive to overfitting (refer to Appendix <a class="ltx_ref" href="https://arxiv.org/html/2405.13984v1#A7" title="Appendix G Training Efficiency ‣ Feedback-aligned Mixed LLMs for Machine Language-Molecule Translation"><span class="ltx_text ltx_ref_tag">G</span></a>).</p>
</div>
<figure class="ltx_table" id="S4.T2">
<div class="ltx_inline-block ltx_align_center ltx_transformed_outer" id="S4.T2.8" style="width:433.6pt;height:145pt;vertical-align:-0.9pt;"><span class="ltx_transformed_inner" style="transform:translate(-26.9pt,8.9pt) scale(0.8897795887348,0.8897795887348) ;">
<table class="ltx_tabular ltx_align_middle" id="S4.T2.8.8">
<tr class="ltx_tr" id="S4.T2.7.7.7">
<td class="ltx_td ltx_align_center ltx_border_tt" id="S4.T2.7.7.7.8"><span class="ltx_text ltx_font_bold" id="S4.T2.7.7.7.8.1">Method</span></td>
<td class="ltx_td ltx_align_center ltx_border_tt" id="S4.T2.1.1.1.1"><math alttext="\textbf{BLEU}\uparrow" class="ltx_Math" display="inline" id="S4.T2.1.1.1.1.m1.1"><semantics id="S4.T2.1.1.1.1.m1.1a"><mrow id="S4.T2.1.1.1.1.m1.1.1" xref="S4.T2.1.1.1.1.m1.1.1.cmml"><mtext class="ltx_mathvariant_bold" id="S4.T2.1.1.1.1.m1.1.1.2" xref="S4.T2.1.1.1.1.m1.1.1.2a.cmml">BLEU</mtext><mo id="S4.T2.1.1.1.1.m1.1.1.1" stretchy="false" xref="S4.T2.1.1.1.1.m1.1.1.1.cmml">↑</mo><mi id="S4.T2.1.1.1.1.m1.1.1.3" xref="S4.T2.1.1.1.1.m1.1.1.3.cmml"></mi></mrow><annotation-xml encoding="MathML-Content" id="S4.T2.1.1.1.1.m1.1b"><apply id="S4.T2.1.1.1.1.m1.1.1.cmml" xref="S4.T2.1.1.1.1.m1.1.1"><ci id="S4.T2.1.1.1.1.m1.1.1.1.cmml" xref="S4.T2.1.1.1.1.m1.1.1.1">↑</ci><ci id="S4.T2.1.1.1.1.m1.1.1.2a.cmml" xref="S4.T2.1.1.1.1.m1.1.1.2"><mtext class="ltx_mathvariant_bold" id="S4.T2.1.1.1.1.m1.1.1.2.cmml" xref="S4.T2.1.1.1.1.m1.1.1.2">BLEU</mtext></ci><csymbol cd="latexml" id="S4.T2.1.1.1.1.m1.1.1.3.cmml" xref="S4.T2.1.1.1.1.m1.1.1.3">absent</csymbol></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.T2.1.1.1.1.m1.1c">\textbf{BLEU}\uparrow</annotation><annotation encoding="application/x-llamapun" id="S4.T2.1.1.1.1.m1.1d">BLEU ↑</annotation></semantics></math></td>
<td class="ltx_td ltx_align_center ltx_border_tt" id="S4.T2.2.2.2.2"><math alttext="\textbf{Levenshtein}\downarrow" class="ltx_Math" display="inline" id="S4.T2.2.2.2.2.m1.1"><semantics id="S4.T2.2.2.2.2.m1.1a"><mrow id="S4.T2.2.2.2.2.m1.1.1" xref="S4.T2.2.2.2.2.m1.1.1.cmml"><mtext class="ltx_mathvariant_bold" id="S4.T2.2.2.2.2.m1.1.1.2" xref="S4.T2.2.2.2.2.m1.1.1.2a.cmml">Levenshtein</mtext><mo id="S4.T2.2.2.2.2.m1.1.1.1" stretchy="false" xref="S4.T2.2.2.2.2.m1.1.1.1.cmml">↓</mo><mi id="S4.T2.2.2.2.2.m1.1.1.3" xref="S4.T2.2.2.2.2.m1.1.1.3.cmml"></mi></mrow><annotation-xml encoding="MathML-Content" id="S4.T2.2.2.2.2.m1.1b"><apply id="S4.T2.2.2.2.2.m1.1.1.cmml" xref="S4.T2.2.2.2.2.m1.1.1"><ci id="S4.T2.2.2.2.2.m1.1.1.1.cmml" xref="S4.T2.2.2.2.2.m1.1.1.1">↓</ci><ci id="S4.T2.2.2.2.2.m1.1.1.2a.cmml" xref="S4.T2.2.2.2.2.m1.1.1.2"><mtext class="ltx_mathvariant_bold" id="S4.T2.2.2.2.2.m1.1.1.2.cmml" xref="S4.T2.2.2.2.2.m1.1.1.2">Levenshtein</mtext></ci><csymbol cd="latexml" id="S4.T2.2.2.2.2.m1.1.1.3.cmml" xref="S4.T2.2.2.2.2.m1.1.1.3">absent</csymbol></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.T2.2.2.2.2.m1.1c">\textbf{Levenshtein}\downarrow</annotation><annotation encoding="application/x-llamapun" id="S4.T2.2.2.2.2.m1.1d">Levenshtein ↓</annotation></semantics></math></td>
<td class="ltx_td ltx_align_center ltx_border_tt" id="S4.T2.3.3.3.3"><math alttext="\textbf{MACCS FTS}\uparrow" class="ltx_Math" display="inline" id="S4.T2.3.3.3.3.m1.1"><semantics id="S4.T2.3.3.3.3.m1.1a"><mrow id="S4.T2.3.3.3.3.m1.1.1" xref="S4.T2.3.3.3.3.m1.1.1.cmml"><mtext class="ltx_mathvariant_bold" id="S4.T2.3.3.3.3.m1.1.1.2" xref="S4.T2.3.3.3.3.m1.1.1.2a.cmml">MACCS FTS</mtext><mo id="S4.T2.3.3.3.3.m1.1.1.1" stretchy="false" xref="S4.T2.3.3.3.3.m1.1.1.1.cmml">↑</mo><mi id="S4.T2.3.3.3.3.m1.1.1.3" xref="S4.T2.3.3.3.3.m1.1.1.3.cmml"></mi></mrow><annotation-xml encoding="MathML-Content" id="S4.T2.3.3.3.3.m1.1b"><apply id="S4.T2.3.3.3.3.m1.1.1.cmml" xref="S4.T2.3.3.3.3.m1.1.1"><ci id="S4.T2.3.3.3.3.m1.1.1.1.cmml" xref="S4.T2.3.3.3.3.m1.1.1.1">↑</ci><ci id="S4.T2.3.3.3.3.m1.1.1.2a.cmml" xref="S4.T2.3.3.3.3.m1.1.1.2"><mtext class="ltx_mathvariant_bold" id="S4.T2.3.3.3.3.m1.1.1.2.cmml" xref="S4.T2.3.3.3.3.m1.1.1.2">MACCS FTS</mtext></ci><csymbol cd="latexml" id="S4.T2.3.3.3.3.m1.1.1.3.cmml" xref="S4.T2.3.3.3.3.m1.1.1.3">absent</csymbol></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.T2.3.3.3.3.m1.1c">\textbf{MACCS FTS}\uparrow</annotation><annotation encoding="application/x-llamapun" id="S4.T2.3.3.3.3.m1.1d">MACCS FTS ↑</annotation></semantics></math></td>
<td class="ltx_td ltx_align_center ltx_border_tt" id="S4.T2.4.4.4.4"><math alttext="\textbf{RDK FTS}\uparrow" class="ltx_Math" display="inline" id="S4.T2.4.4.4.4.m1.1"><semantics id="S4.T2.4.4.4.4.m1.1a"><mrow id="S4.T2.4.4.4.4.m1.1.1" xref="S4.T2.4.4.4.4.m1.1.1.cmml"><mtext class="ltx_mathvariant_bold" id="S4.T2.4.4.4.4.m1.1.1.2" xref="S4.T2.4.4.4.4.m1.1.1.2a.cmml">RDK FTS</mtext><mo id="S4.T2.4.4.4.4.m1.1.1.1" stretchy="false" xref="S4.T2.4.4.4.4.m1.1.1.1.cmml">↑</mo><mi id="S4.T2.4.4.4.4.m1.1.1.3" xref="S4.T2.4.4.4.4.m1.1.1.3.cmml"></mi></mrow><annotation-xml encoding="MathML-Content" id="S4.T2.4.4.4.4.m1.1b"><apply id="S4.T2.4.4.4.4.m1.1.1.cmml" xref="S4.T2.4.4.4.4.m1.1.1"><ci id="S4.T2.4.4.4.4.m1.1.1.1.cmml" xref="S4.T2.4.4.4.4.m1.1.1.1">↑</ci><ci id="S4.T2.4.4.4.4.m1.1.1.2a.cmml" xref="S4.T2.4.4.4.4.m1.1.1.2"><mtext class="ltx_mathvariant_bold" id="S4.T2.4.4.4.4.m1.1.1.2.cmml" xref="S4.T2.4.4.4.4.m1.1.1.2">RDK FTS</mtext></ci><csymbol cd="latexml" id="S4.T2.4.4.4.4.m1.1.1.3.cmml" xref="S4.T2.4.4.4.4.m1.1.1.3">absent</csymbol></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.T2.4.4.4.4.m1.1c">\textbf{RDK FTS}\uparrow</annotation><annotation encoding="application/x-llamapun" id="S4.T2.4.4.4.4.m1.1d">RDK FTS ↑</annotation></semantics></math></td>
<td class="ltx_td ltx_align_center ltx_border_tt" id="S4.T2.5.5.5.5"><math alttext="\textbf{Morgan FTS}\uparrow" class="ltx_Math" display="inline" id="S4.T2.5.5.5.5.m1.1"><semantics id="S4.T2.5.5.5.5.m1.1a"><mrow id="S4.T2.5.5.5.5.m1.1.1" xref="S4.T2.5.5.5.5.m1.1.1.cmml"><mtext class="ltx_mathvariant_bold" id="S4.T2.5.5.5.5.m1.1.1.2" xref="S4.T2.5.5.5.5.m1.1.1.2a.cmml">Morgan FTS</mtext><mo id="S4.T2.5.5.5.5.m1.1.1.1" stretchy="false" xref="S4.T2.5.5.5.5.m1.1.1.1.cmml">↑</mo><mi id="S4.T2.5.5.5.5.m1.1.1.3" xref="S4.T2.5.5.5.5.m1.1.1.3.cmml"></mi></mrow><annotation-xml encoding="MathML-Content" id="S4.T2.5.5.5.5.m1.1b"><apply id="S4.T2.5.5.5.5.m1.1.1.cmml" xref="S4.T2.5.5.5.5.m1.1.1"><ci id="S4.T2.5.5.5.5.m1.1.1.1.cmml" xref="S4.T2.5.5.5.5.m1.1.1.1">↑</ci><ci id="S4.T2.5.5.5.5.m1.1.1.2a.cmml" xref="S4.T2.5.5.5.5.m1.1.1.2"><mtext class="ltx_mathvariant_bold" id="S4.T2.5.5.5.5.m1.1.1.2.cmml" xref="S4.T2.5.5.5.5.m1.1.1.2">Morgan FTS</mtext></ci><csymbol cd="latexml" id="S4.T2.5.5.5.5.m1.1.1.3.cmml" xref="S4.T2.5.5.5.5.m1.1.1.3">absent</csymbol></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.T2.5.5.5.5.m1.1c">\textbf{Morgan FTS}\uparrow</annotation><annotation encoding="application/x-llamapun" id="S4.T2.5.5.5.5.m1.1d">Morgan FTS ↑</annotation></semantics></math></td>
<td class="ltx_td ltx_align_center ltx_border_tt" id="S4.T2.6.6.6.6"><math alttext="\textbf{FCD}\downarrow" class="ltx_Math" display="inline" id="S4.T2.6.6.6.6.m1.1"><semantics id="S4.T2.6.6.6.6.m1.1a"><mrow id="S4.T2.6.6.6.6.m1.1.1" xref="S4.T2.6.6.6.6.m1.1.1.cmml"><mtext class="ltx_mathvariant_bold" id="S4.T2.6.6.6.6.m1.1.1.2" xref="S4.T2.6.6.6.6.m1.1.1.2a.cmml">FCD</mtext><mo id="S4.T2.6.6.6.6.m1.1.1.1" stretchy="false" xref="S4.T2.6.6.6.6.m1.1.1.1.cmml">↓</mo><mi id="S4.T2.6.6.6.6.m1.1.1.3" xref="S4.T2.6.6.6.6.m1.1.1.3.cmml"></mi></mrow><annotation-xml encoding="MathML-Content" id="S4.T2.6.6.6.6.m1.1b"><apply id="S4.T2.6.6.6.6.m1.1.1.cmml" xref="S4.T2.6.6.6.6.m1.1.1"><ci id="S4.T2.6.6.6.6.m1.1.1.1.cmml" xref="S4.T2.6.6.6.6.m1.1.1.1">↓</ci><ci id="S4.T2.6.6.6.6.m1.1.1.2a.cmml" xref="S4.T2.6.6.6.6.m1.1.1.2"><mtext class="ltx_mathvariant_bold" id="S4.T2.6.6.6.6.m1.1.1.2.cmml" xref="S4.T2.6.6.6.6.m1.1.1.2">FCD</mtext></ci><csymbol cd="latexml" id="S4.T2.6.6.6.6.m1.1.1.3.cmml" xref="S4.T2.6.6.6.6.m1.1.1.3">absent</csymbol></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.T2.6.6.6.6.m1.1c">\textbf{FCD}\downarrow</annotation><annotation encoding="application/x-llamapun" id="S4.T2.6.6.6.6.m1.1d">FCD ↓</annotation></semantics></math></td>
<td class="ltx_td ltx_align_center ltx_border_tt" id="S4.T2.7.7.7.7"><math alttext="\textbf{Validity}\uparrow" class="ltx_Math" display="inline" id="S4.T2.7.7.7.7.m1.1"><semantics id="S4.T2.7.7.7.7.m1.1a"><mrow id="S4.T2.7.7.7.7.m1.1.1" xref="S4.T2.7.7.7.7.m1.1.1.cmml"><mtext class="ltx_mathvariant_bold" id="S4.T2.7.7.7.7.m1.1.1.2" xref="S4.T2.7.7.7.7.m1.1.1.2a.cmml">Validity</mtext><mo id="S4.T2.7.7.7.7.m1.1.1.1" stretchy="false" xref="S4.T2.7.7.7.7.m1.1.1.1.cmml">↑</mo><mi id="S4.T2.7.7.7.7.m1.1.1.3" xref="S4.T2.7.7.7.7.m1.1.1.3.cmml"></mi></mrow><annotation-xml encoding="MathML-Content" id="S4.T2.7.7.7.7.m1.1b"><apply id="S4.T2.7.7.7.7.m1.1.1.cmml" xref="S4.T2.7.7.7.7.m1.1.1"><ci id="S4.T2.7.7.7.7.m1.1.1.1.cmml" xref="S4.T2.7.7.7.7.m1.1.1.1">↑</ci><ci id="S4.T2.7.7.7.7.m1.1.1.2a.cmml" xref="S4.T2.7.7.7.7.m1.1.1.2"><mtext class="ltx_mathvariant_bold" id="S4.T2.7.7.7.7.m1.1.1.2.cmml" xref="S4.T2.7.7.7.7.m1.1.1.2">Validity</mtext></ci><csymbol cd="latexml" id="S4.T2.7.7.7.7.m1.1.1.3.cmml" xref="S4.T2.7.7.7.7.m1.1.1.3">absent</csymbol></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.T2.7.7.7.7.m1.1c">\textbf{Validity}\uparrow</annotation><annotation encoding="application/x-llamapun" id="S4.T2.7.7.7.7.m1.1d">Validity ↑</annotation></semantics></math></td>
</tr>
<tr class="ltx_tr" id="S4.T2.8.8.9">
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T2.8.8.9.1">TxtChem-T5</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T2.8.8.9.2">0.18</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T2.8.8.9.3">133.29</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T2.8.8.9.4">0.21</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T2.8.8.9.5">0.10</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T2.8.8.9.6">0.03</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T2.8.8.9.7">37.67</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T2.8.8.9.8">0.58</td>
</tr>
<tr class="ltx_tr" id="S4.T2.8.8.10">
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T2.8.8.10.1">Chem-LLM</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T2.8.8.10.2">0.04</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T2.8.8.10.3">732.74</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T2.8.8.10.4">0.00</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T2.8.8.10.5">0.00</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T2.8.8.10.6">0.00</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T2.8.8.10.7">59.44</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T2.8.8.10.8">0.19</td>
</tr>
<tr class="ltx_tr" id="S4.T2.8.8.11">
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T2.8.8.11.1">Meditron</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T2.8.8.11.2">0.43</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T2.8.8.11.3">66.16</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T2.8.8.11.4">0.35</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T2.8.8.11.5">0.29</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T2.8.8.11.6">0.19</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T2.8.8.11.7">13.64</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T2.8.8.11.8">0.57</td>
</tr>
<tr class="ltx_tr" id="S4.T2.8.8.12">
<td class="ltx_td ltx_align_center ltx_border_tt" id="S4.T2.8.8.12.1">SFT</td>
<td class="ltx_td ltx_align_center ltx_border_tt" id="S4.T2.8.8.12.2">0.30</td>
<td class="ltx_td ltx_align_center ltx_border_tt" id="S4.T2.8.8.12.3">186.99</td>
<td class="ltx_td ltx_align_center ltx_border_tt" id="S4.T2.8.8.12.4">0.70</td>
<td class="ltx_td ltx_align_center ltx_border_tt" id="S4.T2.8.8.12.5">0.62</td>
<td class="ltx_td ltx_align_center ltx_border_tt" id="S4.T2.8.8.12.6">0.41</td>
<td class="ltx_td ltx_align_center ltx_border_tt" id="S4.T2.8.8.12.7">11.14</td>
<td class="ltx_td ltx_align_center ltx_border_tt" id="S4.T2.8.8.12.8">0.98</td>
</tr>
<tr class="ltx_tr" id="S4.T2.8.8.13">
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T2.8.8.13.1"><span class="ltx_text ltx_font_bold" id="S4.T2.8.8.13.1.1">DPO</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T2.8.8.13.2"><span class="ltx_text ltx_font_bold" id="S4.T2.8.8.13.2.1">0.72</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T2.8.8.13.3"><span class="ltx_text ltx_font_bold" id="S4.T2.8.8.13.3.1">42.40</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T2.8.8.13.4"><span class="ltx_text ltx_font_bold" id="S4.T2.8.8.13.4.1">0.77</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T2.8.8.13.5">0.69</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T2.8.8.13.6"><span class="ltx_text ltx_font_bold" id="S4.T2.8.8.13.6.1">0.49</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T2.8.8.13.7">10.47</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T2.8.8.13.8">0.99</td>
</tr>
<tr class="ltx_tr" id="S4.T2.8.8.14">
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T2.8.8.14.1"><span class="ltx_text ltx_font_bold" id="S4.T2.8.8.14.1.1">CPO</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T2.8.8.14.2">0.71</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T2.8.8.14.3">42.65</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T2.8.8.14.4"><span class="ltx_text ltx_font_bold" id="S4.T2.8.8.14.4.1">0.77</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T2.8.8.14.5"><span class="ltx_text ltx_font_bold" id="S4.T2.8.8.14.5.1">0.70</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T2.8.8.14.6">0.48</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T2.8.8.14.7"><span class="ltx_text ltx_font_bold" id="S4.T2.8.8.14.7.1">4.19</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T2.8.8.14.8"><span class="ltx_text ltx_font_bold" id="S4.T2.8.8.14.8.1">1.00</span></td>
</tr>
<tr class="ltx_tr" id="S4.T2.8.8.15">
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T2.8.8.15.1">KTO</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T2.8.8.15.2">0.23</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T2.8.8.15.3">294.63</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T2.8.8.15.4">0.03</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T2.8.8.15.5">0.03</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T2.8.8.15.6">0.02</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T2.8.8.15.7">32.64</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T2.8.8.15.8">0.06</td>
</tr>
<tr class="ltx_tr" id="S4.T2.8.8.8">
<td class="ltx_td ltx_align_center ltx_border_bb ltx_border_tt" id="S4.T2.8.8.8.1"><math alttext="\Delta_{CPO\text{vs}MED}" class="ltx_Math" display="inline" id="S4.T2.8.8.8.1.m1.1"><semantics id="S4.T2.8.8.8.1.m1.1a"><msub id="S4.T2.8.8.8.1.m1.1.1" xref="S4.T2.8.8.8.1.m1.1.1.cmml"><mi id="S4.T2.8.8.8.1.m1.1.1.2" mathvariant="normal" xref="S4.T2.8.8.8.1.m1.1.1.2.cmml">Δ</mi><mrow id="S4.T2.8.8.8.1.m1.1.1.3" xref="S4.T2.8.8.8.1.m1.1.1.3.cmml"><mi id="S4.T2.8.8.8.1.m1.1.1.3.2" xref="S4.T2.8.8.8.1.m1.1.1.3.2.cmml">C</mi><mo id="S4.T2.8.8.8.1.m1.1.1.3.1" xref="S4.T2.8.8.8.1.m1.1.1.3.1.cmml">⁢</mo><mi id="S4.T2.8.8.8.1.m1.1.1.3.3" xref="S4.T2.8.8.8.1.m1.1.1.3.3.cmml">P</mi><mo id="S4.T2.8.8.8.1.m1.1.1.3.1a" xref="S4.T2.8.8.8.1.m1.1.1.3.1.cmml">⁢</mo><mi id="S4.T2.8.8.8.1.m1.1.1.3.4" xref="S4.T2.8.8.8.1.m1.1.1.3.4.cmml">O</mi><mo id="S4.T2.8.8.8.1.m1.1.1.3.1b" xref="S4.T2.8.8.8.1.m1.1.1.3.1.cmml">⁢</mo><mtext id="S4.T2.8.8.8.1.m1.1.1.3.5" xref="S4.T2.8.8.8.1.m1.1.1.3.5a.cmml">vs</mtext><mo id="S4.T2.8.8.8.1.m1.1.1.3.1c" xref="S4.T2.8.8.8.1.m1.1.1.3.1.cmml">⁢</mo><mi id="S4.T2.8.8.8.1.m1.1.1.3.6" xref="S4.T2.8.8.8.1.m1.1.1.3.6.cmml">M</mi><mo id="S4.T2.8.8.8.1.m1.1.1.3.1d" xref="S4.T2.8.8.8.1.m1.1.1.3.1.cmml">⁢</mo><mi id="S4.T2.8.8.8.1.m1.1.1.3.7" xref="S4.T2.8.8.8.1.m1.1.1.3.7.cmml">E</mi><mo id="S4.T2.8.8.8.1.m1.1.1.3.1e" xref="S4.T2.8.8.8.1.m1.1.1.3.1.cmml">⁢</mo><mi id="S4.T2.8.8.8.1.m1.1.1.3.8" xref="S4.T2.8.8.8.1.m1.1.1.3.8.cmml">D</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S4.T2.8.8.8.1.m1.1b"><apply id="S4.T2.8.8.8.1.m1.1.1.cmml" xref="S4.T2.8.8.8.1.m1.1.1"><csymbol cd="ambiguous" id="S4.T2.8.8.8.1.m1.1.1.1.cmml" xref="S4.T2.8.8.8.1.m1.1.1">subscript</csymbol><ci id="S4.T2.8.8.8.1.m1.1.1.2.cmml" xref="S4.T2.8.8.8.1.m1.1.1.2">Δ</ci><apply id="S4.T2.8.8.8.1.m1.1.1.3.cmml" xref="S4.T2.8.8.8.1.m1.1.1.3"><times id="S4.T2.8.8.8.1.m1.1.1.3.1.cmml" xref="S4.T2.8.8.8.1.m1.1.1.3.1"></times><ci id="S4.T2.8.8.8.1.m1.1.1.3.2.cmml" xref="S4.T2.8.8.8.1.m1.1.1.3.2">𝐶</ci><ci id="S4.T2.8.8.8.1.m1.1.1.3.3.cmml" xref="S4.T2.8.8.8.1.m1.1.1.3.3">𝑃</ci><ci id="S4.T2.8.8.8.1.m1.1.1.3.4.cmml" xref="S4.T2.8.8.8.1.m1.1.1.3.4">𝑂</ci><ci id="S4.T2.8.8.8.1.m1.1.1.3.5a.cmml" xref="S4.T2.8.8.8.1.m1.1.1.3.5"><mtext id="S4.T2.8.8.8.1.m1.1.1.3.5.cmml" mathsize="70%" xref="S4.T2.8.8.8.1.m1.1.1.3.5">vs</mtext></ci><ci id="S4.T2.8.8.8.1.m1.1.1.3.6.cmml" xref="S4.T2.8.8.8.1.m1.1.1.3.6">𝑀</ci><ci id="S4.T2.8.8.8.1.m1.1.1.3.7.cmml" xref="S4.T2.8.8.8.1.m1.1.1.3.7">𝐸</ci><ci id="S4.T2.8.8.8.1.m1.1.1.3.8.cmml" xref="S4.T2.8.8.8.1.m1.1.1.3.8">𝐷</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.T2.8.8.8.1.m1.1c">\Delta_{CPO\text{vs}MED}</annotation><annotation encoding="application/x-llamapun" id="S4.T2.8.8.8.1.m1.1d">roman_Δ start_POSTSUBSCRIPT italic_C italic_P italic_O vs italic_M italic_E italic_D end_POSTSUBSCRIPT</annotation></semantics></math></td>
<td class="ltx_td ltx_align_center ltx_border_bb ltx_border_tt" id="S4.T2.8.8.8.2"><span class="ltx_text" id="S4.T2.8.8.8.2.1" style="color:#93C47D;">+29%</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb ltx_border_tt" id="S4.T2.8.8.8.3"><span class="ltx_text" id="S4.T2.8.8.8.3.1" style="color:#93C47D;">-23.76%</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb ltx_border_tt" id="S4.T2.8.8.8.4"><span class="ltx_text" id="S4.T2.8.8.8.4.1" style="color:#93C47D;">+42%</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb ltx_border_tt" id="S4.T2.8.8.8.5"><span class="ltx_text" id="S4.T2.8.8.8.5.1" style="color:#93C47D;">+41%</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb ltx_border_tt" id="S4.T2.8.8.8.6"><span class="ltx_text" id="S4.T2.8.8.8.6.1" style="color:#93C47D;">+30%</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb ltx_border_tt" id="S4.T2.8.8.8.7"><span class="ltx_text" id="S4.T2.8.8.8.7.1" style="color:#93C47D;">-9.45%</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb ltx_border_tt" id="S4.T2.8.8.8.8"><span class="ltx_text" id="S4.T2.8.8.8.8.1" style="color:#93C47D;">+41%</span></td>
</tr>
</table>
</span></div>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table">Table 2: </span>Language-to-Molecule Translation Results on 3k Unseen Pairs. Arrows next to metrics indicate whether higher or lower values denote better performance. Best results are highlighted in bold. <math alttext="\Delta_{CPO\text{vs}MED}" class="ltx_Math" display="inline" id="S4.T2.10.m1.1"><semantics id="S4.T2.10.m1.1b"><msub id="S4.T2.10.m1.1.1" xref="S4.T2.10.m1.1.1.cmml"><mi id="S4.T2.10.m1.1.1.2" mathvariant="normal" xref="S4.T2.10.m1.1.1.2.cmml">Δ</mi><mrow id="S4.T2.10.m1.1.1.3" xref="S4.T2.10.m1.1.1.3.cmml"><mi id="S4.T2.10.m1.1.1.3.2" xref="S4.T2.10.m1.1.1.3.2.cmml">C</mi><mo id="S4.T2.10.m1.1.1.3.1" xref="S4.T2.10.m1.1.1.3.1.cmml">⁢</mo><mi id="S4.T2.10.m1.1.1.3.3" xref="S4.T2.10.m1.1.1.3.3.cmml">P</mi><mo id="S4.T2.10.m1.1.1.3.1b" xref="S4.T2.10.m1.1.1.3.1.cmml">⁢</mo><mi id="S4.T2.10.m1.1.1.3.4" xref="S4.T2.10.m1.1.1.3.4.cmml">O</mi><mo id="S4.T2.10.m1.1.1.3.1c" xref="S4.T2.10.m1.1.1.3.1.cmml">⁢</mo><mtext id="S4.T2.10.m1.1.1.3.5" xref="S4.T2.10.m1.1.1.3.5a.cmml">vs</mtext><mo id="S4.T2.10.m1.1.1.3.1d" xref="S4.T2.10.m1.1.1.3.1.cmml">⁢</mo><mi id="S4.T2.10.m1.1.1.3.6" xref="S4.T2.10.m1.1.1.3.6.cmml">M</mi><mo id="S4.T2.10.m1.1.1.3.1e" xref="S4.T2.10.m1.1.1.3.1.cmml">⁢</mo><mi id="S4.T2.10.m1.1.1.3.7" xref="S4.T2.10.m1.1.1.3.7.cmml">E</mi><mo id="S4.T2.10.m1.1.1.3.1f" xref="S4.T2.10.m1.1.1.3.1.cmml">⁢</mo><mi id="S4.T2.10.m1.1.1.3.8" xref="S4.T2.10.m1.1.1.3.8.cmml">D</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S4.T2.10.m1.1c"><apply id="S4.T2.10.m1.1.1.cmml" xref="S4.T2.10.m1.1.1"><csymbol cd="ambiguous" id="S4.T2.10.m1.1.1.1.cmml" xref="S4.T2.10.m1.1.1">subscript</csymbol><ci id="S4.T2.10.m1.1.1.2.cmml" xref="S4.T2.10.m1.1.1.2">Δ</ci><apply id="S4.T2.10.m1.1.1.3.cmml" xref="S4.T2.10.m1.1.1.3"><times id="S4.T2.10.m1.1.1.3.1.cmml" xref="S4.T2.10.m1.1.1.3.1"></times><ci id="S4.T2.10.m1.1.1.3.2.cmml" xref="S4.T2.10.m1.1.1.3.2">𝐶</ci><ci id="S4.T2.10.m1.1.1.3.3.cmml" xref="S4.T2.10.m1.1.1.3.3">𝑃</ci><ci id="S4.T2.10.m1.1.1.3.4.cmml" xref="S4.T2.10.m1.1.1.3.4">𝑂</ci><ci id="S4.T2.10.m1.1.1.3.5a.cmml" xref="S4.T2.10.m1.1.1.3.5"><mtext id="S4.T2.10.m1.1.1.3.5.cmml" mathsize="70%" xref="S4.T2.10.m1.1.1.3.5">vs</mtext></ci><ci id="S4.T2.10.m1.1.1.3.6.cmml" xref="S4.T2.10.m1.1.1.3.6">𝑀</ci><ci id="S4.T2.10.m1.1.1.3.7.cmml" xref="S4.T2.10.m1.1.1.3.7">𝐸</ci><ci id="S4.T2.10.m1.1.1.3.8.cmml" xref="S4.T2.10.m1.1.1.3.8">𝐷</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.T2.10.m1.1d">\Delta_{CPO\text{vs}MED}</annotation><annotation encoding="application/x-llamapun" id="S4.T2.10.m1.1e">roman_Δ start_POSTSUBSCRIPT italic_C italic_P italic_O vs italic_M italic_E italic_D end_POSTSUBSCRIPT</annotation></semantics></math> represents the performance gain of our best models compared to Meditron.</figcaption>
</figure>
<div class="ltx_para" id="S4.SS4.SSS1.p3">
<p class="ltx_p" id="S4.SS4.SSS1.p3.1">In summary, our experiments revealed that CPO operates independently of cross-modal considerations, whereas DPO cannot cope with an agnostic cross-modal setting. Contrary, KTO displayed signs of overfitting even in a known cross-modal setting. In the following section, we explore fusion approaches aimed at enhancing the capabilities of these algorithms within the cross-modal context.</p>
</div>
</section>
<section class="ltx_subsubsection" id="S4.SS4.SSS2">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">4.4.2 </span>Quantitative Analysis on Mixed Cross-Modals Fusion</h4>
<div class="ltx_para" id="S4.SS4.SSS2.p1">
<p class="ltx_p" id="S4.SS4.SSS2.p1.6">Her we focus on the most effective optimisation algorithms, DPO and CPO (<math alttext="\S" class="ltx_Math" display="inline" id="S4.SS4.SSS2.p1.1.m1.1"><semantics id="S4.SS4.SSS2.p1.1.m1.1a"><mi id="S4.SS4.SSS2.p1.1.m1.1.1" mathvariant="normal" xref="S4.SS4.SSS2.p1.1.m1.1.1.cmml">§</mi><annotation-xml encoding="MathML-Content" id="S4.SS4.SSS2.p1.1.m1.1b"><ci id="S4.SS4.SSS2.p1.1.m1.1.1.cmml" xref="S4.SS4.SSS2.p1.1.m1.1.1">§</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS4.SSS2.p1.1.m1.1c">\S</annotation><annotation encoding="application/x-llamapun" id="S4.SS4.SSS2.p1.1.m1.1d">§</annotation></semantics></math>  <a class="ltx_ref" href="https://arxiv.org/html/2405.13984v1#S4.SS4.SSS1" title="4.4.1 Quantitative Analysis on Feedback-Aligned Optimisation Algorithms ‣ 4.4 Results ‣ 4 Experiments ‣ Feedback-aligned Mixed LLMs for Machine Language-Molecule Translation"><span class="ltx_text ltx_ref_tag">4.4.1</span></a>), and investigate TIES and SLERP (<math alttext="\S" class="ltx_Math" display="inline" id="S4.SS4.SSS2.p1.2.m2.1"><semantics id="S4.SS4.SSS2.p1.2.m2.1a"><mi id="S4.SS4.SSS2.p1.2.m2.1.1" mathvariant="normal" xref="S4.SS4.SSS2.p1.2.m2.1.1.cmml">§</mi><annotation-xml encoding="MathML-Content" id="S4.SS4.SSS2.p1.2.m2.1b"><ci id="S4.SS4.SSS2.p1.2.m2.1.1.cmml" xref="S4.SS4.SSS2.p1.2.m2.1.1">§</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS4.SSS2.p1.2.m2.1c">\S</annotation><annotation encoding="application/x-llamapun" id="S4.SS4.SSS2.p1.2.m2.1d">§</annotation></semantics></math> <a class="ltx_ref" href="https://arxiv.org/html/2405.13984v1#S3.SS3" title="3.3 Mixed Cross-Modals Fusion ‣ 3 Methodology ‣ Feedback-aligned Mixed LLMs for Machine Language-Molecule Translation"><span class="ltx_text ltx_ref_tag">3.3</span></a>) fusion algorithms in the cross-modal context. We thus aim to address disparities between language and molecule modalities and enhance optimisation algorithm performance. Tables <a class="ltx_ref" href="https://arxiv.org/html/2405.13984v1#S4.T3" title="Table 3 ‣ 4.4.2 Quantitative Analysis on Mixed Cross-Modals Fusion ‣ 4.4 Results ‣ 4 Experiments ‣ Feedback-aligned Mixed LLMs for Machine Language-Molecule Translation"><span class="ltx_text ltx_ref_tag">3</span></a> and <a class="ltx_ref" href="https://arxiv.org/html/2405.13984v1#S4.T4" title="Table 4 ‣ 4.4.2 Quantitative Analysis on Mixed Cross-Modals Fusion ‣ 4.4 Results ‣ 4 Experiments ‣ Feedback-aligned Mixed LLMs for Machine Language-Molecule Translation"><span class="ltx_text ltx_ref_tag">4</span></a> provide an overview of the mixed cross-modal fusion results for LMolT, maintaining consistent training data. Combining DPO with mixed cross-modals via TIES shows promising enhancements in molecule-to-language translation (see <math alttext="\Delta_{DPO\text{vs}TIES+DPO}" class="ltx_Math" display="inline" id="S4.SS4.SSS2.p1.3.m3.1"><semantics id="S4.SS4.SSS2.p1.3.m3.1a"><msub id="S4.SS4.SSS2.p1.3.m3.1.1" xref="S4.SS4.SSS2.p1.3.m3.1.1.cmml"><mi id="S4.SS4.SSS2.p1.3.m3.1.1.2" mathvariant="normal" xref="S4.SS4.SSS2.p1.3.m3.1.1.2.cmml">Δ</mi><mrow id="S4.SS4.SSS2.p1.3.m3.1.1.3" xref="S4.SS4.SSS2.p1.3.m3.1.1.3.cmml"><mrow id="S4.SS4.SSS2.p1.3.m3.1.1.3.2" xref="S4.SS4.SSS2.p1.3.m3.1.1.3.2.cmml"><mi id="S4.SS4.SSS2.p1.3.m3.1.1.3.2.2" xref="S4.SS4.SSS2.p1.3.m3.1.1.3.2.2.cmml">D</mi><mo id="S4.SS4.SSS2.p1.3.m3.1.1.3.2.1" xref="S4.SS4.SSS2.p1.3.m3.1.1.3.2.1.cmml">⁢</mo><mi id="S4.SS4.SSS2.p1.3.m3.1.1.3.2.3" xref="S4.SS4.SSS2.p1.3.m3.1.1.3.2.3.cmml">P</mi><mo id="S4.SS4.SSS2.p1.3.m3.1.1.3.2.1a" xref="S4.SS4.SSS2.p1.3.m3.1.1.3.2.1.cmml">⁢</mo><mi id="S4.SS4.SSS2.p1.3.m3.1.1.3.2.4" xref="S4.SS4.SSS2.p1.3.m3.1.1.3.2.4.cmml">O</mi><mo id="S4.SS4.SSS2.p1.3.m3.1.1.3.2.1b" xref="S4.SS4.SSS2.p1.3.m3.1.1.3.2.1.cmml">⁢</mo><mtext id="S4.SS4.SSS2.p1.3.m3.1.1.3.2.5" xref="S4.SS4.SSS2.p1.3.m3.1.1.3.2.5a.cmml">vs</mtext><mo id="S4.SS4.SSS2.p1.3.m3.1.1.3.2.1c" xref="S4.SS4.SSS2.p1.3.m3.1.1.3.2.1.cmml">⁢</mo><mi id="S4.SS4.SSS2.p1.3.m3.1.1.3.2.6" xref="S4.SS4.SSS2.p1.3.m3.1.1.3.2.6.cmml">T</mi><mo id="S4.SS4.SSS2.p1.3.m3.1.1.3.2.1d" xref="S4.SS4.SSS2.p1.3.m3.1.1.3.2.1.cmml">⁢</mo><mi id="S4.SS4.SSS2.p1.3.m3.1.1.3.2.7" xref="S4.SS4.SSS2.p1.3.m3.1.1.3.2.7.cmml">I</mi><mo id="S4.SS4.SSS2.p1.3.m3.1.1.3.2.1e" xref="S4.SS4.SSS2.p1.3.m3.1.1.3.2.1.cmml">⁢</mo><mi id="S4.SS4.SSS2.p1.3.m3.1.1.3.2.8" xref="S4.SS4.SSS2.p1.3.m3.1.1.3.2.8.cmml">E</mi><mo id="S4.SS4.SSS2.p1.3.m3.1.1.3.2.1f" xref="S4.SS4.SSS2.p1.3.m3.1.1.3.2.1.cmml">⁢</mo><mi id="S4.SS4.SSS2.p1.3.m3.1.1.3.2.9" xref="S4.SS4.SSS2.p1.3.m3.1.1.3.2.9.cmml">S</mi></mrow><mo id="S4.SS4.SSS2.p1.3.m3.1.1.3.1" xref="S4.SS4.SSS2.p1.3.m3.1.1.3.1.cmml">+</mo><mrow id="S4.SS4.SSS2.p1.3.m3.1.1.3.3" xref="S4.SS4.SSS2.p1.3.m3.1.1.3.3.cmml"><mi id="S4.SS4.SSS2.p1.3.m3.1.1.3.3.2" xref="S4.SS4.SSS2.p1.3.m3.1.1.3.3.2.cmml">D</mi><mo id="S4.SS4.SSS2.p1.3.m3.1.1.3.3.1" xref="S4.SS4.SSS2.p1.3.m3.1.1.3.3.1.cmml">⁢</mo><mi id="S4.SS4.SSS2.p1.3.m3.1.1.3.3.3" xref="S4.SS4.SSS2.p1.3.m3.1.1.3.3.3.cmml">P</mi><mo id="S4.SS4.SSS2.p1.3.m3.1.1.3.3.1a" xref="S4.SS4.SSS2.p1.3.m3.1.1.3.3.1.cmml">⁢</mo><mi id="S4.SS4.SSS2.p1.3.m3.1.1.3.3.4" xref="S4.SS4.SSS2.p1.3.m3.1.1.3.3.4.cmml">O</mi></mrow></mrow></msub><annotation-xml encoding="MathML-Content" id="S4.SS4.SSS2.p1.3.m3.1b"><apply id="S4.SS4.SSS2.p1.3.m3.1.1.cmml" xref="S4.SS4.SSS2.p1.3.m3.1.1"><csymbol cd="ambiguous" id="S4.SS4.SSS2.p1.3.m3.1.1.1.cmml" xref="S4.SS4.SSS2.p1.3.m3.1.1">subscript</csymbol><ci id="S4.SS4.SSS2.p1.3.m3.1.1.2.cmml" xref="S4.SS4.SSS2.p1.3.m3.1.1.2">Δ</ci><apply id="S4.SS4.SSS2.p1.3.m3.1.1.3.cmml" xref="S4.SS4.SSS2.p1.3.m3.1.1.3"><plus id="S4.SS4.SSS2.p1.3.m3.1.1.3.1.cmml" xref="S4.SS4.SSS2.p1.3.m3.1.1.3.1"></plus><apply id="S4.SS4.SSS2.p1.3.m3.1.1.3.2.cmml" xref="S4.SS4.SSS2.p1.3.m3.1.1.3.2"><times id="S4.SS4.SSS2.p1.3.m3.1.1.3.2.1.cmml" xref="S4.SS4.SSS2.p1.3.m3.1.1.3.2.1"></times><ci id="S4.SS4.SSS2.p1.3.m3.1.1.3.2.2.cmml" xref="S4.SS4.SSS2.p1.3.m3.1.1.3.2.2">𝐷</ci><ci id="S4.SS4.SSS2.p1.3.m3.1.1.3.2.3.cmml" xref="S4.SS4.SSS2.p1.3.m3.1.1.3.2.3">𝑃</ci><ci id="S4.SS4.SSS2.p1.3.m3.1.1.3.2.4.cmml" xref="S4.SS4.SSS2.p1.3.m3.1.1.3.2.4">𝑂</ci><ci id="S4.SS4.SSS2.p1.3.m3.1.1.3.2.5a.cmml" xref="S4.SS4.SSS2.p1.3.m3.1.1.3.2.5"><mtext id="S4.SS4.SSS2.p1.3.m3.1.1.3.2.5.cmml" mathsize="70%" xref="S4.SS4.SSS2.p1.3.m3.1.1.3.2.5">vs</mtext></ci><ci id="S4.SS4.SSS2.p1.3.m3.1.1.3.2.6.cmml" xref="S4.SS4.SSS2.p1.3.m3.1.1.3.2.6">𝑇</ci><ci id="S4.SS4.SSS2.p1.3.m3.1.1.3.2.7.cmml" xref="S4.SS4.SSS2.p1.3.m3.1.1.3.2.7">𝐼</ci><ci id="S4.SS4.SSS2.p1.3.m3.1.1.3.2.8.cmml" xref="S4.SS4.SSS2.p1.3.m3.1.1.3.2.8">𝐸</ci><ci id="S4.SS4.SSS2.p1.3.m3.1.1.3.2.9.cmml" xref="S4.SS4.SSS2.p1.3.m3.1.1.3.2.9">𝑆</ci></apply><apply id="S4.SS4.SSS2.p1.3.m3.1.1.3.3.cmml" xref="S4.SS4.SSS2.p1.3.m3.1.1.3.3"><times id="S4.SS4.SSS2.p1.3.m3.1.1.3.3.1.cmml" xref="S4.SS4.SSS2.p1.3.m3.1.1.3.3.1"></times><ci id="S4.SS4.SSS2.p1.3.m3.1.1.3.3.2.cmml" xref="S4.SS4.SSS2.p1.3.m3.1.1.3.3.2">𝐷</ci><ci id="S4.SS4.SSS2.p1.3.m3.1.1.3.3.3.cmml" xref="S4.SS4.SSS2.p1.3.m3.1.1.3.3.3">𝑃</ci><ci id="S4.SS4.SSS2.p1.3.m3.1.1.3.3.4.cmml" xref="S4.SS4.SSS2.p1.3.m3.1.1.3.3.4">𝑂</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS4.SSS2.p1.3.m3.1c">\Delta_{DPO\text{vs}TIES+DPO}</annotation><annotation encoding="application/x-llamapun" id="S4.SS4.SSS2.p1.3.m3.1d">roman_Δ start_POSTSUBSCRIPT italic_D italic_P italic_O vs italic_T italic_I italic_E italic_S + italic_D italic_P italic_O end_POSTSUBSCRIPT</annotation></semantics></math> in Table <a class="ltx_ref" href="https://arxiv.org/html/2405.13984v1#S4.T3" title="Table 3 ‣ 4.4.2 Quantitative Analysis on Mixed Cross-Modals Fusion ‣ 4.4 Results ‣ 4 Experiments ‣ Feedback-aligned Mixed LLMs for Machine Language-Molecule Translation"><span class="ltx_text ltx_ref_tag">3</span></a>), yet significant performance loss in language-to-molecule translation (see <math alttext="\Delta_{DPO\text{vs}TIES+DPO}" class="ltx_Math" display="inline" id="S4.SS4.SSS2.p1.4.m4.1"><semantics id="S4.SS4.SSS2.p1.4.m4.1a"><msub id="S4.SS4.SSS2.p1.4.m4.1.1" xref="S4.SS4.SSS2.p1.4.m4.1.1.cmml"><mi id="S4.SS4.SSS2.p1.4.m4.1.1.2" mathvariant="normal" xref="S4.SS4.SSS2.p1.4.m4.1.1.2.cmml">Δ</mi><mrow id="S4.SS4.SSS2.p1.4.m4.1.1.3" xref="S4.SS4.SSS2.p1.4.m4.1.1.3.cmml"><mrow id="S4.SS4.SSS2.p1.4.m4.1.1.3.2" xref="S4.SS4.SSS2.p1.4.m4.1.1.3.2.cmml"><mi id="S4.SS4.SSS2.p1.4.m4.1.1.3.2.2" xref="S4.SS4.SSS2.p1.4.m4.1.1.3.2.2.cmml">D</mi><mo id="S4.SS4.SSS2.p1.4.m4.1.1.3.2.1" xref="S4.SS4.SSS2.p1.4.m4.1.1.3.2.1.cmml">⁢</mo><mi id="S4.SS4.SSS2.p1.4.m4.1.1.3.2.3" xref="S4.SS4.SSS2.p1.4.m4.1.1.3.2.3.cmml">P</mi><mo id="S4.SS4.SSS2.p1.4.m4.1.1.3.2.1a" xref="S4.SS4.SSS2.p1.4.m4.1.1.3.2.1.cmml">⁢</mo><mi id="S4.SS4.SSS2.p1.4.m4.1.1.3.2.4" xref="S4.SS4.SSS2.p1.4.m4.1.1.3.2.4.cmml">O</mi><mo id="S4.SS4.SSS2.p1.4.m4.1.1.3.2.1b" xref="S4.SS4.SSS2.p1.4.m4.1.1.3.2.1.cmml">⁢</mo><mtext id="S4.SS4.SSS2.p1.4.m4.1.1.3.2.5" xref="S4.SS4.SSS2.p1.4.m4.1.1.3.2.5a.cmml">vs</mtext><mo id="S4.SS4.SSS2.p1.4.m4.1.1.3.2.1c" xref="S4.SS4.SSS2.p1.4.m4.1.1.3.2.1.cmml">⁢</mo><mi id="S4.SS4.SSS2.p1.4.m4.1.1.3.2.6" xref="S4.SS4.SSS2.p1.4.m4.1.1.3.2.6.cmml">T</mi><mo id="S4.SS4.SSS2.p1.4.m4.1.1.3.2.1d" xref="S4.SS4.SSS2.p1.4.m4.1.1.3.2.1.cmml">⁢</mo><mi id="S4.SS4.SSS2.p1.4.m4.1.1.3.2.7" xref="S4.SS4.SSS2.p1.4.m4.1.1.3.2.7.cmml">I</mi><mo id="S4.SS4.SSS2.p1.4.m4.1.1.3.2.1e" xref="S4.SS4.SSS2.p1.4.m4.1.1.3.2.1.cmml">⁢</mo><mi id="S4.SS4.SSS2.p1.4.m4.1.1.3.2.8" xref="S4.SS4.SSS2.p1.4.m4.1.1.3.2.8.cmml">E</mi><mo id="S4.SS4.SSS2.p1.4.m4.1.1.3.2.1f" xref="S4.SS4.SSS2.p1.4.m4.1.1.3.2.1.cmml">⁢</mo><mi id="S4.SS4.SSS2.p1.4.m4.1.1.3.2.9" xref="S4.SS4.SSS2.p1.4.m4.1.1.3.2.9.cmml">S</mi></mrow><mo id="S4.SS4.SSS2.p1.4.m4.1.1.3.1" xref="S4.SS4.SSS2.p1.4.m4.1.1.3.1.cmml">+</mo><mrow id="S4.SS4.SSS2.p1.4.m4.1.1.3.3" xref="S4.SS4.SSS2.p1.4.m4.1.1.3.3.cmml"><mi id="S4.SS4.SSS2.p1.4.m4.1.1.3.3.2" xref="S4.SS4.SSS2.p1.4.m4.1.1.3.3.2.cmml">D</mi><mo id="S4.SS4.SSS2.p1.4.m4.1.1.3.3.1" xref="S4.SS4.SSS2.p1.4.m4.1.1.3.3.1.cmml">⁢</mo><mi id="S4.SS4.SSS2.p1.4.m4.1.1.3.3.3" xref="S4.SS4.SSS2.p1.4.m4.1.1.3.3.3.cmml">P</mi><mo id="S4.SS4.SSS2.p1.4.m4.1.1.3.3.1a" xref="S4.SS4.SSS2.p1.4.m4.1.1.3.3.1.cmml">⁢</mo><mi id="S4.SS4.SSS2.p1.4.m4.1.1.3.3.4" xref="S4.SS4.SSS2.p1.4.m4.1.1.3.3.4.cmml">O</mi></mrow></mrow></msub><annotation-xml encoding="MathML-Content" id="S4.SS4.SSS2.p1.4.m4.1b"><apply id="S4.SS4.SSS2.p1.4.m4.1.1.cmml" xref="S4.SS4.SSS2.p1.4.m4.1.1"><csymbol cd="ambiguous" id="S4.SS4.SSS2.p1.4.m4.1.1.1.cmml" xref="S4.SS4.SSS2.p1.4.m4.1.1">subscript</csymbol><ci id="S4.SS4.SSS2.p1.4.m4.1.1.2.cmml" xref="S4.SS4.SSS2.p1.4.m4.1.1.2">Δ</ci><apply id="S4.SS4.SSS2.p1.4.m4.1.1.3.cmml" xref="S4.SS4.SSS2.p1.4.m4.1.1.3"><plus id="S4.SS4.SSS2.p1.4.m4.1.1.3.1.cmml" xref="S4.SS4.SSS2.p1.4.m4.1.1.3.1"></plus><apply id="S4.SS4.SSS2.p1.4.m4.1.1.3.2.cmml" xref="S4.SS4.SSS2.p1.4.m4.1.1.3.2"><times id="S4.SS4.SSS2.p1.4.m4.1.1.3.2.1.cmml" xref="S4.SS4.SSS2.p1.4.m4.1.1.3.2.1"></times><ci id="S4.SS4.SSS2.p1.4.m4.1.1.3.2.2.cmml" xref="S4.SS4.SSS2.p1.4.m4.1.1.3.2.2">𝐷</ci><ci id="S4.SS4.SSS2.p1.4.m4.1.1.3.2.3.cmml" xref="S4.SS4.SSS2.p1.4.m4.1.1.3.2.3">𝑃</ci><ci id="S4.SS4.SSS2.p1.4.m4.1.1.3.2.4.cmml" xref="S4.SS4.SSS2.p1.4.m4.1.1.3.2.4">𝑂</ci><ci id="S4.SS4.SSS2.p1.4.m4.1.1.3.2.5a.cmml" xref="S4.SS4.SSS2.p1.4.m4.1.1.3.2.5"><mtext id="S4.SS4.SSS2.p1.4.m4.1.1.3.2.5.cmml" mathsize="70%" xref="S4.SS4.SSS2.p1.4.m4.1.1.3.2.5">vs</mtext></ci><ci id="S4.SS4.SSS2.p1.4.m4.1.1.3.2.6.cmml" xref="S4.SS4.SSS2.p1.4.m4.1.1.3.2.6">𝑇</ci><ci id="S4.SS4.SSS2.p1.4.m4.1.1.3.2.7.cmml" xref="S4.SS4.SSS2.p1.4.m4.1.1.3.2.7">𝐼</ci><ci id="S4.SS4.SSS2.p1.4.m4.1.1.3.2.8.cmml" xref="S4.SS4.SSS2.p1.4.m4.1.1.3.2.8">𝐸</ci><ci id="S4.SS4.SSS2.p1.4.m4.1.1.3.2.9.cmml" xref="S4.SS4.SSS2.p1.4.m4.1.1.3.2.9">𝑆</ci></apply><apply id="S4.SS4.SSS2.p1.4.m4.1.1.3.3.cmml" xref="S4.SS4.SSS2.p1.4.m4.1.1.3.3"><times id="S4.SS4.SSS2.p1.4.m4.1.1.3.3.1.cmml" xref="S4.SS4.SSS2.p1.4.m4.1.1.3.3.1"></times><ci id="S4.SS4.SSS2.p1.4.m4.1.1.3.3.2.cmml" xref="S4.SS4.SSS2.p1.4.m4.1.1.3.3.2">𝐷</ci><ci id="S4.SS4.SSS2.p1.4.m4.1.1.3.3.3.cmml" xref="S4.SS4.SSS2.p1.4.m4.1.1.3.3.3">𝑃</ci><ci id="S4.SS4.SSS2.p1.4.m4.1.1.3.3.4.cmml" xref="S4.SS4.SSS2.p1.4.m4.1.1.3.3.4">𝑂</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS4.SSS2.p1.4.m4.1c">\Delta_{DPO\text{vs}TIES+DPO}</annotation><annotation encoding="application/x-llamapun" id="S4.SS4.SSS2.p1.4.m4.1d">roman_Δ start_POSTSUBSCRIPT italic_D italic_P italic_O vs italic_T italic_I italic_E italic_S + italic_D italic_P italic_O end_POSTSUBSCRIPT</annotation></semantics></math> in Table <a class="ltx_ref" href="https://arxiv.org/html/2405.13984v1#S4.T4" title="Table 4 ‣ 4.4.2 Quantitative Analysis on Mixed Cross-Modals Fusion ‣ 4.4 Results ‣ 4 Experiments ‣ Feedback-aligned Mixed LLMs for Machine Language-Molecule Translation"><span class="ltx_text ltx_ref_tag">4</span></a>). Conversely, fusing CPO with mixed cross-modals via SLERP notably improves molecule-to-language capabilities (see <math alttext="\Delta_{CPO\text{vs}SLERP+CPO}" class="ltx_Math" display="inline" id="S4.SS4.SSS2.p1.5.m5.1"><semantics id="S4.SS4.SSS2.p1.5.m5.1a"><msub id="S4.SS4.SSS2.p1.5.m5.1.1" xref="S4.SS4.SSS2.p1.5.m5.1.1.cmml"><mi id="S4.SS4.SSS2.p1.5.m5.1.1.2" mathvariant="normal" xref="S4.SS4.SSS2.p1.5.m5.1.1.2.cmml">Δ</mi><mrow id="S4.SS4.SSS2.p1.5.m5.1.1.3" xref="S4.SS4.SSS2.p1.5.m5.1.1.3.cmml"><mrow id="S4.SS4.SSS2.p1.5.m5.1.1.3.2" xref="S4.SS4.SSS2.p1.5.m5.1.1.3.2.cmml"><mi id="S4.SS4.SSS2.p1.5.m5.1.1.3.2.2" xref="S4.SS4.SSS2.p1.5.m5.1.1.3.2.2.cmml">C</mi><mo id="S4.SS4.SSS2.p1.5.m5.1.1.3.2.1" xref="S4.SS4.SSS2.p1.5.m5.1.1.3.2.1.cmml">⁢</mo><mi id="S4.SS4.SSS2.p1.5.m5.1.1.3.2.3" xref="S4.SS4.SSS2.p1.5.m5.1.1.3.2.3.cmml">P</mi><mo id="S4.SS4.SSS2.p1.5.m5.1.1.3.2.1a" xref="S4.SS4.SSS2.p1.5.m5.1.1.3.2.1.cmml">⁢</mo><mi id="S4.SS4.SSS2.p1.5.m5.1.1.3.2.4" xref="S4.SS4.SSS2.p1.5.m5.1.1.3.2.4.cmml">O</mi><mo id="S4.SS4.SSS2.p1.5.m5.1.1.3.2.1b" xref="S4.SS4.SSS2.p1.5.m5.1.1.3.2.1.cmml">⁢</mo><mtext id="S4.SS4.SSS2.p1.5.m5.1.1.3.2.5" xref="S4.SS4.SSS2.p1.5.m5.1.1.3.2.5a.cmml">vs</mtext><mo id="S4.SS4.SSS2.p1.5.m5.1.1.3.2.1c" xref="S4.SS4.SSS2.p1.5.m5.1.1.3.2.1.cmml">⁢</mo><mi id="S4.SS4.SSS2.p1.5.m5.1.1.3.2.6" xref="S4.SS4.SSS2.p1.5.m5.1.1.3.2.6.cmml">S</mi><mo id="S4.SS4.SSS2.p1.5.m5.1.1.3.2.1d" xref="S4.SS4.SSS2.p1.5.m5.1.1.3.2.1.cmml">⁢</mo><mi id="S4.SS4.SSS2.p1.5.m5.1.1.3.2.7" xref="S4.SS4.SSS2.p1.5.m5.1.1.3.2.7.cmml">L</mi><mo id="S4.SS4.SSS2.p1.5.m5.1.1.3.2.1e" xref="S4.SS4.SSS2.p1.5.m5.1.1.3.2.1.cmml">⁢</mo><mi id="S4.SS4.SSS2.p1.5.m5.1.1.3.2.8" xref="S4.SS4.SSS2.p1.5.m5.1.1.3.2.8.cmml">E</mi><mo id="S4.SS4.SSS2.p1.5.m5.1.1.3.2.1f" xref="S4.SS4.SSS2.p1.5.m5.1.1.3.2.1.cmml">⁢</mo><mi id="S4.SS4.SSS2.p1.5.m5.1.1.3.2.9" xref="S4.SS4.SSS2.p1.5.m5.1.1.3.2.9.cmml">R</mi><mo id="S4.SS4.SSS2.p1.5.m5.1.1.3.2.1g" xref="S4.SS4.SSS2.p1.5.m5.1.1.3.2.1.cmml">⁢</mo><mi id="S4.SS4.SSS2.p1.5.m5.1.1.3.2.10" xref="S4.SS4.SSS2.p1.5.m5.1.1.3.2.10.cmml">P</mi></mrow><mo id="S4.SS4.SSS2.p1.5.m5.1.1.3.1" xref="S4.SS4.SSS2.p1.5.m5.1.1.3.1.cmml">+</mo><mrow id="S4.SS4.SSS2.p1.5.m5.1.1.3.3" xref="S4.SS4.SSS2.p1.5.m5.1.1.3.3.cmml"><mi id="S4.SS4.SSS2.p1.5.m5.1.1.3.3.2" xref="S4.SS4.SSS2.p1.5.m5.1.1.3.3.2.cmml">C</mi><mo id="S4.SS4.SSS2.p1.5.m5.1.1.3.3.1" xref="S4.SS4.SSS2.p1.5.m5.1.1.3.3.1.cmml">⁢</mo><mi id="S4.SS4.SSS2.p1.5.m5.1.1.3.3.3" xref="S4.SS4.SSS2.p1.5.m5.1.1.3.3.3.cmml">P</mi><mo id="S4.SS4.SSS2.p1.5.m5.1.1.3.3.1a" xref="S4.SS4.SSS2.p1.5.m5.1.1.3.3.1.cmml">⁢</mo><mi id="S4.SS4.SSS2.p1.5.m5.1.1.3.3.4" xref="S4.SS4.SSS2.p1.5.m5.1.1.3.3.4.cmml">O</mi></mrow></mrow></msub><annotation-xml encoding="MathML-Content" id="S4.SS4.SSS2.p1.5.m5.1b"><apply id="S4.SS4.SSS2.p1.5.m5.1.1.cmml" xref="S4.SS4.SSS2.p1.5.m5.1.1"><csymbol cd="ambiguous" id="S4.SS4.SSS2.p1.5.m5.1.1.1.cmml" xref="S4.SS4.SSS2.p1.5.m5.1.1">subscript</csymbol><ci id="S4.SS4.SSS2.p1.5.m5.1.1.2.cmml" xref="S4.SS4.SSS2.p1.5.m5.1.1.2">Δ</ci><apply id="S4.SS4.SSS2.p1.5.m5.1.1.3.cmml" xref="S4.SS4.SSS2.p1.5.m5.1.1.3"><plus id="S4.SS4.SSS2.p1.5.m5.1.1.3.1.cmml" xref="S4.SS4.SSS2.p1.5.m5.1.1.3.1"></plus><apply id="S4.SS4.SSS2.p1.5.m5.1.1.3.2.cmml" xref="S4.SS4.SSS2.p1.5.m5.1.1.3.2"><times id="S4.SS4.SSS2.p1.5.m5.1.1.3.2.1.cmml" xref="S4.SS4.SSS2.p1.5.m5.1.1.3.2.1"></times><ci id="S4.SS4.SSS2.p1.5.m5.1.1.3.2.2.cmml" xref="S4.SS4.SSS2.p1.5.m5.1.1.3.2.2">𝐶</ci><ci id="S4.SS4.SSS2.p1.5.m5.1.1.3.2.3.cmml" xref="S4.SS4.SSS2.p1.5.m5.1.1.3.2.3">𝑃</ci><ci id="S4.SS4.SSS2.p1.5.m5.1.1.3.2.4.cmml" xref="S4.SS4.SSS2.p1.5.m5.1.1.3.2.4">𝑂</ci><ci id="S4.SS4.SSS2.p1.5.m5.1.1.3.2.5a.cmml" xref="S4.SS4.SSS2.p1.5.m5.1.1.3.2.5"><mtext id="S4.SS4.SSS2.p1.5.m5.1.1.3.2.5.cmml" mathsize="70%" xref="S4.SS4.SSS2.p1.5.m5.1.1.3.2.5">vs</mtext></ci><ci id="S4.SS4.SSS2.p1.5.m5.1.1.3.2.6.cmml" xref="S4.SS4.SSS2.p1.5.m5.1.1.3.2.6">𝑆</ci><ci id="S4.SS4.SSS2.p1.5.m5.1.1.3.2.7.cmml" xref="S4.SS4.SSS2.p1.5.m5.1.1.3.2.7">𝐿</ci><ci id="S4.SS4.SSS2.p1.5.m5.1.1.3.2.8.cmml" xref="S4.SS4.SSS2.p1.5.m5.1.1.3.2.8">𝐸</ci><ci id="S4.SS4.SSS2.p1.5.m5.1.1.3.2.9.cmml" xref="S4.SS4.SSS2.p1.5.m5.1.1.3.2.9">𝑅</ci><ci id="S4.SS4.SSS2.p1.5.m5.1.1.3.2.10.cmml" xref="S4.SS4.SSS2.p1.5.m5.1.1.3.2.10">𝑃</ci></apply><apply id="S4.SS4.SSS2.p1.5.m5.1.1.3.3.cmml" xref="S4.SS4.SSS2.p1.5.m5.1.1.3.3"><times id="S4.SS4.SSS2.p1.5.m5.1.1.3.3.1.cmml" xref="S4.SS4.SSS2.p1.5.m5.1.1.3.3.1"></times><ci id="S4.SS4.SSS2.p1.5.m5.1.1.3.3.2.cmml" xref="S4.SS4.SSS2.p1.5.m5.1.1.3.3.2">𝐶</ci><ci id="S4.SS4.SSS2.p1.5.m5.1.1.3.3.3.cmml" xref="S4.SS4.SSS2.p1.5.m5.1.1.3.3.3">𝑃</ci><ci id="S4.SS4.SSS2.p1.5.m5.1.1.3.3.4.cmml" xref="S4.SS4.SSS2.p1.5.m5.1.1.3.3.4">𝑂</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS4.SSS2.p1.5.m5.1c">\Delta_{CPO\text{vs}SLERP+CPO}</annotation><annotation encoding="application/x-llamapun" id="S4.SS4.SSS2.p1.5.m5.1d">roman_Δ start_POSTSUBSCRIPT italic_C italic_P italic_O vs italic_S italic_L italic_E italic_R italic_P + italic_C italic_P italic_O end_POSTSUBSCRIPT</annotation></semantics></math> in Table <a class="ltx_ref" href="https://arxiv.org/html/2405.13984v1#S4.T3" title="Table 3 ‣ 4.4.2 Quantitative Analysis on Mixed Cross-Modals Fusion ‣ 4.4 Results ‣ 4 Experiments ‣ Feedback-aligned Mixed LLMs for Machine Language-Molecule Translation"><span class="ltx_text ltx_ref_tag">3</span></a>) while minimally impacting language-to-molecule translation performance (see <math alttext="\Delta_{CPO\text{vs}SLERP+CPO}" class="ltx_Math" display="inline" id="S4.SS4.SSS2.p1.6.m6.1"><semantics id="S4.SS4.SSS2.p1.6.m6.1a"><msub id="S4.SS4.SSS2.p1.6.m6.1.1" xref="S4.SS4.SSS2.p1.6.m6.1.1.cmml"><mi id="S4.SS4.SSS2.p1.6.m6.1.1.2" mathvariant="normal" xref="S4.SS4.SSS2.p1.6.m6.1.1.2.cmml">Δ</mi><mrow id="S4.SS4.SSS2.p1.6.m6.1.1.3" xref="S4.SS4.SSS2.p1.6.m6.1.1.3.cmml"><mrow id="S4.SS4.SSS2.p1.6.m6.1.1.3.2" xref="S4.SS4.SSS2.p1.6.m6.1.1.3.2.cmml"><mi id="S4.SS4.SSS2.p1.6.m6.1.1.3.2.2" xref="S4.SS4.SSS2.p1.6.m6.1.1.3.2.2.cmml">C</mi><mo id="S4.SS4.SSS2.p1.6.m6.1.1.3.2.1" xref="S4.SS4.SSS2.p1.6.m6.1.1.3.2.1.cmml">⁢</mo><mi id="S4.SS4.SSS2.p1.6.m6.1.1.3.2.3" xref="S4.SS4.SSS2.p1.6.m6.1.1.3.2.3.cmml">P</mi><mo id="S4.SS4.SSS2.p1.6.m6.1.1.3.2.1a" xref="S4.SS4.SSS2.p1.6.m6.1.1.3.2.1.cmml">⁢</mo><mi id="S4.SS4.SSS2.p1.6.m6.1.1.3.2.4" xref="S4.SS4.SSS2.p1.6.m6.1.1.3.2.4.cmml">O</mi><mo id="S4.SS4.SSS2.p1.6.m6.1.1.3.2.1b" xref="S4.SS4.SSS2.p1.6.m6.1.1.3.2.1.cmml">⁢</mo><mtext id="S4.SS4.SSS2.p1.6.m6.1.1.3.2.5" xref="S4.SS4.SSS2.p1.6.m6.1.1.3.2.5a.cmml">vs</mtext><mo id="S4.SS4.SSS2.p1.6.m6.1.1.3.2.1c" xref="S4.SS4.SSS2.p1.6.m6.1.1.3.2.1.cmml">⁢</mo><mi id="S4.SS4.SSS2.p1.6.m6.1.1.3.2.6" xref="S4.SS4.SSS2.p1.6.m6.1.1.3.2.6.cmml">S</mi><mo id="S4.SS4.SSS2.p1.6.m6.1.1.3.2.1d" xref="S4.SS4.SSS2.p1.6.m6.1.1.3.2.1.cmml">⁢</mo><mi id="S4.SS4.SSS2.p1.6.m6.1.1.3.2.7" xref="S4.SS4.SSS2.p1.6.m6.1.1.3.2.7.cmml">L</mi><mo id="S4.SS4.SSS2.p1.6.m6.1.1.3.2.1e" xref="S4.SS4.SSS2.p1.6.m6.1.1.3.2.1.cmml">⁢</mo><mi id="S4.SS4.SSS2.p1.6.m6.1.1.3.2.8" xref="S4.SS4.SSS2.p1.6.m6.1.1.3.2.8.cmml">E</mi><mo id="S4.SS4.SSS2.p1.6.m6.1.1.3.2.1f" xref="S4.SS4.SSS2.p1.6.m6.1.1.3.2.1.cmml">⁢</mo><mi id="S4.SS4.SSS2.p1.6.m6.1.1.3.2.9" xref="S4.SS4.SSS2.p1.6.m6.1.1.3.2.9.cmml">R</mi><mo id="S4.SS4.SSS2.p1.6.m6.1.1.3.2.1g" xref="S4.SS4.SSS2.p1.6.m6.1.1.3.2.1.cmml">⁢</mo><mi id="S4.SS4.SSS2.p1.6.m6.1.1.3.2.10" xref="S4.SS4.SSS2.p1.6.m6.1.1.3.2.10.cmml">P</mi></mrow><mo id="S4.SS4.SSS2.p1.6.m6.1.1.3.1" xref="S4.SS4.SSS2.p1.6.m6.1.1.3.1.cmml">+</mo><mrow id="S4.SS4.SSS2.p1.6.m6.1.1.3.3" xref="S4.SS4.SSS2.p1.6.m6.1.1.3.3.cmml"><mi id="S4.SS4.SSS2.p1.6.m6.1.1.3.3.2" xref="S4.SS4.SSS2.p1.6.m6.1.1.3.3.2.cmml">C</mi><mo id="S4.SS4.SSS2.p1.6.m6.1.1.3.3.1" xref="S4.SS4.SSS2.p1.6.m6.1.1.3.3.1.cmml">⁢</mo><mi id="S4.SS4.SSS2.p1.6.m6.1.1.3.3.3" xref="S4.SS4.SSS2.p1.6.m6.1.1.3.3.3.cmml">P</mi><mo id="S4.SS4.SSS2.p1.6.m6.1.1.3.3.1a" xref="S4.SS4.SSS2.p1.6.m6.1.1.3.3.1.cmml">⁢</mo><mi id="S4.SS4.SSS2.p1.6.m6.1.1.3.3.4" xref="S4.SS4.SSS2.p1.6.m6.1.1.3.3.4.cmml">O</mi></mrow></mrow></msub><annotation-xml encoding="MathML-Content" id="S4.SS4.SSS2.p1.6.m6.1b"><apply id="S4.SS4.SSS2.p1.6.m6.1.1.cmml" xref="S4.SS4.SSS2.p1.6.m6.1.1"><csymbol cd="ambiguous" id="S4.SS4.SSS2.p1.6.m6.1.1.1.cmml" xref="S4.SS4.SSS2.p1.6.m6.1.1">subscript</csymbol><ci id="S4.SS4.SSS2.p1.6.m6.1.1.2.cmml" xref="S4.SS4.SSS2.p1.6.m6.1.1.2">Δ</ci><apply id="S4.SS4.SSS2.p1.6.m6.1.1.3.cmml" xref="S4.SS4.SSS2.p1.6.m6.1.1.3"><plus id="S4.SS4.SSS2.p1.6.m6.1.1.3.1.cmml" xref="S4.SS4.SSS2.p1.6.m6.1.1.3.1"></plus><apply id="S4.SS4.SSS2.p1.6.m6.1.1.3.2.cmml" xref="S4.SS4.SSS2.p1.6.m6.1.1.3.2"><times id="S4.SS4.SSS2.p1.6.m6.1.1.3.2.1.cmml" xref="S4.SS4.SSS2.p1.6.m6.1.1.3.2.1"></times><ci id="S4.SS4.SSS2.p1.6.m6.1.1.3.2.2.cmml" xref="S4.SS4.SSS2.p1.6.m6.1.1.3.2.2">𝐶</ci><ci id="S4.SS4.SSS2.p1.6.m6.1.1.3.2.3.cmml" xref="S4.SS4.SSS2.p1.6.m6.1.1.3.2.3">𝑃</ci><ci id="S4.SS4.SSS2.p1.6.m6.1.1.3.2.4.cmml" xref="S4.SS4.SSS2.p1.6.m6.1.1.3.2.4">𝑂</ci><ci id="S4.SS4.SSS2.p1.6.m6.1.1.3.2.5a.cmml" xref="S4.SS4.SSS2.p1.6.m6.1.1.3.2.5"><mtext id="S4.SS4.SSS2.p1.6.m6.1.1.3.2.5.cmml" mathsize="70%" xref="S4.SS4.SSS2.p1.6.m6.1.1.3.2.5">vs</mtext></ci><ci id="S4.SS4.SSS2.p1.6.m6.1.1.3.2.6.cmml" xref="S4.SS4.SSS2.p1.6.m6.1.1.3.2.6">𝑆</ci><ci id="S4.SS4.SSS2.p1.6.m6.1.1.3.2.7.cmml" xref="S4.SS4.SSS2.p1.6.m6.1.1.3.2.7">𝐿</ci><ci id="S4.SS4.SSS2.p1.6.m6.1.1.3.2.8.cmml" xref="S4.SS4.SSS2.p1.6.m6.1.1.3.2.8">𝐸</ci><ci id="S4.SS4.SSS2.p1.6.m6.1.1.3.2.9.cmml" xref="S4.SS4.SSS2.p1.6.m6.1.1.3.2.9">𝑅</ci><ci id="S4.SS4.SSS2.p1.6.m6.1.1.3.2.10.cmml" xref="S4.SS4.SSS2.p1.6.m6.1.1.3.2.10">𝑃</ci></apply><apply id="S4.SS4.SSS2.p1.6.m6.1.1.3.3.cmml" xref="S4.SS4.SSS2.p1.6.m6.1.1.3.3"><times id="S4.SS4.SSS2.p1.6.m6.1.1.3.3.1.cmml" xref="S4.SS4.SSS2.p1.6.m6.1.1.3.3.1"></times><ci id="S4.SS4.SSS2.p1.6.m6.1.1.3.3.2.cmml" xref="S4.SS4.SSS2.p1.6.m6.1.1.3.3.2">𝐶</ci><ci id="S4.SS4.SSS2.p1.6.m6.1.1.3.3.3.cmml" xref="S4.SS4.SSS2.p1.6.m6.1.1.3.3.3">𝑃</ci><ci id="S4.SS4.SSS2.p1.6.m6.1.1.3.3.4.cmml" xref="S4.SS4.SSS2.p1.6.m6.1.1.3.3.4">𝑂</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS4.SSS2.p1.6.m6.1c">\Delta_{CPO\text{vs}SLERP+CPO}</annotation><annotation encoding="application/x-llamapun" id="S4.SS4.SSS2.p1.6.m6.1d">roman_Δ start_POSTSUBSCRIPT italic_C italic_P italic_O vs italic_S italic_L italic_E italic_R italic_P + italic_C italic_P italic_O end_POSTSUBSCRIPT</annotation></semantics></math> in Table <a class="ltx_ref" href="https://arxiv.org/html/2405.13984v1#S4.T4" title="Table 4 ‣ 4.4.2 Quantitative Analysis on Mixed Cross-Modals Fusion ‣ 4.4 Results ‣ 4 Experiments ‣ Feedback-aligned Mixed LLMs for Machine Language-Molecule Translation"><span class="ltx_text ltx_ref_tag">4</span></a>), showcasing overall gains compared to Meditron trained on the entire dataset. Overall, we consistently observe a trade-off in performance when fusing cross-modals, prompting future exploration of nuanced algorithms for modelling cross language-molecule dynamics.</p>
</div>
<figure class="ltx_table" id="S4.T3">
<div class="ltx_inline-block ltx_align_center ltx_transformed_outer" id="S4.T3.9" style="width:433.6pt;height:146.6pt;vertical-align:-0.0pt;"><span class="ltx_transformed_inner" style="transform:translate(3.9pt,-1.3pt) scale(1.01821785182294,1.01821785182294) ;">
<table class="ltx_tabular ltx_align_middle" id="S4.T3.9.9">
<tr class="ltx_tr" id="S4.T3.6.6.6">
<td class="ltx_td ltx_align_center ltx_border_tt" id="S4.T3.6.6.6.7"><span class="ltx_text ltx_font_bold" id="S4.T3.6.6.6.7.1">Fusion</span></td>
<td class="ltx_td ltx_align_center ltx_border_tt" id="S4.T3.6.6.6.8"><span class="ltx_text ltx_font_bold" id="S4.T3.6.6.6.8.1">Method</span></td>
<td class="ltx_td ltx_align_center ltx_border_tt" id="S4.T3.1.1.1.1">
<span class="ltx_text ltx_font_bold" id="S4.T3.1.1.1.1.1">Blue-2</span> <math alttext="\uparrow" class="ltx_Math" display="inline" id="S4.T3.1.1.1.1.m1.1"><semantics id="S4.T3.1.1.1.1.m1.1a"><mo id="S4.T3.1.1.1.1.m1.1.1" stretchy="false" xref="S4.T3.1.1.1.1.m1.1.1.cmml">↑</mo><annotation-xml encoding="MathML-Content" id="S4.T3.1.1.1.1.m1.1b"><ci id="S4.T3.1.1.1.1.m1.1.1.cmml" xref="S4.T3.1.1.1.1.m1.1.1">↑</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.T3.1.1.1.1.m1.1c">\uparrow</annotation><annotation encoding="application/x-llamapun" id="S4.T3.1.1.1.1.m1.1d">↑</annotation></semantics></math>
</td>
<td class="ltx_td ltx_align_center ltx_border_tt" id="S4.T3.2.2.2.2">
<span class="ltx_text ltx_font_bold" id="S4.T3.2.2.2.2.1">Blue-4</span> <math alttext="\uparrow" class="ltx_Math" display="inline" id="S4.T3.2.2.2.2.m1.1"><semantics id="S4.T3.2.2.2.2.m1.1a"><mo id="S4.T3.2.2.2.2.m1.1.1" stretchy="false" xref="S4.T3.2.2.2.2.m1.1.1.cmml">↑</mo><annotation-xml encoding="MathML-Content" id="S4.T3.2.2.2.2.m1.1b"><ci id="S4.T3.2.2.2.2.m1.1.1.cmml" xref="S4.T3.2.2.2.2.m1.1.1">↑</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.T3.2.2.2.2.m1.1c">\uparrow</annotation><annotation encoding="application/x-llamapun" id="S4.T3.2.2.2.2.m1.1d">↑</annotation></semantics></math>
</td>
<td class="ltx_td ltx_align_center ltx_border_tt" id="S4.T3.3.3.3.3">
<span class="ltx_text ltx_font_bold" id="S4.T3.3.3.3.3.1">Rouge-1</span> <math alttext="\uparrow" class="ltx_Math" display="inline" id="S4.T3.3.3.3.3.m1.1"><semantics id="S4.T3.3.3.3.3.m1.1a"><mo id="S4.T3.3.3.3.3.m1.1.1" stretchy="false" xref="S4.T3.3.3.3.3.m1.1.1.cmml">↑</mo><annotation-xml encoding="MathML-Content" id="S4.T3.3.3.3.3.m1.1b"><ci id="S4.T3.3.3.3.3.m1.1.1.cmml" xref="S4.T3.3.3.3.3.m1.1.1">↑</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.T3.3.3.3.3.m1.1c">\uparrow</annotation><annotation encoding="application/x-llamapun" id="S4.T3.3.3.3.3.m1.1d">↑</annotation></semantics></math>
</td>
<td class="ltx_td ltx_align_center ltx_border_tt" id="S4.T3.4.4.4.4">
<span class="ltx_text ltx_font_bold" id="S4.T3.4.4.4.4.1">Rouge-2</span> <math alttext="\uparrow" class="ltx_Math" display="inline" id="S4.T3.4.4.4.4.m1.1"><semantics id="S4.T3.4.4.4.4.m1.1a"><mo id="S4.T3.4.4.4.4.m1.1.1" stretchy="false" xref="S4.T3.4.4.4.4.m1.1.1.cmml">↑</mo><annotation-xml encoding="MathML-Content" id="S4.T3.4.4.4.4.m1.1b"><ci id="S4.T3.4.4.4.4.m1.1.1.cmml" xref="S4.T3.4.4.4.4.m1.1.1">↑</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.T3.4.4.4.4.m1.1c">\uparrow</annotation><annotation encoding="application/x-llamapun" id="S4.T3.4.4.4.4.m1.1d">↑</annotation></semantics></math>
</td>
<td class="ltx_td ltx_align_center ltx_border_tt" id="S4.T3.5.5.5.5">
<span class="ltx_text ltx_font_bold" id="S4.T3.5.5.5.5.1">Rouge-L</span> <math alttext="\uparrow" class="ltx_Math" display="inline" id="S4.T3.5.5.5.5.m1.1"><semantics id="S4.T3.5.5.5.5.m1.1a"><mo id="S4.T3.5.5.5.5.m1.1.1" stretchy="false" xref="S4.T3.5.5.5.5.m1.1.1.cmml">↑</mo><annotation-xml encoding="MathML-Content" id="S4.T3.5.5.5.5.m1.1b"><ci id="S4.T3.5.5.5.5.m1.1.1.cmml" xref="S4.T3.5.5.5.5.m1.1.1">↑</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.T3.5.5.5.5.m1.1c">\uparrow</annotation><annotation encoding="application/x-llamapun" id="S4.T3.5.5.5.5.m1.1d">↑</annotation></semantics></math>
</td>
<td class="ltx_td ltx_align_center ltx_border_tt" id="S4.T3.6.6.6.6">
<span class="ltx_text ltx_font_bold" id="S4.T3.6.6.6.6.1">METEOR</span> <math alttext="\uparrow" class="ltx_Math" display="inline" id="S4.T3.6.6.6.6.m1.1"><semantics id="S4.T3.6.6.6.6.m1.1a"><mo id="S4.T3.6.6.6.6.m1.1.1" stretchy="false" xref="S4.T3.6.6.6.6.m1.1.1.cmml">↑</mo><annotation-xml encoding="MathML-Content" id="S4.T3.6.6.6.6.m1.1b"><ci id="S4.T3.6.6.6.6.m1.1.1.cmml" xref="S4.T3.6.6.6.6.m1.1.1">↑</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.T3.6.6.6.6.m1.1c">\uparrow</annotation><annotation encoding="application/x-llamapun" id="S4.T3.6.6.6.6.m1.1d">↑</annotation></semantics></math>
</td>
</tr>
<tr class="ltx_tr" id="S4.T3.9.9.10">
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T3.9.9.10.1" rowspan="2"><span class="ltx_text ltx_font_bold" id="S4.T3.9.9.10.1.1">TIES</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T3.9.9.10.2"><span class="ltx_text ltx_font_bold" id="S4.T3.9.9.10.2.1">DPO</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T3.9.9.10.3">0.74</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T3.9.9.10.4">0.53</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T3.9.9.10.5">0.74</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T3.9.9.10.6">0.54</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T3.9.9.10.7">0.51</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T3.9.9.10.8">0.70</td>
</tr>
<tr class="ltx_tr" id="S4.T3.9.9.11">
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T3.9.9.11.1">CPO</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T3.9.9.11.2">0.74</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T3.9.9.11.3">0.54</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T3.9.9.11.4">0.76</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T3.9.9.11.5">0.57</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T3.9.9.11.6">0.53</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T3.9.9.11.7">0.72</td>
</tr>
<tr class="ltx_tr" id="S4.T3.9.9.12">
<td class="ltx_td ltx_align_center ltx_border_tt" id="S4.T3.9.9.12.1" rowspan="2"><span class="ltx_text ltx_font_bold" id="S4.T3.9.9.12.1.1">SLERP</span></td>
<td class="ltx_td ltx_align_center ltx_border_tt" id="S4.T3.9.9.12.2">DPO</td>
<td class="ltx_td ltx_align_center ltx_border_tt" id="S4.T3.9.9.12.3">0.00</td>
<td class="ltx_td ltx_align_center ltx_border_tt" id="S4.T3.9.9.12.4">0.00</td>
<td class="ltx_td ltx_align_center ltx_border_tt" id="S4.T3.9.9.12.5">0.02</td>
<td class="ltx_td ltx_align_center ltx_border_tt" id="S4.T3.9.9.12.6">0.01</td>
<td class="ltx_td ltx_align_center ltx_border_tt" id="S4.T3.9.9.12.7">0.00</td>
<td class="ltx_td ltx_align_center ltx_border_tt" id="S4.T3.9.9.12.8">0.00</td>
</tr>
<tr class="ltx_tr" id="S4.T3.9.9.13">
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T3.9.9.13.1"><span class="ltx_text ltx_font_bold" id="S4.T3.9.9.13.1.1">CPO</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T3.9.9.13.2">0.73</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T3.9.9.13.3">0.53</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T3.9.9.13.4">0.76</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T3.9.9.13.5">0.56</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T3.9.9.13.6">0.53</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T3.9.9.13.7">0.71</td>
</tr>
<tr class="ltx_tr" id="S4.T3.7.7.7">
<td class="ltx_td ltx_align_center ltx_border_tt" colspan="2" id="S4.T3.7.7.7.1"><math alttext="\Delta_{DPO\text{vs}TIES+DPO}" class="ltx_Math" display="inline" id="S4.T3.7.7.7.1.m1.1"><semantics id="S4.T3.7.7.7.1.m1.1a"><msub id="S4.T3.7.7.7.1.m1.1.1" xref="S4.T3.7.7.7.1.m1.1.1.cmml"><mi id="S4.T3.7.7.7.1.m1.1.1.2" mathvariant="normal" xref="S4.T3.7.7.7.1.m1.1.1.2.cmml">Δ</mi><mrow id="S4.T3.7.7.7.1.m1.1.1.3" xref="S4.T3.7.7.7.1.m1.1.1.3.cmml"><mrow id="S4.T3.7.7.7.1.m1.1.1.3.2" xref="S4.T3.7.7.7.1.m1.1.1.3.2.cmml"><mi id="S4.T3.7.7.7.1.m1.1.1.3.2.2" xref="S4.T3.7.7.7.1.m1.1.1.3.2.2.cmml">D</mi><mo id="S4.T3.7.7.7.1.m1.1.1.3.2.1" xref="S4.T3.7.7.7.1.m1.1.1.3.2.1.cmml">⁢</mo><mi id="S4.T3.7.7.7.1.m1.1.1.3.2.3" xref="S4.T3.7.7.7.1.m1.1.1.3.2.3.cmml">P</mi><mo id="S4.T3.7.7.7.1.m1.1.1.3.2.1a" xref="S4.T3.7.7.7.1.m1.1.1.3.2.1.cmml">⁢</mo><mi id="S4.T3.7.7.7.1.m1.1.1.3.2.4" xref="S4.T3.7.7.7.1.m1.1.1.3.2.4.cmml">O</mi><mo id="S4.T3.7.7.7.1.m1.1.1.3.2.1b" xref="S4.T3.7.7.7.1.m1.1.1.3.2.1.cmml">⁢</mo><mtext id="S4.T3.7.7.7.1.m1.1.1.3.2.5" xref="S4.T3.7.7.7.1.m1.1.1.3.2.5a.cmml">vs</mtext><mo id="S4.T3.7.7.7.1.m1.1.1.3.2.1c" xref="S4.T3.7.7.7.1.m1.1.1.3.2.1.cmml">⁢</mo><mi id="S4.T3.7.7.7.1.m1.1.1.3.2.6" xref="S4.T3.7.7.7.1.m1.1.1.3.2.6.cmml">T</mi><mo id="S4.T3.7.7.7.1.m1.1.1.3.2.1d" xref="S4.T3.7.7.7.1.m1.1.1.3.2.1.cmml">⁢</mo><mi id="S4.T3.7.7.7.1.m1.1.1.3.2.7" xref="S4.T3.7.7.7.1.m1.1.1.3.2.7.cmml">I</mi><mo id="S4.T3.7.7.7.1.m1.1.1.3.2.1e" xref="S4.T3.7.7.7.1.m1.1.1.3.2.1.cmml">⁢</mo><mi id="S4.T3.7.7.7.1.m1.1.1.3.2.8" xref="S4.T3.7.7.7.1.m1.1.1.3.2.8.cmml">E</mi><mo id="S4.T3.7.7.7.1.m1.1.1.3.2.1f" xref="S4.T3.7.7.7.1.m1.1.1.3.2.1.cmml">⁢</mo><mi id="S4.T3.7.7.7.1.m1.1.1.3.2.9" xref="S4.T3.7.7.7.1.m1.1.1.3.2.9.cmml">S</mi></mrow><mo id="S4.T3.7.7.7.1.m1.1.1.3.1" xref="S4.T3.7.7.7.1.m1.1.1.3.1.cmml">+</mo><mrow id="S4.T3.7.7.7.1.m1.1.1.3.3" xref="S4.T3.7.7.7.1.m1.1.1.3.3.cmml"><mi id="S4.T3.7.7.7.1.m1.1.1.3.3.2" xref="S4.T3.7.7.7.1.m1.1.1.3.3.2.cmml">D</mi><mo id="S4.T3.7.7.7.1.m1.1.1.3.3.1" xref="S4.T3.7.7.7.1.m1.1.1.3.3.1.cmml">⁢</mo><mi id="S4.T3.7.7.7.1.m1.1.1.3.3.3" xref="S4.T3.7.7.7.1.m1.1.1.3.3.3.cmml">P</mi><mo id="S4.T3.7.7.7.1.m1.1.1.3.3.1a" xref="S4.T3.7.7.7.1.m1.1.1.3.3.1.cmml">⁢</mo><mi id="S4.T3.7.7.7.1.m1.1.1.3.3.4" xref="S4.T3.7.7.7.1.m1.1.1.3.3.4.cmml">O</mi></mrow></mrow></msub><annotation-xml encoding="MathML-Content" id="S4.T3.7.7.7.1.m1.1b"><apply id="S4.T3.7.7.7.1.m1.1.1.cmml" xref="S4.T3.7.7.7.1.m1.1.1"><csymbol cd="ambiguous" id="S4.T3.7.7.7.1.m1.1.1.1.cmml" xref="S4.T3.7.7.7.1.m1.1.1">subscript</csymbol><ci id="S4.T3.7.7.7.1.m1.1.1.2.cmml" xref="S4.T3.7.7.7.1.m1.1.1.2">Δ</ci><apply id="S4.T3.7.7.7.1.m1.1.1.3.cmml" xref="S4.T3.7.7.7.1.m1.1.1.3"><plus id="S4.T3.7.7.7.1.m1.1.1.3.1.cmml" xref="S4.T3.7.7.7.1.m1.1.1.3.1"></plus><apply id="S4.T3.7.7.7.1.m1.1.1.3.2.cmml" xref="S4.T3.7.7.7.1.m1.1.1.3.2"><times id="S4.T3.7.7.7.1.m1.1.1.3.2.1.cmml" xref="S4.T3.7.7.7.1.m1.1.1.3.2.1"></times><ci id="S4.T3.7.7.7.1.m1.1.1.3.2.2.cmml" xref="S4.T3.7.7.7.1.m1.1.1.3.2.2">𝐷</ci><ci id="S4.T3.7.7.7.1.m1.1.1.3.2.3.cmml" xref="S4.T3.7.7.7.1.m1.1.1.3.2.3">𝑃</ci><ci id="S4.T3.7.7.7.1.m1.1.1.3.2.4.cmml" xref="S4.T3.7.7.7.1.m1.1.1.3.2.4">𝑂</ci><ci id="S4.T3.7.7.7.1.m1.1.1.3.2.5a.cmml" xref="S4.T3.7.7.7.1.m1.1.1.3.2.5"><mtext id="S4.T3.7.7.7.1.m1.1.1.3.2.5.cmml" mathsize="70%" xref="S4.T3.7.7.7.1.m1.1.1.3.2.5">vs</mtext></ci><ci id="S4.T3.7.7.7.1.m1.1.1.3.2.6.cmml" xref="S4.T3.7.7.7.1.m1.1.1.3.2.6">𝑇</ci><ci id="S4.T3.7.7.7.1.m1.1.1.3.2.7.cmml" xref="S4.T3.7.7.7.1.m1.1.1.3.2.7">𝐼</ci><ci id="S4.T3.7.7.7.1.m1.1.1.3.2.8.cmml" xref="S4.T3.7.7.7.1.m1.1.1.3.2.8">𝐸</ci><ci id="S4.T3.7.7.7.1.m1.1.1.3.2.9.cmml" xref="S4.T3.7.7.7.1.m1.1.1.3.2.9">𝑆</ci></apply><apply id="S4.T3.7.7.7.1.m1.1.1.3.3.cmml" xref="S4.T3.7.7.7.1.m1.1.1.3.3"><times id="S4.T3.7.7.7.1.m1.1.1.3.3.1.cmml" xref="S4.T3.7.7.7.1.m1.1.1.3.3.1"></times><ci id="S4.T3.7.7.7.1.m1.1.1.3.3.2.cmml" xref="S4.T3.7.7.7.1.m1.1.1.3.3.2">𝐷</ci><ci id="S4.T3.7.7.7.1.m1.1.1.3.3.3.cmml" xref="S4.T3.7.7.7.1.m1.1.1.3.3.3">𝑃</ci><ci id="S4.T3.7.7.7.1.m1.1.1.3.3.4.cmml" xref="S4.T3.7.7.7.1.m1.1.1.3.3.4">𝑂</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.T3.7.7.7.1.m1.1c">\Delta_{DPO\text{vs}TIES+DPO}</annotation><annotation encoding="application/x-llamapun" id="S4.T3.7.7.7.1.m1.1d">roman_Δ start_POSTSUBSCRIPT italic_D italic_P italic_O vs italic_T italic_I italic_E italic_S + italic_D italic_P italic_O end_POSTSUBSCRIPT</annotation></semantics></math></td>
<td class="ltx_td ltx_align_center ltx_border_tt" id="S4.T3.7.7.7.2"><span class="ltx_text" id="S4.T3.7.7.7.2.1" style="color:#93C47D;">+74%</span></td>
<td class="ltx_td ltx_align_center ltx_border_tt" id="S4.T3.7.7.7.3"><span class="ltx_text" id="S4.T3.7.7.7.3.1" style="color:#93C47D;">+53%</span></td>
<td class="ltx_td ltx_align_center ltx_border_tt" id="S4.T3.7.7.7.4"><span class="ltx_text" id="S4.T3.7.7.7.4.1" style="color:#93C47D;">+74%</span></td>
<td class="ltx_td ltx_align_center ltx_border_tt" id="S4.T3.7.7.7.5"><span class="ltx_text" id="S4.T3.7.7.7.5.1" style="color:#93C47D;">+54%</span></td>
<td class="ltx_td ltx_align_center ltx_border_tt" id="S4.T3.7.7.7.6"><span class="ltx_text" id="S4.T3.7.7.7.6.1" style="color:#93C47D;">+51%</span></td>
<td class="ltx_td ltx_align_center ltx_border_tt" id="S4.T3.7.7.7.7"><span class="ltx_text" id="S4.T3.7.7.7.7.1" style="color:#93C47D;">+70%</span></td>
</tr>
<tr class="ltx_tr" id="S4.T3.8.8.8">
<td class="ltx_td ltx_align_center ltx_border_t" colspan="2" id="S4.T3.8.8.8.1"><math alttext="\Delta_{CPO\text{vs}SLERP+CPO}" class="ltx_Math" display="inline" id="S4.T3.8.8.8.1.m1.1"><semantics id="S4.T3.8.8.8.1.m1.1a"><msub id="S4.T3.8.8.8.1.m1.1.1" xref="S4.T3.8.8.8.1.m1.1.1.cmml"><mi id="S4.T3.8.8.8.1.m1.1.1.2" mathvariant="normal" xref="S4.T3.8.8.8.1.m1.1.1.2.cmml">Δ</mi><mrow id="S4.T3.8.8.8.1.m1.1.1.3" xref="S4.T3.8.8.8.1.m1.1.1.3.cmml"><mrow id="S4.T3.8.8.8.1.m1.1.1.3.2" xref="S4.T3.8.8.8.1.m1.1.1.3.2.cmml"><mi id="S4.T3.8.8.8.1.m1.1.1.3.2.2" xref="S4.T3.8.8.8.1.m1.1.1.3.2.2.cmml">C</mi><mo id="S4.T3.8.8.8.1.m1.1.1.3.2.1" xref="S4.T3.8.8.8.1.m1.1.1.3.2.1.cmml">⁢</mo><mi id="S4.T3.8.8.8.1.m1.1.1.3.2.3" xref="S4.T3.8.8.8.1.m1.1.1.3.2.3.cmml">P</mi><mo id="S4.T3.8.8.8.1.m1.1.1.3.2.1a" xref="S4.T3.8.8.8.1.m1.1.1.3.2.1.cmml">⁢</mo><mi id="S4.T3.8.8.8.1.m1.1.1.3.2.4" xref="S4.T3.8.8.8.1.m1.1.1.3.2.4.cmml">O</mi><mo id="S4.T3.8.8.8.1.m1.1.1.3.2.1b" xref="S4.T3.8.8.8.1.m1.1.1.3.2.1.cmml">⁢</mo><mtext id="S4.T3.8.8.8.1.m1.1.1.3.2.5" xref="S4.T3.8.8.8.1.m1.1.1.3.2.5a.cmml">vs</mtext><mo id="S4.T3.8.8.8.1.m1.1.1.3.2.1c" xref="S4.T3.8.8.8.1.m1.1.1.3.2.1.cmml">⁢</mo><mi id="S4.T3.8.8.8.1.m1.1.1.3.2.6" xref="S4.T3.8.8.8.1.m1.1.1.3.2.6.cmml">S</mi><mo id="S4.T3.8.8.8.1.m1.1.1.3.2.1d" xref="S4.T3.8.8.8.1.m1.1.1.3.2.1.cmml">⁢</mo><mi id="S4.T3.8.8.8.1.m1.1.1.3.2.7" xref="S4.T3.8.8.8.1.m1.1.1.3.2.7.cmml">L</mi><mo id="S4.T3.8.8.8.1.m1.1.1.3.2.1e" xref="S4.T3.8.8.8.1.m1.1.1.3.2.1.cmml">⁢</mo><mi id="S4.T3.8.8.8.1.m1.1.1.3.2.8" xref="S4.T3.8.8.8.1.m1.1.1.3.2.8.cmml">E</mi><mo id="S4.T3.8.8.8.1.m1.1.1.3.2.1f" xref="S4.T3.8.8.8.1.m1.1.1.3.2.1.cmml">⁢</mo><mi id="S4.T3.8.8.8.1.m1.1.1.3.2.9" xref="S4.T3.8.8.8.1.m1.1.1.3.2.9.cmml">R</mi><mo id="S4.T3.8.8.8.1.m1.1.1.3.2.1g" xref="S4.T3.8.8.8.1.m1.1.1.3.2.1.cmml">⁢</mo><mi id="S4.T3.8.8.8.1.m1.1.1.3.2.10" xref="S4.T3.8.8.8.1.m1.1.1.3.2.10.cmml">P</mi></mrow><mo id="S4.T3.8.8.8.1.m1.1.1.3.1" xref="S4.T3.8.8.8.1.m1.1.1.3.1.cmml">+</mo><mrow id="S4.T3.8.8.8.1.m1.1.1.3.3" xref="S4.T3.8.8.8.1.m1.1.1.3.3.cmml"><mi id="S4.T3.8.8.8.1.m1.1.1.3.3.2" xref="S4.T3.8.8.8.1.m1.1.1.3.3.2.cmml">C</mi><mo id="S4.T3.8.8.8.1.m1.1.1.3.3.1" xref="S4.T3.8.8.8.1.m1.1.1.3.3.1.cmml">⁢</mo><mi id="S4.T3.8.8.8.1.m1.1.1.3.3.3" xref="S4.T3.8.8.8.1.m1.1.1.3.3.3.cmml">P</mi><mo id="S4.T3.8.8.8.1.m1.1.1.3.3.1a" xref="S4.T3.8.8.8.1.m1.1.1.3.3.1.cmml">⁢</mo><mi id="S4.T3.8.8.8.1.m1.1.1.3.3.4" xref="S4.T3.8.8.8.1.m1.1.1.3.3.4.cmml">O</mi></mrow></mrow></msub><annotation-xml encoding="MathML-Content" id="S4.T3.8.8.8.1.m1.1b"><apply id="S4.T3.8.8.8.1.m1.1.1.cmml" xref="S4.T3.8.8.8.1.m1.1.1"><csymbol cd="ambiguous" id="S4.T3.8.8.8.1.m1.1.1.1.cmml" xref="S4.T3.8.8.8.1.m1.1.1">subscript</csymbol><ci id="S4.T3.8.8.8.1.m1.1.1.2.cmml" xref="S4.T3.8.8.8.1.m1.1.1.2">Δ</ci><apply id="S4.T3.8.8.8.1.m1.1.1.3.cmml" xref="S4.T3.8.8.8.1.m1.1.1.3"><plus id="S4.T3.8.8.8.1.m1.1.1.3.1.cmml" xref="S4.T3.8.8.8.1.m1.1.1.3.1"></plus><apply id="S4.T3.8.8.8.1.m1.1.1.3.2.cmml" xref="S4.T3.8.8.8.1.m1.1.1.3.2"><times id="S4.T3.8.8.8.1.m1.1.1.3.2.1.cmml" xref="S4.T3.8.8.8.1.m1.1.1.3.2.1"></times><ci id="S4.T3.8.8.8.1.m1.1.1.3.2.2.cmml" xref="S4.T3.8.8.8.1.m1.1.1.3.2.2">𝐶</ci><ci id="S4.T3.8.8.8.1.m1.1.1.3.2.3.cmml" xref="S4.T3.8.8.8.1.m1.1.1.3.2.3">𝑃</ci><ci id="S4.T3.8.8.8.1.m1.1.1.3.2.4.cmml" xref="S4.T3.8.8.8.1.m1.1.1.3.2.4">𝑂</ci><ci id="S4.T3.8.8.8.1.m1.1.1.3.2.5a.cmml" xref="S4.T3.8.8.8.1.m1.1.1.3.2.5"><mtext id="S4.T3.8.8.8.1.m1.1.1.3.2.5.cmml" mathsize="70%" xref="S4.T3.8.8.8.1.m1.1.1.3.2.5">vs</mtext></ci><ci id="S4.T3.8.8.8.1.m1.1.1.3.2.6.cmml" xref="S4.T3.8.8.8.1.m1.1.1.3.2.6">𝑆</ci><ci id="S4.T3.8.8.8.1.m1.1.1.3.2.7.cmml" xref="S4.T3.8.8.8.1.m1.1.1.3.2.7">𝐿</ci><ci id="S4.T3.8.8.8.1.m1.1.1.3.2.8.cmml" xref="S4.T3.8.8.8.1.m1.1.1.3.2.8">𝐸</ci><ci id="S4.T3.8.8.8.1.m1.1.1.3.2.9.cmml" xref="S4.T3.8.8.8.1.m1.1.1.3.2.9">𝑅</ci><ci id="S4.T3.8.8.8.1.m1.1.1.3.2.10.cmml" xref="S4.T3.8.8.8.1.m1.1.1.3.2.10">𝑃</ci></apply><apply id="S4.T3.8.8.8.1.m1.1.1.3.3.cmml" xref="S4.T3.8.8.8.1.m1.1.1.3.3"><times id="S4.T3.8.8.8.1.m1.1.1.3.3.1.cmml" xref="S4.T3.8.8.8.1.m1.1.1.3.3.1"></times><ci id="S4.T3.8.8.8.1.m1.1.1.3.3.2.cmml" xref="S4.T3.8.8.8.1.m1.1.1.3.3.2">𝐶</ci><ci id="S4.T3.8.8.8.1.m1.1.1.3.3.3.cmml" xref="S4.T3.8.8.8.1.m1.1.1.3.3.3">𝑃</ci><ci id="S4.T3.8.8.8.1.m1.1.1.3.3.4.cmml" xref="S4.T3.8.8.8.1.m1.1.1.3.3.4">𝑂</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.T3.8.8.8.1.m1.1c">\Delta_{CPO\text{vs}SLERP+CPO}</annotation><annotation encoding="application/x-llamapun" id="S4.T3.8.8.8.1.m1.1d">roman_Δ start_POSTSUBSCRIPT italic_C italic_P italic_O vs italic_S italic_L italic_E italic_R italic_P + italic_C italic_P italic_O end_POSTSUBSCRIPT</annotation></semantics></math></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T3.8.8.8.2"><span class="ltx_text" id="S4.T3.8.8.8.2.1" style="color:#93C47D;">+11%</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T3.8.8.8.3"><span class="ltx_text" id="S4.T3.8.8.8.3.1" style="color:#93C47D;">+8%</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T3.8.8.8.4"><span class="ltx_text" id="S4.T3.8.8.8.4.1" style="color:#93C47D;">+8%</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T3.8.8.8.5"><span class="ltx_text" id="S4.T3.8.8.8.5.1" style="color:#93C47D;">+6%</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T3.8.8.8.6"><span class="ltx_text" id="S4.T3.8.8.8.6.1" style="color:#93C47D;">+5%</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T3.8.8.8.7"><span class="ltx_text" id="S4.T3.8.8.8.7.1" style="color:#93C47D;">+9%</span></td>
</tr>
<tr class="ltx_tr" id="S4.T3.9.9.9">
<td class="ltx_td ltx_align_center ltx_border_bb ltx_border_t" colspan="2" id="S4.T3.9.9.9.1"><math alttext="\Delta_{MED\text{vs}SLERP+CPO}" class="ltx_Math" display="inline" id="S4.T3.9.9.9.1.m1.1"><semantics id="S4.T3.9.9.9.1.m1.1a"><msub id="S4.T3.9.9.9.1.m1.1.1" xref="S4.T3.9.9.9.1.m1.1.1.cmml"><mi id="S4.T3.9.9.9.1.m1.1.1.2" mathvariant="normal" xref="S4.T3.9.9.9.1.m1.1.1.2.cmml">Δ</mi><mrow id="S4.T3.9.9.9.1.m1.1.1.3" xref="S4.T3.9.9.9.1.m1.1.1.3.cmml"><mrow id="S4.T3.9.9.9.1.m1.1.1.3.2" xref="S4.T3.9.9.9.1.m1.1.1.3.2.cmml"><mi id="S4.T3.9.9.9.1.m1.1.1.3.2.2" xref="S4.T3.9.9.9.1.m1.1.1.3.2.2.cmml">M</mi><mo id="S4.T3.9.9.9.1.m1.1.1.3.2.1" xref="S4.T3.9.9.9.1.m1.1.1.3.2.1.cmml">⁢</mo><mi id="S4.T3.9.9.9.1.m1.1.1.3.2.3" xref="S4.T3.9.9.9.1.m1.1.1.3.2.3.cmml">E</mi><mo id="S4.T3.9.9.9.1.m1.1.1.3.2.1a" xref="S4.T3.9.9.9.1.m1.1.1.3.2.1.cmml">⁢</mo><mi id="S4.T3.9.9.9.1.m1.1.1.3.2.4" xref="S4.T3.9.9.9.1.m1.1.1.3.2.4.cmml">D</mi><mo id="S4.T3.9.9.9.1.m1.1.1.3.2.1b" xref="S4.T3.9.9.9.1.m1.1.1.3.2.1.cmml">⁢</mo><mtext id="S4.T3.9.9.9.1.m1.1.1.3.2.5" xref="S4.T3.9.9.9.1.m1.1.1.3.2.5a.cmml">vs</mtext><mo id="S4.T3.9.9.9.1.m1.1.1.3.2.1c" xref="S4.T3.9.9.9.1.m1.1.1.3.2.1.cmml">⁢</mo><mi id="S4.T3.9.9.9.1.m1.1.1.3.2.6" xref="S4.T3.9.9.9.1.m1.1.1.3.2.6.cmml">S</mi><mo id="S4.T3.9.9.9.1.m1.1.1.3.2.1d" xref="S4.T3.9.9.9.1.m1.1.1.3.2.1.cmml">⁢</mo><mi id="S4.T3.9.9.9.1.m1.1.1.3.2.7" xref="S4.T3.9.9.9.1.m1.1.1.3.2.7.cmml">L</mi><mo id="S4.T3.9.9.9.1.m1.1.1.3.2.1e" xref="S4.T3.9.9.9.1.m1.1.1.3.2.1.cmml">⁢</mo><mi id="S4.T3.9.9.9.1.m1.1.1.3.2.8" xref="S4.T3.9.9.9.1.m1.1.1.3.2.8.cmml">E</mi><mo id="S4.T3.9.9.9.1.m1.1.1.3.2.1f" xref="S4.T3.9.9.9.1.m1.1.1.3.2.1.cmml">⁢</mo><mi id="S4.T3.9.9.9.1.m1.1.1.3.2.9" xref="S4.T3.9.9.9.1.m1.1.1.3.2.9.cmml">R</mi><mo id="S4.T3.9.9.9.1.m1.1.1.3.2.1g" xref="S4.T3.9.9.9.1.m1.1.1.3.2.1.cmml">⁢</mo><mi id="S4.T3.9.9.9.1.m1.1.1.3.2.10" xref="S4.T3.9.9.9.1.m1.1.1.3.2.10.cmml">P</mi></mrow><mo id="S4.T3.9.9.9.1.m1.1.1.3.1" xref="S4.T3.9.9.9.1.m1.1.1.3.1.cmml">+</mo><mrow id="S4.T3.9.9.9.1.m1.1.1.3.3" xref="S4.T3.9.9.9.1.m1.1.1.3.3.cmml"><mi id="S4.T3.9.9.9.1.m1.1.1.3.3.2" xref="S4.T3.9.9.9.1.m1.1.1.3.3.2.cmml">C</mi><mo id="S4.T3.9.9.9.1.m1.1.1.3.3.1" xref="S4.T3.9.9.9.1.m1.1.1.3.3.1.cmml">⁢</mo><mi id="S4.T3.9.9.9.1.m1.1.1.3.3.3" xref="S4.T3.9.9.9.1.m1.1.1.3.3.3.cmml">P</mi><mo id="S4.T3.9.9.9.1.m1.1.1.3.3.1a" xref="S4.T3.9.9.9.1.m1.1.1.3.3.1.cmml">⁢</mo><mi id="S4.T3.9.9.9.1.m1.1.1.3.3.4" xref="S4.T3.9.9.9.1.m1.1.1.3.3.4.cmml">O</mi></mrow></mrow></msub><annotation-xml encoding="MathML-Content" id="S4.T3.9.9.9.1.m1.1b"><apply id="S4.T3.9.9.9.1.m1.1.1.cmml" xref="S4.T3.9.9.9.1.m1.1.1"><csymbol cd="ambiguous" id="S4.T3.9.9.9.1.m1.1.1.1.cmml" xref="S4.T3.9.9.9.1.m1.1.1">subscript</csymbol><ci id="S4.T3.9.9.9.1.m1.1.1.2.cmml" xref="S4.T3.9.9.9.1.m1.1.1.2">Δ</ci><apply id="S4.T3.9.9.9.1.m1.1.1.3.cmml" xref="S4.T3.9.9.9.1.m1.1.1.3"><plus id="S4.T3.9.9.9.1.m1.1.1.3.1.cmml" xref="S4.T3.9.9.9.1.m1.1.1.3.1"></plus><apply id="S4.T3.9.9.9.1.m1.1.1.3.2.cmml" xref="S4.T3.9.9.9.1.m1.1.1.3.2"><times id="S4.T3.9.9.9.1.m1.1.1.3.2.1.cmml" xref="S4.T3.9.9.9.1.m1.1.1.3.2.1"></times><ci id="S4.T3.9.9.9.1.m1.1.1.3.2.2.cmml" xref="S4.T3.9.9.9.1.m1.1.1.3.2.2">𝑀</ci><ci id="S4.T3.9.9.9.1.m1.1.1.3.2.3.cmml" xref="S4.T3.9.9.9.1.m1.1.1.3.2.3">𝐸</ci><ci id="S4.T3.9.9.9.1.m1.1.1.3.2.4.cmml" xref="S4.T3.9.9.9.1.m1.1.1.3.2.4">𝐷</ci><ci id="S4.T3.9.9.9.1.m1.1.1.3.2.5a.cmml" xref="S4.T3.9.9.9.1.m1.1.1.3.2.5"><mtext id="S4.T3.9.9.9.1.m1.1.1.3.2.5.cmml" mathsize="70%" xref="S4.T3.9.9.9.1.m1.1.1.3.2.5">vs</mtext></ci><ci id="S4.T3.9.9.9.1.m1.1.1.3.2.6.cmml" xref="S4.T3.9.9.9.1.m1.1.1.3.2.6">𝑆</ci><ci id="S4.T3.9.9.9.1.m1.1.1.3.2.7.cmml" xref="S4.T3.9.9.9.1.m1.1.1.3.2.7">𝐿</ci><ci id="S4.T3.9.9.9.1.m1.1.1.3.2.8.cmml" xref="S4.T3.9.9.9.1.m1.1.1.3.2.8">𝐸</ci><ci id="S4.T3.9.9.9.1.m1.1.1.3.2.9.cmml" xref="S4.T3.9.9.9.1.m1.1.1.3.2.9">𝑅</ci><ci id="S4.T3.9.9.9.1.m1.1.1.3.2.10.cmml" xref="S4.T3.9.9.9.1.m1.1.1.3.2.10">𝑃</ci></apply><apply id="S4.T3.9.9.9.1.m1.1.1.3.3.cmml" xref="S4.T3.9.9.9.1.m1.1.1.3.3"><times id="S4.T3.9.9.9.1.m1.1.1.3.3.1.cmml" xref="S4.T3.9.9.9.1.m1.1.1.3.3.1"></times><ci id="S4.T3.9.9.9.1.m1.1.1.3.3.2.cmml" xref="S4.T3.9.9.9.1.m1.1.1.3.3.2">𝐶</ci><ci id="S4.T3.9.9.9.1.m1.1.1.3.3.3.cmml" xref="S4.T3.9.9.9.1.m1.1.1.3.3.3">𝑃</ci><ci id="S4.T3.9.9.9.1.m1.1.1.3.3.4.cmml" xref="S4.T3.9.9.9.1.m1.1.1.3.3.4">𝑂</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.T3.9.9.9.1.m1.1c">\Delta_{MED\text{vs}SLERP+CPO}</annotation><annotation encoding="application/x-llamapun" id="S4.T3.9.9.9.1.m1.1d">roman_Δ start_POSTSUBSCRIPT italic_M italic_E italic_D vs italic_S italic_L italic_E italic_R italic_P + italic_C italic_P italic_O end_POSTSUBSCRIPT</annotation></semantics></math></td>
<td class="ltx_td ltx_align_center ltx_border_bb ltx_border_t" id="S4.T3.9.9.9.2"><span class="ltx_text" id="S4.T3.9.9.9.2.1" style="color:#93C47D;">+31%</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb ltx_border_t" id="S4.T3.9.9.9.3"><span class="ltx_text" id="S4.T3.9.9.9.3.1" style="color:#93C47D;">+28%</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb ltx_border_t" id="S4.T3.9.9.9.4"><span class="ltx_text" id="S4.T3.9.9.9.4.1" style="color:#93C47D;">+13%</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb ltx_border_t" id="S4.T3.9.9.9.5"><span class="ltx_text" id="S4.T3.9.9.9.5.1" style="color:#93C47D;">+9%</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb ltx_border_t" id="S4.T3.9.9.9.6"><span class="ltx_text" id="S4.T3.9.9.9.6.1" style="color:#93C47D;">+4%</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb ltx_border_t" id="S4.T3.9.9.9.7"><span class="ltx_text" id="S4.T3.9.9.9.7.1" style="color:#93C47D;">+17%</span></td>
</tr>
</table>
</span></div>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table">Table 3: </span>Mixed Cross-Modals Fusion Results in Molecule-to-Language Translation. Best combined approaches are highlighted in bold. <math alttext="\Delta_{DPO\text{vs}TIES+DPO}" class="ltx_Math" display="inline" id="S4.T3.13.m1.1"><semantics id="S4.T3.13.m1.1b"><msub id="S4.T3.13.m1.1.1" xref="S4.T3.13.m1.1.1.cmml"><mi id="S4.T3.13.m1.1.1.2" mathvariant="normal" xref="S4.T3.13.m1.1.1.2.cmml">Δ</mi><mrow id="S4.T3.13.m1.1.1.3" xref="S4.T3.13.m1.1.1.3.cmml"><mrow id="S4.T3.13.m1.1.1.3.2" xref="S4.T3.13.m1.1.1.3.2.cmml"><mi id="S4.T3.13.m1.1.1.3.2.2" xref="S4.T3.13.m1.1.1.3.2.2.cmml">D</mi><mo id="S4.T3.13.m1.1.1.3.2.1" xref="S4.T3.13.m1.1.1.3.2.1.cmml">⁢</mo><mi id="S4.T3.13.m1.1.1.3.2.3" xref="S4.T3.13.m1.1.1.3.2.3.cmml">P</mi><mo id="S4.T3.13.m1.1.1.3.2.1b" xref="S4.T3.13.m1.1.1.3.2.1.cmml">⁢</mo><mi id="S4.T3.13.m1.1.1.3.2.4" xref="S4.T3.13.m1.1.1.3.2.4.cmml">O</mi><mo id="S4.T3.13.m1.1.1.3.2.1c" xref="S4.T3.13.m1.1.1.3.2.1.cmml">⁢</mo><mtext id="S4.T3.13.m1.1.1.3.2.5" xref="S4.T3.13.m1.1.1.3.2.5a.cmml">vs</mtext><mo id="S4.T3.13.m1.1.1.3.2.1d" xref="S4.T3.13.m1.1.1.3.2.1.cmml">⁢</mo><mi id="S4.T3.13.m1.1.1.3.2.6" xref="S4.T3.13.m1.1.1.3.2.6.cmml">T</mi><mo id="S4.T3.13.m1.1.1.3.2.1e" xref="S4.T3.13.m1.1.1.3.2.1.cmml">⁢</mo><mi id="S4.T3.13.m1.1.1.3.2.7" xref="S4.T3.13.m1.1.1.3.2.7.cmml">I</mi><mo id="S4.T3.13.m1.1.1.3.2.1f" xref="S4.T3.13.m1.1.1.3.2.1.cmml">⁢</mo><mi id="S4.T3.13.m1.1.1.3.2.8" xref="S4.T3.13.m1.1.1.3.2.8.cmml">E</mi><mo id="S4.T3.13.m1.1.1.3.2.1g" xref="S4.T3.13.m1.1.1.3.2.1.cmml">⁢</mo><mi id="S4.T3.13.m1.1.1.3.2.9" xref="S4.T3.13.m1.1.1.3.2.9.cmml">S</mi></mrow><mo id="S4.T3.13.m1.1.1.3.1" xref="S4.T3.13.m1.1.1.3.1.cmml">+</mo><mrow id="S4.T3.13.m1.1.1.3.3" xref="S4.T3.13.m1.1.1.3.3.cmml"><mi id="S4.T3.13.m1.1.1.3.3.2" xref="S4.T3.13.m1.1.1.3.3.2.cmml">D</mi><mo id="S4.T3.13.m1.1.1.3.3.1" xref="S4.T3.13.m1.1.1.3.3.1.cmml">⁢</mo><mi id="S4.T3.13.m1.1.1.3.3.3" xref="S4.T3.13.m1.1.1.3.3.3.cmml">P</mi><mo id="S4.T3.13.m1.1.1.3.3.1b" xref="S4.T3.13.m1.1.1.3.3.1.cmml">⁢</mo><mi id="S4.T3.13.m1.1.1.3.3.4" xref="S4.T3.13.m1.1.1.3.3.4.cmml">O</mi></mrow></mrow></msub><annotation-xml encoding="MathML-Content" id="S4.T3.13.m1.1c"><apply id="S4.T3.13.m1.1.1.cmml" xref="S4.T3.13.m1.1.1"><csymbol cd="ambiguous" id="S4.T3.13.m1.1.1.1.cmml" xref="S4.T3.13.m1.1.1">subscript</csymbol><ci id="S4.T3.13.m1.1.1.2.cmml" xref="S4.T3.13.m1.1.1.2">Δ</ci><apply id="S4.T3.13.m1.1.1.3.cmml" xref="S4.T3.13.m1.1.1.3"><plus id="S4.T3.13.m1.1.1.3.1.cmml" xref="S4.T3.13.m1.1.1.3.1"></plus><apply id="S4.T3.13.m1.1.1.3.2.cmml" xref="S4.T3.13.m1.1.1.3.2"><times id="S4.T3.13.m1.1.1.3.2.1.cmml" xref="S4.T3.13.m1.1.1.3.2.1"></times><ci id="S4.T3.13.m1.1.1.3.2.2.cmml" xref="S4.T3.13.m1.1.1.3.2.2">𝐷</ci><ci id="S4.T3.13.m1.1.1.3.2.3.cmml" xref="S4.T3.13.m1.1.1.3.2.3">𝑃</ci><ci id="S4.T3.13.m1.1.1.3.2.4.cmml" xref="S4.T3.13.m1.1.1.3.2.4">𝑂</ci><ci id="S4.T3.13.m1.1.1.3.2.5a.cmml" xref="S4.T3.13.m1.1.1.3.2.5"><mtext id="S4.T3.13.m1.1.1.3.2.5.cmml" mathsize="70%" xref="S4.T3.13.m1.1.1.3.2.5">vs</mtext></ci><ci id="S4.T3.13.m1.1.1.3.2.6.cmml" xref="S4.T3.13.m1.1.1.3.2.6">𝑇</ci><ci id="S4.T3.13.m1.1.1.3.2.7.cmml" xref="S4.T3.13.m1.1.1.3.2.7">𝐼</ci><ci id="S4.T3.13.m1.1.1.3.2.8.cmml" xref="S4.T3.13.m1.1.1.3.2.8">𝐸</ci><ci id="S4.T3.13.m1.1.1.3.2.9.cmml" xref="S4.T3.13.m1.1.1.3.2.9">𝑆</ci></apply><apply id="S4.T3.13.m1.1.1.3.3.cmml" xref="S4.T3.13.m1.1.1.3.3"><times id="S4.T3.13.m1.1.1.3.3.1.cmml" xref="S4.T3.13.m1.1.1.3.3.1"></times><ci id="S4.T3.13.m1.1.1.3.3.2.cmml" xref="S4.T3.13.m1.1.1.3.3.2">𝐷</ci><ci id="S4.T3.13.m1.1.1.3.3.3.cmml" xref="S4.T3.13.m1.1.1.3.3.3">𝑃</ci><ci id="S4.T3.13.m1.1.1.3.3.4.cmml" xref="S4.T3.13.m1.1.1.3.3.4">𝑂</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.T3.13.m1.1d">\Delta_{DPO\text{vs}TIES+DPO}</annotation><annotation encoding="application/x-llamapun" id="S4.T3.13.m1.1e">roman_Δ start_POSTSUBSCRIPT italic_D italic_P italic_O vs italic_T italic_I italic_E italic_S + italic_D italic_P italic_O end_POSTSUBSCRIPT</annotation></semantics></math>, <math alttext="\Delta_{CPO\text{vs}SLERP+CPO}" class="ltx_Math" display="inline" id="S4.T3.14.m2.1"><semantics id="S4.T3.14.m2.1b"><msub id="S4.T3.14.m2.1.1" xref="S4.T3.14.m2.1.1.cmml"><mi id="S4.T3.14.m2.1.1.2" mathvariant="normal" xref="S4.T3.14.m2.1.1.2.cmml">Δ</mi><mrow id="S4.T3.14.m2.1.1.3" xref="S4.T3.14.m2.1.1.3.cmml"><mrow id="S4.T3.14.m2.1.1.3.2" xref="S4.T3.14.m2.1.1.3.2.cmml"><mi id="S4.T3.14.m2.1.1.3.2.2" xref="S4.T3.14.m2.1.1.3.2.2.cmml">C</mi><mo id="S4.T3.14.m2.1.1.3.2.1" xref="S4.T3.14.m2.1.1.3.2.1.cmml">⁢</mo><mi id="S4.T3.14.m2.1.1.3.2.3" xref="S4.T3.14.m2.1.1.3.2.3.cmml">P</mi><mo id="S4.T3.14.m2.1.1.3.2.1b" xref="S4.T3.14.m2.1.1.3.2.1.cmml">⁢</mo><mi id="S4.T3.14.m2.1.1.3.2.4" xref="S4.T3.14.m2.1.1.3.2.4.cmml">O</mi><mo id="S4.T3.14.m2.1.1.3.2.1c" xref="S4.T3.14.m2.1.1.3.2.1.cmml">⁢</mo><mtext id="S4.T3.14.m2.1.1.3.2.5" xref="S4.T3.14.m2.1.1.3.2.5a.cmml">vs</mtext><mo id="S4.T3.14.m2.1.1.3.2.1d" xref="S4.T3.14.m2.1.1.3.2.1.cmml">⁢</mo><mi id="S4.T3.14.m2.1.1.3.2.6" xref="S4.T3.14.m2.1.1.3.2.6.cmml">S</mi><mo id="S4.T3.14.m2.1.1.3.2.1e" xref="S4.T3.14.m2.1.1.3.2.1.cmml">⁢</mo><mi id="S4.T3.14.m2.1.1.3.2.7" xref="S4.T3.14.m2.1.1.3.2.7.cmml">L</mi><mo id="S4.T3.14.m2.1.1.3.2.1f" xref="S4.T3.14.m2.1.1.3.2.1.cmml">⁢</mo><mi id="S4.T3.14.m2.1.1.3.2.8" xref="S4.T3.14.m2.1.1.3.2.8.cmml">E</mi><mo id="S4.T3.14.m2.1.1.3.2.1g" xref="S4.T3.14.m2.1.1.3.2.1.cmml">⁢</mo><mi id="S4.T3.14.m2.1.1.3.2.9" xref="S4.T3.14.m2.1.1.3.2.9.cmml">R</mi><mo id="S4.T3.14.m2.1.1.3.2.1h" xref="S4.T3.14.m2.1.1.3.2.1.cmml">⁢</mo><mi id="S4.T3.14.m2.1.1.3.2.10" xref="S4.T3.14.m2.1.1.3.2.10.cmml">P</mi></mrow><mo id="S4.T3.14.m2.1.1.3.1" xref="S4.T3.14.m2.1.1.3.1.cmml">+</mo><mrow id="S4.T3.14.m2.1.1.3.3" xref="S4.T3.14.m2.1.1.3.3.cmml"><mi id="S4.T3.14.m2.1.1.3.3.2" xref="S4.T3.14.m2.1.1.3.3.2.cmml">C</mi><mo id="S4.T3.14.m2.1.1.3.3.1" xref="S4.T3.14.m2.1.1.3.3.1.cmml">⁢</mo><mi id="S4.T3.14.m2.1.1.3.3.3" xref="S4.T3.14.m2.1.1.3.3.3.cmml">P</mi><mo id="S4.T3.14.m2.1.1.3.3.1b" xref="S4.T3.14.m2.1.1.3.3.1.cmml">⁢</mo><mi id="S4.T3.14.m2.1.1.3.3.4" xref="S4.T3.14.m2.1.1.3.3.4.cmml">O</mi></mrow></mrow></msub><annotation-xml encoding="MathML-Content" id="S4.T3.14.m2.1c"><apply id="S4.T3.14.m2.1.1.cmml" xref="S4.T3.14.m2.1.1"><csymbol cd="ambiguous" id="S4.T3.14.m2.1.1.1.cmml" xref="S4.T3.14.m2.1.1">subscript</csymbol><ci id="S4.T3.14.m2.1.1.2.cmml" xref="S4.T3.14.m2.1.1.2">Δ</ci><apply id="S4.T3.14.m2.1.1.3.cmml" xref="S4.T3.14.m2.1.1.3"><plus id="S4.T3.14.m2.1.1.3.1.cmml" xref="S4.T3.14.m2.1.1.3.1"></plus><apply id="S4.T3.14.m2.1.1.3.2.cmml" xref="S4.T3.14.m2.1.1.3.2"><times id="S4.T3.14.m2.1.1.3.2.1.cmml" xref="S4.T3.14.m2.1.1.3.2.1"></times><ci id="S4.T3.14.m2.1.1.3.2.2.cmml" xref="S4.T3.14.m2.1.1.3.2.2">𝐶</ci><ci id="S4.T3.14.m2.1.1.3.2.3.cmml" xref="S4.T3.14.m2.1.1.3.2.3">𝑃</ci><ci id="S4.T3.14.m2.1.1.3.2.4.cmml" xref="S4.T3.14.m2.1.1.3.2.4">𝑂</ci><ci id="S4.T3.14.m2.1.1.3.2.5a.cmml" xref="S4.T3.14.m2.1.1.3.2.5"><mtext id="S4.T3.14.m2.1.1.3.2.5.cmml" mathsize="70%" xref="S4.T3.14.m2.1.1.3.2.5">vs</mtext></ci><ci id="S4.T3.14.m2.1.1.3.2.6.cmml" xref="S4.T3.14.m2.1.1.3.2.6">𝑆</ci><ci id="S4.T3.14.m2.1.1.3.2.7.cmml" xref="S4.T3.14.m2.1.1.3.2.7">𝐿</ci><ci id="S4.T3.14.m2.1.1.3.2.8.cmml" xref="S4.T3.14.m2.1.1.3.2.8">𝐸</ci><ci id="S4.T3.14.m2.1.1.3.2.9.cmml" xref="S4.T3.14.m2.1.1.3.2.9">𝑅</ci><ci id="S4.T3.14.m2.1.1.3.2.10.cmml" xref="S4.T3.14.m2.1.1.3.2.10">𝑃</ci></apply><apply id="S4.T3.14.m2.1.1.3.3.cmml" xref="S4.T3.14.m2.1.1.3.3"><times id="S4.T3.14.m2.1.1.3.3.1.cmml" xref="S4.T3.14.m2.1.1.3.3.1"></times><ci id="S4.T3.14.m2.1.1.3.3.2.cmml" xref="S4.T3.14.m2.1.1.3.3.2">𝐶</ci><ci id="S4.T3.14.m2.1.1.3.3.3.cmml" xref="S4.T3.14.m2.1.1.3.3.3">𝑃</ci><ci id="S4.T3.14.m2.1.1.3.3.4.cmml" xref="S4.T3.14.m2.1.1.3.3.4">𝑂</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.T3.14.m2.1d">\Delta_{CPO\text{vs}SLERP+CPO}</annotation><annotation encoding="application/x-llamapun" id="S4.T3.14.m2.1e">roman_Δ start_POSTSUBSCRIPT italic_C italic_P italic_O vs italic_S italic_L italic_E italic_R italic_P + italic_C italic_P italic_O end_POSTSUBSCRIPT</annotation></semantics></math>, and <math alttext="\Delta_{MED\text{vs}SLERP+CPO}" class="ltx_Math" display="inline" id="S4.T3.15.m3.1"><semantics id="S4.T3.15.m3.1b"><msub id="S4.T3.15.m3.1.1" xref="S4.T3.15.m3.1.1.cmml"><mi id="S4.T3.15.m3.1.1.2" mathvariant="normal" xref="S4.T3.15.m3.1.1.2.cmml">Δ</mi><mrow id="S4.T3.15.m3.1.1.3" xref="S4.T3.15.m3.1.1.3.cmml"><mrow id="S4.T3.15.m3.1.1.3.2" xref="S4.T3.15.m3.1.1.3.2.cmml"><mi id="S4.T3.15.m3.1.1.3.2.2" xref="S4.T3.15.m3.1.1.3.2.2.cmml">M</mi><mo id="S4.T3.15.m3.1.1.3.2.1" xref="S4.T3.15.m3.1.1.3.2.1.cmml">⁢</mo><mi id="S4.T3.15.m3.1.1.3.2.3" xref="S4.T3.15.m3.1.1.3.2.3.cmml">E</mi><mo id="S4.T3.15.m3.1.1.3.2.1b" xref="S4.T3.15.m3.1.1.3.2.1.cmml">⁢</mo><mi id="S4.T3.15.m3.1.1.3.2.4" xref="S4.T3.15.m3.1.1.3.2.4.cmml">D</mi><mo id="S4.T3.15.m3.1.1.3.2.1c" xref="S4.T3.15.m3.1.1.3.2.1.cmml">⁢</mo><mtext id="S4.T3.15.m3.1.1.3.2.5" xref="S4.T3.15.m3.1.1.3.2.5a.cmml">vs</mtext><mo id="S4.T3.15.m3.1.1.3.2.1d" xref="S4.T3.15.m3.1.1.3.2.1.cmml">⁢</mo><mi id="S4.T3.15.m3.1.1.3.2.6" xref="S4.T3.15.m3.1.1.3.2.6.cmml">S</mi><mo id="S4.T3.15.m3.1.1.3.2.1e" xref="S4.T3.15.m3.1.1.3.2.1.cmml">⁢</mo><mi id="S4.T3.15.m3.1.1.3.2.7" xref="S4.T3.15.m3.1.1.3.2.7.cmml">L</mi><mo id="S4.T3.15.m3.1.1.3.2.1f" xref="S4.T3.15.m3.1.1.3.2.1.cmml">⁢</mo><mi id="S4.T3.15.m3.1.1.3.2.8" xref="S4.T3.15.m3.1.1.3.2.8.cmml">E</mi><mo id="S4.T3.15.m3.1.1.3.2.1g" xref="S4.T3.15.m3.1.1.3.2.1.cmml">⁢</mo><mi id="S4.T3.15.m3.1.1.3.2.9" xref="S4.T3.15.m3.1.1.3.2.9.cmml">R</mi><mo id="S4.T3.15.m3.1.1.3.2.1h" xref="S4.T3.15.m3.1.1.3.2.1.cmml">⁢</mo><mi id="S4.T3.15.m3.1.1.3.2.10" xref="S4.T3.15.m3.1.1.3.2.10.cmml">P</mi></mrow><mo id="S4.T3.15.m3.1.1.3.1" xref="S4.T3.15.m3.1.1.3.1.cmml">+</mo><mrow id="S4.T3.15.m3.1.1.3.3" xref="S4.T3.15.m3.1.1.3.3.cmml"><mi id="S4.T3.15.m3.1.1.3.3.2" xref="S4.T3.15.m3.1.1.3.3.2.cmml">C</mi><mo id="S4.T3.15.m3.1.1.3.3.1" xref="S4.T3.15.m3.1.1.3.3.1.cmml">⁢</mo><mi id="S4.T3.15.m3.1.1.3.3.3" xref="S4.T3.15.m3.1.1.3.3.3.cmml">P</mi><mo id="S4.T3.15.m3.1.1.3.3.1b" xref="S4.T3.15.m3.1.1.3.3.1.cmml">⁢</mo><mi id="S4.T3.15.m3.1.1.3.3.4" xref="S4.T3.15.m3.1.1.3.3.4.cmml">O</mi></mrow></mrow></msub><annotation-xml encoding="MathML-Content" id="S4.T3.15.m3.1c"><apply id="S4.T3.15.m3.1.1.cmml" xref="S4.T3.15.m3.1.1"><csymbol cd="ambiguous" id="S4.T3.15.m3.1.1.1.cmml" xref="S4.T3.15.m3.1.1">subscript</csymbol><ci id="S4.T3.15.m3.1.1.2.cmml" xref="S4.T3.15.m3.1.1.2">Δ</ci><apply id="S4.T3.15.m3.1.1.3.cmml" xref="S4.T3.15.m3.1.1.3"><plus id="S4.T3.15.m3.1.1.3.1.cmml" xref="S4.T3.15.m3.1.1.3.1"></plus><apply id="S4.T3.15.m3.1.1.3.2.cmml" xref="S4.T3.15.m3.1.1.3.2"><times id="S4.T3.15.m3.1.1.3.2.1.cmml" xref="S4.T3.15.m3.1.1.3.2.1"></times><ci id="S4.T3.15.m3.1.1.3.2.2.cmml" xref="S4.T3.15.m3.1.1.3.2.2">𝑀</ci><ci id="S4.T3.15.m3.1.1.3.2.3.cmml" xref="S4.T3.15.m3.1.1.3.2.3">𝐸</ci><ci id="S4.T3.15.m3.1.1.3.2.4.cmml" xref="S4.T3.15.m3.1.1.3.2.4">𝐷</ci><ci id="S4.T3.15.m3.1.1.3.2.5a.cmml" xref="S4.T3.15.m3.1.1.3.2.5"><mtext id="S4.T3.15.m3.1.1.3.2.5.cmml" mathsize="70%" xref="S4.T3.15.m3.1.1.3.2.5">vs</mtext></ci><ci id="S4.T3.15.m3.1.1.3.2.6.cmml" xref="S4.T3.15.m3.1.1.3.2.6">𝑆</ci><ci id="S4.T3.15.m3.1.1.3.2.7.cmml" xref="S4.T3.15.m3.1.1.3.2.7">𝐿</ci><ci id="S4.T3.15.m3.1.1.3.2.8.cmml" xref="S4.T3.15.m3.1.1.3.2.8">𝐸</ci><ci id="S4.T3.15.m3.1.1.3.2.9.cmml" xref="S4.T3.15.m3.1.1.3.2.9">𝑅</ci><ci id="S4.T3.15.m3.1.1.3.2.10.cmml" xref="S4.T3.15.m3.1.1.3.2.10">𝑃</ci></apply><apply id="S4.T3.15.m3.1.1.3.3.cmml" xref="S4.T3.15.m3.1.1.3.3"><times id="S4.T3.15.m3.1.1.3.3.1.cmml" xref="S4.T3.15.m3.1.1.3.3.1"></times><ci id="S4.T3.15.m3.1.1.3.3.2.cmml" xref="S4.T3.15.m3.1.1.3.3.2">𝐶</ci><ci id="S4.T3.15.m3.1.1.3.3.3.cmml" xref="S4.T3.15.m3.1.1.3.3.3">𝑃</ci><ci id="S4.T3.15.m3.1.1.3.3.4.cmml" xref="S4.T3.15.m3.1.1.3.3.4">𝑂</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.T3.15.m3.1d">\Delta_{MED\text{vs}SLERP+CPO}</annotation><annotation encoding="application/x-llamapun" id="S4.T3.15.m3.1e">roman_Δ start_POSTSUBSCRIPT italic_M italic_E italic_D vs italic_S italic_L italic_E italic_R italic_P + italic_C italic_P italic_O end_POSTSUBSCRIPT</annotation></semantics></math> measure performance gains of the best-combined approaches from the singular cross-modal setting of <span class="ltx_text ltx_font_italic" id="S4.T3.19.1">DPO</span>, <span class="ltx_text ltx_font_italic" id="S4.T3.20.2">CPO</span>, and the benchmark <span class="ltx_text ltx_font_italic" id="S4.T3.21.3">Meditron</span>, as reported in Table <a class="ltx_ref" href="https://arxiv.org/html/2405.13984v1#S4.T1" title="Table 1 ‣ 4.4.1 Quantitative Analysis on Feedback-Aligned Optimisation Algorithms ‣ 4.4 Results ‣ 4 Experiments ‣ Feedback-aligned Mixed LLMs for Machine Language-Molecule Translation"><span class="ltx_text ltx_ref_tag">1</span></a>. </figcaption>
</figure>
<figure class="ltx_table" id="S4.T4">
<div class="ltx_inline-block ltx_align_center ltx_transformed_outer" id="S4.T4.10" style="width:433.6pt;height:122.5pt;vertical-align:-0.8pt;"><span class="ltx_transformed_inner" style="transform:translate(-39.7pt,11.1pt) scale(0.845353190394911,0.845353190394911) ;">
<table class="ltx_tabular ltx_align_middle" id="S4.T4.10.10">
<tr class="ltx_tr" id="S4.T4.7.7.7">
<td class="ltx_td ltx_align_center ltx_border_tt" id="S4.T4.7.7.7.8"><span class="ltx_text ltx_font_bold" id="S4.T4.7.7.7.8.1">Fusion</span></td>
<td class="ltx_td ltx_align_center ltx_border_tt" id="S4.T4.7.7.7.9"><span class="ltx_text ltx_font_bold" id="S4.T4.7.7.7.9.1">Method</span></td>
<td class="ltx_td ltx_align_center ltx_border_tt" id="S4.T4.1.1.1.1"><math alttext="\textbf{BLEU}\uparrow" class="ltx_Math" display="inline" id="S4.T4.1.1.1.1.m1.1"><semantics id="S4.T4.1.1.1.1.m1.1a"><mrow id="S4.T4.1.1.1.1.m1.1.1" xref="S4.T4.1.1.1.1.m1.1.1.cmml"><mtext class="ltx_mathvariant_bold" id="S4.T4.1.1.1.1.m1.1.1.2" xref="S4.T4.1.1.1.1.m1.1.1.2a.cmml">BLEU</mtext><mo id="S4.T4.1.1.1.1.m1.1.1.1" stretchy="false" xref="S4.T4.1.1.1.1.m1.1.1.1.cmml">↑</mo><mi id="S4.T4.1.1.1.1.m1.1.1.3" xref="S4.T4.1.1.1.1.m1.1.1.3.cmml"></mi></mrow><annotation-xml encoding="MathML-Content" id="S4.T4.1.1.1.1.m1.1b"><apply id="S4.T4.1.1.1.1.m1.1.1.cmml" xref="S4.T4.1.1.1.1.m1.1.1"><ci id="S4.T4.1.1.1.1.m1.1.1.1.cmml" xref="S4.T4.1.1.1.1.m1.1.1.1">↑</ci><ci id="S4.T4.1.1.1.1.m1.1.1.2a.cmml" xref="S4.T4.1.1.1.1.m1.1.1.2"><mtext class="ltx_mathvariant_bold" id="S4.T4.1.1.1.1.m1.1.1.2.cmml" xref="S4.T4.1.1.1.1.m1.1.1.2">BLEU</mtext></ci><csymbol cd="latexml" id="S4.T4.1.1.1.1.m1.1.1.3.cmml" xref="S4.T4.1.1.1.1.m1.1.1.3">absent</csymbol></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.T4.1.1.1.1.m1.1c">\textbf{BLEU}\uparrow</annotation><annotation encoding="application/x-llamapun" id="S4.T4.1.1.1.1.m1.1d">BLEU ↑</annotation></semantics></math></td>
<td class="ltx_td ltx_align_center ltx_border_tt" id="S4.T4.2.2.2.2"><math alttext="\textbf{Levenshtein}\downarrow" class="ltx_Math" display="inline" id="S4.T4.2.2.2.2.m1.1"><semantics id="S4.T4.2.2.2.2.m1.1a"><mrow id="S4.T4.2.2.2.2.m1.1.1" xref="S4.T4.2.2.2.2.m1.1.1.cmml"><mtext class="ltx_mathvariant_bold" id="S4.T4.2.2.2.2.m1.1.1.2" xref="S4.T4.2.2.2.2.m1.1.1.2a.cmml">Levenshtein</mtext><mo id="S4.T4.2.2.2.2.m1.1.1.1" stretchy="false" xref="S4.T4.2.2.2.2.m1.1.1.1.cmml">↓</mo><mi id="S4.T4.2.2.2.2.m1.1.1.3" xref="S4.T4.2.2.2.2.m1.1.1.3.cmml"></mi></mrow><annotation-xml encoding="MathML-Content" id="S4.T4.2.2.2.2.m1.1b"><apply id="S4.T4.2.2.2.2.m1.1.1.cmml" xref="S4.T4.2.2.2.2.m1.1.1"><ci id="S4.T4.2.2.2.2.m1.1.1.1.cmml" xref="S4.T4.2.2.2.2.m1.1.1.1">↓</ci><ci id="S4.T4.2.2.2.2.m1.1.1.2a.cmml" xref="S4.T4.2.2.2.2.m1.1.1.2"><mtext class="ltx_mathvariant_bold" id="S4.T4.2.2.2.2.m1.1.1.2.cmml" xref="S4.T4.2.2.2.2.m1.1.1.2">Levenshtein</mtext></ci><csymbol cd="latexml" id="S4.T4.2.2.2.2.m1.1.1.3.cmml" xref="S4.T4.2.2.2.2.m1.1.1.3">absent</csymbol></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.T4.2.2.2.2.m1.1c">\textbf{Levenshtein}\downarrow</annotation><annotation encoding="application/x-llamapun" id="S4.T4.2.2.2.2.m1.1d">Levenshtein ↓</annotation></semantics></math></td>
<td class="ltx_td ltx_align_center ltx_border_tt" id="S4.T4.3.3.3.3"><math alttext="\textbf{MACCS FTS}\uparrow" class="ltx_Math" display="inline" id="S4.T4.3.3.3.3.m1.1"><semantics id="S4.T4.3.3.3.3.m1.1a"><mrow id="S4.T4.3.3.3.3.m1.1.1" xref="S4.T4.3.3.3.3.m1.1.1.cmml"><mtext class="ltx_mathvariant_bold" id="S4.T4.3.3.3.3.m1.1.1.2" xref="S4.T4.3.3.3.3.m1.1.1.2a.cmml">MACCS FTS</mtext><mo id="S4.T4.3.3.3.3.m1.1.1.1" stretchy="false" xref="S4.T4.3.3.3.3.m1.1.1.1.cmml">↑</mo><mi id="S4.T4.3.3.3.3.m1.1.1.3" xref="S4.T4.3.3.3.3.m1.1.1.3.cmml"></mi></mrow><annotation-xml encoding="MathML-Content" id="S4.T4.3.3.3.3.m1.1b"><apply id="S4.T4.3.3.3.3.m1.1.1.cmml" xref="S4.T4.3.3.3.3.m1.1.1"><ci id="S4.T4.3.3.3.3.m1.1.1.1.cmml" xref="S4.T4.3.3.3.3.m1.1.1.1">↑</ci><ci id="S4.T4.3.3.3.3.m1.1.1.2a.cmml" xref="S4.T4.3.3.3.3.m1.1.1.2"><mtext class="ltx_mathvariant_bold" id="S4.T4.3.3.3.3.m1.1.1.2.cmml" xref="S4.T4.3.3.3.3.m1.1.1.2">MACCS FTS</mtext></ci><csymbol cd="latexml" id="S4.T4.3.3.3.3.m1.1.1.3.cmml" xref="S4.T4.3.3.3.3.m1.1.1.3">absent</csymbol></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.T4.3.3.3.3.m1.1c">\textbf{MACCS FTS}\uparrow</annotation><annotation encoding="application/x-llamapun" id="S4.T4.3.3.3.3.m1.1d">MACCS FTS ↑</annotation></semantics></math></td>
<td class="ltx_td ltx_align_center ltx_border_tt" id="S4.T4.4.4.4.4"><math alttext="\textbf{RDK FTS}\uparrow" class="ltx_Math" display="inline" id="S4.T4.4.4.4.4.m1.1"><semantics id="S4.T4.4.4.4.4.m1.1a"><mrow id="S4.T4.4.4.4.4.m1.1.1" xref="S4.T4.4.4.4.4.m1.1.1.cmml"><mtext class="ltx_mathvariant_bold" id="S4.T4.4.4.4.4.m1.1.1.2" xref="S4.T4.4.4.4.4.m1.1.1.2a.cmml">RDK FTS</mtext><mo id="S4.T4.4.4.4.4.m1.1.1.1" stretchy="false" xref="S4.T4.4.4.4.4.m1.1.1.1.cmml">↑</mo><mi id="S4.T4.4.4.4.4.m1.1.1.3" xref="S4.T4.4.4.4.4.m1.1.1.3.cmml"></mi></mrow><annotation-xml encoding="MathML-Content" id="S4.T4.4.4.4.4.m1.1b"><apply id="S4.T4.4.4.4.4.m1.1.1.cmml" xref="S4.T4.4.4.4.4.m1.1.1"><ci id="S4.T4.4.4.4.4.m1.1.1.1.cmml" xref="S4.T4.4.4.4.4.m1.1.1.1">↑</ci><ci id="S4.T4.4.4.4.4.m1.1.1.2a.cmml" xref="S4.T4.4.4.4.4.m1.1.1.2"><mtext class="ltx_mathvariant_bold" id="S4.T4.4.4.4.4.m1.1.1.2.cmml" xref="S4.T4.4.4.4.4.m1.1.1.2">RDK FTS</mtext></ci><csymbol cd="latexml" id="S4.T4.4.4.4.4.m1.1.1.3.cmml" xref="S4.T4.4.4.4.4.m1.1.1.3">absent</csymbol></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.T4.4.4.4.4.m1.1c">\textbf{RDK FTS}\uparrow</annotation><annotation encoding="application/x-llamapun" id="S4.T4.4.4.4.4.m1.1d">RDK FTS ↑</annotation></semantics></math></td>
<td class="ltx_td ltx_align_center ltx_border_tt" id="S4.T4.5.5.5.5"><math alttext="\textbf{Morgan FTS}\uparrow" class="ltx_Math" display="inline" id="S4.T4.5.5.5.5.m1.1"><semantics id="S4.T4.5.5.5.5.m1.1a"><mrow id="S4.T4.5.5.5.5.m1.1.1" xref="S4.T4.5.5.5.5.m1.1.1.cmml"><mtext class="ltx_mathvariant_bold" id="S4.T4.5.5.5.5.m1.1.1.2" xref="S4.T4.5.5.5.5.m1.1.1.2a.cmml">Morgan FTS</mtext><mo id="S4.T4.5.5.5.5.m1.1.1.1" stretchy="false" xref="S4.T4.5.5.5.5.m1.1.1.1.cmml">↑</mo><mi id="S4.T4.5.5.5.5.m1.1.1.3" xref="S4.T4.5.5.5.5.m1.1.1.3.cmml"></mi></mrow><annotation-xml encoding="MathML-Content" id="S4.T4.5.5.5.5.m1.1b"><apply id="S4.T4.5.5.5.5.m1.1.1.cmml" xref="S4.T4.5.5.5.5.m1.1.1"><ci id="S4.T4.5.5.5.5.m1.1.1.1.cmml" xref="S4.T4.5.5.5.5.m1.1.1.1">↑</ci><ci id="S4.T4.5.5.5.5.m1.1.1.2a.cmml" xref="S4.T4.5.5.5.5.m1.1.1.2"><mtext class="ltx_mathvariant_bold" id="S4.T4.5.5.5.5.m1.1.1.2.cmml" xref="S4.T4.5.5.5.5.m1.1.1.2">Morgan FTS</mtext></ci><csymbol cd="latexml" id="S4.T4.5.5.5.5.m1.1.1.3.cmml" xref="S4.T4.5.5.5.5.m1.1.1.3">absent</csymbol></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.T4.5.5.5.5.m1.1c">\textbf{Morgan FTS}\uparrow</annotation><annotation encoding="application/x-llamapun" id="S4.T4.5.5.5.5.m1.1d">Morgan FTS ↑</annotation></semantics></math></td>
<td class="ltx_td ltx_align_center ltx_border_tt" id="S4.T4.6.6.6.6"><math alttext="\textbf{FCD}\downarrow" class="ltx_Math" display="inline" id="S4.T4.6.6.6.6.m1.1"><semantics id="S4.T4.6.6.6.6.m1.1a"><mrow id="S4.T4.6.6.6.6.m1.1.1" xref="S4.T4.6.6.6.6.m1.1.1.cmml"><mtext class="ltx_mathvariant_bold" id="S4.T4.6.6.6.6.m1.1.1.2" xref="S4.T4.6.6.6.6.m1.1.1.2a.cmml">FCD</mtext><mo id="S4.T4.6.6.6.6.m1.1.1.1" stretchy="false" xref="S4.T4.6.6.6.6.m1.1.1.1.cmml">↓</mo><mi id="S4.T4.6.6.6.6.m1.1.1.3" xref="S4.T4.6.6.6.6.m1.1.1.3.cmml"></mi></mrow><annotation-xml encoding="MathML-Content" id="S4.T4.6.6.6.6.m1.1b"><apply id="S4.T4.6.6.6.6.m1.1.1.cmml" xref="S4.T4.6.6.6.6.m1.1.1"><ci id="S4.T4.6.6.6.6.m1.1.1.1.cmml" xref="S4.T4.6.6.6.6.m1.1.1.1">↓</ci><ci id="S4.T4.6.6.6.6.m1.1.1.2a.cmml" xref="S4.T4.6.6.6.6.m1.1.1.2"><mtext class="ltx_mathvariant_bold" id="S4.T4.6.6.6.6.m1.1.1.2.cmml" xref="S4.T4.6.6.6.6.m1.1.1.2">FCD</mtext></ci><csymbol cd="latexml" id="S4.T4.6.6.6.6.m1.1.1.3.cmml" xref="S4.T4.6.6.6.6.m1.1.1.3">absent</csymbol></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.T4.6.6.6.6.m1.1c">\textbf{FCD}\downarrow</annotation><annotation encoding="application/x-llamapun" id="S4.T4.6.6.6.6.m1.1d">FCD ↓</annotation></semantics></math></td>
<td class="ltx_td ltx_align_center ltx_border_tt" id="S4.T4.7.7.7.7"><math alttext="\textbf{Validity}\uparrow" class="ltx_Math" display="inline" id="S4.T4.7.7.7.7.m1.1"><semantics id="S4.T4.7.7.7.7.m1.1a"><mrow id="S4.T4.7.7.7.7.m1.1.1" xref="S4.T4.7.7.7.7.m1.1.1.cmml"><mtext class="ltx_mathvariant_bold" id="S4.T4.7.7.7.7.m1.1.1.2" xref="S4.T4.7.7.7.7.m1.1.1.2a.cmml">Validity</mtext><mo id="S4.T4.7.7.7.7.m1.1.1.1" stretchy="false" xref="S4.T4.7.7.7.7.m1.1.1.1.cmml">↑</mo><mi id="S4.T4.7.7.7.7.m1.1.1.3" xref="S4.T4.7.7.7.7.m1.1.1.3.cmml"></mi></mrow><annotation-xml encoding="MathML-Content" id="S4.T4.7.7.7.7.m1.1b"><apply id="S4.T4.7.7.7.7.m1.1.1.cmml" xref="S4.T4.7.7.7.7.m1.1.1"><ci id="S4.T4.7.7.7.7.m1.1.1.1.cmml" xref="S4.T4.7.7.7.7.m1.1.1.1">↑</ci><ci id="S4.T4.7.7.7.7.m1.1.1.2a.cmml" xref="S4.T4.7.7.7.7.m1.1.1.2"><mtext class="ltx_mathvariant_bold" id="S4.T4.7.7.7.7.m1.1.1.2.cmml" xref="S4.T4.7.7.7.7.m1.1.1.2">Validity</mtext></ci><csymbol cd="latexml" id="S4.T4.7.7.7.7.m1.1.1.3.cmml" xref="S4.T4.7.7.7.7.m1.1.1.3">absent</csymbol></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.T4.7.7.7.7.m1.1c">\textbf{Validity}\uparrow</annotation><annotation encoding="application/x-llamapun" id="S4.T4.7.7.7.7.m1.1d">Validity ↑</annotation></semantics></math></td>
</tr>
<tr class="ltx_tr" id="S4.T4.10.10.11">
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T4.10.10.11.1" rowspan="2"><span class="ltx_text ltx_font_bold" id="S4.T4.10.10.11.1.1">TIES</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T4.10.10.11.2"><span class="ltx_text ltx_font_bold" id="S4.T4.10.10.11.2.1">DPO</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T4.10.10.11.3">0.32</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T4.10.10.11.4">93.18</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T4.10.10.11.5">0.31</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T4.10.10.11.6">0.22</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T4.10.10.11.7">0.19</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T4.10.10.11.8">19.80</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T4.10.10.11.9">0.42</td>
</tr>
<tr class="ltx_tr" id="S4.T4.10.10.12">
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T4.10.10.12.1">CPO</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T4.10.10.12.2">0.68</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T4.10.10.12.3">46.91</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T4.10.10.12.4">0.72</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T4.10.10.12.5">0.65</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T4.10.10.12.6">0.45</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T4.10.10.12.7">24.50</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T4.10.10.12.8">0.94</td>
</tr>
<tr class="ltx_tr" id="S4.T4.10.10.13">
<td class="ltx_td ltx_align_center ltx_border_tt" id="S4.T4.10.10.13.1" rowspan="2"><span class="ltx_text ltx_font_bold" id="S4.T4.10.10.13.1.1">SLERP</span></td>
<td class="ltx_td ltx_align_center ltx_border_tt" id="S4.T4.10.10.13.2">DPO</td>
<td class="ltx_td ltx_align_center ltx_border_tt" id="S4.T4.10.10.13.3">0.72</td>
<td class="ltx_td ltx_align_center ltx_border_tt" id="S4.T4.10.10.13.4">43.85</td>
<td class="ltx_td ltx_align_center ltx_border_tt" id="S4.T4.10.10.13.5">0.77</td>
<td class="ltx_td ltx_align_center ltx_border_tt" id="S4.T4.10.10.13.6">0.70</td>
<td class="ltx_td ltx_align_center ltx_border_tt" id="S4.T4.10.10.13.7">0.51</td>
<td class="ltx_td ltx_align_center ltx_border_tt" id="S4.T4.10.10.13.8">10.35</td>
<td class="ltx_td ltx_align_center ltx_border_tt" id="S4.T4.10.10.13.9">0.98</td>
</tr>
<tr class="ltx_tr" id="S4.T4.10.10.14">
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T4.10.10.14.1"><span class="ltx_text ltx_font_bold" id="S4.T4.10.10.14.1.1">CPO</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T4.10.10.14.2">0.71</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T4.10.10.14.3">44.01</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T4.10.10.14.4">0.73</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T4.10.10.14.5">0.66</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T4.10.10.14.6">0.45</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T4.10.10.14.7">11.22</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T4.10.10.14.8">0.95</td>
</tr>
<tr class="ltx_tr" id="S4.T4.8.8.8">
<td class="ltx_td ltx_align_center ltx_border_tt" colspan="2" id="S4.T4.8.8.8.1"><math alttext="\Delta_{DPO\text{vs}TIES+DPO}" class="ltx_Math" display="inline" id="S4.T4.8.8.8.1.m1.1"><semantics id="S4.T4.8.8.8.1.m1.1a"><msub id="S4.T4.8.8.8.1.m1.1.1" xref="S4.T4.8.8.8.1.m1.1.1.cmml"><mi id="S4.T4.8.8.8.1.m1.1.1.2" mathvariant="normal" xref="S4.T4.8.8.8.1.m1.1.1.2.cmml">Δ</mi><mrow id="S4.T4.8.8.8.1.m1.1.1.3" xref="S4.T4.8.8.8.1.m1.1.1.3.cmml"><mrow id="S4.T4.8.8.8.1.m1.1.1.3.2" xref="S4.T4.8.8.8.1.m1.1.1.3.2.cmml"><mi id="S4.T4.8.8.8.1.m1.1.1.3.2.2" xref="S4.T4.8.8.8.1.m1.1.1.3.2.2.cmml">D</mi><mo id="S4.T4.8.8.8.1.m1.1.1.3.2.1" xref="S4.T4.8.8.8.1.m1.1.1.3.2.1.cmml">⁢</mo><mi id="S4.T4.8.8.8.1.m1.1.1.3.2.3" xref="S4.T4.8.8.8.1.m1.1.1.3.2.3.cmml">P</mi><mo id="S4.T4.8.8.8.1.m1.1.1.3.2.1a" xref="S4.T4.8.8.8.1.m1.1.1.3.2.1.cmml">⁢</mo><mi id="S4.T4.8.8.8.1.m1.1.1.3.2.4" xref="S4.T4.8.8.8.1.m1.1.1.3.2.4.cmml">O</mi><mo id="S4.T4.8.8.8.1.m1.1.1.3.2.1b" xref="S4.T4.8.8.8.1.m1.1.1.3.2.1.cmml">⁢</mo><mtext id="S4.T4.8.8.8.1.m1.1.1.3.2.5" xref="S4.T4.8.8.8.1.m1.1.1.3.2.5a.cmml">vs</mtext><mo id="S4.T4.8.8.8.1.m1.1.1.3.2.1c" xref="S4.T4.8.8.8.1.m1.1.1.3.2.1.cmml">⁢</mo><mi id="S4.T4.8.8.8.1.m1.1.1.3.2.6" xref="S4.T4.8.8.8.1.m1.1.1.3.2.6.cmml">T</mi><mo id="S4.T4.8.8.8.1.m1.1.1.3.2.1d" xref="S4.T4.8.8.8.1.m1.1.1.3.2.1.cmml">⁢</mo><mi id="S4.T4.8.8.8.1.m1.1.1.3.2.7" xref="S4.T4.8.8.8.1.m1.1.1.3.2.7.cmml">I</mi><mo id="S4.T4.8.8.8.1.m1.1.1.3.2.1e" xref="S4.T4.8.8.8.1.m1.1.1.3.2.1.cmml">⁢</mo><mi id="S4.T4.8.8.8.1.m1.1.1.3.2.8" xref="S4.T4.8.8.8.1.m1.1.1.3.2.8.cmml">E</mi><mo id="S4.T4.8.8.8.1.m1.1.1.3.2.1f" xref="S4.T4.8.8.8.1.m1.1.1.3.2.1.cmml">⁢</mo><mi id="S4.T4.8.8.8.1.m1.1.1.3.2.9" xref="S4.T4.8.8.8.1.m1.1.1.3.2.9.cmml">S</mi></mrow><mo id="S4.T4.8.8.8.1.m1.1.1.3.1" xref="S4.T4.8.8.8.1.m1.1.1.3.1.cmml">+</mo><mrow id="S4.T4.8.8.8.1.m1.1.1.3.3" xref="S4.T4.8.8.8.1.m1.1.1.3.3.cmml"><mi id="S4.T4.8.8.8.1.m1.1.1.3.3.2" xref="S4.T4.8.8.8.1.m1.1.1.3.3.2.cmml">D</mi><mo id="S4.T4.8.8.8.1.m1.1.1.3.3.1" xref="S4.T4.8.8.8.1.m1.1.1.3.3.1.cmml">⁢</mo><mi id="S4.T4.8.8.8.1.m1.1.1.3.3.3" xref="S4.T4.8.8.8.1.m1.1.1.3.3.3.cmml">P</mi><mo id="S4.T4.8.8.8.1.m1.1.1.3.3.1a" xref="S4.T4.8.8.8.1.m1.1.1.3.3.1.cmml">⁢</mo><mi id="S4.T4.8.8.8.1.m1.1.1.3.3.4" xref="S4.T4.8.8.8.1.m1.1.1.3.3.4.cmml">O</mi></mrow></mrow></msub><annotation-xml encoding="MathML-Content" id="S4.T4.8.8.8.1.m1.1b"><apply id="S4.T4.8.8.8.1.m1.1.1.cmml" xref="S4.T4.8.8.8.1.m1.1.1"><csymbol cd="ambiguous" id="S4.T4.8.8.8.1.m1.1.1.1.cmml" xref="S4.T4.8.8.8.1.m1.1.1">subscript</csymbol><ci id="S4.T4.8.8.8.1.m1.1.1.2.cmml" xref="S4.T4.8.8.8.1.m1.1.1.2">Δ</ci><apply id="S4.T4.8.8.8.1.m1.1.1.3.cmml" xref="S4.T4.8.8.8.1.m1.1.1.3"><plus id="S4.T4.8.8.8.1.m1.1.1.3.1.cmml" xref="S4.T4.8.8.8.1.m1.1.1.3.1"></plus><apply id="S4.T4.8.8.8.1.m1.1.1.3.2.cmml" xref="S4.T4.8.8.8.1.m1.1.1.3.2"><times id="S4.T4.8.8.8.1.m1.1.1.3.2.1.cmml" xref="S4.T4.8.8.8.1.m1.1.1.3.2.1"></times><ci id="S4.T4.8.8.8.1.m1.1.1.3.2.2.cmml" xref="S4.T4.8.8.8.1.m1.1.1.3.2.2">𝐷</ci><ci id="S4.T4.8.8.8.1.m1.1.1.3.2.3.cmml" xref="S4.T4.8.8.8.1.m1.1.1.3.2.3">𝑃</ci><ci id="S4.T4.8.8.8.1.m1.1.1.3.2.4.cmml" xref="S4.T4.8.8.8.1.m1.1.1.3.2.4">𝑂</ci><ci id="S4.T4.8.8.8.1.m1.1.1.3.2.5a.cmml" xref="S4.T4.8.8.8.1.m1.1.1.3.2.5"><mtext id="S4.T4.8.8.8.1.m1.1.1.3.2.5.cmml" mathsize="70%" xref="S4.T4.8.8.8.1.m1.1.1.3.2.5">vs</mtext></ci><ci id="S4.T4.8.8.8.1.m1.1.1.3.2.6.cmml" xref="S4.T4.8.8.8.1.m1.1.1.3.2.6">𝑇</ci><ci id="S4.T4.8.8.8.1.m1.1.1.3.2.7.cmml" xref="S4.T4.8.8.8.1.m1.1.1.3.2.7">𝐼</ci><ci id="S4.T4.8.8.8.1.m1.1.1.3.2.8.cmml" xref="S4.T4.8.8.8.1.m1.1.1.3.2.8">𝐸</ci><ci id="S4.T4.8.8.8.1.m1.1.1.3.2.9.cmml" xref="S4.T4.8.8.8.1.m1.1.1.3.2.9">𝑆</ci></apply><apply id="S4.T4.8.8.8.1.m1.1.1.3.3.cmml" xref="S4.T4.8.8.8.1.m1.1.1.3.3"><times id="S4.T4.8.8.8.1.m1.1.1.3.3.1.cmml" xref="S4.T4.8.8.8.1.m1.1.1.3.3.1"></times><ci id="S4.T4.8.8.8.1.m1.1.1.3.3.2.cmml" xref="S4.T4.8.8.8.1.m1.1.1.3.3.2">𝐷</ci><ci id="S4.T4.8.8.8.1.m1.1.1.3.3.3.cmml" xref="S4.T4.8.8.8.1.m1.1.1.3.3.3">𝑃</ci><ci id="S4.T4.8.8.8.1.m1.1.1.3.3.4.cmml" xref="S4.T4.8.8.8.1.m1.1.1.3.3.4">𝑂</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.T4.8.8.8.1.m1.1c">\Delta_{DPO\text{vs}TIES+DPO}</annotation><annotation encoding="application/x-llamapun" id="S4.T4.8.8.8.1.m1.1d">roman_Δ start_POSTSUBSCRIPT italic_D italic_P italic_O vs italic_T italic_I italic_E italic_S + italic_D italic_P italic_O end_POSTSUBSCRIPT</annotation></semantics></math></td>
<td class="ltx_td ltx_align_center ltx_border_tt" id="S4.T4.8.8.8.2"><span class="ltx_text" id="S4.T4.8.8.8.2.1" style="color:#E06666;">-40%</span></td>
<td class="ltx_td ltx_align_center ltx_border_tt" id="S4.T4.8.8.8.3"><span class="ltx_text" id="S4.T4.8.8.8.3.1" style="color:#E06666;">+51%</span></td>
<td class="ltx_td ltx_align_center ltx_border_tt" id="S4.T4.8.8.8.4"><span class="ltx_text" id="S4.T4.8.8.8.4.1" style="color:#E06666;">-46%</span></td>
<td class="ltx_td ltx_align_center ltx_border_tt" id="S4.T4.8.8.8.5"><span class="ltx_text" id="S4.T4.8.8.8.5.1" style="color:#E06666;">-47%</span></td>
<td class="ltx_td ltx_align_center ltx_border_tt" id="S4.T4.8.8.8.6"><span class="ltx_text" id="S4.T4.8.8.8.6.1" style="color:#E06666;">-30%</span></td>
<td class="ltx_td ltx_align_center ltx_border_tt" id="S4.T4.8.8.8.7"><span class="ltx_text" id="S4.T4.8.8.8.7.1" style="color:#E06666;">+7.33%</span></td>
<td class="ltx_td ltx_align_center ltx_border_tt" id="S4.T4.8.8.8.8"><span class="ltx_text" id="S4.T4.8.8.8.8.1" style="color:#E06666;">+58%</span></td>
</tr>
<tr class="ltx_tr" id="S4.T4.9.9.9">
<td class="ltx_td ltx_align_center ltx_border_t" colspan="2" id="S4.T4.9.9.9.1"><math alttext="\Delta_{CPO\text{vs}SLERP+CPO}" class="ltx_Math" display="inline" id="S4.T4.9.9.9.1.m1.1"><semantics id="S4.T4.9.9.9.1.m1.1a"><msub id="S4.T4.9.9.9.1.m1.1.1" xref="S4.T4.9.9.9.1.m1.1.1.cmml"><mi id="S4.T4.9.9.9.1.m1.1.1.2" mathvariant="normal" xref="S4.T4.9.9.9.1.m1.1.1.2.cmml">Δ</mi><mrow id="S4.T4.9.9.9.1.m1.1.1.3" xref="S4.T4.9.9.9.1.m1.1.1.3.cmml"><mrow id="S4.T4.9.9.9.1.m1.1.1.3.2" xref="S4.T4.9.9.9.1.m1.1.1.3.2.cmml"><mi id="S4.T4.9.9.9.1.m1.1.1.3.2.2" xref="S4.T4.9.9.9.1.m1.1.1.3.2.2.cmml">C</mi><mo id="S4.T4.9.9.9.1.m1.1.1.3.2.1" xref="S4.T4.9.9.9.1.m1.1.1.3.2.1.cmml">⁢</mo><mi id="S4.T4.9.9.9.1.m1.1.1.3.2.3" xref="S4.T4.9.9.9.1.m1.1.1.3.2.3.cmml">P</mi><mo id="S4.T4.9.9.9.1.m1.1.1.3.2.1a" xref="S4.T4.9.9.9.1.m1.1.1.3.2.1.cmml">⁢</mo><mi id="S4.T4.9.9.9.1.m1.1.1.3.2.4" xref="S4.T4.9.9.9.1.m1.1.1.3.2.4.cmml">O</mi><mo id="S4.T4.9.9.9.1.m1.1.1.3.2.1b" xref="S4.T4.9.9.9.1.m1.1.1.3.2.1.cmml">⁢</mo><mtext id="S4.T4.9.9.9.1.m1.1.1.3.2.5" xref="S4.T4.9.9.9.1.m1.1.1.3.2.5a.cmml">vs</mtext><mo id="S4.T4.9.9.9.1.m1.1.1.3.2.1c" xref="S4.T4.9.9.9.1.m1.1.1.3.2.1.cmml">⁢</mo><mi id="S4.T4.9.9.9.1.m1.1.1.3.2.6" xref="S4.T4.9.9.9.1.m1.1.1.3.2.6.cmml">S</mi><mo id="S4.T4.9.9.9.1.m1.1.1.3.2.1d" xref="S4.T4.9.9.9.1.m1.1.1.3.2.1.cmml">⁢</mo><mi id="S4.T4.9.9.9.1.m1.1.1.3.2.7" xref="S4.T4.9.9.9.1.m1.1.1.3.2.7.cmml">L</mi><mo id="S4.T4.9.9.9.1.m1.1.1.3.2.1e" xref="S4.T4.9.9.9.1.m1.1.1.3.2.1.cmml">⁢</mo><mi id="S4.T4.9.9.9.1.m1.1.1.3.2.8" xref="S4.T4.9.9.9.1.m1.1.1.3.2.8.cmml">E</mi><mo id="S4.T4.9.9.9.1.m1.1.1.3.2.1f" xref="S4.T4.9.9.9.1.m1.1.1.3.2.1.cmml">⁢</mo><mi id="S4.T4.9.9.9.1.m1.1.1.3.2.9" xref="S4.T4.9.9.9.1.m1.1.1.3.2.9.cmml">R</mi><mo id="S4.T4.9.9.9.1.m1.1.1.3.2.1g" xref="S4.T4.9.9.9.1.m1.1.1.3.2.1.cmml">⁢</mo><mi id="S4.T4.9.9.9.1.m1.1.1.3.2.10" xref="S4.T4.9.9.9.1.m1.1.1.3.2.10.cmml">P</mi></mrow><mo id="S4.T4.9.9.9.1.m1.1.1.3.1" xref="S4.T4.9.9.9.1.m1.1.1.3.1.cmml">+</mo><mrow id="S4.T4.9.9.9.1.m1.1.1.3.3" xref="S4.T4.9.9.9.1.m1.1.1.3.3.cmml"><mi id="S4.T4.9.9.9.1.m1.1.1.3.3.2" xref="S4.T4.9.9.9.1.m1.1.1.3.3.2.cmml">C</mi><mo id="S4.T4.9.9.9.1.m1.1.1.3.3.1" xref="S4.T4.9.9.9.1.m1.1.1.3.3.1.cmml">⁢</mo><mi id="S4.T4.9.9.9.1.m1.1.1.3.3.3" xref="S4.T4.9.9.9.1.m1.1.1.3.3.3.cmml">P</mi><mo id="S4.T4.9.9.9.1.m1.1.1.3.3.1a" xref="S4.T4.9.9.9.1.m1.1.1.3.3.1.cmml">⁢</mo><mi id="S4.T4.9.9.9.1.m1.1.1.3.3.4" xref="S4.T4.9.9.9.1.m1.1.1.3.3.4.cmml">O</mi></mrow></mrow></msub><annotation-xml encoding="MathML-Content" id="S4.T4.9.9.9.1.m1.1b"><apply id="S4.T4.9.9.9.1.m1.1.1.cmml" xref="S4.T4.9.9.9.1.m1.1.1"><csymbol cd="ambiguous" id="S4.T4.9.9.9.1.m1.1.1.1.cmml" xref="S4.T4.9.9.9.1.m1.1.1">subscript</csymbol><ci id="S4.T4.9.9.9.1.m1.1.1.2.cmml" xref="S4.T4.9.9.9.1.m1.1.1.2">Δ</ci><apply id="S4.T4.9.9.9.1.m1.1.1.3.cmml" xref="S4.T4.9.9.9.1.m1.1.1.3"><plus id="S4.T4.9.9.9.1.m1.1.1.3.1.cmml" xref="S4.T4.9.9.9.1.m1.1.1.3.1"></plus><apply id="S4.T4.9.9.9.1.m1.1.1.3.2.cmml" xref="S4.T4.9.9.9.1.m1.1.1.3.2"><times id="S4.T4.9.9.9.1.m1.1.1.3.2.1.cmml" xref="S4.T4.9.9.9.1.m1.1.1.3.2.1"></times><ci id="S4.T4.9.9.9.1.m1.1.1.3.2.2.cmml" xref="S4.T4.9.9.9.1.m1.1.1.3.2.2">𝐶</ci><ci id="S4.T4.9.9.9.1.m1.1.1.3.2.3.cmml" xref="S4.T4.9.9.9.1.m1.1.1.3.2.3">𝑃</ci><ci id="S4.T4.9.9.9.1.m1.1.1.3.2.4.cmml" xref="S4.T4.9.9.9.1.m1.1.1.3.2.4">𝑂</ci><ci id="S4.T4.9.9.9.1.m1.1.1.3.2.5a.cmml" xref="S4.T4.9.9.9.1.m1.1.1.3.2.5"><mtext id="S4.T4.9.9.9.1.m1.1.1.3.2.5.cmml" mathsize="70%" xref="S4.T4.9.9.9.1.m1.1.1.3.2.5">vs</mtext></ci><ci id="S4.T4.9.9.9.1.m1.1.1.3.2.6.cmml" xref="S4.T4.9.9.9.1.m1.1.1.3.2.6">𝑆</ci><ci id="S4.T4.9.9.9.1.m1.1.1.3.2.7.cmml" xref="S4.T4.9.9.9.1.m1.1.1.3.2.7">𝐿</ci><ci id="S4.T4.9.9.9.1.m1.1.1.3.2.8.cmml" xref="S4.T4.9.9.9.1.m1.1.1.3.2.8">𝐸</ci><ci id="S4.T4.9.9.9.1.m1.1.1.3.2.9.cmml" xref="S4.T4.9.9.9.1.m1.1.1.3.2.9">𝑅</ci><ci id="S4.T4.9.9.9.1.m1.1.1.3.2.10.cmml" xref="S4.T4.9.9.9.1.m1.1.1.3.2.10">𝑃</ci></apply><apply id="S4.T4.9.9.9.1.m1.1.1.3.3.cmml" xref="S4.T4.9.9.9.1.m1.1.1.3.3"><times id="S4.T4.9.9.9.1.m1.1.1.3.3.1.cmml" xref="S4.T4.9.9.9.1.m1.1.1.3.3.1"></times><ci id="S4.T4.9.9.9.1.m1.1.1.3.3.2.cmml" xref="S4.T4.9.9.9.1.m1.1.1.3.3.2">𝐶</ci><ci id="S4.T4.9.9.9.1.m1.1.1.3.3.3.cmml" xref="S4.T4.9.9.9.1.m1.1.1.3.3.3">𝑃</ci><ci id="S4.T4.9.9.9.1.m1.1.1.3.3.4.cmml" xref="S4.T4.9.9.9.1.m1.1.1.3.3.4">𝑂</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.T4.9.9.9.1.m1.1c">\Delta_{CPO\text{vs}SLERP+CPO}</annotation><annotation encoding="application/x-llamapun" id="S4.T4.9.9.9.1.m1.1d">roman_Δ start_POSTSUBSCRIPT italic_C italic_P italic_O vs italic_S italic_L italic_E italic_R italic_P + italic_C italic_P italic_O end_POSTSUBSCRIPT</annotation></semantics></math></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T4.9.9.9.2"><span class="ltx_text" id="S4.T4.9.9.9.2.1" style="color:#93C47D;">0%</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T4.9.9.9.3"><span class="ltx_text" id="S4.T4.9.9.9.3.1" style="color:#E06666;">+1.36%</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T4.9.9.9.4"><span class="ltx_text" id="S4.T4.9.9.9.4.1" style="color:#E06666;">-4%</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T4.9.9.9.5"><span class="ltx_text" id="S4.T4.9.9.9.5.1" style="color:#E06666;">-4%</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T4.9.9.9.6"><span class="ltx_text" id="S4.T4.9.9.9.6.1" style="color:#E06666;">-3%</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T4.9.9.9.7"><span class="ltx_text" id="S4.T4.9.9.9.7.1" style="color:#E06666;">+5%</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T4.9.9.9.8"><span class="ltx_text" id="S4.T4.9.9.9.8.1" style="color:#E06666;">-4%</span></td>
</tr>
<tr class="ltx_tr" id="S4.T4.10.10.10">
<td class="ltx_td ltx_align_center ltx_border_bb ltx_border_t" colspan="2" id="S4.T4.10.10.10.1"><math alttext="\Delta_{MED\text{vs}SLERP+CPO}" class="ltx_Math" display="inline" id="S4.T4.10.10.10.1.m1.1"><semantics id="S4.T4.10.10.10.1.m1.1a"><msub id="S4.T4.10.10.10.1.m1.1.1" xref="S4.T4.10.10.10.1.m1.1.1.cmml"><mi id="S4.T4.10.10.10.1.m1.1.1.2" mathvariant="normal" xref="S4.T4.10.10.10.1.m1.1.1.2.cmml">Δ</mi><mrow id="S4.T4.10.10.10.1.m1.1.1.3" xref="S4.T4.10.10.10.1.m1.1.1.3.cmml"><mrow id="S4.T4.10.10.10.1.m1.1.1.3.2" xref="S4.T4.10.10.10.1.m1.1.1.3.2.cmml"><mi id="S4.T4.10.10.10.1.m1.1.1.3.2.2" xref="S4.T4.10.10.10.1.m1.1.1.3.2.2.cmml">M</mi><mo id="S4.T4.10.10.10.1.m1.1.1.3.2.1" xref="S4.T4.10.10.10.1.m1.1.1.3.2.1.cmml">⁢</mo><mi id="S4.T4.10.10.10.1.m1.1.1.3.2.3" xref="S4.T4.10.10.10.1.m1.1.1.3.2.3.cmml">E</mi><mo id="S4.T4.10.10.10.1.m1.1.1.3.2.1a" xref="S4.T4.10.10.10.1.m1.1.1.3.2.1.cmml">⁢</mo><mi id="S4.T4.10.10.10.1.m1.1.1.3.2.4" xref="S4.T4.10.10.10.1.m1.1.1.3.2.4.cmml">D</mi><mo id="S4.T4.10.10.10.1.m1.1.1.3.2.1b" xref="S4.T4.10.10.10.1.m1.1.1.3.2.1.cmml">⁢</mo><mtext id="S4.T4.10.10.10.1.m1.1.1.3.2.5" xref="S4.T4.10.10.10.1.m1.1.1.3.2.5a.cmml">vs</mtext><mo id="S4.T4.10.10.10.1.m1.1.1.3.2.1c" xref="S4.T4.10.10.10.1.m1.1.1.3.2.1.cmml">⁢</mo><mi id="S4.T4.10.10.10.1.m1.1.1.3.2.6" xref="S4.T4.10.10.10.1.m1.1.1.3.2.6.cmml">S</mi><mo id="S4.T4.10.10.10.1.m1.1.1.3.2.1d" xref="S4.T4.10.10.10.1.m1.1.1.3.2.1.cmml">⁢</mo><mi id="S4.T4.10.10.10.1.m1.1.1.3.2.7" xref="S4.T4.10.10.10.1.m1.1.1.3.2.7.cmml">L</mi><mo id="S4.T4.10.10.10.1.m1.1.1.3.2.1e" xref="S4.T4.10.10.10.1.m1.1.1.3.2.1.cmml">⁢</mo><mi id="S4.T4.10.10.10.1.m1.1.1.3.2.8" xref="S4.T4.10.10.10.1.m1.1.1.3.2.8.cmml">E</mi><mo id="S4.T4.10.10.10.1.m1.1.1.3.2.1f" xref="S4.T4.10.10.10.1.m1.1.1.3.2.1.cmml">⁢</mo><mi id="S4.T4.10.10.10.1.m1.1.1.3.2.9" xref="S4.T4.10.10.10.1.m1.1.1.3.2.9.cmml">R</mi><mo id="S4.T4.10.10.10.1.m1.1.1.3.2.1g" xref="S4.T4.10.10.10.1.m1.1.1.3.2.1.cmml">⁢</mo><mi id="S4.T4.10.10.10.1.m1.1.1.3.2.10" xref="S4.T4.10.10.10.1.m1.1.1.3.2.10.cmml">P</mi></mrow><mo id="S4.T4.10.10.10.1.m1.1.1.3.1" xref="S4.T4.10.10.10.1.m1.1.1.3.1.cmml">+</mo><mrow id="S4.T4.10.10.10.1.m1.1.1.3.3" xref="S4.T4.10.10.10.1.m1.1.1.3.3.cmml"><mi id="S4.T4.10.10.10.1.m1.1.1.3.3.2" xref="S4.T4.10.10.10.1.m1.1.1.3.3.2.cmml">C</mi><mo id="S4.T4.10.10.10.1.m1.1.1.3.3.1" xref="S4.T4.10.10.10.1.m1.1.1.3.3.1.cmml">⁢</mo><mi id="S4.T4.10.10.10.1.m1.1.1.3.3.3" xref="S4.T4.10.10.10.1.m1.1.1.3.3.3.cmml">P</mi><mo id="S4.T4.10.10.10.1.m1.1.1.3.3.1a" xref="S4.T4.10.10.10.1.m1.1.1.3.3.1.cmml">⁢</mo><mi id="S4.T4.10.10.10.1.m1.1.1.3.3.4" xref="S4.T4.10.10.10.1.m1.1.1.3.3.4.cmml">O</mi></mrow></mrow></msub><annotation-xml encoding="MathML-Content" id="S4.T4.10.10.10.1.m1.1b"><apply id="S4.T4.10.10.10.1.m1.1.1.cmml" xref="S4.T4.10.10.10.1.m1.1.1"><csymbol cd="ambiguous" id="S4.T4.10.10.10.1.m1.1.1.1.cmml" xref="S4.T4.10.10.10.1.m1.1.1">subscript</csymbol><ci id="S4.T4.10.10.10.1.m1.1.1.2.cmml" xref="S4.T4.10.10.10.1.m1.1.1.2">Δ</ci><apply id="S4.T4.10.10.10.1.m1.1.1.3.cmml" xref="S4.T4.10.10.10.1.m1.1.1.3"><plus id="S4.T4.10.10.10.1.m1.1.1.3.1.cmml" xref="S4.T4.10.10.10.1.m1.1.1.3.1"></plus><apply id="S4.T4.10.10.10.1.m1.1.1.3.2.cmml" xref="S4.T4.10.10.10.1.m1.1.1.3.2"><times id="S4.T4.10.10.10.1.m1.1.1.3.2.1.cmml" xref="S4.T4.10.10.10.1.m1.1.1.3.2.1"></times><ci id="S4.T4.10.10.10.1.m1.1.1.3.2.2.cmml" xref="S4.T4.10.10.10.1.m1.1.1.3.2.2">𝑀</ci><ci id="S4.T4.10.10.10.1.m1.1.1.3.2.3.cmml" xref="S4.T4.10.10.10.1.m1.1.1.3.2.3">𝐸</ci><ci id="S4.T4.10.10.10.1.m1.1.1.3.2.4.cmml" xref="S4.T4.10.10.10.1.m1.1.1.3.2.4">𝐷</ci><ci id="S4.T4.10.10.10.1.m1.1.1.3.2.5a.cmml" xref="S4.T4.10.10.10.1.m1.1.1.3.2.5"><mtext id="S4.T4.10.10.10.1.m1.1.1.3.2.5.cmml" mathsize="70%" xref="S4.T4.10.10.10.1.m1.1.1.3.2.5">vs</mtext></ci><ci id="S4.T4.10.10.10.1.m1.1.1.3.2.6.cmml" xref="S4.T4.10.10.10.1.m1.1.1.3.2.6">𝑆</ci><ci id="S4.T4.10.10.10.1.m1.1.1.3.2.7.cmml" xref="S4.T4.10.10.10.1.m1.1.1.3.2.7">𝐿</ci><ci id="S4.T4.10.10.10.1.m1.1.1.3.2.8.cmml" xref="S4.T4.10.10.10.1.m1.1.1.3.2.8">𝐸</ci><ci id="S4.T4.10.10.10.1.m1.1.1.3.2.9.cmml" xref="S4.T4.10.10.10.1.m1.1.1.3.2.9">𝑅</ci><ci id="S4.T4.10.10.10.1.m1.1.1.3.2.10.cmml" xref="S4.T4.10.10.10.1.m1.1.1.3.2.10">𝑃</ci></apply><apply id="S4.T4.10.10.10.1.m1.1.1.3.3.cmml" xref="S4.T4.10.10.10.1.m1.1.1.3.3"><times id="S4.T4.10.10.10.1.m1.1.1.3.3.1.cmml" xref="S4.T4.10.10.10.1.m1.1.1.3.3.1"></times><ci id="S4.T4.10.10.10.1.m1.1.1.3.3.2.cmml" xref="S4.T4.10.10.10.1.m1.1.1.3.3.2">𝐶</ci><ci id="S4.T4.10.10.10.1.m1.1.1.3.3.3.cmml" xref="S4.T4.10.10.10.1.m1.1.1.3.3.3">𝑃</ci><ci id="S4.T4.10.10.10.1.m1.1.1.3.3.4.cmml" xref="S4.T4.10.10.10.1.m1.1.1.3.3.4">𝑂</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.T4.10.10.10.1.m1.1c">\Delta_{MED\text{vs}SLERP+CPO}</annotation><annotation encoding="application/x-llamapun" id="S4.T4.10.10.10.1.m1.1d">roman_Δ start_POSTSUBSCRIPT italic_M italic_E italic_D vs italic_S italic_L italic_E italic_R italic_P + italic_C italic_P italic_O end_POSTSUBSCRIPT</annotation></semantics></math></td>
<td class="ltx_td ltx_align_center ltx_border_bb ltx_border_t" id="S4.T4.10.10.10.2"><span class="ltx_text" id="S4.T4.10.10.10.2.1" style="color:#93C47D;">+29%</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb ltx_border_t" id="S4.T4.10.10.10.3"><span class="ltx_text" id="S4.T4.10.10.10.3.1" style="color:#93C47D;">-22.40%</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb ltx_border_t" id="S4.T4.10.10.10.4"><span class="ltx_text" id="S4.T4.10.10.10.4.1" style="color:#93C47D;">+38%</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb ltx_border_t" id="S4.T4.10.10.10.5"><span class="ltx_text" id="S4.T4.10.10.10.5.1" style="color:#93C47D;">+37%</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb ltx_border_t" id="S4.T4.10.10.10.6"><span class="ltx_text" id="S4.T4.10.10.10.6.1" style="color:#93C47D;">+27%</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb ltx_border_t" id="S4.T4.10.10.10.7"><span class="ltx_text" id="S4.T4.10.10.10.7.1" style="color:#93C47D;">-4.45%</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb ltx_border_t" id="S4.T4.10.10.10.8"><span class="ltx_text" id="S4.T4.10.10.10.8.1" style="color:#93C47D;">+37%</span></td>
</tr>
</table>
</span></div>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table">Table 4: </span>Mixed Cross-Modals Fusion Results in Language-to-Molecule Translation. Best combined approaches are highlighted in bold. <math alttext="\Delta_{DPO\text{vs}TIES+DPO}" class="ltx_Math" display="inline" id="S4.T4.14.m1.1"><semantics id="S4.T4.14.m1.1b"><msub id="S4.T4.14.m1.1.1" xref="S4.T4.14.m1.1.1.cmml"><mi id="S4.T4.14.m1.1.1.2" mathvariant="normal" xref="S4.T4.14.m1.1.1.2.cmml">Δ</mi><mrow id="S4.T4.14.m1.1.1.3" xref="S4.T4.14.m1.1.1.3.cmml"><mrow id="S4.T4.14.m1.1.1.3.2" xref="S4.T4.14.m1.1.1.3.2.cmml"><mi id="S4.T4.14.m1.1.1.3.2.2" xref="S4.T4.14.m1.1.1.3.2.2.cmml">D</mi><mo id="S4.T4.14.m1.1.1.3.2.1" xref="S4.T4.14.m1.1.1.3.2.1.cmml">⁢</mo><mi id="S4.T4.14.m1.1.1.3.2.3" xref="S4.T4.14.m1.1.1.3.2.3.cmml">P</mi><mo id="S4.T4.14.m1.1.1.3.2.1b" xref="S4.T4.14.m1.1.1.3.2.1.cmml">⁢</mo><mi id="S4.T4.14.m1.1.1.3.2.4" xref="S4.T4.14.m1.1.1.3.2.4.cmml">O</mi><mo id="S4.T4.14.m1.1.1.3.2.1c" xref="S4.T4.14.m1.1.1.3.2.1.cmml">⁢</mo><mtext id="S4.T4.14.m1.1.1.3.2.5" xref="S4.T4.14.m1.1.1.3.2.5a.cmml">vs</mtext><mo id="S4.T4.14.m1.1.1.3.2.1d" xref="S4.T4.14.m1.1.1.3.2.1.cmml">⁢</mo><mi id="S4.T4.14.m1.1.1.3.2.6" xref="S4.T4.14.m1.1.1.3.2.6.cmml">T</mi><mo id="S4.T4.14.m1.1.1.3.2.1e" xref="S4.T4.14.m1.1.1.3.2.1.cmml">⁢</mo><mi id="S4.T4.14.m1.1.1.3.2.7" xref="S4.T4.14.m1.1.1.3.2.7.cmml">I</mi><mo id="S4.T4.14.m1.1.1.3.2.1f" xref="S4.T4.14.m1.1.1.3.2.1.cmml">⁢</mo><mi id="S4.T4.14.m1.1.1.3.2.8" xref="S4.T4.14.m1.1.1.3.2.8.cmml">E</mi><mo id="S4.T4.14.m1.1.1.3.2.1g" xref="S4.T4.14.m1.1.1.3.2.1.cmml">⁢</mo><mi id="S4.T4.14.m1.1.1.3.2.9" xref="S4.T4.14.m1.1.1.3.2.9.cmml">S</mi></mrow><mo id="S4.T4.14.m1.1.1.3.1" xref="S4.T4.14.m1.1.1.3.1.cmml">+</mo><mrow id="S4.T4.14.m1.1.1.3.3" xref="S4.T4.14.m1.1.1.3.3.cmml"><mi id="S4.T4.14.m1.1.1.3.3.2" xref="S4.T4.14.m1.1.1.3.3.2.cmml">D</mi><mo id="S4.T4.14.m1.1.1.3.3.1" xref="S4.T4.14.m1.1.1.3.3.1.cmml">⁢</mo><mi id="S4.T4.14.m1.1.1.3.3.3" xref="S4.T4.14.m1.1.1.3.3.3.cmml">P</mi><mo id="S4.T4.14.m1.1.1.3.3.1b" xref="S4.T4.14.m1.1.1.3.3.1.cmml">⁢</mo><mi id="S4.T4.14.m1.1.1.3.3.4" xref="S4.T4.14.m1.1.1.3.3.4.cmml">O</mi></mrow></mrow></msub><annotation-xml encoding="MathML-Content" id="S4.T4.14.m1.1c"><apply id="S4.T4.14.m1.1.1.cmml" xref="S4.T4.14.m1.1.1"><csymbol cd="ambiguous" id="S4.T4.14.m1.1.1.1.cmml" xref="S4.T4.14.m1.1.1">subscript</csymbol><ci id="S4.T4.14.m1.1.1.2.cmml" xref="S4.T4.14.m1.1.1.2">Δ</ci><apply id="S4.T4.14.m1.1.1.3.cmml" xref="S4.T4.14.m1.1.1.3"><plus id="S4.T4.14.m1.1.1.3.1.cmml" xref="S4.T4.14.m1.1.1.3.1"></plus><apply id="S4.T4.14.m1.1.1.3.2.cmml" xref="S4.T4.14.m1.1.1.3.2"><times id="S4.T4.14.m1.1.1.3.2.1.cmml" xref="S4.T4.14.m1.1.1.3.2.1"></times><ci id="S4.T4.14.m1.1.1.3.2.2.cmml" xref="S4.T4.14.m1.1.1.3.2.2">𝐷</ci><ci id="S4.T4.14.m1.1.1.3.2.3.cmml" xref="S4.T4.14.m1.1.1.3.2.3">𝑃</ci><ci id="S4.T4.14.m1.1.1.3.2.4.cmml" xref="S4.T4.14.m1.1.1.3.2.4">𝑂</ci><ci id="S4.T4.14.m1.1.1.3.2.5a.cmml" xref="S4.T4.14.m1.1.1.3.2.5"><mtext id="S4.T4.14.m1.1.1.3.2.5.cmml" mathsize="70%" xref="S4.T4.14.m1.1.1.3.2.5">vs</mtext></ci><ci id="S4.T4.14.m1.1.1.3.2.6.cmml" xref="S4.T4.14.m1.1.1.3.2.6">𝑇</ci><ci id="S4.T4.14.m1.1.1.3.2.7.cmml" xref="S4.T4.14.m1.1.1.3.2.7">𝐼</ci><ci id="S4.T4.14.m1.1.1.3.2.8.cmml" xref="S4.T4.14.m1.1.1.3.2.8">𝐸</ci><ci id="S4.T4.14.m1.1.1.3.2.9.cmml" xref="S4.T4.14.m1.1.1.3.2.9">𝑆</ci></apply><apply id="S4.T4.14.m1.1.1.3.3.cmml" xref="S4.T4.14.m1.1.1.3.3"><times id="S4.T4.14.m1.1.1.3.3.1.cmml" xref="S4.T4.14.m1.1.1.3.3.1"></times><ci id="S4.T4.14.m1.1.1.3.3.2.cmml" xref="S4.T4.14.m1.1.1.3.3.2">𝐷</ci><ci id="S4.T4.14.m1.1.1.3.3.3.cmml" xref="S4.T4.14.m1.1.1.3.3.3">𝑃</ci><ci id="S4.T4.14.m1.1.1.3.3.4.cmml" xref="S4.T4.14.m1.1.1.3.3.4">𝑂</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.T4.14.m1.1d">\Delta_{DPO\text{vs}TIES+DPO}</annotation><annotation encoding="application/x-llamapun" id="S4.T4.14.m1.1e">roman_Δ start_POSTSUBSCRIPT italic_D italic_P italic_O vs italic_T italic_I italic_E italic_S + italic_D italic_P italic_O end_POSTSUBSCRIPT</annotation></semantics></math>, <math alttext="\Delta_{CPO\text{vs}SLERP+CPO}" class="ltx_Math" display="inline" id="S4.T4.15.m2.1"><semantics id="S4.T4.15.m2.1b"><msub id="S4.T4.15.m2.1.1" xref="S4.T4.15.m2.1.1.cmml"><mi id="S4.T4.15.m2.1.1.2" mathvariant="normal" xref="S4.T4.15.m2.1.1.2.cmml">Δ</mi><mrow id="S4.T4.15.m2.1.1.3" xref="S4.T4.15.m2.1.1.3.cmml"><mrow id="S4.T4.15.m2.1.1.3.2" xref="S4.T4.15.m2.1.1.3.2.cmml"><mi id="S4.T4.15.m2.1.1.3.2.2" xref="S4.T4.15.m2.1.1.3.2.2.cmml">C</mi><mo id="S4.T4.15.m2.1.1.3.2.1" xref="S4.T4.15.m2.1.1.3.2.1.cmml">⁢</mo><mi id="S4.T4.15.m2.1.1.3.2.3" xref="S4.T4.15.m2.1.1.3.2.3.cmml">P</mi><mo id="S4.T4.15.m2.1.1.3.2.1b" xref="S4.T4.15.m2.1.1.3.2.1.cmml">⁢</mo><mi id="S4.T4.15.m2.1.1.3.2.4" xref="S4.T4.15.m2.1.1.3.2.4.cmml">O</mi><mo id="S4.T4.15.m2.1.1.3.2.1c" xref="S4.T4.15.m2.1.1.3.2.1.cmml">⁢</mo><mtext id="S4.T4.15.m2.1.1.3.2.5" xref="S4.T4.15.m2.1.1.3.2.5a.cmml">vs</mtext><mo id="S4.T4.15.m2.1.1.3.2.1d" xref="S4.T4.15.m2.1.1.3.2.1.cmml">⁢</mo><mi id="S4.T4.15.m2.1.1.3.2.6" xref="S4.T4.15.m2.1.1.3.2.6.cmml">S</mi><mo id="S4.T4.15.m2.1.1.3.2.1e" xref="S4.T4.15.m2.1.1.3.2.1.cmml">⁢</mo><mi id="S4.T4.15.m2.1.1.3.2.7" xref="S4.T4.15.m2.1.1.3.2.7.cmml">L</mi><mo id="S4.T4.15.m2.1.1.3.2.1f" xref="S4.T4.15.m2.1.1.3.2.1.cmml">⁢</mo><mi id="S4.T4.15.m2.1.1.3.2.8" xref="S4.T4.15.m2.1.1.3.2.8.cmml">E</mi><mo id="S4.T4.15.m2.1.1.3.2.1g" xref="S4.T4.15.m2.1.1.3.2.1.cmml">⁢</mo><mi id="S4.T4.15.m2.1.1.3.2.9" xref="S4.T4.15.m2.1.1.3.2.9.cmml">R</mi><mo id="S4.T4.15.m2.1.1.3.2.1h" xref="S4.T4.15.m2.1.1.3.2.1.cmml">⁢</mo><mi id="S4.T4.15.m2.1.1.3.2.10" xref="S4.T4.15.m2.1.1.3.2.10.cmml">P</mi></mrow><mo id="S4.T4.15.m2.1.1.3.1" xref="S4.T4.15.m2.1.1.3.1.cmml">+</mo><mrow id="S4.T4.15.m2.1.1.3.3" xref="S4.T4.15.m2.1.1.3.3.cmml"><mi id="S4.T4.15.m2.1.1.3.3.2" xref="S4.T4.15.m2.1.1.3.3.2.cmml">C</mi><mo id="S4.T4.15.m2.1.1.3.3.1" xref="S4.T4.15.m2.1.1.3.3.1.cmml">⁢</mo><mi id="S4.T4.15.m2.1.1.3.3.3" xref="S4.T4.15.m2.1.1.3.3.3.cmml">P</mi><mo id="S4.T4.15.m2.1.1.3.3.1b" xref="S4.T4.15.m2.1.1.3.3.1.cmml">⁢</mo><mi id="S4.T4.15.m2.1.1.3.3.4" xref="S4.T4.15.m2.1.1.3.3.4.cmml">O</mi></mrow></mrow></msub><annotation-xml encoding="MathML-Content" id="S4.T4.15.m2.1c"><apply id="S4.T4.15.m2.1.1.cmml" xref="S4.T4.15.m2.1.1"><csymbol cd="ambiguous" id="S4.T4.15.m2.1.1.1.cmml" xref="S4.T4.15.m2.1.1">subscript</csymbol><ci id="S4.T4.15.m2.1.1.2.cmml" xref="S4.T4.15.m2.1.1.2">Δ</ci><apply id="S4.T4.15.m2.1.1.3.cmml" xref="S4.T4.15.m2.1.1.3"><plus id="S4.T4.15.m2.1.1.3.1.cmml" xref="S4.T4.15.m2.1.1.3.1"></plus><apply id="S4.T4.15.m2.1.1.3.2.cmml" xref="S4.T4.15.m2.1.1.3.2"><times id="S4.T4.15.m2.1.1.3.2.1.cmml" xref="S4.T4.15.m2.1.1.3.2.1"></times><ci id="S4.T4.15.m2.1.1.3.2.2.cmml" xref="S4.T4.15.m2.1.1.3.2.2">𝐶</ci><ci id="S4.T4.15.m2.1.1.3.2.3.cmml" xref="S4.T4.15.m2.1.1.3.2.3">𝑃</ci><ci id="S4.T4.15.m2.1.1.3.2.4.cmml" xref="S4.T4.15.m2.1.1.3.2.4">𝑂</ci><ci id="S4.T4.15.m2.1.1.3.2.5a.cmml" xref="S4.T4.15.m2.1.1.3.2.5"><mtext id="S4.T4.15.m2.1.1.3.2.5.cmml" mathsize="70%" xref="S4.T4.15.m2.1.1.3.2.5">vs</mtext></ci><ci id="S4.T4.15.m2.1.1.3.2.6.cmml" xref="S4.T4.15.m2.1.1.3.2.6">𝑆</ci><ci id="S4.T4.15.m2.1.1.3.2.7.cmml" xref="S4.T4.15.m2.1.1.3.2.7">𝐿</ci><ci id="S4.T4.15.m2.1.1.3.2.8.cmml" xref="S4.T4.15.m2.1.1.3.2.8">𝐸</ci><ci id="S4.T4.15.m2.1.1.3.2.9.cmml" xref="S4.T4.15.m2.1.1.3.2.9">𝑅</ci><ci id="S4.T4.15.m2.1.1.3.2.10.cmml" xref="S4.T4.15.m2.1.1.3.2.10">𝑃</ci></apply><apply id="S4.T4.15.m2.1.1.3.3.cmml" xref="S4.T4.15.m2.1.1.3.3"><times id="S4.T4.15.m2.1.1.3.3.1.cmml" xref="S4.T4.15.m2.1.1.3.3.1"></times><ci id="S4.T4.15.m2.1.1.3.3.2.cmml" xref="S4.T4.15.m2.1.1.3.3.2">𝐶</ci><ci id="S4.T4.15.m2.1.1.3.3.3.cmml" xref="S4.T4.15.m2.1.1.3.3.3">𝑃</ci><ci id="S4.T4.15.m2.1.1.3.3.4.cmml" xref="S4.T4.15.m2.1.1.3.3.4">𝑂</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.T4.15.m2.1d">\Delta_{CPO\text{vs}SLERP+CPO}</annotation><annotation encoding="application/x-llamapun" id="S4.T4.15.m2.1e">roman_Δ start_POSTSUBSCRIPT italic_C italic_P italic_O vs italic_S italic_L italic_E italic_R italic_P + italic_C italic_P italic_O end_POSTSUBSCRIPT</annotation></semantics></math>, and <math alttext="\Delta_{MED\text{vs}SLERP+CPO}" class="ltx_Math" display="inline" id="S4.T4.16.m3.1"><semantics id="S4.T4.16.m3.1b"><msub id="S4.T4.16.m3.1.1" xref="S4.T4.16.m3.1.1.cmml"><mi id="S4.T4.16.m3.1.1.2" mathvariant="normal" xref="S4.T4.16.m3.1.1.2.cmml">Δ</mi><mrow id="S4.T4.16.m3.1.1.3" xref="S4.T4.16.m3.1.1.3.cmml"><mrow id="S4.T4.16.m3.1.1.3.2" xref="S4.T4.16.m3.1.1.3.2.cmml"><mi id="S4.T4.16.m3.1.1.3.2.2" xref="S4.T4.16.m3.1.1.3.2.2.cmml">M</mi><mo id="S4.T4.16.m3.1.1.3.2.1" xref="S4.T4.16.m3.1.1.3.2.1.cmml">⁢</mo><mi id="S4.T4.16.m3.1.1.3.2.3" xref="S4.T4.16.m3.1.1.3.2.3.cmml">E</mi><mo id="S4.T4.16.m3.1.1.3.2.1b" xref="S4.T4.16.m3.1.1.3.2.1.cmml">⁢</mo><mi id="S4.T4.16.m3.1.1.3.2.4" xref="S4.T4.16.m3.1.1.3.2.4.cmml">D</mi><mo id="S4.T4.16.m3.1.1.3.2.1c" xref="S4.T4.16.m3.1.1.3.2.1.cmml">⁢</mo><mtext id="S4.T4.16.m3.1.1.3.2.5" xref="S4.T4.16.m3.1.1.3.2.5a.cmml">vs</mtext><mo id="S4.T4.16.m3.1.1.3.2.1d" xref="S4.T4.16.m3.1.1.3.2.1.cmml">⁢</mo><mi id="S4.T4.16.m3.1.1.3.2.6" xref="S4.T4.16.m3.1.1.3.2.6.cmml">S</mi><mo id="S4.T4.16.m3.1.1.3.2.1e" xref="S4.T4.16.m3.1.1.3.2.1.cmml">⁢</mo><mi id="S4.T4.16.m3.1.1.3.2.7" xref="S4.T4.16.m3.1.1.3.2.7.cmml">L</mi><mo id="S4.T4.16.m3.1.1.3.2.1f" xref="S4.T4.16.m3.1.1.3.2.1.cmml">⁢</mo><mi id="S4.T4.16.m3.1.1.3.2.8" xref="S4.T4.16.m3.1.1.3.2.8.cmml">E</mi><mo id="S4.T4.16.m3.1.1.3.2.1g" xref="S4.T4.16.m3.1.1.3.2.1.cmml">⁢</mo><mi id="S4.T4.16.m3.1.1.3.2.9" xref="S4.T4.16.m3.1.1.3.2.9.cmml">R</mi><mo id="S4.T4.16.m3.1.1.3.2.1h" xref="S4.T4.16.m3.1.1.3.2.1.cmml">⁢</mo><mi id="S4.T4.16.m3.1.1.3.2.10" xref="S4.T4.16.m3.1.1.3.2.10.cmml">P</mi></mrow><mo id="S4.T4.16.m3.1.1.3.1" xref="S4.T4.16.m3.1.1.3.1.cmml">+</mo><mrow id="S4.T4.16.m3.1.1.3.3" xref="S4.T4.16.m3.1.1.3.3.cmml"><mi id="S4.T4.16.m3.1.1.3.3.2" xref="S4.T4.16.m3.1.1.3.3.2.cmml">C</mi><mo id="S4.T4.16.m3.1.1.3.3.1" xref="S4.T4.16.m3.1.1.3.3.1.cmml">⁢</mo><mi id="S4.T4.16.m3.1.1.3.3.3" xref="S4.T4.16.m3.1.1.3.3.3.cmml">P</mi><mo id="S4.T4.16.m3.1.1.3.3.1b" xref="S4.T4.16.m3.1.1.3.3.1.cmml">⁢</mo><mi id="S4.T4.16.m3.1.1.3.3.4" xref="S4.T4.16.m3.1.1.3.3.4.cmml">O</mi></mrow></mrow></msub><annotation-xml encoding="MathML-Content" id="S4.T4.16.m3.1c"><apply id="S4.T4.16.m3.1.1.cmml" xref="S4.T4.16.m3.1.1"><csymbol cd="ambiguous" id="S4.T4.16.m3.1.1.1.cmml" xref="S4.T4.16.m3.1.1">subscript</csymbol><ci id="S4.T4.16.m3.1.1.2.cmml" xref="S4.T4.16.m3.1.1.2">Δ</ci><apply id="S4.T4.16.m3.1.1.3.cmml" xref="S4.T4.16.m3.1.1.3"><plus id="S4.T4.16.m3.1.1.3.1.cmml" xref="S4.T4.16.m3.1.1.3.1"></plus><apply id="S4.T4.16.m3.1.1.3.2.cmml" xref="S4.T4.16.m3.1.1.3.2"><times id="S4.T4.16.m3.1.1.3.2.1.cmml" xref="S4.T4.16.m3.1.1.3.2.1"></times><ci id="S4.T4.16.m3.1.1.3.2.2.cmml" xref="S4.T4.16.m3.1.1.3.2.2">𝑀</ci><ci id="S4.T4.16.m3.1.1.3.2.3.cmml" xref="S4.T4.16.m3.1.1.3.2.3">𝐸</ci><ci id="S4.T4.16.m3.1.1.3.2.4.cmml" xref="S4.T4.16.m3.1.1.3.2.4">𝐷</ci><ci id="S4.T4.16.m3.1.1.3.2.5a.cmml" xref="S4.T4.16.m3.1.1.3.2.5"><mtext id="S4.T4.16.m3.1.1.3.2.5.cmml" mathsize="70%" xref="S4.T4.16.m3.1.1.3.2.5">vs</mtext></ci><ci id="S4.T4.16.m3.1.1.3.2.6.cmml" xref="S4.T4.16.m3.1.1.3.2.6">𝑆</ci><ci id="S4.T4.16.m3.1.1.3.2.7.cmml" xref="S4.T4.16.m3.1.1.3.2.7">𝐿</ci><ci id="S4.T4.16.m3.1.1.3.2.8.cmml" xref="S4.T4.16.m3.1.1.3.2.8">𝐸</ci><ci id="S4.T4.16.m3.1.1.3.2.9.cmml" xref="S4.T4.16.m3.1.1.3.2.9">𝑅</ci><ci id="S4.T4.16.m3.1.1.3.2.10.cmml" xref="S4.T4.16.m3.1.1.3.2.10">𝑃</ci></apply><apply id="S4.T4.16.m3.1.1.3.3.cmml" xref="S4.T4.16.m3.1.1.3.3"><times id="S4.T4.16.m3.1.1.3.3.1.cmml" xref="S4.T4.16.m3.1.1.3.3.1"></times><ci id="S4.T4.16.m3.1.1.3.3.2.cmml" xref="S4.T4.16.m3.1.1.3.3.2">𝐶</ci><ci id="S4.T4.16.m3.1.1.3.3.3.cmml" xref="S4.T4.16.m3.1.1.3.3.3">𝑃</ci><ci id="S4.T4.16.m3.1.1.3.3.4.cmml" xref="S4.T4.16.m3.1.1.3.3.4">𝑂</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.T4.16.m3.1d">\Delta_{MED\text{vs}SLERP+CPO}</annotation><annotation encoding="application/x-llamapun" id="S4.T4.16.m3.1e">roman_Δ start_POSTSUBSCRIPT italic_M italic_E italic_D vs italic_S italic_L italic_E italic_R italic_P + italic_C italic_P italic_O end_POSTSUBSCRIPT</annotation></semantics></math> measure performance gains of the best-combined approaches from the singular cross-modal setting of <span class="ltx_text ltx_font_italic" id="S4.T4.20.1">DPO</span>, <span class="ltx_text ltx_font_italic" id="S4.T4.21.2">CPO</span>, and the benchmark <span class="ltx_text ltx_font_italic" id="S4.T4.22.3">Meditron</span>, as reported in Table <a class="ltx_ref" href="https://arxiv.org/html/2405.13984v1#S4.T1" title="Table 1 ‣ 4.4.1 Quantitative Analysis on Feedback-Aligned Optimisation Algorithms ‣ 4.4 Results ‣ 4 Experiments ‣ Feedback-aligned Mixed LLMs for Machine Language-Molecule Translation"><span class="ltx_text ltx_ref_tag">1</span></a>.</figcaption>
</figure>
</section>
<section class="ltx_subsubsection" id="S4.SS4.SSS3">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">4.4.3 </span>Evaluation Results on Assessing Hallucination in Chemical LLMs</h4>
<div class="ltx_para" id="S4.SS4.SSS3.p1">
<p class="ltx_p" id="S4.SS4.SSS3.p1.1">Hallucinations can negatively impact the usability of LMoT models. Figure <a class="ltx_ref" href="https://arxiv.org/html/2405.13984v1#S4.F1" title="Figure 1 ‣ 4.4.3 Evaluation Results on Assessing Hallucination in Chemical LLMs ‣ 4.4 Results ‣ 4 Experiments ‣ Feedback-aligned Mixed LLMs for Machine Language-Molecule Translation"><span class="ltx_text ltx_ref_tag">1</span></a> illustrates the distribution of metrics introduced in <math alttext="\S" class="ltx_Math" display="inline" id="S4.SS4.SSS3.p1.1.m1.1"><semantics id="S4.SS4.SSS3.p1.1.m1.1a"><mi id="S4.SS4.SSS3.p1.1.m1.1.1" mathvariant="normal" xref="S4.SS4.SSS3.p1.1.m1.1.1.cmml">§</mi><annotation-xml encoding="MathML-Content" id="S4.SS4.SSS3.p1.1.m1.1b"><ci id="S4.SS4.SSS3.p1.1.m1.1.1.cmml" xref="S4.SS4.SSS3.p1.1.m1.1.1">§</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS4.SSS3.p1.1.m1.1c">\S</annotation><annotation encoding="application/x-llamapun" id="S4.SS4.SSS3.p1.1.m1.1d">§</annotation></semantics></math> <a class="ltx_ref" href="https://arxiv.org/html/2405.13984v1#S3.SS4" title="3.4 Evaluation Method for Assessing Hallucination in Chemical LLMs ‣ 3 Methodology ‣ Feedback-aligned Mixed LLMs for Machine Language-Molecule Translation"><span class="ltx_text ltx_ref_tag">3.4</span></a> for our best-performing models, CPO and SLERP+CPO, in different cross-modal settings compared to Meditron, which was trained on the entire dataset. In the cross-language-to-molecule setting, unlike Meditron, which tends to generate molecules shorter by an average of 27 characters, our models produced molecules with lengths similar to the actual ones. When evaluating Char-F, we observed a substantial rightward shift in distributions (Fig. <a class="ltx_ref" href="https://arxiv.org/html/2405.13984v1#S4.F1" title="Figure 1 ‣ 4.4.3 Evaluation Results on Assessing Hallucination in Chemical LLMs ‣ 4.4 Results ‣ 4 Experiments ‣ Feedback-aligned Mixed LLMs for Machine Language-Molecule Translation"><span class="ltx_text ltx_ref_tag">1</span></a> (A)), indicating that our models are significantly better at capturing uni-, bi-, and tri-modal character-level dynamics in molecules. In the molecule-to-language setting, our models generated language descriptions of similar length to the actual ones, whereas Meditron consistently produced shorter predictions. When measuring entailment probabilities, we observed a decrease in distributions on the left side and an increase on the right side for our models (Fig. <a class="ltx_ref" href="https://arxiv.org/html/2405.13984v1#S4.F1" title="Figure 1 ‣ 4.4.3 Evaluation Results on Assessing Hallucination in Chemical LLMs ‣ 4.4 Results ‣ 4 Experiments ‣ Feedback-aligned Mixed LLMs for Machine Language-Molecule Translation"><span class="ltx_text ltx_ref_tag">1</span></a> (B)), indicating that our models understand underlying concepts rather than merely memorising language patterns. Figure <a class="ltx_ref" href="https://arxiv.org/html/2405.13984v1#S4.F2" title="Figure 2 ‣ 4.4.3 Evaluation Results on Assessing Hallucination in Chemical LLMs ‣ 4.4 Results ‣ 4 Experiments ‣ Feedback-aligned Mixed LLMs for Machine Language-Molecule Translation"><span class="ltx_text ltx_ref_tag">2</span></a> (B) illustrates a case study of this phenomenon. Additional examples can be found in Appendix <a class="ltx_ref" href="https://arxiv.org/html/2405.13984v1#A5" title="Appendix E Examples of Language-Molecule Translation ‣ Feedback-aligned Mixed LLMs for Machine Language-Molecule Translation"><span class="ltx_text ltx_ref_tag">E</span></a>.</p>
</div>
<figure class="ltx_figure" id="S4.F1"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_missing ltx_missing_image" id="S4.F1.g1" src=""/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 1: </span>Distributions of hallucination measurements (<math alttext="\S" class="ltx_Math" display="inline" id="S4.F1.4.m1.1"><semantics id="S4.F1.4.m1.1b"><mi id="S4.F1.4.m1.1.1" mathvariant="normal" xref="S4.F1.4.m1.1.1.cmml">§</mi><annotation-xml encoding="MathML-Content" id="S4.F1.4.m1.1c"><ci id="S4.F1.4.m1.1.1.cmml" xref="S4.F1.4.m1.1.1">§</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.F1.4.m1.1d">\S</annotation><annotation encoding="application/x-llamapun" id="S4.F1.4.m1.1e">§</annotation></semantics></math> <a class="ltx_ref" href="https://arxiv.org/html/2405.13984v1#S3.SS4" title="3.4 Evaluation Method for Assessing Hallucination in Chemical LLMs ‣ 3 Methodology ‣ Feedback-aligned Mixed LLMs for Machine Language-Molecule Translation"><span class="ltx_text ltx_ref_tag">3.4</span></a>) across 3000 pairs for our best language-molecule translation models trained on 10% of data against the benchmark Meditron trained on the entire one. (A) Hallucination in language-to-molecule translation: A <math alttext="\Delta_{Len}" class="ltx_Math" display="inline" id="S4.F1.5.m2.1"><semantics id="S4.F1.5.m2.1b"><msub id="S4.F1.5.m2.1.1" xref="S4.F1.5.m2.1.1.cmml"><mi id="S4.F1.5.m2.1.1.2" mathvariant="normal" xref="S4.F1.5.m2.1.1.2.cmml">Δ</mi><mrow id="S4.F1.5.m2.1.1.3" xref="S4.F1.5.m2.1.1.3.cmml"><mi id="S4.F1.5.m2.1.1.3.2" xref="S4.F1.5.m2.1.1.3.2.cmml">L</mi><mo id="S4.F1.5.m2.1.1.3.1" xref="S4.F1.5.m2.1.1.3.1.cmml">⁢</mo><mi id="S4.F1.5.m2.1.1.3.3" xref="S4.F1.5.m2.1.1.3.3.cmml">e</mi><mo id="S4.F1.5.m2.1.1.3.1b" xref="S4.F1.5.m2.1.1.3.1.cmml">⁢</mo><mi id="S4.F1.5.m2.1.1.3.4" xref="S4.F1.5.m2.1.1.3.4.cmml">n</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S4.F1.5.m2.1c"><apply id="S4.F1.5.m2.1.1.cmml" xref="S4.F1.5.m2.1.1"><csymbol cd="ambiguous" id="S4.F1.5.m2.1.1.1.cmml" xref="S4.F1.5.m2.1.1">subscript</csymbol><ci id="S4.F1.5.m2.1.1.2.cmml" xref="S4.F1.5.m2.1.1.2">Δ</ci><apply id="S4.F1.5.m2.1.1.3.cmml" xref="S4.F1.5.m2.1.1.3"><times id="S4.F1.5.m2.1.1.3.1.cmml" xref="S4.F1.5.m2.1.1.3.1"></times><ci id="S4.F1.5.m2.1.1.3.2.cmml" xref="S4.F1.5.m2.1.1.3.2">𝐿</ci><ci id="S4.F1.5.m2.1.1.3.3.cmml" xref="S4.F1.5.m2.1.1.3.3">𝑒</ci><ci id="S4.F1.5.m2.1.1.3.4.cmml" xref="S4.F1.5.m2.1.1.3.4">𝑛</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.F1.5.m2.1d">\Delta_{Len}</annotation><annotation encoding="application/x-llamapun" id="S4.F1.5.m2.1e">roman_Δ start_POSTSUBSCRIPT italic_L italic_e italic_n end_POSTSUBSCRIPT</annotation></semantics></math> closer to zero and higher Char-F scores indicate superior performance. (B) Hallucination in molecule-to-language translation: A <math alttext="\Delta_{Len}" class="ltx_Math" display="inline" id="S4.F1.6.m3.1"><semantics id="S4.F1.6.m3.1b"><msub id="S4.F1.6.m3.1.1" xref="S4.F1.6.m3.1.1.cmml"><mi id="S4.F1.6.m3.1.1.2" mathvariant="normal" xref="S4.F1.6.m3.1.1.2.cmml">Δ</mi><mrow id="S4.F1.6.m3.1.1.3" xref="S4.F1.6.m3.1.1.3.cmml"><mi id="S4.F1.6.m3.1.1.3.2" xref="S4.F1.6.m3.1.1.3.2.cmml">L</mi><mo id="S4.F1.6.m3.1.1.3.1" xref="S4.F1.6.m3.1.1.3.1.cmml">⁢</mo><mi id="S4.F1.6.m3.1.1.3.3" xref="S4.F1.6.m3.1.1.3.3.cmml">e</mi><mo id="S4.F1.6.m3.1.1.3.1b" xref="S4.F1.6.m3.1.1.3.1.cmml">⁢</mo><mi id="S4.F1.6.m3.1.1.3.4" xref="S4.F1.6.m3.1.1.3.4.cmml">n</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S4.F1.6.m3.1c"><apply id="S4.F1.6.m3.1.1.cmml" xref="S4.F1.6.m3.1.1"><csymbol cd="ambiguous" id="S4.F1.6.m3.1.1.1.cmml" xref="S4.F1.6.m3.1.1">subscript</csymbol><ci id="S4.F1.6.m3.1.1.2.cmml" xref="S4.F1.6.m3.1.1.2">Δ</ci><apply id="S4.F1.6.m3.1.1.3.cmml" xref="S4.F1.6.m3.1.1.3"><times id="S4.F1.6.m3.1.1.3.1.cmml" xref="S4.F1.6.m3.1.1.3.1"></times><ci id="S4.F1.6.m3.1.1.3.2.cmml" xref="S4.F1.6.m3.1.1.3.2">𝐿</ci><ci id="S4.F1.6.m3.1.1.3.3.cmml" xref="S4.F1.6.m3.1.1.3.3">𝑒</ci><ci id="S4.F1.6.m3.1.1.3.4.cmml" xref="S4.F1.6.m3.1.1.3.4">𝑛</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.F1.6.m3.1d">\Delta_{Len}</annotation><annotation encoding="application/x-llamapun" id="S4.F1.6.m3.1e">roman_Δ start_POSTSUBSCRIPT italic_L italic_e italic_n end_POSTSUBSCRIPT</annotation></semantics></math> closer to zero and higher entailment probabilities indicate superior performance.</figcaption>
</figure>
<div class="ltx_para" id="S4.SS4.SSS3.p2">
<p class="ltx_p" id="S4.SS4.SSS3.p2.3">We proceeded by selecting models that competed with Meditron in at least one cross-modal setting and conducted a cross win rate comparison among them, as illustrated in Figure <a class="ltx_ref" href="https://arxiv.org/html/2405.13984v1#S4.F2" title="Figure 2 ‣ 4.4.3 Evaluation Results on Assessing Hallucination in Chemical LLMs ‣ 4.4 Results ‣ 4 Experiments ‣ Feedback-aligned Mixed LLMs for Machine Language-Molecule Translation"><span class="ltx_text ltx_ref_tag">2</span></a>. For language-to-molecule translation, we observed a decline in molecule generation performance for Meditron and SFT when evaluated across multiple criteria, as outlined in <math alttext="\S" class="ltx_Math" display="inline" id="S4.SS4.SSS3.p2.1.m1.1"><semantics id="S4.SS4.SSS3.p2.1.m1.1a"><mi id="S4.SS4.SSS3.p2.1.m1.1.1" mathvariant="normal" xref="S4.SS4.SSS3.p2.1.m1.1.1.cmml">§</mi><annotation-xml encoding="MathML-Content" id="S4.SS4.SSS3.p2.1.m1.1b"><ci id="S4.SS4.SSS3.p2.1.m1.1.1.cmml" xref="S4.SS4.SSS3.p2.1.m1.1.1">§</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS4.SSS3.p2.1.m1.1c">\S</annotation><annotation encoding="application/x-llamapun" id="S4.SS4.SSS3.p2.1.m1.1d">§</annotation></semantics></math> <a class="ltx_ref" href="https://arxiv.org/html/2405.13984v1#S3.SS4" title="3.4 Evaluation Method for Assessing Hallucination in Chemical LLMs ‣ 3 Methodology ‣ Feedback-aligned Mixed LLMs for Machine Language-Molecule Translation"><span class="ltx_text ltx_ref_tag">3.4</span></a>. Conversely, CPO and SLERP+CPO demonstrated success in the multi-aspect evaluation, although previous SLERP+CPO showed a slight performance decrease when evaluated on single-aspect benchmark metrics (see <math alttext="\Delta_{CPO\text{vs}SLERP+CPO}" class="ltx_Math" display="inline" id="S4.SS4.SSS3.p2.2.m2.1"><semantics id="S4.SS4.SSS3.p2.2.m2.1a"><msub id="S4.SS4.SSS3.p2.2.m2.1.1" xref="S4.SS4.SSS3.p2.2.m2.1.1.cmml"><mi id="S4.SS4.SSS3.p2.2.m2.1.1.2" mathvariant="normal" xref="S4.SS4.SSS3.p2.2.m2.1.1.2.cmml">Δ</mi><mrow id="S4.SS4.SSS3.p2.2.m2.1.1.3" xref="S4.SS4.SSS3.p2.2.m2.1.1.3.cmml"><mrow id="S4.SS4.SSS3.p2.2.m2.1.1.3.2" xref="S4.SS4.SSS3.p2.2.m2.1.1.3.2.cmml"><mi id="S4.SS4.SSS3.p2.2.m2.1.1.3.2.2" xref="S4.SS4.SSS3.p2.2.m2.1.1.3.2.2.cmml">C</mi><mo id="S4.SS4.SSS3.p2.2.m2.1.1.3.2.1" xref="S4.SS4.SSS3.p2.2.m2.1.1.3.2.1.cmml">⁢</mo><mi id="S4.SS4.SSS3.p2.2.m2.1.1.3.2.3" xref="S4.SS4.SSS3.p2.2.m2.1.1.3.2.3.cmml">P</mi><mo id="S4.SS4.SSS3.p2.2.m2.1.1.3.2.1a" xref="S4.SS4.SSS3.p2.2.m2.1.1.3.2.1.cmml">⁢</mo><mi id="S4.SS4.SSS3.p2.2.m2.1.1.3.2.4" xref="S4.SS4.SSS3.p2.2.m2.1.1.3.2.4.cmml">O</mi><mo id="S4.SS4.SSS3.p2.2.m2.1.1.3.2.1b" xref="S4.SS4.SSS3.p2.2.m2.1.1.3.2.1.cmml">⁢</mo><mtext id="S4.SS4.SSS3.p2.2.m2.1.1.3.2.5" xref="S4.SS4.SSS3.p2.2.m2.1.1.3.2.5a.cmml">vs</mtext><mo id="S4.SS4.SSS3.p2.2.m2.1.1.3.2.1c" xref="S4.SS4.SSS3.p2.2.m2.1.1.3.2.1.cmml">⁢</mo><mi id="S4.SS4.SSS3.p2.2.m2.1.1.3.2.6" xref="S4.SS4.SSS3.p2.2.m2.1.1.3.2.6.cmml">S</mi><mo id="S4.SS4.SSS3.p2.2.m2.1.1.3.2.1d" xref="S4.SS4.SSS3.p2.2.m2.1.1.3.2.1.cmml">⁢</mo><mi id="S4.SS4.SSS3.p2.2.m2.1.1.3.2.7" xref="S4.SS4.SSS3.p2.2.m2.1.1.3.2.7.cmml">L</mi><mo id="S4.SS4.SSS3.p2.2.m2.1.1.3.2.1e" xref="S4.SS4.SSS3.p2.2.m2.1.1.3.2.1.cmml">⁢</mo><mi id="S4.SS4.SSS3.p2.2.m2.1.1.3.2.8" xref="S4.SS4.SSS3.p2.2.m2.1.1.3.2.8.cmml">E</mi><mo id="S4.SS4.SSS3.p2.2.m2.1.1.3.2.1f" xref="S4.SS4.SSS3.p2.2.m2.1.1.3.2.1.cmml">⁢</mo><mi id="S4.SS4.SSS3.p2.2.m2.1.1.3.2.9" xref="S4.SS4.SSS3.p2.2.m2.1.1.3.2.9.cmml">R</mi><mo id="S4.SS4.SSS3.p2.2.m2.1.1.3.2.1g" xref="S4.SS4.SSS3.p2.2.m2.1.1.3.2.1.cmml">⁢</mo><mi id="S4.SS4.SSS3.p2.2.m2.1.1.3.2.10" xref="S4.SS4.SSS3.p2.2.m2.1.1.3.2.10.cmml">P</mi></mrow><mo id="S4.SS4.SSS3.p2.2.m2.1.1.3.1" xref="S4.SS4.SSS3.p2.2.m2.1.1.3.1.cmml">+</mo><mrow id="S4.SS4.SSS3.p2.2.m2.1.1.3.3" xref="S4.SS4.SSS3.p2.2.m2.1.1.3.3.cmml"><mi id="S4.SS4.SSS3.p2.2.m2.1.1.3.3.2" xref="S4.SS4.SSS3.p2.2.m2.1.1.3.3.2.cmml">C</mi><mo id="S4.SS4.SSS3.p2.2.m2.1.1.3.3.1" xref="S4.SS4.SSS3.p2.2.m2.1.1.3.3.1.cmml">⁢</mo><mi id="S4.SS4.SSS3.p2.2.m2.1.1.3.3.3" xref="S4.SS4.SSS3.p2.2.m2.1.1.3.3.3.cmml">P</mi><mo id="S4.SS4.SSS3.p2.2.m2.1.1.3.3.1a" xref="S4.SS4.SSS3.p2.2.m2.1.1.3.3.1.cmml">⁢</mo><mi id="S4.SS4.SSS3.p2.2.m2.1.1.3.3.4" xref="S4.SS4.SSS3.p2.2.m2.1.1.3.3.4.cmml">O</mi></mrow></mrow></msub><annotation-xml encoding="MathML-Content" id="S4.SS4.SSS3.p2.2.m2.1b"><apply id="S4.SS4.SSS3.p2.2.m2.1.1.cmml" xref="S4.SS4.SSS3.p2.2.m2.1.1"><csymbol cd="ambiguous" id="S4.SS4.SSS3.p2.2.m2.1.1.1.cmml" xref="S4.SS4.SSS3.p2.2.m2.1.1">subscript</csymbol><ci id="S4.SS4.SSS3.p2.2.m2.1.1.2.cmml" xref="S4.SS4.SSS3.p2.2.m2.1.1.2">Δ</ci><apply id="S4.SS4.SSS3.p2.2.m2.1.1.3.cmml" xref="S4.SS4.SSS3.p2.2.m2.1.1.3"><plus id="S4.SS4.SSS3.p2.2.m2.1.1.3.1.cmml" xref="S4.SS4.SSS3.p2.2.m2.1.1.3.1"></plus><apply id="S4.SS4.SSS3.p2.2.m2.1.1.3.2.cmml" xref="S4.SS4.SSS3.p2.2.m2.1.1.3.2"><times id="S4.SS4.SSS3.p2.2.m2.1.1.3.2.1.cmml" xref="S4.SS4.SSS3.p2.2.m2.1.1.3.2.1"></times><ci id="S4.SS4.SSS3.p2.2.m2.1.1.3.2.2.cmml" xref="S4.SS4.SSS3.p2.2.m2.1.1.3.2.2">𝐶</ci><ci id="S4.SS4.SSS3.p2.2.m2.1.1.3.2.3.cmml" xref="S4.SS4.SSS3.p2.2.m2.1.1.3.2.3">𝑃</ci><ci id="S4.SS4.SSS3.p2.2.m2.1.1.3.2.4.cmml" xref="S4.SS4.SSS3.p2.2.m2.1.1.3.2.4">𝑂</ci><ci id="S4.SS4.SSS3.p2.2.m2.1.1.3.2.5a.cmml" xref="S4.SS4.SSS3.p2.2.m2.1.1.3.2.5"><mtext id="S4.SS4.SSS3.p2.2.m2.1.1.3.2.5.cmml" mathsize="70%" xref="S4.SS4.SSS3.p2.2.m2.1.1.3.2.5">vs</mtext></ci><ci id="S4.SS4.SSS3.p2.2.m2.1.1.3.2.6.cmml" xref="S4.SS4.SSS3.p2.2.m2.1.1.3.2.6">𝑆</ci><ci id="S4.SS4.SSS3.p2.2.m2.1.1.3.2.7.cmml" xref="S4.SS4.SSS3.p2.2.m2.1.1.3.2.7">𝐿</ci><ci id="S4.SS4.SSS3.p2.2.m2.1.1.3.2.8.cmml" xref="S4.SS4.SSS3.p2.2.m2.1.1.3.2.8">𝐸</ci><ci id="S4.SS4.SSS3.p2.2.m2.1.1.3.2.9.cmml" xref="S4.SS4.SSS3.p2.2.m2.1.1.3.2.9">𝑅</ci><ci id="S4.SS4.SSS3.p2.2.m2.1.1.3.2.10.cmml" xref="S4.SS4.SSS3.p2.2.m2.1.1.3.2.10">𝑃</ci></apply><apply id="S4.SS4.SSS3.p2.2.m2.1.1.3.3.cmml" xref="S4.SS4.SSS3.p2.2.m2.1.1.3.3"><times id="S4.SS4.SSS3.p2.2.m2.1.1.3.3.1.cmml" xref="S4.SS4.SSS3.p2.2.m2.1.1.3.3.1"></times><ci id="S4.SS4.SSS3.p2.2.m2.1.1.3.3.2.cmml" xref="S4.SS4.SSS3.p2.2.m2.1.1.3.3.2">𝐶</ci><ci id="S4.SS4.SSS3.p2.2.m2.1.1.3.3.3.cmml" xref="S4.SS4.SSS3.p2.2.m2.1.1.3.3.3">𝑃</ci><ci id="S4.SS4.SSS3.p2.2.m2.1.1.3.3.4.cmml" xref="S4.SS4.SSS3.p2.2.m2.1.1.3.3.4">𝑂</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS4.SSS3.p2.2.m2.1c">\Delta_{CPO\text{vs}SLERP+CPO}</annotation><annotation encoding="application/x-llamapun" id="S4.SS4.SSS3.p2.2.m2.1d">roman_Δ start_POSTSUBSCRIPT italic_C italic_P italic_O vs italic_S italic_L italic_E italic_R italic_P + italic_C italic_P italic_O end_POSTSUBSCRIPT</annotation></semantics></math> in Table <a class="ltx_ref" href="https://arxiv.org/html/2405.13984v1#S4.T4" title="Table 4 ‣ 4.4.2 Quantitative Analysis on Mixed Cross-Modals Fusion ‣ 4.4 Results ‣ 4 Experiments ‣ Feedback-aligned Mixed LLMs for Machine Language-Molecule Translation"><span class="ltx_text ltx_ref_tag">4</span></a>). For molecule-to-language translation, the NLI win rates (<math alttext="\S" class="ltx_Math" display="inline" id="S4.SS4.SSS3.p2.3.m3.1"><semantics id="S4.SS4.SSS3.p2.3.m3.1a"><mi id="S4.SS4.SSS3.p2.3.m3.1.1" mathvariant="normal" xref="S4.SS4.SSS3.p2.3.m3.1.1.cmml">§</mi><annotation-xml encoding="MathML-Content" id="S4.SS4.SSS3.p2.3.m3.1b"><ci id="S4.SS4.SSS3.p2.3.m3.1.1.cmml" xref="S4.SS4.SSS3.p2.3.m3.1.1">§</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS4.SSS3.p2.3.m3.1c">\S</annotation><annotation encoding="application/x-llamapun" id="S4.SS4.SSS3.p2.3.m3.1d">§</annotation></semantics></math> <a class="ltx_ref" href="https://arxiv.org/html/2405.13984v1#S3.SS4" title="3.4 Evaluation Method for Assessing Hallucination in Chemical LLMs ‣ 3 Methodology ‣ Feedback-aligned Mixed LLMs for Machine Language-Molecule Translation"><span class="ltx_text ltx_ref_tag">3.4</span></a>) of SFT and TIES+DPO contradicted with the performance as reported in Tables <a class="ltx_ref" href="https://arxiv.org/html/2405.13984v1#S4.T1" title="Table 1 ‣ 4.4.1 Quantitative Analysis on Feedback-Aligned Optimisation Algorithms ‣ 4.4 Results ‣ 4 Experiments ‣ Feedback-aligned Mixed LLMs for Machine Language-Molecule Translation"><span class="ltx_text ltx_ref_tag">1</span></a> and <a class="ltx_ref" href="https://arxiv.org/html/2405.13984v1#S4.T3" title="Table 3 ‣ 4.4.2 Quantitative Analysis on Mixed Cross-Modals Fusion ‣ 4.4 Results ‣ 4 Experiments ‣ Feedback-aligned Mixed LLMs for Machine Language-Molecule Translation"><span class="ltx_text ltx_ref_tag">3</span></a>, while CPO and SLERP+CPO exhibited consistency with the evaluation metrics in those tables. Although NLI evaluation generally surpasses statistical methods when assessing generated outputs against expected references, it still faces limitations, including accuracy issues with lengthy texts and dependence on the quality of training data<cite class="ltx_cite ltx_citemacro_cite">McIntosh et al. (<a class="ltx_ref" href="https://arxiv.org/html/2405.13984v1#bib.bib21" title="">2024</a>)</cite>. In the future, we aim to explore more nuanced methods that utilise appropriate LLMs for evaluating generated language <cite class="ltx_cite ltx_citemacro_cite">Min et al. (<a class="ltx_ref" href="https://arxiv.org/html/2405.13984v1#bib.bib22" title="">2023</a>)</cite>.</p>
</div>
<figure class="ltx_figure" id="S4.F2"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_missing ltx_missing_image" id="S4.F2.g1" src=""/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 2: </span>(A) Win rate of top-performing models in at least one cross-modal setting against Meditron. (B) A case study demonstrating that our best models learn to synthesise concepts rather than memorising patterns. More samples available in Appx. <a class="ltx_ref" href="https://arxiv.org/html/2405.13984v1#A5" title="Appendix E Examples of Language-Molecule Translation ‣ Feedback-aligned Mixed LLMs for Machine Language-Molecule Translation"><span class="ltx_text ltx_ref_tag">E</span></a></figcaption>
</figure>
</section>
</section>
</section>
<section class="ltx_section" id="S5">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">5 </span>Conclusion</h2>
<div class="ltx_para" id="S5.p1">
<p class="ltx_p" id="S5.p1.1">We focuse on the machine language-molecule translation, aiming to empirically tackle the challenges of effectively training robust large language models (LLMs) and addressing the out-of-distribution problem when integrating with scientific modalities. Our approach marks the first endeavour to experiment with human-centric optimisation algorithms in the context of cross-modal representation learning, aligning cross-language-molecule modalities with preferred offline translations. To combat memorisation effects inherent in training large models on extensive datasets, we conduct experiments utilising only 10% of the available data. This strategy yields significant performance enhancements, surpassing the best benchmark model trained on extensive data by a wide margin, thus achieving new state-of-the-art levels. Additionally, we are the first to propose employing non-linear fusion for integrating cross-modal LLMs, addressing challenges related to disparities in the informativeness of different modalities and limitations of optimisation algorithms requiring LLMs trained on extensive data. This approach further enhances performance gains without increasing training costs or data requirements. Finally, we introduce a freely-tied domain evaluation method with multi-aspect criteria for assessing the presence of hallucinations in chemical LLMs. In the future, we aim to investigate more nuanced algorithms for capturing language-molecule dynamics and evaluation methods to promote their responsible use.</p>
</div>
</section>
<section class="ltx_bibliography" id="bib">
<h2 class="ltx_title ltx_title_bibliography">References</h2>
<ul class="ltx_biblist">
<li class="ltx_bibitem" id="bib.bib1">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">AI4Science and Quantum [2023]</span>
<span class="ltx_bibblock">
Microsoft Research AI4Science and Microsoft Azure Quantum.

</span>
<span class="ltx_bibblock">The impact of large language models on scientific discovery: a preliminary study using gpt-4.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib1.1.1">arXiv preprint arXiv:2311.07361</em>, 2023.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib2">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Bradley and Terry [1952]</span>
<span class="ltx_bibblock">
Ralph Allan Bradley and Milton E Terry.

</span>
<span class="ltx_bibblock">Rank analysis of incomplete block designs: I. the method of paired comparisons.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib2.1.1">Biometrika</em>, 39(3/4):324–345, 1952.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib3">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Brown et al. [2020]</span>
<span class="ltx_bibblock">
Tom Brown, Benjamin Mann, Nick Ryder, Melanie Subbiah, Jared D Kaplan, Prafulla Dhariwal, Arvind Neelakantan, Pranav Shyam, Girish Sastry, Amanda Askell, et al.

</span>
<span class="ltx_bibblock">Language models are few-shot learners.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib3.1.1">Advances in neural information processing systems</em>, 33:1877–1901, 2020.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib4">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Chen et al. [2023]</span>
<span class="ltx_bibblock">
Zeming Chen, Alejandro Hernández Cano, Angelika Romanou, Antoine Bonnet, Kyle Matoba, Francesco Salvi, Matteo Pagliardini, Simin Fan, Andreas Köpf, Amirkeivan Mohtashami, et al.

</span>
<span class="ltx_bibblock">Meditron-70b: Scaling medical pretraining for large language models.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib4.1.1">arXiv preprint arXiv:2311.16079</em>, 2023.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib5">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Christofidellis et al. [2023]</span>
<span class="ltx_bibblock">
Dimitrios Christofidellis, Giorgio Giannone, Jannis Born, Ole Winther, Teodoro Laino, and Matteo Manica.

</span>
<span class="ltx_bibblock">Unifying molecular and textual representations via multi-task language modelling.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib5.1.1">International Conference on Machine Learning</em>, pages 6140–6157. PMLR, 2023.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib6">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Dettmers et al. [2024]</span>
<span class="ltx_bibblock">
Tim Dettmers, Artidoro Pagnoni, Ari Holtzman, and Luke Zettlemoyer.

</span>
<span class="ltx_bibblock">Qlora: Efficient finetuning of quantized llms.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib6.1.1">Advances in Neural Information Processing Systems</em>, 36, 2024.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib7">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Edwards et al. [2021]</span>
<span class="ltx_bibblock">
Carl Edwards, ChengXiang Zhai, and Heng Ji.

</span>
<span class="ltx_bibblock">Text2mol: Cross-modal molecule retrieval with natural language queries.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib7.1.1">Proceedings of the 2021 Conference on Empirical Methods in Natural Language Processing</em>, pages 595–607, 2021.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib8">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Edwards et al. [2022]</span>
<span class="ltx_bibblock">
Carl Edwards, Tuan Lai, Kevin Ros, Garrett Honke, Kyunghyun Cho, and Heng Ji.

</span>
<span class="ltx_bibblock">Translation between molecules and natural language.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib8.1.1">Proceedings of the 2022 Conference on Empirical Methods in Natural Language Processing</em>, pages 375–413, 2022.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib9">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Edwards et al. [2024]</span>
<span class="ltx_bibblock">
Carl Edwards, Qingyun Wang, Lawrence Zhao, and Heng Ji.

</span>
<span class="ltx_bibblock">L+ m-24: Building a dataset for language+ molecules@ acl 2024.

</span>
<span class="ltx_bibblock">2024.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib10">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Ethayarajh et al. [2024]</span>
<span class="ltx_bibblock">
Kawin Ethayarajh, Winnie Xu, Niklas Muennighoff, Dan Jurafsky, and Douwe Kiela.

</span>
<span class="ltx_bibblock">Kto: Model alignment as prospect theoretic optimization.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib10.1.1">arXiv preprint arXiv:2402.01306</em>, 2024.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib11">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Ferguson and Gray [2018]</span>
<span class="ltx_bibblock">
Fleur M Ferguson and Nathanael S Gray.

</span>
<span class="ltx_bibblock">Kinase inhibitors: the road ahead.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib11.1.1">Nature reviews Drug discovery</em>, 17(5):353–377, 2018.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib12">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">He et al. [2021]</span>
<span class="ltx_bibblock">
Pengcheng He, Jianfeng Gao, and Weizhu Chen.

</span>
<span class="ltx_bibblock">Debertav3: Improving deberta using electra-style pre-training with gradient-disentangled embedding sharing.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib12.1.1">arXiv preprint arXiv:2111.09543</em>, 2021.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib13">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Hejna et al. [2023]</span>
<span class="ltx_bibblock">
Joey Hejna, Rafael Rafailov, Harshit Sikchi, Chelsea Finn, Scott Niekum, W Bradley Knox, and Dorsa Sadigh.

</span>
<span class="ltx_bibblock">Contrastive prefence learning: Learning from human feedback without rl.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib13.1.1">arXiv preprint arXiv:2310.13639</em>, 2023.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib14">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Jaeger et al. [2018]</span>
<span class="ltx_bibblock">
Sabrina Jaeger, Simone Fulle, and Samo Turk.

</span>
<span class="ltx_bibblock">Mol2vec: unsupervised machine learning approach with chemical intuition.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib14.1.1">Journal of chemical information and modeling</em>, 58(1):27–35, 2018.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib15">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Kippelen and Brédas [2009]</span>
<span class="ltx_bibblock">
Bernard Kippelen and Jean-Luc Brédas.

</span>
<span class="ltx_bibblock">Organic photovoltaics.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib15.1.1">Energy &amp; Environmental Science</em>, 2(3):251–261, 2009.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib16">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Liu et al. [2024]</span>
<span class="ltx_bibblock">
Alisa Liu, Xiaochuang Han, Yizhong Wang, Yulia Tsvetkov, Yejin Choi, and Noah A Smith.

</span>
<span class="ltx_bibblock">Tuning language models by proxy.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib16.1.1">arXiv preprint arXiv:2401.08565</em>, 2024.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib17">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Liu et al. [2023a]</span>
<span class="ltx_bibblock">
Shengchao Liu, Weili Nie, Chengpeng Wang, Jiarui Lu, Zhuoran Qiao, Ling Liu, Jian Tang, Chaowei Xiao, and Animashree Anandkumar.

</span>
<span class="ltx_bibblock">Multi-modal molecule structure–text model for text-based retrieval and editing.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib17.1.1">Nature Machine Intelligence</em>, 5(12):1447–1457, 2023a.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib18">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Liu et al. [2023b]</span>
<span class="ltx_bibblock">
Zequn Liu, Wei Zhang, Yingce Xia, Lijun Wu, Shufang Xie, Tao Qin, Ming Zhang, and Tie-Yan Liu.

</span>
<span class="ltx_bibblock">Molxpt: Wrapping molecules with text for generative pre-training.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib18.1.1">arXiv preprint arXiv:2305.10688</em>, 2023b.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib19">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Lu and Zhang [2022]</span>
<span class="ltx_bibblock">
Jieyu Lu and Yingkai Zhang.

</span>
<span class="ltx_bibblock">Unified deep learning model for multitask reaction predictions with explanation.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib19.1.1">Journal of chemical information and modeling</em>, 62(6):1376–1387, 2022.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib20">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Luo et al. [2023]</span>
<span class="ltx_bibblock">
Yizhen Luo, Kai Yang, Massimo Hong, Xingyi Liu, and Zaiqing Nie.

</span>
<span class="ltx_bibblock">Molfm: A multimodal molecular foundation model.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib20.1.1">arXiv preprint arXiv:2307.09484</em>, 2023.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib21">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">McIntosh et al. [2024]</span>
<span class="ltx_bibblock">
Timothy R McIntosh, Teo Susnjak, Tong Liu, Paul Watters, and Malka N Halgamuge.

</span>
<span class="ltx_bibblock">Inadequacies of large language model benchmarks in the era of generative artificial intelligence.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib21.1.1">arXiv preprint arXiv:2402.09880</em>, 2024.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib22">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Min et al. [2023]</span>
<span class="ltx_bibblock">
Sewon Min, Kalpesh Krishna, Xinxi Lyu, Mike Lewis, Wen-tau Yih, Pang Koh, Mohit Iyyer, Luke Zettlemoyer, and Hannaneh Hajishirzi.

</span>
<span class="ltx_bibblock">Factscore: Fine-grained atomic evaluation of factual precision in long form text generation.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib22.1.1">Proceedings of the 2023 Conference on Empirical Methods in Natural Language Processing</em>, pages 12076–12100, 2023.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib23">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Ouyang et al. [2022]</span>
<span class="ltx_bibblock">
Long Ouyang, Jeffrey Wu, Xu Jiang, Diogo Almeida, Carroll Wainwright, Pamela Mishkin, Chong Zhang, Sandhini Agarwal, Katarina Slama, Alex Ray, et al.

</span>
<span class="ltx_bibblock">Training language models to follow instructions with human feedback.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib23.1.1">Advances in neural information processing systems</em>, 35:27730–27744, 2022.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib24">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Popović [2015]</span>
<span class="ltx_bibblock">
Maja Popović.

</span>
<span class="ltx_bibblock">chrf: character n-gram f-score for automatic mt evaluation.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib24.1.1">Proceedings of the tenth workshop on statistical machine translation</em>, pages 392–395, 2015.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib25">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Radford et al. [2019]</span>
<span class="ltx_bibblock">
Alec Radford, Jeffrey Wu, Rewon Child, David Luan, Dario Amodei, Ilya Sutskever, et al.

</span>
<span class="ltx_bibblock">Language models are unsupervised multitask learners.

</span>
<span class="ltx_bibblock">2019.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib26">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Rafailov et al. [2024]</span>
<span class="ltx_bibblock">
Rafael Rafailov, Archit Sharma, Eric Mitchell, Christopher D Manning, Stefano Ermon, and Chelsea Finn.

</span>
<span class="ltx_bibblock">Direct preference optimization: Your language model is secretly a reward model.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib26.1.1">Advances in Neural Information Processing Systems</em>, 36, 2024.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib27">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Schulman et al. [2017]</span>
<span class="ltx_bibblock">
John Schulman, Filip Wolski, Prafulla Dhariwal, Alec Radford, and Oleg Klimov.

</span>
<span class="ltx_bibblock">Proximal policy optimization algorithms.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib27.1.1">arXiv preprint arXiv:1707.06347</em>, 2017.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib28">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Schwaller et al. [2019]</span>
<span class="ltx_bibblock">
Philippe Schwaller, Teodoro Laino, Théophile Gaudin, Peter Bolgar, Christopher A Hunter, Costas Bekas, and Alpha A Lee.

</span>
<span class="ltx_bibblock">Molecular transformer: a model for uncertainty-calibrated chemical reaction prediction.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib28.1.1">ACS central science</em>, 5(9):1572–1583, 2019.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib29">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Sets [2022]</span>
<span class="ltx_bibblock">
Molecular Sets.

</span>
<span class="ltx_bibblock">A benchmarking platform for molecular generation models., 2022.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib30">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Shoemake [1985]</span>
<span class="ltx_bibblock">
Ken Shoemake.

</span>
<span class="ltx_bibblock">Animating rotation with quaternion curves.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib30.1.1">Proceedings of the 12th annual conference on Computer graphics and interactive techniques</em>, pages 245–254, 1985.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib31">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Steck et al. [2024]</span>
<span class="ltx_bibblock">
Harald Steck, Chaitanya Ekanadham, and Nathan Kallus.

</span>
<span class="ltx_bibblock">Is cosine-similarity of embeddings really about similarity?

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib31.1.1">arXiv preprint arXiv:2403.05440</em>, 2024.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib32">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Stiennon et al. [2020]</span>
<span class="ltx_bibblock">
Nisan Stiennon, Long Ouyang, Jeffrey Wu, Daniel Ziegler, Ryan Lowe, Chelsea Voss, Alec Radford, Dario Amodei, and Paul F Christiano.

</span>
<span class="ltx_bibblock">Learning to summarize with human feedback.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib32.1.1">Advances in Neural Information Processing Systems</em>, 33:3008–3021, 2020.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib33">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Touvron et al. [2023]</span>
<span class="ltx_bibblock">
Hugo Touvron, Louis Martin, Kevin Stone, Peter Albert, Amjad Almahairi, Yasmine Babaei, Nikolay Bashlykov, Soumya Batra, Prajjwal Bhargava, Shruti Bhosale, et al.

</span>
<span class="ltx_bibblock">Llama 2: Open foundation and fine-tuned chat models.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib33.1.1">arXiv preprint arXiv:2307.09288</em>, 2023.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib34">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Tversky and Kahneman [1992]</span>
<span class="ltx_bibblock">
Amos Tversky and Daniel Kahneman.

</span>
<span class="ltx_bibblock">Advances in prospect theory: Cumulative representation of uncertainty.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib34.1.1">Journal of Risk and uncertainty</em>, 5:297–323, 1992.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib35">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Vaucher et al. [2020]</span>
<span class="ltx_bibblock">
Alain C Vaucher, Federico Zipoli, Joppe Geluykens, Vishnu H Nair, Philippe Schwaller, and Teodoro Laino.

</span>
<span class="ltx_bibblock">Automated extraction of chemical synthesis actions from experimental procedures.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib35.1.1">Nature communications</em>, 11(1):3601, 2020.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib36">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Williams et al. [2018]</span>
<span class="ltx_bibblock">
Adina Williams, Nikita Nangia, and Samuel Bowman.

</span>
<span class="ltx_bibblock">A broad-coverage challenge corpus for sentence understanding through inference.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib36.1.1">Proceedings of the 2018 Conference of the North American Chapter of the Association for Computational Linguistics: Human Language Technologies, Volume 1 (Long Papers)</em>, pages 1112–1122, 2018.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib37">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Wortsman et al. [2022]</span>
<span class="ltx_bibblock">
Mitchell Wortsman, Gabriel Ilharco, Samir Ya Gadre, Rebecca Roelofs, Raphael Gontijo-Lopes, Ari S Morcos, Hongseok Namkoong, Ali Farhadi, Yair Carmon, Simon Kornblith, et al.

</span>
<span class="ltx_bibblock">Model soups: averaging weights of multiple fine-tuned models improves accuracy without increasing inference time.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib37.1.1">International conference on machine learning</em>, pages 23965–23998. PMLR, 2022.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib38">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Xu et al. [2023]</span>
<span class="ltx_bibblock">
Haoran Xu, Young Jin Kim, Amr Sharaf, and Hany Hassan Awadalla.

</span>
<span class="ltx_bibblock">A paradigm shift in machine translation: Boosting translation performance of large language models.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib38.1.1">arXiv preprint arXiv:2309.11674</em>, 2023.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib39">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Xu et al. [2024]</span>
<span class="ltx_bibblock">
Haoran Xu, Amr Sharaf, Yunmo Chen, Weiting Tan, Lingfeng Shen, Benjamin Van Durme, Kenton Murray, and Young Jin Kim.

</span>
<span class="ltx_bibblock">Contrastive preference optimization: Pushing the boundaries of llm performance in machine translation.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib39.1.1">arXiv preprint arXiv:2401.08417</em>, 2024.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib40">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Yadav et al. [2024]</span>
<span class="ltx_bibblock">
Prateek Yadav, Derek Tam, Leshem Choshen, Colin A Raffel, and Mohit Bansal.

</span>
<span class="ltx_bibblock">Ties-merging: Resolving interference when merging models.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib40.1.1">Advances in Neural Information Processing Systems</em>, 36, 2024.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib41">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Zhang et al. [2024]</span>
<span class="ltx_bibblock">
Di Zhang, Wei Liu, Qian Tan, Jingdan Chen, Hang Yan, Yuliang Yan, Jiatong Li, Weiran Huang, Xiangyu Yue, Dongzhan Zhou, et al.

</span>
<span class="ltx_bibblock">Chemllm: A chemical large language model.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib41.1.1">arXiv preprint arXiv:2402.06852</em>, 2024.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib42">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">[42]</span>
<span class="ltx_bibblock">
X Zhang, L Wang, J Helwig, Y Luo, C Fu, Y Xie, M Liu, Y Lin, Z Xu, K Yan, et al.

</span>
<span class="ltx_bibblock">Artificial intelligence for science in quantum, atomistic, and continuum systems. arxiv 2023.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib42.1.1">arXiv preprint arXiv:2307.08423</em>.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib43">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Zhao et al. [2022]</span>
<span class="ltx_bibblock">
Yao Zhao, Mikhail Khalman, Rishabh Joshi, Shashi Narayan, Mohammad Saleh, and Peter J Liu.

</span>
<span class="ltx_bibblock">Calibrating sequence likelihood improves conditional language generation.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib43.1.1">The Eleventh International Conference on Learning Representations</em>, 2022.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib44">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Zheng et al. [2024]</span>
<span class="ltx_bibblock">
Chen Zheng, Ke Sun, Hang Wu, Chenguang Xi, and Xun Zhou.

</span>
<span class="ltx_bibblock">Balancing enhancement, harmlessness, and general capabilities: Enhancing conversational llms with direct rlhf.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib44.1.1">arXiv preprint arXiv:2403.02513</em>, 2024.

</span>
</li>
<li class="ltx_bibitem" id="bib.bib45">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Zhong et al. [2023]</span>
<span class="ltx_bibblock">
Ming Zhong, Siru Ouyang, Yizhu Jiao, Priyanka Kargupta, Leo Luo, Yanzhen Shen, Bobby Zhou, Xianrui Zhong, Xuan Liu, Hongxiang Li, et al.

</span>
<span class="ltx_bibblock">Reaction miner: An integrated system for chemical reaction extraction from textual data.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib45.1.1">Proceedings of the 2023 Conference on Empirical Methods in Natural Language Processing: System Demonstrations</em>, pages 389–402, 2023.

</span>
</li>
</ul>
</section>
<section class="ltx_appendix" id="A1">
<h2 class="ltx_title ltx_title_appendix">
<span class="ltx_tag ltx_tag_appendix">Appendix A </span>Related Work</h2>
<div class="ltx_para" id="A1.p1">
<p class="ltx_p" id="A1.p1.1">Specialised models tailored for chemistry have emerged, including Molecular Transformers <cite class="ltx_cite ltx_citemacro_cite">Schwaller et al. [<a class="ltx_ref" href="https://arxiv.org/html/2405.13984v1#bib.bib28" title="">2019</a>]</cite> and the RXN family <cite class="ltx_cite ltx_citemacro_cite">Vaucher et al. [<a class="ltx_ref" href="https://arxiv.org/html/2405.13984v1#bib.bib35" title="">2020</a>]</cite>, which tackle tasks such as forward reaction prediction and molecular retrosynthesis. Yet, these models necessitate distinct architectures for individual tasks, resulting in heightened computational demands and a prerequisite for domain-specific proficiency in each task.</p>
</div>
<div class="ltx_para" id="A1.p2">
<p class="ltx_p" id="A1.p2.1">T5Chem <cite class="ltx_cite ltx_citemacro_cite">Lu and Zhang [<a class="ltx_ref" href="https://arxiv.org/html/2405.13984v1#bib.bib19" title="">2022</a>]</cite> introduces a cohesive multi-tasking framework for chemistry, leveraging a singular model for tasks spanning reaction prediction, regression, and classification. Nonetheless, T5Chem’s reliance on task-specific heads confines its utility to the chemical realm, thus constraining its adaptability across diverse sub-domains.</p>
</div>
<div class="ltx_para" id="A1.p3">
<p class="ltx_p" id="A1.p3.1">MolT5 <cite class="ltx_cite ltx_citemacro_cite">Edwards et al. [<a class="ltx_ref" href="https://arxiv.org/html/2405.13984v1#bib.bib8" title="">2022</a>]</cite> confronts the intricate challenge of cross-domain generation by bridging natural language and chemistry, engaging in tasks like text-conditional de novo molecule generation and molecule captioning. Nonetheless, MolT5’s effectiveness is curtailed by its dependence on resource-intensive pre-training on extensive mono-modality datasets, alongside per-task fine-tuning for each multi-modal task. Consequently, this approach restricts MolT5’s potential to fully exploit the multi-tasking capabilities of T5 and to facilitate seamless information sharing between tasks.</p>
</div>
<div class="ltx_para" id="A1.p4">
<p class="ltx_p" id="A1.p4.1">A multi-task T5 model underwent training with a multi-task objective tailored to handle tasks across various domains, including chemistry-based tasks (mol2mol), textual-based tasks (text2text), and cross-domain tasks (mol2text and text2mol) <cite class="ltx_cite ltx_citemacro_cite">Christofidellis et al. [<a class="ltx_ref" href="https://arxiv.org/html/2405.13984v1#bib.bib5" title="">2023</a>]</cite>. However, the majority of these approaches focus on optimising specific tasks, with all of them heavily relying on supervised fine-tuning using extensive datasets.</p>
</div>
</section>
<section class="ltx_appendix" id="A2">
<h2 class="ltx_title ltx_title_appendix">
<span class="ltx_tag ltx_tag_appendix">Appendix B </span>Human-aware Loss Functions (HALOs)</h2>
<div class="ltx_theorem ltx_theorem_definition" id="Thmdefinition1">
<h6 class="ltx_title ltx_runin ltx_title_theorem">
<span class="ltx_tag ltx_tag_theorem"><span class="ltx_text ltx_font_bold" id="Thmdefinition1.1.1.1">Definition 1</span></span><span class="ltx_text ltx_font_bold" id="Thmdefinition1.2.2"> (HALOs)</span>
</h6>
<div class="ltx_para" id="Thmdefinition1.p1">
<p class="ltx_p" id="Thmdefinition1.p1.3"><span class="ltx_text ltx_font_italic" id="Thmdefinition1.p1.3.3">Let <math alttext="x\in X" class="ltx_Math" display="inline" id="Thmdefinition1.p1.1.1.m1.1"><semantics id="Thmdefinition1.p1.1.1.m1.1a"><mrow id="Thmdefinition1.p1.1.1.m1.1.1" xref="Thmdefinition1.p1.1.1.m1.1.1.cmml"><mi id="Thmdefinition1.p1.1.1.m1.1.1.2" xref="Thmdefinition1.p1.1.1.m1.1.1.2.cmml">x</mi><mo id="Thmdefinition1.p1.1.1.m1.1.1.1" xref="Thmdefinition1.p1.1.1.m1.1.1.1.cmml">∈</mo><mi id="Thmdefinition1.p1.1.1.m1.1.1.3" xref="Thmdefinition1.p1.1.1.m1.1.1.3.cmml">X</mi></mrow><annotation-xml encoding="MathML-Content" id="Thmdefinition1.p1.1.1.m1.1b"><apply id="Thmdefinition1.p1.1.1.m1.1.1.cmml" xref="Thmdefinition1.p1.1.1.m1.1.1"><in id="Thmdefinition1.p1.1.1.m1.1.1.1.cmml" xref="Thmdefinition1.p1.1.1.m1.1.1.1"></in><ci id="Thmdefinition1.p1.1.1.m1.1.1.2.cmml" xref="Thmdefinition1.p1.1.1.m1.1.1.2">𝑥</ci><ci id="Thmdefinition1.p1.1.1.m1.1.1.3.cmml" xref="Thmdefinition1.p1.1.1.m1.1.1.3">𝑋</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="Thmdefinition1.p1.1.1.m1.1c">x\in X</annotation><annotation encoding="application/x-llamapun" id="Thmdefinition1.p1.1.1.m1.1d">italic_x ∈ italic_X</annotation></semantics></math> and <math alttext="y\in Y" class="ltx_Math" display="inline" id="Thmdefinition1.p1.2.2.m2.1"><semantics id="Thmdefinition1.p1.2.2.m2.1a"><mrow id="Thmdefinition1.p1.2.2.m2.1.1" xref="Thmdefinition1.p1.2.2.m2.1.1.cmml"><mi id="Thmdefinition1.p1.2.2.m2.1.1.2" xref="Thmdefinition1.p1.2.2.m2.1.1.2.cmml">y</mi><mo id="Thmdefinition1.p1.2.2.m2.1.1.1" xref="Thmdefinition1.p1.2.2.m2.1.1.1.cmml">∈</mo><mi id="Thmdefinition1.p1.2.2.m2.1.1.3" xref="Thmdefinition1.p1.2.2.m2.1.1.3.cmml">Y</mi></mrow><annotation-xml encoding="MathML-Content" id="Thmdefinition1.p1.2.2.m2.1b"><apply id="Thmdefinition1.p1.2.2.m2.1.1.cmml" xref="Thmdefinition1.p1.2.2.m2.1.1"><in id="Thmdefinition1.p1.2.2.m2.1.1.1.cmml" xref="Thmdefinition1.p1.2.2.m2.1.1.1"></in><ci id="Thmdefinition1.p1.2.2.m2.1.1.2.cmml" xref="Thmdefinition1.p1.2.2.m2.1.1.2">𝑦</ci><ci id="Thmdefinition1.p1.2.2.m2.1.1.3.cmml" xref="Thmdefinition1.p1.2.2.m2.1.1.3">𝑌</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="Thmdefinition1.p1.2.2.m2.1c">y\in Y</annotation><annotation encoding="application/x-llamapun" id="Thmdefinition1.p1.2.2.m2.1d">italic_y ∈ italic_Y</annotation></semantics></math> denote an input and output respectively. An <math alttext="f:(x,y)\rightarrow\mathbb{R}" class="ltx_Math" display="inline" id="Thmdefinition1.p1.3.3.m3.2"><semantics id="Thmdefinition1.p1.3.3.m3.2a"><mrow id="Thmdefinition1.p1.3.3.m3.2.3" xref="Thmdefinition1.p1.3.3.m3.2.3.cmml"><mi id="Thmdefinition1.p1.3.3.m3.2.3.2" xref="Thmdefinition1.p1.3.3.m3.2.3.2.cmml">f</mi><mo id="Thmdefinition1.p1.3.3.m3.2.3.1" lspace="0.278em" rspace="0.278em" xref="Thmdefinition1.p1.3.3.m3.2.3.1.cmml">:</mo><mrow id="Thmdefinition1.p1.3.3.m3.2.3.3" xref="Thmdefinition1.p1.3.3.m3.2.3.3.cmml"><mrow id="Thmdefinition1.p1.3.3.m3.2.3.3.2.2" xref="Thmdefinition1.p1.3.3.m3.2.3.3.2.1.cmml"><mo id="Thmdefinition1.p1.3.3.m3.2.3.3.2.2.1" stretchy="false" xref="Thmdefinition1.p1.3.3.m3.2.3.3.2.1.cmml">(</mo><mi id="Thmdefinition1.p1.3.3.m3.1.1" xref="Thmdefinition1.p1.3.3.m3.1.1.cmml">x</mi><mo id="Thmdefinition1.p1.3.3.m3.2.3.3.2.2.2" xref="Thmdefinition1.p1.3.3.m3.2.3.3.2.1.cmml">,</mo><mi id="Thmdefinition1.p1.3.3.m3.2.2" xref="Thmdefinition1.p1.3.3.m3.2.2.cmml">y</mi><mo id="Thmdefinition1.p1.3.3.m3.2.3.3.2.2.3" stretchy="false" xref="Thmdefinition1.p1.3.3.m3.2.3.3.2.1.cmml">)</mo></mrow><mo id="Thmdefinition1.p1.3.3.m3.2.3.3.1" stretchy="false" xref="Thmdefinition1.p1.3.3.m3.2.3.3.1.cmml">→</mo><mi id="Thmdefinition1.p1.3.3.m3.2.3.3.3" mathvariant="normal" xref="Thmdefinition1.p1.3.3.m3.2.3.3.3.cmml">ℝ</mi></mrow></mrow><annotation-xml encoding="MathML-Content" id="Thmdefinition1.p1.3.3.m3.2b"><apply id="Thmdefinition1.p1.3.3.m3.2.3.cmml" xref="Thmdefinition1.p1.3.3.m3.2.3"><ci id="Thmdefinition1.p1.3.3.m3.2.3.1.cmml" xref="Thmdefinition1.p1.3.3.m3.2.3.1">:</ci><ci id="Thmdefinition1.p1.3.3.m3.2.3.2.cmml" xref="Thmdefinition1.p1.3.3.m3.2.3.2">𝑓</ci><apply id="Thmdefinition1.p1.3.3.m3.2.3.3.cmml" xref="Thmdefinition1.p1.3.3.m3.2.3.3"><ci id="Thmdefinition1.p1.3.3.m3.2.3.3.1.cmml" xref="Thmdefinition1.p1.3.3.m3.2.3.3.1">→</ci><interval closure="open" id="Thmdefinition1.p1.3.3.m3.2.3.3.2.1.cmml" xref="Thmdefinition1.p1.3.3.m3.2.3.3.2.2"><ci id="Thmdefinition1.p1.3.3.m3.1.1.cmml" xref="Thmdefinition1.p1.3.3.m3.1.1">𝑥</ci><ci id="Thmdefinition1.p1.3.3.m3.2.2.cmml" xref="Thmdefinition1.p1.3.3.m3.2.2">𝑦</ci></interval><ci id="Thmdefinition1.p1.3.3.m3.2.3.3.3.cmml" xref="Thmdefinition1.p1.3.3.m3.2.3.3.3">ℝ</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="Thmdefinition1.p1.3.3.m3.2c">f:(x,y)\rightarrow\mathbb{R}</annotation><annotation encoding="application/x-llamapun" id="Thmdefinition1.p1.3.3.m3.2d">italic_f : ( italic_x , italic_y ) → roman_ℝ</annotation></semantics></math> is considered a human-aware loss function if it satisfies</span></p>
<table class="ltx_equation ltx_eqn_table" id="A2.E14">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="f(x,y;\theta)=t\Bigr{(}v_{f}\bigr{(}r_{\theta}(x,y)-\mathbb{E}_{x^{\prime}\sim
Q%
^{\prime},y^{\prime}\sim Q^{\prime}}[r_{\theta}(x^{\prime},y^{\prime})]\bigr{)%
}\Bigr{)}" class="ltx_math_unparsed" display="block" id="A2.E14.m1.5"><semantics id="A2.E14.m1.5a"><mrow id="A2.E14.m1.5b"><mrow id="A2.E14.m1.5.6"><mrow id="A2.E14.m1.5.6.1"><mrow id="A2.E14.m1.5.6.1.1"><mi id="A2.E14.m1.5.6.1.1.1">f</mi><mrow id="A2.E14.m1.5.6.1.1.2"><mo id="A2.E14.m1.5.6.1.1.2.1" stretchy="false">(</mo><mi id="A2.E14.m1.3.3">x</mi><mo id="A2.E14.m1.5.6.1.1.2.2">,</mo><mi id="A2.E14.m1.4.4">y</mi><mo id="A2.E14.m1.5.6.1.1.2.3">;</mo><mi id="A2.E14.m1.5.5">θ</mi><mo id="A2.E14.m1.5.6.1.1.2.4" stretchy="false">)</mo></mrow><mo id="A2.E14.m1.5.6.1.1.3">=</mo><mi id="A2.E14.m1.5.6.1.1.4">t</mi><mo id="A2.E14.m1.5.6.1.1.5" lspace="0em" mathsize="160%" rspace="0em">(</mo></mrow><msub id="A2.E14.m1.5.6.1.2"><mi id="A2.E14.m1.5.6.1.2.2">v</mi><mi id="A2.E14.m1.5.6.1.2.3">f</mi></msub><mo id="A2.E14.m1.5.6.1.3" lspace="0em" mathsize="120%" rspace="0em">(</mo></mrow><msub id="A2.E14.m1.5.6.2"><mi id="A2.E14.m1.5.6.2.2">r</mi><mi id="A2.E14.m1.5.6.2.3">θ</mi></msub><mrow id="A2.E14.m1.5.6.3"><mo id="A2.E14.m1.5.6.3.1" stretchy="false">(</mo><mi id="A2.E14.m1.5.6.3.2">x</mi><mo id="A2.E14.m1.5.6.3.3">,</mo><mi id="A2.E14.m1.5.6.3.4">y</mi><mo id="A2.E14.m1.5.6.3.5" stretchy="false">)</mo></mrow><mo id="A2.E14.m1.5.6.4">−</mo><msub id="A2.E14.m1.5.6.5"><mi id="A2.E14.m1.5.6.5.2" mathvariant="normal">𝔼</mi><mrow id="A2.E14.m1.2.2.2.2"><mrow id="A2.E14.m1.1.1.1.1.1"><msup id="A2.E14.m1.1.1.1.1.1.2"><mi id="A2.E14.m1.1.1.1.1.1.2.2">x</mi><mo id="A2.E14.m1.1.1.1.1.1.2.3">′</mo></msup><mo id="A2.E14.m1.1.1.1.1.1.1">∼</mo><msup id="A2.E14.m1.1.1.1.1.1.3"><mi id="A2.E14.m1.1.1.1.1.1.3.2">Q</mi><mo id="A2.E14.m1.1.1.1.1.1.3.3">′</mo></msup></mrow><mo id="A2.E14.m1.2.2.2.2.3">,</mo><mrow id="A2.E14.m1.2.2.2.2.2"><msup id="A2.E14.m1.2.2.2.2.2.2"><mi id="A2.E14.m1.2.2.2.2.2.2.2">y</mi><mo id="A2.E14.m1.2.2.2.2.2.2.3">′</mo></msup><mo id="A2.E14.m1.2.2.2.2.2.1">∼</mo><msup id="A2.E14.m1.2.2.2.2.2.3"><mi id="A2.E14.m1.2.2.2.2.2.3.2">Q</mi><mo id="A2.E14.m1.2.2.2.2.2.3.3">′</mo></msup></mrow></mrow></msub><mrow id="A2.E14.m1.5.6.6"><mo id="A2.E14.m1.5.6.6.1" stretchy="false">[</mo><msub id="A2.E14.m1.5.6.6.2"><mi id="A2.E14.m1.5.6.6.2.2">r</mi><mi id="A2.E14.m1.5.6.6.2.3">θ</mi></msub><mrow id="A2.E14.m1.5.6.6.3"><mo id="A2.E14.m1.5.6.6.3.1" stretchy="false">(</mo><msup id="A2.E14.m1.5.6.6.3.2"><mi id="A2.E14.m1.5.6.6.3.2.2">x</mi><mo id="A2.E14.m1.5.6.6.3.2.3">′</mo></msup><mo id="A2.E14.m1.5.6.6.3.3">,</mo><msup id="A2.E14.m1.5.6.6.3.4"><mi id="A2.E14.m1.5.6.6.3.4.2">y</mi><mo id="A2.E14.m1.5.6.6.3.4.3">′</mo></msup><mo id="A2.E14.m1.5.6.6.3.5" stretchy="false">)</mo></mrow><mo id="A2.E14.m1.5.6.6.4" stretchy="false">]</mo></mrow><mo id="A2.E14.m1.5.6.7" maxsize="120%" minsize="120%">)</mo></mrow><mo id="A2.E14.m1.5.7" maxsize="160%" minsize="160%">)</mo></mrow><annotation encoding="application/x-tex" id="A2.E14.m1.5c">f(x,y;\theta)=t\Bigr{(}v_{f}\bigr{(}r_{\theta}(x,y)-\mathbb{E}_{x^{\prime}\sim
Q%
^{\prime},y^{\prime}\sim Q^{\prime}}[r_{\theta}(x^{\prime},y^{\prime})]\bigr{)%
}\Bigr{)}</annotation><annotation encoding="application/x-llamapun" id="A2.E14.m1.5d">italic_f ( italic_x , italic_y ; italic_θ ) = italic_t ( italic_v start_POSTSUBSCRIPT italic_f end_POSTSUBSCRIPT ( italic_r start_POSTSUBSCRIPT italic_θ end_POSTSUBSCRIPT ( italic_x , italic_y ) - roman_𝔼 start_POSTSUBSCRIPT italic_x start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT ∼ italic_Q start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT , italic_y start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT ∼ italic_Q start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT end_POSTSUBSCRIPT [ italic_r start_POSTSUBSCRIPT italic_θ end_POSTSUBSCRIPT ( italic_x start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT , italic_y start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT ) ] ) )</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_right">(14)</span></td>
</tr></tbody>
</table>
<p class="ltx_p" id="Thmdefinition1.p1.11"><span class="ltx_text ltx_font_italic" id="Thmdefinition1.p1.11.8">with a parameterised reward function <math alttext="r_{\theta}" class="ltx_Math" display="inline" id="Thmdefinition1.p1.4.1.m1.1"><semantics id="Thmdefinition1.p1.4.1.m1.1a"><msub id="Thmdefinition1.p1.4.1.m1.1.1" xref="Thmdefinition1.p1.4.1.m1.1.1.cmml"><mi id="Thmdefinition1.p1.4.1.m1.1.1.2" xref="Thmdefinition1.p1.4.1.m1.1.1.2.cmml">r</mi><mi id="Thmdefinition1.p1.4.1.m1.1.1.3" xref="Thmdefinition1.p1.4.1.m1.1.1.3.cmml">θ</mi></msub><annotation-xml encoding="MathML-Content" id="Thmdefinition1.p1.4.1.m1.1b"><apply id="Thmdefinition1.p1.4.1.m1.1.1.cmml" xref="Thmdefinition1.p1.4.1.m1.1.1"><csymbol cd="ambiguous" id="Thmdefinition1.p1.4.1.m1.1.1.1.cmml" xref="Thmdefinition1.p1.4.1.m1.1.1">subscript</csymbol><ci id="Thmdefinition1.p1.4.1.m1.1.1.2.cmml" xref="Thmdefinition1.p1.4.1.m1.1.1.2">𝑟</ci><ci id="Thmdefinition1.p1.4.1.m1.1.1.3.cmml" xref="Thmdefinition1.p1.4.1.m1.1.1.3">𝜃</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="Thmdefinition1.p1.4.1.m1.1c">r_{\theta}</annotation><annotation encoding="application/x-llamapun" id="Thmdefinition1.p1.4.1.m1.1d">italic_r start_POSTSUBSCRIPT italic_θ end_POSTSUBSCRIPT</annotation></semantics></math> such that <math alttext="\forall(x_{1},y_{1}),(x_{2},y_{2})\in X\times Y" class="ltx_Math" display="inline" id="Thmdefinition1.p1.5.2.m2.2"><semantics id="Thmdefinition1.p1.5.2.m2.2a"><mrow id="Thmdefinition1.p1.5.2.m2.2.2" xref="Thmdefinition1.p1.5.2.m2.2.2.cmml"><mrow id="Thmdefinition1.p1.5.2.m2.2.2.2.2" xref="Thmdefinition1.p1.5.2.m2.2.2.2.3.cmml"><mrow id="Thmdefinition1.p1.5.2.m2.1.1.1.1.1" xref="Thmdefinition1.p1.5.2.m2.1.1.1.1.1.cmml"><mo id="Thmdefinition1.p1.5.2.m2.1.1.1.1.1.3" xref="Thmdefinition1.p1.5.2.m2.1.1.1.1.1.3.cmml">∀</mo><mrow id="Thmdefinition1.p1.5.2.m2.1.1.1.1.1.2.2" xref="Thmdefinition1.p1.5.2.m2.1.1.1.1.1.2.3.cmml"><mo id="Thmdefinition1.p1.5.2.m2.1.1.1.1.1.2.2.3" stretchy="false" xref="Thmdefinition1.p1.5.2.m2.1.1.1.1.1.2.3.cmml">(</mo><msub id="Thmdefinition1.p1.5.2.m2.1.1.1.1.1.1.1.1" xref="Thmdefinition1.p1.5.2.m2.1.1.1.1.1.1.1.1.cmml"><mi id="Thmdefinition1.p1.5.2.m2.1.1.1.1.1.1.1.1.2" xref="Thmdefinition1.p1.5.2.m2.1.1.1.1.1.1.1.1.2.cmml">x</mi><mn id="Thmdefinition1.p1.5.2.m2.1.1.1.1.1.1.1.1.3" xref="Thmdefinition1.p1.5.2.m2.1.1.1.1.1.1.1.1.3.cmml">1</mn></msub><mo id="Thmdefinition1.p1.5.2.m2.1.1.1.1.1.2.2.4" xref="Thmdefinition1.p1.5.2.m2.1.1.1.1.1.2.3.cmml">,</mo><msub id="Thmdefinition1.p1.5.2.m2.1.1.1.1.1.2.2.2" xref="Thmdefinition1.p1.5.2.m2.1.1.1.1.1.2.2.2.cmml"><mi id="Thmdefinition1.p1.5.2.m2.1.1.1.1.1.2.2.2.2" xref="Thmdefinition1.p1.5.2.m2.1.1.1.1.1.2.2.2.2.cmml">y</mi><mn id="Thmdefinition1.p1.5.2.m2.1.1.1.1.1.2.2.2.3" xref="Thmdefinition1.p1.5.2.m2.1.1.1.1.1.2.2.2.3.cmml">1</mn></msub><mo id="Thmdefinition1.p1.5.2.m2.1.1.1.1.1.2.2.5" stretchy="false" xref="Thmdefinition1.p1.5.2.m2.1.1.1.1.1.2.3.cmml">)</mo></mrow></mrow><mo id="Thmdefinition1.p1.5.2.m2.2.2.2.2.3" xref="Thmdefinition1.p1.5.2.m2.2.2.2.3.cmml">,</mo><mrow id="Thmdefinition1.p1.5.2.m2.2.2.2.2.2.2" xref="Thmdefinition1.p1.5.2.m2.2.2.2.2.2.3.cmml"><mo id="Thmdefinition1.p1.5.2.m2.2.2.2.2.2.2.3" stretchy="false" xref="Thmdefinition1.p1.5.2.m2.2.2.2.2.2.3.cmml">(</mo><msub id="Thmdefinition1.p1.5.2.m2.2.2.2.2.2.1.1" xref="Thmdefinition1.p1.5.2.m2.2.2.2.2.2.1.1.cmml"><mi id="Thmdefinition1.p1.5.2.m2.2.2.2.2.2.1.1.2" xref="Thmdefinition1.p1.5.2.m2.2.2.2.2.2.1.1.2.cmml">x</mi><mn id="Thmdefinition1.p1.5.2.m2.2.2.2.2.2.1.1.3" xref="Thmdefinition1.p1.5.2.m2.2.2.2.2.2.1.1.3.cmml">2</mn></msub><mo id="Thmdefinition1.p1.5.2.m2.2.2.2.2.2.2.4" xref="Thmdefinition1.p1.5.2.m2.2.2.2.2.2.3.cmml">,</mo><msub id="Thmdefinition1.p1.5.2.m2.2.2.2.2.2.2.2" xref="Thmdefinition1.p1.5.2.m2.2.2.2.2.2.2.2.cmml"><mi id="Thmdefinition1.p1.5.2.m2.2.2.2.2.2.2.2.2" xref="Thmdefinition1.p1.5.2.m2.2.2.2.2.2.2.2.2.cmml">y</mi><mn id="Thmdefinition1.p1.5.2.m2.2.2.2.2.2.2.2.3" xref="Thmdefinition1.p1.5.2.m2.2.2.2.2.2.2.2.3.cmml">2</mn></msub><mo id="Thmdefinition1.p1.5.2.m2.2.2.2.2.2.2.5" stretchy="false" xref="Thmdefinition1.p1.5.2.m2.2.2.2.2.2.3.cmml">)</mo></mrow></mrow><mo id="Thmdefinition1.p1.5.2.m2.2.2.3" xref="Thmdefinition1.p1.5.2.m2.2.2.3.cmml">∈</mo><mrow id="Thmdefinition1.p1.5.2.m2.2.2.4" xref="Thmdefinition1.p1.5.2.m2.2.2.4.cmml"><mi id="Thmdefinition1.p1.5.2.m2.2.2.4.2" xref="Thmdefinition1.p1.5.2.m2.2.2.4.2.cmml">X</mi><mo id="Thmdefinition1.p1.5.2.m2.2.2.4.1" lspace="0.222em" rspace="0.222em" xref="Thmdefinition1.p1.5.2.m2.2.2.4.1.cmml">×</mo><mi id="Thmdefinition1.p1.5.2.m2.2.2.4.3" xref="Thmdefinition1.p1.5.2.m2.2.2.4.3.cmml">Y</mi></mrow></mrow><annotation-xml encoding="MathML-Content" id="Thmdefinition1.p1.5.2.m2.2b"><apply id="Thmdefinition1.p1.5.2.m2.2.2.cmml" xref="Thmdefinition1.p1.5.2.m2.2.2"><in id="Thmdefinition1.p1.5.2.m2.2.2.3.cmml" xref="Thmdefinition1.p1.5.2.m2.2.2.3"></in><list id="Thmdefinition1.p1.5.2.m2.2.2.2.3.cmml" xref="Thmdefinition1.p1.5.2.m2.2.2.2.2"><apply id="Thmdefinition1.p1.5.2.m2.1.1.1.1.1.cmml" xref="Thmdefinition1.p1.5.2.m2.1.1.1.1.1"><csymbol cd="latexml" id="Thmdefinition1.p1.5.2.m2.1.1.1.1.1.3.cmml" xref="Thmdefinition1.p1.5.2.m2.1.1.1.1.1.3">for-all</csymbol><interval closure="open" id="Thmdefinition1.p1.5.2.m2.1.1.1.1.1.2.3.cmml" xref="Thmdefinition1.p1.5.2.m2.1.1.1.1.1.2.2"><apply id="Thmdefinition1.p1.5.2.m2.1.1.1.1.1.1.1.1.cmml" xref="Thmdefinition1.p1.5.2.m2.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="Thmdefinition1.p1.5.2.m2.1.1.1.1.1.1.1.1.1.cmml" xref="Thmdefinition1.p1.5.2.m2.1.1.1.1.1.1.1.1">subscript</csymbol><ci id="Thmdefinition1.p1.5.2.m2.1.1.1.1.1.1.1.1.2.cmml" xref="Thmdefinition1.p1.5.2.m2.1.1.1.1.1.1.1.1.2">𝑥</ci><cn id="Thmdefinition1.p1.5.2.m2.1.1.1.1.1.1.1.1.3.cmml" type="integer" xref="Thmdefinition1.p1.5.2.m2.1.1.1.1.1.1.1.1.3">1</cn></apply><apply id="Thmdefinition1.p1.5.2.m2.1.1.1.1.1.2.2.2.cmml" xref="Thmdefinition1.p1.5.2.m2.1.1.1.1.1.2.2.2"><csymbol cd="ambiguous" id="Thmdefinition1.p1.5.2.m2.1.1.1.1.1.2.2.2.1.cmml" xref="Thmdefinition1.p1.5.2.m2.1.1.1.1.1.2.2.2">subscript</csymbol><ci id="Thmdefinition1.p1.5.2.m2.1.1.1.1.1.2.2.2.2.cmml" xref="Thmdefinition1.p1.5.2.m2.1.1.1.1.1.2.2.2.2">𝑦</ci><cn id="Thmdefinition1.p1.5.2.m2.1.1.1.1.1.2.2.2.3.cmml" type="integer" xref="Thmdefinition1.p1.5.2.m2.1.1.1.1.1.2.2.2.3">1</cn></apply></interval></apply><interval closure="open" id="Thmdefinition1.p1.5.2.m2.2.2.2.2.2.3.cmml" xref="Thmdefinition1.p1.5.2.m2.2.2.2.2.2.2"><apply id="Thmdefinition1.p1.5.2.m2.2.2.2.2.2.1.1.cmml" xref="Thmdefinition1.p1.5.2.m2.2.2.2.2.2.1.1"><csymbol cd="ambiguous" id="Thmdefinition1.p1.5.2.m2.2.2.2.2.2.1.1.1.cmml" xref="Thmdefinition1.p1.5.2.m2.2.2.2.2.2.1.1">subscript</csymbol><ci id="Thmdefinition1.p1.5.2.m2.2.2.2.2.2.1.1.2.cmml" xref="Thmdefinition1.p1.5.2.m2.2.2.2.2.2.1.1.2">𝑥</ci><cn id="Thmdefinition1.p1.5.2.m2.2.2.2.2.2.1.1.3.cmml" type="integer" xref="Thmdefinition1.p1.5.2.m2.2.2.2.2.2.1.1.3">2</cn></apply><apply id="Thmdefinition1.p1.5.2.m2.2.2.2.2.2.2.2.cmml" xref="Thmdefinition1.p1.5.2.m2.2.2.2.2.2.2.2"><csymbol cd="ambiguous" id="Thmdefinition1.p1.5.2.m2.2.2.2.2.2.2.2.1.cmml" xref="Thmdefinition1.p1.5.2.m2.2.2.2.2.2.2.2">subscript</csymbol><ci id="Thmdefinition1.p1.5.2.m2.2.2.2.2.2.2.2.2.cmml" xref="Thmdefinition1.p1.5.2.m2.2.2.2.2.2.2.2.2">𝑦</ci><cn id="Thmdefinition1.p1.5.2.m2.2.2.2.2.2.2.2.3.cmml" type="integer" xref="Thmdefinition1.p1.5.2.m2.2.2.2.2.2.2.2.3">2</cn></apply></interval></list><apply id="Thmdefinition1.p1.5.2.m2.2.2.4.cmml" xref="Thmdefinition1.p1.5.2.m2.2.2.4"><times id="Thmdefinition1.p1.5.2.m2.2.2.4.1.cmml" xref="Thmdefinition1.p1.5.2.m2.2.2.4.1"></times><ci id="Thmdefinition1.p1.5.2.m2.2.2.4.2.cmml" xref="Thmdefinition1.p1.5.2.m2.2.2.4.2">𝑋</ci><ci id="Thmdefinition1.p1.5.2.m2.2.2.4.3.cmml" xref="Thmdefinition1.p1.5.2.m2.2.2.4.3">𝑌</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="Thmdefinition1.p1.5.2.m2.2c">\forall(x_{1},y_{1}),(x_{2},y_{2})\in X\times Y</annotation><annotation encoding="application/x-llamapun" id="Thmdefinition1.p1.5.2.m2.2d">∀ ( italic_x start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT , italic_y start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT ) , ( italic_x start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT , italic_y start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT ) ∈ italic_X × italic_Y</annotation></semantics></math>, <math alttext="r_{\theta}(x_{1},y_{1})&gt;r_{\theta}(x_{2},y_{2})\Leftrightarrow(x_{1},y_{1})%
\succ_{r_{\theta}}(x_{2},y_{2})" class="ltx_Math" display="inline" id="Thmdefinition1.p1.6.3.m3.8"><semantics id="Thmdefinition1.p1.6.3.m3.8a"><mrow id="Thmdefinition1.p1.6.3.m3.8.8" xref="Thmdefinition1.p1.6.3.m3.8.8.cmml"><mrow id="Thmdefinition1.p1.6.3.m3.4.4.4" xref="Thmdefinition1.p1.6.3.m3.4.4.4.cmml"><mrow id="Thmdefinition1.p1.6.3.m3.2.2.2.2" xref="Thmdefinition1.p1.6.3.m3.2.2.2.2.cmml"><msub id="Thmdefinition1.p1.6.3.m3.2.2.2.2.4" xref="Thmdefinition1.p1.6.3.m3.2.2.2.2.4.cmml"><mi id="Thmdefinition1.p1.6.3.m3.2.2.2.2.4.2" xref="Thmdefinition1.p1.6.3.m3.2.2.2.2.4.2.cmml">r</mi><mi id="Thmdefinition1.p1.6.3.m3.2.2.2.2.4.3" xref="Thmdefinition1.p1.6.3.m3.2.2.2.2.4.3.cmml">θ</mi></msub><mo id="Thmdefinition1.p1.6.3.m3.2.2.2.2.3" xref="Thmdefinition1.p1.6.3.m3.2.2.2.2.3.cmml">⁢</mo><mrow id="Thmdefinition1.p1.6.3.m3.2.2.2.2.2.2" xref="Thmdefinition1.p1.6.3.m3.2.2.2.2.2.3.cmml"><mo id="Thmdefinition1.p1.6.3.m3.2.2.2.2.2.2.3" stretchy="false" xref="Thmdefinition1.p1.6.3.m3.2.2.2.2.2.3.cmml">(</mo><msub id="Thmdefinition1.p1.6.3.m3.1.1.1.1.1.1.1" xref="Thmdefinition1.p1.6.3.m3.1.1.1.1.1.1.1.cmml"><mi id="Thmdefinition1.p1.6.3.m3.1.1.1.1.1.1.1.2" xref="Thmdefinition1.p1.6.3.m3.1.1.1.1.1.1.1.2.cmml">x</mi><mn id="Thmdefinition1.p1.6.3.m3.1.1.1.1.1.1.1.3" xref="Thmdefinition1.p1.6.3.m3.1.1.1.1.1.1.1.3.cmml">1</mn></msub><mo id="Thmdefinition1.p1.6.3.m3.2.2.2.2.2.2.4" xref="Thmdefinition1.p1.6.3.m3.2.2.2.2.2.3.cmml">,</mo><msub id="Thmdefinition1.p1.6.3.m3.2.2.2.2.2.2.2" xref="Thmdefinition1.p1.6.3.m3.2.2.2.2.2.2.2.cmml"><mi id="Thmdefinition1.p1.6.3.m3.2.2.2.2.2.2.2.2" xref="Thmdefinition1.p1.6.3.m3.2.2.2.2.2.2.2.2.cmml">y</mi><mn id="Thmdefinition1.p1.6.3.m3.2.2.2.2.2.2.2.3" xref="Thmdefinition1.p1.6.3.m3.2.2.2.2.2.2.2.3.cmml">1</mn></msub><mo id="Thmdefinition1.p1.6.3.m3.2.2.2.2.2.2.5" stretchy="false" xref="Thmdefinition1.p1.6.3.m3.2.2.2.2.2.3.cmml">)</mo></mrow></mrow><mo id="Thmdefinition1.p1.6.3.m3.4.4.4.5" xref="Thmdefinition1.p1.6.3.m3.4.4.4.5.cmml">&gt;</mo><mrow id="Thmdefinition1.p1.6.3.m3.4.4.4.4" xref="Thmdefinition1.p1.6.3.m3.4.4.4.4.cmml"><msub id="Thmdefinition1.p1.6.3.m3.4.4.4.4.4" xref="Thmdefinition1.p1.6.3.m3.4.4.4.4.4.cmml"><mi id="Thmdefinition1.p1.6.3.m3.4.4.4.4.4.2" xref="Thmdefinition1.p1.6.3.m3.4.4.4.4.4.2.cmml">r</mi><mi id="Thmdefinition1.p1.6.3.m3.4.4.4.4.4.3" xref="Thmdefinition1.p1.6.3.m3.4.4.4.4.4.3.cmml">θ</mi></msub><mo id="Thmdefinition1.p1.6.3.m3.4.4.4.4.3" xref="Thmdefinition1.p1.6.3.m3.4.4.4.4.3.cmml">⁢</mo><mrow id="Thmdefinition1.p1.6.3.m3.4.4.4.4.2.2" xref="Thmdefinition1.p1.6.3.m3.4.4.4.4.2.3.cmml"><mo id="Thmdefinition1.p1.6.3.m3.4.4.4.4.2.2.3" stretchy="false" xref="Thmdefinition1.p1.6.3.m3.4.4.4.4.2.3.cmml">(</mo><msub id="Thmdefinition1.p1.6.3.m3.3.3.3.3.1.1.1" xref="Thmdefinition1.p1.6.3.m3.3.3.3.3.1.1.1.cmml"><mi id="Thmdefinition1.p1.6.3.m3.3.3.3.3.1.1.1.2" xref="Thmdefinition1.p1.6.3.m3.3.3.3.3.1.1.1.2.cmml">x</mi><mn id="Thmdefinition1.p1.6.3.m3.3.3.3.3.1.1.1.3" xref="Thmdefinition1.p1.6.3.m3.3.3.3.3.1.1.1.3.cmml">2</mn></msub><mo id="Thmdefinition1.p1.6.3.m3.4.4.4.4.2.2.4" xref="Thmdefinition1.p1.6.3.m3.4.4.4.4.2.3.cmml">,</mo><msub id="Thmdefinition1.p1.6.3.m3.4.4.4.4.2.2.2" xref="Thmdefinition1.p1.6.3.m3.4.4.4.4.2.2.2.cmml"><mi id="Thmdefinition1.p1.6.3.m3.4.4.4.4.2.2.2.2" xref="Thmdefinition1.p1.6.3.m3.4.4.4.4.2.2.2.2.cmml">y</mi><mn id="Thmdefinition1.p1.6.3.m3.4.4.4.4.2.2.2.3" xref="Thmdefinition1.p1.6.3.m3.4.4.4.4.2.2.2.3.cmml">2</mn></msub><mo id="Thmdefinition1.p1.6.3.m3.4.4.4.4.2.2.5" stretchy="false" xref="Thmdefinition1.p1.6.3.m3.4.4.4.4.2.3.cmml">)</mo></mrow></mrow></mrow><mo id="Thmdefinition1.p1.6.3.m3.8.8.9" stretchy="false" xref="Thmdefinition1.p1.6.3.m3.8.8.9.cmml">⇔</mo><mrow id="Thmdefinition1.p1.6.3.m3.8.8.8" xref="Thmdefinition1.p1.6.3.m3.8.8.8.cmml"><mrow id="Thmdefinition1.p1.6.3.m3.6.6.6.2.2" xref="Thmdefinition1.p1.6.3.m3.6.6.6.2.3.cmml"><mo id="Thmdefinition1.p1.6.3.m3.6.6.6.2.2.3" stretchy="false" xref="Thmdefinition1.p1.6.3.m3.6.6.6.2.3.cmml">(</mo><msub id="Thmdefinition1.p1.6.3.m3.5.5.5.1.1.1" xref="Thmdefinition1.p1.6.3.m3.5.5.5.1.1.1.cmml"><mi id="Thmdefinition1.p1.6.3.m3.5.5.5.1.1.1.2" xref="Thmdefinition1.p1.6.3.m3.5.5.5.1.1.1.2.cmml">x</mi><mn id="Thmdefinition1.p1.6.3.m3.5.5.5.1.1.1.3" xref="Thmdefinition1.p1.6.3.m3.5.5.5.1.1.1.3.cmml">1</mn></msub><mo id="Thmdefinition1.p1.6.3.m3.6.6.6.2.2.4" xref="Thmdefinition1.p1.6.3.m3.6.6.6.2.3.cmml">,</mo><msub id="Thmdefinition1.p1.6.3.m3.6.6.6.2.2.2" xref="Thmdefinition1.p1.6.3.m3.6.6.6.2.2.2.cmml"><mi id="Thmdefinition1.p1.6.3.m3.6.6.6.2.2.2.2" xref="Thmdefinition1.p1.6.3.m3.6.6.6.2.2.2.2.cmml">y</mi><mn id="Thmdefinition1.p1.6.3.m3.6.6.6.2.2.2.3" xref="Thmdefinition1.p1.6.3.m3.6.6.6.2.2.2.3.cmml">1</mn></msub><mo id="Thmdefinition1.p1.6.3.m3.6.6.6.2.2.5" stretchy="false" xref="Thmdefinition1.p1.6.3.m3.6.6.6.2.3.cmml">)</mo></mrow><msub id="Thmdefinition1.p1.6.3.m3.8.8.8.5" xref="Thmdefinition1.p1.6.3.m3.8.8.8.5.cmml"><mo id="Thmdefinition1.p1.6.3.m3.8.8.8.5.2" xref="Thmdefinition1.p1.6.3.m3.8.8.8.5.2.cmml">≻</mo><msub id="Thmdefinition1.p1.6.3.m3.8.8.8.5.3" xref="Thmdefinition1.p1.6.3.m3.8.8.8.5.3.cmml"><mi id="Thmdefinition1.p1.6.3.m3.8.8.8.5.3.2" xref="Thmdefinition1.p1.6.3.m3.8.8.8.5.3.2.cmml">r</mi><mi id="Thmdefinition1.p1.6.3.m3.8.8.8.5.3.3" xref="Thmdefinition1.p1.6.3.m3.8.8.8.5.3.3.cmml">θ</mi></msub></msub><mrow id="Thmdefinition1.p1.6.3.m3.8.8.8.4.2" xref="Thmdefinition1.p1.6.3.m3.8.8.8.4.3.cmml"><mo id="Thmdefinition1.p1.6.3.m3.8.8.8.4.2.3" stretchy="false" xref="Thmdefinition1.p1.6.3.m3.8.8.8.4.3.cmml">(</mo><msub id="Thmdefinition1.p1.6.3.m3.7.7.7.3.1.1" xref="Thmdefinition1.p1.6.3.m3.7.7.7.3.1.1.cmml"><mi id="Thmdefinition1.p1.6.3.m3.7.7.7.3.1.1.2" xref="Thmdefinition1.p1.6.3.m3.7.7.7.3.1.1.2.cmml">x</mi><mn id="Thmdefinition1.p1.6.3.m3.7.7.7.3.1.1.3" xref="Thmdefinition1.p1.6.3.m3.7.7.7.3.1.1.3.cmml">2</mn></msub><mo id="Thmdefinition1.p1.6.3.m3.8.8.8.4.2.4" xref="Thmdefinition1.p1.6.3.m3.8.8.8.4.3.cmml">,</mo><msub id="Thmdefinition1.p1.6.3.m3.8.8.8.4.2.2" xref="Thmdefinition1.p1.6.3.m3.8.8.8.4.2.2.cmml"><mi id="Thmdefinition1.p1.6.3.m3.8.8.8.4.2.2.2" xref="Thmdefinition1.p1.6.3.m3.8.8.8.4.2.2.2.cmml">y</mi><mn id="Thmdefinition1.p1.6.3.m3.8.8.8.4.2.2.3" xref="Thmdefinition1.p1.6.3.m3.8.8.8.4.2.2.3.cmml">2</mn></msub><mo id="Thmdefinition1.p1.6.3.m3.8.8.8.4.2.5" stretchy="false" xref="Thmdefinition1.p1.6.3.m3.8.8.8.4.3.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="Thmdefinition1.p1.6.3.m3.8b"><apply id="Thmdefinition1.p1.6.3.m3.8.8.cmml" xref="Thmdefinition1.p1.6.3.m3.8.8"><ci id="Thmdefinition1.p1.6.3.m3.8.8.9.cmml" xref="Thmdefinition1.p1.6.3.m3.8.8.9">⇔</ci><apply id="Thmdefinition1.p1.6.3.m3.4.4.4.cmml" xref="Thmdefinition1.p1.6.3.m3.4.4.4"><gt id="Thmdefinition1.p1.6.3.m3.4.4.4.5.cmml" xref="Thmdefinition1.p1.6.3.m3.4.4.4.5"></gt><apply id="Thmdefinition1.p1.6.3.m3.2.2.2.2.cmml" xref="Thmdefinition1.p1.6.3.m3.2.2.2.2"><times id="Thmdefinition1.p1.6.3.m3.2.2.2.2.3.cmml" xref="Thmdefinition1.p1.6.3.m3.2.2.2.2.3"></times><apply id="Thmdefinition1.p1.6.3.m3.2.2.2.2.4.cmml" xref="Thmdefinition1.p1.6.3.m3.2.2.2.2.4"><csymbol cd="ambiguous" id="Thmdefinition1.p1.6.3.m3.2.2.2.2.4.1.cmml" xref="Thmdefinition1.p1.6.3.m3.2.2.2.2.4">subscript</csymbol><ci id="Thmdefinition1.p1.6.3.m3.2.2.2.2.4.2.cmml" xref="Thmdefinition1.p1.6.3.m3.2.2.2.2.4.2">𝑟</ci><ci id="Thmdefinition1.p1.6.3.m3.2.2.2.2.4.3.cmml" xref="Thmdefinition1.p1.6.3.m3.2.2.2.2.4.3">𝜃</ci></apply><interval closure="open" id="Thmdefinition1.p1.6.3.m3.2.2.2.2.2.3.cmml" xref="Thmdefinition1.p1.6.3.m3.2.2.2.2.2.2"><apply id="Thmdefinition1.p1.6.3.m3.1.1.1.1.1.1.1.cmml" xref="Thmdefinition1.p1.6.3.m3.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="Thmdefinition1.p1.6.3.m3.1.1.1.1.1.1.1.1.cmml" xref="Thmdefinition1.p1.6.3.m3.1.1.1.1.1.1.1">subscript</csymbol><ci id="Thmdefinition1.p1.6.3.m3.1.1.1.1.1.1.1.2.cmml" xref="Thmdefinition1.p1.6.3.m3.1.1.1.1.1.1.1.2">𝑥</ci><cn id="Thmdefinition1.p1.6.3.m3.1.1.1.1.1.1.1.3.cmml" type="integer" xref="Thmdefinition1.p1.6.3.m3.1.1.1.1.1.1.1.3">1</cn></apply><apply id="Thmdefinition1.p1.6.3.m3.2.2.2.2.2.2.2.cmml" xref="Thmdefinition1.p1.6.3.m3.2.2.2.2.2.2.2"><csymbol cd="ambiguous" id="Thmdefinition1.p1.6.3.m3.2.2.2.2.2.2.2.1.cmml" xref="Thmdefinition1.p1.6.3.m3.2.2.2.2.2.2.2">subscript</csymbol><ci id="Thmdefinition1.p1.6.3.m3.2.2.2.2.2.2.2.2.cmml" xref="Thmdefinition1.p1.6.3.m3.2.2.2.2.2.2.2.2">𝑦</ci><cn id="Thmdefinition1.p1.6.3.m3.2.2.2.2.2.2.2.3.cmml" type="integer" xref="Thmdefinition1.p1.6.3.m3.2.2.2.2.2.2.2.3">1</cn></apply></interval></apply><apply id="Thmdefinition1.p1.6.3.m3.4.4.4.4.cmml" xref="Thmdefinition1.p1.6.3.m3.4.4.4.4"><times id="Thmdefinition1.p1.6.3.m3.4.4.4.4.3.cmml" xref="Thmdefinition1.p1.6.3.m3.4.4.4.4.3"></times><apply id="Thmdefinition1.p1.6.3.m3.4.4.4.4.4.cmml" xref="Thmdefinition1.p1.6.3.m3.4.4.4.4.4"><csymbol cd="ambiguous" id="Thmdefinition1.p1.6.3.m3.4.4.4.4.4.1.cmml" xref="Thmdefinition1.p1.6.3.m3.4.4.4.4.4">subscript</csymbol><ci id="Thmdefinition1.p1.6.3.m3.4.4.4.4.4.2.cmml" xref="Thmdefinition1.p1.6.3.m3.4.4.4.4.4.2">𝑟</ci><ci id="Thmdefinition1.p1.6.3.m3.4.4.4.4.4.3.cmml" xref="Thmdefinition1.p1.6.3.m3.4.4.4.4.4.3">𝜃</ci></apply><interval closure="open" id="Thmdefinition1.p1.6.3.m3.4.4.4.4.2.3.cmml" xref="Thmdefinition1.p1.6.3.m3.4.4.4.4.2.2"><apply id="Thmdefinition1.p1.6.3.m3.3.3.3.3.1.1.1.cmml" xref="Thmdefinition1.p1.6.3.m3.3.3.3.3.1.1.1"><csymbol cd="ambiguous" id="Thmdefinition1.p1.6.3.m3.3.3.3.3.1.1.1.1.cmml" xref="Thmdefinition1.p1.6.3.m3.3.3.3.3.1.1.1">subscript</csymbol><ci id="Thmdefinition1.p1.6.3.m3.3.3.3.3.1.1.1.2.cmml" xref="Thmdefinition1.p1.6.3.m3.3.3.3.3.1.1.1.2">𝑥</ci><cn id="Thmdefinition1.p1.6.3.m3.3.3.3.3.1.1.1.3.cmml" type="integer" xref="Thmdefinition1.p1.6.3.m3.3.3.3.3.1.1.1.3">2</cn></apply><apply id="Thmdefinition1.p1.6.3.m3.4.4.4.4.2.2.2.cmml" xref="Thmdefinition1.p1.6.3.m3.4.4.4.4.2.2.2"><csymbol cd="ambiguous" id="Thmdefinition1.p1.6.3.m3.4.4.4.4.2.2.2.1.cmml" xref="Thmdefinition1.p1.6.3.m3.4.4.4.4.2.2.2">subscript</csymbol><ci id="Thmdefinition1.p1.6.3.m3.4.4.4.4.2.2.2.2.cmml" xref="Thmdefinition1.p1.6.3.m3.4.4.4.4.2.2.2.2">𝑦</ci><cn id="Thmdefinition1.p1.6.3.m3.4.4.4.4.2.2.2.3.cmml" type="integer" xref="Thmdefinition1.p1.6.3.m3.4.4.4.4.2.2.2.3">2</cn></apply></interval></apply></apply><apply id="Thmdefinition1.p1.6.3.m3.8.8.8.cmml" xref="Thmdefinition1.p1.6.3.m3.8.8.8"><apply id="Thmdefinition1.p1.6.3.m3.8.8.8.5.cmml" xref="Thmdefinition1.p1.6.3.m3.8.8.8.5"><csymbol cd="ambiguous" id="Thmdefinition1.p1.6.3.m3.8.8.8.5.1.cmml" xref="Thmdefinition1.p1.6.3.m3.8.8.8.5">subscript</csymbol><csymbol cd="latexml" id="Thmdefinition1.p1.6.3.m3.8.8.8.5.2.cmml" xref="Thmdefinition1.p1.6.3.m3.8.8.8.5.2">succeeds</csymbol><apply id="Thmdefinition1.p1.6.3.m3.8.8.8.5.3.cmml" xref="Thmdefinition1.p1.6.3.m3.8.8.8.5.3"><csymbol cd="ambiguous" id="Thmdefinition1.p1.6.3.m3.8.8.8.5.3.1.cmml" xref="Thmdefinition1.p1.6.3.m3.8.8.8.5.3">subscript</csymbol><ci id="Thmdefinition1.p1.6.3.m3.8.8.8.5.3.2.cmml" xref="Thmdefinition1.p1.6.3.m3.8.8.8.5.3.2">𝑟</ci><ci id="Thmdefinition1.p1.6.3.m3.8.8.8.5.3.3.cmml" xref="Thmdefinition1.p1.6.3.m3.8.8.8.5.3.3">𝜃</ci></apply></apply><interval closure="open" id="Thmdefinition1.p1.6.3.m3.6.6.6.2.3.cmml" xref="Thmdefinition1.p1.6.3.m3.6.6.6.2.2"><apply id="Thmdefinition1.p1.6.3.m3.5.5.5.1.1.1.cmml" xref="Thmdefinition1.p1.6.3.m3.5.5.5.1.1.1"><csymbol cd="ambiguous" id="Thmdefinition1.p1.6.3.m3.5.5.5.1.1.1.1.cmml" xref="Thmdefinition1.p1.6.3.m3.5.5.5.1.1.1">subscript</csymbol><ci id="Thmdefinition1.p1.6.3.m3.5.5.5.1.1.1.2.cmml" xref="Thmdefinition1.p1.6.3.m3.5.5.5.1.1.1.2">𝑥</ci><cn id="Thmdefinition1.p1.6.3.m3.5.5.5.1.1.1.3.cmml" type="integer" xref="Thmdefinition1.p1.6.3.m3.5.5.5.1.1.1.3">1</cn></apply><apply id="Thmdefinition1.p1.6.3.m3.6.6.6.2.2.2.cmml" xref="Thmdefinition1.p1.6.3.m3.6.6.6.2.2.2"><csymbol cd="ambiguous" id="Thmdefinition1.p1.6.3.m3.6.6.6.2.2.2.1.cmml" xref="Thmdefinition1.p1.6.3.m3.6.6.6.2.2.2">subscript</csymbol><ci id="Thmdefinition1.p1.6.3.m3.6.6.6.2.2.2.2.cmml" xref="Thmdefinition1.p1.6.3.m3.6.6.6.2.2.2.2">𝑦</ci><cn id="Thmdefinition1.p1.6.3.m3.6.6.6.2.2.2.3.cmml" type="integer" xref="Thmdefinition1.p1.6.3.m3.6.6.6.2.2.2.3">1</cn></apply></interval><interval closure="open" id="Thmdefinition1.p1.6.3.m3.8.8.8.4.3.cmml" xref="Thmdefinition1.p1.6.3.m3.8.8.8.4.2"><apply id="Thmdefinition1.p1.6.3.m3.7.7.7.3.1.1.cmml" xref="Thmdefinition1.p1.6.3.m3.7.7.7.3.1.1"><csymbol cd="ambiguous" id="Thmdefinition1.p1.6.3.m3.7.7.7.3.1.1.1.cmml" xref="Thmdefinition1.p1.6.3.m3.7.7.7.3.1.1">subscript</csymbol><ci id="Thmdefinition1.p1.6.3.m3.7.7.7.3.1.1.2.cmml" xref="Thmdefinition1.p1.6.3.m3.7.7.7.3.1.1.2">𝑥</ci><cn id="Thmdefinition1.p1.6.3.m3.7.7.7.3.1.1.3.cmml" type="integer" xref="Thmdefinition1.p1.6.3.m3.7.7.7.3.1.1.3">2</cn></apply><apply id="Thmdefinition1.p1.6.3.m3.8.8.8.4.2.2.cmml" xref="Thmdefinition1.p1.6.3.m3.8.8.8.4.2.2"><csymbol cd="ambiguous" id="Thmdefinition1.p1.6.3.m3.8.8.8.4.2.2.1.cmml" xref="Thmdefinition1.p1.6.3.m3.8.8.8.4.2.2">subscript</csymbol><ci id="Thmdefinition1.p1.6.3.m3.8.8.8.4.2.2.2.cmml" xref="Thmdefinition1.p1.6.3.m3.8.8.8.4.2.2.2">𝑦</ci><cn id="Thmdefinition1.p1.6.3.m3.8.8.8.4.2.2.3.cmml" type="integer" xref="Thmdefinition1.p1.6.3.m3.8.8.8.4.2.2.3">2</cn></apply></interval></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="Thmdefinition1.p1.6.3.m3.8c">r_{\theta}(x_{1},y_{1})&gt;r_{\theta}(x_{2},y_{2})\Leftrightarrow(x_{1},y_{1})%
\succ_{r_{\theta}}(x_{2},y_{2})</annotation><annotation encoding="application/x-llamapun" id="Thmdefinition1.p1.6.3.m3.8d">italic_r start_POSTSUBSCRIPT italic_θ end_POSTSUBSCRIPT ( italic_x start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT , italic_y start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT ) &gt; italic_r start_POSTSUBSCRIPT italic_θ end_POSTSUBSCRIPT ( italic_x start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT , italic_y start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT ) ⇔ ( italic_x start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT , italic_y start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT ) ≻ start_POSTSUBSCRIPT italic_r start_POSTSUBSCRIPT italic_θ end_POSTSUBSCRIPT end_POSTSUBSCRIPT ( italic_x start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT , italic_y start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT )</annotation></semantics></math>, reference point distributions <math alttext="Q_{x}(X^{\prime})" class="ltx_Math" display="inline" id="Thmdefinition1.p1.7.4.m4.1"><semantics id="Thmdefinition1.p1.7.4.m4.1a"><mrow id="Thmdefinition1.p1.7.4.m4.1.1" xref="Thmdefinition1.p1.7.4.m4.1.1.cmml"><msub id="Thmdefinition1.p1.7.4.m4.1.1.3" xref="Thmdefinition1.p1.7.4.m4.1.1.3.cmml"><mi id="Thmdefinition1.p1.7.4.m4.1.1.3.2" xref="Thmdefinition1.p1.7.4.m4.1.1.3.2.cmml">Q</mi><mi id="Thmdefinition1.p1.7.4.m4.1.1.3.3" xref="Thmdefinition1.p1.7.4.m4.1.1.3.3.cmml">x</mi></msub><mo id="Thmdefinition1.p1.7.4.m4.1.1.2" xref="Thmdefinition1.p1.7.4.m4.1.1.2.cmml">⁢</mo><mrow id="Thmdefinition1.p1.7.4.m4.1.1.1.1" xref="Thmdefinition1.p1.7.4.m4.1.1.1.1.1.cmml"><mo id="Thmdefinition1.p1.7.4.m4.1.1.1.1.2" stretchy="false" xref="Thmdefinition1.p1.7.4.m4.1.1.1.1.1.cmml">(</mo><msup id="Thmdefinition1.p1.7.4.m4.1.1.1.1.1" xref="Thmdefinition1.p1.7.4.m4.1.1.1.1.1.cmml"><mi id="Thmdefinition1.p1.7.4.m4.1.1.1.1.1.2" xref="Thmdefinition1.p1.7.4.m4.1.1.1.1.1.2.cmml">X</mi><mo id="Thmdefinition1.p1.7.4.m4.1.1.1.1.1.3" xref="Thmdefinition1.p1.7.4.m4.1.1.1.1.1.3.cmml">′</mo></msup><mo id="Thmdefinition1.p1.7.4.m4.1.1.1.1.3" stretchy="false" xref="Thmdefinition1.p1.7.4.m4.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="Thmdefinition1.p1.7.4.m4.1b"><apply id="Thmdefinition1.p1.7.4.m4.1.1.cmml" xref="Thmdefinition1.p1.7.4.m4.1.1"><times id="Thmdefinition1.p1.7.4.m4.1.1.2.cmml" xref="Thmdefinition1.p1.7.4.m4.1.1.2"></times><apply id="Thmdefinition1.p1.7.4.m4.1.1.3.cmml" xref="Thmdefinition1.p1.7.4.m4.1.1.3"><csymbol cd="ambiguous" id="Thmdefinition1.p1.7.4.m4.1.1.3.1.cmml" xref="Thmdefinition1.p1.7.4.m4.1.1.3">subscript</csymbol><ci id="Thmdefinition1.p1.7.4.m4.1.1.3.2.cmml" xref="Thmdefinition1.p1.7.4.m4.1.1.3.2">𝑄</ci><ci id="Thmdefinition1.p1.7.4.m4.1.1.3.3.cmml" xref="Thmdefinition1.p1.7.4.m4.1.1.3.3">𝑥</ci></apply><apply id="Thmdefinition1.p1.7.4.m4.1.1.1.1.1.cmml" xref="Thmdefinition1.p1.7.4.m4.1.1.1.1"><csymbol cd="ambiguous" id="Thmdefinition1.p1.7.4.m4.1.1.1.1.1.1.cmml" xref="Thmdefinition1.p1.7.4.m4.1.1.1.1">superscript</csymbol><ci id="Thmdefinition1.p1.7.4.m4.1.1.1.1.1.2.cmml" xref="Thmdefinition1.p1.7.4.m4.1.1.1.1.1.2">𝑋</ci><ci id="Thmdefinition1.p1.7.4.m4.1.1.1.1.1.3.cmml" xref="Thmdefinition1.p1.7.4.m4.1.1.1.1.1.3">′</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="Thmdefinition1.p1.7.4.m4.1c">Q_{x}(X^{\prime})</annotation><annotation encoding="application/x-llamapun" id="Thmdefinition1.p1.7.4.m4.1d">italic_Q start_POSTSUBSCRIPT italic_x end_POSTSUBSCRIPT ( italic_X start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT )</annotation></semantics></math> and <math alttext="Q_{y}(Y^{\prime}|X^{\prime})" class="ltx_Math" display="inline" id="Thmdefinition1.p1.8.5.m5.1"><semantics id="Thmdefinition1.p1.8.5.m5.1a"><mrow id="Thmdefinition1.p1.8.5.m5.1.1" xref="Thmdefinition1.p1.8.5.m5.1.1.cmml"><msub id="Thmdefinition1.p1.8.5.m5.1.1.3" xref="Thmdefinition1.p1.8.5.m5.1.1.3.cmml"><mi id="Thmdefinition1.p1.8.5.m5.1.1.3.2" xref="Thmdefinition1.p1.8.5.m5.1.1.3.2.cmml">Q</mi><mi id="Thmdefinition1.p1.8.5.m5.1.1.3.3" xref="Thmdefinition1.p1.8.5.m5.1.1.3.3.cmml">y</mi></msub><mo id="Thmdefinition1.p1.8.5.m5.1.1.2" xref="Thmdefinition1.p1.8.5.m5.1.1.2.cmml">⁢</mo><mrow id="Thmdefinition1.p1.8.5.m5.1.1.1.1" xref="Thmdefinition1.p1.8.5.m5.1.1.1.1.1.cmml"><mo id="Thmdefinition1.p1.8.5.m5.1.1.1.1.2" stretchy="false" xref="Thmdefinition1.p1.8.5.m5.1.1.1.1.1.cmml">(</mo><mrow id="Thmdefinition1.p1.8.5.m5.1.1.1.1.1" xref="Thmdefinition1.p1.8.5.m5.1.1.1.1.1.cmml"><msup id="Thmdefinition1.p1.8.5.m5.1.1.1.1.1.2" xref="Thmdefinition1.p1.8.5.m5.1.1.1.1.1.2.cmml"><mi id="Thmdefinition1.p1.8.5.m5.1.1.1.1.1.2.2" xref="Thmdefinition1.p1.8.5.m5.1.1.1.1.1.2.2.cmml">Y</mi><mo id="Thmdefinition1.p1.8.5.m5.1.1.1.1.1.2.3" xref="Thmdefinition1.p1.8.5.m5.1.1.1.1.1.2.3.cmml">′</mo></msup><mo fence="false" id="Thmdefinition1.p1.8.5.m5.1.1.1.1.1.1" xref="Thmdefinition1.p1.8.5.m5.1.1.1.1.1.1.cmml">|</mo><msup id="Thmdefinition1.p1.8.5.m5.1.1.1.1.1.3" xref="Thmdefinition1.p1.8.5.m5.1.1.1.1.1.3.cmml"><mi id="Thmdefinition1.p1.8.5.m5.1.1.1.1.1.3.2" xref="Thmdefinition1.p1.8.5.m5.1.1.1.1.1.3.2.cmml">X</mi><mo id="Thmdefinition1.p1.8.5.m5.1.1.1.1.1.3.3" xref="Thmdefinition1.p1.8.5.m5.1.1.1.1.1.3.3.cmml">′</mo></msup></mrow><mo id="Thmdefinition1.p1.8.5.m5.1.1.1.1.3" stretchy="false" xref="Thmdefinition1.p1.8.5.m5.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="Thmdefinition1.p1.8.5.m5.1b"><apply id="Thmdefinition1.p1.8.5.m5.1.1.cmml" xref="Thmdefinition1.p1.8.5.m5.1.1"><times id="Thmdefinition1.p1.8.5.m5.1.1.2.cmml" xref="Thmdefinition1.p1.8.5.m5.1.1.2"></times><apply id="Thmdefinition1.p1.8.5.m5.1.1.3.cmml" xref="Thmdefinition1.p1.8.5.m5.1.1.3"><csymbol cd="ambiguous" id="Thmdefinition1.p1.8.5.m5.1.1.3.1.cmml" xref="Thmdefinition1.p1.8.5.m5.1.1.3">subscript</csymbol><ci id="Thmdefinition1.p1.8.5.m5.1.1.3.2.cmml" xref="Thmdefinition1.p1.8.5.m5.1.1.3.2">𝑄</ci><ci id="Thmdefinition1.p1.8.5.m5.1.1.3.3.cmml" xref="Thmdefinition1.p1.8.5.m5.1.1.3.3">𝑦</ci></apply><apply id="Thmdefinition1.p1.8.5.m5.1.1.1.1.1.cmml" xref="Thmdefinition1.p1.8.5.m5.1.1.1.1"><csymbol cd="latexml" id="Thmdefinition1.p1.8.5.m5.1.1.1.1.1.1.cmml" xref="Thmdefinition1.p1.8.5.m5.1.1.1.1.1.1">conditional</csymbol><apply id="Thmdefinition1.p1.8.5.m5.1.1.1.1.1.2.cmml" xref="Thmdefinition1.p1.8.5.m5.1.1.1.1.1.2"><csymbol cd="ambiguous" id="Thmdefinition1.p1.8.5.m5.1.1.1.1.1.2.1.cmml" xref="Thmdefinition1.p1.8.5.m5.1.1.1.1.1.2">superscript</csymbol><ci id="Thmdefinition1.p1.8.5.m5.1.1.1.1.1.2.2.cmml" xref="Thmdefinition1.p1.8.5.m5.1.1.1.1.1.2.2">𝑌</ci><ci id="Thmdefinition1.p1.8.5.m5.1.1.1.1.1.2.3.cmml" xref="Thmdefinition1.p1.8.5.m5.1.1.1.1.1.2.3">′</ci></apply><apply id="Thmdefinition1.p1.8.5.m5.1.1.1.1.1.3.cmml" xref="Thmdefinition1.p1.8.5.m5.1.1.1.1.1.3"><csymbol cd="ambiguous" id="Thmdefinition1.p1.8.5.m5.1.1.1.1.1.3.1.cmml" xref="Thmdefinition1.p1.8.5.m5.1.1.1.1.1.3">superscript</csymbol><ci id="Thmdefinition1.p1.8.5.m5.1.1.1.1.1.3.2.cmml" xref="Thmdefinition1.p1.8.5.m5.1.1.1.1.1.3.2">𝑋</ci><ci id="Thmdefinition1.p1.8.5.m5.1.1.1.1.1.3.3.cmml" xref="Thmdefinition1.p1.8.5.m5.1.1.1.1.1.3.3">′</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="Thmdefinition1.p1.8.5.m5.1c">Q_{y}(Y^{\prime}|X^{\prime})</annotation><annotation encoding="application/x-llamapun" id="Thmdefinition1.p1.8.5.m5.1d">italic_Q start_POSTSUBSCRIPT italic_y end_POSTSUBSCRIPT ( italic_Y start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT | italic_X start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT )</annotation></semantics></math>, a value function <math alttext="v_{f}:\mathbb{R}\rightarrow\mathbb{R}" class="ltx_Math" display="inline" id="Thmdefinition1.p1.9.6.m6.1"><semantics id="Thmdefinition1.p1.9.6.m6.1a"><mrow id="Thmdefinition1.p1.9.6.m6.1.1" xref="Thmdefinition1.p1.9.6.m6.1.1.cmml"><msub id="Thmdefinition1.p1.9.6.m6.1.1.2" xref="Thmdefinition1.p1.9.6.m6.1.1.2.cmml"><mi id="Thmdefinition1.p1.9.6.m6.1.1.2.2" xref="Thmdefinition1.p1.9.6.m6.1.1.2.2.cmml">v</mi><mi id="Thmdefinition1.p1.9.6.m6.1.1.2.3" xref="Thmdefinition1.p1.9.6.m6.1.1.2.3.cmml">f</mi></msub><mo id="Thmdefinition1.p1.9.6.m6.1.1.1" lspace="0.278em" rspace="0.278em" xref="Thmdefinition1.p1.9.6.m6.1.1.1.cmml">:</mo><mrow id="Thmdefinition1.p1.9.6.m6.1.1.3" xref="Thmdefinition1.p1.9.6.m6.1.1.3.cmml"><mi id="Thmdefinition1.p1.9.6.m6.1.1.3.2" mathvariant="normal" xref="Thmdefinition1.p1.9.6.m6.1.1.3.2.cmml">ℝ</mi><mo id="Thmdefinition1.p1.9.6.m6.1.1.3.1" stretchy="false" xref="Thmdefinition1.p1.9.6.m6.1.1.3.1.cmml">→</mo><mi id="Thmdefinition1.p1.9.6.m6.1.1.3.3" mathvariant="normal" xref="Thmdefinition1.p1.9.6.m6.1.1.3.3.cmml">ℝ</mi></mrow></mrow><annotation-xml encoding="MathML-Content" id="Thmdefinition1.p1.9.6.m6.1b"><apply id="Thmdefinition1.p1.9.6.m6.1.1.cmml" xref="Thmdefinition1.p1.9.6.m6.1.1"><ci id="Thmdefinition1.p1.9.6.m6.1.1.1.cmml" xref="Thmdefinition1.p1.9.6.m6.1.1.1">:</ci><apply id="Thmdefinition1.p1.9.6.m6.1.1.2.cmml" xref="Thmdefinition1.p1.9.6.m6.1.1.2"><csymbol cd="ambiguous" id="Thmdefinition1.p1.9.6.m6.1.1.2.1.cmml" xref="Thmdefinition1.p1.9.6.m6.1.1.2">subscript</csymbol><ci id="Thmdefinition1.p1.9.6.m6.1.1.2.2.cmml" xref="Thmdefinition1.p1.9.6.m6.1.1.2.2">𝑣</ci><ci id="Thmdefinition1.p1.9.6.m6.1.1.2.3.cmml" xref="Thmdefinition1.p1.9.6.m6.1.1.2.3">𝑓</ci></apply><apply id="Thmdefinition1.p1.9.6.m6.1.1.3.cmml" xref="Thmdefinition1.p1.9.6.m6.1.1.3"><ci id="Thmdefinition1.p1.9.6.m6.1.1.3.1.cmml" xref="Thmdefinition1.p1.9.6.m6.1.1.3.1">→</ci><ci id="Thmdefinition1.p1.9.6.m6.1.1.3.2.cmml" xref="Thmdefinition1.p1.9.6.m6.1.1.3.2">ℝ</ci><ci id="Thmdefinition1.p1.9.6.m6.1.1.3.3.cmml" xref="Thmdefinition1.p1.9.6.m6.1.1.3.3">ℝ</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="Thmdefinition1.p1.9.6.m6.1c">v_{f}:\mathbb{R}\rightarrow\mathbb{R}</annotation><annotation encoding="application/x-llamapun" id="Thmdefinition1.p1.9.6.m6.1d">italic_v start_POSTSUBSCRIPT italic_f end_POSTSUBSCRIPT : roman_ℝ → roman_ℝ</annotation></semantics></math> that is monotonic non-decreasing and concave in <math alttext="(0,\infty)" class="ltx_Math" display="inline" id="Thmdefinition1.p1.10.7.m7.2"><semantics id="Thmdefinition1.p1.10.7.m7.2a"><mrow id="Thmdefinition1.p1.10.7.m7.2.3.2" xref="Thmdefinition1.p1.10.7.m7.2.3.1.cmml"><mo id="Thmdefinition1.p1.10.7.m7.2.3.2.1" stretchy="false" xref="Thmdefinition1.p1.10.7.m7.2.3.1.cmml">(</mo><mn id="Thmdefinition1.p1.10.7.m7.1.1" xref="Thmdefinition1.p1.10.7.m7.1.1.cmml">0</mn><mo id="Thmdefinition1.p1.10.7.m7.2.3.2.2" xref="Thmdefinition1.p1.10.7.m7.2.3.1.cmml">,</mo><mi id="Thmdefinition1.p1.10.7.m7.2.2" mathvariant="normal" xref="Thmdefinition1.p1.10.7.m7.2.2.cmml">∞</mi><mo id="Thmdefinition1.p1.10.7.m7.2.3.2.3" stretchy="false" xref="Thmdefinition1.p1.10.7.m7.2.3.1.cmml">)</mo></mrow><annotation-xml encoding="MathML-Content" id="Thmdefinition1.p1.10.7.m7.2b"><interval closure="open" id="Thmdefinition1.p1.10.7.m7.2.3.1.cmml" xref="Thmdefinition1.p1.10.7.m7.2.3.2"><cn id="Thmdefinition1.p1.10.7.m7.1.1.cmml" type="integer" xref="Thmdefinition1.p1.10.7.m7.1.1">0</cn><infinity id="Thmdefinition1.p1.10.7.m7.2.2.cmml" xref="Thmdefinition1.p1.10.7.m7.2.2"></infinity></interval></annotation-xml><annotation encoding="application/x-tex" id="Thmdefinition1.p1.10.7.m7.2c">(0,\infty)</annotation><annotation encoding="application/x-llamapun" id="Thmdefinition1.p1.10.7.m7.2d">( 0 , ∞ )</annotation></semantics></math>, and a negative affine function <math alttext="t" class="ltx_Math" display="inline" id="Thmdefinition1.p1.11.8.m8.1"><semantics id="Thmdefinition1.p1.11.8.m8.1a"><mi id="Thmdefinition1.p1.11.8.m8.1.1" xref="Thmdefinition1.p1.11.8.m8.1.1.cmml">t</mi><annotation-xml encoding="MathML-Content" id="Thmdefinition1.p1.11.8.m8.1b"><ci id="Thmdefinition1.p1.11.8.m8.1.1.cmml" xref="Thmdefinition1.p1.11.8.m8.1.1">𝑡</ci></annotation-xml><annotation encoding="application/x-tex" id="Thmdefinition1.p1.11.8.m8.1c">t</annotation><annotation encoding="application/x-llamapun" id="Thmdefinition1.p1.11.8.m8.1d">italic_t</annotation></semantics></math>.</span></p>
</div>
</div>
</section>
<section class="ltx_appendix" id="A3">
<h2 class="ltx_title ltx_title_appendix">
<span class="ltx_tag ltx_tag_appendix">Appendix C </span>Language-molecule Translation Instructions</h2>
<figure class="ltx_figure" id="A3.2"><svg class="ltx_picture" height="222.66" id="A3.1.pic1" overflow="visible" version="1.1" width="600"><g fill="#000000" stroke="#000000" stroke-width="0.4pt" transform="translate(0,222.66) matrix(1 0 0 -1 0 0)"><g fill="#000000" fill-opacity="1.0"><path d="M 0 5.91 L 0 216.76 C 0 220.02 2.64 222.66 5.91 222.66 L 594.09 222.66 C 597.36 222.66 600 220.02 600 216.76 L 600 5.91 C 600 2.64 597.36 0 594.09 0 L 5.91 0 C 2.64 0 0 2.64 0 5.91 Z" style="stroke:none"></path></g><g fill="#FAFAFA" fill-opacity="1.0"><path d="M 1.97 5.91 L 1.97 216.76 C 1.97 218.93 3.73 220.69 5.91 220.69 L 594.09 220.69 C 596.27 220.69 598.03 218.93 598.03 216.76 L 598.03 5.91 C 598.03 3.73 596.27 1.97 594.09 1.97 L 5.91 1.97 C 3.73 1.97 1.97 3.73 1.97 5.91 Z" style="stroke:none"></path></g><g fill-opacity="1.0" transform="matrix(1.0 0.0 0.0 1.0 21.65 13.78)"><foreignobject color="#000000" height="195.1" overflow="visible" transform="matrix(1 0 0 -1 0 16.6)" width="556.69">
<span class="ltx_inline-block ltx_minipage ltx_align_bottom" id="A3.1.pic1.1.1.1.1.1" style="width:402.3pt;">
<span class="ltx_p" id="A3.1.pic1.1.1.1.1.1.1"><span class="ltx_text" id="A3.1.pic1.1.1.1.1.1.1.1" style="font-size:90%;">Below is an instruction that describes a task, paired with an input that provides further context.
<br class="ltx_break"/>Write a response that appropriately completes the request. 
<br class="ltx_break"/>
<br class="ltx_break"/>### Instruction: You are a researcher. You can come up captions based on your existing knowledge. 
<br class="ltx_break"/>Captions are given against the following input. You should be as detailed as possible. 
<br class="ltx_break"/>
<br class="ltx_break"/>### Input: Molecule: {source molecule} 
<br class="ltx_break"/>In that molecule, could you formulate a caption about? 
<br class="ltx_break"/>
<br class="ltx_break"/>
<br class="ltx_break"/>### Response:{target caption}</span></span>
</span></foreignobject></g></g></svg>
<figcaption class="ltx_caption ltx_centering">Instruction for molecule to language translation, i.e., <math alttext="M\rightarrow L" class="ltx_Math" display="inline" id="A3.2.1.m1.1"><semantics id="A3.2.1.m1.1b"><mrow id="A3.2.1.m1.1.1" xref="A3.2.1.m1.1.1.cmml"><mi id="A3.2.1.m1.1.1.2" xref="A3.2.1.m1.1.1.2.cmml">M</mi><mo id="A3.2.1.m1.1.1.1" stretchy="false" xref="A3.2.1.m1.1.1.1.cmml">→</mo><mi id="A3.2.1.m1.1.1.3" xref="A3.2.1.m1.1.1.3.cmml">L</mi></mrow><annotation-xml encoding="MathML-Content" id="A3.2.1.m1.1c"><apply id="A3.2.1.m1.1.1.cmml" xref="A3.2.1.m1.1.1"><ci id="A3.2.1.m1.1.1.1.cmml" xref="A3.2.1.m1.1.1.1">→</ci><ci id="A3.2.1.m1.1.1.2.cmml" xref="A3.2.1.m1.1.1.2">𝑀</ci><ci id="A3.2.1.m1.1.1.3.cmml" xref="A3.2.1.m1.1.1.3">𝐿</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A3.2.1.m1.1d">M\rightarrow L</annotation><annotation encoding="application/x-llamapun" id="A3.2.1.m1.1e">italic_M → italic_L</annotation></semantics></math></figcaption>
</figure>
<figure class="ltx_figure" id="A3.4"><svg class="ltx_picture" height="222.66" id="A3.3.pic1" overflow="visible" version="1.1" width="600"><g fill="#000000" stroke="#000000" stroke-width="0.4pt" transform="translate(0,222.66) matrix(1 0 0 -1 0 0)"><g fill="#000000" fill-opacity="1.0"><path d="M 0 5.91 L 0 216.76 C 0 220.02 2.64 222.66 5.91 222.66 L 594.09 222.66 C 597.36 222.66 600 220.02 600 216.76 L 600 5.91 C 600 2.64 597.36 0 594.09 0 L 5.91 0 C 2.64 0 0 2.64 0 5.91 Z" style="stroke:none"></path></g><g fill="#FAFAFA" fill-opacity="1.0"><path d="M 1.97 5.91 L 1.97 216.76 C 1.97 218.93 3.73 220.69 5.91 220.69 L 594.09 220.69 C 596.27 220.69 598.03 218.93 598.03 216.76 L 598.03 5.91 C 598.03 3.73 596.27 1.97 594.09 1.97 L 5.91 1.97 C 3.73 1.97 1.97 3.73 1.97 5.91 Z" style="stroke:none"></path></g><g fill-opacity="1.0" transform="matrix(1.0 0.0 0.0 1.0 21.65 13.78)"><foreignobject color="#000000" height="195.1" overflow="visible" transform="matrix(1 0 0 -1 0 16.6)" width="556.69">
<span class="ltx_inline-block ltx_minipage ltx_align_bottom" id="A3.3.pic1.1.1.1.1.1" style="width:402.3pt;">
<span class="ltx_p" id="A3.3.pic1.1.1.1.1.1.1"><span class="ltx_text" id="A3.3.pic1.1.1.1.1.1.1.1" style="font-size:90%;">Below is an instruction that describes a task, paired with an input that provides further context.
<br class="ltx_break"/>Write a response that appropriately completes the request. 
<br class="ltx_break"/>
<br class="ltx_break"/>### Instruction: You are a researcher. You can come up molecule smile strings based on your existing knowledge. 
<br class="ltx_break"/>Molecule smile strings are given against the following input. You should be as detailed as possible.
<br class="ltx_break"/>
<br class="ltx_break"/>### Input: Caption: {source caption} 
<br class="ltx_break"/>In that caption, could you generate a molecule smile string? 
<br class="ltx_break"/>
<br class="ltx_break"/>
<br class="ltx_break"/>### Response: {target molecule}</span></span>
</span></foreignobject></g></g></svg>
<figcaption class="ltx_caption ltx_centering">Instruction for language to molecule translation, i.e., <math alttext="L\rightarrow M" class="ltx_Math" display="inline" id="A3.4.1.m1.1"><semantics id="A3.4.1.m1.1b"><mrow id="A3.4.1.m1.1.1" xref="A3.4.1.m1.1.1.cmml"><mi id="A3.4.1.m1.1.1.2" xref="A3.4.1.m1.1.1.2.cmml">L</mi><mo id="A3.4.1.m1.1.1.1" stretchy="false" xref="A3.4.1.m1.1.1.1.cmml">→</mo><mi id="A3.4.1.m1.1.1.3" xref="A3.4.1.m1.1.1.3.cmml">M</mi></mrow><annotation-xml encoding="MathML-Content" id="A3.4.1.m1.1c"><apply id="A3.4.1.m1.1.1.cmml" xref="A3.4.1.m1.1.1"><ci id="A3.4.1.m1.1.1.1.cmml" xref="A3.4.1.m1.1.1.1">→</ci><ci id="A3.4.1.m1.1.1.2.cmml" xref="A3.4.1.m1.1.1.2">𝐿</ci><ci id="A3.4.1.m1.1.1.3.cmml" xref="A3.4.1.m1.1.1.3">𝑀</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A3.4.1.m1.1d">L\rightarrow M</annotation><annotation encoding="application/x-llamapun" id="A3.4.1.m1.1e">italic_L → italic_M</annotation></semantics></math></figcaption>
</figure>
</section>
<section class="ltx_appendix" id="A4">
<h2 class="ltx_title ltx_title_appendix">
<span class="ltx_tag ltx_tag_appendix">Appendix D </span>Evaluation Metrics</h2>
<div class="ltx_para" id="A4.p1">
<p class="ltx_p" id="A4.p1.1">For performance evaluation, we employ established metrics from the literature <cite class="ltx_cite ltx_citemacro_cite">Sets [<a class="ltx_ref" href="https://arxiv.org/html/2405.13984v1#bib.bib29" title="">2022</a>], Edwards et al. [<a class="ltx_ref" href="https://arxiv.org/html/2405.13984v1#bib.bib8" title="">2022</a>]</cite>. In molecule-to-language translation, we assess using BLEU-2, BLEU-4, ROUGE-1, ROUGE-2, ROUGE-L, and METEOR metrics. For language-to-molecule translation, evaluation metrics include BLEU, Levenshtein distance, fingerprint metrics (MACCS, RDK, and Morgan), Fréchet ChemNet Distance (FCD), and molecule validity metrics. Annotations in the result tables indicate whether higher or lower values indicate superior performance.</p>
</div>
</section>
<section class="ltx_appendix" id="A5">
<h2 class="ltx_title ltx_title_appendix">
<span class="ltx_tag ltx_tag_appendix">Appendix E </span>Examples of Language-Molecule Translation</h2>
<figure class="ltx_figure" id="A5.F3"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_missing ltx_missing_image" id="A5.F3.g1" src=""/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 3: </span>Examples of molecules generated by our top-performing models compared to the benchmark model, Meditron.</figcaption>
</figure>
<figure class="ltx_figure" id="A5.F4"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_missing ltx_missing_image" id="A5.F4.g1" src=""/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 4: </span>Examples of generated language by our top-performing models compared to the benchmark model, Meditron.</figcaption>
</figure>
</section>
<section class="ltx_appendix" id="A6">
<h2 class="ltx_title ltx_title_appendix">
<span class="ltx_tag ltx_tag_appendix">Appendix F </span>Experimental Settings</h2>
<figure class="ltx_figure" id="A6.F5"><pre class="ltx_verbatim ltx_centering ltx_font_typewriter" id="A6.F5.1">
args = TrainingArguments(
    output_dir=save_path,
    overwrite_output_dir=True,
    load_best_model_at_end=True,
    num_train_epochs=3,
    per_device_train_batch_size=1
    per_device_eval_batch_size=1
    gradient_accumulation_steps=64
    gradient_checkpointing=False
    optim="adamw_torch_fused",
    learning_rate=5e-5,
    max_grad_norm=0.3,
    warmup_ratio=0.1,
    lr_scheduler_type="cosine",

)

(
    load_in_4bit=True,
    bnb_4bit_use_double_quant=True,
    bnb_4bit_quant_type=nf64,
      bnb_4bit_compute_dtype=torch.bfloat16
)

(
    lora_alpha=16,
    r = 64,
    lora_dropout=0.1,
    task_type="CAUSAL_LM",
    bias=False,
    target_modules= "all-linear"
)
</pre>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 5: </span>Training configuration</figcaption>
</figure>
<div class="ltx_pagination ltx_role_newpage"></div>
</section>
<section class="ltx_appendix" id="A7">
<h2 class="ltx_title ltx_title_appendix">
<span class="ltx_tag ltx_tag_appendix">Appendix G </span>Training Efficiency</h2>
<figure class="ltx_figure" id="A7.1"><img alt="Refer to caption" class="ltx_graphics ltx_missing ltx_missing_image" id="A7.1.g1" src=""/>
<figcaption class="ltx_caption ltx_centering">Training efficiency across experimental methods </figcaption>
</figure>
<div class="ltx_pagination ltx_role_newpage"></div>
</section>
</article>
</div>
<footer class="ltx_page_footer">
<div class="ltx_page_logo">Generated  on Fri May 24 15:02:19 2024 by <a class="ltx_LaTeXML_logo" href="http://dlmf.nist.gov/LaTeXML/"><span style="letter-spacing:-0.2em; margin-right:0.1em;">L<span class="ltx_font_smallcaps" style="position:relative; bottom:2.2pt;">a</span>T<span class="ltx_font_smallcaps" style="font-size:120%;position:relative; bottom:-0.2ex;">e</span></span><span style="font-size:90%; position:relative; bottom:-0.2ex;">XML</span><img alt="Mascot Sammy" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAsAAAAOCAYAAAD5YeaVAAAAAXNSR0IArs4c6QAAAAZiS0dEAP8A/wD/oL2nkwAAAAlwSFlzAAALEwAACxMBAJqcGAAAAAd0SU1FB9wKExQZLWTEaOUAAAAddEVYdENvbW1lbnQAQ3JlYXRlZCB3aXRoIFRoZSBHSU1Q72QlbgAAAdpJREFUKM9tkL+L2nAARz9fPZNCKFapUn8kyI0e4iRHSR1Kb8ng0lJw6FYHFwv2LwhOpcWxTjeUunYqOmqd6hEoRDhtDWdA8ApRYsSUCDHNt5ul13vz4w0vWCgUnnEc975arX6ORqN3VqtVZbfbTQC4uEHANM3jSqXymFI6yWazP2KxWAXAL9zCUa1Wy2tXVxheKA9YNoR8Pt+aTqe4FVVVvz05O6MBhqUIBGk8Hn8HAOVy+T+XLJfLS4ZhTiRJgqIoVBRFIoric47jPnmeB1mW/9rr9ZpSSn3Lsmir1fJZlqWlUonKsvwWwD8ymc/nXwVBeLjf7xEKhdBut9Hr9WgmkyGEkJwsy5eHG5vN5g0AKIoCAEgkEkin0wQAfN9/cXPdheu6P33fBwB4ngcAcByHJpPJl+fn54mD3Gg0NrquXxeLRQAAwzAYj8cwTZPwPH9/sVg8PXweDAauqqr2cDjEer1GJBLBZDJBs9mE4zjwfZ85lAGg2+06hmGgXq+j3+/DsixYlgVN03a9Xu8jgCNCyIegIAgx13Vfd7vdu+FweG8YRkjXdWy329+dTgeSJD3ieZ7RNO0VAXAPwDEAO5VKndi2fWrb9jWl9Esul6PZbDY9Go1OZ7PZ9z/lyuD3OozU2wAAAABJRU5ErkJggg=="/></a>
</div></footer>
</div>
</body>
</html>
