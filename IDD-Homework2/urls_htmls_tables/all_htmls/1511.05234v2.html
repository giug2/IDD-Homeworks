<!DOCTYPE html><html lang="en">
<head>
<meta http-equiv="content-type" content="text/html; charset=UTF-8">
<title>[1511.05234] Ask, Attend and Answer: Exploring Question-Guided Spatial Attention for Visual Question Answering</title><meta property="og:description" content="We address the problem of Visual Question Answering (VQA), which requires joint image and language understanding to answer a question about a given photograph. Recent approaches have applied deep image captioning metho…">
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Ask, Attend and Answer: Exploring Question-Guided Spatial Attention for Visual Question Answering">
<meta name="twitter:image:src" content="https://ar5iv.labs.arxiv.org/assets/ar5iv_card.png">
<meta name="twitter:image:alt" content="ar5iv logo">
<meta property="og:title" content="Ask, Attend and Answer: Exploring Question-Guided Spatial Attention for Visual Question Answering">
<meta property="og:site_name" content="ar5iv">
<meta property="og:image" content="https://ar5iv.labs.arxiv.org/assets/ar5iv_card.png">
<meta property="og:type" content="article">
<meta property="og:url" content="https://ar5iv.labs.arxiv.org/html/1511.05234">

<!--Generated on Thu Mar  7 23:29:20 2024 by LaTeXML (version 0.8.8) http://dlmf.nist.gov/LaTeXML/.-->
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="keywords" lang="en" content="Visual Question Answering,  Spatial Attention,  Memory Network,  Deep Learning">

<script>
  function detectColorScheme(){
    var theme="light";
    var current_theme = localStorage.getItem("ar5iv_theme");
    if(current_theme){
      if(current_theme == "dark"){
        theme = "dark";
      } }
    else if(!window.matchMedia) { return false; }
    else if(window.matchMedia("(prefers-color-scheme: dark)").matches) {
      theme = "dark"; }
    if (theme=="dark") {
      document.documentElement.setAttribute("data-theme", "dark");
    } else {
      document.documentElement.setAttribute("data-theme", "light"); } }

  detectColorScheme();

  function toggleColorScheme(){
    var current_theme = localStorage.getItem("ar5iv_theme");
    if (current_theme) {
      if (current_theme == "light") {
        localStorage.setItem("ar5iv_theme", "dark"); }
      else {
        localStorage.setItem("ar5iv_theme", "light"); } }
    else {
        localStorage.setItem("ar5iv_theme", "dark"); }
    detectColorScheme(); }
</script>
<link media="all" rel="stylesheet" href="/assets/ar5iv-fonts.0.8.0.min.css"><link media="all" rel="stylesheet" href="/assets/ar5iv.0.8.0.min.css"><link media="all" rel="stylesheet" href="/assets/ar5iv-site.0.2.2.css">
</head>
<body>
<div class="ltx_page_main">
<div class="ltx_page_content">
<article class="ltx_document ltx_authors_1line"><span id="id1" class="ltx_note ltx_role_institutetext"><sup class="ltx_note_mark">1</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">1</sup><span class="ltx_note_type">institutetext: </span>Department of Computer Science, UMass Lowell, USA
<br class="ltx_break"><span id="id1.1" class="ltx_text ltx_font_typewriter" style="font-size:90%;">hxu1@cs.uml.edu</span>, <span id="id1.2" class="ltx_text ltx_font_typewriter" style="font-size:90%;">saenko@cs.uml.edu</span></span></span></span>
<h1 class="ltx_title ltx_title_document">Ask, Attend and Answer: Exploring Question-Guided Spatial Attention for Visual Question Answering</h1>
<div class="ltx_authors">
<span class="ltx_creator ltx_role_author">
<span class="ltx_personname">Huijuan Xu
</span></span>
<span class="ltx_author_before">  </span><span class="ltx_creator ltx_role_author">
<span class="ltx_personname">Kate Saenko
</span></span>
</div>

<div class="ltx_abstract">
<h6 class="ltx_title ltx_title_abstract">Abstract</h6>
<p id="id1.id1" class="ltx_p">We address the problem of Visual Question Answering (VQA), which requires joint image and language understanding to answer a question about a given photograph. Recent approaches have applied deep image captioning methods based on convolutional-recurrent networks to this problem, but have failed to model spatial inference. To remedy this, we propose a model we call the Spatial Memory Network and apply it to the VQA task. Memory networks are recurrent neural networks with an explicit attention mechanism that selects certain parts of the information stored in memory. Our Spatial Memory Network stores neuron activations from different spatial regions of the image in its memory, and uses the question to choose relevant regions for computing the answer,
a process of which constitutes a single “hop” in the network.
We propose a novel spatial attention architecture that aligns words with image patches in the first hop, and obtain improved results by adding a second attention hop which considers the whole question to choose visual evidence based on the results of the first hop.
To better understand the inference process learned by the network, we design synthetic questions that specifically require spatial inference and visualize the attention weights. We evaluate our model on two published visual question answering datasets, DAQUAR <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib1" title="" class="ltx_ref">1</a>]</cite> and VQA <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib2" title="" class="ltx_ref">2</a>]</cite>, and obtain improved results compared to a strong deep baseline model (iBOWIMG) which concatenates image and question features to predict the answer <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib3" title="" class="ltx_ref">3</a>]</cite>.</p>
</div>
<div class="ltx_keywords">
<h6 class="ltx_title ltx_title_keywords">Keywords: </h6>Visual Question Answering, Spatial Attention, Memory Network, Deep Learning
</div>
<section id="S1" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">1 </span>Introduction</h2>

<div id="S1.p1" class="ltx_para">
<p id="S1.p1.1" class="ltx_p">Visual Question Answering (VQA) is an emerging interdisciplinary research problem at the intersection of computer vision, natural language processing and artificial intelligence. It has many real-life applications, such as automatic querying of surveillance video <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib4" title="" class="ltx_ref">4</a>]</cite> or assisting the visually impaired <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib5" title="" class="ltx_ref">5</a>]</cite>. Compared to the recently popular image captioning task <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib6" title="" class="ltx_ref">6</a>, <a href="#bib.bib7" title="" class="ltx_ref">7</a>, <a href="#bib.bib8" title="" class="ltx_ref">8</a>, <a href="#bib.bib9" title="" class="ltx_ref">9</a>]</cite>, VQA requires a deeper understanding of the image, but is considerably easier to evaluate. It also puts more focus on artificial intelligence, namely the inference process needed to produce the answer to the visual question.</p>
</div>
<figure id="S1.F1" class="ltx_figure">
<div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_1"><img src="/html/1511.05234/assets/x1.png" id="S1.F1.g1" class="ltx_graphics ltx_centering ltx_figure_panel ltx_img_landscape" width="322" height="78" alt="Refer to caption"></div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_1"><img src="/html/1511.05234/assets/x2.png" id="S1.F1.g2" class="ltx_graphics ltx_centering ltx_figure_panel ltx_img_landscape" width="322" height="78" alt="Refer to caption"></div>
</div>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 1: </span>We propose a Spatial Memory Network for VQA (SMem-VQA) that answers questions about images using spatial inference.
The figure shows the inference process of our two-hop model on examples from the VQA dataset <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib2" title="" class="ltx_ref">2</a>]</cite>. In the first hop (middle), the attention process captures the correspondence between individual words in the question and image regions. High attention regions (bright areas) are marked with bounding boxes and the corresponding words are highlighted using the same color. In the second hop (right), the fine-grained evidence gathered in the first hop, as well as an embedding of the entire question, are used to collect more exact evidence to predict the answer. (Best viewed in color.) </figcaption>
</figure>
<div id="S1.p2" class="ltx_para">
<p id="S1.p2.1" class="ltx_p">In one of the early works <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib1" title="" class="ltx_ref">1</a>]</cite>, VQA is seen as a Turing test proxy. The authors propose an approach based on handcrafted features using a semantic parse of the question and scene analysis of the image combined in a latent-world Bayesian framework. More recently, several end-to-end deep neural networks that learn features directly from data have been applied to this problem <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib10" title="" class="ltx_ref">10</a>, <a href="#bib.bib11" title="" class="ltx_ref">11</a>]</cite>.
Most of these are directly adapted from captioning models <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib6" title="" class="ltx_ref">6</a>, <a href="#bib.bib7" title="" class="ltx_ref">7</a>, <a href="#bib.bib8" title="" class="ltx_ref">8</a>]</cite>,
and utilize a recurrent LSTM network, which takes the question and Convolutional Neural Net (CNN) image features as input, and outputs the answer. Though the deep learning methods in <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib10" title="" class="ltx_ref">10</a>, <a href="#bib.bib11" title="" class="ltx_ref">11</a>]</cite> have shown great improvement compared to the handcrafted feature method <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib1" title="" class="ltx_ref">1</a>]</cite>, they have their own drawbacks. These models based on the LSTM reading in both the question and the image features do not show a clear improvement compared to an LSTM reading in the question only <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib10" title="" class="ltx_ref">10</a>, <a href="#bib.bib11" title="" class="ltx_ref">11</a>]</cite>.
Furthermore, the rather complicated LSTM models obtain similar or worse accuracy to a baseline model which concatenates CNN features and a bag-of-words question embedding to predict the answer, see the IMG+BOW model in <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib11" title="" class="ltx_ref">11</a>]</cite> and the iBOWIMG model in <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib3" title="" class="ltx_ref">3</a>]</cite>.</p>
</div>
<div id="S1.p3" class="ltx_para">
<p id="S1.p3.1" class="ltx_p">A major drawback of existing models is that they do not have any explicit notion of object position, and do not support the computation of intermediate results based on spatial attention.
Our intuition is that answering visual questions often involves looking at different spatial regions and comparing their contents and/or locations. For example, to answer the questions in Fig. <a href="#S1.F1" title="Figure 1 ‣ 1 Introduction ‣ Ask, Attend and Answer: Exploring Question-Guided Spatial Attention for Visual Question Answering" class="ltx_ref"><span class="ltx_text ltx_ref_tag">1</span></a>, we need to look at a portion of the image, such as the child or the phone booth.
Similarly, to answer the question “Is there a cat in the basket?” in Fig. <a href="#S3.F2" title="Figure 2 ‣ 3 Spatial Memory Network for VQA ‣ Ask, Attend and Answer: Exploring Question-Guided Spatial Attention for Visual Question Answering" class="ltx_ref"><span class="ltx_text ltx_ref_tag">2</span></a>, we can first find the basket and the cat objects, and then compare their locations.</p>
</div>
<div id="S1.p4" class="ltx_para">
<p id="S1.p4.1" class="ltx_p">We propose a new deep learning approach to VQA that incorporates explicit spatial attention, which we call the Spatial Memory Network VQA (SMem-VQA).
Our approach is based on memory networks, which have recently been proposed for text Question Answering (QA) <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib12" title="" class="ltx_ref">12</a>, <a href="#bib.bib13" title="" class="ltx_ref">13</a>]</cite>. Memory networks combine learned text embeddings with an attention mechanism and multi-step inference.
The text QA memory network stores textual knowledge in its “memory” in the form of sentences, and selects relevant sentences to infer the answer. However, in VQA, the knowledge is in the form of an image, thus the memory and the question come from different modalities.
We adapt the end-to-end memory network <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib13" title="" class="ltx_ref">13</a>]</cite> to solve visual question answering by storing the convolutional network outputs obtained from different receptive fields into the memory, which explicitly allows spatial attention over the image. We also propose to repeat the process of gathering evidence from attended regions, enabling the model to update the answer based on several attention steps, or “hops”. The entire model is trained end-to-end and the evidence for the computed answer can be visualized using the attention weights.</p>
</div>
<div id="S1.p5" class="ltx_para">
<p id="S1.p5.1" class="ltx_p">To summarize our contributions, in this paper we</p>
<ul id="S1.I1" class="ltx_itemize">
<li id="S1.I1.i1" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="S1.I1.i1.p1" class="ltx_para">
<p id="S1.I1.i1.p1.1" class="ltx_p">propose a novel multi-hop memory network with spatial attention for the VQA task which allows one to visualize the spatial inference process used by the deep network (a CAFFE <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib14" title="" class="ltx_ref">14</a>]</cite> implementation will be made available),</p>
</div>
</li>
<li id="S1.I1.i2" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="S1.I1.i2.p1" class="ltx_para">
<p id="S1.I1.i2.p1.1" class="ltx_p">design an attention architecture in the first hop which uses each word embedding to capture fine-grained alignment between the image and question,</p>
</div>
</li>
<li id="S1.I1.i3" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="S1.I1.i3.p1" class="ltx_para">
<p id="S1.I1.i3.p1.1" class="ltx_p">create a series of synthetic questions that explicitly require spatial inference to analyze the working principles of the network, and show that it learns logical inference rules by visualizing the attention weights,</p>
</div>
</li>
<li id="S1.I1.i4" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="S1.I1.i4.p1" class="ltx_para">
<p id="S1.I1.i4.p1.1" class="ltx_p">provide an extensive evaluation of several existing models and our own model on the same publicly available datasets.</p>
</div>
</li>
</ul>
</div>
<div id="S1.p6" class="ltx_para">
<p id="S1.p6.1" class="ltx_p">Sec. 2 introduces relevant work on memory networks and attention models. Sec. 3 describes our design of the multi-hop memory network architecture for visual question answering (SMem-VQA). Sec. 4 visualizes the inference rules learned by the network for synthetic spatial questions and shows the experimental results on DAQUAR <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib1" title="" class="ltx_ref">1</a>]</cite> and VQA <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib2" title="" class="ltx_ref">2</a>]</cite> datasets. Sec. 5 concludes the paper.</p>
</div>
</section>
<section id="S2" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">2 </span>Related work</h2>

<div id="S2.p1" class="ltx_para">
<p id="S2.p1.1" class="ltx_p">Before the popularity of visual question answering (VQA), text question answering (QA) had already been established as a mature research problem in the area of natural language processing. Previous QA methods include searching for the key words of the question in a search engine <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib15" title="" class="ltx_ref">15</a>]</cite>; parsing the question as a knowledge base (KB) query <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib16" title="" class="ltx_ref">16</a>]</cite>; or embedding the question and using a similarity measurement to find evidence for the answer <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib17" title="" class="ltx_ref">17</a>]</cite>.
Recently, memory networks were proposed for solving the QA problem. <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib12" title="" class="ltx_ref">12</a>]</cite> first introduces the memory network as a general model that consists of a memory and four components: input feature map, generalization, output feature map and response. The model is investigated in the context of question answering, where the long-term memory acts as a dynamic knowledge base and the output is a textual response.
<cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib13" title="" class="ltx_ref">13</a>]</cite> proposes a competitive memory network model that uses less supervision, called end-to-end memory network, which has a recurrent attention model over a large external memory.
The Neural Turing Machine (NTM) <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib18" title="" class="ltx_ref">18</a>]</cite> couples a neural network to external memory and interacts with it by attentional processes to infer simple algorithms such as copying, sorting, and associative recall from input and output examples.
In this paper, we solve the VQA problem using a multimodal memory network architecture that applies a spatial attention mechanism over an input image guided by an input text question.</p>
</div>
<div id="S2.p2" class="ltx_para">
<p id="S2.p2.1" class="ltx_p">The neural attention mechanism has been widely used in different areas of computer vision and natural language processing, see for example the attention models in image captioning <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib19" title="" class="ltx_ref">19</a>]</cite>, video description generation <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib20" title="" class="ltx_ref">20</a>]</cite>, machine translation <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib21" title="" class="ltx_ref">21</a>]</cite><cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib22" title="" class="ltx_ref">22</a>]</cite> and machine reading systems <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib23" title="" class="ltx_ref">23</a>]</cite>.
Most methods use the soft attention mechanism first proposed in <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib21" title="" class="ltx_ref">21</a>]</cite>, which adds a layer to the network that predicts soft weights and uses them to compute a weighted combination of the items in memory.
The two main types of soft attention mechanisms differ in the function that aligns the input feature vector and the candidate feature vectors in order to compute the soft attention weights.
The first type uses an alignment function based on “concatenation” of the input and each candidate (we use the term “concatenation” as described <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib22" title="" class="ltx_ref">22</a>]</cite>), and the second type uses an alignment function based on the dot product of the input and each candidate.
The “concatenation” alignment function adds one input vector (e.g. hidden state vector of the LSTM) to each candidate feature vector, embeds the resulting vectors into scalar values, and then applies the softmax function to generate the attention weight for each candidate.
<cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib19" title="" class="ltx_ref">19</a>]</cite><cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib20" title="" class="ltx_ref">20</a>]</cite><cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib21" title="" class="ltx_ref">21</a>]</cite><cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib23" title="" class="ltx_ref">23</a>]</cite> use the “concatenation” alignment function in their soft attention models and <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib24" title="" class="ltx_ref">24</a>]</cite> gives a literature review of such models applied to different tasks.
On the other hand, the dot product alignment function first projects both inputs to a common vector embedding space, then takes the dot product of the two input vectors, and applies a softmax function to the resulting scalar value to produce the attention weight for each candidate.
The end-to-end memory network <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib13" title="" class="ltx_ref">13</a>]</cite> uses the dot product alignment function.
In <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib22" title="" class="ltx_ref">22</a>]</cite>, the authors compare these two alignment functions in an attention model for the neural machine translation task, and find that their implementation of the “concatenation” alignment function does not yield good performance on their task.
Motivated by this, in this paper we use the dot product alignment function in our Spatial Memory Network.</p>
</div>
<div id="S2.p3" class="ltx_para">
<p id="S2.p3.1" class="ltx_p">VQA is related to image captioning. Several early papers about VQA directly adapt the image captioning models to solve the VQA problem <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib10" title="" class="ltx_ref">10</a>]</cite><cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib11" title="" class="ltx_ref">11</a>]</cite> by generating the answer using a recurrent LSTM network conditioned on the CNN output. But these models’ performance is still limited <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib10" title="" class="ltx_ref">10</a>]</cite><cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib11" title="" class="ltx_ref">11</a>]</cite>.
<cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib25" title="" class="ltx_ref">25</a>]</cite> proposes a new dataset and uses a similar attention model to that in image captioning <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib19" title="" class="ltx_ref">19</a>]</cite>, but does not give results on the more common VQA benchmark <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib2" title="" class="ltx_ref">2</a>]</cite>, and our own implementation of this model is less accurate on <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib2" title="" class="ltx_ref">2</a>]</cite> than other baseline models.
<cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib3" title="" class="ltx_ref">3</a>]</cite> summarizes several recent papers reporting results on the VQA dataset <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib2" title="" class="ltx_ref">2</a>]</cite> on arxiv.org and gives a simple but strong baseline model (iBOWIMG) on this dataset. This simple baseline concatenates the image features with the bag of word embedding question representation and feeds them into a softmax classifier to predict the answer. The iBOWIMG model beats most VQA models considered in the paper. Here, we compare our proposed model to the VQA models (namely, the ACK model <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib26" title="" class="ltx_ref">26</a>]</cite> and the DPPnet model <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib27" title="" class="ltx_ref">27</a>]</cite>) which have comparable or better results than the iBOWIMG model.
The ACK model in <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib26" title="" class="ltx_ref">26</a>]</cite> is essentially the same as the LSTM model in <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib11" title="" class="ltx_ref">11</a>]</cite>, except that it uses image attribute features, the generated image caption and relevant external knowledge from a knowledge base as the input to the LSTM’s first time step.
The DPPnet model in <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib27" title="" class="ltx_ref">27</a>]</cite> tackles VQA by learning a convolutional neural network (CNN) with some parameters predicted from a separate parameter prediction network. Their parameter prediction network uses a Gate Recurrent Unit (GRU) to generate a question representation, and based on this question input, maps the predicted weights to CNN via hashing.
Neither of these models <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib26" title="" class="ltx_ref">26</a>]</cite><cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib27" title="" class="ltx_ref">27</a>]</cite> contain a spatial attention mechanism, and they both use external data in addition to the VQA dataset <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib2" title="" class="ltx_ref">2</a>]</cite>, e.g. the knowledge base in <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib26" title="" class="ltx_ref">26</a>]</cite> and the large-scale text corpus used to pre-train the GRU question representation <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib27" title="" class="ltx_ref">27</a>]</cite>. In this paper, we explore a complementary approach of spatial attention to both improve performance and visualize the network’s inference process, and obtain improved results without using external data compared to the iBOWIMG model <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib3" title="" class="ltx_ref">3</a>]</cite> as well as the ACK model <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib26" title="" class="ltx_ref">26</a>]</cite> and the DPPnet model <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib27" title="" class="ltx_ref">27</a>]</cite> which use external data.</p>
</div>
</section>
<section id="S3" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">3 </span>Spatial Memory Network for VQA</h2>

<figure id="S3.F2" class="ltx_figure"><img src="/html/1511.05234/assets/x3.png" id="S3.F2.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="415" height="151" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 2: </span>Our proposed Spatial Memory Network for Visual Question Answering (SMem-VQA). (a) Overview. First, the CNN activation vectors <math id="S3.F2.10.m1.1" class="ltx_Math" alttext="S=\{s_{i}\}" display="inline"><semantics id="S3.F2.10.m1.1b"><mrow id="S3.F2.10.m1.1.1" xref="S3.F2.10.m1.1.1.cmml"><mi id="S3.F2.10.m1.1.1.3" xref="S3.F2.10.m1.1.1.3.cmml">S</mi><mo id="S3.F2.10.m1.1.1.2" xref="S3.F2.10.m1.1.1.2.cmml">=</mo><mrow id="S3.F2.10.m1.1.1.1.1" xref="S3.F2.10.m1.1.1.1.2.cmml"><mo stretchy="false" id="S3.F2.10.m1.1.1.1.1.2" xref="S3.F2.10.m1.1.1.1.2.cmml">{</mo><msub id="S3.F2.10.m1.1.1.1.1.1" xref="S3.F2.10.m1.1.1.1.1.1.cmml"><mi id="S3.F2.10.m1.1.1.1.1.1.2" xref="S3.F2.10.m1.1.1.1.1.1.2.cmml">s</mi><mi id="S3.F2.10.m1.1.1.1.1.1.3" xref="S3.F2.10.m1.1.1.1.1.1.3.cmml">i</mi></msub><mo stretchy="false" id="S3.F2.10.m1.1.1.1.1.3" xref="S3.F2.10.m1.1.1.1.2.cmml">}</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.F2.10.m1.1c"><apply id="S3.F2.10.m1.1.1.cmml" xref="S3.F2.10.m1.1.1"><eq id="S3.F2.10.m1.1.1.2.cmml" xref="S3.F2.10.m1.1.1.2"></eq><ci id="S3.F2.10.m1.1.1.3.cmml" xref="S3.F2.10.m1.1.1.3">𝑆</ci><set id="S3.F2.10.m1.1.1.1.2.cmml" xref="S3.F2.10.m1.1.1.1.1"><apply id="S3.F2.10.m1.1.1.1.1.1.cmml" xref="S3.F2.10.m1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.F2.10.m1.1.1.1.1.1.1.cmml" xref="S3.F2.10.m1.1.1.1.1.1">subscript</csymbol><ci id="S3.F2.10.m1.1.1.1.1.1.2.cmml" xref="S3.F2.10.m1.1.1.1.1.1.2">𝑠</ci><ci id="S3.F2.10.m1.1.1.1.1.1.3.cmml" xref="S3.F2.10.m1.1.1.1.1.1.3">𝑖</ci></apply></set></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.F2.10.m1.1d">S=\{s_{i}\}</annotation></semantics></math> at image locations <math id="S3.F2.11.m2.1" class="ltx_Math" alttext="i" display="inline"><semantics id="S3.F2.11.m2.1b"><mi id="S3.F2.11.m2.1.1" xref="S3.F2.11.m2.1.1.cmml">i</mi><annotation-xml encoding="MathML-Content" id="S3.F2.11.m2.1c"><ci id="S3.F2.11.m2.1.1.cmml" xref="S3.F2.11.m2.1.1">𝑖</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.F2.11.m2.1d">i</annotation></semantics></math> are projected into the semantic space of the question word vectors <math id="S3.F2.12.m3.1" class="ltx_Math" alttext="v_{j}" display="inline"><semantics id="S3.F2.12.m3.1b"><msub id="S3.F2.12.m3.1.1" xref="S3.F2.12.m3.1.1.cmml"><mi id="S3.F2.12.m3.1.1.2" xref="S3.F2.12.m3.1.1.2.cmml">v</mi><mi id="S3.F2.12.m3.1.1.3" xref="S3.F2.12.m3.1.1.3.cmml">j</mi></msub><annotation-xml encoding="MathML-Content" id="S3.F2.12.m3.1c"><apply id="S3.F2.12.m3.1.1.cmml" xref="S3.F2.12.m3.1.1"><csymbol cd="ambiguous" id="S3.F2.12.m3.1.1.1.cmml" xref="S3.F2.12.m3.1.1">subscript</csymbol><ci id="S3.F2.12.m3.1.1.2.cmml" xref="S3.F2.12.m3.1.1.2">𝑣</ci><ci id="S3.F2.12.m3.1.1.3.cmml" xref="S3.F2.12.m3.1.1.3">𝑗</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.F2.12.m3.1d">v_{j}</annotation></semantics></math> using the “attention” visual embedding <math id="S3.F2.13.m4.1" class="ltx_Math" alttext="W_{A}" display="inline"><semantics id="S3.F2.13.m4.1b"><msub id="S3.F2.13.m4.1.1" xref="S3.F2.13.m4.1.1.cmml"><mi id="S3.F2.13.m4.1.1.2" xref="S3.F2.13.m4.1.1.2.cmml">W</mi><mi id="S3.F2.13.m4.1.1.3" xref="S3.F2.13.m4.1.1.3.cmml">A</mi></msub><annotation-xml encoding="MathML-Content" id="S3.F2.13.m4.1c"><apply id="S3.F2.13.m4.1.1.cmml" xref="S3.F2.13.m4.1.1"><csymbol cd="ambiguous" id="S3.F2.13.m4.1.1.1.cmml" xref="S3.F2.13.m4.1.1">subscript</csymbol><ci id="S3.F2.13.m4.1.1.2.cmml" xref="S3.F2.13.m4.1.1.2">𝑊</ci><ci id="S3.F2.13.m4.1.1.3.cmml" xref="S3.F2.13.m4.1.1.3">𝐴</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.F2.13.m4.1d">W_{A}</annotation></semantics></math> (Sec. <a href="#S3" title="3 Spatial Memory Network for VQA ‣ Ask, Attend and Answer: Exploring Question-Guided Spatial Attention for Visual Question Answering" class="ltx_ref"><span class="ltx_text ltx_ref_tag">3</span></a>). The results are then used to infer spatial attention weights <math id="S3.F2.14.m5.1" class="ltx_Math" alttext="W_{att}" display="inline"><semantics id="S3.F2.14.m5.1b"><msub id="S3.F2.14.m5.1.1" xref="S3.F2.14.m5.1.1.cmml"><mi id="S3.F2.14.m5.1.1.2" xref="S3.F2.14.m5.1.1.2.cmml">W</mi><mrow id="S3.F2.14.m5.1.1.3" xref="S3.F2.14.m5.1.1.3.cmml"><mi id="S3.F2.14.m5.1.1.3.2" xref="S3.F2.14.m5.1.1.3.2.cmml">a</mi><mo lspace="0em" rspace="0em" id="S3.F2.14.m5.1.1.3.1" xref="S3.F2.14.m5.1.1.3.1.cmml">​</mo><mi id="S3.F2.14.m5.1.1.3.3" xref="S3.F2.14.m5.1.1.3.3.cmml">t</mi><mo lspace="0em" rspace="0em" id="S3.F2.14.m5.1.1.3.1b" xref="S3.F2.14.m5.1.1.3.1.cmml">​</mo><mi id="S3.F2.14.m5.1.1.3.4" xref="S3.F2.14.m5.1.1.3.4.cmml">t</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S3.F2.14.m5.1c"><apply id="S3.F2.14.m5.1.1.cmml" xref="S3.F2.14.m5.1.1"><csymbol cd="ambiguous" id="S3.F2.14.m5.1.1.1.cmml" xref="S3.F2.14.m5.1.1">subscript</csymbol><ci id="S3.F2.14.m5.1.1.2.cmml" xref="S3.F2.14.m5.1.1.2">𝑊</ci><apply id="S3.F2.14.m5.1.1.3.cmml" xref="S3.F2.14.m5.1.1.3"><times id="S3.F2.14.m5.1.1.3.1.cmml" xref="S3.F2.14.m5.1.1.3.1"></times><ci id="S3.F2.14.m5.1.1.3.2.cmml" xref="S3.F2.14.m5.1.1.3.2">𝑎</ci><ci id="S3.F2.14.m5.1.1.3.3.cmml" xref="S3.F2.14.m5.1.1.3.3">𝑡</ci><ci id="S3.F2.14.m5.1.1.3.4.cmml" xref="S3.F2.14.m5.1.1.3.4">𝑡</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.F2.14.m5.1d">W_{att}</annotation></semantics></math> using the word-guided attention process shown in (b).
(b) Word-guided attention. This process predicts attention determined by the question word that has the maximum correlation with embedded visual features at each location, e.g. choosing the word <span id="S3.F2.20.1" class="ltx_text ltx_font_italic">basket</span> to attend to the location of the basket in the above image (Sec. <a href="#S3.SS1" title="3.1 Word Guided Spatial Attention in One-Hop Model ‣ 3 Spatial Memory Network for VQA ‣ Ask, Attend and Answer: Exploring Question-Guided Spatial Attention for Visual Question Answering" class="ltx_ref"><span class="ltx_text ltx_ref_tag">3.1</span></a>).
The resulting spatial attention weights <math id="S3.F2.15.m6.1" class="ltx_Math" alttext="W_{att}" display="inline"><semantics id="S3.F2.15.m6.1b"><msub id="S3.F2.15.m6.1.1" xref="S3.F2.15.m6.1.1.cmml"><mi id="S3.F2.15.m6.1.1.2" xref="S3.F2.15.m6.1.1.2.cmml">W</mi><mrow id="S3.F2.15.m6.1.1.3" xref="S3.F2.15.m6.1.1.3.cmml"><mi id="S3.F2.15.m6.1.1.3.2" xref="S3.F2.15.m6.1.1.3.2.cmml">a</mi><mo lspace="0em" rspace="0em" id="S3.F2.15.m6.1.1.3.1" xref="S3.F2.15.m6.1.1.3.1.cmml">​</mo><mi id="S3.F2.15.m6.1.1.3.3" xref="S3.F2.15.m6.1.1.3.3.cmml">t</mi><mo lspace="0em" rspace="0em" id="S3.F2.15.m6.1.1.3.1b" xref="S3.F2.15.m6.1.1.3.1.cmml">​</mo><mi id="S3.F2.15.m6.1.1.3.4" xref="S3.F2.15.m6.1.1.3.4.cmml">t</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S3.F2.15.m6.1c"><apply id="S3.F2.15.m6.1.1.cmml" xref="S3.F2.15.m6.1.1"><csymbol cd="ambiguous" id="S3.F2.15.m6.1.1.1.cmml" xref="S3.F2.15.m6.1.1">subscript</csymbol><ci id="S3.F2.15.m6.1.1.2.cmml" xref="S3.F2.15.m6.1.1.2">𝑊</ci><apply id="S3.F2.15.m6.1.1.3.cmml" xref="S3.F2.15.m6.1.1.3"><times id="S3.F2.15.m6.1.1.3.1.cmml" xref="S3.F2.15.m6.1.1.3.1"></times><ci id="S3.F2.15.m6.1.1.3.2.cmml" xref="S3.F2.15.m6.1.1.3.2">𝑎</ci><ci id="S3.F2.15.m6.1.1.3.3.cmml" xref="S3.F2.15.m6.1.1.3.3">𝑡</ci><ci id="S3.F2.15.m6.1.1.3.4.cmml" xref="S3.F2.15.m6.1.1.3.4">𝑡</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.F2.15.m6.1d">W_{att}</annotation></semantics></math> are then used to compute a weighted sum over the visual features embedded via a separate “evidence” transformation <math id="S3.F2.16.m7.1" class="ltx_Math" alttext="W_{E}" display="inline"><semantics id="S3.F2.16.m7.1b"><msub id="S3.F2.16.m7.1.1" xref="S3.F2.16.m7.1.1.cmml"><mi id="S3.F2.16.m7.1.1.2" xref="S3.F2.16.m7.1.1.2.cmml">W</mi><mi id="S3.F2.16.m7.1.1.3" xref="S3.F2.16.m7.1.1.3.cmml">E</mi></msub><annotation-xml encoding="MathML-Content" id="S3.F2.16.m7.1c"><apply id="S3.F2.16.m7.1.1.cmml" xref="S3.F2.16.m7.1.1"><csymbol cd="ambiguous" id="S3.F2.16.m7.1.1.1.cmml" xref="S3.F2.16.m7.1.1">subscript</csymbol><ci id="S3.F2.16.m7.1.1.2.cmml" xref="S3.F2.16.m7.1.1.2">𝑊</ci><ci id="S3.F2.16.m7.1.1.3.cmml" xref="S3.F2.16.m7.1.1.3">𝐸</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.F2.16.m7.1d">W_{E}</annotation></semantics></math>, e.g., selecting evidence for the cat concept at the basket location. Finally, the weighted evidence vector <math id="S3.F2.17.m8.1" class="ltx_Math" alttext="S_{att}" display="inline"><semantics id="S3.F2.17.m8.1b"><msub id="S3.F2.17.m8.1.1" xref="S3.F2.17.m8.1.1.cmml"><mi id="S3.F2.17.m8.1.1.2" xref="S3.F2.17.m8.1.1.2.cmml">S</mi><mrow id="S3.F2.17.m8.1.1.3" xref="S3.F2.17.m8.1.1.3.cmml"><mi id="S3.F2.17.m8.1.1.3.2" xref="S3.F2.17.m8.1.1.3.2.cmml">a</mi><mo lspace="0em" rspace="0em" id="S3.F2.17.m8.1.1.3.1" xref="S3.F2.17.m8.1.1.3.1.cmml">​</mo><mi id="S3.F2.17.m8.1.1.3.3" xref="S3.F2.17.m8.1.1.3.3.cmml">t</mi><mo lspace="0em" rspace="0em" id="S3.F2.17.m8.1.1.3.1b" xref="S3.F2.17.m8.1.1.3.1.cmml">​</mo><mi id="S3.F2.17.m8.1.1.3.4" xref="S3.F2.17.m8.1.1.3.4.cmml">t</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S3.F2.17.m8.1c"><apply id="S3.F2.17.m8.1.1.cmml" xref="S3.F2.17.m8.1.1"><csymbol cd="ambiguous" id="S3.F2.17.m8.1.1.1.cmml" xref="S3.F2.17.m8.1.1">subscript</csymbol><ci id="S3.F2.17.m8.1.1.2.cmml" xref="S3.F2.17.m8.1.1.2">𝑆</ci><apply id="S3.F2.17.m8.1.1.3.cmml" xref="S3.F2.17.m8.1.1.3"><times id="S3.F2.17.m8.1.1.3.1.cmml" xref="S3.F2.17.m8.1.1.3.1"></times><ci id="S3.F2.17.m8.1.1.3.2.cmml" xref="S3.F2.17.m8.1.1.3.2">𝑎</ci><ci id="S3.F2.17.m8.1.1.3.3.cmml" xref="S3.F2.17.m8.1.1.3.3">𝑡</ci><ci id="S3.F2.17.m8.1.1.3.4.cmml" xref="S3.F2.17.m8.1.1.3.4">𝑡</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.F2.17.m8.1d">S_{att}</annotation></semantics></math> is combined with the full question embedding <math id="S3.F2.18.m9.1" class="ltx_Math" alttext="Q" display="inline"><semantics id="S3.F2.18.m9.1b"><mi id="S3.F2.18.m9.1.1" xref="S3.F2.18.m9.1.1.cmml">Q</mi><annotation-xml encoding="MathML-Content" id="S3.F2.18.m9.1c"><ci id="S3.F2.18.m9.1.1.cmml" xref="S3.F2.18.m9.1.1">𝑄</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.F2.18.m9.1d">Q</annotation></semantics></math> to predict the answer. An additional hop can repeat the process to gather more evidence (Sec. <a href="#S3.SS2" title="3.2 Spatial Attention in Two-Hop Model ‣ 3 Spatial Memory Network for VQA ‣ Ask, Attend and Answer: Exploring Question-Guided Spatial Attention for Visual Question Answering" class="ltx_ref"><span class="ltx_text ltx_ref_tag">3.2</span></a>).
</figcaption>
</figure>
<div id="S3.p1" class="ltx_para">
<p id="S3.p1.1" class="ltx_p">We first give an overview of the proposed SMem-VQA network, illustrated in Fig. <a href="#S3.F2" title="Figure 2 ‣ 3 Spatial Memory Network for VQA ‣ Ask, Attend and Answer: Exploring Question-Guided Spatial Attention for Visual Question Answering" class="ltx_ref"><span class="ltx_text ltx_ref_tag">2</span></a> (a). Sec. <a href="#S3.SS1" title="3.1 Word Guided Spatial Attention in One-Hop Model ‣ 3 Spatial Memory Network for VQA ‣ Ask, Attend and Answer: Exploring Question-Guided Spatial Attention for Visual Question Answering" class="ltx_ref"><span class="ltx_text ltx_ref_tag">3.1</span></a> details the word-guided spatial attention process of the first hop shown in Fig. <a href="#S3.F2" title="Figure 2 ‣ 3 Spatial Memory Network for VQA ‣ Ask, Attend and Answer: Exploring Question-Guided Spatial Attention for Visual Question Answering" class="ltx_ref"><span class="ltx_text ltx_ref_tag">2</span></a> (b), and Sec. <a href="#S3.SS2" title="3.2 Spatial Attention in Two-Hop Model ‣ 3 Spatial Memory Network for VQA ‣ Ask, Attend and Answer: Exploring Question-Guided Spatial Attention for Visual Question Answering" class="ltx_ref"><span class="ltx_text ltx_ref_tag">3.2</span></a> describes adding a second hop into SMem-VQA network.</p>
</div>
<div id="S3.p2" class="ltx_para">
<p id="S3.p2.5" class="ltx_p">The input to our network is a question comprised of a variable-length sequence of words, and an image of fixed size.
Each word in the question is first represented as a one-hot vector in the size of the vocabulary, with a value of one only in the corresponding word position and zeros in the other positions. Each one-hot vector is then embedded into a real-valued word vector, <math id="S3.p2.1.m1.5" class="ltx_Math" alttext="V=\{v_{j}\;|\;v_{j}\in\mathbb{R}^{N};j=1,\cdots,T\}" display="inline"><semantics id="S3.p2.1.m1.5a"><mrow id="S3.p2.1.m1.5.5" xref="S3.p2.1.m1.5.5.cmml"><mi id="S3.p2.1.m1.5.5.4" xref="S3.p2.1.m1.5.5.4.cmml">V</mi><mo id="S3.p2.1.m1.5.5.3" xref="S3.p2.1.m1.5.5.3.cmml">=</mo><mrow id="S3.p2.1.m1.5.5.2.2" xref="S3.p2.1.m1.5.5.2.3.cmml"><mo stretchy="false" id="S3.p2.1.m1.5.5.2.2.3" xref="S3.p2.1.m1.5.5.2.3.1.cmml">{</mo><msub id="S3.p2.1.m1.4.4.1.1.1" xref="S3.p2.1.m1.4.4.1.1.1.cmml"><mi id="S3.p2.1.m1.4.4.1.1.1.2" xref="S3.p2.1.m1.4.4.1.1.1.2.cmml">v</mi><mi id="S3.p2.1.m1.4.4.1.1.1.3" xref="S3.p2.1.m1.4.4.1.1.1.3.cmml">j</mi></msub><mo lspace="0em" id="S3.p2.1.m1.5.5.2.2.4" xref="S3.p2.1.m1.5.5.2.3.1.cmml">|</mo><mrow id="S3.p2.1.m1.5.5.2.2.2.2" xref="S3.p2.1.m1.5.5.2.2.2.3.cmml"><mrow id="S3.p2.1.m1.5.5.2.2.2.1.1" xref="S3.p2.1.m1.5.5.2.2.2.1.1.cmml"><msub id="S3.p2.1.m1.5.5.2.2.2.1.1.2" xref="S3.p2.1.m1.5.5.2.2.2.1.1.2.cmml"><mi id="S3.p2.1.m1.5.5.2.2.2.1.1.2.2" xref="S3.p2.1.m1.5.5.2.2.2.1.1.2.2.cmml">v</mi><mi id="S3.p2.1.m1.5.5.2.2.2.1.1.2.3" xref="S3.p2.1.m1.5.5.2.2.2.1.1.2.3.cmml">j</mi></msub><mo id="S3.p2.1.m1.5.5.2.2.2.1.1.1" xref="S3.p2.1.m1.5.5.2.2.2.1.1.1.cmml">∈</mo><msup id="S3.p2.1.m1.5.5.2.2.2.1.1.3" xref="S3.p2.1.m1.5.5.2.2.2.1.1.3.cmml"><mi id="S3.p2.1.m1.5.5.2.2.2.1.1.3.2" xref="S3.p2.1.m1.5.5.2.2.2.1.1.3.2.cmml">ℝ</mi><mi id="S3.p2.1.m1.5.5.2.2.2.1.1.3.3" xref="S3.p2.1.m1.5.5.2.2.2.1.1.3.3.cmml">N</mi></msup></mrow><mo id="S3.p2.1.m1.5.5.2.2.2.2.3" xref="S3.p2.1.m1.5.5.2.2.2.3a.cmml">;</mo><mrow id="S3.p2.1.m1.5.5.2.2.2.2.2" xref="S3.p2.1.m1.5.5.2.2.2.2.2.cmml"><mi id="S3.p2.1.m1.5.5.2.2.2.2.2.2" xref="S3.p2.1.m1.5.5.2.2.2.2.2.2.cmml">j</mi><mo id="S3.p2.1.m1.5.5.2.2.2.2.2.1" xref="S3.p2.1.m1.5.5.2.2.2.2.2.1.cmml">=</mo><mrow id="S3.p2.1.m1.5.5.2.2.2.2.2.3.2" xref="S3.p2.1.m1.5.5.2.2.2.2.2.3.1.cmml"><mn id="S3.p2.1.m1.1.1" xref="S3.p2.1.m1.1.1.cmml">1</mn><mo id="S3.p2.1.m1.5.5.2.2.2.2.2.3.2.1" xref="S3.p2.1.m1.5.5.2.2.2.2.2.3.1.cmml">,</mo><mi mathvariant="normal" id="S3.p2.1.m1.2.2" xref="S3.p2.1.m1.2.2.cmml">⋯</mi><mo id="S3.p2.1.m1.5.5.2.2.2.2.2.3.2.2" xref="S3.p2.1.m1.5.5.2.2.2.2.2.3.1.cmml">,</mo><mi id="S3.p2.1.m1.3.3" xref="S3.p2.1.m1.3.3.cmml">T</mi></mrow></mrow></mrow><mo stretchy="false" id="S3.p2.1.m1.5.5.2.2.5" xref="S3.p2.1.m1.5.5.2.3.1.cmml">}</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.p2.1.m1.5b"><apply id="S3.p2.1.m1.5.5.cmml" xref="S3.p2.1.m1.5.5"><eq id="S3.p2.1.m1.5.5.3.cmml" xref="S3.p2.1.m1.5.5.3"></eq><ci id="S3.p2.1.m1.5.5.4.cmml" xref="S3.p2.1.m1.5.5.4">𝑉</ci><apply id="S3.p2.1.m1.5.5.2.3.cmml" xref="S3.p2.1.m1.5.5.2.2"><csymbol cd="latexml" id="S3.p2.1.m1.5.5.2.3.1.cmml" xref="S3.p2.1.m1.5.5.2.2.3">conditional-set</csymbol><apply id="S3.p2.1.m1.4.4.1.1.1.cmml" xref="S3.p2.1.m1.4.4.1.1.1"><csymbol cd="ambiguous" id="S3.p2.1.m1.4.4.1.1.1.1.cmml" xref="S3.p2.1.m1.4.4.1.1.1">subscript</csymbol><ci id="S3.p2.1.m1.4.4.1.1.1.2.cmml" xref="S3.p2.1.m1.4.4.1.1.1.2">𝑣</ci><ci id="S3.p2.1.m1.4.4.1.1.1.3.cmml" xref="S3.p2.1.m1.4.4.1.1.1.3">𝑗</ci></apply><apply id="S3.p2.1.m1.5.5.2.2.2.3.cmml" xref="S3.p2.1.m1.5.5.2.2.2.2"><csymbol cd="ambiguous" id="S3.p2.1.m1.5.5.2.2.2.3a.cmml" xref="S3.p2.1.m1.5.5.2.2.2.2.3">formulae-sequence</csymbol><apply id="S3.p2.1.m1.5.5.2.2.2.1.1.cmml" xref="S3.p2.1.m1.5.5.2.2.2.1.1"><in id="S3.p2.1.m1.5.5.2.2.2.1.1.1.cmml" xref="S3.p2.1.m1.5.5.2.2.2.1.1.1"></in><apply id="S3.p2.1.m1.5.5.2.2.2.1.1.2.cmml" xref="S3.p2.1.m1.5.5.2.2.2.1.1.2"><csymbol cd="ambiguous" id="S3.p2.1.m1.5.5.2.2.2.1.1.2.1.cmml" xref="S3.p2.1.m1.5.5.2.2.2.1.1.2">subscript</csymbol><ci id="S3.p2.1.m1.5.5.2.2.2.1.1.2.2.cmml" xref="S3.p2.1.m1.5.5.2.2.2.1.1.2.2">𝑣</ci><ci id="S3.p2.1.m1.5.5.2.2.2.1.1.2.3.cmml" xref="S3.p2.1.m1.5.5.2.2.2.1.1.2.3">𝑗</ci></apply><apply id="S3.p2.1.m1.5.5.2.2.2.1.1.3.cmml" xref="S3.p2.1.m1.5.5.2.2.2.1.1.3"><csymbol cd="ambiguous" id="S3.p2.1.m1.5.5.2.2.2.1.1.3.1.cmml" xref="S3.p2.1.m1.5.5.2.2.2.1.1.3">superscript</csymbol><ci id="S3.p2.1.m1.5.5.2.2.2.1.1.3.2.cmml" xref="S3.p2.1.m1.5.5.2.2.2.1.1.3.2">ℝ</ci><ci id="S3.p2.1.m1.5.5.2.2.2.1.1.3.3.cmml" xref="S3.p2.1.m1.5.5.2.2.2.1.1.3.3">𝑁</ci></apply></apply><apply id="S3.p2.1.m1.5.5.2.2.2.2.2.cmml" xref="S3.p2.1.m1.5.5.2.2.2.2.2"><eq id="S3.p2.1.m1.5.5.2.2.2.2.2.1.cmml" xref="S3.p2.1.m1.5.5.2.2.2.2.2.1"></eq><ci id="S3.p2.1.m1.5.5.2.2.2.2.2.2.cmml" xref="S3.p2.1.m1.5.5.2.2.2.2.2.2">𝑗</ci><list id="S3.p2.1.m1.5.5.2.2.2.2.2.3.1.cmml" xref="S3.p2.1.m1.5.5.2.2.2.2.2.3.2"><cn type="integer" id="S3.p2.1.m1.1.1.cmml" xref="S3.p2.1.m1.1.1">1</cn><ci id="S3.p2.1.m1.2.2.cmml" xref="S3.p2.1.m1.2.2">⋯</ci><ci id="S3.p2.1.m1.3.3.cmml" xref="S3.p2.1.m1.3.3">𝑇</ci></list></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p2.1.m1.5c">V=\{v_{j}\;|\;v_{j}\in\mathbb{R}^{N};j=1,\cdots,T\}</annotation></semantics></math>, where <math id="S3.p2.2.m2.1" class="ltx_Math" alttext="T" display="inline"><semantics id="S3.p2.2.m2.1a"><mi id="S3.p2.2.m2.1.1" xref="S3.p2.2.m2.1.1.cmml">T</mi><annotation-xml encoding="MathML-Content" id="S3.p2.2.m2.1b"><ci id="S3.p2.2.m2.1.1.cmml" xref="S3.p2.2.m2.1.1">𝑇</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.p2.2.m2.1c">T</annotation></semantics></math> is the maximum number of words in the question and <math id="S3.p2.3.m3.1" class="ltx_Math" alttext="N" display="inline"><semantics id="S3.p2.3.m3.1a"><mi id="S3.p2.3.m3.1.1" xref="S3.p2.3.m3.1.1.cmml">N</mi><annotation-xml encoding="MathML-Content" id="S3.p2.3.m3.1b"><ci id="S3.p2.3.m3.1.1.cmml" xref="S3.p2.3.m3.1.1">𝑁</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.p2.3.m3.1c">N</annotation></semantics></math> is the dimensionality of the embedding space. Sentences with length less than <math id="S3.p2.4.m4.1" class="ltx_Math" alttext="T" display="inline"><semantics id="S3.p2.4.m4.1a"><mi id="S3.p2.4.m4.1.1" xref="S3.p2.4.m4.1.1.cmml">T</mi><annotation-xml encoding="MathML-Content" id="S3.p2.4.m4.1b"><ci id="S3.p2.4.m4.1.1.cmml" xref="S3.p2.4.m4.1.1">𝑇</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.p2.4.m4.1c">T</annotation></semantics></math> are padded with special <math id="S3.p2.5.m5.1" class="ltx_Math" alttext="-1" display="inline"><semantics id="S3.p2.5.m5.1a"><mrow id="S3.p2.5.m5.1.1" xref="S3.p2.5.m5.1.1.cmml"><mo id="S3.p2.5.m5.1.1a" xref="S3.p2.5.m5.1.1.cmml">−</mo><mn id="S3.p2.5.m5.1.1.2" xref="S3.p2.5.m5.1.1.2.cmml">1</mn></mrow><annotation-xml encoding="MathML-Content" id="S3.p2.5.m5.1b"><apply id="S3.p2.5.m5.1.1.cmml" xref="S3.p2.5.m5.1.1"><minus id="S3.p2.5.m5.1.1.1.cmml" xref="S3.p2.5.m5.1.1"></minus><cn type="integer" id="S3.p2.5.m5.1.1.2.cmml" xref="S3.p2.5.m5.1.1.2">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p2.5.m5.1c">-1</annotation></semantics></math> value, which are embedded to all-zero word vector.</p>
</div>
<div id="S3.p3" class="ltx_para">
<p id="S3.p3.4" class="ltx_p">The words in questions are used to compute attention over the visual memory, which contains extracted image features. The input image is processed by a convolutional neural network (CNN) to extract high-level <math id="S3.p3.1.m1.1" class="ltx_Math" alttext="M" display="inline"><semantics id="S3.p3.1.m1.1a"><mi id="S3.p3.1.m1.1.1" xref="S3.p3.1.m1.1.1.cmml">M</mi><annotation-xml encoding="MathML-Content" id="S3.p3.1.m1.1b"><ci id="S3.p3.1.m1.1.1.cmml" xref="S3.p3.1.m1.1.1">𝑀</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.p3.1.m1.1c">M</annotation></semantics></math>-dimensional visual features on a grid of spatial locations.
Specifically, we use <math id="S3.p3.2.m2.5" class="ltx_Math" alttext="S=\{s_{i}\;|\;s_{i}\in\mathbb{R}^{M};i=1,\cdots,L\}" display="inline"><semantics id="S3.p3.2.m2.5a"><mrow id="S3.p3.2.m2.5.5" xref="S3.p3.2.m2.5.5.cmml"><mi id="S3.p3.2.m2.5.5.4" xref="S3.p3.2.m2.5.5.4.cmml">S</mi><mo id="S3.p3.2.m2.5.5.3" xref="S3.p3.2.m2.5.5.3.cmml">=</mo><mrow id="S3.p3.2.m2.5.5.2.2" xref="S3.p3.2.m2.5.5.2.3.cmml"><mo stretchy="false" id="S3.p3.2.m2.5.5.2.2.3" xref="S3.p3.2.m2.5.5.2.3.1.cmml">{</mo><msub id="S3.p3.2.m2.4.4.1.1.1" xref="S3.p3.2.m2.4.4.1.1.1.cmml"><mi id="S3.p3.2.m2.4.4.1.1.1.2" xref="S3.p3.2.m2.4.4.1.1.1.2.cmml">s</mi><mi id="S3.p3.2.m2.4.4.1.1.1.3" xref="S3.p3.2.m2.4.4.1.1.1.3.cmml">i</mi></msub><mo lspace="0em" id="S3.p3.2.m2.5.5.2.2.4" xref="S3.p3.2.m2.5.5.2.3.1.cmml">|</mo><mrow id="S3.p3.2.m2.5.5.2.2.2.2" xref="S3.p3.2.m2.5.5.2.2.2.3.cmml"><mrow id="S3.p3.2.m2.5.5.2.2.2.1.1" xref="S3.p3.2.m2.5.5.2.2.2.1.1.cmml"><msub id="S3.p3.2.m2.5.5.2.2.2.1.1.2" xref="S3.p3.2.m2.5.5.2.2.2.1.1.2.cmml"><mi id="S3.p3.2.m2.5.5.2.2.2.1.1.2.2" xref="S3.p3.2.m2.5.5.2.2.2.1.1.2.2.cmml">s</mi><mi id="S3.p3.2.m2.5.5.2.2.2.1.1.2.3" xref="S3.p3.2.m2.5.5.2.2.2.1.1.2.3.cmml">i</mi></msub><mo id="S3.p3.2.m2.5.5.2.2.2.1.1.1" xref="S3.p3.2.m2.5.5.2.2.2.1.1.1.cmml">∈</mo><msup id="S3.p3.2.m2.5.5.2.2.2.1.1.3" xref="S3.p3.2.m2.5.5.2.2.2.1.1.3.cmml"><mi id="S3.p3.2.m2.5.5.2.2.2.1.1.3.2" xref="S3.p3.2.m2.5.5.2.2.2.1.1.3.2.cmml">ℝ</mi><mi id="S3.p3.2.m2.5.5.2.2.2.1.1.3.3" xref="S3.p3.2.m2.5.5.2.2.2.1.1.3.3.cmml">M</mi></msup></mrow><mo id="S3.p3.2.m2.5.5.2.2.2.2.3" xref="S3.p3.2.m2.5.5.2.2.2.3a.cmml">;</mo><mrow id="S3.p3.2.m2.5.5.2.2.2.2.2" xref="S3.p3.2.m2.5.5.2.2.2.2.2.cmml"><mi id="S3.p3.2.m2.5.5.2.2.2.2.2.2" xref="S3.p3.2.m2.5.5.2.2.2.2.2.2.cmml">i</mi><mo id="S3.p3.2.m2.5.5.2.2.2.2.2.1" xref="S3.p3.2.m2.5.5.2.2.2.2.2.1.cmml">=</mo><mrow id="S3.p3.2.m2.5.5.2.2.2.2.2.3.2" xref="S3.p3.2.m2.5.5.2.2.2.2.2.3.1.cmml"><mn id="S3.p3.2.m2.1.1" xref="S3.p3.2.m2.1.1.cmml">1</mn><mo id="S3.p3.2.m2.5.5.2.2.2.2.2.3.2.1" xref="S3.p3.2.m2.5.5.2.2.2.2.2.3.1.cmml">,</mo><mi mathvariant="normal" id="S3.p3.2.m2.2.2" xref="S3.p3.2.m2.2.2.cmml">⋯</mi><mo id="S3.p3.2.m2.5.5.2.2.2.2.2.3.2.2" xref="S3.p3.2.m2.5.5.2.2.2.2.2.3.1.cmml">,</mo><mi id="S3.p3.2.m2.3.3" xref="S3.p3.2.m2.3.3.cmml">L</mi></mrow></mrow></mrow><mo stretchy="false" id="S3.p3.2.m2.5.5.2.2.5" xref="S3.p3.2.m2.5.5.2.3.1.cmml">}</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.p3.2.m2.5b"><apply id="S3.p3.2.m2.5.5.cmml" xref="S3.p3.2.m2.5.5"><eq id="S3.p3.2.m2.5.5.3.cmml" xref="S3.p3.2.m2.5.5.3"></eq><ci id="S3.p3.2.m2.5.5.4.cmml" xref="S3.p3.2.m2.5.5.4">𝑆</ci><apply id="S3.p3.2.m2.5.5.2.3.cmml" xref="S3.p3.2.m2.5.5.2.2"><csymbol cd="latexml" id="S3.p3.2.m2.5.5.2.3.1.cmml" xref="S3.p3.2.m2.5.5.2.2.3">conditional-set</csymbol><apply id="S3.p3.2.m2.4.4.1.1.1.cmml" xref="S3.p3.2.m2.4.4.1.1.1"><csymbol cd="ambiguous" id="S3.p3.2.m2.4.4.1.1.1.1.cmml" xref="S3.p3.2.m2.4.4.1.1.1">subscript</csymbol><ci id="S3.p3.2.m2.4.4.1.1.1.2.cmml" xref="S3.p3.2.m2.4.4.1.1.1.2">𝑠</ci><ci id="S3.p3.2.m2.4.4.1.1.1.3.cmml" xref="S3.p3.2.m2.4.4.1.1.1.3">𝑖</ci></apply><apply id="S3.p3.2.m2.5.5.2.2.2.3.cmml" xref="S3.p3.2.m2.5.5.2.2.2.2"><csymbol cd="ambiguous" id="S3.p3.2.m2.5.5.2.2.2.3a.cmml" xref="S3.p3.2.m2.5.5.2.2.2.2.3">formulae-sequence</csymbol><apply id="S3.p3.2.m2.5.5.2.2.2.1.1.cmml" xref="S3.p3.2.m2.5.5.2.2.2.1.1"><in id="S3.p3.2.m2.5.5.2.2.2.1.1.1.cmml" xref="S3.p3.2.m2.5.5.2.2.2.1.1.1"></in><apply id="S3.p3.2.m2.5.5.2.2.2.1.1.2.cmml" xref="S3.p3.2.m2.5.5.2.2.2.1.1.2"><csymbol cd="ambiguous" id="S3.p3.2.m2.5.5.2.2.2.1.1.2.1.cmml" xref="S3.p3.2.m2.5.5.2.2.2.1.1.2">subscript</csymbol><ci id="S3.p3.2.m2.5.5.2.2.2.1.1.2.2.cmml" xref="S3.p3.2.m2.5.5.2.2.2.1.1.2.2">𝑠</ci><ci id="S3.p3.2.m2.5.5.2.2.2.1.1.2.3.cmml" xref="S3.p3.2.m2.5.5.2.2.2.1.1.2.3">𝑖</ci></apply><apply id="S3.p3.2.m2.5.5.2.2.2.1.1.3.cmml" xref="S3.p3.2.m2.5.5.2.2.2.1.1.3"><csymbol cd="ambiguous" id="S3.p3.2.m2.5.5.2.2.2.1.1.3.1.cmml" xref="S3.p3.2.m2.5.5.2.2.2.1.1.3">superscript</csymbol><ci id="S3.p3.2.m2.5.5.2.2.2.1.1.3.2.cmml" xref="S3.p3.2.m2.5.5.2.2.2.1.1.3.2">ℝ</ci><ci id="S3.p3.2.m2.5.5.2.2.2.1.1.3.3.cmml" xref="S3.p3.2.m2.5.5.2.2.2.1.1.3.3">𝑀</ci></apply></apply><apply id="S3.p3.2.m2.5.5.2.2.2.2.2.cmml" xref="S3.p3.2.m2.5.5.2.2.2.2.2"><eq id="S3.p3.2.m2.5.5.2.2.2.2.2.1.cmml" xref="S3.p3.2.m2.5.5.2.2.2.2.2.1"></eq><ci id="S3.p3.2.m2.5.5.2.2.2.2.2.2.cmml" xref="S3.p3.2.m2.5.5.2.2.2.2.2.2">𝑖</ci><list id="S3.p3.2.m2.5.5.2.2.2.2.2.3.1.cmml" xref="S3.p3.2.m2.5.5.2.2.2.2.2.3.2"><cn type="integer" id="S3.p3.2.m2.1.1.cmml" xref="S3.p3.2.m2.1.1">1</cn><ci id="S3.p3.2.m2.2.2.cmml" xref="S3.p3.2.m2.2.2">⋯</ci><ci id="S3.p3.2.m2.3.3.cmml" xref="S3.p3.2.m2.3.3">𝐿</ci></list></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p3.2.m2.5c">S=\{s_{i}\;|\;s_{i}\in\mathbb{R}^{M};i=1,\cdots,L\}</annotation></semantics></math> to represent the spatial CNN features at each of the <math id="S3.p3.3.m3.1" class="ltx_Math" alttext="L" display="inline"><semantics id="S3.p3.3.m3.1a"><mi id="S3.p3.3.m3.1.1" xref="S3.p3.3.m3.1.1.cmml">L</mi><annotation-xml encoding="MathML-Content" id="S3.p3.3.m3.1b"><ci id="S3.p3.3.m3.1.1.cmml" xref="S3.p3.3.m3.1.1">𝐿</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.p3.3.m3.1c">L</annotation></semantics></math> grid locations. In this paper, the spatial feature outputs of the last convolutional layer of GoogLeNet (<math id="S3.p3.4.m4.1" class="ltx_Math" alttext="inception\_5b/output" display="inline"><semantics id="S3.p3.4.m4.1a"><mrow id="S3.p3.4.m4.1.1" xref="S3.p3.4.m4.1.1.cmml"><mrow id="S3.p3.4.m4.1.1.2" xref="S3.p3.4.m4.1.1.2.cmml"><mrow id="S3.p3.4.m4.1.1.2.2" xref="S3.p3.4.m4.1.1.2.2.cmml"><mi id="S3.p3.4.m4.1.1.2.2.2" xref="S3.p3.4.m4.1.1.2.2.2.cmml">i</mi><mo lspace="0em" rspace="0em" id="S3.p3.4.m4.1.1.2.2.1" xref="S3.p3.4.m4.1.1.2.2.1.cmml">​</mo><mi id="S3.p3.4.m4.1.1.2.2.3" xref="S3.p3.4.m4.1.1.2.2.3.cmml">n</mi><mo lspace="0em" rspace="0em" id="S3.p3.4.m4.1.1.2.2.1a" xref="S3.p3.4.m4.1.1.2.2.1.cmml">​</mo><mi id="S3.p3.4.m4.1.1.2.2.4" xref="S3.p3.4.m4.1.1.2.2.4.cmml">c</mi><mo lspace="0em" rspace="0em" id="S3.p3.4.m4.1.1.2.2.1b" xref="S3.p3.4.m4.1.1.2.2.1.cmml">​</mo><mi id="S3.p3.4.m4.1.1.2.2.5" xref="S3.p3.4.m4.1.1.2.2.5.cmml">e</mi><mo lspace="0em" rspace="0em" id="S3.p3.4.m4.1.1.2.2.1c" xref="S3.p3.4.m4.1.1.2.2.1.cmml">​</mo><mi id="S3.p3.4.m4.1.1.2.2.6" xref="S3.p3.4.m4.1.1.2.2.6.cmml">p</mi><mo lspace="0em" rspace="0em" id="S3.p3.4.m4.1.1.2.2.1d" xref="S3.p3.4.m4.1.1.2.2.1.cmml">​</mo><mi id="S3.p3.4.m4.1.1.2.2.7" xref="S3.p3.4.m4.1.1.2.2.7.cmml">t</mi><mo lspace="0em" rspace="0em" id="S3.p3.4.m4.1.1.2.2.1e" xref="S3.p3.4.m4.1.1.2.2.1.cmml">​</mo><mi id="S3.p3.4.m4.1.1.2.2.8" xref="S3.p3.4.m4.1.1.2.2.8.cmml">i</mi><mo lspace="0em" rspace="0em" id="S3.p3.4.m4.1.1.2.2.1f" xref="S3.p3.4.m4.1.1.2.2.1.cmml">​</mo><mi id="S3.p3.4.m4.1.1.2.2.9" xref="S3.p3.4.m4.1.1.2.2.9.cmml">o</mi><mo lspace="0em" rspace="0em" id="S3.p3.4.m4.1.1.2.2.1g" xref="S3.p3.4.m4.1.1.2.2.1.cmml">​</mo><mi id="S3.p3.4.m4.1.1.2.2.10" xref="S3.p3.4.m4.1.1.2.2.10.cmml">n</mi><mo lspace="0em" rspace="0em" id="S3.p3.4.m4.1.1.2.2.1h" xref="S3.p3.4.m4.1.1.2.2.1.cmml">​</mo><mi mathvariant="normal" id="S3.p3.4.m4.1.1.2.2.11" xref="S3.p3.4.m4.1.1.2.2.11.cmml">_</mi><mo lspace="0em" rspace="0em" id="S3.p3.4.m4.1.1.2.2.1i" xref="S3.p3.4.m4.1.1.2.2.1.cmml">​</mo><mn id="S3.p3.4.m4.1.1.2.2.12" xref="S3.p3.4.m4.1.1.2.2.12.cmml">5</mn><mo lspace="0em" rspace="0em" id="S3.p3.4.m4.1.1.2.2.1j" xref="S3.p3.4.m4.1.1.2.2.1.cmml">​</mo><mi id="S3.p3.4.m4.1.1.2.2.13" xref="S3.p3.4.m4.1.1.2.2.13.cmml">b</mi></mrow><mo id="S3.p3.4.m4.1.1.2.1" xref="S3.p3.4.m4.1.1.2.1.cmml">/</mo><mi id="S3.p3.4.m4.1.1.2.3" xref="S3.p3.4.m4.1.1.2.3.cmml">o</mi></mrow><mo lspace="0em" rspace="0em" id="S3.p3.4.m4.1.1.1" xref="S3.p3.4.m4.1.1.1.cmml">​</mo><mi id="S3.p3.4.m4.1.1.3" xref="S3.p3.4.m4.1.1.3.cmml">u</mi><mo lspace="0em" rspace="0em" id="S3.p3.4.m4.1.1.1a" xref="S3.p3.4.m4.1.1.1.cmml">​</mo><mi id="S3.p3.4.m4.1.1.4" xref="S3.p3.4.m4.1.1.4.cmml">t</mi><mo lspace="0em" rspace="0em" id="S3.p3.4.m4.1.1.1b" xref="S3.p3.4.m4.1.1.1.cmml">​</mo><mi id="S3.p3.4.m4.1.1.5" xref="S3.p3.4.m4.1.1.5.cmml">p</mi><mo lspace="0em" rspace="0em" id="S3.p3.4.m4.1.1.1c" xref="S3.p3.4.m4.1.1.1.cmml">​</mo><mi id="S3.p3.4.m4.1.1.6" xref="S3.p3.4.m4.1.1.6.cmml">u</mi><mo lspace="0em" rspace="0em" id="S3.p3.4.m4.1.1.1d" xref="S3.p3.4.m4.1.1.1.cmml">​</mo><mi id="S3.p3.4.m4.1.1.7" xref="S3.p3.4.m4.1.1.7.cmml">t</mi></mrow><annotation-xml encoding="MathML-Content" id="S3.p3.4.m4.1b"><apply id="S3.p3.4.m4.1.1.cmml" xref="S3.p3.4.m4.1.1"><times id="S3.p3.4.m4.1.1.1.cmml" xref="S3.p3.4.m4.1.1.1"></times><apply id="S3.p3.4.m4.1.1.2.cmml" xref="S3.p3.4.m4.1.1.2"><divide id="S3.p3.4.m4.1.1.2.1.cmml" xref="S3.p3.4.m4.1.1.2.1"></divide><apply id="S3.p3.4.m4.1.1.2.2.cmml" xref="S3.p3.4.m4.1.1.2.2"><times id="S3.p3.4.m4.1.1.2.2.1.cmml" xref="S3.p3.4.m4.1.1.2.2.1"></times><ci id="S3.p3.4.m4.1.1.2.2.2.cmml" xref="S3.p3.4.m4.1.1.2.2.2">𝑖</ci><ci id="S3.p3.4.m4.1.1.2.2.3.cmml" xref="S3.p3.4.m4.1.1.2.2.3">𝑛</ci><ci id="S3.p3.4.m4.1.1.2.2.4.cmml" xref="S3.p3.4.m4.1.1.2.2.4">𝑐</ci><ci id="S3.p3.4.m4.1.1.2.2.5.cmml" xref="S3.p3.4.m4.1.1.2.2.5">𝑒</ci><ci id="S3.p3.4.m4.1.1.2.2.6.cmml" xref="S3.p3.4.m4.1.1.2.2.6">𝑝</ci><ci id="S3.p3.4.m4.1.1.2.2.7.cmml" xref="S3.p3.4.m4.1.1.2.2.7">𝑡</ci><ci id="S3.p3.4.m4.1.1.2.2.8.cmml" xref="S3.p3.4.m4.1.1.2.2.8">𝑖</ci><ci id="S3.p3.4.m4.1.1.2.2.9.cmml" xref="S3.p3.4.m4.1.1.2.2.9">𝑜</ci><ci id="S3.p3.4.m4.1.1.2.2.10.cmml" xref="S3.p3.4.m4.1.1.2.2.10">𝑛</ci><ci id="S3.p3.4.m4.1.1.2.2.11.cmml" xref="S3.p3.4.m4.1.1.2.2.11">_</ci><cn type="integer" id="S3.p3.4.m4.1.1.2.2.12.cmml" xref="S3.p3.4.m4.1.1.2.2.12">5</cn><ci id="S3.p3.4.m4.1.1.2.2.13.cmml" xref="S3.p3.4.m4.1.1.2.2.13">𝑏</ci></apply><ci id="S3.p3.4.m4.1.1.2.3.cmml" xref="S3.p3.4.m4.1.1.2.3">𝑜</ci></apply><ci id="S3.p3.4.m4.1.1.3.cmml" xref="S3.p3.4.m4.1.1.3">𝑢</ci><ci id="S3.p3.4.m4.1.1.4.cmml" xref="S3.p3.4.m4.1.1.4">𝑡</ci><ci id="S3.p3.4.m4.1.1.5.cmml" xref="S3.p3.4.m4.1.1.5">𝑝</ci><ci id="S3.p3.4.m4.1.1.6.cmml" xref="S3.p3.4.m4.1.1.6">𝑢</ci><ci id="S3.p3.4.m4.1.1.7.cmml" xref="S3.p3.4.m4.1.1.7">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p3.4.m4.1c">inception\_5b/output</annotation></semantics></math>) <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib28" title="" class="ltx_ref">28</a>]</cite> are used as the visual features for the image.</p>
</div>
<div id="S3.p4" class="ltx_para">
<p id="S3.p4.3" class="ltx_p">The convolutional image feature vectors at each location are embedded into a common semantic space with the word vectors.
Two different embeddings are used: the “attention” embedding <math id="S3.p4.1.m1.1" class="ltx_Math" alttext="W_{A}" display="inline"><semantics id="S3.p4.1.m1.1a"><msub id="S3.p4.1.m1.1.1" xref="S3.p4.1.m1.1.1.cmml"><mi id="S3.p4.1.m1.1.1.2" xref="S3.p4.1.m1.1.1.2.cmml">W</mi><mi id="S3.p4.1.m1.1.1.3" xref="S3.p4.1.m1.1.1.3.cmml">A</mi></msub><annotation-xml encoding="MathML-Content" id="S3.p4.1.m1.1b"><apply id="S3.p4.1.m1.1.1.cmml" xref="S3.p4.1.m1.1.1"><csymbol cd="ambiguous" id="S3.p4.1.m1.1.1.1.cmml" xref="S3.p4.1.m1.1.1">subscript</csymbol><ci id="S3.p4.1.m1.1.1.2.cmml" xref="S3.p4.1.m1.1.1.2">𝑊</ci><ci id="S3.p4.1.m1.1.1.3.cmml" xref="S3.p4.1.m1.1.1.3">𝐴</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p4.1.m1.1c">W_{A}</annotation></semantics></math> and the “evidence” embedding <math id="S3.p4.2.m2.1" class="ltx_Math" alttext="W_{E}" display="inline"><semantics id="S3.p4.2.m2.1a"><msub id="S3.p4.2.m2.1.1" xref="S3.p4.2.m2.1.1.cmml"><mi id="S3.p4.2.m2.1.1.2" xref="S3.p4.2.m2.1.1.2.cmml">W</mi><mi id="S3.p4.2.m2.1.1.3" xref="S3.p4.2.m2.1.1.3.cmml">E</mi></msub><annotation-xml encoding="MathML-Content" id="S3.p4.2.m2.1b"><apply id="S3.p4.2.m2.1.1.cmml" xref="S3.p4.2.m2.1.1"><csymbol cd="ambiguous" id="S3.p4.2.m2.1.1.1.cmml" xref="S3.p4.2.m2.1.1">subscript</csymbol><ci id="S3.p4.2.m2.1.1.2.cmml" xref="S3.p4.2.m2.1.1.2">𝑊</ci><ci id="S3.p4.2.m2.1.1.3.cmml" xref="S3.p4.2.m2.1.1.3">𝐸</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p4.2.m2.1c">W_{E}</annotation></semantics></math>.
The attention embedding projects each visual feature vector such that its combination with the embedded question words generates the attention weight at that location. The evidence embedding detects the presence of semantic concepts or objects, and the embedding results are multiplied with attention weights and summed over all locations to generate the visual evidence vector <math id="S3.p4.3.m3.1" class="ltx_Math" alttext="S_{att}" display="inline"><semantics id="S3.p4.3.m3.1a"><msub id="S3.p4.3.m3.1.1" xref="S3.p4.3.m3.1.1.cmml"><mi id="S3.p4.3.m3.1.1.2" xref="S3.p4.3.m3.1.1.2.cmml">S</mi><mrow id="S3.p4.3.m3.1.1.3" xref="S3.p4.3.m3.1.1.3.cmml"><mi id="S3.p4.3.m3.1.1.3.2" xref="S3.p4.3.m3.1.1.3.2.cmml">a</mi><mo lspace="0em" rspace="0em" id="S3.p4.3.m3.1.1.3.1" xref="S3.p4.3.m3.1.1.3.1.cmml">​</mo><mi id="S3.p4.3.m3.1.1.3.3" xref="S3.p4.3.m3.1.1.3.3.cmml">t</mi><mo lspace="0em" rspace="0em" id="S3.p4.3.m3.1.1.3.1a" xref="S3.p4.3.m3.1.1.3.1.cmml">​</mo><mi id="S3.p4.3.m3.1.1.3.4" xref="S3.p4.3.m3.1.1.3.4.cmml">t</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S3.p4.3.m3.1b"><apply id="S3.p4.3.m3.1.1.cmml" xref="S3.p4.3.m3.1.1"><csymbol cd="ambiguous" id="S3.p4.3.m3.1.1.1.cmml" xref="S3.p4.3.m3.1.1">subscript</csymbol><ci id="S3.p4.3.m3.1.1.2.cmml" xref="S3.p4.3.m3.1.1.2">𝑆</ci><apply id="S3.p4.3.m3.1.1.3.cmml" xref="S3.p4.3.m3.1.1.3"><times id="S3.p4.3.m3.1.1.3.1.cmml" xref="S3.p4.3.m3.1.1.3.1"></times><ci id="S3.p4.3.m3.1.1.3.2.cmml" xref="S3.p4.3.m3.1.1.3.2">𝑎</ci><ci id="S3.p4.3.m3.1.1.3.3.cmml" xref="S3.p4.3.m3.1.1.3.3">𝑡</ci><ci id="S3.p4.3.m3.1.1.3.4.cmml" xref="S3.p4.3.m3.1.1.3.4">𝑡</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p4.3.m3.1c">S_{att}</annotation></semantics></math>.</p>
</div>
<div id="S3.p5" class="ltx_para">
<p id="S3.p5.1" class="ltx_p">Finally, the visual evidence vector is combined with the question representation and used to predict the answer for the given image and question.
In the next section, we describe the one-hop Spatial Memory network model and the specific attention mechanism it uses in more detail.</p>
</div>
<section id="S3.SS1" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.1 </span>Word Guided Spatial Attention in One-Hop Model</h3>

<div id="S3.SS1.p1" class="ltx_para">
<p id="S3.SS1.p1.3" class="ltx_p">Rather than using the bag-of-words question representation to guide attention,
the attention architecture in the first hop (Fig. <a href="#S3.F2" title="Figure 2 ‣ 3 Spatial Memory Network for VQA ‣ Ask, Attend and Answer: Exploring Question-Guided Spatial Attention for Visual Question Answering" class="ltx_ref"><span class="ltx_text ltx_ref_tag">2</span></a>(b)) uses each word vector separately to extract correlated visual features in memory.
The intuition is that the BOW representation may be too coarse, and letting each word select a related region may provide more fine-grained attention.
The correlation matrix <math id="S3.SS1.p1.1.m1.1" class="ltx_Math" alttext="C\in\mathbb{R}^{T\times L}" display="inline"><semantics id="S3.SS1.p1.1.m1.1a"><mrow id="S3.SS1.p1.1.m1.1.1" xref="S3.SS1.p1.1.m1.1.1.cmml"><mi id="S3.SS1.p1.1.m1.1.1.2" xref="S3.SS1.p1.1.m1.1.1.2.cmml">C</mi><mo id="S3.SS1.p1.1.m1.1.1.1" xref="S3.SS1.p1.1.m1.1.1.1.cmml">∈</mo><msup id="S3.SS1.p1.1.m1.1.1.3" xref="S3.SS1.p1.1.m1.1.1.3.cmml"><mi id="S3.SS1.p1.1.m1.1.1.3.2" xref="S3.SS1.p1.1.m1.1.1.3.2.cmml">ℝ</mi><mrow id="S3.SS1.p1.1.m1.1.1.3.3" xref="S3.SS1.p1.1.m1.1.1.3.3.cmml"><mi id="S3.SS1.p1.1.m1.1.1.3.3.2" xref="S3.SS1.p1.1.m1.1.1.3.3.2.cmml">T</mi><mo lspace="0.222em" rspace="0.222em" id="S3.SS1.p1.1.m1.1.1.3.3.1" xref="S3.SS1.p1.1.m1.1.1.3.3.1.cmml">×</mo><mi id="S3.SS1.p1.1.m1.1.1.3.3.3" xref="S3.SS1.p1.1.m1.1.1.3.3.3.cmml">L</mi></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.1.m1.1b"><apply id="S3.SS1.p1.1.m1.1.1.cmml" xref="S3.SS1.p1.1.m1.1.1"><in id="S3.SS1.p1.1.m1.1.1.1.cmml" xref="S3.SS1.p1.1.m1.1.1.1"></in><ci id="S3.SS1.p1.1.m1.1.1.2.cmml" xref="S3.SS1.p1.1.m1.1.1.2">𝐶</ci><apply id="S3.SS1.p1.1.m1.1.1.3.cmml" xref="S3.SS1.p1.1.m1.1.1.3"><csymbol cd="ambiguous" id="S3.SS1.p1.1.m1.1.1.3.1.cmml" xref="S3.SS1.p1.1.m1.1.1.3">superscript</csymbol><ci id="S3.SS1.p1.1.m1.1.1.3.2.cmml" xref="S3.SS1.p1.1.m1.1.1.3.2">ℝ</ci><apply id="S3.SS1.p1.1.m1.1.1.3.3.cmml" xref="S3.SS1.p1.1.m1.1.1.3.3"><times id="S3.SS1.p1.1.m1.1.1.3.3.1.cmml" xref="S3.SS1.p1.1.m1.1.1.3.3.1"></times><ci id="S3.SS1.p1.1.m1.1.1.3.3.2.cmml" xref="S3.SS1.p1.1.m1.1.1.3.3.2">𝑇</ci><ci id="S3.SS1.p1.1.m1.1.1.3.3.3.cmml" xref="S3.SS1.p1.1.m1.1.1.3.3.3">𝐿</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.1.m1.1c">C\in\mathbb{R}^{T\times L}</annotation></semantics></math> between word vectors <math id="S3.SS1.p1.2.m2.1" class="ltx_Math" alttext="V" display="inline"><semantics id="S3.SS1.p1.2.m2.1a"><mi id="S3.SS1.p1.2.m2.1.1" xref="S3.SS1.p1.2.m2.1.1.cmml">V</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.2.m2.1b"><ci id="S3.SS1.p1.2.m2.1.1.cmml" xref="S3.SS1.p1.2.m2.1.1">𝑉</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.2.m2.1c">V</annotation></semantics></math> and visual features <math id="S3.SS1.p1.3.m3.1" class="ltx_Math" alttext="S" display="inline"><semantics id="S3.SS1.p1.3.m3.1a"><mi id="S3.SS1.p1.3.m3.1.1" xref="S3.SS1.p1.3.m3.1.1.cmml">S</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.3.m3.1b"><ci id="S3.SS1.p1.3.m3.1.1.cmml" xref="S3.SS1.p1.3.m3.1.1">𝑆</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.3.m3.1c">S</annotation></semantics></math> is computed as</p>
<table id="S3.E1" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S3.E1.m1.1" class="ltx_Math" alttext="C=V\cdot(S\cdot W_{A}+b_{A})^{T}" display="block"><semantics id="S3.E1.m1.1a"><mrow id="S3.E1.m1.1.1" xref="S3.E1.m1.1.1.cmml"><mi id="S3.E1.m1.1.1.3" xref="S3.E1.m1.1.1.3.cmml">C</mi><mo id="S3.E1.m1.1.1.2" xref="S3.E1.m1.1.1.2.cmml">=</mo><mrow id="S3.E1.m1.1.1.1" xref="S3.E1.m1.1.1.1.cmml"><mi id="S3.E1.m1.1.1.1.3" xref="S3.E1.m1.1.1.1.3.cmml">V</mi><mo lspace="0.222em" rspace="0.222em" id="S3.E1.m1.1.1.1.2" xref="S3.E1.m1.1.1.1.2.cmml">⋅</mo><msup id="S3.E1.m1.1.1.1.1" xref="S3.E1.m1.1.1.1.1.cmml"><mrow id="S3.E1.m1.1.1.1.1.1.1" xref="S3.E1.m1.1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S3.E1.m1.1.1.1.1.1.1.2" xref="S3.E1.m1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="S3.E1.m1.1.1.1.1.1.1.1" xref="S3.E1.m1.1.1.1.1.1.1.1.cmml"><mrow id="S3.E1.m1.1.1.1.1.1.1.1.2" xref="S3.E1.m1.1.1.1.1.1.1.1.2.cmml"><mi id="S3.E1.m1.1.1.1.1.1.1.1.2.2" xref="S3.E1.m1.1.1.1.1.1.1.1.2.2.cmml">S</mi><mo lspace="0.222em" rspace="0.222em" id="S3.E1.m1.1.1.1.1.1.1.1.2.1" xref="S3.E1.m1.1.1.1.1.1.1.1.2.1.cmml">⋅</mo><msub id="S3.E1.m1.1.1.1.1.1.1.1.2.3" xref="S3.E1.m1.1.1.1.1.1.1.1.2.3.cmml"><mi id="S3.E1.m1.1.1.1.1.1.1.1.2.3.2" xref="S3.E1.m1.1.1.1.1.1.1.1.2.3.2.cmml">W</mi><mi id="S3.E1.m1.1.1.1.1.1.1.1.2.3.3" xref="S3.E1.m1.1.1.1.1.1.1.1.2.3.3.cmml">A</mi></msub></mrow><mo id="S3.E1.m1.1.1.1.1.1.1.1.1" xref="S3.E1.m1.1.1.1.1.1.1.1.1.cmml">+</mo><msub id="S3.E1.m1.1.1.1.1.1.1.1.3" xref="S3.E1.m1.1.1.1.1.1.1.1.3.cmml"><mi id="S3.E1.m1.1.1.1.1.1.1.1.3.2" xref="S3.E1.m1.1.1.1.1.1.1.1.3.2.cmml">b</mi><mi id="S3.E1.m1.1.1.1.1.1.1.1.3.3" xref="S3.E1.m1.1.1.1.1.1.1.1.3.3.cmml">A</mi></msub></mrow><mo stretchy="false" id="S3.E1.m1.1.1.1.1.1.1.3" xref="S3.E1.m1.1.1.1.1.1.1.1.cmml">)</mo></mrow><mi id="S3.E1.m1.1.1.1.1.3" xref="S3.E1.m1.1.1.1.1.3.cmml">T</mi></msup></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.E1.m1.1b"><apply id="S3.E1.m1.1.1.cmml" xref="S3.E1.m1.1.1"><eq id="S3.E1.m1.1.1.2.cmml" xref="S3.E1.m1.1.1.2"></eq><ci id="S3.E1.m1.1.1.3.cmml" xref="S3.E1.m1.1.1.3">𝐶</ci><apply id="S3.E1.m1.1.1.1.cmml" xref="S3.E1.m1.1.1.1"><ci id="S3.E1.m1.1.1.1.2.cmml" xref="S3.E1.m1.1.1.1.2">⋅</ci><ci id="S3.E1.m1.1.1.1.3.cmml" xref="S3.E1.m1.1.1.1.3">𝑉</ci><apply id="S3.E1.m1.1.1.1.1.cmml" xref="S3.E1.m1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E1.m1.1.1.1.1.2.cmml" xref="S3.E1.m1.1.1.1.1">superscript</csymbol><apply id="S3.E1.m1.1.1.1.1.1.1.1.cmml" xref="S3.E1.m1.1.1.1.1.1.1"><plus id="S3.E1.m1.1.1.1.1.1.1.1.1.cmml" xref="S3.E1.m1.1.1.1.1.1.1.1.1"></plus><apply id="S3.E1.m1.1.1.1.1.1.1.1.2.cmml" xref="S3.E1.m1.1.1.1.1.1.1.1.2"><ci id="S3.E1.m1.1.1.1.1.1.1.1.2.1.cmml" xref="S3.E1.m1.1.1.1.1.1.1.1.2.1">⋅</ci><ci id="S3.E1.m1.1.1.1.1.1.1.1.2.2.cmml" xref="S3.E1.m1.1.1.1.1.1.1.1.2.2">𝑆</ci><apply id="S3.E1.m1.1.1.1.1.1.1.1.2.3.cmml" xref="S3.E1.m1.1.1.1.1.1.1.1.2.3"><csymbol cd="ambiguous" id="S3.E1.m1.1.1.1.1.1.1.1.2.3.1.cmml" xref="S3.E1.m1.1.1.1.1.1.1.1.2.3">subscript</csymbol><ci id="S3.E1.m1.1.1.1.1.1.1.1.2.3.2.cmml" xref="S3.E1.m1.1.1.1.1.1.1.1.2.3.2">𝑊</ci><ci id="S3.E1.m1.1.1.1.1.1.1.1.2.3.3.cmml" xref="S3.E1.m1.1.1.1.1.1.1.1.2.3.3">𝐴</ci></apply></apply><apply id="S3.E1.m1.1.1.1.1.1.1.1.3.cmml" xref="S3.E1.m1.1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.E1.m1.1.1.1.1.1.1.1.3.1.cmml" xref="S3.E1.m1.1.1.1.1.1.1.1.3">subscript</csymbol><ci id="S3.E1.m1.1.1.1.1.1.1.1.3.2.cmml" xref="S3.E1.m1.1.1.1.1.1.1.1.3.2">𝑏</ci><ci id="S3.E1.m1.1.1.1.1.1.1.1.3.3.cmml" xref="S3.E1.m1.1.1.1.1.1.1.1.3.3">𝐴</ci></apply></apply><ci id="S3.E1.m1.1.1.1.1.3.cmml" xref="S3.E1.m1.1.1.1.1.3">𝑇</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E1.m1.1c">C=V\cdot(S\cdot W_{A}+b_{A})^{T}</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(1)</span></td>
</tr></tbody>
</table>
<p id="S3.SS1.p1.7" class="ltx_p">where <math id="S3.SS1.p1.4.m1.1" class="ltx_Math" alttext="W_{A}\in\mathbb{R}^{M\times N}" display="inline"><semantics id="S3.SS1.p1.4.m1.1a"><mrow id="S3.SS1.p1.4.m1.1.1" xref="S3.SS1.p1.4.m1.1.1.cmml"><msub id="S3.SS1.p1.4.m1.1.1.2" xref="S3.SS1.p1.4.m1.1.1.2.cmml"><mi id="S3.SS1.p1.4.m1.1.1.2.2" xref="S3.SS1.p1.4.m1.1.1.2.2.cmml">W</mi><mi id="S3.SS1.p1.4.m1.1.1.2.3" xref="S3.SS1.p1.4.m1.1.1.2.3.cmml">A</mi></msub><mo id="S3.SS1.p1.4.m1.1.1.1" xref="S3.SS1.p1.4.m1.1.1.1.cmml">∈</mo><msup id="S3.SS1.p1.4.m1.1.1.3" xref="S3.SS1.p1.4.m1.1.1.3.cmml"><mi id="S3.SS1.p1.4.m1.1.1.3.2" xref="S3.SS1.p1.4.m1.1.1.3.2.cmml">ℝ</mi><mrow id="S3.SS1.p1.4.m1.1.1.3.3" xref="S3.SS1.p1.4.m1.1.1.3.3.cmml"><mi id="S3.SS1.p1.4.m1.1.1.3.3.2" xref="S3.SS1.p1.4.m1.1.1.3.3.2.cmml">M</mi><mo lspace="0.222em" rspace="0.222em" id="S3.SS1.p1.4.m1.1.1.3.3.1" xref="S3.SS1.p1.4.m1.1.1.3.3.1.cmml">×</mo><mi id="S3.SS1.p1.4.m1.1.1.3.3.3" xref="S3.SS1.p1.4.m1.1.1.3.3.3.cmml">N</mi></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.4.m1.1b"><apply id="S3.SS1.p1.4.m1.1.1.cmml" xref="S3.SS1.p1.4.m1.1.1"><in id="S3.SS1.p1.4.m1.1.1.1.cmml" xref="S3.SS1.p1.4.m1.1.1.1"></in><apply id="S3.SS1.p1.4.m1.1.1.2.cmml" xref="S3.SS1.p1.4.m1.1.1.2"><csymbol cd="ambiguous" id="S3.SS1.p1.4.m1.1.1.2.1.cmml" xref="S3.SS1.p1.4.m1.1.1.2">subscript</csymbol><ci id="S3.SS1.p1.4.m1.1.1.2.2.cmml" xref="S3.SS1.p1.4.m1.1.1.2.2">𝑊</ci><ci id="S3.SS1.p1.4.m1.1.1.2.3.cmml" xref="S3.SS1.p1.4.m1.1.1.2.3">𝐴</ci></apply><apply id="S3.SS1.p1.4.m1.1.1.3.cmml" xref="S3.SS1.p1.4.m1.1.1.3"><csymbol cd="ambiguous" id="S3.SS1.p1.4.m1.1.1.3.1.cmml" xref="S3.SS1.p1.4.m1.1.1.3">superscript</csymbol><ci id="S3.SS1.p1.4.m1.1.1.3.2.cmml" xref="S3.SS1.p1.4.m1.1.1.3.2">ℝ</ci><apply id="S3.SS1.p1.4.m1.1.1.3.3.cmml" xref="S3.SS1.p1.4.m1.1.1.3.3"><times id="S3.SS1.p1.4.m1.1.1.3.3.1.cmml" xref="S3.SS1.p1.4.m1.1.1.3.3.1"></times><ci id="S3.SS1.p1.4.m1.1.1.3.3.2.cmml" xref="S3.SS1.p1.4.m1.1.1.3.3.2">𝑀</ci><ci id="S3.SS1.p1.4.m1.1.1.3.3.3.cmml" xref="S3.SS1.p1.4.m1.1.1.3.3.3">𝑁</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.4.m1.1c">W_{A}\in\mathbb{R}^{M\times N}</annotation></semantics></math> contains the attention embedding weights of visual features <math id="S3.SS1.p1.5.m2.1" class="ltx_Math" alttext="S" display="inline"><semantics id="S3.SS1.p1.5.m2.1a"><mi id="S3.SS1.p1.5.m2.1.1" xref="S3.SS1.p1.5.m2.1.1.cmml">S</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.5.m2.1b"><ci id="S3.SS1.p1.5.m2.1.1.cmml" xref="S3.SS1.p1.5.m2.1.1">𝑆</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.5.m2.1c">S</annotation></semantics></math>, and <math id="S3.SS1.p1.6.m3.1" class="ltx_Math" alttext="b_{A}\in\mathbb{R}^{L\times N}" display="inline"><semantics id="S3.SS1.p1.6.m3.1a"><mrow id="S3.SS1.p1.6.m3.1.1" xref="S3.SS1.p1.6.m3.1.1.cmml"><msub id="S3.SS1.p1.6.m3.1.1.2" xref="S3.SS1.p1.6.m3.1.1.2.cmml"><mi id="S3.SS1.p1.6.m3.1.1.2.2" xref="S3.SS1.p1.6.m3.1.1.2.2.cmml">b</mi><mi id="S3.SS1.p1.6.m3.1.1.2.3" xref="S3.SS1.p1.6.m3.1.1.2.3.cmml">A</mi></msub><mo id="S3.SS1.p1.6.m3.1.1.1" xref="S3.SS1.p1.6.m3.1.1.1.cmml">∈</mo><msup id="S3.SS1.p1.6.m3.1.1.3" xref="S3.SS1.p1.6.m3.1.1.3.cmml"><mi id="S3.SS1.p1.6.m3.1.1.3.2" xref="S3.SS1.p1.6.m3.1.1.3.2.cmml">ℝ</mi><mrow id="S3.SS1.p1.6.m3.1.1.3.3" xref="S3.SS1.p1.6.m3.1.1.3.3.cmml"><mi id="S3.SS1.p1.6.m3.1.1.3.3.2" xref="S3.SS1.p1.6.m3.1.1.3.3.2.cmml">L</mi><mo lspace="0.222em" rspace="0.222em" id="S3.SS1.p1.6.m3.1.1.3.3.1" xref="S3.SS1.p1.6.m3.1.1.3.3.1.cmml">×</mo><mi id="S3.SS1.p1.6.m3.1.1.3.3.3" xref="S3.SS1.p1.6.m3.1.1.3.3.3.cmml">N</mi></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.6.m3.1b"><apply id="S3.SS1.p1.6.m3.1.1.cmml" xref="S3.SS1.p1.6.m3.1.1"><in id="S3.SS1.p1.6.m3.1.1.1.cmml" xref="S3.SS1.p1.6.m3.1.1.1"></in><apply id="S3.SS1.p1.6.m3.1.1.2.cmml" xref="S3.SS1.p1.6.m3.1.1.2"><csymbol cd="ambiguous" id="S3.SS1.p1.6.m3.1.1.2.1.cmml" xref="S3.SS1.p1.6.m3.1.1.2">subscript</csymbol><ci id="S3.SS1.p1.6.m3.1.1.2.2.cmml" xref="S3.SS1.p1.6.m3.1.1.2.2">𝑏</ci><ci id="S3.SS1.p1.6.m3.1.1.2.3.cmml" xref="S3.SS1.p1.6.m3.1.1.2.3">𝐴</ci></apply><apply id="S3.SS1.p1.6.m3.1.1.3.cmml" xref="S3.SS1.p1.6.m3.1.1.3"><csymbol cd="ambiguous" id="S3.SS1.p1.6.m3.1.1.3.1.cmml" xref="S3.SS1.p1.6.m3.1.1.3">superscript</csymbol><ci id="S3.SS1.p1.6.m3.1.1.3.2.cmml" xref="S3.SS1.p1.6.m3.1.1.3.2">ℝ</ci><apply id="S3.SS1.p1.6.m3.1.1.3.3.cmml" xref="S3.SS1.p1.6.m3.1.1.3.3"><times id="S3.SS1.p1.6.m3.1.1.3.3.1.cmml" xref="S3.SS1.p1.6.m3.1.1.3.3.1"></times><ci id="S3.SS1.p1.6.m3.1.1.3.3.2.cmml" xref="S3.SS1.p1.6.m3.1.1.3.3.2">𝐿</ci><ci id="S3.SS1.p1.6.m3.1.1.3.3.3.cmml" xref="S3.SS1.p1.6.m3.1.1.3.3.3">𝑁</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.6.m3.1c">b_{A}\in\mathbb{R}^{L\times N}</annotation></semantics></math> is the bias term.
This correlation matrix is the dot product result of each word embedding and each spatial location’s visual feature, thus each value in correlation matrix <math id="S3.SS1.p1.7.m4.1" class="ltx_Math" alttext="C" display="inline"><semantics id="S3.SS1.p1.7.m4.1a"><mi id="S3.SS1.p1.7.m4.1.1" xref="S3.SS1.p1.7.m4.1.1.cmml">C</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.7.m4.1b"><ci id="S3.SS1.p1.7.m4.1.1.cmml" xref="S3.SS1.p1.7.m4.1.1">𝐶</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.7.m4.1c">C</annotation></semantics></math> measures the similarity between each word and each location’s visual feature.</p>
</div>
<div id="S3.SS1.p2" class="ltx_para">
<p id="S3.SS1.p2.3" class="ltx_p">The spatial attention weights <math id="S3.SS1.p2.1.m1.1" class="ltx_Math" alttext="W_{att}" display="inline"><semantics id="S3.SS1.p2.1.m1.1a"><msub id="S3.SS1.p2.1.m1.1.1" xref="S3.SS1.p2.1.m1.1.1.cmml"><mi id="S3.SS1.p2.1.m1.1.1.2" xref="S3.SS1.p2.1.m1.1.1.2.cmml">W</mi><mrow id="S3.SS1.p2.1.m1.1.1.3" xref="S3.SS1.p2.1.m1.1.1.3.cmml"><mi id="S3.SS1.p2.1.m1.1.1.3.2" xref="S3.SS1.p2.1.m1.1.1.3.2.cmml">a</mi><mo lspace="0em" rspace="0em" id="S3.SS1.p2.1.m1.1.1.3.1" xref="S3.SS1.p2.1.m1.1.1.3.1.cmml">​</mo><mi id="S3.SS1.p2.1.m1.1.1.3.3" xref="S3.SS1.p2.1.m1.1.1.3.3.cmml">t</mi><mo lspace="0em" rspace="0em" id="S3.SS1.p2.1.m1.1.1.3.1a" xref="S3.SS1.p2.1.m1.1.1.3.1.cmml">​</mo><mi id="S3.SS1.p2.1.m1.1.1.3.4" xref="S3.SS1.p2.1.m1.1.1.3.4.cmml">t</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.p2.1.m1.1b"><apply id="S3.SS1.p2.1.m1.1.1.cmml" xref="S3.SS1.p2.1.m1.1.1"><csymbol cd="ambiguous" id="S3.SS1.p2.1.m1.1.1.1.cmml" xref="S3.SS1.p2.1.m1.1.1">subscript</csymbol><ci id="S3.SS1.p2.1.m1.1.1.2.cmml" xref="S3.SS1.p2.1.m1.1.1.2">𝑊</ci><apply id="S3.SS1.p2.1.m1.1.1.3.cmml" xref="S3.SS1.p2.1.m1.1.1.3"><times id="S3.SS1.p2.1.m1.1.1.3.1.cmml" xref="S3.SS1.p2.1.m1.1.1.3.1"></times><ci id="S3.SS1.p2.1.m1.1.1.3.2.cmml" xref="S3.SS1.p2.1.m1.1.1.3.2">𝑎</ci><ci id="S3.SS1.p2.1.m1.1.1.3.3.cmml" xref="S3.SS1.p2.1.m1.1.1.3.3">𝑡</ci><ci id="S3.SS1.p2.1.m1.1.1.3.4.cmml" xref="S3.SS1.p2.1.m1.1.1.3.4">𝑡</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p2.1.m1.1c">W_{att}</annotation></semantics></math> are calculated by taking maximum over the word dimension <math id="S3.SS1.p2.2.m2.1" class="ltx_Math" alttext="T" display="inline"><semantics id="S3.SS1.p2.2.m2.1a"><mi id="S3.SS1.p2.2.m2.1.1" xref="S3.SS1.p2.2.m2.1.1.cmml">T</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p2.2.m2.1b"><ci id="S3.SS1.p2.2.m2.1.1.cmml" xref="S3.SS1.p2.2.m2.1.1">𝑇</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p2.2.m2.1c">T</annotation></semantics></math> for the correlation matrix <math id="S3.SS1.p2.3.m3.1" class="ltx_Math" alttext="C" display="inline"><semantics id="S3.SS1.p2.3.m3.1a"><mi id="S3.SS1.p2.3.m3.1.1" xref="S3.SS1.p2.3.m3.1.1.cmml">C</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p2.3.m3.1b"><ci id="S3.SS1.p2.3.m3.1.1.cmml" xref="S3.SS1.p2.3.m3.1.1">𝐶</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p2.3.m3.1c">C</annotation></semantics></math>, selecting the highest correlation value for each spatial location, and then applying the softmax function</p>
<table id="S3.E2" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S3.E2.m1.6" class="ltx_Math" alttext="W_{att}=\operatorname{softmax}(\max_{i=1,\cdots,T}(C_{i})),~{}C_{i}\in\mathbb{R}^{L}" display="block"><semantics id="S3.E2.m1.6a"><mrow id="S3.E2.m1.6.6.2" xref="S3.E2.m1.6.6.3.cmml"><mrow id="S3.E2.m1.5.5.1.1" xref="S3.E2.m1.5.5.1.1.cmml"><msub id="S3.E2.m1.5.5.1.1.3" xref="S3.E2.m1.5.5.1.1.3.cmml"><mi id="S3.E2.m1.5.5.1.1.3.2" xref="S3.E2.m1.5.5.1.1.3.2.cmml">W</mi><mrow id="S3.E2.m1.5.5.1.1.3.3" xref="S3.E2.m1.5.5.1.1.3.3.cmml"><mi id="S3.E2.m1.5.5.1.1.3.3.2" xref="S3.E2.m1.5.5.1.1.3.3.2.cmml">a</mi><mo lspace="0em" rspace="0em" id="S3.E2.m1.5.5.1.1.3.3.1" xref="S3.E2.m1.5.5.1.1.3.3.1.cmml">​</mo><mi id="S3.E2.m1.5.5.1.1.3.3.3" xref="S3.E2.m1.5.5.1.1.3.3.3.cmml">t</mi><mo lspace="0em" rspace="0em" id="S3.E2.m1.5.5.1.1.3.3.1a" xref="S3.E2.m1.5.5.1.1.3.3.1.cmml">​</mo><mi id="S3.E2.m1.5.5.1.1.3.3.4" xref="S3.E2.m1.5.5.1.1.3.3.4.cmml">t</mi></mrow></msub><mo id="S3.E2.m1.5.5.1.1.2" xref="S3.E2.m1.5.5.1.1.2.cmml">=</mo><mrow id="S3.E2.m1.5.5.1.1.1.1" xref="S3.E2.m1.5.5.1.1.1.2.cmml"><mi id="S3.E2.m1.4.4" xref="S3.E2.m1.4.4.cmml">softmax</mi><mo id="S3.E2.m1.5.5.1.1.1.1a" xref="S3.E2.m1.5.5.1.1.1.2.cmml">⁡</mo><mrow id="S3.E2.m1.5.5.1.1.1.1.1" xref="S3.E2.m1.5.5.1.1.1.2.cmml"><mo stretchy="false" id="S3.E2.m1.5.5.1.1.1.1.1.2" xref="S3.E2.m1.5.5.1.1.1.2.cmml">(</mo><mrow id="S3.E2.m1.5.5.1.1.1.1.1.1.2" xref="S3.E2.m1.5.5.1.1.1.1.1.1.3.cmml"><munder id="S3.E2.m1.5.5.1.1.1.1.1.1.1.1" xref="S3.E2.m1.5.5.1.1.1.1.1.1.1.1.cmml"><mi id="S3.E2.m1.5.5.1.1.1.1.1.1.1.1.2" xref="S3.E2.m1.5.5.1.1.1.1.1.1.1.1.2.cmml">max</mi><mrow id="S3.E2.m1.3.3.3" xref="S3.E2.m1.3.3.3.cmml"><mi id="S3.E2.m1.3.3.3.5" xref="S3.E2.m1.3.3.3.5.cmml">i</mi><mo id="S3.E2.m1.3.3.3.4" xref="S3.E2.m1.3.3.3.4.cmml">=</mo><mrow id="S3.E2.m1.3.3.3.6.2" xref="S3.E2.m1.3.3.3.6.1.cmml"><mn id="S3.E2.m1.1.1.1.1" xref="S3.E2.m1.1.1.1.1.cmml">1</mn><mo id="S3.E2.m1.3.3.3.6.2.1" xref="S3.E2.m1.3.3.3.6.1.cmml">,</mo><mi mathvariant="normal" id="S3.E2.m1.2.2.2.2" xref="S3.E2.m1.2.2.2.2.cmml">⋯</mi><mo id="S3.E2.m1.3.3.3.6.2.2" xref="S3.E2.m1.3.3.3.6.1.cmml">,</mo><mi id="S3.E2.m1.3.3.3.3" xref="S3.E2.m1.3.3.3.3.cmml">T</mi></mrow></mrow></munder><mo id="S3.E2.m1.5.5.1.1.1.1.1.1.2a" xref="S3.E2.m1.5.5.1.1.1.1.1.1.3.cmml">⁡</mo><mrow id="S3.E2.m1.5.5.1.1.1.1.1.1.2.2" xref="S3.E2.m1.5.5.1.1.1.1.1.1.3.cmml"><mo stretchy="false" id="S3.E2.m1.5.5.1.1.1.1.1.1.2.2.2" xref="S3.E2.m1.5.5.1.1.1.1.1.1.3.cmml">(</mo><msub id="S3.E2.m1.5.5.1.1.1.1.1.1.2.2.1" xref="S3.E2.m1.5.5.1.1.1.1.1.1.2.2.1.cmml"><mi id="S3.E2.m1.5.5.1.1.1.1.1.1.2.2.1.2" xref="S3.E2.m1.5.5.1.1.1.1.1.1.2.2.1.2.cmml">C</mi><mi id="S3.E2.m1.5.5.1.1.1.1.1.1.2.2.1.3" xref="S3.E2.m1.5.5.1.1.1.1.1.1.2.2.1.3.cmml">i</mi></msub><mo stretchy="false" id="S3.E2.m1.5.5.1.1.1.1.1.1.2.2.3" xref="S3.E2.m1.5.5.1.1.1.1.1.1.3.cmml">)</mo></mrow></mrow><mo stretchy="false" id="S3.E2.m1.5.5.1.1.1.1.1.3" xref="S3.E2.m1.5.5.1.1.1.2.cmml">)</mo></mrow></mrow></mrow><mo rspace="0.497em" id="S3.E2.m1.6.6.2.3" xref="S3.E2.m1.6.6.3a.cmml">,</mo><mrow id="S3.E2.m1.6.6.2.2" xref="S3.E2.m1.6.6.2.2.cmml"><msub id="S3.E2.m1.6.6.2.2.2" xref="S3.E2.m1.6.6.2.2.2.cmml"><mi id="S3.E2.m1.6.6.2.2.2.2" xref="S3.E2.m1.6.6.2.2.2.2.cmml">C</mi><mi id="S3.E2.m1.6.6.2.2.2.3" xref="S3.E2.m1.6.6.2.2.2.3.cmml">i</mi></msub><mo id="S3.E2.m1.6.6.2.2.1" xref="S3.E2.m1.6.6.2.2.1.cmml">∈</mo><msup id="S3.E2.m1.6.6.2.2.3" xref="S3.E2.m1.6.6.2.2.3.cmml"><mi id="S3.E2.m1.6.6.2.2.3.2" xref="S3.E2.m1.6.6.2.2.3.2.cmml">ℝ</mi><mi id="S3.E2.m1.6.6.2.2.3.3" xref="S3.E2.m1.6.6.2.2.3.3.cmml">L</mi></msup></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.E2.m1.6b"><apply id="S3.E2.m1.6.6.3.cmml" xref="S3.E2.m1.6.6.2"><csymbol cd="ambiguous" id="S3.E2.m1.6.6.3a.cmml" xref="S3.E2.m1.6.6.2.3">formulae-sequence</csymbol><apply id="S3.E2.m1.5.5.1.1.cmml" xref="S3.E2.m1.5.5.1.1"><eq id="S3.E2.m1.5.5.1.1.2.cmml" xref="S3.E2.m1.5.5.1.1.2"></eq><apply id="S3.E2.m1.5.5.1.1.3.cmml" xref="S3.E2.m1.5.5.1.1.3"><csymbol cd="ambiguous" id="S3.E2.m1.5.5.1.1.3.1.cmml" xref="S3.E2.m1.5.5.1.1.3">subscript</csymbol><ci id="S3.E2.m1.5.5.1.1.3.2.cmml" xref="S3.E2.m1.5.5.1.1.3.2">𝑊</ci><apply id="S3.E2.m1.5.5.1.1.3.3.cmml" xref="S3.E2.m1.5.5.1.1.3.3"><times id="S3.E2.m1.5.5.1.1.3.3.1.cmml" xref="S3.E2.m1.5.5.1.1.3.3.1"></times><ci id="S3.E2.m1.5.5.1.1.3.3.2.cmml" xref="S3.E2.m1.5.5.1.1.3.3.2">𝑎</ci><ci id="S3.E2.m1.5.5.1.1.3.3.3.cmml" xref="S3.E2.m1.5.5.1.1.3.3.3">𝑡</ci><ci id="S3.E2.m1.5.5.1.1.3.3.4.cmml" xref="S3.E2.m1.5.5.1.1.3.3.4">𝑡</ci></apply></apply><apply id="S3.E2.m1.5.5.1.1.1.2.cmml" xref="S3.E2.m1.5.5.1.1.1.1"><ci id="S3.E2.m1.4.4.cmml" xref="S3.E2.m1.4.4">softmax</ci><apply id="S3.E2.m1.5.5.1.1.1.1.1.1.3.cmml" xref="S3.E2.m1.5.5.1.1.1.1.1.1.2"><apply id="S3.E2.m1.5.5.1.1.1.1.1.1.1.1.cmml" xref="S3.E2.m1.5.5.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E2.m1.5.5.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E2.m1.5.5.1.1.1.1.1.1.1.1">subscript</csymbol><max id="S3.E2.m1.5.5.1.1.1.1.1.1.1.1.2.cmml" xref="S3.E2.m1.5.5.1.1.1.1.1.1.1.1.2"></max><apply id="S3.E2.m1.3.3.3.cmml" xref="S3.E2.m1.3.3.3"><eq id="S3.E2.m1.3.3.3.4.cmml" xref="S3.E2.m1.3.3.3.4"></eq><ci id="S3.E2.m1.3.3.3.5.cmml" xref="S3.E2.m1.3.3.3.5">𝑖</ci><list id="S3.E2.m1.3.3.3.6.1.cmml" xref="S3.E2.m1.3.3.3.6.2"><cn type="integer" id="S3.E2.m1.1.1.1.1.cmml" xref="S3.E2.m1.1.1.1.1">1</cn><ci id="S3.E2.m1.2.2.2.2.cmml" xref="S3.E2.m1.2.2.2.2">⋯</ci><ci id="S3.E2.m1.3.3.3.3.cmml" xref="S3.E2.m1.3.3.3.3">𝑇</ci></list></apply></apply><apply id="S3.E2.m1.5.5.1.1.1.1.1.1.2.2.1.cmml" xref="S3.E2.m1.5.5.1.1.1.1.1.1.2.2.1"><csymbol cd="ambiguous" id="S3.E2.m1.5.5.1.1.1.1.1.1.2.2.1.1.cmml" xref="S3.E2.m1.5.5.1.1.1.1.1.1.2.2.1">subscript</csymbol><ci id="S3.E2.m1.5.5.1.1.1.1.1.1.2.2.1.2.cmml" xref="S3.E2.m1.5.5.1.1.1.1.1.1.2.2.1.2">𝐶</ci><ci id="S3.E2.m1.5.5.1.1.1.1.1.1.2.2.1.3.cmml" xref="S3.E2.m1.5.5.1.1.1.1.1.1.2.2.1.3">𝑖</ci></apply></apply></apply></apply><apply id="S3.E2.m1.6.6.2.2.cmml" xref="S3.E2.m1.6.6.2.2"><in id="S3.E2.m1.6.6.2.2.1.cmml" xref="S3.E2.m1.6.6.2.2.1"></in><apply id="S3.E2.m1.6.6.2.2.2.cmml" xref="S3.E2.m1.6.6.2.2.2"><csymbol cd="ambiguous" id="S3.E2.m1.6.6.2.2.2.1.cmml" xref="S3.E2.m1.6.6.2.2.2">subscript</csymbol><ci id="S3.E2.m1.6.6.2.2.2.2.cmml" xref="S3.E2.m1.6.6.2.2.2.2">𝐶</ci><ci id="S3.E2.m1.6.6.2.2.2.3.cmml" xref="S3.E2.m1.6.6.2.2.2.3">𝑖</ci></apply><apply id="S3.E2.m1.6.6.2.2.3.cmml" xref="S3.E2.m1.6.6.2.2.3"><csymbol cd="ambiguous" id="S3.E2.m1.6.6.2.2.3.1.cmml" xref="S3.E2.m1.6.6.2.2.3">superscript</csymbol><ci id="S3.E2.m1.6.6.2.2.3.2.cmml" xref="S3.E2.m1.6.6.2.2.3.2">ℝ</ci><ci id="S3.E2.m1.6.6.2.2.3.3.cmml" xref="S3.E2.m1.6.6.2.2.3.3">𝐿</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E2.m1.6c">W_{att}=\operatorname{softmax}(\max_{i=1,\cdots,T}(C_{i})),~{}C_{i}\in\mathbb{R}^{L}</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(2)</span></td>
</tr></tbody>
</table>
<p id="S3.SS1.p2.5" class="ltx_p">The resulting attention weights <math id="S3.SS1.p2.4.m1.1" class="ltx_Math" alttext="W_{att}\in\mathbb{R}^{L}" display="inline"><semantics id="S3.SS1.p2.4.m1.1a"><mrow id="S3.SS1.p2.4.m1.1.1" xref="S3.SS1.p2.4.m1.1.1.cmml"><msub id="S3.SS1.p2.4.m1.1.1.2" xref="S3.SS1.p2.4.m1.1.1.2.cmml"><mi id="S3.SS1.p2.4.m1.1.1.2.2" xref="S3.SS1.p2.4.m1.1.1.2.2.cmml">W</mi><mrow id="S3.SS1.p2.4.m1.1.1.2.3" xref="S3.SS1.p2.4.m1.1.1.2.3.cmml"><mi id="S3.SS1.p2.4.m1.1.1.2.3.2" xref="S3.SS1.p2.4.m1.1.1.2.3.2.cmml">a</mi><mo lspace="0em" rspace="0em" id="S3.SS1.p2.4.m1.1.1.2.3.1" xref="S3.SS1.p2.4.m1.1.1.2.3.1.cmml">​</mo><mi id="S3.SS1.p2.4.m1.1.1.2.3.3" xref="S3.SS1.p2.4.m1.1.1.2.3.3.cmml">t</mi><mo lspace="0em" rspace="0em" id="S3.SS1.p2.4.m1.1.1.2.3.1a" xref="S3.SS1.p2.4.m1.1.1.2.3.1.cmml">​</mo><mi id="S3.SS1.p2.4.m1.1.1.2.3.4" xref="S3.SS1.p2.4.m1.1.1.2.3.4.cmml">t</mi></mrow></msub><mo id="S3.SS1.p2.4.m1.1.1.1" xref="S3.SS1.p2.4.m1.1.1.1.cmml">∈</mo><msup id="S3.SS1.p2.4.m1.1.1.3" xref="S3.SS1.p2.4.m1.1.1.3.cmml"><mi id="S3.SS1.p2.4.m1.1.1.3.2" xref="S3.SS1.p2.4.m1.1.1.3.2.cmml">ℝ</mi><mi id="S3.SS1.p2.4.m1.1.1.3.3" xref="S3.SS1.p2.4.m1.1.1.3.3.cmml">L</mi></msup></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p2.4.m1.1b"><apply id="S3.SS1.p2.4.m1.1.1.cmml" xref="S3.SS1.p2.4.m1.1.1"><in id="S3.SS1.p2.4.m1.1.1.1.cmml" xref="S3.SS1.p2.4.m1.1.1.1"></in><apply id="S3.SS1.p2.4.m1.1.1.2.cmml" xref="S3.SS1.p2.4.m1.1.1.2"><csymbol cd="ambiguous" id="S3.SS1.p2.4.m1.1.1.2.1.cmml" xref="S3.SS1.p2.4.m1.1.1.2">subscript</csymbol><ci id="S3.SS1.p2.4.m1.1.1.2.2.cmml" xref="S3.SS1.p2.4.m1.1.1.2.2">𝑊</ci><apply id="S3.SS1.p2.4.m1.1.1.2.3.cmml" xref="S3.SS1.p2.4.m1.1.1.2.3"><times id="S3.SS1.p2.4.m1.1.1.2.3.1.cmml" xref="S3.SS1.p2.4.m1.1.1.2.3.1"></times><ci id="S3.SS1.p2.4.m1.1.1.2.3.2.cmml" xref="S3.SS1.p2.4.m1.1.1.2.3.2">𝑎</ci><ci id="S3.SS1.p2.4.m1.1.1.2.3.3.cmml" xref="S3.SS1.p2.4.m1.1.1.2.3.3">𝑡</ci><ci id="S3.SS1.p2.4.m1.1.1.2.3.4.cmml" xref="S3.SS1.p2.4.m1.1.1.2.3.4">𝑡</ci></apply></apply><apply id="S3.SS1.p2.4.m1.1.1.3.cmml" xref="S3.SS1.p2.4.m1.1.1.3"><csymbol cd="ambiguous" id="S3.SS1.p2.4.m1.1.1.3.1.cmml" xref="S3.SS1.p2.4.m1.1.1.3">superscript</csymbol><ci id="S3.SS1.p2.4.m1.1.1.3.2.cmml" xref="S3.SS1.p2.4.m1.1.1.3.2">ℝ</ci><ci id="S3.SS1.p2.4.m1.1.1.3.3.cmml" xref="S3.SS1.p2.4.m1.1.1.3.3">𝐿</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p2.4.m1.1c">W_{att}\in\mathbb{R}^{L}</annotation></semantics></math> are high for selected locations and low for other locations, with the sum of weights equal to <math id="S3.SS1.p2.5.m2.1" class="ltx_Math" alttext="1" display="inline"><semantics id="S3.SS1.p2.5.m2.1a"><mn id="S3.SS1.p2.5.m2.1.1" xref="S3.SS1.p2.5.m2.1.1.cmml">1</mn><annotation-xml encoding="MathML-Content" id="S3.SS1.p2.5.m2.1b"><cn type="integer" id="S3.SS1.p2.5.m2.1.1.cmml" xref="S3.SS1.p2.5.m2.1.1">1</cn></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p2.5.m2.1c">1</annotation></semantics></math>. For instance, in the example shown in Fig. <a href="#S3.F2" title="Figure 2 ‣ 3 Spatial Memory Network for VQA ‣ Ask, Attend and Answer: Exploring Question-Guided Spatial Attention for Visual Question Answering" class="ltx_ref"><span class="ltx_text ltx_ref_tag">2</span></a>, the question “Is there a cat in the basket?” produces high attention weights for the location of the basket because of the high correlation of the word vector for <span id="S3.SS1.p2.5.1" class="ltx_text ltx_font_italic">basket</span> with the visual features at that location.</p>
</div>
<div id="S3.SS1.p3" class="ltx_para">
<p id="S3.SS1.p3.4" class="ltx_p">The evidence embedding <math id="S3.SS1.p3.1.m1.1" class="ltx_Math" alttext="W_{E}" display="inline"><semantics id="S3.SS1.p3.1.m1.1a"><msub id="S3.SS1.p3.1.m1.1.1" xref="S3.SS1.p3.1.m1.1.1.cmml"><mi id="S3.SS1.p3.1.m1.1.1.2" xref="S3.SS1.p3.1.m1.1.1.2.cmml">W</mi><mi id="S3.SS1.p3.1.m1.1.1.3" xref="S3.SS1.p3.1.m1.1.1.3.cmml">E</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.p3.1.m1.1b"><apply id="S3.SS1.p3.1.m1.1.1.cmml" xref="S3.SS1.p3.1.m1.1.1"><csymbol cd="ambiguous" id="S3.SS1.p3.1.m1.1.1.1.cmml" xref="S3.SS1.p3.1.m1.1.1">subscript</csymbol><ci id="S3.SS1.p3.1.m1.1.1.2.cmml" xref="S3.SS1.p3.1.m1.1.1.2">𝑊</ci><ci id="S3.SS1.p3.1.m1.1.1.3.cmml" xref="S3.SS1.p3.1.m1.1.1.3">𝐸</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p3.1.m1.1c">W_{E}</annotation></semantics></math> projects visual features <math id="S3.SS1.p3.2.m2.1" class="ltx_Math" alttext="S" display="inline"><semantics id="S3.SS1.p3.2.m2.1a"><mi id="S3.SS1.p3.2.m2.1.1" xref="S3.SS1.p3.2.m2.1.1.cmml">S</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p3.2.m2.1b"><ci id="S3.SS1.p3.2.m2.1.1.cmml" xref="S3.SS1.p3.2.m2.1.1">𝑆</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p3.2.m2.1c">S</annotation></semantics></math> to produce high activations for certain semantic concepts. E.g., in Fig. <a href="#S3.F2" title="Figure 2 ‣ 3 Spatial Memory Network for VQA ‣ Ask, Attend and Answer: Exploring Question-Guided Spatial Attention for Visual Question Answering" class="ltx_ref"><span class="ltx_text ltx_ref_tag">2</span></a>, it has high activations in the region containing the cat. The results of this evidence embedding are then multiplied by the generated attention weights <math id="S3.SS1.p3.3.m3.1" class="ltx_Math" alttext="W_{att}" display="inline"><semantics id="S3.SS1.p3.3.m3.1a"><msub id="S3.SS1.p3.3.m3.1.1" xref="S3.SS1.p3.3.m3.1.1.cmml"><mi id="S3.SS1.p3.3.m3.1.1.2" xref="S3.SS1.p3.3.m3.1.1.2.cmml">W</mi><mrow id="S3.SS1.p3.3.m3.1.1.3" xref="S3.SS1.p3.3.m3.1.1.3.cmml"><mi id="S3.SS1.p3.3.m3.1.1.3.2" xref="S3.SS1.p3.3.m3.1.1.3.2.cmml">a</mi><mo lspace="0em" rspace="0em" id="S3.SS1.p3.3.m3.1.1.3.1" xref="S3.SS1.p3.3.m3.1.1.3.1.cmml">​</mo><mi id="S3.SS1.p3.3.m3.1.1.3.3" xref="S3.SS1.p3.3.m3.1.1.3.3.cmml">t</mi><mo lspace="0em" rspace="0em" id="S3.SS1.p3.3.m3.1.1.3.1a" xref="S3.SS1.p3.3.m3.1.1.3.1.cmml">​</mo><mi id="S3.SS1.p3.3.m3.1.1.3.4" xref="S3.SS1.p3.3.m3.1.1.3.4.cmml">t</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.p3.3.m3.1b"><apply id="S3.SS1.p3.3.m3.1.1.cmml" xref="S3.SS1.p3.3.m3.1.1"><csymbol cd="ambiguous" id="S3.SS1.p3.3.m3.1.1.1.cmml" xref="S3.SS1.p3.3.m3.1.1">subscript</csymbol><ci id="S3.SS1.p3.3.m3.1.1.2.cmml" xref="S3.SS1.p3.3.m3.1.1.2">𝑊</ci><apply id="S3.SS1.p3.3.m3.1.1.3.cmml" xref="S3.SS1.p3.3.m3.1.1.3"><times id="S3.SS1.p3.3.m3.1.1.3.1.cmml" xref="S3.SS1.p3.3.m3.1.1.3.1"></times><ci id="S3.SS1.p3.3.m3.1.1.3.2.cmml" xref="S3.SS1.p3.3.m3.1.1.3.2">𝑎</ci><ci id="S3.SS1.p3.3.m3.1.1.3.3.cmml" xref="S3.SS1.p3.3.m3.1.1.3.3">𝑡</ci><ci id="S3.SS1.p3.3.m3.1.1.3.4.cmml" xref="S3.SS1.p3.3.m3.1.1.3.4">𝑡</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p3.3.m3.1c">W_{att}</annotation></semantics></math>, and summed to produce the selected visual “evidence” vector <math id="S3.SS1.p3.4.m4.1" class="ltx_Math" alttext="S_{att}\in\mathbb{R}^{N}" display="inline"><semantics id="S3.SS1.p3.4.m4.1a"><mrow id="S3.SS1.p3.4.m4.1.1" xref="S3.SS1.p3.4.m4.1.1.cmml"><msub id="S3.SS1.p3.4.m4.1.1.2" xref="S3.SS1.p3.4.m4.1.1.2.cmml"><mi id="S3.SS1.p3.4.m4.1.1.2.2" xref="S3.SS1.p3.4.m4.1.1.2.2.cmml">S</mi><mrow id="S3.SS1.p3.4.m4.1.1.2.3" xref="S3.SS1.p3.4.m4.1.1.2.3.cmml"><mi id="S3.SS1.p3.4.m4.1.1.2.3.2" xref="S3.SS1.p3.4.m4.1.1.2.3.2.cmml">a</mi><mo lspace="0em" rspace="0em" id="S3.SS1.p3.4.m4.1.1.2.3.1" xref="S3.SS1.p3.4.m4.1.1.2.3.1.cmml">​</mo><mi id="S3.SS1.p3.4.m4.1.1.2.3.3" xref="S3.SS1.p3.4.m4.1.1.2.3.3.cmml">t</mi><mo lspace="0em" rspace="0em" id="S3.SS1.p3.4.m4.1.1.2.3.1a" xref="S3.SS1.p3.4.m4.1.1.2.3.1.cmml">​</mo><mi id="S3.SS1.p3.4.m4.1.1.2.3.4" xref="S3.SS1.p3.4.m4.1.1.2.3.4.cmml">t</mi></mrow></msub><mo id="S3.SS1.p3.4.m4.1.1.1" xref="S3.SS1.p3.4.m4.1.1.1.cmml">∈</mo><msup id="S3.SS1.p3.4.m4.1.1.3" xref="S3.SS1.p3.4.m4.1.1.3.cmml"><mi id="S3.SS1.p3.4.m4.1.1.3.2" xref="S3.SS1.p3.4.m4.1.1.3.2.cmml">ℝ</mi><mi id="S3.SS1.p3.4.m4.1.1.3.3" xref="S3.SS1.p3.4.m4.1.1.3.3.cmml">N</mi></msup></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p3.4.m4.1b"><apply id="S3.SS1.p3.4.m4.1.1.cmml" xref="S3.SS1.p3.4.m4.1.1"><in id="S3.SS1.p3.4.m4.1.1.1.cmml" xref="S3.SS1.p3.4.m4.1.1.1"></in><apply id="S3.SS1.p3.4.m4.1.1.2.cmml" xref="S3.SS1.p3.4.m4.1.1.2"><csymbol cd="ambiguous" id="S3.SS1.p3.4.m4.1.1.2.1.cmml" xref="S3.SS1.p3.4.m4.1.1.2">subscript</csymbol><ci id="S3.SS1.p3.4.m4.1.1.2.2.cmml" xref="S3.SS1.p3.4.m4.1.1.2.2">𝑆</ci><apply id="S3.SS1.p3.4.m4.1.1.2.3.cmml" xref="S3.SS1.p3.4.m4.1.1.2.3"><times id="S3.SS1.p3.4.m4.1.1.2.3.1.cmml" xref="S3.SS1.p3.4.m4.1.1.2.3.1"></times><ci id="S3.SS1.p3.4.m4.1.1.2.3.2.cmml" xref="S3.SS1.p3.4.m4.1.1.2.3.2">𝑎</ci><ci id="S3.SS1.p3.4.m4.1.1.2.3.3.cmml" xref="S3.SS1.p3.4.m4.1.1.2.3.3">𝑡</ci><ci id="S3.SS1.p3.4.m4.1.1.2.3.4.cmml" xref="S3.SS1.p3.4.m4.1.1.2.3.4">𝑡</ci></apply></apply><apply id="S3.SS1.p3.4.m4.1.1.3.cmml" xref="S3.SS1.p3.4.m4.1.1.3"><csymbol cd="ambiguous" id="S3.SS1.p3.4.m4.1.1.3.1.cmml" xref="S3.SS1.p3.4.m4.1.1.3">superscript</csymbol><ci id="S3.SS1.p3.4.m4.1.1.3.2.cmml" xref="S3.SS1.p3.4.m4.1.1.3.2">ℝ</ci><ci id="S3.SS1.p3.4.m4.1.1.3.3.cmml" xref="S3.SS1.p3.4.m4.1.1.3.3">𝑁</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p3.4.m4.1c">S_{att}\in\mathbb{R}^{N}</annotation></semantics></math>,</p>
<table id="S3.E3" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S3.E3.m1.1" class="ltx_Math" alttext="S_{att}=W_{att}\cdot(S\cdot W_{E}+b_{E})" display="block"><semantics id="S3.E3.m1.1a"><mrow id="S3.E3.m1.1.1" xref="S3.E3.m1.1.1.cmml"><msub id="S3.E3.m1.1.1.3" xref="S3.E3.m1.1.1.3.cmml"><mi id="S3.E3.m1.1.1.3.2" xref="S3.E3.m1.1.1.3.2.cmml">S</mi><mrow id="S3.E3.m1.1.1.3.3" xref="S3.E3.m1.1.1.3.3.cmml"><mi id="S3.E3.m1.1.1.3.3.2" xref="S3.E3.m1.1.1.3.3.2.cmml">a</mi><mo lspace="0em" rspace="0em" id="S3.E3.m1.1.1.3.3.1" xref="S3.E3.m1.1.1.3.3.1.cmml">​</mo><mi id="S3.E3.m1.1.1.3.3.3" xref="S3.E3.m1.1.1.3.3.3.cmml">t</mi><mo lspace="0em" rspace="0em" id="S3.E3.m1.1.1.3.3.1a" xref="S3.E3.m1.1.1.3.3.1.cmml">​</mo><mi id="S3.E3.m1.1.1.3.3.4" xref="S3.E3.m1.1.1.3.3.4.cmml">t</mi></mrow></msub><mo id="S3.E3.m1.1.1.2" xref="S3.E3.m1.1.1.2.cmml">=</mo><mrow id="S3.E3.m1.1.1.1" xref="S3.E3.m1.1.1.1.cmml"><msub id="S3.E3.m1.1.1.1.3" xref="S3.E3.m1.1.1.1.3.cmml"><mi id="S3.E3.m1.1.1.1.3.2" xref="S3.E3.m1.1.1.1.3.2.cmml">W</mi><mrow id="S3.E3.m1.1.1.1.3.3" xref="S3.E3.m1.1.1.1.3.3.cmml"><mi id="S3.E3.m1.1.1.1.3.3.2" xref="S3.E3.m1.1.1.1.3.3.2.cmml">a</mi><mo lspace="0em" rspace="0em" id="S3.E3.m1.1.1.1.3.3.1" xref="S3.E3.m1.1.1.1.3.3.1.cmml">​</mo><mi id="S3.E3.m1.1.1.1.3.3.3" xref="S3.E3.m1.1.1.1.3.3.3.cmml">t</mi><mo lspace="0em" rspace="0em" id="S3.E3.m1.1.1.1.3.3.1a" xref="S3.E3.m1.1.1.1.3.3.1.cmml">​</mo><mi id="S3.E3.m1.1.1.1.3.3.4" xref="S3.E3.m1.1.1.1.3.3.4.cmml">t</mi></mrow></msub><mo lspace="0.222em" rspace="0.222em" id="S3.E3.m1.1.1.1.2" xref="S3.E3.m1.1.1.1.2.cmml">⋅</mo><mrow id="S3.E3.m1.1.1.1.1.1" xref="S3.E3.m1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S3.E3.m1.1.1.1.1.1.2" xref="S3.E3.m1.1.1.1.1.1.1.cmml">(</mo><mrow id="S3.E3.m1.1.1.1.1.1.1" xref="S3.E3.m1.1.1.1.1.1.1.cmml"><mrow id="S3.E3.m1.1.1.1.1.1.1.2" xref="S3.E3.m1.1.1.1.1.1.1.2.cmml"><mi id="S3.E3.m1.1.1.1.1.1.1.2.2" xref="S3.E3.m1.1.1.1.1.1.1.2.2.cmml">S</mi><mo lspace="0.222em" rspace="0.222em" id="S3.E3.m1.1.1.1.1.1.1.2.1" xref="S3.E3.m1.1.1.1.1.1.1.2.1.cmml">⋅</mo><msub id="S3.E3.m1.1.1.1.1.1.1.2.3" xref="S3.E3.m1.1.1.1.1.1.1.2.3.cmml"><mi id="S3.E3.m1.1.1.1.1.1.1.2.3.2" xref="S3.E3.m1.1.1.1.1.1.1.2.3.2.cmml">W</mi><mi id="S3.E3.m1.1.1.1.1.1.1.2.3.3" xref="S3.E3.m1.1.1.1.1.1.1.2.3.3.cmml">E</mi></msub></mrow><mo id="S3.E3.m1.1.1.1.1.1.1.1" xref="S3.E3.m1.1.1.1.1.1.1.1.cmml">+</mo><msub id="S3.E3.m1.1.1.1.1.1.1.3" xref="S3.E3.m1.1.1.1.1.1.1.3.cmml"><mi id="S3.E3.m1.1.1.1.1.1.1.3.2" xref="S3.E3.m1.1.1.1.1.1.1.3.2.cmml">b</mi><mi id="S3.E3.m1.1.1.1.1.1.1.3.3" xref="S3.E3.m1.1.1.1.1.1.1.3.3.cmml">E</mi></msub></mrow><mo stretchy="false" id="S3.E3.m1.1.1.1.1.1.3" xref="S3.E3.m1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.E3.m1.1b"><apply id="S3.E3.m1.1.1.cmml" xref="S3.E3.m1.1.1"><eq id="S3.E3.m1.1.1.2.cmml" xref="S3.E3.m1.1.1.2"></eq><apply id="S3.E3.m1.1.1.3.cmml" xref="S3.E3.m1.1.1.3"><csymbol cd="ambiguous" id="S3.E3.m1.1.1.3.1.cmml" xref="S3.E3.m1.1.1.3">subscript</csymbol><ci id="S3.E3.m1.1.1.3.2.cmml" xref="S3.E3.m1.1.1.3.2">𝑆</ci><apply id="S3.E3.m1.1.1.3.3.cmml" xref="S3.E3.m1.1.1.3.3"><times id="S3.E3.m1.1.1.3.3.1.cmml" xref="S3.E3.m1.1.1.3.3.1"></times><ci id="S3.E3.m1.1.1.3.3.2.cmml" xref="S3.E3.m1.1.1.3.3.2">𝑎</ci><ci id="S3.E3.m1.1.1.3.3.3.cmml" xref="S3.E3.m1.1.1.3.3.3">𝑡</ci><ci id="S3.E3.m1.1.1.3.3.4.cmml" xref="S3.E3.m1.1.1.3.3.4">𝑡</ci></apply></apply><apply id="S3.E3.m1.1.1.1.cmml" xref="S3.E3.m1.1.1.1"><ci id="S3.E3.m1.1.1.1.2.cmml" xref="S3.E3.m1.1.1.1.2">⋅</ci><apply id="S3.E3.m1.1.1.1.3.cmml" xref="S3.E3.m1.1.1.1.3"><csymbol cd="ambiguous" id="S3.E3.m1.1.1.1.3.1.cmml" xref="S3.E3.m1.1.1.1.3">subscript</csymbol><ci id="S3.E3.m1.1.1.1.3.2.cmml" xref="S3.E3.m1.1.1.1.3.2">𝑊</ci><apply id="S3.E3.m1.1.1.1.3.3.cmml" xref="S3.E3.m1.1.1.1.3.3"><times id="S3.E3.m1.1.1.1.3.3.1.cmml" xref="S3.E3.m1.1.1.1.3.3.1"></times><ci id="S3.E3.m1.1.1.1.3.3.2.cmml" xref="S3.E3.m1.1.1.1.3.3.2">𝑎</ci><ci id="S3.E3.m1.1.1.1.3.3.3.cmml" xref="S3.E3.m1.1.1.1.3.3.3">𝑡</ci><ci id="S3.E3.m1.1.1.1.3.3.4.cmml" xref="S3.E3.m1.1.1.1.3.3.4">𝑡</ci></apply></apply><apply id="S3.E3.m1.1.1.1.1.1.1.cmml" xref="S3.E3.m1.1.1.1.1.1"><plus id="S3.E3.m1.1.1.1.1.1.1.1.cmml" xref="S3.E3.m1.1.1.1.1.1.1.1"></plus><apply id="S3.E3.m1.1.1.1.1.1.1.2.cmml" xref="S3.E3.m1.1.1.1.1.1.1.2"><ci id="S3.E3.m1.1.1.1.1.1.1.2.1.cmml" xref="S3.E3.m1.1.1.1.1.1.1.2.1">⋅</ci><ci id="S3.E3.m1.1.1.1.1.1.1.2.2.cmml" xref="S3.E3.m1.1.1.1.1.1.1.2.2">𝑆</ci><apply id="S3.E3.m1.1.1.1.1.1.1.2.3.cmml" xref="S3.E3.m1.1.1.1.1.1.1.2.3"><csymbol cd="ambiguous" id="S3.E3.m1.1.1.1.1.1.1.2.3.1.cmml" xref="S3.E3.m1.1.1.1.1.1.1.2.3">subscript</csymbol><ci id="S3.E3.m1.1.1.1.1.1.1.2.3.2.cmml" xref="S3.E3.m1.1.1.1.1.1.1.2.3.2">𝑊</ci><ci id="S3.E3.m1.1.1.1.1.1.1.2.3.3.cmml" xref="S3.E3.m1.1.1.1.1.1.1.2.3.3">𝐸</ci></apply></apply><apply id="S3.E3.m1.1.1.1.1.1.1.3.cmml" xref="S3.E3.m1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.E3.m1.1.1.1.1.1.1.3.1.cmml" xref="S3.E3.m1.1.1.1.1.1.1.3">subscript</csymbol><ci id="S3.E3.m1.1.1.1.1.1.1.3.2.cmml" xref="S3.E3.m1.1.1.1.1.1.1.3.2">𝑏</ci><ci id="S3.E3.m1.1.1.1.1.1.1.3.3.cmml" xref="S3.E3.m1.1.1.1.1.1.1.3.3">𝐸</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E3.m1.1c">S_{att}=W_{att}\cdot(S\cdot W_{E}+b_{E})</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(3)</span></td>
</tr></tbody>
</table>
<p id="S3.SS1.p3.7" class="ltx_p">where <math id="S3.SS1.p3.5.m1.1" class="ltx_Math" alttext="W_{E}\in\mathbb{R}^{M\times N}" display="inline"><semantics id="S3.SS1.p3.5.m1.1a"><mrow id="S3.SS1.p3.5.m1.1.1" xref="S3.SS1.p3.5.m1.1.1.cmml"><msub id="S3.SS1.p3.5.m1.1.1.2" xref="S3.SS1.p3.5.m1.1.1.2.cmml"><mi id="S3.SS1.p3.5.m1.1.1.2.2" xref="S3.SS1.p3.5.m1.1.1.2.2.cmml">W</mi><mi id="S3.SS1.p3.5.m1.1.1.2.3" xref="S3.SS1.p3.5.m1.1.1.2.3.cmml">E</mi></msub><mo id="S3.SS1.p3.5.m1.1.1.1" xref="S3.SS1.p3.5.m1.1.1.1.cmml">∈</mo><msup id="S3.SS1.p3.5.m1.1.1.3" xref="S3.SS1.p3.5.m1.1.1.3.cmml"><mi id="S3.SS1.p3.5.m1.1.1.3.2" xref="S3.SS1.p3.5.m1.1.1.3.2.cmml">ℝ</mi><mrow id="S3.SS1.p3.5.m1.1.1.3.3" xref="S3.SS1.p3.5.m1.1.1.3.3.cmml"><mi id="S3.SS1.p3.5.m1.1.1.3.3.2" xref="S3.SS1.p3.5.m1.1.1.3.3.2.cmml">M</mi><mo lspace="0.222em" rspace="0.222em" id="S3.SS1.p3.5.m1.1.1.3.3.1" xref="S3.SS1.p3.5.m1.1.1.3.3.1.cmml">×</mo><mi id="S3.SS1.p3.5.m1.1.1.3.3.3" xref="S3.SS1.p3.5.m1.1.1.3.3.3.cmml">N</mi></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p3.5.m1.1b"><apply id="S3.SS1.p3.5.m1.1.1.cmml" xref="S3.SS1.p3.5.m1.1.1"><in id="S3.SS1.p3.5.m1.1.1.1.cmml" xref="S3.SS1.p3.5.m1.1.1.1"></in><apply id="S3.SS1.p3.5.m1.1.1.2.cmml" xref="S3.SS1.p3.5.m1.1.1.2"><csymbol cd="ambiguous" id="S3.SS1.p3.5.m1.1.1.2.1.cmml" xref="S3.SS1.p3.5.m1.1.1.2">subscript</csymbol><ci id="S3.SS1.p3.5.m1.1.1.2.2.cmml" xref="S3.SS1.p3.5.m1.1.1.2.2">𝑊</ci><ci id="S3.SS1.p3.5.m1.1.1.2.3.cmml" xref="S3.SS1.p3.5.m1.1.1.2.3">𝐸</ci></apply><apply id="S3.SS1.p3.5.m1.1.1.3.cmml" xref="S3.SS1.p3.5.m1.1.1.3"><csymbol cd="ambiguous" id="S3.SS1.p3.5.m1.1.1.3.1.cmml" xref="S3.SS1.p3.5.m1.1.1.3">superscript</csymbol><ci id="S3.SS1.p3.5.m1.1.1.3.2.cmml" xref="S3.SS1.p3.5.m1.1.1.3.2">ℝ</ci><apply id="S3.SS1.p3.5.m1.1.1.3.3.cmml" xref="S3.SS1.p3.5.m1.1.1.3.3"><times id="S3.SS1.p3.5.m1.1.1.3.3.1.cmml" xref="S3.SS1.p3.5.m1.1.1.3.3.1"></times><ci id="S3.SS1.p3.5.m1.1.1.3.3.2.cmml" xref="S3.SS1.p3.5.m1.1.1.3.3.2">𝑀</ci><ci id="S3.SS1.p3.5.m1.1.1.3.3.3.cmml" xref="S3.SS1.p3.5.m1.1.1.3.3.3">𝑁</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p3.5.m1.1c">W_{E}\in\mathbb{R}^{M\times N}</annotation></semantics></math> are the evidence embedding weights of the visual features <math id="S3.SS1.p3.6.m2.1" class="ltx_Math" alttext="S" display="inline"><semantics id="S3.SS1.p3.6.m2.1a"><mi id="S3.SS1.p3.6.m2.1.1" xref="S3.SS1.p3.6.m2.1.1.cmml">S</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p3.6.m2.1b"><ci id="S3.SS1.p3.6.m2.1.1.cmml" xref="S3.SS1.p3.6.m2.1.1">𝑆</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p3.6.m2.1c">S</annotation></semantics></math>, and <math id="S3.SS1.p3.7.m3.1" class="ltx_Math" alttext="b_{E}\in\mathbb{R}^{L\times N}" display="inline"><semantics id="S3.SS1.p3.7.m3.1a"><mrow id="S3.SS1.p3.7.m3.1.1" xref="S3.SS1.p3.7.m3.1.1.cmml"><msub id="S3.SS1.p3.7.m3.1.1.2" xref="S3.SS1.p3.7.m3.1.1.2.cmml"><mi id="S3.SS1.p3.7.m3.1.1.2.2" xref="S3.SS1.p3.7.m3.1.1.2.2.cmml">b</mi><mi id="S3.SS1.p3.7.m3.1.1.2.3" xref="S3.SS1.p3.7.m3.1.1.2.3.cmml">E</mi></msub><mo id="S3.SS1.p3.7.m3.1.1.1" xref="S3.SS1.p3.7.m3.1.1.1.cmml">∈</mo><msup id="S3.SS1.p3.7.m3.1.1.3" xref="S3.SS1.p3.7.m3.1.1.3.cmml"><mi id="S3.SS1.p3.7.m3.1.1.3.2" xref="S3.SS1.p3.7.m3.1.1.3.2.cmml">ℝ</mi><mrow id="S3.SS1.p3.7.m3.1.1.3.3" xref="S3.SS1.p3.7.m3.1.1.3.3.cmml"><mi id="S3.SS1.p3.7.m3.1.1.3.3.2" xref="S3.SS1.p3.7.m3.1.1.3.3.2.cmml">L</mi><mo lspace="0.222em" rspace="0.222em" id="S3.SS1.p3.7.m3.1.1.3.3.1" xref="S3.SS1.p3.7.m3.1.1.3.3.1.cmml">×</mo><mi id="S3.SS1.p3.7.m3.1.1.3.3.3" xref="S3.SS1.p3.7.m3.1.1.3.3.3.cmml">N</mi></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p3.7.m3.1b"><apply id="S3.SS1.p3.7.m3.1.1.cmml" xref="S3.SS1.p3.7.m3.1.1"><in id="S3.SS1.p3.7.m3.1.1.1.cmml" xref="S3.SS1.p3.7.m3.1.1.1"></in><apply id="S3.SS1.p3.7.m3.1.1.2.cmml" xref="S3.SS1.p3.7.m3.1.1.2"><csymbol cd="ambiguous" id="S3.SS1.p3.7.m3.1.1.2.1.cmml" xref="S3.SS1.p3.7.m3.1.1.2">subscript</csymbol><ci id="S3.SS1.p3.7.m3.1.1.2.2.cmml" xref="S3.SS1.p3.7.m3.1.1.2.2">𝑏</ci><ci id="S3.SS1.p3.7.m3.1.1.2.3.cmml" xref="S3.SS1.p3.7.m3.1.1.2.3">𝐸</ci></apply><apply id="S3.SS1.p3.7.m3.1.1.3.cmml" xref="S3.SS1.p3.7.m3.1.1.3"><csymbol cd="ambiguous" id="S3.SS1.p3.7.m3.1.1.3.1.cmml" xref="S3.SS1.p3.7.m3.1.1.3">superscript</csymbol><ci id="S3.SS1.p3.7.m3.1.1.3.2.cmml" xref="S3.SS1.p3.7.m3.1.1.3.2">ℝ</ci><apply id="S3.SS1.p3.7.m3.1.1.3.3.cmml" xref="S3.SS1.p3.7.m3.1.1.3.3"><times id="S3.SS1.p3.7.m3.1.1.3.3.1.cmml" xref="S3.SS1.p3.7.m3.1.1.3.3.1"></times><ci id="S3.SS1.p3.7.m3.1.1.3.3.2.cmml" xref="S3.SS1.p3.7.m3.1.1.3.3.2">𝐿</ci><ci id="S3.SS1.p3.7.m3.1.1.3.3.3.cmml" xref="S3.SS1.p3.7.m3.1.1.3.3.3">𝑁</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p3.7.m3.1c">b_{E}\in\mathbb{R}^{L\times N}</annotation></semantics></math> is the bias term.
In our running example, this step accumulates <span id="S3.SS1.p3.7.1" class="ltx_text ltx_font_italic">cat</span> presence features at the <span id="S3.SS1.p3.7.2" class="ltx_text ltx_font_italic">basket</span> location.</p>
</div>
<div id="S3.SS1.p4" class="ltx_para">
<p id="S3.SS1.p4.3" class="ltx_p">Finally, the sum of this evidence vector <math id="S3.SS1.p4.1.m1.1" class="ltx_Math" alttext="S_{att}" display="inline"><semantics id="S3.SS1.p4.1.m1.1a"><msub id="S3.SS1.p4.1.m1.1.1" xref="S3.SS1.p4.1.m1.1.1.cmml"><mi id="S3.SS1.p4.1.m1.1.1.2" xref="S3.SS1.p4.1.m1.1.1.2.cmml">S</mi><mrow id="S3.SS1.p4.1.m1.1.1.3" xref="S3.SS1.p4.1.m1.1.1.3.cmml"><mi id="S3.SS1.p4.1.m1.1.1.3.2" xref="S3.SS1.p4.1.m1.1.1.3.2.cmml">a</mi><mo lspace="0em" rspace="0em" id="S3.SS1.p4.1.m1.1.1.3.1" xref="S3.SS1.p4.1.m1.1.1.3.1.cmml">​</mo><mi id="S3.SS1.p4.1.m1.1.1.3.3" xref="S3.SS1.p4.1.m1.1.1.3.3.cmml">t</mi><mo lspace="0em" rspace="0em" id="S3.SS1.p4.1.m1.1.1.3.1a" xref="S3.SS1.p4.1.m1.1.1.3.1.cmml">​</mo><mi id="S3.SS1.p4.1.m1.1.1.3.4" xref="S3.SS1.p4.1.m1.1.1.3.4.cmml">t</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.p4.1.m1.1b"><apply id="S3.SS1.p4.1.m1.1.1.cmml" xref="S3.SS1.p4.1.m1.1.1"><csymbol cd="ambiguous" id="S3.SS1.p4.1.m1.1.1.1.cmml" xref="S3.SS1.p4.1.m1.1.1">subscript</csymbol><ci id="S3.SS1.p4.1.m1.1.1.2.cmml" xref="S3.SS1.p4.1.m1.1.1.2">𝑆</ci><apply id="S3.SS1.p4.1.m1.1.1.3.cmml" xref="S3.SS1.p4.1.m1.1.1.3"><times id="S3.SS1.p4.1.m1.1.1.3.1.cmml" xref="S3.SS1.p4.1.m1.1.1.3.1"></times><ci id="S3.SS1.p4.1.m1.1.1.3.2.cmml" xref="S3.SS1.p4.1.m1.1.1.3.2">𝑎</ci><ci id="S3.SS1.p4.1.m1.1.1.3.3.cmml" xref="S3.SS1.p4.1.m1.1.1.3.3">𝑡</ci><ci id="S3.SS1.p4.1.m1.1.1.3.4.cmml" xref="S3.SS1.p4.1.m1.1.1.3.4">𝑡</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p4.1.m1.1c">S_{att}</annotation></semantics></math> and the question embedding <math id="S3.SS1.p4.2.m2.1" class="ltx_Math" alttext="Q" display="inline"><semantics id="S3.SS1.p4.2.m2.1a"><mi id="S3.SS1.p4.2.m2.1.1" xref="S3.SS1.p4.2.m2.1.1.cmml">Q</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p4.2.m2.1b"><ci id="S3.SS1.p4.2.m2.1.1.cmml" xref="S3.SS1.p4.2.m2.1.1">𝑄</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p4.2.m2.1c">Q</annotation></semantics></math> is used to predict the answer for the given image and question.
For the question representation <math id="S3.SS1.p4.3.m3.1" class="ltx_Math" alttext="Q" display="inline"><semantics id="S3.SS1.p4.3.m3.1a"><mi id="S3.SS1.p4.3.m3.1.1" xref="S3.SS1.p4.3.m3.1.1.cmml">Q</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p4.3.m3.1b"><ci id="S3.SS1.p4.3.m3.1.1.cmml" xref="S3.SS1.p4.3.m3.1.1">𝑄</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p4.3.m3.1c">Q</annotation></semantics></math>, we choose the bag-of-words (BOW). Other question representations, such as an LSTM, can also be used, however, BOW has fewer parameters yet has shown good performance. As noted in <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib29" title="" class="ltx_ref">29</a>]</cite>, the simple BOW model performs roughly as well if not better than the sequence-based LSTM for the VQA task. Specifically, we compute</p>
<table id="S3.E4" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S3.E4.m1.1" class="ltx_Math" alttext="Q=W_{Q}\cdot V+b_{Q}" display="block"><semantics id="S3.E4.m1.1a"><mrow id="S3.E4.m1.1.1" xref="S3.E4.m1.1.1.cmml"><mi id="S3.E4.m1.1.1.2" xref="S3.E4.m1.1.1.2.cmml">Q</mi><mo id="S3.E4.m1.1.1.1" xref="S3.E4.m1.1.1.1.cmml">=</mo><mrow id="S3.E4.m1.1.1.3" xref="S3.E4.m1.1.1.3.cmml"><mrow id="S3.E4.m1.1.1.3.2" xref="S3.E4.m1.1.1.3.2.cmml"><msub id="S3.E4.m1.1.1.3.2.2" xref="S3.E4.m1.1.1.3.2.2.cmml"><mi id="S3.E4.m1.1.1.3.2.2.2" xref="S3.E4.m1.1.1.3.2.2.2.cmml">W</mi><mi id="S3.E4.m1.1.1.3.2.2.3" xref="S3.E4.m1.1.1.3.2.2.3.cmml">Q</mi></msub><mo lspace="0.222em" rspace="0.222em" id="S3.E4.m1.1.1.3.2.1" xref="S3.E4.m1.1.1.3.2.1.cmml">⋅</mo><mi id="S3.E4.m1.1.1.3.2.3" xref="S3.E4.m1.1.1.3.2.3.cmml">V</mi></mrow><mo id="S3.E4.m1.1.1.3.1" xref="S3.E4.m1.1.1.3.1.cmml">+</mo><msub id="S3.E4.m1.1.1.3.3" xref="S3.E4.m1.1.1.3.3.cmml"><mi id="S3.E4.m1.1.1.3.3.2" xref="S3.E4.m1.1.1.3.3.2.cmml">b</mi><mi id="S3.E4.m1.1.1.3.3.3" xref="S3.E4.m1.1.1.3.3.3.cmml">Q</mi></msub></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.E4.m1.1b"><apply id="S3.E4.m1.1.1.cmml" xref="S3.E4.m1.1.1"><eq id="S3.E4.m1.1.1.1.cmml" xref="S3.E4.m1.1.1.1"></eq><ci id="S3.E4.m1.1.1.2.cmml" xref="S3.E4.m1.1.1.2">𝑄</ci><apply id="S3.E4.m1.1.1.3.cmml" xref="S3.E4.m1.1.1.3"><plus id="S3.E4.m1.1.1.3.1.cmml" xref="S3.E4.m1.1.1.3.1"></plus><apply id="S3.E4.m1.1.1.3.2.cmml" xref="S3.E4.m1.1.1.3.2"><ci id="S3.E4.m1.1.1.3.2.1.cmml" xref="S3.E4.m1.1.1.3.2.1">⋅</ci><apply id="S3.E4.m1.1.1.3.2.2.cmml" xref="S3.E4.m1.1.1.3.2.2"><csymbol cd="ambiguous" id="S3.E4.m1.1.1.3.2.2.1.cmml" xref="S3.E4.m1.1.1.3.2.2">subscript</csymbol><ci id="S3.E4.m1.1.1.3.2.2.2.cmml" xref="S3.E4.m1.1.1.3.2.2.2">𝑊</ci><ci id="S3.E4.m1.1.1.3.2.2.3.cmml" xref="S3.E4.m1.1.1.3.2.2.3">𝑄</ci></apply><ci id="S3.E4.m1.1.1.3.2.3.cmml" xref="S3.E4.m1.1.1.3.2.3">𝑉</ci></apply><apply id="S3.E4.m1.1.1.3.3.cmml" xref="S3.E4.m1.1.1.3.3"><csymbol cd="ambiguous" id="S3.E4.m1.1.1.3.3.1.cmml" xref="S3.E4.m1.1.1.3.3">subscript</csymbol><ci id="S3.E4.m1.1.1.3.3.2.cmml" xref="S3.E4.m1.1.1.3.3.2">𝑏</ci><ci id="S3.E4.m1.1.1.3.3.3.cmml" xref="S3.E4.m1.1.1.3.3.3">𝑄</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E4.m1.1c">Q=W_{Q}\cdot V+b_{Q}</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(4)</span></td>
</tr></tbody>
</table>
<p id="S3.SS1.p4.7" class="ltx_p">where <math id="S3.SS1.p4.4.m1.1" class="ltx_Math" alttext="W_{Q}\in\mathbb{R}^{T}" display="inline"><semantics id="S3.SS1.p4.4.m1.1a"><mrow id="S3.SS1.p4.4.m1.1.1" xref="S3.SS1.p4.4.m1.1.1.cmml"><msub id="S3.SS1.p4.4.m1.1.1.2" xref="S3.SS1.p4.4.m1.1.1.2.cmml"><mi id="S3.SS1.p4.4.m1.1.1.2.2" xref="S3.SS1.p4.4.m1.1.1.2.2.cmml">W</mi><mi id="S3.SS1.p4.4.m1.1.1.2.3" xref="S3.SS1.p4.4.m1.1.1.2.3.cmml">Q</mi></msub><mo id="S3.SS1.p4.4.m1.1.1.1" xref="S3.SS1.p4.4.m1.1.1.1.cmml">∈</mo><msup id="S3.SS1.p4.4.m1.1.1.3" xref="S3.SS1.p4.4.m1.1.1.3.cmml"><mi id="S3.SS1.p4.4.m1.1.1.3.2" xref="S3.SS1.p4.4.m1.1.1.3.2.cmml">ℝ</mi><mi id="S3.SS1.p4.4.m1.1.1.3.3" xref="S3.SS1.p4.4.m1.1.1.3.3.cmml">T</mi></msup></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p4.4.m1.1b"><apply id="S3.SS1.p4.4.m1.1.1.cmml" xref="S3.SS1.p4.4.m1.1.1"><in id="S3.SS1.p4.4.m1.1.1.1.cmml" xref="S3.SS1.p4.4.m1.1.1.1"></in><apply id="S3.SS1.p4.4.m1.1.1.2.cmml" xref="S3.SS1.p4.4.m1.1.1.2"><csymbol cd="ambiguous" id="S3.SS1.p4.4.m1.1.1.2.1.cmml" xref="S3.SS1.p4.4.m1.1.1.2">subscript</csymbol><ci id="S3.SS1.p4.4.m1.1.1.2.2.cmml" xref="S3.SS1.p4.4.m1.1.1.2.2">𝑊</ci><ci id="S3.SS1.p4.4.m1.1.1.2.3.cmml" xref="S3.SS1.p4.4.m1.1.1.2.3">𝑄</ci></apply><apply id="S3.SS1.p4.4.m1.1.1.3.cmml" xref="S3.SS1.p4.4.m1.1.1.3"><csymbol cd="ambiguous" id="S3.SS1.p4.4.m1.1.1.3.1.cmml" xref="S3.SS1.p4.4.m1.1.1.3">superscript</csymbol><ci id="S3.SS1.p4.4.m1.1.1.3.2.cmml" xref="S3.SS1.p4.4.m1.1.1.3.2">ℝ</ci><ci id="S3.SS1.p4.4.m1.1.1.3.3.cmml" xref="S3.SS1.p4.4.m1.1.1.3.3">𝑇</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p4.4.m1.1c">W_{Q}\in\mathbb{R}^{T}</annotation></semantics></math> represents the BOW weights for word vectors <math id="S3.SS1.p4.5.m2.1" class="ltx_Math" alttext="V" display="inline"><semantics id="S3.SS1.p4.5.m2.1a"><mi id="S3.SS1.p4.5.m2.1.1" xref="S3.SS1.p4.5.m2.1.1.cmml">V</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p4.5.m2.1b"><ci id="S3.SS1.p4.5.m2.1.1.cmml" xref="S3.SS1.p4.5.m2.1.1">𝑉</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p4.5.m2.1c">V</annotation></semantics></math>, and <math id="S3.SS1.p4.6.m3.1" class="ltx_Math" alttext="b_{Q}\in\mathbb{R}^{N}" display="inline"><semantics id="S3.SS1.p4.6.m3.1a"><mrow id="S3.SS1.p4.6.m3.1.1" xref="S3.SS1.p4.6.m3.1.1.cmml"><msub id="S3.SS1.p4.6.m3.1.1.2" xref="S3.SS1.p4.6.m3.1.1.2.cmml"><mi id="S3.SS1.p4.6.m3.1.1.2.2" xref="S3.SS1.p4.6.m3.1.1.2.2.cmml">b</mi><mi id="S3.SS1.p4.6.m3.1.1.2.3" xref="S3.SS1.p4.6.m3.1.1.2.3.cmml">Q</mi></msub><mo id="S3.SS1.p4.6.m3.1.1.1" xref="S3.SS1.p4.6.m3.1.1.1.cmml">∈</mo><msup id="S3.SS1.p4.6.m3.1.1.3" xref="S3.SS1.p4.6.m3.1.1.3.cmml"><mi id="S3.SS1.p4.6.m3.1.1.3.2" xref="S3.SS1.p4.6.m3.1.1.3.2.cmml">ℝ</mi><mi id="S3.SS1.p4.6.m3.1.1.3.3" xref="S3.SS1.p4.6.m3.1.1.3.3.cmml">N</mi></msup></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p4.6.m3.1b"><apply id="S3.SS1.p4.6.m3.1.1.cmml" xref="S3.SS1.p4.6.m3.1.1"><in id="S3.SS1.p4.6.m3.1.1.1.cmml" xref="S3.SS1.p4.6.m3.1.1.1"></in><apply id="S3.SS1.p4.6.m3.1.1.2.cmml" xref="S3.SS1.p4.6.m3.1.1.2"><csymbol cd="ambiguous" id="S3.SS1.p4.6.m3.1.1.2.1.cmml" xref="S3.SS1.p4.6.m3.1.1.2">subscript</csymbol><ci id="S3.SS1.p4.6.m3.1.1.2.2.cmml" xref="S3.SS1.p4.6.m3.1.1.2.2">𝑏</ci><ci id="S3.SS1.p4.6.m3.1.1.2.3.cmml" xref="S3.SS1.p4.6.m3.1.1.2.3">𝑄</ci></apply><apply id="S3.SS1.p4.6.m3.1.1.3.cmml" xref="S3.SS1.p4.6.m3.1.1.3"><csymbol cd="ambiguous" id="S3.SS1.p4.6.m3.1.1.3.1.cmml" xref="S3.SS1.p4.6.m3.1.1.3">superscript</csymbol><ci id="S3.SS1.p4.6.m3.1.1.3.2.cmml" xref="S3.SS1.p4.6.m3.1.1.3.2">ℝ</ci><ci id="S3.SS1.p4.6.m3.1.1.3.3.cmml" xref="S3.SS1.p4.6.m3.1.1.3.3">𝑁</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p4.6.m3.1c">b_{Q}\in\mathbb{R}^{N}</annotation></semantics></math> is the bias term. The final prediction <math id="S3.SS1.p4.7.m4.1" class="ltx_Math" alttext="P" display="inline"><semantics id="S3.SS1.p4.7.m4.1a"><mi id="S3.SS1.p4.7.m4.1.1" xref="S3.SS1.p4.7.m4.1.1.cmml">P</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p4.7.m4.1b"><ci id="S3.SS1.p4.7.m4.1.1.cmml" xref="S3.SS1.p4.7.m4.1.1">𝑃</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p4.7.m4.1c">P</annotation></semantics></math> is</p>
<table id="S3.E5" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S3.E5.m1.2" class="ltx_Math" alttext="P=\operatorname{softmax}(W_{P}\cdot f(S_{att}+Q)+b_{P})" display="block"><semantics id="S3.E5.m1.2a"><mrow id="S3.E5.m1.2.2" xref="S3.E5.m1.2.2.cmml"><mi id="S3.E5.m1.2.2.3" xref="S3.E5.m1.2.2.3.cmml">P</mi><mo id="S3.E5.m1.2.2.2" xref="S3.E5.m1.2.2.2.cmml">=</mo><mrow id="S3.E5.m1.2.2.1.1" xref="S3.E5.m1.2.2.1.2.cmml"><mi id="S3.E5.m1.1.1" xref="S3.E5.m1.1.1.cmml">softmax</mi><mo id="S3.E5.m1.2.2.1.1a" xref="S3.E5.m1.2.2.1.2.cmml">⁡</mo><mrow id="S3.E5.m1.2.2.1.1.1" xref="S3.E5.m1.2.2.1.2.cmml"><mo stretchy="false" id="S3.E5.m1.2.2.1.1.1.2" xref="S3.E5.m1.2.2.1.2.cmml">(</mo><mrow id="S3.E5.m1.2.2.1.1.1.1" xref="S3.E5.m1.2.2.1.1.1.1.cmml"><mrow id="S3.E5.m1.2.2.1.1.1.1.1" xref="S3.E5.m1.2.2.1.1.1.1.1.cmml"><mrow id="S3.E5.m1.2.2.1.1.1.1.1.3" xref="S3.E5.m1.2.2.1.1.1.1.1.3.cmml"><msub id="S3.E5.m1.2.2.1.1.1.1.1.3.2" xref="S3.E5.m1.2.2.1.1.1.1.1.3.2.cmml"><mi id="S3.E5.m1.2.2.1.1.1.1.1.3.2.2" xref="S3.E5.m1.2.2.1.1.1.1.1.3.2.2.cmml">W</mi><mi id="S3.E5.m1.2.2.1.1.1.1.1.3.2.3" xref="S3.E5.m1.2.2.1.1.1.1.1.3.2.3.cmml">P</mi></msub><mo lspace="0.222em" rspace="0.222em" id="S3.E5.m1.2.2.1.1.1.1.1.3.1" xref="S3.E5.m1.2.2.1.1.1.1.1.3.1.cmml">⋅</mo><mi id="S3.E5.m1.2.2.1.1.1.1.1.3.3" xref="S3.E5.m1.2.2.1.1.1.1.1.3.3.cmml">f</mi></mrow><mo lspace="0em" rspace="0em" id="S3.E5.m1.2.2.1.1.1.1.1.2" xref="S3.E5.m1.2.2.1.1.1.1.1.2.cmml">​</mo><mrow id="S3.E5.m1.2.2.1.1.1.1.1.1.1" xref="S3.E5.m1.2.2.1.1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S3.E5.m1.2.2.1.1.1.1.1.1.1.2" xref="S3.E5.m1.2.2.1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="S3.E5.m1.2.2.1.1.1.1.1.1.1.1" xref="S3.E5.m1.2.2.1.1.1.1.1.1.1.1.cmml"><msub id="S3.E5.m1.2.2.1.1.1.1.1.1.1.1.2" xref="S3.E5.m1.2.2.1.1.1.1.1.1.1.1.2.cmml"><mi id="S3.E5.m1.2.2.1.1.1.1.1.1.1.1.2.2" xref="S3.E5.m1.2.2.1.1.1.1.1.1.1.1.2.2.cmml">S</mi><mrow id="S3.E5.m1.2.2.1.1.1.1.1.1.1.1.2.3" xref="S3.E5.m1.2.2.1.1.1.1.1.1.1.1.2.3.cmml"><mi id="S3.E5.m1.2.2.1.1.1.1.1.1.1.1.2.3.2" xref="S3.E5.m1.2.2.1.1.1.1.1.1.1.1.2.3.2.cmml">a</mi><mo lspace="0em" rspace="0em" id="S3.E5.m1.2.2.1.1.1.1.1.1.1.1.2.3.1" xref="S3.E5.m1.2.2.1.1.1.1.1.1.1.1.2.3.1.cmml">​</mo><mi id="S3.E5.m1.2.2.1.1.1.1.1.1.1.1.2.3.3" xref="S3.E5.m1.2.2.1.1.1.1.1.1.1.1.2.3.3.cmml">t</mi><mo lspace="0em" rspace="0em" id="S3.E5.m1.2.2.1.1.1.1.1.1.1.1.2.3.1a" xref="S3.E5.m1.2.2.1.1.1.1.1.1.1.1.2.3.1.cmml">​</mo><mi id="S3.E5.m1.2.2.1.1.1.1.1.1.1.1.2.3.4" xref="S3.E5.m1.2.2.1.1.1.1.1.1.1.1.2.3.4.cmml">t</mi></mrow></msub><mo id="S3.E5.m1.2.2.1.1.1.1.1.1.1.1.1" xref="S3.E5.m1.2.2.1.1.1.1.1.1.1.1.1.cmml">+</mo><mi id="S3.E5.m1.2.2.1.1.1.1.1.1.1.1.3" xref="S3.E5.m1.2.2.1.1.1.1.1.1.1.1.3.cmml">Q</mi></mrow><mo stretchy="false" id="S3.E5.m1.2.2.1.1.1.1.1.1.1.3" xref="S3.E5.m1.2.2.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S3.E5.m1.2.2.1.1.1.1.2" xref="S3.E5.m1.2.2.1.1.1.1.2.cmml">+</mo><msub id="S3.E5.m1.2.2.1.1.1.1.3" xref="S3.E5.m1.2.2.1.1.1.1.3.cmml"><mi id="S3.E5.m1.2.2.1.1.1.1.3.2" xref="S3.E5.m1.2.2.1.1.1.1.3.2.cmml">b</mi><mi id="S3.E5.m1.2.2.1.1.1.1.3.3" xref="S3.E5.m1.2.2.1.1.1.1.3.3.cmml">P</mi></msub></mrow><mo stretchy="false" id="S3.E5.m1.2.2.1.1.1.3" xref="S3.E5.m1.2.2.1.2.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.E5.m1.2b"><apply id="S3.E5.m1.2.2.cmml" xref="S3.E5.m1.2.2"><eq id="S3.E5.m1.2.2.2.cmml" xref="S3.E5.m1.2.2.2"></eq><ci id="S3.E5.m1.2.2.3.cmml" xref="S3.E5.m1.2.2.3">𝑃</ci><apply id="S3.E5.m1.2.2.1.2.cmml" xref="S3.E5.m1.2.2.1.1"><ci id="S3.E5.m1.1.1.cmml" xref="S3.E5.m1.1.1">softmax</ci><apply id="S3.E5.m1.2.2.1.1.1.1.cmml" xref="S3.E5.m1.2.2.1.1.1.1"><plus id="S3.E5.m1.2.2.1.1.1.1.2.cmml" xref="S3.E5.m1.2.2.1.1.1.1.2"></plus><apply id="S3.E5.m1.2.2.1.1.1.1.1.cmml" xref="S3.E5.m1.2.2.1.1.1.1.1"><times id="S3.E5.m1.2.2.1.1.1.1.1.2.cmml" xref="S3.E5.m1.2.2.1.1.1.1.1.2"></times><apply id="S3.E5.m1.2.2.1.1.1.1.1.3.cmml" xref="S3.E5.m1.2.2.1.1.1.1.1.3"><ci id="S3.E5.m1.2.2.1.1.1.1.1.3.1.cmml" xref="S3.E5.m1.2.2.1.1.1.1.1.3.1">⋅</ci><apply id="S3.E5.m1.2.2.1.1.1.1.1.3.2.cmml" xref="S3.E5.m1.2.2.1.1.1.1.1.3.2"><csymbol cd="ambiguous" id="S3.E5.m1.2.2.1.1.1.1.1.3.2.1.cmml" xref="S3.E5.m1.2.2.1.1.1.1.1.3.2">subscript</csymbol><ci id="S3.E5.m1.2.2.1.1.1.1.1.3.2.2.cmml" xref="S3.E5.m1.2.2.1.1.1.1.1.3.2.2">𝑊</ci><ci id="S3.E5.m1.2.2.1.1.1.1.1.3.2.3.cmml" xref="S3.E5.m1.2.2.1.1.1.1.1.3.2.3">𝑃</ci></apply><ci id="S3.E5.m1.2.2.1.1.1.1.1.3.3.cmml" xref="S3.E5.m1.2.2.1.1.1.1.1.3.3">𝑓</ci></apply><apply id="S3.E5.m1.2.2.1.1.1.1.1.1.1.1.cmml" xref="S3.E5.m1.2.2.1.1.1.1.1.1.1"><plus id="S3.E5.m1.2.2.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E5.m1.2.2.1.1.1.1.1.1.1.1.1"></plus><apply id="S3.E5.m1.2.2.1.1.1.1.1.1.1.1.2.cmml" xref="S3.E5.m1.2.2.1.1.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.E5.m1.2.2.1.1.1.1.1.1.1.1.2.1.cmml" xref="S3.E5.m1.2.2.1.1.1.1.1.1.1.1.2">subscript</csymbol><ci id="S3.E5.m1.2.2.1.1.1.1.1.1.1.1.2.2.cmml" xref="S3.E5.m1.2.2.1.1.1.1.1.1.1.1.2.2">𝑆</ci><apply id="S3.E5.m1.2.2.1.1.1.1.1.1.1.1.2.3.cmml" xref="S3.E5.m1.2.2.1.1.1.1.1.1.1.1.2.3"><times id="S3.E5.m1.2.2.1.1.1.1.1.1.1.1.2.3.1.cmml" xref="S3.E5.m1.2.2.1.1.1.1.1.1.1.1.2.3.1"></times><ci id="S3.E5.m1.2.2.1.1.1.1.1.1.1.1.2.3.2.cmml" xref="S3.E5.m1.2.2.1.1.1.1.1.1.1.1.2.3.2">𝑎</ci><ci id="S3.E5.m1.2.2.1.1.1.1.1.1.1.1.2.3.3.cmml" xref="S3.E5.m1.2.2.1.1.1.1.1.1.1.1.2.3.3">𝑡</ci><ci id="S3.E5.m1.2.2.1.1.1.1.1.1.1.1.2.3.4.cmml" xref="S3.E5.m1.2.2.1.1.1.1.1.1.1.1.2.3.4">𝑡</ci></apply></apply><ci id="S3.E5.m1.2.2.1.1.1.1.1.1.1.1.3.cmml" xref="S3.E5.m1.2.2.1.1.1.1.1.1.1.1.3">𝑄</ci></apply></apply><apply id="S3.E5.m1.2.2.1.1.1.1.3.cmml" xref="S3.E5.m1.2.2.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.E5.m1.2.2.1.1.1.1.3.1.cmml" xref="S3.E5.m1.2.2.1.1.1.1.3">subscript</csymbol><ci id="S3.E5.m1.2.2.1.1.1.1.3.2.cmml" xref="S3.E5.m1.2.2.1.1.1.1.3.2">𝑏</ci><ci id="S3.E5.m1.2.2.1.1.1.1.3.3.cmml" xref="S3.E5.m1.2.2.1.1.1.1.3.3">𝑃</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E5.m1.2c">P=\operatorname{softmax}(W_{P}\cdot f(S_{att}+Q)+b_{P})</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(5)</span></td>
</tr></tbody>
</table>
<p id="S3.SS1.p4.11" class="ltx_p">where <math id="S3.SS1.p4.8.m1.1" class="ltx_Math" alttext="W_{P}\in\mathbb{R}^{K\times N}" display="inline"><semantics id="S3.SS1.p4.8.m1.1a"><mrow id="S3.SS1.p4.8.m1.1.1" xref="S3.SS1.p4.8.m1.1.1.cmml"><msub id="S3.SS1.p4.8.m1.1.1.2" xref="S3.SS1.p4.8.m1.1.1.2.cmml"><mi id="S3.SS1.p4.8.m1.1.1.2.2" xref="S3.SS1.p4.8.m1.1.1.2.2.cmml">W</mi><mi id="S3.SS1.p4.8.m1.1.1.2.3" xref="S3.SS1.p4.8.m1.1.1.2.3.cmml">P</mi></msub><mo id="S3.SS1.p4.8.m1.1.1.1" xref="S3.SS1.p4.8.m1.1.1.1.cmml">∈</mo><msup id="S3.SS1.p4.8.m1.1.1.3" xref="S3.SS1.p4.8.m1.1.1.3.cmml"><mi id="S3.SS1.p4.8.m1.1.1.3.2" xref="S3.SS1.p4.8.m1.1.1.3.2.cmml">ℝ</mi><mrow id="S3.SS1.p4.8.m1.1.1.3.3" xref="S3.SS1.p4.8.m1.1.1.3.3.cmml"><mi id="S3.SS1.p4.8.m1.1.1.3.3.2" xref="S3.SS1.p4.8.m1.1.1.3.3.2.cmml">K</mi><mo lspace="0.222em" rspace="0.222em" id="S3.SS1.p4.8.m1.1.1.3.3.1" xref="S3.SS1.p4.8.m1.1.1.3.3.1.cmml">×</mo><mi id="S3.SS1.p4.8.m1.1.1.3.3.3" xref="S3.SS1.p4.8.m1.1.1.3.3.3.cmml">N</mi></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p4.8.m1.1b"><apply id="S3.SS1.p4.8.m1.1.1.cmml" xref="S3.SS1.p4.8.m1.1.1"><in id="S3.SS1.p4.8.m1.1.1.1.cmml" xref="S3.SS1.p4.8.m1.1.1.1"></in><apply id="S3.SS1.p4.8.m1.1.1.2.cmml" xref="S3.SS1.p4.8.m1.1.1.2"><csymbol cd="ambiguous" id="S3.SS1.p4.8.m1.1.1.2.1.cmml" xref="S3.SS1.p4.8.m1.1.1.2">subscript</csymbol><ci id="S3.SS1.p4.8.m1.1.1.2.2.cmml" xref="S3.SS1.p4.8.m1.1.1.2.2">𝑊</ci><ci id="S3.SS1.p4.8.m1.1.1.2.3.cmml" xref="S3.SS1.p4.8.m1.1.1.2.3">𝑃</ci></apply><apply id="S3.SS1.p4.8.m1.1.1.3.cmml" xref="S3.SS1.p4.8.m1.1.1.3"><csymbol cd="ambiguous" id="S3.SS1.p4.8.m1.1.1.3.1.cmml" xref="S3.SS1.p4.8.m1.1.1.3">superscript</csymbol><ci id="S3.SS1.p4.8.m1.1.1.3.2.cmml" xref="S3.SS1.p4.8.m1.1.1.3.2">ℝ</ci><apply id="S3.SS1.p4.8.m1.1.1.3.3.cmml" xref="S3.SS1.p4.8.m1.1.1.3.3"><times id="S3.SS1.p4.8.m1.1.1.3.3.1.cmml" xref="S3.SS1.p4.8.m1.1.1.3.3.1"></times><ci id="S3.SS1.p4.8.m1.1.1.3.3.2.cmml" xref="S3.SS1.p4.8.m1.1.1.3.3.2">𝐾</ci><ci id="S3.SS1.p4.8.m1.1.1.3.3.3.cmml" xref="S3.SS1.p4.8.m1.1.1.3.3.3">𝑁</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p4.8.m1.1c">W_{P}\in\mathbb{R}^{K\times N}</annotation></semantics></math>, bias term <math id="S3.SS1.p4.9.m2.1" class="ltx_Math" alttext="b_{P}\in\mathbb{R}^{K}" display="inline"><semantics id="S3.SS1.p4.9.m2.1a"><mrow id="S3.SS1.p4.9.m2.1.1" xref="S3.SS1.p4.9.m2.1.1.cmml"><msub id="S3.SS1.p4.9.m2.1.1.2" xref="S3.SS1.p4.9.m2.1.1.2.cmml"><mi id="S3.SS1.p4.9.m2.1.1.2.2" xref="S3.SS1.p4.9.m2.1.1.2.2.cmml">b</mi><mi id="S3.SS1.p4.9.m2.1.1.2.3" xref="S3.SS1.p4.9.m2.1.1.2.3.cmml">P</mi></msub><mo id="S3.SS1.p4.9.m2.1.1.1" xref="S3.SS1.p4.9.m2.1.1.1.cmml">∈</mo><msup id="S3.SS1.p4.9.m2.1.1.3" xref="S3.SS1.p4.9.m2.1.1.3.cmml"><mi id="S3.SS1.p4.9.m2.1.1.3.2" xref="S3.SS1.p4.9.m2.1.1.3.2.cmml">ℝ</mi><mi id="S3.SS1.p4.9.m2.1.1.3.3" xref="S3.SS1.p4.9.m2.1.1.3.3.cmml">K</mi></msup></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p4.9.m2.1b"><apply id="S3.SS1.p4.9.m2.1.1.cmml" xref="S3.SS1.p4.9.m2.1.1"><in id="S3.SS1.p4.9.m2.1.1.1.cmml" xref="S3.SS1.p4.9.m2.1.1.1"></in><apply id="S3.SS1.p4.9.m2.1.1.2.cmml" xref="S3.SS1.p4.9.m2.1.1.2"><csymbol cd="ambiguous" id="S3.SS1.p4.9.m2.1.1.2.1.cmml" xref="S3.SS1.p4.9.m2.1.1.2">subscript</csymbol><ci id="S3.SS1.p4.9.m2.1.1.2.2.cmml" xref="S3.SS1.p4.9.m2.1.1.2.2">𝑏</ci><ci id="S3.SS1.p4.9.m2.1.1.2.3.cmml" xref="S3.SS1.p4.9.m2.1.1.2.3">𝑃</ci></apply><apply id="S3.SS1.p4.9.m2.1.1.3.cmml" xref="S3.SS1.p4.9.m2.1.1.3"><csymbol cd="ambiguous" id="S3.SS1.p4.9.m2.1.1.3.1.cmml" xref="S3.SS1.p4.9.m2.1.1.3">superscript</csymbol><ci id="S3.SS1.p4.9.m2.1.1.3.2.cmml" xref="S3.SS1.p4.9.m2.1.1.3.2">ℝ</ci><ci id="S3.SS1.p4.9.m2.1.1.3.3.cmml" xref="S3.SS1.p4.9.m2.1.1.3.3">𝐾</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p4.9.m2.1c">b_{P}\in\mathbb{R}^{K}</annotation></semantics></math>, and <math id="S3.SS1.p4.10.m3.1" class="ltx_Math" alttext="K" display="inline"><semantics id="S3.SS1.p4.10.m3.1a"><mi id="S3.SS1.p4.10.m3.1.1" xref="S3.SS1.p4.10.m3.1.1.cmml">K</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p4.10.m3.1b"><ci id="S3.SS1.p4.10.m3.1.1.cmml" xref="S3.SS1.p4.10.m3.1.1">𝐾</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p4.10.m3.1c">K</annotation></semantics></math> represents the number of possible prediction answers. <math id="S3.SS1.p4.11.m4.1" class="ltx_Math" alttext="f" display="inline"><semantics id="S3.SS1.p4.11.m4.1a"><mi id="S3.SS1.p4.11.m4.1.1" xref="S3.SS1.p4.11.m4.1.1.cmml">f</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p4.11.m4.1b"><ci id="S3.SS1.p4.11.m4.1.1.cmml" xref="S3.SS1.p4.11.m4.1.1">𝑓</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p4.11.m4.1c">f</annotation></semantics></math> is the activation function, and we use ReLU here.
In our running example, this step adds the evidence gathered for <span id="S3.SS1.p4.11.1" class="ltx_text ltx_font_italic">cat</span> near the basket location to the question, and, since the cat was not found, predicts the answer “no”.
The attention and evidence computation steps can be optionally repeated in another hop, before predicting the final answer, as detailed in the next section.</p>
</div>
</section>
<section id="S3.SS2" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.2 </span>Spatial Attention in Two-Hop Model</h3>

<div id="S3.SS2.p1" class="ltx_para">
<p id="S3.SS2.p1.2" class="ltx_p">We can repeat hops to promote deeper inference, gathering additional evidence at each hop. Recall that the visual evidence vector <math id="S3.SS2.p1.1.m1.1" class="ltx_Math" alttext="S_{att}" display="inline"><semantics id="S3.SS2.p1.1.m1.1a"><msub id="S3.SS2.p1.1.m1.1.1" xref="S3.SS2.p1.1.m1.1.1.cmml"><mi id="S3.SS2.p1.1.m1.1.1.2" xref="S3.SS2.p1.1.m1.1.1.2.cmml">S</mi><mrow id="S3.SS2.p1.1.m1.1.1.3" xref="S3.SS2.p1.1.m1.1.1.3.cmml"><mi id="S3.SS2.p1.1.m1.1.1.3.2" xref="S3.SS2.p1.1.m1.1.1.3.2.cmml">a</mi><mo lspace="0em" rspace="0em" id="S3.SS2.p1.1.m1.1.1.3.1" xref="S3.SS2.p1.1.m1.1.1.3.1.cmml">​</mo><mi id="S3.SS2.p1.1.m1.1.1.3.3" xref="S3.SS2.p1.1.m1.1.1.3.3.cmml">t</mi><mo lspace="0em" rspace="0em" id="S3.SS2.p1.1.m1.1.1.3.1a" xref="S3.SS2.p1.1.m1.1.1.3.1.cmml">​</mo><mi id="S3.SS2.p1.1.m1.1.1.3.4" xref="S3.SS2.p1.1.m1.1.1.3.4.cmml">t</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.1.m1.1b"><apply id="S3.SS2.p1.1.m1.1.1.cmml" xref="S3.SS2.p1.1.m1.1.1"><csymbol cd="ambiguous" id="S3.SS2.p1.1.m1.1.1.1.cmml" xref="S3.SS2.p1.1.m1.1.1">subscript</csymbol><ci id="S3.SS2.p1.1.m1.1.1.2.cmml" xref="S3.SS2.p1.1.m1.1.1.2">𝑆</ci><apply id="S3.SS2.p1.1.m1.1.1.3.cmml" xref="S3.SS2.p1.1.m1.1.1.3"><times id="S3.SS2.p1.1.m1.1.1.3.1.cmml" xref="S3.SS2.p1.1.m1.1.1.3.1"></times><ci id="S3.SS2.p1.1.m1.1.1.3.2.cmml" xref="S3.SS2.p1.1.m1.1.1.3.2">𝑎</ci><ci id="S3.SS2.p1.1.m1.1.1.3.3.cmml" xref="S3.SS2.p1.1.m1.1.1.3.3">𝑡</ci><ci id="S3.SS2.p1.1.m1.1.1.3.4.cmml" xref="S3.SS2.p1.1.m1.1.1.3.4">𝑡</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.1.m1.1c">S_{att}</annotation></semantics></math> is added to the question representation <math id="S3.SS2.p1.2.m2.1" class="ltx_Math" alttext="Q" display="inline"><semantics id="S3.SS2.p1.2.m2.1a"><mi id="S3.SS2.p1.2.m2.1.1" xref="S3.SS2.p1.2.m2.1.1.cmml">Q</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.2.m2.1b"><ci id="S3.SS2.p1.2.m2.1.1.cmml" xref="S3.SS2.p1.2.m2.1.1">𝑄</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.2.m2.1c">Q</annotation></semantics></math> in the first hop to produce an updated question vector,</p>
<table id="S3.E6" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S3.E6.m1.1" class="ltx_Math" alttext="{O_{hop1}=S_{att}+Q}" display="block"><semantics id="S3.E6.m1.1a"><mrow id="S3.E6.m1.1.1" xref="S3.E6.m1.1.1.cmml"><msub id="S3.E6.m1.1.1.2" xref="S3.E6.m1.1.1.2.cmml"><mi id="S3.E6.m1.1.1.2.2" xref="S3.E6.m1.1.1.2.2.cmml">O</mi><mrow id="S3.E6.m1.1.1.2.3" xref="S3.E6.m1.1.1.2.3.cmml"><mi id="S3.E6.m1.1.1.2.3.2" xref="S3.E6.m1.1.1.2.3.2.cmml">h</mi><mo lspace="0em" rspace="0em" id="S3.E6.m1.1.1.2.3.1" xref="S3.E6.m1.1.1.2.3.1.cmml">​</mo><mi id="S3.E6.m1.1.1.2.3.3" xref="S3.E6.m1.1.1.2.3.3.cmml">o</mi><mo lspace="0em" rspace="0em" id="S3.E6.m1.1.1.2.3.1a" xref="S3.E6.m1.1.1.2.3.1.cmml">​</mo><mi id="S3.E6.m1.1.1.2.3.4" xref="S3.E6.m1.1.1.2.3.4.cmml">p</mi><mo lspace="0em" rspace="0em" id="S3.E6.m1.1.1.2.3.1b" xref="S3.E6.m1.1.1.2.3.1.cmml">​</mo><mn id="S3.E6.m1.1.1.2.3.5" xref="S3.E6.m1.1.1.2.3.5.cmml">1</mn></mrow></msub><mo id="S3.E6.m1.1.1.1" xref="S3.E6.m1.1.1.1.cmml">=</mo><mrow id="S3.E6.m1.1.1.3" xref="S3.E6.m1.1.1.3.cmml"><msub id="S3.E6.m1.1.1.3.2" xref="S3.E6.m1.1.1.3.2.cmml"><mi id="S3.E6.m1.1.1.3.2.2" xref="S3.E6.m1.1.1.3.2.2.cmml">S</mi><mrow id="S3.E6.m1.1.1.3.2.3" xref="S3.E6.m1.1.1.3.2.3.cmml"><mi id="S3.E6.m1.1.1.3.2.3.2" xref="S3.E6.m1.1.1.3.2.3.2.cmml">a</mi><mo lspace="0em" rspace="0em" id="S3.E6.m1.1.1.3.2.3.1" xref="S3.E6.m1.1.1.3.2.3.1.cmml">​</mo><mi id="S3.E6.m1.1.1.3.2.3.3" xref="S3.E6.m1.1.1.3.2.3.3.cmml">t</mi><mo lspace="0em" rspace="0em" id="S3.E6.m1.1.1.3.2.3.1a" xref="S3.E6.m1.1.1.3.2.3.1.cmml">​</mo><mi id="S3.E6.m1.1.1.3.2.3.4" xref="S3.E6.m1.1.1.3.2.3.4.cmml">t</mi></mrow></msub><mo id="S3.E6.m1.1.1.3.1" xref="S3.E6.m1.1.1.3.1.cmml">+</mo><mi id="S3.E6.m1.1.1.3.3" xref="S3.E6.m1.1.1.3.3.cmml">Q</mi></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.E6.m1.1b"><apply id="S3.E6.m1.1.1.cmml" xref="S3.E6.m1.1.1"><eq id="S3.E6.m1.1.1.1.cmml" xref="S3.E6.m1.1.1.1"></eq><apply id="S3.E6.m1.1.1.2.cmml" xref="S3.E6.m1.1.1.2"><csymbol cd="ambiguous" id="S3.E6.m1.1.1.2.1.cmml" xref="S3.E6.m1.1.1.2">subscript</csymbol><ci id="S3.E6.m1.1.1.2.2.cmml" xref="S3.E6.m1.1.1.2.2">𝑂</ci><apply id="S3.E6.m1.1.1.2.3.cmml" xref="S3.E6.m1.1.1.2.3"><times id="S3.E6.m1.1.1.2.3.1.cmml" xref="S3.E6.m1.1.1.2.3.1"></times><ci id="S3.E6.m1.1.1.2.3.2.cmml" xref="S3.E6.m1.1.1.2.3.2">ℎ</ci><ci id="S3.E6.m1.1.1.2.3.3.cmml" xref="S3.E6.m1.1.1.2.3.3">𝑜</ci><ci id="S3.E6.m1.1.1.2.3.4.cmml" xref="S3.E6.m1.1.1.2.3.4">𝑝</ci><cn type="integer" id="S3.E6.m1.1.1.2.3.5.cmml" xref="S3.E6.m1.1.1.2.3.5">1</cn></apply></apply><apply id="S3.E6.m1.1.1.3.cmml" xref="S3.E6.m1.1.1.3"><plus id="S3.E6.m1.1.1.3.1.cmml" xref="S3.E6.m1.1.1.3.1"></plus><apply id="S3.E6.m1.1.1.3.2.cmml" xref="S3.E6.m1.1.1.3.2"><csymbol cd="ambiguous" id="S3.E6.m1.1.1.3.2.1.cmml" xref="S3.E6.m1.1.1.3.2">subscript</csymbol><ci id="S3.E6.m1.1.1.3.2.2.cmml" xref="S3.E6.m1.1.1.3.2.2">𝑆</ci><apply id="S3.E6.m1.1.1.3.2.3.cmml" xref="S3.E6.m1.1.1.3.2.3"><times id="S3.E6.m1.1.1.3.2.3.1.cmml" xref="S3.E6.m1.1.1.3.2.3.1"></times><ci id="S3.E6.m1.1.1.3.2.3.2.cmml" xref="S3.E6.m1.1.1.3.2.3.2">𝑎</ci><ci id="S3.E6.m1.1.1.3.2.3.3.cmml" xref="S3.E6.m1.1.1.3.2.3.3">𝑡</ci><ci id="S3.E6.m1.1.1.3.2.3.4.cmml" xref="S3.E6.m1.1.1.3.2.3.4">𝑡</ci></apply></apply><ci id="S3.E6.m1.1.1.3.3.cmml" xref="S3.E6.m1.1.1.3.3">𝑄</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E6.m1.1c">{O_{hop1}=S_{att}+Q}</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(6)</span></td>
</tr></tbody>
</table>
<p id="S3.SS2.p1.4" class="ltx_p">On the next hop, this vector <math id="S3.SS2.p1.3.m1.1" class="ltx_Math" alttext="O_{hop1}\in\mathbb{R}^{N}" display="inline"><semantics id="S3.SS2.p1.3.m1.1a"><mrow id="S3.SS2.p1.3.m1.1.1" xref="S3.SS2.p1.3.m1.1.1.cmml"><msub id="S3.SS2.p1.3.m1.1.1.2" xref="S3.SS2.p1.3.m1.1.1.2.cmml"><mi id="S3.SS2.p1.3.m1.1.1.2.2" xref="S3.SS2.p1.3.m1.1.1.2.2.cmml">O</mi><mrow id="S3.SS2.p1.3.m1.1.1.2.3" xref="S3.SS2.p1.3.m1.1.1.2.3.cmml"><mi id="S3.SS2.p1.3.m1.1.1.2.3.2" xref="S3.SS2.p1.3.m1.1.1.2.3.2.cmml">h</mi><mo lspace="0em" rspace="0em" id="S3.SS2.p1.3.m1.1.1.2.3.1" xref="S3.SS2.p1.3.m1.1.1.2.3.1.cmml">​</mo><mi id="S3.SS2.p1.3.m1.1.1.2.3.3" xref="S3.SS2.p1.3.m1.1.1.2.3.3.cmml">o</mi><mo lspace="0em" rspace="0em" id="S3.SS2.p1.3.m1.1.1.2.3.1a" xref="S3.SS2.p1.3.m1.1.1.2.3.1.cmml">​</mo><mi id="S3.SS2.p1.3.m1.1.1.2.3.4" xref="S3.SS2.p1.3.m1.1.1.2.3.4.cmml">p</mi><mo lspace="0em" rspace="0em" id="S3.SS2.p1.3.m1.1.1.2.3.1b" xref="S3.SS2.p1.3.m1.1.1.2.3.1.cmml">​</mo><mn id="S3.SS2.p1.3.m1.1.1.2.3.5" xref="S3.SS2.p1.3.m1.1.1.2.3.5.cmml">1</mn></mrow></msub><mo id="S3.SS2.p1.3.m1.1.1.1" xref="S3.SS2.p1.3.m1.1.1.1.cmml">∈</mo><msup id="S3.SS2.p1.3.m1.1.1.3" xref="S3.SS2.p1.3.m1.1.1.3.cmml"><mi id="S3.SS2.p1.3.m1.1.1.3.2" xref="S3.SS2.p1.3.m1.1.1.3.2.cmml">ℝ</mi><mi id="S3.SS2.p1.3.m1.1.1.3.3" xref="S3.SS2.p1.3.m1.1.1.3.3.cmml">N</mi></msup></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.3.m1.1b"><apply id="S3.SS2.p1.3.m1.1.1.cmml" xref="S3.SS2.p1.3.m1.1.1"><in id="S3.SS2.p1.3.m1.1.1.1.cmml" xref="S3.SS2.p1.3.m1.1.1.1"></in><apply id="S3.SS2.p1.3.m1.1.1.2.cmml" xref="S3.SS2.p1.3.m1.1.1.2"><csymbol cd="ambiguous" id="S3.SS2.p1.3.m1.1.1.2.1.cmml" xref="S3.SS2.p1.3.m1.1.1.2">subscript</csymbol><ci id="S3.SS2.p1.3.m1.1.1.2.2.cmml" xref="S3.SS2.p1.3.m1.1.1.2.2">𝑂</ci><apply id="S3.SS2.p1.3.m1.1.1.2.3.cmml" xref="S3.SS2.p1.3.m1.1.1.2.3"><times id="S3.SS2.p1.3.m1.1.1.2.3.1.cmml" xref="S3.SS2.p1.3.m1.1.1.2.3.1"></times><ci id="S3.SS2.p1.3.m1.1.1.2.3.2.cmml" xref="S3.SS2.p1.3.m1.1.1.2.3.2">ℎ</ci><ci id="S3.SS2.p1.3.m1.1.1.2.3.3.cmml" xref="S3.SS2.p1.3.m1.1.1.2.3.3">𝑜</ci><ci id="S3.SS2.p1.3.m1.1.1.2.3.4.cmml" xref="S3.SS2.p1.3.m1.1.1.2.3.4">𝑝</ci><cn type="integer" id="S3.SS2.p1.3.m1.1.1.2.3.5.cmml" xref="S3.SS2.p1.3.m1.1.1.2.3.5">1</cn></apply></apply><apply id="S3.SS2.p1.3.m1.1.1.3.cmml" xref="S3.SS2.p1.3.m1.1.1.3"><csymbol cd="ambiguous" id="S3.SS2.p1.3.m1.1.1.3.1.cmml" xref="S3.SS2.p1.3.m1.1.1.3">superscript</csymbol><ci id="S3.SS2.p1.3.m1.1.1.3.2.cmml" xref="S3.SS2.p1.3.m1.1.1.3.2">ℝ</ci><ci id="S3.SS2.p1.3.m1.1.1.3.3.cmml" xref="S3.SS2.p1.3.m1.1.1.3.3">𝑁</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.3.m1.1c">O_{hop1}\in\mathbb{R}^{N}</annotation></semantics></math> is used in place of the individual word vectors <math id="S3.SS2.p1.4.m2.1" class="ltx_Math" alttext="V" display="inline"><semantics id="S3.SS2.p1.4.m2.1a"><mi id="S3.SS2.p1.4.m2.1.1" xref="S3.SS2.p1.4.m2.1.1.cmml">V</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p1.4.m2.1b"><ci id="S3.SS2.p1.4.m2.1.1.cmml" xref="S3.SS2.p1.4.m2.1.1">𝑉</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p1.4.m2.1c">V</annotation></semantics></math> to extract additional correlated visual features to the whole question from memory and update the visual evidence.</p>
</div>
<div id="S3.SS2.p2" class="ltx_para">
<p id="S3.SS2.p2.5" class="ltx_p">The correlation matrix <math id="S3.SS2.p2.1.m1.1" class="ltx_Math" alttext="C" display="inline"><semantics id="S3.SS2.p2.1.m1.1a"><mi id="S3.SS2.p2.1.m1.1.1" xref="S3.SS2.p2.1.m1.1.1.cmml">C</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p2.1.m1.1b"><ci id="S3.SS2.p2.1.m1.1.1.cmml" xref="S3.SS2.p2.1.m1.1.1">𝐶</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p2.1.m1.1c">C</annotation></semantics></math> in the first hop provides fine-grained local evidence from each word vectors <math id="S3.SS2.p2.2.m2.1" class="ltx_Math" alttext="V" display="inline"><semantics id="S3.SS2.p2.2.m2.1a"><mi id="S3.SS2.p2.2.m2.1.1" xref="S3.SS2.p2.2.m2.1.1.cmml">V</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p2.2.m2.1b"><ci id="S3.SS2.p2.2.m2.1.1.cmml" xref="S3.SS2.p2.2.m2.1.1">𝑉</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p2.2.m2.1c">V</annotation></semantics></math> in the question, while the correlation vector <math id="S3.SS2.p2.3.m3.1" class="ltx_Math" alttext="C_{hop2}" display="inline"><semantics id="S3.SS2.p2.3.m3.1a"><msub id="S3.SS2.p2.3.m3.1.1" xref="S3.SS2.p2.3.m3.1.1.cmml"><mi id="S3.SS2.p2.3.m3.1.1.2" xref="S3.SS2.p2.3.m3.1.1.2.cmml">C</mi><mrow id="S3.SS2.p2.3.m3.1.1.3" xref="S3.SS2.p2.3.m3.1.1.3.cmml"><mi id="S3.SS2.p2.3.m3.1.1.3.2" xref="S3.SS2.p2.3.m3.1.1.3.2.cmml">h</mi><mo lspace="0em" rspace="0em" id="S3.SS2.p2.3.m3.1.1.3.1" xref="S3.SS2.p2.3.m3.1.1.3.1.cmml">​</mo><mi id="S3.SS2.p2.3.m3.1.1.3.3" xref="S3.SS2.p2.3.m3.1.1.3.3.cmml">o</mi><mo lspace="0em" rspace="0em" id="S3.SS2.p2.3.m3.1.1.3.1a" xref="S3.SS2.p2.3.m3.1.1.3.1.cmml">​</mo><mi id="S3.SS2.p2.3.m3.1.1.3.4" xref="S3.SS2.p2.3.m3.1.1.3.4.cmml">p</mi><mo lspace="0em" rspace="0em" id="S3.SS2.p2.3.m3.1.1.3.1b" xref="S3.SS2.p2.3.m3.1.1.3.1.cmml">​</mo><mn id="S3.SS2.p2.3.m3.1.1.3.5" xref="S3.SS2.p2.3.m3.1.1.3.5.cmml">2</mn></mrow></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.p2.3.m3.1b"><apply id="S3.SS2.p2.3.m3.1.1.cmml" xref="S3.SS2.p2.3.m3.1.1"><csymbol cd="ambiguous" id="S3.SS2.p2.3.m3.1.1.1.cmml" xref="S3.SS2.p2.3.m3.1.1">subscript</csymbol><ci id="S3.SS2.p2.3.m3.1.1.2.cmml" xref="S3.SS2.p2.3.m3.1.1.2">𝐶</ci><apply id="S3.SS2.p2.3.m3.1.1.3.cmml" xref="S3.SS2.p2.3.m3.1.1.3"><times id="S3.SS2.p2.3.m3.1.1.3.1.cmml" xref="S3.SS2.p2.3.m3.1.1.3.1"></times><ci id="S3.SS2.p2.3.m3.1.1.3.2.cmml" xref="S3.SS2.p2.3.m3.1.1.3.2">ℎ</ci><ci id="S3.SS2.p2.3.m3.1.1.3.3.cmml" xref="S3.SS2.p2.3.m3.1.1.3.3">𝑜</ci><ci id="S3.SS2.p2.3.m3.1.1.3.4.cmml" xref="S3.SS2.p2.3.m3.1.1.3.4">𝑝</ci><cn type="integer" id="S3.SS2.p2.3.m3.1.1.3.5.cmml" xref="S3.SS2.p2.3.m3.1.1.3.5">2</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p2.3.m3.1c">C_{hop2}</annotation></semantics></math> in next hop considers the global evidence from the whole question representation <math id="S3.SS2.p2.4.m4.1" class="ltx_Math" alttext="Q" display="inline"><semantics id="S3.SS2.p2.4.m4.1a"><mi id="S3.SS2.p2.4.m4.1.1" xref="S3.SS2.p2.4.m4.1.1.cmml">Q</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p2.4.m4.1b"><ci id="S3.SS2.p2.4.m4.1.1.cmml" xref="S3.SS2.p2.4.m4.1.1">𝑄</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p2.4.m4.1c">Q</annotation></semantics></math>.
The correlation vector <math id="S3.SS2.p2.5.m5.1" class="ltx_Math" alttext="C_{hop2}\in\mathbb{R}^{L}" display="inline"><semantics id="S3.SS2.p2.5.m5.1a"><mrow id="S3.SS2.p2.5.m5.1.1" xref="S3.SS2.p2.5.m5.1.1.cmml"><msub id="S3.SS2.p2.5.m5.1.1.2" xref="S3.SS2.p2.5.m5.1.1.2.cmml"><mi id="S3.SS2.p2.5.m5.1.1.2.2" xref="S3.SS2.p2.5.m5.1.1.2.2.cmml">C</mi><mrow id="S3.SS2.p2.5.m5.1.1.2.3" xref="S3.SS2.p2.5.m5.1.1.2.3.cmml"><mi id="S3.SS2.p2.5.m5.1.1.2.3.2" xref="S3.SS2.p2.5.m5.1.1.2.3.2.cmml">h</mi><mo lspace="0em" rspace="0em" id="S3.SS2.p2.5.m5.1.1.2.3.1" xref="S3.SS2.p2.5.m5.1.1.2.3.1.cmml">​</mo><mi id="S3.SS2.p2.5.m5.1.1.2.3.3" xref="S3.SS2.p2.5.m5.1.1.2.3.3.cmml">o</mi><mo lspace="0em" rspace="0em" id="S3.SS2.p2.5.m5.1.1.2.3.1a" xref="S3.SS2.p2.5.m5.1.1.2.3.1.cmml">​</mo><mi id="S3.SS2.p2.5.m5.1.1.2.3.4" xref="S3.SS2.p2.5.m5.1.1.2.3.4.cmml">p</mi><mo lspace="0em" rspace="0em" id="S3.SS2.p2.5.m5.1.1.2.3.1b" xref="S3.SS2.p2.5.m5.1.1.2.3.1.cmml">​</mo><mn id="S3.SS2.p2.5.m5.1.1.2.3.5" xref="S3.SS2.p2.5.m5.1.1.2.3.5.cmml">2</mn></mrow></msub><mo id="S3.SS2.p2.5.m5.1.1.1" xref="S3.SS2.p2.5.m5.1.1.1.cmml">∈</mo><msup id="S3.SS2.p2.5.m5.1.1.3" xref="S3.SS2.p2.5.m5.1.1.3.cmml"><mi id="S3.SS2.p2.5.m5.1.1.3.2" xref="S3.SS2.p2.5.m5.1.1.3.2.cmml">ℝ</mi><mi id="S3.SS2.p2.5.m5.1.1.3.3" xref="S3.SS2.p2.5.m5.1.1.3.3.cmml">L</mi></msup></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p2.5.m5.1b"><apply id="S3.SS2.p2.5.m5.1.1.cmml" xref="S3.SS2.p2.5.m5.1.1"><in id="S3.SS2.p2.5.m5.1.1.1.cmml" xref="S3.SS2.p2.5.m5.1.1.1"></in><apply id="S3.SS2.p2.5.m5.1.1.2.cmml" xref="S3.SS2.p2.5.m5.1.1.2"><csymbol cd="ambiguous" id="S3.SS2.p2.5.m5.1.1.2.1.cmml" xref="S3.SS2.p2.5.m5.1.1.2">subscript</csymbol><ci id="S3.SS2.p2.5.m5.1.1.2.2.cmml" xref="S3.SS2.p2.5.m5.1.1.2.2">𝐶</ci><apply id="S3.SS2.p2.5.m5.1.1.2.3.cmml" xref="S3.SS2.p2.5.m5.1.1.2.3"><times id="S3.SS2.p2.5.m5.1.1.2.3.1.cmml" xref="S3.SS2.p2.5.m5.1.1.2.3.1"></times><ci id="S3.SS2.p2.5.m5.1.1.2.3.2.cmml" xref="S3.SS2.p2.5.m5.1.1.2.3.2">ℎ</ci><ci id="S3.SS2.p2.5.m5.1.1.2.3.3.cmml" xref="S3.SS2.p2.5.m5.1.1.2.3.3">𝑜</ci><ci id="S3.SS2.p2.5.m5.1.1.2.3.4.cmml" xref="S3.SS2.p2.5.m5.1.1.2.3.4">𝑝</ci><cn type="integer" id="S3.SS2.p2.5.m5.1.1.2.3.5.cmml" xref="S3.SS2.p2.5.m5.1.1.2.3.5">2</cn></apply></apply><apply id="S3.SS2.p2.5.m5.1.1.3.cmml" xref="S3.SS2.p2.5.m5.1.1.3"><csymbol cd="ambiguous" id="S3.SS2.p2.5.m5.1.1.3.1.cmml" xref="S3.SS2.p2.5.m5.1.1.3">superscript</csymbol><ci id="S3.SS2.p2.5.m5.1.1.3.2.cmml" xref="S3.SS2.p2.5.m5.1.1.3.2">ℝ</ci><ci id="S3.SS2.p2.5.m5.1.1.3.3.cmml" xref="S3.SS2.p2.5.m5.1.1.3.3">𝐿</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p2.5.m5.1c">C_{hop2}\in\mathbb{R}^{L}</annotation></semantics></math> in the second hop is calculated by</p>
<table id="S3.E7" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S3.E7.m1.1" class="ltx_Math" alttext="C_{hop2}=(S\cdot W_{E}+b_{E})\cdot O_{hop1}" display="block"><semantics id="S3.E7.m1.1a"><mrow id="S3.E7.m1.1.1" xref="S3.E7.m1.1.1.cmml"><msub id="S3.E7.m1.1.1.3" xref="S3.E7.m1.1.1.3.cmml"><mi id="S3.E7.m1.1.1.3.2" xref="S3.E7.m1.1.1.3.2.cmml">C</mi><mrow id="S3.E7.m1.1.1.3.3" xref="S3.E7.m1.1.1.3.3.cmml"><mi id="S3.E7.m1.1.1.3.3.2" xref="S3.E7.m1.1.1.3.3.2.cmml">h</mi><mo lspace="0em" rspace="0em" id="S3.E7.m1.1.1.3.3.1" xref="S3.E7.m1.1.1.3.3.1.cmml">​</mo><mi id="S3.E7.m1.1.1.3.3.3" xref="S3.E7.m1.1.1.3.3.3.cmml">o</mi><mo lspace="0em" rspace="0em" id="S3.E7.m1.1.1.3.3.1a" xref="S3.E7.m1.1.1.3.3.1.cmml">​</mo><mi id="S3.E7.m1.1.1.3.3.4" xref="S3.E7.m1.1.1.3.3.4.cmml">p</mi><mo lspace="0em" rspace="0em" id="S3.E7.m1.1.1.3.3.1b" xref="S3.E7.m1.1.1.3.3.1.cmml">​</mo><mn id="S3.E7.m1.1.1.3.3.5" xref="S3.E7.m1.1.1.3.3.5.cmml">2</mn></mrow></msub><mo id="S3.E7.m1.1.1.2" xref="S3.E7.m1.1.1.2.cmml">=</mo><mrow id="S3.E7.m1.1.1.1" xref="S3.E7.m1.1.1.1.cmml"><mrow id="S3.E7.m1.1.1.1.1.1" xref="S3.E7.m1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S3.E7.m1.1.1.1.1.1.2" xref="S3.E7.m1.1.1.1.1.1.1.cmml">(</mo><mrow id="S3.E7.m1.1.1.1.1.1.1" xref="S3.E7.m1.1.1.1.1.1.1.cmml"><mrow id="S3.E7.m1.1.1.1.1.1.1.2" xref="S3.E7.m1.1.1.1.1.1.1.2.cmml"><mi id="S3.E7.m1.1.1.1.1.1.1.2.2" xref="S3.E7.m1.1.1.1.1.1.1.2.2.cmml">S</mi><mo lspace="0.222em" rspace="0.222em" id="S3.E7.m1.1.1.1.1.1.1.2.1" xref="S3.E7.m1.1.1.1.1.1.1.2.1.cmml">⋅</mo><msub id="S3.E7.m1.1.1.1.1.1.1.2.3" xref="S3.E7.m1.1.1.1.1.1.1.2.3.cmml"><mi id="S3.E7.m1.1.1.1.1.1.1.2.3.2" xref="S3.E7.m1.1.1.1.1.1.1.2.3.2.cmml">W</mi><mi id="S3.E7.m1.1.1.1.1.1.1.2.3.3" xref="S3.E7.m1.1.1.1.1.1.1.2.3.3.cmml">E</mi></msub></mrow><mo id="S3.E7.m1.1.1.1.1.1.1.1" xref="S3.E7.m1.1.1.1.1.1.1.1.cmml">+</mo><msub id="S3.E7.m1.1.1.1.1.1.1.3" xref="S3.E7.m1.1.1.1.1.1.1.3.cmml"><mi id="S3.E7.m1.1.1.1.1.1.1.3.2" xref="S3.E7.m1.1.1.1.1.1.1.3.2.cmml">b</mi><mi id="S3.E7.m1.1.1.1.1.1.1.3.3" xref="S3.E7.m1.1.1.1.1.1.1.3.3.cmml">E</mi></msub></mrow><mo rspace="0.055em" stretchy="false" id="S3.E7.m1.1.1.1.1.1.3" xref="S3.E7.m1.1.1.1.1.1.1.cmml">)</mo></mrow><mo rspace="0.222em" id="S3.E7.m1.1.1.1.2" xref="S3.E7.m1.1.1.1.2.cmml">⋅</mo><msub id="S3.E7.m1.1.1.1.3" xref="S3.E7.m1.1.1.1.3.cmml"><mi id="S3.E7.m1.1.1.1.3.2" xref="S3.E7.m1.1.1.1.3.2.cmml">O</mi><mrow id="S3.E7.m1.1.1.1.3.3" xref="S3.E7.m1.1.1.1.3.3.cmml"><mi id="S3.E7.m1.1.1.1.3.3.2" xref="S3.E7.m1.1.1.1.3.3.2.cmml">h</mi><mo lspace="0em" rspace="0em" id="S3.E7.m1.1.1.1.3.3.1" xref="S3.E7.m1.1.1.1.3.3.1.cmml">​</mo><mi id="S3.E7.m1.1.1.1.3.3.3" xref="S3.E7.m1.1.1.1.3.3.3.cmml">o</mi><mo lspace="0em" rspace="0em" id="S3.E7.m1.1.1.1.3.3.1a" xref="S3.E7.m1.1.1.1.3.3.1.cmml">​</mo><mi id="S3.E7.m1.1.1.1.3.3.4" xref="S3.E7.m1.1.1.1.3.3.4.cmml">p</mi><mo lspace="0em" rspace="0em" id="S3.E7.m1.1.1.1.3.3.1b" xref="S3.E7.m1.1.1.1.3.3.1.cmml">​</mo><mn id="S3.E7.m1.1.1.1.3.3.5" xref="S3.E7.m1.1.1.1.3.3.5.cmml">1</mn></mrow></msub></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.E7.m1.1b"><apply id="S3.E7.m1.1.1.cmml" xref="S3.E7.m1.1.1"><eq id="S3.E7.m1.1.1.2.cmml" xref="S3.E7.m1.1.1.2"></eq><apply id="S3.E7.m1.1.1.3.cmml" xref="S3.E7.m1.1.1.3"><csymbol cd="ambiguous" id="S3.E7.m1.1.1.3.1.cmml" xref="S3.E7.m1.1.1.3">subscript</csymbol><ci id="S3.E7.m1.1.1.3.2.cmml" xref="S3.E7.m1.1.1.3.2">𝐶</ci><apply id="S3.E7.m1.1.1.3.3.cmml" xref="S3.E7.m1.1.1.3.3"><times id="S3.E7.m1.1.1.3.3.1.cmml" xref="S3.E7.m1.1.1.3.3.1"></times><ci id="S3.E7.m1.1.1.3.3.2.cmml" xref="S3.E7.m1.1.1.3.3.2">ℎ</ci><ci id="S3.E7.m1.1.1.3.3.3.cmml" xref="S3.E7.m1.1.1.3.3.3">𝑜</ci><ci id="S3.E7.m1.1.1.3.3.4.cmml" xref="S3.E7.m1.1.1.3.3.4">𝑝</ci><cn type="integer" id="S3.E7.m1.1.1.3.3.5.cmml" xref="S3.E7.m1.1.1.3.3.5">2</cn></apply></apply><apply id="S3.E7.m1.1.1.1.cmml" xref="S3.E7.m1.1.1.1"><ci id="S3.E7.m1.1.1.1.2.cmml" xref="S3.E7.m1.1.1.1.2">⋅</ci><apply id="S3.E7.m1.1.1.1.1.1.1.cmml" xref="S3.E7.m1.1.1.1.1.1"><plus id="S3.E7.m1.1.1.1.1.1.1.1.cmml" xref="S3.E7.m1.1.1.1.1.1.1.1"></plus><apply id="S3.E7.m1.1.1.1.1.1.1.2.cmml" xref="S3.E7.m1.1.1.1.1.1.1.2"><ci id="S3.E7.m1.1.1.1.1.1.1.2.1.cmml" xref="S3.E7.m1.1.1.1.1.1.1.2.1">⋅</ci><ci id="S3.E7.m1.1.1.1.1.1.1.2.2.cmml" xref="S3.E7.m1.1.1.1.1.1.1.2.2">𝑆</ci><apply id="S3.E7.m1.1.1.1.1.1.1.2.3.cmml" xref="S3.E7.m1.1.1.1.1.1.1.2.3"><csymbol cd="ambiguous" id="S3.E7.m1.1.1.1.1.1.1.2.3.1.cmml" xref="S3.E7.m1.1.1.1.1.1.1.2.3">subscript</csymbol><ci id="S3.E7.m1.1.1.1.1.1.1.2.3.2.cmml" xref="S3.E7.m1.1.1.1.1.1.1.2.3.2">𝑊</ci><ci id="S3.E7.m1.1.1.1.1.1.1.2.3.3.cmml" xref="S3.E7.m1.1.1.1.1.1.1.2.3.3">𝐸</ci></apply></apply><apply id="S3.E7.m1.1.1.1.1.1.1.3.cmml" xref="S3.E7.m1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.E7.m1.1.1.1.1.1.1.3.1.cmml" xref="S3.E7.m1.1.1.1.1.1.1.3">subscript</csymbol><ci id="S3.E7.m1.1.1.1.1.1.1.3.2.cmml" xref="S3.E7.m1.1.1.1.1.1.1.3.2">𝑏</ci><ci id="S3.E7.m1.1.1.1.1.1.1.3.3.cmml" xref="S3.E7.m1.1.1.1.1.1.1.3.3">𝐸</ci></apply></apply><apply id="S3.E7.m1.1.1.1.3.cmml" xref="S3.E7.m1.1.1.1.3"><csymbol cd="ambiguous" id="S3.E7.m1.1.1.1.3.1.cmml" xref="S3.E7.m1.1.1.1.3">subscript</csymbol><ci id="S3.E7.m1.1.1.1.3.2.cmml" xref="S3.E7.m1.1.1.1.3.2">𝑂</ci><apply id="S3.E7.m1.1.1.1.3.3.cmml" xref="S3.E7.m1.1.1.1.3.3"><times id="S3.E7.m1.1.1.1.3.3.1.cmml" xref="S3.E7.m1.1.1.1.3.3.1"></times><ci id="S3.E7.m1.1.1.1.3.3.2.cmml" xref="S3.E7.m1.1.1.1.3.3.2">ℎ</ci><ci id="S3.E7.m1.1.1.1.3.3.3.cmml" xref="S3.E7.m1.1.1.1.3.3.3">𝑜</ci><ci id="S3.E7.m1.1.1.1.3.3.4.cmml" xref="S3.E7.m1.1.1.1.3.3.4">𝑝</ci><cn type="integer" id="S3.E7.m1.1.1.1.3.3.5.cmml" xref="S3.E7.m1.1.1.1.3.3.5">1</cn></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E7.m1.1c">C_{hop2}=(S\cdot W_{E}+b_{E})\cdot O_{hop1}</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(7)</span></td>
</tr></tbody>
</table>
<p id="S3.SS2.p2.10" class="ltx_p">where <math id="S3.SS2.p2.6.m1.1" class="ltx_Math" alttext="W_{E}\in\mathbb{R}^{M\times N}" display="inline"><semantics id="S3.SS2.p2.6.m1.1a"><mrow id="S3.SS2.p2.6.m1.1.1" xref="S3.SS2.p2.6.m1.1.1.cmml"><msub id="S3.SS2.p2.6.m1.1.1.2" xref="S3.SS2.p2.6.m1.1.1.2.cmml"><mi id="S3.SS2.p2.6.m1.1.1.2.2" xref="S3.SS2.p2.6.m1.1.1.2.2.cmml">W</mi><mi id="S3.SS2.p2.6.m1.1.1.2.3" xref="S3.SS2.p2.6.m1.1.1.2.3.cmml">E</mi></msub><mo id="S3.SS2.p2.6.m1.1.1.1" xref="S3.SS2.p2.6.m1.1.1.1.cmml">∈</mo><msup id="S3.SS2.p2.6.m1.1.1.3" xref="S3.SS2.p2.6.m1.1.1.3.cmml"><mi id="S3.SS2.p2.6.m1.1.1.3.2" xref="S3.SS2.p2.6.m1.1.1.3.2.cmml">ℝ</mi><mrow id="S3.SS2.p2.6.m1.1.1.3.3" xref="S3.SS2.p2.6.m1.1.1.3.3.cmml"><mi id="S3.SS2.p2.6.m1.1.1.3.3.2" xref="S3.SS2.p2.6.m1.1.1.3.3.2.cmml">M</mi><mo lspace="0.222em" rspace="0.222em" id="S3.SS2.p2.6.m1.1.1.3.3.1" xref="S3.SS2.p2.6.m1.1.1.3.3.1.cmml">×</mo><mi id="S3.SS2.p2.6.m1.1.1.3.3.3" xref="S3.SS2.p2.6.m1.1.1.3.3.3.cmml">N</mi></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p2.6.m1.1b"><apply id="S3.SS2.p2.6.m1.1.1.cmml" xref="S3.SS2.p2.6.m1.1.1"><in id="S3.SS2.p2.6.m1.1.1.1.cmml" xref="S3.SS2.p2.6.m1.1.1.1"></in><apply id="S3.SS2.p2.6.m1.1.1.2.cmml" xref="S3.SS2.p2.6.m1.1.1.2"><csymbol cd="ambiguous" id="S3.SS2.p2.6.m1.1.1.2.1.cmml" xref="S3.SS2.p2.6.m1.1.1.2">subscript</csymbol><ci id="S3.SS2.p2.6.m1.1.1.2.2.cmml" xref="S3.SS2.p2.6.m1.1.1.2.2">𝑊</ci><ci id="S3.SS2.p2.6.m1.1.1.2.3.cmml" xref="S3.SS2.p2.6.m1.1.1.2.3">𝐸</ci></apply><apply id="S3.SS2.p2.6.m1.1.1.3.cmml" xref="S3.SS2.p2.6.m1.1.1.3"><csymbol cd="ambiguous" id="S3.SS2.p2.6.m1.1.1.3.1.cmml" xref="S3.SS2.p2.6.m1.1.1.3">superscript</csymbol><ci id="S3.SS2.p2.6.m1.1.1.3.2.cmml" xref="S3.SS2.p2.6.m1.1.1.3.2">ℝ</ci><apply id="S3.SS2.p2.6.m1.1.1.3.3.cmml" xref="S3.SS2.p2.6.m1.1.1.3.3"><times id="S3.SS2.p2.6.m1.1.1.3.3.1.cmml" xref="S3.SS2.p2.6.m1.1.1.3.3.1"></times><ci id="S3.SS2.p2.6.m1.1.1.3.3.2.cmml" xref="S3.SS2.p2.6.m1.1.1.3.3.2">𝑀</ci><ci id="S3.SS2.p2.6.m1.1.1.3.3.3.cmml" xref="S3.SS2.p2.6.m1.1.1.3.3.3">𝑁</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p2.6.m1.1c">W_{E}\in\mathbb{R}^{M\times N}</annotation></semantics></math> should be the attention embedding weights of visual features <math id="S3.SS2.p2.7.m2.1" class="ltx_Math" alttext="S" display="inline"><semantics id="S3.SS2.p2.7.m2.1a"><mi id="S3.SS2.p2.7.m2.1.1" xref="S3.SS2.p2.7.m2.1.1.cmml">S</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p2.7.m2.1b"><ci id="S3.SS2.p2.7.m2.1.1.cmml" xref="S3.SS2.p2.7.m2.1.1">𝑆</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p2.7.m2.1c">S</annotation></semantics></math> in the second hop and <math id="S3.SS2.p2.8.m3.1" class="ltx_Math" alttext="b_{E}\in\mathbb{R}^{L\times N}" display="inline"><semantics id="S3.SS2.p2.8.m3.1a"><mrow id="S3.SS2.p2.8.m3.1.1" xref="S3.SS2.p2.8.m3.1.1.cmml"><msub id="S3.SS2.p2.8.m3.1.1.2" xref="S3.SS2.p2.8.m3.1.1.2.cmml"><mi id="S3.SS2.p2.8.m3.1.1.2.2" xref="S3.SS2.p2.8.m3.1.1.2.2.cmml">b</mi><mi id="S3.SS2.p2.8.m3.1.1.2.3" xref="S3.SS2.p2.8.m3.1.1.2.3.cmml">E</mi></msub><mo id="S3.SS2.p2.8.m3.1.1.1" xref="S3.SS2.p2.8.m3.1.1.1.cmml">∈</mo><msup id="S3.SS2.p2.8.m3.1.1.3" xref="S3.SS2.p2.8.m3.1.1.3.cmml"><mi id="S3.SS2.p2.8.m3.1.1.3.2" xref="S3.SS2.p2.8.m3.1.1.3.2.cmml">ℝ</mi><mrow id="S3.SS2.p2.8.m3.1.1.3.3" xref="S3.SS2.p2.8.m3.1.1.3.3.cmml"><mi id="S3.SS2.p2.8.m3.1.1.3.3.2" xref="S3.SS2.p2.8.m3.1.1.3.3.2.cmml">L</mi><mo lspace="0.222em" rspace="0.222em" id="S3.SS2.p2.8.m3.1.1.3.3.1" xref="S3.SS2.p2.8.m3.1.1.3.3.1.cmml">×</mo><mi id="S3.SS2.p2.8.m3.1.1.3.3.3" xref="S3.SS2.p2.8.m3.1.1.3.3.3.cmml">N</mi></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p2.8.m3.1b"><apply id="S3.SS2.p2.8.m3.1.1.cmml" xref="S3.SS2.p2.8.m3.1.1"><in id="S3.SS2.p2.8.m3.1.1.1.cmml" xref="S3.SS2.p2.8.m3.1.1.1"></in><apply id="S3.SS2.p2.8.m3.1.1.2.cmml" xref="S3.SS2.p2.8.m3.1.1.2"><csymbol cd="ambiguous" id="S3.SS2.p2.8.m3.1.1.2.1.cmml" xref="S3.SS2.p2.8.m3.1.1.2">subscript</csymbol><ci id="S3.SS2.p2.8.m3.1.1.2.2.cmml" xref="S3.SS2.p2.8.m3.1.1.2.2">𝑏</ci><ci id="S3.SS2.p2.8.m3.1.1.2.3.cmml" xref="S3.SS2.p2.8.m3.1.1.2.3">𝐸</ci></apply><apply id="S3.SS2.p2.8.m3.1.1.3.cmml" xref="S3.SS2.p2.8.m3.1.1.3"><csymbol cd="ambiguous" id="S3.SS2.p2.8.m3.1.1.3.1.cmml" xref="S3.SS2.p2.8.m3.1.1.3">superscript</csymbol><ci id="S3.SS2.p2.8.m3.1.1.3.2.cmml" xref="S3.SS2.p2.8.m3.1.1.3.2">ℝ</ci><apply id="S3.SS2.p2.8.m3.1.1.3.3.cmml" xref="S3.SS2.p2.8.m3.1.1.3.3"><times id="S3.SS2.p2.8.m3.1.1.3.3.1.cmml" xref="S3.SS2.p2.8.m3.1.1.3.3.1"></times><ci id="S3.SS2.p2.8.m3.1.1.3.3.2.cmml" xref="S3.SS2.p2.8.m3.1.1.3.3.2">𝐿</ci><ci id="S3.SS2.p2.8.m3.1.1.3.3.3.cmml" xref="S3.SS2.p2.8.m3.1.1.3.3.3">𝑁</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p2.8.m3.1c">b_{E}\in\mathbb{R}^{L\times N}</annotation></semantics></math> should be the bias term. Since the attention embedding weights in the second hop are shared with the evidence embedding in the first hop, so we directly use <math id="S3.SS2.p2.9.m4.1" class="ltx_Math" alttext="W_{E}" display="inline"><semantics id="S3.SS2.p2.9.m4.1a"><msub id="S3.SS2.p2.9.m4.1.1" xref="S3.SS2.p2.9.m4.1.1.cmml"><mi id="S3.SS2.p2.9.m4.1.1.2" xref="S3.SS2.p2.9.m4.1.1.2.cmml">W</mi><mi id="S3.SS2.p2.9.m4.1.1.3" xref="S3.SS2.p2.9.m4.1.1.3.cmml">E</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.p2.9.m4.1b"><apply id="S3.SS2.p2.9.m4.1.1.cmml" xref="S3.SS2.p2.9.m4.1.1"><csymbol cd="ambiguous" id="S3.SS2.p2.9.m4.1.1.1.cmml" xref="S3.SS2.p2.9.m4.1.1">subscript</csymbol><ci id="S3.SS2.p2.9.m4.1.1.2.cmml" xref="S3.SS2.p2.9.m4.1.1.2">𝑊</ci><ci id="S3.SS2.p2.9.m4.1.1.3.cmml" xref="S3.SS2.p2.9.m4.1.1.3">𝐸</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p2.9.m4.1c">W_{E}</annotation></semantics></math> and <math id="S3.SS2.p2.10.m5.1" class="ltx_Math" alttext="b_{E}" display="inline"><semantics id="S3.SS2.p2.10.m5.1a"><msub id="S3.SS2.p2.10.m5.1.1" xref="S3.SS2.p2.10.m5.1.1.cmml"><mi id="S3.SS2.p2.10.m5.1.1.2" xref="S3.SS2.p2.10.m5.1.1.2.cmml">b</mi><mi id="S3.SS2.p2.10.m5.1.1.3" xref="S3.SS2.p2.10.m5.1.1.3.cmml">E</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.p2.10.m5.1b"><apply id="S3.SS2.p2.10.m5.1.1.cmml" xref="S3.SS2.p2.10.m5.1.1"><csymbol cd="ambiguous" id="S3.SS2.p2.10.m5.1.1.1.cmml" xref="S3.SS2.p2.10.m5.1.1">subscript</csymbol><ci id="S3.SS2.p2.10.m5.1.1.2.cmml" xref="S3.SS2.p2.10.m5.1.1.2">𝑏</ci><ci id="S3.SS2.p2.10.m5.1.1.3.cmml" xref="S3.SS2.p2.10.m5.1.1.3">𝐸</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p2.10.m5.1c">b_{E}</annotation></semantics></math> from first hop here.</p>
</div>
<div id="S3.SS2.p3" class="ltx_para">
<p id="S3.SS2.p3.2" class="ltx_p">The attention weights in the second hop <math id="S3.SS2.p3.1.m1.1" class="ltx_Math" alttext="W_{att2}" display="inline"><semantics id="S3.SS2.p3.1.m1.1a"><msub id="S3.SS2.p3.1.m1.1.1" xref="S3.SS2.p3.1.m1.1.1.cmml"><mi id="S3.SS2.p3.1.m1.1.1.2" xref="S3.SS2.p3.1.m1.1.1.2.cmml">W</mi><mrow id="S3.SS2.p3.1.m1.1.1.3" xref="S3.SS2.p3.1.m1.1.1.3.cmml"><mi id="S3.SS2.p3.1.m1.1.1.3.2" xref="S3.SS2.p3.1.m1.1.1.3.2.cmml">a</mi><mo lspace="0em" rspace="0em" id="S3.SS2.p3.1.m1.1.1.3.1" xref="S3.SS2.p3.1.m1.1.1.3.1.cmml">​</mo><mi id="S3.SS2.p3.1.m1.1.1.3.3" xref="S3.SS2.p3.1.m1.1.1.3.3.cmml">t</mi><mo lspace="0em" rspace="0em" id="S3.SS2.p3.1.m1.1.1.3.1a" xref="S3.SS2.p3.1.m1.1.1.3.1.cmml">​</mo><mi id="S3.SS2.p3.1.m1.1.1.3.4" xref="S3.SS2.p3.1.m1.1.1.3.4.cmml">t</mi><mo lspace="0em" rspace="0em" id="S3.SS2.p3.1.m1.1.1.3.1b" xref="S3.SS2.p3.1.m1.1.1.3.1.cmml">​</mo><mn id="S3.SS2.p3.1.m1.1.1.3.5" xref="S3.SS2.p3.1.m1.1.1.3.5.cmml">2</mn></mrow></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.p3.1.m1.1b"><apply id="S3.SS2.p3.1.m1.1.1.cmml" xref="S3.SS2.p3.1.m1.1.1"><csymbol cd="ambiguous" id="S3.SS2.p3.1.m1.1.1.1.cmml" xref="S3.SS2.p3.1.m1.1.1">subscript</csymbol><ci id="S3.SS2.p3.1.m1.1.1.2.cmml" xref="S3.SS2.p3.1.m1.1.1.2">𝑊</ci><apply id="S3.SS2.p3.1.m1.1.1.3.cmml" xref="S3.SS2.p3.1.m1.1.1.3"><times id="S3.SS2.p3.1.m1.1.1.3.1.cmml" xref="S3.SS2.p3.1.m1.1.1.3.1"></times><ci id="S3.SS2.p3.1.m1.1.1.3.2.cmml" xref="S3.SS2.p3.1.m1.1.1.3.2">𝑎</ci><ci id="S3.SS2.p3.1.m1.1.1.3.3.cmml" xref="S3.SS2.p3.1.m1.1.1.3.3">𝑡</ci><ci id="S3.SS2.p3.1.m1.1.1.3.4.cmml" xref="S3.SS2.p3.1.m1.1.1.3.4">𝑡</ci><cn type="integer" id="S3.SS2.p3.1.m1.1.1.3.5.cmml" xref="S3.SS2.p3.1.m1.1.1.3.5">2</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p3.1.m1.1c">W_{att2}</annotation></semantics></math> are obtained by applying the softmax function to the correlation vector <math id="S3.SS2.p3.2.m2.1" class="ltx_Math" alttext="C_{hop2}" display="inline"><semantics id="S3.SS2.p3.2.m2.1a"><msub id="S3.SS2.p3.2.m2.1.1" xref="S3.SS2.p3.2.m2.1.1.cmml"><mi id="S3.SS2.p3.2.m2.1.1.2" xref="S3.SS2.p3.2.m2.1.1.2.cmml">C</mi><mrow id="S3.SS2.p3.2.m2.1.1.3" xref="S3.SS2.p3.2.m2.1.1.3.cmml"><mi id="S3.SS2.p3.2.m2.1.1.3.2" xref="S3.SS2.p3.2.m2.1.1.3.2.cmml">h</mi><mo lspace="0em" rspace="0em" id="S3.SS2.p3.2.m2.1.1.3.1" xref="S3.SS2.p3.2.m2.1.1.3.1.cmml">​</mo><mi id="S3.SS2.p3.2.m2.1.1.3.3" xref="S3.SS2.p3.2.m2.1.1.3.3.cmml">o</mi><mo lspace="0em" rspace="0em" id="S3.SS2.p3.2.m2.1.1.3.1a" xref="S3.SS2.p3.2.m2.1.1.3.1.cmml">​</mo><mi id="S3.SS2.p3.2.m2.1.1.3.4" xref="S3.SS2.p3.2.m2.1.1.3.4.cmml">p</mi><mo lspace="0em" rspace="0em" id="S3.SS2.p3.2.m2.1.1.3.1b" xref="S3.SS2.p3.2.m2.1.1.3.1.cmml">​</mo><mn id="S3.SS2.p3.2.m2.1.1.3.5" xref="S3.SS2.p3.2.m2.1.1.3.5.cmml">2</mn></mrow></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.p3.2.m2.1b"><apply id="S3.SS2.p3.2.m2.1.1.cmml" xref="S3.SS2.p3.2.m2.1.1"><csymbol cd="ambiguous" id="S3.SS2.p3.2.m2.1.1.1.cmml" xref="S3.SS2.p3.2.m2.1.1">subscript</csymbol><ci id="S3.SS2.p3.2.m2.1.1.2.cmml" xref="S3.SS2.p3.2.m2.1.1.2">𝐶</ci><apply id="S3.SS2.p3.2.m2.1.1.3.cmml" xref="S3.SS2.p3.2.m2.1.1.3"><times id="S3.SS2.p3.2.m2.1.1.3.1.cmml" xref="S3.SS2.p3.2.m2.1.1.3.1"></times><ci id="S3.SS2.p3.2.m2.1.1.3.2.cmml" xref="S3.SS2.p3.2.m2.1.1.3.2">ℎ</ci><ci id="S3.SS2.p3.2.m2.1.1.3.3.cmml" xref="S3.SS2.p3.2.m2.1.1.3.3">𝑜</ci><ci id="S3.SS2.p3.2.m2.1.1.3.4.cmml" xref="S3.SS2.p3.2.m2.1.1.3.4">𝑝</ci><cn type="integer" id="S3.SS2.p3.2.m2.1.1.3.5.cmml" xref="S3.SS2.p3.2.m2.1.1.3.5">2</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p3.2.m2.1c">C_{hop2}</annotation></semantics></math>.</p>
<table id="S3.E8" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S3.E8.m1.2" class="ltx_Math" alttext="W_{att2}=\operatorname{softmax}(C_{hop2})" display="block"><semantics id="S3.E8.m1.2a"><mrow id="S3.E8.m1.2.2" xref="S3.E8.m1.2.2.cmml"><msub id="S3.E8.m1.2.2.3" xref="S3.E8.m1.2.2.3.cmml"><mi id="S3.E8.m1.2.2.3.2" xref="S3.E8.m1.2.2.3.2.cmml">W</mi><mrow id="S3.E8.m1.2.2.3.3" xref="S3.E8.m1.2.2.3.3.cmml"><mi id="S3.E8.m1.2.2.3.3.2" xref="S3.E8.m1.2.2.3.3.2.cmml">a</mi><mo lspace="0em" rspace="0em" id="S3.E8.m1.2.2.3.3.1" xref="S3.E8.m1.2.2.3.3.1.cmml">​</mo><mi id="S3.E8.m1.2.2.3.3.3" xref="S3.E8.m1.2.2.3.3.3.cmml">t</mi><mo lspace="0em" rspace="0em" id="S3.E8.m1.2.2.3.3.1a" xref="S3.E8.m1.2.2.3.3.1.cmml">​</mo><mi id="S3.E8.m1.2.2.3.3.4" xref="S3.E8.m1.2.2.3.3.4.cmml">t</mi><mo lspace="0em" rspace="0em" id="S3.E8.m1.2.2.3.3.1b" xref="S3.E8.m1.2.2.3.3.1.cmml">​</mo><mn id="S3.E8.m1.2.2.3.3.5" xref="S3.E8.m1.2.2.3.3.5.cmml">2</mn></mrow></msub><mo id="S3.E8.m1.2.2.2" xref="S3.E8.m1.2.2.2.cmml">=</mo><mrow id="S3.E8.m1.2.2.1.1" xref="S3.E8.m1.2.2.1.2.cmml"><mi id="S3.E8.m1.1.1" xref="S3.E8.m1.1.1.cmml">softmax</mi><mo id="S3.E8.m1.2.2.1.1a" xref="S3.E8.m1.2.2.1.2.cmml">⁡</mo><mrow id="S3.E8.m1.2.2.1.1.1" xref="S3.E8.m1.2.2.1.2.cmml"><mo stretchy="false" id="S3.E8.m1.2.2.1.1.1.2" xref="S3.E8.m1.2.2.1.2.cmml">(</mo><msub id="S3.E8.m1.2.2.1.1.1.1" xref="S3.E8.m1.2.2.1.1.1.1.cmml"><mi id="S3.E8.m1.2.2.1.1.1.1.2" xref="S3.E8.m1.2.2.1.1.1.1.2.cmml">C</mi><mrow id="S3.E8.m1.2.2.1.1.1.1.3" xref="S3.E8.m1.2.2.1.1.1.1.3.cmml"><mi id="S3.E8.m1.2.2.1.1.1.1.3.2" xref="S3.E8.m1.2.2.1.1.1.1.3.2.cmml">h</mi><mo lspace="0em" rspace="0em" id="S3.E8.m1.2.2.1.1.1.1.3.1" xref="S3.E8.m1.2.2.1.1.1.1.3.1.cmml">​</mo><mi id="S3.E8.m1.2.2.1.1.1.1.3.3" xref="S3.E8.m1.2.2.1.1.1.1.3.3.cmml">o</mi><mo lspace="0em" rspace="0em" id="S3.E8.m1.2.2.1.1.1.1.3.1a" xref="S3.E8.m1.2.2.1.1.1.1.3.1.cmml">​</mo><mi id="S3.E8.m1.2.2.1.1.1.1.3.4" xref="S3.E8.m1.2.2.1.1.1.1.3.4.cmml">p</mi><mo lspace="0em" rspace="0em" id="S3.E8.m1.2.2.1.1.1.1.3.1b" xref="S3.E8.m1.2.2.1.1.1.1.3.1.cmml">​</mo><mn id="S3.E8.m1.2.2.1.1.1.1.3.5" xref="S3.E8.m1.2.2.1.1.1.1.3.5.cmml">2</mn></mrow></msub><mo stretchy="false" id="S3.E8.m1.2.2.1.1.1.3" xref="S3.E8.m1.2.2.1.2.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.E8.m1.2b"><apply id="S3.E8.m1.2.2.cmml" xref="S3.E8.m1.2.2"><eq id="S3.E8.m1.2.2.2.cmml" xref="S3.E8.m1.2.2.2"></eq><apply id="S3.E8.m1.2.2.3.cmml" xref="S3.E8.m1.2.2.3"><csymbol cd="ambiguous" id="S3.E8.m1.2.2.3.1.cmml" xref="S3.E8.m1.2.2.3">subscript</csymbol><ci id="S3.E8.m1.2.2.3.2.cmml" xref="S3.E8.m1.2.2.3.2">𝑊</ci><apply id="S3.E8.m1.2.2.3.3.cmml" xref="S3.E8.m1.2.2.3.3"><times id="S3.E8.m1.2.2.3.3.1.cmml" xref="S3.E8.m1.2.2.3.3.1"></times><ci id="S3.E8.m1.2.2.3.3.2.cmml" xref="S3.E8.m1.2.2.3.3.2">𝑎</ci><ci id="S3.E8.m1.2.2.3.3.3.cmml" xref="S3.E8.m1.2.2.3.3.3">𝑡</ci><ci id="S3.E8.m1.2.2.3.3.4.cmml" xref="S3.E8.m1.2.2.3.3.4">𝑡</ci><cn type="integer" id="S3.E8.m1.2.2.3.3.5.cmml" xref="S3.E8.m1.2.2.3.3.5">2</cn></apply></apply><apply id="S3.E8.m1.2.2.1.2.cmml" xref="S3.E8.m1.2.2.1.1"><ci id="S3.E8.m1.1.1.cmml" xref="S3.E8.m1.1.1">softmax</ci><apply id="S3.E8.m1.2.2.1.1.1.1.cmml" xref="S3.E8.m1.2.2.1.1.1.1"><csymbol cd="ambiguous" id="S3.E8.m1.2.2.1.1.1.1.1.cmml" xref="S3.E8.m1.2.2.1.1.1.1">subscript</csymbol><ci id="S3.E8.m1.2.2.1.1.1.1.2.cmml" xref="S3.E8.m1.2.2.1.1.1.1.2">𝐶</ci><apply id="S3.E8.m1.2.2.1.1.1.1.3.cmml" xref="S3.E8.m1.2.2.1.1.1.1.3"><times id="S3.E8.m1.2.2.1.1.1.1.3.1.cmml" xref="S3.E8.m1.2.2.1.1.1.1.3.1"></times><ci id="S3.E8.m1.2.2.1.1.1.1.3.2.cmml" xref="S3.E8.m1.2.2.1.1.1.1.3.2">ℎ</ci><ci id="S3.E8.m1.2.2.1.1.1.1.3.3.cmml" xref="S3.E8.m1.2.2.1.1.1.1.3.3">𝑜</ci><ci id="S3.E8.m1.2.2.1.1.1.1.3.4.cmml" xref="S3.E8.m1.2.2.1.1.1.1.3.4">𝑝</ci><cn type="integer" id="S3.E8.m1.2.2.1.1.1.1.3.5.cmml" xref="S3.E8.m1.2.2.1.1.1.1.3.5">2</cn></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E8.m1.2c">W_{att2}=\operatorname{softmax}(C_{hop2})</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(8)</span></td>
</tr></tbody>
</table>
</div>
<div id="S3.SS2.p4" class="ltx_para">
<p id="S3.SS2.p4.2" class="ltx_p">Then, the correlated visual information in the second hop <math id="S3.SS2.p4.1.m1.1" class="ltx_Math" alttext="S_{att2}\in\mathbb{R}^{N}" display="inline"><semantics id="S3.SS2.p4.1.m1.1a"><mrow id="S3.SS2.p4.1.m1.1.1" xref="S3.SS2.p4.1.m1.1.1.cmml"><msub id="S3.SS2.p4.1.m1.1.1.2" xref="S3.SS2.p4.1.m1.1.1.2.cmml"><mi id="S3.SS2.p4.1.m1.1.1.2.2" xref="S3.SS2.p4.1.m1.1.1.2.2.cmml">S</mi><mrow id="S3.SS2.p4.1.m1.1.1.2.3" xref="S3.SS2.p4.1.m1.1.1.2.3.cmml"><mi id="S3.SS2.p4.1.m1.1.1.2.3.2" xref="S3.SS2.p4.1.m1.1.1.2.3.2.cmml">a</mi><mo lspace="0em" rspace="0em" id="S3.SS2.p4.1.m1.1.1.2.3.1" xref="S3.SS2.p4.1.m1.1.1.2.3.1.cmml">​</mo><mi id="S3.SS2.p4.1.m1.1.1.2.3.3" xref="S3.SS2.p4.1.m1.1.1.2.3.3.cmml">t</mi><mo lspace="0em" rspace="0em" id="S3.SS2.p4.1.m1.1.1.2.3.1a" xref="S3.SS2.p4.1.m1.1.1.2.3.1.cmml">​</mo><mi id="S3.SS2.p4.1.m1.1.1.2.3.4" xref="S3.SS2.p4.1.m1.1.1.2.3.4.cmml">t</mi><mo lspace="0em" rspace="0em" id="S3.SS2.p4.1.m1.1.1.2.3.1b" xref="S3.SS2.p4.1.m1.1.1.2.3.1.cmml">​</mo><mn id="S3.SS2.p4.1.m1.1.1.2.3.5" xref="S3.SS2.p4.1.m1.1.1.2.3.5.cmml">2</mn></mrow></msub><mo id="S3.SS2.p4.1.m1.1.1.1" xref="S3.SS2.p4.1.m1.1.1.1.cmml">∈</mo><msup id="S3.SS2.p4.1.m1.1.1.3" xref="S3.SS2.p4.1.m1.1.1.3.cmml"><mi id="S3.SS2.p4.1.m1.1.1.3.2" xref="S3.SS2.p4.1.m1.1.1.3.2.cmml">ℝ</mi><mi id="S3.SS2.p4.1.m1.1.1.3.3" xref="S3.SS2.p4.1.m1.1.1.3.3.cmml">N</mi></msup></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p4.1.m1.1b"><apply id="S3.SS2.p4.1.m1.1.1.cmml" xref="S3.SS2.p4.1.m1.1.1"><in id="S3.SS2.p4.1.m1.1.1.1.cmml" xref="S3.SS2.p4.1.m1.1.1.1"></in><apply id="S3.SS2.p4.1.m1.1.1.2.cmml" xref="S3.SS2.p4.1.m1.1.1.2"><csymbol cd="ambiguous" id="S3.SS2.p4.1.m1.1.1.2.1.cmml" xref="S3.SS2.p4.1.m1.1.1.2">subscript</csymbol><ci id="S3.SS2.p4.1.m1.1.1.2.2.cmml" xref="S3.SS2.p4.1.m1.1.1.2.2">𝑆</ci><apply id="S3.SS2.p4.1.m1.1.1.2.3.cmml" xref="S3.SS2.p4.1.m1.1.1.2.3"><times id="S3.SS2.p4.1.m1.1.1.2.3.1.cmml" xref="S3.SS2.p4.1.m1.1.1.2.3.1"></times><ci id="S3.SS2.p4.1.m1.1.1.2.3.2.cmml" xref="S3.SS2.p4.1.m1.1.1.2.3.2">𝑎</ci><ci id="S3.SS2.p4.1.m1.1.1.2.3.3.cmml" xref="S3.SS2.p4.1.m1.1.1.2.3.3">𝑡</ci><ci id="S3.SS2.p4.1.m1.1.1.2.3.4.cmml" xref="S3.SS2.p4.1.m1.1.1.2.3.4">𝑡</ci><cn type="integer" id="S3.SS2.p4.1.m1.1.1.2.3.5.cmml" xref="S3.SS2.p4.1.m1.1.1.2.3.5">2</cn></apply></apply><apply id="S3.SS2.p4.1.m1.1.1.3.cmml" xref="S3.SS2.p4.1.m1.1.1.3"><csymbol cd="ambiguous" id="S3.SS2.p4.1.m1.1.1.3.1.cmml" xref="S3.SS2.p4.1.m1.1.1.3">superscript</csymbol><ci id="S3.SS2.p4.1.m1.1.1.3.2.cmml" xref="S3.SS2.p4.1.m1.1.1.3.2">ℝ</ci><ci id="S3.SS2.p4.1.m1.1.1.3.3.cmml" xref="S3.SS2.p4.1.m1.1.1.3.3">𝑁</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p4.1.m1.1c">S_{att2}\in\mathbb{R}^{N}</annotation></semantics></math> is extracted using attention weights <math id="S3.SS2.p4.2.m2.1" class="ltx_Math" alttext="W_{att2}" display="inline"><semantics id="S3.SS2.p4.2.m2.1a"><msub id="S3.SS2.p4.2.m2.1.1" xref="S3.SS2.p4.2.m2.1.1.cmml"><mi id="S3.SS2.p4.2.m2.1.1.2" xref="S3.SS2.p4.2.m2.1.1.2.cmml">W</mi><mrow id="S3.SS2.p4.2.m2.1.1.3" xref="S3.SS2.p4.2.m2.1.1.3.cmml"><mi id="S3.SS2.p4.2.m2.1.1.3.2" xref="S3.SS2.p4.2.m2.1.1.3.2.cmml">a</mi><mo lspace="0em" rspace="0em" id="S3.SS2.p4.2.m2.1.1.3.1" xref="S3.SS2.p4.2.m2.1.1.3.1.cmml">​</mo><mi id="S3.SS2.p4.2.m2.1.1.3.3" xref="S3.SS2.p4.2.m2.1.1.3.3.cmml">t</mi><mo lspace="0em" rspace="0em" id="S3.SS2.p4.2.m2.1.1.3.1a" xref="S3.SS2.p4.2.m2.1.1.3.1.cmml">​</mo><mi id="S3.SS2.p4.2.m2.1.1.3.4" xref="S3.SS2.p4.2.m2.1.1.3.4.cmml">t</mi><mo lspace="0em" rspace="0em" id="S3.SS2.p4.2.m2.1.1.3.1b" xref="S3.SS2.p4.2.m2.1.1.3.1.cmml">​</mo><mn id="S3.SS2.p4.2.m2.1.1.3.5" xref="S3.SS2.p4.2.m2.1.1.3.5.cmml">2</mn></mrow></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.p4.2.m2.1b"><apply id="S3.SS2.p4.2.m2.1.1.cmml" xref="S3.SS2.p4.2.m2.1.1"><csymbol cd="ambiguous" id="S3.SS2.p4.2.m2.1.1.1.cmml" xref="S3.SS2.p4.2.m2.1.1">subscript</csymbol><ci id="S3.SS2.p4.2.m2.1.1.2.cmml" xref="S3.SS2.p4.2.m2.1.1.2">𝑊</ci><apply id="S3.SS2.p4.2.m2.1.1.3.cmml" xref="S3.SS2.p4.2.m2.1.1.3"><times id="S3.SS2.p4.2.m2.1.1.3.1.cmml" xref="S3.SS2.p4.2.m2.1.1.3.1"></times><ci id="S3.SS2.p4.2.m2.1.1.3.2.cmml" xref="S3.SS2.p4.2.m2.1.1.3.2">𝑎</ci><ci id="S3.SS2.p4.2.m2.1.1.3.3.cmml" xref="S3.SS2.p4.2.m2.1.1.3.3">𝑡</ci><ci id="S3.SS2.p4.2.m2.1.1.3.4.cmml" xref="S3.SS2.p4.2.m2.1.1.3.4">𝑡</ci><cn type="integer" id="S3.SS2.p4.2.m2.1.1.3.5.cmml" xref="S3.SS2.p4.2.m2.1.1.3.5">2</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p4.2.m2.1c">W_{att2}</annotation></semantics></math>.</p>
<table id="S3.E9" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S3.E9.m1.1" class="ltx_Math" alttext="S_{att2}=W_{att2}\cdot(S\cdot W_{E_{2}}+b_{E_{2}})" display="block"><semantics id="S3.E9.m1.1a"><mrow id="S3.E9.m1.1.1" xref="S3.E9.m1.1.1.cmml"><msub id="S3.E9.m1.1.1.3" xref="S3.E9.m1.1.1.3.cmml"><mi id="S3.E9.m1.1.1.3.2" xref="S3.E9.m1.1.1.3.2.cmml">S</mi><mrow id="S3.E9.m1.1.1.3.3" xref="S3.E9.m1.1.1.3.3.cmml"><mi id="S3.E9.m1.1.1.3.3.2" xref="S3.E9.m1.1.1.3.3.2.cmml">a</mi><mo lspace="0em" rspace="0em" id="S3.E9.m1.1.1.3.3.1" xref="S3.E9.m1.1.1.3.3.1.cmml">​</mo><mi id="S3.E9.m1.1.1.3.3.3" xref="S3.E9.m1.1.1.3.3.3.cmml">t</mi><mo lspace="0em" rspace="0em" id="S3.E9.m1.1.1.3.3.1a" xref="S3.E9.m1.1.1.3.3.1.cmml">​</mo><mi id="S3.E9.m1.1.1.3.3.4" xref="S3.E9.m1.1.1.3.3.4.cmml">t</mi><mo lspace="0em" rspace="0em" id="S3.E9.m1.1.1.3.3.1b" xref="S3.E9.m1.1.1.3.3.1.cmml">​</mo><mn id="S3.E9.m1.1.1.3.3.5" xref="S3.E9.m1.1.1.3.3.5.cmml">2</mn></mrow></msub><mo id="S3.E9.m1.1.1.2" xref="S3.E9.m1.1.1.2.cmml">=</mo><mrow id="S3.E9.m1.1.1.1" xref="S3.E9.m1.1.1.1.cmml"><msub id="S3.E9.m1.1.1.1.3" xref="S3.E9.m1.1.1.1.3.cmml"><mi id="S3.E9.m1.1.1.1.3.2" xref="S3.E9.m1.1.1.1.3.2.cmml">W</mi><mrow id="S3.E9.m1.1.1.1.3.3" xref="S3.E9.m1.1.1.1.3.3.cmml"><mi id="S3.E9.m1.1.1.1.3.3.2" xref="S3.E9.m1.1.1.1.3.3.2.cmml">a</mi><mo lspace="0em" rspace="0em" id="S3.E9.m1.1.1.1.3.3.1" xref="S3.E9.m1.1.1.1.3.3.1.cmml">​</mo><mi id="S3.E9.m1.1.1.1.3.3.3" xref="S3.E9.m1.1.1.1.3.3.3.cmml">t</mi><mo lspace="0em" rspace="0em" id="S3.E9.m1.1.1.1.3.3.1a" xref="S3.E9.m1.1.1.1.3.3.1.cmml">​</mo><mi id="S3.E9.m1.1.1.1.3.3.4" xref="S3.E9.m1.1.1.1.3.3.4.cmml">t</mi><mo lspace="0em" rspace="0em" id="S3.E9.m1.1.1.1.3.3.1b" xref="S3.E9.m1.1.1.1.3.3.1.cmml">​</mo><mn id="S3.E9.m1.1.1.1.3.3.5" xref="S3.E9.m1.1.1.1.3.3.5.cmml">2</mn></mrow></msub><mo lspace="0.222em" rspace="0.222em" id="S3.E9.m1.1.1.1.2" xref="S3.E9.m1.1.1.1.2.cmml">⋅</mo><mrow id="S3.E9.m1.1.1.1.1.1" xref="S3.E9.m1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S3.E9.m1.1.1.1.1.1.2" xref="S3.E9.m1.1.1.1.1.1.1.cmml">(</mo><mrow id="S3.E9.m1.1.1.1.1.1.1" xref="S3.E9.m1.1.1.1.1.1.1.cmml"><mrow id="S3.E9.m1.1.1.1.1.1.1.2" xref="S3.E9.m1.1.1.1.1.1.1.2.cmml"><mi id="S3.E9.m1.1.1.1.1.1.1.2.2" xref="S3.E9.m1.1.1.1.1.1.1.2.2.cmml">S</mi><mo lspace="0.222em" rspace="0.222em" id="S3.E9.m1.1.1.1.1.1.1.2.1" xref="S3.E9.m1.1.1.1.1.1.1.2.1.cmml">⋅</mo><msub id="S3.E9.m1.1.1.1.1.1.1.2.3" xref="S3.E9.m1.1.1.1.1.1.1.2.3.cmml"><mi id="S3.E9.m1.1.1.1.1.1.1.2.3.2" xref="S3.E9.m1.1.1.1.1.1.1.2.3.2.cmml">W</mi><msub id="S3.E9.m1.1.1.1.1.1.1.2.3.3" xref="S3.E9.m1.1.1.1.1.1.1.2.3.3.cmml"><mi id="S3.E9.m1.1.1.1.1.1.1.2.3.3.2" xref="S3.E9.m1.1.1.1.1.1.1.2.3.3.2.cmml">E</mi><mn id="S3.E9.m1.1.1.1.1.1.1.2.3.3.3" xref="S3.E9.m1.1.1.1.1.1.1.2.3.3.3.cmml">2</mn></msub></msub></mrow><mo id="S3.E9.m1.1.1.1.1.1.1.1" xref="S3.E9.m1.1.1.1.1.1.1.1.cmml">+</mo><msub id="S3.E9.m1.1.1.1.1.1.1.3" xref="S3.E9.m1.1.1.1.1.1.1.3.cmml"><mi id="S3.E9.m1.1.1.1.1.1.1.3.2" xref="S3.E9.m1.1.1.1.1.1.1.3.2.cmml">b</mi><msub id="S3.E9.m1.1.1.1.1.1.1.3.3" xref="S3.E9.m1.1.1.1.1.1.1.3.3.cmml"><mi id="S3.E9.m1.1.1.1.1.1.1.3.3.2" xref="S3.E9.m1.1.1.1.1.1.1.3.3.2.cmml">E</mi><mn id="S3.E9.m1.1.1.1.1.1.1.3.3.3" xref="S3.E9.m1.1.1.1.1.1.1.3.3.3.cmml">2</mn></msub></msub></mrow><mo stretchy="false" id="S3.E9.m1.1.1.1.1.1.3" xref="S3.E9.m1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.E9.m1.1b"><apply id="S3.E9.m1.1.1.cmml" xref="S3.E9.m1.1.1"><eq id="S3.E9.m1.1.1.2.cmml" xref="S3.E9.m1.1.1.2"></eq><apply id="S3.E9.m1.1.1.3.cmml" xref="S3.E9.m1.1.1.3"><csymbol cd="ambiguous" id="S3.E9.m1.1.1.3.1.cmml" xref="S3.E9.m1.1.1.3">subscript</csymbol><ci id="S3.E9.m1.1.1.3.2.cmml" xref="S3.E9.m1.1.1.3.2">𝑆</ci><apply id="S3.E9.m1.1.1.3.3.cmml" xref="S3.E9.m1.1.1.3.3"><times id="S3.E9.m1.1.1.3.3.1.cmml" xref="S3.E9.m1.1.1.3.3.1"></times><ci id="S3.E9.m1.1.1.3.3.2.cmml" xref="S3.E9.m1.1.1.3.3.2">𝑎</ci><ci id="S3.E9.m1.1.1.3.3.3.cmml" xref="S3.E9.m1.1.1.3.3.3">𝑡</ci><ci id="S3.E9.m1.1.1.3.3.4.cmml" xref="S3.E9.m1.1.1.3.3.4">𝑡</ci><cn type="integer" id="S3.E9.m1.1.1.3.3.5.cmml" xref="S3.E9.m1.1.1.3.3.5">2</cn></apply></apply><apply id="S3.E9.m1.1.1.1.cmml" xref="S3.E9.m1.1.1.1"><ci id="S3.E9.m1.1.1.1.2.cmml" xref="S3.E9.m1.1.1.1.2">⋅</ci><apply id="S3.E9.m1.1.1.1.3.cmml" xref="S3.E9.m1.1.1.1.3"><csymbol cd="ambiguous" id="S3.E9.m1.1.1.1.3.1.cmml" xref="S3.E9.m1.1.1.1.3">subscript</csymbol><ci id="S3.E9.m1.1.1.1.3.2.cmml" xref="S3.E9.m1.1.1.1.3.2">𝑊</ci><apply id="S3.E9.m1.1.1.1.3.3.cmml" xref="S3.E9.m1.1.1.1.3.3"><times id="S3.E9.m1.1.1.1.3.3.1.cmml" xref="S3.E9.m1.1.1.1.3.3.1"></times><ci id="S3.E9.m1.1.1.1.3.3.2.cmml" xref="S3.E9.m1.1.1.1.3.3.2">𝑎</ci><ci id="S3.E9.m1.1.1.1.3.3.3.cmml" xref="S3.E9.m1.1.1.1.3.3.3">𝑡</ci><ci id="S3.E9.m1.1.1.1.3.3.4.cmml" xref="S3.E9.m1.1.1.1.3.3.4">𝑡</ci><cn type="integer" id="S3.E9.m1.1.1.1.3.3.5.cmml" xref="S3.E9.m1.1.1.1.3.3.5">2</cn></apply></apply><apply id="S3.E9.m1.1.1.1.1.1.1.cmml" xref="S3.E9.m1.1.1.1.1.1"><plus id="S3.E9.m1.1.1.1.1.1.1.1.cmml" xref="S3.E9.m1.1.1.1.1.1.1.1"></plus><apply id="S3.E9.m1.1.1.1.1.1.1.2.cmml" xref="S3.E9.m1.1.1.1.1.1.1.2"><ci id="S3.E9.m1.1.1.1.1.1.1.2.1.cmml" xref="S3.E9.m1.1.1.1.1.1.1.2.1">⋅</ci><ci id="S3.E9.m1.1.1.1.1.1.1.2.2.cmml" xref="S3.E9.m1.1.1.1.1.1.1.2.2">𝑆</ci><apply id="S3.E9.m1.1.1.1.1.1.1.2.3.cmml" xref="S3.E9.m1.1.1.1.1.1.1.2.3"><csymbol cd="ambiguous" id="S3.E9.m1.1.1.1.1.1.1.2.3.1.cmml" xref="S3.E9.m1.1.1.1.1.1.1.2.3">subscript</csymbol><ci id="S3.E9.m1.1.1.1.1.1.1.2.3.2.cmml" xref="S3.E9.m1.1.1.1.1.1.1.2.3.2">𝑊</ci><apply id="S3.E9.m1.1.1.1.1.1.1.2.3.3.cmml" xref="S3.E9.m1.1.1.1.1.1.1.2.3.3"><csymbol cd="ambiguous" id="S3.E9.m1.1.1.1.1.1.1.2.3.3.1.cmml" xref="S3.E9.m1.1.1.1.1.1.1.2.3.3">subscript</csymbol><ci id="S3.E9.m1.1.1.1.1.1.1.2.3.3.2.cmml" xref="S3.E9.m1.1.1.1.1.1.1.2.3.3.2">𝐸</ci><cn type="integer" id="S3.E9.m1.1.1.1.1.1.1.2.3.3.3.cmml" xref="S3.E9.m1.1.1.1.1.1.1.2.3.3.3">2</cn></apply></apply></apply><apply id="S3.E9.m1.1.1.1.1.1.1.3.cmml" xref="S3.E9.m1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.E9.m1.1.1.1.1.1.1.3.1.cmml" xref="S3.E9.m1.1.1.1.1.1.1.3">subscript</csymbol><ci id="S3.E9.m1.1.1.1.1.1.1.3.2.cmml" xref="S3.E9.m1.1.1.1.1.1.1.3.2">𝑏</ci><apply id="S3.E9.m1.1.1.1.1.1.1.3.3.cmml" xref="S3.E9.m1.1.1.1.1.1.1.3.3"><csymbol cd="ambiguous" id="S3.E9.m1.1.1.1.1.1.1.3.3.1.cmml" xref="S3.E9.m1.1.1.1.1.1.1.3.3">subscript</csymbol><ci id="S3.E9.m1.1.1.1.1.1.1.3.3.2.cmml" xref="S3.E9.m1.1.1.1.1.1.1.3.3.2">𝐸</ci><cn type="integer" id="S3.E9.m1.1.1.1.1.1.1.3.3.3.cmml" xref="S3.E9.m1.1.1.1.1.1.1.3.3.3">2</cn></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E9.m1.1c">S_{att2}=W_{att2}\cdot(S\cdot W_{E_{2}}+b_{E_{2}})</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(9)</span></td>
</tr></tbody>
</table>
<p id="S3.SS2.p4.5" class="ltx_p">where <math id="S3.SS2.p4.3.m1.1" class="ltx_Math" alttext="W_{E_{2}}\in\mathbb{R}^{M\times N}" display="inline"><semantics id="S3.SS2.p4.3.m1.1a"><mrow id="S3.SS2.p4.3.m1.1.1" xref="S3.SS2.p4.3.m1.1.1.cmml"><msub id="S3.SS2.p4.3.m1.1.1.2" xref="S3.SS2.p4.3.m1.1.1.2.cmml"><mi id="S3.SS2.p4.3.m1.1.1.2.2" xref="S3.SS2.p4.3.m1.1.1.2.2.cmml">W</mi><msub id="S3.SS2.p4.3.m1.1.1.2.3" xref="S3.SS2.p4.3.m1.1.1.2.3.cmml"><mi id="S3.SS2.p4.3.m1.1.1.2.3.2" xref="S3.SS2.p4.3.m1.1.1.2.3.2.cmml">E</mi><mn id="S3.SS2.p4.3.m1.1.1.2.3.3" xref="S3.SS2.p4.3.m1.1.1.2.3.3.cmml">2</mn></msub></msub><mo id="S3.SS2.p4.3.m1.1.1.1" xref="S3.SS2.p4.3.m1.1.1.1.cmml">∈</mo><msup id="S3.SS2.p4.3.m1.1.1.3" xref="S3.SS2.p4.3.m1.1.1.3.cmml"><mi id="S3.SS2.p4.3.m1.1.1.3.2" xref="S3.SS2.p4.3.m1.1.1.3.2.cmml">ℝ</mi><mrow id="S3.SS2.p4.3.m1.1.1.3.3" xref="S3.SS2.p4.3.m1.1.1.3.3.cmml"><mi id="S3.SS2.p4.3.m1.1.1.3.3.2" xref="S3.SS2.p4.3.m1.1.1.3.3.2.cmml">M</mi><mo lspace="0.222em" rspace="0.222em" id="S3.SS2.p4.3.m1.1.1.3.3.1" xref="S3.SS2.p4.3.m1.1.1.3.3.1.cmml">×</mo><mi id="S3.SS2.p4.3.m1.1.1.3.3.3" xref="S3.SS2.p4.3.m1.1.1.3.3.3.cmml">N</mi></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p4.3.m1.1b"><apply id="S3.SS2.p4.3.m1.1.1.cmml" xref="S3.SS2.p4.3.m1.1.1"><in id="S3.SS2.p4.3.m1.1.1.1.cmml" xref="S3.SS2.p4.3.m1.1.1.1"></in><apply id="S3.SS2.p4.3.m1.1.1.2.cmml" xref="S3.SS2.p4.3.m1.1.1.2"><csymbol cd="ambiguous" id="S3.SS2.p4.3.m1.1.1.2.1.cmml" xref="S3.SS2.p4.3.m1.1.1.2">subscript</csymbol><ci id="S3.SS2.p4.3.m1.1.1.2.2.cmml" xref="S3.SS2.p4.3.m1.1.1.2.2">𝑊</ci><apply id="S3.SS2.p4.3.m1.1.1.2.3.cmml" xref="S3.SS2.p4.3.m1.1.1.2.3"><csymbol cd="ambiguous" id="S3.SS2.p4.3.m1.1.1.2.3.1.cmml" xref="S3.SS2.p4.3.m1.1.1.2.3">subscript</csymbol><ci id="S3.SS2.p4.3.m1.1.1.2.3.2.cmml" xref="S3.SS2.p4.3.m1.1.1.2.3.2">𝐸</ci><cn type="integer" id="S3.SS2.p4.3.m1.1.1.2.3.3.cmml" xref="S3.SS2.p4.3.m1.1.1.2.3.3">2</cn></apply></apply><apply id="S3.SS2.p4.3.m1.1.1.3.cmml" xref="S3.SS2.p4.3.m1.1.1.3"><csymbol cd="ambiguous" id="S3.SS2.p4.3.m1.1.1.3.1.cmml" xref="S3.SS2.p4.3.m1.1.1.3">superscript</csymbol><ci id="S3.SS2.p4.3.m1.1.1.3.2.cmml" xref="S3.SS2.p4.3.m1.1.1.3.2">ℝ</ci><apply id="S3.SS2.p4.3.m1.1.1.3.3.cmml" xref="S3.SS2.p4.3.m1.1.1.3.3"><times id="S3.SS2.p4.3.m1.1.1.3.3.1.cmml" xref="S3.SS2.p4.3.m1.1.1.3.3.1"></times><ci id="S3.SS2.p4.3.m1.1.1.3.3.2.cmml" xref="S3.SS2.p4.3.m1.1.1.3.3.2">𝑀</ci><ci id="S3.SS2.p4.3.m1.1.1.3.3.3.cmml" xref="S3.SS2.p4.3.m1.1.1.3.3.3">𝑁</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p4.3.m1.1c">W_{E_{2}}\in\mathbb{R}^{M\times N}</annotation></semantics></math> are the evidence embedding weights of visual features <math id="S3.SS2.p4.4.m2.1" class="ltx_Math" alttext="S" display="inline"><semantics id="S3.SS2.p4.4.m2.1a"><mi id="S3.SS2.p4.4.m2.1.1" xref="S3.SS2.p4.4.m2.1.1.cmml">S</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p4.4.m2.1b"><ci id="S3.SS2.p4.4.m2.1.1.cmml" xref="S3.SS2.p4.4.m2.1.1">𝑆</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p4.4.m2.1c">S</annotation></semantics></math> in the second hop, and <math id="S3.SS2.p4.5.m3.1" class="ltx_Math" alttext="b_{E_{2}}\in\mathbb{R}^{L\times N}" display="inline"><semantics id="S3.SS2.p4.5.m3.1a"><mrow id="S3.SS2.p4.5.m3.1.1" xref="S3.SS2.p4.5.m3.1.1.cmml"><msub id="S3.SS2.p4.5.m3.1.1.2" xref="S3.SS2.p4.5.m3.1.1.2.cmml"><mi id="S3.SS2.p4.5.m3.1.1.2.2" xref="S3.SS2.p4.5.m3.1.1.2.2.cmml">b</mi><msub id="S3.SS2.p4.5.m3.1.1.2.3" xref="S3.SS2.p4.5.m3.1.1.2.3.cmml"><mi id="S3.SS2.p4.5.m3.1.1.2.3.2" xref="S3.SS2.p4.5.m3.1.1.2.3.2.cmml">E</mi><mn id="S3.SS2.p4.5.m3.1.1.2.3.3" xref="S3.SS2.p4.5.m3.1.1.2.3.3.cmml">2</mn></msub></msub><mo id="S3.SS2.p4.5.m3.1.1.1" xref="S3.SS2.p4.5.m3.1.1.1.cmml">∈</mo><msup id="S3.SS2.p4.5.m3.1.1.3" xref="S3.SS2.p4.5.m3.1.1.3.cmml"><mi id="S3.SS2.p4.5.m3.1.1.3.2" xref="S3.SS2.p4.5.m3.1.1.3.2.cmml">ℝ</mi><mrow id="S3.SS2.p4.5.m3.1.1.3.3" xref="S3.SS2.p4.5.m3.1.1.3.3.cmml"><mi id="S3.SS2.p4.5.m3.1.1.3.3.2" xref="S3.SS2.p4.5.m3.1.1.3.3.2.cmml">L</mi><mo lspace="0.222em" rspace="0.222em" id="S3.SS2.p4.5.m3.1.1.3.3.1" xref="S3.SS2.p4.5.m3.1.1.3.3.1.cmml">×</mo><mi id="S3.SS2.p4.5.m3.1.1.3.3.3" xref="S3.SS2.p4.5.m3.1.1.3.3.3.cmml">N</mi></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p4.5.m3.1b"><apply id="S3.SS2.p4.5.m3.1.1.cmml" xref="S3.SS2.p4.5.m3.1.1"><in id="S3.SS2.p4.5.m3.1.1.1.cmml" xref="S3.SS2.p4.5.m3.1.1.1"></in><apply id="S3.SS2.p4.5.m3.1.1.2.cmml" xref="S3.SS2.p4.5.m3.1.1.2"><csymbol cd="ambiguous" id="S3.SS2.p4.5.m3.1.1.2.1.cmml" xref="S3.SS2.p4.5.m3.1.1.2">subscript</csymbol><ci id="S3.SS2.p4.5.m3.1.1.2.2.cmml" xref="S3.SS2.p4.5.m3.1.1.2.2">𝑏</ci><apply id="S3.SS2.p4.5.m3.1.1.2.3.cmml" xref="S3.SS2.p4.5.m3.1.1.2.3"><csymbol cd="ambiguous" id="S3.SS2.p4.5.m3.1.1.2.3.1.cmml" xref="S3.SS2.p4.5.m3.1.1.2.3">subscript</csymbol><ci id="S3.SS2.p4.5.m3.1.1.2.3.2.cmml" xref="S3.SS2.p4.5.m3.1.1.2.3.2">𝐸</ci><cn type="integer" id="S3.SS2.p4.5.m3.1.1.2.3.3.cmml" xref="S3.SS2.p4.5.m3.1.1.2.3.3">2</cn></apply></apply><apply id="S3.SS2.p4.5.m3.1.1.3.cmml" xref="S3.SS2.p4.5.m3.1.1.3"><csymbol cd="ambiguous" id="S3.SS2.p4.5.m3.1.1.3.1.cmml" xref="S3.SS2.p4.5.m3.1.1.3">superscript</csymbol><ci id="S3.SS2.p4.5.m3.1.1.3.2.cmml" xref="S3.SS2.p4.5.m3.1.1.3.2">ℝ</ci><apply id="S3.SS2.p4.5.m3.1.1.3.3.cmml" xref="S3.SS2.p4.5.m3.1.1.3.3"><times id="S3.SS2.p4.5.m3.1.1.3.3.1.cmml" xref="S3.SS2.p4.5.m3.1.1.3.3.1"></times><ci id="S3.SS2.p4.5.m3.1.1.3.3.2.cmml" xref="S3.SS2.p4.5.m3.1.1.3.3.2">𝐿</ci><ci id="S3.SS2.p4.5.m3.1.1.3.3.3.cmml" xref="S3.SS2.p4.5.m3.1.1.3.3.3">𝑁</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p4.5.m3.1c">b_{E_{2}}\in\mathbb{R}^{L\times N}</annotation></semantics></math> is the bias term.</p>
</div>
<div id="S3.SS2.p5" class="ltx_para">
<p id="S3.SS2.p5.4" class="ltx_p">The final answer <math id="S3.SS2.p5.1.m1.1" class="ltx_Math" alttext="P" display="inline"><semantics id="S3.SS2.p5.1.m1.1a"><mi id="S3.SS2.p5.1.m1.1.1" xref="S3.SS2.p5.1.m1.1.1.cmml">P</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p5.1.m1.1b"><ci id="S3.SS2.p5.1.m1.1.1.cmml" xref="S3.SS2.p5.1.m1.1.1">𝑃</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p5.1.m1.1c">P</annotation></semantics></math> is predicted by combining the whole question representation <math id="S3.SS2.p5.2.m2.1" class="ltx_Math" alttext="Q" display="inline"><semantics id="S3.SS2.p5.2.m2.1a"><mi id="S3.SS2.p5.2.m2.1.1" xref="S3.SS2.p5.2.m2.1.1.cmml">Q</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p5.2.m2.1b"><ci id="S3.SS2.p5.2.m2.1.1.cmml" xref="S3.SS2.p5.2.m2.1.1">𝑄</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p5.2.m2.1c">Q</annotation></semantics></math>, the local visual evidence <math id="S3.SS2.p5.3.m3.1" class="ltx_Math" alttext="S_{att}" display="inline"><semantics id="S3.SS2.p5.3.m3.1a"><msub id="S3.SS2.p5.3.m3.1.1" xref="S3.SS2.p5.3.m3.1.1.cmml"><mi id="S3.SS2.p5.3.m3.1.1.2" xref="S3.SS2.p5.3.m3.1.1.2.cmml">S</mi><mrow id="S3.SS2.p5.3.m3.1.1.3" xref="S3.SS2.p5.3.m3.1.1.3.cmml"><mi id="S3.SS2.p5.3.m3.1.1.3.2" xref="S3.SS2.p5.3.m3.1.1.3.2.cmml">a</mi><mo lspace="0em" rspace="0em" id="S3.SS2.p5.3.m3.1.1.3.1" xref="S3.SS2.p5.3.m3.1.1.3.1.cmml">​</mo><mi id="S3.SS2.p5.3.m3.1.1.3.3" xref="S3.SS2.p5.3.m3.1.1.3.3.cmml">t</mi><mo lspace="0em" rspace="0em" id="S3.SS2.p5.3.m3.1.1.3.1a" xref="S3.SS2.p5.3.m3.1.1.3.1.cmml">​</mo><mi id="S3.SS2.p5.3.m3.1.1.3.4" xref="S3.SS2.p5.3.m3.1.1.3.4.cmml">t</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.p5.3.m3.1b"><apply id="S3.SS2.p5.3.m3.1.1.cmml" xref="S3.SS2.p5.3.m3.1.1"><csymbol cd="ambiguous" id="S3.SS2.p5.3.m3.1.1.1.cmml" xref="S3.SS2.p5.3.m3.1.1">subscript</csymbol><ci id="S3.SS2.p5.3.m3.1.1.2.cmml" xref="S3.SS2.p5.3.m3.1.1.2">𝑆</ci><apply id="S3.SS2.p5.3.m3.1.1.3.cmml" xref="S3.SS2.p5.3.m3.1.1.3"><times id="S3.SS2.p5.3.m3.1.1.3.1.cmml" xref="S3.SS2.p5.3.m3.1.1.3.1"></times><ci id="S3.SS2.p5.3.m3.1.1.3.2.cmml" xref="S3.SS2.p5.3.m3.1.1.3.2">𝑎</ci><ci id="S3.SS2.p5.3.m3.1.1.3.3.cmml" xref="S3.SS2.p5.3.m3.1.1.3.3">𝑡</ci><ci id="S3.SS2.p5.3.m3.1.1.3.4.cmml" xref="S3.SS2.p5.3.m3.1.1.3.4">𝑡</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p5.3.m3.1c">S_{att}</annotation></semantics></math> from each word vector in the first hop and the global visual evidence <math id="S3.SS2.p5.4.m4.1" class="ltx_Math" alttext="S_{att2}" display="inline"><semantics id="S3.SS2.p5.4.m4.1a"><msub id="S3.SS2.p5.4.m4.1.1" xref="S3.SS2.p5.4.m4.1.1.cmml"><mi id="S3.SS2.p5.4.m4.1.1.2" xref="S3.SS2.p5.4.m4.1.1.2.cmml">S</mi><mrow id="S3.SS2.p5.4.m4.1.1.3" xref="S3.SS2.p5.4.m4.1.1.3.cmml"><mi id="S3.SS2.p5.4.m4.1.1.3.2" xref="S3.SS2.p5.4.m4.1.1.3.2.cmml">a</mi><mo lspace="0em" rspace="0em" id="S3.SS2.p5.4.m4.1.1.3.1" xref="S3.SS2.p5.4.m4.1.1.3.1.cmml">​</mo><mi id="S3.SS2.p5.4.m4.1.1.3.3" xref="S3.SS2.p5.4.m4.1.1.3.3.cmml">t</mi><mo lspace="0em" rspace="0em" id="S3.SS2.p5.4.m4.1.1.3.1a" xref="S3.SS2.p5.4.m4.1.1.3.1.cmml">​</mo><mi id="S3.SS2.p5.4.m4.1.1.3.4" xref="S3.SS2.p5.4.m4.1.1.3.4.cmml">t</mi><mo lspace="0em" rspace="0em" id="S3.SS2.p5.4.m4.1.1.3.1b" xref="S3.SS2.p5.4.m4.1.1.3.1.cmml">​</mo><mn id="S3.SS2.p5.4.m4.1.1.3.5" xref="S3.SS2.p5.4.m4.1.1.3.5.cmml">2</mn></mrow></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.p5.4.m4.1b"><apply id="S3.SS2.p5.4.m4.1.1.cmml" xref="S3.SS2.p5.4.m4.1.1"><csymbol cd="ambiguous" id="S3.SS2.p5.4.m4.1.1.1.cmml" xref="S3.SS2.p5.4.m4.1.1">subscript</csymbol><ci id="S3.SS2.p5.4.m4.1.1.2.cmml" xref="S3.SS2.p5.4.m4.1.1.2">𝑆</ci><apply id="S3.SS2.p5.4.m4.1.1.3.cmml" xref="S3.SS2.p5.4.m4.1.1.3"><times id="S3.SS2.p5.4.m4.1.1.3.1.cmml" xref="S3.SS2.p5.4.m4.1.1.3.1"></times><ci id="S3.SS2.p5.4.m4.1.1.3.2.cmml" xref="S3.SS2.p5.4.m4.1.1.3.2">𝑎</ci><ci id="S3.SS2.p5.4.m4.1.1.3.3.cmml" xref="S3.SS2.p5.4.m4.1.1.3.3">𝑡</ci><ci id="S3.SS2.p5.4.m4.1.1.3.4.cmml" xref="S3.SS2.p5.4.m4.1.1.3.4">𝑡</ci><cn type="integer" id="S3.SS2.p5.4.m4.1.1.3.5.cmml" xref="S3.SS2.p5.4.m4.1.1.3.5">2</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p5.4.m4.1c">S_{att2}</annotation></semantics></math> from the whole question in the second hop,</p>
<table id="S3.E10" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S3.E10.m1.2" class="ltx_Math" alttext="P=\operatorname{softmax}(W_{P}\cdot f(O_{hop1}+S_{att2})+b_{P})" display="block"><semantics id="S3.E10.m1.2a"><mrow id="S3.E10.m1.2.2" xref="S3.E10.m1.2.2.cmml"><mi id="S3.E10.m1.2.2.3" xref="S3.E10.m1.2.2.3.cmml">P</mi><mo id="S3.E10.m1.2.2.2" xref="S3.E10.m1.2.2.2.cmml">=</mo><mrow id="S3.E10.m1.2.2.1.1" xref="S3.E10.m1.2.2.1.2.cmml"><mi id="S3.E10.m1.1.1" xref="S3.E10.m1.1.1.cmml">softmax</mi><mo id="S3.E10.m1.2.2.1.1a" xref="S3.E10.m1.2.2.1.2.cmml">⁡</mo><mrow id="S3.E10.m1.2.2.1.1.1" xref="S3.E10.m1.2.2.1.2.cmml"><mo stretchy="false" id="S3.E10.m1.2.2.1.1.1.2" xref="S3.E10.m1.2.2.1.2.cmml">(</mo><mrow id="S3.E10.m1.2.2.1.1.1.1" xref="S3.E10.m1.2.2.1.1.1.1.cmml"><mrow id="S3.E10.m1.2.2.1.1.1.1.1" xref="S3.E10.m1.2.2.1.1.1.1.1.cmml"><mrow id="S3.E10.m1.2.2.1.1.1.1.1.3" xref="S3.E10.m1.2.2.1.1.1.1.1.3.cmml"><msub id="S3.E10.m1.2.2.1.1.1.1.1.3.2" xref="S3.E10.m1.2.2.1.1.1.1.1.3.2.cmml"><mi id="S3.E10.m1.2.2.1.1.1.1.1.3.2.2" xref="S3.E10.m1.2.2.1.1.1.1.1.3.2.2.cmml">W</mi><mi id="S3.E10.m1.2.2.1.1.1.1.1.3.2.3" xref="S3.E10.m1.2.2.1.1.1.1.1.3.2.3.cmml">P</mi></msub><mo lspace="0.222em" rspace="0.222em" id="S3.E10.m1.2.2.1.1.1.1.1.3.1" xref="S3.E10.m1.2.2.1.1.1.1.1.3.1.cmml">⋅</mo><mi id="S3.E10.m1.2.2.1.1.1.1.1.3.3" xref="S3.E10.m1.2.2.1.1.1.1.1.3.3.cmml">f</mi></mrow><mo lspace="0em" rspace="0em" id="S3.E10.m1.2.2.1.1.1.1.1.2" xref="S3.E10.m1.2.2.1.1.1.1.1.2.cmml">​</mo><mrow id="S3.E10.m1.2.2.1.1.1.1.1.1.1" xref="S3.E10.m1.2.2.1.1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S3.E10.m1.2.2.1.1.1.1.1.1.1.2" xref="S3.E10.m1.2.2.1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="S3.E10.m1.2.2.1.1.1.1.1.1.1.1" xref="S3.E10.m1.2.2.1.1.1.1.1.1.1.1.cmml"><msub id="S3.E10.m1.2.2.1.1.1.1.1.1.1.1.2" xref="S3.E10.m1.2.2.1.1.1.1.1.1.1.1.2.cmml"><mi id="S3.E10.m1.2.2.1.1.1.1.1.1.1.1.2.2" xref="S3.E10.m1.2.2.1.1.1.1.1.1.1.1.2.2.cmml">O</mi><mrow id="S3.E10.m1.2.2.1.1.1.1.1.1.1.1.2.3" xref="S3.E10.m1.2.2.1.1.1.1.1.1.1.1.2.3.cmml"><mi id="S3.E10.m1.2.2.1.1.1.1.1.1.1.1.2.3.2" xref="S3.E10.m1.2.2.1.1.1.1.1.1.1.1.2.3.2.cmml">h</mi><mo lspace="0em" rspace="0em" id="S3.E10.m1.2.2.1.1.1.1.1.1.1.1.2.3.1" xref="S3.E10.m1.2.2.1.1.1.1.1.1.1.1.2.3.1.cmml">​</mo><mi id="S3.E10.m1.2.2.1.1.1.1.1.1.1.1.2.3.3" xref="S3.E10.m1.2.2.1.1.1.1.1.1.1.1.2.3.3.cmml">o</mi><mo lspace="0em" rspace="0em" id="S3.E10.m1.2.2.1.1.1.1.1.1.1.1.2.3.1a" xref="S3.E10.m1.2.2.1.1.1.1.1.1.1.1.2.3.1.cmml">​</mo><mi id="S3.E10.m1.2.2.1.1.1.1.1.1.1.1.2.3.4" xref="S3.E10.m1.2.2.1.1.1.1.1.1.1.1.2.3.4.cmml">p</mi><mo lspace="0em" rspace="0em" id="S3.E10.m1.2.2.1.1.1.1.1.1.1.1.2.3.1b" xref="S3.E10.m1.2.2.1.1.1.1.1.1.1.1.2.3.1.cmml">​</mo><mn id="S3.E10.m1.2.2.1.1.1.1.1.1.1.1.2.3.5" xref="S3.E10.m1.2.2.1.1.1.1.1.1.1.1.2.3.5.cmml">1</mn></mrow></msub><mo id="S3.E10.m1.2.2.1.1.1.1.1.1.1.1.1" xref="S3.E10.m1.2.2.1.1.1.1.1.1.1.1.1.cmml">+</mo><msub id="S3.E10.m1.2.2.1.1.1.1.1.1.1.1.3" xref="S3.E10.m1.2.2.1.1.1.1.1.1.1.1.3.cmml"><mi id="S3.E10.m1.2.2.1.1.1.1.1.1.1.1.3.2" xref="S3.E10.m1.2.2.1.1.1.1.1.1.1.1.3.2.cmml">S</mi><mrow id="S3.E10.m1.2.2.1.1.1.1.1.1.1.1.3.3" xref="S3.E10.m1.2.2.1.1.1.1.1.1.1.1.3.3.cmml"><mi id="S3.E10.m1.2.2.1.1.1.1.1.1.1.1.3.3.2" xref="S3.E10.m1.2.2.1.1.1.1.1.1.1.1.3.3.2.cmml">a</mi><mo lspace="0em" rspace="0em" id="S3.E10.m1.2.2.1.1.1.1.1.1.1.1.3.3.1" xref="S3.E10.m1.2.2.1.1.1.1.1.1.1.1.3.3.1.cmml">​</mo><mi id="S3.E10.m1.2.2.1.1.1.1.1.1.1.1.3.3.3" xref="S3.E10.m1.2.2.1.1.1.1.1.1.1.1.3.3.3.cmml">t</mi><mo lspace="0em" rspace="0em" id="S3.E10.m1.2.2.1.1.1.1.1.1.1.1.3.3.1a" xref="S3.E10.m1.2.2.1.1.1.1.1.1.1.1.3.3.1.cmml">​</mo><mi id="S3.E10.m1.2.2.1.1.1.1.1.1.1.1.3.3.4" xref="S3.E10.m1.2.2.1.1.1.1.1.1.1.1.3.3.4.cmml">t</mi><mo lspace="0em" rspace="0em" id="S3.E10.m1.2.2.1.1.1.1.1.1.1.1.3.3.1b" xref="S3.E10.m1.2.2.1.1.1.1.1.1.1.1.3.3.1.cmml">​</mo><mn id="S3.E10.m1.2.2.1.1.1.1.1.1.1.1.3.3.5" xref="S3.E10.m1.2.2.1.1.1.1.1.1.1.1.3.3.5.cmml">2</mn></mrow></msub></mrow><mo stretchy="false" id="S3.E10.m1.2.2.1.1.1.1.1.1.1.3" xref="S3.E10.m1.2.2.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S3.E10.m1.2.2.1.1.1.1.2" xref="S3.E10.m1.2.2.1.1.1.1.2.cmml">+</mo><msub id="S3.E10.m1.2.2.1.1.1.1.3" xref="S3.E10.m1.2.2.1.1.1.1.3.cmml"><mi id="S3.E10.m1.2.2.1.1.1.1.3.2" xref="S3.E10.m1.2.2.1.1.1.1.3.2.cmml">b</mi><mi id="S3.E10.m1.2.2.1.1.1.1.3.3" xref="S3.E10.m1.2.2.1.1.1.1.3.3.cmml">P</mi></msub></mrow><mo stretchy="false" id="S3.E10.m1.2.2.1.1.1.3" xref="S3.E10.m1.2.2.1.2.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.E10.m1.2b"><apply id="S3.E10.m1.2.2.cmml" xref="S3.E10.m1.2.2"><eq id="S3.E10.m1.2.2.2.cmml" xref="S3.E10.m1.2.2.2"></eq><ci id="S3.E10.m1.2.2.3.cmml" xref="S3.E10.m1.2.2.3">𝑃</ci><apply id="S3.E10.m1.2.2.1.2.cmml" xref="S3.E10.m1.2.2.1.1"><ci id="S3.E10.m1.1.1.cmml" xref="S3.E10.m1.1.1">softmax</ci><apply id="S3.E10.m1.2.2.1.1.1.1.cmml" xref="S3.E10.m1.2.2.1.1.1.1"><plus id="S3.E10.m1.2.2.1.1.1.1.2.cmml" xref="S3.E10.m1.2.2.1.1.1.1.2"></plus><apply id="S3.E10.m1.2.2.1.1.1.1.1.cmml" xref="S3.E10.m1.2.2.1.1.1.1.1"><times id="S3.E10.m1.2.2.1.1.1.1.1.2.cmml" xref="S3.E10.m1.2.2.1.1.1.1.1.2"></times><apply id="S3.E10.m1.2.2.1.1.1.1.1.3.cmml" xref="S3.E10.m1.2.2.1.1.1.1.1.3"><ci id="S3.E10.m1.2.2.1.1.1.1.1.3.1.cmml" xref="S3.E10.m1.2.2.1.1.1.1.1.3.1">⋅</ci><apply id="S3.E10.m1.2.2.1.1.1.1.1.3.2.cmml" xref="S3.E10.m1.2.2.1.1.1.1.1.3.2"><csymbol cd="ambiguous" id="S3.E10.m1.2.2.1.1.1.1.1.3.2.1.cmml" xref="S3.E10.m1.2.2.1.1.1.1.1.3.2">subscript</csymbol><ci id="S3.E10.m1.2.2.1.1.1.1.1.3.2.2.cmml" xref="S3.E10.m1.2.2.1.1.1.1.1.3.2.2">𝑊</ci><ci id="S3.E10.m1.2.2.1.1.1.1.1.3.2.3.cmml" xref="S3.E10.m1.2.2.1.1.1.1.1.3.2.3">𝑃</ci></apply><ci id="S3.E10.m1.2.2.1.1.1.1.1.3.3.cmml" xref="S3.E10.m1.2.2.1.1.1.1.1.3.3">𝑓</ci></apply><apply id="S3.E10.m1.2.2.1.1.1.1.1.1.1.1.cmml" xref="S3.E10.m1.2.2.1.1.1.1.1.1.1"><plus id="S3.E10.m1.2.2.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E10.m1.2.2.1.1.1.1.1.1.1.1.1"></plus><apply id="S3.E10.m1.2.2.1.1.1.1.1.1.1.1.2.cmml" xref="S3.E10.m1.2.2.1.1.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.E10.m1.2.2.1.1.1.1.1.1.1.1.2.1.cmml" xref="S3.E10.m1.2.2.1.1.1.1.1.1.1.1.2">subscript</csymbol><ci id="S3.E10.m1.2.2.1.1.1.1.1.1.1.1.2.2.cmml" xref="S3.E10.m1.2.2.1.1.1.1.1.1.1.1.2.2">𝑂</ci><apply id="S3.E10.m1.2.2.1.1.1.1.1.1.1.1.2.3.cmml" xref="S3.E10.m1.2.2.1.1.1.1.1.1.1.1.2.3"><times id="S3.E10.m1.2.2.1.1.1.1.1.1.1.1.2.3.1.cmml" xref="S3.E10.m1.2.2.1.1.1.1.1.1.1.1.2.3.1"></times><ci id="S3.E10.m1.2.2.1.1.1.1.1.1.1.1.2.3.2.cmml" xref="S3.E10.m1.2.2.1.1.1.1.1.1.1.1.2.3.2">ℎ</ci><ci id="S3.E10.m1.2.2.1.1.1.1.1.1.1.1.2.3.3.cmml" xref="S3.E10.m1.2.2.1.1.1.1.1.1.1.1.2.3.3">𝑜</ci><ci id="S3.E10.m1.2.2.1.1.1.1.1.1.1.1.2.3.4.cmml" xref="S3.E10.m1.2.2.1.1.1.1.1.1.1.1.2.3.4">𝑝</ci><cn type="integer" id="S3.E10.m1.2.2.1.1.1.1.1.1.1.1.2.3.5.cmml" xref="S3.E10.m1.2.2.1.1.1.1.1.1.1.1.2.3.5">1</cn></apply></apply><apply id="S3.E10.m1.2.2.1.1.1.1.1.1.1.1.3.cmml" xref="S3.E10.m1.2.2.1.1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.E10.m1.2.2.1.1.1.1.1.1.1.1.3.1.cmml" xref="S3.E10.m1.2.2.1.1.1.1.1.1.1.1.3">subscript</csymbol><ci id="S3.E10.m1.2.2.1.1.1.1.1.1.1.1.3.2.cmml" xref="S3.E10.m1.2.2.1.1.1.1.1.1.1.1.3.2">𝑆</ci><apply id="S3.E10.m1.2.2.1.1.1.1.1.1.1.1.3.3.cmml" xref="S3.E10.m1.2.2.1.1.1.1.1.1.1.1.3.3"><times id="S3.E10.m1.2.2.1.1.1.1.1.1.1.1.3.3.1.cmml" xref="S3.E10.m1.2.2.1.1.1.1.1.1.1.1.3.3.1"></times><ci id="S3.E10.m1.2.2.1.1.1.1.1.1.1.1.3.3.2.cmml" xref="S3.E10.m1.2.2.1.1.1.1.1.1.1.1.3.3.2">𝑎</ci><ci id="S3.E10.m1.2.2.1.1.1.1.1.1.1.1.3.3.3.cmml" xref="S3.E10.m1.2.2.1.1.1.1.1.1.1.1.3.3.3">𝑡</ci><ci id="S3.E10.m1.2.2.1.1.1.1.1.1.1.1.3.3.4.cmml" xref="S3.E10.m1.2.2.1.1.1.1.1.1.1.1.3.3.4">𝑡</ci><cn type="integer" id="S3.E10.m1.2.2.1.1.1.1.1.1.1.1.3.3.5.cmml" xref="S3.E10.m1.2.2.1.1.1.1.1.1.1.1.3.3.5">2</cn></apply></apply></apply></apply><apply id="S3.E10.m1.2.2.1.1.1.1.3.cmml" xref="S3.E10.m1.2.2.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.E10.m1.2.2.1.1.1.1.3.1.cmml" xref="S3.E10.m1.2.2.1.1.1.1.3">subscript</csymbol><ci id="S3.E10.m1.2.2.1.1.1.1.3.2.cmml" xref="S3.E10.m1.2.2.1.1.1.1.3.2">𝑏</ci><ci id="S3.E10.m1.2.2.1.1.1.1.3.3.cmml" xref="S3.E10.m1.2.2.1.1.1.1.3.3">𝑃</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E10.m1.2c">P=\operatorname{softmax}(W_{P}\cdot f(O_{hop1}+S_{att2})+b_{P})</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(10)</span></td>
</tr></tbody>
</table>
<p id="S3.SS2.p5.8" class="ltx_p">where <math id="S3.SS2.p5.5.m1.1" class="ltx_Math" alttext="W_{P}\in\mathbb{R}^{K\times N}" display="inline"><semantics id="S3.SS2.p5.5.m1.1a"><mrow id="S3.SS2.p5.5.m1.1.1" xref="S3.SS2.p5.5.m1.1.1.cmml"><msub id="S3.SS2.p5.5.m1.1.1.2" xref="S3.SS2.p5.5.m1.1.1.2.cmml"><mi id="S3.SS2.p5.5.m1.1.1.2.2" xref="S3.SS2.p5.5.m1.1.1.2.2.cmml">W</mi><mi id="S3.SS2.p5.5.m1.1.1.2.3" xref="S3.SS2.p5.5.m1.1.1.2.3.cmml">P</mi></msub><mo id="S3.SS2.p5.5.m1.1.1.1" xref="S3.SS2.p5.5.m1.1.1.1.cmml">∈</mo><msup id="S3.SS2.p5.5.m1.1.1.3" xref="S3.SS2.p5.5.m1.1.1.3.cmml"><mi id="S3.SS2.p5.5.m1.1.1.3.2" xref="S3.SS2.p5.5.m1.1.1.3.2.cmml">ℝ</mi><mrow id="S3.SS2.p5.5.m1.1.1.3.3" xref="S3.SS2.p5.5.m1.1.1.3.3.cmml"><mi id="S3.SS2.p5.5.m1.1.1.3.3.2" xref="S3.SS2.p5.5.m1.1.1.3.3.2.cmml">K</mi><mo lspace="0.222em" rspace="0.222em" id="S3.SS2.p5.5.m1.1.1.3.3.1" xref="S3.SS2.p5.5.m1.1.1.3.3.1.cmml">×</mo><mi id="S3.SS2.p5.5.m1.1.1.3.3.3" xref="S3.SS2.p5.5.m1.1.1.3.3.3.cmml">N</mi></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p5.5.m1.1b"><apply id="S3.SS2.p5.5.m1.1.1.cmml" xref="S3.SS2.p5.5.m1.1.1"><in id="S3.SS2.p5.5.m1.1.1.1.cmml" xref="S3.SS2.p5.5.m1.1.1.1"></in><apply id="S3.SS2.p5.5.m1.1.1.2.cmml" xref="S3.SS2.p5.5.m1.1.1.2"><csymbol cd="ambiguous" id="S3.SS2.p5.5.m1.1.1.2.1.cmml" xref="S3.SS2.p5.5.m1.1.1.2">subscript</csymbol><ci id="S3.SS2.p5.5.m1.1.1.2.2.cmml" xref="S3.SS2.p5.5.m1.1.1.2.2">𝑊</ci><ci id="S3.SS2.p5.5.m1.1.1.2.3.cmml" xref="S3.SS2.p5.5.m1.1.1.2.3">𝑃</ci></apply><apply id="S3.SS2.p5.5.m1.1.1.3.cmml" xref="S3.SS2.p5.5.m1.1.1.3"><csymbol cd="ambiguous" id="S3.SS2.p5.5.m1.1.1.3.1.cmml" xref="S3.SS2.p5.5.m1.1.1.3">superscript</csymbol><ci id="S3.SS2.p5.5.m1.1.1.3.2.cmml" xref="S3.SS2.p5.5.m1.1.1.3.2">ℝ</ci><apply id="S3.SS2.p5.5.m1.1.1.3.3.cmml" xref="S3.SS2.p5.5.m1.1.1.3.3"><times id="S3.SS2.p5.5.m1.1.1.3.3.1.cmml" xref="S3.SS2.p5.5.m1.1.1.3.3.1"></times><ci id="S3.SS2.p5.5.m1.1.1.3.3.2.cmml" xref="S3.SS2.p5.5.m1.1.1.3.3.2">𝐾</ci><ci id="S3.SS2.p5.5.m1.1.1.3.3.3.cmml" xref="S3.SS2.p5.5.m1.1.1.3.3.3">𝑁</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p5.5.m1.1c">W_{P}\in\mathbb{R}^{K\times N}</annotation></semantics></math>, bias term <math id="S3.SS2.p5.6.m2.1" class="ltx_Math" alttext="b_{P}\in\mathbb{R}^{K}" display="inline"><semantics id="S3.SS2.p5.6.m2.1a"><mrow id="S3.SS2.p5.6.m2.1.1" xref="S3.SS2.p5.6.m2.1.1.cmml"><msub id="S3.SS2.p5.6.m2.1.1.2" xref="S3.SS2.p5.6.m2.1.1.2.cmml"><mi id="S3.SS2.p5.6.m2.1.1.2.2" xref="S3.SS2.p5.6.m2.1.1.2.2.cmml">b</mi><mi id="S3.SS2.p5.6.m2.1.1.2.3" xref="S3.SS2.p5.6.m2.1.1.2.3.cmml">P</mi></msub><mo id="S3.SS2.p5.6.m2.1.1.1" xref="S3.SS2.p5.6.m2.1.1.1.cmml">∈</mo><msup id="S3.SS2.p5.6.m2.1.1.3" xref="S3.SS2.p5.6.m2.1.1.3.cmml"><mi id="S3.SS2.p5.6.m2.1.1.3.2" xref="S3.SS2.p5.6.m2.1.1.3.2.cmml">ℝ</mi><mi id="S3.SS2.p5.6.m2.1.1.3.3" xref="S3.SS2.p5.6.m2.1.1.3.3.cmml">K</mi></msup></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p5.6.m2.1b"><apply id="S3.SS2.p5.6.m2.1.1.cmml" xref="S3.SS2.p5.6.m2.1.1"><in id="S3.SS2.p5.6.m2.1.1.1.cmml" xref="S3.SS2.p5.6.m2.1.1.1"></in><apply id="S3.SS2.p5.6.m2.1.1.2.cmml" xref="S3.SS2.p5.6.m2.1.1.2"><csymbol cd="ambiguous" id="S3.SS2.p5.6.m2.1.1.2.1.cmml" xref="S3.SS2.p5.6.m2.1.1.2">subscript</csymbol><ci id="S3.SS2.p5.6.m2.1.1.2.2.cmml" xref="S3.SS2.p5.6.m2.1.1.2.2">𝑏</ci><ci id="S3.SS2.p5.6.m2.1.1.2.3.cmml" xref="S3.SS2.p5.6.m2.1.1.2.3">𝑃</ci></apply><apply id="S3.SS2.p5.6.m2.1.1.3.cmml" xref="S3.SS2.p5.6.m2.1.1.3"><csymbol cd="ambiguous" id="S3.SS2.p5.6.m2.1.1.3.1.cmml" xref="S3.SS2.p5.6.m2.1.1.3">superscript</csymbol><ci id="S3.SS2.p5.6.m2.1.1.3.2.cmml" xref="S3.SS2.p5.6.m2.1.1.3.2">ℝ</ci><ci id="S3.SS2.p5.6.m2.1.1.3.3.cmml" xref="S3.SS2.p5.6.m2.1.1.3.3">𝐾</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p5.6.m2.1c">b_{P}\in\mathbb{R}^{K}</annotation></semantics></math>, and <math id="S3.SS2.p5.7.m3.1" class="ltx_Math" alttext="K" display="inline"><semantics id="S3.SS2.p5.7.m3.1a"><mi id="S3.SS2.p5.7.m3.1.1" xref="S3.SS2.p5.7.m3.1.1.cmml">K</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p5.7.m3.1b"><ci id="S3.SS2.p5.7.m3.1.1.cmml" xref="S3.SS2.p5.7.m3.1.1">𝐾</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p5.7.m3.1c">K</annotation></semantics></math> represents the number of possible prediction answers. <math id="S3.SS2.p5.8.m4.1" class="ltx_Math" alttext="f" display="inline"><semantics id="S3.SS2.p5.8.m4.1a"><mi id="S3.SS2.p5.8.m4.1.1" xref="S3.SS2.p5.8.m4.1.1.cmml">f</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p5.8.m4.1b"><ci id="S3.SS2.p5.8.m4.1.1.cmml" xref="S3.SS2.p5.8.m4.1.1">𝑓</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p5.8.m4.1c">f</annotation></semantics></math> is activation function. More hops can be added in this manner.</p>
</div>
<div id="S3.SS2.p6" class="ltx_para">
<p id="S3.SS2.p6.1" class="ltx_p">The entire network is differentiable and is trained using stochastic gradient descent via standard backpropagation, allowing image feature extraction, image embedding, word embedding and answer prediction to be jointly optimized on the training image/question/answer triples.</p>
</div>
</section>
</section>
<section id="S4" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">4 </span>Experiments</h2>

<div id="S4.p1" class="ltx_para">
<p id="S4.p1.1" class="ltx_p">In this section, we conduct a series of experiments to evaluate our model.
To explore whether the model learns to perform the spatial inference necessary for answering visual questions that explicitly require spatial reasoning, we design a set of experiments using synthetic visual question/answer data in Sec. <a href="#S4.SS1" title="4.1 Exploring Attention on Synthetic Data ‣ 4 Experiments ‣ Ask, Attend and Answer: Exploring Question-Guided Spatial Attention for Visual Question Answering" class="ltx_ref"><span class="ltx_text ltx_ref_tag">4.1</span></a>. The experimental results of our model in standard datasets (DAQUAR <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib1" title="" class="ltx_ref">1</a>]</cite> and VQA <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib2" title="" class="ltx_ref">2</a>]</cite> datasets) are reported in Sec. <a href="#S4.SS2" title="4.2 Experiments on Standard Datasets ‣ 4 Experiments ‣ Ask, Attend and Answer: Exploring Question-Guided Spatial Attention for Visual Question Answering" class="ltx_ref"><span class="ltx_text ltx_ref_tag">4.2</span></a>.</p>
</div>
<section id="S4.SS1" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.1 </span>Exploring Attention on Synthetic Data</h3>

<div id="S4.SS1.p1" class="ltx_para">
<p id="S4.SS1.p1.1" class="ltx_p">The questions in the public VQA datasets are quite varied and difficult and often require common sense knowledge to answer (e.g., “Does this man have 20/20 vision?” about a person wearing glasses). Furthermore, past work <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib10" title="" class="ltx_ref">10</a>, <a href="#bib.bib11" title="" class="ltx_ref">11</a>]</cite> showed that the question text alone (no image) is a very strong predictor of the answer.
Therefore, before evaluating on standard datasets, we would first like to
understand how the proposed model uses spatial attention to answer simple visual questions where the answer cannot be predicted from question alone.
Our visualization demonstrates that the attention mechanism does learn to attend to objects and gather evidence via certain inference rules.</p>
</div>
<figure id="S4.F3" class="ltx_figure">
<div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_4"><img src="/html/1511.05234/assets/x4.jpeg" id="S4.F3.g1" class="ltx_graphics ltx_figure_panel ltx_img_landscape" width="161" height="100" alt="Refer to caption"></div>
<div class="ltx_flex_cell ltx_flex_size_4"><img src="/html/1511.05234/assets/x5.jpeg" id="S4.F3.g2" class="ltx_graphics ltx_figure_panel ltx_img_landscape" width="161" height="100" alt="Refer to caption"></div>
<div class="ltx_flex_cell ltx_flex_size_4"><img src="/html/1511.05234/assets/x6.jpeg" id="S4.F3.g3" class="ltx_graphics ltx_figure_panel ltx_img_landscape" width="161" height="100" alt="Refer to caption"></div>
<div class="ltx_flex_cell ltx_flex_size_4"><img src="/html/1511.05234/assets/x7.jpeg" id="S4.F3.g4" class="ltx_graphics ltx_figure_panel ltx_img_landscape" width="161" height="100" alt="Refer to caption"></div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_4"><img src="/html/1511.05234/assets/x8.jpeg" id="S4.F3.g5" class="ltx_graphics ltx_figure_panel ltx_img_landscape" width="161" height="100" alt="Refer to caption"></div>
<div class="ltx_flex_cell ltx_flex_size_4"><img src="/html/1511.05234/assets/x9.jpeg" id="S4.F3.g6" class="ltx_graphics ltx_figure_panel ltx_img_landscape" width="161" height="100" alt="Refer to caption"></div>
<div class="ltx_flex_cell ltx_flex_size_4"><img src="/html/1511.05234/assets/x10.jpeg" id="S4.F3.g7" class="ltx_graphics ltx_figure_panel ltx_img_landscape" width="161" height="100" alt="Refer to caption"></div>
<div class="ltx_flex_cell ltx_flex_size_4"><img src="/html/1511.05234/assets/x11.jpeg" id="S4.F3.g8" class="ltx_graphics ltx_figure_panel ltx_img_landscape" width="161" height="100" alt="Refer to caption"></div>
</div>
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure">Figure 3: </span><span id="S4.F3.10.1" class="ltx_text ltx_font_bold">Absolute position experiment:</span> for each image and question pair, we show the original image (left) and the attention weights <math id="S4.F3.5.m1.1" class="ltx_Math" alttext="W_{att}" display="inline"><semantics id="S4.F3.5.m1.1b"><msub id="S4.F3.5.m1.1.1" xref="S4.F3.5.m1.1.1.cmml"><mi id="S4.F3.5.m1.1.1.2" xref="S4.F3.5.m1.1.1.2.cmml">W</mi><mrow id="S4.F3.5.m1.1.1.3" xref="S4.F3.5.m1.1.1.3.cmml"><mi id="S4.F3.5.m1.1.1.3.2" xref="S4.F3.5.m1.1.1.3.2.cmml">a</mi><mo lspace="0em" rspace="0em" id="S4.F3.5.m1.1.1.3.1" xref="S4.F3.5.m1.1.1.3.1.cmml">​</mo><mi id="S4.F3.5.m1.1.1.3.3" xref="S4.F3.5.m1.1.1.3.3.cmml">t</mi><mo lspace="0em" rspace="0em" id="S4.F3.5.m1.1.1.3.1b" xref="S4.F3.5.m1.1.1.3.1.cmml">​</mo><mi id="S4.F3.5.m1.1.1.3.4" xref="S4.F3.5.m1.1.1.3.4.cmml">t</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S4.F3.5.m1.1c"><apply id="S4.F3.5.m1.1.1.cmml" xref="S4.F3.5.m1.1.1"><csymbol cd="ambiguous" id="S4.F3.5.m1.1.1.1.cmml" xref="S4.F3.5.m1.1.1">subscript</csymbol><ci id="S4.F3.5.m1.1.1.2.cmml" xref="S4.F3.5.m1.1.1.2">𝑊</ci><apply id="S4.F3.5.m1.1.1.3.cmml" xref="S4.F3.5.m1.1.1.3"><times id="S4.F3.5.m1.1.1.3.1.cmml" xref="S4.F3.5.m1.1.1.3.1"></times><ci id="S4.F3.5.m1.1.1.3.2.cmml" xref="S4.F3.5.m1.1.1.3.2">𝑎</ci><ci id="S4.F3.5.m1.1.1.3.3.cmml" xref="S4.F3.5.m1.1.1.3.3">𝑡</ci><ci id="S4.F3.5.m1.1.1.3.4.cmml" xref="S4.F3.5.m1.1.1.3.4">𝑡</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.F3.5.m1.1d">W_{att}</annotation></semantics></math> (right).
The attention follows the following rules. The first rule (top row) looks at the position specified in question (top<math id="S4.F3.6.m2.1" class="ltx_Math" alttext="\mid" display="inline"><semantics id="S4.F3.6.m2.1b"><mo id="S4.F3.6.m2.1.1" xref="S4.F3.6.m2.1.1.cmml">∣</mo><annotation-xml encoding="MathML-Content" id="S4.F3.6.m2.1c"><ci id="S4.F3.6.m2.1.1.cmml" xref="S4.F3.6.m2.1.1">∣</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.F3.6.m2.1d">\mid</annotation></semantics></math>bottom<math id="S4.F3.7.m3.1" class="ltx_Math" alttext="\mid" display="inline"><semantics id="S4.F3.7.m3.1b"><mo id="S4.F3.7.m3.1.1" xref="S4.F3.7.m3.1.1.cmml">∣</mo><annotation-xml encoding="MathML-Content" id="S4.F3.7.m3.1c"><ci id="S4.F3.7.m3.1.1.cmml" xref="S4.F3.7.m3.1.1">∣</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.F3.7.m3.1d">\mid</annotation></semantics></math>right<math id="S4.F3.8.m4.1" class="ltx_Math" alttext="\mid" display="inline"><semantics id="S4.F3.8.m4.1b"><mo id="S4.F3.8.m4.1.1" xref="S4.F3.8.m4.1.1.cmml">∣</mo><annotation-xml encoding="MathML-Content" id="S4.F3.8.m4.1c"><ci id="S4.F3.8.m4.1.1.cmml" xref="S4.F3.8.m4.1.1">∣</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.F3.8.m4.1d">\mid</annotation></semantics></math>left), if it contains a square, answer “yes”; otherwise answer “no”.
The second rule (bottom row) looks at the region where there is a square, and answers “yes” if the question contains that position and “no” for the other three positions.</figcaption>
</figure>
<section id="S4.SS1.SSS1" class="ltx_subsubsection">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">4.1.1 </span>Absolute Position Recognition</h4>

<div id="S4.SS1.SSS1.p1" class="ltx_para">
<p id="S4.SS1.SSS1.p1.3" class="ltx_p">We investigate whether the model has the ability to recognize the absolute location of the object in the image. We explore this by designing a simple task where an object (a red square) appears in some region of a white-background image, and the question is “Is there a red square on the [top<math id="S4.SS1.SSS1.p1.1.m1.1" class="ltx_Math" alttext="\mid" display="inline"><semantics id="S4.SS1.SSS1.p1.1.m1.1a"><mo id="S4.SS1.SSS1.p1.1.m1.1.1" xref="S4.SS1.SSS1.p1.1.m1.1.1.cmml">∣</mo><annotation-xml encoding="MathML-Content" id="S4.SS1.SSS1.p1.1.m1.1b"><ci id="S4.SS1.SSS1.p1.1.m1.1.1.cmml" xref="S4.SS1.SSS1.p1.1.m1.1.1">∣</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSS1.p1.1.m1.1c">\mid</annotation></semantics></math>bottom<math id="S4.SS1.SSS1.p1.2.m2.1" class="ltx_Math" alttext="\mid" display="inline"><semantics id="S4.SS1.SSS1.p1.2.m2.1a"><mo id="S4.SS1.SSS1.p1.2.m2.1.1" xref="S4.SS1.SSS1.p1.2.m2.1.1.cmml">∣</mo><annotation-xml encoding="MathML-Content" id="S4.SS1.SSS1.p1.2.m2.1b"><ci id="S4.SS1.SSS1.p1.2.m2.1.1.cmml" xref="S4.SS1.SSS1.p1.2.m2.1.1">∣</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSS1.p1.2.m2.1c">\mid</annotation></semantics></math>left<math id="S4.SS1.SSS1.p1.3.m3.1" class="ltx_Math" alttext="\mid" display="inline"><semantics id="S4.SS1.SSS1.p1.3.m3.1a"><mo id="S4.SS1.SSS1.p1.3.m3.1.1" xref="S4.SS1.SSS1.p1.3.m3.1.1.cmml">∣</mo><annotation-xml encoding="MathML-Content" id="S4.SS1.SSS1.p1.3.m3.1b"><ci id="S4.SS1.SSS1.p1.3.m3.1.1.cmml" xref="S4.SS1.SSS1.p1.3.m3.1.1">∣</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSS1.p1.3.m3.1c">\mid</annotation></semantics></math>right]?” For each image, we randomly place the square in one of the four regions, and generate the four questions above, together with three “no” answers and one “yes” answer. The generated data is split into training and testing sets.</p>
</div>
<div id="S4.SS1.SSS1.p2" class="ltx_para">
<p id="S4.SS1.SSS1.p2.4" class="ltx_p">Due to the simplicity of this synthetic dataset, the SMem-VQA one-hop model achieves 100% test accuracy. However, the baseline model (iBOWIMG) <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib3" title="" class="ltx_ref">3</a>]</cite> cannot infer the answer and only obtains accuracy of around 75%, which is the prior probability of the answer “no” in the training set. The SMem-VQA one-hop model is equivalent to the iBOWIMG model if the attention weights in our one-hop model are set equally for each location, since the iBOWIMG model uses the mean pool of the convolutional feature (<math id="S4.SS1.SSS1.p2.1.m1.1" class="ltx_Math" alttext="inception\_5b/output" display="inline"><semantics id="S4.SS1.SSS1.p2.1.m1.1a"><mrow id="S4.SS1.SSS1.p2.1.m1.1.1" xref="S4.SS1.SSS1.p2.1.m1.1.1.cmml"><mrow id="S4.SS1.SSS1.p2.1.m1.1.1.2" xref="S4.SS1.SSS1.p2.1.m1.1.1.2.cmml"><mrow id="S4.SS1.SSS1.p2.1.m1.1.1.2.2" xref="S4.SS1.SSS1.p2.1.m1.1.1.2.2.cmml"><mi id="S4.SS1.SSS1.p2.1.m1.1.1.2.2.2" xref="S4.SS1.SSS1.p2.1.m1.1.1.2.2.2.cmml">i</mi><mo lspace="0em" rspace="0em" id="S4.SS1.SSS1.p2.1.m1.1.1.2.2.1" xref="S4.SS1.SSS1.p2.1.m1.1.1.2.2.1.cmml">​</mo><mi id="S4.SS1.SSS1.p2.1.m1.1.1.2.2.3" xref="S4.SS1.SSS1.p2.1.m1.1.1.2.2.3.cmml">n</mi><mo lspace="0em" rspace="0em" id="S4.SS1.SSS1.p2.1.m1.1.1.2.2.1a" xref="S4.SS1.SSS1.p2.1.m1.1.1.2.2.1.cmml">​</mo><mi id="S4.SS1.SSS1.p2.1.m1.1.1.2.2.4" xref="S4.SS1.SSS1.p2.1.m1.1.1.2.2.4.cmml">c</mi><mo lspace="0em" rspace="0em" id="S4.SS1.SSS1.p2.1.m1.1.1.2.2.1b" xref="S4.SS1.SSS1.p2.1.m1.1.1.2.2.1.cmml">​</mo><mi id="S4.SS1.SSS1.p2.1.m1.1.1.2.2.5" xref="S4.SS1.SSS1.p2.1.m1.1.1.2.2.5.cmml">e</mi><mo lspace="0em" rspace="0em" id="S4.SS1.SSS1.p2.1.m1.1.1.2.2.1c" xref="S4.SS1.SSS1.p2.1.m1.1.1.2.2.1.cmml">​</mo><mi id="S4.SS1.SSS1.p2.1.m1.1.1.2.2.6" xref="S4.SS1.SSS1.p2.1.m1.1.1.2.2.6.cmml">p</mi><mo lspace="0em" rspace="0em" id="S4.SS1.SSS1.p2.1.m1.1.1.2.2.1d" xref="S4.SS1.SSS1.p2.1.m1.1.1.2.2.1.cmml">​</mo><mi id="S4.SS1.SSS1.p2.1.m1.1.1.2.2.7" xref="S4.SS1.SSS1.p2.1.m1.1.1.2.2.7.cmml">t</mi><mo lspace="0em" rspace="0em" id="S4.SS1.SSS1.p2.1.m1.1.1.2.2.1e" xref="S4.SS1.SSS1.p2.1.m1.1.1.2.2.1.cmml">​</mo><mi id="S4.SS1.SSS1.p2.1.m1.1.1.2.2.8" xref="S4.SS1.SSS1.p2.1.m1.1.1.2.2.8.cmml">i</mi><mo lspace="0em" rspace="0em" id="S4.SS1.SSS1.p2.1.m1.1.1.2.2.1f" xref="S4.SS1.SSS1.p2.1.m1.1.1.2.2.1.cmml">​</mo><mi id="S4.SS1.SSS1.p2.1.m1.1.1.2.2.9" xref="S4.SS1.SSS1.p2.1.m1.1.1.2.2.9.cmml">o</mi><mo lspace="0em" rspace="0em" id="S4.SS1.SSS1.p2.1.m1.1.1.2.2.1g" xref="S4.SS1.SSS1.p2.1.m1.1.1.2.2.1.cmml">​</mo><mi id="S4.SS1.SSS1.p2.1.m1.1.1.2.2.10" xref="S4.SS1.SSS1.p2.1.m1.1.1.2.2.10.cmml">n</mi><mo lspace="0em" rspace="0em" id="S4.SS1.SSS1.p2.1.m1.1.1.2.2.1h" xref="S4.SS1.SSS1.p2.1.m1.1.1.2.2.1.cmml">​</mo><mi mathvariant="normal" id="S4.SS1.SSS1.p2.1.m1.1.1.2.2.11" xref="S4.SS1.SSS1.p2.1.m1.1.1.2.2.11.cmml">_</mi><mo lspace="0em" rspace="0em" id="S4.SS1.SSS1.p2.1.m1.1.1.2.2.1i" xref="S4.SS1.SSS1.p2.1.m1.1.1.2.2.1.cmml">​</mo><mn id="S4.SS1.SSS1.p2.1.m1.1.1.2.2.12" xref="S4.SS1.SSS1.p2.1.m1.1.1.2.2.12.cmml">5</mn><mo lspace="0em" rspace="0em" id="S4.SS1.SSS1.p2.1.m1.1.1.2.2.1j" xref="S4.SS1.SSS1.p2.1.m1.1.1.2.2.1.cmml">​</mo><mi id="S4.SS1.SSS1.p2.1.m1.1.1.2.2.13" xref="S4.SS1.SSS1.p2.1.m1.1.1.2.2.13.cmml">b</mi></mrow><mo id="S4.SS1.SSS1.p2.1.m1.1.1.2.1" xref="S4.SS1.SSS1.p2.1.m1.1.1.2.1.cmml">/</mo><mi id="S4.SS1.SSS1.p2.1.m1.1.1.2.3" xref="S4.SS1.SSS1.p2.1.m1.1.1.2.3.cmml">o</mi></mrow><mo lspace="0em" rspace="0em" id="S4.SS1.SSS1.p2.1.m1.1.1.1" xref="S4.SS1.SSS1.p2.1.m1.1.1.1.cmml">​</mo><mi id="S4.SS1.SSS1.p2.1.m1.1.1.3" xref="S4.SS1.SSS1.p2.1.m1.1.1.3.cmml">u</mi><mo lspace="0em" rspace="0em" id="S4.SS1.SSS1.p2.1.m1.1.1.1a" xref="S4.SS1.SSS1.p2.1.m1.1.1.1.cmml">​</mo><mi id="S4.SS1.SSS1.p2.1.m1.1.1.4" xref="S4.SS1.SSS1.p2.1.m1.1.1.4.cmml">t</mi><mo lspace="0em" rspace="0em" id="S4.SS1.SSS1.p2.1.m1.1.1.1b" xref="S4.SS1.SSS1.p2.1.m1.1.1.1.cmml">​</mo><mi id="S4.SS1.SSS1.p2.1.m1.1.1.5" xref="S4.SS1.SSS1.p2.1.m1.1.1.5.cmml">p</mi><mo lspace="0em" rspace="0em" id="S4.SS1.SSS1.p2.1.m1.1.1.1c" xref="S4.SS1.SSS1.p2.1.m1.1.1.1.cmml">​</mo><mi id="S4.SS1.SSS1.p2.1.m1.1.1.6" xref="S4.SS1.SSS1.p2.1.m1.1.1.6.cmml">u</mi><mo lspace="0em" rspace="0em" id="S4.SS1.SSS1.p2.1.m1.1.1.1d" xref="S4.SS1.SSS1.p2.1.m1.1.1.1.cmml">​</mo><mi id="S4.SS1.SSS1.p2.1.m1.1.1.7" xref="S4.SS1.SSS1.p2.1.m1.1.1.7.cmml">t</mi></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.SSS1.p2.1.m1.1b"><apply id="S4.SS1.SSS1.p2.1.m1.1.1.cmml" xref="S4.SS1.SSS1.p2.1.m1.1.1"><times id="S4.SS1.SSS1.p2.1.m1.1.1.1.cmml" xref="S4.SS1.SSS1.p2.1.m1.1.1.1"></times><apply id="S4.SS1.SSS1.p2.1.m1.1.1.2.cmml" xref="S4.SS1.SSS1.p2.1.m1.1.1.2"><divide id="S4.SS1.SSS1.p2.1.m1.1.1.2.1.cmml" xref="S4.SS1.SSS1.p2.1.m1.1.1.2.1"></divide><apply id="S4.SS1.SSS1.p2.1.m1.1.1.2.2.cmml" xref="S4.SS1.SSS1.p2.1.m1.1.1.2.2"><times id="S4.SS1.SSS1.p2.1.m1.1.1.2.2.1.cmml" xref="S4.SS1.SSS1.p2.1.m1.1.1.2.2.1"></times><ci id="S4.SS1.SSS1.p2.1.m1.1.1.2.2.2.cmml" xref="S4.SS1.SSS1.p2.1.m1.1.1.2.2.2">𝑖</ci><ci id="S4.SS1.SSS1.p2.1.m1.1.1.2.2.3.cmml" xref="S4.SS1.SSS1.p2.1.m1.1.1.2.2.3">𝑛</ci><ci id="S4.SS1.SSS1.p2.1.m1.1.1.2.2.4.cmml" xref="S4.SS1.SSS1.p2.1.m1.1.1.2.2.4">𝑐</ci><ci id="S4.SS1.SSS1.p2.1.m1.1.1.2.2.5.cmml" xref="S4.SS1.SSS1.p2.1.m1.1.1.2.2.5">𝑒</ci><ci id="S4.SS1.SSS1.p2.1.m1.1.1.2.2.6.cmml" xref="S4.SS1.SSS1.p2.1.m1.1.1.2.2.6">𝑝</ci><ci id="S4.SS1.SSS1.p2.1.m1.1.1.2.2.7.cmml" xref="S4.SS1.SSS1.p2.1.m1.1.1.2.2.7">𝑡</ci><ci id="S4.SS1.SSS1.p2.1.m1.1.1.2.2.8.cmml" xref="S4.SS1.SSS1.p2.1.m1.1.1.2.2.8">𝑖</ci><ci id="S4.SS1.SSS1.p2.1.m1.1.1.2.2.9.cmml" xref="S4.SS1.SSS1.p2.1.m1.1.1.2.2.9">𝑜</ci><ci id="S4.SS1.SSS1.p2.1.m1.1.1.2.2.10.cmml" xref="S4.SS1.SSS1.p2.1.m1.1.1.2.2.10">𝑛</ci><ci id="S4.SS1.SSS1.p2.1.m1.1.1.2.2.11.cmml" xref="S4.SS1.SSS1.p2.1.m1.1.1.2.2.11">_</ci><cn type="integer" id="S4.SS1.SSS1.p2.1.m1.1.1.2.2.12.cmml" xref="S4.SS1.SSS1.p2.1.m1.1.1.2.2.12">5</cn><ci id="S4.SS1.SSS1.p2.1.m1.1.1.2.2.13.cmml" xref="S4.SS1.SSS1.p2.1.m1.1.1.2.2.13">𝑏</ci></apply><ci id="S4.SS1.SSS1.p2.1.m1.1.1.2.3.cmml" xref="S4.SS1.SSS1.p2.1.m1.1.1.2.3">𝑜</ci></apply><ci id="S4.SS1.SSS1.p2.1.m1.1.1.3.cmml" xref="S4.SS1.SSS1.p2.1.m1.1.1.3">𝑢</ci><ci id="S4.SS1.SSS1.p2.1.m1.1.1.4.cmml" xref="S4.SS1.SSS1.p2.1.m1.1.1.4">𝑡</ci><ci id="S4.SS1.SSS1.p2.1.m1.1.1.5.cmml" xref="S4.SS1.SSS1.p2.1.m1.1.1.5">𝑝</ci><ci id="S4.SS1.SSS1.p2.1.m1.1.1.6.cmml" xref="S4.SS1.SSS1.p2.1.m1.1.1.6">𝑢</ci><ci id="S4.SS1.SSS1.p2.1.m1.1.1.7.cmml" xref="S4.SS1.SSS1.p2.1.m1.1.1.7">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSS1.p2.1.m1.1c">inception\_5b/output</annotation></semantics></math>) in GoogLeNet that we use in SMem-VQA model.
We check the visualization of the attention weights and find that the relationship between the high attention position and the answer can be expressed by logical expressions.
We show the attention weights of several typical examples in Fig. <a href="#S4.F3" title="Figure 3 ‣ 4.1 Exploring Attention on Synthetic Data ‣ 4 Experiments ‣ Ask, Attend and Answer: Exploring Question-Guided Spatial Attention for Visual Question Answering" class="ltx_ref"><span class="ltx_text ltx_ref_tag">3</span></a> which reflect two logic rules:
1) Look at the position specified in question (top<math id="S4.SS1.SSS1.p2.2.m2.1" class="ltx_Math" alttext="\mid" display="inline"><semantics id="S4.SS1.SSS1.p2.2.m2.1a"><mo id="S4.SS1.SSS1.p2.2.m2.1.1" xref="S4.SS1.SSS1.p2.2.m2.1.1.cmml">∣</mo><annotation-xml encoding="MathML-Content" id="S4.SS1.SSS1.p2.2.m2.1b"><ci id="S4.SS1.SSS1.p2.2.m2.1.1.cmml" xref="S4.SS1.SSS1.p2.2.m2.1.1">∣</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSS1.p2.2.m2.1c">\mid</annotation></semantics></math>bottom<math id="S4.SS1.SSS1.p2.3.m3.1" class="ltx_Math" alttext="\mid" display="inline"><semantics id="S4.SS1.SSS1.p2.3.m3.1a"><mo id="S4.SS1.SSS1.p2.3.m3.1.1" xref="S4.SS1.SSS1.p2.3.m3.1.1.cmml">∣</mo><annotation-xml encoding="MathML-Content" id="S4.SS1.SSS1.p2.3.m3.1b"><ci id="S4.SS1.SSS1.p2.3.m3.1.1.cmml" xref="S4.SS1.SSS1.p2.3.m3.1.1">∣</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSS1.p2.3.m3.1c">\mid</annotation></semantics></math>right<math id="S4.SS1.SSS1.p2.4.m4.1" class="ltx_Math" alttext="\mid" display="inline"><semantics id="S4.SS1.SSS1.p2.4.m4.1a"><mo id="S4.SS1.SSS1.p2.4.m4.1.1" xref="S4.SS1.SSS1.p2.4.m4.1.1.cmml">∣</mo><annotation-xml encoding="MathML-Content" id="S4.SS1.SSS1.p2.4.m4.1b"><ci id="S4.SS1.SSS1.p2.4.m4.1.1.cmml" xref="S4.SS1.SSS1.p2.4.m4.1.1">∣</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSS1.p2.4.m4.1c">\mid</annotation></semantics></math>left), if it contains a square, then answer “yes”; if it does not contain a square, then answer “no”.
2) Look at the region where there is a square, then answer “yes” for the question about that position and “no” for the questions about the other three positions.</p>
</div>
<div id="S4.SS1.SSS1.p3" class="ltx_para">
<p id="S4.SS1.SSS1.p3.1" class="ltx_p">In the iBOWIMG model, the mean-pooled GoogLeNet visual features lose spatial information and thus cannot distinguish images with a square in different positions. On the contrary, our SMem-VQA model can pay high attention to different regions according to the question, and generate an answer based on the selected region, using some learned inference rules.
This experiment demonstrates that the attention mechanism in our model is able to make absolute spatial location inference based on the spatial attention.</p>
</div>
<figure id="S4.F4" class="ltx_figure">
<div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_3"><img src="/html/1511.05234/assets/figures/bottom_COCO_val2014_000000167602_bottom.jpg" id="S4.F4.g1" class="ltx_graphics ltx_figure_panel ltx_img_landscape" width="195" height="81" alt="Refer to caption"></div>
<div class="ltx_flex_cell ltx_flex_size_3"><img src="/html/1511.05234/assets/figures/right_COCO_val2014_0000002988_right.jpg" id="S4.F4.g2" class="ltx_graphics ltx_figure_panel ltx_img_landscape" width="195" height="81" alt="Refer to caption"></div>
<div class="ltx_flex_cell ltx_flex_size_3"><img src="/html/1511.05234/assets/figures/right_COCO_val2014_000000172330_bottom.jpg" id="S4.F4.g3" class="ltx_graphics ltx_figure_panel ltx_img_landscape" width="195" height="81" alt="Refer to caption"></div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_3"><img src="/html/1511.05234/assets/figures/top_COCO_val2014_00000010694_bottom.jpg" id="S4.F4.g4" class="ltx_graphics ltx_figure_panel ltx_img_landscape" width="195" height="81" alt="Refer to caption"></div>
<div class="ltx_flex_cell ltx_flex_size_3"><img src="/html/1511.05234/assets/figures/left_COCO_val2014_000000201918_top.jpg" id="S4.F4.g5" class="ltx_graphics ltx_figure_panel ltx_img_landscape" width="195" height="81" alt="Refer to caption"></div>
<div class="ltx_flex_cell ltx_flex_size_3"><img src="/html/1511.05234/assets/figures/top_COCO_val2014_000000218924_left.jpg" id="S4.F4.g6" class="ltx_graphics ltx_figure_panel ltx_img_landscape" width="195" height="81" alt="Refer to caption"></div>
</div>
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure">Figure 4: </span><span id="S4.F4.8.1" class="ltx_text ltx_font_bold">Relative position experiment:</span>
for each image and question pair, we show the original image (left), the evidence embedding <math id="S4.F4.4.m1.1" class="ltx_Math" alttext="W_{E}" display="inline"><semantics id="S4.F4.4.m1.1b"><msub id="S4.F4.4.m1.1.1" xref="S4.F4.4.m1.1.1.cmml"><mi id="S4.F4.4.m1.1.1.2" xref="S4.F4.4.m1.1.1.2.cmml">W</mi><mi id="S4.F4.4.m1.1.1.3" xref="S4.F4.4.m1.1.1.3.cmml">E</mi></msub><annotation-xml encoding="MathML-Content" id="S4.F4.4.m1.1c"><apply id="S4.F4.4.m1.1.1.cmml" xref="S4.F4.4.m1.1.1"><csymbol cd="ambiguous" id="S4.F4.4.m1.1.1.1.cmml" xref="S4.F4.4.m1.1.1">subscript</csymbol><ci id="S4.F4.4.m1.1.1.2.cmml" xref="S4.F4.4.m1.1.1.2">𝑊</ci><ci id="S4.F4.4.m1.1.1.3.cmml" xref="S4.F4.4.m1.1.1.3">𝐸</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.F4.4.m1.1d">W_{E}</annotation></semantics></math> of the convolutional layer (middle) and the attention weights <math id="S4.F4.5.m2.1" class="ltx_Math" alttext="W_{att}" display="inline"><semantics id="S4.F4.5.m2.1b"><msub id="S4.F4.5.m2.1.1" xref="S4.F4.5.m2.1.1.cmml"><mi id="S4.F4.5.m2.1.1.2" xref="S4.F4.5.m2.1.1.2.cmml">W</mi><mrow id="S4.F4.5.m2.1.1.3" xref="S4.F4.5.m2.1.1.3.cmml"><mi id="S4.F4.5.m2.1.1.3.2" xref="S4.F4.5.m2.1.1.3.2.cmml">a</mi><mo lspace="0em" rspace="0em" id="S4.F4.5.m2.1.1.3.1" xref="S4.F4.5.m2.1.1.3.1.cmml">​</mo><mi id="S4.F4.5.m2.1.1.3.3" xref="S4.F4.5.m2.1.1.3.3.cmml">t</mi><mo lspace="0em" rspace="0em" id="S4.F4.5.m2.1.1.3.1b" xref="S4.F4.5.m2.1.1.3.1.cmml">​</mo><mi id="S4.F4.5.m2.1.1.3.4" xref="S4.F4.5.m2.1.1.3.4.cmml">t</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S4.F4.5.m2.1c"><apply id="S4.F4.5.m2.1.1.cmml" xref="S4.F4.5.m2.1.1"><csymbol cd="ambiguous" id="S4.F4.5.m2.1.1.1.cmml" xref="S4.F4.5.m2.1.1">subscript</csymbol><ci id="S4.F4.5.m2.1.1.2.cmml" xref="S4.F4.5.m2.1.1.2">𝑊</ci><apply id="S4.F4.5.m2.1.1.3.cmml" xref="S4.F4.5.m2.1.1.3"><times id="S4.F4.5.m2.1.1.3.1.cmml" xref="S4.F4.5.m2.1.1.3.1"></times><ci id="S4.F4.5.m2.1.1.3.2.cmml" xref="S4.F4.5.m2.1.1.3.2">𝑎</ci><ci id="S4.F4.5.m2.1.1.3.3.cmml" xref="S4.F4.5.m2.1.1.3.3">𝑡</ci><ci id="S4.F4.5.m2.1.1.3.4.cmml" xref="S4.F4.5.m2.1.1.3.4">𝑡</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.F4.5.m2.1d">W_{att}</annotation></semantics></math> (right). The evidence embedding <math id="S4.F4.6.m3.1" class="ltx_Math" alttext="W_{E}" display="inline"><semantics id="S4.F4.6.m3.1b"><msub id="S4.F4.6.m3.1.1" xref="S4.F4.6.m3.1.1.cmml"><mi id="S4.F4.6.m3.1.1.2" xref="S4.F4.6.m3.1.1.2.cmml">W</mi><mi id="S4.F4.6.m3.1.1.3" xref="S4.F4.6.m3.1.1.3.cmml">E</mi></msub><annotation-xml encoding="MathML-Content" id="S4.F4.6.m3.1c"><apply id="S4.F4.6.m3.1.1.cmml" xref="S4.F4.6.m3.1.1"><csymbol cd="ambiguous" id="S4.F4.6.m3.1.1.1.cmml" xref="S4.F4.6.m3.1.1">subscript</csymbol><ci id="S4.F4.6.m3.1.1.2.cmml" xref="S4.F4.6.m3.1.1.2">𝑊</ci><ci id="S4.F4.6.m3.1.1.3.cmml" xref="S4.F4.6.m3.1.1.3">𝐸</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.F4.6.m3.1d">W_{E}</annotation></semantics></math> has high activations on both cat and red square.
The attention weights follow similar inference rules as in Fig. <a href="#S4.F3" title="Figure 3 ‣ 4.1 Exploring Attention on Synthetic Data ‣ 4 Experiments ‣ Ask, Attend and Answer: Exploring Question-Guided Spatial Attention for Visual Question Answering" class="ltx_ref"><span class="ltx_text ltx_ref_tag">3</span></a>, with the difference that the attention position is around the cat.
</figcaption>
</figure>
</section>
<section id="S4.SS1.SSS2" class="ltx_subsubsection">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">4.1.2 </span>Relative Position Recognition</h4>

<div id="S4.SS1.SSS2.p1" class="ltx_para">
<p id="S4.SS1.SSS2.p1.6" class="ltx_p">In order to check whether the model has the ability to infer the position of one object <span id="S4.SS1.SSS2.p1.6.1" class="ltx_text ltx_font_italic">relative</span> to another object,
we collect all the cat images from the MS COCO Detection dataset <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib30" title="" class="ltx_ref">30</a>]</cite>, and add a red square on the [top<math id="S4.SS1.SSS2.p1.1.m1.1" class="ltx_Math" alttext="\mid" display="inline"><semantics id="S4.SS1.SSS2.p1.1.m1.1a"><mo id="S4.SS1.SSS2.p1.1.m1.1.1" xref="S4.SS1.SSS2.p1.1.m1.1.1.cmml">∣</mo><annotation-xml encoding="MathML-Content" id="S4.SS1.SSS2.p1.1.m1.1b"><ci id="S4.SS1.SSS2.p1.1.m1.1.1.cmml" xref="S4.SS1.SSS2.p1.1.m1.1.1">∣</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSS2.p1.1.m1.1c">\mid</annotation></semantics></math>bottom<math id="S4.SS1.SSS2.p1.2.m2.1" class="ltx_Math" alttext="\mid" display="inline"><semantics id="S4.SS1.SSS2.p1.2.m2.1a"><mo id="S4.SS1.SSS2.p1.2.m2.1.1" xref="S4.SS1.SSS2.p1.2.m2.1.1.cmml">∣</mo><annotation-xml encoding="MathML-Content" id="S4.SS1.SSS2.p1.2.m2.1b"><ci id="S4.SS1.SSS2.p1.2.m2.1.1.cmml" xref="S4.SS1.SSS2.p1.2.m2.1.1">∣</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSS2.p1.2.m2.1c">\mid</annotation></semantics></math>left<math id="S4.SS1.SSS2.p1.3.m3.1" class="ltx_Math" alttext="\mid" display="inline"><semantics id="S4.SS1.SSS2.p1.3.m3.1a"><mo id="S4.SS1.SSS2.p1.3.m3.1.1" xref="S4.SS1.SSS2.p1.3.m3.1.1.cmml">∣</mo><annotation-xml encoding="MathML-Content" id="S4.SS1.SSS2.p1.3.m3.1b"><ci id="S4.SS1.SSS2.p1.3.m3.1.1.cmml" xref="S4.SS1.SSS2.p1.3.m3.1.1">∣</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSS2.p1.3.m3.1c">\mid</annotation></semantics></math>right] of the bounding box of the cat in the images.
For each generated image, we create four questions, “Is there a red square on the [top<math id="S4.SS1.SSS2.p1.4.m4.1" class="ltx_Math" alttext="\mid" display="inline"><semantics id="S4.SS1.SSS2.p1.4.m4.1a"><mo id="S4.SS1.SSS2.p1.4.m4.1.1" xref="S4.SS1.SSS2.p1.4.m4.1.1.cmml">∣</mo><annotation-xml encoding="MathML-Content" id="S4.SS1.SSS2.p1.4.m4.1b"><ci id="S4.SS1.SSS2.p1.4.m4.1.1.cmml" xref="S4.SS1.SSS2.p1.4.m4.1.1">∣</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSS2.p1.4.m4.1c">\mid</annotation></semantics></math>bottom<math id="S4.SS1.SSS2.p1.5.m5.1" class="ltx_Math" alttext="\mid" display="inline"><semantics id="S4.SS1.SSS2.p1.5.m5.1a"><mo id="S4.SS1.SSS2.p1.5.m5.1.1" xref="S4.SS1.SSS2.p1.5.m5.1.1.cmml">∣</mo><annotation-xml encoding="MathML-Content" id="S4.SS1.SSS2.p1.5.m5.1b"><ci id="S4.SS1.SSS2.p1.5.m5.1.1.cmml" xref="S4.SS1.SSS2.p1.5.m5.1.1">∣</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSS2.p1.5.m5.1c">\mid</annotation></semantics></math>left<math id="S4.SS1.SSS2.p1.6.m6.1" class="ltx_Math" alttext="\mid" display="inline"><semantics id="S4.SS1.SSS2.p1.6.m6.1a"><mo id="S4.SS1.SSS2.p1.6.m6.1.1" xref="S4.SS1.SSS2.p1.6.m6.1.1.cmml">∣</mo><annotation-xml encoding="MathML-Content" id="S4.SS1.SSS2.p1.6.m6.1b"><ci id="S4.SS1.SSS2.p1.6.m6.1.1.cmml" xref="S4.SS1.SSS2.p1.6.m6.1.1">∣</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSS2.p1.6.m6.1c">\mid</annotation></semantics></math>right] of the cat?” together with three “no” answers and one “yes” answer.
We select 2639 training cat images and 1395 testing cat images from MS COCO Detection dataset.</p>
</div>
<div id="S4.SS1.SSS2.p2" class="ltx_para">
<p id="S4.SS1.SSS2.p2.3" class="ltx_p">Our SMem-VQA one-hop model achieves 96% test accuracy on this synthetic task, while the baseline model (iBOWIMG) accuracy is around 75%.
We also check that another simple baseline that predicts the answer based on the absolute position of the square in the image gets around 70% accuracy.
We visualize the evidence embedding <math id="S4.SS1.SSS2.p2.1.m1.1" class="ltx_Math" alttext="W_{E}" display="inline"><semantics id="S4.SS1.SSS2.p2.1.m1.1a"><msub id="S4.SS1.SSS2.p2.1.m1.1.1" xref="S4.SS1.SSS2.p2.1.m1.1.1.cmml"><mi id="S4.SS1.SSS2.p2.1.m1.1.1.2" xref="S4.SS1.SSS2.p2.1.m1.1.1.2.cmml">W</mi><mi id="S4.SS1.SSS2.p2.1.m1.1.1.3" xref="S4.SS1.SSS2.p2.1.m1.1.1.3.cmml">E</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS1.SSS2.p2.1.m1.1b"><apply id="S4.SS1.SSS2.p2.1.m1.1.1.cmml" xref="S4.SS1.SSS2.p2.1.m1.1.1"><csymbol cd="ambiguous" id="S4.SS1.SSS2.p2.1.m1.1.1.1.cmml" xref="S4.SS1.SSS2.p2.1.m1.1.1">subscript</csymbol><ci id="S4.SS1.SSS2.p2.1.m1.1.1.2.cmml" xref="S4.SS1.SSS2.p2.1.m1.1.1.2">𝑊</ci><ci id="S4.SS1.SSS2.p2.1.m1.1.1.3.cmml" xref="S4.SS1.SSS2.p2.1.m1.1.1.3">𝐸</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSS2.p2.1.m1.1c">W_{E}</annotation></semantics></math> features and the attention weights <math id="S4.SS1.SSS2.p2.2.m2.1" class="ltx_Math" alttext="W_{att}" display="inline"><semantics id="S4.SS1.SSS2.p2.2.m2.1a"><msub id="S4.SS1.SSS2.p2.2.m2.1.1" xref="S4.SS1.SSS2.p2.2.m2.1.1.cmml"><mi id="S4.SS1.SSS2.p2.2.m2.1.1.2" xref="S4.SS1.SSS2.p2.2.m2.1.1.2.cmml">W</mi><mrow id="S4.SS1.SSS2.p2.2.m2.1.1.3" xref="S4.SS1.SSS2.p2.2.m2.1.1.3.cmml"><mi id="S4.SS1.SSS2.p2.2.m2.1.1.3.2" xref="S4.SS1.SSS2.p2.2.m2.1.1.3.2.cmml">a</mi><mo lspace="0em" rspace="0em" id="S4.SS1.SSS2.p2.2.m2.1.1.3.1" xref="S4.SS1.SSS2.p2.2.m2.1.1.3.1.cmml">​</mo><mi id="S4.SS1.SSS2.p2.2.m2.1.1.3.3" xref="S4.SS1.SSS2.p2.2.m2.1.1.3.3.cmml">t</mi><mo lspace="0em" rspace="0em" id="S4.SS1.SSS2.p2.2.m2.1.1.3.1a" xref="S4.SS1.SSS2.p2.2.m2.1.1.3.1.cmml">​</mo><mi id="S4.SS1.SSS2.p2.2.m2.1.1.3.4" xref="S4.SS1.SSS2.p2.2.m2.1.1.3.4.cmml">t</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S4.SS1.SSS2.p2.2.m2.1b"><apply id="S4.SS1.SSS2.p2.2.m2.1.1.cmml" xref="S4.SS1.SSS2.p2.2.m2.1.1"><csymbol cd="ambiguous" id="S4.SS1.SSS2.p2.2.m2.1.1.1.cmml" xref="S4.SS1.SSS2.p2.2.m2.1.1">subscript</csymbol><ci id="S4.SS1.SSS2.p2.2.m2.1.1.2.cmml" xref="S4.SS1.SSS2.p2.2.m2.1.1.2">𝑊</ci><apply id="S4.SS1.SSS2.p2.2.m2.1.1.3.cmml" xref="S4.SS1.SSS2.p2.2.m2.1.1.3"><times id="S4.SS1.SSS2.p2.2.m2.1.1.3.1.cmml" xref="S4.SS1.SSS2.p2.2.m2.1.1.3.1"></times><ci id="S4.SS1.SSS2.p2.2.m2.1.1.3.2.cmml" xref="S4.SS1.SSS2.p2.2.m2.1.1.3.2">𝑎</ci><ci id="S4.SS1.SSS2.p2.2.m2.1.1.3.3.cmml" xref="S4.SS1.SSS2.p2.2.m2.1.1.3.3">𝑡</ci><ci id="S4.SS1.SSS2.p2.2.m2.1.1.3.4.cmml" xref="S4.SS1.SSS2.p2.2.m2.1.1.3.4">𝑡</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSS2.p2.2.m2.1c">W_{att}</annotation></semantics></math> of several typical examples in Fig. <a href="#S4.F4" title="Figure 4 ‣ 4.1.1 Absolute Position Recognition ‣ 4.1 Exploring Attention on Synthetic Data ‣ 4 Experiments ‣ Ask, Attend and Answer: Exploring Question-Guided Spatial Attention for Visual Question Answering" class="ltx_ref"><span class="ltx_text ltx_ref_tag">4</span></a>.
The evidence embedding <math id="S4.SS1.SSS2.p2.3.m3.1" class="ltx_Math" alttext="W_{E}" display="inline"><semantics id="S4.SS1.SSS2.p2.3.m3.1a"><msub id="S4.SS1.SSS2.p2.3.m3.1.1" xref="S4.SS1.SSS2.p2.3.m3.1.1.cmml"><mi id="S4.SS1.SSS2.p2.3.m3.1.1.2" xref="S4.SS1.SSS2.p2.3.m3.1.1.2.cmml">W</mi><mi id="S4.SS1.SSS2.p2.3.m3.1.1.3" xref="S4.SS1.SSS2.p2.3.m3.1.1.3.cmml">E</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS1.SSS2.p2.3.m3.1b"><apply id="S4.SS1.SSS2.p2.3.m3.1.1.cmml" xref="S4.SS1.SSS2.p2.3.m3.1.1"><csymbol cd="ambiguous" id="S4.SS1.SSS2.p2.3.m3.1.1.1.cmml" xref="S4.SS1.SSS2.p2.3.m3.1.1">subscript</csymbol><ci id="S4.SS1.SSS2.p2.3.m3.1.1.2.cmml" xref="S4.SS1.SSS2.p2.3.m3.1.1.2">𝑊</ci><ci id="S4.SS1.SSS2.p2.3.m3.1.1.3.cmml" xref="S4.SS1.SSS2.p2.3.m3.1.1.3">𝐸</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSS2.p2.3.m3.1c">W_{E}</annotation></semantics></math> has high activations on the cat and the red square, while the attention weights pay high attention to certain locations around the cat.
We can analyze the attention in the correctly predicted examples using the same rules as in absolute position recognition experiment.
These rules still work, but the position is relative to the cat object:
1) Check the specified position relative to the cat, if it finds the square, then answer “yes”, otherwise “no”; 2) Find the square, then answer “yes” for the specified position, and answer “no” for the other positions around the cat.
We also check the images where our model makes mistakes, and find that the mistakes mainly occur in images with more than one cats. The red square appears near only one of the cats in the image, but our model might make mistakes by focusing on the other cats.
We conclude that our SMem-VQA model can infer the relative spatial position based on the spatial attention around the specified object, which can also be represented by some logical inference rules.</p>
</div>
<figure id="S4.T1" class="ltx_table">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table">Table 1: </span>Accuracy results on the DAQUAR dataset (in percentage).</figcaption>
<table id="S4.T1.1" class="ltx_tabular ltx_centering ltx_guessed_headers ltx_align_middle">
<thead class="ltx_thead">
<tr id="S4.T1.1.1.1" class="ltx_tr">
<th id="S4.T1.1.1.1.1" class="ltx_td ltx_th ltx_th_column ltx_th_row ltx_border_rr ltx_border_t"></th>
<th id="S4.T1.1.1.1.2" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t"><span id="S4.T1.1.1.1.2.1" class="ltx_text" style="font-size:90%;">DAQUAR</span></th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr id="S4.T1.1.2.1" class="ltx_tr">
<th id="S4.T1.1.2.1.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_rr ltx_border_t">
<span id="S4.T1.1.2.1.1.1" class="ltx_text" style="font-size:90%;">Multi-World </span><cite class="ltx_cite ltx_citemacro_cite"><span id="S4.T1.1.2.1.1.2.1" class="ltx_text" style="font-size:90%;">[</span><a href="#bib.bib1" title="" class="ltx_ref">1</a><span id="S4.T1.1.2.1.1.3.2" class="ltx_text" style="font-size:90%;">]</span></cite>
</th>
<td id="S4.T1.1.2.1.2" class="ltx_td ltx_align_center ltx_border_t"><span id="S4.T1.1.2.1.2.1" class="ltx_text" style="font-size:90%;">12.73</span></td>
</tr>
<tr id="S4.T1.1.3.2" class="ltx_tr">
<th id="S4.T1.1.3.2.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_rr">
<span id="S4.T1.1.3.2.1.1" class="ltx_text" style="font-size:90%;">Neural-Image-QA </span><cite class="ltx_cite ltx_citemacro_cite"><span id="S4.T1.1.3.2.1.2.1" class="ltx_text" style="font-size:90%;">[</span><a href="#bib.bib10" title="" class="ltx_ref">10</a><span id="S4.T1.1.3.2.1.3.2" class="ltx_text" style="font-size:90%;">]</span></cite>
</th>
<td id="S4.T1.1.3.2.2" class="ltx_td ltx_align_center"><span id="S4.T1.1.3.2.2.1" class="ltx_text" style="font-size:90%;">29.27</span></td>
</tr>
<tr id="S4.T1.1.4.3" class="ltx_tr">
<th id="S4.T1.1.4.3.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_rr">
<span id="S4.T1.1.4.3.1.1" class="ltx_text" style="font-size:90%;">Question LSTM </span><cite class="ltx_cite ltx_citemacro_cite"><span id="S4.T1.1.4.3.1.2.1" class="ltx_text" style="font-size:90%;">[</span><a href="#bib.bib10" title="" class="ltx_ref">10</a><span id="S4.T1.1.4.3.1.3.2" class="ltx_text" style="font-size:90%;">]</span></cite>
</th>
<td id="S4.T1.1.4.3.2" class="ltx_td ltx_align_center"><span id="S4.T1.1.4.3.2.1" class="ltx_text" style="font-size:90%;">32.32</span></td>
</tr>
<tr id="S4.T1.1.5.4" class="ltx_tr">
<th id="S4.T1.1.5.4.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_rr">
<span id="S4.T1.1.5.4.1.1" class="ltx_text" style="font-size:90%;">VIS+LSTM </span><cite class="ltx_cite ltx_citemacro_cite"><span id="S4.T1.1.5.4.1.2.1" class="ltx_text" style="font-size:90%;">[</span><a href="#bib.bib11" title="" class="ltx_ref">11</a><span id="S4.T1.1.5.4.1.3.2" class="ltx_text" style="font-size:90%;">]</span></cite>
</th>
<td id="S4.T1.1.5.4.2" class="ltx_td ltx_align_center"><span id="S4.T1.1.5.4.2.1" class="ltx_text" style="font-size:90%;">34.41</span></td>
</tr>
<tr id="S4.T1.1.6.5" class="ltx_tr">
<th id="S4.T1.1.6.5.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_rr">
<span id="S4.T1.1.6.5.1.1" class="ltx_text" style="font-size:90%;">Question BOW </span><cite class="ltx_cite ltx_citemacro_cite"><span id="S4.T1.1.6.5.1.2.1" class="ltx_text" style="font-size:90%;">[</span><a href="#bib.bib11" title="" class="ltx_ref">11</a><span id="S4.T1.1.6.5.1.3.2" class="ltx_text" style="font-size:90%;">]</span></cite>
</th>
<td id="S4.T1.1.6.5.2" class="ltx_td ltx_align_center"><span id="S4.T1.1.6.5.2.1" class="ltx_text" style="font-size:90%;">32.67</span></td>
</tr>
<tr id="S4.T1.1.7.6" class="ltx_tr">
<th id="S4.T1.1.7.6.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_rr">
<span id="S4.T1.1.7.6.1.1" class="ltx_text" style="font-size:90%;">IMG+BOW </span><cite class="ltx_cite ltx_citemacro_cite"><span id="S4.T1.1.7.6.1.2.1" class="ltx_text" style="font-size:90%;">[</span><a href="#bib.bib11" title="" class="ltx_ref">11</a><span id="S4.T1.1.7.6.1.3.2" class="ltx_text" style="font-size:90%;">]</span></cite>
</th>
<td id="S4.T1.1.7.6.2" class="ltx_td ltx_align_center"><span id="S4.T1.1.7.6.2.1" class="ltx_text" style="font-size:90%;">34.17</span></td>
</tr>
<tr id="S4.T1.1.8.7" class="ltx_tr">
<th id="S4.T1.1.8.7.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_rr ltx_border_t"><span id="S4.T1.1.8.7.1.1" class="ltx_text" style="font-size:90%;">SMem-VQA One-Hop</span></th>
<td id="S4.T1.1.8.7.2" class="ltx_td ltx_align_center ltx_border_t"><span id="S4.T1.1.8.7.2.1" class="ltx_text" style="font-size:90%;">36.03</span></td>
</tr>
<tr id="S4.T1.1.9.8" class="ltx_tr">
<th id="S4.T1.1.9.8.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_b ltx_border_rr"><span id="S4.T1.1.9.8.1.1" class="ltx_text" style="font-size:90%;">SMem-VQA Two-Hop</span></th>
<td id="S4.T1.1.9.8.2" class="ltx_td ltx_align_center ltx_border_b"><span id="S4.T1.1.9.8.2.1" class="ltx_text ltx_font_bold" style="font-size:90%;">40.07</span></td>
</tr>
</tbody>
</table>
</figure>
</section>
</section>
<section id="S4.SS2" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.2 </span>Experiments on Standard Datasets</h3>

<section id="S4.SS2.SSS1" class="ltx_subsubsection">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">4.2.1 </span>Results on DAQUAR</h4>

<div id="S4.SS2.SSS1.p1" class="ltx_para">
<p id="S4.SS2.SSS1.p1.6" class="ltx_p">The DAQUAR dataset is a relatively small dataset which builds on the NYU Depth Dataset V2 <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib31" title="" class="ltx_ref">31</a>]</cite>. We use the reduced DAQUAR dataset <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib1" title="" class="ltx_ref">1</a>]</cite>. The evaluation metric for this dataset is 0-1 accuracy.
The embedding dimension is 512 for our models running on the DAQUAR dataset.
We use several reported models on DAQUAR as baselines, which are listed below:
<br class="ltx_break"><math id="S4.SS2.SSS1.p1.1.m1.1" class="ltx_Math" alttext="\bullet" display="inline"><semantics id="S4.SS2.SSS1.p1.1.m1.1a"><mo id="S4.SS2.SSS1.p1.1.m1.1.1" xref="S4.SS2.SSS1.p1.1.m1.1.1.cmml">∙</mo><annotation-xml encoding="MathML-Content" id="S4.SS2.SSS1.p1.1.m1.1b"><ci id="S4.SS2.SSS1.p1.1.m1.1.1.cmml" xref="S4.SS2.SSS1.p1.1.m1.1.1">∙</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.SSS1.p1.1.m1.1c">\bullet</annotation></semantics></math> <span id="S4.SS2.SSS1.p1.6.1" class="ltx_text ltx_font_bold">Multi-World</span> <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib1" title="" class="ltx_ref">1</a>]</cite>: an approach based on handcrafted features using a semantic parse of the question and scene analysis of the image combined in a latent-world Bayesian framework.
<br class="ltx_break"><math id="S4.SS2.SSS1.p1.2.m2.1" class="ltx_Math" alttext="\bullet" display="inline"><semantics id="S4.SS2.SSS1.p1.2.m2.1a"><mo id="S4.SS2.SSS1.p1.2.m2.1.1" xref="S4.SS2.SSS1.p1.2.m2.1.1.cmml">∙</mo><annotation-xml encoding="MathML-Content" id="S4.SS2.SSS1.p1.2.m2.1b"><ci id="S4.SS2.SSS1.p1.2.m2.1.1.cmml" xref="S4.SS2.SSS1.p1.2.m2.1.1">∙</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.SSS1.p1.2.m2.1c">\bullet</annotation></semantics></math> <span id="S4.SS2.SSS1.p1.6.2" class="ltx_text ltx_font_bold">Neural-Image-QA</span> <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib10" title="" class="ltx_ref">10</a>]</cite>: uses an LSTM to encode the question and then decode the hidden information into the answer. The image CNN feature vector is shown at each time step of the encoding phase.
<br class="ltx_break"><math id="S4.SS2.SSS1.p1.3.m3.1" class="ltx_Math" alttext="\bullet" display="inline"><semantics id="S4.SS2.SSS1.p1.3.m3.1a"><mo id="S4.SS2.SSS1.p1.3.m3.1.1" xref="S4.SS2.SSS1.p1.3.m3.1.1.cmml">∙</mo><annotation-xml encoding="MathML-Content" id="S4.SS2.SSS1.p1.3.m3.1b"><ci id="S4.SS2.SSS1.p1.3.m3.1.1.cmml" xref="S4.SS2.SSS1.p1.3.m3.1.1">∙</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.SSS1.p1.3.m3.1c">\bullet</annotation></semantics></math> <span id="S4.SS2.SSS1.p1.6.3" class="ltx_text ltx_font_bold">Question LSTM</span> <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib10" title="" class="ltx_ref">10</a>]</cite>: only shows the question to the LSTM to predict the answer without any image information.
<br class="ltx_break"><math id="S4.SS2.SSS1.p1.4.m4.1" class="ltx_Math" alttext="\bullet" display="inline"><semantics id="S4.SS2.SSS1.p1.4.m4.1a"><mo id="S4.SS2.SSS1.p1.4.m4.1.1" xref="S4.SS2.SSS1.p1.4.m4.1.1.cmml">∙</mo><annotation-xml encoding="MathML-Content" id="S4.SS2.SSS1.p1.4.m4.1b"><ci id="S4.SS2.SSS1.p1.4.m4.1.1.cmml" xref="S4.SS2.SSS1.p1.4.m4.1.1">∙</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.SSS1.p1.4.m4.1c">\bullet</annotation></semantics></math> <span id="S4.SS2.SSS1.p1.6.4" class="ltx_text ltx_font_bold">VIS+LSTM</span> <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib11" title="" class="ltx_ref">11</a>]</cite>: similar to Neural-Image-QA, but only shows the image features to the LSTM at the first time step, and the question in the remaining time steps to predict the answer.
<br class="ltx_break"><math id="S4.SS2.SSS1.p1.5.m5.1" class="ltx_Math" alttext="\bullet" display="inline"><semantics id="S4.SS2.SSS1.p1.5.m5.1a"><mo id="S4.SS2.SSS1.p1.5.m5.1.1" xref="S4.SS2.SSS1.p1.5.m5.1.1.cmml">∙</mo><annotation-xml encoding="MathML-Content" id="S4.SS2.SSS1.p1.5.m5.1b"><ci id="S4.SS2.SSS1.p1.5.m5.1.1.cmml" xref="S4.SS2.SSS1.p1.5.m5.1.1">∙</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.SSS1.p1.5.m5.1c">\bullet</annotation></semantics></math> <span id="S4.SS2.SSS1.p1.6.5" class="ltx_text ltx_font_bold">Question BOW</span> <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib11" title="" class="ltx_ref">11</a>]</cite>: only uses the BOW question representation and a single hidden layer neural network to predict the answer, without any image features.
<br class="ltx_break"><math id="S4.SS2.SSS1.p1.6.m6.1" class="ltx_Math" alttext="\bullet" display="inline"><semantics id="S4.SS2.SSS1.p1.6.m6.1a"><mo id="S4.SS2.SSS1.p1.6.m6.1.1" xref="S4.SS2.SSS1.p1.6.m6.1.1.cmml">∙</mo><annotation-xml encoding="MathML-Content" id="S4.SS2.SSS1.p1.6.m6.1b"><ci id="S4.SS2.SSS1.p1.6.m6.1.1.cmml" xref="S4.SS2.SSS1.p1.6.m6.1.1">∙</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.SSS1.p1.6.m6.1c">\bullet</annotation></semantics></math> <span id="S4.SS2.SSS1.p1.6.6" class="ltx_text ltx_font_bold">IMG+BOW</span> <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib11" title="" class="ltx_ref">11</a>]</cite>: concatenates the BOW question representation with image features, and then uses a single hidden layer neural network to predict the answer. This model is similar to the iBOWIMG baseline model in <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib3" title="" class="ltx_ref">3</a>]</cite>.</p>
</div>
<div id="S4.SS2.SSS1.p2" class="ltx_para">
<p id="S4.SS2.SSS1.p2.1" class="ltx_p">Results of our SMem-VQA model on the DAQUAR dataset and the baseline model results reported in previous work are shown in Tab. <a href="#S4.T1" title="Table 1 ‣ 4.1.2 Relative Position Recognition ‣ 4.1 Exploring Attention on Synthetic Data ‣ 4 Experiments ‣ Ask, Attend and Answer: Exploring Question-Guided Spatial Attention for Visual Question Answering" class="ltx_ref"><span class="ltx_text ltx_ref_tag">1</span></a>.
From the DAQUAR result in Tab. <a href="#S4.T1" title="Table 1 ‣ 4.1.2 Relative Position Recognition ‣ 4.1 Exploring Attention on Synthetic Data ‣ 4 Experiments ‣ Ask, Attend and Answer: Exploring Question-Guided Spatial Attention for Visual Question Answering" class="ltx_ref"><span class="ltx_text ltx_ref_tag">1</span></a>, we see that models based on deep features significantly outperform the Multi-World approach based on hand-crafted features. Modeling the question only with either the LSTM model or Question BOW model does equally well in comparison, indicating the the question text contains important prior information for predicting the answer. Also, on this dataset, the VIS+LSTM model achieves better accuracy than Neural-Image-QA model; the former shows the image only at the first timestep of the LSTM, while the latter does so at each timestep. In comparison, both our One-Hop model and Two-Hop spatial attention models outperform the IMG+BOW, as well as the other baseline models.
A major advantage of our model is the ability to visualize the inference process in the deep network. To illustrate this, two attention weights visualization examples in SMem-VQA One-Hop and Two-Hop models on DAQUAR dataset are shown in Fig. <a href="#S4.F5" title="Figure 5 ‣ 4.2.1 Results on DAQUAR ‣ 4.2 Experiments on Standard Datasets ‣ 4 Experiments ‣ Ask, Attend and Answer: Exploring Question-Guided Spatial Attention for Visual Question Answering" class="ltx_ref"><span class="ltx_text ltx_ref_tag">5</span></a> (bottom row).</p>
</div>
<figure id="S4.F5" class="ltx_figure">
<div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_2"><img src="/html/1511.05234/assets/figures/VQA-DAQUAR_One-Hop_Two-Hop/CO_train2014_000000575060_5750602.jpg" id="S4.F5.g1" class="ltx_graphics ltx_figure_panel ltx_img_landscape" width="299" height="100" alt="Refer to caption"></div>
<div class="ltx_flex_cell ltx_flex_size_2"><img src="/html/1511.05234/assets/figures/VQA-DAQUAR_One-Hop_Two-Hop/CO_train2014_000000222383_2223830.jpg" id="S4.F5.g2" class="ltx_graphics ltx_figure_panel ltx_img_landscape" width="299" height="100" alt="Refer to caption"></div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_2"><img src="/html/1511.05234/assets/figures/VQA-DAQUAR_One-Hop_Two-Hop/image1183.png" id="S4.F5.g3" class="ltx_graphics ltx_figure_panel ltx_img_landscape" width="299" height="100" alt="Refer to caption"></div>
<div class="ltx_flex_cell ltx_flex_size_2"><img src="/html/1511.05234/assets/figures/VQA-DAQUAR_One-Hop_Two-Hop/image1444.png" id="S4.F5.g4" class="ltx_graphics ltx_figure_panel ltx_img_landscape" width="299" height="100" alt="Refer to caption"></div>
</div>
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure">Figure 5: </span>Visualization of the spatial attention weights in the SMem-VQA One-Hop and Two-Hop models on VQA (top row) and DAQUAR (bottom row) datasets. For each image and question pair, we show the original image, the attention weights <math id="S4.F5.4.m1.1" class="ltx_Math" alttext="W_{att}" display="inline"><semantics id="S4.F5.4.m1.1b"><msub id="S4.F5.4.m1.1.1" xref="S4.F5.4.m1.1.1.cmml"><mi id="S4.F5.4.m1.1.1.2" xref="S4.F5.4.m1.1.1.2.cmml">W</mi><mrow id="S4.F5.4.m1.1.1.3" xref="S4.F5.4.m1.1.1.3.cmml"><mi id="S4.F5.4.m1.1.1.3.2" xref="S4.F5.4.m1.1.1.3.2.cmml">a</mi><mo lspace="0em" rspace="0em" id="S4.F5.4.m1.1.1.3.1" xref="S4.F5.4.m1.1.1.3.1.cmml">​</mo><mi id="S4.F5.4.m1.1.1.3.3" xref="S4.F5.4.m1.1.1.3.3.cmml">t</mi><mo lspace="0em" rspace="0em" id="S4.F5.4.m1.1.1.3.1b" xref="S4.F5.4.m1.1.1.3.1.cmml">​</mo><mi id="S4.F5.4.m1.1.1.3.4" xref="S4.F5.4.m1.1.1.3.4.cmml">t</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S4.F5.4.m1.1c"><apply id="S4.F5.4.m1.1.1.cmml" xref="S4.F5.4.m1.1.1"><csymbol cd="ambiguous" id="S4.F5.4.m1.1.1.1.cmml" xref="S4.F5.4.m1.1.1">subscript</csymbol><ci id="S4.F5.4.m1.1.1.2.cmml" xref="S4.F5.4.m1.1.1.2">𝑊</ci><apply id="S4.F5.4.m1.1.1.3.cmml" xref="S4.F5.4.m1.1.1.3"><times id="S4.F5.4.m1.1.1.3.1.cmml" xref="S4.F5.4.m1.1.1.3.1"></times><ci id="S4.F5.4.m1.1.1.3.2.cmml" xref="S4.F5.4.m1.1.1.3.2">𝑎</ci><ci id="S4.F5.4.m1.1.1.3.3.cmml" xref="S4.F5.4.m1.1.1.3.3">𝑡</ci><ci id="S4.F5.4.m1.1.1.3.4.cmml" xref="S4.F5.4.m1.1.1.3.4">𝑡</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.F5.4.m1.1d">W_{att}</annotation></semantics></math> of the One-Hop model, and the two attention weights <math id="S4.F5.5.m2.1" class="ltx_Math" alttext="W_{att}" display="inline"><semantics id="S4.F5.5.m2.1b"><msub id="S4.F5.5.m2.1.1" xref="S4.F5.5.m2.1.1.cmml"><mi id="S4.F5.5.m2.1.1.2" xref="S4.F5.5.m2.1.1.2.cmml">W</mi><mrow id="S4.F5.5.m2.1.1.3" xref="S4.F5.5.m2.1.1.3.cmml"><mi id="S4.F5.5.m2.1.1.3.2" xref="S4.F5.5.m2.1.1.3.2.cmml">a</mi><mo lspace="0em" rspace="0em" id="S4.F5.5.m2.1.1.3.1" xref="S4.F5.5.m2.1.1.3.1.cmml">​</mo><mi id="S4.F5.5.m2.1.1.3.3" xref="S4.F5.5.m2.1.1.3.3.cmml">t</mi><mo lspace="0em" rspace="0em" id="S4.F5.5.m2.1.1.3.1b" xref="S4.F5.5.m2.1.1.3.1.cmml">​</mo><mi id="S4.F5.5.m2.1.1.3.4" xref="S4.F5.5.m2.1.1.3.4.cmml">t</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S4.F5.5.m2.1c"><apply id="S4.F5.5.m2.1.1.cmml" xref="S4.F5.5.m2.1.1"><csymbol cd="ambiguous" id="S4.F5.5.m2.1.1.1.cmml" xref="S4.F5.5.m2.1.1">subscript</csymbol><ci id="S4.F5.5.m2.1.1.2.cmml" xref="S4.F5.5.m2.1.1.2">𝑊</ci><apply id="S4.F5.5.m2.1.1.3.cmml" xref="S4.F5.5.m2.1.1.3"><times id="S4.F5.5.m2.1.1.3.1.cmml" xref="S4.F5.5.m2.1.1.3.1"></times><ci id="S4.F5.5.m2.1.1.3.2.cmml" xref="S4.F5.5.m2.1.1.3.2">𝑎</ci><ci id="S4.F5.5.m2.1.1.3.3.cmml" xref="S4.F5.5.m2.1.1.3.3">𝑡</ci><ci id="S4.F5.5.m2.1.1.3.4.cmml" xref="S4.F5.5.m2.1.1.3.4">𝑡</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.F5.5.m2.1d">W_{att}</annotation></semantics></math> and <math id="S4.F5.6.m3.1" class="ltx_Math" alttext="W_{att2}" display="inline"><semantics id="S4.F5.6.m3.1b"><msub id="S4.F5.6.m3.1.1" xref="S4.F5.6.m3.1.1.cmml"><mi id="S4.F5.6.m3.1.1.2" xref="S4.F5.6.m3.1.1.2.cmml">W</mi><mrow id="S4.F5.6.m3.1.1.3" xref="S4.F5.6.m3.1.1.3.cmml"><mi id="S4.F5.6.m3.1.1.3.2" xref="S4.F5.6.m3.1.1.3.2.cmml">a</mi><mo lspace="0em" rspace="0em" id="S4.F5.6.m3.1.1.3.1" xref="S4.F5.6.m3.1.1.3.1.cmml">​</mo><mi id="S4.F5.6.m3.1.1.3.3" xref="S4.F5.6.m3.1.1.3.3.cmml">t</mi><mo lspace="0em" rspace="0em" id="S4.F5.6.m3.1.1.3.1b" xref="S4.F5.6.m3.1.1.3.1.cmml">​</mo><mi id="S4.F5.6.m3.1.1.3.4" xref="S4.F5.6.m3.1.1.3.4.cmml">t</mi><mo lspace="0em" rspace="0em" id="S4.F5.6.m3.1.1.3.1c" xref="S4.F5.6.m3.1.1.3.1.cmml">​</mo><mn id="S4.F5.6.m3.1.1.3.5" xref="S4.F5.6.m3.1.1.3.5.cmml">2</mn></mrow></msub><annotation-xml encoding="MathML-Content" id="S4.F5.6.m3.1c"><apply id="S4.F5.6.m3.1.1.cmml" xref="S4.F5.6.m3.1.1"><csymbol cd="ambiguous" id="S4.F5.6.m3.1.1.1.cmml" xref="S4.F5.6.m3.1.1">subscript</csymbol><ci id="S4.F5.6.m3.1.1.2.cmml" xref="S4.F5.6.m3.1.1.2">𝑊</ci><apply id="S4.F5.6.m3.1.1.3.cmml" xref="S4.F5.6.m3.1.1.3"><times id="S4.F5.6.m3.1.1.3.1.cmml" xref="S4.F5.6.m3.1.1.3.1"></times><ci id="S4.F5.6.m3.1.1.3.2.cmml" xref="S4.F5.6.m3.1.1.3.2">𝑎</ci><ci id="S4.F5.6.m3.1.1.3.3.cmml" xref="S4.F5.6.m3.1.1.3.3">𝑡</ci><ci id="S4.F5.6.m3.1.1.3.4.cmml" xref="S4.F5.6.m3.1.1.3.4">𝑡</ci><cn type="integer" id="S4.F5.6.m3.1.1.3.5.cmml" xref="S4.F5.6.m3.1.1.3.5">2</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.F5.6.m3.1d">W_{att2}</annotation></semantics></math> of the Two-Hop model in order.</figcaption>
</figure>
</section>
<section id="S4.SS2.SSS2" class="ltx_subsubsection">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">4.2.2 </span>Results on VQA</h4>

<div id="S4.SS2.SSS2.p1" class="ltx_para">
<p id="S4.SS2.SSS2.p1.1" class="ltx_p">The VQA dataset is a recent large dataset based on MS COCO <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib30" title="" class="ltx_ref">30</a>]</cite>. We use the full release (V1.0) open-ended dataset, which contains a train set and a val set. Following standard practice, we choose the top 1000 answers in train and val sets as possible prediction answers, and only keep the examples whose answers belong to these 1000 answers as training data. The question vocabulary size is 7477 with the word frequency of at least three.
Because of the larger training size, the embedding dimension is 1000 on the VQA dataset.
We report the test-dev and test-standard results from the VQA evaluation server.
The server evaluation uses the evaluation metric introduced by <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib2" title="" class="ltx_ref">2</a>]</cite>, which gives partial credit to certain synonym answers:
<math id="S4.SS2.SSS2.p1.1.m1.4" class="ltx_Math" alttext="Acc({ans})=\min\left\{(\text{\# humans that said }{ans})/3,1\right\}" display="inline"><semantics id="S4.SS2.SSS2.p1.1.m1.4a"><mrow id="S4.SS2.SSS2.p1.1.m1.4.4" xref="S4.SS2.SSS2.p1.1.m1.4.4.cmml"><mrow id="S4.SS2.SSS2.p1.1.m1.3.3.1" xref="S4.SS2.SSS2.p1.1.m1.3.3.1.cmml"><mi id="S4.SS2.SSS2.p1.1.m1.3.3.1.3" xref="S4.SS2.SSS2.p1.1.m1.3.3.1.3.cmml">A</mi><mo lspace="0em" rspace="0em" id="S4.SS2.SSS2.p1.1.m1.3.3.1.2" xref="S4.SS2.SSS2.p1.1.m1.3.3.1.2.cmml">​</mo><mi id="S4.SS2.SSS2.p1.1.m1.3.3.1.4" xref="S4.SS2.SSS2.p1.1.m1.3.3.1.4.cmml">c</mi><mo lspace="0em" rspace="0em" id="S4.SS2.SSS2.p1.1.m1.3.3.1.2a" xref="S4.SS2.SSS2.p1.1.m1.3.3.1.2.cmml">​</mo><mi id="S4.SS2.SSS2.p1.1.m1.3.3.1.5" xref="S4.SS2.SSS2.p1.1.m1.3.3.1.5.cmml">c</mi><mo lspace="0em" rspace="0em" id="S4.SS2.SSS2.p1.1.m1.3.3.1.2b" xref="S4.SS2.SSS2.p1.1.m1.3.3.1.2.cmml">​</mo><mrow id="S4.SS2.SSS2.p1.1.m1.3.3.1.1.1" xref="S4.SS2.SSS2.p1.1.m1.3.3.1.1.1.1.cmml"><mo stretchy="false" id="S4.SS2.SSS2.p1.1.m1.3.3.1.1.1.2" xref="S4.SS2.SSS2.p1.1.m1.3.3.1.1.1.1.cmml">(</mo><mrow id="S4.SS2.SSS2.p1.1.m1.3.3.1.1.1.1" xref="S4.SS2.SSS2.p1.1.m1.3.3.1.1.1.1.cmml"><mi id="S4.SS2.SSS2.p1.1.m1.3.3.1.1.1.1.2" xref="S4.SS2.SSS2.p1.1.m1.3.3.1.1.1.1.2.cmml">a</mi><mo lspace="0em" rspace="0em" id="S4.SS2.SSS2.p1.1.m1.3.3.1.1.1.1.1" xref="S4.SS2.SSS2.p1.1.m1.3.3.1.1.1.1.1.cmml">​</mo><mi id="S4.SS2.SSS2.p1.1.m1.3.3.1.1.1.1.3" xref="S4.SS2.SSS2.p1.1.m1.3.3.1.1.1.1.3.cmml">n</mi><mo lspace="0em" rspace="0em" id="S4.SS2.SSS2.p1.1.m1.3.3.1.1.1.1.1a" xref="S4.SS2.SSS2.p1.1.m1.3.3.1.1.1.1.1.cmml">​</mo><mi id="S4.SS2.SSS2.p1.1.m1.3.3.1.1.1.1.4" xref="S4.SS2.SSS2.p1.1.m1.3.3.1.1.1.1.4.cmml">s</mi></mrow><mo stretchy="false" id="S4.SS2.SSS2.p1.1.m1.3.3.1.1.1.3" xref="S4.SS2.SSS2.p1.1.m1.3.3.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S4.SS2.SSS2.p1.1.m1.4.4.3" xref="S4.SS2.SSS2.p1.1.m1.4.4.3.cmml">=</mo><mrow id="S4.SS2.SSS2.p1.1.m1.4.4.2.1" xref="S4.SS2.SSS2.p1.1.m1.4.4.2.2.cmml"><mi id="S4.SS2.SSS2.p1.1.m1.1.1" xref="S4.SS2.SSS2.p1.1.m1.1.1.cmml">min</mi><mo id="S4.SS2.SSS2.p1.1.m1.4.4.2.1a" xref="S4.SS2.SSS2.p1.1.m1.4.4.2.2.cmml">⁡</mo><mrow id="S4.SS2.SSS2.p1.1.m1.4.4.2.1.1" xref="S4.SS2.SSS2.p1.1.m1.4.4.2.2.cmml"><mo id="S4.SS2.SSS2.p1.1.m1.4.4.2.1.1.2" xref="S4.SS2.SSS2.p1.1.m1.4.4.2.2.cmml">{</mo><mrow id="S4.SS2.SSS2.p1.1.m1.4.4.2.1.1.1" xref="S4.SS2.SSS2.p1.1.m1.4.4.2.1.1.1.cmml"><mrow id="S4.SS2.SSS2.p1.1.m1.4.4.2.1.1.1.1.1" xref="S4.SS2.SSS2.p1.1.m1.4.4.2.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S4.SS2.SSS2.p1.1.m1.4.4.2.1.1.1.1.1.2" xref="S4.SS2.SSS2.p1.1.m1.4.4.2.1.1.1.1.1.1.cmml">(</mo><mrow id="S4.SS2.SSS2.p1.1.m1.4.4.2.1.1.1.1.1.1" xref="S4.SS2.SSS2.p1.1.m1.4.4.2.1.1.1.1.1.1.cmml"><mtext id="S4.SS2.SSS2.p1.1.m1.4.4.2.1.1.1.1.1.1.2" xref="S4.SS2.SSS2.p1.1.m1.4.4.2.1.1.1.1.1.1.2a.cmml"># humans that said </mtext><mo lspace="0em" rspace="0em" id="S4.SS2.SSS2.p1.1.m1.4.4.2.1.1.1.1.1.1.1" xref="S4.SS2.SSS2.p1.1.m1.4.4.2.1.1.1.1.1.1.1.cmml">​</mo><mi id="S4.SS2.SSS2.p1.1.m1.4.4.2.1.1.1.1.1.1.3" xref="S4.SS2.SSS2.p1.1.m1.4.4.2.1.1.1.1.1.1.3.cmml">a</mi><mo lspace="0em" rspace="0em" id="S4.SS2.SSS2.p1.1.m1.4.4.2.1.1.1.1.1.1.1a" xref="S4.SS2.SSS2.p1.1.m1.4.4.2.1.1.1.1.1.1.1.cmml">​</mo><mi id="S4.SS2.SSS2.p1.1.m1.4.4.2.1.1.1.1.1.1.4" xref="S4.SS2.SSS2.p1.1.m1.4.4.2.1.1.1.1.1.1.4.cmml">n</mi><mo lspace="0em" rspace="0em" id="S4.SS2.SSS2.p1.1.m1.4.4.2.1.1.1.1.1.1.1b" xref="S4.SS2.SSS2.p1.1.m1.4.4.2.1.1.1.1.1.1.1.cmml">​</mo><mi id="S4.SS2.SSS2.p1.1.m1.4.4.2.1.1.1.1.1.1.5" xref="S4.SS2.SSS2.p1.1.m1.4.4.2.1.1.1.1.1.1.5.cmml">s</mi></mrow><mo stretchy="false" id="S4.SS2.SSS2.p1.1.m1.4.4.2.1.1.1.1.1.3" xref="S4.SS2.SSS2.p1.1.m1.4.4.2.1.1.1.1.1.1.cmml">)</mo></mrow><mo id="S4.SS2.SSS2.p1.1.m1.4.4.2.1.1.1.2" xref="S4.SS2.SSS2.p1.1.m1.4.4.2.1.1.1.2.cmml">/</mo><mn id="S4.SS2.SSS2.p1.1.m1.4.4.2.1.1.1.3" xref="S4.SS2.SSS2.p1.1.m1.4.4.2.1.1.1.3.cmml">3</mn></mrow><mo id="S4.SS2.SSS2.p1.1.m1.4.4.2.1.1.3" xref="S4.SS2.SSS2.p1.1.m1.4.4.2.2.cmml">,</mo><mn id="S4.SS2.SSS2.p1.1.m1.2.2" xref="S4.SS2.SSS2.p1.1.m1.2.2.cmml">1</mn><mo id="S4.SS2.SSS2.p1.1.m1.4.4.2.1.1.4" xref="S4.SS2.SSS2.p1.1.m1.4.4.2.2.cmml">}</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.SSS2.p1.1.m1.4b"><apply id="S4.SS2.SSS2.p1.1.m1.4.4.cmml" xref="S4.SS2.SSS2.p1.1.m1.4.4"><eq id="S4.SS2.SSS2.p1.1.m1.4.4.3.cmml" xref="S4.SS2.SSS2.p1.1.m1.4.4.3"></eq><apply id="S4.SS2.SSS2.p1.1.m1.3.3.1.cmml" xref="S4.SS2.SSS2.p1.1.m1.3.3.1"><times id="S4.SS2.SSS2.p1.1.m1.3.3.1.2.cmml" xref="S4.SS2.SSS2.p1.1.m1.3.3.1.2"></times><ci id="S4.SS2.SSS2.p1.1.m1.3.3.1.3.cmml" xref="S4.SS2.SSS2.p1.1.m1.3.3.1.3">𝐴</ci><ci id="S4.SS2.SSS2.p1.1.m1.3.3.1.4.cmml" xref="S4.SS2.SSS2.p1.1.m1.3.3.1.4">𝑐</ci><ci id="S4.SS2.SSS2.p1.1.m1.3.3.1.5.cmml" xref="S4.SS2.SSS2.p1.1.m1.3.3.1.5">𝑐</ci><apply id="S4.SS2.SSS2.p1.1.m1.3.3.1.1.1.1.cmml" xref="S4.SS2.SSS2.p1.1.m1.3.3.1.1.1"><times id="S4.SS2.SSS2.p1.1.m1.3.3.1.1.1.1.1.cmml" xref="S4.SS2.SSS2.p1.1.m1.3.3.1.1.1.1.1"></times><ci id="S4.SS2.SSS2.p1.1.m1.3.3.1.1.1.1.2.cmml" xref="S4.SS2.SSS2.p1.1.m1.3.3.1.1.1.1.2">𝑎</ci><ci id="S4.SS2.SSS2.p1.1.m1.3.3.1.1.1.1.3.cmml" xref="S4.SS2.SSS2.p1.1.m1.3.3.1.1.1.1.3">𝑛</ci><ci id="S4.SS2.SSS2.p1.1.m1.3.3.1.1.1.1.4.cmml" xref="S4.SS2.SSS2.p1.1.m1.3.3.1.1.1.1.4">𝑠</ci></apply></apply><apply id="S4.SS2.SSS2.p1.1.m1.4.4.2.2.cmml" xref="S4.SS2.SSS2.p1.1.m1.4.4.2.1"><min id="S4.SS2.SSS2.p1.1.m1.1.1.cmml" xref="S4.SS2.SSS2.p1.1.m1.1.1"></min><apply id="S4.SS2.SSS2.p1.1.m1.4.4.2.1.1.1.cmml" xref="S4.SS2.SSS2.p1.1.m1.4.4.2.1.1.1"><divide id="S4.SS2.SSS2.p1.1.m1.4.4.2.1.1.1.2.cmml" xref="S4.SS2.SSS2.p1.1.m1.4.4.2.1.1.1.2"></divide><apply id="S4.SS2.SSS2.p1.1.m1.4.4.2.1.1.1.1.1.1.cmml" xref="S4.SS2.SSS2.p1.1.m1.4.4.2.1.1.1.1.1"><times id="S4.SS2.SSS2.p1.1.m1.4.4.2.1.1.1.1.1.1.1.cmml" xref="S4.SS2.SSS2.p1.1.m1.4.4.2.1.1.1.1.1.1.1"></times><ci id="S4.SS2.SSS2.p1.1.m1.4.4.2.1.1.1.1.1.1.2a.cmml" xref="S4.SS2.SSS2.p1.1.m1.4.4.2.1.1.1.1.1.1.2"><mtext id="S4.SS2.SSS2.p1.1.m1.4.4.2.1.1.1.1.1.1.2.cmml" xref="S4.SS2.SSS2.p1.1.m1.4.4.2.1.1.1.1.1.1.2"># humans that said </mtext></ci><ci id="S4.SS2.SSS2.p1.1.m1.4.4.2.1.1.1.1.1.1.3.cmml" xref="S4.SS2.SSS2.p1.1.m1.4.4.2.1.1.1.1.1.1.3">𝑎</ci><ci id="S4.SS2.SSS2.p1.1.m1.4.4.2.1.1.1.1.1.1.4.cmml" xref="S4.SS2.SSS2.p1.1.m1.4.4.2.1.1.1.1.1.1.4">𝑛</ci><ci id="S4.SS2.SSS2.p1.1.m1.4.4.2.1.1.1.1.1.1.5.cmml" xref="S4.SS2.SSS2.p1.1.m1.4.4.2.1.1.1.1.1.1.5">𝑠</ci></apply><cn type="integer" id="S4.SS2.SSS2.p1.1.m1.4.4.2.1.1.1.3.cmml" xref="S4.SS2.SSS2.p1.1.m1.4.4.2.1.1.1.3">3</cn></apply><cn type="integer" id="S4.SS2.SSS2.p1.1.m1.2.2.cmml" xref="S4.SS2.SSS2.p1.1.m1.2.2">1</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.SSS2.p1.1.m1.4c">Acc({ans})=\min\left\{(\text{\# humans that said }{ans})/3,1\right\}</annotation></semantics></math>.</p>
</div>
<div id="S4.SS2.SSS2.p2" class="ltx_para">
<p id="S4.SS2.SSS2.p2.1" class="ltx_p">For the attention models, we do not mirror the input image when using the CNN to extract convolutional features, since this might cause confusion about the spatial locations of objects in the input image.
The optimization algorithm used is stochastic gradient descent (SGD) with a minibatch of size 50 and momentum of 0.9.
The base learning rate is set to be 0.01 which is halved every six epoches. Regularization, dropout and L2 norm are cross-validated and used.</p>
</div>
<figure id="S4.T2" class="ltx_table">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table">Table 2: </span>Test-dev and test-standard results on the Open-Ended VQA dataset (in percentage). Models with <sup id="S4.T2.6.1" class="ltx_sup">∗</sup> use external training data in addition to the VQA dataset.</figcaption>
<table id="S4.T2.4" class="ltx_tabular ltx_centering ltx_guessed_headers ltx_align_middle">
<tbody class="ltx_tbody">
<tr id="S4.T2.4.3.1" class="ltx_tr">
<th id="S4.T2.4.3.1.1" class="ltx_td ltx_th ltx_th_row ltx_border_rr ltx_border_t"></th>
<td id="S4.T2.4.3.1.2" class="ltx_td ltx_align_center ltx_border_rr ltx_border_t" colspan="4"><span id="S4.T2.4.3.1.2.1" class="ltx_text" style="font-size:70%;">test-dev</span></td>
<td id="S4.T2.4.3.1.3" class="ltx_td ltx_align_center ltx_border_t" colspan="4"><span id="S4.T2.4.3.1.3.1" class="ltx_text" style="font-size:70%;">test-standard</span></td>
</tr>
<tr id="S4.T2.4.4.2" class="ltx_tr">
<th id="S4.T2.4.4.2.1" class="ltx_td ltx_th ltx_th_row ltx_border_rr"></th>
<td id="S4.T2.4.4.2.2" class="ltx_td ltx_align_center"><span id="S4.T2.4.4.2.2.1" class="ltx_text ltx_font_bold" style="font-size:70%;">Overall</span></td>
<td id="S4.T2.4.4.2.3" class="ltx_td ltx_align_center"><span id="S4.T2.4.4.2.3.1" class="ltx_text" style="font-size:70%;">yes/no</span></td>
<td id="S4.T2.4.4.2.4" class="ltx_td ltx_align_center"><span id="S4.T2.4.4.2.4.1" class="ltx_text" style="font-size:70%;">number</span></td>
<td id="S4.T2.4.4.2.5" class="ltx_td ltx_align_center ltx_border_rr"><span id="S4.T2.4.4.2.5.1" class="ltx_text" style="font-size:70%;">others</span></td>
<td id="S4.T2.4.4.2.6" class="ltx_td ltx_align_center"><span id="S4.T2.4.4.2.6.1" class="ltx_text ltx_font_bold" style="font-size:70%;">Overall</span></td>
<td id="S4.T2.4.4.2.7" class="ltx_td ltx_align_center"><span id="S4.T2.4.4.2.7.1" class="ltx_text" style="font-size:70%;">yes/no</span></td>
<td id="S4.T2.4.4.2.8" class="ltx_td ltx_align_center"><span id="S4.T2.4.4.2.8.1" class="ltx_text" style="font-size:70%;">number</span></td>
<td id="S4.T2.4.4.2.9" class="ltx_td ltx_align_center"><span id="S4.T2.4.4.2.9.1" class="ltx_text" style="font-size:70%;">others</span></td>
</tr>
<tr id="S4.T2.4.5.3" class="ltx_tr">
<th id="S4.T2.4.5.3.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_rr ltx_border_t">
<span id="S4.T2.4.5.3.1.1" class="ltx_text" style="font-size:70%;">LSTM Q+I </span><cite class="ltx_cite ltx_citemacro_cite"><span id="S4.T2.4.5.3.1.2.1" class="ltx_text" style="font-size:70%;">[</span><a href="#bib.bib2" title="" class="ltx_ref">2</a><span id="S4.T2.4.5.3.1.3.2" class="ltx_text" style="font-size:70%;">]</span></cite>
</th>
<td id="S4.T2.4.5.3.2" class="ltx_td ltx_align_center ltx_border_t"><span id="S4.T2.4.5.3.2.1" class="ltx_text" style="font-size:70%;">53.74</span></td>
<td id="S4.T2.4.5.3.3" class="ltx_td ltx_align_center ltx_border_t"><span id="S4.T2.4.5.3.3.1" class="ltx_text" style="font-size:70%;">78.94</span></td>
<td id="S4.T2.4.5.3.4" class="ltx_td ltx_align_center ltx_border_t"><span id="S4.T2.4.5.3.4.1" class="ltx_text" style="font-size:70%;">35.24</span></td>
<td id="S4.T2.4.5.3.5" class="ltx_td ltx_align_center ltx_border_rr ltx_border_t"><span id="S4.T2.4.5.3.5.1" class="ltx_text" style="font-size:70%;">36.42</span></td>
<td id="S4.T2.4.5.3.6" class="ltx_td ltx_align_center ltx_border_t"><span id="S4.T2.4.5.3.6.1" class="ltx_text" style="font-size:70%;">54.06</span></td>
<td id="S4.T2.4.5.3.7" class="ltx_td ltx_align_center ltx_border_t"><span id="S4.T2.4.5.3.7.1" class="ltx_text" style="font-size:70%;">-</span></td>
<td id="S4.T2.4.5.3.8" class="ltx_td ltx_align_center ltx_border_t"><span id="S4.T2.4.5.3.8.1" class="ltx_text" style="font-size:70%;">-</span></td>
<td id="S4.T2.4.5.3.9" class="ltx_td ltx_align_center ltx_border_t"><span id="S4.T2.4.5.3.9.1" class="ltx_text" style="font-size:70%;">-</span></td>
</tr>
<tr id="S4.T2.3.1" class="ltx_tr">
<th id="S4.T2.3.1.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_rr">
<span id="S4.T2.3.1.1.1" class="ltx_text" style="font-size:70%;">ACK</span><sup id="S4.T2.3.1.1.2" class="ltx_sup"><span id="S4.T2.3.1.1.2.1" class="ltx_text" style="font-size:70%;">∗</span></sup><span id="S4.T2.3.1.1.3" class="ltx_text" style="font-size:70%;"> </span><cite class="ltx_cite ltx_citemacro_cite"><span id="S4.T2.3.1.1.4.1" class="ltx_text" style="font-size:70%;">[</span><a href="#bib.bib26" title="" class="ltx_ref">26</a><span id="S4.T2.3.1.1.5.2" class="ltx_text" style="font-size:70%;">]</span></cite>
</th>
<td id="S4.T2.3.1.2" class="ltx_td ltx_align_center"><span id="S4.T2.3.1.2.1" class="ltx_text" style="font-size:70%;">55.72</span></td>
<td id="S4.T2.3.1.3" class="ltx_td ltx_align_center"><span id="S4.T2.3.1.3.1" class="ltx_text" style="font-size:70%;">79.23</span></td>
<td id="S4.T2.3.1.4" class="ltx_td ltx_align_center"><span id="S4.T2.3.1.4.1" class="ltx_text" style="font-size:70%;">36.13</span></td>
<td id="S4.T2.3.1.5" class="ltx_td ltx_align_center ltx_border_rr"><span id="S4.T2.3.1.5.1" class="ltx_text" style="font-size:70%;">40.08</span></td>
<td id="S4.T2.3.1.6" class="ltx_td ltx_align_center"><span id="S4.T2.3.1.6.1" class="ltx_text" style="font-size:70%;">55.98</span></td>
<td id="S4.T2.3.1.7" class="ltx_td ltx_align_center"><span id="S4.T2.3.1.7.1" class="ltx_text" style="font-size:70%;">79.05</span></td>
<td id="S4.T2.3.1.8" class="ltx_td ltx_align_center"><span id="S4.T2.3.1.8.1" class="ltx_text" style="font-size:70%;">36.10</span></td>
<td id="S4.T2.3.1.9" class="ltx_td ltx_align_center"><span id="S4.T2.3.1.9.1" class="ltx_text" style="font-size:70%;">40.61</span></td>
</tr>
<tr id="S4.T2.4.2" class="ltx_tr">
<th id="S4.T2.4.2.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_rr">
<span id="S4.T2.4.2.1.1" class="ltx_text" style="font-size:70%;">DPPnet</span><sup id="S4.T2.4.2.1.2" class="ltx_sup"><span id="S4.T2.4.2.1.2.1" class="ltx_text" style="font-size:70%;">∗</span></sup><span id="S4.T2.4.2.1.3" class="ltx_text" style="font-size:70%;"> </span><cite class="ltx_cite ltx_citemacro_cite"><span id="S4.T2.4.2.1.4.1" class="ltx_text" style="font-size:70%;">[</span><a href="#bib.bib27" title="" class="ltx_ref">27</a><span id="S4.T2.4.2.1.5.2" class="ltx_text" style="font-size:70%;">]</span></cite>
</th>
<td id="S4.T2.4.2.2" class="ltx_td ltx_align_center"><span id="S4.T2.4.2.2.1" class="ltx_text" style="font-size:70%;">57.22</span></td>
<td id="S4.T2.4.2.3" class="ltx_td ltx_align_center"><span id="S4.T2.4.2.3.1" class="ltx_text" style="font-size:70%;">80.71</span></td>
<td id="S4.T2.4.2.4" class="ltx_td ltx_align_center"><span id="S4.T2.4.2.4.1" class="ltx_text" style="font-size:70%;">37.24</span></td>
<td id="S4.T2.4.2.5" class="ltx_td ltx_align_center ltx_border_rr"><span id="S4.T2.4.2.5.1" class="ltx_text" style="font-size:70%;">41.69</span></td>
<td id="S4.T2.4.2.6" class="ltx_td ltx_align_center"><span id="S4.T2.4.2.6.1" class="ltx_text" style="font-size:70%;">57.36</span></td>
<td id="S4.T2.4.2.7" class="ltx_td ltx_align_center"><span id="S4.T2.4.2.7.1" class="ltx_text" style="font-size:70%;">80.28</span></td>
<td id="S4.T2.4.2.8" class="ltx_td ltx_align_center"><span id="S4.T2.4.2.8.1" class="ltx_text" style="font-size:70%;">36.92</span></td>
<td id="S4.T2.4.2.9" class="ltx_td ltx_align_center"><span id="S4.T2.4.2.9.1" class="ltx_text" style="font-size:70%;">42.24</span></td>
</tr>
<tr id="S4.T2.4.6.4" class="ltx_tr">
<th id="S4.T2.4.6.4.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_rr">
<span id="S4.T2.4.6.4.1.1" class="ltx_text" style="font-size:70%;">iBOWIMG </span><cite class="ltx_cite ltx_citemacro_cite"><span id="S4.T2.4.6.4.1.2.1" class="ltx_text" style="font-size:70%;">[</span><a href="#bib.bib3" title="" class="ltx_ref">3</a><span id="S4.T2.4.6.4.1.3.2" class="ltx_text" style="font-size:70%;">]</span></cite>
</th>
<td id="S4.T2.4.6.4.2" class="ltx_td ltx_align_center"><span id="S4.T2.4.6.4.2.1" class="ltx_text" style="font-size:70%;">55.72</span></td>
<td id="S4.T2.4.6.4.3" class="ltx_td ltx_align_center"><span id="S4.T2.4.6.4.3.1" class="ltx_text" style="font-size:70%;">76.55</span></td>
<td id="S4.T2.4.6.4.4" class="ltx_td ltx_align_center"><span id="S4.T2.4.6.4.4.1" class="ltx_text" style="font-size:70%;">35.03</span></td>
<td id="S4.T2.4.6.4.5" class="ltx_td ltx_align_center ltx_border_rr"><span id="S4.T2.4.6.4.5.1" class="ltx_text" style="font-size:70%;">42.62</span></td>
<td id="S4.T2.4.6.4.6" class="ltx_td ltx_align_center"><span id="S4.T2.4.6.4.6.1" class="ltx_text" style="font-size:70%;">55.89</span></td>
<td id="S4.T2.4.6.4.7" class="ltx_td ltx_align_center"><span id="S4.T2.4.6.4.7.1" class="ltx_text" style="font-size:70%;">76.76</span></td>
<td id="S4.T2.4.6.4.8" class="ltx_td ltx_align_center"><span id="S4.T2.4.6.4.8.1" class="ltx_text" style="font-size:70%;">34.98</span></td>
<td id="S4.T2.4.6.4.9" class="ltx_td ltx_align_center"><span id="S4.T2.4.6.4.9.1" class="ltx_text" style="font-size:70%;">42.62</span></td>
</tr>
<tr id="S4.T2.4.7.5" class="ltx_tr">
<th id="S4.T2.4.7.5.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_rr ltx_border_t"><span id="S4.T2.4.7.5.1.1" class="ltx_text" style="font-size:70%;">SMem-VQA One-Hop</span></th>
<td id="S4.T2.4.7.5.2" class="ltx_td ltx_align_center ltx_border_t"><span id="S4.T2.4.7.5.2.1" class="ltx_text" style="font-size:70%;">56.56</span></td>
<td id="S4.T2.4.7.5.3" class="ltx_td ltx_align_center ltx_border_t"><span id="S4.T2.4.7.5.3.1" class="ltx_text" style="font-size:70%;">78.98</span></td>
<td id="S4.T2.4.7.5.4" class="ltx_td ltx_align_center ltx_border_t"><span id="S4.T2.4.7.5.4.1" class="ltx_text" style="font-size:70%;">35.93</span></td>
<td id="S4.T2.4.7.5.5" class="ltx_td ltx_align_center ltx_border_rr ltx_border_t"><span id="S4.T2.4.7.5.5.1" class="ltx_text" style="font-size:70%;">42.09</span></td>
<td id="S4.T2.4.7.5.6" class="ltx_td ltx_align_center ltx_border_t"><span id="S4.T2.4.7.5.6.1" class="ltx_text" style="font-size:70%;">-</span></td>
<td id="S4.T2.4.7.5.7" class="ltx_td ltx_align_center ltx_border_t"><span id="S4.T2.4.7.5.7.1" class="ltx_text" style="font-size:70%;">-</span></td>
<td id="S4.T2.4.7.5.8" class="ltx_td ltx_align_center ltx_border_t"><span id="S4.T2.4.7.5.8.1" class="ltx_text" style="font-size:70%;">-</span></td>
<td id="S4.T2.4.7.5.9" class="ltx_td ltx_align_center ltx_border_t"><span id="S4.T2.4.7.5.9.1" class="ltx_text" style="font-size:70%;">-</span></td>
</tr>
<tr id="S4.T2.4.8.6" class="ltx_tr">
<th id="S4.T2.4.8.6.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_b ltx_border_rr"><span id="S4.T2.4.8.6.1.1" class="ltx_text" style="font-size:70%;">SMem-VQA Two-Hop</span></th>
<td id="S4.T2.4.8.6.2" class="ltx_td ltx_align_center ltx_border_b"><span id="S4.T2.4.8.6.2.1" class="ltx_text ltx_font_bold" style="font-size:70%;">57.99</span></td>
<td id="S4.T2.4.8.6.3" class="ltx_td ltx_align_center ltx_border_b"><span id="S4.T2.4.8.6.3.1" class="ltx_text ltx_font_bold" style="font-size:70%;">80.87</span></td>
<td id="S4.T2.4.8.6.4" class="ltx_td ltx_align_center ltx_border_b"><span id="S4.T2.4.8.6.4.1" class="ltx_text ltx_font_bold" style="font-size:70%;">37.32</span></td>
<td id="S4.T2.4.8.6.5" class="ltx_td ltx_align_center ltx_border_b ltx_border_rr"><span id="S4.T2.4.8.6.5.1" class="ltx_text ltx_font_bold" style="font-size:70%;">43.12</span></td>
<td id="S4.T2.4.8.6.6" class="ltx_td ltx_align_center ltx_border_b"><span id="S4.T2.4.8.6.6.1" class="ltx_text ltx_font_bold" style="font-size:70%;">58.24</span></td>
<td id="S4.T2.4.8.6.7" class="ltx_td ltx_align_center ltx_border_b"><span id="S4.T2.4.8.6.7.1" class="ltx_text ltx_font_bold" style="font-size:70%;">80.8</span></td>
<td id="S4.T2.4.8.6.8" class="ltx_td ltx_align_center ltx_border_b"><span id="S4.T2.4.8.6.8.1" class="ltx_text ltx_font_bold" style="font-size:70%;">37.53</span></td>
<td id="S4.T2.4.8.6.9" class="ltx_td ltx_align_center ltx_border_b"><span id="S4.T2.4.8.6.9.1" class="ltx_text ltx_font_bold" style="font-size:70%;">43.48</span></td>
</tr>
</tbody>
</table>
</figure>
<div id="S4.SS2.SSS2.p3" class="ltx_para">
<p id="S4.SS2.SSS2.p3.4" class="ltx_p">For the VQA dataset, we use the simple iBOWIMG model in <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib3" title="" class="ltx_ref">3</a>]</cite> as one baseline model, which beats most existing VQA models currently on arxiv.org. We also compare to two models in <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib26" title="" class="ltx_ref">26</a>]</cite><cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib27" title="" class="ltx_ref">27</a>]</cite> which have comparable or better results to the iBOWIMG model. These three baseline models as well the best model in VQA dataset paper <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib2" title="" class="ltx_ref">2</a>]</cite> are listed in the following:
<br class="ltx_break"><math id="S4.SS2.SSS2.p3.1.m1.1" class="ltx_Math" alttext="\bullet" display="inline"><semantics id="S4.SS2.SSS2.p3.1.m1.1a"><mo id="S4.SS2.SSS2.p3.1.m1.1.1" xref="S4.SS2.SSS2.p3.1.m1.1.1.cmml">∙</mo><annotation-xml encoding="MathML-Content" id="S4.SS2.SSS2.p3.1.m1.1b"><ci id="S4.SS2.SSS2.p3.1.m1.1.1.cmml" xref="S4.SS2.SSS2.p3.1.m1.1.1">∙</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.SSS2.p3.1.m1.1c">\bullet</annotation></semantics></math> <span id="S4.SS2.SSS2.p3.4.1" class="ltx_text ltx_font_bold">LSTM Q+I</span> <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib2" title="" class="ltx_ref">2</a>]</cite>: uses the element-wise multiplication of the LSTM encoding of the question and the image feature vector to predict the answer. This is the best model in the VQA dataset paper.
<br class="ltx_break"><math id="S4.SS2.SSS2.p3.2.m2.1" class="ltx_Math" alttext="\bullet" display="inline"><semantics id="S4.SS2.SSS2.p3.2.m2.1a"><mo id="S4.SS2.SSS2.p3.2.m2.1.1" xref="S4.SS2.SSS2.p3.2.m2.1.1.cmml">∙</mo><annotation-xml encoding="MathML-Content" id="S4.SS2.SSS2.p3.2.m2.1b"><ci id="S4.SS2.SSS2.p3.2.m2.1.1.cmml" xref="S4.SS2.SSS2.p3.2.m2.1.1">∙</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.SSS2.p3.2.m2.1c">\bullet</annotation></semantics></math> <span id="S4.SS2.SSS2.p3.4.2" class="ltx_text ltx_font_bold">ACK</span> <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib26" title="" class="ltx_ref">26</a>]</cite>: shows the image attribute features, the generated image caption and relevant external knowledge from knowledge base to the LSTM at the first time step, and the question in the remaining time steps to predict the answer.
<br class="ltx_break"><math id="S4.SS2.SSS2.p3.3.m3.1" class="ltx_Math" alttext="\bullet" display="inline"><semantics id="S4.SS2.SSS2.p3.3.m3.1a"><mo id="S4.SS2.SSS2.p3.3.m3.1.1" xref="S4.SS2.SSS2.p3.3.m3.1.1.cmml">∙</mo><annotation-xml encoding="MathML-Content" id="S4.SS2.SSS2.p3.3.m3.1b"><ci id="S4.SS2.SSS2.p3.3.m3.1.1.cmml" xref="S4.SS2.SSS2.p3.3.m3.1.1">∙</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.SSS2.p3.3.m3.1c">\bullet</annotation></semantics></math> <span id="S4.SS2.SSS2.p3.4.3" class="ltx_text ltx_font_bold">DPPnet</span> <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib27" title="" class="ltx_ref">27</a>]</cite>: uses the Gated Recurrent Unit (GRU) representation of question to predict certain parameters for a CNN classification network. They pre-train the GRU for question representation on a large-scale text corpus to improve the GRU generalization performance.
<br class="ltx_break"><math id="S4.SS2.SSS2.p3.4.m4.1" class="ltx_Math" alttext="\bullet" display="inline"><semantics id="S4.SS2.SSS2.p3.4.m4.1a"><mo id="S4.SS2.SSS2.p3.4.m4.1.1" xref="S4.SS2.SSS2.p3.4.m4.1.1.cmml">∙</mo><annotation-xml encoding="MathML-Content" id="S4.SS2.SSS2.p3.4.m4.1b"><ci id="S4.SS2.SSS2.p3.4.m4.1.1.cmml" xref="S4.SS2.SSS2.p3.4.m4.1.1">∙</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.SSS2.p3.4.m4.1c">\bullet</annotation></semantics></math> <span id="S4.SS2.SSS2.p3.4.4" class="ltx_text ltx_font_bold">iBOWIMG</span> <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib3" title="" class="ltx_ref">3</a>]</cite>: concatenates the BOW question representation with image feature (GoogLeNet), and uses a softmax classification to predict the answer.</p>
</div>
<div id="S4.SS2.SSS2.p4" class="ltx_para">
<p id="S4.SS2.SSS2.p4.1" class="ltx_p">The overall accuracy and per-answer category accuracy for our SMem-VQA models and the four baseline models on VQA dataset are shown in Tab. <a href="#S4.T2" title="Table 2 ‣ 4.2.2 Results on VQA ‣ 4.2 Experiments on Standard Datasets ‣ 4 Experiments ‣ Ask, Attend and Answer: Exploring Question-Guided Spatial Attention for Visual Question Answering" class="ltx_ref"><span class="ltx_text ltx_ref_tag">2</span></a>. From the table, we can see that the SMem-VQA One-Hop model obtains slightly better results compared to the iBOWIMG model. However, the SMem-VQA Two-Hop model achieves an improvement of 2.27% on test-dev and 2.35% on test-standard compared to the iBOWIMG model, demonstrating the value of spatial attention. The SMem-VQA Two-Hop model also shows best performance in the per-answer category accuracy.
The SMem-VQA Two-Hop model has slightly better result than the DPPnet model.
The DPPnet model uses a large-scale text corpus to pre-train the Gated Recurrent Unit (GRU) network for question representation.
Similar pre-training work on extra data to improve model accuracy has been done in <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib32" title="" class="ltx_ref">32</a>]</cite>.
Considering the fact that our model does not use extra data to pre-train the word embeddings, its results are very competitive.
We also experiment with adding a third hop into our model on the VQA dataset, but the result does not improve further.</p>
</div>
<div id="S4.SS2.SSS2.p5" class="ltx_para">
<p id="S4.SS2.SSS2.p5.1" class="ltx_p">The attention weights visualization examples for the SMem-VQA One-Hop and Two-Hop models on the VQA dataset are shown in Fig. <a href="#S4.F5" title="Figure 5 ‣ 4.2.1 Results on DAQUAR ‣ 4.2 Experiments on Standard Datasets ‣ 4 Experiments ‣ Ask, Attend and Answer: Exploring Question-Guided Spatial Attention for Visual Question Answering" class="ltx_ref"><span class="ltx_text ltx_ref_tag">5</span></a> (top row). From the visualization, we can see that the two-hop model collects supplementary evidence for inferring the answer, which may be necessary to achieve an improvement on these complicated real-world datasets. We also visualize the fine-grained alignment in the first hop of our SMem-VQA Two-Hop model in Fig. <a href="#S4.F6" title="Figure 6 ‣ 4.2.2 Results on VQA ‣ 4.2 Experiments on Standard Datasets ‣ 4 Experiments ‣ Ask, Attend and Answer: Exploring Question-Guided Spatial Attention for Visual Question Answering" class="ltx_ref"><span class="ltx_text ltx_ref_tag">6</span></a>.
The correlation vector values (blue bars) measure the correlation between image regions and each word vector in the question. Higher values indicate stronger correlation of that particular word with the specific location’s image features. We observe that the fine-grained visual evidence collected using each local word vector, together with the global visual evidence from the whole question, complement each other to infer the correct answer for the given image and question, as shown in Fig. <a href="#S1.F1" title="Figure 1 ‣ 1 Introduction ‣ Ask, Attend and Answer: Exploring Question-Guided Spatial Attention for Visual Question Answering" class="ltx_ref"><span class="ltx_text ltx_ref_tag">1</span></a>.</p>
</div>
<figure id="S4.F6" class="ltx_figure">
<div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_2"><img src="/html/1511.05234/assets/figures/word_atten/COCO_val2014_000000540932_5409320.jpg" id="S4.F6.g1" class="ltx_graphics ltx_figure_panel ltx_img_landscape" width="299" height="113" alt="Refer to caption"></div>
<div class="ltx_flex_cell ltx_flex_size_2"><img src="/html/1511.05234/assets/figures/word_atten/COCO_val2014_000000563730_5637302.jpg" id="S4.F6.g2" class="ltx_graphics ltx_figure_panel ltx_img_landscape" width="299" height="113" alt="Refer to caption"></div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_2"><img src="/html/1511.05234/assets/figures/word_atten/COCO_val2014_000000576875_5768752.jpg" id="S4.F6.g3" class="ltx_graphics ltx_figure_panel ltx_img_landscape" width="299" height="113" alt="Refer to caption"></div>
<div class="ltx_flex_cell ltx_flex_size_2"><img src="/html/1511.05234/assets/figures/word_atten/COCO_val2014_000000567340_5673401.jpg" id="S4.F6.g4" class="ltx_graphics ltx_figure_panel ltx_img_landscape" width="299" height="113" alt="Refer to caption"></div>
</div>
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure">Figure 6: </span>
Visualization of the original image (left), the spatial attention weights <math id="S4.F6.3.m1.1" class="ltx_Math" alttext="W_{att}" display="inline"><semantics id="S4.F6.3.m1.1b"><msub id="S4.F6.3.m1.1.1" xref="S4.F6.3.m1.1.1.cmml"><mi id="S4.F6.3.m1.1.1.2" xref="S4.F6.3.m1.1.1.2.cmml">W</mi><mrow id="S4.F6.3.m1.1.1.3" xref="S4.F6.3.m1.1.1.3.cmml"><mi id="S4.F6.3.m1.1.1.3.2" xref="S4.F6.3.m1.1.1.3.2.cmml">a</mi><mo lspace="0em" rspace="0em" id="S4.F6.3.m1.1.1.3.1" xref="S4.F6.3.m1.1.1.3.1.cmml">​</mo><mi id="S4.F6.3.m1.1.1.3.3" xref="S4.F6.3.m1.1.1.3.3.cmml">t</mi><mo lspace="0em" rspace="0em" id="S4.F6.3.m1.1.1.3.1b" xref="S4.F6.3.m1.1.1.3.1.cmml">​</mo><mi id="S4.F6.3.m1.1.1.3.4" xref="S4.F6.3.m1.1.1.3.4.cmml">t</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S4.F6.3.m1.1c"><apply id="S4.F6.3.m1.1.1.cmml" xref="S4.F6.3.m1.1.1"><csymbol cd="ambiguous" id="S4.F6.3.m1.1.1.1.cmml" xref="S4.F6.3.m1.1.1">subscript</csymbol><ci id="S4.F6.3.m1.1.1.2.cmml" xref="S4.F6.3.m1.1.1.2">𝑊</ci><apply id="S4.F6.3.m1.1.1.3.cmml" xref="S4.F6.3.m1.1.1.3"><times id="S4.F6.3.m1.1.1.3.1.cmml" xref="S4.F6.3.m1.1.1.3.1"></times><ci id="S4.F6.3.m1.1.1.3.2.cmml" xref="S4.F6.3.m1.1.1.3.2">𝑎</ci><ci id="S4.F6.3.m1.1.1.3.3.cmml" xref="S4.F6.3.m1.1.1.3.3">𝑡</ci><ci id="S4.F6.3.m1.1.1.3.4.cmml" xref="S4.F6.3.m1.1.1.3.4">𝑡</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.F6.3.m1.1d">W_{att}</annotation></semantics></math> in the first hop (middle) and one correlation vector from the correlation matrix <math id="S4.F6.4.m2.1" class="ltx_Math" alttext="C" display="inline"><semantics id="S4.F6.4.m2.1b"><mi id="S4.F6.4.m2.1.1" xref="S4.F6.4.m2.1.1.cmml">C</mi><annotation-xml encoding="MathML-Content" id="S4.F6.4.m2.1c"><ci id="S4.F6.4.m2.1.1.cmml" xref="S4.F6.4.m2.1.1">𝐶</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.F6.4.m2.1d">C</annotation></semantics></math> for the location with highest attention weight in the SMem-VQA Two-Hop model on the VQA dataset.
Higher values in the correlation vector indicate stronger correlation of that word with the chosen location’s image features.</figcaption>
</figure>
</section>
</section>
</section>
<section id="S5" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">5 </span>Conclusion</h2>

<div id="S5.p1" class="ltx_para">
<p id="S5.p1.1" class="ltx_p">In this paper, we proposed the Spatial Memory Network for VQA, a memory network architecture with a spatial attention mechanism adapted to the visual question answering task. We proposed a set of synthetic spatial questions and demonstrated that our model learns inference rules based on spatial attention through attention weight visualization. Evaluation on the challenging DAQUAR and VQA datasets showed improved results over previously published models. Our model can be used to visualize the inference steps learned by the deep network, giving some insight into its processing. Future work may include further exploring the inference ability of our SMem-VQA model and exploring other VQA attention models.</p>
</div>
</section>
<section id="bib" class="ltx_bibliography">
<h2 class="ltx_title ltx_title_bibliography">References</h2>

<ul class="ltx_biblist">
<li id="bib.bib1" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[1]</span>
<span class="ltx_bibblock">
Malinowski, M., Fritz, M.:

</span>
<span class="ltx_bibblock">A multi-world approach to question answering about real-world scenes
based on uncertain input.

</span>
<span class="ltx_bibblock">CoRR <span id="bib.bib1.1.1" class="ltx_text ltx_font_bold">abs/1410.0210</span> (2014)

</span>
</li>
<li id="bib.bib2" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[2]</span>
<span class="ltx_bibblock">
Antol, S., Agrawal, A., Lu, J., Mitchell, M., Batra, D., Zitnick, C.L., Parikh,
D.:

</span>
<span class="ltx_bibblock">VQA: visual question answering.

</span>
<span class="ltx_bibblock">CoRR <span id="bib.bib2.1.1" class="ltx_text ltx_font_bold">abs/1505.00468</span> (2015)

</span>
</li>
<li id="bib.bib3" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[3]</span>
<span class="ltx_bibblock">
Zhou, B., Tian, Y., Sukhbaatar, S., Szlam, A., Fergus, R.:

</span>
<span class="ltx_bibblock">Simple baseline for visual question answering.

</span>
<span class="ltx_bibblock">arXiv preprint arXiv:1512.02167 (2015)

</span>
</li>
<li id="bib.bib4" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[4]</span>
<span class="ltx_bibblock">
Tu, K., Meng, M., Lee, M.W., Choe, T.E., Zhu, S.C.:

</span>
<span class="ltx_bibblock">Joint video and text parsing for understanding events and answering
queries.

</span>
<span class="ltx_bibblock">MultiMedia, IEEE <span id="bib.bib4.1.1" class="ltx_text ltx_font_bold">21</span>(2) (2014) 42–70

</span>
</li>
<li id="bib.bib5" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[5]</span>
<span class="ltx_bibblock">
Lasecki, W.S., Zhong, Y., Bigham, J.P.:

</span>
<span class="ltx_bibblock">Increasing the bandwidth of crowdsourced visual question answering to
better support blind users.

</span>
<span class="ltx_bibblock">In: Proceedings of the 16th international ACM SIGACCESS conference on
Computers &amp; accessibility, ACM (2014) 263–264

</span>
</li>
<li id="bib.bib6" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[6]</span>
<span class="ltx_bibblock">
Donahue, J., Hendricks, L.A., Guadarrama, S., Rohrbach, M., Venugopalan, S.,
Saenko, K., Darrell, T.:

</span>
<span class="ltx_bibblock">Long-term recurrent convolutional networks for visual recognition and
description.

</span>
<span class="ltx_bibblock">arXiv preprint arXiv:1411.4389 (2014)

</span>
</li>
<li id="bib.bib7" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[7]</span>
<span class="ltx_bibblock">
Vinyals, O., Toshev, A., Bengio, S., Erhan, D.:

</span>
<span class="ltx_bibblock">Show and tell: A neural image caption generator.

</span>
<span class="ltx_bibblock">arXiv preprint arXiv:1411.4555 (2014)

</span>
</li>
<li id="bib.bib8" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[8]</span>
<span class="ltx_bibblock">
Karpathy, A., Joulin, A., Li, F.F.F.:

</span>
<span class="ltx_bibblock">Deep fragment embeddings for bidirectional image sentence mapping.

</span>
<span class="ltx_bibblock">In: Advances in neural information processing systems. (2014)
1889–1897

</span>
</li>
<li id="bib.bib9" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[9]</span>
<span class="ltx_bibblock">
Fang, H., Gupta, S., Iandola, F., Srivastava, R., Deng, L., Dollár, P.,
Gao, J., He, X., Mitchell, M., Platt, J., et al.:

</span>
<span class="ltx_bibblock">From captions to visual concepts and back.

</span>
<span class="ltx_bibblock">arXiv preprint arXiv:1411.4952 (2014)

</span>
</li>
<li id="bib.bib10" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[10]</span>
<span class="ltx_bibblock">
Malinowski, M., Rohrbach, M., Fritz, M.:

</span>
<span class="ltx_bibblock">Ask your neurons: A neural-based approach to answering questions
about images.

</span>
<span class="ltx_bibblock">arXiv preprint arXiv:1505.01121 (2015)

</span>
</li>
<li id="bib.bib11" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[11]</span>
<span class="ltx_bibblock">
Ren, M., Kiros, R., Zemel, R.S.:

</span>
<span class="ltx_bibblock">Exploring models and data for image question answering.

</span>
<span class="ltx_bibblock">CoRR <span id="bib.bib11.1.1" class="ltx_text ltx_font_bold">abs/1505.02074</span> (2015)

</span>
</li>
<li id="bib.bib12" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[12]</span>
<span class="ltx_bibblock">
Weston, J., Chopra, S., Bordes, A.:

</span>
<span class="ltx_bibblock">Memory networks.

</span>
<span class="ltx_bibblock">CoRR <span id="bib.bib12.1.1" class="ltx_text ltx_font_bold">abs/1410.3916</span> (2014)

</span>
</li>
<li id="bib.bib13" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[13]</span>
<span class="ltx_bibblock">
Sukhbaatar, S., Szlam, A., Weston, J., Fergus, R.:

</span>
<span class="ltx_bibblock">End-to-end memory networks.

</span>
<span class="ltx_bibblock">arXiv preprint arXiv:1503.08895 (2015)

</span>
</li>
<li id="bib.bib14" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[14]</span>
<span class="ltx_bibblock">
Jia, Y., Shelhamer, E., Donahue, J., Karayev, S., Long, J., Girshick, R.,
Guadarrama, S., Darrell, T.:

</span>
<span class="ltx_bibblock">Caffe: Convolutional architecture for fast feature embedding.

</span>
<span class="ltx_bibblock">arXiv preprint arXiv:1408.5093 (2014)

</span>
</li>
<li id="bib.bib15" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[15]</span>
<span class="ltx_bibblock">
Yahya, M., Berberich, K., Elbassuoni, S., Ramanath, M., Tresp, V., Weikum, G.:

</span>
<span class="ltx_bibblock">Natural language questions for the web of data.

</span>
<span class="ltx_bibblock">In: Proceedings of the 2012 Joint Conference on Empirical Methods in
Natural Language Processing and Computational Natural Language Learning,
Association for Computational Linguistics (2012) 379–390

</span>
</li>
<li id="bib.bib16" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[16]</span>
<span class="ltx_bibblock">
Berant, J., Liang, P.:

</span>
<span class="ltx_bibblock">Semantic parsing via paraphrasing.

</span>
<span class="ltx_bibblock">In: Proceedings of ACL. Volume 7. (2014)  92

</span>
</li>
<li id="bib.bib17" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[17]</span>
<span class="ltx_bibblock">
Bordes, A., Chopra, S., Weston, J.:

</span>
<span class="ltx_bibblock">Question answering with subgraph embeddings.

</span>
<span class="ltx_bibblock">arXiv preprint arXiv:1406.3676 (2014)

</span>
</li>
<li id="bib.bib18" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[18]</span>
<span class="ltx_bibblock">
Graves, A., Wayne, G., Danihelka, I.:

</span>
<span class="ltx_bibblock">Neural turing machines.

</span>
<span class="ltx_bibblock">arXiv preprint arXiv:1410.5401 (2014)

</span>
</li>
<li id="bib.bib19" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[19]</span>
<span class="ltx_bibblock">
Xu, K., Ba, J., Kiros, R., Courville, A., Salakhutdinov, R., Zemel, R., Bengio,
Y.:

</span>
<span class="ltx_bibblock">Show, attend and tell: Neural image caption generation with visual
attention.

</span>
<span class="ltx_bibblock">arXiv preprint arXiv:1502.03044 (2015)

</span>
</li>
<li id="bib.bib20" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[20]</span>
<span class="ltx_bibblock">
Yao, L., Torabi, A., Cho, K., Ballas, N., Pal, C., Larochelle, H., Courville,
A.:

</span>
<span class="ltx_bibblock">Describing videos by exploiting temporal structure.

</span>
<span class="ltx_bibblock">In: Proceedings of the IEEE International Conference on Computer
Vision. (2015) 4507–4515

</span>
</li>
<li id="bib.bib21" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[21]</span>
<span class="ltx_bibblock">
Bahdanau, D., Cho, K., Bengio, Y.:

</span>
<span class="ltx_bibblock">Neural machine translation by jointly learning to align and
translate.

</span>
<span class="ltx_bibblock">arXiv preprint arXiv:1409.0473 (2014)

</span>
</li>
<li id="bib.bib22" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[22]</span>
<span class="ltx_bibblock">
Luong, M.T., Pham, H., Manning, C.D.:

</span>
<span class="ltx_bibblock">Effective approaches to attention-based neural machine translation.

</span>
<span class="ltx_bibblock">arXiv preprint arXiv:1508.04025 (2015)

</span>
</li>
<li id="bib.bib23" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[23]</span>
<span class="ltx_bibblock">
Hermann, K.M., Kocisky, T., Grefenstette, E., Espeholt, L., Kay, W., Suleyman,
M., Blunsom, P.:

</span>
<span class="ltx_bibblock">Teaching machines to read and comprehend.

</span>
<span class="ltx_bibblock">In: Advances in Neural Information Processing Systems. (2015)
1684–1692

</span>
</li>
<li id="bib.bib24" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[24]</span>
<span class="ltx_bibblock">
Cho, K., Courville, A., Bengio, Y.:

</span>
<span class="ltx_bibblock">Describing multimedia content using attention-based encoder–decoder
networks.

</span>
<span class="ltx_bibblock">(2015)

</span>
</li>
<li id="bib.bib25" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[25]</span>
<span class="ltx_bibblock">
Zhu, Y., Groth, O., Bernstein, M., Fei-Fei, L.:

</span>
<span class="ltx_bibblock">Visual7w: Grounded question answering in images.

</span>
<span class="ltx_bibblock">arXiv preprint arXiv:1511.03416 (2015)

</span>
</li>
<li id="bib.bib26" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[26]</span>
<span class="ltx_bibblock">
Wu, Q., Wang, P., Shen, C., Hengel, A.v.d., Dick, A.:

</span>
<span class="ltx_bibblock">Ask me anything: Free-form visual question answering based on
knowledge from external sources.

</span>
<span class="ltx_bibblock">arXiv preprint arXiv:1511.06973 (2015)

</span>
</li>
<li id="bib.bib27" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[27]</span>
<span class="ltx_bibblock">
Noh, H., Seo, P.H., Han, B.:

</span>
<span class="ltx_bibblock">Image question answering using convolutional neural network with
dynamic parameter prediction.

</span>
<span class="ltx_bibblock">arXiv preprint arXiv:1511.05756 (2015)

</span>
</li>
<li id="bib.bib28" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[28]</span>
<span class="ltx_bibblock">
Szegedy, C., Liu, W., Jia, Y., Sermanet, P., Reed, S., Anguelov, D., Erhan, D.,
Vanhoucke, V., Rabinovich, A.:

</span>
<span class="ltx_bibblock">Going deeper with convolutions.

</span>
<span class="ltx_bibblock">In: CVPR 2015. (2015)

</span>
</li>
<li id="bib.bib29" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[29]</span>
<span class="ltx_bibblock">
Shih, K.J., Singh, S., Hoiem, D.:

</span>
<span class="ltx_bibblock">Where to look: Focus regions for visual question answering.

</span>
<span class="ltx_bibblock">arXiv preprint arXiv:1511.07394 (2015)

</span>
</li>
<li id="bib.bib30" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[30]</span>
<span class="ltx_bibblock">
Lin, T.Y., Maire, M., Belongie, S., Hays, J., Perona, P., Ramanan, D.,
Dollár, P., Zitnick, C.L.:

</span>
<span class="ltx_bibblock">Microsoft coco: Common objects in context.

</span>
<span class="ltx_bibblock">In: Computer Vision–ECCV 2014.

</span>
<span class="ltx_bibblock">Springer (2014) 740–755

</span>
</li>
<li id="bib.bib31" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[31]</span>
<span class="ltx_bibblock">
Nathan Silberman, Derek Hoiem, P.K., Fergus, R.:

</span>
<span class="ltx_bibblock">Indoor segmentation and support inference from rgbd images.

</span>
<span class="ltx_bibblock">In: ECCV. (2012)

</span>
</li>
<li id="bib.bib32" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[32]</span>
<span class="ltx_bibblock">
Venugopalan, S., Xu, H., Donahue, J., Rohrbach, M., Mooney, R., Saenko, K.:

</span>
<span class="ltx_bibblock">Translating videos to natural language using deep recurrent neural
networks.

</span>
<span class="ltx_bibblock">arXiv preprint arXiv:1412.4729 (2014)

</span>
</li>
</ul>
</section>
</article>
</div>
<div class="ar5iv-footer"><a href="/html/1511.05233" class="ar5iv-nav-button ar5iv-nav-button-prev">◄</a>
    <a class="ar5iv-home-button" href="/"><img height="40" alt="ar5iv homepage" src="/assets/ar5iv.png"></a>
    <a href="/feeling_lucky" class="ar5iv-text-button">Feeling<br>lucky?</a>
    <a href="/log/1511.05234" class="ar5iv-text-button ar5iv-severity-ok">Conversion<br>report</a>
    <a class="ar5iv-text-button" target="_blank" href="https://github.com/dginev/ar5iv/issues/new?template=improve-article--arxiv-id-.md&title=Improve+article+1511.05234">Report<br>an issue</a>
    <a href="https://arxiv.org/abs/1511.05234" class="ar5iv-text-button arxiv-ui-theme">View&nbsp;original<br>on&nbsp;arXiv</a><a href="/html/1511.05235" class="ar5iv-nav-button ar5iv-nav-button-next">►</a>
</div><footer class="ltx_page_footer">
<a class="ar5iv-toggle-color-scheme" href="javascript:toggleColorScheme()" title="Toggle ar5iv color scheme"><span class="color-scheme-icon"></span></a>
<a class="ar5iv-footer-button" href="https://arxiv.org/help/license" target="_blank">Copyright</a>
<a class="ar5iv-footer-button" href="https://arxiv.org/help/policies/privacy_policy" target="_blank">Privacy Policy</a>

<div class="ltx_page_logo">Generated  on Thu Mar  7 23:29:20 2024 by <a target="_blank" href="http://dlmf.nist.gov/LaTeXML/" class="ltx_LaTeXML_logo"><span style="letter-spacing:-0.2em; margin-right:0.1em;">L<span class="ltx_font_smallcaps" style="position:relative; bottom:2.2pt;">a</span>T<span class="ltx_font_smallcaps" style="font-size:120%;position:relative; bottom:-0.2ex;">e</span></span><span style="font-size:90%; position:relative; bottom:-0.2ex;">XML</span><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAsAAAAOCAYAAAD5YeaVAAAAAXNSR0IArs4c6QAAAAZiS0dEAP8A/wD/oL2nkwAAAAlwSFlzAAALEwAACxMBAJqcGAAAAAd0SU1FB9wKExQZLWTEaOUAAAAddEVYdENvbW1lbnQAQ3JlYXRlZCB3aXRoIFRoZSBHSU1Q72QlbgAAAdpJREFUKM9tkL+L2nAARz9fPZNCKFapUn8kyI0e4iRHSR1Kb8ng0lJw6FYHFwv2LwhOpcWxTjeUunYqOmqd6hEoRDhtDWdA8ApRYsSUCDHNt5ul13vz4w0vWCgUnnEc975arX6ORqN3VqtVZbfbTQC4uEHANM3jSqXymFI6yWazP2KxWAXAL9zCUa1Wy2tXVxheKA9YNoR8Pt+aTqe4FVVVvz05O6MBhqUIBGk8Hn8HAOVy+T+XLJfLS4ZhTiRJgqIoVBRFIoric47jPnmeB1mW/9rr9ZpSSn3Lsmir1fJZlqWlUonKsvwWwD8ymc/nXwVBeLjf7xEKhdBut9Hr9WgmkyGEkJwsy5eHG5vN5g0AKIoCAEgkEkin0wQAfN9/cXPdheu6P33fBwB4ngcAcByHJpPJl+fn54mD3Gg0NrquXxeLRQAAwzAYj8cwTZPwPH9/sVg8PXweDAauqqr2cDjEer1GJBLBZDJBs9mE4zjwfZ85lAGg2+06hmGgXq+j3+/DsixYlgVN03a9Xu8jgCNCyIegIAgx13Vfd7vdu+FweG8YRkjXdWy329+dTgeSJD3ieZ7RNO0VAXAPwDEAO5VKndi2fWrb9jWl9Esul6PZbDY9Go1OZ7PZ9z/lyuD3OozU2wAAAABJRU5ErkJggg==" alt="Mascot Sammy"></a>
</div></footer>
</div>

    <script>
      var canMathML = typeof(MathMLElement) == "function";
      if (!canMathML) {
        var body = document.querySelector("body");
        body.firstElementChild.setAttribute('style', 'opacity: 0;');
        var loading = document.createElement("div");
        loading.setAttribute("id", "mathjax-loading-spinner");
        var message = document.createElement("div");
        message.setAttribute("id", "mathjax-loading-message");
        message.innerText = "Typesetting Equations...";
        body.prepend(loading);
        body.prepend(message);

        var el = document.createElement("script");
        el.src = "https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js";
        document.querySelector("head").appendChild(el);

        window.MathJax = {
          startup: {
            pageReady: () => {
              return MathJax.startup.defaultPageReady().then(() => {
                body.removeChild(loading);
                body.removeChild(message);
                body.firstElementChild.removeAttribute('style');
              }); } } };
      }
    </script>
    <script>
    // Auxiliary function, building the preview feature when
    // an inline citation is clicked
    function clicked_cite(e) {
      e.preventDefault();
      let cite = this.closest('.ltx_cite');
      let next = cite.nextSibling;
      if (next && next.nodeType == Node.ELEMENT_NODE && next.getAttribute('class') == "ar5iv-bibitem-preview") {
        next.remove();
        return; }
      // Before adding a preview modal,
      // cleanup older previews, in case they're still open
      document.querySelectorAll('span.ar5iv-bibitem-preview').forEach(function(node) {
        node.remove();
      })

      // Create the preview
      preview = document.createElement('span');
      preview.setAttribute('class','ar5iv-bibitem-preview');
      let target = document.getElementById(this.getAttribute('href').slice(1));
      target.childNodes.forEach(function (child) {
        preview.append(child.cloneNode(true));
      });
      let close_x = document.createElement('button');
      close_x.setAttribute("aria-label","Close modal for bibliography item preview");
      close_x.textContent = "×";
      close_x.setAttribute('class', 'ar5iv-button-close-preview');
      close_x.setAttribute('onclick','this.parentNode.remove()');
      preview.append(close_x);
      preview.querySelectorAll('.ltx_tag_bibitem').forEach(function(node) {
        node.remove();
      });
      cite.parentNode.insertBefore(preview, cite.nextSibling);
      return;
    }
    // Global Document initialization:
    // - assign the preview feature to all inline citation links
    document.querySelectorAll(".ltx_cite .ltx_ref").forEach(function (link) {
      link.addEventListener("click", clicked_cite);
    });
    </script>
    </body>
</html>
