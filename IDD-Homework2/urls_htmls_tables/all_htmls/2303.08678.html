<!DOCTYPE html><html lang="en">
<head>
<meta http-equiv="content-type" content="text/html; charset=UTF-8">
<title>[2303.08678] Visual Prompt Based Personalized Federated Learning</title><meta property="og:description" content="As a popular paradigm of distributed learning, personalized federated learning (PFL) allows personalized models to improve generalization ability and robustness by utilizing knowledge from all distributed clients. Most…">
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Visual Prompt Based Personalized Federated Learning">
<meta name="twitter:image:src" content="https://ar5iv.labs.arxiv.org/assets/ar5iv_card.png">
<meta name="twitter:image:alt" content="ar5iv logo">
<meta property="og:title" content="Visual Prompt Based Personalized Federated Learning">
<meta property="og:site_name" content="ar5iv">
<meta property="og:image" content="https://ar5iv.labs.arxiv.org/assets/ar5iv_card.png">
<meta property="og:type" content="article">
<meta property="og:url" content="https://ar5iv.labs.arxiv.org/html/2303.08678">

<!--Generated on Thu Feb 29 19:57:05 2024 by LaTeXML (version 0.8.8) http://dlmf.nist.gov/LaTeXML/.-->
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

<script>
  function detectColorScheme(){
    var theme="light";
    var current_theme = localStorage.getItem("ar5iv_theme");
    if(current_theme){
      if(current_theme == "dark"){
        theme = "dark";
      } }
    else if(!window.matchMedia) { return false; }
    else if(window.matchMedia("(prefers-color-scheme: dark)").matches) {
      theme = "dark"; }
    if (theme=="dark") {
      document.documentElement.setAttribute("data-theme", "dark");
    } else {
      document.documentElement.setAttribute("data-theme", "light"); } }

  detectColorScheme();

  function toggleColorScheme(){
    var current_theme = localStorage.getItem("ar5iv_theme");
    if (current_theme) {
      if (current_theme == "light") {
        localStorage.setItem("ar5iv_theme", "dark"); }
      else {
        localStorage.setItem("ar5iv_theme", "light"); } }
    else {
        localStorage.setItem("ar5iv_theme", "dark"); }
    detectColorScheme(); }
</script>
<link media="all" rel="stylesheet" href="/assets/ar5iv-fonts.0.8.0.min.css"><link media="all" rel="stylesheet" href="/assets/ar5iv.0.8.0.min.css"><link media="all" rel="stylesheet" href="/assets/ar5iv-site.0.2.2.css">
</head>
<body>
<div class="ltx_page_main">
<div class="ltx_page_content">
<article class="ltx_document ltx_authors_1line">
<h1 class="ltx_title ltx_title_document">Visual Prompt Based Personalized Federated Learning</h1>
<div class="ltx_authors">
<span class="ltx_creator ltx_role_author">
<span class="ltx_personname">
Guanghao Li<sup id="id1.1.id1" class="ltx_sup">1,*</sup>
 Wansen Wu<sup id="id2.2.id2" class="ltx_sup">1,</sup>
 Yan Sun<sup id="id3.3.id3" class="ltx_sup">2</sup>
 Li Shen<sup id="id4.4.id4" class="ltx_sup">3,</sup>
 Baoyuan Wu<sup id="id5.5.id5" class="ltx_sup">4</sup>
 Dacheng Tao<sup id="id6.6.id6" class="ltx_sup">2,3</sup>

<br class="ltx_break"><sup id="id7.7.id7" class="ltx_sup">1</sup>National University of Defense Technology, China;
<sup id="id8.8.id8" class="ltx_sup">2</sup>The University of Sydney, Australia
<br class="ltx_break"><sup id="id9.9.id9" class="ltx_sup">3</sup>JD Explore Academy, China;
<sup id="id10.10.id10" class="ltx_sup">4</sup>The Chinese University of Hong Kong, Shenzhen, China
<br class="ltx_break"><span id="id11.11.id11" class="ltx_text ltx_font_typewriter" style="font-size:90%;">{lgh, wuwansen14}@nudt.edu.cn; woodenchild95@outlook.com
<br class="ltx_break">{mathshenli,wubaoyuan1987,dacheng.tao}@gmail.com
</span>
</span><span class="ltx_author_notes">Co-first authorsCorresponding author: Li Shen</span></span>
</div>

<div class="ltx_abstract">
<h6 class="ltx_title ltx_title_abstract">Abstract</h6>
<p id="id12.id1" class="ltx_p">As a popular paradigm of distributed learning, personalized federated learning (PFL) allows personalized models to improve generalization ability and robustness by utilizing knowledge from all distributed clients. Most existing PFL algorithms tackle personalization in a model-centric way, such as personalized layer partition, model regularization, and model interpolation, which all fail to take into account the data characteristics of distributed clients. In this paper, we propose a novel PFL framework for image classification tasks, dubbed pFedPT, that leverages personalized visual prompts to implicitly represent local data distribution information of clients and provides that information to the aggregation model to help with classification tasks. Specifically, in each round of pFedPT training, each client generates a local personalized prompt related to local data distribution. Then, the local model is trained on the input composed of raw data and a visual prompt to learn the distribution information contained in the prompt. During model testing, the aggregated model obtains prior knowledge of the data distributions based on the prompts, which can be seen as an adaptive fine-tuning of the aggregation model to improve model performances on different clients. Furthermore, the visual prompt can be added as an orthogonal method to implement personalization on the client for existing FL methods to boost their performance. Experiments on the CIFAR10 and CIFAR100 datasets show that pFedPT outperforms several state-of-the-art (SOTA) PFL algorithms by a large margin in various settings.</p>
</div>
<section id="S1" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">1 </span>Introduction</h2>

<figure id="S1.F1" class="ltx_figure"><img src="/html/2303.08678/assets/x1.png" id="S1.F1.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="396" height="288" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 1: </span>Differences in local update and aggregation phases between FedAvg and pFedPT. In the figure, the lines represent the decision boundaries defined by the backbone. Assume that each client has two classes represented by different shapes. (a) In FedAvg, due to the heterogeneity of data in each client, the significant difference in local updates affects the final model aggregation. However, (b) the pFedPT adds personalized visual prompts to the client data, which change the original data characteristics and improve the fit of the backbone on the client. (c) and (d) are the t-SNE visualization results of the final hidden layer trained by FedAvg and pFedPT on the client with only classes 1 and 4. pFedPT increases the inter-class variation (Inter-Var) and decreases the intra-class variation (Intra-Var).</figcaption>
</figure>
<div id="S1.p1" class="ltx_para">
<p id="S1.p1.1" class="ltx_p">Personalized federated learning (PFL) <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib10" title="" class="ltx_ref">10</a>, <a href="#bib.bib21" title="" class="ltx_ref">21</a>, <a href="#bib.bib9" title="" class="ltx_ref">9</a>]</cite> is a novel paradigm proposed to overcome the impacts of heterogeneity across isolated clients. Instead of training a single aggregated model like in Federated learning(FL) <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib34" title="" class="ltx_ref">34</a>, <a href="#bib.bib41" title="" class="ltx_ref">41</a>, <a href="#bib.bib27" title="" class="ltx_ref">27</a>, <a href="#bib.bib17" title="" class="ltx_ref">17</a>]</cite>, PFL generates a personalized local model on each client that is more in line with the local data distribution by jointly considering the aggregated model and the personalized data. There are two main challenges lying in PFL. One is how to extract useful global features from models trained on each local heterogeneous dataset. The other is how to incorporate the extracted global features with the personalized features, yielding a better client-specific model.</p>
</div>
<div id="S1.p2" class="ltx_para">
<p id="S1.p2.1" class="ltx_p">Several works have been proposed to address the above challenges from a model perspective. PFL algorithms with a decoupling model  <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib1" title="" class="ltx_ref">1</a>, <a href="#bib.bib8" title="" class="ltx_ref">8</a>, <a href="#bib.bib35" title="" class="ltx_ref">35</a>]</cite> split the local model into a shared part to be aggregated with those from other clients, and a private part of maintaining locality. The shared part is used to transfer public knowledge among clients, and the private part is used to adapt to local data distribution. Clustered FL <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib11" title="" class="ltx_ref">11</a>]</cite> groups clients according to the similarity of the local parameters and trains an aggregated model for each group of clients. Clustered FL extracts common knowledge from similar clients within a group to generate a unified model for the group. These methods, however, still fall short in two aspects. First, these approaches rely on the effectiveness of aggregating or clustering the shared parts and may fail with highly heterogeneous data. Second, these methods simply extract the common knowledge and implement the personalization at the model level, while ignoring the potential at the data level, which may further strengthen the personalized adaptation between the aggregated model and local dataset.</p>
</div>
<div id="S1.p3" class="ltx_para">
<p id="S1.p3.1" class="ltx_p">In the community of computer vision (CV), both visual prompts <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib32" title="" class="ltx_ref">32</a>]</cite> and adversarial reprogramming <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib13" title="" class="ltx_ref">13</a>]</cite> employ a set of learnable parameters as a continuous task-specific vector, which can be tuned based on training data from the downstream task. Visual prompts can effectively help a large-scale pre-trained model achieve fast task transfer by simply training task-related prompts without changing any pre-trained model parameters. The prompt parameters are like the attention guidance to implicitly hint at the task-related information for improving model performance on the new task <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib32" title="" class="ltx_ref">32</a>]</cite>. This motivates us to regard the different clients as different tasks and adopt client-specific prompts to fine-tune the aggregated model on each local client, which helps to incorporate the extracted global features with the personalized ones.</p>
</div>
<div id="S1.p4" class="ltx_para">
<p id="S1.p4.1" class="ltx_p">Based on this insight, we propose a novel PFL framework named pFedPT. Our approach addresses the shortcomings mentioned above by using a visual prompt to implicitly provide a hint of the data distribution on a client for the aggregated model locally. Specifically, each client model integrates a learnable <span id="S1.p4.1.1" class="ltx_text ltx_font_italic">Prompt Generator</span> with a backbone participating in aggregation for classification. The prompt generator is a set of locally learnable parameters that can generate personalized visual prompts for its affiliated clients based on their local data distribution. During local training of pFedPT, the generated personalized visual prompts are added to the images. Fig. <a href="#S1.F1" title="Figure 1 ‣ 1 Introduction ‣ Visual Prompt Based Personalized Federated Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">1</span></a> (a) and (b) show the difference in the training process between FedAvg and pFedPT. For different classes of data, Fig. <a href="#S1.F1" title="Figure 1 ‣ 1 Introduction ‣ Visual Prompt Based Personalized Federated Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">1</span></a> (c) and (d) show that the generated prompts increases the inter-class variation (Inter-Var) while decreasing the intra-class variation (Intra-Var). Different class data with a visual prompt is easily distinguished by an aggregated backbone, thereby improving the local performance of the local clients. Then, the backbone is trained on the input composed of raw data and visual prompts to learn the distribution information contained in the prompt. Upon achieving convergence of the two models through alternate training, the backbone implements the extraction of common knowledge from clients and can recognize the visual prompts of different clients. The generated visual prompt reflects the client’s characteristics as a client-conditional vector and implements fine-tuning of the backbone in the local client. As a result,  the backbone can capture implicit knowledge about the client’s data distribution based on the visual prompt and therefore obtain a better-personalized model. On the other hand, the visual prompt can be of independent interest and added as a plugin for other FL algorithms. It can fine-tune the model received by clients, which can implement the personalized improvement of the model trained by FL algorithms in different clients or further boost the performance of PFL algorithms.</p>
</div>
<div id="S1.p5" class="ltx_para">
<p id="S1.p5.1" class="ltx_p">We validate pFedPT on two image classification datasets, including CIFAR10 <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib25" title="" class="ltx_ref">25</a>]</cite> and CIFAR100 <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib25" title="" class="ltx_ref">25</a>]</cite>. Empirical results show that pFedPT beats other SOTA baselines of PFL with a 1%-3% improvement in test accuracy. In summary, our main contributions are four-fold:</p>
<ul id="S1.I1" class="ltx_itemize">
<li id="S1.I1.i1" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="S1.I1.i1.p1" class="ltx_para">
<p id="S1.I1.i1.p1.1" class="ltx_p">To the best of our knowledge, this is the first work that proposes to use client-specific prompts to help the aggregated models achieve better local adaptation and generalization by leveraging the personalized features of clients.</p>
</div>
</li>
<li id="S1.I1.i2" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="S1.I1.i2.p1" class="ltx_para">
<p id="S1.I1.i2.p1.1" class="ltx_p">We propose a novel PFL framework, dubbed pFedPT, for federated image classification tasks that use the visual prompts from each client to fine-tune the aggregated model and imbue the aggregated local model with information about the local data distribution.</p>
</div>
</li>
<li id="S1.I1.i3" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="S1.I1.i3.p1" class="ltx_para">
<p id="S1.I1.i3.p1.1" class="ltx_p">We show that pFedPT can integrate with several existing FL and decoupled PFL methods to boost their performance, which may be of independent interest.</p>
</div>
</li>
<li id="S1.I1.i4" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="S1.I1.i4.p1" class="ltx_para">
<p id="S1.I1.i4.p1.1" class="ltx_p">We conduct extensive experiments to evaluate the effectiveness of pFedPT, which significantly outperforms several SOTA baselines on CIFAR10 and CIFAR100 datasets. Besides, the experimental results illustrate that the prompt can indeed learn personalized knowledge related to the client.</p>
</div>
</li>
</ul>
</div>
</section>
<section id="S2" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">2 </span>Related Work</h2>

<figure id="S2.F2" class="ltx_figure"><img src="/html/2303.08678/assets/x2.png" id="S2.F2.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="475" height="190" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 2: </span>The pipeline of the pFedPT. <math id="S2.F2.2.m1.1" class="ltx_Math" alttext="\hat{y}" display="inline"><semantics id="S2.F2.2.m1.1b"><mover accent="true" id="S2.F2.2.m1.1.1" xref="S2.F2.2.m1.1.1.cmml"><mi id="S2.F2.2.m1.1.1.2" xref="S2.F2.2.m1.1.1.2.cmml">y</mi><mo id="S2.F2.2.m1.1.1.1" xref="S2.F2.2.m1.1.1.1.cmml">^</mo></mover><annotation-xml encoding="MathML-Content" id="S2.F2.2.m1.1c"><apply id="S2.F2.2.m1.1.1.cmml" xref="S2.F2.2.m1.1.1"><ci id="S2.F2.2.m1.1.1.1.cmml" xref="S2.F2.2.m1.1.1.1">^</ci><ci id="S2.F2.2.m1.1.1.2.cmml" xref="S2.F2.2.m1.1.1.2">𝑦</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.F2.2.m1.1d">\hat{y}</annotation></semantics></math> stands for the predicted logits of all classes. The dashed lines in steps 1 and 2 represent the loss backward for the model update. Each client contains a Prompt Generator, a set of personalized learnable parameters preserved locally, and a Backbone, which the server will aggregate with those of other clients. The raw image input will be added to a visual prompt (colored pixels padded around the image) and then passed into the backbone for prediction.</figcaption>
</figure>
<section id="S2.SS0.SSS0.Px1" class="ltx_paragraph">
<h4 class="ltx_title ltx_title_paragraph">Personalized Federated Learning (PFL).</h4>

<div id="S2.SS0.SSS0.Px1.p1" class="ltx_para">
<p id="S2.SS0.SSS0.Px1.p1.1" class="ltx_p">PFL has drawn significant research interests <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib41" title="" class="ltx_ref">41</a>, <a href="#bib.bib14" title="" class="ltx_ref">14</a>, <a href="#bib.bib40" title="" class="ltx_ref">40</a>, <a href="#bib.bib19" title="" class="ltx_ref">19</a>, <a href="#bib.bib7" title="" class="ltx_ref">7</a>, <a href="#bib.bib44" title="" class="ltx_ref">44</a>]</cite>. The main difficulty of PFL is to characterize the data distributions of clients and integrate them into the federated learning training process, followed by providing a personalized local model for each client. Currently, the core idea of PFL is to decouple the model into shared layers for feature extraction and personalized layers for classification <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib1" title="" class="ltx_ref">1</a>, <a href="#bib.bib8" title="" class="ltx_ref">8</a>, <a href="#bib.bib35" title="" class="ltx_ref">35</a>]</cite>. Each client’s parameters of the shared layer are generally updated globally using the FedAvg <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib34" title="" class="ltx_ref">34</a>]</cite> algorithm. In contrast, the personalized layers are trained locally and will not be shared with others. Those works focus on training a general feature extractor and a personalized classifier head for personalization.</p>
</div>
<div id="S2.SS0.SSS0.Px1.p2" class="ltx_para">
<p id="S2.SS0.SSS0.Px1.p2.1" class="ltx_p">Other work aims to combine other related machine-learning techniques with PFL. Briggs <em id="S2.SS0.SSS0.Px1.p2.1.1" class="ltx_emph ltx_font_italic">et al</em>.<span id="S2.SS0.SSS0.Px1.p2.1.2" class="ltx_text"></span> <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib3" title="" class="ltx_ref">3</a>]</cite> and Mansour <em id="S2.SS0.SSS0.Px1.p2.1.3" class="ltx_emph ltx_font_italic">et al</em>.<span id="S2.SS0.SSS0.Px1.p2.1.4" class="ltx_text"></span> <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib33" title="" class="ltx_ref">33</a>]</cite> use the clustering technique to divide similar clients into groups and learn a separate model for each group without inter-group federation. Smith <em id="S2.SS0.SSS0.Px1.p2.1.5" class="ltx_emph ltx_font_italic">et al</em>.<span id="S2.SS0.SSS0.Px1.p2.1.6" class="ltx_text"></span> <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib11" title="" class="ltx_ref">11</a>]</cite> use multitasking learning to take advantage of shared representations between clients to improve the generalization performance of each model. Yang <em id="S2.SS0.SSS0.Px1.p2.1.7" class="ltx_emph ltx_font_italic">et al</em>.<span id="S2.SS0.SSS0.Px1.p2.1.8" class="ltx_text"></span> <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib45" title="" class="ltx_ref">45</a>]</cite> and Chen <em id="S2.SS0.SSS0.Px1.p2.1.9" class="ltx_emph ltx_font_italic">et al</em>.<span id="S2.SS0.SSS0.Px1.p2.1.10" class="ltx_text"></span> <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib5" title="" class="ltx_ref">5</a>]</cite> use transfer learning to enhance local models by transferring knowledge between relevant clients. T Dinh <em id="S2.SS0.SSS0.Px1.p2.1.11" class="ltx_emph ltx_font_italic">et al</em>.<span id="S2.SS0.SSS0.Px1.p2.1.12" class="ltx_text"></span> <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib40" title="" class="ltx_ref">40</a>]</cite> add regularizers to the aggregated model to prevent customers’ models from simply overfitting their own data sets. Chen <em id="S2.SS0.SSS0.Px1.p2.1.13" class="ltx_emph ltx_font_italic">et al</em>.<span id="S2.SS0.SSS0.Px1.p2.1.14" class="ltx_text"></span> <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib4" title="" class="ltx_ref">4</a>]</cite> and Fallah <em id="S2.SS0.SSS0.Px1.p2.1.15" class="ltx_emph ltx_font_italic">et al</em>.<span id="S2.SS0.SSS0.Px1.p2.1.16" class="ltx_text"></span> <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib14" title="" class="ltx_ref">14</a>]</cite> attempt to develop a well-initialized shared aggregated model using a model-agnostic meta-learning (MAML) approach <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib15" title="" class="ltx_ref">15</a>]</cite>. In addition, fine-tuning using the aggregated model learned by the FedAvg algorithm can also improve the performance of personalized local models <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib24" title="" class="ltx_ref">24</a>, <a href="#bib.bib22" title="" class="ltx_ref">22</a>]</cite>. The previous works enable the model to recognize the characteristics of clients and implement personalization for them. However, adding additional information at the data level to achieve better backbone performance on the client has always been ignored. Our pFedPT framework uses visual prompts to implicitly represent the data distribution of clients, which achieves personalization by incorporating the characteristics of clients into the training process at the data level.</p>
</div>
</section>
<section id="S2.SS0.SSS0.Px2" class="ltx_paragraph">
<h4 class="ltx_title ltx_title_paragraph">Prompt Learning.</h4>

<div id="S2.SS0.SSS0.Px2.p1" class="ltx_para">
<p id="S2.SS0.SSS0.Px2.p1.1" class="ltx_p">Prompt learning <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib32" title="" class="ltx_ref">32</a>]</cite>, as a novel application paradigm for large-scale pre-trained models, was first proposed in NLP, and refers to prepending a language instruction to the original text input <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib31" title="" class="ltx_ref">31</a>]</cite>. In this way, pre-trained models can be given hints about what tasks are currently being performed, thereby achieving strong generalization to downstream transfer learning tasks without fine-tuning the whole model <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib16" title="" class="ltx_ref">16</a>]</cite>. Compared to hard prompts, soft prompts avoid the trouble of manual design, and are more expressive. Lester <em id="S2.SS0.SSS0.Px2.p1.1.1" class="ltx_emph ltx_font_italic">et al</em>.<span id="S2.SS0.SSS0.Px2.p1.1.2" class="ltx_text"></span> <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib26" title="" class="ltx_ref">26</a>]</cite> use task-specific continuous vectors as soft prompts and can be optimized by training. In the CV area, Radford <em id="S2.SS0.SSS0.Px2.p1.1.3" class="ltx_emph ltx_font_italic">et al</em>.<span id="S2.SS0.SSS0.Px2.p1.1.4" class="ltx_text"></span> <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib37" title="" class="ltx_ref">37</a>]</cite> propose the CLIP model using language prompts to solve the vision-language tasks, which is similar to the following works <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib42" title="" class="ltx_ref">42</a>, <a href="#bib.bib46" title="" class="ltx_ref">46</a>]</cite>. In <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib2" title="" class="ltx_ref">2</a>]</cite>, the visual prompts are designed as an input-agnostic perturbation, which is padded around the input images. The perturbation-generating function includes a small number of trainable parameters, which helps the pre-trained vision models perform downstream tasks without fine-tuning any parameters. Visual Prompt Tuning (VPT) <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib23" title="" class="ltx_ref">23</a>]</cite> is introduced as a parameter-efficient alternative to full fine-tuning for pre-trained model <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib12" title="" class="ltx_ref">12</a>]</cite>.</p>
</div>
<div id="S2.SS0.SSS0.Px2.p2" class="ltx_para">
<p id="S2.SS0.SSS0.Px2.p2.1" class="ltx_p">Notably, two concurrent works, PROMPTFL <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib18" title="" class="ltx_ref">18</a>]</cite> and FedPrompt  <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib48" title="" class="ltx_ref">48</a>]</cite> also introduce prompt learning into FL. However, several significant differences exist between our work and these two works. (i) Different training objectives: the goal of PROMPTFL and FedPrompt is to fine-tune existing pre-trained models in the FL system. While pFedPT implements model training from scratch for achieving PFL. (ii) Different ways of training: PROMPTFL and FedPrompt freeze the pre-trained model during training and share the parameter information of the prompt. In pFedPT, backbone and prompt generators are trained alternately during training, and each client has its own unique prompt after training to achieve the goal of personalization. (iii) Different verification scenarios: PROMPTFL and FedPrompt are tested on NLP datasets, while pFedPT is mainly concerned with the improvement brought by the prompt in the CV domain.</p>
</div>
</section>
</section>
<section id="S3" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">3 </span>Methodology</h2>

<div id="S3.p1" class="ltx_para">
<p id="S3.p1.1" class="ltx_p">In this section, we introduce the proposed visual prompt based personalized federated learning (pFedPT) framework. Below, we first provide several preliminaries on PFL.</p>
</div>
<section id="S3.SS1" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.1 </span>Problem setup</h3>

<div id="S3.SS1.p1" class="ltx_para">
<p id="S3.SS1.p1.6" class="ltx_p">Suppose that there are <math id="S3.SS1.p1.1.m1.1" class="ltx_Math" alttext="N" display="inline"><semantics id="S3.SS1.p1.1.m1.1a"><mi id="S3.SS1.p1.1.m1.1.1" xref="S3.SS1.p1.1.m1.1.1.cmml">N</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.1.m1.1b"><ci id="S3.SS1.p1.1.m1.1.1.cmml" xref="S3.SS1.p1.1.m1.1.1">𝑁</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.1.m1.1c">N</annotation></semantics></math> clients, denoted as <math id="S3.SS1.p1.2.m2.3" class="ltx_Math" alttext="C_{1},...,C_{N}" display="inline"><semantics id="S3.SS1.p1.2.m2.3a"><mrow id="S3.SS1.p1.2.m2.3.3.2" xref="S3.SS1.p1.2.m2.3.3.3.cmml"><msub id="S3.SS1.p1.2.m2.2.2.1.1" xref="S3.SS1.p1.2.m2.2.2.1.1.cmml"><mi id="S3.SS1.p1.2.m2.2.2.1.1.2" xref="S3.SS1.p1.2.m2.2.2.1.1.2.cmml">C</mi><mn id="S3.SS1.p1.2.m2.2.2.1.1.3" xref="S3.SS1.p1.2.m2.2.2.1.1.3.cmml">1</mn></msub><mo id="S3.SS1.p1.2.m2.3.3.2.3" xref="S3.SS1.p1.2.m2.3.3.3.cmml">,</mo><mi mathvariant="normal" id="S3.SS1.p1.2.m2.1.1" xref="S3.SS1.p1.2.m2.1.1.cmml">…</mi><mo id="S3.SS1.p1.2.m2.3.3.2.4" xref="S3.SS1.p1.2.m2.3.3.3.cmml">,</mo><msub id="S3.SS1.p1.2.m2.3.3.2.2" xref="S3.SS1.p1.2.m2.3.3.2.2.cmml"><mi id="S3.SS1.p1.2.m2.3.3.2.2.2" xref="S3.SS1.p1.2.m2.3.3.2.2.2.cmml">C</mi><mi id="S3.SS1.p1.2.m2.3.3.2.2.3" xref="S3.SS1.p1.2.m2.3.3.2.2.3.cmml">N</mi></msub></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.2.m2.3b"><list id="S3.SS1.p1.2.m2.3.3.3.cmml" xref="S3.SS1.p1.2.m2.3.3.2"><apply id="S3.SS1.p1.2.m2.2.2.1.1.cmml" xref="S3.SS1.p1.2.m2.2.2.1.1"><csymbol cd="ambiguous" id="S3.SS1.p1.2.m2.2.2.1.1.1.cmml" xref="S3.SS1.p1.2.m2.2.2.1.1">subscript</csymbol><ci id="S3.SS1.p1.2.m2.2.2.1.1.2.cmml" xref="S3.SS1.p1.2.m2.2.2.1.1.2">𝐶</ci><cn type="integer" id="S3.SS1.p1.2.m2.2.2.1.1.3.cmml" xref="S3.SS1.p1.2.m2.2.2.1.1.3">1</cn></apply><ci id="S3.SS1.p1.2.m2.1.1.cmml" xref="S3.SS1.p1.2.m2.1.1">…</ci><apply id="S3.SS1.p1.2.m2.3.3.2.2.cmml" xref="S3.SS1.p1.2.m2.3.3.2.2"><csymbol cd="ambiguous" id="S3.SS1.p1.2.m2.3.3.2.2.1.cmml" xref="S3.SS1.p1.2.m2.3.3.2.2">subscript</csymbol><ci id="S3.SS1.p1.2.m2.3.3.2.2.2.cmml" xref="S3.SS1.p1.2.m2.3.3.2.2.2">𝐶</ci><ci id="S3.SS1.p1.2.m2.3.3.2.2.3.cmml" xref="S3.SS1.p1.2.m2.3.3.2.2.3">𝑁</ci></apply></list></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.2.m2.3c">C_{1},...,C_{N}</annotation></semantics></math>, respectively. Client <math id="S3.SS1.p1.3.m3.1" class="ltx_Math" alttext="C_{i}" display="inline"><semantics id="S3.SS1.p1.3.m3.1a"><msub id="S3.SS1.p1.3.m3.1.1" xref="S3.SS1.p1.3.m3.1.1.cmml"><mi id="S3.SS1.p1.3.m3.1.1.2" xref="S3.SS1.p1.3.m3.1.1.2.cmml">C</mi><mi id="S3.SS1.p1.3.m3.1.1.3" xref="S3.SS1.p1.3.m3.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.3.m3.1b"><apply id="S3.SS1.p1.3.m3.1.1.cmml" xref="S3.SS1.p1.3.m3.1.1"><csymbol cd="ambiguous" id="S3.SS1.p1.3.m3.1.1.1.cmml" xref="S3.SS1.p1.3.m3.1.1">subscript</csymbol><ci id="S3.SS1.p1.3.m3.1.1.2.cmml" xref="S3.SS1.p1.3.m3.1.1.2">𝐶</ci><ci id="S3.SS1.p1.3.m3.1.1.3.cmml" xref="S3.SS1.p1.3.m3.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.3.m3.1c">C_{i}</annotation></semantics></math> has a local dataset <math id="S3.SS1.p1.4.m4.1" class="ltx_Math" alttext="\mathcal{D}^{i}" display="inline"><semantics id="S3.SS1.p1.4.m4.1a"><msup id="S3.SS1.p1.4.m4.1.1" xref="S3.SS1.p1.4.m4.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS1.p1.4.m4.1.1.2" xref="S3.SS1.p1.4.m4.1.1.2.cmml">𝒟</mi><mi id="S3.SS1.p1.4.m4.1.1.3" xref="S3.SS1.p1.4.m4.1.1.3.cmml">i</mi></msup><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.4.m4.1b"><apply id="S3.SS1.p1.4.m4.1.1.cmml" xref="S3.SS1.p1.4.m4.1.1"><csymbol cd="ambiguous" id="S3.SS1.p1.4.m4.1.1.1.cmml" xref="S3.SS1.p1.4.m4.1.1">superscript</csymbol><ci id="S3.SS1.p1.4.m4.1.1.2.cmml" xref="S3.SS1.p1.4.m4.1.1.2">𝒟</ci><ci id="S3.SS1.p1.4.m4.1.1.3.cmml" xref="S3.SS1.p1.4.m4.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.4.m4.1c">\mathcal{D}^{i}</annotation></semantics></math>. The goal of traditional FL <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib34" title="" class="ltx_ref">34</a>]</cite> is to collaboratively learn a machine learning model <math id="S3.SS1.p1.5.m5.1" class="ltx_Math" alttext="w" display="inline"><semantics id="S3.SS1.p1.5.m5.1a"><mi id="S3.SS1.p1.5.m5.1.1" xref="S3.SS1.p1.5.m5.1.1.cmml">w</mi><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.5.m5.1b"><ci id="S3.SS1.p1.5.m5.1.1.cmml" xref="S3.SS1.p1.5.m5.1.1">𝑤</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.5.m5.1c">w</annotation></semantics></math> over the dataset <math id="S3.SS1.p1.6.m6.1" class="ltx_Math" alttext="\mathcal{D}\triangleq\bigcup_{i\in[N]}\mathcal{D}^{i}" display="inline"><semantics id="S3.SS1.p1.6.m6.1a"><mrow id="S3.SS1.p1.6.m6.1.2" xref="S3.SS1.p1.6.m6.1.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS1.p1.6.m6.1.2.2" xref="S3.SS1.p1.6.m6.1.2.2.cmml">𝒟</mi><mo rspace="0.111em" id="S3.SS1.p1.6.m6.1.2.1" xref="S3.SS1.p1.6.m6.1.2.1.cmml">≜</mo><mrow id="S3.SS1.p1.6.m6.1.2.3" xref="S3.SS1.p1.6.m6.1.2.3.cmml"><msub id="S3.SS1.p1.6.m6.1.2.3.1" xref="S3.SS1.p1.6.m6.1.2.3.1.cmml"><mo id="S3.SS1.p1.6.m6.1.2.3.1.2" xref="S3.SS1.p1.6.m6.1.2.3.1.2.cmml">⋃</mo><mrow id="S3.SS1.p1.6.m6.1.1.1" xref="S3.SS1.p1.6.m6.1.1.1.cmml"><mi id="S3.SS1.p1.6.m6.1.1.1.3" xref="S3.SS1.p1.6.m6.1.1.1.3.cmml">i</mi><mo id="S3.SS1.p1.6.m6.1.1.1.2" xref="S3.SS1.p1.6.m6.1.1.1.2.cmml">∈</mo><mrow id="S3.SS1.p1.6.m6.1.1.1.4.2" xref="S3.SS1.p1.6.m6.1.1.1.4.1.cmml"><mo stretchy="false" id="S3.SS1.p1.6.m6.1.1.1.4.2.1" xref="S3.SS1.p1.6.m6.1.1.1.4.1.1.cmml">[</mo><mi id="S3.SS1.p1.6.m6.1.1.1.1" xref="S3.SS1.p1.6.m6.1.1.1.1.cmml">N</mi><mo stretchy="false" id="S3.SS1.p1.6.m6.1.1.1.4.2.2" xref="S3.SS1.p1.6.m6.1.1.1.4.1.1.cmml">]</mo></mrow></mrow></msub><msup id="S3.SS1.p1.6.m6.1.2.3.2" xref="S3.SS1.p1.6.m6.1.2.3.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS1.p1.6.m6.1.2.3.2.2" xref="S3.SS1.p1.6.m6.1.2.3.2.2.cmml">𝒟</mi><mi id="S3.SS1.p1.6.m6.1.2.3.2.3" xref="S3.SS1.p1.6.m6.1.2.3.2.3.cmml">i</mi></msup></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.6.m6.1b"><apply id="S3.SS1.p1.6.m6.1.2.cmml" xref="S3.SS1.p1.6.m6.1.2"><ci id="S3.SS1.p1.6.m6.1.2.1.cmml" xref="S3.SS1.p1.6.m6.1.2.1">≜</ci><ci id="S3.SS1.p1.6.m6.1.2.2.cmml" xref="S3.SS1.p1.6.m6.1.2.2">𝒟</ci><apply id="S3.SS1.p1.6.m6.1.2.3.cmml" xref="S3.SS1.p1.6.m6.1.2.3"><apply id="S3.SS1.p1.6.m6.1.2.3.1.cmml" xref="S3.SS1.p1.6.m6.1.2.3.1"><csymbol cd="ambiguous" id="S3.SS1.p1.6.m6.1.2.3.1.1.cmml" xref="S3.SS1.p1.6.m6.1.2.3.1">subscript</csymbol><union id="S3.SS1.p1.6.m6.1.2.3.1.2.cmml" xref="S3.SS1.p1.6.m6.1.2.3.1.2"></union><apply id="S3.SS1.p1.6.m6.1.1.1.cmml" xref="S3.SS1.p1.6.m6.1.1.1"><in id="S3.SS1.p1.6.m6.1.1.1.2.cmml" xref="S3.SS1.p1.6.m6.1.1.1.2"></in><ci id="S3.SS1.p1.6.m6.1.1.1.3.cmml" xref="S3.SS1.p1.6.m6.1.1.1.3">𝑖</ci><apply id="S3.SS1.p1.6.m6.1.1.1.4.1.cmml" xref="S3.SS1.p1.6.m6.1.1.1.4.2"><csymbol cd="latexml" id="S3.SS1.p1.6.m6.1.1.1.4.1.1.cmml" xref="S3.SS1.p1.6.m6.1.1.1.4.2.1">delimited-[]</csymbol><ci id="S3.SS1.p1.6.m6.1.1.1.1.cmml" xref="S3.SS1.p1.6.m6.1.1.1.1">𝑁</ci></apply></apply></apply><apply id="S3.SS1.p1.6.m6.1.2.3.2.cmml" xref="S3.SS1.p1.6.m6.1.2.3.2"><csymbol cd="ambiguous" id="S3.SS1.p1.6.m6.1.2.3.2.1.cmml" xref="S3.SS1.p1.6.m6.1.2.3.2">superscript</csymbol><ci id="S3.SS1.p1.6.m6.1.2.3.2.2.cmml" xref="S3.SS1.p1.6.m6.1.2.3.2.2">𝒟</ci><ci id="S3.SS1.p1.6.m6.1.2.3.2.3.cmml" xref="S3.SS1.p1.6.m6.1.2.3.2.3">𝑖</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.6.m6.1c">\mathcal{D}\triangleq\bigcup_{i\in[N]}\mathcal{D}^{i}</annotation></semantics></math> with the help of a central server, while the raw data are not exchanged. The objective of FL is defined below:</p>
<table id="S3.E1" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S3.E1.m1.5" class="ltx_Math" alttext="\operatorname*{arg\,min}_{w}\mathcal{L}(w)=\sum_{i=1}^{N}\frac{|\mathcal{D}^{i}|}{|\mathcal{D}|}L_{i}(w)," display="block"><semantics id="S3.E1.m1.5a"><mrow id="S3.E1.m1.5.5.1" xref="S3.E1.m1.5.5.1.1.cmml"><mrow id="S3.E1.m1.5.5.1.1" xref="S3.E1.m1.5.5.1.1.cmml"><mrow id="S3.E1.m1.5.5.1.1.2" xref="S3.E1.m1.5.5.1.1.2.cmml"><mrow id="S3.E1.m1.5.5.1.1.2.2" xref="S3.E1.m1.5.5.1.1.2.2.cmml"><munder id="S3.E1.m1.5.5.1.1.2.2.1" xref="S3.E1.m1.5.5.1.1.2.2.1.cmml"><mrow id="S3.E1.m1.5.5.1.1.2.2.1.2" xref="S3.E1.m1.5.5.1.1.2.2.1.2.cmml"><mi id="S3.E1.m1.5.5.1.1.2.2.1.2.2" xref="S3.E1.m1.5.5.1.1.2.2.1.2.2.cmml">arg</mi><mo lspace="0.170em" rspace="0em" id="S3.E1.m1.5.5.1.1.2.2.1.2.1" xref="S3.E1.m1.5.5.1.1.2.2.1.2.1.cmml">​</mo><mi id="S3.E1.m1.5.5.1.1.2.2.1.2.3" xref="S3.E1.m1.5.5.1.1.2.2.1.2.3.cmml">min</mi></mrow><mi id="S3.E1.m1.5.5.1.1.2.2.1.3" xref="S3.E1.m1.5.5.1.1.2.2.1.3.cmml">w</mi></munder><mo lspace="0.167em" id="S3.E1.m1.5.5.1.1.2.2a" xref="S3.E1.m1.5.5.1.1.2.2.cmml">⁡</mo><mi class="ltx_font_mathcaligraphic" id="S3.E1.m1.5.5.1.1.2.2.2" xref="S3.E1.m1.5.5.1.1.2.2.2.cmml">ℒ</mi></mrow><mo lspace="0em" rspace="0em" id="S3.E1.m1.5.5.1.1.2.1" xref="S3.E1.m1.5.5.1.1.2.1.cmml">​</mo><mrow id="S3.E1.m1.5.5.1.1.2.3.2" xref="S3.E1.m1.5.5.1.1.2.cmml"><mo stretchy="false" id="S3.E1.m1.5.5.1.1.2.3.2.1" xref="S3.E1.m1.5.5.1.1.2.cmml">(</mo><mi id="S3.E1.m1.3.3" xref="S3.E1.m1.3.3.cmml">w</mi><mo stretchy="false" id="S3.E1.m1.5.5.1.1.2.3.2.2" xref="S3.E1.m1.5.5.1.1.2.cmml">)</mo></mrow></mrow><mo rspace="0.111em" id="S3.E1.m1.5.5.1.1.1" xref="S3.E1.m1.5.5.1.1.1.cmml">=</mo><mrow id="S3.E1.m1.5.5.1.1.3" xref="S3.E1.m1.5.5.1.1.3.cmml"><munderover id="S3.E1.m1.5.5.1.1.3.1" xref="S3.E1.m1.5.5.1.1.3.1.cmml"><mo movablelimits="false" id="S3.E1.m1.5.5.1.1.3.1.2.2" xref="S3.E1.m1.5.5.1.1.3.1.2.2.cmml">∑</mo><mrow id="S3.E1.m1.5.5.1.1.3.1.2.3" xref="S3.E1.m1.5.5.1.1.3.1.2.3.cmml"><mi id="S3.E1.m1.5.5.1.1.3.1.2.3.2" xref="S3.E1.m1.5.5.1.1.3.1.2.3.2.cmml">i</mi><mo id="S3.E1.m1.5.5.1.1.3.1.2.3.1" xref="S3.E1.m1.5.5.1.1.3.1.2.3.1.cmml">=</mo><mn id="S3.E1.m1.5.5.1.1.3.1.2.3.3" xref="S3.E1.m1.5.5.1.1.3.1.2.3.3.cmml">1</mn></mrow><mi id="S3.E1.m1.5.5.1.1.3.1.3" xref="S3.E1.m1.5.5.1.1.3.1.3.cmml">N</mi></munderover><mrow id="S3.E1.m1.5.5.1.1.3.2" xref="S3.E1.m1.5.5.1.1.3.2.cmml"><mfrac id="S3.E1.m1.2.2" xref="S3.E1.m1.2.2.cmml"><mrow id="S3.E1.m1.1.1.1.1" xref="S3.E1.m1.1.1.1.2.cmml"><mo stretchy="false" id="S3.E1.m1.1.1.1.1.2" xref="S3.E1.m1.1.1.1.2.1.cmml">|</mo><msup id="S3.E1.m1.1.1.1.1.1" xref="S3.E1.m1.1.1.1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.E1.m1.1.1.1.1.1.2" xref="S3.E1.m1.1.1.1.1.1.2.cmml">𝒟</mi><mi id="S3.E1.m1.1.1.1.1.1.3" xref="S3.E1.m1.1.1.1.1.1.3.cmml">i</mi></msup><mo stretchy="false" id="S3.E1.m1.1.1.1.1.3" xref="S3.E1.m1.1.1.1.2.1.cmml">|</mo></mrow><mrow id="S3.E1.m1.2.2.2.3" xref="S3.E1.m1.2.2.2.2.cmml"><mo stretchy="false" id="S3.E1.m1.2.2.2.3.1" xref="S3.E1.m1.2.2.2.2.1.cmml">|</mo><mi class="ltx_font_mathcaligraphic" id="S3.E1.m1.2.2.2.1" xref="S3.E1.m1.2.2.2.1.cmml">𝒟</mi><mo stretchy="false" id="S3.E1.m1.2.2.2.3.2" xref="S3.E1.m1.2.2.2.2.1.cmml">|</mo></mrow></mfrac><mo lspace="0em" rspace="0em" id="S3.E1.m1.5.5.1.1.3.2.1" xref="S3.E1.m1.5.5.1.1.3.2.1.cmml">​</mo><msub id="S3.E1.m1.5.5.1.1.3.2.2" xref="S3.E1.m1.5.5.1.1.3.2.2.cmml"><mi id="S3.E1.m1.5.5.1.1.3.2.2.2" xref="S3.E1.m1.5.5.1.1.3.2.2.2.cmml">L</mi><mi id="S3.E1.m1.5.5.1.1.3.2.2.3" xref="S3.E1.m1.5.5.1.1.3.2.2.3.cmml">i</mi></msub><mo lspace="0em" rspace="0em" id="S3.E1.m1.5.5.1.1.3.2.1a" xref="S3.E1.m1.5.5.1.1.3.2.1.cmml">​</mo><mrow id="S3.E1.m1.5.5.1.1.3.2.3.2" xref="S3.E1.m1.5.5.1.1.3.2.cmml"><mo stretchy="false" id="S3.E1.m1.5.5.1.1.3.2.3.2.1" xref="S3.E1.m1.5.5.1.1.3.2.cmml">(</mo><mi id="S3.E1.m1.4.4" xref="S3.E1.m1.4.4.cmml">w</mi><mo stretchy="false" id="S3.E1.m1.5.5.1.1.3.2.3.2.2" xref="S3.E1.m1.5.5.1.1.3.2.cmml">)</mo></mrow></mrow></mrow></mrow><mo id="S3.E1.m1.5.5.1.2" xref="S3.E1.m1.5.5.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E1.m1.5b"><apply id="S3.E1.m1.5.5.1.1.cmml" xref="S3.E1.m1.5.5.1"><eq id="S3.E1.m1.5.5.1.1.1.cmml" xref="S3.E1.m1.5.5.1.1.1"></eq><apply id="S3.E1.m1.5.5.1.1.2.cmml" xref="S3.E1.m1.5.5.1.1.2"><times id="S3.E1.m1.5.5.1.1.2.1.cmml" xref="S3.E1.m1.5.5.1.1.2.1"></times><apply id="S3.E1.m1.5.5.1.1.2.2.cmml" xref="S3.E1.m1.5.5.1.1.2.2"><apply id="S3.E1.m1.5.5.1.1.2.2.1.cmml" xref="S3.E1.m1.5.5.1.1.2.2.1"><csymbol cd="ambiguous" id="S3.E1.m1.5.5.1.1.2.2.1.1.cmml" xref="S3.E1.m1.5.5.1.1.2.2.1">subscript</csymbol><apply id="S3.E1.m1.5.5.1.1.2.2.1.2.cmml" xref="S3.E1.m1.5.5.1.1.2.2.1.2"><times id="S3.E1.m1.5.5.1.1.2.2.1.2.1.cmml" xref="S3.E1.m1.5.5.1.1.2.2.1.2.1"></times><ci id="S3.E1.m1.5.5.1.1.2.2.1.2.2.cmml" xref="S3.E1.m1.5.5.1.1.2.2.1.2.2">arg</ci><ci id="S3.E1.m1.5.5.1.1.2.2.1.2.3.cmml" xref="S3.E1.m1.5.5.1.1.2.2.1.2.3">min</ci></apply><ci id="S3.E1.m1.5.5.1.1.2.2.1.3.cmml" xref="S3.E1.m1.5.5.1.1.2.2.1.3">𝑤</ci></apply><ci id="S3.E1.m1.5.5.1.1.2.2.2.cmml" xref="S3.E1.m1.5.5.1.1.2.2.2">ℒ</ci></apply><ci id="S3.E1.m1.3.3.cmml" xref="S3.E1.m1.3.3">𝑤</ci></apply><apply id="S3.E1.m1.5.5.1.1.3.cmml" xref="S3.E1.m1.5.5.1.1.3"><apply id="S3.E1.m1.5.5.1.1.3.1.cmml" xref="S3.E1.m1.5.5.1.1.3.1"><csymbol cd="ambiguous" id="S3.E1.m1.5.5.1.1.3.1.1.cmml" xref="S3.E1.m1.5.5.1.1.3.1">superscript</csymbol><apply id="S3.E1.m1.5.5.1.1.3.1.2.cmml" xref="S3.E1.m1.5.5.1.1.3.1"><csymbol cd="ambiguous" id="S3.E1.m1.5.5.1.1.3.1.2.1.cmml" xref="S3.E1.m1.5.5.1.1.3.1">subscript</csymbol><sum id="S3.E1.m1.5.5.1.1.3.1.2.2.cmml" xref="S3.E1.m1.5.5.1.1.3.1.2.2"></sum><apply id="S3.E1.m1.5.5.1.1.3.1.2.3.cmml" xref="S3.E1.m1.5.5.1.1.3.1.2.3"><eq id="S3.E1.m1.5.5.1.1.3.1.2.3.1.cmml" xref="S3.E1.m1.5.5.1.1.3.1.2.3.1"></eq><ci id="S3.E1.m1.5.5.1.1.3.1.2.3.2.cmml" xref="S3.E1.m1.5.5.1.1.3.1.2.3.2">𝑖</ci><cn type="integer" id="S3.E1.m1.5.5.1.1.3.1.2.3.3.cmml" xref="S3.E1.m1.5.5.1.1.3.1.2.3.3">1</cn></apply></apply><ci id="S3.E1.m1.5.5.1.1.3.1.3.cmml" xref="S3.E1.m1.5.5.1.1.3.1.3">𝑁</ci></apply><apply id="S3.E1.m1.5.5.1.1.3.2.cmml" xref="S3.E1.m1.5.5.1.1.3.2"><times id="S3.E1.m1.5.5.1.1.3.2.1.cmml" xref="S3.E1.m1.5.5.1.1.3.2.1"></times><apply id="S3.E1.m1.2.2.cmml" xref="S3.E1.m1.2.2"><divide id="S3.E1.m1.2.2.3.cmml" xref="S3.E1.m1.2.2"></divide><apply id="S3.E1.m1.1.1.1.2.cmml" xref="S3.E1.m1.1.1.1.1"><abs id="S3.E1.m1.1.1.1.2.1.cmml" xref="S3.E1.m1.1.1.1.1.2"></abs><apply id="S3.E1.m1.1.1.1.1.1.cmml" xref="S3.E1.m1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E1.m1.1.1.1.1.1.1.cmml" xref="S3.E1.m1.1.1.1.1.1">superscript</csymbol><ci id="S3.E1.m1.1.1.1.1.1.2.cmml" xref="S3.E1.m1.1.1.1.1.1.2">𝒟</ci><ci id="S3.E1.m1.1.1.1.1.1.3.cmml" xref="S3.E1.m1.1.1.1.1.1.3">𝑖</ci></apply></apply><apply id="S3.E1.m1.2.2.2.2.cmml" xref="S3.E1.m1.2.2.2.3"><abs id="S3.E1.m1.2.2.2.2.1.cmml" xref="S3.E1.m1.2.2.2.3.1"></abs><ci id="S3.E1.m1.2.2.2.1.cmml" xref="S3.E1.m1.2.2.2.1">𝒟</ci></apply></apply><apply id="S3.E1.m1.5.5.1.1.3.2.2.cmml" xref="S3.E1.m1.5.5.1.1.3.2.2"><csymbol cd="ambiguous" id="S3.E1.m1.5.5.1.1.3.2.2.1.cmml" xref="S3.E1.m1.5.5.1.1.3.2.2">subscript</csymbol><ci id="S3.E1.m1.5.5.1.1.3.2.2.2.cmml" xref="S3.E1.m1.5.5.1.1.3.2.2.2">𝐿</ci><ci id="S3.E1.m1.5.5.1.1.3.2.2.3.cmml" xref="S3.E1.m1.5.5.1.1.3.2.2.3">𝑖</ci></apply><ci id="S3.E1.m1.4.4.cmml" xref="S3.E1.m1.4.4">𝑤</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E1.m1.5c">\operatorname*{arg\,min}_{w}\mathcal{L}(w)=\sum_{i=1}^{N}\frac{|\mathcal{D}^{i}|}{|\mathcal{D}|}L_{i}(w),</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(1)</span></td>
</tr></tbody>
</table>
<p id="S3.SS1.p1.9" class="ltx_p">where <math id="S3.SS1.p1.7.m1.7" class="ltx_Math" alttext="L_{i}(w)=\mathbb{E}_{(x,y)\sim\mathcal{D}^{i}}[\ell_{i}(w;(x,y))]" display="inline"><semantics id="S3.SS1.p1.7.m1.7a"><mrow id="S3.SS1.p1.7.m1.7.7" xref="S3.SS1.p1.7.m1.7.7.cmml"><mrow id="S3.SS1.p1.7.m1.7.7.3" xref="S3.SS1.p1.7.m1.7.7.3.cmml"><msub id="S3.SS1.p1.7.m1.7.7.3.2" xref="S3.SS1.p1.7.m1.7.7.3.2.cmml"><mi id="S3.SS1.p1.7.m1.7.7.3.2.2" xref="S3.SS1.p1.7.m1.7.7.3.2.2.cmml">L</mi><mi id="S3.SS1.p1.7.m1.7.7.3.2.3" xref="S3.SS1.p1.7.m1.7.7.3.2.3.cmml">i</mi></msub><mo lspace="0em" rspace="0em" id="S3.SS1.p1.7.m1.7.7.3.1" xref="S3.SS1.p1.7.m1.7.7.3.1.cmml">​</mo><mrow id="S3.SS1.p1.7.m1.7.7.3.3.2" xref="S3.SS1.p1.7.m1.7.7.3.cmml"><mo stretchy="false" id="S3.SS1.p1.7.m1.7.7.3.3.2.1" xref="S3.SS1.p1.7.m1.7.7.3.cmml">(</mo><mi id="S3.SS1.p1.7.m1.3.3" xref="S3.SS1.p1.7.m1.3.3.cmml">w</mi><mo stretchy="false" id="S3.SS1.p1.7.m1.7.7.3.3.2.2" xref="S3.SS1.p1.7.m1.7.7.3.cmml">)</mo></mrow></mrow><mo id="S3.SS1.p1.7.m1.7.7.2" xref="S3.SS1.p1.7.m1.7.7.2.cmml">=</mo><mrow id="S3.SS1.p1.7.m1.7.7.1" xref="S3.SS1.p1.7.m1.7.7.1.cmml"><msub id="S3.SS1.p1.7.m1.7.7.1.3" xref="S3.SS1.p1.7.m1.7.7.1.3.cmml"><mi id="S3.SS1.p1.7.m1.7.7.1.3.2" xref="S3.SS1.p1.7.m1.7.7.1.3.2.cmml">𝔼</mi><mrow id="S3.SS1.p1.7.m1.2.2.2" xref="S3.SS1.p1.7.m1.2.2.2.cmml"><mrow id="S3.SS1.p1.7.m1.2.2.2.4.2" xref="S3.SS1.p1.7.m1.2.2.2.4.1.cmml"><mo stretchy="false" id="S3.SS1.p1.7.m1.2.2.2.4.2.1" xref="S3.SS1.p1.7.m1.2.2.2.4.1.cmml">(</mo><mi id="S3.SS1.p1.7.m1.1.1.1.1" xref="S3.SS1.p1.7.m1.1.1.1.1.cmml">x</mi><mo id="S3.SS1.p1.7.m1.2.2.2.4.2.2" xref="S3.SS1.p1.7.m1.2.2.2.4.1.cmml">,</mo><mi id="S3.SS1.p1.7.m1.2.2.2.2" xref="S3.SS1.p1.7.m1.2.2.2.2.cmml">y</mi><mo stretchy="false" id="S3.SS1.p1.7.m1.2.2.2.4.2.3" xref="S3.SS1.p1.7.m1.2.2.2.4.1.cmml">)</mo></mrow><mo id="S3.SS1.p1.7.m1.2.2.2.3" xref="S3.SS1.p1.7.m1.2.2.2.3.cmml">∼</mo><msup id="S3.SS1.p1.7.m1.2.2.2.5" xref="S3.SS1.p1.7.m1.2.2.2.5.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS1.p1.7.m1.2.2.2.5.2" xref="S3.SS1.p1.7.m1.2.2.2.5.2.cmml">𝒟</mi><mi id="S3.SS1.p1.7.m1.2.2.2.5.3" xref="S3.SS1.p1.7.m1.2.2.2.5.3.cmml">i</mi></msup></mrow></msub><mo lspace="0em" rspace="0em" id="S3.SS1.p1.7.m1.7.7.1.2" xref="S3.SS1.p1.7.m1.7.7.1.2.cmml">​</mo><mrow id="S3.SS1.p1.7.m1.7.7.1.1.1" xref="S3.SS1.p1.7.m1.7.7.1.1.2.cmml"><mo stretchy="false" id="S3.SS1.p1.7.m1.7.7.1.1.1.2" xref="S3.SS1.p1.7.m1.7.7.1.1.2.1.cmml">[</mo><mrow id="S3.SS1.p1.7.m1.7.7.1.1.1.1" xref="S3.SS1.p1.7.m1.7.7.1.1.1.1.cmml"><msub id="S3.SS1.p1.7.m1.7.7.1.1.1.1.3" xref="S3.SS1.p1.7.m1.7.7.1.1.1.1.3.cmml"><mi mathvariant="normal" id="S3.SS1.p1.7.m1.7.7.1.1.1.1.3.2" xref="S3.SS1.p1.7.m1.7.7.1.1.1.1.3.2.cmml">ℓ</mi><mi id="S3.SS1.p1.7.m1.7.7.1.1.1.1.3.3" xref="S3.SS1.p1.7.m1.7.7.1.1.1.1.3.3.cmml">i</mi></msub><mo lspace="0em" rspace="0em" id="S3.SS1.p1.7.m1.7.7.1.1.1.1.2" xref="S3.SS1.p1.7.m1.7.7.1.1.1.1.2.cmml">​</mo><mrow id="S3.SS1.p1.7.m1.7.7.1.1.1.1.1.1" xref="S3.SS1.p1.7.m1.7.7.1.1.1.1.1.2.cmml"><mo stretchy="false" id="S3.SS1.p1.7.m1.7.7.1.1.1.1.1.1.2" xref="S3.SS1.p1.7.m1.7.7.1.1.1.1.1.2.cmml">(</mo><mi id="S3.SS1.p1.7.m1.6.6" xref="S3.SS1.p1.7.m1.6.6.cmml">w</mi><mo id="S3.SS1.p1.7.m1.7.7.1.1.1.1.1.1.3" xref="S3.SS1.p1.7.m1.7.7.1.1.1.1.1.2.cmml">;</mo><mrow id="S3.SS1.p1.7.m1.7.7.1.1.1.1.1.1.1.2" xref="S3.SS1.p1.7.m1.7.7.1.1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S3.SS1.p1.7.m1.7.7.1.1.1.1.1.1.1.2.1" xref="S3.SS1.p1.7.m1.7.7.1.1.1.1.1.1.1.1.cmml">(</mo><mi id="S3.SS1.p1.7.m1.4.4" xref="S3.SS1.p1.7.m1.4.4.cmml">x</mi><mo id="S3.SS1.p1.7.m1.7.7.1.1.1.1.1.1.1.2.2" xref="S3.SS1.p1.7.m1.7.7.1.1.1.1.1.1.1.1.cmml">,</mo><mi id="S3.SS1.p1.7.m1.5.5" xref="S3.SS1.p1.7.m1.5.5.cmml">y</mi><mo stretchy="false" id="S3.SS1.p1.7.m1.7.7.1.1.1.1.1.1.1.2.3" xref="S3.SS1.p1.7.m1.7.7.1.1.1.1.1.1.1.1.cmml">)</mo></mrow><mo stretchy="false" id="S3.SS1.p1.7.m1.7.7.1.1.1.1.1.1.4" xref="S3.SS1.p1.7.m1.7.7.1.1.1.1.1.2.cmml">)</mo></mrow></mrow><mo stretchy="false" id="S3.SS1.p1.7.m1.7.7.1.1.1.3" xref="S3.SS1.p1.7.m1.7.7.1.1.2.1.cmml">]</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.7.m1.7b"><apply id="S3.SS1.p1.7.m1.7.7.cmml" xref="S3.SS1.p1.7.m1.7.7"><eq id="S3.SS1.p1.7.m1.7.7.2.cmml" xref="S3.SS1.p1.7.m1.7.7.2"></eq><apply id="S3.SS1.p1.7.m1.7.7.3.cmml" xref="S3.SS1.p1.7.m1.7.7.3"><times id="S3.SS1.p1.7.m1.7.7.3.1.cmml" xref="S3.SS1.p1.7.m1.7.7.3.1"></times><apply id="S3.SS1.p1.7.m1.7.7.3.2.cmml" xref="S3.SS1.p1.7.m1.7.7.3.2"><csymbol cd="ambiguous" id="S3.SS1.p1.7.m1.7.7.3.2.1.cmml" xref="S3.SS1.p1.7.m1.7.7.3.2">subscript</csymbol><ci id="S3.SS1.p1.7.m1.7.7.3.2.2.cmml" xref="S3.SS1.p1.7.m1.7.7.3.2.2">𝐿</ci><ci id="S3.SS1.p1.7.m1.7.7.3.2.3.cmml" xref="S3.SS1.p1.7.m1.7.7.3.2.3">𝑖</ci></apply><ci id="S3.SS1.p1.7.m1.3.3.cmml" xref="S3.SS1.p1.7.m1.3.3">𝑤</ci></apply><apply id="S3.SS1.p1.7.m1.7.7.1.cmml" xref="S3.SS1.p1.7.m1.7.7.1"><times id="S3.SS1.p1.7.m1.7.7.1.2.cmml" xref="S3.SS1.p1.7.m1.7.7.1.2"></times><apply id="S3.SS1.p1.7.m1.7.7.1.3.cmml" xref="S3.SS1.p1.7.m1.7.7.1.3"><csymbol cd="ambiguous" id="S3.SS1.p1.7.m1.7.7.1.3.1.cmml" xref="S3.SS1.p1.7.m1.7.7.1.3">subscript</csymbol><ci id="S3.SS1.p1.7.m1.7.7.1.3.2.cmml" xref="S3.SS1.p1.7.m1.7.7.1.3.2">𝔼</ci><apply id="S3.SS1.p1.7.m1.2.2.2.cmml" xref="S3.SS1.p1.7.m1.2.2.2"><csymbol cd="latexml" id="S3.SS1.p1.7.m1.2.2.2.3.cmml" xref="S3.SS1.p1.7.m1.2.2.2.3">similar-to</csymbol><interval closure="open" id="S3.SS1.p1.7.m1.2.2.2.4.1.cmml" xref="S3.SS1.p1.7.m1.2.2.2.4.2"><ci id="S3.SS1.p1.7.m1.1.1.1.1.cmml" xref="S3.SS1.p1.7.m1.1.1.1.1">𝑥</ci><ci id="S3.SS1.p1.7.m1.2.2.2.2.cmml" xref="S3.SS1.p1.7.m1.2.2.2.2">𝑦</ci></interval><apply id="S3.SS1.p1.7.m1.2.2.2.5.cmml" xref="S3.SS1.p1.7.m1.2.2.2.5"><csymbol cd="ambiguous" id="S3.SS1.p1.7.m1.2.2.2.5.1.cmml" xref="S3.SS1.p1.7.m1.2.2.2.5">superscript</csymbol><ci id="S3.SS1.p1.7.m1.2.2.2.5.2.cmml" xref="S3.SS1.p1.7.m1.2.2.2.5.2">𝒟</ci><ci id="S3.SS1.p1.7.m1.2.2.2.5.3.cmml" xref="S3.SS1.p1.7.m1.2.2.2.5.3">𝑖</ci></apply></apply></apply><apply id="S3.SS1.p1.7.m1.7.7.1.1.2.cmml" xref="S3.SS1.p1.7.m1.7.7.1.1.1"><csymbol cd="latexml" id="S3.SS1.p1.7.m1.7.7.1.1.2.1.cmml" xref="S3.SS1.p1.7.m1.7.7.1.1.1.2">delimited-[]</csymbol><apply id="S3.SS1.p1.7.m1.7.7.1.1.1.1.cmml" xref="S3.SS1.p1.7.m1.7.7.1.1.1.1"><times id="S3.SS1.p1.7.m1.7.7.1.1.1.1.2.cmml" xref="S3.SS1.p1.7.m1.7.7.1.1.1.1.2"></times><apply id="S3.SS1.p1.7.m1.7.7.1.1.1.1.3.cmml" xref="S3.SS1.p1.7.m1.7.7.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.SS1.p1.7.m1.7.7.1.1.1.1.3.1.cmml" xref="S3.SS1.p1.7.m1.7.7.1.1.1.1.3">subscript</csymbol><ci id="S3.SS1.p1.7.m1.7.7.1.1.1.1.3.2.cmml" xref="S3.SS1.p1.7.m1.7.7.1.1.1.1.3.2">ℓ</ci><ci id="S3.SS1.p1.7.m1.7.7.1.1.1.1.3.3.cmml" xref="S3.SS1.p1.7.m1.7.7.1.1.1.1.3.3">𝑖</ci></apply><list id="S3.SS1.p1.7.m1.7.7.1.1.1.1.1.2.cmml" xref="S3.SS1.p1.7.m1.7.7.1.1.1.1.1.1"><ci id="S3.SS1.p1.7.m1.6.6.cmml" xref="S3.SS1.p1.7.m1.6.6">𝑤</ci><interval closure="open" id="S3.SS1.p1.7.m1.7.7.1.1.1.1.1.1.1.1.cmml" xref="S3.SS1.p1.7.m1.7.7.1.1.1.1.1.1.1.2"><ci id="S3.SS1.p1.7.m1.4.4.cmml" xref="S3.SS1.p1.7.m1.4.4">𝑥</ci><ci id="S3.SS1.p1.7.m1.5.5.cmml" xref="S3.SS1.p1.7.m1.5.5">𝑦</ci></interval></list></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.7.m1.7c">L_{i}(w)=\mathbb{E}_{(x,y)\sim\mathcal{D}^{i}}[\ell_{i}(w;(x,y))]</annotation></semantics></math> is the empirical loss of <math id="S3.SS1.p1.8.m2.1" class="ltx_Math" alttext="C_{i}" display="inline"><semantics id="S3.SS1.p1.8.m2.1a"><msub id="S3.SS1.p1.8.m2.1.1" xref="S3.SS1.p1.8.m2.1.1.cmml"><mi id="S3.SS1.p1.8.m2.1.1.2" xref="S3.SS1.p1.8.m2.1.1.2.cmml">C</mi><mi id="S3.SS1.p1.8.m2.1.1.3" xref="S3.SS1.p1.8.m2.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.8.m2.1b"><apply id="S3.SS1.p1.8.m2.1.1.cmml" xref="S3.SS1.p1.8.m2.1.1"><csymbol cd="ambiguous" id="S3.SS1.p1.8.m2.1.1.1.cmml" xref="S3.SS1.p1.8.m2.1.1">subscript</csymbol><ci id="S3.SS1.p1.8.m2.1.1.2.cmml" xref="S3.SS1.p1.8.m2.1.1.2">𝐶</ci><ci id="S3.SS1.p1.8.m2.1.1.3.cmml" xref="S3.SS1.p1.8.m2.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.8.m2.1c">C_{i}</annotation></semantics></math>. However, rather than aiming at a single aggregated model w in FL, PFL is supposed to train personalized models <math id="S3.SS1.p1.9.m3.1" class="ltx_Math" alttext="w_{i}" display="inline"><semantics id="S3.SS1.p1.9.m3.1a"><msub id="S3.SS1.p1.9.m3.1.1" xref="S3.SS1.p1.9.m3.1.1.cmml"><mi id="S3.SS1.p1.9.m3.1.1.2" xref="S3.SS1.p1.9.m3.1.1.2.cmml">w</mi><mi id="S3.SS1.p1.9.m3.1.1.3" xref="S3.SS1.p1.9.m3.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.9.m3.1b"><apply id="S3.SS1.p1.9.m3.1.1.cmml" xref="S3.SS1.p1.9.m3.1.1"><csymbol cd="ambiguous" id="S3.SS1.p1.9.m3.1.1.1.cmml" xref="S3.SS1.p1.9.m3.1.1">subscript</csymbol><ci id="S3.SS1.p1.9.m3.1.1.2.cmml" xref="S3.SS1.p1.9.m3.1.1.2">𝑤</ci><ci id="S3.SS1.p1.9.m3.1.1.3.cmml" xref="S3.SS1.p1.9.m3.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.9.m3.1c">w_{i}</annotation></semantics></math> for different clients <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib41" title="" class="ltx_ref">41</a>]</cite>, which is defined as the following optimization problem:</p>
<table id="S3.E2" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S3.E2.m1.4" class="ltx_Math" alttext="\operatorname*{arg\,min}_{{W}}\mathcal{L}({W})=\sum_{i=1}^{N}\frac{|\mathcal{D}^{i}|}{|\mathcal{D}|}L_{i}(w_{i})," display="block"><semantics id="S3.E2.m1.4a"><mrow id="S3.E2.m1.4.4.1" xref="S3.E2.m1.4.4.1.1.cmml"><mrow id="S3.E2.m1.4.4.1.1" xref="S3.E2.m1.4.4.1.1.cmml"><mrow id="S3.E2.m1.4.4.1.1.3" xref="S3.E2.m1.4.4.1.1.3.cmml"><mrow id="S3.E2.m1.4.4.1.1.3.2" xref="S3.E2.m1.4.4.1.1.3.2.cmml"><munder id="S3.E2.m1.4.4.1.1.3.2.1" xref="S3.E2.m1.4.4.1.1.3.2.1.cmml"><mrow id="S3.E2.m1.4.4.1.1.3.2.1.2" xref="S3.E2.m1.4.4.1.1.3.2.1.2.cmml"><mi id="S3.E2.m1.4.4.1.1.3.2.1.2.2" xref="S3.E2.m1.4.4.1.1.3.2.1.2.2.cmml">arg</mi><mo lspace="0.170em" rspace="0em" id="S3.E2.m1.4.4.1.1.3.2.1.2.1" xref="S3.E2.m1.4.4.1.1.3.2.1.2.1.cmml">​</mo><mi id="S3.E2.m1.4.4.1.1.3.2.1.2.3" xref="S3.E2.m1.4.4.1.1.3.2.1.2.3.cmml">min</mi></mrow><mi id="S3.E2.m1.4.4.1.1.3.2.1.3" xref="S3.E2.m1.4.4.1.1.3.2.1.3.cmml">W</mi></munder><mo lspace="0.167em" id="S3.E2.m1.4.4.1.1.3.2a" xref="S3.E2.m1.4.4.1.1.3.2.cmml">⁡</mo><mi class="ltx_font_mathcaligraphic" id="S3.E2.m1.4.4.1.1.3.2.2" xref="S3.E2.m1.4.4.1.1.3.2.2.cmml">ℒ</mi></mrow><mo lspace="0em" rspace="0em" id="S3.E2.m1.4.4.1.1.3.1" xref="S3.E2.m1.4.4.1.1.3.1.cmml">​</mo><mrow id="S3.E2.m1.4.4.1.1.3.3.2" xref="S3.E2.m1.4.4.1.1.3.cmml"><mo stretchy="false" id="S3.E2.m1.4.4.1.1.3.3.2.1" xref="S3.E2.m1.4.4.1.1.3.cmml">(</mo><mi id="S3.E2.m1.3.3" xref="S3.E2.m1.3.3.cmml">W</mi><mo stretchy="false" id="S3.E2.m1.4.4.1.1.3.3.2.2" xref="S3.E2.m1.4.4.1.1.3.cmml">)</mo></mrow></mrow><mo rspace="0.111em" id="S3.E2.m1.4.4.1.1.2" xref="S3.E2.m1.4.4.1.1.2.cmml">=</mo><mrow id="S3.E2.m1.4.4.1.1.1" xref="S3.E2.m1.4.4.1.1.1.cmml"><munderover id="S3.E2.m1.4.4.1.1.1.2" xref="S3.E2.m1.4.4.1.1.1.2.cmml"><mo movablelimits="false" id="S3.E2.m1.4.4.1.1.1.2.2.2" xref="S3.E2.m1.4.4.1.1.1.2.2.2.cmml">∑</mo><mrow id="S3.E2.m1.4.4.1.1.1.2.2.3" xref="S3.E2.m1.4.4.1.1.1.2.2.3.cmml"><mi id="S3.E2.m1.4.4.1.1.1.2.2.3.2" xref="S3.E2.m1.4.4.1.1.1.2.2.3.2.cmml">i</mi><mo id="S3.E2.m1.4.4.1.1.1.2.2.3.1" xref="S3.E2.m1.4.4.1.1.1.2.2.3.1.cmml">=</mo><mn id="S3.E2.m1.4.4.1.1.1.2.2.3.3" xref="S3.E2.m1.4.4.1.1.1.2.2.3.3.cmml">1</mn></mrow><mi id="S3.E2.m1.4.4.1.1.1.2.3" xref="S3.E2.m1.4.4.1.1.1.2.3.cmml">N</mi></munderover><mrow id="S3.E2.m1.4.4.1.1.1.1" xref="S3.E2.m1.4.4.1.1.1.1.cmml"><mfrac id="S3.E2.m1.2.2" xref="S3.E2.m1.2.2.cmml"><mrow id="S3.E2.m1.1.1.1.1" xref="S3.E2.m1.1.1.1.2.cmml"><mo stretchy="false" id="S3.E2.m1.1.1.1.1.2" xref="S3.E2.m1.1.1.1.2.1.cmml">|</mo><msup id="S3.E2.m1.1.1.1.1.1" xref="S3.E2.m1.1.1.1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.E2.m1.1.1.1.1.1.2" xref="S3.E2.m1.1.1.1.1.1.2.cmml">𝒟</mi><mi id="S3.E2.m1.1.1.1.1.1.3" xref="S3.E2.m1.1.1.1.1.1.3.cmml">i</mi></msup><mo stretchy="false" id="S3.E2.m1.1.1.1.1.3" xref="S3.E2.m1.1.1.1.2.1.cmml">|</mo></mrow><mrow id="S3.E2.m1.2.2.2.3" xref="S3.E2.m1.2.2.2.2.cmml"><mo stretchy="false" id="S3.E2.m1.2.2.2.3.1" xref="S3.E2.m1.2.2.2.2.1.cmml">|</mo><mi class="ltx_font_mathcaligraphic" id="S3.E2.m1.2.2.2.1" xref="S3.E2.m1.2.2.2.1.cmml">𝒟</mi><mo stretchy="false" id="S3.E2.m1.2.2.2.3.2" xref="S3.E2.m1.2.2.2.2.1.cmml">|</mo></mrow></mfrac><mo lspace="0em" rspace="0em" id="S3.E2.m1.4.4.1.1.1.1.2" xref="S3.E2.m1.4.4.1.1.1.1.2.cmml">​</mo><msub id="S3.E2.m1.4.4.1.1.1.1.3" xref="S3.E2.m1.4.4.1.1.1.1.3.cmml"><mi id="S3.E2.m1.4.4.1.1.1.1.3.2" xref="S3.E2.m1.4.4.1.1.1.1.3.2.cmml">L</mi><mi id="S3.E2.m1.4.4.1.1.1.1.3.3" xref="S3.E2.m1.4.4.1.1.1.1.3.3.cmml">i</mi></msub><mo lspace="0em" rspace="0em" id="S3.E2.m1.4.4.1.1.1.1.2a" xref="S3.E2.m1.4.4.1.1.1.1.2.cmml">​</mo><mrow id="S3.E2.m1.4.4.1.1.1.1.1.1" xref="S3.E2.m1.4.4.1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S3.E2.m1.4.4.1.1.1.1.1.1.2" xref="S3.E2.m1.4.4.1.1.1.1.1.1.1.cmml">(</mo><msub id="S3.E2.m1.4.4.1.1.1.1.1.1.1" xref="S3.E2.m1.4.4.1.1.1.1.1.1.1.cmml"><mi id="S3.E2.m1.4.4.1.1.1.1.1.1.1.2" xref="S3.E2.m1.4.4.1.1.1.1.1.1.1.2.cmml">w</mi><mi id="S3.E2.m1.4.4.1.1.1.1.1.1.1.3" xref="S3.E2.m1.4.4.1.1.1.1.1.1.1.3.cmml">i</mi></msub><mo stretchy="false" id="S3.E2.m1.4.4.1.1.1.1.1.1.3" xref="S3.E2.m1.4.4.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow></mrow><mo id="S3.E2.m1.4.4.1.2" xref="S3.E2.m1.4.4.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E2.m1.4b"><apply id="S3.E2.m1.4.4.1.1.cmml" xref="S3.E2.m1.4.4.1"><eq id="S3.E2.m1.4.4.1.1.2.cmml" xref="S3.E2.m1.4.4.1.1.2"></eq><apply id="S3.E2.m1.4.4.1.1.3.cmml" xref="S3.E2.m1.4.4.1.1.3"><times id="S3.E2.m1.4.4.1.1.3.1.cmml" xref="S3.E2.m1.4.4.1.1.3.1"></times><apply id="S3.E2.m1.4.4.1.1.3.2.cmml" xref="S3.E2.m1.4.4.1.1.3.2"><apply id="S3.E2.m1.4.4.1.1.3.2.1.cmml" xref="S3.E2.m1.4.4.1.1.3.2.1"><csymbol cd="ambiguous" id="S3.E2.m1.4.4.1.1.3.2.1.1.cmml" xref="S3.E2.m1.4.4.1.1.3.2.1">subscript</csymbol><apply id="S3.E2.m1.4.4.1.1.3.2.1.2.cmml" xref="S3.E2.m1.4.4.1.1.3.2.1.2"><times id="S3.E2.m1.4.4.1.1.3.2.1.2.1.cmml" xref="S3.E2.m1.4.4.1.1.3.2.1.2.1"></times><ci id="S3.E2.m1.4.4.1.1.3.2.1.2.2.cmml" xref="S3.E2.m1.4.4.1.1.3.2.1.2.2">arg</ci><ci id="S3.E2.m1.4.4.1.1.3.2.1.2.3.cmml" xref="S3.E2.m1.4.4.1.1.3.2.1.2.3">min</ci></apply><ci id="S3.E2.m1.4.4.1.1.3.2.1.3.cmml" xref="S3.E2.m1.4.4.1.1.3.2.1.3">𝑊</ci></apply><ci id="S3.E2.m1.4.4.1.1.3.2.2.cmml" xref="S3.E2.m1.4.4.1.1.3.2.2">ℒ</ci></apply><ci id="S3.E2.m1.3.3.cmml" xref="S3.E2.m1.3.3">𝑊</ci></apply><apply id="S3.E2.m1.4.4.1.1.1.cmml" xref="S3.E2.m1.4.4.1.1.1"><apply id="S3.E2.m1.4.4.1.1.1.2.cmml" xref="S3.E2.m1.4.4.1.1.1.2"><csymbol cd="ambiguous" id="S3.E2.m1.4.4.1.1.1.2.1.cmml" xref="S3.E2.m1.4.4.1.1.1.2">superscript</csymbol><apply id="S3.E2.m1.4.4.1.1.1.2.2.cmml" xref="S3.E2.m1.4.4.1.1.1.2"><csymbol cd="ambiguous" id="S3.E2.m1.4.4.1.1.1.2.2.1.cmml" xref="S3.E2.m1.4.4.1.1.1.2">subscript</csymbol><sum id="S3.E2.m1.4.4.1.1.1.2.2.2.cmml" xref="S3.E2.m1.4.4.1.1.1.2.2.2"></sum><apply id="S3.E2.m1.4.4.1.1.1.2.2.3.cmml" xref="S3.E2.m1.4.4.1.1.1.2.2.3"><eq id="S3.E2.m1.4.4.1.1.1.2.2.3.1.cmml" xref="S3.E2.m1.4.4.1.1.1.2.2.3.1"></eq><ci id="S3.E2.m1.4.4.1.1.1.2.2.3.2.cmml" xref="S3.E2.m1.4.4.1.1.1.2.2.3.2">𝑖</ci><cn type="integer" id="S3.E2.m1.4.4.1.1.1.2.2.3.3.cmml" xref="S3.E2.m1.4.4.1.1.1.2.2.3.3">1</cn></apply></apply><ci id="S3.E2.m1.4.4.1.1.1.2.3.cmml" xref="S3.E2.m1.4.4.1.1.1.2.3">𝑁</ci></apply><apply id="S3.E2.m1.4.4.1.1.1.1.cmml" xref="S3.E2.m1.4.4.1.1.1.1"><times id="S3.E2.m1.4.4.1.1.1.1.2.cmml" xref="S3.E2.m1.4.4.1.1.1.1.2"></times><apply id="S3.E2.m1.2.2.cmml" xref="S3.E2.m1.2.2"><divide id="S3.E2.m1.2.2.3.cmml" xref="S3.E2.m1.2.2"></divide><apply id="S3.E2.m1.1.1.1.2.cmml" xref="S3.E2.m1.1.1.1.1"><abs id="S3.E2.m1.1.1.1.2.1.cmml" xref="S3.E2.m1.1.1.1.1.2"></abs><apply id="S3.E2.m1.1.1.1.1.1.cmml" xref="S3.E2.m1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E2.m1.1.1.1.1.1.1.cmml" xref="S3.E2.m1.1.1.1.1.1">superscript</csymbol><ci id="S3.E2.m1.1.1.1.1.1.2.cmml" xref="S3.E2.m1.1.1.1.1.1.2">𝒟</ci><ci id="S3.E2.m1.1.1.1.1.1.3.cmml" xref="S3.E2.m1.1.1.1.1.1.3">𝑖</ci></apply></apply><apply id="S3.E2.m1.2.2.2.2.cmml" xref="S3.E2.m1.2.2.2.3"><abs id="S3.E2.m1.2.2.2.2.1.cmml" xref="S3.E2.m1.2.2.2.3.1"></abs><ci id="S3.E2.m1.2.2.2.1.cmml" xref="S3.E2.m1.2.2.2.1">𝒟</ci></apply></apply><apply id="S3.E2.m1.4.4.1.1.1.1.3.cmml" xref="S3.E2.m1.4.4.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.E2.m1.4.4.1.1.1.1.3.1.cmml" xref="S3.E2.m1.4.4.1.1.1.1.3">subscript</csymbol><ci id="S3.E2.m1.4.4.1.1.1.1.3.2.cmml" xref="S3.E2.m1.4.4.1.1.1.1.3.2">𝐿</ci><ci id="S3.E2.m1.4.4.1.1.1.1.3.3.cmml" xref="S3.E2.m1.4.4.1.1.1.1.3.3">𝑖</ci></apply><apply id="S3.E2.m1.4.4.1.1.1.1.1.1.1.cmml" xref="S3.E2.m1.4.4.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E2.m1.4.4.1.1.1.1.1.1.1.1.cmml" xref="S3.E2.m1.4.4.1.1.1.1.1.1">subscript</csymbol><ci id="S3.E2.m1.4.4.1.1.1.1.1.1.1.2.cmml" xref="S3.E2.m1.4.4.1.1.1.1.1.1.1.2">𝑤</ci><ci id="S3.E2.m1.4.4.1.1.1.1.1.1.1.3.cmml" xref="S3.E2.m1.4.4.1.1.1.1.1.1.1.3">𝑖</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E2.m1.4c">\operatorname*{arg\,min}_{{W}}\mathcal{L}({W})=\sum_{i=1}^{N}\frac{|\mathcal{D}^{i}|}{|\mathcal{D}|}L_{i}(w_{i}),</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(2)</span></td>
</tr></tbody>
</table>
<p id="S3.SS1.p1.10" class="ltx_p">where <math id="S3.SS1.p1.10.m1.3" class="ltx_Math" alttext="W=\left\{w_{1},...,w_{N}\right\}" display="inline"><semantics id="S3.SS1.p1.10.m1.3a"><mrow id="S3.SS1.p1.10.m1.3.3" xref="S3.SS1.p1.10.m1.3.3.cmml"><mi id="S3.SS1.p1.10.m1.3.3.4" xref="S3.SS1.p1.10.m1.3.3.4.cmml">W</mi><mo id="S3.SS1.p1.10.m1.3.3.3" xref="S3.SS1.p1.10.m1.3.3.3.cmml">=</mo><mrow id="S3.SS1.p1.10.m1.3.3.2.2" xref="S3.SS1.p1.10.m1.3.3.2.3.cmml"><mo id="S3.SS1.p1.10.m1.3.3.2.2.3" xref="S3.SS1.p1.10.m1.3.3.2.3.cmml">{</mo><msub id="S3.SS1.p1.10.m1.2.2.1.1.1" xref="S3.SS1.p1.10.m1.2.2.1.1.1.cmml"><mi id="S3.SS1.p1.10.m1.2.2.1.1.1.2" xref="S3.SS1.p1.10.m1.2.2.1.1.1.2.cmml">w</mi><mn id="S3.SS1.p1.10.m1.2.2.1.1.1.3" xref="S3.SS1.p1.10.m1.2.2.1.1.1.3.cmml">1</mn></msub><mo id="S3.SS1.p1.10.m1.3.3.2.2.4" xref="S3.SS1.p1.10.m1.3.3.2.3.cmml">,</mo><mi mathvariant="normal" id="S3.SS1.p1.10.m1.1.1" xref="S3.SS1.p1.10.m1.1.1.cmml">…</mi><mo id="S3.SS1.p1.10.m1.3.3.2.2.5" xref="S3.SS1.p1.10.m1.3.3.2.3.cmml">,</mo><msub id="S3.SS1.p1.10.m1.3.3.2.2.2" xref="S3.SS1.p1.10.m1.3.3.2.2.2.cmml"><mi id="S3.SS1.p1.10.m1.3.3.2.2.2.2" xref="S3.SS1.p1.10.m1.3.3.2.2.2.2.cmml">w</mi><mi id="S3.SS1.p1.10.m1.3.3.2.2.2.3" xref="S3.SS1.p1.10.m1.3.3.2.2.2.3.cmml">N</mi></msub><mo id="S3.SS1.p1.10.m1.3.3.2.2.6" xref="S3.SS1.p1.10.m1.3.3.2.3.cmml">}</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS1.p1.10.m1.3b"><apply id="S3.SS1.p1.10.m1.3.3.cmml" xref="S3.SS1.p1.10.m1.3.3"><eq id="S3.SS1.p1.10.m1.3.3.3.cmml" xref="S3.SS1.p1.10.m1.3.3.3"></eq><ci id="S3.SS1.p1.10.m1.3.3.4.cmml" xref="S3.SS1.p1.10.m1.3.3.4">𝑊</ci><set id="S3.SS1.p1.10.m1.3.3.2.3.cmml" xref="S3.SS1.p1.10.m1.3.3.2.2"><apply id="S3.SS1.p1.10.m1.2.2.1.1.1.cmml" xref="S3.SS1.p1.10.m1.2.2.1.1.1"><csymbol cd="ambiguous" id="S3.SS1.p1.10.m1.2.2.1.1.1.1.cmml" xref="S3.SS1.p1.10.m1.2.2.1.1.1">subscript</csymbol><ci id="S3.SS1.p1.10.m1.2.2.1.1.1.2.cmml" xref="S3.SS1.p1.10.m1.2.2.1.1.1.2">𝑤</ci><cn type="integer" id="S3.SS1.p1.10.m1.2.2.1.1.1.3.cmml" xref="S3.SS1.p1.10.m1.2.2.1.1.1.3">1</cn></apply><ci id="S3.SS1.p1.10.m1.1.1.cmml" xref="S3.SS1.p1.10.m1.1.1">…</ci><apply id="S3.SS1.p1.10.m1.3.3.2.2.2.cmml" xref="S3.SS1.p1.10.m1.3.3.2.2.2"><csymbol cd="ambiguous" id="S3.SS1.p1.10.m1.3.3.2.2.2.1.cmml" xref="S3.SS1.p1.10.m1.3.3.2.2.2">subscript</csymbol><ci id="S3.SS1.p1.10.m1.3.3.2.2.2.2.cmml" xref="S3.SS1.p1.10.m1.3.3.2.2.2.2">𝑤</ci><ci id="S3.SS1.p1.10.m1.3.3.2.2.2.3.cmml" xref="S3.SS1.p1.10.m1.3.3.2.2.2.3">𝑁</ci></apply></set></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS1.p1.10.m1.3c">W=\left\{w_{1},...,w_{N}\right\}</annotation></semantics></math> is the personalized models set for all clients.</p>
</div>
</section>
<section id="S3.SS2" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.2 </span>Workflow of pFedPT</h3>

<div id="S3.SS2.p1" class="ltx_para">
<p id="S3.SS2.p1.1" class="ltx_p">We introduce a novel visual prompt based PFL framework for solving the PFL task, dubbed pFedPT. The central insight of the pFedPT is to train the learnable continuous visual prompts about data distribution for each client and use them to fine-tune backbones locally on those clients. Prompts on each client can serve as prior knowledge aiding the backbone to complete the training task. The pFedPT currently focuses on visual-related tasks, wherein each client maintains a prompt generator and a backbone, as shown in Fig. <a href="#S2.F2" title="Figure 2 ‣ 2 Related Work ‣ Visual Prompt Based Personalized Federated Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">2</span></a>. When performing image classification tasks, pFedPT first adds prompts generated by the local prompt generator to each image, which is then passed into the backbone for classification prediction. Generally, a complete pFedPT training process mainly includes four steps, as shown in Fig. <a href="#S2.F2" title="Figure 2 ‣ 2 Related Work ‣ Visual Prompt Based Personalized Federated Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">2</span></a>:</p>
<ul id="S3.I1" class="ltx_itemize">
<li id="S3.I1.i1" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="S3.I1.i1.p1" class="ltx_para">
<p id="S3.I1.i1.p1.1" class="ltx_p"><span id="S3.I1.i1.p1.1.1" class="ltx_text ltx_font_bold">Step 1.</span> To begin with, the parameters of the prompt generator on each client are updated with local data while the whole backbone is frozen.</p>
</div>
</li>
<li id="S3.I1.i2" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="S3.I1.i2.p1" class="ltx_para">
<p id="S3.I1.i2.p1.1" class="ltx_p"><span id="S3.I1.i2.p1.1.1" class="ltx_text ltx_font_bold">Step 2.</span> After training several epochs, the prompt generator will be frozen, and the backbone will begin to update for a fixed number of epochs.</p>
</div>
</li>
<li id="S3.I1.i3" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="S3.I1.i3.p1" class="ltx_para">
<p id="S3.I1.i3.p1.1" class="ltx_p"><span id="S3.I1.i3.p1.1.1" class="ltx_text ltx_font_bold">Step 3.</span> When the training process of all clients is finished, they send the trained backbone to the server, followed by the aggregation operation conducted by the server.</p>
</div>
</li>
<li id="S3.I1.i4" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="S3.I1.i4.p1" class="ltx_para">
<p id="S3.I1.i4.p1.1" class="ltx_p"><span id="S3.I1.i4.p1.1.1" class="ltx_text ltx_font_bold">Step 4.</span> The aggregated backbone will be broadcast to every client to replace the old backbone stored locally.</p>
</div>
</li>
</ul>
<p id="S3.SS2.p1.2" class="ltx_p">Repeat the <span id="S3.SS2.p1.2.1" class="ltx_text ltx_font_bold">Step 1</span>-<span id="S3.SS2.p1.2.2" class="ltx_text ltx_font_bold">Step 4</span>  until the training process of the prompt generator and backbone converges. At this point, the prompt generator generates prompts for each client based on local data distribution and can be seen as a guide to fine-tuning the prediction results of the backbone for the input images. Since the prompt is client-specific, the same backbone can generate different fine-tuning effects when used by different clients to achieve personalization.</p>
</div>
<div id="S3.SS2.p2" class="ltx_para">
<p id="S3.SS2.p2.2" class="ltx_p">Below, we specify the key components of pFedPT, i.e., prompt generator, which is parameterized with the parameter <math id="S3.SS2.p2.1.m1.1" class="ltx_Math" alttext="\delta" display="inline"><semantics id="S3.SS2.p2.1.m1.1a"><mi id="S3.SS2.p2.1.m1.1.1" xref="S3.SS2.p2.1.m1.1.1.cmml">δ</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p2.1.m1.1b"><ci id="S3.SS2.p2.1.m1.1.1.cmml" xref="S3.SS2.p2.1.m1.1.1">𝛿</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p2.1.m1.1c">\delta</annotation></semantics></math> for the prompt. The prompt is added to the input image to form a prompted image <math id="S3.SS2.p2.2.m2.1" class="ltx_Math" alttext="X_{i}+\delta_{i}" display="inline"><semantics id="S3.SS2.p2.2.m2.1a"><mrow id="S3.SS2.p2.2.m2.1.1" xref="S3.SS2.p2.2.m2.1.1.cmml"><msub id="S3.SS2.p2.2.m2.1.1.2" xref="S3.SS2.p2.2.m2.1.1.2.cmml"><mi id="S3.SS2.p2.2.m2.1.1.2.2" xref="S3.SS2.p2.2.m2.1.1.2.2.cmml">X</mi><mi id="S3.SS2.p2.2.m2.1.1.2.3" xref="S3.SS2.p2.2.m2.1.1.2.3.cmml">i</mi></msub><mo id="S3.SS2.p2.2.m2.1.1.1" xref="S3.SS2.p2.2.m2.1.1.1.cmml">+</mo><msub id="S3.SS2.p2.2.m2.1.1.3" xref="S3.SS2.p2.2.m2.1.1.3.cmml"><mi id="S3.SS2.p2.2.m2.1.1.3.2" xref="S3.SS2.p2.2.m2.1.1.3.2.cmml">δ</mi><mi id="S3.SS2.p2.2.m2.1.1.3.3" xref="S3.SS2.p2.2.m2.1.1.3.3.cmml">i</mi></msub></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p2.2.m2.1b"><apply id="S3.SS2.p2.2.m2.1.1.cmml" xref="S3.SS2.p2.2.m2.1.1"><plus id="S3.SS2.p2.2.m2.1.1.1.cmml" xref="S3.SS2.p2.2.m2.1.1.1"></plus><apply id="S3.SS2.p2.2.m2.1.1.2.cmml" xref="S3.SS2.p2.2.m2.1.1.2"><csymbol cd="ambiguous" id="S3.SS2.p2.2.m2.1.1.2.1.cmml" xref="S3.SS2.p2.2.m2.1.1.2">subscript</csymbol><ci id="S3.SS2.p2.2.m2.1.1.2.2.cmml" xref="S3.SS2.p2.2.m2.1.1.2.2">𝑋</ci><ci id="S3.SS2.p2.2.m2.1.1.2.3.cmml" xref="S3.SS2.p2.2.m2.1.1.2.3">𝑖</ci></apply><apply id="S3.SS2.p2.2.m2.1.1.3.cmml" xref="S3.SS2.p2.2.m2.1.1.3"><csymbol cd="ambiguous" id="S3.SS2.p2.2.m2.1.1.3.1.cmml" xref="S3.SS2.p2.2.m2.1.1.3">subscript</csymbol><ci id="S3.SS2.p2.2.m2.1.1.3.2.cmml" xref="S3.SS2.p2.2.m2.1.1.3.2">𝛿</ci><ci id="S3.SS2.p2.2.m2.1.1.3.3.cmml" xref="S3.SS2.p2.2.m2.1.1.3.3">𝑖</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p2.2.m2.1c">X_{i}+\delta_{i}</annotation></semantics></math>. During the local evaluation, the optimized prompt is added to all test images,</p>
<table id="S3.E3" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S3.E3.m1.2" class="ltx_Math" alttext="  \mathcal{X}_{i}=\left\{x_{i}^{1}+\delta_{i},\ldots,x_{i}^{n}+\delta_{i}\right\}." display="block"><semantics id="S3.E3.m1.2a"><mrow id="S3.E3.m1.2.2.1" xref="S3.E3.m1.2.2.1.1.cmml"><mrow id="S3.E3.m1.2.2.1.1" xref="S3.E3.m1.2.2.1.1.cmml"><mrow id="S3.E3.m1.2.2.1.1.4" xref="S3.E3.m1.2.2.1.1.4.cmml"><mi mathvariant="normal" id="S3.E3.m1.2.2.1.1.4.2" xref="S3.E3.m1.2.2.1.1.4.2.cmml"> </mi><mo lspace="0em" rspace="0em" id="S3.E3.m1.2.2.1.1.4.1" xref="S3.E3.m1.2.2.1.1.4.1.cmml">​</mo><mi mathvariant="normal" id="S3.E3.m1.2.2.1.1.4.3" xref="S3.E3.m1.2.2.1.1.4.3.cmml"> </mi><mo lspace="0em" rspace="0em" id="S3.E3.m1.2.2.1.1.4.1a" xref="S3.E3.m1.2.2.1.1.4.1.cmml">​</mo><msub id="S3.E3.m1.2.2.1.1.4.4" xref="S3.E3.m1.2.2.1.1.4.4.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.E3.m1.2.2.1.1.4.4.2" xref="S3.E3.m1.2.2.1.1.4.4.2.cmml">𝒳</mi><mi id="S3.E3.m1.2.2.1.1.4.4.3" xref="S3.E3.m1.2.2.1.1.4.4.3.cmml">i</mi></msub></mrow><mo id="S3.E3.m1.2.2.1.1.3" xref="S3.E3.m1.2.2.1.1.3.cmml">=</mo><mrow id="S3.E3.m1.2.2.1.1.2.2" xref="S3.E3.m1.2.2.1.1.2.3.cmml"><mo id="S3.E3.m1.2.2.1.1.2.2.3" xref="S3.E3.m1.2.2.1.1.2.3.cmml">{</mo><mrow id="S3.E3.m1.2.2.1.1.1.1.1" xref="S3.E3.m1.2.2.1.1.1.1.1.cmml"><msubsup id="S3.E3.m1.2.2.1.1.1.1.1.2" xref="S3.E3.m1.2.2.1.1.1.1.1.2.cmml"><mi id="S3.E3.m1.2.2.1.1.1.1.1.2.2.2" xref="S3.E3.m1.2.2.1.1.1.1.1.2.2.2.cmml">x</mi><mi id="S3.E3.m1.2.2.1.1.1.1.1.2.2.3" xref="S3.E3.m1.2.2.1.1.1.1.1.2.2.3.cmml">i</mi><mn id="S3.E3.m1.2.2.1.1.1.1.1.2.3" xref="S3.E3.m1.2.2.1.1.1.1.1.2.3.cmml">1</mn></msubsup><mo id="S3.E3.m1.2.2.1.1.1.1.1.1" xref="S3.E3.m1.2.2.1.1.1.1.1.1.cmml">+</mo><msub id="S3.E3.m1.2.2.1.1.1.1.1.3" xref="S3.E3.m1.2.2.1.1.1.1.1.3.cmml"><mi id="S3.E3.m1.2.2.1.1.1.1.1.3.2" xref="S3.E3.m1.2.2.1.1.1.1.1.3.2.cmml">δ</mi><mi id="S3.E3.m1.2.2.1.1.1.1.1.3.3" xref="S3.E3.m1.2.2.1.1.1.1.1.3.3.cmml">i</mi></msub></mrow><mo id="S3.E3.m1.2.2.1.1.2.2.4" xref="S3.E3.m1.2.2.1.1.2.3.cmml">,</mo><mi mathvariant="normal" id="S3.E3.m1.1.1" xref="S3.E3.m1.1.1.cmml">…</mi><mo id="S3.E3.m1.2.2.1.1.2.2.5" xref="S3.E3.m1.2.2.1.1.2.3.cmml">,</mo><mrow id="S3.E3.m1.2.2.1.1.2.2.2" xref="S3.E3.m1.2.2.1.1.2.2.2.cmml"><msubsup id="S3.E3.m1.2.2.1.1.2.2.2.2" xref="S3.E3.m1.2.2.1.1.2.2.2.2.cmml"><mi id="S3.E3.m1.2.2.1.1.2.2.2.2.2.2" xref="S3.E3.m1.2.2.1.1.2.2.2.2.2.2.cmml">x</mi><mi id="S3.E3.m1.2.2.1.1.2.2.2.2.2.3" xref="S3.E3.m1.2.2.1.1.2.2.2.2.2.3.cmml">i</mi><mi id="S3.E3.m1.2.2.1.1.2.2.2.2.3" xref="S3.E3.m1.2.2.1.1.2.2.2.2.3.cmml">n</mi></msubsup><mo id="S3.E3.m1.2.2.1.1.2.2.2.1" xref="S3.E3.m1.2.2.1.1.2.2.2.1.cmml">+</mo><msub id="S3.E3.m1.2.2.1.1.2.2.2.3" xref="S3.E3.m1.2.2.1.1.2.2.2.3.cmml"><mi id="S3.E3.m1.2.2.1.1.2.2.2.3.2" xref="S3.E3.m1.2.2.1.1.2.2.2.3.2.cmml">δ</mi><mi id="S3.E3.m1.2.2.1.1.2.2.2.3.3" xref="S3.E3.m1.2.2.1.1.2.2.2.3.3.cmml">i</mi></msub></mrow><mo id="S3.E3.m1.2.2.1.1.2.2.6" xref="S3.E3.m1.2.2.1.1.2.3.cmml">}</mo></mrow></mrow><mo lspace="0em" id="S3.E3.m1.2.2.1.2" xref="S3.E3.m1.2.2.1.1.cmml">.</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E3.m1.2b"><apply id="S3.E3.m1.2.2.1.1.cmml" xref="S3.E3.m1.2.2.1"><eq id="S3.E3.m1.2.2.1.1.3.cmml" xref="S3.E3.m1.2.2.1.1.3"></eq><apply id="S3.E3.m1.2.2.1.1.4.cmml" xref="S3.E3.m1.2.2.1.1.4"><times id="S3.E3.m1.2.2.1.1.4.1.cmml" xref="S3.E3.m1.2.2.1.1.4.1"></times><ci id="S3.E3.m1.2.2.1.1.4.2.cmml" xref="S3.E3.m1.2.2.1.1.4.2"> </ci><ci id="S3.E3.m1.2.2.1.1.4.3.cmml" xref="S3.E3.m1.2.2.1.1.4.3"> </ci><apply id="S3.E3.m1.2.2.1.1.4.4.cmml" xref="S3.E3.m1.2.2.1.1.4.4"><csymbol cd="ambiguous" id="S3.E3.m1.2.2.1.1.4.4.1.cmml" xref="S3.E3.m1.2.2.1.1.4.4">subscript</csymbol><ci id="S3.E3.m1.2.2.1.1.4.4.2.cmml" xref="S3.E3.m1.2.2.1.1.4.4.2">𝒳</ci><ci id="S3.E3.m1.2.2.1.1.4.4.3.cmml" xref="S3.E3.m1.2.2.1.1.4.4.3">𝑖</ci></apply></apply><set id="S3.E3.m1.2.2.1.1.2.3.cmml" xref="S3.E3.m1.2.2.1.1.2.2"><apply id="S3.E3.m1.2.2.1.1.1.1.1.cmml" xref="S3.E3.m1.2.2.1.1.1.1.1"><plus id="S3.E3.m1.2.2.1.1.1.1.1.1.cmml" xref="S3.E3.m1.2.2.1.1.1.1.1.1"></plus><apply id="S3.E3.m1.2.2.1.1.1.1.1.2.cmml" xref="S3.E3.m1.2.2.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.E3.m1.2.2.1.1.1.1.1.2.1.cmml" xref="S3.E3.m1.2.2.1.1.1.1.1.2">superscript</csymbol><apply id="S3.E3.m1.2.2.1.1.1.1.1.2.2.cmml" xref="S3.E3.m1.2.2.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.E3.m1.2.2.1.1.1.1.1.2.2.1.cmml" xref="S3.E3.m1.2.2.1.1.1.1.1.2">subscript</csymbol><ci id="S3.E3.m1.2.2.1.1.1.1.1.2.2.2.cmml" xref="S3.E3.m1.2.2.1.1.1.1.1.2.2.2">𝑥</ci><ci id="S3.E3.m1.2.2.1.1.1.1.1.2.2.3.cmml" xref="S3.E3.m1.2.2.1.1.1.1.1.2.2.3">𝑖</ci></apply><cn type="integer" id="S3.E3.m1.2.2.1.1.1.1.1.2.3.cmml" xref="S3.E3.m1.2.2.1.1.1.1.1.2.3">1</cn></apply><apply id="S3.E3.m1.2.2.1.1.1.1.1.3.cmml" xref="S3.E3.m1.2.2.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.E3.m1.2.2.1.1.1.1.1.3.1.cmml" xref="S3.E3.m1.2.2.1.1.1.1.1.3">subscript</csymbol><ci id="S3.E3.m1.2.2.1.1.1.1.1.3.2.cmml" xref="S3.E3.m1.2.2.1.1.1.1.1.3.2">𝛿</ci><ci id="S3.E3.m1.2.2.1.1.1.1.1.3.3.cmml" xref="S3.E3.m1.2.2.1.1.1.1.1.3.3">𝑖</ci></apply></apply><ci id="S3.E3.m1.1.1.cmml" xref="S3.E3.m1.1.1">…</ci><apply id="S3.E3.m1.2.2.1.1.2.2.2.cmml" xref="S3.E3.m1.2.2.1.1.2.2.2"><plus id="S3.E3.m1.2.2.1.1.2.2.2.1.cmml" xref="S3.E3.m1.2.2.1.1.2.2.2.1"></plus><apply id="S3.E3.m1.2.2.1.1.2.2.2.2.cmml" xref="S3.E3.m1.2.2.1.1.2.2.2.2"><csymbol cd="ambiguous" id="S3.E3.m1.2.2.1.1.2.2.2.2.1.cmml" xref="S3.E3.m1.2.2.1.1.2.2.2.2">superscript</csymbol><apply id="S3.E3.m1.2.2.1.1.2.2.2.2.2.cmml" xref="S3.E3.m1.2.2.1.1.2.2.2.2"><csymbol cd="ambiguous" id="S3.E3.m1.2.2.1.1.2.2.2.2.2.1.cmml" xref="S3.E3.m1.2.2.1.1.2.2.2.2">subscript</csymbol><ci id="S3.E3.m1.2.2.1.1.2.2.2.2.2.2.cmml" xref="S3.E3.m1.2.2.1.1.2.2.2.2.2.2">𝑥</ci><ci id="S3.E3.m1.2.2.1.1.2.2.2.2.2.3.cmml" xref="S3.E3.m1.2.2.1.1.2.2.2.2.2.3">𝑖</ci></apply><ci id="S3.E3.m1.2.2.1.1.2.2.2.2.3.cmml" xref="S3.E3.m1.2.2.1.1.2.2.2.2.3">𝑛</ci></apply><apply id="S3.E3.m1.2.2.1.1.2.2.2.3.cmml" xref="S3.E3.m1.2.2.1.1.2.2.2.3"><csymbol cd="ambiguous" id="S3.E3.m1.2.2.1.1.2.2.2.3.1.cmml" xref="S3.E3.m1.2.2.1.1.2.2.2.3">subscript</csymbol><ci id="S3.E3.m1.2.2.1.1.2.2.2.3.2.cmml" xref="S3.E3.m1.2.2.1.1.2.2.2.3.2">𝛿</ci><ci id="S3.E3.m1.2.2.1.1.2.2.2.3.3.cmml" xref="S3.E3.m1.2.2.1.1.2.2.2.3.3">𝑖</ci></apply></apply></set></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E3.m1.2c">  \mathcal{X}_{i}=\left\{x_{i}^{1}+\delta_{i},\ldots,x_{i}^{n}+\delta_{i}\right\}.</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(3)</span></td>
</tr></tbody>
</table>
<p id="S3.SS2.p2.8" class="ltx_p">There are several ways to design a visual prompt in terms of template and size. Following the settings of  <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib2" title="" class="ltx_ref">2</a>]</cite>, we explore three visual templates: pixel patch at a random location, pixel patch at a fixed location, and padding. We explore various prompt sizes <math id="S3.SS2.p2.3.m1.1" class="ltx_Math" alttext="p" display="inline"><semantics id="S3.SS2.p2.3.m1.1a"><mi id="S3.SS2.p2.3.m1.1.1" xref="S3.SS2.p2.3.m1.1.1.cmml">p</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.p2.3.m1.1b"><ci id="S3.SS2.p2.3.m1.1.1.cmml" xref="S3.SS2.p2.3.m1.1.1">𝑝</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p2.3.m1.1c">p</annotation></semantics></math>, where the actual number of parameters is <math id="S3.SS2.p2.4.m2.1" class="ltx_Math" alttext="Cp^{2}" display="inline"><semantics id="S3.SS2.p2.4.m2.1a"><mrow id="S3.SS2.p2.4.m2.1.1" xref="S3.SS2.p2.4.m2.1.1.cmml"><mi id="S3.SS2.p2.4.m2.1.1.2" xref="S3.SS2.p2.4.m2.1.1.2.cmml">C</mi><mo lspace="0em" rspace="0em" id="S3.SS2.p2.4.m2.1.1.1" xref="S3.SS2.p2.4.m2.1.1.1.cmml">​</mo><msup id="S3.SS2.p2.4.m2.1.1.3" xref="S3.SS2.p2.4.m2.1.1.3.cmml"><mi id="S3.SS2.p2.4.m2.1.1.3.2" xref="S3.SS2.p2.4.m2.1.1.3.2.cmml">p</mi><mn id="S3.SS2.p2.4.m2.1.1.3.3" xref="S3.SS2.p2.4.m2.1.1.3.3.cmml">2</mn></msup></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p2.4.m2.1b"><apply id="S3.SS2.p2.4.m2.1.1.cmml" xref="S3.SS2.p2.4.m2.1.1"><times id="S3.SS2.p2.4.m2.1.1.1.cmml" xref="S3.SS2.p2.4.m2.1.1.1"></times><ci id="S3.SS2.p2.4.m2.1.1.2.cmml" xref="S3.SS2.p2.4.m2.1.1.2">𝐶</ci><apply id="S3.SS2.p2.4.m2.1.1.3.cmml" xref="S3.SS2.p2.4.m2.1.1.3"><csymbol cd="ambiguous" id="S3.SS2.p2.4.m2.1.1.3.1.cmml" xref="S3.SS2.p2.4.m2.1.1.3">superscript</csymbol><ci id="S3.SS2.p2.4.m2.1.1.3.2.cmml" xref="S3.SS2.p2.4.m2.1.1.3.2">𝑝</ci><cn type="integer" id="S3.SS2.p2.4.m2.1.1.3.3.cmml" xref="S3.SS2.p2.4.m2.1.1.3.3">2</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p2.4.m2.1c">Cp^{2}</annotation></semantics></math> for patches and <math id="S3.SS2.p2.5.m3.1" class="ltx_Math" alttext="2Cp(H+W-2p)" display="inline"><semantics id="S3.SS2.p2.5.m3.1a"><mrow id="S3.SS2.p2.5.m3.1.1" xref="S3.SS2.p2.5.m3.1.1.cmml"><mn id="S3.SS2.p2.5.m3.1.1.3" xref="S3.SS2.p2.5.m3.1.1.3.cmml">2</mn><mo lspace="0em" rspace="0em" id="S3.SS2.p2.5.m3.1.1.2" xref="S3.SS2.p2.5.m3.1.1.2.cmml">​</mo><mi id="S3.SS2.p2.5.m3.1.1.4" xref="S3.SS2.p2.5.m3.1.1.4.cmml">C</mi><mo lspace="0em" rspace="0em" id="S3.SS2.p2.5.m3.1.1.2a" xref="S3.SS2.p2.5.m3.1.1.2.cmml">​</mo><mi id="S3.SS2.p2.5.m3.1.1.5" xref="S3.SS2.p2.5.m3.1.1.5.cmml">p</mi><mo lspace="0em" rspace="0em" id="S3.SS2.p2.5.m3.1.1.2b" xref="S3.SS2.p2.5.m3.1.1.2.cmml">​</mo><mrow id="S3.SS2.p2.5.m3.1.1.1.1" xref="S3.SS2.p2.5.m3.1.1.1.1.1.cmml"><mo stretchy="false" id="S3.SS2.p2.5.m3.1.1.1.1.2" xref="S3.SS2.p2.5.m3.1.1.1.1.1.cmml">(</mo><mrow id="S3.SS2.p2.5.m3.1.1.1.1.1" xref="S3.SS2.p2.5.m3.1.1.1.1.1.cmml"><mrow id="S3.SS2.p2.5.m3.1.1.1.1.1.2" xref="S3.SS2.p2.5.m3.1.1.1.1.1.2.cmml"><mi id="S3.SS2.p2.5.m3.1.1.1.1.1.2.2" xref="S3.SS2.p2.5.m3.1.1.1.1.1.2.2.cmml">H</mi><mo id="S3.SS2.p2.5.m3.1.1.1.1.1.2.1" xref="S3.SS2.p2.5.m3.1.1.1.1.1.2.1.cmml">+</mo><mi id="S3.SS2.p2.5.m3.1.1.1.1.1.2.3" xref="S3.SS2.p2.5.m3.1.1.1.1.1.2.3.cmml">W</mi></mrow><mo id="S3.SS2.p2.5.m3.1.1.1.1.1.1" xref="S3.SS2.p2.5.m3.1.1.1.1.1.1.cmml">−</mo><mrow id="S3.SS2.p2.5.m3.1.1.1.1.1.3" xref="S3.SS2.p2.5.m3.1.1.1.1.1.3.cmml"><mn id="S3.SS2.p2.5.m3.1.1.1.1.1.3.2" xref="S3.SS2.p2.5.m3.1.1.1.1.1.3.2.cmml">2</mn><mo lspace="0em" rspace="0em" id="S3.SS2.p2.5.m3.1.1.1.1.1.3.1" xref="S3.SS2.p2.5.m3.1.1.1.1.1.3.1.cmml">​</mo><mi id="S3.SS2.p2.5.m3.1.1.1.1.1.3.3" xref="S3.SS2.p2.5.m3.1.1.1.1.1.3.3.cmml">p</mi></mrow></mrow><mo stretchy="false" id="S3.SS2.p2.5.m3.1.1.1.1.3" xref="S3.SS2.p2.5.m3.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p2.5.m3.1b"><apply id="S3.SS2.p2.5.m3.1.1.cmml" xref="S3.SS2.p2.5.m3.1.1"><times id="S3.SS2.p2.5.m3.1.1.2.cmml" xref="S3.SS2.p2.5.m3.1.1.2"></times><cn type="integer" id="S3.SS2.p2.5.m3.1.1.3.cmml" xref="S3.SS2.p2.5.m3.1.1.3">2</cn><ci id="S3.SS2.p2.5.m3.1.1.4.cmml" xref="S3.SS2.p2.5.m3.1.1.4">𝐶</ci><ci id="S3.SS2.p2.5.m3.1.1.5.cmml" xref="S3.SS2.p2.5.m3.1.1.5">𝑝</ci><apply id="S3.SS2.p2.5.m3.1.1.1.1.1.cmml" xref="S3.SS2.p2.5.m3.1.1.1.1"><minus id="S3.SS2.p2.5.m3.1.1.1.1.1.1.cmml" xref="S3.SS2.p2.5.m3.1.1.1.1.1.1"></minus><apply id="S3.SS2.p2.5.m3.1.1.1.1.1.2.cmml" xref="S3.SS2.p2.5.m3.1.1.1.1.1.2"><plus id="S3.SS2.p2.5.m3.1.1.1.1.1.2.1.cmml" xref="S3.SS2.p2.5.m3.1.1.1.1.1.2.1"></plus><ci id="S3.SS2.p2.5.m3.1.1.1.1.1.2.2.cmml" xref="S3.SS2.p2.5.m3.1.1.1.1.1.2.2">𝐻</ci><ci id="S3.SS2.p2.5.m3.1.1.1.1.1.2.3.cmml" xref="S3.SS2.p2.5.m3.1.1.1.1.1.2.3">𝑊</ci></apply><apply id="S3.SS2.p2.5.m3.1.1.1.1.1.3.cmml" xref="S3.SS2.p2.5.m3.1.1.1.1.1.3"><times id="S3.SS2.p2.5.m3.1.1.1.1.1.3.1.cmml" xref="S3.SS2.p2.5.m3.1.1.1.1.1.3.1"></times><cn type="integer" id="S3.SS2.p2.5.m3.1.1.1.1.1.3.2.cmml" xref="S3.SS2.p2.5.m3.1.1.1.1.1.3.2">2</cn><ci id="S3.SS2.p2.5.m3.1.1.1.1.1.3.3.cmml" xref="S3.SS2.p2.5.m3.1.1.1.1.1.3.3">𝑝</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p2.5.m3.1c">2Cp(H+W-2p)</annotation></semantics></math> for padding, where <math id="S3.SS2.p2.6.m4.3" class="ltx_Math" alttext="C,H,W" display="inline"><semantics id="S3.SS2.p2.6.m4.3a"><mrow id="S3.SS2.p2.6.m4.3.4.2" xref="S3.SS2.p2.6.m4.3.4.1.cmml"><mi id="S3.SS2.p2.6.m4.1.1" xref="S3.SS2.p2.6.m4.1.1.cmml">C</mi><mo id="S3.SS2.p2.6.m4.3.4.2.1" xref="S3.SS2.p2.6.m4.3.4.1.cmml">,</mo><mi id="S3.SS2.p2.6.m4.2.2" xref="S3.SS2.p2.6.m4.2.2.cmml">H</mi><mo id="S3.SS2.p2.6.m4.3.4.2.2" xref="S3.SS2.p2.6.m4.3.4.1.cmml">,</mo><mi id="S3.SS2.p2.6.m4.3.3" xref="S3.SS2.p2.6.m4.3.3.cmml">W</mi></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p2.6.m4.3b"><list id="S3.SS2.p2.6.m4.3.4.1.cmml" xref="S3.SS2.p2.6.m4.3.4.2"><ci id="S3.SS2.p2.6.m4.1.1.cmml" xref="S3.SS2.p2.6.m4.1.1">𝐶</ci><ci id="S3.SS2.p2.6.m4.2.2.cmml" xref="S3.SS2.p2.6.m4.2.2">𝐻</ci><ci id="S3.SS2.p2.6.m4.3.3.cmml" xref="S3.SS2.p2.6.m4.3.3">𝑊</ci></list></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p2.6.m4.3c">C,H,W</annotation></semantics></math> are the image channels, height, and width, respectively. In order to explore the effect of different prompts on the results, we conducted an experiment on CIFAR10 dataset with a Dirichlet (<math id="S3.SS2.p2.7.m5.1" class="ltx_Math" alttext="0.3" display="inline"><semantics id="S3.SS2.p2.7.m5.1a"><mn id="S3.SS2.p2.7.m5.1.1" xref="S3.SS2.p2.7.m5.1.1.cmml">0.3</mn><annotation-xml encoding="MathML-Content" id="S3.SS2.p2.7.m5.1b"><cn type="float" id="S3.SS2.p2.7.m5.1.1.cmml" xref="S3.SS2.p2.7.m5.1.1">0.3</cn></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p2.7.m5.1c">0.3</annotation></semantics></math>) partition. Fig. <a href="#S4.F6" title="Figure 6 ‣ The guidance information contained in the prompts. ‣ 4.3 Exploratory Study ‣ 4 Experiments ‣ Visual Prompt Based Personalized Federated Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">6</span></a> shows that padding prompts with <math id="S3.SS2.p2.8.m6.1" class="ltx_Math" alttext="p=4" display="inline"><semantics id="S3.SS2.p2.8.m6.1a"><mrow id="S3.SS2.p2.8.m6.1.1" xref="S3.SS2.p2.8.m6.1.1.cmml"><mi id="S3.SS2.p2.8.m6.1.1.2" xref="S3.SS2.p2.8.m6.1.1.2.cmml">p</mi><mo id="S3.SS2.p2.8.m6.1.1.1" xref="S3.SS2.p2.8.m6.1.1.1.cmml">=</mo><mn id="S3.SS2.p2.8.m6.1.1.3" xref="S3.SS2.p2.8.m6.1.1.3.cmml">4</mn></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.p2.8.m6.1b"><apply id="S3.SS2.p2.8.m6.1.1.cmml" xref="S3.SS2.p2.8.m6.1.1"><eq id="S3.SS2.p2.8.m6.1.1.1.cmml" xref="S3.SS2.p2.8.m6.1.1.1"></eq><ci id="S3.SS2.p2.8.m6.1.1.2.cmml" xref="S3.SS2.p2.8.m6.1.1.2">𝑝</ci><cn type="integer" id="S3.SS2.p2.8.m6.1.1.3.cmml" xref="S3.SS2.p2.8.m6.1.1.3">4</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.p2.8.m6.1c">p=4</annotation></semantics></math> size achieve the best performance over other design choices. We use this as the default for all our experiments.</p>
</div>
</section>
<section id="S3.SS3" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.3 </span>Modeling for pFedPT</h3>

<div id="S3.SS3.p1" class="ltx_para">
<p id="S3.SS3.p1.3" class="ltx_p">Our goal is to learn a personalized prompt <math id="S3.SS3.p1.1.m1.1" class="ltx_Math" alttext="\delta_{i}" display="inline"><semantics id="S3.SS3.p1.1.m1.1a"><msub id="S3.SS3.p1.1.m1.1.1" xref="S3.SS3.p1.1.m1.1.1.cmml"><mi id="S3.SS3.p1.1.m1.1.1.2" xref="S3.SS3.p1.1.m1.1.1.2.cmml">δ</mi><mi id="S3.SS3.p1.1.m1.1.1.3" xref="S3.SS3.p1.1.m1.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS3.p1.1.m1.1b"><apply id="S3.SS3.p1.1.m1.1.1.cmml" xref="S3.SS3.p1.1.m1.1.1"><csymbol cd="ambiguous" id="S3.SS3.p1.1.m1.1.1.1.cmml" xref="S3.SS3.p1.1.m1.1.1">subscript</csymbol><ci id="S3.SS3.p1.1.m1.1.1.2.cmml" xref="S3.SS3.p1.1.m1.1.1.2">𝛿</ci><ci id="S3.SS3.p1.1.m1.1.1.3.cmml" xref="S3.SS3.p1.1.m1.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p1.1.m1.1c">\delta_{i}</annotation></semantics></math> for each client and a backbone <math id="S3.SS3.p1.2.m2.1" class="ltx_Math" alttext="w" display="inline"><semantics id="S3.SS3.p1.2.m2.1a"><mi id="S3.SS3.p1.2.m2.1.1" xref="S3.SS3.p1.2.m2.1.1.cmml">w</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.p1.2.m2.1b"><ci id="S3.SS3.p1.2.m2.1.1.cmml" xref="S3.SS3.p1.2.m2.1.1">𝑤</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p1.2.m2.1c">w</annotation></semantics></math>. The prompt <math id="S3.SS3.p1.3.m3.1" class="ltx_Math" alttext="\delta_{i}" display="inline"><semantics id="S3.SS3.p1.3.m3.1a"><msub id="S3.SS3.p1.3.m3.1.1" xref="S3.SS3.p1.3.m3.1.1.cmml"><mi id="S3.SS3.p1.3.m3.1.1.2" xref="S3.SS3.p1.3.m3.1.1.2.cmml">δ</mi><mi id="S3.SS3.p1.3.m3.1.1.3" xref="S3.SS3.p1.3.m3.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS3.p1.3.m3.1b"><apply id="S3.SS3.p1.3.m3.1.1.cmml" xref="S3.SS3.p1.3.m3.1.1"><csymbol cd="ambiguous" id="S3.SS3.p1.3.m3.1.1.1.cmml" xref="S3.SS3.p1.3.m3.1.1">subscript</csymbol><ci id="S3.SS3.p1.3.m3.1.1.2.cmml" xref="S3.SS3.p1.3.m3.1.1.2">𝛿</ci><ci id="S3.SS3.p1.3.m3.1.1.3.cmml" xref="S3.SS3.p1.3.m3.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p1.3.m3.1c">\delta_{i}</annotation></semantics></math> is also trained by the local data. Our objective is to solve the following:</p>
<table id="S3.E4" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S3.E4.m1.9" class="ltx_Math" alttext="  \operatorname*{arg\,min}_{w,\delta_{i}}\mathcal{L}(w,\delta_{i})=\sum_{i=1}^{N}\frac{|\mathcal{D}^{i}|}{|\mathcal{D}|}L_{i}(w,\delta_{i}),  " display="block"><semantics id="S3.E4.m1.9a"><mrow id="S3.E4.m1.9.9" xref="S3.E4.m1.9.9.cmml"><mrow id="S3.E4.m1.7.7.1" xref="S3.E4.m1.7.7.1.cmml"><mi mathvariant="normal" id="S3.E4.m1.7.7.1.3" xref="S3.E4.m1.7.7.1.3.cmml"> </mi><mo lspace="0em" rspace="0em" id="S3.E4.m1.7.7.1.2" xref="S3.E4.m1.7.7.1.2.cmml">​</mo><mi mathvariant="normal" id="S3.E4.m1.7.7.1.4" xref="S3.E4.m1.7.7.1.4.cmml"> </mi><mo lspace="0em" rspace="0em" id="S3.E4.m1.7.7.1.2a" xref="S3.E4.m1.7.7.1.2.cmml">​</mo><mrow id="S3.E4.m1.7.7.1.5" xref="S3.E4.m1.7.7.1.5.cmml"><munder id="S3.E4.m1.7.7.1.5.1" xref="S3.E4.m1.7.7.1.5.1.cmml"><mrow id="S3.E4.m1.7.7.1.5.1.2" xref="S3.E4.m1.7.7.1.5.1.2.cmml"><mi id="S3.E4.m1.7.7.1.5.1.2.2" xref="S3.E4.m1.7.7.1.5.1.2.2.cmml">arg</mi><mo lspace="0.170em" rspace="0em" id="S3.E4.m1.7.7.1.5.1.2.1" xref="S3.E4.m1.7.7.1.5.1.2.1.cmml">​</mo><mi id="S3.E4.m1.7.7.1.5.1.2.3" xref="S3.E4.m1.7.7.1.5.1.2.3.cmml">min</mi></mrow><mrow id="S3.E4.m1.2.2.2.2" xref="S3.E4.m1.2.2.2.3.cmml"><mi id="S3.E4.m1.1.1.1.1" xref="S3.E4.m1.1.1.1.1.cmml">w</mi><mo id="S3.E4.m1.2.2.2.2.2" xref="S3.E4.m1.2.2.2.3.cmml">,</mo><msub id="S3.E4.m1.2.2.2.2.1" xref="S3.E4.m1.2.2.2.2.1.cmml"><mi id="S3.E4.m1.2.2.2.2.1.2" xref="S3.E4.m1.2.2.2.2.1.2.cmml">δ</mi><mi id="S3.E4.m1.2.2.2.2.1.3" xref="S3.E4.m1.2.2.2.2.1.3.cmml">i</mi></msub></mrow></munder><mo id="S3.E4.m1.7.7.1.5a" xref="S3.E4.m1.7.7.1.5.cmml">⁡</mo><mi class="ltx_font_mathcaligraphic" id="S3.E4.m1.7.7.1.5.2" xref="S3.E4.m1.7.7.1.5.2.cmml">ℒ</mi></mrow><mo lspace="0em" rspace="0em" id="S3.E4.m1.7.7.1.2b" xref="S3.E4.m1.7.7.1.2.cmml">​</mo><mrow id="S3.E4.m1.7.7.1.1.1" xref="S3.E4.m1.7.7.1.1.2.cmml"><mo stretchy="false" id="S3.E4.m1.7.7.1.1.1.2" xref="S3.E4.m1.7.7.1.1.2.cmml">(</mo><mi id="S3.E4.m1.5.5" xref="S3.E4.m1.5.5.cmml">w</mi><mo id="S3.E4.m1.7.7.1.1.1.3" xref="S3.E4.m1.7.7.1.1.2.cmml">,</mo><msub id="S3.E4.m1.7.7.1.1.1.1" xref="S3.E4.m1.7.7.1.1.1.1.cmml"><mi id="S3.E4.m1.7.7.1.1.1.1.2" xref="S3.E4.m1.7.7.1.1.1.1.2.cmml">δ</mi><mi id="S3.E4.m1.7.7.1.1.1.1.3" xref="S3.E4.m1.7.7.1.1.1.1.3.cmml">i</mi></msub><mo stretchy="false" id="S3.E4.m1.7.7.1.1.1.4" xref="S3.E4.m1.7.7.1.1.2.cmml">)</mo></mrow></mrow><mo rspace="0.111em" id="S3.E4.m1.9.9.4" xref="S3.E4.m1.9.9.4.cmml">=</mo><mrow id="S3.E4.m1.9.9.3.2" xref="S3.E4.m1.9.9.3.3.cmml"><mrow id="S3.E4.m1.8.8.2.1.1" xref="S3.E4.m1.8.8.2.1.1.cmml"><munderover id="S3.E4.m1.8.8.2.1.1.2" xref="S3.E4.m1.8.8.2.1.1.2.cmml"><mo movablelimits="false" id="S3.E4.m1.8.8.2.1.1.2.2.2" xref="S3.E4.m1.8.8.2.1.1.2.2.2.cmml">∑</mo><mrow id="S3.E4.m1.8.8.2.1.1.2.2.3" xref="S3.E4.m1.8.8.2.1.1.2.2.3.cmml"><mi id="S3.E4.m1.8.8.2.1.1.2.2.3.2" xref="S3.E4.m1.8.8.2.1.1.2.2.3.2.cmml">i</mi><mo id="S3.E4.m1.8.8.2.1.1.2.2.3.1" xref="S3.E4.m1.8.8.2.1.1.2.2.3.1.cmml">=</mo><mn id="S3.E4.m1.8.8.2.1.1.2.2.3.3" xref="S3.E4.m1.8.8.2.1.1.2.2.3.3.cmml">1</mn></mrow><mi id="S3.E4.m1.8.8.2.1.1.2.3" xref="S3.E4.m1.8.8.2.1.1.2.3.cmml">N</mi></munderover><mrow id="S3.E4.m1.8.8.2.1.1.1" xref="S3.E4.m1.8.8.2.1.1.1.cmml"><mfrac id="S3.E4.m1.4.4" xref="S3.E4.m1.4.4.cmml"><mrow id="S3.E4.m1.3.3.1.1" xref="S3.E4.m1.3.3.1.2.cmml"><mo stretchy="false" id="S3.E4.m1.3.3.1.1.2" xref="S3.E4.m1.3.3.1.2.1.cmml">|</mo><msup id="S3.E4.m1.3.3.1.1.1" xref="S3.E4.m1.3.3.1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.E4.m1.3.3.1.1.1.2" xref="S3.E4.m1.3.3.1.1.1.2.cmml">𝒟</mi><mi id="S3.E4.m1.3.3.1.1.1.3" xref="S3.E4.m1.3.3.1.1.1.3.cmml">i</mi></msup><mo stretchy="false" id="S3.E4.m1.3.3.1.1.3" xref="S3.E4.m1.3.3.1.2.1.cmml">|</mo></mrow><mrow id="S3.E4.m1.4.4.2.3" xref="S3.E4.m1.4.4.2.2.cmml"><mo stretchy="false" id="S3.E4.m1.4.4.2.3.1" xref="S3.E4.m1.4.4.2.2.1.cmml">|</mo><mi class="ltx_font_mathcaligraphic" id="S3.E4.m1.4.4.2.1" xref="S3.E4.m1.4.4.2.1.cmml">𝒟</mi><mo stretchy="false" id="S3.E4.m1.4.4.2.3.2" xref="S3.E4.m1.4.4.2.2.1.cmml">|</mo></mrow></mfrac><mo lspace="0em" rspace="0em" id="S3.E4.m1.8.8.2.1.1.1.2" xref="S3.E4.m1.8.8.2.1.1.1.2.cmml">​</mo><msub id="S3.E4.m1.8.8.2.1.1.1.3" xref="S3.E4.m1.8.8.2.1.1.1.3.cmml"><mi id="S3.E4.m1.8.8.2.1.1.1.3.2" xref="S3.E4.m1.8.8.2.1.1.1.3.2.cmml">L</mi><mi id="S3.E4.m1.8.8.2.1.1.1.3.3" xref="S3.E4.m1.8.8.2.1.1.1.3.3.cmml">i</mi></msub><mo lspace="0em" rspace="0em" id="S3.E4.m1.8.8.2.1.1.1.2a" xref="S3.E4.m1.8.8.2.1.1.1.2.cmml">​</mo><mrow id="S3.E4.m1.8.8.2.1.1.1.1.1" xref="S3.E4.m1.8.8.2.1.1.1.1.2.cmml"><mo stretchy="false" id="S3.E4.m1.8.8.2.1.1.1.1.1.2" xref="S3.E4.m1.8.8.2.1.1.1.1.2.cmml">(</mo><mi id="S3.E4.m1.6.6" xref="S3.E4.m1.6.6.cmml">w</mi><mo id="S3.E4.m1.8.8.2.1.1.1.1.1.3" xref="S3.E4.m1.8.8.2.1.1.1.1.2.cmml">,</mo><msub id="S3.E4.m1.8.8.2.1.1.1.1.1.1" xref="S3.E4.m1.8.8.2.1.1.1.1.1.1.cmml"><mi id="S3.E4.m1.8.8.2.1.1.1.1.1.1.2" xref="S3.E4.m1.8.8.2.1.1.1.1.1.1.2.cmml">δ</mi><mi id="S3.E4.m1.8.8.2.1.1.1.1.1.1.3" xref="S3.E4.m1.8.8.2.1.1.1.1.1.1.3.cmml">i</mi></msub><mo stretchy="false" id="S3.E4.m1.8.8.2.1.1.1.1.1.4" xref="S3.E4.m1.8.8.2.1.1.1.1.2.cmml">)</mo></mrow></mrow></mrow><mo id="S3.E4.m1.9.9.3.2.3" xref="S3.E4.m1.9.9.3.3.cmml">,</mo><mrow id="S3.E4.m1.9.9.3.2.2" xref="S3.E4.m1.9.9.3.2.2.cmml"><mi mathvariant="normal" id="S3.E4.m1.9.9.3.2.2.2" xref="S3.E4.m1.9.9.3.2.2.2.cmml"> </mi><mo lspace="0em" rspace="0em" id="S3.E4.m1.9.9.3.2.2.1" xref="S3.E4.m1.9.9.3.2.2.1.cmml">​</mo><mi mathvariant="normal" id="S3.E4.m1.9.9.3.2.2.3" xref="S3.E4.m1.9.9.3.2.2.3.cmml"> </mi></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.E4.m1.9b"><apply id="S3.E4.m1.9.9.cmml" xref="S3.E4.m1.9.9"><eq id="S3.E4.m1.9.9.4.cmml" xref="S3.E4.m1.9.9.4"></eq><apply id="S3.E4.m1.7.7.1.cmml" xref="S3.E4.m1.7.7.1"><times id="S3.E4.m1.7.7.1.2.cmml" xref="S3.E4.m1.7.7.1.2"></times><ci id="S3.E4.m1.7.7.1.3.cmml" xref="S3.E4.m1.7.7.1.3"> </ci><ci id="S3.E4.m1.7.7.1.4.cmml" xref="S3.E4.m1.7.7.1.4"> </ci><apply id="S3.E4.m1.7.7.1.5.cmml" xref="S3.E4.m1.7.7.1.5"><apply id="S3.E4.m1.7.7.1.5.1.cmml" xref="S3.E4.m1.7.7.1.5.1"><csymbol cd="ambiguous" id="S3.E4.m1.7.7.1.5.1.1.cmml" xref="S3.E4.m1.7.7.1.5.1">subscript</csymbol><apply id="S3.E4.m1.7.7.1.5.1.2.cmml" xref="S3.E4.m1.7.7.1.5.1.2"><times id="S3.E4.m1.7.7.1.5.1.2.1.cmml" xref="S3.E4.m1.7.7.1.5.1.2.1"></times><ci id="S3.E4.m1.7.7.1.5.1.2.2.cmml" xref="S3.E4.m1.7.7.1.5.1.2.2">arg</ci><ci id="S3.E4.m1.7.7.1.5.1.2.3.cmml" xref="S3.E4.m1.7.7.1.5.1.2.3">min</ci></apply><list id="S3.E4.m1.2.2.2.3.cmml" xref="S3.E4.m1.2.2.2.2"><ci id="S3.E4.m1.1.1.1.1.cmml" xref="S3.E4.m1.1.1.1.1">𝑤</ci><apply id="S3.E4.m1.2.2.2.2.1.cmml" xref="S3.E4.m1.2.2.2.2.1"><csymbol cd="ambiguous" id="S3.E4.m1.2.2.2.2.1.1.cmml" xref="S3.E4.m1.2.2.2.2.1">subscript</csymbol><ci id="S3.E4.m1.2.2.2.2.1.2.cmml" xref="S3.E4.m1.2.2.2.2.1.2">𝛿</ci><ci id="S3.E4.m1.2.2.2.2.1.3.cmml" xref="S3.E4.m1.2.2.2.2.1.3">𝑖</ci></apply></list></apply><ci id="S3.E4.m1.7.7.1.5.2.cmml" xref="S3.E4.m1.7.7.1.5.2">ℒ</ci></apply><interval closure="open" id="S3.E4.m1.7.7.1.1.2.cmml" xref="S3.E4.m1.7.7.1.1.1"><ci id="S3.E4.m1.5.5.cmml" xref="S3.E4.m1.5.5">𝑤</ci><apply id="S3.E4.m1.7.7.1.1.1.1.cmml" xref="S3.E4.m1.7.7.1.1.1.1"><csymbol cd="ambiguous" id="S3.E4.m1.7.7.1.1.1.1.1.cmml" xref="S3.E4.m1.7.7.1.1.1.1">subscript</csymbol><ci id="S3.E4.m1.7.7.1.1.1.1.2.cmml" xref="S3.E4.m1.7.7.1.1.1.1.2">𝛿</ci><ci id="S3.E4.m1.7.7.1.1.1.1.3.cmml" xref="S3.E4.m1.7.7.1.1.1.1.3">𝑖</ci></apply></interval></apply><list id="S3.E4.m1.9.9.3.3.cmml" xref="S3.E4.m1.9.9.3.2"><apply id="S3.E4.m1.8.8.2.1.1.cmml" xref="S3.E4.m1.8.8.2.1.1"><apply id="S3.E4.m1.8.8.2.1.1.2.cmml" xref="S3.E4.m1.8.8.2.1.1.2"><csymbol cd="ambiguous" id="S3.E4.m1.8.8.2.1.1.2.1.cmml" xref="S3.E4.m1.8.8.2.1.1.2">superscript</csymbol><apply id="S3.E4.m1.8.8.2.1.1.2.2.cmml" xref="S3.E4.m1.8.8.2.1.1.2"><csymbol cd="ambiguous" id="S3.E4.m1.8.8.2.1.1.2.2.1.cmml" xref="S3.E4.m1.8.8.2.1.1.2">subscript</csymbol><sum id="S3.E4.m1.8.8.2.1.1.2.2.2.cmml" xref="S3.E4.m1.8.8.2.1.1.2.2.2"></sum><apply id="S3.E4.m1.8.8.2.1.1.2.2.3.cmml" xref="S3.E4.m1.8.8.2.1.1.2.2.3"><eq id="S3.E4.m1.8.8.2.1.1.2.2.3.1.cmml" xref="S3.E4.m1.8.8.2.1.1.2.2.3.1"></eq><ci id="S3.E4.m1.8.8.2.1.1.2.2.3.2.cmml" xref="S3.E4.m1.8.8.2.1.1.2.2.3.2">𝑖</ci><cn type="integer" id="S3.E4.m1.8.8.2.1.1.2.2.3.3.cmml" xref="S3.E4.m1.8.8.2.1.1.2.2.3.3">1</cn></apply></apply><ci id="S3.E4.m1.8.8.2.1.1.2.3.cmml" xref="S3.E4.m1.8.8.2.1.1.2.3">𝑁</ci></apply><apply id="S3.E4.m1.8.8.2.1.1.1.cmml" xref="S3.E4.m1.8.8.2.1.1.1"><times id="S3.E4.m1.8.8.2.1.1.1.2.cmml" xref="S3.E4.m1.8.8.2.1.1.1.2"></times><apply id="S3.E4.m1.4.4.cmml" xref="S3.E4.m1.4.4"><divide id="S3.E4.m1.4.4.3.cmml" xref="S3.E4.m1.4.4"></divide><apply id="S3.E4.m1.3.3.1.2.cmml" xref="S3.E4.m1.3.3.1.1"><abs id="S3.E4.m1.3.3.1.2.1.cmml" xref="S3.E4.m1.3.3.1.1.2"></abs><apply id="S3.E4.m1.3.3.1.1.1.cmml" xref="S3.E4.m1.3.3.1.1.1"><csymbol cd="ambiguous" id="S3.E4.m1.3.3.1.1.1.1.cmml" xref="S3.E4.m1.3.3.1.1.1">superscript</csymbol><ci id="S3.E4.m1.3.3.1.1.1.2.cmml" xref="S3.E4.m1.3.3.1.1.1.2">𝒟</ci><ci id="S3.E4.m1.3.3.1.1.1.3.cmml" xref="S3.E4.m1.3.3.1.1.1.3">𝑖</ci></apply></apply><apply id="S3.E4.m1.4.4.2.2.cmml" xref="S3.E4.m1.4.4.2.3"><abs id="S3.E4.m1.4.4.2.2.1.cmml" xref="S3.E4.m1.4.4.2.3.1"></abs><ci id="S3.E4.m1.4.4.2.1.cmml" xref="S3.E4.m1.4.4.2.1">𝒟</ci></apply></apply><apply id="S3.E4.m1.8.8.2.1.1.1.3.cmml" xref="S3.E4.m1.8.8.2.1.1.1.3"><csymbol cd="ambiguous" id="S3.E4.m1.8.8.2.1.1.1.3.1.cmml" xref="S3.E4.m1.8.8.2.1.1.1.3">subscript</csymbol><ci id="S3.E4.m1.8.8.2.1.1.1.3.2.cmml" xref="S3.E4.m1.8.8.2.1.1.1.3.2">𝐿</ci><ci id="S3.E4.m1.8.8.2.1.1.1.3.3.cmml" xref="S3.E4.m1.8.8.2.1.1.1.3.3">𝑖</ci></apply><interval closure="open" id="S3.E4.m1.8.8.2.1.1.1.1.2.cmml" xref="S3.E4.m1.8.8.2.1.1.1.1.1"><ci id="S3.E4.m1.6.6.cmml" xref="S3.E4.m1.6.6">𝑤</ci><apply id="S3.E4.m1.8.8.2.1.1.1.1.1.1.cmml" xref="S3.E4.m1.8.8.2.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E4.m1.8.8.2.1.1.1.1.1.1.1.cmml" xref="S3.E4.m1.8.8.2.1.1.1.1.1.1">subscript</csymbol><ci id="S3.E4.m1.8.8.2.1.1.1.1.1.1.2.cmml" xref="S3.E4.m1.8.8.2.1.1.1.1.1.1.2">𝛿</ci><ci id="S3.E4.m1.8.8.2.1.1.1.1.1.1.3.cmml" xref="S3.E4.m1.8.8.2.1.1.1.1.1.1.3">𝑖</ci></apply></interval></apply></apply><apply id="S3.E4.m1.9.9.3.2.2.cmml" xref="S3.E4.m1.9.9.3.2.2"><times id="S3.E4.m1.9.9.3.2.2.1.cmml" xref="S3.E4.m1.9.9.3.2.2.1"></times><ci id="S3.E4.m1.9.9.3.2.2.2.cmml" xref="S3.E4.m1.9.9.3.2.2.2"> </ci><ci id="S3.E4.m1.9.9.3.2.2.3.cmml" xref="S3.E4.m1.9.9.3.2.2.3"> </ci></apply></list></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E4.m1.9c">  \operatorname*{arg\,min}_{w,\delta_{i}}\mathcal{L}(w,\delta_{i})=\sum_{i=1}^{N}\frac{|\mathcal{D}^{i}|}{|\mathcal{D}|}L_{i}(w,\delta_{i}),  </annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(4)</span></td>
</tr></tbody>
</table>
<p id="S3.SS3.p1.7" class="ltx_p">where <math id="S3.SS3.p1.4.m1.7" class="ltx_Math" alttext="L_{i}(w,\delta_{i})=\mathbb{E}_{(x,y)\sim\mathcal{D}^{i}}[\ell_{i}(w;(x+\delta_{i},y))]" display="inline"><semantics id="S3.SS3.p1.4.m1.7a"><mrow id="S3.SS3.p1.4.m1.7.7" xref="S3.SS3.p1.4.m1.7.7.cmml"><mrow id="S3.SS3.p1.4.m1.6.6.1" xref="S3.SS3.p1.4.m1.6.6.1.cmml"><msub id="S3.SS3.p1.4.m1.6.6.1.3" xref="S3.SS3.p1.4.m1.6.6.1.3.cmml"><mi id="S3.SS3.p1.4.m1.6.6.1.3.2" xref="S3.SS3.p1.4.m1.6.6.1.3.2.cmml">L</mi><mi id="S3.SS3.p1.4.m1.6.6.1.3.3" xref="S3.SS3.p1.4.m1.6.6.1.3.3.cmml">i</mi></msub><mo lspace="0em" rspace="0em" id="S3.SS3.p1.4.m1.6.6.1.2" xref="S3.SS3.p1.4.m1.6.6.1.2.cmml">​</mo><mrow id="S3.SS3.p1.4.m1.6.6.1.1.1" xref="S3.SS3.p1.4.m1.6.6.1.1.2.cmml"><mo stretchy="false" id="S3.SS3.p1.4.m1.6.6.1.1.1.2" xref="S3.SS3.p1.4.m1.6.6.1.1.2.cmml">(</mo><mi id="S3.SS3.p1.4.m1.3.3" xref="S3.SS3.p1.4.m1.3.3.cmml">w</mi><mo id="S3.SS3.p1.4.m1.6.6.1.1.1.3" xref="S3.SS3.p1.4.m1.6.6.1.1.2.cmml">,</mo><msub id="S3.SS3.p1.4.m1.6.6.1.1.1.1" xref="S3.SS3.p1.4.m1.6.6.1.1.1.1.cmml"><mi id="S3.SS3.p1.4.m1.6.6.1.1.1.1.2" xref="S3.SS3.p1.4.m1.6.6.1.1.1.1.2.cmml">δ</mi><mi id="S3.SS3.p1.4.m1.6.6.1.1.1.1.3" xref="S3.SS3.p1.4.m1.6.6.1.1.1.1.3.cmml">i</mi></msub><mo stretchy="false" id="S3.SS3.p1.4.m1.6.6.1.1.1.4" xref="S3.SS3.p1.4.m1.6.6.1.1.2.cmml">)</mo></mrow></mrow><mo id="S3.SS3.p1.4.m1.7.7.3" xref="S3.SS3.p1.4.m1.7.7.3.cmml">=</mo><mrow id="S3.SS3.p1.4.m1.7.7.2" xref="S3.SS3.p1.4.m1.7.7.2.cmml"><msub id="S3.SS3.p1.4.m1.7.7.2.3" xref="S3.SS3.p1.4.m1.7.7.2.3.cmml"><mi id="S3.SS3.p1.4.m1.7.7.2.3.2" xref="S3.SS3.p1.4.m1.7.7.2.3.2.cmml">𝔼</mi><mrow id="S3.SS3.p1.4.m1.2.2.2" xref="S3.SS3.p1.4.m1.2.2.2.cmml"><mrow id="S3.SS3.p1.4.m1.2.2.2.4.2" xref="S3.SS3.p1.4.m1.2.2.2.4.1.cmml"><mo stretchy="false" id="S3.SS3.p1.4.m1.2.2.2.4.2.1" xref="S3.SS3.p1.4.m1.2.2.2.4.1.cmml">(</mo><mi id="S3.SS3.p1.4.m1.1.1.1.1" xref="S3.SS3.p1.4.m1.1.1.1.1.cmml">x</mi><mo id="S3.SS3.p1.4.m1.2.2.2.4.2.2" xref="S3.SS3.p1.4.m1.2.2.2.4.1.cmml">,</mo><mi id="S3.SS3.p1.4.m1.2.2.2.2" xref="S3.SS3.p1.4.m1.2.2.2.2.cmml">y</mi><mo stretchy="false" id="S3.SS3.p1.4.m1.2.2.2.4.2.3" xref="S3.SS3.p1.4.m1.2.2.2.4.1.cmml">)</mo></mrow><mo id="S3.SS3.p1.4.m1.2.2.2.3" xref="S3.SS3.p1.4.m1.2.2.2.3.cmml">∼</mo><msup id="S3.SS3.p1.4.m1.2.2.2.5" xref="S3.SS3.p1.4.m1.2.2.2.5.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS3.p1.4.m1.2.2.2.5.2" xref="S3.SS3.p1.4.m1.2.2.2.5.2.cmml">𝒟</mi><mi id="S3.SS3.p1.4.m1.2.2.2.5.3" xref="S3.SS3.p1.4.m1.2.2.2.5.3.cmml">i</mi></msup></mrow></msub><mo lspace="0em" rspace="0em" id="S3.SS3.p1.4.m1.7.7.2.2" xref="S3.SS3.p1.4.m1.7.7.2.2.cmml">​</mo><mrow id="S3.SS3.p1.4.m1.7.7.2.1.1" xref="S3.SS3.p1.4.m1.7.7.2.1.2.cmml"><mo stretchy="false" id="S3.SS3.p1.4.m1.7.7.2.1.1.2" xref="S3.SS3.p1.4.m1.7.7.2.1.2.1.cmml">[</mo><mrow id="S3.SS3.p1.4.m1.7.7.2.1.1.1" xref="S3.SS3.p1.4.m1.7.7.2.1.1.1.cmml"><msub id="S3.SS3.p1.4.m1.7.7.2.1.1.1.3" xref="S3.SS3.p1.4.m1.7.7.2.1.1.1.3.cmml"><mi mathvariant="normal" id="S3.SS3.p1.4.m1.7.7.2.1.1.1.3.2" xref="S3.SS3.p1.4.m1.7.7.2.1.1.1.3.2.cmml">ℓ</mi><mi id="S3.SS3.p1.4.m1.7.7.2.1.1.1.3.3" xref="S3.SS3.p1.4.m1.7.7.2.1.1.1.3.3.cmml">i</mi></msub><mo lspace="0em" rspace="0em" id="S3.SS3.p1.4.m1.7.7.2.1.1.1.2" xref="S3.SS3.p1.4.m1.7.7.2.1.1.1.2.cmml">​</mo><mrow id="S3.SS3.p1.4.m1.7.7.2.1.1.1.1.1" xref="S3.SS3.p1.4.m1.7.7.2.1.1.1.1.2.cmml"><mo stretchy="false" id="S3.SS3.p1.4.m1.7.7.2.1.1.1.1.1.2" xref="S3.SS3.p1.4.m1.7.7.2.1.1.1.1.2.cmml">(</mo><mi id="S3.SS3.p1.4.m1.5.5" xref="S3.SS3.p1.4.m1.5.5.cmml">w</mi><mo id="S3.SS3.p1.4.m1.7.7.2.1.1.1.1.1.3" xref="S3.SS3.p1.4.m1.7.7.2.1.1.1.1.2.cmml">;</mo><mrow id="S3.SS3.p1.4.m1.7.7.2.1.1.1.1.1.1.1" xref="S3.SS3.p1.4.m1.7.7.2.1.1.1.1.1.1.2.cmml"><mo stretchy="false" id="S3.SS3.p1.4.m1.7.7.2.1.1.1.1.1.1.1.2" xref="S3.SS3.p1.4.m1.7.7.2.1.1.1.1.1.1.2.cmml">(</mo><mrow id="S3.SS3.p1.4.m1.7.7.2.1.1.1.1.1.1.1.1" xref="S3.SS3.p1.4.m1.7.7.2.1.1.1.1.1.1.1.1.cmml"><mi id="S3.SS3.p1.4.m1.7.7.2.1.1.1.1.1.1.1.1.2" xref="S3.SS3.p1.4.m1.7.7.2.1.1.1.1.1.1.1.1.2.cmml">x</mi><mo id="S3.SS3.p1.4.m1.7.7.2.1.1.1.1.1.1.1.1.1" xref="S3.SS3.p1.4.m1.7.7.2.1.1.1.1.1.1.1.1.1.cmml">+</mo><msub id="S3.SS3.p1.4.m1.7.7.2.1.1.1.1.1.1.1.1.3" xref="S3.SS3.p1.4.m1.7.7.2.1.1.1.1.1.1.1.1.3.cmml"><mi id="S3.SS3.p1.4.m1.7.7.2.1.1.1.1.1.1.1.1.3.2" xref="S3.SS3.p1.4.m1.7.7.2.1.1.1.1.1.1.1.1.3.2.cmml">δ</mi><mi id="S3.SS3.p1.4.m1.7.7.2.1.1.1.1.1.1.1.1.3.3" xref="S3.SS3.p1.4.m1.7.7.2.1.1.1.1.1.1.1.1.3.3.cmml">i</mi></msub></mrow><mo id="S3.SS3.p1.4.m1.7.7.2.1.1.1.1.1.1.1.3" xref="S3.SS3.p1.4.m1.7.7.2.1.1.1.1.1.1.2.cmml">,</mo><mi id="S3.SS3.p1.4.m1.4.4" xref="S3.SS3.p1.4.m1.4.4.cmml">y</mi><mo stretchy="false" id="S3.SS3.p1.4.m1.7.7.2.1.1.1.1.1.1.1.4" xref="S3.SS3.p1.4.m1.7.7.2.1.1.1.1.1.1.2.cmml">)</mo></mrow><mo stretchy="false" id="S3.SS3.p1.4.m1.7.7.2.1.1.1.1.1.4" xref="S3.SS3.p1.4.m1.7.7.2.1.1.1.1.2.cmml">)</mo></mrow></mrow><mo stretchy="false" id="S3.SS3.p1.4.m1.7.7.2.1.1.3" xref="S3.SS3.p1.4.m1.7.7.2.1.2.1.cmml">]</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.p1.4.m1.7b"><apply id="S3.SS3.p1.4.m1.7.7.cmml" xref="S3.SS3.p1.4.m1.7.7"><eq id="S3.SS3.p1.4.m1.7.7.3.cmml" xref="S3.SS3.p1.4.m1.7.7.3"></eq><apply id="S3.SS3.p1.4.m1.6.6.1.cmml" xref="S3.SS3.p1.4.m1.6.6.1"><times id="S3.SS3.p1.4.m1.6.6.1.2.cmml" xref="S3.SS3.p1.4.m1.6.6.1.2"></times><apply id="S3.SS3.p1.4.m1.6.6.1.3.cmml" xref="S3.SS3.p1.4.m1.6.6.1.3"><csymbol cd="ambiguous" id="S3.SS3.p1.4.m1.6.6.1.3.1.cmml" xref="S3.SS3.p1.4.m1.6.6.1.3">subscript</csymbol><ci id="S3.SS3.p1.4.m1.6.6.1.3.2.cmml" xref="S3.SS3.p1.4.m1.6.6.1.3.2">𝐿</ci><ci id="S3.SS3.p1.4.m1.6.6.1.3.3.cmml" xref="S3.SS3.p1.4.m1.6.6.1.3.3">𝑖</ci></apply><interval closure="open" id="S3.SS3.p1.4.m1.6.6.1.1.2.cmml" xref="S3.SS3.p1.4.m1.6.6.1.1.1"><ci id="S3.SS3.p1.4.m1.3.3.cmml" xref="S3.SS3.p1.4.m1.3.3">𝑤</ci><apply id="S3.SS3.p1.4.m1.6.6.1.1.1.1.cmml" xref="S3.SS3.p1.4.m1.6.6.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS3.p1.4.m1.6.6.1.1.1.1.1.cmml" xref="S3.SS3.p1.4.m1.6.6.1.1.1.1">subscript</csymbol><ci id="S3.SS3.p1.4.m1.6.6.1.1.1.1.2.cmml" xref="S3.SS3.p1.4.m1.6.6.1.1.1.1.2">𝛿</ci><ci id="S3.SS3.p1.4.m1.6.6.1.1.1.1.3.cmml" xref="S3.SS3.p1.4.m1.6.6.1.1.1.1.3">𝑖</ci></apply></interval></apply><apply id="S3.SS3.p1.4.m1.7.7.2.cmml" xref="S3.SS3.p1.4.m1.7.7.2"><times id="S3.SS3.p1.4.m1.7.7.2.2.cmml" xref="S3.SS3.p1.4.m1.7.7.2.2"></times><apply id="S3.SS3.p1.4.m1.7.7.2.3.cmml" xref="S3.SS3.p1.4.m1.7.7.2.3"><csymbol cd="ambiguous" id="S3.SS3.p1.4.m1.7.7.2.3.1.cmml" xref="S3.SS3.p1.4.m1.7.7.2.3">subscript</csymbol><ci id="S3.SS3.p1.4.m1.7.7.2.3.2.cmml" xref="S3.SS3.p1.4.m1.7.7.2.3.2">𝔼</ci><apply id="S3.SS3.p1.4.m1.2.2.2.cmml" xref="S3.SS3.p1.4.m1.2.2.2"><csymbol cd="latexml" id="S3.SS3.p1.4.m1.2.2.2.3.cmml" xref="S3.SS3.p1.4.m1.2.2.2.3">similar-to</csymbol><interval closure="open" id="S3.SS3.p1.4.m1.2.2.2.4.1.cmml" xref="S3.SS3.p1.4.m1.2.2.2.4.2"><ci id="S3.SS3.p1.4.m1.1.1.1.1.cmml" xref="S3.SS3.p1.4.m1.1.1.1.1">𝑥</ci><ci id="S3.SS3.p1.4.m1.2.2.2.2.cmml" xref="S3.SS3.p1.4.m1.2.2.2.2">𝑦</ci></interval><apply id="S3.SS3.p1.4.m1.2.2.2.5.cmml" xref="S3.SS3.p1.4.m1.2.2.2.5"><csymbol cd="ambiguous" id="S3.SS3.p1.4.m1.2.2.2.5.1.cmml" xref="S3.SS3.p1.4.m1.2.2.2.5">superscript</csymbol><ci id="S3.SS3.p1.4.m1.2.2.2.5.2.cmml" xref="S3.SS3.p1.4.m1.2.2.2.5.2">𝒟</ci><ci id="S3.SS3.p1.4.m1.2.2.2.5.3.cmml" xref="S3.SS3.p1.4.m1.2.2.2.5.3">𝑖</ci></apply></apply></apply><apply id="S3.SS3.p1.4.m1.7.7.2.1.2.cmml" xref="S3.SS3.p1.4.m1.7.7.2.1.1"><csymbol cd="latexml" id="S3.SS3.p1.4.m1.7.7.2.1.2.1.cmml" xref="S3.SS3.p1.4.m1.7.7.2.1.1.2">delimited-[]</csymbol><apply id="S3.SS3.p1.4.m1.7.7.2.1.1.1.cmml" xref="S3.SS3.p1.4.m1.7.7.2.1.1.1"><times id="S3.SS3.p1.4.m1.7.7.2.1.1.1.2.cmml" xref="S3.SS3.p1.4.m1.7.7.2.1.1.1.2"></times><apply id="S3.SS3.p1.4.m1.7.7.2.1.1.1.3.cmml" xref="S3.SS3.p1.4.m1.7.7.2.1.1.1.3"><csymbol cd="ambiguous" id="S3.SS3.p1.4.m1.7.7.2.1.1.1.3.1.cmml" xref="S3.SS3.p1.4.m1.7.7.2.1.1.1.3">subscript</csymbol><ci id="S3.SS3.p1.4.m1.7.7.2.1.1.1.3.2.cmml" xref="S3.SS3.p1.4.m1.7.7.2.1.1.1.3.2">ℓ</ci><ci id="S3.SS3.p1.4.m1.7.7.2.1.1.1.3.3.cmml" xref="S3.SS3.p1.4.m1.7.7.2.1.1.1.3.3">𝑖</ci></apply><list id="S3.SS3.p1.4.m1.7.7.2.1.1.1.1.2.cmml" xref="S3.SS3.p1.4.m1.7.7.2.1.1.1.1.1"><ci id="S3.SS3.p1.4.m1.5.5.cmml" xref="S3.SS3.p1.4.m1.5.5">𝑤</ci><interval closure="open" id="S3.SS3.p1.4.m1.7.7.2.1.1.1.1.1.1.2.cmml" xref="S3.SS3.p1.4.m1.7.7.2.1.1.1.1.1.1.1"><apply id="S3.SS3.p1.4.m1.7.7.2.1.1.1.1.1.1.1.1.cmml" xref="S3.SS3.p1.4.m1.7.7.2.1.1.1.1.1.1.1.1"><plus id="S3.SS3.p1.4.m1.7.7.2.1.1.1.1.1.1.1.1.1.cmml" xref="S3.SS3.p1.4.m1.7.7.2.1.1.1.1.1.1.1.1.1"></plus><ci id="S3.SS3.p1.4.m1.7.7.2.1.1.1.1.1.1.1.1.2.cmml" xref="S3.SS3.p1.4.m1.7.7.2.1.1.1.1.1.1.1.1.2">𝑥</ci><apply id="S3.SS3.p1.4.m1.7.7.2.1.1.1.1.1.1.1.1.3.cmml" xref="S3.SS3.p1.4.m1.7.7.2.1.1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.SS3.p1.4.m1.7.7.2.1.1.1.1.1.1.1.1.3.1.cmml" xref="S3.SS3.p1.4.m1.7.7.2.1.1.1.1.1.1.1.1.3">subscript</csymbol><ci id="S3.SS3.p1.4.m1.7.7.2.1.1.1.1.1.1.1.1.3.2.cmml" xref="S3.SS3.p1.4.m1.7.7.2.1.1.1.1.1.1.1.1.3.2">𝛿</ci><ci id="S3.SS3.p1.4.m1.7.7.2.1.1.1.1.1.1.1.1.3.3.cmml" xref="S3.SS3.p1.4.m1.7.7.2.1.1.1.1.1.1.1.1.3.3">𝑖</ci></apply></apply><ci id="S3.SS3.p1.4.m1.4.4.cmml" xref="S3.SS3.p1.4.m1.4.4">𝑦</ci></interval></list></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p1.4.m1.7c">L_{i}(w,\delta_{i})=\mathbb{E}_{(x,y)\sim\mathcal{D}^{i}}[\ell_{i}(w;(x+\delta_{i},y))]</annotation></semantics></math> is the empirical loss of <math id="S3.SS3.p1.5.m2.1" class="ltx_Math" alttext="C_{i}" display="inline"><semantics id="S3.SS3.p1.5.m2.1a"><msub id="S3.SS3.p1.5.m2.1.1" xref="S3.SS3.p1.5.m2.1.1.cmml"><mi id="S3.SS3.p1.5.m2.1.1.2" xref="S3.SS3.p1.5.m2.1.1.2.cmml">C</mi><mi id="S3.SS3.p1.5.m2.1.1.3" xref="S3.SS3.p1.5.m2.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS3.p1.5.m2.1b"><apply id="S3.SS3.p1.5.m2.1.1.cmml" xref="S3.SS3.p1.5.m2.1.1"><csymbol cd="ambiguous" id="S3.SS3.p1.5.m2.1.1.1.cmml" xref="S3.SS3.p1.5.m2.1.1">subscript</csymbol><ci id="S3.SS3.p1.5.m2.1.1.2.cmml" xref="S3.SS3.p1.5.m2.1.1.2">𝐶</ci><ci id="S3.SS3.p1.5.m2.1.1.3.cmml" xref="S3.SS3.p1.5.m2.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p1.5.m2.1c">C_{i}</annotation></semantics></math>. To achieve the goal in Eq. (<a href="#S3.E2" title="In 3.1 Problem setup ‣ 3 Methodology ‣ Visual Prompt Based Personalized Federated Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">2</span></a>), exiting PFL algorithms usually add a regularizer to the model to perform information exchange between clients <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib29" title="" class="ltx_ref">29</a>, <a href="#bib.bib1" title="" class="ltx_ref">1</a>]</cite>, partition the layers as shared and personalized parts by exchanging the shared layers <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib41" title="" class="ltx_ref">41</a>]</cite>, or interpolate the aggregated model with local models <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib29" title="" class="ltx_ref">29</a>, <a href="#bib.bib33" title="" class="ltx_ref">33</a>]</cite>. However, pFedPT still uses the aggregated model <math id="S3.SS3.p1.6.m3.1" class="ltx_Math" alttext="w" display="inline"><semantics id="S3.SS3.p1.6.m3.1a"><mi id="S3.SS3.p1.6.m3.1.1" xref="S3.SS3.p1.6.m3.1.1.cmml">w</mi><annotation-xml encoding="MathML-Content" id="S3.SS3.p1.6.m3.1b"><ci id="S3.SS3.p1.6.m3.1.1.cmml" xref="S3.SS3.p1.6.m3.1.1">𝑤</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p1.6.m3.1c">w</annotation></semantics></math> to deliver public knowledge between clients, and personalized knowledge is incorporated by adding <math id="S3.SS3.p1.7.m4.1" class="ltx_Math" alttext="\delta_{i}" display="inline"><semantics id="S3.SS3.p1.7.m4.1a"><msub id="S3.SS3.p1.7.m4.1.1" xref="S3.SS3.p1.7.m4.1.1.cmml"><mi id="S3.SS3.p1.7.m4.1.1.2" xref="S3.SS3.p1.7.m4.1.1.2.cmml">δ</mi><mi id="S3.SS3.p1.7.m4.1.1.3" xref="S3.SS3.p1.7.m4.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS3.p1.7.m4.1b"><apply id="S3.SS3.p1.7.m4.1.1.cmml" xref="S3.SS3.p1.7.m4.1.1"><csymbol cd="ambiguous" id="S3.SS3.p1.7.m4.1.1.1.cmml" xref="S3.SS3.p1.7.m4.1.1">subscript</csymbol><ci id="S3.SS3.p1.7.m4.1.1.2.cmml" xref="S3.SS3.p1.7.m4.1.1.2">𝛿</ci><ci id="S3.SS3.p1.7.m4.1.1.3.cmml" xref="S3.SS3.p1.7.m4.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p1.7.m4.1c">\delta_{i}</annotation></semantics></math> to the data. Specifically, the shared backbone is responsible for the extraction of the common knowledge of each client and identifying the information carried by the visual prompt of the individual clients. The client-specific prompt is responsible for increasing the guidance of the backbone to achieve fine-tuning to adapt to the client’s data distribution. We implement personalized prediction of the backbone at the client data level.</p>
</div>
<figure id="algorithm1" class="ltx_float ltx_algorithm">
<div id="algorithm1.34" class="ltx_listing ltx_lst_numbers_left ltx_listing">
<div id="algorithm1.9.9" class="ltx_listingline">
<span id="algorithm1.9.9.9" class="ltx_text" style="font-size:90%;">
<span id="algorithm1.9.9.9.1" class="ltx_text"><span id="algorithm1.9.9.9.1.1" class="ltx_text ltx_font_bold">Input:</span> </span>number of communication rounds <math id="algorithm1.1.1.1.m1.1" class="ltx_Math" alttext="T" display="inline"><semantics id="algorithm1.1.1.1.m1.1a"><mi id="algorithm1.1.1.1.m1.1.1" xref="algorithm1.1.1.1.m1.1.1.cmml">T</mi><annotation-xml encoding="MathML-Content" id="algorithm1.1.1.1.m1.1b"><ci id="algorithm1.1.1.1.m1.1.1.cmml" xref="algorithm1.1.1.1.m1.1.1">𝑇</ci></annotation-xml><annotation encoding="application/x-tex" id="algorithm1.1.1.1.m1.1c">T</annotation></semantics></math>, the set of clients <math id="algorithm1.2.2.2.m2.3" class="ltx_Math" alttext="\left\{C_{1},...,C_{N}\right\}" display="inline"><semantics id="algorithm1.2.2.2.m2.3a"><mrow id="algorithm1.2.2.2.m2.3.3.2" xref="algorithm1.2.2.2.m2.3.3.3.cmml"><mo id="algorithm1.2.2.2.m2.3.3.2.3" xref="algorithm1.2.2.2.m2.3.3.3.cmml">{</mo><msub id="algorithm1.2.2.2.m2.2.2.1.1" xref="algorithm1.2.2.2.m2.2.2.1.1.cmml"><mi id="algorithm1.2.2.2.m2.2.2.1.1.2" xref="algorithm1.2.2.2.m2.2.2.1.1.2.cmml">C</mi><mn id="algorithm1.2.2.2.m2.2.2.1.1.3" xref="algorithm1.2.2.2.m2.2.2.1.1.3.cmml">1</mn></msub><mo id="algorithm1.2.2.2.m2.3.3.2.4" xref="algorithm1.2.2.2.m2.3.3.3.cmml">,</mo><mi mathvariant="normal" id="algorithm1.2.2.2.m2.1.1" xref="algorithm1.2.2.2.m2.1.1.cmml">…</mi><mo id="algorithm1.2.2.2.m2.3.3.2.5" xref="algorithm1.2.2.2.m2.3.3.3.cmml">,</mo><msub id="algorithm1.2.2.2.m2.3.3.2.2" xref="algorithm1.2.2.2.m2.3.3.2.2.cmml"><mi id="algorithm1.2.2.2.m2.3.3.2.2.2" xref="algorithm1.2.2.2.m2.3.3.2.2.2.cmml">C</mi><mi id="algorithm1.2.2.2.m2.3.3.2.2.3" xref="algorithm1.2.2.2.m2.3.3.2.2.3.cmml">N</mi></msub><mo id="algorithm1.2.2.2.m2.3.3.2.6" xref="algorithm1.2.2.2.m2.3.3.3.cmml">}</mo></mrow><annotation-xml encoding="MathML-Content" id="algorithm1.2.2.2.m2.3b"><set id="algorithm1.2.2.2.m2.3.3.3.cmml" xref="algorithm1.2.2.2.m2.3.3.2"><apply id="algorithm1.2.2.2.m2.2.2.1.1.cmml" xref="algorithm1.2.2.2.m2.2.2.1.1"><csymbol cd="ambiguous" id="algorithm1.2.2.2.m2.2.2.1.1.1.cmml" xref="algorithm1.2.2.2.m2.2.2.1.1">subscript</csymbol><ci id="algorithm1.2.2.2.m2.2.2.1.1.2.cmml" xref="algorithm1.2.2.2.m2.2.2.1.1.2">𝐶</ci><cn type="integer" id="algorithm1.2.2.2.m2.2.2.1.1.3.cmml" xref="algorithm1.2.2.2.m2.2.2.1.1.3">1</cn></apply><ci id="algorithm1.2.2.2.m2.1.1.cmml" xref="algorithm1.2.2.2.m2.1.1">…</ci><apply id="algorithm1.2.2.2.m2.3.3.2.2.cmml" xref="algorithm1.2.2.2.m2.3.3.2.2"><csymbol cd="ambiguous" id="algorithm1.2.2.2.m2.3.3.2.2.1.cmml" xref="algorithm1.2.2.2.m2.3.3.2.2">subscript</csymbol><ci id="algorithm1.2.2.2.m2.3.3.2.2.2.cmml" xref="algorithm1.2.2.2.m2.3.3.2.2.2">𝐶</ci><ci id="algorithm1.2.2.2.m2.3.3.2.2.3.cmml" xref="algorithm1.2.2.2.m2.3.3.2.2.3">𝑁</ci></apply></set></annotation-xml><annotation encoding="application/x-tex" id="algorithm1.2.2.2.m2.3c">\left\{C_{1},...,C_{N}\right\}</annotation></semantics></math>, number of local epochs <math id="algorithm1.3.3.3.m3.1" class="ltx_Math" alttext="E_{b}" display="inline"><semantics id="algorithm1.3.3.3.m3.1a"><msub id="algorithm1.3.3.3.m3.1.1" xref="algorithm1.3.3.3.m3.1.1.cmml"><mi id="algorithm1.3.3.3.m3.1.1.2" xref="algorithm1.3.3.3.m3.1.1.2.cmml">E</mi><mi id="algorithm1.3.3.3.m3.1.1.3" xref="algorithm1.3.3.3.m3.1.1.3.cmml">b</mi></msub><annotation-xml encoding="MathML-Content" id="algorithm1.3.3.3.m3.1b"><apply id="algorithm1.3.3.3.m3.1.1.cmml" xref="algorithm1.3.3.3.m3.1.1"><csymbol cd="ambiguous" id="algorithm1.3.3.3.m3.1.1.1.cmml" xref="algorithm1.3.3.3.m3.1.1">subscript</csymbol><ci id="algorithm1.3.3.3.m3.1.1.2.cmml" xref="algorithm1.3.3.3.m3.1.1.2">𝐸</ci><ci id="algorithm1.3.3.3.m3.1.1.3.cmml" xref="algorithm1.3.3.3.m3.1.1.3">𝑏</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="algorithm1.3.3.3.m3.1c">E_{b}</annotation></semantics></math> for backbone, number of local epochs <math id="algorithm1.4.4.4.m4.1" class="ltx_Math" alttext="E_{g}" display="inline"><semantics id="algorithm1.4.4.4.m4.1a"><msub id="algorithm1.4.4.4.m4.1.1" xref="algorithm1.4.4.4.m4.1.1.cmml"><mi id="algorithm1.4.4.4.m4.1.1.2" xref="algorithm1.4.4.4.m4.1.1.2.cmml">E</mi><mi id="algorithm1.4.4.4.m4.1.1.3" xref="algorithm1.4.4.4.m4.1.1.3.cmml">g</mi></msub><annotation-xml encoding="MathML-Content" id="algorithm1.4.4.4.m4.1b"><apply id="algorithm1.4.4.4.m4.1.1.cmml" xref="algorithm1.4.4.4.m4.1.1"><csymbol cd="ambiguous" id="algorithm1.4.4.4.m4.1.1.1.cmml" xref="algorithm1.4.4.4.m4.1.1">subscript</csymbol><ci id="algorithm1.4.4.4.m4.1.1.2.cmml" xref="algorithm1.4.4.4.m4.1.1.2">𝐸</ci><ci id="algorithm1.4.4.4.m4.1.1.3.cmml" xref="algorithm1.4.4.4.m4.1.1.3">𝑔</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="algorithm1.4.4.4.m4.1c">E_{g}</annotation></semantics></math> for the prompt generator, learning rate <math id="algorithm1.5.5.5.m5.1" class="ltx_Math" alttext="\eta_{b}" display="inline"><semantics id="algorithm1.5.5.5.m5.1a"><msub id="algorithm1.5.5.5.m5.1.1" xref="algorithm1.5.5.5.m5.1.1.cmml"><mi id="algorithm1.5.5.5.m5.1.1.2" xref="algorithm1.5.5.5.m5.1.1.2.cmml">η</mi><mi id="algorithm1.5.5.5.m5.1.1.3" xref="algorithm1.5.5.5.m5.1.1.3.cmml">b</mi></msub><annotation-xml encoding="MathML-Content" id="algorithm1.5.5.5.m5.1b"><apply id="algorithm1.5.5.5.m5.1.1.cmml" xref="algorithm1.5.5.5.m5.1.1"><csymbol cd="ambiguous" id="algorithm1.5.5.5.m5.1.1.1.cmml" xref="algorithm1.5.5.5.m5.1.1">subscript</csymbol><ci id="algorithm1.5.5.5.m5.1.1.2.cmml" xref="algorithm1.5.5.5.m5.1.1.2">𝜂</ci><ci id="algorithm1.5.5.5.m5.1.1.3.cmml" xref="algorithm1.5.5.5.m5.1.1.3">𝑏</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="algorithm1.5.5.5.m5.1c">\eta_{b}</annotation></semantics></math> for backbone, learning rate <math id="algorithm1.6.6.6.m6.1" class="ltx_Math" alttext="\eta_{g}" display="inline"><semantics id="algorithm1.6.6.6.m6.1a"><msub id="algorithm1.6.6.6.m6.1.1" xref="algorithm1.6.6.6.m6.1.1.cmml"><mi id="algorithm1.6.6.6.m6.1.1.2" xref="algorithm1.6.6.6.m6.1.1.2.cmml">η</mi><mi id="algorithm1.6.6.6.m6.1.1.3" xref="algorithm1.6.6.6.m6.1.1.3.cmml">g</mi></msub><annotation-xml encoding="MathML-Content" id="algorithm1.6.6.6.m6.1b"><apply id="algorithm1.6.6.6.m6.1.1.cmml" xref="algorithm1.6.6.6.m6.1.1"><csymbol cd="ambiguous" id="algorithm1.6.6.6.m6.1.1.1.cmml" xref="algorithm1.6.6.6.m6.1.1">subscript</csymbol><ci id="algorithm1.6.6.6.m6.1.1.2.cmml" xref="algorithm1.6.6.6.m6.1.1.2">𝜂</ci><ci id="algorithm1.6.6.6.m6.1.1.3.cmml" xref="algorithm1.6.6.6.m6.1.1.3">𝑔</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="algorithm1.6.6.6.m6.1c">\eta_{g}</annotation></semantics></math> for the prompt generator, initialization parameters <math id="algorithm1.7.7.7.m7.1" class="ltx_Math" alttext="w^{0}" display="inline"><semantics id="algorithm1.7.7.7.m7.1a"><msup id="algorithm1.7.7.7.m7.1.1" xref="algorithm1.7.7.7.m7.1.1.cmml"><mi id="algorithm1.7.7.7.m7.1.1.2" xref="algorithm1.7.7.7.m7.1.1.2.cmml">w</mi><mn id="algorithm1.7.7.7.m7.1.1.3" xref="algorithm1.7.7.7.m7.1.1.3.cmml">0</mn></msup><annotation-xml encoding="MathML-Content" id="algorithm1.7.7.7.m7.1b"><apply id="algorithm1.7.7.7.m7.1.1.cmml" xref="algorithm1.7.7.7.m7.1.1"><csymbol cd="ambiguous" id="algorithm1.7.7.7.m7.1.1.1.cmml" xref="algorithm1.7.7.7.m7.1.1">superscript</csymbol><ci id="algorithm1.7.7.7.m7.1.1.2.cmml" xref="algorithm1.7.7.7.m7.1.1.2">𝑤</ci><cn type="integer" id="algorithm1.7.7.7.m7.1.1.3.cmml" xref="algorithm1.7.7.7.m7.1.1.3">0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="algorithm1.7.7.7.m7.1c">w^{0}</annotation></semantics></math> for backbone, initialization parameters <math id="algorithm1.8.8.8.m8.1" class="ltx_Math" alttext="\delta_{i}^{0}" display="inline"><semantics id="algorithm1.8.8.8.m8.1a"><msubsup id="algorithm1.8.8.8.m8.1.1" xref="algorithm1.8.8.8.m8.1.1.cmml"><mi id="algorithm1.8.8.8.m8.1.1.2.2" xref="algorithm1.8.8.8.m8.1.1.2.2.cmml">δ</mi><mi id="algorithm1.8.8.8.m8.1.1.2.3" xref="algorithm1.8.8.8.m8.1.1.2.3.cmml">i</mi><mn id="algorithm1.8.8.8.m8.1.1.3" xref="algorithm1.8.8.8.m8.1.1.3.cmml">0</mn></msubsup><annotation-xml encoding="MathML-Content" id="algorithm1.8.8.8.m8.1b"><apply id="algorithm1.8.8.8.m8.1.1.cmml" xref="algorithm1.8.8.8.m8.1.1"><csymbol cd="ambiguous" id="algorithm1.8.8.8.m8.1.1.1.cmml" xref="algorithm1.8.8.8.m8.1.1">superscript</csymbol><apply id="algorithm1.8.8.8.m8.1.1.2.cmml" xref="algorithm1.8.8.8.m8.1.1"><csymbol cd="ambiguous" id="algorithm1.8.8.8.m8.1.1.2.1.cmml" xref="algorithm1.8.8.8.m8.1.1">subscript</csymbol><ci id="algorithm1.8.8.8.m8.1.1.2.2.cmml" xref="algorithm1.8.8.8.m8.1.1.2.2">𝛿</ci><ci id="algorithm1.8.8.8.m8.1.1.2.3.cmml" xref="algorithm1.8.8.8.m8.1.1.2.3">𝑖</ci></apply><cn type="integer" id="algorithm1.8.8.8.m8.1.1.3.cmml" xref="algorithm1.8.8.8.m8.1.1.3">0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="algorithm1.8.8.8.m8.1c">\delta_{i}^{0}</annotation></semantics></math> for the prompt generator in client <math id="algorithm1.9.9.9.m9.1" class="ltx_Math" alttext="i" display="inline"><semantics id="algorithm1.9.9.9.m9.1a"><mi id="algorithm1.9.9.9.m9.1.1" xref="algorithm1.9.9.9.m9.1.1.cmml">i</mi><annotation-xml encoding="MathML-Content" id="algorithm1.9.9.9.m9.1b"><ci id="algorithm1.9.9.9.m9.1.1.cmml" xref="algorithm1.9.9.9.m9.1.1">𝑖</ci></annotation-xml><annotation encoding="application/x-tex" id="algorithm1.9.9.9.m9.1c">i</annotation></semantics></math>. </span>
</div>
<div id="algorithm1.10.10" class="ltx_listingline">
<span id="algorithm1.10.10.1" class="ltx_text" style="font-size:90%;">
</span><span id="algorithm1.10.10.2" class="ltx_text" style="font-size:90%;"><span id="algorithm1.10.10.2.1" class="ltx_text ltx_font_bold">Output:</span> </span><span id="algorithm1.10.10.3" class="ltx_text" style="font-size:90%;">The final model </span><math id="algorithm1.10.10.m1.1" class="ltx_Math" alttext="w^{T}" display="inline"><semantics id="algorithm1.10.10.m1.1a"><msup id="algorithm1.10.10.m1.1.1" xref="algorithm1.10.10.m1.1.1.cmml"><mi mathsize="90%" id="algorithm1.10.10.m1.1.1.2" xref="algorithm1.10.10.m1.1.1.2.cmml">w</mi><mi mathsize="90%" id="algorithm1.10.10.m1.1.1.3" xref="algorithm1.10.10.m1.1.1.3.cmml">T</mi></msup><annotation-xml encoding="MathML-Content" id="algorithm1.10.10.m1.1b"><apply id="algorithm1.10.10.m1.1.1.cmml" xref="algorithm1.10.10.m1.1.1"><csymbol cd="ambiguous" id="algorithm1.10.10.m1.1.1.1.cmml" xref="algorithm1.10.10.m1.1.1">superscript</csymbol><ci id="algorithm1.10.10.m1.1.1.2.cmml" xref="algorithm1.10.10.m1.1.1.2">𝑤</ci><ci id="algorithm1.10.10.m1.1.1.3.cmml" xref="algorithm1.10.10.m1.1.1.3">𝑇</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="algorithm1.10.10.m1.1c">w^{T}</annotation></semantics></math>
</div>
<div id="algorithm1.11.11" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="algorithm1.11.11.1.1.1" class="ltx_text" style="font-size:90%;">1</span></span><span id="algorithm1.11.11.2" class="ltx_text" style="font-size:90%;">
</span><span id="algorithm1.11.11.3" class="ltx_text ltx_font_bold" style="font-size:90%;">Server executes</span><span id="algorithm1.11.11.4" class="ltx_text" style="font-size:90%;">:
initialize </span><math id="algorithm1.11.11.m1.1" class="ltx_Math" alttext="w^{0}" display="inline"><semantics id="algorithm1.11.11.m1.1a"><msup id="algorithm1.11.11.m1.1.1" xref="algorithm1.11.11.m1.1.1.cmml"><mi mathsize="90%" id="algorithm1.11.11.m1.1.1.2" xref="algorithm1.11.11.m1.1.1.2.cmml">w</mi><mn mathsize="90%" id="algorithm1.11.11.m1.1.1.3" xref="algorithm1.11.11.m1.1.1.3.cmml">0</mn></msup><annotation-xml encoding="MathML-Content" id="algorithm1.11.11.m1.1b"><apply id="algorithm1.11.11.m1.1.1.cmml" xref="algorithm1.11.11.m1.1.1"><csymbol cd="ambiguous" id="algorithm1.11.11.m1.1.1.1.cmml" xref="algorithm1.11.11.m1.1.1">superscript</csymbol><ci id="algorithm1.11.11.m1.1.1.2.cmml" xref="algorithm1.11.11.m1.1.1.2">𝑤</ci><cn type="integer" id="algorithm1.11.11.m1.1.1.3.cmml" xref="algorithm1.11.11.m1.1.1.3">0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="algorithm1.11.11.m1.1c">w^{0}</annotation></semantics></math>
</div>
<div id="algorithm1.13.13" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="algorithm1.13.13.1.1.1" class="ltx_text" style="font-size:90%;">2</span></span><span id="algorithm1.13.13.2" class="ltx_text" style="font-size:90%;">
</span><math id="algorithm1.12.12.m1.1" class="ltx_Math" alttext="\mathcal{S:}" display="inline"><semantics id="algorithm1.12.12.m1.1a"><mrow id="algorithm1.12.12.m1.1.1" xref="algorithm1.12.12.m1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" mathsize="90%" id="algorithm1.12.12.m1.1.1.2" xref="algorithm1.12.12.m1.1.1.2.cmml">𝒮</mi><mo lspace="0.278em" mathsize="90%" rspace="0.278em" id="algorithm1.12.12.m1.1.1.1" xref="algorithm1.12.12.m1.1.1.1.cmml">:</mo><mi id="algorithm1.12.12.m1.1.1.3" xref="algorithm1.12.12.m1.1.1.3.cmml"></mi></mrow><annotation-xml encoding="MathML-Content" id="algorithm1.12.12.m1.1b"><apply id="algorithm1.12.12.m1.1.1.cmml" xref="algorithm1.12.12.m1.1.1"><ci id="algorithm1.12.12.m1.1.1.1.cmml" xref="algorithm1.12.12.m1.1.1.1">:</ci><ci id="algorithm1.12.12.m1.1.1.2.cmml" xref="algorithm1.12.12.m1.1.1.2">𝒮</ci><csymbol cd="latexml" id="algorithm1.12.12.m1.1.1.3.cmml" xref="algorithm1.12.12.m1.1.1.3">absent</csymbol></apply></annotation-xml><annotation encoding="application/x-tex" id="algorithm1.12.12.m1.1c">\mathcal{S:}</annotation></semantics></math><span id="algorithm1.13.13.3" class="ltx_text" style="font-size:90%;"> choose a random set of devices from </span><math id="algorithm1.13.13.m2.1" class="ltx_Math" alttext="C" display="inline"><semantics id="algorithm1.13.13.m2.1a"><mi mathsize="90%" id="algorithm1.13.13.m2.1.1" xref="algorithm1.13.13.m2.1.1.cmml">C</mi><annotation-xml encoding="MathML-Content" id="algorithm1.13.13.m2.1b"><ci id="algorithm1.13.13.m2.1.1.cmml" xref="algorithm1.13.13.m2.1.1">𝐶</ci></annotation-xml><annotation encoding="application/x-tex" id="algorithm1.13.13.m2.1c">C</annotation></semantics></math><span id="algorithm1.13.13.4" class="ltx_text" style="font-size:90%;"> </span>
</div>
<div id="algorithm1.14.14" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="algorithm1.14.14.1.1.1" class="ltx_text" style="font-size:90%;">3</span></span><span id="algorithm1.14.14.2" class="ltx_text" style="font-size:90%;">
</span><span id="algorithm1.14.14.3" class="ltx_text ltx_font_bold" style="font-size:90%;">for</span><span id="algorithm1.14.14.4" class="ltx_text" style="font-size:90%;"> </span><math id="algorithm1.14.14.m1.4" class="ltx_Math" alttext="t=0,1,...,T-1" display="inline"><semantics id="algorithm1.14.14.m1.4a"><mrow id="algorithm1.14.14.m1.4.4" xref="algorithm1.14.14.m1.4.4.cmml"><mi mathsize="90%" id="algorithm1.14.14.m1.4.4.3" xref="algorithm1.14.14.m1.4.4.3.cmml">t</mi><mo mathsize="90%" id="algorithm1.14.14.m1.4.4.2" xref="algorithm1.14.14.m1.4.4.2.cmml">=</mo><mrow id="algorithm1.14.14.m1.4.4.1.1" xref="algorithm1.14.14.m1.4.4.1.2.cmml"><mn mathsize="90%" id="algorithm1.14.14.m1.1.1" xref="algorithm1.14.14.m1.1.1.cmml">0</mn><mo mathsize="90%" id="algorithm1.14.14.m1.4.4.1.1.2" xref="algorithm1.14.14.m1.4.4.1.2.cmml">,</mo><mn mathsize="90%" id="algorithm1.14.14.m1.2.2" xref="algorithm1.14.14.m1.2.2.cmml">1</mn><mo mathsize="90%" id="algorithm1.14.14.m1.4.4.1.1.3" xref="algorithm1.14.14.m1.4.4.1.2.cmml">,</mo><mi mathsize="90%" mathvariant="normal" id="algorithm1.14.14.m1.3.3" xref="algorithm1.14.14.m1.3.3.cmml">…</mi><mo mathsize="90%" id="algorithm1.14.14.m1.4.4.1.1.4" xref="algorithm1.14.14.m1.4.4.1.2.cmml">,</mo><mrow id="algorithm1.14.14.m1.4.4.1.1.1" xref="algorithm1.14.14.m1.4.4.1.1.1.cmml"><mi mathsize="90%" id="algorithm1.14.14.m1.4.4.1.1.1.2" xref="algorithm1.14.14.m1.4.4.1.1.1.2.cmml">T</mi><mo mathsize="90%" id="algorithm1.14.14.m1.4.4.1.1.1.1" xref="algorithm1.14.14.m1.4.4.1.1.1.1.cmml">−</mo><mn mathsize="90%" id="algorithm1.14.14.m1.4.4.1.1.1.3" xref="algorithm1.14.14.m1.4.4.1.1.1.3.cmml">1</mn></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="algorithm1.14.14.m1.4b"><apply id="algorithm1.14.14.m1.4.4.cmml" xref="algorithm1.14.14.m1.4.4"><eq id="algorithm1.14.14.m1.4.4.2.cmml" xref="algorithm1.14.14.m1.4.4.2"></eq><ci id="algorithm1.14.14.m1.4.4.3.cmml" xref="algorithm1.14.14.m1.4.4.3">𝑡</ci><list id="algorithm1.14.14.m1.4.4.1.2.cmml" xref="algorithm1.14.14.m1.4.4.1.1"><cn type="integer" id="algorithm1.14.14.m1.1.1.cmml" xref="algorithm1.14.14.m1.1.1">0</cn><cn type="integer" id="algorithm1.14.14.m1.2.2.cmml" xref="algorithm1.14.14.m1.2.2">1</cn><ci id="algorithm1.14.14.m1.3.3.cmml" xref="algorithm1.14.14.m1.3.3">…</ci><apply id="algorithm1.14.14.m1.4.4.1.1.1.cmml" xref="algorithm1.14.14.m1.4.4.1.1.1"><minus id="algorithm1.14.14.m1.4.4.1.1.1.1.cmml" xref="algorithm1.14.14.m1.4.4.1.1.1.1"></minus><ci id="algorithm1.14.14.m1.4.4.1.1.1.2.cmml" xref="algorithm1.14.14.m1.4.4.1.1.1.2">𝑇</ci><cn type="integer" id="algorithm1.14.14.m1.4.4.1.1.1.3.cmml" xref="algorithm1.14.14.m1.4.4.1.1.1.3">1</cn></apply></list></apply></annotation-xml><annotation encoding="application/x-tex" id="algorithm1.14.14.m1.4c">t=0,1,...,T-1</annotation></semantics></math><span id="algorithm1.14.14.5" class="ltx_text" style="font-size:90%;"> </span><span id="algorithm1.14.14.6" class="ltx_text ltx_font_bold" style="font-size:90%;">do</span>
</div>
<div id="algorithm1.15.15" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="algorithm1.15.15.1.1.1" class="ltx_text" style="font-size:90%;">4</span></span><span id="algorithm1.15.15.2" class="ltx_text" style="font-size:90%;">  </span><span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span><span id="algorithm1.15.15.3" class="ltx_text" style="font-size:90%;">   </span><span id="algorithm1.15.15.4" class="ltx_text" style="font-size:90%;">
</span><span id="algorithm1.15.15.5" class="ltx_text ltx_font_bold" style="font-size:90%;">for</span><span id="algorithm1.15.15.6" class="ltx_text" style="font-size:90%;"> </span><math id="algorithm1.15.15.m1.1" class="ltx_Math" alttext="C_{i}\in\mathcal{S}" display="inline"><semantics id="algorithm1.15.15.m1.1a"><mrow id="algorithm1.15.15.m1.1.1" xref="algorithm1.15.15.m1.1.1.cmml"><msub id="algorithm1.15.15.m1.1.1.2" xref="algorithm1.15.15.m1.1.1.2.cmml"><mi mathsize="90%" id="algorithm1.15.15.m1.1.1.2.2" xref="algorithm1.15.15.m1.1.1.2.2.cmml">C</mi><mi mathsize="90%" id="algorithm1.15.15.m1.1.1.2.3" xref="algorithm1.15.15.m1.1.1.2.3.cmml">i</mi></msub><mo mathsize="90%" id="algorithm1.15.15.m1.1.1.1" xref="algorithm1.15.15.m1.1.1.1.cmml">∈</mo><mi class="ltx_font_mathcaligraphic" mathsize="90%" id="algorithm1.15.15.m1.1.1.3" xref="algorithm1.15.15.m1.1.1.3.cmml">𝒮</mi></mrow><annotation-xml encoding="MathML-Content" id="algorithm1.15.15.m1.1b"><apply id="algorithm1.15.15.m1.1.1.cmml" xref="algorithm1.15.15.m1.1.1"><in id="algorithm1.15.15.m1.1.1.1.cmml" xref="algorithm1.15.15.m1.1.1.1"></in><apply id="algorithm1.15.15.m1.1.1.2.cmml" xref="algorithm1.15.15.m1.1.1.2"><csymbol cd="ambiguous" id="algorithm1.15.15.m1.1.1.2.1.cmml" xref="algorithm1.15.15.m1.1.1.2">subscript</csymbol><ci id="algorithm1.15.15.m1.1.1.2.2.cmml" xref="algorithm1.15.15.m1.1.1.2.2">𝐶</ci><ci id="algorithm1.15.15.m1.1.1.2.3.cmml" xref="algorithm1.15.15.m1.1.1.2.3">𝑖</ci></apply><ci id="algorithm1.15.15.m1.1.1.3.cmml" xref="algorithm1.15.15.m1.1.1.3">𝒮</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="algorithm1.15.15.m1.1c">C_{i}\in\mathcal{S}</annotation></semantics></math><span id="algorithm1.15.15.7" class="ltx_text" style="font-size:90%;"> </span><span id="algorithm1.15.15.8" class="ltx_text ltx_font_bold" style="font-size:90%;">in parallel</span><span id="algorithm1.15.15.9" class="ltx_text" style="font-size:90%;"> </span><span id="algorithm1.15.15.10" class="ltx_text ltx_font_bold" style="font-size:90%;">do</span>
</div>
<div id="algorithm1.17.17" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="algorithm1.17.17.1.1.1" class="ltx_text" style="font-size:90%;">5</span></span><span id="algorithm1.17.17.2" class="ltx_text" style="font-size:90%;">  </span><span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span><span id="algorithm1.17.17.3" class="ltx_text" style="font-size:90%;">     </span><span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span><span id="algorithm1.17.17.4" class="ltx_text" style="font-size:90%;">   </span><span id="algorithm1.17.17.5" class="ltx_text" style="font-size:90%;">
send the aggregated model </span><math id="algorithm1.16.16.m1.1" class="ltx_Math" alttext="w^{t}" display="inline"><semantics id="algorithm1.16.16.m1.1a"><msup id="algorithm1.16.16.m1.1.1" xref="algorithm1.16.16.m1.1.1.cmml"><mi mathsize="90%" id="algorithm1.16.16.m1.1.1.2" xref="algorithm1.16.16.m1.1.1.2.cmml">w</mi><mi mathsize="90%" id="algorithm1.16.16.m1.1.1.3" xref="algorithm1.16.16.m1.1.1.3.cmml">t</mi></msup><annotation-xml encoding="MathML-Content" id="algorithm1.16.16.m1.1b"><apply id="algorithm1.16.16.m1.1.1.cmml" xref="algorithm1.16.16.m1.1.1"><csymbol cd="ambiguous" id="algorithm1.16.16.m1.1.1.1.cmml" xref="algorithm1.16.16.m1.1.1">superscript</csymbol><ci id="algorithm1.16.16.m1.1.1.2.cmml" xref="algorithm1.16.16.m1.1.1.2">𝑤</ci><ci id="algorithm1.16.16.m1.1.1.3.cmml" xref="algorithm1.16.16.m1.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="algorithm1.16.16.m1.1c">w^{t}</annotation></semantics></math><span id="algorithm1.17.17.6" class="ltx_text" style="font-size:90%;"> to </span><math id="algorithm1.17.17.m2.1" class="ltx_Math" alttext="C_{i}" display="inline"><semantics id="algorithm1.17.17.m2.1a"><msub id="algorithm1.17.17.m2.1.1" xref="algorithm1.17.17.m2.1.1.cmml"><mi mathsize="90%" id="algorithm1.17.17.m2.1.1.2" xref="algorithm1.17.17.m2.1.1.2.cmml">C</mi><mi mathsize="90%" id="algorithm1.17.17.m2.1.1.3" xref="algorithm1.17.17.m2.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="algorithm1.17.17.m2.1b"><apply id="algorithm1.17.17.m2.1.1.cmml" xref="algorithm1.17.17.m2.1.1"><csymbol cd="ambiguous" id="algorithm1.17.17.m2.1.1.1.cmml" xref="algorithm1.17.17.m2.1.1">subscript</csymbol><ci id="algorithm1.17.17.m2.1.1.2.cmml" xref="algorithm1.17.17.m2.1.1.2">𝐶</ci><ci id="algorithm1.17.17.m2.1.1.3.cmml" xref="algorithm1.17.17.m2.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="algorithm1.17.17.m2.1c">C_{i}</annotation></semantics></math><span id="algorithm1.17.17.7" class="ltx_text" style="font-size:90%;">
</span>
</div>
<div id="algorithm1.20.20" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="algorithm1.20.20.1.1.1" class="ltx_text" style="font-size:90%;">6</span></span><span id="algorithm1.20.20.2" class="ltx_text" style="font-size:90%;">  </span><span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span><span id="algorithm1.20.20.3" class="ltx_text" style="font-size:90%;">     </span><span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span><span id="algorithm1.20.20.4" class="ltx_text" style="font-size:90%;">   </span><math id="algorithm1.18.18.m1.1" class="ltx_Math" alttext="w_{i}^{t}\leftarrow" display="inline"><semantics id="algorithm1.18.18.m1.1a"><mrow id="algorithm1.18.18.m1.1.1" xref="algorithm1.18.18.m1.1.1.cmml"><msubsup id="algorithm1.18.18.m1.1.1.2" xref="algorithm1.18.18.m1.1.1.2.cmml"><mi mathsize="90%" id="algorithm1.18.18.m1.1.1.2.2.2" xref="algorithm1.18.18.m1.1.1.2.2.2.cmml">w</mi><mi mathsize="90%" id="algorithm1.18.18.m1.1.1.2.2.3" xref="algorithm1.18.18.m1.1.1.2.2.3.cmml">i</mi><mi mathsize="90%" id="algorithm1.18.18.m1.1.1.2.3" xref="algorithm1.18.18.m1.1.1.2.3.cmml">t</mi></msubsup><mo mathsize="90%" stretchy="false" id="algorithm1.18.18.m1.1.1.1" xref="algorithm1.18.18.m1.1.1.1.cmml">←</mo><mi id="algorithm1.18.18.m1.1.1.3" xref="algorithm1.18.18.m1.1.1.3.cmml"></mi></mrow><annotation-xml encoding="MathML-Content" id="algorithm1.18.18.m1.1b"><apply id="algorithm1.18.18.m1.1.1.cmml" xref="algorithm1.18.18.m1.1.1"><ci id="algorithm1.18.18.m1.1.1.1.cmml" xref="algorithm1.18.18.m1.1.1.1">←</ci><apply id="algorithm1.18.18.m1.1.1.2.cmml" xref="algorithm1.18.18.m1.1.1.2"><csymbol cd="ambiguous" id="algorithm1.18.18.m1.1.1.2.1.cmml" xref="algorithm1.18.18.m1.1.1.2">superscript</csymbol><apply id="algorithm1.18.18.m1.1.1.2.2.cmml" xref="algorithm1.18.18.m1.1.1.2"><csymbol cd="ambiguous" id="algorithm1.18.18.m1.1.1.2.2.1.cmml" xref="algorithm1.18.18.m1.1.1.2">subscript</csymbol><ci id="algorithm1.18.18.m1.1.1.2.2.2.cmml" xref="algorithm1.18.18.m1.1.1.2.2.2">𝑤</ci><ci id="algorithm1.18.18.m1.1.1.2.2.3.cmml" xref="algorithm1.18.18.m1.1.1.2.2.3">𝑖</ci></apply><ci id="algorithm1.18.18.m1.1.1.2.3.cmml" xref="algorithm1.18.18.m1.1.1.2.3">𝑡</ci></apply><csymbol cd="latexml" id="algorithm1.18.18.m1.1.1.3.cmml" xref="algorithm1.18.18.m1.1.1.3">absent</csymbol></apply></annotation-xml><annotation encoding="application/x-tex" id="algorithm1.18.18.m1.1c">w_{i}^{t}\leftarrow</annotation></semantics></math><span id="algorithm1.20.20.5" class="ltx_text" style="font-size:90%;"> </span><span id="algorithm1.20.20.6" class="ltx_text ltx_font_bold" style="font-size:90%;">LocalTraining</span><span id="algorithm1.20.20.7" class="ltx_text" style="font-size:90%;">(</span><math id="algorithm1.19.19.m2.1" class="ltx_Math" alttext="i" display="inline"><semantics id="algorithm1.19.19.m2.1a"><mi mathsize="90%" id="algorithm1.19.19.m2.1.1" xref="algorithm1.19.19.m2.1.1.cmml">i</mi><annotation-xml encoding="MathML-Content" id="algorithm1.19.19.m2.1b"><ci id="algorithm1.19.19.m2.1.1.cmml" xref="algorithm1.19.19.m2.1.1">𝑖</ci></annotation-xml><annotation encoding="application/x-tex" id="algorithm1.19.19.m2.1c">i</annotation></semantics></math><span id="algorithm1.20.20.8" class="ltx_text" style="font-size:90%;">, </span><math id="algorithm1.20.20.m3.1" class="ltx_Math" alttext="w^{t}" display="inline"><semantics id="algorithm1.20.20.m3.1a"><msup id="algorithm1.20.20.m3.1.1" xref="algorithm1.20.20.m3.1.1.cmml"><mi mathsize="90%" id="algorithm1.20.20.m3.1.1.2" xref="algorithm1.20.20.m3.1.1.2.cmml">w</mi><mi mathsize="90%" id="algorithm1.20.20.m3.1.1.3" xref="algorithm1.20.20.m3.1.1.3.cmml">t</mi></msup><annotation-xml encoding="MathML-Content" id="algorithm1.20.20.m3.1b"><apply id="algorithm1.20.20.m3.1.1.cmml" xref="algorithm1.20.20.m3.1.1"><csymbol cd="ambiguous" id="algorithm1.20.20.m3.1.1.1.cmml" xref="algorithm1.20.20.m3.1.1">superscript</csymbol><ci id="algorithm1.20.20.m3.1.1.2.cmml" xref="algorithm1.20.20.m3.1.1.2">𝑤</ci><ci id="algorithm1.20.20.m3.1.1.3.cmml" xref="algorithm1.20.20.m3.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="algorithm1.20.20.m3.1c">w^{t}</annotation></semantics></math><span id="algorithm1.20.20.9" class="ltx_text" style="font-size:90%;">)
</span>
</div>
<div id="algorithm1.21.21" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="algorithm1.21.21.1.1.1" class="ltx_text" style="font-size:90%;">7</span></span><span id="algorithm1.21.21.2" class="ltx_text" style="font-size:90%;">  </span><span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span><span id="algorithm1.21.21.3" class="ltx_text" style="font-size:90%;">   </span><math id="algorithm1.21.21.m1.3" class="ltx_Math" alttext="w^{t+1}\leftarrow\sum_{k=1}^{\left\|\mathcal{S}\right\|}\frac{|\mathcal{D}^{i}|}{|\mathcal{D}|}w_{k}^{t}" display="inline"><semantics id="algorithm1.21.21.m1.3a"><mrow id="algorithm1.21.21.m1.3.4" xref="algorithm1.21.21.m1.3.4.cmml"><msup id="algorithm1.21.21.m1.3.4.2" xref="algorithm1.21.21.m1.3.4.2.cmml"><mi mathsize="90%" id="algorithm1.21.21.m1.3.4.2.2" xref="algorithm1.21.21.m1.3.4.2.2.cmml">w</mi><mrow id="algorithm1.21.21.m1.3.4.2.3" xref="algorithm1.21.21.m1.3.4.2.3.cmml"><mi mathsize="90%" id="algorithm1.21.21.m1.3.4.2.3.2" xref="algorithm1.21.21.m1.3.4.2.3.2.cmml">t</mi><mo mathsize="90%" id="algorithm1.21.21.m1.3.4.2.3.1" xref="algorithm1.21.21.m1.3.4.2.3.1.cmml">+</mo><mn mathsize="90%" id="algorithm1.21.21.m1.3.4.2.3.3" xref="algorithm1.21.21.m1.3.4.2.3.3.cmml">1</mn></mrow></msup><mo mathsize="90%" rspace="0.111em" stretchy="false" id="algorithm1.21.21.m1.3.4.1" xref="algorithm1.21.21.m1.3.4.1.cmml">←</mo><mrow id="algorithm1.21.21.m1.3.4.3" xref="algorithm1.21.21.m1.3.4.3.cmml"><msubsup id="algorithm1.21.21.m1.3.4.3.1" xref="algorithm1.21.21.m1.3.4.3.1.cmml"><mo maxsize="90%" minsize="90%" stretchy="true" id="algorithm1.21.21.m1.3.4.3.1.2.2" xref="algorithm1.21.21.m1.3.4.3.1.2.2.cmml">∑</mo><mrow id="algorithm1.21.21.m1.3.4.3.1.2.3" xref="algorithm1.21.21.m1.3.4.3.1.2.3.cmml"><mi mathsize="90%" id="algorithm1.21.21.m1.3.4.3.1.2.3.2" xref="algorithm1.21.21.m1.3.4.3.1.2.3.2.cmml">k</mi><mo mathsize="90%" id="algorithm1.21.21.m1.3.4.3.1.2.3.1" xref="algorithm1.21.21.m1.3.4.3.1.2.3.1.cmml">=</mo><mn mathsize="90%" id="algorithm1.21.21.m1.3.4.3.1.2.3.3" xref="algorithm1.21.21.m1.3.4.3.1.2.3.3.cmml">1</mn></mrow><mrow id="algorithm1.21.21.m1.1.1.1.3" xref="algorithm1.21.21.m1.1.1.1.2.cmml"><mo id="algorithm1.21.21.m1.1.1.1.3.1" xref="algorithm1.21.21.m1.1.1.1.2.1.cmml">‖</mo><mi class="ltx_font_mathcaligraphic" mathsize="90%" id="algorithm1.21.21.m1.1.1.1.1" xref="algorithm1.21.21.m1.1.1.1.1.cmml">𝒮</mi><mo id="algorithm1.21.21.m1.1.1.1.3.2" xref="algorithm1.21.21.m1.1.1.1.2.1.cmml">‖</mo></mrow></msubsup><mrow id="algorithm1.21.21.m1.3.4.3.2" xref="algorithm1.21.21.m1.3.4.3.2.cmml"><mfrac id="algorithm1.21.21.m1.3.3" xref="algorithm1.21.21.m1.3.3.cmml"><mrow id="algorithm1.21.21.m1.2.2.1.1" xref="algorithm1.21.21.m1.2.2.1.2.cmml"><mo maxsize="90%" minsize="90%" id="algorithm1.21.21.m1.2.2.1.1.2" xref="algorithm1.21.21.m1.2.2.1.2.1.cmml">|</mo><msup id="algorithm1.21.21.m1.2.2.1.1.1" xref="algorithm1.21.21.m1.2.2.1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" mathsize="90%" id="algorithm1.21.21.m1.2.2.1.1.1.2" xref="algorithm1.21.21.m1.2.2.1.1.1.2.cmml">𝒟</mi><mi mathsize="90%" id="algorithm1.21.21.m1.2.2.1.1.1.3" xref="algorithm1.21.21.m1.2.2.1.1.1.3.cmml">i</mi></msup><mo maxsize="90%" minsize="90%" id="algorithm1.21.21.m1.2.2.1.1.3" xref="algorithm1.21.21.m1.2.2.1.2.1.cmml">|</mo></mrow><mrow id="algorithm1.21.21.m1.3.3.2.3" xref="algorithm1.21.21.m1.3.3.2.2.cmml"><mo maxsize="90%" minsize="90%" id="algorithm1.21.21.m1.3.3.2.3.1" xref="algorithm1.21.21.m1.3.3.2.2.1.cmml">|</mo><mi class="ltx_font_mathcaligraphic" mathsize="90%" id="algorithm1.21.21.m1.3.3.2.1" xref="algorithm1.21.21.m1.3.3.2.1.cmml">𝒟</mi><mo maxsize="90%" minsize="90%" id="algorithm1.21.21.m1.3.3.2.3.2" xref="algorithm1.21.21.m1.3.3.2.2.1.cmml">|</mo></mrow></mfrac><mo lspace="0em" rspace="0em" id="algorithm1.21.21.m1.3.4.3.2.1" xref="algorithm1.21.21.m1.3.4.3.2.1.cmml">​</mo><msubsup id="algorithm1.21.21.m1.3.4.3.2.2" xref="algorithm1.21.21.m1.3.4.3.2.2.cmml"><mi mathsize="90%" id="algorithm1.21.21.m1.3.4.3.2.2.2.2" xref="algorithm1.21.21.m1.3.4.3.2.2.2.2.cmml">w</mi><mi mathsize="90%" id="algorithm1.21.21.m1.3.4.3.2.2.2.3" xref="algorithm1.21.21.m1.3.4.3.2.2.2.3.cmml">k</mi><mi mathsize="90%" id="algorithm1.21.21.m1.3.4.3.2.2.3" xref="algorithm1.21.21.m1.3.4.3.2.2.3.cmml">t</mi></msubsup></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="algorithm1.21.21.m1.3b"><apply id="algorithm1.21.21.m1.3.4.cmml" xref="algorithm1.21.21.m1.3.4"><ci id="algorithm1.21.21.m1.3.4.1.cmml" xref="algorithm1.21.21.m1.3.4.1">←</ci><apply id="algorithm1.21.21.m1.3.4.2.cmml" xref="algorithm1.21.21.m1.3.4.2"><csymbol cd="ambiguous" id="algorithm1.21.21.m1.3.4.2.1.cmml" xref="algorithm1.21.21.m1.3.4.2">superscript</csymbol><ci id="algorithm1.21.21.m1.3.4.2.2.cmml" xref="algorithm1.21.21.m1.3.4.2.2">𝑤</ci><apply id="algorithm1.21.21.m1.3.4.2.3.cmml" xref="algorithm1.21.21.m1.3.4.2.3"><plus id="algorithm1.21.21.m1.3.4.2.3.1.cmml" xref="algorithm1.21.21.m1.3.4.2.3.1"></plus><ci id="algorithm1.21.21.m1.3.4.2.3.2.cmml" xref="algorithm1.21.21.m1.3.4.2.3.2">𝑡</ci><cn type="integer" id="algorithm1.21.21.m1.3.4.2.3.3.cmml" xref="algorithm1.21.21.m1.3.4.2.3.3">1</cn></apply></apply><apply id="algorithm1.21.21.m1.3.4.3.cmml" xref="algorithm1.21.21.m1.3.4.3"><apply id="algorithm1.21.21.m1.3.4.3.1.cmml" xref="algorithm1.21.21.m1.3.4.3.1"><csymbol cd="ambiguous" id="algorithm1.21.21.m1.3.4.3.1.1.cmml" xref="algorithm1.21.21.m1.3.4.3.1">superscript</csymbol><apply id="algorithm1.21.21.m1.3.4.3.1.2.cmml" xref="algorithm1.21.21.m1.3.4.3.1"><csymbol cd="ambiguous" id="algorithm1.21.21.m1.3.4.3.1.2.1.cmml" xref="algorithm1.21.21.m1.3.4.3.1">subscript</csymbol><sum id="algorithm1.21.21.m1.3.4.3.1.2.2.cmml" xref="algorithm1.21.21.m1.3.4.3.1.2.2"></sum><apply id="algorithm1.21.21.m1.3.4.3.1.2.3.cmml" xref="algorithm1.21.21.m1.3.4.3.1.2.3"><eq id="algorithm1.21.21.m1.3.4.3.1.2.3.1.cmml" xref="algorithm1.21.21.m1.3.4.3.1.2.3.1"></eq><ci id="algorithm1.21.21.m1.3.4.3.1.2.3.2.cmml" xref="algorithm1.21.21.m1.3.4.3.1.2.3.2">𝑘</ci><cn type="integer" id="algorithm1.21.21.m1.3.4.3.1.2.3.3.cmml" xref="algorithm1.21.21.m1.3.4.3.1.2.3.3">1</cn></apply></apply><apply id="algorithm1.21.21.m1.1.1.1.2.cmml" xref="algorithm1.21.21.m1.1.1.1.3"><csymbol cd="latexml" id="algorithm1.21.21.m1.1.1.1.2.1.cmml" xref="algorithm1.21.21.m1.1.1.1.3.1">norm</csymbol><ci id="algorithm1.21.21.m1.1.1.1.1.cmml" xref="algorithm1.21.21.m1.1.1.1.1">𝒮</ci></apply></apply><apply id="algorithm1.21.21.m1.3.4.3.2.cmml" xref="algorithm1.21.21.m1.3.4.3.2"><times id="algorithm1.21.21.m1.3.4.3.2.1.cmml" xref="algorithm1.21.21.m1.3.4.3.2.1"></times><apply id="algorithm1.21.21.m1.3.3.cmml" xref="algorithm1.21.21.m1.3.3"><divide id="algorithm1.21.21.m1.3.3.3.cmml" xref="algorithm1.21.21.m1.3.3"></divide><apply id="algorithm1.21.21.m1.2.2.1.2.cmml" xref="algorithm1.21.21.m1.2.2.1.1"><abs id="algorithm1.21.21.m1.2.2.1.2.1.cmml" xref="algorithm1.21.21.m1.2.2.1.1.2"></abs><apply id="algorithm1.21.21.m1.2.2.1.1.1.cmml" xref="algorithm1.21.21.m1.2.2.1.1.1"><csymbol cd="ambiguous" id="algorithm1.21.21.m1.2.2.1.1.1.1.cmml" xref="algorithm1.21.21.m1.2.2.1.1.1">superscript</csymbol><ci id="algorithm1.21.21.m1.2.2.1.1.1.2.cmml" xref="algorithm1.21.21.m1.2.2.1.1.1.2">𝒟</ci><ci id="algorithm1.21.21.m1.2.2.1.1.1.3.cmml" xref="algorithm1.21.21.m1.2.2.1.1.1.3">𝑖</ci></apply></apply><apply id="algorithm1.21.21.m1.3.3.2.2.cmml" xref="algorithm1.21.21.m1.3.3.2.3"><abs id="algorithm1.21.21.m1.3.3.2.2.1.cmml" xref="algorithm1.21.21.m1.3.3.2.3.1"></abs><ci id="algorithm1.21.21.m1.3.3.2.1.cmml" xref="algorithm1.21.21.m1.3.3.2.1">𝒟</ci></apply></apply><apply id="algorithm1.21.21.m1.3.4.3.2.2.cmml" xref="algorithm1.21.21.m1.3.4.3.2.2"><csymbol cd="ambiguous" id="algorithm1.21.21.m1.3.4.3.2.2.1.cmml" xref="algorithm1.21.21.m1.3.4.3.2.2">superscript</csymbol><apply id="algorithm1.21.21.m1.3.4.3.2.2.2.cmml" xref="algorithm1.21.21.m1.3.4.3.2.2"><csymbol cd="ambiguous" id="algorithm1.21.21.m1.3.4.3.2.2.2.1.cmml" xref="algorithm1.21.21.m1.3.4.3.2.2">subscript</csymbol><ci id="algorithm1.21.21.m1.3.4.3.2.2.2.2.cmml" xref="algorithm1.21.21.m1.3.4.3.2.2.2.2">𝑤</ci><ci id="algorithm1.21.21.m1.3.4.3.2.2.2.3.cmml" xref="algorithm1.21.21.m1.3.4.3.2.2.2.3">𝑘</ci></apply><ci id="algorithm1.21.21.m1.3.4.3.2.2.3.cmml" xref="algorithm1.21.21.m1.3.4.3.2.2.3">𝑡</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="algorithm1.21.21.m1.3c">w^{t+1}\leftarrow\sum_{k=1}^{\left\|\mathcal{S}\right\|}\frac{|\mathcal{D}^{i}|}{|\mathcal{D}|}w_{k}^{t}</annotation></semantics></math><span id="algorithm1.21.21.4" class="ltx_text" style="font-size:90%;">
</span>
</div>
<div id="algorithm1.25.25" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="algorithm1.25.25.1.1.1" class="ltx_text" style="font-size:90%;">8</span></span><span id="algorithm1.25.25.2" class="ltx_text" style="font-size:90%;">return </span><math id="algorithm1.22.22.m1.1" class="ltx_Math" alttext="w^{T}" display="inline"><semantics id="algorithm1.22.22.m1.1a"><msup id="algorithm1.22.22.m1.1.1" xref="algorithm1.22.22.m1.1.1.cmml"><mi mathsize="90%" id="algorithm1.22.22.m1.1.1.2" xref="algorithm1.22.22.m1.1.1.2.cmml">w</mi><mi mathsize="90%" id="algorithm1.22.22.m1.1.1.3" xref="algorithm1.22.22.m1.1.1.3.cmml">T</mi></msup><annotation-xml encoding="MathML-Content" id="algorithm1.22.22.m1.1b"><apply id="algorithm1.22.22.m1.1.1.cmml" xref="algorithm1.22.22.m1.1.1"><csymbol cd="ambiguous" id="algorithm1.22.22.m1.1.1.1.cmml" xref="algorithm1.22.22.m1.1.1">superscript</csymbol><ci id="algorithm1.22.22.m1.1.1.2.cmml" xref="algorithm1.22.22.m1.1.1.2">𝑤</ci><ci id="algorithm1.22.22.m1.1.1.3.cmml" xref="algorithm1.22.22.m1.1.1.3">𝑇</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="algorithm1.22.22.m1.1c">w^{T}</annotation></semantics></math><span id="algorithm1.25.25.3" class="ltx_text" style="font-size:90%;">
</span><span id="algorithm1.25.25.4" class="ltx_text ltx_font_bold" style="font-size:90%;">LocalTraining</span><span id="algorithm1.25.25.5" class="ltx_text" style="font-size:90%;">(</span><math id="algorithm1.23.23.m2.1" class="ltx_Math" alttext="i" display="inline"><semantics id="algorithm1.23.23.m2.1a"><mi mathsize="90%" id="algorithm1.23.23.m2.1.1" xref="algorithm1.23.23.m2.1.1.cmml">i</mi><annotation-xml encoding="MathML-Content" id="algorithm1.23.23.m2.1b"><ci id="algorithm1.23.23.m2.1.1.cmml" xref="algorithm1.23.23.m2.1.1">𝑖</ci></annotation-xml><annotation encoding="application/x-tex" id="algorithm1.23.23.m2.1c">i</annotation></semantics></math><span id="algorithm1.25.25.6" class="ltx_text" style="font-size:90%;">, </span><math id="algorithm1.24.24.m3.1" class="ltx_Math" alttext="w^{t}" display="inline"><semantics id="algorithm1.24.24.m3.1a"><msup id="algorithm1.24.24.m3.1.1" xref="algorithm1.24.24.m3.1.1.cmml"><mi mathsize="90%" id="algorithm1.24.24.m3.1.1.2" xref="algorithm1.24.24.m3.1.1.2.cmml">w</mi><mi mathsize="90%" id="algorithm1.24.24.m3.1.1.3" xref="algorithm1.24.24.m3.1.1.3.cmml">t</mi></msup><annotation-xml encoding="MathML-Content" id="algorithm1.24.24.m3.1b"><apply id="algorithm1.24.24.m3.1.1.cmml" xref="algorithm1.24.24.m3.1.1"><csymbol cd="ambiguous" id="algorithm1.24.24.m3.1.1.1.cmml" xref="algorithm1.24.24.m3.1.1">superscript</csymbol><ci id="algorithm1.24.24.m3.1.1.2.cmml" xref="algorithm1.24.24.m3.1.1.2">𝑤</ci><ci id="algorithm1.24.24.m3.1.1.3.cmml" xref="algorithm1.24.24.m3.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="algorithm1.24.24.m3.1c">w^{t}</annotation></semantics></math><span id="algorithm1.25.25.7" class="ltx_text" style="font-size:90%;">):
</span><math id="algorithm1.25.25.m4.1" class="ltx_Math" alttext="w_{i}^{t}\leftarrow w^{t}" display="inline"><semantics id="algorithm1.25.25.m4.1a"><mrow id="algorithm1.25.25.m4.1.1" xref="algorithm1.25.25.m4.1.1.cmml"><msubsup id="algorithm1.25.25.m4.1.1.2" xref="algorithm1.25.25.m4.1.1.2.cmml"><mi mathsize="90%" id="algorithm1.25.25.m4.1.1.2.2.2" xref="algorithm1.25.25.m4.1.1.2.2.2.cmml">w</mi><mi mathsize="90%" id="algorithm1.25.25.m4.1.1.2.2.3" xref="algorithm1.25.25.m4.1.1.2.2.3.cmml">i</mi><mi mathsize="90%" id="algorithm1.25.25.m4.1.1.2.3" xref="algorithm1.25.25.m4.1.1.2.3.cmml">t</mi></msubsup><mo mathsize="90%" stretchy="false" id="algorithm1.25.25.m4.1.1.1" xref="algorithm1.25.25.m4.1.1.1.cmml">←</mo><msup id="algorithm1.25.25.m4.1.1.3" xref="algorithm1.25.25.m4.1.1.3.cmml"><mi mathsize="90%" id="algorithm1.25.25.m4.1.1.3.2" xref="algorithm1.25.25.m4.1.1.3.2.cmml">w</mi><mi mathsize="90%" id="algorithm1.25.25.m4.1.1.3.3" xref="algorithm1.25.25.m4.1.1.3.3.cmml">t</mi></msup></mrow><annotation-xml encoding="MathML-Content" id="algorithm1.25.25.m4.1b"><apply id="algorithm1.25.25.m4.1.1.cmml" xref="algorithm1.25.25.m4.1.1"><ci id="algorithm1.25.25.m4.1.1.1.cmml" xref="algorithm1.25.25.m4.1.1.1">←</ci><apply id="algorithm1.25.25.m4.1.1.2.cmml" xref="algorithm1.25.25.m4.1.1.2"><csymbol cd="ambiguous" id="algorithm1.25.25.m4.1.1.2.1.cmml" xref="algorithm1.25.25.m4.1.1.2">superscript</csymbol><apply id="algorithm1.25.25.m4.1.1.2.2.cmml" xref="algorithm1.25.25.m4.1.1.2"><csymbol cd="ambiguous" id="algorithm1.25.25.m4.1.1.2.2.1.cmml" xref="algorithm1.25.25.m4.1.1.2">subscript</csymbol><ci id="algorithm1.25.25.m4.1.1.2.2.2.cmml" xref="algorithm1.25.25.m4.1.1.2.2.2">𝑤</ci><ci id="algorithm1.25.25.m4.1.1.2.2.3.cmml" xref="algorithm1.25.25.m4.1.1.2.2.3">𝑖</ci></apply><ci id="algorithm1.25.25.m4.1.1.2.3.cmml" xref="algorithm1.25.25.m4.1.1.2.3">𝑡</ci></apply><apply id="algorithm1.25.25.m4.1.1.3.cmml" xref="algorithm1.25.25.m4.1.1.3"><csymbol cd="ambiguous" id="algorithm1.25.25.m4.1.1.3.1.cmml" xref="algorithm1.25.25.m4.1.1.3">superscript</csymbol><ci id="algorithm1.25.25.m4.1.1.3.2.cmml" xref="algorithm1.25.25.m4.1.1.3.2">𝑤</ci><ci id="algorithm1.25.25.m4.1.1.3.3.cmml" xref="algorithm1.25.25.m4.1.1.3.3">𝑡</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="algorithm1.25.25.m4.1c">w_{i}^{t}\leftarrow w^{t}</annotation></semantics></math><span id="algorithm1.25.25.8" class="ltx_text" style="font-size:90%;">
</span>
</div>
<div id="algorithm1.26.26" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="algorithm1.26.26.1.1.1" class="ltx_text" style="font-size:90%;">9</span></span><span id="algorithm1.26.26.2" class="ltx_text ltx_font_bold" style="font-size:90%;">for</span><span id="algorithm1.26.26.3" class="ltx_text" style="font-size:90%;"> epoch </span><math id="algorithm1.26.26.m1.4" class="ltx_Math" alttext="i=1,2,...,E_{g}" display="inline"><semantics id="algorithm1.26.26.m1.4a"><mrow id="algorithm1.26.26.m1.4.4" xref="algorithm1.26.26.m1.4.4.cmml"><mi mathsize="90%" id="algorithm1.26.26.m1.4.4.3" xref="algorithm1.26.26.m1.4.4.3.cmml">i</mi><mo mathsize="90%" id="algorithm1.26.26.m1.4.4.2" xref="algorithm1.26.26.m1.4.4.2.cmml">=</mo><mrow id="algorithm1.26.26.m1.4.4.1.1" xref="algorithm1.26.26.m1.4.4.1.2.cmml"><mn mathsize="90%" id="algorithm1.26.26.m1.1.1" xref="algorithm1.26.26.m1.1.1.cmml">1</mn><mo mathsize="90%" id="algorithm1.26.26.m1.4.4.1.1.2" xref="algorithm1.26.26.m1.4.4.1.2.cmml">,</mo><mn mathsize="90%" id="algorithm1.26.26.m1.2.2" xref="algorithm1.26.26.m1.2.2.cmml">2</mn><mo mathsize="90%" id="algorithm1.26.26.m1.4.4.1.1.3" xref="algorithm1.26.26.m1.4.4.1.2.cmml">,</mo><mi mathsize="90%" mathvariant="normal" id="algorithm1.26.26.m1.3.3" xref="algorithm1.26.26.m1.3.3.cmml">…</mi><mo mathsize="90%" id="algorithm1.26.26.m1.4.4.1.1.4" xref="algorithm1.26.26.m1.4.4.1.2.cmml">,</mo><msub id="algorithm1.26.26.m1.4.4.1.1.1" xref="algorithm1.26.26.m1.4.4.1.1.1.cmml"><mi mathsize="90%" id="algorithm1.26.26.m1.4.4.1.1.1.2" xref="algorithm1.26.26.m1.4.4.1.1.1.2.cmml">E</mi><mi mathsize="90%" id="algorithm1.26.26.m1.4.4.1.1.1.3" xref="algorithm1.26.26.m1.4.4.1.1.1.3.cmml">g</mi></msub></mrow></mrow><annotation-xml encoding="MathML-Content" id="algorithm1.26.26.m1.4b"><apply id="algorithm1.26.26.m1.4.4.cmml" xref="algorithm1.26.26.m1.4.4"><eq id="algorithm1.26.26.m1.4.4.2.cmml" xref="algorithm1.26.26.m1.4.4.2"></eq><ci id="algorithm1.26.26.m1.4.4.3.cmml" xref="algorithm1.26.26.m1.4.4.3">𝑖</ci><list id="algorithm1.26.26.m1.4.4.1.2.cmml" xref="algorithm1.26.26.m1.4.4.1.1"><cn type="integer" id="algorithm1.26.26.m1.1.1.cmml" xref="algorithm1.26.26.m1.1.1">1</cn><cn type="integer" id="algorithm1.26.26.m1.2.2.cmml" xref="algorithm1.26.26.m1.2.2">2</cn><ci id="algorithm1.26.26.m1.3.3.cmml" xref="algorithm1.26.26.m1.3.3">…</ci><apply id="algorithm1.26.26.m1.4.4.1.1.1.cmml" xref="algorithm1.26.26.m1.4.4.1.1.1"><csymbol cd="ambiguous" id="algorithm1.26.26.m1.4.4.1.1.1.1.cmml" xref="algorithm1.26.26.m1.4.4.1.1.1">subscript</csymbol><ci id="algorithm1.26.26.m1.4.4.1.1.1.2.cmml" xref="algorithm1.26.26.m1.4.4.1.1.1.2">𝐸</ci><ci id="algorithm1.26.26.m1.4.4.1.1.1.3.cmml" xref="algorithm1.26.26.m1.4.4.1.1.1.3">𝑔</ci></apply></list></apply></annotation-xml><annotation encoding="application/x-tex" id="algorithm1.26.26.m1.4c">i=1,2,...,E_{g}</annotation></semantics></math><span id="algorithm1.26.26.4" class="ltx_text" style="font-size:90%;"> </span><span id="algorithm1.26.26.5" class="ltx_text ltx_font_bold" style="font-size:90%;">do</span>
</div>
<div id="algorithm1.28.28" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="algorithm1.28.28.1.1.1" class="ltx_text" style="font-size:90%;">10</span></span><span id="algorithm1.28.28.2" class="ltx_text" style="font-size:90%;">  </span><span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span><span id="algorithm1.28.28.3" class="ltx_text" style="font-size:90%;">   </span><span id="algorithm1.28.28.4" class="ltx_text" style="font-size:90%;">
</span><span id="algorithm1.28.28.5" class="ltx_text ltx_font_bold" style="font-size:90%;">for</span><span id="algorithm1.28.28.6" class="ltx_text" style="font-size:90%;"> each batch </span><math id="algorithm1.27.27.m1.2" class="ltx_Math" alttext="\textbf{b}=\{x,y\}" display="inline"><semantics id="algorithm1.27.27.m1.2a"><mrow id="algorithm1.27.27.m1.2.3" xref="algorithm1.27.27.m1.2.3.cmml"><mtext class="ltx_mathvariant_bold" mathsize="90%" id="algorithm1.27.27.m1.2.3.2" xref="algorithm1.27.27.m1.2.3.2a.cmml">b</mtext><mo mathsize="90%" id="algorithm1.27.27.m1.2.3.1" xref="algorithm1.27.27.m1.2.3.1.cmml">=</mo><mrow id="algorithm1.27.27.m1.2.3.3.2" xref="algorithm1.27.27.m1.2.3.3.1.cmml"><mo maxsize="90%" minsize="90%" id="algorithm1.27.27.m1.2.3.3.2.1" xref="algorithm1.27.27.m1.2.3.3.1.cmml">{</mo><mi mathsize="90%" id="algorithm1.27.27.m1.1.1" xref="algorithm1.27.27.m1.1.1.cmml">x</mi><mo mathsize="90%" id="algorithm1.27.27.m1.2.3.3.2.2" xref="algorithm1.27.27.m1.2.3.3.1.cmml">,</mo><mi mathsize="90%" id="algorithm1.27.27.m1.2.2" xref="algorithm1.27.27.m1.2.2.cmml">y</mi><mo maxsize="90%" minsize="90%" id="algorithm1.27.27.m1.2.3.3.2.3" xref="algorithm1.27.27.m1.2.3.3.1.cmml">}</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="algorithm1.27.27.m1.2b"><apply id="algorithm1.27.27.m1.2.3.cmml" xref="algorithm1.27.27.m1.2.3"><eq id="algorithm1.27.27.m1.2.3.1.cmml" xref="algorithm1.27.27.m1.2.3.1"></eq><ci id="algorithm1.27.27.m1.2.3.2a.cmml" xref="algorithm1.27.27.m1.2.3.2"><mtext class="ltx_mathvariant_bold" mathsize="90%" id="algorithm1.27.27.m1.2.3.2.cmml" xref="algorithm1.27.27.m1.2.3.2">b</mtext></ci><set id="algorithm1.27.27.m1.2.3.3.1.cmml" xref="algorithm1.27.27.m1.2.3.3.2"><ci id="algorithm1.27.27.m1.1.1.cmml" xref="algorithm1.27.27.m1.1.1">𝑥</ci><ci id="algorithm1.27.27.m1.2.2.cmml" xref="algorithm1.27.27.m1.2.2">𝑦</ci></set></apply></annotation-xml><annotation encoding="application/x-tex" id="algorithm1.27.27.m1.2c">\textbf{b}=\{x,y\}</annotation></semantics></math><span id="algorithm1.28.28.7" class="ltx_text" style="font-size:90%;"> of </span><math id="algorithm1.28.28.m2.1" class="ltx_Math" alttext="\mathcal{D}^{i}" display="inline"><semantics id="algorithm1.28.28.m2.1a"><msup id="algorithm1.28.28.m2.1.1" xref="algorithm1.28.28.m2.1.1.cmml"><mi class="ltx_font_mathcaligraphic" mathsize="90%" id="algorithm1.28.28.m2.1.1.2" xref="algorithm1.28.28.m2.1.1.2.cmml">𝒟</mi><mi mathsize="90%" id="algorithm1.28.28.m2.1.1.3" xref="algorithm1.28.28.m2.1.1.3.cmml">i</mi></msup><annotation-xml encoding="MathML-Content" id="algorithm1.28.28.m2.1b"><apply id="algorithm1.28.28.m2.1.1.cmml" xref="algorithm1.28.28.m2.1.1"><csymbol cd="ambiguous" id="algorithm1.28.28.m2.1.1.1.cmml" xref="algorithm1.28.28.m2.1.1">superscript</csymbol><ci id="algorithm1.28.28.m2.1.1.2.cmml" xref="algorithm1.28.28.m2.1.1.2">𝒟</ci><ci id="algorithm1.28.28.m2.1.1.3.cmml" xref="algorithm1.28.28.m2.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="algorithm1.28.28.m2.1c">\mathcal{D}^{i}</annotation></semantics></math><span id="algorithm1.28.28.8" class="ltx_text" style="font-size:90%;"> </span><span id="algorithm1.28.28.9" class="ltx_text ltx_font_bold" style="font-size:90%;">do</span>
</div>
<div id="algorithm1.29.29" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="algorithm1.29.29.1.1.1" class="ltx_text" style="font-size:90%;">11</span></span><span id="algorithm1.29.29.2" class="ltx_text" style="font-size:90%;">  </span><span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span><span id="algorithm1.29.29.3" class="ltx_text" style="font-size:90%;">     </span><span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span><span id="algorithm1.29.29.4" class="ltx_text" style="font-size:90%;">   </span><span id="algorithm1.29.29.5" class="ltx_text" style="font-size:90%;">
</span><span id="algorithm1.29.29.6" class="ltx_text ltx_font_italic" style="font-size:90%;">Training for prompt generator:</span><span id="algorithm1.29.29.7" class="ltx_text" style="font-size:90%;">
</span><math id="algorithm1.29.29.m1.1" class="ltx_math_unparsed" alttext="\delta_{i}^{t}\leftarrow\delta_{i}^{t}-\eta_{g}\nabla\ell_{i}(w_{i}^{t};(x+\delta_{i},y)))" display="inline"><semantics id="algorithm1.29.29.m1.1a"><mrow id="algorithm1.29.29.m1.1b"><msubsup id="algorithm1.29.29.m1.1.2"><mi mathsize="90%" id="algorithm1.29.29.m1.1.2.2.2">δ</mi><mi mathsize="90%" id="algorithm1.29.29.m1.1.2.2.3">i</mi><mi mathsize="90%" id="algorithm1.29.29.m1.1.2.3">t</mi></msubsup><mo mathsize="90%" stretchy="false" id="algorithm1.29.29.m1.1.3">←</mo><msubsup id="algorithm1.29.29.m1.1.4"><mi mathsize="90%" id="algorithm1.29.29.m1.1.4.2.2">δ</mi><mi mathsize="90%" id="algorithm1.29.29.m1.1.4.2.3">i</mi><mi mathsize="90%" id="algorithm1.29.29.m1.1.4.3">t</mi></msubsup><mo mathsize="90%" id="algorithm1.29.29.m1.1.5">−</mo><msub id="algorithm1.29.29.m1.1.6"><mi mathsize="90%" id="algorithm1.29.29.m1.1.6.2">η</mi><mi mathsize="90%" id="algorithm1.29.29.m1.1.6.3">g</mi></msub><mo lspace="0.167em" mathsize="90%" rspace="0.167em" id="algorithm1.29.29.m1.1.7">∇</mo><msub id="algorithm1.29.29.m1.1.8"><mi mathsize="90%" mathvariant="normal" id="algorithm1.29.29.m1.1.8.2">ℓ</mi><mi mathsize="90%" id="algorithm1.29.29.m1.1.8.3">i</mi></msub><mrow id="algorithm1.29.29.m1.1.9"><mo maxsize="90%" minsize="90%" id="algorithm1.29.29.m1.1.9.1">(</mo><msubsup id="algorithm1.29.29.m1.1.9.2"><mi mathsize="90%" id="algorithm1.29.29.m1.1.9.2.2.2">w</mi><mi mathsize="90%" id="algorithm1.29.29.m1.1.9.2.2.3">i</mi><mi mathsize="90%" id="algorithm1.29.29.m1.1.9.2.3">t</mi></msubsup><mo mathsize="90%" id="algorithm1.29.29.m1.1.9.3">;</mo><mrow id="algorithm1.29.29.m1.1.9.4"><mo maxsize="90%" minsize="90%" id="algorithm1.29.29.m1.1.9.4.1">(</mo><mi mathsize="90%" id="algorithm1.29.29.m1.1.9.4.2">x</mi><mo mathsize="90%" id="algorithm1.29.29.m1.1.9.4.3">+</mo><msub id="algorithm1.29.29.m1.1.9.4.4"><mi mathsize="90%" id="algorithm1.29.29.m1.1.9.4.4.2">δ</mi><mi mathsize="90%" id="algorithm1.29.29.m1.1.9.4.4.3">i</mi></msub><mo mathsize="90%" id="algorithm1.29.29.m1.1.9.4.5">,</mo><mi mathsize="90%" id="algorithm1.29.29.m1.1.1">y</mi><mo maxsize="90%" minsize="90%" id="algorithm1.29.29.m1.1.9.4.6">)</mo></mrow><mo maxsize="90%" minsize="90%" id="algorithm1.29.29.m1.1.9.5">)</mo></mrow><mo maxsize="90%" minsize="90%" id="algorithm1.29.29.m1.1.10">)</mo></mrow><annotation encoding="application/x-tex" id="algorithm1.29.29.m1.1c">\delta_{i}^{t}\leftarrow\delta_{i}^{t}-\eta_{g}\nabla\ell_{i}(w_{i}^{t};(x+\delta_{i},y)))</annotation></semantics></math><span id="algorithm1.29.29.8" class="ltx_text" style="font-size:90%;">
</span>
</div>
<div id="algorithm1.34.35" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="algorithm1.34.35.1.1.1" class="ltx_text" style="font-size:90%;">12</span></span><span id="algorithm1.34.35.2" class="ltx_text" style="font-size:90%;">  </span><span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span><span id="algorithm1.34.35.3" class="ltx_text" style="font-size:90%;">   </span>
</div>
<div id="algorithm1.30.30" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="algorithm1.30.30.1.1.1" class="ltx_text" style="font-size:90%;">13</span></span><span id="algorithm1.30.30.2" class="ltx_text ltx_font_bold" style="font-size:90%;">for</span><span id="algorithm1.30.30.3" class="ltx_text" style="font-size:90%;"> epoch </span><math id="algorithm1.30.30.m1.4" class="ltx_Math" alttext="i=1,2,...,E_{c}" display="inline"><semantics id="algorithm1.30.30.m1.4a"><mrow id="algorithm1.30.30.m1.4.4" xref="algorithm1.30.30.m1.4.4.cmml"><mi mathsize="90%" id="algorithm1.30.30.m1.4.4.3" xref="algorithm1.30.30.m1.4.4.3.cmml">i</mi><mo mathsize="90%" id="algorithm1.30.30.m1.4.4.2" xref="algorithm1.30.30.m1.4.4.2.cmml">=</mo><mrow id="algorithm1.30.30.m1.4.4.1.1" xref="algorithm1.30.30.m1.4.4.1.2.cmml"><mn mathsize="90%" id="algorithm1.30.30.m1.1.1" xref="algorithm1.30.30.m1.1.1.cmml">1</mn><mo mathsize="90%" id="algorithm1.30.30.m1.4.4.1.1.2" xref="algorithm1.30.30.m1.4.4.1.2.cmml">,</mo><mn mathsize="90%" id="algorithm1.30.30.m1.2.2" xref="algorithm1.30.30.m1.2.2.cmml">2</mn><mo mathsize="90%" id="algorithm1.30.30.m1.4.4.1.1.3" xref="algorithm1.30.30.m1.4.4.1.2.cmml">,</mo><mi mathsize="90%" mathvariant="normal" id="algorithm1.30.30.m1.3.3" xref="algorithm1.30.30.m1.3.3.cmml">…</mi><mo mathsize="90%" id="algorithm1.30.30.m1.4.4.1.1.4" xref="algorithm1.30.30.m1.4.4.1.2.cmml">,</mo><msub id="algorithm1.30.30.m1.4.4.1.1.1" xref="algorithm1.30.30.m1.4.4.1.1.1.cmml"><mi mathsize="90%" id="algorithm1.30.30.m1.4.4.1.1.1.2" xref="algorithm1.30.30.m1.4.4.1.1.1.2.cmml">E</mi><mi mathsize="90%" id="algorithm1.30.30.m1.4.4.1.1.1.3" xref="algorithm1.30.30.m1.4.4.1.1.1.3.cmml">c</mi></msub></mrow></mrow><annotation-xml encoding="MathML-Content" id="algorithm1.30.30.m1.4b"><apply id="algorithm1.30.30.m1.4.4.cmml" xref="algorithm1.30.30.m1.4.4"><eq id="algorithm1.30.30.m1.4.4.2.cmml" xref="algorithm1.30.30.m1.4.4.2"></eq><ci id="algorithm1.30.30.m1.4.4.3.cmml" xref="algorithm1.30.30.m1.4.4.3">𝑖</ci><list id="algorithm1.30.30.m1.4.4.1.2.cmml" xref="algorithm1.30.30.m1.4.4.1.1"><cn type="integer" id="algorithm1.30.30.m1.1.1.cmml" xref="algorithm1.30.30.m1.1.1">1</cn><cn type="integer" id="algorithm1.30.30.m1.2.2.cmml" xref="algorithm1.30.30.m1.2.2">2</cn><ci id="algorithm1.30.30.m1.3.3.cmml" xref="algorithm1.30.30.m1.3.3">…</ci><apply id="algorithm1.30.30.m1.4.4.1.1.1.cmml" xref="algorithm1.30.30.m1.4.4.1.1.1"><csymbol cd="ambiguous" id="algorithm1.30.30.m1.4.4.1.1.1.1.cmml" xref="algorithm1.30.30.m1.4.4.1.1.1">subscript</csymbol><ci id="algorithm1.30.30.m1.4.4.1.1.1.2.cmml" xref="algorithm1.30.30.m1.4.4.1.1.1.2">𝐸</ci><ci id="algorithm1.30.30.m1.4.4.1.1.1.3.cmml" xref="algorithm1.30.30.m1.4.4.1.1.1.3">𝑐</ci></apply></list></apply></annotation-xml><annotation encoding="application/x-tex" id="algorithm1.30.30.m1.4c">i=1,2,...,E_{c}</annotation></semantics></math><span id="algorithm1.30.30.4" class="ltx_text" style="font-size:90%;"> </span><span id="algorithm1.30.30.5" class="ltx_text ltx_font_bold" style="font-size:90%;">do</span>
</div>
<div id="algorithm1.32.32" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="algorithm1.32.32.1.1.1" class="ltx_text" style="font-size:90%;">14</span></span><span id="algorithm1.32.32.2" class="ltx_text" style="font-size:90%;">  </span><span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span><span id="algorithm1.32.32.3" class="ltx_text" style="font-size:90%;">   </span><span id="algorithm1.32.32.4" class="ltx_text" style="font-size:90%;">
</span><span id="algorithm1.32.32.5" class="ltx_text ltx_font_bold" style="font-size:90%;">for</span><span id="algorithm1.32.32.6" class="ltx_text" style="font-size:90%;"> each batch </span><math id="algorithm1.31.31.m1.2" class="ltx_Math" alttext="\textbf{b}=\{x,y\}" display="inline"><semantics id="algorithm1.31.31.m1.2a"><mrow id="algorithm1.31.31.m1.2.3" xref="algorithm1.31.31.m1.2.3.cmml"><mtext class="ltx_mathvariant_bold" mathsize="90%" id="algorithm1.31.31.m1.2.3.2" xref="algorithm1.31.31.m1.2.3.2a.cmml">b</mtext><mo mathsize="90%" id="algorithm1.31.31.m1.2.3.1" xref="algorithm1.31.31.m1.2.3.1.cmml">=</mo><mrow id="algorithm1.31.31.m1.2.3.3.2" xref="algorithm1.31.31.m1.2.3.3.1.cmml"><mo maxsize="90%" minsize="90%" id="algorithm1.31.31.m1.2.3.3.2.1" xref="algorithm1.31.31.m1.2.3.3.1.cmml">{</mo><mi mathsize="90%" id="algorithm1.31.31.m1.1.1" xref="algorithm1.31.31.m1.1.1.cmml">x</mi><mo mathsize="90%" id="algorithm1.31.31.m1.2.3.3.2.2" xref="algorithm1.31.31.m1.2.3.3.1.cmml">,</mo><mi mathsize="90%" id="algorithm1.31.31.m1.2.2" xref="algorithm1.31.31.m1.2.2.cmml">y</mi><mo maxsize="90%" minsize="90%" id="algorithm1.31.31.m1.2.3.3.2.3" xref="algorithm1.31.31.m1.2.3.3.1.cmml">}</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="algorithm1.31.31.m1.2b"><apply id="algorithm1.31.31.m1.2.3.cmml" xref="algorithm1.31.31.m1.2.3"><eq id="algorithm1.31.31.m1.2.3.1.cmml" xref="algorithm1.31.31.m1.2.3.1"></eq><ci id="algorithm1.31.31.m1.2.3.2a.cmml" xref="algorithm1.31.31.m1.2.3.2"><mtext class="ltx_mathvariant_bold" mathsize="90%" id="algorithm1.31.31.m1.2.3.2.cmml" xref="algorithm1.31.31.m1.2.3.2">b</mtext></ci><set id="algorithm1.31.31.m1.2.3.3.1.cmml" xref="algorithm1.31.31.m1.2.3.3.2"><ci id="algorithm1.31.31.m1.1.1.cmml" xref="algorithm1.31.31.m1.1.1">𝑥</ci><ci id="algorithm1.31.31.m1.2.2.cmml" xref="algorithm1.31.31.m1.2.2">𝑦</ci></set></apply></annotation-xml><annotation encoding="application/x-tex" id="algorithm1.31.31.m1.2c">\textbf{b}=\{x,y\}</annotation></semantics></math><span id="algorithm1.32.32.7" class="ltx_text" style="font-size:90%;"> of </span><math id="algorithm1.32.32.m2.1" class="ltx_Math" alttext="\mathcal{D}^{i}" display="inline"><semantics id="algorithm1.32.32.m2.1a"><msup id="algorithm1.32.32.m2.1.1" xref="algorithm1.32.32.m2.1.1.cmml"><mi class="ltx_font_mathcaligraphic" mathsize="90%" id="algorithm1.32.32.m2.1.1.2" xref="algorithm1.32.32.m2.1.1.2.cmml">𝒟</mi><mi mathsize="90%" id="algorithm1.32.32.m2.1.1.3" xref="algorithm1.32.32.m2.1.1.3.cmml">i</mi></msup><annotation-xml encoding="MathML-Content" id="algorithm1.32.32.m2.1b"><apply id="algorithm1.32.32.m2.1.1.cmml" xref="algorithm1.32.32.m2.1.1"><csymbol cd="ambiguous" id="algorithm1.32.32.m2.1.1.1.cmml" xref="algorithm1.32.32.m2.1.1">superscript</csymbol><ci id="algorithm1.32.32.m2.1.1.2.cmml" xref="algorithm1.32.32.m2.1.1.2">𝒟</ci><ci id="algorithm1.32.32.m2.1.1.3.cmml" xref="algorithm1.32.32.m2.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="algorithm1.32.32.m2.1c">\mathcal{D}^{i}</annotation></semantics></math><span id="algorithm1.32.32.8" class="ltx_text" style="font-size:90%;"> </span><span id="algorithm1.32.32.9" class="ltx_text ltx_font_bold" style="font-size:90%;">do</span>
</div>
<div id="algorithm1.33.33" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="algorithm1.33.33.1.1.1" class="ltx_text" style="font-size:90%;">15</span></span><span id="algorithm1.33.33.2" class="ltx_text" style="font-size:90%;">  </span><span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span><span id="algorithm1.33.33.3" class="ltx_text" style="font-size:90%;">     </span><span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span><span id="algorithm1.33.33.4" class="ltx_text" style="font-size:90%;">   </span><span id="algorithm1.33.33.5" class="ltx_text" style="font-size:90%;">
</span><span id="algorithm1.33.33.6" class="ltx_text ltx_font_italic" style="font-size:90%;">local backbone training:</span><span id="algorithm1.33.33.7" class="ltx_text" style="font-size:90%;">
</span><math id="algorithm1.33.33.m1.3" class="ltx_Math" alttext="w_{i}^{t}\leftarrow w_{i}^{t}-\eta_{b}\nabla\ell_{i}(w_{i}^{t};(x+\delta_{i},y))" display="inline"><semantics id="algorithm1.33.33.m1.3a"><mrow id="algorithm1.33.33.m1.3.3" xref="algorithm1.33.33.m1.3.3.cmml"><msubsup id="algorithm1.33.33.m1.3.3.4" xref="algorithm1.33.33.m1.3.3.4.cmml"><mi mathsize="90%" id="algorithm1.33.33.m1.3.3.4.2.2" xref="algorithm1.33.33.m1.3.3.4.2.2.cmml">w</mi><mi mathsize="90%" id="algorithm1.33.33.m1.3.3.4.2.3" xref="algorithm1.33.33.m1.3.3.4.2.3.cmml">i</mi><mi mathsize="90%" id="algorithm1.33.33.m1.3.3.4.3" xref="algorithm1.33.33.m1.3.3.4.3.cmml">t</mi></msubsup><mo mathsize="90%" stretchy="false" id="algorithm1.33.33.m1.3.3.3" xref="algorithm1.33.33.m1.3.3.3.cmml">←</mo><mrow id="algorithm1.33.33.m1.3.3.2" xref="algorithm1.33.33.m1.3.3.2.cmml"><msubsup id="algorithm1.33.33.m1.3.3.2.4" xref="algorithm1.33.33.m1.3.3.2.4.cmml"><mi mathsize="90%" id="algorithm1.33.33.m1.3.3.2.4.2.2" xref="algorithm1.33.33.m1.3.3.2.4.2.2.cmml">w</mi><mi mathsize="90%" id="algorithm1.33.33.m1.3.3.2.4.2.3" xref="algorithm1.33.33.m1.3.3.2.4.2.3.cmml">i</mi><mi mathsize="90%" id="algorithm1.33.33.m1.3.3.2.4.3" xref="algorithm1.33.33.m1.3.3.2.4.3.cmml">t</mi></msubsup><mo mathsize="90%" id="algorithm1.33.33.m1.3.3.2.3" xref="algorithm1.33.33.m1.3.3.2.3.cmml">−</mo><mrow id="algorithm1.33.33.m1.3.3.2.2" xref="algorithm1.33.33.m1.3.3.2.2.cmml"><msub id="algorithm1.33.33.m1.3.3.2.2.4" xref="algorithm1.33.33.m1.3.3.2.2.4.cmml"><mi mathsize="90%" id="algorithm1.33.33.m1.3.3.2.2.4.2" xref="algorithm1.33.33.m1.3.3.2.2.4.2.cmml">η</mi><mi mathsize="90%" id="algorithm1.33.33.m1.3.3.2.2.4.3" xref="algorithm1.33.33.m1.3.3.2.2.4.3.cmml">b</mi></msub><mo lspace="0.167em" rspace="0em" id="algorithm1.33.33.m1.3.3.2.2.3" xref="algorithm1.33.33.m1.3.3.2.2.3.cmml">​</mo><mrow id="algorithm1.33.33.m1.3.3.2.2.5" xref="algorithm1.33.33.m1.3.3.2.2.5.cmml"><mo mathsize="90%" rspace="0.167em" id="algorithm1.33.33.m1.3.3.2.2.5.1" xref="algorithm1.33.33.m1.3.3.2.2.5.1.cmml">∇</mo><msub id="algorithm1.33.33.m1.3.3.2.2.5.2" xref="algorithm1.33.33.m1.3.3.2.2.5.2.cmml"><mi mathsize="90%" mathvariant="normal" id="algorithm1.33.33.m1.3.3.2.2.5.2.2" xref="algorithm1.33.33.m1.3.3.2.2.5.2.2.cmml">ℓ</mi><mi mathsize="90%" id="algorithm1.33.33.m1.3.3.2.2.5.2.3" xref="algorithm1.33.33.m1.3.3.2.2.5.2.3.cmml">i</mi></msub></mrow><mo lspace="0em" rspace="0em" id="algorithm1.33.33.m1.3.3.2.2.3a" xref="algorithm1.33.33.m1.3.3.2.2.3.cmml">​</mo><mrow id="algorithm1.33.33.m1.3.3.2.2.2.2" xref="algorithm1.33.33.m1.3.3.2.2.2.3.cmml"><mo maxsize="90%" minsize="90%" id="algorithm1.33.33.m1.3.3.2.2.2.2.3" xref="algorithm1.33.33.m1.3.3.2.2.2.3.cmml">(</mo><msubsup id="algorithm1.33.33.m1.2.2.1.1.1.1.1" xref="algorithm1.33.33.m1.2.2.1.1.1.1.1.cmml"><mi mathsize="90%" id="algorithm1.33.33.m1.2.2.1.1.1.1.1.2.2" xref="algorithm1.33.33.m1.2.2.1.1.1.1.1.2.2.cmml">w</mi><mi mathsize="90%" id="algorithm1.33.33.m1.2.2.1.1.1.1.1.2.3" xref="algorithm1.33.33.m1.2.2.1.1.1.1.1.2.3.cmml">i</mi><mi mathsize="90%" id="algorithm1.33.33.m1.2.2.1.1.1.1.1.3" xref="algorithm1.33.33.m1.2.2.1.1.1.1.1.3.cmml">t</mi></msubsup><mo mathsize="90%" id="algorithm1.33.33.m1.3.3.2.2.2.2.4" xref="algorithm1.33.33.m1.3.3.2.2.2.3.cmml">;</mo><mrow id="algorithm1.33.33.m1.3.3.2.2.2.2.2.1" xref="algorithm1.33.33.m1.3.3.2.2.2.2.2.2.cmml"><mo maxsize="90%" minsize="90%" id="algorithm1.33.33.m1.3.3.2.2.2.2.2.1.2" xref="algorithm1.33.33.m1.3.3.2.2.2.2.2.2.cmml">(</mo><mrow id="algorithm1.33.33.m1.3.3.2.2.2.2.2.1.1" xref="algorithm1.33.33.m1.3.3.2.2.2.2.2.1.1.cmml"><mi mathsize="90%" id="algorithm1.33.33.m1.3.3.2.2.2.2.2.1.1.2" xref="algorithm1.33.33.m1.3.3.2.2.2.2.2.1.1.2.cmml">x</mi><mo mathsize="90%" id="algorithm1.33.33.m1.3.3.2.2.2.2.2.1.1.1" xref="algorithm1.33.33.m1.3.3.2.2.2.2.2.1.1.1.cmml">+</mo><msub id="algorithm1.33.33.m1.3.3.2.2.2.2.2.1.1.3" xref="algorithm1.33.33.m1.3.3.2.2.2.2.2.1.1.3.cmml"><mi mathsize="90%" id="algorithm1.33.33.m1.3.3.2.2.2.2.2.1.1.3.2" xref="algorithm1.33.33.m1.3.3.2.2.2.2.2.1.1.3.2.cmml">δ</mi><mi mathsize="90%" id="algorithm1.33.33.m1.3.3.2.2.2.2.2.1.1.3.3" xref="algorithm1.33.33.m1.3.3.2.2.2.2.2.1.1.3.3.cmml">i</mi></msub></mrow><mo mathsize="90%" id="algorithm1.33.33.m1.3.3.2.2.2.2.2.1.3" xref="algorithm1.33.33.m1.3.3.2.2.2.2.2.2.cmml">,</mo><mi mathsize="90%" id="algorithm1.33.33.m1.1.1" xref="algorithm1.33.33.m1.1.1.cmml">y</mi><mo maxsize="90%" minsize="90%" id="algorithm1.33.33.m1.3.3.2.2.2.2.2.1.4" xref="algorithm1.33.33.m1.3.3.2.2.2.2.2.2.cmml">)</mo></mrow><mo maxsize="90%" minsize="90%" id="algorithm1.33.33.m1.3.3.2.2.2.2.5" xref="algorithm1.33.33.m1.3.3.2.2.2.3.cmml">)</mo></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="algorithm1.33.33.m1.3b"><apply id="algorithm1.33.33.m1.3.3.cmml" xref="algorithm1.33.33.m1.3.3"><ci id="algorithm1.33.33.m1.3.3.3.cmml" xref="algorithm1.33.33.m1.3.3.3">←</ci><apply id="algorithm1.33.33.m1.3.3.4.cmml" xref="algorithm1.33.33.m1.3.3.4"><csymbol cd="ambiguous" id="algorithm1.33.33.m1.3.3.4.1.cmml" xref="algorithm1.33.33.m1.3.3.4">superscript</csymbol><apply id="algorithm1.33.33.m1.3.3.4.2.cmml" xref="algorithm1.33.33.m1.3.3.4"><csymbol cd="ambiguous" id="algorithm1.33.33.m1.3.3.4.2.1.cmml" xref="algorithm1.33.33.m1.3.3.4">subscript</csymbol><ci id="algorithm1.33.33.m1.3.3.4.2.2.cmml" xref="algorithm1.33.33.m1.3.3.4.2.2">𝑤</ci><ci id="algorithm1.33.33.m1.3.3.4.2.3.cmml" xref="algorithm1.33.33.m1.3.3.4.2.3">𝑖</ci></apply><ci id="algorithm1.33.33.m1.3.3.4.3.cmml" xref="algorithm1.33.33.m1.3.3.4.3">𝑡</ci></apply><apply id="algorithm1.33.33.m1.3.3.2.cmml" xref="algorithm1.33.33.m1.3.3.2"><minus id="algorithm1.33.33.m1.3.3.2.3.cmml" xref="algorithm1.33.33.m1.3.3.2.3"></minus><apply id="algorithm1.33.33.m1.3.3.2.4.cmml" xref="algorithm1.33.33.m1.3.3.2.4"><csymbol cd="ambiguous" id="algorithm1.33.33.m1.3.3.2.4.1.cmml" xref="algorithm1.33.33.m1.3.3.2.4">superscript</csymbol><apply id="algorithm1.33.33.m1.3.3.2.4.2.cmml" xref="algorithm1.33.33.m1.3.3.2.4"><csymbol cd="ambiguous" id="algorithm1.33.33.m1.3.3.2.4.2.1.cmml" xref="algorithm1.33.33.m1.3.3.2.4">subscript</csymbol><ci id="algorithm1.33.33.m1.3.3.2.4.2.2.cmml" xref="algorithm1.33.33.m1.3.3.2.4.2.2">𝑤</ci><ci id="algorithm1.33.33.m1.3.3.2.4.2.3.cmml" xref="algorithm1.33.33.m1.3.3.2.4.2.3">𝑖</ci></apply><ci id="algorithm1.33.33.m1.3.3.2.4.3.cmml" xref="algorithm1.33.33.m1.3.3.2.4.3">𝑡</ci></apply><apply id="algorithm1.33.33.m1.3.3.2.2.cmml" xref="algorithm1.33.33.m1.3.3.2.2"><times id="algorithm1.33.33.m1.3.3.2.2.3.cmml" xref="algorithm1.33.33.m1.3.3.2.2.3"></times><apply id="algorithm1.33.33.m1.3.3.2.2.4.cmml" xref="algorithm1.33.33.m1.3.3.2.2.4"><csymbol cd="ambiguous" id="algorithm1.33.33.m1.3.3.2.2.4.1.cmml" xref="algorithm1.33.33.m1.3.3.2.2.4">subscript</csymbol><ci id="algorithm1.33.33.m1.3.3.2.2.4.2.cmml" xref="algorithm1.33.33.m1.3.3.2.2.4.2">𝜂</ci><ci id="algorithm1.33.33.m1.3.3.2.2.4.3.cmml" xref="algorithm1.33.33.m1.3.3.2.2.4.3">𝑏</ci></apply><apply id="algorithm1.33.33.m1.3.3.2.2.5.cmml" xref="algorithm1.33.33.m1.3.3.2.2.5"><ci id="algorithm1.33.33.m1.3.3.2.2.5.1.cmml" xref="algorithm1.33.33.m1.3.3.2.2.5.1">∇</ci><apply id="algorithm1.33.33.m1.3.3.2.2.5.2.cmml" xref="algorithm1.33.33.m1.3.3.2.2.5.2"><csymbol cd="ambiguous" id="algorithm1.33.33.m1.3.3.2.2.5.2.1.cmml" xref="algorithm1.33.33.m1.3.3.2.2.5.2">subscript</csymbol><ci id="algorithm1.33.33.m1.3.3.2.2.5.2.2.cmml" xref="algorithm1.33.33.m1.3.3.2.2.5.2.2">ℓ</ci><ci id="algorithm1.33.33.m1.3.3.2.2.5.2.3.cmml" xref="algorithm1.33.33.m1.3.3.2.2.5.2.3">𝑖</ci></apply></apply><list id="algorithm1.33.33.m1.3.3.2.2.2.3.cmml" xref="algorithm1.33.33.m1.3.3.2.2.2.2"><apply id="algorithm1.33.33.m1.2.2.1.1.1.1.1.cmml" xref="algorithm1.33.33.m1.2.2.1.1.1.1.1"><csymbol cd="ambiguous" id="algorithm1.33.33.m1.2.2.1.1.1.1.1.1.cmml" xref="algorithm1.33.33.m1.2.2.1.1.1.1.1">superscript</csymbol><apply id="algorithm1.33.33.m1.2.2.1.1.1.1.1.2.cmml" xref="algorithm1.33.33.m1.2.2.1.1.1.1.1"><csymbol cd="ambiguous" id="algorithm1.33.33.m1.2.2.1.1.1.1.1.2.1.cmml" xref="algorithm1.33.33.m1.2.2.1.1.1.1.1">subscript</csymbol><ci id="algorithm1.33.33.m1.2.2.1.1.1.1.1.2.2.cmml" xref="algorithm1.33.33.m1.2.2.1.1.1.1.1.2.2">𝑤</ci><ci id="algorithm1.33.33.m1.2.2.1.1.1.1.1.2.3.cmml" xref="algorithm1.33.33.m1.2.2.1.1.1.1.1.2.3">𝑖</ci></apply><ci id="algorithm1.33.33.m1.2.2.1.1.1.1.1.3.cmml" xref="algorithm1.33.33.m1.2.2.1.1.1.1.1.3">𝑡</ci></apply><interval closure="open" id="algorithm1.33.33.m1.3.3.2.2.2.2.2.2.cmml" xref="algorithm1.33.33.m1.3.3.2.2.2.2.2.1"><apply id="algorithm1.33.33.m1.3.3.2.2.2.2.2.1.1.cmml" xref="algorithm1.33.33.m1.3.3.2.2.2.2.2.1.1"><plus id="algorithm1.33.33.m1.3.3.2.2.2.2.2.1.1.1.cmml" xref="algorithm1.33.33.m1.3.3.2.2.2.2.2.1.1.1"></plus><ci id="algorithm1.33.33.m1.3.3.2.2.2.2.2.1.1.2.cmml" xref="algorithm1.33.33.m1.3.3.2.2.2.2.2.1.1.2">𝑥</ci><apply id="algorithm1.33.33.m1.3.3.2.2.2.2.2.1.1.3.cmml" xref="algorithm1.33.33.m1.3.3.2.2.2.2.2.1.1.3"><csymbol cd="ambiguous" id="algorithm1.33.33.m1.3.3.2.2.2.2.2.1.1.3.1.cmml" xref="algorithm1.33.33.m1.3.3.2.2.2.2.2.1.1.3">subscript</csymbol><ci id="algorithm1.33.33.m1.3.3.2.2.2.2.2.1.1.3.2.cmml" xref="algorithm1.33.33.m1.3.3.2.2.2.2.2.1.1.3.2">𝛿</ci><ci id="algorithm1.33.33.m1.3.3.2.2.2.2.2.1.1.3.3.cmml" xref="algorithm1.33.33.m1.3.3.2.2.2.2.2.1.1.3.3">𝑖</ci></apply></apply><ci id="algorithm1.33.33.m1.1.1.cmml" xref="algorithm1.33.33.m1.1.1">𝑦</ci></interval></list></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="algorithm1.33.33.m1.3c">w_{i}^{t}\leftarrow w_{i}^{t}-\eta_{b}\nabla\ell_{i}(w_{i}^{t};(x+\delta_{i},y))</annotation></semantics></math><span id="algorithm1.33.33.8" class="ltx_text" style="font-size:90%;">
</span>
</div>
<div id="algorithm1.34.36" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="algorithm1.34.36.1.1.1" class="ltx_text" style="font-size:90%;">16</span></span><span id="algorithm1.34.36.2" class="ltx_text" style="font-size:90%;">  </span><span class="ltx_rule" style="width:1px;height:100%;background:black;display:inline-block;"> </span><span id="algorithm1.34.36.3" class="ltx_text" style="font-size:90%;">   </span>
</div>
<div id="algorithm1.34.34" class="ltx_listingline">
<span id="algorithm1.34.34.1" class="ltx_text" style="font-size:90%;">return </span><math id="algorithm1.34.34.m1.1" class="ltx_Math" alttext="w_{i}^{t}" display="inline"><semantics id="algorithm1.34.34.m1.1a"><msubsup id="algorithm1.34.34.m1.1.1" xref="algorithm1.34.34.m1.1.1.cmml"><mi mathsize="90%" id="algorithm1.34.34.m1.1.1.2.2" xref="algorithm1.34.34.m1.1.1.2.2.cmml">w</mi><mi mathsize="90%" id="algorithm1.34.34.m1.1.1.2.3" xref="algorithm1.34.34.m1.1.1.2.3.cmml">i</mi><mi mathsize="90%" id="algorithm1.34.34.m1.1.1.3" xref="algorithm1.34.34.m1.1.1.3.cmml">t</mi></msubsup><annotation-xml encoding="MathML-Content" id="algorithm1.34.34.m1.1b"><apply id="algorithm1.34.34.m1.1.1.cmml" xref="algorithm1.34.34.m1.1.1"><csymbol cd="ambiguous" id="algorithm1.34.34.m1.1.1.1.cmml" xref="algorithm1.34.34.m1.1.1">superscript</csymbol><apply id="algorithm1.34.34.m1.1.1.2.cmml" xref="algorithm1.34.34.m1.1.1"><csymbol cd="ambiguous" id="algorithm1.34.34.m1.1.1.2.1.cmml" xref="algorithm1.34.34.m1.1.1">subscript</csymbol><ci id="algorithm1.34.34.m1.1.1.2.2.cmml" xref="algorithm1.34.34.m1.1.1.2.2">𝑤</ci><ci id="algorithm1.34.34.m1.1.1.2.3.cmml" xref="algorithm1.34.34.m1.1.1.2.3">𝑖</ci></apply><ci id="algorithm1.34.34.m1.1.1.3.cmml" xref="algorithm1.34.34.m1.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="algorithm1.34.34.m1.1c">w_{i}^{t}</annotation></semantics></math><span id="algorithm1.34.34.2" class="ltx_text" style="font-size:90%;"> to server

</span>
</div>
</div>
<figcaption class="ltx_caption" style="font-size:90%;"><span class="ltx_tag ltx_tag_float"><span id="algorithm1.38.1.1" class="ltx_text ltx_font_bold">Algorithm 1</span> </span> pFedPT framework</figcaption>
</figure>
</section>
<section id="S3.SS4" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.4 </span>Optimization for pFedPT</h3>

<div id="S3.SS4.p1" class="ltx_para">
<p id="S3.SS4.p1.3" class="ltx_p">To achieve the optimization goal of Eq. (<a href="#S3.E4" title="In 3.3 Modeling for pFedPT ‣ 3 Methodology ‣ Visual Prompt Based Personalized Federated Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">4</span></a>), we alternately update the prompt generator and the backbone on each client using gradient descent. pFedPT first trains the prompt generator with the aggregation model fixed, and the model maximizes the likelihood of the correct label y, which is equivalent to solving:</p>
<table id="S3.E5" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S3.E5.m1.6" class="ltx_Math" alttext="\operatorname*{arg\,min}_{\delta_{i}}\mathcal{L}_{i}(w,\delta_{i})=\mathbb{E}_{(x,y)\sim\mathcal{D}^{i}}[\ell_{i}(w;(x+\delta_{i},y))]." display="block"><semantics id="S3.E5.m1.6a"><mrow id="S3.E5.m1.6.6.1" xref="S3.E5.m1.6.6.1.1.cmml"><mrow id="S3.E5.m1.6.6.1.1" xref="S3.E5.m1.6.6.1.1.cmml"><mrow id="S3.E5.m1.6.6.1.1.1" xref="S3.E5.m1.6.6.1.1.1.cmml"><mrow id="S3.E5.m1.6.6.1.1.1.3" xref="S3.E5.m1.6.6.1.1.1.3.cmml"><munder id="S3.E5.m1.6.6.1.1.1.3.1" xref="S3.E5.m1.6.6.1.1.1.3.1.cmml"><mrow id="S3.E5.m1.6.6.1.1.1.3.1.2" xref="S3.E5.m1.6.6.1.1.1.3.1.2.cmml"><mi id="S3.E5.m1.6.6.1.1.1.3.1.2.2" xref="S3.E5.m1.6.6.1.1.1.3.1.2.2.cmml">arg</mi><mo lspace="0.170em" rspace="0em" id="S3.E5.m1.6.6.1.1.1.3.1.2.1" xref="S3.E5.m1.6.6.1.1.1.3.1.2.1.cmml">​</mo><mi id="S3.E5.m1.6.6.1.1.1.3.1.2.3" xref="S3.E5.m1.6.6.1.1.1.3.1.2.3.cmml">min</mi></mrow><msub id="S3.E5.m1.6.6.1.1.1.3.1.3" xref="S3.E5.m1.6.6.1.1.1.3.1.3.cmml"><mi id="S3.E5.m1.6.6.1.1.1.3.1.3.2" xref="S3.E5.m1.6.6.1.1.1.3.1.3.2.cmml">δ</mi><mi id="S3.E5.m1.6.6.1.1.1.3.1.3.3" xref="S3.E5.m1.6.6.1.1.1.3.1.3.3.cmml">i</mi></msub></munder><mo lspace="0.167em" id="S3.E5.m1.6.6.1.1.1.3a" xref="S3.E5.m1.6.6.1.1.1.3.cmml">⁡</mo><msub id="S3.E5.m1.6.6.1.1.1.3.2" xref="S3.E5.m1.6.6.1.1.1.3.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.E5.m1.6.6.1.1.1.3.2.2" xref="S3.E5.m1.6.6.1.1.1.3.2.2.cmml">ℒ</mi><mi id="S3.E5.m1.6.6.1.1.1.3.2.3" xref="S3.E5.m1.6.6.1.1.1.3.2.3.cmml">i</mi></msub></mrow><mo lspace="0em" rspace="0em" id="S3.E5.m1.6.6.1.1.1.2" xref="S3.E5.m1.6.6.1.1.1.2.cmml">​</mo><mrow id="S3.E5.m1.6.6.1.1.1.1.1" xref="S3.E5.m1.6.6.1.1.1.1.2.cmml"><mo stretchy="false" id="S3.E5.m1.6.6.1.1.1.1.1.2" xref="S3.E5.m1.6.6.1.1.1.1.2.cmml">(</mo><mi id="S3.E5.m1.3.3" xref="S3.E5.m1.3.3.cmml">w</mi><mo id="S3.E5.m1.6.6.1.1.1.1.1.3" xref="S3.E5.m1.6.6.1.1.1.1.2.cmml">,</mo><msub id="S3.E5.m1.6.6.1.1.1.1.1.1" xref="S3.E5.m1.6.6.1.1.1.1.1.1.cmml"><mi id="S3.E5.m1.6.6.1.1.1.1.1.1.2" xref="S3.E5.m1.6.6.1.1.1.1.1.1.2.cmml">δ</mi><mi id="S3.E5.m1.6.6.1.1.1.1.1.1.3" xref="S3.E5.m1.6.6.1.1.1.1.1.1.3.cmml">i</mi></msub><mo stretchy="false" id="S3.E5.m1.6.6.1.1.1.1.1.4" xref="S3.E5.m1.6.6.1.1.1.1.2.cmml">)</mo></mrow></mrow><mo id="S3.E5.m1.6.6.1.1.3" xref="S3.E5.m1.6.6.1.1.3.cmml">=</mo><mrow id="S3.E5.m1.6.6.1.1.2" xref="S3.E5.m1.6.6.1.1.2.cmml"><msub id="S3.E5.m1.6.6.1.1.2.3" xref="S3.E5.m1.6.6.1.1.2.3.cmml"><mi id="S3.E5.m1.6.6.1.1.2.3.2" xref="S3.E5.m1.6.6.1.1.2.3.2.cmml">𝔼</mi><mrow id="S3.E5.m1.2.2.2" xref="S3.E5.m1.2.2.2.cmml"><mrow id="S3.E5.m1.2.2.2.4.2" xref="S3.E5.m1.2.2.2.4.1.cmml"><mo stretchy="false" id="S3.E5.m1.2.2.2.4.2.1" xref="S3.E5.m1.2.2.2.4.1.cmml">(</mo><mi id="S3.E5.m1.1.1.1.1" xref="S3.E5.m1.1.1.1.1.cmml">x</mi><mo id="S3.E5.m1.2.2.2.4.2.2" xref="S3.E5.m1.2.2.2.4.1.cmml">,</mo><mi id="S3.E5.m1.2.2.2.2" xref="S3.E5.m1.2.2.2.2.cmml">y</mi><mo stretchy="false" id="S3.E5.m1.2.2.2.4.2.3" xref="S3.E5.m1.2.2.2.4.1.cmml">)</mo></mrow><mo id="S3.E5.m1.2.2.2.3" xref="S3.E5.m1.2.2.2.3.cmml">∼</mo><msup id="S3.E5.m1.2.2.2.5" xref="S3.E5.m1.2.2.2.5.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.E5.m1.2.2.2.5.2" xref="S3.E5.m1.2.2.2.5.2.cmml">𝒟</mi><mi id="S3.E5.m1.2.2.2.5.3" xref="S3.E5.m1.2.2.2.5.3.cmml">i</mi></msup></mrow></msub><mo lspace="0em" rspace="0em" id="S3.E5.m1.6.6.1.1.2.2" xref="S3.E5.m1.6.6.1.1.2.2.cmml">​</mo><mrow id="S3.E5.m1.6.6.1.1.2.1.1" xref="S3.E5.m1.6.6.1.1.2.1.2.cmml"><mo stretchy="false" id="S3.E5.m1.6.6.1.1.2.1.1.2" xref="S3.E5.m1.6.6.1.1.2.1.2.1.cmml">[</mo><mrow id="S3.E5.m1.6.6.1.1.2.1.1.1" xref="S3.E5.m1.6.6.1.1.2.1.1.1.cmml"><msub id="S3.E5.m1.6.6.1.1.2.1.1.1.3" xref="S3.E5.m1.6.6.1.1.2.1.1.1.3.cmml"><mi mathvariant="normal" id="S3.E5.m1.6.6.1.1.2.1.1.1.3.2" xref="S3.E5.m1.6.6.1.1.2.1.1.1.3.2.cmml">ℓ</mi><mi id="S3.E5.m1.6.6.1.1.2.1.1.1.3.3" xref="S3.E5.m1.6.6.1.1.2.1.1.1.3.3.cmml">i</mi></msub><mo lspace="0em" rspace="0em" id="S3.E5.m1.6.6.1.1.2.1.1.1.2" xref="S3.E5.m1.6.6.1.1.2.1.1.1.2.cmml">​</mo><mrow id="S3.E5.m1.6.6.1.1.2.1.1.1.1.1" xref="S3.E5.m1.6.6.1.1.2.1.1.1.1.2.cmml"><mo stretchy="false" id="S3.E5.m1.6.6.1.1.2.1.1.1.1.1.2" xref="S3.E5.m1.6.6.1.1.2.1.1.1.1.2.cmml">(</mo><mi id="S3.E5.m1.5.5" xref="S3.E5.m1.5.5.cmml">w</mi><mo id="S3.E5.m1.6.6.1.1.2.1.1.1.1.1.3" xref="S3.E5.m1.6.6.1.1.2.1.1.1.1.2.cmml">;</mo><mrow id="S3.E5.m1.6.6.1.1.2.1.1.1.1.1.1.1" xref="S3.E5.m1.6.6.1.1.2.1.1.1.1.1.1.2.cmml"><mo stretchy="false" id="S3.E5.m1.6.6.1.1.2.1.1.1.1.1.1.1.2" xref="S3.E5.m1.6.6.1.1.2.1.1.1.1.1.1.2.cmml">(</mo><mrow id="S3.E5.m1.6.6.1.1.2.1.1.1.1.1.1.1.1" xref="S3.E5.m1.6.6.1.1.2.1.1.1.1.1.1.1.1.cmml"><mi id="S3.E5.m1.6.6.1.1.2.1.1.1.1.1.1.1.1.2" xref="S3.E5.m1.6.6.1.1.2.1.1.1.1.1.1.1.1.2.cmml">x</mi><mo id="S3.E5.m1.6.6.1.1.2.1.1.1.1.1.1.1.1.1" xref="S3.E5.m1.6.6.1.1.2.1.1.1.1.1.1.1.1.1.cmml">+</mo><msub id="S3.E5.m1.6.6.1.1.2.1.1.1.1.1.1.1.1.3" xref="S3.E5.m1.6.6.1.1.2.1.1.1.1.1.1.1.1.3.cmml"><mi id="S3.E5.m1.6.6.1.1.2.1.1.1.1.1.1.1.1.3.2" xref="S3.E5.m1.6.6.1.1.2.1.1.1.1.1.1.1.1.3.2.cmml">δ</mi><mi id="S3.E5.m1.6.6.1.1.2.1.1.1.1.1.1.1.1.3.3" xref="S3.E5.m1.6.6.1.1.2.1.1.1.1.1.1.1.1.3.3.cmml">i</mi></msub></mrow><mo id="S3.E5.m1.6.6.1.1.2.1.1.1.1.1.1.1.3" xref="S3.E5.m1.6.6.1.1.2.1.1.1.1.1.1.2.cmml">,</mo><mi id="S3.E5.m1.4.4" xref="S3.E5.m1.4.4.cmml">y</mi><mo stretchy="false" id="S3.E5.m1.6.6.1.1.2.1.1.1.1.1.1.1.4" xref="S3.E5.m1.6.6.1.1.2.1.1.1.1.1.1.2.cmml">)</mo></mrow><mo stretchy="false" id="S3.E5.m1.6.6.1.1.2.1.1.1.1.1.4" xref="S3.E5.m1.6.6.1.1.2.1.1.1.1.2.cmml">)</mo></mrow></mrow><mo stretchy="false" id="S3.E5.m1.6.6.1.1.2.1.1.3" xref="S3.E5.m1.6.6.1.1.2.1.2.1.cmml">]</mo></mrow></mrow></mrow><mo lspace="0em" id="S3.E5.m1.6.6.1.2" xref="S3.E5.m1.6.6.1.1.cmml">.</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E5.m1.6b"><apply id="S3.E5.m1.6.6.1.1.cmml" xref="S3.E5.m1.6.6.1"><eq id="S3.E5.m1.6.6.1.1.3.cmml" xref="S3.E5.m1.6.6.1.1.3"></eq><apply id="S3.E5.m1.6.6.1.1.1.cmml" xref="S3.E5.m1.6.6.1.1.1"><times id="S3.E5.m1.6.6.1.1.1.2.cmml" xref="S3.E5.m1.6.6.1.1.1.2"></times><apply id="S3.E5.m1.6.6.1.1.1.3.cmml" xref="S3.E5.m1.6.6.1.1.1.3"><apply id="S3.E5.m1.6.6.1.1.1.3.1.cmml" xref="S3.E5.m1.6.6.1.1.1.3.1"><csymbol cd="ambiguous" id="S3.E5.m1.6.6.1.1.1.3.1.1.cmml" xref="S3.E5.m1.6.6.1.1.1.3.1">subscript</csymbol><apply id="S3.E5.m1.6.6.1.1.1.3.1.2.cmml" xref="S3.E5.m1.6.6.1.1.1.3.1.2"><times id="S3.E5.m1.6.6.1.1.1.3.1.2.1.cmml" xref="S3.E5.m1.6.6.1.1.1.3.1.2.1"></times><ci id="S3.E5.m1.6.6.1.1.1.3.1.2.2.cmml" xref="S3.E5.m1.6.6.1.1.1.3.1.2.2">arg</ci><ci id="S3.E5.m1.6.6.1.1.1.3.1.2.3.cmml" xref="S3.E5.m1.6.6.1.1.1.3.1.2.3">min</ci></apply><apply id="S3.E5.m1.6.6.1.1.1.3.1.3.cmml" xref="S3.E5.m1.6.6.1.1.1.3.1.3"><csymbol cd="ambiguous" id="S3.E5.m1.6.6.1.1.1.3.1.3.1.cmml" xref="S3.E5.m1.6.6.1.1.1.3.1.3">subscript</csymbol><ci id="S3.E5.m1.6.6.1.1.1.3.1.3.2.cmml" xref="S3.E5.m1.6.6.1.1.1.3.1.3.2">𝛿</ci><ci id="S3.E5.m1.6.6.1.1.1.3.1.3.3.cmml" xref="S3.E5.m1.6.6.1.1.1.3.1.3.3">𝑖</ci></apply></apply><apply id="S3.E5.m1.6.6.1.1.1.3.2.cmml" xref="S3.E5.m1.6.6.1.1.1.3.2"><csymbol cd="ambiguous" id="S3.E5.m1.6.6.1.1.1.3.2.1.cmml" xref="S3.E5.m1.6.6.1.1.1.3.2">subscript</csymbol><ci id="S3.E5.m1.6.6.1.1.1.3.2.2.cmml" xref="S3.E5.m1.6.6.1.1.1.3.2.2">ℒ</ci><ci id="S3.E5.m1.6.6.1.1.1.3.2.3.cmml" xref="S3.E5.m1.6.6.1.1.1.3.2.3">𝑖</ci></apply></apply><interval closure="open" id="S3.E5.m1.6.6.1.1.1.1.2.cmml" xref="S3.E5.m1.6.6.1.1.1.1.1"><ci id="S3.E5.m1.3.3.cmml" xref="S3.E5.m1.3.3">𝑤</ci><apply id="S3.E5.m1.6.6.1.1.1.1.1.1.cmml" xref="S3.E5.m1.6.6.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E5.m1.6.6.1.1.1.1.1.1.1.cmml" xref="S3.E5.m1.6.6.1.1.1.1.1.1">subscript</csymbol><ci id="S3.E5.m1.6.6.1.1.1.1.1.1.2.cmml" xref="S3.E5.m1.6.6.1.1.1.1.1.1.2">𝛿</ci><ci id="S3.E5.m1.6.6.1.1.1.1.1.1.3.cmml" xref="S3.E5.m1.6.6.1.1.1.1.1.1.3">𝑖</ci></apply></interval></apply><apply id="S3.E5.m1.6.6.1.1.2.cmml" xref="S3.E5.m1.6.6.1.1.2"><times id="S3.E5.m1.6.6.1.1.2.2.cmml" xref="S3.E5.m1.6.6.1.1.2.2"></times><apply id="S3.E5.m1.6.6.1.1.2.3.cmml" xref="S3.E5.m1.6.6.1.1.2.3"><csymbol cd="ambiguous" id="S3.E5.m1.6.6.1.1.2.3.1.cmml" xref="S3.E5.m1.6.6.1.1.2.3">subscript</csymbol><ci id="S3.E5.m1.6.6.1.1.2.3.2.cmml" xref="S3.E5.m1.6.6.1.1.2.3.2">𝔼</ci><apply id="S3.E5.m1.2.2.2.cmml" xref="S3.E5.m1.2.2.2"><csymbol cd="latexml" id="S3.E5.m1.2.2.2.3.cmml" xref="S3.E5.m1.2.2.2.3">similar-to</csymbol><interval closure="open" id="S3.E5.m1.2.2.2.4.1.cmml" xref="S3.E5.m1.2.2.2.4.2"><ci id="S3.E5.m1.1.1.1.1.cmml" xref="S3.E5.m1.1.1.1.1">𝑥</ci><ci id="S3.E5.m1.2.2.2.2.cmml" xref="S3.E5.m1.2.2.2.2">𝑦</ci></interval><apply id="S3.E5.m1.2.2.2.5.cmml" xref="S3.E5.m1.2.2.2.5"><csymbol cd="ambiguous" id="S3.E5.m1.2.2.2.5.1.cmml" xref="S3.E5.m1.2.2.2.5">superscript</csymbol><ci id="S3.E5.m1.2.2.2.5.2.cmml" xref="S3.E5.m1.2.2.2.5.2">𝒟</ci><ci id="S3.E5.m1.2.2.2.5.3.cmml" xref="S3.E5.m1.2.2.2.5.3">𝑖</ci></apply></apply></apply><apply id="S3.E5.m1.6.6.1.1.2.1.2.cmml" xref="S3.E5.m1.6.6.1.1.2.1.1"><csymbol cd="latexml" id="S3.E5.m1.6.6.1.1.2.1.2.1.cmml" xref="S3.E5.m1.6.6.1.1.2.1.1.2">delimited-[]</csymbol><apply id="S3.E5.m1.6.6.1.1.2.1.1.1.cmml" xref="S3.E5.m1.6.6.1.1.2.1.1.1"><times id="S3.E5.m1.6.6.1.1.2.1.1.1.2.cmml" xref="S3.E5.m1.6.6.1.1.2.1.1.1.2"></times><apply id="S3.E5.m1.6.6.1.1.2.1.1.1.3.cmml" xref="S3.E5.m1.6.6.1.1.2.1.1.1.3"><csymbol cd="ambiguous" id="S3.E5.m1.6.6.1.1.2.1.1.1.3.1.cmml" xref="S3.E5.m1.6.6.1.1.2.1.1.1.3">subscript</csymbol><ci id="S3.E5.m1.6.6.1.1.2.1.1.1.3.2.cmml" xref="S3.E5.m1.6.6.1.1.2.1.1.1.3.2">ℓ</ci><ci id="S3.E5.m1.6.6.1.1.2.1.1.1.3.3.cmml" xref="S3.E5.m1.6.6.1.1.2.1.1.1.3.3">𝑖</ci></apply><list id="S3.E5.m1.6.6.1.1.2.1.1.1.1.2.cmml" xref="S3.E5.m1.6.6.1.1.2.1.1.1.1.1"><ci id="S3.E5.m1.5.5.cmml" xref="S3.E5.m1.5.5">𝑤</ci><interval closure="open" id="S3.E5.m1.6.6.1.1.2.1.1.1.1.1.1.2.cmml" xref="S3.E5.m1.6.6.1.1.2.1.1.1.1.1.1.1"><apply id="S3.E5.m1.6.6.1.1.2.1.1.1.1.1.1.1.1.cmml" xref="S3.E5.m1.6.6.1.1.2.1.1.1.1.1.1.1.1"><plus id="S3.E5.m1.6.6.1.1.2.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E5.m1.6.6.1.1.2.1.1.1.1.1.1.1.1.1"></plus><ci id="S3.E5.m1.6.6.1.1.2.1.1.1.1.1.1.1.1.2.cmml" xref="S3.E5.m1.6.6.1.1.2.1.1.1.1.1.1.1.1.2">𝑥</ci><apply id="S3.E5.m1.6.6.1.1.2.1.1.1.1.1.1.1.1.3.cmml" xref="S3.E5.m1.6.6.1.1.2.1.1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.E5.m1.6.6.1.1.2.1.1.1.1.1.1.1.1.3.1.cmml" xref="S3.E5.m1.6.6.1.1.2.1.1.1.1.1.1.1.1.3">subscript</csymbol><ci id="S3.E5.m1.6.6.1.1.2.1.1.1.1.1.1.1.1.3.2.cmml" xref="S3.E5.m1.6.6.1.1.2.1.1.1.1.1.1.1.1.3.2">𝛿</ci><ci id="S3.E5.m1.6.6.1.1.2.1.1.1.1.1.1.1.1.3.3.cmml" xref="S3.E5.m1.6.6.1.1.2.1.1.1.1.1.1.1.1.3.3">𝑖</ci></apply></apply><ci id="S3.E5.m1.4.4.cmml" xref="S3.E5.m1.4.4">𝑦</ci></interval></list></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E5.m1.6c">\operatorname*{arg\,min}_{\delta_{i}}\mathcal{L}_{i}(w,\delta_{i})=\mathbb{E}_{(x,y)\sim\mathcal{D}^{i}}[\ell_{i}(w;(x+\delta_{i},y))].</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(5)</span></td>
</tr></tbody>
</table>
<p id="S3.SS4.p1.1" class="ltx_p">After updating the prompt generator locally, we freeze the parameters of the prompt generator, and then train the backbone for several epochs. The backbone has the following objective function in the client <math id="S3.SS4.p1.1.m1.1" class="ltx_Math" alttext="i" display="inline"><semantics id="S3.SS4.p1.1.m1.1a"><mi id="S3.SS4.p1.1.m1.1.1" xref="S3.SS4.p1.1.m1.1.1.cmml">i</mi><annotation-xml encoding="MathML-Content" id="S3.SS4.p1.1.m1.1b"><ci id="S3.SS4.p1.1.m1.1.1.cmml" xref="S3.SS4.p1.1.m1.1.1">𝑖</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p1.1.m1.1c">i</annotation></semantics></math> during the training process:</p>
<table id="S3.E6" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S3.E6.m1.6" class="ltx_Math" alttext="\operatorname*{arg\,min}_{w}\mathcal{L}_{i}(w,\delta_{i})=\mathbb{E}_{(x,y)\sim\mathcal{D}^{i}}[\ell_{i}(w;(x+\delta_{i},y))]." display="block"><semantics id="S3.E6.m1.6a"><mrow id="S3.E6.m1.6.6.1" xref="S3.E6.m1.6.6.1.1.cmml"><mrow id="S3.E6.m1.6.6.1.1" xref="S3.E6.m1.6.6.1.1.cmml"><mrow id="S3.E6.m1.6.6.1.1.1" xref="S3.E6.m1.6.6.1.1.1.cmml"><mrow id="S3.E6.m1.6.6.1.1.1.3" xref="S3.E6.m1.6.6.1.1.1.3.cmml"><munder id="S3.E6.m1.6.6.1.1.1.3.1" xref="S3.E6.m1.6.6.1.1.1.3.1.cmml"><mrow id="S3.E6.m1.6.6.1.1.1.3.1.2" xref="S3.E6.m1.6.6.1.1.1.3.1.2.cmml"><mi id="S3.E6.m1.6.6.1.1.1.3.1.2.2" xref="S3.E6.m1.6.6.1.1.1.3.1.2.2.cmml">arg</mi><mo lspace="0.170em" rspace="0em" id="S3.E6.m1.6.6.1.1.1.3.1.2.1" xref="S3.E6.m1.6.6.1.1.1.3.1.2.1.cmml">​</mo><mi id="S3.E6.m1.6.6.1.1.1.3.1.2.3" xref="S3.E6.m1.6.6.1.1.1.3.1.2.3.cmml">min</mi></mrow><mi id="S3.E6.m1.6.6.1.1.1.3.1.3" xref="S3.E6.m1.6.6.1.1.1.3.1.3.cmml">w</mi></munder><mo lspace="0.167em" id="S3.E6.m1.6.6.1.1.1.3a" xref="S3.E6.m1.6.6.1.1.1.3.cmml">⁡</mo><msub id="S3.E6.m1.6.6.1.1.1.3.2" xref="S3.E6.m1.6.6.1.1.1.3.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.E6.m1.6.6.1.1.1.3.2.2" xref="S3.E6.m1.6.6.1.1.1.3.2.2.cmml">ℒ</mi><mi id="S3.E6.m1.6.6.1.1.1.3.2.3" xref="S3.E6.m1.6.6.1.1.1.3.2.3.cmml">i</mi></msub></mrow><mo lspace="0em" rspace="0em" id="S3.E6.m1.6.6.1.1.1.2" xref="S3.E6.m1.6.6.1.1.1.2.cmml">​</mo><mrow id="S3.E6.m1.6.6.1.1.1.1.1" xref="S3.E6.m1.6.6.1.1.1.1.2.cmml"><mo stretchy="false" id="S3.E6.m1.6.6.1.1.1.1.1.2" xref="S3.E6.m1.6.6.1.1.1.1.2.cmml">(</mo><mi id="S3.E6.m1.3.3" xref="S3.E6.m1.3.3.cmml">w</mi><mo id="S3.E6.m1.6.6.1.1.1.1.1.3" xref="S3.E6.m1.6.6.1.1.1.1.2.cmml">,</mo><msub id="S3.E6.m1.6.6.1.1.1.1.1.1" xref="S3.E6.m1.6.6.1.1.1.1.1.1.cmml"><mi id="S3.E6.m1.6.6.1.1.1.1.1.1.2" xref="S3.E6.m1.6.6.1.1.1.1.1.1.2.cmml">δ</mi><mi id="S3.E6.m1.6.6.1.1.1.1.1.1.3" xref="S3.E6.m1.6.6.1.1.1.1.1.1.3.cmml">i</mi></msub><mo stretchy="false" id="S3.E6.m1.6.6.1.1.1.1.1.4" xref="S3.E6.m1.6.6.1.1.1.1.2.cmml">)</mo></mrow></mrow><mo id="S3.E6.m1.6.6.1.1.3" xref="S3.E6.m1.6.6.1.1.3.cmml">=</mo><mrow id="S3.E6.m1.6.6.1.1.2" xref="S3.E6.m1.6.6.1.1.2.cmml"><msub id="S3.E6.m1.6.6.1.1.2.3" xref="S3.E6.m1.6.6.1.1.2.3.cmml"><mi id="S3.E6.m1.6.6.1.1.2.3.2" xref="S3.E6.m1.6.6.1.1.2.3.2.cmml">𝔼</mi><mrow id="S3.E6.m1.2.2.2" xref="S3.E6.m1.2.2.2.cmml"><mrow id="S3.E6.m1.2.2.2.4.2" xref="S3.E6.m1.2.2.2.4.1.cmml"><mo stretchy="false" id="S3.E6.m1.2.2.2.4.2.1" xref="S3.E6.m1.2.2.2.4.1.cmml">(</mo><mi id="S3.E6.m1.1.1.1.1" xref="S3.E6.m1.1.1.1.1.cmml">x</mi><mo id="S3.E6.m1.2.2.2.4.2.2" xref="S3.E6.m1.2.2.2.4.1.cmml">,</mo><mi id="S3.E6.m1.2.2.2.2" xref="S3.E6.m1.2.2.2.2.cmml">y</mi><mo stretchy="false" id="S3.E6.m1.2.2.2.4.2.3" xref="S3.E6.m1.2.2.2.4.1.cmml">)</mo></mrow><mo id="S3.E6.m1.2.2.2.3" xref="S3.E6.m1.2.2.2.3.cmml">∼</mo><msup id="S3.E6.m1.2.2.2.5" xref="S3.E6.m1.2.2.2.5.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.E6.m1.2.2.2.5.2" xref="S3.E6.m1.2.2.2.5.2.cmml">𝒟</mi><mi id="S3.E6.m1.2.2.2.5.3" xref="S3.E6.m1.2.2.2.5.3.cmml">i</mi></msup></mrow></msub><mo lspace="0em" rspace="0em" id="S3.E6.m1.6.6.1.1.2.2" xref="S3.E6.m1.6.6.1.1.2.2.cmml">​</mo><mrow id="S3.E6.m1.6.6.1.1.2.1.1" xref="S3.E6.m1.6.6.1.1.2.1.2.cmml"><mo stretchy="false" id="S3.E6.m1.6.6.1.1.2.1.1.2" xref="S3.E6.m1.6.6.1.1.2.1.2.1.cmml">[</mo><mrow id="S3.E6.m1.6.6.1.1.2.1.1.1" xref="S3.E6.m1.6.6.1.1.2.1.1.1.cmml"><msub id="S3.E6.m1.6.6.1.1.2.1.1.1.3" xref="S3.E6.m1.6.6.1.1.2.1.1.1.3.cmml"><mi mathvariant="normal" id="S3.E6.m1.6.6.1.1.2.1.1.1.3.2" xref="S3.E6.m1.6.6.1.1.2.1.1.1.3.2.cmml">ℓ</mi><mi id="S3.E6.m1.6.6.1.1.2.1.1.1.3.3" xref="S3.E6.m1.6.6.1.1.2.1.1.1.3.3.cmml">i</mi></msub><mo lspace="0em" rspace="0em" id="S3.E6.m1.6.6.1.1.2.1.1.1.2" xref="S3.E6.m1.6.6.1.1.2.1.1.1.2.cmml">​</mo><mrow id="S3.E6.m1.6.6.1.1.2.1.1.1.1.1" xref="S3.E6.m1.6.6.1.1.2.1.1.1.1.2.cmml"><mo stretchy="false" id="S3.E6.m1.6.6.1.1.2.1.1.1.1.1.2" xref="S3.E6.m1.6.6.1.1.2.1.1.1.1.2.cmml">(</mo><mi id="S3.E6.m1.5.5" xref="S3.E6.m1.5.5.cmml">w</mi><mo id="S3.E6.m1.6.6.1.1.2.1.1.1.1.1.3" xref="S3.E6.m1.6.6.1.1.2.1.1.1.1.2.cmml">;</mo><mrow id="S3.E6.m1.6.6.1.1.2.1.1.1.1.1.1.1" xref="S3.E6.m1.6.6.1.1.2.1.1.1.1.1.1.2.cmml"><mo stretchy="false" id="S3.E6.m1.6.6.1.1.2.1.1.1.1.1.1.1.2" xref="S3.E6.m1.6.6.1.1.2.1.1.1.1.1.1.2.cmml">(</mo><mrow id="S3.E6.m1.6.6.1.1.2.1.1.1.1.1.1.1.1" xref="S3.E6.m1.6.6.1.1.2.1.1.1.1.1.1.1.1.cmml"><mi id="S3.E6.m1.6.6.1.1.2.1.1.1.1.1.1.1.1.2" xref="S3.E6.m1.6.6.1.1.2.1.1.1.1.1.1.1.1.2.cmml">x</mi><mo id="S3.E6.m1.6.6.1.1.2.1.1.1.1.1.1.1.1.1" xref="S3.E6.m1.6.6.1.1.2.1.1.1.1.1.1.1.1.1.cmml">+</mo><msub id="S3.E6.m1.6.6.1.1.2.1.1.1.1.1.1.1.1.3" xref="S3.E6.m1.6.6.1.1.2.1.1.1.1.1.1.1.1.3.cmml"><mi id="S3.E6.m1.6.6.1.1.2.1.1.1.1.1.1.1.1.3.2" xref="S3.E6.m1.6.6.1.1.2.1.1.1.1.1.1.1.1.3.2.cmml">δ</mi><mi id="S3.E6.m1.6.6.1.1.2.1.1.1.1.1.1.1.1.3.3" xref="S3.E6.m1.6.6.1.1.2.1.1.1.1.1.1.1.1.3.3.cmml">i</mi></msub></mrow><mo id="S3.E6.m1.6.6.1.1.2.1.1.1.1.1.1.1.3" xref="S3.E6.m1.6.6.1.1.2.1.1.1.1.1.1.2.cmml">,</mo><mi id="S3.E6.m1.4.4" xref="S3.E6.m1.4.4.cmml">y</mi><mo stretchy="false" id="S3.E6.m1.6.6.1.1.2.1.1.1.1.1.1.1.4" xref="S3.E6.m1.6.6.1.1.2.1.1.1.1.1.1.2.cmml">)</mo></mrow><mo stretchy="false" id="S3.E6.m1.6.6.1.1.2.1.1.1.1.1.4" xref="S3.E6.m1.6.6.1.1.2.1.1.1.1.2.cmml">)</mo></mrow></mrow><mo stretchy="false" id="S3.E6.m1.6.6.1.1.2.1.1.3" xref="S3.E6.m1.6.6.1.1.2.1.2.1.cmml">]</mo></mrow></mrow></mrow><mo lspace="0em" id="S3.E6.m1.6.6.1.2" xref="S3.E6.m1.6.6.1.1.cmml">.</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E6.m1.6b"><apply id="S3.E6.m1.6.6.1.1.cmml" xref="S3.E6.m1.6.6.1"><eq id="S3.E6.m1.6.6.1.1.3.cmml" xref="S3.E6.m1.6.6.1.1.3"></eq><apply id="S3.E6.m1.6.6.1.1.1.cmml" xref="S3.E6.m1.6.6.1.1.1"><times id="S3.E6.m1.6.6.1.1.1.2.cmml" xref="S3.E6.m1.6.6.1.1.1.2"></times><apply id="S3.E6.m1.6.6.1.1.1.3.cmml" xref="S3.E6.m1.6.6.1.1.1.3"><apply id="S3.E6.m1.6.6.1.1.1.3.1.cmml" xref="S3.E6.m1.6.6.1.1.1.3.1"><csymbol cd="ambiguous" id="S3.E6.m1.6.6.1.1.1.3.1.1.cmml" xref="S3.E6.m1.6.6.1.1.1.3.1">subscript</csymbol><apply id="S3.E6.m1.6.6.1.1.1.3.1.2.cmml" xref="S3.E6.m1.6.6.1.1.1.3.1.2"><times id="S3.E6.m1.6.6.1.1.1.3.1.2.1.cmml" xref="S3.E6.m1.6.6.1.1.1.3.1.2.1"></times><ci id="S3.E6.m1.6.6.1.1.1.3.1.2.2.cmml" xref="S3.E6.m1.6.6.1.1.1.3.1.2.2">arg</ci><ci id="S3.E6.m1.6.6.1.1.1.3.1.2.3.cmml" xref="S3.E6.m1.6.6.1.1.1.3.1.2.3">min</ci></apply><ci id="S3.E6.m1.6.6.1.1.1.3.1.3.cmml" xref="S3.E6.m1.6.6.1.1.1.3.1.3">𝑤</ci></apply><apply id="S3.E6.m1.6.6.1.1.1.3.2.cmml" xref="S3.E6.m1.6.6.1.1.1.3.2"><csymbol cd="ambiguous" id="S3.E6.m1.6.6.1.1.1.3.2.1.cmml" xref="S3.E6.m1.6.6.1.1.1.3.2">subscript</csymbol><ci id="S3.E6.m1.6.6.1.1.1.3.2.2.cmml" xref="S3.E6.m1.6.6.1.1.1.3.2.2">ℒ</ci><ci id="S3.E6.m1.6.6.1.1.1.3.2.3.cmml" xref="S3.E6.m1.6.6.1.1.1.3.2.3">𝑖</ci></apply></apply><interval closure="open" id="S3.E6.m1.6.6.1.1.1.1.2.cmml" xref="S3.E6.m1.6.6.1.1.1.1.1"><ci id="S3.E6.m1.3.3.cmml" xref="S3.E6.m1.3.3">𝑤</ci><apply id="S3.E6.m1.6.6.1.1.1.1.1.1.cmml" xref="S3.E6.m1.6.6.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E6.m1.6.6.1.1.1.1.1.1.1.cmml" xref="S3.E6.m1.6.6.1.1.1.1.1.1">subscript</csymbol><ci id="S3.E6.m1.6.6.1.1.1.1.1.1.2.cmml" xref="S3.E6.m1.6.6.1.1.1.1.1.1.2">𝛿</ci><ci id="S3.E6.m1.6.6.1.1.1.1.1.1.3.cmml" xref="S3.E6.m1.6.6.1.1.1.1.1.1.3">𝑖</ci></apply></interval></apply><apply id="S3.E6.m1.6.6.1.1.2.cmml" xref="S3.E6.m1.6.6.1.1.2"><times id="S3.E6.m1.6.6.1.1.2.2.cmml" xref="S3.E6.m1.6.6.1.1.2.2"></times><apply id="S3.E6.m1.6.6.1.1.2.3.cmml" xref="S3.E6.m1.6.6.1.1.2.3"><csymbol cd="ambiguous" id="S3.E6.m1.6.6.1.1.2.3.1.cmml" xref="S3.E6.m1.6.6.1.1.2.3">subscript</csymbol><ci id="S3.E6.m1.6.6.1.1.2.3.2.cmml" xref="S3.E6.m1.6.6.1.1.2.3.2">𝔼</ci><apply id="S3.E6.m1.2.2.2.cmml" xref="S3.E6.m1.2.2.2"><csymbol cd="latexml" id="S3.E6.m1.2.2.2.3.cmml" xref="S3.E6.m1.2.2.2.3">similar-to</csymbol><interval closure="open" id="S3.E6.m1.2.2.2.4.1.cmml" xref="S3.E6.m1.2.2.2.4.2"><ci id="S3.E6.m1.1.1.1.1.cmml" xref="S3.E6.m1.1.1.1.1">𝑥</ci><ci id="S3.E6.m1.2.2.2.2.cmml" xref="S3.E6.m1.2.2.2.2">𝑦</ci></interval><apply id="S3.E6.m1.2.2.2.5.cmml" xref="S3.E6.m1.2.2.2.5"><csymbol cd="ambiguous" id="S3.E6.m1.2.2.2.5.1.cmml" xref="S3.E6.m1.2.2.2.5">superscript</csymbol><ci id="S3.E6.m1.2.2.2.5.2.cmml" xref="S3.E6.m1.2.2.2.5.2">𝒟</ci><ci id="S3.E6.m1.2.2.2.5.3.cmml" xref="S3.E6.m1.2.2.2.5.3">𝑖</ci></apply></apply></apply><apply id="S3.E6.m1.6.6.1.1.2.1.2.cmml" xref="S3.E6.m1.6.6.1.1.2.1.1"><csymbol cd="latexml" id="S3.E6.m1.6.6.1.1.2.1.2.1.cmml" xref="S3.E6.m1.6.6.1.1.2.1.1.2">delimited-[]</csymbol><apply id="S3.E6.m1.6.6.1.1.2.1.1.1.cmml" xref="S3.E6.m1.6.6.1.1.2.1.1.1"><times id="S3.E6.m1.6.6.1.1.2.1.1.1.2.cmml" xref="S3.E6.m1.6.6.1.1.2.1.1.1.2"></times><apply id="S3.E6.m1.6.6.1.1.2.1.1.1.3.cmml" xref="S3.E6.m1.6.6.1.1.2.1.1.1.3"><csymbol cd="ambiguous" id="S3.E6.m1.6.6.1.1.2.1.1.1.3.1.cmml" xref="S3.E6.m1.6.6.1.1.2.1.1.1.3">subscript</csymbol><ci id="S3.E6.m1.6.6.1.1.2.1.1.1.3.2.cmml" xref="S3.E6.m1.6.6.1.1.2.1.1.1.3.2">ℓ</ci><ci id="S3.E6.m1.6.6.1.1.2.1.1.1.3.3.cmml" xref="S3.E6.m1.6.6.1.1.2.1.1.1.3.3">𝑖</ci></apply><list id="S3.E6.m1.6.6.1.1.2.1.1.1.1.2.cmml" xref="S3.E6.m1.6.6.1.1.2.1.1.1.1.1"><ci id="S3.E6.m1.5.5.cmml" xref="S3.E6.m1.5.5">𝑤</ci><interval closure="open" id="S3.E6.m1.6.6.1.1.2.1.1.1.1.1.1.2.cmml" xref="S3.E6.m1.6.6.1.1.2.1.1.1.1.1.1.1"><apply id="S3.E6.m1.6.6.1.1.2.1.1.1.1.1.1.1.1.cmml" xref="S3.E6.m1.6.6.1.1.2.1.1.1.1.1.1.1.1"><plus id="S3.E6.m1.6.6.1.1.2.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E6.m1.6.6.1.1.2.1.1.1.1.1.1.1.1.1"></plus><ci id="S3.E6.m1.6.6.1.1.2.1.1.1.1.1.1.1.1.2.cmml" xref="S3.E6.m1.6.6.1.1.2.1.1.1.1.1.1.1.1.2">𝑥</ci><apply id="S3.E6.m1.6.6.1.1.2.1.1.1.1.1.1.1.1.3.cmml" xref="S3.E6.m1.6.6.1.1.2.1.1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S3.E6.m1.6.6.1.1.2.1.1.1.1.1.1.1.1.3.1.cmml" xref="S3.E6.m1.6.6.1.1.2.1.1.1.1.1.1.1.1.3">subscript</csymbol><ci id="S3.E6.m1.6.6.1.1.2.1.1.1.1.1.1.1.1.3.2.cmml" xref="S3.E6.m1.6.6.1.1.2.1.1.1.1.1.1.1.1.3.2">𝛿</ci><ci id="S3.E6.m1.6.6.1.1.2.1.1.1.1.1.1.1.1.3.3.cmml" xref="S3.E6.m1.6.6.1.1.2.1.1.1.1.1.1.1.1.3.3">𝑖</ci></apply></apply><ci id="S3.E6.m1.4.4.cmml" xref="S3.E6.m1.4.4">𝑦</ci></interval></list></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E6.m1.6c">\operatorname*{arg\,min}_{w}\mathcal{L}_{i}(w,\delta_{i})=\mathbb{E}_{(x,y)\sim\mathcal{D}^{i}}[\ell_{i}(w;(x+\delta_{i},y))].</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(6)</span></td>
</tr></tbody>
</table>
<p id="S3.SS4.p1.4" class="ltx_p">A locally trained backbone can learn the client data distribution corresponding to a prompt on the client and prompt knowledge is passed between clients via model aggregation at the server. The backbone on the server aggregates according to the following formula:</p>
<table id="S3.E7" class="ltx_equation ltx_eqn_table">

<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math id="S3.E7.m1.3" class="ltx_Math" alttext="w^{t+1}\leftarrow\sum_{k=1}^{N}\frac{|\mathcal{D}^{i}|}{|\mathcal{D}|}w_{k}^{t}," display="block"><semantics id="S3.E7.m1.3a"><mrow id="S3.E7.m1.3.3.1" xref="S3.E7.m1.3.3.1.1.cmml"><mrow id="S3.E7.m1.3.3.1.1" xref="S3.E7.m1.3.3.1.1.cmml"><msup id="S3.E7.m1.3.3.1.1.2" xref="S3.E7.m1.3.3.1.1.2.cmml"><mi id="S3.E7.m1.3.3.1.1.2.2" xref="S3.E7.m1.3.3.1.1.2.2.cmml">w</mi><mrow id="S3.E7.m1.3.3.1.1.2.3" xref="S3.E7.m1.3.3.1.1.2.3.cmml"><mi id="S3.E7.m1.3.3.1.1.2.3.2" xref="S3.E7.m1.3.3.1.1.2.3.2.cmml">t</mi><mo id="S3.E7.m1.3.3.1.1.2.3.1" xref="S3.E7.m1.3.3.1.1.2.3.1.cmml">+</mo><mn id="S3.E7.m1.3.3.1.1.2.3.3" xref="S3.E7.m1.3.3.1.1.2.3.3.cmml">1</mn></mrow></msup><mo rspace="0.111em" stretchy="false" id="S3.E7.m1.3.3.1.1.1" xref="S3.E7.m1.3.3.1.1.1.cmml">←</mo><mrow id="S3.E7.m1.3.3.1.1.3" xref="S3.E7.m1.3.3.1.1.3.cmml"><munderover id="S3.E7.m1.3.3.1.1.3.1" xref="S3.E7.m1.3.3.1.1.3.1.cmml"><mo movablelimits="false" id="S3.E7.m1.3.3.1.1.3.1.2.2" xref="S3.E7.m1.3.3.1.1.3.1.2.2.cmml">∑</mo><mrow id="S3.E7.m1.3.3.1.1.3.1.2.3" xref="S3.E7.m1.3.3.1.1.3.1.2.3.cmml"><mi id="S3.E7.m1.3.3.1.1.3.1.2.3.2" xref="S3.E7.m1.3.3.1.1.3.1.2.3.2.cmml">k</mi><mo id="S3.E7.m1.3.3.1.1.3.1.2.3.1" xref="S3.E7.m1.3.3.1.1.3.1.2.3.1.cmml">=</mo><mn id="S3.E7.m1.3.3.1.1.3.1.2.3.3" xref="S3.E7.m1.3.3.1.1.3.1.2.3.3.cmml">1</mn></mrow><mi id="S3.E7.m1.3.3.1.1.3.1.3" xref="S3.E7.m1.3.3.1.1.3.1.3.cmml">N</mi></munderover><mrow id="S3.E7.m1.3.3.1.1.3.2" xref="S3.E7.m1.3.3.1.1.3.2.cmml"><mfrac id="S3.E7.m1.2.2" xref="S3.E7.m1.2.2.cmml"><mrow id="S3.E7.m1.1.1.1.1" xref="S3.E7.m1.1.1.1.2.cmml"><mo stretchy="false" id="S3.E7.m1.1.1.1.1.2" xref="S3.E7.m1.1.1.1.2.1.cmml">|</mo><msup id="S3.E7.m1.1.1.1.1.1" xref="S3.E7.m1.1.1.1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.E7.m1.1.1.1.1.1.2" xref="S3.E7.m1.1.1.1.1.1.2.cmml">𝒟</mi><mi id="S3.E7.m1.1.1.1.1.1.3" xref="S3.E7.m1.1.1.1.1.1.3.cmml">i</mi></msup><mo stretchy="false" id="S3.E7.m1.1.1.1.1.3" xref="S3.E7.m1.1.1.1.2.1.cmml">|</mo></mrow><mrow id="S3.E7.m1.2.2.2.3" xref="S3.E7.m1.2.2.2.2.cmml"><mo stretchy="false" id="S3.E7.m1.2.2.2.3.1" xref="S3.E7.m1.2.2.2.2.1.cmml">|</mo><mi class="ltx_font_mathcaligraphic" id="S3.E7.m1.2.2.2.1" xref="S3.E7.m1.2.2.2.1.cmml">𝒟</mi><mo stretchy="false" id="S3.E7.m1.2.2.2.3.2" xref="S3.E7.m1.2.2.2.2.1.cmml">|</mo></mrow></mfrac><mo lspace="0em" rspace="0em" id="S3.E7.m1.3.3.1.1.3.2.1" xref="S3.E7.m1.3.3.1.1.3.2.1.cmml">​</mo><msubsup id="S3.E7.m1.3.3.1.1.3.2.2" xref="S3.E7.m1.3.3.1.1.3.2.2.cmml"><mi id="S3.E7.m1.3.3.1.1.3.2.2.2.2" xref="S3.E7.m1.3.3.1.1.3.2.2.2.2.cmml">w</mi><mi id="S3.E7.m1.3.3.1.1.3.2.2.2.3" xref="S3.E7.m1.3.3.1.1.3.2.2.2.3.cmml">k</mi><mi id="S3.E7.m1.3.3.1.1.3.2.2.3" xref="S3.E7.m1.3.3.1.1.3.2.2.3.cmml">t</mi></msubsup></mrow></mrow></mrow><mo id="S3.E7.m1.3.3.1.2" xref="S3.E7.m1.3.3.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E7.m1.3b"><apply id="S3.E7.m1.3.3.1.1.cmml" xref="S3.E7.m1.3.3.1"><ci id="S3.E7.m1.3.3.1.1.1.cmml" xref="S3.E7.m1.3.3.1.1.1">←</ci><apply id="S3.E7.m1.3.3.1.1.2.cmml" xref="S3.E7.m1.3.3.1.1.2"><csymbol cd="ambiguous" id="S3.E7.m1.3.3.1.1.2.1.cmml" xref="S3.E7.m1.3.3.1.1.2">superscript</csymbol><ci id="S3.E7.m1.3.3.1.1.2.2.cmml" xref="S3.E7.m1.3.3.1.1.2.2">𝑤</ci><apply id="S3.E7.m1.3.3.1.1.2.3.cmml" xref="S3.E7.m1.3.3.1.1.2.3"><plus id="S3.E7.m1.3.3.1.1.2.3.1.cmml" xref="S3.E7.m1.3.3.1.1.2.3.1"></plus><ci id="S3.E7.m1.3.3.1.1.2.3.2.cmml" xref="S3.E7.m1.3.3.1.1.2.3.2">𝑡</ci><cn type="integer" id="S3.E7.m1.3.3.1.1.2.3.3.cmml" xref="S3.E7.m1.3.3.1.1.2.3.3">1</cn></apply></apply><apply id="S3.E7.m1.3.3.1.1.3.cmml" xref="S3.E7.m1.3.3.1.1.3"><apply id="S3.E7.m1.3.3.1.1.3.1.cmml" xref="S3.E7.m1.3.3.1.1.3.1"><csymbol cd="ambiguous" id="S3.E7.m1.3.3.1.1.3.1.1.cmml" xref="S3.E7.m1.3.3.1.1.3.1">superscript</csymbol><apply id="S3.E7.m1.3.3.1.1.3.1.2.cmml" xref="S3.E7.m1.3.3.1.1.3.1"><csymbol cd="ambiguous" id="S3.E7.m1.3.3.1.1.3.1.2.1.cmml" xref="S3.E7.m1.3.3.1.1.3.1">subscript</csymbol><sum id="S3.E7.m1.3.3.1.1.3.1.2.2.cmml" xref="S3.E7.m1.3.3.1.1.3.1.2.2"></sum><apply id="S3.E7.m1.3.3.1.1.3.1.2.3.cmml" xref="S3.E7.m1.3.3.1.1.3.1.2.3"><eq id="S3.E7.m1.3.3.1.1.3.1.2.3.1.cmml" xref="S3.E7.m1.3.3.1.1.3.1.2.3.1"></eq><ci id="S3.E7.m1.3.3.1.1.3.1.2.3.2.cmml" xref="S3.E7.m1.3.3.1.1.3.1.2.3.2">𝑘</ci><cn type="integer" id="S3.E7.m1.3.3.1.1.3.1.2.3.3.cmml" xref="S3.E7.m1.3.3.1.1.3.1.2.3.3">1</cn></apply></apply><ci id="S3.E7.m1.3.3.1.1.3.1.3.cmml" xref="S3.E7.m1.3.3.1.1.3.1.3">𝑁</ci></apply><apply id="S3.E7.m1.3.3.1.1.3.2.cmml" xref="S3.E7.m1.3.3.1.1.3.2"><times id="S3.E7.m1.3.3.1.1.3.2.1.cmml" xref="S3.E7.m1.3.3.1.1.3.2.1"></times><apply id="S3.E7.m1.2.2.cmml" xref="S3.E7.m1.2.2"><divide id="S3.E7.m1.2.2.3.cmml" xref="S3.E7.m1.2.2"></divide><apply id="S3.E7.m1.1.1.1.2.cmml" xref="S3.E7.m1.1.1.1.1"><abs id="S3.E7.m1.1.1.1.2.1.cmml" xref="S3.E7.m1.1.1.1.1.2"></abs><apply id="S3.E7.m1.1.1.1.1.1.cmml" xref="S3.E7.m1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E7.m1.1.1.1.1.1.1.cmml" xref="S3.E7.m1.1.1.1.1.1">superscript</csymbol><ci id="S3.E7.m1.1.1.1.1.1.2.cmml" xref="S3.E7.m1.1.1.1.1.1.2">𝒟</ci><ci id="S3.E7.m1.1.1.1.1.1.3.cmml" xref="S3.E7.m1.1.1.1.1.1.3">𝑖</ci></apply></apply><apply id="S3.E7.m1.2.2.2.2.cmml" xref="S3.E7.m1.2.2.2.3"><abs id="S3.E7.m1.2.2.2.2.1.cmml" xref="S3.E7.m1.2.2.2.3.1"></abs><ci id="S3.E7.m1.2.2.2.1.cmml" xref="S3.E7.m1.2.2.2.1">𝒟</ci></apply></apply><apply id="S3.E7.m1.3.3.1.1.3.2.2.cmml" xref="S3.E7.m1.3.3.1.1.3.2.2"><csymbol cd="ambiguous" id="S3.E7.m1.3.3.1.1.3.2.2.1.cmml" xref="S3.E7.m1.3.3.1.1.3.2.2">superscript</csymbol><apply id="S3.E7.m1.3.3.1.1.3.2.2.2.cmml" xref="S3.E7.m1.3.3.1.1.3.2.2"><csymbol cd="ambiguous" id="S3.E7.m1.3.3.1.1.3.2.2.2.1.cmml" xref="S3.E7.m1.3.3.1.1.3.2.2">subscript</csymbol><ci id="S3.E7.m1.3.3.1.1.3.2.2.2.2.cmml" xref="S3.E7.m1.3.3.1.1.3.2.2.2.2">𝑤</ci><ci id="S3.E7.m1.3.3.1.1.3.2.2.2.3.cmml" xref="S3.E7.m1.3.3.1.1.3.2.2.2.3">𝑘</ci></apply><ci id="S3.E7.m1.3.3.1.1.3.2.2.3.cmml" xref="S3.E7.m1.3.3.1.1.3.2.2.3">𝑡</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E7.m1.3c">w^{t+1}\leftarrow\sum_{k=1}^{N}\frac{|\mathcal{D}^{i}|}{|\mathcal{D}|}w_{k}^{t},</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(7)</span></td>
</tr></tbody>
</table>
<p id="S3.SS4.p1.2" class="ltx_p">where <math id="S3.SS4.p1.2.m1.1" class="ltx_Math" alttext="t" display="inline"><semantics id="S3.SS4.p1.2.m1.1a"><mi id="S3.SS4.p1.2.m1.1.1" xref="S3.SS4.p1.2.m1.1.1.cmml">t</mi><annotation-xml encoding="MathML-Content" id="S3.SS4.p1.2.m1.1b"><ci id="S3.SS4.p1.2.m1.1.1.cmml" xref="S3.SS4.p1.2.m1.1.1">𝑡</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS4.p1.2.m1.1c">t</annotation></semantics></math> represents the number of training rounds. We summarize the detailed procedures of pFedPT in Algorithm <a href="#algorithm1" title="In 3.3 Modeling for pFedPT ‣ 3 Methodology ‣ Visual Prompt Based Personalized Federated Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">1</span></a>.</p>
</div>
<div id="S3.SS4.p2" class="ltx_para">
<p id="S3.SS4.p2.1" class="ltx_p">In the end, we give several comments on the differences between our pFedPT and decoupled FedRep <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib8" title="" class="ltx_ref">8</a>]</cite>. Fig.<a href="#S3.F3" title="Figure 3 ‣ 3.4 Optimization for pFedPT ‣ 3 Methodology ‣ Visual Prompt Based Personalized Federated Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">3</span></a> describes their training process. Note that pFedPT also has a private part and a public part, but the private part is the prompt generator that we added at the client data level additionally. The personalized visual prompt generated adds the client’s personalized knowledge to the training process by fine-tuning backbone’s input without changing backbone’s inference process. FedRep is to separate the private part in the inference model, and different clients have different inference processes. The objective functions of FedRep and pFedPT are also different. Furthermore, the visual prompt is orthogonal to FedRep type methods, which can be integrated together to further boost their performance.</p>
</div>
<figure id="S3.F3" class="ltx_figure"><img src="/html/2303.08678/assets/x3.png" id="S3.F3.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="264" height="191" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 3: </span>Differences between pFedPT and decoupled personalized FL algorithm (FedRep)</figcaption>
</figure>
</section>
</section>
<section id="S4" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">4 </span>Experiments</h2>

<div id="S4.p1" class="ltx_para">
<p id="S4.p1.1" class="ltx_p">In this section, we evaluate the effectiveness of pFedPT and compare it with several advanced methods in various datasets and settings. We also conduct a number of exploratory experiments to find out how pFedPT works and verify the effectiveness of pFedPT in terms of client data distribution. The detailed experimental setup and the more experimental results can be found in the Appendix.</p>
</div>
<figure id="S4.T1" class="ltx_table">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table">Table 1: </span>The results of pFedPT and baseline methods on the image datasets with different non-IID settings</figcaption>
<div id="S4.T1.1" class="ltx_inline-block ltx_align_center ltx_transformed_outer" style="width:447.2pt;height:190.5pt;vertical-align:-0.9pt;"><span class="ltx_transformed_inner" style="transform:translate(-31.2pt,13.2pt) scale(0.877705852201967,0.877705852201967) ;">
<table id="S4.T1.1.1" class="ltx_tabular ltx_guessed_headers ltx_align_middle">
<tbody class="ltx_tbody">
<tr id="S4.T1.1.1.1.1" class="ltx_tr">
<th id="S4.T1.1.1.1.1.1" class="ltx_td ltx_th ltx_th_row ltx_border_t" style="padding-top:1.25pt;padding-bottom:1.25pt;"></th>
<th id="S4.T1.1.1.1.1.2" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" style="padding-top:1.25pt;padding-bottom:1.25pt;" colspan="6">CIFAR10</th>
<th id="S4.T1.1.1.1.1.3" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" style="padding-top:1.25pt;padding-bottom:1.25pt;" colspan="6">CIFAR100</th>
<td id="S4.T1.1.1.1.1.4" class="ltx_td ltx_border_t" style="padding-top:1.25pt;padding-bottom:1.25pt;"></td>
</tr>
<tr id="S4.T1.1.1.2.2" class="ltx_tr">
<th id="S4.T1.1.1.2.2.1" class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_th_row" style="padding-top:1.25pt;padding-bottom:1.25pt;">#setting</th>
<th id="S4.T1.1.1.2.2.2" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" style="padding-top:1.25pt;padding-bottom:1.25pt;" colspan="2">IID</th>
<th id="S4.T1.1.1.2.2.3" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" style="padding-top:1.25pt;padding-bottom:1.25pt;" colspan="2">Dirichlet</th>
<th id="S4.T1.1.1.2.2.4" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" style="padding-top:1.25pt;padding-bottom:1.25pt;" colspan="2">Pathological</th>
<th id="S4.T1.1.1.2.2.5" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" style="padding-top:1.25pt;padding-bottom:1.25pt;" colspan="2">IID</th>
<th id="S4.T1.1.1.2.2.6" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" style="padding-top:1.25pt;padding-bottom:1.25pt;" colspan="2">Dirichlet</th>
<th id="S4.T1.1.1.2.2.7" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" style="padding-top:1.25pt;padding-bottom:1.25pt;" colspan="2">Pathological</th>
<td id="S4.T1.1.1.2.2.8" class="ltx_td" style="padding-top:1.25pt;padding-bottom:1.25pt;"></td>
</tr>
<tr id="S4.T1.1.1.3.3" class="ltx_tr">
<th id="S4.T1.1.1.3.3.1" class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_th_row" style="padding-top:1.25pt;padding-bottom:1.25pt;">#client</th>
<th id="S4.T1.1.1.3.3.2" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" style="padding-top:1.25pt;padding-bottom:1.25pt;">ViT</th>
<th id="S4.T1.1.1.3.3.3" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" style="padding-top:1.25pt;padding-bottom:1.25pt;">CNN</th>
<th id="S4.T1.1.1.3.3.4" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" style="padding-top:1.25pt;padding-bottom:1.25pt;">ViT</th>
<th id="S4.T1.1.1.3.3.5" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" style="padding-top:1.25pt;padding-bottom:1.25pt;">CNN</th>
<th id="S4.T1.1.1.3.3.6" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" style="padding-top:1.25pt;padding-bottom:1.25pt;">ViT</th>
<th id="S4.T1.1.1.3.3.7" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" style="padding-top:1.25pt;padding-bottom:1.25pt;">CNN</th>
<th id="S4.T1.1.1.3.3.8" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" style="padding-top:1.25pt;padding-bottom:1.25pt;">ViT</th>
<th id="S4.T1.1.1.3.3.9" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" style="padding-top:1.25pt;padding-bottom:1.25pt;">CNN</th>
<th id="S4.T1.1.1.3.3.10" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" style="padding-top:1.25pt;padding-bottom:1.25pt;">ViT</th>
<th id="S4.T1.1.1.3.3.11" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" style="padding-top:1.25pt;padding-bottom:1.25pt;">CNN</th>
<th id="S4.T1.1.1.3.3.12" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" style="padding-top:1.25pt;padding-bottom:1.25pt;">ViT</th>
<th id="S4.T1.1.1.3.3.13" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" style="padding-top:1.25pt;padding-bottom:1.25pt;">CNN</th>
<td id="S4.T1.1.1.3.3.14" class="ltx_td" style="padding-top:1.25pt;padding-bottom:1.25pt;"></td>
</tr>
<tr id="S4.T1.1.1.4.4" class="ltx_tr">
<th id="S4.T1.1.1.4.4.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t" style="padding-top:1.25pt;padding-bottom:1.25pt;">FedAvg</th>
<td id="S4.T1.1.1.4.4.2" class="ltx_td ltx_align_center ltx_border_t" style="padding-top:1.25pt;padding-bottom:1.25pt;">60.50</td>
<td id="S4.T1.1.1.4.4.3" class="ltx_td ltx_align_center ltx_border_t" style="padding-top:1.25pt;padding-bottom:1.25pt;"><span id="S4.T1.1.1.4.4.3.1" class="ltx_text ltx_font_bold">67.13</span></td>
<td id="S4.T1.1.1.4.4.4" class="ltx_td ltx_align_center ltx_border_t" style="padding-top:1.25pt;padding-bottom:1.25pt;">53.01</td>
<td id="S4.T1.1.1.4.4.5" class="ltx_td ltx_align_center ltx_border_t" style="padding-top:1.25pt;padding-bottom:1.25pt;">61.92</td>
<td id="S4.T1.1.1.4.4.6" class="ltx_td ltx_align_center ltx_border_t" style="padding-top:1.25pt;padding-bottom:1.25pt;">54.98</td>
<td id="S4.T1.1.1.4.4.7" class="ltx_td ltx_align_center ltx_border_t" style="padding-top:1.25pt;padding-bottom:1.25pt;">63.62</td>
<td id="S4.T1.1.1.4.4.8" class="ltx_td ltx_align_center ltx_border_t" style="padding-top:1.25pt;padding-bottom:1.25pt;">29.60</td>
<td id="S4.T1.1.1.4.4.9" class="ltx_td ltx_align_center ltx_border_t" style="padding-top:1.25pt;padding-bottom:1.25pt;">26.42</td>
<td id="S4.T1.1.1.4.4.10" class="ltx_td ltx_align_center ltx_border_t" style="padding-top:1.25pt;padding-bottom:1.25pt;">25.93</td>
<td id="S4.T1.1.1.4.4.11" class="ltx_td ltx_align_center ltx_border_t" style="padding-top:1.25pt;padding-bottom:1.25pt;">26.50</td>
<td id="S4.T1.1.1.4.4.12" class="ltx_td ltx_align_center ltx_border_t" style="padding-top:1.25pt;padding-bottom:1.25pt;">27.71</td>
<td id="S4.T1.1.1.4.4.13" class="ltx_td ltx_align_center ltx_border_t" style="padding-top:1.25pt;padding-bottom:1.25pt;">30.28</td>
<td id="S4.T1.1.1.4.4.14" class="ltx_td ltx_border_t" style="padding-top:1.25pt;padding-bottom:1.25pt;"></td>
</tr>
<tr id="S4.T1.1.1.5.5" class="ltx_tr">
<th id="S4.T1.1.1.5.5.1" class="ltx_td ltx_align_left ltx_th ltx_th_row" style="padding-top:1.25pt;padding-bottom:1.25pt;">FedProx</th>
<td id="S4.T1.1.1.5.5.2" class="ltx_td ltx_align_center" style="padding-top:1.25pt;padding-bottom:1.25pt;">57.04</td>
<td id="S4.T1.1.1.5.5.3" class="ltx_td ltx_align_center" style="padding-top:1.25pt;padding-bottom:1.25pt;">66.94</td>
<td id="S4.T1.1.1.5.5.4" class="ltx_td ltx_align_center" style="padding-top:1.25pt;padding-bottom:1.25pt;">53.14</td>
<td id="S4.T1.1.1.5.5.5" class="ltx_td ltx_align_center" style="padding-top:1.25pt;padding-bottom:1.25pt;">61.95</td>
<td id="S4.T1.1.1.5.5.6" class="ltx_td ltx_align_center" style="padding-top:1.25pt;padding-bottom:1.25pt;">55.02</td>
<td id="S4.T1.1.1.5.5.7" class="ltx_td ltx_align_center" style="padding-top:1.25pt;padding-bottom:1.25pt;">63.29</td>
<td id="S4.T1.1.1.5.5.8" class="ltx_td ltx_align_center" style="padding-top:1.25pt;padding-bottom:1.25pt;">27.71</td>
<td id="S4.T1.1.1.5.5.9" class="ltx_td ltx_align_center" style="padding-top:1.25pt;padding-bottom:1.25pt;">26.29</td>
<td id="S4.T1.1.1.5.5.10" class="ltx_td ltx_align_center" style="padding-top:1.25pt;padding-bottom:1.25pt;">26.00</td>
<td id="S4.T1.1.1.5.5.11" class="ltx_td ltx_align_center" style="padding-top:1.25pt;padding-bottom:1.25pt;">26.48</td>
<td id="S4.T1.1.1.5.5.12" class="ltx_td ltx_align_center" style="padding-top:1.25pt;padding-bottom:1.25pt;">27.84</td>
<td id="S4.T1.1.1.5.5.13" class="ltx_td ltx_align_center" style="padding-top:1.25pt;padding-bottom:1.25pt;">30.52</td>
<td id="S4.T1.1.1.5.5.14" class="ltx_td" style="padding-top:1.25pt;padding-bottom:1.25pt;"></td>
</tr>
<tr id="S4.T1.1.1.6.6" class="ltx_tr">
<th id="S4.T1.1.1.6.6.1" class="ltx_td ltx_align_left ltx_th ltx_th_row" style="padding-top:1.25pt;padding-bottom:1.25pt;">MOON</th>
<td id="S4.T1.1.1.6.6.2" class="ltx_td ltx_align_center" style="padding-top:1.25pt;padding-bottom:1.25pt;">60.99</td>
<td id="S4.T1.1.1.6.6.3" class="ltx_td ltx_align_center" style="padding-top:1.25pt;padding-bottom:1.25pt;">66.88</td>
<td id="S4.T1.1.1.6.6.4" class="ltx_td ltx_align_center" style="padding-top:1.25pt;padding-bottom:1.25pt;">61.12</td>
<td id="S4.T1.1.1.6.6.5" class="ltx_td ltx_align_center" style="padding-top:1.25pt;padding-bottom:1.25pt;">62.53</td>
<td id="S4.T1.1.1.6.6.6" class="ltx_td ltx_align_center" style="padding-top:1.25pt;padding-bottom:1.25pt;">65.98</td>
<td id="S4.T1.1.1.6.6.7" class="ltx_td ltx_align_center" style="padding-top:1.25pt;padding-bottom:1.25pt;">63.52</td>
<td id="S4.T1.1.1.6.6.8" class="ltx_td ltx_align_center" style="padding-top:1.25pt;padding-bottom:1.25pt;">29.32</td>
<td id="S4.T1.1.1.6.6.9" class="ltx_td ltx_align_center" style="padding-top:1.25pt;padding-bottom:1.25pt;"><span id="S4.T1.1.1.6.6.9.1" class="ltx_text ltx_font_bold">26.43</span></td>
<td id="S4.T1.1.1.6.6.10" class="ltx_td ltx_align_center" style="padding-top:1.25pt;padding-bottom:1.25pt;">24.95</td>
<td id="S4.T1.1.1.6.6.11" class="ltx_td ltx_align_center" style="padding-top:1.25pt;padding-bottom:1.25pt;">26.93</td>
<td id="S4.T1.1.1.6.6.12" class="ltx_td ltx_align_center" style="padding-top:1.25pt;padding-bottom:1.25pt;">27.61</td>
<td id="S4.T1.1.1.6.6.13" class="ltx_td ltx_align_center" style="padding-top:1.25pt;padding-bottom:1.25pt;">29.00</td>
<td id="S4.T1.1.1.6.6.14" class="ltx_td" style="padding-top:1.25pt;padding-bottom:1.25pt;"></td>
</tr>
<tr id="S4.T1.1.1.7.7" class="ltx_tr">
<th id="S4.T1.1.1.7.7.1" class="ltx_td ltx_align_left ltx_th ltx_th_row" style="padding-top:1.25pt;padding-bottom:1.25pt;">FedPer</th>
<td id="S4.T1.1.1.7.7.2" class="ltx_td ltx_align_center" style="padding-top:1.25pt;padding-bottom:1.25pt;"><span id="S4.T1.1.1.7.7.2.1" class="ltx_text ltx_font_bold">61.57</span></td>
<td id="S4.T1.1.1.7.7.3" class="ltx_td ltx_align_center" style="padding-top:1.25pt;padding-bottom:1.25pt;">51.46</td>
<td id="S4.T1.1.1.7.7.4" class="ltx_td ltx_align_center" style="padding-top:1.25pt;padding-bottom:1.25pt;">73.16</td>
<td id="S4.T1.1.1.7.7.5" class="ltx_td ltx_align_center" style="padding-top:1.25pt;padding-bottom:1.25pt;">77.98</td>
<td id="S4.T1.1.1.7.7.6" class="ltx_td ltx_align_center" style="padding-top:1.25pt;padding-bottom:1.25pt;">75.20</td>
<td id="S4.T1.1.1.7.7.7" class="ltx_td ltx_align_center" style="padding-top:1.25pt;padding-bottom:1.25pt;">79.97</td>
<td id="S4.T1.1.1.7.7.8" class="ltx_td ltx_align_center" style="padding-top:1.25pt;padding-bottom:1.25pt;">29.74</td>
<td id="S4.T1.1.1.7.7.9" class="ltx_td ltx_align_center" style="padding-top:1.25pt;padding-bottom:1.25pt;">10.82</td>
<td id="S4.T1.1.1.7.7.10" class="ltx_td ltx_align_center" style="padding-top:1.25pt;padding-bottom:1.25pt;">36.78</td>
<td id="S4.T1.1.1.7.7.11" class="ltx_td ltx_align_center" style="padding-top:1.25pt;padding-bottom:1.25pt;">27.79</td>
<td id="S4.T1.1.1.7.7.12" class="ltx_td ltx_align_center" style="padding-top:1.25pt;padding-bottom:1.25pt;">35.36</td>
<td id="S4.T1.1.1.7.7.13" class="ltx_td ltx_align_center" style="padding-top:1.25pt;padding-bottom:1.25pt;">31.13</td>
<td id="S4.T1.1.1.7.7.14" class="ltx_td" style="padding-top:1.25pt;padding-bottom:1.25pt;"></td>
</tr>
<tr id="S4.T1.1.1.8.8" class="ltx_tr">
<th id="S4.T1.1.1.8.8.1" class="ltx_td ltx_align_left ltx_th ltx_th_row" style="padding-top:1.25pt;padding-bottom:1.25pt;">FedRep</th>
<td id="S4.T1.1.1.8.8.2" class="ltx_td ltx_align_center" style="padding-top:1.25pt;padding-bottom:1.25pt;">48.38</td>
<td id="S4.T1.1.1.8.8.3" class="ltx_td ltx_align_center" style="padding-top:1.25pt;padding-bottom:1.25pt;">49.70</td>
<td id="S4.T1.1.1.8.8.4" class="ltx_td ltx_align_center" style="padding-top:1.25pt;padding-bottom:1.25pt;">74.11</td>
<td id="S4.T1.1.1.8.8.5" class="ltx_td ltx_align_center" style="padding-top:1.25pt;padding-bottom:1.25pt;">77.65</td>
<td id="S4.T1.1.1.8.8.6" class="ltx_td ltx_align_center" style="padding-top:1.25pt;padding-bottom:1.25pt;">74.48</td>
<td id="S4.T1.1.1.8.8.7" class="ltx_td ltx_align_center" style="padding-top:1.25pt;padding-bottom:1.25pt;">78.39</td>
<td id="S4.T1.1.1.8.8.8" class="ltx_td ltx_align_center" style="padding-top:1.25pt;padding-bottom:1.25pt;">17.84</td>
<td id="S4.T1.1.1.8.8.9" class="ltx_td ltx_align_center" style="padding-top:1.25pt;padding-bottom:1.25pt;">9.13</td>
<td id="S4.T1.1.1.8.8.10" class="ltx_td ltx_align_center" style="padding-top:1.25pt;padding-bottom:1.25pt;">35.06</td>
<td id="S4.T1.1.1.8.8.11" class="ltx_td ltx_align_center" style="padding-top:1.25pt;padding-bottom:1.25pt;">27.39</td>
<td id="S4.T1.1.1.8.8.12" class="ltx_td ltx_align_center" style="padding-top:1.25pt;padding-bottom:1.25pt;">36.13</td>
<td id="S4.T1.1.1.8.8.13" class="ltx_td ltx_align_center" style="padding-top:1.25pt;padding-bottom:1.25pt;">32.41</td>
<td id="S4.T1.1.1.8.8.14" class="ltx_td" style="padding-top:1.25pt;padding-bottom:1.25pt;"></td>
</tr>
<tr id="S4.T1.1.1.9.9" class="ltx_tr">
<th id="S4.T1.1.1.9.9.1" class="ltx_td ltx_align_left ltx_th ltx_th_row" style="padding-top:1.25pt;padding-bottom:1.25pt;">FedMTL</th>
<td id="S4.T1.1.1.9.9.2" class="ltx_td ltx_align_center" style="padding-top:1.25pt;padding-bottom:1.25pt;">45.65</td>
<td id="S4.T1.1.1.9.9.3" class="ltx_td ltx_align_center" style="padding-top:1.25pt;padding-bottom:1.25pt;">45.65</td>
<td id="S4.T1.1.1.9.9.4" class="ltx_td ltx_align_center" style="padding-top:1.25pt;padding-bottom:1.25pt;">68.48</td>
<td id="S4.T1.1.1.9.9.5" class="ltx_td ltx_align_center" style="padding-top:1.25pt;padding-bottom:1.25pt;">73.95</td>
<td id="S4.T1.1.1.9.9.6" class="ltx_td ltx_align_center" style="padding-top:1.25pt;padding-bottom:1.25pt;">65.39</td>
<td id="S4.T1.1.1.9.9.7" class="ltx_td ltx_align_center" style="padding-top:1.25pt;padding-bottom:1.25pt;">70.94</td>
<td id="S4.T1.1.1.9.9.8" class="ltx_td ltx_align_center" style="padding-top:1.25pt;padding-bottom:1.25pt;">17.91</td>
<td id="S4.T1.1.1.9.9.9" class="ltx_td ltx_align_center" style="padding-top:1.25pt;padding-bottom:1.25pt;">7.34</td>
<td id="S4.T1.1.1.9.9.10" class="ltx_td ltx_align_center" style="padding-top:1.25pt;padding-bottom:1.25pt;">26.08</td>
<td id="S4.T1.1.1.9.9.11" class="ltx_td ltx_align_center" style="padding-top:1.25pt;padding-bottom:1.25pt;">25.85</td>
<td id="S4.T1.1.1.9.9.12" class="ltx_td ltx_align_center" style="padding-top:1.25pt;padding-bottom:1.25pt;">25.46</td>
<td id="S4.T1.1.1.9.9.13" class="ltx_td ltx_align_center" style="padding-top:1.25pt;padding-bottom:1.25pt;">26.32</td>
<td id="S4.T1.1.1.9.9.14" class="ltx_td" style="padding-top:1.25pt;padding-bottom:1.25pt;"></td>
</tr>
<tr id="S4.T1.1.1.10.10" class="ltx_tr">
<th id="S4.T1.1.1.10.10.1" class="ltx_td ltx_align_left ltx_th ltx_th_row" style="padding-top:1.25pt;padding-bottom:1.25pt;">FedBABU</th>
<td id="S4.T1.1.1.10.10.2" class="ltx_td ltx_align_center" style="padding-top:1.25pt;padding-bottom:1.25pt;">50.41</td>
<td id="S4.T1.1.1.10.10.3" class="ltx_td ltx_align_center" style="padding-top:1.25pt;padding-bottom:1.25pt;">61.17</td>
<td id="S4.T1.1.1.10.10.4" class="ltx_td ltx_align_center" style="padding-top:1.25pt;padding-bottom:1.25pt;">74.21</td>
<td id="S4.T1.1.1.10.10.5" class="ltx_td ltx_align_center" style="padding-top:1.25pt;padding-bottom:1.25pt;">80.11</td>
<td id="S4.T1.1.1.10.10.6" class="ltx_td ltx_align_center" style="padding-top:1.25pt;padding-bottom:1.25pt;">74.30</td>
<td id="S4.T1.1.1.10.10.7" class="ltx_td ltx_align_center" style="padding-top:1.25pt;padding-bottom:1.25pt;">80.69</td>
<td id="S4.T1.1.1.10.10.8" class="ltx_td ltx_align_center" style="padding-top:1.25pt;padding-bottom:1.25pt;">20.61</td>
<td id="S4.T1.1.1.10.10.9" class="ltx_td ltx_align_center" style="padding-top:1.25pt;padding-bottom:1.25pt;">22.55</td>
<td id="S4.T1.1.1.10.10.10" class="ltx_td ltx_align_center" style="padding-top:1.25pt;padding-bottom:1.25pt;">36.17</td>
<td id="S4.T1.1.1.10.10.11" class="ltx_td ltx_align_center" style="padding-top:1.25pt;padding-bottom:1.25pt;">31.66</td>
<td id="S4.T1.1.1.10.10.12" class="ltx_td ltx_align_center" style="padding-top:1.25pt;padding-bottom:1.25pt;">35.74</td>
<td id="S4.T1.1.1.10.10.13" class="ltx_td ltx_align_center" style="padding-top:1.25pt;padding-bottom:1.25pt;">35.45</td>
<td id="S4.T1.1.1.10.10.14" class="ltx_td" style="padding-top:1.25pt;padding-bottom:1.25pt;"></td>
</tr>
<tr id="S4.T1.1.1.11.11" class="ltx_tr">
<th id="S4.T1.1.1.11.11.1" class="ltx_td ltx_align_left ltx_th ltx_th_row" style="padding-top:1.25pt;padding-bottom:1.25pt;">Local</th>
<td id="S4.T1.1.1.11.11.2" class="ltx_td ltx_align_center" style="padding-top:1.25pt;padding-bottom:1.25pt;">45.37</td>
<td id="S4.T1.1.1.11.11.3" class="ltx_td ltx_align_center" style="padding-top:1.25pt;padding-bottom:1.25pt;">39.04</td>
<td id="S4.T1.1.1.11.11.4" class="ltx_td ltx_align_center" style="padding-top:1.25pt;padding-bottom:1.25pt;">68.40</td>
<td id="S4.T1.1.1.11.11.5" class="ltx_td ltx_align_center" style="padding-top:1.25pt;padding-bottom:1.25pt;">73.98</td>
<td id="S4.T1.1.1.11.11.6" class="ltx_td ltx_align_center" style="padding-top:1.25pt;padding-bottom:1.25pt;">64.83</td>
<td id="S4.T1.1.1.11.11.7" class="ltx_td ltx_align_center" style="padding-top:1.25pt;padding-bottom:1.25pt;">70.76</td>
<td id="S4.T1.1.1.11.11.8" class="ltx_td ltx_align_center" style="padding-top:1.25pt;padding-bottom:1.25pt;">18.01</td>
<td id="S4.T1.1.1.11.11.9" class="ltx_td ltx_align_center" style="padding-top:1.25pt;padding-bottom:1.25pt;">7.33</td>
<td id="S4.T1.1.1.11.11.10" class="ltx_td ltx_align_center" style="padding-top:1.25pt;padding-bottom:1.25pt;">26.23</td>
<td id="S4.T1.1.1.11.11.11" class="ltx_td ltx_align_center" style="padding-top:1.25pt;padding-bottom:1.25pt;">25.15</td>
<td id="S4.T1.1.1.11.11.12" class="ltx_td ltx_align_center" style="padding-top:1.25pt;padding-bottom:1.25pt;">24.65</td>
<td id="S4.T1.1.1.11.11.13" class="ltx_td ltx_align_center" style="padding-top:1.25pt;padding-bottom:1.25pt;">25.34</td>
<td id="S4.T1.1.1.11.11.14" class="ltx_td" style="padding-top:1.25pt;padding-bottom:1.25pt;"></td>
</tr>
<tr id="S4.T1.1.1.12.12" class="ltx_tr">
<th id="S4.T1.1.1.12.12.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_b ltx_border_t" style="padding-top:1.25pt;padding-bottom:1.25pt;">pFedPT (ours)</th>
<td id="S4.T1.1.1.12.12.2" class="ltx_td ltx_align_center ltx_border_b ltx_border_t" style="padding-top:1.25pt;padding-bottom:1.25pt;">60.01</td>
<td id="S4.T1.1.1.12.12.3" class="ltx_td ltx_align_center ltx_border_b ltx_border_t" style="padding-top:1.25pt;padding-bottom:1.25pt;">66.09</td>
<td id="S4.T1.1.1.12.12.4" class="ltx_td ltx_align_center ltx_border_b ltx_border_t" style="padding-top:1.25pt;padding-bottom:1.25pt;"><span id="S4.T1.1.1.12.12.4.1" class="ltx_text ltx_font_bold">74.92</span></td>
<td id="S4.T1.1.1.12.12.5" class="ltx_td ltx_align_center ltx_border_b ltx_border_t" style="padding-top:1.25pt;padding-bottom:1.25pt;"><span id="S4.T1.1.1.12.12.5.1" class="ltx_text ltx_font_bold">80.83</span></td>
<td id="S4.T1.1.1.12.12.6" class="ltx_td ltx_align_center ltx_border_b ltx_border_t" style="padding-top:1.25pt;padding-bottom:1.25pt;"><span id="S4.T1.1.1.12.12.6.1" class="ltx_text ltx_font_bold">75.42</span></td>
<td id="S4.T1.1.1.12.12.7" class="ltx_td ltx_align_center ltx_border_b ltx_border_t" style="padding-top:1.25pt;padding-bottom:1.25pt;"><span id="S4.T1.1.1.12.12.7.1" class="ltx_text ltx_font_bold">81.16</span></td>
<td id="S4.T1.1.1.12.12.8" class="ltx_td ltx_align_center ltx_border_b ltx_border_t" style="padding-top:1.25pt;padding-bottom:1.25pt;"><span id="S4.T1.1.1.12.12.8.1" class="ltx_text ltx_font_bold">31.66</span></td>
<td id="S4.T1.1.1.12.12.9" class="ltx_td ltx_align_center ltx_border_b ltx_border_t" style="padding-top:1.25pt;padding-bottom:1.25pt;">26.41</td>
<td id="S4.T1.1.1.12.12.10" class="ltx_td ltx_align_center ltx_border_b ltx_border_t" style="padding-top:1.25pt;padding-bottom:1.25pt;"><span id="S4.T1.1.1.12.12.10.1" class="ltx_text ltx_font_bold">36.80</span></td>
<td id="S4.T1.1.1.12.12.11" class="ltx_td ltx_align_center ltx_border_b ltx_border_t" style="padding-top:1.25pt;padding-bottom:1.25pt;"><span id="S4.T1.1.1.12.12.11.1" class="ltx_text ltx_font_bold">32.47</span></td>
<td id="S4.T1.1.1.12.12.12" class="ltx_td ltx_align_center ltx_border_b ltx_border_t" style="padding-top:1.25pt;padding-bottom:1.25pt;"><span id="S4.T1.1.1.12.12.12.1" class="ltx_text ltx_font_bold">36.88</span></td>
<td id="S4.T1.1.1.12.12.13" class="ltx_td ltx_align_center ltx_border_b ltx_border_t" style="padding-top:1.25pt;padding-bottom:1.25pt;"><span id="S4.T1.1.1.12.12.13.1" class="ltx_text ltx_font_bold">37.98</span></td>
<td id="S4.T1.1.1.12.12.14" class="ltx_td ltx_border_b ltx_border_t" style="padding-top:1.25pt;padding-bottom:1.25pt;"></td>
</tr>
</tbody>
</table>
</span></div>
</figure>
<figure id="S4.T2" class="ltx_table">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_table">Table 2: </span>The results of baseline methods with prompts on the image datasets with CNN model in Non-IID settings.</figcaption>
<div id="S4.T2.1" class="ltx_inline-block ltx_align_center ltx_transformed_outer" style="width:223.6pt;height:120.6pt;vertical-align:-0.0pt;"><span class="ltx_transformed_inner" style="transform:translate(-55.0pt,29.7pt) scale(0.670191876258086,0.670191876258086) ;">
<table id="S4.T2.1.1" class="ltx_tabular ltx_guessed_headers ltx_align_middle">
<tbody class="ltx_tbody">
<tr id="S4.T2.1.1.1.1" class="ltx_tr">
<th id="S4.T2.1.1.1.1.1" class="ltx_td ltx_th ltx_th_row ltx_border_t" style="padding-top:1.25pt;padding-bottom:1.25pt;"></th>
<th id="S4.T2.1.1.1.1.2" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" style="padding-top:1.25pt;padding-bottom:1.25pt;" colspan="2">CIFAR10</th>
<th id="S4.T2.1.1.1.1.3" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" style="padding-top:1.25pt;padding-bottom:1.25pt;" colspan="2">CIFAR100</th>
<td id="S4.T2.1.1.1.1.4" class="ltx_td ltx_border_t" style="padding-top:1.25pt;padding-bottom:1.25pt;"></td>
</tr>
<tr id="S4.T2.1.1.2.2" class="ltx_tr">
<th id="S4.T2.1.1.2.2.1" class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_th_row" style="padding-top:1.25pt;padding-bottom:1.25pt;">#setting</th>
<th id="S4.T2.1.1.2.2.2" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" style="padding-top:1.25pt;padding-bottom:1.25pt;">Dirichlet</th>
<th id="S4.T2.1.1.2.2.3" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" style="padding-top:1.25pt;padding-bottom:1.25pt;">Pathological</th>
<th id="S4.T2.1.1.2.2.4" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" style="padding-top:1.25pt;padding-bottom:1.25pt;">Dirichlet</th>
<th id="S4.T2.1.1.2.2.5" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" style="padding-top:1.25pt;padding-bottom:1.25pt;">Pathological</th>
<td id="S4.T2.1.1.2.2.6" class="ltx_td" style="padding-top:1.25pt;padding-bottom:1.25pt;"></td>
</tr>
<tr id="S4.T2.1.1.3.3" class="ltx_tr">
<th id="S4.T2.1.1.3.3.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t" style="padding-top:1.25pt;padding-bottom:1.25pt;">FedProx</th>
<td id="S4.T2.1.1.3.3.2" class="ltx_td ltx_align_center ltx_border_tt" style="padding-top:1.25pt;padding-bottom:1.25pt;">61.95</td>
<td id="S4.T2.1.1.3.3.3" class="ltx_td ltx_align_center ltx_border_tt" style="padding-top:1.25pt;padding-bottom:1.25pt;">63.29</td>
<td id="S4.T2.1.1.3.3.4" class="ltx_td ltx_align_center ltx_border_tt" style="padding-top:1.25pt;padding-bottom:1.25pt;">26.48</td>
<td id="S4.T2.1.1.3.3.5" class="ltx_td ltx_align_center ltx_border_tt" style="padding-top:1.25pt;padding-bottom:1.25pt;">30.52</td>
<td id="S4.T2.1.1.3.3.6" class="ltx_td ltx_border_t" style="padding-top:1.25pt;padding-bottom:1.25pt;"></td>
</tr>
<tr id="S4.T2.1.1.4.4" class="ltx_tr">
<th id="S4.T2.1.1.4.4.1" class="ltx_td ltx_align_left ltx_th ltx_th_row" style="padding-top:1.25pt;padding-bottom:1.25pt;">FedProx+PT</th>
<td id="S4.T2.1.1.4.4.2" class="ltx_td ltx_align_center" style="padding-top:1.25pt;padding-bottom:1.25pt;"><span id="S4.T2.1.1.4.4.2.1" class="ltx_text ltx_font_bold">80.47</span></td>
<td id="S4.T2.1.1.4.4.3" class="ltx_td ltx_align_center" style="padding-top:1.25pt;padding-bottom:1.25pt;"><span id="S4.T2.1.1.4.4.3.1" class="ltx_text ltx_font_bold">81.48</span></td>
<td id="S4.T2.1.1.4.4.4" class="ltx_td ltx_align_center" style="padding-top:1.25pt;padding-bottom:1.25pt;"><span id="S4.T2.1.1.4.4.4.1" class="ltx_text ltx_font_bold">31.95</span></td>
<td id="S4.T2.1.1.4.4.5" class="ltx_td ltx_align_center" style="padding-top:1.25pt;padding-bottom:1.25pt;"><span id="S4.T2.1.1.4.4.5.1" class="ltx_text ltx_font_bold">37.88</span></td>
<td id="S4.T2.1.1.4.4.6" class="ltx_td" style="padding-top:1.25pt;padding-bottom:1.25pt;"></td>
</tr>
<tr id="S4.T2.1.1.5.5" class="ltx_tr">
<th id="S4.T2.1.1.5.5.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t" style="padding-top:1.25pt;padding-bottom:1.25pt;">MOON</th>
<td id="S4.T2.1.1.5.5.2" class="ltx_td ltx_align_center ltx_border_t" style="padding-top:1.25pt;padding-bottom:1.25pt;">62.53</td>
<td id="S4.T2.1.1.5.5.3" class="ltx_td ltx_align_center ltx_border_t" style="padding-top:1.25pt;padding-bottom:1.25pt;">63.52</td>
<td id="S4.T2.1.1.5.5.4" class="ltx_td ltx_align_center ltx_border_t" style="padding-top:1.25pt;padding-bottom:1.25pt;">26.93</td>
<td id="S4.T2.1.1.5.5.5" class="ltx_td ltx_align_center ltx_border_t" style="padding-top:1.25pt;padding-bottom:1.25pt;">29.00</td>
<td id="S4.T2.1.1.5.5.6" class="ltx_td ltx_border_t" style="padding-top:1.25pt;padding-bottom:1.25pt;"></td>
</tr>
<tr id="S4.T2.1.1.6.6" class="ltx_tr">
<th id="S4.T2.1.1.6.6.1" class="ltx_td ltx_align_left ltx_th ltx_th_row" style="padding-top:1.25pt;padding-bottom:1.25pt;">MOON+PT</th>
<td id="S4.T2.1.1.6.6.2" class="ltx_td ltx_align_center" style="padding-top:1.25pt;padding-bottom:1.25pt;"><span id="S4.T2.1.1.6.6.2.1" class="ltx_text ltx_font_bold">77.84</span></td>
<td id="S4.T2.1.1.6.6.3" class="ltx_td ltx_align_center" style="padding-top:1.25pt;padding-bottom:1.25pt;"><span id="S4.T2.1.1.6.6.3.1" class="ltx_text ltx_font_bold">76.00</span></td>
<td id="S4.T2.1.1.6.6.4" class="ltx_td ltx_align_center" style="padding-top:1.25pt;padding-bottom:1.25pt;"><span id="S4.T2.1.1.6.6.4.1" class="ltx_text ltx_font_bold">28.67</span></td>
<td id="S4.T2.1.1.6.6.5" class="ltx_td ltx_align_center" style="padding-top:1.25pt;padding-bottom:1.25pt;"><span id="S4.T2.1.1.6.6.5.1" class="ltx_text ltx_font_bold">34.60</span></td>
<td id="S4.T2.1.1.6.6.6" class="ltx_td" style="padding-top:1.25pt;padding-bottom:1.25pt;"></td>
</tr>
<tr id="S4.T2.1.1.7.7" class="ltx_tr">
<th id="S4.T2.1.1.7.7.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t" style="padding-top:1.25pt;padding-bottom:1.25pt;">FedPer</th>
<td id="S4.T2.1.1.7.7.2" class="ltx_td ltx_align_center ltx_border_t" style="padding-top:1.25pt;padding-bottom:1.25pt;">77.98</td>
<td id="S4.T2.1.1.7.7.3" class="ltx_td ltx_align_center ltx_border_t" style="padding-top:1.25pt;padding-bottom:1.25pt;">79.97</td>
<td id="S4.T2.1.1.7.7.4" class="ltx_td ltx_align_center ltx_border_t" style="padding-top:1.25pt;padding-bottom:1.25pt;">27.79</td>
<td id="S4.T2.1.1.7.7.5" class="ltx_td ltx_align_center ltx_border_t" style="padding-top:1.25pt;padding-bottom:1.25pt;">31.13</td>
<td id="S4.T2.1.1.7.7.6" class="ltx_td ltx_border_t" style="padding-top:1.25pt;padding-bottom:1.25pt;"></td>
</tr>
<tr id="S4.T2.1.1.8.8" class="ltx_tr">
<th id="S4.T2.1.1.8.8.1" class="ltx_td ltx_align_left ltx_th ltx_th_row" style="padding-top:1.25pt;padding-bottom:1.25pt;">FedPer+PT</th>
<td id="S4.T2.1.1.8.8.2" class="ltx_td ltx_align_center" style="padding-top:1.25pt;padding-bottom:1.25pt;"><span id="S4.T2.1.1.8.8.2.1" class="ltx_text ltx_font_bold">78.40</span></td>
<td id="S4.T2.1.1.8.8.3" class="ltx_td ltx_align_center" style="padding-top:1.25pt;padding-bottom:1.25pt;"><span id="S4.T2.1.1.8.8.3.1" class="ltx_text ltx_font_bold">80.59</span></td>
<td id="S4.T2.1.1.8.8.4" class="ltx_td ltx_align_center" style="padding-top:1.25pt;padding-bottom:1.25pt;"><span id="S4.T2.1.1.8.8.4.1" class="ltx_text ltx_font_bold">28.83</span></td>
<td id="S4.T2.1.1.8.8.5" class="ltx_td ltx_align_center" style="padding-top:1.25pt;padding-bottom:1.25pt;"><span id="S4.T2.1.1.8.8.5.1" class="ltx_text ltx_font_bold">31.14</span></td>
<td id="S4.T2.1.1.8.8.6" class="ltx_td" style="padding-top:1.25pt;padding-bottom:1.25pt;"></td>
</tr>
<tr id="S4.T2.1.1.9.9" class="ltx_tr">
<th id="S4.T2.1.1.9.9.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t" style="padding-top:1.25pt;padding-bottom:1.25pt;">FedRep</th>
<td id="S4.T2.1.1.9.9.2" class="ltx_td ltx_align_center ltx_border_t" style="padding-top:1.25pt;padding-bottom:1.25pt;">77.65</td>
<td id="S4.T2.1.1.9.9.3" class="ltx_td ltx_align_center ltx_border_t" style="padding-top:1.25pt;padding-bottom:1.25pt;">78.39</td>
<td id="S4.T2.1.1.9.9.4" class="ltx_td ltx_align_center ltx_border_t" style="padding-top:1.25pt;padding-bottom:1.25pt;">27.39</td>
<td id="S4.T2.1.1.9.9.5" class="ltx_td ltx_align_center ltx_border_t" style="padding-top:1.25pt;padding-bottom:1.25pt;">32.41</td>
<td id="S4.T2.1.1.9.9.6" class="ltx_td ltx_border_t" style="padding-top:1.25pt;padding-bottom:1.25pt;"></td>
</tr>
<tr id="S4.T2.1.1.10.10" class="ltx_tr">
<th id="S4.T2.1.1.10.10.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_b" style="padding-top:1.25pt;padding-bottom:1.25pt;">FedRep+PT</th>
<td id="S4.T2.1.1.10.10.2" class="ltx_td ltx_align_center ltx_border_b" style="padding-top:1.25pt;padding-bottom:1.25pt;">77.65</td>
<td id="S4.T2.1.1.10.10.3" class="ltx_td ltx_align_center ltx_border_b" style="padding-top:1.25pt;padding-bottom:1.25pt;"><span id="S4.T2.1.1.10.10.3.1" class="ltx_text ltx_font_bold">79.11</span></td>
<td id="S4.T2.1.1.10.10.4" class="ltx_td ltx_align_center ltx_border_b" style="padding-top:1.25pt;padding-bottom:1.25pt;"><span id="S4.T2.1.1.10.10.4.1" class="ltx_text ltx_font_bold">29.19</span></td>
<td id="S4.T2.1.1.10.10.5" class="ltx_td ltx_align_center ltx_border_b" style="padding-top:1.25pt;padding-bottom:1.25pt;"><span id="S4.T2.1.1.10.10.5.1" class="ltx_text ltx_font_bold">32.75</span></td>
<td id="S4.T2.1.1.10.10.6" class="ltx_td ltx_border_b" style="padding-top:1.25pt;padding-bottom:1.25pt;"></td>
</tr>
</tbody>
</table>
</span></div>
</figure>
<section id="S4.SS1" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.1 </span>Experimental Setup</h3>

<section id="S4.SS1.SSS0.Px1" class="ltx_paragraph">
<h4 class="ltx_title ltx_title_paragraph">Baselines.</h4>

<div id="S4.SS1.SSS0.Px1.p1" class="ltx_para">
<p id="S4.SS1.SSS0.Px1.p1.1" class="ltx_p">We compare the pFedPT with several advanced FL methods, including FedAvg <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib34" title="" class="ltx_ref">34</a>]</cite>,
FedProx <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib30" title="" class="ltx_ref">30</a>]</cite>.
MOON <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib28" title="" class="ltx_ref">28</a>]</cite>, FedPer <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib1" title="" class="ltx_ref">1</a>]</cite>,
FedRep <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib8" title="" class="ltx_ref">8</a>]</cite>,
FedMTL <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib39" title="" class="ltx_ref">39</a>]</cite> and FedBABU <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib35" title="" class="ltx_ref">35</a>]</cite>. We also compare a baseline named <span id="S4.SS1.SSS0.Px1.p1.1.1" class="ltx_text ltx_font_bold">Local</span>, where each client trains a model with its local data without federated learning. We conduct experiments on two benchmark datasets:
CIFAR10 <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib25" title="" class="ltx_ref">25</a>]</cite> and CIFAR100 <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib25" title="" class="ltx_ref">25</a>]</cite>. CIFAR100 is a more difficult dataset for classification tasks than CIFAR10. We use PyTorch <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib36" title="" class="ltx_ref">36</a>]</cite> to implement pFedPT and the other baselines.</p>
</div>
</section>
<section id="S4.SS1.SSS0.Px2" class="ltx_paragraph">
<h4 class="ltx_title ltx_title_paragraph">Datasets.</h4>

<div id="S4.SS1.SSS0.Px2.p1" class="ltx_para">
<p id="S4.SS1.SSS0.Px2.p1.2" class="ltx_p">We consider two different scenarios for simulating non-identical data distributions (Non-IID) across federated clients. Dirichlet Partition follows works <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib20" title="" class="ltx_ref">20</a>]</cite>, where we partition the training data according to a Dirichlet distribution Dir(<math id="S4.SS1.SSS0.Px2.p1.1.m1.1" class="ltx_Math" alttext="\alpha" display="inline"><semantics id="S4.SS1.SSS0.Px2.p1.1.m1.1a"><mi id="S4.SS1.SSS0.Px2.p1.1.m1.1.1" xref="S4.SS1.SSS0.Px2.p1.1.m1.1.1.cmml">α</mi><annotation-xml encoding="MathML-Content" id="S4.SS1.SSS0.Px2.p1.1.m1.1b"><ci id="S4.SS1.SSS0.Px2.p1.1.m1.1.1.cmml" xref="S4.SS1.SSS0.Px2.p1.1.m1.1.1">𝛼</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSS0.Px2.p1.1.m1.1c">\alpha</annotation></semantics></math>) for each client and generate the corresponding test data for each client following the same distribution. We specify <math id="S4.SS1.SSS0.Px2.p1.2.m2.1" class="ltx_Math" alttext="\alpha" display="inline"><semantics id="S4.SS1.SSS0.Px2.p1.2.m2.1a"><mi id="S4.SS1.SSS0.Px2.p1.2.m2.1.1" xref="S4.SS1.SSS0.Px2.p1.2.m2.1.1.cmml">α</mi><annotation-xml encoding="MathML-Content" id="S4.SS1.SSS0.Px2.p1.2.m2.1b"><ci id="S4.SS1.SSS0.Px2.p1.2.m2.1.1.cmml" xref="S4.SS1.SSS0.Px2.p1.2.m2.1.1">𝛼</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSS0.Px2.p1.2.m2.1c">\alpha</annotation></semantics></math> equal 0.3 for each dataset. In addition, we evaluate with the pathological partition setup similar to <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib47" title="" class="ltx_ref">47</a>]</cite>, in which each client is only assigned a limited number of classes at random from the total number of classes. We specify that each client possesses 5 classes for CIFAR10 and 50 classes for CIFAR100.</p>
</div>
</section>
<section id="S4.SS1.SSS0.Px3" class="ltx_paragraph">
<h4 class="ltx_title ltx_title_paragraph">Implementation Details.</h4>

<div id="S4.SS1.SSS0.Px3.p1" class="ltx_para">
<p id="S4.SS1.SSS0.Px3.p1.1" class="ltx_p">We verify the experimental results based on CNN and ViT architectures. The CNN model consists of 2 convolutional layers with 64 <math id="S4.SS1.SSS0.Px3.p1.1.m1.1" class="ltx_Math" alttext="\times" display="inline"><semantics id="S4.SS1.SSS0.Px3.p1.1.m1.1a"><mo id="S4.SS1.SSS0.Px3.p1.1.m1.1.1" xref="S4.SS1.SSS0.Px3.p1.1.m1.1.1.cmml">×</mo><annotation-xml encoding="MathML-Content" id="S4.SS1.SSS0.Px3.p1.1.m1.1b"><times id="S4.SS1.SSS0.Px3.p1.1.m1.1.1.cmml" xref="S4.SS1.SSS0.Px3.p1.1.m1.1.1"></times></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.SSS0.Px3.p1.1.m1.1c">\times</annotation></semantics></math> filters followed by 2 fully connected layers with 394 and 192 neurons and a softmax layer. We use tiny ViT architecture consisting of 8 blocks with 8 self-attention layers in each block. The corresponding attention head number is 8, the patch size is 4, and the embedding dimension is 128. We set the number of clients to 50, and then each client has a 20% chance of participating in each communication round. We utilize the SGD algorithm <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib6" title="" class="ltx_ref">6</a>]</cite> as the local optimizer for all methods. We use padding as our prompt method. We set batch size as 16 in the local training phase, the local training epochs for the generator and backbone as 5 in each round, the learning rate for the backbone as 0.005, the learning rate for the prompt generator as 1, and the padding prompt size as 4. The number of communication rounds is set to 150 for CIFAR10, 300 for CIFAR100, where all FL approaches have very limited or no accuracy gain with more communications.</p>
</div>
</section>
</section>
<section id="S4.SS2" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.2 </span>Main Results</h3>

<div id="S4.SS2.p1" class="ltx_para">
<p id="S4.SS2.p1.1" class="ltx_p">We run vast experiments to determine the superiority of pFedPT on the model performance in different datasets. Our results highlight the benefit of pFedPT compared to the existing PFL optimization approaches.</p>
</div>
<section id="S4.SS2.SSS0.Px1" class="ltx_paragraph">
<h4 class="ltx_title ltx_title_paragraph">Better performance of pFedPT.</h4>

<div id="S4.SS2.SSS0.Px1.p1" class="ltx_para">
<p id="S4.SS2.SSS0.Px1.p1.1" class="ltx_p">Tab. <a href="#S4.T1" title="Table 1 ‣ 4 Experiments ‣ Visual Prompt Based Personalized Federated Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">1</span></a> compares the best accuracy of the pFedPT with baselines on evaluation datasets with various settings. On CIFAR10 and CIFAR100, the pFedPT consistently achieves the best test accuracy with Non-IID setting. For instance, when training on the data of Dirichlet distribution CIFAR10 with CNN, the test accuracy of the pFedPT is 80.83%, the accuracy of FedAvg is 61.92%, and the accuracy of the FedPer is 77.98%.  The improvements of pFedPT indicate that prompts in each client effectively improve the backbone performance in each client. Similarly, in CIFAR100, pFedPT outperforms most baselines in various settings and achieves comparable results in the Dirichlet setting.</p>
</div>
</section>
<section id="S4.SS2.SSS0.Px2" class="ltx_paragraph">
<h4 class="ltx_title ltx_title_paragraph">Robustness of pFedPT.</h4>

<div id="S4.SS2.SSS0.Px2.p1" class="ltx_para">
<p id="S4.SS2.SSS0.Px2.p1.1" class="ltx_p">pFedPT achieves clear success on both ViT and CNN models and seems to get better performance as the FL tasks become more difficult (since better performance is observed at a greater Non-IID extent and in datasets that are intrinsically more difficult). Interestingly, in the IID setting, we show that all the personalized solutions exhibit some extent of performance degradation, which becomes more significant as the dataset becomes more challenging. Our interpretation of this phenomenon is that when the data are distributed under the IID setting, the PFL approach does not effectively take advantage of the personalization characteristics among clients, resulting in performance degradation. pFedPT will utilize the data distribution information in the client by visual prompts. When the data is IID, the output will be similar on the various clients and degenerate into the FedAvg.</p>
</div>
</section>
<section id="S4.SS2.SSS0.Px3" class="ltx_paragraph">
<h4 class="ltx_title ltx_title_paragraph">Improvements  of prompt for other algorithms.</h4>

<div id="S4.SS2.SSS0.Px3.p1" class="ltx_para">
<p id="S4.SS2.SSS0.Px3.p1.1" class="ltx_p">Visual prompts can improve the performance of backbones on clients by fine-tuning the backbone with hints about the distribution of the client’s data. We explore the usefulness of visual prompts as prior knowledge for other FL algorithms, and Tab. <a href="#S4.T2" title="Table 2 ‣ 4 Experiments ‣ Visual Prompt Based Personalized Federated Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">2</span></a> presents these results. In the Dirichlet setting of CIFAR10, the final test accuracy of FedProx increases from 61.95% to 80.47% after adding prompts, and the test accuracy of MOON increases from 62.53% to 77.84%. We find that a visual prompt enables fine-tuning of the backbone of the client, which helps FL algorithms that pursue high precision fuse client information for personalization. Similarly, PFL algorithms with model decoupling, like FedRep and FedPer, can also yield a performance boost by integrating pFedPT. Therefore, prompt can be used as an additional component to improve the personalization performance of some existing FL algorithms.</p>
</div>
<div id="S4.SS2.SSS0.Px3.p2" class="ltx_para">
<p id="S4.SS2.SSS0.Px3.p2.1" class="ltx_p">Compared with other baselines, the pFedPT takes full advantage of the data improvement space. Additional prompts are added to the data entered into the model to improve the performance of the model on each client.</p>
</div>
</section>
</section>
<section id="S4.SS3" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.3 </span>Exploratory Study</h3>

<div id="S4.SS3.p1" class="ltx_para">
<p id="S4.SS3.p1.1" class="ltx_p">To provide more explanation for pFedPT, we additionally conduct several exploratory studies on pFedPT.</p>
</div>
<figure id="S4.F4" class="ltx_figure"><img src="/html/2303.08678/assets/x4.png" id="S4.F4.g1" class="ltx_graphics ltx_centering ltx_img_square" width="248" height="251" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 4: </span>Visualization results generated by FedAvg and pFedPT with different backbones.</figcaption>
</figure>
<section id="S4.SS3.SSS0.Px1" class="ltx_paragraph">
<h4 class="ltx_title ltx_title_paragraph">Visualization of attention maps.</h4>

<div id="S4.SS3.SSS0.Px1.p1" class="ltx_para">
<p id="S4.SS3.SSS0.Px1.p1.1" class="ltx_p">To illustrate the effectiveness of visual prompts, we conducted some validation experiments. We train ten clients using FedAvg and pFedPT with ViT and CNN backbones under the Dirichlet setting of the CIFAR10 dataset, respectively. As shown in Fig. <a href="#S4.F4" title="Figure 4 ‣ 4.3 Exploratory Study ‣ 4 Experiments ‣ Visual Prompt Based Personalized Federated Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">4</span></a>, we make a visualization of the attention map of the last layer in the ViT and CNN by Grad-CAM <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib38" title="" class="ltx_ref">38</a>]</cite>.
The first three rows in the figure show that  FedAvg focuses on some salient classification features of the raw image.
The fourth row contains the input images with the padding visual prompts, which are added by the prompt generator of pFedPT according to Eq. (<a href="#S3.E3" title="In 3.2 Workflow of pFedPT ‣ 3 Methodology ‣ Visual Prompt Based Personalized Federated Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">3</span></a>). Both pFedPT+ViT and pFedPT+CNN shift some attention to the added prompts, which can help obtain the prior knowledge for the model inference process, thus improving the performance of the model.</p>
</div>
<figure id="S4.F5" class="ltx_figure"><img src="/html/2303.08678/assets/x5.png" id="S4.F5.g1" class="ltx_graphics ltx_centering ltx_img_square" width="237" height="195" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 5: </span>t-SNE visualization of embedding for pure color images with learned prompts in different clients.</figcaption>
</figure>
</section>
<section id="S4.SS3.SSS0.Px2" class="ltx_paragraph">
<h4 class="ltx_title ltx_title_paragraph">The guidance information contained in the prompts.</h4>

<div id="S4.SS3.SSS0.Px2.p1" class="ltx_para">
<p id="S4.SS3.SSS0.Px2.p1.1" class="ltx_p">In order to further explore the influence of visual prompts, we generated 100 different pure color images with the shape of <math id="S4.SS3.SSS0.Px2.p1.1.m1.1" class="ltx_Math" alttext="[3\times 32\times 32]" display="inline"><semantics id="S4.SS3.SSS0.Px2.p1.1.m1.1a"><mrow id="S4.SS3.SSS0.Px2.p1.1.m1.1.1.1" xref="S4.SS3.SSS0.Px2.p1.1.m1.1.1.2.cmml"><mo stretchy="false" id="S4.SS3.SSS0.Px2.p1.1.m1.1.1.1.2" xref="S4.SS3.SSS0.Px2.p1.1.m1.1.1.2.1.cmml">[</mo><mrow id="S4.SS3.SSS0.Px2.p1.1.m1.1.1.1.1" xref="S4.SS3.SSS0.Px2.p1.1.m1.1.1.1.1.cmml"><mn id="S4.SS3.SSS0.Px2.p1.1.m1.1.1.1.1.2" xref="S4.SS3.SSS0.Px2.p1.1.m1.1.1.1.1.2.cmml">3</mn><mo lspace="0.222em" rspace="0.222em" id="S4.SS3.SSS0.Px2.p1.1.m1.1.1.1.1.1" xref="S4.SS3.SSS0.Px2.p1.1.m1.1.1.1.1.1.cmml">×</mo><mn id="S4.SS3.SSS0.Px2.p1.1.m1.1.1.1.1.3" xref="S4.SS3.SSS0.Px2.p1.1.m1.1.1.1.1.3.cmml">32</mn><mo lspace="0.222em" rspace="0.222em" id="S4.SS3.SSS0.Px2.p1.1.m1.1.1.1.1.1a" xref="S4.SS3.SSS0.Px2.p1.1.m1.1.1.1.1.1.cmml">×</mo><mn id="S4.SS3.SSS0.Px2.p1.1.m1.1.1.1.1.4" xref="S4.SS3.SSS0.Px2.p1.1.m1.1.1.1.1.4.cmml">32</mn></mrow><mo stretchy="false" id="S4.SS3.SSS0.Px2.p1.1.m1.1.1.1.3" xref="S4.SS3.SSS0.Px2.p1.1.m1.1.1.2.1.cmml">]</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.SS3.SSS0.Px2.p1.1.m1.1b"><apply id="S4.SS3.SSS0.Px2.p1.1.m1.1.1.2.cmml" xref="S4.SS3.SSS0.Px2.p1.1.m1.1.1.1"><csymbol cd="latexml" id="S4.SS3.SSS0.Px2.p1.1.m1.1.1.2.1.cmml" xref="S4.SS3.SSS0.Px2.p1.1.m1.1.1.1.2">delimited-[]</csymbol><apply id="S4.SS3.SSS0.Px2.p1.1.m1.1.1.1.1.cmml" xref="S4.SS3.SSS0.Px2.p1.1.m1.1.1.1.1"><times id="S4.SS3.SSS0.Px2.p1.1.m1.1.1.1.1.1.cmml" xref="S4.SS3.SSS0.Px2.p1.1.m1.1.1.1.1.1"></times><cn type="integer" id="S4.SS3.SSS0.Px2.p1.1.m1.1.1.1.1.2.cmml" xref="S4.SS3.SSS0.Px2.p1.1.m1.1.1.1.1.2">3</cn><cn type="integer" id="S4.SS3.SSS0.Px2.p1.1.m1.1.1.1.1.3.cmml" xref="S4.SS3.SSS0.Px2.p1.1.m1.1.1.1.1.3">32</cn><cn type="integer" id="S4.SS3.SSS0.Px2.p1.1.m1.1.1.1.1.4.cmml" xref="S4.SS3.SSS0.Px2.p1.1.m1.1.1.1.1.4">32</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.SSS0.Px2.p1.1.m1.1c">[3\times 32\times 32]</annotation></semantics></math>. Using the pure color picture, pFedPT can exclude the disturbance of image contents and pay more attention to visual prompts. We feed those color pictures into pFedPT models in different clients with different prompts and visualize the output embeddings of their last MLP layer. We project them into a two-dimensional plane using the t-SNE algorithm <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib43" title="" class="ltx_ref">43</a>]</cite>. Fig. <a href="#S4.F5" title="Figure 5 ‣ Visualization of attention maps. ‣ 4.3 Exploratory Study ‣ 4 Experiments ‣ Visual Prompt Based Personalized Federated Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">5</span></a> shows that after the visual prompts are added, the model outputs of different clients can be easily distinguished, indicating that the prompts contain prior knowledge of the client model and aid in the classification task.</p>
</div>
<figure id="S4.F6" class="ltx_figure"><img src="/html/2303.08678/assets/x6.png" id="S4.F6.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="237" height="180" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 6: </span>Effect of different types of prompts</figcaption>
</figure>
</section>
<section id="S4.SS3.SSS0.Px3" class="ltx_paragraph">
<h4 class="ltx_title ltx_title_paragraph">Impact of different types of visual prompts.</h4>

<div id="S4.SS3.SSS0.Px3.p1" class="ltx_para">
<p id="S4.SS3.SSS0.Px3.p1.1" class="ltx_p">We analyze different choices on how and where to insert prompts in the input images and how they would affect the final performance. We perform an ablation study on different prompt sizes in <math id="S4.SS3.SSS0.Px3.p1.1.m1.5" class="ltx_Math" alttext="p=\{2,4,6,\dots,16\}" display="inline"><semantics id="S4.SS3.SSS0.Px3.p1.1.m1.5a"><mrow id="S4.SS3.SSS0.Px3.p1.1.m1.5.6" xref="S4.SS3.SSS0.Px3.p1.1.m1.5.6.cmml"><mi id="S4.SS3.SSS0.Px3.p1.1.m1.5.6.2" xref="S4.SS3.SSS0.Px3.p1.1.m1.5.6.2.cmml">p</mi><mo id="S4.SS3.SSS0.Px3.p1.1.m1.5.6.1" xref="S4.SS3.SSS0.Px3.p1.1.m1.5.6.1.cmml">=</mo><mrow id="S4.SS3.SSS0.Px3.p1.1.m1.5.6.3.2" xref="S4.SS3.SSS0.Px3.p1.1.m1.5.6.3.1.cmml"><mo stretchy="false" id="S4.SS3.SSS0.Px3.p1.1.m1.5.6.3.2.1" xref="S4.SS3.SSS0.Px3.p1.1.m1.5.6.3.1.cmml">{</mo><mn id="S4.SS3.SSS0.Px3.p1.1.m1.1.1" xref="S4.SS3.SSS0.Px3.p1.1.m1.1.1.cmml">2</mn><mo id="S4.SS3.SSS0.Px3.p1.1.m1.5.6.3.2.2" xref="S4.SS3.SSS0.Px3.p1.1.m1.5.6.3.1.cmml">,</mo><mn id="S4.SS3.SSS0.Px3.p1.1.m1.2.2" xref="S4.SS3.SSS0.Px3.p1.1.m1.2.2.cmml">4</mn><mo id="S4.SS3.SSS0.Px3.p1.1.m1.5.6.3.2.3" xref="S4.SS3.SSS0.Px3.p1.1.m1.5.6.3.1.cmml">,</mo><mn id="S4.SS3.SSS0.Px3.p1.1.m1.3.3" xref="S4.SS3.SSS0.Px3.p1.1.m1.3.3.cmml">6</mn><mo id="S4.SS3.SSS0.Px3.p1.1.m1.5.6.3.2.4" xref="S4.SS3.SSS0.Px3.p1.1.m1.5.6.3.1.cmml">,</mo><mi mathvariant="normal" id="S4.SS3.SSS0.Px3.p1.1.m1.4.4" xref="S4.SS3.SSS0.Px3.p1.1.m1.4.4.cmml">…</mi><mo id="S4.SS3.SSS0.Px3.p1.1.m1.5.6.3.2.5" xref="S4.SS3.SSS0.Px3.p1.1.m1.5.6.3.1.cmml">,</mo><mn id="S4.SS3.SSS0.Px3.p1.1.m1.5.5" xref="S4.SS3.SSS0.Px3.p1.1.m1.5.5.cmml">16</mn><mo stretchy="false" id="S4.SS3.SSS0.Px3.p1.1.m1.5.6.3.2.6" xref="S4.SS3.SSS0.Px3.p1.1.m1.5.6.3.1.cmml">}</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS3.SSS0.Px3.p1.1.m1.5b"><apply id="S4.SS3.SSS0.Px3.p1.1.m1.5.6.cmml" xref="S4.SS3.SSS0.Px3.p1.1.m1.5.6"><eq id="S4.SS3.SSS0.Px3.p1.1.m1.5.6.1.cmml" xref="S4.SS3.SSS0.Px3.p1.1.m1.5.6.1"></eq><ci id="S4.SS3.SSS0.Px3.p1.1.m1.5.6.2.cmml" xref="S4.SS3.SSS0.Px3.p1.1.m1.5.6.2">𝑝</ci><set id="S4.SS3.SSS0.Px3.p1.1.m1.5.6.3.1.cmml" xref="S4.SS3.SSS0.Px3.p1.1.m1.5.6.3.2"><cn type="integer" id="S4.SS3.SSS0.Px3.p1.1.m1.1.1.cmml" xref="S4.SS3.SSS0.Px3.p1.1.m1.1.1">2</cn><cn type="integer" id="S4.SS3.SSS0.Px3.p1.1.m1.2.2.cmml" xref="S4.SS3.SSS0.Px3.p1.1.m1.2.2">4</cn><cn type="integer" id="S4.SS3.SSS0.Px3.p1.1.m1.3.3.cmml" xref="S4.SS3.SSS0.Px3.p1.1.m1.3.3">6</cn><ci id="S4.SS3.SSS0.Px3.p1.1.m1.4.4.cmml" xref="S4.SS3.SSS0.Px3.p1.1.m1.4.4">…</ci><cn type="integer" id="S4.SS3.SSS0.Px3.p1.1.m1.5.5.cmml" xref="S4.SS3.SSS0.Px3.p1.1.m1.5.5">16</cn></set></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.SSS0.Px3.p1.1.m1.5c">p=\{2,4,6,\dots,16\}</annotation></semantics></math> in CIFAR10 with a Dirichlet distribution. As shown in Fig. <a href="#S4.F6" title="Figure 6 ‣ The guidance information contained in the prompts. ‣ 4.3 Exploratory Study ‣ 4 Experiments ‣ Visual Prompt Based Personalized Federated Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">6</span></a>, padding prompts reach the highest performance with a size of 4. The test accuracy of fixed location and random location prompts grows gradually with the increase in prompt size, but it is still slightly lower than the padding prompt. In contrast, the accuracy of padding prompts decreases as the prompt size increases. A possible explanation is that the padding method covers more pixels of the original images than the other two methods when using the same length of prompts. As a result, the key information for classification could be blocked by the prompts and harm the performance of the model. Overall, the padding prompts with size 4 achieve the best performance. Note that other visual tasks may require significantly different kinds of prompts.</p>
</div>
</section>
</section>
</section>
<section id="S5" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">5 </span>Conclusion</h2>

<div id="S5.p1" class="ltx_para">
<p id="S5.p1.1" class="ltx_p">In this work, we propose a novel framework named pFedPT, a personalized federated learning method based on visual prompts. We make the first attempt to introduce visual prompts to personalized federated learning, using a prompt generator to distill information from local data into the visual prompts and fine-tune the backbone. In the process of pFedPT training, the backbone could use the guidance information from visual prompts to perform the personalized downstream tasks. Since the prompt generator is trained locally on the client, it does not reveal data distribution information about the client to others or the server. pFedPF can also serve a strong plugin to boost the performance of existing FL methods, which could be of independent interest. We provide extensive experiments to illustrate how the pFedPT works and demonstrate its effectiveness in experiments with heterogeneous settings and several types of dataset partition.</p>
</div>
</section>
<section id="bib" class="ltx_bibliography">
<h2 class="ltx_title ltx_title_bibliography" style="font-size:90%;">References</h2>

<ul class="ltx_biblist">
<li id="bib.bib1" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[1]</span>
<span class="ltx_bibblock"><span id="bib.bib1.1.1" class="ltx_text" style="font-size:90%;">
Manoj Ghuhan Arivazhagan, Vinay Aggarwal, Aaditya Kumar Singh, and Sunav
Choudhary.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib1.2.1" class="ltx_text" style="font-size:90%;">Federated learning with personalization layers.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib1.3.1" class="ltx_text ltx_font_italic" style="font-size:90%;">arXiv preprint arXiv:1912.00818</span><span id="bib.bib1.4.2" class="ltx_text" style="font-size:90%;">, 2019.
</span>
</span>
</li>
<li id="bib.bib2" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[2]</span>
<span class="ltx_bibblock"><span id="bib.bib2.1.1" class="ltx_text" style="font-size:90%;">
Hyojin Bahng, Ali Jahanian, Swami Sankaranarayanan, and Phillip Isola.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib2.2.1" class="ltx_text" style="font-size:90%;">Exploring visual prompts for adapting large-scale models.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib2.3.1" class="ltx_text ltx_font_italic" style="font-size:90%;">arXiv preprint arXiv:2203.17274</span><span id="bib.bib2.4.2" class="ltx_text" style="font-size:90%;">, 1(3):4, 2022.
</span>
</span>
</li>
<li id="bib.bib3" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[3]</span>
<span class="ltx_bibblock"><span id="bib.bib3.1.1" class="ltx_text" style="font-size:90%;">
Christopher Briggs, Zhong Fan, and Peter Andras.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib3.2.1" class="ltx_text" style="font-size:90%;">Federated learning with hierarchical clustering of local updates to
improve training on non-iid data.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib3.3.1" class="ltx_text" style="font-size:90%;">In </span><span id="bib.bib3.4.2" class="ltx_text ltx_font_italic" style="font-size:90%;">2020 International Joint Conference on Neural Networks
(IJCNN)</span><span id="bib.bib3.5.3" class="ltx_text" style="font-size:90%;">, pages 1–9. IEEE, 2020.
</span>
</span>
</li>
<li id="bib.bib4" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[4]</span>
<span class="ltx_bibblock"><span id="bib.bib4.1.1" class="ltx_text" style="font-size:90%;">
Fei Chen, Mi Luo, Zhenhua Dong, Zhenguo Li, and Xiuqiang He.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib4.2.1" class="ltx_text" style="font-size:90%;">Federated meta-learning with fast convergence and efficient
communication.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib4.3.1" class="ltx_text ltx_font_italic" style="font-size:90%;">arXiv preprint arXiv:1802.07876</span><span id="bib.bib4.4.2" class="ltx_text" style="font-size:90%;">, 2018.
</span>
</span>
</li>
<li id="bib.bib5" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[5]</span>
<span class="ltx_bibblock"><span id="bib.bib5.1.1" class="ltx_text" style="font-size:90%;">
Yiqiang Chen, Xin Qin, Jindong Wang, Chaohui Yu, and Wen Gao.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib5.2.1" class="ltx_text" style="font-size:90%;">Fedhealth: A federated transfer learning framework for wearable
healthcare.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib5.3.1" class="ltx_text ltx_font_italic" style="font-size:90%;">IEEE Intelligent Systems</span><span id="bib.bib5.4.2" class="ltx_text" style="font-size:90%;">, 35(4):83–93, 2020.
</span>
</span>
</li>
<li id="bib.bib6" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[6]</span>
<span class="ltx_bibblock"><span id="bib.bib6.1.1" class="ltx_text" style="font-size:90%;">
J Michael Cherry, Caroline Adler, Catherine Ball, Stephen A Chervitz, Selina S
Dwight, Erich T Hester, Yankai Jia, Gail Juvik, TaiYun Roe, Mark Schroeder,
et al.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib6.2.1" class="ltx_text" style="font-size:90%;">Sgd: Saccharomyces genome database.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib6.3.1" class="ltx_text ltx_font_italic" style="font-size:90%;">Nucleic acids research</span><span id="bib.bib6.4.2" class="ltx_text" style="font-size:90%;">, 1998.
</span>
</span>
</li>
<li id="bib.bib7" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[7]</span>
<span class="ltx_bibblock"><span id="bib.bib7.1.1" class="ltx_text" style="font-size:90%;">
Yae Jee Cho, Jianyu Wang, Tarun Chiruvolu, and Gauri Joshi.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib7.2.1" class="ltx_text" style="font-size:90%;">Personalized federated learning for heterogeneous clients with
clustered knowledge transfer.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib7.3.1" class="ltx_text ltx_font_italic" style="font-size:90%;">arXiv preprint arXiv:2109.08119</span><span id="bib.bib7.4.2" class="ltx_text" style="font-size:90%;">, 2021.
</span>
</span>
</li>
<li id="bib.bib8" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[8]</span>
<span class="ltx_bibblock"><span id="bib.bib8.1.1" class="ltx_text" style="font-size:90%;">
Liam Collins, Hamed Hassani, Aryan Mokhtari, and Sanjay Shakkottai.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib8.2.1" class="ltx_text" style="font-size:90%;">Exploiting shared representations for personalized federated
learning.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib8.3.1" class="ltx_text" style="font-size:90%;">In </span><span id="bib.bib8.4.2" class="ltx_text ltx_font_italic" style="font-size:90%;">International Conference on Machine Learning</span><span id="bib.bib8.5.3" class="ltx_text" style="font-size:90%;">, pages
2089–2099. PMLR, 2021.
</span>
</span>
</li>
<li id="bib.bib9" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[9]</span>
<span class="ltx_bibblock"><span id="bib.bib9.1.1" class="ltx_text" style="font-size:90%;">
Rong Dai, Li Shen, Fengxiang He, Xinmei Tian, and Dacheng Tao.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib9.2.1" class="ltx_text" style="font-size:90%;">Dispfl: Towards communication-efficient personalized federated
learning via decentralized sparse training.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib9.3.1" class="ltx_text ltx_font_italic" style="font-size:90%;">arXiv preprint arXiv:2206.00187</span><span id="bib.bib9.4.2" class="ltx_text" style="font-size:90%;">, 2022.
</span>
</span>
</li>
<li id="bib.bib10" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[10]</span>
<span class="ltx_bibblock"><span id="bib.bib10.1.1" class="ltx_text" style="font-size:90%;">
Yuyang Deng, Mohammad Mahdi Kamani, and Mehrdad Mahdavi.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib10.2.1" class="ltx_text" style="font-size:90%;">Adaptive personalized federated learning.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib10.3.1" class="ltx_text ltx_font_italic" style="font-size:90%;">arXiv preprint arXiv:2003.13461</span><span id="bib.bib10.4.2" class="ltx_text" style="font-size:90%;">, 2020.
</span>
</span>
</li>
<li id="bib.bib11" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[11]</span>
<span class="ltx_bibblock"><span id="bib.bib11.1.1" class="ltx_text" style="font-size:90%;">
Canh T Dinh, Tung T Vu, Nguyen H Tran, Minh N Dao, and Hongyu Zhang.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib11.2.1" class="ltx_text" style="font-size:90%;">Fedu: A unified framework for federated multi-task learning with
laplacian regularization.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib11.3.1" class="ltx_text ltx_font_italic" style="font-size:90%;">arXiv preprint arXiv:2102.07148</span><span id="bib.bib11.4.2" class="ltx_text" style="font-size:90%;">, 2021.
</span>
</span>
</li>
<li id="bib.bib12" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[12]</span>
<span class="ltx_bibblock"><span id="bib.bib12.1.1" class="ltx_text" style="font-size:90%;">
Alexey Dosovitskiy, Lucas Beyer, Alexander Kolesnikov, Dirk Weissenborn,
Xiaohua Zhai, Thomas Unterthiner, Mostafa Dehghani, Matthias Minderer, Georg
Heigold, Sylvain Gelly, et al.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib12.2.1" class="ltx_text" style="font-size:90%;">An image is worth 16x16 words: Transformers for image recognition at
scale.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib12.3.1" class="ltx_text" style="font-size:90%;">In </span><span id="bib.bib12.4.2" class="ltx_text ltx_font_italic" style="font-size:90%;">International Conference on Learning Representations</span><span id="bib.bib12.5.3" class="ltx_text" style="font-size:90%;">, 2021.
</span>
</span>
</li>
<li id="bib.bib13" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[13]</span>
<span class="ltx_bibblock"><span id="bib.bib13.1.1" class="ltx_text" style="font-size:90%;">
Gamaleldin F Elsayed, Ian Goodfellow, and Jascha Sohl-Dickstein.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib13.2.1" class="ltx_text" style="font-size:90%;">Adversarial reprogramming of neural networks.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib13.3.1" class="ltx_text" style="font-size:90%;">In </span><span id="bib.bib13.4.2" class="ltx_text ltx_font_italic" style="font-size:90%;">International Conference on Learning Representations</span><span id="bib.bib13.5.3" class="ltx_text" style="font-size:90%;">, 2018.
</span>
</span>
</li>
<li id="bib.bib14" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[14]</span>
<span class="ltx_bibblock"><span id="bib.bib14.1.1" class="ltx_text" style="font-size:90%;">
Alireza Fallah, Aryan Mokhtari, and Asuman Ozdaglar.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib14.2.1" class="ltx_text" style="font-size:90%;">Personalized federated learning: A meta-learning approach.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib14.3.1" class="ltx_text ltx_font_italic" style="font-size:90%;">arXiv preprint arXiv:2002.07948</span><span id="bib.bib14.4.2" class="ltx_text" style="font-size:90%;">, 2020.
</span>
</span>
</li>
<li id="bib.bib15" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[15]</span>
<span class="ltx_bibblock"><span id="bib.bib15.1.1" class="ltx_text" style="font-size:90%;">
Chelsea Finn, Pieter Abbeel, and Sergey Levine.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib15.2.1" class="ltx_text" style="font-size:90%;">Model-agnostic meta-learning for fast adaptation of deep networks.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib15.3.1" class="ltx_text" style="font-size:90%;">In </span><span id="bib.bib15.4.2" class="ltx_text ltx_font_italic" style="font-size:90%;">International conference on machine learning</span><span id="bib.bib15.5.3" class="ltx_text" style="font-size:90%;">, pages
1126–1135, 2017.
</span>
</span>
</li>
<li id="bib.bib16" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[16]</span>
<span class="ltx_bibblock"><span id="bib.bib16.1.1" class="ltx_text" style="font-size:90%;">
Luciano Floridi and Massimo Chiriatti.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib16.2.1" class="ltx_text" style="font-size:90%;">Gpt-3: Its nature, scope, limits, and consequences.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib16.3.1" class="ltx_text ltx_font_italic" style="font-size:90%;">Minds and Machines</span><span id="bib.bib16.4.2" class="ltx_text" style="font-size:90%;">, 30(4):681–694, 2020.
</span>
</span>
</li>
<li id="bib.bib17" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[17]</span>
<span class="ltx_bibblock"><span id="bib.bib17.1.1" class="ltx_text" style="font-size:90%;">
Liang Gao, Huazhu Fu, Li Li, Yingwen Chen, Ming Xu, and Cheng-Zhong Xu.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib17.2.1" class="ltx_text" style="font-size:90%;">Feddc: Federated learning with non-iid data via local drift
decoupling and correction.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib17.3.1" class="ltx_text" style="font-size:90%;">In </span><span id="bib.bib17.4.2" class="ltx_text ltx_font_italic" style="font-size:90%;">Proceedings of the IEEE/CVF Conference on Computer Vision and
Pattern Recognition</span><span id="bib.bib17.5.3" class="ltx_text" style="font-size:90%;">, pages 10112–10121, 2022.
</span>
</span>
</li>
<li id="bib.bib18" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[18]</span>
<span class="ltx_bibblock"><span id="bib.bib18.1.1" class="ltx_text" style="font-size:90%;">
Tao Guo, Song Guo, Junxiao Wang, and Wenchao Xu.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib18.2.1" class="ltx_text" style="font-size:90%;">Promptfl: Let federated participants cooperatively learn prompts
instead of models–federated learning in age of foundation model.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib18.3.1" class="ltx_text ltx_font_italic" style="font-size:90%;">arXiv preprint arXiv:2208.11625</span><span id="bib.bib18.4.2" class="ltx_text" style="font-size:90%;">, 2022.
</span>
</span>
</li>
<li id="bib.bib19" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[19]</span>
<span class="ltx_bibblock"><span id="bib.bib19.1.1" class="ltx_text" style="font-size:90%;">
Filip Hanzely, Boxin Zhao, and Mladen Kolar.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib19.2.1" class="ltx_text" style="font-size:90%;">Personalized federated learning: A unified framework and universal
optimization techniques.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib19.3.1" class="ltx_text ltx_font_italic" style="font-size:90%;">arXiv preprint arXiv:2102.09743</span><span id="bib.bib19.4.2" class="ltx_text" style="font-size:90%;">, 2021.
</span>
</span>
</li>
<li id="bib.bib20" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[20]</span>
<span class="ltx_bibblock"><span id="bib.bib20.1.1" class="ltx_text" style="font-size:90%;">
Tzu-Ming Harry Hsu, Hang Qi, and Matthew Brown.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib20.2.1" class="ltx_text" style="font-size:90%;">Measuring the effects of non-identical data distribution for
federated visual classification.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib20.3.1" class="ltx_text ltx_font_italic" style="font-size:90%;">arXiv preprint arXiv:1909.06335</span><span id="bib.bib20.4.2" class="ltx_text" style="font-size:90%;">, 2019.
</span>
</span>
</li>
<li id="bib.bib21" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[21]</span>
<span class="ltx_bibblock"><span id="bib.bib21.1.1" class="ltx_text" style="font-size:90%;">
Tiansheng Huang, Shiwei Liu, Li Shen, Fengxiang He, Weiwei Lin, and Dacheng
Tao.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib21.2.1" class="ltx_text" style="font-size:90%;">Achieving personalized federated learning with sparse local models.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib21.3.1" class="ltx_text ltx_font_italic" style="font-size:90%;">arXiv preprint arXiv:2201.11380</span><span id="bib.bib21.4.2" class="ltx_text" style="font-size:90%;">, 2022.
</span>
</span>
</li>
<li id="bib.bib22" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[22]</span>
<span class="ltx_bibblock"><span id="bib.bib22.1.1" class="ltx_text" style="font-size:90%;">
Tiansheng Huang, Li Shen, Yan Sun, Weiwei Lin, and Dacheng Tao.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib22.2.1" class="ltx_text" style="font-size:90%;">Fusion of global and local knowledge for personalized federated
learning.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib22.3.1" class="ltx_text ltx_font_italic" style="font-size:90%;">arXiv preprint arXiv:2302.11051</span><span id="bib.bib22.4.2" class="ltx_text" style="font-size:90%;">, 2023.
</span>
</span>
</li>
<li id="bib.bib23" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[23]</span>
<span class="ltx_bibblock"><span id="bib.bib23.1.1" class="ltx_text" style="font-size:90%;">
Menglin Jia, Luming Tang, Bor-Chun Chen, Claire Cardie, Serge Belongie, Bharath
Hariharan, and Ser-Nam Lim.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib23.2.1" class="ltx_text" style="font-size:90%;">Visual prompt tuning.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib23.3.1" class="ltx_text ltx_font_italic" style="font-size:90%;">arXiv preprint arXiv:2203.12119</span><span id="bib.bib23.4.2" class="ltx_text" style="font-size:90%;">, 2022.
</span>
</span>
</li>
<li id="bib.bib24" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[24]</span>
<span class="ltx_bibblock"><span id="bib.bib24.1.1" class="ltx_text" style="font-size:90%;">
Yihan Jiang, Jakub Konečnỳ, Keith Rush, and Sreeram Kannan.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib24.2.1" class="ltx_text" style="font-size:90%;">Improving federated learning personalization via model agnostic meta
learning.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib24.3.1" class="ltx_text ltx_font_italic" style="font-size:90%;">arXiv preprint arXiv:1909.12488</span><span id="bib.bib24.4.2" class="ltx_text" style="font-size:90%;">, 2019.
</span>
</span>
</li>
<li id="bib.bib25" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[25]</span>
<span class="ltx_bibblock"><span id="bib.bib25.1.1" class="ltx_text" style="font-size:90%;">
Alex Krizhevsky, Geoffrey Hinton, et al.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib25.2.1" class="ltx_text" style="font-size:90%;">Learning multiple layers of features from tiny images.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib25.3.1" class="ltx_text" style="font-size:90%;">2009.
</span>
</span>
</li>
<li id="bib.bib26" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[26]</span>
<span class="ltx_bibblock"><span id="bib.bib26.1.1" class="ltx_text" style="font-size:90%;">
Brian Lester, Rami Al-Rfou, and Noah Constant.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib26.2.1" class="ltx_text" style="font-size:90%;">The power of scale for parameter-efficient prompt tuning.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib26.3.1" class="ltx_text" style="font-size:90%;">In </span><span id="bib.bib26.4.2" class="ltx_text ltx_font_italic" style="font-size:90%;">Proceedings of the 2021 Conference on Empirical Methods in
Natural Language Processing</span><span id="bib.bib26.5.3" class="ltx_text" style="font-size:90%;">, pages 3045–3059, 2021.
</span>
</span>
</li>
<li id="bib.bib27" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[27]</span>
<span class="ltx_bibblock"><span id="bib.bib27.1.1" class="ltx_text" style="font-size:90%;">
Guanghao Li, Yue Hu, Miao Zhang, Ji Liu, Quanjun Yin, Yong Peng, and Dejing
Dou.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib27.2.1" class="ltx_text" style="font-size:90%;">Fedhisyn: A hierarchical synchronous federated learning framework for
resource and data heterogeneity.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib27.3.1" class="ltx_text" style="font-size:90%;">In </span><span id="bib.bib27.4.2" class="ltx_text ltx_font_italic" style="font-size:90%;">Proceedings of the 51st International Conference on Parallel
Processing</span><span id="bib.bib27.5.3" class="ltx_text" style="font-size:90%;">, pages 1–11, 2022.
</span>
</span>
</li>
<li id="bib.bib28" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[28]</span>
<span class="ltx_bibblock"><span id="bib.bib28.1.1" class="ltx_text" style="font-size:90%;">
Qinbin Li, Bingsheng He, and Dawn Song.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib28.2.1" class="ltx_text" style="font-size:90%;">Model-contrastive federated learning.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib28.3.1" class="ltx_text" style="font-size:90%;">In </span><span id="bib.bib28.4.2" class="ltx_text ltx_font_italic" style="font-size:90%;">Proceedings of the IEEE/CVF Conference on Computer Vision and
Pattern Recognition</span><span id="bib.bib28.5.3" class="ltx_text" style="font-size:90%;">, pages 10713–10722, 2021.
</span>
</span>
</li>
<li id="bib.bib29" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[29]</span>
<span class="ltx_bibblock"><span id="bib.bib29.1.1" class="ltx_text" style="font-size:90%;">
Tian Li, Shengyuan Hu, Ahmad Beirami, and Virginia Smith.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib29.2.1" class="ltx_text" style="font-size:90%;">Ditto: Fair and robust federated learning through personalization.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib29.3.1" class="ltx_text" style="font-size:90%;">In </span><span id="bib.bib29.4.2" class="ltx_text ltx_font_italic" style="font-size:90%;">International Conference on Machine Learning</span><span id="bib.bib29.5.3" class="ltx_text" style="font-size:90%;">, pages
6357–6368. PMLR, 2021.
</span>
</span>
</li>
<li id="bib.bib30" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[30]</span>
<span class="ltx_bibblock"><span id="bib.bib30.1.1" class="ltx_text" style="font-size:90%;">
Tian Li, Anit Kumar Sahu, Manzil Zaheer, Maziar Sanjabi, Ameet Talwalkar, and
Virginia Smith.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib30.2.1" class="ltx_text" style="font-size:90%;">Federated optimization in heterogeneous networks.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib30.3.1" class="ltx_text ltx_font_italic" style="font-size:90%;">Proceedings of Machine learning and systems</span><span id="bib.bib30.4.2" class="ltx_text" style="font-size:90%;">, 2:429–450, 2020.
</span>
</span>
</li>
<li id="bib.bib31" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[31]</span>
<span class="ltx_bibblock"><span id="bib.bib31.1.1" class="ltx_text" style="font-size:90%;">
Xiang Lisa Li and Percy Liang.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib31.2.1" class="ltx_text" style="font-size:90%;">Prefix-tuning: Optimizing continuous prompts for generation.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib31.3.1" class="ltx_text" style="font-size:90%;">In </span><span id="bib.bib31.4.2" class="ltx_text ltx_font_italic" style="font-size:90%;">Proceedings of the 59th Annual Meeting of the Association for
Computational Linguistics and the 11th International Joint Conference on
Natural Language Processing (Volume 1: Long Papers)</span><span id="bib.bib31.5.3" class="ltx_text" style="font-size:90%;">, pages 4582–4597, 2021.
</span>
</span>
</li>
<li id="bib.bib32" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[32]</span>
<span class="ltx_bibblock"><span id="bib.bib32.1.1" class="ltx_text" style="font-size:90%;">
Pengfei Liu, Weizhe Yuan, Jinlan Fu, Zhengbao Jiang, Hiroaki Hayashi, and
Graham Neubig.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib32.2.1" class="ltx_text" style="font-size:90%;">Pre-train, prompt, and predict: A systematic survey of prompting
methods in natural language processing.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib32.3.1" class="ltx_text ltx_font_italic" style="font-size:90%;">arXiv preprint arXiv:2107.13586</span><span id="bib.bib32.4.2" class="ltx_text" style="font-size:90%;">, 2021.
</span>
</span>
</li>
<li id="bib.bib33" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[33]</span>
<span class="ltx_bibblock"><span id="bib.bib33.1.1" class="ltx_text" style="font-size:90%;">
Yishay Mansour, Mehryar Mohri, Jae Ro, and Ananda Theertha Suresh.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib33.2.1" class="ltx_text" style="font-size:90%;">Three approaches for personalization with applications to federated
learning.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib33.3.1" class="ltx_text ltx_font_italic" style="font-size:90%;">arXiv preprint arXiv:2002.10619</span><span id="bib.bib33.4.2" class="ltx_text" style="font-size:90%;">, 2020.
</span>
</span>
</li>
<li id="bib.bib34" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[34]</span>
<span class="ltx_bibblock"><span id="bib.bib34.1.1" class="ltx_text" style="font-size:90%;">
Brendan McMahan, Eider Moore, Daniel Ramage, Seth Hampson, and Blaise Aguera y
Arcas.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib34.2.1" class="ltx_text" style="font-size:90%;">Communication-efficient learning of deep networks from decentralized
data.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib34.3.1" class="ltx_text" style="font-size:90%;">In </span><span id="bib.bib34.4.2" class="ltx_text ltx_font_italic" style="font-size:90%;">Artificial intelligence and statistics</span><span id="bib.bib34.5.3" class="ltx_text" style="font-size:90%;">, pages 1273–1282,
2017.
</span>
</span>
</li>
<li id="bib.bib35" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[35]</span>
<span class="ltx_bibblock"><span id="bib.bib35.1.1" class="ltx_text" style="font-size:90%;">
Jaehoon Oh, Sangmook Kim, and Se-Young Yun.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib35.2.1" class="ltx_text" style="font-size:90%;">Fedbabu: Towards enhanced representation for federated image
classification.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib35.3.1" class="ltx_text ltx_font_italic" style="font-size:90%;">arXiv preprint arXiv:2106.06042</span><span id="bib.bib35.4.2" class="ltx_text" style="font-size:90%;">, 2021.
</span>
</span>
</li>
<li id="bib.bib36" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[36]</span>
<span class="ltx_bibblock"><span id="bib.bib36.1.1" class="ltx_text" style="font-size:90%;">
Aaron van den Oord, Yazhe Li, and Oriol Vinyals.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib36.2.1" class="ltx_text" style="font-size:90%;">Representation learning with contrastive predictive coding.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib36.3.1" class="ltx_text ltx_font_italic" style="font-size:90%;">arXiv preprint arXiv:1807.03748</span><span id="bib.bib36.4.2" class="ltx_text" style="font-size:90%;">, 2018.
</span>
</span>
</li>
<li id="bib.bib37" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[37]</span>
<span class="ltx_bibblock"><span id="bib.bib37.1.1" class="ltx_text" style="font-size:90%;">
Alec Radford, Jong Wook Kim, Chris Hallacy, Aditya Ramesh, Gabriel Goh,
Sandhini Agarwal, Girish Sastry, Amanda Askell, Pamela Mishkin, Jack Clark,
et al.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib37.2.1" class="ltx_text" style="font-size:90%;">Learning transferable visual models from natural language
supervision.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib37.3.1" class="ltx_text" style="font-size:90%;">In </span><span id="bib.bib37.4.2" class="ltx_text ltx_font_italic" style="font-size:90%;">International Conference on Machine Learning</span><span id="bib.bib37.5.3" class="ltx_text" style="font-size:90%;">, pages
8748–8763. PMLR, 2021.
</span>
</span>
</li>
<li id="bib.bib38" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[38]</span>
<span class="ltx_bibblock"><span id="bib.bib38.1.1" class="ltx_text" style="font-size:90%;">
Ramprasaath R. Selvaraju, Michael Cogswell, Abhishek Das, Ramakrishna Vedantam,
Devi Parikh, and Dhruv Batra.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib38.2.1" class="ltx_text" style="font-size:90%;">Grad-cam: Visual explanations from deep networks via gradient-based
localization.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib38.3.1" class="ltx_text ltx_font_italic" style="font-size:90%;">Int. J. Comput. Vis.</span><span id="bib.bib38.4.2" class="ltx_text" style="font-size:90%;">, 128(2):336–359, 2020.
</span>
</span>
</li>
<li id="bib.bib39" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[39]</span>
<span class="ltx_bibblock"><span id="bib.bib39.1.1" class="ltx_text" style="font-size:90%;">
Virginia Smith, Chao-Kai Chiang, Maziar Sanjabi, and Ameet S Talwalkar.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib39.2.1" class="ltx_text" style="font-size:90%;">Federated multi-task learning.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib39.3.1" class="ltx_text ltx_font_italic" style="font-size:90%;">Advances in neural information processing systems</span><span id="bib.bib39.4.2" class="ltx_text" style="font-size:90%;">, 30, 2017.
</span>
</span>
</li>
<li id="bib.bib40" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[40]</span>
<span class="ltx_bibblock"><span id="bib.bib40.1.1" class="ltx_text" style="font-size:90%;">
Canh T Dinh, Nguyen Tran, and Josh Nguyen.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib40.2.1" class="ltx_text" style="font-size:90%;">Personalized federated learning with moreau envelopes.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib40.3.1" class="ltx_text ltx_font_italic" style="font-size:90%;">Advances in Neural Information Processing Systems</span><span id="bib.bib40.4.2" class="ltx_text" style="font-size:90%;">,
33:21394–21405, 2020.
</span>
</span>
</li>
<li id="bib.bib41" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[41]</span>
<span class="ltx_bibblock"><span id="bib.bib41.1.1" class="ltx_text" style="font-size:90%;">
Alysa Ziying Tan, Han Yu, Lizhen Cui, and Qiang Yang.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib41.2.1" class="ltx_text" style="font-size:90%;">Towards personalized federated learning.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib41.3.1" class="ltx_text ltx_font_italic" style="font-size:90%;">IEEE Transactions on Neural Networks and Learning Systems</span><span id="bib.bib41.4.2" class="ltx_text" style="font-size:90%;">,
2022.
</span>
</span>
</li>
<li id="bib.bib42" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[42]</span>
<span class="ltx_bibblock"><span id="bib.bib42.1.1" class="ltx_text" style="font-size:90%;">
Maria Tsimpoukelli, Jacob L Menick, Serkan Cabi, SM Eslami, Oriol Vinyals, and
Felix Hill.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib42.2.1" class="ltx_text" style="font-size:90%;">Multimodal few-shot learning with frozen language models.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib42.3.1" class="ltx_text ltx_font_italic" style="font-size:90%;">Advances in Neural Information Processing Systems</span><span id="bib.bib42.4.2" class="ltx_text" style="font-size:90%;">, 34:200–212,
2021.
</span>
</span>
</li>
<li id="bib.bib43" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[43]</span>
<span class="ltx_bibblock"><span id="bib.bib43.1.1" class="ltx_text" style="font-size:90%;">
Laurens Van der Maaten and Geoffrey Hinton.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib43.2.1" class="ltx_text" style="font-size:90%;">Visualizing data using t-sne.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib43.3.1" class="ltx_text ltx_font_italic" style="font-size:90%;">Journal of machine learning research</span><span id="bib.bib43.4.2" class="ltx_text" style="font-size:90%;">, 9(11), 2008.
</span>
</span>
</li>
<li id="bib.bib44" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[44]</span>
<span class="ltx_bibblock"><span id="bib.bib44.1.1" class="ltx_text" style="font-size:90%;">
Dui Wang, Li Shen, Yong Luo, Han Hu, Kehua Su, Yonggang Wen, and Dacheng Tao.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib44.2.1" class="ltx_text" style="font-size:90%;">Fedabc: Targeting fair competition in personalized federated
learning.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib44.3.1" class="ltx_text ltx_font_italic" style="font-size:90%;">arXiv preprint arXiv:2302.07450</span><span id="bib.bib44.4.2" class="ltx_text" style="font-size:90%;">, 2023.
</span>
</span>
</li>
<li id="bib.bib45" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[45]</span>
<span class="ltx_bibblock"><span id="bib.bib45.1.1" class="ltx_text" style="font-size:90%;">
Hongwei Yang, Hui He, Weizhe Zhang, and Xiaochun Cao.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib45.2.1" class="ltx_text" style="font-size:90%;">Fedsteg: A federated transfer learning framework for secure image
steganalysis.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib45.3.1" class="ltx_text ltx_font_italic" style="font-size:90%;">IEEE Transactions on Network Science and Engineering</span><span id="bib.bib45.4.2" class="ltx_text" style="font-size:90%;">,
8(2):1084–1094, 2020.
</span>
</span>
</li>
<li id="bib.bib46" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[46]</span>
<span class="ltx_bibblock"><span id="bib.bib46.1.1" class="ltx_text" style="font-size:90%;">
Yuan Yao, Ao Zhang, Zhengyan Zhang, Zhiyuan Liu, Tat-Seng Chua, and Maosong
Sun.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib46.2.1" class="ltx_text" style="font-size:90%;">Cpt: Colorful prompt tuning for pre-trained vision-language models.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib46.3.1" class="ltx_text ltx_font_italic" style="font-size:90%;">arXiv preprint arXiv:2109.11797</span><span id="bib.bib46.4.2" class="ltx_text" style="font-size:90%;">, 2021.
</span>
</span>
</li>
<li id="bib.bib47" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[47]</span>
<span class="ltx_bibblock"><span id="bib.bib47.1.1" class="ltx_text" style="font-size:90%;">
Michael Zhang, Karan Sapra, Sanja Fidler, Serena Yeung, and Jose M Alvarez.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib47.2.1" class="ltx_text" style="font-size:90%;">Personalized federated learning with first order model optimization.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib47.3.1" class="ltx_text ltx_font_italic" style="font-size:90%;">arXiv preprint arXiv:2012.08565</span><span id="bib.bib47.4.2" class="ltx_text" style="font-size:90%;">, 2020.
</span>
</span>
</li>
<li id="bib.bib48" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[48]</span>
<span class="ltx_bibblock"><span id="bib.bib48.1.1" class="ltx_text" style="font-size:90%;">
Haodong Zhao, Wei Du, Fangqi Li, Peixuan Li, and Gongshen Liu.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib48.2.1" class="ltx_text" style="font-size:90%;">Reduce communication costs and preserve privacy: Prompt tuning method
in federated learning.
</span>
</span>
<span class="ltx_bibblock"><span id="bib.bib48.3.1" class="ltx_text ltx_font_italic" style="font-size:90%;">arXiv preprint arXiv:2208.12268</span><span id="bib.bib48.4.2" class="ltx_text" style="font-size:90%;">, 2022.
</span>
</span>
</li>
</ul>
</section>
<section id="A1" class="ltx_appendix">
<h2 class="ltx_title ltx_title_appendix">
<span class="ltx_tag ltx_tag_appendix">Appendix A </span>Appendix: More Experiment Results</h2>

<div id="A1.p1" class="ltx_para">
<p id="A1.p1.1" class="ltx_p">We run experiments on the real-world datasets for image classification tasks, including CIFAR10, CIFAR100, and Tiny ImageNet. We conduct comprehensive investigations for the impact on client heterogeneity by designing IID and non-IID data scenarios. For comparison, we utilize the FedAvg, FedProx, and FedPer algorithms as baselines. The experiment settings are described in detail below.</p>
</div>
<section id="A1.SS1" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">A.1 </span>Setups</h3>

<section id="A1.SS1.SSS0.Px1" class="ltx_paragraph">
<h4 class="ltx_title ltx_title_paragraph">Dataset.</h4>

<div id="A1.SS1.SSS0.Px1.p1" class="ltx_para">
<p id="A1.SS1.SSS0.Px1.p1.2" class="ltx_p">We adopt real-world datasets for the image classification task, including CIFAR10, CIFAR100, and Tiny ImageNet. The CIFAR10 dataset contains 50,000 training data and 10,000 test data in 10 classes. Each data sample is a <math id="A1.SS1.SSS0.Px1.p1.1.m1.1" class="ltx_Math" alttext="3\times 32\times 32" display="inline"><semantics id="A1.SS1.SSS0.Px1.p1.1.m1.1a"><mrow id="A1.SS1.SSS0.Px1.p1.1.m1.1.1" xref="A1.SS1.SSS0.Px1.p1.1.m1.1.1.cmml"><mn id="A1.SS1.SSS0.Px1.p1.1.m1.1.1.2" xref="A1.SS1.SSS0.Px1.p1.1.m1.1.1.2.cmml">3</mn><mo lspace="0.222em" rspace="0.222em" id="A1.SS1.SSS0.Px1.p1.1.m1.1.1.1" xref="A1.SS1.SSS0.Px1.p1.1.m1.1.1.1.cmml">×</mo><mn id="A1.SS1.SSS0.Px1.p1.1.m1.1.1.3" xref="A1.SS1.SSS0.Px1.p1.1.m1.1.1.3.cmml">32</mn><mo lspace="0.222em" rspace="0.222em" id="A1.SS1.SSS0.Px1.p1.1.m1.1.1.1a" xref="A1.SS1.SSS0.Px1.p1.1.m1.1.1.1.cmml">×</mo><mn id="A1.SS1.SSS0.Px1.p1.1.m1.1.1.4" xref="A1.SS1.SSS0.Px1.p1.1.m1.1.1.4.cmml">32</mn></mrow><annotation-xml encoding="MathML-Content" id="A1.SS1.SSS0.Px1.p1.1.m1.1b"><apply id="A1.SS1.SSS0.Px1.p1.1.m1.1.1.cmml" xref="A1.SS1.SSS0.Px1.p1.1.m1.1.1"><times id="A1.SS1.SSS0.Px1.p1.1.m1.1.1.1.cmml" xref="A1.SS1.SSS0.Px1.p1.1.m1.1.1.1"></times><cn type="integer" id="A1.SS1.SSS0.Px1.p1.1.m1.1.1.2.cmml" xref="A1.SS1.SSS0.Px1.p1.1.m1.1.1.2">3</cn><cn type="integer" id="A1.SS1.SSS0.Px1.p1.1.m1.1.1.3.cmml" xref="A1.SS1.SSS0.Px1.p1.1.m1.1.1.3">32</cn><cn type="integer" id="A1.SS1.SSS0.Px1.p1.1.m1.1.1.4.cmml" xref="A1.SS1.SSS0.Px1.p1.1.m1.1.1.4">32</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS1.SSS0.Px1.p1.1.m1.1c">3\times 32\times 32</annotation></semantics></math> color image. CIFAR100 <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib25" title="" class="ltx_ref">25</a>]</cite> includes 50,000 training data and 10,000 test data in 100 classes as 500 training samples per class. TinyImageNet <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib36" title="" class="ltx_ref">36</a>]</cite> involves 100,000 training images and 10,000 test images in 200 classes for <math id="A1.SS1.SSS0.Px1.p1.2.m2.1" class="ltx_Math" alttext="3\times 64\times 64" display="inline"><semantics id="A1.SS1.SSS0.Px1.p1.2.m2.1a"><mrow id="A1.SS1.SSS0.Px1.p1.2.m2.1.1" xref="A1.SS1.SSS0.Px1.p1.2.m2.1.1.cmml"><mn id="A1.SS1.SSS0.Px1.p1.2.m2.1.1.2" xref="A1.SS1.SSS0.Px1.p1.2.m2.1.1.2.cmml">3</mn><mo lspace="0.222em" rspace="0.222em" id="A1.SS1.SSS0.Px1.p1.2.m2.1.1.1" xref="A1.SS1.SSS0.Px1.p1.2.m2.1.1.1.cmml">×</mo><mn id="A1.SS1.SSS0.Px1.p1.2.m2.1.1.3" xref="A1.SS1.SSS0.Px1.p1.2.m2.1.1.3.cmml">64</mn><mo lspace="0.222em" rspace="0.222em" id="A1.SS1.SSS0.Px1.p1.2.m2.1.1.1a" xref="A1.SS1.SSS0.Px1.p1.2.m2.1.1.1.cmml">×</mo><mn id="A1.SS1.SSS0.Px1.p1.2.m2.1.1.4" xref="A1.SS1.SSS0.Px1.p1.2.m2.1.1.4.cmml">64</mn></mrow><annotation-xml encoding="MathML-Content" id="A1.SS1.SSS0.Px1.p1.2.m2.1b"><apply id="A1.SS1.SSS0.Px1.p1.2.m2.1.1.cmml" xref="A1.SS1.SSS0.Px1.p1.2.m2.1.1"><times id="A1.SS1.SSS0.Px1.p1.2.m2.1.1.1.cmml" xref="A1.SS1.SSS0.Px1.p1.2.m2.1.1.1"></times><cn type="integer" id="A1.SS1.SSS0.Px1.p1.2.m2.1.1.2.cmml" xref="A1.SS1.SSS0.Px1.p1.2.m2.1.1.2">3</cn><cn type="integer" id="A1.SS1.SSS0.Px1.p1.2.m2.1.1.3.cmml" xref="A1.SS1.SSS0.Px1.p1.2.m2.1.1.3">64</cn><cn type="integer" id="A1.SS1.SSS0.Px1.p1.2.m2.1.1.4.cmml" xref="A1.SS1.SSS0.Px1.p1.2.m2.1.1.4">64</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS1.SSS0.Px1.p1.2.m2.1c">3\times 64\times 64</annotation></semantics></math> color images, as shown in Table <a href="#A1.T3" title="Table 3 ‣ Dataset. ‣ A.1 Setups ‣ Appendix A Appendix: More Experiment Results ‣ Visual Prompt Based Personalized Federated Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">3</span></a>. For CIFAR10/100 and TinyImageNet, we normalize the pixel value within a specific mean and std value in our code, which are [0.5, 0.5, 0.5] for the mean and [0.5, 0.5, 0.5] for the std.</p>
</div>
<figure id="A1.T3" class="ltx_table">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_table">Table 3: </span>The similarity between predicted and real data distribution</figcaption>
<div id="A1.T3.3" class="ltx_inline-block ltx_align_center ltx_transformed_outer" style="width:298.1pt;height:69.9pt;vertical-align:-0.0pt;"><span class="ltx_transformed_inner" style="transform:translate(-4.5pt,1.1pt) scale(0.970624537040947,0.970624537040947) ;">
<table id="A1.T3.3.3" class="ltx_tabular ltx_guessed_headers ltx_align_middle">
<thead class="ltx_thead">
<tr id="A1.T3.3.3.4.1" class="ltx_tr">
<th id="A1.T3.3.3.4.1.1" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt">Datasets</th>
<th id="A1.T3.3.3.4.1.2" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt">Training Data</th>
<th id="A1.T3.3.3.4.1.3" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt">Test Data</th>
<th id="A1.T3.3.3.4.1.4" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt">Class</th>
<th id="A1.T3.3.3.4.1.5" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt">Size</th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr id="A1.T3.1.1.1" class="ltx_tr">
<td id="A1.T3.1.1.1.2" class="ltx_td ltx_align_center ltx_border_t">CIFAR-10</td>
<td id="A1.T3.1.1.1.3" class="ltx_td ltx_align_center ltx_border_t">50,000</td>
<td id="A1.T3.1.1.1.4" class="ltx_td ltx_align_center ltx_border_t">10,000</td>
<td id="A1.T3.1.1.1.5" class="ltx_td ltx_align_center ltx_border_t">10</td>
<td id="A1.T3.1.1.1.1" class="ltx_td ltx_align_center ltx_border_t"><math id="A1.T3.1.1.1.1.m1.1" class="ltx_Math" alttext="3\times 32\times 32" display="inline"><semantics id="A1.T3.1.1.1.1.m1.1a"><mrow id="A1.T3.1.1.1.1.m1.1.1" xref="A1.T3.1.1.1.1.m1.1.1.cmml"><mn id="A1.T3.1.1.1.1.m1.1.1.2" xref="A1.T3.1.1.1.1.m1.1.1.2.cmml">3</mn><mo lspace="0.222em" rspace="0.222em" id="A1.T3.1.1.1.1.m1.1.1.1" xref="A1.T3.1.1.1.1.m1.1.1.1.cmml">×</mo><mn id="A1.T3.1.1.1.1.m1.1.1.3" xref="A1.T3.1.1.1.1.m1.1.1.3.cmml">32</mn><mo lspace="0.222em" rspace="0.222em" id="A1.T3.1.1.1.1.m1.1.1.1a" xref="A1.T3.1.1.1.1.m1.1.1.1.cmml">×</mo><mn id="A1.T3.1.1.1.1.m1.1.1.4" xref="A1.T3.1.1.1.1.m1.1.1.4.cmml">32</mn></mrow><annotation-xml encoding="MathML-Content" id="A1.T3.1.1.1.1.m1.1b"><apply id="A1.T3.1.1.1.1.m1.1.1.cmml" xref="A1.T3.1.1.1.1.m1.1.1"><times id="A1.T3.1.1.1.1.m1.1.1.1.cmml" xref="A1.T3.1.1.1.1.m1.1.1.1"></times><cn type="integer" id="A1.T3.1.1.1.1.m1.1.1.2.cmml" xref="A1.T3.1.1.1.1.m1.1.1.2">3</cn><cn type="integer" id="A1.T3.1.1.1.1.m1.1.1.3.cmml" xref="A1.T3.1.1.1.1.m1.1.1.3">32</cn><cn type="integer" id="A1.T3.1.1.1.1.m1.1.1.4.cmml" xref="A1.T3.1.1.1.1.m1.1.1.4">32</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.T3.1.1.1.1.m1.1c">3\times 32\times 32</annotation></semantics></math></td>
</tr>
<tr id="A1.T3.2.2.2" class="ltx_tr">
<td id="A1.T3.2.2.2.2" class="ltx_td ltx_align_center">CIFAR-100</td>
<td id="A1.T3.2.2.2.3" class="ltx_td ltx_align_center">50,000</td>
<td id="A1.T3.2.2.2.4" class="ltx_td ltx_align_center">10,000</td>
<td id="A1.T3.2.2.2.5" class="ltx_td ltx_align_center">100</td>
<td id="A1.T3.2.2.2.1" class="ltx_td ltx_align_center"><math id="A1.T3.2.2.2.1.m1.1" class="ltx_Math" alttext="3\times 32\times 32" display="inline"><semantics id="A1.T3.2.2.2.1.m1.1a"><mrow id="A1.T3.2.2.2.1.m1.1.1" xref="A1.T3.2.2.2.1.m1.1.1.cmml"><mn id="A1.T3.2.2.2.1.m1.1.1.2" xref="A1.T3.2.2.2.1.m1.1.1.2.cmml">3</mn><mo lspace="0.222em" rspace="0.222em" id="A1.T3.2.2.2.1.m1.1.1.1" xref="A1.T3.2.2.2.1.m1.1.1.1.cmml">×</mo><mn id="A1.T3.2.2.2.1.m1.1.1.3" xref="A1.T3.2.2.2.1.m1.1.1.3.cmml">32</mn><mo lspace="0.222em" rspace="0.222em" id="A1.T3.2.2.2.1.m1.1.1.1a" xref="A1.T3.2.2.2.1.m1.1.1.1.cmml">×</mo><mn id="A1.T3.2.2.2.1.m1.1.1.4" xref="A1.T3.2.2.2.1.m1.1.1.4.cmml">32</mn></mrow><annotation-xml encoding="MathML-Content" id="A1.T3.2.2.2.1.m1.1b"><apply id="A1.T3.2.2.2.1.m1.1.1.cmml" xref="A1.T3.2.2.2.1.m1.1.1"><times id="A1.T3.2.2.2.1.m1.1.1.1.cmml" xref="A1.T3.2.2.2.1.m1.1.1.1"></times><cn type="integer" id="A1.T3.2.2.2.1.m1.1.1.2.cmml" xref="A1.T3.2.2.2.1.m1.1.1.2">3</cn><cn type="integer" id="A1.T3.2.2.2.1.m1.1.1.3.cmml" xref="A1.T3.2.2.2.1.m1.1.1.3">32</cn><cn type="integer" id="A1.T3.2.2.2.1.m1.1.1.4.cmml" xref="A1.T3.2.2.2.1.m1.1.1.4">32</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.T3.2.2.2.1.m1.1c">3\times 32\times 32</annotation></semantics></math></td>
</tr>
<tr id="A1.T3.3.3.3" class="ltx_tr">
<td id="A1.T3.3.3.3.2" class="ltx_td ltx_align_center ltx_border_bb">TinyImageNet</td>
<td id="A1.T3.3.3.3.3" class="ltx_td ltx_align_center ltx_border_bb">100,000</td>
<td id="A1.T3.3.3.3.4" class="ltx_td ltx_align_center ltx_border_bb">10,000</td>
<td id="A1.T3.3.3.3.5" class="ltx_td ltx_align_center ltx_border_bb">200</td>
<td id="A1.T3.3.3.3.1" class="ltx_td ltx_align_center ltx_border_bb"><math id="A1.T3.3.3.3.1.m1.1" class="ltx_Math" alttext="3\times 64\times 64" display="inline"><semantics id="A1.T3.3.3.3.1.m1.1a"><mrow id="A1.T3.3.3.3.1.m1.1.1" xref="A1.T3.3.3.3.1.m1.1.1.cmml"><mn id="A1.T3.3.3.3.1.m1.1.1.2" xref="A1.T3.3.3.3.1.m1.1.1.2.cmml">3</mn><mo lspace="0.222em" rspace="0.222em" id="A1.T3.3.3.3.1.m1.1.1.1" xref="A1.T3.3.3.3.1.m1.1.1.1.cmml">×</mo><mn id="A1.T3.3.3.3.1.m1.1.1.3" xref="A1.T3.3.3.3.1.m1.1.1.3.cmml">64</mn><mo lspace="0.222em" rspace="0.222em" id="A1.T3.3.3.3.1.m1.1.1.1a" xref="A1.T3.3.3.3.1.m1.1.1.1.cmml">×</mo><mn id="A1.T3.3.3.3.1.m1.1.1.4" xref="A1.T3.3.3.3.1.m1.1.1.4.cmml">64</mn></mrow><annotation-xml encoding="MathML-Content" id="A1.T3.3.3.3.1.m1.1b"><apply id="A1.T3.3.3.3.1.m1.1.1.cmml" xref="A1.T3.3.3.3.1.m1.1.1"><times id="A1.T3.3.3.3.1.m1.1.1.1.cmml" xref="A1.T3.3.3.3.1.m1.1.1.1"></times><cn type="integer" id="A1.T3.3.3.3.1.m1.1.1.2.cmml" xref="A1.T3.3.3.3.1.m1.1.1.2">3</cn><cn type="integer" id="A1.T3.3.3.3.1.m1.1.1.3.cmml" xref="A1.T3.3.3.3.1.m1.1.1.3">64</cn><cn type="integer" id="A1.T3.3.3.3.1.m1.1.1.4.cmml" xref="A1.T3.3.3.3.1.m1.1.1.4">64</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.T3.3.3.3.1.m1.1c">3\times 64\times 64</annotation></semantics></math></td>
</tr>
</tbody>
</table>
</span></div>
</figure>
</section>
<section id="A1.SS1.SSS0.Px2" class="ltx_paragraph">
<h4 class="ltx_title ltx_title_paragraph">Backbone.</h4>

<div id="A1.SS1.SSS0.Px2.p1" class="ltx_para">
<p id="A1.SS1.SSS0.Px2.p1.10" class="ltx_p">We adopt two backbones including ViT and CNN for experiments.
Given an image <math id="A1.SS1.SSS0.Px2.p1.1.m1.1" class="ltx_Math" alttext="I\in\mathbb{R}^{3\times h\times w}" display="inline"><semantics id="A1.SS1.SSS0.Px2.p1.1.m1.1a"><mrow id="A1.SS1.SSS0.Px2.p1.1.m1.1.1" xref="A1.SS1.SSS0.Px2.p1.1.m1.1.1.cmml"><mi id="A1.SS1.SSS0.Px2.p1.1.m1.1.1.2" xref="A1.SS1.SSS0.Px2.p1.1.m1.1.1.2.cmml">I</mi><mo id="A1.SS1.SSS0.Px2.p1.1.m1.1.1.1" xref="A1.SS1.SSS0.Px2.p1.1.m1.1.1.1.cmml">∈</mo><msup id="A1.SS1.SSS0.Px2.p1.1.m1.1.1.3" xref="A1.SS1.SSS0.Px2.p1.1.m1.1.1.3.cmml"><mi id="A1.SS1.SSS0.Px2.p1.1.m1.1.1.3.2" xref="A1.SS1.SSS0.Px2.p1.1.m1.1.1.3.2.cmml">ℝ</mi><mrow id="A1.SS1.SSS0.Px2.p1.1.m1.1.1.3.3" xref="A1.SS1.SSS0.Px2.p1.1.m1.1.1.3.3.cmml"><mn id="A1.SS1.SSS0.Px2.p1.1.m1.1.1.3.3.2" xref="A1.SS1.SSS0.Px2.p1.1.m1.1.1.3.3.2.cmml">3</mn><mo lspace="0.222em" rspace="0.222em" id="A1.SS1.SSS0.Px2.p1.1.m1.1.1.3.3.1" xref="A1.SS1.SSS0.Px2.p1.1.m1.1.1.3.3.1.cmml">×</mo><mi id="A1.SS1.SSS0.Px2.p1.1.m1.1.1.3.3.3" xref="A1.SS1.SSS0.Px2.p1.1.m1.1.1.3.3.3.cmml">h</mi><mo lspace="0.222em" rspace="0.222em" id="A1.SS1.SSS0.Px2.p1.1.m1.1.1.3.3.1a" xref="A1.SS1.SSS0.Px2.p1.1.m1.1.1.3.3.1.cmml">×</mo><mi id="A1.SS1.SSS0.Px2.p1.1.m1.1.1.3.3.4" xref="A1.SS1.SSS0.Px2.p1.1.m1.1.1.3.3.4.cmml">w</mi></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="A1.SS1.SSS0.Px2.p1.1.m1.1b"><apply id="A1.SS1.SSS0.Px2.p1.1.m1.1.1.cmml" xref="A1.SS1.SSS0.Px2.p1.1.m1.1.1"><in id="A1.SS1.SSS0.Px2.p1.1.m1.1.1.1.cmml" xref="A1.SS1.SSS0.Px2.p1.1.m1.1.1.1"></in><ci id="A1.SS1.SSS0.Px2.p1.1.m1.1.1.2.cmml" xref="A1.SS1.SSS0.Px2.p1.1.m1.1.1.2">𝐼</ci><apply id="A1.SS1.SSS0.Px2.p1.1.m1.1.1.3.cmml" xref="A1.SS1.SSS0.Px2.p1.1.m1.1.1.3"><csymbol cd="ambiguous" id="A1.SS1.SSS0.Px2.p1.1.m1.1.1.3.1.cmml" xref="A1.SS1.SSS0.Px2.p1.1.m1.1.1.3">superscript</csymbol><ci id="A1.SS1.SSS0.Px2.p1.1.m1.1.1.3.2.cmml" xref="A1.SS1.SSS0.Px2.p1.1.m1.1.1.3.2">ℝ</ci><apply id="A1.SS1.SSS0.Px2.p1.1.m1.1.1.3.3.cmml" xref="A1.SS1.SSS0.Px2.p1.1.m1.1.1.3.3"><times id="A1.SS1.SSS0.Px2.p1.1.m1.1.1.3.3.1.cmml" xref="A1.SS1.SSS0.Px2.p1.1.m1.1.1.3.3.1"></times><cn type="integer" id="A1.SS1.SSS0.Px2.p1.1.m1.1.1.3.3.2.cmml" xref="A1.SS1.SSS0.Px2.p1.1.m1.1.1.3.3.2">3</cn><ci id="A1.SS1.SSS0.Px2.p1.1.m1.1.1.3.3.3.cmml" xref="A1.SS1.SSS0.Px2.p1.1.m1.1.1.3.3.3">ℎ</ci><ci id="A1.SS1.SSS0.Px2.p1.1.m1.1.1.3.3.4.cmml" xref="A1.SS1.SSS0.Px2.p1.1.m1.1.1.3.3.4">𝑤</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS1.SSS0.Px2.p1.1.m1.1c">I\in\mathbb{R}^{3\times h\times w}</annotation></semantics></math>, the ViT reshapes it to a sequence of flattened 2D patches <math id="A1.SS1.SSS0.Px2.p1.2.m2.1" class="ltx_Math" alttext="I_{p}\in\mathbb{R}^{n\times(p^{2}\cdot c)}" display="inline"><semantics id="A1.SS1.SSS0.Px2.p1.2.m2.1a"><mrow id="A1.SS1.SSS0.Px2.p1.2.m2.1.2" xref="A1.SS1.SSS0.Px2.p1.2.m2.1.2.cmml"><msub id="A1.SS1.SSS0.Px2.p1.2.m2.1.2.2" xref="A1.SS1.SSS0.Px2.p1.2.m2.1.2.2.cmml"><mi id="A1.SS1.SSS0.Px2.p1.2.m2.1.2.2.2" xref="A1.SS1.SSS0.Px2.p1.2.m2.1.2.2.2.cmml">I</mi><mi id="A1.SS1.SSS0.Px2.p1.2.m2.1.2.2.3" xref="A1.SS1.SSS0.Px2.p1.2.m2.1.2.2.3.cmml">p</mi></msub><mo id="A1.SS1.SSS0.Px2.p1.2.m2.1.2.1" xref="A1.SS1.SSS0.Px2.p1.2.m2.1.2.1.cmml">∈</mo><msup id="A1.SS1.SSS0.Px2.p1.2.m2.1.2.3" xref="A1.SS1.SSS0.Px2.p1.2.m2.1.2.3.cmml"><mi id="A1.SS1.SSS0.Px2.p1.2.m2.1.2.3.2" xref="A1.SS1.SSS0.Px2.p1.2.m2.1.2.3.2.cmml">ℝ</mi><mrow id="A1.SS1.SSS0.Px2.p1.2.m2.1.1.1" xref="A1.SS1.SSS0.Px2.p1.2.m2.1.1.1.cmml"><mi id="A1.SS1.SSS0.Px2.p1.2.m2.1.1.1.3" xref="A1.SS1.SSS0.Px2.p1.2.m2.1.1.1.3.cmml">n</mi><mo lspace="0.222em" rspace="0.222em" id="A1.SS1.SSS0.Px2.p1.2.m2.1.1.1.2" xref="A1.SS1.SSS0.Px2.p1.2.m2.1.1.1.2.cmml">×</mo><mrow id="A1.SS1.SSS0.Px2.p1.2.m2.1.1.1.1.1" xref="A1.SS1.SSS0.Px2.p1.2.m2.1.1.1.1.1.1.cmml"><mo stretchy="false" id="A1.SS1.SSS0.Px2.p1.2.m2.1.1.1.1.1.2" xref="A1.SS1.SSS0.Px2.p1.2.m2.1.1.1.1.1.1.cmml">(</mo><mrow id="A1.SS1.SSS0.Px2.p1.2.m2.1.1.1.1.1.1" xref="A1.SS1.SSS0.Px2.p1.2.m2.1.1.1.1.1.1.cmml"><msup id="A1.SS1.SSS0.Px2.p1.2.m2.1.1.1.1.1.1.2" xref="A1.SS1.SSS0.Px2.p1.2.m2.1.1.1.1.1.1.2.cmml"><mi id="A1.SS1.SSS0.Px2.p1.2.m2.1.1.1.1.1.1.2.2" xref="A1.SS1.SSS0.Px2.p1.2.m2.1.1.1.1.1.1.2.2.cmml">p</mi><mn id="A1.SS1.SSS0.Px2.p1.2.m2.1.1.1.1.1.1.2.3" xref="A1.SS1.SSS0.Px2.p1.2.m2.1.1.1.1.1.1.2.3.cmml">2</mn></msup><mo lspace="0.222em" rspace="0.222em" id="A1.SS1.SSS0.Px2.p1.2.m2.1.1.1.1.1.1.1" xref="A1.SS1.SSS0.Px2.p1.2.m2.1.1.1.1.1.1.1.cmml">⋅</mo><mi id="A1.SS1.SSS0.Px2.p1.2.m2.1.1.1.1.1.1.3" xref="A1.SS1.SSS0.Px2.p1.2.m2.1.1.1.1.1.1.3.cmml">c</mi></mrow><mo stretchy="false" id="A1.SS1.SSS0.Px2.p1.2.m2.1.1.1.1.1.3" xref="A1.SS1.SSS0.Px2.p1.2.m2.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="A1.SS1.SSS0.Px2.p1.2.m2.1b"><apply id="A1.SS1.SSS0.Px2.p1.2.m2.1.2.cmml" xref="A1.SS1.SSS0.Px2.p1.2.m2.1.2"><in id="A1.SS1.SSS0.Px2.p1.2.m2.1.2.1.cmml" xref="A1.SS1.SSS0.Px2.p1.2.m2.1.2.1"></in><apply id="A1.SS1.SSS0.Px2.p1.2.m2.1.2.2.cmml" xref="A1.SS1.SSS0.Px2.p1.2.m2.1.2.2"><csymbol cd="ambiguous" id="A1.SS1.SSS0.Px2.p1.2.m2.1.2.2.1.cmml" xref="A1.SS1.SSS0.Px2.p1.2.m2.1.2.2">subscript</csymbol><ci id="A1.SS1.SSS0.Px2.p1.2.m2.1.2.2.2.cmml" xref="A1.SS1.SSS0.Px2.p1.2.m2.1.2.2.2">𝐼</ci><ci id="A1.SS1.SSS0.Px2.p1.2.m2.1.2.2.3.cmml" xref="A1.SS1.SSS0.Px2.p1.2.m2.1.2.2.3">𝑝</ci></apply><apply id="A1.SS1.SSS0.Px2.p1.2.m2.1.2.3.cmml" xref="A1.SS1.SSS0.Px2.p1.2.m2.1.2.3"><csymbol cd="ambiguous" id="A1.SS1.SSS0.Px2.p1.2.m2.1.2.3.1.cmml" xref="A1.SS1.SSS0.Px2.p1.2.m2.1.2.3">superscript</csymbol><ci id="A1.SS1.SSS0.Px2.p1.2.m2.1.2.3.2.cmml" xref="A1.SS1.SSS0.Px2.p1.2.m2.1.2.3.2">ℝ</ci><apply id="A1.SS1.SSS0.Px2.p1.2.m2.1.1.1.cmml" xref="A1.SS1.SSS0.Px2.p1.2.m2.1.1.1"><times id="A1.SS1.SSS0.Px2.p1.2.m2.1.1.1.2.cmml" xref="A1.SS1.SSS0.Px2.p1.2.m2.1.1.1.2"></times><ci id="A1.SS1.SSS0.Px2.p1.2.m2.1.1.1.3.cmml" xref="A1.SS1.SSS0.Px2.p1.2.m2.1.1.1.3">𝑛</ci><apply id="A1.SS1.SSS0.Px2.p1.2.m2.1.1.1.1.1.1.cmml" xref="A1.SS1.SSS0.Px2.p1.2.m2.1.1.1.1.1"><ci id="A1.SS1.SSS0.Px2.p1.2.m2.1.1.1.1.1.1.1.cmml" xref="A1.SS1.SSS0.Px2.p1.2.m2.1.1.1.1.1.1.1">⋅</ci><apply id="A1.SS1.SSS0.Px2.p1.2.m2.1.1.1.1.1.1.2.cmml" xref="A1.SS1.SSS0.Px2.p1.2.m2.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="A1.SS1.SSS0.Px2.p1.2.m2.1.1.1.1.1.1.2.1.cmml" xref="A1.SS1.SSS0.Px2.p1.2.m2.1.1.1.1.1.1.2">superscript</csymbol><ci id="A1.SS1.SSS0.Px2.p1.2.m2.1.1.1.1.1.1.2.2.cmml" xref="A1.SS1.SSS0.Px2.p1.2.m2.1.1.1.1.1.1.2.2">𝑝</ci><cn type="integer" id="A1.SS1.SSS0.Px2.p1.2.m2.1.1.1.1.1.1.2.3.cmml" xref="A1.SS1.SSS0.Px2.p1.2.m2.1.1.1.1.1.1.2.3">2</cn></apply><ci id="A1.SS1.SSS0.Px2.p1.2.m2.1.1.1.1.1.1.3.cmml" xref="A1.SS1.SSS0.Px2.p1.2.m2.1.1.1.1.1.1.3">𝑐</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS1.SSS0.Px2.p1.2.m2.1c">I_{p}\in\mathbb{R}^{n\times(p^{2}\cdot c)}</annotation></semantics></math>, where <math id="A1.SS1.SSS0.Px2.p1.3.m3.1" class="ltx_Math" alttext="c" display="inline"><semantics id="A1.SS1.SSS0.Px2.p1.3.m3.1a"><mi id="A1.SS1.SSS0.Px2.p1.3.m3.1.1" xref="A1.SS1.SSS0.Px2.p1.3.m3.1.1.cmml">c</mi><annotation-xml encoding="MathML-Content" id="A1.SS1.SSS0.Px2.p1.3.m3.1b"><ci id="A1.SS1.SSS0.Px2.p1.3.m3.1.1.cmml" xref="A1.SS1.SSS0.Px2.p1.3.m3.1.1">𝑐</ci></annotation-xml><annotation encoding="application/x-tex" id="A1.SS1.SSS0.Px2.p1.3.m3.1c">c</annotation></semantics></math> is the number of channels. <math id="A1.SS1.SSS0.Px2.p1.4.m4.2" class="ltx_Math" alttext="(h,w)" display="inline"><semantics id="A1.SS1.SSS0.Px2.p1.4.m4.2a"><mrow id="A1.SS1.SSS0.Px2.p1.4.m4.2.3.2" xref="A1.SS1.SSS0.Px2.p1.4.m4.2.3.1.cmml"><mo stretchy="false" id="A1.SS1.SSS0.Px2.p1.4.m4.2.3.2.1" xref="A1.SS1.SSS0.Px2.p1.4.m4.2.3.1.cmml">(</mo><mi id="A1.SS1.SSS0.Px2.p1.4.m4.1.1" xref="A1.SS1.SSS0.Px2.p1.4.m4.1.1.cmml">h</mi><mo id="A1.SS1.SSS0.Px2.p1.4.m4.2.3.2.2" xref="A1.SS1.SSS0.Px2.p1.4.m4.2.3.1.cmml">,</mo><mi id="A1.SS1.SSS0.Px2.p1.4.m4.2.2" xref="A1.SS1.SSS0.Px2.p1.4.m4.2.2.cmml">w</mi><mo stretchy="false" id="A1.SS1.SSS0.Px2.p1.4.m4.2.3.2.3" xref="A1.SS1.SSS0.Px2.p1.4.m4.2.3.1.cmml">)</mo></mrow><annotation-xml encoding="MathML-Content" id="A1.SS1.SSS0.Px2.p1.4.m4.2b"><interval closure="open" id="A1.SS1.SSS0.Px2.p1.4.m4.2.3.1.cmml" xref="A1.SS1.SSS0.Px2.p1.4.m4.2.3.2"><ci id="A1.SS1.SSS0.Px2.p1.4.m4.1.1.cmml" xref="A1.SS1.SSS0.Px2.p1.4.m4.1.1">ℎ</ci><ci id="A1.SS1.SSS0.Px2.p1.4.m4.2.2.cmml" xref="A1.SS1.SSS0.Px2.p1.4.m4.2.2">𝑤</ci></interval></annotation-xml><annotation encoding="application/x-tex" id="A1.SS1.SSS0.Px2.p1.4.m4.2c">(h,w)</annotation></semantics></math> is the height and width of the original image, while <math id="A1.SS1.SSS0.Px2.p1.5.m5.2" class="ltx_Math" alttext="(p,p)" display="inline"><semantics id="A1.SS1.SSS0.Px2.p1.5.m5.2a"><mrow id="A1.SS1.SSS0.Px2.p1.5.m5.2.3.2" xref="A1.SS1.SSS0.Px2.p1.5.m5.2.3.1.cmml"><mo stretchy="false" id="A1.SS1.SSS0.Px2.p1.5.m5.2.3.2.1" xref="A1.SS1.SSS0.Px2.p1.5.m5.2.3.1.cmml">(</mo><mi id="A1.SS1.SSS0.Px2.p1.5.m5.1.1" xref="A1.SS1.SSS0.Px2.p1.5.m5.1.1.cmml">p</mi><mo id="A1.SS1.SSS0.Px2.p1.5.m5.2.3.2.2" xref="A1.SS1.SSS0.Px2.p1.5.m5.2.3.1.cmml">,</mo><mi id="A1.SS1.SSS0.Px2.p1.5.m5.2.2" xref="A1.SS1.SSS0.Px2.p1.5.m5.2.2.cmml">p</mi><mo stretchy="false" id="A1.SS1.SSS0.Px2.p1.5.m5.2.3.2.3" xref="A1.SS1.SSS0.Px2.p1.5.m5.2.3.1.cmml">)</mo></mrow><annotation-xml encoding="MathML-Content" id="A1.SS1.SSS0.Px2.p1.5.m5.2b"><interval closure="open" id="A1.SS1.SSS0.Px2.p1.5.m5.2.3.1.cmml" xref="A1.SS1.SSS0.Px2.p1.5.m5.2.3.2"><ci id="A1.SS1.SSS0.Px2.p1.5.m5.1.1.cmml" xref="A1.SS1.SSS0.Px2.p1.5.m5.1.1">𝑝</ci><ci id="A1.SS1.SSS0.Px2.p1.5.m5.2.2.cmml" xref="A1.SS1.SSS0.Px2.p1.5.m5.2.2">𝑝</ci></interval></annotation-xml><annotation encoding="application/x-tex" id="A1.SS1.SSS0.Px2.p1.5.m5.2c">(p,p)</annotation></semantics></math> is the size of each image patch. A trainable linear projection flattens the patches into a latent <math id="A1.SS1.SSS0.Px2.p1.6.m6.1" class="ltx_Math" alttext="D" display="inline"><semantics id="A1.SS1.SSS0.Px2.p1.6.m6.1a"><mi id="A1.SS1.SSS0.Px2.p1.6.m6.1.1" xref="A1.SS1.SSS0.Px2.p1.6.m6.1.1.cmml">D</mi><annotation-xml encoding="MathML-Content" id="A1.SS1.SSS0.Px2.p1.6.m6.1b"><ci id="A1.SS1.SSS0.Px2.p1.6.m6.1.1.cmml" xref="A1.SS1.SSS0.Px2.p1.6.m6.1.1">𝐷</ci></annotation-xml><annotation encoding="application/x-tex" id="A1.SS1.SSS0.Px2.p1.6.m6.1c">D</annotation></semantics></math>-dimensional embedding space, which is then embedded with a positional embedding. The transformer encoder consists of <math id="A1.SS1.SSS0.Px2.p1.7.m7.1" class="ltx_Math" alttext="N" display="inline"><semantics id="A1.SS1.SSS0.Px2.p1.7.m7.1a"><mi id="A1.SS1.SSS0.Px2.p1.7.m7.1.1" xref="A1.SS1.SSS0.Px2.p1.7.m7.1.1.cmml">N</mi><annotation-xml encoding="MathML-Content" id="A1.SS1.SSS0.Px2.p1.7.m7.1b"><ci id="A1.SS1.SSS0.Px2.p1.7.m7.1.1.cmml" xref="A1.SS1.SSS0.Px2.p1.7.m7.1.1">𝑁</ci></annotation-xml><annotation encoding="application/x-tex" id="A1.SS1.SSS0.Px2.p1.7.m7.1c">N</annotation></semantics></math> layers of Multi-Head Self-Attention (MSA) and Multi-Layer Perceptron (MLP) blocks. For MSA, the queries, keys and values are generated via linear transformations on the inputs for <math id="A1.SS1.SSS0.Px2.p1.8.m8.1" class="ltx_Math" alttext="K" display="inline"><semantics id="A1.SS1.SSS0.Px2.p1.8.m8.1a"><mi id="A1.SS1.SSS0.Px2.p1.8.m8.1.1" xref="A1.SS1.SSS0.Px2.p1.8.m8.1.1.cmml">K</mi><annotation-xml encoding="MathML-Content" id="A1.SS1.SSS0.Px2.p1.8.m8.1b"><ci id="A1.SS1.SSS0.Px2.p1.8.m8.1.1.cmml" xref="A1.SS1.SSS0.Px2.p1.8.m8.1.1">𝐾</ci></annotation-xml><annotation encoding="application/x-tex" id="A1.SS1.SSS0.Px2.p1.8.m8.1c">K</annotation></semantics></math> times with one individual learned weight for each head. Then in parallel, the attention function is applied to all queries, keys, and values. The sequence of image patches <math id="A1.SS1.SSS0.Px2.p1.9.m9.1" class="ltx_Math" alttext="I_{p}" display="inline"><semantics id="A1.SS1.SSS0.Px2.p1.9.m9.1a"><msub id="A1.SS1.SSS0.Px2.p1.9.m9.1.1" xref="A1.SS1.SSS0.Px2.p1.9.m9.1.1.cmml"><mi id="A1.SS1.SSS0.Px2.p1.9.m9.1.1.2" xref="A1.SS1.SSS0.Px2.p1.9.m9.1.1.2.cmml">I</mi><mi id="A1.SS1.SSS0.Px2.p1.9.m9.1.1.3" xref="A1.SS1.SSS0.Px2.p1.9.m9.1.1.3.cmml">p</mi></msub><annotation-xml encoding="MathML-Content" id="A1.SS1.SSS0.Px2.p1.9.m9.1b"><apply id="A1.SS1.SSS0.Px2.p1.9.m9.1.1.cmml" xref="A1.SS1.SSS0.Px2.p1.9.m9.1.1"><csymbol cd="ambiguous" id="A1.SS1.SSS0.Px2.p1.9.m9.1.1.1.cmml" xref="A1.SS1.SSS0.Px2.p1.9.m9.1.1">subscript</csymbol><ci id="A1.SS1.SSS0.Px2.p1.9.m9.1.1.2.cmml" xref="A1.SS1.SSS0.Px2.p1.9.m9.1.1.2">𝐼</ci><ci id="A1.SS1.SSS0.Px2.p1.9.m9.1.1.3.cmml" xref="A1.SS1.SSS0.Px2.p1.9.m9.1.1.3">𝑝</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS1.SSS0.Px2.p1.9.m9.1c">I_{p}</annotation></semantics></math> is passed into the MSA, followed by MLP for <math id="A1.SS1.SSS0.Px2.p1.10.m10.1" class="ltx_Math" alttext="N" display="inline"><semantics id="A1.SS1.SSS0.Px2.p1.10.m10.1a"><mi id="A1.SS1.SSS0.Px2.p1.10.m10.1.1" xref="A1.SS1.SSS0.Px2.p1.10.m10.1.1.cmml">N</mi><annotation-xml encoding="MathML-Content" id="A1.SS1.SSS0.Px2.p1.10.m10.1b"><ci id="A1.SS1.SSS0.Px2.p1.10.m10.1.1.cmml" xref="A1.SS1.SSS0.Px2.p1.10.m10.1.1">𝑁</ci></annotation-xml><annotation encoding="application/x-tex" id="A1.SS1.SSS0.Px2.p1.10.m10.1c">N</annotation></semantics></math> times to get the final outputs.</p>
</div>
<div id="A1.SS1.SSS0.Px2.p2" class="ltx_para">
<p id="A1.SS1.SSS0.Px2.p2.1" class="ltx_p">The ViT used by us consists of 8 blocks with 8 self-attention layers in each block. The corresponding attention head number is 8, the patch size is 4 and the embedding dimension is 128.
The CNN consists of the basic modules of CNN, including two conventional layers with 64 of <math id="A1.SS1.SSS0.Px2.p2.1.m1.1" class="ltx_Math" alttext="5\times 5" display="inline"><semantics id="A1.SS1.SSS0.Px2.p2.1.m1.1a"><mrow id="A1.SS1.SSS0.Px2.p2.1.m1.1.1" xref="A1.SS1.SSS0.Px2.p2.1.m1.1.1.cmml"><mn id="A1.SS1.SSS0.Px2.p2.1.m1.1.1.2" xref="A1.SS1.SSS0.Px2.p2.1.m1.1.1.2.cmml">5</mn><mo lspace="0.222em" rspace="0.222em" id="A1.SS1.SSS0.Px2.p2.1.m1.1.1.1" xref="A1.SS1.SSS0.Px2.p2.1.m1.1.1.1.cmml">×</mo><mn id="A1.SS1.SSS0.Px2.p2.1.m1.1.1.3" xref="A1.SS1.SSS0.Px2.p2.1.m1.1.1.3.cmml">5</mn></mrow><annotation-xml encoding="MathML-Content" id="A1.SS1.SSS0.Px2.p2.1.m1.1b"><apply id="A1.SS1.SSS0.Px2.p2.1.m1.1.1.cmml" xref="A1.SS1.SSS0.Px2.p2.1.m1.1.1"><times id="A1.SS1.SSS0.Px2.p2.1.m1.1.1.1.cmml" xref="A1.SS1.SSS0.Px2.p2.1.m1.1.1.1"></times><cn type="integer" id="A1.SS1.SSS0.Px2.p2.1.m1.1.1.2.cmml" xref="A1.SS1.SSS0.Px2.p2.1.m1.1.1.2">5</cn><cn type="integer" id="A1.SS1.SSS0.Px2.p2.1.m1.1.1.3.cmml" xref="A1.SS1.SSS0.Px2.p2.1.m1.1.1.3">5</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="A1.SS1.SSS0.Px2.p2.1.m1.1c">5\times 5</annotation></semantics></math> convolution kernels, each conventional layer followed by a down-pooling larger, after that are two fully connected layers with 394 and 192 neurons and a softmax layer for prediction.</p>
</div>
<figure id="A1.F7" class="ltx_figure"><img src="/html/2303.08678/assets/x7.png" id="A1.F7.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="370" height="208" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 7: </span>Different visual prompt templates</figcaption>
</figure>
</section>
<section id="A1.SS1.SSS0.Px3" class="ltx_paragraph">
<h4 class="ltx_title ltx_title_paragraph">Three types of generating Visual Prompts.</h4>

<div id="A1.SS1.SSS0.Px3.p1" class="ltx_para">
<p id="A1.SS1.SSS0.Px3.p1.1" class="ltx_p">Following the settings of  <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib2" title="" class="ltx_ref">2</a>]</cite>, we explore three visual templates: pixel patch at a random location, pixel patch at a fixed location, and padding. We describe in Fig. <a href="#A1.F7" title="Figure 7 ‣ Backbone. ‣ A.1 Setups ‣ Appendix A Appendix: More Experiment Results ‣ Visual Prompt Based Personalized Federated Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">7</span></a> the difference between different visual prompts and how these visual prompts templates are added to the input picture. The comparison results are shown as Fig. <a href="#S4.F6" title="Figure 6 ‣ The guidance information contained in the prompts. ‣ 4.3 Exploratory Study ‣ 4 Experiments ‣ Visual Prompt Based Personalized Federated Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">6</span></a>.</p>
</div>
</section>
<section id="A1.SS1.SSS0.Px4" class="ltx_paragraph">
<h4 class="ltx_title ltx_title_paragraph">Dataset Partitions.</h4>

<div id="A1.SS1.SSS0.Px4.p1" class="ltx_para">
<p id="A1.SS1.SSS0.Px4.p1.1" class="ltx_p">To fairly compare with the other baselines, we introduce heterogeneity by splitting the total dataset and sampling the label ratios from the Dirichlet distribution and Pathological distribution. An additional parameter is used to control the level of heterogeneity of the entire data partition. In order to visualize the distribution of heterogeneous data, we make heat maps of the label distribution in different datasets, as shown in Fig. <a href="#A1.F8" title="Figure 8 ‣ Hyper-parameters Selections. ‣ A.1 Setups ‣ Appendix A Appendix: More Experiment Results ‣ Visual Prompt Based Personalized Federated Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">8</span></a>.  It could be seen that for heterogeneity weight equal to 0.3 in the Dirichlet distribution, about 10% to 20% of the categories dominate on each client, which is the blue block in Fig. <a href="#A1.F8" title="Figure 8 ‣ Hyper-parameters Selections. ‣ A.1 Setups ‣ Appendix A Appendix: More Experiment Results ‣ Visual Prompt Based Personalized Federated Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">8</span></a>. For heterogeneity weight equal to 5 in pathological distribution, 50% of the categories dominate on each client, which is the black block in  Fig. <a href="#A1.F8" title="Figure 8 ‣ Hyper-parameters Selections. ‣ A.1 Setups ‣ Appendix A Appendix: More Experiment Results ‣ Visual Prompt Based Personalized Federated Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">8</span></a>. The IID dataset is totally averaged for each client, which is the green block in  Fig. <a href="#A1.F8" title="Figure 8 ‣ Hyper-parameters Selections. ‣ A.1 Setups ‣ Appendix A Appendix: More Experiment Results ‣ Visual Prompt Based Personalized Federated Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">8</span></a>.</p>
</div>
</section>
<section id="A1.SS1.SSS0.Px5" class="ltx_paragraph">
<h4 class="ltx_title ltx_title_paragraph">Baselines.</h4>

<div id="A1.SS1.SSS0.Px5.p1" class="ltx_para">
<p id="A1.SS1.SSS0.Px5.p1.1" class="ltx_p">FedAvg <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib34" title="" class="ltx_ref">34</a>]</cite> is proposed as the basic framework in federated learning.
FedProx <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib30" title="" class="ltx_ref">30</a>]</cite> adds a proximal term to the objective function of the local model and allows for the emergence of incomplete training of the local model.
MOON <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib28" title="" class="ltx_ref">28</a>]</cite> is to utilize the similarity between model representations to correct the local training of individual parties, conducting contrastive learning at the model level.
FedPer <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib1" title="" class="ltx_ref">1</a>]</cite> and FedRep <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib8" title="" class="ltx_ref">8</a>]</cite> are base + personalization layer approaches for federated training of deep feedforward neural networks, which can combat the ill-effects of statistical heterogeneity.
FedMTL <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib39" title="" class="ltx_ref">39</a>]</cite> uses a multi-task learning (MTL) framework to learn separate models for each client. FedBABU <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib35" title="" class="ltx_ref">35</a>]</cite> achieves good personalization performance by freezing the last discriminative layer of the network and fine-tuning it after training. We also compare a baseline named Local, where each client trains a model with its local data without federated learning.</p>
</div>
</section>
<section id="A1.SS1.SSS0.Px6" class="ltx_paragraph">
<h4 class="ltx_title ltx_title_paragraph">Hyper-parameters Selections.</h4>

<div id="A1.SS1.SSS0.Px6.p1" class="ltx_para">
<p id="A1.SS1.SSS0.Px6.p1.1" class="ltx_p">We fix the learning rate for local training as 0.005 and for the prompt generator training as 1.0. We fix the training batch size as 16 and fix the epoch for local training as 5. For the specific parameters in FedProx, the proximal rate is set as 0.0001. For the specific parameters in MOON, the <math id="A1.SS1.SSS0.Px6.p1.1.m1.1" class="ltx_Math" alttext="\mu" display="inline"><semantics id="A1.SS1.SSS0.Px6.p1.1.m1.1a"><mi id="A1.SS1.SSS0.Px6.p1.1.m1.1.1" xref="A1.SS1.SSS0.Px6.p1.1.m1.1.1.cmml">μ</mi><annotation-xml encoding="MathML-Content" id="A1.SS1.SSS0.Px6.p1.1.m1.1b"><ci id="A1.SS1.SSS0.Px6.p1.1.m1.1.1.cmml" xref="A1.SS1.SSS0.Px6.p1.1.m1.1.1">𝜇</ci></annotation-xml><annotation encoding="application/x-tex" id="A1.SS1.SSS0.Px6.p1.1.m1.1c">\mu</annotation></semantics></math> is set as 1.0. For the specific parameters in FedRep, the personalized learning rate is set as 0.01. For the specific parameters in FedMTL, the iterations for solving quadratic sub-problems are set as 4000. For the specific parameters in FedBABU, the fine tuning step is set as 1.</p>
</div>
<figure id="A1.F8" class="ltx_figure">
<div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_3">
<figure id="A1.F8.sf1" class="ltx_figure ltx_figure_panel ltx_align_center"><img src="/html/2303.08678/assets/figures/IID.png" id="A1.F8.sf1.g1" class="ltx_graphics ltx_img_landscape" width="220" height="164" alt="Refer to caption">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure">(a) </span>IID</figcaption>
</figure>
</div>
<div class="ltx_flex_cell ltx_flex_size_3">
<figure id="A1.F8.sf2" class="ltx_figure ltx_figure_panel ltx_align_center"><img src="/html/2303.08678/assets/figures/DIR.png" id="A1.F8.sf2.g1" class="ltx_graphics ltx_img_landscape" width="220" height="164" alt="Refer to caption">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure">(b) </span>Dirichlet</figcaption>
</figure>
</div>
<div class="ltx_flex_cell ltx_flex_size_3">
<figure id="A1.F8.sf3" class="ltx_figure ltx_figure_panel ltx_align_center"><img src="/html/2303.08678/assets/figures/pat.png" id="A1.F8.sf3.g1" class="ltx_graphics ltx_img_landscape" width="220" height="165" alt="Refer to caption">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure">(c) </span>Pathological</figcaption>
</figure>
</div>
</div>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 8: </span>Heat maps for each client with CIFAR10 dataset under different data partitions. The color bar denotes the number of data samples. Each rectangle represents the number of data samples of a specific class in a party. </figcaption>
</figure>
</section>
</section>
<section id="A1.SS2" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">A.2 </span>Other Experimental Results</h3>

<section id="A1.SS2.SSS0.Px1" class="ltx_paragraph">
<h4 class="ltx_title ltx_title_paragraph">Experimental results for TinyImageNet.</h4>

<figure id="A1.T4" class="ltx_table">
<figcaption class="ltx_caption ltx_centering" style="font-size:50%;"><span class="ltx_tag ltx_tag_table">Table 4: </span>The results of the pFedPT and the benchmark methods on the TinyImageNet dataset with different non-IID settings and backbones.</figcaption>
<div id="A1.T4.3" class="ltx_inline-block ltx_align_center ltx_transformed_outer" style="width:298.1pt;height:321.9pt;vertical-align:-0.0pt;"><span class="ltx_transformed_inner" style="transform:translate(49.0pt,-52.9pt) scale(1.49006673327868,1.49006673327868) ;">
<table id="A1.T4.3.1" class="ltx_tabular ltx_guessed_headers ltx_align_middle">
<tbody class="ltx_tbody">
<tr id="A1.T4.3.1.1.1" class="ltx_tr">
<th id="A1.T4.3.1.1.1.1" class="ltx_td ltx_th ltx_th_row ltx_border_t" style="padding-top:0.65pt;padding-bottom:0.65pt;"></th>
<th id="A1.T4.3.1.1.1.2" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" style="padding-top:0.65pt;padding-bottom:0.65pt;" colspan="6"><span id="A1.T4.3.1.1.1.2.1" class="ltx_text" style="font-size:50%;">TinyImageNet</span></th>
<td id="A1.T4.3.1.1.1.3" class="ltx_td ltx_border_t" style="padding-top:0.65pt;padding-bottom:0.65pt;"></td>
</tr>
<tr id="A1.T4.3.1.2.2" class="ltx_tr">
<th id="A1.T4.3.1.2.2.1" class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_th_row" style="padding-top:0.65pt;padding-bottom:0.65pt;"><span id="A1.T4.3.1.2.2.1.1" class="ltx_text" style="font-size:50%;">#setting</span></th>
<th id="A1.T4.3.1.2.2.2" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" style="padding-top:0.65pt;padding-bottom:0.65pt;" colspan="2"><span id="A1.T4.3.1.2.2.2.1" class="ltx_text" style="font-size:50%;">IID</span></th>
<th id="A1.T4.3.1.2.2.3" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" style="padding-top:0.65pt;padding-bottom:0.65pt;" colspan="2"><span id="A1.T4.3.1.2.2.3.1" class="ltx_text" style="font-size:50%;">Dirichlet</span></th>
<th id="A1.T4.3.1.2.2.4" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" style="padding-top:0.65pt;padding-bottom:0.65pt;" colspan="2"><span id="A1.T4.3.1.2.2.4.1" class="ltx_text" style="font-size:50%;">Pathological</span></th>
<td id="A1.T4.3.1.2.2.5" class="ltx_td" style="padding-top:0.65pt;padding-bottom:0.65pt;"></td>
</tr>
<tr id="A1.T4.3.1.3.3" class="ltx_tr">
<th id="A1.T4.3.1.3.3.1" class="ltx_td ltx_align_left ltx_th ltx_th_column ltx_th_row" style="padding-top:0.65pt;padding-bottom:0.65pt;"><span id="A1.T4.3.1.3.3.1.1" class="ltx_text" style="font-size:50%;">#client</span></th>
<th id="A1.T4.3.1.3.3.2" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" style="padding-top:0.65pt;padding-bottom:0.65pt;"><span id="A1.T4.3.1.3.3.2.1" class="ltx_text" style="font-size:50%;">VIT</span></th>
<th id="A1.T4.3.1.3.3.3" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" style="padding-top:0.65pt;padding-bottom:0.65pt;"><span id="A1.T4.3.1.3.3.3.1" class="ltx_text" style="font-size:50%;">CNN</span></th>
<th id="A1.T4.3.1.3.3.4" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" style="padding-top:0.65pt;padding-bottom:0.65pt;"><span id="A1.T4.3.1.3.3.4.1" class="ltx_text" style="font-size:50%;">VIT</span></th>
<th id="A1.T4.3.1.3.3.5" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" style="padding-top:0.65pt;padding-bottom:0.65pt;"><span id="A1.T4.3.1.3.3.5.1" class="ltx_text" style="font-size:50%;">CNN</span></th>
<th id="A1.T4.3.1.3.3.6" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" style="padding-top:0.65pt;padding-bottom:0.65pt;"><span id="A1.T4.3.1.3.3.6.1" class="ltx_text" style="font-size:50%;">VIT</span></th>
<th id="A1.T4.3.1.3.3.7" class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" style="padding-top:0.65pt;padding-bottom:0.65pt;"><span id="A1.T4.3.1.3.3.7.1" class="ltx_text" style="font-size:50%;">CNN</span></th>
<td id="A1.T4.3.1.3.3.8" class="ltx_td" style="padding-top:0.65pt;padding-bottom:0.65pt;"></td>
</tr>
<tr id="A1.T4.3.1.4.4" class="ltx_tr">
<th id="A1.T4.3.1.4.4.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_t" style="padding-top:0.65pt;padding-bottom:0.65pt;"><span id="A1.T4.3.1.4.4.1.1" class="ltx_text" style="font-size:50%;">FedAvg</span></th>
<td id="A1.T4.3.1.4.4.2" class="ltx_td ltx_align_center ltx_border_t" style="padding-top:0.65pt;padding-bottom:0.65pt;"><span id="A1.T4.3.1.4.4.2.1" class="ltx_text" style="font-size:50%;">15.47</span></td>
<td id="A1.T4.3.1.4.4.3" class="ltx_td ltx_align_center ltx_border_t" style="padding-top:0.65pt;padding-bottom:0.65pt;"><span id="A1.T4.3.1.4.4.3.1" class="ltx_text" style="font-size:50%;">16.22</span></td>
<td id="A1.T4.3.1.4.4.4" class="ltx_td ltx_align_center ltx_border_t" style="padding-top:0.65pt;padding-bottom:0.65pt;"><span id="A1.T4.3.1.4.4.4.1" class="ltx_text" style="font-size:50%;">12.06</span></td>
<td id="A1.T4.3.1.4.4.5" class="ltx_td ltx_align_center ltx_border_t" style="padding-top:0.65pt;padding-bottom:0.65pt;"><span id="A1.T4.3.1.4.4.5.1" class="ltx_text" style="font-size:50%;">11.01</span></td>
<td id="A1.T4.3.1.4.4.6" class="ltx_td ltx_align_center ltx_border_t" style="padding-top:0.65pt;padding-bottom:0.65pt;"><span id="A1.T4.3.1.4.4.6.1" class="ltx_text" style="font-size:50%;">9.37</span></td>
<td id="A1.T4.3.1.4.4.7" class="ltx_td ltx_align_center ltx_border_t" style="padding-top:0.65pt;padding-bottom:0.65pt;"><span id="A1.T4.3.1.4.4.7.1" class="ltx_text" style="font-size:50%;">10.53</span></td>
<td id="A1.T4.3.1.4.4.8" class="ltx_td ltx_border_t" style="padding-top:0.65pt;padding-bottom:0.65pt;"></td>
</tr>
<tr id="A1.T4.3.1.5.5" class="ltx_tr">
<th id="A1.T4.3.1.5.5.1" class="ltx_td ltx_align_left ltx_th ltx_th_row" style="padding-top:0.65pt;padding-bottom:0.65pt;"><span id="A1.T4.3.1.5.5.1.1" class="ltx_text" style="font-size:50%;">FedProx</span></th>
<td id="A1.T4.3.1.5.5.2" class="ltx_td ltx_align_center" style="padding-top:0.65pt;padding-bottom:0.65pt;"><span id="A1.T4.3.1.5.5.2.1" class="ltx_text" style="font-size:50%;">15.53</span></td>
<td id="A1.T4.3.1.5.5.3" class="ltx_td ltx_align_center" style="padding-top:0.65pt;padding-bottom:0.65pt;"><span id="A1.T4.3.1.5.5.3.1" class="ltx_text" style="font-size:50%;">15.81</span></td>
<td id="A1.T4.3.1.5.5.4" class="ltx_td ltx_align_center" style="padding-top:0.65pt;padding-bottom:0.65pt;"><span id="A1.T4.3.1.5.5.4.1" class="ltx_text" style="font-size:50%;">13.82</span></td>
<td id="A1.T4.3.1.5.5.5" class="ltx_td ltx_align_center" style="padding-top:0.65pt;padding-bottom:0.65pt;"><span id="A1.T4.3.1.5.5.5.1" class="ltx_text" style="font-size:50%;">10.98</span></td>
<td id="A1.T4.3.1.5.5.6" class="ltx_td ltx_align_center" style="padding-top:0.65pt;padding-bottom:0.65pt;"><span id="A1.T4.3.1.5.5.6.1" class="ltx_text" style="font-size:50%;">12.84</span></td>
<td id="A1.T4.3.1.5.5.7" class="ltx_td ltx_align_center" style="padding-top:0.65pt;padding-bottom:0.65pt;"><span id="A1.T4.3.1.5.5.7.1" class="ltx_text" style="font-size:50%;">11.32</span></td>
<td id="A1.T4.3.1.5.5.8" class="ltx_td" style="padding-top:0.65pt;padding-bottom:0.65pt;"></td>
</tr>
<tr id="A1.T4.3.1.6.6" class="ltx_tr">
<th id="A1.T4.3.1.6.6.1" class="ltx_td ltx_align_left ltx_th ltx_th_row" style="padding-top:0.65pt;padding-bottom:0.65pt;"><span id="A1.T4.3.1.6.6.1.1" class="ltx_text" style="font-size:50%;">Moon</span></th>
<td id="A1.T4.3.1.6.6.2" class="ltx_td ltx_align_center" style="padding-top:0.65pt;padding-bottom:0.65pt;"><span id="A1.T4.3.1.6.6.2.1" class="ltx_text" style="font-size:50%;">15.20</span></td>
<td id="A1.T4.3.1.6.6.3" class="ltx_td ltx_align_center" style="padding-top:0.65pt;padding-bottom:0.65pt;"><span id="A1.T4.3.1.6.6.3.1" class="ltx_text ltx_font_bold" style="font-size:50%;">16.78</span></td>
<td id="A1.T4.3.1.6.6.4" class="ltx_td ltx_align_center" style="padding-top:0.65pt;padding-bottom:0.65pt;"><span id="A1.T4.3.1.6.6.4.1" class="ltx_text" style="font-size:50%;">15.51</span></td>
<td id="A1.T4.3.1.6.6.5" class="ltx_td ltx_align_center" style="padding-top:0.65pt;padding-bottom:0.65pt;"><span id="A1.T4.3.1.6.6.5.1" class="ltx_text" style="font-size:50%;">11.05</span></td>
<td id="A1.T4.3.1.6.6.6" class="ltx_td ltx_align_center" style="padding-top:0.65pt;padding-bottom:0.65pt;"><span id="A1.T4.3.1.6.6.6.1" class="ltx_text" style="font-size:50%;">13.67</span></td>
<td id="A1.T4.3.1.6.6.7" class="ltx_td ltx_align_center" style="padding-top:0.65pt;padding-bottom:0.65pt;"><span id="A1.T4.3.1.6.6.7.1" class="ltx_text" style="font-size:50%;">10.24</span></td>
<td id="A1.T4.3.1.6.6.8" class="ltx_td" style="padding-top:0.65pt;padding-bottom:0.65pt;"></td>
</tr>
<tr id="A1.T4.3.1.7.7" class="ltx_tr">
<th id="A1.T4.3.1.7.7.1" class="ltx_td ltx_align_left ltx_th ltx_th_row" style="padding-top:0.65pt;padding-bottom:0.65pt;"><span id="A1.T4.3.1.7.7.1.1" class="ltx_text" style="font-size:50%;">FedPer</span></th>
<td id="A1.T4.3.1.7.7.2" class="ltx_td ltx_align_center" style="padding-top:0.65pt;padding-bottom:0.65pt;"><span id="A1.T4.3.1.7.7.2.1" class="ltx_text" style="font-size:50%;">14.85</span></td>
<td id="A1.T4.3.1.7.7.3" class="ltx_td ltx_align_center" style="padding-top:0.65pt;padding-bottom:0.65pt;"><span id="A1.T4.3.1.7.7.3.1" class="ltx_text" style="font-size:50%;">13.18</span></td>
<td id="A1.T4.3.1.7.7.4" class="ltx_td ltx_align_center" style="padding-top:0.65pt;padding-bottom:0.65pt;"><span id="A1.T4.3.1.7.7.4.1" class="ltx_text" style="font-size:50%;">23.95</span></td>
<td id="A1.T4.3.1.7.7.5" class="ltx_td ltx_align_center" style="padding-top:0.65pt;padding-bottom:0.65pt;"><span id="A1.T4.3.1.7.7.5.1" class="ltx_text" style="font-size:50%;">20.21</span></td>
<td id="A1.T4.3.1.7.7.6" class="ltx_td ltx_align_center" style="padding-top:0.65pt;padding-bottom:0.65pt;"><span id="A1.T4.3.1.7.7.6.1" class="ltx_text" style="font-size:50%;">19.23</span></td>
<td id="A1.T4.3.1.7.7.7" class="ltx_td ltx_align_center" style="padding-top:0.65pt;padding-bottom:0.65pt;"><span id="A1.T4.3.1.7.7.7.1" class="ltx_text" style="font-size:50%;">17.99</span></td>
<td id="A1.T4.3.1.7.7.8" class="ltx_td" style="padding-top:0.65pt;padding-bottom:0.65pt;"></td>
</tr>
<tr id="A1.T4.3.1.8.8" class="ltx_tr">
<th id="A1.T4.3.1.8.8.1" class="ltx_td ltx_align_left ltx_th ltx_th_row" style="padding-top:0.65pt;padding-bottom:0.65pt;"><span id="A1.T4.3.1.8.8.1.1" class="ltx_text" style="font-size:50%;">FedRep</span></th>
<td id="A1.T4.3.1.8.8.2" class="ltx_td ltx_align_center" style="padding-top:0.65pt;padding-bottom:0.65pt;"><span id="A1.T4.3.1.8.8.2.1" class="ltx_text" style="font-size:50%;">12.91</span></td>
<td id="A1.T4.3.1.8.8.3" class="ltx_td ltx_align_center" style="padding-top:0.65pt;padding-bottom:0.65pt;"><span id="A1.T4.3.1.8.8.3.1" class="ltx_text" style="font-size:50%;">11.56</span></td>
<td id="A1.T4.3.1.8.8.4" class="ltx_td ltx_align_center" style="padding-top:0.65pt;padding-bottom:0.65pt;"><span id="A1.T4.3.1.8.8.4.1" class="ltx_text ltx_font_bold" style="font-size:50%;">25.24</span></td>
<td id="A1.T4.3.1.8.8.5" class="ltx_td ltx_align_center" style="padding-top:0.65pt;padding-bottom:0.65pt;"><span id="A1.T4.3.1.8.8.5.1" class="ltx_text" style="font-size:50%;">21.32</span></td>
<td id="A1.T4.3.1.8.8.6" class="ltx_td ltx_align_center" style="padding-top:0.65pt;padding-bottom:0.65pt;"><span id="A1.T4.3.1.8.8.6.1" class="ltx_text" style="font-size:50%;">23.43</span></td>
<td id="A1.T4.3.1.8.8.7" class="ltx_td ltx_align_center" style="padding-top:0.65pt;padding-bottom:0.65pt;"><span id="A1.T4.3.1.8.8.7.1" class="ltx_text" style="font-size:50%;">20.42</span></td>
<td id="A1.T4.3.1.8.8.8" class="ltx_td" style="padding-top:0.65pt;padding-bottom:0.65pt;"></td>
</tr>
<tr id="A1.T4.3.1.9.9" class="ltx_tr">
<th id="A1.T4.3.1.9.9.1" class="ltx_td ltx_align_left ltx_th ltx_th_row" style="padding-top:0.65pt;padding-bottom:0.65pt;"><span id="A1.T4.3.1.9.9.1.1" class="ltx_text" style="font-size:50%;">FedMTL</span></th>
<td id="A1.T4.3.1.9.9.2" class="ltx_td ltx_align_center" style="padding-top:0.65pt;padding-bottom:0.65pt;"><span id="A1.T4.3.1.9.9.2.1" class="ltx_text" style="font-size:50%;">9.75</span></td>
<td id="A1.T4.3.1.9.9.3" class="ltx_td ltx_align_center" style="padding-top:0.65pt;padding-bottom:0.65pt;"><span id="A1.T4.3.1.9.9.3.1" class="ltx_text" style="font-size:50%;">11.02</span></td>
<td id="A1.T4.3.1.9.9.4" class="ltx_td ltx_align_center" style="padding-top:0.65pt;padding-bottom:0.65pt;"><span id="A1.T4.3.1.9.9.4.1" class="ltx_text" style="font-size:50%;">21.14</span></td>
<td id="A1.T4.3.1.9.9.5" class="ltx_td ltx_align_center" style="padding-top:0.65pt;padding-bottom:0.65pt;"><span id="A1.T4.3.1.9.9.5.1" class="ltx_text" style="font-size:50%;">17.96</span></td>
<td id="A1.T4.3.1.9.9.6" class="ltx_td ltx_align_center" style="padding-top:0.65pt;padding-bottom:0.65pt;"><span id="A1.T4.3.1.9.9.6.1" class="ltx_text" style="font-size:50%;">18.30</span></td>
<td id="A1.T4.3.1.9.9.7" class="ltx_td ltx_align_center" style="padding-top:0.65pt;padding-bottom:0.65pt;"><span id="A1.T4.3.1.9.9.7.1" class="ltx_text" style="font-size:50%;">17.39</span></td>
<td id="A1.T4.3.1.9.9.8" class="ltx_td" style="padding-top:0.65pt;padding-bottom:0.65pt;"></td>
</tr>
<tr id="A1.T4.3.1.10.10" class="ltx_tr">
<th id="A1.T4.3.1.10.10.1" class="ltx_td ltx_align_left ltx_th ltx_th_row" style="padding-top:0.65pt;padding-bottom:0.65pt;"><span id="A1.T4.3.1.10.10.1.1" class="ltx_text" style="font-size:50%;">FedBABU</span></th>
<td id="A1.T4.3.1.10.10.2" class="ltx_td ltx_align_center" style="padding-top:0.65pt;padding-bottom:0.65pt;"><span id="A1.T4.3.1.10.10.2.1" class="ltx_text" style="font-size:50%;">13.61</span></td>
<td id="A1.T4.3.1.10.10.3" class="ltx_td ltx_align_center" style="padding-top:0.65pt;padding-bottom:0.65pt;"><span id="A1.T4.3.1.10.10.3.1" class="ltx_text" style="font-size:50%;">12.04</span></td>
<td id="A1.T4.3.1.10.10.4" class="ltx_td ltx_align_center" style="padding-top:0.65pt;padding-bottom:0.65pt;"><span id="A1.T4.3.1.10.10.4.1" class="ltx_text" style="font-size:50%;">24.34</span></td>
<td id="A1.T4.3.1.10.10.5" class="ltx_td ltx_align_center" style="padding-top:0.65pt;padding-bottom:0.65pt;"><span id="A1.T4.3.1.10.10.5.1" class="ltx_text" style="font-size:50%;">18.62</span></td>
<td id="A1.T4.3.1.10.10.6" class="ltx_td ltx_align_center" style="padding-top:0.65pt;padding-bottom:0.65pt;"><span id="A1.T4.3.1.10.10.6.1" class="ltx_text" style="font-size:50%;">22.46</span></td>
<td id="A1.T4.3.1.10.10.7" class="ltx_td ltx_align_center" style="padding-top:0.65pt;padding-bottom:0.65pt;"><span id="A1.T4.3.1.10.10.7.1" class="ltx_text" style="font-size:50%;">18.41</span></td>
<td id="A1.T4.3.1.10.10.8" class="ltx_td" style="padding-top:0.65pt;padding-bottom:0.65pt;"></td>
</tr>
<tr id="A1.T4.3.1.11.11" class="ltx_tr">
<th id="A1.T4.3.1.11.11.1" class="ltx_td ltx_align_left ltx_th ltx_th_row" style="padding-top:0.65pt;padding-bottom:0.65pt;"><span id="A1.T4.3.1.11.11.1.1" class="ltx_text" style="font-size:50%;">Local</span></th>
<td id="A1.T4.3.1.11.11.2" class="ltx_td ltx_align_center" style="padding-top:0.65pt;padding-bottom:0.65pt;"><span id="A1.T4.3.1.11.11.2.1" class="ltx_text" style="font-size:50%;">9.82</span></td>
<td id="A1.T4.3.1.11.11.3" class="ltx_td ltx_align_center" style="padding-top:0.65pt;padding-bottom:0.65pt;"><span id="A1.T4.3.1.11.11.3.1" class="ltx_text" style="font-size:50%;">10.72</span></td>
<td id="A1.T4.3.1.11.11.4" class="ltx_td ltx_align_center" style="padding-top:0.65pt;padding-bottom:0.65pt;"><span id="A1.T4.3.1.11.11.4.1" class="ltx_text" style="font-size:50%;">20.86</span></td>
<td id="A1.T4.3.1.11.11.5" class="ltx_td ltx_align_center" style="padding-top:0.65pt;padding-bottom:0.65pt;"><span id="A1.T4.3.1.11.11.5.1" class="ltx_text" style="font-size:50%;">17.43</span></td>
<td id="A1.T4.3.1.11.11.6" class="ltx_td ltx_align_center" style="padding-top:0.65pt;padding-bottom:0.65pt;"><span id="A1.T4.3.1.11.11.6.1" class="ltx_text" style="font-size:50%;">18.19</span></td>
<td id="A1.T4.3.1.11.11.7" class="ltx_td ltx_align_center" style="padding-top:0.65pt;padding-bottom:0.65pt;"><span id="A1.T4.3.1.11.11.7.1" class="ltx_text" style="font-size:50%;">17.12</span></td>
<td id="A1.T4.3.1.11.11.8" class="ltx_td" style="padding-top:0.65pt;padding-bottom:0.65pt;"></td>
</tr>
<tr id="A1.T4.3.1.12.12" class="ltx_tr">
<th id="A1.T4.3.1.12.12.1" class="ltx_td ltx_align_left ltx_th ltx_th_row ltx_border_b ltx_border_t" style="padding-top:0.65pt;padding-bottom:0.65pt;"><span id="A1.T4.3.1.12.12.1.1" class="ltx_text" style="font-size:50%;">pFedPT (ours)</span></th>
<td id="A1.T4.3.1.12.12.2" class="ltx_td ltx_align_center ltx_border_b ltx_border_t" style="padding-top:0.65pt;padding-bottom:0.65pt;"><span id="A1.T4.3.1.12.12.2.1" class="ltx_text ltx_font_bold" style="font-size:50%;">18.72</span></td>
<td id="A1.T4.3.1.12.12.3" class="ltx_td ltx_align_center ltx_border_b ltx_border_t" style="padding-top:0.65pt;padding-bottom:0.65pt;"><span id="A1.T4.3.1.12.12.3.1" class="ltx_text" style="font-size:50%;">16.53</span></td>
<td id="A1.T4.3.1.12.12.4" class="ltx_td ltx_align_center ltx_border_b ltx_border_t" style="padding-top:0.65pt;padding-bottom:0.65pt;"><span id="A1.T4.3.1.12.12.4.1" class="ltx_text" style="font-size:50%;">21.21</span></td>
<td id="A1.T4.3.1.12.12.5" class="ltx_td ltx_align_center ltx_border_b ltx_border_t" style="padding-top:0.65pt;padding-bottom:0.65pt;"><span id="A1.T4.3.1.12.12.5.1" class="ltx_text ltx_font_bold" style="font-size:50%;">21.42</span></td>
<td id="A1.T4.3.1.12.12.6" class="ltx_td ltx_align_center ltx_border_b ltx_border_t" style="padding-top:0.65pt;padding-bottom:0.65pt;"><span id="A1.T4.3.1.12.12.6.1" class="ltx_text ltx_font_bold" style="font-size:50%;">25.95</span></td>
<td id="A1.T4.3.1.12.12.7" class="ltx_td ltx_align_center ltx_border_b ltx_border_t" style="padding-top:0.65pt;padding-bottom:0.65pt;"><span id="A1.T4.3.1.12.12.7.1" class="ltx_text ltx_font_bold" style="font-size:50%;">20.66</span></td>
<td id="A1.T4.3.1.12.12.8" class="ltx_td ltx_border_b ltx_border_t" style="padding-top:0.65pt;padding-bottom:0.65pt;"></td>
</tr>
</tbody>
</table>
</span></div>
</figure>
<div id="A1.SS2.SSS0.Px1.p1" class="ltx_para">
<p id="A1.SS2.SSS0.Px1.p1.1" class="ltx_p">We compare the performance of pFedPT and other baselines on the TinyImageNet dataset with 500 rounds of communications. Tab. <a href="#A1.T4" title="Table 4 ‣ Experimental results for TinyImageNet. ‣ A.2 Other Experimental Results ‣ Appendix A Appendix: More Experiment Results ‣ Visual Prompt Based Personalized Federated Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">4</span></a> shows that the experimental results in TinyImageNet are still consistent with the interpretation in Sec. <a href="#S4.SS2" title="4.2 Main Results ‣ 4 Experiments ‣ Visual Prompt Based Personalized Federated Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">4.2</span></a>. For Pathological distribution with ViT, the test accuracy of the pFedPT is 25.95%, the accuracy of FedAvg achieves 9.37% and the accuracy of the FedPer achieves 19.23%. However, the test accuracy of the pFedPT is not the highest in Dirichlet distribution, our explanation is that it is hard to generate stable prompts in 500 rounds due to the increased task difficulty.</p>
</div>
<figure id="A1.F9" class="ltx_figure"><img src="/html/2303.08678/assets/x8.png" id="A1.F9.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="264" height="93" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 9: </span>Similarity comparison between the distribution of the predicted classes and the distribution of the local data.</figcaption>
</figure>
</section>
<section id="A1.SS2.SSS0.Px2" class="ltx_paragraph">
<h4 class="ltx_title ltx_title_paragraph">The connection between Prompt and the client data distribution.</h4>

<div id="A1.SS2.SSS0.Px2.p1" class="ltx_para">
<p id="A1.SS2.SSS0.Px2.p1.1" class="ltx_p">We use a single, pure-color image as input to investigate the relationship between the local model output and the data distribution of each client. Ideally, the output distribution over classes of each pFedPT client should align with the local data distribution. Fig. <a href="#A1.F9" title="Figure 9 ‣ Experimental results for TinyImageNet. ‣ A.2 Other Experimental Results ‣ Appendix A Appendix: More Experiment Results ‣ Visual Prompt Based Personalized Federated Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">9</span></a> reveals that after adding the visual prompts, the outputs of the pFedPT will be similar to the distribution of the client itself. The difference between the visual prompts generated by clients with similar data distribution is also smaller, which means that the visual prompts indeed contain the data distribution information of the clients. Therefore, the visual prompts provide the model with certain prior knowledge when classifying a specific client and assist in the classification task.</p>
</div>
<figure id="A1.F10" class="ltx_figure"><img src="/html/2303.08678/assets/x9.png" id="A1.F10.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="185" height="126" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 10: </span>The difference of prompt between two consecutive rounds.</figcaption>
</figure>
</section>
<section id="A1.SS2.SSS0.Px3" class="ltx_paragraph">
<h4 class="ltx_title ltx_title_paragraph">Empirical analysis of the learned prompts.</h4>

<div id="A1.SS2.SSS0.Px3.p1" class="ltx_para">
<p id="A1.SS2.SSS0.Px3.p1.1" class="ltx_p">Fig. <a href="#A1.F10" title="Figure 10 ‣ The connection between Prompt and the client data distribution. ‣ A.2 Other Experimental Results ‣ Appendix A Appendix: More Experiment Results ‣ Visual Prompt Based Personalized Federated Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">10</span></a> records the average difference of the prompts generated between the two rounds before and after ten clients during the pFedPT training process. The overall experimental results are divided into two stages: first ascending and then descending. In our settings, the initial prompt generator parameters of each client are the same, and the rising stage is the mapping process between each client and the prompts based on its own data distribution. The descending stage is when the aggregated model tends to converge, and the mapping between the prompt and the client data distribution on each client is complete. Eventually, the change in prompt embedding approaches 0, that is, each client establishes stable prompts that conform to its own data distribution.</p>
</div>
<figure id="A1.F11" class="ltx_figure">
<div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_1"><img src="/html/2303.08678/assets/x10.png" id="A1.F11.g1" class="ltx_graphics ltx_centering ltx_figure_panel ltx_img_landscape" width="185" height="142" alt="Refer to caption"></div>
</div>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure">Figure 11: </span>Test accuracy after fine-tuning the head of models trained on a client of CIFAR10 datasets with ViT</figcaption><div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_1">
<p id="A1.F11.1" class="ltx_p ltx_figure_panel ltx_align_center">.</p>
</div>
</div>
</figure>
</section>
<section id="A1.SS2.SSS0.Px4" class="ltx_paragraph">
<h4 class="ltx_title ltx_title_paragraph">Generalization ability of the pFedPT.</h4>

<div id="A1.SS2.SSS0.Px4.p1" class="ltx_para">
<p id="A1.SS2.SSS0.Px4.p1.1" class="ltx_p">We evaluate the strength of the backbone learned by pFedPT in terms of adaptation to new clients. To do so, we first train the pFedPT and the FedAvg in the usual setting on the partition of the CIFAR10 dataset with 10 clients and the Dir (0.1) partition. Then, we encounter clients with data from Dir (0.3) partition of the CIFAR10 dataset. We assume we have access to a dataset of 400 samples for this new client to fine-tune. For the pFedPT, we fine-tune the prompt generator parameter over multiple epochs while keeping the backbone fixed. For the FedAvg, fine-tune the last layer of the backbone while keeping the other layers. Fig. <a href="#A1.F11" title="Figure 11 ‣ Empirical analysis of the learned prompts. ‣ A.2 Other Experimental Results ‣ Appendix A Appendix: More Experiment Results ‣ Visual Prompt Based Personalized Federated Learning" class="ltx_ref"><span class="ltx_text ltx_ref_tag">11</span></a> shows that the pFedPT has significantly better performance than the FedAvg.</p>
</div>
</section>
</section>
</section>
</article>
</div>
<div class="ar5iv-footer"><a href="/html/2303.08677" class="ar5iv-nav-button ar5iv-nav-button-prev">◄</a>
    <a class="ar5iv-home-button" href="/"><img height="40" alt="ar5iv homepage" src="/assets/ar5iv.png"></a>
    <a href="/feeling_lucky" class="ar5iv-text-button">Feeling<br>lucky?</a>
    <a href="/log/2303.08678" class="ar5iv-text-button ar5iv-severity-warning">Conversion<br>report</a>
    <a class="ar5iv-text-button" target="_blank" href="https://github.com/dginev/ar5iv/issues/new?template=improve-article--arxiv-id-.md&title=Improve+article+2303.08678">Report<br>an issue</a>
    <a href="https://arxiv.org/abs/2303.08678" class="ar5iv-text-button arxiv-ui-theme">View&nbsp;original<br>on&nbsp;arXiv</a><a href="/html/2303.08679" class="ar5iv-nav-button ar5iv-nav-button-next">►</a>
</div><footer class="ltx_page_footer">
<a class="ar5iv-toggle-color-scheme" href="javascript:toggleColorScheme()" title="Toggle ar5iv color scheme"><span class="color-scheme-icon"></span></a>
<a class="ar5iv-footer-button" href="https://arxiv.org/help/license" target="_blank">Copyright</a>
<a class="ar5iv-footer-button" href="https://arxiv.org/help/policies/privacy_policy" target="_blank">Privacy Policy</a>

<div class="ltx_page_logo">Generated  on Thu Feb 29 19:57:05 2024 by <a target="_blank" href="http://dlmf.nist.gov/LaTeXML/" class="ltx_LaTeXML_logo"><span style="letter-spacing:-0.2em; margin-right:0.1em;">L<span class="ltx_font_smallcaps" style="position:relative; bottom:2.2pt;">a</span>T<span class="ltx_font_smallcaps" style="font-size:120%;position:relative; bottom:-0.2ex;">e</span></span><span style="font-size:90%; position:relative; bottom:-0.2ex;">XML</span><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAsAAAAOCAYAAAD5YeaVAAAAAXNSR0IArs4c6QAAAAZiS0dEAP8A/wD/oL2nkwAAAAlwSFlzAAALEwAACxMBAJqcGAAAAAd0SU1FB9wKExQZLWTEaOUAAAAddEVYdENvbW1lbnQAQ3JlYXRlZCB3aXRoIFRoZSBHSU1Q72QlbgAAAdpJREFUKM9tkL+L2nAARz9fPZNCKFapUn8kyI0e4iRHSR1Kb8ng0lJw6FYHFwv2LwhOpcWxTjeUunYqOmqd6hEoRDhtDWdA8ApRYsSUCDHNt5ul13vz4w0vWCgUnnEc975arX6ORqN3VqtVZbfbTQC4uEHANM3jSqXymFI6yWazP2KxWAXAL9zCUa1Wy2tXVxheKA9YNoR8Pt+aTqe4FVVVvz05O6MBhqUIBGk8Hn8HAOVy+T+XLJfLS4ZhTiRJgqIoVBRFIoric47jPnmeB1mW/9rr9ZpSSn3Lsmir1fJZlqWlUonKsvwWwD8ymc/nXwVBeLjf7xEKhdBut9Hr9WgmkyGEkJwsy5eHG5vN5g0AKIoCAEgkEkin0wQAfN9/cXPdheu6P33fBwB4ngcAcByHJpPJl+fn54mD3Gg0NrquXxeLRQAAwzAYj8cwTZPwPH9/sVg8PXweDAauqqr2cDjEer1GJBLBZDJBs9mE4zjwfZ85lAGg2+06hmGgXq+j3+/DsixYlgVN03a9Xu8jgCNCyIegIAgx13Vfd7vdu+FweG8YRkjXdWy329+dTgeSJD3ieZ7RNO0VAXAPwDEAO5VKndi2fWrb9jWl9Esul6PZbDY9Go1OZ7PZ9z/lyuD3OozU2wAAAABJRU5ErkJggg==" alt="Mascot Sammy"></a>
</div></footer>
</div>

    <script>
      var canMathML = typeof(MathMLElement) == "function";
      if (!canMathML) {
        var body = document.querySelector("body");
        body.firstElementChild.setAttribute('style', 'opacity: 0;');
        var loading = document.createElement("div");
        loading.setAttribute("id", "mathjax-loading-spinner");
        var message = document.createElement("div");
        message.setAttribute("id", "mathjax-loading-message");
        message.innerText = "Typesetting Equations...";
        body.prepend(loading);
        body.prepend(message);

        var el = document.createElement("script");
        el.src = "https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js";
        document.querySelector("head").appendChild(el);

        window.MathJax = {
          startup: {
            pageReady: () => {
              return MathJax.startup.defaultPageReady().then(() => {
                body.removeChild(loading);
                body.removeChild(message);
                body.firstElementChild.removeAttribute('style');
              }); } } };
      }
    </script>
    <script>
    // Auxiliary function, building the preview feature when
    // an inline citation is clicked
    function clicked_cite(e) {
      e.preventDefault();
      let cite = this.closest('.ltx_cite');
      let next = cite.nextSibling;
      if (next && next.nodeType == Node.ELEMENT_NODE && next.getAttribute('class') == "ar5iv-bibitem-preview") {
        next.remove();
        return; }
      // Before adding a preview modal,
      // cleanup older previews, in case they're still open
      document.querySelectorAll('span.ar5iv-bibitem-preview').forEach(function(node) {
        node.remove();
      })

      // Create the preview
      preview = document.createElement('span');
      preview.setAttribute('class','ar5iv-bibitem-preview');
      let target = document.getElementById(this.getAttribute('href').slice(1));
      target.childNodes.forEach(function (child) {
        preview.append(child.cloneNode(true));
      });
      let close_x = document.createElement('button');
      close_x.setAttribute("aria-label","Close modal for bibliography item preview");
      close_x.textContent = "×";
      close_x.setAttribute('class', 'ar5iv-button-close-preview');
      close_x.setAttribute('onclick','this.parentNode.remove()');
      preview.append(close_x);
      preview.querySelectorAll('.ltx_tag_bibitem').forEach(function(node) {
        node.remove();
      });
      cite.parentNode.insertBefore(preview, cite.nextSibling);
      return;
    }
    // Global Document initialization:
    // - assign the preview feature to all inline citation links
    document.querySelectorAll(".ltx_cite .ltx_ref").forEach(function (link) {
      link.addEventListener("click", clicked_cite);
    });
    </script>
    </body>
</html>
