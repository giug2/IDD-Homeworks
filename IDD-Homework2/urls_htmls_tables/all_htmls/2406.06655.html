<!DOCTYPE html><html lang="en">
<head>
<meta http-equiv="content-type" content="text/html; charset=UTF-8">
<title>[2406.06655] Fed-Sophia: A Communication-Efficient Second-Order Federated Learning Algorithm Identify applicable funding agency here. If none, delete this.</title><meta property="og:description" content="Federated learning is a machine learning approach where multiple devices collaboratively learn with the help of a parameter server by sharing only their local updates. While gradient-based optimization techniques are w…">
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Fed-Sophia: A Communication-Efficient Second-Order Federated Learning Algorithm Identify applicable funding agency here. If none, delete this.">
<meta name="twitter:image:src" content="https://ar5iv.labs.arxiv.org/assets/ar5iv_card.png">
<meta name="twitter:image:alt" content="ar5iv logo">
<meta property="og:title" content="Fed-Sophia: A Communication-Efficient Second-Order Federated Learning Algorithm Identify applicable funding agency here. If none, delete this.">
<meta property="og:site_name" content="ar5iv">
<meta property="og:image" content="https://ar5iv.labs.arxiv.org/assets/ar5iv_card.png">
<meta property="og:type" content="article">
<meta property="og:url" content="https://ar5iv.labs.arxiv.org/html/2406.06655">

<!--Generated on Fri Jul  5 20:59:45 2024 by LaTeXML (version 0.8.8) http://dlmf.nist.gov/LaTeXML/.-->
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="keywords" lang="en" content="
Distributed optimization,  federated learning,  second-order methods,  deep neural networks,  communication efficiency.
">

<script>
  function detectColorScheme(){
    var theme="light";
    var current_theme = localStorage.getItem("ar5iv_theme");
    if(current_theme){
      if(current_theme == "dark"){
        theme = "dark";
      } }
    else if(!window.matchMedia) { return false; }
    else if(window.matchMedia("(prefers-color-scheme: dark)").matches) {
      theme = "dark"; }
    if (theme=="dark") {
      document.documentElement.setAttribute("data-theme", "dark");
    } else {
      document.documentElement.setAttribute("data-theme", "light"); } }

  detectColorScheme();

  function toggleColorScheme(){
    var current_theme = localStorage.getItem("ar5iv_theme");
    if (current_theme) {
      if (current_theme == "light") {
        localStorage.setItem("ar5iv_theme", "dark"); }
      else {
        localStorage.setItem("ar5iv_theme", "light"); } }
    else {
        localStorage.setItem("ar5iv_theme", "dark"); }
    detectColorScheme(); }
</script>
<link media="all" rel="stylesheet" href="/assets/ar5iv-fonts.0.8.0.min.css"><link media="all" rel="stylesheet" href="/assets/ar5iv.0.8.0.min.css"><link media="all" rel="stylesheet" href="/assets/ar5iv-site.0.2.2.css">
</head>
<body>
<div class="ltx_page_main">
<div class="ltx_page_content">
<article class="ltx_document ltx_authors_1line">
<h1 class="ltx_title ltx_title_document">
<span id="id11.id1" class="ltx_text ltx_font_italic">Fed-Sophia</span>: A Communication-Efficient Second-Order Federated Learning Algorithm
<span id="id12.id2" class="ltx_note ltx_role_thanks"><sup class="ltx_note_mark">†</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">†</sup><span class="ltx_note_type">thanks: </span>Identify applicable funding agency here. If none, delete this.</span></span></span>
</h1>
<div class="ltx_authors">
<span class="ltx_creator ltx_role_author">
<span class="ltx_personname">
Ahmed Elbakary<sup id="id13.11.id1" class="ltx_sup"><span id="id13.11.id1.1" class="ltx_text ltx_font_italic">1,2</span></sup>, Chaouki Ben Issaid<sup id="id14.12.id2" class="ltx_sup">1</sup>, Mohammad Shehab<sup id="id15.13.id3" class="ltx_sup">1</sup>, Karim Seddik<sup id="id16.14.id4" class="ltx_sup">2</sup>, Tamer ElBatt<sup id="id17.15.id5" class="ltx_sup"><span id="id17.15.id5.1" class="ltx_text ltx_font_italic">3,4</span></sup>, Mehdi Bennis<sup id="id18.16.id6" class="ltx_sup">1</sup> 
<br class="ltx_break">
</span><span class="ltx_author_notes">
<span class="ltx_contact ltx_role_affiliation"><sup id="id19.17.id1" class="ltx_sup">1</sup>Centre for Wireless Communications (CWC), University of Oulu, Finland
<br class="ltx_break"><sup id="id20.18.id2" class="ltx_sup">2</sup>Department of Electronics and Communications Engineering, American University in Cairo, Egypt
<br class="ltx_break"><sup id="id21.19.id3" class="ltx_sup">3</sup>Department of Computer Science and Engineering, American University in Cairo, Egypt
<br class="ltx_break"><sup id="id22.20.id4" class="ltx_sup">4</sup>Department of Electronics and Communications Engineering, Cairo University, Egypt

</span></span></span>
</div>

<div class="ltx_abstract">
<h6 class="ltx_title ltx_title_abstract">Abstract</h6>
<p id="id23.id1" class="ltx_p">Federated learning is a machine learning approach where multiple devices collaboratively learn with the help of a parameter server by sharing only their local updates. While gradient-based optimization techniques are widely adopted in this domain, the curvature information that second-order methods exhibit is crucial to guide and speed up the convergence. This paper introduces a scalable second-order method, allowing the adoption of curvature information in federated large models. Our method, coined Fed-Sophia, combines a weighted moving average of the gradient with a clipping operation to find the descent direction. In addition to that, a lightweight estimation of the Hessian’s diagonal is used to incorporate the curvature information. Numerical evaluation shows the superiority, robustness, and scalability of the proposed Fed-Sophia scheme compared to first and second-order baselines.</p>
</div>
<div class="ltx_keywords">
<h6 class="ltx_title ltx_title_keywords">Index Terms: </h6>
Distributed optimization, federated learning, second-order methods, deep neural networks, communication efficiency.

</div>
<section id="S1" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">I </span><span id="S1.1.1" class="ltx_text ltx_font_smallcaps">Introduction</span>
</h2>

<div id="S1.p1" class="ltx_para">
<p id="S1.p1.1" class="ltx_p">Recent advances in edge computing have paved the way to enable new machine learning paradigms (ML). One promising paradigm is federated learning (FL) <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib1" title="" class="ltx_ref">1</a>]</cite>,<cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib2" title="" class="ltx_ref">2</a>]</cite>, where devices preserve their local data and only share, with a parameter server (PS), their local models. Privacy preservation and data locality are two major benefits of FL, in contrast to traditional centralized ML models, which require the entire dataset to be stored in a central cloud. On the contrary, FL relies on a two-stage approach. First, each device performs local training independently, using its own local data. After one or more iterations of local training, each device sends its local model or gradient to the PS. Afterward, the models are aggregated using one of the known aggregation schemes in the literature <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib3" title="" class="ltx_ref">3</a>]</cite>. Finally, after aggregation, the PS shares the refined model with all devices for enhanced performance. This process continues in an iterative manner over multiple communication rounds until convergence. The ultimate goal of FL is to reach a consensus and find a global model that solves the task at hand.</p>
</div>
<div id="S1.p2" class="ltx_para">
<p id="S1.p2.1" class="ltx_p">When using first-order methods, clients employ the gradient to find a descent direction that could guide the convergence. Meanwhile, the default second-order optimization technique is Newton’s method, which requires computing the full Hessian and using it as a pre-conditioner for the gradient. In our work, instead of computing the full Hessian as in Newton’s method, which comes with a heavy computational cost, we rely on an estimation of the Hessian’s diagonal to incorporate the curvature information across each dimension into the convergence process. One problem stemming from Newton’s method is that it might converge to a saddle point instead of a local minimum. Another issue with Hessian-based methods is that the Hessian entries might mislead the convergence process by capturing non-accurate curvature information due to sudden changes in the loss function’s curvature<cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib4" title="" class="ltx_ref">4</a>]</cite>. To mitigate these problems, a clipping operation is introduced to guard against non-positive entries of the Hessian.</p>
</div>
<div id="S1.p3" class="ltx_para">
<p id="S1.p3.1" class="ltx_p">The main contributions of this paper can be summarized as follows</p>
<ul id="S1.I1" class="ltx_itemize">
<li id="S1.I1.i1" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="S1.I1.i1.p1" class="ltx_para">
<p id="S1.I1.i1.p1.1" class="ltx_p">We propose Federated Sophia (Fed-Sophia), a scalable second-order method that enables large models to make use of the curvature information of the loss function. In addition to that, Fed-Sophia can handle heterogeneous settings where the data distribution differs among devices.</p>
</div>
</li>
<li id="S1.I1.i2" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="S1.I1.i2.p1" class="ltx_para">
<p id="S1.I1.i2.p1.1" class="ltx_p">The proposed method uses a lightweight estimation of the Hessian and only shares the model’s parameter vector, making it computation and communication-efficient.</p>
</div>
</li>
<li id="S1.I1.i3" class="ltx_item" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span> 
<div id="S1.I1.i3.p1" class="ltx_para">
<p id="S1.I1.i3.p1.1" class="ltx_p">Several numerical experiments are conducted to show that Fed-Sophia outperforms other baselines for solving an image classification task using convolutional neural network (CNN) or multi-layer perception (MLP) models. Furthermore, we compare the energy consumption and the carbon footprint of Fed-Sophia to other baselines.</p>
</div>
</li>
</ul>
<p id="S1.p3.2" class="ltx_p">The rest of this paper is organized as follows. We highlight some of the available methods in Section <a href="#S2" title="II Related work ‣ Fed-Sophia: A Communication-Efficient Second-Order Federated Learning Algorithm Identify applicable funding agency here. If none, delete this." class="ltx_ref"><span class="ltx_text ltx_ref_tag">II</span></a>. In Section <a href="#S3" title="III System Model and Problem Formulation ‣ Fed-Sophia: A Communication-Efficient Second-Order Federated Learning Algorithm Identify applicable funding agency here. If none, delete this." class="ltx_ref"><span class="ltx_text ltx_ref_tag">III</span></a>, the problem formulation and the system model are introduced. We introduce our proposed method in Section <a href="#S4" title="IV Proposed Algorithm ‣ Fed-Sophia: A Communication-Efficient Second-Order Federated Learning Algorithm Identify applicable funding agency here. If none, delete this." class="ltx_ref"><span class="ltx_text ltx_ref_tag">IV</span></a>. The details of our experimental results are laid out in Section <a href="#S5" title="V Numerical Results ‣ Fed-Sophia: A Communication-Efficient Second-Order Federated Learning Algorithm Identify applicable funding agency here. If none, delete this." class="ltx_ref"><span class="ltx_text ltx_ref_tag">V</span></a>, where the proposed method is compared to other baselines.</p>
</div>
</section>
<section id="S2" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">II </span><span id="S2.1.1" class="ltx_text ltx_font_smallcaps">Related work</span>
</h2>

<div id="S2.p1" class="ltx_para">
<p id="S2.p1.1" class="ltx_p">In what follows, we highlight some differences between first and second-order methods and motivate the need for scalable optimizers in the FL setting.</p>
</div>
<section id="S2.SS1" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection"><span id="S2.SS1.4.1.1" class="ltx_text">II-A</span> </span><span id="S2.SS1.5.2" class="ltx_text ltx_font_italic">First-order FL Methods</span>
</h3>

<div id="S2.SS1.p1" class="ltx_para">
<p id="S2.SS1.p1.1" class="ltx_p">Federated averaging (FedAvg) introduced a generalization of stochastic gradient descent (SGD). The underlying idea is to have every device run several local updates before sending the local model parameters to the PS. The server then averages the local models’ parameters and sends back the refined, global model parameters. In <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib5" title="" class="ltx_ref">5</a>]</cite>, the authors proposed a federated version of a set of popular centralized optimization methods like AdaGrad<cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib6" title="" class="ltx_ref">6</a>]</cite> and Adam<cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib7" title="" class="ltx_ref">7</a>]</cite>, using the same two-stage approach employed in FedAvg. To handle data heterogeneity, Scaffold <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib8" title="" class="ltx_ref">8</a>]</cite> used variance reduction to overcome the drift in local updates at each device. In <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib9" title="" class="ltx_ref">9</a>]</cite>, the authors reduced the communication overhead and the data heterogeneity using both compression and gradient tracking. The fundamental problem with first-order methods is their inability to capture the curvature information of the loss landscape, which leads to a uniform step size across all dimensions of the loss function.</p>
</div>
</section>
<section id="S2.SS2" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection"><span id="S2.SS2.4.1.1" class="ltx_text">II-B</span> </span><span id="S2.SS2.5.2" class="ltx_text ltx_font_italic">Second-order FL Methods</span>
</h3>

<div id="S2.SS2.p1" class="ltx_para">
<p id="S2.SS2.p1.1" class="ltx_p">Second-order methods have the advantage of capturing the effect of the curvature information of the loss function in the training process. FedNL <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib10" title="" class="ltx_ref">10</a>]</cite> is the first framework for using Newton’s method in FL settings. The paper introduced compression techniques to improve communication efficiency between the PS and the devices. Still, the problem of computing the full Hessian at each device persists, making the idea impractical for large models. FedNew <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib11" title="" class="ltx_ref">11</a>]</cite> added another layer of privacy by hiding the gradient information. It also proposed stochastic quantization as a solution for the problem of communicating the Hessian with the PS while still approximating the inverse-Hessian-gradient product. FLECS<cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib12" title="" class="ltx_ref">12</a>]</cite> proposed a framework for second-order methods, utilizing a lower dimensional representation of the Hessian to make the computation lightweight. A major bottleneck in this idea is that the server has to save the full Hessian. Meanwhile, DONE <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib13" title="" class="ltx_ref">13</a>]</cite> uses an approximate Newton-type method and employs Richardson’s iteration to find an approximation for the search direction at each client. Furthermore, DONE requires a large number of local iterations to converge, making it unreliable for practical settings.</p>
</div>
</section>
<section id="S2.SS3" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection"><span id="S2.SS3.4.1.1" class="ltx_text">II-C</span> </span><span id="S2.SS3.5.2" class="ltx_text ltx_font_italic">Optimizers in Deep Learning</span>
</h3>

<div id="S2.SS3.p1" class="ltx_para">
<p id="S2.SS3.p1.1" class="ltx_p">The choice of an optimizer in deep learning is often a task-dependent case. For example, SGD has dominated the computer vision field, while Adam<cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib7" title="" class="ltx_ref">7</a>]</cite> excels in transformers-based language models. On the other hand, second-order methods are not widely adopted in training deep neural networks (DNN). One attempt to apply second-order methods is AdaHessian<cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib14" title="" class="ltx_ref">14</a>]</cite>, a second-order method that estimates the Hessian’s diagonal using Hutchinson’s method<cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib15" title="" class="ltx_ref">15</a>]</cite> with a spatial averaging mechanism to control misleading Hessian entries. In <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib16" title="" class="ltx_ref">16</a>]</cite>, the authors proposed Sophia, a second-order optimizer that exploits a lightweight estimation for the diagonal of the Hessian to incorporate curvature information into the optimization process. Originally introduced as an optimizer for large language models (LLMs), one advantage of Sophia is that it does not estimate the diagonal of the Hessian in each iteration, a key feature that can be well leveraged in FL settings.</p>
</div>
</section>
</section>
<section id="S3" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">III </span><span id="S3.1.1" class="ltx_text ltx_font_smallcaps">System Model and Problem Formulation</span>
</h2>

<div id="S3.p1" class="ltx_para">
<p id="S3.p1.7" class="ltx_p">Consider a network of <math id="S3.p1.1.m1.1" class="ltx_Math" alttext="N" display="inline"><semantics id="S3.p1.1.m1.1a"><mi id="S3.p1.1.m1.1.1" xref="S3.p1.1.m1.1.1.cmml">N</mi><annotation-xml encoding="MathML-Content" id="S3.p1.1.m1.1b"><ci id="S3.p1.1.m1.1.1.cmml" xref="S3.p1.1.m1.1.1">𝑁</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.p1.1.m1.1c">N</annotation></semantics></math> devices and a PS, where each device can communicate with the PS only. Each device has its local data set <math id="S3.p1.2.m2.2" class="ltx_Math" alttext="\mathcal{D}_{i}(\bm{X},\bm{y})" display="inline"><semantics id="S3.p1.2.m2.2a"><mrow id="S3.p1.2.m2.2.3" xref="S3.p1.2.m2.2.3.cmml"><msub id="S3.p1.2.m2.2.3.2" xref="S3.p1.2.m2.2.3.2.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.p1.2.m2.2.3.2.2" xref="S3.p1.2.m2.2.3.2.2.cmml">𝒟</mi><mi id="S3.p1.2.m2.2.3.2.3" xref="S3.p1.2.m2.2.3.2.3.cmml">i</mi></msub><mo lspace="0em" rspace="0em" id="S3.p1.2.m2.2.3.1" xref="S3.p1.2.m2.2.3.1.cmml">​</mo><mrow id="S3.p1.2.m2.2.3.3.2" xref="S3.p1.2.m2.2.3.3.1.cmml"><mo stretchy="false" id="S3.p1.2.m2.2.3.3.2.1" xref="S3.p1.2.m2.2.3.3.1.cmml">(</mo><mi id="S3.p1.2.m2.1.1" xref="S3.p1.2.m2.1.1.cmml">𝑿</mi><mo id="S3.p1.2.m2.2.3.3.2.2" xref="S3.p1.2.m2.2.3.3.1.cmml">,</mo><mi id="S3.p1.2.m2.2.2" xref="S3.p1.2.m2.2.2.cmml">𝒚</mi><mo stretchy="false" id="S3.p1.2.m2.2.3.3.2.3" xref="S3.p1.2.m2.2.3.3.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.p1.2.m2.2b"><apply id="S3.p1.2.m2.2.3.cmml" xref="S3.p1.2.m2.2.3"><times id="S3.p1.2.m2.2.3.1.cmml" xref="S3.p1.2.m2.2.3.1"></times><apply id="S3.p1.2.m2.2.3.2.cmml" xref="S3.p1.2.m2.2.3.2"><csymbol cd="ambiguous" id="S3.p1.2.m2.2.3.2.1.cmml" xref="S3.p1.2.m2.2.3.2">subscript</csymbol><ci id="S3.p1.2.m2.2.3.2.2.cmml" xref="S3.p1.2.m2.2.3.2.2">𝒟</ci><ci id="S3.p1.2.m2.2.3.2.3.cmml" xref="S3.p1.2.m2.2.3.2.3">𝑖</ci></apply><interval closure="open" id="S3.p1.2.m2.2.3.3.1.cmml" xref="S3.p1.2.m2.2.3.3.2"><ci id="S3.p1.2.m2.1.1.cmml" xref="S3.p1.2.m2.1.1">𝑿</ci><ci id="S3.p1.2.m2.2.2.cmml" xref="S3.p1.2.m2.2.2">𝒚</ci></interval></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p1.2.m2.2c">\mathcal{D}_{i}(\bm{X},\bm{y})</annotation></semantics></math> and loss function <math id="S3.p1.3.m3.1" class="ltx_Math" alttext="f_{i}(\bm{\theta}):\mathbb{R}^{d}\xrightarrow{}\mathbb{R}" display="inline"><semantics id="S3.p1.3.m3.1a"><mrow id="S3.p1.3.m3.1.2" xref="S3.p1.3.m3.1.2.cmml"><mrow id="S3.p1.3.m3.1.2.2" xref="S3.p1.3.m3.1.2.2.cmml"><msub id="S3.p1.3.m3.1.2.2.2" xref="S3.p1.3.m3.1.2.2.2.cmml"><mi id="S3.p1.3.m3.1.2.2.2.2" xref="S3.p1.3.m3.1.2.2.2.2.cmml">f</mi><mi id="S3.p1.3.m3.1.2.2.2.3" xref="S3.p1.3.m3.1.2.2.2.3.cmml">i</mi></msub><mo lspace="0em" rspace="0em" id="S3.p1.3.m3.1.2.2.1" xref="S3.p1.3.m3.1.2.2.1.cmml">​</mo><mrow id="S3.p1.3.m3.1.2.2.3.2" xref="S3.p1.3.m3.1.2.2.cmml"><mo stretchy="false" id="S3.p1.3.m3.1.2.2.3.2.1" xref="S3.p1.3.m3.1.2.2.cmml">(</mo><mi id="S3.p1.3.m3.1.1" xref="S3.p1.3.m3.1.1.cmml">𝜽</mi><mo rspace="0.278em" stretchy="false" id="S3.p1.3.m3.1.2.2.3.2.2" xref="S3.p1.3.m3.1.2.2.cmml">)</mo></mrow></mrow><mo rspace="0.278em" id="S3.p1.3.m3.1.2.1" xref="S3.p1.3.m3.1.2.1.cmml">:</mo><mrow id="S3.p1.3.m3.1.2.3" xref="S3.p1.3.m3.1.2.3.cmml"><msup id="S3.p1.3.m3.1.2.3.2" xref="S3.p1.3.m3.1.2.3.2.cmml"><mi id="S3.p1.3.m3.1.2.3.2.2" xref="S3.p1.3.m3.1.2.3.2.2.cmml">ℝ</mi><mi id="S3.p1.3.m3.1.2.3.2.3" xref="S3.p1.3.m3.1.2.3.2.3.cmml">d</mi></msup><mover accent="true" id="S3.p1.3.m3.1.2.3.1" xref="S3.p1.3.m3.1.2.3.1.cmml"><mo stretchy="false" id="S3.p1.3.m3.1.2.3.1.2" xref="S3.p1.3.m3.1.2.3.1.2.cmml">→</mo><mi id="S3.p1.3.m3.1.2.3.1.1" xref="S3.p1.3.m3.1.2.3.1.1.cmml"></mi></mover><mi id="S3.p1.3.m3.1.2.3.3" xref="S3.p1.3.m3.1.2.3.3.cmml">ℝ</mi></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.p1.3.m3.1b"><apply id="S3.p1.3.m3.1.2.cmml" xref="S3.p1.3.m3.1.2"><ci id="S3.p1.3.m3.1.2.1.cmml" xref="S3.p1.3.m3.1.2.1">:</ci><apply id="S3.p1.3.m3.1.2.2.cmml" xref="S3.p1.3.m3.1.2.2"><times id="S3.p1.3.m3.1.2.2.1.cmml" xref="S3.p1.3.m3.1.2.2.1"></times><apply id="S3.p1.3.m3.1.2.2.2.cmml" xref="S3.p1.3.m3.1.2.2.2"><csymbol cd="ambiguous" id="S3.p1.3.m3.1.2.2.2.1.cmml" xref="S3.p1.3.m3.1.2.2.2">subscript</csymbol><ci id="S3.p1.3.m3.1.2.2.2.2.cmml" xref="S3.p1.3.m3.1.2.2.2.2">𝑓</ci><ci id="S3.p1.3.m3.1.2.2.2.3.cmml" xref="S3.p1.3.m3.1.2.2.2.3">𝑖</ci></apply><ci id="S3.p1.3.m3.1.1.cmml" xref="S3.p1.3.m3.1.1">𝜽</ci></apply><apply id="S3.p1.3.m3.1.2.3.cmml" xref="S3.p1.3.m3.1.2.3"><apply id="S3.p1.3.m3.1.2.3.1.cmml" xref="S3.p1.3.m3.1.2.3.1"><csymbol cd="latexml" id="S3.p1.3.m3.1.2.3.1.1.cmml" xref="S3.p1.3.m3.1.2.3.1.1">absent</csymbol><ci id="S3.p1.3.m3.1.2.3.1.2.cmml" xref="S3.p1.3.m3.1.2.3.1.2">→</ci></apply><apply id="S3.p1.3.m3.1.2.3.2.cmml" xref="S3.p1.3.m3.1.2.3.2"><csymbol cd="ambiguous" id="S3.p1.3.m3.1.2.3.2.1.cmml" xref="S3.p1.3.m3.1.2.3.2">superscript</csymbol><ci id="S3.p1.3.m3.1.2.3.2.2.cmml" xref="S3.p1.3.m3.1.2.3.2.2">ℝ</ci><ci id="S3.p1.3.m3.1.2.3.2.3.cmml" xref="S3.p1.3.m3.1.2.3.2.3">𝑑</ci></apply><ci id="S3.p1.3.m3.1.2.3.3.cmml" xref="S3.p1.3.m3.1.2.3.3">ℝ</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p1.3.m3.1c">f_{i}(\bm{\theta}):\mathbb{R}^{d}\xrightarrow{}\mathbb{R}</annotation></semantics></math>, where <math id="S3.p1.4.m4.1" class="ltx_Math" alttext="\bm{X}" display="inline"><semantics id="S3.p1.4.m4.1a"><mi id="S3.p1.4.m4.1.1" xref="S3.p1.4.m4.1.1.cmml">𝑿</mi><annotation-xml encoding="MathML-Content" id="S3.p1.4.m4.1b"><ci id="S3.p1.4.m4.1.1.cmml" xref="S3.p1.4.m4.1.1">𝑿</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.p1.4.m4.1c">\bm{X}</annotation></semantics></math> is the features matrix, <math id="S3.p1.5.m5.1" class="ltx_Math" alttext="\bm{y}" display="inline"><semantics id="S3.p1.5.m5.1a"><mi id="S3.p1.5.m5.1.1" xref="S3.p1.5.m5.1.1.cmml">𝒚</mi><annotation-xml encoding="MathML-Content" id="S3.p1.5.m5.1b"><ci id="S3.p1.5.m5.1.1.cmml" xref="S3.p1.5.m5.1.1">𝒚</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.p1.5.m5.1c">\bm{y}</annotation></semantics></math> is the label vector, and <math id="S3.p1.6.m6.1" class="ltx_Math" alttext="\bm{\theta}" display="inline"><semantics id="S3.p1.6.m6.1a"><mi id="S3.p1.6.m6.1.1" xref="S3.p1.6.m6.1.1.cmml">𝜽</mi><annotation-xml encoding="MathML-Content" id="S3.p1.6.m6.1b"><ci id="S3.p1.6.m6.1.1.cmml" xref="S3.p1.6.m6.1.1">𝜽</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.p1.6.m6.1c">\bm{\theta}</annotation></semantics></math> is the ML model we aim to train, e.g., the weights and biases of a NN. Devices train a local model <math id="S3.p1.7.m7.1" class="ltx_Math" alttext="\bm{\theta}_{i}\in\mathbb{R}^{d}" display="inline"><semantics id="S3.p1.7.m7.1a"><mrow id="S3.p1.7.m7.1.1" xref="S3.p1.7.m7.1.1.cmml"><msub id="S3.p1.7.m7.1.1.2" xref="S3.p1.7.m7.1.1.2.cmml"><mi id="S3.p1.7.m7.1.1.2.2" xref="S3.p1.7.m7.1.1.2.2.cmml">𝜽</mi><mi id="S3.p1.7.m7.1.1.2.3" xref="S3.p1.7.m7.1.1.2.3.cmml">i</mi></msub><mo id="S3.p1.7.m7.1.1.1" xref="S3.p1.7.m7.1.1.1.cmml">∈</mo><msup id="S3.p1.7.m7.1.1.3" xref="S3.p1.7.m7.1.1.3.cmml"><mi id="S3.p1.7.m7.1.1.3.2" xref="S3.p1.7.m7.1.1.3.2.cmml">ℝ</mi><mi id="S3.p1.7.m7.1.1.3.3" xref="S3.p1.7.m7.1.1.3.3.cmml">d</mi></msup></mrow><annotation-xml encoding="MathML-Content" id="S3.p1.7.m7.1b"><apply id="S3.p1.7.m7.1.1.cmml" xref="S3.p1.7.m7.1.1"><in id="S3.p1.7.m7.1.1.1.cmml" xref="S3.p1.7.m7.1.1.1"></in><apply id="S3.p1.7.m7.1.1.2.cmml" xref="S3.p1.7.m7.1.1.2"><csymbol cd="ambiguous" id="S3.p1.7.m7.1.1.2.1.cmml" xref="S3.p1.7.m7.1.1.2">subscript</csymbol><ci id="S3.p1.7.m7.1.1.2.2.cmml" xref="S3.p1.7.m7.1.1.2.2">𝜽</ci><ci id="S3.p1.7.m7.1.1.2.3.cmml" xref="S3.p1.7.m7.1.1.2.3">𝑖</ci></apply><apply id="S3.p1.7.m7.1.1.3.cmml" xref="S3.p1.7.m7.1.1.3"><csymbol cd="ambiguous" id="S3.p1.7.m7.1.1.3.1.cmml" xref="S3.p1.7.m7.1.1.3">superscript</csymbol><ci id="S3.p1.7.m7.1.1.3.2.cmml" xref="S3.p1.7.m7.1.1.3.2">ℝ</ci><ci id="S3.p1.7.m7.1.1.3.3.cmml" xref="S3.p1.7.m7.1.1.3.3">𝑑</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p1.7.m7.1c">\bm{\theta}_{i}\in\mathbb{R}^{d}</annotation></semantics></math> and send the trained model to the PS. The server can aggregate the information sent from the devices using some aggregation scheme to guide the convergence process. After aggregation, the server sends back the updated information to all clients, which starts another round of local training. This process continues until convergence. The objective of the training process is to perform empirical risk minimization in the form</p>
<table id="Sx1.EGx1" class="ltx_equationgroup ltx_eqn_align ltx_eqn_table">

<tbody id="S3.E1"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math id="S3.E1.m1.3" class="ltx_Math" alttext="\displaystyle\min_{\bm{\theta}\in\mathbb{R}^{d}}{f(\bm{\theta})\triangleq\frac{1}{N}\sum_{i=1}^{N}f_{i}(\bm{\theta})}." display="inline"><semantics id="S3.E1.m1.3a"><mrow id="S3.E1.m1.3.3.1" xref="S3.E1.m1.3.3.1.1.cmml"><mrow id="S3.E1.m1.3.3.1.1" xref="S3.E1.m1.3.3.1.1.cmml"><mrow id="S3.E1.m1.3.3.1.1.2" xref="S3.E1.m1.3.3.1.1.2.cmml"><mrow id="S3.E1.m1.3.3.1.1.2.2" xref="S3.E1.m1.3.3.1.1.2.2.cmml"><munder id="S3.E1.m1.3.3.1.1.2.2.1" xref="S3.E1.m1.3.3.1.1.2.2.1.cmml"><mi id="S3.E1.m1.3.3.1.1.2.2.1.2" xref="S3.E1.m1.3.3.1.1.2.2.1.2.cmml">min</mi><mrow id="S3.E1.m1.3.3.1.1.2.2.1.3" xref="S3.E1.m1.3.3.1.1.2.2.1.3.cmml"><mi id="S3.E1.m1.3.3.1.1.2.2.1.3.2" xref="S3.E1.m1.3.3.1.1.2.2.1.3.2.cmml">𝜽</mi><mo id="S3.E1.m1.3.3.1.1.2.2.1.3.1" xref="S3.E1.m1.3.3.1.1.2.2.1.3.1.cmml">∈</mo><msup id="S3.E1.m1.3.3.1.1.2.2.1.3.3" xref="S3.E1.m1.3.3.1.1.2.2.1.3.3.cmml"><mi id="S3.E1.m1.3.3.1.1.2.2.1.3.3.2" xref="S3.E1.m1.3.3.1.1.2.2.1.3.3.2.cmml">ℝ</mi><mi id="S3.E1.m1.3.3.1.1.2.2.1.3.3.3" xref="S3.E1.m1.3.3.1.1.2.2.1.3.3.3.cmml">d</mi></msup></mrow></munder><mo lspace="0.167em" id="S3.E1.m1.3.3.1.1.2.2a" xref="S3.E1.m1.3.3.1.1.2.2.cmml">⁡</mo><mi id="S3.E1.m1.3.3.1.1.2.2.2" xref="S3.E1.m1.3.3.1.1.2.2.2.cmml">f</mi></mrow><mo lspace="0em" rspace="0em" id="S3.E1.m1.3.3.1.1.2.1" xref="S3.E1.m1.3.3.1.1.2.1.cmml">​</mo><mrow id="S3.E1.m1.3.3.1.1.2.3.2" xref="S3.E1.m1.3.3.1.1.2.cmml"><mo stretchy="false" id="S3.E1.m1.3.3.1.1.2.3.2.1" xref="S3.E1.m1.3.3.1.1.2.cmml">(</mo><mi id="S3.E1.m1.1.1" xref="S3.E1.m1.1.1.cmml">𝜽</mi><mo stretchy="false" id="S3.E1.m1.3.3.1.1.2.3.2.2" xref="S3.E1.m1.3.3.1.1.2.cmml">)</mo></mrow></mrow><mo id="S3.E1.m1.3.3.1.1.1" xref="S3.E1.m1.3.3.1.1.1.cmml">≜</mo><mrow id="S3.E1.m1.3.3.1.1.3" xref="S3.E1.m1.3.3.1.1.3.cmml"><mstyle displaystyle="true" id="S3.E1.m1.3.3.1.1.3.2" xref="S3.E1.m1.3.3.1.1.3.2.cmml"><mfrac id="S3.E1.m1.3.3.1.1.3.2a" xref="S3.E1.m1.3.3.1.1.3.2.cmml"><mn id="S3.E1.m1.3.3.1.1.3.2.2" xref="S3.E1.m1.3.3.1.1.3.2.2.cmml">1</mn><mi id="S3.E1.m1.3.3.1.1.3.2.3" xref="S3.E1.m1.3.3.1.1.3.2.3.cmml">N</mi></mfrac></mstyle><mo lspace="0em" rspace="0em" id="S3.E1.m1.3.3.1.1.3.1" xref="S3.E1.m1.3.3.1.1.3.1.cmml">​</mo><mrow id="S3.E1.m1.3.3.1.1.3.3" xref="S3.E1.m1.3.3.1.1.3.3.cmml"><mstyle displaystyle="true" id="S3.E1.m1.3.3.1.1.3.3.1" xref="S3.E1.m1.3.3.1.1.3.3.1.cmml"><munderover id="S3.E1.m1.3.3.1.1.3.3.1a" xref="S3.E1.m1.3.3.1.1.3.3.1.cmml"><mo movablelimits="false" id="S3.E1.m1.3.3.1.1.3.3.1.2.2" xref="S3.E1.m1.3.3.1.1.3.3.1.2.2.cmml">∑</mo><mrow id="S3.E1.m1.3.3.1.1.3.3.1.2.3" xref="S3.E1.m1.3.3.1.1.3.3.1.2.3.cmml"><mi id="S3.E1.m1.3.3.1.1.3.3.1.2.3.2" xref="S3.E1.m1.3.3.1.1.3.3.1.2.3.2.cmml">i</mi><mo id="S3.E1.m1.3.3.1.1.3.3.1.2.3.1" xref="S3.E1.m1.3.3.1.1.3.3.1.2.3.1.cmml">=</mo><mn id="S3.E1.m1.3.3.1.1.3.3.1.2.3.3" xref="S3.E1.m1.3.3.1.1.3.3.1.2.3.3.cmml">1</mn></mrow><mi id="S3.E1.m1.3.3.1.1.3.3.1.3" xref="S3.E1.m1.3.3.1.1.3.3.1.3.cmml">N</mi></munderover></mstyle><mrow id="S3.E1.m1.3.3.1.1.3.3.2" xref="S3.E1.m1.3.3.1.1.3.3.2.cmml"><msub id="S3.E1.m1.3.3.1.1.3.3.2.2" xref="S3.E1.m1.3.3.1.1.3.3.2.2.cmml"><mi id="S3.E1.m1.3.3.1.1.3.3.2.2.2" xref="S3.E1.m1.3.3.1.1.3.3.2.2.2.cmml">f</mi><mi id="S3.E1.m1.3.3.1.1.3.3.2.2.3" xref="S3.E1.m1.3.3.1.1.3.3.2.2.3.cmml">i</mi></msub><mo lspace="0em" rspace="0em" id="S3.E1.m1.3.3.1.1.3.3.2.1" xref="S3.E1.m1.3.3.1.1.3.3.2.1.cmml">​</mo><mrow id="S3.E1.m1.3.3.1.1.3.3.2.3.2" xref="S3.E1.m1.3.3.1.1.3.3.2.cmml"><mo stretchy="false" id="S3.E1.m1.3.3.1.1.3.3.2.3.2.1" xref="S3.E1.m1.3.3.1.1.3.3.2.cmml">(</mo><mi id="S3.E1.m1.2.2" xref="S3.E1.m1.2.2.cmml">𝜽</mi><mo stretchy="false" id="S3.E1.m1.3.3.1.1.3.3.2.3.2.2" xref="S3.E1.m1.3.3.1.1.3.3.2.cmml">)</mo></mrow></mrow></mrow></mrow></mrow><mo lspace="0em" id="S3.E1.m1.3.3.1.2" xref="S3.E1.m1.3.3.1.1.cmml">.</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E1.m1.3b"><apply id="S3.E1.m1.3.3.1.1.cmml" xref="S3.E1.m1.3.3.1"><ci id="S3.E1.m1.3.3.1.1.1.cmml" xref="S3.E1.m1.3.3.1.1.1">≜</ci><apply id="S3.E1.m1.3.3.1.1.2.cmml" xref="S3.E1.m1.3.3.1.1.2"><times id="S3.E1.m1.3.3.1.1.2.1.cmml" xref="S3.E1.m1.3.3.1.1.2.1"></times><apply id="S3.E1.m1.3.3.1.1.2.2.cmml" xref="S3.E1.m1.3.3.1.1.2.2"><apply id="S3.E1.m1.3.3.1.1.2.2.1.cmml" xref="S3.E1.m1.3.3.1.1.2.2.1"><csymbol cd="ambiguous" id="S3.E1.m1.3.3.1.1.2.2.1.1.cmml" xref="S3.E1.m1.3.3.1.1.2.2.1">subscript</csymbol><min id="S3.E1.m1.3.3.1.1.2.2.1.2.cmml" xref="S3.E1.m1.3.3.1.1.2.2.1.2"></min><apply id="S3.E1.m1.3.3.1.1.2.2.1.3.cmml" xref="S3.E1.m1.3.3.1.1.2.2.1.3"><in id="S3.E1.m1.3.3.1.1.2.2.1.3.1.cmml" xref="S3.E1.m1.3.3.1.1.2.2.1.3.1"></in><ci id="S3.E1.m1.3.3.1.1.2.2.1.3.2.cmml" xref="S3.E1.m1.3.3.1.1.2.2.1.3.2">𝜽</ci><apply id="S3.E1.m1.3.3.1.1.2.2.1.3.3.cmml" xref="S3.E1.m1.3.3.1.1.2.2.1.3.3"><csymbol cd="ambiguous" id="S3.E1.m1.3.3.1.1.2.2.1.3.3.1.cmml" xref="S3.E1.m1.3.3.1.1.2.2.1.3.3">superscript</csymbol><ci id="S3.E1.m1.3.3.1.1.2.2.1.3.3.2.cmml" xref="S3.E1.m1.3.3.1.1.2.2.1.3.3.2">ℝ</ci><ci id="S3.E1.m1.3.3.1.1.2.2.1.3.3.3.cmml" xref="S3.E1.m1.3.3.1.1.2.2.1.3.3.3">𝑑</ci></apply></apply></apply><ci id="S3.E1.m1.3.3.1.1.2.2.2.cmml" xref="S3.E1.m1.3.3.1.1.2.2.2">𝑓</ci></apply><ci id="S3.E1.m1.1.1.cmml" xref="S3.E1.m1.1.1">𝜽</ci></apply><apply id="S3.E1.m1.3.3.1.1.3.cmml" xref="S3.E1.m1.3.3.1.1.3"><times id="S3.E1.m1.3.3.1.1.3.1.cmml" xref="S3.E1.m1.3.3.1.1.3.1"></times><apply id="S3.E1.m1.3.3.1.1.3.2.cmml" xref="S3.E1.m1.3.3.1.1.3.2"><divide id="S3.E1.m1.3.3.1.1.3.2.1.cmml" xref="S3.E1.m1.3.3.1.1.3.2"></divide><cn type="integer" id="S3.E1.m1.3.3.1.1.3.2.2.cmml" xref="S3.E1.m1.3.3.1.1.3.2.2">1</cn><ci id="S3.E1.m1.3.3.1.1.3.2.3.cmml" xref="S3.E1.m1.3.3.1.1.3.2.3">𝑁</ci></apply><apply id="S3.E1.m1.3.3.1.1.3.3.cmml" xref="S3.E1.m1.3.3.1.1.3.3"><apply id="S3.E1.m1.3.3.1.1.3.3.1.cmml" xref="S3.E1.m1.3.3.1.1.3.3.1"><csymbol cd="ambiguous" id="S3.E1.m1.3.3.1.1.3.3.1.1.cmml" xref="S3.E1.m1.3.3.1.1.3.3.1">superscript</csymbol><apply id="S3.E1.m1.3.3.1.1.3.3.1.2.cmml" xref="S3.E1.m1.3.3.1.1.3.3.1"><csymbol cd="ambiguous" id="S3.E1.m1.3.3.1.1.3.3.1.2.1.cmml" xref="S3.E1.m1.3.3.1.1.3.3.1">subscript</csymbol><sum id="S3.E1.m1.3.3.1.1.3.3.1.2.2.cmml" xref="S3.E1.m1.3.3.1.1.3.3.1.2.2"></sum><apply id="S3.E1.m1.3.3.1.1.3.3.1.2.3.cmml" xref="S3.E1.m1.3.3.1.1.3.3.1.2.3"><eq id="S3.E1.m1.3.3.1.1.3.3.1.2.3.1.cmml" xref="S3.E1.m1.3.3.1.1.3.3.1.2.3.1"></eq><ci id="S3.E1.m1.3.3.1.1.3.3.1.2.3.2.cmml" xref="S3.E1.m1.3.3.1.1.3.3.1.2.3.2">𝑖</ci><cn type="integer" id="S3.E1.m1.3.3.1.1.3.3.1.2.3.3.cmml" xref="S3.E1.m1.3.3.1.1.3.3.1.2.3.3">1</cn></apply></apply><ci id="S3.E1.m1.3.3.1.1.3.3.1.3.cmml" xref="S3.E1.m1.3.3.1.1.3.3.1.3">𝑁</ci></apply><apply id="S3.E1.m1.3.3.1.1.3.3.2.cmml" xref="S3.E1.m1.3.3.1.1.3.3.2"><times id="S3.E1.m1.3.3.1.1.3.3.2.1.cmml" xref="S3.E1.m1.3.3.1.1.3.3.2.1"></times><apply id="S3.E1.m1.3.3.1.1.3.3.2.2.cmml" xref="S3.E1.m1.3.3.1.1.3.3.2.2"><csymbol cd="ambiguous" id="S3.E1.m1.3.3.1.1.3.3.2.2.1.cmml" xref="S3.E1.m1.3.3.1.1.3.3.2.2">subscript</csymbol><ci id="S3.E1.m1.3.3.1.1.3.3.2.2.2.cmml" xref="S3.E1.m1.3.3.1.1.3.3.2.2.2">𝑓</ci><ci id="S3.E1.m1.3.3.1.1.3.3.2.2.3.cmml" xref="S3.E1.m1.3.3.1.1.3.3.2.2.3">𝑖</ci></apply><ci id="S3.E1.m1.2.2.cmml" xref="S3.E1.m1.2.2">𝜽</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E1.m1.3c">\displaystyle\min_{\bm{\theta}\in\mathbb{R}^{d}}{f(\bm{\theta})\triangleq\frac{1}{N}\sum_{i=1}^{N}f_{i}(\bm{\theta})}.</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(1)</span></td>
</tr></tbody>
</table>
</div>
<div id="S3.p2" class="ltx_para">
<p id="S3.p2.3" class="ltx_p">In the remainder of this paper, let <math id="S3.p2.1.m1.1" class="ltx_Math" alttext="\bm{H}_{i}\triangleq\nabla^{2}f_{i}(\bm{\theta})" display="inline"><semantics id="S3.p2.1.m1.1a"><mrow id="S3.p2.1.m1.1.2" xref="S3.p2.1.m1.1.2.cmml"><msub id="S3.p2.1.m1.1.2.2" xref="S3.p2.1.m1.1.2.2.cmml"><mi id="S3.p2.1.m1.1.2.2.2" xref="S3.p2.1.m1.1.2.2.2.cmml">𝑯</mi><mi id="S3.p2.1.m1.1.2.2.3" xref="S3.p2.1.m1.1.2.2.3.cmml">i</mi></msub><mo id="S3.p2.1.m1.1.2.1" xref="S3.p2.1.m1.1.2.1.cmml">≜</mo><mrow id="S3.p2.1.m1.1.2.3" xref="S3.p2.1.m1.1.2.3.cmml"><mrow id="S3.p2.1.m1.1.2.3.2" xref="S3.p2.1.m1.1.2.3.2.cmml"><msup id="S3.p2.1.m1.1.2.3.2.1" xref="S3.p2.1.m1.1.2.3.2.1.cmml"><mo rspace="0.167em" id="S3.p2.1.m1.1.2.3.2.1.2" xref="S3.p2.1.m1.1.2.3.2.1.2.cmml">∇</mo><mn id="S3.p2.1.m1.1.2.3.2.1.3" xref="S3.p2.1.m1.1.2.3.2.1.3.cmml">2</mn></msup><msub id="S3.p2.1.m1.1.2.3.2.2" xref="S3.p2.1.m1.1.2.3.2.2.cmml"><mi id="S3.p2.1.m1.1.2.3.2.2.2" xref="S3.p2.1.m1.1.2.3.2.2.2.cmml">f</mi><mi id="S3.p2.1.m1.1.2.3.2.2.3" xref="S3.p2.1.m1.1.2.3.2.2.3.cmml">i</mi></msub></mrow><mo lspace="0em" rspace="0em" id="S3.p2.1.m1.1.2.3.1" xref="S3.p2.1.m1.1.2.3.1.cmml">​</mo><mrow id="S3.p2.1.m1.1.2.3.3.2" xref="S3.p2.1.m1.1.2.3.cmml"><mo stretchy="false" id="S3.p2.1.m1.1.2.3.3.2.1" xref="S3.p2.1.m1.1.2.3.cmml">(</mo><mi id="S3.p2.1.m1.1.1" xref="S3.p2.1.m1.1.1.cmml">𝜽</mi><mo stretchy="false" id="S3.p2.1.m1.1.2.3.3.2.2" xref="S3.p2.1.m1.1.2.3.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.p2.1.m1.1b"><apply id="S3.p2.1.m1.1.2.cmml" xref="S3.p2.1.m1.1.2"><ci id="S3.p2.1.m1.1.2.1.cmml" xref="S3.p2.1.m1.1.2.1">≜</ci><apply id="S3.p2.1.m1.1.2.2.cmml" xref="S3.p2.1.m1.1.2.2"><csymbol cd="ambiguous" id="S3.p2.1.m1.1.2.2.1.cmml" xref="S3.p2.1.m1.1.2.2">subscript</csymbol><ci id="S3.p2.1.m1.1.2.2.2.cmml" xref="S3.p2.1.m1.1.2.2.2">𝑯</ci><ci id="S3.p2.1.m1.1.2.2.3.cmml" xref="S3.p2.1.m1.1.2.2.3">𝑖</ci></apply><apply id="S3.p2.1.m1.1.2.3.cmml" xref="S3.p2.1.m1.1.2.3"><times id="S3.p2.1.m1.1.2.3.1.cmml" xref="S3.p2.1.m1.1.2.3.1"></times><apply id="S3.p2.1.m1.1.2.3.2.cmml" xref="S3.p2.1.m1.1.2.3.2"><apply id="S3.p2.1.m1.1.2.3.2.1.cmml" xref="S3.p2.1.m1.1.2.3.2.1"><csymbol cd="ambiguous" id="S3.p2.1.m1.1.2.3.2.1.1.cmml" xref="S3.p2.1.m1.1.2.3.2.1">superscript</csymbol><ci id="S3.p2.1.m1.1.2.3.2.1.2.cmml" xref="S3.p2.1.m1.1.2.3.2.1.2">∇</ci><cn type="integer" id="S3.p2.1.m1.1.2.3.2.1.3.cmml" xref="S3.p2.1.m1.1.2.3.2.1.3">2</cn></apply><apply id="S3.p2.1.m1.1.2.3.2.2.cmml" xref="S3.p2.1.m1.1.2.3.2.2"><csymbol cd="ambiguous" id="S3.p2.1.m1.1.2.3.2.2.1.cmml" xref="S3.p2.1.m1.1.2.3.2.2">subscript</csymbol><ci id="S3.p2.1.m1.1.2.3.2.2.2.cmml" xref="S3.p2.1.m1.1.2.3.2.2.2">𝑓</ci><ci id="S3.p2.1.m1.1.2.3.2.2.3.cmml" xref="S3.p2.1.m1.1.2.3.2.2.3">𝑖</ci></apply></apply><ci id="S3.p2.1.m1.1.1.cmml" xref="S3.p2.1.m1.1.1">𝜽</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p2.1.m1.1c">\bm{H}_{i}\triangleq\nabla^{2}f_{i}(\bm{\theta})</annotation></semantics></math> and <math id="S3.p2.2.m2.1" class="ltx_Math" alttext="\bm{g}_{i}\triangleq\nabla f_{i}(\bm{\theta})" display="inline"><semantics id="S3.p2.2.m2.1a"><mrow id="S3.p2.2.m2.1.2" xref="S3.p2.2.m2.1.2.cmml"><msub id="S3.p2.2.m2.1.2.2" xref="S3.p2.2.m2.1.2.2.cmml"><mi id="S3.p2.2.m2.1.2.2.2" xref="S3.p2.2.m2.1.2.2.2.cmml">𝒈</mi><mi id="S3.p2.2.m2.1.2.2.3" xref="S3.p2.2.m2.1.2.2.3.cmml">i</mi></msub><mo id="S3.p2.2.m2.1.2.1" xref="S3.p2.2.m2.1.2.1.cmml">≜</mo><mrow id="S3.p2.2.m2.1.2.3" xref="S3.p2.2.m2.1.2.3.cmml"><mrow id="S3.p2.2.m2.1.2.3.2" xref="S3.p2.2.m2.1.2.3.2.cmml"><mo rspace="0.167em" id="S3.p2.2.m2.1.2.3.2.1" xref="S3.p2.2.m2.1.2.3.2.1.cmml">∇</mo><msub id="S3.p2.2.m2.1.2.3.2.2" xref="S3.p2.2.m2.1.2.3.2.2.cmml"><mi id="S3.p2.2.m2.1.2.3.2.2.2" xref="S3.p2.2.m2.1.2.3.2.2.2.cmml">f</mi><mi id="S3.p2.2.m2.1.2.3.2.2.3" xref="S3.p2.2.m2.1.2.3.2.2.3.cmml">i</mi></msub></mrow><mo lspace="0em" rspace="0em" id="S3.p2.2.m2.1.2.3.1" xref="S3.p2.2.m2.1.2.3.1.cmml">​</mo><mrow id="S3.p2.2.m2.1.2.3.3.2" xref="S3.p2.2.m2.1.2.3.cmml"><mo stretchy="false" id="S3.p2.2.m2.1.2.3.3.2.1" xref="S3.p2.2.m2.1.2.3.cmml">(</mo><mi id="S3.p2.2.m2.1.1" xref="S3.p2.2.m2.1.1.cmml">𝜽</mi><mo stretchy="false" id="S3.p2.2.m2.1.2.3.3.2.2" xref="S3.p2.2.m2.1.2.3.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.p2.2.m2.1b"><apply id="S3.p2.2.m2.1.2.cmml" xref="S3.p2.2.m2.1.2"><ci id="S3.p2.2.m2.1.2.1.cmml" xref="S3.p2.2.m2.1.2.1">≜</ci><apply id="S3.p2.2.m2.1.2.2.cmml" xref="S3.p2.2.m2.1.2.2"><csymbol cd="ambiguous" id="S3.p2.2.m2.1.2.2.1.cmml" xref="S3.p2.2.m2.1.2.2">subscript</csymbol><ci id="S3.p2.2.m2.1.2.2.2.cmml" xref="S3.p2.2.m2.1.2.2.2">𝒈</ci><ci id="S3.p2.2.m2.1.2.2.3.cmml" xref="S3.p2.2.m2.1.2.2.3">𝑖</ci></apply><apply id="S3.p2.2.m2.1.2.3.cmml" xref="S3.p2.2.m2.1.2.3"><times id="S3.p2.2.m2.1.2.3.1.cmml" xref="S3.p2.2.m2.1.2.3.1"></times><apply id="S3.p2.2.m2.1.2.3.2.cmml" xref="S3.p2.2.m2.1.2.3.2"><ci id="S3.p2.2.m2.1.2.3.2.1.cmml" xref="S3.p2.2.m2.1.2.3.2.1">∇</ci><apply id="S3.p2.2.m2.1.2.3.2.2.cmml" xref="S3.p2.2.m2.1.2.3.2.2"><csymbol cd="ambiguous" id="S3.p2.2.m2.1.2.3.2.2.1.cmml" xref="S3.p2.2.m2.1.2.3.2.2">subscript</csymbol><ci id="S3.p2.2.m2.1.2.3.2.2.2.cmml" xref="S3.p2.2.m2.1.2.3.2.2.2">𝑓</ci><ci id="S3.p2.2.m2.1.2.3.2.2.3.cmml" xref="S3.p2.2.m2.1.2.3.2.2.3">𝑖</ci></apply></apply><ci id="S3.p2.2.m2.1.1.cmml" xref="S3.p2.2.m2.1.1">𝜽</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p2.2.m2.1c">\bm{g}_{i}\triangleq\nabla f_{i}(\bm{\theta})</annotation></semantics></math> denote the Hessian and the gradient of the loss function of the <math id="S3.p2.3.m3.1" class="ltx_Math" alttext="i" display="inline"><semantics id="S3.p2.3.m3.1a"><mi id="S3.p2.3.m3.1.1" xref="S3.p2.3.m3.1.1.cmml">i</mi><annotation-xml encoding="MathML-Content" id="S3.p2.3.m3.1b"><ci id="S3.p2.3.m3.1.1.cmml" xref="S3.p2.3.m3.1.1">𝑖</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.p2.3.m3.1c">i</annotation></semantics></math>th device, respectively. The entries of the Hessian matrix could be divided into two classes: the diagonal elements and the off-diagonal elements. The diagonal elements indicate the curvature information across each dimension. High values for diagonal elements mean steep curvature, which requires smaller steps. Meanwhile, small values reflect a flat dimension, in which case faster steps could be adopted. On the other hand, off-diagonal elements represent the cross-curvature information. To illustrate the effect of the Hessian’s elements, let’s consider the following loss function</p>
<table id="Sx1.EGx2" class="ltx_equationgroup ltx_eqn_align ltx_eqn_table">

<tbody id="S3.E2"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math id="S3.E2.m1.1" class="ltx_Math" alttext="\displaystyle f(\theta_{1},\theta_{2})=\theta_{1}^{2}+2\theta_{1}\theta_{2}+3\theta_{2}^{2}," display="inline"><semantics id="S3.E2.m1.1a"><mrow id="S3.E2.m1.1.1.1" xref="S3.E2.m1.1.1.1.1.cmml"><mrow id="S3.E2.m1.1.1.1.1" xref="S3.E2.m1.1.1.1.1.cmml"><mrow id="S3.E2.m1.1.1.1.1.2" xref="S3.E2.m1.1.1.1.1.2.cmml"><mi id="S3.E2.m1.1.1.1.1.2.4" xref="S3.E2.m1.1.1.1.1.2.4.cmml">f</mi><mo lspace="0em" rspace="0em" id="S3.E2.m1.1.1.1.1.2.3" xref="S3.E2.m1.1.1.1.1.2.3.cmml">​</mo><mrow id="S3.E2.m1.1.1.1.1.2.2.2" xref="S3.E2.m1.1.1.1.1.2.2.3.cmml"><mo stretchy="false" id="S3.E2.m1.1.1.1.1.2.2.2.3" xref="S3.E2.m1.1.1.1.1.2.2.3.cmml">(</mo><msub id="S3.E2.m1.1.1.1.1.1.1.1.1" xref="S3.E2.m1.1.1.1.1.1.1.1.1.cmml"><mi id="S3.E2.m1.1.1.1.1.1.1.1.1.2" xref="S3.E2.m1.1.1.1.1.1.1.1.1.2.cmml">θ</mi><mn id="S3.E2.m1.1.1.1.1.1.1.1.1.3" xref="S3.E2.m1.1.1.1.1.1.1.1.1.3.cmml">1</mn></msub><mo id="S3.E2.m1.1.1.1.1.2.2.2.4" xref="S3.E2.m1.1.1.1.1.2.2.3.cmml">,</mo><msub id="S3.E2.m1.1.1.1.1.2.2.2.2" xref="S3.E2.m1.1.1.1.1.2.2.2.2.cmml"><mi id="S3.E2.m1.1.1.1.1.2.2.2.2.2" xref="S3.E2.m1.1.1.1.1.2.2.2.2.2.cmml">θ</mi><mn id="S3.E2.m1.1.1.1.1.2.2.2.2.3" xref="S3.E2.m1.1.1.1.1.2.2.2.2.3.cmml">2</mn></msub><mo stretchy="false" id="S3.E2.m1.1.1.1.1.2.2.2.5" xref="S3.E2.m1.1.1.1.1.2.2.3.cmml">)</mo></mrow></mrow><mo id="S3.E2.m1.1.1.1.1.3" xref="S3.E2.m1.1.1.1.1.3.cmml">=</mo><mrow id="S3.E2.m1.1.1.1.1.4" xref="S3.E2.m1.1.1.1.1.4.cmml"><msubsup id="S3.E2.m1.1.1.1.1.4.2" xref="S3.E2.m1.1.1.1.1.4.2.cmml"><mi id="S3.E2.m1.1.1.1.1.4.2.2.2" xref="S3.E2.m1.1.1.1.1.4.2.2.2.cmml">θ</mi><mn id="S3.E2.m1.1.1.1.1.4.2.2.3" xref="S3.E2.m1.1.1.1.1.4.2.2.3.cmml">1</mn><mn id="S3.E2.m1.1.1.1.1.4.2.3" xref="S3.E2.m1.1.1.1.1.4.2.3.cmml">2</mn></msubsup><mo id="S3.E2.m1.1.1.1.1.4.1" xref="S3.E2.m1.1.1.1.1.4.1.cmml">+</mo><mrow id="S3.E2.m1.1.1.1.1.4.3" xref="S3.E2.m1.1.1.1.1.4.3.cmml"><mn id="S3.E2.m1.1.1.1.1.4.3.2" xref="S3.E2.m1.1.1.1.1.4.3.2.cmml">2</mn><mo lspace="0em" rspace="0em" id="S3.E2.m1.1.1.1.1.4.3.1" xref="S3.E2.m1.1.1.1.1.4.3.1.cmml">​</mo><msub id="S3.E2.m1.1.1.1.1.4.3.3" xref="S3.E2.m1.1.1.1.1.4.3.3.cmml"><mi id="S3.E2.m1.1.1.1.1.4.3.3.2" xref="S3.E2.m1.1.1.1.1.4.3.3.2.cmml">θ</mi><mn id="S3.E2.m1.1.1.1.1.4.3.3.3" xref="S3.E2.m1.1.1.1.1.4.3.3.3.cmml">1</mn></msub><mo lspace="0em" rspace="0em" id="S3.E2.m1.1.1.1.1.4.3.1a" xref="S3.E2.m1.1.1.1.1.4.3.1.cmml">​</mo><msub id="S3.E2.m1.1.1.1.1.4.3.4" xref="S3.E2.m1.1.1.1.1.4.3.4.cmml"><mi id="S3.E2.m1.1.1.1.1.4.3.4.2" xref="S3.E2.m1.1.1.1.1.4.3.4.2.cmml">θ</mi><mn id="S3.E2.m1.1.1.1.1.4.3.4.3" xref="S3.E2.m1.1.1.1.1.4.3.4.3.cmml">2</mn></msub></mrow><mo id="S3.E2.m1.1.1.1.1.4.1a" xref="S3.E2.m1.1.1.1.1.4.1.cmml">+</mo><mrow id="S3.E2.m1.1.1.1.1.4.4" xref="S3.E2.m1.1.1.1.1.4.4.cmml"><mn id="S3.E2.m1.1.1.1.1.4.4.2" xref="S3.E2.m1.1.1.1.1.4.4.2.cmml">3</mn><mo lspace="0em" rspace="0em" id="S3.E2.m1.1.1.1.1.4.4.1" xref="S3.E2.m1.1.1.1.1.4.4.1.cmml">​</mo><msubsup id="S3.E2.m1.1.1.1.1.4.4.3" xref="S3.E2.m1.1.1.1.1.4.4.3.cmml"><mi id="S3.E2.m1.1.1.1.1.4.4.3.2.2" xref="S3.E2.m1.1.1.1.1.4.4.3.2.2.cmml">θ</mi><mn id="S3.E2.m1.1.1.1.1.4.4.3.2.3" xref="S3.E2.m1.1.1.1.1.4.4.3.2.3.cmml">2</mn><mn id="S3.E2.m1.1.1.1.1.4.4.3.3" xref="S3.E2.m1.1.1.1.1.4.4.3.3.cmml">2</mn></msubsup></mrow></mrow></mrow><mo id="S3.E2.m1.1.1.1.2" xref="S3.E2.m1.1.1.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E2.m1.1b"><apply id="S3.E2.m1.1.1.1.1.cmml" xref="S3.E2.m1.1.1.1"><eq id="S3.E2.m1.1.1.1.1.3.cmml" xref="S3.E2.m1.1.1.1.1.3"></eq><apply id="S3.E2.m1.1.1.1.1.2.cmml" xref="S3.E2.m1.1.1.1.1.2"><times id="S3.E2.m1.1.1.1.1.2.3.cmml" xref="S3.E2.m1.1.1.1.1.2.3"></times><ci id="S3.E2.m1.1.1.1.1.2.4.cmml" xref="S3.E2.m1.1.1.1.1.2.4">𝑓</ci><interval closure="open" id="S3.E2.m1.1.1.1.1.2.2.3.cmml" xref="S3.E2.m1.1.1.1.1.2.2.2"><apply id="S3.E2.m1.1.1.1.1.1.1.1.1.cmml" xref="S3.E2.m1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E2.m1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E2.m1.1.1.1.1.1.1.1.1">subscript</csymbol><ci id="S3.E2.m1.1.1.1.1.1.1.1.1.2.cmml" xref="S3.E2.m1.1.1.1.1.1.1.1.1.2">𝜃</ci><cn type="integer" id="S3.E2.m1.1.1.1.1.1.1.1.1.3.cmml" xref="S3.E2.m1.1.1.1.1.1.1.1.1.3">1</cn></apply><apply id="S3.E2.m1.1.1.1.1.2.2.2.2.cmml" xref="S3.E2.m1.1.1.1.1.2.2.2.2"><csymbol cd="ambiguous" id="S3.E2.m1.1.1.1.1.2.2.2.2.1.cmml" xref="S3.E2.m1.1.1.1.1.2.2.2.2">subscript</csymbol><ci id="S3.E2.m1.1.1.1.1.2.2.2.2.2.cmml" xref="S3.E2.m1.1.1.1.1.2.2.2.2.2">𝜃</ci><cn type="integer" id="S3.E2.m1.1.1.1.1.2.2.2.2.3.cmml" xref="S3.E2.m1.1.1.1.1.2.2.2.2.3">2</cn></apply></interval></apply><apply id="S3.E2.m1.1.1.1.1.4.cmml" xref="S3.E2.m1.1.1.1.1.4"><plus id="S3.E2.m1.1.1.1.1.4.1.cmml" xref="S3.E2.m1.1.1.1.1.4.1"></plus><apply id="S3.E2.m1.1.1.1.1.4.2.cmml" xref="S3.E2.m1.1.1.1.1.4.2"><csymbol cd="ambiguous" id="S3.E2.m1.1.1.1.1.4.2.1.cmml" xref="S3.E2.m1.1.1.1.1.4.2">superscript</csymbol><apply id="S3.E2.m1.1.1.1.1.4.2.2.cmml" xref="S3.E2.m1.1.1.1.1.4.2"><csymbol cd="ambiguous" id="S3.E2.m1.1.1.1.1.4.2.2.1.cmml" xref="S3.E2.m1.1.1.1.1.4.2">subscript</csymbol><ci id="S3.E2.m1.1.1.1.1.4.2.2.2.cmml" xref="S3.E2.m1.1.1.1.1.4.2.2.2">𝜃</ci><cn type="integer" id="S3.E2.m1.1.1.1.1.4.2.2.3.cmml" xref="S3.E2.m1.1.1.1.1.4.2.2.3">1</cn></apply><cn type="integer" id="S3.E2.m1.1.1.1.1.4.2.3.cmml" xref="S3.E2.m1.1.1.1.1.4.2.3">2</cn></apply><apply id="S3.E2.m1.1.1.1.1.4.3.cmml" xref="S3.E2.m1.1.1.1.1.4.3"><times id="S3.E2.m1.1.1.1.1.4.3.1.cmml" xref="S3.E2.m1.1.1.1.1.4.3.1"></times><cn type="integer" id="S3.E2.m1.1.1.1.1.4.3.2.cmml" xref="S3.E2.m1.1.1.1.1.4.3.2">2</cn><apply id="S3.E2.m1.1.1.1.1.4.3.3.cmml" xref="S3.E2.m1.1.1.1.1.4.3.3"><csymbol cd="ambiguous" id="S3.E2.m1.1.1.1.1.4.3.3.1.cmml" xref="S3.E2.m1.1.1.1.1.4.3.3">subscript</csymbol><ci id="S3.E2.m1.1.1.1.1.4.3.3.2.cmml" xref="S3.E2.m1.1.1.1.1.4.3.3.2">𝜃</ci><cn type="integer" id="S3.E2.m1.1.1.1.1.4.3.3.3.cmml" xref="S3.E2.m1.1.1.1.1.4.3.3.3">1</cn></apply><apply id="S3.E2.m1.1.1.1.1.4.3.4.cmml" xref="S3.E2.m1.1.1.1.1.4.3.4"><csymbol cd="ambiguous" id="S3.E2.m1.1.1.1.1.4.3.4.1.cmml" xref="S3.E2.m1.1.1.1.1.4.3.4">subscript</csymbol><ci id="S3.E2.m1.1.1.1.1.4.3.4.2.cmml" xref="S3.E2.m1.1.1.1.1.4.3.4.2">𝜃</ci><cn type="integer" id="S3.E2.m1.1.1.1.1.4.3.4.3.cmml" xref="S3.E2.m1.1.1.1.1.4.3.4.3">2</cn></apply></apply><apply id="S3.E2.m1.1.1.1.1.4.4.cmml" xref="S3.E2.m1.1.1.1.1.4.4"><times id="S3.E2.m1.1.1.1.1.4.4.1.cmml" xref="S3.E2.m1.1.1.1.1.4.4.1"></times><cn type="integer" id="S3.E2.m1.1.1.1.1.4.4.2.cmml" xref="S3.E2.m1.1.1.1.1.4.4.2">3</cn><apply id="S3.E2.m1.1.1.1.1.4.4.3.cmml" xref="S3.E2.m1.1.1.1.1.4.4.3"><csymbol cd="ambiguous" id="S3.E2.m1.1.1.1.1.4.4.3.1.cmml" xref="S3.E2.m1.1.1.1.1.4.4.3">superscript</csymbol><apply id="S3.E2.m1.1.1.1.1.4.4.3.2.cmml" xref="S3.E2.m1.1.1.1.1.4.4.3"><csymbol cd="ambiguous" id="S3.E2.m1.1.1.1.1.4.4.3.2.1.cmml" xref="S3.E2.m1.1.1.1.1.4.4.3">subscript</csymbol><ci id="S3.E2.m1.1.1.1.1.4.4.3.2.2.cmml" xref="S3.E2.m1.1.1.1.1.4.4.3.2.2">𝜃</ci><cn type="integer" id="S3.E2.m1.1.1.1.1.4.4.3.2.3.cmml" xref="S3.E2.m1.1.1.1.1.4.4.3.2.3">2</cn></apply><cn type="integer" id="S3.E2.m1.1.1.1.1.4.4.3.3.cmml" xref="S3.E2.m1.1.1.1.1.4.4.3.3">2</cn></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E2.m1.1c">\displaystyle f(\theta_{1},\theta_{2})=\theta_{1}^{2}+2\theta_{1}\theta_{2}+3\theta_{2}^{2},</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(2)</span></td>
</tr></tbody>
</table>
<p id="S3.p2.4" class="ltx_p">where <math id="S3.p2.4.m1.2" class="ltx_Math" alttext="\bm{\theta}=[\theta_{1},\theta_{2}]" display="inline"><semantics id="S3.p2.4.m1.2a"><mrow id="S3.p2.4.m1.2.2" xref="S3.p2.4.m1.2.2.cmml"><mi id="S3.p2.4.m1.2.2.4" xref="S3.p2.4.m1.2.2.4.cmml">𝜽</mi><mo id="S3.p2.4.m1.2.2.3" xref="S3.p2.4.m1.2.2.3.cmml">=</mo><mrow id="S3.p2.4.m1.2.2.2.2" xref="S3.p2.4.m1.2.2.2.3.cmml"><mo stretchy="false" id="S3.p2.4.m1.2.2.2.2.3" xref="S3.p2.4.m1.2.2.2.3.cmml">[</mo><msub id="S3.p2.4.m1.1.1.1.1.1" xref="S3.p2.4.m1.1.1.1.1.1.cmml"><mi id="S3.p2.4.m1.1.1.1.1.1.2" xref="S3.p2.4.m1.1.1.1.1.1.2.cmml">θ</mi><mn id="S3.p2.4.m1.1.1.1.1.1.3" xref="S3.p2.4.m1.1.1.1.1.1.3.cmml">1</mn></msub><mo id="S3.p2.4.m1.2.2.2.2.4" xref="S3.p2.4.m1.2.2.2.3.cmml">,</mo><msub id="S3.p2.4.m1.2.2.2.2.2" xref="S3.p2.4.m1.2.2.2.2.2.cmml"><mi id="S3.p2.4.m1.2.2.2.2.2.2" xref="S3.p2.4.m1.2.2.2.2.2.2.cmml">θ</mi><mn id="S3.p2.4.m1.2.2.2.2.2.3" xref="S3.p2.4.m1.2.2.2.2.2.3.cmml">2</mn></msub><mo stretchy="false" id="S3.p2.4.m1.2.2.2.2.5" xref="S3.p2.4.m1.2.2.2.3.cmml">]</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.p2.4.m1.2b"><apply id="S3.p2.4.m1.2.2.cmml" xref="S3.p2.4.m1.2.2"><eq id="S3.p2.4.m1.2.2.3.cmml" xref="S3.p2.4.m1.2.2.3"></eq><ci id="S3.p2.4.m1.2.2.4.cmml" xref="S3.p2.4.m1.2.2.4">𝜽</ci><interval closure="closed" id="S3.p2.4.m1.2.2.2.3.cmml" xref="S3.p2.4.m1.2.2.2.2"><apply id="S3.p2.4.m1.1.1.1.1.1.cmml" xref="S3.p2.4.m1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.p2.4.m1.1.1.1.1.1.1.cmml" xref="S3.p2.4.m1.1.1.1.1.1">subscript</csymbol><ci id="S3.p2.4.m1.1.1.1.1.1.2.cmml" xref="S3.p2.4.m1.1.1.1.1.1.2">𝜃</ci><cn type="integer" id="S3.p2.4.m1.1.1.1.1.1.3.cmml" xref="S3.p2.4.m1.1.1.1.1.1.3">1</cn></apply><apply id="S3.p2.4.m1.2.2.2.2.2.cmml" xref="S3.p2.4.m1.2.2.2.2.2"><csymbol cd="ambiguous" id="S3.p2.4.m1.2.2.2.2.2.1.cmml" xref="S3.p2.4.m1.2.2.2.2.2">subscript</csymbol><ci id="S3.p2.4.m1.2.2.2.2.2.2.cmml" xref="S3.p2.4.m1.2.2.2.2.2.2">𝜃</ci><cn type="integer" id="S3.p2.4.m1.2.2.2.2.2.3.cmml" xref="S3.p2.4.m1.2.2.2.2.2.3">2</cn></apply></interval></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p2.4.m1.2c">\bm{\theta}=[\theta_{1},\theta_{2}]</annotation></semantics></math> is the model we aim to learn. The Hessian matrix for this function is given by</p>
<table id="Sx1.EGx3" class="ltx_equationgroup ltx_eqn_align ltx_eqn_table">

<tbody id="S3.E3"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math id="S3.E3.m1.4" class="ltx_Math" alttext="\displaystyle\bm{H}=\nabla^{2}f(\bm{\theta})=\begin{bmatrix}\frac{\partial^{2}f}{\partial\theta_{1}^{2}}&amp;\frac{\partial^{2}f}{\partial\theta_{1}\partial\theta_{2}}\\
\frac{\partial^{2}f}{\partial\theta_{2}\partial\theta_{1}}&amp;\frac{\partial^{2}f}{\partial\theta_{2}^{2}}\end{bmatrix}=\begin{bmatrix}2&amp;2\\
2&amp;6\end{bmatrix}." display="inline"><semantics id="S3.E3.m1.4a"><mrow id="S3.E3.m1.4.4.1" xref="S3.E3.m1.4.4.1.1.cmml"><mrow id="S3.E3.m1.4.4.1.1" xref="S3.E3.m1.4.4.1.1.cmml"><mi id="S3.E3.m1.4.4.1.1.2" xref="S3.E3.m1.4.4.1.1.2.cmml">𝑯</mi><mo id="S3.E3.m1.4.4.1.1.3" xref="S3.E3.m1.4.4.1.1.3.cmml">=</mo><mrow id="S3.E3.m1.4.4.1.1.4" xref="S3.E3.m1.4.4.1.1.4.cmml"><mrow id="S3.E3.m1.4.4.1.1.4.2" xref="S3.E3.m1.4.4.1.1.4.2.cmml"><msup id="S3.E3.m1.4.4.1.1.4.2.1" xref="S3.E3.m1.4.4.1.1.4.2.1.cmml"><mo rspace="0.167em" id="S3.E3.m1.4.4.1.1.4.2.1.2" xref="S3.E3.m1.4.4.1.1.4.2.1.2.cmml">∇</mo><mn id="S3.E3.m1.4.4.1.1.4.2.1.3" xref="S3.E3.m1.4.4.1.1.4.2.1.3.cmml">2</mn></msup><mi id="S3.E3.m1.4.4.1.1.4.2.2" xref="S3.E3.m1.4.4.1.1.4.2.2.cmml">f</mi></mrow><mo lspace="0em" rspace="0em" id="S3.E3.m1.4.4.1.1.4.1" xref="S3.E3.m1.4.4.1.1.4.1.cmml">​</mo><mrow id="S3.E3.m1.4.4.1.1.4.3.2" xref="S3.E3.m1.4.4.1.1.4.cmml"><mo stretchy="false" id="S3.E3.m1.4.4.1.1.4.3.2.1" xref="S3.E3.m1.4.4.1.1.4.cmml">(</mo><mi id="S3.E3.m1.3.3" xref="S3.E3.m1.3.3.cmml">𝜽</mi><mo stretchy="false" id="S3.E3.m1.4.4.1.1.4.3.2.2" xref="S3.E3.m1.4.4.1.1.4.cmml">)</mo></mrow></mrow><mo id="S3.E3.m1.4.4.1.1.5" xref="S3.E3.m1.4.4.1.1.5.cmml">=</mo><mrow id="S3.E3.m1.1.1a.3" xref="S3.E3.m1.1.1a.2.cmml"><mo id="S3.E3.m1.1.1a.3.1" xref="S3.E3.m1.1.1a.2.1.cmml">[</mo><mtable columnspacing="5pt" rowspacing="0pt" id="S3.E3.m1.1.1.1.1" xref="S3.E3.m1.1.1.1.1.cmml"><mtr id="S3.E3.m1.1.1.1.1a" xref="S3.E3.m1.1.1.1.1.cmml"><mtd id="S3.E3.m1.1.1.1.1b" xref="S3.E3.m1.1.1.1.1.cmml"><mfrac id="S3.E3.m1.1.1.1.1.1.1.1" xref="S3.E3.m1.1.1.1.1.1.1.1.cmml"><mrow id="S3.E3.m1.1.1.1.1.1.1.1.2" xref="S3.E3.m1.1.1.1.1.1.1.1.2.cmml"><msup id="S3.E3.m1.1.1.1.1.1.1.1.2.1" xref="S3.E3.m1.1.1.1.1.1.1.1.2.1.cmml"><mo id="S3.E3.m1.1.1.1.1.1.1.1.2.1.2" xref="S3.E3.m1.1.1.1.1.1.1.1.2.1.2.cmml">∂</mo><mn id="S3.E3.m1.1.1.1.1.1.1.1.2.1.3" xref="S3.E3.m1.1.1.1.1.1.1.1.2.1.3.cmml">2</mn></msup><mi id="S3.E3.m1.1.1.1.1.1.1.1.2.2" xref="S3.E3.m1.1.1.1.1.1.1.1.2.2.cmml">f</mi></mrow><mrow id="S3.E3.m1.1.1.1.1.1.1.1.3" xref="S3.E3.m1.1.1.1.1.1.1.1.3.cmml"><mo rspace="0em" id="S3.E3.m1.1.1.1.1.1.1.1.3.1" xref="S3.E3.m1.1.1.1.1.1.1.1.3.1.cmml">∂</mo><msubsup id="S3.E3.m1.1.1.1.1.1.1.1.3.2" xref="S3.E3.m1.1.1.1.1.1.1.1.3.2.cmml"><mi id="S3.E3.m1.1.1.1.1.1.1.1.3.2.2.2" xref="S3.E3.m1.1.1.1.1.1.1.1.3.2.2.2.cmml">θ</mi><mn id="S3.E3.m1.1.1.1.1.1.1.1.3.2.2.3" xref="S3.E3.m1.1.1.1.1.1.1.1.3.2.2.3.cmml">1</mn><mn id="S3.E3.m1.1.1.1.1.1.1.1.3.2.3" xref="S3.E3.m1.1.1.1.1.1.1.1.3.2.3.cmml">2</mn></msubsup></mrow></mfrac></mtd><mtd id="S3.E3.m1.1.1.1.1c" xref="S3.E3.m1.1.1.1.1.cmml"><mfrac id="S3.E3.m1.1.1.1.1.1.2.1" xref="S3.E3.m1.1.1.1.1.1.2.1.cmml"><mrow id="S3.E3.m1.1.1.1.1.1.2.1.2" xref="S3.E3.m1.1.1.1.1.1.2.1.2.cmml"><msup id="S3.E3.m1.1.1.1.1.1.2.1.2.1" xref="S3.E3.m1.1.1.1.1.1.2.1.2.1.cmml"><mo id="S3.E3.m1.1.1.1.1.1.2.1.2.1.2" xref="S3.E3.m1.1.1.1.1.1.2.1.2.1.2.cmml">∂</mo><mn id="S3.E3.m1.1.1.1.1.1.2.1.2.1.3" xref="S3.E3.m1.1.1.1.1.1.2.1.2.1.3.cmml">2</mn></msup><mi id="S3.E3.m1.1.1.1.1.1.2.1.2.2" xref="S3.E3.m1.1.1.1.1.1.2.1.2.2.cmml">f</mi></mrow><mrow id="S3.E3.m1.1.1.1.1.1.2.1.3" xref="S3.E3.m1.1.1.1.1.1.2.1.3.cmml"><mo rspace="0em" id="S3.E3.m1.1.1.1.1.1.2.1.3.1" xref="S3.E3.m1.1.1.1.1.1.2.1.3.1.cmml">∂</mo><mrow id="S3.E3.m1.1.1.1.1.1.2.1.3.2" xref="S3.E3.m1.1.1.1.1.1.2.1.3.2.cmml"><msub id="S3.E3.m1.1.1.1.1.1.2.1.3.2.2" xref="S3.E3.m1.1.1.1.1.1.2.1.3.2.2.cmml"><mi id="S3.E3.m1.1.1.1.1.1.2.1.3.2.2.2" xref="S3.E3.m1.1.1.1.1.1.2.1.3.2.2.2.cmml">θ</mi><mn id="S3.E3.m1.1.1.1.1.1.2.1.3.2.2.3" xref="S3.E3.m1.1.1.1.1.1.2.1.3.2.2.3.cmml">1</mn></msub><mo lspace="0em" rspace="0em" id="S3.E3.m1.1.1.1.1.1.2.1.3.2.1" xref="S3.E3.m1.1.1.1.1.1.2.1.3.2.1.cmml">​</mo><mrow id="S3.E3.m1.1.1.1.1.1.2.1.3.2.3" xref="S3.E3.m1.1.1.1.1.1.2.1.3.2.3.cmml"><mo rspace="0em" id="S3.E3.m1.1.1.1.1.1.2.1.3.2.3.1" xref="S3.E3.m1.1.1.1.1.1.2.1.3.2.3.1.cmml">∂</mo><msub id="S3.E3.m1.1.1.1.1.1.2.1.3.2.3.2" xref="S3.E3.m1.1.1.1.1.1.2.1.3.2.3.2.cmml"><mi id="S3.E3.m1.1.1.1.1.1.2.1.3.2.3.2.2" xref="S3.E3.m1.1.1.1.1.1.2.1.3.2.3.2.2.cmml">θ</mi><mn id="S3.E3.m1.1.1.1.1.1.2.1.3.2.3.2.3" xref="S3.E3.m1.1.1.1.1.1.2.1.3.2.3.2.3.cmml">2</mn></msub></mrow></mrow></mrow></mfrac></mtd></mtr><mtr id="S3.E3.m1.1.1.1.1d" xref="S3.E3.m1.1.1.1.1.cmml"><mtd id="S3.E3.m1.1.1.1.1e" xref="S3.E3.m1.1.1.1.1.cmml"><mfrac id="S3.E3.m1.1.1.1.1.2.1.1" xref="S3.E3.m1.1.1.1.1.2.1.1.cmml"><mrow id="S3.E3.m1.1.1.1.1.2.1.1.2" xref="S3.E3.m1.1.1.1.1.2.1.1.2.cmml"><msup id="S3.E3.m1.1.1.1.1.2.1.1.2.1" xref="S3.E3.m1.1.1.1.1.2.1.1.2.1.cmml"><mo id="S3.E3.m1.1.1.1.1.2.1.1.2.1.2" xref="S3.E3.m1.1.1.1.1.2.1.1.2.1.2.cmml">∂</mo><mn id="S3.E3.m1.1.1.1.1.2.1.1.2.1.3" xref="S3.E3.m1.1.1.1.1.2.1.1.2.1.3.cmml">2</mn></msup><mi id="S3.E3.m1.1.1.1.1.2.1.1.2.2" xref="S3.E3.m1.1.1.1.1.2.1.1.2.2.cmml">f</mi></mrow><mrow id="S3.E3.m1.1.1.1.1.2.1.1.3" xref="S3.E3.m1.1.1.1.1.2.1.1.3.cmml"><mo rspace="0em" id="S3.E3.m1.1.1.1.1.2.1.1.3.1" xref="S3.E3.m1.1.1.1.1.2.1.1.3.1.cmml">∂</mo><mrow id="S3.E3.m1.1.1.1.1.2.1.1.3.2" xref="S3.E3.m1.1.1.1.1.2.1.1.3.2.cmml"><msub id="S3.E3.m1.1.1.1.1.2.1.1.3.2.2" xref="S3.E3.m1.1.1.1.1.2.1.1.3.2.2.cmml"><mi id="S3.E3.m1.1.1.1.1.2.1.1.3.2.2.2" xref="S3.E3.m1.1.1.1.1.2.1.1.3.2.2.2.cmml">θ</mi><mn id="S3.E3.m1.1.1.1.1.2.1.1.3.2.2.3" xref="S3.E3.m1.1.1.1.1.2.1.1.3.2.2.3.cmml">2</mn></msub><mo lspace="0em" rspace="0em" id="S3.E3.m1.1.1.1.1.2.1.1.3.2.1" xref="S3.E3.m1.1.1.1.1.2.1.1.3.2.1.cmml">​</mo><mrow id="S3.E3.m1.1.1.1.1.2.1.1.3.2.3" xref="S3.E3.m1.1.1.1.1.2.1.1.3.2.3.cmml"><mo rspace="0em" id="S3.E3.m1.1.1.1.1.2.1.1.3.2.3.1" xref="S3.E3.m1.1.1.1.1.2.1.1.3.2.3.1.cmml">∂</mo><msub id="S3.E3.m1.1.1.1.1.2.1.1.3.2.3.2" xref="S3.E3.m1.1.1.1.1.2.1.1.3.2.3.2.cmml"><mi id="S3.E3.m1.1.1.1.1.2.1.1.3.2.3.2.2" xref="S3.E3.m1.1.1.1.1.2.1.1.3.2.3.2.2.cmml">θ</mi><mn id="S3.E3.m1.1.1.1.1.2.1.1.3.2.3.2.3" xref="S3.E3.m1.1.1.1.1.2.1.1.3.2.3.2.3.cmml">1</mn></msub></mrow></mrow></mrow></mfrac></mtd><mtd id="S3.E3.m1.1.1.1.1f" xref="S3.E3.m1.1.1.1.1.cmml"><mfrac id="S3.E3.m1.1.1.1.1.2.2.1" xref="S3.E3.m1.1.1.1.1.2.2.1.cmml"><mrow id="S3.E3.m1.1.1.1.1.2.2.1.2" xref="S3.E3.m1.1.1.1.1.2.2.1.2.cmml"><msup id="S3.E3.m1.1.1.1.1.2.2.1.2.1" xref="S3.E3.m1.1.1.1.1.2.2.1.2.1.cmml"><mo id="S3.E3.m1.1.1.1.1.2.2.1.2.1.2" xref="S3.E3.m1.1.1.1.1.2.2.1.2.1.2.cmml">∂</mo><mn id="S3.E3.m1.1.1.1.1.2.2.1.2.1.3" xref="S3.E3.m1.1.1.1.1.2.2.1.2.1.3.cmml">2</mn></msup><mi id="S3.E3.m1.1.1.1.1.2.2.1.2.2" xref="S3.E3.m1.1.1.1.1.2.2.1.2.2.cmml">f</mi></mrow><mrow id="S3.E3.m1.1.1.1.1.2.2.1.3" xref="S3.E3.m1.1.1.1.1.2.2.1.3.cmml"><mo rspace="0em" id="S3.E3.m1.1.1.1.1.2.2.1.3.1" xref="S3.E3.m1.1.1.1.1.2.2.1.3.1.cmml">∂</mo><msubsup id="S3.E3.m1.1.1.1.1.2.2.1.3.2" xref="S3.E3.m1.1.1.1.1.2.2.1.3.2.cmml"><mi id="S3.E3.m1.1.1.1.1.2.2.1.3.2.2.2" xref="S3.E3.m1.1.1.1.1.2.2.1.3.2.2.2.cmml">θ</mi><mn id="S3.E3.m1.1.1.1.1.2.2.1.3.2.2.3" xref="S3.E3.m1.1.1.1.1.2.2.1.3.2.2.3.cmml">2</mn><mn id="S3.E3.m1.1.1.1.1.2.2.1.3.2.3" xref="S3.E3.m1.1.1.1.1.2.2.1.3.2.3.cmml">2</mn></msubsup></mrow></mfrac></mtd></mtr></mtable><mo id="S3.E3.m1.1.1a.3.2" xref="S3.E3.m1.1.1a.2.1.cmml">]</mo></mrow><mo id="S3.E3.m1.4.4.1.1.6" xref="S3.E3.m1.4.4.1.1.6.cmml">=</mo><mrow id="S3.E3.m1.2.2a.3" xref="S3.E3.m1.2.2a.2.cmml"><mo id="S3.E3.m1.2.2a.3.1" xref="S3.E3.m1.2.2a.2.1.cmml">[</mo><mtable columnspacing="5pt" rowspacing="0pt" id="S3.E3.m1.2.2.1.1" xref="S3.E3.m1.2.2.1.1.cmml"><mtr id="S3.E3.m1.2.2.1.1a" xref="S3.E3.m1.2.2.1.1.cmml"><mtd id="S3.E3.m1.2.2.1.1b" xref="S3.E3.m1.2.2.1.1.cmml"><mn id="S3.E3.m1.2.2.1.1.1.1.1" xref="S3.E3.m1.2.2.1.1.1.1.1.cmml">2</mn></mtd><mtd id="S3.E3.m1.2.2.1.1c" xref="S3.E3.m1.2.2.1.1.cmml"><mn id="S3.E3.m1.2.2.1.1.1.2.1" xref="S3.E3.m1.2.2.1.1.1.2.1.cmml">2</mn></mtd></mtr><mtr id="S3.E3.m1.2.2.1.1d" xref="S3.E3.m1.2.2.1.1.cmml"><mtd id="S3.E3.m1.2.2.1.1e" xref="S3.E3.m1.2.2.1.1.cmml"><mn id="S3.E3.m1.2.2.1.1.2.1.1" xref="S3.E3.m1.2.2.1.1.2.1.1.cmml">2</mn></mtd><mtd id="S3.E3.m1.2.2.1.1f" xref="S3.E3.m1.2.2.1.1.cmml"><mn id="S3.E3.m1.2.2.1.1.2.2.1" xref="S3.E3.m1.2.2.1.1.2.2.1.cmml">6</mn></mtd></mtr></mtable><mo id="S3.E3.m1.2.2a.3.2" xref="S3.E3.m1.2.2a.2.1.cmml">]</mo></mrow></mrow><mo lspace="0em" id="S3.E3.m1.4.4.1.2" xref="S3.E3.m1.4.4.1.1.cmml">.</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E3.m1.4b"><apply id="S3.E3.m1.4.4.1.1.cmml" xref="S3.E3.m1.4.4.1"><and id="S3.E3.m1.4.4.1.1a.cmml" xref="S3.E3.m1.4.4.1"></and><apply id="S3.E3.m1.4.4.1.1b.cmml" xref="S3.E3.m1.4.4.1"><eq id="S3.E3.m1.4.4.1.1.3.cmml" xref="S3.E3.m1.4.4.1.1.3"></eq><ci id="S3.E3.m1.4.4.1.1.2.cmml" xref="S3.E3.m1.4.4.1.1.2">𝑯</ci><apply id="S3.E3.m1.4.4.1.1.4.cmml" xref="S3.E3.m1.4.4.1.1.4"><times id="S3.E3.m1.4.4.1.1.4.1.cmml" xref="S3.E3.m1.4.4.1.1.4.1"></times><apply id="S3.E3.m1.4.4.1.1.4.2.cmml" xref="S3.E3.m1.4.4.1.1.4.2"><apply id="S3.E3.m1.4.4.1.1.4.2.1.cmml" xref="S3.E3.m1.4.4.1.1.4.2.1"><csymbol cd="ambiguous" id="S3.E3.m1.4.4.1.1.4.2.1.1.cmml" xref="S3.E3.m1.4.4.1.1.4.2.1">superscript</csymbol><ci id="S3.E3.m1.4.4.1.1.4.2.1.2.cmml" xref="S3.E3.m1.4.4.1.1.4.2.1.2">∇</ci><cn type="integer" id="S3.E3.m1.4.4.1.1.4.2.1.3.cmml" xref="S3.E3.m1.4.4.1.1.4.2.1.3">2</cn></apply><ci id="S3.E3.m1.4.4.1.1.4.2.2.cmml" xref="S3.E3.m1.4.4.1.1.4.2.2">𝑓</ci></apply><ci id="S3.E3.m1.3.3.cmml" xref="S3.E3.m1.3.3">𝜽</ci></apply></apply><apply id="S3.E3.m1.4.4.1.1c.cmml" xref="S3.E3.m1.4.4.1"><eq id="S3.E3.m1.4.4.1.1.5.cmml" xref="S3.E3.m1.4.4.1.1.5"></eq><share href="#S3.E3.m1.4.4.1.1.4.cmml" id="S3.E3.m1.4.4.1.1d.cmml" xref="S3.E3.m1.4.4.1"></share><apply id="S3.E3.m1.1.1a.2.cmml" xref="S3.E3.m1.1.1a.3"><csymbol cd="latexml" id="S3.E3.m1.1.1a.2.1.cmml" xref="S3.E3.m1.1.1a.3.1">matrix</csymbol><matrix id="S3.E3.m1.1.1.1.1.cmml" xref="S3.E3.m1.1.1.1.1"><matrixrow id="S3.E3.m1.1.1.1.1a.cmml" xref="S3.E3.m1.1.1.1.1"><apply id="S3.E3.m1.1.1.1.1.1.1.1.cmml" xref="S3.E3.m1.1.1.1.1.1.1.1"><divide id="S3.E3.m1.1.1.1.1.1.1.1.1.cmml" xref="S3.E3.m1.1.1.1.1.1.1.1"></divide><apply id="S3.E3.m1.1.1.1.1.1.1.1.2.cmml" xref="S3.E3.m1.1.1.1.1.1.1.1.2"><apply id="S3.E3.m1.1.1.1.1.1.1.1.2.1.cmml" xref="S3.E3.m1.1.1.1.1.1.1.1.2.1"><csymbol cd="ambiguous" id="S3.E3.m1.1.1.1.1.1.1.1.2.1.1.cmml" xref="S3.E3.m1.1.1.1.1.1.1.1.2.1">superscript</csymbol><partialdiff id="S3.E3.m1.1.1.1.1.1.1.1.2.1.2.cmml" xref="S3.E3.m1.1.1.1.1.1.1.1.2.1.2"></partialdiff><cn type="integer" id="S3.E3.m1.1.1.1.1.1.1.1.2.1.3.cmml" xref="S3.E3.m1.1.1.1.1.1.1.1.2.1.3">2</cn></apply><ci id="S3.E3.m1.1.1.1.1.1.1.1.2.2.cmml" xref="S3.E3.m1.1.1.1.1.1.1.1.2.2">𝑓</ci></apply><apply id="S3.E3.m1.1.1.1.1.1.1.1.3.cmml" xref="S3.E3.m1.1.1.1.1.1.1.1.3"><partialdiff id="S3.E3.m1.1.1.1.1.1.1.1.3.1.cmml" xref="S3.E3.m1.1.1.1.1.1.1.1.3.1"></partialdiff><apply id="S3.E3.m1.1.1.1.1.1.1.1.3.2.cmml" xref="S3.E3.m1.1.1.1.1.1.1.1.3.2"><csymbol cd="ambiguous" id="S3.E3.m1.1.1.1.1.1.1.1.3.2.1.cmml" xref="S3.E3.m1.1.1.1.1.1.1.1.3.2">superscript</csymbol><apply id="S3.E3.m1.1.1.1.1.1.1.1.3.2.2.cmml" xref="S3.E3.m1.1.1.1.1.1.1.1.3.2"><csymbol cd="ambiguous" id="S3.E3.m1.1.1.1.1.1.1.1.3.2.2.1.cmml" xref="S3.E3.m1.1.1.1.1.1.1.1.3.2">subscript</csymbol><ci id="S3.E3.m1.1.1.1.1.1.1.1.3.2.2.2.cmml" xref="S3.E3.m1.1.1.1.1.1.1.1.3.2.2.2">𝜃</ci><cn type="integer" id="S3.E3.m1.1.1.1.1.1.1.1.3.2.2.3.cmml" xref="S3.E3.m1.1.1.1.1.1.1.1.3.2.2.3">1</cn></apply><cn type="integer" id="S3.E3.m1.1.1.1.1.1.1.1.3.2.3.cmml" xref="S3.E3.m1.1.1.1.1.1.1.1.3.2.3">2</cn></apply></apply></apply><apply id="S3.E3.m1.1.1.1.1.1.2.1.cmml" xref="S3.E3.m1.1.1.1.1.1.2.1"><divide id="S3.E3.m1.1.1.1.1.1.2.1.1.cmml" xref="S3.E3.m1.1.1.1.1.1.2.1"></divide><apply id="S3.E3.m1.1.1.1.1.1.2.1.2.cmml" xref="S3.E3.m1.1.1.1.1.1.2.1.2"><apply id="S3.E3.m1.1.1.1.1.1.2.1.2.1.cmml" xref="S3.E3.m1.1.1.1.1.1.2.1.2.1"><csymbol cd="ambiguous" id="S3.E3.m1.1.1.1.1.1.2.1.2.1.1.cmml" xref="S3.E3.m1.1.1.1.1.1.2.1.2.1">superscript</csymbol><partialdiff id="S3.E3.m1.1.1.1.1.1.2.1.2.1.2.cmml" xref="S3.E3.m1.1.1.1.1.1.2.1.2.1.2"></partialdiff><cn type="integer" id="S3.E3.m1.1.1.1.1.1.2.1.2.1.3.cmml" xref="S3.E3.m1.1.1.1.1.1.2.1.2.1.3">2</cn></apply><ci id="S3.E3.m1.1.1.1.1.1.2.1.2.2.cmml" xref="S3.E3.m1.1.1.1.1.1.2.1.2.2">𝑓</ci></apply><apply id="S3.E3.m1.1.1.1.1.1.2.1.3.cmml" xref="S3.E3.m1.1.1.1.1.1.2.1.3"><partialdiff id="S3.E3.m1.1.1.1.1.1.2.1.3.1.cmml" xref="S3.E3.m1.1.1.1.1.1.2.1.3.1"></partialdiff><apply id="S3.E3.m1.1.1.1.1.1.2.1.3.2.cmml" xref="S3.E3.m1.1.1.1.1.1.2.1.3.2"><times id="S3.E3.m1.1.1.1.1.1.2.1.3.2.1.cmml" xref="S3.E3.m1.1.1.1.1.1.2.1.3.2.1"></times><apply id="S3.E3.m1.1.1.1.1.1.2.1.3.2.2.cmml" xref="S3.E3.m1.1.1.1.1.1.2.1.3.2.2"><csymbol cd="ambiguous" id="S3.E3.m1.1.1.1.1.1.2.1.3.2.2.1.cmml" xref="S3.E3.m1.1.1.1.1.1.2.1.3.2.2">subscript</csymbol><ci id="S3.E3.m1.1.1.1.1.1.2.1.3.2.2.2.cmml" xref="S3.E3.m1.1.1.1.1.1.2.1.3.2.2.2">𝜃</ci><cn type="integer" id="S3.E3.m1.1.1.1.1.1.2.1.3.2.2.3.cmml" xref="S3.E3.m1.1.1.1.1.1.2.1.3.2.2.3">1</cn></apply><apply id="S3.E3.m1.1.1.1.1.1.2.1.3.2.3.cmml" xref="S3.E3.m1.1.1.1.1.1.2.1.3.2.3"><partialdiff id="S3.E3.m1.1.1.1.1.1.2.1.3.2.3.1.cmml" xref="S3.E3.m1.1.1.1.1.1.2.1.3.2.3.1"></partialdiff><apply id="S3.E3.m1.1.1.1.1.1.2.1.3.2.3.2.cmml" xref="S3.E3.m1.1.1.1.1.1.2.1.3.2.3.2"><csymbol cd="ambiguous" id="S3.E3.m1.1.1.1.1.1.2.1.3.2.3.2.1.cmml" xref="S3.E3.m1.1.1.1.1.1.2.1.3.2.3.2">subscript</csymbol><ci id="S3.E3.m1.1.1.1.1.1.2.1.3.2.3.2.2.cmml" xref="S3.E3.m1.1.1.1.1.1.2.1.3.2.3.2.2">𝜃</ci><cn type="integer" id="S3.E3.m1.1.1.1.1.1.2.1.3.2.3.2.3.cmml" xref="S3.E3.m1.1.1.1.1.1.2.1.3.2.3.2.3">2</cn></apply></apply></apply></apply></apply></matrixrow><matrixrow id="S3.E3.m1.1.1.1.1b.cmml" xref="S3.E3.m1.1.1.1.1"><apply id="S3.E3.m1.1.1.1.1.2.1.1.cmml" xref="S3.E3.m1.1.1.1.1.2.1.1"><divide id="S3.E3.m1.1.1.1.1.2.1.1.1.cmml" xref="S3.E3.m1.1.1.1.1.2.1.1"></divide><apply id="S3.E3.m1.1.1.1.1.2.1.1.2.cmml" xref="S3.E3.m1.1.1.1.1.2.1.1.2"><apply id="S3.E3.m1.1.1.1.1.2.1.1.2.1.cmml" xref="S3.E3.m1.1.1.1.1.2.1.1.2.1"><csymbol cd="ambiguous" id="S3.E3.m1.1.1.1.1.2.1.1.2.1.1.cmml" xref="S3.E3.m1.1.1.1.1.2.1.1.2.1">superscript</csymbol><partialdiff id="S3.E3.m1.1.1.1.1.2.1.1.2.1.2.cmml" xref="S3.E3.m1.1.1.1.1.2.1.1.2.1.2"></partialdiff><cn type="integer" id="S3.E3.m1.1.1.1.1.2.1.1.2.1.3.cmml" xref="S3.E3.m1.1.1.1.1.2.1.1.2.1.3">2</cn></apply><ci id="S3.E3.m1.1.1.1.1.2.1.1.2.2.cmml" xref="S3.E3.m1.1.1.1.1.2.1.1.2.2">𝑓</ci></apply><apply id="S3.E3.m1.1.1.1.1.2.1.1.3.cmml" xref="S3.E3.m1.1.1.1.1.2.1.1.3"><partialdiff id="S3.E3.m1.1.1.1.1.2.1.1.3.1.cmml" xref="S3.E3.m1.1.1.1.1.2.1.1.3.1"></partialdiff><apply id="S3.E3.m1.1.1.1.1.2.1.1.3.2.cmml" xref="S3.E3.m1.1.1.1.1.2.1.1.3.2"><times id="S3.E3.m1.1.1.1.1.2.1.1.3.2.1.cmml" xref="S3.E3.m1.1.1.1.1.2.1.1.3.2.1"></times><apply id="S3.E3.m1.1.1.1.1.2.1.1.3.2.2.cmml" xref="S3.E3.m1.1.1.1.1.2.1.1.3.2.2"><csymbol cd="ambiguous" id="S3.E3.m1.1.1.1.1.2.1.1.3.2.2.1.cmml" xref="S3.E3.m1.1.1.1.1.2.1.1.3.2.2">subscript</csymbol><ci id="S3.E3.m1.1.1.1.1.2.1.1.3.2.2.2.cmml" xref="S3.E3.m1.1.1.1.1.2.1.1.3.2.2.2">𝜃</ci><cn type="integer" id="S3.E3.m1.1.1.1.1.2.1.1.3.2.2.3.cmml" xref="S3.E3.m1.1.1.1.1.2.1.1.3.2.2.3">2</cn></apply><apply id="S3.E3.m1.1.1.1.1.2.1.1.3.2.3.cmml" xref="S3.E3.m1.1.1.1.1.2.1.1.3.2.3"><partialdiff id="S3.E3.m1.1.1.1.1.2.1.1.3.2.3.1.cmml" xref="S3.E3.m1.1.1.1.1.2.1.1.3.2.3.1"></partialdiff><apply id="S3.E3.m1.1.1.1.1.2.1.1.3.2.3.2.cmml" xref="S3.E3.m1.1.1.1.1.2.1.1.3.2.3.2"><csymbol cd="ambiguous" id="S3.E3.m1.1.1.1.1.2.1.1.3.2.3.2.1.cmml" xref="S3.E3.m1.1.1.1.1.2.1.1.3.2.3.2">subscript</csymbol><ci id="S3.E3.m1.1.1.1.1.2.1.1.3.2.3.2.2.cmml" xref="S3.E3.m1.1.1.1.1.2.1.1.3.2.3.2.2">𝜃</ci><cn type="integer" id="S3.E3.m1.1.1.1.1.2.1.1.3.2.3.2.3.cmml" xref="S3.E3.m1.1.1.1.1.2.1.1.3.2.3.2.3">1</cn></apply></apply></apply></apply></apply><apply id="S3.E3.m1.1.1.1.1.2.2.1.cmml" xref="S3.E3.m1.1.1.1.1.2.2.1"><divide id="S3.E3.m1.1.1.1.1.2.2.1.1.cmml" xref="S3.E3.m1.1.1.1.1.2.2.1"></divide><apply id="S3.E3.m1.1.1.1.1.2.2.1.2.cmml" xref="S3.E3.m1.1.1.1.1.2.2.1.2"><apply id="S3.E3.m1.1.1.1.1.2.2.1.2.1.cmml" xref="S3.E3.m1.1.1.1.1.2.2.1.2.1"><csymbol cd="ambiguous" id="S3.E3.m1.1.1.1.1.2.2.1.2.1.1.cmml" xref="S3.E3.m1.1.1.1.1.2.2.1.2.1">superscript</csymbol><partialdiff id="S3.E3.m1.1.1.1.1.2.2.1.2.1.2.cmml" xref="S3.E3.m1.1.1.1.1.2.2.1.2.1.2"></partialdiff><cn type="integer" id="S3.E3.m1.1.1.1.1.2.2.1.2.1.3.cmml" xref="S3.E3.m1.1.1.1.1.2.2.1.2.1.3">2</cn></apply><ci id="S3.E3.m1.1.1.1.1.2.2.1.2.2.cmml" xref="S3.E3.m1.1.1.1.1.2.2.1.2.2">𝑓</ci></apply><apply id="S3.E3.m1.1.1.1.1.2.2.1.3.cmml" xref="S3.E3.m1.1.1.1.1.2.2.1.3"><partialdiff id="S3.E3.m1.1.1.1.1.2.2.1.3.1.cmml" xref="S3.E3.m1.1.1.1.1.2.2.1.3.1"></partialdiff><apply id="S3.E3.m1.1.1.1.1.2.2.1.3.2.cmml" xref="S3.E3.m1.1.1.1.1.2.2.1.3.2"><csymbol cd="ambiguous" id="S3.E3.m1.1.1.1.1.2.2.1.3.2.1.cmml" xref="S3.E3.m1.1.1.1.1.2.2.1.3.2">superscript</csymbol><apply id="S3.E3.m1.1.1.1.1.2.2.1.3.2.2.cmml" xref="S3.E3.m1.1.1.1.1.2.2.1.3.2"><csymbol cd="ambiguous" id="S3.E3.m1.1.1.1.1.2.2.1.3.2.2.1.cmml" xref="S3.E3.m1.1.1.1.1.2.2.1.3.2">subscript</csymbol><ci id="S3.E3.m1.1.1.1.1.2.2.1.3.2.2.2.cmml" xref="S3.E3.m1.1.1.1.1.2.2.1.3.2.2.2">𝜃</ci><cn type="integer" id="S3.E3.m1.1.1.1.1.2.2.1.3.2.2.3.cmml" xref="S3.E3.m1.1.1.1.1.2.2.1.3.2.2.3">2</cn></apply><cn type="integer" id="S3.E3.m1.1.1.1.1.2.2.1.3.2.3.cmml" xref="S3.E3.m1.1.1.1.1.2.2.1.3.2.3">2</cn></apply></apply></apply></matrixrow></matrix></apply></apply><apply id="S3.E3.m1.4.4.1.1e.cmml" xref="S3.E3.m1.4.4.1"><eq id="S3.E3.m1.4.4.1.1.6.cmml" xref="S3.E3.m1.4.4.1.1.6"></eq><share href="#S3.E3.m1.1.1a.cmml" id="S3.E3.m1.4.4.1.1f.cmml" xref="S3.E3.m1.4.4.1"></share><apply id="S3.E3.m1.2.2a.2.cmml" xref="S3.E3.m1.2.2a.3"><csymbol cd="latexml" id="S3.E3.m1.2.2a.2.1.cmml" xref="S3.E3.m1.2.2a.3.1">matrix</csymbol><matrix id="S3.E3.m1.2.2.1.1.cmml" xref="S3.E3.m1.2.2.1.1"><matrixrow id="S3.E3.m1.2.2.1.1a.cmml" xref="S3.E3.m1.2.2.1.1"><cn type="integer" id="S3.E3.m1.2.2.1.1.1.1.1.cmml" xref="S3.E3.m1.2.2.1.1.1.1.1">2</cn><cn type="integer" id="S3.E3.m1.2.2.1.1.1.2.1.cmml" xref="S3.E3.m1.2.2.1.1.1.2.1">2</cn></matrixrow><matrixrow id="S3.E3.m1.2.2.1.1b.cmml" xref="S3.E3.m1.2.2.1.1"><cn type="integer" id="S3.E3.m1.2.2.1.1.2.1.1.cmml" xref="S3.E3.m1.2.2.1.1.2.1.1">2</cn><cn type="integer" id="S3.E3.m1.2.2.1.1.2.2.1.cmml" xref="S3.E3.m1.2.2.1.1.2.2.1">6</cn></matrixrow></matrix></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E3.m1.4c">\displaystyle\bm{H}=\nabla^{2}f(\bm{\theta})=\begin{bmatrix}\frac{\partial^{2}f}{\partial\theta_{1}^{2}}&amp;\frac{\partial^{2}f}{\partial\theta_{1}\partial\theta_{2}}\\
\frac{\partial^{2}f}{\partial\theta_{2}\partial\theta_{1}}&amp;\frac{\partial^{2}f}{\partial\theta_{2}^{2}}\end{bmatrix}=\begin{bmatrix}2&amp;2\\
2&amp;6\end{bmatrix}.</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(3)</span></td>
</tr></tbody>
</table>
</div>
<div id="S3.p3" class="ltx_para">
<p id="S3.p3.4" class="ltx_p">The optimal step size to take across a dimension should be proportional to the Hessian entries corresponding to those dimensions. For example, the optimal step size for <math id="S3.p3.1.m1.1" class="ltx_Math" alttext="\theta_{1}" display="inline"><semantics id="S3.p3.1.m1.1a"><msub id="S3.p3.1.m1.1.1" xref="S3.p3.1.m1.1.1.cmml"><mi id="S3.p3.1.m1.1.1.2" xref="S3.p3.1.m1.1.1.2.cmml">θ</mi><mn id="S3.p3.1.m1.1.1.3" xref="S3.p3.1.m1.1.1.3.cmml">1</mn></msub><annotation-xml encoding="MathML-Content" id="S3.p3.1.m1.1b"><apply id="S3.p3.1.m1.1.1.cmml" xref="S3.p3.1.m1.1.1"><csymbol cd="ambiguous" id="S3.p3.1.m1.1.1.1.cmml" xref="S3.p3.1.m1.1.1">subscript</csymbol><ci id="S3.p3.1.m1.1.1.2.cmml" xref="S3.p3.1.m1.1.1.2">𝜃</ci><cn type="integer" id="S3.p3.1.m1.1.1.3.cmml" xref="S3.p3.1.m1.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p3.1.m1.1c">\theta_{1}</annotation></semantics></math> and <math id="S3.p3.2.m2.1" class="ltx_Math" alttext="\theta_{2}" display="inline"><semantics id="S3.p3.2.m2.1a"><msub id="S3.p3.2.m2.1.1" xref="S3.p3.2.m2.1.1.cmml"><mi id="S3.p3.2.m2.1.1.2" xref="S3.p3.2.m2.1.1.2.cmml">θ</mi><mn id="S3.p3.2.m2.1.1.3" xref="S3.p3.2.m2.1.1.3.cmml">2</mn></msub><annotation-xml encoding="MathML-Content" id="S3.p3.2.m2.1b"><apply id="S3.p3.2.m2.1.1.cmml" xref="S3.p3.2.m2.1.1"><csymbol cd="ambiguous" id="S3.p3.2.m2.1.1.1.cmml" xref="S3.p3.2.m2.1.1">subscript</csymbol><ci id="S3.p3.2.m2.1.1.2.cmml" xref="S3.p3.2.m2.1.1.2">𝜃</ci><cn type="integer" id="S3.p3.2.m2.1.1.3.cmml" xref="S3.p3.2.m2.1.1.3">2</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p3.2.m2.1c">\theta_{2}</annotation></semantics></math> should be proportional to <math id="S3.p3.3.m3.1" class="ltx_Math" alttext="1/2" display="inline"><semantics id="S3.p3.3.m3.1a"><mrow id="S3.p3.3.m3.1.1" xref="S3.p3.3.m3.1.1.cmml"><mn id="S3.p3.3.m3.1.1.2" xref="S3.p3.3.m3.1.1.2.cmml">1</mn><mo id="S3.p3.3.m3.1.1.1" xref="S3.p3.3.m3.1.1.1.cmml">/</mo><mn id="S3.p3.3.m3.1.1.3" xref="S3.p3.3.m3.1.1.3.cmml">2</mn></mrow><annotation-xml encoding="MathML-Content" id="S3.p3.3.m3.1b"><apply id="S3.p3.3.m3.1.1.cmml" xref="S3.p3.3.m3.1.1"><divide id="S3.p3.3.m3.1.1.1.cmml" xref="S3.p3.3.m3.1.1.1"></divide><cn type="integer" id="S3.p3.3.m3.1.1.2.cmml" xref="S3.p3.3.m3.1.1.2">1</cn><cn type="integer" id="S3.p3.3.m3.1.1.3.cmml" xref="S3.p3.3.m3.1.1.3">2</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p3.3.m3.1c">1/2</annotation></semantics></math> and <math id="S3.p3.4.m4.1" class="ltx_Math" alttext="1/6" display="inline"><semantics id="S3.p3.4.m4.1a"><mrow id="S3.p3.4.m4.1.1" xref="S3.p3.4.m4.1.1.cmml"><mn id="S3.p3.4.m4.1.1.2" xref="S3.p3.4.m4.1.1.2.cmml">1</mn><mo id="S3.p3.4.m4.1.1.1" xref="S3.p3.4.m4.1.1.1.cmml">/</mo><mn id="S3.p3.4.m4.1.1.3" xref="S3.p3.4.m4.1.1.3.cmml">6</mn></mrow><annotation-xml encoding="MathML-Content" id="S3.p3.4.m4.1b"><apply id="S3.p3.4.m4.1.1.cmml" xref="S3.p3.4.m4.1.1"><divide id="S3.p3.4.m4.1.1.1.cmml" xref="S3.p3.4.m4.1.1.1"></divide><cn type="integer" id="S3.p3.4.m4.1.1.2.cmml" xref="S3.p3.4.m4.1.1.2">1</cn><cn type="integer" id="S3.p3.4.m4.1.1.3.cmml" xref="S3.p3.4.m4.1.1.3">6</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.p3.4.m4.1c">1/6</annotation></semantics></math>, respectively. Those entries are the diagonal of the Hessian. Figure <a href="#S3.F1" title="Figure 1 ‣ III System Model and Problem Formulation ‣ Fed-Sophia: A Communication-Efficient Second-Order Federated Learning Algorithm Identify applicable funding agency here. If none, delete this." class="ltx_ref"><span class="ltx_text ltx_ref_tag">1</span></a> demonstrates the effect of the optimal step size on the convergence. As we can see, the gradient-based method using uniform step size takes a lot of steps to converge, while a Hessian-based method can converge in two steps.</p>
</div>
<figure id="S3.F1" class="ltx_figure"><img src="/html/2406.06655/assets/x1.png" id="S3.F1.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="171" height="134" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span id="S3.F1.2.1.1" class="ltx_text" style="font-size:90%;">Figure 1</span>: </span><span id="S3.F1.3.2" class="ltx_text" style="font-size:90%;">The effect of the Hessian-based step size against the gradient-based method.</span></figcaption>
</figure>
</section>
<section id="S4" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">IV </span><span id="S4.1.1" class="ltx_text ltx_font_smallcaps">Proposed Algorithm</span>
</h2>

<div id="S4.p1" class="ltx_para">
<p id="S4.p1.5" class="ltx_p">Our proposed algorithm, Fed-Sophia, is a second-order method that leverages the Sophia optimizer <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib16" title="" class="ltx_ref">16</a>]</cite> into the FL setting. The algorithm’s computational and communication efficiency is attributed to two primary factors: (i) the lightweight estimation of the Hessian matrix, which, owing to its diagonal structure, is analogous to computing a vector, and (ii) the Hessian estimation does not occur in every communication round. Similar to FedAvg, every device in Fed-Sophia shares its model’s parameters with the PS. Then, the server aggregates the parameters using their average as follows</p>
<table id="Sx1.EGx4" class="ltx_equationgroup ltx_eqn_align ltx_eqn_table">

<tbody id="S4.E4"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math id="S4.E4.m1.1" class="ltx_Math" alttext="\displaystyle\bm{\Theta}^{k+1}=\frac{1}{N}\sum_{i=1}^{N}\bm{\theta}_{i}^{k}," display="inline"><semantics id="S4.E4.m1.1a"><mrow id="S4.E4.m1.1.1.1" xref="S4.E4.m1.1.1.1.1.cmml"><mrow id="S4.E4.m1.1.1.1.1" xref="S4.E4.m1.1.1.1.1.cmml"><msup id="S4.E4.m1.1.1.1.1.2" xref="S4.E4.m1.1.1.1.1.2.cmml"><mi id="S4.E4.m1.1.1.1.1.2.2" xref="S4.E4.m1.1.1.1.1.2.2.cmml">𝚯</mi><mrow id="S4.E4.m1.1.1.1.1.2.3" xref="S4.E4.m1.1.1.1.1.2.3.cmml"><mi id="S4.E4.m1.1.1.1.1.2.3.2" xref="S4.E4.m1.1.1.1.1.2.3.2.cmml">k</mi><mo id="S4.E4.m1.1.1.1.1.2.3.1" xref="S4.E4.m1.1.1.1.1.2.3.1.cmml">+</mo><mn id="S4.E4.m1.1.1.1.1.2.3.3" xref="S4.E4.m1.1.1.1.1.2.3.3.cmml">1</mn></mrow></msup><mo id="S4.E4.m1.1.1.1.1.1" xref="S4.E4.m1.1.1.1.1.1.cmml">=</mo><mrow id="S4.E4.m1.1.1.1.1.3" xref="S4.E4.m1.1.1.1.1.3.cmml"><mstyle displaystyle="true" id="S4.E4.m1.1.1.1.1.3.2" xref="S4.E4.m1.1.1.1.1.3.2.cmml"><mfrac id="S4.E4.m1.1.1.1.1.3.2a" xref="S4.E4.m1.1.1.1.1.3.2.cmml"><mn id="S4.E4.m1.1.1.1.1.3.2.2" xref="S4.E4.m1.1.1.1.1.3.2.2.cmml">1</mn><mi id="S4.E4.m1.1.1.1.1.3.2.3" xref="S4.E4.m1.1.1.1.1.3.2.3.cmml">N</mi></mfrac></mstyle><mo lspace="0em" rspace="0em" id="S4.E4.m1.1.1.1.1.3.1" xref="S4.E4.m1.1.1.1.1.3.1.cmml">​</mo><mrow id="S4.E4.m1.1.1.1.1.3.3" xref="S4.E4.m1.1.1.1.1.3.3.cmml"><mstyle displaystyle="true" id="S4.E4.m1.1.1.1.1.3.3.1" xref="S4.E4.m1.1.1.1.1.3.3.1.cmml"><munderover id="S4.E4.m1.1.1.1.1.3.3.1a" xref="S4.E4.m1.1.1.1.1.3.3.1.cmml"><mo movablelimits="false" id="S4.E4.m1.1.1.1.1.3.3.1.2.2" xref="S4.E4.m1.1.1.1.1.3.3.1.2.2.cmml">∑</mo><mrow id="S4.E4.m1.1.1.1.1.3.3.1.2.3" xref="S4.E4.m1.1.1.1.1.3.3.1.2.3.cmml"><mi id="S4.E4.m1.1.1.1.1.3.3.1.2.3.2" xref="S4.E4.m1.1.1.1.1.3.3.1.2.3.2.cmml">i</mi><mo id="S4.E4.m1.1.1.1.1.3.3.1.2.3.1" xref="S4.E4.m1.1.1.1.1.3.3.1.2.3.1.cmml">=</mo><mn id="S4.E4.m1.1.1.1.1.3.3.1.2.3.3" xref="S4.E4.m1.1.1.1.1.3.3.1.2.3.3.cmml">1</mn></mrow><mi id="S4.E4.m1.1.1.1.1.3.3.1.3" xref="S4.E4.m1.1.1.1.1.3.3.1.3.cmml">N</mi></munderover></mstyle><msubsup id="S4.E4.m1.1.1.1.1.3.3.2" xref="S4.E4.m1.1.1.1.1.3.3.2.cmml"><mi id="S4.E4.m1.1.1.1.1.3.3.2.2.2" xref="S4.E4.m1.1.1.1.1.3.3.2.2.2.cmml">𝜽</mi><mi id="S4.E4.m1.1.1.1.1.3.3.2.2.3" xref="S4.E4.m1.1.1.1.1.3.3.2.2.3.cmml">i</mi><mi id="S4.E4.m1.1.1.1.1.3.3.2.3" xref="S4.E4.m1.1.1.1.1.3.3.2.3.cmml">k</mi></msubsup></mrow></mrow></mrow><mo id="S4.E4.m1.1.1.1.2" xref="S4.E4.m1.1.1.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.E4.m1.1b"><apply id="S4.E4.m1.1.1.1.1.cmml" xref="S4.E4.m1.1.1.1"><eq id="S4.E4.m1.1.1.1.1.1.cmml" xref="S4.E4.m1.1.1.1.1.1"></eq><apply id="S4.E4.m1.1.1.1.1.2.cmml" xref="S4.E4.m1.1.1.1.1.2"><csymbol cd="ambiguous" id="S4.E4.m1.1.1.1.1.2.1.cmml" xref="S4.E4.m1.1.1.1.1.2">superscript</csymbol><ci id="S4.E4.m1.1.1.1.1.2.2.cmml" xref="S4.E4.m1.1.1.1.1.2.2">𝚯</ci><apply id="S4.E4.m1.1.1.1.1.2.3.cmml" xref="S4.E4.m1.1.1.1.1.2.3"><plus id="S4.E4.m1.1.1.1.1.2.3.1.cmml" xref="S4.E4.m1.1.1.1.1.2.3.1"></plus><ci id="S4.E4.m1.1.1.1.1.2.3.2.cmml" xref="S4.E4.m1.1.1.1.1.2.3.2">𝑘</ci><cn type="integer" id="S4.E4.m1.1.1.1.1.2.3.3.cmml" xref="S4.E4.m1.1.1.1.1.2.3.3">1</cn></apply></apply><apply id="S4.E4.m1.1.1.1.1.3.cmml" xref="S4.E4.m1.1.1.1.1.3"><times id="S4.E4.m1.1.1.1.1.3.1.cmml" xref="S4.E4.m1.1.1.1.1.3.1"></times><apply id="S4.E4.m1.1.1.1.1.3.2.cmml" xref="S4.E4.m1.1.1.1.1.3.2"><divide id="S4.E4.m1.1.1.1.1.3.2.1.cmml" xref="S4.E4.m1.1.1.1.1.3.2"></divide><cn type="integer" id="S4.E4.m1.1.1.1.1.3.2.2.cmml" xref="S4.E4.m1.1.1.1.1.3.2.2">1</cn><ci id="S4.E4.m1.1.1.1.1.3.2.3.cmml" xref="S4.E4.m1.1.1.1.1.3.2.3">𝑁</ci></apply><apply id="S4.E4.m1.1.1.1.1.3.3.cmml" xref="S4.E4.m1.1.1.1.1.3.3"><apply id="S4.E4.m1.1.1.1.1.3.3.1.cmml" xref="S4.E4.m1.1.1.1.1.3.3.1"><csymbol cd="ambiguous" id="S4.E4.m1.1.1.1.1.3.3.1.1.cmml" xref="S4.E4.m1.1.1.1.1.3.3.1">superscript</csymbol><apply id="S4.E4.m1.1.1.1.1.3.3.1.2.cmml" xref="S4.E4.m1.1.1.1.1.3.3.1"><csymbol cd="ambiguous" id="S4.E4.m1.1.1.1.1.3.3.1.2.1.cmml" xref="S4.E4.m1.1.1.1.1.3.3.1">subscript</csymbol><sum id="S4.E4.m1.1.1.1.1.3.3.1.2.2.cmml" xref="S4.E4.m1.1.1.1.1.3.3.1.2.2"></sum><apply id="S4.E4.m1.1.1.1.1.3.3.1.2.3.cmml" xref="S4.E4.m1.1.1.1.1.3.3.1.2.3"><eq id="S4.E4.m1.1.1.1.1.3.3.1.2.3.1.cmml" xref="S4.E4.m1.1.1.1.1.3.3.1.2.3.1"></eq><ci id="S4.E4.m1.1.1.1.1.3.3.1.2.3.2.cmml" xref="S4.E4.m1.1.1.1.1.3.3.1.2.3.2">𝑖</ci><cn type="integer" id="S4.E4.m1.1.1.1.1.3.3.1.2.3.3.cmml" xref="S4.E4.m1.1.1.1.1.3.3.1.2.3.3">1</cn></apply></apply><ci id="S4.E4.m1.1.1.1.1.3.3.1.3.cmml" xref="S4.E4.m1.1.1.1.1.3.3.1.3">𝑁</ci></apply><apply id="S4.E4.m1.1.1.1.1.3.3.2.cmml" xref="S4.E4.m1.1.1.1.1.3.3.2"><csymbol cd="ambiguous" id="S4.E4.m1.1.1.1.1.3.3.2.1.cmml" xref="S4.E4.m1.1.1.1.1.3.3.2">superscript</csymbol><apply id="S4.E4.m1.1.1.1.1.3.3.2.2.cmml" xref="S4.E4.m1.1.1.1.1.3.3.2"><csymbol cd="ambiguous" id="S4.E4.m1.1.1.1.1.3.3.2.2.1.cmml" xref="S4.E4.m1.1.1.1.1.3.3.2">subscript</csymbol><ci id="S4.E4.m1.1.1.1.1.3.3.2.2.2.cmml" xref="S4.E4.m1.1.1.1.1.3.3.2.2.2">𝜽</ci><ci id="S4.E4.m1.1.1.1.1.3.3.2.2.3.cmml" xref="S4.E4.m1.1.1.1.1.3.3.2.2.3">𝑖</ci></apply><ci id="S4.E4.m1.1.1.1.1.3.3.2.3.cmml" xref="S4.E4.m1.1.1.1.1.3.3.2.3">𝑘</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.E4.m1.1c">\displaystyle\bm{\Theta}^{k+1}=\frac{1}{N}\sum_{i=1}^{N}\bm{\theta}_{i}^{k},</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(4)</span></td>
</tr></tbody>
</table>
<p id="S4.p1.4" class="ltx_p">where <math id="S4.p1.1.m1.1" class="ltx_Math" alttext="\bm{\Theta}" display="inline"><semantics id="S4.p1.1.m1.1a"><mi id="S4.p1.1.m1.1.1" xref="S4.p1.1.m1.1.1.cmml">𝚯</mi><annotation-xml encoding="MathML-Content" id="S4.p1.1.m1.1b"><ci id="S4.p1.1.m1.1.1.cmml" xref="S4.p1.1.m1.1.1">𝚯</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.p1.1.m1.1c">\bm{\Theta}</annotation></semantics></math> is the server’s parameters at iteration <math id="S4.p1.2.m2.1" class="ltx_Math" alttext="(k+1)" display="inline"><semantics id="S4.p1.2.m2.1a"><mrow id="S4.p1.2.m2.1.1.1" xref="S4.p1.2.m2.1.1.1.1.cmml"><mo stretchy="false" id="S4.p1.2.m2.1.1.1.2" xref="S4.p1.2.m2.1.1.1.1.cmml">(</mo><mrow id="S4.p1.2.m2.1.1.1.1" xref="S4.p1.2.m2.1.1.1.1.cmml"><mi id="S4.p1.2.m2.1.1.1.1.2" xref="S4.p1.2.m2.1.1.1.1.2.cmml">k</mi><mo id="S4.p1.2.m2.1.1.1.1.1" xref="S4.p1.2.m2.1.1.1.1.1.cmml">+</mo><mn id="S4.p1.2.m2.1.1.1.1.3" xref="S4.p1.2.m2.1.1.1.1.3.cmml">1</mn></mrow><mo stretchy="false" id="S4.p1.2.m2.1.1.1.3" xref="S4.p1.2.m2.1.1.1.1.cmml">)</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.p1.2.m2.1b"><apply id="S4.p1.2.m2.1.1.1.1.cmml" xref="S4.p1.2.m2.1.1.1"><plus id="S4.p1.2.m2.1.1.1.1.1.cmml" xref="S4.p1.2.m2.1.1.1.1.1"></plus><ci id="S4.p1.2.m2.1.1.1.1.2.cmml" xref="S4.p1.2.m2.1.1.1.1.2">𝑘</ci><cn type="integer" id="S4.p1.2.m2.1.1.1.1.3.cmml" xref="S4.p1.2.m2.1.1.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.p1.2.m2.1c">(k+1)</annotation></semantics></math>, and <math id="S4.p1.3.m3.1" class="ltx_Math" alttext="\bm{\theta}_{i}" display="inline"><semantics id="S4.p1.3.m3.1a"><msub id="S4.p1.3.m3.1.1" xref="S4.p1.3.m3.1.1.cmml"><mi id="S4.p1.3.m3.1.1.2" xref="S4.p1.3.m3.1.1.2.cmml">𝜽</mi><mi id="S4.p1.3.m3.1.1.3" xref="S4.p1.3.m3.1.1.3.cmml">i</mi></msub><annotation-xml encoding="MathML-Content" id="S4.p1.3.m3.1b"><apply id="S4.p1.3.m3.1.1.cmml" xref="S4.p1.3.m3.1.1"><csymbol cd="ambiguous" id="S4.p1.3.m3.1.1.1.cmml" xref="S4.p1.3.m3.1.1">subscript</csymbol><ci id="S4.p1.3.m3.1.1.2.cmml" xref="S4.p1.3.m3.1.1.2">𝜽</ci><ci id="S4.p1.3.m3.1.1.3.cmml" xref="S4.p1.3.m3.1.1.3">𝑖</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.p1.3.m3.1c">\bm{\theta}_{i}</annotation></semantics></math> is the model’s parameters of the <math id="S4.p1.4.m4.1" class="ltx_Math" alttext="i" display="inline"><semantics id="S4.p1.4.m4.1a"><mi id="S4.p1.4.m4.1.1" xref="S4.p1.4.m4.1.1.cmml">i</mi><annotation-xml encoding="MathML-Content" id="S4.p1.4.m4.1b"><ci id="S4.p1.4.m4.1.1.cmml" xref="S4.p1.4.m4.1.1">𝑖</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.p1.4.m4.1c">i</annotation></semantics></math>th device. As shown in<cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib1" title="" class="ltx_ref">1</a>, <a href="#bib.bib17" title="" class="ltx_ref">17</a>]</cite>, this idea of averaging the models works surprisingly well with over-parameterized NNs.</p>
</div>
<figure id="alg1" class="ltx_float ltx_algorithm">
<div id="alg1.2" class="ltx_listing ltx_lst_numbers_left ltx_listing">
<div id="alg1.2.2" class="ltx_listingline">






















































<div id="alg1.2.2.2" class="ltx_listing ltx_listing">
<div id="alg1.l1" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg1.l1.1.1.1" class="ltx_text" style="font-size:80%;">1:</span></span>  <span id="alg1.l1.2" class="ltx_text ltx_font_bold">Parameters:</span> learning rate <math id="alg1.l1.m1.1" class="ltx_Math" alttext="\eta" display="inline"><semantics id="alg1.l1.m1.1a"><mi id="alg1.l1.m1.1.1" xref="alg1.l1.m1.1.1.cmml">η</mi><annotation-xml encoding="MathML-Content" id="alg1.l1.m1.1b"><ci id="alg1.l1.m1.1.1.cmml" xref="alg1.l1.m1.1.1">𝜂</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.l1.m1.1c">\eta</annotation></semantics></math>, number of local iterations <math id="alg1.l1.m2.1" class="ltx_Math" alttext="J" display="inline"><semantics id="alg1.l1.m2.1a"><mi id="alg1.l1.m2.1.1" xref="alg1.l1.m2.1.1.cmml">J</mi><annotation-xml encoding="MathML-Content" id="alg1.l1.m2.1b"><ci id="alg1.l1.m2.1.1.cmml" xref="alg1.l1.m2.1.1">𝐽</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.l1.m2.1c">J</annotation></semantics></math>, hyperparameters <math id="alg1.l1.m3.6" class="ltx_Math" alttext="(\lambda,\beta_{1},\beta_{2},\epsilon,\rho,\tau)" display="inline"><semantics id="alg1.l1.m3.6a"><mrow id="alg1.l1.m3.6.6.2" xref="alg1.l1.m3.6.6.3.cmml"><mo stretchy="false" id="alg1.l1.m3.6.6.2.3" xref="alg1.l1.m3.6.6.3.cmml">(</mo><mi id="alg1.l1.m3.1.1" xref="alg1.l1.m3.1.1.cmml">λ</mi><mo id="alg1.l1.m3.6.6.2.4" xref="alg1.l1.m3.6.6.3.cmml">,</mo><msub id="alg1.l1.m3.5.5.1.1" xref="alg1.l1.m3.5.5.1.1.cmml"><mi id="alg1.l1.m3.5.5.1.1.2" xref="alg1.l1.m3.5.5.1.1.2.cmml">β</mi><mn id="alg1.l1.m3.5.5.1.1.3" xref="alg1.l1.m3.5.5.1.1.3.cmml">1</mn></msub><mo id="alg1.l1.m3.6.6.2.5" xref="alg1.l1.m3.6.6.3.cmml">,</mo><msub id="alg1.l1.m3.6.6.2.2" xref="alg1.l1.m3.6.6.2.2.cmml"><mi id="alg1.l1.m3.6.6.2.2.2" xref="alg1.l1.m3.6.6.2.2.2.cmml">β</mi><mn id="alg1.l1.m3.6.6.2.2.3" xref="alg1.l1.m3.6.6.2.2.3.cmml">2</mn></msub><mo id="alg1.l1.m3.6.6.2.6" xref="alg1.l1.m3.6.6.3.cmml">,</mo><mi id="alg1.l1.m3.2.2" xref="alg1.l1.m3.2.2.cmml">ϵ</mi><mo id="alg1.l1.m3.6.6.2.7" xref="alg1.l1.m3.6.6.3.cmml">,</mo><mi id="alg1.l1.m3.3.3" xref="alg1.l1.m3.3.3.cmml">ρ</mi><mo id="alg1.l1.m3.6.6.2.8" xref="alg1.l1.m3.6.6.3.cmml">,</mo><mi id="alg1.l1.m3.4.4" xref="alg1.l1.m3.4.4.cmml">τ</mi><mo stretchy="false" id="alg1.l1.m3.6.6.2.9" xref="alg1.l1.m3.6.6.3.cmml">)</mo></mrow><annotation-xml encoding="MathML-Content" id="alg1.l1.m3.6b"><vector id="alg1.l1.m3.6.6.3.cmml" xref="alg1.l1.m3.6.6.2"><ci id="alg1.l1.m3.1.1.cmml" xref="alg1.l1.m3.1.1">𝜆</ci><apply id="alg1.l1.m3.5.5.1.1.cmml" xref="alg1.l1.m3.5.5.1.1"><csymbol cd="ambiguous" id="alg1.l1.m3.5.5.1.1.1.cmml" xref="alg1.l1.m3.5.5.1.1">subscript</csymbol><ci id="alg1.l1.m3.5.5.1.1.2.cmml" xref="alg1.l1.m3.5.5.1.1.2">𝛽</ci><cn type="integer" id="alg1.l1.m3.5.5.1.1.3.cmml" xref="alg1.l1.m3.5.5.1.1.3">1</cn></apply><apply id="alg1.l1.m3.6.6.2.2.cmml" xref="alg1.l1.m3.6.6.2.2"><csymbol cd="ambiguous" id="alg1.l1.m3.6.6.2.2.1.cmml" xref="alg1.l1.m3.6.6.2.2">subscript</csymbol><ci id="alg1.l1.m3.6.6.2.2.2.cmml" xref="alg1.l1.m3.6.6.2.2.2">𝛽</ci><cn type="integer" id="alg1.l1.m3.6.6.2.2.3.cmml" xref="alg1.l1.m3.6.6.2.2.3">2</cn></apply><ci id="alg1.l1.m3.2.2.cmml" xref="alg1.l1.m3.2.2">italic-ϵ</ci><ci id="alg1.l1.m3.3.3.cmml" xref="alg1.l1.m3.3.3">𝜌</ci><ci id="alg1.l1.m3.4.4.cmml" xref="alg1.l1.m3.4.4">𝜏</ci></vector></annotation-xml><annotation encoding="application/x-tex" id="alg1.l1.m3.6c">(\lambda,\beta_{1},\beta_{2},\epsilon,\rho,\tau)</annotation></semantics></math>.

</div>
<div id="alg1.l2" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg1.l2.1.1.1" class="ltx_text" style="font-size:80%;">2:</span></span>  <span id="alg1.l2.2" class="ltx_text ltx_font_bold">Initialize:</span> <math id="alg1.l2.m1.1" class="ltx_Math" alttext="\bm{\Theta}^{0}" display="inline"><semantics id="alg1.l2.m1.1a"><msup id="alg1.l2.m1.1.1" xref="alg1.l2.m1.1.1.cmml"><mi id="alg1.l2.m1.1.1.2" xref="alg1.l2.m1.1.1.2.cmml">𝚯</mi><mn id="alg1.l2.m1.1.1.3" xref="alg1.l2.m1.1.1.3.cmml">0</mn></msup><annotation-xml encoding="MathML-Content" id="alg1.l2.m1.1b"><apply id="alg1.l2.m1.1.1.cmml" xref="alg1.l2.m1.1.1"><csymbol cd="ambiguous" id="alg1.l2.m1.1.1.1.cmml" xref="alg1.l2.m1.1.1">superscript</csymbol><ci id="alg1.l2.m1.1.1.2.cmml" xref="alg1.l2.m1.1.1.2">𝚯</ci><cn type="integer" id="alg1.l2.m1.1.1.3.cmml" xref="alg1.l2.m1.1.1.3">0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l2.m1.1c">\bm{\Theta}^{0}</annotation></semantics></math>, <math id="alg1.l2.m2.1" class="ltx_Math" alttext="\bm{m}^{0}=\bm{0}" display="inline"><semantics id="alg1.l2.m2.1a"><mrow id="alg1.l2.m2.1.1" xref="alg1.l2.m2.1.1.cmml"><msup id="alg1.l2.m2.1.1.2" xref="alg1.l2.m2.1.1.2.cmml"><mi id="alg1.l2.m2.1.1.2.2" xref="alg1.l2.m2.1.1.2.2.cmml">𝒎</mi><mn id="alg1.l2.m2.1.1.2.3" xref="alg1.l2.m2.1.1.2.3.cmml">0</mn></msup><mo id="alg1.l2.m2.1.1.1" xref="alg1.l2.m2.1.1.1.cmml">=</mo><mn id="alg1.l2.m2.1.1.3" xref="alg1.l2.m2.1.1.3.cmml">𝟎</mn></mrow><annotation-xml encoding="MathML-Content" id="alg1.l2.m2.1b"><apply id="alg1.l2.m2.1.1.cmml" xref="alg1.l2.m2.1.1"><eq id="alg1.l2.m2.1.1.1.cmml" xref="alg1.l2.m2.1.1.1"></eq><apply id="alg1.l2.m2.1.1.2.cmml" xref="alg1.l2.m2.1.1.2"><csymbol cd="ambiguous" id="alg1.l2.m2.1.1.2.1.cmml" xref="alg1.l2.m2.1.1.2">superscript</csymbol><ci id="alg1.l2.m2.1.1.2.2.cmml" xref="alg1.l2.m2.1.1.2.2">𝒎</ci><cn type="integer" id="alg1.l2.m2.1.1.2.3.cmml" xref="alg1.l2.m2.1.1.2.3">0</cn></apply><cn type="integer" id="alg1.l2.m2.1.1.3.cmml" xref="alg1.l2.m2.1.1.3">0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l2.m2.1c">\bm{m}^{0}=\bm{0}</annotation></semantics></math>, <math id="alg1.l2.m3.1" class="ltx_Math" alttext="\bm{h}_{i}^{-\tau}=\bm{0}" display="inline"><semantics id="alg1.l2.m3.1a"><mrow id="alg1.l2.m3.1.1" xref="alg1.l2.m3.1.1.cmml"><msubsup id="alg1.l2.m3.1.1.2" xref="alg1.l2.m3.1.1.2.cmml"><mi id="alg1.l2.m3.1.1.2.2.2" xref="alg1.l2.m3.1.1.2.2.2.cmml">𝒉</mi><mi id="alg1.l2.m3.1.1.2.2.3" xref="alg1.l2.m3.1.1.2.2.3.cmml">i</mi><mrow id="alg1.l2.m3.1.1.2.3" xref="alg1.l2.m3.1.1.2.3.cmml"><mo id="alg1.l2.m3.1.1.2.3a" xref="alg1.l2.m3.1.1.2.3.cmml">−</mo><mi id="alg1.l2.m3.1.1.2.3.2" xref="alg1.l2.m3.1.1.2.3.2.cmml">τ</mi></mrow></msubsup><mo id="alg1.l2.m3.1.1.1" xref="alg1.l2.m3.1.1.1.cmml">=</mo><mn id="alg1.l2.m3.1.1.3" xref="alg1.l2.m3.1.1.3.cmml">𝟎</mn></mrow><annotation-xml encoding="MathML-Content" id="alg1.l2.m3.1b"><apply id="alg1.l2.m3.1.1.cmml" xref="alg1.l2.m3.1.1"><eq id="alg1.l2.m3.1.1.1.cmml" xref="alg1.l2.m3.1.1.1"></eq><apply id="alg1.l2.m3.1.1.2.cmml" xref="alg1.l2.m3.1.1.2"><csymbol cd="ambiguous" id="alg1.l2.m3.1.1.2.1.cmml" xref="alg1.l2.m3.1.1.2">superscript</csymbol><apply id="alg1.l2.m3.1.1.2.2.cmml" xref="alg1.l2.m3.1.1.2"><csymbol cd="ambiguous" id="alg1.l2.m3.1.1.2.2.1.cmml" xref="alg1.l2.m3.1.1.2">subscript</csymbol><ci id="alg1.l2.m3.1.1.2.2.2.cmml" xref="alg1.l2.m3.1.1.2.2.2">𝒉</ci><ci id="alg1.l2.m3.1.1.2.2.3.cmml" xref="alg1.l2.m3.1.1.2.2.3">𝑖</ci></apply><apply id="alg1.l2.m3.1.1.2.3.cmml" xref="alg1.l2.m3.1.1.2.3"><minus id="alg1.l2.m3.1.1.2.3.1.cmml" xref="alg1.l2.m3.1.1.2.3"></minus><ci id="alg1.l2.m3.1.1.2.3.2.cmml" xref="alg1.l2.m3.1.1.2.3.2">𝜏</ci></apply></apply><cn type="integer" id="alg1.l2.m3.1.1.3.cmml" xref="alg1.l2.m3.1.1.3">0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l2.m3.1c">\bm{h}_{i}^{-\tau}=\bm{0}</annotation></semantics></math>

</div>
<div id="alg1.l3" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg1.l3.1.1.1" class="ltx_text" style="font-size:80%;">3:</span></span>  <span id="alg1.l3.2" class="ltx_text ltx_font_bold">for</span> communication round <math id="alg1.l3.m1.1" class="ltx_Math" alttext="k=0" display="inline"><semantics id="alg1.l3.m1.1a"><mrow id="alg1.l3.m1.1.1" xref="alg1.l3.m1.1.1.cmml"><mi id="alg1.l3.m1.1.1.2" xref="alg1.l3.m1.1.1.2.cmml">k</mi><mo id="alg1.l3.m1.1.1.1" xref="alg1.l3.m1.1.1.1.cmml">=</mo><mn id="alg1.l3.m1.1.1.3" xref="alg1.l3.m1.1.1.3.cmml">0</mn></mrow><annotation-xml encoding="MathML-Content" id="alg1.l3.m1.1b"><apply id="alg1.l3.m1.1.1.cmml" xref="alg1.l3.m1.1.1"><eq id="alg1.l3.m1.1.1.1.cmml" xref="alg1.l3.m1.1.1.1"></eq><ci id="alg1.l3.m1.1.1.2.cmml" xref="alg1.l3.m1.1.1.2">𝑘</ci><cn type="integer" id="alg1.l3.m1.1.1.3.cmml" xref="alg1.l3.m1.1.1.3">0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l3.m1.1c">k=0</annotation></semantics></math> to <math id="alg1.l3.m2.1" class="ltx_Math" alttext="K" display="inline"><semantics id="alg1.l3.m2.1a"><mi id="alg1.l3.m2.1.1" xref="alg1.l3.m2.1.1.cmml">K</mi><annotation-xml encoding="MathML-Content" id="alg1.l3.m2.1b"><ci id="alg1.l3.m2.1.1.cmml" xref="alg1.l3.m2.1.1">𝐾</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.l3.m2.1c">K</annotation></semantics></math> <span id="alg1.l3.3" class="ltx_text ltx_font_bold">do</span>



</div>
<div id="alg1.l4" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg1.l4.1.1.1" class="ltx_text" style="font-size:80%;">4:</span></span>     <span id="alg1.l4.2" class="ltx_text ltx_font_bold">for</span> each device <math id="alg1.l4.m1.1" class="ltx_Math" alttext="i\in[N]" display="inline"><semantics id="alg1.l4.m1.1a"><mrow id="alg1.l4.m1.1.2" xref="alg1.l4.m1.1.2.cmml"><mi id="alg1.l4.m1.1.2.2" xref="alg1.l4.m1.1.2.2.cmml">i</mi><mo id="alg1.l4.m1.1.2.1" xref="alg1.l4.m1.1.2.1.cmml">∈</mo><mrow id="alg1.l4.m1.1.2.3.2" xref="alg1.l4.m1.1.2.3.1.cmml"><mo stretchy="false" id="alg1.l4.m1.1.2.3.2.1" xref="alg1.l4.m1.1.2.3.1.1.cmml">[</mo><mi id="alg1.l4.m1.1.1" xref="alg1.l4.m1.1.1.cmml">N</mi><mo stretchy="false" id="alg1.l4.m1.1.2.3.2.2" xref="alg1.l4.m1.1.2.3.1.1.cmml">]</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l4.m1.1b"><apply id="alg1.l4.m1.1.2.cmml" xref="alg1.l4.m1.1.2"><in id="alg1.l4.m1.1.2.1.cmml" xref="alg1.l4.m1.1.2.1"></in><ci id="alg1.l4.m1.1.2.2.cmml" xref="alg1.l4.m1.1.2.2">𝑖</ci><apply id="alg1.l4.m1.1.2.3.1.cmml" xref="alg1.l4.m1.1.2.3.2"><csymbol cd="latexml" id="alg1.l4.m1.1.2.3.1.1.cmml" xref="alg1.l4.m1.1.2.3.2.1">delimited-[]</csymbol><ci id="alg1.l4.m1.1.1.cmml" xref="alg1.l4.m1.1.1">𝑁</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l4.m1.1c">i\in[N]</annotation></semantics></math> <span id="alg1.l4.3" class="ltx_text ltx_font_bold">do</span>



</div>
<div id="alg1.l5" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">1</span><span class="ltx_tag ltx_tag_listingline"><span id="alg1.l5.1.1.1" class="ltx_text" style="font-size:80%;">5:</span></span>        Receive the global model <math id="alg1.l5.m1.1" class="ltx_Math" alttext="\bm{\Theta}^{k}" display="inline"><semantics id="alg1.l5.m1.1a"><msup id="alg1.l5.m1.1.1" xref="alg1.l5.m1.1.1.cmml"><mi id="alg1.l5.m1.1.1.2" xref="alg1.l5.m1.1.1.2.cmml">𝚯</mi><mi id="alg1.l5.m1.1.1.3" xref="alg1.l5.m1.1.1.3.cmml">k</mi></msup><annotation-xml encoding="MathML-Content" id="alg1.l5.m1.1b"><apply id="alg1.l5.m1.1.1.cmml" xref="alg1.l5.m1.1.1"><csymbol cd="ambiguous" id="alg1.l5.m1.1.1.1.cmml" xref="alg1.l5.m1.1.1">superscript</csymbol><ci id="alg1.l5.m1.1.1.2.cmml" xref="alg1.l5.m1.1.1.2">𝚯</ci><ci id="alg1.l5.m1.1.1.3.cmml" xref="alg1.l5.m1.1.1.3">𝑘</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l5.m1.1c">\bm{\Theta}^{k}</annotation></semantics></math> and set the local
<br class="ltx_break">model as <math id="alg1.l5.m2.1" class="ltx_Math" alttext="\bm{\theta}_{i}^{k}=\bm{\Theta}^{k}" display="inline"><semantics id="alg1.l5.m2.1a"><mrow id="alg1.l5.m2.1.1" xref="alg1.l5.m2.1.1.cmml"><msubsup id="alg1.l5.m2.1.1.2" xref="alg1.l5.m2.1.1.2.cmml"><mi id="alg1.l5.m2.1.1.2.2.2" xref="alg1.l5.m2.1.1.2.2.2.cmml">𝜽</mi><mi id="alg1.l5.m2.1.1.2.2.3" xref="alg1.l5.m2.1.1.2.2.3.cmml">i</mi><mi id="alg1.l5.m2.1.1.2.3" xref="alg1.l5.m2.1.1.2.3.cmml">k</mi></msubsup><mo id="alg1.l5.m2.1.1.1" xref="alg1.l5.m2.1.1.1.cmml">=</mo><msup id="alg1.l5.m2.1.1.3" xref="alg1.l5.m2.1.1.3.cmml"><mi id="alg1.l5.m2.1.1.3.2" xref="alg1.l5.m2.1.1.3.2.cmml">𝚯</mi><mi id="alg1.l5.m2.1.1.3.3" xref="alg1.l5.m2.1.1.3.3.cmml">k</mi></msup></mrow><annotation-xml encoding="MathML-Content" id="alg1.l5.m2.1b"><apply id="alg1.l5.m2.1.1.cmml" xref="alg1.l5.m2.1.1"><eq id="alg1.l5.m2.1.1.1.cmml" xref="alg1.l5.m2.1.1.1"></eq><apply id="alg1.l5.m2.1.1.2.cmml" xref="alg1.l5.m2.1.1.2"><csymbol cd="ambiguous" id="alg1.l5.m2.1.1.2.1.cmml" xref="alg1.l5.m2.1.1.2">superscript</csymbol><apply id="alg1.l5.m2.1.1.2.2.cmml" xref="alg1.l5.m2.1.1.2"><csymbol cd="ambiguous" id="alg1.l5.m2.1.1.2.2.1.cmml" xref="alg1.l5.m2.1.1.2">subscript</csymbol><ci id="alg1.l5.m2.1.1.2.2.2.cmml" xref="alg1.l5.m2.1.1.2.2.2">𝜽</ci><ci id="alg1.l5.m2.1.1.2.2.3.cmml" xref="alg1.l5.m2.1.1.2.2.3">𝑖</ci></apply><ci id="alg1.l5.m2.1.1.2.3.cmml" xref="alg1.l5.m2.1.1.2.3">𝑘</ci></apply><apply id="alg1.l5.m2.1.1.3.cmml" xref="alg1.l5.m2.1.1.3"><csymbol cd="ambiguous" id="alg1.l5.m2.1.1.3.1.cmml" xref="alg1.l5.m2.1.1.3">superscript</csymbol><ci id="alg1.l5.m2.1.1.3.2.cmml" xref="alg1.l5.m2.1.1.3.2">𝚯</ci><ci id="alg1.l5.m2.1.1.3.3.cmml" xref="alg1.l5.m2.1.1.3.3">𝑘</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l5.m2.1c">\bm{\theta}_{i}^{k}=\bm{\Theta}^{k}</annotation></semantics></math> 
</div>
<div id="alg1.2.2.2.3" class="ltx_listingline">
</div>
<div id="alg1.l6" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg1.l6.1.1.1" class="ltx_text" style="font-size:80%;">6:</span></span>        <span id="alg1.l6.2" class="ltx_text ltx_font_bold">for</span> local iterations <math id="alg1.l6.m1.1" class="ltx_Math" alttext="j=0" display="inline"><semantics id="alg1.l6.m1.1a"><mrow id="alg1.l6.m1.1.1" xref="alg1.l6.m1.1.1.cmml"><mi id="alg1.l6.m1.1.1.2" xref="alg1.l6.m1.1.1.2.cmml">j</mi><mo id="alg1.l6.m1.1.1.1" xref="alg1.l6.m1.1.1.1.cmml">=</mo><mn id="alg1.l6.m1.1.1.3" xref="alg1.l6.m1.1.1.3.cmml">0</mn></mrow><annotation-xml encoding="MathML-Content" id="alg1.l6.m1.1b"><apply id="alg1.l6.m1.1.1.cmml" xref="alg1.l6.m1.1.1"><eq id="alg1.l6.m1.1.1.1.cmml" xref="alg1.l6.m1.1.1.1"></eq><ci id="alg1.l6.m1.1.1.2.cmml" xref="alg1.l6.m1.1.1.2">𝑗</ci><cn type="integer" id="alg1.l6.m1.1.1.3.cmml" xref="alg1.l6.m1.1.1.3">0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l6.m1.1c">j=0</annotation></semantics></math> to <math id="alg1.l6.m2.1" class="ltx_Math" alttext="J" display="inline"><semantics id="alg1.l6.m2.1a"><mi id="alg1.l6.m2.1.1" xref="alg1.l6.m2.1.1.cmml">J</mi><annotation-xml encoding="MathML-Content" id="alg1.l6.m2.1b"><ci id="alg1.l6.m2.1.1.cmml" xref="alg1.l6.m2.1.1">𝐽</ci></annotation-xml><annotation encoding="application/x-tex" id="alg1.l6.m2.1c">J</annotation></semantics></math> <span id="alg1.l6.3" class="ltx_text ltx_font_bold">do</span>



</div>
<div id="alg1.l7" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg1.l7.1.1.1" class="ltx_text" style="font-size:80%;">7:</span></span>           Compute the local gradient <math id="alg1.l7.m1.1" class="ltx_Math" alttext="\bm{g}_{i}^{k}=\nabla h_{i}(\bm{\theta}_{i}^{k})" display="inline"><semantics id="alg1.l7.m1.1a"><mrow id="alg1.l7.m1.1.1" xref="alg1.l7.m1.1.1.cmml"><msubsup id="alg1.l7.m1.1.1.3" xref="alg1.l7.m1.1.1.3.cmml"><mi id="alg1.l7.m1.1.1.3.2.2" xref="alg1.l7.m1.1.1.3.2.2.cmml">𝒈</mi><mi id="alg1.l7.m1.1.1.3.2.3" xref="alg1.l7.m1.1.1.3.2.3.cmml">i</mi><mi id="alg1.l7.m1.1.1.3.3" xref="alg1.l7.m1.1.1.3.3.cmml">k</mi></msubsup><mo id="alg1.l7.m1.1.1.2" xref="alg1.l7.m1.1.1.2.cmml">=</mo><mrow id="alg1.l7.m1.1.1.1" xref="alg1.l7.m1.1.1.1.cmml"><mrow id="alg1.l7.m1.1.1.1.3" xref="alg1.l7.m1.1.1.1.3.cmml"><mo rspace="0.167em" id="alg1.l7.m1.1.1.1.3.1" xref="alg1.l7.m1.1.1.1.3.1.cmml">∇</mo><msub id="alg1.l7.m1.1.1.1.3.2" xref="alg1.l7.m1.1.1.1.3.2.cmml"><mi id="alg1.l7.m1.1.1.1.3.2.2" xref="alg1.l7.m1.1.1.1.3.2.2.cmml">h</mi><mi id="alg1.l7.m1.1.1.1.3.2.3" xref="alg1.l7.m1.1.1.1.3.2.3.cmml">i</mi></msub></mrow><mo lspace="0em" rspace="0em" id="alg1.l7.m1.1.1.1.2" xref="alg1.l7.m1.1.1.1.2.cmml">​</mo><mrow id="alg1.l7.m1.1.1.1.1.1" xref="alg1.l7.m1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="alg1.l7.m1.1.1.1.1.1.2" xref="alg1.l7.m1.1.1.1.1.1.1.cmml">(</mo><msubsup id="alg1.l7.m1.1.1.1.1.1.1" xref="alg1.l7.m1.1.1.1.1.1.1.cmml"><mi id="alg1.l7.m1.1.1.1.1.1.1.2.2" xref="alg1.l7.m1.1.1.1.1.1.1.2.2.cmml">𝜽</mi><mi id="alg1.l7.m1.1.1.1.1.1.1.2.3" xref="alg1.l7.m1.1.1.1.1.1.1.2.3.cmml">i</mi><mi id="alg1.l7.m1.1.1.1.1.1.1.3" xref="alg1.l7.m1.1.1.1.1.1.1.3.cmml">k</mi></msubsup><mo stretchy="false" id="alg1.l7.m1.1.1.1.1.1.3" xref="alg1.l7.m1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l7.m1.1b"><apply id="alg1.l7.m1.1.1.cmml" xref="alg1.l7.m1.1.1"><eq id="alg1.l7.m1.1.1.2.cmml" xref="alg1.l7.m1.1.1.2"></eq><apply id="alg1.l7.m1.1.1.3.cmml" xref="alg1.l7.m1.1.1.3"><csymbol cd="ambiguous" id="alg1.l7.m1.1.1.3.1.cmml" xref="alg1.l7.m1.1.1.3">superscript</csymbol><apply id="alg1.l7.m1.1.1.3.2.cmml" xref="alg1.l7.m1.1.1.3"><csymbol cd="ambiguous" id="alg1.l7.m1.1.1.3.2.1.cmml" xref="alg1.l7.m1.1.1.3">subscript</csymbol><ci id="alg1.l7.m1.1.1.3.2.2.cmml" xref="alg1.l7.m1.1.1.3.2.2">𝒈</ci><ci id="alg1.l7.m1.1.1.3.2.3.cmml" xref="alg1.l7.m1.1.1.3.2.3">𝑖</ci></apply><ci id="alg1.l7.m1.1.1.3.3.cmml" xref="alg1.l7.m1.1.1.3.3">𝑘</ci></apply><apply id="alg1.l7.m1.1.1.1.cmml" xref="alg1.l7.m1.1.1.1"><times id="alg1.l7.m1.1.1.1.2.cmml" xref="alg1.l7.m1.1.1.1.2"></times><apply id="alg1.l7.m1.1.1.1.3.cmml" xref="alg1.l7.m1.1.1.1.3"><ci id="alg1.l7.m1.1.1.1.3.1.cmml" xref="alg1.l7.m1.1.1.1.3.1">∇</ci><apply id="alg1.l7.m1.1.1.1.3.2.cmml" xref="alg1.l7.m1.1.1.1.3.2"><csymbol cd="ambiguous" id="alg1.l7.m1.1.1.1.3.2.1.cmml" xref="alg1.l7.m1.1.1.1.3.2">subscript</csymbol><ci id="alg1.l7.m1.1.1.1.3.2.2.cmml" xref="alg1.l7.m1.1.1.1.3.2.2">ℎ</ci><ci id="alg1.l7.m1.1.1.1.3.2.3.cmml" xref="alg1.l7.m1.1.1.1.3.2.3">𝑖</ci></apply></apply><apply id="alg1.l7.m1.1.1.1.1.1.1.cmml" xref="alg1.l7.m1.1.1.1.1.1"><csymbol cd="ambiguous" id="alg1.l7.m1.1.1.1.1.1.1.1.cmml" xref="alg1.l7.m1.1.1.1.1.1">superscript</csymbol><apply id="alg1.l7.m1.1.1.1.1.1.1.2.cmml" xref="alg1.l7.m1.1.1.1.1.1"><csymbol cd="ambiguous" id="alg1.l7.m1.1.1.1.1.1.1.2.1.cmml" xref="alg1.l7.m1.1.1.1.1.1">subscript</csymbol><ci id="alg1.l7.m1.1.1.1.1.1.1.2.2.cmml" xref="alg1.l7.m1.1.1.1.1.1.1.2.2">𝜽</ci><ci id="alg1.l7.m1.1.1.1.1.1.1.2.3.cmml" xref="alg1.l7.m1.1.1.1.1.1.1.2.3">𝑖</ci></apply><ci id="alg1.l7.m1.1.1.1.1.1.1.3.cmml" xref="alg1.l7.m1.1.1.1.1.1.1.3">𝑘</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l7.m1.1c">\bm{g}_{i}^{k}=\nabla h_{i}(\bm{\theta}_{i}^{k})</annotation></semantics></math>

</div>
<div id="alg1.l8" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">2</span><span class="ltx_tag ltx_tag_listingline"><span id="alg1.l8.1.1.1" class="ltx_text" style="font-size:80%;">8:</span></span>           Update the local moving average of the
</div>
<div id="alg1.1.1.1.1" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">3</span>gradient: <math id="alg1.1.1.1.1.m1.1" class="ltx_Math" alttext="\bm{m}_{i}^{k}=\beta_{1}\bm{m}_{i}^{k-1}+(1-\beta_{1})\bm{g}_{i}^{k}" display="inline"><semantics id="alg1.1.1.1.1.m1.1a"><mrow id="alg1.1.1.1.1.m1.1.1" xref="alg1.1.1.1.1.m1.1.1.cmml"><msubsup id="alg1.1.1.1.1.m1.1.1.3" xref="alg1.1.1.1.1.m1.1.1.3.cmml"><mi id="alg1.1.1.1.1.m1.1.1.3.2.2" xref="alg1.1.1.1.1.m1.1.1.3.2.2.cmml">𝒎</mi><mi id="alg1.1.1.1.1.m1.1.1.3.2.3" xref="alg1.1.1.1.1.m1.1.1.3.2.3.cmml">i</mi><mi id="alg1.1.1.1.1.m1.1.1.3.3" xref="alg1.1.1.1.1.m1.1.1.3.3.cmml">k</mi></msubsup><mo id="alg1.1.1.1.1.m1.1.1.2" xref="alg1.1.1.1.1.m1.1.1.2.cmml">=</mo><mrow id="alg1.1.1.1.1.m1.1.1.1" xref="alg1.1.1.1.1.m1.1.1.1.cmml"><mrow id="alg1.1.1.1.1.m1.1.1.1.3" xref="alg1.1.1.1.1.m1.1.1.1.3.cmml"><msub id="alg1.1.1.1.1.m1.1.1.1.3.2" xref="alg1.1.1.1.1.m1.1.1.1.3.2.cmml"><mi id="alg1.1.1.1.1.m1.1.1.1.3.2.2" xref="alg1.1.1.1.1.m1.1.1.1.3.2.2.cmml">β</mi><mn id="alg1.1.1.1.1.m1.1.1.1.3.2.3" xref="alg1.1.1.1.1.m1.1.1.1.3.2.3.cmml">1</mn></msub><mo lspace="0em" rspace="0em" id="alg1.1.1.1.1.m1.1.1.1.3.1" xref="alg1.1.1.1.1.m1.1.1.1.3.1.cmml">​</mo><msubsup id="alg1.1.1.1.1.m1.1.1.1.3.3" xref="alg1.1.1.1.1.m1.1.1.1.3.3.cmml"><mi id="alg1.1.1.1.1.m1.1.1.1.3.3.2.2" xref="alg1.1.1.1.1.m1.1.1.1.3.3.2.2.cmml">𝒎</mi><mi id="alg1.1.1.1.1.m1.1.1.1.3.3.2.3" xref="alg1.1.1.1.1.m1.1.1.1.3.3.2.3.cmml">i</mi><mrow id="alg1.1.1.1.1.m1.1.1.1.3.3.3" xref="alg1.1.1.1.1.m1.1.1.1.3.3.3.cmml"><mi id="alg1.1.1.1.1.m1.1.1.1.3.3.3.2" xref="alg1.1.1.1.1.m1.1.1.1.3.3.3.2.cmml">k</mi><mo id="alg1.1.1.1.1.m1.1.1.1.3.3.3.1" xref="alg1.1.1.1.1.m1.1.1.1.3.3.3.1.cmml">−</mo><mn id="alg1.1.1.1.1.m1.1.1.1.3.3.3.3" xref="alg1.1.1.1.1.m1.1.1.1.3.3.3.3.cmml">1</mn></mrow></msubsup></mrow><mo id="alg1.1.1.1.1.m1.1.1.1.2" xref="alg1.1.1.1.1.m1.1.1.1.2.cmml">+</mo><mrow id="alg1.1.1.1.1.m1.1.1.1.1" xref="alg1.1.1.1.1.m1.1.1.1.1.cmml"><mrow id="alg1.1.1.1.1.m1.1.1.1.1.1.1" xref="alg1.1.1.1.1.m1.1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="alg1.1.1.1.1.m1.1.1.1.1.1.1.2" xref="alg1.1.1.1.1.m1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="alg1.1.1.1.1.m1.1.1.1.1.1.1.1" xref="alg1.1.1.1.1.m1.1.1.1.1.1.1.1.cmml"><mn id="alg1.1.1.1.1.m1.1.1.1.1.1.1.1.2" xref="alg1.1.1.1.1.m1.1.1.1.1.1.1.1.2.cmml">1</mn><mo id="alg1.1.1.1.1.m1.1.1.1.1.1.1.1.1" xref="alg1.1.1.1.1.m1.1.1.1.1.1.1.1.1.cmml">−</mo><msub id="alg1.1.1.1.1.m1.1.1.1.1.1.1.1.3" xref="alg1.1.1.1.1.m1.1.1.1.1.1.1.1.3.cmml"><mi id="alg1.1.1.1.1.m1.1.1.1.1.1.1.1.3.2" xref="alg1.1.1.1.1.m1.1.1.1.1.1.1.1.3.2.cmml">β</mi><mn id="alg1.1.1.1.1.m1.1.1.1.1.1.1.1.3.3" xref="alg1.1.1.1.1.m1.1.1.1.1.1.1.1.3.3.cmml">1</mn></msub></mrow><mo stretchy="false" id="alg1.1.1.1.1.m1.1.1.1.1.1.1.3" xref="alg1.1.1.1.1.m1.1.1.1.1.1.1.1.cmml">)</mo></mrow><mo lspace="0em" rspace="0em" id="alg1.1.1.1.1.m1.1.1.1.1.2" xref="alg1.1.1.1.1.m1.1.1.1.1.2.cmml">​</mo><msubsup id="alg1.1.1.1.1.m1.1.1.1.1.3" xref="alg1.1.1.1.1.m1.1.1.1.1.3.cmml"><mi id="alg1.1.1.1.1.m1.1.1.1.1.3.2.2" xref="alg1.1.1.1.1.m1.1.1.1.1.3.2.2.cmml">𝒈</mi><mi id="alg1.1.1.1.1.m1.1.1.1.1.3.2.3" xref="alg1.1.1.1.1.m1.1.1.1.1.3.2.3.cmml">i</mi><mi id="alg1.1.1.1.1.m1.1.1.1.1.3.3" xref="alg1.1.1.1.1.m1.1.1.1.1.3.3.cmml">k</mi></msubsup></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.1.1.1.1.m1.1b"><apply id="alg1.1.1.1.1.m1.1.1.cmml" xref="alg1.1.1.1.1.m1.1.1"><eq id="alg1.1.1.1.1.m1.1.1.2.cmml" xref="alg1.1.1.1.1.m1.1.1.2"></eq><apply id="alg1.1.1.1.1.m1.1.1.3.cmml" xref="alg1.1.1.1.1.m1.1.1.3"><csymbol cd="ambiguous" id="alg1.1.1.1.1.m1.1.1.3.1.cmml" xref="alg1.1.1.1.1.m1.1.1.3">superscript</csymbol><apply id="alg1.1.1.1.1.m1.1.1.3.2.cmml" xref="alg1.1.1.1.1.m1.1.1.3"><csymbol cd="ambiguous" id="alg1.1.1.1.1.m1.1.1.3.2.1.cmml" xref="alg1.1.1.1.1.m1.1.1.3">subscript</csymbol><ci id="alg1.1.1.1.1.m1.1.1.3.2.2.cmml" xref="alg1.1.1.1.1.m1.1.1.3.2.2">𝒎</ci><ci id="alg1.1.1.1.1.m1.1.1.3.2.3.cmml" xref="alg1.1.1.1.1.m1.1.1.3.2.3">𝑖</ci></apply><ci id="alg1.1.1.1.1.m1.1.1.3.3.cmml" xref="alg1.1.1.1.1.m1.1.1.3.3">𝑘</ci></apply><apply id="alg1.1.1.1.1.m1.1.1.1.cmml" xref="alg1.1.1.1.1.m1.1.1.1"><plus id="alg1.1.1.1.1.m1.1.1.1.2.cmml" xref="alg1.1.1.1.1.m1.1.1.1.2"></plus><apply id="alg1.1.1.1.1.m1.1.1.1.3.cmml" xref="alg1.1.1.1.1.m1.1.1.1.3"><times id="alg1.1.1.1.1.m1.1.1.1.3.1.cmml" xref="alg1.1.1.1.1.m1.1.1.1.3.1"></times><apply id="alg1.1.1.1.1.m1.1.1.1.3.2.cmml" xref="alg1.1.1.1.1.m1.1.1.1.3.2"><csymbol cd="ambiguous" id="alg1.1.1.1.1.m1.1.1.1.3.2.1.cmml" xref="alg1.1.1.1.1.m1.1.1.1.3.2">subscript</csymbol><ci id="alg1.1.1.1.1.m1.1.1.1.3.2.2.cmml" xref="alg1.1.1.1.1.m1.1.1.1.3.2.2">𝛽</ci><cn type="integer" id="alg1.1.1.1.1.m1.1.1.1.3.2.3.cmml" xref="alg1.1.1.1.1.m1.1.1.1.3.2.3">1</cn></apply><apply id="alg1.1.1.1.1.m1.1.1.1.3.3.cmml" xref="alg1.1.1.1.1.m1.1.1.1.3.3"><csymbol cd="ambiguous" id="alg1.1.1.1.1.m1.1.1.1.3.3.1.cmml" xref="alg1.1.1.1.1.m1.1.1.1.3.3">superscript</csymbol><apply id="alg1.1.1.1.1.m1.1.1.1.3.3.2.cmml" xref="alg1.1.1.1.1.m1.1.1.1.3.3"><csymbol cd="ambiguous" id="alg1.1.1.1.1.m1.1.1.1.3.3.2.1.cmml" xref="alg1.1.1.1.1.m1.1.1.1.3.3">subscript</csymbol><ci id="alg1.1.1.1.1.m1.1.1.1.3.3.2.2.cmml" xref="alg1.1.1.1.1.m1.1.1.1.3.3.2.2">𝒎</ci><ci id="alg1.1.1.1.1.m1.1.1.1.3.3.2.3.cmml" xref="alg1.1.1.1.1.m1.1.1.1.3.3.2.3">𝑖</ci></apply><apply id="alg1.1.1.1.1.m1.1.1.1.3.3.3.cmml" xref="alg1.1.1.1.1.m1.1.1.1.3.3.3"><minus id="alg1.1.1.1.1.m1.1.1.1.3.3.3.1.cmml" xref="alg1.1.1.1.1.m1.1.1.1.3.3.3.1"></minus><ci id="alg1.1.1.1.1.m1.1.1.1.3.3.3.2.cmml" xref="alg1.1.1.1.1.m1.1.1.1.3.3.3.2">𝑘</ci><cn type="integer" id="alg1.1.1.1.1.m1.1.1.1.3.3.3.3.cmml" xref="alg1.1.1.1.1.m1.1.1.1.3.3.3.3">1</cn></apply></apply></apply><apply id="alg1.1.1.1.1.m1.1.1.1.1.cmml" xref="alg1.1.1.1.1.m1.1.1.1.1"><times id="alg1.1.1.1.1.m1.1.1.1.1.2.cmml" xref="alg1.1.1.1.1.m1.1.1.1.1.2"></times><apply id="alg1.1.1.1.1.m1.1.1.1.1.1.1.1.cmml" xref="alg1.1.1.1.1.m1.1.1.1.1.1.1"><minus id="alg1.1.1.1.1.m1.1.1.1.1.1.1.1.1.cmml" xref="alg1.1.1.1.1.m1.1.1.1.1.1.1.1.1"></minus><cn type="integer" id="alg1.1.1.1.1.m1.1.1.1.1.1.1.1.2.cmml" xref="alg1.1.1.1.1.m1.1.1.1.1.1.1.1.2">1</cn><apply id="alg1.1.1.1.1.m1.1.1.1.1.1.1.1.3.cmml" xref="alg1.1.1.1.1.m1.1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="alg1.1.1.1.1.m1.1.1.1.1.1.1.1.3.1.cmml" xref="alg1.1.1.1.1.m1.1.1.1.1.1.1.1.3">subscript</csymbol><ci id="alg1.1.1.1.1.m1.1.1.1.1.1.1.1.3.2.cmml" xref="alg1.1.1.1.1.m1.1.1.1.1.1.1.1.3.2">𝛽</ci><cn type="integer" id="alg1.1.1.1.1.m1.1.1.1.1.1.1.1.3.3.cmml" xref="alg1.1.1.1.1.m1.1.1.1.1.1.1.1.3.3">1</cn></apply></apply><apply id="alg1.1.1.1.1.m1.1.1.1.1.3.cmml" xref="alg1.1.1.1.1.m1.1.1.1.1.3"><csymbol cd="ambiguous" id="alg1.1.1.1.1.m1.1.1.1.1.3.1.cmml" xref="alg1.1.1.1.1.m1.1.1.1.1.3">superscript</csymbol><apply id="alg1.1.1.1.1.m1.1.1.1.1.3.2.cmml" xref="alg1.1.1.1.1.m1.1.1.1.1.3"><csymbol cd="ambiguous" id="alg1.1.1.1.1.m1.1.1.1.1.3.2.1.cmml" xref="alg1.1.1.1.1.m1.1.1.1.1.3">subscript</csymbol><ci id="alg1.1.1.1.1.m1.1.1.1.1.3.2.2.cmml" xref="alg1.1.1.1.1.m1.1.1.1.1.3.2.2">𝒈</ci><ci id="alg1.1.1.1.1.m1.1.1.1.1.3.2.3.cmml" xref="alg1.1.1.1.1.m1.1.1.1.1.3.2.3">𝑖</ci></apply><ci id="alg1.1.1.1.1.m1.1.1.1.1.3.3.cmml" xref="alg1.1.1.1.1.m1.1.1.1.1.3.3">𝑘</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.1.1.1.1.m1.1c">\bm{m}_{i}^{k}=\beta_{1}\bm{m}_{i}^{k-1}+(1-\beta_{1})\bm{g}_{i}^{k}</annotation></semantics></math>

</div>
<div id="alg1.2.2.2.4" class="ltx_listingline">
</div>
<div id="alg1.l9" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg1.l9.1.1.1" class="ltx_text" style="font-size:80%;">9:</span></span>           <span id="alg1.l9.2" class="ltx_text ltx_font_bold">if</span> <math id="alg1.l9.m1.1" class="ltx_Math" alttext="k\mod\tau=0" display="inline"><semantics id="alg1.l9.m1.1a"><mrow id="alg1.l9.m1.1.1" xref="alg1.l9.m1.1.1.cmml"><mrow id="alg1.l9.m1.1.1.2" xref="alg1.l9.m1.1.1.2.cmml"><mi id="alg1.l9.m1.1.1.2.2" xref="alg1.l9.m1.1.1.2.2.cmml">k</mi><mo id="alg1.l9.m1.1.1.2.1" xref="alg1.l9.m1.1.1.2.1.cmml">mod</mo><mi id="alg1.l9.m1.1.1.2.3" xref="alg1.l9.m1.1.1.2.3.cmml">τ</mi></mrow><mo id="alg1.l9.m1.1.1.1" xref="alg1.l9.m1.1.1.1.cmml">=</mo><mn id="alg1.l9.m1.1.1.3" xref="alg1.l9.m1.1.1.3.cmml">0</mn></mrow><annotation-xml encoding="MathML-Content" id="alg1.l9.m1.1b"><apply id="alg1.l9.m1.1.1.cmml" xref="alg1.l9.m1.1.1"><eq id="alg1.l9.m1.1.1.1.cmml" xref="alg1.l9.m1.1.1.1"></eq><apply id="alg1.l9.m1.1.1.2.cmml" xref="alg1.l9.m1.1.1.2"><csymbol cd="latexml" id="alg1.l9.m1.1.1.2.1.cmml" xref="alg1.l9.m1.1.1.2.1">modulo</csymbol><ci id="alg1.l9.m1.1.1.2.2.cmml" xref="alg1.l9.m1.1.1.2.2">𝑘</ci><ci id="alg1.l9.m1.1.1.2.3.cmml" xref="alg1.l9.m1.1.1.2.3">𝜏</ci></apply><cn type="integer" id="alg1.l9.m1.1.1.3.cmml" xref="alg1.l9.m1.1.1.3">0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l9.m1.1c">k\mod\tau=0</annotation></semantics></math> <span id="alg1.l9.3" class="ltx_text ltx_font_bold">then</span>



</div>
<div id="alg1.l10" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg1.l10.1.1.1" class="ltx_text" style="font-size:80%;">10:</span></span>              Compute the local estimated Hessian: 
<br class="ltx_break"><math id="alg1.l10.m1.1" class="ltx_Math" alttext="\hat{\bm{h}}_{i}^{k}=\text{Estimator}(\bm{\theta}_{i}^{k})" display="inline"><semantics id="alg1.l10.m1.1a"><mrow id="alg1.l10.m1.1.1" xref="alg1.l10.m1.1.1.cmml"><msubsup id="alg1.l10.m1.1.1.3" xref="alg1.l10.m1.1.1.3.cmml"><mover accent="true" id="alg1.l10.m1.1.1.3.2.2" xref="alg1.l10.m1.1.1.3.2.2.cmml"><mi id="alg1.l10.m1.1.1.3.2.2.2" xref="alg1.l10.m1.1.1.3.2.2.2.cmml">𝒉</mi><mo id="alg1.l10.m1.1.1.3.2.2.1" xref="alg1.l10.m1.1.1.3.2.2.1.cmml">^</mo></mover><mi id="alg1.l10.m1.1.1.3.2.3" xref="alg1.l10.m1.1.1.3.2.3.cmml">i</mi><mi id="alg1.l10.m1.1.1.3.3" xref="alg1.l10.m1.1.1.3.3.cmml">k</mi></msubsup><mo id="alg1.l10.m1.1.1.2" xref="alg1.l10.m1.1.1.2.cmml">=</mo><mrow id="alg1.l10.m1.1.1.1" xref="alg1.l10.m1.1.1.1.cmml"><mtext id="alg1.l10.m1.1.1.1.3" xref="alg1.l10.m1.1.1.1.3a.cmml">Estimator</mtext><mo lspace="0em" rspace="0em" id="alg1.l10.m1.1.1.1.2" xref="alg1.l10.m1.1.1.1.2.cmml">​</mo><mrow id="alg1.l10.m1.1.1.1.1.1" xref="alg1.l10.m1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="alg1.l10.m1.1.1.1.1.1.2" xref="alg1.l10.m1.1.1.1.1.1.1.cmml">(</mo><msubsup id="alg1.l10.m1.1.1.1.1.1.1" xref="alg1.l10.m1.1.1.1.1.1.1.cmml"><mi id="alg1.l10.m1.1.1.1.1.1.1.2.2" xref="alg1.l10.m1.1.1.1.1.1.1.2.2.cmml">𝜽</mi><mi id="alg1.l10.m1.1.1.1.1.1.1.2.3" xref="alg1.l10.m1.1.1.1.1.1.1.2.3.cmml">i</mi><mi id="alg1.l10.m1.1.1.1.1.1.1.3" xref="alg1.l10.m1.1.1.1.1.1.1.3.cmml">k</mi></msubsup><mo stretchy="false" id="alg1.l10.m1.1.1.1.1.1.3" xref="alg1.l10.m1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l10.m1.1b"><apply id="alg1.l10.m1.1.1.cmml" xref="alg1.l10.m1.1.1"><eq id="alg1.l10.m1.1.1.2.cmml" xref="alg1.l10.m1.1.1.2"></eq><apply id="alg1.l10.m1.1.1.3.cmml" xref="alg1.l10.m1.1.1.3"><csymbol cd="ambiguous" id="alg1.l10.m1.1.1.3.1.cmml" xref="alg1.l10.m1.1.1.3">superscript</csymbol><apply id="alg1.l10.m1.1.1.3.2.cmml" xref="alg1.l10.m1.1.1.3"><csymbol cd="ambiguous" id="alg1.l10.m1.1.1.3.2.1.cmml" xref="alg1.l10.m1.1.1.3">subscript</csymbol><apply id="alg1.l10.m1.1.1.3.2.2.cmml" xref="alg1.l10.m1.1.1.3.2.2"><ci id="alg1.l10.m1.1.1.3.2.2.1.cmml" xref="alg1.l10.m1.1.1.3.2.2.1">^</ci><ci id="alg1.l10.m1.1.1.3.2.2.2.cmml" xref="alg1.l10.m1.1.1.3.2.2.2">𝒉</ci></apply><ci id="alg1.l10.m1.1.1.3.2.3.cmml" xref="alg1.l10.m1.1.1.3.2.3">𝑖</ci></apply><ci id="alg1.l10.m1.1.1.3.3.cmml" xref="alg1.l10.m1.1.1.3.3">𝑘</ci></apply><apply id="alg1.l10.m1.1.1.1.cmml" xref="alg1.l10.m1.1.1.1"><times id="alg1.l10.m1.1.1.1.2.cmml" xref="alg1.l10.m1.1.1.1.2"></times><ci id="alg1.l10.m1.1.1.1.3a.cmml" xref="alg1.l10.m1.1.1.1.3"><mtext id="alg1.l10.m1.1.1.1.3.cmml" xref="alg1.l10.m1.1.1.1.3">Estimator</mtext></ci><apply id="alg1.l10.m1.1.1.1.1.1.1.cmml" xref="alg1.l10.m1.1.1.1.1.1"><csymbol cd="ambiguous" id="alg1.l10.m1.1.1.1.1.1.1.1.cmml" xref="alg1.l10.m1.1.1.1.1.1">superscript</csymbol><apply id="alg1.l10.m1.1.1.1.1.1.1.2.cmml" xref="alg1.l10.m1.1.1.1.1.1"><csymbol cd="ambiguous" id="alg1.l10.m1.1.1.1.1.1.1.2.1.cmml" xref="alg1.l10.m1.1.1.1.1.1">subscript</csymbol><ci id="alg1.l10.m1.1.1.1.1.1.1.2.2.cmml" xref="alg1.l10.m1.1.1.1.1.1.1.2.2">𝜽</ci><ci id="alg1.l10.m1.1.1.1.1.1.1.2.3.cmml" xref="alg1.l10.m1.1.1.1.1.1.1.2.3">𝑖</ci></apply><ci id="alg1.l10.m1.1.1.1.1.1.1.3.cmml" xref="alg1.l10.m1.1.1.1.1.1.1.3">𝑘</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l10.m1.1c">\hat{\bm{h}}_{i}^{k}=\text{Estimator}(\bm{\theta}_{i}^{k})</annotation></semantics></math> using GNB Algorithm <a href="#alg2" title="In IV-A Hessian as a Pre-conditioner ‣ IV Proposed Algorithm ‣ Fed-Sophia: A Communication-Efficient Second-Order Federated Learning Algorithm Identify applicable funding agency here. If none, delete this." class="ltx_ref"><span class="ltx_text ltx_ref_tag">2</span></a>

</div>
<div id="alg1.l11" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">4</span><span class="ltx_tag ltx_tag_listingline"><span id="alg1.l11.1.1.1" class="ltx_text" style="font-size:80%;">11:</span></span>              Update the local moving average of the 
</div>
<div id="alg1.2.2.2.5" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">5</span>Hessian estimator:
</div>
<div id="alg1.2.2.2.2" class="ltx_listingline">
<math id="alg1.2.2.2.2.m1.1" class="ltx_Math" alttext="\bm{h}_{i}^{k}=\beta_{2}\bm{h}_{i}^{k-\tau}+(1-\beta_{2})\hat{\bm{h}}_{i}^{k}" display="inline"><semantics id="alg1.2.2.2.2.m1.1a"><mrow id="alg1.2.2.2.2.m1.1.1" xref="alg1.2.2.2.2.m1.1.1.cmml"><msubsup id="alg1.2.2.2.2.m1.1.1.3" xref="alg1.2.2.2.2.m1.1.1.3.cmml"><mi id="alg1.2.2.2.2.m1.1.1.3.2.2" xref="alg1.2.2.2.2.m1.1.1.3.2.2.cmml">𝒉</mi><mi id="alg1.2.2.2.2.m1.1.1.3.2.3" xref="alg1.2.2.2.2.m1.1.1.3.2.3.cmml">i</mi><mi id="alg1.2.2.2.2.m1.1.1.3.3" xref="alg1.2.2.2.2.m1.1.1.3.3.cmml">k</mi></msubsup><mo id="alg1.2.2.2.2.m1.1.1.2" xref="alg1.2.2.2.2.m1.1.1.2.cmml">=</mo><mrow id="alg1.2.2.2.2.m1.1.1.1" xref="alg1.2.2.2.2.m1.1.1.1.cmml"><mrow id="alg1.2.2.2.2.m1.1.1.1.3" xref="alg1.2.2.2.2.m1.1.1.1.3.cmml"><msub id="alg1.2.2.2.2.m1.1.1.1.3.2" xref="alg1.2.2.2.2.m1.1.1.1.3.2.cmml"><mi id="alg1.2.2.2.2.m1.1.1.1.3.2.2" xref="alg1.2.2.2.2.m1.1.1.1.3.2.2.cmml">β</mi><mn id="alg1.2.2.2.2.m1.1.1.1.3.2.3" xref="alg1.2.2.2.2.m1.1.1.1.3.2.3.cmml">2</mn></msub><mo lspace="0em" rspace="0em" id="alg1.2.2.2.2.m1.1.1.1.3.1" xref="alg1.2.2.2.2.m1.1.1.1.3.1.cmml">​</mo><msubsup id="alg1.2.2.2.2.m1.1.1.1.3.3" xref="alg1.2.2.2.2.m1.1.1.1.3.3.cmml"><mi id="alg1.2.2.2.2.m1.1.1.1.3.3.2.2" xref="alg1.2.2.2.2.m1.1.1.1.3.3.2.2.cmml">𝒉</mi><mi id="alg1.2.2.2.2.m1.1.1.1.3.3.2.3" xref="alg1.2.2.2.2.m1.1.1.1.3.3.2.3.cmml">i</mi><mrow id="alg1.2.2.2.2.m1.1.1.1.3.3.3" xref="alg1.2.2.2.2.m1.1.1.1.3.3.3.cmml"><mi id="alg1.2.2.2.2.m1.1.1.1.3.3.3.2" xref="alg1.2.2.2.2.m1.1.1.1.3.3.3.2.cmml">k</mi><mo id="alg1.2.2.2.2.m1.1.1.1.3.3.3.1" xref="alg1.2.2.2.2.m1.1.1.1.3.3.3.1.cmml">−</mo><mi id="alg1.2.2.2.2.m1.1.1.1.3.3.3.3" xref="alg1.2.2.2.2.m1.1.1.1.3.3.3.3.cmml">τ</mi></mrow></msubsup></mrow><mo id="alg1.2.2.2.2.m1.1.1.1.2" xref="alg1.2.2.2.2.m1.1.1.1.2.cmml">+</mo><mrow id="alg1.2.2.2.2.m1.1.1.1.1" xref="alg1.2.2.2.2.m1.1.1.1.1.cmml"><mrow id="alg1.2.2.2.2.m1.1.1.1.1.1.1" xref="alg1.2.2.2.2.m1.1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="alg1.2.2.2.2.m1.1.1.1.1.1.1.2" xref="alg1.2.2.2.2.m1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="alg1.2.2.2.2.m1.1.1.1.1.1.1.1" xref="alg1.2.2.2.2.m1.1.1.1.1.1.1.1.cmml"><mn id="alg1.2.2.2.2.m1.1.1.1.1.1.1.1.2" xref="alg1.2.2.2.2.m1.1.1.1.1.1.1.1.2.cmml">1</mn><mo id="alg1.2.2.2.2.m1.1.1.1.1.1.1.1.1" xref="alg1.2.2.2.2.m1.1.1.1.1.1.1.1.1.cmml">−</mo><msub id="alg1.2.2.2.2.m1.1.1.1.1.1.1.1.3" xref="alg1.2.2.2.2.m1.1.1.1.1.1.1.1.3.cmml"><mi id="alg1.2.2.2.2.m1.1.1.1.1.1.1.1.3.2" xref="alg1.2.2.2.2.m1.1.1.1.1.1.1.1.3.2.cmml">β</mi><mn id="alg1.2.2.2.2.m1.1.1.1.1.1.1.1.3.3" xref="alg1.2.2.2.2.m1.1.1.1.1.1.1.1.3.3.cmml">2</mn></msub></mrow><mo stretchy="false" id="alg1.2.2.2.2.m1.1.1.1.1.1.1.3" xref="alg1.2.2.2.2.m1.1.1.1.1.1.1.1.cmml">)</mo></mrow><mo lspace="0em" rspace="0em" id="alg1.2.2.2.2.m1.1.1.1.1.2" xref="alg1.2.2.2.2.m1.1.1.1.1.2.cmml">​</mo><msubsup id="alg1.2.2.2.2.m1.1.1.1.1.3" xref="alg1.2.2.2.2.m1.1.1.1.1.3.cmml"><mover accent="true" id="alg1.2.2.2.2.m1.1.1.1.1.3.2.2" xref="alg1.2.2.2.2.m1.1.1.1.1.3.2.2.cmml"><mi id="alg1.2.2.2.2.m1.1.1.1.1.3.2.2.2" xref="alg1.2.2.2.2.m1.1.1.1.1.3.2.2.2.cmml">𝒉</mi><mo id="alg1.2.2.2.2.m1.1.1.1.1.3.2.2.1" xref="alg1.2.2.2.2.m1.1.1.1.1.3.2.2.1.cmml">^</mo></mover><mi id="alg1.2.2.2.2.m1.1.1.1.1.3.2.3" xref="alg1.2.2.2.2.m1.1.1.1.1.3.2.3.cmml">i</mi><mi id="alg1.2.2.2.2.m1.1.1.1.1.3.3" xref="alg1.2.2.2.2.m1.1.1.1.1.3.3.cmml">k</mi></msubsup></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.2.2.2.2.m1.1b"><apply id="alg1.2.2.2.2.m1.1.1.cmml" xref="alg1.2.2.2.2.m1.1.1"><eq id="alg1.2.2.2.2.m1.1.1.2.cmml" xref="alg1.2.2.2.2.m1.1.1.2"></eq><apply id="alg1.2.2.2.2.m1.1.1.3.cmml" xref="alg1.2.2.2.2.m1.1.1.3"><csymbol cd="ambiguous" id="alg1.2.2.2.2.m1.1.1.3.1.cmml" xref="alg1.2.2.2.2.m1.1.1.3">superscript</csymbol><apply id="alg1.2.2.2.2.m1.1.1.3.2.cmml" xref="alg1.2.2.2.2.m1.1.1.3"><csymbol cd="ambiguous" id="alg1.2.2.2.2.m1.1.1.3.2.1.cmml" xref="alg1.2.2.2.2.m1.1.1.3">subscript</csymbol><ci id="alg1.2.2.2.2.m1.1.1.3.2.2.cmml" xref="alg1.2.2.2.2.m1.1.1.3.2.2">𝒉</ci><ci id="alg1.2.2.2.2.m1.1.1.3.2.3.cmml" xref="alg1.2.2.2.2.m1.1.1.3.2.3">𝑖</ci></apply><ci id="alg1.2.2.2.2.m1.1.1.3.3.cmml" xref="alg1.2.2.2.2.m1.1.1.3.3">𝑘</ci></apply><apply id="alg1.2.2.2.2.m1.1.1.1.cmml" xref="alg1.2.2.2.2.m1.1.1.1"><plus id="alg1.2.2.2.2.m1.1.1.1.2.cmml" xref="alg1.2.2.2.2.m1.1.1.1.2"></plus><apply id="alg1.2.2.2.2.m1.1.1.1.3.cmml" xref="alg1.2.2.2.2.m1.1.1.1.3"><times id="alg1.2.2.2.2.m1.1.1.1.3.1.cmml" xref="alg1.2.2.2.2.m1.1.1.1.3.1"></times><apply id="alg1.2.2.2.2.m1.1.1.1.3.2.cmml" xref="alg1.2.2.2.2.m1.1.1.1.3.2"><csymbol cd="ambiguous" id="alg1.2.2.2.2.m1.1.1.1.3.2.1.cmml" xref="alg1.2.2.2.2.m1.1.1.1.3.2">subscript</csymbol><ci id="alg1.2.2.2.2.m1.1.1.1.3.2.2.cmml" xref="alg1.2.2.2.2.m1.1.1.1.3.2.2">𝛽</ci><cn type="integer" id="alg1.2.2.2.2.m1.1.1.1.3.2.3.cmml" xref="alg1.2.2.2.2.m1.1.1.1.3.2.3">2</cn></apply><apply id="alg1.2.2.2.2.m1.1.1.1.3.3.cmml" xref="alg1.2.2.2.2.m1.1.1.1.3.3"><csymbol cd="ambiguous" id="alg1.2.2.2.2.m1.1.1.1.3.3.1.cmml" xref="alg1.2.2.2.2.m1.1.1.1.3.3">superscript</csymbol><apply id="alg1.2.2.2.2.m1.1.1.1.3.3.2.cmml" xref="alg1.2.2.2.2.m1.1.1.1.3.3"><csymbol cd="ambiguous" id="alg1.2.2.2.2.m1.1.1.1.3.3.2.1.cmml" xref="alg1.2.2.2.2.m1.1.1.1.3.3">subscript</csymbol><ci id="alg1.2.2.2.2.m1.1.1.1.3.3.2.2.cmml" xref="alg1.2.2.2.2.m1.1.1.1.3.3.2.2">𝒉</ci><ci id="alg1.2.2.2.2.m1.1.1.1.3.3.2.3.cmml" xref="alg1.2.2.2.2.m1.1.1.1.3.3.2.3">𝑖</ci></apply><apply id="alg1.2.2.2.2.m1.1.1.1.3.3.3.cmml" xref="alg1.2.2.2.2.m1.1.1.1.3.3.3"><minus id="alg1.2.2.2.2.m1.1.1.1.3.3.3.1.cmml" xref="alg1.2.2.2.2.m1.1.1.1.3.3.3.1"></minus><ci id="alg1.2.2.2.2.m1.1.1.1.3.3.3.2.cmml" xref="alg1.2.2.2.2.m1.1.1.1.3.3.3.2">𝑘</ci><ci id="alg1.2.2.2.2.m1.1.1.1.3.3.3.3.cmml" xref="alg1.2.2.2.2.m1.1.1.1.3.3.3.3">𝜏</ci></apply></apply></apply><apply id="alg1.2.2.2.2.m1.1.1.1.1.cmml" xref="alg1.2.2.2.2.m1.1.1.1.1"><times id="alg1.2.2.2.2.m1.1.1.1.1.2.cmml" xref="alg1.2.2.2.2.m1.1.1.1.1.2"></times><apply id="alg1.2.2.2.2.m1.1.1.1.1.1.1.1.cmml" xref="alg1.2.2.2.2.m1.1.1.1.1.1.1"><minus id="alg1.2.2.2.2.m1.1.1.1.1.1.1.1.1.cmml" xref="alg1.2.2.2.2.m1.1.1.1.1.1.1.1.1"></minus><cn type="integer" id="alg1.2.2.2.2.m1.1.1.1.1.1.1.1.2.cmml" xref="alg1.2.2.2.2.m1.1.1.1.1.1.1.1.2">1</cn><apply id="alg1.2.2.2.2.m1.1.1.1.1.1.1.1.3.cmml" xref="alg1.2.2.2.2.m1.1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="alg1.2.2.2.2.m1.1.1.1.1.1.1.1.3.1.cmml" xref="alg1.2.2.2.2.m1.1.1.1.1.1.1.1.3">subscript</csymbol><ci id="alg1.2.2.2.2.m1.1.1.1.1.1.1.1.3.2.cmml" xref="alg1.2.2.2.2.m1.1.1.1.1.1.1.1.3.2">𝛽</ci><cn type="integer" id="alg1.2.2.2.2.m1.1.1.1.1.1.1.1.3.3.cmml" xref="alg1.2.2.2.2.m1.1.1.1.1.1.1.1.3.3">2</cn></apply></apply><apply id="alg1.2.2.2.2.m1.1.1.1.1.3.cmml" xref="alg1.2.2.2.2.m1.1.1.1.1.3"><csymbol cd="ambiguous" id="alg1.2.2.2.2.m1.1.1.1.1.3.1.cmml" xref="alg1.2.2.2.2.m1.1.1.1.1.3">superscript</csymbol><apply id="alg1.2.2.2.2.m1.1.1.1.1.3.2.cmml" xref="alg1.2.2.2.2.m1.1.1.1.1.3"><csymbol cd="ambiguous" id="alg1.2.2.2.2.m1.1.1.1.1.3.2.1.cmml" xref="alg1.2.2.2.2.m1.1.1.1.1.3">subscript</csymbol><apply id="alg1.2.2.2.2.m1.1.1.1.1.3.2.2.cmml" xref="alg1.2.2.2.2.m1.1.1.1.1.3.2.2"><ci id="alg1.2.2.2.2.m1.1.1.1.1.3.2.2.1.cmml" xref="alg1.2.2.2.2.m1.1.1.1.1.3.2.2.1">^</ci><ci id="alg1.2.2.2.2.m1.1.1.1.1.3.2.2.2.cmml" xref="alg1.2.2.2.2.m1.1.1.1.1.3.2.2.2">𝒉</ci></apply><ci id="alg1.2.2.2.2.m1.1.1.1.1.3.2.3.cmml" xref="alg1.2.2.2.2.m1.1.1.1.1.3.2.3">𝑖</ci></apply><ci id="alg1.2.2.2.2.m1.1.1.1.1.3.3.cmml" xref="alg1.2.2.2.2.m1.1.1.1.1.3.3">𝑘</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.2.2.2.2.m1.1c">\bm{h}_{i}^{k}=\beta_{2}\bm{h}_{i}^{k-\tau}+(1-\beta_{2})\hat{\bm{h}}_{i}^{k}</annotation></semantics></math>

</div>
<div id="alg1.l12" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg1.l12.1.1.1" class="ltx_text" style="font-size:80%;">12:</span></span>           <span id="alg1.l12.2" class="ltx_text ltx_font_bold">else</span>


</div>
<div id="alg1.l13" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg1.l13.1.1.1" class="ltx_text" style="font-size:80%;">13:</span></span>              <math id="alg1.l13.m1.1" class="ltx_Math" alttext="\bm{h}_{i}^{k}=\bm{h}_{i}^{k-1}" display="inline"><semantics id="alg1.l13.m1.1a"><mrow id="alg1.l13.m1.1.1" xref="alg1.l13.m1.1.1.cmml"><msubsup id="alg1.l13.m1.1.1.2" xref="alg1.l13.m1.1.1.2.cmml"><mi id="alg1.l13.m1.1.1.2.2.2" xref="alg1.l13.m1.1.1.2.2.2.cmml">𝒉</mi><mi id="alg1.l13.m1.1.1.2.2.3" xref="alg1.l13.m1.1.1.2.2.3.cmml">i</mi><mi id="alg1.l13.m1.1.1.2.3" xref="alg1.l13.m1.1.1.2.3.cmml">k</mi></msubsup><mo id="alg1.l13.m1.1.1.1" xref="alg1.l13.m1.1.1.1.cmml">=</mo><msubsup id="alg1.l13.m1.1.1.3" xref="alg1.l13.m1.1.1.3.cmml"><mi id="alg1.l13.m1.1.1.3.2.2" xref="alg1.l13.m1.1.1.3.2.2.cmml">𝒉</mi><mi id="alg1.l13.m1.1.1.3.2.3" xref="alg1.l13.m1.1.1.3.2.3.cmml">i</mi><mrow id="alg1.l13.m1.1.1.3.3" xref="alg1.l13.m1.1.1.3.3.cmml"><mi id="alg1.l13.m1.1.1.3.3.2" xref="alg1.l13.m1.1.1.3.3.2.cmml">k</mi><mo id="alg1.l13.m1.1.1.3.3.1" xref="alg1.l13.m1.1.1.3.3.1.cmml">−</mo><mn id="alg1.l13.m1.1.1.3.3.3" xref="alg1.l13.m1.1.1.3.3.3.cmml">1</mn></mrow></msubsup></mrow><annotation-xml encoding="MathML-Content" id="alg1.l13.m1.1b"><apply id="alg1.l13.m1.1.1.cmml" xref="alg1.l13.m1.1.1"><eq id="alg1.l13.m1.1.1.1.cmml" xref="alg1.l13.m1.1.1.1"></eq><apply id="alg1.l13.m1.1.1.2.cmml" xref="alg1.l13.m1.1.1.2"><csymbol cd="ambiguous" id="alg1.l13.m1.1.1.2.1.cmml" xref="alg1.l13.m1.1.1.2">superscript</csymbol><apply id="alg1.l13.m1.1.1.2.2.cmml" xref="alg1.l13.m1.1.1.2"><csymbol cd="ambiguous" id="alg1.l13.m1.1.1.2.2.1.cmml" xref="alg1.l13.m1.1.1.2">subscript</csymbol><ci id="alg1.l13.m1.1.1.2.2.2.cmml" xref="alg1.l13.m1.1.1.2.2.2">𝒉</ci><ci id="alg1.l13.m1.1.1.2.2.3.cmml" xref="alg1.l13.m1.1.1.2.2.3">𝑖</ci></apply><ci id="alg1.l13.m1.1.1.2.3.cmml" xref="alg1.l13.m1.1.1.2.3">𝑘</ci></apply><apply id="alg1.l13.m1.1.1.3.cmml" xref="alg1.l13.m1.1.1.3"><csymbol cd="ambiguous" id="alg1.l13.m1.1.1.3.1.cmml" xref="alg1.l13.m1.1.1.3">superscript</csymbol><apply id="alg1.l13.m1.1.1.3.2.cmml" xref="alg1.l13.m1.1.1.3"><csymbol cd="ambiguous" id="alg1.l13.m1.1.1.3.2.1.cmml" xref="alg1.l13.m1.1.1.3">subscript</csymbol><ci id="alg1.l13.m1.1.1.3.2.2.cmml" xref="alg1.l13.m1.1.1.3.2.2">𝒉</ci><ci id="alg1.l13.m1.1.1.3.2.3.cmml" xref="alg1.l13.m1.1.1.3.2.3">𝑖</ci></apply><apply id="alg1.l13.m1.1.1.3.3.cmml" xref="alg1.l13.m1.1.1.3.3"><minus id="alg1.l13.m1.1.1.3.3.1.cmml" xref="alg1.l13.m1.1.1.3.3.1"></minus><ci id="alg1.l13.m1.1.1.3.3.2.cmml" xref="alg1.l13.m1.1.1.3.3.2">𝑘</ci><cn type="integer" id="alg1.l13.m1.1.1.3.3.3.cmml" xref="alg1.l13.m1.1.1.3.3.3">1</cn></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l13.m1.1c">\bm{h}_{i}^{k}=\bm{h}_{i}^{k-1}</annotation></semantics></math>

</div>
<div id="alg1.l14" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">6</span><span class="ltx_tag ltx_tag_listingline"><span id="alg1.l14.1.1.1" class="ltx_text" style="font-size:80%;">14:</span></span>           <span id="alg1.l14.2" class="ltx_text ltx_font_bold">end</span> <span id="alg1.l14.3" class="ltx_text ltx_font_bold">if</span>
</div>
<div id="alg1.2.2.2.6" class="ltx_listingline">
</div>
<div id="alg1.l15" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg1.l15.1.1.1" class="ltx_text" style="font-size:80%;">15:</span></span>           Update the local model with weight decay:
<br class="ltx_break"><math id="alg1.l15.m1.1" class="ltx_Math" alttext="\bm{\theta}_{i}^{k}=\bm{\theta}_{i}^{k}-\eta\lambda\bm{\theta}_{i}^{k}" display="inline"><semantics id="alg1.l15.m1.1a"><mrow id="alg1.l15.m1.1.1" xref="alg1.l15.m1.1.1.cmml"><msubsup id="alg1.l15.m1.1.1.2" xref="alg1.l15.m1.1.1.2.cmml"><mi id="alg1.l15.m1.1.1.2.2.2" xref="alg1.l15.m1.1.1.2.2.2.cmml">𝜽</mi><mi id="alg1.l15.m1.1.1.2.2.3" xref="alg1.l15.m1.1.1.2.2.3.cmml">i</mi><mi id="alg1.l15.m1.1.1.2.3" xref="alg1.l15.m1.1.1.2.3.cmml">k</mi></msubsup><mo id="alg1.l15.m1.1.1.1" xref="alg1.l15.m1.1.1.1.cmml">=</mo><mrow id="alg1.l15.m1.1.1.3" xref="alg1.l15.m1.1.1.3.cmml"><msubsup id="alg1.l15.m1.1.1.3.2" xref="alg1.l15.m1.1.1.3.2.cmml"><mi id="alg1.l15.m1.1.1.3.2.2.2" xref="alg1.l15.m1.1.1.3.2.2.2.cmml">𝜽</mi><mi id="alg1.l15.m1.1.1.3.2.2.3" xref="alg1.l15.m1.1.1.3.2.2.3.cmml">i</mi><mi id="alg1.l15.m1.1.1.3.2.3" xref="alg1.l15.m1.1.1.3.2.3.cmml">k</mi></msubsup><mo id="alg1.l15.m1.1.1.3.1" xref="alg1.l15.m1.1.1.3.1.cmml">−</mo><mrow id="alg1.l15.m1.1.1.3.3" xref="alg1.l15.m1.1.1.3.3.cmml"><mi id="alg1.l15.m1.1.1.3.3.2" xref="alg1.l15.m1.1.1.3.3.2.cmml">η</mi><mo lspace="0em" rspace="0em" id="alg1.l15.m1.1.1.3.3.1" xref="alg1.l15.m1.1.1.3.3.1.cmml">​</mo><mi id="alg1.l15.m1.1.1.3.3.3" xref="alg1.l15.m1.1.1.3.3.3.cmml">λ</mi><mo lspace="0em" rspace="0em" id="alg1.l15.m1.1.1.3.3.1a" xref="alg1.l15.m1.1.1.3.3.1.cmml">​</mo><msubsup id="alg1.l15.m1.1.1.3.3.4" xref="alg1.l15.m1.1.1.3.3.4.cmml"><mi id="alg1.l15.m1.1.1.3.3.4.2.2" xref="alg1.l15.m1.1.1.3.3.4.2.2.cmml">𝜽</mi><mi id="alg1.l15.m1.1.1.3.3.4.2.3" xref="alg1.l15.m1.1.1.3.3.4.2.3.cmml">i</mi><mi id="alg1.l15.m1.1.1.3.3.4.3" xref="alg1.l15.m1.1.1.3.3.4.3.cmml">k</mi></msubsup></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l15.m1.1b"><apply id="alg1.l15.m1.1.1.cmml" xref="alg1.l15.m1.1.1"><eq id="alg1.l15.m1.1.1.1.cmml" xref="alg1.l15.m1.1.1.1"></eq><apply id="alg1.l15.m1.1.1.2.cmml" xref="alg1.l15.m1.1.1.2"><csymbol cd="ambiguous" id="alg1.l15.m1.1.1.2.1.cmml" xref="alg1.l15.m1.1.1.2">superscript</csymbol><apply id="alg1.l15.m1.1.1.2.2.cmml" xref="alg1.l15.m1.1.1.2"><csymbol cd="ambiguous" id="alg1.l15.m1.1.1.2.2.1.cmml" xref="alg1.l15.m1.1.1.2">subscript</csymbol><ci id="alg1.l15.m1.1.1.2.2.2.cmml" xref="alg1.l15.m1.1.1.2.2.2">𝜽</ci><ci id="alg1.l15.m1.1.1.2.2.3.cmml" xref="alg1.l15.m1.1.1.2.2.3">𝑖</ci></apply><ci id="alg1.l15.m1.1.1.2.3.cmml" xref="alg1.l15.m1.1.1.2.3">𝑘</ci></apply><apply id="alg1.l15.m1.1.1.3.cmml" xref="alg1.l15.m1.1.1.3"><minus id="alg1.l15.m1.1.1.3.1.cmml" xref="alg1.l15.m1.1.1.3.1"></minus><apply id="alg1.l15.m1.1.1.3.2.cmml" xref="alg1.l15.m1.1.1.3.2"><csymbol cd="ambiguous" id="alg1.l15.m1.1.1.3.2.1.cmml" xref="alg1.l15.m1.1.1.3.2">superscript</csymbol><apply id="alg1.l15.m1.1.1.3.2.2.cmml" xref="alg1.l15.m1.1.1.3.2"><csymbol cd="ambiguous" id="alg1.l15.m1.1.1.3.2.2.1.cmml" xref="alg1.l15.m1.1.1.3.2">subscript</csymbol><ci id="alg1.l15.m1.1.1.3.2.2.2.cmml" xref="alg1.l15.m1.1.1.3.2.2.2">𝜽</ci><ci id="alg1.l15.m1.1.1.3.2.2.3.cmml" xref="alg1.l15.m1.1.1.3.2.2.3">𝑖</ci></apply><ci id="alg1.l15.m1.1.1.3.2.3.cmml" xref="alg1.l15.m1.1.1.3.2.3">𝑘</ci></apply><apply id="alg1.l15.m1.1.1.3.3.cmml" xref="alg1.l15.m1.1.1.3.3"><times id="alg1.l15.m1.1.1.3.3.1.cmml" xref="alg1.l15.m1.1.1.3.3.1"></times><ci id="alg1.l15.m1.1.1.3.3.2.cmml" xref="alg1.l15.m1.1.1.3.3.2">𝜂</ci><ci id="alg1.l15.m1.1.1.3.3.3.cmml" xref="alg1.l15.m1.1.1.3.3.3">𝜆</ci><apply id="alg1.l15.m1.1.1.3.3.4.cmml" xref="alg1.l15.m1.1.1.3.3.4"><csymbol cd="ambiguous" id="alg1.l15.m1.1.1.3.3.4.1.cmml" xref="alg1.l15.m1.1.1.3.3.4">superscript</csymbol><apply id="alg1.l15.m1.1.1.3.3.4.2.cmml" xref="alg1.l15.m1.1.1.3.3.4"><csymbol cd="ambiguous" id="alg1.l15.m1.1.1.3.3.4.2.1.cmml" xref="alg1.l15.m1.1.1.3.3.4">subscript</csymbol><ci id="alg1.l15.m1.1.1.3.3.4.2.2.cmml" xref="alg1.l15.m1.1.1.3.3.4.2.2">𝜽</ci><ci id="alg1.l15.m1.1.1.3.3.4.2.3.cmml" xref="alg1.l15.m1.1.1.3.3.4.2.3">𝑖</ci></apply><ci id="alg1.l15.m1.1.1.3.3.4.3.cmml" xref="alg1.l15.m1.1.1.3.3.4.3">𝑘</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l15.m1.1c">\bm{\theta}_{i}^{k}=\bm{\theta}_{i}^{k}-\eta\lambda\bm{\theta}_{i}^{k}</annotation></semantics></math>

</div>
<div id="alg1.l16" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg1.l16.1.1.1" class="ltx_text" style="font-size:80%;">16:</span></span>           Update the local model: <math id="alg1.l16.m1.4" class="ltx_Math" alttext="\bm{\theta}_{i}^{k+1}=\bm{\theta}_{i}^{k}-\eta\text{clip}\left(\frac{\bm{m}_{i}^{k}}{\max(\bm{h}_{i}^{k},\epsilon)},\rho\right)" display="inline"><semantics id="alg1.l16.m1.4a"><mrow id="alg1.l16.m1.4.5" xref="alg1.l16.m1.4.5.cmml"><msubsup id="alg1.l16.m1.4.5.2" xref="alg1.l16.m1.4.5.2.cmml"><mi id="alg1.l16.m1.4.5.2.2.2" xref="alg1.l16.m1.4.5.2.2.2.cmml">𝜽</mi><mi id="alg1.l16.m1.4.5.2.2.3" xref="alg1.l16.m1.4.5.2.2.3.cmml">i</mi><mrow id="alg1.l16.m1.4.5.2.3" xref="alg1.l16.m1.4.5.2.3.cmml"><mi id="alg1.l16.m1.4.5.2.3.2" xref="alg1.l16.m1.4.5.2.3.2.cmml">k</mi><mo id="alg1.l16.m1.4.5.2.3.1" xref="alg1.l16.m1.4.5.2.3.1.cmml">+</mo><mn id="alg1.l16.m1.4.5.2.3.3" xref="alg1.l16.m1.4.5.2.3.3.cmml">1</mn></mrow></msubsup><mo id="alg1.l16.m1.4.5.1" xref="alg1.l16.m1.4.5.1.cmml">=</mo><mrow id="alg1.l16.m1.4.5.3" xref="alg1.l16.m1.4.5.3.cmml"><msubsup id="alg1.l16.m1.4.5.3.2" xref="alg1.l16.m1.4.5.3.2.cmml"><mi id="alg1.l16.m1.4.5.3.2.2.2" xref="alg1.l16.m1.4.5.3.2.2.2.cmml">𝜽</mi><mi id="alg1.l16.m1.4.5.3.2.2.3" xref="alg1.l16.m1.4.5.3.2.2.3.cmml">i</mi><mi id="alg1.l16.m1.4.5.3.2.3" xref="alg1.l16.m1.4.5.3.2.3.cmml">k</mi></msubsup><mo id="alg1.l16.m1.4.5.3.1" xref="alg1.l16.m1.4.5.3.1.cmml">−</mo><mrow id="alg1.l16.m1.4.5.3.3" xref="alg1.l16.m1.4.5.3.3.cmml"><mi id="alg1.l16.m1.4.5.3.3.2" xref="alg1.l16.m1.4.5.3.3.2.cmml">η</mi><mo lspace="0em" rspace="0em" id="alg1.l16.m1.4.5.3.3.1" xref="alg1.l16.m1.4.5.3.3.1.cmml">​</mo><mtext id="alg1.l16.m1.4.5.3.3.3" xref="alg1.l16.m1.4.5.3.3.3a.cmml">clip</mtext><mo lspace="0em" rspace="0em" id="alg1.l16.m1.4.5.3.3.1a" xref="alg1.l16.m1.4.5.3.3.1.cmml">​</mo><mrow id="alg1.l16.m1.4.5.3.3.4.2" xref="alg1.l16.m1.4.5.3.3.4.1.cmml"><mo id="alg1.l16.m1.4.5.3.3.4.2.1" xref="alg1.l16.m1.4.5.3.3.4.1.cmml">(</mo><mfrac id="alg1.l16.m1.3.3" xref="alg1.l16.m1.3.3.cmml"><msubsup id="alg1.l16.m1.3.3.5" xref="alg1.l16.m1.3.3.5.cmml"><mi id="alg1.l16.m1.3.3.5.2.2" xref="alg1.l16.m1.3.3.5.2.2.cmml">𝒎</mi><mi id="alg1.l16.m1.3.3.5.2.3" xref="alg1.l16.m1.3.3.5.2.3.cmml">i</mi><mi id="alg1.l16.m1.3.3.5.3" xref="alg1.l16.m1.3.3.5.3.cmml">k</mi></msubsup><mrow id="alg1.l16.m1.3.3.3.3" xref="alg1.l16.m1.3.3.3.4.cmml"><mi id="alg1.l16.m1.1.1.1.1" xref="alg1.l16.m1.1.1.1.1.cmml">max</mi><mo id="alg1.l16.m1.3.3.3.3a" xref="alg1.l16.m1.3.3.3.4.cmml">⁡</mo><mrow id="alg1.l16.m1.3.3.3.3.1" xref="alg1.l16.m1.3.3.3.4.cmml"><mo stretchy="false" id="alg1.l16.m1.3.3.3.3.1.2" xref="alg1.l16.m1.3.3.3.4.cmml">(</mo><msubsup id="alg1.l16.m1.3.3.3.3.1.1" xref="alg1.l16.m1.3.3.3.3.1.1.cmml"><mi id="alg1.l16.m1.3.3.3.3.1.1.2.2" xref="alg1.l16.m1.3.3.3.3.1.1.2.2.cmml">𝒉</mi><mi id="alg1.l16.m1.3.3.3.3.1.1.2.3" xref="alg1.l16.m1.3.3.3.3.1.1.2.3.cmml">i</mi><mi id="alg1.l16.m1.3.3.3.3.1.1.3" xref="alg1.l16.m1.3.3.3.3.1.1.3.cmml">k</mi></msubsup><mo id="alg1.l16.m1.3.3.3.3.1.3" xref="alg1.l16.m1.3.3.3.4.cmml">,</mo><mi id="alg1.l16.m1.2.2.2.2" xref="alg1.l16.m1.2.2.2.2.cmml">ϵ</mi><mo stretchy="false" id="alg1.l16.m1.3.3.3.3.1.4" xref="alg1.l16.m1.3.3.3.4.cmml">)</mo></mrow></mrow></mfrac><mo id="alg1.l16.m1.4.5.3.3.4.2.2" xref="alg1.l16.m1.4.5.3.3.4.1.cmml">,</mo><mi id="alg1.l16.m1.4.4" xref="alg1.l16.m1.4.4.cmml">ρ</mi><mo id="alg1.l16.m1.4.5.3.3.4.2.3" xref="alg1.l16.m1.4.5.3.3.4.1.cmml">)</mo></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l16.m1.4b"><apply id="alg1.l16.m1.4.5.cmml" xref="alg1.l16.m1.4.5"><eq id="alg1.l16.m1.4.5.1.cmml" xref="alg1.l16.m1.4.5.1"></eq><apply id="alg1.l16.m1.4.5.2.cmml" xref="alg1.l16.m1.4.5.2"><csymbol cd="ambiguous" id="alg1.l16.m1.4.5.2.1.cmml" xref="alg1.l16.m1.4.5.2">superscript</csymbol><apply id="alg1.l16.m1.4.5.2.2.cmml" xref="alg1.l16.m1.4.5.2"><csymbol cd="ambiguous" id="alg1.l16.m1.4.5.2.2.1.cmml" xref="alg1.l16.m1.4.5.2">subscript</csymbol><ci id="alg1.l16.m1.4.5.2.2.2.cmml" xref="alg1.l16.m1.4.5.2.2.2">𝜽</ci><ci id="alg1.l16.m1.4.5.2.2.3.cmml" xref="alg1.l16.m1.4.5.2.2.3">𝑖</ci></apply><apply id="alg1.l16.m1.4.5.2.3.cmml" xref="alg1.l16.m1.4.5.2.3"><plus id="alg1.l16.m1.4.5.2.3.1.cmml" xref="alg1.l16.m1.4.5.2.3.1"></plus><ci id="alg1.l16.m1.4.5.2.3.2.cmml" xref="alg1.l16.m1.4.5.2.3.2">𝑘</ci><cn type="integer" id="alg1.l16.m1.4.5.2.3.3.cmml" xref="alg1.l16.m1.4.5.2.3.3">1</cn></apply></apply><apply id="alg1.l16.m1.4.5.3.cmml" xref="alg1.l16.m1.4.5.3"><minus id="alg1.l16.m1.4.5.3.1.cmml" xref="alg1.l16.m1.4.5.3.1"></minus><apply id="alg1.l16.m1.4.5.3.2.cmml" xref="alg1.l16.m1.4.5.3.2"><csymbol cd="ambiguous" id="alg1.l16.m1.4.5.3.2.1.cmml" xref="alg1.l16.m1.4.5.3.2">superscript</csymbol><apply id="alg1.l16.m1.4.5.3.2.2.cmml" xref="alg1.l16.m1.4.5.3.2"><csymbol cd="ambiguous" id="alg1.l16.m1.4.5.3.2.2.1.cmml" xref="alg1.l16.m1.4.5.3.2">subscript</csymbol><ci id="alg1.l16.m1.4.5.3.2.2.2.cmml" xref="alg1.l16.m1.4.5.3.2.2.2">𝜽</ci><ci id="alg1.l16.m1.4.5.3.2.2.3.cmml" xref="alg1.l16.m1.4.5.3.2.2.3">𝑖</ci></apply><ci id="alg1.l16.m1.4.5.3.2.3.cmml" xref="alg1.l16.m1.4.5.3.2.3">𝑘</ci></apply><apply id="alg1.l16.m1.4.5.3.3.cmml" xref="alg1.l16.m1.4.5.3.3"><times id="alg1.l16.m1.4.5.3.3.1.cmml" xref="alg1.l16.m1.4.5.3.3.1"></times><ci id="alg1.l16.m1.4.5.3.3.2.cmml" xref="alg1.l16.m1.4.5.3.3.2">𝜂</ci><ci id="alg1.l16.m1.4.5.3.3.3a.cmml" xref="alg1.l16.m1.4.5.3.3.3"><mtext id="alg1.l16.m1.4.5.3.3.3.cmml" xref="alg1.l16.m1.4.5.3.3.3">clip</mtext></ci><interval closure="open" id="alg1.l16.m1.4.5.3.3.4.1.cmml" xref="alg1.l16.m1.4.5.3.3.4.2"><apply id="alg1.l16.m1.3.3.cmml" xref="alg1.l16.m1.3.3"><divide id="alg1.l16.m1.3.3.4.cmml" xref="alg1.l16.m1.3.3"></divide><apply id="alg1.l16.m1.3.3.5.cmml" xref="alg1.l16.m1.3.3.5"><csymbol cd="ambiguous" id="alg1.l16.m1.3.3.5.1.cmml" xref="alg1.l16.m1.3.3.5">superscript</csymbol><apply id="alg1.l16.m1.3.3.5.2.cmml" xref="alg1.l16.m1.3.3.5"><csymbol cd="ambiguous" id="alg1.l16.m1.3.3.5.2.1.cmml" xref="alg1.l16.m1.3.3.5">subscript</csymbol><ci id="alg1.l16.m1.3.3.5.2.2.cmml" xref="alg1.l16.m1.3.3.5.2.2">𝒎</ci><ci id="alg1.l16.m1.3.3.5.2.3.cmml" xref="alg1.l16.m1.3.3.5.2.3">𝑖</ci></apply><ci id="alg1.l16.m1.3.3.5.3.cmml" xref="alg1.l16.m1.3.3.5.3">𝑘</ci></apply><apply id="alg1.l16.m1.3.3.3.4.cmml" xref="alg1.l16.m1.3.3.3.3"><max id="alg1.l16.m1.1.1.1.1.cmml" xref="alg1.l16.m1.1.1.1.1"></max><apply id="alg1.l16.m1.3.3.3.3.1.1.cmml" xref="alg1.l16.m1.3.3.3.3.1.1"><csymbol cd="ambiguous" id="alg1.l16.m1.3.3.3.3.1.1.1.cmml" xref="alg1.l16.m1.3.3.3.3.1.1">superscript</csymbol><apply id="alg1.l16.m1.3.3.3.3.1.1.2.cmml" xref="alg1.l16.m1.3.3.3.3.1.1"><csymbol cd="ambiguous" id="alg1.l16.m1.3.3.3.3.1.1.2.1.cmml" xref="alg1.l16.m1.3.3.3.3.1.1">subscript</csymbol><ci id="alg1.l16.m1.3.3.3.3.1.1.2.2.cmml" xref="alg1.l16.m1.3.3.3.3.1.1.2.2">𝒉</ci><ci id="alg1.l16.m1.3.3.3.3.1.1.2.3.cmml" xref="alg1.l16.m1.3.3.3.3.1.1.2.3">𝑖</ci></apply><ci id="alg1.l16.m1.3.3.3.3.1.1.3.cmml" xref="alg1.l16.m1.3.3.3.3.1.1.3">𝑘</ci></apply><ci id="alg1.l16.m1.2.2.2.2.cmml" xref="alg1.l16.m1.2.2.2.2">italic-ϵ</ci></apply></apply><ci id="alg1.l16.m1.4.4.cmml" xref="alg1.l16.m1.4.4">𝜌</ci></interval></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l16.m1.4c">\bm{\theta}_{i}^{k+1}=\bm{\theta}_{i}^{k}-\eta\text{clip}\left(\frac{\bm{m}_{i}^{k}}{\max(\bm{h}_{i}^{k},\epsilon)},\rho\right)</annotation></semantics></math>

</div>
<div id="alg1.l17" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg1.l17.1.1.1" class="ltx_text" style="font-size:80%;">17:</span></span>        <span id="alg1.l17.2" class="ltx_text ltx_font_bold">end</span> <span id="alg1.l17.3" class="ltx_text ltx_font_bold">for</span>
</div>
<div id="alg1.l18" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg1.l18.1.1.1" class="ltx_text" style="font-size:80%;">18:</span></span>        Send the updated local models <math id="alg1.l18.m1.1" class="ltx_Math" alttext="\bm{\theta}_{i}^{k+1}" display="inline"><semantics id="alg1.l18.m1.1a"><msubsup id="alg1.l18.m1.1.1" xref="alg1.l18.m1.1.1.cmml"><mi id="alg1.l18.m1.1.1.2.2" xref="alg1.l18.m1.1.1.2.2.cmml">𝜽</mi><mi id="alg1.l18.m1.1.1.2.3" xref="alg1.l18.m1.1.1.2.3.cmml">i</mi><mrow id="alg1.l18.m1.1.1.3" xref="alg1.l18.m1.1.1.3.cmml"><mi id="alg1.l18.m1.1.1.3.2" xref="alg1.l18.m1.1.1.3.2.cmml">k</mi><mo id="alg1.l18.m1.1.1.3.1" xref="alg1.l18.m1.1.1.3.1.cmml">+</mo><mn id="alg1.l18.m1.1.1.3.3" xref="alg1.l18.m1.1.1.3.3.cmml">1</mn></mrow></msubsup><annotation-xml encoding="MathML-Content" id="alg1.l18.m1.1b"><apply id="alg1.l18.m1.1.1.cmml" xref="alg1.l18.m1.1.1"><csymbol cd="ambiguous" id="alg1.l18.m1.1.1.1.cmml" xref="alg1.l18.m1.1.1">superscript</csymbol><apply id="alg1.l18.m1.1.1.2.cmml" xref="alg1.l18.m1.1.1"><csymbol cd="ambiguous" id="alg1.l18.m1.1.1.2.1.cmml" xref="alg1.l18.m1.1.1">subscript</csymbol><ci id="alg1.l18.m1.1.1.2.2.cmml" xref="alg1.l18.m1.1.1.2.2">𝜽</ci><ci id="alg1.l18.m1.1.1.2.3.cmml" xref="alg1.l18.m1.1.1.2.3">𝑖</ci></apply><apply id="alg1.l18.m1.1.1.3.cmml" xref="alg1.l18.m1.1.1.3"><plus id="alg1.l18.m1.1.1.3.1.cmml" xref="alg1.l18.m1.1.1.3.1"></plus><ci id="alg1.l18.m1.1.1.3.2.cmml" xref="alg1.l18.m1.1.1.3.2">𝑘</ci><cn type="integer" id="alg1.l18.m1.1.1.3.3.cmml" xref="alg1.l18.m1.1.1.3.3">1</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l18.m1.1c">\bm{\theta}_{i}^{k+1}</annotation></semantics></math> back to the server

</div>
<div id="alg1.l19" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">7</span><span class="ltx_tag ltx_tag_listingline"><span id="alg1.l19.1.1.1" class="ltx_text" style="font-size:80%;">19:</span></span>     <span id="alg1.l19.2" class="ltx_text ltx_font_bold">end</span> <span id="alg1.l19.3" class="ltx_text ltx_font_bold">for</span>
</div>
<div id="alg1.2.2.2.7" class="ltx_listingline">
</div>
<div id="alg1.l20" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg1.l20.1.1.1" class="ltx_text" style="font-size:80%;">20:</span></span>     Update the global model: <math id="alg1.l20.m1.1" class="ltx_Math" alttext="\bm{\Theta}^{k+1}=\frac{1}{N}\sum_{i=1}^{N}\bm{\theta}_{i}^{k+1}" display="inline"><semantics id="alg1.l20.m1.1a"><mrow id="alg1.l20.m1.1.1" xref="alg1.l20.m1.1.1.cmml"><msup id="alg1.l20.m1.1.1.2" xref="alg1.l20.m1.1.1.2.cmml"><mi id="alg1.l20.m1.1.1.2.2" xref="alg1.l20.m1.1.1.2.2.cmml">𝚯</mi><mrow id="alg1.l20.m1.1.1.2.3" xref="alg1.l20.m1.1.1.2.3.cmml"><mi id="alg1.l20.m1.1.1.2.3.2" xref="alg1.l20.m1.1.1.2.3.2.cmml">k</mi><mo id="alg1.l20.m1.1.1.2.3.1" xref="alg1.l20.m1.1.1.2.3.1.cmml">+</mo><mn id="alg1.l20.m1.1.1.2.3.3" xref="alg1.l20.m1.1.1.2.3.3.cmml">1</mn></mrow></msup><mo id="alg1.l20.m1.1.1.1" xref="alg1.l20.m1.1.1.1.cmml">=</mo><mrow id="alg1.l20.m1.1.1.3" xref="alg1.l20.m1.1.1.3.cmml"><mfrac id="alg1.l20.m1.1.1.3.2" xref="alg1.l20.m1.1.1.3.2.cmml"><mn id="alg1.l20.m1.1.1.3.2.2" xref="alg1.l20.m1.1.1.3.2.2.cmml">1</mn><mi id="alg1.l20.m1.1.1.3.2.3" xref="alg1.l20.m1.1.1.3.2.3.cmml">N</mi></mfrac><mo lspace="0em" rspace="0em" id="alg1.l20.m1.1.1.3.1" xref="alg1.l20.m1.1.1.3.1.cmml">​</mo><mrow id="alg1.l20.m1.1.1.3.3" xref="alg1.l20.m1.1.1.3.3.cmml"><msubsup id="alg1.l20.m1.1.1.3.3.1" xref="alg1.l20.m1.1.1.3.3.1.cmml"><mo id="alg1.l20.m1.1.1.3.3.1.2.2" xref="alg1.l20.m1.1.1.3.3.1.2.2.cmml">∑</mo><mrow id="alg1.l20.m1.1.1.3.3.1.2.3" xref="alg1.l20.m1.1.1.3.3.1.2.3.cmml"><mi id="alg1.l20.m1.1.1.3.3.1.2.3.2" xref="alg1.l20.m1.1.1.3.3.1.2.3.2.cmml">i</mi><mo id="alg1.l20.m1.1.1.3.3.1.2.3.1" xref="alg1.l20.m1.1.1.3.3.1.2.3.1.cmml">=</mo><mn id="alg1.l20.m1.1.1.3.3.1.2.3.3" xref="alg1.l20.m1.1.1.3.3.1.2.3.3.cmml">1</mn></mrow><mi id="alg1.l20.m1.1.1.3.3.1.3" xref="alg1.l20.m1.1.1.3.3.1.3.cmml">N</mi></msubsup><msubsup id="alg1.l20.m1.1.1.3.3.2" xref="alg1.l20.m1.1.1.3.3.2.cmml"><mi id="alg1.l20.m1.1.1.3.3.2.2.2" xref="alg1.l20.m1.1.1.3.3.2.2.2.cmml">𝜽</mi><mi id="alg1.l20.m1.1.1.3.3.2.2.3" xref="alg1.l20.m1.1.1.3.3.2.2.3.cmml">i</mi><mrow id="alg1.l20.m1.1.1.3.3.2.3" xref="alg1.l20.m1.1.1.3.3.2.3.cmml"><mi id="alg1.l20.m1.1.1.3.3.2.3.2" xref="alg1.l20.m1.1.1.3.3.2.3.2.cmml">k</mi><mo id="alg1.l20.m1.1.1.3.3.2.3.1" xref="alg1.l20.m1.1.1.3.3.2.3.1.cmml">+</mo><mn id="alg1.l20.m1.1.1.3.3.2.3.3" xref="alg1.l20.m1.1.1.3.3.2.3.3.cmml">1</mn></mrow></msubsup></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg1.l20.m1.1b"><apply id="alg1.l20.m1.1.1.cmml" xref="alg1.l20.m1.1.1"><eq id="alg1.l20.m1.1.1.1.cmml" xref="alg1.l20.m1.1.1.1"></eq><apply id="alg1.l20.m1.1.1.2.cmml" xref="alg1.l20.m1.1.1.2"><csymbol cd="ambiguous" id="alg1.l20.m1.1.1.2.1.cmml" xref="alg1.l20.m1.1.1.2">superscript</csymbol><ci id="alg1.l20.m1.1.1.2.2.cmml" xref="alg1.l20.m1.1.1.2.2">𝚯</ci><apply id="alg1.l20.m1.1.1.2.3.cmml" xref="alg1.l20.m1.1.1.2.3"><plus id="alg1.l20.m1.1.1.2.3.1.cmml" xref="alg1.l20.m1.1.1.2.3.1"></plus><ci id="alg1.l20.m1.1.1.2.3.2.cmml" xref="alg1.l20.m1.1.1.2.3.2">𝑘</ci><cn type="integer" id="alg1.l20.m1.1.1.2.3.3.cmml" xref="alg1.l20.m1.1.1.2.3.3">1</cn></apply></apply><apply id="alg1.l20.m1.1.1.3.cmml" xref="alg1.l20.m1.1.1.3"><times id="alg1.l20.m1.1.1.3.1.cmml" xref="alg1.l20.m1.1.1.3.1"></times><apply id="alg1.l20.m1.1.1.3.2.cmml" xref="alg1.l20.m1.1.1.3.2"><divide id="alg1.l20.m1.1.1.3.2.1.cmml" xref="alg1.l20.m1.1.1.3.2"></divide><cn type="integer" id="alg1.l20.m1.1.1.3.2.2.cmml" xref="alg1.l20.m1.1.1.3.2.2">1</cn><ci id="alg1.l20.m1.1.1.3.2.3.cmml" xref="alg1.l20.m1.1.1.3.2.3">𝑁</ci></apply><apply id="alg1.l20.m1.1.1.3.3.cmml" xref="alg1.l20.m1.1.1.3.3"><apply id="alg1.l20.m1.1.1.3.3.1.cmml" xref="alg1.l20.m1.1.1.3.3.1"><csymbol cd="ambiguous" id="alg1.l20.m1.1.1.3.3.1.1.cmml" xref="alg1.l20.m1.1.1.3.3.1">superscript</csymbol><apply id="alg1.l20.m1.1.1.3.3.1.2.cmml" xref="alg1.l20.m1.1.1.3.3.1"><csymbol cd="ambiguous" id="alg1.l20.m1.1.1.3.3.1.2.1.cmml" xref="alg1.l20.m1.1.1.3.3.1">subscript</csymbol><sum id="alg1.l20.m1.1.1.3.3.1.2.2.cmml" xref="alg1.l20.m1.1.1.3.3.1.2.2"></sum><apply id="alg1.l20.m1.1.1.3.3.1.2.3.cmml" xref="alg1.l20.m1.1.1.3.3.1.2.3"><eq id="alg1.l20.m1.1.1.3.3.1.2.3.1.cmml" xref="alg1.l20.m1.1.1.3.3.1.2.3.1"></eq><ci id="alg1.l20.m1.1.1.3.3.1.2.3.2.cmml" xref="alg1.l20.m1.1.1.3.3.1.2.3.2">𝑖</ci><cn type="integer" id="alg1.l20.m1.1.1.3.3.1.2.3.3.cmml" xref="alg1.l20.m1.1.1.3.3.1.2.3.3">1</cn></apply></apply><ci id="alg1.l20.m1.1.1.3.3.1.3.cmml" xref="alg1.l20.m1.1.1.3.3.1.3">𝑁</ci></apply><apply id="alg1.l20.m1.1.1.3.3.2.cmml" xref="alg1.l20.m1.1.1.3.3.2"><csymbol cd="ambiguous" id="alg1.l20.m1.1.1.3.3.2.1.cmml" xref="alg1.l20.m1.1.1.3.3.2">superscript</csymbol><apply id="alg1.l20.m1.1.1.3.3.2.2.cmml" xref="alg1.l20.m1.1.1.3.3.2"><csymbol cd="ambiguous" id="alg1.l20.m1.1.1.3.3.2.2.1.cmml" xref="alg1.l20.m1.1.1.3.3.2">subscript</csymbol><ci id="alg1.l20.m1.1.1.3.3.2.2.2.cmml" xref="alg1.l20.m1.1.1.3.3.2.2.2">𝜽</ci><ci id="alg1.l20.m1.1.1.3.3.2.2.3.cmml" xref="alg1.l20.m1.1.1.3.3.2.2.3">𝑖</ci></apply><apply id="alg1.l20.m1.1.1.3.3.2.3.cmml" xref="alg1.l20.m1.1.1.3.3.2.3"><plus id="alg1.l20.m1.1.1.3.3.2.3.1.cmml" xref="alg1.l20.m1.1.1.3.3.2.3.1"></plus><ci id="alg1.l20.m1.1.1.3.3.2.3.2.cmml" xref="alg1.l20.m1.1.1.3.3.2.3.2">𝑘</ci><cn type="integer" id="alg1.l20.m1.1.1.3.3.2.3.3.cmml" xref="alg1.l20.m1.1.1.3.3.2.3.3">1</cn></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg1.l20.m1.1c">\bm{\Theta}^{k+1}=\frac{1}{N}\sum_{i=1}^{N}\bm{\theta}_{i}^{k+1}</annotation></semantics></math>

</div>
<div id="alg1.l21" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg1.l21.1.1.1" class="ltx_text" style="font-size:80%;">21:</span></span>  <span id="alg1.l21.2" class="ltx_text ltx_font_bold">end</span> <span id="alg1.l21.3" class="ltx_text ltx_font_bold">for</span>
</div>
</div>

</div>
</div>
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_float"><span id="alg1.4.1.1" class="ltx_text ltx_font_bold">Algorithm 1</span> </span>Federated Sophia (Fed-Sohpia)</figcaption>
</figure>
<section id="S4.SS1" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection"><span id="S4.SS1.4.1.1" class="ltx_text">IV-A</span> </span><span id="S4.SS1.5.2" class="ltx_text ltx_font_italic">Hessian as a Pre-conditioner</span>
</h3>

<div id="S4.SS1.p1" class="ltx_para">
<p id="S4.SS1.p1.1" class="ltx_p">One problem with first-order methods, like FedAvg, is their inability to incorporate curvature information during the optimization process. Curvature information is best obtained using the Hessian matrix. At the <math id="S4.SS1.p1.1.m1.1" class="ltx_Math" alttext="k" display="inline"><semantics id="S4.SS1.p1.1.m1.1a"><mi id="S4.SS1.p1.1.m1.1.1" xref="S4.SS1.p1.1.m1.1.1.cmml">k</mi><annotation-xml encoding="MathML-Content" id="S4.SS1.p1.1.m1.1b"><ci id="S4.SS1.p1.1.m1.1.1.cmml" xref="S4.SS1.p1.1.m1.1.1">𝑘</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p1.1.m1.1c">k</annotation></semantics></math>th communication round, a general descent direction can be obtained as follows</p>
<table id="Sx1.EGx5" class="ltx_equationgroup ltx_eqn_align ltx_eqn_table">

<tbody id="S4.E5"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math id="S4.E5.m1.1" class="ltx_Math" alttext="\displaystyle\Delta\bm{\theta}_{i}^{k}\triangleq\bm{\theta}_{i}^{k+1}-\bm{\theta}_{i}^{k}=(\bm{H}_{i}^{k})^{-s}\bm{g}_{i}^{k}." display="inline"><semantics id="S4.E5.m1.1a"><mrow id="S4.E5.m1.1.1.1" xref="S4.E5.m1.1.1.1.1.cmml"><mrow id="S4.E5.m1.1.1.1.1" xref="S4.E5.m1.1.1.1.1.cmml"><mrow id="S4.E5.m1.1.1.1.1.3" xref="S4.E5.m1.1.1.1.1.3.cmml"><mi mathvariant="normal" id="S4.E5.m1.1.1.1.1.3.2" xref="S4.E5.m1.1.1.1.1.3.2.cmml">Δ</mi><mo lspace="0em" rspace="0em" id="S4.E5.m1.1.1.1.1.3.1" xref="S4.E5.m1.1.1.1.1.3.1.cmml">​</mo><msubsup id="S4.E5.m1.1.1.1.1.3.3" xref="S4.E5.m1.1.1.1.1.3.3.cmml"><mi id="S4.E5.m1.1.1.1.1.3.3.2.2" xref="S4.E5.m1.1.1.1.1.3.3.2.2.cmml">𝜽</mi><mi id="S4.E5.m1.1.1.1.1.3.3.2.3" xref="S4.E5.m1.1.1.1.1.3.3.2.3.cmml">i</mi><mi id="S4.E5.m1.1.1.1.1.3.3.3" xref="S4.E5.m1.1.1.1.1.3.3.3.cmml">k</mi></msubsup></mrow><mo id="S4.E5.m1.1.1.1.1.4" xref="S4.E5.m1.1.1.1.1.4.cmml">≜</mo><mrow id="S4.E5.m1.1.1.1.1.5" xref="S4.E5.m1.1.1.1.1.5.cmml"><msubsup id="S4.E5.m1.1.1.1.1.5.2" xref="S4.E5.m1.1.1.1.1.5.2.cmml"><mi id="S4.E5.m1.1.1.1.1.5.2.2.2" xref="S4.E5.m1.1.1.1.1.5.2.2.2.cmml">𝜽</mi><mi id="S4.E5.m1.1.1.1.1.5.2.2.3" xref="S4.E5.m1.1.1.1.1.5.2.2.3.cmml">i</mi><mrow id="S4.E5.m1.1.1.1.1.5.2.3" xref="S4.E5.m1.1.1.1.1.5.2.3.cmml"><mi id="S4.E5.m1.1.1.1.1.5.2.3.2" xref="S4.E5.m1.1.1.1.1.5.2.3.2.cmml">k</mi><mo id="S4.E5.m1.1.1.1.1.5.2.3.1" xref="S4.E5.m1.1.1.1.1.5.2.3.1.cmml">+</mo><mn id="S4.E5.m1.1.1.1.1.5.2.3.3" xref="S4.E5.m1.1.1.1.1.5.2.3.3.cmml">1</mn></mrow></msubsup><mo id="S4.E5.m1.1.1.1.1.5.1" xref="S4.E5.m1.1.1.1.1.5.1.cmml">−</mo><msubsup id="S4.E5.m1.1.1.1.1.5.3" xref="S4.E5.m1.1.1.1.1.5.3.cmml"><mi id="S4.E5.m1.1.1.1.1.5.3.2.2" xref="S4.E5.m1.1.1.1.1.5.3.2.2.cmml">𝜽</mi><mi id="S4.E5.m1.1.1.1.1.5.3.2.3" xref="S4.E5.m1.1.1.1.1.5.3.2.3.cmml">i</mi><mi id="S4.E5.m1.1.1.1.1.5.3.3" xref="S4.E5.m1.1.1.1.1.5.3.3.cmml">k</mi></msubsup></mrow><mo id="S4.E5.m1.1.1.1.1.6" xref="S4.E5.m1.1.1.1.1.6.cmml">=</mo><mrow id="S4.E5.m1.1.1.1.1.1" xref="S4.E5.m1.1.1.1.1.1.cmml"><msup id="S4.E5.m1.1.1.1.1.1.1" xref="S4.E5.m1.1.1.1.1.1.1.cmml"><mrow id="S4.E5.m1.1.1.1.1.1.1.1.1" xref="S4.E5.m1.1.1.1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S4.E5.m1.1.1.1.1.1.1.1.1.2" xref="S4.E5.m1.1.1.1.1.1.1.1.1.1.cmml">(</mo><msubsup id="S4.E5.m1.1.1.1.1.1.1.1.1.1" xref="S4.E5.m1.1.1.1.1.1.1.1.1.1.cmml"><mi id="S4.E5.m1.1.1.1.1.1.1.1.1.1.2.2" xref="S4.E5.m1.1.1.1.1.1.1.1.1.1.2.2.cmml">𝑯</mi><mi id="S4.E5.m1.1.1.1.1.1.1.1.1.1.2.3" xref="S4.E5.m1.1.1.1.1.1.1.1.1.1.2.3.cmml">i</mi><mi id="S4.E5.m1.1.1.1.1.1.1.1.1.1.3" xref="S4.E5.m1.1.1.1.1.1.1.1.1.1.3.cmml">k</mi></msubsup><mo stretchy="false" id="S4.E5.m1.1.1.1.1.1.1.1.1.3" xref="S4.E5.m1.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow><mrow id="S4.E5.m1.1.1.1.1.1.1.3" xref="S4.E5.m1.1.1.1.1.1.1.3.cmml"><mo id="S4.E5.m1.1.1.1.1.1.1.3a" xref="S4.E5.m1.1.1.1.1.1.1.3.cmml">−</mo><mi id="S4.E5.m1.1.1.1.1.1.1.3.2" xref="S4.E5.m1.1.1.1.1.1.1.3.2.cmml">s</mi></mrow></msup><mo lspace="0em" rspace="0em" id="S4.E5.m1.1.1.1.1.1.2" xref="S4.E5.m1.1.1.1.1.1.2.cmml">​</mo><msubsup id="S4.E5.m1.1.1.1.1.1.3" xref="S4.E5.m1.1.1.1.1.1.3.cmml"><mi id="S4.E5.m1.1.1.1.1.1.3.2.2" xref="S4.E5.m1.1.1.1.1.1.3.2.2.cmml">𝒈</mi><mi id="S4.E5.m1.1.1.1.1.1.3.2.3" xref="S4.E5.m1.1.1.1.1.1.3.2.3.cmml">i</mi><mi id="S4.E5.m1.1.1.1.1.1.3.3" xref="S4.E5.m1.1.1.1.1.1.3.3.cmml">k</mi></msubsup></mrow></mrow><mo lspace="0em" id="S4.E5.m1.1.1.1.2" xref="S4.E5.m1.1.1.1.1.cmml">.</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.E5.m1.1b"><apply id="S4.E5.m1.1.1.1.1.cmml" xref="S4.E5.m1.1.1.1"><and id="S4.E5.m1.1.1.1.1a.cmml" xref="S4.E5.m1.1.1.1"></and><apply id="S4.E5.m1.1.1.1.1b.cmml" xref="S4.E5.m1.1.1.1"><ci id="S4.E5.m1.1.1.1.1.4.cmml" xref="S4.E5.m1.1.1.1.1.4">≜</ci><apply id="S4.E5.m1.1.1.1.1.3.cmml" xref="S4.E5.m1.1.1.1.1.3"><times id="S4.E5.m1.1.1.1.1.3.1.cmml" xref="S4.E5.m1.1.1.1.1.3.1"></times><ci id="S4.E5.m1.1.1.1.1.3.2.cmml" xref="S4.E5.m1.1.1.1.1.3.2">Δ</ci><apply id="S4.E5.m1.1.1.1.1.3.3.cmml" xref="S4.E5.m1.1.1.1.1.3.3"><csymbol cd="ambiguous" id="S4.E5.m1.1.1.1.1.3.3.1.cmml" xref="S4.E5.m1.1.1.1.1.3.3">superscript</csymbol><apply id="S4.E5.m1.1.1.1.1.3.3.2.cmml" xref="S4.E5.m1.1.1.1.1.3.3"><csymbol cd="ambiguous" id="S4.E5.m1.1.1.1.1.3.3.2.1.cmml" xref="S4.E5.m1.1.1.1.1.3.3">subscript</csymbol><ci id="S4.E5.m1.1.1.1.1.3.3.2.2.cmml" xref="S4.E5.m1.1.1.1.1.3.3.2.2">𝜽</ci><ci id="S4.E5.m1.1.1.1.1.3.3.2.3.cmml" xref="S4.E5.m1.1.1.1.1.3.3.2.3">𝑖</ci></apply><ci id="S4.E5.m1.1.1.1.1.3.3.3.cmml" xref="S4.E5.m1.1.1.1.1.3.3.3">𝑘</ci></apply></apply><apply id="S4.E5.m1.1.1.1.1.5.cmml" xref="S4.E5.m1.1.1.1.1.5"><minus id="S4.E5.m1.1.1.1.1.5.1.cmml" xref="S4.E5.m1.1.1.1.1.5.1"></minus><apply id="S4.E5.m1.1.1.1.1.5.2.cmml" xref="S4.E5.m1.1.1.1.1.5.2"><csymbol cd="ambiguous" id="S4.E5.m1.1.1.1.1.5.2.1.cmml" xref="S4.E5.m1.1.1.1.1.5.2">superscript</csymbol><apply id="S4.E5.m1.1.1.1.1.5.2.2.cmml" xref="S4.E5.m1.1.1.1.1.5.2"><csymbol cd="ambiguous" id="S4.E5.m1.1.1.1.1.5.2.2.1.cmml" xref="S4.E5.m1.1.1.1.1.5.2">subscript</csymbol><ci id="S4.E5.m1.1.1.1.1.5.2.2.2.cmml" xref="S4.E5.m1.1.1.1.1.5.2.2.2">𝜽</ci><ci id="S4.E5.m1.1.1.1.1.5.2.2.3.cmml" xref="S4.E5.m1.1.1.1.1.5.2.2.3">𝑖</ci></apply><apply id="S4.E5.m1.1.1.1.1.5.2.3.cmml" xref="S4.E5.m1.1.1.1.1.5.2.3"><plus id="S4.E5.m1.1.1.1.1.5.2.3.1.cmml" xref="S4.E5.m1.1.1.1.1.5.2.3.1"></plus><ci id="S4.E5.m1.1.1.1.1.5.2.3.2.cmml" xref="S4.E5.m1.1.1.1.1.5.2.3.2">𝑘</ci><cn type="integer" id="S4.E5.m1.1.1.1.1.5.2.3.3.cmml" xref="S4.E5.m1.1.1.1.1.5.2.3.3">1</cn></apply></apply><apply id="S4.E5.m1.1.1.1.1.5.3.cmml" xref="S4.E5.m1.1.1.1.1.5.3"><csymbol cd="ambiguous" id="S4.E5.m1.1.1.1.1.5.3.1.cmml" xref="S4.E5.m1.1.1.1.1.5.3">superscript</csymbol><apply id="S4.E5.m1.1.1.1.1.5.3.2.cmml" xref="S4.E5.m1.1.1.1.1.5.3"><csymbol cd="ambiguous" id="S4.E5.m1.1.1.1.1.5.3.2.1.cmml" xref="S4.E5.m1.1.1.1.1.5.3">subscript</csymbol><ci id="S4.E5.m1.1.1.1.1.5.3.2.2.cmml" xref="S4.E5.m1.1.1.1.1.5.3.2.2">𝜽</ci><ci id="S4.E5.m1.1.1.1.1.5.3.2.3.cmml" xref="S4.E5.m1.1.1.1.1.5.3.2.3">𝑖</ci></apply><ci id="S4.E5.m1.1.1.1.1.5.3.3.cmml" xref="S4.E5.m1.1.1.1.1.5.3.3">𝑘</ci></apply></apply></apply><apply id="S4.E5.m1.1.1.1.1c.cmml" xref="S4.E5.m1.1.1.1"><eq id="S4.E5.m1.1.1.1.1.6.cmml" xref="S4.E5.m1.1.1.1.1.6"></eq><share href="#S4.E5.m1.1.1.1.1.5.cmml" id="S4.E5.m1.1.1.1.1d.cmml" xref="S4.E5.m1.1.1.1"></share><apply id="S4.E5.m1.1.1.1.1.1.cmml" xref="S4.E5.m1.1.1.1.1.1"><times id="S4.E5.m1.1.1.1.1.1.2.cmml" xref="S4.E5.m1.1.1.1.1.1.2"></times><apply id="S4.E5.m1.1.1.1.1.1.1.cmml" xref="S4.E5.m1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.E5.m1.1.1.1.1.1.1.2.cmml" xref="S4.E5.m1.1.1.1.1.1.1">superscript</csymbol><apply id="S4.E5.m1.1.1.1.1.1.1.1.1.1.cmml" xref="S4.E5.m1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.E5.m1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S4.E5.m1.1.1.1.1.1.1.1.1">superscript</csymbol><apply id="S4.E5.m1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S4.E5.m1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.E5.m1.1.1.1.1.1.1.1.1.1.2.1.cmml" xref="S4.E5.m1.1.1.1.1.1.1.1.1">subscript</csymbol><ci id="S4.E5.m1.1.1.1.1.1.1.1.1.1.2.2.cmml" xref="S4.E5.m1.1.1.1.1.1.1.1.1.1.2.2">𝑯</ci><ci id="S4.E5.m1.1.1.1.1.1.1.1.1.1.2.3.cmml" xref="S4.E5.m1.1.1.1.1.1.1.1.1.1.2.3">𝑖</ci></apply><ci id="S4.E5.m1.1.1.1.1.1.1.1.1.1.3.cmml" xref="S4.E5.m1.1.1.1.1.1.1.1.1.1.3">𝑘</ci></apply><apply id="S4.E5.m1.1.1.1.1.1.1.3.cmml" xref="S4.E5.m1.1.1.1.1.1.1.3"><minus id="S4.E5.m1.1.1.1.1.1.1.3.1.cmml" xref="S4.E5.m1.1.1.1.1.1.1.3"></minus><ci id="S4.E5.m1.1.1.1.1.1.1.3.2.cmml" xref="S4.E5.m1.1.1.1.1.1.1.3.2">𝑠</ci></apply></apply><apply id="S4.E5.m1.1.1.1.1.1.3.cmml" xref="S4.E5.m1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S4.E5.m1.1.1.1.1.1.3.1.cmml" xref="S4.E5.m1.1.1.1.1.1.3">superscript</csymbol><apply id="S4.E5.m1.1.1.1.1.1.3.2.cmml" xref="S4.E5.m1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S4.E5.m1.1.1.1.1.1.3.2.1.cmml" xref="S4.E5.m1.1.1.1.1.1.3">subscript</csymbol><ci id="S4.E5.m1.1.1.1.1.1.3.2.2.cmml" xref="S4.E5.m1.1.1.1.1.1.3.2.2">𝒈</ci><ci id="S4.E5.m1.1.1.1.1.1.3.2.3.cmml" xref="S4.E5.m1.1.1.1.1.1.3.2.3">𝑖</ci></apply><ci id="S4.E5.m1.1.1.1.1.1.3.3.cmml" xref="S4.E5.m1.1.1.1.1.1.3.3">𝑘</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.E5.m1.1c">\displaystyle\Delta\bm{\theta}_{i}^{k}\triangleq\bm{\theta}_{i}^{k+1}-\bm{\theta}_{i}^{k}=(\bm{H}_{i}^{k})^{-s}\bm{g}_{i}^{k}.</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(5)</span></td>
</tr></tbody>
</table>
<p id="S4.SS1.p1.4" class="ltx_p">Herein, <math id="S4.SS1.p1.2.m1.1" class="ltx_Math" alttext="s=1" display="inline"><semantics id="S4.SS1.p1.2.m1.1a"><mrow id="S4.SS1.p1.2.m1.1.1" xref="S4.SS1.p1.2.m1.1.1.cmml"><mi id="S4.SS1.p1.2.m1.1.1.2" xref="S4.SS1.p1.2.m1.1.1.2.cmml">s</mi><mo id="S4.SS1.p1.2.m1.1.1.1" xref="S4.SS1.p1.2.m1.1.1.1.cmml">=</mo><mn id="S4.SS1.p1.2.m1.1.1.3" xref="S4.SS1.p1.2.m1.1.1.3.cmml">1</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.p1.2.m1.1b"><apply id="S4.SS1.p1.2.m1.1.1.cmml" xref="S4.SS1.p1.2.m1.1.1"><eq id="S4.SS1.p1.2.m1.1.1.1.cmml" xref="S4.SS1.p1.2.m1.1.1.1"></eq><ci id="S4.SS1.p1.2.m1.1.1.2.cmml" xref="S4.SS1.p1.2.m1.1.1.2">𝑠</ci><cn type="integer" id="S4.SS1.p1.2.m1.1.1.3.cmml" xref="S4.SS1.p1.2.m1.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p1.2.m1.1c">s=1</annotation></semantics></math> corresponds to the vanilla Newton method, while <math id="S4.SS1.p1.3.m2.1" class="ltx_Math" alttext="s=0" display="inline"><semantics id="S4.SS1.p1.3.m2.1a"><mrow id="S4.SS1.p1.3.m2.1.1" xref="S4.SS1.p1.3.m2.1.1.cmml"><mi id="S4.SS1.p1.3.m2.1.1.2" xref="S4.SS1.p1.3.m2.1.1.2.cmml">s</mi><mo id="S4.SS1.p1.3.m2.1.1.1" xref="S4.SS1.p1.3.m2.1.1.1.cmml">=</mo><mn id="S4.SS1.p1.3.m2.1.1.3" xref="S4.SS1.p1.3.m2.1.1.3.cmml">0</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.p1.3.m2.1b"><apply id="S4.SS1.p1.3.m2.1.1.cmml" xref="S4.SS1.p1.3.m2.1.1"><eq id="S4.SS1.p1.3.m2.1.1.1.cmml" xref="S4.SS1.p1.3.m2.1.1.1"></eq><ci id="S4.SS1.p1.3.m2.1.1.2.cmml" xref="S4.SS1.p1.3.m2.1.1.2">𝑠</ci><cn type="integer" id="S4.SS1.p1.3.m2.1.1.3.cmml" xref="S4.SS1.p1.3.m2.1.1.3">0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p1.3.m2.1c">s=0</annotation></semantics></math> rolls back to the gradient descent method. The idea of the Hessian as a pre-conditioner, as shown in (<a href="#S4.E5" title="In IV-A Hessian as a Pre-conditioner ‣ IV Proposed Algorithm ‣ Fed-Sophia: A Communication-Efficient Second-Order Federated Learning Algorithm Identify applicable funding agency here. If none, delete this." class="ltx_ref"><span class="ltx_text ltx_ref_tag">5</span></a>), is that it adapts the step size taken along the descent direction by <math id="S4.SS1.p1.4.m3.1" class="ltx_Math" alttext="(\bm{H}_{i}^{k})^{-1}" display="inline"><semantics id="S4.SS1.p1.4.m3.1a"><msup id="S4.SS1.p1.4.m3.1.1" xref="S4.SS1.p1.4.m3.1.1.cmml"><mrow id="S4.SS1.p1.4.m3.1.1.1.1" xref="S4.SS1.p1.4.m3.1.1.1.1.1.cmml"><mo stretchy="false" id="S4.SS1.p1.4.m3.1.1.1.1.2" xref="S4.SS1.p1.4.m3.1.1.1.1.1.cmml">(</mo><msubsup id="S4.SS1.p1.4.m3.1.1.1.1.1" xref="S4.SS1.p1.4.m3.1.1.1.1.1.cmml"><mi id="S4.SS1.p1.4.m3.1.1.1.1.1.2.2" xref="S4.SS1.p1.4.m3.1.1.1.1.1.2.2.cmml">𝑯</mi><mi id="S4.SS1.p1.4.m3.1.1.1.1.1.2.3" xref="S4.SS1.p1.4.m3.1.1.1.1.1.2.3.cmml">i</mi><mi id="S4.SS1.p1.4.m3.1.1.1.1.1.3" xref="S4.SS1.p1.4.m3.1.1.1.1.1.3.cmml">k</mi></msubsup><mo stretchy="false" id="S4.SS1.p1.4.m3.1.1.1.1.3" xref="S4.SS1.p1.4.m3.1.1.1.1.1.cmml">)</mo></mrow><mrow id="S4.SS1.p1.4.m3.1.1.3" xref="S4.SS1.p1.4.m3.1.1.3.cmml"><mo id="S4.SS1.p1.4.m3.1.1.3a" xref="S4.SS1.p1.4.m3.1.1.3.cmml">−</mo><mn id="S4.SS1.p1.4.m3.1.1.3.2" xref="S4.SS1.p1.4.m3.1.1.3.2.cmml">1</mn></mrow></msup><annotation-xml encoding="MathML-Content" id="S4.SS1.p1.4.m3.1b"><apply id="S4.SS1.p1.4.m3.1.1.cmml" xref="S4.SS1.p1.4.m3.1.1"><csymbol cd="ambiguous" id="S4.SS1.p1.4.m3.1.1.2.cmml" xref="S4.SS1.p1.4.m3.1.1">superscript</csymbol><apply id="S4.SS1.p1.4.m3.1.1.1.1.1.cmml" xref="S4.SS1.p1.4.m3.1.1.1.1"><csymbol cd="ambiguous" id="S4.SS1.p1.4.m3.1.1.1.1.1.1.cmml" xref="S4.SS1.p1.4.m3.1.1.1.1">superscript</csymbol><apply id="S4.SS1.p1.4.m3.1.1.1.1.1.2.cmml" xref="S4.SS1.p1.4.m3.1.1.1.1"><csymbol cd="ambiguous" id="S4.SS1.p1.4.m3.1.1.1.1.1.2.1.cmml" xref="S4.SS1.p1.4.m3.1.1.1.1">subscript</csymbol><ci id="S4.SS1.p1.4.m3.1.1.1.1.1.2.2.cmml" xref="S4.SS1.p1.4.m3.1.1.1.1.1.2.2">𝑯</ci><ci id="S4.SS1.p1.4.m3.1.1.1.1.1.2.3.cmml" xref="S4.SS1.p1.4.m3.1.1.1.1.1.2.3">𝑖</ci></apply><ci id="S4.SS1.p1.4.m3.1.1.1.1.1.3.cmml" xref="S4.SS1.p1.4.m3.1.1.1.1.1.3">𝑘</ci></apply><apply id="S4.SS1.p1.4.m3.1.1.3.cmml" xref="S4.SS1.p1.4.m3.1.1.3"><minus id="S4.SS1.p1.4.m3.1.1.3.1.cmml" xref="S4.SS1.p1.4.m3.1.1.3"></minus><cn type="integer" id="S4.SS1.p1.4.m3.1.1.3.2.cmml" xref="S4.SS1.p1.4.m3.1.1.3.2">1</cn></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p1.4.m3.1c">(\bm{H}_{i}^{k})^{-1}</annotation></semantics></math>.</p>
</div>
<div id="S4.SS1.p2" class="ltx_para">
<p id="S4.SS1.p2.12" class="ltx_p">Computing the full Hessian is almost impossible in the case of a very large NN. This makes certain FL algorithms impractical in real-world settings. One way to estimate the Hessian is by computing the diagonal information only<cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib18" title="" class="ltx_ref">18</a>]</cite>. The diagonal elements of the Hessian contain curvature information across each dimension. Thus, (<a href="#S4.E5" title="In IV-A Hessian as a Pre-conditioner ‣ IV Proposed Algorithm ‣ Fed-Sophia: A Communication-Efficient Second-Order Federated Learning Algorithm Identify applicable funding agency here. If none, delete this." class="ltx_ref"><span class="ltx_text ltx_ref_tag">5</span></a>) can be approximated as</p>
<table id="Sx1.EGx6" class="ltx_equationgroup ltx_eqn_align ltx_eqn_table">

<tbody id="S4.E6"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math id="S4.E6.m1.1" class="ltx_Math" alttext="\displaystyle\Delta\bm{\theta}_{i}^{k}\approx\textit{diag}(\bm{H}_{i}^{k})^{-1}\bm{g}_{i}^{k}." display="inline"><semantics id="S4.E6.m1.1a"><mrow id="S4.E6.m1.1.1.1" xref="S4.E6.m1.1.1.1.1.cmml"><mrow id="S4.E6.m1.1.1.1.1" xref="S4.E6.m1.1.1.1.1.cmml"><mrow id="S4.E6.m1.1.1.1.1.3" xref="S4.E6.m1.1.1.1.1.3.cmml"><mi mathvariant="normal" id="S4.E6.m1.1.1.1.1.3.2" xref="S4.E6.m1.1.1.1.1.3.2.cmml">Δ</mi><mo lspace="0em" rspace="0em" id="S4.E6.m1.1.1.1.1.3.1" xref="S4.E6.m1.1.1.1.1.3.1.cmml">​</mo><msubsup id="S4.E6.m1.1.1.1.1.3.3" xref="S4.E6.m1.1.1.1.1.3.3.cmml"><mi id="S4.E6.m1.1.1.1.1.3.3.2.2" xref="S4.E6.m1.1.1.1.1.3.3.2.2.cmml">𝜽</mi><mi id="S4.E6.m1.1.1.1.1.3.3.2.3" xref="S4.E6.m1.1.1.1.1.3.3.2.3.cmml">i</mi><mi id="S4.E6.m1.1.1.1.1.3.3.3" xref="S4.E6.m1.1.1.1.1.3.3.3.cmml">k</mi></msubsup></mrow><mo id="S4.E6.m1.1.1.1.1.2" xref="S4.E6.m1.1.1.1.1.2.cmml">≈</mo><mrow id="S4.E6.m1.1.1.1.1.1" xref="S4.E6.m1.1.1.1.1.1.cmml"><mtext class="ltx_mathvariant_italic" id="S4.E6.m1.1.1.1.1.1.3" xref="S4.E6.m1.1.1.1.1.1.3a.cmml">diag</mtext><mo lspace="0em" rspace="0em" id="S4.E6.m1.1.1.1.1.1.2" xref="S4.E6.m1.1.1.1.1.1.2.cmml">​</mo><msup id="S4.E6.m1.1.1.1.1.1.1" xref="S4.E6.m1.1.1.1.1.1.1.cmml"><mrow id="S4.E6.m1.1.1.1.1.1.1.1.1" xref="S4.E6.m1.1.1.1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S4.E6.m1.1.1.1.1.1.1.1.1.2" xref="S4.E6.m1.1.1.1.1.1.1.1.1.1.cmml">(</mo><msubsup id="S4.E6.m1.1.1.1.1.1.1.1.1.1" xref="S4.E6.m1.1.1.1.1.1.1.1.1.1.cmml"><mi id="S4.E6.m1.1.1.1.1.1.1.1.1.1.2.2" xref="S4.E6.m1.1.1.1.1.1.1.1.1.1.2.2.cmml">𝑯</mi><mi id="S4.E6.m1.1.1.1.1.1.1.1.1.1.2.3" xref="S4.E6.m1.1.1.1.1.1.1.1.1.1.2.3.cmml">i</mi><mi id="S4.E6.m1.1.1.1.1.1.1.1.1.1.3" xref="S4.E6.m1.1.1.1.1.1.1.1.1.1.3.cmml">k</mi></msubsup><mo stretchy="false" id="S4.E6.m1.1.1.1.1.1.1.1.1.3" xref="S4.E6.m1.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow><mrow id="S4.E6.m1.1.1.1.1.1.1.3" xref="S4.E6.m1.1.1.1.1.1.1.3.cmml"><mo id="S4.E6.m1.1.1.1.1.1.1.3a" xref="S4.E6.m1.1.1.1.1.1.1.3.cmml">−</mo><mn id="S4.E6.m1.1.1.1.1.1.1.3.2" xref="S4.E6.m1.1.1.1.1.1.1.3.2.cmml">1</mn></mrow></msup><mo lspace="0em" rspace="0em" id="S4.E6.m1.1.1.1.1.1.2a" xref="S4.E6.m1.1.1.1.1.1.2.cmml">​</mo><msubsup id="S4.E6.m1.1.1.1.1.1.4" xref="S4.E6.m1.1.1.1.1.1.4.cmml"><mi id="S4.E6.m1.1.1.1.1.1.4.2.2" xref="S4.E6.m1.1.1.1.1.1.4.2.2.cmml">𝒈</mi><mi id="S4.E6.m1.1.1.1.1.1.4.2.3" xref="S4.E6.m1.1.1.1.1.1.4.2.3.cmml">i</mi><mi id="S4.E6.m1.1.1.1.1.1.4.3" xref="S4.E6.m1.1.1.1.1.1.4.3.cmml">k</mi></msubsup></mrow></mrow><mo lspace="0em" id="S4.E6.m1.1.1.1.2" xref="S4.E6.m1.1.1.1.1.cmml">.</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.E6.m1.1b"><apply id="S4.E6.m1.1.1.1.1.cmml" xref="S4.E6.m1.1.1.1"><approx id="S4.E6.m1.1.1.1.1.2.cmml" xref="S4.E6.m1.1.1.1.1.2"></approx><apply id="S4.E6.m1.1.1.1.1.3.cmml" xref="S4.E6.m1.1.1.1.1.3"><times id="S4.E6.m1.1.1.1.1.3.1.cmml" xref="S4.E6.m1.1.1.1.1.3.1"></times><ci id="S4.E6.m1.1.1.1.1.3.2.cmml" xref="S4.E6.m1.1.1.1.1.3.2">Δ</ci><apply id="S4.E6.m1.1.1.1.1.3.3.cmml" xref="S4.E6.m1.1.1.1.1.3.3"><csymbol cd="ambiguous" id="S4.E6.m1.1.1.1.1.3.3.1.cmml" xref="S4.E6.m1.1.1.1.1.3.3">superscript</csymbol><apply id="S4.E6.m1.1.1.1.1.3.3.2.cmml" xref="S4.E6.m1.1.1.1.1.3.3"><csymbol cd="ambiguous" id="S4.E6.m1.1.1.1.1.3.3.2.1.cmml" xref="S4.E6.m1.1.1.1.1.3.3">subscript</csymbol><ci id="S4.E6.m1.1.1.1.1.3.3.2.2.cmml" xref="S4.E6.m1.1.1.1.1.3.3.2.2">𝜽</ci><ci id="S4.E6.m1.1.1.1.1.3.3.2.3.cmml" xref="S4.E6.m1.1.1.1.1.3.3.2.3">𝑖</ci></apply><ci id="S4.E6.m1.1.1.1.1.3.3.3.cmml" xref="S4.E6.m1.1.1.1.1.3.3.3">𝑘</ci></apply></apply><apply id="S4.E6.m1.1.1.1.1.1.cmml" xref="S4.E6.m1.1.1.1.1.1"><times id="S4.E6.m1.1.1.1.1.1.2.cmml" xref="S4.E6.m1.1.1.1.1.1.2"></times><ci id="S4.E6.m1.1.1.1.1.1.3a.cmml" xref="S4.E6.m1.1.1.1.1.1.3"><mtext class="ltx_mathvariant_italic" id="S4.E6.m1.1.1.1.1.1.3.cmml" xref="S4.E6.m1.1.1.1.1.1.3">diag</mtext></ci><apply id="S4.E6.m1.1.1.1.1.1.1.cmml" xref="S4.E6.m1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.E6.m1.1.1.1.1.1.1.2.cmml" xref="S4.E6.m1.1.1.1.1.1.1">superscript</csymbol><apply id="S4.E6.m1.1.1.1.1.1.1.1.1.1.cmml" xref="S4.E6.m1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.E6.m1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S4.E6.m1.1.1.1.1.1.1.1.1">superscript</csymbol><apply id="S4.E6.m1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S4.E6.m1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.E6.m1.1.1.1.1.1.1.1.1.1.2.1.cmml" xref="S4.E6.m1.1.1.1.1.1.1.1.1">subscript</csymbol><ci id="S4.E6.m1.1.1.1.1.1.1.1.1.1.2.2.cmml" xref="S4.E6.m1.1.1.1.1.1.1.1.1.1.2.2">𝑯</ci><ci id="S4.E6.m1.1.1.1.1.1.1.1.1.1.2.3.cmml" xref="S4.E6.m1.1.1.1.1.1.1.1.1.1.2.3">𝑖</ci></apply><ci id="S4.E6.m1.1.1.1.1.1.1.1.1.1.3.cmml" xref="S4.E6.m1.1.1.1.1.1.1.1.1.1.3">𝑘</ci></apply><apply id="S4.E6.m1.1.1.1.1.1.1.3.cmml" xref="S4.E6.m1.1.1.1.1.1.1.3"><minus id="S4.E6.m1.1.1.1.1.1.1.3.1.cmml" xref="S4.E6.m1.1.1.1.1.1.1.3"></minus><cn type="integer" id="S4.E6.m1.1.1.1.1.1.1.3.2.cmml" xref="S4.E6.m1.1.1.1.1.1.1.3.2">1</cn></apply></apply><apply id="S4.E6.m1.1.1.1.1.1.4.cmml" xref="S4.E6.m1.1.1.1.1.1.4"><csymbol cd="ambiguous" id="S4.E6.m1.1.1.1.1.1.4.1.cmml" xref="S4.E6.m1.1.1.1.1.1.4">superscript</csymbol><apply id="S4.E6.m1.1.1.1.1.1.4.2.cmml" xref="S4.E6.m1.1.1.1.1.1.4"><csymbol cd="ambiguous" id="S4.E6.m1.1.1.1.1.1.4.2.1.cmml" xref="S4.E6.m1.1.1.1.1.1.4">subscript</csymbol><ci id="S4.E6.m1.1.1.1.1.1.4.2.2.cmml" xref="S4.E6.m1.1.1.1.1.1.4.2.2">𝒈</ci><ci id="S4.E6.m1.1.1.1.1.1.4.2.3.cmml" xref="S4.E6.m1.1.1.1.1.1.4.2.3">𝑖</ci></apply><ci id="S4.E6.m1.1.1.1.1.1.4.3.cmml" xref="S4.E6.m1.1.1.1.1.1.4.3">𝑘</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.E6.m1.1c">\displaystyle\Delta\bm{\theta}_{i}^{k}\approx\textit{diag}(\bm{H}_{i}^{k})^{-1}\bm{g}_{i}^{k}.</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(6)</span></td>
</tr></tbody>
</table>
<p id="S4.SS1.p2.1" class="ltx_p">Several techniques for such diagonal estimation have been proposed, e.g., Hutchinson’s and Gauss-Newon-Bartlett (GNB) methods <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib16" title="" class="ltx_ref">16</a>]</cite>. Fed-Sophia uses the GNB estimator to estimate the Hessian as it has been shown to exhibit a better generalization performance <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib16" title="" class="ltx_ref">16</a>]</cite>. Given a loss function <math id="S4.SS1.p2.1.m1.1" class="ltx_Math" alttext="f(\bm{\theta})" display="inline"><semantics id="S4.SS1.p2.1.m1.1a"><mrow id="S4.SS1.p2.1.m1.1.2" xref="S4.SS1.p2.1.m1.1.2.cmml"><mi id="S4.SS1.p2.1.m1.1.2.2" xref="S4.SS1.p2.1.m1.1.2.2.cmml">f</mi><mo lspace="0em" rspace="0em" id="S4.SS1.p2.1.m1.1.2.1" xref="S4.SS1.p2.1.m1.1.2.1.cmml">​</mo><mrow id="S4.SS1.p2.1.m1.1.2.3.2" xref="S4.SS1.p2.1.m1.1.2.cmml"><mo stretchy="false" id="S4.SS1.p2.1.m1.1.2.3.2.1" xref="S4.SS1.p2.1.m1.1.2.cmml">(</mo><mi id="S4.SS1.p2.1.m1.1.1" xref="S4.SS1.p2.1.m1.1.1.cmml">𝜽</mi><mo stretchy="false" id="S4.SS1.p2.1.m1.1.2.3.2.2" xref="S4.SS1.p2.1.m1.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.p2.1.m1.1b"><apply id="S4.SS1.p2.1.m1.1.2.cmml" xref="S4.SS1.p2.1.m1.1.2"><times id="S4.SS1.p2.1.m1.1.2.1.cmml" xref="S4.SS1.p2.1.m1.1.2.1"></times><ci id="S4.SS1.p2.1.m1.1.2.2.cmml" xref="S4.SS1.p2.1.m1.1.2.2">𝑓</ci><ci id="S4.SS1.p2.1.m1.1.1.cmml" xref="S4.SS1.p2.1.m1.1.1">𝜽</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p2.1.m1.1c">f(\bm{\theta})</annotation></semantics></math>, the Hessian matrix can be computed using the following Gauss-Newton decomposition</p>
<table id="Sx1.EGx7" class="ltx_equationgroup ltx_eqn_align ltx_eqn_table">

<tbody id="S4.E7"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math id="S4.E7.m1.7" class="ltx_Math" alttext="\displaystyle\bm{H}=\bm{J}_{\bm{\theta}}\phi(\bm{\theta},\bm{x})\cdot\bm{S}\cdot\bm{J}_{\bm{\theta}}\phi(\bm{\theta},\bm{x})^{T}+\bm{J}_{\bm{\theta}\bm{\theta}}\phi(\bm{\theta},\bm{x})\cdot\bm{q}," display="inline"><semantics id="S4.E7.m1.7a"><mrow id="S4.E7.m1.7.7.1" xref="S4.E7.m1.7.7.1.1.cmml"><mrow id="S4.E7.m1.7.7.1.1" xref="S4.E7.m1.7.7.1.1.cmml"><mi id="S4.E7.m1.7.7.1.1.2" xref="S4.E7.m1.7.7.1.1.2.cmml">𝑯</mi><mo id="S4.E7.m1.7.7.1.1.1" xref="S4.E7.m1.7.7.1.1.1.cmml">=</mo><mrow id="S4.E7.m1.7.7.1.1.3" xref="S4.E7.m1.7.7.1.1.3.cmml"><mrow id="S4.E7.m1.7.7.1.1.3.2" xref="S4.E7.m1.7.7.1.1.3.2.cmml"><mrow id="S4.E7.m1.7.7.1.1.3.2.2" xref="S4.E7.m1.7.7.1.1.3.2.2.cmml"><mrow id="S4.E7.m1.7.7.1.1.3.2.2.2" xref="S4.E7.m1.7.7.1.1.3.2.2.2.cmml"><msub id="S4.E7.m1.7.7.1.1.3.2.2.2.2" xref="S4.E7.m1.7.7.1.1.3.2.2.2.2.cmml"><mi id="S4.E7.m1.7.7.1.1.3.2.2.2.2.2" xref="S4.E7.m1.7.7.1.1.3.2.2.2.2.2.cmml">𝑱</mi><mi id="S4.E7.m1.7.7.1.1.3.2.2.2.2.3" xref="S4.E7.m1.7.7.1.1.3.2.2.2.2.3.cmml">𝜽</mi></msub><mo lspace="0em" rspace="0em" id="S4.E7.m1.7.7.1.1.3.2.2.2.1" xref="S4.E7.m1.7.7.1.1.3.2.2.2.1.cmml">​</mo><mi id="S4.E7.m1.7.7.1.1.3.2.2.2.3" xref="S4.E7.m1.7.7.1.1.3.2.2.2.3.cmml">ϕ</mi><mo lspace="0em" rspace="0em" id="S4.E7.m1.7.7.1.1.3.2.2.2.1a" xref="S4.E7.m1.7.7.1.1.3.2.2.2.1.cmml">​</mo><mrow id="S4.E7.m1.7.7.1.1.3.2.2.2.4.2" xref="S4.E7.m1.7.7.1.1.3.2.2.2.4.1.cmml"><mo stretchy="false" id="S4.E7.m1.7.7.1.1.3.2.2.2.4.2.1" xref="S4.E7.m1.7.7.1.1.3.2.2.2.4.1.cmml">(</mo><mi id="S4.E7.m1.1.1" xref="S4.E7.m1.1.1.cmml">𝜽</mi><mo id="S4.E7.m1.7.7.1.1.3.2.2.2.4.2.2" xref="S4.E7.m1.7.7.1.1.3.2.2.2.4.1.cmml">,</mo><mi id="S4.E7.m1.2.2" xref="S4.E7.m1.2.2.cmml">𝒙</mi><mo rspace="0.055em" stretchy="false" id="S4.E7.m1.7.7.1.1.3.2.2.2.4.2.3" xref="S4.E7.m1.7.7.1.1.3.2.2.2.4.1.cmml">)</mo></mrow></mrow><mo rspace="0.222em" id="S4.E7.m1.7.7.1.1.3.2.2.1" xref="S4.E7.m1.7.7.1.1.3.2.2.1.cmml">⋅</mo><mi id="S4.E7.m1.7.7.1.1.3.2.2.3" xref="S4.E7.m1.7.7.1.1.3.2.2.3.cmml">𝑺</mi><mo lspace="0.222em" rspace="0.222em" id="S4.E7.m1.7.7.1.1.3.2.2.1a" xref="S4.E7.m1.7.7.1.1.3.2.2.1.cmml">⋅</mo><msub id="S4.E7.m1.7.7.1.1.3.2.2.4" xref="S4.E7.m1.7.7.1.1.3.2.2.4.cmml"><mi id="S4.E7.m1.7.7.1.1.3.2.2.4.2" xref="S4.E7.m1.7.7.1.1.3.2.2.4.2.cmml">𝑱</mi><mi id="S4.E7.m1.7.7.1.1.3.2.2.4.3" xref="S4.E7.m1.7.7.1.1.3.2.2.4.3.cmml">𝜽</mi></msub></mrow><mo lspace="0em" rspace="0em" id="S4.E7.m1.7.7.1.1.3.2.1" xref="S4.E7.m1.7.7.1.1.3.2.1.cmml">​</mo><mi id="S4.E7.m1.7.7.1.1.3.2.3" xref="S4.E7.m1.7.7.1.1.3.2.3.cmml">ϕ</mi><mo lspace="0em" rspace="0em" id="S4.E7.m1.7.7.1.1.3.2.1a" xref="S4.E7.m1.7.7.1.1.3.2.1.cmml">​</mo><msup id="S4.E7.m1.7.7.1.1.3.2.4" xref="S4.E7.m1.7.7.1.1.3.2.4.cmml"><mrow id="S4.E7.m1.7.7.1.1.3.2.4.2.2" xref="S4.E7.m1.7.7.1.1.3.2.4.2.1.cmml"><mo stretchy="false" id="S4.E7.m1.7.7.1.1.3.2.4.2.2.1" xref="S4.E7.m1.7.7.1.1.3.2.4.2.1.cmml">(</mo><mi id="S4.E7.m1.3.3" xref="S4.E7.m1.3.3.cmml">𝜽</mi><mo id="S4.E7.m1.7.7.1.1.3.2.4.2.2.2" xref="S4.E7.m1.7.7.1.1.3.2.4.2.1.cmml">,</mo><mi id="S4.E7.m1.4.4" xref="S4.E7.m1.4.4.cmml">𝒙</mi><mo stretchy="false" id="S4.E7.m1.7.7.1.1.3.2.4.2.2.3" xref="S4.E7.m1.7.7.1.1.3.2.4.2.1.cmml">)</mo></mrow><mi id="S4.E7.m1.7.7.1.1.3.2.4.3" xref="S4.E7.m1.7.7.1.1.3.2.4.3.cmml">T</mi></msup></mrow><mo id="S4.E7.m1.7.7.1.1.3.1" xref="S4.E7.m1.7.7.1.1.3.1.cmml">+</mo><mrow id="S4.E7.m1.7.7.1.1.3.3" xref="S4.E7.m1.7.7.1.1.3.3.cmml"><mrow id="S4.E7.m1.7.7.1.1.3.3.2" xref="S4.E7.m1.7.7.1.1.3.3.2.cmml"><msub id="S4.E7.m1.7.7.1.1.3.3.2.2" xref="S4.E7.m1.7.7.1.1.3.3.2.2.cmml"><mi id="S4.E7.m1.7.7.1.1.3.3.2.2.2" xref="S4.E7.m1.7.7.1.1.3.3.2.2.2.cmml">𝑱</mi><mrow id="S4.E7.m1.7.7.1.1.3.3.2.2.3" xref="S4.E7.m1.7.7.1.1.3.3.2.2.3.cmml"><mi id="S4.E7.m1.7.7.1.1.3.3.2.2.3.2" xref="S4.E7.m1.7.7.1.1.3.3.2.2.3.2.cmml">𝜽</mi><mo lspace="0em" rspace="0em" id="S4.E7.m1.7.7.1.1.3.3.2.2.3.1" xref="S4.E7.m1.7.7.1.1.3.3.2.2.3.1.cmml">​</mo><mi id="S4.E7.m1.7.7.1.1.3.3.2.2.3.3" xref="S4.E7.m1.7.7.1.1.3.3.2.2.3.3.cmml">𝜽</mi></mrow></msub><mo lspace="0em" rspace="0em" id="S4.E7.m1.7.7.1.1.3.3.2.1" xref="S4.E7.m1.7.7.1.1.3.3.2.1.cmml">​</mo><mi id="S4.E7.m1.7.7.1.1.3.3.2.3" xref="S4.E7.m1.7.7.1.1.3.3.2.3.cmml">ϕ</mi><mo lspace="0em" rspace="0em" id="S4.E7.m1.7.7.1.1.3.3.2.1a" xref="S4.E7.m1.7.7.1.1.3.3.2.1.cmml">​</mo><mrow id="S4.E7.m1.7.7.1.1.3.3.2.4.2" xref="S4.E7.m1.7.7.1.1.3.3.2.4.1.cmml"><mo stretchy="false" id="S4.E7.m1.7.7.1.1.3.3.2.4.2.1" xref="S4.E7.m1.7.7.1.1.3.3.2.4.1.cmml">(</mo><mi id="S4.E7.m1.5.5" xref="S4.E7.m1.5.5.cmml">𝜽</mi><mo id="S4.E7.m1.7.7.1.1.3.3.2.4.2.2" xref="S4.E7.m1.7.7.1.1.3.3.2.4.1.cmml">,</mo><mi id="S4.E7.m1.6.6" xref="S4.E7.m1.6.6.cmml">𝒙</mi><mo rspace="0.055em" stretchy="false" id="S4.E7.m1.7.7.1.1.3.3.2.4.2.3" xref="S4.E7.m1.7.7.1.1.3.3.2.4.1.cmml">)</mo></mrow></mrow><mo rspace="0.222em" id="S4.E7.m1.7.7.1.1.3.3.1" xref="S4.E7.m1.7.7.1.1.3.3.1.cmml">⋅</mo><mi id="S4.E7.m1.7.7.1.1.3.3.3" xref="S4.E7.m1.7.7.1.1.3.3.3.cmml">𝒒</mi></mrow></mrow></mrow><mo id="S4.E7.m1.7.7.1.2" xref="S4.E7.m1.7.7.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.E7.m1.7b"><apply id="S4.E7.m1.7.7.1.1.cmml" xref="S4.E7.m1.7.7.1"><eq id="S4.E7.m1.7.7.1.1.1.cmml" xref="S4.E7.m1.7.7.1.1.1"></eq><ci id="S4.E7.m1.7.7.1.1.2.cmml" xref="S4.E7.m1.7.7.1.1.2">𝑯</ci><apply id="S4.E7.m1.7.7.1.1.3.cmml" xref="S4.E7.m1.7.7.1.1.3"><plus id="S4.E7.m1.7.7.1.1.3.1.cmml" xref="S4.E7.m1.7.7.1.1.3.1"></plus><apply id="S4.E7.m1.7.7.1.1.3.2.cmml" xref="S4.E7.m1.7.7.1.1.3.2"><times id="S4.E7.m1.7.7.1.1.3.2.1.cmml" xref="S4.E7.m1.7.7.1.1.3.2.1"></times><apply id="S4.E7.m1.7.7.1.1.3.2.2.cmml" xref="S4.E7.m1.7.7.1.1.3.2.2"><ci id="S4.E7.m1.7.7.1.1.3.2.2.1.cmml" xref="S4.E7.m1.7.7.1.1.3.2.2.1">⋅</ci><apply id="S4.E7.m1.7.7.1.1.3.2.2.2.cmml" xref="S4.E7.m1.7.7.1.1.3.2.2.2"><times id="S4.E7.m1.7.7.1.1.3.2.2.2.1.cmml" xref="S4.E7.m1.7.7.1.1.3.2.2.2.1"></times><apply id="S4.E7.m1.7.7.1.1.3.2.2.2.2.cmml" xref="S4.E7.m1.7.7.1.1.3.2.2.2.2"><csymbol cd="ambiguous" id="S4.E7.m1.7.7.1.1.3.2.2.2.2.1.cmml" xref="S4.E7.m1.7.7.1.1.3.2.2.2.2">subscript</csymbol><ci id="S4.E7.m1.7.7.1.1.3.2.2.2.2.2.cmml" xref="S4.E7.m1.7.7.1.1.3.2.2.2.2.2">𝑱</ci><ci id="S4.E7.m1.7.7.1.1.3.2.2.2.2.3.cmml" xref="S4.E7.m1.7.7.1.1.3.2.2.2.2.3">𝜽</ci></apply><ci id="S4.E7.m1.7.7.1.1.3.2.2.2.3.cmml" xref="S4.E7.m1.7.7.1.1.3.2.2.2.3">italic-ϕ</ci><interval closure="open" id="S4.E7.m1.7.7.1.1.3.2.2.2.4.1.cmml" xref="S4.E7.m1.7.7.1.1.3.2.2.2.4.2"><ci id="S4.E7.m1.1.1.cmml" xref="S4.E7.m1.1.1">𝜽</ci><ci id="S4.E7.m1.2.2.cmml" xref="S4.E7.m1.2.2">𝒙</ci></interval></apply><ci id="S4.E7.m1.7.7.1.1.3.2.2.3.cmml" xref="S4.E7.m1.7.7.1.1.3.2.2.3">𝑺</ci><apply id="S4.E7.m1.7.7.1.1.3.2.2.4.cmml" xref="S4.E7.m1.7.7.1.1.3.2.2.4"><csymbol cd="ambiguous" id="S4.E7.m1.7.7.1.1.3.2.2.4.1.cmml" xref="S4.E7.m1.7.7.1.1.3.2.2.4">subscript</csymbol><ci id="S4.E7.m1.7.7.1.1.3.2.2.4.2.cmml" xref="S4.E7.m1.7.7.1.1.3.2.2.4.2">𝑱</ci><ci id="S4.E7.m1.7.7.1.1.3.2.2.4.3.cmml" xref="S4.E7.m1.7.7.1.1.3.2.2.4.3">𝜽</ci></apply></apply><ci id="S4.E7.m1.7.7.1.1.3.2.3.cmml" xref="S4.E7.m1.7.7.1.1.3.2.3">italic-ϕ</ci><apply id="S4.E7.m1.7.7.1.1.3.2.4.cmml" xref="S4.E7.m1.7.7.1.1.3.2.4"><csymbol cd="ambiguous" id="S4.E7.m1.7.7.1.1.3.2.4.1.cmml" xref="S4.E7.m1.7.7.1.1.3.2.4">superscript</csymbol><interval closure="open" id="S4.E7.m1.7.7.1.1.3.2.4.2.1.cmml" xref="S4.E7.m1.7.7.1.1.3.2.4.2.2"><ci id="S4.E7.m1.3.3.cmml" xref="S4.E7.m1.3.3">𝜽</ci><ci id="S4.E7.m1.4.4.cmml" xref="S4.E7.m1.4.4">𝒙</ci></interval><ci id="S4.E7.m1.7.7.1.1.3.2.4.3.cmml" xref="S4.E7.m1.7.7.1.1.3.2.4.3">𝑇</ci></apply></apply><apply id="S4.E7.m1.7.7.1.1.3.3.cmml" xref="S4.E7.m1.7.7.1.1.3.3"><ci id="S4.E7.m1.7.7.1.1.3.3.1.cmml" xref="S4.E7.m1.7.7.1.1.3.3.1">⋅</ci><apply id="S4.E7.m1.7.7.1.1.3.3.2.cmml" xref="S4.E7.m1.7.7.1.1.3.3.2"><times id="S4.E7.m1.7.7.1.1.3.3.2.1.cmml" xref="S4.E7.m1.7.7.1.1.3.3.2.1"></times><apply id="S4.E7.m1.7.7.1.1.3.3.2.2.cmml" xref="S4.E7.m1.7.7.1.1.3.3.2.2"><csymbol cd="ambiguous" id="S4.E7.m1.7.7.1.1.3.3.2.2.1.cmml" xref="S4.E7.m1.7.7.1.1.3.3.2.2">subscript</csymbol><ci id="S4.E7.m1.7.7.1.1.3.3.2.2.2.cmml" xref="S4.E7.m1.7.7.1.1.3.3.2.2.2">𝑱</ci><apply id="S4.E7.m1.7.7.1.1.3.3.2.2.3.cmml" xref="S4.E7.m1.7.7.1.1.3.3.2.2.3"><times id="S4.E7.m1.7.7.1.1.3.3.2.2.3.1.cmml" xref="S4.E7.m1.7.7.1.1.3.3.2.2.3.1"></times><ci id="S4.E7.m1.7.7.1.1.3.3.2.2.3.2.cmml" xref="S4.E7.m1.7.7.1.1.3.3.2.2.3.2">𝜽</ci><ci id="S4.E7.m1.7.7.1.1.3.3.2.2.3.3.cmml" xref="S4.E7.m1.7.7.1.1.3.3.2.2.3.3">𝜽</ci></apply></apply><ci id="S4.E7.m1.7.7.1.1.3.3.2.3.cmml" xref="S4.E7.m1.7.7.1.1.3.3.2.3">italic-ϕ</ci><interval closure="open" id="S4.E7.m1.7.7.1.1.3.3.2.4.1.cmml" xref="S4.E7.m1.7.7.1.1.3.3.2.4.2"><ci id="S4.E7.m1.5.5.cmml" xref="S4.E7.m1.5.5">𝜽</ci><ci id="S4.E7.m1.6.6.cmml" xref="S4.E7.m1.6.6">𝒙</ci></interval></apply><ci id="S4.E7.m1.7.7.1.1.3.3.3.cmml" xref="S4.E7.m1.7.7.1.1.3.3.3">𝒒</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.E7.m1.7c">\displaystyle\bm{H}=\bm{J}_{\bm{\theta}}\phi(\bm{\theta},\bm{x})\cdot\bm{S}\cdot\bm{J}_{\bm{\theta}}\phi(\bm{\theta},\bm{x})^{T}+\bm{J}_{\bm{\theta}\bm{\theta}}\phi(\bm{\theta},\bm{x})\cdot\bm{q},</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(7)</span></td>
</tr></tbody>
</table>
<p id="S4.SS1.p2.11" class="ltx_p">where <math id="S4.SS1.p2.2.m1.1" class="ltx_Math" alttext="\bm{J}" display="inline"><semantics id="S4.SS1.p2.2.m1.1a"><mi id="S4.SS1.p2.2.m1.1.1" xref="S4.SS1.p2.2.m1.1.1.cmml">𝑱</mi><annotation-xml encoding="MathML-Content" id="S4.SS1.p2.2.m1.1b"><ci id="S4.SS1.p2.2.m1.1.1.cmml" xref="S4.SS1.p2.2.m1.1.1">𝑱</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p2.2.m1.1c">\bm{J}</annotation></semantics></math> is the Jacobian of <math id="S4.SS1.p2.3.m2.1" class="ltx_Math" alttext="\phi" display="inline"><semantics id="S4.SS1.p2.3.m2.1a"><mi id="S4.SS1.p2.3.m2.1.1" xref="S4.SS1.p2.3.m2.1.1.cmml">ϕ</mi><annotation-xml encoding="MathML-Content" id="S4.SS1.p2.3.m2.1b"><ci id="S4.SS1.p2.3.m2.1.1.cmml" xref="S4.SS1.p2.3.m2.1.1">italic-ϕ</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p2.3.m2.1c">\phi</annotation></semantics></math> with respect to <math id="S4.SS1.p2.4.m3.1" class="ltx_Math" alttext="\bm{\theta}" display="inline"><semantics id="S4.SS1.p2.4.m3.1a"><mi id="S4.SS1.p2.4.m3.1.1" xref="S4.SS1.p2.4.m3.1.1.cmml">𝜽</mi><annotation-xml encoding="MathML-Content" id="S4.SS1.p2.4.m3.1b"><ci id="S4.SS1.p2.4.m3.1.1.cmml" xref="S4.SS1.p2.4.m3.1.1">𝜽</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p2.4.m3.1c">\bm{\theta}</annotation></semantics></math>, <math id="S4.SS1.p2.5.m4.1" class="ltx_Math" alttext="\phi" display="inline"><semantics id="S4.SS1.p2.5.m4.1a"><mi id="S4.SS1.p2.5.m4.1.1" xref="S4.SS1.p2.5.m4.1.1.cmml">ϕ</mi><annotation-xml encoding="MathML-Content" id="S4.SS1.p2.5.m4.1b"><ci id="S4.SS1.p2.5.m4.1.1.cmml" xref="S4.SS1.p2.5.m4.1.1">italic-ϕ</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p2.5.m4.1c">\phi</annotation></semantics></math> is the logits function or the mapping from input to raw output values, <math id="S4.SS1.p2.6.m5.1" class="ltx_Math" alttext="\bm{S}" display="inline"><semantics id="S4.SS1.p2.6.m5.1a"><mi id="S4.SS1.p2.6.m5.1.1" xref="S4.SS1.p2.6.m5.1.1.cmml">𝑺</mi><annotation-xml encoding="MathML-Content" id="S4.SS1.p2.6.m5.1b"><ci id="S4.SS1.p2.6.m5.1.1.cmml" xref="S4.SS1.p2.6.m5.1.1">𝑺</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p2.6.m5.1c">\bm{S}</annotation></semantics></math> is the second-order derivative of the loss with respect to the logits, <math id="S4.SS1.p2.7.m6.2" class="ltx_Math" alttext="\bm{J}_{\bm{\theta}\bm{\theta}}\phi(\bm{\theta},\bm{x})" display="inline"><semantics id="S4.SS1.p2.7.m6.2a"><mrow id="S4.SS1.p2.7.m6.2.3" xref="S4.SS1.p2.7.m6.2.3.cmml"><msub id="S4.SS1.p2.7.m6.2.3.2" xref="S4.SS1.p2.7.m6.2.3.2.cmml"><mi id="S4.SS1.p2.7.m6.2.3.2.2" xref="S4.SS1.p2.7.m6.2.3.2.2.cmml">𝑱</mi><mrow id="S4.SS1.p2.7.m6.2.3.2.3" xref="S4.SS1.p2.7.m6.2.3.2.3.cmml"><mi id="S4.SS1.p2.7.m6.2.3.2.3.2" xref="S4.SS1.p2.7.m6.2.3.2.3.2.cmml">𝜽</mi><mo lspace="0em" rspace="0em" id="S4.SS1.p2.7.m6.2.3.2.3.1" xref="S4.SS1.p2.7.m6.2.3.2.3.1.cmml">​</mo><mi id="S4.SS1.p2.7.m6.2.3.2.3.3" xref="S4.SS1.p2.7.m6.2.3.2.3.3.cmml">𝜽</mi></mrow></msub><mo lspace="0em" rspace="0em" id="S4.SS1.p2.7.m6.2.3.1" xref="S4.SS1.p2.7.m6.2.3.1.cmml">​</mo><mi id="S4.SS1.p2.7.m6.2.3.3" xref="S4.SS1.p2.7.m6.2.3.3.cmml">ϕ</mi><mo lspace="0em" rspace="0em" id="S4.SS1.p2.7.m6.2.3.1a" xref="S4.SS1.p2.7.m6.2.3.1.cmml">​</mo><mrow id="S4.SS1.p2.7.m6.2.3.4.2" xref="S4.SS1.p2.7.m6.2.3.4.1.cmml"><mo stretchy="false" id="S4.SS1.p2.7.m6.2.3.4.2.1" xref="S4.SS1.p2.7.m6.2.3.4.1.cmml">(</mo><mi id="S4.SS1.p2.7.m6.1.1" xref="S4.SS1.p2.7.m6.1.1.cmml">𝜽</mi><mo id="S4.SS1.p2.7.m6.2.3.4.2.2" xref="S4.SS1.p2.7.m6.2.3.4.1.cmml">,</mo><mi id="S4.SS1.p2.7.m6.2.2" xref="S4.SS1.p2.7.m6.2.2.cmml">𝒙</mi><mo stretchy="false" id="S4.SS1.p2.7.m6.2.3.4.2.3" xref="S4.SS1.p2.7.m6.2.3.4.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS1.p2.7.m6.2b"><apply id="S4.SS1.p2.7.m6.2.3.cmml" xref="S4.SS1.p2.7.m6.2.3"><times id="S4.SS1.p2.7.m6.2.3.1.cmml" xref="S4.SS1.p2.7.m6.2.3.1"></times><apply id="S4.SS1.p2.7.m6.2.3.2.cmml" xref="S4.SS1.p2.7.m6.2.3.2"><csymbol cd="ambiguous" id="S4.SS1.p2.7.m6.2.3.2.1.cmml" xref="S4.SS1.p2.7.m6.2.3.2">subscript</csymbol><ci id="S4.SS1.p2.7.m6.2.3.2.2.cmml" xref="S4.SS1.p2.7.m6.2.3.2.2">𝑱</ci><apply id="S4.SS1.p2.7.m6.2.3.2.3.cmml" xref="S4.SS1.p2.7.m6.2.3.2.3"><times id="S4.SS1.p2.7.m6.2.3.2.3.1.cmml" xref="S4.SS1.p2.7.m6.2.3.2.3.1"></times><ci id="S4.SS1.p2.7.m6.2.3.2.3.2.cmml" xref="S4.SS1.p2.7.m6.2.3.2.3.2">𝜽</ci><ci id="S4.SS1.p2.7.m6.2.3.2.3.3.cmml" xref="S4.SS1.p2.7.m6.2.3.2.3.3">𝜽</ci></apply></apply><ci id="S4.SS1.p2.7.m6.2.3.3.cmml" xref="S4.SS1.p2.7.m6.2.3.3">italic-ϕ</ci><interval closure="open" id="S4.SS1.p2.7.m6.2.3.4.1.cmml" xref="S4.SS1.p2.7.m6.2.3.4.2"><ci id="S4.SS1.p2.7.m6.1.1.cmml" xref="S4.SS1.p2.7.m6.1.1">𝜽</ci><ci id="S4.SS1.p2.7.m6.2.2.cmml" xref="S4.SS1.p2.7.m6.2.2">𝒙</ci></interval></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p2.7.m6.2c">\bm{J}_{\bm{\theta}\bm{\theta}}\phi(\bm{\theta},\bm{x})</annotation></semantics></math> is the second-order derivatives of the logits function with respect to <math id="S4.SS1.p2.8.m7.1" class="ltx_Math" alttext="\bm{\theta}" display="inline"><semantics id="S4.SS1.p2.8.m7.1a"><mi id="S4.SS1.p2.8.m7.1.1" xref="S4.SS1.p2.8.m7.1.1.cmml">𝜽</mi><annotation-xml encoding="MathML-Content" id="S4.SS1.p2.8.m7.1b"><ci id="S4.SS1.p2.8.m7.1.1.cmml" xref="S4.SS1.p2.8.m7.1.1">𝜽</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p2.8.m7.1c">\bm{\theta}</annotation></semantics></math>, and <math id="S4.SS1.p2.9.m8.1" class="ltx_Math" alttext="\bm{q}" display="inline"><semantics id="S4.SS1.p2.9.m8.1a"><mi id="S4.SS1.p2.9.m8.1.1" xref="S4.SS1.p2.9.m8.1.1.cmml">𝒒</mi><annotation-xml encoding="MathML-Content" id="S4.SS1.p2.9.m8.1b"><ci id="S4.SS1.p2.9.m8.1.1.cmml" xref="S4.SS1.p2.9.m8.1.1">𝒒</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p2.9.m8.1c">\bm{q}</annotation></semantics></math> is the first-order derivative of the loss with respect to the logits. The first term is often called the Gauss-Newton matrix, while the second is usually very small and could be negligible. The idea is to estimate the diagonal of the Gauss-Newton matrix and use this as the Hessian’s diagonal. The procedure to estimate the diagonal of the Hessian is depicted in Algorithm <a href="#alg2" title="In IV-A Hessian as a Pre-conditioner ‣ IV Proposed Algorithm ‣ Fed-Sophia: A Communication-Efficient Second-Order Federated Learning Algorithm Identify applicable funding agency here. If none, delete this." class="ltx_ref"><span class="ltx_text ltx_ref_tag">2</span></a>, where <math id="S4.SS1.p2.10.m9.1" class="ltx_Math" alttext="\odot" display="inline"><semantics id="S4.SS1.p2.10.m9.1a"><mo id="S4.SS1.p2.10.m9.1.1" xref="S4.SS1.p2.10.m9.1.1.cmml">⊙</mo><annotation-xml encoding="MathML-Content" id="S4.SS1.p2.10.m9.1b"><csymbol cd="latexml" id="S4.SS1.p2.10.m9.1.1.cmml" xref="S4.SS1.p2.10.m9.1.1">direct-product</csymbol></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p2.10.m9.1c">\odot</annotation></semantics></math> denotes the element-wise product. Hence, the estimated Hessian for the <math id="S4.SS1.p2.11.m10.1" class="ltx_Math" alttext="k" display="inline"><semantics id="S4.SS1.p2.11.m10.1a"><mi id="S4.SS1.p2.11.m10.1.1" xref="S4.SS1.p2.11.m10.1.1.cmml">k</mi><annotation-xml encoding="MathML-Content" id="S4.SS1.p2.11.m10.1b"><ci id="S4.SS1.p2.11.m10.1.1.cmml" xref="S4.SS1.p2.11.m10.1.1">𝑘</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p2.11.m10.1c">k</annotation></semantics></math>th communication round is given by</p>
<table id="Sx1.EGx8" class="ltx_equationgroup ltx_eqn_align ltx_eqn_table">

<tbody id="S4.E8"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math id="S4.E8.m1.1" class="ltx_Math" alttext="\displaystyle\hat{\bm{h}}_{i}^{k}=\text{Estimator}(\bm{\theta}_{i}^{k})" display="inline"><semantics id="S4.E8.m1.1a"><mrow id="S4.E8.m1.1.1" xref="S4.E8.m1.1.1.cmml"><msubsup id="S4.E8.m1.1.1.3" xref="S4.E8.m1.1.1.3.cmml"><mover accent="true" id="S4.E8.m1.1.1.3.2.2" xref="S4.E8.m1.1.1.3.2.2.cmml"><mi id="S4.E8.m1.1.1.3.2.2.2" xref="S4.E8.m1.1.1.3.2.2.2.cmml">𝒉</mi><mo id="S4.E8.m1.1.1.3.2.2.1" xref="S4.E8.m1.1.1.3.2.2.1.cmml">^</mo></mover><mi id="S4.E8.m1.1.1.3.2.3" xref="S4.E8.m1.1.1.3.2.3.cmml">i</mi><mi id="S4.E8.m1.1.1.3.3" xref="S4.E8.m1.1.1.3.3.cmml">k</mi></msubsup><mo id="S4.E8.m1.1.1.2" xref="S4.E8.m1.1.1.2.cmml">=</mo><mrow id="S4.E8.m1.1.1.1" xref="S4.E8.m1.1.1.1.cmml"><mtext id="S4.E8.m1.1.1.1.3" xref="S4.E8.m1.1.1.1.3a.cmml">Estimator</mtext><mo lspace="0em" rspace="0em" id="S4.E8.m1.1.1.1.2" xref="S4.E8.m1.1.1.1.2.cmml">​</mo><mrow id="S4.E8.m1.1.1.1.1.1" xref="S4.E8.m1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S4.E8.m1.1.1.1.1.1.2" xref="S4.E8.m1.1.1.1.1.1.1.cmml">(</mo><msubsup id="S4.E8.m1.1.1.1.1.1.1" xref="S4.E8.m1.1.1.1.1.1.1.cmml"><mi id="S4.E8.m1.1.1.1.1.1.1.2.2" xref="S4.E8.m1.1.1.1.1.1.1.2.2.cmml">𝜽</mi><mi id="S4.E8.m1.1.1.1.1.1.1.2.3" xref="S4.E8.m1.1.1.1.1.1.1.2.3.cmml">i</mi><mi id="S4.E8.m1.1.1.1.1.1.1.3" xref="S4.E8.m1.1.1.1.1.1.1.3.cmml">k</mi></msubsup><mo stretchy="false" id="S4.E8.m1.1.1.1.1.1.3" xref="S4.E8.m1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.E8.m1.1b"><apply id="S4.E8.m1.1.1.cmml" xref="S4.E8.m1.1.1"><eq id="S4.E8.m1.1.1.2.cmml" xref="S4.E8.m1.1.1.2"></eq><apply id="S4.E8.m1.1.1.3.cmml" xref="S4.E8.m1.1.1.3"><csymbol cd="ambiguous" id="S4.E8.m1.1.1.3.1.cmml" xref="S4.E8.m1.1.1.3">superscript</csymbol><apply id="S4.E8.m1.1.1.3.2.cmml" xref="S4.E8.m1.1.1.3"><csymbol cd="ambiguous" id="S4.E8.m1.1.1.3.2.1.cmml" xref="S4.E8.m1.1.1.3">subscript</csymbol><apply id="S4.E8.m1.1.1.3.2.2.cmml" xref="S4.E8.m1.1.1.3.2.2"><ci id="S4.E8.m1.1.1.3.2.2.1.cmml" xref="S4.E8.m1.1.1.3.2.2.1">^</ci><ci id="S4.E8.m1.1.1.3.2.2.2.cmml" xref="S4.E8.m1.1.1.3.2.2.2">𝒉</ci></apply><ci id="S4.E8.m1.1.1.3.2.3.cmml" xref="S4.E8.m1.1.1.3.2.3">𝑖</ci></apply><ci id="S4.E8.m1.1.1.3.3.cmml" xref="S4.E8.m1.1.1.3.3">𝑘</ci></apply><apply id="S4.E8.m1.1.1.1.cmml" xref="S4.E8.m1.1.1.1"><times id="S4.E8.m1.1.1.1.2.cmml" xref="S4.E8.m1.1.1.1.2"></times><ci id="S4.E8.m1.1.1.1.3a.cmml" xref="S4.E8.m1.1.1.1.3"><mtext id="S4.E8.m1.1.1.1.3.cmml" xref="S4.E8.m1.1.1.1.3">Estimator</mtext></ci><apply id="S4.E8.m1.1.1.1.1.1.1.cmml" xref="S4.E8.m1.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.E8.m1.1.1.1.1.1.1.1.cmml" xref="S4.E8.m1.1.1.1.1.1">superscript</csymbol><apply id="S4.E8.m1.1.1.1.1.1.1.2.cmml" xref="S4.E8.m1.1.1.1.1.1"><csymbol cd="ambiguous" id="S4.E8.m1.1.1.1.1.1.1.2.1.cmml" xref="S4.E8.m1.1.1.1.1.1">subscript</csymbol><ci id="S4.E8.m1.1.1.1.1.1.1.2.2.cmml" xref="S4.E8.m1.1.1.1.1.1.1.2.2">𝜽</ci><ci id="S4.E8.m1.1.1.1.1.1.1.2.3.cmml" xref="S4.E8.m1.1.1.1.1.1.1.2.3">𝑖</ci></apply><ci id="S4.E8.m1.1.1.1.1.1.1.3.cmml" xref="S4.E8.m1.1.1.1.1.1.1.3">𝑘</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.E8.m1.1c">\displaystyle\hat{\bm{h}}_{i}^{k}=\text{Estimator}(\bm{\theta}_{i}^{k})</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(8)</span></td>
</tr></tbody>
</table>
<p id="S4.SS1.p2.13" class="ltx_p">where the estimator is the GNB method in our case.</p>
</div>
<div id="S4.SS1.p3" class="ltx_para">
<p id="S4.SS1.p3.2" class="ltx_p">A big advantage of Fed-Sophia is its ability to compute the estimated Hessian’s diagonal every <math id="S4.SS1.p3.1.m1.1" class="ltx_Math" alttext="\tau" display="inline"><semantics id="S4.SS1.p3.1.m1.1a"><mi id="S4.SS1.p3.1.m1.1.1" xref="S4.SS1.p3.1.m1.1.1.cmml">τ</mi><annotation-xml encoding="MathML-Content" id="S4.SS1.p3.1.m1.1b"><ci id="S4.SS1.p3.1.m1.1.1.cmml" xref="S4.SS1.p3.1.m1.1.1">𝜏</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p3.1.m1.1c">\tau</annotation></semantics></math> iteration, where <math id="S4.SS1.p3.2.m2.1" class="ltx_Math" alttext="\tau" display="inline"><semantics id="S4.SS1.p3.2.m2.1a"><mi id="S4.SS1.p3.2.m2.1.1" xref="S4.SS1.p3.2.m2.1.1.cmml">τ</mi><annotation-xml encoding="MathML-Content" id="S4.SS1.p3.2.m2.1b"><ci id="S4.SS1.p3.2.m2.1.1.cmml" xref="S4.SS1.p3.2.m2.1.1">𝜏</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p3.2.m2.1c">\tau</annotation></semantics></math> is an integer usually between 1 and 10. Another advantage for Fed-Sophia is that it uses mini-batches to compute the loss, not the complete data. This might reflect some noise in the gradient and the Hessian. To avoid this issue and smoothen both the gradient and the Hessian, an exponential moving average is computed instead of the raw value for both of them. The update for the gradient is given by</p>
<table id="Sx1.EGx9" class="ltx_equationgroup ltx_eqn_align ltx_eqn_table">

<tbody id="S4.E9"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math id="S4.E9.m1.1" class="ltx_Math" alttext="\displaystyle\bm{m}_{i}^{k}=\beta_{1}\bm{m}_{i}^{k-1}+(1-\beta_{1})\bm{g}_{i}^{k}," display="inline"><semantics id="S4.E9.m1.1a"><mrow id="S4.E9.m1.1.1.1" xref="S4.E9.m1.1.1.1.1.cmml"><mrow id="S4.E9.m1.1.1.1.1" xref="S4.E9.m1.1.1.1.1.cmml"><msubsup id="S4.E9.m1.1.1.1.1.3" xref="S4.E9.m1.1.1.1.1.3.cmml"><mi id="S4.E9.m1.1.1.1.1.3.2.2" xref="S4.E9.m1.1.1.1.1.3.2.2.cmml">𝒎</mi><mi id="S4.E9.m1.1.1.1.1.3.2.3" xref="S4.E9.m1.1.1.1.1.3.2.3.cmml">i</mi><mi id="S4.E9.m1.1.1.1.1.3.3" xref="S4.E9.m1.1.1.1.1.3.3.cmml">k</mi></msubsup><mo id="S4.E9.m1.1.1.1.1.2" xref="S4.E9.m1.1.1.1.1.2.cmml">=</mo><mrow id="S4.E9.m1.1.1.1.1.1" xref="S4.E9.m1.1.1.1.1.1.cmml"><mrow id="S4.E9.m1.1.1.1.1.1.3" xref="S4.E9.m1.1.1.1.1.1.3.cmml"><msub id="S4.E9.m1.1.1.1.1.1.3.2" xref="S4.E9.m1.1.1.1.1.1.3.2.cmml"><mi id="S4.E9.m1.1.1.1.1.1.3.2.2" xref="S4.E9.m1.1.1.1.1.1.3.2.2.cmml">β</mi><mn id="S4.E9.m1.1.1.1.1.1.3.2.3" xref="S4.E9.m1.1.1.1.1.1.3.2.3.cmml">1</mn></msub><mo lspace="0em" rspace="0em" id="S4.E9.m1.1.1.1.1.1.3.1" xref="S4.E9.m1.1.1.1.1.1.3.1.cmml">​</mo><msubsup id="S4.E9.m1.1.1.1.1.1.3.3" xref="S4.E9.m1.1.1.1.1.1.3.3.cmml"><mi id="S4.E9.m1.1.1.1.1.1.3.3.2.2" xref="S4.E9.m1.1.1.1.1.1.3.3.2.2.cmml">𝒎</mi><mi id="S4.E9.m1.1.1.1.1.1.3.3.2.3" xref="S4.E9.m1.1.1.1.1.1.3.3.2.3.cmml">i</mi><mrow id="S4.E9.m1.1.1.1.1.1.3.3.3" xref="S4.E9.m1.1.1.1.1.1.3.3.3.cmml"><mi id="S4.E9.m1.1.1.1.1.1.3.3.3.2" xref="S4.E9.m1.1.1.1.1.1.3.3.3.2.cmml">k</mi><mo id="S4.E9.m1.1.1.1.1.1.3.3.3.1" xref="S4.E9.m1.1.1.1.1.1.3.3.3.1.cmml">−</mo><mn id="S4.E9.m1.1.1.1.1.1.3.3.3.3" xref="S4.E9.m1.1.1.1.1.1.3.3.3.3.cmml">1</mn></mrow></msubsup></mrow><mo id="S4.E9.m1.1.1.1.1.1.2" xref="S4.E9.m1.1.1.1.1.1.2.cmml">+</mo><mrow id="S4.E9.m1.1.1.1.1.1.1" xref="S4.E9.m1.1.1.1.1.1.1.cmml"><mrow id="S4.E9.m1.1.1.1.1.1.1.1.1" xref="S4.E9.m1.1.1.1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S4.E9.m1.1.1.1.1.1.1.1.1.2" xref="S4.E9.m1.1.1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="S4.E9.m1.1.1.1.1.1.1.1.1.1" xref="S4.E9.m1.1.1.1.1.1.1.1.1.1.cmml"><mn id="S4.E9.m1.1.1.1.1.1.1.1.1.1.2" xref="S4.E9.m1.1.1.1.1.1.1.1.1.1.2.cmml">1</mn><mo id="S4.E9.m1.1.1.1.1.1.1.1.1.1.1" xref="S4.E9.m1.1.1.1.1.1.1.1.1.1.1.cmml">−</mo><msub id="S4.E9.m1.1.1.1.1.1.1.1.1.1.3" xref="S4.E9.m1.1.1.1.1.1.1.1.1.1.3.cmml"><mi id="S4.E9.m1.1.1.1.1.1.1.1.1.1.3.2" xref="S4.E9.m1.1.1.1.1.1.1.1.1.1.3.2.cmml">β</mi><mn id="S4.E9.m1.1.1.1.1.1.1.1.1.1.3.3" xref="S4.E9.m1.1.1.1.1.1.1.1.1.1.3.3.cmml">1</mn></msub></mrow><mo stretchy="false" id="S4.E9.m1.1.1.1.1.1.1.1.1.3" xref="S4.E9.m1.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow><mo lspace="0em" rspace="0em" id="S4.E9.m1.1.1.1.1.1.1.2" xref="S4.E9.m1.1.1.1.1.1.1.2.cmml">​</mo><msubsup id="S4.E9.m1.1.1.1.1.1.1.3" xref="S4.E9.m1.1.1.1.1.1.1.3.cmml"><mi id="S4.E9.m1.1.1.1.1.1.1.3.2.2" xref="S4.E9.m1.1.1.1.1.1.1.3.2.2.cmml">𝒈</mi><mi id="S4.E9.m1.1.1.1.1.1.1.3.2.3" xref="S4.E9.m1.1.1.1.1.1.1.3.2.3.cmml">i</mi><mi id="S4.E9.m1.1.1.1.1.1.1.3.3" xref="S4.E9.m1.1.1.1.1.1.1.3.3.cmml">k</mi></msubsup></mrow></mrow></mrow><mo id="S4.E9.m1.1.1.1.2" xref="S4.E9.m1.1.1.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.E9.m1.1b"><apply id="S4.E9.m1.1.1.1.1.cmml" xref="S4.E9.m1.1.1.1"><eq id="S4.E9.m1.1.1.1.1.2.cmml" xref="S4.E9.m1.1.1.1.1.2"></eq><apply id="S4.E9.m1.1.1.1.1.3.cmml" xref="S4.E9.m1.1.1.1.1.3"><csymbol cd="ambiguous" id="S4.E9.m1.1.1.1.1.3.1.cmml" xref="S4.E9.m1.1.1.1.1.3">superscript</csymbol><apply id="S4.E9.m1.1.1.1.1.3.2.cmml" xref="S4.E9.m1.1.1.1.1.3"><csymbol cd="ambiguous" id="S4.E9.m1.1.1.1.1.3.2.1.cmml" xref="S4.E9.m1.1.1.1.1.3">subscript</csymbol><ci id="S4.E9.m1.1.1.1.1.3.2.2.cmml" xref="S4.E9.m1.1.1.1.1.3.2.2">𝒎</ci><ci id="S4.E9.m1.1.1.1.1.3.2.3.cmml" xref="S4.E9.m1.1.1.1.1.3.2.3">𝑖</ci></apply><ci id="S4.E9.m1.1.1.1.1.3.3.cmml" xref="S4.E9.m1.1.1.1.1.3.3">𝑘</ci></apply><apply id="S4.E9.m1.1.1.1.1.1.cmml" xref="S4.E9.m1.1.1.1.1.1"><plus id="S4.E9.m1.1.1.1.1.1.2.cmml" xref="S4.E9.m1.1.1.1.1.1.2"></plus><apply id="S4.E9.m1.1.1.1.1.1.3.cmml" xref="S4.E9.m1.1.1.1.1.1.3"><times id="S4.E9.m1.1.1.1.1.1.3.1.cmml" xref="S4.E9.m1.1.1.1.1.1.3.1"></times><apply id="S4.E9.m1.1.1.1.1.1.3.2.cmml" xref="S4.E9.m1.1.1.1.1.1.3.2"><csymbol cd="ambiguous" id="S4.E9.m1.1.1.1.1.1.3.2.1.cmml" xref="S4.E9.m1.1.1.1.1.1.3.2">subscript</csymbol><ci id="S4.E9.m1.1.1.1.1.1.3.2.2.cmml" xref="S4.E9.m1.1.1.1.1.1.3.2.2">𝛽</ci><cn type="integer" id="S4.E9.m1.1.1.1.1.1.3.2.3.cmml" xref="S4.E9.m1.1.1.1.1.1.3.2.3">1</cn></apply><apply id="S4.E9.m1.1.1.1.1.1.3.3.cmml" xref="S4.E9.m1.1.1.1.1.1.3.3"><csymbol cd="ambiguous" id="S4.E9.m1.1.1.1.1.1.3.3.1.cmml" xref="S4.E9.m1.1.1.1.1.1.3.3">superscript</csymbol><apply id="S4.E9.m1.1.1.1.1.1.3.3.2.cmml" xref="S4.E9.m1.1.1.1.1.1.3.3"><csymbol cd="ambiguous" id="S4.E9.m1.1.1.1.1.1.3.3.2.1.cmml" xref="S4.E9.m1.1.1.1.1.1.3.3">subscript</csymbol><ci id="S4.E9.m1.1.1.1.1.1.3.3.2.2.cmml" xref="S4.E9.m1.1.1.1.1.1.3.3.2.2">𝒎</ci><ci id="S4.E9.m1.1.1.1.1.1.3.3.2.3.cmml" xref="S4.E9.m1.1.1.1.1.1.3.3.2.3">𝑖</ci></apply><apply id="S4.E9.m1.1.1.1.1.1.3.3.3.cmml" xref="S4.E9.m1.1.1.1.1.1.3.3.3"><minus id="S4.E9.m1.1.1.1.1.1.3.3.3.1.cmml" xref="S4.E9.m1.1.1.1.1.1.3.3.3.1"></minus><ci id="S4.E9.m1.1.1.1.1.1.3.3.3.2.cmml" xref="S4.E9.m1.1.1.1.1.1.3.3.3.2">𝑘</ci><cn type="integer" id="S4.E9.m1.1.1.1.1.1.3.3.3.3.cmml" xref="S4.E9.m1.1.1.1.1.1.3.3.3.3">1</cn></apply></apply></apply><apply id="S4.E9.m1.1.1.1.1.1.1.cmml" xref="S4.E9.m1.1.1.1.1.1.1"><times id="S4.E9.m1.1.1.1.1.1.1.2.cmml" xref="S4.E9.m1.1.1.1.1.1.1.2"></times><apply id="S4.E9.m1.1.1.1.1.1.1.1.1.1.cmml" xref="S4.E9.m1.1.1.1.1.1.1.1.1"><minus id="S4.E9.m1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S4.E9.m1.1.1.1.1.1.1.1.1.1.1"></minus><cn type="integer" id="S4.E9.m1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S4.E9.m1.1.1.1.1.1.1.1.1.1.2">1</cn><apply id="S4.E9.m1.1.1.1.1.1.1.1.1.1.3.cmml" xref="S4.E9.m1.1.1.1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S4.E9.m1.1.1.1.1.1.1.1.1.1.3.1.cmml" xref="S4.E9.m1.1.1.1.1.1.1.1.1.1.3">subscript</csymbol><ci id="S4.E9.m1.1.1.1.1.1.1.1.1.1.3.2.cmml" xref="S4.E9.m1.1.1.1.1.1.1.1.1.1.3.2">𝛽</ci><cn type="integer" id="S4.E9.m1.1.1.1.1.1.1.1.1.1.3.3.cmml" xref="S4.E9.m1.1.1.1.1.1.1.1.1.1.3.3">1</cn></apply></apply><apply id="S4.E9.m1.1.1.1.1.1.1.3.cmml" xref="S4.E9.m1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S4.E9.m1.1.1.1.1.1.1.3.1.cmml" xref="S4.E9.m1.1.1.1.1.1.1.3">superscript</csymbol><apply id="S4.E9.m1.1.1.1.1.1.1.3.2.cmml" xref="S4.E9.m1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S4.E9.m1.1.1.1.1.1.1.3.2.1.cmml" xref="S4.E9.m1.1.1.1.1.1.1.3">subscript</csymbol><ci id="S4.E9.m1.1.1.1.1.1.1.3.2.2.cmml" xref="S4.E9.m1.1.1.1.1.1.1.3.2.2">𝒈</ci><ci id="S4.E9.m1.1.1.1.1.1.1.3.2.3.cmml" xref="S4.E9.m1.1.1.1.1.1.1.3.2.3">𝑖</ci></apply><ci id="S4.E9.m1.1.1.1.1.1.1.3.3.cmml" xref="S4.E9.m1.1.1.1.1.1.1.3.3">𝑘</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.E9.m1.1c">\displaystyle\bm{m}_{i}^{k}=\beta_{1}\bm{m}_{i}^{k-1}+(1-\beta_{1})\bm{g}_{i}^{k},</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(9)</span></td>
</tr></tbody>
</table>
<p id="S4.SS1.p3.3" class="ltx_p">while the Hessian is updated, every <math id="S4.SS1.p3.3.m1.1" class="ltx_Math" alttext="\tau" display="inline"><semantics id="S4.SS1.p3.3.m1.1a"><mi id="S4.SS1.p3.3.m1.1.1" xref="S4.SS1.p3.3.m1.1.1.cmml">τ</mi><annotation-xml encoding="MathML-Content" id="S4.SS1.p3.3.m1.1b"><ci id="S4.SS1.p3.3.m1.1.1.cmml" xref="S4.SS1.p3.3.m1.1.1">𝜏</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p3.3.m1.1c">\tau</annotation></semantics></math> iterations, using</p>
<table id="Sx1.EGx10" class="ltx_equationgroup ltx_eqn_align ltx_eqn_table">

<tbody id="S4.E10"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math id="S4.E10.m1.1" class="ltx_Math" alttext="\displaystyle\bm{h}_{i}^{k}=\beta_{2}\bm{h}_{i}^{k-\tau}+(1-\beta_{2})\hat{\bm{h}}_{i}^{k}," display="inline"><semantics id="S4.E10.m1.1a"><mrow id="S4.E10.m1.1.1.1" xref="S4.E10.m1.1.1.1.1.cmml"><mrow id="S4.E10.m1.1.1.1.1" xref="S4.E10.m1.1.1.1.1.cmml"><msubsup id="S4.E10.m1.1.1.1.1.3" xref="S4.E10.m1.1.1.1.1.3.cmml"><mi id="S4.E10.m1.1.1.1.1.3.2.2" xref="S4.E10.m1.1.1.1.1.3.2.2.cmml">𝒉</mi><mi id="S4.E10.m1.1.1.1.1.3.2.3" xref="S4.E10.m1.1.1.1.1.3.2.3.cmml">i</mi><mi id="S4.E10.m1.1.1.1.1.3.3" xref="S4.E10.m1.1.1.1.1.3.3.cmml">k</mi></msubsup><mo id="S4.E10.m1.1.1.1.1.2" xref="S4.E10.m1.1.1.1.1.2.cmml">=</mo><mrow id="S4.E10.m1.1.1.1.1.1" xref="S4.E10.m1.1.1.1.1.1.cmml"><mrow id="S4.E10.m1.1.1.1.1.1.3" xref="S4.E10.m1.1.1.1.1.1.3.cmml"><msub id="S4.E10.m1.1.1.1.1.1.3.2" xref="S4.E10.m1.1.1.1.1.1.3.2.cmml"><mi id="S4.E10.m1.1.1.1.1.1.3.2.2" xref="S4.E10.m1.1.1.1.1.1.3.2.2.cmml">β</mi><mn id="S4.E10.m1.1.1.1.1.1.3.2.3" xref="S4.E10.m1.1.1.1.1.1.3.2.3.cmml">2</mn></msub><mo lspace="0em" rspace="0em" id="S4.E10.m1.1.1.1.1.1.3.1" xref="S4.E10.m1.1.1.1.1.1.3.1.cmml">​</mo><msubsup id="S4.E10.m1.1.1.1.1.1.3.3" xref="S4.E10.m1.1.1.1.1.1.3.3.cmml"><mi id="S4.E10.m1.1.1.1.1.1.3.3.2.2" xref="S4.E10.m1.1.1.1.1.1.3.3.2.2.cmml">𝒉</mi><mi id="S4.E10.m1.1.1.1.1.1.3.3.2.3" xref="S4.E10.m1.1.1.1.1.1.3.3.2.3.cmml">i</mi><mrow id="S4.E10.m1.1.1.1.1.1.3.3.3" xref="S4.E10.m1.1.1.1.1.1.3.3.3.cmml"><mi id="S4.E10.m1.1.1.1.1.1.3.3.3.2" xref="S4.E10.m1.1.1.1.1.1.3.3.3.2.cmml">k</mi><mo id="S4.E10.m1.1.1.1.1.1.3.3.3.1" xref="S4.E10.m1.1.1.1.1.1.3.3.3.1.cmml">−</mo><mi id="S4.E10.m1.1.1.1.1.1.3.3.3.3" xref="S4.E10.m1.1.1.1.1.1.3.3.3.3.cmml">τ</mi></mrow></msubsup></mrow><mo id="S4.E10.m1.1.1.1.1.1.2" xref="S4.E10.m1.1.1.1.1.1.2.cmml">+</mo><mrow id="S4.E10.m1.1.1.1.1.1.1" xref="S4.E10.m1.1.1.1.1.1.1.cmml"><mrow id="S4.E10.m1.1.1.1.1.1.1.1.1" xref="S4.E10.m1.1.1.1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S4.E10.m1.1.1.1.1.1.1.1.1.2" xref="S4.E10.m1.1.1.1.1.1.1.1.1.1.cmml">(</mo><mrow id="S4.E10.m1.1.1.1.1.1.1.1.1.1" xref="S4.E10.m1.1.1.1.1.1.1.1.1.1.cmml"><mn id="S4.E10.m1.1.1.1.1.1.1.1.1.1.2" xref="S4.E10.m1.1.1.1.1.1.1.1.1.1.2.cmml">1</mn><mo id="S4.E10.m1.1.1.1.1.1.1.1.1.1.1" xref="S4.E10.m1.1.1.1.1.1.1.1.1.1.1.cmml">−</mo><msub id="S4.E10.m1.1.1.1.1.1.1.1.1.1.3" xref="S4.E10.m1.1.1.1.1.1.1.1.1.1.3.cmml"><mi id="S4.E10.m1.1.1.1.1.1.1.1.1.1.3.2" xref="S4.E10.m1.1.1.1.1.1.1.1.1.1.3.2.cmml">β</mi><mn id="S4.E10.m1.1.1.1.1.1.1.1.1.1.3.3" xref="S4.E10.m1.1.1.1.1.1.1.1.1.1.3.3.cmml">2</mn></msub></mrow><mo stretchy="false" id="S4.E10.m1.1.1.1.1.1.1.1.1.3" xref="S4.E10.m1.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow><mo lspace="0em" rspace="0em" id="S4.E10.m1.1.1.1.1.1.1.2" xref="S4.E10.m1.1.1.1.1.1.1.2.cmml">​</mo><msubsup id="S4.E10.m1.1.1.1.1.1.1.3" xref="S4.E10.m1.1.1.1.1.1.1.3.cmml"><mover accent="true" id="S4.E10.m1.1.1.1.1.1.1.3.2.2" xref="S4.E10.m1.1.1.1.1.1.1.3.2.2.cmml"><mi id="S4.E10.m1.1.1.1.1.1.1.3.2.2.2" xref="S4.E10.m1.1.1.1.1.1.1.3.2.2.2.cmml">𝒉</mi><mo id="S4.E10.m1.1.1.1.1.1.1.3.2.2.1" xref="S4.E10.m1.1.1.1.1.1.1.3.2.2.1.cmml">^</mo></mover><mi id="S4.E10.m1.1.1.1.1.1.1.3.2.3" xref="S4.E10.m1.1.1.1.1.1.1.3.2.3.cmml">i</mi><mi id="S4.E10.m1.1.1.1.1.1.1.3.3" xref="S4.E10.m1.1.1.1.1.1.1.3.3.cmml">k</mi></msubsup></mrow></mrow></mrow><mo id="S4.E10.m1.1.1.1.2" xref="S4.E10.m1.1.1.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.E10.m1.1b"><apply id="S4.E10.m1.1.1.1.1.cmml" xref="S4.E10.m1.1.1.1"><eq id="S4.E10.m1.1.1.1.1.2.cmml" xref="S4.E10.m1.1.1.1.1.2"></eq><apply id="S4.E10.m1.1.1.1.1.3.cmml" xref="S4.E10.m1.1.1.1.1.3"><csymbol cd="ambiguous" id="S4.E10.m1.1.1.1.1.3.1.cmml" xref="S4.E10.m1.1.1.1.1.3">superscript</csymbol><apply id="S4.E10.m1.1.1.1.1.3.2.cmml" xref="S4.E10.m1.1.1.1.1.3"><csymbol cd="ambiguous" id="S4.E10.m1.1.1.1.1.3.2.1.cmml" xref="S4.E10.m1.1.1.1.1.3">subscript</csymbol><ci id="S4.E10.m1.1.1.1.1.3.2.2.cmml" xref="S4.E10.m1.1.1.1.1.3.2.2">𝒉</ci><ci id="S4.E10.m1.1.1.1.1.3.2.3.cmml" xref="S4.E10.m1.1.1.1.1.3.2.3">𝑖</ci></apply><ci id="S4.E10.m1.1.1.1.1.3.3.cmml" xref="S4.E10.m1.1.1.1.1.3.3">𝑘</ci></apply><apply id="S4.E10.m1.1.1.1.1.1.cmml" xref="S4.E10.m1.1.1.1.1.1"><plus id="S4.E10.m1.1.1.1.1.1.2.cmml" xref="S4.E10.m1.1.1.1.1.1.2"></plus><apply id="S4.E10.m1.1.1.1.1.1.3.cmml" xref="S4.E10.m1.1.1.1.1.1.3"><times id="S4.E10.m1.1.1.1.1.1.3.1.cmml" xref="S4.E10.m1.1.1.1.1.1.3.1"></times><apply id="S4.E10.m1.1.1.1.1.1.3.2.cmml" xref="S4.E10.m1.1.1.1.1.1.3.2"><csymbol cd="ambiguous" id="S4.E10.m1.1.1.1.1.1.3.2.1.cmml" xref="S4.E10.m1.1.1.1.1.1.3.2">subscript</csymbol><ci id="S4.E10.m1.1.1.1.1.1.3.2.2.cmml" xref="S4.E10.m1.1.1.1.1.1.3.2.2">𝛽</ci><cn type="integer" id="S4.E10.m1.1.1.1.1.1.3.2.3.cmml" xref="S4.E10.m1.1.1.1.1.1.3.2.3">2</cn></apply><apply id="S4.E10.m1.1.1.1.1.1.3.3.cmml" xref="S4.E10.m1.1.1.1.1.1.3.3"><csymbol cd="ambiguous" id="S4.E10.m1.1.1.1.1.1.3.3.1.cmml" xref="S4.E10.m1.1.1.1.1.1.3.3">superscript</csymbol><apply id="S4.E10.m1.1.1.1.1.1.3.3.2.cmml" xref="S4.E10.m1.1.1.1.1.1.3.3"><csymbol cd="ambiguous" id="S4.E10.m1.1.1.1.1.1.3.3.2.1.cmml" xref="S4.E10.m1.1.1.1.1.1.3.3">subscript</csymbol><ci id="S4.E10.m1.1.1.1.1.1.3.3.2.2.cmml" xref="S4.E10.m1.1.1.1.1.1.3.3.2.2">𝒉</ci><ci id="S4.E10.m1.1.1.1.1.1.3.3.2.3.cmml" xref="S4.E10.m1.1.1.1.1.1.3.3.2.3">𝑖</ci></apply><apply id="S4.E10.m1.1.1.1.1.1.3.3.3.cmml" xref="S4.E10.m1.1.1.1.1.1.3.3.3"><minus id="S4.E10.m1.1.1.1.1.1.3.3.3.1.cmml" xref="S4.E10.m1.1.1.1.1.1.3.3.3.1"></minus><ci id="S4.E10.m1.1.1.1.1.1.3.3.3.2.cmml" xref="S4.E10.m1.1.1.1.1.1.3.3.3.2">𝑘</ci><ci id="S4.E10.m1.1.1.1.1.1.3.3.3.3.cmml" xref="S4.E10.m1.1.1.1.1.1.3.3.3.3">𝜏</ci></apply></apply></apply><apply id="S4.E10.m1.1.1.1.1.1.1.cmml" xref="S4.E10.m1.1.1.1.1.1.1"><times id="S4.E10.m1.1.1.1.1.1.1.2.cmml" xref="S4.E10.m1.1.1.1.1.1.1.2"></times><apply id="S4.E10.m1.1.1.1.1.1.1.1.1.1.cmml" xref="S4.E10.m1.1.1.1.1.1.1.1.1"><minus id="S4.E10.m1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S4.E10.m1.1.1.1.1.1.1.1.1.1.1"></minus><cn type="integer" id="S4.E10.m1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S4.E10.m1.1.1.1.1.1.1.1.1.1.2">1</cn><apply id="S4.E10.m1.1.1.1.1.1.1.1.1.1.3.cmml" xref="S4.E10.m1.1.1.1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S4.E10.m1.1.1.1.1.1.1.1.1.1.3.1.cmml" xref="S4.E10.m1.1.1.1.1.1.1.1.1.1.3">subscript</csymbol><ci id="S4.E10.m1.1.1.1.1.1.1.1.1.1.3.2.cmml" xref="S4.E10.m1.1.1.1.1.1.1.1.1.1.3.2">𝛽</ci><cn type="integer" id="S4.E10.m1.1.1.1.1.1.1.1.1.1.3.3.cmml" xref="S4.E10.m1.1.1.1.1.1.1.1.1.1.3.3">2</cn></apply></apply><apply id="S4.E10.m1.1.1.1.1.1.1.3.cmml" xref="S4.E10.m1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S4.E10.m1.1.1.1.1.1.1.3.1.cmml" xref="S4.E10.m1.1.1.1.1.1.1.3">superscript</csymbol><apply id="S4.E10.m1.1.1.1.1.1.1.3.2.cmml" xref="S4.E10.m1.1.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S4.E10.m1.1.1.1.1.1.1.3.2.1.cmml" xref="S4.E10.m1.1.1.1.1.1.1.3">subscript</csymbol><apply id="S4.E10.m1.1.1.1.1.1.1.3.2.2.cmml" xref="S4.E10.m1.1.1.1.1.1.1.3.2.2"><ci id="S4.E10.m1.1.1.1.1.1.1.3.2.2.1.cmml" xref="S4.E10.m1.1.1.1.1.1.1.3.2.2.1">^</ci><ci id="S4.E10.m1.1.1.1.1.1.1.3.2.2.2.cmml" xref="S4.E10.m1.1.1.1.1.1.1.3.2.2.2">𝒉</ci></apply><ci id="S4.E10.m1.1.1.1.1.1.1.3.2.3.cmml" xref="S4.E10.m1.1.1.1.1.1.1.3.2.3">𝑖</ci></apply><ci id="S4.E10.m1.1.1.1.1.1.1.3.3.cmml" xref="S4.E10.m1.1.1.1.1.1.1.3.3">𝑘</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.E10.m1.1c">\displaystyle\bm{h}_{i}^{k}=\beta_{2}\bm{h}_{i}^{k-\tau}+(1-\beta_{2})\hat{\bm{h}}_{i}^{k},</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(10)</span></td>
</tr></tbody>
</table>
<p id="S4.SS1.p3.5" class="ltx_p">where <math id="S4.SS1.p3.4.m1.1" class="ltx_Math" alttext="\beta_{1}" display="inline"><semantics id="S4.SS1.p3.4.m1.1a"><msub id="S4.SS1.p3.4.m1.1.1" xref="S4.SS1.p3.4.m1.1.1.cmml"><mi id="S4.SS1.p3.4.m1.1.1.2" xref="S4.SS1.p3.4.m1.1.1.2.cmml">β</mi><mn id="S4.SS1.p3.4.m1.1.1.3" xref="S4.SS1.p3.4.m1.1.1.3.cmml">1</mn></msub><annotation-xml encoding="MathML-Content" id="S4.SS1.p3.4.m1.1b"><apply id="S4.SS1.p3.4.m1.1.1.cmml" xref="S4.SS1.p3.4.m1.1.1"><csymbol cd="ambiguous" id="S4.SS1.p3.4.m1.1.1.1.cmml" xref="S4.SS1.p3.4.m1.1.1">subscript</csymbol><ci id="S4.SS1.p3.4.m1.1.1.2.cmml" xref="S4.SS1.p3.4.m1.1.1.2">𝛽</ci><cn type="integer" id="S4.SS1.p3.4.m1.1.1.3.cmml" xref="S4.SS1.p3.4.m1.1.1.3">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p3.4.m1.1c">\beta_{1}</annotation></semantics></math> and <math id="S4.SS1.p3.5.m2.1" class="ltx_Math" alttext="\beta_{2}" display="inline"><semantics id="S4.SS1.p3.5.m2.1a"><msub id="S4.SS1.p3.5.m2.1.1" xref="S4.SS1.p3.5.m2.1.1.cmml"><mi id="S4.SS1.p3.5.m2.1.1.2" xref="S4.SS1.p3.5.m2.1.1.2.cmml">β</mi><mn id="S4.SS1.p3.5.m2.1.1.3" xref="S4.SS1.p3.5.m2.1.1.3.cmml">2</mn></msub><annotation-xml encoding="MathML-Content" id="S4.SS1.p3.5.m2.1b"><apply id="S4.SS1.p3.5.m2.1.1.cmml" xref="S4.SS1.p3.5.m2.1.1"><csymbol cd="ambiguous" id="S4.SS1.p3.5.m2.1.1.1.cmml" xref="S4.SS1.p3.5.m2.1.1">subscript</csymbol><ci id="S4.SS1.p3.5.m2.1.1.2.cmml" xref="S4.SS1.p3.5.m2.1.1.2">𝛽</ci><cn type="integer" id="S4.SS1.p3.5.m2.1.1.3.cmml" xref="S4.SS1.p3.5.m2.1.1.3">2</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS1.p3.5.m2.1c">\beta_{2}</annotation></semantics></math> are two hyperparameters.</p>
</div>
<figure id="alg2" class="ltx_float ltx_algorithm">
<div id="alg2.2" class="ltx_listing ltx_lst_numbers_left ltx_listing">
<div id="alg2.2.1" class="ltx_listingline">






















































<div id="alg2.2.1.1" class="ltx_listing ltx_listing">
<div id="alg2.l1" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline">1</span><span class="ltx_tag ltx_tag_listingline"><span id="alg2.l1.1.1.1" class="ltx_text" style="font-size:80%;">1:</span></span>  <span id="alg2.l1.2" class="ltx_text ltx_font_bold">Parameters:</span> <math id="alg2.l1.m1.1" class="ltx_Math" alttext="\bm{\theta}" display="inline"><semantics id="alg2.l1.m1.1a"><mi id="alg2.l1.m1.1.1" xref="alg2.l1.m1.1.1.cmml">𝜽</mi><annotation-xml encoding="MathML-Content" id="alg2.l1.m1.1b"><ci id="alg2.l1.m1.1.1.cmml" xref="alg2.l1.m1.1.1">𝜽</ci></annotation-xml><annotation encoding="application/x-tex" id="alg2.l1.m1.1c">\bm{\theta}</annotation></semantics></math>

</div>
<div id="alg2.2.1.1.1" class="ltx_listingline">
</div>
<div id="alg2.l2" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg2.l2.1.1.1" class="ltx_text" style="font-size:80%;">2:</span></span>  Draw a mini-batch of the input <math id="alg2.l2.m1.1" class="ltx_Math" alttext="\{{\bm{x}_{b}\}}_{b=1}^{B}" display="inline"><semantics id="alg2.l2.m1.1a"><msubsup id="alg2.l2.m1.1.1" xref="alg2.l2.m1.1.1.cmml"><mrow id="alg2.l2.m1.1.1.1.1.1" xref="alg2.l2.m1.1.1.1.1.2.cmml"><mo stretchy="false" id="alg2.l2.m1.1.1.1.1.1.2" xref="alg2.l2.m1.1.1.1.1.2.cmml">{</mo><msub id="alg2.l2.m1.1.1.1.1.1.1" xref="alg2.l2.m1.1.1.1.1.1.1.cmml"><mi id="alg2.l2.m1.1.1.1.1.1.1.2" xref="alg2.l2.m1.1.1.1.1.1.1.2.cmml">𝒙</mi><mi id="alg2.l2.m1.1.1.1.1.1.1.3" xref="alg2.l2.m1.1.1.1.1.1.1.3.cmml">b</mi></msub><mo stretchy="false" id="alg2.l2.m1.1.1.1.1.1.3" xref="alg2.l2.m1.1.1.1.1.2.cmml">}</mo></mrow><mrow id="alg2.l2.m1.1.1.1.3" xref="alg2.l2.m1.1.1.1.3.cmml"><mi id="alg2.l2.m1.1.1.1.3.2" xref="alg2.l2.m1.1.1.1.3.2.cmml">b</mi><mo id="alg2.l2.m1.1.1.1.3.1" xref="alg2.l2.m1.1.1.1.3.1.cmml">=</mo><mn id="alg2.l2.m1.1.1.1.3.3" xref="alg2.l2.m1.1.1.1.3.3.cmml">1</mn></mrow><mi id="alg2.l2.m1.1.1.3" xref="alg2.l2.m1.1.1.3.cmml">B</mi></msubsup><annotation-xml encoding="MathML-Content" id="alg2.l2.m1.1b"><apply id="alg2.l2.m1.1.1.cmml" xref="alg2.l2.m1.1.1"><csymbol cd="ambiguous" id="alg2.l2.m1.1.1.2.cmml" xref="alg2.l2.m1.1.1">superscript</csymbol><apply id="alg2.l2.m1.1.1.1.cmml" xref="alg2.l2.m1.1.1"><csymbol cd="ambiguous" id="alg2.l2.m1.1.1.1.2.cmml" xref="alg2.l2.m1.1.1">subscript</csymbol><set id="alg2.l2.m1.1.1.1.1.2.cmml" xref="alg2.l2.m1.1.1.1.1.1"><apply id="alg2.l2.m1.1.1.1.1.1.1.cmml" xref="alg2.l2.m1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="alg2.l2.m1.1.1.1.1.1.1.1.cmml" xref="alg2.l2.m1.1.1.1.1.1.1">subscript</csymbol><ci id="alg2.l2.m1.1.1.1.1.1.1.2.cmml" xref="alg2.l2.m1.1.1.1.1.1.1.2">𝒙</ci><ci id="alg2.l2.m1.1.1.1.1.1.1.3.cmml" xref="alg2.l2.m1.1.1.1.1.1.1.3">𝑏</ci></apply></set><apply id="alg2.l2.m1.1.1.1.3.cmml" xref="alg2.l2.m1.1.1.1.3"><eq id="alg2.l2.m1.1.1.1.3.1.cmml" xref="alg2.l2.m1.1.1.1.3.1"></eq><ci id="alg2.l2.m1.1.1.1.3.2.cmml" xref="alg2.l2.m1.1.1.1.3.2">𝑏</ci><cn type="integer" id="alg2.l2.m1.1.1.1.3.3.cmml" xref="alg2.l2.m1.1.1.1.3.3">1</cn></apply></apply><ci id="alg2.l2.m1.1.1.3.cmml" xref="alg2.l2.m1.1.1.3">𝐵</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.l2.m1.1c">\{{\bm{x}_{b}\}}_{b=1}^{B}</annotation></semantics></math>

</div>
<div id="alg2.l3" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg2.l3.1.1.1" class="ltx_text" style="font-size:80%;">3:</span></span>  Compute the logits on the mini-batch <math id="alg2.l3.m1.2" class="ltx_Math" alttext="\{{\phi(\bm{\theta},\bm{x}_{b})\}}_{b=1}^{B}" display="inline"><semantics id="alg2.l3.m1.2a"><msubsup id="alg2.l3.m1.2.2" xref="alg2.l3.m1.2.2.cmml"><mrow id="alg2.l3.m1.2.2.1.1.1" xref="alg2.l3.m1.2.2.1.1.2.cmml"><mo stretchy="false" id="alg2.l3.m1.2.2.1.1.1.2" xref="alg2.l3.m1.2.2.1.1.2.cmml">{</mo><mrow id="alg2.l3.m1.2.2.1.1.1.1" xref="alg2.l3.m1.2.2.1.1.1.1.cmml"><mi id="alg2.l3.m1.2.2.1.1.1.1.3" xref="alg2.l3.m1.2.2.1.1.1.1.3.cmml">ϕ</mi><mo lspace="0em" rspace="0em" id="alg2.l3.m1.2.2.1.1.1.1.2" xref="alg2.l3.m1.2.2.1.1.1.1.2.cmml">​</mo><mrow id="alg2.l3.m1.2.2.1.1.1.1.1.1" xref="alg2.l3.m1.2.2.1.1.1.1.1.2.cmml"><mo stretchy="false" id="alg2.l3.m1.2.2.1.1.1.1.1.1.2" xref="alg2.l3.m1.2.2.1.1.1.1.1.2.cmml">(</mo><mi id="alg2.l3.m1.1.1" xref="alg2.l3.m1.1.1.cmml">𝜽</mi><mo id="alg2.l3.m1.2.2.1.1.1.1.1.1.3" xref="alg2.l3.m1.2.2.1.1.1.1.1.2.cmml">,</mo><msub id="alg2.l3.m1.2.2.1.1.1.1.1.1.1" xref="alg2.l3.m1.2.2.1.1.1.1.1.1.1.cmml"><mi id="alg2.l3.m1.2.2.1.1.1.1.1.1.1.2" xref="alg2.l3.m1.2.2.1.1.1.1.1.1.1.2.cmml">𝒙</mi><mi id="alg2.l3.m1.2.2.1.1.1.1.1.1.1.3" xref="alg2.l3.m1.2.2.1.1.1.1.1.1.1.3.cmml">b</mi></msub><mo stretchy="false" id="alg2.l3.m1.2.2.1.1.1.1.1.1.4" xref="alg2.l3.m1.2.2.1.1.1.1.1.2.cmml">)</mo></mrow></mrow><mo stretchy="false" id="alg2.l3.m1.2.2.1.1.1.3" xref="alg2.l3.m1.2.2.1.1.2.cmml">}</mo></mrow><mrow id="alg2.l3.m1.2.2.1.3" xref="alg2.l3.m1.2.2.1.3.cmml"><mi id="alg2.l3.m1.2.2.1.3.2" xref="alg2.l3.m1.2.2.1.3.2.cmml">b</mi><mo id="alg2.l3.m1.2.2.1.3.1" xref="alg2.l3.m1.2.2.1.3.1.cmml">=</mo><mn id="alg2.l3.m1.2.2.1.3.3" xref="alg2.l3.m1.2.2.1.3.3.cmml">1</mn></mrow><mi id="alg2.l3.m1.2.2.3" xref="alg2.l3.m1.2.2.3.cmml">B</mi></msubsup><annotation-xml encoding="MathML-Content" id="alg2.l3.m1.2b"><apply id="alg2.l3.m1.2.2.cmml" xref="alg2.l3.m1.2.2"><csymbol cd="ambiguous" id="alg2.l3.m1.2.2.2.cmml" xref="alg2.l3.m1.2.2">superscript</csymbol><apply id="alg2.l3.m1.2.2.1.cmml" xref="alg2.l3.m1.2.2"><csymbol cd="ambiguous" id="alg2.l3.m1.2.2.1.2.cmml" xref="alg2.l3.m1.2.2">subscript</csymbol><set id="alg2.l3.m1.2.2.1.1.2.cmml" xref="alg2.l3.m1.2.2.1.1.1"><apply id="alg2.l3.m1.2.2.1.1.1.1.cmml" xref="alg2.l3.m1.2.2.1.1.1.1"><times id="alg2.l3.m1.2.2.1.1.1.1.2.cmml" xref="alg2.l3.m1.2.2.1.1.1.1.2"></times><ci id="alg2.l3.m1.2.2.1.1.1.1.3.cmml" xref="alg2.l3.m1.2.2.1.1.1.1.3">italic-ϕ</ci><interval closure="open" id="alg2.l3.m1.2.2.1.1.1.1.1.2.cmml" xref="alg2.l3.m1.2.2.1.1.1.1.1.1"><ci id="alg2.l3.m1.1.1.cmml" xref="alg2.l3.m1.1.1">𝜽</ci><apply id="alg2.l3.m1.2.2.1.1.1.1.1.1.1.cmml" xref="alg2.l3.m1.2.2.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="alg2.l3.m1.2.2.1.1.1.1.1.1.1.1.cmml" xref="alg2.l3.m1.2.2.1.1.1.1.1.1.1">subscript</csymbol><ci id="alg2.l3.m1.2.2.1.1.1.1.1.1.1.2.cmml" xref="alg2.l3.m1.2.2.1.1.1.1.1.1.1.2">𝒙</ci><ci id="alg2.l3.m1.2.2.1.1.1.1.1.1.1.3.cmml" xref="alg2.l3.m1.2.2.1.1.1.1.1.1.1.3">𝑏</ci></apply></interval></apply></set><apply id="alg2.l3.m1.2.2.1.3.cmml" xref="alg2.l3.m1.2.2.1.3"><eq id="alg2.l3.m1.2.2.1.3.1.cmml" xref="alg2.l3.m1.2.2.1.3.1"></eq><ci id="alg2.l3.m1.2.2.1.3.2.cmml" xref="alg2.l3.m1.2.2.1.3.2">𝑏</ci><cn type="integer" id="alg2.l3.m1.2.2.1.3.3.cmml" xref="alg2.l3.m1.2.2.1.3.3">1</cn></apply></apply><ci id="alg2.l3.m1.2.2.3.cmml" xref="alg2.l3.m1.2.2.3">𝐵</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.l3.m1.2c">\{{\phi(\bm{\theta},\bm{x}_{b})\}}_{b=1}^{B}</annotation></semantics></math>

</div>
<div id="alg2.l4" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg2.l4.1.1.1" class="ltx_text" style="font-size:80%;">4:</span></span>  Sample <math id="alg2.l4.m1.2" class="ltx_Math" alttext="\hat{\bm{y}}_{b}\sim\text{Softmax}(\phi(\bm{\theta},\bm{x}_{b}))" display="inline"><semantics id="alg2.l4.m1.2a"><mrow id="alg2.l4.m1.2.2" xref="alg2.l4.m1.2.2.cmml"><msub id="alg2.l4.m1.2.2.3" xref="alg2.l4.m1.2.2.3.cmml"><mover accent="true" id="alg2.l4.m1.2.2.3.2" xref="alg2.l4.m1.2.2.3.2.cmml"><mi id="alg2.l4.m1.2.2.3.2.2" xref="alg2.l4.m1.2.2.3.2.2.cmml">𝒚</mi><mo id="alg2.l4.m1.2.2.3.2.1" xref="alg2.l4.m1.2.2.3.2.1.cmml">^</mo></mover><mi id="alg2.l4.m1.2.2.3.3" xref="alg2.l4.m1.2.2.3.3.cmml">b</mi></msub><mo id="alg2.l4.m1.2.2.2" xref="alg2.l4.m1.2.2.2.cmml">∼</mo><mrow id="alg2.l4.m1.2.2.1" xref="alg2.l4.m1.2.2.1.cmml"><mtext id="alg2.l4.m1.2.2.1.3" xref="alg2.l4.m1.2.2.1.3a.cmml">Softmax</mtext><mo lspace="0em" rspace="0em" id="alg2.l4.m1.2.2.1.2" xref="alg2.l4.m1.2.2.1.2.cmml">​</mo><mrow id="alg2.l4.m1.2.2.1.1.1" xref="alg2.l4.m1.2.2.1.1.1.1.cmml"><mo stretchy="false" id="alg2.l4.m1.2.2.1.1.1.2" xref="alg2.l4.m1.2.2.1.1.1.1.cmml">(</mo><mrow id="alg2.l4.m1.2.2.1.1.1.1" xref="alg2.l4.m1.2.2.1.1.1.1.cmml"><mi id="alg2.l4.m1.2.2.1.1.1.1.3" xref="alg2.l4.m1.2.2.1.1.1.1.3.cmml">ϕ</mi><mo lspace="0em" rspace="0em" id="alg2.l4.m1.2.2.1.1.1.1.2" xref="alg2.l4.m1.2.2.1.1.1.1.2.cmml">​</mo><mrow id="alg2.l4.m1.2.2.1.1.1.1.1.1" xref="alg2.l4.m1.2.2.1.1.1.1.1.2.cmml"><mo stretchy="false" id="alg2.l4.m1.2.2.1.1.1.1.1.1.2" xref="alg2.l4.m1.2.2.1.1.1.1.1.2.cmml">(</mo><mi id="alg2.l4.m1.1.1" xref="alg2.l4.m1.1.1.cmml">𝜽</mi><mo id="alg2.l4.m1.2.2.1.1.1.1.1.1.3" xref="alg2.l4.m1.2.2.1.1.1.1.1.2.cmml">,</mo><msub id="alg2.l4.m1.2.2.1.1.1.1.1.1.1" xref="alg2.l4.m1.2.2.1.1.1.1.1.1.1.cmml"><mi id="alg2.l4.m1.2.2.1.1.1.1.1.1.1.2" xref="alg2.l4.m1.2.2.1.1.1.1.1.1.1.2.cmml">𝒙</mi><mi id="alg2.l4.m1.2.2.1.1.1.1.1.1.1.3" xref="alg2.l4.m1.2.2.1.1.1.1.1.1.1.3.cmml">b</mi></msub><mo stretchy="false" id="alg2.l4.m1.2.2.1.1.1.1.1.1.4" xref="alg2.l4.m1.2.2.1.1.1.1.1.2.cmml">)</mo></mrow></mrow><mo stretchy="false" id="alg2.l4.m1.2.2.1.1.1.3" xref="alg2.l4.m1.2.2.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="alg2.l4.m1.2b"><apply id="alg2.l4.m1.2.2.cmml" xref="alg2.l4.m1.2.2"><csymbol cd="latexml" id="alg2.l4.m1.2.2.2.cmml" xref="alg2.l4.m1.2.2.2">similar-to</csymbol><apply id="alg2.l4.m1.2.2.3.cmml" xref="alg2.l4.m1.2.2.3"><csymbol cd="ambiguous" id="alg2.l4.m1.2.2.3.1.cmml" xref="alg2.l4.m1.2.2.3">subscript</csymbol><apply id="alg2.l4.m1.2.2.3.2.cmml" xref="alg2.l4.m1.2.2.3.2"><ci id="alg2.l4.m1.2.2.3.2.1.cmml" xref="alg2.l4.m1.2.2.3.2.1">^</ci><ci id="alg2.l4.m1.2.2.3.2.2.cmml" xref="alg2.l4.m1.2.2.3.2.2">𝒚</ci></apply><ci id="alg2.l4.m1.2.2.3.3.cmml" xref="alg2.l4.m1.2.2.3.3">𝑏</ci></apply><apply id="alg2.l4.m1.2.2.1.cmml" xref="alg2.l4.m1.2.2.1"><times id="alg2.l4.m1.2.2.1.2.cmml" xref="alg2.l4.m1.2.2.1.2"></times><ci id="alg2.l4.m1.2.2.1.3a.cmml" xref="alg2.l4.m1.2.2.1.3"><mtext id="alg2.l4.m1.2.2.1.3.cmml" xref="alg2.l4.m1.2.2.1.3">Softmax</mtext></ci><apply id="alg2.l4.m1.2.2.1.1.1.1.cmml" xref="alg2.l4.m1.2.2.1.1.1"><times id="alg2.l4.m1.2.2.1.1.1.1.2.cmml" xref="alg2.l4.m1.2.2.1.1.1.1.2"></times><ci id="alg2.l4.m1.2.2.1.1.1.1.3.cmml" xref="alg2.l4.m1.2.2.1.1.1.1.3">italic-ϕ</ci><interval closure="open" id="alg2.l4.m1.2.2.1.1.1.1.1.2.cmml" xref="alg2.l4.m1.2.2.1.1.1.1.1.1"><ci id="alg2.l4.m1.1.1.cmml" xref="alg2.l4.m1.1.1">𝜽</ci><apply id="alg2.l4.m1.2.2.1.1.1.1.1.1.1.cmml" xref="alg2.l4.m1.2.2.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="alg2.l4.m1.2.2.1.1.1.1.1.1.1.1.cmml" xref="alg2.l4.m1.2.2.1.1.1.1.1.1.1">subscript</csymbol><ci id="alg2.l4.m1.2.2.1.1.1.1.1.1.1.2.cmml" xref="alg2.l4.m1.2.2.1.1.1.1.1.1.1.2">𝒙</ci><ci id="alg2.l4.m1.2.2.1.1.1.1.1.1.1.3.cmml" xref="alg2.l4.m1.2.2.1.1.1.1.1.1.1.3">𝑏</ci></apply></interval></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.l4.m1.2c">\hat{\bm{y}}_{b}\sim\text{Softmax}(\phi(\bm{\theta},\bm{x}_{b}))</annotation></semantics></math>

</div>
<div id="alg2.l5" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg2.l5.1.1.1" class="ltx_text" style="font-size:80%;">5:</span></span>  Calculate <math id="alg2.l5.m1.2" class="ltx_math_unparsed" alttext="\hat{\bm{g}}=\nabla(1/B\sum f(\phi(\bm{\theta},\bm{x}_{b}),\hat{\bm{y}_{b}})" display="inline"><semantics id="alg2.l5.m1.2a"><mrow id="alg2.l5.m1.2b"><mover accent="true" id="alg2.l5.m1.2.3"><mi id="alg2.l5.m1.2.3.2">𝒈</mi><mo id="alg2.l5.m1.2.3.1">^</mo></mover><mo id="alg2.l5.m1.2.4">=</mo><mo id="alg2.l5.m1.2.5">∇</mo><mrow id="alg2.l5.m1.2.6"><mo stretchy="false" id="alg2.l5.m1.2.6.1">(</mo><mn id="alg2.l5.m1.2.6.2">1</mn><mo id="alg2.l5.m1.2.6.3">/</mo><mi id="alg2.l5.m1.2.6.4">B</mi><mo id="alg2.l5.m1.2.6.5">∑</mo><mi id="alg2.l5.m1.2.6.6">f</mi><mrow id="alg2.l5.m1.2.6.7"><mo stretchy="false" id="alg2.l5.m1.2.6.7.1">(</mo><mi id="alg2.l5.m1.2.6.7.2">ϕ</mi><mrow id="alg2.l5.m1.2.6.7.3"><mo stretchy="false" id="alg2.l5.m1.2.6.7.3.1">(</mo><mi id="alg2.l5.m1.1.1">𝜽</mi><mo id="alg2.l5.m1.2.6.7.3.2">,</mo><msub id="alg2.l5.m1.2.6.7.3.3"><mi id="alg2.l5.m1.2.6.7.3.3.2">𝒙</mi><mi id="alg2.l5.m1.2.6.7.3.3.3">b</mi></msub><mo stretchy="false" id="alg2.l5.m1.2.6.7.3.4">)</mo></mrow><mo id="alg2.l5.m1.2.6.7.4">,</mo><mover accent="true" id="alg2.l5.m1.2.2"><msub id="alg2.l5.m1.2.2.2"><mi id="alg2.l5.m1.2.2.2.2">𝒚</mi><mi id="alg2.l5.m1.2.2.2.3">b</mi></msub><mo id="alg2.l5.m1.2.2.1">^</mo></mover><mo stretchy="false" id="alg2.l5.m1.2.6.7.5">)</mo></mrow></mrow></mrow><annotation encoding="application/x-tex" id="alg2.l5.m1.2c">\hat{\bm{g}}=\nabla(1/B\sum f(\phi(\bm{\theta},\bm{x}_{b}),\hat{\bm{y}_{b}})</annotation></semantics></math> 
</div>
<div id="alg2.l6" class="ltx_listingline">
<span class="ltx_tag ltx_tag_listingline"><span id="alg2.l6.1.1.1" class="ltx_text" style="font-size:80%;">6:</span></span>  return <math id="alg2.l6.m1.1" class="ltx_Math" alttext="B\cdot\hat{\bm{g}}\odot\hat{\bm{g}}" display="inline"><semantics id="alg2.l6.m1.1a"><mrow id="alg2.l6.m1.1.1" xref="alg2.l6.m1.1.1.cmml"><mrow id="alg2.l6.m1.1.1.2" xref="alg2.l6.m1.1.1.2.cmml"><mi id="alg2.l6.m1.1.1.2.2" xref="alg2.l6.m1.1.1.2.2.cmml">B</mi><mo lspace="0.222em" rspace="0.222em" id="alg2.l6.m1.1.1.2.1" xref="alg2.l6.m1.1.1.2.1.cmml">⋅</mo><mover accent="true" id="alg2.l6.m1.1.1.2.3" xref="alg2.l6.m1.1.1.2.3.cmml"><mi id="alg2.l6.m1.1.1.2.3.2" xref="alg2.l6.m1.1.1.2.3.2.cmml">𝒈</mi><mo id="alg2.l6.m1.1.1.2.3.1" xref="alg2.l6.m1.1.1.2.3.1.cmml">^</mo></mover></mrow><mo lspace="0.222em" rspace="0.222em" id="alg2.l6.m1.1.1.1" xref="alg2.l6.m1.1.1.1.cmml">⊙</mo><mover accent="true" id="alg2.l6.m1.1.1.3" xref="alg2.l6.m1.1.1.3.cmml"><mi id="alg2.l6.m1.1.1.3.2" xref="alg2.l6.m1.1.1.3.2.cmml">𝒈</mi><mo id="alg2.l6.m1.1.1.3.1" xref="alg2.l6.m1.1.1.3.1.cmml">^</mo></mover></mrow><annotation-xml encoding="MathML-Content" id="alg2.l6.m1.1b"><apply id="alg2.l6.m1.1.1.cmml" xref="alg2.l6.m1.1.1"><csymbol cd="latexml" id="alg2.l6.m1.1.1.1.cmml" xref="alg2.l6.m1.1.1.1">direct-product</csymbol><apply id="alg2.l6.m1.1.1.2.cmml" xref="alg2.l6.m1.1.1.2"><ci id="alg2.l6.m1.1.1.2.1.cmml" xref="alg2.l6.m1.1.1.2.1">⋅</ci><ci id="alg2.l6.m1.1.1.2.2.cmml" xref="alg2.l6.m1.1.1.2.2">𝐵</ci><apply id="alg2.l6.m1.1.1.2.3.cmml" xref="alg2.l6.m1.1.1.2.3"><ci id="alg2.l6.m1.1.1.2.3.1.cmml" xref="alg2.l6.m1.1.1.2.3.1">^</ci><ci id="alg2.l6.m1.1.1.2.3.2.cmml" xref="alg2.l6.m1.1.1.2.3.2">𝒈</ci></apply></apply><apply id="alg2.l6.m1.1.1.3.cmml" xref="alg2.l6.m1.1.1.3"><ci id="alg2.l6.m1.1.1.3.1.cmml" xref="alg2.l6.m1.1.1.3.1">^</ci><ci id="alg2.l6.m1.1.1.3.2.cmml" xref="alg2.l6.m1.1.1.3.2">𝒈</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="alg2.l6.m1.1c">B\cdot\hat{\bm{g}}\odot\hat{\bm{g}}</annotation></semantics></math>

</div>
</div>

</div>
</div>
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_float"><span id="alg2.3.1.1" class="ltx_text ltx_font_bold">Algorithm 2</span> </span>Gauss-Newton-Bartlett (GNB)</figcaption>
</figure>
</section>
<section id="S4.SS2" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection"><span id="S4.SS2.4.1.1" class="ltx_text">IV-B</span> </span><span id="S4.SS2.5.2" class="ltx_text ltx_font_italic">Adaptive Step Size</span>
</h3>

<div id="S4.SS2.p1" class="ltx_para">
<p id="S4.SS2.p1.2" class="ltx_p">The update at the <math id="S4.SS2.p1.1.m1.1" class="ltx_Math" alttext="i" display="inline"><semantics id="S4.SS2.p1.1.m1.1a"><mi id="S4.SS2.p1.1.m1.1.1" xref="S4.SS2.p1.1.m1.1.1.cmml">i</mi><annotation-xml encoding="MathML-Content" id="S4.SS2.p1.1.m1.1b"><ci id="S4.SS2.p1.1.m1.1.1.cmml" xref="S4.SS2.p1.1.m1.1.1">𝑖</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p1.1.m1.1c">i</annotation></semantics></math>th device is performed by dividing the moving average of the gradient by the moving average of the estimated diagonal Hessian, i.e., <math id="S4.SS2.p1.2.m2.1" class="ltx_Math" alttext="\bm{m}_{i}^{k}/\bm{h}_{i}^{k}" display="inline"><semantics id="S4.SS2.p1.2.m2.1a"><mrow id="S4.SS2.p1.2.m2.1.1" xref="S4.SS2.p1.2.m2.1.1.cmml"><msubsup id="S4.SS2.p1.2.m2.1.1.2" xref="S4.SS2.p1.2.m2.1.1.2.cmml"><mi id="S4.SS2.p1.2.m2.1.1.2.2.2" xref="S4.SS2.p1.2.m2.1.1.2.2.2.cmml">𝒎</mi><mi id="S4.SS2.p1.2.m2.1.1.2.2.3" xref="S4.SS2.p1.2.m2.1.1.2.2.3.cmml">i</mi><mi id="S4.SS2.p1.2.m2.1.1.2.3" xref="S4.SS2.p1.2.m2.1.1.2.3.cmml">k</mi></msubsup><mo id="S4.SS2.p1.2.m2.1.1.1" xref="S4.SS2.p1.2.m2.1.1.1.cmml">/</mo><msubsup id="S4.SS2.p1.2.m2.1.1.3" xref="S4.SS2.p1.2.m2.1.1.3.cmml"><mi id="S4.SS2.p1.2.m2.1.1.3.2.2" xref="S4.SS2.p1.2.m2.1.1.3.2.2.cmml">𝒉</mi><mi id="S4.SS2.p1.2.m2.1.1.3.2.3" xref="S4.SS2.p1.2.m2.1.1.3.2.3.cmml">i</mi><mi id="S4.SS2.p1.2.m2.1.1.3.3" xref="S4.SS2.p1.2.m2.1.1.3.3.cmml">k</mi></msubsup></mrow><annotation-xml encoding="MathML-Content" id="S4.SS2.p1.2.m2.1b"><apply id="S4.SS2.p1.2.m2.1.1.cmml" xref="S4.SS2.p1.2.m2.1.1"><divide id="S4.SS2.p1.2.m2.1.1.1.cmml" xref="S4.SS2.p1.2.m2.1.1.1"></divide><apply id="S4.SS2.p1.2.m2.1.1.2.cmml" xref="S4.SS2.p1.2.m2.1.1.2"><csymbol cd="ambiguous" id="S4.SS2.p1.2.m2.1.1.2.1.cmml" xref="S4.SS2.p1.2.m2.1.1.2">superscript</csymbol><apply id="S4.SS2.p1.2.m2.1.1.2.2.cmml" xref="S4.SS2.p1.2.m2.1.1.2"><csymbol cd="ambiguous" id="S4.SS2.p1.2.m2.1.1.2.2.1.cmml" xref="S4.SS2.p1.2.m2.1.1.2">subscript</csymbol><ci id="S4.SS2.p1.2.m2.1.1.2.2.2.cmml" xref="S4.SS2.p1.2.m2.1.1.2.2.2">𝒎</ci><ci id="S4.SS2.p1.2.m2.1.1.2.2.3.cmml" xref="S4.SS2.p1.2.m2.1.1.2.2.3">𝑖</ci></apply><ci id="S4.SS2.p1.2.m2.1.1.2.3.cmml" xref="S4.SS2.p1.2.m2.1.1.2.3">𝑘</ci></apply><apply id="S4.SS2.p1.2.m2.1.1.3.cmml" xref="S4.SS2.p1.2.m2.1.1.3"><csymbol cd="ambiguous" id="S4.SS2.p1.2.m2.1.1.3.1.cmml" xref="S4.SS2.p1.2.m2.1.1.3">superscript</csymbol><apply id="S4.SS2.p1.2.m2.1.1.3.2.cmml" xref="S4.SS2.p1.2.m2.1.1.3"><csymbol cd="ambiguous" id="S4.SS2.p1.2.m2.1.1.3.2.1.cmml" xref="S4.SS2.p1.2.m2.1.1.3">subscript</csymbol><ci id="S4.SS2.p1.2.m2.1.1.3.2.2.cmml" xref="S4.SS2.p1.2.m2.1.1.3.2.2">𝒉</ci><ci id="S4.SS2.p1.2.m2.1.1.3.2.3.cmml" xref="S4.SS2.p1.2.m2.1.1.3.2.3">𝑖</ci></apply><ci id="S4.SS2.p1.2.m2.1.1.3.3.cmml" xref="S4.SS2.p1.2.m2.1.1.3.3">𝑘</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS2.p1.2.m2.1c">\bm{m}_{i}^{k}/\bm{h}_{i}^{k}</annotation></semantics></math>. The motivation for this update is the fact that the ideal step size to take should be proportionally inverse to the Hessian across each dimension to avoid uniform steps across all dimensions. In other words, we need to make weighted steps at each dimension, where the weights are the Hessian’s information across those dimensions. Rather than using a fixed update step across all dimensions of the loss function, the idea is to adjust this step to enable sharp dimensions and flat dimensions to behave accordingly. For sharp dimensions, the step size is expected to be less than in flat dimensions. Dividing by the estimated Hessian enables the adaptive step size mechanism, which in turn assigns different step sizes depending on the shape of the loss curvature.</p>
</div>
</section>
<section id="S4.SS3" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection"><span id="S4.SS3.4.1.1" class="ltx_text">IV-C</span> </span><span id="S4.SS3.5.2" class="ltx_text ltx_font_italic">Clipping Operation</span>
</h3>

<div id="S4.SS3.p1" class="ltx_para">
<p id="S4.SS3.p1.1" class="ltx_p">Along with the problem of converging to a saddle point in the case of a non-convex loss function, the Hessian entries might be misleading the convergence process in case there are sudden changes along the loss function curvature. To help mitigate these problems, a clipping operation is introduced. The clipping operation guards against inaccurate information that might be incorporated into the Hessian’s diagonal. Given a vector <math id="S4.SS3.p1.1.m1.1" class="ltx_Math" alttext="\bm{z}" display="inline"><semantics id="S4.SS3.p1.1.m1.1a"><mi id="S4.SS3.p1.1.m1.1.1" xref="S4.SS3.p1.1.m1.1.1.cmml">𝒛</mi><annotation-xml encoding="MathML-Content" id="S4.SS3.p1.1.m1.1b"><ci id="S4.SS3.p1.1.m1.1.1.cmml" xref="S4.SS3.p1.1.m1.1.1">𝒛</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p1.1.m1.1c">\bm{z}</annotation></semantics></math>, the formula for the clipping operation is given by</p>
<table id="Sx1.EGx11" class="ltx_equationgroup ltx_eqn_align ltx_eqn_table">

<tbody id="S4.E11"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math id="S4.E11.m1.7" class="ltx_Math" alttext="\displaystyle\text{clip}(\bm{z},\rho)=\max\{\min\{z,\rho\},-\rho\}," display="inline"><semantics id="S4.E11.m1.7a"><mrow id="S4.E11.m1.7.7.1" xref="S4.E11.m1.7.7.1.1.cmml"><mrow id="S4.E11.m1.7.7.1.1" xref="S4.E11.m1.7.7.1.1.cmml"><mrow id="S4.E11.m1.7.7.1.1.4" xref="S4.E11.m1.7.7.1.1.4.cmml"><mtext id="S4.E11.m1.7.7.1.1.4.2" xref="S4.E11.m1.7.7.1.1.4.2a.cmml">clip</mtext><mo lspace="0em" rspace="0em" id="S4.E11.m1.7.7.1.1.4.1" xref="S4.E11.m1.7.7.1.1.4.1.cmml">​</mo><mrow id="S4.E11.m1.7.7.1.1.4.3.2" xref="S4.E11.m1.7.7.1.1.4.3.1.cmml"><mo stretchy="false" id="S4.E11.m1.7.7.1.1.4.3.2.1" xref="S4.E11.m1.7.7.1.1.4.3.1.cmml">(</mo><mi id="S4.E11.m1.1.1" xref="S4.E11.m1.1.1.cmml">𝒛</mi><mo id="S4.E11.m1.7.7.1.1.4.3.2.2" xref="S4.E11.m1.7.7.1.1.4.3.1.cmml">,</mo><mi id="S4.E11.m1.2.2" xref="S4.E11.m1.2.2.cmml">ρ</mi><mo stretchy="false" id="S4.E11.m1.7.7.1.1.4.3.2.3" xref="S4.E11.m1.7.7.1.1.4.3.1.cmml">)</mo></mrow></mrow><mo id="S4.E11.m1.7.7.1.1.3" xref="S4.E11.m1.7.7.1.1.3.cmml">=</mo><mrow id="S4.E11.m1.7.7.1.1.2.2" xref="S4.E11.m1.7.7.1.1.2.3.cmml"><mi id="S4.E11.m1.6.6" xref="S4.E11.m1.6.6.cmml">max</mi><mo id="S4.E11.m1.7.7.1.1.2.2a" xref="S4.E11.m1.7.7.1.1.2.3.cmml">⁡</mo><mrow id="S4.E11.m1.7.7.1.1.2.2.2" xref="S4.E11.m1.7.7.1.1.2.3.cmml"><mo stretchy="false" id="S4.E11.m1.7.7.1.1.2.2.2.3" xref="S4.E11.m1.7.7.1.1.2.3.cmml">{</mo><mrow id="S4.E11.m1.7.7.1.1.1.1.1.1.2" xref="S4.E11.m1.7.7.1.1.1.1.1.1.1.cmml"><mi id="S4.E11.m1.3.3" xref="S4.E11.m1.3.3.cmml">min</mi><mo id="S4.E11.m1.7.7.1.1.1.1.1.1.2a" xref="S4.E11.m1.7.7.1.1.1.1.1.1.1.cmml">⁡</mo><mrow id="S4.E11.m1.7.7.1.1.1.1.1.1.2.1" xref="S4.E11.m1.7.7.1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S4.E11.m1.7.7.1.1.1.1.1.1.2.1.1" xref="S4.E11.m1.7.7.1.1.1.1.1.1.1.cmml">{</mo><mi id="S4.E11.m1.4.4" xref="S4.E11.m1.4.4.cmml">z</mi><mo id="S4.E11.m1.7.7.1.1.1.1.1.1.2.1.2" xref="S4.E11.m1.7.7.1.1.1.1.1.1.1.cmml">,</mo><mi id="S4.E11.m1.5.5" xref="S4.E11.m1.5.5.cmml">ρ</mi><mo stretchy="false" id="S4.E11.m1.7.7.1.1.1.1.1.1.2.1.3" xref="S4.E11.m1.7.7.1.1.1.1.1.1.1.cmml">}</mo></mrow></mrow><mo id="S4.E11.m1.7.7.1.1.2.2.2.4" xref="S4.E11.m1.7.7.1.1.2.3.cmml">,</mo><mrow id="S4.E11.m1.7.7.1.1.2.2.2.2" xref="S4.E11.m1.7.7.1.1.2.2.2.2.cmml"><mo id="S4.E11.m1.7.7.1.1.2.2.2.2a" xref="S4.E11.m1.7.7.1.1.2.2.2.2.cmml">−</mo><mi id="S4.E11.m1.7.7.1.1.2.2.2.2.2" xref="S4.E11.m1.7.7.1.1.2.2.2.2.2.cmml">ρ</mi></mrow><mo stretchy="false" id="S4.E11.m1.7.7.1.1.2.2.2.5" xref="S4.E11.m1.7.7.1.1.2.3.cmml">}</mo></mrow></mrow></mrow><mo id="S4.E11.m1.7.7.1.2" xref="S4.E11.m1.7.7.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.E11.m1.7b"><apply id="S4.E11.m1.7.7.1.1.cmml" xref="S4.E11.m1.7.7.1"><eq id="S4.E11.m1.7.7.1.1.3.cmml" xref="S4.E11.m1.7.7.1.1.3"></eq><apply id="S4.E11.m1.7.7.1.1.4.cmml" xref="S4.E11.m1.7.7.1.1.4"><times id="S4.E11.m1.7.7.1.1.4.1.cmml" xref="S4.E11.m1.7.7.1.1.4.1"></times><ci id="S4.E11.m1.7.7.1.1.4.2a.cmml" xref="S4.E11.m1.7.7.1.1.4.2"><mtext id="S4.E11.m1.7.7.1.1.4.2.cmml" xref="S4.E11.m1.7.7.1.1.4.2">clip</mtext></ci><interval closure="open" id="S4.E11.m1.7.7.1.1.4.3.1.cmml" xref="S4.E11.m1.7.7.1.1.4.3.2"><ci id="S4.E11.m1.1.1.cmml" xref="S4.E11.m1.1.1">𝒛</ci><ci id="S4.E11.m1.2.2.cmml" xref="S4.E11.m1.2.2">𝜌</ci></interval></apply><apply id="S4.E11.m1.7.7.1.1.2.3.cmml" xref="S4.E11.m1.7.7.1.1.2.2"><max id="S4.E11.m1.6.6.cmml" xref="S4.E11.m1.6.6"></max><apply id="S4.E11.m1.7.7.1.1.1.1.1.1.1.cmml" xref="S4.E11.m1.7.7.1.1.1.1.1.1.2"><min id="S4.E11.m1.3.3.cmml" xref="S4.E11.m1.3.3"></min><ci id="S4.E11.m1.4.4.cmml" xref="S4.E11.m1.4.4">𝑧</ci><ci id="S4.E11.m1.5.5.cmml" xref="S4.E11.m1.5.5">𝜌</ci></apply><apply id="S4.E11.m1.7.7.1.1.2.2.2.2.cmml" xref="S4.E11.m1.7.7.1.1.2.2.2.2"><minus id="S4.E11.m1.7.7.1.1.2.2.2.2.1.cmml" xref="S4.E11.m1.7.7.1.1.2.2.2.2"></minus><ci id="S4.E11.m1.7.7.1.1.2.2.2.2.2.cmml" xref="S4.E11.m1.7.7.1.1.2.2.2.2.2">𝜌</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.E11.m1.7c">\displaystyle\text{clip}(\bm{z},\rho)=\max\{\min\{z,\rho\},-\rho\},</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(11)</span></td>
</tr></tbody>
</table>
<p id="S4.SS3.p1.2" class="ltx_p">where <math id="S4.SS3.p1.2.m1.1" class="ltx_Math" alttext="\rho" display="inline"><semantics id="S4.SS3.p1.2.m1.1a"><mi id="S4.SS3.p1.2.m1.1.1" xref="S4.SS3.p1.2.m1.1.1.cmml">ρ</mi><annotation-xml encoding="MathML-Content" id="S4.SS3.p1.2.m1.1b"><ci id="S4.SS3.p1.2.m1.1.1.cmml" xref="S4.SS3.p1.2.m1.1.1">𝜌</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p1.2.m1.1c">\rho</annotation></semantics></math> is a positive real number that controls the maximum update magnitude. Using the clipping operation, the descent direction (<a href="#S4.E6" title="In IV-A Hessian as a Pre-conditioner ‣ IV Proposed Algorithm ‣ Fed-Sophia: A Communication-Efficient Second-Order Federated Learning Algorithm Identify applicable funding agency here. If none, delete this." class="ltx_ref"><span class="ltx_text ltx_ref_tag">6</span></a>) becomes</p>
<table id="Sx1.EGx12" class="ltx_equationgroup ltx_eqn_align ltx_eqn_table">

<tbody id="S4.E12"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math id="S4.E12.m1.5" class="ltx_Math" alttext="\displaystyle\Delta\bm{\theta}_{i}^{k}=\text{clip}\left(\frac{\bm{m}_{i}^{k}}{\max\{\bm{h}_{i}^{k},\epsilon\}},\rho\right)," display="inline"><semantics id="S4.E12.m1.5a"><mrow id="S4.E12.m1.5.5.1" xref="S4.E12.m1.5.5.1.1.cmml"><mrow id="S4.E12.m1.5.5.1.1" xref="S4.E12.m1.5.5.1.1.cmml"><mrow id="S4.E12.m1.5.5.1.1.2" xref="S4.E12.m1.5.5.1.1.2.cmml"><mi mathvariant="normal" id="S4.E12.m1.5.5.1.1.2.2" xref="S4.E12.m1.5.5.1.1.2.2.cmml">Δ</mi><mo lspace="0em" rspace="0em" id="S4.E12.m1.5.5.1.1.2.1" xref="S4.E12.m1.5.5.1.1.2.1.cmml">​</mo><msubsup id="S4.E12.m1.5.5.1.1.2.3" xref="S4.E12.m1.5.5.1.1.2.3.cmml"><mi id="S4.E12.m1.5.5.1.1.2.3.2.2" xref="S4.E12.m1.5.5.1.1.2.3.2.2.cmml">𝜽</mi><mi id="S4.E12.m1.5.5.1.1.2.3.2.3" xref="S4.E12.m1.5.5.1.1.2.3.2.3.cmml">i</mi><mi id="S4.E12.m1.5.5.1.1.2.3.3" xref="S4.E12.m1.5.5.1.1.2.3.3.cmml">k</mi></msubsup></mrow><mo id="S4.E12.m1.5.5.1.1.1" xref="S4.E12.m1.5.5.1.1.1.cmml">=</mo><mrow id="S4.E12.m1.5.5.1.1.3" xref="S4.E12.m1.5.5.1.1.3.cmml"><mtext id="S4.E12.m1.5.5.1.1.3.2" xref="S4.E12.m1.5.5.1.1.3.2a.cmml">clip</mtext><mo lspace="0em" rspace="0em" id="S4.E12.m1.5.5.1.1.3.1" xref="S4.E12.m1.5.5.1.1.3.1.cmml">​</mo><mrow id="S4.E12.m1.5.5.1.1.3.3.2" xref="S4.E12.m1.5.5.1.1.3.3.1.cmml"><mo id="S4.E12.m1.5.5.1.1.3.3.2.1" xref="S4.E12.m1.5.5.1.1.3.3.1.cmml">(</mo><mstyle displaystyle="true" id="S4.E12.m1.3.3" xref="S4.E12.m1.3.3.cmml"><mfrac id="S4.E12.m1.3.3a" xref="S4.E12.m1.3.3.cmml"><msubsup id="S4.E12.m1.3.3.5" xref="S4.E12.m1.3.3.5.cmml"><mi id="S4.E12.m1.3.3.5.2.2" xref="S4.E12.m1.3.3.5.2.2.cmml">𝒎</mi><mi id="S4.E12.m1.3.3.5.2.3" xref="S4.E12.m1.3.3.5.2.3.cmml">i</mi><mi id="S4.E12.m1.3.3.5.3" xref="S4.E12.m1.3.3.5.3.cmml">k</mi></msubsup><mrow id="S4.E12.m1.3.3.3.3" xref="S4.E12.m1.3.3.3.4.cmml"><mi id="S4.E12.m1.1.1.1.1" xref="S4.E12.m1.1.1.1.1.cmml">max</mi><mo id="S4.E12.m1.3.3.3.3a" xref="S4.E12.m1.3.3.3.4.cmml">⁡</mo><mrow id="S4.E12.m1.3.3.3.3.1" xref="S4.E12.m1.3.3.3.4.cmml"><mo stretchy="false" id="S4.E12.m1.3.3.3.3.1.2" xref="S4.E12.m1.3.3.3.4.cmml">{</mo><msubsup id="S4.E12.m1.3.3.3.3.1.1" xref="S4.E12.m1.3.3.3.3.1.1.cmml"><mi id="S4.E12.m1.3.3.3.3.1.1.2.2" xref="S4.E12.m1.3.3.3.3.1.1.2.2.cmml">𝒉</mi><mi id="S4.E12.m1.3.3.3.3.1.1.2.3" xref="S4.E12.m1.3.3.3.3.1.1.2.3.cmml">i</mi><mi id="S4.E12.m1.3.3.3.3.1.1.3" xref="S4.E12.m1.3.3.3.3.1.1.3.cmml">k</mi></msubsup><mo id="S4.E12.m1.3.3.3.3.1.3" xref="S4.E12.m1.3.3.3.4.cmml">,</mo><mi id="S4.E12.m1.2.2.2.2" xref="S4.E12.m1.2.2.2.2.cmml">ϵ</mi><mo stretchy="false" id="S4.E12.m1.3.3.3.3.1.4" xref="S4.E12.m1.3.3.3.4.cmml">}</mo></mrow></mrow></mfrac></mstyle><mo id="S4.E12.m1.5.5.1.1.3.3.2.2" xref="S4.E12.m1.5.5.1.1.3.3.1.cmml">,</mo><mi id="S4.E12.m1.4.4" xref="S4.E12.m1.4.4.cmml">ρ</mi><mo id="S4.E12.m1.5.5.1.1.3.3.2.3" xref="S4.E12.m1.5.5.1.1.3.3.1.cmml">)</mo></mrow></mrow></mrow><mo id="S4.E12.m1.5.5.1.2" xref="S4.E12.m1.5.5.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S4.E12.m1.5b"><apply id="S4.E12.m1.5.5.1.1.cmml" xref="S4.E12.m1.5.5.1"><eq id="S4.E12.m1.5.5.1.1.1.cmml" xref="S4.E12.m1.5.5.1.1.1"></eq><apply id="S4.E12.m1.5.5.1.1.2.cmml" xref="S4.E12.m1.5.5.1.1.2"><times id="S4.E12.m1.5.5.1.1.2.1.cmml" xref="S4.E12.m1.5.5.1.1.2.1"></times><ci id="S4.E12.m1.5.5.1.1.2.2.cmml" xref="S4.E12.m1.5.5.1.1.2.2">Δ</ci><apply id="S4.E12.m1.5.5.1.1.2.3.cmml" xref="S4.E12.m1.5.5.1.1.2.3"><csymbol cd="ambiguous" id="S4.E12.m1.5.5.1.1.2.3.1.cmml" xref="S4.E12.m1.5.5.1.1.2.3">superscript</csymbol><apply id="S4.E12.m1.5.5.1.1.2.3.2.cmml" xref="S4.E12.m1.5.5.1.1.2.3"><csymbol cd="ambiguous" id="S4.E12.m1.5.5.1.1.2.3.2.1.cmml" xref="S4.E12.m1.5.5.1.1.2.3">subscript</csymbol><ci id="S4.E12.m1.5.5.1.1.2.3.2.2.cmml" xref="S4.E12.m1.5.5.1.1.2.3.2.2">𝜽</ci><ci id="S4.E12.m1.5.5.1.1.2.3.2.3.cmml" xref="S4.E12.m1.5.5.1.1.2.3.2.3">𝑖</ci></apply><ci id="S4.E12.m1.5.5.1.1.2.3.3.cmml" xref="S4.E12.m1.5.5.1.1.2.3.3">𝑘</ci></apply></apply><apply id="S4.E12.m1.5.5.1.1.3.cmml" xref="S4.E12.m1.5.5.1.1.3"><times id="S4.E12.m1.5.5.1.1.3.1.cmml" xref="S4.E12.m1.5.5.1.1.3.1"></times><ci id="S4.E12.m1.5.5.1.1.3.2a.cmml" xref="S4.E12.m1.5.5.1.1.3.2"><mtext id="S4.E12.m1.5.5.1.1.3.2.cmml" xref="S4.E12.m1.5.5.1.1.3.2">clip</mtext></ci><interval closure="open" id="S4.E12.m1.5.5.1.1.3.3.1.cmml" xref="S4.E12.m1.5.5.1.1.3.3.2"><apply id="S4.E12.m1.3.3.cmml" xref="S4.E12.m1.3.3"><divide id="S4.E12.m1.3.3.4.cmml" xref="S4.E12.m1.3.3"></divide><apply id="S4.E12.m1.3.3.5.cmml" xref="S4.E12.m1.3.3.5"><csymbol cd="ambiguous" id="S4.E12.m1.3.3.5.1.cmml" xref="S4.E12.m1.3.3.5">superscript</csymbol><apply id="S4.E12.m1.3.3.5.2.cmml" xref="S4.E12.m1.3.3.5"><csymbol cd="ambiguous" id="S4.E12.m1.3.3.5.2.1.cmml" xref="S4.E12.m1.3.3.5">subscript</csymbol><ci id="S4.E12.m1.3.3.5.2.2.cmml" xref="S4.E12.m1.3.3.5.2.2">𝒎</ci><ci id="S4.E12.m1.3.3.5.2.3.cmml" xref="S4.E12.m1.3.3.5.2.3">𝑖</ci></apply><ci id="S4.E12.m1.3.3.5.3.cmml" xref="S4.E12.m1.3.3.5.3">𝑘</ci></apply><apply id="S4.E12.m1.3.3.3.4.cmml" xref="S4.E12.m1.3.3.3.3"><max id="S4.E12.m1.1.1.1.1.cmml" xref="S4.E12.m1.1.1.1.1"></max><apply id="S4.E12.m1.3.3.3.3.1.1.cmml" xref="S4.E12.m1.3.3.3.3.1.1"><csymbol cd="ambiguous" id="S4.E12.m1.3.3.3.3.1.1.1.cmml" xref="S4.E12.m1.3.3.3.3.1.1">superscript</csymbol><apply id="S4.E12.m1.3.3.3.3.1.1.2.cmml" xref="S4.E12.m1.3.3.3.3.1.1"><csymbol cd="ambiguous" id="S4.E12.m1.3.3.3.3.1.1.2.1.cmml" xref="S4.E12.m1.3.3.3.3.1.1">subscript</csymbol><ci id="S4.E12.m1.3.3.3.3.1.1.2.2.cmml" xref="S4.E12.m1.3.3.3.3.1.1.2.2">𝒉</ci><ci id="S4.E12.m1.3.3.3.3.1.1.2.3.cmml" xref="S4.E12.m1.3.3.3.3.1.1.2.3">𝑖</ci></apply><ci id="S4.E12.m1.3.3.3.3.1.1.3.cmml" xref="S4.E12.m1.3.3.3.3.1.1.3">𝑘</ci></apply><ci id="S4.E12.m1.2.2.2.2.cmml" xref="S4.E12.m1.2.2.2.2">italic-ϵ</ci></apply></apply><ci id="S4.E12.m1.4.4.cmml" xref="S4.E12.m1.4.4">𝜌</ci></interval></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.E12.m1.5c">\displaystyle\Delta\bm{\theta}_{i}^{k}=\text{clip}\left(\frac{\bm{m}_{i}^{k}}{\max\{\bm{h}_{i}^{k},\epsilon\}},\rho\right),</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(12)</span></td>
</tr></tbody>
</table>
<p id="S4.SS3.p1.5" class="ltx_p">where <math id="S4.SS3.p1.3.m1.1" class="ltx_Math" alttext="\bm{m}_{i}^{k}" display="inline"><semantics id="S4.SS3.p1.3.m1.1a"><msubsup id="S4.SS3.p1.3.m1.1.1" xref="S4.SS3.p1.3.m1.1.1.cmml"><mi id="S4.SS3.p1.3.m1.1.1.2.2" xref="S4.SS3.p1.3.m1.1.1.2.2.cmml">𝒎</mi><mi id="S4.SS3.p1.3.m1.1.1.2.3" xref="S4.SS3.p1.3.m1.1.1.2.3.cmml">i</mi><mi id="S4.SS3.p1.3.m1.1.1.3" xref="S4.SS3.p1.3.m1.1.1.3.cmml">k</mi></msubsup><annotation-xml encoding="MathML-Content" id="S4.SS3.p1.3.m1.1b"><apply id="S4.SS3.p1.3.m1.1.1.cmml" xref="S4.SS3.p1.3.m1.1.1"><csymbol cd="ambiguous" id="S4.SS3.p1.3.m1.1.1.1.cmml" xref="S4.SS3.p1.3.m1.1.1">superscript</csymbol><apply id="S4.SS3.p1.3.m1.1.1.2.cmml" xref="S4.SS3.p1.3.m1.1.1"><csymbol cd="ambiguous" id="S4.SS3.p1.3.m1.1.1.2.1.cmml" xref="S4.SS3.p1.3.m1.1.1">subscript</csymbol><ci id="S4.SS3.p1.3.m1.1.1.2.2.cmml" xref="S4.SS3.p1.3.m1.1.1.2.2">𝒎</ci><ci id="S4.SS3.p1.3.m1.1.1.2.3.cmml" xref="S4.SS3.p1.3.m1.1.1.2.3">𝑖</ci></apply><ci id="S4.SS3.p1.3.m1.1.1.3.cmml" xref="S4.SS3.p1.3.m1.1.1.3">𝑘</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p1.3.m1.1c">\bm{m}_{i}^{k}</annotation></semantics></math> and <math id="S4.SS3.p1.4.m2.1" class="ltx_Math" alttext="\bm{h}_{i}^{k}" display="inline"><semantics id="S4.SS3.p1.4.m2.1a"><msubsup id="S4.SS3.p1.4.m2.1.1" xref="S4.SS3.p1.4.m2.1.1.cmml"><mi id="S4.SS3.p1.4.m2.1.1.2.2" xref="S4.SS3.p1.4.m2.1.1.2.2.cmml">𝒉</mi><mi id="S4.SS3.p1.4.m2.1.1.2.3" xref="S4.SS3.p1.4.m2.1.1.2.3.cmml">i</mi><mi id="S4.SS3.p1.4.m2.1.1.3" xref="S4.SS3.p1.4.m2.1.1.3.cmml">k</mi></msubsup><annotation-xml encoding="MathML-Content" id="S4.SS3.p1.4.m2.1b"><apply id="S4.SS3.p1.4.m2.1.1.cmml" xref="S4.SS3.p1.4.m2.1.1"><csymbol cd="ambiguous" id="S4.SS3.p1.4.m2.1.1.1.cmml" xref="S4.SS3.p1.4.m2.1.1">superscript</csymbol><apply id="S4.SS3.p1.4.m2.1.1.2.cmml" xref="S4.SS3.p1.4.m2.1.1"><csymbol cd="ambiguous" id="S4.SS3.p1.4.m2.1.1.2.1.cmml" xref="S4.SS3.p1.4.m2.1.1">subscript</csymbol><ci id="S4.SS3.p1.4.m2.1.1.2.2.cmml" xref="S4.SS3.p1.4.m2.1.1.2.2">𝒉</ci><ci id="S4.SS3.p1.4.m2.1.1.2.3.cmml" xref="S4.SS3.p1.4.m2.1.1.2.3">𝑖</ci></apply><ci id="S4.SS3.p1.4.m2.1.1.3.cmml" xref="S4.SS3.p1.4.m2.1.1.3">𝑘</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p1.4.m2.1c">\bm{h}_{i}^{k}</annotation></semantics></math> are computed according to (<a href="#S4.E9" title="In IV-A Hessian as a Pre-conditioner ‣ IV Proposed Algorithm ‣ Fed-Sophia: A Communication-Efficient Second-Order Federated Learning Algorithm Identify applicable funding agency here. If none, delete this." class="ltx_ref"><span class="ltx_text ltx_ref_tag">9</span></a>) and (<a href="#S4.E10" title="In IV-A Hessian as a Pre-conditioner ‣ IV Proposed Algorithm ‣ Fed-Sophia: A Communication-Efficient Second-Order Federated Learning Algorithm Identify applicable funding agency here. If none, delete this." class="ltx_ref"><span class="ltx_text ltx_ref_tag">10</span></a>), respectively, and <math id="S4.SS3.p1.5.m3.1" class="ltx_Math" alttext="\epsilon" display="inline"><semantics id="S4.SS3.p1.5.m3.1a"><mi id="S4.SS3.p1.5.m3.1.1" xref="S4.SS3.p1.5.m3.1.1.cmml">ϵ</mi><annotation-xml encoding="MathML-Content" id="S4.SS3.p1.5.m3.1b"><ci id="S4.SS3.p1.5.m3.1.1.cmml" xref="S4.SS3.p1.5.m3.1.1">italic-ϵ</ci></annotation-xml><annotation encoding="application/x-tex" id="S4.SS3.p1.5.m3.1c">\epsilon</annotation></semantics></math> is a very small positive constant used to prevent division by zero. Algorithm <a href="#alg1" title="In IV Proposed Algorithm ‣ Fed-Sophia: A Communication-Efficient Second-Order Federated Learning Algorithm Identify applicable funding agency here. If none, delete this." class="ltx_ref"><span class="ltx_text ltx_ref_tag">1</span></a> shows the full details of Fed-Sophia.</p>
</div>
<figure id="S4.F2" class="ltx_figure">
<div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_1">
<figure id="S4.F2.sf1" class="ltx_figure ltx_figure_panel ltx_align_center"><img src="/html/2406.06655/assets/x2.png" id="S4.F2.sf1.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="125" height="93" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span id="S4.F2.sf1.2.1.1" class="ltx_text" style="font-size:90%;">(a)</span> </span><span id="S4.F2.sf1.3.2" class="ltx_text" style="font-size:90%;">CNN-MNIST</span></figcaption>
</figure>
</div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_1">
<figure id="S4.F2.sf2" class="ltx_figure ltx_figure_panel ltx_align_center"><img src="/html/2406.06655/assets/x3.png" id="S4.F2.sf2.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="125" height="93" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span id="S4.F2.sf2.2.1.1" class="ltx_text" style="font-size:90%;">(b)</span> </span><span id="S4.F2.sf2.3.2" class="ltx_text" style="font-size:90%;">CNN-FMNIST</span></figcaption>
</figure>
</div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_1">
<figure id="S4.F2.sf3" class="ltx_figure ltx_figure_panel ltx_align_center"><img src="/html/2406.06655/assets/x4.png" id="S4.F2.sf3.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="126" height="94" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span id="S4.F2.sf3.2.1.1" class="ltx_text" style="font-size:90%;">(c)</span> </span><span id="S4.F2.sf3.3.2" class="ltx_text" style="font-size:90%;">MLP-MNIST</span></figcaption>
</figure>
</div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_1">
<figure id="S4.F2.sf4" class="ltx_figure ltx_figure_panel ltx_align_center"><img src="/html/2406.06655/assets/x5.png" id="S4.F2.sf4.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="125" height="93" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span id="S4.F2.sf4.2.1.1" class="ltx_text" style="font-size:90%;">(d)</span> </span><span id="S4.F2.sf4.3.2" class="ltx_text" style="font-size:90%;">MLP-FMNIST </span></figcaption>
</figure>
</div>
</div>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span id="S4.F2.2.1.1" class="ltx_text" style="font-size:90%;">Figure 2</span>: </span><span id="S4.F2.3.2" class="ltx_text" style="font-size:90%;">Test accuracy for Fed-Sophia against other baselines in terms of communication rounds for MNIST/FMNIST datasets using MLP and CNN models.</span></figcaption>
</figure>
</section>
</section>
<section id="S5" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">V </span><span id="S5.1.1" class="ltx_text ltx_font_smallcaps">Numerical Results</span>
</h2>

<div id="S5.p1" class="ltx_para">
<p id="S5.p1.1" class="ltx_p">In this section, we lay out the details of the experiments along with the results. First, we compare the performance of Fed-Sophia to the other baselines in terms of communication and computation efficiency. Then, we study the effect of the hyperparameters on Fed-Sophia’s performance. Finally, we investigate the energy and carbon footprint of all algorithms.</p>
</div>
<section id="S5.SS1" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection"><span id="S5.SS1.4.1.1" class="ltx_text">V-A</span> </span><span id="S5.SS1.5.2" class="ltx_text ltx_font_italic">Experimental Settings</span>
</h3>

<div id="S5.SS1.p1" class="ltx_para">
<p id="S5.SS1.p1.3" class="ltx_p">We conducted several experiments to compare the performance of Fed-Sophia with two baselines: FedAvg, a first-order method that utilizes only the gradient information, and DONE, an approximate Newton-type method. Two data sets are used: MNIST and Fashion MNIST. The data is distributed among 32 devices, and each partition is split into <math id="S5.SS1.p1.1.m1.1" class="ltx_Math" alttext="75\%" display="inline"><semantics id="S5.SS1.p1.1.m1.1a"><mrow id="S5.SS1.p1.1.m1.1.1" xref="S5.SS1.p1.1.m1.1.1.cmml"><mn id="S5.SS1.p1.1.m1.1.1.2" xref="S5.SS1.p1.1.m1.1.1.2.cmml">75</mn><mo id="S5.SS1.p1.1.m1.1.1.1" xref="S5.SS1.p1.1.m1.1.1.1.cmml">%</mo></mrow><annotation-xml encoding="MathML-Content" id="S5.SS1.p1.1.m1.1b"><apply id="S5.SS1.p1.1.m1.1.1.cmml" xref="S5.SS1.p1.1.m1.1.1"><csymbol cd="latexml" id="S5.SS1.p1.1.m1.1.1.1.cmml" xref="S5.SS1.p1.1.m1.1.1.1">percent</csymbol><cn type="integer" id="S5.SS1.p1.1.m1.1.1.2.cmml" xref="S5.SS1.p1.1.m1.1.1.2">75</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS1.p1.1.m1.1c">75\%</annotation></semantics></math> and <math id="S5.SS1.p1.2.m2.1" class="ltx_Math" alttext="25\%" display="inline"><semantics id="S5.SS1.p1.2.m2.1a"><mrow id="S5.SS1.p1.2.m2.1.1" xref="S5.SS1.p1.2.m2.1.1.cmml"><mn id="S5.SS1.p1.2.m2.1.1.2" xref="S5.SS1.p1.2.m2.1.1.2.cmml">25</mn><mo id="S5.SS1.p1.2.m2.1.1.1" xref="S5.SS1.p1.2.m2.1.1.1.cmml">%</mo></mrow><annotation-xml encoding="MathML-Content" id="S5.SS1.p1.2.m2.1b"><apply id="S5.SS1.p1.2.m2.1.1.cmml" xref="S5.SS1.p1.2.m2.1.1"><csymbol cd="latexml" id="S5.SS1.p1.2.m2.1.1.1.cmml" xref="S5.SS1.p1.2.m2.1.1.1">percent</csymbol><cn type="integer" id="S5.SS1.p1.2.m2.1.1.2.cmml" xref="S5.SS1.p1.2.m2.1.1.2">25</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS1.p1.2.m2.1c">25\%</annotation></semantics></math> for training and testing, respectively. All the experiments are in the non-IID setting. In our experiments, we consider two different classification models, MLP and CNN, with the loss function being cross-entropy in both of them. The number of local iterations for both Fed-Sophia and FedAvg is taken to be <math id="S5.SS1.p1.3.m3.1" class="ltx_Math" alttext="J=10" display="inline"><semantics id="S5.SS1.p1.3.m3.1a"><mrow id="S5.SS1.p1.3.m3.1.1" xref="S5.SS1.p1.3.m3.1.1.cmml"><mi id="S5.SS1.p1.3.m3.1.1.2" xref="S5.SS1.p1.3.m3.1.1.2.cmml">J</mi><mo id="S5.SS1.p1.3.m3.1.1.1" xref="S5.SS1.p1.3.m3.1.1.1.cmml">=</mo><mn id="S5.SS1.p1.3.m3.1.1.3" xref="S5.SS1.p1.3.m3.1.1.3.cmml">10</mn></mrow><annotation-xml encoding="MathML-Content" id="S5.SS1.p1.3.m3.1b"><apply id="S5.SS1.p1.3.m3.1.1.cmml" xref="S5.SS1.p1.3.m3.1.1"><eq id="S5.SS1.p1.3.m3.1.1.1.cmml" xref="S5.SS1.p1.3.m3.1.1.1"></eq><ci id="S5.SS1.p1.3.m3.1.1.2.cmml" xref="S5.SS1.p1.3.m3.1.1.2">𝐽</ci><cn type="integer" id="S5.SS1.p1.3.m3.1.1.3.cmml" xref="S5.SS1.p1.3.m3.1.1.3">10</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS1.p1.3.m3.1c">J=10</annotation></semantics></math>. For DONE, we tune the number of local iterations to maintain a fair comparison.</p>
</div>
<figure id="S5.T1" class="ltx_table">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_table"><span id="S5.T1.4.1.1" class="ltx_text" style="font-size:90%;">TABLE I</span>: </span><span id="S5.T1.5.2" class="ltx_text" style="font-size:90%;">Effect of the learning rate and the number of local iterations on the test accuracy for the Fashion MNIST dataset with CNN.</span></figcaption>
<table id="S5.T1.2.2" class="ltx_tabular ltx_centering ltx_align_middle">
<tbody class="ltx_tbody">
<tr id="S5.T1.2.2.2" class="ltx_tr">
<td id="S5.T1.1.1.1.1" class="ltx_td ltx_align_center ltx_border_l ltx_border_r ltx_border_t"><span id="S5.T1.1.1.1.1.1" class="ltx_text ltx_font_bold">Learning rate (<math id="S5.T1.1.1.1.1.1.m1.1" class="ltx_Math" alttext="\eta" display="inline"><semantics id="S5.T1.1.1.1.1.1.m1.1a"><mi id="S5.T1.1.1.1.1.1.m1.1.1" xref="S5.T1.1.1.1.1.1.m1.1.1.cmml">η</mi><annotation-xml encoding="MathML-Content" id="S5.T1.1.1.1.1.1.m1.1b"><ci id="S5.T1.1.1.1.1.1.m1.1.1.cmml" xref="S5.T1.1.1.1.1.1.m1.1.1">𝜂</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.T1.1.1.1.1.1.m1.1c">\eta</annotation></semantics></math>)</span></td>
<td id="S5.T1.2.2.2.2" class="ltx_td ltx_align_center ltx_border_r ltx_border_tt"><span id="S5.T1.2.2.2.2.1" class="ltx_text ltx_font_bold">Local iterations (<math id="S5.T1.2.2.2.2.1.m1.1" class="ltx_Math" alttext="J" display="inline"><semantics id="S5.T1.2.2.2.2.1.m1.1a"><mi id="S5.T1.2.2.2.2.1.m1.1.1" xref="S5.T1.2.2.2.2.1.m1.1.1.cmml">J</mi><annotation-xml encoding="MathML-Content" id="S5.T1.2.2.2.2.1.m1.1b"><ci id="S5.T1.2.2.2.2.1.m1.1.1.cmml" xref="S5.T1.2.2.2.2.1.m1.1.1">𝐽</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.T1.2.2.2.2.1.m1.1c">J</annotation></semantics></math>)</span></td>
<td id="S5.T1.2.2.2.3" class="ltx_td ltx_align_center ltx_border_r ltx_border_tt"><span id="S5.T1.2.2.2.3.1" class="ltx_text ltx_font_bold">Test accuracy(%)</span></td>
</tr>
<tr id="S5.T1.2.2.3.1" class="ltx_tr">
<td id="S5.T1.2.2.3.1.1" class="ltx_td ltx_align_center ltx_border_l ltx_border_r ltx_border_t">0.01</td>
<td id="S5.T1.2.2.3.1.2" class="ltx_td ltx_border_r ltx_border_t"></td>
<td id="S5.T1.2.2.3.1.3" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">76.3</td>
</tr>
<tr id="S5.T1.2.2.4.2" class="ltx_tr">
<td id="S5.T1.2.2.4.2.1" class="ltx_td ltx_align_center ltx_border_l ltx_border_r">0.003</td>
<td id="S5.T1.2.2.4.2.2" class="ltx_td ltx_align_center ltx_border_r">10</td>
<td id="S5.T1.2.2.4.2.3" class="ltx_td ltx_align_center ltx_border_r">80.3</td>
</tr>
<tr id="S5.T1.2.2.5.3" class="ltx_tr">
<td id="S5.T1.2.2.5.3.1" class="ltx_td ltx_align_center ltx_border_l ltx_border_r">0.0005</td>
<td id="S5.T1.2.2.5.3.2" class="ltx_td ltx_border_r"></td>
<td id="S5.T1.2.2.5.3.3" class="ltx_td ltx_align_center ltx_border_r">71.9</td>
</tr>
<tr id="S5.T1.2.2.6.4" class="ltx_tr">
<td id="S5.T1.2.2.6.4.1" class="ltx_td ltx_border_l ltx_border_r ltx_border_t"></td>
<td id="S5.T1.2.2.6.4.2" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">1</td>
<td id="S5.T1.2.2.6.4.3" class="ltx_td ltx_align_center ltx_border_r ltx_border_t">58.7</td>
</tr>
<tr id="S5.T1.2.2.7.5" class="ltx_tr">
<td id="S5.T1.2.2.7.5.1" class="ltx_td ltx_align_center ltx_border_l ltx_border_r">0.001</td>
<td id="S5.T1.2.2.7.5.2" class="ltx_td ltx_align_center ltx_border_r">5</td>
<td id="S5.T1.2.2.7.5.3" class="ltx_td ltx_align_center ltx_border_r">73.3</td>
</tr>
<tr id="S5.T1.2.2.8.6" class="ltx_tr">
<td id="S5.T1.2.2.8.6.1" class="ltx_td ltx_border_b ltx_border_l ltx_border_r"></td>
<td id="S5.T1.2.2.8.6.2" class="ltx_td ltx_align_center ltx_border_b ltx_border_r">10</td>
<td id="S5.T1.2.2.8.6.3" class="ltx_td ltx_align_center ltx_border_b ltx_border_r">76.5</td>
</tr>
</tbody>
</table>
</figure>
<div id="S5.SS1.p2" class="ltx_para">
<p id="S5.SS1.p2.1" class="ltx_p">To monitor the energy footprint of each device <math id="S5.SS1.p2.1.m1.1" class="ltx_Math" alttext="i" display="inline"><semantics id="S5.SS1.p2.1.m1.1a"><mi id="S5.SS1.p2.1.m1.1.1" xref="S5.SS1.p2.1.m1.1.1.cmml">i</mi><annotation-xml encoding="MathML-Content" id="S5.SS1.p2.1.m1.1b"><ci id="S5.SS1.p2.1.m1.1.1.cmml" xref="S5.SS1.p2.1.m1.1.1">𝑖</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.SS1.p2.1.m1.1c">i</annotation></semantics></math>, both computation and communication costs are computed as follows</p>
<table id="Sx1.EGx13" class="ltx_equationgroup ltx_eqn_align ltx_eqn_table">

<tbody id="S5.E13"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math id="S5.E13.m1.4" class="ltx_Math" alttext="\displaystyle E_{total}(k)=E_{c}(k)+E_{t}(k)," display="inline"><semantics id="S5.E13.m1.4a"><mrow id="S5.E13.m1.4.4.1" xref="S5.E13.m1.4.4.1.1.cmml"><mrow id="S5.E13.m1.4.4.1.1" xref="S5.E13.m1.4.4.1.1.cmml"><mrow id="S5.E13.m1.4.4.1.1.2" xref="S5.E13.m1.4.4.1.1.2.cmml"><msub id="S5.E13.m1.4.4.1.1.2.2" xref="S5.E13.m1.4.4.1.1.2.2.cmml"><mi id="S5.E13.m1.4.4.1.1.2.2.2" xref="S5.E13.m1.4.4.1.1.2.2.2.cmml">E</mi><mrow id="S5.E13.m1.4.4.1.1.2.2.3" xref="S5.E13.m1.4.4.1.1.2.2.3.cmml"><mi id="S5.E13.m1.4.4.1.1.2.2.3.2" xref="S5.E13.m1.4.4.1.1.2.2.3.2.cmml">t</mi><mo lspace="0em" rspace="0em" id="S5.E13.m1.4.4.1.1.2.2.3.1" xref="S5.E13.m1.4.4.1.1.2.2.3.1.cmml">​</mo><mi id="S5.E13.m1.4.4.1.1.2.2.3.3" xref="S5.E13.m1.4.4.1.1.2.2.3.3.cmml">o</mi><mo lspace="0em" rspace="0em" id="S5.E13.m1.4.4.1.1.2.2.3.1a" xref="S5.E13.m1.4.4.1.1.2.2.3.1.cmml">​</mo><mi id="S5.E13.m1.4.4.1.1.2.2.3.4" xref="S5.E13.m1.4.4.1.1.2.2.3.4.cmml">t</mi><mo lspace="0em" rspace="0em" id="S5.E13.m1.4.4.1.1.2.2.3.1b" xref="S5.E13.m1.4.4.1.1.2.2.3.1.cmml">​</mo><mi id="S5.E13.m1.4.4.1.1.2.2.3.5" xref="S5.E13.m1.4.4.1.1.2.2.3.5.cmml">a</mi><mo lspace="0em" rspace="0em" id="S5.E13.m1.4.4.1.1.2.2.3.1c" xref="S5.E13.m1.4.4.1.1.2.2.3.1.cmml">​</mo><mi id="S5.E13.m1.4.4.1.1.2.2.3.6" xref="S5.E13.m1.4.4.1.1.2.2.3.6.cmml">l</mi></mrow></msub><mo lspace="0em" rspace="0em" id="S5.E13.m1.4.4.1.1.2.1" xref="S5.E13.m1.4.4.1.1.2.1.cmml">​</mo><mrow id="S5.E13.m1.4.4.1.1.2.3.2" xref="S5.E13.m1.4.4.1.1.2.cmml"><mo stretchy="false" id="S5.E13.m1.4.4.1.1.2.3.2.1" xref="S5.E13.m1.4.4.1.1.2.cmml">(</mo><mi id="S5.E13.m1.1.1" xref="S5.E13.m1.1.1.cmml">k</mi><mo stretchy="false" id="S5.E13.m1.4.4.1.1.2.3.2.2" xref="S5.E13.m1.4.4.1.1.2.cmml">)</mo></mrow></mrow><mo id="S5.E13.m1.4.4.1.1.1" xref="S5.E13.m1.4.4.1.1.1.cmml">=</mo><mrow id="S5.E13.m1.4.4.1.1.3" xref="S5.E13.m1.4.4.1.1.3.cmml"><mrow id="S5.E13.m1.4.4.1.1.3.2" xref="S5.E13.m1.4.4.1.1.3.2.cmml"><msub id="S5.E13.m1.4.4.1.1.3.2.2" xref="S5.E13.m1.4.4.1.1.3.2.2.cmml"><mi id="S5.E13.m1.4.4.1.1.3.2.2.2" xref="S5.E13.m1.4.4.1.1.3.2.2.2.cmml">E</mi><mi id="S5.E13.m1.4.4.1.1.3.2.2.3" xref="S5.E13.m1.4.4.1.1.3.2.2.3.cmml">c</mi></msub><mo lspace="0em" rspace="0em" id="S5.E13.m1.4.4.1.1.3.2.1" xref="S5.E13.m1.4.4.1.1.3.2.1.cmml">​</mo><mrow id="S5.E13.m1.4.4.1.1.3.2.3.2" xref="S5.E13.m1.4.4.1.1.3.2.cmml"><mo stretchy="false" id="S5.E13.m1.4.4.1.1.3.2.3.2.1" xref="S5.E13.m1.4.4.1.1.3.2.cmml">(</mo><mi id="S5.E13.m1.2.2" xref="S5.E13.m1.2.2.cmml">k</mi><mo stretchy="false" id="S5.E13.m1.4.4.1.1.3.2.3.2.2" xref="S5.E13.m1.4.4.1.1.3.2.cmml">)</mo></mrow></mrow><mo id="S5.E13.m1.4.4.1.1.3.1" xref="S5.E13.m1.4.4.1.1.3.1.cmml">+</mo><mrow id="S5.E13.m1.4.4.1.1.3.3" xref="S5.E13.m1.4.4.1.1.3.3.cmml"><msub id="S5.E13.m1.4.4.1.1.3.3.2" xref="S5.E13.m1.4.4.1.1.3.3.2.cmml"><mi id="S5.E13.m1.4.4.1.1.3.3.2.2" xref="S5.E13.m1.4.4.1.1.3.3.2.2.cmml">E</mi><mi id="S5.E13.m1.4.4.1.1.3.3.2.3" xref="S5.E13.m1.4.4.1.1.3.3.2.3.cmml">t</mi></msub><mo lspace="0em" rspace="0em" id="S5.E13.m1.4.4.1.1.3.3.1" xref="S5.E13.m1.4.4.1.1.3.3.1.cmml">​</mo><mrow id="S5.E13.m1.4.4.1.1.3.3.3.2" xref="S5.E13.m1.4.4.1.1.3.3.cmml"><mo stretchy="false" id="S5.E13.m1.4.4.1.1.3.3.3.2.1" xref="S5.E13.m1.4.4.1.1.3.3.cmml">(</mo><mi id="S5.E13.m1.3.3" xref="S5.E13.m1.3.3.cmml">k</mi><mo stretchy="false" id="S5.E13.m1.4.4.1.1.3.3.3.2.2" xref="S5.E13.m1.4.4.1.1.3.3.cmml">)</mo></mrow></mrow></mrow></mrow><mo id="S5.E13.m1.4.4.1.2" xref="S5.E13.m1.4.4.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S5.E13.m1.4b"><apply id="S5.E13.m1.4.4.1.1.cmml" xref="S5.E13.m1.4.4.1"><eq id="S5.E13.m1.4.4.1.1.1.cmml" xref="S5.E13.m1.4.4.1.1.1"></eq><apply id="S5.E13.m1.4.4.1.1.2.cmml" xref="S5.E13.m1.4.4.1.1.2"><times id="S5.E13.m1.4.4.1.1.2.1.cmml" xref="S5.E13.m1.4.4.1.1.2.1"></times><apply id="S5.E13.m1.4.4.1.1.2.2.cmml" xref="S5.E13.m1.4.4.1.1.2.2"><csymbol cd="ambiguous" id="S5.E13.m1.4.4.1.1.2.2.1.cmml" xref="S5.E13.m1.4.4.1.1.2.2">subscript</csymbol><ci id="S5.E13.m1.4.4.1.1.2.2.2.cmml" xref="S5.E13.m1.4.4.1.1.2.2.2">𝐸</ci><apply id="S5.E13.m1.4.4.1.1.2.2.3.cmml" xref="S5.E13.m1.4.4.1.1.2.2.3"><times id="S5.E13.m1.4.4.1.1.2.2.3.1.cmml" xref="S5.E13.m1.4.4.1.1.2.2.3.1"></times><ci id="S5.E13.m1.4.4.1.1.2.2.3.2.cmml" xref="S5.E13.m1.4.4.1.1.2.2.3.2">𝑡</ci><ci id="S5.E13.m1.4.4.1.1.2.2.3.3.cmml" xref="S5.E13.m1.4.4.1.1.2.2.3.3">𝑜</ci><ci id="S5.E13.m1.4.4.1.1.2.2.3.4.cmml" xref="S5.E13.m1.4.4.1.1.2.2.3.4">𝑡</ci><ci id="S5.E13.m1.4.4.1.1.2.2.3.5.cmml" xref="S5.E13.m1.4.4.1.1.2.2.3.5">𝑎</ci><ci id="S5.E13.m1.4.4.1.1.2.2.3.6.cmml" xref="S5.E13.m1.4.4.1.1.2.2.3.6">𝑙</ci></apply></apply><ci id="S5.E13.m1.1.1.cmml" xref="S5.E13.m1.1.1">𝑘</ci></apply><apply id="S5.E13.m1.4.4.1.1.3.cmml" xref="S5.E13.m1.4.4.1.1.3"><plus id="S5.E13.m1.4.4.1.1.3.1.cmml" xref="S5.E13.m1.4.4.1.1.3.1"></plus><apply id="S5.E13.m1.4.4.1.1.3.2.cmml" xref="S5.E13.m1.4.4.1.1.3.2"><times id="S5.E13.m1.4.4.1.1.3.2.1.cmml" xref="S5.E13.m1.4.4.1.1.3.2.1"></times><apply id="S5.E13.m1.4.4.1.1.3.2.2.cmml" xref="S5.E13.m1.4.4.1.1.3.2.2"><csymbol cd="ambiguous" id="S5.E13.m1.4.4.1.1.3.2.2.1.cmml" xref="S5.E13.m1.4.4.1.1.3.2.2">subscript</csymbol><ci id="S5.E13.m1.4.4.1.1.3.2.2.2.cmml" xref="S5.E13.m1.4.4.1.1.3.2.2.2">𝐸</ci><ci id="S5.E13.m1.4.4.1.1.3.2.2.3.cmml" xref="S5.E13.m1.4.4.1.1.3.2.2.3">𝑐</ci></apply><ci id="S5.E13.m1.2.2.cmml" xref="S5.E13.m1.2.2">𝑘</ci></apply><apply id="S5.E13.m1.4.4.1.1.3.3.cmml" xref="S5.E13.m1.4.4.1.1.3.3"><times id="S5.E13.m1.4.4.1.1.3.3.1.cmml" xref="S5.E13.m1.4.4.1.1.3.3.1"></times><apply id="S5.E13.m1.4.4.1.1.3.3.2.cmml" xref="S5.E13.m1.4.4.1.1.3.3.2"><csymbol cd="ambiguous" id="S5.E13.m1.4.4.1.1.3.3.2.1.cmml" xref="S5.E13.m1.4.4.1.1.3.3.2">subscript</csymbol><ci id="S5.E13.m1.4.4.1.1.3.3.2.2.cmml" xref="S5.E13.m1.4.4.1.1.3.3.2.2">𝐸</ci><ci id="S5.E13.m1.4.4.1.1.3.3.2.3.cmml" xref="S5.E13.m1.4.4.1.1.3.3.2.3">𝑡</ci></apply><ci id="S5.E13.m1.3.3.cmml" xref="S5.E13.m1.3.3">𝑘</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.E13.m1.4c">\displaystyle E_{total}(k)=E_{c}(k)+E_{t}(k),</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(13)</span></td>
</tr></tbody>
</table>
<p id="S5.SS1.p2.19" class="ltx_p">with</p>
<table id="Sx1.EGx14" class="ltx_equationgroup ltx_eqn_align ltx_eqn_table">

<tbody id="S5.E14"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math id="S5.E14.m1.7" class="ltx_Math" alttext="\displaystyle E_{c}(k)=\sum_{n=1}^{k}\sum_{j=1}^{J}e_{i}^{j,n}\hskip 2.84544pt\text{and}\hskip 2.84544ptE_{t}(k)=\sum_{n=1}^{k}b(\bm{\theta}_{i}^{k})e_{i,PS}^{k}," display="inline"><semantics id="S5.E14.m1.7a"><mrow id="S5.E14.m1.7.7.1" xref="S5.E14.m1.7.7.1.1.cmml"><mrow id="S5.E14.m1.7.7.1.1" xref="S5.E14.m1.7.7.1.1.cmml"><mrow id="S5.E14.m1.7.7.1.1.3" xref="S5.E14.m1.7.7.1.1.3.cmml"><msub id="S5.E14.m1.7.7.1.1.3.2" xref="S5.E14.m1.7.7.1.1.3.2.cmml"><mi id="S5.E14.m1.7.7.1.1.3.2.2" xref="S5.E14.m1.7.7.1.1.3.2.2.cmml">E</mi><mi id="S5.E14.m1.7.7.1.1.3.2.3" xref="S5.E14.m1.7.7.1.1.3.2.3.cmml">c</mi></msub><mo lspace="0em" rspace="0em" id="S5.E14.m1.7.7.1.1.3.1" xref="S5.E14.m1.7.7.1.1.3.1.cmml">​</mo><mrow id="S5.E14.m1.7.7.1.1.3.3.2" xref="S5.E14.m1.7.7.1.1.3.cmml"><mo stretchy="false" id="S5.E14.m1.7.7.1.1.3.3.2.1" xref="S5.E14.m1.7.7.1.1.3.cmml">(</mo><mi id="S5.E14.m1.5.5" xref="S5.E14.m1.5.5.cmml">k</mi><mo stretchy="false" id="S5.E14.m1.7.7.1.1.3.3.2.2" xref="S5.E14.m1.7.7.1.1.3.cmml">)</mo></mrow></mrow><mo id="S5.E14.m1.7.7.1.1.4" xref="S5.E14.m1.7.7.1.1.4.cmml">=</mo><mrow id="S5.E14.m1.7.7.1.1.5" xref="S5.E14.m1.7.7.1.1.5.cmml"><mstyle displaystyle="true" id="S5.E14.m1.7.7.1.1.5.1" xref="S5.E14.m1.7.7.1.1.5.1.cmml"><munderover id="S5.E14.m1.7.7.1.1.5.1a" xref="S5.E14.m1.7.7.1.1.5.1.cmml"><mo movablelimits="false" id="S5.E14.m1.7.7.1.1.5.1.2.2" xref="S5.E14.m1.7.7.1.1.5.1.2.2.cmml">∑</mo><mrow id="S5.E14.m1.7.7.1.1.5.1.2.3" xref="S5.E14.m1.7.7.1.1.5.1.2.3.cmml"><mi id="S5.E14.m1.7.7.1.1.5.1.2.3.2" xref="S5.E14.m1.7.7.1.1.5.1.2.3.2.cmml">n</mi><mo id="S5.E14.m1.7.7.1.1.5.1.2.3.1" xref="S5.E14.m1.7.7.1.1.5.1.2.3.1.cmml">=</mo><mn id="S5.E14.m1.7.7.1.1.5.1.2.3.3" xref="S5.E14.m1.7.7.1.1.5.1.2.3.3.cmml">1</mn></mrow><mi id="S5.E14.m1.7.7.1.1.5.1.3" xref="S5.E14.m1.7.7.1.1.5.1.3.cmml">k</mi></munderover></mstyle><mrow id="S5.E14.m1.7.7.1.1.5.2" xref="S5.E14.m1.7.7.1.1.5.2.cmml"><mstyle displaystyle="true" id="S5.E14.m1.7.7.1.1.5.2.1" xref="S5.E14.m1.7.7.1.1.5.2.1.cmml"><munderover id="S5.E14.m1.7.7.1.1.5.2.1a" xref="S5.E14.m1.7.7.1.1.5.2.1.cmml"><mo movablelimits="false" id="S5.E14.m1.7.7.1.1.5.2.1.2.2" xref="S5.E14.m1.7.7.1.1.5.2.1.2.2.cmml">∑</mo><mrow id="S5.E14.m1.7.7.1.1.5.2.1.2.3" xref="S5.E14.m1.7.7.1.1.5.2.1.2.3.cmml"><mi id="S5.E14.m1.7.7.1.1.5.2.1.2.3.2" xref="S5.E14.m1.7.7.1.1.5.2.1.2.3.2.cmml">j</mi><mo id="S5.E14.m1.7.7.1.1.5.2.1.2.3.1" xref="S5.E14.m1.7.7.1.1.5.2.1.2.3.1.cmml">=</mo><mn id="S5.E14.m1.7.7.1.1.5.2.1.2.3.3" xref="S5.E14.m1.7.7.1.1.5.2.1.2.3.3.cmml">1</mn></mrow><mi id="S5.E14.m1.7.7.1.1.5.2.1.3" xref="S5.E14.m1.7.7.1.1.5.2.1.3.cmml">J</mi></munderover></mstyle><mrow id="S5.E14.m1.7.7.1.1.5.2.2" xref="S5.E14.m1.7.7.1.1.5.2.2.cmml"><msubsup id="S5.E14.m1.7.7.1.1.5.2.2.2" xref="S5.E14.m1.7.7.1.1.5.2.2.2.cmml"><mi id="S5.E14.m1.7.7.1.1.5.2.2.2.2.2" xref="S5.E14.m1.7.7.1.1.5.2.2.2.2.2.cmml">e</mi><mi id="S5.E14.m1.7.7.1.1.5.2.2.2.2.3" xref="S5.E14.m1.7.7.1.1.5.2.2.2.2.3.cmml">i</mi><mrow id="S5.E14.m1.2.2.2.4" xref="S5.E14.m1.2.2.2.3.cmml"><mi id="S5.E14.m1.1.1.1.1" xref="S5.E14.m1.1.1.1.1.cmml">j</mi><mo id="S5.E14.m1.2.2.2.4.1" xref="S5.E14.m1.2.2.2.3.cmml">,</mo><mi id="S5.E14.m1.2.2.2.2" xref="S5.E14.m1.2.2.2.2.cmml">n</mi></mrow></msubsup><mo lspace="0em" rspace="0em" id="S5.E14.m1.7.7.1.1.5.2.2.1" xref="S5.E14.m1.7.7.1.1.5.2.2.1.cmml">​</mo><mtext id="S5.E14.m1.7.7.1.1.5.2.2.3" xref="S5.E14.m1.7.7.1.1.5.2.2.3a.cmml">and</mtext><mo lspace="0.280em" rspace="0em" id="S5.E14.m1.7.7.1.1.5.2.2.1a" xref="S5.E14.m1.7.7.1.1.5.2.2.1.cmml">​</mo><msub id="S5.E14.m1.7.7.1.1.5.2.2.4" xref="S5.E14.m1.7.7.1.1.5.2.2.4.cmml"><mi id="S5.E14.m1.7.7.1.1.5.2.2.4.2" xref="S5.E14.m1.7.7.1.1.5.2.2.4.2.cmml">E</mi><mi id="S5.E14.m1.7.7.1.1.5.2.2.4.3" xref="S5.E14.m1.7.7.1.1.5.2.2.4.3.cmml">t</mi></msub><mo lspace="0em" rspace="0em" id="S5.E14.m1.7.7.1.1.5.2.2.1b" xref="S5.E14.m1.7.7.1.1.5.2.2.1.cmml">​</mo><mrow id="S5.E14.m1.7.7.1.1.5.2.2.5.2" xref="S5.E14.m1.7.7.1.1.5.2.2.cmml"><mo stretchy="false" id="S5.E14.m1.7.7.1.1.5.2.2.5.2.1" xref="S5.E14.m1.7.7.1.1.5.2.2.cmml">(</mo><mi id="S5.E14.m1.6.6" xref="S5.E14.m1.6.6.cmml">k</mi><mo stretchy="false" id="S5.E14.m1.7.7.1.1.5.2.2.5.2.2" xref="S5.E14.m1.7.7.1.1.5.2.2.cmml">)</mo></mrow></mrow></mrow></mrow><mo id="S5.E14.m1.7.7.1.1.6" xref="S5.E14.m1.7.7.1.1.6.cmml">=</mo><mrow id="S5.E14.m1.7.7.1.1.1" xref="S5.E14.m1.7.7.1.1.1.cmml"><mstyle displaystyle="true" id="S5.E14.m1.7.7.1.1.1.2" xref="S5.E14.m1.7.7.1.1.1.2.cmml"><munderover id="S5.E14.m1.7.7.1.1.1.2a" xref="S5.E14.m1.7.7.1.1.1.2.cmml"><mo movablelimits="false" id="S5.E14.m1.7.7.1.1.1.2.2.2" xref="S5.E14.m1.7.7.1.1.1.2.2.2.cmml">∑</mo><mrow id="S5.E14.m1.7.7.1.1.1.2.2.3" xref="S5.E14.m1.7.7.1.1.1.2.2.3.cmml"><mi id="S5.E14.m1.7.7.1.1.1.2.2.3.2" xref="S5.E14.m1.7.7.1.1.1.2.2.3.2.cmml">n</mi><mo id="S5.E14.m1.7.7.1.1.1.2.2.3.1" xref="S5.E14.m1.7.7.1.1.1.2.2.3.1.cmml">=</mo><mn id="S5.E14.m1.7.7.1.1.1.2.2.3.3" xref="S5.E14.m1.7.7.1.1.1.2.2.3.3.cmml">1</mn></mrow><mi id="S5.E14.m1.7.7.1.1.1.2.3" xref="S5.E14.m1.7.7.1.1.1.2.3.cmml">k</mi></munderover></mstyle><mrow id="S5.E14.m1.7.7.1.1.1.1" xref="S5.E14.m1.7.7.1.1.1.1.cmml"><mi id="S5.E14.m1.7.7.1.1.1.1.3" xref="S5.E14.m1.7.7.1.1.1.1.3.cmml">b</mi><mo lspace="0em" rspace="0em" id="S5.E14.m1.7.7.1.1.1.1.2" xref="S5.E14.m1.7.7.1.1.1.1.2.cmml">​</mo><mrow id="S5.E14.m1.7.7.1.1.1.1.1.1" xref="S5.E14.m1.7.7.1.1.1.1.1.1.1.cmml"><mo stretchy="false" id="S5.E14.m1.7.7.1.1.1.1.1.1.2" xref="S5.E14.m1.7.7.1.1.1.1.1.1.1.cmml">(</mo><msubsup id="S5.E14.m1.7.7.1.1.1.1.1.1.1" xref="S5.E14.m1.7.7.1.1.1.1.1.1.1.cmml"><mi id="S5.E14.m1.7.7.1.1.1.1.1.1.1.2.2" xref="S5.E14.m1.7.7.1.1.1.1.1.1.1.2.2.cmml">𝜽</mi><mi id="S5.E14.m1.7.7.1.1.1.1.1.1.1.2.3" xref="S5.E14.m1.7.7.1.1.1.1.1.1.1.2.3.cmml">i</mi><mi id="S5.E14.m1.7.7.1.1.1.1.1.1.1.3" xref="S5.E14.m1.7.7.1.1.1.1.1.1.1.3.cmml">k</mi></msubsup><mo stretchy="false" id="S5.E14.m1.7.7.1.1.1.1.1.1.3" xref="S5.E14.m1.7.7.1.1.1.1.1.1.1.cmml">)</mo></mrow><mo lspace="0em" rspace="0em" id="S5.E14.m1.7.7.1.1.1.1.2a" xref="S5.E14.m1.7.7.1.1.1.1.2.cmml">​</mo><msubsup id="S5.E14.m1.7.7.1.1.1.1.4" xref="S5.E14.m1.7.7.1.1.1.1.4.cmml"><mi id="S5.E14.m1.7.7.1.1.1.1.4.2.2" xref="S5.E14.m1.7.7.1.1.1.1.4.2.2.cmml">e</mi><mrow id="S5.E14.m1.4.4.2.2" xref="S5.E14.m1.4.4.2.3.cmml"><mi id="S5.E14.m1.3.3.1.1" xref="S5.E14.m1.3.3.1.1.cmml">i</mi><mo id="S5.E14.m1.4.4.2.2.2" xref="S5.E14.m1.4.4.2.3.cmml">,</mo><mrow id="S5.E14.m1.4.4.2.2.1" xref="S5.E14.m1.4.4.2.2.1.cmml"><mi id="S5.E14.m1.4.4.2.2.1.2" xref="S5.E14.m1.4.4.2.2.1.2.cmml">P</mi><mo lspace="0em" rspace="0em" id="S5.E14.m1.4.4.2.2.1.1" xref="S5.E14.m1.4.4.2.2.1.1.cmml">​</mo><mi id="S5.E14.m1.4.4.2.2.1.3" xref="S5.E14.m1.4.4.2.2.1.3.cmml">S</mi></mrow></mrow><mi id="S5.E14.m1.7.7.1.1.1.1.4.3" xref="S5.E14.m1.7.7.1.1.1.1.4.3.cmml">k</mi></msubsup></mrow></mrow></mrow><mo id="S5.E14.m1.7.7.1.2" xref="S5.E14.m1.7.7.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S5.E14.m1.7b"><apply id="S5.E14.m1.7.7.1.1.cmml" xref="S5.E14.m1.7.7.1"><and id="S5.E14.m1.7.7.1.1a.cmml" xref="S5.E14.m1.7.7.1"></and><apply id="S5.E14.m1.7.7.1.1b.cmml" xref="S5.E14.m1.7.7.1"><eq id="S5.E14.m1.7.7.1.1.4.cmml" xref="S5.E14.m1.7.7.1.1.4"></eq><apply id="S5.E14.m1.7.7.1.1.3.cmml" xref="S5.E14.m1.7.7.1.1.3"><times id="S5.E14.m1.7.7.1.1.3.1.cmml" xref="S5.E14.m1.7.7.1.1.3.1"></times><apply id="S5.E14.m1.7.7.1.1.3.2.cmml" xref="S5.E14.m1.7.7.1.1.3.2"><csymbol cd="ambiguous" id="S5.E14.m1.7.7.1.1.3.2.1.cmml" xref="S5.E14.m1.7.7.1.1.3.2">subscript</csymbol><ci id="S5.E14.m1.7.7.1.1.3.2.2.cmml" xref="S5.E14.m1.7.7.1.1.3.2.2">𝐸</ci><ci id="S5.E14.m1.7.7.1.1.3.2.3.cmml" xref="S5.E14.m1.7.7.1.1.3.2.3">𝑐</ci></apply><ci id="S5.E14.m1.5.5.cmml" xref="S5.E14.m1.5.5">𝑘</ci></apply><apply id="S5.E14.m1.7.7.1.1.5.cmml" xref="S5.E14.m1.7.7.1.1.5"><apply id="S5.E14.m1.7.7.1.1.5.1.cmml" xref="S5.E14.m1.7.7.1.1.5.1"><csymbol cd="ambiguous" id="S5.E14.m1.7.7.1.1.5.1.1.cmml" xref="S5.E14.m1.7.7.1.1.5.1">superscript</csymbol><apply id="S5.E14.m1.7.7.1.1.5.1.2.cmml" xref="S5.E14.m1.7.7.1.1.5.1"><csymbol cd="ambiguous" id="S5.E14.m1.7.7.1.1.5.1.2.1.cmml" xref="S5.E14.m1.7.7.1.1.5.1">subscript</csymbol><sum id="S5.E14.m1.7.7.1.1.5.1.2.2.cmml" xref="S5.E14.m1.7.7.1.1.5.1.2.2"></sum><apply id="S5.E14.m1.7.7.1.1.5.1.2.3.cmml" xref="S5.E14.m1.7.7.1.1.5.1.2.3"><eq id="S5.E14.m1.7.7.1.1.5.1.2.3.1.cmml" xref="S5.E14.m1.7.7.1.1.5.1.2.3.1"></eq><ci id="S5.E14.m1.7.7.1.1.5.1.2.3.2.cmml" xref="S5.E14.m1.7.7.1.1.5.1.2.3.2">𝑛</ci><cn type="integer" id="S5.E14.m1.7.7.1.1.5.1.2.3.3.cmml" xref="S5.E14.m1.7.7.1.1.5.1.2.3.3">1</cn></apply></apply><ci id="S5.E14.m1.7.7.1.1.5.1.3.cmml" xref="S5.E14.m1.7.7.1.1.5.1.3">𝑘</ci></apply><apply id="S5.E14.m1.7.7.1.1.5.2.cmml" xref="S5.E14.m1.7.7.1.1.5.2"><apply id="S5.E14.m1.7.7.1.1.5.2.1.cmml" xref="S5.E14.m1.7.7.1.1.5.2.1"><csymbol cd="ambiguous" id="S5.E14.m1.7.7.1.1.5.2.1.1.cmml" xref="S5.E14.m1.7.7.1.1.5.2.1">superscript</csymbol><apply id="S5.E14.m1.7.7.1.1.5.2.1.2.cmml" xref="S5.E14.m1.7.7.1.1.5.2.1"><csymbol cd="ambiguous" id="S5.E14.m1.7.7.1.1.5.2.1.2.1.cmml" xref="S5.E14.m1.7.7.1.1.5.2.1">subscript</csymbol><sum id="S5.E14.m1.7.7.1.1.5.2.1.2.2.cmml" xref="S5.E14.m1.7.7.1.1.5.2.1.2.2"></sum><apply id="S5.E14.m1.7.7.1.1.5.2.1.2.3.cmml" xref="S5.E14.m1.7.7.1.1.5.2.1.2.3"><eq id="S5.E14.m1.7.7.1.1.5.2.1.2.3.1.cmml" xref="S5.E14.m1.7.7.1.1.5.2.1.2.3.1"></eq><ci id="S5.E14.m1.7.7.1.1.5.2.1.2.3.2.cmml" xref="S5.E14.m1.7.7.1.1.5.2.1.2.3.2">𝑗</ci><cn type="integer" id="S5.E14.m1.7.7.1.1.5.2.1.2.3.3.cmml" xref="S5.E14.m1.7.7.1.1.5.2.1.2.3.3">1</cn></apply></apply><ci id="S5.E14.m1.7.7.1.1.5.2.1.3.cmml" xref="S5.E14.m1.7.7.1.1.5.2.1.3">𝐽</ci></apply><apply id="S5.E14.m1.7.7.1.1.5.2.2.cmml" xref="S5.E14.m1.7.7.1.1.5.2.2"><times id="S5.E14.m1.7.7.1.1.5.2.2.1.cmml" xref="S5.E14.m1.7.7.1.1.5.2.2.1"></times><apply id="S5.E14.m1.7.7.1.1.5.2.2.2.cmml" xref="S5.E14.m1.7.7.1.1.5.2.2.2"><csymbol cd="ambiguous" id="S5.E14.m1.7.7.1.1.5.2.2.2.1.cmml" xref="S5.E14.m1.7.7.1.1.5.2.2.2">superscript</csymbol><apply id="S5.E14.m1.7.7.1.1.5.2.2.2.2.cmml" xref="S5.E14.m1.7.7.1.1.5.2.2.2"><csymbol cd="ambiguous" id="S5.E14.m1.7.7.1.1.5.2.2.2.2.1.cmml" xref="S5.E14.m1.7.7.1.1.5.2.2.2">subscript</csymbol><ci id="S5.E14.m1.7.7.1.1.5.2.2.2.2.2.cmml" xref="S5.E14.m1.7.7.1.1.5.2.2.2.2.2">𝑒</ci><ci id="S5.E14.m1.7.7.1.1.5.2.2.2.2.3.cmml" xref="S5.E14.m1.7.7.1.1.5.2.2.2.2.3">𝑖</ci></apply><list id="S5.E14.m1.2.2.2.3.cmml" xref="S5.E14.m1.2.2.2.4"><ci id="S5.E14.m1.1.1.1.1.cmml" xref="S5.E14.m1.1.1.1.1">𝑗</ci><ci id="S5.E14.m1.2.2.2.2.cmml" xref="S5.E14.m1.2.2.2.2">𝑛</ci></list></apply><ci id="S5.E14.m1.7.7.1.1.5.2.2.3a.cmml" xref="S5.E14.m1.7.7.1.1.5.2.2.3"><mtext id="S5.E14.m1.7.7.1.1.5.2.2.3.cmml" xref="S5.E14.m1.7.7.1.1.5.2.2.3">and</mtext></ci><apply id="S5.E14.m1.7.7.1.1.5.2.2.4.cmml" xref="S5.E14.m1.7.7.1.1.5.2.2.4"><csymbol cd="ambiguous" id="S5.E14.m1.7.7.1.1.5.2.2.4.1.cmml" xref="S5.E14.m1.7.7.1.1.5.2.2.4">subscript</csymbol><ci id="S5.E14.m1.7.7.1.1.5.2.2.4.2.cmml" xref="S5.E14.m1.7.7.1.1.5.2.2.4.2">𝐸</ci><ci id="S5.E14.m1.7.7.1.1.5.2.2.4.3.cmml" xref="S5.E14.m1.7.7.1.1.5.2.2.4.3">𝑡</ci></apply><ci id="S5.E14.m1.6.6.cmml" xref="S5.E14.m1.6.6">𝑘</ci></apply></apply></apply></apply><apply id="S5.E14.m1.7.7.1.1c.cmml" xref="S5.E14.m1.7.7.1"><eq id="S5.E14.m1.7.7.1.1.6.cmml" xref="S5.E14.m1.7.7.1.1.6"></eq><share href="#S5.E14.m1.7.7.1.1.5.cmml" id="S5.E14.m1.7.7.1.1d.cmml" xref="S5.E14.m1.7.7.1"></share><apply id="S5.E14.m1.7.7.1.1.1.cmml" xref="S5.E14.m1.7.7.1.1.1"><apply id="S5.E14.m1.7.7.1.1.1.2.cmml" xref="S5.E14.m1.7.7.1.1.1.2"><csymbol cd="ambiguous" id="S5.E14.m1.7.7.1.1.1.2.1.cmml" xref="S5.E14.m1.7.7.1.1.1.2">superscript</csymbol><apply id="S5.E14.m1.7.7.1.1.1.2.2.cmml" xref="S5.E14.m1.7.7.1.1.1.2"><csymbol cd="ambiguous" id="S5.E14.m1.7.7.1.1.1.2.2.1.cmml" xref="S5.E14.m1.7.7.1.1.1.2">subscript</csymbol><sum id="S5.E14.m1.7.7.1.1.1.2.2.2.cmml" xref="S5.E14.m1.7.7.1.1.1.2.2.2"></sum><apply id="S5.E14.m1.7.7.1.1.1.2.2.3.cmml" xref="S5.E14.m1.7.7.1.1.1.2.2.3"><eq id="S5.E14.m1.7.7.1.1.1.2.2.3.1.cmml" xref="S5.E14.m1.7.7.1.1.1.2.2.3.1"></eq><ci id="S5.E14.m1.7.7.1.1.1.2.2.3.2.cmml" xref="S5.E14.m1.7.7.1.1.1.2.2.3.2">𝑛</ci><cn type="integer" id="S5.E14.m1.7.7.1.1.1.2.2.3.3.cmml" xref="S5.E14.m1.7.7.1.1.1.2.2.3.3">1</cn></apply></apply><ci id="S5.E14.m1.7.7.1.1.1.2.3.cmml" xref="S5.E14.m1.7.7.1.1.1.2.3">𝑘</ci></apply><apply id="S5.E14.m1.7.7.1.1.1.1.cmml" xref="S5.E14.m1.7.7.1.1.1.1"><times id="S5.E14.m1.7.7.1.1.1.1.2.cmml" xref="S5.E14.m1.7.7.1.1.1.1.2"></times><ci id="S5.E14.m1.7.7.1.1.1.1.3.cmml" xref="S5.E14.m1.7.7.1.1.1.1.3">𝑏</ci><apply id="S5.E14.m1.7.7.1.1.1.1.1.1.1.cmml" xref="S5.E14.m1.7.7.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S5.E14.m1.7.7.1.1.1.1.1.1.1.1.cmml" xref="S5.E14.m1.7.7.1.1.1.1.1.1">superscript</csymbol><apply id="S5.E14.m1.7.7.1.1.1.1.1.1.1.2.cmml" xref="S5.E14.m1.7.7.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S5.E14.m1.7.7.1.1.1.1.1.1.1.2.1.cmml" xref="S5.E14.m1.7.7.1.1.1.1.1.1">subscript</csymbol><ci id="S5.E14.m1.7.7.1.1.1.1.1.1.1.2.2.cmml" xref="S5.E14.m1.7.7.1.1.1.1.1.1.1.2.2">𝜽</ci><ci id="S5.E14.m1.7.7.1.1.1.1.1.1.1.2.3.cmml" xref="S5.E14.m1.7.7.1.1.1.1.1.1.1.2.3">𝑖</ci></apply><ci id="S5.E14.m1.7.7.1.1.1.1.1.1.1.3.cmml" xref="S5.E14.m1.7.7.1.1.1.1.1.1.1.3">𝑘</ci></apply><apply id="S5.E14.m1.7.7.1.1.1.1.4.cmml" xref="S5.E14.m1.7.7.1.1.1.1.4"><csymbol cd="ambiguous" id="S5.E14.m1.7.7.1.1.1.1.4.1.cmml" xref="S5.E14.m1.7.7.1.1.1.1.4">superscript</csymbol><apply id="S5.E14.m1.7.7.1.1.1.1.4.2.cmml" xref="S5.E14.m1.7.7.1.1.1.1.4"><csymbol cd="ambiguous" id="S5.E14.m1.7.7.1.1.1.1.4.2.1.cmml" xref="S5.E14.m1.7.7.1.1.1.1.4">subscript</csymbol><ci id="S5.E14.m1.7.7.1.1.1.1.4.2.2.cmml" xref="S5.E14.m1.7.7.1.1.1.1.4.2.2">𝑒</ci><list id="S5.E14.m1.4.4.2.3.cmml" xref="S5.E14.m1.4.4.2.2"><ci id="S5.E14.m1.3.3.1.1.cmml" xref="S5.E14.m1.3.3.1.1">𝑖</ci><apply id="S5.E14.m1.4.4.2.2.1.cmml" xref="S5.E14.m1.4.4.2.2.1"><times id="S5.E14.m1.4.4.2.2.1.1.cmml" xref="S5.E14.m1.4.4.2.2.1.1"></times><ci id="S5.E14.m1.4.4.2.2.1.2.cmml" xref="S5.E14.m1.4.4.2.2.1.2">𝑃</ci><ci id="S5.E14.m1.4.4.2.2.1.3.cmml" xref="S5.E14.m1.4.4.2.2.1.3">𝑆</ci></apply></list></apply><ci id="S5.E14.m1.7.7.1.1.1.1.4.3.cmml" xref="S5.E14.m1.7.7.1.1.1.1.4.3">𝑘</ci></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.E14.m1.7c">\displaystyle E_{c}(k)=\sum_{n=1}^{k}\sum_{j=1}^{J}e_{i}^{j,n}\hskip 2.84544pt\text{and}\hskip 2.84544ptE_{t}(k)=\sum_{n=1}^{k}b(\bm{\theta}_{i}^{k})e_{i,PS}^{k},</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
<td rowspan="1" class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_right"><span class="ltx_tag ltx_tag_equation ltx_align_right">(14)</span></td>
</tr></tbody>
</table>
<p id="S5.SS1.p2.18" class="ltx_p">where <math id="S5.SS1.p2.2.m1.1" class="ltx_Math" alttext="k" display="inline"><semantics id="S5.SS1.p2.2.m1.1a"><mi id="S5.SS1.p2.2.m1.1.1" xref="S5.SS1.p2.2.m1.1.1.cmml">k</mi><annotation-xml encoding="MathML-Content" id="S5.SS1.p2.2.m1.1b"><ci id="S5.SS1.p2.2.m1.1.1.cmml" xref="S5.SS1.p2.2.m1.1.1">𝑘</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.SS1.p2.2.m1.1c">k</annotation></semantics></math> is the number of communication rounds, <math id="S5.SS1.p2.3.m2.2" class="ltx_Math" alttext="e_{i}^{j,n}" display="inline"><semantics id="S5.SS1.p2.3.m2.2a"><msubsup id="S5.SS1.p2.3.m2.2.3" xref="S5.SS1.p2.3.m2.2.3.cmml"><mi id="S5.SS1.p2.3.m2.2.3.2.2" xref="S5.SS1.p2.3.m2.2.3.2.2.cmml">e</mi><mi id="S5.SS1.p2.3.m2.2.3.2.3" xref="S5.SS1.p2.3.m2.2.3.2.3.cmml">i</mi><mrow id="S5.SS1.p2.3.m2.2.2.2.4" xref="S5.SS1.p2.3.m2.2.2.2.3.cmml"><mi id="S5.SS1.p2.3.m2.1.1.1.1" xref="S5.SS1.p2.3.m2.1.1.1.1.cmml">j</mi><mo id="S5.SS1.p2.3.m2.2.2.2.4.1" xref="S5.SS1.p2.3.m2.2.2.2.3.cmml">,</mo><mi id="S5.SS1.p2.3.m2.2.2.2.2" xref="S5.SS1.p2.3.m2.2.2.2.2.cmml">n</mi></mrow></msubsup><annotation-xml encoding="MathML-Content" id="S5.SS1.p2.3.m2.2b"><apply id="S5.SS1.p2.3.m2.2.3.cmml" xref="S5.SS1.p2.3.m2.2.3"><csymbol cd="ambiguous" id="S5.SS1.p2.3.m2.2.3.1.cmml" xref="S5.SS1.p2.3.m2.2.3">superscript</csymbol><apply id="S5.SS1.p2.3.m2.2.3.2.cmml" xref="S5.SS1.p2.3.m2.2.3"><csymbol cd="ambiguous" id="S5.SS1.p2.3.m2.2.3.2.1.cmml" xref="S5.SS1.p2.3.m2.2.3">subscript</csymbol><ci id="S5.SS1.p2.3.m2.2.3.2.2.cmml" xref="S5.SS1.p2.3.m2.2.3.2.2">𝑒</ci><ci id="S5.SS1.p2.3.m2.2.3.2.3.cmml" xref="S5.SS1.p2.3.m2.2.3.2.3">𝑖</ci></apply><list id="S5.SS1.p2.3.m2.2.2.2.3.cmml" xref="S5.SS1.p2.3.m2.2.2.2.4"><ci id="S5.SS1.p2.3.m2.1.1.1.1.cmml" xref="S5.SS1.p2.3.m2.1.1.1.1">𝑗</ci><ci id="S5.SS1.p2.3.m2.2.2.2.2.cmml" xref="S5.SS1.p2.3.m2.2.2.2.2">𝑛</ci></list></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS1.p2.3.m2.2c">e_{i}^{j,n}</annotation></semantics></math> is the energy consumed by the device <math id="S5.SS1.p2.4.m3.1" class="ltx_Math" alttext="i" display="inline"><semantics id="S5.SS1.p2.4.m3.1a"><mi id="S5.SS1.p2.4.m3.1.1" xref="S5.SS1.p2.4.m3.1.1.cmml">i</mi><annotation-xml encoding="MathML-Content" id="S5.SS1.p2.4.m3.1b"><ci id="S5.SS1.p2.4.m3.1.1.cmml" xref="S5.SS1.p2.4.m3.1.1">𝑖</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.SS1.p2.4.m3.1c">i</annotation></semantics></math> for one local iteration, <math id="S5.SS1.p2.5.m4.1" class="ltx_Math" alttext="b(\bm{\theta}_{i}^{k})" display="inline"><semantics id="S5.SS1.p2.5.m4.1a"><mrow id="S5.SS1.p2.5.m4.1.1" xref="S5.SS1.p2.5.m4.1.1.cmml"><mi id="S5.SS1.p2.5.m4.1.1.3" xref="S5.SS1.p2.5.m4.1.1.3.cmml">b</mi><mo lspace="0em" rspace="0em" id="S5.SS1.p2.5.m4.1.1.2" xref="S5.SS1.p2.5.m4.1.1.2.cmml">​</mo><mrow id="S5.SS1.p2.5.m4.1.1.1.1" xref="S5.SS1.p2.5.m4.1.1.1.1.1.cmml"><mo stretchy="false" id="S5.SS1.p2.5.m4.1.1.1.1.2" xref="S5.SS1.p2.5.m4.1.1.1.1.1.cmml">(</mo><msubsup id="S5.SS1.p2.5.m4.1.1.1.1.1" xref="S5.SS1.p2.5.m4.1.1.1.1.1.cmml"><mi id="S5.SS1.p2.5.m4.1.1.1.1.1.2.2" xref="S5.SS1.p2.5.m4.1.1.1.1.1.2.2.cmml">𝜽</mi><mi id="S5.SS1.p2.5.m4.1.1.1.1.1.2.3" xref="S5.SS1.p2.5.m4.1.1.1.1.1.2.3.cmml">i</mi><mi id="S5.SS1.p2.5.m4.1.1.1.1.1.3" xref="S5.SS1.p2.5.m4.1.1.1.1.1.3.cmml">k</mi></msubsup><mo stretchy="false" id="S5.SS1.p2.5.m4.1.1.1.1.3" xref="S5.SS1.p2.5.m4.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S5.SS1.p2.5.m4.1b"><apply id="S5.SS1.p2.5.m4.1.1.cmml" xref="S5.SS1.p2.5.m4.1.1"><times id="S5.SS1.p2.5.m4.1.1.2.cmml" xref="S5.SS1.p2.5.m4.1.1.2"></times><ci id="S5.SS1.p2.5.m4.1.1.3.cmml" xref="S5.SS1.p2.5.m4.1.1.3">𝑏</ci><apply id="S5.SS1.p2.5.m4.1.1.1.1.1.cmml" xref="S5.SS1.p2.5.m4.1.1.1.1"><csymbol cd="ambiguous" id="S5.SS1.p2.5.m4.1.1.1.1.1.1.cmml" xref="S5.SS1.p2.5.m4.1.1.1.1">superscript</csymbol><apply id="S5.SS1.p2.5.m4.1.1.1.1.1.2.cmml" xref="S5.SS1.p2.5.m4.1.1.1.1"><csymbol cd="ambiguous" id="S5.SS1.p2.5.m4.1.1.1.1.1.2.1.cmml" xref="S5.SS1.p2.5.m4.1.1.1.1">subscript</csymbol><ci id="S5.SS1.p2.5.m4.1.1.1.1.1.2.2.cmml" xref="S5.SS1.p2.5.m4.1.1.1.1.1.2.2">𝜽</ci><ci id="S5.SS1.p2.5.m4.1.1.1.1.1.2.3.cmml" xref="S5.SS1.p2.5.m4.1.1.1.1.1.2.3">𝑖</ci></apply><ci id="S5.SS1.p2.5.m4.1.1.1.1.1.3.cmml" xref="S5.SS1.p2.5.m4.1.1.1.1.1.3">𝑘</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS1.p2.5.m4.1c">b(\bm{\theta}_{i}^{k})</annotation></semantics></math> is the size of the model vector in bits, and <math id="S5.SS1.p2.6.m5.2" class="ltx_Math" alttext="e_{i,PS}" display="inline"><semantics id="S5.SS1.p2.6.m5.2a"><msub id="S5.SS1.p2.6.m5.2.3" xref="S5.SS1.p2.6.m5.2.3.cmml"><mi id="S5.SS1.p2.6.m5.2.3.2" xref="S5.SS1.p2.6.m5.2.3.2.cmml">e</mi><mrow id="S5.SS1.p2.6.m5.2.2.2.2" xref="S5.SS1.p2.6.m5.2.2.2.3.cmml"><mi id="S5.SS1.p2.6.m5.1.1.1.1" xref="S5.SS1.p2.6.m5.1.1.1.1.cmml">i</mi><mo id="S5.SS1.p2.6.m5.2.2.2.2.2" xref="S5.SS1.p2.6.m5.2.2.2.3.cmml">,</mo><mrow id="S5.SS1.p2.6.m5.2.2.2.2.1" xref="S5.SS1.p2.6.m5.2.2.2.2.1.cmml"><mi id="S5.SS1.p2.6.m5.2.2.2.2.1.2" xref="S5.SS1.p2.6.m5.2.2.2.2.1.2.cmml">P</mi><mo lspace="0em" rspace="0em" id="S5.SS1.p2.6.m5.2.2.2.2.1.1" xref="S5.SS1.p2.6.m5.2.2.2.2.1.1.cmml">​</mo><mi id="S5.SS1.p2.6.m5.2.2.2.2.1.3" xref="S5.SS1.p2.6.m5.2.2.2.2.1.3.cmml">S</mi></mrow></mrow></msub><annotation-xml encoding="MathML-Content" id="S5.SS1.p2.6.m5.2b"><apply id="S5.SS1.p2.6.m5.2.3.cmml" xref="S5.SS1.p2.6.m5.2.3"><csymbol cd="ambiguous" id="S5.SS1.p2.6.m5.2.3.1.cmml" xref="S5.SS1.p2.6.m5.2.3">subscript</csymbol><ci id="S5.SS1.p2.6.m5.2.3.2.cmml" xref="S5.SS1.p2.6.m5.2.3.2">𝑒</ci><list id="S5.SS1.p2.6.m5.2.2.2.3.cmml" xref="S5.SS1.p2.6.m5.2.2.2.2"><ci id="S5.SS1.p2.6.m5.1.1.1.1.cmml" xref="S5.SS1.p2.6.m5.1.1.1.1">𝑖</ci><apply id="S5.SS1.p2.6.m5.2.2.2.2.1.cmml" xref="S5.SS1.p2.6.m5.2.2.2.2.1"><times id="S5.SS1.p2.6.m5.2.2.2.2.1.1.cmml" xref="S5.SS1.p2.6.m5.2.2.2.2.1.1"></times><ci id="S5.SS1.p2.6.m5.2.2.2.2.1.2.cmml" xref="S5.SS1.p2.6.m5.2.2.2.2.1.2">𝑃</ci><ci id="S5.SS1.p2.6.m5.2.2.2.2.1.3.cmml" xref="S5.SS1.p2.6.m5.2.2.2.2.1.3">𝑆</ci></apply></list></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS1.p2.6.m5.2c">e_{i,PS}</annotation></semantics></math> is the energy needed to transmit information between the device <math id="S5.SS1.p2.7.m6.1" class="ltx_Math" alttext="i" display="inline"><semantics id="S5.SS1.p2.7.m6.1a"><mi id="S5.SS1.p2.7.m6.1.1" xref="S5.SS1.p2.7.m6.1.1.cmml">i</mi><annotation-xml encoding="MathML-Content" id="S5.SS1.p2.7.m6.1b"><ci id="S5.SS1.p2.7.m6.1.1.cmml" xref="S5.SS1.p2.7.m6.1.1">𝑖</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.SS1.p2.7.m6.1c">i</annotation></semantics></math> and the PS. The transmitted model’s parameters are assumed to be in the 32-bit form. We use the same channel model as in <cite class="ltx_cite ltx_citemacro_cite">[<a href="#bib.bib19" title="" class="ltx_ref">19</a>]</cite> and assume a uniform distance between the server and all clients within a space of size <math id="S5.SS1.p2.8.m7.1" class="ltx_Math" alttext="100\times 100" display="inline"><semantics id="S5.SS1.p2.8.m7.1a"><mrow id="S5.SS1.p2.8.m7.1.1" xref="S5.SS1.p2.8.m7.1.1.cmml"><mn id="S5.SS1.p2.8.m7.1.1.2" xref="S5.SS1.p2.8.m7.1.1.2.cmml">100</mn><mo lspace="0.222em" rspace="0.222em" id="S5.SS1.p2.8.m7.1.1.1" xref="S5.SS1.p2.8.m7.1.1.1.cmml">×</mo><mn id="S5.SS1.p2.8.m7.1.1.3" xref="S5.SS1.p2.8.m7.1.1.3.cmml">100</mn></mrow><annotation-xml encoding="MathML-Content" id="S5.SS1.p2.8.m7.1b"><apply id="S5.SS1.p2.8.m7.1.1.cmml" xref="S5.SS1.p2.8.m7.1.1"><times id="S5.SS1.p2.8.m7.1.1.1.cmml" xref="S5.SS1.p2.8.m7.1.1.1"></times><cn type="integer" id="S5.SS1.p2.8.m7.1.1.2.cmml" xref="S5.SS1.p2.8.m7.1.1.2">100</cn><cn type="integer" id="S5.SS1.p2.8.m7.1.1.3.cmml" xref="S5.SS1.p2.8.m7.1.1.3">100</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS1.p2.8.m7.1c">100\times 100</annotation></semantics></math> <math id="S5.SS1.p2.9.m8.1" class="ltx_Math" alttext="m^{2}" display="inline"><semantics id="S5.SS1.p2.9.m8.1a"><msup id="S5.SS1.p2.9.m8.1.1" xref="S5.SS1.p2.9.m8.1.1.cmml"><mi id="S5.SS1.p2.9.m8.1.1.2" xref="S5.SS1.p2.9.m8.1.1.2.cmml">m</mi><mn id="S5.SS1.p2.9.m8.1.1.3" xref="S5.SS1.p2.9.m8.1.1.3.cmml">2</mn></msup><annotation-xml encoding="MathML-Content" id="S5.SS1.p2.9.m8.1b"><apply id="S5.SS1.p2.9.m8.1.1.cmml" xref="S5.SS1.p2.9.m8.1.1"><csymbol cd="ambiguous" id="S5.SS1.p2.9.m8.1.1.1.cmml" xref="S5.SS1.p2.9.m8.1.1">superscript</csymbol><ci id="S5.SS1.p2.9.m8.1.1.2.cmml" xref="S5.SS1.p2.9.m8.1.1.2">𝑚</ci><cn type="integer" id="S5.SS1.p2.9.m8.1.1.3.cmml" xref="S5.SS1.p2.9.m8.1.1.3">2</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS1.p2.9.m8.1c">m^{2}</annotation></semantics></math>. According to Shannon’s formula, the maximum achievable rate for each client is given by <math id="S5.SS1.p2.10.m9.4" class="ltx_Math" alttext="R=B\log_{2}(1+\frac{P_{t}}{d_{i,PS}BN_{0}})" display="inline"><semantics id="S5.SS1.p2.10.m9.4a"><mrow id="S5.SS1.p2.10.m9.4.4" xref="S5.SS1.p2.10.m9.4.4.cmml"><mi id="S5.SS1.p2.10.m9.4.4.4" xref="S5.SS1.p2.10.m9.4.4.4.cmml">R</mi><mo id="S5.SS1.p2.10.m9.4.4.3" xref="S5.SS1.p2.10.m9.4.4.3.cmml">=</mo><mrow id="S5.SS1.p2.10.m9.4.4.2" xref="S5.SS1.p2.10.m9.4.4.2.cmml"><mi id="S5.SS1.p2.10.m9.4.4.2.4" xref="S5.SS1.p2.10.m9.4.4.2.4.cmml">B</mi><mo lspace="0.167em" rspace="0em" id="S5.SS1.p2.10.m9.4.4.2.3" xref="S5.SS1.p2.10.m9.4.4.2.3.cmml">​</mo><mrow id="S5.SS1.p2.10.m9.4.4.2.2.2" xref="S5.SS1.p2.10.m9.4.4.2.2.3.cmml"><msub id="S5.SS1.p2.10.m9.3.3.1.1.1.1" xref="S5.SS1.p2.10.m9.3.3.1.1.1.1.cmml"><mi id="S5.SS1.p2.10.m9.3.3.1.1.1.1.2" xref="S5.SS1.p2.10.m9.3.3.1.1.1.1.2.cmml">log</mi><mn id="S5.SS1.p2.10.m9.3.3.1.1.1.1.3" xref="S5.SS1.p2.10.m9.3.3.1.1.1.1.3.cmml">2</mn></msub><mo id="S5.SS1.p2.10.m9.4.4.2.2.2a" xref="S5.SS1.p2.10.m9.4.4.2.2.3.cmml">⁡</mo><mrow id="S5.SS1.p2.10.m9.4.4.2.2.2.2" xref="S5.SS1.p2.10.m9.4.4.2.2.3.cmml"><mo stretchy="false" id="S5.SS1.p2.10.m9.4.4.2.2.2.2.2" xref="S5.SS1.p2.10.m9.4.4.2.2.3.cmml">(</mo><mrow id="S5.SS1.p2.10.m9.4.4.2.2.2.2.1" xref="S5.SS1.p2.10.m9.4.4.2.2.2.2.1.cmml"><mn id="S5.SS1.p2.10.m9.4.4.2.2.2.2.1.2" xref="S5.SS1.p2.10.m9.4.4.2.2.2.2.1.2.cmml">1</mn><mo id="S5.SS1.p2.10.m9.4.4.2.2.2.2.1.1" xref="S5.SS1.p2.10.m9.4.4.2.2.2.2.1.1.cmml">+</mo><mfrac id="S5.SS1.p2.10.m9.2.2" xref="S5.SS1.p2.10.m9.2.2.cmml"><msub id="S5.SS1.p2.10.m9.2.2.4" xref="S5.SS1.p2.10.m9.2.2.4.cmml"><mi id="S5.SS1.p2.10.m9.2.2.4.2" xref="S5.SS1.p2.10.m9.2.2.4.2.cmml">P</mi><mi id="S5.SS1.p2.10.m9.2.2.4.3" xref="S5.SS1.p2.10.m9.2.2.4.3.cmml">t</mi></msub><mrow id="S5.SS1.p2.10.m9.2.2.2" xref="S5.SS1.p2.10.m9.2.2.2.cmml"><msub id="S5.SS1.p2.10.m9.2.2.2.4" xref="S5.SS1.p2.10.m9.2.2.2.4.cmml"><mi id="S5.SS1.p2.10.m9.2.2.2.4.2" xref="S5.SS1.p2.10.m9.2.2.2.4.2.cmml">d</mi><mrow id="S5.SS1.p2.10.m9.2.2.2.2.2.2" xref="S5.SS1.p2.10.m9.2.2.2.2.2.3.cmml"><mi id="S5.SS1.p2.10.m9.1.1.1.1.1.1" xref="S5.SS1.p2.10.m9.1.1.1.1.1.1.cmml">i</mi><mo id="S5.SS1.p2.10.m9.2.2.2.2.2.2.2" xref="S5.SS1.p2.10.m9.2.2.2.2.2.3.cmml">,</mo><mrow id="S5.SS1.p2.10.m9.2.2.2.2.2.2.1" xref="S5.SS1.p2.10.m9.2.2.2.2.2.2.1.cmml"><mi id="S5.SS1.p2.10.m9.2.2.2.2.2.2.1.2" xref="S5.SS1.p2.10.m9.2.2.2.2.2.2.1.2.cmml">P</mi><mo lspace="0em" rspace="0em" id="S5.SS1.p2.10.m9.2.2.2.2.2.2.1.1" xref="S5.SS1.p2.10.m9.2.2.2.2.2.2.1.1.cmml">​</mo><mi id="S5.SS1.p2.10.m9.2.2.2.2.2.2.1.3" xref="S5.SS1.p2.10.m9.2.2.2.2.2.2.1.3.cmml">S</mi></mrow></mrow></msub><mo lspace="0em" rspace="0em" id="S5.SS1.p2.10.m9.2.2.2.3" xref="S5.SS1.p2.10.m9.2.2.2.3.cmml">​</mo><mi id="S5.SS1.p2.10.m9.2.2.2.5" xref="S5.SS1.p2.10.m9.2.2.2.5.cmml">B</mi><mo lspace="0em" rspace="0em" id="S5.SS1.p2.10.m9.2.2.2.3a" xref="S5.SS1.p2.10.m9.2.2.2.3.cmml">​</mo><msub id="S5.SS1.p2.10.m9.2.2.2.6" xref="S5.SS1.p2.10.m9.2.2.2.6.cmml"><mi id="S5.SS1.p2.10.m9.2.2.2.6.2" xref="S5.SS1.p2.10.m9.2.2.2.6.2.cmml">N</mi><mn id="S5.SS1.p2.10.m9.2.2.2.6.3" xref="S5.SS1.p2.10.m9.2.2.2.6.3.cmml">0</mn></msub></mrow></mfrac></mrow><mo stretchy="false" id="S5.SS1.p2.10.m9.4.4.2.2.2.2.3" xref="S5.SS1.p2.10.m9.4.4.2.2.3.cmml">)</mo></mrow></mrow></mrow></mrow><annotation-xml encoding="MathML-Content" id="S5.SS1.p2.10.m9.4b"><apply id="S5.SS1.p2.10.m9.4.4.cmml" xref="S5.SS1.p2.10.m9.4.4"><eq id="S5.SS1.p2.10.m9.4.4.3.cmml" xref="S5.SS1.p2.10.m9.4.4.3"></eq><ci id="S5.SS1.p2.10.m9.4.4.4.cmml" xref="S5.SS1.p2.10.m9.4.4.4">𝑅</ci><apply id="S5.SS1.p2.10.m9.4.4.2.cmml" xref="S5.SS1.p2.10.m9.4.4.2"><times id="S5.SS1.p2.10.m9.4.4.2.3.cmml" xref="S5.SS1.p2.10.m9.4.4.2.3"></times><ci id="S5.SS1.p2.10.m9.4.4.2.4.cmml" xref="S5.SS1.p2.10.m9.4.4.2.4">𝐵</ci><apply id="S5.SS1.p2.10.m9.4.4.2.2.3.cmml" xref="S5.SS1.p2.10.m9.4.4.2.2.2"><apply id="S5.SS1.p2.10.m9.3.3.1.1.1.1.cmml" xref="S5.SS1.p2.10.m9.3.3.1.1.1.1"><csymbol cd="ambiguous" id="S5.SS1.p2.10.m9.3.3.1.1.1.1.1.cmml" xref="S5.SS1.p2.10.m9.3.3.1.1.1.1">subscript</csymbol><log id="S5.SS1.p2.10.m9.3.3.1.1.1.1.2.cmml" xref="S5.SS1.p2.10.m9.3.3.1.1.1.1.2"></log><cn type="integer" id="S5.SS1.p2.10.m9.3.3.1.1.1.1.3.cmml" xref="S5.SS1.p2.10.m9.3.3.1.1.1.1.3">2</cn></apply><apply id="S5.SS1.p2.10.m9.4.4.2.2.2.2.1.cmml" xref="S5.SS1.p2.10.m9.4.4.2.2.2.2.1"><plus id="S5.SS1.p2.10.m9.4.4.2.2.2.2.1.1.cmml" xref="S5.SS1.p2.10.m9.4.4.2.2.2.2.1.1"></plus><cn type="integer" id="S5.SS1.p2.10.m9.4.4.2.2.2.2.1.2.cmml" xref="S5.SS1.p2.10.m9.4.4.2.2.2.2.1.2">1</cn><apply id="S5.SS1.p2.10.m9.2.2.cmml" xref="S5.SS1.p2.10.m9.2.2"><divide id="S5.SS1.p2.10.m9.2.2.3.cmml" xref="S5.SS1.p2.10.m9.2.2"></divide><apply id="S5.SS1.p2.10.m9.2.2.4.cmml" xref="S5.SS1.p2.10.m9.2.2.4"><csymbol cd="ambiguous" id="S5.SS1.p2.10.m9.2.2.4.1.cmml" xref="S5.SS1.p2.10.m9.2.2.4">subscript</csymbol><ci id="S5.SS1.p2.10.m9.2.2.4.2.cmml" xref="S5.SS1.p2.10.m9.2.2.4.2">𝑃</ci><ci id="S5.SS1.p2.10.m9.2.2.4.3.cmml" xref="S5.SS1.p2.10.m9.2.2.4.3">𝑡</ci></apply><apply id="S5.SS1.p2.10.m9.2.2.2.cmml" xref="S5.SS1.p2.10.m9.2.2.2"><times id="S5.SS1.p2.10.m9.2.2.2.3.cmml" xref="S5.SS1.p2.10.m9.2.2.2.3"></times><apply id="S5.SS1.p2.10.m9.2.2.2.4.cmml" xref="S5.SS1.p2.10.m9.2.2.2.4"><csymbol cd="ambiguous" id="S5.SS1.p2.10.m9.2.2.2.4.1.cmml" xref="S5.SS1.p2.10.m9.2.2.2.4">subscript</csymbol><ci id="S5.SS1.p2.10.m9.2.2.2.4.2.cmml" xref="S5.SS1.p2.10.m9.2.2.2.4.2">𝑑</ci><list id="S5.SS1.p2.10.m9.2.2.2.2.2.3.cmml" xref="S5.SS1.p2.10.m9.2.2.2.2.2.2"><ci id="S5.SS1.p2.10.m9.1.1.1.1.1.1.cmml" xref="S5.SS1.p2.10.m9.1.1.1.1.1.1">𝑖</ci><apply id="S5.SS1.p2.10.m9.2.2.2.2.2.2.1.cmml" xref="S5.SS1.p2.10.m9.2.2.2.2.2.2.1"><times id="S5.SS1.p2.10.m9.2.2.2.2.2.2.1.1.cmml" xref="S5.SS1.p2.10.m9.2.2.2.2.2.2.1.1"></times><ci id="S5.SS1.p2.10.m9.2.2.2.2.2.2.1.2.cmml" xref="S5.SS1.p2.10.m9.2.2.2.2.2.2.1.2">𝑃</ci><ci id="S5.SS1.p2.10.m9.2.2.2.2.2.2.1.3.cmml" xref="S5.SS1.p2.10.m9.2.2.2.2.2.2.1.3">𝑆</ci></apply></list></apply><ci id="S5.SS1.p2.10.m9.2.2.2.5.cmml" xref="S5.SS1.p2.10.m9.2.2.2.5">𝐵</ci><apply id="S5.SS1.p2.10.m9.2.2.2.6.cmml" xref="S5.SS1.p2.10.m9.2.2.2.6"><csymbol cd="ambiguous" id="S5.SS1.p2.10.m9.2.2.2.6.1.cmml" xref="S5.SS1.p2.10.m9.2.2.2.6">subscript</csymbol><ci id="S5.SS1.p2.10.m9.2.2.2.6.2.cmml" xref="S5.SS1.p2.10.m9.2.2.2.6.2">𝑁</ci><cn type="integer" id="S5.SS1.p2.10.m9.2.2.2.6.3.cmml" xref="S5.SS1.p2.10.m9.2.2.2.6.3">0</cn></apply></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS1.p2.10.m9.4c">R=B\log_{2}(1+\frac{P_{t}}{d_{i,PS}BN_{0}})</annotation></semantics></math>, where <math id="S5.SS1.p2.11.m10.1" class="ltx_Math" alttext="B" display="inline"><semantics id="S5.SS1.p2.11.m10.1a"><mi id="S5.SS1.p2.11.m10.1.1" xref="S5.SS1.p2.11.m10.1.1.cmml">B</mi><annotation-xml encoding="MathML-Content" id="S5.SS1.p2.11.m10.1b"><ci id="S5.SS1.p2.11.m10.1.1.cmml" xref="S5.SS1.p2.11.m10.1.1">𝐵</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.SS1.p2.11.m10.1c">B</annotation></semantics></math> is the bandwidth, <math id="S5.SS1.p2.12.m11.1" class="ltx_Math" alttext="P_{t}" display="inline"><semantics id="S5.SS1.p2.12.m11.1a"><msub id="S5.SS1.p2.12.m11.1.1" xref="S5.SS1.p2.12.m11.1.1.cmml"><mi id="S5.SS1.p2.12.m11.1.1.2" xref="S5.SS1.p2.12.m11.1.1.2.cmml">P</mi><mi id="S5.SS1.p2.12.m11.1.1.3" xref="S5.SS1.p2.12.m11.1.1.3.cmml">t</mi></msub><annotation-xml encoding="MathML-Content" id="S5.SS1.p2.12.m11.1b"><apply id="S5.SS1.p2.12.m11.1.1.cmml" xref="S5.SS1.p2.12.m11.1.1"><csymbol cd="ambiguous" id="S5.SS1.p2.12.m11.1.1.1.cmml" xref="S5.SS1.p2.12.m11.1.1">subscript</csymbol><ci id="S5.SS1.p2.12.m11.1.1.2.cmml" xref="S5.SS1.p2.12.m11.1.1.2">𝑃</ci><ci id="S5.SS1.p2.12.m11.1.1.3.cmml" xref="S5.SS1.p2.12.m11.1.1.3">𝑡</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS1.p2.12.m11.1c">P_{t}</annotation></semantics></math> is the transmission power, <math id="S5.SS1.p2.13.m12.2" class="ltx_Math" alttext="d_{i,PS}" display="inline"><semantics id="S5.SS1.p2.13.m12.2a"><msub id="S5.SS1.p2.13.m12.2.3" xref="S5.SS1.p2.13.m12.2.3.cmml"><mi id="S5.SS1.p2.13.m12.2.3.2" xref="S5.SS1.p2.13.m12.2.3.2.cmml">d</mi><mrow id="S5.SS1.p2.13.m12.2.2.2.2" xref="S5.SS1.p2.13.m12.2.2.2.3.cmml"><mi id="S5.SS1.p2.13.m12.1.1.1.1" xref="S5.SS1.p2.13.m12.1.1.1.1.cmml">i</mi><mo id="S5.SS1.p2.13.m12.2.2.2.2.2" xref="S5.SS1.p2.13.m12.2.2.2.3.cmml">,</mo><mrow id="S5.SS1.p2.13.m12.2.2.2.2.1" xref="S5.SS1.p2.13.m12.2.2.2.2.1.cmml"><mi id="S5.SS1.p2.13.m12.2.2.2.2.1.2" xref="S5.SS1.p2.13.m12.2.2.2.2.1.2.cmml">P</mi><mo lspace="0em" rspace="0em" id="S5.SS1.p2.13.m12.2.2.2.2.1.1" xref="S5.SS1.p2.13.m12.2.2.2.2.1.1.cmml">​</mo><mi id="S5.SS1.p2.13.m12.2.2.2.2.1.3" xref="S5.SS1.p2.13.m12.2.2.2.2.1.3.cmml">S</mi></mrow></mrow></msub><annotation-xml encoding="MathML-Content" id="S5.SS1.p2.13.m12.2b"><apply id="S5.SS1.p2.13.m12.2.3.cmml" xref="S5.SS1.p2.13.m12.2.3"><csymbol cd="ambiguous" id="S5.SS1.p2.13.m12.2.3.1.cmml" xref="S5.SS1.p2.13.m12.2.3">subscript</csymbol><ci id="S5.SS1.p2.13.m12.2.3.2.cmml" xref="S5.SS1.p2.13.m12.2.3.2">𝑑</ci><list id="S5.SS1.p2.13.m12.2.2.2.3.cmml" xref="S5.SS1.p2.13.m12.2.2.2.2"><ci id="S5.SS1.p2.13.m12.1.1.1.1.cmml" xref="S5.SS1.p2.13.m12.1.1.1.1">𝑖</ci><apply id="S5.SS1.p2.13.m12.2.2.2.2.1.cmml" xref="S5.SS1.p2.13.m12.2.2.2.2.1"><times id="S5.SS1.p2.13.m12.2.2.2.2.1.1.cmml" xref="S5.SS1.p2.13.m12.2.2.2.2.1.1"></times><ci id="S5.SS1.p2.13.m12.2.2.2.2.1.2.cmml" xref="S5.SS1.p2.13.m12.2.2.2.2.1.2">𝑃</ci><ci id="S5.SS1.p2.13.m12.2.2.2.2.1.3.cmml" xref="S5.SS1.p2.13.m12.2.2.2.2.1.3">𝑆</ci></apply></list></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS1.p2.13.m12.2c">d_{i,PS}</annotation></semantics></math> is the distance between client <math id="S5.SS1.p2.14.m13.1" class="ltx_Math" alttext="i" display="inline"><semantics id="S5.SS1.p2.14.m13.1a"><mi id="S5.SS1.p2.14.m13.1.1" xref="S5.SS1.p2.14.m13.1.1.cmml">i</mi><annotation-xml encoding="MathML-Content" id="S5.SS1.p2.14.m13.1b"><ci id="S5.SS1.p2.14.m13.1.1.cmml" xref="S5.SS1.p2.14.m13.1.1">𝑖</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.SS1.p2.14.m13.1c">i</annotation></semantics></math> and the PS, and <math id="S5.SS1.p2.15.m14.1" class="ltx_Math" alttext="N_{0}" display="inline"><semantics id="S5.SS1.p2.15.m14.1a"><msub id="S5.SS1.p2.15.m14.1.1" xref="S5.SS1.p2.15.m14.1.1.cmml"><mi id="S5.SS1.p2.15.m14.1.1.2" xref="S5.SS1.p2.15.m14.1.1.2.cmml">N</mi><mn id="S5.SS1.p2.15.m14.1.1.3" xref="S5.SS1.p2.15.m14.1.1.3.cmml">0</mn></msub><annotation-xml encoding="MathML-Content" id="S5.SS1.p2.15.m14.1b"><apply id="S5.SS1.p2.15.m14.1.1.cmml" xref="S5.SS1.p2.15.m14.1.1"><csymbol cd="ambiguous" id="S5.SS1.p2.15.m14.1.1.1.cmml" xref="S5.SS1.p2.15.m14.1.1">subscript</csymbol><ci id="S5.SS1.p2.15.m14.1.1.2.cmml" xref="S5.SS1.p2.15.m14.1.1.2">𝑁</ci><cn type="integer" id="S5.SS1.p2.15.m14.1.1.3.cmml" xref="S5.SS1.p2.15.m14.1.1.3">0</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS1.p2.15.m14.1c">N_{0}</annotation></semantics></math> is the noise spectral density. We set <math id="S5.SS1.p2.16.m15.1" class="ltx_Math" alttext="P_{t}=100" display="inline"><semantics id="S5.SS1.p2.16.m15.1a"><mrow id="S5.SS1.p2.16.m15.1.1" xref="S5.SS1.p2.16.m15.1.1.cmml"><msub id="S5.SS1.p2.16.m15.1.1.2" xref="S5.SS1.p2.16.m15.1.1.2.cmml"><mi id="S5.SS1.p2.16.m15.1.1.2.2" xref="S5.SS1.p2.16.m15.1.1.2.2.cmml">P</mi><mi id="S5.SS1.p2.16.m15.1.1.2.3" xref="S5.SS1.p2.16.m15.1.1.2.3.cmml">t</mi></msub><mo id="S5.SS1.p2.16.m15.1.1.1" xref="S5.SS1.p2.16.m15.1.1.1.cmml">=</mo><mn id="S5.SS1.p2.16.m15.1.1.3" xref="S5.SS1.p2.16.m15.1.1.3.cmml">100</mn></mrow><annotation-xml encoding="MathML-Content" id="S5.SS1.p2.16.m15.1b"><apply id="S5.SS1.p2.16.m15.1.1.cmml" xref="S5.SS1.p2.16.m15.1.1"><eq id="S5.SS1.p2.16.m15.1.1.1.cmml" xref="S5.SS1.p2.16.m15.1.1.1"></eq><apply id="S5.SS1.p2.16.m15.1.1.2.cmml" xref="S5.SS1.p2.16.m15.1.1.2"><csymbol cd="ambiguous" id="S5.SS1.p2.16.m15.1.1.2.1.cmml" xref="S5.SS1.p2.16.m15.1.1.2">subscript</csymbol><ci id="S5.SS1.p2.16.m15.1.1.2.2.cmml" xref="S5.SS1.p2.16.m15.1.1.2.2">𝑃</ci><ci id="S5.SS1.p2.16.m15.1.1.2.3.cmml" xref="S5.SS1.p2.16.m15.1.1.2.3">𝑡</ci></apply><cn type="integer" id="S5.SS1.p2.16.m15.1.1.3.cmml" xref="S5.SS1.p2.16.m15.1.1.3">100</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS1.p2.16.m15.1c">P_{t}=100</annotation></semantics></math>mW, <math id="S5.SS1.p2.17.m16.1" class="ltx_Math" alttext="B=2" display="inline"><semantics id="S5.SS1.p2.17.m16.1a"><mrow id="S5.SS1.p2.17.m16.1.1" xref="S5.SS1.p2.17.m16.1.1.cmml"><mi id="S5.SS1.p2.17.m16.1.1.2" xref="S5.SS1.p2.17.m16.1.1.2.cmml">B</mi><mo id="S5.SS1.p2.17.m16.1.1.1" xref="S5.SS1.p2.17.m16.1.1.1.cmml">=</mo><mn id="S5.SS1.p2.17.m16.1.1.3" xref="S5.SS1.p2.17.m16.1.1.3.cmml">2</mn></mrow><annotation-xml encoding="MathML-Content" id="S5.SS1.p2.17.m16.1b"><apply id="S5.SS1.p2.17.m16.1.1.cmml" xref="S5.SS1.p2.17.m16.1.1"><eq id="S5.SS1.p2.17.m16.1.1.1.cmml" xref="S5.SS1.p2.17.m16.1.1.1"></eq><ci id="S5.SS1.p2.17.m16.1.1.2.cmml" xref="S5.SS1.p2.17.m16.1.1.2">𝐵</ci><cn type="integer" id="S5.SS1.p2.17.m16.1.1.3.cmml" xref="S5.SS1.p2.17.m16.1.1.3">2</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS1.p2.17.m16.1c">B=2</annotation></semantics></math>MHz, and <math id="S5.SS1.p2.18.m17.1" class="ltx_Math" alttext="N_{0}=10^{-9}" display="inline"><semantics id="S5.SS1.p2.18.m17.1a"><mrow id="S5.SS1.p2.18.m17.1.1" xref="S5.SS1.p2.18.m17.1.1.cmml"><msub id="S5.SS1.p2.18.m17.1.1.2" xref="S5.SS1.p2.18.m17.1.1.2.cmml"><mi id="S5.SS1.p2.18.m17.1.1.2.2" xref="S5.SS1.p2.18.m17.1.1.2.2.cmml">N</mi><mn id="S5.SS1.p2.18.m17.1.1.2.3" xref="S5.SS1.p2.18.m17.1.1.2.3.cmml">0</mn></msub><mo id="S5.SS1.p2.18.m17.1.1.1" xref="S5.SS1.p2.18.m17.1.1.1.cmml">=</mo><msup id="S5.SS1.p2.18.m17.1.1.3" xref="S5.SS1.p2.18.m17.1.1.3.cmml"><mn id="S5.SS1.p2.18.m17.1.1.3.2" xref="S5.SS1.p2.18.m17.1.1.3.2.cmml">10</mn><mrow id="S5.SS1.p2.18.m17.1.1.3.3" xref="S5.SS1.p2.18.m17.1.1.3.3.cmml"><mo id="S5.SS1.p2.18.m17.1.1.3.3a" xref="S5.SS1.p2.18.m17.1.1.3.3.cmml">−</mo><mn id="S5.SS1.p2.18.m17.1.1.3.3.2" xref="S5.SS1.p2.18.m17.1.1.3.3.2.cmml">9</mn></mrow></msup></mrow><annotation-xml encoding="MathML-Content" id="S5.SS1.p2.18.m17.1b"><apply id="S5.SS1.p2.18.m17.1.1.cmml" xref="S5.SS1.p2.18.m17.1.1"><eq id="S5.SS1.p2.18.m17.1.1.1.cmml" xref="S5.SS1.p2.18.m17.1.1.1"></eq><apply id="S5.SS1.p2.18.m17.1.1.2.cmml" xref="S5.SS1.p2.18.m17.1.1.2"><csymbol cd="ambiguous" id="S5.SS1.p2.18.m17.1.1.2.1.cmml" xref="S5.SS1.p2.18.m17.1.1.2">subscript</csymbol><ci id="S5.SS1.p2.18.m17.1.1.2.2.cmml" xref="S5.SS1.p2.18.m17.1.1.2.2">𝑁</ci><cn type="integer" id="S5.SS1.p2.18.m17.1.1.2.3.cmml" xref="S5.SS1.p2.18.m17.1.1.2.3">0</cn></apply><apply id="S5.SS1.p2.18.m17.1.1.3.cmml" xref="S5.SS1.p2.18.m17.1.1.3"><csymbol cd="ambiguous" id="S5.SS1.p2.18.m17.1.1.3.1.cmml" xref="S5.SS1.p2.18.m17.1.1.3">superscript</csymbol><cn type="integer" id="S5.SS1.p2.18.m17.1.1.3.2.cmml" xref="S5.SS1.p2.18.m17.1.1.3.2">10</cn><apply id="S5.SS1.p2.18.m17.1.1.3.3.cmml" xref="S5.SS1.p2.18.m17.1.1.3.3"><minus id="S5.SS1.p2.18.m17.1.1.3.3.1.cmml" xref="S5.SS1.p2.18.m17.1.1.3.3"></minus><cn type="integer" id="S5.SS1.p2.18.m17.1.1.3.3.2.cmml" xref="S5.SS1.p2.18.m17.1.1.3.3.2">9</cn></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS1.p2.18.m17.1c">N_{0}=10^{-9}</annotation></semantics></math>W/Hz.</p>
</div>
</section>
<section id="S5.SS2" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection"><span id="S5.SS2.4.1.1" class="ltx_text">V-B</span> </span><span id="S5.SS2.5.2" class="ltx_text ltx_font_italic">Performance Comparison</span>
</h3>

<div id="S5.SS2.p1" class="ltx_para">
<p id="S5.SS2.p1.8" class="ltx_p">Herein, we compare the performance of Fed-Sophia against FedAvg and DONE in terms of the test accuracy on both MNIST and FMNIST datasets. For Fed-Sophia and FedAvg, we utilize mini-batches of size 512, a common way to train DNNs. On the other hand, DONE requires the full data for each client, which comes at a computational cost. As shown in Fig. <a href="#S4.F2" title="Figure 2 ‣ IV-C Clipping Operation ‣ IV Proposed Algorithm ‣ Fed-Sophia: A Communication-Efficient Second-Order Federated Learning Algorithm Identify applicable funding agency here. If none, delete this." class="ltx_ref"><span class="ltx_text ltx_ref_tag">2</span></a>, the proposed Fed-Sophia scheme requires fewer communication rounds than FedAvg and DONE in all experiments. It also outperforms both of them in terms of the test accuracy for the CNN model Fig. <a href="#S4.F2" title="Figure 2 ‣ IV-C Clipping Operation ‣ IV Proposed Algorithm ‣ Fed-Sophia: A Communication-Efficient Second-Order Federated Learning Algorithm Identify applicable funding agency here. If none, delete this." class="ltx_ref"><span class="ltx_text ltx_ref_tag">2</span></a>(a) and 2(b) with the two datasets. For the MLP model, Fed-Sophia outperforms the two baselines with the MNIST dataset, requiring only <math id="S5.SS2.p1.1.m1.1" class="ltx_Math" alttext="30" display="inline"><semantics id="S5.SS2.p1.1.m1.1a"><mn id="S5.SS2.p1.1.m1.1.1" xref="S5.SS2.p1.1.m1.1.1.cmml">30</mn><annotation-xml encoding="MathML-Content" id="S5.SS2.p1.1.m1.1b"><cn type="integer" id="S5.SS2.p1.1.m1.1.1.cmml" xref="S5.SS2.p1.1.m1.1.1">30</cn></annotation-xml><annotation encoding="application/x-tex" id="S5.SS2.p1.1.m1.1c">30</annotation></semantics></math> communication rounds to converge compared to <math id="S5.SS2.p1.2.m2.1" class="ltx_Math" alttext="70" display="inline"><semantics id="S5.SS2.p1.2.m2.1a"><mn id="S5.SS2.p1.2.m2.1.1" xref="S5.SS2.p1.2.m2.1.1.cmml">70</mn><annotation-xml encoding="MathML-Content" id="S5.SS2.p1.2.m2.1b"><cn type="integer" id="S5.SS2.p1.2.m2.1.1.cmml" xref="S5.SS2.p1.2.m2.1.1">70</cn></annotation-xml><annotation encoding="application/x-tex" id="S5.SS2.p1.2.m2.1c">70</annotation></semantics></math> and <math id="S5.SS2.p1.3.m3.1" class="ltx_Math" alttext="100" display="inline"><semantics id="S5.SS2.p1.3.m3.1a"><mn id="S5.SS2.p1.3.m3.1.1" xref="S5.SS2.p1.3.m3.1.1.cmml">100</mn><annotation-xml encoding="MathML-Content" id="S5.SS2.p1.3.m3.1b"><cn type="integer" id="S5.SS2.p1.3.m3.1.1.cmml" xref="S5.SS2.p1.3.m3.1.1">100</cn></annotation-xml><annotation encoding="application/x-tex" id="S5.SS2.p1.3.m3.1c">100</annotation></semantics></math> for DONE and FedAvg, respectively as shown in Fig. <a href="#S4.F2" title="Figure 2 ‣ IV-C Clipping Operation ‣ IV Proposed Algorithm ‣ Fed-Sophia: A Communication-Efficient Second-Order Federated Learning Algorithm Identify applicable funding agency here. If none, delete this." class="ltx_ref"><span class="ltx_text ltx_ref_tag">2</span></a>(c). For the FMNIST dataset in Fig. <a href="#S4.F2" title="Figure 2 ‣ IV-C Clipping Operation ‣ IV Proposed Algorithm ‣ Fed-Sophia: A Communication-Efficient Second-Order Federated Learning Algorithm Identify applicable funding agency here. If none, delete this." class="ltx_ref"><span class="ltx_text ltx_ref_tag">2</span></a>(d), DONE and Fed-Sophia are almost identical in terms of test accuracy, with the advantage of early convergence for Fed-Sophia. In Fig. <a href="#S5.F3" title="Figure 3 ‣ V-B Performance Comparison ‣ V Numerical Results ‣ Fed-Sophia: A Communication-Efficient Second-Order Federated Learning Algorithm Identify applicable funding agency here. If none, delete this." class="ltx_ref"><span class="ltx_text ltx_ref_tag">3</span></a>, we plot the test accuracy of all algorithms against the total number of iterations to grasp an idea of the computational cost. For the MNIST dataset, it turns out that Fed-Sophia reaches a target test accuracy of <math id="S5.SS2.p1.4.m4.1" class="ltx_Math" alttext="75\%" display="inline"><semantics id="S5.SS2.p1.4.m4.1a"><mrow id="S5.SS2.p1.4.m4.1.1" xref="S5.SS2.p1.4.m4.1.1.cmml"><mn id="S5.SS2.p1.4.m4.1.1.2" xref="S5.SS2.p1.4.m4.1.1.2.cmml">75</mn><mo id="S5.SS2.p1.4.m4.1.1.1" xref="S5.SS2.p1.4.m4.1.1.1.cmml">%</mo></mrow><annotation-xml encoding="MathML-Content" id="S5.SS2.p1.4.m4.1b"><apply id="S5.SS2.p1.4.m4.1.1.cmml" xref="S5.SS2.p1.4.m4.1.1"><csymbol cd="latexml" id="S5.SS2.p1.4.m4.1.1.1.cmml" xref="S5.SS2.p1.4.m4.1.1.1">percent</csymbol><cn type="integer" id="S5.SS2.p1.4.m4.1.1.2.cmml" xref="S5.SS2.p1.4.m4.1.1.2">75</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS2.p1.4.m4.1c">75\%</annotation></semantics></math> after almost <math id="S5.SS2.p1.5.m5.1" class="ltx_Math" alttext="30" display="inline"><semantics id="S5.SS2.p1.5.m5.1a"><mn id="S5.SS2.p1.5.m5.1.1" xref="S5.SS2.p1.5.m5.1.1.cmml">30</mn><annotation-xml encoding="MathML-Content" id="S5.SS2.p1.5.m5.1b"><cn type="integer" id="S5.SS2.p1.5.m5.1.1.cmml" xref="S5.SS2.p1.5.m5.1.1">30</cn></annotation-xml><annotation encoding="application/x-tex" id="S5.SS2.p1.5.m5.1c">30</annotation></semantics></math> iterations, while FedAvg and DONE require <math id="S5.SS2.p1.6.m6.1" class="ltx_Math" alttext="200" display="inline"><semantics id="S5.SS2.p1.6.m6.1a"><mn id="S5.SS2.p1.6.m6.1.1" xref="S5.SS2.p1.6.m6.1.1.cmml">200</mn><annotation-xml encoding="MathML-Content" id="S5.SS2.p1.6.m6.1b"><cn type="integer" id="S5.SS2.p1.6.m6.1.1.cmml" xref="S5.SS2.p1.6.m6.1.1">200</cn></annotation-xml><annotation encoding="application/x-tex" id="S5.SS2.p1.6.m6.1c">200</annotation></semantics></math> and <math id="S5.SS2.p1.7.m7.1" class="ltx_Math" alttext="750" display="inline"><semantics id="S5.SS2.p1.7.m7.1a"><mn id="S5.SS2.p1.7.m7.1.1" xref="S5.SS2.p1.7.m7.1.1.cmml">750</mn><annotation-xml encoding="MathML-Content" id="S5.SS2.p1.7.m7.1b"><cn type="integer" id="S5.SS2.p1.7.m7.1.1.cmml" xref="S5.SS2.p1.7.m7.1.1">750</cn></annotation-xml><annotation encoding="application/x-tex" id="S5.SS2.p1.7.m7.1c">750</annotation></semantics></math> iterations to achieve the same target accuracy, respectively. On the other hand, Fed-Sophia with FMNIST dataset requires <math id="S5.SS2.p1.8.m8.1" class="ltx_Math" alttext="200" display="inline"><semantics id="S5.SS2.p1.8.m8.1a"><mn id="S5.SS2.p1.8.m8.1.1" xref="S5.SS2.p1.8.m8.1.1.cmml">200</mn><annotation-xml encoding="MathML-Content" id="S5.SS2.p1.8.m8.1b"><cn type="integer" id="S5.SS2.p1.8.m8.1.1.cmml" xref="S5.SS2.p1.8.m8.1.1">200</cn></annotation-xml><annotation encoding="application/x-tex" id="S5.SS2.p1.8.m8.1c">200</annotation></semantics></math> iterations to converge, while FedAvg and DONE require almost the full number of iterations.</p>
</div>
<figure id="S5.F3" class="ltx_figure">
<div class="ltx_flex_figure">
<div class="ltx_flex_cell ltx_flex_size_1">
<figure id="S5.F3.sf1" class="ltx_figure ltx_figure_panel ltx_align_center"><img src="/html/2406.06655/assets/x6.png" id="S5.F3.sf1.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="140" height="101" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span id="S5.F3.sf1.2.1.1" class="ltx_text" style="font-size:90%;">(a)</span> </span><span id="S5.F3.sf1.3.2" class="ltx_text" style="font-size:90%;">MLP-MNIST</span></figcaption>
</figure>
</div>
<div class="ltx_flex_break"></div>
<div class="ltx_flex_cell ltx_flex_size_1">
<figure id="S5.F3.sf2" class="ltx_figure ltx_figure_panel ltx_align_center"><img src="/html/2406.06655/assets/x7.png" id="S5.F3.sf2.g1" class="ltx_graphics ltx_centering ltx_img_landscape" width="137" height="101" alt="Refer to caption">
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span id="S5.F3.sf2.2.1.1" class="ltx_text" style="font-size:90%;">(b)</span> </span><span id="S5.F3.sf2.3.2" class="ltx_text" style="font-size:90%;">MLP-FMNIST</span></figcaption>
</figure>
</div>
</div>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span id="S5.F3.2.1.1" class="ltx_text" style="font-size:90%;">Figure 3</span>: </span><span id="S5.F3.3.2" class="ltx_text" style="font-size:90%;">Test accuracy for Fed-Sophia against other baselines in terms of the number of total iterations for MNIST and FMNIST datasets using MLP.</span></figcaption>
</figure>
<figure id="S5.T2" class="ltx_table">
<div id="S5.T2.17" class="ltx_inline-block ltx_align_center ltx_transformed_outer" style="width:456.3pt;height:104.6pt;vertical-align:-49.0pt;"><span class="ltx_transformed_inner" style="transform:translate(-12.0pt,1.5pt) scale(0.949996938529903,0.949996938529903) ;">
<figure id="S5.T2.17.17" class="ltx_figure ltx_minipage ltx_align_middle" style="width:867.2pt;">
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_figure"><span id="S5.T2.17.17.18.1.1" class="ltx_text" style="font-size:90%;">TABLE II</span>: </span><span id="S5.T2.17.17.19.2" class="ltx_text" style="font-size:90%;">Computation/communication energy costs and corresponding carbon footprints for MNIST with CNN for target accuracy of 75%.</span></figcaption>
<table id="S5.T2.17.17.17" class="ltx_tabular ltx_guessed_headers ltx_align_middle">
<thead class="ltx_thead">
<tr id="S5.T2.17.17.17.18.1" class="ltx_tr">
<th id="S5.T2.17.17.17.18.1.1" class="ltx_td ltx_align_justify ltx_align_top ltx_th ltx_th_column ltx_border_tt">
<span id="S5.T2.17.17.17.18.1.1.1" class="ltx_inline-block ltx_align_top">
<span id="S5.T2.17.17.17.18.1.1.1.1" class="ltx_p" style="width:91.0pt;">Algorithm</span>
</span>
</th>
<th id="S5.T2.17.17.17.18.1.2" class="ltx_td ltx_align_justify ltx_align_top ltx_th ltx_th_column ltx_border_tt">
<span id="S5.T2.17.17.17.18.1.2.1" class="ltx_inline-block ltx_align_top">
<span id="S5.T2.17.17.17.18.1.2.1.1" class="ltx_p" style="width:119.5pt;">Computation Energy [MJ]</span>
</span>
</th>
<th id="S5.T2.17.17.17.18.1.3" class="ltx_td ltx_align_justify ltx_align_top ltx_th ltx_th_column ltx_border_tt">
<span id="S5.T2.17.17.17.18.1.3.1" class="ltx_inline-block ltx_align_top">
<span id="S5.T2.17.17.17.18.1.3.1.1" class="ltx_p" style="width:119.5pt;">Communication Energy [MJ]</span>
</span>
</th>
<th id="S5.T2.17.17.17.18.1.4" class="ltx_td ltx_align_justify ltx_align_top ltx_th ltx_th_column ltx_border_tt">
<span id="S5.T2.17.17.17.18.1.4.1" class="ltx_inline-block ltx_align_top">
<span id="S5.T2.17.17.17.18.1.4.1.1" class="ltx_p" style="width:130.9pt;">Total Footprint [kg-CO2-eq]</span>
</span>
</th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr id="S5.T2.5.5.5.5" class="ltx_tr">
<td id="S5.T2.5.5.5.5.6" class="ltx_td ltx_align_justify ltx_align_top ltx_border_t">
<span id="S5.T2.5.5.5.5.6.1" class="ltx_inline-block ltx_align_top">
<span id="S5.T2.5.5.5.5.6.1.1" class="ltx_p" style="width:91.0pt;">DONE</span>
</span>
</td>
<td id="S5.T2.2.2.2.2.2" class="ltx_td ltx_align_justify ltx_align_top ltx_border_t">
<span id="S5.T2.2.2.2.2.2.2" class="ltx_inline-block ltx_align_top">
<span id="S5.T2.2.2.2.2.2.2.2" class="ltx_p" style="width:119.5pt;"><math id="S5.T2.1.1.1.1.1.1.1.m1.1" class="ltx_Math" alttext="6170E-4" display="inline"><semantics id="S5.T2.1.1.1.1.1.1.1.m1.1a"><mrow id="S5.T2.1.1.1.1.1.1.1.m1.1.1" xref="S5.T2.1.1.1.1.1.1.1.m1.1.1.cmml"><mrow id="S5.T2.1.1.1.1.1.1.1.m1.1.1.2" xref="S5.T2.1.1.1.1.1.1.1.m1.1.1.2.cmml"><mn id="S5.T2.1.1.1.1.1.1.1.m1.1.1.2.2" xref="S5.T2.1.1.1.1.1.1.1.m1.1.1.2.2.cmml">6170</mn><mo lspace="0em" rspace="0em" id="S5.T2.1.1.1.1.1.1.1.m1.1.1.2.1" xref="S5.T2.1.1.1.1.1.1.1.m1.1.1.2.1.cmml">​</mo><mi id="S5.T2.1.1.1.1.1.1.1.m1.1.1.2.3" xref="S5.T2.1.1.1.1.1.1.1.m1.1.1.2.3.cmml">E</mi></mrow><mo id="S5.T2.1.1.1.1.1.1.1.m1.1.1.1" xref="S5.T2.1.1.1.1.1.1.1.m1.1.1.1.cmml">−</mo><mn id="S5.T2.1.1.1.1.1.1.1.m1.1.1.3" xref="S5.T2.1.1.1.1.1.1.1.m1.1.1.3.cmml">4</mn></mrow><annotation-xml encoding="MathML-Content" id="S5.T2.1.1.1.1.1.1.1.m1.1b"><apply id="S5.T2.1.1.1.1.1.1.1.m1.1.1.cmml" xref="S5.T2.1.1.1.1.1.1.1.m1.1.1"><minus id="S5.T2.1.1.1.1.1.1.1.m1.1.1.1.cmml" xref="S5.T2.1.1.1.1.1.1.1.m1.1.1.1"></minus><apply id="S5.T2.1.1.1.1.1.1.1.m1.1.1.2.cmml" xref="S5.T2.1.1.1.1.1.1.1.m1.1.1.2"><times id="S5.T2.1.1.1.1.1.1.1.m1.1.1.2.1.cmml" xref="S5.T2.1.1.1.1.1.1.1.m1.1.1.2.1"></times><cn type="integer" id="S5.T2.1.1.1.1.1.1.1.m1.1.1.2.2.cmml" xref="S5.T2.1.1.1.1.1.1.1.m1.1.1.2.2">6170</cn><ci id="S5.T2.1.1.1.1.1.1.1.m1.1.1.2.3.cmml" xref="S5.T2.1.1.1.1.1.1.1.m1.1.1.2.3">𝐸</ci></apply><cn type="integer" id="S5.T2.1.1.1.1.1.1.1.m1.1.1.3.cmml" xref="S5.T2.1.1.1.1.1.1.1.m1.1.1.3">4</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.T2.1.1.1.1.1.1.1.m1.1c">6170E-4</annotation></semantics></math>   <svg id="S5.T2.2.2.2.2.2.2.2.pic1" class="ltx_picture" height="7.87" overflow="visible" version="1.1" width="51.18"><g transform="translate(0,7.87) matrix(1 0 0 -1 0 0)" fill="#E17B74" stroke="#000000" stroke-width="0.4pt"><path d="M 0 0 M 0 0 L 0 7.87 L 51.18 7.87 L 51.18 0 Z M 51.18 7.87" style="stroke:none"></path></g></svg></span>
</span>
</td>
<td id="S5.T2.4.4.4.4.4" class="ltx_td ltx_align_justify ltx_align_top ltx_border_t">
<span id="S5.T2.4.4.4.4.4.2" class="ltx_inline-block ltx_align_top">
<span id="S5.T2.4.4.4.4.4.2.2" class="ltx_p" style="width:119.5pt;"><math id="S5.T2.3.3.3.3.3.1.1.m1.1" class="ltx_Math" alttext="153.2" display="inline"><semantics id="S5.T2.3.3.3.3.3.1.1.m1.1a"><mn id="S5.T2.3.3.3.3.3.1.1.m1.1.1" xref="S5.T2.3.3.3.3.3.1.1.m1.1.1.cmml">153.2</mn><annotation-xml encoding="MathML-Content" id="S5.T2.3.3.3.3.3.1.1.m1.1b"><cn type="float" id="S5.T2.3.3.3.3.3.1.1.m1.1.1.cmml" xref="S5.T2.3.3.3.3.3.1.1.m1.1.1">153.2</cn></annotation-xml><annotation encoding="application/x-tex" id="S5.T2.3.3.3.3.3.1.1.m1.1c">153.2</annotation></semantics></math>    <svg id="S5.T2.4.4.4.4.4.2.2.pic1" class="ltx_picture" height="7.87" overflow="visible" version="1.1" width="43.31"><g transform="translate(0,7.87) matrix(1 0 0 -1 0 0)" fill="#0A0AC8" stroke="#000000" stroke-width="0.4pt"><path d="M 0 0 M 0 0 L 0 7.87 L 43.31 7.87 L 43.31 0 Z M 43.31 7.87" style="stroke:none"></path></g></svg></span>
</span>
</td>
<td id="S5.T2.5.5.5.5.5" class="ltx_td ltx_align_justify ltx_align_top ltx_border_t">
<span id="S5.T2.5.5.5.5.5.1" class="ltx_inline-block ltx_align_top">
<span id="S5.T2.5.5.5.5.5.1.1" class="ltx_p" style="width:130.9pt;"><math id="S5.T2.5.5.5.5.5.1.1.m1.1" class="ltx_Math" alttext="1097E+3" display="inline"><semantics id="S5.T2.5.5.5.5.5.1.1.m1.1a"><mrow id="S5.T2.5.5.5.5.5.1.1.m1.1.1" xref="S5.T2.5.5.5.5.5.1.1.m1.1.1.cmml"><mrow id="S5.T2.5.5.5.5.5.1.1.m1.1.1.2" xref="S5.T2.5.5.5.5.5.1.1.m1.1.1.2.cmml"><mn id="S5.T2.5.5.5.5.5.1.1.m1.1.1.2.2" xref="S5.T2.5.5.5.5.5.1.1.m1.1.1.2.2.cmml">1097</mn><mo lspace="0em" rspace="0em" id="S5.T2.5.5.5.5.5.1.1.m1.1.1.2.1" xref="S5.T2.5.5.5.5.5.1.1.m1.1.1.2.1.cmml">​</mo><mi id="S5.T2.5.5.5.5.5.1.1.m1.1.1.2.3" xref="S5.T2.5.5.5.5.5.1.1.m1.1.1.2.3.cmml">E</mi></mrow><mo id="S5.T2.5.5.5.5.5.1.1.m1.1.1.1" xref="S5.T2.5.5.5.5.5.1.1.m1.1.1.1.cmml">+</mo><mn id="S5.T2.5.5.5.5.5.1.1.m1.1.1.3" xref="S5.T2.5.5.5.5.5.1.1.m1.1.1.3.cmml">3</mn></mrow><annotation-xml encoding="MathML-Content" id="S5.T2.5.5.5.5.5.1.1.m1.1b"><apply id="S5.T2.5.5.5.5.5.1.1.m1.1.1.cmml" xref="S5.T2.5.5.5.5.5.1.1.m1.1.1"><plus id="S5.T2.5.5.5.5.5.1.1.m1.1.1.1.cmml" xref="S5.T2.5.5.5.5.5.1.1.m1.1.1.1"></plus><apply id="S5.T2.5.5.5.5.5.1.1.m1.1.1.2.cmml" xref="S5.T2.5.5.5.5.5.1.1.m1.1.1.2"><times id="S5.T2.5.5.5.5.5.1.1.m1.1.1.2.1.cmml" xref="S5.T2.5.5.5.5.5.1.1.m1.1.1.2.1"></times><cn type="integer" id="S5.T2.5.5.5.5.5.1.1.m1.1.1.2.2.cmml" xref="S5.T2.5.5.5.5.5.1.1.m1.1.1.2.2">1097</cn><ci id="S5.T2.5.5.5.5.5.1.1.m1.1.1.2.3.cmml" xref="S5.T2.5.5.5.5.5.1.1.m1.1.1.2.3">𝐸</ci></apply><cn type="integer" id="S5.T2.5.5.5.5.5.1.1.m1.1.1.3.cmml" xref="S5.T2.5.5.5.5.5.1.1.m1.1.1.3">3</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.T2.5.5.5.5.5.1.1.m1.1c">1097E+3</annotation></semantics></math></span>
</span>
</td>
</tr>
<tr id="S5.T2.10.10.10.10" class="ltx_tr">
<td id="S5.T2.10.10.10.10.6" class="ltx_td ltx_align_justify ltx_align_top ltx_border_t">
<span id="S5.T2.10.10.10.10.6.1" class="ltx_inline-block ltx_align_top">
<span id="S5.T2.10.10.10.10.6.1.1" class="ltx_p" style="width:91.0pt;">FedAvg</span>
</span>
</td>
<td id="S5.T2.7.7.7.7.2" class="ltx_td ltx_align_justify ltx_align_top ltx_border_t">
<span id="S5.T2.7.7.7.7.2.2" class="ltx_inline-block ltx_align_top">
<span id="S5.T2.7.7.7.7.2.2.2" class="ltx_p" style="width:119.5pt;"><math id="S5.T2.6.6.6.6.1.1.1.m1.1" class="ltx_Math" alttext="2.2E-4" display="inline"><semantics id="S5.T2.6.6.6.6.1.1.1.m1.1a"><mrow id="S5.T2.6.6.6.6.1.1.1.m1.1.1" xref="S5.T2.6.6.6.6.1.1.1.m1.1.1.cmml"><mrow id="S5.T2.6.6.6.6.1.1.1.m1.1.1.2" xref="S5.T2.6.6.6.6.1.1.1.m1.1.1.2.cmml"><mn id="S5.T2.6.6.6.6.1.1.1.m1.1.1.2.2" xref="S5.T2.6.6.6.6.1.1.1.m1.1.1.2.2.cmml">2.2</mn><mo lspace="0em" rspace="0em" id="S5.T2.6.6.6.6.1.1.1.m1.1.1.2.1" xref="S5.T2.6.6.6.6.1.1.1.m1.1.1.2.1.cmml">​</mo><mi id="S5.T2.6.6.6.6.1.1.1.m1.1.1.2.3" xref="S5.T2.6.6.6.6.1.1.1.m1.1.1.2.3.cmml">E</mi></mrow><mo id="S5.T2.6.6.6.6.1.1.1.m1.1.1.1" xref="S5.T2.6.6.6.6.1.1.1.m1.1.1.1.cmml">−</mo><mn id="S5.T2.6.6.6.6.1.1.1.m1.1.1.3" xref="S5.T2.6.6.6.6.1.1.1.m1.1.1.3.cmml">4</mn></mrow><annotation-xml encoding="MathML-Content" id="S5.T2.6.6.6.6.1.1.1.m1.1b"><apply id="S5.T2.6.6.6.6.1.1.1.m1.1.1.cmml" xref="S5.T2.6.6.6.6.1.1.1.m1.1.1"><minus id="S5.T2.6.6.6.6.1.1.1.m1.1.1.1.cmml" xref="S5.T2.6.6.6.6.1.1.1.m1.1.1.1"></minus><apply id="S5.T2.6.6.6.6.1.1.1.m1.1.1.2.cmml" xref="S5.T2.6.6.6.6.1.1.1.m1.1.1.2"><times id="S5.T2.6.6.6.6.1.1.1.m1.1.1.2.1.cmml" xref="S5.T2.6.6.6.6.1.1.1.m1.1.1.2.1"></times><cn type="float" id="S5.T2.6.6.6.6.1.1.1.m1.1.1.2.2.cmml" xref="S5.T2.6.6.6.6.1.1.1.m1.1.1.2.2">2.2</cn><ci id="S5.T2.6.6.6.6.1.1.1.m1.1.1.2.3.cmml" xref="S5.T2.6.6.6.6.1.1.1.m1.1.1.2.3">𝐸</ci></apply><cn type="integer" id="S5.T2.6.6.6.6.1.1.1.m1.1.1.3.cmml" xref="S5.T2.6.6.6.6.1.1.1.m1.1.1.3">4</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.T2.6.6.6.6.1.1.1.m1.1c">2.2E-4</annotation></semantics></math>      <svg id="S5.T2.7.7.7.7.2.2.2.pic1" class="ltx_picture" height="7.87" overflow="visible" version="1.1" width="3.15"><g transform="translate(0,7.87) matrix(1 0 0 -1 0 0)" fill="#E17B74" stroke="#000000" stroke-width="0.4pt"><path d="M 0 0 M 0 0 L 0 7.87 L 3.15 7.87 L 3.15 0 Z M 3.15 7.87" style="stroke:none"></path></g></svg></span>
</span>
</td>
<td id="S5.T2.9.9.9.9.4" class="ltx_td ltx_align_justify ltx_align_top ltx_border_t">
<span id="S5.T2.9.9.9.9.4.2" class="ltx_inline-block ltx_align_top">
<span id="S5.T2.9.9.9.9.4.2.2" class="ltx_p" style="width:119.5pt;"><math id="S5.T2.8.8.8.8.3.1.1.m1.1" class="ltx_Math" alttext="139.2" display="inline"><semantics id="S5.T2.8.8.8.8.3.1.1.m1.1a"><mn id="S5.T2.8.8.8.8.3.1.1.m1.1.1" xref="S5.T2.8.8.8.8.3.1.1.m1.1.1.cmml">139.2</mn><annotation-xml encoding="MathML-Content" id="S5.T2.8.8.8.8.3.1.1.m1.1b"><cn type="float" id="S5.T2.8.8.8.8.3.1.1.m1.1.1.cmml" xref="S5.T2.8.8.8.8.3.1.1.m1.1.1">139.2</cn></annotation-xml><annotation encoding="application/x-tex" id="S5.T2.8.8.8.8.3.1.1.m1.1c">139.2</annotation></semantics></math>    <svg id="S5.T2.9.9.9.9.4.2.2.pic1" class="ltx_picture" height="7.87" overflow="visible" version="1.1" width="39.37"><g transform="translate(0,7.87) matrix(1 0 0 -1 0 0)" fill="#0A0AC8" stroke="#000000" stroke-width="0.4pt"><path d="M 0 0 M 0 0 L 0 7.87 L 39.37 7.87 L 39.37 0 Z M 39.37 7.87" style="stroke:none"></path></g></svg></span>
</span>
</td>
<td id="S5.T2.10.10.10.10.5" class="ltx_td ltx_align_justify ltx_align_top ltx_border_t">
<span id="S5.T2.10.10.10.10.5.1" class="ltx_inline-block ltx_align_top">
<span id="S5.T2.10.10.10.10.5.1.1" class="ltx_p" style="width:130.9pt;"><math id="S5.T2.10.10.10.10.5.1.1.m1.1" class="ltx_Math" alttext="0.123E+3" display="inline"><semantics id="S5.T2.10.10.10.10.5.1.1.m1.1a"><mrow id="S5.T2.10.10.10.10.5.1.1.m1.1.1" xref="S5.T2.10.10.10.10.5.1.1.m1.1.1.cmml"><mrow id="S5.T2.10.10.10.10.5.1.1.m1.1.1.2" xref="S5.T2.10.10.10.10.5.1.1.m1.1.1.2.cmml"><mn id="S5.T2.10.10.10.10.5.1.1.m1.1.1.2.2" xref="S5.T2.10.10.10.10.5.1.1.m1.1.1.2.2.cmml">0.123</mn><mo lspace="0em" rspace="0em" id="S5.T2.10.10.10.10.5.1.1.m1.1.1.2.1" xref="S5.T2.10.10.10.10.5.1.1.m1.1.1.2.1.cmml">​</mo><mi id="S5.T2.10.10.10.10.5.1.1.m1.1.1.2.3" xref="S5.T2.10.10.10.10.5.1.1.m1.1.1.2.3.cmml">E</mi></mrow><mo id="S5.T2.10.10.10.10.5.1.1.m1.1.1.1" xref="S5.T2.10.10.10.10.5.1.1.m1.1.1.1.cmml">+</mo><mn id="S5.T2.10.10.10.10.5.1.1.m1.1.1.3" xref="S5.T2.10.10.10.10.5.1.1.m1.1.1.3.cmml">3</mn></mrow><annotation-xml encoding="MathML-Content" id="S5.T2.10.10.10.10.5.1.1.m1.1b"><apply id="S5.T2.10.10.10.10.5.1.1.m1.1.1.cmml" xref="S5.T2.10.10.10.10.5.1.1.m1.1.1"><plus id="S5.T2.10.10.10.10.5.1.1.m1.1.1.1.cmml" xref="S5.T2.10.10.10.10.5.1.1.m1.1.1.1"></plus><apply id="S5.T2.10.10.10.10.5.1.1.m1.1.1.2.cmml" xref="S5.T2.10.10.10.10.5.1.1.m1.1.1.2"><times id="S5.T2.10.10.10.10.5.1.1.m1.1.1.2.1.cmml" xref="S5.T2.10.10.10.10.5.1.1.m1.1.1.2.1"></times><cn type="float" id="S5.T2.10.10.10.10.5.1.1.m1.1.1.2.2.cmml" xref="S5.T2.10.10.10.10.5.1.1.m1.1.1.2.2">0.123</cn><ci id="S5.T2.10.10.10.10.5.1.1.m1.1.1.2.3.cmml" xref="S5.T2.10.10.10.10.5.1.1.m1.1.1.2.3">𝐸</ci></apply><cn type="integer" id="S5.T2.10.10.10.10.5.1.1.m1.1.1.3.cmml" xref="S5.T2.10.10.10.10.5.1.1.m1.1.1.3">3</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.T2.10.10.10.10.5.1.1.m1.1c">0.123E+3</annotation></semantics></math></span>
</span>
</td>
</tr>
<tr id="S5.T2.15.15.15.15" class="ltx_tr">
<td id="S5.T2.15.15.15.15.6" class="ltx_td ltx_align_justify ltx_align_top ltx_border_t">
<span id="S5.T2.15.15.15.15.6.1" class="ltx_inline-block ltx_align_top">
<span id="S5.T2.15.15.15.15.6.1.1" class="ltx_p" style="width:91.0pt;">Fed-Sophia</span>
</span>
</td>
<td id="S5.T2.12.12.12.12.2" class="ltx_td ltx_align_justify ltx_align_top ltx_border_t">
<span id="S5.T2.12.12.12.12.2.2" class="ltx_inline-block ltx_align_top">
<span id="S5.T2.12.12.12.12.2.2.2" class="ltx_p" style="width:119.5pt;"><math id="S5.T2.11.11.11.11.1.1.1.m1.1" class="ltx_Math" alttext="1.4E-4" display="inline"><semantics id="S5.T2.11.11.11.11.1.1.1.m1.1a"><mrow id="S5.T2.11.11.11.11.1.1.1.m1.1.1" xref="S5.T2.11.11.11.11.1.1.1.m1.1.1.cmml"><mrow id="S5.T2.11.11.11.11.1.1.1.m1.1.1.2" xref="S5.T2.11.11.11.11.1.1.1.m1.1.1.2.cmml"><mn id="S5.T2.11.11.11.11.1.1.1.m1.1.1.2.2" xref="S5.T2.11.11.11.11.1.1.1.m1.1.1.2.2.cmml">1.4</mn><mo lspace="0em" rspace="0em" id="S5.T2.11.11.11.11.1.1.1.m1.1.1.2.1" xref="S5.T2.11.11.11.11.1.1.1.m1.1.1.2.1.cmml">​</mo><mi id="S5.T2.11.11.11.11.1.1.1.m1.1.1.2.3" xref="S5.T2.11.11.11.11.1.1.1.m1.1.1.2.3.cmml">E</mi></mrow><mo id="S5.T2.11.11.11.11.1.1.1.m1.1.1.1" xref="S5.T2.11.11.11.11.1.1.1.m1.1.1.1.cmml">−</mo><mn id="S5.T2.11.11.11.11.1.1.1.m1.1.1.3" xref="S5.T2.11.11.11.11.1.1.1.m1.1.1.3.cmml">4</mn></mrow><annotation-xml encoding="MathML-Content" id="S5.T2.11.11.11.11.1.1.1.m1.1b"><apply id="S5.T2.11.11.11.11.1.1.1.m1.1.1.cmml" xref="S5.T2.11.11.11.11.1.1.1.m1.1.1"><minus id="S5.T2.11.11.11.11.1.1.1.m1.1.1.1.cmml" xref="S5.T2.11.11.11.11.1.1.1.m1.1.1.1"></minus><apply id="S5.T2.11.11.11.11.1.1.1.m1.1.1.2.cmml" xref="S5.T2.11.11.11.11.1.1.1.m1.1.1.2"><times id="S5.T2.11.11.11.11.1.1.1.m1.1.1.2.1.cmml" xref="S5.T2.11.11.11.11.1.1.1.m1.1.1.2.1"></times><cn type="float" id="S5.T2.11.11.11.11.1.1.1.m1.1.1.2.2.cmml" xref="S5.T2.11.11.11.11.1.1.1.m1.1.1.2.2">1.4</cn><ci id="S5.T2.11.11.11.11.1.1.1.m1.1.1.2.3.cmml" xref="S5.T2.11.11.11.11.1.1.1.m1.1.1.2.3">𝐸</ci></apply><cn type="integer" id="S5.T2.11.11.11.11.1.1.1.m1.1.1.3.cmml" xref="S5.T2.11.11.11.11.1.1.1.m1.1.1.3">4</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.T2.11.11.11.11.1.1.1.m1.1c">1.4E-4</annotation></semantics></math>      <svg id="S5.T2.12.12.12.12.2.2.2.pic1" class="ltx_picture" height="7.87" overflow="visible" version="1.1" width="1.97"><g transform="translate(0,7.87) matrix(1 0 0 -1 0 0)" fill="#E17B74" stroke="#000000" stroke-width="0.4pt"><path d="M 0 0 M 0 0 L 0 7.87 L 1.97 7.87 L 1.97 0 Z M 1.97 7.87" style="stroke:none"></path></g></svg></span>
</span>
</td>
<td id="S5.T2.14.14.14.14.4" class="ltx_td ltx_align_justify ltx_align_top ltx_border_t">
<span id="S5.T2.14.14.14.14.4.2" class="ltx_inline-block ltx_align_top">
<span id="S5.T2.14.14.14.14.4.2.2" class="ltx_p" style="width:119.5pt;"><math id="S5.T2.13.13.13.13.3.1.1.m1.1" class="ltx_Math" alttext="27.8" display="inline"><semantics id="S5.T2.13.13.13.13.3.1.1.m1.1a"><mn id="S5.T2.13.13.13.13.3.1.1.m1.1.1" xref="S5.T2.13.13.13.13.3.1.1.m1.1.1.cmml">27.8</mn><annotation-xml encoding="MathML-Content" id="S5.T2.13.13.13.13.3.1.1.m1.1b"><cn type="float" id="S5.T2.13.13.13.13.3.1.1.m1.1.1.cmml" xref="S5.T2.13.13.13.13.3.1.1.m1.1.1">27.8</cn></annotation-xml><annotation encoding="application/x-tex" id="S5.T2.13.13.13.13.3.1.1.m1.1c">27.8</annotation></semantics></math>     <svg id="S5.T2.14.14.14.14.4.2.2.pic1" class="ltx_picture" height="7.87" overflow="visible" version="1.1" width="7.87"><g transform="translate(0,7.87) matrix(1 0 0 -1 0 0)" fill="#0A0AC8" stroke="#000000" stroke-width="0.4pt"><path d="M 0 0 M 0 0 L 0 7.87 L 7.87 7.87 L 7.87 0 Z M 7.87 7.87" style="stroke:none"></path></g></svg></span>
</span>
</td>
<td id="S5.T2.15.15.15.15.5" class="ltx_td ltx_align_justify ltx_align_top ltx_border_t">
<span id="S5.T2.15.15.15.15.5.1" class="ltx_inline-block ltx_align_top">
<span id="S5.T2.15.15.15.15.5.1.1" class="ltx_p" style="width:130.9pt;"><math id="S5.T2.15.15.15.15.5.1.1.m1.1" class="ltx_Math" alttext="0.004E+3" display="inline"><semantics id="S5.T2.15.15.15.15.5.1.1.m1.1a"><mrow id="S5.T2.15.15.15.15.5.1.1.m1.1.1" xref="S5.T2.15.15.15.15.5.1.1.m1.1.1.cmml"><mrow id="S5.T2.15.15.15.15.5.1.1.m1.1.1.2" xref="S5.T2.15.15.15.15.5.1.1.m1.1.1.2.cmml"><mn id="S5.T2.15.15.15.15.5.1.1.m1.1.1.2.2" xref="S5.T2.15.15.15.15.5.1.1.m1.1.1.2.2.cmml">0.004</mn><mo lspace="0em" rspace="0em" id="S5.T2.15.15.15.15.5.1.1.m1.1.1.2.1" xref="S5.T2.15.15.15.15.5.1.1.m1.1.1.2.1.cmml">​</mo><mi id="S5.T2.15.15.15.15.5.1.1.m1.1.1.2.3" xref="S5.T2.15.15.15.15.5.1.1.m1.1.1.2.3.cmml">E</mi></mrow><mo id="S5.T2.15.15.15.15.5.1.1.m1.1.1.1" xref="S5.T2.15.15.15.15.5.1.1.m1.1.1.1.cmml">+</mo><mn id="S5.T2.15.15.15.15.5.1.1.m1.1.1.3" xref="S5.T2.15.15.15.15.5.1.1.m1.1.1.3.cmml">3</mn></mrow><annotation-xml encoding="MathML-Content" id="S5.T2.15.15.15.15.5.1.1.m1.1b"><apply id="S5.T2.15.15.15.15.5.1.1.m1.1.1.cmml" xref="S5.T2.15.15.15.15.5.1.1.m1.1.1"><plus id="S5.T2.15.15.15.15.5.1.1.m1.1.1.1.cmml" xref="S5.T2.15.15.15.15.5.1.1.m1.1.1.1"></plus><apply id="S5.T2.15.15.15.15.5.1.1.m1.1.1.2.cmml" xref="S5.T2.15.15.15.15.5.1.1.m1.1.1.2"><times id="S5.T2.15.15.15.15.5.1.1.m1.1.1.2.1.cmml" xref="S5.T2.15.15.15.15.5.1.1.m1.1.1.2.1"></times><cn type="float" id="S5.T2.15.15.15.15.5.1.1.m1.1.1.2.2.cmml" xref="S5.T2.15.15.15.15.5.1.1.m1.1.1.2.2">0.004</cn><ci id="S5.T2.15.15.15.15.5.1.1.m1.1.1.2.3.cmml" xref="S5.T2.15.15.15.15.5.1.1.m1.1.1.2.3">𝐸</ci></apply><cn type="integer" id="S5.T2.15.15.15.15.5.1.1.m1.1.1.3.cmml" xref="S5.T2.15.15.15.15.5.1.1.m1.1.1.3">3</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.T2.15.15.15.15.5.1.1.m1.1c">0.004E+3</annotation></semantics></math></span>
</span>
</td>
</tr>
<tr id="S5.T2.17.17.17.17" class="ltx_tr">
<td id="S5.T2.17.17.17.17.3" class="ltx_td ltx_align_top ltx_border_bb ltx_border_t"></td>
<td id="S5.T2.16.16.16.16.1" class="ltx_td ltx_align_justify ltx_align_top ltx_border_bb ltx_border_t">
<span id="S5.T2.16.16.16.16.1.1" class="ltx_inline-block ltx_align_top">
<span id="S5.T2.16.16.16.16.1.1.1" class="ltx_p" style="width:119.5pt;">                <svg id="S5.T2.16.16.16.16.1.1.1.pic1" class="ltx_picture" height="14.24" overflow="visible" version="1.1" width="83.46"><g transform="translate(0,14.24) matrix(1 0 0 -1 0 0) translate(-1.53,0) translate(0,11.19)" fill="#000000" stroke="#000000" stroke-width="0.4pt"><g stroke="#000000" fill="#000000" color="#000000"><path d="M 7.87 0 L 78.74 0" style="fill:none"></path></g><g stroke="#000000" fill="#000000" color="#000000"><path d="M 7.87 -2.77 L 7.87 2.77" style="fill:none"></path></g><g transform="matrix(1.0 0.0 0.0 1.0 6.14 -6.58)" fill="#000000" stroke="#000000" color="#000000"><foreignObject width="3.46" height="4.46" transform="matrix(1 0 0 -1 0 16.6)" overflow="visible"><math id="S5.T2.16.16.16.16.1.1.1.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.m1.1" class="ltx_Math" alttext="0" display="inline"><semantics id="S5.T2.16.16.16.16.1.1.1.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.m1.1a"><mn mathsize="50%" id="S5.T2.16.16.16.16.1.1.1.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.m1.1.1" xref="S5.T2.16.16.16.16.1.1.1.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.m1.1.1.cmml">0</mn><annotation-xml encoding="MathML-Content" id="S5.T2.16.16.16.16.1.1.1.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.m1.1b"><cn type="integer" id="S5.T2.16.16.16.16.1.1.1.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.m1.1.1.cmml" xref="S5.T2.16.16.16.16.1.1.1.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.m1.1.1">0</cn></annotation-xml></semantics></math></foreignObject></g><g stroke="#000000" fill="#000000" color="#000000"><path d="M 39.37 -2.77 L 39.37 2.77" style="fill:none"></path></g><g transform="matrix(1.0 0.0 0.0 1.0 33.8 -6.58)" fill="#000000" stroke="#000000" color="#000000"><foreignObject width="11.15" height="4.46" transform="matrix(1 0 0 -1 0 16.6)" overflow="visible"><math id="S5.T2.16.16.16.16.1.1.1.pic1.2.2.2.2.2.2.2.2.2.2.2.2.1.1.1.1.1.1.1.1.1.1.1.1.m1.1" class="ltx_Math" alttext="0.4" display="inline"><semantics id="S5.T2.16.16.16.16.1.1.1.pic1.2.2.2.2.2.2.2.2.2.2.2.2.1.1.1.1.1.1.1.1.1.1.1.1.m1.1a"><mn mathsize="50%" id="S5.T2.16.16.16.16.1.1.1.pic1.2.2.2.2.2.2.2.2.2.2.2.2.1.1.1.1.1.1.1.1.1.1.1.1.m1.1.1" xref="S5.T2.16.16.16.16.1.1.1.pic1.2.2.2.2.2.2.2.2.2.2.2.2.1.1.1.1.1.1.1.1.1.1.1.1.m1.1.1.cmml">0.4</mn><annotation-xml encoding="MathML-Content" id="S5.T2.16.16.16.16.1.1.1.pic1.2.2.2.2.2.2.2.2.2.2.2.2.1.1.1.1.1.1.1.1.1.1.1.1.m1.1b"><cn type="float" id="S5.T2.16.16.16.16.1.1.1.pic1.2.2.2.2.2.2.2.2.2.2.2.2.1.1.1.1.1.1.1.1.1.1.1.1.m1.1.1.cmml" xref="S5.T2.16.16.16.16.1.1.1.pic1.2.2.2.2.2.2.2.2.2.2.2.2.1.1.1.1.1.1.1.1.1.1.1.1.m1.1.1">0.4</cn></annotation-xml><annotation encoding="application/x-tex" id="S5.T2.16.16.16.16.1.1.1.pic1.2.2.2.2.2.2.2.2.2.2.2.2.1.1.1.1.1.1.1.1.1.1.1.1.m1.1c">0.4</annotation></semantics></math></foreignObject></g><g stroke="#000000" fill="#000000" color="#000000"><path d="M 74.8 -2.77 L 74.8 2.77" style="fill:none"></path></g><g transform="matrix(1.0 0.0 0.0 1.0 69.23 -6.58)" fill="#000000" stroke="#000000" color="#000000"><foreignObject width="11.15" height="4.46" transform="matrix(1 0 0 -1 0 16.6)" overflow="visible"><math id="S5.T2.16.16.16.16.1.1.1.pic1.3.3.3.3.3.3.3.3.3.3.3.3.1.1.1.1.1.1.1.1.1.1.1.1.m1.1" class="ltx_Math" alttext="0.8" display="inline"><semantics id="S5.T2.16.16.16.16.1.1.1.pic1.3.3.3.3.3.3.3.3.3.3.3.3.1.1.1.1.1.1.1.1.1.1.1.1.m1.1a"><mn mathsize="50%" id="S5.T2.16.16.16.16.1.1.1.pic1.3.3.3.3.3.3.3.3.3.3.3.3.1.1.1.1.1.1.1.1.1.1.1.1.m1.1.1" xref="S5.T2.16.16.16.16.1.1.1.pic1.3.3.3.3.3.3.3.3.3.3.3.3.1.1.1.1.1.1.1.1.1.1.1.1.m1.1.1.cmml">0.8</mn><annotation-xml encoding="MathML-Content" id="S5.T2.16.16.16.16.1.1.1.pic1.3.3.3.3.3.3.3.3.3.3.3.3.1.1.1.1.1.1.1.1.1.1.1.1.m1.1b"><cn type="float" id="S5.T2.16.16.16.16.1.1.1.pic1.3.3.3.3.3.3.3.3.3.3.3.3.1.1.1.1.1.1.1.1.1.1.1.1.m1.1.1.cmml" xref="S5.T2.16.16.16.16.1.1.1.pic1.3.3.3.3.3.3.3.3.3.3.3.3.1.1.1.1.1.1.1.1.1.1.1.1.m1.1.1">0.8</cn></annotation-xml><annotation encoding="application/x-tex" id="S5.T2.16.16.16.16.1.1.1.pic1.3.3.3.3.3.3.3.3.3.3.3.3.1.1.1.1.1.1.1.1.1.1.1.1.m1.1c">0.8</annotation></semantics></math></foreignObject></g></g></svg></span>
</span>
</td>
<td id="S5.T2.17.17.17.17.2" class="ltx_td ltx_align_justify ltx_align_top ltx_border_bb ltx_border_t">
<span id="S5.T2.17.17.17.17.2.1" class="ltx_inline-block ltx_align_top">
<span id="S5.T2.17.17.17.17.2.1.1" class="ltx_p" style="width:119.5pt;">          <svg id="S5.T2.17.17.17.17.2.1.1.pic1" class="ltx_picture" height="14.24" overflow="visible" version="1.1" width="71.26"><g transform="translate(0,14.24) matrix(1 0 0 -1 0 0) translate(-13.34,0) translate(0,11.19)" fill="#000000" stroke="#000000" stroke-width="0.4pt"><g stroke="#000000" fill="#000000" color="#000000"><path d="M 19.69 0 L 74.8 0" style="fill:none"></path></g><g stroke="#000000" fill="#000000" color="#000000"><path d="M 19.69 -2.77 L 19.69 2.77" style="fill:none"></path></g><g transform="matrix(1.0 0.0 0.0 1.0 17.96 -6.58)" fill="#000000" stroke="#000000" color="#000000"><foreignObject width="3.46" height="4.46" transform="matrix(1 0 0 -1 0 16.6)" overflow="visible"><math id="S5.T2.17.17.17.17.2.1.1.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.m1.1" class="ltx_Math" alttext="0" display="inline"><semantics id="S5.T2.17.17.17.17.2.1.1.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.m1.1a"><mn mathsize="50%" id="S5.T2.17.17.17.17.2.1.1.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.m1.1.1" xref="S5.T2.17.17.17.17.2.1.1.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.m1.1.1.cmml">0</mn><annotation-xml encoding="MathML-Content" id="S5.T2.17.17.17.17.2.1.1.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.m1.1b"><cn type="integer" id="S5.T2.17.17.17.17.2.1.1.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.m1.1.1.cmml" xref="S5.T2.17.17.17.17.2.1.1.pic1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.1.m1.1.1">0</cn></annotation-xml></semantics></math></foreignObject></g><g stroke="#000000" fill="#000000" color="#000000"><path d="M 47.24 -2.77 L 47.24 2.77" style="fill:none"></path></g><g transform="matrix(1.0 0.0 0.0 1.0 42.06 -6.58)" fill="#000000" stroke="#000000" color="#000000"><foreignObject width="10.38" height="4.46" transform="matrix(1 0 0 -1 0 16.6)" overflow="visible"><math id="S5.T2.17.17.17.17.2.1.1.pic1.2.2.2.2.2.2.2.2.2.2.2.2.1.1.1.1.1.1.1.1.1.1.1.1.m1.1" class="ltx_Math" alttext="100" display="inline"><semantics id="S5.T2.17.17.17.17.2.1.1.pic1.2.2.2.2.2.2.2.2.2.2.2.2.1.1.1.1.1.1.1.1.1.1.1.1.m1.1a"><mn mathsize="50%" id="S5.T2.17.17.17.17.2.1.1.pic1.2.2.2.2.2.2.2.2.2.2.2.2.1.1.1.1.1.1.1.1.1.1.1.1.m1.1.1" xref="S5.T2.17.17.17.17.2.1.1.pic1.2.2.2.2.2.2.2.2.2.2.2.2.1.1.1.1.1.1.1.1.1.1.1.1.m1.1.1.cmml">100</mn><annotation-xml encoding="MathML-Content" id="S5.T2.17.17.17.17.2.1.1.pic1.2.2.2.2.2.2.2.2.2.2.2.2.1.1.1.1.1.1.1.1.1.1.1.1.m1.1b"><cn type="integer" id="S5.T2.17.17.17.17.2.1.1.pic1.2.2.2.2.2.2.2.2.2.2.2.2.1.1.1.1.1.1.1.1.1.1.1.1.m1.1.1.cmml" xref="S5.T2.17.17.17.17.2.1.1.pic1.2.2.2.2.2.2.2.2.2.2.2.2.1.1.1.1.1.1.1.1.1.1.1.1.m1.1.1">100</cn></annotation-xml><annotation encoding="application/x-tex" id="S5.T2.17.17.17.17.2.1.1.pic1.2.2.2.2.2.2.2.2.2.2.2.2.1.1.1.1.1.1.1.1.1.1.1.1.m1.1c">100</annotation></semantics></math></foreignObject></g><g stroke="#000000" fill="#000000" color="#000000"><path d="M 74.8 -2.77 L 74.8 2.77" style="fill:none"></path></g><g transform="matrix(1.0 0.0 0.0 1.0 69.61 -6.58)" fill="#000000" stroke="#000000" color="#000000"><foreignObject width="10.38" height="4.46" transform="matrix(1 0 0 -1 0 16.6)" overflow="visible"><math id="S5.T2.17.17.17.17.2.1.1.pic1.3.3.3.3.3.3.3.3.3.3.3.3.1.1.1.1.1.1.1.1.1.1.1.1.m1.1" class="ltx_Math" alttext="200" display="inline"><semantics id="S5.T2.17.17.17.17.2.1.1.pic1.3.3.3.3.3.3.3.3.3.3.3.3.1.1.1.1.1.1.1.1.1.1.1.1.m1.1a"><mn mathsize="50%" id="S5.T2.17.17.17.17.2.1.1.pic1.3.3.3.3.3.3.3.3.3.3.3.3.1.1.1.1.1.1.1.1.1.1.1.1.m1.1.1" xref="S5.T2.17.17.17.17.2.1.1.pic1.3.3.3.3.3.3.3.3.3.3.3.3.1.1.1.1.1.1.1.1.1.1.1.1.m1.1.1.cmml">200</mn><annotation-xml encoding="MathML-Content" id="S5.T2.17.17.17.17.2.1.1.pic1.3.3.3.3.3.3.3.3.3.3.3.3.1.1.1.1.1.1.1.1.1.1.1.1.m1.1b"><cn type="integer" id="S5.T2.17.17.17.17.2.1.1.pic1.3.3.3.3.3.3.3.3.3.3.3.3.1.1.1.1.1.1.1.1.1.1.1.1.m1.1.1.cmml" xref="S5.T2.17.17.17.17.2.1.1.pic1.3.3.3.3.3.3.3.3.3.3.3.3.1.1.1.1.1.1.1.1.1.1.1.1.m1.1.1">200</cn></annotation-xml><annotation encoding="application/x-tex" id="S5.T2.17.17.17.17.2.1.1.pic1.3.3.3.3.3.3.3.3.3.3.3.3.1.1.1.1.1.1.1.1.1.1.1.1.m1.1c">200</annotation></semantics></math></foreignObject></g></g></svg></span>
</span>
</td>
<td id="S5.T2.17.17.17.17.4" class="ltx_td ltx_align_justify ltx_align_top ltx_border_bb ltx_border_t"></td>
</tr>
</tbody>
</table>
</figure>
</span></div>
</figure>
</section>
<section id="S5.SS3" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection"><span id="S5.SS3.4.1.1" class="ltx_text">V-C</span> </span><span id="S5.SS3.5.2" class="ltx_text ltx_font_italic">Effect of the Hyperparameters</span>
</h3>

<div id="S5.SS3.p1" class="ltx_para">
<p id="S5.SS3.p1.3" class="ltx_p">In this subsection, we study the effect of the learning rate <math id="S5.SS3.p1.1.m1.1" class="ltx_Math" alttext="(\eta)" display="inline"><semantics id="S5.SS3.p1.1.m1.1a"><mrow id="S5.SS3.p1.1.m1.1.2.2"><mo stretchy="false" id="S5.SS3.p1.1.m1.1.2.2.1">(</mo><mi id="S5.SS3.p1.1.m1.1.1" xref="S5.SS3.p1.1.m1.1.1.cmml">η</mi><mo stretchy="false" id="S5.SS3.p1.1.m1.1.2.2.2">)</mo></mrow><annotation-xml encoding="MathML-Content" id="S5.SS3.p1.1.m1.1b"><ci id="S5.SS3.p1.1.m1.1.1.cmml" xref="S5.SS3.p1.1.m1.1.1">𝜂</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.SS3.p1.1.m1.1c">(\eta)</annotation></semantics></math> and the number of local iterations <math id="S5.SS3.p1.2.m2.1" class="ltx_Math" alttext="(J)" display="inline"><semantics id="S5.SS3.p1.2.m2.1a"><mrow id="S5.SS3.p1.2.m2.1.2.2"><mo stretchy="false" id="S5.SS3.p1.2.m2.1.2.2.1">(</mo><mi id="S5.SS3.p1.2.m2.1.1" xref="S5.SS3.p1.2.m2.1.1.cmml">J</mi><mo stretchy="false" id="S5.SS3.p1.2.m2.1.2.2.2">)</mo></mrow><annotation-xml encoding="MathML-Content" id="S5.SS3.p1.2.m2.1b"><ci id="S5.SS3.p1.2.m2.1.1.cmml" xref="S5.SS3.p1.2.m2.1.1">𝐽</ci></annotation-xml><annotation encoding="application/x-tex" id="S5.SS3.p1.2.m2.1c">(J)</annotation></semantics></math> on the performance of Fed-Sophia. We fix <math id="S5.SS3.p1.3.m3.1" class="ltx_Math" alttext="J=10" display="inline"><semantics id="S5.SS3.p1.3.m3.1a"><mrow id="S5.SS3.p1.3.m3.1.1" xref="S5.SS3.p1.3.m3.1.1.cmml"><mi id="S5.SS3.p1.3.m3.1.1.2" xref="S5.SS3.p1.3.m3.1.1.2.cmml">J</mi><mo id="S5.SS3.p1.3.m3.1.1.1" xref="S5.SS3.p1.3.m3.1.1.1.cmml">=</mo><mn id="S5.SS3.p1.3.m3.1.1.3" xref="S5.SS3.p1.3.m3.1.1.3.cmml">10</mn></mrow><annotation-xml encoding="MathML-Content" id="S5.SS3.p1.3.m3.1b"><apply id="S5.SS3.p1.3.m3.1.1.cmml" xref="S5.SS3.p1.3.m3.1.1"><eq id="S5.SS3.p1.3.m3.1.1.1.cmml" xref="S5.SS3.p1.3.m3.1.1.1"></eq><ci id="S5.SS3.p1.3.m3.1.1.2.cmml" xref="S5.SS3.p1.3.m3.1.1.2">𝐽</ci><cn type="integer" id="S5.SS3.p1.3.m3.1.1.3.cmml" xref="S5.SS3.p1.3.m3.1.1.3">10</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S5.SS3.p1.3.m3.1c">J=10</annotation></semantics></math> and experiment with different learning rates for the Fashion MNIST dataset. The test accuracy for the three different values of the learning rate is summarized in Table <a href="#S5.T1" title="TABLE I ‣ V-A Experimental Settings ‣ V Numerical Results ‣ Fed-Sophia: A Communication-Efficient Second-Order Federated Learning Algorithm Identify applicable funding agency here. If none, delete this." class="ltx_ref"><span class="ltx_text ltx_ref_tag">I</span></a>. Next, we study the effect of the local iterations to see if it is worth adding more computational overhead to achieve some performance gain. As shown in Table <a href="#S5.T1" title="TABLE I ‣ V-A Experimental Settings ‣ V Numerical Results ‣ Fed-Sophia: A Communication-Efficient Second-Order Federated Learning Algorithm Identify applicable funding agency here. If none, delete this." class="ltx_ref"><span class="ltx_text ltx_ref_tag">I</span></a>, as we increase the local number of iterations, Fed-Sophia gains a reasonable performance. It is also clear that the performance gain between 5 and 10 local iterations is minimal.</p>
</div>
</section>
<section id="S5.SS4" class="ltx_subsection">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection"><span id="S5.SS4.4.1.1" class="ltx_text">V-D</span> </span><span id="S5.SS4.5.2" class="ltx_text ltx_font_italic">Energy-Efficiency and Carbon Footprint</span>
</h3>

<div id="S5.SS4.p1" class="ltx_para">
<p id="S5.SS4.p1.1" class="ltx_p">As shown in Table <a href="#S5.T2" title="TABLE II ‣ V-B Performance Comparison ‣ V Numerical Results ‣ Fed-Sophia: A Communication-Efficient Second-Order Federated Learning Algorithm Identify applicable funding agency here. If none, delete this." class="ltx_ref"><span class="ltx_text ltx_ref_tag">II</span></a>, Fed-Sophia outperforms DONE and FedAvg in terms of computation energy consumption for a target test accuracy of 75% using a CNN model for the MNIST dataset. Furthermore, DONE consumes up to <math id="S5.SS4.p1.1.m1.1" class="ltx_math_unparsed" alttext="4000\times" display="inline"><semantics id="S5.SS4.p1.1.m1.1a"><mrow id="S5.SS4.p1.1.m1.1b"><mn id="S5.SS4.p1.1.m1.1.1">4000</mn><mo lspace="0.222em" id="S5.SS4.p1.1.m1.1.2">×</mo></mrow><annotation encoding="application/x-tex" id="S5.SS4.p1.1.m1.1c">4000\times</annotation></semantics></math> computational power than Fed-Sophia. Fed-Sophia requires almost half of the computational energy needed for FedAvg. On the other hand, the communication energy for Fed-Sophia is less than the other two baselines by a large factor. Fed-Sophia only requires almost 20% of the needed communication energy for the closest baseline, i.e., FedAvg. Therefore, the total footprint for Fed-Sophia is minimal, which proves the communication and computation efficiency of our proposed method compared to the other two baselines.</p>
</div>
</section>
</section>
<section id="S6" class="ltx_section">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">VI </span><span id="S6.1.1" class="ltx_text ltx_font_smallcaps">Conclusion</span>
</h2>

<div id="S6.p1" class="ltx_para">
<p id="S6.p1.1" class="ltx_p">In this paper, we presented Fed-Sophia, a scalable and second-order method for FL. Fed-Sophia is a computation and communication-efficient method that leverages the curvature information of the loss function by estimating the diagonal of the Hessian. The update is the moving average of the gradient scaled by the inverse of the estimated diagonal Hessian. Furthermore, Fed-Sophia mitigates the effect of inaccurate entries of the Hessian by augmenting the update into a clipping operation, guarding against misleading curvature information. Our experiments showed that the proposed method outperforms other baselines on image classification tasks.</p>
</div>
</section>
<section id="Sx1" class="ltx_section">
<h2 class="ltx_title ltx_font_smallcaps ltx_title_section">Acknowledgments</h2>

<div id="Sx1.p1" class="ltx_para">
<p id="Sx1.p1.1" class="ltx_p">This work is partially supported by the European Commission through Grant no. 101095363 (Horizon Europe SNS JU ADROIT6G project), Grant no. 101139266 (6G-INTENSE project), and the Academy of Finland, 6G Flagship program (Grant no. 346208).</p>
</div>
</section>
<section id="bib" class="ltx_bibliography">
<h2 class="ltx_title ltx_title_bibliography">References</h2>

<ul class="ltx_biblist">
<li id="bib.bib1" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[1]</span>
<span class="ltx_bibblock">
B. McMahan, E. Moore, D. Ramage, S. Hampson, and B. A. y Arcas, “Communication-efficient learning of deep networks from decentralized data,” in <em id="bib.bib1.1.1" class="ltx_emph ltx_font_italic">Artificial intelligence and statistics</em>.   PMLR, 2017, pp. 1273–1282.

</span>
</li>
<li id="bib.bib2" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[2]</span>
<span class="ltx_bibblock">
P. Kairouz <em id="bib.bib2.1.1" class="ltx_emph ltx_font_italic">et al.</em>, “Advances and open problems in federated learning,” <em id="bib.bib2.2.2" class="ltx_emph ltx_font_italic">Foundations and Trends® in Machine Learning</em>, vol. 14, no. 1–2, pp. 1–210, 2021.

</span>
</li>
<li id="bib.bib3" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[3]</span>
<span class="ltx_bibblock">
P. Qi, D. Chiaro, A. Guzzo, M. Ianni, G. Fortino, and F. Piccialli, “Model aggregation techniques in federated learning: A comprehensive survey,” <em id="bib.bib3.1.1" class="ltx_emph ltx_font_italic">Future Generation Computer Systems</em>, 2023.

</span>
</li>
<li id="bib.bib4" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[4]</span>
<span class="ltx_bibblock">
S. P. Boyd and L. Vandenberghe, <em id="bib.bib4.1.1" class="ltx_emph ltx_font_italic">Convex optimization</em>.   Cambridge University Press, 2004.

</span>
</li>
<li id="bib.bib5" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[5]</span>
<span class="ltx_bibblock">
S. Reddi, Z. Charles, M. Zaheer, Z. Garrett, K. Rush, J. Konečnỳ, S. Kumar, and H. B. McMahan, “Adaptive federated optimization,” <em id="bib.bib5.1.1" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:2003.00295</em>, 2020.

</span>
</li>
<li id="bib.bib6" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[6]</span>
<span class="ltx_bibblock">
J. Duchi, E. Hazan, and Y. Singer, “Adaptive subgradient methods for online learning and stochastic optimization.” <em id="bib.bib6.1.1" class="ltx_emph ltx_font_italic">Journal of machine learning research</em>, vol. 12, no. 7, 2011.

</span>
</li>
<li id="bib.bib7" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[7]</span>
<span class="ltx_bibblock">
D. P. Kingma and J. Ba, “Adam: A method for stochastic optimization,” <em id="bib.bib7.1.1" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:1412.6980</em>, 2014.

</span>
</li>
<li id="bib.bib8" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[8]</span>
<span class="ltx_bibblock">
S. P. Karimireddy, S. Kale, M. Mohri, S. Reddi, S. Stich, and A. T. Suresh, “Scaffold: Stochastic controlled averaging for federated learning,” in <em id="bib.bib8.1.1" class="ltx_emph ltx_font_italic">International conference on machine learning</em>.   PMLR, 2020, pp. 5132–5143.

</span>
</li>
<li id="bib.bib9" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[9]</span>
<span class="ltx_bibblock">
F. Haddadpour, M. M. Kamani, A. Mokhtari, and M. Mahdavi, “Federated learning with compression: Unified analysis and sharp guarantees,” in <em id="bib.bib9.1.1" class="ltx_emph ltx_font_italic">International Conference on Artificial Intelligence and Statistics</em>.   PMLR, 2021, pp. 2350–2358.

</span>
</li>
<li id="bib.bib10" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[10]</span>
<span class="ltx_bibblock">
M. Safaryan, R. Islamov, X. Qian, and P. Richtarik, “FedNL: Making Newton-type methods applicable to federated learning,” in <em id="bib.bib10.1.1" class="ltx_emph ltx_font_italic">International Conference on Machine Learning</em>.   PMLR, 2022, pp. 18 959–19 010.

</span>
</li>
<li id="bib.bib11" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[11]</span>
<span class="ltx_bibblock">
A. Elgabli, C. B. Issaid, A. S. Bedi, K. Rajawat, M. Bennis, and V. Aggarwal, “FedNew: A communication-efficient and privacy-preserving Newton-type method for federated learning,” in <em id="bib.bib11.1.1" class="ltx_emph ltx_font_italic">International Conference on Machine Learning</em>.   PMLR, 2022, pp. 5861–5877.

</span>
</li>
<li id="bib.bib12" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[12]</span>
<span class="ltx_bibblock">
A. Agafonov, D. Kamzolov, R. Tappenden, A. Gasnikov, and M. Takáč, “Flecs: A federated learning second-order framework via compression and sketching,” <em id="bib.bib12.1.1" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:2206.02009</em>, 2022.

</span>
</li>
<li id="bib.bib13" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[13]</span>
<span class="ltx_bibblock">
C. T. Dinh, N. H. Tran, T. D. Nguyen, W. Bao, A. R. Balef, B. B. Zhou, and A. Y. Zomaya, “DONE: Distributed approximate Newton-type method for federated edge learning,” <em id="bib.bib13.1.1" class="ltx_emph ltx_font_italic">IEEE Transactions on Parallel and Distributed Systems</em>, vol. 33, no. 11, pp. 2648–2660, 2022.

</span>
</li>
<li id="bib.bib14" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[14]</span>
<span class="ltx_bibblock">
Z. Yao, A. Gholami, S. Shen, M. Mustafa, K. Keutzer, and M. Mahoney, “Adahessian: An adaptive second order optimizer for machine learning,” in <em id="bib.bib14.1.1" class="ltx_emph ltx_font_italic">proceedings of the AAAI conference on artificial intelligence</em>, vol. 35, no. 12, 2021, pp. 10 665–10 673.

</span>
</li>
<li id="bib.bib15" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[15]</span>
<span class="ltx_bibblock">
M. F. Hutchinson, “A stochastic estimator of the trace of the influence matrix for laplacian smoothing splines,” <em id="bib.bib15.1.1" class="ltx_emph ltx_font_italic">Communications in Statistics-Simulation and Computation</em>, vol. 18, no. 3, pp. 1059–1076, 1989.

</span>
</li>
<li id="bib.bib16" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[16]</span>
<span class="ltx_bibblock">
H. Liu, Z. Li, D. Hall, P. Liang, and T. Ma, “Sophia: A scalable stochastic second-order optimizer for language model pre-training,” <em id="bib.bib16.1.1" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:2305.14342</em>, 2023.

</span>
</li>
<li id="bib.bib17" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[17]</span>
<span class="ltx_bibblock">
S. Lee, A. K. Sahu, C. He, and S. Avestimehr, “Partial model averaging in federated learning: Performance guarantees and benefits,” <em id="bib.bib17.1.1" class="ltx_emph ltx_font_italic">Neurocomputing</em>, vol. 556, p. 126647, 2023.

</span>
</li>
<li id="bib.bib18" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[18]</span>
<span class="ltx_bibblock">
J. Martens, I. Sutskever, and K. Swersky, “Estimating the hessian by back-propagating curvature,” <em id="bib.bib18.1.1" class="ltx_emph ltx_font_italic">arXiv preprint arXiv:1206.6464</em>, 2012.

</span>
</li>
<li id="bib.bib19" class="ltx_bibitem">
<span class="ltx_tag ltx_tag_bibitem">[19]</span>
<span class="ltx_bibblock">
A. Ghalkha, C. Ben Issaid, A. Elgabli, and M. Bennis, “DIN: A decentralized inexact Newton algorithm for consensus optimization,” in <em id="bib.bib19.1.1" class="ltx_emph ltx_font_italic">ICC 2023 - IEEE International Conference on Communications</em>, 2023, pp. 4391–4396.

</span>
</li>
</ul>
</section>
<div class="ltx_pagination ltx_role_newpage"></div>
</article>
</div>
<div class="ar5iv-footer"><a href="/html/2406.06654" class="ar5iv-nav-button ar5iv-nav-button-prev">◄</a>
    <a class="ar5iv-home-button" href="/"><img height="40" alt="ar5iv homepage" src="/assets/ar5iv.png"></a>
    <a href="/feeling_lucky" class="ar5iv-text-button">Feeling<br>lucky?</a>
    <a href="/log/2406.06655" class="ar5iv-text-button ar5iv-severity-error">Conversion<br>report</a>
    <a class="ar5iv-text-button" target="_blank" href="https://github.com/dginev/ar5iv/issues/new?template=improve-article--arxiv-id-.md&title=Improve+article+2406.06655">Report<br>an issue</a>
    <a href="https://arxiv.org/abs/2406.06655" class="ar5iv-text-button arxiv-ui-theme">View&nbsp;original<br>on&nbsp;arXiv</a><a href="/html/2406.06658" class="ar5iv-nav-button ar5iv-nav-button-next">►</a>
</div><footer class="ltx_page_footer">
<a class="ar5iv-toggle-color-scheme" href="javascript:toggleColorScheme()" title="Toggle ar5iv color scheme"><span class="color-scheme-icon"></span></a>
<a class="ar5iv-footer-button" href="https://arxiv.org/help/license" target="_blank">Copyright</a>
<a class="ar5iv-footer-button" href="https://arxiv.org/help/policies/privacy_policy" target="_blank">Privacy Policy</a>

<div class="ltx_page_logo">Generated  on Fri Jul  5 20:59:45 2024 by <a target="_blank" href="http://dlmf.nist.gov/LaTeXML/" class="ltx_LaTeXML_logo"><span style="letter-spacing:-0.2em; margin-right:0.1em;">L<span class="ltx_font_smallcaps" style="position:relative; bottom:2.2pt;">a</span>T<span class="ltx_font_smallcaps" style="font-size:120%;position:relative; bottom:-0.2ex;">e</span></span><span style="font-size:90%; position:relative; bottom:-0.2ex;">XML</span><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAsAAAAOCAYAAAD5YeaVAAAAAXNSR0IArs4c6QAAAAZiS0dEAP8A/wD/oL2nkwAAAAlwSFlzAAALEwAACxMBAJqcGAAAAAd0SU1FB9wKExQZLWTEaOUAAAAddEVYdENvbW1lbnQAQ3JlYXRlZCB3aXRoIFRoZSBHSU1Q72QlbgAAAdpJREFUKM9tkL+L2nAARz9fPZNCKFapUn8kyI0e4iRHSR1Kb8ng0lJw6FYHFwv2LwhOpcWxTjeUunYqOmqd6hEoRDhtDWdA8ApRYsSUCDHNt5ul13vz4w0vWCgUnnEc975arX6ORqN3VqtVZbfbTQC4uEHANM3jSqXymFI6yWazP2KxWAXAL9zCUa1Wy2tXVxheKA9YNoR8Pt+aTqe4FVVVvz05O6MBhqUIBGk8Hn8HAOVy+T+XLJfLS4ZhTiRJgqIoVBRFIoric47jPnmeB1mW/9rr9ZpSSn3Lsmir1fJZlqWlUonKsvwWwD8ymc/nXwVBeLjf7xEKhdBut9Hr9WgmkyGEkJwsy5eHG5vN5g0AKIoCAEgkEkin0wQAfN9/cXPdheu6P33fBwB4ngcAcByHJpPJl+fn54mD3Gg0NrquXxeLRQAAwzAYj8cwTZPwPH9/sVg8PXweDAauqqr2cDjEer1GJBLBZDJBs9mE4zjwfZ85lAGg2+06hmGgXq+j3+/DsixYlgVN03a9Xu8jgCNCyIegIAgx13Vfd7vdu+FweG8YRkjXdWy329+dTgeSJD3ieZ7RNO0VAXAPwDEAO5VKndi2fWrb9jWl9Esul6PZbDY9Go1OZ7PZ9z/lyuD3OozU2wAAAABJRU5ErkJggg==" alt="Mascot Sammy"></a>
</div></footer>
</div>

    <script>
      var canMathML = typeof(MathMLElement) == "function";
      if (!canMathML) {
        var body = document.querySelector("body");
        body.firstElementChild.setAttribute('style', 'opacity: 0;');
        var loading = document.createElement("div");
        loading.setAttribute("id", "mathjax-loading-spinner");
        var message = document.createElement("div");
        message.setAttribute("id", "mathjax-loading-message");
        message.innerText = "Typesetting Equations...";
        body.prepend(loading);
        body.prepend(message);

        var el = document.createElement("script");
        el.src = "https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js";
        document.querySelector("head").appendChild(el);

        window.MathJax = {
          startup: {
            pageReady: () => {
              return MathJax.startup.defaultPageReady().then(() => {
                body.removeChild(loading);
                body.removeChild(message);
                body.firstElementChild.removeAttribute('style');
              }); } } };
      }
    </script>
    <script>
    // Auxiliary function, building the preview feature when
    // an inline citation is clicked
    function clicked_cite(e) {
      e.preventDefault();
      let cite = this.closest('.ltx_cite');
      let next = cite.nextSibling;
      if (next && next.nodeType == Node.ELEMENT_NODE && next.getAttribute('class') == "ar5iv-bibitem-preview") {
        next.remove();
        return; }
      // Before adding a preview modal,
      // cleanup older previews, in case they're still open
      document.querySelectorAll('span.ar5iv-bibitem-preview').forEach(function(node) {
        node.remove();
      })

      // Create the preview
      preview = document.createElement('span');
      preview.setAttribute('class','ar5iv-bibitem-preview');
      let target = document.getElementById(this.getAttribute('href').slice(1));
      target.childNodes.forEach(function (child) {
        preview.append(child.cloneNode(true));
      });
      let close_x = document.createElement('button');
      close_x.setAttribute("aria-label","Close modal for bibliography item preview");
      close_x.textContent = "×";
      close_x.setAttribute('class', 'ar5iv-button-close-preview');
      close_x.setAttribute('onclick','this.parentNode.remove()');
      preview.append(close_x);
      preview.querySelectorAll('.ltx_tag_bibitem').forEach(function(node) {
        node.remove();
      });
      cite.parentNode.insertBefore(preview, cite.nextSibling);
      return;
    }
    // Global Document initialization:
    // - assign the preview feature to all inline citation links
    document.querySelectorAll(".ltx_cite .ltx_ref").forEach(function (link) {
      link.addEventListener("click", clicked_cite);
    });
    </script>
    </body>
</html>
