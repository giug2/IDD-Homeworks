<!DOCTYPE html>
<html lang="en">
<head>
<meta content="text/html; charset=utf-8" http-equiv="content-type"/>
<title>Retrieval and Distill: A Temporal Data Shift-Free Paradigm for Online Recommendation System</title>
<!--Generated on Thu Jun 13 07:53:54 2024 by LaTeXML (version 0.8.8) http://dlmf.nist.gov/LaTeXML/.-->
<meta content="width=device-width, initial-scale=1, shrink-to-fit=no" name="viewport"/>
<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet" type="text/css"/>
<link href="/static/browse/0.3.4/css/ar5iv.0.7.9.min.css" rel="stylesheet" type="text/css"/>
<link href="/static/browse/0.3.4/css/ar5iv-fonts.0.7.9.min.css" rel="stylesheet" type="text/css"/>
<link href="/static/browse/0.3.4/css/latexml_styles.css" rel="stylesheet" type="text/css"/>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.3.3/html2canvas.min.js"></script>
<script src="/static/browse/0.3.4/js/addons_new.js"></script>
<script src="/static/browse/0.3.4/js/feedbackOverlay.js"></script>
<meta content="Temporal Data Shift,  Retrieval-Enhanced Methods,  Knowledge Distillation,  Pretraining,  Click-Through Rate" lang="en" name="keywords"/>
<base href="/html/2404.15678v4/"/></head>
<body>
<nav class="ltx_page_navbar">
<nav class="ltx_TOC">
<ol class="ltx_toclist">
<li class="ltx_tocentry ltx_tocentry_section"><a class="ltx_ref" href="https://arxiv.org/html/2404.15678v4#S1" title="In Retrieval and Distill: A Temporal Data Shift-Free Paradigm for Online Recommendation System"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">1 </span>INRODUCTION</span></a></li>
<li class="ltx_tocentry ltx_tocentry_section"><a class="ltx_ref" href="https://arxiv.org/html/2404.15678v4#S2" title="In Retrieval and Distill: A Temporal Data Shift-Free Paradigm for Online Recommendation System"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">2 </span>PRELIMINARIES</span></a></li>
<li class="ltx_tocentry ltx_tocentry_section">
<a class="ltx_ref" href="https://arxiv.org/html/2404.15678v4#S3" title="In Retrieval and Distill: A Temporal Data Shift-Free Paradigm for Online Recommendation System"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3 </span>The RAD Paradigm</span></a>
<ol class="ltx_toclist ltx_toclist_section">
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2404.15678v4#S3.SS1" title="In 3. The RAD Paradigm ‣ Retrieval and Distill: A Temporal Data Shift-Free Paradigm for Online Recommendation System"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3.1 </span>Overview</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection">
<a class="ltx_ref" href="https://arxiv.org/html/2404.15678v4#S3.SS2" title="In 3. The RAD Paradigm ‣ Retrieval and Distill: A Temporal Data Shift-Free Paradigm for Online Recommendation System"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3.2 </span>Retreival Framework</span></a>
<ol class="ltx_toclist ltx_toclist_subsection">
<li class="ltx_tocentry ltx_tocentry_subsubsection"><a class="ltx_ref" href="https://arxiv.org/html/2404.15678v4#S3.SS2.SSS1" title="In 3.2. Retreival Framework ‣ 3. The RAD Paradigm ‣ Retrieval and Distill: A Temporal Data Shift-Free Paradigm for Online Recommendation System"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3.2.1 </span>Framework Model Structure</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsubsection"><a class="ltx_ref" href="https://arxiv.org/html/2404.15678v4#S3.SS2.SSS2" title="In 3.2. Retreival Framework ‣ 3. The RAD Paradigm ‣ Retrieval and Distill: A Temporal Data Shift-Free Paradigm for Online Recommendation System"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3.2.2 </span>Pretrain with Shifting Data</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsubsection"><a class="ltx_ref" href="https://arxiv.org/html/2404.15678v4#S3.SS2.SSS3" title="In 3.2. Retreival Framework ‣ 3. The RAD Paradigm ‣ Retrieval and Distill: A Temporal Data Shift-Free Paradigm for Online Recommendation System"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3.2.3 </span>Finetune with Unshifting Data</span></a></li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_subsection">
<a class="ltx_ref" href="https://arxiv.org/html/2404.15678v4#S3.SS3" title="In 3. The RAD Paradigm ‣ Retrieval and Distill: A Temporal Data Shift-Free Paradigm for Online Recommendation System"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3.3 </span>Distill Framework</span></a>
<ol class="ltx_toclist ltx_toclist_subsection">
<li class="ltx_tocentry ltx_tocentry_subsubsection"><a class="ltx_ref" href="https://arxiv.org/html/2404.15678v4#S3.SS3.SSS1" title="In 3.3. Distill Framework ‣ 3. The RAD Paradigm ‣ Retrieval and Distill: A Temporal Data Shift-Free Paradigm for Online Recommendation System"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3.3.1 </span>Framework Model Structure</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsubsection"><a class="ltx_ref" href="https://arxiv.org/html/2404.15678v4#S3.SS3.SSS2" title="In 3.3. Distill Framework ‣ 3. The RAD Paradigm ‣ Retrieval and Distill: A Temporal Data Shift-Free Paradigm for Online Recommendation System"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3.3.2 </span>Pretrain and Distill with Shifting Data</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsubsection"><a class="ltx_ref" href="https://arxiv.org/html/2404.15678v4#S3.SS3.SSS3" title="In 3.3. Distill Framework ‣ 3. The RAD Paradigm ‣ Retrieval and Distill: A Temporal Data Shift-Free Paradigm for Online Recommendation System"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">3.3.3 </span>Finetune with Unshifting Data</span></a></li>
</ol>
</li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_section">
<a class="ltx_ref" href="https://arxiv.org/html/2404.15678v4#S4" title="In Retrieval and Distill: A Temporal Data Shift-Free Paradigm for Online Recommendation System"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">4 </span>Experiments</span></a>
<ol class="ltx_toclist ltx_toclist_section">
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2404.15678v4#S4.SS1" title="In 4. Experiments ‣ Retrieval and Distill: A Temporal Data Shift-Free Paradigm for Online Recommendation System"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">4.1 </span>Datasets</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2404.15678v4#S4.SS2" title="In 4. Experiments ‣ Retrieval and Distill: A Temporal Data Shift-Free Paradigm for Online Recommendation System"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">4.2 </span>Evaluation Metrics</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection">
<a class="ltx_ref" href="https://arxiv.org/html/2404.15678v4#S4.SS3" title="In 4. Experiments ‣ Retrieval and Distill: A Temporal Data Shift-Free Paradigm for Online Recommendation System"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">4.3 </span>Compared Methods</span></a>
<ol class="ltx_toclist ltx_toclist_subsection">
<li class="ltx_tocentry ltx_tocentry_subsubsection"><a class="ltx_ref" href="https://arxiv.org/html/2404.15678v4#S4.SS3.SSS1" title="In 4.3. Compared Methods ‣ 4. Experiments ‣ Retrieval and Distill: A Temporal Data Shift-Free Paradigm for Online Recommendation System"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">4.3.1 </span>Feature interaction based Models</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsubsection"><a class="ltx_ref" href="https://arxiv.org/html/2404.15678v4#S4.SS3.SSS2" title="In 4.3. Compared Methods ‣ 4. Experiments ‣ Retrieval and Distill: A Temporal Data Shift-Free Paradigm for Online Recommendation System"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">4.3.2 </span>Sequential based Models</span></a></li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2404.15678v4#S4.SS4" title="In 4. Experiments ‣ Retrieval and Distill: A Temporal Data Shift-Free Paradigm for Online Recommendation System"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">4.4 </span>Overall Performance (RQ1)</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2404.15678v4#S4.SS5" title="In 4. Experiments ‣ Retrieval and Distill: A Temporal Data Shift-Free Paradigm for Online Recommendation System"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">4.5 </span>Applying Knowledge Distillation to Non-Parametric Models (RQ2)</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2404.15678v4#S4.SS6" title="In 4. Experiments ‣ Retrieval and Distill: A Temporal Data Shift-Free Paradigm for Online Recommendation System"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">4.6 </span>Temporal Invariance of Association (RQ3)</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2404.15678v4#S4.SS7" title="In 4. Experiments ‣ Retrieval and Distill: A Temporal Data Shift-Free Paradigm for Online Recommendation System"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">4.7 </span>Performance Efficiency Study (RQ4)</span></a></li>
<li class="ltx_tocentry ltx_tocentry_subsection"><a class="ltx_ref" href="https://arxiv.org/html/2404.15678v4#S4.SS8" title="In 4. Experiments ‣ Retrieval and Distill: A Temporal Data Shift-Free Paradigm for Online Recommendation System"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">4.8 </span>The Study of Distill Loss Functions (RQ5)</span></a></li>
</ol>
</li>
<li class="ltx_tocentry ltx_tocentry_section"><a class="ltx_ref" href="https://arxiv.org/html/2404.15678v4#S5" title="In Retrieval and Distill: A Temporal Data Shift-Free Paradigm for Online Recommendation System"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">5 </span>Related Work</span></a></li>
<li class="ltx_tocentry ltx_tocentry_section"><a class="ltx_ref" href="https://arxiv.org/html/2404.15678v4#S6" title="In Retrieval and Distill: A Temporal Data Shift-Free Paradigm for Online Recommendation System"><span class="ltx_text ltx_ref_title"><span class="ltx_tag ltx_tag_ref">6 </span>Conclusion</span></a></li>
</ol></nav>
</nav>
<div class="ltx_page_main">
<div class="ltx_page_content">
<article class="ltx_document ltx_authors_1line ltx_leqno">
<h1 class="ltx_title ltx_title_document">Retrieval and Distill: A Temporal Data Shift-Free Paradigm for Online Recommendation System</h1>
<div class="ltx_authors">
<span class="ltx_creator ltx_role_author">
<span class="ltx_personname">Lei Zheng
</span><span class="ltx_author_notes">
<span class="ltx_contact ltx_role_email"><a href="mailto:zhenglei2016@sjtu.edu.cn">zhenglei2016@sjtu.edu.cn</a>
</span>
<span class="ltx_contact ltx_role_affiliation"><span class="ltx_text ltx_affiliation_institution" id="id1.1.id1">Shanghai Jiao Tong University</span><span class="ltx_text ltx_affiliation_city" id="id2.2.id2">Shanghai</span><span class="ltx_text ltx_affiliation_country" id="id3.3.id3">China</span>
</span></span></span>
<span class="ltx_author_before">, </span><span class="ltx_creator ltx_role_author">
<span class="ltx_personname">Ning Li
</span><span class="ltx_author_notes">
<span class="ltx_contact ltx_role_email"><a href="mailto:lining01@sjtu.edu.cn">lining01@sjtu.edu.cn</a>
</span>
<span class="ltx_contact ltx_role_affiliation"><span class="ltx_text ltx_affiliation_institution" id="id4.1.id1">Shanghai Jiao Tong University</span><span class="ltx_text ltx_affiliation_city" id="id5.2.id2">Shanghai</span><span class="ltx_text ltx_affiliation_country" id="id6.3.id3">China</span>
</span></span></span>
<span class="ltx_author_before">, </span><span class="ltx_creator ltx_role_author">
<span class="ltx_personname">Weinan Zhang
</span><span class="ltx_author_notes">
<span class="ltx_contact ltx_role_email"><a href="mailto:wnzhang@sjtu.edu.cn">wnzhang@sjtu.edu.cn</a>
</span>
<span class="ltx_contact ltx_role_affiliation"><span class="ltx_text ltx_affiliation_institution" id="id7.1.id1">Shanghai Jiao Tong University</span><span class="ltx_text ltx_affiliation_city" id="id8.2.id2">Shanghai</span><span class="ltx_text ltx_affiliation_country" id="id9.3.id3">China</span>
</span></span></span>
<span class="ltx_author_before"> and </span><span class="ltx_creator ltx_role_author">
<span class="ltx_personname">Yong Yu
</span><span class="ltx_author_notes">
<span class="ltx_contact ltx_role_email"><a href="mailto:yyu@apex.sjtu.edu.cn">yyu@apex.sjtu.edu.cn</a>
</span>
<span class="ltx_contact ltx_role_affiliation"><span class="ltx_text ltx_affiliation_institution" id="id10.1.id1">Shanghai Jiao Tong University</span><span class="ltx_text ltx_affiliation_city" id="id11.2.id2">Shanghai</span><span class="ltx_text ltx_affiliation_country" id="id12.3.id3">China</span>
</span></span></span>
</div>
<div class="ltx_dates">(2018)</div>
<div class="ltx_abstract">
<h6 class="ltx_title ltx_title_abstract">Abstract.</h6>
<p class="ltx_p" id="id13.id1">Current recommendation systems are significantly affected by a serious issue of temporal data shift, which is the inconsistency between the distribution of historical data and that of online data.
Most existing models focus on utilizing updated data, overlooking the transferable, temporal data shift-free information that can be learned from shifting data.
We propose the Temporal Invariance of Association theorem, which suggests that given a fixed search space, the relationship between the data and the data in the search space keeps invariant over time.
Leveraging this principle, we designed a retrieval-based recommendation system framework that can train a data shift-free relevance network using shifting data, significantly enhancing the predictive performance of the original model in the recommendation system.
However, retrieval-based recommendation models face substantial inference time costs when deployed online.
To address this, we further designed a distill framework that can distill information from the relevance network into a parameterized module using shifting data.
The distilled model can be deployed online alongside the original model, with only a minimal increase in inference time.
Extensive experiments on multiple real datasets demonstrate that our framework significantly improves the performance of the original model by utilizing shifting data.</p>
</div>
<div class="ltx_keywords">Temporal Data Shift, Retrieval-Enhanced Methods, Knowledge Distillation, Pretraining, Click-Through Rate
</div>
<span class="ltx_note ltx_note_frontmatter ltx_role_copyright" id="id1"><sup class="ltx_note_mark">†</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">†</sup><span class="ltx_note_type">copyright: </span>acmlicensed</span></span></span><span class="ltx_note ltx_note_frontmatter ltx_role_journalyear" id="id2"><sup class="ltx_note_mark">†</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">†</sup><span class="ltx_note_type">journalyear: </span>2018</span></span></span><span class="ltx_note ltx_note_frontmatter ltx_role_doi" id="id3"><sup class="ltx_note_mark">†</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">†</sup><span class="ltx_note_type">doi: </span>XXXXXXX.XXXXXXX</span></span></span><span class="ltx_note ltx_note_frontmatter ltx_role_conference" id="id4"><sup class="ltx_note_mark">†</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">†</sup><span class="ltx_note_type">conference: </span>Make sure to enter the correct
conference title from your rights confirmation emai; June 03–05,
2018; Woodstock, NY</span></span></span><span class="ltx_note ltx_note_frontmatter ltx_role_isbn" id="id5"><sup class="ltx_note_mark">†</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">†</sup><span class="ltx_note_type">isbn: </span>978-1-4503-XXXX-X/18/06</span></span></span>
<section class="ltx_section" id="S1">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">1. </span>INRODUCTION</h2>
<div class="ltx_para" id="S1.p1">
<p class="ltx_p" id="S1.p1.1">Click-through rate (CTR) prediction models play a significant role in modern recommendation systems. To enhance the accuracy of CTR models, deep learning-based approaches have been extensively employed <cite class="ltx_cite ltx_citemacro_citep">(Covington et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2404.15678v4#bib.bib4" title="">2016</a>; Shan et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2404.15678v4#bib.bib32" title="">2016</a>; Wang et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2404.15678v4#bib.bib37" title="">2017</a>, <a class="ltx_ref" href="https://arxiv.org/html/2404.15678v4#bib.bib38" title="">2021</a>)</cite>. However, the dynamic environment faced by the recommendation systems, with the data distribution evolving over time, poses significant challenges to the effectiveness of these models <cite class="ltx_cite ltx_citemacro_citep">(Zhu et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2404.15678v4#bib.bib51" title="">2023</a>)</cite>.</p>
</div>
<div class="ltx_para" id="S1.p2">
<p class="ltx_p" id="S1.p2.1">To tackle this challenge, prior research has undertaken investigations from two distinct perspectives, namely incremental learning and behavior sequence modeling.
On one hand, incremental learning techniques delve into updating the models that make these predictions as new data comes in, without having to start from scratch every time <cite class="ltx_cite ltx_citemacro_citep">(Ye et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2404.15678v4#bib.bib44" title="">2022</a>; Peng et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2404.15678v4#bib.bib22" title="">2021</a>; Katsileros et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2404.15678v4#bib.bib17" title="">2022</a>)</cite>.
This means the models learn and improve gradually as they get access to more recent data.
However, the process of learning neural network parameters depends on iterative updates based on gradients, which slowly infuse supervision data into the model weights using a minimal learning rate.
This poses a significant challenge for large parametric recommendation models in swiftly adapting to shifts in distribution.
On the other hand, behavior sequence modeling focuses on understanding how users’ behaviors change over time by looking at the sequence of actions they take.
In this area, various network structures have been proposed, including recurrent
neural networks (RNNs) <cite class="ltx_cite ltx_citemacro_citep">(Hidasi et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2404.15678v4#bib.bib11" title="">2015</a>, <a class="ltx_ref" href="https://arxiv.org/html/2404.15678v4#bib.bib12" title="">2016</a>)</cite>, convolutional neural networks (CNNs) <cite class="ltx_cite ltx_citemacro_citep">(Tang and Wang, <a class="ltx_ref" href="https://arxiv.org/html/2404.15678v4#bib.bib35" title="">2018</a>; Yuan et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2404.15678v4#bib.bib45" title="">2019</a>)</cite>, and memory networks <cite class="ltx_cite ltx_citemacro_citep">(Pi et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2404.15678v4#bib.bib24" title="">2019</a>; Ren et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2404.15678v4#bib.bib29" title="">2019</a>)</cite>.
Moreover, the attention mechanism has emerged as the predominant approach for modeling item dependencies, with several notable contributions such as SASRec <cite class="ltx_cite ltx_citemacro_citep">(Kang and McAuley, <a class="ltx_ref" href="https://arxiv.org/html/2404.15678v4#bib.bib16" title="">2018</a>)</cite>, DIN <cite class="ltx_cite ltx_citemacro_citep">(Zhou et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2404.15678v4#bib.bib50" title="">2018</a>)</cite>, DIEN <cite class="ltx_cite ltx_citemacro_citep">(Zhou et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2404.15678v4#bib.bib49" title="">2019</a>)</cite>, and BERT4Rec <cite class="ltx_cite ltx_citemacro_citep">(Sun et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2404.15678v4#bib.bib33" title="">2019</a>)</cite>.
These studies aim to identify sequential patterns in user behavior, thereby facilitating the prediction of future preferences based on historical activities. However, these studies fail to directly tackle the issue of distribution shift during training time, and these high-capacity models significantly increase the online workload and inference burden.</p>
</div>
<figure class="ltx_figure" id="S1.F1"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="174" id="S1.F1.g1" src="x1.png" width="290"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span class="ltx_text" id="S1.F1.2.1.1" style="font-size:90%;">Figure 1</span>. </span><span class="ltx_text" id="S1.F1.3.2" style="font-size:90%;">The phenomenon of temporal data shift on a real dataset collected from Tmall. The test set consists of data after Nov. 10, 2015. The x-axis represents the date from which we add all data up to Nov. 10 to train a CTR model, and the y-axis represents the model’s performance on the test set. We found that the model’s performance peaks after adding just a few final days of data. However, further adding data from earlier periods leads to a decline in the model’s performence on the test set due to the inconsistency in data distribution between this earlier data and the test set.</span></figcaption>
</figure>
<div class="ltx_para" id="S1.p3">
<p class="ltx_p" id="S1.p3.1">All of the above-mentioned models either update the model using the latest data <cite class="ltx_cite ltx_citemacro_citep">(Guo et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2404.15678v4#bib.bib8" title="">2017</a>; Wang et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2404.15678v4#bib.bib37" title="">2017</a>)</cite> or use past shifting data as a reference for retrieval <cite class="ltx_cite ltx_citemacro_citep">(Qin et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2404.15678v4#bib.bib27" title="">2020</a>; Qi et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2404.15678v4#bib.bib25" title="">2020</a>)</cite>, without directly using the shifting data for training model parameters.
However, directly using the temporally shifting data for model training is challenging, as an example illustrated in Figure <a class="ltx_ref" href="https://arxiv.org/html/2404.15678v4#S1.F1" title="Figure 1 ‣ 1. INRODUCTION ‣ Retrieval and Distill: A Temporal Data Shift-Free Paradigm for Online Recommendation System"><span class="ltx_text ltx_ref_tag">1</span></a> based on a public dataset of Tmall, an international e-commerce platform.
In this dataset, data spanning Nov. 11-12, 2015 is employed as the test set.
The x-axis represents the training set from the indicated date to Nov. 10, 2015. We train a common deep CTR model PNN <cite class="ltx_cite ltx_citemacro_citep">(Qu et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2404.15678v4#bib.bib28" title="">2018</a>)</cite> using different training sets to make predictions. The y-axis indicates the AUC performance of the model on the test set.
We can observe that utilizing data over Nov. 1-10, 2015 for predictions on the test set yields the best results, whereas adding data from earlier time periods will negatively impact the results due to data shift.
Therefore, it is crucial to find an effective method that can directly utilize these data for model training.</p>
</div>
<div class="ltx_para" id="S1.p4">
<p class="ltx_p" id="S1.p4.1">Inspired by the recent proposed retrieval-based tabular data prediction models <cite class="ltx_cite ltx_citemacro_citep">(Qin et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2404.15678v4#bib.bib26" title="">2021</a>; Zheng et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2404.15678v4#bib.bib48" title="">2023</a>)</cite>, we found that similar data from historical records can significantly enhance the predictive capability and generalizability.
In other words, although the probability distribution modeled by the CTR is time-variant, the probability distribution of the association between current user behavior data and similar historical data can remain invariant over time if the search space is fixed.
If we design a neural network to model the probability distribution of data similar to the current query, this neural network is temporal data shift-free. Thus, the shifting data can be used to train such a neural network.
By incorporating this neural network with the original CTR model, we can obtain an aggregated prediction model that has been trained with shifting data.</p>
</div>
<div class="ltx_para" id="S1.p5">
<p class="ltx_p" id="S1.p5.1">In this paper, we propose the Retrieval and Distill paradigm (RAD) to address the challenge of ineffective training of a CTR model over shifting data.
The RAD paradigm generally consists of two major components, namely the Retrieval Framework and the Distill Framework.
We first establish a Retrieval Framework to assist the original model in making predictions using similar data within the shifting data.
We refer to the neural network in Retrieval Framework that retrieves and outputs the logits of similar data as the relevance network.
By pre-training this relevance network using shifting data and then merging the original CTR model and relevance network, we can significantly enhance the predictive capability of the original CTR model.
However, the added relevance network in the Retrieval Framework, due to its retrieval process (such as BM25 <cite class="ltx_cite ltx_citemacro_citep">(Robertson et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2404.15678v4#bib.bib31" title="">1995</a>)</cite>), is difficult to deploy online due to its inference time, similar to other retrieval-based CTR models <cite class="ltx_cite ltx_citemacro_citep">(Qin et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2404.15678v4#bib.bib26" title="">2021</a>; Zheng et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2404.15678v4#bib.bib48" title="">2023</a>)</cite>.
To address this difficulty, we further build the Distill Framework to distill knowledge from the relevance network using shifting data, obtaining a parameterized student network called search-distill module.
By aggregating the original CTR model and the search-distill module, we finetune the Distill Framework with unshifting data, e.g., the latest training data.
This yields the final model that can be deployed online for light workload and efficient inference.</p>
</div>
<div class="ltx_para" id="S1.p6">
<p class="ltx_p" id="S1.p6.1">In sum, the technical contributions of this paper are threefold.</p>
<ul class="ltx_itemize" id="S1.I1">
<li class="ltx_item" id="S1.I1.i1" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S1.I1.i1.p1">
<p class="ltx_p" id="S1.I1.i1.p1.1">We highlight the significant impact of the data shift phenomenon in recommendation systems, which is not addressable by simply increasing training data or the model capacity. To deal with this issue, we propose the Retrieval and Distill (RAD) paradigm, where the recommendation model is enhanced by incorporating shifting data into the model. To the best of our knowledge, RAD is the first paradigm that successfully utilizes shifting data for model training and lightweight deployment.</p>
</div>
</li>
<li class="ltx_item" id="S1.I1.i2" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S1.I1.i2.p1">
<p class="ltx_p" id="S1.I1.i2.p1.1">As the rationale of RAD, we raise the theorem of Temporal Invariance of Association, which provides effective guidance on how to utilize shifting data.</p>
</div>
</li>
<li class="ltx_item" id="S1.I1.i3" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item">•</span>
<div class="ltx_para" id="S1.I1.i3.p1">
<p class="ltx_p" id="S1.I1.i3.p1.1">We design an innovative distillation approach that distills information from the retrieval framework of RAD. This approach optimizes both the time complexity and space complexity of the retrieval process to <math alttext="O(1)" class="ltx_Math" display="inline" id="S1.I1.i3.p1.1.m1.1"><semantics id="S1.I1.i3.p1.1.m1.1a"><mrow id="S1.I1.i3.p1.1.m1.1.2" xref="S1.I1.i3.p1.1.m1.1.2.cmml"><mi id="S1.I1.i3.p1.1.m1.1.2.2" xref="S1.I1.i3.p1.1.m1.1.2.2.cmml">O</mi><mo id="S1.I1.i3.p1.1.m1.1.2.1" xref="S1.I1.i3.p1.1.m1.1.2.1.cmml">⁢</mo><mrow id="S1.I1.i3.p1.1.m1.1.2.3.2" xref="S1.I1.i3.p1.1.m1.1.2.cmml"><mo id="S1.I1.i3.p1.1.m1.1.2.3.2.1" stretchy="false" xref="S1.I1.i3.p1.1.m1.1.2.cmml">(</mo><mn id="S1.I1.i3.p1.1.m1.1.1" xref="S1.I1.i3.p1.1.m1.1.1.cmml">1</mn><mo id="S1.I1.i3.p1.1.m1.1.2.3.2.2" stretchy="false" xref="S1.I1.i3.p1.1.m1.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S1.I1.i3.p1.1.m1.1b"><apply id="S1.I1.i3.p1.1.m1.1.2.cmml" xref="S1.I1.i3.p1.1.m1.1.2"><times id="S1.I1.i3.p1.1.m1.1.2.1.cmml" xref="S1.I1.i3.p1.1.m1.1.2.1"></times><ci id="S1.I1.i3.p1.1.m1.1.2.2.cmml" xref="S1.I1.i3.p1.1.m1.1.2.2">𝑂</ci><cn id="S1.I1.i3.p1.1.m1.1.1.cmml" type="integer" xref="S1.I1.i3.p1.1.m1.1.1">1</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S1.I1.i3.p1.1.m1.1c">O(1)</annotation><annotation encoding="application/x-llamapun" id="S1.I1.i3.p1.1.m1.1d">italic_O ( 1 )</annotation></semantics></math>, which largely pushes forward the practical usage of retrieval-based models for online recommendation systems.
</p>
</div>
</li>
</ul>
</div>
<div class="ltx_para" id="S1.p7">
<p class="ltx_p" id="S1.p7.1">Extensive experiments on multiple real datasets demonstrate that RAD significantly improves the performance of the original model via effective training over shifting data.
RAD offers a new paradigm in the field of recommendation systems, enabling models to train using both shifting and unshifting data, opening up a new pathway for enhancing the performance of CTR models by increasing the amount of training data.</p>
</div>
</section>
<section class="ltx_section" id="S2">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">2. </span>PRELIMINARIES</h2>
<div class="ltx_para" id="S2.p1">
<p class="ltx_p" id="S2.p1.11">In this section, we formulate the problem and introduce the notations.
In the context of recommendation systems, we represent the dataset as a tabular structure, denoted by <math alttext="\mathcal{D}" class="ltx_Math" display="inline" id="S2.p1.1.m1.1"><semantics id="S2.p1.1.m1.1a"><mi class="ltx_font_mathcaligraphic" id="S2.p1.1.m1.1.1" xref="S2.p1.1.m1.1.1.cmml">𝒟</mi><annotation-xml encoding="MathML-Content" id="S2.p1.1.m1.1b"><ci id="S2.p1.1.m1.1.1.cmml" xref="S2.p1.1.m1.1.1">𝒟</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.p1.1.m1.1c">\mathcal{D}</annotation><annotation encoding="application/x-llamapun" id="S2.p1.1.m1.1d">caligraphic_D</annotation></semantics></math>, comprising <math alttext="F" class="ltx_Math" display="inline" id="S2.p1.2.m2.1"><semantics id="S2.p1.2.m2.1a"><mi id="S2.p1.2.m2.1.1" xref="S2.p1.2.m2.1.1.cmml">F</mi><annotation-xml encoding="MathML-Content" id="S2.p1.2.m2.1b"><ci id="S2.p1.2.m2.1.1.cmml" xref="S2.p1.2.m2.1.1">𝐹</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.p1.2.m2.1c">F</annotation><annotation encoding="application/x-llamapun" id="S2.p1.2.m2.1d">italic_F</annotation></semantics></math> feature columns <math alttext="\mathcal{C}=\{C_{i}\}_{i=1}^{F}" class="ltx_Math" display="inline" id="S2.p1.3.m3.1"><semantics id="S2.p1.3.m3.1a"><mrow id="S2.p1.3.m3.1.1" xref="S2.p1.3.m3.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S2.p1.3.m3.1.1.3" xref="S2.p1.3.m3.1.1.3.cmml">𝒞</mi><mo id="S2.p1.3.m3.1.1.2" xref="S2.p1.3.m3.1.1.2.cmml">=</mo><msubsup id="S2.p1.3.m3.1.1.1" xref="S2.p1.3.m3.1.1.1.cmml"><mrow id="S2.p1.3.m3.1.1.1.1.1.1" xref="S2.p1.3.m3.1.1.1.1.1.2.cmml"><mo id="S2.p1.3.m3.1.1.1.1.1.1.2" stretchy="false" xref="S2.p1.3.m3.1.1.1.1.1.2.cmml">{</mo><msub id="S2.p1.3.m3.1.1.1.1.1.1.1" xref="S2.p1.3.m3.1.1.1.1.1.1.1.cmml"><mi id="S2.p1.3.m3.1.1.1.1.1.1.1.2" xref="S2.p1.3.m3.1.1.1.1.1.1.1.2.cmml">C</mi><mi id="S2.p1.3.m3.1.1.1.1.1.1.1.3" xref="S2.p1.3.m3.1.1.1.1.1.1.1.3.cmml">i</mi></msub><mo id="S2.p1.3.m3.1.1.1.1.1.1.3" stretchy="false" xref="S2.p1.3.m3.1.1.1.1.1.2.cmml">}</mo></mrow><mrow id="S2.p1.3.m3.1.1.1.1.3" xref="S2.p1.3.m3.1.1.1.1.3.cmml"><mi id="S2.p1.3.m3.1.1.1.1.3.2" xref="S2.p1.3.m3.1.1.1.1.3.2.cmml">i</mi><mo id="S2.p1.3.m3.1.1.1.1.3.1" xref="S2.p1.3.m3.1.1.1.1.3.1.cmml">=</mo><mn id="S2.p1.3.m3.1.1.1.1.3.3" xref="S2.p1.3.m3.1.1.1.1.3.3.cmml">1</mn></mrow><mi id="S2.p1.3.m3.1.1.1.3" xref="S2.p1.3.m3.1.1.1.3.cmml">F</mi></msubsup></mrow><annotation-xml encoding="MathML-Content" id="S2.p1.3.m3.1b"><apply id="S2.p1.3.m3.1.1.cmml" xref="S2.p1.3.m3.1.1"><eq id="S2.p1.3.m3.1.1.2.cmml" xref="S2.p1.3.m3.1.1.2"></eq><ci id="S2.p1.3.m3.1.1.3.cmml" xref="S2.p1.3.m3.1.1.3">𝒞</ci><apply id="S2.p1.3.m3.1.1.1.cmml" xref="S2.p1.3.m3.1.1.1"><csymbol cd="ambiguous" id="S2.p1.3.m3.1.1.1.2.cmml" xref="S2.p1.3.m3.1.1.1">superscript</csymbol><apply id="S2.p1.3.m3.1.1.1.1.cmml" xref="S2.p1.3.m3.1.1.1"><csymbol cd="ambiguous" id="S2.p1.3.m3.1.1.1.1.2.cmml" xref="S2.p1.3.m3.1.1.1">subscript</csymbol><set id="S2.p1.3.m3.1.1.1.1.1.2.cmml" xref="S2.p1.3.m3.1.1.1.1.1.1"><apply id="S2.p1.3.m3.1.1.1.1.1.1.1.cmml" xref="S2.p1.3.m3.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S2.p1.3.m3.1.1.1.1.1.1.1.1.cmml" xref="S2.p1.3.m3.1.1.1.1.1.1.1">subscript</csymbol><ci id="S2.p1.3.m3.1.1.1.1.1.1.1.2.cmml" xref="S2.p1.3.m3.1.1.1.1.1.1.1.2">𝐶</ci><ci id="S2.p1.3.m3.1.1.1.1.1.1.1.3.cmml" xref="S2.p1.3.m3.1.1.1.1.1.1.1.3">𝑖</ci></apply></set><apply id="S2.p1.3.m3.1.1.1.1.3.cmml" xref="S2.p1.3.m3.1.1.1.1.3"><eq id="S2.p1.3.m3.1.1.1.1.3.1.cmml" xref="S2.p1.3.m3.1.1.1.1.3.1"></eq><ci id="S2.p1.3.m3.1.1.1.1.3.2.cmml" xref="S2.p1.3.m3.1.1.1.1.3.2">𝑖</ci><cn id="S2.p1.3.m3.1.1.1.1.3.3.cmml" type="integer" xref="S2.p1.3.m3.1.1.1.1.3.3">1</cn></apply></apply><ci id="S2.p1.3.m3.1.1.1.3.cmml" xref="S2.p1.3.m3.1.1.1.3">𝐹</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.p1.3.m3.1c">\mathcal{C}=\{C_{i}\}_{i=1}^{F}</annotation><annotation encoding="application/x-llamapun" id="S2.p1.3.m3.1d">caligraphic_C = { italic_C start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT } start_POSTSUBSCRIPT italic_i = 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_F end_POSTSUPERSCRIPT</annotation></semantics></math> alongside a singular label column <math alttext="\mathcal{Y}" class="ltx_Math" display="inline" id="S2.p1.4.m4.1"><semantics id="S2.p1.4.m4.1a"><mi class="ltx_font_mathcaligraphic" id="S2.p1.4.m4.1.1" xref="S2.p1.4.m4.1.1.cmml">𝒴</mi><annotation-xml encoding="MathML-Content" id="S2.p1.4.m4.1b"><ci id="S2.p1.4.m4.1.1.cmml" xref="S2.p1.4.m4.1.1">𝒴</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.p1.4.m4.1c">\mathcal{Y}</annotation><annotation encoding="application/x-llamapun" id="S2.p1.4.m4.1d">caligraphic_Y</annotation></semantics></math>.
The feature columns encapsulate attributes such as ”Age,” ”City,” and ”Category.”
Each individual entry within table <math alttext="\mathcal{D}" class="ltx_Math" display="inline" id="S2.p1.5.m5.1"><semantics id="S2.p1.5.m5.1a"><mi class="ltx_font_mathcaligraphic" id="S2.p1.5.m5.1.1" xref="S2.p1.5.m5.1.1.cmml">𝒟</mi><annotation-xml encoding="MathML-Content" id="S2.p1.5.m5.1b"><ci id="S2.p1.5.m5.1.1.cmml" xref="S2.p1.5.m5.1.1">𝒟</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.p1.5.m5.1c">\mathcal{D}</annotation><annotation encoding="application/x-llamapun" id="S2.p1.5.m5.1d">caligraphic_D</annotation></semantics></math> corresponds to a sample <math alttext="s_{z}" class="ltx_Math" display="inline" id="S2.p1.6.m6.1"><semantics id="S2.p1.6.m6.1a"><msub id="S2.p1.6.m6.1.1" xref="S2.p1.6.m6.1.1.cmml"><mi id="S2.p1.6.m6.1.1.2" xref="S2.p1.6.m6.1.1.2.cmml">s</mi><mi id="S2.p1.6.m6.1.1.3" xref="S2.p1.6.m6.1.1.3.cmml">z</mi></msub><annotation-xml encoding="MathML-Content" id="S2.p1.6.m6.1b"><apply id="S2.p1.6.m6.1.1.cmml" xref="S2.p1.6.m6.1.1"><csymbol cd="ambiguous" id="S2.p1.6.m6.1.1.1.cmml" xref="S2.p1.6.m6.1.1">subscript</csymbol><ci id="S2.p1.6.m6.1.1.2.cmml" xref="S2.p1.6.m6.1.1.2">𝑠</ci><ci id="S2.p1.6.m6.1.1.3.cmml" xref="S2.p1.6.m6.1.1.3">𝑧</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.p1.6.m6.1c">s_{z}</annotation><annotation encoding="application/x-llamapun" id="S2.p1.6.m6.1d">italic_s start_POSTSUBSCRIPT italic_z end_POSTSUBSCRIPT</annotation></semantics></math>.
A sample is characterized by an amalgamation of multiple features along with a label, articulated as <math alttext="s_{z}=(x_{z},y_{z})" class="ltx_Math" display="inline" id="S2.p1.7.m7.2"><semantics id="S2.p1.7.m7.2a"><mrow id="S2.p1.7.m7.2.2" xref="S2.p1.7.m7.2.2.cmml"><msub id="S2.p1.7.m7.2.2.4" xref="S2.p1.7.m7.2.2.4.cmml"><mi id="S2.p1.7.m7.2.2.4.2" xref="S2.p1.7.m7.2.2.4.2.cmml">s</mi><mi id="S2.p1.7.m7.2.2.4.3" xref="S2.p1.7.m7.2.2.4.3.cmml">z</mi></msub><mo id="S2.p1.7.m7.2.2.3" xref="S2.p1.7.m7.2.2.3.cmml">=</mo><mrow id="S2.p1.7.m7.2.2.2.2" xref="S2.p1.7.m7.2.2.2.3.cmml"><mo id="S2.p1.7.m7.2.2.2.2.3" stretchy="false" xref="S2.p1.7.m7.2.2.2.3.cmml">(</mo><msub id="S2.p1.7.m7.1.1.1.1.1" xref="S2.p1.7.m7.1.1.1.1.1.cmml"><mi id="S2.p1.7.m7.1.1.1.1.1.2" xref="S2.p1.7.m7.1.1.1.1.1.2.cmml">x</mi><mi id="S2.p1.7.m7.1.1.1.1.1.3" xref="S2.p1.7.m7.1.1.1.1.1.3.cmml">z</mi></msub><mo id="S2.p1.7.m7.2.2.2.2.4" xref="S2.p1.7.m7.2.2.2.3.cmml">,</mo><msub id="S2.p1.7.m7.2.2.2.2.2" xref="S2.p1.7.m7.2.2.2.2.2.cmml"><mi id="S2.p1.7.m7.2.2.2.2.2.2" xref="S2.p1.7.m7.2.2.2.2.2.2.cmml">y</mi><mi id="S2.p1.7.m7.2.2.2.2.2.3" xref="S2.p1.7.m7.2.2.2.2.2.3.cmml">z</mi></msub><mo id="S2.p1.7.m7.2.2.2.2.5" stretchy="false" xref="S2.p1.7.m7.2.2.2.3.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.p1.7.m7.2b"><apply id="S2.p1.7.m7.2.2.cmml" xref="S2.p1.7.m7.2.2"><eq id="S2.p1.7.m7.2.2.3.cmml" xref="S2.p1.7.m7.2.2.3"></eq><apply id="S2.p1.7.m7.2.2.4.cmml" xref="S2.p1.7.m7.2.2.4"><csymbol cd="ambiguous" id="S2.p1.7.m7.2.2.4.1.cmml" xref="S2.p1.7.m7.2.2.4">subscript</csymbol><ci id="S2.p1.7.m7.2.2.4.2.cmml" xref="S2.p1.7.m7.2.2.4.2">𝑠</ci><ci id="S2.p1.7.m7.2.2.4.3.cmml" xref="S2.p1.7.m7.2.2.4.3">𝑧</ci></apply><interval closure="open" id="S2.p1.7.m7.2.2.2.3.cmml" xref="S2.p1.7.m7.2.2.2.2"><apply id="S2.p1.7.m7.1.1.1.1.1.cmml" xref="S2.p1.7.m7.1.1.1.1.1"><csymbol cd="ambiguous" id="S2.p1.7.m7.1.1.1.1.1.1.cmml" xref="S2.p1.7.m7.1.1.1.1.1">subscript</csymbol><ci id="S2.p1.7.m7.1.1.1.1.1.2.cmml" xref="S2.p1.7.m7.1.1.1.1.1.2">𝑥</ci><ci id="S2.p1.7.m7.1.1.1.1.1.3.cmml" xref="S2.p1.7.m7.1.1.1.1.1.3">𝑧</ci></apply><apply id="S2.p1.7.m7.2.2.2.2.2.cmml" xref="S2.p1.7.m7.2.2.2.2.2"><csymbol cd="ambiguous" id="S2.p1.7.m7.2.2.2.2.2.1.cmml" xref="S2.p1.7.m7.2.2.2.2.2">subscript</csymbol><ci id="S2.p1.7.m7.2.2.2.2.2.2.cmml" xref="S2.p1.7.m7.2.2.2.2.2.2">𝑦</ci><ci id="S2.p1.7.m7.2.2.2.2.2.3.cmml" xref="S2.p1.7.m7.2.2.2.2.2.3">𝑧</ci></apply></interval></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.p1.7.m7.2c">s_{z}=(x_{z},y_{z})</annotation><annotation encoding="application/x-llamapun" id="S2.p1.7.m7.2d">italic_s start_POSTSUBSCRIPT italic_z end_POSTSUBSCRIPT = ( italic_x start_POSTSUBSCRIPT italic_z end_POSTSUBSCRIPT , italic_y start_POSTSUBSCRIPT italic_z end_POSTSUBSCRIPT )</annotation></semantics></math>, where <math alttext="x_{z}=\{c_{i}^{z}\}_{i=1}^{F}" class="ltx_Math" display="inline" id="S2.p1.8.m8.1"><semantics id="S2.p1.8.m8.1a"><mrow id="S2.p1.8.m8.1.1" xref="S2.p1.8.m8.1.1.cmml"><msub id="S2.p1.8.m8.1.1.3" xref="S2.p1.8.m8.1.1.3.cmml"><mi id="S2.p1.8.m8.1.1.3.2" xref="S2.p1.8.m8.1.1.3.2.cmml">x</mi><mi id="S2.p1.8.m8.1.1.3.3" xref="S2.p1.8.m8.1.1.3.3.cmml">z</mi></msub><mo id="S2.p1.8.m8.1.1.2" xref="S2.p1.8.m8.1.1.2.cmml">=</mo><msubsup id="S2.p1.8.m8.1.1.1" xref="S2.p1.8.m8.1.1.1.cmml"><mrow id="S2.p1.8.m8.1.1.1.1.1.1" xref="S2.p1.8.m8.1.1.1.1.1.2.cmml"><mo id="S2.p1.8.m8.1.1.1.1.1.1.2" stretchy="false" xref="S2.p1.8.m8.1.1.1.1.1.2.cmml">{</mo><msubsup id="S2.p1.8.m8.1.1.1.1.1.1.1" xref="S2.p1.8.m8.1.1.1.1.1.1.1.cmml"><mi id="S2.p1.8.m8.1.1.1.1.1.1.1.2.2" xref="S2.p1.8.m8.1.1.1.1.1.1.1.2.2.cmml">c</mi><mi id="S2.p1.8.m8.1.1.1.1.1.1.1.2.3" xref="S2.p1.8.m8.1.1.1.1.1.1.1.2.3.cmml">i</mi><mi id="S2.p1.8.m8.1.1.1.1.1.1.1.3" xref="S2.p1.8.m8.1.1.1.1.1.1.1.3.cmml">z</mi></msubsup><mo id="S2.p1.8.m8.1.1.1.1.1.1.3" stretchy="false" xref="S2.p1.8.m8.1.1.1.1.1.2.cmml">}</mo></mrow><mrow id="S2.p1.8.m8.1.1.1.1.3" xref="S2.p1.8.m8.1.1.1.1.3.cmml"><mi id="S2.p1.8.m8.1.1.1.1.3.2" xref="S2.p1.8.m8.1.1.1.1.3.2.cmml">i</mi><mo id="S2.p1.8.m8.1.1.1.1.3.1" xref="S2.p1.8.m8.1.1.1.1.3.1.cmml">=</mo><mn id="S2.p1.8.m8.1.1.1.1.3.3" xref="S2.p1.8.m8.1.1.1.1.3.3.cmml">1</mn></mrow><mi id="S2.p1.8.m8.1.1.1.3" xref="S2.p1.8.m8.1.1.1.3.cmml">F</mi></msubsup></mrow><annotation-xml encoding="MathML-Content" id="S2.p1.8.m8.1b"><apply id="S2.p1.8.m8.1.1.cmml" xref="S2.p1.8.m8.1.1"><eq id="S2.p1.8.m8.1.1.2.cmml" xref="S2.p1.8.m8.1.1.2"></eq><apply id="S2.p1.8.m8.1.1.3.cmml" xref="S2.p1.8.m8.1.1.3"><csymbol cd="ambiguous" id="S2.p1.8.m8.1.1.3.1.cmml" xref="S2.p1.8.m8.1.1.3">subscript</csymbol><ci id="S2.p1.8.m8.1.1.3.2.cmml" xref="S2.p1.8.m8.1.1.3.2">𝑥</ci><ci id="S2.p1.8.m8.1.1.3.3.cmml" xref="S2.p1.8.m8.1.1.3.3">𝑧</ci></apply><apply id="S2.p1.8.m8.1.1.1.cmml" xref="S2.p1.8.m8.1.1.1"><csymbol cd="ambiguous" id="S2.p1.8.m8.1.1.1.2.cmml" xref="S2.p1.8.m8.1.1.1">superscript</csymbol><apply id="S2.p1.8.m8.1.1.1.1.cmml" xref="S2.p1.8.m8.1.1.1"><csymbol cd="ambiguous" id="S2.p1.8.m8.1.1.1.1.2.cmml" xref="S2.p1.8.m8.1.1.1">subscript</csymbol><set id="S2.p1.8.m8.1.1.1.1.1.2.cmml" xref="S2.p1.8.m8.1.1.1.1.1.1"><apply id="S2.p1.8.m8.1.1.1.1.1.1.1.cmml" xref="S2.p1.8.m8.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S2.p1.8.m8.1.1.1.1.1.1.1.1.cmml" xref="S2.p1.8.m8.1.1.1.1.1.1.1">superscript</csymbol><apply id="S2.p1.8.m8.1.1.1.1.1.1.1.2.cmml" xref="S2.p1.8.m8.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S2.p1.8.m8.1.1.1.1.1.1.1.2.1.cmml" xref="S2.p1.8.m8.1.1.1.1.1.1.1">subscript</csymbol><ci id="S2.p1.8.m8.1.1.1.1.1.1.1.2.2.cmml" xref="S2.p1.8.m8.1.1.1.1.1.1.1.2.2">𝑐</ci><ci id="S2.p1.8.m8.1.1.1.1.1.1.1.2.3.cmml" xref="S2.p1.8.m8.1.1.1.1.1.1.1.2.3">𝑖</ci></apply><ci id="S2.p1.8.m8.1.1.1.1.1.1.1.3.cmml" xref="S2.p1.8.m8.1.1.1.1.1.1.1.3">𝑧</ci></apply></set><apply id="S2.p1.8.m8.1.1.1.1.3.cmml" xref="S2.p1.8.m8.1.1.1.1.3"><eq id="S2.p1.8.m8.1.1.1.1.3.1.cmml" xref="S2.p1.8.m8.1.1.1.1.3.1"></eq><ci id="S2.p1.8.m8.1.1.1.1.3.2.cmml" xref="S2.p1.8.m8.1.1.1.1.3.2">𝑖</ci><cn id="S2.p1.8.m8.1.1.1.1.3.3.cmml" type="integer" xref="S2.p1.8.m8.1.1.1.1.3.3">1</cn></apply></apply><ci id="S2.p1.8.m8.1.1.1.3.cmml" xref="S2.p1.8.m8.1.1.1.3">𝐹</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.p1.8.m8.1c">x_{z}=\{c_{i}^{z}\}_{i=1}^{F}</annotation><annotation encoding="application/x-llamapun" id="S2.p1.8.m8.1d">italic_x start_POSTSUBSCRIPT italic_z end_POSTSUBSCRIPT = { italic_c start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_z end_POSTSUPERSCRIPT } start_POSTSUBSCRIPT italic_i = 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_F end_POSTSUPERSCRIPT</annotation></semantics></math>.
Accordingly, table <math alttext="\mathcal{D}" class="ltx_Math" display="inline" id="S2.p1.9.m9.1"><semantics id="S2.p1.9.m9.1a"><mi class="ltx_font_mathcaligraphic" id="S2.p1.9.m9.1.1" xref="S2.p1.9.m9.1.1.cmml">𝒟</mi><annotation-xml encoding="MathML-Content" id="S2.p1.9.m9.1b"><ci id="S2.p1.9.m9.1.1.cmml" xref="S2.p1.9.m9.1.1">𝒟</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.p1.9.m9.1c">\mathcal{D}</annotation><annotation encoding="application/x-llamapun" id="S2.p1.9.m9.1d">caligraphic_D</annotation></semantics></math> is defined as an ensemble of <math alttext="N" class="ltx_Math" display="inline" id="S2.p1.10.m10.1"><semantics id="S2.p1.10.m10.1a"><mi id="S2.p1.10.m10.1.1" xref="S2.p1.10.m10.1.1.cmml">N</mi><annotation-xml encoding="MathML-Content" id="S2.p1.10.m10.1b"><ci id="S2.p1.10.m10.1.1.cmml" xref="S2.p1.10.m10.1.1">𝑁</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.p1.10.m10.1c">N</annotation><annotation encoding="application/x-llamapun" id="S2.p1.10.m10.1d">italic_N</annotation></semantics></math> samples, expressed as <math alttext="\mathcal{D}=\{s_{z}\}_{z=1}^{N}" class="ltx_Math" display="inline" id="S2.p1.11.m11.1"><semantics id="S2.p1.11.m11.1a"><mrow id="S2.p1.11.m11.1.1" xref="S2.p1.11.m11.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S2.p1.11.m11.1.1.3" xref="S2.p1.11.m11.1.1.3.cmml">𝒟</mi><mo id="S2.p1.11.m11.1.1.2" xref="S2.p1.11.m11.1.1.2.cmml">=</mo><msubsup id="S2.p1.11.m11.1.1.1" xref="S2.p1.11.m11.1.1.1.cmml"><mrow id="S2.p1.11.m11.1.1.1.1.1.1" xref="S2.p1.11.m11.1.1.1.1.1.2.cmml"><mo id="S2.p1.11.m11.1.1.1.1.1.1.2" stretchy="false" xref="S2.p1.11.m11.1.1.1.1.1.2.cmml">{</mo><msub id="S2.p1.11.m11.1.1.1.1.1.1.1" xref="S2.p1.11.m11.1.1.1.1.1.1.1.cmml"><mi id="S2.p1.11.m11.1.1.1.1.1.1.1.2" xref="S2.p1.11.m11.1.1.1.1.1.1.1.2.cmml">s</mi><mi id="S2.p1.11.m11.1.1.1.1.1.1.1.3" xref="S2.p1.11.m11.1.1.1.1.1.1.1.3.cmml">z</mi></msub><mo id="S2.p1.11.m11.1.1.1.1.1.1.3" stretchy="false" xref="S2.p1.11.m11.1.1.1.1.1.2.cmml">}</mo></mrow><mrow id="S2.p1.11.m11.1.1.1.1.3" xref="S2.p1.11.m11.1.1.1.1.3.cmml"><mi id="S2.p1.11.m11.1.1.1.1.3.2" xref="S2.p1.11.m11.1.1.1.1.3.2.cmml">z</mi><mo id="S2.p1.11.m11.1.1.1.1.3.1" xref="S2.p1.11.m11.1.1.1.1.3.1.cmml">=</mo><mn id="S2.p1.11.m11.1.1.1.1.3.3" xref="S2.p1.11.m11.1.1.1.1.3.3.cmml">1</mn></mrow><mi id="S2.p1.11.m11.1.1.1.3" xref="S2.p1.11.m11.1.1.1.3.cmml">N</mi></msubsup></mrow><annotation-xml encoding="MathML-Content" id="S2.p1.11.m11.1b"><apply id="S2.p1.11.m11.1.1.cmml" xref="S2.p1.11.m11.1.1"><eq id="S2.p1.11.m11.1.1.2.cmml" xref="S2.p1.11.m11.1.1.2"></eq><ci id="S2.p1.11.m11.1.1.3.cmml" xref="S2.p1.11.m11.1.1.3">𝒟</ci><apply id="S2.p1.11.m11.1.1.1.cmml" xref="S2.p1.11.m11.1.1.1"><csymbol cd="ambiguous" id="S2.p1.11.m11.1.1.1.2.cmml" xref="S2.p1.11.m11.1.1.1">superscript</csymbol><apply id="S2.p1.11.m11.1.1.1.1.cmml" xref="S2.p1.11.m11.1.1.1"><csymbol cd="ambiguous" id="S2.p1.11.m11.1.1.1.1.2.cmml" xref="S2.p1.11.m11.1.1.1">subscript</csymbol><set id="S2.p1.11.m11.1.1.1.1.1.2.cmml" xref="S2.p1.11.m11.1.1.1.1.1.1"><apply id="S2.p1.11.m11.1.1.1.1.1.1.1.cmml" xref="S2.p1.11.m11.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S2.p1.11.m11.1.1.1.1.1.1.1.1.cmml" xref="S2.p1.11.m11.1.1.1.1.1.1.1">subscript</csymbol><ci id="S2.p1.11.m11.1.1.1.1.1.1.1.2.cmml" xref="S2.p1.11.m11.1.1.1.1.1.1.1.2">𝑠</ci><ci id="S2.p1.11.m11.1.1.1.1.1.1.1.3.cmml" xref="S2.p1.11.m11.1.1.1.1.1.1.1.3">𝑧</ci></apply></set><apply id="S2.p1.11.m11.1.1.1.1.3.cmml" xref="S2.p1.11.m11.1.1.1.1.3"><eq id="S2.p1.11.m11.1.1.1.1.3.1.cmml" xref="S2.p1.11.m11.1.1.1.1.3.1"></eq><ci id="S2.p1.11.m11.1.1.1.1.3.2.cmml" xref="S2.p1.11.m11.1.1.1.1.3.2">𝑧</ci><cn id="S2.p1.11.m11.1.1.1.1.3.3.cmml" type="integer" xref="S2.p1.11.m11.1.1.1.1.3.3">1</cn></apply></apply><ci id="S2.p1.11.m11.1.1.1.3.cmml" xref="S2.p1.11.m11.1.1.1.3">𝑁</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.p1.11.m11.1c">\mathcal{D}=\{s_{z}\}_{z=1}^{N}</annotation><annotation encoding="application/x-llamapun" id="S2.p1.11.m11.1d">caligraphic_D = { italic_s start_POSTSUBSCRIPT italic_z end_POSTSUBSCRIPT } start_POSTSUBSCRIPT italic_z = 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_N end_POSTSUPERSCRIPT</annotation></semantics></math>.</p>
</div>
<div class="ltx_para" id="S2.p2">
<p class="ltx_p" id="S2.p2.4">A click-through rate (CTR) model can be mathematically represented as a conditional probability, <math alttext="P(y|x)" class="ltx_Math" display="inline" id="S2.p2.1.m1.1"><semantics id="S2.p2.1.m1.1a"><mrow id="S2.p2.1.m1.1.1" xref="S2.p2.1.m1.1.1.cmml"><mi id="S2.p2.1.m1.1.1.3" xref="S2.p2.1.m1.1.1.3.cmml">P</mi><mo id="S2.p2.1.m1.1.1.2" xref="S2.p2.1.m1.1.1.2.cmml">⁢</mo><mrow id="S2.p2.1.m1.1.1.1.1" xref="S2.p2.1.m1.1.1.1.1.1.cmml"><mo id="S2.p2.1.m1.1.1.1.1.2" stretchy="false" xref="S2.p2.1.m1.1.1.1.1.1.cmml">(</mo><mrow id="S2.p2.1.m1.1.1.1.1.1" xref="S2.p2.1.m1.1.1.1.1.1.cmml"><mi id="S2.p2.1.m1.1.1.1.1.1.2" xref="S2.p2.1.m1.1.1.1.1.1.2.cmml">y</mi><mo fence="false" id="S2.p2.1.m1.1.1.1.1.1.1" xref="S2.p2.1.m1.1.1.1.1.1.1.cmml">|</mo><mi id="S2.p2.1.m1.1.1.1.1.1.3" xref="S2.p2.1.m1.1.1.1.1.1.3.cmml">x</mi></mrow><mo id="S2.p2.1.m1.1.1.1.1.3" stretchy="false" xref="S2.p2.1.m1.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.p2.1.m1.1b"><apply id="S2.p2.1.m1.1.1.cmml" xref="S2.p2.1.m1.1.1"><times id="S2.p2.1.m1.1.1.2.cmml" xref="S2.p2.1.m1.1.1.2"></times><ci id="S2.p2.1.m1.1.1.3.cmml" xref="S2.p2.1.m1.1.1.3">𝑃</ci><apply id="S2.p2.1.m1.1.1.1.1.1.cmml" xref="S2.p2.1.m1.1.1.1.1"><csymbol cd="latexml" id="S2.p2.1.m1.1.1.1.1.1.1.cmml" xref="S2.p2.1.m1.1.1.1.1.1.1">conditional</csymbol><ci id="S2.p2.1.m1.1.1.1.1.1.2.cmml" xref="S2.p2.1.m1.1.1.1.1.1.2">𝑦</ci><ci id="S2.p2.1.m1.1.1.1.1.1.3.cmml" xref="S2.p2.1.m1.1.1.1.1.1.3">𝑥</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.p2.1.m1.1c">P(y|x)</annotation><annotation encoding="application/x-llamapun" id="S2.p2.1.m1.1d">italic_P ( italic_y | italic_x )</annotation></semantics></math>, where <math alttext="y" class="ltx_Math" display="inline" id="S2.p2.2.m2.1"><semantics id="S2.p2.2.m2.1a"><mi id="S2.p2.2.m2.1.1" xref="S2.p2.2.m2.1.1.cmml">y</mi><annotation-xml encoding="MathML-Content" id="S2.p2.2.m2.1b"><ci id="S2.p2.2.m2.1.1.cmml" xref="S2.p2.2.m2.1.1">𝑦</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.p2.2.m2.1c">y</annotation><annotation encoding="application/x-llamapun" id="S2.p2.2.m2.1d">italic_y</annotation></semantics></math> is the event of a click, and <math alttext="x" class="ltx_Math" display="inline" id="S2.p2.3.m3.1"><semantics id="S2.p2.3.m3.1a"><mi id="S2.p2.3.m3.1.1" xref="S2.p2.3.m3.1.1.cmml">x</mi><annotation-xml encoding="MathML-Content" id="S2.p2.3.m3.1b"><ci id="S2.p2.3.m3.1.1.cmml" xref="S2.p2.3.m3.1.1">𝑥</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.p2.3.m3.1c">x</annotation><annotation encoding="application/x-llamapun" id="S2.p2.3.m3.1d">italic_x</annotation></semantics></math> represents the features. The goal of the model is to accurately estimate this probability given the features <math alttext="x" class="ltx_Math" display="inline" id="S2.p2.4.m4.1"><semantics id="S2.p2.4.m4.1a"><mi id="S2.p2.4.m4.1.1" xref="S2.p2.4.m4.1.1.cmml">x</mi><annotation-xml encoding="MathML-Content" id="S2.p2.4.m4.1b"><ci id="S2.p2.4.m4.1.1.cmml" xref="S2.p2.4.m4.1.1">𝑥</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.p2.4.m4.1c">x</annotation><annotation encoding="application/x-llamapun" id="S2.p2.4.m4.1d">italic_x</annotation></semantics></math>, which can include information about the item, the user, and the context.</p>
</div>
<div class="ltx_theorem ltx_theorem_theorem" id="S2.Thmtheorem1">
<h6 class="ltx_title ltx_runin ltx_font_smallcaps ltx_title_theorem">Theorem 2.1.</h6>
<div class="ltx_para" id="S2.Thmtheorem1.p1">
<p class="ltx_p" id="S2.Thmtheorem1.p1.1"><span class="ltx_text ltx_font_italic" id="S2.Thmtheorem1.p1.1.1">Temporal Invariance of Association.</span></p>
</div>
</div>
<div class="ltx_para" id="S2.p3">
<p class="ltx_p" id="S2.p3.11">In the paper, we model <math alttext="P(y|x)" class="ltx_Math" display="inline" id="S2.p3.1.m1.1"><semantics id="S2.p3.1.m1.1a"><mrow id="S2.p3.1.m1.1.1" xref="S2.p3.1.m1.1.1.cmml"><mi id="S2.p3.1.m1.1.1.3" xref="S2.p3.1.m1.1.1.3.cmml">P</mi><mo id="S2.p3.1.m1.1.1.2" xref="S2.p3.1.m1.1.1.2.cmml">⁢</mo><mrow id="S2.p3.1.m1.1.1.1.1" xref="S2.p3.1.m1.1.1.1.1.1.cmml"><mo id="S2.p3.1.m1.1.1.1.1.2" stretchy="false" xref="S2.p3.1.m1.1.1.1.1.1.cmml">(</mo><mrow id="S2.p3.1.m1.1.1.1.1.1" xref="S2.p3.1.m1.1.1.1.1.1.cmml"><mi id="S2.p3.1.m1.1.1.1.1.1.2" xref="S2.p3.1.m1.1.1.1.1.1.2.cmml">y</mi><mo fence="false" id="S2.p3.1.m1.1.1.1.1.1.1" xref="S2.p3.1.m1.1.1.1.1.1.1.cmml">|</mo><mi id="S2.p3.1.m1.1.1.1.1.1.3" xref="S2.p3.1.m1.1.1.1.1.1.3.cmml">x</mi></mrow><mo id="S2.p3.1.m1.1.1.1.1.3" stretchy="false" xref="S2.p3.1.m1.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.p3.1.m1.1b"><apply id="S2.p3.1.m1.1.1.cmml" xref="S2.p3.1.m1.1.1"><times id="S2.p3.1.m1.1.1.2.cmml" xref="S2.p3.1.m1.1.1.2"></times><ci id="S2.p3.1.m1.1.1.3.cmml" xref="S2.p3.1.m1.1.1.3">𝑃</ci><apply id="S2.p3.1.m1.1.1.1.1.1.cmml" xref="S2.p3.1.m1.1.1.1.1"><csymbol cd="latexml" id="S2.p3.1.m1.1.1.1.1.1.1.cmml" xref="S2.p3.1.m1.1.1.1.1.1.1">conditional</csymbol><ci id="S2.p3.1.m1.1.1.1.1.1.2.cmml" xref="S2.p3.1.m1.1.1.1.1.1.2">𝑦</ci><ci id="S2.p3.1.m1.1.1.1.1.1.3.cmml" xref="S2.p3.1.m1.1.1.1.1.1.3">𝑥</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.p3.1.m1.1c">P(y|x)</annotation><annotation encoding="application/x-llamapun" id="S2.p3.1.m1.1d">italic_P ( italic_y | italic_x )</annotation></semantics></math> as <math alttext="P(y|x,x_{s})" class="ltx_Math" display="inline" id="S2.p3.2.m2.2"><semantics id="S2.p3.2.m2.2a"><mrow id="S2.p3.2.m2.2.2" xref="S2.p3.2.m2.2.2.cmml"><mi id="S2.p3.2.m2.2.2.3" xref="S2.p3.2.m2.2.2.3.cmml">P</mi><mo id="S2.p3.2.m2.2.2.2" xref="S2.p3.2.m2.2.2.2.cmml">⁢</mo><mrow id="S2.p3.2.m2.2.2.1.1" xref="S2.p3.2.m2.2.2.1.1.1.cmml"><mo id="S2.p3.2.m2.2.2.1.1.2" stretchy="false" xref="S2.p3.2.m2.2.2.1.1.1.cmml">(</mo><mrow id="S2.p3.2.m2.2.2.1.1.1" xref="S2.p3.2.m2.2.2.1.1.1.cmml"><mi id="S2.p3.2.m2.2.2.1.1.1.3" xref="S2.p3.2.m2.2.2.1.1.1.3.cmml">y</mi><mo fence="false" id="S2.p3.2.m2.2.2.1.1.1.2" xref="S2.p3.2.m2.2.2.1.1.1.2.cmml">|</mo><mrow id="S2.p3.2.m2.2.2.1.1.1.1.1" xref="S2.p3.2.m2.2.2.1.1.1.1.2.cmml"><mi id="S2.p3.2.m2.1.1" xref="S2.p3.2.m2.1.1.cmml">x</mi><mo id="S2.p3.2.m2.2.2.1.1.1.1.1.2" xref="S2.p3.2.m2.2.2.1.1.1.1.2.cmml">,</mo><msub id="S2.p3.2.m2.2.2.1.1.1.1.1.1" xref="S2.p3.2.m2.2.2.1.1.1.1.1.1.cmml"><mi id="S2.p3.2.m2.2.2.1.1.1.1.1.1.2" xref="S2.p3.2.m2.2.2.1.1.1.1.1.1.2.cmml">x</mi><mi id="S2.p3.2.m2.2.2.1.1.1.1.1.1.3" xref="S2.p3.2.m2.2.2.1.1.1.1.1.1.3.cmml">s</mi></msub></mrow></mrow><mo id="S2.p3.2.m2.2.2.1.1.3" stretchy="false" xref="S2.p3.2.m2.2.2.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.p3.2.m2.2b"><apply id="S2.p3.2.m2.2.2.cmml" xref="S2.p3.2.m2.2.2"><times id="S2.p3.2.m2.2.2.2.cmml" xref="S2.p3.2.m2.2.2.2"></times><ci id="S2.p3.2.m2.2.2.3.cmml" xref="S2.p3.2.m2.2.2.3">𝑃</ci><apply id="S2.p3.2.m2.2.2.1.1.1.cmml" xref="S2.p3.2.m2.2.2.1.1"><csymbol cd="latexml" id="S2.p3.2.m2.2.2.1.1.1.2.cmml" xref="S2.p3.2.m2.2.2.1.1.1.2">conditional</csymbol><ci id="S2.p3.2.m2.2.2.1.1.1.3.cmml" xref="S2.p3.2.m2.2.2.1.1.1.3">𝑦</ci><list id="S2.p3.2.m2.2.2.1.1.1.1.2.cmml" xref="S2.p3.2.m2.2.2.1.1.1.1.1"><ci id="S2.p3.2.m2.1.1.cmml" xref="S2.p3.2.m2.1.1">𝑥</ci><apply id="S2.p3.2.m2.2.2.1.1.1.1.1.1.cmml" xref="S2.p3.2.m2.2.2.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S2.p3.2.m2.2.2.1.1.1.1.1.1.1.cmml" xref="S2.p3.2.m2.2.2.1.1.1.1.1.1">subscript</csymbol><ci id="S2.p3.2.m2.2.2.1.1.1.1.1.1.2.cmml" xref="S2.p3.2.m2.2.2.1.1.1.1.1.1.2">𝑥</ci><ci id="S2.p3.2.m2.2.2.1.1.1.1.1.1.3.cmml" xref="S2.p3.2.m2.2.2.1.1.1.1.1.1.3">𝑠</ci></apply></list></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.p3.2.m2.2c">P(y|x,x_{s})</annotation><annotation encoding="application/x-llamapun" id="S2.p3.2.m2.2d">italic_P ( italic_y | italic_x , italic_x start_POSTSUBSCRIPT italic_s end_POSTSUBSCRIPT )</annotation></semantics></math>, where <math alttext="x_{s}" class="ltx_Math" display="inline" id="S2.p3.3.m3.1"><semantics id="S2.p3.3.m3.1a"><msub id="S2.p3.3.m3.1.1" xref="S2.p3.3.m3.1.1.cmml"><mi id="S2.p3.3.m3.1.1.2" xref="S2.p3.3.m3.1.1.2.cmml">x</mi><mi id="S2.p3.3.m3.1.1.3" xref="S2.p3.3.m3.1.1.3.cmml">s</mi></msub><annotation-xml encoding="MathML-Content" id="S2.p3.3.m3.1b"><apply id="S2.p3.3.m3.1.1.cmml" xref="S2.p3.3.m3.1.1"><csymbol cd="ambiguous" id="S2.p3.3.m3.1.1.1.cmml" xref="S2.p3.3.m3.1.1">subscript</csymbol><ci id="S2.p3.3.m3.1.1.2.cmml" xref="S2.p3.3.m3.1.1.2">𝑥</ci><ci id="S2.p3.3.m3.1.1.3.cmml" xref="S2.p3.3.m3.1.1.3">𝑠</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.p3.3.m3.1c">x_{s}</annotation><annotation encoding="application/x-llamapun" id="S2.p3.3.m3.1d">italic_x start_POSTSUBSCRIPT italic_s end_POSTSUBSCRIPT</annotation></semantics></math> represents documents similar to <math alttext="x" class="ltx_Math" display="inline" id="S2.p3.4.m4.1"><semantics id="S2.p3.4.m4.1a"><mi id="S2.p3.4.m4.1.1" xref="S2.p3.4.m4.1.1.cmml">x</mi><annotation-xml encoding="MathML-Content" id="S2.p3.4.m4.1b"><ci id="S2.p3.4.m4.1.1.cmml" xref="S2.p3.4.m4.1.1">𝑥</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.p3.4.m4.1c">x</annotation><annotation encoding="application/x-llamapun" id="S2.p3.4.m4.1d">italic_x</annotation></semantics></math> within a fixed search space <math alttext="\mathcal{E}" class="ltx_Math" display="inline" id="S2.p3.5.m5.1"><semantics id="S2.p3.5.m5.1a"><mi class="ltx_font_mathcaligraphic" id="S2.p3.5.m5.1.1" xref="S2.p3.5.m5.1.1.cmml">ℰ</mi><annotation-xml encoding="MathML-Content" id="S2.p3.5.m5.1b"><ci id="S2.p3.5.m5.1.1.cmml" xref="S2.p3.5.m5.1.1">ℰ</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.p3.5.m5.1c">\mathcal{E}</annotation><annotation encoding="application/x-llamapun" id="S2.p3.5.m5.1d">caligraphic_E</annotation></semantics></math>.
Given that the probability distribution of <math alttext="P(y|x,x_{s})" class="ltx_Math" display="inline" id="S2.p3.6.m6.2"><semantics id="S2.p3.6.m6.2a"><mrow id="S2.p3.6.m6.2.2" xref="S2.p3.6.m6.2.2.cmml"><mi id="S2.p3.6.m6.2.2.3" xref="S2.p3.6.m6.2.2.3.cmml">P</mi><mo id="S2.p3.6.m6.2.2.2" xref="S2.p3.6.m6.2.2.2.cmml">⁢</mo><mrow id="S2.p3.6.m6.2.2.1.1" xref="S2.p3.6.m6.2.2.1.1.1.cmml"><mo id="S2.p3.6.m6.2.2.1.1.2" stretchy="false" xref="S2.p3.6.m6.2.2.1.1.1.cmml">(</mo><mrow id="S2.p3.6.m6.2.2.1.1.1" xref="S2.p3.6.m6.2.2.1.1.1.cmml"><mi id="S2.p3.6.m6.2.2.1.1.1.3" xref="S2.p3.6.m6.2.2.1.1.1.3.cmml">y</mi><mo fence="false" id="S2.p3.6.m6.2.2.1.1.1.2" xref="S2.p3.6.m6.2.2.1.1.1.2.cmml">|</mo><mrow id="S2.p3.6.m6.2.2.1.1.1.1.1" xref="S2.p3.6.m6.2.2.1.1.1.1.2.cmml"><mi id="S2.p3.6.m6.1.1" xref="S2.p3.6.m6.1.1.cmml">x</mi><mo id="S2.p3.6.m6.2.2.1.1.1.1.1.2" xref="S2.p3.6.m6.2.2.1.1.1.1.2.cmml">,</mo><msub id="S2.p3.6.m6.2.2.1.1.1.1.1.1" xref="S2.p3.6.m6.2.2.1.1.1.1.1.1.cmml"><mi id="S2.p3.6.m6.2.2.1.1.1.1.1.1.2" xref="S2.p3.6.m6.2.2.1.1.1.1.1.1.2.cmml">x</mi><mi id="S2.p3.6.m6.2.2.1.1.1.1.1.1.3" xref="S2.p3.6.m6.2.2.1.1.1.1.1.1.3.cmml">s</mi></msub></mrow></mrow><mo id="S2.p3.6.m6.2.2.1.1.3" stretchy="false" xref="S2.p3.6.m6.2.2.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.p3.6.m6.2b"><apply id="S2.p3.6.m6.2.2.cmml" xref="S2.p3.6.m6.2.2"><times id="S2.p3.6.m6.2.2.2.cmml" xref="S2.p3.6.m6.2.2.2"></times><ci id="S2.p3.6.m6.2.2.3.cmml" xref="S2.p3.6.m6.2.2.3">𝑃</ci><apply id="S2.p3.6.m6.2.2.1.1.1.cmml" xref="S2.p3.6.m6.2.2.1.1"><csymbol cd="latexml" id="S2.p3.6.m6.2.2.1.1.1.2.cmml" xref="S2.p3.6.m6.2.2.1.1.1.2">conditional</csymbol><ci id="S2.p3.6.m6.2.2.1.1.1.3.cmml" xref="S2.p3.6.m6.2.2.1.1.1.3">𝑦</ci><list id="S2.p3.6.m6.2.2.1.1.1.1.2.cmml" xref="S2.p3.6.m6.2.2.1.1.1.1.1"><ci id="S2.p3.6.m6.1.1.cmml" xref="S2.p3.6.m6.1.1">𝑥</ci><apply id="S2.p3.6.m6.2.2.1.1.1.1.1.1.cmml" xref="S2.p3.6.m6.2.2.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S2.p3.6.m6.2.2.1.1.1.1.1.1.1.cmml" xref="S2.p3.6.m6.2.2.1.1.1.1.1.1">subscript</csymbol><ci id="S2.p3.6.m6.2.2.1.1.1.1.1.1.2.cmml" xref="S2.p3.6.m6.2.2.1.1.1.1.1.1.2">𝑥</ci><ci id="S2.p3.6.m6.2.2.1.1.1.1.1.1.3.cmml" xref="S2.p3.6.m6.2.2.1.1.1.1.1.1.3">𝑠</ci></apply></list></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.p3.6.m6.2c">P(y|x,x_{s})</annotation><annotation encoding="application/x-llamapun" id="S2.p3.6.m6.2d">italic_P ( italic_y | italic_x , italic_x start_POSTSUBSCRIPT italic_s end_POSTSUBSCRIPT )</annotation></semantics></math> changes over time, while the probability distribution of <math alttext="P(x_{s}|x)" class="ltx_Math" display="inline" id="S2.p3.7.m7.1"><semantics id="S2.p3.7.m7.1a"><mrow id="S2.p3.7.m7.1.1" xref="S2.p3.7.m7.1.1.cmml"><mi id="S2.p3.7.m7.1.1.3" xref="S2.p3.7.m7.1.1.3.cmml">P</mi><mo id="S2.p3.7.m7.1.1.2" xref="S2.p3.7.m7.1.1.2.cmml">⁢</mo><mrow id="S2.p3.7.m7.1.1.1.1" xref="S2.p3.7.m7.1.1.1.1.1.cmml"><mo id="S2.p3.7.m7.1.1.1.1.2" stretchy="false" xref="S2.p3.7.m7.1.1.1.1.1.cmml">(</mo><mrow id="S2.p3.7.m7.1.1.1.1.1" xref="S2.p3.7.m7.1.1.1.1.1.cmml"><msub id="S2.p3.7.m7.1.1.1.1.1.2" xref="S2.p3.7.m7.1.1.1.1.1.2.cmml"><mi id="S2.p3.7.m7.1.1.1.1.1.2.2" xref="S2.p3.7.m7.1.1.1.1.1.2.2.cmml">x</mi><mi id="S2.p3.7.m7.1.1.1.1.1.2.3" xref="S2.p3.7.m7.1.1.1.1.1.2.3.cmml">s</mi></msub><mo fence="false" id="S2.p3.7.m7.1.1.1.1.1.1" xref="S2.p3.7.m7.1.1.1.1.1.1.cmml">|</mo><mi id="S2.p3.7.m7.1.1.1.1.1.3" xref="S2.p3.7.m7.1.1.1.1.1.3.cmml">x</mi></mrow><mo id="S2.p3.7.m7.1.1.1.1.3" stretchy="false" xref="S2.p3.7.m7.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.p3.7.m7.1b"><apply id="S2.p3.7.m7.1.1.cmml" xref="S2.p3.7.m7.1.1"><times id="S2.p3.7.m7.1.1.2.cmml" xref="S2.p3.7.m7.1.1.2"></times><ci id="S2.p3.7.m7.1.1.3.cmml" xref="S2.p3.7.m7.1.1.3">𝑃</ci><apply id="S2.p3.7.m7.1.1.1.1.1.cmml" xref="S2.p3.7.m7.1.1.1.1"><csymbol cd="latexml" id="S2.p3.7.m7.1.1.1.1.1.1.cmml" xref="S2.p3.7.m7.1.1.1.1.1.1">conditional</csymbol><apply id="S2.p3.7.m7.1.1.1.1.1.2.cmml" xref="S2.p3.7.m7.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S2.p3.7.m7.1.1.1.1.1.2.1.cmml" xref="S2.p3.7.m7.1.1.1.1.1.2">subscript</csymbol><ci id="S2.p3.7.m7.1.1.1.1.1.2.2.cmml" xref="S2.p3.7.m7.1.1.1.1.1.2.2">𝑥</ci><ci id="S2.p3.7.m7.1.1.1.1.1.2.3.cmml" xref="S2.p3.7.m7.1.1.1.1.1.2.3">𝑠</ci></apply><ci id="S2.p3.7.m7.1.1.1.1.1.3.cmml" xref="S2.p3.7.m7.1.1.1.1.1.3">𝑥</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.p3.7.m7.1c">P(x_{s}|x)</annotation><annotation encoding="application/x-llamapun" id="S2.p3.7.m7.1d">italic_P ( italic_x start_POSTSUBSCRIPT italic_s end_POSTSUBSCRIPT | italic_x )</annotation></semantics></math> remains constant, we can utilize the data come from the time-varying <math alttext="P(y|x,x_{s})" class="ltx_Math" display="inline" id="S2.p3.8.m8.2"><semantics id="S2.p3.8.m8.2a"><mrow id="S2.p3.8.m8.2.2" xref="S2.p3.8.m8.2.2.cmml"><mi id="S2.p3.8.m8.2.2.3" xref="S2.p3.8.m8.2.2.3.cmml">P</mi><mo id="S2.p3.8.m8.2.2.2" xref="S2.p3.8.m8.2.2.2.cmml">⁢</mo><mrow id="S2.p3.8.m8.2.2.1.1" xref="S2.p3.8.m8.2.2.1.1.1.cmml"><mo id="S2.p3.8.m8.2.2.1.1.2" stretchy="false" xref="S2.p3.8.m8.2.2.1.1.1.cmml">(</mo><mrow id="S2.p3.8.m8.2.2.1.1.1" xref="S2.p3.8.m8.2.2.1.1.1.cmml"><mi id="S2.p3.8.m8.2.2.1.1.1.3" xref="S2.p3.8.m8.2.2.1.1.1.3.cmml">y</mi><mo fence="false" id="S2.p3.8.m8.2.2.1.1.1.2" xref="S2.p3.8.m8.2.2.1.1.1.2.cmml">|</mo><mrow id="S2.p3.8.m8.2.2.1.1.1.1.1" xref="S2.p3.8.m8.2.2.1.1.1.1.2.cmml"><mi id="S2.p3.8.m8.1.1" xref="S2.p3.8.m8.1.1.cmml">x</mi><mo id="S2.p3.8.m8.2.2.1.1.1.1.1.2" xref="S2.p3.8.m8.2.2.1.1.1.1.2.cmml">,</mo><msub id="S2.p3.8.m8.2.2.1.1.1.1.1.1" xref="S2.p3.8.m8.2.2.1.1.1.1.1.1.cmml"><mi id="S2.p3.8.m8.2.2.1.1.1.1.1.1.2" xref="S2.p3.8.m8.2.2.1.1.1.1.1.1.2.cmml">x</mi><mi id="S2.p3.8.m8.2.2.1.1.1.1.1.1.3" xref="S2.p3.8.m8.2.2.1.1.1.1.1.1.3.cmml">s</mi></msub></mrow></mrow><mo id="S2.p3.8.m8.2.2.1.1.3" stretchy="false" xref="S2.p3.8.m8.2.2.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.p3.8.m8.2b"><apply id="S2.p3.8.m8.2.2.cmml" xref="S2.p3.8.m8.2.2"><times id="S2.p3.8.m8.2.2.2.cmml" xref="S2.p3.8.m8.2.2.2"></times><ci id="S2.p3.8.m8.2.2.3.cmml" xref="S2.p3.8.m8.2.2.3">𝑃</ci><apply id="S2.p3.8.m8.2.2.1.1.1.cmml" xref="S2.p3.8.m8.2.2.1.1"><csymbol cd="latexml" id="S2.p3.8.m8.2.2.1.1.1.2.cmml" xref="S2.p3.8.m8.2.2.1.1.1.2">conditional</csymbol><ci id="S2.p3.8.m8.2.2.1.1.1.3.cmml" xref="S2.p3.8.m8.2.2.1.1.1.3">𝑦</ci><list id="S2.p3.8.m8.2.2.1.1.1.1.2.cmml" xref="S2.p3.8.m8.2.2.1.1.1.1.1"><ci id="S2.p3.8.m8.1.1.cmml" xref="S2.p3.8.m8.1.1">𝑥</ci><apply id="S2.p3.8.m8.2.2.1.1.1.1.1.1.cmml" xref="S2.p3.8.m8.2.2.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S2.p3.8.m8.2.2.1.1.1.1.1.1.1.cmml" xref="S2.p3.8.m8.2.2.1.1.1.1.1.1">subscript</csymbol><ci id="S2.p3.8.m8.2.2.1.1.1.1.1.1.2.cmml" xref="S2.p3.8.m8.2.2.1.1.1.1.1.1.2">𝑥</ci><ci id="S2.p3.8.m8.2.2.1.1.1.1.1.1.3.cmml" xref="S2.p3.8.m8.2.2.1.1.1.1.1.1.3">𝑠</ci></apply></list></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.p3.8.m8.2c">P(y|x,x_{s})</annotation><annotation encoding="application/x-llamapun" id="S2.p3.8.m8.2d">italic_P ( italic_y | italic_x , italic_x start_POSTSUBSCRIPT italic_s end_POSTSUBSCRIPT )</annotation></semantics></math> to train a model that represents <math alttext="P(x_{s}|x)" class="ltx_Math" display="inline" id="S2.p3.9.m9.1"><semantics id="S2.p3.9.m9.1a"><mrow id="S2.p3.9.m9.1.1" xref="S2.p3.9.m9.1.1.cmml"><mi id="S2.p3.9.m9.1.1.3" xref="S2.p3.9.m9.1.1.3.cmml">P</mi><mo id="S2.p3.9.m9.1.1.2" xref="S2.p3.9.m9.1.1.2.cmml">⁢</mo><mrow id="S2.p3.9.m9.1.1.1.1" xref="S2.p3.9.m9.1.1.1.1.1.cmml"><mo id="S2.p3.9.m9.1.1.1.1.2" stretchy="false" xref="S2.p3.9.m9.1.1.1.1.1.cmml">(</mo><mrow id="S2.p3.9.m9.1.1.1.1.1" xref="S2.p3.9.m9.1.1.1.1.1.cmml"><msub id="S2.p3.9.m9.1.1.1.1.1.2" xref="S2.p3.9.m9.1.1.1.1.1.2.cmml"><mi id="S2.p3.9.m9.1.1.1.1.1.2.2" xref="S2.p3.9.m9.1.1.1.1.1.2.2.cmml">x</mi><mi id="S2.p3.9.m9.1.1.1.1.1.2.3" xref="S2.p3.9.m9.1.1.1.1.1.2.3.cmml">s</mi></msub><mo fence="false" id="S2.p3.9.m9.1.1.1.1.1.1" xref="S2.p3.9.m9.1.1.1.1.1.1.cmml">|</mo><mi id="S2.p3.9.m9.1.1.1.1.1.3" xref="S2.p3.9.m9.1.1.1.1.1.3.cmml">x</mi></mrow><mo id="S2.p3.9.m9.1.1.1.1.3" stretchy="false" xref="S2.p3.9.m9.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.p3.9.m9.1b"><apply id="S2.p3.9.m9.1.1.cmml" xref="S2.p3.9.m9.1.1"><times id="S2.p3.9.m9.1.1.2.cmml" xref="S2.p3.9.m9.1.1.2"></times><ci id="S2.p3.9.m9.1.1.3.cmml" xref="S2.p3.9.m9.1.1.3">𝑃</ci><apply id="S2.p3.9.m9.1.1.1.1.1.cmml" xref="S2.p3.9.m9.1.1.1.1"><csymbol cd="latexml" id="S2.p3.9.m9.1.1.1.1.1.1.cmml" xref="S2.p3.9.m9.1.1.1.1.1.1">conditional</csymbol><apply id="S2.p3.9.m9.1.1.1.1.1.2.cmml" xref="S2.p3.9.m9.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S2.p3.9.m9.1.1.1.1.1.2.1.cmml" xref="S2.p3.9.m9.1.1.1.1.1.2">subscript</csymbol><ci id="S2.p3.9.m9.1.1.1.1.1.2.2.cmml" xref="S2.p3.9.m9.1.1.1.1.1.2.2">𝑥</ci><ci id="S2.p3.9.m9.1.1.1.1.1.2.3.cmml" xref="S2.p3.9.m9.1.1.1.1.1.2.3">𝑠</ci></apply><ci id="S2.p3.9.m9.1.1.1.1.1.3.cmml" xref="S2.p3.9.m9.1.1.1.1.1.3">𝑥</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.p3.9.m9.1c">P(x_{s}|x)</annotation><annotation encoding="application/x-llamapun" id="S2.p3.9.m9.1d">italic_P ( italic_x start_POSTSUBSCRIPT italic_s end_POSTSUBSCRIPT | italic_x )</annotation></semantics></math>.
This process allows us to capture the temporal dynamics in <math alttext="P(y|x)" class="ltx_Math" display="inline" id="S2.p3.10.m10.1"><semantics id="S2.p3.10.m10.1a"><mrow id="S2.p3.10.m10.1.1" xref="S2.p3.10.m10.1.1.cmml"><mi id="S2.p3.10.m10.1.1.3" xref="S2.p3.10.m10.1.1.3.cmml">P</mi><mo id="S2.p3.10.m10.1.1.2" xref="S2.p3.10.m10.1.1.2.cmml">⁢</mo><mrow id="S2.p3.10.m10.1.1.1.1" xref="S2.p3.10.m10.1.1.1.1.1.cmml"><mo id="S2.p3.10.m10.1.1.1.1.2" stretchy="false" xref="S2.p3.10.m10.1.1.1.1.1.cmml">(</mo><mrow id="S2.p3.10.m10.1.1.1.1.1" xref="S2.p3.10.m10.1.1.1.1.1.cmml"><mi id="S2.p3.10.m10.1.1.1.1.1.2" xref="S2.p3.10.m10.1.1.1.1.1.2.cmml">y</mi><mo fence="false" id="S2.p3.10.m10.1.1.1.1.1.1" xref="S2.p3.10.m10.1.1.1.1.1.1.cmml">|</mo><mi id="S2.p3.10.m10.1.1.1.1.1.3" xref="S2.p3.10.m10.1.1.1.1.1.3.cmml">x</mi></mrow><mo id="S2.p3.10.m10.1.1.1.1.3" stretchy="false" xref="S2.p3.10.m10.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.p3.10.m10.1b"><apply id="S2.p3.10.m10.1.1.cmml" xref="S2.p3.10.m10.1.1"><times id="S2.p3.10.m10.1.1.2.cmml" xref="S2.p3.10.m10.1.1.2"></times><ci id="S2.p3.10.m10.1.1.3.cmml" xref="S2.p3.10.m10.1.1.3">𝑃</ci><apply id="S2.p3.10.m10.1.1.1.1.1.cmml" xref="S2.p3.10.m10.1.1.1.1"><csymbol cd="latexml" id="S2.p3.10.m10.1.1.1.1.1.1.cmml" xref="S2.p3.10.m10.1.1.1.1.1.1">conditional</csymbol><ci id="S2.p3.10.m10.1.1.1.1.1.2.cmml" xref="S2.p3.10.m10.1.1.1.1.1.2">𝑦</ci><ci id="S2.p3.10.m10.1.1.1.1.1.3.cmml" xref="S2.p3.10.m10.1.1.1.1.1.3">𝑥</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.p3.10.m10.1c">P(y|x)</annotation><annotation encoding="application/x-llamapun" id="S2.p3.10.m10.1d">italic_P ( italic_y | italic_x )</annotation></semantics></math> while leveraging the time-invariant properties of <math alttext="P(x_{s}|x)" class="ltx_Math" display="inline" id="S2.p3.11.m11.1"><semantics id="S2.p3.11.m11.1a"><mrow id="S2.p3.11.m11.1.1" xref="S2.p3.11.m11.1.1.cmml"><mi id="S2.p3.11.m11.1.1.3" xref="S2.p3.11.m11.1.1.3.cmml">P</mi><mo id="S2.p3.11.m11.1.1.2" xref="S2.p3.11.m11.1.1.2.cmml">⁢</mo><mrow id="S2.p3.11.m11.1.1.1.1" xref="S2.p3.11.m11.1.1.1.1.1.cmml"><mo id="S2.p3.11.m11.1.1.1.1.2" stretchy="false" xref="S2.p3.11.m11.1.1.1.1.1.cmml">(</mo><mrow id="S2.p3.11.m11.1.1.1.1.1" xref="S2.p3.11.m11.1.1.1.1.1.cmml"><msub id="S2.p3.11.m11.1.1.1.1.1.2" xref="S2.p3.11.m11.1.1.1.1.1.2.cmml"><mi id="S2.p3.11.m11.1.1.1.1.1.2.2" xref="S2.p3.11.m11.1.1.1.1.1.2.2.cmml">x</mi><mi id="S2.p3.11.m11.1.1.1.1.1.2.3" xref="S2.p3.11.m11.1.1.1.1.1.2.3.cmml">s</mi></msub><mo fence="false" id="S2.p3.11.m11.1.1.1.1.1.1" xref="S2.p3.11.m11.1.1.1.1.1.1.cmml">|</mo><mi id="S2.p3.11.m11.1.1.1.1.1.3" xref="S2.p3.11.m11.1.1.1.1.1.3.cmml">x</mi></mrow><mo id="S2.p3.11.m11.1.1.1.1.3" stretchy="false" xref="S2.p3.11.m11.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.p3.11.m11.1b"><apply id="S2.p3.11.m11.1.1.cmml" xref="S2.p3.11.m11.1.1"><times id="S2.p3.11.m11.1.1.2.cmml" xref="S2.p3.11.m11.1.1.2"></times><ci id="S2.p3.11.m11.1.1.3.cmml" xref="S2.p3.11.m11.1.1.3">𝑃</ci><apply id="S2.p3.11.m11.1.1.1.1.1.cmml" xref="S2.p3.11.m11.1.1.1.1"><csymbol cd="latexml" id="S2.p3.11.m11.1.1.1.1.1.1.cmml" xref="S2.p3.11.m11.1.1.1.1.1.1">conditional</csymbol><apply id="S2.p3.11.m11.1.1.1.1.1.2.cmml" xref="S2.p3.11.m11.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S2.p3.11.m11.1.1.1.1.1.2.1.cmml" xref="S2.p3.11.m11.1.1.1.1.1.2">subscript</csymbol><ci id="S2.p3.11.m11.1.1.1.1.1.2.2.cmml" xref="S2.p3.11.m11.1.1.1.1.1.2.2">𝑥</ci><ci id="S2.p3.11.m11.1.1.1.1.1.2.3.cmml" xref="S2.p3.11.m11.1.1.1.1.1.2.3">𝑠</ci></apply><ci id="S2.p3.11.m11.1.1.1.1.1.3.cmml" xref="S2.p3.11.m11.1.1.1.1.1.3">𝑥</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.p3.11.m11.1c">P(x_{s}|x)</annotation><annotation encoding="application/x-llamapun" id="S2.p3.11.m11.1d">italic_P ( italic_x start_POSTSUBSCRIPT italic_s end_POSTSUBSCRIPT | italic_x )</annotation></semantics></math>, thereby enhancing the model’s adaptability to temporal changes in the future.</p>
</div>
<div class="ltx_para" id="S2.p4">
<p class="ltx_p" id="S2.p4.7">We partition the dataset by date into three segments.
The last few days, denoted as <math alttext="\mathcal{D}_{[t+1,t+\Delta]}" class="ltx_Math" display="inline" id="S2.p4.1.m1.2"><semantics id="S2.p4.1.m1.2a"><msub id="S2.p4.1.m1.2.3" xref="S2.p4.1.m1.2.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S2.p4.1.m1.2.3.2" xref="S2.p4.1.m1.2.3.2.cmml">𝒟</mi><mrow id="S2.p4.1.m1.2.2.2.2" xref="S2.p4.1.m1.2.2.2.3.cmml"><mo id="S2.p4.1.m1.2.2.2.2.3" stretchy="false" xref="S2.p4.1.m1.2.2.2.3.cmml">[</mo><mrow id="S2.p4.1.m1.1.1.1.1.1" xref="S2.p4.1.m1.1.1.1.1.1.cmml"><mi id="S2.p4.1.m1.1.1.1.1.1.2" xref="S2.p4.1.m1.1.1.1.1.1.2.cmml">t</mi><mo id="S2.p4.1.m1.1.1.1.1.1.1" xref="S2.p4.1.m1.1.1.1.1.1.1.cmml">+</mo><mn id="S2.p4.1.m1.1.1.1.1.1.3" xref="S2.p4.1.m1.1.1.1.1.1.3.cmml">1</mn></mrow><mo id="S2.p4.1.m1.2.2.2.2.4" xref="S2.p4.1.m1.2.2.2.3.cmml">,</mo><mrow id="S2.p4.1.m1.2.2.2.2.2" xref="S2.p4.1.m1.2.2.2.2.2.cmml"><mi id="S2.p4.1.m1.2.2.2.2.2.2" xref="S2.p4.1.m1.2.2.2.2.2.2.cmml">t</mi><mo id="S2.p4.1.m1.2.2.2.2.2.1" xref="S2.p4.1.m1.2.2.2.2.2.1.cmml">+</mo><mi id="S2.p4.1.m1.2.2.2.2.2.3" mathvariant="normal" xref="S2.p4.1.m1.2.2.2.2.2.3.cmml">Δ</mi></mrow><mo id="S2.p4.1.m1.2.2.2.2.5" stretchy="false" xref="S2.p4.1.m1.2.2.2.3.cmml">]</mo></mrow></msub><annotation-xml encoding="MathML-Content" id="S2.p4.1.m1.2b"><apply id="S2.p4.1.m1.2.3.cmml" xref="S2.p4.1.m1.2.3"><csymbol cd="ambiguous" id="S2.p4.1.m1.2.3.1.cmml" xref="S2.p4.1.m1.2.3">subscript</csymbol><ci id="S2.p4.1.m1.2.3.2.cmml" xref="S2.p4.1.m1.2.3.2">𝒟</ci><interval closure="closed" id="S2.p4.1.m1.2.2.2.3.cmml" xref="S2.p4.1.m1.2.2.2.2"><apply id="S2.p4.1.m1.1.1.1.1.1.cmml" xref="S2.p4.1.m1.1.1.1.1.1"><plus id="S2.p4.1.m1.1.1.1.1.1.1.cmml" xref="S2.p4.1.m1.1.1.1.1.1.1"></plus><ci id="S2.p4.1.m1.1.1.1.1.1.2.cmml" xref="S2.p4.1.m1.1.1.1.1.1.2">𝑡</ci><cn id="S2.p4.1.m1.1.1.1.1.1.3.cmml" type="integer" xref="S2.p4.1.m1.1.1.1.1.1.3">1</cn></apply><apply id="S2.p4.1.m1.2.2.2.2.2.cmml" xref="S2.p4.1.m1.2.2.2.2.2"><plus id="S2.p4.1.m1.2.2.2.2.2.1.cmml" xref="S2.p4.1.m1.2.2.2.2.2.1"></plus><ci id="S2.p4.1.m1.2.2.2.2.2.2.cmml" xref="S2.p4.1.m1.2.2.2.2.2.2">𝑡</ci><ci id="S2.p4.1.m1.2.2.2.2.2.3.cmml" xref="S2.p4.1.m1.2.2.2.2.2.3">Δ</ci></apply></interval></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.p4.1.m1.2c">\mathcal{D}_{[t+1,t+\Delta]}</annotation><annotation encoding="application/x-llamapun" id="S2.p4.1.m1.2d">caligraphic_D start_POSTSUBSCRIPT [ italic_t + 1 , italic_t + roman_Δ ] end_POSTSUBSCRIPT</annotation></semantics></math>, serve as the test set, <math alttext="\mathcal{D}_{\text{test}}" class="ltx_Math" display="inline" id="S2.p4.2.m2.1"><semantics id="S2.p4.2.m2.1a"><msub id="S2.p4.2.m2.1.1" xref="S2.p4.2.m2.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S2.p4.2.m2.1.1.2" xref="S2.p4.2.m2.1.1.2.cmml">𝒟</mi><mtext id="S2.p4.2.m2.1.1.3" xref="S2.p4.2.m2.1.1.3a.cmml">test</mtext></msub><annotation-xml encoding="MathML-Content" id="S2.p4.2.m2.1b"><apply id="S2.p4.2.m2.1.1.cmml" xref="S2.p4.2.m2.1.1"><csymbol cd="ambiguous" id="S2.p4.2.m2.1.1.1.cmml" xref="S2.p4.2.m2.1.1">subscript</csymbol><ci id="S2.p4.2.m2.1.1.2.cmml" xref="S2.p4.2.m2.1.1.2">𝒟</ci><ci id="S2.p4.2.m2.1.1.3a.cmml" xref="S2.p4.2.m2.1.1.3"><mtext id="S2.p4.2.m2.1.1.3.cmml" mathsize="70%" xref="S2.p4.2.m2.1.1.3">test</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.p4.2.m2.1c">\mathcal{D}_{\text{test}}</annotation><annotation encoding="application/x-llamapun" id="S2.p4.2.m2.1d">caligraphic_D start_POSTSUBSCRIPT test end_POSTSUBSCRIPT</annotation></semantics></math>.
Data within a window of <math alttext="d" class="ltx_Math" display="inline" id="S2.p4.3.m3.1"><semantics id="S2.p4.3.m3.1a"><mi id="S2.p4.3.m3.1.1" xref="S2.p4.3.m3.1.1.cmml">d</mi><annotation-xml encoding="MathML-Content" id="S2.p4.3.m3.1b"><ci id="S2.p4.3.m3.1.1.cmml" xref="S2.p4.3.m3.1.1">𝑑</ci></annotation-xml><annotation encoding="application/x-tex" id="S2.p4.3.m3.1c">d</annotation><annotation encoding="application/x-llamapun" id="S2.p4.3.m3.1d">italic_d</annotation></semantics></math> days prior to the test dates is considered unshifting data, which is <math alttext="\mathcal{D}_{[t-d+1,t]}" class="ltx_Math" display="inline" id="S2.p4.4.m4.2"><semantics id="S2.p4.4.m4.2a"><msub id="S2.p4.4.m4.2.3" xref="S2.p4.4.m4.2.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S2.p4.4.m4.2.3.2" xref="S2.p4.4.m4.2.3.2.cmml">𝒟</mi><mrow id="S2.p4.4.m4.2.2.2.2" xref="S2.p4.4.m4.2.2.2.3.cmml"><mo id="S2.p4.4.m4.2.2.2.2.2" stretchy="false" xref="S2.p4.4.m4.2.2.2.3.cmml">[</mo><mrow id="S2.p4.4.m4.2.2.2.2.1" xref="S2.p4.4.m4.2.2.2.2.1.cmml"><mrow id="S2.p4.4.m4.2.2.2.2.1.2" xref="S2.p4.4.m4.2.2.2.2.1.2.cmml"><mi id="S2.p4.4.m4.2.2.2.2.1.2.2" xref="S2.p4.4.m4.2.2.2.2.1.2.2.cmml">t</mi><mo id="S2.p4.4.m4.2.2.2.2.1.2.1" xref="S2.p4.4.m4.2.2.2.2.1.2.1.cmml">−</mo><mi id="S2.p4.4.m4.2.2.2.2.1.2.3" xref="S2.p4.4.m4.2.2.2.2.1.2.3.cmml">d</mi></mrow><mo id="S2.p4.4.m4.2.2.2.2.1.1" xref="S2.p4.4.m4.2.2.2.2.1.1.cmml">+</mo><mn id="S2.p4.4.m4.2.2.2.2.1.3" xref="S2.p4.4.m4.2.2.2.2.1.3.cmml">1</mn></mrow><mo id="S2.p4.4.m4.2.2.2.2.3" xref="S2.p4.4.m4.2.2.2.3.cmml">,</mo><mi id="S2.p4.4.m4.1.1.1.1" xref="S2.p4.4.m4.1.1.1.1.cmml">t</mi><mo id="S2.p4.4.m4.2.2.2.2.4" stretchy="false" xref="S2.p4.4.m4.2.2.2.3.cmml">]</mo></mrow></msub><annotation-xml encoding="MathML-Content" id="S2.p4.4.m4.2b"><apply id="S2.p4.4.m4.2.3.cmml" xref="S2.p4.4.m4.2.3"><csymbol cd="ambiguous" id="S2.p4.4.m4.2.3.1.cmml" xref="S2.p4.4.m4.2.3">subscript</csymbol><ci id="S2.p4.4.m4.2.3.2.cmml" xref="S2.p4.4.m4.2.3.2">𝒟</ci><interval closure="closed" id="S2.p4.4.m4.2.2.2.3.cmml" xref="S2.p4.4.m4.2.2.2.2"><apply id="S2.p4.4.m4.2.2.2.2.1.cmml" xref="S2.p4.4.m4.2.2.2.2.1"><plus id="S2.p4.4.m4.2.2.2.2.1.1.cmml" xref="S2.p4.4.m4.2.2.2.2.1.1"></plus><apply id="S2.p4.4.m4.2.2.2.2.1.2.cmml" xref="S2.p4.4.m4.2.2.2.2.1.2"><minus id="S2.p4.4.m4.2.2.2.2.1.2.1.cmml" xref="S2.p4.4.m4.2.2.2.2.1.2.1"></minus><ci id="S2.p4.4.m4.2.2.2.2.1.2.2.cmml" xref="S2.p4.4.m4.2.2.2.2.1.2.2">𝑡</ci><ci id="S2.p4.4.m4.2.2.2.2.1.2.3.cmml" xref="S2.p4.4.m4.2.2.2.2.1.2.3">𝑑</ci></apply><cn id="S2.p4.4.m4.2.2.2.2.1.3.cmml" type="integer" xref="S2.p4.4.m4.2.2.2.2.1.3">1</cn></apply><ci id="S2.p4.4.m4.1.1.1.1.cmml" xref="S2.p4.4.m4.1.1.1.1">𝑡</ci></interval></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.p4.4.m4.2c">\mathcal{D}_{[t-d+1,t]}</annotation><annotation encoding="application/x-llamapun" id="S2.p4.4.m4.2d">caligraphic_D start_POSTSUBSCRIPT [ italic_t - italic_d + 1 , italic_t ] end_POSTSUBSCRIPT</annotation></semantics></math> and is used as the training set, denoted by <math alttext="\mathcal{D}_{\text{train}}" class="ltx_Math" display="inline" id="S2.p4.5.m5.1"><semantics id="S2.p4.5.m5.1a"><msub id="S2.p4.5.m5.1.1" xref="S2.p4.5.m5.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S2.p4.5.m5.1.1.2" xref="S2.p4.5.m5.1.1.2.cmml">𝒟</mi><mtext id="S2.p4.5.m5.1.1.3" xref="S2.p4.5.m5.1.1.3a.cmml">train</mtext></msub><annotation-xml encoding="MathML-Content" id="S2.p4.5.m5.1b"><apply id="S2.p4.5.m5.1.1.cmml" xref="S2.p4.5.m5.1.1"><csymbol cd="ambiguous" id="S2.p4.5.m5.1.1.1.cmml" xref="S2.p4.5.m5.1.1">subscript</csymbol><ci id="S2.p4.5.m5.1.1.2.cmml" xref="S2.p4.5.m5.1.1.2">𝒟</ci><ci id="S2.p4.5.m5.1.1.3a.cmml" xref="S2.p4.5.m5.1.1.3"><mtext id="S2.p4.5.m5.1.1.3.cmml" mathsize="70%" xref="S2.p4.5.m5.1.1.3">train</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.p4.5.m5.1c">\mathcal{D}_{\text{train}}</annotation><annotation encoding="application/x-llamapun" id="S2.p4.5.m5.1d">caligraphic_D start_POSTSUBSCRIPT train end_POSTSUBSCRIPT</annotation></semantics></math>.
The remaining portion, <math alttext="\mathcal{D}_{(-\infty,t-d]}" class="ltx_Math" display="inline" id="S2.p4.6.m6.2"><semantics id="S2.p4.6.m6.2a"><msub id="S2.p4.6.m6.2.3" xref="S2.p4.6.m6.2.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S2.p4.6.m6.2.3.2" xref="S2.p4.6.m6.2.3.2.cmml">𝒟</mi><mrow id="S2.p4.6.m6.2.2.2.2" xref="S2.p4.6.m6.2.2.2.3.cmml"><mo id="S2.p4.6.m6.2.2.2.2.3" stretchy="false" xref="S2.p4.6.m6.2.2.2.3.cmml">(</mo><mrow id="S2.p4.6.m6.1.1.1.1.1" xref="S2.p4.6.m6.1.1.1.1.1.cmml"><mo id="S2.p4.6.m6.1.1.1.1.1a" xref="S2.p4.6.m6.1.1.1.1.1.cmml">−</mo><mi id="S2.p4.6.m6.1.1.1.1.1.2" mathvariant="normal" xref="S2.p4.6.m6.1.1.1.1.1.2.cmml">∞</mi></mrow><mo id="S2.p4.6.m6.2.2.2.2.4" xref="S2.p4.6.m6.2.2.2.3.cmml">,</mo><mrow id="S2.p4.6.m6.2.2.2.2.2" xref="S2.p4.6.m6.2.2.2.2.2.cmml"><mi id="S2.p4.6.m6.2.2.2.2.2.2" xref="S2.p4.6.m6.2.2.2.2.2.2.cmml">t</mi><mo id="S2.p4.6.m6.2.2.2.2.2.1" xref="S2.p4.6.m6.2.2.2.2.2.1.cmml">−</mo><mi id="S2.p4.6.m6.2.2.2.2.2.3" xref="S2.p4.6.m6.2.2.2.2.2.3.cmml">d</mi></mrow><mo id="S2.p4.6.m6.2.2.2.2.5" stretchy="false" xref="S2.p4.6.m6.2.2.2.3.cmml">]</mo></mrow></msub><annotation-xml encoding="MathML-Content" id="S2.p4.6.m6.2b"><apply id="S2.p4.6.m6.2.3.cmml" xref="S2.p4.6.m6.2.3"><csymbol cd="ambiguous" id="S2.p4.6.m6.2.3.1.cmml" xref="S2.p4.6.m6.2.3">subscript</csymbol><ci id="S2.p4.6.m6.2.3.2.cmml" xref="S2.p4.6.m6.2.3.2">𝒟</ci><interval closure="open-closed" id="S2.p4.6.m6.2.2.2.3.cmml" xref="S2.p4.6.m6.2.2.2.2"><apply id="S2.p4.6.m6.1.1.1.1.1.cmml" xref="S2.p4.6.m6.1.1.1.1.1"><minus id="S2.p4.6.m6.1.1.1.1.1.1.cmml" xref="S2.p4.6.m6.1.1.1.1.1"></minus><infinity id="S2.p4.6.m6.1.1.1.1.1.2.cmml" xref="S2.p4.6.m6.1.1.1.1.1.2"></infinity></apply><apply id="S2.p4.6.m6.2.2.2.2.2.cmml" xref="S2.p4.6.m6.2.2.2.2.2"><minus id="S2.p4.6.m6.2.2.2.2.2.1.cmml" xref="S2.p4.6.m6.2.2.2.2.2.1"></minus><ci id="S2.p4.6.m6.2.2.2.2.2.2.cmml" xref="S2.p4.6.m6.2.2.2.2.2.2">𝑡</ci><ci id="S2.p4.6.m6.2.2.2.2.2.3.cmml" xref="S2.p4.6.m6.2.2.2.2.2.3">𝑑</ci></apply></interval></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.p4.6.m6.2c">\mathcal{D}_{(-\infty,t-d]}</annotation><annotation encoding="application/x-llamapun" id="S2.p4.6.m6.2d">caligraphic_D start_POSTSUBSCRIPT ( - ∞ , italic_t - italic_d ] end_POSTSUBSCRIPT</annotation></semantics></math>, is designated as the search space, <math alttext="\mathcal{D}_{\text{shifting}}" class="ltx_Math" display="inline" id="S2.p4.7.m7.1"><semantics id="S2.p4.7.m7.1a"><msub id="S2.p4.7.m7.1.1" xref="S2.p4.7.m7.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S2.p4.7.m7.1.1.2" xref="S2.p4.7.m7.1.1.2.cmml">𝒟</mi><mtext id="S2.p4.7.m7.1.1.3" xref="S2.p4.7.m7.1.1.3a.cmml">shifting</mtext></msub><annotation-xml encoding="MathML-Content" id="S2.p4.7.m7.1b"><apply id="S2.p4.7.m7.1.1.cmml" xref="S2.p4.7.m7.1.1"><csymbol cd="ambiguous" id="S2.p4.7.m7.1.1.1.cmml" xref="S2.p4.7.m7.1.1">subscript</csymbol><ci id="S2.p4.7.m7.1.1.2.cmml" xref="S2.p4.7.m7.1.1.2">𝒟</ci><ci id="S2.p4.7.m7.1.1.3a.cmml" xref="S2.p4.7.m7.1.1.3"><mtext id="S2.p4.7.m7.1.1.3.cmml" mathsize="70%" xref="S2.p4.7.m7.1.1.3">shifting</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.p4.7.m7.1c">\mathcal{D}_{\text{shifting}}</annotation><annotation encoding="application/x-llamapun" id="S2.p4.7.m7.1d">caligraphic_D start_POSTSUBSCRIPT shifting end_POSTSUBSCRIPT</annotation></semantics></math>.</p>
</div>
<div class="ltx_para" id="S2.p5">
<p class="ltx_p" id="S2.p5.1">The <span class="ltx_text ltx_font_bold" id="S2.p5.1.1">Retrieval and Distill (RAD)</span> framework comprises two components.
The first component, the Retrieval Framework, employs a retrieval-based method to assist any original model in addressing the data shift issue.
However, retrieval-based models face significant efficiency challenges.
Therefore, the second component, the Distill Framework, utilizes distillation to eliminate the retrieval process.
We will introduce these two components separately in the following.</p>
</div>
<div class="ltx_para ltx_noindent" id="S2.p6">
<p class="ltx_p" id="S2.p6.1"><span class="ltx_text ltx_font_bold" id="S2.p6.1.1">Retrieval Framework.</span>
The objective of the Retrieval Framework is to employ a relevance network, which incorporates non-parametric retrieval, to assist any original model <math alttext="F(x)" class="ltx_Math" display="inline" id="S2.p6.1.m1.1"><semantics id="S2.p6.1.m1.1a"><mrow id="S2.p6.1.m1.1.2" xref="S2.p6.1.m1.1.2.cmml"><mi id="S2.p6.1.m1.1.2.2" xref="S2.p6.1.m1.1.2.2.cmml">F</mi><mo id="S2.p6.1.m1.1.2.1" xref="S2.p6.1.m1.1.2.1.cmml">⁢</mo><mrow id="S2.p6.1.m1.1.2.3.2" xref="S2.p6.1.m1.1.2.cmml"><mo id="S2.p6.1.m1.1.2.3.2.1" stretchy="false" xref="S2.p6.1.m1.1.2.cmml">(</mo><mi id="S2.p6.1.m1.1.1" xref="S2.p6.1.m1.1.1.cmml">x</mi><mo id="S2.p6.1.m1.1.2.3.2.2" stretchy="false" xref="S2.p6.1.m1.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.p6.1.m1.1b"><apply id="S2.p6.1.m1.1.2.cmml" xref="S2.p6.1.m1.1.2"><times id="S2.p6.1.m1.1.2.1.cmml" xref="S2.p6.1.m1.1.2.1"></times><ci id="S2.p6.1.m1.1.2.2.cmml" xref="S2.p6.1.m1.1.2.2">𝐹</ci><ci id="S2.p6.1.m1.1.1.cmml" xref="S2.p6.1.m1.1.1">𝑥</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.p6.1.m1.1c">F(x)</annotation><annotation encoding="application/x-llamapun" id="S2.p6.1.m1.1d">italic_F ( italic_x )</annotation></semantics></math> in predicting the label. The formulation of the Retrieval Framework is as follows:</p>
<table class="ltx_equation ltx_eqn_table" id="S2.E1">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_left" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_left">(1)</span></td>
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\hat{y_{R}}=f_{\theta}(F(x),x,R(x))," class="ltx_Math" display="block" id="S2.E1.m1.4"><semantics id="S2.E1.m1.4a"><mrow id="S2.E1.m1.4.4.1" xref="S2.E1.m1.4.4.1.1.cmml"><mrow id="S2.E1.m1.4.4.1.1" xref="S2.E1.m1.4.4.1.1.cmml"><mover accent="true" id="S2.E1.m1.4.4.1.1.4" xref="S2.E1.m1.4.4.1.1.4.cmml"><msub id="S2.E1.m1.4.4.1.1.4.2" xref="S2.E1.m1.4.4.1.1.4.2.cmml"><mi id="S2.E1.m1.4.4.1.1.4.2.2" xref="S2.E1.m1.4.4.1.1.4.2.2.cmml">y</mi><mi id="S2.E1.m1.4.4.1.1.4.2.3" xref="S2.E1.m1.4.4.1.1.4.2.3.cmml">R</mi></msub><mo id="S2.E1.m1.4.4.1.1.4.1" xref="S2.E1.m1.4.4.1.1.4.1.cmml">^</mo></mover><mo id="S2.E1.m1.4.4.1.1.3" xref="S2.E1.m1.4.4.1.1.3.cmml">=</mo><mrow id="S2.E1.m1.4.4.1.1.2" xref="S2.E1.m1.4.4.1.1.2.cmml"><msub id="S2.E1.m1.4.4.1.1.2.4" xref="S2.E1.m1.4.4.1.1.2.4.cmml"><mi id="S2.E1.m1.4.4.1.1.2.4.2" xref="S2.E1.m1.4.4.1.1.2.4.2.cmml">f</mi><mi id="S2.E1.m1.4.4.1.1.2.4.3" xref="S2.E1.m1.4.4.1.1.2.4.3.cmml">θ</mi></msub><mo id="S2.E1.m1.4.4.1.1.2.3" xref="S2.E1.m1.4.4.1.1.2.3.cmml">⁢</mo><mrow id="S2.E1.m1.4.4.1.1.2.2.2" xref="S2.E1.m1.4.4.1.1.2.2.3.cmml"><mo id="S2.E1.m1.4.4.1.1.2.2.2.3" stretchy="false" xref="S2.E1.m1.4.4.1.1.2.2.3.cmml">(</mo><mrow id="S2.E1.m1.4.4.1.1.1.1.1.1" xref="S2.E1.m1.4.4.1.1.1.1.1.1.cmml"><mi id="S2.E1.m1.4.4.1.1.1.1.1.1.2" xref="S2.E1.m1.4.4.1.1.1.1.1.1.2.cmml">F</mi><mo id="S2.E1.m1.4.4.1.1.1.1.1.1.1" xref="S2.E1.m1.4.4.1.1.1.1.1.1.1.cmml">⁢</mo><mrow id="S2.E1.m1.4.4.1.1.1.1.1.1.3.2" xref="S2.E1.m1.4.4.1.1.1.1.1.1.cmml"><mo id="S2.E1.m1.4.4.1.1.1.1.1.1.3.2.1" stretchy="false" xref="S2.E1.m1.4.4.1.1.1.1.1.1.cmml">(</mo><mi id="S2.E1.m1.1.1" xref="S2.E1.m1.1.1.cmml">x</mi><mo id="S2.E1.m1.4.4.1.1.1.1.1.1.3.2.2" stretchy="false" xref="S2.E1.m1.4.4.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S2.E1.m1.4.4.1.1.2.2.2.4" xref="S2.E1.m1.4.4.1.1.2.2.3.cmml">,</mo><mi id="S2.E1.m1.3.3" xref="S2.E1.m1.3.3.cmml">x</mi><mo id="S2.E1.m1.4.4.1.1.2.2.2.5" xref="S2.E1.m1.4.4.1.1.2.2.3.cmml">,</mo><mrow id="S2.E1.m1.4.4.1.1.2.2.2.2" xref="S2.E1.m1.4.4.1.1.2.2.2.2.cmml"><mi id="S2.E1.m1.4.4.1.1.2.2.2.2.2" xref="S2.E1.m1.4.4.1.1.2.2.2.2.2.cmml">R</mi><mo id="S2.E1.m1.4.4.1.1.2.2.2.2.1" xref="S2.E1.m1.4.4.1.1.2.2.2.2.1.cmml">⁢</mo><mrow id="S2.E1.m1.4.4.1.1.2.2.2.2.3.2" xref="S2.E1.m1.4.4.1.1.2.2.2.2.cmml"><mo id="S2.E1.m1.4.4.1.1.2.2.2.2.3.2.1" stretchy="false" xref="S2.E1.m1.4.4.1.1.2.2.2.2.cmml">(</mo><mi id="S2.E1.m1.2.2" xref="S2.E1.m1.2.2.cmml">x</mi><mo id="S2.E1.m1.4.4.1.1.2.2.2.2.3.2.2" stretchy="false" xref="S2.E1.m1.4.4.1.1.2.2.2.2.cmml">)</mo></mrow></mrow><mo id="S2.E1.m1.4.4.1.1.2.2.2.6" stretchy="false" xref="S2.E1.m1.4.4.1.1.2.2.3.cmml">)</mo></mrow></mrow></mrow><mo id="S2.E1.m1.4.4.1.2" xref="S2.E1.m1.4.4.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S2.E1.m1.4b"><apply id="S2.E1.m1.4.4.1.1.cmml" xref="S2.E1.m1.4.4.1"><eq id="S2.E1.m1.4.4.1.1.3.cmml" xref="S2.E1.m1.4.4.1.1.3"></eq><apply id="S2.E1.m1.4.4.1.1.4.cmml" xref="S2.E1.m1.4.4.1.1.4"><ci id="S2.E1.m1.4.4.1.1.4.1.cmml" xref="S2.E1.m1.4.4.1.1.4.1">^</ci><apply id="S2.E1.m1.4.4.1.1.4.2.cmml" xref="S2.E1.m1.4.4.1.1.4.2"><csymbol cd="ambiguous" id="S2.E1.m1.4.4.1.1.4.2.1.cmml" xref="S2.E1.m1.4.4.1.1.4.2">subscript</csymbol><ci id="S2.E1.m1.4.4.1.1.4.2.2.cmml" xref="S2.E1.m1.4.4.1.1.4.2.2">𝑦</ci><ci id="S2.E1.m1.4.4.1.1.4.2.3.cmml" xref="S2.E1.m1.4.4.1.1.4.2.3">𝑅</ci></apply></apply><apply id="S2.E1.m1.4.4.1.1.2.cmml" xref="S2.E1.m1.4.4.1.1.2"><times id="S2.E1.m1.4.4.1.1.2.3.cmml" xref="S2.E1.m1.4.4.1.1.2.3"></times><apply id="S2.E1.m1.4.4.1.1.2.4.cmml" xref="S2.E1.m1.4.4.1.1.2.4"><csymbol cd="ambiguous" id="S2.E1.m1.4.4.1.1.2.4.1.cmml" xref="S2.E1.m1.4.4.1.1.2.4">subscript</csymbol><ci id="S2.E1.m1.4.4.1.1.2.4.2.cmml" xref="S2.E1.m1.4.4.1.1.2.4.2">𝑓</ci><ci id="S2.E1.m1.4.4.1.1.2.4.3.cmml" xref="S2.E1.m1.4.4.1.1.2.4.3">𝜃</ci></apply><vector id="S2.E1.m1.4.4.1.1.2.2.3.cmml" xref="S2.E1.m1.4.4.1.1.2.2.2"><apply id="S2.E1.m1.4.4.1.1.1.1.1.1.cmml" xref="S2.E1.m1.4.4.1.1.1.1.1.1"><times id="S2.E1.m1.4.4.1.1.1.1.1.1.1.cmml" xref="S2.E1.m1.4.4.1.1.1.1.1.1.1"></times><ci id="S2.E1.m1.4.4.1.1.1.1.1.1.2.cmml" xref="S2.E1.m1.4.4.1.1.1.1.1.1.2">𝐹</ci><ci id="S2.E1.m1.1.1.cmml" xref="S2.E1.m1.1.1">𝑥</ci></apply><ci id="S2.E1.m1.3.3.cmml" xref="S2.E1.m1.3.3">𝑥</ci><apply id="S2.E1.m1.4.4.1.1.2.2.2.2.cmml" xref="S2.E1.m1.4.4.1.1.2.2.2.2"><times id="S2.E1.m1.4.4.1.1.2.2.2.2.1.cmml" xref="S2.E1.m1.4.4.1.1.2.2.2.2.1"></times><ci id="S2.E1.m1.4.4.1.1.2.2.2.2.2.cmml" xref="S2.E1.m1.4.4.1.1.2.2.2.2.2">𝑅</ci><ci id="S2.E1.m1.2.2.cmml" xref="S2.E1.m1.2.2">𝑥</ci></apply></vector></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.E1.m1.4c">\hat{y_{R}}=f_{\theta}(F(x),x,R(x)),</annotation><annotation encoding="application/x-llamapun" id="S2.E1.m1.4d">over^ start_ARG italic_y start_POSTSUBSCRIPT italic_R end_POSTSUBSCRIPT end_ARG = italic_f start_POSTSUBSCRIPT italic_θ end_POSTSUBSCRIPT ( italic_F ( italic_x ) , italic_x , italic_R ( italic_x ) ) ,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S2.p6.5">where <math alttext="R(x)" class="ltx_Math" display="inline" id="S2.p6.2.m1.1"><semantics id="S2.p6.2.m1.1a"><mrow id="S2.p6.2.m1.1.2" xref="S2.p6.2.m1.1.2.cmml"><mi id="S2.p6.2.m1.1.2.2" xref="S2.p6.2.m1.1.2.2.cmml">R</mi><mo id="S2.p6.2.m1.1.2.1" xref="S2.p6.2.m1.1.2.1.cmml">⁢</mo><mrow id="S2.p6.2.m1.1.2.3.2" xref="S2.p6.2.m1.1.2.cmml"><mo id="S2.p6.2.m1.1.2.3.2.1" stretchy="false" xref="S2.p6.2.m1.1.2.cmml">(</mo><mi id="S2.p6.2.m1.1.1" xref="S2.p6.2.m1.1.1.cmml">x</mi><mo id="S2.p6.2.m1.1.2.3.2.2" stretchy="false" xref="S2.p6.2.m1.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.p6.2.m1.1b"><apply id="S2.p6.2.m1.1.2.cmml" xref="S2.p6.2.m1.1.2"><times id="S2.p6.2.m1.1.2.1.cmml" xref="S2.p6.2.m1.1.2.1"></times><ci id="S2.p6.2.m1.1.2.2.cmml" xref="S2.p6.2.m1.1.2.2">𝑅</ci><ci id="S2.p6.2.m1.1.1.cmml" xref="S2.p6.2.m1.1.1">𝑥</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.p6.2.m1.1c">R(x)</annotation><annotation encoding="application/x-llamapun" id="S2.p6.2.m1.1d">italic_R ( italic_x )</annotation></semantics></math> is designed to fit <math alttext="P(x_{s}|x)" class="ltx_Math" display="inline" id="S2.p6.3.m2.1"><semantics id="S2.p6.3.m2.1a"><mrow id="S2.p6.3.m2.1.1" xref="S2.p6.3.m2.1.1.cmml"><mi id="S2.p6.3.m2.1.1.3" xref="S2.p6.3.m2.1.1.3.cmml">P</mi><mo id="S2.p6.3.m2.1.1.2" xref="S2.p6.3.m2.1.1.2.cmml">⁢</mo><mrow id="S2.p6.3.m2.1.1.1.1" xref="S2.p6.3.m2.1.1.1.1.1.cmml"><mo id="S2.p6.3.m2.1.1.1.1.2" stretchy="false" xref="S2.p6.3.m2.1.1.1.1.1.cmml">(</mo><mrow id="S2.p6.3.m2.1.1.1.1.1" xref="S2.p6.3.m2.1.1.1.1.1.cmml"><msub id="S2.p6.3.m2.1.1.1.1.1.2" xref="S2.p6.3.m2.1.1.1.1.1.2.cmml"><mi id="S2.p6.3.m2.1.1.1.1.1.2.2" xref="S2.p6.3.m2.1.1.1.1.1.2.2.cmml">x</mi><mi id="S2.p6.3.m2.1.1.1.1.1.2.3" xref="S2.p6.3.m2.1.1.1.1.1.2.3.cmml">s</mi></msub><mo fence="false" id="S2.p6.3.m2.1.1.1.1.1.1" xref="S2.p6.3.m2.1.1.1.1.1.1.cmml">|</mo><mi id="S2.p6.3.m2.1.1.1.1.1.3" xref="S2.p6.3.m2.1.1.1.1.1.3.cmml">x</mi></mrow><mo id="S2.p6.3.m2.1.1.1.1.3" stretchy="false" xref="S2.p6.3.m2.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.p6.3.m2.1b"><apply id="S2.p6.3.m2.1.1.cmml" xref="S2.p6.3.m2.1.1"><times id="S2.p6.3.m2.1.1.2.cmml" xref="S2.p6.3.m2.1.1.2"></times><ci id="S2.p6.3.m2.1.1.3.cmml" xref="S2.p6.3.m2.1.1.3">𝑃</ci><apply id="S2.p6.3.m2.1.1.1.1.1.cmml" xref="S2.p6.3.m2.1.1.1.1"><csymbol cd="latexml" id="S2.p6.3.m2.1.1.1.1.1.1.cmml" xref="S2.p6.3.m2.1.1.1.1.1.1">conditional</csymbol><apply id="S2.p6.3.m2.1.1.1.1.1.2.cmml" xref="S2.p6.3.m2.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S2.p6.3.m2.1.1.1.1.1.2.1.cmml" xref="S2.p6.3.m2.1.1.1.1.1.2">subscript</csymbol><ci id="S2.p6.3.m2.1.1.1.1.1.2.2.cmml" xref="S2.p6.3.m2.1.1.1.1.1.2.2">𝑥</ci><ci id="S2.p6.3.m2.1.1.1.1.1.2.3.cmml" xref="S2.p6.3.m2.1.1.1.1.1.2.3">𝑠</ci></apply><ci id="S2.p6.3.m2.1.1.1.1.1.3.cmml" xref="S2.p6.3.m2.1.1.1.1.1.3">𝑥</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.p6.3.m2.1c">P(x_{s}|x)</annotation><annotation encoding="application/x-llamapun" id="S2.p6.3.m2.1d">italic_P ( italic_x start_POSTSUBSCRIPT italic_s end_POSTSUBSCRIPT | italic_x )</annotation></semantics></math> and is referred to as the <span class="ltx_text ltx_font_italic" id="S2.p6.5.1">relevance network</span> and <math alttext="f_{\theta}" class="ltx_Math" display="inline" id="S2.p6.4.m3.1"><semantics id="S2.p6.4.m3.1a"><msub id="S2.p6.4.m3.1.1" xref="S2.p6.4.m3.1.1.cmml"><mi id="S2.p6.4.m3.1.1.2" xref="S2.p6.4.m3.1.1.2.cmml">f</mi><mi id="S2.p6.4.m3.1.1.3" xref="S2.p6.4.m3.1.1.3.cmml">θ</mi></msub><annotation-xml encoding="MathML-Content" id="S2.p6.4.m3.1b"><apply id="S2.p6.4.m3.1.1.cmml" xref="S2.p6.4.m3.1.1"><csymbol cd="ambiguous" id="S2.p6.4.m3.1.1.1.cmml" xref="S2.p6.4.m3.1.1">subscript</csymbol><ci id="S2.p6.4.m3.1.1.2.cmml" xref="S2.p6.4.m3.1.1.2">𝑓</ci><ci id="S2.p6.4.m3.1.1.3.cmml" xref="S2.p6.4.m3.1.1.3">𝜃</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.p6.4.m3.1c">f_{\theta}</annotation><annotation encoding="application/x-llamapun" id="S2.p6.4.m3.1d">italic_f start_POSTSUBSCRIPT italic_θ end_POSTSUBSCRIPT</annotation></semantics></math> which approximate the <math alttext="P(y|x,x_{s})" class="ltx_Math" display="inline" id="S2.p6.5.m4.2"><semantics id="S2.p6.5.m4.2a"><mrow id="S2.p6.5.m4.2.2" xref="S2.p6.5.m4.2.2.cmml"><mi id="S2.p6.5.m4.2.2.3" xref="S2.p6.5.m4.2.2.3.cmml">P</mi><mo id="S2.p6.5.m4.2.2.2" xref="S2.p6.5.m4.2.2.2.cmml">⁢</mo><mrow id="S2.p6.5.m4.2.2.1.1" xref="S2.p6.5.m4.2.2.1.1.1.cmml"><mo id="S2.p6.5.m4.2.2.1.1.2" stretchy="false" xref="S2.p6.5.m4.2.2.1.1.1.cmml">(</mo><mrow id="S2.p6.5.m4.2.2.1.1.1" xref="S2.p6.5.m4.2.2.1.1.1.cmml"><mi id="S2.p6.5.m4.2.2.1.1.1.3" xref="S2.p6.5.m4.2.2.1.1.1.3.cmml">y</mi><mo fence="false" id="S2.p6.5.m4.2.2.1.1.1.2" xref="S2.p6.5.m4.2.2.1.1.1.2.cmml">|</mo><mrow id="S2.p6.5.m4.2.2.1.1.1.1.1" xref="S2.p6.5.m4.2.2.1.1.1.1.2.cmml"><mi id="S2.p6.5.m4.1.1" xref="S2.p6.5.m4.1.1.cmml">x</mi><mo id="S2.p6.5.m4.2.2.1.1.1.1.1.2" xref="S2.p6.5.m4.2.2.1.1.1.1.2.cmml">,</mo><msub id="S2.p6.5.m4.2.2.1.1.1.1.1.1" xref="S2.p6.5.m4.2.2.1.1.1.1.1.1.cmml"><mi id="S2.p6.5.m4.2.2.1.1.1.1.1.1.2" xref="S2.p6.5.m4.2.2.1.1.1.1.1.1.2.cmml">x</mi><mi id="S2.p6.5.m4.2.2.1.1.1.1.1.1.3" xref="S2.p6.5.m4.2.2.1.1.1.1.1.1.3.cmml">s</mi></msub></mrow></mrow><mo id="S2.p6.5.m4.2.2.1.1.3" stretchy="false" xref="S2.p6.5.m4.2.2.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.p6.5.m4.2b"><apply id="S2.p6.5.m4.2.2.cmml" xref="S2.p6.5.m4.2.2"><times id="S2.p6.5.m4.2.2.2.cmml" xref="S2.p6.5.m4.2.2.2"></times><ci id="S2.p6.5.m4.2.2.3.cmml" xref="S2.p6.5.m4.2.2.3">𝑃</ci><apply id="S2.p6.5.m4.2.2.1.1.1.cmml" xref="S2.p6.5.m4.2.2.1.1"><csymbol cd="latexml" id="S2.p6.5.m4.2.2.1.1.1.2.cmml" xref="S2.p6.5.m4.2.2.1.1.1.2">conditional</csymbol><ci id="S2.p6.5.m4.2.2.1.1.1.3.cmml" xref="S2.p6.5.m4.2.2.1.1.1.3">𝑦</ci><list id="S2.p6.5.m4.2.2.1.1.1.1.2.cmml" xref="S2.p6.5.m4.2.2.1.1.1.1.1"><ci id="S2.p6.5.m4.1.1.cmml" xref="S2.p6.5.m4.1.1">𝑥</ci><apply id="S2.p6.5.m4.2.2.1.1.1.1.1.1.cmml" xref="S2.p6.5.m4.2.2.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S2.p6.5.m4.2.2.1.1.1.1.1.1.1.cmml" xref="S2.p6.5.m4.2.2.1.1.1.1.1.1">subscript</csymbol><ci id="S2.p6.5.m4.2.2.1.1.1.1.1.1.2.cmml" xref="S2.p6.5.m4.2.2.1.1.1.1.1.1.2">𝑥</ci><ci id="S2.p6.5.m4.2.2.1.1.1.1.1.1.3.cmml" xref="S2.p6.5.m4.2.2.1.1.1.1.1.1.3">𝑠</ci></apply></list></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.p6.5.m4.2c">P(y|x,x_{s})</annotation><annotation encoding="application/x-llamapun" id="S2.p6.5.m4.2d">italic_P ( italic_y | italic_x , italic_x start_POSTSUBSCRIPT italic_s end_POSTSUBSCRIPT )</annotation></semantics></math> is data shift sensitive.</p>
</div>
<div class="ltx_para" id="S2.p7">
<p class="ltx_p" id="S2.p7.3">To obtain a model, <math alttext="R(x)" class="ltx_Math" display="inline" id="S2.p7.1.m1.1"><semantics id="S2.p7.1.m1.1a"><mrow id="S2.p7.1.m1.1.2" xref="S2.p7.1.m1.1.2.cmml"><mi id="S2.p7.1.m1.1.2.2" xref="S2.p7.1.m1.1.2.2.cmml">R</mi><mo id="S2.p7.1.m1.1.2.1" xref="S2.p7.1.m1.1.2.1.cmml">⁢</mo><mrow id="S2.p7.1.m1.1.2.3.2" xref="S2.p7.1.m1.1.2.cmml"><mo id="S2.p7.1.m1.1.2.3.2.1" stretchy="false" xref="S2.p7.1.m1.1.2.cmml">(</mo><mi id="S2.p7.1.m1.1.1" xref="S2.p7.1.m1.1.1.cmml">x</mi><mo id="S2.p7.1.m1.1.2.3.2.2" stretchy="false" xref="S2.p7.1.m1.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.p7.1.m1.1b"><apply id="S2.p7.1.m1.1.2.cmml" xref="S2.p7.1.m1.1.2"><times id="S2.p7.1.m1.1.2.1.cmml" xref="S2.p7.1.m1.1.2.1"></times><ci id="S2.p7.1.m1.1.2.2.cmml" xref="S2.p7.1.m1.1.2.2">𝑅</ci><ci id="S2.p7.1.m1.1.1.cmml" xref="S2.p7.1.m1.1.1">𝑥</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.p7.1.m1.1c">R(x)</annotation><annotation encoding="application/x-llamapun" id="S2.p7.1.m1.1d">italic_R ( italic_x )</annotation></semantics></math>, that approximates the probability distribution <math alttext="P(x|x_{s})" class="ltx_Math" display="inline" id="S2.p7.2.m2.1"><semantics id="S2.p7.2.m2.1a"><mrow id="S2.p7.2.m2.1.1" xref="S2.p7.2.m2.1.1.cmml"><mi id="S2.p7.2.m2.1.1.3" xref="S2.p7.2.m2.1.1.3.cmml">P</mi><mo id="S2.p7.2.m2.1.1.2" xref="S2.p7.2.m2.1.1.2.cmml">⁢</mo><mrow id="S2.p7.2.m2.1.1.1.1" xref="S2.p7.2.m2.1.1.1.1.1.cmml"><mo id="S2.p7.2.m2.1.1.1.1.2" stretchy="false" xref="S2.p7.2.m2.1.1.1.1.1.cmml">(</mo><mrow id="S2.p7.2.m2.1.1.1.1.1" xref="S2.p7.2.m2.1.1.1.1.1.cmml"><mi id="S2.p7.2.m2.1.1.1.1.1.2" xref="S2.p7.2.m2.1.1.1.1.1.2.cmml">x</mi><mo fence="false" id="S2.p7.2.m2.1.1.1.1.1.1" xref="S2.p7.2.m2.1.1.1.1.1.1.cmml">|</mo><msub id="S2.p7.2.m2.1.1.1.1.1.3" xref="S2.p7.2.m2.1.1.1.1.1.3.cmml"><mi id="S2.p7.2.m2.1.1.1.1.1.3.2" xref="S2.p7.2.m2.1.1.1.1.1.3.2.cmml">x</mi><mi id="S2.p7.2.m2.1.1.1.1.1.3.3" xref="S2.p7.2.m2.1.1.1.1.1.3.3.cmml">s</mi></msub></mrow><mo id="S2.p7.2.m2.1.1.1.1.3" stretchy="false" xref="S2.p7.2.m2.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.p7.2.m2.1b"><apply id="S2.p7.2.m2.1.1.cmml" xref="S2.p7.2.m2.1.1"><times id="S2.p7.2.m2.1.1.2.cmml" xref="S2.p7.2.m2.1.1.2"></times><ci id="S2.p7.2.m2.1.1.3.cmml" xref="S2.p7.2.m2.1.1.3">𝑃</ci><apply id="S2.p7.2.m2.1.1.1.1.1.cmml" xref="S2.p7.2.m2.1.1.1.1"><csymbol cd="latexml" id="S2.p7.2.m2.1.1.1.1.1.1.cmml" xref="S2.p7.2.m2.1.1.1.1.1.1">conditional</csymbol><ci id="S2.p7.2.m2.1.1.1.1.1.2.cmml" xref="S2.p7.2.m2.1.1.1.1.1.2">𝑥</ci><apply id="S2.p7.2.m2.1.1.1.1.1.3.cmml" xref="S2.p7.2.m2.1.1.1.1.1.3"><csymbol cd="ambiguous" id="S2.p7.2.m2.1.1.1.1.1.3.1.cmml" xref="S2.p7.2.m2.1.1.1.1.1.3">subscript</csymbol><ci id="S2.p7.2.m2.1.1.1.1.1.3.2.cmml" xref="S2.p7.2.m2.1.1.1.1.1.3.2">𝑥</ci><ci id="S2.p7.2.m2.1.1.1.1.1.3.3.cmml" xref="S2.p7.2.m2.1.1.1.1.1.3.3">𝑠</ci></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.p7.2.m2.1c">P(x|x_{s})</annotation><annotation encoding="application/x-llamapun" id="S2.p7.2.m2.1d">italic_P ( italic_x | italic_x start_POSTSUBSCRIPT italic_s end_POSTSUBSCRIPT )</annotation></semantics></math>, we employ a Retrieval Framework, devoid of <math alttext="F(x)" class="ltx_Math" display="inline" id="S2.p7.3.m3.1"><semantics id="S2.p7.3.m3.1a"><mrow id="S2.p7.3.m3.1.2" xref="S2.p7.3.m3.1.2.cmml"><mi id="S2.p7.3.m3.1.2.2" xref="S2.p7.3.m3.1.2.2.cmml">F</mi><mo id="S2.p7.3.m3.1.2.1" xref="S2.p7.3.m3.1.2.1.cmml">⁢</mo><mrow id="S2.p7.3.m3.1.2.3.2" xref="S2.p7.3.m3.1.2.cmml"><mo id="S2.p7.3.m3.1.2.3.2.1" stretchy="false" xref="S2.p7.3.m3.1.2.cmml">(</mo><mi id="S2.p7.3.m3.1.1" xref="S2.p7.3.m3.1.1.cmml">x</mi><mo id="S2.p7.3.m3.1.2.3.2.2" stretchy="false" xref="S2.p7.3.m3.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.p7.3.m3.1b"><apply id="S2.p7.3.m3.1.2.cmml" xref="S2.p7.3.m3.1.2"><times id="S2.p7.3.m3.1.2.1.cmml" xref="S2.p7.3.m3.1.2.1"></times><ci id="S2.p7.3.m3.1.2.2.cmml" xref="S2.p7.3.m3.1.2.2">𝐹</ci><ci id="S2.p7.3.m3.1.1.cmml" xref="S2.p7.3.m3.1.1">𝑥</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.p7.3.m3.1c">F(x)</annotation><annotation encoding="application/x-llamapun" id="S2.p7.3.m3.1d">italic_F ( italic_x )</annotation></semantics></math>, named the teacher network. The formulation of the teacher network is as follows:</p>
<table class="ltx_equation ltx_eqn_table" id="S2.E2">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_left" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_left">(2)</span></td>
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\hat{y_{T}}=T_{\gamma}(x,R(x))." class="ltx_Math" display="block" id="S2.E2.m1.3"><semantics id="S2.E2.m1.3a"><mrow id="S2.E2.m1.3.3.1" xref="S2.E2.m1.3.3.1.1.cmml"><mrow id="S2.E2.m1.3.3.1.1" xref="S2.E2.m1.3.3.1.1.cmml"><mover accent="true" id="S2.E2.m1.3.3.1.1.3" xref="S2.E2.m1.3.3.1.1.3.cmml"><msub id="S2.E2.m1.3.3.1.1.3.2" xref="S2.E2.m1.3.3.1.1.3.2.cmml"><mi id="S2.E2.m1.3.3.1.1.3.2.2" xref="S2.E2.m1.3.3.1.1.3.2.2.cmml">y</mi><mi id="S2.E2.m1.3.3.1.1.3.2.3" xref="S2.E2.m1.3.3.1.1.3.2.3.cmml">T</mi></msub><mo id="S2.E2.m1.3.3.1.1.3.1" xref="S2.E2.m1.3.3.1.1.3.1.cmml">^</mo></mover><mo id="S2.E2.m1.3.3.1.1.2" xref="S2.E2.m1.3.3.1.1.2.cmml">=</mo><mrow id="S2.E2.m1.3.3.1.1.1" xref="S2.E2.m1.3.3.1.1.1.cmml"><msub id="S2.E2.m1.3.3.1.1.1.3" xref="S2.E2.m1.3.3.1.1.1.3.cmml"><mi id="S2.E2.m1.3.3.1.1.1.3.2" xref="S2.E2.m1.3.3.1.1.1.3.2.cmml">T</mi><mi id="S2.E2.m1.3.3.1.1.1.3.3" xref="S2.E2.m1.3.3.1.1.1.3.3.cmml">γ</mi></msub><mo id="S2.E2.m1.3.3.1.1.1.2" xref="S2.E2.m1.3.3.1.1.1.2.cmml">⁢</mo><mrow id="S2.E2.m1.3.3.1.1.1.1.1" xref="S2.E2.m1.3.3.1.1.1.1.2.cmml"><mo id="S2.E2.m1.3.3.1.1.1.1.1.2" stretchy="false" xref="S2.E2.m1.3.3.1.1.1.1.2.cmml">(</mo><mi id="S2.E2.m1.2.2" xref="S2.E2.m1.2.2.cmml">x</mi><mo id="S2.E2.m1.3.3.1.1.1.1.1.3" xref="S2.E2.m1.3.3.1.1.1.1.2.cmml">,</mo><mrow id="S2.E2.m1.3.3.1.1.1.1.1.1" xref="S2.E2.m1.3.3.1.1.1.1.1.1.cmml"><mi id="S2.E2.m1.3.3.1.1.1.1.1.1.2" xref="S2.E2.m1.3.3.1.1.1.1.1.1.2.cmml">R</mi><mo id="S2.E2.m1.3.3.1.1.1.1.1.1.1" xref="S2.E2.m1.3.3.1.1.1.1.1.1.1.cmml">⁢</mo><mrow id="S2.E2.m1.3.3.1.1.1.1.1.1.3.2" xref="S2.E2.m1.3.3.1.1.1.1.1.1.cmml"><mo id="S2.E2.m1.3.3.1.1.1.1.1.1.3.2.1" stretchy="false" xref="S2.E2.m1.3.3.1.1.1.1.1.1.cmml">(</mo><mi id="S2.E2.m1.1.1" xref="S2.E2.m1.1.1.cmml">x</mi><mo id="S2.E2.m1.3.3.1.1.1.1.1.1.3.2.2" stretchy="false" xref="S2.E2.m1.3.3.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S2.E2.m1.3.3.1.1.1.1.1.4" stretchy="false" xref="S2.E2.m1.3.3.1.1.1.1.2.cmml">)</mo></mrow></mrow></mrow><mo id="S2.E2.m1.3.3.1.2" lspace="0em" xref="S2.E2.m1.3.3.1.1.cmml">.</mo></mrow><annotation-xml encoding="MathML-Content" id="S2.E2.m1.3b"><apply id="S2.E2.m1.3.3.1.1.cmml" xref="S2.E2.m1.3.3.1"><eq id="S2.E2.m1.3.3.1.1.2.cmml" xref="S2.E2.m1.3.3.1.1.2"></eq><apply id="S2.E2.m1.3.3.1.1.3.cmml" xref="S2.E2.m1.3.3.1.1.3"><ci id="S2.E2.m1.3.3.1.1.3.1.cmml" xref="S2.E2.m1.3.3.1.1.3.1">^</ci><apply id="S2.E2.m1.3.3.1.1.3.2.cmml" xref="S2.E2.m1.3.3.1.1.3.2"><csymbol cd="ambiguous" id="S2.E2.m1.3.3.1.1.3.2.1.cmml" xref="S2.E2.m1.3.3.1.1.3.2">subscript</csymbol><ci id="S2.E2.m1.3.3.1.1.3.2.2.cmml" xref="S2.E2.m1.3.3.1.1.3.2.2">𝑦</ci><ci id="S2.E2.m1.3.3.1.1.3.2.3.cmml" xref="S2.E2.m1.3.3.1.1.3.2.3">𝑇</ci></apply></apply><apply id="S2.E2.m1.3.3.1.1.1.cmml" xref="S2.E2.m1.3.3.1.1.1"><times id="S2.E2.m1.3.3.1.1.1.2.cmml" xref="S2.E2.m1.3.3.1.1.1.2"></times><apply id="S2.E2.m1.3.3.1.1.1.3.cmml" xref="S2.E2.m1.3.3.1.1.1.3"><csymbol cd="ambiguous" id="S2.E2.m1.3.3.1.1.1.3.1.cmml" xref="S2.E2.m1.3.3.1.1.1.3">subscript</csymbol><ci id="S2.E2.m1.3.3.1.1.1.3.2.cmml" xref="S2.E2.m1.3.3.1.1.1.3.2">𝑇</ci><ci id="S2.E2.m1.3.3.1.1.1.3.3.cmml" xref="S2.E2.m1.3.3.1.1.1.3.3">𝛾</ci></apply><interval closure="open" id="S2.E2.m1.3.3.1.1.1.1.2.cmml" xref="S2.E2.m1.3.3.1.1.1.1.1"><ci id="S2.E2.m1.2.2.cmml" xref="S2.E2.m1.2.2">𝑥</ci><apply id="S2.E2.m1.3.3.1.1.1.1.1.1.cmml" xref="S2.E2.m1.3.3.1.1.1.1.1.1"><times id="S2.E2.m1.3.3.1.1.1.1.1.1.1.cmml" xref="S2.E2.m1.3.3.1.1.1.1.1.1.1"></times><ci id="S2.E2.m1.3.3.1.1.1.1.1.1.2.cmml" xref="S2.E2.m1.3.3.1.1.1.1.1.1.2">𝑅</ci><ci id="S2.E2.m1.1.1.cmml" xref="S2.E2.m1.1.1">𝑥</ci></apply></interval></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.E2.m1.3c">\hat{y_{T}}=T_{\gamma}(x,R(x)).</annotation><annotation encoding="application/x-llamapun" id="S2.E2.m1.3d">over^ start_ARG italic_y start_POSTSUBSCRIPT italic_T end_POSTSUBSCRIPT end_ARG = italic_T start_POSTSUBSCRIPT italic_γ end_POSTSUBSCRIPT ( italic_x , italic_R ( italic_x ) ) .</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
</div>
<div class="ltx_para" id="S2.p8">
<p class="ltx_p" id="S2.p8.4">According to Theorem <a class="ltx_ref" href="https://arxiv.org/html/2404.15678v4#S2.Thmtheorem1" title="Theorem 2.1. ‣ 2. PRELIMINARIES ‣ Retrieval and Distill: A Temporal Data Shift-Free Paradigm for Online Recommendation System"><span class="ltx_text ltx_ref_tag">2.1</span></a>, The <math alttext="R(x)" class="ltx_Math" display="inline" id="S2.p8.1.m1.1"><semantics id="S2.p8.1.m1.1a"><mrow id="S2.p8.1.m1.1.2" xref="S2.p8.1.m1.1.2.cmml"><mi id="S2.p8.1.m1.1.2.2" xref="S2.p8.1.m1.1.2.2.cmml">R</mi><mo id="S2.p8.1.m1.1.2.1" xref="S2.p8.1.m1.1.2.1.cmml">⁢</mo><mrow id="S2.p8.1.m1.1.2.3.2" xref="S2.p8.1.m1.1.2.cmml"><mo id="S2.p8.1.m1.1.2.3.2.1" stretchy="false" xref="S2.p8.1.m1.1.2.cmml">(</mo><mi id="S2.p8.1.m1.1.1" xref="S2.p8.1.m1.1.1.cmml">x</mi><mo id="S2.p8.1.m1.1.2.3.2.2" stretchy="false" xref="S2.p8.1.m1.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.p8.1.m1.1b"><apply id="S2.p8.1.m1.1.2.cmml" xref="S2.p8.1.m1.1.2"><times id="S2.p8.1.m1.1.2.1.cmml" xref="S2.p8.1.m1.1.2.1"></times><ci id="S2.p8.1.m1.1.2.2.cmml" xref="S2.p8.1.m1.1.2.2">𝑅</ci><ci id="S2.p8.1.m1.1.1.cmml" xref="S2.p8.1.m1.1.1">𝑥</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.p8.1.m1.1c">R(x)</annotation><annotation encoding="application/x-llamapun" id="S2.p8.1.m1.1d">italic_R ( italic_x )</annotation></semantics></math> component within <math alttext="T_{\gamma}" class="ltx_Math" display="inline" id="S2.p8.2.m2.1"><semantics id="S2.p8.2.m2.1a"><msub id="S2.p8.2.m2.1.1" xref="S2.p8.2.m2.1.1.cmml"><mi id="S2.p8.2.m2.1.1.2" xref="S2.p8.2.m2.1.1.2.cmml">T</mi><mi id="S2.p8.2.m2.1.1.3" xref="S2.p8.2.m2.1.1.3.cmml">γ</mi></msub><annotation-xml encoding="MathML-Content" id="S2.p8.2.m2.1b"><apply id="S2.p8.2.m2.1.1.cmml" xref="S2.p8.2.m2.1.1"><csymbol cd="ambiguous" id="S2.p8.2.m2.1.1.1.cmml" xref="S2.p8.2.m2.1.1">subscript</csymbol><ci id="S2.p8.2.m2.1.1.2.cmml" xref="S2.p8.2.m2.1.1.2">𝑇</ci><ci id="S2.p8.2.m2.1.1.3.cmml" xref="S2.p8.2.m2.1.1.3">𝛾</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.p8.2.m2.1c">T_{\gamma}</annotation><annotation encoding="application/x-llamapun" id="S2.p8.2.m2.1d">italic_T start_POSTSUBSCRIPT italic_γ end_POSTSUBSCRIPT</annotation></semantics></math>, trained using shifting data, is invariant to data shift.
Therefore, to obtain an <math alttext="R(x)" class="ltx_Math" display="inline" id="S2.p8.3.m3.1"><semantics id="S2.p8.3.m3.1a"><mrow id="S2.p8.3.m3.1.2" xref="S2.p8.3.m3.1.2.cmml"><mi id="S2.p8.3.m3.1.2.2" xref="S2.p8.3.m3.1.2.2.cmml">R</mi><mo id="S2.p8.3.m3.1.2.1" xref="S2.p8.3.m3.1.2.1.cmml">⁢</mo><mrow id="S2.p8.3.m3.1.2.3.2" xref="S2.p8.3.m3.1.2.cmml"><mo id="S2.p8.3.m3.1.2.3.2.1" stretchy="false" xref="S2.p8.3.m3.1.2.cmml">(</mo><mi id="S2.p8.3.m3.1.1" xref="S2.p8.3.m3.1.1.cmml">x</mi><mo id="S2.p8.3.m3.1.2.3.2.2" stretchy="false" xref="S2.p8.3.m3.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.p8.3.m3.1b"><apply id="S2.p8.3.m3.1.2.cmml" xref="S2.p8.3.m3.1.2"><times id="S2.p8.3.m3.1.2.1.cmml" xref="S2.p8.3.m3.1.2.1"></times><ci id="S2.p8.3.m3.1.2.2.cmml" xref="S2.p8.3.m3.1.2.2">𝑅</ci><ci id="S2.p8.3.m3.1.1.cmml" xref="S2.p8.3.m3.1.1">𝑥</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.p8.3.m3.1c">R(x)</annotation><annotation encoding="application/x-llamapun" id="S2.p8.3.m3.1d">italic_R ( italic_x )</annotation></semantics></math> that has been trained with shifting data, <math alttext="T_{\gamma}" class="ltx_Math" display="inline" id="S2.p8.4.m4.1"><semantics id="S2.p8.4.m4.1a"><msub id="S2.p8.4.m4.1.1" xref="S2.p8.4.m4.1.1.cmml"><mi id="S2.p8.4.m4.1.1.2" xref="S2.p8.4.m4.1.1.2.cmml">T</mi><mi id="S2.p8.4.m4.1.1.3" xref="S2.p8.4.m4.1.1.3.cmml">γ</mi></msub><annotation-xml encoding="MathML-Content" id="S2.p8.4.m4.1b"><apply id="S2.p8.4.m4.1.1.cmml" xref="S2.p8.4.m4.1.1"><csymbol cd="ambiguous" id="S2.p8.4.m4.1.1.1.cmml" xref="S2.p8.4.m4.1.1">subscript</csymbol><ci id="S2.p8.4.m4.1.1.2.cmml" xref="S2.p8.4.m4.1.1.2">𝑇</ci><ci id="S2.p8.4.m4.1.1.3.cmml" xref="S2.p8.4.m4.1.1.3">𝛾</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.p8.4.m4.1c">T_{\gamma}</annotation><annotation encoding="application/x-llamapun" id="S2.p8.4.m4.1d">italic_T start_POSTSUBSCRIPT italic_γ end_POSTSUBSCRIPT</annotation></semantics></math> can be minimized by the following loss function:</p>
<table class="ltx_equation ltx_eqn_table" id="S2.E3">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_left" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_left">(3)</span></td>
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\mathcal{L}_{\text{pretrain}}=\sum_{x_{z}\in\mathcal{D}_{\text{shifting}}}%
\text{CE}(y^{z},\hat{y}_{T}^{z})," class="ltx_Math" display="block" id="S2.E3.m1.1"><semantics id="S2.E3.m1.1a"><mrow id="S2.E3.m1.1.1.1" xref="S2.E3.m1.1.1.1.1.cmml"><mrow id="S2.E3.m1.1.1.1.1" xref="S2.E3.m1.1.1.1.1.cmml"><msub id="S2.E3.m1.1.1.1.1.4" xref="S2.E3.m1.1.1.1.1.4.cmml"><mi class="ltx_font_mathcaligraphic" id="S2.E3.m1.1.1.1.1.4.2" xref="S2.E3.m1.1.1.1.1.4.2.cmml">ℒ</mi><mtext id="S2.E3.m1.1.1.1.1.4.3" xref="S2.E3.m1.1.1.1.1.4.3a.cmml">pretrain</mtext></msub><mo id="S2.E3.m1.1.1.1.1.3" rspace="0.111em" xref="S2.E3.m1.1.1.1.1.3.cmml">=</mo><mrow id="S2.E3.m1.1.1.1.1.2" xref="S2.E3.m1.1.1.1.1.2.cmml"><munder id="S2.E3.m1.1.1.1.1.2.3" xref="S2.E3.m1.1.1.1.1.2.3.cmml"><mo id="S2.E3.m1.1.1.1.1.2.3.2" movablelimits="false" xref="S2.E3.m1.1.1.1.1.2.3.2.cmml">∑</mo><mrow id="S2.E3.m1.1.1.1.1.2.3.3" xref="S2.E3.m1.1.1.1.1.2.3.3.cmml"><msub id="S2.E3.m1.1.1.1.1.2.3.3.2" xref="S2.E3.m1.1.1.1.1.2.3.3.2.cmml"><mi id="S2.E3.m1.1.1.1.1.2.3.3.2.2" xref="S2.E3.m1.1.1.1.1.2.3.3.2.2.cmml">x</mi><mi id="S2.E3.m1.1.1.1.1.2.3.3.2.3" xref="S2.E3.m1.1.1.1.1.2.3.3.2.3.cmml">z</mi></msub><mo id="S2.E3.m1.1.1.1.1.2.3.3.1" xref="S2.E3.m1.1.1.1.1.2.3.3.1.cmml">∈</mo><msub id="S2.E3.m1.1.1.1.1.2.3.3.3" xref="S2.E3.m1.1.1.1.1.2.3.3.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S2.E3.m1.1.1.1.1.2.3.3.3.2" xref="S2.E3.m1.1.1.1.1.2.3.3.3.2.cmml">𝒟</mi><mtext id="S2.E3.m1.1.1.1.1.2.3.3.3.3" xref="S2.E3.m1.1.1.1.1.2.3.3.3.3a.cmml">shifting</mtext></msub></mrow></munder><mrow id="S2.E3.m1.1.1.1.1.2.2" xref="S2.E3.m1.1.1.1.1.2.2.cmml"><mtext id="S2.E3.m1.1.1.1.1.2.2.4" xref="S2.E3.m1.1.1.1.1.2.2.4a.cmml">CE</mtext><mo id="S2.E3.m1.1.1.1.1.2.2.3" xref="S2.E3.m1.1.1.1.1.2.2.3.cmml">⁢</mo><mrow id="S2.E3.m1.1.1.1.1.2.2.2.2" xref="S2.E3.m1.1.1.1.1.2.2.2.3.cmml"><mo id="S2.E3.m1.1.1.1.1.2.2.2.2.3" stretchy="false" xref="S2.E3.m1.1.1.1.1.2.2.2.3.cmml">(</mo><msup id="S2.E3.m1.1.1.1.1.1.1.1.1.1" xref="S2.E3.m1.1.1.1.1.1.1.1.1.1.cmml"><mi id="S2.E3.m1.1.1.1.1.1.1.1.1.1.2" xref="S2.E3.m1.1.1.1.1.1.1.1.1.1.2.cmml">y</mi><mi id="S2.E3.m1.1.1.1.1.1.1.1.1.1.3" xref="S2.E3.m1.1.1.1.1.1.1.1.1.1.3.cmml">z</mi></msup><mo id="S2.E3.m1.1.1.1.1.2.2.2.2.4" xref="S2.E3.m1.1.1.1.1.2.2.2.3.cmml">,</mo><msubsup id="S2.E3.m1.1.1.1.1.2.2.2.2.2" xref="S2.E3.m1.1.1.1.1.2.2.2.2.2.cmml"><mover accent="true" id="S2.E3.m1.1.1.1.1.2.2.2.2.2.2.2" xref="S2.E3.m1.1.1.1.1.2.2.2.2.2.2.2.cmml"><mi id="S2.E3.m1.1.1.1.1.2.2.2.2.2.2.2.2" xref="S2.E3.m1.1.1.1.1.2.2.2.2.2.2.2.2.cmml">y</mi><mo id="S2.E3.m1.1.1.1.1.2.2.2.2.2.2.2.1" xref="S2.E3.m1.1.1.1.1.2.2.2.2.2.2.2.1.cmml">^</mo></mover><mi id="S2.E3.m1.1.1.1.1.2.2.2.2.2.2.3" xref="S2.E3.m1.1.1.1.1.2.2.2.2.2.2.3.cmml">T</mi><mi id="S2.E3.m1.1.1.1.1.2.2.2.2.2.3" xref="S2.E3.m1.1.1.1.1.2.2.2.2.2.3.cmml">z</mi></msubsup><mo id="S2.E3.m1.1.1.1.1.2.2.2.2.5" stretchy="false" xref="S2.E3.m1.1.1.1.1.2.2.2.3.cmml">)</mo></mrow></mrow></mrow></mrow><mo id="S2.E3.m1.1.1.1.2" xref="S2.E3.m1.1.1.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S2.E3.m1.1b"><apply id="S2.E3.m1.1.1.1.1.cmml" xref="S2.E3.m1.1.1.1"><eq id="S2.E3.m1.1.1.1.1.3.cmml" xref="S2.E3.m1.1.1.1.1.3"></eq><apply id="S2.E3.m1.1.1.1.1.4.cmml" xref="S2.E3.m1.1.1.1.1.4"><csymbol cd="ambiguous" id="S2.E3.m1.1.1.1.1.4.1.cmml" xref="S2.E3.m1.1.1.1.1.4">subscript</csymbol><ci id="S2.E3.m1.1.1.1.1.4.2.cmml" xref="S2.E3.m1.1.1.1.1.4.2">ℒ</ci><ci id="S2.E3.m1.1.1.1.1.4.3a.cmml" xref="S2.E3.m1.1.1.1.1.4.3"><mtext id="S2.E3.m1.1.1.1.1.4.3.cmml" mathsize="70%" xref="S2.E3.m1.1.1.1.1.4.3">pretrain</mtext></ci></apply><apply id="S2.E3.m1.1.1.1.1.2.cmml" xref="S2.E3.m1.1.1.1.1.2"><apply id="S2.E3.m1.1.1.1.1.2.3.cmml" xref="S2.E3.m1.1.1.1.1.2.3"><csymbol cd="ambiguous" id="S2.E3.m1.1.1.1.1.2.3.1.cmml" xref="S2.E3.m1.1.1.1.1.2.3">subscript</csymbol><sum id="S2.E3.m1.1.1.1.1.2.3.2.cmml" xref="S2.E3.m1.1.1.1.1.2.3.2"></sum><apply id="S2.E3.m1.1.1.1.1.2.3.3.cmml" xref="S2.E3.m1.1.1.1.1.2.3.3"><in id="S2.E3.m1.1.1.1.1.2.3.3.1.cmml" xref="S2.E3.m1.1.1.1.1.2.3.3.1"></in><apply id="S2.E3.m1.1.1.1.1.2.3.3.2.cmml" xref="S2.E3.m1.1.1.1.1.2.3.3.2"><csymbol cd="ambiguous" id="S2.E3.m1.1.1.1.1.2.3.3.2.1.cmml" xref="S2.E3.m1.1.1.1.1.2.3.3.2">subscript</csymbol><ci id="S2.E3.m1.1.1.1.1.2.3.3.2.2.cmml" xref="S2.E3.m1.1.1.1.1.2.3.3.2.2">𝑥</ci><ci id="S2.E3.m1.1.1.1.1.2.3.3.2.3.cmml" xref="S2.E3.m1.1.1.1.1.2.3.3.2.3">𝑧</ci></apply><apply id="S2.E3.m1.1.1.1.1.2.3.3.3.cmml" xref="S2.E3.m1.1.1.1.1.2.3.3.3"><csymbol cd="ambiguous" id="S2.E3.m1.1.1.1.1.2.3.3.3.1.cmml" xref="S2.E3.m1.1.1.1.1.2.3.3.3">subscript</csymbol><ci id="S2.E3.m1.1.1.1.1.2.3.3.3.2.cmml" xref="S2.E3.m1.1.1.1.1.2.3.3.3.2">𝒟</ci><ci id="S2.E3.m1.1.1.1.1.2.3.3.3.3a.cmml" xref="S2.E3.m1.1.1.1.1.2.3.3.3.3"><mtext id="S2.E3.m1.1.1.1.1.2.3.3.3.3.cmml" mathsize="50%" xref="S2.E3.m1.1.1.1.1.2.3.3.3.3">shifting</mtext></ci></apply></apply></apply><apply id="S2.E3.m1.1.1.1.1.2.2.cmml" xref="S2.E3.m1.1.1.1.1.2.2"><times id="S2.E3.m1.1.1.1.1.2.2.3.cmml" xref="S2.E3.m1.1.1.1.1.2.2.3"></times><ci id="S2.E3.m1.1.1.1.1.2.2.4a.cmml" xref="S2.E3.m1.1.1.1.1.2.2.4"><mtext id="S2.E3.m1.1.1.1.1.2.2.4.cmml" xref="S2.E3.m1.1.1.1.1.2.2.4">CE</mtext></ci><interval closure="open" id="S2.E3.m1.1.1.1.1.2.2.2.3.cmml" xref="S2.E3.m1.1.1.1.1.2.2.2.2"><apply id="S2.E3.m1.1.1.1.1.1.1.1.1.1.cmml" xref="S2.E3.m1.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S2.E3.m1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S2.E3.m1.1.1.1.1.1.1.1.1.1">superscript</csymbol><ci id="S2.E3.m1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S2.E3.m1.1.1.1.1.1.1.1.1.1.2">𝑦</ci><ci id="S2.E3.m1.1.1.1.1.1.1.1.1.1.3.cmml" xref="S2.E3.m1.1.1.1.1.1.1.1.1.1.3">𝑧</ci></apply><apply id="S2.E3.m1.1.1.1.1.2.2.2.2.2.cmml" xref="S2.E3.m1.1.1.1.1.2.2.2.2.2"><csymbol cd="ambiguous" id="S2.E3.m1.1.1.1.1.2.2.2.2.2.1.cmml" xref="S2.E3.m1.1.1.1.1.2.2.2.2.2">superscript</csymbol><apply id="S2.E3.m1.1.1.1.1.2.2.2.2.2.2.cmml" xref="S2.E3.m1.1.1.1.1.2.2.2.2.2"><csymbol cd="ambiguous" id="S2.E3.m1.1.1.1.1.2.2.2.2.2.2.1.cmml" xref="S2.E3.m1.1.1.1.1.2.2.2.2.2">subscript</csymbol><apply id="S2.E3.m1.1.1.1.1.2.2.2.2.2.2.2.cmml" xref="S2.E3.m1.1.1.1.1.2.2.2.2.2.2.2"><ci id="S2.E3.m1.1.1.1.1.2.2.2.2.2.2.2.1.cmml" xref="S2.E3.m1.1.1.1.1.2.2.2.2.2.2.2.1">^</ci><ci id="S2.E3.m1.1.1.1.1.2.2.2.2.2.2.2.2.cmml" xref="S2.E3.m1.1.1.1.1.2.2.2.2.2.2.2.2">𝑦</ci></apply><ci id="S2.E3.m1.1.1.1.1.2.2.2.2.2.2.3.cmml" xref="S2.E3.m1.1.1.1.1.2.2.2.2.2.2.3">𝑇</ci></apply><ci id="S2.E3.m1.1.1.1.1.2.2.2.2.2.3.cmml" xref="S2.E3.m1.1.1.1.1.2.2.2.2.2.3">𝑧</ci></apply></interval></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.E3.m1.1c">\mathcal{L}_{\text{pretrain}}=\sum_{x_{z}\in\mathcal{D}_{\text{shifting}}}%
\text{CE}(y^{z},\hat{y}_{T}^{z}),</annotation><annotation encoding="application/x-llamapun" id="S2.E3.m1.1d">caligraphic_L start_POSTSUBSCRIPT pretrain end_POSTSUBSCRIPT = ∑ start_POSTSUBSCRIPT italic_x start_POSTSUBSCRIPT italic_z end_POSTSUBSCRIPT ∈ caligraphic_D start_POSTSUBSCRIPT shifting end_POSTSUBSCRIPT end_POSTSUBSCRIPT CE ( italic_y start_POSTSUPERSCRIPT italic_z end_POSTSUPERSCRIPT , over^ start_ARG italic_y end_ARG start_POSTSUBSCRIPT italic_T end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_z end_POSTSUPERSCRIPT ) ,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S2.p8.7">where <math alttext="CE" class="ltx_Math" display="inline" id="S2.p8.5.m1.1"><semantics id="S2.p8.5.m1.1a"><mrow id="S2.p8.5.m1.1.1" xref="S2.p8.5.m1.1.1.cmml"><mi id="S2.p8.5.m1.1.1.2" xref="S2.p8.5.m1.1.1.2.cmml">C</mi><mo id="S2.p8.5.m1.1.1.1" xref="S2.p8.5.m1.1.1.1.cmml">⁢</mo><mi id="S2.p8.5.m1.1.1.3" xref="S2.p8.5.m1.1.1.3.cmml">E</mi></mrow><annotation-xml encoding="MathML-Content" id="S2.p8.5.m1.1b"><apply id="S2.p8.5.m1.1.1.cmml" xref="S2.p8.5.m1.1.1"><times id="S2.p8.5.m1.1.1.1.cmml" xref="S2.p8.5.m1.1.1.1"></times><ci id="S2.p8.5.m1.1.1.2.cmml" xref="S2.p8.5.m1.1.1.2">𝐶</ci><ci id="S2.p8.5.m1.1.1.3.cmml" xref="S2.p8.5.m1.1.1.3">𝐸</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.p8.5.m1.1c">CE</annotation><annotation encoding="application/x-llamapun" id="S2.p8.5.m1.1d">italic_C italic_E</annotation></semantics></math> is binary cross-entropy. This step obtains the model <math alttext="R(x)" class="ltx_Math" display="inline" id="S2.p8.6.m2.1"><semantics id="S2.p8.6.m2.1a"><mrow id="S2.p8.6.m2.1.2" xref="S2.p8.6.m2.1.2.cmml"><mi id="S2.p8.6.m2.1.2.2" xref="S2.p8.6.m2.1.2.2.cmml">R</mi><mo id="S2.p8.6.m2.1.2.1" xref="S2.p8.6.m2.1.2.1.cmml">⁢</mo><mrow id="S2.p8.6.m2.1.2.3.2" xref="S2.p8.6.m2.1.2.cmml"><mo id="S2.p8.6.m2.1.2.3.2.1" stretchy="false" xref="S2.p8.6.m2.1.2.cmml">(</mo><mi id="S2.p8.6.m2.1.1" xref="S2.p8.6.m2.1.1.cmml">x</mi><mo id="S2.p8.6.m2.1.2.3.2.2" stretchy="false" xref="S2.p8.6.m2.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.p8.6.m2.1b"><apply id="S2.p8.6.m2.1.2.cmml" xref="S2.p8.6.m2.1.2"><times id="S2.p8.6.m2.1.2.1.cmml" xref="S2.p8.6.m2.1.2.1"></times><ci id="S2.p8.6.m2.1.2.2.cmml" xref="S2.p8.6.m2.1.2.2">𝑅</ci><ci id="S2.p8.6.m2.1.1.cmml" xref="S2.p8.6.m2.1.1">𝑥</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.p8.6.m2.1c">R(x)</annotation><annotation encoding="application/x-llamapun" id="S2.p8.6.m2.1d">italic_R ( italic_x )</annotation></semantics></math> that approximates <math alttext="P(x_{s}|x)" class="ltx_Math" display="inline" id="S2.p8.7.m3.1"><semantics id="S2.p8.7.m3.1a"><mrow id="S2.p8.7.m3.1.1" xref="S2.p8.7.m3.1.1.cmml"><mi id="S2.p8.7.m3.1.1.3" xref="S2.p8.7.m3.1.1.3.cmml">P</mi><mo id="S2.p8.7.m3.1.1.2" xref="S2.p8.7.m3.1.1.2.cmml">⁢</mo><mrow id="S2.p8.7.m3.1.1.1.1" xref="S2.p8.7.m3.1.1.1.1.1.cmml"><mo id="S2.p8.7.m3.1.1.1.1.2" stretchy="false" xref="S2.p8.7.m3.1.1.1.1.1.cmml">(</mo><mrow id="S2.p8.7.m3.1.1.1.1.1" xref="S2.p8.7.m3.1.1.1.1.1.cmml"><msub id="S2.p8.7.m3.1.1.1.1.1.2" xref="S2.p8.7.m3.1.1.1.1.1.2.cmml"><mi id="S2.p8.7.m3.1.1.1.1.1.2.2" xref="S2.p8.7.m3.1.1.1.1.1.2.2.cmml">x</mi><mi id="S2.p8.7.m3.1.1.1.1.1.2.3" xref="S2.p8.7.m3.1.1.1.1.1.2.3.cmml">s</mi></msub><mo fence="false" id="S2.p8.7.m3.1.1.1.1.1.1" xref="S2.p8.7.m3.1.1.1.1.1.1.cmml">|</mo><mi id="S2.p8.7.m3.1.1.1.1.1.3" xref="S2.p8.7.m3.1.1.1.1.1.3.cmml">x</mi></mrow><mo id="S2.p8.7.m3.1.1.1.1.3" stretchy="false" xref="S2.p8.7.m3.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.p8.7.m3.1b"><apply id="S2.p8.7.m3.1.1.cmml" xref="S2.p8.7.m3.1.1"><times id="S2.p8.7.m3.1.1.2.cmml" xref="S2.p8.7.m3.1.1.2"></times><ci id="S2.p8.7.m3.1.1.3.cmml" xref="S2.p8.7.m3.1.1.3">𝑃</ci><apply id="S2.p8.7.m3.1.1.1.1.1.cmml" xref="S2.p8.7.m3.1.1.1.1"><csymbol cd="latexml" id="S2.p8.7.m3.1.1.1.1.1.1.cmml" xref="S2.p8.7.m3.1.1.1.1.1.1">conditional</csymbol><apply id="S2.p8.7.m3.1.1.1.1.1.2.cmml" xref="S2.p8.7.m3.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S2.p8.7.m3.1.1.1.1.1.2.1.cmml" xref="S2.p8.7.m3.1.1.1.1.1.2">subscript</csymbol><ci id="S2.p8.7.m3.1.1.1.1.1.2.2.cmml" xref="S2.p8.7.m3.1.1.1.1.1.2.2">𝑥</ci><ci id="S2.p8.7.m3.1.1.1.1.1.2.3.cmml" xref="S2.p8.7.m3.1.1.1.1.1.2.3">𝑠</ci></apply><ci id="S2.p8.7.m3.1.1.1.1.1.3.cmml" xref="S2.p8.7.m3.1.1.1.1.1.3">𝑥</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.p8.7.m3.1c">P(x_{s}|x)</annotation><annotation encoding="application/x-llamapun" id="S2.p8.7.m3.1d">italic_P ( italic_x start_POSTSUBSCRIPT italic_s end_POSTSUBSCRIPT | italic_x )</annotation></semantics></math>.</p>
</div>
<div class="ltx_para" id="S2.p9">
<p class="ltx_p" id="S2.p9.2">Once we have obtained an <math alttext="R(x)" class="ltx_Math" display="inline" id="S2.p9.1.m1.1"><semantics id="S2.p9.1.m1.1a"><mrow id="S2.p9.1.m1.1.2" xref="S2.p9.1.m1.1.2.cmml"><mi id="S2.p9.1.m1.1.2.2" xref="S2.p9.1.m1.1.2.2.cmml">R</mi><mo id="S2.p9.1.m1.1.2.1" xref="S2.p9.1.m1.1.2.1.cmml">⁢</mo><mrow id="S2.p9.1.m1.1.2.3.2" xref="S2.p9.1.m1.1.2.cmml"><mo id="S2.p9.1.m1.1.2.3.2.1" stretchy="false" xref="S2.p9.1.m1.1.2.cmml">(</mo><mi id="S2.p9.1.m1.1.1" xref="S2.p9.1.m1.1.1.cmml">x</mi><mo id="S2.p9.1.m1.1.2.3.2.2" stretchy="false" xref="S2.p9.1.m1.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.p9.1.m1.1b"><apply id="S2.p9.1.m1.1.2.cmml" xref="S2.p9.1.m1.1.2"><times id="S2.p9.1.m1.1.2.1.cmml" xref="S2.p9.1.m1.1.2.1"></times><ci id="S2.p9.1.m1.1.2.2.cmml" xref="S2.p9.1.m1.1.2.2">𝑅</ci><ci id="S2.p9.1.m1.1.1.cmml" xref="S2.p9.1.m1.1.1">𝑥</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.p9.1.m1.1c">R(x)</annotation><annotation encoding="application/x-llamapun" id="S2.p9.1.m1.1d">italic_R ( italic_x )</annotation></semantics></math> that has been pretrained with shifting data, we can utilize <math alttext="R(x)" class="ltx_Math" display="inline" id="S2.p9.2.m2.1"><semantics id="S2.p9.2.m2.1a"><mrow id="S2.p9.2.m2.1.2" xref="S2.p9.2.m2.1.2.cmml"><mi id="S2.p9.2.m2.1.2.2" xref="S2.p9.2.m2.1.2.2.cmml">R</mi><mo id="S2.p9.2.m2.1.2.1" xref="S2.p9.2.m2.1.2.1.cmml">⁢</mo><mrow id="S2.p9.2.m2.1.2.3.2" xref="S2.p9.2.m2.1.2.cmml"><mo id="S2.p9.2.m2.1.2.3.2.1" stretchy="false" xref="S2.p9.2.m2.1.2.cmml">(</mo><mi id="S2.p9.2.m2.1.1" xref="S2.p9.2.m2.1.1.cmml">x</mi><mo id="S2.p9.2.m2.1.2.3.2.2" stretchy="false" xref="S2.p9.2.m2.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.p9.2.m2.1b"><apply id="S2.p9.2.m2.1.2.cmml" xref="S2.p9.2.m2.1.2"><times id="S2.p9.2.m2.1.2.1.cmml" xref="S2.p9.2.m2.1.2.1"></times><ci id="S2.p9.2.m2.1.2.2.cmml" xref="S2.p9.2.m2.1.2.2">𝑅</ci><ci id="S2.p9.2.m2.1.1.cmml" xref="S2.p9.2.m2.1.1">𝑥</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.p9.2.m2.1c">R(x)</annotation><annotation encoding="application/x-llamapun" id="S2.p9.2.m2.1d">italic_R ( italic_x )</annotation></semantics></math> in the training of the Retrieval Framework. We use unshifting data to minimize the following loss function:</p>
<table class="ltx_equation ltx_eqn_table" id="S2.E4">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_left" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_left">(4)</span></td>
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\mathcal{L}_{\text{retrieval}}=\sum_{x_{z}\in\mathcal{D}_{\text{train}}}\text{%
CE}(y^{z},\hat{y}_{R}^{z})," class="ltx_Math" display="block" id="S2.E4.m1.1"><semantics id="S2.E4.m1.1a"><mrow id="S2.E4.m1.1.1.1" xref="S2.E4.m1.1.1.1.1.cmml"><mrow id="S2.E4.m1.1.1.1.1" xref="S2.E4.m1.1.1.1.1.cmml"><msub id="S2.E4.m1.1.1.1.1.4" xref="S2.E4.m1.1.1.1.1.4.cmml"><mi class="ltx_font_mathcaligraphic" id="S2.E4.m1.1.1.1.1.4.2" xref="S2.E4.m1.1.1.1.1.4.2.cmml">ℒ</mi><mtext id="S2.E4.m1.1.1.1.1.4.3" xref="S2.E4.m1.1.1.1.1.4.3a.cmml">retrieval</mtext></msub><mo id="S2.E4.m1.1.1.1.1.3" rspace="0.111em" xref="S2.E4.m1.1.1.1.1.3.cmml">=</mo><mrow id="S2.E4.m1.1.1.1.1.2" xref="S2.E4.m1.1.1.1.1.2.cmml"><munder id="S2.E4.m1.1.1.1.1.2.3" xref="S2.E4.m1.1.1.1.1.2.3.cmml"><mo id="S2.E4.m1.1.1.1.1.2.3.2" movablelimits="false" xref="S2.E4.m1.1.1.1.1.2.3.2.cmml">∑</mo><mrow id="S2.E4.m1.1.1.1.1.2.3.3" xref="S2.E4.m1.1.1.1.1.2.3.3.cmml"><msub id="S2.E4.m1.1.1.1.1.2.3.3.2" xref="S2.E4.m1.1.1.1.1.2.3.3.2.cmml"><mi id="S2.E4.m1.1.1.1.1.2.3.3.2.2" xref="S2.E4.m1.1.1.1.1.2.3.3.2.2.cmml">x</mi><mi id="S2.E4.m1.1.1.1.1.2.3.3.2.3" xref="S2.E4.m1.1.1.1.1.2.3.3.2.3.cmml">z</mi></msub><mo id="S2.E4.m1.1.1.1.1.2.3.3.1" xref="S2.E4.m1.1.1.1.1.2.3.3.1.cmml">∈</mo><msub id="S2.E4.m1.1.1.1.1.2.3.3.3" xref="S2.E4.m1.1.1.1.1.2.3.3.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S2.E4.m1.1.1.1.1.2.3.3.3.2" xref="S2.E4.m1.1.1.1.1.2.3.3.3.2.cmml">𝒟</mi><mtext id="S2.E4.m1.1.1.1.1.2.3.3.3.3" xref="S2.E4.m1.1.1.1.1.2.3.3.3.3a.cmml">train</mtext></msub></mrow></munder><mrow id="S2.E4.m1.1.1.1.1.2.2" xref="S2.E4.m1.1.1.1.1.2.2.cmml"><mtext id="S2.E4.m1.1.1.1.1.2.2.4" xref="S2.E4.m1.1.1.1.1.2.2.4a.cmml">CE</mtext><mo id="S2.E4.m1.1.1.1.1.2.2.3" xref="S2.E4.m1.1.1.1.1.2.2.3.cmml">⁢</mo><mrow id="S2.E4.m1.1.1.1.1.2.2.2.2" xref="S2.E4.m1.1.1.1.1.2.2.2.3.cmml"><mo id="S2.E4.m1.1.1.1.1.2.2.2.2.3" stretchy="false" xref="S2.E4.m1.1.1.1.1.2.2.2.3.cmml">(</mo><msup id="S2.E4.m1.1.1.1.1.1.1.1.1.1" xref="S2.E4.m1.1.1.1.1.1.1.1.1.1.cmml"><mi id="S2.E4.m1.1.1.1.1.1.1.1.1.1.2" xref="S2.E4.m1.1.1.1.1.1.1.1.1.1.2.cmml">y</mi><mi id="S2.E4.m1.1.1.1.1.1.1.1.1.1.3" xref="S2.E4.m1.1.1.1.1.1.1.1.1.1.3.cmml">z</mi></msup><mo id="S2.E4.m1.1.1.1.1.2.2.2.2.4" xref="S2.E4.m1.1.1.1.1.2.2.2.3.cmml">,</mo><msubsup id="S2.E4.m1.1.1.1.1.2.2.2.2.2" xref="S2.E4.m1.1.1.1.1.2.2.2.2.2.cmml"><mover accent="true" id="S2.E4.m1.1.1.1.1.2.2.2.2.2.2.2" xref="S2.E4.m1.1.1.1.1.2.2.2.2.2.2.2.cmml"><mi id="S2.E4.m1.1.1.1.1.2.2.2.2.2.2.2.2" xref="S2.E4.m1.1.1.1.1.2.2.2.2.2.2.2.2.cmml">y</mi><mo id="S2.E4.m1.1.1.1.1.2.2.2.2.2.2.2.1" xref="S2.E4.m1.1.1.1.1.2.2.2.2.2.2.2.1.cmml">^</mo></mover><mi id="S2.E4.m1.1.1.1.1.2.2.2.2.2.2.3" xref="S2.E4.m1.1.1.1.1.2.2.2.2.2.2.3.cmml">R</mi><mi id="S2.E4.m1.1.1.1.1.2.2.2.2.2.3" xref="S2.E4.m1.1.1.1.1.2.2.2.2.2.3.cmml">z</mi></msubsup><mo id="S2.E4.m1.1.1.1.1.2.2.2.2.5" stretchy="false" xref="S2.E4.m1.1.1.1.1.2.2.2.3.cmml">)</mo></mrow></mrow></mrow></mrow><mo id="S2.E4.m1.1.1.1.2" xref="S2.E4.m1.1.1.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S2.E4.m1.1b"><apply id="S2.E4.m1.1.1.1.1.cmml" xref="S2.E4.m1.1.1.1"><eq id="S2.E4.m1.1.1.1.1.3.cmml" xref="S2.E4.m1.1.1.1.1.3"></eq><apply id="S2.E4.m1.1.1.1.1.4.cmml" xref="S2.E4.m1.1.1.1.1.4"><csymbol cd="ambiguous" id="S2.E4.m1.1.1.1.1.4.1.cmml" xref="S2.E4.m1.1.1.1.1.4">subscript</csymbol><ci id="S2.E4.m1.1.1.1.1.4.2.cmml" xref="S2.E4.m1.1.1.1.1.4.2">ℒ</ci><ci id="S2.E4.m1.1.1.1.1.4.3a.cmml" xref="S2.E4.m1.1.1.1.1.4.3"><mtext id="S2.E4.m1.1.1.1.1.4.3.cmml" mathsize="70%" xref="S2.E4.m1.1.1.1.1.4.3">retrieval</mtext></ci></apply><apply id="S2.E4.m1.1.1.1.1.2.cmml" xref="S2.E4.m1.1.1.1.1.2"><apply id="S2.E4.m1.1.1.1.1.2.3.cmml" xref="S2.E4.m1.1.1.1.1.2.3"><csymbol cd="ambiguous" id="S2.E4.m1.1.1.1.1.2.3.1.cmml" xref="S2.E4.m1.1.1.1.1.2.3">subscript</csymbol><sum id="S2.E4.m1.1.1.1.1.2.3.2.cmml" xref="S2.E4.m1.1.1.1.1.2.3.2"></sum><apply id="S2.E4.m1.1.1.1.1.2.3.3.cmml" xref="S2.E4.m1.1.1.1.1.2.3.3"><in id="S2.E4.m1.1.1.1.1.2.3.3.1.cmml" xref="S2.E4.m1.1.1.1.1.2.3.3.1"></in><apply id="S2.E4.m1.1.1.1.1.2.3.3.2.cmml" xref="S2.E4.m1.1.1.1.1.2.3.3.2"><csymbol cd="ambiguous" id="S2.E4.m1.1.1.1.1.2.3.3.2.1.cmml" xref="S2.E4.m1.1.1.1.1.2.3.3.2">subscript</csymbol><ci id="S2.E4.m1.1.1.1.1.2.3.3.2.2.cmml" xref="S2.E4.m1.1.1.1.1.2.3.3.2.2">𝑥</ci><ci id="S2.E4.m1.1.1.1.1.2.3.3.2.3.cmml" xref="S2.E4.m1.1.1.1.1.2.3.3.2.3">𝑧</ci></apply><apply id="S2.E4.m1.1.1.1.1.2.3.3.3.cmml" xref="S2.E4.m1.1.1.1.1.2.3.3.3"><csymbol cd="ambiguous" id="S2.E4.m1.1.1.1.1.2.3.3.3.1.cmml" xref="S2.E4.m1.1.1.1.1.2.3.3.3">subscript</csymbol><ci id="S2.E4.m1.1.1.1.1.2.3.3.3.2.cmml" xref="S2.E4.m1.1.1.1.1.2.3.3.3.2">𝒟</ci><ci id="S2.E4.m1.1.1.1.1.2.3.3.3.3a.cmml" xref="S2.E4.m1.1.1.1.1.2.3.3.3.3"><mtext id="S2.E4.m1.1.1.1.1.2.3.3.3.3.cmml" mathsize="50%" xref="S2.E4.m1.1.1.1.1.2.3.3.3.3">train</mtext></ci></apply></apply></apply><apply id="S2.E4.m1.1.1.1.1.2.2.cmml" xref="S2.E4.m1.1.1.1.1.2.2"><times id="S2.E4.m1.1.1.1.1.2.2.3.cmml" xref="S2.E4.m1.1.1.1.1.2.2.3"></times><ci id="S2.E4.m1.1.1.1.1.2.2.4a.cmml" xref="S2.E4.m1.1.1.1.1.2.2.4"><mtext id="S2.E4.m1.1.1.1.1.2.2.4.cmml" xref="S2.E4.m1.1.1.1.1.2.2.4">CE</mtext></ci><interval closure="open" id="S2.E4.m1.1.1.1.1.2.2.2.3.cmml" xref="S2.E4.m1.1.1.1.1.2.2.2.2"><apply id="S2.E4.m1.1.1.1.1.1.1.1.1.1.cmml" xref="S2.E4.m1.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S2.E4.m1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S2.E4.m1.1.1.1.1.1.1.1.1.1">superscript</csymbol><ci id="S2.E4.m1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S2.E4.m1.1.1.1.1.1.1.1.1.1.2">𝑦</ci><ci id="S2.E4.m1.1.1.1.1.1.1.1.1.1.3.cmml" xref="S2.E4.m1.1.1.1.1.1.1.1.1.1.3">𝑧</ci></apply><apply id="S2.E4.m1.1.1.1.1.2.2.2.2.2.cmml" xref="S2.E4.m1.1.1.1.1.2.2.2.2.2"><csymbol cd="ambiguous" id="S2.E4.m1.1.1.1.1.2.2.2.2.2.1.cmml" xref="S2.E4.m1.1.1.1.1.2.2.2.2.2">superscript</csymbol><apply id="S2.E4.m1.1.1.1.1.2.2.2.2.2.2.cmml" xref="S2.E4.m1.1.1.1.1.2.2.2.2.2"><csymbol cd="ambiguous" id="S2.E4.m1.1.1.1.1.2.2.2.2.2.2.1.cmml" xref="S2.E4.m1.1.1.1.1.2.2.2.2.2">subscript</csymbol><apply id="S2.E4.m1.1.1.1.1.2.2.2.2.2.2.2.cmml" xref="S2.E4.m1.1.1.1.1.2.2.2.2.2.2.2"><ci id="S2.E4.m1.1.1.1.1.2.2.2.2.2.2.2.1.cmml" xref="S2.E4.m1.1.1.1.1.2.2.2.2.2.2.2.1">^</ci><ci id="S2.E4.m1.1.1.1.1.2.2.2.2.2.2.2.2.cmml" xref="S2.E4.m1.1.1.1.1.2.2.2.2.2.2.2.2">𝑦</ci></apply><ci id="S2.E4.m1.1.1.1.1.2.2.2.2.2.2.3.cmml" xref="S2.E4.m1.1.1.1.1.2.2.2.2.2.2.3">𝑅</ci></apply><ci id="S2.E4.m1.1.1.1.1.2.2.2.2.2.3.cmml" xref="S2.E4.m1.1.1.1.1.2.2.2.2.2.3">𝑧</ci></apply></interval></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.E4.m1.1c">\mathcal{L}_{\text{retrieval}}=\sum_{x_{z}\in\mathcal{D}_{\text{train}}}\text{%
CE}(y^{z},\hat{y}_{R}^{z}),</annotation><annotation encoding="application/x-llamapun" id="S2.E4.m1.1d">caligraphic_L start_POSTSUBSCRIPT retrieval end_POSTSUBSCRIPT = ∑ start_POSTSUBSCRIPT italic_x start_POSTSUBSCRIPT italic_z end_POSTSUBSCRIPT ∈ caligraphic_D start_POSTSUBSCRIPT train end_POSTSUBSCRIPT end_POSTSUBSCRIPT CE ( italic_y start_POSTSUPERSCRIPT italic_z end_POSTSUPERSCRIPT , over^ start_ARG italic_y end_ARG start_POSTSUBSCRIPT italic_R end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_z end_POSTSUPERSCRIPT ) ,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S2.p9.5">where <span class="ltx_text ltx_markedasmath" id="S2.p9.5.1">CE</span> is binary cross-entropy. In this step, we obtain the Retrieval Framework, <math alttext="f_{\theta}" class="ltx_Math" display="inline" id="S2.p9.4.m2.1"><semantics id="S2.p9.4.m2.1a"><msub id="S2.p9.4.m2.1.1" xref="S2.p9.4.m2.1.1.cmml"><mi id="S2.p9.4.m2.1.1.2" xref="S2.p9.4.m2.1.1.2.cmml">f</mi><mi id="S2.p9.4.m2.1.1.3" xref="S2.p9.4.m2.1.1.3.cmml">θ</mi></msub><annotation-xml encoding="MathML-Content" id="S2.p9.4.m2.1b"><apply id="S2.p9.4.m2.1.1.cmml" xref="S2.p9.4.m2.1.1"><csymbol cd="ambiguous" id="S2.p9.4.m2.1.1.1.cmml" xref="S2.p9.4.m2.1.1">subscript</csymbol><ci id="S2.p9.4.m2.1.1.2.cmml" xref="S2.p9.4.m2.1.1.2">𝑓</ci><ci id="S2.p9.4.m2.1.1.3.cmml" xref="S2.p9.4.m2.1.1.3">𝜃</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.p9.4.m2.1c">f_{\theta}</annotation><annotation encoding="application/x-llamapun" id="S2.p9.4.m2.1d">italic_f start_POSTSUBSCRIPT italic_θ end_POSTSUBSCRIPT</annotation></semantics></math>, which approximates <math alttext="P(y|x,x_{s})" class="ltx_Math" display="inline" id="S2.p9.5.m3.2"><semantics id="S2.p9.5.m3.2a"><mrow id="S2.p9.5.m3.2.2" xref="S2.p9.5.m3.2.2.cmml"><mi id="S2.p9.5.m3.2.2.3" xref="S2.p9.5.m3.2.2.3.cmml">P</mi><mo id="S2.p9.5.m3.2.2.2" xref="S2.p9.5.m3.2.2.2.cmml">⁢</mo><mrow id="S2.p9.5.m3.2.2.1.1" xref="S2.p9.5.m3.2.2.1.1.1.cmml"><mo id="S2.p9.5.m3.2.2.1.1.2" stretchy="false" xref="S2.p9.5.m3.2.2.1.1.1.cmml">(</mo><mrow id="S2.p9.5.m3.2.2.1.1.1" xref="S2.p9.5.m3.2.2.1.1.1.cmml"><mi id="S2.p9.5.m3.2.2.1.1.1.3" xref="S2.p9.5.m3.2.2.1.1.1.3.cmml">y</mi><mo fence="false" id="S2.p9.5.m3.2.2.1.1.1.2" xref="S2.p9.5.m3.2.2.1.1.1.2.cmml">|</mo><mrow id="S2.p9.5.m3.2.2.1.1.1.1.1" xref="S2.p9.5.m3.2.2.1.1.1.1.2.cmml"><mi id="S2.p9.5.m3.1.1" xref="S2.p9.5.m3.1.1.cmml">x</mi><mo id="S2.p9.5.m3.2.2.1.1.1.1.1.2" xref="S2.p9.5.m3.2.2.1.1.1.1.2.cmml">,</mo><msub id="S2.p9.5.m3.2.2.1.1.1.1.1.1" xref="S2.p9.5.m3.2.2.1.1.1.1.1.1.cmml"><mi id="S2.p9.5.m3.2.2.1.1.1.1.1.1.2" xref="S2.p9.5.m3.2.2.1.1.1.1.1.1.2.cmml">x</mi><mi id="S2.p9.5.m3.2.2.1.1.1.1.1.1.3" xref="S2.p9.5.m3.2.2.1.1.1.1.1.1.3.cmml">s</mi></msub></mrow></mrow><mo id="S2.p9.5.m3.2.2.1.1.3" stretchy="false" xref="S2.p9.5.m3.2.2.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.p9.5.m3.2b"><apply id="S2.p9.5.m3.2.2.cmml" xref="S2.p9.5.m3.2.2"><times id="S2.p9.5.m3.2.2.2.cmml" xref="S2.p9.5.m3.2.2.2"></times><ci id="S2.p9.5.m3.2.2.3.cmml" xref="S2.p9.5.m3.2.2.3">𝑃</ci><apply id="S2.p9.5.m3.2.2.1.1.1.cmml" xref="S2.p9.5.m3.2.2.1.1"><csymbol cd="latexml" id="S2.p9.5.m3.2.2.1.1.1.2.cmml" xref="S2.p9.5.m3.2.2.1.1.1.2">conditional</csymbol><ci id="S2.p9.5.m3.2.2.1.1.1.3.cmml" xref="S2.p9.5.m3.2.2.1.1.1.3">𝑦</ci><list id="S2.p9.5.m3.2.2.1.1.1.1.2.cmml" xref="S2.p9.5.m3.2.2.1.1.1.1.1"><ci id="S2.p9.5.m3.1.1.cmml" xref="S2.p9.5.m3.1.1">𝑥</ci><apply id="S2.p9.5.m3.2.2.1.1.1.1.1.1.cmml" xref="S2.p9.5.m3.2.2.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S2.p9.5.m3.2.2.1.1.1.1.1.1.1.cmml" xref="S2.p9.5.m3.2.2.1.1.1.1.1.1">subscript</csymbol><ci id="S2.p9.5.m3.2.2.1.1.1.1.1.1.2.cmml" xref="S2.p9.5.m3.2.2.1.1.1.1.1.1.2">𝑥</ci><ci id="S2.p9.5.m3.2.2.1.1.1.1.1.1.3.cmml" xref="S2.p9.5.m3.2.2.1.1.1.1.1.1.3">𝑠</ci></apply></list></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.p9.5.m3.2c">P(y|x,x_{s})</annotation><annotation encoding="application/x-llamapun" id="S2.p9.5.m3.2d">italic_P ( italic_y | italic_x , italic_x start_POSTSUBSCRIPT italic_s end_POSTSUBSCRIPT )</annotation></semantics></math>.</p>
</div>
<div class="ltx_para ltx_noindent" id="S2.p10">
<p class="ltx_p" id="S2.p10.1"><span class="ltx_text ltx_font_bold" id="S2.p10.1.1">Distill Framework.</span>
Although the Retrieval Framework can leverage shifting data to significantly enhance the original model, the deployment of retrieval-based methods presents substantial challenges in terms of storage space and inference time in an online environment. Therefore, we have designed the Distill Framework to eliminate the non-parametric search process.</p>
</div>
<div class="ltx_para" id="S2.p11">
<p class="ltx_p" id="S2.p11.6">Distill Framework can be formulated as:</p>
<table class="ltx_equation ltx_eqn_table" id="S2.E5">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_left" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_left">(5)</span></td>
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\hat{y}_{D}=f^{\prime}_{\phi}(F(x),x,r(x))," class="ltx_Math" display="block" id="S2.E5.m1.4"><semantics id="S2.E5.m1.4a"><mrow id="S2.E5.m1.4.4.1" xref="S2.E5.m1.4.4.1.1.cmml"><mrow id="S2.E5.m1.4.4.1.1" xref="S2.E5.m1.4.4.1.1.cmml"><msub id="S2.E5.m1.4.4.1.1.4" xref="S2.E5.m1.4.4.1.1.4.cmml"><mover accent="true" id="S2.E5.m1.4.4.1.1.4.2" xref="S2.E5.m1.4.4.1.1.4.2.cmml"><mi id="S2.E5.m1.4.4.1.1.4.2.2" xref="S2.E5.m1.4.4.1.1.4.2.2.cmml">y</mi><mo id="S2.E5.m1.4.4.1.1.4.2.1" xref="S2.E5.m1.4.4.1.1.4.2.1.cmml">^</mo></mover><mi id="S2.E5.m1.4.4.1.1.4.3" xref="S2.E5.m1.4.4.1.1.4.3.cmml">D</mi></msub><mo id="S2.E5.m1.4.4.1.1.3" xref="S2.E5.m1.4.4.1.1.3.cmml">=</mo><mrow id="S2.E5.m1.4.4.1.1.2" xref="S2.E5.m1.4.4.1.1.2.cmml"><msubsup id="S2.E5.m1.4.4.1.1.2.4" xref="S2.E5.m1.4.4.1.1.2.4.cmml"><mi id="S2.E5.m1.4.4.1.1.2.4.2.2" xref="S2.E5.m1.4.4.1.1.2.4.2.2.cmml">f</mi><mi id="S2.E5.m1.4.4.1.1.2.4.3" xref="S2.E5.m1.4.4.1.1.2.4.3.cmml">ϕ</mi><mo id="S2.E5.m1.4.4.1.1.2.4.2.3" xref="S2.E5.m1.4.4.1.1.2.4.2.3.cmml">′</mo></msubsup><mo id="S2.E5.m1.4.4.1.1.2.3" xref="S2.E5.m1.4.4.1.1.2.3.cmml">⁢</mo><mrow id="S2.E5.m1.4.4.1.1.2.2.2" xref="S2.E5.m1.4.4.1.1.2.2.3.cmml"><mo id="S2.E5.m1.4.4.1.1.2.2.2.3" stretchy="false" xref="S2.E5.m1.4.4.1.1.2.2.3.cmml">(</mo><mrow id="S2.E5.m1.4.4.1.1.1.1.1.1" xref="S2.E5.m1.4.4.1.1.1.1.1.1.cmml"><mi id="S2.E5.m1.4.4.1.1.1.1.1.1.2" xref="S2.E5.m1.4.4.1.1.1.1.1.1.2.cmml">F</mi><mo id="S2.E5.m1.4.4.1.1.1.1.1.1.1" xref="S2.E5.m1.4.4.1.1.1.1.1.1.1.cmml">⁢</mo><mrow id="S2.E5.m1.4.4.1.1.1.1.1.1.3.2" xref="S2.E5.m1.4.4.1.1.1.1.1.1.cmml"><mo id="S2.E5.m1.4.4.1.1.1.1.1.1.3.2.1" stretchy="false" xref="S2.E5.m1.4.4.1.1.1.1.1.1.cmml">(</mo><mi id="S2.E5.m1.1.1" xref="S2.E5.m1.1.1.cmml">x</mi><mo id="S2.E5.m1.4.4.1.1.1.1.1.1.3.2.2" stretchy="false" xref="S2.E5.m1.4.4.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S2.E5.m1.4.4.1.1.2.2.2.4" xref="S2.E5.m1.4.4.1.1.2.2.3.cmml">,</mo><mi id="S2.E5.m1.3.3" xref="S2.E5.m1.3.3.cmml">x</mi><mo id="S2.E5.m1.4.4.1.1.2.2.2.5" xref="S2.E5.m1.4.4.1.1.2.2.3.cmml">,</mo><mrow id="S2.E5.m1.4.4.1.1.2.2.2.2" xref="S2.E5.m1.4.4.1.1.2.2.2.2.cmml"><mi id="S2.E5.m1.4.4.1.1.2.2.2.2.2" xref="S2.E5.m1.4.4.1.1.2.2.2.2.2.cmml">r</mi><mo id="S2.E5.m1.4.4.1.1.2.2.2.2.1" xref="S2.E5.m1.4.4.1.1.2.2.2.2.1.cmml">⁢</mo><mrow id="S2.E5.m1.4.4.1.1.2.2.2.2.3.2" xref="S2.E5.m1.4.4.1.1.2.2.2.2.cmml"><mo id="S2.E5.m1.4.4.1.1.2.2.2.2.3.2.1" stretchy="false" xref="S2.E5.m1.4.4.1.1.2.2.2.2.cmml">(</mo><mi id="S2.E5.m1.2.2" xref="S2.E5.m1.2.2.cmml">x</mi><mo id="S2.E5.m1.4.4.1.1.2.2.2.2.3.2.2" stretchy="false" xref="S2.E5.m1.4.4.1.1.2.2.2.2.cmml">)</mo></mrow></mrow><mo id="S2.E5.m1.4.4.1.1.2.2.2.6" stretchy="false" xref="S2.E5.m1.4.4.1.1.2.2.3.cmml">)</mo></mrow></mrow></mrow><mo id="S2.E5.m1.4.4.1.2" xref="S2.E5.m1.4.4.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S2.E5.m1.4b"><apply id="S2.E5.m1.4.4.1.1.cmml" xref="S2.E5.m1.4.4.1"><eq id="S2.E5.m1.4.4.1.1.3.cmml" xref="S2.E5.m1.4.4.1.1.3"></eq><apply id="S2.E5.m1.4.4.1.1.4.cmml" xref="S2.E5.m1.4.4.1.1.4"><csymbol cd="ambiguous" id="S2.E5.m1.4.4.1.1.4.1.cmml" xref="S2.E5.m1.4.4.1.1.4">subscript</csymbol><apply id="S2.E5.m1.4.4.1.1.4.2.cmml" xref="S2.E5.m1.4.4.1.1.4.2"><ci id="S2.E5.m1.4.4.1.1.4.2.1.cmml" xref="S2.E5.m1.4.4.1.1.4.2.1">^</ci><ci id="S2.E5.m1.4.4.1.1.4.2.2.cmml" xref="S2.E5.m1.4.4.1.1.4.2.2">𝑦</ci></apply><ci id="S2.E5.m1.4.4.1.1.4.3.cmml" xref="S2.E5.m1.4.4.1.1.4.3">𝐷</ci></apply><apply id="S2.E5.m1.4.4.1.1.2.cmml" xref="S2.E5.m1.4.4.1.1.2"><times id="S2.E5.m1.4.4.1.1.2.3.cmml" xref="S2.E5.m1.4.4.1.1.2.3"></times><apply id="S2.E5.m1.4.4.1.1.2.4.cmml" xref="S2.E5.m1.4.4.1.1.2.4"><csymbol cd="ambiguous" id="S2.E5.m1.4.4.1.1.2.4.1.cmml" xref="S2.E5.m1.4.4.1.1.2.4">subscript</csymbol><apply id="S2.E5.m1.4.4.1.1.2.4.2.cmml" xref="S2.E5.m1.4.4.1.1.2.4"><csymbol cd="ambiguous" id="S2.E5.m1.4.4.1.1.2.4.2.1.cmml" xref="S2.E5.m1.4.4.1.1.2.4">superscript</csymbol><ci id="S2.E5.m1.4.4.1.1.2.4.2.2.cmml" xref="S2.E5.m1.4.4.1.1.2.4.2.2">𝑓</ci><ci id="S2.E5.m1.4.4.1.1.2.4.2.3.cmml" xref="S2.E5.m1.4.4.1.1.2.4.2.3">′</ci></apply><ci id="S2.E5.m1.4.4.1.1.2.4.3.cmml" xref="S2.E5.m1.4.4.1.1.2.4.3">italic-ϕ</ci></apply><vector id="S2.E5.m1.4.4.1.1.2.2.3.cmml" xref="S2.E5.m1.4.4.1.1.2.2.2"><apply id="S2.E5.m1.4.4.1.1.1.1.1.1.cmml" xref="S2.E5.m1.4.4.1.1.1.1.1.1"><times id="S2.E5.m1.4.4.1.1.1.1.1.1.1.cmml" xref="S2.E5.m1.4.4.1.1.1.1.1.1.1"></times><ci id="S2.E5.m1.4.4.1.1.1.1.1.1.2.cmml" xref="S2.E5.m1.4.4.1.1.1.1.1.1.2">𝐹</ci><ci id="S2.E5.m1.1.1.cmml" xref="S2.E5.m1.1.1">𝑥</ci></apply><ci id="S2.E5.m1.3.3.cmml" xref="S2.E5.m1.3.3">𝑥</ci><apply id="S2.E5.m1.4.4.1.1.2.2.2.2.cmml" xref="S2.E5.m1.4.4.1.1.2.2.2.2"><times id="S2.E5.m1.4.4.1.1.2.2.2.2.1.cmml" xref="S2.E5.m1.4.4.1.1.2.2.2.2.1"></times><ci id="S2.E5.m1.4.4.1.1.2.2.2.2.2.cmml" xref="S2.E5.m1.4.4.1.1.2.2.2.2.2">𝑟</ci><ci id="S2.E5.m1.2.2.cmml" xref="S2.E5.m1.2.2">𝑥</ci></apply></vector></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.E5.m1.4c">\hat{y}_{D}=f^{\prime}_{\phi}(F(x),x,r(x)),</annotation><annotation encoding="application/x-llamapun" id="S2.E5.m1.4d">over^ start_ARG italic_y end_ARG start_POSTSUBSCRIPT italic_D end_POSTSUBSCRIPT = italic_f start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_ϕ end_POSTSUBSCRIPT ( italic_F ( italic_x ) , italic_x , italic_r ( italic_x ) ) ,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S2.p11.5">where <math alttext="r(x)" class="ltx_Math" display="inline" id="S2.p11.1.m1.1"><semantics id="S2.p11.1.m1.1a"><mrow id="S2.p11.1.m1.1.2" xref="S2.p11.1.m1.1.2.cmml"><mi id="S2.p11.1.m1.1.2.2" xref="S2.p11.1.m1.1.2.2.cmml">r</mi><mo id="S2.p11.1.m1.1.2.1" xref="S2.p11.1.m1.1.2.1.cmml">⁢</mo><mrow id="S2.p11.1.m1.1.2.3.2" xref="S2.p11.1.m1.1.2.cmml"><mo id="S2.p11.1.m1.1.2.3.2.1" stretchy="false" xref="S2.p11.1.m1.1.2.cmml">(</mo><mi id="S2.p11.1.m1.1.1" xref="S2.p11.1.m1.1.1.cmml">x</mi><mo id="S2.p11.1.m1.1.2.3.2.2" stretchy="false" xref="S2.p11.1.m1.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.p11.1.m1.1b"><apply id="S2.p11.1.m1.1.2.cmml" xref="S2.p11.1.m1.1.2"><times id="S2.p11.1.m1.1.2.1.cmml" xref="S2.p11.1.m1.1.2.1"></times><ci id="S2.p11.1.m1.1.2.2.cmml" xref="S2.p11.1.m1.1.2.2">𝑟</ci><ci id="S2.p11.1.m1.1.1.cmml" xref="S2.p11.1.m1.1.1">𝑥</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.p11.1.m1.1c">r(x)</annotation><annotation encoding="application/x-llamapun" id="S2.p11.1.m1.1d">italic_r ( italic_x )</annotation></semantics></math> is distilled from <math alttext="R(x)" class="ltx_Math" display="inline" id="S2.p11.2.m2.1"><semantics id="S2.p11.2.m2.1a"><mrow id="S2.p11.2.m2.1.2" xref="S2.p11.2.m2.1.2.cmml"><mi id="S2.p11.2.m2.1.2.2" xref="S2.p11.2.m2.1.2.2.cmml">R</mi><mo id="S2.p11.2.m2.1.2.1" xref="S2.p11.2.m2.1.2.1.cmml">⁢</mo><mrow id="S2.p11.2.m2.1.2.3.2" xref="S2.p11.2.m2.1.2.cmml"><mo id="S2.p11.2.m2.1.2.3.2.1" stretchy="false" xref="S2.p11.2.m2.1.2.cmml">(</mo><mi id="S2.p11.2.m2.1.1" xref="S2.p11.2.m2.1.1.cmml">x</mi><mo id="S2.p11.2.m2.1.2.3.2.2" stretchy="false" xref="S2.p11.2.m2.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.p11.2.m2.1b"><apply id="S2.p11.2.m2.1.2.cmml" xref="S2.p11.2.m2.1.2"><times id="S2.p11.2.m2.1.2.1.cmml" xref="S2.p11.2.m2.1.2.1"></times><ci id="S2.p11.2.m2.1.2.2.cmml" xref="S2.p11.2.m2.1.2.2">𝑅</ci><ci id="S2.p11.2.m2.1.1.cmml" xref="S2.p11.2.m2.1.1">𝑥</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.p11.2.m2.1c">R(x)</annotation><annotation encoding="application/x-llamapun" id="S2.p11.2.m2.1d">italic_R ( italic_x )</annotation></semantics></math> pretrained using loss function  (<a class="ltx_ref" href="https://arxiv.org/html/2404.15678v4#S2.E3" title="In 2. PRELIMINARIES ‣ Retrieval and Distill: A Temporal Data Shift-Free Paradigm for Online Recommendation System"><span class="ltx_text ltx_ref_tag">3</span></a>), which we refer to as the <span class="ltx_text ltx_font_italic" id="S2.p11.5.1">search-distill module</span>. Similar to <math alttext="f_{\theta}" class="ltx_Math" display="inline" id="S2.p11.3.m3.1"><semantics id="S2.p11.3.m3.1a"><msub id="S2.p11.3.m3.1.1" xref="S2.p11.3.m3.1.1.cmml"><mi id="S2.p11.3.m3.1.1.2" xref="S2.p11.3.m3.1.1.2.cmml">f</mi><mi id="S2.p11.3.m3.1.1.3" xref="S2.p11.3.m3.1.1.3.cmml">θ</mi></msub><annotation-xml encoding="MathML-Content" id="S2.p11.3.m3.1b"><apply id="S2.p11.3.m3.1.1.cmml" xref="S2.p11.3.m3.1.1"><csymbol cd="ambiguous" id="S2.p11.3.m3.1.1.1.cmml" xref="S2.p11.3.m3.1.1">subscript</csymbol><ci id="S2.p11.3.m3.1.1.2.cmml" xref="S2.p11.3.m3.1.1.2">𝑓</ci><ci id="S2.p11.3.m3.1.1.3.cmml" xref="S2.p11.3.m3.1.1.3">𝜃</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.p11.3.m3.1c">f_{\theta}</annotation><annotation encoding="application/x-llamapun" id="S2.p11.3.m3.1d">italic_f start_POSTSUBSCRIPT italic_θ end_POSTSUBSCRIPT</annotation></semantics></math>, <math alttext="f^{\prime}_{\phi}" class="ltx_Math" display="inline" id="S2.p11.4.m4.1"><semantics id="S2.p11.4.m4.1a"><msubsup id="S2.p11.4.m4.1.1" xref="S2.p11.4.m4.1.1.cmml"><mi id="S2.p11.4.m4.1.1.2.2" xref="S2.p11.4.m4.1.1.2.2.cmml">f</mi><mi id="S2.p11.4.m4.1.1.3" xref="S2.p11.4.m4.1.1.3.cmml">ϕ</mi><mo id="S2.p11.4.m4.1.1.2.3" xref="S2.p11.4.m4.1.1.2.3.cmml">′</mo></msubsup><annotation-xml encoding="MathML-Content" id="S2.p11.4.m4.1b"><apply id="S2.p11.4.m4.1.1.cmml" xref="S2.p11.4.m4.1.1"><csymbol cd="ambiguous" id="S2.p11.4.m4.1.1.1.cmml" xref="S2.p11.4.m4.1.1">subscript</csymbol><apply id="S2.p11.4.m4.1.1.2.cmml" xref="S2.p11.4.m4.1.1"><csymbol cd="ambiguous" id="S2.p11.4.m4.1.1.2.1.cmml" xref="S2.p11.4.m4.1.1">superscript</csymbol><ci id="S2.p11.4.m4.1.1.2.2.cmml" xref="S2.p11.4.m4.1.1.2.2">𝑓</ci><ci id="S2.p11.4.m4.1.1.2.3.cmml" xref="S2.p11.4.m4.1.1.2.3">′</ci></apply><ci id="S2.p11.4.m4.1.1.3.cmml" xref="S2.p11.4.m4.1.1.3">italic-ϕ</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.p11.4.m4.1c">f^{\prime}_{\phi}</annotation><annotation encoding="application/x-llamapun" id="S2.p11.4.m4.1d">italic_f start_POSTSUPERSCRIPT ′ end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_ϕ end_POSTSUBSCRIPT</annotation></semantics></math> approximates <math alttext="P(y|x,x_{s})" class="ltx_Math" display="inline" id="S2.p11.5.m5.2"><semantics id="S2.p11.5.m5.2a"><mrow id="S2.p11.5.m5.2.2" xref="S2.p11.5.m5.2.2.cmml"><mi id="S2.p11.5.m5.2.2.3" xref="S2.p11.5.m5.2.2.3.cmml">P</mi><mo id="S2.p11.5.m5.2.2.2" xref="S2.p11.5.m5.2.2.2.cmml">⁢</mo><mrow id="S2.p11.5.m5.2.2.1.1" xref="S2.p11.5.m5.2.2.1.1.1.cmml"><mo id="S2.p11.5.m5.2.2.1.1.2" stretchy="false" xref="S2.p11.5.m5.2.2.1.1.1.cmml">(</mo><mrow id="S2.p11.5.m5.2.2.1.1.1" xref="S2.p11.5.m5.2.2.1.1.1.cmml"><mi id="S2.p11.5.m5.2.2.1.1.1.3" xref="S2.p11.5.m5.2.2.1.1.1.3.cmml">y</mi><mo fence="false" id="S2.p11.5.m5.2.2.1.1.1.2" xref="S2.p11.5.m5.2.2.1.1.1.2.cmml">|</mo><mrow id="S2.p11.5.m5.2.2.1.1.1.1.1" xref="S2.p11.5.m5.2.2.1.1.1.1.2.cmml"><mi id="S2.p11.5.m5.1.1" xref="S2.p11.5.m5.1.1.cmml">x</mi><mo id="S2.p11.5.m5.2.2.1.1.1.1.1.2" xref="S2.p11.5.m5.2.2.1.1.1.1.2.cmml">,</mo><msub id="S2.p11.5.m5.2.2.1.1.1.1.1.1" xref="S2.p11.5.m5.2.2.1.1.1.1.1.1.cmml"><mi id="S2.p11.5.m5.2.2.1.1.1.1.1.1.2" xref="S2.p11.5.m5.2.2.1.1.1.1.1.1.2.cmml">x</mi><mi id="S2.p11.5.m5.2.2.1.1.1.1.1.1.3" xref="S2.p11.5.m5.2.2.1.1.1.1.1.1.3.cmml">s</mi></msub></mrow></mrow><mo id="S2.p11.5.m5.2.2.1.1.3" stretchy="false" xref="S2.p11.5.m5.2.2.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.p11.5.m5.2b"><apply id="S2.p11.5.m5.2.2.cmml" xref="S2.p11.5.m5.2.2"><times id="S2.p11.5.m5.2.2.2.cmml" xref="S2.p11.5.m5.2.2.2"></times><ci id="S2.p11.5.m5.2.2.3.cmml" xref="S2.p11.5.m5.2.2.3">𝑃</ci><apply id="S2.p11.5.m5.2.2.1.1.1.cmml" xref="S2.p11.5.m5.2.2.1.1"><csymbol cd="latexml" id="S2.p11.5.m5.2.2.1.1.1.2.cmml" xref="S2.p11.5.m5.2.2.1.1.1.2">conditional</csymbol><ci id="S2.p11.5.m5.2.2.1.1.1.3.cmml" xref="S2.p11.5.m5.2.2.1.1.1.3">𝑦</ci><list id="S2.p11.5.m5.2.2.1.1.1.1.2.cmml" xref="S2.p11.5.m5.2.2.1.1.1.1.1"><ci id="S2.p11.5.m5.1.1.cmml" xref="S2.p11.5.m5.1.1">𝑥</ci><apply id="S2.p11.5.m5.2.2.1.1.1.1.1.1.cmml" xref="S2.p11.5.m5.2.2.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S2.p11.5.m5.2.2.1.1.1.1.1.1.1.cmml" xref="S2.p11.5.m5.2.2.1.1.1.1.1.1">subscript</csymbol><ci id="S2.p11.5.m5.2.2.1.1.1.1.1.1.2.cmml" xref="S2.p11.5.m5.2.2.1.1.1.1.1.1.2">𝑥</ci><ci id="S2.p11.5.m5.2.2.1.1.1.1.1.1.3.cmml" xref="S2.p11.5.m5.2.2.1.1.1.1.1.1.3">𝑠</ci></apply></list></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.p11.5.m5.2c">P(y|x,x_{s})</annotation><annotation encoding="application/x-llamapun" id="S2.p11.5.m5.2d">italic_P ( italic_y | italic_x , italic_x start_POSTSUBSCRIPT italic_s end_POSTSUBSCRIPT )</annotation></semantics></math> and can also only be trained using unshifting data.</p>
</div>
<div class="ltx_para" id="S2.p12">
<p class="ltx_p" id="S2.p12.9">We assume</p>
<table class="ltx_equation ltx_eqn_table" id="S2.E6">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_left" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_left">(6)</span></td>
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="w_{R}=R(x)," class="ltx_Math" display="block" id="S2.E6.m1.2"><semantics id="S2.E6.m1.2a"><mrow id="S2.E6.m1.2.2.1" xref="S2.E6.m1.2.2.1.1.cmml"><mrow id="S2.E6.m1.2.2.1.1" xref="S2.E6.m1.2.2.1.1.cmml"><msub id="S2.E6.m1.2.2.1.1.2" xref="S2.E6.m1.2.2.1.1.2.cmml"><mi id="S2.E6.m1.2.2.1.1.2.2" xref="S2.E6.m1.2.2.1.1.2.2.cmml">w</mi><mi id="S2.E6.m1.2.2.1.1.2.3" xref="S2.E6.m1.2.2.1.1.2.3.cmml">R</mi></msub><mo id="S2.E6.m1.2.2.1.1.1" xref="S2.E6.m1.2.2.1.1.1.cmml">=</mo><mrow id="S2.E6.m1.2.2.1.1.3" xref="S2.E6.m1.2.2.1.1.3.cmml"><mi id="S2.E6.m1.2.2.1.1.3.2" xref="S2.E6.m1.2.2.1.1.3.2.cmml">R</mi><mo id="S2.E6.m1.2.2.1.1.3.1" xref="S2.E6.m1.2.2.1.1.3.1.cmml">⁢</mo><mrow id="S2.E6.m1.2.2.1.1.3.3.2" xref="S2.E6.m1.2.2.1.1.3.cmml"><mo id="S2.E6.m1.2.2.1.1.3.3.2.1" stretchy="false" xref="S2.E6.m1.2.2.1.1.3.cmml">(</mo><mi id="S2.E6.m1.1.1" xref="S2.E6.m1.1.1.cmml">x</mi><mo id="S2.E6.m1.2.2.1.1.3.3.2.2" stretchy="false" xref="S2.E6.m1.2.2.1.1.3.cmml">)</mo></mrow></mrow></mrow><mo id="S2.E6.m1.2.2.1.2" xref="S2.E6.m1.2.2.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S2.E6.m1.2b"><apply id="S2.E6.m1.2.2.1.1.cmml" xref="S2.E6.m1.2.2.1"><eq id="S2.E6.m1.2.2.1.1.1.cmml" xref="S2.E6.m1.2.2.1.1.1"></eq><apply id="S2.E6.m1.2.2.1.1.2.cmml" xref="S2.E6.m1.2.2.1.1.2"><csymbol cd="ambiguous" id="S2.E6.m1.2.2.1.1.2.1.cmml" xref="S2.E6.m1.2.2.1.1.2">subscript</csymbol><ci id="S2.E6.m1.2.2.1.1.2.2.cmml" xref="S2.E6.m1.2.2.1.1.2.2">𝑤</ci><ci id="S2.E6.m1.2.2.1.1.2.3.cmml" xref="S2.E6.m1.2.2.1.1.2.3">𝑅</ci></apply><apply id="S2.E6.m1.2.2.1.1.3.cmml" xref="S2.E6.m1.2.2.1.1.3"><times id="S2.E6.m1.2.2.1.1.3.1.cmml" xref="S2.E6.m1.2.2.1.1.3.1"></times><ci id="S2.E6.m1.2.2.1.1.3.2.cmml" xref="S2.E6.m1.2.2.1.1.3.2">𝑅</ci><ci id="S2.E6.m1.1.1.cmml" xref="S2.E6.m1.1.1">𝑥</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.E6.m1.2c">w_{R}=R(x),</annotation><annotation encoding="application/x-llamapun" id="S2.E6.m1.2d">italic_w start_POSTSUBSCRIPT italic_R end_POSTSUBSCRIPT = italic_R ( italic_x ) ,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S2.p12.2">where <math alttext="w_{R}" class="ltx_Math" display="inline" id="S2.p12.1.m1.1"><semantics id="S2.p12.1.m1.1a"><msub id="S2.p12.1.m1.1.1" xref="S2.p12.1.m1.1.1.cmml"><mi id="S2.p12.1.m1.1.1.2" xref="S2.p12.1.m1.1.1.2.cmml">w</mi><mi id="S2.p12.1.m1.1.1.3" xref="S2.p12.1.m1.1.1.3.cmml">R</mi></msub><annotation-xml encoding="MathML-Content" id="S2.p12.1.m1.1b"><apply id="S2.p12.1.m1.1.1.cmml" xref="S2.p12.1.m1.1.1"><csymbol cd="ambiguous" id="S2.p12.1.m1.1.1.1.cmml" xref="S2.p12.1.m1.1.1">subscript</csymbol><ci id="S2.p12.1.m1.1.1.2.cmml" xref="S2.p12.1.m1.1.1.2">𝑤</ci><ci id="S2.p12.1.m1.1.1.3.cmml" xref="S2.p12.1.m1.1.1.3">𝑅</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.p12.1.m1.1c">w_{R}</annotation><annotation encoding="application/x-llamapun" id="S2.p12.1.m1.1d">italic_w start_POSTSUBSCRIPT italic_R end_POSTSUBSCRIPT</annotation></semantics></math> is the last layer logits of <math alttext="R(x)" class="ltx_Math" display="inline" id="S2.p12.2.m2.1"><semantics id="S2.p12.2.m2.1a"><mrow id="S2.p12.2.m2.1.2" xref="S2.p12.2.m2.1.2.cmml"><mi id="S2.p12.2.m2.1.2.2" xref="S2.p12.2.m2.1.2.2.cmml">R</mi><mo id="S2.p12.2.m2.1.2.1" xref="S2.p12.2.m2.1.2.1.cmml">⁢</mo><mrow id="S2.p12.2.m2.1.2.3.2" xref="S2.p12.2.m2.1.2.cmml"><mo id="S2.p12.2.m2.1.2.3.2.1" stretchy="false" xref="S2.p12.2.m2.1.2.cmml">(</mo><mi id="S2.p12.2.m2.1.1" xref="S2.p12.2.m2.1.1.cmml">x</mi><mo id="S2.p12.2.m2.1.2.3.2.2" stretchy="false" xref="S2.p12.2.m2.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.p12.2.m2.1b"><apply id="S2.p12.2.m2.1.2.cmml" xref="S2.p12.2.m2.1.2"><times id="S2.p12.2.m2.1.2.1.cmml" xref="S2.p12.2.m2.1.2.1"></times><ci id="S2.p12.2.m2.1.2.2.cmml" xref="S2.p12.2.m2.1.2.2">𝑅</ci><ci id="S2.p12.2.m2.1.1.cmml" xref="S2.p12.2.m2.1.1">𝑥</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.p12.2.m2.1c">R(x)</annotation><annotation encoding="application/x-llamapun" id="S2.p12.2.m2.1d">italic_R ( italic_x )</annotation></semantics></math> and assume</p>
<table class="ltx_equation ltx_eqn_table" id="S2.E7">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_left" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_left">(7)</span></td>
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="w_{r}=r(x)," class="ltx_Math" display="block" id="S2.E7.m1.2"><semantics id="S2.E7.m1.2a"><mrow id="S2.E7.m1.2.2.1" xref="S2.E7.m1.2.2.1.1.cmml"><mrow id="S2.E7.m1.2.2.1.1" xref="S2.E7.m1.2.2.1.1.cmml"><msub id="S2.E7.m1.2.2.1.1.2" xref="S2.E7.m1.2.2.1.1.2.cmml"><mi id="S2.E7.m1.2.2.1.1.2.2" xref="S2.E7.m1.2.2.1.1.2.2.cmml">w</mi><mi id="S2.E7.m1.2.2.1.1.2.3" xref="S2.E7.m1.2.2.1.1.2.3.cmml">r</mi></msub><mo id="S2.E7.m1.2.2.1.1.1" xref="S2.E7.m1.2.2.1.1.1.cmml">=</mo><mrow id="S2.E7.m1.2.2.1.1.3" xref="S2.E7.m1.2.2.1.1.3.cmml"><mi id="S2.E7.m1.2.2.1.1.3.2" xref="S2.E7.m1.2.2.1.1.3.2.cmml">r</mi><mo id="S2.E7.m1.2.2.1.1.3.1" xref="S2.E7.m1.2.2.1.1.3.1.cmml">⁢</mo><mrow id="S2.E7.m1.2.2.1.1.3.3.2" xref="S2.E7.m1.2.2.1.1.3.cmml"><mo id="S2.E7.m1.2.2.1.1.3.3.2.1" stretchy="false" xref="S2.E7.m1.2.2.1.1.3.cmml">(</mo><mi id="S2.E7.m1.1.1" xref="S2.E7.m1.1.1.cmml">x</mi><mo id="S2.E7.m1.2.2.1.1.3.3.2.2" stretchy="false" xref="S2.E7.m1.2.2.1.1.3.cmml">)</mo></mrow></mrow></mrow><mo id="S2.E7.m1.2.2.1.2" xref="S2.E7.m1.2.2.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S2.E7.m1.2b"><apply id="S2.E7.m1.2.2.1.1.cmml" xref="S2.E7.m1.2.2.1"><eq id="S2.E7.m1.2.2.1.1.1.cmml" xref="S2.E7.m1.2.2.1.1.1"></eq><apply id="S2.E7.m1.2.2.1.1.2.cmml" xref="S2.E7.m1.2.2.1.1.2"><csymbol cd="ambiguous" id="S2.E7.m1.2.2.1.1.2.1.cmml" xref="S2.E7.m1.2.2.1.1.2">subscript</csymbol><ci id="S2.E7.m1.2.2.1.1.2.2.cmml" xref="S2.E7.m1.2.2.1.1.2.2">𝑤</ci><ci id="S2.E7.m1.2.2.1.1.2.3.cmml" xref="S2.E7.m1.2.2.1.1.2.3">𝑟</ci></apply><apply id="S2.E7.m1.2.2.1.1.3.cmml" xref="S2.E7.m1.2.2.1.1.3"><times id="S2.E7.m1.2.2.1.1.3.1.cmml" xref="S2.E7.m1.2.2.1.1.3.1"></times><ci id="S2.E7.m1.2.2.1.1.3.2.cmml" xref="S2.E7.m1.2.2.1.1.3.2">𝑟</ci><ci id="S2.E7.m1.1.1.cmml" xref="S2.E7.m1.1.1">𝑥</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.E7.m1.2c">w_{r}=r(x),</annotation><annotation encoding="application/x-llamapun" id="S2.E7.m1.2d">italic_w start_POSTSUBSCRIPT italic_r end_POSTSUBSCRIPT = italic_r ( italic_x ) ,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S2.p12.6">where <math alttext="w_{s}" class="ltx_Math" display="inline" id="S2.p12.3.m1.1"><semantics id="S2.p12.3.m1.1a"><msub id="S2.p12.3.m1.1.1" xref="S2.p12.3.m1.1.1.cmml"><mi id="S2.p12.3.m1.1.1.2" xref="S2.p12.3.m1.1.1.2.cmml">w</mi><mi id="S2.p12.3.m1.1.1.3" xref="S2.p12.3.m1.1.1.3.cmml">s</mi></msub><annotation-xml encoding="MathML-Content" id="S2.p12.3.m1.1b"><apply id="S2.p12.3.m1.1.1.cmml" xref="S2.p12.3.m1.1.1"><csymbol cd="ambiguous" id="S2.p12.3.m1.1.1.1.cmml" xref="S2.p12.3.m1.1.1">subscript</csymbol><ci id="S2.p12.3.m1.1.1.2.cmml" xref="S2.p12.3.m1.1.1.2">𝑤</ci><ci id="S2.p12.3.m1.1.1.3.cmml" xref="S2.p12.3.m1.1.1.3">𝑠</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.p12.3.m1.1c">w_{s}</annotation><annotation encoding="application/x-llamapun" id="S2.p12.3.m1.1d">italic_w start_POSTSUBSCRIPT italic_s end_POSTSUBSCRIPT</annotation></semantics></math> is the last layer logits of <math alttext="r(x)" class="ltx_Math" display="inline" id="S2.p12.4.m2.1"><semantics id="S2.p12.4.m2.1a"><mrow id="S2.p12.4.m2.1.2" xref="S2.p12.4.m2.1.2.cmml"><mi id="S2.p12.4.m2.1.2.2" xref="S2.p12.4.m2.1.2.2.cmml">r</mi><mo id="S2.p12.4.m2.1.2.1" xref="S2.p12.4.m2.1.2.1.cmml">⁢</mo><mrow id="S2.p12.4.m2.1.2.3.2" xref="S2.p12.4.m2.1.2.cmml"><mo id="S2.p12.4.m2.1.2.3.2.1" stretchy="false" xref="S2.p12.4.m2.1.2.cmml">(</mo><mi id="S2.p12.4.m2.1.1" xref="S2.p12.4.m2.1.1.cmml">x</mi><mo id="S2.p12.4.m2.1.2.3.2.2" stretchy="false" xref="S2.p12.4.m2.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.p12.4.m2.1b"><apply id="S2.p12.4.m2.1.2.cmml" xref="S2.p12.4.m2.1.2"><times id="S2.p12.4.m2.1.2.1.cmml" xref="S2.p12.4.m2.1.2.1"></times><ci id="S2.p12.4.m2.1.2.2.cmml" xref="S2.p12.4.m2.1.2.2">𝑟</ci><ci id="S2.p12.4.m2.1.1.cmml" xref="S2.p12.4.m2.1.1">𝑥</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.p12.4.m2.1c">r(x)</annotation><annotation encoding="application/x-llamapun" id="S2.p12.4.m2.1d">italic_r ( italic_x )</annotation></semantics></math>.
The loss function used to distill knowledge from <math alttext="R(x)" class="ltx_Math" display="inline" id="S2.p12.5.m3.1"><semantics id="S2.p12.5.m3.1a"><mrow id="S2.p12.5.m3.1.2" xref="S2.p12.5.m3.1.2.cmml"><mi id="S2.p12.5.m3.1.2.2" xref="S2.p12.5.m3.1.2.2.cmml">R</mi><mo id="S2.p12.5.m3.1.2.1" xref="S2.p12.5.m3.1.2.1.cmml">⁢</mo><mrow id="S2.p12.5.m3.1.2.3.2" xref="S2.p12.5.m3.1.2.cmml"><mo id="S2.p12.5.m3.1.2.3.2.1" stretchy="false" xref="S2.p12.5.m3.1.2.cmml">(</mo><mi id="S2.p12.5.m3.1.1" xref="S2.p12.5.m3.1.1.cmml">x</mi><mo id="S2.p12.5.m3.1.2.3.2.2" stretchy="false" xref="S2.p12.5.m3.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.p12.5.m3.1b"><apply id="S2.p12.5.m3.1.2.cmml" xref="S2.p12.5.m3.1.2"><times id="S2.p12.5.m3.1.2.1.cmml" xref="S2.p12.5.m3.1.2.1"></times><ci id="S2.p12.5.m3.1.2.2.cmml" xref="S2.p12.5.m3.1.2.2">𝑅</ci><ci id="S2.p12.5.m3.1.1.cmml" xref="S2.p12.5.m3.1.1">𝑥</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.p12.5.m3.1c">R(x)</annotation><annotation encoding="application/x-llamapun" id="S2.p12.5.m3.1d">italic_R ( italic_x )</annotation></semantics></math> to <math alttext="r(x)" class="ltx_Math" display="inline" id="S2.p12.6.m4.1"><semantics id="S2.p12.6.m4.1a"><mrow id="S2.p12.6.m4.1.2" xref="S2.p12.6.m4.1.2.cmml"><mi id="S2.p12.6.m4.1.2.2" xref="S2.p12.6.m4.1.2.2.cmml">r</mi><mo id="S2.p12.6.m4.1.2.1" xref="S2.p12.6.m4.1.2.1.cmml">⁢</mo><mrow id="S2.p12.6.m4.1.2.3.2" xref="S2.p12.6.m4.1.2.cmml"><mo id="S2.p12.6.m4.1.2.3.2.1" stretchy="false" xref="S2.p12.6.m4.1.2.cmml">(</mo><mi id="S2.p12.6.m4.1.1" xref="S2.p12.6.m4.1.1.cmml">x</mi><mo id="S2.p12.6.m4.1.2.3.2.2" stretchy="false" xref="S2.p12.6.m4.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S2.p12.6.m4.1b"><apply id="S2.p12.6.m4.1.2.cmml" xref="S2.p12.6.m4.1.2"><times id="S2.p12.6.m4.1.2.1.cmml" xref="S2.p12.6.m4.1.2.1"></times><ci id="S2.p12.6.m4.1.2.2.cmml" xref="S2.p12.6.m4.1.2.2">𝑟</ci><ci id="S2.p12.6.m4.1.1.cmml" xref="S2.p12.6.m4.1.1">𝑥</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.p12.6.m4.1c">r(x)</annotation><annotation encoding="application/x-llamapun" id="S2.p12.6.m4.1d">italic_r ( italic_x )</annotation></semantics></math> can be written as:</p>
<table class="ltx_equation ltx_eqn_table" id="S2.E8">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_left" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_left">(8)</span></td>
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\mathcal{L}_{\text{KD}}=\sum_{x_{z}\in\mathcal{D}_{\text{shifting}}}\text{MSE}%
(r(x),R(x))=\sum_{x_{z}\in\mathcal{D}_{\text{shifting}}}\text{MSE}(w_{r}^{z},w%
_{R}^{z})," class="ltx_Math" display="block" id="S2.E8.m1.3"><semantics id="S2.E8.m1.3a"><mrow id="S2.E8.m1.3.3.1" xref="S2.E8.m1.3.3.1.1.cmml"><mrow id="S2.E8.m1.3.3.1.1" xref="S2.E8.m1.3.3.1.1.cmml"><msub id="S2.E8.m1.3.3.1.1.6" xref="S2.E8.m1.3.3.1.1.6.cmml"><mi class="ltx_font_mathcaligraphic" id="S2.E8.m1.3.3.1.1.6.2" xref="S2.E8.m1.3.3.1.1.6.2.cmml">ℒ</mi><mtext id="S2.E8.m1.3.3.1.1.6.3" xref="S2.E8.m1.3.3.1.1.6.3a.cmml">KD</mtext></msub><mo id="S2.E8.m1.3.3.1.1.7" rspace="0.111em" xref="S2.E8.m1.3.3.1.1.7.cmml">=</mo><mrow id="S2.E8.m1.3.3.1.1.2" xref="S2.E8.m1.3.3.1.1.2.cmml"><munder id="S2.E8.m1.3.3.1.1.2.3" xref="S2.E8.m1.3.3.1.1.2.3.cmml"><mo id="S2.E8.m1.3.3.1.1.2.3.2" movablelimits="false" xref="S2.E8.m1.3.3.1.1.2.3.2.cmml">∑</mo><mrow id="S2.E8.m1.3.3.1.1.2.3.3" xref="S2.E8.m1.3.3.1.1.2.3.3.cmml"><msub id="S2.E8.m1.3.3.1.1.2.3.3.2" xref="S2.E8.m1.3.3.1.1.2.3.3.2.cmml"><mi id="S2.E8.m1.3.3.1.1.2.3.3.2.2" xref="S2.E8.m1.3.3.1.1.2.3.3.2.2.cmml">x</mi><mi id="S2.E8.m1.3.3.1.1.2.3.3.2.3" xref="S2.E8.m1.3.3.1.1.2.3.3.2.3.cmml">z</mi></msub><mo id="S2.E8.m1.3.3.1.1.2.3.3.1" xref="S2.E8.m1.3.3.1.1.2.3.3.1.cmml">∈</mo><msub id="S2.E8.m1.3.3.1.1.2.3.3.3" xref="S2.E8.m1.3.3.1.1.2.3.3.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S2.E8.m1.3.3.1.1.2.3.3.3.2" xref="S2.E8.m1.3.3.1.1.2.3.3.3.2.cmml">𝒟</mi><mtext id="S2.E8.m1.3.3.1.1.2.3.3.3.3" xref="S2.E8.m1.3.3.1.1.2.3.3.3.3a.cmml">shifting</mtext></msub></mrow></munder><mrow id="S2.E8.m1.3.3.1.1.2.2" xref="S2.E8.m1.3.3.1.1.2.2.cmml"><mtext id="S2.E8.m1.3.3.1.1.2.2.4" xref="S2.E8.m1.3.3.1.1.2.2.4a.cmml">MSE</mtext><mo id="S2.E8.m1.3.3.1.1.2.2.3" xref="S2.E8.m1.3.3.1.1.2.2.3.cmml">⁢</mo><mrow id="S2.E8.m1.3.3.1.1.2.2.2.2" xref="S2.E8.m1.3.3.1.1.2.2.2.3.cmml"><mo id="S2.E8.m1.3.3.1.1.2.2.2.2.3" stretchy="false" xref="S2.E8.m1.3.3.1.1.2.2.2.3.cmml">(</mo><mrow id="S2.E8.m1.3.3.1.1.1.1.1.1.1" xref="S2.E8.m1.3.3.1.1.1.1.1.1.1.cmml"><mi id="S2.E8.m1.3.3.1.1.1.1.1.1.1.2" xref="S2.E8.m1.3.3.1.1.1.1.1.1.1.2.cmml">r</mi><mo id="S2.E8.m1.3.3.1.1.1.1.1.1.1.1" xref="S2.E8.m1.3.3.1.1.1.1.1.1.1.1.cmml">⁢</mo><mrow id="S2.E8.m1.3.3.1.1.1.1.1.1.1.3.2" xref="S2.E8.m1.3.3.1.1.1.1.1.1.1.cmml"><mo id="S2.E8.m1.3.3.1.1.1.1.1.1.1.3.2.1" stretchy="false" xref="S2.E8.m1.3.3.1.1.1.1.1.1.1.cmml">(</mo><mi id="S2.E8.m1.1.1" xref="S2.E8.m1.1.1.cmml">x</mi><mo id="S2.E8.m1.3.3.1.1.1.1.1.1.1.3.2.2" stretchy="false" xref="S2.E8.m1.3.3.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S2.E8.m1.3.3.1.1.2.2.2.2.4" xref="S2.E8.m1.3.3.1.1.2.2.2.3.cmml">,</mo><mrow id="S2.E8.m1.3.3.1.1.2.2.2.2.2" xref="S2.E8.m1.3.3.1.1.2.2.2.2.2.cmml"><mi id="S2.E8.m1.3.3.1.1.2.2.2.2.2.2" xref="S2.E8.m1.3.3.1.1.2.2.2.2.2.2.cmml">R</mi><mo id="S2.E8.m1.3.3.1.1.2.2.2.2.2.1" xref="S2.E8.m1.3.3.1.1.2.2.2.2.2.1.cmml">⁢</mo><mrow id="S2.E8.m1.3.3.1.1.2.2.2.2.2.3.2" xref="S2.E8.m1.3.3.1.1.2.2.2.2.2.cmml"><mo id="S2.E8.m1.3.3.1.1.2.2.2.2.2.3.2.1" stretchy="false" xref="S2.E8.m1.3.3.1.1.2.2.2.2.2.cmml">(</mo><mi id="S2.E8.m1.2.2" xref="S2.E8.m1.2.2.cmml">x</mi><mo id="S2.E8.m1.3.3.1.1.2.2.2.2.2.3.2.2" stretchy="false" xref="S2.E8.m1.3.3.1.1.2.2.2.2.2.cmml">)</mo></mrow></mrow><mo id="S2.E8.m1.3.3.1.1.2.2.2.2.5" stretchy="false" xref="S2.E8.m1.3.3.1.1.2.2.2.3.cmml">)</mo></mrow></mrow></mrow><mo id="S2.E8.m1.3.3.1.1.8" rspace="0.111em" xref="S2.E8.m1.3.3.1.1.8.cmml">=</mo><mrow id="S2.E8.m1.3.3.1.1.4" xref="S2.E8.m1.3.3.1.1.4.cmml"><munder id="S2.E8.m1.3.3.1.1.4.3" xref="S2.E8.m1.3.3.1.1.4.3.cmml"><mo id="S2.E8.m1.3.3.1.1.4.3.2" movablelimits="false" xref="S2.E8.m1.3.3.1.1.4.3.2.cmml">∑</mo><mrow id="S2.E8.m1.3.3.1.1.4.3.3" xref="S2.E8.m1.3.3.1.1.4.3.3.cmml"><msub id="S2.E8.m1.3.3.1.1.4.3.3.2" xref="S2.E8.m1.3.3.1.1.4.3.3.2.cmml"><mi id="S2.E8.m1.3.3.1.1.4.3.3.2.2" xref="S2.E8.m1.3.3.1.1.4.3.3.2.2.cmml">x</mi><mi id="S2.E8.m1.3.3.1.1.4.3.3.2.3" xref="S2.E8.m1.3.3.1.1.4.3.3.2.3.cmml">z</mi></msub><mo id="S2.E8.m1.3.3.1.1.4.3.3.1" xref="S2.E8.m1.3.3.1.1.4.3.3.1.cmml">∈</mo><msub id="S2.E8.m1.3.3.1.1.4.3.3.3" xref="S2.E8.m1.3.3.1.1.4.3.3.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S2.E8.m1.3.3.1.1.4.3.3.3.2" xref="S2.E8.m1.3.3.1.1.4.3.3.3.2.cmml">𝒟</mi><mtext id="S2.E8.m1.3.3.1.1.4.3.3.3.3" xref="S2.E8.m1.3.3.1.1.4.3.3.3.3a.cmml">shifting</mtext></msub></mrow></munder><mrow id="S2.E8.m1.3.3.1.1.4.2" xref="S2.E8.m1.3.3.1.1.4.2.cmml"><mtext id="S2.E8.m1.3.3.1.1.4.2.4" xref="S2.E8.m1.3.3.1.1.4.2.4a.cmml">MSE</mtext><mo id="S2.E8.m1.3.3.1.1.4.2.3" xref="S2.E8.m1.3.3.1.1.4.2.3.cmml">⁢</mo><mrow id="S2.E8.m1.3.3.1.1.4.2.2.2" xref="S2.E8.m1.3.3.1.1.4.2.2.3.cmml"><mo id="S2.E8.m1.3.3.1.1.4.2.2.2.3" stretchy="false" xref="S2.E8.m1.3.3.1.1.4.2.2.3.cmml">(</mo><msubsup id="S2.E8.m1.3.3.1.1.3.1.1.1.1" xref="S2.E8.m1.3.3.1.1.3.1.1.1.1.cmml"><mi id="S2.E8.m1.3.3.1.1.3.1.1.1.1.2.2" xref="S2.E8.m1.3.3.1.1.3.1.1.1.1.2.2.cmml">w</mi><mi id="S2.E8.m1.3.3.1.1.3.1.1.1.1.2.3" xref="S2.E8.m1.3.3.1.1.3.1.1.1.1.2.3.cmml">r</mi><mi id="S2.E8.m1.3.3.1.1.3.1.1.1.1.3" xref="S2.E8.m1.3.3.1.1.3.1.1.1.1.3.cmml">z</mi></msubsup><mo id="S2.E8.m1.3.3.1.1.4.2.2.2.4" xref="S2.E8.m1.3.3.1.1.4.2.2.3.cmml">,</mo><msubsup id="S2.E8.m1.3.3.1.1.4.2.2.2.2" xref="S2.E8.m1.3.3.1.1.4.2.2.2.2.cmml"><mi id="S2.E8.m1.3.3.1.1.4.2.2.2.2.2.2" xref="S2.E8.m1.3.3.1.1.4.2.2.2.2.2.2.cmml">w</mi><mi id="S2.E8.m1.3.3.1.1.4.2.2.2.2.2.3" xref="S2.E8.m1.3.3.1.1.4.2.2.2.2.2.3.cmml">R</mi><mi id="S2.E8.m1.3.3.1.1.4.2.2.2.2.3" xref="S2.E8.m1.3.3.1.1.4.2.2.2.2.3.cmml">z</mi></msubsup><mo id="S2.E8.m1.3.3.1.1.4.2.2.2.5" stretchy="false" xref="S2.E8.m1.3.3.1.1.4.2.2.3.cmml">)</mo></mrow></mrow></mrow></mrow><mo id="S2.E8.m1.3.3.1.2" xref="S2.E8.m1.3.3.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S2.E8.m1.3b"><apply id="S2.E8.m1.3.3.1.1.cmml" xref="S2.E8.m1.3.3.1"><and id="S2.E8.m1.3.3.1.1a.cmml" xref="S2.E8.m1.3.3.1"></and><apply id="S2.E8.m1.3.3.1.1b.cmml" xref="S2.E8.m1.3.3.1"><eq id="S2.E8.m1.3.3.1.1.7.cmml" xref="S2.E8.m1.3.3.1.1.7"></eq><apply id="S2.E8.m1.3.3.1.1.6.cmml" xref="S2.E8.m1.3.3.1.1.6"><csymbol cd="ambiguous" id="S2.E8.m1.3.3.1.1.6.1.cmml" xref="S2.E8.m1.3.3.1.1.6">subscript</csymbol><ci id="S2.E8.m1.3.3.1.1.6.2.cmml" xref="S2.E8.m1.3.3.1.1.6.2">ℒ</ci><ci id="S2.E8.m1.3.3.1.1.6.3a.cmml" xref="S2.E8.m1.3.3.1.1.6.3"><mtext id="S2.E8.m1.3.3.1.1.6.3.cmml" mathsize="70%" xref="S2.E8.m1.3.3.1.1.6.3">KD</mtext></ci></apply><apply id="S2.E8.m1.3.3.1.1.2.cmml" xref="S2.E8.m1.3.3.1.1.2"><apply id="S2.E8.m1.3.3.1.1.2.3.cmml" xref="S2.E8.m1.3.3.1.1.2.3"><csymbol cd="ambiguous" id="S2.E8.m1.3.3.1.1.2.3.1.cmml" xref="S2.E8.m1.3.3.1.1.2.3">subscript</csymbol><sum id="S2.E8.m1.3.3.1.1.2.3.2.cmml" xref="S2.E8.m1.3.3.1.1.2.3.2"></sum><apply id="S2.E8.m1.3.3.1.1.2.3.3.cmml" xref="S2.E8.m1.3.3.1.1.2.3.3"><in id="S2.E8.m1.3.3.1.1.2.3.3.1.cmml" xref="S2.E8.m1.3.3.1.1.2.3.3.1"></in><apply id="S2.E8.m1.3.3.1.1.2.3.3.2.cmml" xref="S2.E8.m1.3.3.1.1.2.3.3.2"><csymbol cd="ambiguous" id="S2.E8.m1.3.3.1.1.2.3.3.2.1.cmml" xref="S2.E8.m1.3.3.1.1.2.3.3.2">subscript</csymbol><ci id="S2.E8.m1.3.3.1.1.2.3.3.2.2.cmml" xref="S2.E8.m1.3.3.1.1.2.3.3.2.2">𝑥</ci><ci id="S2.E8.m1.3.3.1.1.2.3.3.2.3.cmml" xref="S2.E8.m1.3.3.1.1.2.3.3.2.3">𝑧</ci></apply><apply id="S2.E8.m1.3.3.1.1.2.3.3.3.cmml" xref="S2.E8.m1.3.3.1.1.2.3.3.3"><csymbol cd="ambiguous" id="S2.E8.m1.3.3.1.1.2.3.3.3.1.cmml" xref="S2.E8.m1.3.3.1.1.2.3.3.3">subscript</csymbol><ci id="S2.E8.m1.3.3.1.1.2.3.3.3.2.cmml" xref="S2.E8.m1.3.3.1.1.2.3.3.3.2">𝒟</ci><ci id="S2.E8.m1.3.3.1.1.2.3.3.3.3a.cmml" xref="S2.E8.m1.3.3.1.1.2.3.3.3.3"><mtext id="S2.E8.m1.3.3.1.1.2.3.3.3.3.cmml" mathsize="50%" xref="S2.E8.m1.3.3.1.1.2.3.3.3.3">shifting</mtext></ci></apply></apply></apply><apply id="S2.E8.m1.3.3.1.1.2.2.cmml" xref="S2.E8.m1.3.3.1.1.2.2"><times id="S2.E8.m1.3.3.1.1.2.2.3.cmml" xref="S2.E8.m1.3.3.1.1.2.2.3"></times><ci id="S2.E8.m1.3.3.1.1.2.2.4a.cmml" xref="S2.E8.m1.3.3.1.1.2.2.4"><mtext id="S2.E8.m1.3.3.1.1.2.2.4.cmml" xref="S2.E8.m1.3.3.1.1.2.2.4">MSE</mtext></ci><interval closure="open" id="S2.E8.m1.3.3.1.1.2.2.2.3.cmml" xref="S2.E8.m1.3.3.1.1.2.2.2.2"><apply id="S2.E8.m1.3.3.1.1.1.1.1.1.1.cmml" xref="S2.E8.m1.3.3.1.1.1.1.1.1.1"><times id="S2.E8.m1.3.3.1.1.1.1.1.1.1.1.cmml" xref="S2.E8.m1.3.3.1.1.1.1.1.1.1.1"></times><ci id="S2.E8.m1.3.3.1.1.1.1.1.1.1.2.cmml" xref="S2.E8.m1.3.3.1.1.1.1.1.1.1.2">𝑟</ci><ci id="S2.E8.m1.1.1.cmml" xref="S2.E8.m1.1.1">𝑥</ci></apply><apply id="S2.E8.m1.3.3.1.1.2.2.2.2.2.cmml" xref="S2.E8.m1.3.3.1.1.2.2.2.2.2"><times id="S2.E8.m1.3.3.1.1.2.2.2.2.2.1.cmml" xref="S2.E8.m1.3.3.1.1.2.2.2.2.2.1"></times><ci id="S2.E8.m1.3.3.1.1.2.2.2.2.2.2.cmml" xref="S2.E8.m1.3.3.1.1.2.2.2.2.2.2">𝑅</ci><ci id="S2.E8.m1.2.2.cmml" xref="S2.E8.m1.2.2">𝑥</ci></apply></interval></apply></apply></apply><apply id="S2.E8.m1.3.3.1.1c.cmml" xref="S2.E8.m1.3.3.1"><eq id="S2.E8.m1.3.3.1.1.8.cmml" xref="S2.E8.m1.3.3.1.1.8"></eq><share href="https://arxiv.org/html/2404.15678v4#S2.E8.m1.3.3.1.1.2.cmml" id="S2.E8.m1.3.3.1.1d.cmml" xref="S2.E8.m1.3.3.1"></share><apply id="S2.E8.m1.3.3.1.1.4.cmml" xref="S2.E8.m1.3.3.1.1.4"><apply id="S2.E8.m1.3.3.1.1.4.3.cmml" xref="S2.E8.m1.3.3.1.1.4.3"><csymbol cd="ambiguous" id="S2.E8.m1.3.3.1.1.4.3.1.cmml" xref="S2.E8.m1.3.3.1.1.4.3">subscript</csymbol><sum id="S2.E8.m1.3.3.1.1.4.3.2.cmml" xref="S2.E8.m1.3.3.1.1.4.3.2"></sum><apply id="S2.E8.m1.3.3.1.1.4.3.3.cmml" xref="S2.E8.m1.3.3.1.1.4.3.3"><in id="S2.E8.m1.3.3.1.1.4.3.3.1.cmml" xref="S2.E8.m1.3.3.1.1.4.3.3.1"></in><apply id="S2.E8.m1.3.3.1.1.4.3.3.2.cmml" xref="S2.E8.m1.3.3.1.1.4.3.3.2"><csymbol cd="ambiguous" id="S2.E8.m1.3.3.1.1.4.3.3.2.1.cmml" xref="S2.E8.m1.3.3.1.1.4.3.3.2">subscript</csymbol><ci id="S2.E8.m1.3.3.1.1.4.3.3.2.2.cmml" xref="S2.E8.m1.3.3.1.1.4.3.3.2.2">𝑥</ci><ci id="S2.E8.m1.3.3.1.1.4.3.3.2.3.cmml" xref="S2.E8.m1.3.3.1.1.4.3.3.2.3">𝑧</ci></apply><apply id="S2.E8.m1.3.3.1.1.4.3.3.3.cmml" xref="S2.E8.m1.3.3.1.1.4.3.3.3"><csymbol cd="ambiguous" id="S2.E8.m1.3.3.1.1.4.3.3.3.1.cmml" xref="S2.E8.m1.3.3.1.1.4.3.3.3">subscript</csymbol><ci id="S2.E8.m1.3.3.1.1.4.3.3.3.2.cmml" xref="S2.E8.m1.3.3.1.1.4.3.3.3.2">𝒟</ci><ci id="S2.E8.m1.3.3.1.1.4.3.3.3.3a.cmml" xref="S2.E8.m1.3.3.1.1.4.3.3.3.3"><mtext id="S2.E8.m1.3.3.1.1.4.3.3.3.3.cmml" mathsize="50%" xref="S2.E8.m1.3.3.1.1.4.3.3.3.3">shifting</mtext></ci></apply></apply></apply><apply id="S2.E8.m1.3.3.1.1.4.2.cmml" xref="S2.E8.m1.3.3.1.1.4.2"><times id="S2.E8.m1.3.3.1.1.4.2.3.cmml" xref="S2.E8.m1.3.3.1.1.4.2.3"></times><ci id="S2.E8.m1.3.3.1.1.4.2.4a.cmml" xref="S2.E8.m1.3.3.1.1.4.2.4"><mtext id="S2.E8.m1.3.3.1.1.4.2.4.cmml" xref="S2.E8.m1.3.3.1.1.4.2.4">MSE</mtext></ci><interval closure="open" id="S2.E8.m1.3.3.1.1.4.2.2.3.cmml" xref="S2.E8.m1.3.3.1.1.4.2.2.2"><apply id="S2.E8.m1.3.3.1.1.3.1.1.1.1.cmml" xref="S2.E8.m1.3.3.1.1.3.1.1.1.1"><csymbol cd="ambiguous" id="S2.E8.m1.3.3.1.1.3.1.1.1.1.1.cmml" xref="S2.E8.m1.3.3.1.1.3.1.1.1.1">superscript</csymbol><apply id="S2.E8.m1.3.3.1.1.3.1.1.1.1.2.cmml" xref="S2.E8.m1.3.3.1.1.3.1.1.1.1"><csymbol cd="ambiguous" id="S2.E8.m1.3.3.1.1.3.1.1.1.1.2.1.cmml" xref="S2.E8.m1.3.3.1.1.3.1.1.1.1">subscript</csymbol><ci id="S2.E8.m1.3.3.1.1.3.1.1.1.1.2.2.cmml" xref="S2.E8.m1.3.3.1.1.3.1.1.1.1.2.2">𝑤</ci><ci id="S2.E8.m1.3.3.1.1.3.1.1.1.1.2.3.cmml" xref="S2.E8.m1.3.3.1.1.3.1.1.1.1.2.3">𝑟</ci></apply><ci id="S2.E8.m1.3.3.1.1.3.1.1.1.1.3.cmml" xref="S2.E8.m1.3.3.1.1.3.1.1.1.1.3">𝑧</ci></apply><apply id="S2.E8.m1.3.3.1.1.4.2.2.2.2.cmml" xref="S2.E8.m1.3.3.1.1.4.2.2.2.2"><csymbol cd="ambiguous" id="S2.E8.m1.3.3.1.1.4.2.2.2.2.1.cmml" xref="S2.E8.m1.3.3.1.1.4.2.2.2.2">superscript</csymbol><apply id="S2.E8.m1.3.3.1.1.4.2.2.2.2.2.cmml" xref="S2.E8.m1.3.3.1.1.4.2.2.2.2"><csymbol cd="ambiguous" id="S2.E8.m1.3.3.1.1.4.2.2.2.2.2.1.cmml" xref="S2.E8.m1.3.3.1.1.4.2.2.2.2">subscript</csymbol><ci id="S2.E8.m1.3.3.1.1.4.2.2.2.2.2.2.cmml" xref="S2.E8.m1.3.3.1.1.4.2.2.2.2.2.2">𝑤</ci><ci id="S2.E8.m1.3.3.1.1.4.2.2.2.2.2.3.cmml" xref="S2.E8.m1.3.3.1.1.4.2.2.2.2.2.3">𝑅</ci></apply><ci id="S2.E8.m1.3.3.1.1.4.2.2.2.2.3.cmml" xref="S2.E8.m1.3.3.1.1.4.2.2.2.2.3">𝑧</ci></apply></interval></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.E8.m1.3c">\mathcal{L}_{\text{KD}}=\sum_{x_{z}\in\mathcal{D}_{\text{shifting}}}\text{MSE}%
(r(x),R(x))=\sum_{x_{z}\in\mathcal{D}_{\text{shifting}}}\text{MSE}(w_{r}^{z},w%
_{R}^{z}),</annotation><annotation encoding="application/x-llamapun" id="S2.E8.m1.3d">caligraphic_L start_POSTSUBSCRIPT KD end_POSTSUBSCRIPT = ∑ start_POSTSUBSCRIPT italic_x start_POSTSUBSCRIPT italic_z end_POSTSUBSCRIPT ∈ caligraphic_D start_POSTSUBSCRIPT shifting end_POSTSUBSCRIPT end_POSTSUBSCRIPT MSE ( italic_r ( italic_x ) , italic_R ( italic_x ) ) = ∑ start_POSTSUBSCRIPT italic_x start_POSTSUBSCRIPT italic_z end_POSTSUBSCRIPT ∈ caligraphic_D start_POSTSUBSCRIPT shifting end_POSTSUBSCRIPT end_POSTSUBSCRIPT MSE ( italic_w start_POSTSUBSCRIPT italic_r end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_z end_POSTSUPERSCRIPT , italic_w start_POSTSUBSCRIPT italic_R end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_z end_POSTSUPERSCRIPT ) ,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S2.p12.7">where <math alttext="MSE" class="ltx_Math" display="inline" id="S2.p12.7.m1.1"><semantics id="S2.p12.7.m1.1a"><mrow id="S2.p12.7.m1.1.1" xref="S2.p12.7.m1.1.1.cmml"><mi id="S2.p12.7.m1.1.1.2" xref="S2.p12.7.m1.1.1.2.cmml">M</mi><mo id="S2.p12.7.m1.1.1.1" xref="S2.p12.7.m1.1.1.1.cmml">⁢</mo><mi id="S2.p12.7.m1.1.1.3" xref="S2.p12.7.m1.1.1.3.cmml">S</mi><mo id="S2.p12.7.m1.1.1.1a" xref="S2.p12.7.m1.1.1.1.cmml">⁢</mo><mi id="S2.p12.7.m1.1.1.4" xref="S2.p12.7.m1.1.1.4.cmml">E</mi></mrow><annotation-xml encoding="MathML-Content" id="S2.p12.7.m1.1b"><apply id="S2.p12.7.m1.1.1.cmml" xref="S2.p12.7.m1.1.1"><times id="S2.p12.7.m1.1.1.1.cmml" xref="S2.p12.7.m1.1.1.1"></times><ci id="S2.p12.7.m1.1.1.2.cmml" xref="S2.p12.7.m1.1.1.2">𝑀</ci><ci id="S2.p12.7.m1.1.1.3.cmml" xref="S2.p12.7.m1.1.1.3">𝑆</ci><ci id="S2.p12.7.m1.1.1.4.cmml" xref="S2.p12.7.m1.1.1.4">𝐸</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.p12.7.m1.1c">MSE</annotation><annotation encoding="application/x-llamapun" id="S2.p12.7.m1.1d">italic_M italic_S italic_E</annotation></semantics></math> is the Mean Squared Error loss function.
Once we obtain the search-distill module, we can use unshifting data to derive a final Distill Framework using the following loss function:
</p>
<table class="ltx_equation ltx_eqn_table" id="S2.E9">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_left" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_left">(9)</span></td>
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\mathcal{L}_{\text{distill}}=\sum_{x_{z}\in\mathcal{D}_{\text{train}}}\text{CE%
}(y^{z},\hat{y}_{D}^{z})," class="ltx_Math" display="block" id="S2.E9.m1.1"><semantics id="S2.E9.m1.1a"><mrow id="S2.E9.m1.1.1.1" xref="S2.E9.m1.1.1.1.1.cmml"><mrow id="S2.E9.m1.1.1.1.1" xref="S2.E9.m1.1.1.1.1.cmml"><msub id="S2.E9.m1.1.1.1.1.4" xref="S2.E9.m1.1.1.1.1.4.cmml"><mi class="ltx_font_mathcaligraphic" id="S2.E9.m1.1.1.1.1.4.2" xref="S2.E9.m1.1.1.1.1.4.2.cmml">ℒ</mi><mtext id="S2.E9.m1.1.1.1.1.4.3" xref="S2.E9.m1.1.1.1.1.4.3a.cmml">distill</mtext></msub><mo id="S2.E9.m1.1.1.1.1.3" rspace="0.111em" xref="S2.E9.m1.1.1.1.1.3.cmml">=</mo><mrow id="S2.E9.m1.1.1.1.1.2" xref="S2.E9.m1.1.1.1.1.2.cmml"><munder id="S2.E9.m1.1.1.1.1.2.3" xref="S2.E9.m1.1.1.1.1.2.3.cmml"><mo id="S2.E9.m1.1.1.1.1.2.3.2" movablelimits="false" xref="S2.E9.m1.1.1.1.1.2.3.2.cmml">∑</mo><mrow id="S2.E9.m1.1.1.1.1.2.3.3" xref="S2.E9.m1.1.1.1.1.2.3.3.cmml"><msub id="S2.E9.m1.1.1.1.1.2.3.3.2" xref="S2.E9.m1.1.1.1.1.2.3.3.2.cmml"><mi id="S2.E9.m1.1.1.1.1.2.3.3.2.2" xref="S2.E9.m1.1.1.1.1.2.3.3.2.2.cmml">x</mi><mi id="S2.E9.m1.1.1.1.1.2.3.3.2.3" xref="S2.E9.m1.1.1.1.1.2.3.3.2.3.cmml">z</mi></msub><mo id="S2.E9.m1.1.1.1.1.2.3.3.1" xref="S2.E9.m1.1.1.1.1.2.3.3.1.cmml">∈</mo><msub id="S2.E9.m1.1.1.1.1.2.3.3.3" xref="S2.E9.m1.1.1.1.1.2.3.3.3.cmml"><mi class="ltx_font_mathcaligraphic" id="S2.E9.m1.1.1.1.1.2.3.3.3.2" xref="S2.E9.m1.1.1.1.1.2.3.3.3.2.cmml">𝒟</mi><mtext id="S2.E9.m1.1.1.1.1.2.3.3.3.3" xref="S2.E9.m1.1.1.1.1.2.3.3.3.3a.cmml">train</mtext></msub></mrow></munder><mrow id="S2.E9.m1.1.1.1.1.2.2" xref="S2.E9.m1.1.1.1.1.2.2.cmml"><mtext id="S2.E9.m1.1.1.1.1.2.2.4" xref="S2.E9.m1.1.1.1.1.2.2.4a.cmml">CE</mtext><mo id="S2.E9.m1.1.1.1.1.2.2.3" xref="S2.E9.m1.1.1.1.1.2.2.3.cmml">⁢</mo><mrow id="S2.E9.m1.1.1.1.1.2.2.2.2" xref="S2.E9.m1.1.1.1.1.2.2.2.3.cmml"><mo id="S2.E9.m1.1.1.1.1.2.2.2.2.3" stretchy="false" xref="S2.E9.m1.1.1.1.1.2.2.2.3.cmml">(</mo><msup id="S2.E9.m1.1.1.1.1.1.1.1.1.1" xref="S2.E9.m1.1.1.1.1.1.1.1.1.1.cmml"><mi id="S2.E9.m1.1.1.1.1.1.1.1.1.1.2" xref="S2.E9.m1.1.1.1.1.1.1.1.1.1.2.cmml">y</mi><mi id="S2.E9.m1.1.1.1.1.1.1.1.1.1.3" xref="S2.E9.m1.1.1.1.1.1.1.1.1.1.3.cmml">z</mi></msup><mo id="S2.E9.m1.1.1.1.1.2.2.2.2.4" xref="S2.E9.m1.1.1.1.1.2.2.2.3.cmml">,</mo><msubsup id="S2.E9.m1.1.1.1.1.2.2.2.2.2" xref="S2.E9.m1.1.1.1.1.2.2.2.2.2.cmml"><mover accent="true" id="S2.E9.m1.1.1.1.1.2.2.2.2.2.2.2" xref="S2.E9.m1.1.1.1.1.2.2.2.2.2.2.2.cmml"><mi id="S2.E9.m1.1.1.1.1.2.2.2.2.2.2.2.2" xref="S2.E9.m1.1.1.1.1.2.2.2.2.2.2.2.2.cmml">y</mi><mo id="S2.E9.m1.1.1.1.1.2.2.2.2.2.2.2.1" xref="S2.E9.m1.1.1.1.1.2.2.2.2.2.2.2.1.cmml">^</mo></mover><mi id="S2.E9.m1.1.1.1.1.2.2.2.2.2.2.3" xref="S2.E9.m1.1.1.1.1.2.2.2.2.2.2.3.cmml">D</mi><mi id="S2.E9.m1.1.1.1.1.2.2.2.2.2.3" xref="S2.E9.m1.1.1.1.1.2.2.2.2.2.3.cmml">z</mi></msubsup><mo id="S2.E9.m1.1.1.1.1.2.2.2.2.5" stretchy="false" xref="S2.E9.m1.1.1.1.1.2.2.2.3.cmml">)</mo></mrow></mrow></mrow></mrow><mo id="S2.E9.m1.1.1.1.2" xref="S2.E9.m1.1.1.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S2.E9.m1.1b"><apply id="S2.E9.m1.1.1.1.1.cmml" xref="S2.E9.m1.1.1.1"><eq id="S2.E9.m1.1.1.1.1.3.cmml" xref="S2.E9.m1.1.1.1.1.3"></eq><apply id="S2.E9.m1.1.1.1.1.4.cmml" xref="S2.E9.m1.1.1.1.1.4"><csymbol cd="ambiguous" id="S2.E9.m1.1.1.1.1.4.1.cmml" xref="S2.E9.m1.1.1.1.1.4">subscript</csymbol><ci id="S2.E9.m1.1.1.1.1.4.2.cmml" xref="S2.E9.m1.1.1.1.1.4.2">ℒ</ci><ci id="S2.E9.m1.1.1.1.1.4.3a.cmml" xref="S2.E9.m1.1.1.1.1.4.3"><mtext id="S2.E9.m1.1.1.1.1.4.3.cmml" mathsize="70%" xref="S2.E9.m1.1.1.1.1.4.3">distill</mtext></ci></apply><apply id="S2.E9.m1.1.1.1.1.2.cmml" xref="S2.E9.m1.1.1.1.1.2"><apply id="S2.E9.m1.1.1.1.1.2.3.cmml" xref="S2.E9.m1.1.1.1.1.2.3"><csymbol cd="ambiguous" id="S2.E9.m1.1.1.1.1.2.3.1.cmml" xref="S2.E9.m1.1.1.1.1.2.3">subscript</csymbol><sum id="S2.E9.m1.1.1.1.1.2.3.2.cmml" xref="S2.E9.m1.1.1.1.1.2.3.2"></sum><apply id="S2.E9.m1.1.1.1.1.2.3.3.cmml" xref="S2.E9.m1.1.1.1.1.2.3.3"><in id="S2.E9.m1.1.1.1.1.2.3.3.1.cmml" xref="S2.E9.m1.1.1.1.1.2.3.3.1"></in><apply id="S2.E9.m1.1.1.1.1.2.3.3.2.cmml" xref="S2.E9.m1.1.1.1.1.2.3.3.2"><csymbol cd="ambiguous" id="S2.E9.m1.1.1.1.1.2.3.3.2.1.cmml" xref="S2.E9.m1.1.1.1.1.2.3.3.2">subscript</csymbol><ci id="S2.E9.m1.1.1.1.1.2.3.3.2.2.cmml" xref="S2.E9.m1.1.1.1.1.2.3.3.2.2">𝑥</ci><ci id="S2.E9.m1.1.1.1.1.2.3.3.2.3.cmml" xref="S2.E9.m1.1.1.1.1.2.3.3.2.3">𝑧</ci></apply><apply id="S2.E9.m1.1.1.1.1.2.3.3.3.cmml" xref="S2.E9.m1.1.1.1.1.2.3.3.3"><csymbol cd="ambiguous" id="S2.E9.m1.1.1.1.1.2.3.3.3.1.cmml" xref="S2.E9.m1.1.1.1.1.2.3.3.3">subscript</csymbol><ci id="S2.E9.m1.1.1.1.1.2.3.3.3.2.cmml" xref="S2.E9.m1.1.1.1.1.2.3.3.3.2">𝒟</ci><ci id="S2.E9.m1.1.1.1.1.2.3.3.3.3a.cmml" xref="S2.E9.m1.1.1.1.1.2.3.3.3.3"><mtext id="S2.E9.m1.1.1.1.1.2.3.3.3.3.cmml" mathsize="50%" xref="S2.E9.m1.1.1.1.1.2.3.3.3.3">train</mtext></ci></apply></apply></apply><apply id="S2.E9.m1.1.1.1.1.2.2.cmml" xref="S2.E9.m1.1.1.1.1.2.2"><times id="S2.E9.m1.1.1.1.1.2.2.3.cmml" xref="S2.E9.m1.1.1.1.1.2.2.3"></times><ci id="S2.E9.m1.1.1.1.1.2.2.4a.cmml" xref="S2.E9.m1.1.1.1.1.2.2.4"><mtext id="S2.E9.m1.1.1.1.1.2.2.4.cmml" xref="S2.E9.m1.1.1.1.1.2.2.4">CE</mtext></ci><interval closure="open" id="S2.E9.m1.1.1.1.1.2.2.2.3.cmml" xref="S2.E9.m1.1.1.1.1.2.2.2.2"><apply id="S2.E9.m1.1.1.1.1.1.1.1.1.1.cmml" xref="S2.E9.m1.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S2.E9.m1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S2.E9.m1.1.1.1.1.1.1.1.1.1">superscript</csymbol><ci id="S2.E9.m1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S2.E9.m1.1.1.1.1.1.1.1.1.1.2">𝑦</ci><ci id="S2.E9.m1.1.1.1.1.1.1.1.1.1.3.cmml" xref="S2.E9.m1.1.1.1.1.1.1.1.1.1.3">𝑧</ci></apply><apply id="S2.E9.m1.1.1.1.1.2.2.2.2.2.cmml" xref="S2.E9.m1.1.1.1.1.2.2.2.2.2"><csymbol cd="ambiguous" id="S2.E9.m1.1.1.1.1.2.2.2.2.2.1.cmml" xref="S2.E9.m1.1.1.1.1.2.2.2.2.2">superscript</csymbol><apply id="S2.E9.m1.1.1.1.1.2.2.2.2.2.2.cmml" xref="S2.E9.m1.1.1.1.1.2.2.2.2.2"><csymbol cd="ambiguous" id="S2.E9.m1.1.1.1.1.2.2.2.2.2.2.1.cmml" xref="S2.E9.m1.1.1.1.1.2.2.2.2.2">subscript</csymbol><apply id="S2.E9.m1.1.1.1.1.2.2.2.2.2.2.2.cmml" xref="S2.E9.m1.1.1.1.1.2.2.2.2.2.2.2"><ci id="S2.E9.m1.1.1.1.1.2.2.2.2.2.2.2.1.cmml" xref="S2.E9.m1.1.1.1.1.2.2.2.2.2.2.2.1">^</ci><ci id="S2.E9.m1.1.1.1.1.2.2.2.2.2.2.2.2.cmml" xref="S2.E9.m1.1.1.1.1.2.2.2.2.2.2.2.2">𝑦</ci></apply><ci id="S2.E9.m1.1.1.1.1.2.2.2.2.2.2.3.cmml" xref="S2.E9.m1.1.1.1.1.2.2.2.2.2.2.3">𝐷</ci></apply><ci id="S2.E9.m1.1.1.1.1.2.2.2.2.2.3.cmml" xref="S2.E9.m1.1.1.1.1.2.2.2.2.2.3">𝑧</ci></apply></interval></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.E9.m1.1c">\mathcal{L}_{\text{distill}}=\sum_{x_{z}\in\mathcal{D}_{\text{train}}}\text{CE%
}(y^{z},\hat{y}_{D}^{z}),</annotation><annotation encoding="application/x-llamapun" id="S2.E9.m1.1d">caligraphic_L start_POSTSUBSCRIPT distill end_POSTSUBSCRIPT = ∑ start_POSTSUBSCRIPT italic_x start_POSTSUBSCRIPT italic_z end_POSTSUBSCRIPT ∈ caligraphic_D start_POSTSUBSCRIPT train end_POSTSUBSCRIPT end_POSTSUBSCRIPT CE ( italic_y start_POSTSUPERSCRIPT italic_z end_POSTSUPERSCRIPT , over^ start_ARG italic_y end_ARG start_POSTSUBSCRIPT italic_D end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_z end_POSTSUPERSCRIPT ) ,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S2.p12.8">where <math alttext="CE" class="ltx_Math" display="inline" id="S2.p12.8.m1.1"><semantics id="S2.p12.8.m1.1a"><mrow id="S2.p12.8.m1.1.1" xref="S2.p12.8.m1.1.1.cmml"><mi id="S2.p12.8.m1.1.1.2" xref="S2.p12.8.m1.1.1.2.cmml">C</mi><mo id="S2.p12.8.m1.1.1.1" xref="S2.p12.8.m1.1.1.1.cmml">⁢</mo><mi id="S2.p12.8.m1.1.1.3" xref="S2.p12.8.m1.1.1.3.cmml">E</mi></mrow><annotation-xml encoding="MathML-Content" id="S2.p12.8.m1.1b"><apply id="S2.p12.8.m1.1.1.cmml" xref="S2.p12.8.m1.1.1"><times id="S2.p12.8.m1.1.1.1.cmml" xref="S2.p12.8.m1.1.1.1"></times><ci id="S2.p12.8.m1.1.1.2.cmml" xref="S2.p12.8.m1.1.1.2">𝐶</ci><ci id="S2.p12.8.m1.1.1.3.cmml" xref="S2.p12.8.m1.1.1.3">𝐸</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S2.p12.8.m1.1c">CE</annotation><annotation encoding="application/x-llamapun" id="S2.p12.8.m1.1d">italic_C italic_E</annotation></semantics></math> is binary cross-entropy loss.</p>
</div>
</section>
<section class="ltx_section" id="S3">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">3. </span>The RAD Paradigm</h2>
<div class="ltx_para" id="S3.p1">
<p class="ltx_p" id="S3.p1.1">In this section, the details of RAD will be presented. We start with an overview of the entire paradigm’s structure at Section <a class="ltx_ref" href="https://arxiv.org/html/2404.15678v4#S3.SS1" title="3.1. Overview ‣ 3. The RAD Paradigm ‣ Retrieval and Distill: A Temporal Data Shift-Free Paradigm for Online Recommendation System"><span class="ltx_text ltx_ref_tag">3.1</span></a>, followed by detailed expositions of the Retrieval Framework and Distill Framework in Sections <a class="ltx_ref" href="https://arxiv.org/html/2404.15678v4#S3.SS2" title="3.2. Retreival Framework ‣ 3. The RAD Paradigm ‣ Retrieval and Distill: A Temporal Data Shift-Free Paradigm for Online Recommendation System"><span class="ltx_text ltx_ref_tag">3.2</span></a> and <a class="ltx_ref" href="https://arxiv.org/html/2404.15678v4#S3.SS3" title="3.3. Distill Framework ‣ 3. The RAD Paradigm ‣ Retrieval and Distill: A Temporal Data Shift-Free Paradigm for Online Recommendation System"><span class="ltx_text ltx_ref_tag">3.3</span></a>, respectively.</p>
</div>
<figure class="ltx_figure" id="S3.F2"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="393" id="S3.F2.g1" src="x2.png" width="747"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span class="ltx_text" id="S3.F2.2.1.1" style="font-size:90%;">Figure 2</span>. </span><span class="ltx_text" id="S3.F2.3.2" style="font-size:90%;">This figure illustrates the original model and its combination with the two components of the RAD paradigm. In CTR tasks, the original model typically takes tabular data as input and outputs a probability indicating the likelihood of a click. The RAD paradigm initially employs a retrieval framework to assist the original model in making predictions using shifting data. However, considering the performance requirements of the CTR model, we designed the RAD’s distill framework to eliminate the search process in the retrieval framework, thereby meeting the online inference time requirements.</span></figcaption>
</figure>
<figure class="ltx_figure" id="S3.F3"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="261" id="S3.F3.g1" src="x3.png" width="332"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span class="ltx_text" id="S3.F3.2.1.1" style="font-size:90%;">Figure 3</span>. </span><span class="ltx_text" id="S3.F3.3.2" style="font-size:90%;">Retrieval framework.</span></figcaption>
</figure>
<figure class="ltx_figure" id="S3.F4"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="537" id="S3.F4.g1" src="x4.png" width="830"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span class="ltx_text" id="S3.F4.2.1.1" style="font-size:90%;">Figure 4</span>. </span><span class="ltx_text" id="S3.F4.3.2" style="font-size:90%;">Distill Process.</span></figcaption>
</figure>
<figure class="ltx_figure" id="S3.F5"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_square" height="310" id="S3.F5.g1" src="x5.png" width="373"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span class="ltx_text" id="S3.F5.2.1.1" style="font-size:90%;">Figure 5</span>. </span><span class="ltx_text" id="S3.F5.3.2" style="font-size:90%;">Distill Framework.</span></figcaption>
</figure>
<section class="ltx_subsection" id="S3.SS1">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.1. </span>Overview</h3>
<div class="ltx_para" id="S3.SS1.p1">
<p class="ltx_p" id="S3.SS1.p1.1">Traditional CTR models have not accounted for the data shift issue, and they cannot enhance performance by merely adding shifting data <cite class="ltx_cite ltx_citemacro_citep">(Juan et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2404.15678v4#bib.bib14" title="">2016</a>; Naumov et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2404.15678v4#bib.bib21" title="">2019</a>; Gu et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2404.15678v4#bib.bib7" title="">2020</a>)</cite>.
Training only with unshifting data neglects a significant amount of information.
Our proposed Retrieval and Distill paradigm aims to devise a universal solution that utilizes shifting data to enhance the performance of existing models.
RAD is generally divided into two parts.
The first part incorporates a Retrieval Framework to introduce shifting data into the datastore during training.
Concurrently, as per theorem <a class="ltx_ref" href="https://arxiv.org/html/2404.15678v4#S2.Thmtheorem1" title="Theorem 2.1. ‣ 2. PRELIMINARIES ‣ Retrieval and Distill: A Temporal Data Shift-Free Paradigm for Online Recommendation System"><span class="ltx_text ltx_ref_tag">2.1</span></a>, we pretrain the model’s relevance network with shifting data and then transfer it for use.
This approach substantially improves the model’s performance without altering its original structure.
However, including a non-parametric search component in the relevance network poses deployment challenges for online recommendation systems.
Therefore, the second part is a Distill Framework tasked with transforming the relevance network into a parametric neural network model.
We distill a simple neural network (search-distill module) using shifting data and the relevance network as the teacher network.
Ultimately, we merge the search-distill module with the original model and finetune it using unshifting data to yield the final online deployable model.
The following sections will elucidate these modules in detail.</p>
</div>
</section>
<section class="ltx_subsection" id="S3.SS2">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.2. </span>Retreival Framework</h3>
<div class="ltx_para" id="S3.SS2.p1">
<p class="ltx_p" id="S3.SS2.p1.1">The Retrieval Framework aims to employ a relevance network that utilizes shifting data in conjunction with the original model for CTR prediction.
According to theorem <a class="ltx_ref" href="https://arxiv.org/html/2404.15678v4#S2.Thmtheorem1" title="Theorem 2.1. ‣ 2. PRELIMINARIES ‣ Retrieval and Distill: A Temporal Data Shift-Free Paradigm for Online Recommendation System"><span class="ltx_text ltx_ref_tag">2.1</span></a>, the relevance network is temporal data shift-free; therefore, as an initial step, we pretrain the relevance network using shifting data with a teacher network, which is a Retrieval Framework that does not contain the original model. In the second step, we jointly train the relevance network and original model using unshifting data.
Next, we will detail the neural network structure of the Retrieval Framework, followed by its training method.</p>
</div>
<section class="ltx_subsubsection" id="S3.SS2.SSS1">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">3.2.1. </span>Framework Model Structure</h4>
<div class="ltx_para" id="S3.SS2.SSS1.p1">
<p class="ltx_p" id="S3.SS2.SSS1.p1.1">The neural network structure of the Retrieval Framework can be seen in Figure <a class="ltx_ref" href="https://arxiv.org/html/2404.15678v4#S3.F3" title="Figure 3 ‣ 3. The RAD Paradigm ‣ Retrieval and Distill: A Temporal Data Shift-Free Paradigm for Online Recommendation System"><span class="ltx_text ltx_ref_tag">3</span></a>.
The Retrieval Framework aggregates the outputs of both the teacher network and the original model, where the teacher network specifically combines the original input with the relevance network. We shall now explicate the original model, relevance network, and teacher network.</p>
</div>
<div class="ltx_para ltx_noindent" id="S3.SS2.SSS1.p2">
<p class="ltx_p" id="S3.SS2.SSS1.p2.10"><span class="ltx_text ltx_font_bold" id="S3.SS2.SSS1.p2.10.1">Original Model.</span> We denote <math alttext="s_{z}" class="ltx_Math" display="inline" id="S3.SS2.SSS1.p2.1.m1.1"><semantics id="S3.SS2.SSS1.p2.1.m1.1a"><msub id="S3.SS2.SSS1.p2.1.m1.1.1" xref="S3.SS2.SSS1.p2.1.m1.1.1.cmml"><mi id="S3.SS2.SSS1.p2.1.m1.1.1.2" xref="S3.SS2.SSS1.p2.1.m1.1.1.2.cmml">s</mi><mi id="S3.SS2.SSS1.p2.1.m1.1.1.3" xref="S3.SS2.SSS1.p2.1.m1.1.1.3.cmml">z</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS1.p2.1.m1.1b"><apply id="S3.SS2.SSS1.p2.1.m1.1.1.cmml" xref="S3.SS2.SSS1.p2.1.m1.1.1"><csymbol cd="ambiguous" id="S3.SS2.SSS1.p2.1.m1.1.1.1.cmml" xref="S3.SS2.SSS1.p2.1.m1.1.1">subscript</csymbol><ci id="S3.SS2.SSS1.p2.1.m1.1.1.2.cmml" xref="S3.SS2.SSS1.p2.1.m1.1.1.2">𝑠</ci><ci id="S3.SS2.SSS1.p2.1.m1.1.1.3.cmml" xref="S3.SS2.SSS1.p2.1.m1.1.1.3">𝑧</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS1.p2.1.m1.1c">s_{z}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS1.p2.1.m1.1d">italic_s start_POSTSUBSCRIPT italic_z end_POSTSUBSCRIPT</annotation></semantics></math> as any tabular data entry within the dataset <math alttext="\mathcal{D}" class="ltx_Math" display="inline" id="S3.SS2.SSS1.p2.2.m2.1"><semantics id="S3.SS2.SSS1.p2.2.m2.1a"><mi class="ltx_font_mathcaligraphic" id="S3.SS2.SSS1.p2.2.m2.1.1" xref="S3.SS2.SSS1.p2.2.m2.1.1.cmml">𝒟</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS1.p2.2.m2.1b"><ci id="S3.SS2.SSS1.p2.2.m2.1.1.cmml" xref="S3.SS2.SSS1.p2.2.m2.1.1">𝒟</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS1.p2.2.m2.1c">\mathcal{D}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS1.p2.2.m2.1d">caligraphic_D</annotation></semantics></math>, where the feature part of <math alttext="s_{z}" class="ltx_Math" display="inline" id="S3.SS2.SSS1.p2.3.m3.1"><semantics id="S3.SS2.SSS1.p2.3.m3.1a"><msub id="S3.SS2.SSS1.p2.3.m3.1.1" xref="S3.SS2.SSS1.p2.3.m3.1.1.cmml"><mi id="S3.SS2.SSS1.p2.3.m3.1.1.2" xref="S3.SS2.SSS1.p2.3.m3.1.1.2.cmml">s</mi><mi id="S3.SS2.SSS1.p2.3.m3.1.1.3" xref="S3.SS2.SSS1.p2.3.m3.1.1.3.cmml">z</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS1.p2.3.m3.1b"><apply id="S3.SS2.SSS1.p2.3.m3.1.1.cmml" xref="S3.SS2.SSS1.p2.3.m3.1.1"><csymbol cd="ambiguous" id="S3.SS2.SSS1.p2.3.m3.1.1.1.cmml" xref="S3.SS2.SSS1.p2.3.m3.1.1">subscript</csymbol><ci id="S3.SS2.SSS1.p2.3.m3.1.1.2.cmml" xref="S3.SS2.SSS1.p2.3.m3.1.1.2">𝑠</ci><ci id="S3.SS2.SSS1.p2.3.m3.1.1.3.cmml" xref="S3.SS2.SSS1.p2.3.m3.1.1.3">𝑧</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS1.p2.3.m3.1c">s_{z}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS1.p2.3.m3.1d">italic_s start_POSTSUBSCRIPT italic_z end_POSTSUBSCRIPT</annotation></semantics></math> is represented as <math alttext="x_{z}" class="ltx_Math" display="inline" id="S3.SS2.SSS1.p2.4.m4.1"><semantics id="S3.SS2.SSS1.p2.4.m4.1a"><msub id="S3.SS2.SSS1.p2.4.m4.1.1" xref="S3.SS2.SSS1.p2.4.m4.1.1.cmml"><mi id="S3.SS2.SSS1.p2.4.m4.1.1.2" xref="S3.SS2.SSS1.p2.4.m4.1.1.2.cmml">x</mi><mi id="S3.SS2.SSS1.p2.4.m4.1.1.3" xref="S3.SS2.SSS1.p2.4.m4.1.1.3.cmml">z</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS1.p2.4.m4.1b"><apply id="S3.SS2.SSS1.p2.4.m4.1.1.cmml" xref="S3.SS2.SSS1.p2.4.m4.1.1"><csymbol cd="ambiguous" id="S3.SS2.SSS1.p2.4.m4.1.1.1.cmml" xref="S3.SS2.SSS1.p2.4.m4.1.1">subscript</csymbol><ci id="S3.SS2.SSS1.p2.4.m4.1.1.2.cmml" xref="S3.SS2.SSS1.p2.4.m4.1.1.2">𝑥</ci><ci id="S3.SS2.SSS1.p2.4.m4.1.1.3.cmml" xref="S3.SS2.SSS1.p2.4.m4.1.1.3">𝑧</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS1.p2.4.m4.1c">x_{z}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS1.p2.4.m4.1d">italic_x start_POSTSUBSCRIPT italic_z end_POSTSUBSCRIPT</annotation></semantics></math>, and the label part as <math alttext="y_{z}" class="ltx_Math" display="inline" id="S3.SS2.SSS1.p2.5.m5.1"><semantics id="S3.SS2.SSS1.p2.5.m5.1a"><msub id="S3.SS2.SSS1.p2.5.m5.1.1" xref="S3.SS2.SSS1.p2.5.m5.1.1.cmml"><mi id="S3.SS2.SSS1.p2.5.m5.1.1.2" xref="S3.SS2.SSS1.p2.5.m5.1.1.2.cmml">y</mi><mi id="S3.SS2.SSS1.p2.5.m5.1.1.3" xref="S3.SS2.SSS1.p2.5.m5.1.1.3.cmml">z</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS1.p2.5.m5.1b"><apply id="S3.SS2.SSS1.p2.5.m5.1.1.cmml" xref="S3.SS2.SSS1.p2.5.m5.1.1"><csymbol cd="ambiguous" id="S3.SS2.SSS1.p2.5.m5.1.1.1.cmml" xref="S3.SS2.SSS1.p2.5.m5.1.1">subscript</csymbol><ci id="S3.SS2.SSS1.p2.5.m5.1.1.2.cmml" xref="S3.SS2.SSS1.p2.5.m5.1.1.2">𝑦</ci><ci id="S3.SS2.SSS1.p2.5.m5.1.1.3.cmml" xref="S3.SS2.SSS1.p2.5.m5.1.1.3">𝑧</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS1.p2.5.m5.1c">y_{z}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS1.p2.5.m5.1d">italic_y start_POSTSUBSCRIPT italic_z end_POSTSUBSCRIPT</annotation></semantics></math>, with <math alttext="x_{z}=\{c_{z}^{i}\}_{i=1}^{F}" class="ltx_Math" display="inline" id="S3.SS2.SSS1.p2.6.m6.1"><semantics id="S3.SS2.SSS1.p2.6.m6.1a"><mrow id="S3.SS2.SSS1.p2.6.m6.1.1" xref="S3.SS2.SSS1.p2.6.m6.1.1.cmml"><msub id="S3.SS2.SSS1.p2.6.m6.1.1.3" xref="S3.SS2.SSS1.p2.6.m6.1.1.3.cmml"><mi id="S3.SS2.SSS1.p2.6.m6.1.1.3.2" xref="S3.SS2.SSS1.p2.6.m6.1.1.3.2.cmml">x</mi><mi id="S3.SS2.SSS1.p2.6.m6.1.1.3.3" xref="S3.SS2.SSS1.p2.6.m6.1.1.3.3.cmml">z</mi></msub><mo id="S3.SS2.SSS1.p2.6.m6.1.1.2" xref="S3.SS2.SSS1.p2.6.m6.1.1.2.cmml">=</mo><msubsup id="S3.SS2.SSS1.p2.6.m6.1.1.1" xref="S3.SS2.SSS1.p2.6.m6.1.1.1.cmml"><mrow id="S3.SS2.SSS1.p2.6.m6.1.1.1.1.1.1" xref="S3.SS2.SSS1.p2.6.m6.1.1.1.1.1.2.cmml"><mo id="S3.SS2.SSS1.p2.6.m6.1.1.1.1.1.1.2" stretchy="false" xref="S3.SS2.SSS1.p2.6.m6.1.1.1.1.1.2.cmml">{</mo><msubsup id="S3.SS2.SSS1.p2.6.m6.1.1.1.1.1.1.1" xref="S3.SS2.SSS1.p2.6.m6.1.1.1.1.1.1.1.cmml"><mi id="S3.SS2.SSS1.p2.6.m6.1.1.1.1.1.1.1.2.2" xref="S3.SS2.SSS1.p2.6.m6.1.1.1.1.1.1.1.2.2.cmml">c</mi><mi id="S3.SS2.SSS1.p2.6.m6.1.1.1.1.1.1.1.2.3" xref="S3.SS2.SSS1.p2.6.m6.1.1.1.1.1.1.1.2.3.cmml">z</mi><mi id="S3.SS2.SSS1.p2.6.m6.1.1.1.1.1.1.1.3" xref="S3.SS2.SSS1.p2.6.m6.1.1.1.1.1.1.1.3.cmml">i</mi></msubsup><mo id="S3.SS2.SSS1.p2.6.m6.1.1.1.1.1.1.3" stretchy="false" xref="S3.SS2.SSS1.p2.6.m6.1.1.1.1.1.2.cmml">}</mo></mrow><mrow id="S3.SS2.SSS1.p2.6.m6.1.1.1.1.3" xref="S3.SS2.SSS1.p2.6.m6.1.1.1.1.3.cmml"><mi id="S3.SS2.SSS1.p2.6.m6.1.1.1.1.3.2" xref="S3.SS2.SSS1.p2.6.m6.1.1.1.1.3.2.cmml">i</mi><mo id="S3.SS2.SSS1.p2.6.m6.1.1.1.1.3.1" xref="S3.SS2.SSS1.p2.6.m6.1.1.1.1.3.1.cmml">=</mo><mn id="S3.SS2.SSS1.p2.6.m6.1.1.1.1.3.3" xref="S3.SS2.SSS1.p2.6.m6.1.1.1.1.3.3.cmml">1</mn></mrow><mi id="S3.SS2.SSS1.p2.6.m6.1.1.1.3" xref="S3.SS2.SSS1.p2.6.m6.1.1.1.3.cmml">F</mi></msubsup></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS1.p2.6.m6.1b"><apply id="S3.SS2.SSS1.p2.6.m6.1.1.cmml" xref="S3.SS2.SSS1.p2.6.m6.1.1"><eq id="S3.SS2.SSS1.p2.6.m6.1.1.2.cmml" xref="S3.SS2.SSS1.p2.6.m6.1.1.2"></eq><apply id="S3.SS2.SSS1.p2.6.m6.1.1.3.cmml" xref="S3.SS2.SSS1.p2.6.m6.1.1.3"><csymbol cd="ambiguous" id="S3.SS2.SSS1.p2.6.m6.1.1.3.1.cmml" xref="S3.SS2.SSS1.p2.6.m6.1.1.3">subscript</csymbol><ci id="S3.SS2.SSS1.p2.6.m6.1.1.3.2.cmml" xref="S3.SS2.SSS1.p2.6.m6.1.1.3.2">𝑥</ci><ci id="S3.SS2.SSS1.p2.6.m6.1.1.3.3.cmml" xref="S3.SS2.SSS1.p2.6.m6.1.1.3.3">𝑧</ci></apply><apply id="S3.SS2.SSS1.p2.6.m6.1.1.1.cmml" xref="S3.SS2.SSS1.p2.6.m6.1.1.1"><csymbol cd="ambiguous" id="S3.SS2.SSS1.p2.6.m6.1.1.1.2.cmml" xref="S3.SS2.SSS1.p2.6.m6.1.1.1">superscript</csymbol><apply id="S3.SS2.SSS1.p2.6.m6.1.1.1.1.cmml" xref="S3.SS2.SSS1.p2.6.m6.1.1.1"><csymbol cd="ambiguous" id="S3.SS2.SSS1.p2.6.m6.1.1.1.1.2.cmml" xref="S3.SS2.SSS1.p2.6.m6.1.1.1">subscript</csymbol><set id="S3.SS2.SSS1.p2.6.m6.1.1.1.1.1.2.cmml" xref="S3.SS2.SSS1.p2.6.m6.1.1.1.1.1.1"><apply id="S3.SS2.SSS1.p2.6.m6.1.1.1.1.1.1.1.cmml" xref="S3.SS2.SSS1.p2.6.m6.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS2.SSS1.p2.6.m6.1.1.1.1.1.1.1.1.cmml" xref="S3.SS2.SSS1.p2.6.m6.1.1.1.1.1.1.1">superscript</csymbol><apply id="S3.SS2.SSS1.p2.6.m6.1.1.1.1.1.1.1.2.cmml" xref="S3.SS2.SSS1.p2.6.m6.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS2.SSS1.p2.6.m6.1.1.1.1.1.1.1.2.1.cmml" xref="S3.SS2.SSS1.p2.6.m6.1.1.1.1.1.1.1">subscript</csymbol><ci id="S3.SS2.SSS1.p2.6.m6.1.1.1.1.1.1.1.2.2.cmml" xref="S3.SS2.SSS1.p2.6.m6.1.1.1.1.1.1.1.2.2">𝑐</ci><ci id="S3.SS2.SSS1.p2.6.m6.1.1.1.1.1.1.1.2.3.cmml" xref="S3.SS2.SSS1.p2.6.m6.1.1.1.1.1.1.1.2.3">𝑧</ci></apply><ci id="S3.SS2.SSS1.p2.6.m6.1.1.1.1.1.1.1.3.cmml" xref="S3.SS2.SSS1.p2.6.m6.1.1.1.1.1.1.1.3">𝑖</ci></apply></set><apply id="S3.SS2.SSS1.p2.6.m6.1.1.1.1.3.cmml" xref="S3.SS2.SSS1.p2.6.m6.1.1.1.1.3"><eq id="S3.SS2.SSS1.p2.6.m6.1.1.1.1.3.1.cmml" xref="S3.SS2.SSS1.p2.6.m6.1.1.1.1.3.1"></eq><ci id="S3.SS2.SSS1.p2.6.m6.1.1.1.1.3.2.cmml" xref="S3.SS2.SSS1.p2.6.m6.1.1.1.1.3.2">𝑖</ci><cn id="S3.SS2.SSS1.p2.6.m6.1.1.1.1.3.3.cmml" type="integer" xref="S3.SS2.SSS1.p2.6.m6.1.1.1.1.3.3">1</cn></apply></apply><ci id="S3.SS2.SSS1.p2.6.m6.1.1.1.3.cmml" xref="S3.SS2.SSS1.p2.6.m6.1.1.1.3">𝐹</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS1.p2.6.m6.1c">x_{z}=\{c_{z}^{i}\}_{i=1}^{F}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS1.p2.6.m6.1d">italic_x start_POSTSUBSCRIPT italic_z end_POSTSUBSCRIPT = { italic_c start_POSTSUBSCRIPT italic_z end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_i end_POSTSUPERSCRIPT } start_POSTSUBSCRIPT italic_i = 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_F end_POSTSUPERSCRIPT</annotation></semantics></math> comprising <math alttext="F" class="ltx_Math" display="inline" id="S3.SS2.SSS1.p2.7.m7.1"><semantics id="S3.SS2.SSS1.p2.7.m7.1a"><mi id="S3.SS2.SSS1.p2.7.m7.1.1" xref="S3.SS2.SSS1.p2.7.m7.1.1.cmml">F</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS1.p2.7.m7.1b"><ci id="S3.SS2.SSS1.p2.7.m7.1.1.cmml" xref="S3.SS2.SSS1.p2.7.m7.1.1">𝐹</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS1.p2.7.m7.1c">F</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS1.p2.7.m7.1d">italic_F</annotation></semantics></math> features. Traditional CTR models take such an <math alttext="x_{z}" class="ltx_Math" display="inline" id="S3.SS2.SSS1.p2.8.m8.1"><semantics id="S3.SS2.SSS1.p2.8.m8.1a"><msub id="S3.SS2.SSS1.p2.8.m8.1.1" xref="S3.SS2.SSS1.p2.8.m8.1.1.cmml"><mi id="S3.SS2.SSS1.p2.8.m8.1.1.2" xref="S3.SS2.SSS1.p2.8.m8.1.1.2.cmml">x</mi><mi id="S3.SS2.SSS1.p2.8.m8.1.1.3" xref="S3.SS2.SSS1.p2.8.m8.1.1.3.cmml">z</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS1.p2.8.m8.1b"><apply id="S3.SS2.SSS1.p2.8.m8.1.1.cmml" xref="S3.SS2.SSS1.p2.8.m8.1.1"><csymbol cd="ambiguous" id="S3.SS2.SSS1.p2.8.m8.1.1.1.cmml" xref="S3.SS2.SSS1.p2.8.m8.1.1">subscript</csymbol><ci id="S3.SS2.SSS1.p2.8.m8.1.1.2.cmml" xref="S3.SS2.SSS1.p2.8.m8.1.1.2">𝑥</ci><ci id="S3.SS2.SSS1.p2.8.m8.1.1.3.cmml" xref="S3.SS2.SSS1.p2.8.m8.1.1.3">𝑧</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS1.p2.8.m8.1c">x_{z}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS1.p2.8.m8.1d">italic_x start_POSTSUBSCRIPT italic_z end_POSTSUBSCRIPT</annotation></semantics></math> as input and output a probability.
We represent the original model as <math alttext="O" class="ltx_Math" display="inline" id="S3.SS2.SSS1.p2.9.m9.1"><semantics id="S3.SS2.SSS1.p2.9.m9.1a"><mi id="S3.SS2.SSS1.p2.9.m9.1.1" xref="S3.SS2.SSS1.p2.9.m9.1.1.cmml">O</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS1.p2.9.m9.1b"><ci id="S3.SS2.SSS1.p2.9.m9.1.1.cmml" xref="S3.SS2.SSS1.p2.9.m9.1.1">𝑂</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS1.p2.9.m9.1c">O</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS1.p2.9.m9.1d">italic_O</annotation></semantics></math>, with the last layer logit denoted by <math alttext="w_{o}" class="ltx_Math" display="inline" id="S3.SS2.SSS1.p2.10.m10.1"><semantics id="S3.SS2.SSS1.p2.10.m10.1a"><msub id="S3.SS2.SSS1.p2.10.m10.1.1" xref="S3.SS2.SSS1.p2.10.m10.1.1.cmml"><mi id="S3.SS2.SSS1.p2.10.m10.1.1.2" xref="S3.SS2.SSS1.p2.10.m10.1.1.2.cmml">w</mi><mi id="S3.SS2.SSS1.p2.10.m10.1.1.3" xref="S3.SS2.SSS1.p2.10.m10.1.1.3.cmml">o</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS1.p2.10.m10.1b"><apply id="S3.SS2.SSS1.p2.10.m10.1.1.cmml" xref="S3.SS2.SSS1.p2.10.m10.1.1"><csymbol cd="ambiguous" id="S3.SS2.SSS1.p2.10.m10.1.1.1.cmml" xref="S3.SS2.SSS1.p2.10.m10.1.1">subscript</csymbol><ci id="S3.SS2.SSS1.p2.10.m10.1.1.2.cmml" xref="S3.SS2.SSS1.p2.10.m10.1.1.2">𝑤</ci><ci id="S3.SS2.SSS1.p2.10.m10.1.1.3.cmml" xref="S3.SS2.SSS1.p2.10.m10.1.1.3">𝑜</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS1.p2.10.m10.1c">w_{o}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS1.p2.10.m10.1d">italic_w start_POSTSUBSCRIPT italic_o end_POSTSUBSCRIPT</annotation></semantics></math>.</p>
</div>
<div class="ltx_para" id="S3.SS2.SSS1.p3">
<p class="ltx_p" id="S3.SS2.SSS1.p3.2">In the traditional model, the probability prediction is given by</p>
<table class="ltx_equation ltx_eqn_table" id="S3.E10">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_left" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_left">(10)</span></td>
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\hat{y_{O}^{z}}=O(x_{z})=\text{sigmoid}(w_{o})," class="ltx_Math" display="block" id="S3.E10.m1.1"><semantics id="S3.E10.m1.1a"><mrow id="S3.E10.m1.1.1.1" xref="S3.E10.m1.1.1.1.1.cmml"><mrow id="S3.E10.m1.1.1.1.1" xref="S3.E10.m1.1.1.1.1.cmml"><mover accent="true" id="S3.E10.m1.1.1.1.1.4" xref="S3.E10.m1.1.1.1.1.4.cmml"><msubsup id="S3.E10.m1.1.1.1.1.4.2" xref="S3.E10.m1.1.1.1.1.4.2.cmml"><mi id="S3.E10.m1.1.1.1.1.4.2.2.2" xref="S3.E10.m1.1.1.1.1.4.2.2.2.cmml">y</mi><mi id="S3.E10.m1.1.1.1.1.4.2.2.3" xref="S3.E10.m1.1.1.1.1.4.2.2.3.cmml">O</mi><mi id="S3.E10.m1.1.1.1.1.4.2.3" xref="S3.E10.m1.1.1.1.1.4.2.3.cmml">z</mi></msubsup><mo id="S3.E10.m1.1.1.1.1.4.1" xref="S3.E10.m1.1.1.1.1.4.1.cmml">^</mo></mover><mo id="S3.E10.m1.1.1.1.1.5" xref="S3.E10.m1.1.1.1.1.5.cmml">=</mo><mrow id="S3.E10.m1.1.1.1.1.1" xref="S3.E10.m1.1.1.1.1.1.cmml"><mi id="S3.E10.m1.1.1.1.1.1.3" xref="S3.E10.m1.1.1.1.1.1.3.cmml">O</mi><mo id="S3.E10.m1.1.1.1.1.1.2" xref="S3.E10.m1.1.1.1.1.1.2.cmml">⁢</mo><mrow id="S3.E10.m1.1.1.1.1.1.1.1" xref="S3.E10.m1.1.1.1.1.1.1.1.1.cmml"><mo id="S3.E10.m1.1.1.1.1.1.1.1.2" stretchy="false" xref="S3.E10.m1.1.1.1.1.1.1.1.1.cmml">(</mo><msub id="S3.E10.m1.1.1.1.1.1.1.1.1" xref="S3.E10.m1.1.1.1.1.1.1.1.1.cmml"><mi id="S3.E10.m1.1.1.1.1.1.1.1.1.2" xref="S3.E10.m1.1.1.1.1.1.1.1.1.2.cmml">x</mi><mi id="S3.E10.m1.1.1.1.1.1.1.1.1.3" xref="S3.E10.m1.1.1.1.1.1.1.1.1.3.cmml">z</mi></msub><mo id="S3.E10.m1.1.1.1.1.1.1.1.3" stretchy="false" xref="S3.E10.m1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S3.E10.m1.1.1.1.1.6" xref="S3.E10.m1.1.1.1.1.6.cmml">=</mo><mrow id="S3.E10.m1.1.1.1.1.2" xref="S3.E10.m1.1.1.1.1.2.cmml"><mtext id="S3.E10.m1.1.1.1.1.2.3" xref="S3.E10.m1.1.1.1.1.2.3a.cmml">sigmoid</mtext><mo id="S3.E10.m1.1.1.1.1.2.2" xref="S3.E10.m1.1.1.1.1.2.2.cmml">⁢</mo><mrow id="S3.E10.m1.1.1.1.1.2.1.1" xref="S3.E10.m1.1.1.1.1.2.1.1.1.cmml"><mo id="S3.E10.m1.1.1.1.1.2.1.1.2" stretchy="false" xref="S3.E10.m1.1.1.1.1.2.1.1.1.cmml">(</mo><msub id="S3.E10.m1.1.1.1.1.2.1.1.1" xref="S3.E10.m1.1.1.1.1.2.1.1.1.cmml"><mi id="S3.E10.m1.1.1.1.1.2.1.1.1.2" xref="S3.E10.m1.1.1.1.1.2.1.1.1.2.cmml">w</mi><mi id="S3.E10.m1.1.1.1.1.2.1.1.1.3" xref="S3.E10.m1.1.1.1.1.2.1.1.1.3.cmml">o</mi></msub><mo id="S3.E10.m1.1.1.1.1.2.1.1.3" stretchy="false" xref="S3.E10.m1.1.1.1.1.2.1.1.1.cmml">)</mo></mrow></mrow></mrow><mo id="S3.E10.m1.1.1.1.2" xref="S3.E10.m1.1.1.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E10.m1.1b"><apply id="S3.E10.m1.1.1.1.1.cmml" xref="S3.E10.m1.1.1.1"><and id="S3.E10.m1.1.1.1.1a.cmml" xref="S3.E10.m1.1.1.1"></and><apply id="S3.E10.m1.1.1.1.1b.cmml" xref="S3.E10.m1.1.1.1"><eq id="S3.E10.m1.1.1.1.1.5.cmml" xref="S3.E10.m1.1.1.1.1.5"></eq><apply id="S3.E10.m1.1.1.1.1.4.cmml" xref="S3.E10.m1.1.1.1.1.4"><ci id="S3.E10.m1.1.1.1.1.4.1.cmml" xref="S3.E10.m1.1.1.1.1.4.1">^</ci><apply id="S3.E10.m1.1.1.1.1.4.2.cmml" xref="S3.E10.m1.1.1.1.1.4.2"><csymbol cd="ambiguous" id="S3.E10.m1.1.1.1.1.4.2.1.cmml" xref="S3.E10.m1.1.1.1.1.4.2">superscript</csymbol><apply id="S3.E10.m1.1.1.1.1.4.2.2.cmml" xref="S3.E10.m1.1.1.1.1.4.2"><csymbol cd="ambiguous" id="S3.E10.m1.1.1.1.1.4.2.2.1.cmml" xref="S3.E10.m1.1.1.1.1.4.2">subscript</csymbol><ci id="S3.E10.m1.1.1.1.1.4.2.2.2.cmml" xref="S3.E10.m1.1.1.1.1.4.2.2.2">𝑦</ci><ci id="S3.E10.m1.1.1.1.1.4.2.2.3.cmml" xref="S3.E10.m1.1.1.1.1.4.2.2.3">𝑂</ci></apply><ci id="S3.E10.m1.1.1.1.1.4.2.3.cmml" xref="S3.E10.m1.1.1.1.1.4.2.3">𝑧</ci></apply></apply><apply id="S3.E10.m1.1.1.1.1.1.cmml" xref="S3.E10.m1.1.1.1.1.1"><times id="S3.E10.m1.1.1.1.1.1.2.cmml" xref="S3.E10.m1.1.1.1.1.1.2"></times><ci id="S3.E10.m1.1.1.1.1.1.3.cmml" xref="S3.E10.m1.1.1.1.1.1.3">𝑂</ci><apply id="S3.E10.m1.1.1.1.1.1.1.1.1.cmml" xref="S3.E10.m1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E10.m1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E10.m1.1.1.1.1.1.1.1">subscript</csymbol><ci id="S3.E10.m1.1.1.1.1.1.1.1.1.2.cmml" xref="S3.E10.m1.1.1.1.1.1.1.1.1.2">𝑥</ci><ci id="S3.E10.m1.1.1.1.1.1.1.1.1.3.cmml" xref="S3.E10.m1.1.1.1.1.1.1.1.1.3">𝑧</ci></apply></apply></apply><apply id="S3.E10.m1.1.1.1.1c.cmml" xref="S3.E10.m1.1.1.1"><eq id="S3.E10.m1.1.1.1.1.6.cmml" xref="S3.E10.m1.1.1.1.1.6"></eq><share href="https://arxiv.org/html/2404.15678v4#S3.E10.m1.1.1.1.1.1.cmml" id="S3.E10.m1.1.1.1.1d.cmml" xref="S3.E10.m1.1.1.1"></share><apply id="S3.E10.m1.1.1.1.1.2.cmml" xref="S3.E10.m1.1.1.1.1.2"><times id="S3.E10.m1.1.1.1.1.2.2.cmml" xref="S3.E10.m1.1.1.1.1.2.2"></times><ci id="S3.E10.m1.1.1.1.1.2.3a.cmml" xref="S3.E10.m1.1.1.1.1.2.3"><mtext id="S3.E10.m1.1.1.1.1.2.3.cmml" xref="S3.E10.m1.1.1.1.1.2.3">sigmoid</mtext></ci><apply id="S3.E10.m1.1.1.1.1.2.1.1.1.cmml" xref="S3.E10.m1.1.1.1.1.2.1.1"><csymbol cd="ambiguous" id="S3.E10.m1.1.1.1.1.2.1.1.1.1.cmml" xref="S3.E10.m1.1.1.1.1.2.1.1">subscript</csymbol><ci id="S3.E10.m1.1.1.1.1.2.1.1.1.2.cmml" xref="S3.E10.m1.1.1.1.1.2.1.1.1.2">𝑤</ci><ci id="S3.E10.m1.1.1.1.1.2.1.1.1.3.cmml" xref="S3.E10.m1.1.1.1.1.2.1.1.1.3">𝑜</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E10.m1.1c">\hat{y_{O}^{z}}=O(x_{z})=\text{sigmoid}(w_{o}),</annotation><annotation encoding="application/x-llamapun" id="S3.E10.m1.1d">over^ start_ARG italic_y start_POSTSUBSCRIPT italic_O end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_z end_POSTSUPERSCRIPT end_ARG = italic_O ( italic_x start_POSTSUBSCRIPT italic_z end_POSTSUBSCRIPT ) = sigmoid ( italic_w start_POSTSUBSCRIPT italic_o end_POSTSUBSCRIPT ) ,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S3.SS2.SSS1.p3.1">where <math alttext="w_{o}" class="ltx_Math" display="inline" id="S3.SS2.SSS1.p3.1.m1.1"><semantics id="S3.SS2.SSS1.p3.1.m1.1a"><msub id="S3.SS2.SSS1.p3.1.m1.1.1" xref="S3.SS2.SSS1.p3.1.m1.1.1.cmml"><mi id="S3.SS2.SSS1.p3.1.m1.1.1.2" xref="S3.SS2.SSS1.p3.1.m1.1.1.2.cmml">w</mi><mi id="S3.SS2.SSS1.p3.1.m1.1.1.3" xref="S3.SS2.SSS1.p3.1.m1.1.1.3.cmml">o</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS1.p3.1.m1.1b"><apply id="S3.SS2.SSS1.p3.1.m1.1.1.cmml" xref="S3.SS2.SSS1.p3.1.m1.1.1"><csymbol cd="ambiguous" id="S3.SS2.SSS1.p3.1.m1.1.1.1.cmml" xref="S3.SS2.SSS1.p3.1.m1.1.1">subscript</csymbol><ci id="S3.SS2.SSS1.p3.1.m1.1.1.2.cmml" xref="S3.SS2.SSS1.p3.1.m1.1.1.2">𝑤</ci><ci id="S3.SS2.SSS1.p3.1.m1.1.1.3.cmml" xref="S3.SS2.SSS1.p3.1.m1.1.1.3">𝑜</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS1.p3.1.m1.1c">w_{o}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS1.p3.1.m1.1d">italic_w start_POSTSUBSCRIPT italic_o end_POSTSUBSCRIPT</annotation></semantics></math> is the input of the aggregation layer of the Retrieval Framework.</p>
</div>
<div class="ltx_para ltx_noindent" id="S3.SS2.SSS1.p4">
<p class="ltx_p" id="S3.SS2.SSS1.p4.1"><span class="ltx_text ltx_font_bold" id="S3.SS2.SSS1.p4.1.1">Relevance Network.</span>
The relevance network features an embedding layer shared with input <math alttext="x_{z}" class="ltx_Math" display="inline" id="S3.SS2.SSS1.p4.1.m1.1"><semantics id="S3.SS2.SSS1.p4.1.m1.1a"><msub id="S3.SS2.SSS1.p4.1.m1.1.1" xref="S3.SS2.SSS1.p4.1.m1.1.1.cmml"><mi id="S3.SS2.SSS1.p4.1.m1.1.1.2" xref="S3.SS2.SSS1.p4.1.m1.1.1.2.cmml">x</mi><mi id="S3.SS2.SSS1.p4.1.m1.1.1.3" xref="S3.SS2.SSS1.p4.1.m1.1.1.3.cmml">z</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS1.p4.1.m1.1b"><apply id="S3.SS2.SSS1.p4.1.m1.1.1.cmml" xref="S3.SS2.SSS1.p4.1.m1.1.1"><csymbol cd="ambiguous" id="S3.SS2.SSS1.p4.1.m1.1.1.1.cmml" xref="S3.SS2.SSS1.p4.1.m1.1.1">subscript</csymbol><ci id="S3.SS2.SSS1.p4.1.m1.1.1.2.cmml" xref="S3.SS2.SSS1.p4.1.m1.1.1.2">𝑥</ci><ci id="S3.SS2.SSS1.p4.1.m1.1.1.3.cmml" xref="S3.SS2.SSS1.p4.1.m1.1.1.3">𝑧</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS1.p4.1.m1.1c">x_{z}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS1.p4.1.m1.1d">italic_x start_POSTSUBSCRIPT italic_z end_POSTSUBSCRIPT</annotation></semantics></math>, a search engine, and an attention-based aggregation layer.
Within our framework, we utilize shifting tabular data entries as the search space, with BM25 <cite class="ltx_cite ltx_citemacro_citep">(Robertson et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2404.15678v4#bib.bib31" title="">1995</a>)</cite> serving as our search algorithm.</p>
</div>
<div class="ltx_para" id="S3.SS2.SSS1.p5">
<p class="ltx_p" id="S3.SS2.SSS1.p5.2">In the BM25 algorithm, we treat any sample <math alttext="x_{z}" class="ltx_Math" display="inline" id="S3.SS2.SSS1.p5.1.m1.1"><semantics id="S3.SS2.SSS1.p5.1.m1.1a"><msub id="S3.SS2.SSS1.p5.1.m1.1.1" xref="S3.SS2.SSS1.p5.1.m1.1.1.cmml"><mi id="S3.SS2.SSS1.p5.1.m1.1.1.2" xref="S3.SS2.SSS1.p5.1.m1.1.1.2.cmml">x</mi><mi id="S3.SS2.SSS1.p5.1.m1.1.1.3" xref="S3.SS2.SSS1.p5.1.m1.1.1.3.cmml">z</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS1.p5.1.m1.1b"><apply id="S3.SS2.SSS1.p5.1.m1.1.1.cmml" xref="S3.SS2.SSS1.p5.1.m1.1.1"><csymbol cd="ambiguous" id="S3.SS2.SSS1.p5.1.m1.1.1.1.cmml" xref="S3.SS2.SSS1.p5.1.m1.1.1">subscript</csymbol><ci id="S3.SS2.SSS1.p5.1.m1.1.1.2.cmml" xref="S3.SS2.SSS1.p5.1.m1.1.1.2">𝑥</ci><ci id="S3.SS2.SSS1.p5.1.m1.1.1.3.cmml" xref="S3.SS2.SSS1.p5.1.m1.1.1.3">𝑧</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS1.p5.1.m1.1c">x_{z}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS1.p5.1.m1.1d">italic_x start_POSTSUBSCRIPT italic_z end_POSTSUBSCRIPT</annotation></semantics></math> as the query and a key <math alttext="x_{d}" class="ltx_Math" display="inline" id="S3.SS2.SSS1.p5.2.m2.1"><semantics id="S3.SS2.SSS1.p5.2.m2.1a"><msub id="S3.SS2.SSS1.p5.2.m2.1.1" xref="S3.SS2.SSS1.p5.2.m2.1.1.cmml"><mi id="S3.SS2.SSS1.p5.2.m2.1.1.2" xref="S3.SS2.SSS1.p5.2.m2.1.1.2.cmml">x</mi><mi id="S3.SS2.SSS1.p5.2.m2.1.1.3" xref="S3.SS2.SSS1.p5.2.m2.1.1.3.cmml">d</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS1.p5.2.m2.1b"><apply id="S3.SS2.SSS1.p5.2.m2.1.1.cmml" xref="S3.SS2.SSS1.p5.2.m2.1.1"><csymbol cd="ambiguous" id="S3.SS2.SSS1.p5.2.m2.1.1.1.cmml" xref="S3.SS2.SSS1.p5.2.m2.1.1">subscript</csymbol><ci id="S3.SS2.SSS1.p5.2.m2.1.1.2.cmml" xref="S3.SS2.SSS1.p5.2.m2.1.1.2">𝑥</ci><ci id="S3.SS2.SSS1.p5.2.m2.1.1.3.cmml" xref="S3.SS2.SSS1.p5.2.m2.1.1.3">𝑑</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS1.p5.2.m2.1c">x_{d}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS1.p5.2.m2.1d">italic_x start_POSTSUBSCRIPT italic_d end_POSTSUBSCRIPT</annotation></semantics></math> in the datastore as the document. As such, the ranking score can be calculated as</p>
<table class="ltx_equationgroup ltx_eqn_align ltx_eqn_table" id="S6.EGx1">
<tbody id="S3.E11"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_left" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_left">(11)</span></td>
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math alttext="\displaystyle\text{RankScore}(x_{z},x_{d})" class="ltx_Math" display="inline" id="S3.E11.m1.2"><semantics id="S3.E11.m1.2a"><mrow id="S3.E11.m1.2.2" xref="S3.E11.m1.2.2.cmml"><mtext id="S3.E11.m1.2.2.4" xref="S3.E11.m1.2.2.4a.cmml">RankScore</mtext><mo id="S3.E11.m1.2.2.3" xref="S3.E11.m1.2.2.3.cmml">⁢</mo><mrow id="S3.E11.m1.2.2.2.2" xref="S3.E11.m1.2.2.2.3.cmml"><mo id="S3.E11.m1.2.2.2.2.3" stretchy="false" xref="S3.E11.m1.2.2.2.3.cmml">(</mo><msub id="S3.E11.m1.1.1.1.1.1" xref="S3.E11.m1.1.1.1.1.1.cmml"><mi id="S3.E11.m1.1.1.1.1.1.2" xref="S3.E11.m1.1.1.1.1.1.2.cmml">x</mi><mi id="S3.E11.m1.1.1.1.1.1.3" xref="S3.E11.m1.1.1.1.1.1.3.cmml">z</mi></msub><mo id="S3.E11.m1.2.2.2.2.4" xref="S3.E11.m1.2.2.2.3.cmml">,</mo><msub id="S3.E11.m1.2.2.2.2.2" xref="S3.E11.m1.2.2.2.2.2.cmml"><mi id="S3.E11.m1.2.2.2.2.2.2" xref="S3.E11.m1.2.2.2.2.2.2.cmml">x</mi><mi id="S3.E11.m1.2.2.2.2.2.3" xref="S3.E11.m1.2.2.2.2.2.3.cmml">d</mi></msub><mo id="S3.E11.m1.2.2.2.2.5" stretchy="false" xref="S3.E11.m1.2.2.2.3.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.E11.m1.2b"><apply id="S3.E11.m1.2.2.cmml" xref="S3.E11.m1.2.2"><times id="S3.E11.m1.2.2.3.cmml" xref="S3.E11.m1.2.2.3"></times><ci id="S3.E11.m1.2.2.4a.cmml" xref="S3.E11.m1.2.2.4"><mtext id="S3.E11.m1.2.2.4.cmml" xref="S3.E11.m1.2.2.4">RankScore</mtext></ci><interval closure="open" id="S3.E11.m1.2.2.2.3.cmml" xref="S3.E11.m1.2.2.2.2"><apply id="S3.E11.m1.1.1.1.1.1.cmml" xref="S3.E11.m1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E11.m1.1.1.1.1.1.1.cmml" xref="S3.E11.m1.1.1.1.1.1">subscript</csymbol><ci id="S3.E11.m1.1.1.1.1.1.2.cmml" xref="S3.E11.m1.1.1.1.1.1.2">𝑥</ci><ci id="S3.E11.m1.1.1.1.1.1.3.cmml" xref="S3.E11.m1.1.1.1.1.1.3">𝑧</ci></apply><apply id="S3.E11.m1.2.2.2.2.2.cmml" xref="S3.E11.m1.2.2.2.2.2"><csymbol cd="ambiguous" id="S3.E11.m1.2.2.2.2.2.1.cmml" xref="S3.E11.m1.2.2.2.2.2">subscript</csymbol><ci id="S3.E11.m1.2.2.2.2.2.2.cmml" xref="S3.E11.m1.2.2.2.2.2.2">𝑥</ci><ci id="S3.E11.m1.2.2.2.2.2.3.cmml" xref="S3.E11.m1.2.2.2.2.2.3">𝑑</ci></apply></interval></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E11.m1.2c">\displaystyle\text{RankScore}(x_{z},x_{d})</annotation><annotation encoding="application/x-llamapun" id="S3.E11.m1.2d">RankScore ( italic_x start_POSTSUBSCRIPT italic_z end_POSTSUBSCRIPT , italic_x start_POSTSUBSCRIPT italic_d end_POSTSUBSCRIPT )</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle=\sum_{j=1}^{M}\text{IDF}(a_{j}^{z})\cdot\mathbf{1}(x_{j}^{z}=x_{%
j}^{d})," class="ltx_Math" display="inline" id="S3.E11.m2.1"><semantics id="S3.E11.m2.1a"><mrow id="S3.E11.m2.1.1.1" xref="S3.E11.m2.1.1.1.1.cmml"><mrow id="S3.E11.m2.1.1.1.1" xref="S3.E11.m2.1.1.1.1.cmml"><mi id="S3.E11.m2.1.1.1.1.4" xref="S3.E11.m2.1.1.1.1.4.cmml"></mi><mo id="S3.E11.m2.1.1.1.1.3" xref="S3.E11.m2.1.1.1.1.3.cmml">=</mo><mrow id="S3.E11.m2.1.1.1.1.2" xref="S3.E11.m2.1.1.1.1.2.cmml"><mstyle displaystyle="true" id="S3.E11.m2.1.1.1.1.2.3" xref="S3.E11.m2.1.1.1.1.2.3.cmml"><munderover id="S3.E11.m2.1.1.1.1.2.3a" xref="S3.E11.m2.1.1.1.1.2.3.cmml"><mo id="S3.E11.m2.1.1.1.1.2.3.2.2" movablelimits="false" xref="S3.E11.m2.1.1.1.1.2.3.2.2.cmml">∑</mo><mrow id="S3.E11.m2.1.1.1.1.2.3.2.3" xref="S3.E11.m2.1.1.1.1.2.3.2.3.cmml"><mi id="S3.E11.m2.1.1.1.1.2.3.2.3.2" xref="S3.E11.m2.1.1.1.1.2.3.2.3.2.cmml">j</mi><mo id="S3.E11.m2.1.1.1.1.2.3.2.3.1" xref="S3.E11.m2.1.1.1.1.2.3.2.3.1.cmml">=</mo><mn id="S3.E11.m2.1.1.1.1.2.3.2.3.3" xref="S3.E11.m2.1.1.1.1.2.3.2.3.3.cmml">1</mn></mrow><mi id="S3.E11.m2.1.1.1.1.2.3.3" xref="S3.E11.m2.1.1.1.1.2.3.3.cmml">M</mi></munderover></mstyle><mrow id="S3.E11.m2.1.1.1.1.2.2" xref="S3.E11.m2.1.1.1.1.2.2.cmml"><mrow id="S3.E11.m2.1.1.1.1.1.1.1" xref="S3.E11.m2.1.1.1.1.1.1.1.cmml"><mrow id="S3.E11.m2.1.1.1.1.1.1.1.1" xref="S3.E11.m2.1.1.1.1.1.1.1.1.cmml"><mtext id="S3.E11.m2.1.1.1.1.1.1.1.1.3" xref="S3.E11.m2.1.1.1.1.1.1.1.1.3a.cmml">IDF</mtext><mo id="S3.E11.m2.1.1.1.1.1.1.1.1.2" xref="S3.E11.m2.1.1.1.1.1.1.1.1.2.cmml">⁢</mo><mrow id="S3.E11.m2.1.1.1.1.1.1.1.1.1.1" xref="S3.E11.m2.1.1.1.1.1.1.1.1.1.1.1.cmml"><mo id="S3.E11.m2.1.1.1.1.1.1.1.1.1.1.2" stretchy="false" xref="S3.E11.m2.1.1.1.1.1.1.1.1.1.1.1.cmml">(</mo><msubsup id="S3.E11.m2.1.1.1.1.1.1.1.1.1.1.1" xref="S3.E11.m2.1.1.1.1.1.1.1.1.1.1.1.cmml"><mi id="S3.E11.m2.1.1.1.1.1.1.1.1.1.1.1.2.2" xref="S3.E11.m2.1.1.1.1.1.1.1.1.1.1.1.2.2.cmml">a</mi><mi id="S3.E11.m2.1.1.1.1.1.1.1.1.1.1.1.2.3" xref="S3.E11.m2.1.1.1.1.1.1.1.1.1.1.1.2.3.cmml">j</mi><mi id="S3.E11.m2.1.1.1.1.1.1.1.1.1.1.1.3" xref="S3.E11.m2.1.1.1.1.1.1.1.1.1.1.1.3.cmml">z</mi></msubsup><mo id="S3.E11.m2.1.1.1.1.1.1.1.1.1.1.3" rspace="0.055em" stretchy="false" xref="S3.E11.m2.1.1.1.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S3.E11.m2.1.1.1.1.1.1.1.2" rspace="0.222em" xref="S3.E11.m2.1.1.1.1.1.1.1.2.cmml">⋅</mo><mn id="S3.E11.m2.1.1.1.1.1.1.1.3" xref="S3.E11.m2.1.1.1.1.1.1.1.3.cmml">𝟏</mn></mrow><mo id="S3.E11.m2.1.1.1.1.2.2.3" xref="S3.E11.m2.1.1.1.1.2.2.3.cmml">⁢</mo><mrow id="S3.E11.m2.1.1.1.1.2.2.2.1" xref="S3.E11.m2.1.1.1.1.2.2.2.1.1.cmml"><mo id="S3.E11.m2.1.1.1.1.2.2.2.1.2" stretchy="false" xref="S3.E11.m2.1.1.1.1.2.2.2.1.1.cmml">(</mo><mrow id="S3.E11.m2.1.1.1.1.2.2.2.1.1" xref="S3.E11.m2.1.1.1.1.2.2.2.1.1.cmml"><msubsup id="S3.E11.m2.1.1.1.1.2.2.2.1.1.2" xref="S3.E11.m2.1.1.1.1.2.2.2.1.1.2.cmml"><mi id="S3.E11.m2.1.1.1.1.2.2.2.1.1.2.2.2" xref="S3.E11.m2.1.1.1.1.2.2.2.1.1.2.2.2.cmml">x</mi><mi id="S3.E11.m2.1.1.1.1.2.2.2.1.1.2.2.3" xref="S3.E11.m2.1.1.1.1.2.2.2.1.1.2.2.3.cmml">j</mi><mi id="S3.E11.m2.1.1.1.1.2.2.2.1.1.2.3" xref="S3.E11.m2.1.1.1.1.2.2.2.1.1.2.3.cmml">z</mi></msubsup><mo id="S3.E11.m2.1.1.1.1.2.2.2.1.1.1" xref="S3.E11.m2.1.1.1.1.2.2.2.1.1.1.cmml">=</mo><msubsup id="S3.E11.m2.1.1.1.1.2.2.2.1.1.3" xref="S3.E11.m2.1.1.1.1.2.2.2.1.1.3.cmml"><mi id="S3.E11.m2.1.1.1.1.2.2.2.1.1.3.2.2" xref="S3.E11.m2.1.1.1.1.2.2.2.1.1.3.2.2.cmml">x</mi><mi id="S3.E11.m2.1.1.1.1.2.2.2.1.1.3.2.3" xref="S3.E11.m2.1.1.1.1.2.2.2.1.1.3.2.3.cmml">j</mi><mi id="S3.E11.m2.1.1.1.1.2.2.2.1.1.3.3" xref="S3.E11.m2.1.1.1.1.2.2.2.1.1.3.3.cmml">d</mi></msubsup></mrow><mo id="S3.E11.m2.1.1.1.1.2.2.2.1.3" stretchy="false" xref="S3.E11.m2.1.1.1.1.2.2.2.1.1.cmml">)</mo></mrow></mrow></mrow></mrow><mo id="S3.E11.m2.1.1.1.2" xref="S3.E11.m2.1.1.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E11.m2.1b"><apply id="S3.E11.m2.1.1.1.1.cmml" xref="S3.E11.m2.1.1.1"><eq id="S3.E11.m2.1.1.1.1.3.cmml" xref="S3.E11.m2.1.1.1.1.3"></eq><csymbol cd="latexml" id="S3.E11.m2.1.1.1.1.4.cmml" xref="S3.E11.m2.1.1.1.1.4">absent</csymbol><apply id="S3.E11.m2.1.1.1.1.2.cmml" xref="S3.E11.m2.1.1.1.1.2"><apply id="S3.E11.m2.1.1.1.1.2.3.cmml" xref="S3.E11.m2.1.1.1.1.2.3"><csymbol cd="ambiguous" id="S3.E11.m2.1.1.1.1.2.3.1.cmml" xref="S3.E11.m2.1.1.1.1.2.3">superscript</csymbol><apply id="S3.E11.m2.1.1.1.1.2.3.2.cmml" xref="S3.E11.m2.1.1.1.1.2.3"><csymbol cd="ambiguous" id="S3.E11.m2.1.1.1.1.2.3.2.1.cmml" xref="S3.E11.m2.1.1.1.1.2.3">subscript</csymbol><sum id="S3.E11.m2.1.1.1.1.2.3.2.2.cmml" xref="S3.E11.m2.1.1.1.1.2.3.2.2"></sum><apply id="S3.E11.m2.1.1.1.1.2.3.2.3.cmml" xref="S3.E11.m2.1.1.1.1.2.3.2.3"><eq id="S3.E11.m2.1.1.1.1.2.3.2.3.1.cmml" xref="S3.E11.m2.1.1.1.1.2.3.2.3.1"></eq><ci id="S3.E11.m2.1.1.1.1.2.3.2.3.2.cmml" xref="S3.E11.m2.1.1.1.1.2.3.2.3.2">𝑗</ci><cn id="S3.E11.m2.1.1.1.1.2.3.2.3.3.cmml" type="integer" xref="S3.E11.m2.1.1.1.1.2.3.2.3.3">1</cn></apply></apply><ci id="S3.E11.m2.1.1.1.1.2.3.3.cmml" xref="S3.E11.m2.1.1.1.1.2.3.3">𝑀</ci></apply><apply id="S3.E11.m2.1.1.1.1.2.2.cmml" xref="S3.E11.m2.1.1.1.1.2.2"><times id="S3.E11.m2.1.1.1.1.2.2.3.cmml" xref="S3.E11.m2.1.1.1.1.2.2.3"></times><apply id="S3.E11.m2.1.1.1.1.1.1.1.cmml" xref="S3.E11.m2.1.1.1.1.1.1.1"><ci id="S3.E11.m2.1.1.1.1.1.1.1.2.cmml" xref="S3.E11.m2.1.1.1.1.1.1.1.2">⋅</ci><apply id="S3.E11.m2.1.1.1.1.1.1.1.1.cmml" xref="S3.E11.m2.1.1.1.1.1.1.1.1"><times id="S3.E11.m2.1.1.1.1.1.1.1.1.2.cmml" xref="S3.E11.m2.1.1.1.1.1.1.1.1.2"></times><ci id="S3.E11.m2.1.1.1.1.1.1.1.1.3a.cmml" xref="S3.E11.m2.1.1.1.1.1.1.1.1.3"><mtext id="S3.E11.m2.1.1.1.1.1.1.1.1.3.cmml" xref="S3.E11.m2.1.1.1.1.1.1.1.1.3">IDF</mtext></ci><apply id="S3.E11.m2.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E11.m2.1.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E11.m2.1.1.1.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E11.m2.1.1.1.1.1.1.1.1.1.1">superscript</csymbol><apply id="S3.E11.m2.1.1.1.1.1.1.1.1.1.1.1.2.cmml" xref="S3.E11.m2.1.1.1.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E11.m2.1.1.1.1.1.1.1.1.1.1.1.2.1.cmml" xref="S3.E11.m2.1.1.1.1.1.1.1.1.1.1">subscript</csymbol><ci id="S3.E11.m2.1.1.1.1.1.1.1.1.1.1.1.2.2.cmml" xref="S3.E11.m2.1.1.1.1.1.1.1.1.1.1.1.2.2">𝑎</ci><ci id="S3.E11.m2.1.1.1.1.1.1.1.1.1.1.1.2.3.cmml" xref="S3.E11.m2.1.1.1.1.1.1.1.1.1.1.1.2.3">𝑗</ci></apply><ci id="S3.E11.m2.1.1.1.1.1.1.1.1.1.1.1.3.cmml" xref="S3.E11.m2.1.1.1.1.1.1.1.1.1.1.1.3">𝑧</ci></apply></apply><cn id="S3.E11.m2.1.1.1.1.1.1.1.3.cmml" type="integer" xref="S3.E11.m2.1.1.1.1.1.1.1.3">1</cn></apply><apply id="S3.E11.m2.1.1.1.1.2.2.2.1.1.cmml" xref="S3.E11.m2.1.1.1.1.2.2.2.1"><eq id="S3.E11.m2.1.1.1.1.2.2.2.1.1.1.cmml" xref="S3.E11.m2.1.1.1.1.2.2.2.1.1.1"></eq><apply id="S3.E11.m2.1.1.1.1.2.2.2.1.1.2.cmml" xref="S3.E11.m2.1.1.1.1.2.2.2.1.1.2"><csymbol cd="ambiguous" id="S3.E11.m2.1.1.1.1.2.2.2.1.1.2.1.cmml" xref="S3.E11.m2.1.1.1.1.2.2.2.1.1.2">superscript</csymbol><apply id="S3.E11.m2.1.1.1.1.2.2.2.1.1.2.2.cmml" xref="S3.E11.m2.1.1.1.1.2.2.2.1.1.2"><csymbol cd="ambiguous" id="S3.E11.m2.1.1.1.1.2.2.2.1.1.2.2.1.cmml" xref="S3.E11.m2.1.1.1.1.2.2.2.1.1.2">subscript</csymbol><ci id="S3.E11.m2.1.1.1.1.2.2.2.1.1.2.2.2.cmml" xref="S3.E11.m2.1.1.1.1.2.2.2.1.1.2.2.2">𝑥</ci><ci id="S3.E11.m2.1.1.1.1.2.2.2.1.1.2.2.3.cmml" xref="S3.E11.m2.1.1.1.1.2.2.2.1.1.2.2.3">𝑗</ci></apply><ci id="S3.E11.m2.1.1.1.1.2.2.2.1.1.2.3.cmml" xref="S3.E11.m2.1.1.1.1.2.2.2.1.1.2.3">𝑧</ci></apply><apply id="S3.E11.m2.1.1.1.1.2.2.2.1.1.3.cmml" xref="S3.E11.m2.1.1.1.1.2.2.2.1.1.3"><csymbol cd="ambiguous" id="S3.E11.m2.1.1.1.1.2.2.2.1.1.3.1.cmml" xref="S3.E11.m2.1.1.1.1.2.2.2.1.1.3">superscript</csymbol><apply id="S3.E11.m2.1.1.1.1.2.2.2.1.1.3.2.cmml" xref="S3.E11.m2.1.1.1.1.2.2.2.1.1.3"><csymbol cd="ambiguous" id="S3.E11.m2.1.1.1.1.2.2.2.1.1.3.2.1.cmml" xref="S3.E11.m2.1.1.1.1.2.2.2.1.1.3">subscript</csymbol><ci id="S3.E11.m2.1.1.1.1.2.2.2.1.1.3.2.2.cmml" xref="S3.E11.m2.1.1.1.1.2.2.2.1.1.3.2.2">𝑥</ci><ci id="S3.E11.m2.1.1.1.1.2.2.2.1.1.3.2.3.cmml" xref="S3.E11.m2.1.1.1.1.2.2.2.1.1.3.2.3">𝑗</ci></apply><ci id="S3.E11.m2.1.1.1.1.2.2.2.1.1.3.3.cmml" xref="S3.E11.m2.1.1.1.1.2.2.2.1.1.3.3">𝑑</ci></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E11.m2.1c">\displaystyle=\sum_{j=1}^{M}\text{IDF}(a_{j}^{z})\cdot\mathbf{1}(x_{j}^{z}=x_{%
j}^{d}),</annotation><annotation encoding="application/x-llamapun" id="S3.E11.m2.1d">= ∑ start_POSTSUBSCRIPT italic_j = 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_M end_POSTSUPERSCRIPT IDF ( italic_a start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_z end_POSTSUPERSCRIPT ) ⋅ bold_1 ( italic_x start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_z end_POSTSUPERSCRIPT = italic_x start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_d end_POSTSUPERSCRIPT ) ,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
<tbody id="S3.E12"><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_left" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_left">(12)</span></td>
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_td ltx_align_right ltx_eqn_cell"><math alttext="\displaystyle\text{IDF}(x_{j}^{z})" class="ltx_Math" display="inline" id="S3.E12.m1.1"><semantics id="S3.E12.m1.1a"><mrow id="S3.E12.m1.1.1" xref="S3.E12.m1.1.1.cmml"><mtext id="S3.E12.m1.1.1.3" xref="S3.E12.m1.1.1.3a.cmml">IDF</mtext><mo id="S3.E12.m1.1.1.2" xref="S3.E12.m1.1.1.2.cmml">⁢</mo><mrow id="S3.E12.m1.1.1.1.1" xref="S3.E12.m1.1.1.1.1.1.cmml"><mo id="S3.E12.m1.1.1.1.1.2" stretchy="false" xref="S3.E12.m1.1.1.1.1.1.cmml">(</mo><msubsup id="S3.E12.m1.1.1.1.1.1" xref="S3.E12.m1.1.1.1.1.1.cmml"><mi id="S3.E12.m1.1.1.1.1.1.2.2" xref="S3.E12.m1.1.1.1.1.1.2.2.cmml">x</mi><mi id="S3.E12.m1.1.1.1.1.1.2.3" xref="S3.E12.m1.1.1.1.1.1.2.3.cmml">j</mi><mi id="S3.E12.m1.1.1.1.1.1.3" xref="S3.E12.m1.1.1.1.1.1.3.cmml">z</mi></msubsup><mo id="S3.E12.m1.1.1.1.1.3" stretchy="false" xref="S3.E12.m1.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.E12.m1.1b"><apply id="S3.E12.m1.1.1.cmml" xref="S3.E12.m1.1.1"><times id="S3.E12.m1.1.1.2.cmml" xref="S3.E12.m1.1.1.2"></times><ci id="S3.E12.m1.1.1.3a.cmml" xref="S3.E12.m1.1.1.3"><mtext id="S3.E12.m1.1.1.3.cmml" xref="S3.E12.m1.1.1.3">IDF</mtext></ci><apply id="S3.E12.m1.1.1.1.1.1.cmml" xref="S3.E12.m1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E12.m1.1.1.1.1.1.1.cmml" xref="S3.E12.m1.1.1.1.1">superscript</csymbol><apply id="S3.E12.m1.1.1.1.1.1.2.cmml" xref="S3.E12.m1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E12.m1.1.1.1.1.1.2.1.cmml" xref="S3.E12.m1.1.1.1.1">subscript</csymbol><ci id="S3.E12.m1.1.1.1.1.1.2.2.cmml" xref="S3.E12.m1.1.1.1.1.1.2.2">𝑥</ci><ci id="S3.E12.m1.1.1.1.1.1.2.3.cmml" xref="S3.E12.m1.1.1.1.1.1.2.3">𝑗</ci></apply><ci id="S3.E12.m1.1.1.1.1.1.3.cmml" xref="S3.E12.m1.1.1.1.1.1.3">𝑧</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E12.m1.1c">\displaystyle\text{IDF}(x_{j}^{z})</annotation><annotation encoding="application/x-llamapun" id="S3.E12.m1.1d">IDF ( italic_x start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_z end_POSTSUPERSCRIPT )</annotation></semantics></math></td>
<td class="ltx_td ltx_align_left ltx_eqn_cell"><math alttext="\displaystyle=\log\frac{N-N(a_{j}^{z})+0.5}{N(a_{j}^{z})+0.5}," class="ltx_Math" display="inline" id="S3.E12.m2.3"><semantics id="S3.E12.m2.3a"><mrow id="S3.E12.m2.3.3.1" xref="S3.E12.m2.3.3.1.1.cmml"><mrow id="S3.E12.m2.3.3.1.1" xref="S3.E12.m2.3.3.1.1.cmml"><mi id="S3.E12.m2.3.3.1.1.2" xref="S3.E12.m2.3.3.1.1.2.cmml"></mi><mo id="S3.E12.m2.3.3.1.1.1" xref="S3.E12.m2.3.3.1.1.1.cmml">=</mo><mrow id="S3.E12.m2.3.3.1.1.3" xref="S3.E12.m2.3.3.1.1.3.cmml"><mi id="S3.E12.m2.3.3.1.1.3.1" xref="S3.E12.m2.3.3.1.1.3.1.cmml">log</mi><mo id="S3.E12.m2.3.3.1.1.3a" lspace="0.167em" xref="S3.E12.m2.3.3.1.1.3.cmml">⁡</mo><mstyle displaystyle="true" id="S3.E12.m2.2.2" xref="S3.E12.m2.2.2.cmml"><mfrac id="S3.E12.m2.2.2a" xref="S3.E12.m2.2.2.cmml"><mrow id="S3.E12.m2.1.1.1" xref="S3.E12.m2.1.1.1.cmml"><mrow id="S3.E12.m2.1.1.1.1" xref="S3.E12.m2.1.1.1.1.cmml"><mi id="S3.E12.m2.1.1.1.1.3" xref="S3.E12.m2.1.1.1.1.3.cmml">N</mi><mo id="S3.E12.m2.1.1.1.1.2" xref="S3.E12.m2.1.1.1.1.2.cmml">−</mo><mrow id="S3.E12.m2.1.1.1.1.1" xref="S3.E12.m2.1.1.1.1.1.cmml"><mi id="S3.E12.m2.1.1.1.1.1.3" xref="S3.E12.m2.1.1.1.1.1.3.cmml">N</mi><mo id="S3.E12.m2.1.1.1.1.1.2" xref="S3.E12.m2.1.1.1.1.1.2.cmml">⁢</mo><mrow id="S3.E12.m2.1.1.1.1.1.1.1" xref="S3.E12.m2.1.1.1.1.1.1.1.1.cmml"><mo id="S3.E12.m2.1.1.1.1.1.1.1.2" stretchy="false" xref="S3.E12.m2.1.1.1.1.1.1.1.1.cmml">(</mo><msubsup id="S3.E12.m2.1.1.1.1.1.1.1.1" xref="S3.E12.m2.1.1.1.1.1.1.1.1.cmml"><mi id="S3.E12.m2.1.1.1.1.1.1.1.1.2.2" xref="S3.E12.m2.1.1.1.1.1.1.1.1.2.2.cmml">a</mi><mi id="S3.E12.m2.1.1.1.1.1.1.1.1.2.3" xref="S3.E12.m2.1.1.1.1.1.1.1.1.2.3.cmml">j</mi><mi id="S3.E12.m2.1.1.1.1.1.1.1.1.3" xref="S3.E12.m2.1.1.1.1.1.1.1.1.3.cmml">z</mi></msubsup><mo id="S3.E12.m2.1.1.1.1.1.1.1.3" stretchy="false" xref="S3.E12.m2.1.1.1.1.1.1.1.1.cmml">)</mo></mrow></mrow></mrow><mo id="S3.E12.m2.1.1.1.2" xref="S3.E12.m2.1.1.1.2.cmml">+</mo><mn id="S3.E12.m2.1.1.1.3" xref="S3.E12.m2.1.1.1.3.cmml">0.5</mn></mrow><mrow id="S3.E12.m2.2.2.2" xref="S3.E12.m2.2.2.2.cmml"><mrow id="S3.E12.m2.2.2.2.1" xref="S3.E12.m2.2.2.2.1.cmml"><mi id="S3.E12.m2.2.2.2.1.3" xref="S3.E12.m2.2.2.2.1.3.cmml">N</mi><mo id="S3.E12.m2.2.2.2.1.2" xref="S3.E12.m2.2.2.2.1.2.cmml">⁢</mo><mrow id="S3.E12.m2.2.2.2.1.1.1" xref="S3.E12.m2.2.2.2.1.1.1.1.cmml"><mo id="S3.E12.m2.2.2.2.1.1.1.2" stretchy="false" xref="S3.E12.m2.2.2.2.1.1.1.1.cmml">(</mo><msubsup id="S3.E12.m2.2.2.2.1.1.1.1" xref="S3.E12.m2.2.2.2.1.1.1.1.cmml"><mi id="S3.E12.m2.2.2.2.1.1.1.1.2.2" xref="S3.E12.m2.2.2.2.1.1.1.1.2.2.cmml">a</mi><mi id="S3.E12.m2.2.2.2.1.1.1.1.2.3" xref="S3.E12.m2.2.2.2.1.1.1.1.2.3.cmml">j</mi><mi id="S3.E12.m2.2.2.2.1.1.1.1.3" xref="S3.E12.m2.2.2.2.1.1.1.1.3.cmml">z</mi></msubsup><mo id="S3.E12.m2.2.2.2.1.1.1.3" stretchy="false" xref="S3.E12.m2.2.2.2.1.1.1.1.cmml">)</mo></mrow></mrow><mo id="S3.E12.m2.2.2.2.2" xref="S3.E12.m2.2.2.2.2.cmml">+</mo><mn id="S3.E12.m2.2.2.2.3" xref="S3.E12.m2.2.2.2.3.cmml">0.5</mn></mrow></mfrac></mstyle></mrow></mrow><mo id="S3.E12.m2.3.3.1.2" xref="S3.E12.m2.3.3.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E12.m2.3b"><apply id="S3.E12.m2.3.3.1.1.cmml" xref="S3.E12.m2.3.3.1"><eq id="S3.E12.m2.3.3.1.1.1.cmml" xref="S3.E12.m2.3.3.1.1.1"></eq><csymbol cd="latexml" id="S3.E12.m2.3.3.1.1.2.cmml" xref="S3.E12.m2.3.3.1.1.2">absent</csymbol><apply id="S3.E12.m2.3.3.1.1.3.cmml" xref="S3.E12.m2.3.3.1.1.3"><log id="S3.E12.m2.3.3.1.1.3.1.cmml" xref="S3.E12.m2.3.3.1.1.3.1"></log><apply id="S3.E12.m2.2.2.cmml" xref="S3.E12.m2.2.2"><divide id="S3.E12.m2.2.2.3.cmml" xref="S3.E12.m2.2.2"></divide><apply id="S3.E12.m2.1.1.1.cmml" xref="S3.E12.m2.1.1.1"><plus id="S3.E12.m2.1.1.1.2.cmml" xref="S3.E12.m2.1.1.1.2"></plus><apply id="S3.E12.m2.1.1.1.1.cmml" xref="S3.E12.m2.1.1.1.1"><minus id="S3.E12.m2.1.1.1.1.2.cmml" xref="S3.E12.m2.1.1.1.1.2"></minus><ci id="S3.E12.m2.1.1.1.1.3.cmml" xref="S3.E12.m2.1.1.1.1.3">𝑁</ci><apply id="S3.E12.m2.1.1.1.1.1.cmml" xref="S3.E12.m2.1.1.1.1.1"><times id="S3.E12.m2.1.1.1.1.1.2.cmml" xref="S3.E12.m2.1.1.1.1.1.2"></times><ci id="S3.E12.m2.1.1.1.1.1.3.cmml" xref="S3.E12.m2.1.1.1.1.1.3">𝑁</ci><apply id="S3.E12.m2.1.1.1.1.1.1.1.1.cmml" xref="S3.E12.m2.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E12.m2.1.1.1.1.1.1.1.1.1.cmml" xref="S3.E12.m2.1.1.1.1.1.1.1">superscript</csymbol><apply id="S3.E12.m2.1.1.1.1.1.1.1.1.2.cmml" xref="S3.E12.m2.1.1.1.1.1.1.1"><csymbol cd="ambiguous" id="S3.E12.m2.1.1.1.1.1.1.1.1.2.1.cmml" xref="S3.E12.m2.1.1.1.1.1.1.1">subscript</csymbol><ci id="S3.E12.m2.1.1.1.1.1.1.1.1.2.2.cmml" xref="S3.E12.m2.1.1.1.1.1.1.1.1.2.2">𝑎</ci><ci id="S3.E12.m2.1.1.1.1.1.1.1.1.2.3.cmml" xref="S3.E12.m2.1.1.1.1.1.1.1.1.2.3">𝑗</ci></apply><ci id="S3.E12.m2.1.1.1.1.1.1.1.1.3.cmml" xref="S3.E12.m2.1.1.1.1.1.1.1.1.3">𝑧</ci></apply></apply></apply><cn id="S3.E12.m2.1.1.1.3.cmml" type="float" xref="S3.E12.m2.1.1.1.3">0.5</cn></apply><apply id="S3.E12.m2.2.2.2.cmml" xref="S3.E12.m2.2.2.2"><plus id="S3.E12.m2.2.2.2.2.cmml" xref="S3.E12.m2.2.2.2.2"></plus><apply id="S3.E12.m2.2.2.2.1.cmml" xref="S3.E12.m2.2.2.2.1"><times id="S3.E12.m2.2.2.2.1.2.cmml" xref="S3.E12.m2.2.2.2.1.2"></times><ci id="S3.E12.m2.2.2.2.1.3.cmml" xref="S3.E12.m2.2.2.2.1.3">𝑁</ci><apply id="S3.E12.m2.2.2.2.1.1.1.1.cmml" xref="S3.E12.m2.2.2.2.1.1.1"><csymbol cd="ambiguous" id="S3.E12.m2.2.2.2.1.1.1.1.1.cmml" xref="S3.E12.m2.2.2.2.1.1.1">superscript</csymbol><apply id="S3.E12.m2.2.2.2.1.1.1.1.2.cmml" xref="S3.E12.m2.2.2.2.1.1.1"><csymbol cd="ambiguous" id="S3.E12.m2.2.2.2.1.1.1.1.2.1.cmml" xref="S3.E12.m2.2.2.2.1.1.1">subscript</csymbol><ci id="S3.E12.m2.2.2.2.1.1.1.1.2.2.cmml" xref="S3.E12.m2.2.2.2.1.1.1.1.2.2">𝑎</ci><ci id="S3.E12.m2.2.2.2.1.1.1.1.2.3.cmml" xref="S3.E12.m2.2.2.2.1.1.1.1.2.3">𝑗</ci></apply><ci id="S3.E12.m2.2.2.2.1.1.1.1.3.cmml" xref="S3.E12.m2.2.2.2.1.1.1.1.3">𝑧</ci></apply></apply><cn id="S3.E12.m2.2.2.2.3.cmml" type="float" xref="S3.E12.m2.2.2.2.3">0.5</cn></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E12.m2.3c">\displaystyle=\log\frac{N-N(a_{j}^{z})+0.5}{N(a_{j}^{z})+0.5},</annotation><annotation encoding="application/x-llamapun" id="S3.E12.m2.3d">= roman_log divide start_ARG italic_N - italic_N ( italic_a start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_z end_POSTSUPERSCRIPT ) + 0.5 end_ARG start_ARG italic_N ( italic_a start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_z end_POSTSUPERSCRIPT ) + 0.5 end_ARG ,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S3.SS2.SSS1.p5.9">where <math alttext="\mathbf{1}(\cdot)" class="ltx_Math" display="inline" id="S3.SS2.SSS1.p5.3.m1.1"><semantics id="S3.SS2.SSS1.p5.3.m1.1a"><mrow id="S3.SS2.SSS1.p5.3.m1.1.2" xref="S3.SS2.SSS1.p5.3.m1.1.2.cmml"><mn id="S3.SS2.SSS1.p5.3.m1.1.2.2" xref="S3.SS2.SSS1.p5.3.m1.1.2.2.cmml">𝟏</mn><mo id="S3.SS2.SSS1.p5.3.m1.1.2.1" xref="S3.SS2.SSS1.p5.3.m1.1.2.1.cmml">⁢</mo><mrow id="S3.SS2.SSS1.p5.3.m1.1.2.3.2" xref="S3.SS2.SSS1.p5.3.m1.1.2.cmml"><mo id="S3.SS2.SSS1.p5.3.m1.1.2.3.2.1" stretchy="false" xref="S3.SS2.SSS1.p5.3.m1.1.2.cmml">(</mo><mo id="S3.SS2.SSS1.p5.3.m1.1.1" lspace="0em" rspace="0em" xref="S3.SS2.SSS1.p5.3.m1.1.1.cmml">⋅</mo><mo id="S3.SS2.SSS1.p5.3.m1.1.2.3.2.2" stretchy="false" xref="S3.SS2.SSS1.p5.3.m1.1.2.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS1.p5.3.m1.1b"><apply id="S3.SS2.SSS1.p5.3.m1.1.2.cmml" xref="S3.SS2.SSS1.p5.3.m1.1.2"><times id="S3.SS2.SSS1.p5.3.m1.1.2.1.cmml" xref="S3.SS2.SSS1.p5.3.m1.1.2.1"></times><cn id="S3.SS2.SSS1.p5.3.m1.1.2.2.cmml" type="integer" xref="S3.SS2.SSS1.p5.3.m1.1.2.2">1</cn><ci id="S3.SS2.SSS1.p5.3.m1.1.1.cmml" xref="S3.SS2.SSS1.p5.3.m1.1.1">⋅</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS1.p5.3.m1.1c">\mathbf{1}(\cdot)</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS1.p5.3.m1.1d">bold_1 ( ⋅ )</annotation></semantics></math> is the indicator function, <math alttext="N" class="ltx_Math" display="inline" id="S3.SS2.SSS1.p5.4.m2.1"><semantics id="S3.SS2.SSS1.p5.4.m2.1a"><mi id="S3.SS2.SSS1.p5.4.m2.1.1" xref="S3.SS2.SSS1.p5.4.m2.1.1.cmml">N</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS1.p5.4.m2.1b"><ci id="S3.SS2.SSS1.p5.4.m2.1.1.cmml" xref="S3.SS2.SSS1.p5.4.m2.1.1">𝑁</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS1.p5.4.m2.1c">N</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS1.p5.4.m2.1d">italic_N</annotation></semantics></math> is the number of data samples in <math alttext="\mathcal{D}_{\text{shifting}}" class="ltx_Math" display="inline" id="S3.SS2.SSS1.p5.5.m3.1"><semantics id="S3.SS2.SSS1.p5.5.m3.1a"><msub id="S3.SS2.SSS1.p5.5.m3.1.1" xref="S3.SS2.SSS1.p5.5.m3.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS2.SSS1.p5.5.m3.1.1.2" xref="S3.SS2.SSS1.p5.5.m3.1.1.2.cmml">𝒟</mi><mtext id="S3.SS2.SSS1.p5.5.m3.1.1.3" xref="S3.SS2.SSS1.p5.5.m3.1.1.3a.cmml">shifting</mtext></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS1.p5.5.m3.1b"><apply id="S3.SS2.SSS1.p5.5.m3.1.1.cmml" xref="S3.SS2.SSS1.p5.5.m3.1.1"><csymbol cd="ambiguous" id="S3.SS2.SSS1.p5.5.m3.1.1.1.cmml" xref="S3.SS2.SSS1.p5.5.m3.1.1">subscript</csymbol><ci id="S3.SS2.SSS1.p5.5.m3.1.1.2.cmml" xref="S3.SS2.SSS1.p5.5.m3.1.1.2">𝒟</ci><ci id="S3.SS2.SSS1.p5.5.m3.1.1.3a.cmml" xref="S3.SS2.SSS1.p5.5.m3.1.1.3"><mtext id="S3.SS2.SSS1.p5.5.m3.1.1.3.cmml" mathsize="70%" xref="S3.SS2.SSS1.p5.5.m3.1.1.3">shifting</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS1.p5.5.m3.1c">\mathcal{D}_{\text{shifting}}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS1.p5.5.m3.1d">caligraphic_D start_POSTSUBSCRIPT shifting end_POSTSUBSCRIPT</annotation></semantics></math>, and <math alttext="N(a_{j}^{z})" class="ltx_Math" display="inline" id="S3.SS2.SSS1.p5.6.m4.1"><semantics id="S3.SS2.SSS1.p5.6.m4.1a"><mrow id="S3.SS2.SSS1.p5.6.m4.1.1" xref="S3.SS2.SSS1.p5.6.m4.1.1.cmml"><mi id="S3.SS2.SSS1.p5.6.m4.1.1.3" xref="S3.SS2.SSS1.p5.6.m4.1.1.3.cmml">N</mi><mo id="S3.SS2.SSS1.p5.6.m4.1.1.2" xref="S3.SS2.SSS1.p5.6.m4.1.1.2.cmml">⁢</mo><mrow id="S3.SS2.SSS1.p5.6.m4.1.1.1.1" xref="S3.SS2.SSS1.p5.6.m4.1.1.1.1.1.cmml"><mo id="S3.SS2.SSS1.p5.6.m4.1.1.1.1.2" stretchy="false" xref="S3.SS2.SSS1.p5.6.m4.1.1.1.1.1.cmml">(</mo><msubsup id="S3.SS2.SSS1.p5.6.m4.1.1.1.1.1" xref="S3.SS2.SSS1.p5.6.m4.1.1.1.1.1.cmml"><mi id="S3.SS2.SSS1.p5.6.m4.1.1.1.1.1.2.2" xref="S3.SS2.SSS1.p5.6.m4.1.1.1.1.1.2.2.cmml">a</mi><mi id="S3.SS2.SSS1.p5.6.m4.1.1.1.1.1.2.3" xref="S3.SS2.SSS1.p5.6.m4.1.1.1.1.1.2.3.cmml">j</mi><mi id="S3.SS2.SSS1.p5.6.m4.1.1.1.1.1.3" xref="S3.SS2.SSS1.p5.6.m4.1.1.1.1.1.3.cmml">z</mi></msubsup><mo id="S3.SS2.SSS1.p5.6.m4.1.1.1.1.3" stretchy="false" xref="S3.SS2.SSS1.p5.6.m4.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS1.p5.6.m4.1b"><apply id="S3.SS2.SSS1.p5.6.m4.1.1.cmml" xref="S3.SS2.SSS1.p5.6.m4.1.1"><times id="S3.SS2.SSS1.p5.6.m4.1.1.2.cmml" xref="S3.SS2.SSS1.p5.6.m4.1.1.2"></times><ci id="S3.SS2.SSS1.p5.6.m4.1.1.3.cmml" xref="S3.SS2.SSS1.p5.6.m4.1.1.3">𝑁</ci><apply id="S3.SS2.SSS1.p5.6.m4.1.1.1.1.1.cmml" xref="S3.SS2.SSS1.p5.6.m4.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS2.SSS1.p5.6.m4.1.1.1.1.1.1.cmml" xref="S3.SS2.SSS1.p5.6.m4.1.1.1.1">superscript</csymbol><apply id="S3.SS2.SSS1.p5.6.m4.1.1.1.1.1.2.cmml" xref="S3.SS2.SSS1.p5.6.m4.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS2.SSS1.p5.6.m4.1.1.1.1.1.2.1.cmml" xref="S3.SS2.SSS1.p5.6.m4.1.1.1.1">subscript</csymbol><ci id="S3.SS2.SSS1.p5.6.m4.1.1.1.1.1.2.2.cmml" xref="S3.SS2.SSS1.p5.6.m4.1.1.1.1.1.2.2">𝑎</ci><ci id="S3.SS2.SSS1.p5.6.m4.1.1.1.1.1.2.3.cmml" xref="S3.SS2.SSS1.p5.6.m4.1.1.1.1.1.2.3">𝑗</ci></apply><ci id="S3.SS2.SSS1.p5.6.m4.1.1.1.1.1.3.cmml" xref="S3.SS2.SSS1.p5.6.m4.1.1.1.1.1.3">𝑧</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS1.p5.6.m4.1c">N(a_{j}^{z})</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS1.p5.6.m4.1d">italic_N ( italic_a start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_z end_POSTSUPERSCRIPT )</annotation></semantics></math> is the number of data samples that have the categorical feature value <math alttext="x_{j}^{z}" class="ltx_Math" display="inline" id="S3.SS2.SSS1.p5.7.m5.1"><semantics id="S3.SS2.SSS1.p5.7.m5.1a"><msubsup id="S3.SS2.SSS1.p5.7.m5.1.1" xref="S3.SS2.SSS1.p5.7.m5.1.1.cmml"><mi id="S3.SS2.SSS1.p5.7.m5.1.1.2.2" xref="S3.SS2.SSS1.p5.7.m5.1.1.2.2.cmml">x</mi><mi id="S3.SS2.SSS1.p5.7.m5.1.1.2.3" xref="S3.SS2.SSS1.p5.7.m5.1.1.2.3.cmml">j</mi><mi id="S3.SS2.SSS1.p5.7.m5.1.1.3" xref="S3.SS2.SSS1.p5.7.m5.1.1.3.cmml">z</mi></msubsup><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS1.p5.7.m5.1b"><apply id="S3.SS2.SSS1.p5.7.m5.1.1.cmml" xref="S3.SS2.SSS1.p5.7.m5.1.1"><csymbol cd="ambiguous" id="S3.SS2.SSS1.p5.7.m5.1.1.1.cmml" xref="S3.SS2.SSS1.p5.7.m5.1.1">superscript</csymbol><apply id="S3.SS2.SSS1.p5.7.m5.1.1.2.cmml" xref="S3.SS2.SSS1.p5.7.m5.1.1"><csymbol cd="ambiguous" id="S3.SS2.SSS1.p5.7.m5.1.1.2.1.cmml" xref="S3.SS2.SSS1.p5.7.m5.1.1">subscript</csymbol><ci id="S3.SS2.SSS1.p5.7.m5.1.1.2.2.cmml" xref="S3.SS2.SSS1.p5.7.m5.1.1.2.2">𝑥</ci><ci id="S3.SS2.SSS1.p5.7.m5.1.1.2.3.cmml" xref="S3.SS2.SSS1.p5.7.m5.1.1.2.3">𝑗</ci></apply><ci id="S3.SS2.SSS1.p5.7.m5.1.1.3.cmml" xref="S3.SS2.SSS1.p5.7.m5.1.1.3">𝑧</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS1.p5.7.m5.1c">x_{j}^{z}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS1.p5.7.m5.1d">italic_x start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_z end_POSTSUPERSCRIPT</annotation></semantics></math>. By ranking the candidate samples using BM25, we obtain the
top <math alttext="K" class="ltx_Math" display="inline" id="S3.SS2.SSS1.p5.8.m6.1"><semantics id="S3.SS2.SSS1.p5.8.m6.1a"><mi id="S3.SS2.SSS1.p5.8.m6.1.1" xref="S3.SS2.SSS1.p5.8.m6.1.1.cmml">K</mi><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS1.p5.8.m6.1b"><ci id="S3.SS2.SSS1.p5.8.m6.1.1.cmml" xref="S3.SS2.SSS1.p5.8.m6.1.1">𝐾</ci></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS1.p5.8.m6.1c">K</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS1.p5.8.m6.1d">italic_K</annotation></semantics></math> entries as the retrieved set <math alttext="\mathcal{S}(x_{z})" class="ltx_Math" display="inline" id="S3.SS2.SSS1.p5.9.m7.1"><semantics id="S3.SS2.SSS1.p5.9.m7.1a"><mrow id="S3.SS2.SSS1.p5.9.m7.1.1" xref="S3.SS2.SSS1.p5.9.m7.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS2.SSS1.p5.9.m7.1.1.3" xref="S3.SS2.SSS1.p5.9.m7.1.1.3.cmml">𝒮</mi><mo id="S3.SS2.SSS1.p5.9.m7.1.1.2" xref="S3.SS2.SSS1.p5.9.m7.1.1.2.cmml">⁢</mo><mrow id="S3.SS2.SSS1.p5.9.m7.1.1.1.1" xref="S3.SS2.SSS1.p5.9.m7.1.1.1.1.1.cmml"><mo id="S3.SS2.SSS1.p5.9.m7.1.1.1.1.2" stretchy="false" xref="S3.SS2.SSS1.p5.9.m7.1.1.1.1.1.cmml">(</mo><msub id="S3.SS2.SSS1.p5.9.m7.1.1.1.1.1" xref="S3.SS2.SSS1.p5.9.m7.1.1.1.1.1.cmml"><mi id="S3.SS2.SSS1.p5.9.m7.1.1.1.1.1.2" xref="S3.SS2.SSS1.p5.9.m7.1.1.1.1.1.2.cmml">x</mi><mi id="S3.SS2.SSS1.p5.9.m7.1.1.1.1.1.3" xref="S3.SS2.SSS1.p5.9.m7.1.1.1.1.1.3.cmml">z</mi></msub><mo id="S3.SS2.SSS1.p5.9.m7.1.1.1.1.3" stretchy="false" xref="S3.SS2.SSS1.p5.9.m7.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS1.p5.9.m7.1b"><apply id="S3.SS2.SSS1.p5.9.m7.1.1.cmml" xref="S3.SS2.SSS1.p5.9.m7.1.1"><times id="S3.SS2.SSS1.p5.9.m7.1.1.2.cmml" xref="S3.SS2.SSS1.p5.9.m7.1.1.2"></times><ci id="S3.SS2.SSS1.p5.9.m7.1.1.3.cmml" xref="S3.SS2.SSS1.p5.9.m7.1.1.3">𝒮</ci><apply id="S3.SS2.SSS1.p5.9.m7.1.1.1.1.1.cmml" xref="S3.SS2.SSS1.p5.9.m7.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS2.SSS1.p5.9.m7.1.1.1.1.1.1.cmml" xref="S3.SS2.SSS1.p5.9.m7.1.1.1.1">subscript</csymbol><ci id="S3.SS2.SSS1.p5.9.m7.1.1.1.1.1.2.cmml" xref="S3.SS2.SSS1.p5.9.m7.1.1.1.1.1.2">𝑥</ci><ci id="S3.SS2.SSS1.p5.9.m7.1.1.1.1.1.3.cmml" xref="S3.SS2.SSS1.p5.9.m7.1.1.1.1.1.3">𝑧</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS1.p5.9.m7.1c">\mathcal{S}(x_{z})</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS1.p5.9.m7.1d">caligraphic_S ( italic_x start_POSTSUBSCRIPT italic_z end_POSTSUBSCRIPT )</annotation></semantics></math>.</p>
</div>
<div class="ltx_para" id="S3.SS2.SSS1.p6">
<p class="ltx_p" id="S3.SS2.SSS1.p6.1">For each item within <math alttext="\mathcal{S}(x_{z})" class="ltx_Math" display="inline" id="S3.SS2.SSS1.p6.1.m1.1"><semantics id="S3.SS2.SSS1.p6.1.m1.1a"><mrow id="S3.SS2.SSS1.p6.1.m1.1.1" xref="S3.SS2.SSS1.p6.1.m1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS2.SSS1.p6.1.m1.1.1.3" xref="S3.SS2.SSS1.p6.1.m1.1.1.3.cmml">𝒮</mi><mo id="S3.SS2.SSS1.p6.1.m1.1.1.2" xref="S3.SS2.SSS1.p6.1.m1.1.1.2.cmml">⁢</mo><mrow id="S3.SS2.SSS1.p6.1.m1.1.1.1.1" xref="S3.SS2.SSS1.p6.1.m1.1.1.1.1.1.cmml"><mo id="S3.SS2.SSS1.p6.1.m1.1.1.1.1.2" stretchy="false" xref="S3.SS2.SSS1.p6.1.m1.1.1.1.1.1.cmml">(</mo><msub id="S3.SS2.SSS1.p6.1.m1.1.1.1.1.1" xref="S3.SS2.SSS1.p6.1.m1.1.1.1.1.1.cmml"><mi id="S3.SS2.SSS1.p6.1.m1.1.1.1.1.1.2" xref="S3.SS2.SSS1.p6.1.m1.1.1.1.1.1.2.cmml">x</mi><mi id="S3.SS2.SSS1.p6.1.m1.1.1.1.1.1.3" xref="S3.SS2.SSS1.p6.1.m1.1.1.1.1.1.3.cmml">z</mi></msub><mo id="S3.SS2.SSS1.p6.1.m1.1.1.1.1.3" stretchy="false" xref="S3.SS2.SSS1.p6.1.m1.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS1.p6.1.m1.1b"><apply id="S3.SS2.SSS1.p6.1.m1.1.1.cmml" xref="S3.SS2.SSS1.p6.1.m1.1.1"><times id="S3.SS2.SSS1.p6.1.m1.1.1.2.cmml" xref="S3.SS2.SSS1.p6.1.m1.1.1.2"></times><ci id="S3.SS2.SSS1.p6.1.m1.1.1.3.cmml" xref="S3.SS2.SSS1.p6.1.m1.1.1.3">𝒮</ci><apply id="S3.SS2.SSS1.p6.1.m1.1.1.1.1.1.cmml" xref="S3.SS2.SSS1.p6.1.m1.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS2.SSS1.p6.1.m1.1.1.1.1.1.1.cmml" xref="S3.SS2.SSS1.p6.1.m1.1.1.1.1">subscript</csymbol><ci id="S3.SS2.SSS1.p6.1.m1.1.1.1.1.1.2.cmml" xref="S3.SS2.SSS1.p6.1.m1.1.1.1.1.1.2">𝑥</ci><ci id="S3.SS2.SSS1.p6.1.m1.1.1.1.1.1.3.cmml" xref="S3.SS2.SSS1.p6.1.m1.1.1.1.1.1.3">𝑧</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS1.p6.1.m1.1c">\mathcal{S}(x_{z})</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS1.p6.1.m1.1d">caligraphic_S ( italic_x start_POSTSUBSCRIPT italic_z end_POSTSUBSCRIPT )</annotation></semantics></math>, an attention mechanism is applied to calculate its aggregation parameter</p>
<table class="ltx_equation ltx_eqn_table" id="S3.E13">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_left" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_left">(13)</span></td>
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="\alpha_{k}=\frac{\exp(x_{k}^{\top}Wx_{z})}{\sum_{j=1}^{K}\exp(x_{j}^{\top}Wx_{%
z})}," class="ltx_Math" display="block" id="S3.E13.m1.5"><semantics id="S3.E13.m1.5a"><mrow id="S3.E13.m1.5.5.1" xref="S3.E13.m1.5.5.1.1.cmml"><mrow id="S3.E13.m1.5.5.1.1" xref="S3.E13.m1.5.5.1.1.cmml"><msub id="S3.E13.m1.5.5.1.1.2" xref="S3.E13.m1.5.5.1.1.2.cmml"><mi id="S3.E13.m1.5.5.1.1.2.2" xref="S3.E13.m1.5.5.1.1.2.2.cmml">α</mi><mi id="S3.E13.m1.5.5.1.1.2.3" xref="S3.E13.m1.5.5.1.1.2.3.cmml">k</mi></msub><mo id="S3.E13.m1.5.5.1.1.1" xref="S3.E13.m1.5.5.1.1.1.cmml">=</mo><mfrac id="S3.E13.m1.4.4" xref="S3.E13.m1.4.4.cmml"><mrow id="S3.E13.m1.2.2.2.2" xref="S3.E13.m1.2.2.2.3.cmml"><mi id="S3.E13.m1.1.1.1.1" xref="S3.E13.m1.1.1.1.1.cmml">exp</mi><mo id="S3.E13.m1.2.2.2.2a" xref="S3.E13.m1.2.2.2.3.cmml">⁡</mo><mrow id="S3.E13.m1.2.2.2.2.1" xref="S3.E13.m1.2.2.2.3.cmml"><mo id="S3.E13.m1.2.2.2.2.1.2" stretchy="false" xref="S3.E13.m1.2.2.2.3.cmml">(</mo><mrow id="S3.E13.m1.2.2.2.2.1.1" xref="S3.E13.m1.2.2.2.2.1.1.cmml"><msubsup id="S3.E13.m1.2.2.2.2.1.1.2" xref="S3.E13.m1.2.2.2.2.1.1.2.cmml"><mi id="S3.E13.m1.2.2.2.2.1.1.2.2.2" xref="S3.E13.m1.2.2.2.2.1.1.2.2.2.cmml">x</mi><mi id="S3.E13.m1.2.2.2.2.1.1.2.2.3" xref="S3.E13.m1.2.2.2.2.1.1.2.2.3.cmml">k</mi><mo id="S3.E13.m1.2.2.2.2.1.1.2.3" xref="S3.E13.m1.2.2.2.2.1.1.2.3.cmml">⊤</mo></msubsup><mo id="S3.E13.m1.2.2.2.2.1.1.1" xref="S3.E13.m1.2.2.2.2.1.1.1.cmml">⁢</mo><mi id="S3.E13.m1.2.2.2.2.1.1.3" xref="S3.E13.m1.2.2.2.2.1.1.3.cmml">W</mi><mo id="S3.E13.m1.2.2.2.2.1.1.1a" xref="S3.E13.m1.2.2.2.2.1.1.1.cmml">⁢</mo><msub id="S3.E13.m1.2.2.2.2.1.1.4" xref="S3.E13.m1.2.2.2.2.1.1.4.cmml"><mi id="S3.E13.m1.2.2.2.2.1.1.4.2" xref="S3.E13.m1.2.2.2.2.1.1.4.2.cmml">x</mi><mi id="S3.E13.m1.2.2.2.2.1.1.4.3" xref="S3.E13.m1.2.2.2.2.1.1.4.3.cmml">z</mi></msub></mrow><mo id="S3.E13.m1.2.2.2.2.1.3" stretchy="false" xref="S3.E13.m1.2.2.2.3.cmml">)</mo></mrow></mrow><mrow id="S3.E13.m1.4.4.4" xref="S3.E13.m1.4.4.4.cmml"><msubsup id="S3.E13.m1.4.4.4.3" xref="S3.E13.m1.4.4.4.3.cmml"><mo id="S3.E13.m1.4.4.4.3.2.2" xref="S3.E13.m1.4.4.4.3.2.2.cmml">∑</mo><mrow id="S3.E13.m1.4.4.4.3.2.3" xref="S3.E13.m1.4.4.4.3.2.3.cmml"><mi id="S3.E13.m1.4.4.4.3.2.3.2" xref="S3.E13.m1.4.4.4.3.2.3.2.cmml">j</mi><mo id="S3.E13.m1.4.4.4.3.2.3.1" xref="S3.E13.m1.4.4.4.3.2.3.1.cmml">=</mo><mn id="S3.E13.m1.4.4.4.3.2.3.3" xref="S3.E13.m1.4.4.4.3.2.3.3.cmml">1</mn></mrow><mi id="S3.E13.m1.4.4.4.3.3" xref="S3.E13.m1.4.4.4.3.3.cmml">K</mi></msubsup><mrow id="S3.E13.m1.4.4.4.2.1" xref="S3.E13.m1.4.4.4.2.2.cmml"><mi id="S3.E13.m1.3.3.3.1" xref="S3.E13.m1.3.3.3.1.cmml">exp</mi><mo id="S3.E13.m1.4.4.4.2.1a" xref="S3.E13.m1.4.4.4.2.2.cmml">⁡</mo><mrow id="S3.E13.m1.4.4.4.2.1.1" xref="S3.E13.m1.4.4.4.2.2.cmml"><mo id="S3.E13.m1.4.4.4.2.1.1.2" stretchy="false" xref="S3.E13.m1.4.4.4.2.2.cmml">(</mo><mrow id="S3.E13.m1.4.4.4.2.1.1.1" xref="S3.E13.m1.4.4.4.2.1.1.1.cmml"><msubsup id="S3.E13.m1.4.4.4.2.1.1.1.2" xref="S3.E13.m1.4.4.4.2.1.1.1.2.cmml"><mi id="S3.E13.m1.4.4.4.2.1.1.1.2.2.2" xref="S3.E13.m1.4.4.4.2.1.1.1.2.2.2.cmml">x</mi><mi id="S3.E13.m1.4.4.4.2.1.1.1.2.2.3" xref="S3.E13.m1.4.4.4.2.1.1.1.2.2.3.cmml">j</mi><mo id="S3.E13.m1.4.4.4.2.1.1.1.2.3" xref="S3.E13.m1.4.4.4.2.1.1.1.2.3.cmml">⊤</mo></msubsup><mo id="S3.E13.m1.4.4.4.2.1.1.1.1" xref="S3.E13.m1.4.4.4.2.1.1.1.1.cmml">⁢</mo><mi id="S3.E13.m1.4.4.4.2.1.1.1.3" xref="S3.E13.m1.4.4.4.2.1.1.1.3.cmml">W</mi><mo id="S3.E13.m1.4.4.4.2.1.1.1.1a" xref="S3.E13.m1.4.4.4.2.1.1.1.1.cmml">⁢</mo><msub id="S3.E13.m1.4.4.4.2.1.1.1.4" xref="S3.E13.m1.4.4.4.2.1.1.1.4.cmml"><mi id="S3.E13.m1.4.4.4.2.1.1.1.4.2" xref="S3.E13.m1.4.4.4.2.1.1.1.4.2.cmml">x</mi><mi id="S3.E13.m1.4.4.4.2.1.1.1.4.3" xref="S3.E13.m1.4.4.4.2.1.1.1.4.3.cmml">z</mi></msub></mrow><mo id="S3.E13.m1.4.4.4.2.1.1.3" stretchy="false" xref="S3.E13.m1.4.4.4.2.2.cmml">)</mo></mrow></mrow></mrow></mfrac></mrow><mo id="S3.E13.m1.5.5.1.2" xref="S3.E13.m1.5.5.1.1.cmml">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E13.m1.5b"><apply id="S3.E13.m1.5.5.1.1.cmml" xref="S3.E13.m1.5.5.1"><eq id="S3.E13.m1.5.5.1.1.1.cmml" xref="S3.E13.m1.5.5.1.1.1"></eq><apply id="S3.E13.m1.5.5.1.1.2.cmml" xref="S3.E13.m1.5.5.1.1.2"><csymbol cd="ambiguous" id="S3.E13.m1.5.5.1.1.2.1.cmml" xref="S3.E13.m1.5.5.1.1.2">subscript</csymbol><ci id="S3.E13.m1.5.5.1.1.2.2.cmml" xref="S3.E13.m1.5.5.1.1.2.2">𝛼</ci><ci id="S3.E13.m1.5.5.1.1.2.3.cmml" xref="S3.E13.m1.5.5.1.1.2.3">𝑘</ci></apply><apply id="S3.E13.m1.4.4.cmml" xref="S3.E13.m1.4.4"><divide id="S3.E13.m1.4.4.5.cmml" xref="S3.E13.m1.4.4"></divide><apply id="S3.E13.m1.2.2.2.3.cmml" xref="S3.E13.m1.2.2.2.2"><exp id="S3.E13.m1.1.1.1.1.cmml" xref="S3.E13.m1.1.1.1.1"></exp><apply id="S3.E13.m1.2.2.2.2.1.1.cmml" xref="S3.E13.m1.2.2.2.2.1.1"><times id="S3.E13.m1.2.2.2.2.1.1.1.cmml" xref="S3.E13.m1.2.2.2.2.1.1.1"></times><apply id="S3.E13.m1.2.2.2.2.1.1.2.cmml" xref="S3.E13.m1.2.2.2.2.1.1.2"><csymbol cd="ambiguous" id="S3.E13.m1.2.2.2.2.1.1.2.1.cmml" xref="S3.E13.m1.2.2.2.2.1.1.2">superscript</csymbol><apply id="S3.E13.m1.2.2.2.2.1.1.2.2.cmml" xref="S3.E13.m1.2.2.2.2.1.1.2"><csymbol cd="ambiguous" id="S3.E13.m1.2.2.2.2.1.1.2.2.1.cmml" xref="S3.E13.m1.2.2.2.2.1.1.2">subscript</csymbol><ci id="S3.E13.m1.2.2.2.2.1.1.2.2.2.cmml" xref="S3.E13.m1.2.2.2.2.1.1.2.2.2">𝑥</ci><ci id="S3.E13.m1.2.2.2.2.1.1.2.2.3.cmml" xref="S3.E13.m1.2.2.2.2.1.1.2.2.3">𝑘</ci></apply><csymbol cd="latexml" id="S3.E13.m1.2.2.2.2.1.1.2.3.cmml" xref="S3.E13.m1.2.2.2.2.1.1.2.3">top</csymbol></apply><ci id="S3.E13.m1.2.2.2.2.1.1.3.cmml" xref="S3.E13.m1.2.2.2.2.1.1.3">𝑊</ci><apply id="S3.E13.m1.2.2.2.2.1.1.4.cmml" xref="S3.E13.m1.2.2.2.2.1.1.4"><csymbol cd="ambiguous" id="S3.E13.m1.2.2.2.2.1.1.4.1.cmml" xref="S3.E13.m1.2.2.2.2.1.1.4">subscript</csymbol><ci id="S3.E13.m1.2.2.2.2.1.1.4.2.cmml" xref="S3.E13.m1.2.2.2.2.1.1.4.2">𝑥</ci><ci id="S3.E13.m1.2.2.2.2.1.1.4.3.cmml" xref="S3.E13.m1.2.2.2.2.1.1.4.3">𝑧</ci></apply></apply></apply><apply id="S3.E13.m1.4.4.4.cmml" xref="S3.E13.m1.4.4.4"><apply id="S3.E13.m1.4.4.4.3.cmml" xref="S3.E13.m1.4.4.4.3"><csymbol cd="ambiguous" id="S3.E13.m1.4.4.4.3.1.cmml" xref="S3.E13.m1.4.4.4.3">superscript</csymbol><apply id="S3.E13.m1.4.4.4.3.2.cmml" xref="S3.E13.m1.4.4.4.3"><csymbol cd="ambiguous" id="S3.E13.m1.4.4.4.3.2.1.cmml" xref="S3.E13.m1.4.4.4.3">subscript</csymbol><sum id="S3.E13.m1.4.4.4.3.2.2.cmml" xref="S3.E13.m1.4.4.4.3.2.2"></sum><apply id="S3.E13.m1.4.4.4.3.2.3.cmml" xref="S3.E13.m1.4.4.4.3.2.3"><eq id="S3.E13.m1.4.4.4.3.2.3.1.cmml" xref="S3.E13.m1.4.4.4.3.2.3.1"></eq><ci id="S3.E13.m1.4.4.4.3.2.3.2.cmml" xref="S3.E13.m1.4.4.4.3.2.3.2">𝑗</ci><cn id="S3.E13.m1.4.4.4.3.2.3.3.cmml" type="integer" xref="S3.E13.m1.4.4.4.3.2.3.3">1</cn></apply></apply><ci id="S3.E13.m1.4.4.4.3.3.cmml" xref="S3.E13.m1.4.4.4.3.3">𝐾</ci></apply><apply id="S3.E13.m1.4.4.4.2.2.cmml" xref="S3.E13.m1.4.4.4.2.1"><exp id="S3.E13.m1.3.3.3.1.cmml" xref="S3.E13.m1.3.3.3.1"></exp><apply id="S3.E13.m1.4.4.4.2.1.1.1.cmml" xref="S3.E13.m1.4.4.4.2.1.1.1"><times id="S3.E13.m1.4.4.4.2.1.1.1.1.cmml" xref="S3.E13.m1.4.4.4.2.1.1.1.1"></times><apply id="S3.E13.m1.4.4.4.2.1.1.1.2.cmml" xref="S3.E13.m1.4.4.4.2.1.1.1.2"><csymbol cd="ambiguous" id="S3.E13.m1.4.4.4.2.1.1.1.2.1.cmml" xref="S3.E13.m1.4.4.4.2.1.1.1.2">superscript</csymbol><apply id="S3.E13.m1.4.4.4.2.1.1.1.2.2.cmml" xref="S3.E13.m1.4.4.4.2.1.1.1.2"><csymbol cd="ambiguous" id="S3.E13.m1.4.4.4.2.1.1.1.2.2.1.cmml" xref="S3.E13.m1.4.4.4.2.1.1.1.2">subscript</csymbol><ci id="S3.E13.m1.4.4.4.2.1.1.1.2.2.2.cmml" xref="S3.E13.m1.4.4.4.2.1.1.1.2.2.2">𝑥</ci><ci id="S3.E13.m1.4.4.4.2.1.1.1.2.2.3.cmml" xref="S3.E13.m1.4.4.4.2.1.1.1.2.2.3">𝑗</ci></apply><csymbol cd="latexml" id="S3.E13.m1.4.4.4.2.1.1.1.2.3.cmml" xref="S3.E13.m1.4.4.4.2.1.1.1.2.3">top</csymbol></apply><ci id="S3.E13.m1.4.4.4.2.1.1.1.3.cmml" xref="S3.E13.m1.4.4.4.2.1.1.1.3">𝑊</ci><apply id="S3.E13.m1.4.4.4.2.1.1.1.4.cmml" xref="S3.E13.m1.4.4.4.2.1.1.1.4"><csymbol cd="ambiguous" id="S3.E13.m1.4.4.4.2.1.1.1.4.1.cmml" xref="S3.E13.m1.4.4.4.2.1.1.1.4">subscript</csymbol><ci id="S3.E13.m1.4.4.4.2.1.1.1.4.2.cmml" xref="S3.E13.m1.4.4.4.2.1.1.1.4.2">𝑥</ci><ci id="S3.E13.m1.4.4.4.2.1.1.1.4.3.cmml" xref="S3.E13.m1.4.4.4.2.1.1.1.4.3">𝑧</ci></apply></apply></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E13.m1.5c">\alpha_{k}=\frac{\exp(x_{k}^{\top}Wx_{z})}{\sum_{j=1}^{K}\exp(x_{j}^{\top}Wx_{%
z})},</annotation><annotation encoding="application/x-llamapun" id="S3.E13.m1.5d">italic_α start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT = divide start_ARG roman_exp ( italic_x start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ⊤ end_POSTSUPERSCRIPT italic_W italic_x start_POSTSUBSCRIPT italic_z end_POSTSUBSCRIPT ) end_ARG start_ARG ∑ start_POSTSUBSCRIPT italic_j = 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_K end_POSTSUPERSCRIPT roman_exp ( italic_x start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ⊤ end_POSTSUPERSCRIPT italic_W italic_x start_POSTSUBSCRIPT italic_z end_POSTSUBSCRIPT ) end_ARG ,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
</div>
<div class="ltx_para" id="S3.SS2.SSS1.p7">
<p class="ltx_p" id="S3.SS2.SSS1.p7.2">The elements of <math alttext="\mathcal{S}(x_{z})" class="ltx_Math" display="inline" id="S3.SS2.SSS1.p7.1.m1.1"><semantics id="S3.SS2.SSS1.p7.1.m1.1a"><mrow id="S3.SS2.SSS1.p7.1.m1.1.1" xref="S3.SS2.SSS1.p7.1.m1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS2.SSS1.p7.1.m1.1.1.3" xref="S3.SS2.SSS1.p7.1.m1.1.1.3.cmml">𝒮</mi><mo id="S3.SS2.SSS1.p7.1.m1.1.1.2" xref="S3.SS2.SSS1.p7.1.m1.1.1.2.cmml">⁢</mo><mrow id="S3.SS2.SSS1.p7.1.m1.1.1.1.1" xref="S3.SS2.SSS1.p7.1.m1.1.1.1.1.1.cmml"><mo id="S3.SS2.SSS1.p7.1.m1.1.1.1.1.2" stretchy="false" xref="S3.SS2.SSS1.p7.1.m1.1.1.1.1.1.cmml">(</mo><msub id="S3.SS2.SSS1.p7.1.m1.1.1.1.1.1" xref="S3.SS2.SSS1.p7.1.m1.1.1.1.1.1.cmml"><mi id="S3.SS2.SSS1.p7.1.m1.1.1.1.1.1.2" xref="S3.SS2.SSS1.p7.1.m1.1.1.1.1.1.2.cmml">x</mi><mi id="S3.SS2.SSS1.p7.1.m1.1.1.1.1.1.3" xref="S3.SS2.SSS1.p7.1.m1.1.1.1.1.1.3.cmml">z</mi></msub><mo id="S3.SS2.SSS1.p7.1.m1.1.1.1.1.3" stretchy="false" xref="S3.SS2.SSS1.p7.1.m1.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS1.p7.1.m1.1b"><apply id="S3.SS2.SSS1.p7.1.m1.1.1.cmml" xref="S3.SS2.SSS1.p7.1.m1.1.1"><times id="S3.SS2.SSS1.p7.1.m1.1.1.2.cmml" xref="S3.SS2.SSS1.p7.1.m1.1.1.2"></times><ci id="S3.SS2.SSS1.p7.1.m1.1.1.3.cmml" xref="S3.SS2.SSS1.p7.1.m1.1.1.3">𝒮</ci><apply id="S3.SS2.SSS1.p7.1.m1.1.1.1.1.1.cmml" xref="S3.SS2.SSS1.p7.1.m1.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS2.SSS1.p7.1.m1.1.1.1.1.1.1.cmml" xref="S3.SS2.SSS1.p7.1.m1.1.1.1.1">subscript</csymbol><ci id="S3.SS2.SSS1.p7.1.m1.1.1.1.1.1.2.cmml" xref="S3.SS2.SSS1.p7.1.m1.1.1.1.1.1.2">𝑥</ci><ci id="S3.SS2.SSS1.p7.1.m1.1.1.1.1.1.3.cmml" xref="S3.SS2.SSS1.p7.1.m1.1.1.1.1.1.3">𝑧</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS1.p7.1.m1.1c">\mathcal{S}(x_{z})</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS1.p7.1.m1.1d">caligraphic_S ( italic_x start_POSTSUBSCRIPT italic_z end_POSTSUBSCRIPT )</annotation></semantics></math> are then consolidated into a logit <math alttext="w_{R}" class="ltx_Math" display="inline" id="S3.SS2.SSS1.p7.2.m2.1"><semantics id="S3.SS2.SSS1.p7.2.m2.1a"><msub id="S3.SS2.SSS1.p7.2.m2.1.1" xref="S3.SS2.SSS1.p7.2.m2.1.1.cmml"><mi id="S3.SS2.SSS1.p7.2.m2.1.1.2" xref="S3.SS2.SSS1.p7.2.m2.1.1.2.cmml">w</mi><mi id="S3.SS2.SSS1.p7.2.m2.1.1.3" xref="S3.SS2.SSS1.p7.2.m2.1.1.3.cmml">R</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS1.p7.2.m2.1b"><apply id="S3.SS2.SSS1.p7.2.m2.1.1.cmml" xref="S3.SS2.SSS1.p7.2.m2.1.1"><csymbol cd="ambiguous" id="S3.SS2.SSS1.p7.2.m2.1.1.1.cmml" xref="S3.SS2.SSS1.p7.2.m2.1.1">subscript</csymbol><ci id="S3.SS2.SSS1.p7.2.m2.1.1.2.cmml" xref="S3.SS2.SSS1.p7.2.m2.1.1.2">𝑤</ci><ci id="S3.SS2.SSS1.p7.2.m2.1.1.3.cmml" xref="S3.SS2.SSS1.p7.2.m2.1.1.3">𝑅</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS1.p7.2.m2.1c">w_{R}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS1.p7.2.m2.1d">italic_w start_POSTSUBSCRIPT italic_R end_POSTSUBSCRIPT</annotation></semantics></math> :</p>
<table class="ltx_equation ltx_eqn_table" id="S3.E14">
<tbody><tr class="ltx_equation ltx_eqn_row ltx_align_baseline">
<td class="ltx_eqn_cell ltx_eqn_eqno ltx_align_middle ltx_align_left" rowspan="1"><span class="ltx_tag ltx_tag_equation ltx_align_left">(14)</span></td>
<td class="ltx_eqn_cell ltx_eqn_center_padleft"></td>
<td class="ltx_eqn_cell ltx_align_center"><math alttext="w_{R}=\sum_{k=1}^{K}\alpha_{k}\cdot x_{k},\quad s_{k}\in\mathcal{S}(x_{z})," class="ltx_Math" display="block" id="S3.E14.m1.1"><semantics id="S3.E14.m1.1a"><mrow id="S3.E14.m1.1.1.1"><mrow id="S3.E14.m1.1.1.1.1.2" xref="S3.E14.m1.1.1.1.1.3.cmml"><mrow id="S3.E14.m1.1.1.1.1.1.1" xref="S3.E14.m1.1.1.1.1.1.1.cmml"><msub id="S3.E14.m1.1.1.1.1.1.1.2" xref="S3.E14.m1.1.1.1.1.1.1.2.cmml"><mi id="S3.E14.m1.1.1.1.1.1.1.2.2" xref="S3.E14.m1.1.1.1.1.1.1.2.2.cmml">w</mi><mi id="S3.E14.m1.1.1.1.1.1.1.2.3" xref="S3.E14.m1.1.1.1.1.1.1.2.3.cmml">R</mi></msub><mo id="S3.E14.m1.1.1.1.1.1.1.1" rspace="0.111em" xref="S3.E14.m1.1.1.1.1.1.1.1.cmml">=</mo><mrow id="S3.E14.m1.1.1.1.1.1.1.3" xref="S3.E14.m1.1.1.1.1.1.1.3.cmml"><munderover id="S3.E14.m1.1.1.1.1.1.1.3.1" xref="S3.E14.m1.1.1.1.1.1.1.3.1.cmml"><mo id="S3.E14.m1.1.1.1.1.1.1.3.1.2.2" movablelimits="false" xref="S3.E14.m1.1.1.1.1.1.1.3.1.2.2.cmml">∑</mo><mrow id="S3.E14.m1.1.1.1.1.1.1.3.1.2.3" xref="S3.E14.m1.1.1.1.1.1.1.3.1.2.3.cmml"><mi id="S3.E14.m1.1.1.1.1.1.1.3.1.2.3.2" xref="S3.E14.m1.1.1.1.1.1.1.3.1.2.3.2.cmml">k</mi><mo id="S3.E14.m1.1.1.1.1.1.1.3.1.2.3.1" xref="S3.E14.m1.1.1.1.1.1.1.3.1.2.3.1.cmml">=</mo><mn id="S3.E14.m1.1.1.1.1.1.1.3.1.2.3.3" xref="S3.E14.m1.1.1.1.1.1.1.3.1.2.3.3.cmml">1</mn></mrow><mi id="S3.E14.m1.1.1.1.1.1.1.3.1.3" xref="S3.E14.m1.1.1.1.1.1.1.3.1.3.cmml">K</mi></munderover><mrow id="S3.E14.m1.1.1.1.1.1.1.3.2" xref="S3.E14.m1.1.1.1.1.1.1.3.2.cmml"><msub id="S3.E14.m1.1.1.1.1.1.1.3.2.2" xref="S3.E14.m1.1.1.1.1.1.1.3.2.2.cmml"><mi id="S3.E14.m1.1.1.1.1.1.1.3.2.2.2" xref="S3.E14.m1.1.1.1.1.1.1.3.2.2.2.cmml">α</mi><mi id="S3.E14.m1.1.1.1.1.1.1.3.2.2.3" xref="S3.E14.m1.1.1.1.1.1.1.3.2.2.3.cmml">k</mi></msub><mo id="S3.E14.m1.1.1.1.1.1.1.3.2.1" lspace="0.222em" rspace="0.222em" xref="S3.E14.m1.1.1.1.1.1.1.3.2.1.cmml">⋅</mo><msub id="S3.E14.m1.1.1.1.1.1.1.3.2.3" xref="S3.E14.m1.1.1.1.1.1.1.3.2.3.cmml"><mi id="S3.E14.m1.1.1.1.1.1.1.3.2.3.2" xref="S3.E14.m1.1.1.1.1.1.1.3.2.3.2.cmml">x</mi><mi id="S3.E14.m1.1.1.1.1.1.1.3.2.3.3" xref="S3.E14.m1.1.1.1.1.1.1.3.2.3.3.cmml">k</mi></msub></mrow></mrow></mrow><mo id="S3.E14.m1.1.1.1.1.2.3" rspace="1.167em" xref="S3.E14.m1.1.1.1.1.3a.cmml">,</mo><mrow id="S3.E14.m1.1.1.1.1.2.2" xref="S3.E14.m1.1.1.1.1.2.2.cmml"><msub id="S3.E14.m1.1.1.1.1.2.2.3" xref="S3.E14.m1.1.1.1.1.2.2.3.cmml"><mi id="S3.E14.m1.1.1.1.1.2.2.3.2" xref="S3.E14.m1.1.1.1.1.2.2.3.2.cmml">s</mi><mi id="S3.E14.m1.1.1.1.1.2.2.3.3" xref="S3.E14.m1.1.1.1.1.2.2.3.3.cmml">k</mi></msub><mo id="S3.E14.m1.1.1.1.1.2.2.2" xref="S3.E14.m1.1.1.1.1.2.2.2.cmml">∈</mo><mrow id="S3.E14.m1.1.1.1.1.2.2.1" xref="S3.E14.m1.1.1.1.1.2.2.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.E14.m1.1.1.1.1.2.2.1.3" xref="S3.E14.m1.1.1.1.1.2.2.1.3.cmml">𝒮</mi><mo id="S3.E14.m1.1.1.1.1.2.2.1.2" xref="S3.E14.m1.1.1.1.1.2.2.1.2.cmml">⁢</mo><mrow id="S3.E14.m1.1.1.1.1.2.2.1.1.1" xref="S3.E14.m1.1.1.1.1.2.2.1.1.1.1.cmml"><mo id="S3.E14.m1.1.1.1.1.2.2.1.1.1.2" stretchy="false" xref="S3.E14.m1.1.1.1.1.2.2.1.1.1.1.cmml">(</mo><msub id="S3.E14.m1.1.1.1.1.2.2.1.1.1.1" xref="S3.E14.m1.1.1.1.1.2.2.1.1.1.1.cmml"><mi id="S3.E14.m1.1.1.1.1.2.2.1.1.1.1.2" xref="S3.E14.m1.1.1.1.1.2.2.1.1.1.1.2.cmml">x</mi><mi id="S3.E14.m1.1.1.1.1.2.2.1.1.1.1.3" xref="S3.E14.m1.1.1.1.1.2.2.1.1.1.1.3.cmml">z</mi></msub><mo id="S3.E14.m1.1.1.1.1.2.2.1.1.1.3" stretchy="false" xref="S3.E14.m1.1.1.1.1.2.2.1.1.1.1.cmml">)</mo></mrow></mrow></mrow></mrow><mo id="S3.E14.m1.1.1.1.2">,</mo></mrow><annotation-xml encoding="MathML-Content" id="S3.E14.m1.1b"><apply id="S3.E14.m1.1.1.1.1.3.cmml" xref="S3.E14.m1.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.E14.m1.1.1.1.1.3a.cmml" xref="S3.E14.m1.1.1.1.1.2.3">formulae-sequence</csymbol><apply id="S3.E14.m1.1.1.1.1.1.1.cmml" xref="S3.E14.m1.1.1.1.1.1.1"><eq id="S3.E14.m1.1.1.1.1.1.1.1.cmml" xref="S3.E14.m1.1.1.1.1.1.1.1"></eq><apply id="S3.E14.m1.1.1.1.1.1.1.2.cmml" xref="S3.E14.m1.1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.E14.m1.1.1.1.1.1.1.2.1.cmml" xref="S3.E14.m1.1.1.1.1.1.1.2">subscript</csymbol><ci id="S3.E14.m1.1.1.1.1.1.1.2.2.cmml" xref="S3.E14.m1.1.1.1.1.1.1.2.2">𝑤</ci><ci id="S3.E14.m1.1.1.1.1.1.1.2.3.cmml" xref="S3.E14.m1.1.1.1.1.1.1.2.3">𝑅</ci></apply><apply id="S3.E14.m1.1.1.1.1.1.1.3.cmml" xref="S3.E14.m1.1.1.1.1.1.1.3"><apply id="S3.E14.m1.1.1.1.1.1.1.3.1.cmml" xref="S3.E14.m1.1.1.1.1.1.1.3.1"><csymbol cd="ambiguous" id="S3.E14.m1.1.1.1.1.1.1.3.1.1.cmml" xref="S3.E14.m1.1.1.1.1.1.1.3.1">superscript</csymbol><apply id="S3.E14.m1.1.1.1.1.1.1.3.1.2.cmml" xref="S3.E14.m1.1.1.1.1.1.1.3.1"><csymbol cd="ambiguous" id="S3.E14.m1.1.1.1.1.1.1.3.1.2.1.cmml" xref="S3.E14.m1.1.1.1.1.1.1.3.1">subscript</csymbol><sum id="S3.E14.m1.1.1.1.1.1.1.3.1.2.2.cmml" xref="S3.E14.m1.1.1.1.1.1.1.3.1.2.2"></sum><apply id="S3.E14.m1.1.1.1.1.1.1.3.1.2.3.cmml" xref="S3.E14.m1.1.1.1.1.1.1.3.1.2.3"><eq id="S3.E14.m1.1.1.1.1.1.1.3.1.2.3.1.cmml" xref="S3.E14.m1.1.1.1.1.1.1.3.1.2.3.1"></eq><ci id="S3.E14.m1.1.1.1.1.1.1.3.1.2.3.2.cmml" xref="S3.E14.m1.1.1.1.1.1.1.3.1.2.3.2">𝑘</ci><cn id="S3.E14.m1.1.1.1.1.1.1.3.1.2.3.3.cmml" type="integer" xref="S3.E14.m1.1.1.1.1.1.1.3.1.2.3.3">1</cn></apply></apply><ci id="S3.E14.m1.1.1.1.1.1.1.3.1.3.cmml" xref="S3.E14.m1.1.1.1.1.1.1.3.1.3">𝐾</ci></apply><apply id="S3.E14.m1.1.1.1.1.1.1.3.2.cmml" xref="S3.E14.m1.1.1.1.1.1.1.3.2"><ci id="S3.E14.m1.1.1.1.1.1.1.3.2.1.cmml" xref="S3.E14.m1.1.1.1.1.1.1.3.2.1">⋅</ci><apply id="S3.E14.m1.1.1.1.1.1.1.3.2.2.cmml" xref="S3.E14.m1.1.1.1.1.1.1.3.2.2"><csymbol cd="ambiguous" id="S3.E14.m1.1.1.1.1.1.1.3.2.2.1.cmml" xref="S3.E14.m1.1.1.1.1.1.1.3.2.2">subscript</csymbol><ci id="S3.E14.m1.1.1.1.1.1.1.3.2.2.2.cmml" xref="S3.E14.m1.1.1.1.1.1.1.3.2.2.2">𝛼</ci><ci id="S3.E14.m1.1.1.1.1.1.1.3.2.2.3.cmml" xref="S3.E14.m1.1.1.1.1.1.1.3.2.2.3">𝑘</ci></apply><apply id="S3.E14.m1.1.1.1.1.1.1.3.2.3.cmml" xref="S3.E14.m1.1.1.1.1.1.1.3.2.3"><csymbol cd="ambiguous" id="S3.E14.m1.1.1.1.1.1.1.3.2.3.1.cmml" xref="S3.E14.m1.1.1.1.1.1.1.3.2.3">subscript</csymbol><ci id="S3.E14.m1.1.1.1.1.1.1.3.2.3.2.cmml" xref="S3.E14.m1.1.1.1.1.1.1.3.2.3.2">𝑥</ci><ci id="S3.E14.m1.1.1.1.1.1.1.3.2.3.3.cmml" xref="S3.E14.m1.1.1.1.1.1.1.3.2.3.3">𝑘</ci></apply></apply></apply></apply><apply id="S3.E14.m1.1.1.1.1.2.2.cmml" xref="S3.E14.m1.1.1.1.1.2.2"><in id="S3.E14.m1.1.1.1.1.2.2.2.cmml" xref="S3.E14.m1.1.1.1.1.2.2.2"></in><apply id="S3.E14.m1.1.1.1.1.2.2.3.cmml" xref="S3.E14.m1.1.1.1.1.2.2.3"><csymbol cd="ambiguous" id="S3.E14.m1.1.1.1.1.2.2.3.1.cmml" xref="S3.E14.m1.1.1.1.1.2.2.3">subscript</csymbol><ci id="S3.E14.m1.1.1.1.1.2.2.3.2.cmml" xref="S3.E14.m1.1.1.1.1.2.2.3.2">𝑠</ci><ci id="S3.E14.m1.1.1.1.1.2.2.3.3.cmml" xref="S3.E14.m1.1.1.1.1.2.2.3.3">𝑘</ci></apply><apply id="S3.E14.m1.1.1.1.1.2.2.1.cmml" xref="S3.E14.m1.1.1.1.1.2.2.1"><times id="S3.E14.m1.1.1.1.1.2.2.1.2.cmml" xref="S3.E14.m1.1.1.1.1.2.2.1.2"></times><ci id="S3.E14.m1.1.1.1.1.2.2.1.3.cmml" xref="S3.E14.m1.1.1.1.1.2.2.1.3">𝒮</ci><apply id="S3.E14.m1.1.1.1.1.2.2.1.1.1.1.cmml" xref="S3.E14.m1.1.1.1.1.2.2.1.1.1"><csymbol cd="ambiguous" id="S3.E14.m1.1.1.1.1.2.2.1.1.1.1.1.cmml" xref="S3.E14.m1.1.1.1.1.2.2.1.1.1">subscript</csymbol><ci id="S3.E14.m1.1.1.1.1.2.2.1.1.1.1.2.cmml" xref="S3.E14.m1.1.1.1.1.2.2.1.1.1.1.2">𝑥</ci><ci id="S3.E14.m1.1.1.1.1.2.2.1.1.1.1.3.cmml" xref="S3.E14.m1.1.1.1.1.2.2.1.1.1.1.3">𝑧</ci></apply></apply></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.E14.m1.1c">w_{R}=\sum_{k=1}^{K}\alpha_{k}\cdot x_{k},\quad s_{k}\in\mathcal{S}(x_{z}),</annotation><annotation encoding="application/x-llamapun" id="S3.E14.m1.1d">italic_w start_POSTSUBSCRIPT italic_R end_POSTSUBSCRIPT = ∑ start_POSTSUBSCRIPT italic_k = 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_K end_POSTSUPERSCRIPT italic_α start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT ⋅ italic_x start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT , italic_s start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT ∈ caligraphic_S ( italic_x start_POSTSUBSCRIPT italic_z end_POSTSUBSCRIPT ) ,</annotation></semantics></math></td>
<td class="ltx_eqn_cell ltx_eqn_center_padright"></td>
</tr></tbody>
</table>
<p class="ltx_p" id="S3.SS2.SSS1.p7.3">where <math alttext="w_{s}" class="ltx_Math" display="inline" id="S3.SS2.SSS1.p7.3.m1.1"><semantics id="S3.SS2.SSS1.p7.3.m1.1a"><msub id="S3.SS2.SSS1.p7.3.m1.1.1" xref="S3.SS2.SSS1.p7.3.m1.1.1.cmml"><mi id="S3.SS2.SSS1.p7.3.m1.1.1.2" xref="S3.SS2.SSS1.p7.3.m1.1.1.2.cmml">w</mi><mi id="S3.SS2.SSS1.p7.3.m1.1.1.3" xref="S3.SS2.SSS1.p7.3.m1.1.1.3.cmml">s</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS1.p7.3.m1.1b"><apply id="S3.SS2.SSS1.p7.3.m1.1.1.cmml" xref="S3.SS2.SSS1.p7.3.m1.1.1"><csymbol cd="ambiguous" id="S3.SS2.SSS1.p7.3.m1.1.1.1.cmml" xref="S3.SS2.SSS1.p7.3.m1.1.1">subscript</csymbol><ci id="S3.SS2.SSS1.p7.3.m1.1.1.2.cmml" xref="S3.SS2.SSS1.p7.3.m1.1.1.2">𝑤</ci><ci id="S3.SS2.SSS1.p7.3.m1.1.1.3.cmml" xref="S3.SS2.SSS1.p7.3.m1.1.1.3">𝑠</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS1.p7.3.m1.1c">w_{s}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS1.p7.3.m1.1d">italic_w start_POSTSUBSCRIPT italic_s end_POSTSUBSCRIPT</annotation></semantics></math> is the input of the aggregation layer of the teacher network.</p>
</div>
<div class="ltx_para ltx_noindent" id="S3.SS2.SSS1.p8">
<p class="ltx_p" id="S3.SS2.SSS1.p8.5"><span class="ltx_text ltx_font_bold" id="S3.SS2.SSS1.p8.5.1">Teacher Network.</span> The teacher network is a Retrieval Framework that does not include the original model. From Figure <a class="ltx_ref" href="https://arxiv.org/html/2404.15678v4#S3.F3" title="Figure 3 ‣ 3. The RAD Paradigm ‣ Retrieval and Distill: A Temporal Data Shift-Free Paradigm for Online Recommendation System"><span class="ltx_text ltx_ref_tag">3</span></a>, we can observe that the teacher network forms the right portion of the diagram.
The teacher network serves as an intermediary bridge for training the relevance network.
The teacher network takes <math alttext="x_{z}" class="ltx_Math" display="inline" id="S3.SS2.SSS1.p8.1.m1.1"><semantics id="S3.SS2.SSS1.p8.1.m1.1a"><msub id="S3.SS2.SSS1.p8.1.m1.1.1" xref="S3.SS2.SSS1.p8.1.m1.1.1.cmml"><mi id="S3.SS2.SSS1.p8.1.m1.1.1.2" xref="S3.SS2.SSS1.p8.1.m1.1.1.2.cmml">x</mi><mi id="S3.SS2.SSS1.p8.1.m1.1.1.3" xref="S3.SS2.SSS1.p8.1.m1.1.1.3.cmml">z</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS1.p8.1.m1.1b"><apply id="S3.SS2.SSS1.p8.1.m1.1.1.cmml" xref="S3.SS2.SSS1.p8.1.m1.1.1"><csymbol cd="ambiguous" id="S3.SS2.SSS1.p8.1.m1.1.1.1.cmml" xref="S3.SS2.SSS1.p8.1.m1.1.1">subscript</csymbol><ci id="S3.SS2.SSS1.p8.1.m1.1.1.2.cmml" xref="S3.SS2.SSS1.p8.1.m1.1.1.2">𝑥</ci><ci id="S3.SS2.SSS1.p8.1.m1.1.1.3.cmml" xref="S3.SS2.SSS1.p8.1.m1.1.1.3">𝑧</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS1.p8.1.m1.1c">x_{z}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS1.p8.1.m1.1d">italic_x start_POSTSUBSCRIPT italic_z end_POSTSUBSCRIPT</annotation></semantics></math> and the relevance network output as inputs, producing a probability as output.
Drawing inspiration from RIM <cite class="ltx_cite ltx_citemacro_citep">(Qin et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2404.15678v4#bib.bib26" title="">2021</a>)</cite>, we incorporate a factorization machine module within the aggregation layer of the teacher network.
This aggregation layer is designed to effectively merge the input <math alttext="x_{z}" class="ltx_Math" display="inline" id="S3.SS2.SSS1.p8.2.m2.1"><semantics id="S3.SS2.SSS1.p8.2.m2.1a"><msub id="S3.SS2.SSS1.p8.2.m2.1.1" xref="S3.SS2.SSS1.p8.2.m2.1.1.cmml"><mi id="S3.SS2.SSS1.p8.2.m2.1.1.2" xref="S3.SS2.SSS1.p8.2.m2.1.1.2.cmml">x</mi><mi id="S3.SS2.SSS1.p8.2.m2.1.1.3" xref="S3.SS2.SSS1.p8.2.m2.1.1.3.cmml">z</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS1.p8.2.m2.1b"><apply id="S3.SS2.SSS1.p8.2.m2.1.1.cmml" xref="S3.SS2.SSS1.p8.2.m2.1.1"><csymbol cd="ambiguous" id="S3.SS2.SSS1.p8.2.m2.1.1.1.cmml" xref="S3.SS2.SSS1.p8.2.m2.1.1">subscript</csymbol><ci id="S3.SS2.SSS1.p8.2.m2.1.1.2.cmml" xref="S3.SS2.SSS1.p8.2.m2.1.1.2">𝑥</ci><ci id="S3.SS2.SSS1.p8.2.m2.1.1.3.cmml" xref="S3.SS2.SSS1.p8.2.m2.1.1.3">𝑧</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS1.p8.2.m2.1c">x_{z}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS1.p8.2.m2.1d">italic_x start_POSTSUBSCRIPT italic_z end_POSTSUBSCRIPT</annotation></semantics></math> with the aggregated <math alttext="w_{R}" class="ltx_Math" display="inline" id="S3.SS2.SSS1.p8.3.m3.1"><semantics id="S3.SS2.SSS1.p8.3.m3.1a"><msub id="S3.SS2.SSS1.p8.3.m3.1.1" xref="S3.SS2.SSS1.p8.3.m3.1.1.cmml"><mi id="S3.SS2.SSS1.p8.3.m3.1.1.2" xref="S3.SS2.SSS1.p8.3.m3.1.1.2.cmml">w</mi><mi id="S3.SS2.SSS1.p8.3.m3.1.1.3" xref="S3.SS2.SSS1.p8.3.m3.1.1.3.cmml">R</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS1.p8.3.m3.1b"><apply id="S3.SS2.SSS1.p8.3.m3.1.1.cmml" xref="S3.SS2.SSS1.p8.3.m3.1.1"><csymbol cd="ambiguous" id="S3.SS2.SSS1.p8.3.m3.1.1.1.cmml" xref="S3.SS2.SSS1.p8.3.m3.1.1">subscript</csymbol><ci id="S3.SS2.SSS1.p8.3.m3.1.1.2.cmml" xref="S3.SS2.SSS1.p8.3.m3.1.1.2">𝑤</ci><ci id="S3.SS2.SSS1.p8.3.m3.1.1.3.cmml" xref="S3.SS2.SSS1.p8.3.m3.1.1.3">𝑅</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS1.p8.3.m3.1c">w_{R}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS1.p8.3.m3.1d">italic_w start_POSTSUBSCRIPT italic_R end_POSTSUBSCRIPT</annotation></semantics></math>, thus improving the teacher network’s capability to discover the hidden relationships between <math alttext="x_{z}" class="ltx_Math" display="inline" id="S3.SS2.SSS1.p8.4.m4.1"><semantics id="S3.SS2.SSS1.p8.4.m4.1a"><msub id="S3.SS2.SSS1.p8.4.m4.1.1" xref="S3.SS2.SSS1.p8.4.m4.1.1.cmml"><mi id="S3.SS2.SSS1.p8.4.m4.1.1.2" xref="S3.SS2.SSS1.p8.4.m4.1.1.2.cmml">x</mi><mi id="S3.SS2.SSS1.p8.4.m4.1.1.3" xref="S3.SS2.SSS1.p8.4.m4.1.1.3.cmml">z</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS1.p8.4.m4.1b"><apply id="S3.SS2.SSS1.p8.4.m4.1.1.cmml" xref="S3.SS2.SSS1.p8.4.m4.1.1"><csymbol cd="ambiguous" id="S3.SS2.SSS1.p8.4.m4.1.1.1.cmml" xref="S3.SS2.SSS1.p8.4.m4.1.1">subscript</csymbol><ci id="S3.SS2.SSS1.p8.4.m4.1.1.2.cmml" xref="S3.SS2.SSS1.p8.4.m4.1.1.2">𝑥</ci><ci id="S3.SS2.SSS1.p8.4.m4.1.1.3.cmml" xref="S3.SS2.SSS1.p8.4.m4.1.1.3">𝑧</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS1.p8.4.m4.1c">x_{z}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS1.p8.4.m4.1d">italic_x start_POSTSUBSCRIPT italic_z end_POSTSUBSCRIPT</annotation></semantics></math> and the returned <math alttext="S(x_{z})" class="ltx_Math" display="inline" id="S3.SS2.SSS1.p8.5.m5.1"><semantics id="S3.SS2.SSS1.p8.5.m5.1a"><mrow id="S3.SS2.SSS1.p8.5.m5.1.1" xref="S3.SS2.SSS1.p8.5.m5.1.1.cmml"><mi id="S3.SS2.SSS1.p8.5.m5.1.1.3" xref="S3.SS2.SSS1.p8.5.m5.1.1.3.cmml">S</mi><mo id="S3.SS2.SSS1.p8.5.m5.1.1.2" xref="S3.SS2.SSS1.p8.5.m5.1.1.2.cmml">⁢</mo><mrow id="S3.SS2.SSS1.p8.5.m5.1.1.1.1" xref="S3.SS2.SSS1.p8.5.m5.1.1.1.1.1.cmml"><mo id="S3.SS2.SSS1.p8.5.m5.1.1.1.1.2" stretchy="false" xref="S3.SS2.SSS1.p8.5.m5.1.1.1.1.1.cmml">(</mo><msub id="S3.SS2.SSS1.p8.5.m5.1.1.1.1.1" xref="S3.SS2.SSS1.p8.5.m5.1.1.1.1.1.cmml"><mi id="S3.SS2.SSS1.p8.5.m5.1.1.1.1.1.2" xref="S3.SS2.SSS1.p8.5.m5.1.1.1.1.1.2.cmml">x</mi><mi id="S3.SS2.SSS1.p8.5.m5.1.1.1.1.1.3" xref="S3.SS2.SSS1.p8.5.m5.1.1.1.1.1.3.cmml">z</mi></msub><mo id="S3.SS2.SSS1.p8.5.m5.1.1.1.1.3" stretchy="false" xref="S3.SS2.SSS1.p8.5.m5.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS1.p8.5.m5.1b"><apply id="S3.SS2.SSS1.p8.5.m5.1.1.cmml" xref="S3.SS2.SSS1.p8.5.m5.1.1"><times id="S3.SS2.SSS1.p8.5.m5.1.1.2.cmml" xref="S3.SS2.SSS1.p8.5.m5.1.1.2"></times><ci id="S3.SS2.SSS1.p8.5.m5.1.1.3.cmml" xref="S3.SS2.SSS1.p8.5.m5.1.1.3">𝑆</ci><apply id="S3.SS2.SSS1.p8.5.m5.1.1.1.1.1.cmml" xref="S3.SS2.SSS1.p8.5.m5.1.1.1.1"><csymbol cd="ambiguous" id="S3.SS2.SSS1.p8.5.m5.1.1.1.1.1.1.cmml" xref="S3.SS2.SSS1.p8.5.m5.1.1.1.1">subscript</csymbol><ci id="S3.SS2.SSS1.p8.5.m5.1.1.1.1.1.2.cmml" xref="S3.SS2.SSS1.p8.5.m5.1.1.1.1.1.2">𝑥</ci><ci id="S3.SS2.SSS1.p8.5.m5.1.1.1.1.1.3.cmml" xref="S3.SS2.SSS1.p8.5.m5.1.1.1.1.1.3">𝑧</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS1.p8.5.m5.1c">S(x_{z})</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS1.p8.5.m5.1d">italic_S ( italic_x start_POSTSUBSCRIPT italic_z end_POSTSUBSCRIPT )</annotation></semantics></math> from the search engine.</p>
</div>
</section>
<section class="ltx_subsubsection" id="S3.SS2.SSS2">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">3.2.2. </span>Pretrain with Shifting Data</h4>
<div class="ltx_para" id="S3.SS2.SSS2.p1">
<p class="ltx_p" id="S3.SS2.SSS2.p1.5">The relevance network models the probability distribution <math alttext="P(w_{R}|x)" class="ltx_Math" display="inline" id="S3.SS2.SSS2.p1.1.m1.1"><semantics id="S3.SS2.SSS2.p1.1.m1.1a"><mrow id="S3.SS2.SSS2.p1.1.m1.1.1" xref="S3.SS2.SSS2.p1.1.m1.1.1.cmml"><mi id="S3.SS2.SSS2.p1.1.m1.1.1.3" xref="S3.SS2.SSS2.p1.1.m1.1.1.3.cmml">P</mi><mo id="S3.SS2.SSS2.p1.1.m1.1.1.2" xref="S3.SS2.SSS2.p1.1.m1.1.1.2.cmml">⁢</mo><mrow id="S3.SS2.SSS2.p1.1.m1.1.1.1.1" xref="S3.SS2.SSS2.p1.1.m1.1.1.1.1.1.cmml"><mo id="S3.SS2.SSS2.p1.1.m1.1.1.1.1.2" stretchy="false" xref="S3.SS2.SSS2.p1.1.m1.1.1.1.1.1.cmml">(</mo><mrow id="S3.SS2.SSS2.p1.1.m1.1.1.1.1.1" xref="S3.SS2.SSS2.p1.1.m1.1.1.1.1.1.cmml"><msub id="S3.SS2.SSS2.p1.1.m1.1.1.1.1.1.2" xref="S3.SS2.SSS2.p1.1.m1.1.1.1.1.1.2.cmml"><mi id="S3.SS2.SSS2.p1.1.m1.1.1.1.1.1.2.2" xref="S3.SS2.SSS2.p1.1.m1.1.1.1.1.1.2.2.cmml">w</mi><mi id="S3.SS2.SSS2.p1.1.m1.1.1.1.1.1.2.3" xref="S3.SS2.SSS2.p1.1.m1.1.1.1.1.1.2.3.cmml">R</mi></msub><mo fence="false" id="S3.SS2.SSS2.p1.1.m1.1.1.1.1.1.1" xref="S3.SS2.SSS2.p1.1.m1.1.1.1.1.1.1.cmml">|</mo><mi id="S3.SS2.SSS2.p1.1.m1.1.1.1.1.1.3" xref="S3.SS2.SSS2.p1.1.m1.1.1.1.1.1.3.cmml">x</mi></mrow><mo id="S3.SS2.SSS2.p1.1.m1.1.1.1.1.3" stretchy="false" xref="S3.SS2.SSS2.p1.1.m1.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS2.p1.1.m1.1b"><apply id="S3.SS2.SSS2.p1.1.m1.1.1.cmml" xref="S3.SS2.SSS2.p1.1.m1.1.1"><times id="S3.SS2.SSS2.p1.1.m1.1.1.2.cmml" xref="S3.SS2.SSS2.p1.1.m1.1.1.2"></times><ci id="S3.SS2.SSS2.p1.1.m1.1.1.3.cmml" xref="S3.SS2.SSS2.p1.1.m1.1.1.3">𝑃</ci><apply id="S3.SS2.SSS2.p1.1.m1.1.1.1.1.1.cmml" xref="S3.SS2.SSS2.p1.1.m1.1.1.1.1"><csymbol cd="latexml" id="S3.SS2.SSS2.p1.1.m1.1.1.1.1.1.1.cmml" xref="S3.SS2.SSS2.p1.1.m1.1.1.1.1.1.1">conditional</csymbol><apply id="S3.SS2.SSS2.p1.1.m1.1.1.1.1.1.2.cmml" xref="S3.SS2.SSS2.p1.1.m1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.SS2.SSS2.p1.1.m1.1.1.1.1.1.2.1.cmml" xref="S3.SS2.SSS2.p1.1.m1.1.1.1.1.1.2">subscript</csymbol><ci id="S3.SS2.SSS2.p1.1.m1.1.1.1.1.1.2.2.cmml" xref="S3.SS2.SSS2.p1.1.m1.1.1.1.1.1.2.2">𝑤</ci><ci id="S3.SS2.SSS2.p1.1.m1.1.1.1.1.1.2.3.cmml" xref="S3.SS2.SSS2.p1.1.m1.1.1.1.1.1.2.3">𝑅</ci></apply><ci id="S3.SS2.SSS2.p1.1.m1.1.1.1.1.1.3.cmml" xref="S3.SS2.SSS2.p1.1.m1.1.1.1.1.1.3">𝑥</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS2.p1.1.m1.1c">P(w_{R}|x)</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS2.p1.1.m1.1d">italic_P ( italic_w start_POSTSUBSCRIPT italic_R end_POSTSUBSCRIPT | italic_x )</annotation></semantics></math>, where <math alttext="w_{R}" class="ltx_Math" display="inline" id="S3.SS2.SSS2.p1.2.m2.1"><semantics id="S3.SS2.SSS2.p1.2.m2.1a"><msub id="S3.SS2.SSS2.p1.2.m2.1.1" xref="S3.SS2.SSS2.p1.2.m2.1.1.cmml"><mi id="S3.SS2.SSS2.p1.2.m2.1.1.2" xref="S3.SS2.SSS2.p1.2.m2.1.1.2.cmml">w</mi><mi id="S3.SS2.SSS2.p1.2.m2.1.1.3" xref="S3.SS2.SSS2.p1.2.m2.1.1.3.cmml">R</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS2.p1.2.m2.1b"><apply id="S3.SS2.SSS2.p1.2.m2.1.1.cmml" xref="S3.SS2.SSS2.p1.2.m2.1.1"><csymbol cd="ambiguous" id="S3.SS2.SSS2.p1.2.m2.1.1.1.cmml" xref="S3.SS2.SSS2.p1.2.m2.1.1">subscript</csymbol><ci id="S3.SS2.SSS2.p1.2.m2.1.1.2.cmml" xref="S3.SS2.SSS2.p1.2.m2.1.1.2">𝑤</ci><ci id="S3.SS2.SSS2.p1.2.m2.1.1.3.cmml" xref="S3.SS2.SSS2.p1.2.m2.1.1.3">𝑅</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS2.p1.2.m2.1c">w_{R}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS2.p1.2.m2.1d">italic_w start_POSTSUBSCRIPT italic_R end_POSTSUBSCRIPT</annotation></semantics></math> is the logit representation of <math alttext="x_{s}" class="ltx_Math" display="inline" id="S3.SS2.SSS2.p1.3.m3.1"><semantics id="S3.SS2.SSS2.p1.3.m3.1a"><msub id="S3.SS2.SSS2.p1.3.m3.1.1" xref="S3.SS2.SSS2.p1.3.m3.1.1.cmml"><mi id="S3.SS2.SSS2.p1.3.m3.1.1.2" xref="S3.SS2.SSS2.p1.3.m3.1.1.2.cmml">x</mi><mi id="S3.SS2.SSS2.p1.3.m3.1.1.3" xref="S3.SS2.SSS2.p1.3.m3.1.1.3.cmml">s</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS2.p1.3.m3.1b"><apply id="S3.SS2.SSS2.p1.3.m3.1.1.cmml" xref="S3.SS2.SSS2.p1.3.m3.1.1"><csymbol cd="ambiguous" id="S3.SS2.SSS2.p1.3.m3.1.1.1.cmml" xref="S3.SS2.SSS2.p1.3.m3.1.1">subscript</csymbol><ci id="S3.SS2.SSS2.p1.3.m3.1.1.2.cmml" xref="S3.SS2.SSS2.p1.3.m3.1.1.2">𝑥</ci><ci id="S3.SS2.SSS2.p1.3.m3.1.1.3.cmml" xref="S3.SS2.SSS2.p1.3.m3.1.1.3">𝑠</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS2.p1.3.m3.1c">x_{s}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS2.p1.3.m3.1d">italic_x start_POSTSUBSCRIPT italic_s end_POSTSUBSCRIPT</annotation></semantics></math>. As established by theorem <a class="ltx_ref" href="https://arxiv.org/html/2404.15678v4#S2.Thmtheorem1" title="Theorem 2.1. ‣ 2. PRELIMINARIES ‣ Retrieval and Distill: A Temporal Data Shift-Free Paradigm for Online Recommendation System"><span class="ltx_text ltx_ref_tag">2.1</span></a>, the probability distribution represented by the relevance network is time-invariant, which allows us to pretrain it using shifting data.
To obtain the relevance network, we initialize a separate teacher network. The teacher network is trained using the dataset <math alttext="\mathcal{D}_{\text{shifting}}" class="ltx_Math" display="inline" id="S3.SS2.SSS2.p1.4.m4.1"><semantics id="S3.SS2.SSS2.p1.4.m4.1a"><msub id="S3.SS2.SSS2.p1.4.m4.1.1" xref="S3.SS2.SSS2.p1.4.m4.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS2.SSS2.p1.4.m4.1.1.2" xref="S3.SS2.SSS2.p1.4.m4.1.1.2.cmml">𝒟</mi><mtext id="S3.SS2.SSS2.p1.4.m4.1.1.3" xref="S3.SS2.SSS2.p1.4.m4.1.1.3a.cmml">shifting</mtext></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS2.p1.4.m4.1b"><apply id="S3.SS2.SSS2.p1.4.m4.1.1.cmml" xref="S3.SS2.SSS2.p1.4.m4.1.1"><csymbol cd="ambiguous" id="S3.SS2.SSS2.p1.4.m4.1.1.1.cmml" xref="S3.SS2.SSS2.p1.4.m4.1.1">subscript</csymbol><ci id="S3.SS2.SSS2.p1.4.m4.1.1.2.cmml" xref="S3.SS2.SSS2.p1.4.m4.1.1.2">𝒟</ci><ci id="S3.SS2.SSS2.p1.4.m4.1.1.3a.cmml" xref="S3.SS2.SSS2.p1.4.m4.1.1.3"><mtext id="S3.SS2.SSS2.p1.4.m4.1.1.3.cmml" mathsize="70%" xref="S3.SS2.SSS2.p1.4.m4.1.1.3">shifting</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS2.p1.4.m4.1c">\mathcal{D}_{\text{shifting}}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS2.p1.4.m4.1d">caligraphic_D start_POSTSUBSCRIPT shifting end_POSTSUBSCRIPT</annotation></semantics></math> and with loss function  (<a class="ltx_ref" href="https://arxiv.org/html/2404.15678v4#S2.E3" title="In 2. PRELIMINARIES ‣ Retrieval and Distill: A Temporal Data Shift-Free Paradigm for Online Recommendation System"><span class="ltx_text ltx_ref_tag">3</span></a>).
Although the separate teacher network trained in this manner performs poorly on the test set <math alttext="\mathcal{D}_{\text{test}}" class="ltx_Math" display="inline" id="S3.SS2.SSS2.p1.5.m5.1"><semantics id="S3.SS2.SSS2.p1.5.m5.1a"><msub id="S3.SS2.SSS2.p1.5.m5.1.1" xref="S3.SS2.SSS2.p1.5.m5.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS2.SSS2.p1.5.m5.1.1.2" xref="S3.SS2.SSS2.p1.5.m5.1.1.2.cmml">𝒟</mi><mtext id="S3.SS2.SSS2.p1.5.m5.1.1.3" xref="S3.SS2.SSS2.p1.5.m5.1.1.3a.cmml">test</mtext></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS2.p1.5.m5.1b"><apply id="S3.SS2.SSS2.p1.5.m5.1.1.cmml" xref="S3.SS2.SSS2.p1.5.m5.1.1"><csymbol cd="ambiguous" id="S3.SS2.SSS2.p1.5.m5.1.1.1.cmml" xref="S3.SS2.SSS2.p1.5.m5.1.1">subscript</csymbol><ci id="S3.SS2.SSS2.p1.5.m5.1.1.2.cmml" xref="S3.SS2.SSS2.p1.5.m5.1.1.2">𝒟</ci><ci id="S3.SS2.SSS2.p1.5.m5.1.1.3a.cmml" xref="S3.SS2.SSS2.p1.5.m5.1.1.3"><mtext id="S3.SS2.SSS2.p1.5.m5.1.1.3.cmml" mathsize="70%" xref="S3.SS2.SSS2.p1.5.m5.1.1.3">test</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS2.p1.5.m5.1c">\mathcal{D}_{\text{test}}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS2.p1.5.m5.1d">caligraphic_D start_POSTSUBSCRIPT test end_POSTSUBSCRIPT</annotation></semantics></math> due to data shift—often hovering around 0.5 in our experiments—the relevance network is transferable.</p>
</div>
</section>
<section class="ltx_subsubsection" id="S3.SS2.SSS3">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">3.2.3. </span>Finetune with Unshifting Data</h4>
<div class="ltx_para" id="S3.SS2.SSS3.p1">
<p class="ltx_p" id="S3.SS2.SSS3.p1.2">After obtaining the pretrained relevance network, we integrate it with the original model and the target query <math alttext="x_{z}" class="ltx_Math" display="inline" id="S3.SS2.SSS3.p1.1.m1.1"><semantics id="S3.SS2.SSS3.p1.1.m1.1a"><msub id="S3.SS2.SSS3.p1.1.m1.1.1" xref="S3.SS2.SSS3.p1.1.m1.1.1.cmml"><mi id="S3.SS2.SSS3.p1.1.m1.1.1.2" xref="S3.SS2.SSS3.p1.1.m1.1.1.2.cmml">x</mi><mi id="S3.SS2.SSS3.p1.1.m1.1.1.3" xref="S3.SS2.SSS3.p1.1.m1.1.1.3.cmml">z</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS3.p1.1.m1.1b"><apply id="S3.SS2.SSS3.p1.1.m1.1.1.cmml" xref="S3.SS2.SSS3.p1.1.m1.1.1"><csymbol cd="ambiguous" id="S3.SS2.SSS3.p1.1.m1.1.1.1.cmml" xref="S3.SS2.SSS3.p1.1.m1.1.1">subscript</csymbol><ci id="S3.SS2.SSS3.p1.1.m1.1.1.2.cmml" xref="S3.SS2.SSS3.p1.1.m1.1.1.2">𝑥</ci><ci id="S3.SS2.SSS3.p1.1.m1.1.1.3.cmml" xref="S3.SS2.SSS3.p1.1.m1.1.1.3">𝑧</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS3.p1.1.m1.1c">x_{z}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS3.p1.1.m1.1d">italic_x start_POSTSUBSCRIPT italic_z end_POSTSUBSCRIPT</annotation></semantics></math> to form the Retrieval Framework. This framework is then trained using <math alttext="\mathcal{D}_{\text{train}}" class="ltx_Math" display="inline" id="S3.SS2.SSS3.p1.2.m2.1"><semantics id="S3.SS2.SSS3.p1.2.m2.1a"><msub id="S3.SS2.SSS3.p1.2.m2.1.1" xref="S3.SS2.SSS3.p1.2.m2.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS2.SSS3.p1.2.m2.1.1.2" xref="S3.SS2.SSS3.p1.2.m2.1.1.2.cmml">𝒟</mi><mtext id="S3.SS2.SSS3.p1.2.m2.1.1.3" xref="S3.SS2.SSS3.p1.2.m2.1.1.3a.cmml">train</mtext></msub><annotation-xml encoding="MathML-Content" id="S3.SS2.SSS3.p1.2.m2.1b"><apply id="S3.SS2.SSS3.p1.2.m2.1.1.cmml" xref="S3.SS2.SSS3.p1.2.m2.1.1"><csymbol cd="ambiguous" id="S3.SS2.SSS3.p1.2.m2.1.1.1.cmml" xref="S3.SS2.SSS3.p1.2.m2.1.1">subscript</csymbol><ci id="S3.SS2.SSS3.p1.2.m2.1.1.2.cmml" xref="S3.SS2.SSS3.p1.2.m2.1.1.2">𝒟</ci><ci id="S3.SS2.SSS3.p1.2.m2.1.1.3a.cmml" xref="S3.SS2.SSS3.p1.2.m2.1.1.3"><mtext id="S3.SS2.SSS3.p1.2.m2.1.1.3.cmml" mathsize="70%" xref="S3.SS2.SSS3.p1.2.m2.1.1.3">train</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS2.SSS3.p1.2.m2.1c">\mathcal{D}_{\text{train}}</annotation><annotation encoding="application/x-llamapun" id="S3.SS2.SSS3.p1.2.m2.1d">caligraphic_D start_POSTSUBSCRIPT train end_POSTSUBSCRIPT</annotation></semantics></math> with loss function  (<a class="ltx_ref" href="https://arxiv.org/html/2404.15678v4#S2.E4" title="In 2. PRELIMINARIES ‣ Retrieval and Distill: A Temporal Data Shift-Free Paradigm for Online Recommendation System"><span class="ltx_text ltx_ref_tag">4</span></a>), essentially finetuning it.</p>
</div>
</section>
</section>
<section class="ltx_subsection" id="S3.SS3">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">3.3. </span>Distill Framework</h3>
<div class="ltx_para" id="S3.SS3.p1">
<p class="ltx_p" id="S3.SS3.p1.1">Although the Retrieval Framework alone allows us to significantly enhance the performance of various existing CTR models by utilizing shifting data, this improvement depends on the relevance network’s inclusion of BM25 search, which can be computationally intensive due to the typically large volume of <math alttext="\mathcal{D}_{\text{shifting}}" class="ltx_Math" display="inline" id="S3.SS3.p1.1.m1.1"><semantics id="S3.SS3.p1.1.m1.1a"><msub id="S3.SS3.p1.1.m1.1.1" xref="S3.SS3.p1.1.m1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS3.p1.1.m1.1.1.2" xref="S3.SS3.p1.1.m1.1.1.2.cmml">𝒟</mi><mtext id="S3.SS3.p1.1.m1.1.1.3" xref="S3.SS3.p1.1.m1.1.1.3a.cmml">shifting</mtext></msub><annotation-xml encoding="MathML-Content" id="S3.SS3.p1.1.m1.1b"><apply id="S3.SS3.p1.1.m1.1.1.cmml" xref="S3.SS3.p1.1.m1.1.1"><csymbol cd="ambiguous" id="S3.SS3.p1.1.m1.1.1.1.cmml" xref="S3.SS3.p1.1.m1.1.1">subscript</csymbol><ci id="S3.SS3.p1.1.m1.1.1.2.cmml" xref="S3.SS3.p1.1.m1.1.1.2">𝒟</ci><ci id="S3.SS3.p1.1.m1.1.1.3a.cmml" xref="S3.SS3.p1.1.m1.1.1.3"><mtext id="S3.SS3.p1.1.m1.1.1.3.cmml" mathsize="70%" xref="S3.SS3.p1.1.m1.1.1.3">shifting</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p1.1.m1.1c">\mathcal{D}_{\text{shifting}}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p1.1.m1.1d">caligraphic_D start_POSTSUBSCRIPT shifting end_POSTSUBSCRIPT</annotation></semantics></math> data and the often linear time complexity of the search process.
This presents a substantial challenge for deploying the Retrieval Framework in an online environment.
To optimize the time complexity of the Retrieval Framework, we propose a Distill Framework designed to distill the relevance network and remove its search component.
The resulting module is termed the search-distill module.</p>
</div>
<div class="ltx_para" id="S3.SS3.p2">
<p class="ltx_p" id="S3.SS3.p2.2">Next, we start by delineating the structure of our model, followed by a description of the Distill Framework’s training process.
Within the Retrieval Framework’s pretraining step, we achieve a pretrained relevance network.
In the Distill Framework, this network undergoes distillation using <math alttext="\mathcal{D}_{\text{shifting}}" class="ltx_Math" display="inline" id="S3.SS3.p2.1.m1.1"><semantics id="S3.SS3.p2.1.m1.1a"><msub id="S3.SS3.p2.1.m1.1.1" xref="S3.SS3.p2.1.m1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS3.p2.1.m1.1.1.2" xref="S3.SS3.p2.1.m1.1.1.2.cmml">𝒟</mi><mtext id="S3.SS3.p2.1.m1.1.1.3" xref="S3.SS3.p2.1.m1.1.1.3a.cmml">shifting</mtext></msub><annotation-xml encoding="MathML-Content" id="S3.SS3.p2.1.m1.1b"><apply id="S3.SS3.p2.1.m1.1.1.cmml" xref="S3.SS3.p2.1.m1.1.1"><csymbol cd="ambiguous" id="S3.SS3.p2.1.m1.1.1.1.cmml" xref="S3.SS3.p2.1.m1.1.1">subscript</csymbol><ci id="S3.SS3.p2.1.m1.1.1.2.cmml" xref="S3.SS3.p2.1.m1.1.1.2">𝒟</ci><ci id="S3.SS3.p2.1.m1.1.1.3a.cmml" xref="S3.SS3.p2.1.m1.1.1.3"><mtext id="S3.SS3.p2.1.m1.1.1.3.cmml" mathsize="70%" xref="S3.SS3.p2.1.m1.1.1.3">shifting</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p2.1.m1.1c">\mathcal{D}_{\text{shifting}}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p2.1.m1.1d">caligraphic_D start_POSTSUBSCRIPT shifting end_POSTSUBSCRIPT</annotation></semantics></math>. Subsequently, the distilled search-distill module is combined with the original model through an integrated multilayer neural network for aggregation and subsequent finetuning using <math alttext="\mathcal{D}_{training}" class="ltx_Math" display="inline" id="S3.SS3.p2.2.m2.1"><semantics id="S3.SS3.p2.2.m2.1a"><msub id="S3.SS3.p2.2.m2.1.1" xref="S3.SS3.p2.2.m2.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS3.p2.2.m2.1.1.2" xref="S3.SS3.p2.2.m2.1.1.2.cmml">𝒟</mi><mrow id="S3.SS3.p2.2.m2.1.1.3" xref="S3.SS3.p2.2.m2.1.1.3.cmml"><mi id="S3.SS3.p2.2.m2.1.1.3.2" xref="S3.SS3.p2.2.m2.1.1.3.2.cmml">t</mi><mo id="S3.SS3.p2.2.m2.1.1.3.1" xref="S3.SS3.p2.2.m2.1.1.3.1.cmml">⁢</mo><mi id="S3.SS3.p2.2.m2.1.1.3.3" xref="S3.SS3.p2.2.m2.1.1.3.3.cmml">r</mi><mo id="S3.SS3.p2.2.m2.1.1.3.1a" xref="S3.SS3.p2.2.m2.1.1.3.1.cmml">⁢</mo><mi id="S3.SS3.p2.2.m2.1.1.3.4" xref="S3.SS3.p2.2.m2.1.1.3.4.cmml">a</mi><mo id="S3.SS3.p2.2.m2.1.1.3.1b" xref="S3.SS3.p2.2.m2.1.1.3.1.cmml">⁢</mo><mi id="S3.SS3.p2.2.m2.1.1.3.5" xref="S3.SS3.p2.2.m2.1.1.3.5.cmml">i</mi><mo id="S3.SS3.p2.2.m2.1.1.3.1c" xref="S3.SS3.p2.2.m2.1.1.3.1.cmml">⁢</mo><mi id="S3.SS3.p2.2.m2.1.1.3.6" xref="S3.SS3.p2.2.m2.1.1.3.6.cmml">n</mi><mo id="S3.SS3.p2.2.m2.1.1.3.1d" xref="S3.SS3.p2.2.m2.1.1.3.1.cmml">⁢</mo><mi id="S3.SS3.p2.2.m2.1.1.3.7" xref="S3.SS3.p2.2.m2.1.1.3.7.cmml">i</mi><mo id="S3.SS3.p2.2.m2.1.1.3.1e" xref="S3.SS3.p2.2.m2.1.1.3.1.cmml">⁢</mo><mi id="S3.SS3.p2.2.m2.1.1.3.8" xref="S3.SS3.p2.2.m2.1.1.3.8.cmml">n</mi><mo id="S3.SS3.p2.2.m2.1.1.3.1f" xref="S3.SS3.p2.2.m2.1.1.3.1.cmml">⁢</mo><mi id="S3.SS3.p2.2.m2.1.1.3.9" xref="S3.SS3.p2.2.m2.1.1.3.9.cmml">g</mi></mrow></msub><annotation-xml encoding="MathML-Content" id="S3.SS3.p2.2.m2.1b"><apply id="S3.SS3.p2.2.m2.1.1.cmml" xref="S3.SS3.p2.2.m2.1.1"><csymbol cd="ambiguous" id="S3.SS3.p2.2.m2.1.1.1.cmml" xref="S3.SS3.p2.2.m2.1.1">subscript</csymbol><ci id="S3.SS3.p2.2.m2.1.1.2.cmml" xref="S3.SS3.p2.2.m2.1.1.2">𝒟</ci><apply id="S3.SS3.p2.2.m2.1.1.3.cmml" xref="S3.SS3.p2.2.m2.1.1.3"><times id="S3.SS3.p2.2.m2.1.1.3.1.cmml" xref="S3.SS3.p2.2.m2.1.1.3.1"></times><ci id="S3.SS3.p2.2.m2.1.1.3.2.cmml" xref="S3.SS3.p2.2.m2.1.1.3.2">𝑡</ci><ci id="S3.SS3.p2.2.m2.1.1.3.3.cmml" xref="S3.SS3.p2.2.m2.1.1.3.3">𝑟</ci><ci id="S3.SS3.p2.2.m2.1.1.3.4.cmml" xref="S3.SS3.p2.2.m2.1.1.3.4">𝑎</ci><ci id="S3.SS3.p2.2.m2.1.1.3.5.cmml" xref="S3.SS3.p2.2.m2.1.1.3.5">𝑖</ci><ci id="S3.SS3.p2.2.m2.1.1.3.6.cmml" xref="S3.SS3.p2.2.m2.1.1.3.6">𝑛</ci><ci id="S3.SS3.p2.2.m2.1.1.3.7.cmml" xref="S3.SS3.p2.2.m2.1.1.3.7">𝑖</ci><ci id="S3.SS3.p2.2.m2.1.1.3.8.cmml" xref="S3.SS3.p2.2.m2.1.1.3.8">𝑛</ci><ci id="S3.SS3.p2.2.m2.1.1.3.9.cmml" xref="S3.SS3.p2.2.m2.1.1.3.9">𝑔</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.p2.2.m2.1c">\mathcal{D}_{training}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.p2.2.m2.1d">caligraphic_D start_POSTSUBSCRIPT italic_t italic_r italic_a italic_i italic_n italic_i italic_n italic_g end_POSTSUBSCRIPT</annotation></semantics></math>.</p>
</div>
<section class="ltx_subsubsection" id="S3.SS3.SSS1">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">3.3.1. </span>Framework Model Structure</h4>
<div class="ltx_para" id="S3.SS3.SSS1.p1">
<p class="ltx_p" id="S3.SS3.SSS1.p1.1">The neural network structure of the Retrieval Framework can be seen in Figure <a class="ltx_ref" href="https://arxiv.org/html/2404.15678v4#S3.F5" title="Figure 5 ‣ 3. The RAD Paradigm ‣ Retrieval and Distill: A Temporal Data Shift-Free Paradigm for Online Recommendation System"><span class="ltx_text ltx_ref_tag">5</span></a>.
The network architecture of the Distill Framework is similar to that of the Retrieval Framework. We replace the relevance network with the search-distill module.</p>
</div>
<div class="ltx_para" id="S3.SS3.SSS1.p2">
<p class="ltx_p" id="S3.SS3.SSS1.p2.1">From Figure <a class="ltx_ref" href="https://arxiv.org/html/2404.15678v4#S3.F4" title="Figure 4 ‣ 3. The RAD Paradigm ‣ Retrieval and Distill: A Temporal Data Shift-Free Paradigm for Online Recommendation System"><span class="ltx_text ltx_ref_tag">4</span></a>, we can observe the form of the teacher network in the Distill Framework.
The teacher network in the Distill Framework differs somewhat from that in the Retrieval Framework. We removed the cross layer from the teacher network in the Retrieval Framework to distill only the relevance network portion and added two neural network layers after the attention layer.
We use this teacher network to obtain a relevance network for distillation.</p>
</div>
<div class="ltx_para" id="S3.SS3.SSS1.p3">
<p class="ltx_p" id="S3.SS3.SSS1.p3.1">The search-distill module is a multilayer neural network equipped with an embedding layer. Akin to the original model, the search-distill module takes the feature portion of tabular data <math alttext="x_{z}" class="ltx_Math" display="inline" id="S3.SS3.SSS1.p3.1.m1.1"><semantics id="S3.SS3.SSS1.p3.1.m1.1a"><msub id="S3.SS3.SSS1.p3.1.m1.1.1" xref="S3.SS3.SSS1.p3.1.m1.1.1.cmml"><mi id="S3.SS3.SSS1.p3.1.m1.1.1.2" xref="S3.SS3.SSS1.p3.1.m1.1.1.2.cmml">x</mi><mi id="S3.SS3.SSS1.p3.1.m1.1.1.3" xref="S3.SS3.SSS1.p3.1.m1.1.1.3.cmml">z</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS1.p3.1.m1.1b"><apply id="S3.SS3.SSS1.p3.1.m1.1.1.cmml" xref="S3.SS3.SSS1.p3.1.m1.1.1"><csymbol cd="ambiguous" id="S3.SS3.SSS1.p3.1.m1.1.1.1.cmml" xref="S3.SS3.SSS1.p3.1.m1.1.1">subscript</csymbol><ci id="S3.SS3.SSS1.p3.1.m1.1.1.2.cmml" xref="S3.SS3.SSS1.p3.1.m1.1.1.2">𝑥</ci><ci id="S3.SS3.SSS1.p3.1.m1.1.1.3.cmml" xref="S3.SS3.SSS1.p3.1.m1.1.1.3">𝑧</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS1.p3.1.m1.1c">x_{z}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.SSS1.p3.1.m1.1d">italic_x start_POSTSUBSCRIPT italic_z end_POSTSUBSCRIPT</annotation></semantics></math> as its input. The output of the search-distill module is a logit of the same size as that of the final output from the relevance network.</p>
</div>
</section>
<section class="ltx_subsubsection" id="S3.SS3.SSS2">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">3.3.2. </span>Pretrain and Distill with Shifting Data</h4>
<div class="ltx_para" id="S3.SS3.SSS2.p1">
<p class="ltx_p" id="S3.SS3.SSS2.p1.2">From theorem <a class="ltx_ref" href="https://arxiv.org/html/2404.15678v4#S2.Thmtheorem1" title="Theorem 2.1. ‣ 2. PRELIMINARIES ‣ Retrieval and Distill: A Temporal Data Shift-Free Paradigm for Online Recommendation System"><span class="ltx_text ltx_ref_tag">2.1</span></a>, we understand that the relevance network operates as a temporal data shift-free module.
Like the relevance network, the search-distill module is also used to approximate the probability <math alttext="P(x_{s}|x)" class="ltx_Math" display="inline" id="S3.SS3.SSS2.p1.1.m1.1"><semantics id="S3.SS3.SSS2.p1.1.m1.1a"><mrow id="S3.SS3.SSS2.p1.1.m1.1.1" xref="S3.SS3.SSS2.p1.1.m1.1.1.cmml"><mi id="S3.SS3.SSS2.p1.1.m1.1.1.3" xref="S3.SS3.SSS2.p1.1.m1.1.1.3.cmml">P</mi><mo id="S3.SS3.SSS2.p1.1.m1.1.1.2" xref="S3.SS3.SSS2.p1.1.m1.1.1.2.cmml">⁢</mo><mrow id="S3.SS3.SSS2.p1.1.m1.1.1.1.1" xref="S3.SS3.SSS2.p1.1.m1.1.1.1.1.1.cmml"><mo id="S3.SS3.SSS2.p1.1.m1.1.1.1.1.2" stretchy="false" xref="S3.SS3.SSS2.p1.1.m1.1.1.1.1.1.cmml">(</mo><mrow id="S3.SS3.SSS2.p1.1.m1.1.1.1.1.1" xref="S3.SS3.SSS2.p1.1.m1.1.1.1.1.1.cmml"><msub id="S3.SS3.SSS2.p1.1.m1.1.1.1.1.1.2" xref="S3.SS3.SSS2.p1.1.m1.1.1.1.1.1.2.cmml"><mi id="S3.SS3.SSS2.p1.1.m1.1.1.1.1.1.2.2" xref="S3.SS3.SSS2.p1.1.m1.1.1.1.1.1.2.2.cmml">x</mi><mi id="S3.SS3.SSS2.p1.1.m1.1.1.1.1.1.2.3" xref="S3.SS3.SSS2.p1.1.m1.1.1.1.1.1.2.3.cmml">s</mi></msub><mo fence="false" id="S3.SS3.SSS2.p1.1.m1.1.1.1.1.1.1" xref="S3.SS3.SSS2.p1.1.m1.1.1.1.1.1.1.cmml">|</mo><mi id="S3.SS3.SSS2.p1.1.m1.1.1.1.1.1.3" xref="S3.SS3.SSS2.p1.1.m1.1.1.1.1.1.3.cmml">x</mi></mrow><mo id="S3.SS3.SSS2.p1.1.m1.1.1.1.1.3" stretchy="false" xref="S3.SS3.SSS2.p1.1.m1.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS2.p1.1.m1.1b"><apply id="S3.SS3.SSS2.p1.1.m1.1.1.cmml" xref="S3.SS3.SSS2.p1.1.m1.1.1"><times id="S3.SS3.SSS2.p1.1.m1.1.1.2.cmml" xref="S3.SS3.SSS2.p1.1.m1.1.1.2"></times><ci id="S3.SS3.SSS2.p1.1.m1.1.1.3.cmml" xref="S3.SS3.SSS2.p1.1.m1.1.1.3">𝑃</ci><apply id="S3.SS3.SSS2.p1.1.m1.1.1.1.1.1.cmml" xref="S3.SS3.SSS2.p1.1.m1.1.1.1.1"><csymbol cd="latexml" id="S3.SS3.SSS2.p1.1.m1.1.1.1.1.1.1.cmml" xref="S3.SS3.SSS2.p1.1.m1.1.1.1.1.1.1">conditional</csymbol><apply id="S3.SS3.SSS2.p1.1.m1.1.1.1.1.1.2.cmml" xref="S3.SS3.SSS2.p1.1.m1.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S3.SS3.SSS2.p1.1.m1.1.1.1.1.1.2.1.cmml" xref="S3.SS3.SSS2.p1.1.m1.1.1.1.1.1.2">subscript</csymbol><ci id="S3.SS3.SSS2.p1.1.m1.1.1.1.1.1.2.2.cmml" xref="S3.SS3.SSS2.p1.1.m1.1.1.1.1.1.2.2">𝑥</ci><ci id="S3.SS3.SSS2.p1.1.m1.1.1.1.1.1.2.3.cmml" xref="S3.SS3.SSS2.p1.1.m1.1.1.1.1.1.2.3">𝑠</ci></apply><ci id="S3.SS3.SSS2.p1.1.m1.1.1.1.1.1.3.cmml" xref="S3.SS3.SSS2.p1.1.m1.1.1.1.1.1.3">𝑥</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS2.p1.1.m1.1c">P(x_{s}|x)</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.SSS2.p1.1.m1.1d">italic_P ( italic_x start_POSTSUBSCRIPT italic_s end_POSTSUBSCRIPT | italic_x )</annotation></semantics></math>, which can be trained using shifting data.
We first obtain the relevance network using the teacher network and loss function (<a class="ltx_ref" href="https://arxiv.org/html/2404.15678v4#S2.E3" title="In 2. PRELIMINARIES ‣ Retrieval and Distill: A Temporal Data Shift-Free Paradigm for Online Recommendation System"><span class="ltx_text ltx_ref_tag">3</span></a>).
Then, we employ <math alttext="\mathcal{D}_{\text{shifting}}" class="ltx_Math" display="inline" id="S3.SS3.SSS2.p1.2.m2.1"><semantics id="S3.SS3.SSS2.p1.2.m2.1a"><msub id="S3.SS3.SSS2.p1.2.m2.1.1" xref="S3.SS3.SSS2.p1.2.m2.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S3.SS3.SSS2.p1.2.m2.1.1.2" xref="S3.SS3.SSS2.p1.2.m2.1.1.2.cmml">𝒟</mi><mtext id="S3.SS3.SSS2.p1.2.m2.1.1.3" xref="S3.SS3.SSS2.p1.2.m2.1.1.3a.cmml">shifting</mtext></msub><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS2.p1.2.m2.1b"><apply id="S3.SS3.SSS2.p1.2.m2.1.1.cmml" xref="S3.SS3.SSS2.p1.2.m2.1.1"><csymbol cd="ambiguous" id="S3.SS3.SSS2.p1.2.m2.1.1.1.cmml" xref="S3.SS3.SSS2.p1.2.m2.1.1">subscript</csymbol><ci id="S3.SS3.SSS2.p1.2.m2.1.1.2.cmml" xref="S3.SS3.SSS2.p1.2.m2.1.1.2">𝒟</ci><ci id="S3.SS3.SSS2.p1.2.m2.1.1.3a.cmml" xref="S3.SS3.SSS2.p1.2.m2.1.1.3"><mtext id="S3.SS3.SSS2.p1.2.m2.1.1.3.cmml" mathsize="70%" xref="S3.SS3.SSS2.p1.2.m2.1.1.3">shifting</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS2.p1.2.m2.1c">\mathcal{D}_{\text{shifting}}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.SSS2.p1.2.m2.1d">caligraphic_D start_POSTSUBSCRIPT shifting end_POSTSUBSCRIPT</annotation></semantics></math> and loss function (<a class="ltx_ref" href="https://arxiv.org/html/2404.15678v4#S2.E8" title="In 2. PRELIMINARIES ‣ Retrieval and Distill: A Temporal Data Shift-Free Paradigm for Online Recommendation System"><span class="ltx_text ltx_ref_tag">8</span></a>) to perform distillation on the final logit layer of the search-distill module. The distillation process can be observed in Figure <a class="ltx_ref" href="https://arxiv.org/html/2404.15678v4#S3.F4" title="Figure 4 ‣ 3. The RAD Paradigm ‣ Retrieval and Distill: A Temporal Data Shift-Free Paradigm for Online Recommendation System"><span class="ltx_text ltx_ref_tag">4</span></a>.
We employ the mean squared error loss function to align the final logit layer of the search-distill module with that of the relevance network.</p>
</div>
</section>
<section class="ltx_subsubsection" id="S3.SS3.SSS3">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">3.3.3. </span>Finetune with Unshifting Data</h4>
<div class="ltx_para" id="S3.SS3.SSS3.p1">
<p class="ltx_p" id="S3.SS3.SSS3.p1.1">After obtaining a distilled search-distill module, we integrate the original model, the input <math alttext="x_{z}" class="ltx_Math" display="inline" id="S3.SS3.SSS3.p1.1.m1.1"><semantics id="S3.SS3.SSS3.p1.1.m1.1a"><msub id="S3.SS3.SSS3.p1.1.m1.1.1" xref="S3.SS3.SSS3.p1.1.m1.1.1.cmml"><mi id="S3.SS3.SSS3.p1.1.m1.1.1.2" xref="S3.SS3.SSS3.p1.1.m1.1.1.2.cmml">x</mi><mi id="S3.SS3.SSS3.p1.1.m1.1.1.3" xref="S3.SS3.SSS3.p1.1.m1.1.1.3.cmml">z</mi></msub><annotation-xml encoding="MathML-Content" id="S3.SS3.SSS3.p1.1.m1.1b"><apply id="S3.SS3.SSS3.p1.1.m1.1.1.cmml" xref="S3.SS3.SSS3.p1.1.m1.1.1"><csymbol cd="ambiguous" id="S3.SS3.SSS3.p1.1.m1.1.1.1.cmml" xref="S3.SS3.SSS3.p1.1.m1.1.1">subscript</csymbol><ci id="S3.SS3.SSS3.p1.1.m1.1.1.2.cmml" xref="S3.SS3.SSS3.p1.1.m1.1.1.2">𝑥</ci><ci id="S3.SS3.SSS3.p1.1.m1.1.1.3.cmml" xref="S3.SS3.SSS3.p1.1.m1.1.1.3">𝑧</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S3.SS3.SSS3.p1.1.m1.1c">x_{z}</annotation><annotation encoding="application/x-llamapun" id="S3.SS3.SSS3.p1.1.m1.1d">italic_x start_POSTSUBSCRIPT italic_z end_POSTSUBSCRIPT</annotation></semantics></math>, and the search-distill module using a multilayer neural network for aggregation.
This network is then trained with unshifting data and loss function (<a class="ltx_ref" href="https://arxiv.org/html/2404.15678v4#S2.E9" title="In 2. PRELIMINARIES ‣ Retrieval and Distill: A Temporal Data Shift-Free Paradigm for Online Recommendation System"><span class="ltx_text ltx_ref_tag">9</span></a>), allowing us to finetune and enhance the original model with insights gleaned from shifting data without significantly increasing the deployment overhead of the original model.</p>
</div>
</section>
</section>
</section>
<section class="ltx_section" id="S4">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">4. </span>Experiments</h2>
<div class="ltx_para" id="S4.p1">
<p class="ltx_p" id="S4.p1.1">In this section, we evaluate the RAD paradigm across multiple datasets using various traditional CTR models.
We measure the efficacy of the RAD paradigm using the conventional CTR prediction task. We select two sets of classic CTR models: one representing factorization models and the other representing sequence prediction models. Each set of models is tested on three real-world datasets.</p>
</div>
<div class="ltx_para" id="S4.p2">
<p class="ltx_p" id="S4.p2.1">This section starts with five research questions (RQs) guiding the subsequent discourse.</p>
</div>
<div class="ltx_para" id="S4.p3">
<ul class="ltx_itemize" id="S4.I1">
<li class="ltx_item" id="S4.I1.ix1" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item"><span class="ltx_text ltx_font_bold" id="S4.I1.ix1.1.1.1">RQ1</span></span>
<div class="ltx_para" id="S4.I1.ix1.p1">
<p class="ltx_p" id="S4.I1.ix1.p1.1">Does the RAD paradigm enhance the performance of existing CTR prediction models?</p>
</div>
</li>
<li class="ltx_item" id="S4.I1.ix2" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item"><span class="ltx_text ltx_font_bold" id="S4.I1.ix2.1.1.1">RQ2</span></span>
<div class="ltx_para" id="S4.I1.ix2.p1">
<p class="ltx_p" id="S4.I1.ix2.p1.1">Can distillation functions be applied to the distillation of non-parametric models?</p>
</div>
</li>
<li class="ltx_item" id="S4.I1.ix3" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item"><span class="ltx_text ltx_font_bold" id="S4.I1.ix3.1.1.1">RQ3</span></span>
<div class="ltx_para" id="S4.I1.ix3.p1">
<p class="ltx_p" id="S4.I1.ix3.p1.1">Can the relevance network, trained using shifting data, be transferred to predict future data?</p>
</div>
</li>
<li class="ltx_item" id="S4.I1.ix4" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item"><span class="ltx_text ltx_font_bold" id="S4.I1.ix4.1.1.1">RQ4</span></span>
<div class="ltx_para" id="S4.I1.ix4.p1">
<p class="ltx_p" id="S4.I1.ix4.p1.1">How does the RAD paradigm affect the run time of the original model?</p>
</div>
</li>
<li class="ltx_item" id="S4.I1.ix5" style="list-style-type:none;">
<span class="ltx_tag ltx_tag_item"><span class="ltx_text ltx_font_bold" id="S4.I1.ix5.1.1.1">RQ5</span></span>
<div class="ltx_para" id="S4.I1.ix5.p1">
<p class="ltx_p" id="S4.I1.ix5.p1.1">How do different distillation loss functions affect the RAD paradigm?</p>
</div>
</li>
</ul>
</div>
<section class="ltx_subsection" id="S4.SS1">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.1. </span>Datasets</h3>
<div class="ltx_para" id="S4.SS1.p1">
<p class="ltx_p" id="S4.SS1.p1.1">In order to evaluate the performance of RAD, we conduct extensive experiments for CTR prediction tasks on three real-world large-scale recommendation datasets from Alibaba and Ant Group, i.e., Taobao, Tmall and Alipay<span class="ltx_note ltx_role_footnote" id="footnote1"><sup class="ltx_note_mark">1</sup><span class="ltx_note_outer"><span class="ltx_note_content"><sup class="ltx_note_mark">1</sup><span class="ltx_tag ltx_tag_note">1</span>https://tianchi.aliyun.com/dataset/x, where ‘x’ is ‘649’, ‘42’, and ‘53’ for Taobao, Tmall, and Alipay, respectively.</span></span></span>. These datasets consist of sequential user-item interactions in e-commerce scenes. Table  <a class="ltx_ref" href="https://arxiv.org/html/2404.15678v4#S4.T1" title="Table 1 ‣ 4.1. Datasets ‣ 4. Experiments ‣ Retrieval and Distill: A Temporal Data Shift-Free Paradigm for Online Recommendation System"><span class="ltx_text ltx_ref_tag">1</span></a> is the information for our split dataset.</p>
</div>
<figure class="ltx_table" id="S4.T1">
<div class="ltx_inline-block ltx_transformed_outer" id="S4.T1.9" style="width:195.1pt;height:113.2pt;vertical-align:-0.0pt;"><span class="ltx_transformed_inner" style="transform:translate(-57.6pt,33.4pt) scale(0.628692803960269,0.628692803960269) ;">
<table class="ltx_tabular ltx_guessed_headers ltx_align_middle" id="S4.T1.9.9">
<thead class="ltx_thead">
<tr class="ltx_tr" id="S4.T1.9.9.10.1">
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_r ltx_border_tt" id="S4.T1.9.9.10.1.1">Datasets</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_r ltx_border_tt" id="S4.T1.9.9.10.1.2">Fields</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="S4.T1.9.9.10.1.3">Split</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="S4.T1.9.9.10.1.4"># Instances</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="S4.T1.9.9.10.1.5">Start time</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="S4.T1.9.9.10.1.6">End time</th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr class="ltx_tr" id="S4.T1.1.1.1">
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S4.T1.1.1.1.2" rowspan="3"><span class="ltx_text" id="S4.T1.1.1.1.2.1">Taobao</span></td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S4.T1.1.1.1.3" rowspan="3"><span class="ltx_text" id="S4.T1.1.1.1.3.1">4</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T1.1.1.1.1"><math alttext="\mathcal{D}_{\text{shifting}}" class="ltx_Math" display="inline" id="S4.T1.1.1.1.1.m1.1"><semantics id="S4.T1.1.1.1.1.m1.1a"><msub id="S4.T1.1.1.1.1.m1.1.1" xref="S4.T1.1.1.1.1.m1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.T1.1.1.1.1.m1.1.1.2" xref="S4.T1.1.1.1.1.m1.1.1.2.cmml">𝒟</mi><mtext id="S4.T1.1.1.1.1.m1.1.1.3" xref="S4.T1.1.1.1.1.m1.1.1.3a.cmml">shifting</mtext></msub><annotation-xml encoding="MathML-Content" id="S4.T1.1.1.1.1.m1.1b"><apply id="S4.T1.1.1.1.1.m1.1.1.cmml" xref="S4.T1.1.1.1.1.m1.1.1"><csymbol cd="ambiguous" id="S4.T1.1.1.1.1.m1.1.1.1.cmml" xref="S4.T1.1.1.1.1.m1.1.1">subscript</csymbol><ci id="S4.T1.1.1.1.1.m1.1.1.2.cmml" xref="S4.T1.1.1.1.1.m1.1.1.2">𝒟</ci><ci id="S4.T1.1.1.1.1.m1.1.1.3a.cmml" xref="S4.T1.1.1.1.1.m1.1.1.3"><mtext id="S4.T1.1.1.1.1.m1.1.1.3.cmml" mathsize="70%" xref="S4.T1.1.1.1.1.m1.1.1.3">shifting</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.T1.1.1.1.1.m1.1c">\mathcal{D}_{\text{shifting}}</annotation><annotation encoding="application/x-llamapun" id="S4.T1.1.1.1.1.m1.1d">caligraphic_D start_POSTSUBSCRIPT shifting end_POSTSUBSCRIPT</annotation></semantics></math></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T1.1.1.1.4">145416702</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T1.1.1.1.5">2017-11-25</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T1.1.1.1.6">2017-12-01</td>
</tr>
<tr class="ltx_tr" id="S4.T1.2.2.2">
<td class="ltx_td ltx_align_center" id="S4.T1.2.2.2.1"><math alttext="\mathcal{D}_{\text{train}}" class="ltx_Math" display="inline" id="S4.T1.2.2.2.1.m1.1"><semantics id="S4.T1.2.2.2.1.m1.1a"><msub id="S4.T1.2.2.2.1.m1.1.1" xref="S4.T1.2.2.2.1.m1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.T1.2.2.2.1.m1.1.1.2" xref="S4.T1.2.2.2.1.m1.1.1.2.cmml">𝒟</mi><mtext id="S4.T1.2.2.2.1.m1.1.1.3" xref="S4.T1.2.2.2.1.m1.1.1.3a.cmml">train</mtext></msub><annotation-xml encoding="MathML-Content" id="S4.T1.2.2.2.1.m1.1b"><apply id="S4.T1.2.2.2.1.m1.1.1.cmml" xref="S4.T1.2.2.2.1.m1.1.1"><csymbol cd="ambiguous" id="S4.T1.2.2.2.1.m1.1.1.1.cmml" xref="S4.T1.2.2.2.1.m1.1.1">subscript</csymbol><ci id="S4.T1.2.2.2.1.m1.1.1.2.cmml" xref="S4.T1.2.2.2.1.m1.1.1.2">𝒟</ci><ci id="S4.T1.2.2.2.1.m1.1.1.3a.cmml" xref="S4.T1.2.2.2.1.m1.1.1.3"><mtext id="S4.T1.2.2.2.1.m1.1.1.3.cmml" mathsize="70%" xref="S4.T1.2.2.2.1.m1.1.1.3">train</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.T1.2.2.2.1.m1.1c">\mathcal{D}_{\text{train}}</annotation><annotation encoding="application/x-llamapun" id="S4.T1.2.2.2.1.m1.1d">caligraphic_D start_POSTSUBSCRIPT train end_POSTSUBSCRIPT</annotation></semantics></math></td>
<td class="ltx_td ltx_align_center" id="S4.T1.2.2.2.2">2754415</td>
<td class="ltx_td ltx_align_center" id="S4.T1.2.2.2.3">2017-12-02</td>
<td class="ltx_td ltx_align_center" id="S4.T1.2.2.2.4">2017-12-02</td>
</tr>
<tr class="ltx_tr" id="S4.T1.3.3.3">
<td class="ltx_td ltx_align_center" id="S4.T1.3.3.3.1"><math alttext="\mathcal{D}_{\text{test}}" class="ltx_Math" display="inline" id="S4.T1.3.3.3.1.m1.1"><semantics id="S4.T1.3.3.3.1.m1.1a"><msub id="S4.T1.3.3.3.1.m1.1.1" xref="S4.T1.3.3.3.1.m1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.T1.3.3.3.1.m1.1.1.2" xref="S4.T1.3.3.3.1.m1.1.1.2.cmml">𝒟</mi><mtext id="S4.T1.3.3.3.1.m1.1.1.3" xref="S4.T1.3.3.3.1.m1.1.1.3a.cmml">test</mtext></msub><annotation-xml encoding="MathML-Content" id="S4.T1.3.3.3.1.m1.1b"><apply id="S4.T1.3.3.3.1.m1.1.1.cmml" xref="S4.T1.3.3.3.1.m1.1.1"><csymbol cd="ambiguous" id="S4.T1.3.3.3.1.m1.1.1.1.cmml" xref="S4.T1.3.3.3.1.m1.1.1">subscript</csymbol><ci id="S4.T1.3.3.3.1.m1.1.1.2.cmml" xref="S4.T1.3.3.3.1.m1.1.1.2">𝒟</ci><ci id="S4.T1.3.3.3.1.m1.1.1.3a.cmml" xref="S4.T1.3.3.3.1.m1.1.1.3"><mtext id="S4.T1.3.3.3.1.m1.1.1.3.cmml" mathsize="70%" xref="S4.T1.3.3.3.1.m1.1.1.3">test</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.T1.3.3.3.1.m1.1c">\mathcal{D}_{\text{test}}</annotation><annotation encoding="application/x-llamapun" id="S4.T1.3.3.3.1.m1.1d">caligraphic_D start_POSTSUBSCRIPT test end_POSTSUBSCRIPT</annotation></semantics></math></td>
<td class="ltx_td ltx_align_center" id="S4.T1.3.3.3.2">2734177</td>
<td class="ltx_td ltx_align_center" id="S4.T1.3.3.3.3">2017-12-03</td>
<td class="ltx_td ltx_align_center" id="S4.T1.3.3.3.4">2017-12-03</td>
</tr>
<tr class="ltx_tr" id="S4.T1.4.4.4">
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S4.T1.4.4.4.2" rowspan="3"><span class="ltx_text" id="S4.T1.4.4.4.2.1">Tmall</span></td>
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S4.T1.4.4.4.3" rowspan="3"><span class="ltx_text" id="S4.T1.4.4.4.3.1">9</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T1.4.4.4.1"><math alttext="\mathcal{D}_{\text{shifting}}" class="ltx_Math" display="inline" id="S4.T1.4.4.4.1.m1.1"><semantics id="S4.T1.4.4.4.1.m1.1a"><msub id="S4.T1.4.4.4.1.m1.1.1" xref="S4.T1.4.4.4.1.m1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.T1.4.4.4.1.m1.1.1.2" xref="S4.T1.4.4.4.1.m1.1.1.2.cmml">𝒟</mi><mtext id="S4.T1.4.4.4.1.m1.1.1.3" xref="S4.T1.4.4.4.1.m1.1.1.3a.cmml">shifting</mtext></msub><annotation-xml encoding="MathML-Content" id="S4.T1.4.4.4.1.m1.1b"><apply id="S4.T1.4.4.4.1.m1.1.1.cmml" xref="S4.T1.4.4.4.1.m1.1.1"><csymbol cd="ambiguous" id="S4.T1.4.4.4.1.m1.1.1.1.cmml" xref="S4.T1.4.4.4.1.m1.1.1">subscript</csymbol><ci id="S4.T1.4.4.4.1.m1.1.1.2.cmml" xref="S4.T1.4.4.4.1.m1.1.1.2">𝒟</ci><ci id="S4.T1.4.4.4.1.m1.1.1.3a.cmml" xref="S4.T1.4.4.4.1.m1.1.1.3"><mtext id="S4.T1.4.4.4.1.m1.1.1.3.cmml" mathsize="70%" xref="S4.T1.4.4.4.1.m1.1.1.3">shifting</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.T1.4.4.4.1.m1.1c">\mathcal{D}_{\text{shifting}}</annotation><annotation encoding="application/x-llamapun" id="S4.T1.4.4.4.1.m1.1d">caligraphic_D start_POSTSUBSCRIPT shifting end_POSTSUBSCRIPT</annotation></semantics></math></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T1.4.4.4.4">68646472</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T1.4.4.4.5">2015-05-11</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T1.4.4.4.6">2015-10-31</td>
</tr>
<tr class="ltx_tr" id="S4.T1.5.5.5">
<td class="ltx_td ltx_align_center" id="S4.T1.5.5.5.1"><math alttext="\mathcal{D}_{\text{train}}" class="ltx_Math" display="inline" id="S4.T1.5.5.5.1.m1.1"><semantics id="S4.T1.5.5.5.1.m1.1a"><msub id="S4.T1.5.5.5.1.m1.1.1" xref="S4.T1.5.5.5.1.m1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.T1.5.5.5.1.m1.1.1.2" xref="S4.T1.5.5.5.1.m1.1.1.2.cmml">𝒟</mi><mtext id="S4.T1.5.5.5.1.m1.1.1.3" xref="S4.T1.5.5.5.1.m1.1.1.3a.cmml">train</mtext></msub><annotation-xml encoding="MathML-Content" id="S4.T1.5.5.5.1.m1.1b"><apply id="S4.T1.5.5.5.1.m1.1.1.cmml" xref="S4.T1.5.5.5.1.m1.1.1"><csymbol cd="ambiguous" id="S4.T1.5.5.5.1.m1.1.1.1.cmml" xref="S4.T1.5.5.5.1.m1.1.1">subscript</csymbol><ci id="S4.T1.5.5.5.1.m1.1.1.2.cmml" xref="S4.T1.5.5.5.1.m1.1.1.2">𝒟</ci><ci id="S4.T1.5.5.5.1.m1.1.1.3a.cmml" xref="S4.T1.5.5.5.1.m1.1.1.3"><mtext id="S4.T1.5.5.5.1.m1.1.1.3.cmml" mathsize="70%" xref="S4.T1.5.5.5.1.m1.1.1.3">train</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.T1.5.5.5.1.m1.1c">\mathcal{D}_{\text{train}}</annotation><annotation encoding="application/x-llamapun" id="S4.T1.5.5.5.1.m1.1d">caligraphic_D start_POSTSUBSCRIPT train end_POSTSUBSCRIPT</annotation></semantics></math></td>
<td class="ltx_td ltx_align_center" id="S4.T1.5.5.5.2">6679610</td>
<td class="ltx_td ltx_align_center" id="S4.T1.5.5.5.3">2015-11-01</td>
<td class="ltx_td ltx_align_center" id="S4.T1.5.5.5.4">2015-11-10</td>
</tr>
<tr class="ltx_tr" id="S4.T1.6.6.6">
<td class="ltx_td ltx_align_center" id="S4.T1.6.6.6.1"><math alttext="\mathcal{D}_{\text{test}}" class="ltx_Math" display="inline" id="S4.T1.6.6.6.1.m1.1"><semantics id="S4.T1.6.6.6.1.m1.1a"><msub id="S4.T1.6.6.6.1.m1.1.1" xref="S4.T1.6.6.6.1.m1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.T1.6.6.6.1.m1.1.1.2" xref="S4.T1.6.6.6.1.m1.1.1.2.cmml">𝒟</mi><mtext id="S4.T1.6.6.6.1.m1.1.1.3" xref="S4.T1.6.6.6.1.m1.1.1.3a.cmml">test</mtext></msub><annotation-xml encoding="MathML-Content" id="S4.T1.6.6.6.1.m1.1b"><apply id="S4.T1.6.6.6.1.m1.1.1.cmml" xref="S4.T1.6.6.6.1.m1.1.1"><csymbol cd="ambiguous" id="S4.T1.6.6.6.1.m1.1.1.1.cmml" xref="S4.T1.6.6.6.1.m1.1.1">subscript</csymbol><ci id="S4.T1.6.6.6.1.m1.1.1.2.cmml" xref="S4.T1.6.6.6.1.m1.1.1.2">𝒟</ci><ci id="S4.T1.6.6.6.1.m1.1.1.3a.cmml" xref="S4.T1.6.6.6.1.m1.1.1.3"><mtext id="S4.T1.6.6.6.1.m1.1.1.3.cmml" mathsize="70%" xref="S4.T1.6.6.6.1.m1.1.1.3">test</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.T1.6.6.6.1.m1.1c">\mathcal{D}_{\text{test}}</annotation><annotation encoding="application/x-llamapun" id="S4.T1.6.6.6.1.m1.1d">caligraphic_D start_POSTSUBSCRIPT test end_POSTSUBSCRIPT</annotation></semantics></math></td>
<td class="ltx_td ltx_align_center" id="S4.T1.6.6.6.2">7055119</td>
<td class="ltx_td ltx_align_center" id="S4.T1.6.6.6.3">2015-11-11</td>
<td class="ltx_td ltx_align_center" id="S4.T1.6.6.6.4">2015-11-12</td>
</tr>
<tr class="ltx_tr" id="S4.T1.7.7.7">
<td class="ltx_td ltx_align_center ltx_border_bb ltx_border_r ltx_border_t" id="S4.T1.7.7.7.2" rowspan="3"><span class="ltx_text" id="S4.T1.7.7.7.2.1">Alipay</span></td>
<td class="ltx_td ltx_align_center ltx_border_bb ltx_border_r ltx_border_t" id="S4.T1.7.7.7.3" rowspan="3"><span class="ltx_text" id="S4.T1.7.7.7.3.1">6</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T1.7.7.7.1"><math alttext="\mathcal{D}_{\text{shifting}}" class="ltx_Math" display="inline" id="S4.T1.7.7.7.1.m1.1"><semantics id="S4.T1.7.7.7.1.m1.1a"><msub id="S4.T1.7.7.7.1.m1.1.1" xref="S4.T1.7.7.7.1.m1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.T1.7.7.7.1.m1.1.1.2" xref="S4.T1.7.7.7.1.m1.1.1.2.cmml">𝒟</mi><mtext id="S4.T1.7.7.7.1.m1.1.1.3" xref="S4.T1.7.7.7.1.m1.1.1.3a.cmml">shifting</mtext></msub><annotation-xml encoding="MathML-Content" id="S4.T1.7.7.7.1.m1.1b"><apply id="S4.T1.7.7.7.1.m1.1.1.cmml" xref="S4.T1.7.7.7.1.m1.1.1"><csymbol cd="ambiguous" id="S4.T1.7.7.7.1.m1.1.1.1.cmml" xref="S4.T1.7.7.7.1.m1.1.1">subscript</csymbol><ci id="S4.T1.7.7.7.1.m1.1.1.2.cmml" xref="S4.T1.7.7.7.1.m1.1.1.2">𝒟</ci><ci id="S4.T1.7.7.7.1.m1.1.1.3a.cmml" xref="S4.T1.7.7.7.1.m1.1.1.3"><mtext id="S4.T1.7.7.7.1.m1.1.1.3.cmml" mathsize="70%" xref="S4.T1.7.7.7.1.m1.1.1.3">shifting</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.T1.7.7.7.1.m1.1c">\mathcal{D}_{\text{shifting}}</annotation><annotation encoding="application/x-llamapun" id="S4.T1.7.7.7.1.m1.1d">caligraphic_D start_POSTSUBSCRIPT shifting end_POSTSUBSCRIPT</annotation></semantics></math></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T1.7.7.7.4">82090360</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T1.7.7.7.5">2015-07-01</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T1.7.7.7.6">2015-10-31</td>
</tr>
<tr class="ltx_tr" id="S4.T1.8.8.8">
<td class="ltx_td ltx_align_center" id="S4.T1.8.8.8.1"><math alttext="\mathcal{D}_{\text{train}}" class="ltx_Math" display="inline" id="S4.T1.8.8.8.1.m1.1"><semantics id="S4.T1.8.8.8.1.m1.1a"><msub id="S4.T1.8.8.8.1.m1.1.1" xref="S4.T1.8.8.8.1.m1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.T1.8.8.8.1.m1.1.1.2" xref="S4.T1.8.8.8.1.m1.1.1.2.cmml">𝒟</mi><mtext id="S4.T1.8.8.8.1.m1.1.1.3" xref="S4.T1.8.8.8.1.m1.1.1.3a.cmml">train</mtext></msub><annotation-xml encoding="MathML-Content" id="S4.T1.8.8.8.1.m1.1b"><apply id="S4.T1.8.8.8.1.m1.1.1.cmml" xref="S4.T1.8.8.8.1.m1.1.1"><csymbol cd="ambiguous" id="S4.T1.8.8.8.1.m1.1.1.1.cmml" xref="S4.T1.8.8.8.1.m1.1.1">subscript</csymbol><ci id="S4.T1.8.8.8.1.m1.1.1.2.cmml" xref="S4.T1.8.8.8.1.m1.1.1.2">𝒟</ci><ci id="S4.T1.8.8.8.1.m1.1.1.3a.cmml" xref="S4.T1.8.8.8.1.m1.1.1.3"><mtext id="S4.T1.8.8.8.1.m1.1.1.3.cmml" mathsize="70%" xref="S4.T1.8.8.8.1.m1.1.1.3">train</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.T1.8.8.8.1.m1.1c">\mathcal{D}_{\text{train}}</annotation><annotation encoding="application/x-llamapun" id="S4.T1.8.8.8.1.m1.1d">caligraphic_D start_POSTSUBSCRIPT train end_POSTSUBSCRIPT</annotation></semantics></math></td>
<td class="ltx_td ltx_align_center" id="S4.T1.8.8.8.2">264843</td>
<td class="ltx_td ltx_align_center" id="S4.T1.8.8.8.3">2015-11-21</td>
<td class="ltx_td ltx_align_center" id="S4.T1.8.8.8.4">2015-11-24</td>
</tr>
<tr class="ltx_tr" id="S4.T1.9.9.9">
<td class="ltx_td ltx_align_center ltx_border_bb" id="S4.T1.9.9.9.1"><math alttext="\mathcal{D}_{\text{test}}" class="ltx_Math" display="inline" id="S4.T1.9.9.9.1.m1.1"><semantics id="S4.T1.9.9.9.1.m1.1a"><msub id="S4.T1.9.9.9.1.m1.1.1" xref="S4.T1.9.9.9.1.m1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.T1.9.9.9.1.m1.1.1.2" xref="S4.T1.9.9.9.1.m1.1.1.2.cmml">𝒟</mi><mtext id="S4.T1.9.9.9.1.m1.1.1.3" xref="S4.T1.9.9.9.1.m1.1.1.3a.cmml">test</mtext></msub><annotation-xml encoding="MathML-Content" id="S4.T1.9.9.9.1.m1.1b"><apply id="S4.T1.9.9.9.1.m1.1.1.cmml" xref="S4.T1.9.9.9.1.m1.1.1"><csymbol cd="ambiguous" id="S4.T1.9.9.9.1.m1.1.1.1.cmml" xref="S4.T1.9.9.9.1.m1.1.1">subscript</csymbol><ci id="S4.T1.9.9.9.1.m1.1.1.2.cmml" xref="S4.T1.9.9.9.1.m1.1.1.2">𝒟</ci><ci id="S4.T1.9.9.9.1.m1.1.1.3a.cmml" xref="S4.T1.9.9.9.1.m1.1.1.3"><mtext id="S4.T1.9.9.9.1.m1.1.1.3.cmml" mathsize="70%" xref="S4.T1.9.9.9.1.m1.1.1.3">test</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.T1.9.9.9.1.m1.1c">\mathcal{D}_{\text{test}}</annotation><annotation encoding="application/x-llamapun" id="S4.T1.9.9.9.1.m1.1d">caligraphic_D start_POSTSUBSCRIPT test end_POSTSUBSCRIPT</annotation></semantics></math></td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S4.T1.9.9.9.2">431646</td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S4.T1.9.9.9.3">2015-11-25</td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S4.T1.9.9.9.4">2015-11-30</td>
</tr>
</tbody>
</table>
</span></div>
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_table"><span class="ltx_text" id="S4.T1.11.1.1" style="font-size:90%;">Table 1</span>. </span><span class="ltx_text" id="S4.T1.12.2" style="font-size:90%;">Datasets</span></figcaption>
</figure>
</section>
<section class="ltx_subsection" id="S4.SS2">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.2. </span>Evaluation Metrics</h3>
<div class="ltx_para" id="S4.SS2.p1">
<p class="ltx_p" id="S4.SS2.p1.1">In the CTR prediction task, the area under the ROC curve (AUC) and negative log-likelihood (LogLoss) are widely used metrics. AUC measures the probability that a randomly chosen positive sample will be ranked higher than a randomly chosen negative sample, while Logloss quantifies the difference between the predicted probability and the actual label. We choose these two metrics to evaluate the model performance.</p>
</div>
</section>
<section class="ltx_subsection" id="S4.SS3">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.3. </span>Compared Methods</h3>
<div class="ltx_para" id="S4.SS3.p1">
<p class="ltx_p" id="S4.SS3.p1.1">To evaluate the effectiveness of our proposed architecture, we choose six commonly used and strong models as backbones, which can be grouped into two classes.</p>
</div>
<section class="ltx_subsubsection" id="S4.SS3.SSS1">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">4.3.1. </span>Feature interaction based Models</h4>
<div class="ltx_para" id="S4.SS3.SSS1.p1">
<p class="ltx_p" id="S4.SS3.SSS1.p1.1">The first class includes some traditional feature interaction based tabular models. DNN represents multilayer perceptron (MLP), a simple feedforward artificial neural network. DeepFM <cite class="ltx_cite ltx_citemacro_citep">(Guo et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2404.15678v4#bib.bib8" title="">2017</a>)</cite> is an architecture that combines the factorization machine and deep neural network. PNN <cite class="ltx_cite ltx_citemacro_citep">(Qu et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2404.15678v4#bib.bib28" title="">2018</a>)</cite> is a product-based neural network which captures both inter-field interactive patterns and high-order feature interactions.</p>
</div>
</section>
<section class="ltx_subsubsection" id="S4.SS3.SSS2">
<h4 class="ltx_title ltx_title_subsubsection">
<span class="ltx_tag ltx_tag_subsubsection">4.3.2. </span>Sequential based Models</h4>
<div class="ltx_para" id="S4.SS3.SSS2.p1">
<p class="ltx_p" id="S4.SS3.SSS2.p1.1">The second class contains several sequential end-to-end deep models. Transformer <cite class="ltx_cite ltx_citemacro_citep">(Vaswani et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2404.15678v4#bib.bib36" title="">2017</a>)</cite> is a sequence-to-sequence model based on self-attention mechanism. Here, we use its encoder to model users’ history behaviors. DIN <cite class="ltx_cite ltx_citemacro_citep">(Zhou et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2404.15678v4#bib.bib50" title="">2018</a>)</cite> and DIEN <cite class="ltx_cite ltx_citemacro_citep">(Zhou et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2404.15678v4#bib.bib49" title="">2019</a>)</cite>are two attention-based sequential models, while DIEN adds a recurrent neural network based on DIN.</p>
</div>
<figure class="ltx_table" id="S4.T2">
<table class="ltx_tabular ltx_guessed_headers ltx_align_middle" id="S4.T2.4">
<thead class="ltx_thead">
<tr class="ltx_tr" id="S4.T2.4.1.1">
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_th_row ltx_border_tt" colspan="2" id="S4.T2.4.1.1.1" rowspan="2"><span class="ltx_text" id="S4.T2.4.1.1.1.1">Models</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" colspan="3" id="S4.T2.4.1.1.2">Taobao</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" colspan="3" id="S4.T2.4.1.1.3">Tmall</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" colspan="3" id="S4.T2.4.1.1.4">Alipay</th>
</tr>
<tr class="ltx_tr" id="S4.T2.4.2.2">
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" id="S4.T2.4.2.2.1">LogLoss</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" id="S4.T2.4.2.2.2">AUC</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" id="S4.T2.4.2.2.3">Rel. Impr.</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" id="S4.T2.4.2.2.4">LogLoss</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" id="S4.T2.4.2.2.5">AUC</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" id="S4.T2.4.2.2.6">Rel. Impr.</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" id="S4.T2.4.2.2.7">LogLoss</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" id="S4.T2.4.2.2.8">AUC</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" id="S4.T2.4.2.2.9">Rel. Impr.</th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr class="ltx_tr" id="S4.T2.4.3.1">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r ltx_border_t" id="S4.T2.4.3.1.1" rowspan="6"><span class="ltx_text" id="S4.T2.4.3.1.1.1">Original</span></th>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T2.4.3.1.2">DNN</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T2.4.3.1.3">0.6454</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T2.4.3.1.4">0.6744</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T2.4.3.1.5">-</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T2.4.3.1.6">0.4259</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T2.4.3.1.7">0.8890</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T2.4.3.1.8">-</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T2.4.3.1.9">0.6230</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T2.4.3.1.10">0.7011</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T2.4.3.1.11">-</td>
</tr>
<tr class="ltx_tr" id="S4.T2.4.4.2">
<td class="ltx_td ltx_align_center" id="S4.T2.4.4.2.1">DeepFM</td>
<td class="ltx_td ltx_align_center" id="S4.T2.4.4.2.2">0.6591</td>
<td class="ltx_td ltx_align_center" id="S4.T2.4.4.2.3">0.6545</td>
<td class="ltx_td ltx_align_center" id="S4.T2.4.4.2.4">-</td>
<td class="ltx_td ltx_align_center" id="S4.T2.4.4.2.5">0.4264</td>
<td class="ltx_td ltx_align_center" id="S4.T2.4.4.2.6">0.8885</td>
<td class="ltx_td ltx_align_center" id="S4.T2.4.4.2.7">-</td>
<td class="ltx_td ltx_align_center" id="S4.T2.4.4.2.8">0.6375</td>
<td class="ltx_td ltx_align_center" id="S4.T2.4.4.2.9">0.6803</td>
<td class="ltx_td ltx_align_center" id="S4.T2.4.4.2.10">-</td>
</tr>
<tr class="ltx_tr" id="S4.T2.4.5.3">
<td class="ltx_td ltx_align_center" id="S4.T2.4.5.3.1">PNN</td>
<td class="ltx_td ltx_align_center" id="S4.T2.4.5.3.2">0.6469</td>
<td class="ltx_td ltx_align_center" id="S4.T2.4.5.3.3">0.6787</td>
<td class="ltx_td ltx_align_center" id="S4.T2.4.5.3.4">-</td>
<td class="ltx_td ltx_align_center" id="S4.T2.4.5.3.5">0.4274</td>
<td class="ltx_td ltx_align_center" id="S4.T2.4.5.3.6">0.8949</td>
<td class="ltx_td ltx_align_center" id="S4.T2.4.5.3.7">-</td>
<td class="ltx_td ltx_align_center" id="S4.T2.4.5.3.8">0.6253</td>
<td class="ltx_td ltx_align_center" id="S4.T2.4.5.3.9">0.7130</td>
<td class="ltx_td ltx_align_center" id="S4.T2.4.5.3.10">-</td>
</tr>
<tr class="ltx_tr" id="S4.T2.4.6.4">
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T2.4.6.4.1">Transformer</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T2.4.6.4.2">0.6757</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T2.4.6.4.3">0.5990</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T2.4.6.4.4">-</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T2.4.6.4.5">0.4644</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T2.4.6.4.6">0.8609</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T2.4.6.4.7">-</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T2.4.6.4.8">0.6761</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T2.4.6.4.9">0.6523</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T2.4.6.4.10">-</td>
</tr>
<tr class="ltx_tr" id="S4.T2.4.7.5">
<td class="ltx_td ltx_align_center" id="S4.T2.4.7.5.1">DIN</td>
<td class="ltx_td ltx_align_center" id="S4.T2.4.7.5.2">0.6267</td>
<td class="ltx_td ltx_align_center" id="S4.T2.4.7.5.3">0.7040</td>
<td class="ltx_td ltx_align_center" id="S4.T2.4.7.5.4">-</td>
<td class="ltx_td ltx_align_center" id="S4.T2.4.7.5.5">0.4301</td>
<td class="ltx_td ltx_align_center" id="S4.T2.4.7.5.6">0.8820</td>
<td class="ltx_td ltx_align_center" id="S4.T2.4.7.5.7">-</td>
<td class="ltx_td ltx_align_center" id="S4.T2.4.7.5.8">0.6257</td>
<td class="ltx_td ltx_align_center" id="S4.T2.4.7.5.9">0.7333</td>
<td class="ltx_td ltx_align_center" id="S4.T2.4.7.5.10">-</td>
</tr>
<tr class="ltx_tr" id="S4.T2.4.8.6">
<td class="ltx_td ltx_align_center" id="S4.T2.4.8.6.1">DIEN</td>
<td class="ltx_td ltx_align_center" id="S4.T2.4.8.6.2">0.6328</td>
<td class="ltx_td ltx_align_center" id="S4.T2.4.8.6.3">0.6947</td>
<td class="ltx_td ltx_align_center" id="S4.T2.4.8.6.4">-</td>
<td class="ltx_td ltx_align_center" id="S4.T2.4.8.6.5">0.3930</td>
<td class="ltx_td ltx_align_center" id="S4.T2.4.8.6.6">0.9037</td>
<td class="ltx_td ltx_align_center" id="S4.T2.4.8.6.7">-</td>
<td class="ltx_td ltx_align_center" id="S4.T2.4.8.6.8">0.6295</td>
<td class="ltx_td ltx_align_center" id="S4.T2.4.8.6.9">0.7218</td>
<td class="ltx_td ltx_align_center" id="S4.T2.4.8.6.10">-</td>
</tr>
<tr class="ltx_tr" id="S4.T2.4.9.7">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_r ltx_border_tt" id="S4.T2.4.9.7.1" rowspan="6"><span class="ltx_text" id="S4.T2.4.9.7.1.1">Retrieval</span></th>
<td class="ltx_td ltx_align_center ltx_border_tt" id="S4.T2.4.9.7.2">DNN</td>
<td class="ltx_td ltx_align_center ltx_border_tt" id="S4.T2.4.9.7.3">0.4525</td>
<td class="ltx_td ltx_align_center ltx_border_tt" id="S4.T2.4.9.7.4">0.8633</td>
<td class="ltx_td ltx_align_center ltx_border_tt" id="S4.T2.4.9.7.5">28.00%</td>
<td class="ltx_td ltx_align_center ltx_border_tt" id="S4.T2.4.9.7.6">0.2985</td>
<td class="ltx_td ltx_align_center ltx_border_tt" id="S4.T2.4.9.7.7">0.9446</td>
<td class="ltx_td ltx_align_center ltx_border_tt" id="S4.T2.4.9.7.8">6.26%</td>
<td class="ltx_td ltx_align_center ltx_border_tt" id="S4.T2.4.9.7.9">0.4897</td>
<td class="ltx_td ltx_align_center ltx_border_tt" id="S4.T2.4.9.7.10">0.8455</td>
<td class="ltx_td ltx_align_center ltx_border_tt" id="S4.T2.4.9.7.11">20.60%</td>
</tr>
<tr class="ltx_tr" id="S4.T2.4.10.8">
<td class="ltx_td ltx_align_center" id="S4.T2.4.10.8.1">DeepFM</td>
<td class="ltx_td ltx_align_center" id="S4.T2.4.10.8.2">0.4566</td>
<td class="ltx_td ltx_align_center" id="S4.T2.4.10.8.3">0.8614</td>
<td class="ltx_td ltx_align_center" id="S4.T2.4.10.8.4">31.61%</td>
<td class="ltx_td ltx_align_center" id="S4.T2.4.10.8.5">0.3016</td>
<td class="ltx_td ltx_align_center" id="S4.T2.4.10.8.6">0.9443</td>
<td class="ltx_td ltx_align_center" id="S4.T2.4.10.8.7">6.27%</td>
<td class="ltx_td ltx_align_center" id="S4.T2.4.10.8.8">0.4694</td>
<td class="ltx_td ltx_align_center" id="S4.T2.4.10.8.9">0.8583</td>
<td class="ltx_td ltx_align_center" id="S4.T2.4.10.8.10">26.16%</td>
</tr>
<tr class="ltx_tr" id="S4.T2.4.11.9">
<td class="ltx_td ltx_align_center" id="S4.T2.4.11.9.1">PNN</td>
<td class="ltx_td ltx_align_center" id="S4.T2.4.11.9.2">0.4576</td>
<td class="ltx_td ltx_align_center" id="S4.T2.4.11.9.3">0.8606</td>
<td class="ltx_td ltx_align_center" id="S4.T2.4.11.9.4">26.81%</td>
<td class="ltx_td ltx_align_center" id="S4.T2.4.11.9.5">0.3054</td>
<td class="ltx_td ltx_align_center" id="S4.T2.4.11.9.6">0.9468</td>
<td class="ltx_td ltx_align_center" id="S4.T2.4.11.9.7">5.80%</td>
<td class="ltx_td ltx_align_center" id="S4.T2.4.11.9.8">0.4429</td>
<td class="ltx_td ltx_align_center" id="S4.T2.4.11.9.9">0.8748</td>
<td class="ltx_td ltx_align_center" id="S4.T2.4.11.9.10">22.68%</td>
</tr>
<tr class="ltx_tr" id="S4.T2.4.12.10">
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T2.4.12.10.1">Transformer</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T2.4.12.10.2">0.4614</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T2.4.12.10.3">0.8557</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T2.4.12.10.4">42.86%</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T2.4.12.10.5">0.3459</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T2.4.12.10.6">0.9249</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T2.4.12.10.7">7.44%</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T2.4.12.10.8">0.5606</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T2.4.12.10.9">0.7984</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T2.4.12.10.10">21.23%</td>
</tr>
<tr class="ltx_tr" id="S4.T2.4.13.11">
<td class="ltx_td ltx_align_center" id="S4.T2.4.13.11.1">DIN</td>
<td class="ltx_td ltx_align_center" id="S4.T2.4.13.11.2">0.5558</td>
<td class="ltx_td ltx_align_center" id="S4.T2.4.13.11.3">0.7906</td>
<td class="ltx_td ltx_align_center" id="S4.T2.4.13.11.4">12.30%</td>
<td class="ltx_td ltx_align_center" id="S4.T2.4.13.11.5">0.3239</td>
<td class="ltx_td ltx_align_center" id="S4.T2.4.13.11.6">0.9354</td>
<td class="ltx_td ltx_align_center" id="S4.T2.4.13.11.7">6.05%</td>
<td class="ltx_td ltx_align_center" id="S4.T2.4.13.11.8">0.5626</td>
<td class="ltx_td ltx_align_center" id="S4.T2.4.13.11.9">0.7826</td>
<td class="ltx_td ltx_align_center" id="S4.T2.4.13.11.10">6.72%</td>
</tr>
<tr class="ltx_tr" id="S4.T2.4.14.12">
<td class="ltx_td ltx_align_center" id="S4.T2.4.14.12.1">DIEN</td>
<td class="ltx_td ltx_align_center" id="S4.T2.4.14.12.2">0.5733</td>
<td class="ltx_td ltx_align_center" id="S4.T2.4.14.12.3">0.7702</td>
<td class="ltx_td ltx_align_center" id="S4.T2.4.14.12.4">10.87%</td>
<td class="ltx_td ltx_align_center" id="S4.T2.4.14.12.5">0.3226</td>
<td class="ltx_td ltx_align_center" id="S4.T2.4.14.12.6">0.9371</td>
<td class="ltx_td ltx_align_center" id="S4.T2.4.14.12.7">3.10%</td>
<td class="ltx_td ltx_align_center" id="S4.T2.4.14.12.8">0.5810</td>
<td class="ltx_td ltx_align_center" id="S4.T2.4.14.12.9">0.7684</td>
<td class="ltx_td ltx_align_center" id="S4.T2.4.14.12.10">6.46%</td>
</tr>
<tr class="ltx_tr" id="S4.T2.4.15.13">
<th class="ltx_td ltx_align_center ltx_th ltx_th_row ltx_border_bb ltx_border_r ltx_border_tt" id="S4.T2.4.15.13.1" rowspan="6"><span class="ltx_text" id="S4.T2.4.15.13.1.1">Distill</span></th>
<td class="ltx_td ltx_align_center ltx_border_tt" id="S4.T2.4.15.13.2">DNN</td>
<td class="ltx_td ltx_align_center ltx_border_tt" id="S4.T2.4.15.13.3">0.7201</td>
<td class="ltx_td ltx_align_center ltx_border_tt" id="S4.T2.4.15.13.4">0.7224</td>
<td class="ltx_td ltx_align_center ltx_border_tt" id="S4.T2.4.15.13.5">7.11%</td>
<td class="ltx_td ltx_align_center ltx_border_tt" id="S4.T2.4.15.13.6">0.4100</td>
<td class="ltx_td ltx_align_center ltx_border_tt" id="S4.T2.4.15.13.7">0.8961</td>
<td class="ltx_td ltx_align_center ltx_border_tt" id="S4.T2.4.15.13.8">0.80%</td>
<td class="ltx_td ltx_align_center ltx_border_tt" id="S4.T2.4.15.13.9">0.5972</td>
<td class="ltx_td ltx_align_center ltx_border_tt" id="S4.T2.4.15.13.10">0.7423</td>
<td class="ltx_td ltx_align_center ltx_border_tt" id="S4.T2.4.15.13.11">5.88%</td>
</tr>
<tr class="ltx_tr" id="S4.T2.4.16.14">
<td class="ltx_td ltx_align_center" id="S4.T2.4.16.14.1">DeepFM</td>
<td class="ltx_td ltx_align_center" id="S4.T2.4.16.14.2">0.6144</td>
<td class="ltx_td ltx_align_center" id="S4.T2.4.16.14.3">0.7192</td>
<td class="ltx_td ltx_align_center" id="S4.T2.4.16.14.4">9.88%</td>
<td class="ltx_td ltx_align_center" id="S4.T2.4.16.14.5">0.4108</td>
<td class="ltx_td ltx_align_center" id="S4.T2.4.16.14.6">0.8961</td>
<td class="ltx_td ltx_align_center" id="S4.T2.4.16.14.7">0.86%</td>
<td class="ltx_td ltx_align_center" id="S4.T2.4.16.14.8">0.5900</td>
<td class="ltx_td ltx_align_center" id="S4.T2.4.16.14.9">0.7532</td>
<td class="ltx_td ltx_align_center" id="S4.T2.4.16.14.10">10.72%</td>
</tr>
<tr class="ltx_tr" id="S4.T2.4.17.15">
<td class="ltx_td ltx_align_center" id="S4.T2.4.17.15.1">PNN</td>
<td class="ltx_td ltx_align_center" id="S4.T2.4.17.15.2">0.6106</td>
<td class="ltx_td ltx_align_center" id="S4.T2.4.17.15.3">0.7269</td>
<td class="ltx_td ltx_align_center" id="S4.T2.4.17.15.4">7.10%</td>
<td class="ltx_td ltx_align_center" id="S4.T2.4.17.15.5">0.4061</td>
<td class="ltx_td ltx_align_center" id="S4.T2.4.17.15.6">0.9026</td>
<td class="ltx_td ltx_align_center" id="S4.T2.4.17.15.7">0.87%</td>
<td class="ltx_td ltx_align_center" id="S4.T2.4.17.15.8">0.5686</td>
<td class="ltx_td ltx_align_center" id="S4.T2.4.17.15.9">0.7713</td>
<td class="ltx_td ltx_align_center" id="S4.T2.4.17.15.10">8.17%</td>
</tr>
<tr class="ltx_tr" id="S4.T2.4.18.16">
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T2.4.18.16.1">Transformer</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T2.4.18.16.2">0.6263</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T2.4.18.16.3">0.6953</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T2.4.18.16.4">16.09%</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T2.4.18.16.5">0.4237</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T2.4.18.16.6">0.8940</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T2.4.18.16.7">3.85%</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T2.4.18.16.8">0.6227</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T2.4.18.16.9">0.7196</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T2.4.18.16.10">10.3%</td>
</tr>
<tr class="ltx_tr" id="S4.T2.4.19.17">
<td class="ltx_td ltx_align_center" id="S4.T2.4.19.17.1">DIN</td>
<td class="ltx_td ltx_align_center" id="S4.T2.4.19.17.2">0.5956</td>
<td class="ltx_td ltx_align_center" id="S4.T2.4.19.17.3">0.7420</td>
<td class="ltx_td ltx_align_center" id="S4.T2.4.19.17.4">5.40%</td>
<td class="ltx_td ltx_align_center" id="S4.T2.4.19.17.5">0.3812</td>
<td class="ltx_td ltx_align_center" id="S4.T2.4.19.17.6">0.9152</td>
<td class="ltx_td ltx_align_center" id="S4.T2.4.19.17.7">3.76%</td>
<td class="ltx_td ltx_align_center" id="S4.T2.4.19.17.8">0.5927</td>
<td class="ltx_td ltx_align_center" id="S4.T2.4.19.17.9">0.7425</td>
<td class="ltx_td ltx_align_center" id="S4.T2.4.19.17.10">1.25%</td>
</tr>
<tr class="ltx_tr" id="S4.T2.4.20.18">
<td class="ltx_td ltx_align_center ltx_border_bb" id="S4.T2.4.20.18.1">DIEN</td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S4.T2.4.20.18.2">0.6099</td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S4.T2.4.20.18.3">0.7176</td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S4.T2.4.20.18.4">3.29%</td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S4.T2.4.20.18.5">0.3690</td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S4.T2.4.20.18.6">0.9157</td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S4.T2.4.20.18.7">1.33%</td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S4.T2.4.20.18.8">0.6230</td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S4.T2.4.20.18.9">0.7562</td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S4.T2.4.20.18.10">4.77%</td>
</tr>
</tbody>
</table>
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_table"><span class="ltx_text" id="S4.T2.5.2.1" style="font-size:90%;">Table 2</span>. </span><span class="ltx_text" id="S4.T2.2.1" style="font-size:90%;">Performance comparison of CTR prediction task. Rel.Impr means relative
AUC improvement rate against each original model. Improvements are statistically significant with <math alttext="p&lt;0.01" class="ltx_Math" display="inline" id="S4.T2.2.1.m1.1"><semantics id="S4.T2.2.1.m1.1b"><mrow id="S4.T2.2.1.m1.1.1" xref="S4.T2.2.1.m1.1.1.cmml"><mi id="S4.T2.2.1.m1.1.1.2" xref="S4.T2.2.1.m1.1.1.2.cmml">p</mi><mo id="S4.T2.2.1.m1.1.1.1" xref="S4.T2.2.1.m1.1.1.1.cmml">&lt;</mo><mn id="S4.T2.2.1.m1.1.1.3" xref="S4.T2.2.1.m1.1.1.3.cmml">0.01</mn></mrow><annotation-xml encoding="MathML-Content" id="S4.T2.2.1.m1.1c"><apply id="S4.T2.2.1.m1.1.1.cmml" xref="S4.T2.2.1.m1.1.1"><lt id="S4.T2.2.1.m1.1.1.1.cmml" xref="S4.T2.2.1.m1.1.1.1"></lt><ci id="S4.T2.2.1.m1.1.1.2.cmml" xref="S4.T2.2.1.m1.1.1.2">𝑝</ci><cn id="S4.T2.2.1.m1.1.1.3.cmml" type="float" xref="S4.T2.2.1.m1.1.1.3">0.01</cn></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.T2.2.1.m1.1d">p&lt;0.01</annotation><annotation encoding="application/x-llamapun" id="S4.T2.2.1.m1.1e">italic_p &lt; 0.01</annotation></semantics></math>.</span></figcaption>
</figure>
<figure class="ltx_table" id="S4.T3">
<table class="ltx_tabular ltx_guessed_headers ltx_align_middle" id="S4.T3.2">
<thead class="ltx_thead">
<tr class="ltx_tr" id="S4.T3.2.3.1">
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" colspan="2" id="S4.T3.2.3.1.1" rowspan="2"><span class="ltx_text" id="S4.T3.2.3.1.1.1">Models</span></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" colspan="2" id="S4.T3.2.3.1.2">Taobao</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" colspan="2" id="S4.T3.2.3.1.3">Tmall</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" colspan="2" id="S4.T3.2.3.1.4">Alipay</th>
</tr>
<tr class="ltx_tr" id="S4.T3.2.4.2">
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" id="S4.T3.2.4.2.1">LogLoss</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" id="S4.T3.2.4.2.2">AUC</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" id="S4.T3.2.4.2.3">LogLoss</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" id="S4.T3.2.4.2.4">AUC</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" id="S4.T3.2.4.2.5">LogLoss</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_t" id="S4.T3.2.4.2.6">AUC</th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr class="ltx_tr" id="S4.T3.1.1">
<td class="ltx_td ltx_align_center ltx_border_r ltx_border_t" id="S4.T3.1.1.1" rowspan="3"><span class="ltx_text" id="S4.T3.1.1.1.1">relevance network pretrained with <math alttext="\mathcal{D}_{\text{train}}" class="ltx_Math" display="inline" id="S4.T3.1.1.1.1.m1.1"><semantics id="S4.T3.1.1.1.1.m1.1a"><msub id="S4.T3.1.1.1.1.m1.1.1" xref="S4.T3.1.1.1.1.m1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.T3.1.1.1.1.m1.1.1.2" xref="S4.T3.1.1.1.1.m1.1.1.2.cmml">𝒟</mi><mtext id="S4.T3.1.1.1.1.m1.1.1.3" xref="S4.T3.1.1.1.1.m1.1.1.3a.cmml">train</mtext></msub><annotation-xml encoding="MathML-Content" id="S4.T3.1.1.1.1.m1.1b"><apply id="S4.T3.1.1.1.1.m1.1.1.cmml" xref="S4.T3.1.1.1.1.m1.1.1"><csymbol cd="ambiguous" id="S4.T3.1.1.1.1.m1.1.1.1.cmml" xref="S4.T3.1.1.1.1.m1.1.1">subscript</csymbol><ci id="S4.T3.1.1.1.1.m1.1.1.2.cmml" xref="S4.T3.1.1.1.1.m1.1.1.2">𝒟</ci><ci id="S4.T3.1.1.1.1.m1.1.1.3a.cmml" xref="S4.T3.1.1.1.1.m1.1.1.3"><mtext id="S4.T3.1.1.1.1.m1.1.1.3.cmml" mathsize="70%" xref="S4.T3.1.1.1.1.m1.1.1.3">train</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.T3.1.1.1.1.m1.1c">\mathcal{D}_{\text{train}}</annotation><annotation encoding="application/x-llamapun" id="S4.T3.1.1.1.1.m1.1d">caligraphic_D start_POSTSUBSCRIPT train end_POSTSUBSCRIPT</annotation></semantics></math></span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T3.1.1.2">DNN</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T3.1.1.3">0.6210</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T3.1.1.4">0.7139</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T3.1.1.5">0.3373</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T3.1.1.6">0.9291</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T3.1.1.7">0.6227</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T3.1.1.8">0.7070</td>
</tr>
<tr class="ltx_tr" id="S4.T3.2.5.1">
<td class="ltx_td ltx_align_center" id="S4.T3.2.5.1.1">DeepFM</td>
<td class="ltx_td ltx_align_center" id="S4.T3.2.5.1.2">0.6239</td>
<td class="ltx_td ltx_align_center" id="S4.T3.2.5.1.3">0.7109</td>
<td class="ltx_td ltx_align_center" id="S4.T3.2.5.1.4">0.3337</td>
<td class="ltx_td ltx_align_center" id="S4.T3.2.5.1.5">0.9320</td>
<td class="ltx_td ltx_align_center" id="S4.T3.2.5.1.6">0.6300</td>
<td class="ltx_td ltx_align_center" id="S4.T3.2.5.1.7">0.6966</td>
</tr>
<tr class="ltx_tr" id="S4.T3.2.6.2">
<td class="ltx_td ltx_align_center" id="S4.T3.2.6.2.1">PNN</td>
<td class="ltx_td ltx_align_center" id="S4.T3.2.6.2.2">0.6188</td>
<td class="ltx_td ltx_align_center" id="S4.T3.2.6.2.3">0.7226</td>
<td class="ltx_td ltx_align_center" id="S4.T3.2.6.2.4">0.3272</td>
<td class="ltx_td ltx_align_center" id="S4.T3.2.6.2.5">0.9405</td>
<td class="ltx_td ltx_align_center" id="S4.T3.2.6.2.6">0.6063</td>
<td class="ltx_td ltx_align_center" id="S4.T3.2.6.2.7">0.7339</td>
</tr>
<tr class="ltx_tr" id="S4.T3.2.2">
<td class="ltx_td ltx_align_center ltx_border_bb ltx_border_r ltx_border_t" id="S4.T3.2.2.1" rowspan="3"><span class="ltx_text" id="S4.T3.2.2.1.1">relevance network pretrained with <math alttext="\mathcal{D}_{\text{shifting}}" class="ltx_Math" display="inline" id="S4.T3.2.2.1.1.m1.1"><semantics id="S4.T3.2.2.1.1.m1.1a"><msub id="S4.T3.2.2.1.1.m1.1.1" xref="S4.T3.2.2.1.1.m1.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.T3.2.2.1.1.m1.1.1.2" xref="S4.T3.2.2.1.1.m1.1.1.2.cmml">𝒟</mi><mtext id="S4.T3.2.2.1.1.m1.1.1.3" xref="S4.T3.2.2.1.1.m1.1.1.3a.cmml">shifting</mtext></msub><annotation-xml encoding="MathML-Content" id="S4.T3.2.2.1.1.m1.1b"><apply id="S4.T3.2.2.1.1.m1.1.1.cmml" xref="S4.T3.2.2.1.1.m1.1.1"><csymbol cd="ambiguous" id="S4.T3.2.2.1.1.m1.1.1.1.cmml" xref="S4.T3.2.2.1.1.m1.1.1">subscript</csymbol><ci id="S4.T3.2.2.1.1.m1.1.1.2.cmml" xref="S4.T3.2.2.1.1.m1.1.1.2">𝒟</ci><ci id="S4.T3.2.2.1.1.m1.1.1.3a.cmml" xref="S4.T3.2.2.1.1.m1.1.1.3"><mtext id="S4.T3.2.2.1.1.m1.1.1.3.cmml" mathsize="70%" xref="S4.T3.2.2.1.1.m1.1.1.3">shifting</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.T3.2.2.1.1.m1.1c">\mathcal{D}_{\text{shifting}}</annotation><annotation encoding="application/x-llamapun" id="S4.T3.2.2.1.1.m1.1d">caligraphic_D start_POSTSUBSCRIPT shifting end_POSTSUBSCRIPT</annotation></semantics></math></span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T3.2.2.2">DNN</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T3.2.2.3">0.5224</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T3.2.2.4">0.8163</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T3.2.2.5">0.3141</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T3.2.2.6">0.9398</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T3.2.2.7">0.5006</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T3.2.2.8">0.8396</td>
</tr>
<tr class="ltx_tr" id="S4.T3.2.7.3">
<td class="ltx_td ltx_align_center" id="S4.T3.2.7.3.1">DeepFM</td>
<td class="ltx_td ltx_align_center" id="S4.T3.2.7.3.2">0.5183</td>
<td class="ltx_td ltx_align_center" id="S4.T3.2.7.3.3">0.8169</td>
<td class="ltx_td ltx_align_center" id="S4.T3.2.7.3.4">0.3103</td>
<td class="ltx_td ltx_align_center" id="S4.T3.2.7.3.5">0.9405</td>
<td class="ltx_td ltx_align_center" id="S4.T3.2.7.3.6">0.4724</td>
<td class="ltx_td ltx_align_center" id="S4.T3.2.7.3.7">0.8564</td>
</tr>
<tr class="ltx_tr" id="S4.T3.2.8.4">
<td class="ltx_td ltx_align_center ltx_border_bb" id="S4.T3.2.8.4.1">PNN</td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S4.T3.2.8.4.2">0.5087</td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S4.T3.2.8.4.3">0.8256</td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S4.T3.2.8.4.4">0.3179</td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S4.T3.2.8.4.5">0.9438</td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S4.T3.2.8.4.6">0.4446</td>
<td class="ltx_td ltx_align_center ltx_border_bb" id="S4.T3.2.8.4.7">0.8744</td>
</tr>
</tbody>
</table>
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_table"><span class="ltx_text" id="S4.T3.4.1.1" style="font-size:90%;">Table 3</span>. </span><span class="ltx_text" id="S4.T3.5.2" style="font-size:90%;">Performance comparison of pretrained relevance network in Retrieval Framework.</span></figcaption>
</figure>
<figure class="ltx_table" id="S4.T4">
<table class="ltx_tabular ltx_guessed_headers ltx_align_middle" id="S4.T4.2">
<thead class="ltx_thead">
<tr class="ltx_tr" id="S4.T4.2.1.1">
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="S4.T4.2.1.1.1">Loss Functions</th>
<th class="ltx_td ltx_th ltx_th_column ltx_border_tt" id="S4.T4.2.1.1.2"></th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="S4.T4.2.1.1.3">Taobao</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="S4.T4.2.1.1.4">Tmall</th>
<th class="ltx_td ltx_align_center ltx_th ltx_th_column ltx_border_tt" id="S4.T4.2.1.1.5">Alipay</th>
</tr>
</thead>
<tbody class="ltx_tbody">
<tr class="ltx_tr" id="S4.T4.2.2.1">
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T4.2.2.1.1" rowspan="3"><span class="ltx_text" id="S4.T4.2.2.1.1.1">Mean Squared Error loss</span></td>
<td class="ltx_td ltx_align_center ltx_border_tt" id="S4.T4.2.2.1.2">DNN</td>
<td class="ltx_td ltx_align_center ltx_border_tt" id="S4.T4.2.2.1.3">0.7224</td>
<td class="ltx_td ltx_align_center ltx_border_tt" id="S4.T4.2.2.1.4">0.8961</td>
<td class="ltx_td ltx_align_center ltx_border_tt" id="S4.T4.2.2.1.5">0.7423</td>
</tr>
<tr class="ltx_tr" id="S4.T4.2.3.2">
<td class="ltx_td ltx_align_center" id="S4.T4.2.3.2.1">DeepFM</td>
<td class="ltx_td ltx_align_center" id="S4.T4.2.3.2.2">0.7192</td>
<td class="ltx_td ltx_align_center" id="S4.T4.2.3.2.3">0.8961</td>
<td class="ltx_td ltx_align_center" id="S4.T4.2.3.2.4">0.7532</td>
</tr>
<tr class="ltx_tr" id="S4.T4.2.4.3">
<td class="ltx_td ltx_align_center" id="S4.T4.2.4.3.1">PNN</td>
<td class="ltx_td ltx_align_center" id="S4.T4.2.4.3.2">0.7269</td>
<td class="ltx_td ltx_align_center" id="S4.T4.2.4.3.3">0.9026</td>
<td class="ltx_td ltx_align_center" id="S4.T4.2.4.3.4">0.7713</td>
</tr>
<tr class="ltx_tr" id="S4.T4.2.5.4">
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T4.2.5.4.1" rowspan="3"><span class="ltx_text" id="S4.T4.2.5.4.1.1">Kullback-Leibler loss</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T4.2.5.4.2">DNN</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T4.2.5.4.3">0.7238</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T4.2.5.4.4">0.8937</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T4.2.5.4.5">0.7722</td>
</tr>
<tr class="ltx_tr" id="S4.T4.2.6.5">
<td class="ltx_td ltx_align_center" id="S4.T4.2.6.5.1">DeepFM</td>
<td class="ltx_td ltx_align_center" id="S4.T4.2.6.5.2">0.7220</td>
<td class="ltx_td ltx_align_center" id="S4.T4.2.6.5.3">0.8940</td>
<td class="ltx_td ltx_align_center" id="S4.T4.2.6.5.4">0.7661</td>
</tr>
<tr class="ltx_tr" id="S4.T4.2.7.6">
<td class="ltx_td ltx_align_center" id="S4.T4.2.7.6.1">PNN</td>
<td class="ltx_td ltx_align_center" id="S4.T4.2.7.6.2">0.7277</td>
<td class="ltx_td ltx_align_center" id="S4.T4.2.7.6.3">0.9013</td>
<td class="ltx_td ltx_align_center" id="S4.T4.2.7.6.4">0.7865</td>
</tr>
<tr class="ltx_tr" id="S4.T4.2.8.7">
<td class="ltx_td ltx_align_center ltx_border_bb ltx_border_b ltx_border_t" id="S4.T4.2.8.7.1" rowspan="3"><span class="ltx_text" id="S4.T4.2.8.7.1.1">Cosine Similarity loss</span></td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T4.2.8.7.2">DNN</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T4.2.8.7.3">0.7274</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T4.2.8.7.4">0.8936</td>
<td class="ltx_td ltx_align_center ltx_border_t" id="S4.T4.2.8.7.5">0.7649</td>
</tr>
<tr class="ltx_tr" id="S4.T4.2.9.8">
<td class="ltx_td ltx_align_center" id="S4.T4.2.9.8.1">DeepFM</td>
<td class="ltx_td ltx_align_center" id="S4.T4.2.9.8.2">0.7248</td>
<td class="ltx_td ltx_align_center" id="S4.T4.2.9.8.3">0.8940</td>
<td class="ltx_td ltx_align_center" id="S4.T4.2.9.8.4">0.7593</td>
</tr>
<tr class="ltx_tr" id="S4.T4.2.10.9">
<td class="ltx_td ltx_align_center ltx_border_bb ltx_border_b" id="S4.T4.2.10.9.1">PNN</td>
<td class="ltx_td ltx_align_center ltx_border_bb ltx_border_b" id="S4.T4.2.10.9.2">0.7301</td>
<td class="ltx_td ltx_align_center ltx_border_bb ltx_border_b" id="S4.T4.2.10.9.3">0.9030</td>
<td class="ltx_td ltx_align_center ltx_border_bb ltx_border_b" id="S4.T4.2.10.9.4">0.7791</td>
</tr>
</tbody>
</table>
<figcaption class="ltx_caption"><span class="ltx_tag ltx_tag_table"><span class="ltx_text" id="S4.T4.3.1.1" style="font-size:90%;">Table 4</span>. </span><span class="ltx_text" id="S4.T4.4.2" style="font-size:90%;">Distill Framework AUC of different distillation loss functions.
</span></figcaption>
</figure>
</section>
</section>
<section class="ltx_subsection" id="S4.SS4">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.4. </span>Overall Performance (RQ1)</h3>
<div class="ltx_para" id="S4.SS4.p1">
<p class="ltx_p" id="S4.SS4.p1.1">The results are listed in table <a class="ltx_ref" href="https://arxiv.org/html/2404.15678v4#S4.T2" title="Table 2 ‣ 4.3.2. Sequential based Models ‣ 4.3. Compared Methods ‣ 4. Experiments ‣ Retrieval and Distill: A Temporal Data Shift-Free Paradigm for Online Recommendation System"><span class="ltx_text ltx_ref_tag">2</span></a>. The results reveal the following insights.
i) In our experiments, sequence models, except the original Transformer model, outperformed factorization models. This indicates that increasing data volume is beneficial for recommendation systems.
ii) The Retrieval Framework utilizes shifting data as a search space and pretrains the relevance network with shifting data, significantly enhancing performance beyond the original model. This demonstrates the substantial benefit of shifting data for the original model.
iii) The Distill Framework employs the distilled relevance network to assist the original model. While predictive performance surpasses the original model, it falls short of models augmented by the Retrieval Framework, suggesting that the distilled relevance network retains valuable information, albeit with less incremental information than the retrieval model.
iv) The performance of feature interaction-based models within the Distill Framework has already surpassed that of the original sequence models. Moreover, as illustrated in Figure <a class="ltx_ref" href="https://arxiv.org/html/2404.15678v4#S4.F7" title="Figure 7 ‣ 4.8. The Study of Distill Loss Functions (RQ5) ‣ 4. Experiments ‣ Retrieval and Distill: A Temporal Data Shift-Free Paradigm for Online Recommendation System"><span class="ltx_text ltx_ref_tag">7</span></a>, the distillation method can enhance model performance without significantly increasing the inference burden</p>
</div>
</section>
<section class="ltx_subsection" id="S4.SS5">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.5. </span>Applying Knowledge Distillation to Non-Parametric Models (RQ2)</h3>
<div class="ltx_para" id="S4.SS5.p1">
<p class="ltx_p" id="S4.SS5.p1.1">Knowledge distillation is traditionally employed for transferring knowledge between parametric models, typically from a complex, larger model to a simpler, smaller one.
In this context, we extend the application of knowledge distillation to transfer knowledge from a non-parametric model (BM25 search) to a simple neural network.
As illustrated in Table <a class="ltx_ref" href="https://arxiv.org/html/2404.15678v4#S4.T2" title="Table 2 ‣ 4.3.2. Sequential based Models ‣ 4.3. Compared Methods ‣ 4. Experiments ‣ Retrieval and Distill: A Temporal Data Shift-Free Paradigm for Online Recommendation System"><span class="ltx_text ltx_ref_tag">2</span></a>, distilling information from the retrieval-based relevance network into the search-distill module demonstrates that the distilled student model can still significantly enhance the performance of the original model. However, compared to the direct use of the non-parametric model, performance is considerably reduced.
There is significant room for improvement in distilling information from non-parametric models into parametric models.</p>
</div>
</section>
<section class="ltx_subsection" id="S4.SS6">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.6. </span>Temporal Invariance of Association (RQ3)</h3>
<div class="ltx_para" id="S4.SS6.p1">
<p class="ltx_p" id="S4.SS6.p1.7">Table <a class="ltx_ref" href="https://arxiv.org/html/2404.15678v4#S4.T3" title="Table 3 ‣ 4.3.2. Sequential based Models ‣ 4.3. Compared Methods ‣ 4. Experiments ‣ Retrieval and Distill: A Temporal Data Shift-Free Paradigm for Online Recommendation System"><span class="ltx_text ltx_ref_tag">3</span></a> showcases a group of experiments designed to validate the theorem  <a class="ltx_ref" href="https://arxiv.org/html/2404.15678v4#S2.Thmtheorem1" title="Theorem 2.1. ‣ 2. PRELIMINARIES ‣ Retrieval and Distill: A Temporal Data Shift-Free Paradigm for Online Recommendation System"><span class="ltx_text ltx_ref_tag">2.1</span></a> of Temporal Invariance of Association.
The relevance network aids the original model in prediction in two ways: the additional information provided by the retrieved similar data <math alttext="x_{s}" class="ltx_Math" display="inline" id="S4.SS6.p1.1.m1.1"><semantics id="S4.SS6.p1.1.m1.1a"><msub id="S4.SS6.p1.1.m1.1.1" xref="S4.SS6.p1.1.m1.1.1.cmml"><mi id="S4.SS6.p1.1.m1.1.1.2" xref="S4.SS6.p1.1.m1.1.1.2.cmml">x</mi><mi id="S4.SS6.p1.1.m1.1.1.3" xref="S4.SS6.p1.1.m1.1.1.3.cmml">s</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS6.p1.1.m1.1b"><apply id="S4.SS6.p1.1.m1.1.1.cmml" xref="S4.SS6.p1.1.m1.1.1"><csymbol cd="ambiguous" id="S4.SS6.p1.1.m1.1.1.1.cmml" xref="S4.SS6.p1.1.m1.1.1">subscript</csymbol><ci id="S4.SS6.p1.1.m1.1.1.2.cmml" xref="S4.SS6.p1.1.m1.1.1.2">𝑥</ci><ci id="S4.SS6.p1.1.m1.1.1.3.cmml" xref="S4.SS6.p1.1.m1.1.1.3">𝑠</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS6.p1.1.m1.1c">x_{s}</annotation><annotation encoding="application/x-llamapun" id="S4.SS6.p1.1.m1.1d">italic_x start_POSTSUBSCRIPT italic_s end_POSTSUBSCRIPT</annotation></semantics></math>, and the information gain brought by pretraining with shifting data.
To eliminate the influence of <math alttext="x_{s}" class="ltx_Math" display="inline" id="S4.SS6.p1.2.m2.1"><semantics id="S4.SS6.p1.2.m2.1a"><msub id="S4.SS6.p1.2.m2.1.1" xref="S4.SS6.p1.2.m2.1.1.cmml"><mi id="S4.SS6.p1.2.m2.1.1.2" xref="S4.SS6.p1.2.m2.1.1.2.cmml">x</mi><mi id="S4.SS6.p1.2.m2.1.1.3" xref="S4.SS6.p1.2.m2.1.1.3.cmml">s</mi></msub><annotation-xml encoding="MathML-Content" id="S4.SS6.p1.2.m2.1b"><apply id="S4.SS6.p1.2.m2.1.1.cmml" xref="S4.SS6.p1.2.m2.1.1"><csymbol cd="ambiguous" id="S4.SS6.p1.2.m2.1.1.1.cmml" xref="S4.SS6.p1.2.m2.1.1">subscript</csymbol><ci id="S4.SS6.p1.2.m2.1.1.2.cmml" xref="S4.SS6.p1.2.m2.1.1.2">𝑥</ci><ci id="S4.SS6.p1.2.m2.1.1.3.cmml" xref="S4.SS6.p1.2.m2.1.1.3">𝑠</ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS6.p1.2.m2.1c">x_{s}</annotation><annotation encoding="application/x-llamapun" id="S4.SS6.p1.2.m2.1d">italic_x start_POSTSUBSCRIPT italic_s end_POSTSUBSCRIPT</annotation></semantics></math> on the results during testing, we added <math alttext="D_{\text{train}}" class="ltx_Math" display="inline" id="S4.SS6.p1.3.m3.1"><semantics id="S4.SS6.p1.3.m3.1a"><msub id="S4.SS6.p1.3.m3.1.1" xref="S4.SS6.p1.3.m3.1.1.cmml"><mi id="S4.SS6.p1.3.m3.1.1.2" xref="S4.SS6.p1.3.m3.1.1.2.cmml">D</mi><mtext id="S4.SS6.p1.3.m3.1.1.3" xref="S4.SS6.p1.3.m3.1.1.3a.cmml">train</mtext></msub><annotation-xml encoding="MathML-Content" id="S4.SS6.p1.3.m3.1b"><apply id="S4.SS6.p1.3.m3.1.1.cmml" xref="S4.SS6.p1.3.m3.1.1"><csymbol cd="ambiguous" id="S4.SS6.p1.3.m3.1.1.1.cmml" xref="S4.SS6.p1.3.m3.1.1">subscript</csymbol><ci id="S4.SS6.p1.3.m3.1.1.2.cmml" xref="S4.SS6.p1.3.m3.1.1.2">𝐷</ci><ci id="S4.SS6.p1.3.m3.1.1.3a.cmml" xref="S4.SS6.p1.3.m3.1.1.3"><mtext id="S4.SS6.p1.3.m3.1.1.3.cmml" mathsize="70%" xref="S4.SS6.p1.3.m3.1.1.3">train</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS6.p1.3.m3.1c">D_{\text{train}}</annotation><annotation encoding="application/x-llamapun" id="S4.SS6.p1.3.m3.1d">italic_D start_POSTSUBSCRIPT train end_POSTSUBSCRIPT</annotation></semantics></math> pretraining for comparison.
Similarly, to rule out the impact of finetuning on the relevance network, we fixed the parameters of the relevance network during the finetuning phase.
By comparing the data in the table, we find that: i) The relevance network pretrained with shifting data performs better than the model pretrained only with train data.
This indicates that the relevance network trained with shifting data indeed learns time-invariant information in the time-varying data distribution.
Theorem <a class="ltx_ref" href="https://arxiv.org/html/2404.15678v4#S2.Thmtheorem1" title="Theorem 2.1. ‣ 2. PRELIMINARIES ‣ Retrieval and Distill: A Temporal Data Shift-Free Paradigm for Online Recommendation System"><span class="ltx_text ltx_ref_tag">2.1</span></a> is validated.
ii) The relevance network trained with <math alttext="\mathcal{D}_{\text{shifting}}" class="ltx_Math" display="inline" id="S4.SS6.p1.4.m4.1"><semantics id="S4.SS6.p1.4.m4.1a"><msub id="S4.SS6.p1.4.m4.1.1" xref="S4.SS6.p1.4.m4.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.SS6.p1.4.m4.1.1.2" xref="S4.SS6.p1.4.m4.1.1.2.cmml">𝒟</mi><mtext id="S4.SS6.p1.4.m4.1.1.3" xref="S4.SS6.p1.4.m4.1.1.3a.cmml">shifting</mtext></msub><annotation-xml encoding="MathML-Content" id="S4.SS6.p1.4.m4.1b"><apply id="S4.SS6.p1.4.m4.1.1.cmml" xref="S4.SS6.p1.4.m4.1.1"><csymbol cd="ambiguous" id="S4.SS6.p1.4.m4.1.1.1.cmml" xref="S4.SS6.p1.4.m4.1.1">subscript</csymbol><ci id="S4.SS6.p1.4.m4.1.1.2.cmml" xref="S4.SS6.p1.4.m4.1.1.2">𝒟</ci><ci id="S4.SS6.p1.4.m4.1.1.3a.cmml" xref="S4.SS6.p1.4.m4.1.1.3"><mtext id="S4.SS6.p1.4.m4.1.1.3.cmml" mathsize="70%" xref="S4.SS6.p1.4.m4.1.1.3">shifting</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS6.p1.4.m4.1c">\mathcal{D}_{\text{shifting}}</annotation><annotation encoding="application/x-llamapun" id="S4.SS6.p1.4.m4.1d">caligraphic_D start_POSTSUBSCRIPT shifting end_POSTSUBSCRIPT</annotation></semantics></math> performs better because whether using <math alttext="\mathcal{D}_{\text{shifting}}" class="ltx_Math" display="inline" id="S4.SS6.p1.5.m5.1"><semantics id="S4.SS6.p1.5.m5.1a"><msub id="S4.SS6.p1.5.m5.1.1" xref="S4.SS6.p1.5.m5.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.SS6.p1.5.m5.1.1.2" xref="S4.SS6.p1.5.m5.1.1.2.cmml">𝒟</mi><mtext id="S4.SS6.p1.5.m5.1.1.3" xref="S4.SS6.p1.5.m5.1.1.3a.cmml">shifting</mtext></msub><annotation-xml encoding="MathML-Content" id="S4.SS6.p1.5.m5.1b"><apply id="S4.SS6.p1.5.m5.1.1.cmml" xref="S4.SS6.p1.5.m5.1.1"><csymbol cd="ambiguous" id="S4.SS6.p1.5.m5.1.1.1.cmml" xref="S4.SS6.p1.5.m5.1.1">subscript</csymbol><ci id="S4.SS6.p1.5.m5.1.1.2.cmml" xref="S4.SS6.p1.5.m5.1.1.2">𝒟</ci><ci id="S4.SS6.p1.5.m5.1.1.3a.cmml" xref="S4.SS6.p1.5.m5.1.1.3"><mtext id="S4.SS6.p1.5.m5.1.1.3.cmml" mathsize="70%" xref="S4.SS6.p1.5.m5.1.1.3">shifting</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS6.p1.5.m5.1c">\mathcal{D}_{\text{shifting}}</annotation><annotation encoding="application/x-llamapun" id="S4.SS6.p1.5.m5.1d">caligraphic_D start_POSTSUBSCRIPT shifting end_POSTSUBSCRIPT</annotation></semantics></math> or <math alttext="\mathcal{D}_{\text{train}}" class="ltx_Math" display="inline" id="S4.SS6.p1.6.m6.1"><semantics id="S4.SS6.p1.6.m6.1a"><msub id="S4.SS6.p1.6.m6.1.1" xref="S4.SS6.p1.6.m6.1.1.cmml"><mi class="ltx_font_mathcaligraphic" id="S4.SS6.p1.6.m6.1.1.2" xref="S4.SS6.p1.6.m6.1.1.2.cmml">𝒟</mi><mtext id="S4.SS6.p1.6.m6.1.1.3" xref="S4.SS6.p1.6.m6.1.1.3a.cmml">train</mtext></msub><annotation-xml encoding="MathML-Content" id="S4.SS6.p1.6.m6.1b"><apply id="S4.SS6.p1.6.m6.1.1.cmml" xref="S4.SS6.p1.6.m6.1.1"><csymbol cd="ambiguous" id="S4.SS6.p1.6.m6.1.1.1.cmml" xref="S4.SS6.p1.6.m6.1.1">subscript</csymbol><ci id="S4.SS6.p1.6.m6.1.1.2.cmml" xref="S4.SS6.p1.6.m6.1.1.2">𝒟</ci><ci id="S4.SS6.p1.6.m6.1.1.3a.cmml" xref="S4.SS6.p1.6.m6.1.1.3"><mtext id="S4.SS6.p1.6.m6.1.1.3.cmml" mathsize="70%" xref="S4.SS6.p1.6.m6.1.1.3">train</mtext></ci></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS6.p1.6.m6.1c">\mathcal{D}_{\text{train}}</annotation><annotation encoding="application/x-llamapun" id="S4.SS6.p1.6.m6.1d">caligraphic_D start_POSTSUBSCRIPT train end_POSTSUBSCRIPT</annotation></semantics></math>, both are fitting <math alttext="P(x_{s}|x)" class="ltx_Math" display="inline" id="S4.SS6.p1.7.m7.1"><semantics id="S4.SS6.p1.7.m7.1a"><mrow id="S4.SS6.p1.7.m7.1.1" xref="S4.SS6.p1.7.m7.1.1.cmml"><mi id="S4.SS6.p1.7.m7.1.1.3" xref="S4.SS6.p1.7.m7.1.1.3.cmml">P</mi><mo id="S4.SS6.p1.7.m7.1.1.2" xref="S4.SS6.p1.7.m7.1.1.2.cmml">⁢</mo><mrow id="S4.SS6.p1.7.m7.1.1.1.1" xref="S4.SS6.p1.7.m7.1.1.1.1.1.cmml"><mo id="S4.SS6.p1.7.m7.1.1.1.1.2" stretchy="false" xref="S4.SS6.p1.7.m7.1.1.1.1.1.cmml">(</mo><mrow id="S4.SS6.p1.7.m7.1.1.1.1.1" xref="S4.SS6.p1.7.m7.1.1.1.1.1.cmml"><msub id="S4.SS6.p1.7.m7.1.1.1.1.1.2" xref="S4.SS6.p1.7.m7.1.1.1.1.1.2.cmml"><mi id="S4.SS6.p1.7.m7.1.1.1.1.1.2.2" xref="S4.SS6.p1.7.m7.1.1.1.1.1.2.2.cmml">x</mi><mi id="S4.SS6.p1.7.m7.1.1.1.1.1.2.3" xref="S4.SS6.p1.7.m7.1.1.1.1.1.2.3.cmml">s</mi></msub><mo fence="false" id="S4.SS6.p1.7.m7.1.1.1.1.1.1" xref="S4.SS6.p1.7.m7.1.1.1.1.1.1.cmml">|</mo><mi id="S4.SS6.p1.7.m7.1.1.1.1.1.3" xref="S4.SS6.p1.7.m7.1.1.1.1.1.3.cmml">x</mi></mrow><mo id="S4.SS6.p1.7.m7.1.1.1.1.3" stretchy="false" xref="S4.SS6.p1.7.m7.1.1.1.1.1.cmml">)</mo></mrow></mrow><annotation-xml encoding="MathML-Content" id="S4.SS6.p1.7.m7.1b"><apply id="S4.SS6.p1.7.m7.1.1.cmml" xref="S4.SS6.p1.7.m7.1.1"><times id="S4.SS6.p1.7.m7.1.1.2.cmml" xref="S4.SS6.p1.7.m7.1.1.2"></times><ci id="S4.SS6.p1.7.m7.1.1.3.cmml" xref="S4.SS6.p1.7.m7.1.1.3">𝑃</ci><apply id="S4.SS6.p1.7.m7.1.1.1.1.1.cmml" xref="S4.SS6.p1.7.m7.1.1.1.1"><csymbol cd="latexml" id="S4.SS6.p1.7.m7.1.1.1.1.1.1.cmml" xref="S4.SS6.p1.7.m7.1.1.1.1.1.1">conditional</csymbol><apply id="S4.SS6.p1.7.m7.1.1.1.1.1.2.cmml" xref="S4.SS6.p1.7.m7.1.1.1.1.1.2"><csymbol cd="ambiguous" id="S4.SS6.p1.7.m7.1.1.1.1.1.2.1.cmml" xref="S4.SS6.p1.7.m7.1.1.1.1.1.2">subscript</csymbol><ci id="S4.SS6.p1.7.m7.1.1.1.1.1.2.2.cmml" xref="S4.SS6.p1.7.m7.1.1.1.1.1.2.2">𝑥</ci><ci id="S4.SS6.p1.7.m7.1.1.1.1.1.2.3.cmml" xref="S4.SS6.p1.7.m7.1.1.1.1.1.2.3">𝑠</ci></apply><ci id="S4.SS6.p1.7.m7.1.1.1.1.1.3.cmml" xref="S4.SS6.p1.7.m7.1.1.1.1.1.3">𝑥</ci></apply></apply></annotation-xml><annotation encoding="application/x-tex" id="S4.SS6.p1.7.m7.1c">P(x_{s}|x)</annotation><annotation encoding="application/x-llamapun" id="S4.SS6.p1.7.m7.1d">italic_P ( italic_x start_POSTSUBSCRIPT italic_s end_POSTSUBSCRIPT | italic_x )</annotation></semantics></math>, and shifting data has a much larger volume. Hence, the trained relevance network performs better.
Thus, we obtain a network that enhances model training effectiveness by increasing the volume of data, unlike the network in figure <a class="ltx_ref" href="https://arxiv.org/html/2404.15678v4#S1.F1" title="Figure 1 ‣ 1. INRODUCTION ‣ Retrieval and Distill: A Temporal Data Shift-Free Paradigm for Online Recommendation System"><span class="ltx_text ltx_ref_tag">1</span></a>, where increasing the volume of data would decrease model performance.</p>
</div>
</section>
<section class="ltx_subsection" id="S4.SS7">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.7. </span>Performance Efficiency Study (RQ4)</h3>
<div class="ltx_para" id="S4.SS7.p1">
<p class="ltx_p" id="S4.SS7.p1.1">Recently, a range of retrieval-based models have been introduced in the field of recommender systems, some of which utilize discrete features for retrieval, such as SIM <cite class="ltx_cite ltx_citemacro_citep">(Pi et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2404.15678v4#bib.bib24" title="">2019</a>)</cite> and RIM<cite class="ltx_cite ltx_citemacro_citep">(Qin et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2404.15678v4#bib.bib26" title="">2021</a>)</cite>, while others employ continuous features, like DERT<cite class="ltx_cite ltx_citemacro_citep">(Zheng et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2404.15678v4#bib.bib48" title="">2023</a>)</cite>. Due to the significant time overhead associated with retrieval, these models face challenges in being directly deployed online. In Figure <a class="ltx_ref" href="https://arxiv.org/html/2404.15678v4#S4.F6" title="Figure 6 ‣ 4.8. The Study of Distill Loss Functions (RQ5) ‣ 4. Experiments ‣ Retrieval and Distill: A Temporal Data Shift-Free Paradigm for Online Recommendation System"><span class="ltx_text ltx_ref_tag">6</span></a>, we compare three methods for augmenting relevant information. As RAD employs distillation to bypass the retrieval process, it incurs no retrieval time. On the other hand, directly aggregating the search-distill module with the original model increases the inference burden on the original model. However, as shown in Figure <a class="ltx_ref" href="https://arxiv.org/html/2404.15678v4#S4.F7" title="Figure 7 ‣ 4.8. The Study of Distill Loss Functions (RQ5) ‣ 4. Experiments ‣ Retrieval and Distill: A Temporal Data Shift-Free Paradigm for Online Recommendation System"><span class="ltx_text ltx_ref_tag">7</span></a>, the additional inference load introduced by incorporating the search-distill module is not significant, and the time overhead it introduces is considerably less than the burden added by using sequence models for model inference.</p>
</div>
</section>
<section class="ltx_subsection" id="S4.SS8">
<h3 class="ltx_title ltx_title_subsection">
<span class="ltx_tag ltx_tag_subsection">4.8. </span>The Study of Distill Loss Functions (RQ5)</h3>
<div class="ltx_para" id="S4.SS8.p1">
<p class="ltx_p" id="S4.SS8.p1.1">In Table <a class="ltx_ref" href="https://arxiv.org/html/2404.15678v4#S4.T4" title="Table 4 ‣ 4.3.2. Sequential based Models ‣ 4.3. Compared Methods ‣ 4. Experiments ‣ Retrieval and Distill: A Temporal Data Shift-Free Paradigm for Online Recommendation System"><span class="ltx_text ltx_ref_tag">4</span></a>, we compare the impact of various distillation functions on the Distill Framework.
For simplicity, our experiments were conducted using only three models based on feature interaction.
Our findings indicate that the performance enhancement provided by different distillation loss functions is broadly similar, suggesting that the quantity of information extracted primarily depends on the shifting data itself.
However, slight variations exist in the performance of different loss functions across datasets. The Mean Squared Error Loss Function generally performs slightly better on Tmall, the Kullback-Leibler Divergence Loss Function shows slight superiority on Alipay, and the cosine similarity loss function performs marginally better on Taobao. When addressing different data distributions, selecting an appropriate distillation function tailored to the specific dataset can further enhance the distillation effect.</p>
</div>
<figure class="ltx_figure" id="S4.F6"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="277" id="S4.F6.g1" src="x6.png" width="830"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span class="ltx_text" id="S4.F6.2.1.1" style="font-size:90%;">Figure 6</span>. </span><span class="ltx_text" id="S4.F6.3.2" style="font-size:90%;">Comparison of Retrieval time.</span></figcaption>
</figure>
<figure class="ltx_figure" id="S4.F7"><img alt="Refer to caption" class="ltx_graphics ltx_centering ltx_img_landscape" height="277" id="S4.F7.g1" src="x7.png" width="830"/>
<figcaption class="ltx_caption ltx_centering"><span class="ltx_tag ltx_tag_figure"><span class="ltx_text" id="S4.F7.2.1.1" style="font-size:90%;">Figure 7</span>. </span><span class="ltx_text" id="S4.F7.3.2" style="font-size:90%;">Comparison of Inference time.</span></figcaption>
</figure>
</section>
</section>
<section class="ltx_section" id="S5">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">5. </span>Related Work</h2>
<div class="ltx_para ltx_noindent" id="S5.p1">
<p class="ltx_p" id="S5.p1.1"><span class="ltx_text ltx_font_bold" id="S5.p1.1.1">Click-through rate (CTR) prediction</span>
is crucial in the fields of online advertising, recommendation systems, and information retrieval.
Many deep learning models for CTR prediction primarily concentrate on investigating the feature interactions within a single instance <cite class="ltx_cite ltx_citemacro_citep">(Guo et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2404.15678v4#bib.bib8" title="">2017</a>; He et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2404.15678v4#bib.bib10" title="">2017</a>; Qu et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2404.15678v4#bib.bib28" title="">2018</a>; Liu et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2404.15678v4#bib.bib19" title="">2020</a>; Gorishniy et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2404.15678v4#bib.bib5" title="">2021</a>)</cite>.
The Wide&amp;Deep network <cite class="ltx_cite ltx_citemacro_citep">(Cheng et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2404.15678v4#bib.bib3" title="">2016</a>)</cite> constructs fully connected (FC) layers based on field feature embeddings to extract feature interactions implicitly.
CCPM <cite class="ltx_cite ltx_citemacro_citep">(Liu et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2404.15678v4#bib.bib20" title="">2015</a>)</cite> employs convolution operators to probe local feature interaction patterns from a list of feature embeddings.
PNN <cite class="ltx_cite ltx_citemacro_citep">(Qu et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2404.15678v4#bib.bib28" title="">2018</a>)</cite> suggests executing inner or outer product operations on each pair of field feature embeddings, followed by FC layers for further implicit feature interaction extraction.
DeepFM <cite class="ltx_cite ltx_citemacro_citep">(Guo et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2404.15678v4#bib.bib8" title="">2017</a>)</cite> evolves from the factorization machine (FM) <cite class="ltx_cite ltx_citemacro_citep">(Rendle, <a class="ltx_ref" href="https://arxiv.org/html/2404.15678v4#bib.bib30" title="">2010</a>)</cite>.
Recently, graph neural networks have also shown great potential in recommendation scenes by constructing data into graph structures and performing message passing <cite class="ltx_cite ltx_citemacro_citep">(Li et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2404.15678v4#bib.bib18" title="">2019</a>; Wang et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2404.15678v4#bib.bib40" title="">2019b</a>; He et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2404.15678v4#bib.bib9" title="">2020</a>; Wang et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2404.15678v4#bib.bib39" title="">2019a</a>; Wu et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2404.15678v4#bib.bib41" title="">2021</a>)</cite>.
Despite the numerous models proposed in this direction, the model capacity might be constrained as the model’s input is a single instance, necessitating the model to encode all knowledge into the parameters.
Our work employs these deep models as the base model of the framework.</p>
</div>
<div class="ltx_para" id="S5.p3">
<p class="ltx_p" id="S5.p3.1"><span class="ltx_text ltx_font_bold" id="S5.p3.1.1">Retrieval-based methods for CTR prediction</span>
are typically derived from sequential recommendation tasks.
where it’s common to use a recurrent neural network (RNN) to construct user profile representations for recommendation predictions.
However, when the user’s historical behavior sequence becomes significantly long, RNN architectures struggle to memorize and utilize early behavior patterns <cite class="ltx_cite ltx_citemacro_citep">(Pi et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2404.15678v4#bib.bib24" title="">2019</a>)</cite>.
Therefore, retrieval methods serve as a practical alternative to lengthy recurrence and attention operations.
UBR <cite class="ltx_cite ltx_citemacro_citep">(Qin et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2404.15678v4#bib.bib27" title="">2020</a>)</cite> creates a search index from the user’s historical sequence data and employs reinforcement learning to generate a search query based on current prediction data. The retrieved data is then aggregated through an attention operation and input into an MLP for label prediction.
SIM <cite class="ltx_cite ltx_citemacro_citep">(Qi et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2404.15678v4#bib.bib25" title="">2020</a>)</cite> executes both hard search based on item category information and soft search based on item embedding vectors, using the DIEN model <cite class="ltx_cite ltx_citemacro_citep">(Zhou et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2404.15678v4#bib.bib49" title="">2019</a>)</cite> as the backbone.
RIM <cite class="ltx_cite ltx_citemacro_citep">(Qin et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2404.15678v4#bib.bib26" title="">2021</a>)</cite> expands the research scenario from sequential recommendation to generic tabular data prediction. The query is the target row data, and the retrieved data instances are the relevant rows in the table, with BM25 <cite class="ltx_cite ltx_citemacro_citep">(Robertson et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2404.15678v4#bib.bib31" title="">1995</a>)</cite> serving as the predefined relevance function between two rows. DERT <cite class="ltx_cite ltx_citemacro_citep">(Zheng et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2404.15678v4#bib.bib48" title="">2023</a>)</cite> is the pioneering work to incorporate dense retrieval into recommendation systems. Retrieval-enhanced machine learning is now considered a significant frontier in machine learning research <cite class="ltx_cite ltx_citemacro_citep">(Zamani et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2404.15678v4#bib.bib46" title="">2022</a>)</cite>.</p>
</div>
<div class="ltx_para ltx_noindent" id="S5.p4">
<p class="ltx_p" id="S5.p4.1"><span class="ltx_text ltx_font_bold" id="S5.p4.1.1">Knowledge Distillation</span> (KD)
<cite class="ltx_cite ltx_citemacro_citep">(Hinton et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2404.15678v4#bib.bib13" title="">2015</a>)</cite> seeks to transfer the ’dark knowledge’ from a teacher model to a student model and is extensively used in model compression and knowledge transfer <cite class="ltx_cite ltx_citemacro_citep">(Gou et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2404.15678v4#bib.bib6" title="">2021</a>)</cite>. Recent studies have also employed KD in various recommendation tasks, such as click-through rate (CTR) prediction <cite class="ltx_cite ltx_citemacro_citep">(Zhu et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2404.15678v4#bib.bib52" title="">2020</a>)</cite>, topology distillation <cite class="ltx_cite ltx_citemacro_citep">(Kang et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2404.15678v4#bib.bib15" title="">2021</a>)</cite>, and multi-task transfer <cite class="ltx_cite ltx_citemacro_citep">(Yang et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2404.15678v4#bib.bib42" title="">2022a</a>)</cite>.
Prior theoretical analyses <cite class="ltx_cite ltx_citemacro_citep">(Tang et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2404.15678v4#bib.bib34" title="">2020</a>; Phuong and Lampert, <a class="ltx_ref" href="https://arxiv.org/html/2404.15678v4#bib.bib23" title="">2019</a>; Chandrasegaran et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2404.15678v4#bib.bib2" title="">2022</a>)</cite> have indicated that the teacher’s predictions, also referred to as soft labels, are typically viewed as more informative training signals compared to binary hard labels. KD can adaptively adjust the training dynamics of the student model based on the values of the soft labels. Knowledge distillation is typically employed to transfer knowledge from a larger parameterized model to a smaller one. Recent studies have applied knowledge distillation to transfer knowledge from KNN to parameterized models <cite class="ltx_cite ltx_citemacro_citep">(Zhang et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2404.15678v4#bib.bib47" title="">2023</a>; Yang et al<span class="ltx_text">.</span>, <a class="ltx_ref" href="https://arxiv.org/html/2404.15678v4#bib.bib43" title="">2022b</a>)</cite>, demonstrating the potential of knowledge distillation in non-parametric models.</p>
</div>
</section>
<section class="ltx_section" id="S6">
<h2 class="ltx_title ltx_title_section">
<span class="ltx_tag ltx_tag_section">6. </span>Conclusion</h2>
<div class="ltx_para" id="S6.p1">
<p class="ltx_p" id="S6.p1.1">In current recommendation systems, temporal data shift poses a significant challenge.
The presence of data shift prevents the system from simply enhancing the CTR model’s adaptability to new data by adding more training data.
We observed that although the correlation between features and labels in recommendation systems changes over time, if a fixed search space is established, the relationship between the data and the search space remains invariant.
Therefore, we designed a framework that uses retrieval techniques to leverage shifting data for training a relevance network.
However, due to the use of BM25 as a retrieval method, this framework is challenging to deploy in online recommendation systems. 
We then designed a distillation method using knowledge distillation to transfer knowledge from the relevance network to a parameterized module, the search-distill module. We refer to this entire process as the Retrieval and Distill paradigm (RAD).
With the RAD paradigm, we have an effective method for leveraging shifting data to enhance the performance of CTR models.
In future research directions, we aim to incorporate a wider variety of data into the CTR model using RAD. On the other hand, enhancing the performance of the distillation method is also a significant area of focus.</p>
</div>
<div class="ltx_acknowledgements">
<h6 class="ltx_title ltx_title_acknowledgements">Acknowledgements.</h6>
To Robert, for the bagels and explaining CMYK and color spaces.

</div>
</section>
<section class="ltx_bibliography" id="bib">
<h2 class="ltx_title ltx_title_bibliography">References</h2>
<ul class="ltx_biblist">
<li class="ltx_bibitem" id="bib.bib1">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">(1)</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib2">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Chandrasegaran et al<span class="ltx_text" id="bib.bib2.2.2.1">.</span> (2022)</span>
<span class="ltx_bibblock">
Keshigeyan Chandrasegaran, Ngoc-Trung Tran, Yunqing Zhao, and Ngai-Man Cheung. 2022.

</span>
<span class="ltx_bibblock">Revisiting Label Smoothing and Knowledge Distillation Compatibility: What was Missing?. In <em class="ltx_emph ltx_font_italic" id="bib.bib2.3.1">International Conference on Machine Learning</em>. PMLR, 2890–2916.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib3">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Cheng et al<span class="ltx_text" id="bib.bib3.2.2.1">.</span> (2016)</span>
<span class="ltx_bibblock">
Heng-Tze Cheng, Levent Koc, Jeremiah Harmsen, Tal Shaked, Tushar Chandra, Hrishi Aradhye, Glen Anderson, Greg Corrado, Wei Chai, Mustafa Ispir, et al<span class="ltx_text" id="bib.bib3.3.1">.</span> 2016.

</span>
<span class="ltx_bibblock">Wide &amp; deep learning for recommender systems. In <em class="ltx_emph ltx_font_italic" id="bib.bib3.4.1">1st DLRS workshop</em>. 7–10.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib4">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Covington et al<span class="ltx_text" id="bib.bib4.2.2.1">.</span> (2016)</span>
<span class="ltx_bibblock">
Paul Covington, Jay Adams, and Emre Sargin. 2016.

</span>
<span class="ltx_bibblock">Deep neural networks for youtube recommendations. In <em class="ltx_emph ltx_font_italic" id="bib.bib4.3.1">Proceedings of the 10th ACM conference on recommender systems</em>. 191–198.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib5">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Gorishniy et al<span class="ltx_text" id="bib.bib5.2.2.1">.</span> (2021)</span>
<span class="ltx_bibblock">
Yury Gorishniy, Ivan Rubachev, Valentin Khrulkov, and Artem Babenko. 2021.

</span>
<span class="ltx_bibblock">Revisiting deep learning models for tabular data.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib5.3.1">Advances in Neural Information Processing Systems</em> 34 (2021), 18932–18943.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib6">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Gou et al<span class="ltx_text" id="bib.bib6.2.2.1">.</span> (2021)</span>
<span class="ltx_bibblock">
Jianping Gou, Baosheng Yu, Stephen J Maybank, and Dacheng Tao. 2021.

</span>
<span class="ltx_bibblock">Knowledge distillation: A survey.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib6.3.1">International Journal of Computer Vision</em> 129 (2021), 1789–1819.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib7">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Gu et al<span class="ltx_text" id="bib.bib7.2.2.1">.</span> (2020)</span>
<span class="ltx_bibblock">
Yulong Gu, Zhuoye Ding, Shuaiqiang Wang, Lixin Zou, Yiding Liu, and Dawei Yin. 2020.

</span>
<span class="ltx_bibblock">Deep multifaceted transformers for multi-objective ranking in large-scale e-commerce recommender systems. In <em class="ltx_emph ltx_font_italic" id="bib.bib7.3.1">Proceedings of the 29th ACM International Conference on Information &amp; Knowledge Management</em>. 2493–2500.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib8">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Guo et al<span class="ltx_text" id="bib.bib8.2.2.1">.</span> (2017)</span>
<span class="ltx_bibblock">
Huifeng Guo, Ruiming Tang, Yunming Ye, Zhenguo Li, and Xiuqiang He. 2017.

</span>
<span class="ltx_bibblock">Deepfm: a factorization-machine based neural network for ctr prediction.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib8.3.1">IJCAI</em> (2017).

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib9">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">He et al<span class="ltx_text" id="bib.bib9.2.2.1">.</span> (2020)</span>
<span class="ltx_bibblock">
Xiangnan He, Kuan Deng, Xiang Wang, Yan Li, Yongdong Zhang, and Meng Wang. 2020.

</span>
<span class="ltx_bibblock">Lightgcn: Simplifying and powering graph convolution network for recommendation. In <em class="ltx_emph ltx_font_italic" id="bib.bib9.3.1">Proceedings of the 43rd International ACM SIGIR conference on research and development in Information Retrieval</em>. 639–648.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib10">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">He et al<span class="ltx_text" id="bib.bib10.2.2.1">.</span> (2017)</span>
<span class="ltx_bibblock">
Xiangnan He, Lizi Liao, Hanwang Zhang, Liqiang Nie, Xia Hu, and Tat-Seng Chua. 2017.

</span>
<span class="ltx_bibblock">Neural collaborative filtering. In <em class="ltx_emph ltx_font_italic" id="bib.bib10.3.1">WWW</em>. 173–182.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib11">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Hidasi et al<span class="ltx_text" id="bib.bib11.2.2.1">.</span> (2015)</span>
<span class="ltx_bibblock">
Balázs Hidasi, Alexandros Karatzoglou, Linas Baltrunas, and Domonkos Tikk. 2015.

</span>
<span class="ltx_bibblock">Session-based recommendations with recurrent neural networks.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib11.3.1">arXiv preprint arXiv:1511.06939</em> (2015).

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib12">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Hidasi et al<span class="ltx_text" id="bib.bib12.2.2.1">.</span> (2016)</span>
<span class="ltx_bibblock">
Balázs Hidasi, Massimo Quadrana, Alexandros Karatzoglou, and Domonkos Tikk. 2016.

</span>
<span class="ltx_bibblock">Parallel recurrent neural network architectures for feature-rich session-based recommendations. In <em class="ltx_emph ltx_font_italic" id="bib.bib12.3.1">Proceedings of the 10th ACM conference on recommender systems</em>. 241–248.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib13">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Hinton et al<span class="ltx_text" id="bib.bib13.2.2.1">.</span> (2015)</span>
<span class="ltx_bibblock">
Geoffrey Hinton, Oriol Vinyals, and Jeff Dean. 2015.

</span>
<span class="ltx_bibblock">Distilling the knowledge in a neural network.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib13.3.1">arXiv preprint arXiv:1503.02531</em> (2015).

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib14">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Juan et al<span class="ltx_text" id="bib.bib14.2.2.1">.</span> (2016)</span>
<span class="ltx_bibblock">
Yuchin Juan, Yong Zhuang, Wei-Sheng Chin, and Chih-Jen Lin. 2016.

</span>
<span class="ltx_bibblock">Field-aware factorization machines for CTR prediction. In <em class="ltx_emph ltx_font_italic" id="bib.bib14.3.1">Proceedings of the 10th ACM conference on recommender systems</em>. 43–50.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib15">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Kang et al<span class="ltx_text" id="bib.bib15.2.2.1">.</span> (2021)</span>
<span class="ltx_bibblock">
SeongKu Kang, Junyoung Hwang, Wonbin Kweon, and Hwanjo Yu. 2021.

</span>
<span class="ltx_bibblock">Topology distillation for recommender system. In <em class="ltx_emph ltx_font_italic" id="bib.bib15.3.1">Proceedings of the 27th ACM SIGKDD Conference on Knowledge Discovery &amp; Data Mining</em>. 829–839.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib16">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Kang and McAuley (2018)</span>
<span class="ltx_bibblock">
Wang-Cheng Kang and Julian McAuley. 2018.

</span>
<span class="ltx_bibblock">Self-attentive sequential recommendation. In <em class="ltx_emph ltx_font_italic" id="bib.bib16.1.1">2018 IEEE international conference on data mining (ICDM)</em>. IEEE, 197–206.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib17">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Katsileros et al<span class="ltx_text" id="bib.bib17.2.2.1">.</span> (2022)</span>
<span class="ltx_bibblock">
Petros Katsileros, Nikiforos Mandilaras, Dimitrios Mallis, Vassilis Pitsikalis, Stavros Theodorakis, and Gil Chamiel. 2022.

</span>
<span class="ltx_bibblock">An Incremental Learning framework for Large-scale CTR Prediction. In <em class="ltx_emph ltx_font_italic" id="bib.bib17.3.1">Proceedings of the 16th ACM Conference on Recommender Systems</em>. 490–493.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib18">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Li et al<span class="ltx_text" id="bib.bib18.2.2.1">.</span> (2019)</span>
<span class="ltx_bibblock">
Zekun Li, Zeyu Cui, Shu Wu, Xiaoyu Zhang, and Liang Wang. 2019.

</span>
<span class="ltx_bibblock">Fi-gnn: Modeling feature interactions via graph neural networks for ctr prediction. In <em class="ltx_emph ltx_font_italic" id="bib.bib18.3.1">CIKM</em>.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib19">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Liu et al<span class="ltx_text" id="bib.bib19.2.2.1">.</span> (2020)</span>
<span class="ltx_bibblock">
Bin Liu, Chenxu Zhu, Guilin Li, Weinan Zhang, Jincai Lai, Ruiming Tang, Xiuqiang He, Zhenguo Li, and Yong Yu. 2020.

</span>
<span class="ltx_bibblock">AutoFIS: Automatic Feature Interaction Selection in Factorization Models for Click-Through Rate Prediction.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib19.3.1">KDD</em> (2020).

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib20">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Liu et al<span class="ltx_text" id="bib.bib20.2.2.1">.</span> (2015)</span>
<span class="ltx_bibblock">
Qiang Liu, Feng Yu, Shu Wu, and Liang Wang. 2015.

</span>
<span class="ltx_bibblock">A convolutional click prediction model. In <em class="ltx_emph ltx_font_italic" id="bib.bib20.3.1">Proceedings of the 24th ACM international on conference on information and knowledge management</em>. 1743–1746.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib21">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Naumov et al<span class="ltx_text" id="bib.bib21.2.2.1">.</span> (2019)</span>
<span class="ltx_bibblock">
Maxim Naumov, Dheevatsa Mudigere, Hao-Jun Michael Shi, Jianyu Huang, Narayanan Sundaraman, Jongsoo Park, Xiaodong Wang, Udit Gupta, Carole-Jean Wu, Alisson G Azzolini, et al<span class="ltx_text" id="bib.bib21.3.1">.</span> 2019.

</span>
<span class="ltx_bibblock">Deep learning recommendation model for personalization and recommendation systems.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib21.4.1">arXiv preprint arXiv:1906.00091</em> (2019).

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib22">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Peng et al<span class="ltx_text" id="bib.bib22.2.2.1">.</span> (2021)</span>
<span class="ltx_bibblock">
Danni Peng, Sinno Jialin Pan, Jie Zhang, and Anxiang Zeng. 2021.

</span>
<span class="ltx_bibblock">Learning an adaptive meta model-generator for incrementally updating recommender systems. In <em class="ltx_emph ltx_font_italic" id="bib.bib22.3.1">Proceedings of the 15th ACM Conference on Recommender Systems</em>. 411–421.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib23">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Phuong and Lampert (2019)</span>
<span class="ltx_bibblock">
Mary Phuong and Christoph Lampert. 2019.

</span>
<span class="ltx_bibblock">Towards understanding knowledge distillation. In <em class="ltx_emph ltx_font_italic" id="bib.bib23.1.1">International conference on machine learning</em>. PMLR, 5142–5151.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib24">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Pi et al<span class="ltx_text" id="bib.bib24.2.2.1">.</span> (2019)</span>
<span class="ltx_bibblock">
Qi Pi, Weijie Bian, Guorui Zhou, Xiaoqiang Zhu, and Kun Gai. 2019.

</span>
<span class="ltx_bibblock">Practice on long sequential user behavior modeling for click-through rate prediction. In <em class="ltx_emph ltx_font_italic" id="bib.bib24.3.1">Proceedings of the 25th ACM SIGKDD International Conference on Knowledge Discovery &amp; Data Mining</em>. 2671–2679.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib25">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Qi et al<span class="ltx_text" id="bib.bib25.2.2.1">.</span> (2020)</span>
<span class="ltx_bibblock">
Pi Qi, Xiaoqiang Zhu, Guorui Zhou, Yujing Zhang, Zhe Wang, Lejian Ren, Ying Fan, and Kun Gai. 2020.

</span>
<span class="ltx_bibblock">Search-based User Interest Modeling with Lifelong Sequential Behavior Data for Click-Through Rate Prediction. In <em class="ltx_emph ltx_font_italic" id="bib.bib25.3.1">Proceedings of the 26th ACM SIGKDD International Conference on Knowledge Discovery &amp; Data Mining</em>.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib26">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Qin et al<span class="ltx_text" id="bib.bib26.2.2.1">.</span> (2021)</span>
<span class="ltx_bibblock">
Jiarui Qin, Weinan Zhang, Rong Su, Zhirong Liu, Weiwen Liu, Ruiming Tang, Xiuqiang He, and Yong Yu. 2021.

</span>
<span class="ltx_bibblock">Retrieval &amp; Interaction Machine for Tabular Data Prediction. In <em class="ltx_emph ltx_font_italic" id="bib.bib26.3.1">Proceedings of the 27th ACM SIGKDD Conference on Knowledge Discovery &amp; Data Mining</em>. 1379–1389.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib27">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Qin et al<span class="ltx_text" id="bib.bib27.2.2.1">.</span> (2020)</span>
<span class="ltx_bibblock">
Jiarui Qin, W. Zhang, Xin Wu, Jiarui Jin, Yuchen Fang, and Y. Yu. 2020.

</span>
<span class="ltx_bibblock">User Behavior Retrieval for Click-Through Rate Prediction. In <em class="ltx_emph ltx_font_italic" id="bib.bib27.3.1">Proceedings of the 43rd International ACM SIGIR Conference on Research and Development in Information Retrieval</em>.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib28">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Qu et al<span class="ltx_text" id="bib.bib28.2.2.1">.</span> (2018)</span>
<span class="ltx_bibblock">
Yanru Qu, Bohui Fang, Weinan Zhang, Ruiming Tang, Minzhe Niu, Huifeng Guo, Yong Yu, and Xiuqiang He. 2018.

</span>
<span class="ltx_bibblock">Product-based neural networks for user response prediction over multi-field categorical data.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib28.3.1">TOIS</em> 37, 1 (2018), 1–35.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib29">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Ren et al<span class="ltx_text" id="bib.bib29.2.2.1">.</span> (2019)</span>
<span class="ltx_bibblock">
Kan Ren, Jiarui Qin, Yuchen Fang, Weinan Zhang, Lei Zheng, Weijie Bian, Guorui Zhou, Jian Xu, Yong Yu, Xiaoqiang Zhu, et al<span class="ltx_text" id="bib.bib29.3.1">.</span> 2019.

</span>
<span class="ltx_bibblock">Lifelong Sequential Modeling with Personalized Memorization for User Response Prediction.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib29.4.1">SIGIR</em>.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib30">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Rendle (2010)</span>
<span class="ltx_bibblock">
Steffen Rendle. 2010.

</span>
<span class="ltx_bibblock">Factorization machines. In <em class="ltx_emph ltx_font_italic" id="bib.bib30.1.1">2010 IEEE International conference on data mining</em>. IEEE, 995–1000.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib31">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Robertson et al<span class="ltx_text" id="bib.bib31.2.2.1">.</span> (1995)</span>
<span class="ltx_bibblock">
Stephen E Robertson, Steve Walker, Susan Jones, Micheline M Hancock-Beaulieu, Mike Gatford, et al<span class="ltx_text" id="bib.bib31.3.1">.</span> 1995.

</span>
<span class="ltx_bibblock">Okapi at TREC-3.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib31.4.1">Nist Special Publication Sp</em> 109 (1995), 109.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib32">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Shan et al<span class="ltx_text" id="bib.bib32.2.2.1">.</span> (2016)</span>
<span class="ltx_bibblock">
Ying Shan, T Ryan Hoens, Jian Jiao, Haijing Wang, Dong Yu, and JC Mao. 2016.

</span>
<span class="ltx_bibblock">Deep crossing: Web-scale modeling without manually crafted combinatorial features. In <em class="ltx_emph ltx_font_italic" id="bib.bib32.3.1">Proceedings of the 22nd ACM SIGKDD international conference on knowledge discovery and data mining</em>. 255–262.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib33">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Sun et al<span class="ltx_text" id="bib.bib33.2.2.1">.</span> (2019)</span>
<span class="ltx_bibblock">
Fei Sun, Jun Liu, Jian Wu, Changhua Pei, Xiao Lin, Wenwu Ou, and Peng Jiang. 2019.

</span>
<span class="ltx_bibblock">BERT4Rec: Sequential recommendation with bidirectional encoder representations from transformer. In <em class="ltx_emph ltx_font_italic" id="bib.bib33.3.1">Proceedings of the 28th ACM international conference on information and knowledge management</em>. 1441–1450.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib34">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Tang et al<span class="ltx_text" id="bib.bib34.2.2.1">.</span> (2020)</span>
<span class="ltx_bibblock">
Jiaxi Tang, Rakesh Shivanna, Zhe Zhao, Dong Lin, Anima Singh, Ed H Chi, and Sagar Jain. 2020.

</span>
<span class="ltx_bibblock">Understanding and improving knowledge distillation.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib34.3.1">arXiv preprint arXiv:2002.03532</em> (2020).

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib35">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Tang and Wang (2018)</span>
<span class="ltx_bibblock">
Jiaxi Tang and Ke Wang. 2018.

</span>
<span class="ltx_bibblock">Personalized top-n sequential recommendation via convolutional sequence embedding. In <em class="ltx_emph ltx_font_italic" id="bib.bib35.1.1">Proceedings of the eleventh ACM international conference on web search and data mining</em>. 565–573.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib36">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Vaswani et al<span class="ltx_text" id="bib.bib36.2.2.1">.</span> (2017)</span>
<span class="ltx_bibblock">
Ashish Vaswani, Noam Shazeer, Niki Parmar, Jakob Uszkoreit, Llion Jones, Aidan N Gomez, Łukasz Kaiser, and Illia Polosukhin. 2017.

</span>
<span class="ltx_bibblock">Attention is all you need.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib36.3.1">Advances in neural information processing systems</em> 30 (2017).

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib37">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Wang et al<span class="ltx_text" id="bib.bib37.2.2.1">.</span> (2017)</span>
<span class="ltx_bibblock">
Ruoxi Wang, Bin Fu, Gang Fu, and Mingliang Wang. 2017.

</span>
<span class="ltx_bibblock">Deep &amp; cross network for ad click predictions.

</span>
<span class="ltx_bibblock">In <em class="ltx_emph ltx_font_italic" id="bib.bib37.3.1">ADKDD</em>. 1–7.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib38">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Wang et al<span class="ltx_text" id="bib.bib38.2.2.1">.</span> (2021)</span>
<span class="ltx_bibblock">
Ruoxi Wang, Rakesh Shivanna, Derek Cheng, Sagar Jain, Dong Lin, Lichan Hong, and Ed Chi. 2021.

</span>
<span class="ltx_bibblock">Dcn v2: Improved deep &amp; cross network and practical lessons for web-scale learning to rank systems. In <em class="ltx_emph ltx_font_italic" id="bib.bib38.3.1">Proceedings of the web conference 2021</em>. 1785–1797.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib39">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Wang et al<span class="ltx_text" id="bib.bib39.2.2.1">.</span> (2019a)</span>
<span class="ltx_bibblock">
Xiang Wang, Xiangnan He, Yixin Cao, Meng Liu, and Tat-Seng Chua. 2019a.

</span>
<span class="ltx_bibblock">Kgat: Knowledge graph attention network for recommendation. In <em class="ltx_emph ltx_font_italic" id="bib.bib39.3.1">Proceedings of the 25th ACM SIGKDD international conference on knowledge discovery &amp; data mining</em>. 950–958.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib40">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Wang et al<span class="ltx_text" id="bib.bib40.2.2.1">.</span> (2019b)</span>
<span class="ltx_bibblock">
Xiang Wang, Xiangnan He, Meng Wang, Fuli Feng, and Tat-Seng Chua. 2019b.

</span>
<span class="ltx_bibblock">Neural graph collaborative filtering. In <em class="ltx_emph ltx_font_italic" id="bib.bib40.3.1">Proceedings of the 42nd international ACM SIGIR conference on Research and development in Information Retrieval</em>. 165–174.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib41">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Wu et al<span class="ltx_text" id="bib.bib41.2.2.1">.</span> (2021)</span>
<span class="ltx_bibblock">
Jiancan Wu, Xiang Wang, Fuli Feng, Xiangnan He, Liang Chen, Jianxun Lian, and Xing Xie. 2021.

</span>
<span class="ltx_bibblock">Self-supervised graph learning for recommendation. In <em class="ltx_emph ltx_font_italic" id="bib.bib41.3.1">Proceedings of the 44th international ACM SIGIR conference on research and development in information retrieval</em>. 726–735.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib42">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Yang et al<span class="ltx_text" id="bib.bib42.2.2.1">.</span> (2022a)</span>
<span class="ltx_bibblock">
Chenxiao Yang, Junwei Pan, Xiaofeng Gao, Tingyu Jiang, Dapeng Liu, and Guihai Chen. 2022a.

</span>
<span class="ltx_bibblock">Cross-task knowledge distillation in multi-task recommendation. In <em class="ltx_emph ltx_font_italic" id="bib.bib42.3.1">Proceedings of the AAAI Conference on Artificial Intelligence</em>, Vol. 36. 4318–4326.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib43">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Yang et al<span class="ltx_text" id="bib.bib43.2.2.1">.</span> (2022b)</span>
<span class="ltx_bibblock">
Zhixian Yang, Renliang Sun, and Xiaojun Wan. 2022b.

</span>
<span class="ltx_bibblock">Nearest neighbor knowledge distillation for neural machine translation.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib43.3.1">arXiv preprint arXiv:2205.00479</em> (2022).

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib44">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Ye et al<span class="ltx_text" id="bib.bib44.2.2.1">.</span> (2022)</span>
<span class="ltx_bibblock">
Mao Ye, Ruichen Jiang, Haoxiang Wang, Dhruv Choudhary, Xiaocong Du, Bhargav Bhushanam, Aryan Mokhtari, Arun Kejariwal, and Qiang Liu. 2022.

</span>
<span class="ltx_bibblock">Future gradient descent for adapting the temporal shifting data distribution in online recommendation systems. In <em class="ltx_emph ltx_font_italic" id="bib.bib44.3.1">Uncertainty in Artificial Intelligence</em>. PMLR, 2256–2266.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib45">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Yuan et al<span class="ltx_text" id="bib.bib45.2.2.1">.</span> (2019)</span>
<span class="ltx_bibblock">
Fajie Yuan, Alexandros Karatzoglou, Ioannis Arapakis, Joemon M Jose, and Xiangnan He. 2019.

</span>
<span class="ltx_bibblock">A simple convolutional generative network for next item recommendation. In <em class="ltx_emph ltx_font_italic" id="bib.bib45.3.1">Proceedings of the twelfth ACM international conference on web search and data mining</em>. 582–590.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib46">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Zamani et al<span class="ltx_text" id="bib.bib46.2.2.1">.</span> (2022)</span>
<span class="ltx_bibblock">
Hamed Zamani, Fernando Diaz, Mostafa Dehghani, Donald Metzler, and Michael Bendersky. 2022.

</span>
<span class="ltx_bibblock">Retrieval-Enhanced Machine Learning.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib46.3.1">arXiv preprint arXiv:2205.01230</em> (2022).

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib47">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Zhang et al<span class="ltx_text" id="bib.bib47.2.2.1">.</span> (2023)</span>
<span class="ltx_bibblock">
Hao Zhang, Nianwen Si, Yaqi Chen, Wenlin Zhang, Xukui Yang, Dan Qu, and Zhen Li. 2023.

</span>
<span class="ltx_bibblock">Decoupled Non-Parametric Knowledge Distillation for end-to-End Speech Translation. In <em class="ltx_emph ltx_font_italic" id="bib.bib47.3.1">ICASSP 2023-2023 IEEE International Conference on Acoustics, Speech and Signal Processing (ICASSP)</em>. IEEE, 1–5.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib48">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Zheng et al<span class="ltx_text" id="bib.bib48.2.2.1">.</span> (2023)</span>
<span class="ltx_bibblock">
Lei Zheng, Ning Li, Xianyu Chen, Quan Gan, and Weinan Zhang. 2023.

</span>
<span class="ltx_bibblock">Dense Representation Learning and Retrieval for Tabular Data Prediction. In <em class="ltx_emph ltx_font_italic" id="bib.bib48.3.1">Proceedings of the 29th ACM SIGKDD Conference on Knowledge Discovery and Data Mining</em>. 3559–3569.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib49">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Zhou et al<span class="ltx_text" id="bib.bib49.2.2.1">.</span> (2019)</span>
<span class="ltx_bibblock">
Guorui Zhou, Na Mou, Ying Fan, Qi Pi, Weijie Bian, Chang Zhou, Xiaoqiang Zhu, and Kun Gai. 2019.

</span>
<span class="ltx_bibblock">Deep interest evolution network for click-through rate prediction. In <em class="ltx_emph ltx_font_italic" id="bib.bib49.3.1">Proceedings of the AAAI Conference on Artificial Intelligence</em>, Vol. 33. 5941–5948.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib50">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Zhou et al<span class="ltx_text" id="bib.bib50.2.2.1">.</span> (2018)</span>
<span class="ltx_bibblock">
Guorui Zhou, Xiaoqiang Zhu, Chenru Song, Ying Fan, Han Zhu, Xiao Ma, Yanghui Yan, Junqi Jin, Han Li, and Kun Gai. 2018.

</span>
<span class="ltx_bibblock">Deep interest network for click-through rate prediction. In <em class="ltx_emph ltx_font_italic" id="bib.bib50.3.1">KDD</em>.

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib51">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Zhu et al<span class="ltx_text" id="bib.bib51.2.2.1">.</span> (2023)</span>
<span class="ltx_bibblock">
Jieming Zhu, Guohao Cai, Junjie Huang, Zhenhua Dong, Ruiming Tang, and Weinan Zhang. 2023.

</span>
<span class="ltx_bibblock">ReLoop2: Building Self-Adaptive Recommendation Models via Responsive Error Compensation Loop.

</span>
<span class="ltx_bibblock"><em class="ltx_emph ltx_font_italic" id="bib.bib51.3.1">arXiv preprint arXiv:2306.08808</em> (2023).

</span>
<span class="ltx_bibblock">
</span>
</li>
<li class="ltx_bibitem" id="bib.bib52">
<span class="ltx_tag ltx_role_refnum ltx_tag_bibitem">Zhu et al<span class="ltx_text" id="bib.bib52.2.2.1">.</span> (2020)</span>
<span class="ltx_bibblock">
Jieming Zhu, Jinyang Liu, Weiqi Li, Jincai Lai, Xiuqiang He, Liang Chen, and Zibin Zheng. 2020.

</span>
<span class="ltx_bibblock">Ensembled CTR prediction via knowledge distillation. In <em class="ltx_emph ltx_font_italic" id="bib.bib52.3.1">Proceedings of the 29th ACM International Conference on Information &amp; Knowledge Management</em>. 2941–2958.

</span>
<span class="ltx_bibblock">
</span>
</li>
</ul>
</section>
</article>
</div>
<footer class="ltx_page_footer">
<div class="ltx_page_logo">Generated  on Thu Jun 13 07:53:54 2024 by <a class="ltx_LaTeXML_logo" href="http://dlmf.nist.gov/LaTeXML/"><span style="letter-spacing:-0.2em; margin-right:0.1em;">L<span class="ltx_font_smallcaps" style="position:relative; bottom:2.2pt;">a</span>T<span class="ltx_font_smallcaps" style="font-size:120%;position:relative; bottom:-0.2ex;">e</span></span><span style="font-size:90%; position:relative; bottom:-0.2ex;">XML</span><img alt="Mascot Sammy" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAsAAAAOCAYAAAD5YeaVAAAAAXNSR0IArs4c6QAAAAZiS0dEAP8A/wD/oL2nkwAAAAlwSFlzAAALEwAACxMBAJqcGAAAAAd0SU1FB9wKExQZLWTEaOUAAAAddEVYdENvbW1lbnQAQ3JlYXRlZCB3aXRoIFRoZSBHSU1Q72QlbgAAAdpJREFUKM9tkL+L2nAARz9fPZNCKFapUn8kyI0e4iRHSR1Kb8ng0lJw6FYHFwv2LwhOpcWxTjeUunYqOmqd6hEoRDhtDWdA8ApRYsSUCDHNt5ul13vz4w0vWCgUnnEc975arX6ORqN3VqtVZbfbTQC4uEHANM3jSqXymFI6yWazP2KxWAXAL9zCUa1Wy2tXVxheKA9YNoR8Pt+aTqe4FVVVvz05O6MBhqUIBGk8Hn8HAOVy+T+XLJfLS4ZhTiRJgqIoVBRFIoric47jPnmeB1mW/9rr9ZpSSn3Lsmir1fJZlqWlUonKsvwWwD8ymc/nXwVBeLjf7xEKhdBut9Hr9WgmkyGEkJwsy5eHG5vN5g0AKIoCAEgkEkin0wQAfN9/cXPdheu6P33fBwB4ngcAcByHJpPJl+fn54mD3Gg0NrquXxeLRQAAwzAYj8cwTZPwPH9/sVg8PXweDAauqqr2cDjEer1GJBLBZDJBs9mE4zjwfZ85lAGg2+06hmGgXq+j3+/DsixYlgVN03a9Xu8jgCNCyIegIAgx13Vfd7vdu+FweG8YRkjXdWy329+dTgeSJD3ieZ7RNO0VAXAPwDEAO5VKndi2fWrb9jWl9Esul6PZbDY9Go1OZ7PZ9z/lyuD3OozU2wAAAABJRU5ErkJggg=="/></a>
</div></footer>
</div>
</body>
</html>
